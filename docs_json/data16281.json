{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.20295"}, {"@name": "filename", "#text": "3780_230069.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE FEDERAL DE SANTA CATARINA \u2013 UFSC \n \n\nPrograma de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia Mec\u00e2nica \n \n \n \n \n \n \n \n \n \n \n \n\nSIMULA\u00c7\u00c3O DE RESERVAT\u00d3RIOS DE PETR\u00d3LEO UTILIZANDO O M\u00c9TODO EbFVM  E \nMULTIGRID ALG\u00c9BRICO \n\n \n \n \n \n \n \n\nTese submetida \u00e0 \n \n\n \nUNIVERSIDADE FEDERAL DE SANTA CATARINA \n\n \n \n\npara a obten\u00e7\u00e3o do grau de \n \n\n \nDOUTOR EM ENGENHARIA MEC\u00c2NICA \n\n \n \n \n \n \n\nJONAS CORDAZZO \n \n \n \n \n\nFlorian\u00f3polis, abril de 2006 \n \n\n\n\n \n\n \n \n\n\n\n \n\nUNIVERSIDADE FEDERAL DE SANTA CATARINA \nPrograma de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia Mec\u00e2nica \n\n \n\n \nSIMULA\u00c7\u00c3O DE RESERVAT\u00d3RIOS DE PETR\u00d3LEO UTILIZANDO O M\u00c9TODO EbFVM  E \n\nMULTIGRID ALG\u00c9BRICO \n \n\n \nJONAS CORDAZZO \n\n \n \n\nEsta tese foi julgada adequada para a obten\u00e7\u00e3o do t\u00edtulo de \n \n\nDOUTOR EM ENGENHARIA \nESPECIALIDADE ENGENHARIA MEC\u00c2NICA \n\n \nsendo aprovada em sua forma final. \n\n \n \n \n\n_______________________________________________________ \nClovis Raimundo Maliska, Ph.D - Orientador \n\n \n_______________________________________________________ \n\nAnt\u00f3nio F\u00e1bio Carvalho da Silva, Dr.Eng. - Co-Orientador \n \n\n_______________________________________________________ \nJos\u00e9 Ant\u00f4nio Bellini da Cunha Neto, Dr. - Coordenador do Curso \n\n \n \n \n\nBANCA EXAMINADORA \n \n\n \n_______________________________________________________ \n\nClovis Raimundo Maliska, Ph.D - Presidente \n \n\n_______________________________________________________ \nDenis Jos\u00e9 Schiozer, Ph.D - Relator \n\n \n_______________________________________________________ \n\n\u00c1lvaro Luiz Gayoso de Azeredo Coutinho, Dr.Eng. \n \n\n_______________________________________________________ \nEduardo Alberto Fancello, D.Sc. \n\n \n_______________________________________________________ \n\nFlavio Dickstein, Dr.Ing. \n \n\n_______________________________________________________ \nR\u00e9gis Kruel Romeu, Dr.Ing. \n\n\n\n\n\n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n\n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n\nDEDICAT\u00d3RIA \n \n\nAos meus pais e irm\u00e3s,  \n\u00e0 minha esposa Scheila e \n\n ao nosso filho L\u00e9o.\n\n\n\n \n \n \n\n\n\n \n\nAAGGRRAADDEECCIIMMEENNTTOOSS  \n \n \n\n \n Aos professores Clovis Raimundo Maliska e Ant\u00f3nio F\u00e1bio Carvalho da Silva pela \n\nvaliosa e indispens\u00e1vel orienta\u00e7\u00e3o e incentivo que possibilitaram o desenvolvimento deste \n\ntrabalho. \n\n Aos amigos do SINMEC, dos alunos da inicia\u00e7\u00e3o cient\u00edfica aos doutorandos, que \n\nderam mostras de companheirismo e contribu\u00edram decisivamente para que os objetivos \n\nfossem alcan\u00e7ados. Particularmente, enalte\u00e7o o apoio dos colegas Bruno Contessi, Lynceo \n\nBraghirolli, Pedro Hinckel, Susie Keller e Fernando Hurtado. \n\n \u00c0 ANP, Ag\u00eancia Nacional do Petr\u00f3leo, que me confiou uma bolsa atrav\u00e9s do \n\nprograma MECPETRO - Programa de Forma\u00e7\u00e3o de Recursos Humanos em Engenharias \n\nMec\u00e2nica e Qu\u00edmica com \u00canfase em Petr\u00f3leo e G\u00e1s (PRH09-ANP/MCT). Al\u00e9m disso, foi \n\nindispens\u00e1vel para a realiza\u00e7\u00e3o desta tese o aux\u00edlio para viagens e taxa de bancada fornecido \n\npor esta ag\u00eancia. \n\n Ao pesquisador visitante da ANP e amigo Axel Dilhlmann que sempre esteve disposto \n\na ajudar em todos momentos, seja na viabiliza\u00e7\u00e3o de recursos financeiros que possibilitaram a \n\nparticipa\u00e7\u00e3o em congressos e outro eventos, seja no apoio e confian\u00e7a conferidos. \n\n Ao Centro de Pesquisas da PETROBRAS - CENPES, na pessoa do Eng. R\u00e9gis Kruel, \n\nque possibilitou o enriquecimento do conhecimento pr\u00e1tico das atividades de simula\u00e7\u00e3o de \n\nreservat\u00f3rios mediante diversos projetos realizados com esta universidade. \n\n Ao Cap\u00edtulo Estudantil da Sociedade dos Engenheiros de Petr\u00f3leo da UNICAMP e ao \n\nprofessor S\u00e9rgio Bordalo que possibilitaram a apresenta\u00e7\u00e3o deste trabalho no International \n\nPaper Contest promovido pela SPE ocorrido no ATCE 2004 em Houston. \n\n Ao Instituto Brasileiro do Petr\u00f3leo e G\u00e1s (IBP), representado pela Gisele Pereira, \n\n\u00c1lvaro Teixeira e Jo\u00e3o C. F. De Luca, que financiou a participa\u00e7\u00e3o deste pesquisador em \n\nimportantes eventos da \u00e1rea de petr\u00f3leo.  \n\n Aos meus pais, irm\u00e3s, amada esposa e filho querido que tiveram que suportar a minha \n\naus\u00eancia em muitos momentos. Muito obrigado pela companhia e confian\u00e7a. \n\n E, finalmente, a Deus que me deu for\u00e7as, coragem e inspira\u00e7\u00e3o para a realiza\u00e7\u00e3o deste \n\ntrabalho. \n\n  \n\n\n\n \n\n\n\n i\n\nSSUUMM\u00c1\u00c1RRIIOO  \n  \n\n  \n\nSIMBOLOGIA ..........................................................................................................................  v \n \nRESUMO ................................................................................................................................  xi \n \nABSTRACT ..............................................................................................................................  xiii \n \n \n1. INTRODU\u00c7\u00c3O .....................................................................................................................   1 \n \n\n1.1. Motiva\u00e7\u00e3o        4 \n \n1.2. Objetivos       5 \n \n1.3. Organiza\u00e7\u00e3o do Trabalho       6 \n\n \n \n2. REVIS\u00c3O BIBLIOGR\u00c1FICA ................................................................................................    9 \n \n\n2.1. Vis\u00e3o Hist\u00f3rica da Simula\u00e7\u00e3o Num\u00e9rica de Reservat\u00f3rios de Petr\u00f3leo          9 \n \n\n2.2. Contextualiza\u00e7\u00e3o do EbFVM em Rela\u00e7\u00e3o aos Demais M\u00e9todos         12 \n \n\n2.3. Utiliza\u00e7\u00e3o de Malhas N\u00e3o-Estruturadas na Simula\u00e7\u00e3o Num\u00e9rica de Reservat\u00f3rios de Petr\u00f3leo     15 \n \n\n2.4. Outros M\u00e9todos Utilizados na Simula\u00e7\u00e3o Num\u00e9rica de Reservat\u00f3rios de Petr\u00f3leo         17 \n \n\n2.5. M\u00e9todos de Solu\u00e7\u00e3o de Sistema de Equa\u00e7\u00f5es Alg\u00e9bricas     18 \n \n2.6. M\u00e9todos Multigrid de Solu\u00e7\u00e3o de Sistemas Lineares          20  \n \n\n \n3. FORMULA\u00c7\u00c3O MATEM\u00c1TICA ...........................................................................................  23 \n \n\n3.1 Equa\u00e7\u00f5es Governantes do Modelo Composicional Geral    23 \n \n\n3.2. Equa\u00e7\u00f5es Governantes do Modelo Black-Oil 26 \n \n\n3.3. Modelo \u00c1gua-\u00d3leo  30 \n \n \n4. FORMULA\u00c7\u00c3O NUM\u00c9RICA,  PARTE 1 - EMBASAMENTO TE\u00d3RICO E FUNDAMENTOS .....  33 \n \n   4.1 O M\u00e9todo EbFVM 34 \n \n\n4.1.1. Transforma\u00e7\u00e3o de Coordenadas \u2013 Globais para Locais         36 \n \n\n4.1.2. Fun\u00e7\u00f5es de Forma como Fun\u00e7\u00f5es de Interpola\u00e7\u00e3o no EbFVM         38 \n \n4.1.3. Avalia\u00e7\u00e3o do Gradiente de Press\u00e3o          39 \n\n  \n\n\n\n \n\n ii\n\n4.1.4. C\u00e1lculo da \u00c1rea de Passagem do Fluxo         42 \n \n4.1.5. Esquema de Avalia\u00e7\u00e3o das Mobilidades     44  \n  \n\n4.2. Representa\u00e7\u00e3o das Propriedades F\u00edsicas         48 \n \n\n4.3. Representa\u00e7\u00e3o das Falhas 50 \n \n\n4.4. Refinamento Local    53 \n \n \n\n5. FORMULA\u00c7\u00c3O NUM\u00c9RICA, PARTE 2 \u2013 CONSIDERA\u00c7\u00d5ES FINAIS E                          \n                                                                                 IMPLEMENTA\u00c7\u00c3O COMPUTACIONAL ...............  55 \n\n \n5.1. M\u00e9todo IMPES        57 \n\n \n5.1.1. Forma\u00e7\u00e3o da Matriz de Coeficientes por Elementos        59 \n \n5.1.2. Forma\u00e7\u00e3o da Matriz Global de Coeficientes        60 \n\n \n5.1.3. Inser\u00e7\u00e3o das Informa\u00e7\u00f5es de Po\u00e7os na Matriz de Coeficientes         62 \n\n \n5.1.4. Inser\u00e7\u00e3o do Termo Transiente na Matriz de Coeficientes  63 \n\n \n5.1.5. Sistema Linear Resultante         64 \n\n \n5.1.6. Determina\u00e7\u00e3o do Passo de Tempo         65 \n\n \n5.2. M\u00e9todo Totalmente Impl\u00edcito      65 \n\n \n5.2.1. Sistema Linear Resultante           66 \n\n \n5.2.2. C\u00e1lculo dos Res\u00edduos     68 \n\n \n5.2.3. C\u00e1lculo das Derivadas dos Res\u00edduos         70 \n\n \n5.2.4. Crit\u00e9rios de Converg\u00eancia e C\u00e1lculo do Passo de Tempo 75 \n\n \n5.2.5. Procedimento Computacional  77 \n\n \n5.3. Esquema de Armazenamento de Matrizes Esparsas        79 \n\n \n \n\n6. M\u00c9TODO MULTIGRID DE SOLU\u00c7\u00c3O  DO SISTEMA LINEAR .............................................  83 \n \n\n6.1. Caracter\u00edsticas do M\u00e9todo Multigrid   83 \n \n\n6.2. Mecanismos Envolvidos no Multigrid      85 \n  \n\n6.2.1. Transfer\u00eancia de Informa\u00e7\u00e3o da Malha Grosseira para a Refinada 85 \n \n\n6.2.2. Solu\u00e7\u00e3o na Malha Grosseira         87 \n \n\n6.2.3. Transfer\u00eancia de Informa\u00e7\u00e3o da Malha Refinada para a Grosseira 91 \n \n\n6.3. Tipos de Ciclos Multigrid 91 \n \n\n6.4. Forma\u00e7\u00e3o da Malha Grosseira        93 \n \n\n6.5. Implementa\u00e7\u00e3o Computacional do Multigrid 97 \n\n\n\n iii\n\n7. AS \u201cTRANSMISSIBILIDADES\u201d NEGATIVAS EM MALHAS TRIANGULARES .......................  101 \n \n\n7.1. A Origem do Conceito de Transmissibilidade 101 \n \n\n7.2. As Transmissibilidades em Malhas Triangulares       103 \n \n \n8. RESULTADOS E COMPARA\u00c7\u00d5ES .......................................................................................  107 \n \n\n8.1. Valida\u00e7\u00e3o Num\u00e9rica    108 \n \n\n8.2. As \u201cTransmissibilidades Negativas\u201d em um Caso Pr\u00e1tico     112 \n \n\n8.3. Compara\u00e7\u00e3o entre as Solu\u00e7\u00f5es do M\u00e9todo Proposto e de um Simulador Comercial  116 \n  \n\n8.3.1. Impacto nos Resultados do Caso Analisado no item 8.2         116 \n \n\n8.3.2. Interpreta\u00e7\u00e3o do Campo de Velocidades do M\u00e9todo EbFVM         120 \n \n\n8.4. As Duas Parcelas do Efeito de Orienta\u00e7\u00e3o de Malha no EbFVM    125 \n \n\n8.4.1. Deslocamento Radial    125 \n \n\n8.4.2. Malhas de Tri\u00e2ngulos Obtus\u00e2ngulos         129 \n \n\n8.4.3. Arranjo de Po\u00e7os Five-Spot 130 \n \n\n8.5. Compara\u00e7\u00e3o entre os Diferentes Esquemas de Representa\u00e7\u00e3o de Propriedades F\u00edsicas e Falhas \nGeol\u00f3gicas no EbFVM          138 \n\n \n8.5.1. Reservat\u00f3rio Heterog\u00eaneo sem Falhas Geol\u00f3gicas       139 \n\n \n8.5.2. Reservat\u00f3rio Heterog\u00eaneo com Falhas Geol\u00f3gicas       141 \n\n \n8.6. Compara\u00e7\u00e3o entre os M\u00e9todos IMPES e Totalmente Impl\u00edcito  149 \n\n \n8.7. Desempenho do M\u00e9todo Multigrid na Simula\u00e7\u00e3o de Reservat\u00f3rios de Petr\u00f3leo         154 \n\n \n8.7.1. Problemas Homog\u00eaneos Resolvidos com IMPES     155 \n\n \n8.7.2. Problemas Homog\u00eaneos Resolvidos com Formula\u00e7\u00e3o Totalmente Impl\u00edcita  163 \n\n \n8.7.3. Problemas Heterog\u00eaneos e Anisotr\u00f3picos       165 \n\n \n8.8. Simula\u00e7\u00e3o com Elementos Triangulares e Quadrangulares e com Refinamento Local        169 \n\n \n \n\n9. CONCLUS\u00d5ES .................................................................................................................... 175 \n \n\n9.1. S\u00edntese das Principais Contribui\u00e7\u00f5es   175 \n \n\n9.2. Sugest\u00f5es para Trabalhos Futuros         177 \n \n\n9.2. Considera\u00e7\u00f5es Finais 179 \n \n \nREFER\u00caNCIAS BIBLIOGR\u00c1FICAS ............................................................................................ 181 \n \nANEXOS ................................................................................................................................. 197\n\n\n\n \n\n iv\n\n\n\n v\n\nSSIIMMBBOOLLOOGGIIAA  \n \n \nAR\u00c1BICOS \n\n \n\nA           matriz de coeficientes da equa\u00e7\u00e3o da press\u00e3o \n\nA\u2019        matriz de coeficientes da equa\u00e7\u00e3o da press\u00e3o sem os termos de \n\ncompressibilidade e po\u00e7os \n\nb           espessura do reservat\u00f3rio, m \n\nb  vetor de termos independentes \n\nB          fator volume de forma\u00e7\u00e3o, m3/m3 \n\n c  compressibilidade do fluido, Pa-1 \n\nc\u00b5   coeficiente que indica a depend\u00eancia da viscosidade com a press\u00e3o, Pa.s / Pa \n\ndjk  dist\u00e2ncia utilizada no c\u00e1lculo do fluxo entre dois volumes de controle j e k \n\nD          matriz de derivadas das fun\u00e7\u00f5es de forma \n\n  DNormX  varia\u00e7\u00e3o da vari\u00e1vel X durante o passo de tempo anterior \n\ne           termo relacionado \u00e0 parcela transiente da equa\u00e7\u00e3o da press\u00e3o \n\nf            termo dependente do modelo de po\u00e7o utilizado \n\nF           vetor de termos independentes da equa\u00e7\u00e3o da press\u00e3o \n\nfm          fluxo fracion\u00e1rio da fase m, adimensional          \n\ng           termo dependente do modelo de po\u00e7o utilizado \n\nh           par\u00e2metro dependente da press\u00e3o e satura\u00e7\u00e3o das fases \n\nH          matriz dependente da geometria e propriedades f\u00edsicas constantes no elemento   \n\nJ           matriz jacobiana da transforma\u00e7\u00e3o \n\nkr          permeabilidade relativa, adimensional \n\nk           tensor permeabilidade absoluta do meio poroso, m2 \n\nL  matriz triangular inferior \n\nL  dist\u00e2ncia de refer\u00eancia, m \n\nm  massa, kg \n\nM          raz\u00e3o de mobilidades  \n\nn           termo relacionado \u00e0 parcela transiente da equa\u00e7\u00e3o da press\u00e3o \n\nn           vetor normal \u00e0 interface de dois sub-volumes \n\n\n\n \n\n vi\n\nN              n\u00famero de inc\u00f3gnitas \n\nNj              fun\u00e7\u00f5es de forma \n\nNm         n\u00famero de fases presentes no reservat\u00f3rio \n\nNNE   N\u00famero de n\u00f3s de um elemento da malha \n\np           press\u00e3o, Pa \n\nq         a vaz\u00e3o volum\u00e9trica de produ\u00e7\u00e3o/inje\u00e7\u00e3o da fase por unidade de volume do \n\nreservat\u00f3rio, s-1 \n\n  q          a vaz\u00e3o volum\u00e9trica nas condi\u00e7\u00f5es de estocagem por unidade de volume do \n\nreservat\u00f3rio, s-1 \n\n  q         vaz\u00e3o volum\u00e9trica de produ\u00e7\u00e3o/inje\u00e7\u00e3o da fase, m3/s \n\nr           raio do po\u00e7o, m \n\nR          matriz de rota\u00e7\u00e3o \n\nRcm        solubilidade do componente c na fase m, m3/m3  \n\nRm        res\u00edduo da equa\u00e7\u00e3o m no m\u00e9todo Totalmente Impl\u00edcito \n\n  R   res\u00edduo da equa\u00e7\u00e3o no solver multigrid \ns           satura\u00e7\u00e3o da fase, adimensional  \n\n  S         vetor \u00e1rea, m2 \n\nt           tempo, s \n\nTjk         transmissibilidade, m3 \n\n?   termo que multiplica a diferen\u00e7a de press\u00e3o no c\u00e1lculo do fluxo, m3 \n\nu  componente da velocidade na dire\u00e7\u00e3o x, m/s \n\nU  matriz triangular superior \n\nVcm        volume do componente c na fase m, m3  \n\nVm   volume da fase m no reservat\u00f3rio, m3  \n\nVmm       volume do componente m na fase m, m3  \n\nV          velocidade da fase, m/s \n\nV?        volume do volume de controle, m3  \n\nW        fun\u00e7\u00e3o peso  \n\nWI        \u00edndice de po\u00e7o, m3  \n\nx           coordenada global, m \n\nXcm        fra\u00e7\u00e3o m\u00e1ssica do componente c na fase m, kg/kg \n\ny                coordenada global, m \n\nZ          matriz de coordenadas dos n\u00f3s \n\n\n\n vii\n\nGREGOS \n\n \n\n?  \u00e1rea da face do sub-volume de controle em coordenadas locais \n\n?         porosidade \n\n?   vari\u00e1vel gen\u00e9rica \n\n?         coordenada local \n\n?          mobilidade, 1/Pa.s \n\n\u00b5          viscosidade, Pa.s \n\n?         massa espec\u00edfica, kg/m3 \n\n?  coordenada local \n\nI?   valor de corre\u00e7\u00e3o aplicado \u00e0 c\u00e9lula grosseira I \n\n?    constante empregada nos processos de aglomera\u00e7\u00e3o no multigrid \n\n \n\n \n\n \n\nSUBSCRITOS \n\n \n\nA  grandeza adimensionalizada \n\nc  componente ou esp\u00e9cie qu\u00edmica presente em uma fase \n\ne         referente ao elemento  \n\neq        valor m\u00e9dio equivalente do bloco  \n\nfp        valor do fundo de po\u00e7o \n\ni           ponto de integra\u00e7\u00e3o \n\ni  valor irredut\u00edvel \n\ninj  referente a uma grandeza injetada \n\nI  c\u00e9lula grosseira \n\nj  \u00edndice utilizado para indicar o n\u00f3 vizinho ao n\u00f3 k \n\nk  \u00edndice utilizado para indicar o n\u00f3 vizinho ao n\u00f3 j \n\nm         \u00edndice utilizado para indicar cada fase (m = w ou o) \n\nm        ponto m\u00e9dio do sub-volume de controle \n\nm\u00e1x     valor m\u00e1ximo \n\nmin      valor m\u00ednimo \n\nn          n\u00f3 do volume de controle que cont\u00e9m o po\u00e7o \n\n\n\n \n\n viii\n\nnb  n\u00f3s vizinhos a P \n\nNB  blocos vizinhos a I \n\no          \u00edndice da fase \u00f3leo  \n\nP          n\u00f3 da malha ou ponto central do volume submetido \u00e0 integra\u00e7\u00e3o num\u00e9rica \n\nPr        valor prescrito \n\nr  valor residual \n\nsvc       sub-volume de controle \n\nT          total = \u00e1gua + \u00f3leo \n\nw          \u00edndice da fase \u00e1gua   \n\nw     valor relativo ao po\u00e7o \n\n \n\n \n\n \nSUPERSCRITOS \n\n \n\ne  referente a propriedade calculada nas condi\u00e7\u00f5es de estocagem na superf\u00edcie \n\no          valor utilizado do n\u00edvel temporal anterior \n\nmax     valor m\u00e1ximo \n\nn  expoente da curva de Corey \n\nref        valor de refer\u00eancia  \n\n?      n\u00edvel iterativo \n\n*  valor corrigido \n\nuser  valores especificados pelo usu\u00e1rio \n\n?   simboliza que ainda n\u00e3o est\u00e1 definido em que limites do intervalo de tempo \n\nser\u00e1 avaliada a propriedade \n\n?   a taxa que indica o aumento do esfor\u00e7o do solver com o n\u00famero de vari\u00e1veis \n\n \n\n \n\n \n\nMATEM\u00c1TICOS \n\n \n\n[  ]        matriz quadrada ou retangular \n\n{  }        matriz coluna \n\n[  ]-1      matriz inversa \n\n\n\n ix\n\n[  ]T       matriz transposta \n\n[  ]e       matriz do elemento \n\n[  ]i      matriz com termos avaliados no ponto de integra\u00e7\u00e3o i \n\n?  pertence a \n\n?  n\u00e3o-pertence a \n\n?  cada componente de um conjunto \n\nmax  fun\u00e7\u00e3o que retorna o valor m\u00e1ximo entre dois argumentos \n\n \n\n \n\n \n\nACR\u00d4NIMOS \n\n \nACM   The Additive Correction Multigrid \n\nAIM   The Adaptive Implicit Method \n\nCFL   N\u00famero de Courant-Friedrichs-Lewy \n\nCSR    Compressed Sparse Row \n\nCVFEM  Control Volume Finite Element Method \n\nEbFVM  Element-based Finite Volume Method  \n\n(M\u00e9todo de Volumes Finitos baseado em Elementos) \n\nFDM   M\u00e9todo de Diferen\u00e7as Finitas  \n\nFEM   M\u00e9todo de Elementos Finitos \n\nFVM    M\u00e9todo de Volumes Finitos \n\nGMRES  Generalized Minimum Residual \n\nGS   Gauss-Seidel \n\nILU   Incomplete LU decomposition \n\nIMPES   Implicit Pressure and Explicit Saturations \n\nLU   Lower and Upper triangular decomposition \n\nSSOR   Symmetric Successive Over Relaxation \n\nUDS   Upwind Differencing Scheme \n\nVPI   Volume Poroso Injetado \n\n \n\n\n\n \n\n x\n\n\n\n xi\n\nRREESSUUMMOO  \n \n\n \n\nEste trabalho prop\u00f5e uma metodologia num\u00e9rica para a simula\u00e7\u00e3o do escoamento \n\nmultif\u00e1sico em reservat\u00f3rios de petr\u00f3leo utilizando o M\u00e9todo de Volumes Finitos baseado em \n\nElementos (EbFVM). Este m\u00e9todo emprega malhas n\u00e3o-estruturadas com elementos \n\ntriangulares e/ou quadrangulares, o que lhe confere maior flexibilidade e generalidade. Os \n\npoucos m\u00e9todos dispon\u00edveis na literatura de petr\u00f3leo que utilizam malhas n\u00e3o-estruturadas \n\ntratam os fluxos nas interfaces dos volumes de controle de forma inadequada. Isto causa \n\ndificuldades quando tri\u00e2ngulos obtusos s\u00e3o empregados e origina interpreta\u00e7\u00f5es equivocadas \n\nda transmissibilidade. Prop\u00f5e-se neste trabalho um novo c\u00e1lculo do fluxo da forma exata e \n\nque flexibiliza o processo de constru\u00e7\u00e3o de malhas que representem com maior fidelidade as \n\nheterogeneidades, po\u00e7os horizontais e verticais, e falhas, o que contribui para a diminui\u00e7\u00e3o do \n\ntempo de simula\u00e7\u00e3o. A solu\u00e7\u00e3o das equa\u00e7\u00f5es resultantes foi obtida empregando-se os m\u00e9todos \n\nIMPES (Implicit Pressure Explicit Saturation) e Totalmente Impl\u00edcito. O sistema linear foi \n\nresolvido pelo m\u00e9todo multigrid baseado na corre\u00e7\u00e3o aditiva, que aglomera os blocos da \n\nmalha levando em considera\u00e7\u00e3o os coeficientes do sistema linear.  \n\nA opera\u00e7\u00e3o de refinamento localizado \u00e9 facilitado pela ado\u00e7\u00e3o de um sistema de \n\ncoordenadas locais que permite um tratamento similar a todos os elementos da malha o que \n\nelimina a imprecis\u00e3o num\u00e9rica das t\u00e9cnicas de refino tradicionais. Demonstra-se que \u00e9 \n\nposs\u00edvel lidar com os mapas de permeabilidade em sua forma completa e sem m\u00e9dias, um \n\naspecto importante na simula\u00e7\u00e3o de reservat\u00f3rios heterog\u00eaneos e anisotr\u00f3picos. O modelo \n\nresultante \u00e9 fisicamente consistente e leva a uma clara interpreta\u00e7\u00e3o das transmissibilidades, \n\nrevelando que tri\u00e2ngulos ret\u00e2ngulos e obtusos podem ser usados sem maiores restri\u00e7\u00f5es. Ao \n\ncomparar os resultados obtidos com os dos modelos usualmente empregados na simula\u00e7\u00e3o de \n\nreservat\u00f3rios de petr\u00f3leo, o m\u00e9todo EbFVM proposto mostrou-se mais flex\u00edvel e menos \n\nsuscept\u00edvel ao efeito de orienta\u00e7\u00e3o de malha.  \n\n\n\n \n\n xii\n\n\n\n xiii\n\nAABBSSTTRRAACCTT  \n \n\n \n\nIn this work a numerical model for simulating the multiphase flow in petroleum \n\nreservoirs using an Element-based Finite Volume Method (EbFVM), also known as CVFEM, \n\nis presented. The method employs unstructured grids with triangular and/or quadrilateral \n\nelements, rendering to the method flexibility and generality. The few methods available in the \n\npetroleum literature which uses unstructured grids do not follow a rigorous procedure for the \n\nfluxes determination. This causes difficulties when obtuse triangles are employed, giving rise \n\nto a misinterpretation of the transmissibility. The procedure advanced here, on the other hand, \n\nperforms exact calculation of the mass fluxes and introduces facilitates to build grids for \n\nrepresenting heterogeneities, horizontal wells and faults with more fidelity, contributing to \n\ndecrease the simulation time. The resulting discretized equations were solved employing the \n\nmethods IMPES (Implicit Pressure Explicit Saturation) and Fully Implicit. The resulting \n\nlinear system was solved with the additive correction multigrid method, which agglomerates \n\nthe grid-blocks based on the coefficients of the linear system.  \n\nLocal refinement is naturally done in this method, without the difficulties encountered \n\nin structured methods for the flux calculation at the intersection of coarse and fine grids. It is \n\ndemonstrated that this method can deal with the permeability maps without averaging \n\nprocedures, which is an important issue in simulating heterogeneous and anisotropic \n\nreservoirs. The physically consistent approach obtained leads to a clear interpretation of the \n\ntransmissibility, revealing that right-angle or obtuse triangles can be used without grid \n\nconstruction restrictions. It is also demonstrated that it is less susceptible to the grid \n\norientation effect with the increasing of the mobility ratio. The results obtained using the \n\nscheme proposed in this work in the EbFVM framework show its superiority over the \n\nschemes commonly used in petroleum reservoir simulation. \n\n\n\n \n\n\n\n1 \n\nCap.    \n\n1 IINNTTRROODDUU\u00c7\u00c7\u00c3\u00c3OO    \n \n\n \n  \n\nNa ind\u00fastria petroleira existe uma s\u00e9rie de par\u00e2metros que devem ser avaliados antes \n\nde se decidir pela viabilidade ou n\u00e3o de um reservat\u00f3rio natural de petr\u00f3leo. M\u00e9todos diversos \n\nque possam contribuir para uma tomada de decis\u00e3o s\u00e3o, de uma forma geral, bem aceitos nas \n\nempresas. E a raz\u00e3o \u00e9 que elas precisam ter boas estimativas de produ\u00e7\u00e3o que constituem-se, \n\nfreq\u00fcentemente, em par\u00e2metros cruciais utilizados pelos investidores e analistas financeiros \n\npara avaliar o seu potencial futuro. Neste sentido, as ferramentas num\u00e9ricas s\u00e3o importantes \n\ninstrumentos, j\u00e1 que a experimenta\u00e7\u00e3o em laborat\u00f3rio \u00e9 imposs\u00edvel, e a extra\u00e7\u00e3o de petr\u00f3leo e \n\ntodas as opera\u00e7\u00f5es vinculadas a ela podem ser otimizadas se houver uma forma de prever o \n\ncomportamento do reservat\u00f3rio. Assim, os simuladores de reservat\u00f3rios de petr\u00f3leo t\u00eam uma \n\ndecisiva fun\u00e7\u00e3o na ind\u00fastria, e por isso t\u00eam recebido muita aten\u00e7\u00e3o em centros de pesquisa \n\np\u00fablicos e privados. \n\nOs reservat\u00f3rios de petr\u00f3leo s\u00e3o constitu\u00eddos por rochas porosas localizadas na regi\u00e3o \n\nsubterr\u00e2nea, onde o petr\u00f3leo cru est\u00e1 estocado, conforme ilustrado na Fig. 1.1. O petr\u00f3leo \u00e9 \n\nproduzido originalmente na rocha geradora, por\u00e9m ele migra, principalmente por capilaridade \n\ne for\u00e7as de empuxo, para a rocha reservat\u00f3rio, n\u00e3o conseguindo se deslocar para cima em \n\nfun\u00e7\u00e3o da presen\u00e7a de uma rocha capeadora, que tem baixa permeabilidade e que o envolve \n\nna parte superior. Portanto, para os interesses desta tese, a solu\u00e7\u00e3o num\u00e9rica ter\u00e1 como \n\ndom\u00ednio apenas a regi\u00e3o onde o petr\u00f3leo permanece armazenado - a rocha reservat\u00f3rio. Esta \n\nsitua\u00e7\u00e3o f\u00edsica descrita \u00e9 bem diferente daquela imaginada por algumas pessoas que cr\u00eaem \n\nque o petr\u00f3leo \u00e9 encontrado em grandes \u201ccavernas\u201d, e o \u00fanico trabalho para retir\u00e1-lo \u00e9 o \n\nbombeamento. Na maioria das vezes, o petr\u00f3leo s\u00f3 pode ser retirado do meio poroso atrav\u00e9s \n\nda a\u00e7\u00e3o de grandes gradientes de press\u00e3o criados por mecanismos f\u00edsicos bem mais \n\nelaborados que os das bombas hidr\u00e1ulicas, denominados de processos de recupera\u00e7\u00e3o \n\navan\u00e7ada. \n\n\n\n2 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n \n\n \n\n \n \n\nFig. 1.1 - Representa\u00e7\u00e3o do corte vertical de um reservat\u00f3rio sujeito a um processo de                                             \n\nrecupera\u00e7\u00e3o de petr\u00f3leo com inje\u00e7\u00e3o de \u00e1gua. \n\n \n\n \n\nEm alguns casos, nos primeiros meses de produ\u00e7\u00e3o de um reservat\u00f3rio, em fun\u00e7\u00e3o das \n\nelevadas press\u00f5es internas, a retirada do petr\u00f3leo \u00e9 feita sem grande esfor\u00e7o externo. Esta \n\netapa recebe o nome de recupera\u00e7\u00e3o prim\u00e1ria, e s\u00f3 \u00e9 poss\u00edvel em fun\u00e7\u00e3o da \u201cenergia\u201d \n\nexistente no reservat\u00f3rio em forma de press\u00e3o, que prov\u00e9m dos gases sol\u00faveis no \u00f3leo, capas \n\nde g\u00e1s, e do contato, muitas vezes existente, com aq\u00fc\u00edferos naturais. \u00c0 medida que esta \n\nenergia vai decrescendo, a produ\u00e7\u00e3o tamb\u00e9m vai diminuindo, embora grande parte do \n\npetr\u00f3leo ainda permane\u00e7a no reservat\u00f3rio. A solu\u00e7\u00e3o imediata \u00e9 a utiliza\u00e7\u00e3o dos processos de \n\nrecupera\u00e7\u00e3o secund\u00e1ria, Fig. 1.1, que caracteriza-se pela inje\u00e7\u00e3o de \u00e1gua em alguns po\u00e7os \n\ncom o intuito de suplementar a energia do reservat\u00f3rio e \u201cfor\u00e7ar\u201d o petr\u00f3leo a escoar em \n\ndire\u00e7\u00e3o aos po\u00e7os produtores. \n\nA efici\u00eancia deste processo, em alguns casos, \u00e9 ainda bastante baixa porque depende, \n\nprincipalmente, das mobilidades dos fluidos residentes (petr\u00f3leo, g\u00e1s etc.) e injetado (\u00e1gua). \n\nPara aumentar ainda mais a quantidade de \u00f3leo produzido, deve-se utilizar t\u00e9cnicas de \n\nrecupera\u00e7\u00e3o terci\u00e1ria, que usam m\u00e9todos qu\u00edmicos, como a inje\u00e7\u00e3o de pol\u00edmeros adicionados \n\n\u00e0 \u00e1gua, m\u00e9todos t\u00e9rmicos, como a combust\u00e3o in situ, e outros, como inje\u00e7\u00e3o de g\u00e1s natural, \n\n\n\n CAP. 1 \u2013 INTRODU\u00c7\u00c3O 3 \n\n \n\n \n\ng\u00e1s carb\u00f4nico, introdu\u00e7\u00e3o de bact\u00e9rias etc1. As pesquisas ainda s\u00e3o incipientes em se tratando \n\nda muitos desses m\u00e9todos de recupera\u00e7\u00e3o, e por isso ainda n\u00e3o s\u00e3o usados na maioria das \n\nempresas de petr\u00f3leo. Contudo, os resultados preliminares t\u00eam sido muito promissores, apesar \n\ndos altos custos normalmente envolvidos nesses processos (MATTAX e DALTON, 1990; \n\nDYKE, 1997). Como todos esses m\u00e9todos de recupera\u00e7\u00e3o s\u00e3o pass\u00edveis de serem modelados e \n\nestudados numericamente, pode-se notar novamente que o papel da simula\u00e7\u00e3o num\u00e9rica de \n\nreservat\u00f3rios de petr\u00f3leo \u00e9 cada vez mais importante. Isso \u00e9 verdade mesmo que ainda hajam, \n\nem muitos casos, grandes incertezas na caracteriza\u00e7\u00e3o do reservat\u00f3rio e na determina\u00e7\u00e3o de \n\nsuas propriedades f\u00edsicas. Essas incertezas f\u00edsicas n\u00e3o impedem, contudo, a busca de solu\u00e7\u00f5es \n\nque incrementem os modelos matem\u00e1ticos adotados e que resultem em melhores previs\u00f5es, \n\ncomo as propostas neste trabalho2.  \n\nEm geral, o conjunto de equa\u00e7\u00f5es resultantes do modelo matem\u00e1tico empregado na \n\nsimula\u00e7\u00e3o de reservat\u00f3rios \u00e9 demasiadamente complexo para ser resolvido analiticamente. \n\nPor isso utilizam-se m\u00e9todos num\u00e9ricos que aproximam um sistema de equa\u00e7\u00f5es diferenciais \n\nparciais em um sistema linear de equa\u00e7\u00f5es alg\u00e9bricas. Neste caso a solu\u00e7\u00e3o passa a ser obtida \n\npara um n\u00famero discreto de pontos definidos por uma malha, assumindo-se um determinado \n\nerro que diminui quanto maior for esse n\u00famero de pontos. Os primeiros simuladores de \n\npetr\u00f3leo empregavam inicialmente apenas malhas Cartesianas, como a utilizada na \n\nrepresenta\u00e7\u00e3o do reservat\u00f3rio da Fig. 1.2a. A dificuldade de representar adequadamente as \n\ngeometrias complexas dos reservat\u00f3rios motivou a introdu\u00e7\u00e3o de malhas curvil\u00edneas, \n\ndenominadas de malhas corner-points, tal qual a apresentada na Fig. 1.2b, que s\u00e3o constru\u00eddas \n\na partir da defini\u00e7\u00e3o dos v\u00e9rtices de cada bloco da malha. Essas malhas, conhecidas como \n\nmalhas de 2\u00aa. gera\u00e7\u00e3o, t\u00eam a desvantagem de ainda serem estruturadas, o que ocasiona em \n\nmuitos casos a concentra\u00e7\u00e3o desnecess\u00e1ria de n\u00f3s em regi\u00f5es do dom\u00ednio de pouco interesse, \n\n                                                 \n1 Verifica-se uma tend\u00eancia na literatura moderna de petr\u00f3leo em classificar os m\u00e9todos de recupera\u00e7\u00e3o \nempregando-se apenas as express\u00f5es \u201cprim\u00e1rios\u201d e \u201csecund\u00e1rios\u201d (THOMAS, 2001; GERRITSEN e \nDURLOFSKY, 2005; ROSA et al, 2006). Os m\u00e9todos atualmente conhecidos como m\u00e9todos de recupera\u00e7\u00e3o \nsecund\u00e1ria s\u00e3o identificados nesta nova proposta como m\u00e9todos convencionais de recupera\u00e7\u00e3o secund\u00e1ria, \nenquanto que os m\u00e9todos de recupera\u00e7\u00e3o terci\u00e1ria s\u00e3o chamados de m\u00e9todos especiais de recupera\u00e7\u00e3o \nsecund\u00e1ria, ou no ingl\u00eas: Enhanced Oil Recovery. Nesta nova classifica\u00e7\u00e3o, qualquer m\u00e9todo de recupera\u00e7\u00e3o \nque \u00e9 utilizado para aumentar a efici\u00eancia de recupera\u00e7\u00e3o e/ou acelerar a produ\u00e7\u00e3o em rela\u00e7\u00e3o \u00e0 produ\u00e7\u00e3o \nprim\u00e1ria \u00e9 denominado de recupera\u00e7\u00e3o secund\u00e1ria. \n\n2 Na realidade, a simula\u00e7\u00e3o num\u00e9rica tamb\u00e9m \u00e9 respons\u00e1vel, de certa forma, pela determina\u00e7\u00e3o de propriedades \nf\u00edsicas cada vez mais representativas, haja vista o desenvolvimento de m\u00e9todos num\u00e9ricos como os que \ndeterminam as curvas de permeabilidades relativas atrav\u00e9s da simula\u00e7\u00e3o de deslocamento em amostras porosas \n(MEJIA et al., 1995; KULKARNI et al., 1998; HURTADO et al., 2004), os que determinam as permeabilidades \nabsolutas e porosidades atrav\u00e9s da simula\u00e7\u00e3o de problemas de mudan\u00e7a de escala - upscaling (RENARD e \nMARSILY, 1997; CHEN et al., 2003), da simula\u00e7\u00e3o com o M\u00e9todo de Lattice-Boltzmann (SANTOS et al., \n2005), entre outros. \n\n\n\n4 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n \n\n \n\nal\u00e9m do fato de que os simuladores comerciais utilizam um esquema de c\u00e1lculo dos fluxos \n\nimpreciso quando a malha \u00e9 n\u00e3o-ortogonal (CORDAZZO et al., 2002). \n\n \n\n \n\n \n\nFig. 1.2 - Diferentes tipos de malhas que podem ser utilizados na representa\u00e7\u00e3o do reservat\u00f3rio da Fig. 1.1 \n\n \n\n \n\n1.1. Motiva\u00e7\u00e3o \n \n\nAs dificuldades associadas \u00e0 representa\u00e7\u00e3o espacial de dom\u00ednios arbitr\u00e1rios com \n\nmalhas estruturadas em reservat\u00f3rios com falhas e heterogeneidades, e a imprecis\u00e3o num\u00e9rica \n\ndas t\u00e9cnicas de refinamento localizado t\u00eam motivado o interesse pela pesquisa na \u00e1rea da \n\nsimula\u00e7\u00e3o num\u00e9rica de reservat\u00f3rios para a utiliza\u00e7\u00e3o de malhas n\u00e3o-estruturadas, como a \n\napresentada na Fig. 1.2c. Essas malhas formadas por tri\u00e2ngulos e/ou quadril\u00e1teros (em 2D) se \n\nconformam com mais facilidade, aumentando a flexibilidade na representa\u00e7\u00e3o geom\u00e9trica dos \n\nreservat\u00f3rios. Alguns trabalhos da literatura propuseram o uso de tais malhas, mas com \n\ndiversas limita\u00e7\u00f5es de ordem pr\u00e1tica, seja por empregar dois pontos para a aproxima\u00e7\u00e3o do \n\nfluxo e necessidade de ortogonalidade local, no caso das malhas de Voronoi (HEINEMANN \n\net al., 1991; PALAGI e AZIZ, 1991), seja pela dedu\u00e7\u00e3o das equa\u00e7\u00f5es sob a \u00f3tica das malhas \n\nestruturadas, procurando manter a interpreta\u00e7\u00e3o f\u00edsica de termos que n\u00e3o existem mais em \n\nmalhas n\u00e3o-estruturadas (FUNG et al., 1991). Neste \u00faltimo caso, os erros num\u00e9ricos \n\nacentuam-se demasiadamente quando s\u00e3o utilizados elementos de malha mais deformados. \n\nEstes m\u00e9todos num\u00e9ricos visam uma maior precis\u00e3o nos resultados devido a uma \n\n                                       \n \n\n(a) Malhas Cartesianas                                                           (b) Malhas corner-points \n\n \n\n \n \n\n(c) Malhas n\u00e3o-estruturadas (propostas neste trabalho) \n\n\n\n CAP. 1 \u2013 INTRODU\u00c7\u00c3O 5 \n\n \n\n \n\nrepresenta\u00e7\u00e3o mais fiel do dom\u00ednio, mas perdem-na ao simplificar os c\u00e1lculos dos fluxos entre \n\nos volumes de controle. Em resumo, os m\u00e9todos atuais que empregam malhas n\u00e3o-\n\nestruturadas n\u00e3o re\u00fanem flexibilidade com precis\u00e3o. A proposta deste trabalho, descrita a \n\nseguir, busca este objetivo. \n\n \n\n \n\n1.2. Objetivos \n \n\nA partir do exposto na se\u00e7\u00e3o anterior, pode-se apresentar o objetivo principal deste \n\ntrabalho que \u00e9 desenvolver uma metodologia num\u00e9rica para a simula\u00e7\u00e3o de reservat\u00f3rios de \n\npetr\u00f3leo que utiliza o M\u00e9todo de Volumes Finitos baseado em Elementos (EbFVM) com \n\nsolver3 multigrid, comparando-o com outras op\u00e7\u00f5es dispon\u00edveis nos simuladores comerciais. \n\nNas \u00faltimas d\u00e9cadas o EbFVM vem sendo utilizado para a solu\u00e7\u00e3o das equa\u00e7\u00f5es de Navier-\n\nStokes, constituindo-se na forma mais adequada para generalizar o m\u00e9todo dos volumes \n\nfinitos (SCHNEIDER e ZEDAN, 1983; RAW, 1985; SOUZA, 2000). Prop\u00f5e-se utilizar \n\nmalhas bidimensionais n\u00e3o-estruturadas de tri\u00e2ngulos e/ou quadril\u00e1teros no EbVFM, sem as \n\nrestri\u00e7\u00f5es de forma encontradas nos m\u00e9todos tradicionais.  \n\nOs objetivos espec\u00edficos podem ser resumidos como: \n\n \n\n Obter as equa\u00e7\u00f5es discretizadas do modelo matem\u00e1tico a partir do m\u00e9todo EbFVM. \n\n Apresentar a forma de solu\u00e7\u00e3o das equa\u00e7\u00f5es resultantes atrav\u00e9s das t\u00e9cnicas IMPES \n\n(Implicit Pressure and Explicit Saturation) e Totalmente Impl\u00edcita, que requerem a \n\nimplementa\u00e7\u00e3o de novos procedimentos de c\u00e1lculo de derivadas e res\u00edduos \n\naplic\u00e1veis para malhas n\u00e3o-estruturadas.  \n\n Estudar as alternativas de armazenamento das propriedades f\u00edsicas, como \n\npermeabilidade absoluta e porosidade, e a modelagem de falhas geol\u00f3gicas no \n\ncontexto das malhas n\u00e3o-estruturadas. \n\n Implementar e avaliar o solver multigrid alg\u00e9brico baseado na corre\u00e7\u00e3o aditiva \n\n(HUTCHINSON e RAITHBY, 1986) para a solu\u00e7\u00e3o do sistema linear originado \n\n                                                 \n3 Por praticidade, o m\u00e9todo de solu\u00e7\u00e3o do sistema linear ser\u00e1 simplesmente denominado de solver neste trabalho. \n \n\n\n\n6 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n \n\n \n\ncom o m\u00e9todo EbFVM. \u00c9 importante o desenvolvimento de um solver robusto4 e \n\nr\u00e1pido uma vez que grande parte do esfor\u00e7o computacional de uma simula\u00e7\u00e3o \u00e9 \n\ndespendido nesta etapa. N\u00e3o se tem conhecimento da aplica\u00e7\u00e3o deste tipo de m\u00e9todo \n\nmultigrid alg\u00e9brico em problemas de petr\u00f3leo. A sua principal caracter\u00edstica \u00e9 a \n\npossibilidade de resolver sistemas lineares independentemente se a malha do \n\nproblema que os originou \u00e9 estruturada ou n\u00e3o.  \n\n Pretende-se tamb\u00e9m esclarecer certos t\u00f3picos que t\u00eam causado confus\u00e3o na \n\nutiliza\u00e7\u00e3o das malhas n\u00e3o-estruturadas em simula\u00e7\u00e3o de reservat\u00f3rios de petr\u00f3leo, \n\nprincipalmente aqueles relacionados ao c\u00e1lculo do fluxo entre volumes de controle. \n\nAs transmissibilidades negativas, por exemplo, s\u00e3o termos importantes que \n\naparecem nas equa\u00e7\u00f5es de conserva\u00e7\u00e3o discretizadas e t\u00eam sido um empecilho para \n\na utiliza\u00e7\u00e3o de malhas n\u00e3o-estruturadas nesta \u00e1rea. \n\n \n\nComo objetivo final prop\u00f5e-se avaliar a metodologia num\u00e9rica proposta que, na \n\nrealidade, culmina com o desenvolvimento de um completo simulador de reservat\u00f3rios de \n\npetr\u00f3leo, comparando seus resultados com aqueles obtidos a partir dos simuladores \n\ncomerciais e com resultados provenientes de outros trabalhos publicados na literatura.  \n\n \n\n \n\n1.3. Organiza\u00e7\u00e3o do Trabalho \n \n\nAl\u00e9m deste primeiro e introdut\u00f3rio cap\u00edtulo, esta tese est\u00e1 distribu\u00edda em mais oito \n\ncap\u00edtulos, estruturados de forma que as informa\u00e7\u00f5es s\u00e3o apresentadas seq\u00fcencialmente \n\nvisando facilitar o entendimento do leitor. O Cap. 2 cont\u00e9m uma revis\u00e3o bibliogr\u00e1fica que \n\ndescreve sucintamente alguns dos trabalhos relatados na literatura e procura contextualiz\u00e1-los \n\nem termos da sua contribui\u00e7\u00e3o para o atual estado da arte da simula\u00e7\u00e3o num\u00e9rica de \n\nreservat\u00f3rios de petr\u00f3leo. \n\nNo Cap. 3 o problema f\u00edsico \u00e9 formulado e as equa\u00e7\u00f5es governantes do escoamento \n\nem meios porosos s\u00e3o deduzidas. Tamb\u00e9m \u00e9 apresentado o modelo f\u00edsico adotado. \n\n \n\n                                                 \n4 Robustez \u00e9 a capacidade de resolver sistemas lineares provenientes de diferentes problemas f\u00edsicos sem perda \nsens\u00edvel de efici\u00eancia. Solvers robustos requerem pouca interven\u00e7\u00e3o do usu\u00e1rio na mudan\u00e7a de seus par\u00e2metros. \n\n\n\n CAP. 1 \u2013 INTRODU\u00c7\u00c3O 7 \n\n \n\n \n\nNo Cap. 4 \u00e9 apresentado de forma detalhada o processo de obten\u00e7\u00e3o das equa\u00e7\u00f5es \n\ndiscretizadas no M\u00e9todo dos Volumes Finitos baseado em Elementos (EbFVM). Tamb\u00e9m s\u00e3o \n\ndiscutidos alguns detalhes referentes a este m\u00e9todo, como suas alternativas de representa\u00e7\u00e3o \n\ndas propriedades f\u00edsicas e falhas e o procedimento de refinamento local de malha. \n\nA implementa\u00e7\u00e3o computacional das duas alternativas de solu\u00e7\u00e3o do sistema de \n\nequa\u00e7\u00f5es adotadas neste trabalho \u00e9 discutida no Cap. 5, onde os procedimentos de forma\u00e7\u00e3o \n\ndas matrizes de coeficientes locais e globais s\u00e3o destacados. \n\nNo Cap. 6 s\u00e3o apresentados alguns aspectos relevantes de implementa\u00e7\u00e3o do solver \n\nmultigrid, como os mecanismos de transfer\u00eancia de informa\u00e7\u00e3o entre diferentes malhas, \n\noperadores de restri\u00e7\u00e3o e prolonga\u00e7\u00e3o, tipos de ciclos etc. \n\nO problema relatado na literatura da ocorr\u00eancia de transmissibilidades negativas \n\nquando determinados tipos de elementos triangulares s\u00e3o utilizados \u00e9 discutido no Cap. 7. \n\nInicialmente s\u00e3o revisados alguns conceitos importantes relativos \u00e0s transmissibilidades, \n\nsendo na seq\u00fc\u00eancia estudada a sua aplica\u00e7\u00e3o em malhas que utilizam tri\u00e2ngulos.  \n\nOs resultados, compara\u00e7\u00f5es e discuss\u00f5es est\u00e3o reservados para o Cap. 8, enquanto que \n\nas conclus\u00f5es finais e sugest\u00f5es para trabalhos futuros s\u00e3o apresentadas no Cap. 9. \n\n\n\n \n\n\n\n9 \n\nCap.    \n\n2 RREEVVIISS\u00c3\u00c3OO  BBIIBBLLIIOOGGRR\u00c1\u00c1FFIICCAA    \n \n\n \n \n\nNeste cap\u00edtulo \u00e9 apresentada a vis\u00e3o geral de alguns trabalhos relacionados aos \n\nassuntos estudados e desenvolvidos nesta tese que tiveram import\u00e2ncia hist\u00f3rica e cient\u00edfica \n\npara o estado da arte da simula\u00e7\u00e3o num\u00e9rica de reservat\u00f3rios de petr\u00f3leo. Esses trabalhos s\u00e3o \n\nsucintamente descritos e discutidos, sendo que uma discuss\u00e3o mais profunda, quando \n\nnecess\u00e1ria, ser\u00e1 feita nos cap\u00edtulos seguintes onde estas quest\u00f5es ser\u00e3o abordadas com mais \n\ndetalhes. \n\n \n\n \n\n2.1. Vis\u00e3o Hist\u00f3rica da Simula\u00e7\u00e3o Num\u00e9rica de \nReservat\u00f3rios de Petr\u00f3leo \n\n \n\nDesde a perfura\u00e7\u00e3o do primeiro po\u00e7o de petr\u00f3leo em 1859 at\u00e9 os prim\u00f3rdios do s\u00e9culo \n\n20, as pessoas que trabalhavam nas companhias petroleiras n\u00e3o se preocupavam nos aspectos \n\nt\u00e9cnicos dos mecanismos f\u00edsicos presentes nos reservat\u00f3rios. Foi s\u00f3 a partir da d\u00e9cada de 1930 \n\nque come\u00e7aram os primeiros estudos utilizando-se modelos f\u00edsicos an\u00e1logos, como \n\nescoamentos em caixas de areia e circuitos el\u00e9tricos (NASH, 1990). A Fig. 2.1 apresenta \n\nresumidamente o quadro hist\u00f3rico do avan\u00e7o cient\u00edfico nesta \u00e1rea, que culminou no est\u00e1gio \n\natual da simula\u00e7\u00e3o num\u00e9rica de reservat\u00f3rios de petr\u00f3leo, e destaca alguns acontecimentos \n\nimportantes que ser\u00e3o considerados nesta se\u00e7\u00e3o.  \n\nOs primeiros simuladores de reservat\u00f3rios de petr\u00f3leo surgiram na d\u00e9cada de 1950, \n\nquando algumas companhias petroleiras juntaram esfor\u00e7os em pesquisa fundamental e an\u00e1lise \n\nnum\u00e9rica a fim de desenvolver m\u00e9todos pr\u00e1ticos para uso nos computadores da \u00e9poca \n\n(MATTAX e DALTON, 1990). A principal motiva\u00e7\u00e3o eram as atividades de planejamento de \n\n\n\n10 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nm\u00e9dio e longo prazo em grandes reservat\u00f3rios, que eram aqueles que compensavam os \n\ninvestimentos nestes estudos. Os desenvolvimentos iniciais em simula\u00e7\u00e3o num\u00e9rica utilizaram \n\nmalhas Cartesianas (TODD et al., 1972; AZIZ e SETTARI, 1979; YANOSIK e \n\nMACCRACKEN,1979), que \u00e9 uma das op\u00e7\u00f5es dispon\u00edveis e ainda muito utilizada nos \n\nsimuladores comerciais atuais.  \n\n \n\n \n\n \n\nFig. 2.1 - Quadro hist\u00f3rico de acontecimentos relacionados \u00e0 simula\u00e7\u00e3o num\u00e9rica de reservat\u00f3rios de petr\u00f3leo \n\n(baseado no texto de Donald W. Peaceman em Nash (1990) e na literatura de petr\u00f3leo em geral) \n\n \n\n \n\nAs dificuldades associadas ao uso de malhas Cartesianas, e das malhas estruturadas \n\nem geral, v\u00e3o desde a dificuldade de representa\u00e7\u00e3o geom\u00e9trica dos reservat\u00f3rios at\u00e9 a \n\nnecessidade de utiliza\u00e7\u00e3o de um n\u00famero excessivo de n\u00f3s em uma malha quando se deseja \n\nobter solu\u00e7\u00f5es mais acuradas em apenas uma parte do dom\u00ednio (onde se tem que refinar \n\nobrigatoriamente toda uma linha e/ou coluna). Isso motivou o desenvolvimento de m\u00e9todos \n\nde refinamento local (CIMENT e SWEET, 1973) em malhas Cartesianas. \n\nAs id\u00e9ias b\u00e1sicas da t\u00e9cnica de refinamento local utilizada nos simuladores atuais \n\nforam estabelecidas inicialmente por Von Rosenberg (1982). O autor prop\u00f4s adicionar n\u00f3s no \n\ninterior de blocos de malhas Cartesianas a fim de melhorar a representa\u00e7\u00e3o do escoamento \n\nnaquela regi\u00e3o. Heinemann et al. (1983), por outro lado, propuseram refinar localmente a \n\nmalha cartesiana apenas por certo per\u00edodo de tempo, em um processo denominado de \n\nrefinamento local din\u00e2mico. Esse procedimento conseguiu reduzir significativamente o \n\nn\u00famero de blocos necess\u00e1rios para representar adequadamente um reservat\u00f3rio. A grande \n\ndificuldade associada \u00e0 utiliza\u00e7\u00e3o de t\u00e9cnicas de refinamento localizado em malhas \n\n\n\n CAP. 2 \u2013 REVIS\u00c3O BIBLIOGR\u00c1FICA 11 \n \n\n \n\nestruturadas \u00e9 a perda de precis\u00e3o num\u00e9rica que ocorre no c\u00e1lculo do fluxo entre blocos da \n\nmalha grosseira com aqueles localizados na regi\u00e3o refinada (MALISKA et al., 2001). \n\n As malhas mais utilizadas atualmente na simula\u00e7\u00e3o de reservat\u00f3rios de petr\u00f3leo s\u00e3o \n\naquelas em que os blocos s\u00e3o formados pela defini\u00e7\u00e3o de seus v\u00e9rtices, em um formato global \n\nestruturado (WADSLEY, 1980; GOLDTHORPE e CHOW, 1985; FLEMING, 1987). Elas s\u00e3o \n\nconhecidas na ind\u00fastria do petr\u00f3leo como malhas corner-points, e s\u00e3o baseadas na proposta \n\ninicial de Hirasaki e O'Dell (1970) de utilizar coordenadas curvil\u00edneas ortogonais. Este \n\nm\u00e9todo tem a vantagem de gerar malhas coincidentes com a fronteira, o que possibilita a \n\nrepresenta\u00e7\u00e3o mais fiel de reservat\u00f3rios com fronteiras complexas e falhas geol\u00f3gicas ao \n\nlongo do reservat\u00f3rio. Sua maior limita\u00e7\u00e3o, no entanto, \u00e9 a utiliza\u00e7\u00e3o de apenas dois valores \n\nnodais no c\u00e1lculo do fluxo nas interfaces de dois volumes de controle, o que resulta sempre \n\nem um stencil de 5 pontos para 2D. Como a parcela dos fluxos cruzados \u00e9 desprezada, surgem \n\nerros num\u00e9ricos que aumentam com a n\u00e3o-ortogonalidade da malha (MALISKA et al., 2001). \n\nA id\u00e9ia de utilizar malhas curvil\u00edneas ortogonais para melhorar a representa\u00e7\u00e3o do \n\nescoamento radial na regi\u00e3o pr\u00f3xima a po\u00e7os, e utilizar blocos retangulares no restante do \n\ndom\u00ednio foi proposta por Pedrosa e Aziz (1986). Com essas malhas, denominadas de h\u00edbridas, \n\nobteve-se maior flexibilidade que os m\u00e9todos anteriores, o que resultou em uma maior \n\nprecis\u00e3o na descri\u00e7\u00e3o do escoamento pr\u00f3ximo a po\u00e7os, muito embora tenha sido necess\u00e1rio \n\naproximar o c\u00e1lculo das transmissibilidades1 na interface entre os dois tipos de malhas. \n\nO m\u00e9todo de coordenadas curvil\u00edneas n\u00e3o-ortogonais surgiu para eliminar a \n\nimprecis\u00e3o num\u00e9rica advinda da aproxima\u00e7\u00e3o do c\u00e1lculo dos fluxos nas malhas corner-points \n\n(MALISKA et al., 1994; MOTA, 1994). O esquema num\u00e9rico resultante passa a ser de 9 \n\npontos para 2D, o que \u00e9 suficiente para calcular o fluxo de forma exata em malhas \n\nestruturadas, a menos dos erros de truncamento. A utiliza\u00e7\u00e3o deste m\u00e9todo, no entanto, \n\nprovoca uma pequena altera\u00e7\u00e3o na estrutura matricial do sistema linear que passa a ser mais \n\ncheia. \n\nCordazzo et al. (2002) discorrem a respeito do c\u00e1lculo do fluxo, e em conseq\u00fc\u00eancia, \n\ndas transmissibilidades em malhas corner-points. Al\u00e9m da dedu\u00e7\u00e3o das equa\u00e7\u00f5es de \n\ntransporte neste sistema de coordenadas, os autores abordam a quest\u00e3o da ado\u00e7\u00e3o do esquema \n\nnum\u00e9rico de 5 pontos para problemas bidimensionais, utilizado por alguns programas \n\ncomerciais, em detrimento da utiliza\u00e7\u00e3o do esquema de 9 pontos, que surge naturalmente em \n\n                                                 \n1 A transmissibilidade \u00e9 um fator geom\u00e9trico dado pelo produto da \u00e1rea interfacial de dois volumes de controle e \nsua permeabilidade divididos pela dist\u00e2ncia entre os centros dos volumes. Mais detalhes ser\u00e3o dados no Cap. 7. \n\n\n\n12 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nfun\u00e7\u00e3o da discretiza\u00e7\u00e3o espacial. As conclus\u00f5es apresentadas neste trabalho s\u00e3o aplic\u00e1veis a \n\noutros formatos de malhas utilizadas pelos simuladores comerciais.  \n\nA utiliza\u00e7\u00e3o de malhas n\u00e3o-estruturadas parece ser o futuro inevit\u00e1vel para a \n\nsimula\u00e7\u00e3o de reservat\u00f3rios de petr\u00f3leo porque supera com bastante eleg\u00e2ncia as dificuldades \n\nassociadas \u00e0 representa\u00e7\u00e3o espacial dos dom\u00ednios arbitr\u00e1rios, com falhas e heterogeneidades, \n\ne \u00e0 imprecis\u00e3o num\u00e9rica das t\u00e9cnicas de refinamento, que surgem independentemente dos \n\nm\u00e9todos estruturados serem de 5 ou 9 pontos. Este \u00e9 o assunto abordado nas pr\u00f3ximas se\u00e7\u00f5es. \n\n \n\n \n\n2.2. Contextualiza\u00e7\u00e3o do EbFVM em Rela\u00e7\u00e3o aos Demais \nM\u00e9todos Empregados na Simula\u00e7\u00e3o de Reservat\u00f3rios \n\n \n\nO m\u00e9todo proposto neste trabalho - M\u00e9todo de Volumes Finitos baseado em \n\nElementos \u2013 EbFVM (Element-based Finite Volume Method) foi empregado inicialmente na \n\nresolu\u00e7\u00e3o das equa\u00e7\u00f5es de Navier-Stokes com malhas n\u00e3o-estruturadas, resultando em \n\nsoftwares comerciais robustos como o CFX2, que tem sido utilizado na ind\u00fastria com bons \n\nresultados. O EbFVM surgiu pela aplica\u00e7\u00e3o dos princ\u00edpios de conserva\u00e7\u00e3o diretamente em um \n\nambiente de elementos finitos. Neste m\u00e9todo as propriedades s\u00e3o conservadas em volumes de \n\ncontrole discretos constru\u00eddos ao redor dos n\u00f3s da malha. Baliga e Patankar (1983) \n\nintroduziram esta id\u00e9ia para elementos triangulares, enquanto que Schneider e Zedan (1983) \n\npara elementos quadril\u00e1teros. O elemento \u00e9 a entidade definida pelos v\u00e9rtices da malha.  \n\nEste m\u00e9todo \u00e9 usualmente denominado de m\u00e9todo de elementos finitos baseado no \n\nvolume de controle (CVFE - Control Volume Finite Elements) em fun\u00e7\u00e3o da flexibilidade \n\ngeom\u00e9trica obtida e a montagem das equa\u00e7\u00f5es elemento a elemento. No entanto, essa \n\ndenomina\u00e7\u00e3o n\u00e3o \u00e9 precisa porque d\u00e1 a id\u00e9ia de que se trata de uma t\u00e9cnica de elementos \n\nfinitos que usa o volume de controle para a integra\u00e7\u00e3o das equa\u00e7\u00f5es. O mais adequado \u00e9 \n\ndenomin\u00e1-lo de \u201cM\u00e9todo de Volumes Finitos baseado em Elementos\u201d (EbFVM \u2013 Element-\n\nbased Finite Volume Method), uma vez que este m\u00e9todo continua ancorado nas premissas dos \n\nvolumes finitos, isto \u00e9, realiza balan\u00e7os em volumes elementares, utilizando, no entanto, a \n\n                                                 \n2 CFX\u00ae \u00e9 um software de simula\u00e7\u00e3o de din\u00e2mica dos fluidos com transfer\u00eancia de calor e rea\u00e7\u00f5es qu\u00edmicas, e \u00e9 \ncomercializado pela ANSYS Inc. of Canonsburg, Pennsylvania, USA. \n\n\n\n CAP. 2 \u2013 REVIS\u00c3O BIBLIOGR\u00c1FICA 13 \n \n\n \n\nrepresenta\u00e7\u00e3o geom\u00e9trica via fun\u00e7\u00f5es de forma que s\u00e3o tipicamente utilizadas no m\u00e9todo dos \n\nelementos finitos (MALISKA, 2004).  \n\nA fim de dar um suporte maior a escolha deste novo acr\u00f4nimo (EbFVM), que ser\u00e1 a \n\ndenomina\u00e7\u00e3o mantida doravante neste trabalho, \u00e9 importante observar a Fig. 2.2, que \n\napresenta um diagrama de blocos que contextualiza este m\u00e9todo entre os principais m\u00e9todos \n\nnum\u00e9ricos utilizados na literatura e que permite uma discuss\u00e3o mais profunda em torno deste \n\ntema.  \n\n \n\n \n\n \n \n\nFig. 2.2 - Diferen\u00e7as entre os principais m\u00e9todos num\u00e9ricos (adaptado de Banaszek, 1995) \n\n \n \n \n\nNesta figura est\u00e1 resumido o papel de qualquer m\u00e9todo num\u00e9rico que \u00e9 o de obter uma \n\nsolu\u00e7\u00e3o aproximada de uma equa\u00e7\u00e3o diferencial parcial atrav\u00e9s da constru\u00e7\u00e3o e solu\u00e7\u00e3o de \n\n\n\n14 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\num sistema de equa\u00e7\u00f5es alg\u00e9bricas. Embora cada m\u00e9todo tenha suas diferen\u00e7as e \n\nparticularidades, a figura demonstra que todos eles podem ser considerados m\u00e9todos dos \n\nres\u00edduos ponderados, sendo a fun\u00e7\u00e3o peso o par\u00e2metro principal que diferencia um m\u00e9todo do \n\noutro. \n\nUma formula\u00e7\u00e3o em res\u00edduos ponderados pode ser escrita como \n\n \n\n ( ) 0\nV\n\nW dV =? L ?  (2.1)  \n\n \nonde L  \u00e9 o operador que representa a equa\u00e7\u00e3o diferencial, ?  \u00e9 a aproxima\u00e7\u00e3o das vari\u00e1veis \ninc\u00f3gnitas, V \u00e9 o volume, e W \u00e9 a fun\u00e7\u00e3o peso. Se W for igual a unidade no volume de \n\ncontrole e zero em outras posi\u00e7\u00f5es, e se a equa\u00e7\u00e3o estiver na sua forma conservativa, o \n\nm\u00e9todo resultante ser\u00e1 o:  \n\n \n\n \n\n M\u00e9todo de Volumes Finitos  \n\n \n\n \n\ndependendo do tipo da fun\u00e7\u00e3o de interpola\u00e7\u00e3o. Caso a fun\u00e7\u00e3o peso seja a fun\u00e7\u00e3o delta de \n\nDirac em um ponto, o m\u00e9todo resultante ser\u00e1 o das \n\n \n\n Diferen\u00e7as Finitas (FDM),  \n\n \n\nenquanto que se W for o conjunto das fun\u00e7\u00f5es de forma do elemento, obt\u00e9m-se o \n\n \n\n M\u00e9todo dos Elementos Finitos (FEM do tipo Galerkin). \n\n \n\nPortanto, como pode ser visto na Fig. 2.2, o EbFVM tem caracter\u00edsticas que, na \n\nrealidade, o identificam como um m\u00e9todo de volumes finitos e n\u00e3o de elementos finitos, como \n\no acr\u00f4nimo CVFEM poderia sugerir, o que justifica a nova denomina\u00e7\u00e3o \u201cEbFVM\u201d \n\nempregada neste trabalho. Detalhes adicionais e outras compara\u00e7\u00f5es entre esses m\u00e9todos \n\npodem ser obtidos nos textos de Patankar (1980), Raw (1985), Cook et al. (1989), Shaw \n\n(1992), Banaszek (1995) e Maliska (2004). \n\n Tradicional (FVM) ou o \n \n\n baseado em Elementos (EbFVM),  \n\n\n\n CAP. 2 \u2013 REVIS\u00c3O BIBLIOGR\u00c1FICA 15 \n \n\n \n\n2.3. Utiliza\u00e7\u00e3o de Malhas N\u00e3o-Estruturadas na Simula\u00e7\u00e3o \nNum\u00e9rica de Reservat\u00f3rios de Petr\u00f3leo \n\n \n\nO primeiro trabalho registrado na literatura a utilizar o EbFVM em problemas de \n\npetr\u00f3leo foi o de Rozon (1989), que o denominou de \u201cM\u00e9todo de Volumes Finitos \n\nGeneralizado\u201d. O autor discretizou as equa\u00e7\u00f5es monof\u00e1sicas para elementos quadrangulares e \n\napresentou uma an\u00e1lise do erro de truncamento do m\u00e9todo EbFVM em rela\u00e7\u00e3o a outros \n\nm\u00e9todos tradicionais. Foi mostrado que para a equa\u00e7\u00e3o de Laplace e malha cartesiana \n\nuniforme, o erro de truncamento do EbFVM \u00e9 menor que o obtido pelo M\u00e9todo dos \n\nElementos Finitos do tipo Galerkin.  \n\nFung et al. (1991) apresentaram uma proposta de um M\u00e9todo de Volumes Finitos \n\nbaseado em Elementos para elementos triangulares. Suas id\u00e9ias s\u00e3o baseadas no trabalho de \n\nForsyth (1990), que prop\u00f4s a utiliza\u00e7\u00e3o dessa t\u00e9cnica nos procedimentos de refinamento \n\nlocalizado de malha, para obter uma transi\u00e7\u00e3o mais suave entre as malhas grosseira e refinada. \n\nNesse m\u00e9todo o termo transmissibilidade \u00e9 claramente identificado nas equa\u00e7\u00f5es resultantes, \n\no que foi considerado uma importante caracter\u00edstica pois permite a sua direta implementa\u00e7\u00e3o \n\nna estrutura atual dos simuladores comerciais. A discretiza\u00e7\u00e3o resulta em equa\u00e7\u00f5es que s\u00e3o \n\nmuito parecidas com aquelas obtidas pelos m\u00e9todos tradicionais de volumes finitos, \n\nresultando, no entanto, em transmissibilidades calculadas de uma forma totalmente diferente. \n\nA transmissibilidade calculada desta forma n\u00e3o tem mais a interpreta\u00e7\u00e3o f\u00edsica direta que teria \n\nse fosse obtida de acordo com os m\u00e9todos tradicionais. \n\nA principal cr\u00edtica que se pode fazer ao m\u00e9todo desenvolvido por Fung et al. (1991) e \n\nque ser\u00e1 considerada no Cap. 7 diz respeito \u00e0 forma como as equa\u00e7\u00f5es discretizadas \n\nmultif\u00e1sicas s\u00e3o deduzidas. O procedimento consiste inicialmente em for\u00e7ar o aparecimento \n\nexpl\u00edcito dos termos de transmissibilidade, o que s\u00f3 \u00e9 poss\u00edvel mediante a discretiza\u00e7\u00e3o das \n\nequa\u00e7\u00f5es diferenciais monof\u00e1sicas para elementos triangulares. Obtidas as equa\u00e7\u00f5es \n\ndiscretizadas do caso monof\u00e1sico, \u00e9 sugerido simplesmente adicionar os termos de mobilidade \n\n?  \u00e0s parcelas das equa\u00e7\u00f5es, a fim de obter as equa\u00e7\u00f5es do caso multif\u00e1sico. Como ser\u00e1 \n\nmostrado tamb\u00e9m no Cap. 7, este n\u00e3o \u00e9 um procedimento correto porque o processo de \n\ndiscretiza\u00e7\u00e3o deve partir necessariamente das equa\u00e7\u00f5es diferenciais multif\u00e1sicas.  \n\nO m\u00e9todo proposto por Fung et al. (1991) foi utilizado em uma simula\u00e7\u00e3o de campo \n\nreal por Sonier et al. (1993), que n\u00e3o tiveram problemas com instabilidades ou satura\u00e7\u00f5es \n\nnegativas. No entanto, cuidados excessivos tiveram que ser tomados inicialmente para que os \n\n\n\n16 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nvalores das transmissibilidades n\u00e3o resultassem negativos. Este valores ocorrem em \n\ndecorr\u00eancia da presen\u00e7a de tri\u00e2ngulos obtusos. Houve ent\u00e3o a necessidade de modifica\u00e7\u00e3o da \n\nmalha, refinando-a localmente, at\u00e9 que as transmissibilidades negativas desaparecessem, o \n\nque n\u00e3o foi, muitas vezes, uma tarefa f\u00e1cil. Detalhes adicionais sobre as dificuldades \n\nassociadas \u00e0 gera\u00e7\u00e3o das malhas neste m\u00e9todo podem ser encontrados tamb\u00e9m no texto de \n\nPalagi (1992). \n\nQuandalle (1993) fez um estudo comparativo entre diversos simuladores comerciais e \n\nacad\u00eamicos em alguns casos-padr\u00e3o. Foi conclu\u00eddo que para atingir os mesmos resultados das \n\nmalhas tradicionais de nove pontos, as malhas triangulares do M\u00e9todo de Volumes Finitos \n\nbaseados em Elementos proposto por Fung et al. (1991) reduziram o tempo computacional em \n\nmais de cinco vezes, mesmo com a limita\u00e7\u00e3o geom\u00e9trica da forma dos tri\u00e2ngulos comentada \n\nanteriormente. De uma forma geral foi tamb\u00e9m observado que todos os simuladores \n\nconseguiram reduzir o n\u00famero de volumes de um fator quatro ou mais utilizando malhas \n\n\u201cflex\u00edveis\u201d em detrimento das Cartesianas.  \n\nO m\u00e9todo de Voronoi \u00e9 outro m\u00e9todo que emprega malhas n\u00e3o-estruturadas na \n\nsimula\u00e7\u00e3o de reservat\u00f3rios e que merece ser citado. Ele \u00e9 um caso particular do EbFVM e \n\napareceu como uma alternativa para aumentar a flexibilidade geom\u00e9trica do M\u00e9todo de \n\nVolumes Finitos, mantendo a conserva\u00e7\u00e3o das propriedades nos volumes de controle \n\n(HEINEMANN et al., 1991; PALAGI e AZIZ, 1991; MARCONDES et al., 1994; \n\nKUWAUCHI et al., 1996; SKOREYKO et al., 2003). Por\u00e9m, pelo fato de utilizar a \n\nortogonalidade local, este m\u00e9todo apresenta restri\u00e7\u00f5es na constru\u00e7\u00e3o da malha, e por \n\nempregar dois pontos para a aproxima\u00e7\u00e3o do fluxo, ele apenas atende equa\u00e7\u00f5es diferenciais \n\ncom o tensor permeabilidade isotr\u00f3pico. Menores restri\u00e7\u00f5es apresentam as malhas K-\n\nortogonais, que conferem ao m\u00e9todo de Voron\u00f3i uma maior flexibilidade porque s\u00e3o \n\nconstru\u00eddas levando-se em considera\u00e7\u00e3o a dire\u00e7\u00e3o do escoamento (EDWARDS et al., 1998;  \n\nMLACNIK et al., 2003).  \n\nUm m\u00e9todo diferente do proposto por Fung et al. (1991), mas que tamb\u00e9m utiliza \n\nmalhas triangulares e que se caracteriza por manter os termos de transmissibilidades nas \n\nequa\u00e7\u00f5es discretizadas, foi proposto por Verma e Aziz (1997). Neste m\u00e9todo o \n\narmazenamento das propriedades f\u00edsicas como porosidade e permeabilidade absoluta se d\u00e1 \n\nnos volumes de controle constru\u00eddos ao redor dos v\u00e9rtices dos tri\u00e2ngulos. As \n\ntransmissibilidades s\u00e3o determinadas atrav\u00e9s de um procedimento de m\u00e9dia harm\u00f4nica \n\ngeneralizada para problemas monof\u00e1sicos, e a obten\u00e7\u00e3o das equa\u00e7\u00f5es para escoamento \n\n\n\n CAP. 2 \u2013 REVIS\u00c3O BIBLIOGR\u00c1FICA 17 \n \n\n \n\nmultif\u00e1sico \u00e9 feita adicionando-se o termo de mobilidade nas equa\u00e7\u00f5es discretizadas, o que \n\nn\u00e3o \u00e9 um procedimento adequado, como j\u00e1 mencionado. \n\nRecentemente, Hurtado (2005) utilizou o M\u00e9todo de Volumes Finitos baseado em \n\nElementos na simula\u00e7\u00e3o de escoamentos bif\u00e1sicos bidimensionais utilizando elementos \n\nquadril\u00e1teros e esquema seq\u00fcencial de solu\u00e7\u00e3o das equa\u00e7\u00f5es. O autor mostrou que \u00e9 poss\u00edvel \n\nreduzir, e praticamente eliminar em alguns casos, o efeito de orienta\u00e7\u00e3o de malha a partir da \n\nutiliza\u00e7\u00e3o de fun\u00e7\u00f5es de interpola\u00e7\u00e3o mais fortemente vinculadas \u00e0 f\u00edsica do fen\u00f4meno \n\nconsiderado.  \n\n \n\n \n\n2.4. Outros M\u00e9todos Utilizados na Simula\u00e7\u00e3o Num\u00e9rica de \nReservat\u00f3rios de Petr\u00f3leo \n\n \n\nEdwards e Rogers (1998) propuseram um m\u00e9todo de volumes finitos que emprega \n\nmalhas estruturadas n\u00e3o-ortogonais e que imp\u00f5e a continuidade dos fluxos mediante a \n\nutiliza\u00e7\u00e3o de fun\u00e7\u00f5es cont\u00ednuas nas interfaces dos volumes. Esse procedimento \u00e9 bastante \n\napropriado para lidar com situa\u00e7\u00f5es de grande anisotropia causada pelo tensor permeabilidade \n\nabsoluta ou pela malha. A sua aplica\u00e7\u00e3o em malhas n\u00e3o-estruturadas foi proposta por \n\nEdwards (2003), com not\u00e1vel redu\u00e7\u00e3o do custo computacional em rela\u00e7\u00e3o ao m\u00e9todo anterior. \n\nA busca por solu\u00e7\u00f5es mais r\u00e1pidas tem motivado a pesquisa no desenvolvimento de \n\nm\u00e9todos baseados nas linhas de fluxo (streamline), que caracterizam-se por permitir passos de \n\ntempo maiores para resolver a equa\u00e7\u00e3o da press\u00e3o, resolvendo rapidamente uma equa\u00e7\u00e3o \n\nsemi-anal\u00edtica unidimensional para a satura\u00e7\u00e3o em intervalos de tempo menores (BATYCKY \n\net al., 1997; THIELE, 2001; MASCHIO e SCHIOZER, 2002). Esse m\u00e9todo tem sido \n\nutilizado tamb\u00e9m para auxiliar os processos de gera\u00e7\u00e3o de malhas e de mudan\u00e7a de escala \u2013 \n\nupscaling (EDWARDS et al., 1998; CASTELLINI, 2001). A tend\u00eancia dos m\u00e9todos \n\nstreamline \u00e9 serem implementados discretizando a equa\u00e7\u00e3o da press\u00e3o em malhas n\u00e3o-\n\nestruturadas (PR\u00c9VOST et al., 2001; MLACNIK et al., 2003), e em modelos contendo \n\ntermos de press\u00e3o capilar, compressibilidade e gravidade (BAKER et al., 2002). \n\nUma das mais novas op\u00e7\u00f5es de c\u00e1lculo do fluxo em simuladores comerciais \u00e9 o \n\nesquema MPFA (Multi Point Flux Approximation), que apresenta um tratamento mais \n\nrigoroso dos termos relacionados \u00e0 n\u00e3o-ortogonalidade da malha e do tensor permeabilidade \n\n\n\n18 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n(AAVATSMARK et al., 2001; ECLIPSE, 2004). Este esquema resulta no desejado stencil de \n\n9 pontos (para 2D) quando a malha \u00e9 n\u00e3o ortogonal, ou quando o tensor permeabilidade n\u00e3o \n\nest\u00e1 alinhado com as dire\u00e7\u00f5es coordenadas.  \n\nEmbora ainda n\u00e3o esteja presente no n\u00facleo num\u00e9rico dos simuladores de \n\nreservat\u00f3rios comerciais mais conhecidos, o m\u00e9todo de Elementos Finitos tamb\u00e9m tem sido \n\nutilizado na solu\u00e7\u00e3o de problemas envolvendo escoamento em meios porosos e transfer\u00eancia \n\nde calor, com resultados relevantes. Este m\u00e9todo \u00e9 dominante na \u00e1rea da mec\u00e2nica estrutural, \n\nparticularmente nos problemas de elasticidade, mas aplica-se tamb\u00e9m em problemas mais \n\ngerais de mec\u00e2nica dos fluidos. Neste sentido, pode-se citar o desenvolvimento dos m\u00e9todos \n\nMixed-Finite Element Methods (DARLOW et al., 1984; CAI et al., 1997; DOUGLAS et al., \n\n1997; HELMIG e HUBER, 1999), de Galerkin com fun\u00e7\u00f5es de alta ordem descont\u00ednuas \n\n(BASTIAN, 2003), com m\u00e9todos de estabiliza\u00e7\u00e3o (COUTINHO et al., 2004), e com multigrid \n\n(SILVA et al., 2000), entre outros.  \n\n \n\n \n\n2.5. M\u00e9todos de Solu\u00e7\u00e3o de Sistema de Equa\u00e7\u00f5es Alg\u00e9bricas \n \n\nUma vez obtido o sistema de equa\u00e7\u00f5es discretizadas, deve-se escolher uma forma \n\nadequada de resolv\u00ea-lo. O m\u00e9todo mais simples consiste em obter uma equa\u00e7\u00e3o cuja \u00fanica \n\nvari\u00e1vel \u00e9 a press\u00e3o, e express\u00f5es alg\u00e9bricas de determina\u00e7\u00e3o das demais vari\u00e1veis, como a \n\nsatura\u00e7\u00e3o. Um dos primeiros trabalhos publicados nesta dire\u00e7\u00e3o foi o de Fagin e Stewart \n\n(1966), mas sua denomina\u00e7\u00e3o atual - IMPES (Implicit Pressure and Explicit Saturation) foi \n\nproposta originalmente por Coats (1968). Sua maior limita\u00e7\u00e3o \u00e9 a restri\u00e7\u00e3o do passo de tempo \n\ndevido \u00e0 avalia\u00e7\u00e3o expl\u00edcita das satura\u00e7\u00f5es. \n\n Hoje em dia, mesmo com o advento de novas t\u00e9cnicas de solu\u00e7\u00e3o de equa\u00e7\u00f5es \n\nlineares, o m\u00e9todo IMPES ainda vem sendo utilizado e aprimorado no sentido de obter passos \n\nde tempo maiores e que resultem em solu\u00e7\u00f5es sem instabilidades num\u00e9ricas (COATS, 2000; \n\nCOATS, 2003; TCHELEPI et al., 2005; SHIRALKAR et al., 2005).  \n\n Para modelos composicionais, onde s\u00e3o resolvidas equa\u00e7\u00f5es de diferentes \n\ncomponentes, a generaliza\u00e7\u00e3o do m\u00e9todo IMPES \u00e9 o IMPSAT (Implicit Pressure and \n\nSaturation and Explicit Component Mole Fraction), em que apenas a press\u00e3o e a satura\u00e7\u00e3o \n\ns\u00e3o tratados implicitamente, enquanto que as fra\u00e7\u00f5es molares de todos os componentes s\u00e3o \n\ntratadas explicitamente. Nos trabalhos pioneiros de Quandalle e Savary (1989) e Branco e \n\n\n\n CAP. 2 \u2013 REVIS\u00c3O BIBLIOGR\u00c1FICA 19 \n \n\n \n\nRodriguez (1996) este m\u00e9todo recebeu as denomina\u00e7\u00f5es de IMPIMS e modelo semi-\n\nimpl\u00edcito, respectivamente. No entanto, foi apenas no in\u00edcio desta d\u00e9cada que o IMPSAT foi \n\nanalisado mais profundamente, estabelecendo-se crit\u00e9rios de estabilidade e comparando-o \n\ncom os modelos IMPES e Totalmente Impl\u00edcito (CAO e AZIZ, 2002). \n\n Os M\u00e9todos Totalmente Impl\u00edcitos surgiram como uma alternativa para obter solu\u00e7\u00f5es \n\nmais r\u00e1pidas que o m\u00e9todo IMPES, principalmente para malhas mais refinadas e com regi\u00f5es \n\nque apresentam altas velocidades de fluido, porque as suas limita\u00e7\u00f5es no tamanho do passo de \n\ntempo s\u00e3o menos restritivas (MATTAX e DALTON,  1990). Eles consistem na solu\u00e7\u00e3o de \n\num sistema de equa\u00e7\u00f5es que envolve todas as vari\u00e1veis. Este procedimento normalmente \u00e9 \n\nrealizado atrav\u00e9s do m\u00e9todo de Newton.  \n\nBlair e Weinaug (1969) foram os pioneiros na utiliza\u00e7\u00e3o do m\u00e9todo de Newton na \n\nsimula\u00e7\u00e3o de reservat\u00f3rios de petr\u00f3leo e, desde ent\u00e3o, esse m\u00e9todo vem sendo utilizado por \n\nboa parcela dos softwares comerciais (IMEX User\u2019s Guide, 2002; ECLIPSE Technical \n\nDescription, 2004; entre outros). Rigorosamente, a melhor denomina\u00e7\u00e3o para este m\u00e9todo \n\nseria \u201cm\u00e9todo de Newton inexato\u201d (DEMBO et al., 1982), porque o sistema linear \u00e9 resolvido \n\ncom solvers iterativos, isto \u00e9, n\u00e3o de forma exata3. No entanto, convencionou-se na literatura \n\nde petr\u00f3leo denomin\u00e1-lo simplesmente de \u201cm\u00e9todo de Newton\u201d, sendo essa, tamb\u00e9m, a \n\ndenomina\u00e7\u00e3o empregada em todo este trabalho.  \n\nA solu\u00e7\u00e3o de sistemas lineares oriundos de malhas com grande n\u00famero de n\u00f3s no \n\nm\u00e9todo impl\u00edcito pode representar um custo computacional alto, porque a dimens\u00e3o das \n\nmatrizes neste m\u00e9todo \u00e9 tipicamente grande. Por isso, Thomas e Thurnau (1983) propuseram \n\ntratar explicitamente as vari\u00e1veis correspondentes a certos volumes de controle, enquanto que \n\nas demais s\u00e3o resolvidas implicitamente, o que reduz a dimens\u00e3o do sistema linear e, em \n\nconseq\u00fc\u00eancia, o custo computacional. Esse m\u00e9todo, denominado de adaptativo (AIM - \n\nAdaptive Implicit Method), tem recebido desde ent\u00e3o aten\u00e7\u00e3o da comunidade cient\u00edfica \n\n(COLLINS et al., 1986; YOUNG e RUSSELL, 1993; MARCONDES, 1996; CAILLABET et \n\nal., 2003), estando presente nos n\u00facleos num\u00e9ricos de importantes simuladores comerciais \n\n(IMEX, 2002; ECLIPSE, 2004) apresentando excelentes resultados. \n\n \n\n \n\n                                                 \n3 Quando o sistema linear \u00e9 resolvido de forma exata e a matriz jacobiana \u00e9 constru\u00edda de forma exata, o m\u00e9todo \nde Newton apresenta converg\u00eancia de 2\u00aa. ordem.  \n\n\n\n20 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n2.6. M\u00e9todos Multigrid de Solu\u00e7\u00e3o de Sistemas Lineares \n \n \n\nIndependentemente do esquema de solu\u00e7\u00e3o das equa\u00e7\u00f5es adotado - IMPES, \n\nTotalmente Impl\u00edcito, AIM ou outros - o maior custo computacional associado a uma \n\nsimula\u00e7\u00e3o num\u00e9rica deve-se ainda \u00e0 solu\u00e7\u00e3o do sistema linear resultante. Neste sentido, os \n\nm\u00e9todos multigrid t\u00eam se mostrado muito eficientes e robustos na obten\u00e7\u00e3o das solu\u00e7\u00f5es. \n\nA efici\u00eancia de um m\u00e9todo multigrid pode ser entendida pela an\u00e1lise espectral dos \n\nerros da solu\u00e7\u00e3o4. Diversos trabalhos na literatura demonstram que esses erros podem ser \n\nrepresentados atrav\u00e9s da superposi\u00e7\u00e3o de ondas de diferentes freq\u00fc\u00eancias (BRIGGS et al., \n\n2000; TROTTENBERG et al., 2001, entre outros). Al\u00e9m disso, pode-se mostrar que apenas \n\nos erros que possuem comprimento de onda da ordem do tamanho da malha \u00e9 que s\u00e3o \n\nreduzidos com rapidez nos solvers iterativos. Os outros erros, de menores freq\u00fc\u00eancias para \n\nesta malha, s\u00e3o reduzidos com muita dificuldade e s\u00e3o os causadores da estagna\u00e7\u00e3o do solver. \n\nEsta observa\u00e7\u00e3o indica que diferentes malhas s\u00e3o necess\u00e1rias para poder reduzir todo o \n\nespectro de freq\u00fc\u00eancias do erro. M\u00e9todos que se valem desta constata\u00e7\u00e3o s\u00e3o denominados \n\nmultigrid. Nestes m\u00e9todos, ao serem utilizadas malhas sucessivamente mais grosseiras, \n\neliminam-se tamb\u00e9m os erros que possuem comprimento de onda da ordem do tamanho de \n\ncada uma das malhas. Com isso todas as componentes do erro s\u00e3o reduzidas com efici\u00eancia, \n\ndiminuindo consideravelmente o tempo de computa\u00e7\u00e3o. \n\nOs m\u00e9todos multigrid come\u00e7aram a ser investigados a partir da d\u00e9cada de 1960 com \n\nos trabalhos de Fedorenko (1964) e Bakhvalov (1966). Por\u00e9m, foi apenas nas d\u00e9cadas de 1970 \n\ne 1980 que os m\u00e9todos multigrid tiveram popularidade a partir dos trabalhos de Brandt (1973 \n\napud TROTTENBERG et al., 2001), quando os m\u00e9todos multigrid geom\u00e9tricos foram \n\nintroduzidos. Neste tipo de multigrid, o processo de forma\u00e7\u00e3o das malhas grosseiras se d\u00e1 \n\nestritamente em fun\u00e7\u00e3o de aspectos geom\u00e9tricos da malha original, sendo necess\u00e1ria a \n\ndiscretiza\u00e7\u00e3o das equa\u00e7\u00f5es nas malhas grosseiras tamb\u00e9m. \n\nAs dificuldades associadas \u00e0 discretiza\u00e7\u00e3o das equa\u00e7\u00f5es nas malhas grosseiras \n\nmotivou o desenvolvimento dos m\u00e9todos multigrid alg\u00e9bricos, que foram introduzidos por \n\nBrandt et al. (1982 apud CLEARY et al., 1999). Esses m\u00e9todos t\u00eam uma caracter\u00edstica \n\nimportante: n\u00e3o \u00e9 necess\u00e1rio repassar nenhuma informa\u00e7\u00e3o a respeito da malha e do esquema \n\nde discretiza\u00e7\u00e3o. \u00c9 suficiente repassar apenas o sistema linear, isto \u00e9, a matriz de coeficientes, \n\n                                                 \n4 O erro da solu\u00e7\u00e3o \u00e9 definido neste trabalho como a diferen\u00e7a entre a solu\u00e7\u00e3o exata do sistema linear e a  \nsolu\u00e7\u00e3o num\u00e9rica dispon\u00edvel em uma determinada itera\u00e7\u00e3o.  \n\n\n\n CAP. 2 \u2013 REVIS\u00c3O BIBLIOGR\u00c1FICA 21 \n \n\n \n\no vetor de termos independentes e uma estimativa inicial da solu\u00e7\u00e3o. Foi a primeira tentativa \n\nde tornar o solver multigrid uma \u201ccaixa-preta\u201d, desvinculando-o dos procedimentos \n\nnum\u00e9ricos.  \n\nA partir das id\u00e9ias de Settari e Aziz (1973) surgiram os m\u00e9todos multigrid alg\u00e9bricos \n\nbaseados na corre\u00e7\u00e3o aditiva (HUTCHINSON e RAITHBY, 1986; VAN DOORMAAL et al., \n\n1987), que t\u00eam como principal caracter\u00edstica a inser\u00e7\u00e3o da f\u00edsica na concep\u00e7\u00e3o do solver, \n\natrav\u00e9s da manuten\u00e7\u00e3o dos princ\u00edpios de conserva\u00e7\u00e3o nas malhas grosseiras. Neste m\u00e9todo as \n\nequa\u00e7\u00f5es s\u00e3o deduzidas apenas para a malha refinada, sendo as equa\u00e7\u00f5es utilizadas nas \n\nmalhas grosseiras obtidas apenas somando-se os coeficientes da malha original. Por isso n\u00e3o \u00e9 \n\nnecess\u00e1rio ter stencils fixos, o que evita inconsist\u00eancias entre as malhas e \u00e9 uma caracter\u00edstica \n\nmuito apropriada para aplica\u00e7\u00e3o do m\u00e9todo em malhas n\u00e3o-estruturadas. \n\nA robustez do m\u00e9todo multigrid baseado na corre\u00e7\u00e3o aditiva \u00e9 destacada no trabalho \n\nde Raw (1996), onde uma variedade de problemas acoplados regidos pelas equa\u00e7\u00f5es de \n\nNavier-Stokes s\u00e3o resolvidos sem modifica\u00e7\u00f5es dos par\u00e2metros do solver. Essa \u00e9 uma \n\nvantagem not\u00e1vel, porque os m\u00e9todos tradicionais como Gradiente Conjugado e GMRES \n\napresentam uma taxa de converg\u00eancia muito sens\u00edvel ao n\u00famero de condi\u00e7\u00e3o da matriz, e \n\nquando s\u00e3o precondicionados tornam-se muito sens\u00edveis ao tipo de problema analisado. \n\nOs estudos de Elias et al. (1997) mostraram que se perde efici\u00eancia nos m\u00e9todos \n\niterativos quando as equa\u00e7\u00f5es discretizadas t\u00eam coeficientes anisotr\u00f3picos5. Isso acontece \n\nporque os solver iterativos, al\u00e9m de reduzir com efici\u00eancia apenas os erros cujo comprimento \n\nde onda s\u00e3o equivalentes ao tamanho da malha, eles o fazem preferencialmente na dire\u00e7\u00e3o dos \n\ngrandes coeficientes. Nesses casos a anisotropia dos coeficientes origina diferentes escalas de \n\ntempo de propaga\u00e7\u00e3o da informa\u00e7\u00e3o, afetando diretamente o comportamento da converg\u00eancia. \n\nOs autores mostram que uma aglomera\u00e7\u00e3o dos volumes de controle da malha refinada que \n\nvise reduzir a anisotropia dos coeficientes das malhas grosseiras torna o m\u00e9todo multigrid \n\nainda mais eficiente. A raz\u00e3o \u00e9 a diminui\u00e7\u00e3o da varia\u00e7\u00e3o das escalas de tempo de propaga\u00e7\u00e3o \n\nda informa\u00e7\u00e3o nas malhas grosseiras. \n\nComo visto, os m\u00e9todos multigrid alg\u00e9bricos baseados na corre\u00e7\u00e3o aditiva t\u00eam grande \n\npotencial a ser explorado na simula\u00e7\u00e3o de reservat\u00f3rios de petr\u00f3leo com malhas n\u00e3o-\n\nestruturadas. Desde os trabalhos pioneiros de Behie e Forsyth (1983a e 1983b), que utilizaram \n\no multigrid geom\u00e9trico na solu\u00e7\u00e3o da equa\u00e7\u00e3o da press\u00e3o em problemas com coeficientes \n\ndescont\u00ednuos, a falta de flexibilidade geom\u00e9trica advinda deste tipo de m\u00e9todo multigrid tem \n\n                                                 \n5 Esses coeficientes surgem devido \u00e0 raz\u00e3o de aspecto da malha diferente da unidade e/ou \u00e0 propriedades f\u00edsicas \ndiferentes em cada dire\u00e7\u00e3o. \n\n\n\n22 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nsido uma barreira \u00e0 sua aplica\u00e7\u00e3o pr\u00e1tica. A despeito disso, diversos trabalhos mostram \n\nresultados bem satisfat\u00f3rios na utiliza\u00e7\u00e3o deste tipo de solver em problemas espec\u00edficos na \n\nsimula\u00e7\u00e3o de reservat\u00f3rios de petr\u00f3leo (DENDY et al., 1989; COLLINS e MOURITS, 1991; \n\nCRUMPTON et al., 1995; RODRIGUES e DICKSTEIN, 1996; PARSONS e COUTINHO, \n\n1999; BASTIAN e HELMIG, 1999; SILVA et al., 2000). \n\n\n\n23 \n\nCap.    \n\n3 FFOORRMMUULLAA\u00c7\u00c7\u00c3\u00c3OO  MMAATTEEMM\u00c1\u00c1TTIICCAA    \n \n\n \n Neste cap\u00edtulo s\u00e3o apresentadas as equa\u00e7\u00f5es governantes do escoamento em meios \n\nporosos, juntamente com as aproxima\u00e7\u00f5es do modelo adotado. As equa\u00e7\u00f5es s\u00e3o deduzidas \n\npartindo-se da situa\u00e7\u00e3o mais simples (escoamento monof\u00e1sico) at\u00e9 a obten\u00e7\u00e3o das equa\u00e7\u00f5es \n\ngovernantes do modelo composicional geral. A partir de ent\u00e3o, ser\u00e3o feitas as hip\u00f3teses \n\nnecess\u00e1rias para a apresenta\u00e7\u00e3o do modelo adotado neste trabalho. \n\n \n\n3.1. Equa\u00e7\u00f5es Governantes do Modelo Composicional Geral \n \n\n Desconsiderando, por simplicidade, fen\u00f4menos que n\u00e3o interferem na generalidade do \n\nm\u00e9todo proposto, como rea\u00e7\u00f5es qu\u00edmicas e o transporte por difus\u00e3o molecular e dispers\u00e3o \n\nhidrodin\u00e2mica, a equa\u00e7\u00e3o de conserva\u00e7\u00e3o da massa em um escoamento monof\u00e1sico em meios \n\nporosos \u00e9 dada por \n\n \n\n( ) ( ). qV\nt\n\n? ?\n? ?\n\n?\n= ?? +\n\n?\n (3.1) \n\n \n\ncuja dedu\u00e7\u00e3o pode ser encontrada na literatura de petr\u00f3leo em geral (PEACEMAN (1977), \n\npor exemplo). Nesta equa\u00e7\u00e3o, ? \u00e9 a porosidade, que representa a fra\u00e7\u00e3o de volume que est\u00e1 \n\ndispon\u00edvel para o escoamento, ?  \u00e9 a densidade do fluido avaliada nas condi\u00e7\u00f5es de \n\ntemperatura e press\u00e3o do reservat\u00f3rio, V  \u00e9 a velocidade da fase e q \u00e9 a vaz\u00e3o volum\u00e9trica de \n\nprodu\u00e7\u00e3o/inje\u00e7\u00e3o da fase por unidade de volume do reservat\u00f3rio (positivo para inje\u00e7\u00e3o e \n\nnegativo para suc\u00e7\u00e3o). \n\n\n\n24 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n \n\n \n\nEm um passo intermedi\u00e1rio rumo ao modelo composicional geral, consideram-se os \n\nescoamentos multif\u00e1sicos que apresentam fases formadas por componentes que s\u00e3o \n\nimisc\u00edveis. Neste caso, a equa\u00e7\u00e3o de conserva\u00e7\u00e3o da massa, Eq. (3.1), ser\u00e1 escrita como \n\n \n\n( ) ( ).m m mm m m\ns\n\nqV\nt\n\n? ?\n? ?\n\n?\n= ?? +\n\n?\n (3.2) \n\n \n\nonde o sub-\u00edndice m indica grandezas associadas \u00e0 fase e s \u00e9 a satura\u00e7\u00e3o que \u00e9 definida como \n\na fra\u00e7\u00e3o do espa\u00e7o poroso ocupada pela fase. Essa nova vari\u00e1vel \u00e9 importante no modelo \n\nestudado porque ser\u00e1 uma de suas vari\u00e1veis prim\u00e1rias. A sua defini\u00e7\u00e3o em termos de fra\u00e7\u00e3o \n\nde espa\u00e7o poroso implica que a soma das satura\u00e7\u00f5es das Nm fases presentes no meio poroso \n\ntem que ser igual a unidade,  \n \n\n1\n1\n\nmN\n\nm\nm\n\ns\n=\n\n=?  (3.3) \n\n \n\nEssa \u00e9 uma rela\u00e7\u00e3o importante e ser\u00e1 bastante \u00fatil oportunamente.  \n\nA Eq. (3.2), no entanto, n\u00e3o se aplica \u00e0 reservat\u00f3rios t\u00edpicos, onde existem diversos \n\ncomponentes ou esp\u00e9cies qu\u00edmicas que formam as fases \u00f3leo, g\u00e1s e \u00e1gua, que se dissolvem e \n\nvaporizam, migrando de uma fase para outra em fun\u00e7\u00e3o das condi\u00e7\u00f5es de press\u00e3o e \n\ntemperatura. Em situa\u00e7\u00f5es como estas, podem ou n\u00e3o existir os mesmos componentes em \n\ncada uma das fases, e em conseq\u00fc\u00eancia, alguma fase pode at\u00e9 mesmo deixar de existir (o que \n\n\u00e9 bastante comum com a fase gasosa). O emprego das Eqs. (3.1) e (3.2) implica, \n\nnecessariamente, na conserva\u00e7\u00e3o da massa da fase, al\u00e9m da do componente, em fun\u00e7\u00e3o da \n\npresen\u00e7a de apenas um componente em cada fase. Isso deixar\u00e1 de acontecer em modelos mais \n\ngerais, porque a massa da fase poder\u00e1 n\u00e3o mais ser conservada, embora os princ\u00edpios de \n\nconserva\u00e7\u00e3o da massa dos componentes devam continuar sendo satisfeitos. \n\nPor isso, em situa\u00e7\u00f5es onde um componente pode migrar de uma fase para outra, a Eq. \n\n(3.2) deve ser generalizada, para que a massa daquele componente que, eventualmente, esteja \n\ndistribu\u00eddo em diferentes fases, tamb\u00e9m seja conservada:  \n\n \n\n1 1 1\n\n.\nm m mN N N\n\ncm m m cm m m cm m m\nm m m\n\nX s X V X q\nt\n\n? ? ? ?\n= = =\n\n? ?? ? ? ??\n= ?? +? ?? ? ? ?? ? ? ? ?? ?\n\n? ? ?  (3.4) \n\n \n\n\n\n CAP. 3 \u2013 FORMULA\u00c7\u00c3O MATEM\u00c1TICA 25 \n\n \n\n \n\ne, para tanto, \u00e9 necess\u00e1rio definir a grandeza Xcm  que \u00e9 a fra\u00e7\u00e3o m\u00e1ssica do componente c na \n\nfase m dada por \n\n \n\ncm\ncm\n\nm\n\nm\nX\n\nm\n=  (3.5) \n\n  \n\n Em meios porosos, a velocidade da fase, mV , pode ser relacionada com o gradiente de \n\npress\u00e3o (DARCY, 1856), e para um reservat\u00f3rio horizontal pode ser determinada atrav\u00e9s de \n\n \n\nrm\nm m\n\nm\n\nk k\nV p\n\n\u00b5\n= ? ?  (3.6) \n\n \n\nonde k  \u00e9 o tensor permeabilidade absoluta do meio poroso, m\u00b5  \u00e9 a viscosidade da fase, mp  \u00e9 \n\na press\u00e3o da fase, e krm \u00e9 a permeabilidade relativa da fase.  \n\n \u00c9 importante notar que o fator que multiplica o gradiente de press\u00e3o na Eq. (3.6) \u00e9 \n\ncomposto por termos que dependem apenas das propriedades da rocha (permeabilidade \n\nabsoluta), das propriedades do fluido (viscosidade) e das propriedades de intera\u00e7\u00e3o de ambos \n\n(permeabilidade relativa).  \n\nComo \u00e9 usualmente calculada em fun\u00e7\u00e3o da satura\u00e7\u00e3o, a permeabilidade relativa pode \n\nser representada atrav\u00e9s de curvas como as apresentadas na Fig. 3.1, de onde se pode \n\ndeterminar a regi\u00e3o do gr\u00e1fico onde as duas fases podem escoar. Essa regi\u00e3o \u00e9 delimitada \n\npelos valores de satura\u00e7\u00e3o de \u00e1gua em que as permeabilidades relativas das duas fases n\u00e3o s\u00e3o \n\nnulas: \n\n \n\n(1 )wi w ors s s&lt;&lt;?  (3.7) \n\n \n\nonde wis  \u00e9 a satura\u00e7\u00e3o de \u00e1gua irredut\u00edvel e ors  \u00e9 a satura\u00e7\u00e3o de \u00f3leo residual. Os valores \n\nlimites maxrok  e \nmax\nrwk  s\u00e3o valores obtidos das curvas de permeabilidades relativas avaliados nas \n\nsatura\u00e7\u00f5es wis  e 1w ors s= ? , respectivamente.  \n\n\n\n26 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n \n\n \n\n \n\nFig. 3.1 \u2013 Forma t\u00edpica das curvas de permeabilidade relativa, destacando alguns par\u00e2metros importantes \n\nenvolvidos na sua defini\u00e7\u00e3o \n\n \n\n \n\n\u00c9 importante frisar que, independentemente do valor da for\u00e7a motriz a que est\u00e1 \n\nsubmetido o reservat\u00f3rio (o gradiente de press\u00e3o, por exemplo), n\u00e3o \u00e9 poss\u00edvel haver valores \n\nde satura\u00e7\u00e3o fora do intervalo delimitado no gr\u00e1fico da Fig. 3.11. \n\n \n\n \n\n3.2. Equa\u00e7\u00f5es Governantes do Modelo Black-Oil \n \n\nA solu\u00e7\u00e3o do modelo composicional descrito na se\u00e7\u00e3o anterior e representado pela Eq. \n\n(3.4) \u00e9 altamente custosa computacionalmente na maioria dos casos pr\u00e1ticos. Para \n\nreservat\u00f3rios que possuem \u00f3leos pesados e com baixa volatilidade pode-se utilizar um modelo \n\nsimplificado denominado de Black-Oil, e que caracteriza-se por utilizar grandezas mais \n\nfacilmente mensur\u00e1veis, como o fator volume de forma\u00e7\u00e3o, solubilidade etc., descritas a \n\nseguir. \n\n                                                 \n1 Existem duas exce\u00e7\u00f5es que n\u00e3o s\u00e3o estudadas neste trabalho: \n   I. A simula\u00e7\u00e3o, em um mesmo modelo, de reservat\u00f3rios de petr\u00f3leo e seus aq\u00fc\u00edferos associados (sw = 100%). \n   II. A simula\u00e7\u00e3o de escoamentos que se iniciam monof\u00e1sicos mas que tem a possibilidade da gera\u00e7\u00e3o de uma \nsegunda fase que nunca esteve presente no meio poroso. A simula\u00e7\u00e3o da forma\u00e7\u00e3o das bacias geol\u00f3gicas que \nvisa prever o aparecimento do petr\u00f3leo \u00e9 um exemplo disso. A condi\u00e7\u00e3o inicial \u00e9 o preenchimento completo do \nmeio poroso com \u00e1gua, e, com o tempo, em fun\u00e7\u00e3o das condi\u00e7\u00f5es de press\u00e3o e temperatura, a rocha geradora \npassa a produzir o \u00f3leo que \u00e9 acumulado nos poros at\u00e9 atingir a sua satura\u00e7\u00e3o cr\u00edtica que lhe permitir\u00e1 escoar. \nDurante este processo que ocorre entre 1>sw>(1\u2013sor) a permeabilidade relativa da \u00e1gua vai diminuindo de 1.0 at\u00e9 \n\nmax\nrwk  pois o \u00f3leo come\u00e7a o ocupar o espa\u00e7o poroso antes ocupado completamente pela \u00e1gua.  \n\n \n\n\n\n CAP. 3 \u2013 FORMULA\u00c7\u00c3O MATEM\u00c1TICA 27 \n\n \n\n \n\n \n\nFator volume de forma\u00e7\u00e3o. O fator volume de forma\u00e7\u00e3o, B, \u00e9 definido como a rela\u00e7\u00e3o \n\nentre o volume da fase nas condi\u00e7\u00f5es do reservat\u00f3rio e o volume da fase nas condi\u00e7\u00f5es de \n\nestocagem, geralmente na superf\u00edcie. Este fator incorpora, pelo menos, tr\u00eas fen\u00f4menos f\u00edsicos \n\nque causam a varia\u00e7\u00e3o volum\u00e9trica da fase (McCAIN, 1990) que s\u00e3o: \n\n \n\n1. a varia\u00e7\u00e3o da press\u00e3o; \n\n2. a varia\u00e7\u00e3o da temperatura; \n\n3. a dissolu\u00e7\u00e3o da fase gasosa nas demais fases. \n\n \n\nPara a fase \u00f3leo, normalmente o volume que vai para a superf\u00edcie \u00e9 menor que aquele \n\nque residia no reservat\u00f3rio, o que resulta em valores maiores que a unidade para o fator \n\nvolume de forma\u00e7\u00e3o desta fase. Isso acontece porque, como na maioria das vezes a \n\ntemperatura \u00e9 bem maior no reservat\u00f3rio que na superf\u00edcie, a expans\u00e3o que ocorre na \n\nsuperf\u00edcie pela redu\u00e7\u00e3o da press\u00e3o n\u00e3o consegue suplantar a contra\u00e7\u00e3o devido \u00e0 diferen\u00e7a de \n\ntemperatura. Al\u00e9m disso, como a press\u00e3o na superf\u00edcie normalmente \u00e9 menor que no \n\nreservat\u00f3rio uma boa parcela do g\u00e1s dissolvido no \u00f3leo \u00e9 expulso desta fase, contribuindo \n\ntamb\u00e9m para a redu\u00e7\u00e3o do volume de \u00f3leo nas condi\u00e7\u00f5es de estocagem.  \n\nNo entanto, o escoamento \u00e9 assumido isot\u00e9rmico no modelo Black-Oil, e portanto, o \n\nfen\u00f4meno f\u00edsico \u201cvaria\u00e7\u00e3o da temperatura\u201d (item 2 mencionado anteriormente) n\u00e3o \n\ncontribuir\u00e1 para modificar do fator volume de forma\u00e7\u00e3o neste modelo. O modelo Black-Oil \n\ntamb\u00e9m admite que n\u00e3o existe transfer\u00eancia de massa entre a fase \u00e1gua e as fases \u00f3leo e g\u00e1s, \n\nsendo as fases \u00e1gua e \u00f3leo imisc\u00edveis, e o componente g\u00e1s pode ser dissolvido na fase \u00f3leo. \n\nCom estas simplifica\u00e7\u00f5es, o fator volume de forma\u00e7\u00e3o do \u00f3leo passa a depender \n\napenas da press\u00e3o, apresentando um comportamento t\u00edpico como o retratado na Fig. 3.2. \n\nPercebe-se que para baixas press\u00f5es, o fator volume de forma\u00e7\u00e3o aumenta com o incremento \n\nda press\u00e3o, e isto acontece porque maior quantidade de g\u00e1s passa a se dissolver na fase \u00f3leo. \n\nPara valores de press\u00e3o maiores que a press\u00e3o de bolha, pb, n\u00e3o h\u00e1 mais g\u00e1s que n\u00e3o tenha \n\nsido dissolvido no \u00f3leo, e por isso a cada aumento do valor da press\u00e3o o volume da fase, \n\ncomo um todo, come\u00e7a a reduzir. \n\n \n\n\n\n28 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n \n\n \n\n \n\nFig. 3.2 - Curva t\u00edpica do fator volume de forma\u00e7\u00e3o em fun\u00e7\u00e3o da press\u00e3o, onde pb \u00e9 a press\u00e3o de bolha  \n\n \n \n\nQuanto \u00e0 fase \u00e1gua, admite-se normalmente que n\u00e3o h\u00e1 dissolu\u00e7\u00e3o de outra fase, logo \n\na curva do fator volume de forma\u00e7\u00e3o para esta fase \u00e9 praticamente linear, com um \n\ncomportamento muito semelhante ao da curva da Fig. 3.2 para press\u00f5es maiores que a de \n\nbolha (pb). \n\n \n\nSolubilidade. Uma outra grandeza importante no modelo Black-Oil \u00e9 a solubilidade de \n\num componente em uma dada fase, que \u00e9 matematicamente definida por  \n\n \ne\n\ncm\ncm e\n\nmm\n\nV\nR\n\nV\n=  (3.8) \n\n \n\nonde cmR  \u00e9 a solubilidade do componente c na fase m, \ne\n\ncmV  \u00e9 o volume do componente c na \n\nfase m que \u00e9 liberado nas condi\u00e7\u00f5es de estocagem, e  emmV  \u00e9 o volume liberado do componente \n\nprincipal da fase m na fase m nas condi\u00e7\u00f5es de estocagem.  \n\n \n\n Dedu\u00e7\u00e3o das equa\u00e7\u00f5es do modelo. A dedu\u00e7\u00e3o das equa\u00e7\u00f5es de conserva\u00e7\u00e3o no \n\nmodelo Black-Oil tem in\u00edcio a partir da substitui\u00e7\u00e3o da Eq. (3.8) na express\u00e3o que define a \n\nmassa espec\u00edfica do componente c que \u00e9 liberado da fase m nas condi\u00e7\u00f5es de estocagem, \n\n \n\ne cm\nc e\n\ncm\n\nm\nV\n\n? =  (3.9) \n\n \n\nque resulta em \n\n \n\n\n\n CAP. 3 \u2013 FORMULA\u00c7\u00c3O MATEM\u00c1TICA 29 \n\n \n\n \n\n/ ecm c\ncm e\n\nmm\n\nm\nR\n\nV\n?\n\n=  (3.10) \n\n \n\nComo o fator volume de forma\u00e7\u00e3o pode ser expresso matematicamente como \n\n \n\nm\nm e\n\nmm\n\nV\nB\n\nV\n=  (3.11) \n\n \n\nonde mV  \u00e9 o volume da fase no reservat\u00f3rio, pode-se reescrever a Eq. (3.10) como \n\n \n\n/\n/\n\ne\ncm c\n\ncm\nm m\n\nm\nR\n\nV B\n?\n\n=  (3.12) \n\n \n\nou \n\ncm m m\ncm m cm me e\n\nm c c\n\nm\nR B X B\n\nm\n? ?\n? ?\n\n= =  (3.13) \n\n \n\nquando s\u00e3o substitu\u00eddas as express\u00f5es da massa espec\u00edfica da fase, m? , e da fra\u00e7\u00e3o m\u00e1ssica, \n\ncmX , Eq. (3.5). \n\nReescrevendo a Eq. (3.13) como \n\n \ne\nc\n\ncm m cm\nm\n\nX R\nB\n?\n\n? =  (3.14) \n\n \n\ne  substituindo-a, acompanhada da Eq. (3.6), na Eq. (3.4), e dividindo todos os termos pela \n\nmassa espec\u00edfica do componente nas condi\u00e7\u00f5es de estocagem, ec? , tem-se a equa\u00e7\u00e3o geral do \n\nmodelo Black-Oil, \n\n \n\n1 1 1\n\n.\nm m mN N N\n\ncm cm rm cm\nm m m\n\nm m mm m m m\n\nR R k k R\ns p q\n\nt B B B\n?\n\n\u00b5= = =\n\n? ?? ?? ??\n= ? ? +? ?? ?? ? ? ?? ? ?? ? ? ?\n\n? ? ?  (3.15) \n\n \n\n\n\n30 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n \n\n \n\nonde, pelas simplifica\u00e7\u00f5es j\u00e1 comentadas neste modelo, a \u00fanica solubilidade que depende da \n\npress\u00e3o \u00e9 a do g\u00e1s no \u00f3leo, Rgo: \n\n \n\n( )\n\n1              0              0\n\n              0               0 1 \n\n1               0                       \n\nww ow wg\n\noo wo gw\n\ngg og go s\n\nR R R\nR R R\n\nR R R R p\n\n= = =\n\n= ==\n\n= = =\n\n (3.16) \n\n \n\n \n\n3.3. Modelo \u00c1gua-\u00d3leo \n \n\nOptou-se neste trabalho por utilizar o modelo \u00c1gua-\u00d3leo, que \u00e9 uma vers\u00e3o \n\nsimplificada do modelo Black-Oil, que consiste apenas na simula\u00e7\u00e3o de duas fases imisc\u00edveis \n\n(\u00e1gua e \u00f3leo), isto \u00e9, Nm = 2. Desprezar-se-\u00e3o tamb\u00e9m as press\u00f5es capilares, o que implica em \n\n \n\nw op p p= =  (3.17) \n\n \n\n Al\u00e9m disso, deve-se lembrar que anteriormente j\u00e1 foi desprezado o gradiente de \n\npress\u00e3o gravitacional na defini\u00e7\u00e3o da Lei de Darcy, Eq. (3.6), por se tratar aqui de \n\nreservat\u00f3rios horizontais. Todas as aproxima\u00e7\u00f5es adotadas neste trabalho n\u00e3o comprometer\u00e3o \n\nas discuss\u00f5es e resultados a serem obtidos, uma vez que deseja-se estudar aspectos gerais da \n\nsolu\u00e7\u00e3o num\u00e9rica das equa\u00e7\u00f5es. A despeito de suas simplifica\u00e7\u00f5es, este modelo pode ser \n\naplicado em alguns casos reais, como nos sistemas dead-oil, caracterizados por apresentarem \n\n\u00f3leo em press\u00f5es baixas e sem a fase g\u00e1s dissolvida (GERRITSEN e DURLOFSKY, 2005). \n\nEfetuadas as simplifica\u00e7\u00f5es, a Eq. (3.15) pode ser reescrita para os fluidos \u00e1gua e \u00f3leo, \n\ncomo \n\n \n\n( )  w ww\nw\n\ns\nqk p\n\nBt\n? ?\n? ?? = ? +??? ?? ? ?\n\n  (3.18) \n\ne \n\n( )  o oo\nw\n\ns\nqk p\n\nBt\n? ?\n? ?? = ? +??? ?? ? ?\n\n  (3.19) \n\n \n\n\n\n CAP. 3 \u2013 FORMULA\u00c7\u00c3O MATEM\u00c1TICA 31 \n\n \n\n \n\nonde w e o s\u00e3o os \u00edndices das fases \u00e1gua e \u00f3leo, respectivamente, ? \u00e9 a mobilidade de cada \n\nfase e q~  representa a vaz\u00e3o volum\u00e9trica nas condi\u00e7\u00f5es de estocagem por unidade de volume \n\ndo reservat\u00f3rio, dados por \n\n \n\nro\no\n\no o\n\nk\nB\n\n?\n\u00b5\n\n=       e      rww\nw w\n\nk\nB\n\n?\n\u00b5\n\n=  (3.20)  \n\no\n\no\no B\n\nq\nq =~           e      \n\nw\n\nw\nw B\n\nq\nq =~  (3.21) \n\n  \n\nAs Eqs. (3.18) e (3.19) do modelo bif\u00e1sico adotado s\u00e3o equivalentes a Eq. (3.2), mas \n\ncom a vantagem de utilizar grandezas mais facilmente mensur\u00e1veis, como o fator volume de \n\nforma\u00e7\u00e3o.  Essas equa\u00e7\u00f5es formam um sistema de duas equa\u00e7\u00f5es com tr\u00eas inc\u00f3gnitas: p, sw e \n\nso. A outra equa\u00e7\u00e3o necess\u00e1ria para o fechamento do problema adv\u00e9m da inspe\u00e7\u00e3o de que \n\ntodo o espa\u00e7o poroso deve estar completamente preenchido pelos fluidos, dada por \n\n  \n\n1w os s+ =  (3.22) \n\n \n\nEsta express\u00e3o ser\u00e1 doravante chamada de equa\u00e7\u00e3o de restri\u00e7\u00e3o volum\u00e9trica. \n\nAs condi\u00e7\u00f5es de contorno utilizadas normalmente em reservat\u00f3rios que n\u00e3o \n\napresentam aq\u00fc\u00edferos s\u00e3o do tipo \u201ccontorno selado\u201d, isto \u00e9, admite-se fluxo nulo nas fronteiras \n\ndo dom\u00ednio. A intera\u00e7\u00e3o com o meio externo ao reservat\u00f3rio se d\u00e1, portanto, na maioria das \n\nvezes apenas por meio da especifica\u00e7\u00e3o de po\u00e7os (termo fonte/sorvedouro). \n\nAs viscosidades de cada fase na Eq. (3.20) podem ser consideradas como fun\u00e7\u00e3o da \n\npress\u00e3o por \n\n \n\n( )ref refm m mc p p\u00b5\u00b5 \u00b5= + ?  (3.23) \n \n\nonde \nm\n\nc\u00b5  \u00e9 o coeficiente que expressa a depend\u00eancia da viscosidade com a press\u00e3o, e as \n\ngrandezas com super-escrito ref indicam valores de refer\u00eancia. \n\nFinalmente \u00e9 importante mencionar que nas Eqs.  (3.18) e (3.19), em fun\u00e7\u00e3o de n\u00e3o \n\nhaver fase g\u00e1s neste modelo, o fator volume de forma\u00e7\u00e3o de ambas as fases \u00e9 definido apenas \n\npara o intervalo de press\u00e3o acima da de bolha (ver Fig. 3.2), onde \u00e9 assumido uma varia\u00e7\u00e3o \n\nlinear com a press\u00e3o, dada por \n\n\n\n32 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n \n\n \n\n?\n?\n?\n\n?\n\n?\n?\n?\n\n?\n?\n?\n??\n\n?\n? ??= refm\n\nref\nmm ppc1BB  (3.24) \n\n \n\nonde cm \u00e9 a compressibilidade da fase m definida por \n\n \n\nT\n\nm\n\nm\nm p\n\n1\nc\n\n?\n?\n\n=\n?\n\n?\n (3.25) \n\n \n A solu\u00e7\u00e3o do modelo \u00c1gua-\u00d3leo apresentado nesta se\u00e7\u00e3o \u00e9 o assunto considerado no \n\npr\u00f3ximo cap\u00edtulo. \n\n\n\n33 \n\nCap.    \n\n4 \nFFOORRMMUULLAA\u00c7\u00c7\u00c3\u00c3OO  NNUUMM\u00c9\u00c9RRIICCAA  \n\n  PPAARRTTEE  11  --  EEMMBBAASSAAMMEENNTTOO  TTEE\u00d3\u00d3RRIICCOO  EE  FFUUNNDDAAMMEENNTTOOSS  \n\n \n\n \n\n \nAs equa\u00e7\u00f5es que comp\u00f5em o modelo matem\u00e1tico apresentadas no cap\u00edtulo anterior \n\ns\u00e3o complexas para serem resolvidas de forma anal\u00edtica. Neste trabalho elas s\u00e3o resolvidas \n\nnumericamente atrav\u00e9s do M\u00e9todo dos Volumes Finitos baseado em Elementos (EbFVM \u2013 \n\nElement-based Finite Volume Method), apresentado de forma detalhada neste cap\u00edtulo. \n\nComo em qualquer m\u00e9todo de volumes finitos, o procedimento de obten\u00e7\u00e3o das \n\nequa\u00e7\u00f5es discretizadas tem in\u00edcio com a integra\u00e7\u00e3o das equa\u00e7\u00f5es diferenciais governantes, \n\nneste caso as deduzidas no cap\u00edtulo anterior e que s\u00e3o apresentadas novamente por \n\ncompleteza \n\n  \n\n( )  m mm\nm\n\ns\nqk p\n\nBt\n? ?\n? ?? = ? +??? ?? ? ?\n\n (4.1) \n\n \n\nonde o sub-\u00edndice m indica que esta equa\u00e7\u00e3o \u00e9 utilizada para ambas as fases \u2013 \u00e1gua e \u00f3leo (m \n\n= w ou o). Deve-se lembrar que, durante a dedu\u00e7\u00e3o do modelo matem\u00e1tico, os termos de \n\ngravidade, rea\u00e7\u00f5es qu\u00edmicas, efeitos t\u00e9rmicos e press\u00e3o capilar foram desprezados por \n\nsimplicidade, pois n\u00e3o interferem na generalidade do m\u00e9todo num\u00e9rico apresentado. \n\nO modelo bif\u00e1sico forma um sistema de duas equa\u00e7\u00f5es e tr\u00eas inc\u00f3gnitas:  p, sw e so. A \n\noutra equa\u00e7\u00e3o necess\u00e1ria para o fechamento do problema vem da condi\u00e7\u00e3o de que o espa\u00e7o \n\nporoso \u00e9 totalmente preenchido pelas fases, sendo chamada de equa\u00e7\u00e3o de restri\u00e7\u00e3o \n\nvolum\u00e9trica dada pela Eq. (3.22). \n\n \n \n\n\n\n34 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n4.1. O M\u00e9todo EbFVM \n \n\nIntegrando a equa\u00e7\u00e3o diferencial, Eq. (4.1), no tempo e em um volume de controle \n\nfinito, na forma \n \n\n( )\n, , ,\n\n    m mm\nmV t V t V t\n\ns\ndVdt q dVdtdVpk dtt B\n\n? ?\n? ?? = +? ?? ? ?? ? ?\n\n? ? ?  (4.2) \n\n \ne dividindo o resultado por t? , obt\u00e9m-se  \n\n \n\n( ) ( )  \no\n\nm mP P\no mm P\n\nm m VP\n\ns sV\nqdVk pt B B\n\n? ? ?? ?\n? ??\n\n? = +???? ?? ? ?\n?  (4.3) \n\n \nNesta express\u00e3o, as grandezas acompanhadas do sub-\u00edndice \u201cP\u201d s\u00e3o referentes ao volume de \n\ncontrole P onde a integra\u00e7\u00e3o est\u00e1 sendo efetuada. O super-\u00edndice \u201co\u201d refere-se a grandezas \n\navaliadas no passo de tempo anterior, o super-\u00edndice ?  indica que ainda \u00e9 necess\u00e1rio definir \n\nem que limites do intervalo de tempo ser\u00e1 avaliada a grandeza e q  \u00e9 a vaz\u00e3o volum\u00e9trica \n\ndada por \n\n \n\nm mq q V= ?  (4.4) \n\n \n\nem [L3.T-1], como \u00e9 normalmente utilizada nos simuladores comerciais (IMEX User\u2019s Guide, \n\n2002; STARS User\u2019s Guide, 2002). Como esta vaz\u00e3o \u00e9 dependente do modelo de po\u00e7o \n\nutilizado, ela poder\u00e1 ser calculada de diferentes formas, como ser\u00e1 mostrado no pr\u00f3ximo \n\ncap\u00edtulo. A defini\u00e7\u00e3o de quais termos ser\u00e3o tratados implicitamente na Eq. (4.3) tamb\u00e9m ser\u00e1 \n\nfeita no pr\u00f3ximo cap\u00edtulo, com exce\u00e7\u00e3o da press\u00e3o, que ser\u00e1 desde j\u00e1 considerada impl\u00edcita \n\nneste trabalho (   p p? = ).  \n\nAplicando o teorema da diverg\u00eancia de Gauss no primeiro termo do lado direito da Eq. \n\n(4.3), este termo poder\u00e1 ser escrito como \n\n \n\n( )    .m m\nV S\n\ndVk p k p dS\n? ?? ?=? ???? ?  (4.5) \n\n \n\n\n\n CAP. 4 \u2013 FORMULA\u00c7\u00c3O NUM\u00c9RICA 35 \n\n \n\n \n\nque \u00e9 uma integral de superf\u00edcie sobre todas as faces de um volume de controle. Esta integral \n\npode ser aproximada numericamente utilizando o valor da fun\u00e7\u00e3o no ponto m\u00e9dio de cada \n\nsegmento que forma esta superf\u00edcie  \n\n \n\n( )  .m m\nii PS\n\nk p Sk p dS\n? ?? ?\n\n? ?\n\n? ??? ??  (4.6) \n\n  \n\nonde i representa estes pontos m\u00e9dios, denominados de pontos de integra\u00e7\u00e3o. A partir deste \n\nmomento, portanto, \u00e9 necess\u00e1rio definir os volumes de controle no m\u00e9todo num\u00e9rico adotado \n\npara ilustrar a posi\u00e7\u00e3o destes pontos. \n\nDefinindo o elemento como a entidade geom\u00e9trica delimitada pelos n\u00f3s da malha, e o \n\nvolume de controle como a regi\u00e3o do dom\u00ednio onde as equa\u00e7\u00f5es diferenciais governantes s\u00e3o \n\nintegradas, o conceito tradicional usando em volumes finitos estabelece que o elemento da \n\nmalha e o volume de controle s\u00e3o entes geom\u00e9tricos coincidentes (cell centered construction), \n\ncomo demonstrado na Fig. 4.1a. Percebe-se que os n\u00f3s fornecidos pelo gerador de malha \n\nservem para delimitar espacialmente o volume de controle, mas as propriedades s\u00e3o \n\ncalculadas no seu centro geom\u00e9trico. No EbFVM, por sua vez, o volume de controle n\u00e3o \n\ncoincide mais com o elemento, e \u00e9 constru\u00eddo ao redor dos n\u00f3s da malha (cell vertex \n\nconstruction), conforme mostrado na Fig. 4.1b, atrav\u00e9s da uni\u00e3o de parcelas (sub-volumes de \n\ncontrole) provenientes dos elementos que rodeiam determinado n\u00f3.  \n\n \n\n \n\n        \n(a)              (b)  \n\n \n\nFig. 4.1 - Defini\u00e7\u00e3o dos elementos e volumes de controle no (a) M\u00e9todo de Volumes Finitos tradicional (FVM) e \n\n(b) no M\u00e9todo de Volumes Finitos baseado em Elementos (EbFVM) \n\n\n\n36 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nCada um dos 5 sub-volumes destacados na Fig. 4.1b que formam o volume de controle \n\nao redor do n\u00f3 P e que s\u00e3o denominados de svc1 a svc5 possuem a mesma regra de forma\u00e7\u00e3o: \n\ns\u00e3o delimitados por retas que saem das medianas das faces dos elemento at\u00e9 seu baricentro. \n\nOs pontos de integra\u00e7\u00e3o est\u00e3o localizados no centro de cada uma das faces que n\u00e3o se \n\ncomunicam com o n\u00f3 central do volume de controle, e nestas posi\u00e7\u00f5es \u00e9 que s\u00e3o avaliadas as \n\nintegrais de superf\u00edcie dadas pela Eq. (4.6). Note tamb\u00e9m que no m\u00e9todo EbFVM, sob o \n\nponto de vista da forma\u00e7\u00e3o do volume de controle, n\u00e3o h\u00e1 problema algum na uni\u00e3o de sub-\n\nvolumes provenientes de elementos triangulares e quadril\u00e1teros em uma mesma malha. Isso \n\ncontrasta com o m\u00e9todo de volumes finitos tradicional, onde a utiliza\u00e7\u00e3o de diferentes \n\nelementos em uma mesma malha \u00e9 uma tarefa bastante dif\u00edcil de ser feita. \n\nRetornando \u00e0 equa\u00e7\u00e3o de conserva\u00e7\u00e3o dos fluidos, Eq. (4.1), ap\u00f3s ter sido integrada no \n\nvolume de controle P da Fig. 4.1b e procedendo conforme foi destacado no in\u00edcio deste \n\ncap\u00edtulo, pode-se mostrar que sua forma discretizada ser\u00e1 dada por \n\n \n\n( ) ( )\no\nmm\n\nmo m P im i Pm P PP P\n\nss tk pq S\nBB V\n\n?? ?\n?? ?\n\n? ? ? ? ?? ?? ?= + + ?? ? ? ? ? ? ?? ?? ? ? ?\n?  (4.7) \n\n \n\nonde as grandezas calculadas nos n\u00f3s da malha (ou nos centros dos volumes de controle) s\u00e3o \n\nidentificadas com o sub-\u00edndice P, e aquelas grandezas avaliadas nos pontos de integra\u00e7\u00e3o s\u00e3o \n\nidentificadas com o sub-\u00edndice i, como mencionado anteriormente. \n\n \n\n4.1.1. Transforma\u00e7\u00e3o de Coordenadas \u2013 Globais para Locais \n\n \n\nNo m\u00e9todo EbFVM, as equa\u00e7\u00f5es s\u00e3o comumente resolvidas em um elemento padr\u00e3o \u2013 \n\ntriangular ou quadrangular \u2013 em coordenadas locais (?,?). Este ser\u00e1 o procedimento adotado \n\nneste trabalho porque ele apresenta, pelo menos, duas grandes vantagens:  \n\n \n\n A utiliza\u00e7\u00e3o de um sistema de coordenadas locais torna cada elemento um ente \n\nindependente dos demais;  \n \n\n Cada elemento da malha \u00e9 tratado identicamente n\u00e3o importando qu\u00e3o distorcido \n\nele se apresenta nas coordenadas globais.  \n\n\n\n CAP. 4 \u2013 FORMULA\u00c7\u00c3O NUM\u00c9RICA 37 \n\n \n\n \n\nA Fig. 4.2 apresenta exemplos de elementos triangulares e quadrangulares no plano \n\nf\u00edsico, e seus correspondentes elementos padr\u00f5es no plano transformado.  \n\n \n\n \n\n \n(a) Elemento triangular  \n\n \n\n \n(b) \u2013 Elemento quadrangular  \n\n \n\nFig. 4.2 - Diferentes elementos nos planos f\u00edsico e transformado \n\n \n\n \n\nConforme pode ser observado na Fig. 4.2, foi definido que o dom\u00ednio do sistema de \n\ncoordenadas locais (?, ?) utilizado em cada elemento do plano transformado deve variar de: \n\n \n\n Para tri\u00e2ngulos: 0 a 1 \n\n Para quadril\u00e1teros: -1 a 1 \n\n \n\ne os n\u00f3s devem ser numerados de 1 a NNE, no sentido anti-hor\u00e1rio, onde NNE \u00e9 o n\u00famero de \n\nn\u00f3s do elemento, que assume valor 3 para tri\u00e2ngulos e 4 para quadril\u00e1teros. \n\n\n\n38 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n4.1.2. Fun\u00e7\u00f5es de Forma como Fun\u00e7\u00f5es de Interpola\u00e7\u00e3o no EbFVM \n\n \n\nComo est\u00e1 se buscando uma solu\u00e7\u00e3o discreta, deve-se assumir, de alguma forma, uma \n\naproxima\u00e7\u00e3o num\u00e9rica do gradiente de press\u00e3o da Eq. (4.7) em fun\u00e7\u00e3o dos valores \n\narmazenados nos n\u00f3s da malha. No m\u00e9todo de volumes finitos tradicionais \u00e9 costume obter \n\ndiretamente express\u00f5es aproximadas das derivadas a partir do truncamento da S\u00e9rie de Taylor \n\nda fun\u00e7\u00e3o. Assim, n\u00e3o \u00e9 necess\u00e1rio utilizar o procedimento de estimar previamente como a \n\nfun\u00e7\u00e3o varia entre os n\u00f3s e depois deriv\u00e1-la analiticamente. A derivada da fun\u00e7\u00e3o \u00e9 obtida \n\ndiretamente na sua forma num\u00e9rica, sendo denominada de fun\u00e7\u00e3o de interpola\u00e7\u00e3o \n\n(MALISKA, 2004), que tem uma ordem t\u00e3o alta quanto a quantidade de n\u00f3s utilizada neste \n\nprocesso.  \n\nEsse n\u00e3o \u00e9 o procedimento utilizado no EbFVM porque o uso de malhas n\u00e3o-\n\nestruturadas inviabiliza a obten\u00e7\u00e3o de express\u00f5es gerais de derivadas espaciais uma vez que, a \n\npriori, essas malhas n\u00e3o obedecem a um padr\u00e3o de forma\u00e7\u00e3o global. Por isso, neste m\u00e9todo \u00e9 \n\nproposta uma fun\u00e7\u00e3o (linear, bi-linear etc.) definida em cada elemento, tal como no M\u00e9todo \n\nde Elementos Finitos, cujas derivadas s\u00e3o obtidas analiticamente em qualquer ponto dentro do \n\nelemento.  \n\nAssim, utilizando-se de um procedimento geral, a press\u00e3o, como qualquer outra \n\nvari\u00e1vel do dom\u00ednio, pode ser facilmente avaliada em qualquer ponto no interior de um \n\nelemento da malha em fun\u00e7\u00e3o de seus valores nodais utilizando as fun\u00e7\u00f5es de forma, Nj, que \n\nexercem o papel de fun\u00e7\u00e3o de interpola\u00e7\u00e3o \n \n\n( )\n1\n\n,\nNNE\n\nj j\nj\n\np N p? ?\n=\n\n= ?  (4.8) \n\n \n\nque s\u00e3o definidas para tri\u00e2ngulos como \n\n \n\n( )\n( )\n( )\n\n,\n\n,\n\n,\n\n1\n\n2\n\n3\n\nN 1\n\nN\n\nN\n\n? ? ? ?\n? ? ?\n? ? ?\n\n? = ? ?\n?\n\n=?\n? =?\n\n (4.9) \n\n \n\ne para quadril\u00e1teros como \n\n \n\n\n\n CAP. 4 \u2013 FORMULA\u00c7\u00c3O NUM\u00c9RICA 39 \n\n \n\n \n\n( ) ( ) ( )\n\n( ) ( ) ( )\n\n( ) ( ) ( )\n\n( ) ( ) ( )\n\n,\n\n,\n\n,\n\n,\n\n1\n\n2\n\n3\n\n4\n\n1N 1 1\n4\n1 1 1N\n4\n1N 1 1\n4\n1N 1 1\n4\n\n? ? ? ?\n\n? ?? ?\n\n? ? ? ?\n\n? ? ? ?\n\n? = + +?\n?\n? ? +=\n?\n?\n? = ? ?\n?\n?\n? += ?\n?\n\n (4.10) \n\n \n\nPode-se mostrar que as coordenadas globais de qualquer ponto dentro do elemento \n\ntamb\u00e9m podem ser expressas em fun\u00e7\u00e3o de seus valores nodais como \n\n \n\n( ) ( )\n1\n\n, ,\nNNE\n\nj j\nj\n\nx N x? ? ? ?\n=\n\n=?  (4.11) \n\n( ) ( )\n1\n\n, ,\nNNE\n\nj j\nj\n\ny N y? ? ? ?\n=\n\n=?  (4.12) \n\n \n\n \n\n4.1.3. Avalia\u00e7\u00e3o do Gradiente de Press\u00e3o \n\n \n\nComo as fun\u00e7\u00f5es de forma s\u00e3o cont\u00ednuas dentro de cada elemento, podendo, portanto, \n\nserem diferenciadas, as derivadas espaciais da press\u00e3o presentes no termo de fluxo da Eq. \n\n(4.7) podem ser calculadas em qualquer ponto (?, ?) no interior de cada elemento como \n\n \n\n1, ,\n\nNNE\nj\n\nj\nj\n\nNp\np\n\nx x? ? ? ?=\n??\n\n=\n? ??  (4.13) \n\n1 ,,\n\nNNE\nj\n\nj\nj\n\nNp p\ny y\n\n? ?? ? =\n\n??\n=\n\n? ??  (4.14) \n\n \n\nonde a quest\u00e3o-chave \u00e9 a determina\u00e7\u00e3o das derivadas das fun\u00e7\u00f5es de forma /jN x? ?  e  \n\n/jN y? ? . Para tanto, emprega-se, inicialmente, a regra da cadeia, na forma \n\n \n\n\n\n40 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nj j jN N Nx y\nx y? ? ?\n\n? ? ?? ?\n= +\n\n? ? ? ? ?\n (4.15) \n\ne        \n\nj j jN N Nx y\nx y? ? ?\n\n? ? ?? ?\n= +\n\n? ? ? ? ?\n (4.16) \n\n \n\nEssas express\u00f5es escritas de forma matricial resultam em \n\n \n\n1 1\n\n11\n\n..... .....\n\n..........\n\nNNE NNE\n\nNNENNE\n\nNN x y N N\nx x\n\nNNN x yN\ny y\n\n? ? ? ?\n\n? ?? ?\n\n?? ? ? ??? ? ? ? ? ?\n? ? ? ? ? ?? ? ? ? ? ?\n? ? ? ? ? ?=\n\n?? ? ?? ?? ? ?? ? ?\n? ? ? ? ? ?? ?? ?? ?? ? ? ?? ?\n\n  (4.17) \n\n \nManipulando a equa\u00e7\u00e3o anterior, pode-se mostrar que as derivadas /jN x? ?  e  \n\n/jN y? ?  s\u00e3o dadas por \n \n\n[ ] [ ]\n1\n\n1\n\n1\n\n.....\n\n.....\n\nNNE\n\nNNE\n\nNN\nx x\n\nJ D\nNN\n\ny y\n\n?\n\n??? ?\n? ?? ?\n? ? =\n\n??? ?\n? ?? ?? ?\n\n (4.18) \n\n \nonde [J] \u00e9 a matriz Jacobiana de transforma\u00e7\u00e3o e [D] \u00e9 a matriz de derivadas das fun\u00e7\u00f5es de \n\nforma \n\n \n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n\n?\n?\n\n?\n?\n\n?\n?\n\n=\n\n??\n\n??\nyx\n\nyx\n\nJ ][  (4.19) \n\ne  \n\n1\n\n1\n\n.....\n\n[ ]\n.....\n\nNNE\n\nNNE\n\nNN\n\nD\nNN\n\n? ?\n\n? ?\n\n??? ?\n? ?? ?\n? ?=\n? ???\n? ?? ?? ?\n\n (4.20) \n\n \n\nUtilizando as Eqs. (4.13), (4.14) e (4.18) pode-se, finalmente, obter a forma matricial \n\ndo gradiente de qualquer vari\u00e1vel gen\u00e9rica dada por \n\n\n\n CAP. 4 \u2013 FORMULA\u00c7\u00c3O NUM\u00c9RICA 41 \n\n \n\n \n\n{ } { }1[ ] [ ] epp DJ\n?=?  (4.21) \n\n \n\nonde { }ep  \u00e9 o vetor com os valores nodais da press\u00e3o no elemento (dimens\u00e3o de NNE), e ][J  \n\u00e9 a matriz de transforma\u00e7\u00e3o Jacobiana definida na Eq. (4.19) e que pode ser facilmente \n\ncalculada a partir de \n\n \n[ ][ ] eZDJ =][  (4.22)   \n\n \n\nonde [ ] eZ  \u00e9 a matriz de coordenadas dos n\u00f3s que definem um elemento da malha \n \n\n[ ]\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n\n?\n\n?\n\n=\n\nNNENNE\n\n22\n\n11\n\ne\n\nyx\n\nyx\nyx\n\nZ  (4.23) \n\n \n\nDeve-se lembrar, no entanto, que em fun\u00e7\u00e3o das diferentes fun\u00e7\u00f5es de forma utilizadas \n\nneste trabalho (lineares, Eq. (4.9), para elementos triangulares e bi-lineares, Eq. (4.10), para \n\nelementos quadrangulares), as matrizes de derivadas em rela\u00e7\u00e3o \u00e0s coordenadas locais, [D], \n\nt\u00eam formas diferentes de acordo com o tipo de elemento \n\n  \n\n Para tri\u00e2ngulos:      [ ] ?\n?\n\n?\n?\n?\n\n?\n?\n?\n\n=\n101\n011D     (4.24) \n\n     \n\n Para quadril\u00e1teros:  [ ] ?\n?\n\n?\n?\n?\n\n?\n??+??+\n\n?+???+\n=\n\n????\n????\n\n1111\n1111\n\nD\n4\n1     (4.25) \n\n \n \n\n\u00c9 importante notar tamb\u00e9m que para elementos triangulares a express\u00e3o do gradiente \n\nde press\u00e3o, Eq. (4.21), resultar\u00e1 sempre em um valor constante, independente da posi\u00e7\u00e3o \n\nanalisada no interior do elemento, uma vez que a matriz de derivadas em rela\u00e7\u00e3o \u00e0s \n\ncoordenadas locais, [D], \u00e9 formada por componentes que n\u00e3o dependem da localiza\u00e7\u00e3o \n\nespacial, Eq. (4.24). Diversos trabalhos na literatura t\u00eam utilizado esta condi\u00e7\u00e3o de gradiente \n\nde press\u00e3o constante para desenvolver m\u00e9todos num\u00e9ricos que resultam em um \n\nequacionamento que possui forte similaridade com o utilizado em simuladores comerciais \n\n(FORSYTH, 1990; FUNG et al., 1991; GOTTARDI e DALL\u00b4OLIO, 1992). A aplicabilidade \n\n\n\n42 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\ndestes esquemas, no entanto, \u00e9 restrita apenas a malhas triangulares e escoamentos \n\nmonof\u00e1sicos, conforme ser\u00e1 discutido no Cap. 7. \n\n \n\n4.1.4. C\u00e1lculo da \u00c1rea de Passagem do Fluxo \n\n  \n\nAvan\u00e7ando na apresenta\u00e7\u00e3o do tratamento dado no EbFVM aos termos presentes na \n\nEq. (4.7), nesta se\u00e7\u00e3o ser\u00e1 considerado o vetor \u00e1rea { }S? . Embora em 2D esta \u00e1rea seja vista \nsimplesmente como uma linha, a denomina\u00e7\u00e3o \u201c\u00e1rea\u201d continuar\u00e1 sendo utilizada neste \n\ntrabalho. De uma forma geral, valendo-se da id\u00e9ia de calcular as grandezas elemento a \n\nelemento, prop\u00f5e-se determin\u00e1-la a partir da seguinte express\u00e3o matricial (HURTADO, 2005) \n\n \n\n{ } [ ] [ ] { }iTii JRS ?=?  (4.26) \n \n\nonde i \u00e9 o ponto de integra\u00e7\u00e3o localizado sobre a face cuja \u00e1rea deseja-se determinar e R \u00e9 a \n\nmatriz de rota\u00e7\u00e3o dada por \n\n \n\n[ ] ??\n?\n\n??\n?= ? 01\n\n10R  (4.27) \n\n \n\ne { }i?  \u00e9 a \u00e1rea da face do sub-volume de controle em coordenadas locais. A defini\u00e7\u00e3o \ngeom\u00e9trica de cada uma destas \u00e1reas est\u00e1 diretamente relacionada \u00e0 defini\u00e7\u00e3o da posi\u00e7\u00e3o do \n\nponto C no interior do elemento (Fig. 4.3). Embora seja arbitr\u00e1ria, a posi\u00e7\u00e3o deste ponto tem \n\nsido definida no baricentro do elemento no EbFVM porque facilita a implementa\u00e7\u00e3o \n\ncomputacional ao possibilitar a implementa\u00e7\u00e3o de algoritmos mais gerais, e origina sub-\n\nvolumes de controle de dimens\u00f5es semelhantes. \n\nAssim, de acordo com a defini\u00e7\u00e3o dos elementos padr\u00f5es no plano transformado, Fig. \n\n4.3, as \u00e1reas da face dos sub-volumes de controle em coordenadas locais { }i?  para diferentes \npontos de integra\u00e7\u00e3o i s\u00e3o dadas por \n\n \n\n Para tri\u00e2ngulos:  \n \n\n        { }\n?\n?\n?\n\n?\n?\n??=?\n\n61\n31\n\n1    { }\n?\n?\n?\n\n?\n?\n?=?\n\n? 31\n61\n\n2    { }\n?\n?\n?\n\n?\n?\n?=?\n\n61\n61\n\n3  (4.28)  \n\n\n\n CAP. 4 \u2013 FORMULA\u00c7\u00c3O NUM\u00c9RICA 43 \n\n \n\n \n\n \n Para quadril\u00e1teros: \n\n \n\n        { }\n?\n?\n?\n\n?\n?\n?=?\n\n0\n1\n\n1       { }\n?\n?\n?\n\n?\n?\n?=?\n\n1\n0\n\n2       { }\n?\n?\n?\n\n?\n?\n?=?\n\n?\n0\n1\n\n3       { }\n?\n?\n?\n\n?\n?\n?=?\n\n? 1\n0\n\n4  (4.29) \n\n \n \n \n \n \n \n\n               \n \n\n(a) Elementos triangulares  \n\n \n\n(b) Elementos quadrangulares \n\n \n\nFig. 4.3 - Elementos triangulares e quadrangulares nos planos f\u00edsico e transformado, demonstrando as \u00e1reas de \n\nface dos sub-volumes de controle e os pontos de integra\u00e7\u00e3o (ip) \n\n \n \n \n\n\n\n44 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n4.1.5. Esquema de Avalia\u00e7\u00e3o das Mobilidades \n\n \n\nO tratamento dado \u00e0 mobilidade, ?, na Eq. (4.7) \u00e9 o assunto abordado nesta se\u00e7\u00e3o. Foi \n\nvisto que no EbFVM as vari\u00e1veis s\u00e3o calculadas e est\u00e3o dispon\u00edveis diretamente apenas nos \n\nn\u00f3s da malha, podendo-se obter valores interpolados em qualquer posi\u00e7\u00e3o no interior de um \n\nelemento atrav\u00e9s da utiliza\u00e7\u00e3o das fun\u00e7\u00f5es de forma, Eqs. (4.9) e (4.10). Este procedimento j\u00e1 \n\nfoi utilizado na discretiza\u00e7\u00e3o do gradiente de press\u00e3o (se\u00e7\u00e3o 4.1.2), e ent\u00e3o, a priori, poder-se-\n\nia utilizar estas fun\u00e7\u00f5es semelhantemente para avaliar o termo de mobilidade nos pontos de \n\nintegra\u00e7\u00e3o.  \n\nMas este procedimento n\u00e3o se mostra adequado na pr\u00e1tica porque o termo que cont\u00e9m \n\na mobilidade pode ser considerado um termo advectivo da equa\u00e7\u00e3o da satura\u00e7\u00e3o, Eq. (4.7), e \n\ntermos desta natureza n\u00e3o conferem estabilidade ao m\u00e9todo se n\u00e3o forem representados por \n\nfun\u00e7\u00f5es de interpola\u00e7\u00e3o baseadas no valor a montante (upwind schemes). Por isso este \u00e9 o \n\nesquema utilizado neste trabalho. Neste esquema os valores da permeabilidade relativa, fator \n\nvolume de forma\u00e7\u00e3o e viscosidade utilizados no c\u00e1lculo da mobilidade avaliada num dado \n\nponto de integra\u00e7\u00e3o, Eq. (3.20), ser\u00e3o calculados a partir dos valores nodais de satura\u00e7\u00e3o e \n\npress\u00e3o do volume de controle a montante. Esse esquema, tamb\u00e9m denominado de upwind \n\nunidimensional, \u00e9 incondicionalmente est\u00e1vel, como mencionado, embora possa resultar em \n\nexcessiva difus\u00e3o num\u00e9rica e uma depend\u00eancia an\u00f4mala dos resultados com a dire\u00e7\u00e3o das \n\nlinha da malha em alguns casos  (PEACEMAN, 1977; YOSHIAKI, 1982; WOLCOTT et al., \n\n1996).  \n\n \n\nEsquemas upwind usuais. Na literatura encontram-se comumente dois diferentes \n\nesquemas upwind aplicados em malhas triangulares para avalia\u00e7\u00e3o da mobilidade, mas que, \n\nna realidade, n\u00e3o asseguram que em todos os casos ela seja calculada a partir dos valores \n\nnodais realmente localizados a montante. Isso pode resultar em solu\u00e7\u00f5es n\u00e3o-f\u00edsicas. Um \n\ndestes esquemas \u00e9 bastante similar ao procedimento utilizado nos simuladores comerciais com \n\nmalhas estruturadas, e baseia-se simplesmente na an\u00e1lise do valor de press\u00e3o1 dos dois \n\nvolumes de controle vizinhos \u00e0 face onde se deseja avaliar a mobilidade. Infelizmente esse \n\nesquema n\u00e3o \u00e9 apropriado nos casos onde o fluxo em cada face \u00e9 calculado com express\u00f5es \n\n                                                 \n1 Em problemas tridimensionais, o procedimento usual se baseia na an\u00e1lise do valor do potencial (AZIZ e \nSETTARI, 1979), que \u00e9 uma grandeza f\u00edsica que envolve tamb\u00e9m o termo gravitacional n\u00e3o considerado neste \ntrabalho. \n\n\n\n CAP. 4 \u2013 FORMULA\u00c7\u00c3O NUM\u00c9RICA 45 \n\n \n\n \n\nque envolvem mais de dois valores nodais de press\u00e3o, como nas malhas n\u00e3o-estruturadas2. \u00c9 \n\nposs\u00edvel encontrar em determinados casos, por exemplo, pj > pk , enquanto que na interface \n\nentre os sub-volumes de controle j e k o escoamento se d\u00e1 no sentido de k pra j (CORDAZZO \n\net al., 2004a e b). Neste caso o valor a jusante \u00e9 o utilizado, e portanto, serve como exemplo \n\nde que a aplica\u00e7\u00e3o pr\u00e1tica deste tipo de esquema \u00e9 limitado. \n\nEm outro esquema bastante utilizado, a escolha do valor a montante \u00e9 baseado na \n\navalia\u00e7\u00e3o do sinal do termo ( )jk j kp pT ? . Nesta express\u00e3o, \u00e9 pressuposto que o coeficiente \nTjk, freq\u00fcentemente denominado de transmissibilidade, contenha os par\u00e2metros f\u00edsicos e \n\ngeom\u00e9tricos utilizados no c\u00e1lculo do fluxo em malhas ortogonais: \u00e1rea, dist\u00e2ncia entre os n\u00f3s \n\ne a permeabilidade absoluta da interface. Contudo quando o fluxo deve ser calculado em uma \n\nexpress\u00e3o que envolva mais de dois valores nodais, como \u00e9 o caso quando a ortogonalidade \n\nlocal n\u00e3o existe, n\u00e3o \u00e9 poss\u00edvel mais identificar a transmissibilidade, como ser\u00e1 visto no \n\nCap.7. Assim, \u00e9 poss\u00edvel mostrar que este esquema tamb\u00e9m n\u00e3o tem suporte f\u00edsico, porque o \n\ntermo ( )kjjk ppT ?  n\u00e3o \u00e9, na realidade, o fluxo completo entre os n\u00f3s j e k em malhas \ntriangulares. \n\n \n\nEsquema proposto. Neste trabalho \u00e9 utilizada uma mesma express\u00e3o aplic\u00e1vel para \n\nelementos triangulares e quadrangulares, em que a mobilidade jk?  \u00e9 avaliada nas interfaces \n\ndos volumes de controle j e k a partir da correta interpreta\u00e7\u00e3o de qual \u00e9 a dire\u00e7\u00e3o a montante \n\ndo escoamento nesta interface. Isso \u00e9 poss\u00edvel analisando-se o sinal do seguinte produto \n\nescalar \n\n \n\n( )\n( )\n\n          se           \n\n          se   \n\njk j\njk\n\njk k\njk\n\n0k p S\n\n0k p S\n\n? ?\n\n? ?\n\n? ?= ? ?&lt;\n?\n?\n\n?? = ? ? >\n?\n\n (4.30) \n\n \n\nonde o n\u00f3 j considerado nas express\u00f5es anteriores corresponde ao sub-volume de controle \n\nonde o vetor normal associado a ?S aponta para fora. Note que foi omitida a mobilidade no \n\ntermo do fluxo em virtude de ser representada sempre por um valor positivo, n\u00e3o exercendo \n\nnenhum efeito neste esquema de avalia\u00e7\u00e3o. O procedimento dado na Eq. (4.30) assegura que \n\nas mobilidades utilizadas pelo esquema num\u00e9rico sejam realmente aquelas obtidas a partir dos \n                                                 \n2 A exce\u00e7\u00e3o \u00e9 o m\u00e9todo de Voronoi onde o fluxo \u00e9 calculado com uma express\u00e3o discretizada que envolve \napenas dois valores nodais em fun\u00e7\u00e3o da utiliza\u00e7\u00e3o de malhas com ortogonalidade local. \n\n\n\n46 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nvalores \u00e0 montante, mesmo nos casos onde o meio \u00e9 anisotr\u00f3pico, isto \u00e9, em casos onde o \n\nvetor velocidade pode n\u00e3o estar alinhado na dire\u00e7\u00e3o do vetor gradiente de potencial. \n\n\u00c9 importante mencionar tamb\u00e9m que diferentemente dos m\u00e9todos que lidam com \n\nmalhas estruturadas tradicionais, no EbFVM os pontos de integra\u00e7\u00e3o n\u00e3o est\u00e3o localizados \n\nexatamente sobre a linha que une dois n\u00f3s vizinhos como demonstra a Fig. 4.4a, e por isso \n\nmesmo n\u00e3o se pode utilizar apenas dois valores de press\u00e3o no processo de decis\u00e3o de qual \n\nest\u00e1 a montante. A Fig. 4.4b apresenta em destaque dois elementos da malha n\u00e3o-estruturada \n\nda Fig. 4.4a formados pelos n\u00f3s a, b, c, j e k, bem como a posi\u00e7\u00e3o dos dois pontos de \n\nintegra\u00e7\u00e3o localizados na interface dos volumes de controle constru\u00eddos ao redor dos n\u00f3s j e k. \n\nPercebe-se que os pontos de integra\u00e7\u00e3o est\u00e3o localizados dentro dos elementos, e por isso o \n\ntratamento dado \u00e0s grandezas avaliadas em cada um destes pontos deve ser elemento a \n\nelemento e n\u00e3o por interfaces de elementos (arestas), uma vez que existe a possibilidade de \n\num fluxo se dar na dire\u00e7\u00e3o de um volume de controle para o outro dentro de um elemento, \n\nenquanto que no elemento vizinho a dire\u00e7\u00e3o do fluxo entre estes volumes pode ser a oposta. \n\n \n\n \n\n \n     (a)      (b) \n\n \n\nFig. 4.4 - Localiza\u00e7\u00e3o dos pontos de integra\u00e7\u00e3o comuns a dois volumes de controle em (a) uma malha n\u00e3o-\n\nestruturada e, em destaque, em duas faces do volume de controle formado ao redor do n\u00f3 k \n\n \n\n \n\nAs experi\u00eancias t\u00eam mostrado que esta situa\u00e7\u00e3o inusitada de haver fluxos com \n\nsentidos contr\u00e1rios em pontos localizados em uma mesma interface (jk1 e jk2 da Fig. 4.4b, por \n\nexemplo) acontece normalmente apenas quando a malha \u00e9 composta por elementos bastante \n\ndeformados, que n\u00e3o \u00e9 o caso dos elementos ilustrados na Fig. 4.4 que foram constru\u00eddos com \n\numa boa raz\u00e3o de aspecto para facilitar a compreens\u00e3o. \n\n\n\n CAP. 4 \u2013 FORMULA\u00c7\u00c3O NUM\u00c9RICA 47 \n\n \n\n \n\nO procedimento proposto neste trabalho para a avalia\u00e7\u00e3o das mobilidades pode ser \n\nimplementado computacionalmente sem maiores dificuldades se o termo de an\u00e1lise da Eq. \n\n(4.30) for escrito matricialmente como \n\n \n\n( ) { } { }  Ti ei pk p S H? ?? =  (4.31) \n \n\nonde { }TiH  \u00e9 um vetor linha de dimens\u00f5es (NNE) calculado apenas no in\u00edcio da simula\u00e7\u00e3o, e \n\u00e9 composto pelos termos que dependem apenas da geometria e propriedades f\u00edsicas constantes \n\nde cada elemento, que foram aglomerados na forma \n\n \n\n{ } { } [ ] [ ] [ ]1T Ti i i ikH S J D\n?\n\n= ?  (4.32) \n\n \n\nonde o tensor de permeabilidades absolutas, [k], \u00e9 definido como \n\n   \n\n[ ] xx xy\nyx yy\n\nk k\nk\n\nk k\n? ?\n\n= ? ?\n? ?\n\n (4.33) \n\n \nNote que \u00e9 muito simples e direta a inclus\u00e3o da forma completa do tensor de \n\npermeabilidades absolutas neste m\u00e9todo. Isso \u00e9 uma importante caracter\u00edstica em se tratando \n\nde simula\u00e7\u00e3o de reservat\u00f3rios heterog\u00eaneos e anisotr\u00f3picos3. Percebe-se, no entanto, que n\u00e3o \n\nfoi feita ainda nenhuma considera\u00e7\u00e3o a respeito de como as propriedades f\u00edsicas como \n\npermeabilidade absoluta e porosidade s\u00e3o armazenadas no dom\u00ednio. Al\u00e9m disso, n\u00e3o foi \n\nmencionado como representar as falhas geol\u00f3gicas com o m\u00e9todo proposto. Estas quest\u00f5es \n\ns\u00e3o apresentadas na seq\u00fc\u00eancia. \n\n  \n\n \n\n \n\n \n\n                                                 \n3 Neste trabalho \u00e9 considerado heterog\u00eaneo o dom\u00ednio que apresentar varia\u00e7\u00e3o espacial das propriedades f\u00edsicas \nporosidade e/ou permeabilidade absoluta. Quando o tensor definido na Eq. (4.33) n\u00e3o for isotr\u00f3pico, o dom\u00ednio \nser\u00e1 considerado anisotr\u00f3pico. Baseado nestas defini\u00e7\u00f5es pode-se afirmar que um reservat\u00f3rio heterog\u00eaneo n\u00e3o \nser\u00e1 necessariamente anisotr\u00f3pico, e vice-versa. \n\n\n\n48 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n4.2. Representa\u00e7\u00e3o das Propriedades F\u00edsicas \n \n Como visto at\u00e9 agora, a utiliza\u00e7\u00e3o de malhas n\u00e3o-estruturadas e das fun\u00e7\u00f5es de forma \n\n\u00e9 o fato novo que diferencia o EbFVM dos m\u00e9todos de volumes finitos tradicionais. No \n\nentanto, pode-se afirmar que as diferen\u00e7as n\u00e3o s\u00e3o apenas estas. Como o elemento de malha e \n\no volume de controle n\u00e3o s\u00e3o mais entidades coincidentes, deve-se escolher em qual delas as \n\npropriedades f\u00edsicas, como permeabilidade e porosidade, dever\u00e3o ser armazenadas.  \n\nNos m\u00e9todos pesquisados que utilizam malhas n\u00e3o-estruturadas e conserva\u00e7\u00e3o local, as \n\npropriedades f\u00edsicas s\u00e3o armazenadas nos volumes de controle (VERMA e AZIZ, 1997; \n\nSTARS User\u2019s Guide, 2002). No m\u00e9todo proposto nesta tese, no entanto, prop\u00f5e-se \n\narmazen\u00e1-las nos elementos porque esta forma de armazenamento apresenta diversas \n\nvantagens comentadas na seq\u00fc\u00eancia. Contudo, independentemente do esquema de \n\narmazenamento das propriedades escolhido, as vari\u00e1veis principais calculadas no modelo \n\nnum\u00e9rico, como press\u00e3o e satura\u00e7\u00e3o, continuam sendo armazenadas nos n\u00f3s da malha. Na \n\nFig. 4.5 comparam-se ambos os esquemas, destacando-se a malha de entrada de dados das \n\npropriedades e aquela interpretada pelo simulador. \n\nA primeira vantagem que pode ser citada no armazenamento das propriedades nos \n\nelementos da malha \u00e9 que desta forma \u00e9 desnecess\u00e1rio efetuar qualquer tipo de m\u00e9dia para \n\navaliar a permeabilidade absoluta nas interfaces dos volumes de controle. Nos m\u00e9todos \n\ntradicionais, onde o armazenamento se d\u00e1 nos volumes de controle, esta m\u00e9dia \u00e9 necess\u00e1ria \n\nporque existe a descontinuidade da propriedade nas interfaces dos volumes. Nestes casos \n\nnormalmente \u00e9 utilizada a m\u00e9dia harm\u00f4nica (PETTERSEN, 1983), que para uma malha \n\nuniforme \u00e9 dada por \n \n\n11 1\n\n2\nj k\n\njk\n\nk k\nk\n\n?? ?? ?+\n= ? ?? ?\n? ?\n\n (4.34) \n\n \n\n Esta m\u00e9dia \u00e9 fisicamente justificada apenas para escoamento unidimensional, sendo \n\nincerta a sua extens\u00e3o para as situa\u00e7\u00f5es bi e tridimensionais. Diversos autores t\u00eam criticado a \n\nm\u00e9dia harm\u00f4nica utilizada para avaliar as permeabilidades internodais (TORONYI e \n\nFAROUQ ALI, 1974; APPEL, 1976; PETTERSEN, 1983). Romeu e Noetinger (1995) \n\nquantificaram os erros sistem\u00e1ticos nos resultados num\u00e9ricos devido ao uso deste e outros \n\ntipos de m\u00e9dia, desenvolvendo um modelo anal\u00edtico que confirmou a exist\u00eancia de grandes \n\nerros e de uma baixa converg\u00eancia em alguns casos. \n\n\n\n CAP. 4 \u2013 FORMULA\u00c7\u00c3O NUM\u00c9RICA 49 \n\n \n\n \n\n \n \n\n(a) Propriedades armazenadas nos volumes de controle \n\n \n\n \n \n\n(b) Propriedades armazenadas nos elementos da malha \n\nFig. 4.5 - Diferentes formas de armazenar as propriedades f\u00edsicas: (a) no volume de controle (VERMA e AZIZ, \n\n1997), e (b) nos elementos (proposto neste trabalho) \n\n  \n\n \n\n A desvantagem do esquema de armazenamento proposto nesta tese \u00e9 a necessidade de \n\ncalcular uma porosidade m\u00e9dia no volume porque, conforme mostrado na Fig. 4.5b, o volume \n\nde controle resultante ser\u00e1 heterog\u00eaneo. Prop\u00f5e-se utilizar uma m\u00e9dia volum\u00e9trica da \n\nporosidade do tipo \n\n \n\n1\nP k k\n\nk PP\n\nV\nV\n\n??\n? ?\n\n= ?\n? ?  (4.35) \n\n \n\nonde k representa cada um dos sub-volumes de controle que formam o volume P. \n\n Embora possa parecer que houve uma simples troca de vari\u00e1vel cuja m\u00e9dia necessita \n\nser tomada (ao inv\u00e9s de fazer uma m\u00e9dia na permeabilidade \u00e9 feita na porosidade), deve-se \n\nesperar uma melhora nos resultados num\u00e9ricos, uma vez que em problemas pr\u00e1ticos a faixa de \n\n\n\n50 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nvaria\u00e7\u00e3o espacial da porosidade \u00e9 bem menor que a da permeabilidade. Por isso um \n\nprocedimento mais simples e f\u00e1cil, como o proposto na Eq. (4.35), pode ser empregado. \n\nAliado a isso, os fluxos nas interfaces dos volumes de controle s\u00e3o calculados a partir da Lei \n\nde Darcy, onde \u00e9 a permeabilidade que aparece e n\u00e3o a porosidade. Essas raz\u00f5es d\u00e3o suporte a \n\nescolha de um m\u00e9todo num\u00e9rico que usa a m\u00e9dia da porosidade ao inv\u00e9s da m\u00e9dia da \n\npermeabilidade absoluta. \n\n \n\n  \n\n4.3. Representa\u00e7\u00e3o das Falhas \n \n\nNesta se\u00e7\u00e3o s\u00e3o discutidas as diferentes formas de modelar falhas geol\u00f3gicas no \n\nEbFVM: \n\n \n\n(1) eliminando elementos no interior do dom\u00ednio, \n\n(2) zerando o fluxo diretamente nas interfaces dos volumes de controle, e  \n\n(3) representando a falha a partir de elementos geom\u00e9tricos com espessura reduzida e \n\ncom valores nulos de permeabilidade absoluta.  \n\n \n\nNo primeiro caso, vale-se de uma das vantagens do emprego de malhas n\u00e3o-\n\nestruturadas, que \u00e9 a facilidade de retirar elementos de qualquer posi\u00e7\u00e3o do dom\u00ednio. Isso n\u00e3o \n\nacarreta na necessidade de altera\u00e7\u00e3o do c\u00f3digo computacional, porque o tratamento dado a \n\nesta regi\u00e3o \u00e9 o mesmo dado as outras fronteiras (condi\u00e7\u00e3o de contorno imperme\u00e1vel). A \n\naus\u00eancia de elementos no interior da malha causa necessariamente uma interrup\u00e7\u00e3o no fluxo \n\nnaquela dire\u00e7\u00e3o, que \u00e9 o efeito causado pela presen\u00e7a de uma falha geol\u00f3gica. No entanto, \n\napenas falhas totalmente selantes s\u00e3o representadas desta forma, o que \u00e9 uma a desvantagem \n\ndeste tipo de modelagem. \n\nNo segundo caso, a falha modelada n\u00e3o tem espessura, constituindo-se em uma linha \n\nem 2D ou uma superf\u00edcie em 3D, como ilustrado na Fig. 4.6. A sua principal vantagem \u00e9 a \n\nfacilidade de representa\u00e7\u00e3o no esquema num\u00e9rico: basta zerar os termos de fluxo entre os \n\nvolumes de controle separados pela falha geol\u00f3gica. Al\u00e9m disso, outra vantagem \u00e9 a \n\neconomia no n\u00famero de equa\u00e7\u00f5es do sistema linear, uma vez que n\u00e3o h\u00e1 necessidade de mais \n\nelementos, e em conseq\u00fc\u00eancia de mais n\u00f3s para representar a falha. \n\nNo entanto, uma desvantagem consiste na necessidade de visualizar, al\u00e9m da malha \n\ndos elementos, a malha dual formada pelos volumes de controle constru\u00eddos ao redor dos n\u00f3s \n\n\n\n CAP. 4 \u2013 FORMULA\u00c7\u00c3O NUM\u00c9RICA 51 \n\n \n\n \n\nda malha, a fim de posicionar as falhas. Isto poder\u00e1 ser bastante trabalhoso, principalmente \n\nem se tratando de malhas n\u00e3o-estruturadas, porque o procedimento consiste em gerar uma \n\nmalha de elementos e, a partir dos volumes formados, localizar a falha nas fronteiras dos \n\nvolumes. Se o resultado n\u00e3o for satisfat\u00f3rio, deve-se gerar outra malha e assim por diante. \n\nQuando s\u00e3o utilizados elementos triangulares, por exemplo, a representa\u00e7\u00e3o de uma falha \n\natrav\u00e9s do cancelamento dos fluxos dentro do elemento (ou nas faces dos volumes de \n\ncontrole) \u00e9 uma tarefa ainda mais delicada, porque dificilmente se conseguir\u00e1 representar uma \n\nfalha que seja geometricamente linear com elementos triangulares.  \n\n \n\n \n\n \n\n                        \n\nFig. 4.6 - Falha modelada a partir do cancelamento do fluxo no ponto de integra\u00e7\u00e3o \n\n \n\n \n\nDeve-se destacar, contudo, que a principal desvantagem do esquema de representa\u00e7\u00e3o \n\nde falha apresentado na Fig. 4.6 est\u00e1 na incompatibilidade com os tipos de fun\u00e7\u00f5es de forma \n\nutilizadas como fun\u00e7\u00f5es de interpola\u00e7\u00e3o. Quando se prescreve uma falha no interior do \n\nelemento, imp\u00f5e-se uma descontinuidade da fun\u00e7\u00e3o naquela posi\u00e7\u00e3o. Isso \u00e9 incompat\u00edvel com \n\nas fun\u00e7\u00f5es lineares e bi-lineares utilizadas em cada elemento, que n\u00e3o conseguir\u00e3o reproduzir \n\no \u2018degrau\u2019 na fun\u00e7\u00e3o oriundo da presen\u00e7a da falha no interior do elemento. \n\nPor essas raz\u00f5es, prop\u00f5e-se neste trabalho um esquema diferente de representa\u00e7\u00e3o de \n\nfalhas, no qual elas s\u00e3o tratadas como entes geom\u00e9tricos com dimens\u00e3o e propriedades f\u00edsicas. \n\n\n\n52 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nAssim \u00e9 necess\u00e1rio que elas sejam formadas por elementos de pequena espessura, e com \n\npermeabilidade absoluta e porosidade baixas. Tratamentos similares aplicados \u00e0s malhas n\u00e3o-\n\nestruturadas j\u00e1 foram recomendados anteriormente por Kocberber (1995) e Young (1999). A \n\nFig. 4.7 apresenta exemplos de falhas modeladas a partir de tri\u00e2ngulos e quadril\u00e1teros. Neste \n\ncaso, torna-se dispens\u00e1vel a visualiza\u00e7\u00e3o conjunta da malha de volumes de controle e o \n\ntrabalho de gerar novas malhas tais que as falhas estejam mais bem posicionadas nas suas \n\nfronteiras. \n\n \n\n \n\n \n\nFig. 4.7 - Falhas representadas a partir de elementos com baixas permeabilidade e porosidade \n\n \n\n \n\n\u00c9 importante mencionar que a utiliza\u00e7\u00e3o de elementos de pequena espessura \n\nlocalizados ao lado de elementos de grande espessura n\u00e3o introduz um mau condicionamento \n\nna matriz de coeficientes do sistema linear. A raz\u00e3o \u00e9 que os volumes de controle \n\ncorrespondentes aos n\u00f3s localizados nas interfaces da falha s\u00e3o constru\u00eddos com \u00e1reas e \n\nvolumes  provenientes tamb\u00e9m dos elementos adjacentes \u00e0 falha, e que tem dimens\u00f5es f\u00edsicas \n\ncompar\u00e1veis aos demais elementos da malha.  \n\n  Embora tenha que se utilizar mais elementos de malha neste m\u00e9todo do que no \n\nanterior, o que \u00e9 uma desvantagem, deve-se dizer que esta forma de representar meios \n\nheterog\u00eaneos e modelar falhas geol\u00f3gicas propostas \u00e9 compat\u00edvel com o uso das fun\u00e7\u00f5es de \n\nforma definidas elemento a elemento. Al\u00e9m disso, \u00e9 um esquema de representa\u00e7\u00e3o mais \n\n\n\n CAP. 4 \u2013 FORMULA\u00c7\u00c3O NUM\u00c9RICA 53 \n\n \n\n \n\nelegante no contexto do EbFVM pois vai na dire\u00e7\u00e3o da filosofia deste m\u00e9todo, que \u00e9 focar o \n\nc\u00e1lculo e o armazenamento de propriedades nos elementos da malha.  \n\n \n\n \n\n4.4. Refinamento Local \n \n\nRecomenda-se que em regi\u00f5es pr\u00f3ximas a po\u00e7os, em regi\u00f5es de grandes varia\u00e7\u00f5es do \n\ncampo de satura\u00e7\u00e3o e em regi\u00f5es de alta heterogeneidade se fa\u00e7a um refinamento local da \n\nmalha. O uso do refinamento local nessas regi\u00f5es reduz o tempo computacional, sendo \n\ncompar\u00e1vel ao das malhas grosseiras, apresentando resultados muito similares aos das malhas \n\ntotalmente refinadas. No m\u00e9todo proposto, a opera\u00e7\u00e3o de refinamento local \u00e9 feita de forma \n\nmuito simples, pois a ado\u00e7\u00e3o de um sistema de coordenadas locais permite um tratamento \n\nsimilar a todos os elementos da malha em um ambiente n\u00e3o-estruturado, o que facilita \n\nconcentrar um n\u00famero maior de n\u00f3s nas regi\u00f5es de interesse. \n\nA Fig. 4.8 mostra que o procedimento de refinar localmente determinadas regi\u00f5es da \n\nmalha pode ser feito facilmente, por exemplo, dividindo elementos quadril\u00e1teros dando \n\norigem a elementos triangulares em uma dada regi\u00e3o. Como visto, o refinamento local \u00e9, \n\nportanto, um procedimento natural e direto no m\u00e9todo proposto, n\u00e3o apresentando as \n\nimprecis\u00f5es num\u00e9ricas dos m\u00e9todos tradicionais que surgem em fun\u00e7\u00e3o da utiliza\u00e7\u00e3o de \n\nexpress\u00f5es aproximadas dos fluxos nas interfaces de blocos grosseiros e refinados \n\n(CORDAZZO et al., 2002).  \n\nConforme mencionado no in\u00edcio deste cap\u00edtulo, a utiliza\u00e7\u00e3o de elementos triangulares \n\ne quadrangulares resulta em ordens de interpola\u00e7\u00e3o diferentes - lineares e bi-lineares, \n\nrespectivamente. Pode-se valer disso a fim de obter uma solu\u00e7\u00e3o com maior precis\u00e3o, \n\nconcentrando-se elementos quadrangulares em uma determinada regi\u00e3o de interesse, ao inv\u00e9s \n\nde empregar tri\u00e2ngulos com uma mesma quantidade de n\u00f3s. A opera\u00e7\u00e3o de refinamento local, \n\nportanto, n\u00e3o est\u00e1 associada apenas ao processo de triangula\u00e7\u00e3o de determinadas regi\u00f5es, \n\ncomo poderia estar sendo sugerida pela ilustra\u00e7\u00e3o da Fig. 4.8. Deve-se salientar novamente, \n\nno entanto, que preencher uma regi\u00e3o com tri\u00e2ngulos parecer ser um procedimento mais \n\nsimples. \n\n \n\n\n\n54 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n \n\nFig. 4.8 - Exemplo do procedimento de refinamento local: (a) malha a ser refinada; (b) malha refinada \n\nlocalmente, e (c) destaque para alguns volumes de controle formados \n\n \n \n \n  \n\n \u00c9 importante destacar ainda que existem outras possibilidades promissoras de refinar \n\nlocalmente o dom\u00ednio no EbFVM e n\u00e3o exploradas nesta tese, como por exemplo, a que \n\nconsiste em utilizar elementos com n\u00famero vari\u00e1vel de n\u00f3s. No Anexo 1 s\u00e3o apresentadas as \n\npremissas desta t\u00e9cnica que utiliza-se de elementos quadril\u00e1teros que, devido a liberdade de \n\nassumir uma quantidade de n\u00f3s variando de 4 a 8 n\u00f3s, pode aumentar ainda mais a \n\nflexibilidade na discretiza\u00e7\u00e3o espacial, podendo ser uma outra op\u00e7\u00e3o na representa\u00e7\u00e3o de \n\nreservat\u00f3rios com falhas e com geometrias altamente complexas.  \n\n \n\n  \n\n\n\n55 \n\nCap.    \n\n5 \nFFOORRMMUULLAA\u00c7\u00c7\u00c3\u00c3OO  NNUUMM\u00c9\u00c9RRIICCAA  \nPPAARRTTEE  22  \u2013\u2013  CCOONNSSIIDDEERRAA\u00c7\u00c7\u00d5\u00d5EESS  FFIINNAAIISS  EE  \n\n                                                IIMMPPLLEEMMEENNTTAA\u00c7\u00c7\u00c3\u00c3OO  CCOOMMPPUUTTAACCIIOONNAALL  \n\n \n\n \n\n  \nA implementa\u00e7\u00e3o computacional das duas alternativas de solu\u00e7\u00e3o do sistema de \n\nequa\u00e7\u00f5es adotadas neste trabalho, bem como outras considera\u00e7\u00f5es sobre aspectos num\u00e9ricos, \n\ns\u00e3o os temas abordados neste cap\u00edtulo. O primeiro esquema de solu\u00e7\u00e3o utilizado foi o IMPES \n\n(Implicit Pressure, Explicit Saturation), em que o campo de press\u00e3o \u00e9 calculado \n\nimplicitamente (atrav\u00e9s da solu\u00e7\u00e3o de um sistema linear) e o campo de satura\u00e7\u00e3o obtido \n\nexplicitamente, utilizando os valores mais recentes do campo de press\u00e3o. \n\nO segundo esquema de solu\u00e7\u00e3o utilizado neste trabalho foi o Totalmente Impl\u00edcito. \n\nNeste caso, resolve-se um sistema linear maior que o resolvido no IMPES, mas que permite \n\navan\u00e7ar a solu\u00e7\u00e3o no tempo sem as excessivas restri\u00e7\u00f5es de passo de tempo inerentes \u00e0quele \n\nm\u00e9todo. \n\nDeve-se lembrar que as equa\u00e7\u00f5es do modelo bif\u00e1sico discretizadas e obtidas no \n\ncap\u00edtulo anterior s\u00e3o \n\n \n\n ( ) ( )\no\nmm\n\nmo m P im i Pm P PP P\n\nss tk pq S\nBB V\n\n?? ?\n?? ?\n\n? ? ? ? ?? ?? ?= + + ?? ? ? ? ? ? ?? ?? ? ? ?\n?           , m = w, o      (5.1)  \n\n   \n   \n\nElas formam um sistema de duas equa\u00e7\u00f5es e tr\u00eas inc\u00f3gnitas:  p, sw e so. A outra equa\u00e7\u00e3o \n\nnecess\u00e1ria para o fechamento do problema \u00e9 a de restri\u00e7\u00e3o volum\u00e9trica, dada por \n\n \n\n 1=+ ow ss  (5.2) \n \n\nA estrat\u00e9gia para a obten\u00e7\u00e3o da solu\u00e7\u00e3o deste sistema ser\u00e1 a mesma para ambos os \n\nesquemas, IMPES e Totalmente Impl\u00edcito, e consistir\u00e1 em obter a satura\u00e7\u00e3o do \u00f3leo atrav\u00e9s da \n\n\n\n56 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nequa\u00e7\u00e3o de restri\u00e7\u00e3o, Eq. (5.2), enquanto que a satura\u00e7\u00e3o da outra fase e a press\u00e3o ser\u00e3o \n\nobtidas atrav\u00e9s da resolu\u00e7\u00e3o do sistema de equa\u00e7\u00f5es composto pela equa\u00e7\u00e3o de conserva\u00e7\u00e3o \n\nda \u00e1gua, Eq. (5.1), e de uma combina\u00e7\u00e3o linear das equa\u00e7\u00f5es de conserva\u00e7\u00e3o de ambas as \n\nfases. Esta \u00faltima equa\u00e7\u00e3o \u00e9 a da conserva\u00e7\u00e3o total, e \u00e9 constru\u00edda substituindo as satura\u00e7\u00f5es \n\nexplicitadas em cada equa\u00e7\u00e3o de conserva\u00e7\u00e3o na equa\u00e7\u00e3o de restri\u00e7\u00e3o, resultando em \n\n \n\n \n( ) ( )( )\n\n                                           1 0\n\nP P oow w i w w o oi i P\ni P\n\no o\nw oP P\n\nw oo o\nw o P\n\nB B k p S q B q B\n\ns sV\nB B\n\nt B B\n\n? ? ? ?? ?\n\n?\n? ?\n\n+ ? ?? + + +\n\n? ??\n+ + ? =? ?? ? ?\n\n?\n (5.3)  \n\n \n\ncuja vari\u00e1vel principal \u00e9 a press\u00e3o. Por isso \u00e9 usualmente denominada de \u201cequa\u00e7\u00e3o da \n\npress\u00e3o\u201d. A outra equa\u00e7\u00e3o empregada neste sistema ser\u00e1 chamada de equa\u00e7\u00e3o da satura\u00e7\u00e3o. \n\nPor raz\u00f5es n\u00e3o discutidas neste trabalho, a equa\u00e7\u00e3o da press\u00e3o \u00e9 classificada como \n\nparab\u00f3lica quando o termos de compressibilidade s\u00e3o importantes, ou el\u00edptica nos outros \n\ncasos (PEACEMAN, 1977). A equa\u00e7\u00e3o da satura\u00e7\u00e3o, Eq. (5.1), por sua vez, \u00e9 considerada \n\nparab\u00f3lica quando os efeitos de press\u00e3o capilar s\u00e3o importantes. Na aus\u00eancia desses termos, a \n\nequa\u00e7\u00e3o da satura\u00e7\u00e3o \u00e9 classificada como hiperb\u00f3lica n\u00e3o-linear de 1\u00aa. ordem1. \n\nEm vez de empregar a equa\u00e7\u00e3o da press\u00e3o neste sistema, poderia ser utilizada \n\ndiretamente a outra equa\u00e7\u00e3o de conserva\u00e7\u00e3o ainda n\u00e3o empregada (a do \u00f3leo). Esta op\u00e7\u00e3o foi \n\ntestada neste trabalho, mas demonstrou-se n\u00e3o ser vi\u00e1vel porque dificulta a obten\u00e7\u00e3o de um \n\nsistema geral e poss\u00edvel de ser utilizado sem grandes altera\u00e7\u00f5es pelos m\u00e9todos analisados \n\nneste trabalho: IMPES e Totalmente Impl\u00edcito. Al\u00e9m disso, os testes preliminares com o \n\nm\u00e9todo Totalmente Impl\u00edcito demonstraram que a utiliza\u00e7\u00e3o da equa\u00e7\u00e3o da press\u00e3o neste \n\nsistema de equa\u00e7\u00f5es torna o m\u00e9todo num\u00e9rico mais est\u00e1vel. A raz\u00e3o pode ser o aumento da \n\ndomin\u00e2ncia diagonal na matriz de coeficientes, ocasionada pela exist\u00eancia de uma soma das \n\nmobilidades de cada fase multiplicando a press\u00e3o. \n\n \n\n \n\n \n\n                                                 \n1 Esta classifica\u00e7\u00e3o das equa\u00e7\u00f5es em el\u00edpticas, parab\u00f3licas ou hiperb\u00f3licas utilizando-se os coeficientes da \nequa\u00e7\u00e3o diferencial \u00e9 puramente matem\u00e1tica. H\u00e1 autores que afirmam que faz mais sentido apontar o car\u00e1ter das \nequa\u00e7\u00f5es em cada dire\u00e7\u00e3o coordenada, utilizando uma classifica\u00e7\u00e3o mista (PATANKAR, 1980; MALISKA, \n2004) n\u00e3o empregada neste trabalho. \n\n\n\n CAP. 5 \u2013 IMPLEMENTA\u00c7\u00c3O COMPUTACIONAL 57 \n\n \n\n \n\n5.1. M\u00e9todo IMPES \n \n\nComo mencionado, no m\u00e9todo IMPES o campo de press\u00e3o \u00e9 calculado implicitamente \n\n(atrav\u00e9s da solu\u00e7\u00e3o de um sistema linear) e o campo de satura\u00e7\u00e3o explicitamente, sendo o \n\ncampo de satura\u00e7\u00e3o atualizado a cada passo de tempo utilizando os valores mais recentes do \n\ncampo de press\u00e3o. \n\nPor\u00e9m ao examinar a Eq. (5.1) percebe-se uma n\u00e3o-linearidade no termo mm Bs  que \n\nimpede a utiliza\u00e7\u00e3o direta desta equa\u00e7\u00e3o na determina\u00e7\u00e3o da satura\u00e7\u00e3o, uma vez que ambos \n\nest\u00e3o sendo avaliados no mesmo intervalo de tempo. Deve-se lembrar que o fator volume de \n\nforma\u00e7\u00e3o normalmente \u00e9 calculado em fun\u00e7\u00e3o da press\u00e3o, em uma express\u00e3o que envolve um \n\ncoeficiente de compressibilidade (c) \n\n \n\n ( )\n?\n?\n?\n\n?\n\n?\n?\n?\n\n?\n?\n?\n??\n\n?\n? ??= refm\n\nref\nmm ppc1BpB  (5.4)  \n\n \n\nlogo, a n\u00e3o-linearidade se estabelece em fun\u00e7\u00e3o de que tanto a satura\u00e7\u00e3o como o fator volume \n\nde forma\u00e7\u00e3o s\u00e3o dependentes da press\u00e3o. Por isso \u00e9 necess\u00e1rio fazer uma modifica\u00e7\u00e3o nesta \n\nequa\u00e7\u00e3o de conserva\u00e7\u00e3o para que escoamentos com fluidos compress\u00edveis possam ser \n\nresolvidos com o m\u00e9todo IMPES. Note que para problemas incompress\u00edveis, 1== omm BB  na \n\nEq. (5.1), e a n\u00e3o-linearidade desaparece. Para contemplar os demais casos \u00e9 proposto neste \n\ntrabalho uma lineariza\u00e7\u00e3o do termo mm Bs  atrav\u00e9s do truncamento dos termos de mais alta \n\nordem da s\u00e9rie de Taylor \n\n \n\n ......+???\n?\n\n?\n??\n?\n\n?\n?\n\n?\n+???\n\n?\n\n?\n??\n?\n\n?\n?\n?\n\n+= m\nm\n\nm\n\nm\nm\n\nm\n\nm\n\nm\no\nm\n\no\nm\n\nm\n\nm B\nB\ns\n\nB\ns\n\nB\ns\n\nsB\ns\n\nB\ns\n\n (5.5) \n\n \n\nque, conforme demonstrado no Anexo 2, resulta em \n\n \n\n \n( )\n\n( )omrefm2o\nm\n\no\nm\n\no\nm\n\nm\n\nm\n\nm ppcB\nB\n\ns\nB\ns\n\nB\ns\n\n?+=  (5.6)  \n\n \n\nSubstituindo esta express\u00e3o na Eq. (5.1) e avaliando explicitamente ( 0? = ) os termos \n\nna equa\u00e7\u00e3o resultante que necessitam serem definidos quanto a que limites do intervalo de \n\n\n\n58 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\ntempo ser\u00e3o computados, origina-se a equa\u00e7\u00e3o denominada doravante neste trabalho de \n\nequa\u00e7\u00e3o da satura\u00e7\u00e3o do m\u00e9todo IMPES dada por \n\n \n\n ( )\n( )\n\n( ) ( )1\noref o\n\nm m oo m\nm mmm oP P ii Pm PP\n\np pB c Bs q k ps S t\nB V\n\n?\n?? ?\n\n? ?? ? ?? ?? ?? ?= ? + + ? ?? ?? ? ?? ? ? ?? ?? ?\n?  (5.7) \n\n \n\nSubstituindo a equa\u00e7\u00e3o da satura\u00e7\u00e3o de cada fase linearizada, Eq. (5.7), na equa\u00e7\u00e3o de \n\nrestri\u00e7\u00e3o volum\u00e9trica, Eq. (5.2), e agrupando os termos semelhantes, a equa\u00e7\u00e3o resultante, \n\ndenominada neste trabalho de equa\u00e7\u00e3o da press\u00e3o do m\u00e9todo IMPES, ser\u00e1 dada por \n\n \n\n( ) ( )( )\nP P\n\no o o o o o o o\nw w o o i w w o oi i P\n\ni P\nB B k p S q B q B? ?\n\n? ?\n\n+ ? ?? + + +?  \n \n\n                      1\u00aa. parcela                    2\u00aa. parcela               \n\n         (5.8) \n\n( )\n0\n\nt\nppV\n\nB\ncBs\n\nB\ncBs\n\nP\n\no\n\nP\no\no\n\no\nref\no\n\no\no\n\no\nw\n\nw\nref\nw\n\no\nw =??\n\n?\n\n?\n??\n?\n\n?\n?\n\n??\n??\n?\n\n?\n??\n?\n\n?\n++\n\n?\n            \n\n    \n          3\u00aa. parcela \n \n\nAs Eqs. (5.7) e (5.8) s\u00e3o as express\u00f5es linearizadas das Eqs. (5.1) e (5.3), \n\nrespectivamente. Para ser mais did\u00e1tico, neste texto foi escolhida apenas a implementa\u00e7\u00e3o \n\ncomputacional da equa\u00e7\u00e3o da press\u00e3o para ser explicada com mais detalhes na seq\u00fc\u00eancia, \n\nsendo a implementa\u00e7\u00e3o da satura\u00e7\u00e3o compreendida por analogia. \n\nO tratamento dado neste trabalho \u00e0 primeira parcela da Eq. (5.8) foi considerado no \n\ncap\u00edtulo anterior, onde foi demonstrado como o gradiente de press\u00e3o \u00e9 discretizado, como a \n\n\u00e1rea dos sub-volumes de controle \u00e9 calculada e como s\u00e3o avaliadas as mobilidades \n\ninterfaciais. Resta apresentar neste cap\u00edtulo como foi implementada computacionalmente esta \n\nparcela como um todo, utilizando o conceito de c\u00e1lculo elemento a elemento, al\u00e9m de \n\ndemonstrar como podem ser determinadas as 2\u00aa. e 3\u00aa. parcelas desta equa\u00e7\u00e3o.  \n\n\u00c9 importante mencionar que no IMPES as mobilidades e os fatores volume de \n\nforma\u00e7\u00e3o s\u00e3o calculados com os valores de press\u00e3o e satura\u00e7\u00e3o do n\u00edvel temporal anterior, \n\nn\u00e3o havendo a necessidade de um processo iterativo em cada n\u00edvel para obter a nova solu\u00e7\u00e3o. \n\n  \n\n\n\n CAP. 5 \u2013 IMPLEMENTA\u00c7\u00c3O COMPUTACIONAL 59 \n\n \n\n \n\n5.1.1. Forma\u00e7\u00e3o da Matriz de Coeficientes por Elementos \n\n  \n\nA filosofia do m\u00e9todo EbFVM proposto consiste em utilizar no c\u00e1lculo dos fluxos em \n\ncada um dos pontos de integra\u00e7\u00e3o a informa\u00e7\u00e3o armazenada naquele elemento da malha. Por \n\nisso a forma mais efetiva parece ser criar matrizes em cada elemento, computando as \n\ncontribui\u00e7\u00f5es de cada um, seguido de um procedimento de transfer\u00eancia de informa\u00e7\u00f5es, a \n\nfim de formar a matriz global de coeficientes.  \n\nUtilizando as defini\u00e7\u00f5es do gradiente de press\u00e3o e vetor \u00e1rea apresentados no cap\u00edtulo \n\nanterior, pode-se mostrar que a primeira parcela da equa\u00e7\u00e3o da press\u00e3o, que \u00e9 o termo de \n\nfluxo calculado em uma determinada interface de dois volumes de controle (em um ponto de \n\nintegra\u00e7\u00e3o), independentemente do tipo de elemento utilizado na malha, ser\u00e1 dada por \n\n  \n\n ( ) { } { }To Pi i eik p S ph H? ? ?? =  (5.9) \n \nonde { }TiH  \u00e9 um vetor composto pelos termos que dependem apenas da geometria e \n\npropriedades f\u00edsicas constantes de cada elemento definido na Eq. (4.32), { }ep  \u00e9 vetor do \nelemento com seus valores nodais da press\u00e3o, e hPi \u00e9 definido como \n\n \n ( ) ( ) ( ) ( ) iooPooiowPowiP BBh ?? +=  (5.10) \n \n\nonde na conven\u00e7\u00e3o adotada neste trabalho, os sub-\u00edndices \u201ci\u201d e \u201cP\u201d indicam que a \n\npropriedade \u00e9 avaliada no ponto de integra\u00e7\u00e3o e no n\u00f3, respectivamente. O super-\u00edndice \u201co\u201d, \n\npor sua vez, indica que s\u00e3o utilizados valores calculados no n\u00edvel de tempo anterior. A \n\naproxima\u00e7\u00e3o do termo de fluxo na equa\u00e7\u00e3o da satura\u00e7\u00e3o \u00e9 realizada seguindo um \n\nprocedimento semelhante ao apresentado para a equa\u00e7\u00e3o da press\u00e3o. Conforme pode ser visto \n\nna Fig. 5.1a, cada um dos sub-volumes de controle que formam um elemento, seja ele \n\ntriangular ou quadrangular, ter\u00e1 sempre duas interfaces internas com outros sub-volumes do \n\nmesmo elemento por onde o fluido escoar\u00e1. Desta forma, a integral de superf\u00edcie da Eq. (5.9) \n\ndever\u00e1 ser aproximada nestas duas superf\u00edcies internas, ou mais precisamente em dois pontos \n\nde integra\u00e7\u00e3o localizados no centro de cada superf\u00edcie dos sub-volumes de controle. \n\nConsiderando isso, o processo de forma\u00e7\u00e3o das matrizes dos elementos pode ser sistematizado \n\n(HURTADO, 2005), de forma que o fluxo que atravessa as interfaces de cada sub-volume de \n\ncontrole pode ser expresso como \n\n\n\n60 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n { } [ ] { }e eeq A p=  (5.11) \n \n\nonde \n\n [ ]\n{ } { }\n{ } { }\n{ } { }\n\n11 121 2\n\n22 232 3\n\n33 313 1\n\nT T\n\nT T\n\ne\nT T\n\nh hH H\n\nh hA H H\n\nh hH H\n\n? ??\n? ?\n? ?= ?\n? ?\n\n?? ?? ?\n\n                (3x3 - para elementos  triangulares)            \n\n \n\ne   (5.12)  \n \n\n[ ]\n\n{ } { }\n{ } { }\n{ } { }\n{ } { }\n\n11 121 2\n\n22 232 3\n\n33 343 4\n\n44 414 1\n\nT T\n\nT T\n\nT Te\n\nT T\n\nh hH H\n\nh hH H\nA\n\nh hH H\n\nh hH H\n\n? ??\n? ?\n? ??\n\n= ? ?\n?? ?\n\n? ?\n?? ?? ?\n\n                 (4x4 - para elementos quadrangulares)  \n\n \n\nA determina\u00e7\u00e3o das matrizes dos elementos seguindo o procedimento mencionado \n\npermite que a matriz global de coeficientes seja constru\u00edda elemento a elemento, transferindo \n\ncada valor destas matrizes para sua respectiva posi\u00e7\u00e3o na matriz global. Embora este \n\nprocedimento de forma\u00e7\u00e3o da matriz global seja trivial no M\u00e9todo dos Elementos Finitos, ele \n\nainda assim ser\u00e1 apresentado com mais detalhes na pr\u00f3xima se\u00e7\u00e3o porque esse conceito \u00e9 \n\nrelativamente novo no escopo dos M\u00e9todos de Volumes Finitos. \n\n \n\n5.1.2. Forma\u00e7\u00e3o da Matriz Global de Coeficientes \n\n \n\nA fim de ilustrar o procedimento de montagem da matriz global de coeficientes, a Fig. \n\n5.1a apresenta uma malha composta por dois elementos quadrangulares e tr\u00eas triangulares, \n\nque ser\u00e1 utilizada no processo de discretiza\u00e7\u00e3o no m\u00e9todo EbFVM. Cada um dos cinco \n\nelementos que comp\u00f5e esta malha fornece uma matriz de coeficientes, [ ] eA , que \u00e9 o resultado \nda aplica\u00e7\u00e3o da Eq. (5.9) em cada um dos pontos de integra\u00e7\u00e3o. A dimens\u00e3o da matriz local \n\nde coeficientes representa a quantidade de sub-volumes de controle dentro do elemento, sendo \n\nque para elementos triangulares esta matriz ter\u00e1 sempre dimens\u00f5es de 3 x 3, enquanto que \n\npara quadril\u00e1teros sua dimens\u00e3o ser\u00e1 de 4 x 4, conforme representado esquematicamente na \n\nFig. 5.1b.  \n\n\n\n CAP. 5 \u2013 IMPLEMENTA\u00c7\u00c3O COMPUTACIONAL 61 \n\n \n\n \n\n \n(a) Malha composta por 5 elementos e 8 n\u00f3s \n\n \n\n \n \n\n(b) Processo de forma\u00e7\u00e3o da matriz global de coeficientes \n \n\nFig. 5.1 - Ilustra\u00e7\u00e3o do processo de forma\u00e7\u00e3o da matriz global de coeficientes em esquemas baseados em \n\nelementos, como o m\u00e9todo EbFVM \n\n \n \n\nAp\u00f3s o processo de determina\u00e7\u00e3o das matrizes de coeficientes dos elementos, \n\nprocede-se a montagem da matriz global de coeficientes que receber\u00e1 as contribui\u00e7\u00f5es de \n\ntodos os elementos da malha, como demonstrado na Fig. 5.1b. Essa montagem \u00e9 realizada \n\nsimplesmente somando-se o coeficiente armazenado na matriz do elemento na sua posi\u00e7\u00e3o \n\ncorrespondente na matriz global. A contribui\u00e7\u00e3o de cada elemento \u00e9 mostrada nessa figura, \n\n\n\n62 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nsendo que a posi\u00e7\u00e3o dos coeficientes na matriz global \u00e9 determinada atrav\u00e9s das informa\u00e7\u00f5es \n\ncontidas em uma matriz fornecida pelo gerador de malhas. Nesse caso cada elemento \u00e9 \n\nidentificado e suas conectividades s\u00e3o definidas. O elemento 1 nesta figura, por exemplo, \u00e9 \n\nformado pelos n\u00f3s 1, 4 e 7, e por isso os valores contidos em sua matriz local dever\u00e3o ser \n\ntransportados para as posi\u00e7\u00f5es de intersec\u00e7\u00e3o das linhas e colunas correspondentes aos seus \n\nn\u00f3s, como demonstrado na Fig. 5.1b. Note que os diferentes tipos de elementos considerados  \n\n(tri\u00e2ngulos e quadril\u00e1teros) n\u00e3o implicam em nenhuma dificuldade adicional a este processo. \n\n\u00c9 importante notar tamb\u00e9m que apenas a 4\u00aa. linha e a 4\u00aa. coluna da matriz global de \n\ncoeficientes s\u00e3o cheias, e a raz\u00e3o \u00e9 que o volume de controle constru\u00eddo ao redor do n\u00f3 4 \u00e9 o \n\n\u00fanico que possui faces dentro de todos os elementos da malha, e por isso o c\u00e1lculo do fluxo \n\nem seus pontos de integra\u00e7\u00e3o envolve todos os n\u00f3s. Outras informa\u00e7\u00f5es relacionadas ao \n\nprocesso de forma\u00e7\u00e3o da matriz global de coeficientes podem ser obtidas na literatura de \n\nelementos finitos (HUGHES, 1987; ZIENKIEWICZ e TAYLOR, 1989; entre outros). \n\n \n \n\n5.1.3. Inser\u00e7\u00e3o das Informa\u00e7\u00f5es de Po\u00e7os na Matriz de Coeficientes e \nVetor de Termos Independentes \n\n \n\n Avan\u00e7ando na compreens\u00e3o de como cada uma das parcelas da equa\u00e7\u00e3o da press\u00e3o foi \n\nimplementada, resta considerar as duas \u00faltimas: termo de po\u00e7os (fonte) e transiente, que  s\u00e3o \n\ndeterminados por procedimentos que n\u00e3o necessitam percorrer os elementos, como foi o \n\nc\u00e1lculo dos termos de fluxo.  \n\nPara determinar os termos de po\u00e7os de inje\u00e7\u00e3o e produ\u00e7\u00e3o basta implementar uma \n\nrotina computacional que percorra apenas os volumes (n\u00f3s) que cont\u00eam po\u00e7os, calculando e \n\natualizando os coeficientes da matriz de coeficientes, [A], e o vetor de termos independentes, \n\n{ }F , na forma \n \n\n nnnnn gAA += ,,                        (5.13)  \n \n\ne \n\n nnn fFF +=                         (5.14)   \n  \n\n\n\n CAP. 5 \u2013 IMPLEMENTA\u00c7\u00c3O COMPUTACIONAL 63 \n\n \n\n \n\nonde n \u00e9 o n\u00f3 do volume de controle que cont\u00e9m o po\u00e7o, e ng  e nf  s\u00e3o termos dependentes \n\ndo modelo de po\u00e7o utilizado. Suas express\u00f5es mais comumente utilizadas s\u00e3o apresentadas no \n\nAnexo 3. \n\n \n\n5.1.4. Inser\u00e7\u00e3o do Termo Transiente na Matriz de Coeficientes e Vetor de \nTermos Independentes \n\n \n\n Quanto \u00e0 inser\u00e7\u00e3o do termo transiente na matriz global de coeficientes e no vetor de \n\ntermos independentes o procedimento tamb\u00e9m \u00e9 bastante trivial. Para tanto, basta fazer uma \n\nrotina computacional que percorra os n\u00f3s da malha, na forma \n\n \n\n PPPPP nAA += ,,    (5.15) \n \ne \n\n PPP eFF +=  (5.16)  \n \nonde P varia de 1 ao n\u00famero total de n\u00f3s da malha, e \n\n \n\n \no ref o ref\nw w w o o o P P\n\nP o o\nw o P\n\ns B c s B c V\nn\n\nB B t\n?? ? ?\n\n= ? +? ? ?? ?\n (5.17)  \n\n  \nP\n\no\n\nP\no\no\n\no\nref\no\n\no\no\n\no\nw\n\nw\nref\nw\n\no\nw\n\nP t\nVp\n\nB\ncBs\n\nB\ncBs\n\ne ??\n?\n\n?\n??\n?\n\n?\n?\n\n?\n??\n?\n\n?\n??\n?\n\n?\n+?=\n\n?\n (5.18)  \n\n \n\nonde PV?  \u00e9 o volume total do volume de controle constru\u00eddo ao redor do n\u00f3 P, que \u00e9 formado \n\npela uni\u00e3o de todos os sub-volumes pertencentes a diferentes elementos que compartilham um \n\nmesmo n\u00f3. Essa grandeza \u00e9 determinada no in\u00edcio do processo e apenas uma vez, percorrendo \n\ntodos os elementos, somando a contribui\u00e7\u00e3o de cada sub-volume de controle, svcV? , num \n\nprocedimento semelhante ao realizado para a montagem da matriz global de coeficientes \n\ndemonstrado na se\u00e7\u00e3o 5.1.2. \n\n  \n\nC\u00e1lculo do volume dos sub-volumes de controle. Para obter a express\u00e3o do svcV?   \u00e9 \n\nnecess\u00e1rio conhecer a express\u00e3o que calcula o volume do elemento (entidade definida pelos \n\nn\u00f3s da malha) dado por (ZIENKIEWICZ e TAYLOR, 1989; MALISKA, 2004) \n\n\n\n64 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n ??\n????\n\n????\n?\n\n?\n??\n?\n\n?\n?\n?\n\n?\n?\n\n?\n?\n?\n\n?\n?\n\n=?=?\nyxyx\n\n1SV ee .   (5.19) \n\n \n\nComparando esta express\u00e3o com a Eq. (4.19), constata-se que o termo entre par\u00eanteses \n\nna Eq. (5.19) \u00e9 exatamente o determinante da matriz Jacobiana. E como \u00e9 comum usar ??  e \n\n??  unit\u00e1rios por simplicidade, pois os mesmos s\u00e3o arbitr\u00e1rios, \u00e9 f\u00e1cil demonstrar que os \n\nvolumes de cada um dos sub-volumes de controle, svcV? , s\u00e3o dados por \n\n \n\n 6JVsvc ][det=?                                   (para elementos  triangulares) (5.20)   \n \n\n \nmmsvc\n\nJV ?? ,][det=?                              (para elementos quadrangulares)  (5.21) \n \n\nonde m  \u00e9 o ponto m\u00e9dio do sub-volume de controle onde \u00e9 avaliada a express\u00e3o do \n\ndeterminante. Para o sub-volume de controle 1 do elemento quadril\u00e1tero da Fig. 4.3, por \n\nexemplo, o ponto m\u00e9dio ser\u00e1 dado por (? m  = + \u00bd, ? m  = + \u00bd).  No caso de elementos \n\ntriangulares, o determinante da matriz Jacobiana resulta em um valor constante, por isso n\u00e3o \u00e9 \n\nnecess\u00e1rio avali\u00e1-lo em nenhum ponto dentro do elemento.  \n\n \n\n5.1.5. Sistema Linear Resultante \n \n\nDepois de receber as contribui\u00e7\u00f5es de todos os elementos e inserir as condi\u00e7\u00f5es de \n\ncontorno (informa\u00e7\u00f5es de po\u00e7os) e termo transiente na matriz global e no vetor de termos \n\nindependentes, o sistema de equa\u00e7\u00f5es final est\u00e1 completo e \u00e9 dado por \n \n\n [ ]{ } { }FpA =  (5.22)  \n \n\nA solu\u00e7\u00e3o da Eq. (5.22) \u00e9 inserida na Eq. (5.7) para obter o campo de satura\u00e7\u00e3o de \n\numa das fases. O campo de satura\u00e7\u00e3o da outra fase, por sua vez, \u00e9 obtido por meio da equa\u00e7\u00e3o \n\nde restri\u00e7\u00e3o, Eq. (5.2). Quanto ao tratamento dado aos termos da equa\u00e7\u00e3o da satura\u00e7\u00e3o, \n\nembora n\u00e3o discutido aqui, segue o mesmo princ\u00edpio de discretiza\u00e7\u00e3o e implementa\u00e7\u00e3o \n\napresentado para a equa\u00e7\u00e3o da press\u00e3o. \n\n\n\n CAP. 5 \u2013 IMPLEMENTA\u00c7\u00c3O COMPUTACIONAL 65 \n\n \n\n \n\nEm casos onde \u00e9 necess\u00e1rio prescrever valores de press\u00e3o no dom\u00ednio, o sistema linear \n\nda Eq. (5.22) deve ser alterado, e o procedimento empregado neste trabalho est\u00e1 apresentado \n\nno Anexo 3. \n\n \n\n5.1.6. Determina\u00e7\u00e3o do Passo de Tempo \n\n \nA escolha do passo de tempo, t? , utilizado no termo transiente das equa\u00e7\u00f5es de \n\nconserva\u00e7\u00e3o \u00e9 crucial no m\u00e9todo IMPES. Como o campo de satura\u00e7\u00e3o \u00e9 resolvido \n\nexplicitamente neste m\u00e9todo, surgem instabilidades num\u00e9ricas nos resultados quando avan\u00e7a-\n\nse no tempo com intervalos muito grandes. \n\n Pode-se determinar uma express\u00e3o que estima o passo de tempo m\u00e1ximo que garante \n\na estabilidade num\u00e9rica para o IMPES baseando-se no fato de que uma frente de satura\u00e7\u00e3o \n\nn\u00e3o pode atravessar mais de um volume de controle inteiro em apenas um passo de tempo \n\n(AZIZ e SETTARI, 1979; MATTAX e DALTON, 1990), \n \n\n \n( )max '\n\nmax\nmin\n\n1P\ni w P\n\ni P P\n\nV\nt\n\nq f\n?\n\n? ? ?\n\n? ? ? ??? ? ? ?? ? ? ? ? ?? ? ? ?? ?\n?\n\n (5.23)   \n\n \n\nonde pV?  \u00e9 o volume poroso dos volumes de controle, iq  \u00e9 o fluxo total na face i do sub-\n\nvolume de controle, e ( )'w\nm\u00e1x\n\nf  \u00e9 o valor m\u00e1ximo da derivada da curva de fluxo fracion\u00e1rio2 da \n\n\u00e1gua avaliado nos n\u00f3s da malha.  \n\n \n\n \n\n \n\n5.2. M\u00e9todo Totalmente Impl\u00edcito \n \nA simula\u00e7\u00e3o de reservat\u00f3rios de petr\u00f3leo com grande n\u00famero de elementos torna-se \n\ndif\u00edcil atrav\u00e9s do IMPES, devido \u00e0s restri\u00e7\u00f5es impostas no tamanho do passo de tempo, \n\nporque para manter a estabilidade ele torna-se excessivamente pequeno. Nestes casos, a \n\nalternativa mais vi\u00e1vel \u00e9 a solu\u00e7\u00e3o impl\u00edcita das equa\u00e7\u00f5es atrav\u00e9s do m\u00e9todo de Newton, que \n\n                                                 \n2 O fluxo fracion\u00e1rio de uma fase \u00e9 a raz\u00e3o entre a mobilidade desta fase e a mobilidade total. \n\n\n\n66 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n\u00e9 o mais conhecido e estudado m\u00e9todo de solu\u00e7\u00e3o de sistemas de equa\u00e7\u00f5es n\u00e3o-lineares \n\n(RUGGIERO e LOPES, 1997), e que permite obter a solu\u00e7\u00e3o simult\u00e2nea do campo de press\u00e3o \n\ne satura\u00e7\u00e3o.  \n\n Para usar o m\u00e9todo de Newton, escrevem-se as equa\u00e7\u00f5es na sua forma residual. A \n\nequa\u00e7\u00e3o discretizada da conserva\u00e7\u00e3o, Eq. (5.1) \u00e9 avaliada implicitamente ( 1? = ), e escrita \n\npara a fase \u00e1gua, por exemplo, como \n\n \n\n ( ) ( )( )\no\n\nw wP P\nw w i woP P\n\ni Pw w P\n\ns sV\nR k p S q\n\nt B B\n?\n\n?\n? ?\n\n? ??? ?= ? ? + ? ?? +? ?? ??? ?? ?\n?  (5.24) \n\n \n\nenquanto que a equa\u00e7\u00e3o da press\u00e3o, Eq. (5.3), \u00e9 escrita como \n\n \n\n \n( ) ( ) ( )( )\n\n                                                            1\n\nP P ooT w w i w w o oP i i P\ni P\n\no o\nw oP P\n\nw oo o\nw o P\n\nR B B k p S q B q B\n\ns sV\nB B\n\nt B B\n\n? ?\n\n?\n? ?\n\n= + ? ?? + +\n\n? ??\n+ + ?? ?? ? ?\n\n?\n (5.25)  \n\n \nonde wR  e TR  s\u00e3o os res\u00edduos das equa\u00e7\u00f5es de conserva\u00e7\u00e3o da fase \u00e1gua e da conserva\u00e7\u00e3o \n\ntotal. O objetivo deste m\u00e9todo \u00e9 que estes res\u00edduos, calculados em todos os  volumes de \n\ncontrole, sejam reduzidos a um valor suficientemente pequeno em cada intervalo de tempo. \n\n \n\n5.2.1. Sistema Linear Resultante \n\n \n A fundamenta\u00e7\u00e3o te\u00f3rica que justifica a forma final do sistema linear resultante \n\nquando se utiliza o M\u00e9todo de Newton pode ser resumida em tr\u00eas passos b\u00e1sicos: \n\n \n\n1. Expans\u00e3o do res\u00edduo de uma determinada equa\u00e7\u00e3o em s\u00e9rie de Taylor desprezando \n\nos termos de maior ordem: \n\n \n\n 1 1\nX\n\nR\nR R X\n\nX\n\n?\n? ? ?+ +\n\n?\n\n?? ?= + ?? ??? ?\n?  (5.26)   \n\n \n\nonde ?  \u00e9 o n\u00edvel iterativo, X representa o vetor de inc\u00f3gnitas (p e sw) envolvidas com a \n\nrespectiva equa\u00e7\u00e3o de res\u00edduo, e 1 1X X X? ? ?+ +? = ? .  \n\n\n\n CAP. 5 \u2013 IMPLEMENTA\u00c7\u00c3O COMPUTACIONAL 67 \n\n \n\n \n\n2. Tornar nulo o res\u00edduo da itera\u00e7\u00e3o ? +1: \n\n \n\n 1mm\nX\n\nR\nR X\n\nX\n\n?\n? ? +\n\n?\n\n?? ?? = ?? ??? ?\n?  (5.27)  \n\n \n\n3. Aplicar a equa\u00e7\u00e3o anterior escrita para todos os volumes de controle, obtendo o \n\nseguinte sistema linear: \n\n \n\n [ ]{ } { }A X R? = ?                               (5.28)                \n \n\nonde A \u00e9 a matriz Jacobiana. No sistema bif\u00e1sico adotado, esse sistema matricial \u00e9 formado a \n\npartir de matrizes de 2x2, doravante chamadas de blocos, apresentando duas inc\u00f3gnitas para \n\ncada n\u00f3, e tem a forma \n\n \n\n \n\n1 1 1 1\n\n1 1 1 1\n\n1 1\n\n1 1\n\n1 1\n\n1 1\n\nn n n n\n\nn n n n\n\nT T T T\n\nw n wn\n\nw w w w\n\nw n wn\n\nT T T T\n\nw n wn\n\nw w w w\n\nw n wn\n\nR R R R\np s p s\n\nR R R R\np s p s\n\nR R R R\np s p s\n\nR R R R\np s p s\n\n? ? ? ?? ?? ? ? ?\n? ?? ? ? ?? ? ? ?? ?? ? ? ?\n? ? ? ? ?? ? ? ?? ? ? ? ?\n? ? ? ? ?? ? ? ?? ? ? ?\n?\n?\n? ? ? ? ?? ? ? ?\n?? ? ? ?? ? ? ??? ? ? ?\n?? ? ? ?? ? ? ??? ? ? ??? ? ? ?? ? ? ?? ? ? ?? ?\n\n\u2026\n1\n\n1\n\n1\n\n1\n\nn\n\nn\n\nT\n\nww\n\nn T\n\nwn w\n\nRp\nRs\n\np R\ns R\n\n? ? ?? ?? ? ? ? ?? ?? ? ?? ?? ?? ??? ? ?? ?? ? ? ?? ?\n? ? ? ?? = ?? ? ? ??\n? ? ? ?? ?? ? ? ?? ?? ? ? ?? ? ? ? ?? ? ? ??? ? ?? ? ? ?? ?? ??\n?\n?\n\n (5.29) \n\n \n \n\nOs campos de press\u00e3o e satura\u00e7\u00e3o s\u00e3o atualizados a cada itera\u00e7\u00e3o a partir de \n\n \n\n { } { } { }1 1p p p? ? ?+ += + ?       e       { } { } { }1 1w w ws s s\n? ? ?+ +\n\n= + ?  (5.30)          \n \n\ne atrav\u00e9s da equa\u00e7\u00e3o da restri\u00e7\u00e3o obt\u00e9m-se a satura\u00e7\u00e3o do \u00f3leo. Devido \u00e0s n\u00e3o-linearidades \n\npresentes nas equa\u00e7\u00f5es governantes, deve-se iterar um n\u00famero suficiente de vezes em cada \n\npasso de tempo, evoluindo os valores de p e sw, recalculando a matriz [A] e o vetor {R}, e \n\nresolvendo o sistema linear resultante at\u00e9 que se obtenha res\u00edduos suficientemente pequenos. \n\nEm compara\u00e7\u00e3o com o IMPES, o custo computacional da solu\u00e7\u00e3o de cada n\u00edvel \n\ntemporal \u00e9 maior neste m\u00e9todo, pois \u00e9 resolvido v\u00e1rias vezes, neste caso, uma matriz com o \n\n\n\n68 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\ndobro do tamanho da matriz obtida no IMPES. Mas esse esfor\u00e7o \u00e9 freq\u00fcentemente \n\ncompensado pela possibilidade de avan\u00e7ar a solu\u00e7\u00e3o com passos de tempo maiores.  \n\nNa seq\u00fc\u00eancia, s\u00e3o apresentados os procedimentos computacionais utilizados para a \n\ndetermina\u00e7\u00e3o do vetor de res\u00edduos e da matriz Jacobiana da Eq. (5.29), al\u00e9m de serem \n\ndiscutidos outros aspectos importantes no M\u00e9todo de Newton. Aqui tamb\u00e9m ser\u00e1 considerada \n\napenas a implementa\u00e7\u00e3o computacional da equa\u00e7\u00e3o da press\u00e3o, sendo a implementa\u00e7\u00e3o da \n\nsatura\u00e7\u00e3o3 compreendida por analogia.  \n\n  \n\n5.2.2. C\u00e1lculo dos Res\u00edduos \n\n \n Para facilitar a implementa\u00e7\u00e3o computacional, a forma residual da equa\u00e7\u00e3o da press\u00e3o, \n\nEq. (5.25), ser\u00e1 escrita como uma soma de tr\u00eas parcelas: a de acumula\u00e7\u00e3o, a dos fluxos entre \n\nvolumes de controle e a de po\u00e7os \n\n \n\n { } { } { } { }T T T Tacum fluxos po\u00e7osR R R R= + +                       (5.31) \n \n\nonde \n\n 1\no o\nw oP P\n\nT w oo oacum\nw o P\n\ns sV\nR B B\n\nt B B\n? ? ??\n\n= + ?? ?? ? ?\n (5.32)   \n\n \n\n ( ) ( )\nP P ooT w w ifluxos i i\n\ni P\nR B B k p S? ?\n\n? ?\n\n= + ? ???  (5.33)  \n \n\n ( )T w w o opo\u00e7os PR q B q B= +  (5.34) \n \n\nA forma de representar a equa\u00e7\u00e3o do res\u00edduo dada pela Eq. (5.31) \u00e9 mais conveniente \n\nporque torna o c\u00e1lculo de cada um dos componentes do res\u00edduo independente dos demais, \n\nseguindo procedimentos particulares e mais apropriados. O res\u00edduo do termo de acumula\u00e7\u00e3o \n\ndefinido na Eq. (5.32), por exemplo, deve ser calculado em uma rotina que varre todos os n\u00f3s \n\nda malha. O res\u00edduo do termo de fluxo, Eq. (5.33), deve ser calculado visitando elemento a \n\nelemento da malha, enquanto que o res\u00edduo do termo de po\u00e7os, Eq. (5.34), \u00e9 calculado \n\nsegundo uma rotina que varre apenas os n\u00f3s referentes aos volumes de controle que possuem \n                                                 \n3  Trata-se de um artif\u00edcio did\u00e1tico nomear uma equa\u00e7\u00e3o como sendo a da press\u00e3o e a outra da satura\u00e7\u00e3o no \nM\u00e9todo Totalmente Impl\u00edcito, porque ambas as vari\u00e1veis est\u00e3o ativas, diretamente ou n\u00e3o, nas duas equa\u00e7\u00f5es. \n\n\n\n CAP. 5 \u2013 IMPLEMENTA\u00c7\u00c3O COMPUTACIONAL 69 \n\n \n\n \n\npo\u00e7os. No Anexo 3 s\u00e3o apresentadas as express\u00f5es dos fluxos da Eq. (5.34) mais comumente \n\nutilizadas como condi\u00e7\u00e3o de contorno nos po\u00e7os.  \n\nConforme foi visto anteriormente, cada um dos sub-volumes de controle que formam  \n\num elemento, seja ele triangular ou quadril\u00e1tero, ter\u00e1 sempre duas interfaces internas com \n\noutros sub-volumes do mesmo elemento por onde o fluido escoar\u00e1. Logo, a Eq. (5.33) pode \n\nser calculada elemento a elemento utilizando a seguinte express\u00e3o \n\n \n\n \n{ } { } { }\n\n,\n\n( )( )\n\n           \n\nP P ooT w w nfluxos n n\nn P i j\n\nT T\nPi Pji j\n\nR B B k p S\n\nh H h H p\n\n? ?\n? =\n\n= + ? ??\n\n? ?= ?? ?\n\n?\n (5.35) \n\n \n\nonde os sub-\u00edndices i e j s\u00e3o os pontos de integra\u00e7\u00e3o localizados nas duas faces internas dos \n\nsub-volumes de controle, e os termos { }iH  e Pih  s\u00e3o dados pela Eq. (4.32) e pela vers\u00e3o \nimpl\u00edcita da Eq. (5.10), respectivamente. A Eq. (5.35) representa a contribui\u00e7\u00e3o de um sub-\n\nvolume de controle i para o c\u00e1lculo do res\u00edduo do termo de fluxo em um volume de controle \n\ncompleto.  \n\nVisando utilizar uma estrutura que possibilite uma implementa\u00e7\u00e3o mais geral \n\nmediante a constru\u00e7\u00e3o de uma matriz no elemento, os sub-\u00edndices i e j devem ser definidos \n\ncomo \n\n \n\n \n=  numera\u00e7\u00e3o local do sub-volume de controle analisado, = 1, ..., \n\n +1      se        ou    = 1    se    \ni i NNE\nj = i i NNE j i = NNE\n\n?\n?\n\n??\n      (5.36)  \n\n \n\nonde NNE j\u00e1 foi definido no cap\u00edtulo anterior e representa o n\u00famero de n\u00f3s do elemento. \n\n Valendo-se da estruturada computacional j\u00e1 utilizada no IMPES, o vetor de termos \n\nindependentes do res\u00edduo de cada equa\u00e7\u00e3o pode ser calculado como \n\n \n\n { } [ ]{ } { } { }T T T Tacum po\u00e7osR A p R R= ? +       (5.37)  \n \n\nonde { }p  \u00e9 o vetor global dos valores de press\u00e3o e [ ]TA  \u00e9 a matriz global formada elemento a \nelemento pela contribui\u00e7\u00e3o das matrizes locais definidas na Eq. (5.12).    \n\n \n\n \n\n\n\n70 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n5.2.3. C\u00e1lculo das Derivadas dos Res\u00edduos \n\n \nAs derivadas dos res\u00edduos em rela\u00e7\u00e3o a press\u00e3o e satura\u00e7\u00e3o de \u00e1gua apresentadas na \n\nEq. (5.29) podem ser determinadas anal\u00edtica ou numericamente. Neste trabalho optou-se por \n\nutilizar express\u00f5es anal\u00edticas por produzirem uma matriz Jacobiana exata, portanto, de melhor \n\nqualidade para converg\u00eancia, e por serem facilmente deduzidas a partir das equa\u00e7\u00f5es \n\ndiscretizadas neste trabalho4. Embora sejam apresentados procedimentos particulares \n\ndesenvolvidos nesta tese para aplica\u00e7\u00e3o em malhas n\u00e3o-estruturadas, o processo de forma\u00e7\u00e3o \n\nda matriz Jacobiana \u00e9 basicamente o mesmo utilizado pelos simuladores em geral, por isso o \n\nleitor familiarizado com esse processo  poder\u00e1 ir diretamente para a pr\u00f3xima se\u00e7\u00e3o (5.2.4) que \n\ntrata dos crit\u00e9rios de converg\u00eancia e c\u00e1lculo do passo de tempo. \n\n \n\nTermos de Acumula\u00e7\u00e3o. As derivadas do termo de acumula\u00e7\u00e3o da equa\u00e7\u00e3o do \n\nres\u00edduo, Eq. (5.32), em rela\u00e7\u00e3o a press\u00e3o s\u00e3o dadas por \n\n \n\n \no o\nw w o oT P P\no o\nw oacum P\n\ns dB s dBR V\np t B dp B dp\n\n? ? ?? ?\n= +? ?? ? ? ?\n\n                    (5.38)  \n\n \n\ne em rela\u00e7\u00e3o a satura\u00e7\u00e3o s\u00e3o nulas \n\n \n\n 0T\nw acum\n\nR\ns\n\n?\n=\n\n?\n (5.39) \n\n \n\nTermos de po\u00e7os. As derivadas dos termos de po\u00e7os, Eq. (5.34), s\u00f3 n\u00e3o ser\u00e3o nulas \n\npara a condi\u00e7\u00e3o de contorno de press\u00e3o de fundo de po\u00e7o prescrita, que para os po\u00e7os \n\nprodutores \u00e9 escrita como \n\n \n\n ( )m m fpq WI p p?= ?   (5.40)   \n \n\n                                                 \n4 Mesmo em casos onde \u00e9 poss\u00edvel encontrar a derivada anal\u00edtica das equa\u00e7\u00f5es dos res\u00edduos, \u00e9 prefer\u00edvel em \ndeterminadas situa\u00e7\u00f5es calcular as derivadas numericamente criando um procedimento mais geral, facilitando a \ntroca de equa\u00e7\u00f5es constitutivas, de equa\u00e7\u00f5es de estado, entre outras. Nestes casos, e em algumas situa\u00e7\u00f5es onde \nn\u00e3o \u00e9 poss\u00edvel encontrar as derivadas anal\u00edticas de todos os termos, utiliza-se a aproxima\u00e7\u00e3o num\u00e9rica das \nderivadas, que consiste simplesmente em calcular a fun\u00e7\u00e3o com um valor \u201cperturbado\u201d, subtrair desta a fun\u00e7\u00e3o \ncalculada sem a perturba\u00e7\u00e3o e dividir o resultado pelo valor da perturba\u00e7\u00e3o. \n\n\n\n CAP. 5 \u2013 IMPLEMENTA\u00c7\u00c3O COMPUTACIONAL 71 \n\n \n\n \n\nonde fpp  \u00e9 a press\u00e3o de fundo de po\u00e7o e WI \u00e9 o \u00edndice de po\u00e7o que compreende fatores f\u00edsicos \n\ne geom\u00e9tricos do po\u00e7o. Quando essa condi\u00e7\u00e3o \u00e9 prescrita, as derivadas dos termos de po\u00e7os \n\nda equa\u00e7\u00e3o da press\u00e3o s\u00e3o dadas por \n\n \n\n ( )\n,\n\nm mT\nm m m m fp\n\nm w opo\u00e7os\n\nBR\nWI B B p p\n\np p p\n?\n\n? ?\n=\n\n? ?? ?? ??\n= ? + + ?? ?? ?? ? ?? ?? ?\n\n?  (5.41)  \n\ne  \n\n ( )\n,\n\nmT\nm fp\n\nm w ow wpo\u00e7os\n\nR\nWI B p p\n\ns s\n?\n\n=\n\n??\n= ? ?\n\n? ??  (5.42)  \n\n \n\nNo Anexo 3 podem ser obtidos maiores detalhes sobre esta condi\u00e7\u00e3o de po\u00e7o e outras \n\nn\u00e3o mencionadas. \n\n  \n\nTermos de fluxo. As derivadas dos termos de fluxo em rela\u00e7\u00e3o a satura\u00e7\u00e3o, Eq. (5.33), \n\ns\u00e3o calculadas a partir de \n\n \n\n { } { } { }( )\nk k\n\nT TT\nPi Pji j\n\nw wfluxos\n\nR\nh H h H p\n\ns s\n? ? ? ?= ?? ?? ?\n\n                      \n\n  \n\n                  \n( ) ( ) ( ) ( )( )\n\n( ) ( ) ( ) ( )( )\n\n1 1 ....\n\n             1 1 ....\nk\n\nPi i i\nw\n\nPj j j\n\nh H p H NNE p NNE\ns\n\nh H p H NNE p NNE\n\n?\n?= + + +??\n\n?? + + ?\n\n     (5.43)  \n\n   \n\n                           { } { } { } { }\nk k\n\nT TPjPi\ni j\n\nw w\n\nhh\nH p H p\n\ns s\n??\n\n= ?\n? ?\n\n  \n\n \n\nonde k = 1, ..., NNE para cada sub-volume de controle, com i e j sendo pontos de integra\u00e7\u00e3o \n\ndefinidos com i = 1, ..., NNE e  j = i +1 se i &lt;NNE ou  j = 1 se  i = NNE. Logo, esse termo \n\nresulta num vetor de dimens\u00f5es NNE para cada sub-volume de controle, que \u00e9 a contribui\u00e7\u00e3o \n\nde um sub-volume de controle no c\u00e1lculo deste res\u00edduo para o volume que o cont\u00e9m. Cada \n\nderivada presente nesta express\u00e3o \u00e9 determinada a partir de \n\n \n\n ( ) ( )\nk k k\n\ni i\n\nPi w o\nw oP P\n\nw w wip ip\n\nh\nB B\n\ns s s\n? ?? ? ? ?? ? ?\n\n= +? ? ? ?? ? ? ?? ? ?? ? ? ?\n  (5.44) \n\n\n\n72 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nContudo, deve-se observar que em fun\u00e7\u00e3o da avalia\u00e7\u00e3o \u00e0 montante do termo de \n\nmobilidade discutida no cap\u00edtulo anterior, as derivadas em rela\u00e7\u00e3o \u00e0 satura\u00e7\u00e3o da equa\u00e7\u00e3o \n\nanterior s\u00f3 n\u00e3o ser\u00e3o nulas se o n\u00f3 a montante deste ponto de integra\u00e7\u00e3o for o pr\u00f3prio n\u00f3 k, \n\nisto \u00e9, \n\n \n\n0           se  n\u00f3 \u00e0 montante  no ponto de integra\u00e7\u00e3o = \nk\n\ni\n\nm\n\nw ip\n\nk  i\ns\n??\n\n= ?\n?\n\n   \n\n \n\nJ\u00e1 as derivadas dos res\u00edduos do termo de fluxo em rela\u00e7\u00e3o a press\u00e3o ser\u00e3o calculadas a \n\npartir de  \n\n            \n\n { } { } { }( )T TT Pi Pji j\nk kfluxos\n\nR\nh H h H p\n\np p\n? ? ? ?= ?? ?? ?\n\n \n\n \n\n                  \n( ) ( ) ( ) ( )( )\n\n( ) ( ) ( ) ( )( )\n\n1 1 ....\n\n             1 1 ....\n\nPi i i\nk\n\nPj j j\n\nh H p H NNE p NNE\np\n\nh H p H NNE p NNE\n\n?\n?= + + +??\n\n?? + + ?\n\n        (5.45) \n\n \n\n                { } { } { } { } ( ) ( )( )T TPjPi Pi i Pj ji j\nk k\n\nhh\nH p H p h H k h H k\n\np p\n?? ??\n\n= ? + ?? ?? ?? ?\n     \n\n             \n \n\nCada derivada presente nesta express\u00e3o \u00e9 determinada a partir de \n \n\n      \n\n ( ) ( )\n,\n\ni\n\ni\n\nPi m m\nm mip P\n\nm w ok k kP ip\n\nh dB\nB\n\np dp p\n?\n\n?\n=\n\n? ?? ? ? ?? ?\n? ?= +? ? ? ?? ?? ?? ? ? ?? ?\n\n?  (5.46) \n\n                         \nque utiliza as mesmas defini\u00e7\u00f5es dos sub-\u00edndices i, j e k da derivada do res\u00edduo deduzida \n\nanteriormente. E como antes tamb\u00e9m, a derivada avaliada no ponto de integra\u00e7\u00e3o poder\u00e1 ser \n\nnula dependendo do n\u00f3 localizado \u00e0 montante \n\n \n\n0          se  n\u00f3 \u00e0 montante  no ponto de integra\u00e7\u00e3o = \ni\n\nm\n\nk ip\n\nk  i\np\n??\n\n= ?\n?\n\n   \n\n \n\n\n\n CAP. 5 \u2013 IMPLEMENTA\u00c7\u00c3O COMPUTACIONAL 73 \n\n \n\n \n\n As derivadas do termo de fluxo do res\u00edduo foram implementadas nesse trabalho \n\ndefinindo-se uma matriz do elemento que tem a forma \n\n \n\n \n1\n\n1\n\n1\n\nsvc\n\nsvcNNE\n\nT T\n\nNNE\n\nT\n\nfluxos e\nT T\n\nNNE\ne\n\nR R\nX X\n\nR\nX\n\nR R\nX X\n\n? ?? ? ??\n? ??? ? ?? ?? ?\n\n? ?? ? ?\n=? ? ? ??? ?? ? ? ?? ? ??\n? ??? ? ?? ?? ?? ?\n\n\u2026\n\n (5.47)  \n\n \n\nonde X representa as vari\u00e1veis dependentes do problema, p e sw, e cada linha apresenta a \n\nequa\u00e7\u00e3o de conserva\u00e7\u00e3o de um dos sub-volumes que comp\u00f5e o elemento. Essa matriz pode \n\nser decomposta em duas partes, \n\n \n\n \nA B\n\nT T T\n\nfluxos fluxos fluxose e e\n\nR R R\nX X X\n\n? ? ? ? ? ?? ? ?\n= +? ? ? ? ? ?\n\n? ? ?? ? ? ? ? ?? ? ? ? ? ?\n (5.48)  \n\n \n \n\n                                              1\u00aa. parcela      2\u00aa. parcela  \n \n\nDetermina\u00e7\u00e3o da 1\u00aa. Parcela da Eq. (5.48): Esta parcela representa a deriva\u00e7\u00e3o da \n\nmobilidade presente nas Eqs. (5.43) e (5.45) em rela\u00e7\u00e3o as vari\u00e1veis dependentes, mantendo a \n\npress\u00e3o constante. Ela \u00e9 uma matriz que \u00e9 escrita para elementos triangulares com dimens\u00e3o \n\nde (3x3): \n\n \n\n \n( ) ( )\n( ) ( )\n( ) ( )\n\n* *\n1 2\n* *\n2 3\n* *\n3 1\n\n1, 2,\n2, 3,\n3, 1,\n\nA X X\nT\n\nX X\nfluxos e\n\nX X e\n\nD k H D k H\nR\n\nD k H D k H\nX\n\nD k H D k H\n\n? ??\n? ?? ? ?\n\n= ?? ? ? ??? ?? ? ? ??? ?\n\n        k = 1, 2, 3 (5.49)  \n\n \ne para elementos quadrangulares com dimens\u00e3o de (4x4): \n    \n\n \n\n( ) ( )\n( ) ( )\n( ) ( )\n( ) ( )\n\n* *\n1 2\n* *\n2 3\n* *\n3 4\n* *\n4 1\n\n1, 2,\n2, 3,\n3, 4,\n4, 1,\n\nX X\nA\n\nX XT\n\nfluxos X Xe\n\nX X e\n\nD k H D k H\nD k H D k HR\nD k H D k HX\nD k H D k H\n\n? ??\n? ?? ? ?? ? ?=? ? ? ???? ?? ? ? ?\n\n?? ?? ?\n\n          k = 1, 2, 3, 4  (5.50) \n\n \n\n\n\n74 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nonde { } { }* Ti iH H p=  e a matriz de derivadas [ ]XD  \u00e9 definida em cada elemento como \n \n\n [ ]\n( ) ( ) ( )\n\n( ) ( ) ( )\n( ) ( ) ( )\n\n1 1,1 0 1, 3\n2,1 2 2, 2 0\n\n0 3, 2 3 3, 3\n\nB\nX X X\n\nB\nX X X Xe\n\nB\nX X X e\n\nD D D\nD D D D\n\nD D D\n\n? ?\n\n? ?\n\n? ?\n\n? ?+\n? ?= +? ?\n? ?+? ?\n\n (5.51)             \n\n \n\npara elementos  triangulares e \n    \n\n[ ]\n\n( ) ( ) ( )\n( ) ( ) ( )\n\n( ) ( ) ( )\n( ) ( ) ( )\n\n1 1,1 0 0 1, 4\n2,1 2 2, 2 0 0\n\n0 3, 2 3 3, 3 0\n0 0 4, 3 4 4, 4\n\nB\nX X X\n\nB\nX X X\n\nX Be\nX X X\n\nB\nX X X e\n\nD D D\nD D D\n\nD\nD D D\n\nD D D\n\n? ?\n\n? ?\n\n? ?\n\n? ?\n\n? ?+\n? ?+? ?=\n? ?+\n? ?\n\n+? ?? ?\n                 \n\n    (5.52) \n\n    \n\npara elementos quadrangulares, onde cada coeficiente desta matriz \u00e9 uma derivada dada por \n \n\n \n( ) ( )\n\n( )\n,\n\n         para   \n\n0                                         para   \n\ni\n\nB m\nX m ip\n\nm w o i P\n\nB\nX w\n\ndB\nD i X p\n\ndp\n\nD i X s\n\n?\n=\n\n? ? ?? ?\n= =? ? ?? ??\n\n? ?? ? ?? ?\n?\n\n= =??\n\n?\n  (5.53)  \n\n \n\ne \n\n \n\n( ) ( )\n( )\n\n( ) ( )\n\n2\n,\n\n,\n\n, =   para  \n\n1\n, =                                   para  \n\ni\n\ni\n\nm r m m m\nX m m mP\n\nm w o k ip m m i\n\nm r m\nX m wP\n\nm w o w m m wip i\n\nk d dB\nD i j B B X p\n\np dp dpB\n\ndk\nD i j B X s\n\ns B ds\n\n?\n\n?\n\n? \u00b5\n\u00b5\n\n\u00b5\n\n?\n\u00b5\n\n=\n\n=\n\n? ? ? ? ?? ? ? ??? ? ?= ? + =? ?? ? ? ??? ? ? ? ?? ?? ? ? ?? ? ?\n?\n\n? ?? ? ? ??\n? ?= =? ? ? ??? ?? ? ? ?? ?\n\n?\n\n?\n?\n?\n??\n\n \n\n(5.54) \n\nNa Eq. (5.54) se o n\u00f3 \u00e0 montante de um ponto de integra\u00e7\u00e3o i n\u00e3o for igual ao n\u00f3 local \n\nj, esta equa\u00e7\u00e3o dever\u00e1 ser anulada. Isso implica que, quando ( )1,1XD?  for n\u00e3o-nulo, por \n\nexemplo, ( )1,XD NNE?  dever\u00e1 ser necessariamente nulo devido a fun\u00e7\u00e3o upwind utilizada \npara a mobilidade, e assim por diante.         \n\n \n\n\n\n CAP. 5 \u2013 IMPLEMENTA\u00c7\u00c3O COMPUTACIONAL 75 \n\n \n\n \n\nDetermina\u00e7\u00e3o da 2\u00aa. Parcela da Eq. (5.48): Esta parcela representa a deriva\u00e7\u00e3o da \n\npress\u00e3o presente nas Eqs. (5.43) e (5.45) em rela\u00e7\u00e3o as vari\u00e1veis dependentes, mantendo a \n\nmobilidade constante. Por isso quando a vari\u00e1vel dependente for a satura\u00e7\u00e3o esta parcela \u00e9 \n\nnula: \n\n \n\n  \n\n[ ]                    para   \n\n0                          para   \n\nB\n\nT\ne\n\nfluxos e\n\nB\n\nT\nw\n\nfluxos e\n\nR\nA X p\n\nX\n\nR\nX s\n\nX\n\n? ? ??\n= =? ? ?\n\n?? ?? ? ??\n?\n? ? ??\n? = =? ?\n\n?? ? ?? ? ?\n\n  (5.55)  \n\n \n \nonde [ ]eA  \u00e9 a mesma matriz do elemento utilizada no IMPES e definida na Eq. (5.12). \n\nDeterminada a matriz completa do elemento no M\u00e9todo Totalmente Impl\u00edcito, Eq. \n\n(5.48), os valores devem ser transportados para a matriz global apresentada na Eq. (5.29), \n\nseguindo um procedimento muito semelhante ao utilizado na montagem da matriz global da \n\npress\u00e3o no m\u00e9todo IMPES, sintetizado na Fig. 5.1, com a exce\u00e7\u00e3o de que para o m\u00e9todo \n\ntotalmente impl\u00edcito tem-se uma sub-matriz de 2x2 para cada posi\u00e7\u00e3o na matriz, \n \n\nT T\n\nw\n\nw w\n\nw\n\nR R\np s\n\nR R\np s\n\n? ?? ?\n? ?? ?\n? ?\n? ?? ?\n? ?\n? ?? ?\n\n \n\n \n\nconforme apresentado anteriormente na Eq. (5.29).  \n\n \n\n \n\n5.2.4. Crit\u00e9rios de Converg\u00eancia e C\u00e1lculo do Passo de Tempo \n\n \n\nConverg\u00eancia do M\u00e9todo de Newton. A solu\u00e7\u00e3o apresentada pelo M\u00e9todo de Newton \n\nser\u00e1 considerada convergida em cada passo de tempo quando os seguinte crit\u00e9rios baseados \n\nnas m\u00e1ximas varia\u00e7\u00f5es de p e sw  (norma l?) forem satisfeitos: \n \n\n\n\n76 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n1. 1\nmax\n\np p? ?+ ?  &lt;max\nuserp?  \n\n2. 1\nmaxw w\n\ns s? ?+ ? &lt;( )max\nuser\n\nws?   \n\n \n\nonde ?  \u00e9 o n\u00edvel iterativo e as grandezas com super-\u00edndices \u201cuser\u201d s\u00e3o os valores limites em \n\ncada itera\u00e7\u00e3o especificados pelo usu\u00e1rio: \n\n \n\nmax\nuserp?  = m\u00e1xima varia\u00e7\u00e3o permitida na press\u00e3o (valor padr\u00e3o (default)  =  10 kPa) \n\n( )max\nuser\n\nws?  = m\u00e1xima varia\u00e7\u00e3o permitida na satura\u00e7\u00e3o de \u00e1gua (valor default  = 0,005).  \n\n \n\n Converg\u00eancia da solu\u00e7\u00e3o do sistema linear. Quanto ao crit\u00e9rio de converg\u00eancia do \n\nsolver, ser\u00e1 utilizado um esquema baseado nos mesmos valores max\nuserp?  e ( )max\n\nuser\nws?  utilizados \n\nnos crit\u00e9rios de converg\u00eancia do M\u00e9todo de Newton. O solver permanecer\u00e1 iterando enquanto \n\nas mudan\u00e7as nos valores das vari\u00e1veis prim\u00e1rias forem maiores que um determinado \n\npercentual daqueles par\u00e2metros. O valor padr\u00e3o (default) utilizado foi 10%.  \n\n \n\nDetermina\u00e7\u00e3o do passo de tempo. Embora sejam menores as restri\u00e7\u00f5es do tamanho do \n\npasso de tempo no m\u00e9todo impl\u00edcito, uma vez que este esquema \u00e9 mais est\u00e1vel que o IMPES, \n\ndeve-se ter cuidado para que ele produza solu\u00e7\u00f5es dentro da precis\u00e3o desejada para o \n\nproblema em quest\u00e3o, haja vista a aproxima\u00e7\u00e3o da derivada temporal. Uma express\u00e3o que \n\npermite determinar o passo de tempo automaticamente em fun\u00e7\u00e3o de par\u00e2metros calculados \n\nno passo de tempo anterior, e que vem sendo utilizada pelos simuladores comerciais (STARS \n\nUser\u2019s Guide, 2002) em fun\u00e7\u00e3o de resultar em passos de tempo razo\u00e1veis \u00e9 dada por \n\n \n\n \nmax min\n\n1,75\n0,75\n\nuser\no P\n\nuser\nP\n\nDNormX\nt t\n\nDNormX DNormX\n? ?\n\n? = ? ? ?+? ?\n (5.56)  \n\n \n\nonde maxDNormX  \u00e9 a m\u00e1xima varia\u00e7\u00e3o da vari\u00e1vel X durante o passo de tempo anterior, e  \nuser\n\nPDNormX  \u00e9 uma grandeza definida pelo usu\u00e1rio e que representa a mudan\u00e7a t\u00edpica \n\nesperada da vari\u00e1vel X em cada passo de tempo. Para os problemas considerados neste \n\ntrabalho, userPDNormX  assume valores da ordem de 1000 kPa e 0,2, para X = p e sw, \n\nrespectivamente. \n\n\n\n CAP. 5 \u2013 IMPLEMENTA\u00c7\u00c3O COMPUTACIONAL 77 \n\n \n\n \n\nO passo de tempo estimado pela Eq. (5.56) poder\u00e1 ainda assim ser inadequado se \n\nresultar em um n\u00famero elevado de itera\u00e7\u00f5es do m\u00e9todo de Newton para a obten\u00e7\u00e3o da solu\u00e7\u00e3o \n\nconvergida ou se surgirem mudan\u00e7as bruscas do valor das vari\u00e1veis naquele passo de tempo. \n\nDeste modo, deve-se utilizar um controle adicional do passo de tempo que abortar\u00e1 a solu\u00e7\u00e3o \n\nde um dado um determinado n\u00edvel temporal se  \n\n \n\n1. O n\u00famero de itera\u00e7\u00f5es necess\u00e1rias para a converg\u00eancia do M\u00e9todo de Newton \n\nexceder um n\u00famero m\u00e1ximo estabelecido pelo usu\u00e1rio (valor default = 10); \n\n2. As varia\u00e7\u00f5es da press\u00e3o e satura\u00e7\u00e3o forem maiores que valores pr\u00e9-estabelecidos \n\npelo usu\u00e1rio (valor default = 2 userPDNormX? ). \n\n \n\nEm qualquer um destes casos a solu\u00e7\u00e3o deste n\u00edvel temporal \u00e9 interrompida, devendo \n\nser reiniciada, adotando-se um passo de tempo menor. Normalmente, uma redu\u00e7\u00e3o de 50% do \n\nvalor do passo de tempo tem demonstrado ser razo\u00e1vel. \n\nPor outro lado, se o passo de tempo estimado pela Eq. (5.56) for maior que um valor \n\nespecificado pelo usu\u00e1rio, ent\u00e3o o valor prescrito ser\u00e1 o utilizado. Caso seja menor que um \n\nvalor m\u00ednimo prescrito, a simula\u00e7\u00e3o ser\u00e1 interrompida, porque, provavelmente, houve a \n\nentrada de dados incompat\u00edveis com a modelagem f\u00edsica adotada. \n\n \n\n5.2.5. Procedimento Computacional \n\n \n As etapas do m\u00e9todo de solu\u00e7\u00e3o impl\u00edcita das equa\u00e7\u00f5es podem ser resumidas como: \n\n \n\n1. Inicializar os vetores e matrizes: \n\na) zerando a matriz Jacobiana [ ]A  e a matriz do elemento do IMPES [ ]eA , Eq. (5.12) que \nser\u00e1 utilizada tamb\u00e9m no M\u00e9todo Totalmente Impl\u00edcito ( ver Eq. (5.55) ); \n\nb) computando os valores de B, \u00b5  e as mobilidades das fases e suas derivadas em rela\u00e7\u00e3o a \n\npress\u00e3o e satura\u00e7\u00e3o nos n\u00f3s da malha; \n\nc) determinando em todos os pontos de integra\u00e7\u00e3o a numera\u00e7\u00e3o local do n\u00f3 localizado \u00e0 \n\nmontante da face que cont\u00e9m o ponto de integra\u00e7\u00e3o.  \n\n \n\n2. Em um loop sobre os elementos da malha: \n\n\n\n78 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\na) utilizar nos pontos de integra\u00e7\u00e3o o valor das mobilidades e as suas derivadas que s\u00e3o \n\nutilizadas no c\u00e1lculo dos termos XD , Eq. (5.53), de acordo com a numera\u00e7\u00e3o local do n\u00f3 \n\nlocalizado \u00e0 montante (item 1 c). \n\nb) determinar as matrizes de derivadas de cada fase - XD e? ?? ? , Eqs. (5.51) e (5.52). \n\nc) calcular a matriz local [ ]eA , Eq. (5.12), e adicionar cada coeficiente na sua posi\u00e7\u00e3o \n\nespec\u00edfica nas matrizes locais de derivadas de res\u00edduos, Eq. (5.48). Al\u00e9m disso deve ser \n\ncriado um vetor de (NNE x 1) multiplicando esta matriz pelo vetor de press\u00e3o do elemento \n\nTodo esse procedimento n\u00e3o necessita ser feito para a equa\u00e7\u00e3o da \u00e1gua. \n\nd) adicionar as derivadas do termo de fluxo definidas nas matrizes locais na matriz  \n\nJacobiana, e tamb\u00e9m o vetor local para o vetor  global de termos independentes (ver se\u00e7\u00e3o \n\n5.1.2). \n\n \n\n3. Em um loop sobre os n\u00f3s da malha: \na) calcular o termo de acumula\u00e7\u00e3o, Eq. (5.32), e subtra\u00ed-lo do vetor de res\u00edduos, Eq. (5.37).  \n\nb) calcular as derivadas do termo de acumula\u00e7\u00e3o, Eqs. (5.38) e (5.39), e subtra\u00ed-las dos \n\ntermos correspondentes da matriz (2x2) localizada na diagonal da matriz Jacobiana, Eq. \n\n(5.29). \n\n \n\n4. Em um loop sobre os n\u00f3s que contenham po\u00e7os: \na) calcular o termo de po\u00e7o, Eq. (5.34), e adicion\u00e1-lo no vetor de res\u00edduos, Eq. (5.37); \n\nb) calcular as derivadas do termo de po\u00e7o em fun\u00e7\u00e3o do modelo de po\u00e7o adotado, e adicion\u00e1-\n\nlas na matriz (2x2) correspondente na diagonal da matriz Jacobiana, Eq. (5.29). \n\n \n\n5. Resolver o sistema linear para determinar o vetor de inc\u00f3gnitas, Eq. (5.29). \n\n \n\n6. Avan\u00e7ar as vari\u00e1veis dependentes no n\u00edvel iterativo: { } { } { }1 1p p p? ? ?+ += + ?  e \n\n{ } { } { }1 1w w ws s s\n? ? ?+ +\n\n= + ? . \n\n \n\n7. Verificar se a converg\u00eancia foi obtida a partir dos crit\u00e9rios dados na se\u00e7\u00e3o 5.2.4. \n\nSe n\u00e3o foi, volta-se ao passo 1, incrementando-se o n\u00edvel iterativo ( 1+= ?? ), ou \n\nabortando a solu\u00e7\u00e3o deste intervalo de tempo, reduzindo o passo de tempo e \n\ntornando 0=? , se o n\u00famero de ciclos de Newton for demasiado grande ou se as \n\nvari\u00e1veis dependentes apresentarem varia\u00e7\u00e3o maior que o estipulado. \n\n \n\n8. Avan\u00e7ar no tempo ( ttt ?+=  e 0=? ) e retornar ao passo 1. \n\n\n\n CAP. 5 \u2013 IMPLEMENTA\u00c7\u00c3O COMPUTACIONAL 79 \n\n \n\n \n\n5.3. Esquema de Armazenamento de Matrizes Esparsas \n \n \n\nAs matrizes de coeficientes geradas nos m\u00e9todos IMPES e Totalmente Impl\u00edcito s\u00e3o \n\naltamente esparsas, isto \u00e9, possuem um n\u00famero elevado de valores nulos. Um armazenamento \n\nde todos os seus coeficientes \u00e9 altamente ineficiente por trabalhar com uma quantidade \n\nenorme de zeros e impratic\u00e1vel em fun\u00e7\u00e3o da capacidade de mem\u00f3ria dos computadores \n\natuais. Por isso existem esquemas especiais de tratamento de matrizes esparsas em que apenas \n\nos valores n\u00e3o-nulos de uma matriz s\u00e3o armazenados. \n\nA utiliza\u00e7\u00e3o de esquemas de armazenamento de matrizes esparsas n\u00e3o invalida as \n\nid\u00e9ias gerais apresentadas na se\u00e7\u00e3o 5.1.2 a respeito da forma\u00e7\u00e3o das matrizes globais. \n\nContudo, os dados passam a ser estruturados n\u00e3o mais a partir de uma forma matricial, mas \n\nutilizando tr\u00eas vetores que definem todos os elementos n\u00e3o-nulos. O esquema mais simples \u00e9 \n\ndenominado de formato coordenado (SAAD, 2000), cuja estrutura de dados \u00e9 composta por \n\ntr\u00eas vetores de mesmas dimens\u00f5es:  \n\n \n\n1. Um vetor de inteiros com os \u00edndices das linhas; \n\n2. Um vetor de inteiros com os \u00edndices das colunas; \n\n3. Um vetor de n\u00fameros reais contendo os valores n\u00e3o-nulos localizados nas posi\u00e7\u00f5es \n\n(linha, coluna) definidas nos outros dois vetores. \n\n \n\nA Fig. 5.2 ilustra o processo de representa\u00e7\u00e3o de matrizes esparsas neste formato, \n\napresentando um exemplo de uma malha composta por dois elementos \u2013 um triangular e outro \n\nquadril\u00e1tero. Nota-se que, semelhantemente ao processo de forma\u00e7\u00e3o das matrizes globais \n\ncheias, a matriz global esparsa representada desta forma continua sendo montada a partir da \n\ninforma\u00e7\u00e3o proveniente das matrizes locais de coeficientes, como deveria ser.  \n\nO esquema de armazenamento adotado neste trabalho \u00e9 uma variante do formato \n\napresentado na Fig. 5.2, e \u00e9 denominado de formato de linha comprimida - Compressed \n\nSparse Row \u2013 CSR (BARRETT et al., 1994). Este \u00e9 o formato de entrada comumente \n\nutilizado pelos pacotes computacionais por ser mais \u00fatil nas opera\u00e7\u00f5es matriciais t\u00edpicas, \n\nembora n\u00e3o seja t\u00e3o simples e flex\u00edvel como o formato coordenado. Em vez de armazenar a \n\ninforma\u00e7\u00e3o redundante referente \u00e0 numera\u00e7\u00e3o dos \u00edndices das linhas, \u00e9 armazenado um vetor \n\nque aponta para o primeiro valor de cada linha na matriz cheia. A Fig. 5.3 apresenta a matriz \n\nmostrada na Fig. 5.2 no formato CSR. Al\u00e9m de economizar espa\u00e7o na mem\u00f3ria do \n\n\n\n80 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\ncomputador, no formato CSR tem-se a localiza\u00e7\u00e3o direta do in\u00edcio de cada linha, o que \u00e9 uma \n\ninforma\u00e7\u00e3o que agiliza as opera\u00e7\u00f5es com matrizes.  \n\n \n\n \n\n \n\n \n \n\nFig. 5.2 - Procedimento de preenchimento da matriz esparsa (formato coordenado) definida por tr\u00eas vetores que \n\ncont\u00eam os valores n\u00e3o-nulos e os \u00edndices que definem a posi\u00e7\u00e3o de cada um deles na matriz cheia.  \n\n \n\n \n\n \n\n \n\n \n\nFig. 5.3 - Matriz esparsa da Fig. 5.2 no formato de linha comprimida (Compressed Sparse Row) \n\n \n\n \n\n\n\n CAP. 5 \u2013 IMPLEMENTA\u00c7\u00c3O COMPUTACIONAL 81 \n\n \n\n \n\nA desvantagem da utiliza\u00e7\u00e3o do esquema que armazena apenas os elementos n\u00e3o-\n\nnulos de uma matriz se manifesta durante o processo de constru\u00e7\u00e3o, isto \u00e9, quando s\u00e3o \n\nvisitados os elementos e os valores contidos nas matrizes locais s\u00e3o transferidos para a matriz \n\nglobal. A dificuldade \u00e9 identificar diretamente a localiza\u00e7\u00e3o de um coeficiente no vetor de \n\nvalores dados seus \u00edndices da linha e coluna correspondentes da matriz cheia. No entanto, as \n\nbibliotecas num\u00e9ricas dispon\u00edveis, como a COI-lib5 entre outras, apresentam algoritmos muito \n\neficientes que reduzem consideravelmente o trabalho de pesquisa da posi\u00e7\u00e3o de um \n\ncoeficiente no vetor de valores. Os casos rodados demonstraram que o tempo despendido \n\nnesta tarefa \u00e9 incomparavelmente menor que o tempo gasto na solu\u00e7\u00e3o do sistema linear. Por \n\nisso n\u00e3o foi dedicado muito esfor\u00e7o neste processo, e sim na implementa\u00e7\u00e3o de um solver \n\nmais r\u00e1pido, o multigrid, que ser\u00e1 objeto de estudo no pr\u00f3ximo cap\u00edtulo. \n\nPor\u00e9m, quando n\u00e3o se disp\u00f5e de uma biblioteca num\u00e9rica como a COI-lib para \n\nprocessar a transfer\u00eancia de dados das matrizes locais para a global, pode-se criar algoritmos \n\ncomo o proposto no Anexo 4 que s\u00e3o eficientes e de implementa\u00e7\u00e3o simples, mas que \n\nnecessitam alocar uma quantidade, muitas vezes, excessiva de mem\u00f3ria, em fun\u00e7\u00e3o da cria\u00e7\u00e3o \n\nde matrizes locais de endere\u00e7os em cada elemento. Em situa\u00e7\u00f5es onde a capacidade de \n\nmem\u00f3ria computacional n\u00e3o for uma restri\u00e7\u00e3o muito s\u00e9ria, estes esquemas poder\u00e3o ser uma \n\nboa alternativa. \n\n                                                 \n5 A COI-lib \u00e9 uma biblioteca gr\u00e1fica desenvolvida em C++ com o objetivo de facilitar o uso de aplicativos de \nalta complexidade, permitindo a entrada de dados e visualiza\u00e7\u00e3o de resultados de maneira simples e intuitiva. \nPode ser encontrada em http://www.sinmec.ufsc.br/sinmec/software/coi-lib.html. \n\n\n\n \n\n\n\n83 \n\nCap.    \n\n6 \nMM\u00c9\u00c9TTOODDOO  MMUULLTTIIGGRRIIDD  DDEE  SSOOLLUU\u00c7\u00c7\u00c3\u00c3OO    \nDDOO  SSIISSTTEEMMAA  LLIINNEEAARR  \n\n \n\n \n \n\n6.1. Caracter\u00edsticas do M\u00e9todo Multigrid \n \nO multigrid \u00e9 um dos m\u00e9todos dispon\u00edveis na literatura para melhorar a efici\u00eancia dos \n\nsolvers iterativos. De forma geral, eles se destacam por sua alta robustez, isto \u00e9, por sua \n\ncapacidade de resolver sistemas lineares provenientes de diferentes problemas f\u00edsicos sem \n\nperda sens\u00edvel de efici\u00eancia (RAW, 1996). Solvers robustos requerem pouca interven\u00e7\u00e3o do \n\nusu\u00e1rio na mudan\u00e7a de seus par\u00e2metros. Outra caracter\u00edstica verificada nos m\u00e9todos multigrid \n\n\u00e9 a sua converg\u00eancia monot\u00f4nica, isto \u00e9, a solu\u00e7\u00e3o fornecida pelo solver aproxima-se da \n\nsolu\u00e7\u00e3o exata a cada itera\u00e7\u00e3o (VAN DOORMAAL et al., 1987; ELIAS et al., 1997).  \n\nNormalmente a qualidade da solu\u00e7\u00e3o num\u00e9rica est\u00e1 diretamente associada ao n\u00famero \n\nde pontos da malha utilizada, no sentido em que uma malha mais refinada representar\u00e1 com \n\nmaior fidelidade a solu\u00e7\u00e3o da equa\u00e7\u00e3o diferencial discretizada. Por outro lado, o custo \n\ncomputacional para sua determina\u00e7\u00e3o \u00e9 mais alto. J\u00e1 em uma malha mais grosseira (com um \n\nn\u00famero menor de pontos de malha), a solu\u00e7\u00e3o pode ser mais rapidamente obtida, por\u00e9m com \n\numa qualidade inferior \u00e0 da malha refinada devido aos maiores erros de truncamento. A id\u00e9ia \n\nb\u00e1sica do m\u00e9todo multigrid \u00e9 utilizar malhas diferentes na resolu\u00e7\u00e3o de um problema a fim de \n\nacelerar a converg\u00eancia de malhas mais refinadas. \n\nAlguns solvers s\u00e3o robustos e eficientes na solu\u00e7\u00e3o de sistemas lineares com poucas \n\nvari\u00e1veis, mas seu custo computacional pode variar exponencialmente com o tamanho do \n\nproblema. Os solvers Gauss-Seidel e os m\u00e9todos diretos em geral, por exemplo, apresentam \n\nesfor\u00e7o computacional que aumenta com o quadrado e com o cubo, respectivamente, do \n\nn\u00famero de vari\u00e1veis do sistema linear. Por isso, a ordem do solver \u00e9 outra importante \n\ncaracter\u00edstica a analisar. Ela \u00e9 expressa como O(N?), onde ?  \u00e9 a taxa que indica o aumento do \n\n\n\n84 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nesfor\u00e7o do solver com o n\u00famero de vari\u00e1veis (N) do problema. A Fig. 6.1 apresenta as curvas \n\nt\u00edpicas que relacionam o custo computacional (tempo de CPU) com o n\u00famero de vari\u00e1veis do \n\nsistema linear para diferentes solvers. Percebe-se, nesta figura, que os solvers diretos, como \n\nElimina\u00e7\u00e3o de Gauss e LU, s\u00e3o m\u00e9todos de elevada ordem - O(N3), e que portanto, s\u00e3o \n\nimpratic\u00e1veis para resolver problemas com grande n\u00famero de vari\u00e1veis porque o custo \n\ncomputacional torna-se excessivamente grande. \n\n \n\n \n\n \n\nFig. 6.1- Compara\u00e7\u00e3o entre o desempenho te\u00f3rico de diferentes solvers \n\n \n\n \n\nOs m\u00e9todos multigrid, por sua vez, s\u00e3o lineares, isto \u00e9, possuem ordem - O(N), que \u00e9 a \n\nsitua\u00e7\u00e3o ideal, embora apresentem custo computacional maior que os outros m\u00e9todos para \n\nn\u00famero pequeno de vari\u00e1veis, conforme pode se visto na Fig. 6.1. Esse mau desempenho na \n\nsolu\u00e7\u00e3o de pequenos sistemas lineares deve-se aos procedimentos de obten\u00e7\u00e3o dos \n\ncoeficientes e de outros par\u00e2metros das malhas grosseiras. Outros m\u00e9todos iterativos n\u00e3o \n\nmencionados como M\u00e9todos de Gradiente Conjugado, GMRES, s\u00e3o m\u00e9todos que apresentam \n\ncurvas de converg\u00eancia situadas entre a do Gauss-Seidel e a do multigrid na Fig. 6.1. \n\n O m\u00e9todo multigrid adotado neste trabalho \u00e9 do tipo alg\u00e9brico, tamb\u00e9m chamado na \n\nliteratura de m\u00e9todo multigrid baseado na corre\u00e7\u00e3o aditiva (HUTCHINSON e RAITHBY, \n\n1986), aplicado originalmente em malhas estruturadas. Neste m\u00e9todo, que ser\u00e1 denominado a \n\npartir de agora pelo acr\u00f4nimo ACM (The Additive Correction Multigrid), prop\u00f5e-se que as \n\n\n\n CAP. 6 \u2013 M\u00c9TODO MULTIGRID 85 \n\n \n\n \n\nequa\u00e7\u00f5es sejam deduzidas apenas para a malha refinada, sendo as equa\u00e7\u00f5es utilizadas nas \n\nmalhas grosseiras obtidas apenas somando-se os coeficientes da malha original. Por isso n\u00e3o \u00e9 \n\nnecess\u00e1rio ter stencils fixos, o que evita inconsist\u00eancias entre as malhas e \u00e9 uma caracter\u00edstica \n\nmuito apropriada para aplica\u00e7\u00e3o do m\u00e9todo em malhas n\u00e3o-estruturadas como as utilizadas \n\nneste trabalho. O processo de forma\u00e7\u00e3o das c\u00e9lulas grosseiras e a dedu\u00e7\u00e3o de suas equa\u00e7\u00f5es \n\ns\u00e3o consideradas adiante neste cap\u00edtulo. \n\n Embora esteja sendo utilizada exaustivamente neste trabalho, deve-se mencionar que a \n\ndenomina\u00e7\u00e3o multigrid n\u00e3o \u00e9 a mais adequada para descrev\u00ea-lo, porque, de fato, n\u00e3o \n\nnecessita-se mais gerar as malhas grosseiras e nem discretizar as equa\u00e7\u00f5es diferenciais nelas. \n\nPor\u00e9m, para evitar incompatibilidades com diversos trabalhos da literatura e em fun\u00e7\u00e3o de que \n\nmuitas vezes deseja-se caracterizar graficamente as conex\u00f5es das equa\u00e7\u00f5es utilizadas nas \n\nmalhas grosseiras, procurou-se manter esta denomina\u00e7\u00e3o. \n\n \n\n \n\n6.2. Mecanismos Envolvidos no Multigrid \n \n\n De forma geral h\u00e1 tr\u00eas mecanismos envolvidos no m\u00e9todo multigrid: \n\n \n\n1. Transfer\u00eancia de informa\u00e7\u00e3o da malha grosseira para a refinada. \n\n2. Solu\u00e7\u00e3o na malha grosseira. \n\n3. Transfer\u00eancia de informa\u00e7\u00e3o da malha refinada para a grosseira. \n\n \n\nEmbora pare\u00e7a, \u00e0 primeira vista, ser mais intuitivo discutir estes mecanismos na \n\nordem inversa, isto \u00e9, de 3 a 1, \u00e9 mais did\u00e1tico, pelo menos para o ACM, descrev\u00ea-los \n\nexatamente nesta ordem, o que ser\u00e1 feito com mais detalhes na seq\u00fc\u00eancia. \n\n \n\n6.2.1. Transfer\u00eancia de Informa\u00e7\u00e3o da Malha Grosseira para a Refinada \n\n \n\n Esta etapa \u00e9 denominada \u201copera\u00e7\u00e3o de prolonga\u00e7\u00e3o\u201d (BRIGGS et al., 2000; \n\nTROTTENBERG et al., 2001), e nela a vari\u00e1vel da malha refinada tem a sua estimativa \n\natualizada com um valor de corre\u00e7\u00e3o que contribuir\u00e1 para a elimina\u00e7\u00e3o dos erros de baixa \n\nordem. No ACM prop\u00f5e-se que a malha grosseira forne\u00e7a um vetor com as corre\u00e7\u00f5es a serem \n\n\n\n86 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nadicionadas na solu\u00e7\u00e3o da malha refinada. Desta forma, a estimativa da vari\u00e1vel ser\u00e1 \n\nincrementada assim \n\n \n\n *P P I?= +? ?  (6.1) \n\n \n\nonde *P?  \u00e9 a solu\u00e7\u00e3o corrigida da vari\u00e1vel ?  calculada para o n\u00f3 P da malha refinada e  \n\nutilizada como estimativa inicial na pr\u00f3xima itera\u00e7\u00e3o, P?  \u00e9 a \u00faltima estimativa desta vari\u00e1vel \n\nna malha refinada, ou seja, a solu\u00e7\u00e3o mais recente, e I?  \u00e9 a corre\u00e7\u00e3o proveniente da malha \n\ngrosseira. Nesta equa\u00e7\u00e3o P representa cada um dos volumes de controle que comp\u00f5em a \n\nc\u00e9lula I. A Fig. 6.2 mostra um exemplo da forma\u00e7\u00e3o das c\u00e9lulas da malha grosseira a partir de \n\numa malha de volumes de controle n\u00e3o-estruturada, denominada na figura de malha original, \n\nque \u00e9 aquela onde se procura a solu\u00e7\u00e3o do sistema linear. \n\n \n\n \n\n \n \n\nFig. 6.2 - Processo de forma\u00e7\u00e3o das malhas grosseiras a partir da aglomera\u00e7\u00e3o dos volumes de controle da malha \n\noriginal, onde se procura a solu\u00e7\u00e3o do sistema linear \n\n  \n\n \n\nNote que, embora o m\u00e9todo de solu\u00e7\u00e3o das equa\u00e7\u00f5es seja baseado em elementos \u2013 \n\nEbFVM, as equa\u00e7\u00f5es finais na malha original s\u00e3o o resultado da aplica\u00e7\u00e3o dos princ\u00edpios de \n\n\n\n CAP. 6 \u2013 M\u00c9TODO MULTIGRID 87 \n\n \n\n \n\nconserva\u00e7\u00e3o nos volumes de controle. Objetiva-se no multigrid que estes princ\u00edpios apliquem-\n\nse tamb\u00e9m nas equa\u00e7\u00f5es da malha grosseira e, por isso, ela deve ser constru\u00edda pela uni\u00e3o de \n\nvolumes de controle, como ilustrado na Fig. 6.2, e n\u00e3o de elementos de malha, que seria um \n\nprocedimento bem mais simples. \n\n \n\n6.2.2. Solu\u00e7\u00e3o na Malha Grosseira \n\n \nPara que sejam obtidos valores de corre\u00e7\u00e3o ( I? ) adequados \u00e9 necess\u00e1rio estabelecer \n\nequa\u00e7\u00f5es a serem resolvidas nas malhas grosseiras que tenham forte rela\u00e7\u00e3o com a f\u00edsica do \n\nproblema a ser resolvida na malha original. Por isso nos m\u00e9todos multigrid tradicionais as \n\nequa\u00e7\u00f5es diferenciais s\u00e3o tamb\u00e9m discretizadas e resolvidas nas malhas grosseiras. Por\u00e9m \n\nesse procedimento aumenta o custo e a complexidade computacional, criando eventuais \n\ninconsist\u00eancias entre malhas. Para evitar essas dificuldades \u00e9 utilizado um procedimento \n\ndiferente no ACM. \n\nDeseja-se definir um I?  de tal forma que o res\u00edduo da equa\u00e7\u00e3o de cada volume de \n\ncontrole da malha original torne-se mais pr\u00f3ximo de zero. Em \u00faltima inst\u00e2ncia esse \u00e9 o \n\nobjetivo do multigrid, como \u00e9 o de qualquer solver. Uma condi\u00e7\u00e3o que pode ser explorada \n\nadv\u00e9m da inspe\u00e7\u00e3o de que na solu\u00e7\u00e3o exata do sistema linear o res\u00edduo de cada equa\u00e7\u00e3o \u00e9 \n\nnulo, assim como deve ser nulo tamb\u00e9m o somat\u00f3rio dos res\u00edduos das equa\u00e7\u00f5es de quaisquer \n\nvolumes de controle do dom\u00ednio \n\n \n\n * 0P\nP\n\n=?R  (6.2) \n\n \n\nonde *PR  \u00e9 a express\u00e3o mais recente do res\u00edduo\n1 da equa\u00e7\u00e3o de P e, devido \u00e0 discretiza\u00e7\u00e3o em \n\nEbFVM, ter\u00e1 a forma \n\n \n\n * * *\n de \n\nP P P P nb nb\nnb P\n\nb A A= ? ? ?R ? ?  (6.3) \n\n \n\n                                                 \n1 Deve-se evitar confundir a express\u00e3o do res\u00edduo R  que \u00e9 definido sob o ponto de vista do solver (problema \nlinear), com o res\u00edduo R do m\u00e9todo de Newton e empregado apenas no m\u00e9todo Totalmente Impl\u00edcito (problema \nn\u00e3o-linear). \n\n\n\n88 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nonde nb representa os n\u00f3s vizinhos a P, A \u00e9 a matriz de coeficientes e b \u00e9 o vetor de termos \n\nindependentes. \n\nSe for substitu\u00edda a vari\u00e1vel *P?  da Eq. (6.1) em (6.3), tem-se \n\n \n\n ( ) ( )* , ,\n de \n\nP P P P P I P nb nb nb\nnb P\n\nb A A? ?= ? + ? +?R ? ?  (6.4) \n\n \n\nMas, reconhecendo a express\u00e3o do res\u00edduo PR  presente na equa\u00e7\u00e3o anterior \n\n \n\n , ,\n de \n\nP P P P P nb nb P\nnb P\n\nb A A? ? =? R? ?  (6.5) \n\n \n\npode-se reescrever a Eq. (6.4) como \n\n \n\n * , ,\n de \n\nP P P P I P nb nb\nnb P\n\nA A? ?= ? ? ?R R  (6.6) \n\n \n\n Escolhendo convenientemente quais volumes de controle far\u00e3o parte da c\u00e9lula I, e \n\nsomando seus res\u00edduos de acordo com a Eq. (6.2) obt\u00e9m-se \n\n \n\n , ,\n de \n\n0 P P P I P nb nb\nP I nb P\n\nA A? ?\n?\n\n? ?\n= ? ?? ?\n\n? ?\n? ?R  (6.7) \n\n \n\nque escrito da forma tradicional resulta em  \n\n \n\n , ,\n de \n\nI I I I NB NB I\nNB I\n\nA A b? ?+ =?  (6.8) \n\n \n\nonde NB \u00e9 o \u00edndice das c\u00e9lulas vizinhas a I na malha grosseira, e \n\n \n\n \n( )\n\n, , ,\n de \n\nI I P P P nb\nP I P I nb P I\n\nA A A\n? ? ?\n\n? ?? ?= + ? ?\n? ?? ?\n\n? ? ?  (6.9) \n\n \n\n\n\n CAP. 6 \u2013 M\u00c9TODO MULTIGRID 89 \n\n \n\n \n\n \n( )\n\n, ,\n de \n\nI NB P nb\nP I nb P I\n\nA A\n? ?\n\n? ?? ?= ? ?\n? ?? ?\n\n? ?  (6.10) \n\n \n\n { }I P\nP I\n\nb\n?\n\n= ? R  (6.11) \n\n \n\n A solu\u00e7\u00e3o do sistema de equa\u00e7\u00f5es representado pela Eq. (6.8) fornecer\u00e1 as corre\u00e7\u00f5es \n\nque ser\u00e3o somadas \u00e0 solu\u00e7\u00e3o da malha refinada e que ir\u00e3o satisfazer a condi\u00e7\u00e3o desejada e \n\nestabelecida na Eq. (6.2). A constru\u00e7\u00e3o dos coeficientes das Eqs. (6.9) e (6.10) requer um \n\nprocedimento computacional bastante simplificado mesmo para malhas n\u00e3o-estruturadas, uma \n\nvez que consiste em apenas somar coeficientes da malha refinada. O leitor poder\u00e1 ver a forma \n\nfinal dessas equa\u00e7\u00f5es aplicadas a um exemplo pr\u00e1tico em Maliska (2004), onde, atrav\u00e9s de \n\num problema cartesiano bidimensional, poder-se-\u00e1 compreender melhor o princ\u00edpio de \n\nforma\u00e7\u00e3o dos coeficientes das malhas grosseiras apresentado aqui. \n\n Esse procedimento de obten\u00e7\u00e3o das equa\u00e7\u00f5es das malhas grosseiras tem um \n\nembasamento f\u00edsico importante. Elias (1993) demonstra que isso \u00e9 equivalente a for\u00e7ar a \n\nconserva\u00e7\u00e3o dos fluxos nas interfaces das c\u00e9lulas grosseiras, o que \u00e9 uma caracter\u00edstica \n\ndesej\u00e1vel, uma vez que o M\u00e9todo de Volumes Finitos \u00e9 embasado nos princ\u00edpios de \n\nconserva\u00e7\u00e3o. Essa \u00e9 a raz\u00e3o porque Raw (1996) adverte que todas as equa\u00e7\u00f5es da malha fina \n\ndevem estar em sua forma conservativa quando se emprega o ACM. \u00c9 importante destacar, no \n\nentanto, que o procedimento descrito nesta se\u00e7\u00e3o n\u00e3o \u00e9 equivalente a discretizar as equa\u00e7\u00f5es \n\nnas malhas grosseiras, que \u00e9 o que se queria evitar para n\u00e3o precisar lidar com stencils fixos.  \n\n \n\nConsidera\u00e7\u00f5es sobre o Solver Utilizado na Malha Grosseira. Normalmente n\u00e3o se \n\ndeseja obter uma solu\u00e7\u00e3o muito precisa nas malhas grosseiras, uma vez que se necessita \n\napenas de valores utilizados como corre\u00e7\u00e3o. Por isso os solvers iterativos utilizados no \n\nmultigrid s\u00e3o freq\u00fcentemente denominados de m\u00e9todos de relaxa\u00e7\u00e3o ou suaviza\u00e7\u00e3o \n\n(smoothing methods) (TROTTENBERG et al., 2001), e ser\u00e3o denominados doravante neste \n\ntexto de solver-base. Assim, a precis\u00e3o do solver n\u00e3o \u00e9 a caracter\u00edstica mais importante e \n\ndesejada nesta tarefa, e sim a rapidez com que ele itera, o que n\u00e3o recomenda o uso direto da \n\nmaioria dos m\u00e9todos conhecidos na literatura como n\u00e3o-estacion\u00e1rios: GMRES, Gradiente \n\nConjugado, Orthomin etc.  \n\n\n\n90 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n Os m\u00e9todos estacion\u00e1rios ou ponto a ponto, como Jacobi e Gauss-Seidel, t\u00eam sido \n\nbastante utilizados como solver-base do multigrid por serem r\u00e1pidos e de simples \n\nimplementa\u00e7\u00e3o (PHILIPS e SCHMIDT, 1984; ELIAS, 1993; WANG et al., 1995).  \n\nOs m\u00e9todos baseados na fatora\u00e7\u00e3o incompleta LU (Lower/Upper Triangular \n\nDecomposition) tamb\u00e9m t\u00eam sido utilizados como solver-base do multigrid e, em muitas \n\nvezes, com melhores resultados que os m\u00e9todos de relaxa\u00e7\u00e3o tradicionais (RAW, 1996; \n\nBASTIAN e HELMIG, 1999). A id\u00e9ia b\u00e1sica desses m\u00e9todos \u00e9 encontrar uma matriz de \n\ncoeficientes aproximada, constru\u00edda de tal forma que o processo de solu\u00e7\u00e3o torne-se r\u00e1pido, \n\npermitindo trabalhar com os n\u00e3o-zeros e resolvendo iterativamente o sistema linear resultante \n\n(MALISKA, 2004). Normalmente esta fatora\u00e7\u00e3o tem sido utilizada para determinar a matriz \n\npr\u00e9-condicionadora de m\u00e9todos n\u00e3o-estacion\u00e1rios (MARCONDES, 1996), mas tamb\u00e9m \n\ncontribui para a implementa\u00e7\u00e3o de m\u00e9todos de relaxa\u00e7\u00e3o com resultados bastante \n\nsatisfat\u00f3rios. Por n\u00e3o precisar determinar com precis\u00e3o as matrizes [L] e [U], que \u00e9 o processo \n\nmais custoso no solver direto LU, uma solu\u00e7\u00e3o inexata para o sistema linear pode ser \n\nrapidamente obtida. \n\nO processo de constru\u00e7\u00e3o das matrizes [L] e [U] incompletas \u00e9 praticamente id\u00eantico \n\nao do m\u00e9todo LU tradicional, a menos do fato de que apenas os valores n\u00e3o-nulos na matriz \n\noriginal s\u00e3o modificados. Esta \u00e9 uma caracter\u00edstica importante porque este procedimento, \n\ndenominado de fatora\u00e7\u00e3o ILU(0), n\u00e3o altera o formato de armazenamento da matriz de dados, \n\ne portanto, n\u00e3o demanda reformata\u00e7\u00e3o da matriz esparsa2 (SAAD, 2000). Obtidas as matrizes \n\n[L] e [U] incompletas, inicia-se o processo iterativo, determinando-se uma corre\u00e7\u00e3o nas \n\nvari\u00e1veis com o m\u00e9todo de decomposi\u00e7\u00e3o LU e atualizando-as, at\u00e9 atingir a norma do res\u00edduo \n\nescolhido. Este procedimento est\u00e1 apresentado com mais detalhes no Anexo 5, e \u00e9 bastante \n\ndistinto do empregado nos m\u00e9todos diretos (solver LU tradicional, por exemplo). Na \n\nrealidade, um solver direto n\u00e3o exerce a fun\u00e7\u00e3o desejada no multigrid se for utilizado para \n\nobter a solu\u00e7\u00e3o de todas as malhas porque, al\u00e9m de ser demasiadamente demorado na \n\nobten\u00e7\u00e3o das solu\u00e7\u00f5es com malhas mais finas, ele n\u00e3o aproveita as corre\u00e7\u00f5es obtidas das \n\nsolu\u00e7\u00f5es de malhas mais grosseiras como estimativa inicial, uma vez que os m\u00e9todos diretos \n\nn\u00e3o s\u00e3o iterativos. \n\nO ILU(0) pode ser uma boa op\u00e7\u00e3o para atuar como solver-base do multigrid porque \n\npossui uma taxa de converg\u00eancia bastante alta devido a atualiza\u00e7\u00e3o de todas as inc\u00f3gnitas em \n\n                                                 \n2 Outros m\u00e9todos de fatora\u00e7\u00e3o incompleta que diminuem a quantidade de valores n\u00e3o-nulos desprezados tamb\u00e9m \ns\u00e3o relatados na literatura, como ILU(1), ILU(2) etc., mas que aumentam a quantidade de mem\u00f3ria utilizada e o \ntrabalho na realiza\u00e7\u00e3o da fatora\u00e7\u00e3o. \n\n\n\n CAP. 6 \u2013 M\u00c9TODO MULTIGRID 91 \n\n \n\n \n\numa mesma itera\u00e7\u00e3o. Essa caracter\u00edstica, tamb\u00e9m conhecida como fortemente impl\u00edcita,  \u00e9 \n\ndestac\u00e1vel porque \u00e9 sempre dif\u00edcil estimar previamente e com maior precis\u00e3o o n\u00famero de \n\nitera\u00e7\u00f5es do Gauss-Seidel em cada malha grosseira necess\u00e1rio para acelerar a converg\u00eancia do \n\nmultigrid, embora cada itera\u00e7\u00e3o do Gauss-Seidel seja mais r\u00e1pida que a do ILU(0). Foi \n\nverificado que em malhas com poucos n\u00f3s, por exemplo, a quantidade utilizada normalmente \n\n\u00e9 superestimada, enquanto que para malhas bastante refinadas esta quantidade \u00e9 insuficiente, \n\ndivergindo a solu\u00e7\u00e3o. Os resultados preliminares obtidos neste trabalho demonstram que o \n\nsolver ILU(0), por n\u00e3o ser ponto a ponto, apresenta uma menor depend\u00eancia do n\u00famero de \n\nitera\u00e7\u00f5es com o tamanho da malha. Al\u00e9m de conferir uma maior implicitude ao m\u00e9todo, este \n\nsolver tamb\u00e9m \u00e9 bastante adequado na solu\u00e7\u00e3o de problemas anisotr\u00f3picos, tornando-se um \n\nsolver TDMA (Tridiagonal Matrix Solver) no caso limite de coeficientes muito grandes em \n\napenas uma dire\u00e7\u00e3o (RAW, 1996). \n\n Neste trabalho optou-se por obter a solu\u00e7\u00e3o da malha mais grosseira que tiver poucas \n\nvari\u00e1veis, normalmente menos que 50, de forma exata atrav\u00e9s do solver direto (LU), tamb\u00e9m \n\ndescrito no Anexo 5, enquanto que, para as demais malhas, utilizar-se-\u00e1 o solver iterativo \n\nILU(0) ou o Gauss-Seidel, que ser\u00e3o objetos de compara\u00e7\u00e3o no Cap. 8. \n\n \n\n6.2.3. Transfer\u00eancia de Informa\u00e7\u00e3o da Malha Refinada para a Grosseira \n\n \n\nEsta etapa do multigrid \u00e9 usualmente denominada de esquema de restri\u00e7\u00e3o ou \n\ninterpola\u00e7\u00e3o (BRIGGS et al., 2000; TROTTENBERG et al., 2001). Mas ao contr\u00e1rio do que \n\nvale para a maioria dos m\u00e9todos multigrid tradicionais, elas n\u00e3o se aplicam muito bem no \n\nm\u00e9todo multigrid utilizado. A raz\u00e3o \u00e9 que no ACM n\u00e3o \u00e9 realizada nenhuma transfer\u00eancia de \n\ninforma\u00e7\u00e3o de vari\u00e1veis prim\u00e1rias das malhas refinadas para as grosseiras. Em vez disso, \n\ncomo demonstrado na se\u00e7\u00e3o anterior, s\u00e3o passados apenas os valores dos coeficientes e dos \n\nres\u00edduos das equa\u00e7\u00f5es da malha refinada para serem somados em cada c\u00e9lula, em um processo \n\nde transfer\u00eancia de dados computacionalmente bastante simplificado. \n\n \n\n \n\n6.3. Tipos de Ciclos Multigrid \n  \n\n Normalmente a utiliza\u00e7\u00e3o de duas malhas apenas \u2013 uma refinada e outra grosseira \u2013 \n\nn\u00e3o \u00e9 suficiente para acelerar a converg\u00eancia da solu\u00e7\u00e3o, pois podem existir ainda outros erros \n\n\n\n92 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nde baixa freq\u00fc\u00eancia3 que n\u00e3o est\u00e3o sendo eliminados na malha grosseira utilizada. Assim, \u00e9 \n\ncomum empregar diversas malhas grosseiras de tal forma que possam ser eliminados a maior \n\nparte dos diferentes modos de freq\u00fc\u00eancia dos erros. A ordem como essas diferentes malhas \n\ns\u00e3o resolvidas define um \u201cciclo\u201d do multigrid, que pode ser do tipo flex\u00edvel ou fixo. \n\nOs ciclos flex\u00edveis caracterizam-se por sempre iterar o solver-base depois dos \n\nprocedimentos de restri\u00e7\u00e3o e prolonga\u00e7\u00e3o. Em fun\u00e7\u00e3o da taxa de converg\u00eancia obtida, o \n\nalgoritmo arbitra entre: passar para uma malha mais grosseira, ficar iterando no n\u00edvel atual, ou \n\nretornar para uma malha mais refinada. O n\u00famero de \u201cvarridas\u201d do solver \u00e9, portanto, vari\u00e1vel \n\nem cada malha. A principal dificuldade associada ao uso deste tipo de ciclo \u00e9 o \n\nestabelecimento de crit\u00e9rios adequados e gerais para a tomada de decis\u00e3o quanto \u00e0 \n\nnecessidade de mudan\u00e7a de malha.  \n\nOs ciclos fixos, por sua vez, s\u00e3o constru\u00eddos definindo-se previamente a seq\u00fc\u00eancia das \n\ndiferentes malhas utilizadas e o n\u00famero de \u201cvarridas\u201d do solver em cada uma delas. Os ciclos \n\nfixos mais utilizados s\u00e3o os ciclos V, W e F, e que s\u00e3o ilustrados na Fig. 6.3 para diferentes \n\nn\u00edveis (quantidade de malhas utilizadas). Note que os tr\u00eas ciclos s\u00e3o id\u00eanticos para os casos \n\nem que se t\u00eam apenas dois n\u00edveis. Com tr\u00eas n\u00edveis os ciclos W e F ainda s\u00e3o id\u00eanticos, \n\nenquanto que para os demais casos os tr\u00eas ciclos s\u00e3o completamente distintos. As \n\nconfigura\u00e7\u00f5es de cada ciclo para quantidades de n\u00edveis maiores que as apresentadas na Fig. \n\n6.3 podem ser obtidas seguindo-se a mesma regra de forma\u00e7\u00e3o mostrada. \n\nNo ciclo V o esfor\u00e7o computacional \u00e9 despendido na mesma propor\u00e7\u00e3o para resolver o \n\nsistema linear em cada uma das diferentes malhas, enquanto que nos ciclos W e F a maior \n\nparte do trabalho \u00e9 dedicada nas malhas grosseiras. Como as solu\u00e7\u00f5es das malhas grosseiras \n\ns\u00e3o obtidas mais rapidamente, o multigrid que utiliza os ciclos W e F tem demonstrado ser \n\nmais r\u00e1pido do que o multigrid que utiliza o ciclo V (ELIAS, 1993; RAW, 1996). \n\nIndependentemente do ciclo adotado, no entanto, normalmente \u00e9 utilizado um solver direto \n\npara obter a solu\u00e7\u00e3o na malha mais grosseira (destacada com um quadrado na Fig. 6.3), uma \n\nvez que o sistema linear desta malha \u00e9 bem menor. \n\n \n\n \n\n                                                 \n3 Como j\u00e1 foi comentado no Cap. 2, durante um processo iterativo o erro embutido em uma solu\u00e7\u00e3o pode ser \ndecomposto em modos de alta e baixa freq\u00fc\u00eancias. Em uma dada malha, apenas os erros com comprimento de \nonda equivalente \u00e0s dimens\u00f5es de seus volumes de controle s\u00e3o reduzidos eficientemente com os m\u00e9todos \niterativos ponto a ponto. Os erros de menor freq\u00fc\u00eancia geralmente causam estagna\u00e7\u00e3o do solver. \n\n\n\n CAP. 6 \u2013 M\u00c9TODO MULTIGRID 93 \n\n \n\n \n\n \n \n\nFig. 6.3 - Ciclos multigrid com diferentes n\u00fameros de n\u00edveis (quantidade de malhas), onde n indica o n\u00famero do \n\nn\u00edvel \n\n \n\n \n\nPortanto, resumindo a Fig. 6.3, pode-se dizer que cada vez que o n\u00edvel aumenta, isto \u00e9, \n\nquando o valor de n \u00e9 incrementado, tem-se a opera\u00e7\u00e3o de restri\u00e7\u00e3o ou transfer\u00eancia de \n\ninforma\u00e7\u00e3o da malha refinada para as grosseiras (se\u00e7\u00e3o 6.3), enquanto que cada vez que o \n\nn\u00edvel diminui tem-se a solu\u00e7\u00e3o das equa\u00e7\u00f5es das malhas grosseiras (se\u00e7\u00e3o 6.2) seguido da \n\nopera\u00e7\u00e3o de prolonga\u00e7\u00e3o ou transfer\u00eancia de informa\u00e7\u00e3o das malhas grosseiras para a refinada \n\n(se\u00e7\u00e3o 6.1).  \n\n \n\n \n\n6.4. Forma\u00e7\u00e3o da Malha Grosseira \n  \n\n A efici\u00eancia do m\u00e9todo multigrid depende decisivamente da forma como os volumes \n\nde controle s\u00e3o aglomerados para a forma\u00e7\u00e3o das malhas grosseiras. Como um mesmo valor \n\nde corre\u00e7\u00e3o \u00e9 aplicado a todos os componentes de uma c\u00e9lula da malha grosseira, o ideal seria \n\ncompor c\u00e9lulas grosseiras com volumes de controle que apresentassem vari\u00e1veis cujos valores \n\ndevam ser atualizados aproximadamente com corre\u00e7\u00f5es de mesma magnitude. Isso indica que \n\ndeveria ser evitada a inclus\u00e3o, em uma mesma c\u00e9lula grosseira, de volumes de controle que \n\n\n\n94 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nvenham a ter valores das inc\u00f3gnitas demasiadamente diferentes, como por exemplo, aqueles \n\nseparados por falha geol\u00f3gica. Esse cuidado \u00e9 importante porque ser\u00e1 dif\u00edcil encontrar um \n\nvalor \u00fanico de corre\u00e7\u00e3o da press\u00e3o que seja uma boa estimativa para volumes de controle que \n\nestejam de um lado e de outro da falha (o primeiro pode ter um alto valor de press\u00e3o e com \n\ntend\u00eancia de aumentar ainda mais, enquanto que o segundo pode ter um valor baixo de \n\npress\u00e3o e com uma menor tend\u00eancia de aumentar ou at\u00e9 diminuir).  \n\nUm crit\u00e9rio baseado na an\u00e1lise do valor dos coeficientes pode ser um bom indicativo \n\npara nortear o processo de aglomera\u00e7\u00e3o. Se o coeficiente entre dois volumes de controle  i e j, \n\npor exemplo, tiver um valor muito pequeno em compara\u00e7\u00e3o ao coeficiente dos volumes de \n\ncontrole j e k, \u00e9 muito prov\u00e1vel que os valores esperados da fun\u00e7\u00e3o calculada em j e k sejam \n\nmuito mais pr\u00f3ximos entre si que os valores da fun\u00e7\u00e3o em i e j. Assim, os volumes  j e k  \n\nseriam mais indicados para estarem presentes em uma mesma c\u00e9lula da malha grosseira do \n\nque os volumes i e j. \n\nAl\u00e9m disso, um esquema de aglomera\u00e7\u00e3o baseado no valor dos coeficientes pode \n\ncontribuir para a redu\u00e7\u00e3o das diferen\u00e7as das escalas de tempo da propaga\u00e7\u00e3o da informa\u00e7\u00e3o \n\npelo solver (ELIAS et al., 1997). Essas diferen\u00e7as surgem em fun\u00e7\u00e3o da anisotropia dos \n\ncoeficientes e geralmente causam a estagna\u00e7\u00e3o do solver. Por estas raz\u00f5es, optou-se neste \n\ntrabalho em adotar este esquema deste tipo. \n\nA an\u00e1lise dos coeficientes baseia-se essencialmente em duas etapas. Na primeira, \n\nexamina-se se um volume vizinho a uma c\u00e9lula tem condi\u00e7\u00f5es de ser aglomerado. Se sim, na \n\nsegunda etapa examina-se se existir\u00e1 outra c\u00e9lula tamb\u00e9m vizinha \u00e0quele volume que tem \n\nmelhores condi\u00e7\u00f5es de aglomer\u00e1-lo. \n\n Essas etapas podem ser matematicamente expressas atrav\u00e9s de duas regras de an\u00e1lise \n\ndos coeficientes da matriz: \n\n \n\n Regra 1: ( ) ( ), , , ,max , max ,i P P i i h h iA A A A??  (6.12) \n\n Regra 2: ( ) ( )\n( ), , , ,  de \n\nmax , max max ,i P P i P nb nb P nb P IA A A A? ?\n? ?? ? ?  (6.13) \n\n \n\nonde ?  \u00e9 uma constante. O valor de 1/ 2? =  funcionou bem nos problemas testados e, por \n\nisso, \u00e9 o valor utilizado neste trabalho. Os sub-\u00edndices P, i, h e nb representam volumes de \n\ncontrole tais quais os mostrados na Fig. 6.4, definidos de tal forma que P \u00e9 o \u00edndice do volume \n\nde controle que se deseja agrupar a uma c\u00e9lula I , h representa um volume de controle de \n\nrefer\u00eancia dentro da c\u00e9lula, i \u00e9 o volume vizinho de P localizado dentro da c\u00e9lula I, e nb \n\n\n\n CAP. 6 \u2013 M\u00c9TODO MULTIGRID 95 \n\n \n\n \n\nrepresenta todos os volumes de controle vizinhos a P localizados fora da c\u00e9lula, inclusive \n\naqueles n\u00e3o nomeados com \u201cnb\u201d na figura, mas que s\u00e3o evidentes em fun\u00e7\u00e3o do processo de \n\ndiscretiza\u00e7\u00e3o das equa\u00e7\u00f5es adotado.  \n\n \n\n \n\n \n\nFig. 6.4 - Volumes de controle de interesse no processo de forma\u00e7\u00e3o da c\u00e9lula grosseira I \n\n  \n\n \n\n\u00c9 importante notar que os termos relacionados ao fluxo advectivo que s\u00e3o calculados \n\npor fun\u00e7\u00f5es upwind \u2013 UDS originam coeficientes assim\u00e9tricos, isto \u00e9, ,i PA  normalmente \u00e9 \n\nmuito diferente de ,P iA , criando conex\u00f5es muito fortes em um sentido e muito fracas no outro. \n\nMas isso n\u00e3o adiciona dificuldades no processo de aglomera\u00e7\u00e3o porque as regras 1 e 2, Eqs. \n\n(6.12) e (6.13), baseiam-se no maior valor destes coeficientes. \n\nEmbora a utiliza\u00e7\u00e3o dessas regras assegure que sejam agrupados volumes de controle \n\nque tenham coeficientes de mesma ordem, elas n\u00e3o produzem uma \u00fanica solu\u00e7\u00e3o e n\u00e3o \n\nasseguram que a efici\u00eancia do solver seja maximizada. Deve-se adotar ainda outros crit\u00e9rios \n\npara evitar, por exemplo, a cria\u00e7\u00e3o de c\u00e9lulas com raz\u00e3o de aspecto muito ruim (c\u00e9lulas muito \n\ncompridas, por exemplo). Isso, al\u00e9m de causar anisotropia nos coeficientes das malhas \n\ngrosseiras, tamb\u00e9m aumenta o n\u00famero de conex\u00f5es nas matrizes. Assim, para assegurar que \n\nas c\u00e9lulas formadas tenham uma boa raz\u00e3o de aspecto (o mais \u201credondo\u201d poss\u00edvel), deve-se \n\nchecar, juntamente com as duas regras, se o volume a ser aglomerado j\u00e1 tem dois ou mais \n\nvizinhos na c\u00e9lula. Se ele tiver, provavelmente ser\u00e1 um bom candidato a ser aglomerado \n\nporque contribuir\u00e1 para manter a boa raz\u00e3o de aspecto da c\u00e9lula grosseira. \n\n A despeito da defini\u00e7\u00e3o do n\u00famero m\u00e1ximo e m\u00ednimo de volumes a serem \n\naglomerados em cada c\u00e9lula, pode ocorrer ainda que algum volume fique isolado depois do \n\n\n\n96 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nprocesso de aglomera\u00e7\u00e3o. Neste caso, ele \u00e9 inserido na c\u00e9lula grosseira que contiver o vizinho \n\nde maior coeficiente. \n\n Este algoritmo \u00e9 utilizado recursivamente para formar todos os n\u00edveis de malha. O \n\n\u00faltimo n\u00edvel ser\u00e1 aquele que tiver um n\u00famero de c\u00e9lulas menor que um valor definido pelo \n\nusu\u00e1rio (50, neste trabalho).  \n\n \n\nInforma\u00e7\u00f5es Adicionais sobre a Aglomera\u00e7\u00e3o no EbFVM. \u00c9 importante observar \n\nque, devido \u00e0 escolha das fun\u00e7\u00f5es de forma na discretiza\u00e7\u00e3o espacial das equa\u00e7\u00f5es \n\ndiferenciais no EbFVM, o esquema de aglomera\u00e7\u00e3o adotado poder\u00e1 reunir em uma mesma \n\nc\u00e9lula volumes de controle que, efetivamente, n\u00e3o s\u00e3o vizinhos. Esta situa\u00e7\u00e3o est\u00e1 \n\nrepresentada na Fig. 6.5, onde percebe-se que a malha grosseira formada por tr\u00eas c\u00e9lulas, Fig. \n\n6.5c, possui duas delas, C\u00e9lulas 1 e 2, compostas cada uma por duas partes. Cada uma destas \n\npartes corresponde a volumes de controle que possuem uma \u201cconex\u00e3o\u201d, isto \u00e9, um coeficiente \n\nentre a c\u00e9lula e o n\u00e3o-vizinho forte o suficiente para justificar a op\u00e7\u00e3o de inclu\u00ed-lo na c\u00e9lula, \n\nde acordo com as regras de aglomera\u00e7\u00e3o apresentadas na se\u00e7\u00e3o anterior. Normalmente este \n\ncoeficiente \u00e9 denominado de coeficiente cruzado. \n\n \n\n \n\n \n \n\nFig. 6.5 - Ilustra\u00e7\u00e3o do processo de forma\u00e7\u00e3o das malhas grosseiras destacando a possibilidade da presen\u00e7a de \n\nvolumes \u201cn\u00e3o-vizinhos\u201d nas c\u00e9lulas \n\n\n\n CAP. 6 \u2013 M\u00c9TODO MULTIGRID 97 \n\n \n\n \n\nPortanto, o conceito tradicional utilizado em malhas estruturadas de que \u201cvolumes de \n\ncontrole vizinhos\u201d devem necessariamente compartilhar uma interface comum de passagem \n\ndo fluido, e em conseq\u00fc\u00eancia terem um coeficiente de conex\u00e3o na matriz, n\u00e3o se aplica no \n\nEbFVM, onde dois volumes ser\u00e3o considerados vizinhos bastando que exista um coeficiente \n\nn\u00e3o-nulo entre eles na matriz dos coeficientes, independentemente de sua disposi\u00e7\u00e3o espacial. \n\n \n\n   \n\n6.5. Implementa\u00e7\u00e3o Computacional do Multigrid \n \n\n O solver multigrid foi implementado em C++ utilizando os conceitos de programa\u00e7\u00e3o \n\norientada a objetos, polimorfismo, templates etc. (JOSUTTIS, 1999; STROUSTRUP, 2000). \n\nEmbora se reconhe\u00e7a que este estilo de programa\u00e7\u00e3o acaba n\u00e3o sendo mais eficiente que a \n\nprograma\u00e7\u00e3o estruturada tradicional, a sua escolha se justifica, pois o aplicativo criado torna-\n\nse mais facilmente leg\u00edvel, com grande potencial de manuten\u00e7\u00e3o e reaproveitamento.  \n\n A id\u00e9ia central da implementa\u00e7\u00e3o \u00e9 tornar cada um dos n\u00edveis de malha um objeto \n\ncomposto de matrizes, vetores e escalares. Assim, cada n\u00edvel ter\u00e1 a sua pr\u00f3pria matriz de \n\ncoeficientes (no formato comprimido), seu vetor de termos independentes e vetor solu\u00e7\u00e3o. \n\nUm outro vetor muito importante, e que deve estar presente em cada um destes objetos, \u00e9 o \n\nvetor coarse. Ele \u00e9 o resultado do processo de aglomera\u00e7\u00e3o e \u00e9 fundamental na constru\u00e7\u00e3o da \n\nmatriz de coeficientes do n\u00edvel grosseiro mais imediato. Este vetor relaciona cada volume de \n\ncontrole \u00e0 c\u00e9lula em que est\u00e1 contido. A Fig. 6.6 ilustra o papel desempenhado pelo vetor \n\ncoarse, apresentando a disposi\u00e7\u00e3o e numera\u00e7\u00e3o dos n\u00f3s de uma determinada malha e as \n\nc\u00e9lulas grosseiras formadas. \n\nO solver multigrid foi desenvolvido de uma forma geral para resolver tamb\u00e9m \n\nsistemas de blocos, isto \u00e9, aqueles em que cada termo da matriz de coeficientes \u00e9 uma sub-\n\nmatriz. Nestes casos, cada um dos sistemas lineares dos n\u00edveis grosseiros tamb\u00e9m \u00e9 composto \n\npor matrizes de blocos, e seu processo de forma\u00e7\u00e3o segue as mesmas premissas aplicadas aos \n\nsistemas sem blocos (Se\u00e7\u00e3o 6.4). Deve-se, no entanto, definir qual ser\u00e1 o par\u00e2metro utilizado \n\nno exame do volume de controle que tem a conex\u00e3o \u201cmais forte\u201d e que, portanto, dever\u00e1 fazer \n\nparte de um mesmo bloco na malha grosseira. A Eq. (6.14) ilustra os diferentes coeficientes \n\npresentes em cada sub-matriz que podem ser combinados a fim de produzir um n\u00famero \n\nrepresentativo das conex\u00f5es fortes. Este \u00e9 o formato do sistema linear com matriz de blocos \n\nquando a solu\u00e7\u00e3o das equa\u00e7\u00f5es \u00e9 totalmente impl\u00edcita. \n\n\n\n98 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n        \n\nFig. 6.6 - Ilustra\u00e7\u00e3o da informa\u00e7\u00e3o armazenada no vetor coarse \n\n  \n\n \n\n \n\n1 1 1 1\n\n1 1 1 1\n\n1 1\n\n1 1\n\n1 1\n\n1 1\n\nn n n n\n\nn n n n\n\nT T T T\n\nw n wn\n\nw w w w\n\nw n wn\n\nT T T T\n\nw n wn\n\nw w w w\n\nw n wn\n\nR R R R\np s p s\n\nR R R R\np s p s\n\nR R R R\np s p s\n\nR R R R\np s p s\n\n? ? ? ?? ?? ? ? ?\n? ?? ? ? ?? ? ? ?? ?? ? ? ?\n? ? ? ? ?? ? ? ?? ? ? ? ?\n? ? ? ? ?? ? ? ?? ? ? ?\n?\n?\n? ? ? ? ?? ? ? ?\n?? ? ? ?? ? ? ??? ? ? ?\n?? ? ? ?? ? ? ??? ? ? ??? ? ? ?? ? ? ?? ? ? ?? ?\n\n\u2026\n1\n\n1\n\n1\n\n1\n\nn\n\nn\n\nT\n\nww\n\nn T\n\nwn w\n\nRp\nRs\n\np R\ns R\n\n? ? ?? ?? ? ? ? ?? ?? ? ?? ?? ?? ??? ? ?? ?? ? ? ?? ?\n? ? ? ?? = ?? ? ? ??\n? ? ? ?? ?? ? ? ?? ?? ? ? ?? ? ? ? ?? ? ? ??? ? ?? ? ? ?? ?? ??\n?\n?\n\n (6.14) \n\n \n\nNeste trabalho, optou-se, no processo de aglomera\u00e7\u00e3o, por analisar simplesmente a \n\nmagnitude do coeficiente da equa\u00e7\u00e3o da press\u00e3o que multiplica p? , isto \u00e9, o valor de /T pR ??  \n\nem cada bloco. Esta escolha foi pautada no fato de que a equa\u00e7\u00e3o da press\u00e3o \u00e9 a equa\u00e7\u00e3o que \n\nexpressa a conserva\u00e7\u00e3o global, e por isso \u00e9 mais representativa do que a equa\u00e7\u00e3o da \n\n\n\n CAP. 6 \u2013 M\u00c9TODO MULTIGRID 99 \n\n \n\n \n\nconserva\u00e7\u00e3o da \u00e1gua. J\u00e1 a escolha do coeficiente que multiplica p?  nesta equa\u00e7\u00e3o deve-se \u00e0 \n\npresen\u00e7a direta da press\u00e3o no termo de fluxo e n\u00e3o da satura\u00e7\u00e3o, que est\u00e1 presente diretamente \n\napenas no termo transiente das equa\u00e7\u00f5es de conserva\u00e7\u00e3o. \n\nO armazenamento computacional do sistema linear de blocos \u00e9 feito de uma forma \n\nparecida com o armazenamento dos sistemas sem blocos. A diferen\u00e7a \u00e9 que os vetores de \n\nlinhas e colunas  passam a referenciar os blocos, e cada coeficiente presente nos blocos s\u00e3o \n\narmazenados em vetores de (1x4) como ilustra a Fig. 6.7. Essa \u00e9 uma forma geral que permite \n\nutilizar a mesma estrutura do multigrid independentemente da forma do sistema linear.  \n\n \n\n \n\n \n\nFig. 6.7 - Ilustra\u00e7\u00e3o do armazenamento de matrizes de blocos no multigrid \n\n \n \n\nO esquema de armazenamento de sistemas de blocos apresentado na Fig. 6.7 \u00e9 \n\nimprescind\u00edvel para tornar geral o processo de forma\u00e7\u00e3o dos diversos n\u00edveis e facilitar a \n\nimplementa\u00e7\u00e3o das opera\u00e7\u00f5es de determina\u00e7\u00e3o das malhas grosseiras e de suas matrizes de \n\ncoeficientes. Por\u00e9m, para que fosse poss\u00edvel a solu\u00e7\u00e3o dos sistemas lineares de cada n\u00edvel \n\nutilizando esta estrutura de dados, foi necess\u00e1rio adaptar as rotinas dos solvers-base Gauss-\n\nSeidel e ILU(0) para a resolu\u00e7\u00e3o de sistemas de blocos. Os testes preliminares mostraram que \n\nos solvers-base tornaram-se demasiadamente lentos com esta adapta\u00e7\u00e3o, em rela\u00e7\u00e3o \u00e0 sua \n\nimplementa\u00e7\u00e3o padr\u00e3o de solu\u00e7\u00e3o de sistemas lineares com matrizes no formato de linha \n\ncomprimida (Compressed Sparse Row). Suspeita-se que isto seja em raz\u00e3o da quantidade \n\n\n\n100 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nenorme de operadores l\u00f3gicos do tipo if-else, la\u00e7os do tipo for-end que s\u00e3o necess\u00e1rios para as \n\nvarridas dentro dos blocos da matriz de coeficientes. \n\n A solu\u00e7\u00e3o encontrada foi criar, a partir da matriz de blocos da Fig. 6.7, um segundo \n\narmazenamento do sistema linear para cada n\u00edvel no formato de linha comprimida (Fig. 5.3), \n\nque n\u00e3o identifica mais os blocos. Como isso \u00e9 feito apenas uma vez no in\u00edcio da solu\u00e7\u00e3o do \n\nmultigrid (imediatamente ap\u00f3s a defini\u00e7\u00e3o dos sistemas lineares de cada n\u00edvel grosseiro), o \n\ntempo despendido neste processo \u00e9 compensado pela rapidez conseguida pelo solver, que \u00e9 \n\nchamado in\u00fameras vezes nos diferentes n\u00edveis de malhas grosseiras. \n\n Detalhes adicionais sobre a implementa\u00e7\u00e3o do solver multigrid podem ser obtidos nos \n\nfluxogramas apresentados no Anexo 6, que resumem todas as rotinas empregadas. \n\n\n\n101 \n\nCap.    \n\n7 \nAASS  \u201c\u201cTTRRAANNSSMMIISSSSIIBBIILLIIDDAADDEESS\u201d\u201d    \nNNEEGGAATTIIVVAASS  EEMM  MMAALLHHAASS  TTRRIIAANNGGUULLAARREESS    \n\n \n\n \nO objetivo deste cap\u00edtulo \u00e9 estudar e esclarecer o problema do aparecimento de \n\ntransmissibilidades negativas (FUNG et al., 1993; SONIER et al., 1993), que ocorre quando \n\ndeterminados tipos de elementos triangulares s\u00e3o utilizados. Esse \u00e9 um assunto pertinente, \n\nporque advoga-se que deve ser evitado o uso de malhas que resultem na cria\u00e7\u00e3o destes \n\ntermos. Para este estudo, inicialmente s\u00e3o revisados alguns conceitos importantes relativos \u00e0s \n\ntransmissibilidades, sendo na seq\u00fc\u00eancia estudada a sua aplica\u00e7\u00e3o em malhas que utilizam \n\ntri\u00e2ngulos.  \n\n \n\n \n\n7.1. A Origem do Conceito de Transmissibilidade \n \n\nO termo transmissibilidade tem sido utilizado exaustivamente na ind\u00fastria do petr\u00f3leo \n\ne teve sua origem na utiliza\u00e7\u00e3o de malhas estruturadas ortogonais, onde o c\u00e1lculo do fluxo \u00e9 \n\nrealizado a partir da informa\u00e7\u00e3o armazenada em dois pontos (MALISKA et al., 2001; \n\nCORDAZZO et al., 2002). Mesmo no caso de malhas estruturadas n\u00e3o-ortogonais, como o \n\ncaso mostrado na Fig. 7.1, quando o fluxo n\u00e3o pode ser calculado corretamente a partir de \n\ndois valores nodais apenas, o conceito de transmissibilidade continua sendo utilizado, pois os \n\nfluxos transversais s\u00e3o desprezados por serem pequenos em rela\u00e7\u00e3o ao fluxo na dire\u00e7\u00e3o \n\nprincipal.  \n\n \n\n \n\nFig. 7.1 - Volumes de controles de uma malha n\u00e3o\u2013ortogonal destacando os dois pontos utilizados no c\u00e1lculo do \n\nfluxo \n\n\n\n102 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nNo conceito tradicional do c\u00e1lculo do fluxo a partir de dois pontos, a vaz\u00e3o \n\nvolum\u00e9trica de um componente entre dois volumes adjacentes j e k em uma solu\u00e7\u00e3o discreta \n\ndas equa\u00e7\u00f5es de transporte \u00e9 dado por  \n\n \n\n( ) ( )\n1\n\nmN\njk\n\njk m k jjk m\nm jk\n\nS\nq k p p\n\nd\n?\n\n=\n\n= ??  (7.1) \n\n \n\nonde m?  \u00e9 a mobilidade da fase m, Nm \u00e9 o n\u00famero de fases, k \u00e9 a permeabilidade absoluta, Sjk \n\numa \u00e1rea de passagem do fluxo, djk uma dist\u00e2ncia adequada para o c\u00e1lculo do gradiente na \n\nface e p \u00e9 a press\u00e3o. Nesta express\u00e3o as grandezas que s\u00e3o dependentes da geometria e do \n\nmeio podem ser agrupadas na forma \n\n \n\n ( ) ( )\n1\n\nmN\n\njk jk m k jjk m\nm\n\nq T p p?\n=\n\n= ??  (7.2)  \n\n \n\nonde Tjk \u00e9 denominada de transmissibilidade que, portanto, \u00e9 assim definida  \n\n    \n\njk\njkjk\n\njk\n\nS\nT k\n\nd\n=  (7.3)  \n\n \n\nAs transmissibilidades s\u00e3o calculadas apenas no in\u00edcio da simula\u00e7\u00e3o, n\u00e3o tendo seus \n\nvalores alterados ao longo do tempo quando a malha \u00e9 fixa e a permeabilidade absoluta \u00e9 \n\nconstante, que \u00e9 a situa\u00e7\u00e3o mais comum. A sua utiliza\u00e7\u00e3o pr\u00e1tica na engenharia de petr\u00f3leo \u00e9 \n\nmuito conveniente porque as falhas geol\u00f3gicas, citando apenas um exemplo, podem ser \n\nfacilmente modeladas alterando-se os valores das transmissibilidades. Em um caso extremo \n\nde falha selante localizada na face que separa dois blocos, a transmissibilidade entre eles \u00e9 \n\ntomada como zero. O mesmo conceito \u00e9 empregado em outras \u00e1reas da engenharia, como o de \n\ncondut\u00e2ncia em transfer\u00eancia de calor, por exemplo. \n\n \n\n \n\n \n\n \n\n\n\n CAP.  7 \u2013 AS \u201cTRANSMISSIBILIDADES\u201d NEGATIVAS EM MALHAS TRIANGULARES 103 \n\n \n\n \n\n7.2. A Transmissibilidade em Malhas Triangulares \n \n\n Como visto, o conceito de transmissibilidade surgiu com a utiliza\u00e7\u00e3o do c\u00e1lculo do \n\nfluxo em uma determinada face a partir dos dados relativos a apenas dois pontos. Uma \n\nquest\u00e3o consiste, portanto, em verificar se esta defini\u00e7\u00e3o \u00e9 apropriada quando s\u00e3o utilizados \n\nelementos triangulares. A estrat\u00e9gia para obter a resposta deve ser a mesma utilizada para a \n\ndefini\u00e7\u00e3o tradicional da transmissibilidade apresentada na se\u00e7\u00e3o anterior, isto \u00e9, analisar a \n\nexpress\u00e3o discretizada do fluxo entre os volumes de controle. \n\n \n\n \n\n \n\nFig. 7.2 - Elemento triangular composto por tr\u00eas sub-volumes de controle (Svc) \n\n \n\n \n\nEmbora o m\u00e9todo EbFVM tenha sido deduzido no Cap. 5 de uma forma aplic\u00e1vel para \n\nelementos triangulares e quadrangulares, as equa\u00e7\u00f5es para elementos triangulares podem ser \n\ndeduzidas de um modo um pouco diferente, valendo-se do fato de que s\u00e3o utilizadas fun\u00e7\u00f5es \n\nde forma lineares nestes elementos. No Anexo 7 \u00e9 mostrada esta dedu\u00e7\u00e3o alternativa, mais \n\napropriada para a discuss\u00e3o das quest\u00f5es neste cap\u00edtulo. Pode-se mostrar, por exemplo, que o \n\nfluxo volum\u00e9trico na face que separa os sub-volumes de controle 1 e 2 da Fig. 7.2 \u00e9 dado por \n\n \n\n( ) ( )2 1 3 112 12 12 13AB ABp p p pq ? ? ?? ?? ?= +? ?  (7.4)  \n\n \n\nsendo este o fluxo que atravessa o segmento AB desta figura. O fluxo que passa pelo \n\nsegmento BC, por sua vez, \u00e9 dado por \n\n\n\n104 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n( ) ( )3 1 2 113 13 13 12BC BCp p p pq ? ? ?? ?? ?= +? ?  (7.5)  \n\n \n\nonde 12?  \u00e9 a mobilidade da superf\u00edcie AB que separa os volumes 1 e 2, e assim por diante. \n\nQuanto aos termos ?  destas equa\u00e7\u00f5es, os sub-\u00edndices 12 e 13 indicam que se tratam de \n\ncoeficientes que multiplicam as parcelas (p2 \u2013 p1) e (p3 \u2013 p1), respectivamente, enquanto que \n\nos super-\u00edndices AB e BC indicam que o termo teve origem no c\u00e1lculo do fluxo nas interfaces \n\ndos sub-volumes \u201c1 e 2\u201d e \u201c1 e 3\u201d, respectivamente. \n\nNota-se que os fluxos que est\u00e3o cruzando as faces AB e BC n\u00e3o podem mais ser \n\ncalculados exatamente utilizando-se apenas dois pontos, como \u00e9 poss\u00edvel com malhas \n\nestruturadas ortogonais, pois na modelagem mais simples com elementos triangulares utiliza-\n\nse uma fun\u00e7\u00e3o de forma que envolve os valores dos tr\u00eas n\u00f3s, definindo portanto um \u00fanico \n\nplano dentro do qual a press\u00e3o s\u00f3 pode variar linearmente1. Analisando-se a ordem de \n\ngrandeza dos termos da Eq. (7.4) pode-se verificar que, de uma forma geral, o coeficiente 12\nAB?  \n\nn\u00e3o \u00e9 excessivamente maior que o outro coeficiente ( 13\nAB? ), de modo que este \u00faltimo pudesse \n\nser omitido, resultando em uma express\u00e3o do fluxo calculado apenas por dois pontos. Ou seja, \n\nn\u00e3o \u00e9 uma quest\u00e3o de n\u00e3o-ortogonalidade da malha que, quando a ortogonalidade \u00e9 pequena, \n\ndespreza-se a parcela do fluxo devido a n\u00e3o ortogonalidade e ent\u00e3o pode-se definir a \n\ntransmissibilidade, pois apenas dois pontos passam a fazer parte no c\u00e1lculo do fluxo. \n\nSomando-se as Eqs. (7.4) e (7.5), tem-se para o fluxo total no sub-volume de controle \n\n1 uma express\u00e3o muito parecida com a obtida em malhas estruturadas, \n\n  \n\n( ) ( )1 13 3 1 12 2 1q p p p p= ? ? + ? ?  (7.6)           \n\n \n\nonde \n\n13 12 13 13 13\nAB BC? ? ? ?? = +  (7.7)  \n\n12 12 12 13 12\nAB BC? ? ? ?? = +  (7.8)  \n\n  \n\n \n\n                                                 \n1 A utiliza\u00e7\u00e3o de fun\u00e7\u00f5es de forma lineares, como as utilizadas nesta dedu\u00e7\u00e3o, \u00e9 o procedimento usual em se \ntratando de malhas triangulares (HUGHES, 1987). A utiliza\u00e7\u00e3o de fun\u00e7\u00f5es de forma mais complexas \n(quadr\u00e1ticas, c\u00fabicas etc.) foge ao escopo deste trabalho. \n\n\n\n CAP.  7 \u2013 AS \u201cTRANSMISSIBILIDADES\u201d NEGATIVAS EM MALHAS TRIANGULARES 105 \n\n \n\n \n\nComparando-se as Eqs. (7.4) e (7.5) com (7.6), tem-se para os fluxos que cruzam cada \n\ninterface da Fig. 7.2 uma interpreta\u00e7\u00e3o bastante distinta daquela obtida em malhas \n\nestruturadas: \n \n\n \n\n \n \n\n                     \n \n\npois 13?  e 12?  n\u00e3o s\u00e3o parcelas relacionadas apenas aos segmentos AB e BC, \n\nrespectivamente. O fluxo que passa pelo segmento AB \u00e9 dado pela Eq. (7.4) e o fluxo que \n\npassa pelo segmento BC \u00e9 dado pela Eq. (7.5). Portanto, inspecionando-se as Eqs. (7.2) e (7.3)\n\nque definem as transmissibilidades, chega-se a uma segunda conclus\u00e3o importante: \n\n \n\n13?          e          12?  \n \n\n \n\n \n \n\nPor isso, usou-se o s\u00edmbolo jk?  nesta express\u00e3o, e n\u00e3o jkT  como na literatura. \n\nLogo, n\u00e3o \u00e9 mais poss\u00edvel identificar a transmissibilidade em malhas triangulares e, \n\npor isso, n\u00e3o h\u00e1 nenhuma raz\u00e3o f\u00edsica que impe\u00e7a que os coeficientes da Eq. (7.6) sejam \n\nnegativos, contrariamente ao que \u00e9 mencionado em alguns trabalhos da literatura de \n\nsimula\u00e7\u00e3o de reservat\u00f3rios. Esta conclus\u00e3o independe do n\u00famero de fases do problema, pois \n\nmesmo no caso monof\u00e1sico, quando a mobilidade \u00e9 igual \u00e0 unidade nas Eqs. (7.4) e (7.5), \n\npara que o fluxo seja corretamente calculado \u00e9 preciso usar tr\u00eas pontos.  \n\nN\u00c3O \u00e9 o \nfluxo que \npassa pelo \nsegmento \n\nAB ! \n\nN\u00c3O \u00e9 o \nfluxo que \npassa pelo \nsegmento \n\nBC ! \n\nN\u00c3O S\u00c3O \nTRANSMISSIBILIDADES ! \n\n( ) ( )1 13 3 1 12 2 1q p p p p= ? ? + ? ?  \n\n\n\n106 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n\u00c9 importante mencionar tamb\u00e9m que a express\u00e3o utilizada em outros trabalhos \n\n(FUNG et al., 1991) \n\n \n\n4\nxx i j xy j i yx j i yy i j\n\nij\n\nk bb k a b k b a k a a\nA\n\n+ + +? ?\n? = ?? ?\n\n? ?\n (7.9) \n\n \n\ns\u00f3 \u00e9 aplic\u00e1vel em escoamentos monof\u00e1sicos e com propriedades constantes, isto \u00e9, quando as \n\nmobilidades nas Eqs. (7.7) e (7.8) s\u00e3o id\u00eanticas. \n\n No pr\u00f3ximo cap\u00edtulo \u00e9 mostrado, a partir de um exemplo pr\u00e1tico, que o coeficiente \n\nnegativo que surge em fun\u00e7\u00e3o da presen\u00e7a de \u00e2ngulos maiores que 90\u00ba tem embasamento \n\nf\u00edsico. \n\n\n\n107 \n\nCap.    \n\n8 RREESSUULLTTAADDOOSS  EE  CCOOMMPPAARRAA\u00c7\u00c7\u00d5\u00d5EESS  \n \n\n \n\n \n\n \n\nNeste cap\u00edtulo s\u00e3o apresentados os resultados de problemas-teste obtidos a partir da \n\nformula\u00e7\u00e3o desenvolvida nesta tese. Em alguns casos consideram-se reservat\u00f3rios de \n\ndimens\u00f5es f\u00edsicas bem pr\u00f3ximas daquelas verificadas nos trabalhos pr\u00e1ticos da engenharia de \n\npetr\u00f3leo, enquanto que em outros casos, por comodidade e para facilitar compara\u00e7\u00f5es, \n\nutilizam-se reservat\u00f3rios de petr\u00f3leo de dimens\u00f5es mais reduzidas, mas preservando as \n\nprincipais caracter\u00edsticas encontradas nos casos reais.  \n\nAs condi\u00e7\u00f5es de contorno utilizadas na maioria dos problemas resumem-se em \n\nfronteira imperme\u00e1vel. Dois tipos de po\u00e7os s\u00e3o considerados: injetores de \u00e1gua e produtores \n\nde \u00f3leo e \u00e1gua, simulando um processo de recupera\u00e7\u00e3o secund\u00e1ria, normalmente utilizado nos \n\ntrabalhos de campo para aumentar a recupera\u00e7\u00e3o de petr\u00f3leo. A fim de facilitar a reprodu\u00e7\u00e3o \n\npor outros pesquisadores dos casos rodados, os dados utilizados s\u00e3o apresentados ao longo do \n\ntexto ou em tabelas espec\u00edficas. \n\nEste cap\u00edtulo foi dividido em quatro partes distintas:  \n\n \n\n(1)  Valida\u00e7\u00e3o num\u00e9rica da formula\u00e7\u00e3o apresentada (se\u00e7\u00e3o 8.1);  \n\n(2) Apresenta\u00e7\u00e3o e interpreta\u00e7\u00e3o dos resultados do EbFVM e compara\u00e7\u00e3o com \n\nsoftwares comerciais (se\u00e7\u00f5es 8.2 a 8.6);  \n\n(3) An\u00e1lise do desempenho do solver multigrid em problemas de simula\u00e7\u00e3o de \n\nreservat\u00f3rios de petr\u00f3leo (se\u00e7\u00e3o 8.7); e  \n\n(4) Simula\u00e7\u00e3o de um caso pr\u00e1tico que re\u00fane grande parte dos aspectos investigados \n\ne/ou propostos nesta tese (se\u00e7\u00e3o 8.8), a fim de mostrar as suas potencialidades. \n\n\n\n108 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n8.1. Valida\u00e7\u00e3o Num\u00e9rica \n \n\nO modelo num\u00e9rico EbFVM desenvolvido ser\u00e1 validado comparando seus resultados \n\ncom uma solu\u00e7\u00e3o de refer\u00eancia. Para tanto, foi escolhido o problema unidimensional de \n\nescoamento bif\u00e1sico em meios porosos, incompress\u00edvel, com propriedades constantes, com \n\ninje\u00e7\u00e3o constante de \u00e1gua, sem press\u00e3o capilar e regido pela equa\u00e7\u00e3o de Buckley-Leverett \n\n \n\n0w wT\ns f\n\nu\nt x\n\n?\n? ?\n\n+ =\n? ?\n\n (8.1) \n\n \n\nque \u00e9 a vers\u00e3o unidimensional da Eq. (4.1) escrita de forma a explicitar o fluxo fracion\u00e1rio, \n\nwf , definido como \n\n \n\nw\nw\n\nT\n\nf\n?\n?\n\n=  (8.2) \n\n \n\nA condi\u00e7\u00e3o inicial do problema em quest\u00e3o \u00e9 ( , 0)w wis x s=  para 0 x L? ? , onde wis  \u00e9 \n\na satura\u00e7\u00e3o de \u00e1gua irredut\u00edvel e L \u00e9 a dimens\u00e3o na dire\u00e7\u00e3o axial. As condi\u00e7\u00f5es de contorno \n\ns\u00e3o fluxos prescritos: (0, )w injq t q=  e ( , )T injq L t q= ?  para 0t > . \n\nPor generalidade, as vari\u00e1veis de interesse deste problema ser\u00e3o adimensionalizadas \n\nou normalizadas, de acordo com o caso. A coordenada axial, por exemplo, ser\u00e1 \n\nadimensionalizada como \n\n \n\n/Ax x L=  (8.3) \n\n \n\ne o tempo ser\u00e1 dado em n\u00famero de volumes porosos injetados (VPI), que \u00e9 a rela\u00e7\u00e3o entre os \n\nvolumes de fluido injetado e o poroso dispon\u00edvel para este fluido escoar, dado por \n\n \n\n( )1\ninj T\n\nA\nwi or\n\nq t u t\nt\n\ns s AL L?\n= =\n\n? ?\n (8.4) \n\n \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 109 \n\n \n\n \n\nonde ors  \u00e9 a satura\u00e7\u00e3o de \u00f3leo residual e Tu  \u00e9 a velocidade total (soma das velocidades do \n\n\u00f3leo e da \u00e1gua). A satura\u00e7\u00e3o da \u00e1gua ser\u00e1 normalizada como \n\n \n\n1\nw wi\n\nwi or\n\ns s\ns\n\ns s\n?\n\n=\n? ?\n\n (8.5) \n\n \n\n As curvas de permeabilidade relativa ser\u00e3o definidas pela correla\u00e7\u00e3o de Corey \n\n \n\n( )1\nw\n\no\n\nnmax\nrw rw\n\nnmax\nro ro\n\nk k s\n\nk k s\n\n? =?\n?\n\n= ???\n (8.6) \n\n \n\nonde maxrok  e \nmax\nrwk  s\u00e3o os valores m\u00e1ximos das curvas de permeabilidades relativas adotadas e \n\ncorrespondem \u00e0s satura\u00e7\u00f5es wis  e 1w ors s= ? , respectivamente, como descrito no Cap. 3 (Fig. \n\n3.1). Na forma adimensionalizada, esses limites s\u00e3o 0s =  e 1s = . Os valores utilizados para \n\nas permeabilidades relativas limites neste problema s\u00e3o 1max maxrw rok k= = . \n\n Nesta se\u00e7\u00e3o ser\u00e3o comparados os resultados num\u00e9ricos com a solu\u00e7\u00e3o anal\u00edtica da \n\nequa\u00e7\u00e3o de Buckley-Leverett empregando diferentes configura\u00e7\u00f5es de curvas de \n\npermeabilidade relativa e raz\u00f5es de mobilidades das fases1. Diferentes curvas de \n\npermeabilidade relativa ser\u00e3o obtidas variando-se o valor dos expoentes nw e no da correla\u00e7\u00e3o \n\nde Corey. Curvas lineares correspondem a nw e no iguais a unidade, como apresentado na Fig. \n\n8.1a e Fig. 8.1b, enquanto que curvas quadr\u00e1ticas ser\u00e3o obtidas quando nw = no = 2.0 (Fig. \n\n8.1c).  \n\n  \n\n                                                 \n1 A raz\u00e3o de mobilidades M \u00e9 definida como a raz\u00e3o entre as mobilidades da \u00e1gua e do \u00f3leo avaliadas na \nsatura\u00e7\u00e3o de \u00e1gua sw = (1 \u2013 soi) e sw = swi , respectivamente (DAKE, 2001). Neste trabalho, contudo, considerar-\nse-\u00e1 em todos os casos analisados que as permeabilidades relativas limites s\u00e3o iguais a unidade ( 1max maxrw rok k= = ), \no que permite expressar a raz\u00e3o de mobilidades como uma raz\u00e3o de viscosidades /o wM \u00b5 \u00b5= . \n \n\n\n\n110 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n         \n         (a)  M = 1 e curva de permeabilidades                                  (b) M = 2 e curva de permeabilidades  \n\n            relativas lineares                relativas lineares        \n\n \n(c) M = 2 e curva de permeabilidades \n\n                                                                      relativas quadr\u00e1ticas \n \n\nFig. 8.1 \u2013 Curvas de permeabilidades relativas das fases \u00e1gua e \u00f3leo (krw e kro)  e de fluxo fracion\u00e1rio da fase \n\n\u00e1gua ( fw) utilizadas nas simula\u00e7\u00f5es \n\n \n\n \n\nAs raz\u00f5es de mobilidades consideradas s\u00e3o M = 1 e 2. A posi\u00e7\u00e3o e a forma da frente \n\nde satura\u00e7\u00e3o dependem fortemente de M, porque o fluxo fracion\u00e1rio pode ser expresso em \n\nfun\u00e7\u00e3o da raz\u00e3o de mobilidades, \n\n \n\nrw\nw\n\nro\nrw\n\nk\nf\n\nk\nk\n\nM\n\n=\n+\n\n (8.7) \n\n \n\nA Fig. 8.1 apresenta, sobrepostas \u00e0s curvas de permeabilidade relativa, as curvas de fw x sw \n\nque ser\u00e3o usadas nos testes. \n\nA solu\u00e7\u00e3o num\u00e9rica do EbFVM foi obtida com o m\u00e9todo IMPES, usando-se malhas \n\nigualmente espa\u00e7adas formadas por uma fileira horizontal de elementos quadril\u00e1teros. A \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 111 \n\n \n\n \n\nestabilidade num\u00e9rica foi assegurada utilizando passos de tempo que resultassem em N\u00fameros \n\nde Courant (CFL - Courant-Freidrichs-Levy ) iguais a unidade. Este n\u00famero adimensional \u00e9 \n\ndefinido como \n\n \n\nT\nt\n\nCFL u\nx\n\n?\n=\n\n?\n (8.8) \n\n \n\n Ao se comparar as Eqs. (8.8) e (8.4) percebe-se que, para problemas incompress\u00edveis \n\nresolvidos explicitamente, que \u00e9 o caso aqui tratado, a condi\u00e7\u00e3o de estabilidade de Courant-\n\nFreidrichs-Levy (CFL = 1) pode ser entendida como a necessidade de garantir, em cada passo \n\nde tempo, a passagem de, no m\u00e1ximo, um volume poroso de fluido em cada volume de \n\ncontrole. \n\nEmbora as malhas utilizadas sejam igualmente espa\u00e7adas, os volumes de controle \n\nresultantes n\u00e3o ser\u00e3o uniformes em raz\u00e3o da exist\u00eancia de dois volumes de controle que tem a \n\nmetade da dimens\u00e3o dos demais: um no in\u00edcio e outro no final da malha. Por isso foram \n\nempregados passos de tempo que asseguram CFL = 1 naqueles volumes, o que resultou em \n\nvalores mais conservadores do passo de tempo para a maioria dos volumes de controle. \n\nA solu\u00e7\u00e3o anal\u00edtica da equa\u00e7\u00e3o de Buckley-Leverett foi obtida seguindo os \n\nprocedimentos cl\u00e1ssicos apresentados na literatura (GREENKORN, 1983; LAKE, 1989; entre \n\noutros). \n\nOs resultados num\u00e9ricos obtidos com o EbFVM para malhas com 20, 100 e 1000 \n\nelementos s\u00e3o apresentados na Fig. 8.2 para um tempo de simula\u00e7\u00e3o tA =  0.5 VPI. Como se \n\npode notar, os resultados num\u00e9ricos conseguem reproduzir o comportamento da frente de \n\nsatura\u00e7\u00e3o independentemente se o perfil \u00e9 do tipo pist\u00e3o (Fig. 8.2a), se tem a frente suavizada \n\n(Fig. 8.2b) ou se \u00e9 um pulso de \u00e1gua sendo advectado com uma regi\u00e3o suavizada atr\u00e1s do \n\nmesmo (Fig. 8.2c). \u00c9 importante notar tamb\u00e9m que o aumento da raz\u00e3o de mobilidades \n\nsuavizou a frente de deslocamento (Fig. 8.2b), como se fosse introduzida uma difus\u00e3o \n\nnum\u00e9rica, o que acontece quando se emprega malhas demasiadamente grosseiras para \n\nresolver escoamentos do tipo pist\u00e3o. Neste caso, foram verificadas pequenas diferen\u00e7as entre \n\nas malhas grosseiras e a solu\u00e7\u00e3o anal\u00edtica. Mas, o mais importante \u00e9 que todos os resultados \n\nobtidos numericamente convergem para a solu\u00e7\u00e3o exata \u00e0 medida que a malha \u00e9 refinada. \n\n \n\n\n\n112 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n                  \n             (a)  M = 1 e curva de permeabilidades                       (b) M = 2 e curva de permeabilidades  \n\n                relativas lineares                     relativas lineares        \n \n\n \n(c) M = 2 e curva de permeabilidades \n\nrelativas n\u00e3o-lineares \n \n\nFig. 8.2 \u2013 Compara\u00e7\u00e3o entre os perfis de satura\u00e7\u00e3o ao longo da coordenada axial adimensionalizada para um \n\ntempo de simula\u00e7\u00e3o  tA =  0.5 VPI \n\n \n\n \n\n \n\n8.2. As \u201cTransmissibilidades Negativas\u201d em um Caso \nPr\u00e1tico \n\n \n\nFoi demonstrado no Cap. 7 que n\u00e3o faz mais sentido usar o termo \u201ctransmissibilidade\u201d \n\nno caso de malhas n\u00e3o-estruturadas. Portanto, n\u00e3o h\u00e1 impedimento a que os termos \n\nusualmente denominados desta forma sejam negativos.  \n\nComo exemplo, considere o reservat\u00f3rio de petr\u00f3leo com 5 po\u00e7os, sendo tr\u00eas \n\nprodutores (com press\u00e3o de bloco prescrita) e dois injetores (um de \u00e1gua e outro de \u00f3leo) \n\nposicionados conforme mostra a Fig. 8.3. N\u00e3o \u00e9 usual injetar \u00f3leo no reservat\u00f3rio, contudo \n\nisso \u00e9 realizado para gerar um escoamento que permite estudar os aspectos relevantes com \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 113 \n\n \n\n \n\nmaior facilidade, mesmo em um problema simples como este. As viscosidades da \u00e1gua e do \n\n\u00f3leo s\u00e3o iguais e o escoamento \u00e9 incompress\u00edvel. A geometria da malha e a localiza\u00e7\u00e3o dos \n\npo\u00e7os foram definidas de maneira a produzir dentro de cada elemento um escoamento na \n\ndire\u00e7\u00e3o x apenas, resultando em um caso em que as press\u00f5es dos blocos 3 e 5 s\u00e3o iguais. Essa \n\ndire\u00e7\u00e3o do escoamento se estabelece em fun\u00e7\u00e3o da discretiza\u00e7\u00e3o realizada com fun\u00e7\u00f5es de \n\nforma lineares. \n\n \n\n \n\n \nFig. 8.3 \u2013 Defini\u00e7\u00e3o geom\u00e9trica do problema estudado \n\n \n\n \n\nO elemento triangular de interesse e que ser\u00e1 tratado com mais aten\u00e7\u00e3o nesta se\u00e7\u00e3o \u00e9 o \n\nelemento delimitado pelos n\u00f3s 1, 2 e 3 e identificado pelo n\u00famero 2, que tem um \u00e2ngulo \n\ninterno maior que 90o. Ele aparece de forma destacada na Fig. 8.4, com seus sub-volume de \n\ncontrole e seus n\u00f3s com a numera\u00e7\u00e3o local, que neste caso \u00e9 coincidente com a numera\u00e7\u00e3o \n\nglobal dada na Fig. 8.3. Conforme discutido no Cap. 7, \u00e9 dito na literatura que este elemento \n\n\u201ccausaria\u201d transmissibilidades negativas, e portanto \u201cdeveria\u201d ser evitado. \n\n\n\n114 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n \nFig. 8.4 \u2013 Elemento triangular 2 da malha apresentada na Fig. 8.3, destacando os sub-volumes de controle \n\ncriados e o \u00e2ngulo obtuso que originaria transmissibilidades negativas. \n\n \n\n \n\n \n\nA \u201ctransmissibilidade\u201d negativa. A fim de mostrar a exist\u00eancia do termo comumente \n\ndenominado de transmissibilidade negativa e obter as equa\u00e7\u00f5es de forma conveniente, iniciar-\n\nse-\u00e1 a dedu\u00e7\u00e3o do termo de fluxo para um dos volumes de controle presentes neste elemento. \n\nPara tanto, considere a equa\u00e7\u00e3o do fluxo total deduzida no Cap. 7 para o sub-volume de \n\ncontrole 1, svc1, da Fig. 8.4 que tem a forma \n\n \n\n ( ) ( )1 13 3 1 12 2 1q p p p p= ? ? + ? ?  (8.9) \n\n          \n\nNo problema analisado p2  = p1, o que reduz a equa\u00e7\u00e3o a \n\n \n\n( )1 13 3 1q p p= ? ?  (8.10) \n\n \n\nTamb\u00e9m foi visto no Cap. 7 que o fator  13? , por sua vez, \u00e9 composto por duas \n\nparcelas, \n\n \n\n113 12 13 13 13Svc\nAB BC? ? ? ?? = +  (8.11) \n\n \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 115 \n\n \n\n \n\nonde 13\nBC?  \u00e9 zero devido a . 0BCV S? = , onde BCS?  \u00e9 o vetor \u00e1rea entre os pontos B e C da  Fig. \n\n8.4 e \u00e9 composto pelo segmento BC paralelo ao escoamento.  As express\u00f5es que determinam \n\ncada um dos termos da equa\u00e7\u00e3o anterior podem ser vistas no Anexo 7. Logo, o fluxo total do \n\nsub-volume 1 da Fig. 8.4 ser\u00e1 dado por \n\n \n\n( )1 12 13 3 1ABq p p? ?= ?  (8.12) \n\n \n\n Inspecionando-se a Fig. 8.4 conclui-se que o fluxo determinado pela Eq. (8.12) \u00e9 \n\naquele que atravessa apenas o segmento AB, pois o segmento BC \u00e9 paralelo ao escoamento, \n\ncomo mencionado. Ent\u00e3o, na realidade, o fluido vai de svc1 para svc2, n\u00e3o apresentando \n\nnenhuma rela\u00e7\u00e3o com svc3, como poderia estar sendo sugerido pela presen\u00e7a de ( )3 1p p?   \nnesta express\u00e3o. A menos do trabalho de Palagi (1992) que apresentou importantes \n\ncontribui\u00e7\u00f5es,  esta interpreta\u00e7\u00e3o da correta dire\u00e7\u00e3o dos fluxos n\u00e3o est\u00e1 devidamente discutida \n\nna literatura, e pode estar causando dificuldades em muitos modelos num\u00e9ricos. \n\nAl\u00e9m disso, deve-se notar que, como fisicamente o fluxo est\u00e1 saindo do sub-volume 1 \n\ne indo na dire\u00e7\u00e3o de 2, ele recebe sinal negativo na equa\u00e7\u00e3o de svc1, \n\n \n\n( )1 12 13 3 1 0ABq p p? ?= ? &lt; (8.13) \n\n \n\ne como ( )3 1 0p p? >  e as mobilidades s\u00e3o positivas, por defini\u00e7\u00e3o, conclui-se que \n\n \n\n13 0\nAB? &lt; (8.14) \n\n \n\no que fisicamente est\u00e1 correto, embora este termo n\u00e3o tenha o significado f\u00edsico da \n\ntransmissibilidade discutido no Cap. 7. Talvez a presen\u00e7a destes coeficientes negativos \n\nimpliquem em alguma dificuldade de solu\u00e7\u00e3o do sistema linear, mas, como visto, n\u00e3o h\u00e1 \n\nnenhum argumento f\u00edsico ou num\u00e9rico que justifique construir malhas que evitem seu \n\naparecimento.  \n\nResumindo, os termos das equa\u00e7\u00f5es denominados usualmente de transmissibilidades \n\npodem assumir valores negativos no caso de tri\u00e2ngulos obtus\u00e2ngulos. A pr\u00e1tica na \u00e1rea \n\nnum\u00e9rica, contudo, tem demonstrado que a presen\u00e7a de tri\u00e2ngulos muito deformados n\u00e3o \u00e9 \n\n\n\n116 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\numa boa conduta mas, como visto, a rejei\u00e7\u00e3o de uma malha pela simples an\u00e1lise do sinal \n\ndestes termos n\u00e3o tem justificativa. Deve-se lembrar que o verdadeiro fator \n\n\u201ctransmissibilidade\u201d utilizado tradicionalmente em malhas estruturadas ser\u00e1 sempre um \n\nn\u00famero positivo porque representa o produto da permeabilidade absoluta pela \u00e1rea, dividido \n\npela dist\u00e2ncia entre os n\u00f3s. \n\n \n\n \n\n \n\n8.3. Compara\u00e7\u00e3o entre as Solu\u00e7\u00f5es do M\u00e9todo Proposto e \nde um Simulador Comercial \n\n \nNesta se\u00e7\u00e3o s\u00e3o comparadas as solu\u00e7\u00f5es do simulador EbFVM do pacote comercial \n\nSTARS da CMG (STARS User\u2019s Guide, 2002; FUNG et al., 1991) com as solu\u00e7\u00f5es do \n\nsimulador EbFVM proposto. Neste trabalho, o m\u00e9todo empregado no simulador comercial \n\nser\u00e1 denominado doravante de \u201cEbFVM tradicional\u201d.  \n\nAntes de prosseguir nesta se\u00e7\u00e3o, deve-se destacar que implementou-se, ainda, um \n\noutro simulador que utiliza as mesmas equa\u00e7\u00f5es do EbFVM tradicional, para certificar-se da \n\ncorre\u00e7\u00e3o do simulador comercial. N\u00e3o \u00e9 incomum encontrar simuladores complexos com \n\nequa\u00e7\u00f5es implementadas erroneamente (MALISKA et al., 2002). Por isso, \u00e9 importante ter \n\num outro programa para realizar esta verifica\u00e7\u00e3o. Nos casos rodados, n\u00e3o foram detectadas \n\ndiscrep\u00e2ncias entre os resultados do STARS e do simulador desenvolvido. \n\n \n\n8.3.1. Impacto nos Resultados do Caso Analisado no Item 8.2 \n\n \n\nPara aprofundar o entendimento das quest\u00f5es num\u00e9ricas envolvidas na discretiza\u00e7\u00e3o \n\ndo problema da Fig. 8.3, pode-se comparar os fluxos produzidos pelo esquema num\u00e9rico \n\nproposto neste trabalho e pelo EbFVM tradicional. Para tanto, assume-se, que as satura\u00e7\u00f5es \n\nde \u00e1gua nos n\u00f3s da malha da Fig. 8.4 s\u00e3o \n\n \n\n1\n0.0ws =    2 0.0ws =    3 1.0ws =  \n\n \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 117 \n\n \n\n \n\n M\u00e9todo proposto. No m\u00e9todo EbFVM proposto, as mobilidades s\u00e3o calculadas com \n\nvalores a montante de um determinado ponto de integra\u00e7\u00e3o, utilizando a Eq. (4.31), que \u00e9 \n\nreproduzida aqui: \n\n \n\n( )\n( )\n\n          se            \n\n          se   \n\njk j\njk\n\njk k\njk\n\n0k p S\n\n0k p S\n\n? ?\n\n? ?\n\n? ?= ? ?&lt;\n?\n?\n\n?? = ? ? >\n?\n\n (8.15) \n\n \n\nPor isso, as mobilidades 13?  e 23?  s\u00e3o calculadas com a satura\u00e7\u00e3o do n\u00f3 3, isto \u00e9, com \n\nsatura\u00e7\u00e3o igual a unidade, enquanto que a mobilidade 12?  \u00e9 nula por ser calculada com \n\nsatura\u00e7\u00e3o zero. Assim,  o fluxo de \u00e1gua em scv1 calculado na Eq. (8.12), utilizando o esquema \n\nde avalia\u00e7\u00e3o das mobilidades da Eq. (8.15), \u00e9 dado por \n\n \n\n1 0wq =  (8.16) \n\n \n\no que confere com a f\u00edsica do problema, pois com o escoamento dirigido da direita para a \n\nesquerda, conforme est\u00e1 definido, n\u00e3o poder\u00e1 sair \u00e1gua do sub-volume 1 para o 2 se a \n\nsatura\u00e7\u00e3o \n1w\n\ns  for nula. \n\n  \n\nM\u00e9todo EbFVM tradicional. Mas, no esquema tradicional, \u00e9 importante relembrar \n\nque o fluxo no sub-volume 1 \u00e9 dado por (FUNG et al., 1991) \n\n \n\n( ) ( )13 13 3 1 12 12 2 11q T p p T p p? ?= ? + ?  (8.17) \n\n \n\ne que, no problema estudado, em fun\u00e7\u00e3o de 2 1p p=  e 12 0? = , reduz-se a \n\n \n\n( )13 13 3 11q T p p?= ?  (8.18) \n\n  \n\n Assumindo que kx = ky = k e substituindo os valores de xi e yi do tri\u00e2ngulo 2 definido \n\nna Fig. 8.3 na express\u00e3o que determina o coeficiente T13 (FUNG et al., 1991), obt\u00e9m-se \n\n \n\nkT 25,013 ?=  (8.19) \n\n\n\n118 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nque, finalmente, substitu\u00eddo na Eq. (8.18), resulta em \n\n \n\n( )13 3 11 0, 25 wwq k p p?= ? ?  (8.20) \n\n \n\nN\u00e3o ser\u00e1 poss\u00edvel empregar a Eq. (8.15) na determina\u00e7\u00e3o da mobilidade no m\u00e9todo \n\nEbFVM tradicional porque este m\u00e9todo n\u00e3o usa informa\u00e7\u00f5es armazenadas por elementos, \n\napenas por arestas. Deve-se optar, portanto, por uma das duas maneiras de calcular a \n\nmobilidade  apresentadas no Cap. 4.1.5, e que ser\u00e3o relembradas brevemente nesta se\u00e7\u00e3o. \n\nA primeira op\u00e7\u00e3o \u00e9 o esquema de avalia\u00e7\u00e3o a montante (upwind) baseado na an\u00e1lise \n\ndo valor de press\u00e3o nodal dos dois volumes de controle vizinhos \u00e0 face onde se deseja avaliar \n\na mobilidade, \n\n \n\n                  se               \n\n                  se               \njk j j k\n\njk k j k\n\np p\np p\n\n? ?\n? ?\n\n= >\n\n=&lt;\n (8.21) \n\n \n\nAssim, neste problema, w13?  ser\u00e1 calculada com a satura\u00e7\u00e3o do n\u00f3 3, tornando o produto \n\n( )13 3 1wk p p? ?  n\u00e3o nulo e positivo, de forma que \n\n \n\n1 0wq &lt; (8.22) \n\n \n\no que significa que existe fluxo de \u00e1gua saindo do volume 1, cuja satura\u00e7\u00e3o de \u00e1gua \u00e9 zero. \n\n Esta conclus\u00e3o se reveste ainda de maior import\u00e2ncia se for adotado o conceito da \n\ninterpreta\u00e7\u00e3o dos fluxos aplicada \u00e0 malhas estruturadas e usualmente empregada \n\nerroneamente para o m\u00e9todo EbFVM tradicional que diz, por inspe\u00e7\u00e3o da Eq. (8.20), que essa \n\nmassa que sai do volume 1 vai para o volume 3. Neste caso haveria um fluxo que leva massa \n\nde um local onde ela n\u00e3o existe. \n\n Pode-se, no entanto, calcular o fluxo obtido pela Eq. (8.20) utilizando-se o segundo \n\nesquema de avalia\u00e7\u00e3o das mobilidades, e que usa o sinal do termo ( )kjjk ppT ?  para definir o \nvalor das vari\u00e1veis dependentes a montante, \n\n \n\n( )\n( )\n\n                  se               0\n\n                  se               0\n\njk j jk j k\n\njk k jk j k\n\np pT\n\np pT\n\n? ?\n\n? ?\n\n?= >\n\n?=&lt;\n (8.23) \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 119 \n\n \n\n \n\nComparando os resultados do STARS para diferentes situa\u00e7\u00f5es com os do simulador \n\ndesenvolvido nesta tese que utiliza as mesmas equa\u00e7\u00f5es, p\u00f4de-se constatar que a Eq. (8.23) \u00e9 \n\na op\u00e7\u00e3o implementada naquele software comercial. Neste caso, a mobilidade w13?  ser\u00e1 \n\ncalculada, em vez de utilizar a satura\u00e7\u00e3o do n\u00f3 3, atrav\u00e9s da satura\u00e7\u00e3o do n\u00f3 1, que \u00e9 zero. Isto \n\nresulta em \n \n\n1 0wq =  (8.24) \n\n \n\no que confere com a f\u00edsica do problema. Por inspe\u00e7\u00e3o da Eq. (8.20), percebe-se, por\u00e9m, que \n\npara valores de satura\u00e7\u00e3o de \u00e1gua do n\u00f3 1 diferentes de zero, o valor de w13?  ser\u00e1 positivo, \n\nresultando em um fluxo negativo, como o calculado com o esquema anterior. \n\n \n\nConclus\u00e3o. Quando um dos tri\u00e2ngulos for obtus\u00e2ngulo, pode ocorrer uma invers\u00e3o no \n\nsentido do fluxo, sendo esta a verdadeira raz\u00e3o da recomenda\u00e7\u00e3o na literatura da necessidade \n\nde se evitar tais situa\u00e7\u00f5es. Para \u00e2ngulos menores que 90\u00ba todos os fluxos, embora possam \n\nestar contaminados com erros na maioria dos casos, pelo menos obedecem o sentido correto, \n\ngarantindo com isso resultados qualitativamente corretos. A invers\u00e3o do sentido do fluxo \n\naltera completamente a f\u00edsica do problema, produzindo resultados freq\u00fcentemente \n\ninaceit\u00e1veis. \n\nO impacto da utiliza\u00e7\u00e3o do esquema proposto e do tradicional para o problema \n\nestudado, incompress\u00edvel e homog\u00eaneo, com permeabilidade absoluta k= 150 mD, \n\nviscosidades da \u00e1gua e \u00f3leo igual a 1 cp, porosidade igual a 0.2, curvas de permeabilidade \n\nrelativas lineares2 e ?t = 0.001 d, \u00e9 apresentado na Fig. 8.5. \n\nNota-se que as curvas de corte de \u00e1gua nos po\u00e7os produtores (watercut) na Fig. 8.5a, \n\nque foram obtidas utilizando o EbFVM tradicional com as mobilidades calculadas a partir da \n\nEq. (8.21) apresentam valores negativos em um dos po\u00e7os. Este mesmo m\u00e9todo num\u00e9rico, \n\nutilizando agora as mobilidades calculadas a partir da Eq. (8.23) n\u00e3o apresenta mais \n\nsatura\u00e7\u00f5es negativas, como mostra a Fig. 8.5b. Na Fig. 8.5c s\u00e3o apresentados os resultados \n\nobtidos com o m\u00e9todo EbFVM proposto e o esquema de avalia\u00e7\u00e3o das mobilidades da Eq. \n\n(8.15). Nota-se que, com exce\u00e7\u00e3o dos resultados da Fig. 8.5a, os demais resultados da Fig. 8.5 \n\n                                                 \n2 As curvas de permeabilidade relativa lineares s\u00e3o obtidas empregando-se expoentes iguais a 1 na correla\u00e7\u00e3o de \nCorey dada pela Eq. (8.6). \n\n\n\n120 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\naparentam ser coerentes, embora os resultados da Fig. 8.5b tenham apresentado produ\u00e7\u00e3o nula \n\nde \u00e1gua no po\u00e7o 1, o que n\u00e3o era o esperado. \n\n \n\n \n\n            \n(a) Com avalia\u00e7\u00e3o das mobilidades pela Eq. (8.21)        (b)  Com avalia\u00e7\u00e3o das mobilidades pela Eq. (8.23) \n \n\n \n(c) Com avalia\u00e7\u00e3o das mobilidades pela Eq. (8.15) \n\n \n\nFig. 8.5 \u2013 Curvas de corte de \u00e1gua nos po\u00e7os produtores do reservat\u00f3rio da Fig. 8.3 obtidas pelos m\u00e9todos \n\nEbFVM tradicional (FUNG et al., 1991) e EbFVM proposto neste trabalho, com diferentes esquemas de \n\navalia\u00e7\u00e3o das mobilidades.  \n\n \n\n \n\n8.3.2. Interpreta\u00e7\u00e3o do Campo de Velocidades do M\u00e9todo EbFVM  \n\n \n\nO objetivo desta se\u00e7\u00e3o \u00e9 mostrar que mesmo a visualiza\u00e7\u00e3o de resultados obtidos com \n\no m\u00e9todo EbFVM tradicional pode ser comprometida se forem empregados os mesmos \n\nconceitos utilizados no processo de discretiza\u00e7\u00e3o de suas equa\u00e7\u00f5es. Em fun\u00e7\u00e3o da utiliza\u00e7\u00e3o \n\nfreq\u00fcente de softwares de visualiza\u00e7\u00e3o comerciais, \u00e9 comum a necessidade de calcular e \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 121 \n\n \n\n \n\nplotar velocidades m\u00e9dias nos elementos da malha, mesmo sabendo que seria mais l\u00f3gico \n\nvisualizar uma velocidade em cada ponto de integra\u00e7\u00e3o, pois \u00e9 aquela que foi utilizada no \n\nc\u00e1lculo do fluxo nas equa\u00e7\u00f5es discretizadas. Isto \u00e9 indiferente para elementos triangulares e \n\nescoamento monof\u00e1sico, porque o campo de velocidade dentro destes elementos \u00e9 constante, \n\nassim como o gradiente de press\u00e3o, conforme descrito na se\u00e7\u00e3o 4.1.3. No entanto, os \n\nprocedimentos usuais para escoamentos multif\u00e1sicos podem resultar em vetores velocidade \n\ncom dire\u00e7\u00f5es opostas \u00e0s esperadas e/ou com valores n\u00e3o-f\u00edsicos.  \n\nDeve-se relembrar que na utiliza\u00e7\u00e3o do m\u00e9todo EbFVM tradicional apenas elementos \n\ntriangulares em 2D ou tetra\u00e9dricos em 3D t\u00eam sido apresentados na literatura. Por isso, \n\ncontinuar-se-\u00e1 nesta se\u00e7\u00e3o usando apenas tri\u00e2ngulos. No Anexo 7 \u00e9 deduzida a discretiza\u00e7\u00e3o \n\ndo gradiente de press\u00e3o para estes elementos, \n\n \n\n( )( ) ( )( )\n\n( )( ) ( )( )\nj\n\nJ\nxxppxxpp\n\ni\nJ\n\nyyppyypp\np\n\n13121213\n\n12131312\n\n\u02c6\n)det(\n\n                \n\n\u02c6\n)det(\n\n?\n?\n\n?\n?\n?\n\n? ?????\n+\n\n+?\n?\n\n?\n?\n?\n\n? ?????\n=?\n\n (8.25)   \n\n \n\nonde os sub-\u00edndices referem-se \u00e0 numera\u00e7\u00e3o local do elemento e J \u00e9 a matriz Jacobiana de \n\ntransforma\u00e7\u00e3o (Eq. 4.19). Rearranjando termos, pode-se mostrar que esta express\u00e3o pode ser \n\nescrita tamb\u00e9m como  \n\n \n\n( ) ( ) ( )\n\n( ) ( ) ( )\nj\n\nJ\nppyppxppx\n\ni\nJ\n\nppyppyppy\np\n\n321132213\n\n231312123\n\n\u02c6\n)det(\n\n                \n\n\u02c6\n)det(\n\n?\n?\n\n?\n?\n?\n\n? ?+?+?\n+\n\n+?\n?\n\n?\n?\n?\n\n? ?+?+?\n=?\n\n (8.26) \n\n \n\nque s\u00e3o as formas mais usuais de representar o gradiente de press\u00e3o discretizado no m\u00e9todo \n\nEbFVM, e s\u00e3o utilizadas para determinar a velocidade de uma fase escoando em um meio \n\nporoso \n\n \n\nm mV k p?= ? ?  (8.27) \n\n \n\nonde, por simplicidade, o tensor permeabilidade absoluto \u00e9 considerado isotr\u00f3pico e \n\nhomog\u00eaneo. \n\n\n\n122 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n Como, para fins de visualiza\u00e7\u00e3o, deseja-se obter uma velocidade m\u00e9dia dentro do \n\nelemento, a alternativa que parece mais plaus\u00edvel \u00e9 a que faz a m\u00e9dia das velocidades nos tr\u00eas \n\npontos de integra\u00e7\u00e3o, pois s\u00e3o estas as utilizadas no c\u00e1lculo do fluxo que originam as \n\nexpress\u00f5es discretizadas3. Assim, denominando pot m?  a m\u00e9dia das mobilidades nos pontos \n\nde integra\u00e7\u00e3o, a velocidade m\u00e9dia do elemento \u00e9 dada por \n\n \n\n( )( ) ( )( )\n\n( )( ) ( )( )\nj\n\nJ\nxxppxxpp\n\nk\n\ni\nJ\n\nyyppyypp\nkV\n\n13121213\nm\n\n12131312\nmm\n\n\u02c6\n)det(\n\n                       \n\n\u02c6\n)det(\n\n?\n?\n\n?\n?\n?\n\n? ?????\n?\n\n+?\n?\n\n?\n?\n?\n\n? ?????\n?=\n\n?\n\n?\n (8.28) \n\n \n\nEsta equa\u00e7\u00e3o \u00e9 bem diferente das duas poss\u00edveis express\u00f5es que surgem em fun\u00e7\u00e3o da \n\nutiliza\u00e7\u00e3o dos procedimentos usuais que norteiam a discretiza\u00e7\u00e3o do EbFVM tradicional \n\n \n\n( ) ( ) ( ) ( )\n\n( ) ( ) ( ) ( )\n\n12 13\n\n13 12\n\n2 1 3 1 3 1 2 1\n\n3 1 2 1 2 1 3 1\n\n\u02c6\ndet( )\n\n\u02c6                \ndet( )\n\nm m\nm\n\nm m\n\np p y y p p y y\nV k i\n\nJ\n\np p x x p p x x\nk j\n\nJ\n\n? ?\n\n? ?\n\n? ? ? ? ?? ?\n= ? +? ?\n\n? ?\n? ? ? ? ?? ?\n\n? ? ?\n? ?\n\n (8.29) \n\n \n\nou \n\n \n\n( ) ( ) ( )\n\n( ) ( ) ( )\n\n12 13 23\n\n12 13 23\n\n3 2 1 2 1 3 1 3 2\n\n3 1 2 2 3 1 1 2 3\n\n\u02c6\ndet( )\n\n\u02c6                \ndet( )\n\nm m m\nm\n\nm m m\n\ny p p y p p y p p\nV k i\n\nJ\n\nx p p x p p y p p\nk j\n\nJ\n\n? ? ?\n\n? ? ?\n\n? + ? + ?? ?\n= ? +? ?\n\n? ?\n? + ? + ?? ?\n\n? ? ?\n? ?\n\n (8.30) \n\n \n\nque se valem da premissa err\u00f4nea de que o fluxo pode ser calculado utilizando-se apenas dois \n\nvalores nodais de press\u00e3o e que, por isso, pode-se multiplicar a mobilidade da fase  \n\ndiretamente pela diferen\u00e7a de press\u00f5es. De fato, n\u00e3o parece l\u00f3gica esta introdu\u00e7\u00e3o de \n\n                                                 \n3 Quando for necess\u00e1rio visualizar um campo vari\u00e1vel e cont\u00ednuo de velocidades no interior do elemento deve-se \nbuscar outros tipos de m\u00e9dias, como as propostas por Jayantha e Turner (2001), e que resultam em um valor \nm\u00e9dio do gradiente de press\u00e3o nos volumes de controle (n\u00f3s da malha). Nesta proposta, pode-se empregar as \nfun\u00e7\u00f5es de forma para obter o gradiente de press\u00e3o, e em conseq\u00fc\u00eancia, velocidades, em qualquer posi\u00e7\u00e3o no \ninterior do elemento. \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 123 \n\n \n\n \n\nmobilidades diferentes multiplicando as diferentes parcelas do gradiente de press\u00e3o, que \u00e9 \n\nconstante dentro do elemento triangular. No entanto, \u00e9 exatamente este o procedimento \n\nutilizado no c\u00e1lculo dos fluxos multif\u00e1sicos durante o processo de obten\u00e7\u00e3o das equa\u00e7\u00f5es \n\ndiscretizadas no EbFVM tradicional (FUNG et al., 1991). \n\nO resultado da utiliza\u00e7\u00e3o de cada uma das express\u00f5es dadas nas Eqs. (8.28) a (8.30) \n\nser\u00e1 constatado em um problema pr\u00e1tico. A Fig. 8.6 apresenta dois elementos triangulares que \n\npossuem valores nodais sim\u00e9tricos de press\u00e3o e mobilidades nos n\u00f3s. Esses valores podem ser \n\ninterpretados como uma estimativa inicial ou o resultado de uma simula\u00e7\u00e3o. Pretende-se \n\nvisualizar do campo de velocidades originado em cada tri\u00e2ngulo a partir destes dados. \n\n \n\n \n\n \nFig. 8.6 \u2013 Elementos triangulares e seus valores nodais de press\u00e3o e mobilidade empregados no c\u00e1lculo de uma \n\nvelocidade m\u00e9dia no elemento \n\n \n\n \n\nDependendo da express\u00e3o de velocidade discretizada utilizada, pode-se obter vetores \n\ncompletamente diferentes como demonstra a Fig. 8.7. Para facilitar a visualiza\u00e7\u00e3o, estes \n\nvetores n\u00e3o est\u00e3o sendo plotados no baricentro do elemento. A utiliza\u00e7\u00e3o da Eq. (8.29), apesar \n\nde resultar em um campo sim\u00e9trico como mostra a Fig. 8.7a, apresentou componentes \n\nhorizontais demasiadamente grandes em rela\u00e7\u00e3o \u00e0s verticais. Isso n\u00e3o tem suporte f\u00edsico, \n\nconsiderando-se que a componente vertical do gradiente de press\u00e3o \u00e9 visivelmente maior que \n\na horizontal, como se pode constatar pela simples inspe\u00e7\u00e3o dos dados apresentados na Fig. \n\n8.6. A Eq. (8.30), por sua vez, resultou em um campo de velocidades que, al\u00e9m de n\u00e3o ser \n\nsim\u00e9trico, apresentou componentes verticais com dire\u00e7\u00f5es opostas em cada elemento (Fig. \n\n8.7b), o que n\u00e3o se justifica em fun\u00e7\u00e3o das press\u00f5es sim\u00e9tricas prescritas nos n\u00f3s. \n\n \n\n\n\n124 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n \n\nFig. 8.7 \u2013 Vetores velocidade determinados atrav\u00e9s das express\u00f5es: (a) Eq. (8.29), (b) Eq. (8.30) e (c) Eq. (8.28). \n\n \n\n \n\n \n\nNota-se na Fig. 8.7c que a express\u00e3o empregada neste trabalho, Eq. (8.28), foi a \u00fanica \n\nque conseguiu reproduzir, pelo menos qualitativamente, o campo de velocidades esperado, \n\numa vez que apresentou a componente vertical desta velocidade nitidamente maior que a \n\nhorizontal. Al\u00e9m disso, as velocidades em cada elemento s\u00e3o sim\u00e9tricas, o que tamb\u00e9m \n\nconcorda com a simetria dos valores de press\u00e3o dados. O valor da permeabilidade absoluta \n\nutilizado em todos os casos foi de 1,13.10-13 m2, produzindo uma componente vertical da \n\nvelocidade de 1 m/dia nos dois elementos. Esta componente foi utilizada como fator de escala \n\npara as demais velocidades plotadas nesta figura. \n\n \n\nConclus\u00e3o. Esses resultados revelam um aspecto importante no uso de m\u00e9todos \n\nnum\u00e9ricos.  Nas opera\u00e7\u00f5es num\u00e9ricas, devido \u00e0 discretiza\u00e7\u00e3o, \u00e9 simples calcular vari\u00e1veis em \n\npontos do dom\u00ednio a partir de m\u00e9dias (das mais diversas) dos pontos nodais. Estas m\u00e9dias \n\npodem produzir resultados contr\u00e1rios \u00e0 f\u00edsica do problema, conforme foi o caso mostrado, \n\naqui aplicado para um problema de p\u00f3s-processamento. \u00c9 por isso que todas as aproxima\u00e7\u00f5es \n\nnum\u00e9ricas devem ser sempre amparadas pela f\u00edsica, a come\u00e7ar pela integra\u00e7\u00e3o da equa\u00e7\u00e3o \n\ndiferencial em sua forma conservativa. \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 125 \n\n \n\n \n\n8.4. As Duas Parcelas do Efeito de Orienta\u00e7\u00e3o de Malha no \nEbFVM \n\n \n\nConsiderando, ainda, o termo de fluxo, a utiliza\u00e7\u00e3o de uma fun\u00e7\u00e3o de interpola\u00e7\u00e3o de \n\nbaixa ordem (upwind unidimensional) no c\u00e1lculo da mobilidade cria uma depend\u00eancia \n\nan\u00f4mala dos resultados com a dire\u00e7\u00e3o das linhas da malha (YANOSIK e MCCRACKEN, \n\n1979). Este tipo de interpola\u00e7\u00e3o garante estabilidade no m\u00e9todo num\u00e9rico, mas torna as \n\nsolu\u00e7\u00f5es  fortemente dependentes da malha. Este \u00e9 o chamado efeito de orienta\u00e7\u00e3o de malha e \n\n\u00e9 originado, portanto, pela forma como os termos de mobilidade s\u00e3o calculados nas interfaces \n\ndos volumes de controle. \n\n\u00c9 poss\u00edvel demonstrar a exist\u00eancia de um outro erro num\u00e9rico, que pode se manifestar \n\nprincipalmente quando s\u00e3o utilizadas malhas n\u00e3o-estruturadas, de origem semelhante ao efeito \n\nde orienta\u00e7\u00e3o de malha e que \u00e9 criado pela forma como as equa\u00e7\u00f5es discretizadas multif\u00e1sicas \n\ns\u00e3o obtidas. A saber, pela integra\u00e7\u00e3o das equa\u00e7\u00f5es diferenciais monof\u00e1sicas e posterior adi\u00e7\u00e3o \n\ndos termos de mobilidade. J\u00e1 foi comentado neste texto que este \u00e9 um procedimento \n\ninadequado para malhas n\u00e3o-estruturadas e, como ser\u00e1 demonstrado, resulta em erros \n\nnum\u00e9ricos que podem ser predominantes nos resultados do EbFVM tradicional. A \n\nmanifesta\u00e7\u00e3o deste erro ser\u00e1 identificada neste texto como um segundo efeito de orienta\u00e7\u00e3o de \n\nmalha porque cria solu\u00e7\u00f5es fortemente dependentes da malha e est\u00e1 relacionado ao c\u00f4mputo \n\ndas mobilidades, caracter\u00edsticas do conhecido efeito de orienta\u00e7\u00e3o de malha considerado no \n\npar\u00e1grafo anterior. \n\nO impacto da utiliza\u00e7\u00e3o das fun\u00e7\u00f5es de interpola\u00e7\u00e3o upwind unidimensionais nos \n\nresultados do m\u00e9todo EbFVM e a manifesta\u00e7\u00e3o dos dois efeitos de orienta\u00e7\u00e3o de malha \n\nmencionados s\u00e3o os assuntos considerados nesta se\u00e7\u00e3o e estudados em problemas-teste \n\nsimples.  \n\n \n\n8.4.1. Deslocamento Radial \n\n \n\nEmpregando elementos quadril\u00e1teros, Bajor e Cormack (1989) propuseram estudar o \n\nefeito de orienta\u00e7\u00e3o de malha em uma geometria radial semelhante \u00e0 apresentada na Fig. 8.8, \n\ne que consiste de um po\u00e7o injetor circundado por po\u00e7os produtores simetricamente \n\n\n\n126 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nposicionados. Elementos triangulares s\u00e3o utilizados para viabilizar as compara\u00e7\u00f5es dos \n\nresultados do m\u00e9todo proposto com os obtidos com os m\u00e9todos tradicionais. \n\n \n\n \n\n \nFig. 8.8 \u2013 Malha utilizada para avaliar o efeito de orienta\u00e7\u00e3o de malha (48 n\u00f3s e 68 elementos) \n\n \n\n \n\nAs raz\u00f5es de mobilidades dos fluidos estudados neste problemas s\u00e3o M =1 e 10. Os \n\ndados utilizados na simula\u00e7\u00e3o para M = 1 est\u00e3o apresentados na Tab. 8.1. Os resultados das \n\nsimula\u00e7\u00f5es para M = 10 foram obtidos utilizando-se os mesmos dados da tabela, modificando-\n\nse a viscosidade do \u00f3leo ( \u00b5o =  10 cp) e as curvas de permeabilidades relativas, que passam a \n\nser definidas da seguinte forma4 \n\n \n\n( )1w\nw\n\nr\nw w\n\nf\nk\n\nM f f\n=\n\n? +\n (8.31) \n\n1\no wr r\n\nk k= ?  (8.32) \n\n  \n\nonde w wf s= . \n\n \n\n \n\n \n\n                                                 \n4 O procedimento de determina\u00e7\u00e3o das curvas de permeabilidade relativa em fun\u00e7\u00e3o do fluxo fracion\u00e1rio e da \nraz\u00e3o de mobilidades \u00e9 recomendado por Yanosik e Mccracken (1979) para os estudos dos efeitos de orienta\u00e7\u00e3o \nde malha. Eles demonstraram que esses efeitos se manifestam em deslocamentos tipo pist\u00e3o que, por sua vez, \nsurgem quando emprega-se express\u00f5es do fluxo fracion\u00e1rio do tipo fw = sw,  fw = sw2, entre outras, acentuando-se \ncom o aumento da raz\u00e3o de mobilidades. \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 127 \n\n \n\n \n\nTab. 8.1 \u2013 Dados usados na simula\u00e7\u00e3o no problema da simula\u00e7\u00e3o radial com M = 1 \n\nPorosidade 0,2 \n\nPermeabilidade (isotr\u00f3pica)  150 mD \n\nEspessura da camada 1 m \n\nViscosidades da \u00e1gua e do \u00f3leo 1 cp \n\nCompressibilidades da \u00e1gua e do \u00f3leo 0 \n\nFatores volume de forma\u00e7\u00e3o da \u00e1gua e do \u00f3leo 1 \n\nswi 0 \n\nsor 0 \n\nkrw  avaliada em sw = 1- sor  1 \n\nkro avaliada em sw = swi 1 \n\nExpoentes da curva de Corey, nw e no 1 \n\nVaz\u00e3o de inje\u00e7\u00e3o de \u00e1gua no po\u00e7o injetor 0,01 m3/d \n\nPress\u00e3o de fundo no po\u00e7o produtor 100 kPa \n\n\u00cdndice de po\u00e7o 1 mD.m \n\nPasso de tempo 0,01 d \n\n \n\n \n\nNa Fig. 8.9 s\u00e3o apresentadas as curvas de corte de \u00e1gua nos po\u00e7os produtores para \n\ndiferentes raz\u00f5es de mobilidades. Observa-se nesta figura que, em virtude de se tratar de um \n\nproblema com deslocamento radial, o m\u00e9todo proposto apresentou os melhores resultados \n\npois suas curvas apresentaram menores diferen\u00e7as de produ\u00e7\u00e3o de \u00e1gua entre os po\u00e7os. \n\nPercebe-se que, embora os resultados do m\u00e9todo proposto apresentem um efeito de orienta\u00e7\u00e3o \n\nde malha que aumenta com a raz\u00e3o de mobilidades, os resultados do EbFVM tradicional \n\napresentaram um aumento ainda maior. \n\nUma outra forma de observar as diferen\u00e7as mostradas na Fig. 8.9 \u00e9 atrav\u00e9s da \n\nvisualiza\u00e7\u00e3o das curvas de iso-satura\u00e7\u00e3o, como as apresentadas na Fig. 8.10. A raz\u00e3o de \n\nmobilidades utilizada neste caso foi M = 1, suficiente para se perceber que a solu\u00e7\u00e3o do \n\nEbFVM proposto neste trabalho, Fig. 8.10b, revela ser mais sim\u00e9trica do que a solu\u00e7\u00e3o obtida \n\npelo m\u00e9todo tradicional, Fig. 8.10a, o que n\u00e3o deixava de ser esperado em fun\u00e7\u00e3o do que foi \n\ndemonstrado na Fig. 8.9. \n\n \n\n \n\n \n\n\n\n128 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nEbFVM tradicional\n\n0\n\n20\n\n40\n\n60\n\n80\n\n100\n\n0 10 20 30 40\n\nt (d)\n\nC\nor\n\nte\n d\n\ne \n\u00c1\n\ngu\na \n\n%\n\n    \n\nEbFVM proposto neste trabalho\n\n0\n\n20\n\n40\n\n60\n\n80\n\n100\n\n0 10 20 30 40\n\nt (d)\n\nC\nor\n\nte\n d\n\ne \n\u00c1\n\ngu\na \n\n%\n\n  \n(a) M = 1 \n\n \n\nEbFVM tradicional\n\n0\n\n20\n\n40\n\n60\n\n80\n\n100\n\n0 10 20 30 40\n\nt (d)\n\nC\nor\n\nte\n d\n\ne \n\u00c1\n\ngu\na \n\n%\n\n     \n\nEbFVM proposto neste trabalho\n\n0\n\n20\n\n40\n\n60\n\n80\n\n100\n\n0 10 20 30 40\n\nt (d)\n\nC\nor\n\nte\n d\n\ne \n\u00c1\n\ngu\na \n\n%\n\n       \n(b) M = 10 \n\n \n\nFig. 8.9 \u2013 Curvas de produ\u00e7\u00e3o de \u00e1gua nos po\u00e7os produtores obtidos pelos m\u00e9todos EbFVM tradicional e \n\nproposto neste trabalho para diferentes raz\u00f5es de mobilidade \n\n \n\n \n\n \n\n    \n                             (a) EbFVM tradicional                                                 (b) M\u00e9todo proposto \n\n \n\nFig. 8.10  \u2013 Isolinhas de satura\u00e7\u00e3o para o tempo de simula\u00e7\u00e3o de 23 dias obtidas pelos diferentes m\u00e9todos \n\n \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 129 \n\n \n\n \n\n Esta defici\u00eancia do m\u00e9todo EbFVM tradicional se acentua quando s\u00e3o utilizados \n\ntri\u00e2ngulos com piores raz\u00f5es de aspecto, como mostrado a seguir. \n\n \n\n \n\n8.4.2. Malhas de Tri\u00e2ngulos Obtus\u00e2ngulos \n\n \n\n O pr\u00f3ximo caso analisado envolve a simula\u00e7\u00e3o de um reservat\u00f3rio de petr\u00f3leo \n\ndiscretizado com uma malha composta apenas por tri\u00e2ngulos obtus\u00e2ngulos, isto \u00e9, tri\u00e2ngulos \n\nque cont\u00eam um \u00e2ngulo maior que 90\u00ba, como os apresentados na Fig. 8.11. De acordo com o \n\nque \u00e9 descrito na literatura, elementos deste tipo deveriam ser evitados, uma vez que \n\nresultariam em \u201ctrasmissibilidades negativas\u201d (FUNG et al., 1993; SONIER et al., 1993). \n\nPretende-se mostrar o impacto da utiliza\u00e7\u00e3o destes elementos nos resultados dos diferentes \n\nm\u00e9todos. \n\n \n\n \n\n \nFig. 8.11 \u2013 Malha de tri\u00e2ngulos utilizada nas simula\u00e7\u00f5es (17 n\u00f3s e 24 elementos) \n\n \n\n \n\nNeste exemplo a inje\u00e7\u00e3o de \u00e1gua se d\u00e1 no po\u00e7o localizado no canto direito inferior da \n\nmalha e a produ\u00e7\u00e3o se d\u00e1 no canto oposto. Os dados utilizados nas simula\u00e7\u00f5es s\u00e3o os mesmos \n\ndo problema anterior e est\u00e3o detalhados na Tab. 8.1, com exce\u00e7\u00e3o da vaz\u00e3o de \u00e1gua no po\u00e7o \n\ninjetor, que neste caso foi aumentada para 0,1 m3/d. \n\n  A Fig. 8.12 apresenta a compara\u00e7\u00e3o das curvas de produ\u00e7\u00e3o de \u00e1gua no po\u00e7o produtor \n\nobtidas pelo simulador comercial STARS, utilizando o m\u00e9todo EbFVM tradicional, e pelo \n\nsimulador desenvolvido neste trabalho. \n\n\n\n130 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n \nFig. 8.12 \u2013 Compara\u00e7\u00e3o das curvas de produ\u00e7\u00e3o de \u00e1gua \n\n \n\n  \n\n Embora na Fig. 8.12 n\u00e3o sejam t\u00e3o evidentes as diferen\u00e7as entre os resultados, os \n\ncampos de satura\u00e7\u00e3o originados pelos dois m\u00e9todos s\u00e3o significativamente diferentes, como \n\nmostrado na Fig. 8.13. A despeito da malha utilizada n\u00e3o ser perfeitamente sim\u00e9trica (Fig. \n\n8.11), o EbFVM tradicional apresentou resultados com demasiada assimetria e com a frente \n\nde satura\u00e7\u00e3o pouco realista, uma vez que o escoamento de \u00e1gua parece n\u00e3o estar se dando \n\npreferencialmente na dire\u00e7\u00e3o da linha que une os po\u00e7os injetor e produtor conforme pode ser \n\nvisto no lado direito da Fig. 8.13a. Isso n\u00e3o aconteceu com os resultados obtidos pelo m\u00e9todo \n\nproposto, que demonstraram ser fisicamente mais coerentes e significativamente melhores \n\n(Fig. 8.13b). \n\n \n\n \n\n8.4.3. Arranjo de Po\u00e7os Five-Spot \n\n \n\nO esquema five-spot \u00e9 um arranjo de po\u00e7os bastante conhecido e um dos mais \n\nimportantes esquemas de inje\u00e7\u00e3o do tipo padr\u00e3o repetido5. O padr\u00e3o-base consiste em um \n\npo\u00e7o produtor rodeado por quatro po\u00e7os injetores, como mostrado na Fig. 8.14a e b. A sua \n\nutiliza\u00e7\u00e3o no estudo dos efeitos de orienta\u00e7\u00e3o de malha foi introduzida por Todd et al. (1972),  \n\n \n                                                 \n5 Os esquemas de inje\u00e7\u00e3o visam aumentar a recupera\u00e7\u00e3o de petr\u00f3leo e s\u00e3o classificados em dois grupos \nprincipais: inje\u00e7\u00e3o perif\u00e9rica e inje\u00e7\u00e3o em padr\u00e3o repetido (ou inje\u00e7\u00e3o em malhas). No primeiro grupo, os po\u00e7os \ninjetores est\u00e3o localizados na base (periferia) do reservat\u00f3rio e os produtores se agrupam na sua parte central. No \nsegundo grupo, os po\u00e7os est\u00e3o uniformemente distribu\u00eddos em toda a \u00e1rea do reservat\u00f3rio, seguindo um padr\u00e3o \nou malha b\u00e1sica que se repete em todo o dom\u00ednio (ROSA et al., 2006). \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 131 \n\n \n\n \n\n                 \nt = 1,25d                                      t = 2,09 d \n\n(a) EbFVM tradicional \n\n \n\n                            \nt = 1,25d                                      t = 2,09 d \n\n (b) EbFVM proposto \n\n \n\nFig. 8.13 \u2013 Mapas de satura\u00e7\u00e3o obtidos pelos diferentes m\u00e9todos para dois tempos de simula\u00e7\u00e3o \n\n \n\n \n\n \n\nque demonstrou que, devido \u00e0 simetria geom\u00e9trica, a discretiza\u00e7\u00e3o espacial pode ser realizada \n\nutilizando-se duas malhas:   \n\n \n\n(1) com uma malha orientada diagonalmente entre os po\u00e7os, representando um quarto \n\ndo padr\u00e3o-base do arranjo de po\u00e7os five-spot (Fig. 8.14a), e \n\n \n\n(2) com uma malha orientada paralelamente \u00e0 linha que une o po\u00e7o injetor ao produtor \n\n(metade deste padr\u00e3o-base), como mostrado na Fig. 8.14b.  \n\n \n\nNa regi\u00e3o de intersec\u00e7\u00e3o das duas malhas (Fig. 8.14c) espera-se obter resultados \n\nid\u00eanticos. No entanto, sabe-se da literatura que, utilizando malhas Cartesianas regulares, os \n\nresultados s\u00e3o diferentes, especialmente para altas raz\u00f5es de mobilidade. \n\n\n\n132 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n \n (a) Malha diagonal               (b) Malha paralela       (c) Superposi\u00e7\u00e3o das malhas \n\n \n\nFig. 8.14 \u2013 Malhas utilizadas no arranjo de po\u00e7os five-spot \n\n \n\n  \n\n Em fun\u00e7\u00e3o da possibilidade de empregar elementos triangulares na discretiza\u00e7\u00e3o \n\nespacial do dom\u00ednio, pode-se facilitar a interpreta\u00e7\u00e3o dos resultados simulando o escoamento \n\nna \u00e1rea de superposi\u00e7\u00e3o das malhas utilizando malhas como as apresentadas na Fig. 8.15, que \n\nrepresentam \u00bc e \u00bd das malhas paralela e diagonal do esquema five-spot, respectivamente. \n\nNota-se que os elementos triangulares foram criados dividindo ao meio cada elemento \n\nquadril\u00e1tero original da malha Cartesiana, e por isso aparecem rotacionados em 90\u00ba. Tratam-\n\nse, portanto, de malhas regulares. \n\nForam simulados quatro casos, envolvendo diferentes raz\u00f5es de mobilidade: M = \n\n1/100, 1, 4 e 10. Os dados usados na simula\u00e7\u00e3o est\u00e3o apresentados na Tab. 8.2, al\u00e9m das \n\ncurvas de permeabilidade relativa, definidas a partir das Eqs. (8.31) e (8.32) com 2w wf s= . \n\n \n\n \n\n \n\n                       \n \n\n(a) Malha paralela    (b) Malha diagonal  \n \n\nFig. 8.15 \u2013 Malhas utilizadas na simula\u00e7\u00e3o do problema five-spot \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 133 \n\n \n\n \n\nTab. 8.2 \u2013 Dados usados na simula\u00e7\u00e3o no problema five-spot com M = 1 \n\nPorosidade 0,2 \n\nPermeabilidade (isotr\u00f3pica)  150 mD \n\nEspessura da camada 1 m \n\nViscosidades da \u00e1gua e do \u00f3leo 1 cp \n\nCompressibilidades da \u00e1gua e do \u00f3leo 0 \n\nFatores volume de forma\u00e7\u00e3o da \u00e1gua e do \u00f3leo 1 \n\nswi 0 \n\nsor 0 \n\nVaz\u00e3o de inje\u00e7\u00e3o de \u00e1gua no po\u00e7o injetor 0,05 m3/d \n\nPress\u00e3o de fundo no po\u00e7o produtor 100 kPa \n\n\u00cdndice de po\u00e7o 1 mD.m \n\nPasso de tempo 0,001 d \n\n \n\n  \n\nOs resultados obtidos pelos m\u00e9todos EbFVM tradicional e o proposto neste trabalho \n\npara as malhas da Fig. 8.15 s\u00e3o comparados na Fig. 8.16 para diferentes raz\u00f5es de mobilidade. \n\nNota-se que ambos os m\u00e9todos apresentam diferen\u00e7as de produ\u00e7\u00e3o de \u00e1gua no po\u00e7o produtor \n\nentre as malhas paralela e diagonal. No entanto, no m\u00e9todo tradicional, \u00e0 medida que a raz\u00e3o \n\nde mobilidade aumenta, o efeito de orienta\u00e7\u00e3o de malha aumenta em uma propor\u00e7\u00e3o maior \n\nque no EbFVM proposto. Importante mencionar que ambos os m\u00e9todos utilizaram as mesmas \n\nfun\u00e7\u00f5es de interpola\u00e7\u00e3o para a mobilidade (upwind). Um outro ponto que merece ser \n\ndestacado \u00e9 que os resultados da malha diagonal do m\u00e9todo proposto se aproximam dos da \n\nmalha paralela do m\u00e9todo tradicional, resultando num efeito de orienta\u00e7\u00e3o de malha invertido \n\ndo tradicional relatado na literatura, para todas as raz\u00f5es de mobilidade pesquisadas. \n\n \n\nDiscuss\u00e3o. O comportamento an\u00f4malo das solu\u00e7\u00f5es obtidas com o m\u00e9todo tradicional \n\nmostrado na Fig. 8.16d, que se manifesta, principalmente, para altas raz\u00f5es de mobilidade e \n\nque se caracteriza pelo aumento repentino da produ\u00e7\u00e3o de \u00e1gua na malha paralela e a \n\ndiminui\u00e7\u00e3o na seq\u00fc\u00eancia, \u00e9 id\u00eantico \u00e0s das curvas produzidas por malhas Cartesianas e \n\nrelatadas na literatura (YANOSIK e McCRACKEN, 1979; BAJOR e CORMACK, 1989; \n\nSHIN e MERCHANT, 1993). Estes resultados se manifestam exatamente quando a malha de \n\ntri\u00e2ngulos \u00e9 constru\u00edda dividindo-se quadril\u00e1teros em tri\u00e2ngulos ret\u00e2ngulos, sendo esta a raz\u00e3o \n\nda recomenda\u00e7\u00e3o de alguns autores de evitar este procedimento de gera\u00e7\u00e3o de malha \n\n\n\n134 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n(SONIER e EYMARD, 1993). Na realidade, a raz\u00e3o da semelhan\u00e7a dos resultados \n\napresentados com os resultados de malhas Cartesianas pode ser facilmente compreendida: \n\ncom este tipo de malha, o coeficiente correspondente \u00e0 conex\u00e3o entre os dois n\u00f3s separados \n\npela hipotenusa do tri\u00e2ngulo \u00e9 anulado. O resultado, portanto, \u00e9 um esquema de c\u00e1lculo de \n\nfluxos por 5 pontos que tem as mesmas caracter\u00edsticas do cartesiano, incluindo seu principal \n\nponto fraco: o efeito de orienta\u00e7\u00e3o de malha demasiadamente acentuado. \n\n \n\n \n\n0\n\n20\n\n40\n\n60\n\n80\n\n100\n\n0 1 2 3 4\n\nt (d)\n\nC\nor\n\nte\n d\n\ne \n\u00c1\n\ngu\na \n\n%\n\nEbFVM tradicional - paralela\nEbFVM tradicional - diagonal\nEbFVM - paralela\nEbFVM - diagonal\n\n              \n\n0\n\n20\n\n40\n\n60\n\n80\n\n100\n\n0 1 2 3 4\n\nt (d)\n\nC\nor\n\nte\n d\n\ne \n\u00c1\n\ngu\na \n\n%\nEbFVM tradicional - paralela\nEbFVM tradicional - diagonal\nEbFVM - paralela\nEbFVM - diagonal\n\n   \n   (a) M = 0,01              (b) M = 1 \n\n \n\n0\n\n20\n\n40\n\n60\n\n80\n\n100\n\n0 1 2 3 4\n\nt (d)\n\nC\nor\n\nte\n d\n\ne \n\u00c1\n\ngu\na \n\n%\n\nEbFVM tradicional - paralela\nEbFVM tradicional - diagonal\nEbFVM - paralela\nEbFVM - diagonal\n\n                  \n\n0\n\n20\n\n40\n\n60\n\n80\n\n100\n\n0 1 2 3 4\n\nt (d)\n\nC\nor\n\nte\n d\n\ne \n\u00c1\n\ngu\na \n\n%\n\nEbFVM tradicional - paralela\nEbFVM tradicional - diagonal\nEbFVM - paralela\nEbFVM - diagonal\n\n    \n      (c) M = 4                         (d) M = 10 \n\n \n\nFig. 8.16 \u2013 Compara\u00e7\u00e3o das curvas de produ\u00e7\u00e3o de \u00e1gua no po\u00e7o produtor obtidas por diferentes m\u00e9todos que \n\nutilizam a mesma fun\u00e7\u00e3o de interpola\u00e7\u00e3o upwind para avaliar as mobilidades \n\n \n\n \n\n  \n\n Considera\u00e7\u00f5es sobre a fun\u00e7\u00e3o upwind. Como mencionado anteriormente, os \n\nresultados da Fig. 8.16 foram obtidos para ambos os m\u00e9todos aproximando a mobilidade nas \n\ninterfaces dos volumes de controle atrav\u00e9s da fun\u00e7\u00e3o de interpola\u00e7\u00e3o upwind. Diversos \n\ntrabalhos t\u00eam mostrado que o c\u00e1lculo da avalia\u00e7\u00e3o das mobilidades \u00e9 uma quest\u00e3o-chave na \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 135 \n\n \n\n \n\nredu\u00e7\u00e3o do efeito de orienta\u00e7\u00e3o de malha, sendo propostas diferentes fun\u00e7\u00f5es upwind para a \n\nobten\u00e7\u00e3o de resultados mais razo\u00e1veis (TODD et al., 1972; VINSOME e AU, 1979; \n\nFRAUENTHAL et al., 1985), mas que s\u00e3o de dif\u00edcil aplica\u00e7\u00e3o em malhas n\u00e3o-estruturadas.  \n\nComo foi discutido no Cap. 5, a equa\u00e7\u00e3o da press\u00e3o \u00e9 uma equa\u00e7\u00e3o el\u00edptica e, por isso, \n\npermitiria, ao contr\u00e1rio da equa\u00e7\u00e3o da satura\u00e7\u00e3o, a utiliza\u00e7\u00e3o de uma fun\u00e7\u00e3o de interpola\u00e7\u00e3o \n\nde mais alta ordem na avalia\u00e7\u00e3o das mobilidades sem ocasionar oscila\u00e7\u00f5es na solu\u00e7\u00e3o.  Por \n\nesta raz\u00e3o, foi implementada a op\u00e7\u00e3o de resolver a equa\u00e7\u00e3o da press\u00e3o calculando as \n\nmobilidades atrav\u00e9s das pr\u00f3prias fun\u00e7\u00f5es de forma, que \u00e9 um procedimento bastante trivial no \n\nm\u00e9todo proposto, conforme pode ser visto no Anexo 8. Na equa\u00e7\u00e3o da satura\u00e7\u00e3o continuar-se-\n\n\u00e1 avaliando a mobilidade (escrita, agora, em termos do fluxo fracion\u00e1rio) com a fun\u00e7\u00e3o \n\nupwind. A aplica\u00e7\u00e3o pr\u00e1tica desta nova formula\u00e7\u00e3o nos problemas analisados nesta se\u00e7\u00e3o \n\npode ser visto na Fig. 8.17, que compara a nova solu\u00e7\u00e3o, identificada como EbFVM (FF), \n\ncom a obtida empregando a fun\u00e7\u00e3o de interpola\u00e7\u00e3o upwind nas duas equa\u00e7\u00f5es: satura\u00e7\u00e3o e \n\npress\u00e3o, representada por EbFVM (U). \n\nNota-se na Fig. 8.17a e b que as solu\u00e7\u00f5es EbFVM (FF) e EbFVM (U) obtidas com \n\nbaixas raz\u00f5es de mobilidade s\u00e3o praticamente id\u00eanticas independentemente da aproxima\u00e7\u00e3o \n\nda mobilidade na equa\u00e7\u00e3o da press\u00e3o. Mas, mesmo assim, as solu\u00e7\u00f5es das malhas diagonal e \n\nparalela n\u00e3o s\u00e3o ainda id\u00eanticas, apresentando um pequeno efeito de orienta\u00e7\u00e3o de malha \n\nremanescente, que pode estar sendo ocasionado pela aproxima\u00e7\u00e3o da mobilidade por fun\u00e7\u00e3o \n\nupwind na equa\u00e7\u00e3o da satura\u00e7\u00e3o, que continua sendo realizada. \n\nQuando a raz\u00e3o de mobilidades aumenta, Fig. 8.17c e d, o efeito de orienta\u00e7\u00e3o de \n\nmalha aumenta em uma propor\u00e7\u00e3o menor quando s\u00e3o utilizadas as fun\u00e7\u00f5es de forma na \n\navalia\u00e7\u00e3o das mobilidades na equa\u00e7\u00e3o da press\u00e3o, indicando que estas fun\u00e7\u00f5es de interpola\u00e7\u00e3o \n\nde mais alta ordem est\u00e3o contribuindo, mesmo que parcialmente, apenas na equa\u00e7\u00e3o da \n\npress\u00e3o, para a redu\u00e7\u00e3o do efeito de orienta\u00e7\u00e3o de malha. \n\n \n\n \n\n\n\n136 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n0\n\n20\n\n40\n\n60\n\n80\n\n100\n\n0 1 2 3 4\n\nt (d)\n\nC\nor\n\nte\n d\n\ne \n\u00c1\n\ngu\na \n\n%\n\nEbFVM (FF) - paralela\nEbFVM (FF) - diagonal\nEbFVM (U) - paralela\nEbFVM (U) - diagonal\n\n               \n\n0\n\n20\n\n40\n\n60\n\n80\n\n100\n\n0 1 2 3 4\n\nt (d)\n\nC\nor\n\nte\n d\n\ne \n\u00c1\n\ngu\na \n\n%\n\nEbFVM (FF) - paralela\nEbFVM (FF) - diagonal\nEbFVM (U) - paralela\nEbFVM (U) - diagonal\n\n  \n   (a) M = 0,01              (b) M = 1 \n\n \n\n0\n\n20\n\n40\n\n60\n\n80\n\n100\n\n0 1 2 3 4\n\nt (d)\n\nC\nor\n\nte\n d\n\ne \n\u00c1\n\ngu\na \n\n%\n\nEbFVM (FF) - paralela\nEbFVM (FF) - diagonal\nEbFVM (U) - paralela\nEbFVM (U) - diagonal\n\n                \n\n0\n\n20\n\n40\n\n60\n\n80\n\n100\n\n0 1 2 3 4\n\nt (d)\n\nC\nor\n\nte\n d\n\ne \n\u00c1\n\ngu\na \n\n%\n\nEbFVM (FF) - paralela\nEbFVM (FF) - diagonal\nEbFVM (U) - paralela\nEbFVM (U) - diagonal\n\n   \n     (c) M = 4                       (d) M = 10 \n\n \n\nFig. 8.17 \u2013 Compara\u00e7\u00e3o das curvas de produ\u00e7\u00e3o de \u00e1gua no po\u00e7o produtor obtidas pelo m\u00e9todo EbFVM \n\nutilizando como fun\u00e7\u00e3o de interpola\u00e7\u00e3o da mobilidade na equa\u00e7\u00e3o da press\u00e3o as fun\u00e7\u00f5es de forma (FF) ou  a \n\nfun\u00e7\u00e3o de interpola\u00e7\u00e3o upwind (U) \n\n \n\n   \n\n  \n\nA Fig. 8.18 compara os mapas de isolinhas de satura\u00e7\u00e3o das malhas paralelas e \n\ndiagonais obtidas com M = 10, para um tempo de simula\u00e7\u00e3o de 1 dia, produzidas pelo m\u00e9todo \n\nEbFVM tradicional (software comercial STARS), e pelo m\u00e9todo EbFVM proposto utilizando \n\nas fun\u00e7\u00f5es upwind e as fun\u00e7\u00f5es de forma na avalia\u00e7\u00e3o das mobilidades na equa\u00e7\u00e3o da press\u00e3o. \n\nPercebe-se que o efeito de orienta\u00e7\u00e3o de malha \u00e9 menos acentuado no terceiro caso. \n\n \n\nConclus\u00e3o. As solu\u00e7\u00f5es mostradas na Fig. 8.18a e Fig. 8.18b s\u00e3o obtidas \n\nessencialmente pelo mesmo m\u00e9todo e com o mesmo esquema de avalia\u00e7\u00e3o das mobilidades - \n\nupwind. Como os resultados do m\u00e9todo EbFVM tradicional apresentaram um maior efeito de \n\norienta\u00e7\u00e3o de malha, entende-se que o efeito adicional que contaminou seus resultados deve-\n\nse \u00e0 forma como s\u00e3o obtidas as suas equa\u00e7\u00f5es multif\u00e1sicas discretizadas, isto \u00e9, atrav\u00e9s da \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 137 \n\n \n\n \n\nadapta\u00e7\u00e3o da equa\u00e7\u00e3o monof\u00e1sica. Quando s\u00e3o utilizadas as equa\u00e7\u00f5es discretizadas \n\nprovenientes da integra\u00e7\u00e3o das equa\u00e7\u00f5es diferenciais multif\u00e1sicas, que \u00e9 o procedimento usual \n\ndo M\u00e9todo de Volumes Finitos, o \u00fanico efeito de orienta\u00e7\u00e3o de malha remanescente tem \n\norigem na fun\u00e7\u00e3o de interpola\u00e7\u00e3o de baixa ordem utilizada. Ao ser utilizada outra fun\u00e7\u00e3o de \n\ninterpola\u00e7\u00e3o das mobilidades na equa\u00e7\u00e3o da press\u00e3o, o efeito de orienta\u00e7\u00e3o de malha \n\nresultante \u00e9 menor, embora continue existindo pois a fun\u00e7\u00e3o de baixa ordem (upwind) ainda \n\npermanece na equa\u00e7\u00e3o da satura\u00e7\u00e3o.  \n\n \n\n \n\n    \nMalha paralela    Malha diagonal \n\n(a)  EbFVM tradicional (simulador comercial) \n \n\n    \nMalha paralela    Malha diagonal \n\n(b) EbFVM proposto (U) \n  \n\n    \nMalha paralela    Malha diagonal \n\n(c) EbFVM proposto (FF) \n\n \n\nFig. 8.18 \u2013 Mapas de iso-satura\u00e7\u00f5es (sw=0.2, 0.4, 0.6 e 0.8) obtidos por diferentes m\u00e9todos para raz\u00e3o de \n\nmobilidade M = 10,  para um tempo de simula\u00e7\u00e3o de 1 dia. \n\n \n\n\n\n138 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nA solu\u00e7\u00e3o para a elimina\u00e7\u00e3o completa do efeito de orienta\u00e7\u00e3o de malha seria substituir \n\nas fun\u00e7\u00f5es upwind unidimensionais6 na equa\u00e7\u00e3o da satura\u00e7\u00e3o por fun\u00e7\u00f5es upwind mais \n\naprimoradas, que verdadeiramente baseiam-se na dire\u00e7\u00e3o das linhas de correntes e fiquem \n\nmenos vinculadas \u00e0s linhas da malha. Este assunto n\u00e3o foi estudado nesta tese, mas j\u00e1 foi \n\ninvestigado em outros trabalhos (RAW, 1985; HURTADO, 2005). Em suma, os autores \n\nmostram que estas novas fun\u00e7\u00f5es produzem resultados com menor orienta\u00e7\u00e3o de malha e, \n\nainda assim, sem as oscila\u00e7\u00f5es t\u00edpicas das fun\u00e7\u00f5es de interpola\u00e7\u00e3o de maior ordem. Neste \n\ncaso o valor interpolado passa a ser fun\u00e7\u00e3o de todos os valores nodais do elemento e n\u00e3o de \n\napenas de um, como \u00e9 o procedimento resultante da fun\u00e7\u00e3o upwind unidimensional \n\nusualmente empregada. \n\nA despeito do fato de que as fun\u00e7\u00f5es de interpola\u00e7\u00e3o t\u00eam papel decisivo na redu\u00e7\u00e3o do \n\nefeito de orienta\u00e7\u00e3o de malha, \u00e9 importante mencionar que \u00e9 sempre prefer\u00edvel, em casos \n\npr\u00e1ticos, utilizar malhas com orienta\u00e7\u00e3o rand\u00f4mica de elementos (triangulares e/ou \n\nquadrangulares), a fim de n\u00e3o criar dire\u00e7\u00f5es preferenciais para a manifesta\u00e7\u00e3o do erro \n\nocasionado pelo esquema de avalia\u00e7\u00e3o das mobilidades. Isso \u00e9 poss\u00edvel e \u00e9 o grande trunfo da \n\nutiliza\u00e7\u00e3o das malhas n\u00e3o-estruturadas, pois os geradores de malhas normalmente n\u00e3o t\u00eam \n\ndificuldades em gerar malhas irregulares. \n\n \n\n \n\n \n\n8.5. Compara\u00e7\u00e3o entre os Diferentes Esquemas de \nRepresenta\u00e7\u00e3o de Propriedades F\u00edsicas e Falhas \n\nGeol\u00f3gicas no EbFVM \n \n\nNo Cap. 4 foram apresentadas diferentes formas de armazenar as propriedades f\u00edsicas \n\ne falhas geol\u00f3gicas em reservat\u00f3rios heterog\u00eaneos. Foi mostrado que as propriedades f\u00edsicas, \n\ncomo permeabilidade absoluta e porosidade, podem ser armazenadas tanto nos volumes de \n\ncontrole (VERMA e AZIZ, 1997; STARS User\u2019s Guide, 2002) como nos elementos, \n\nconforme proposto neste trabalho. Deve-se lembrar que os elementos s\u00e3o as entidades \n\n                                                 \n6 As fun\u00e7\u00f5es upwind empregadas neste trabalho podem ser consideradas como unidimensionais porque o valor  a \nser avaliado na face perpendicular a dois n\u00f3s ser\u00e1 sempre fun\u00e7\u00e3o de apenas um destes, aquele n\u00f3, que de acordo \ncom algum crit\u00e9rio, for considerado \u00e0 montante desta face.  \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 139 \n\n \n\n \n\ngeom\u00e9tricas definidas pelos n\u00f3s da malha, enquanto que os volumes de controle s\u00e3o as \n\nentidades constru\u00eddas ao redor destes n\u00f3s, nas interfaces dos quais s\u00e3o calculados os fluxos.  \n\nO impacto nos resultados da aplica\u00e7\u00e3o de cada esquema de representa\u00e7\u00e3o ser\u00e1 \n\nanalisado em dois problemas-teste. \n\n \n\n8.5.1. Reservat\u00f3rio Heterog\u00eaneo sem Falhas Geol\u00f3gicas \n\n \n\n Considere o reservat\u00f3rio heterog\u00eaneo apresentado na Fig. 8.19, discretizado \n\nutilizando-se os dois esquemas apresentados no in\u00edcio do cap\u00edtulo, isto \u00e9, modelando cada \n\nvolume de controle com um \u00fanico valor de permeabilidade, Fig. 8.19a, ou modelando cada \n\nelemento da malha atrav\u00e9s de um \u00fanico valor de permeabilidade, Fig. 8.19b. Note que o \n\nprocedimento de constru\u00e7\u00e3o dos volumes de controle que consiste em unir a mediana das \n\nfaces dos elementos ao seu baricentro resulta em volumes como o ilustrado na  Fig. 8.19a em \n\ntracejado. Para facilitar a visualiza\u00e7\u00e3o, os demais volumes de controle n\u00e3o s\u00e3o identificados \n\nem ambas as figuras. Os elementos est\u00e3o representados com linha cheia. Os dados utilizados \n\nna simula\u00e7\u00e3o s\u00e3o apresentados na Tab. 8.3, enquanto que a posi\u00e7\u00e3o dos po\u00e7os injetores e \n\nprodutores est\u00e1 destacada na Fig. 8.19.  \n\n\u00c9 importante destacar que uma situa\u00e7\u00e3o ideal para as compara\u00e7\u00f5es seria utilizar, \n\nexatamente, as mesmas malhas nos dois casos. Por\u00e9m, isso n\u00e3o \u00e9 poss\u00edvel em fun\u00e7\u00e3o da \n\nnecessidade de representar, a partir de esquemas diferentes de armazenamento de \n\npropriedades, um mesmo reservat\u00f3rio heterog\u00eaneo. \n\n \n\n \n\n                                 \n(a) Esquema em que k \u00e9 armazenado no volume                (b) Esquema em que k \u00e9 armazenado no elemento                            \n\nFig. 8.19 \u2013 Diferentes discretiza\u00e7\u00f5es do reservat\u00f3rio heterog\u00eaneo em estudo \n\n\n\n140 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nTab. 8.3 \u2013 Propriedades f\u00edsicas e par\u00e2metros num\u00e9ricos utilizados \n\nPorosidade 0,2 \n\nEspessura da camada 1 m \n\nViscosidades da \u00e1gua e do \u00f3leo 1 cp \n\nCompressibilidades da \u00e1gua e do \u00f3leo 0 \n\nFatores volume de forma\u00e7\u00e3o da \u00e1gua e do \u00f3leo 1 \n\nswi 0 \n\nsor 0 \n\nkrw  avaliada em sw = 1- sor  1 \n\nkro avaliada em sw = swi 1 \n\nExpoentes da curva de Corey, nw e no 1 \n\nVaz\u00e3o de inje\u00e7\u00e3o de \u00e1gua no po\u00e7o injetor 0,1 m3/d \n\nPress\u00e3o de fundo no po\u00e7o produtor 100 kPa \n\n\u00cdndice de po\u00e7o 1 mD.m \n\nPasso de tempo 0,01 d \n\n \n \n\nEmbora possa ser mostrado que o campo de satura\u00e7\u00e3o, e em conseq\u00fc\u00eancia, as curvas \n\nde produ\u00e7\u00e3o obtidas com cada uma das malhas da Fig. 8.19 n\u00e3o sejam muito diferentes, os \n\ncampos de press\u00e3o obtidos em cada caso s\u00e3o bastante distintos, como mostra a Fig. 8.20. \n\nNota-se que o campo de press\u00e3o obtido pelo esquema que armazena a permeabilidade no \n\ncentro do volume de controle apresenta oscila\u00e7\u00f5es, Fig. 8.20a. J\u00e1 o outro esquema, que \u00e9 \n\naquele em que o campo de permeabilidades \u00e9 armazenado nos elementos, apresentou os \n\nresultados qualitativamente esperados, Fig. 8.20b, pois reproduz a forma t\u00edpica do campo de \n\npress\u00e3o encontrado nas malhas diagonais do esquema five-spot. \n\nOs resultados fisicamente inconsistentes da Fig. 8.20a podem ter tr\u00eas origens. A \n\nprimeira pode ser a grande descontinuidade do campo de permeabilidade absoluta no interior \n\ndo elemento que ainda existe independentemente do procedimento de m\u00e9dia harm\u00f4nica nos \n\npontos de integra\u00e7\u00e3o. Essa descontinuidade parece ser incompat\u00edvel com a aproxima\u00e7\u00e3o bi-\n\nlinear do campo de press\u00e3o no interior imposta pela utiliza\u00e7\u00e3o de fun\u00e7\u00f5es de forma. A \n\nseguinte origem tem a ver com o tipo de m\u00e9dia empregada, porque possivelmente a m\u00e9dia \n\nharm\u00f4nica n\u00e3o seja a mais indicada para esta opera\u00e7\u00e3o. Conforme descrito no Cap. 4, diversos \n\ntrabalhos da literatura t\u00eam acenado nesta dire\u00e7\u00e3o. Finalmente, n\u00e3o se pode descartar a \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 141 \n\n \n\n \n\ninflu\u00eancia da malha mais grosseira, em rela\u00e7\u00e3o a do outro m\u00e9todo, que foi empregada nesta \n\ncompara\u00e7\u00e3o.  \n\n \n\n \n\n \n\n              \n \n\n(a) Esquema em que k \u00e9 armazenado no volume                (b) Esquema em que k \u00e9 armazenado no elemento                            \n \n\nFig. 8.20 \u2013 Campo de press\u00e3o obtido com cada t\u00e9cnica de armazenamento das propriedades no problema do \n\nreservat\u00f3rio heterog\u00eaneo analisado  \n\n \n\n \n\n \n\n  No m\u00e9todo utilizado no segundo caso em que as propriedades f\u00edsicas s\u00e3o armazenadas \n\nnos elementos, Fig. 8.19b, n\u00e3o h\u00e1 a necessidade de fazer nenhum tipo de m\u00e9dia para obter a \n\npermeabilidade no ponto de integra\u00e7\u00e3o, uma vez que ela \u00e9 constante dentro do elemento. \n\nNeste caso desaparecem tamb\u00e9m todas as dificuldades associadas a descontinuidades no \n\nelemento e a fun\u00e7\u00e3o de interpola\u00e7\u00e3o bi-linear. Um outro ponto positivo deste esquema de \n\narmazenamento \u00e9 a facilidade de mapear um dom\u00ednio heterog\u00eaneo com um malha de \n\nelementos, sem a necessidade de checar uma segunda malha, a dual de volumes de controle, \n\nonde as propriedades poderiam estar armazenadas. Assim, a melhor alternativa parece ser \n\nutilizar um m\u00e9todo num\u00e9rico baseado no elemento, como o proposto neste trabalho.  \n\n \n\n8.5.2. Reservat\u00f3rio Heterog\u00eaneo com Falhas Geol\u00f3gicas \n\n \n\nPara estudar a aplica\u00e7\u00e3o das metodologias de representa\u00e7\u00e3o de falhas em malhas n\u00e3o-\n\nestruturadas apresentadas no Cap. 4, foi concebido um problema cuja geometria \u00e9 apresentada \n\nna Fig. 8.21a que, em virtude da configura\u00e7\u00e3o da falha geol\u00f3gica, ser\u00e1 denominado de \n\n\n\n142 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n\u201cproblema do labirinto\u201d. Nesta mesma figura ainda s\u00e3o apresentados a posi\u00e7\u00e3o dos po\u00e7os \n\ninjetor e produtor e as dimens\u00f5es do reservat\u00f3rio hipot\u00e9tico em estudo. As propriedades \n\nf\u00edsicas s\u00e3o as mesmas utilizadas no problema anterior e est\u00e3o descritas na Tab. 8.3. A partir da \n\ngeometria apresentada, dois diferentes casos ser\u00e3o analisados, e suas diferen\u00e7as est\u00e3o \n\nbaseadas no valor do campo de permeabilidade absoluta de uma dada regi\u00e3o do dom\u00ednio, \n\naquela que aparece destacada na Fig. 8.21b. A permeabilidade k2 utilizada nesta regi\u00e3o \u00e9 de \n\n5000 mD, para um reservat\u00f3rio homog\u00eaneo, e de 50 mD para um reservat\u00f3rio heterog\u00eaneo. \n\n \n\n \n\n                 \n                        (b) Permeabilidades absolutas \n                     (a) Reservat\u00f3rio e falha                                                   utilizadas \n\n  \n\nFig. 8.21 \u2013 O reservat\u00f3rio e a defini\u00e7\u00e3o da falha no problema do labirinto \n\n \n\nNo primeiro modelo de representa\u00e7\u00e3o de falha, em que ela \u00e9 caracterizada pelo \n\ncancelamento dos fluxos, ser\u00e1 empregada a malha apresentada na Fig. 8.22, que consiste de \n\nnove elementos quadrangulares e 16 n\u00f3s (ou 16 volumes de controle). No programa \n\ncomputacional, basta anular todos os fluxos localizados nas interfaces dos volumes de \n\ncontrole geometricamente coincidentes com a falha. Observe que se a falha estivesse mais \n\npr\u00f3xima da fronteira norte do reservat\u00f3rio, seria necess\u00e1rio um maior n\u00famero de elementos na \n\nmalha se desej\u00e1ssemos ainda uma malha igualmente espa\u00e7ada. Isto aconteceria porque \u00e9 \n\nnecess\u00e1rio que os pontos de integra\u00e7\u00e3o sejam coincidentes com a falha para que os fluxos \n\nsejam anulados. \n\n \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 143 \n\n \n\n \n\n                       \n(a) Malha utilizada                                       (b) Destaque para os n\u00f3s, elementos e volumes \n\n \n\n \n(c) Destaque para a posi\u00e7\u00e3o da falha \n\n \n\nFig. 8.22 \u2013 Malha utilizada no problema do labirinto simulando a falha atrav\u00e9s do cancelamento dos fluxos \n\n  \n\n \n\nA outra op\u00e7\u00e3o de modelar falhas consiste em represent\u00e1-las utilizando elementos com \n\nespessura reduzida e com baixos valores de permeabilidade7. Assim, para o reservat\u00f3rio da \n\nFig. 8.21, \u00e9 poss\u00edvel construir uma malha composta por elementos triangulares e \n\nquadrangulares como a apresentada na Fig. 8.23a, composta por 20 n\u00f3s e 18 elementos. A fim \n\nde evitar confus\u00f5es na interpreta\u00e7\u00e3o da numera\u00e7\u00e3o dos n\u00f3s, embora a numera\u00e7\u00e3o de cada n\u00f3 \n\n                                                 \n\n7 No Cap. 4 apresentou-se uma terceira op\u00e7\u00e3o de representar falhas, a partir da elimina\u00e7\u00e3o de elementos no \ninterior da malha. Ela n\u00e3o foi investigada neste cap\u00edtulo porque apenas falhas totalmente selantes podem ser \nrepresentadas com esta t\u00e9cnica, e a sua aplica\u00e7\u00e3o no problema analisado nesta se\u00e7\u00e3o produz resultados id\u00eanticos \nao da segunda op\u00e7\u00e3o de representar falhas (a proposta neste trabalho). \n\n\n\n144 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\napare\u00e7a destacada na Fig. 8.23b, os elementos que comp\u00f5em a falha geom\u00e9trica aparecem \n\ndesenhados de forma ampliada na Fig. 8.23c, onde s\u00e3o apresentados fora de escala para fins \n\nde visualiza\u00e7\u00e3o. Note que se n\u00e3o fosse ampliada exageradamente a espessura da falha nesta \n\nfigura, seria imposs\u00edvel visualiz\u00e1-la na sua escala natural, uma vez que a espessura utilizada \u00e9 \n\n0,00001L, onde L \u00e9 a dimens\u00e3o do reservat\u00f3rio. Poder-se-ia utilizar valores ainda menores \n\npara a espessura da falha, mas considera-se que este \u00e9 um valor adequado. \n\n \n\n \n\n \n\n                      \n                     (a) Malha utilizada                                      (b) Malha utilizada destacando a numera\u00e7\u00e3o dos n\u00f3s \n\n \n\n \n(c) Malha com a espessura ampliada para fins de visualiza\u00e7\u00e3o \n\n \n\nFig. 8.23 \u2013 Malha utilizada no problema do labirinto representando a falha atrav\u00e9s de elementos \n\n \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 145 \n\n \n\n \n\n\u00c9 importante mencionar que neste esquema para falhas, os coeficientes da matriz de \n\ndetermina\u00e7\u00e3o do campo de press\u00f5es continuam todos sendo da mesma ordem. Isso vale \n\nmesmo para os coeficientes calculados para os n\u00f3s vizinhos da falha (n\u00f3s 5, 7, 15, 16 etc. na \n\nFig. 8.23), que continuam sendo da mesma ordem dos demais, uma vez que os volumes e \n\n\u00e1reas envolvidos no seu c\u00e1lculo prov\u00eam tamb\u00e9m dos elementos adjacentes \u00e0 falha, que tem \n\ndimens\u00f5es f\u00edsicas compar\u00e1veis aos demais elementos da malha. Essa \u00e9 uma caracter\u00edstica \n\ndesej\u00e1vel e importante para assegurar que o solver utilizado n\u00e3o tenha dificuldades adicionais, \n\ncausadas por eventuais diferen\u00e7as na ordem de magnitude dos coeficientes. \n\nPor serem bastante semelhantes, os campos de satura\u00e7\u00e3o obtidos pelos dois esquemas \n\nde representa\u00e7\u00e3o de falhas n\u00e3o s\u00e3o apresentados. No entanto, como mostrado na Fig. 8.24, os \n\ncampos de press\u00e3o s\u00e3o bem diferentes. Nota-se que, no caso do reservat\u00f3rio heterog\u00eaneo, o \n\nesquema que representa a falha anulando o fluxo nas interfaces dos volumes apresenta os \n\nmaiores desvios de monotonicidade na curva de queda de press\u00e3o ao longo do labirinto (Fig. \n\n8.24a). No outro esquema, os resultados foram mais satisfat\u00f3rios, como demonstra a Fig. \n\n8.24b, pois tais desvios de monotonicidade n\u00e3o existem. Em ambos os casos a press\u00e3o \u00e9 \n\ncalculada nos n\u00f3s da malha, e o campo de press\u00e3o visualizado \u00e9 obtido por interpola\u00e7\u00e3o com \n\nas fun\u00e7\u00f5es de forma apresentadas no Cap. 4. \n\nEstes resultados tamb\u00e9m podem ser analisados de outra forma: verificando a \n\nmonotonicidade das curvas de queda de press\u00e3o ao longo do labirinto. Isso \u00e9 interessante \n\nporque nesta dire\u00e7\u00e3o o problema \u00e9 praticamente unidimensional. Tra\u00e7ando um gr\u00e1fico com os \n\nvalores calculados nos n\u00f3s localizados nesta dire\u00e7\u00e3o obt\u00eam-se as curvas da  Fig. 8.25, que \n\ncompara os resultados obtidos pelo EbFVM nos dois esquemas de modelagem de falha \n\ngeol\u00f3gica com os resultados obtidos por um simulador de reservat\u00f3rios comercial (IMEX da \n\nCMG) utilizando uma malha Cartesiana igualmente espa\u00e7ada de 4x4 blocos com a forma \n\ntradicional de calcular os fluxos e representar falhas  (IMEX User\u2019s Guide, 2002). Nesta \n\nmalha Cartesiana, localizada no lado esquerdo da Fig. 8.25c, a falha foi modelada cancelando-\n\nse os fluxos entre os volumes separados por ela, que, para malhas estruturadas, \u00e9 o \n\nprocedimento adequado. Por isso, a solu\u00e7\u00e3o deste software comercial \u00e9 utilizada aqui como \n\nsolu\u00e7\u00e3o de refer\u00eancia. \n\n \n\n \n\n\n\n146 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n                            \n          Homog\u00eaneo                                             Heterog\u00eaneo \n\n(a) Modelando a falha anulando o fluxo nas interfaces dos volumes \n \n\n                         \n          Homog\u00eaneo                                             Heterog\u00eaneo \n\n (b) Modelando a falha utilizando elementos com baixa permeabilidade \n\nFig. 8.24 - Campo de press\u00e3o obtido com cada esquema de representa\u00e7\u00e3o no problema do labirinto \n\n  \n\n \n\n \n\nAs curvas da Fig. 8.25a foram obtidas plotando-se os valores de press\u00e3o dos n\u00f3s \n\nlocalizados na dire\u00e7\u00e3o do escoamento: n\u00f3s 1, 5, 9, 13, ... da Fig. 8.22c. Os dois gr\u00e1ficos da \n\nFig. 8.25b, por sua vez, foram obtidos plotando-se os valores de press\u00e3o dos n\u00f3s 1, 3, 4, 6, ...  \n\ne 1, 15, 16, 17, .... da Fig. 8.23c, respectivamente. Percebe-se que mesmo para o caso \n\nhomog\u00eaneo, a queda de press\u00e3o ao longo do labirinto para o EbFVM no caso em que a falha \u00e9 \n\nmodelada zerando os fluxos dentro do elemento apresenta-se com oscila\u00e7\u00f5es, Fig. 8.25a, que \n\nse acentuam quando o meio \u00e9 heterog\u00eaneo. Este comportamento n\u00e3o \u00e9 verificado quando a \n\nfalha \u00e9 representada utilizando elementos com baixa permeabilidade, Fig. 8.25b. Na realidade, \n\npara este caso, encontrou-se o mesmo comportamento verificado quando utiliza-se malhas \n\nCartesianas, Fig. 8.25c, caracterizado por uma queda da press\u00e3o quase linear ao longo do \n\nlabirinto.  \n\n \n\n \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 147 \n\n \n\n \n\nEbFVM  com Armazenamento de K no VC - \nCami nho 1, 5, 9,13...\n\n1272\n\n1277\n\n1282\n\n1287\n\n1292\n\n1297\n\nN\u00f3  \n1\n\nN\u00f3\n5\n\nN\u00f3\n9\n\nN\u00f3\n13\n\nN\u00f3\n14\n\nN\u00f3\n15\n\nN\u00f3\n16\n\nN\u00f3\n12\n\nN\u00f3\n8\n\nN\u00f3\n4\n\nN\u00f3\n3\n\nN\u00f3\n2\n\nN\u00f3\n6\n\nN\u00f3\n10\n\nN\u00f3\n11\n\nN\u00f3\n7\n\nVolumes ao longo do labiri nto\n\nP\n (\n\nkP\na)\n\nEbFVM  Homog\n\nEbFVM  Heterog\n\n       \n(a) Representando a falha anulando o fluxo nas interfaces dos volumes \n\n \n\n  \n\nEbFVM  com Arma zena mento de K no El emento - \nCami nho 1, 3, 4, 6...\n\n1272\n1274\n1276\n1278\n1280\n1282\n1284\n1286\n1288\n1290\n1292\n\nN\u00f3 \n1\n\nN\u00f3 \n3\n\nN\u00f3 \n4\n\nN\u00f3 \n6\n\nN\u00f3 \n2\n\nN\u00f3 \n5\n\nN\u00f3 \n7\n\nN\u00f3 \n8\n\nN\u00f3 \n9\n\nN\u00f3 \n14\n\nVolumes ao l ongo do la bi rinto\n\nP \n(k\n\nP\na)\n\nEbFVM  Homog\n\nEbFVM  Heterog\n\n         \n\nEbFVM  com Arma zenamento de K no Elemento - \nCa minho 1, 15,16,17...\n\n1272\n1274\n1276\n1278\n1280\n1282\n1284\n1286\n1288\n1290\n1292\n\nN\u00f3 \n1\n\nN\u00f3\n15\n\nN\u00f3\n16\n\nN\u00f3\n17\n\nN\u00f3\n18\n\nN\u00f3\n19\n\nN\u00f3\n20\n\nN\u00f3\n13\n\nN\u00f3\n12\n\nN\u00f3\n14\n\nVolumes a o l ongo do l abiri nto\n\nP \n(k\n\nP\na)\n\nEbFVM  Homog\n\nEbFVM  Heterog\n\n \n(b) Representando a falha utilizando elementos com baixa permeabilidade  \n\n \n\n           \n\nIM EX com mal ha cartesi a na  -  \nCami nho 1,1;  2,1; 3,1; 4,1; 4,2; 4,3; 3,4; ...\n\n1272\n\n1274\n\n1276\n\n1278\n\n1280\n\n1282\n\n1284\n\n1286\n\n1288\n\n1290\n\n1292\n\n1,1 2,1 3,1 4,1 4,2 4,3 4,4 3,4 2,4 1,4 1,3 1,2 2,2 3,2 3,3 2,3\n\nVol umes ao l ongo do l abi ri nto\n\nP\n (\n\nkP\na)\n\nIM EX Heterog\nIM EX Homog\n\n \n(c) Resultados do simulador comercial ( IMEX) utilizando malha Cartesiana \n\n \n\nFig. 8.25 \u2013 Compara\u00e7\u00e3o da queda de press\u00e3o ao longo do labirinto obtida por diferentes m\u00e9todos \n\n \n\n  \n\n Discuss\u00e3o. Uma poss\u00edvel causa dos indesejados resultados mostrados neste trabalho \n\ncom o esquema de modelar falhas atrav\u00e9s do cancelamento dos fluxos dentro dos elementos \n\n\n\n148 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\npode ser a utiliza\u00e7\u00e3o de valores nodais de press\u00e3o inadequados no c\u00e1lculo do fluxo. Uma \n\nilustra\u00e7\u00e3o disso \u00e9 apresentada na Fig. 8.26, onde aparece destacado o elemento formado pelos \n\nn\u00f3s 3, 4, 7 e 8. Neste elemento, o fluxo m\u00e1ssico em dois pontos de integra\u00e7\u00e3o ( , na figura) \n\nforam anulados para que a falha geol\u00f3gica pudesse ser modelada. Assim o fluxo resultante \n\nneste elemento, que \u00e9 o que vem do volume de controle constru\u00eddo ao redor do n\u00f3 8 em \n\ndire\u00e7\u00e3o do volume de controle constru\u00eddo ao redor do n\u00f3 3, deve passar apenas pelas \n\ninterfaces do volume de controle constru\u00eddo ao redor do n\u00f3 4, em cada um dos pontos de \n\nintegra\u00e7\u00e3o identificados com o s\u00edmbolo (x). \n \n\n  \n\n \n \n\nFig. 8.26 \u2013 Pontos de integra\u00e7\u00e3o e dire\u00e7\u00e3o do fluxo em um dos elementos da malha utilizada no problema do \n\nlabirinto, no caso em que a falha \u00e9 representada atrav\u00e9s do cancelamento dos fluxos nas interfaces \n\n \n\n \n\nA conclus\u00e3o imediata que se pode obter \u00e9 que o c\u00e1lculo do fluxo discretizado nos \n\npontos de integra\u00e7\u00e3o (x) n\u00e3o deve depender de nenhuma grandeza f\u00edsica ou vari\u00e1vel \narmazenada no n\u00f3 7, pois este n\u00f3 corresponde a um volume de controle que, em virtude da \n\npresen\u00e7a da falha,  n\u00e3o apresenta nenhuma rela\u00e7\u00e3o direta com o fluxo que atravessa as duas \n\ninterfaces destacadas em tracejado na Fig. 8.26. No entanto, como se optou por utilizar um \n\nm\u00e9todo num\u00e9rico que utiliza as fun\u00e7\u00f5es de forma como fun\u00e7\u00e3o de interpola\u00e7\u00e3o, s\u00e3o elas que \n\nrelacionam obrigatoriamente qualquer grandeza dentro do elemento aos seus quatro valores \n\nnodais (ou tr\u00eas no caso de elementos triangulares). Assim, quando a parcela do fluxo da \n\nequa\u00e7\u00e3o de conserva\u00e7\u00e3o for discretizada em qualquer uma das duas interfaces analisadas (em \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 149 \n\n \n\n \n\nlinha tracejada na Fig. 8.26), o gradiente de press\u00e3o ser\u00e1 aproximado empregando-se quatro \n\nvalores nodais, inclusive o do n\u00f3 7. Por isso que, \u00e0 medida em que o valor de press\u00e3o deste n\u00f3 \n\nse afasta demasiadamente dos demais, como \u00e9 o caso heterog\u00eaneo analisado nesta se\u00e7\u00e3o, os \n\nresultados obtidos com este esquema come\u00e7am apresentar-se fisicamente cada vez menos \n\nrealistas.  \n\nPortanto, as oscila\u00e7\u00f5es nos resultados obtidos podem ser consideradas um reflexo da \n\nutiliza\u00e7\u00e3o de um esquema de interpola\u00e7\u00e3o que n\u00e3o \u00e9 adequado para situa\u00e7\u00f5es de \n\ndescontinuidades de fun\u00e7\u00f5es dentro do elemento. Por outro lado, o esquema de representa\u00e7\u00e3o \n\nde falhas proposto neste trabalho e que utiliza elementos de pequena espessura e com baixa \n\npermeabilidade n\u00e3o apresenta estas descontinuidades, e por isso \u00e9 mais adequado para ser \n\nempregado no EbFVM.  \n\n \n \n\n \n\n8.6. Compara\u00e7\u00e3o entre os M\u00e9todos IMPES e Totalmente \nImpl\u00edcito \n\n \n\nO objetivo desta se\u00e7\u00e3o \u00e9 comparar os m\u00e9todos de solu\u00e7\u00e3o de equa\u00e7\u00f5es mais \n\nconhecidos, o IMPES (Implicit Pressure and Explicit Saturation) e o Totalmente Impl\u00edcito, \n\naplicados em malhas n\u00e3o-estruturadas. Estes m\u00e9todos foram descritos no Cap. 5 e agora ser\u00e3o \n\ncomparados na resolu\u00e7\u00e3o das equa\u00e7\u00f5es discretizadas resultantes do m\u00e9todo EbFVM.  \n\nO problema-teste escolhido para este estudo est\u00e1 definido na Fig. 8.27. Os dados \n\nutilizados nesta simula\u00e7\u00e3o s\u00e3o apresentados na Tab. 8.4. As curvas de permeabilidade relativa \n\nutilizadas s\u00e3o as definidas pelas Eqs. (8.31) e (8.32) com 1.2w wf s=  e M = 1. \n\nNo caso do IMPES, foi utilizado um passo de tempo fixo calculado pela Eq. (5.23) \n\nque fornece o maior valor poss\u00edvel que assegura a estabilidade num\u00e9rica. Foram feitas \n\nexperi\u00eancias no sentido de utilizar um passo de tempo vari\u00e1vel, procurando aument\u00e1-lo \u00e0 \n\nmedida em que a simula\u00e7\u00e3o progredia. Percebeu-se, entretanto, que na maioria dos casos, os \n\ncustos computacionais associados ao procedimento de determina\u00e7\u00e3o do valor de um passo de \n\ntempo est\u00e1vel, vari\u00e1vel e maior n\u00e3o justificaram o ganho computacional obtido pela \n\ndiminui\u00e7\u00e3o do n\u00famero de vezes que o sistema linear \u00e9 resolvido. \n\n \n\n \n\n\n\n150 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n \n\n \nFig. 8.27 - Reservat\u00f3rio bidimensional discretizado com uma malha formada por 4357 n\u00f3s e 4242 elementos \n\nquadrangulares \n\n \n\n \n\n \nTab. 8.4 \u2013 Propriedades f\u00edsicas e par\u00e2metros num\u00e9ricos utilizados \n\nPorosidade 0,2 \n\nPermeabilidade (isotr\u00f3pica) 500 mD \n\nEspessura da camada 1 m \n\nViscosidades da \u00e1gua e do \u00f3leo 1 cp \n\nSatura\u00e7\u00e3o de \u00e1gua inicial 0 \n\nPress\u00e3o inicial 150 kPa \n\nCompressibilidades da \u00e1gua e do \u00f3leo 10-6 kPa-1 \n\nFatores volume de forma\u00e7\u00e3o da \u00e1gua e do \u00f3leo \navaliados na press\u00e3o inicial \n\n1 \n\nswi 0 \n\nsor 0 \n\nVaz\u00e3o de inje\u00e7\u00e3o de \u00e1gua no po\u00e7o injetor 500 m3/d \n\nPress\u00e3o de fundo no po\u00e7o produtor 100 kPa \n\n\u00cdndice de po\u00e7o 1 mD.m \n\nPasso de tempo (quando prescrito) 0,037 d \n\n \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 151 \n\n \n\n \n\nO m\u00e9todo Totalmente Impl\u00edcito, por outro lado, tem uma maior flexibilidade quanto \n\nao tamanho do passo de tempo, e por isso ele foi resolvido de duas formas: \n\n  \n\n com o passo de tempo fixo (mesmo do IMPES \u2013 0, 037t? =  d) e  \n\n com o passo de tempo vari\u00e1vel calculado pela Eq. (5.56). \n\n \n\n A utiliza\u00e7\u00e3o de um passo de tempo igual ao do IMPES n\u00e3o se justifica em casos \n\npr\u00e1ticos, justamente porque ele foi criado para permitir passos de tempo maiores e sem \n\ninstabilidades. Mas, mesmo assim, considerou-se importante esta compara\u00e7\u00e3o para que se \n\npossa ter no\u00e7\u00e3o do desempenho do M\u00e9todo Totalmente Impl\u00edcito quando o passo de tempo \u00e9 \n\nfixo e de reduzidas dimens\u00f5es.  \n\nQuanto \u00e0 utiliza\u00e7\u00e3o de valores vari\u00e1veis do passo de tempo, \u00e9 importante enfatizar \n\nque, embora as restri\u00e7\u00f5es de seu tamanho sejam menores no m\u00e9todo impl\u00edcito, deve-se ter \n\ncuidado para que ele produza solu\u00e7\u00f5es dentro da precis\u00e3o desejada para o problema em \n\nquest\u00e3o, haja vista a aproxima\u00e7\u00e3o da derivada temporal. Por isso, foram usadas as restri\u00e7\u00f5es \n\napresentadas no Cap. 5 no c\u00e1lculo autom\u00e1tico do passo de tempo a fim de controlar seu \n\nincremento.  \n\nNo problema estudado, a utiliza\u00e7\u00e3o da Eq. (5.56) com estas restri\u00e7\u00f5es resultaram em \n\npassos de tempo com picos de at\u00e9 40 d, aproximadamente, como mostra o gr\u00e1fico da  Fig. \n\n8.28, que relaciona o passo de tempo com o tempo de simula\u00e7\u00e3o. Esse valores s\u00e3o, portanto, \n\nbem maiores que o valor de 0,037 d requerido pelo IMPES para este caso. O formato da curva \n\napresentada nesta figura lembra o das curvas do tipo \u201cdente de serra\u201d, e se estabeleceu em \n\nfun\u00e7\u00e3o da imposi\u00e7\u00e3o de reduzir pela metade o passo de tempo quando ele resultar em um \n\nn\u00famero elevado de itera\u00e7\u00f5es do m\u00e9todo de Newton para a obten\u00e7\u00e3o da solu\u00e7\u00e3o convergida ou \n\nse surgirem mudan\u00e7as bruscas do valor das vari\u00e1veis naquele passo de tempo. Essas quest\u00f5es \n\nj\u00e1 foram discutidas na se\u00e7\u00e3o 5.2.4. A brusca redu\u00e7\u00e3o do passo de tempo no final da simula\u00e7\u00e3o \n\nfoi necess\u00e1rio para que a simula\u00e7\u00e3o acabasse no tempo exato de 400 d, como desejado. Outros \n\ncrit\u00e9rios de aumento e de redu\u00e7\u00e3o do passo de tempo poderiam ter sido aplicados, mas esse \n\nt\u00f3pico foge ao escopo deste trabalho. \n\nA Fig. 8.29 apresenta as isolinhas de satura\u00e7\u00e3o de \u00e1gua obtidas pelo EbFVM com os \n\nm\u00e9todos de solu\u00e7\u00e3o IMPES e Totalmente Impl\u00edcito para um mesmo tempo de simula\u00e7\u00e3o        \n\n(t = 400 d). Pode-se notar que, mantido o passo de tempo constante durante a simula\u00e7\u00e3o, os \n\ndois m\u00e9todos produzem resultados muito semelhantes, Fig. 8.29 a e b. Os resultados do \n\n\n\n152 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nm\u00e9todo Totalmente Impl\u00edcito apresentam uma difus\u00e3o num\u00e9rica um pouco maior quando lhe \n\n\u00e9 permitido avan\u00e7ar com passos de tempo maiores, como pode ser visto na Fig. 8.29 c. \n\n \n \n\n \nFig. 8.28 \u2013 Passo de tempo vari\u00e1vel empregado na formula\u00e7\u00e3o Totalmente Impl\u00edcita  \n\nem fun\u00e7\u00e3o do tempo de simula\u00e7\u00e3o \n\n \n\n \n \n\n  \n\n   \n          (a) IMPES           (b) Totalmente Impl\u00edcito \u2013 Passo de Tempo Fixo \n\n \n\n \n(c) Totalmente Impl\u00edcito \u2013 Passo de Tempo Vari\u00e1vel \n\n \nFig. 8.29 \u2013 Perfis de satura\u00e7\u00e3o de \u00e1gua no tempo de simula\u00e7\u00e3o de 400 dias obtidos pelo m\u00e9todo proposto para o \n\nreservat\u00f3rio da Fig. 8.27 utilizando o IMPES e o m\u00e9todo Totalmente Impl\u00edcito  \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 153 \n\n \n\n \n\nO custo computacional associado a cada m\u00e9todo para obter a solu\u00e7\u00e3o da Fig. 8.29 est\u00e1 \n\napresentado na Tab. 8.5. Embora o m\u00e9todo Totalmente Impl\u00edcito tenha apresentado uma \n\nsolu\u00e7\u00e3o com menor precis\u00e3o quando o passo de tempo foi calculado automaticamente, a \n\nredu\u00e7\u00e3o dr\u00e1stica do custo computacional justifica a sua utiliza\u00e7\u00e3o em casos pr\u00e1ticos. Na \n\nrealidade, uma simula\u00e7\u00e3o completa pelo m\u00e9todo IMPES n\u00e3o \u00e9 vi\u00e1vel em problemas reais de \n\nreservat\u00f3rios em fun\u00e7\u00e3o da necessidade da utiliza\u00e7\u00e3o de passos de tempo excessivamente \n\npequenos. \n\n \n\n \nTab. 8.5 \u2013 Custo computacional do EbFVM com diferentes m\u00e9todos de solu\u00e7\u00e3o das equa\u00e7\u00f5es  \n\n \n\nM\u00e9todo de Solu\u00e7\u00e3o das Equa\u00e7\u00f5es Discretizadas \nTempo de simula\u00e7\u00e3o \n\n(Pentium 4 \u2013 1.7 GHz \u2013 1 GB RAM) \n\nIMPES                                (com passo de tempo fixo) 20 min 40 s \n\nTotalmente Impl\u00edcito          (com passo de tempo fixo) 200 min 42 s \n\nTotalmente Impl\u00edcito          (com passo de tempo vari\u00e1vel) 2 min 30 s \n\n \n\n \n\n Discuss\u00e3o. Nota-se na Tab. 8.5 que o M\u00e9todo Totalmente Impl\u00edcito apresentou, como  \n\nesperado, um alto custo computacional quando foi utilizado o passo de tempo do IMPES. Isso \n\nevidencia a inviabilidade de sua aplica\u00e7\u00e3o pr\u00e1tica com esta ordem de passo de tempo. Mas \n\neste exemplo serviu para mostrar que os resultados do M\u00e9todo Totalmente Impl\u00edcito (Fig. \n\n8.29b) s\u00e3o praticamente id\u00eanticos aos do IMPES (Fig. 8.29a) quando estes m\u00e9todos avan\u00e7am \n\nno tempo da mesma maneira. \n\n De uma forma geral, os resultados da Fig. 8.29 concordam com a an\u00e1lise num\u00e9rica \n\nefetuada por Peaceman (1977), que consistiu em estudar uma vers\u00e3o mais simples das \n\nequa\u00e7\u00f5es consideradas nesta tese, mas que conservam na ess\u00eancia o car\u00e1ter hiperb\u00f3lico das \n\nequa\u00e7\u00f5es de conserva\u00e7\u00e3o de cada fase. Atrav\u00e9s de uma an\u00e1lise de estabilidade e dispers\u00e3o \n\nnum\u00e9ricas, o autor demonstrou que, para problemas lineares, o m\u00e9todo Totalmente Impl\u00edcito \n\ncom a avalia\u00e7\u00e3o a montante das mobilidades (upwind) \u00e9 incondicionalmente est\u00e1vel, \n\napresentando, no entanto, uma difus\u00e3o num\u00e9rica que aumenta com o crescimento do CFL. O \n\nm\u00e9todo IMPES, por sua vez, \u00e9 est\u00e1vel apenas para CFL ? 1, mas com dispers\u00e3o num\u00e9rica que \n\ndiminui \u00e0 medida em que o CFL utilizado se aproxima da unidade. Portanto, em termos de \n\nredu\u00e7\u00e3o da difus\u00e3o num\u00e9rica,  o ideal seria obter uma simula\u00e7\u00e3o num\u00e9rica sempre com o  \n\n\n\n154 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nCFL = 1 e com o m\u00e9todo IMPES. Isso \u00e9 bastante dif\u00edcil de ser obtido na pr\u00e1tica porque um \n\nmesmo intervalo de tempo d\u00e1 origem a diferentes valores de CFL dependendo das dimens\u00f5es \n\ndos volumes de controle e dos fluxos envolvidos. \n\nTecendo as \u00faltimas considera\u00e7\u00f5es sobre estes dois m\u00e9todos, deve-se dizer que a \n\nqualidade dos resultados e a rapidez da simula\u00e7\u00e3o dependem, obviamente, do solver \n\nempregado na solu\u00e7\u00e3o do sistema linear. Os resultados apresentados at\u00e9 agora neste texto \n\nforam obtidos com relativa rapidez e precis\u00e3o com o solver GMRES da COI-lib8. No entanto, \n\nas boas caracter\u00edsticas deste solver n\u00e3o se verificaram em sistemas lineares maiores, o que \n\nmotivou o desenvolvimento de um solver mais robusto, o multigrid baseado na corre\u00e7\u00e3o \n\naditiva, cujos resultados s\u00e3o o assunto da pr\u00f3xima se\u00e7\u00e3o.  \n\n \n\n \n\n \n\n8.7. Desempenho do M\u00e9todo Multigrid na Simula\u00e7\u00e3o de \nReservat\u00f3rios de Petr\u00f3leo \n\n \n\nEsta se\u00e7\u00e3o foi dividida em tr\u00eas partes, de acordo com a natureza do problema f\u00edsico \n\nconsiderado: \n\n \n\n(1) Problemas homog\u00eaneos resolvidos com IMPES (sistema de uma equa\u00e7\u00e3o); \n\n(2) Problemas homog\u00eaneos resolvidos com formula\u00e7\u00e3o Totalmente Impl\u00edcita (sistema \n\nde duas equa\u00e7\u00f5es); \n\n(3) Problemas heterog\u00eaneos e anisotr\u00f3picos resolvidos com IMPES e formula\u00e7\u00e3o \n\nTotalmente Impl\u00edcita. \n\n \n\nEm cada caso, as compara\u00e7\u00f5es foram realizadas a partir da solu\u00e7\u00e3o do sistema linear \n\ncorrespondente ao primeiro passo de tempo da simula\u00e7\u00e3o, o que parece ser suficiente para \n\n                                                 \n8 O solver GMRES - Generalized Minimal Residual (SAAD, 2000) \u00e9 um dos m\u00e9todos iterativos n\u00e3o-\nestacion\u00e1rios mais utilizados. A vers\u00e3o utilizada neste trabalho (da biblioteca COI-lib) foi baseada nos \nalgoritmos da biblioteca ITL - The Iterative Template Library, que \u00e9 uma biblioteca gen\u00e9rica de componentes \nque disponibiliza m\u00e9todos iterativos para a solu\u00e7\u00e3o de sistemas lineares (http://www.osl.iu.edu/research/itl/ ). \n \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 155 \n\n \n\n \n\ninferir conclus\u00f5es que se aplicam tamb\u00e9m para a solu\u00e7\u00e3o dos demais sistemas lineares do \n\nprocesso transiente9.  \n\n \n\n8.7.1. Problemas Homog\u00eaneos Resolvidos com IMPES \n\n \n\nEste primeiro caso inicia a se\u00e7\u00e3o que visa avaliar o potencial do solver multigrid na \n\nsimula\u00e7\u00e3o de reservat\u00f3rios de petr\u00f3leo, e para tanto utiliza a geometria conhecida como \u00bc do \n\nesquema five-spot (ver Fig. 8.14). Esta geometria foi discretizada com a malha diagonal \n\ntradicional, isto \u00e9, Cartesiana e formada por quadril\u00e1teros igualmente espa\u00e7ados. A solu\u00e7\u00e3o do \n\ncampo de press\u00e3o obtida para o primeiro passo de tempo \u00e9 a mesma de um escoamento \n\nmonof\u00e1sico em regime permanente e com propriedades constantes, que resulta em um campo \n\nde velocidade total como o mostrado na Fig. 8.30. Este escoamento se estabeleceu a partir da \n\nprescri\u00e7\u00e3o de fluxos id\u00eanticos, mas com sinais contr\u00e1rios, em dois cantos opostos desta \n\ngeometria (inferior esquerdo e superior direito). Prescreveu-se, em um dos outros cantos, \n\npress\u00e3o igual a zero para assegurar a simetria desta vari\u00e1vel no dom\u00ednio. \n\n \n\n \n\n \nFig. 8.30 \u2013 Campo de velocidade total obtido em uma malha Cartesiana de 15x15 elementos igualmente \n\nespa\u00e7ados no problema que representa \u00bc do padr\u00e3o-base do arranjo de po\u00e7os five-spot \n\n \n                                                 \n9 Inclusive, para o m\u00e9todo IMPES, dependendo dos dados utilizados, torna-se necess\u00e1rio resolver apenas o \nprimeiro sistema linear da press\u00e3o, devendo-se avan\u00e7ar apenas no c\u00e1lculo expl\u00edcito da satura\u00e7\u00e3o a cada novo \npasso de tempo. Isso \u00e9 poss\u00edvel quando s\u00e3o utilizadas viscosidades iguais para as fases \u00f3leo e \u00e1gua e curvas \nlineares de permeabilidade relativas. \n\n\n\n156 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nEste problema foi resolvido integrando as equa\u00e7\u00f5es de conserva\u00e7\u00e3o em malhas de \n\ndiferentes raz\u00f5es de refinamento e com dois m\u00e9todos diferentes: o M\u00e9todo de Volumes \n\nFinitos (FVM) e o M\u00e9todo de Volumes Finitos baseado em Elementos (EbFVM). O objetivo \n\n\u00e9 comparar a efici\u00eancia do multigrid na solu\u00e7\u00e3o do sistema linear da press\u00e3o originado em \n\ncada caso. Deve-se lembrar que o m\u00e9todo FVM, quando emprega uma matriz estruturada, \n\nproduz uma matriz de coeficientes com bandas definidas, o que n\u00e3o acontece com o m\u00e9todo \n\nEbFVM, mesmo com malhas regulares. Os dados utilizados no solver multigrid nestas \n\ncompara\u00e7\u00f5es est\u00e3o destacados na Tab. 8.6. Informa\u00e7\u00f5es adicionais sobre cada um dos \n\npar\u00e2metros apresentados nesta tabela podem ser obtidas no Cap. 6. \n\n \n\n \nTab. 8.6 \u2013 Par\u00e2metros utilizados no multigrid \n\nTipo de ciclo F \n\nSolver-base  Gauss-Seidel \n\nN\u00famero m\u00e1ximo de ciclos 40000 \n\nN\u00famero de c\u00e9lulas para solver direto 50 \n\nN\u00famero de itera\u00e7\u00f5es no solver iterativo 2 \n\nN\u00famero de c\u00e9lulas em cada bloco grosseiro 7 \n\n  \n\n \n \n\nA solu\u00e7\u00e3o fornecida pelo solver ser\u00e1 considerada convergida quando apresentar \n\ndiferen\u00e7as nos valores da press\u00e3o menores que 10-4 kPa em rela\u00e7\u00e3o a uma solu\u00e7\u00e3o de \n\nrefer\u00eancia (aquela que foi resolvida at\u00e9 atingir a precis\u00e3o dos erros em n\u00edvel de m\u00e1quina). A \n\nFig. 8.31 compara os tempos de processamento necess\u00e1rios para os solvers Gauss-Seidel, \n\nGMRES (pr\u00e9-condicionado com o SSOR - Symmetric Successive Over Relaxation) e \n\nmultigrid obterem a solu\u00e7\u00e3o convergida. Para simplificar a leitura, os tempos necess\u00e1rios para \n\ncada solver obter uma solu\u00e7\u00e3o convergida dos sistemas lineares provenientes do FVM e do \n\nEbFVM foram apresentados no mesmo gr\u00e1fico.  \n\n \n\n \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 157 \n\n \n\n \n\nCusto ~ N 1.01\nR 2 = 0.997\n\nCusto ~ N 2.09\nR 2 = 0.999\n\nCusto ~ N 1.94\nR 2 = 0.996\n\n1.E-04\n\n1.E-03\n\n1.E-02\n\n1.E-01\n\n1.E+00\n\n1.E+01\n\n1.E+02\n\n1.E+03\n\n1.E+04\n\n1.E+05\n\n1.E+02 1.E+03 1.E+04 1.E+05 1.E+06 1.E+07\n\nN - N\u00famero de inc\u00f3gnitas\n\nC\nus\n\nto\n c\n\nom\npu\n\nta\nci\n\non\nal\n\n (\ns)\n\nGauss Seidel - FVM Gauss Seidel - EbFVM\n\nGMRES - FVM GMRES - EbFVM\n\nMultigrid - FVM Multigrid - EbFVM\n\n \nFig. 8.31 \u2013 Desempenho de diferentes solvers na solu\u00e7\u00e3o de sistemas lineares provenientes do M\u00e9todo de \n\nVolumes Finitos (FVM) e do M\u00e9todo de Volumes Finitos baseado em Elementos (EbFVM) \n\n \n\n \n\nNota-se na Fig. 8.31 que o m\u00e9todo multigrid apresentou um aumento linear do custo \n\ncomputacional com o n\u00famero de inc\u00f3gnitas, como o esperado. O Gauss-Seidel reproduziu o \n\ncomportamento te\u00f3rico de um aumento quadr\u00e1tico do esfor\u00e7o computacional com o aumento \n\nda malha. Quanto ao m\u00e9todo GMRES, \u00e9 importante mencionar que \u00e9 dif\u00edcil estimar curvas \n\ngerais, como as obtidas para o multigrid e Gauss-Seidel, por duas raz\u00f5es: primeiro, porque \n\ndepende de diferentes fatores, como o n\u00famero de condi\u00e7\u00e3o da matriz (BARRETT et al., \n\n1994); e, segundo, porque h\u00e1 par\u00e2metros que podem ser ajustados para que possa dar um \n\nmelhor resultado, como o n\u00famero de restarts. Por isso que, talvez, poder-se-ia melhorar os \n\ndados de converg\u00eancia do GMRES destacados na Fig. 8.31, mas o seu estudo est\u00e1 fora do \n\nescopo deste trabalho. Optou-se em mostrar mesmo assim estes resultados, porque se trata de \n\num importante solver mencionado na literatura e porque se espera que os resultados n\u00e3o \n\nseriam excessivamente modificados se fosse atingida a condi\u00e7\u00e3o ideal para o GMRES \n\nfuncionar com estas matrizes. \n\n \n\nConsidera\u00e7\u00f5es sobre a aglomera\u00e7\u00e3o. Para se ter uma id\u00e9ia de como os volumes de \n\ncontrole s\u00e3o aglomerados na forma\u00e7\u00e3o das malhas grosseiras, a Fig. 8.32 apresenta a \n\nvisualiza\u00e7\u00e3o dos dois n\u00edveis gerados quando uma malha Cartesiana de 25x25 volumes \u00e9 \n\ndiscretizada no problema considerado com o m\u00e9todo FVM. Nesta figura s\u00e3o destacadas as \n\ndiferen\u00e7as entre as malhas grosseiras criadas pelo multigrid quando s\u00e3o formadas pela \n\n\n\n158 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\naglomera\u00e7\u00e3o de 4 volumes em cada c\u00e9lula (lado esquerdo da figura) e 7 volumes em cada \n\nc\u00e9lula (lado direito da figura), que foi a configura\u00e7\u00e3o ideal para o caso anterior.  \n\n Da mesma forma, na Fig. 8.33 s\u00e3o apresentadas as malhas grosseiras originadas a \n\npartir da discretiza\u00e7\u00e3o com o EbFVM. N\u00e3o podem ser esperadas aglomera\u00e7\u00f5es id\u00eanticas \u00e0s da \n\nFig. 8.32 porque no EbFVM os volumes de controle s\u00e3o constru\u00eddos ao redor dos n\u00f3s, \n\ndiferentemente, portanto, do FVM onde os volumes de controle e os elementos de malha s\u00e3o \n\nentidades geometricamente coincidentes. A maior diferen\u00e7a entre as formas das c\u00e9lulas \n\nformadas pelo multigrid na solu\u00e7\u00e3o do sistema linear resultante do EbFVM em rela\u00e7\u00e3o \u00e0s \n\nformadas na discretiza\u00e7\u00e3o FVM est\u00e1 na possibilidade de cria\u00e7\u00e3o de c\u00e9lulas que t\u00eam volumes \n\nde controle n\u00e3o-vizinhos, como as que est\u00e3o destacadas com c\u00edrculos na Fig. 8.33b. Esse \n\nassunto j\u00e1 foi considerado na se\u00e7\u00e3o 6.4. \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 159 \n\n \n\n \n\n \n(a) N\u00edvel 0 (25x25 volumes) \n\n \n\n \n\nC\u00e9lulas com 4 volumes   C\u00e9lulas com 7 volumes \n\n(156 c\u00e9lulas)    (96 c\u00e9lulas) \n\n    \n(b) N\u00edvel 1 \n\n \n\n \n\n(40 c\u00e9lulas)    (15 c\u00e9lulas) \n\n   \n(c) N\u00edvel 2 \n\n    \nFig. 8.32 \u2013 Malha original (a) e malhas grosseiras geradas pelo multigrid (b e c) utilizadas na solu\u00e7\u00e3o do \n\nproblema descrito na Fig. 8.30 a partir do M\u00e9todo de Volumes Finitos (FVM) \n\n \n\n\n\n160 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n                    \n(a) N\u00edvel 0 (625 elementos e 676 n\u00f3s) \n\n \n\n \n\nC\u00e9lulas com 4 volumes   C\u00e9lulas com 7 volumes \n\n(174 c\u00e9lulas)    (111 c\u00e9lulas) \n\n   \n(b) N\u00edvel 1 \n\n \n\n \n\n(44 c\u00e9lulas)    (23 c\u00e9lulas) \n\n  \n (c) N\u00edvel 2 \n\n    \nFig. 8.33 - Malha original (a) e malhas grosseiras geradas pelo multigrid (b e c) utilizadas na solu\u00e7\u00e3o do \n\nproblema descrito na Fig. 8.30 a partir do M\u00e9todo de Volumes Finitos baseado em Elementos (EbFVM) \n\n \n\nC\u00e9lulas \nformadas com \nvolumes n\u00e3o-\nvizinhos \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 161 \n\n \n\n \n\nDiferentes ciclos e solvers-base. Uma outra an\u00e1lise que tamb\u00e9m merece ser feita \u00e9 a \n\ndo desempenho do multigrid empregando diferentes ciclos e solvers-base. Para isso ser\u00e3o \n\ncomparadas as curvas de queda do res\u00edduo das equa\u00e7\u00f5es discretizadas em EbFVM \n\nempregando uma malha com 62500 elementos (estruturada de 250 x 250) e 63001 n\u00f3s, e \n\nutilizando o mesmo crit\u00e9rio de converg\u00eancia e os dados do problema analisado inicialmente \n\nnesta se\u00e7\u00e3o. A Fig. 8.34 apresenta como a norma Euclidiana do res\u00edduo10, chamada nesta \n\nfigura simplesmente de \u201cRes\u00edduo\u201d, se comporta durante a solu\u00e7\u00e3o do sistema linear pelo \n\nmultigrid utilizando diferentes solvers-base: Gauss-Seidel (GS) e ILU(0). Para simplificar as \n\ncompara\u00e7\u00f5es, o res\u00edduo foi normalizado dividindo-o pelo valor do res\u00edduo calculado antes do \n\nmultigrid iniciar o processo de solu\u00e7\u00e3o, isto \u00e9, calculado com o valor da estimativa inicial de \n\npress\u00e3o. As solu\u00e7\u00f5es s\u00e3o apresentadas nesta figura para os ciclos V, W e F, que s\u00e3o aqueles \n\ndefinidos na Fig. 6.3, e representam a ordem como as diferentes malhas s\u00e3o resolvidas. \n\nComo pode ser observado na Fig. 8.34, o desempenho do multigrid praticamente n\u00e3o \n\nse alterou quando foram utilizados os ciclos W e F, enquanto que com o ciclo V, tempos \n\nmaiores de processamento de m\u00e1quina foram necess\u00e1rios para atingir os mesmos res\u00edduos, \n\nn\u00e3o convergindo, inclusive, quando foram utilizadas poucas itera\u00e7\u00f5es de Gauss-Seidel. \n\nQuando foi aumentada a quantidade de itera\u00e7\u00f5es do solver-base para o ciclo V, a solu\u00e7\u00e3o \n\nconvergiu n\u00e3o-monotonicamente em torno de uma linha m\u00e9dia. Neste ciclo a utiliza\u00e7\u00e3o do \n\nsolver-base ILU(0) resultou em tempo menores de processamento, ao contr\u00e1rio do que \n\naconteceu para os ciclos W e F, onde a utiliza\u00e7\u00e3o do solver-base Gauss-Seidel conferiu \n\nmelhor desempenho ao multigrid. A queda monot\u00f4nica do res\u00edduo utilizando-se os ciclos W e \n\nF \u00e9 uma excelente caracter\u00edstica que merece ser salientada. \n\n \n\n \n\n \n\n                                                 \n10 A norma euclidiana do res\u00edduo (norma l2) \u00e9 definida como a raiz quadrada do somat\u00f3rio dos res\u00edduos de cada \numa das equa\u00e7\u00f5es ao quadrado. O res\u00edduo de uma equa\u00e7\u00e3o est\u00e1 definido na Eq. (6.3). \n\n\n\n162 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n \n(a) Ciclo V \n\n \n(b) Ciclo W \n\n \n(c) Ciclo F \n\n \nFig. 8.34 \u2013 Compara\u00e7\u00e3o entre as curvas de res\u00edduo x tempo de processamento de m\u00e1quina (Pentium 4 \u2013 1.7 GHz \n\n\u2013 1 GB RAM) de diferentes ciclos e diferentes solver-base do multigrid: GS - Gauss-Seidel e ILU(0), na solu\u00e7\u00e3o \n\ndo problema analisado com uma malha de 62500 elementos e 63001 n\u00f3s. \n\n \n\n \n\n \n\n \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 163 \n\n \n\n \n\n8.7.2. Problemas Homog\u00eaneos Resolvidos com Formula\u00e7\u00e3o Totalmente \nImpl\u00edcita \n\n \n\nO desempenho do multigrid na solu\u00e7\u00e3o de sistemas lineares com matrizes de blocos \u00e9 \n\no tema abordado nesta se\u00e7\u00e3o. A formula\u00e7\u00e3o Totalmente Impl\u00edcita resulta em uma matriz de \n\ncoeficientes formada por blocos de dimens\u00e3o (2x2) para problemas bif\u00e1sicos como demonstra \n\na Eq. (5.29). Por isso o solver multigrid teve de ser implementado de forma generalizada para \n\ntamb\u00e9m resolver sistemas que tenham estas caracter\u00edsticas. \n\nO problema-teste empregado nas compara\u00e7\u00f5es \u00e9 o mesmo da se\u00e7\u00e3o anterior (\u00bc do \n\nesquema five-spot). Novamente ser\u00e1 analisada apenas a solu\u00e7\u00e3o do primeiro sistema linear do \n\ntransiente. Os dados empregados no multigrid tamb\u00e9m s\u00e3o os mesmos do caso anterior e s\u00e3o \n\napresentados na Tab. 8.6. \n\nEmbora n\u00e3o seja apresentado neste texto, o processo de aglomera\u00e7\u00e3o empregado para \n\nsistemas de blocos resultou em malhas grosseiras similares \u00e0s obtidas para o IMPES \n\napresentadas na se\u00e7\u00e3o anterior. Deve-se lembrar que, em fun\u00e7\u00e3o da aglomera\u00e7\u00e3o baseada nos \n\ncoeficientes empregada, isso poderia n\u00e3o ter acontecido, uma vez que a matriz de coeficientes \n\ndo IMPES \u00e9 formada pelos coeficientes da press\u00e3o, enquanto a matriz de coeficientes do \n\nm\u00e9todo Totalmente Impl\u00edcito \u00e9 formada por derivadas das equa\u00e7\u00f5es do res\u00edduo. Portanto, \n\ntratam-se de sistemas lineares de natureza diferente, embora resolvendo o mesmo problema \n\nf\u00edsico. Por isso, pode-se afirmar, que o esquema de aglomera\u00e7\u00e3o implementado \u00e9 bastante \n\nadequado, porque a geometria de uma malha grosseira n\u00e3o deveria depender da forma como \n\nas equa\u00e7\u00f5es aproximadas s\u00e3o resolvidas.  \n\nO desempenho do multigrid na solu\u00e7\u00e3o impl\u00edcita das equa\u00e7\u00f5es pode ser visto na Fig. \n\n8.35, onde \u00e9 comparado o custo computacional para obter uma solu\u00e7\u00e3o \u00e0 medida que a malha \n\nvai sendo refinada (o n\u00famero de inc\u00f3gnitas aumenta). Novamente o multigrid apresentou um \n\naumento linear do custo computacional com o n\u00famero de inc\u00f3gnitas do sistema linear. \n\n \n\n \n\n\n\n164 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nCusto ~ N 2.06\nR 2 = 0.999\n\nCusto ~ N 1.82\nR 2 = 0.999\n\nCusto ~ N 1.03\nR 2 = 0.999\n\n1.E-04\n\n1.E-03\n\n1.E-02\n\n1.E-01\n\n1.E+00\n\n1.E+01\n\n1.E+02\n\n1.E+03\n\n1.E+04\n\n1.E+05\n\n1.E+02 1.E+03 1.E+04 1.E+05 1.E+06 1.E+07\n\nN - N\u00famero de inc\u00f3gnitas\n\nC\nus\n\nto\n c\n\nom\npu\n\nta\nci\n\non\nal\n\n (\ns)\n\nGauss-Seidel GMRES Multigrid ACM\n\n \nFig. 8.35 - Desempenho de diferentes solvers na solu\u00e7\u00e3o de sistemas lineares com matrizes de blocos \n\nprovenientes do M\u00e9todo de Volumes Finitos baseado em Elementos (EbFVM) \n\n \n\n \n\n \n\n A fim de facilitar a compara\u00e7\u00e3o do desempenho dos diferentes solvers na solu\u00e7\u00e3o de \n\nsistemas lineares com matrizes de coeficientes com e sem blocos, a Fig. 8.36 sobrep\u00f5e, em \n\num mesmo gr\u00e1fico, os custos computacionais da resolu\u00e7\u00e3o do sistema originado pelo IMPES \n\n(Fig. 8.31) e pelo m\u00e9todo Totalmente Impl\u00edcito (Fig. 8.35). Note que, para esta compara\u00e7\u00e3o, \n\num mesmo custo computacional \u00e9 obtido nestes m\u00e9todos com malhas diferentes porque o \n\nm\u00e9todo Totalmente Impl\u00edcito produz um sistema linear com o dobro do tamanho do m\u00e9todo \n\nIMPES. O solver multigrid foi o que menos apresentou desempenhos similares na solu\u00e7\u00e3o de \n\nsistemas com e sem blocos, o que se verifica no afastamento, embora pequeno, das retas em \n\ntracejado da Fig. 8.36c. Os outros dois solvers apresentaram essas retas praticamente \n\ncoincidentes. O aumento do esfor\u00e7o computacional do multigrid na solu\u00e7\u00e3o dos sistemas de \n\nblocos mostrado na figura pode ser explicado pela exist\u00eancia de procedimentos \n\nimplementados neste solver que atuam exclusivamente neste caso. Um exemplo \u00e9 o \n\nprocedimento de transforma\u00e7\u00e3o do sistema linear dos n\u00edveis grosseiros para o formato padr\u00e3o \n\nde linha comprimida (Compressed Sparse Row), discutido no final do Cap. 6, que torna a \n\nsolu\u00e7\u00e3o dos solvers-base mais eficiente na resolu\u00e7\u00e3o de matrizes de blocos. \n\n \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 165 \n\n \n\n \n\n1.E-04\n\n1.E-02\n\n1.E+00\n\n1.E+02\n\n1.E+04\n\n1.E+02 1.E+03 1.E+04 1.E+05 1.E+06 1.E+07\n\nN - N\u00famero de inc\u00f3gnitas\n\nC\nus\n\nto\n c\n\nom\npu\n\nta\nci\n\non\nal\n\n (\ns)\n\nGauss Seidel - IMPES\n\nGauss-Seidel - TI\n\n         \n\n1.E-04\n\n1.E-02\n\n1.E+00\n\n1.E+02\n\n1.E+04\n\n1.E+02 1.E+03 1.E+04 1.E+05 1.E+06 1.E+07\n\nN - N\u00famero de inc\u00f3gnitas\n\nC\nus\n\nto\n c\n\nom\npu\n\nta\nci\n\non\nal\n\n (\ns)\n\nGMRES - IMPES\n\nGMRES - TI\n\n \n    (a) Gauss-Seidel          (b) GMRES \n\n1.E-04\n\n1.E-02\n\n1.E+00\n\n1.E+02\n\n1.E+04\n\n1.E+02 1.E+03 1.E+04 1.E+05 1.E+06 1.E+07\n\nN - N\u00famero de inc\u00f3gnitas\n\nC\nus\n\nto\n c\n\nom\npu\n\nta\nci\n\non\nal\n\n (\ns)\n\nMultigrid - IMPES\n\nMultigrid - TI\n\n \n            (c) Multigrid \n\n \n\nFig. 8.36 \u2013 Compara\u00e7\u00e3o do esfor\u00e7o computacional de diferentes solvers na solu\u00e7\u00e3o de sistemas lineares de \n\nblocos (TI \u2013 Totalmente Impl\u00edcito) e sem blocos (IMPES) \n\n \n\n \n\n8.7.3. Problemas Heterog\u00eaneos e Anisotr\u00f3picos \n\n \n\nConforme j\u00e1 se comentou neste trabalho, h\u00e1 uma menor efici\u00eancia de m\u00e9todos \n\niterativos quando as equa\u00e7\u00f5es discretizadas t\u00eam coeficientes de diferentes magnitudes. Nesses \n\ncasos a anisotropia dos coeficientes origina diferentes escalas de tempo de propaga\u00e7\u00e3o da \n\ninforma\u00e7\u00e3o, afetando diretamente a converg\u00eancia. Para superar estas dificuldades foi \n\nimplementada a aglomera\u00e7\u00e3o adaptativa no solver multigrid desenvolvido nesta tese que \n\npossibilita, em problemas heterog\u00eaneos e anisotr\u00f3picos, a constru\u00e7\u00e3o de malhas grosseiras \n\ncom transfer\u00eancia de informa\u00e7\u00e3o homog\u00eanea entre as c\u00e9lulas. \n\nO problema de estudo est\u00e1 apresentado na Fig. 8.37. Nota-se que o dom\u00ednio foi \n\ndividido em quatro regi\u00f5es de mesma permeabilidade absoluta, onde em apenas duas delas o \n\n\n\n166 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\ntensor permeabilidade \u00e9 isotr\u00f3pico (cantos direito inferior e esquerdo superior). E como nos \n\ncasos anteriores, prescreveu-se valor de press\u00e3o igual a zero no canto inferior direito do \n\ndom\u00ednio. Os dados utilizados no solver est\u00e3o destacados na Tab. 8.7, sendo que os demais \n\ndados que definem o problema f\u00edsico s\u00e3o os mesmos da Tab. 8.1, exceto a vaz\u00e3o de inje\u00e7\u00e3o e \n\no passo de tempo, que adotaram os valores 2,84.10-5 m3/d e 1 d, respectivamente. \n\n \n\n \n\n \nFig. 8.37 \u2013 Caracteriza\u00e7\u00e3o do problema-teste \n\n \n\n \nTab. 8.7 \u2013 Par\u00e2metros utilizados no multigrid \n\nTipo de ciclo F \n\nSolver base  Gauss-Seidel \n\nN\u00famero m\u00e1ximo de ciclos 40000 \n\nN\u00famero de c\u00e9lulas para solver direto 50 \n\nN\u00famero de itera\u00e7\u00f5es no solver iterativo 20 \n\nN\u00famero de c\u00e9lulas em cada bloco grosseiro 4 \n\n \n\n \n\nDiscretizando o dom\u00ednio da Fig. 8.37 com uma malha Cartesiana de 625 elementos \n\n(25x25), os dois n\u00edveis grosseiros criados pelo multigrid durante a solu\u00e7\u00e3o do sistema linear \n\nest\u00e3o apresentados na Fig. 8.38. Nesta figura est\u00e3o apresentados os resultados de dois \n\ndiferentes procedimentos de aglomera\u00e7\u00e3o estudados neste trabalho e que resultam em malhas \n\ngrosseiras ligeiramente diferentes, mas que t\u00eam um impacto importante na efici\u00eancia do \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 167 \n\n \n\n \n\nmultigrid. O que ocasionou a diferen\u00e7a na gera\u00e7\u00e3o destas malhas foram as diferentes \n\npossibilidades de testar as regras de aglomera\u00e7\u00e3o descrita na se\u00e7\u00e3o 6.4. Se, por exemplo, a \n\ncada nova c\u00e9lula a ser formada no processo de aglomera\u00e7\u00e3o forem testadas as regras apenas \n\nnos volumes vizinhos livres, ou seja, aqueles que ainda n\u00e3o foram aglomerados em nenhuma \n\nc\u00e9lula, o resultado \u00e9 o apresentado na Fig. 8.38a. Esse procedimento \u00e9 o utilizado no solver \n\nmultigrid de Raw (1996).  \n\n \n\n \n\n   \nPrimeiro n\u00edvel grosseiro    Segundo n\u00edvel grosseiro \n\n(a) Com as regras testadas apenas em volumes vizinhos ainda n\u00e3o aglomerados \n \n\n   \nPrimeiro n\u00edvel grosseiro    Segundo n\u00edvel grosseiro \n\n (b) Com as regras testadas em todos os volumes vizinhos \n \n\nFig. 8.38 \u2013 N\u00edveis grosseiros originados de uma malha de 25x25 elementos \n\n \n\n  \n\nA Fig. 8.38b, por sua vez, apresenta as malhas grosseiras formadas quando \u00e9 utilizado \n\num procedimento um pouco diferente do anterior. A motiva\u00e7\u00e3o pela mudan\u00e7a \u00e9 a exist\u00eancia, \n\nno primeiro caso, Fig. 8.38a, de c\u00e9lulas horizontais no canto inferior esquerdo e c\u00e9lulas \n\n\n\n168 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nverticais no canto superior direito que n\u00e3o deveriam existir devido \u00e0 anisotropia f\u00edsica do \n\ntensor permeabilidade absoluta (Fig. 8.37) que exigiria uma aglomera\u00e7\u00e3o na dire\u00e7\u00e3o oposta \n\nem cada caso. Por isso foi testada uma modifica\u00e7\u00e3o na l\u00f3gica do processo de aglomera\u00e7\u00e3o de \n\ntal forma que a cada nova c\u00e9lula a ser formada s\u00e3o testadas as regras em todos volumes \n\nvizinhos, e n\u00e3o s\u00f3 nos livres como no caso anterior. Isso resolveu o problema verificado no \n\ncaso anterior, como demonstra a Fig. 8.38b, mas ao custo da perda da uniformidade das \n\nc\u00e9lulas grosseiras na regi\u00e3o inferior direita.  \n\nA influ\u00eancia nos resultados da utiliza\u00e7\u00e3o de cada uma das formas de obten\u00e7\u00e3o das \n\nmalhas grosseiras vai ser mostrada na seq\u00fc\u00eancia. Para tanto, n\u00e3o ser\u00e1 mais utilizada a malha \n\nde 25x25 elementos que originou os n\u00edveis grosseiros da Fig. 8.38 em fun\u00e7\u00e3o da velocidade \n\ncom que a solu\u00e7\u00e3o \u00e9 obtida nesta malha. A experi\u00eancia mostra que fra\u00e7\u00f5es muito pequenas de \n\nsegundos n\u00e3o podem ser medidas computacionalmente com muita confian\u00e7a. Por isso, o \n\nmultigrid foi aplicado na solu\u00e7\u00e3o do sistema linear maior, referente \u00e0 discretiza\u00e7\u00e3o em uma \n\nmalha mais refinada de 100x100 elementos (10201 n\u00f3s). Embora n\u00e3o apresentado, os n\u00edveis \n\ngrosseiros desta nova malha t\u00eam as mesmas caracter\u00edsticas das malhas grosseiras da Fig. 8.38. \n\nA Fig. 8.39 apresenta a queda do res\u00edduo com o tempo de processamento empregando-\n\nse diferentes formas de aglomerar as c\u00e9lulas, em sistemas lineares sem blocos (Fig. 8.39a) e \n\ncom blocos (Fig. 8.39b). Na solu\u00e7\u00e3o do sistema linear do m\u00e9todo IMPES o multigrid divergiu \n\nquando foi empregada a forma de aglomera\u00e7\u00e3o que originou as malhas grosseiras da Fig. \n\n8.38a. Quando foi utilizada a segunda forma testada neste trabalho o res\u00edduo caiu \n\nassintoticamente 5 ordens de magnitude no in\u00edcio, como demonstra a Fig. 8.39a, \n\napresentando, na seq\u00fc\u00eancia, uma tend\u00eancia pouco menor de queda com o tempo de \n\nprocessamento. Para fins de compara\u00e7\u00e3o, \u00e9 ainda apresentada neste mesmo gr\u00e1fico a queda do \n\nres\u00edduo quando a aglomera\u00e7\u00e3o \u00e9 realizada baseando-se apenas em aspectos geom\u00e9tricos da \n\nmalha original. Esse \u00e9 o esquema empregado em multigrid geom\u00e9tricos. Nota-se que o \n\nresultado \u00e9 uma queda brusca do res\u00edduo de apenas uma ordem de magnitude no in\u00edcio, \n\napresentando na seq\u00fc\u00eancia, uma queda monot\u00f4nica muito suave, praticamente uma \n\nestagna\u00e7\u00e3o do res\u00edduo.  \n\n Na solu\u00e7\u00e3o de sistemas lineares de blocos (m\u00e9todo Totalmente Impl\u00edcito), o multigrid \n\napresentou resultados praticamente insens\u00edveis \u00e0 quest\u00e3o comentada da aplica\u00e7\u00e3o das regras \n\nna forma\u00e7\u00e3o das malhas grosseiras, como atesta as curvas bastante semelhantes de queda do \n\nres\u00edduo da Fig. 8.39b. Deve-se destacar, no entanto, que os resultados obtidos com a \n\naglomera\u00e7\u00e3o geom\u00e9trica n\u00e3o s\u00e3o apresentados neste gr\u00e1fico porque este tipo de aglomera\u00e7\u00e3o \n\nfez com o multigrid divergisse logo nos primeiros ciclos.  \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 169 \n\n \n\n \n\n                  \n            (a) IMPES                        (b) Totalmente Impl\u00edcito \n\n \n\nFig. 8.39 -  Compara\u00e7\u00e3o entre as curvas de res\u00edduo x tempo de processamento de m\u00e1quina                              \n\n(Pentium 4 \u2013 1.7 GHz \u2013 1 GB RAM) obtidas com diferentes esquemas de aglomera\u00e7\u00e3o em uma malha de \n\n100x100 elementos e 10201 n\u00f3s. \n \n\n \n\n Discuss\u00e3o. Como visto, a forma como as c\u00e9lulas s\u00e3o formadas nas malhas grosseiras \n\ninfluencia demasiadamente na taxa de converg\u00eancia do solver. Durante o processo de \n\naglomera\u00e7\u00e3o, a estrat\u00e9gia de testar as regras apenas nos volumes vizinhos livres parece n\u00e3o \n\nser eficaz em alguns casos. Por outro lado, a alternativa testada neste trabalho de aplicar as \n\nregras em todos os volumes garantiu a converg\u00eancia nos casos testados. Por\u00e9m, os resultados \n\nsatisfat\u00f3rios obtidos com esta abordagem n\u00e3o podem ser considerados gerais a priori, \n\ndevendo-se, portanto, realizar diversos testes adicionais. O que se pode constatar com \n\nseguran\u00e7a pelos testes realizados \u00e9 que a aglomera\u00e7\u00e3o geom\u00e9trica n\u00e3o \u00e9 a indicada para \n\nproblemas heterog\u00eaneos e anisotr\u00f3picos. E a raz\u00e3o \u00e9 que a anisotropia dos coeficientes da \n\nmalha original n\u00e3o \u00e9 \u201cdissipada\u201d nas malhas grosseiras e, segundo Elias et al. (1997),  essa \n\nanisotropia origina diferentes escalas de tempo de propaga\u00e7\u00e3o da informa\u00e7\u00e3o, o que afeta \n\ndiretamente o comportamento da converg\u00eancia. \n\n \n\n \n\n8.8. Simula\u00e7\u00e3o com Elementos Triangulares e \nQuadrangulares e com Refinamento Local \n\n \n\nEste cap\u00edtulo termina apresentando a simula\u00e7\u00e3o de um reservat\u00f3rio com dimens\u00f5es e \n\ncaracter\u00edsticas mais pr\u00f3ximas das encontradas em campo a fim de demonstrar as \n\npotencialidades do m\u00e9todo proposto. O dom\u00ednio foi discretizado utilizando, em uma mesma \n\n\n\n170 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nmalha, elementos geom\u00e9tricos triangulares e quadrangulares, com demonstra a Fig. 8.40. \n\nPercebe-se que problemas com geometrias complexas, como o considerado aqui, podem ser \n\ntratados com consider\u00e1vel flexibilidade com o m\u00e9todo EbFVM. Os tri\u00e2ngulos, por exemplo, \n\npodem ser utilizados em qualquer dom\u00ednio irregular, podendo os de menores dimens\u00f5es ser \n\nposicionados nas regi\u00f5es mais importantes e de interesse, ou seja, pr\u00f3ximo a po\u00e7os, falhas etc. \n\nEm outras regi\u00f5es pode-se utilizar elementos quadril\u00e1teros, combinando, desta forma, \n\ndiferentes elementos geom\u00e9tricos a fim de produzir uma malha com boa raz\u00e3o de aspecto. \n\n \n\n \n\n \n \n\nFig. 8.40  - Reservat\u00f3rio bidimensional e com falha geol\u00f3gica discretizado com elementos triangulares e \n\nquadrangulares (1061 n\u00f3s e 1289 elementos) \n\n \n\n \n\nA matriz porosa do reservat\u00f3rio analisado \u00e9 considerada homog\u00eanea e isotr\u00f3pica, com \n\nas propriedades f\u00edsicas apresentadas na Tab. 8.8. A falha geol\u00f3gica foi modelada de acordo \n\ncom a proposta deste trabalho, isto \u00e9, utilizando elementos geom\u00e9tricos de espessura reduzida \n\n(na m\u00e9dia menor que 1 mm) e com baixo valor de permeabilidade absoluta (zero, neste caso). \n\nA posi\u00e7\u00e3o da falha geol\u00f3gica e dos po\u00e7os injetor e produtor \u00e9 apresentada na Fig. 8.40. As \n\ncurvas de permeabilidade relativa utilizadas s\u00e3o as definidas pelas Eqs. (8.31) e (8.32) com \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 171 \n\n \n\n \n\n1.2\nw wf s=  e M = 1. O sistema de equa\u00e7\u00f5es foi resolvido com o m\u00e9todo Totalmente Impl\u00edcito e \n\nsolver multigrid, com o passo de tempo calculado automaticamente. \n\n \n\n \nTab. 8.8  \u2013 Propriedades f\u00edsicas e par\u00e2metros num\u00e9ricos utilizados \n\nPorosidade 0,2 \n\nPermeabilidade (isotr\u00f3pica) 500 mD \n\nEspessura da camada 1 m \n\nViscosidades da \u00e1gua e do \u00f3leo 1 cp \n\nCompressibilidades da \u00e1gua e do \u00f3leo 10-4 kPa-1 \n\nswi 0 \n\nsor 0 \n\nSatura\u00e7\u00e3o de \u00e1gua inicial 0 \n\nPress\u00e3o inicial 150 kPa \n\nFatores volume de forma\u00e7\u00e3o da \u00e1gua e do \u00f3leo \navaliados na press\u00e3o inicial \n\n1 \n\nVaz\u00e3o de inje\u00e7\u00e3o de \u00e1gua no po\u00e7o injetor 2000 m3/d \n\nPress\u00e3o de fundo no po\u00e7o produtor 100 kPa \n\n\u00cdndice de po\u00e7o 1 mD.m \n\nPasso de tempo inicial 0,28 d \n\n \n\n \n\nOs perfis de satura\u00e7\u00e3o de \u00e1gua obtidos para diferentes tempos de simula\u00e7\u00e3o s\u00e3o \n\napresentados na Fig. 8.41. Nota-se que estes resultados est\u00e3o qualitativamente reproduzindo o \n\ncomportamento f\u00edsico esperado. Note tamb\u00e9m que o refinamento local ao redor dos po\u00e7os e \n\nfalha geol\u00f3gica p\u00f4de ser feito facilmente neste m\u00e9todo, n\u00e3o apresentando nenhuma \n\nincompatibilidade geom\u00e9trica ou perda de precis\u00e3o devido a c\u00e1lculos aproximados do fluxo \n\nnas interfaces de elementos maiores e menores, o que acontece nos esquemas atualmente \n\nutilizados pelos simuladores comerciais. Al\u00e9m disso, a simplicidade da representa\u00e7\u00e3o da falha \n\nda Fig. 8.40 indica que o EbFVM \u00e9 realmente promissor na \u00e1rea de simula\u00e7\u00e3o de reservat\u00f3rios \n\nde petr\u00f3leo, uma vez que outros tipos de falhas, e mesmo po\u00e7os com geometrias \n\ndemasiadamente complexas, como os que est\u00e3o cada vez mais sendo empregados pelas \n\nempresas de petr\u00f3leo, podem ser adequadamente representados com as malhas n\u00e3o-\n\nestruturadas utilizadas. \n\n \n\n\n\n172 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n                 \n(a) t = 80 dias      (b) t = 380 dias \n\n \n\n                  \n(c) t = 680 dias         (d) t = 1940 dias \n\n \n\nFig. 8.41 \u2013 Perfis de satura\u00e7\u00e3o de \u00e1gua em diferentes tempos de simula\u00e7\u00e3o obtidos pelo m\u00e9todo proposto para o \n\nreservat\u00f3rio da Fig. 8.40 \n\n \n\n \n\nA fim de ressaltar ainda mais a facilidade como as falhas geol\u00f3gicas s\u00e3o representadas \n\nno m\u00e9todo proposto, o mesmo reservat\u00f3rio da Fig. 8.40 foi simulado atribuindo aos elementos \n\nque comp\u00f5em a falha o mesmo valor de permeabilidade do restante do dom\u00ednio, de modo a \n\nanular a influ\u00eancia da falha. Isso \u00e9 feito no arquivo de dados apenas alterando um \u00fanico valor, \n\naquele correspondente \u00e0 permeabilidade dos elementos da falha. O resultado pode ser visto na \n\nFig. 8.42. Note que esta simples altera\u00e7\u00e3o eliminou a influ\u00eancia da falha, como devia ser, \n\nmantendo inalterada a malha. A Fig. 8.41 e a Fig. 8.42 constituem-se em situa\u00e7\u00f5es limites \n\nonde a interfer\u00eancia da falha \u00e9 m\u00e1xima (completamente selante) ou m\u00ednima (completamente \n\nn\u00e3o-selante), respectivamente. Deve-se ressaltar que, atrav\u00e9s desta nova metodologia de \n\nrepresenta\u00e7\u00e3o de falhas, algumas das atividades do engenheiro de reservat\u00f3rio nos processos \n\nde ajuste hist\u00f3rico - History Matching (MATTAX e DALTON, 1990) poder\u00e1 ter uma nova \n\nabordagem. A raz\u00e3o \u00e9 que, nas atividades de calibra\u00e7\u00e3o do modelo, deixou de ser pr\u00e1tico \n\n\n\n CAP.  8  \u2013 RESULTADOS E COMPARA\u00c7\u00d5ES 173 \n\n \n\n \n\nmodificar valores de transmissibilidades em malhas n\u00e3o-estruturadas, pois estes valores n\u00e3o \n\nt\u00eam mais um significado f\u00edsico direto, como discutido no Cap. 7. Fisicamente faz mais sentido \n\nem malhas n\u00e3o-estruturadas simplesmente alterar os valores de permeabilidade absoluta de \n\nelementos da falha, como proposto.  \n\n \n\n \n\n \n\n                \n(a) t = 80 dias      (b) t = 380 dias \n\n \n\n                    \n(c) t = 680 dias         (d) t = 1940 dias \n\n \n\nFig. 8.42 \u2013 Perfis de satura\u00e7\u00e3o de \u00e1gua em diferentes tempos de simula\u00e7\u00e3o obtidos pelo m\u00e9todo proposto para o \n\nreservat\u00f3rio da Fig. 8.40 desconsiderando o aspecto selante da falha geol\u00f3gica \n\n\n\n \n\n\n\n175 \n\nCap.    \n\n9 CCOONNCCLLUUSS\u00d5\u00d5EESS    \n \n\n \n\n \nEste trabalho teve como contribui\u00e7\u00e3o principal o desenvolvimento de um simulador de \n\nreservat\u00f3rios de petr\u00f3leo que utiliza o M\u00e9todo dos Volumes Finitos baseado em Elementos \n\n(EbFVM) e solver multigrid. Neste m\u00e9todo a discretiza\u00e7\u00e3o do dom\u00ednio \u00e9 feita em uma forma \n\nn\u00e3o-estruturada, utilizando elementos triangulares e/ou quadrangulares, possibilitando que \n\nreservat\u00f3rios com geometrias complexas possam ser facilmente representados. Al\u00e9m disso, \n\npor ser um m\u00e9todo que \u00e9 baseado na integra\u00e7\u00e3o das equa\u00e7\u00f5es diferenciais na forma \n\nconservativa em volumes de controle, a conserva\u00e7\u00e3o da massa \u00e9 assegurada, permitindo uma \n\ninterpreta\u00e7\u00e3o direta das equa\u00e7\u00f5es discretas resultantes. Ao longo dos desenvolvimentos, \n\ndiversos quest\u00f5es, muitas delas controversas na \u00e1rea de petr\u00f3leo, foram estudadas. As \n\nconclus\u00f5es centrais s\u00e3o agora reunidas neste cap\u00edtulo conclusivo do trabalho.   \n\n \n\n \n\n9.1. S\u00edntese das Principais Contribui\u00e7\u00f5es \n \nMostrou-se que o refinamento local \u00e9 realizado de forma natural no m\u00e9todo proposto, \n\nsem as dificuldades encontradas nos m\u00e9todos que utilizam malhas estruturadas e que est\u00e3o \n\nrelacionadas \u00e0 perda da precis\u00e3o no c\u00e1lculo dos fluxos entre blocos localizados na intersec\u00e7\u00e3o \n\nde malhas refinadas e grosseiras.  \n\nMostrou-se tamb\u00e9m que o modelo desenvolvido leva a uma clara interpreta\u00e7\u00e3o da \n\ntransmissibilidade, revelando que tri\u00e2ngulos ret\u00e2ngulos ou obtus\u00e2ngulos podem ser utilizados \n\nsem maiores restri\u00e7\u00f5es na malha. Isso contraria ao recomendado na literatura que trata do \n\nm\u00e9todo EbFVM tradicional. Mostrou-se que os termos das equa\u00e7\u00f5es denominados usualmente \n\nde transmissibilidades podem e precisam assumir valores negativos quando \u00e2ngulos obtusos \n\n\n\n176 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\naparecem nos elementos triangulares da malha. A pr\u00e1tica na \u00e1rea num\u00e9rica, contudo, tem \n\ndemonstrado que a presen\u00e7a de tri\u00e2ngulos muito deformados n\u00e3o \u00e9 uma boa conduta, mas a \n\nrejei\u00e7\u00e3o de uma malha pautada pela simples an\u00e1lise do sinal destes termos n\u00e3o se justifica. Na \n\nverdade, foi visto que os erros associados a malhas com elementos com \u00e2ngulos obtusos t\u00eam \n\noutra origem, que \u00e9 a forma de obter as equa\u00e7\u00f5es discretizadas multif\u00e1sicas a partir de uma \n\nadapta\u00e7\u00e3o da equa\u00e7\u00e3o diferencial monof\u00e1sica. Os resultados do m\u00e9todo proposto mantiveram-\n\nse fisicamente coerentes mesmo em malhas formadas por elementos de raz\u00e3o de aspecto \n\ndesfavor\u00e1vel, o que n\u00e3o ocorreu com os m\u00e9todos tradicionais, que chegaram a apresentar \n\ninvers\u00e3o do sentido dos fluxos quando tri\u00e2ngulos demasiadamente obtusos foram utilizados. \n\nO armazenamento das propriedades nos elementos da malha e a representa\u00e7\u00e3o de \n\nfalhas geol\u00f3gicas atrav\u00e9s dos elementos foi a \u00fanica op\u00e7\u00e3o que mostrou ser compat\u00edvel com as \n\nfun\u00e7\u00f5es de interpola\u00e7\u00e3o do m\u00e9todo EbFVM. As oscila\u00e7\u00f5es nos resultados obtidos quando as \n\npropriedades s\u00e3o armazenadas nos volumes de controle e com as falhas geol\u00f3gicas \n\nposicionadas nas suas interfaces podem ser consideradas um reflexo da utiliza\u00e7\u00e3o de um \n\nesquema de interpola\u00e7\u00e3o que n\u00e3o \u00e9 adequado para situa\u00e7\u00f5es de descontinuidades de fun\u00e7\u00f5es \n\ndentro do elemento. Ao armazenar as propriedades nos elementos, conforme proposto nesta \n\ntese, pode-se trabalhar com os mapas de permeabilidade absoluta resultantes do processo de \n\nmudan\u00e7a de escala sem a necessidade de c\u00e1lculo de m\u00e9dias. Nos simuladores de reservat\u00f3rios \n\nde petr\u00f3leo com malhas estruturadas, este c\u00e1lculo \u00e9 usual e pode resultar em erros, conforme \n\nrelatado em alguns trabalhos na literatura. Al\u00e9m disso, no m\u00e9todo proposto \u00e9 direta a inclus\u00e3o \n\ndo tensor permeabilidade completo, o que \u00e9 uma importante caracter\u00edstica na simula\u00e7\u00e3o de \n\nreservat\u00f3rios heterog\u00eaneos e anisotr\u00f3picos. Os c\u00e1lculos realizados elemento a elemento, uma \n\npr\u00e1tica ainda n\u00e3o difundida na \u00e1rea de volumes finitos, possibilitaram a constru\u00e7\u00e3o de um \n\nesquema mais geral, com uma implementa\u00e7\u00e3o mais limpa e \u00e1gil em termos de manuten\u00e7\u00e3o e  \n\nreusabilidade. \n\nFoi mostrado neste trabalho que, para altas raz\u00f5es de mobilidade, os efeitos de \n\norienta\u00e7\u00e3o de malha s\u00e3o sensivelmente mais acentuados nos m\u00e9todos tradicionais do que no \n\nm\u00e9todo proposto, ambos com mesmo esquema de avalia\u00e7\u00e3o das mobilidades, o upwind. Isso \n\nindica que o efeito adicional que contaminou os resultados do EbFVM tradicional deve-se \u00e0 \n\nforma como s\u00e3o obtidas suas equa\u00e7\u00f5es multif\u00e1sicas discretizadas, isto \u00e9, atrav\u00e9s da adapta\u00e7\u00e3o \n\nda equa\u00e7\u00e3o monof\u00e1sica. Quando s\u00e3o utilizadas as equa\u00e7\u00f5es discretizadas provenientes da \n\nintegra\u00e7\u00e3o das equa\u00e7\u00f5es diferenciais multif\u00e1sicas, que \u00e9 o procedimento usual do M\u00e9todo de \n\nVolumes Finitos, o \u00fanico efeito de orienta\u00e7\u00e3o de malha remanescente tem origem na fun\u00e7\u00e3o \n\n\n\n CAP.9 \u2013 CONCLUS\u00d5ES 177 \n\n \n\n \n\nde interpola\u00e7\u00e3o de baixa ordem utilizada. Ao ser utilizada outra fun\u00e7\u00e3o de interpola\u00e7\u00e3o das \n\nmobilidades na equa\u00e7\u00e3o da press\u00e3o, o efeito de orienta\u00e7\u00e3o de malha resultante \u00e9 menor.  \n\nO m\u00e9todo multigrid implementado nesta tese para a resolu\u00e7\u00e3o dos sistemas lineares \n\nprovenientes do m\u00e9todo IMPES e da formula\u00e7\u00e3o Totalmente Impl\u00edcita apresentou \n\ncaracter\u00edsticas que o recomendam tamb\u00e9m em aplica\u00e7\u00f5es de simula\u00e7\u00e3o de reservat\u00f3rios de \n\npetr\u00f3leo. Entre as suas caracter\u00edsticas positivas est\u00e1 o aumento linear do custo computacional \n\ncom o n\u00famero de inc\u00f3gnitas, o que n\u00e3o se verificou em nenhum dos outros solvers estudados. \n\nO multigrid com ciclo F apresentou os menores tempos de processamento e queda \n\nmonot\u00f4nica dos res\u00edduos com o tempo. Embora analisando um n\u00famero limitado de casos \n\nnesta tese, a robustez deste solver pode ser vista, uma vez que o seu desempenho praticamente \n\nn\u00e3o se alterou em problemas anisotr\u00f3picos e heterog\u00eaneos, gra\u00e7as ao esquema de aglomera\u00e7\u00e3o \n\nadaptativa utilizado. O multigrid tamb\u00e9m resolveu sistemas lineares com e sem blocos com \n\ndesempenhos similares. Foi mostrado, por outro lado, que a aglomera\u00e7\u00e3o baseada apenas nos \n\naspectos geom\u00e9tricos da malha produz malhas grosseiras que diminuem o desempenho do \n\nsolver, principalmente em problemas anisotr\u00f3picos.  \n\nPara reunir todos estes desenvolvimentos e test\u00e1-los, um simulador de reservat\u00f3rios de \n\npetr\u00f3leo foi desenvolvido. Este simulador pode ser usado, em fun\u00e7\u00e3o de suas caracter\u00edsticas \n\nconstrutivas, al\u00e9m da continuidade nas atividades de pesquisa, como um simulador did\u00e1tico \n\npara ensino dos fundamentos da simula\u00e7\u00e3o de reservat\u00f3rios de petr\u00f3leo.  \n\n \n\n \n\n9.2. Sugest\u00f5es para Trabalhos Futuros \n   \n\nEmbora o refinamento local seja um procedimento natural e direto no EbFVM, \u00e9 \n\nimportante destacar que a possibilidade de utilizar elementos com n\u00famero vari\u00e1vel de n\u00f3s \u00e9 \n\noutra caracter\u00edstica promissora neste m\u00e9todo e que pode aumentar ainda mais a flexibilidade \n\nda discretiza\u00e7\u00e3o espacial. Foram apresentadas as premissas de um m\u00e9todo baseado em \n\nelementos (Anexo 1) que emprega elementos quadril\u00e1teros constru\u00eddos com uma quantidade \n\nde n\u00f3s variando de 4 a 8. Essa alternativa poder\u00e1 simplificar a representa\u00e7\u00e3o de reservat\u00f3rios \n\ncom falhas e com geometrias altamente complexas. Esse \u00e9 um assunto que merece uma \n\ninvestiga\u00e7\u00e3o maior em trabalhos futuros. \n\nRecomenda-se estudar mais profundamente o impacto nos resultados da m\u00e9dia \n\nvolum\u00e9trica ponderada da porosidade presente no termo transiente. Esta m\u00e9dia \u00e9 necess\u00e1ria \n\n\n\n178 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nquando as propriedades como permeabilidade absoluta e porosidade s\u00e3o armazenadas nos \n\nelementos, e representa o custo de n\u00e3o precisar mais realizar m\u00e9dias na permeabilidade \n\nabsoluta, este \u00faltimo um procedimento usual na \u00e1rea. \n\nUma outra sugest\u00e3o \u00e9 resolver as equa\u00e7\u00f5es do EbFVM com o M\u00e9todo Adaptativo \n\nImpl\u00edcito (AIM) no lugar do IMPES e da formula\u00e7\u00e3o Totalmente Impl\u00edcita. Com este m\u00e9todo, \n\npode-se reduzir significativamente o tempo computacional e a capacidade de armazenamento, \n\nem fun\u00e7\u00e3o do tratamento expl\u00edcito que boa parte dos volumes de controle podem receber \n\ndependendo de um crit\u00e9rio de estabilidade. \n\nA combina\u00e7\u00e3o do EbFVM com outros m\u00e9todos tamb\u00e9m pode ser uma alternativa \n\npromissora. Pode-se citar como exemplo a utiliza\u00e7\u00e3o do EbFVM na resolu\u00e7\u00e3o da equa\u00e7\u00e3o da \n\npress\u00e3o no m\u00e9todo streamlines, empregando-se maiores passos de tempo e resolvendo \n\nrapidamente uma equa\u00e7\u00e3o semi-anal\u00edtica unidimensional para a satura\u00e7\u00e3o em intervalos de \n\ntempo menores.  \n\nA utiliza\u00e7\u00e3o de fun\u00e7\u00f5es upwind bidimensionais em elementos triangulares \u00e9 algo que \n\nainda n\u00e3o foi testado na literatura. Isso possivelmente contribuiria para eliminar \n\ncompletamente o efeito de orienta\u00e7\u00e3o de malha. Conforme j\u00e1 discutido neste texto, estas \n\nfun\u00e7\u00f5es j\u00e1 foram empregadas em outros trabalhos para elementos quadril\u00e1teros e baseiam-se \n\nna dire\u00e7\u00e3o das linhas de correntes, ficando, portanto, menos vinculadas \u00e0s linhas da malha. \n\nComo h\u00e1 um custo computacional adicional neste caso, h\u00e1 uma necessidade de avaliar se esse \n\naumento do tempo de processamento n\u00e3o inviabiliza a sua aplica\u00e7\u00e3o pr\u00e1tica, principalmente \n\nem malhas n\u00e3o-estruturadas, pois uma orienta\u00e7\u00e3o rand\u00f4mica de elementos pode, por si s\u00f3, \n\ncontribuir para amenizar, em parte, o efeito de orienta\u00e7\u00e3o de malha.  \n\nNenhuma prova matem\u00e1tica de converg\u00eancia do m\u00e9todo num\u00e9rico desenvolvido foi \n\nrealizada. Como pode ser visto na literatura de forma geral, este tipo de an\u00e1lise n\u00e3o \u00e9 usual e, \n\nmuito menos, trivial no escopo do m\u00e9todo de volumes finitos. Esse m\u00e9todo se suporta \n\nfundamentalmente na consist\u00eancia de solu\u00e7\u00f5es de problemas complexos. A demonstra\u00e7\u00e3o da \n\nconverg\u00eancia da aproxima\u00e7\u00e3o num\u00e9rica empregada foge do escopo do presente trabalho e fica \n\ncomo sugest\u00e3o para trabalhos futuros. \n\nQuanto ao solver multigrid desenvolvido nesta tese, \u00e9 necess\u00e1rio um estudo mais \n\naprofundado a fim de torn\u00e1-lo ainda mais robusto e eficiente. O multigrid presente em um dos \n\nmais importantes softwares de CFD da atualidade foi testado nos mais diversos problemas, \n\npor longos per\u00edodos, o que contribuiu fortemente para melhorar ainda mais o seu desempenho \n\n(RAW, 1996). Portanto, n\u00e3o \u00e9 poss\u00edvel afirmar, a partir do n\u00famero limitado de testes \n\nefetuados nesta tese, que o solver desenvolvido neste trabalho e seus par\u00e2metros utilizados \n\n\n\n CAP.9 \u2013 CONCLUS\u00d5ES 179 \n\n \n\n \n\ns\u00e3o os ideais para a maior parte dos problemas de simula\u00e7\u00e3o de reservat\u00f3rios. \u00c9 importante \n\nainda submet\u00ea-lo a uma bateria mais completa de testes espec\u00edficos a fim de definir qual \u00e9 a \n\nconfigura\u00e7\u00e3o que atende satisfatoriamente uma gama mais abrangente de problemas f\u00edsicos. \n\nAl\u00e9m disso, a efici\u00eancia do multigrid alg\u00e9brico poderia aumentar ainda mais se fossem \n\nempregadas outras t\u00e9cnicas que parecem promissoras, como o processamento paralelo \n\n(ZHAO et al., 2004). \n\nEmbora a forma de obten\u00e7\u00e3o das equa\u00e7\u00f5es das malhas grosseiras empregada neste \n\ntrabalho tenha apresentado resultados satisfat\u00f3rios, recomenda-se estudar alternativas que \n\nresultem em valores mais adequados das corre\u00e7\u00f5es. Deve-se lembrar que o esquema utilizado \n\nneste trabalho consiste em anular o somat\u00f3rio dos res\u00edduos nos blocos, o que pode acarretar \n\nem m\u00f3dulos de res\u00edduos locais elevados. Talvez um m\u00e9todo que minimize o somat\u00f3rio dos \n\nm\u00f3dulos dos res\u00edduos nos blocos das malhas grosseiras poderia ser uma melhor alternativa. \n\nNo entanto, o custo computacional associado \u00e0 obten\u00e7\u00e3o dos valores m\u00ednimos normalmente \u00e9 \n\nalto. Apenas um estudo mais profundo poderia demonstrar a sua viabilidade pr\u00e1tica. \n\nComo o formato final da matriz de coeficientes de um sistema linear depende \n\ndiretamente da forma como os n\u00f3s s\u00e3o numerados, e conseq\u00fcentemente, da ordena\u00e7\u00e3o das \n\nequa\u00e7\u00f5es, pode-se mostrar que a forma como as equa\u00e7\u00f5es s\u00e3o ordenadas afeta a velocidade de \n\nconverg\u00eancia dos m\u00e9todos de resolu\u00e7\u00e3o de sistemas lineares (AZIZ e SETTARI, 1979). Por \n\nisso seria importante um estudo que relacionasse a efici\u00eancia do solver multigrid e a forma \n\ncomo a matriz de coeficientes est\u00e1 organizada. \n\n \n\n \n\n9.3. Considera\u00e7\u00f5es Finais \n \n\nNa \u00faltima d\u00e9cada, o hardware sofreu mudan\u00e7as dr\u00e1sticas, possibilitando que muita \n\ninforma\u00e7\u00e3o pudesse ser manipulada e com rapidez. O software, de uma maneira geral, tem \n\nacompanhado essa tend\u00eancia. Contudo, neste intervalo de tempo houve um grande esfor\u00e7o de \n\npesquisa dedicado \u00e0s ferramentas j\u00e1 dispon\u00edveis nos simuladores comerciais, sendo poucos os \n\ntrabalhos que apresentaram novas metodologias e novos modelos num\u00e9ricos conservativos \n\n(TAMIN et al. 1999). Assim, existe grande necessidade e oportunidades de pesquisa nesta \n\n\u00e1rea. O trabalho desenvolvido nesta tese enquadra-se nesse contexto, sendo este um passo \n\npreliminar rumo ao desenvolvimento de um simulador mais completo, isto \u00e9, tridimensional, \n\ncomposicional e com malhas n\u00e3o-estruturadas. A elabora\u00e7\u00e3o de um software robusto para uso \n\n\n\n180 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nno dia-a-dia da engenharia de simula\u00e7\u00e3o de reservat\u00f3rios que equacione, dentro dos requisitos \n\ndo problema, os fen\u00f4menos f\u00edsicos importantes, \u00e9 o grande desafio. Estes princ\u00edpios foram \n\nnorteadores no desenvolvimento deste trabalho. \n\n \n\n \n\n \n\n\n\n181 \n\nRREEFFEERR\u00ca\u00caNNCCIIAASS  BBIIBBLLIIOOGGRR\u00c1\u00c1FFIICCAASS  \n \n\n \nAAVATSMARK, I., REISO, E., REME, H. and TEIGLAND, R., 2001. MPFA for Faults and \n\nLocal Refinements in 3D Quadrilateral Grids with Application to Field Simulations, SPE \n\npaper 66356 presented at the Reservoir Simulation Symposium, 11-14 February, Houston, \n\nTexas. \n\nAPPEL, C. A., 1976. A Note on Computing Finite-Difference Interblock Transmissibilities, \n\nWater Resour. Res., v. 12, n. 3, p. 561-563. \n\nAZIZ, K. and SETTARI, A., 1979. Petroleum Reservoir Simulation, Applied Science \n\nPublishers, London. \n\nBAJOR, O. and CORMACK, D. E., 1989. A New Method for Characterizing the Grid \n\nOrientation Phenomenon, SPE paper 19353, Society of Petroleum Engineering. \n\nBAKER, R.O., KUPPE, F., CHUGH, S., BORA, R., STOJANOVIC, S. and BATYCKY, R., \n\n2002. Full-Field Modeling Using Streamline-Based Simulation: Four Case Studies, SPE \n\nReservoir Evaluation &amp; Engineering Journal, April, pp. 126-134. \n\nBAKHVALOV, N. S., 1966. On the Convergence of a Relaxation Method Under Natural \n\nConstraints on an Elliptic Operator, USSR Comput. Math. Math. Phys., 6(5):101-135. \n\nBALIGA, B. R. and PATANKAR, S. V., 1983. A Control Volume Finite-Element Method \n\nfor Two-Dimensional Fluid Flow and Heat Transfer, Numerical Heat Transfer, vol. 6, pp. \n\n245-261. \n\nBANASZEK, J., 1995. Some Theoretical and Practical Aspects of Efficient Modelling of \n\nHeat Transfer Phenomena on Finite Element Grid, Bulletin of Institute of Heat \n\nEngineering, No.79, pp. 57-90. \n\nBARRETT, R., BERRY, M., CHAN, T. F., DEMMEL, J., DONATO, J., DONGARRA, J., \n\nEIJKHOUT, V., POZO, R., ROMINE, C.  and VAN DER VORST, H., 1994. Templates \n\nfor the Solution of Linear Systems: Building Blocks for Iterative Methods, 2nd Ed., SIAM, \n\nPhiladelphia, PA. \n\n\n\n182 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nBASTIAN, P. and HELMIG, R., 1999. Efficient Full-Coupled Solution Techniques for Two-\n\nPhase Flow in Porous Media \u2013 Parallel Multigrid Solution and Large Scale Computations, \n\nAdvances in Water Resources, 23, pp. 199-216. \n\nBASTIAN, P., 2003. Higher Order Discontinuous Galerkin Methods for Flow and Transport \n\nin Porous Media, in Challenges in Scientific Computing - CISC 2002, number 35 in \n\nLNCSE, pp. 1-22. \n\nBATYCKY, R. P., BLUNT, M. J.  and THIELE, M. R., 1997. A 3D Field-Scale Streamline-\n\nBased Reservoir Simulator, SPE Reservoir Engineering, Vol. 12, Number 4, November, \n\npp. 246-254. \n\nBEHIE, A. and FORSYTH, P. A., 1983a. Multigrid Solution of the Pressure Equation in \n\nReservoir Simulation, SPE J, pp. 623-632, August. \n\nBEHIE, A. and FORSYTH, P. A., 1983b. Multi-Grid Solution of Three Dimensional \n\nProblems with Discontinuous Coefficients, Appl. Math. Comp., 13 (1983) 229-240. \n\nBLAIR, P. M. and WEINAUG, C. F., 1969. Solution of Two-Phase Flow Problems Using \n\nImplicit Difference Equations, SPE Journal, pp. 417-424; Trans., AIME, 246. \n\nBRANCO, C. M. and RODRIGUEZ, F., 1996. A Semi-Implicit Formulation for \n\nCompositional Reservoir Simulation, SPE Applied Technology Series, Vol 4, Number 1, \n\nMay, pp. 171-177. \n\nBRANDT, A., 1973.  Multi\u2013level Adaptive Technique (MLAT) for Fast Numerical Solution \n\nto Boundary Value Problems, in Proceedings of the Third International Conference on \n\nNumerical Methods in Fluid Mechanics, H. Cabannes and R. Teman, eds., vol. 18 of \n\nLecture Notes in Physics, Berlin, Springer\u2013Verlag, pp. 82\u201389. \n\nBRANDT, A., MCCORMICK, S. F. and RUGE, J. W., 1982. Algebraic Multigrid (AMG) for \n\nAutomatic Multigrid Solution with Application to Geodetic Computations, Technical \n\nReport, Institute for Computational Studies, Colorado State University. \n\nBRIGGS, W. L., HENSON, V. E. and McCORMICK, S., 2000. A Multigrid Tutorial, 2nd \n\nedition,  SIAM Books, Philadelphia. \n\n\n\n REFER\u00caNCIAS BIBLIOGR\u00c1FICAS 183 \n\n \n\n \n\nCAI, Z., J. JONES, S. MCCORMICK, T. RUSSELL, 1997. Control-Volume Mixed Finite \n\nElement Methods, Computational Geosciences, vol.1, pp. 289-315.   \n\nCAILLABET, Y., MAGRAS, J. F. and  RICOIS, O., 2003. Large Compositional Reservoir \n\nSimulations with Parallelized Adaptive Implicit Methods, SPE paper 81501 presented at \n\nthe SPE Middle East Oil Show, 9-12 June, Bahrain. \n\nCAO, H. and AZIZ, K., 2002. Performance of IMPSAT and IMPSAT-AIM Models in \n\nCompositional Simulation, SPE paper 77720 presented at the SPE Annual Technical \n\nConference and Exhibition, San Antonio, Texas, 29 September-2 October.  \n\nCASTELLINI, A., 2001. Flow Based Grids for Reservoir Simulation, Master thesis, Stanford \n\nUniversity. \n\nCHEN, Y., DURLOFSKY, L. J., GERRITSEN, M. and WEN, X. H., 2003. A Coupled Local-\n\nGlobal Upscaling Approach for Simulating Flow in Highly Heterogeneous Formations, \n\nAdvances in Water Resources, 26:1041-1060. \n\nCIMENT, M. and SWEET, R. A., 1973. Mesh Refinements for Parabolic Equations,  \n\nJournal of Computational Physics, Volume 12, Issue 4, August, Pages 513-52. \n\nCLEARY, A. J., FALGOUT, R. D., HENSON, V. E., JONES, J. E., MANTEUFFEL, T. A., \n\nMCCORMICK, S. F., MIRANDA, G. N. and RUGE, J. W., 1999. Robustness and \n\nScalability of Algebraic Multigrid. SIAM J. Sci. Comput. 21, 5, Dec, 1886-1908.  \n\nCOATS, K. H., 1968. Computer Simulation of Three-Phase Flow in Reservoirs, University of \n\nTexas, Austin, Texas. \n\nCOATS, K. H., 2000. A Note on IMPES and Some IMPES Based Simulation Models, SPE \n\nJournal,  Vol. 5, N. 3, pp. 245-251. \n\nCOATS, K. H., 2003. IMPES Stability: Selection of Stable Timesteps, SPE Journal, Vol. 8, \n\nNumber 2, June, pp. 181-187. \n\nCOLLINS, D. A. and MOURITS, F. M., 1991. Multigrid Methods Applied to Near-Well \n\nModeling in Reservoir Simulation, SPE paper 23607. \n\n\n\n184 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nCOLLINS, D. A., NGHIEM, L.X., LI, Y. K. and GRABONSTOTTER, J.E., 1986. An \n\nEfficient Approach to Adaptive-Implicit Compositional Simulation with an Equation of \n\nState, SPE Reservoir Engineering, May, pp. 259-264. \n\nCOOK, R. D., MALKUS, D. S. and PLESHA, M. E., 1989. Concepts and Applications of \n\nFinite Elements Analysis, 3rd Ed., John Wiley &amp; Sons, New York. \n\nCORDAZZO, J., HURTADO, F. S. V., MALISKA, C. R. and SILVA, A. F. C., 2004a. The \n\nNegative Transmissibility Issue When Using CVFEM in Petroleum Reservoir Simulation \n\n\u2013 1. Theory, Proceedings of the 10o.  Brazilian Congress of Thermal Sciences and \n\nEngineering \u2013 ENCIT, Rio de Janeiro. \n\nCORDAZZO, J., HURTADO, F. S. V., MALISKA, C. R. and SILVA, A. F. C., 2004b. The \n\nNegative Transmissibility Issue When Using CVFEM in Petroleum Reservoir Simulation \n\n\u2013 2. Results, Proceedings of the 10o. Brazilian Congress of Thermal Sciences and \n\nEngineering \u2013 ENCIT, Rio de Janeiro. \n\nCORDAZZO, J., MALISKA, C. R. and SILVA, A. F. C., 2002. Interblock Transmissibility \n\nCalculation Analysis for Petroleum Reservoir Simulation,  in proceedings of the 2nd \n\nMeeting on Reservoir Simulation, Universidad Argentina de la Empresa, Buenos Aires, \n\nArgentina,  November 5-6. \n\nCOUTINHO, A. L. G. A., DIAS, C. M., ALVES, J. L. D., LANDAU, L., LOULA, A. F. D., \n\nMALTA, S. M. C., CASTRO, R. G. S. and GARCIA, E. L. M., 2004. Stabilized Methods \n\nand Post-Processing Techniques for Miscible Displacements, Computer Methods in \n\nApplied Mechanics and Engineering, v. 193, issues 15-16, pp. 1421-1436.  \n\nCRUMPTON, P. I., SHAW, G. F. and WARE, F., 1995. Discretisation and Multigrid \n\nSolution of Elliptic Equations with Mixed Derivative Terms and Strongly Discontinuous \n\nCoefficients, Journal of Computational Physics,  v. 116, pp. 343-358. \n\nDAKE, L. P., 2001. The Practice of Reservoir Engineering. Revised Edition. Elsevier Science \n\nB. V. Amsterdam, The Netherlands. \n\nDARCY, H., 1856. Les Fontaines Publiques de la Ville de Dijon, Paris (reprinted in  \n\nHubbert, M. K., 1969. The Theory of Ground-Water Motion and Related Papers. Hafner \n\nPublishing Company, New York and London). \n\n\n\n REFER\u00caNCIAS BIBLIOGR\u00c1FICAS 185 \n\n \n\n \n\nDARLOW, B.L., EWING, R.E., and WHEELER, M.F., 1984. Mixed Finite Element Method \n\nfor Miscible Displacement Problems in Porous Media, SPE Journal, August, pp. 391-398. \n\nDEMBO, R. S. EISENSTAT, S. C. and STEIHAUG, T., 1982. Inexact Newton Methods, \n\nSIAM J. Numer. Anal., vol.19, pp. 400-408. \n\nDENDY Jr., J. E., MCCORMICK, S. F., RUGE, J. W. and RUSSELL, T. F., 1989. Multigrid \n\nMethods for Three-Dimensional Petroleum Reservoir Simulation, SPE paper 18409 \n\npresented at the SPE Symposium on Reservoir Simulation, 6-8 February, Houston, Texas. \n\nDOUGLAS, J, FURTADO, and PEREIRA, F., 1997. On the Numerical Simulation of \n\nWaterflooding of Heterogeneous Petroleum Reservoirs, Computational Geosciences, Vol. \n\n1, pp. 155-190. \n\nDYKE, K. V., 1997. Fundamentals of Petroleum, 4th Ed., Petroleum Extension Service, \n\nContinuing &amp; Extended Education, The University of Texas at Austin, Texas. \n\nECLIPSE Technical Description, 2004. Sugar Land, TX: Schlumberger Information Systems. \n\nEDWARDS, M. G. and ROGERS, C. F., 1998. Finite Volume Discretization with Imposed \n\nFlux Continuity for the General Tensor Pressure Equation, Computational Geosciences 2, \n\npp. 259-290. \n\nEDWARDS, M. G., 2003. Control-Volume Distributed Sub-Cell Flux Schemes for \n\nUnstructured and Flow Based Grids, SPE paper 79710 presented at the Reservoir \n\nSimulation Symposium, 3-5 February, Houston, Texas. \n\nEDWARDS, M. G., ELF, R. A. and AZIZ, K., 1998. Quasi K-Orthogonal Streamline Grids: \n\nGridding and Discretization, SPE paper 49072 presented at the Annual Technical \n\nConference and Exhibition, 27-30 September, New Orleans, Louisiana. \n\nELIAS, S. R., 1993. Enhancements to Additive Correction Multigrid, Master thesis, \n\nUniversity of Waterloo, Canada. \n\nELIAS, S. R., STUBLEY, G. D. and RAITHBY, G. D., 1997. An Adaptive Agglomeration \n\nMethod for Additive Correction Multigrid, International Journal for Numerical Methods \n\nin Engineering, Vol. 40, pp. 887-903. \n\n\n\n186 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nFAGIN, R. G. and STEWART Jr., C. H., 1966. A New Approach to the Two-Dimensional \n\nMultiphase Reservoir Simulator, SPE Journal, June, pp. 175 \u2013 182. \n\nFEDORENKO, R. P., 1964. The Speed of Convergence of One Iteration Process, USSR \n\nComputational Math. and Math. Physics, Vol. 4, pp. 227-235. \n\nFLEMING, G. C., 1987. Modeling the Performance of Fractured Wells in Pattern Floods \n\nUsing Orthogonal, Curvilinear Grids, SPE paper 16973 presented at the Annual Technical \n\nConference and Exhibition, 27-30 September, Dallas, Texas. \n\nFORSYTH, P., 1990. A Control-Volume, Finite-Element Method for Local Mesh Refinement \n\nin Thermal Reservoir Simulation, SPE Reservoir Engineering, November, pp. 561-566. \n\nFRAUENTHAL, J. C., di FRANCO, R. B. and TOWLER, B. F. T., 1985. Reduction of Grid-\n\nOrientation Effects in Reservoir Simulator with Generalized Upstream Weighting, SPE \n\nJournal, 902-908, December.  \n\nFUNG, L. S. K., BUCHANAN, W. L. and SHARMA, R., 1993. Hybrid-CVFE Method for \n\nFlexible Grid Reservoir Simulation, SPE paper 25266 presented at the 12th SPE \n\nSymposium on Reservoir Simulation, New Orleans, LA, February 28-March 3. \n\nFUNG, L. S., HIEBERT, A. D. and NGHIEM, L., 1991. Reservoir Simulation With a \n\nControl-Volume Finite-Element Method, SPE paper 21224 presented at the 11th SPE \n\nSymposium on Reservoir Simulation, Anaheim, California, February 17-20. \n\nGERRITSEN, M. G. and DURLOFSKY, L. J., 2005. Modeling Fluid Flow in Oil Reservoirs, \n\nAnnual Review of Fluid Mechanics, v. 37, pp. 211-238.  \n\nGOLDTHORPE, W. H. and CHOW, Y. S., 1985. Unconventional Modelling of Faulted \n\nReservoirs: A Case Study, SPE paper 13526 presented at the Reservoir Simulation \n\nSymposium, 10-13 February, Dallas, Texas. \n\nGOTTARDI, G. and DALL\u00b4OLIO, D., 1992. A Control-Volume Finite-Element Model for \n\nSimulating Oil-Water Reservoirs, Journal of Petroleum Science and Engineering, 8, 29-\n\n41, Elsevier Science Publishers B. V., Amsterdam. \n\nGREENKORN, R. A., 1983. Flow Phenomena in Porous Media, Marcel Dekker, New York. \n\n\n\n REFER\u00caNCIAS BIBLIOGR\u00c1FICAS 187 \n\n \n\n \n\nHEINEMANN, Z. E., BRAND, C. W., MARGIT, M. and CHEN, Y. M., 1991. Modeling \n\nReservoir Geometry With Irregular Grids, SPE Reservoir Engineering, May, pp. 225-232. \n\nHEINEMANN, Z. E., GERKEN, G. and VON HANTELMANN, G., 1983. Using Local Grid \n\nRefinement in a Multiple-Application Reservoir Simulator, SPE paper 12255 presented at \n\nthe Reservoir Simulation Symposium, 15-18 November, San Francisco, California. \n\nHIRASAKI, G. J. and O'DELL, P. M., 1970. Representation of Reservoir Geometry for \n\nNumerical Simulation, SPE Journal, December, pp. 393-404. \n\nHUBER, R. U. and HELMIG, R., 1999. Multiphase Flow in Heterogeneous Porous Media: A \n\nClassical Finite Element Method Versus an IMPES-based Mixed FE/FV Approach, \n\nInternational Journal for Numerical Methods in Fluids, v. 29, pp. 899-920.  \n\nHUGHES, T. J. R., 1987. The Finite Element Method, Linear Static and Dynamic Finite \n\nElement Analysis, Prentice Hall, New Jersey. \n\nHURTADO, F. S. V., 2005. Uma Formula\u00e7\u00e3o de Volumes Finitos baseada em Elementos \n\npara a Simula\u00e7\u00e3o do Deslocamento Bif\u00e1sico Imisc\u00edvel em Meios Porosos, Disserta\u00e7\u00e3o de \n\nMestrado em Engenharia Mec\u00e2nica, UFSC, Florian\u00f3polis, SC.  \n\nHURTADO, F. S. V., MALISKA, C. R., SILVA, A. F. C., AMBRUS, J., CONTESSI, B. A. \n\nand CORDAZZO, J., 2004. Development of a Laboratory Data Interpretation Software for \n\nDetermination of Relative Permeability Curves by a Parameter Estimation Method, \n\nProceedings of the Rio Oil &amp; Gas 2004 Expo and Conference, Rio de Janeiro, October 4-\n\n7. \n\nHUTCHINSON, B. R. and RAITHBY, G. D., 1986. A Multigrid Method Based on the \n\nAdditive Correction Strategy, Numerical Heat Transfer, vol. 9, pp. 511-537. \n\nIMEX, Version 2002 User\u2019s Guide. Computer Modelling Group Ltd, Calgary, Alberta, \n\nCanada. \n\nJAYANTHA, P. A. and  TURNER, I. W., 2001. A Comparison of Gradient Approximations \n\nfor Use in Finite-Volume Computational Models for Two-Dimensional Diffusion \n\nEquations, Numerical Heat Transfer, Part B, vol. 40,  pp. 367-390. \n\n\n\n188 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nJOSUTTIS, N. M., 1999. The C++ Standard Library  - A Tutorial and Reference, Addison-\n\nWesley, U.S.A. \n\nKOCBERBER, S., 1995. An Automatic, Unstructured Grid-Generation System for \n\nGeologically Complex Reservoirs, SPE paper 28245 presented at the 1994 SPE \n\nPetroleum Computer Conference, Dallas, July 31-Aug.3. \n\nKULKARNI, R., WATSON, A. T., NORDTVEDT, J. and SYLTE, A., 1998. Two-Phase \n\nFlow in Porous Media: Property Identification and Model Validation, AIChE Journal, \n\nVol. 44, No. 11, 2337-2350.  \n\nKUWAUCHI, Y, ABBASZADEH, M., SHIRAKAWA, S. and YAMAZAKI, N., 1996. \n\nDevelopment and Applications of a Three Dimensional Voronoi-Based Flexible Grid \n\nBlack Oil Reservoir Simulator, SPE paper 37028 presented at the SPE Asia Pacific Oil &amp; \n\nGas Conference, Adelaide, Australia, 28-31 October. \n\nLAKE, L, W., 1989. Enhanced Oil Recovery, Prentice-Hall, New Jersey. \n\nMALISKA, C. R., 2004. Transfer\u00eancia de Calor e Mec\u00e2nica dos Fluidos Computacional, 2\u00aa.   \n\nEdi\u00e7\u00e3o revista e ampliada, Livros T\u00e9cnicos e Cient\u00edficos Editora, Rio de Janeiro. \n\nMALISKA, C. R., CUNHA, A. R., LIVRAMENTO, M. A. and SILVA, A. F. C., 1994. \n\nTridimensional Petroleum Reservoir Simulation Using Generalized Curvilinear Grids, in \n\nproceedings do V ENCIT, S\u00e3o Paulo, Dezembro, pp. 363-366. \n\nMALISKA, C. R., SILVA, A. F. C., CORDAZZO, J., CEMIN, A. Jr. e HURTADO, F. S. V., \n\n2004. Guia de Procedimentos para Simula\u00e7\u00e3o com Malhas N\u00e3o-Estruturadas no STARS, \n\nRelat\u00f3rio Final, Projeto \u201cMalhas n\u00e3o-estruturadas para simula\u00e7\u00e3o de reservat\u00f3rios \u2013 \n\nDesenvolvimento de um n\u00facleo num\u00e9rico, estudos de malhas n\u00e3o-estruturadas e extens\u00e3o \n\ndo programa Ciclope\u201d, Outubro, Laborat\u00f3rio de Simula\u00e7\u00e3o Num\u00e9rica em Mec\u00e2nica dos \n\nFluidos e Transfer\u00eancia de Calor \u2013 SINMEC, ESSS e CENPES/Petrobras. \n\nMALISKA, C. R., SILVA, A. F. C., CORDAZZO, J., R, MENDES, R. e CEMIN, A. Jr.,  \n\n2002. Guia de Procedimentos para Interpreta\u00e7\u00e3o de Transmissibilidades em Malhas \n\nUtilizadas no IMEX, Relat\u00f3rio Final, Projeto \u201cMalhas volum\u00e9tricas para a simula\u00e7\u00e3o de \n\nreservat\u00f3rios de petr\u00f3leo \u2013 An\u00e1lise num\u00e9rica e programa de convers\u00e3o\u201d, Agosto, \n\nLaborat\u00f3rio de Simula\u00e7\u00e3o Num\u00e9rica em Mec\u00e2nica dos Fluidos e Transfer\u00eancia de Calor \u2013 \n\nSINMEC, ESSS e CENPES/Petrobras. \n\n\n\n REFER\u00caNCIAS BIBLIOGR\u00c1FICAS 189 \n\n \n\n \n\nMALISKA, C. R., SILVA, A. F. C., CORDAZZO, J., SILVA, R. F. A. R, MENDES, R. e \n\nCEMIN, A. Jr.,  2001. Malhas Volum\u00e9tricas para Simula\u00e7\u00e3o de Reservat\u00f3rios de \n\nPetr\u00f3leo, 1\u00ba. Relat\u00f3rio, Projeto \u201cMalhas volum\u00e9tricas para a simula\u00e7\u00e3o de reservat\u00f3rios de \n\npetr\u00f3leo \u2013 An\u00e1lise num\u00e9rica e programa de convers\u00e3o\u201d, Junho, Laborat\u00f3rio de Simula\u00e7\u00e3o \n\nNum\u00e9rica em Mec\u00e2nica dos Fluidos e Transfer\u00eancia de Calor Calor \u2013 SINMEC, ESSS e \n\nCENPES/Petrobras.. \n\nMARCONDES, F., 1996. Solu\u00e7\u00e3o Num\u00e9rica Usando M\u00e9todos Adaptativos-Impl\u00edcitos e \n\nMalha de Voronoi de Problemas de Reservat\u00f3rios de Petr\u00f3leo, tese de doutoramento, \n\nUniversidade Federal de Santa Catarina, Florian\u00f3polis, SC. \n\nMARCONDES, F., ZAMBALDI, M. C. e MALISKA, C. R., 1994. Simula\u00e7\u00e3o Num\u00e9rica de \n\nReservat\u00f3rios de Petr\u00f3leo Utilizando Malhas de Voron\u00f3i, V Encontro Nacional de \n\nCi\u00eancias T\u00e9rmicas e II Simp\u00f3sio de Engenharia T\u00e9rmica, S\u00e3o Paulo. \n\nMASCHIO, C. and SCHIOZER, D. J., 2002. Analysis of the Performance of Streamline \n\nSimulation, proceedings of 2nd Meeting on Reservoir Simulation, Buenos Aires, \n\nArgentina, November 5-6.  \n\nMATTAX, C. C. and DALTON, R. L., 1990. Reservoir Simulation. SPE Monograph Series, \n\nVol 13, Society of Petroleum Engineers, Richardson,TX. \n\nMcCAIN W. D. Jr., 1990. The Properties of Petroleum Fluids, 2nd edition, Tulsa, Oklahoma, \n\nUSA: PennWell Publishing Co. Inc. \n\nMEJIA, G. M., MOHANTY, K. K. and WATSON, A. T., 1995. Use of in Situ Saturation \n\nData in Estimation of Two-Phase Flow Functions in Porous Media, Journal of Petroleum \n\nScience and Engineering, 12, 233-245. \n\nMLACNIK, M. J. HARRER, A. W. and HEINEMANN, Z. E., 2003. Locally Streamline-\n\nPressure-Potential-Based PEBI Grids, SPE paper 79684 presented at the Reservoir \n\nSimulation Symposium, 3-5 February, Houston, Texas. \n\nMOTA, M. A. A., 1994. Simula\u00e7\u00e3o Num\u00e9rica de Reservat\u00f3rios de Petr\u00f3leo Utilizando \n\nCoordenadas Generalizadas e Esquema de Interpola\u00e7\u00e3o TVD, Disserta\u00e7\u00e3o de Mestrado \n\nem Engenharia Mec\u00e2nica, UFSC, Florian\u00f3polis, SC.  \n\nNASH, S. G., 1990. A History of Scientific Computing. Addison-Wesley, USA. \n\n\n\n190 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nPALAGI, C. L. and AZIZ, K., 1991. Use of Voronoi Grid in Reservoir Simulation, SPE paper \n\n22889 presented at the 66th Annual Technical Conference and Exhibition, Dallas, TX, \n\nOctober 6-9. \n\nPALAGI, C., 1992. Generation and Application of Voronoi Grid to Model Flow in \n\nHeterogeneous Reservoir, Doctor Thesis, Stanford University, California.  \n\nPARSONS, I. D. and Coutinho, A. L. G. A., 1999. Finite Element Multigrid for Two-Phase \n\nImmiscible Flow in Heterogeneous Media, Communications in Numerical Methods in \n\nEngineering, vol. 15, pp. 1-7. \n\nPATANKAR, S. V., 1980. Numerical Heat Transfer and Fluid Flow, Hemisphere Publishing \n\nCorporation, Washington. \n\nPEACEMAN, D. W., 1977. Fundamentals of Numerical Reservoir Simulation, Elsevier \n\nScientific Publishing Company, Amsterdan, The Netherlands. \n\nPEDROSA Jr., O. A. and AZIZ, K., 1986. Use of a Hybrid Grid in Reservoir Simulation, SPE \n\nReservoir Engineering, November, pp. 611-621. \n\nPETTERSEN, O., 1983. Finite-Difference Representation of Permeabilities in Heterogeneous \n\nModels, SPE paper 12340 presented at SPE Fall Meeting, Dallas, Texas. \n\nPHILIPS, R. E. and SCHMIDT, F. W., 1984. Multigrid Techiniques for the Numerical \n\nSolution of the Diffusion Equation, Numerical Heat Transfer, vol. 7, pp. 251-268. \n\nPR\u00c9VOST, M., EDWARDS, M. G. and BLUNT, M. J., 2001. Streamline Tracing on \n\nCurvilinear Structured and Unstructured Grids, SPE paper 66347 presented at the \n\nReservoir Simulation Symposium, 11-14 February, Houston, Texas. \n\nQUANDALLE, P. and SAVARY, D., 1989. An Implicit in Pressure and Saturations \n\nApproach to Fully Compositional Simulation, SPE paper 18423 presented at the SPE \n\nSymposium on Reservoir Simulation, 6-8 February, Houston, Texas. \n\nQUANDALLE, P., 1993. Eighth SPE Comparative Solution Project: Gridding Techniques in \n\nReservoir Simulation, SPE paper 25263 presented at 12th SPE Symposium on Reservoir \n\nSimulation, New Orleans, LA, U.S.A., February 28-March 3. \n\n\n\n REFER\u00caNCIAS BIBLIOGR\u00c1FICAS 191 \n\n \n\n \n\nRAW, M., 1996. Robustness of Coupled Algebraic Multigrid for the Navier-Stokes \n\nEquations, AIAA 96-0297, 34th Aerospace and Sciences Meeting &amp; Exhibit, January 15-\n\n18, Reno, NV. \n\nRAW, M., 1985. A New Control Volume Based Finite Element Procedure for the Numerical \n\nSolution of the Fluid Flow and Scalar Transport Equations, Ph.D. Thesis, University of \n\nWaterloo, Waterloo, Ontario, Canada. \n\nRENARD, P. and MARSILY, G., 1997. Calculating Equivalent Permeability: A Review, \n\nAdvances in Water Resources, Vol. 20, Nos 5-6, pp. 253-278. \n\nRODRIGUES, J. R. P., and DICKSTEIN, F., 1996. A Multigrid Procedure for Local Grid \n\nRefinement in Oil Reservoir Simulation, Journal SPE Applied Technology Series, Issue \n\nVol 4, Number 1, Pages 157-164.  \n\nROMEU, R. K. and NOETINGER, B., 1995. Calculation of Internodal Transmissibilities in \n\nFinite Difference Models of Flow In Heterogeneous Porous Media, Water Resour. Res., v. \n\n31, n. 4, p. 943-959. \n\nROSA, A. J., CARVALHO, R. S. e XAVIER, J. A. D., 2006. Engenharia de Reservat\u00f3rios de \n\nPetr\u00f3leo, Ed. Interci\u00eancia : Petrobras, Rio de Janeiro. \n\nROZON, B. J., 1989. A Generalized Finite Volume Discretization Method for Reservoir \n\nSimulation, SPE paper 18414 presented at the Reservoir Simulation Symposium, Houston, \n\nTexas, February 6-8. \n\nRUGGIERO, M. A. G. e LOPES, V. L. R., 1997. C\u00e1lculo Num\u00e9rico: Aspectos Te\u00f3ricos e \n\nComputacionais, 2\u00aa. ed.,  Makron Books, S\u00e3o Paulo. \n\nSAAD, Y., 2000. Iterative Methods for Sparse Linear Systems, 2nd Ed., PWS Publishing \n\nCompany, Boston. \n\nSANTOS, L. O. E., ORTIZ, C. E. P., GASPARI, H. C., HAVERROTH, G. E. and PHILIPPI, \n\nP. C., 2005. Prediction of Intrinsic Permeabilities with Lattice Boltzmann Method, \n\nProcedings of 18th International Congress of Mechanical Engineering \u2013 COBEM, \n\nNovember 6-11, Ouro Preto, MG. \n\n\n\n192 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nSCHNEIDER, G. E. and ZEDAN, M., 1983. Control-Volume-Based Finite Element \n\nFormulation of the Heat Conduction Equation, in Spacecraft Thermal Control, Design, \n\nand Operation, Prog. Astronaut. Aeronaut., vol. 86, pp. 305-327. \n\nSETTARI, A. and AZIZ, K., 1973. A Generalization of Additive Correction Methods for the \n\nIterative Solution of Matrix Equations, SIAM Journal of Numerical Analysis, Vol. 10, pp. \n\n506 \u2013 521. \n\nSHAW, C. T., 1992. Using Computational Fluid Dynamics, Prentice Hall, New York. \n\nSHIN, D. and MERCHANT, A. R., 1993. Higher-Order Flux Update Function Method for \n\nReduction of Numerical Dispersion and Grid Orientation Effect in Reservoir Simulation, \n\nSPE paper 25600 presented at the SPE Middle East Oil Technical Conference &amp; \n\nExhibition, 3-6 April, Bahrain. \n\nSHIRALKAR, G. S., FLEMING, G. C., WATTS, J. W., WONG, T. W., COATS, B. K., \n\nMOSSBARGER, R., ROBBANA, E. and BATTEN, A. H., 2005. Development and Field \n\nApplication of a High Performance, Unstructured Simulator with Parallel Capability, SPE \n\npaper 93080 presented at the SPE Reservoir Simulation Symposium, 31 January-2 \n\nFeburary, The Woodlands, Texas. \n\nSILVA, A., COUTINHO, A. L. G. A. e PARSONS, I., 2000. M\u00e9todos Multigrid para a \n\nSimula\u00e7\u00e3o por Elementos Finitos de Escoamentos Imisc\u00edveis em Meios Porosos, M\u00e9todos \n\nNum\u00e9ricos para C\u00e1lculo y Dise\u00f1o en Ingenier\u00eda, v. 16, n\u00ba 3, pp. 311-326. \n\nSKOREYKO, F., SAMMON, P. H. and MELICHAR, H., 2003. Use of PEBI Grids for \n\nComplex Advanced Process Simulators, SPE paper 79685 presented at the SPE Reservoir \n\nSimulation Symposium, 3-5 February, Houston, Texas. \n\nSONIER, F. and EYMARD, R., 1993. Mathematical and Numerical Properties of Control-\n\nVolume Finite-Element Scheme for Reservoir Simulation, SPE paper 25267 presented at \n\nthe 12th Symposium on Reservoir Simulation, New Orleans, LA, February 28-March 3. \n\nSONIER, F., LEHUEN, P. and NABIL, R., 1993. Full-Field Gas Storage Simulation Using a \n\nControl-Volume Finite Model, SPE paper 26655 presented at the 68th Annual Technical \n\nConference and Exhibition, Houston, Texas, 3-6 October. \n\n\n\n REFER\u00caNCIAS BIBLIOGR\u00c1FICAS 193 \n\n \n\n \n\nSOUZA, J. A., 2000. Implementa\u00e7\u00e3o de um M\u00e9todo de Volumes Finitos com Sistema de \n\nCoordenadas Locais para a Solu\u00e7\u00e3o Acoplada das Equa\u00e7\u00f5es de Navier-Stokes, \n\nDisserta\u00e7\u00e3o de Mestrado, Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia Mec\u00e2nica, UFSC, \n\nFlorian\u00f3polis. \n\nSTARS, Version 2002 User\u2019s Guide. Computer Modelling Group Ltd, Calgary, Alberta, \n\nCanada. \n\nSTROUSTRUP, B., 2000. The C++ Programming Language (Special Edition). Addison \n\nWesley. USA. \n\nTAMIN, M., ABOU-KASSEM, J. H. and FAROUQ ALI, S. M., 1999. Recent Developments \n\nin Numerical Simulation Techniques of Thermal Recovery, SPE paper 54096 presented at \n\nthe SPE International Thermal Operations and Heavy Oil Symposium, Bakersfield, \n\nCalifornia, 17-19 March. \n\nTCHELEPI, H. A., JENNY, P., LEE, S. H. and WOLFSTEINER, C., 2005. An Adaptive \n\nMultiphase Multiscale Finite Volume Simulator for Heterogeneous Reservoirs, SPE paper \n\n93395 presented at the Reservoir Simulation Symposium, 31 January-2 February, The \n\nWoodlands, Texas \n\nTHIELE, M. R., 2001. Streamline Simulation, 6th International Forum on Reservoir \n\nSimulation, September 3-7, Schloss Fuschl, Austria. \n\nTHOMAS, G. W. and THURNAU, D. H., 1983. Reservoir Simulation Using Adaptive \n\nImplicit Method, SPE Journal, October, pp. 759-768. \n\nTHOMAS, J. E., 2001. Fundamentos de Engenharia de Petr\u00f3leo, Ed. Interci\u00eancia : Petrobras, \n\nRio de Janeiro. \n\nTODD, M. R., O\u00b4DELL, P. M. and HIRASAKI, G. J., 1972. Methods for Increased Accuracy \n\nin Numerical Reservoir Simulators, SPE Journal, Dec., 515-530. \n\nTORONYI, R. M. and FAROUQ ALI, S. M., 1974. Determining Interblock Transmissibility \n\nin Reservoir Simulators, J. Pet. Technol., v. 26, n. 1, pp. 77-78. \n\nTROTTENBERG U., OOSTERLEE C., SCH\u00dcLLER A., BRANDT A., OSWALD P., and \n\nST\u00dcBEN K., 2001. Multigrid, Academic Press, Inc., Orlando, FL. \n\n\n\n194 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nVAN DOORMAAL, J. P., TURAN, A. and RAITHBY, G. D., 1987. Evaluation of New \n\nTechniques for the Calculation of Internal Recirculating Flows,  in proceedings of the \n\nAIAA 25th Aerospace Sciences Meeting, January 12-15, Reno, Nevada. \n\nVERMA, S. and AZIZ, K., 1997. A Control Volume Scheme for Flexible Grids in Reservoir \n\nSimulation, paper SPE 37999 presented at the Reservoir Symposium, Dallas, Texas, 8-11 \n\nJune. \n\nVINSOME, P. K. and AU, A. D. K., 1979. One Approach to the Grid Orientation Problem in \n\nReservoir Simulation, SPE paper 8247 presented at the 54th Annual Fall Technical \n\nConference and Exhibition, September 23-26, Las Vegas, Nevada. \n\nVON ROSENBERG, 1982. Local Mesh Refinement for Finite Difference Methods, paper  \n\nSPE 10974 presented at the Annual Technical Conference and Exhibition, 26-29 \n\nSeptember, New Orleans, Louisiana. \n\nWADSLEY, W. A., 1980. Modelling Reservoir Geometry with Non-Rectangular Coordinate \n\nGrids, SPE paper 9369 presented at the Annual Technical Conference and Exhibition, 21-\n\n24 September, Dallas, Texas. \n\nWANG, K., OGBE, D. O, LAWAL, A. S. and MORTON, D. J., 1995. Multigrid Approach \n\nfor Petroleum Reservoir Simulation on the Cray T3D, in Proceedings of Cray User Group \n\nConference, Fairbanks, Alaska, September. \n\nWOLCOTT, D. S., KAZEMI, H. and DEAN, R. H., 1996. A Practical Method for \n\nMinimizing the Grid Orientation Effect in Reservoir Simulation, SPE paper 36723 \n\npresented at the SPE Annual Technical Conference and Exhibition, Denver, Colorado, \n\nUSA, 6-9 October. \n\nYANOSIK, J. L. and McCRACKEN, T. A., 1979. A Nine-Point Finite-Difference Reservoir \n\nSimulator for Realistic Prediction of Adverse Mobility Ratio Displacements, SPE Journal, \n\nAug., 253-262; Trans., AIME, 267. \n\nYOSHIAKI, I., 1982. Evaluation of Interblock Mobility Using a Modified Midpoint \n\nWeighting Scheme, SPE paper 10498 presented at the 6th SPE Symposium on Reservoir \n\nSimulation, New Orleans, LA, January 31-February 3. \n\n\n\n REFER\u00caNCIAS BIBLIOGR\u00c1FICAS 195 \n\n \n\n \n\nYOUNG, L. C. and RUSSELL, T. F., 1993. Implementation of an Adaptive Implicit Method, \n\nSPE paper 25245 presented at the SPE Symposium on Reservoir Simulation, 28 February-\n\n3 March, New Orleans, Louisiana. \n\nYOUNG, L. C., 1999. Rigorous Treatment of Distorted Grids in 3D, SPE paper 51899 \n\npresented at the SPE Reservoir Simulation Symposium, Houston, Texas, 14-17 February. \n\nZHAO, X., RICHARDS, P. G. and ZHANG, S. J., 2004. A Parallel Algorithm for Algebraic \n\nMultiGrid, Proceedings of the 42nd annual Southeast regional conference, pp. 285-290, \n\nHuntsville, Alabama. \n\nZIENKIEWICZ, O. C. and TAYLOR R. L., 1989. The Finite Element Method. Vol. I. Basic \n\nFormulations and Linear Problems. London: McGraw-Hill. \n\n\n\n \n\n\n\n197 \n\nAnexo    \n\n1 \nPPRROOPPOOSSTTAA  DDEE  UUMM  EESSQQUUEEMMAA    \nAALLTTEERRNNAATTIIVVOO  DDEE  RREEFFIINNAAMMEENNTTOO  LLOOCCAALL    \nPPAARRAA  OO  EEbbFFVVMM  \n  \n\n \n\n \n\n \n\n  Embora o refino localizado seja um procedimento natural e direto no EbFVM, s\u00e3o \n\napresentadas neste cap\u00edtulo as premissas de uma t\u00e9cnica que emprega elementos com 5 a 8 \n\nn\u00f3s que podem ser utilizados com vantagem em opera\u00e7\u00f5es de refino localizado e \n\nrepresenta\u00e7\u00e3o de reservat\u00f3rios complexos no m\u00e9todo EbFVM. A Fig. A1.1a apresenta uma \n\nmalha composta por tais elementos e seus volumes de controle resultantes. Embora seja \n\nposs\u00edvel encontrar na literatura trabalhos que tenham utilizado elementos quadrangulares com \n\nnove n\u00f3s no EbFVM (RAW et al., 1985), a proposta de empregar elementos com n\u00fameros \n\ndiferentes de n\u00f3s em uma mesma malha parece ser promissora. \n\n  Nota-se que nesta proposta, embora a malha de uma forma geral seja considerada n\u00e3o-\n\nestruturada, os elementos refinados devem ser localmente estruturados uma vez que necessita-\n\nse sempre dividir uniformemente elementos quadril\u00e1teros em quatro elementos distintos, em \n\nraz\u00e3o das fun\u00e7\u00f5es de forma utilizadas. Por isso, este m\u00e9todo de refino \u00e9 aplic\u00e1vel apenas se a \n\nraz\u00e3o de refinamento for 1:2 em cada dire\u00e7\u00e3o, isto \u00e9, em cada face do elemento deve-se ter \n\napenas um ou dois elementos vizinhos. Essa caracter\u00edstica tamb\u00e9m \u00e9 encontrada em outros \n\ntrabalhos (ZEEUW, 1993; HEINEMANN e BRAND, 1989). \n\n  Quanto \u00e0 constru\u00e7\u00e3o dos volumes de controle resultantes, prop\u00f5e-se utilizar a mesma \n\nregra empregada em elementos de tr\u00eas e quarto n\u00f3s, isto \u00e9, os volumes s\u00e3o criados unindo-se \n\no centro dos elementos as medianas de suas faces. Neste caso, todos os fluxos em um ponto \n\nde integra\u00e7\u00e3o espec\u00edfico podem ser calculados utilizando os dados do elemento onde o ponto \n\nde integra\u00e7\u00e3o est\u00e1 contido. \n\n  Na Fig. A1.1b \u00e9 demonstrado que esta mesma t\u00e9cnica apresentada para refino local \n\ntamb\u00e9m pode ser utilizada com muitas vantagens na representa\u00e7\u00e3o de reservat\u00f3rios com \n\nfalhas. Neste caso \u00e9 apresentado um reservat\u00f3rio com uma falha vertical discretizado \n\nutilizando elementos formados com 5 n\u00f3s. \n\n\n\n198 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n \n\n \n(a) \n\n \n\n \n\n \n \n\n(b) \nFig. A1.1 - Malha composta por elementos com n\u00famero vari\u00e1vel de n\u00f3s (esquerda), e seus volumes resultantes \n\n(direita) em (a) um caso geral e (b) um casos de falha vertical. \n\n \n\n \n\n  \n\n  O processo de obten\u00e7\u00e3o das equa\u00e7\u00f5es discretizadas utilizando esses elementos \u00e9 \n\nid\u00eantico ao discutido no Cap. 4, com exce\u00e7\u00e3o das fun\u00e7\u00f5es de forma utilizadas que se alteram \n\nem fun\u00e7\u00e3o da quantidade de n\u00f3s de cada elemento. Na seq\u00fc\u00eancia \u00e9 apresentado um \n\nprocedimento geral baseado no elemento-padr\u00e3o da Fig. A1.2 de 8 n\u00f3s. A id\u00e9ia principal \u00e9 \n\nque quaisquer n\u00f3s deste elemento podem ser retirados ou adicionados para formar elementos \n\nde no m\u00ednimo 4 e no m\u00e1ximo 8 n\u00f3s.  \n\n\n\n ANEXO 1 \u2013 ESQUEMA DE REFINAMENTO LOCAL 199 \n\n \n\n \n\n \n \n\nFig. A1.2 - Elemento de 8 n\u00f3s \n\n \n\n \n\n  As fun\u00e7\u00f5es de forma para elementos com 4 n\u00f3s (N1 to N4) passam a ser constru\u00eddas \n\nvisando a possibilidade de existirem n\u00f3s nos pontos m\u00e9dios de cada face (n\u00f3s 5 a 8 na Fig. \n\nA1.2) como \n\n \n\n ( )5811 2\n1\n\nNNNN * +?=  (A1.1) \n\n ( )6522 2\n1\n\nNNNN * +?=  (A1.2) \n\n ( )7633 2\n1\n\nNNNN * +?=  (A1.3)  \n\n ( )8744 2\n1\n\nNNNN * +?=  (A1.4)  \n\n \n\nonde *aN  s\u00e3o as fun\u00e7\u00f5es de forma tradicionais bi-lineares para elementos quadril\u00e1teros dadas \n\npor \n\n \n\n ( )( )???? aa 114\n1\n\n++=*aN ,              a = 1, 2, 3, 4 (A1.5)  \n\n \n\ne as fun\u00e7\u00f5es de forma para os n\u00f3s dos pontos m\u00e9dios de cada face ser\u00e3o dados por (HUGHES, \n\n1987), \n\n \n\n\n\n200 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n ( )( )??? a2 112\n1\n\n+?=aN                  a = 5 e 7 (A1.6) \n\n ( )( )2b 112\n1\n\n??? ?+=bN                  b = 6 e 8 (A1.7) \n\n \n\n  Nota-se que se qualquer um dos n\u00f3s  5, 6, 7 e 8 estiver ausente, define-se formalmente \n\nN5, N6, N7 e N8 como zero, respectivamente.  \n\n  O procedimento de calcular as fun\u00e7\u00f5es de forma para contemplar esta nova t\u00e9cnica de \n\nrefino localizado no EbFVM pode ser resumido como: \n\n \n\n1. Determinar as fun\u00e7\u00f5es de forma (Ni*) para os n\u00f3s 1, 2, 3 e 4 pela Eq. (A1.5). Este \n\npasso \u00e9 feito para todos os elementos quadril\u00e1teros do dom\u00ednio. \n\n2. Determinar as fun\u00e7\u00f5es de forma (Na  e Nb) para os n\u00f3s 5, 6, 7 e 8 pela Eqs. (A1.6) e \n\n(A1.7) nos elementos definidos com n\u00fameros de n\u00f3s superior a 4. \n\n3. Determinar as novas fun\u00e7\u00f5es de forma (Ni) para os n\u00f3s 1, 2, 3 e 4 pelas Eqs. (A1.1) a \n\n(A1.4) nos elementos definidos com n\u00fameros de n\u00f3s superior a 4. \n\n \n\n \n\n   \n\nA1.1. Bibliografia \n \nHEINEMANN, Z. E. and BRAND, C. W., 1989. Gridding Techniques in Reservoir \n\nSimulation. 1st/2nd Stanford Univ. &amp; Leoben Mining Univ. Reservoir Simulation Inf. \n\nForum (Alpbach, Austria, Sept/1998-Sept/1989). \n\nHUGHES, T. J. R., 1987. The Finite Element Method, Linear Static and Dynamic Finite \n\nElement Analysis, Prentice Hall, New Jersey. \n\nRAW, M. J., SCHNEIDER, G. E. and HASSANI, V., 1985. A Nine-Noded Quadratic \n\nControl-Volume-Based Finite Element for Heat Conduction, J. Spacecraft, Vol. 22, N. 5, \n\nsept-oct, pp. 523-529. \n\nZEEUW, D. L., 1993. A Quadtree-Based Adaptively-Refined Cartesian-Grid Algorithm for \n\nSolution of the Euler Equations, Ph.D. Thesis, University of Michigan, United States. \n\n \n\n\n\n201 \n\nAnexo    \n\n2 \nPPRROOCCEEDDIIMMEENNTTOO  DDEE    \nLLIINNEEAARRIIZZAA\u00c7\u00c7\u00c3\u00c3OO  DDOO  TTEERRMMOO  SSmm//BBmm    \nDDAA  EEQQUUAA\u00c7\u00c7\u00c3\u00c3OO  DDEE  SSAATTUURRAA\u00c7\u00c7\u00c3\u00c3OO  DDOO  MM\u00c9\u00c9TTOODDOO  IIMMPPEESS  \n\n \n\n \n\n \n\n Na equa\u00e7\u00e3o da satura\u00e7\u00e3o existe uma n\u00e3o-linearidade entre a satura\u00e7\u00e3o e o fator volume \n\nde forma\u00e7\u00e3o no termo transiente. Para que o m\u00e9todo IMPES resolva tamb\u00e9m problemas \n\ncompress\u00edveis, este termo deve ser linearizado. Este procedimento \u00e9 descrito neste anexo. \n\nDeve-se lembrar que o fator volume de forma\u00e7\u00e3o \u00e9 determinado atrav\u00e9s de \n\n \n\n?\n?\n?\n\n?\n\n?\n?\n?\n\n?\n?\n?\n??\n\n?\n? ??= refm\n\nref\nmm ppc1BB  (A2.1) \n\n \n\nonde mc  \u00e9 a compressibilidade da fase m definida por \n\n \n\nT\n\nm\n\nm\nm p\n\n1\nc\n\n?\n?\n\n=\n?\n\n?\n (A2.2) \n\n \n\nou, em fun\u00e7\u00e3o do fator volume de forma\u00e7\u00e3o (DAKE, 2001), \n\n \n\npp\nBB\n\nB\n1\n\nc\nref\n\nref\nmm\n\nref\nm\n\nm ?\n?\n\n=  (A2.3) \n\n \n\nValores t\u00edpicos de compressibilidade variam entre 0 a 10-3 kPa-1, enquanto que o fator \n\nvolume de forma\u00e7\u00e3o varia de 0.5 a 1.5. \n\n Prop\u00f5e-se uma lineariza\u00e7\u00e3o atrav\u00e9s do truncamento dos termos de maior ordem da \n\ns\u00e9rie de Taylor escrita para fun\u00e7\u00f5es de duas vari\u00e1veis (SPIEGEL, 1992), \n\n \n\n\n\n202 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n( ) ( ) ( ) ( ) .....,,),(),( +?+?+= bafbybafaxbafyxf yx  (A2.4) \n \n\nonde, para o problema em quest\u00e3o, mm Bsf = , de forma que a Eq. (A2.4) pode ser escrita \n\ncomo \n\n \n\n( ) ( )\nm\n\no\n\nm\n\nmm\nm\n\no\n\nm\n\nmm\no\nm\n\no\nm\n\nm\n\nm B\nB\n\nBs\ns\n\ns\nBs\n\nB\ns\n\nB\ns\n\n?\n?\n\n?\n+?\n\n?\n?\n\n+=  (A2.5) \n\n \n\nonde o super-\u00edndice \u201co\u201d indica que o termo \u00e9 avaliado com valores conhecidos do passo de \n\ntempo anterior. Assim, \n\n        \n\n( ) m2om\no\nm\n\nmo\nm\n\no\nm\n\no\nm\n\nm\n\nm B\nB\n\ns\ns\n\nB\n1\n\nB\ns\n\nB\ns\n\n???+=  (A2.6) \n\nou    \n\n \n\n( )\n( )\n\n( )omm2o\nm\n\no\nmo\n\nmmo\nm\n\no\nm\n\no\nm\n\nm\n\nm BB\nB\n\nsss\nB\n1\n\nB\ns\n\nB\ns\n\n???+=  (A2.7) \n\n      \n( )\n\n( )2\no\n\nom m\nm mo o\n\nm m\n\ns s B B\nB B\n\n?= ?  (A2.8) \n\n  \n\nMas reconhecendo que a Eq. (A2.1) pode ser escrita como \n\n \n\n( )refmrefmrefmm ppcBBB ??=  (A2.9) \ne \n\n( )refomrefmrefmom ppcBBB ??=  (A2.10) \n \n\npode-se mostrar que  \n\n \n\n( )ppcBBB omrefmomm ?=?  (A2.11) \n \n\n Substituindo a Eq. (A2.11) em (A2.8), chega-se a \n\n\n\n ANEXO 2 \u2013 PROCEDIMENTO DE LINEARIZA\u00c7\u00c3O 203 \n\n \n\n \n\n( )\n( )omrefm2o\n\nm\n\no\nm\n\no\nm\n\nm\n\nm\n\nm ppcB\nB\n\ns\nB\ns\n\nB\ns ?+=  (A2.12) \n\n \n\nque \u00e9 a express\u00e3o linearizada do termo mm Bs . \n\n \n\n \n\nA2.1. Bibliografia \n \n\nDAKE, L. P., 2001. The Practice of Reservoir Engineering, Revised Edition, Ed. Elsevier \n\nScience B. V., Amsterdam, The Netherlands. \n\nSPIEGEL, M. R., 1992. Manual de F\u00f3rmulas, M\u00e9todos e Tabelas de Matem\u00e1tica, Edi\u00e7\u00e3o \n\nrevista e ampliada, McGraw-Hill, S\u00e3o Paulo. \n\n\n\n \n\n\n\n205 \n\nAnexo    \n\n3 \nCCOONNSSIIDDEERRAA\u00c7\u00c7\u00d5\u00d5EESS  SSOOBBRREE  OOSS    \nRREEGGIIMMEESS  DDEE  OOPPEERRAA\u00c7\u00c7\u00c3\u00c3OO  DDOOSS  PPOO\u00c7\u00c7OOSS  \n\n \n\n \n\n \n\n No programa computacional desenvolvido nesta tese foram implementados tr\u00eas \n\ndiferentes regimes de opera\u00e7\u00e3o dos po\u00e7os: (1) vaz\u00e3o prescrita de \u00e1gua nos po\u00e7os injetores e \n\nvaz\u00e3o total prescrita nos po\u00e7os produtores, (2) press\u00e3o de fundo de po\u00e7o prescrita e (3) \n\npress\u00e3o prescrita no bloco que cont\u00e9m o po\u00e7o. Essas diferentes alternativas s\u00e3o discutidas \n\nnesse cap\u00edtulo, bem como s\u00e3o apresentados para cada caso a forma dos coeficientes para os \n\nm\u00e9todos IMPES e Totalmente Impl\u00edcito. \n\n \n\nCoeficientes do M\u00e9todo IMPES.  Os coeficientes de interesse que est\u00e3o relacionados \n\ncom o regime de opera\u00e7\u00e3o dos po\u00e7os no m\u00e9todo IMPES s\u00e3o os termos fP e gP das Eqs. (5.13) \n\ne (5.14) utilizados na defini\u00e7\u00e3o da 2\u00aa. parcela da equa\u00e7\u00e3o da press\u00e3o do m\u00e9todo IMPES, Eq. \n\n(5.8), definidos de forma geral como  \n\n \n\n( )o ow w o o P p pq B q B g p f+ = ?  (A3.1) \n\n \n\n e o coeficiente ( )Pwq  da equa\u00e7\u00e3o da satura\u00e7\u00e3o, Eq. (5.7). \n \n\n Coeficientes do M\u00e9todo Totalmente Impl\u00edcito. Para este m\u00e9todo os termos \n\nrelacionados com o regime de opera\u00e7\u00e3o dos po\u00e7os est\u00e3o contidos nas express\u00f5es que \n\ndeterminam o res\u00edduo das equa\u00e7\u00f5es de conserva\u00e7\u00e3o das fases, Eq. (5.34), e suas derivadas. \n\n  \n\n \n\n\n\n206 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n \n\nA3.1. Regime de Opera\u00e7\u00e3o de Vaz\u00e3o de \u00c1gua Prescrita nos \nPo\u00e7os Injetores \n\n  \n\nEste \u00e9 o caso mais simples, uma vez que se trata da prescri\u00e7\u00e3o direta da vaz\u00e3o de \n\ninje\u00e7\u00e3o de \u00e1gua em [L3.T-1], \nPrw\n\nq , que \u00e9 o pr\u00f3prio termo que aparece na equa\u00e7\u00e3o de \n\nconserva\u00e7\u00e3o da \u00e1gua.  \n\n  \n\n IMPES:  Os termos da equa\u00e7\u00e3o da press\u00e3o destacados na Eq. (A3.1) ser\u00e3o escritos \n\npara esse regime  como \n\n \n\n( )\nPr\n\n( )o o ow w o o P w w Pq B q B q B+ =  (A3.2)  \n\n \n\nonde os coeficientes  fP e gP assumem os seguintes valores \n\n \n\n( )\nPr\n\n0\n\no\nP w w P\n\nP\n\nf q B\n\ng\n\n= ?\n\n=\n (A3.3) \n\n                   \n\nenquanto que o termo de fluxo da equa\u00e7\u00e3o da satura\u00e7\u00e3o ser\u00e1 dado por \n\n \n\n( )\nPrw wP\n\nq q=  (A3.4) \n\n \n\n Totalmente Impl\u00edcito. Os res\u00edduos das equa\u00e7\u00f5es de conserva\u00e7\u00e3o das fases associados \n\nao termo de po\u00e7o quando a vaz\u00e3o de inje\u00e7\u00e3o de \u00e1gua \u00e9 prescrita s\u00e3o simplesmente escritos \n\ncomo \n \n\n( )\nPr\n\nPr\n\nw wpo\u00e7os\n\nT w wpo\u00e7os P\n\nR q\n\nR q B\n\n=\n\n=\n (A3.5) \n\n \n\ne suas derivadas em rela\u00e7\u00e3o as vari\u00e1veis dependentes s\u00e3o nulas. \n\n\n\n ANEXO 3 -  REGIMES DE OPERA\u00c7\u00c3O DOS PO\u00c7OS 207 \n\n \n \n \n\n \n\nA3.2. Regime de Opera\u00e7\u00e3o de Vaz\u00e3o Total nos Po\u00e7os \nProdutores \n\n \n\nNeste caso a vaz\u00e3o total produzida, \nPrT\n\nq ,  em [L3.T-1], \u00e9 prescrita no po\u00e7o produtor. Ela \n\ncorresponde a soma das vaz\u00f5es de \u00e1gua e \u00f3leo neste po\u00e7o. Cuidado deve ser tomado com a \n\nprescri\u00e7\u00e3o deste regime quando s\u00e3o utilizados fluidos compress\u00edveis, pois em um caso destes, \n\ndependendo da condi\u00e7\u00e3o de contorno nos po\u00e7os injetores, poder\u00e1 estar sendo seja violada a \n\nconserva\u00e7\u00e3o da massa global. \n\n \n\nIMPES:  Os termos da equa\u00e7\u00e3o da press\u00e3o destacados na Eq. (A3.1) ser\u00e3o escritos \n\npara esse regime como \n\n \n\nPr\n( )o ow w o o P Tq B q B q+ = ?  (A3.6) \n\n \n\ne, assim, os coeficientes de interesse s\u00e3o dados por \n\n \n\nPr\n\n0\nP T\n\nP\n\nf q\n\ng\n\n=\n\n=\n (A3.7)   \n\n \n\nComo n\u00e3o foi prescrito fluxo de \u00e1gua neste po\u00e7o e n\u00e3o \u00e9 utilizado nenhum modelo de \n\npo\u00e7o que relacione a press\u00e3o do bloco com alguma press\u00e3o de refer\u00eancia, deve-se buscar \n\nalguma alternativa para encontrar a parcela do fluxo total que corresponde ao fluxo de \u00e1gua. \n\nDeve-se lembrar que \u00e9 importante esta determina\u00e7\u00e3o porque esse valor ser\u00e1 utilizado na \n\nresolu\u00e7\u00e3o da equa\u00e7\u00e3o da satura\u00e7\u00e3o, \n\n \n\n( )\n( )\n\n( ) ( )1\noref o\n\nm mo m\nm m mm oP P ii Pm PP\n\np pB c Bs q k ps S t\nB V\n\n?\n?? ?\n\n? ?? ? ?? ?? ?? ?= ? + + ? ?? ?? ? ?? ? ? ?? ?? ?\n?  (A3.8) \n\n \n\nque n\u00e3o est\u00e1 sendo prescrito. Sabe-se que da defini\u00e7\u00e3o do fluxo das fases, \n\n\n\n208 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n \n\now\n\nw\n\now\n\nw\n\nqq\nq\n\n??\n?\n+\n\n=\n+\n\n (A3.9) \n\n  \n\nComo \nPr\n\nT w oq q q= + , pode-se utilizar a equa\u00e7\u00e3o anterior para determinar a vaz\u00e3o de \n\n\u00e1gua neste po\u00e7o, \n\n \n\n( )\nPr\n\no\n\nw\nm TP\n\nw o P\n\nq q\n?\n\n? ?\n? ?\n\n= ? ?+? ?\n (A3.10) \n\n \n\nTotalmente Impl\u00edcito. O res\u00edduo da equa\u00e7\u00e3o de conserva\u00e7\u00e3o da fase m associado ao \n\ntermo de po\u00e7o quando a vaz\u00e3o total produzida no po\u00e7o produtor \u00e9 prescrita pode ser calculado \n\ncomo o deduzido no m\u00e9todo IMPES, \n\n \n\nPr\n\nm\nm Tpo\u00e7os\n\nw o P\n\nR q\n?\n\n? ?\n? ?\n\n= ? ? ?+? ?\n (A3.11) \n\n \n\ne suas derivadas em rela\u00e7\u00e3o as vari\u00e1veis dependentes (X = p, sw) s\u00e3o dadas por \n\n \n\nPr\n\nm m\nT\n\npo\u00e7os w o P\n\nR\nq\n\nX X\n?\n\n? ?\n? ?? ?? ?\n\n= ? ? ?? ?? ? +? ?? ?\n (A3.12) \n\n \n\n O termo entre par\u00eantesis na Eq. (A3.12) \u00e9 denominado de fluxo fracion\u00e1rio da fase m, \n\ne sua derivada em rela\u00e7\u00e3o a uma vari\u00e1vel gen\u00e9rica X \u00e9 dada por \n\n \n\n( )2\n1w o w\n\nw o\nw o w o\n\nX X X\n? ? ?\n\n? ?\n? ? ? ?\n\n? ? ? ?? ? ?= ?? ? ? ?? + ? ?? ? +? ?\n (A3.13) \n\n \n\npara a fase \u00e1gua e \n\n \n\n\n\n ANEXO 3 -  REGIMES DE OPERA\u00c7\u00c3O DOS PO\u00c7OS 209 \n\n \n \n \n\n \n\no w\n\nw o w oX X\n? ?\n\n? ? ? ?\n? ? ? ?? ?\n\n= ?? ? ? ?? + ? +? ? ? ?\n (A3.14) \n\n \n\npara a fase \u00f3leo. As derivadas da mobilidade de cada fase em rela\u00e7\u00e3o as vari\u00e1veis dependentes \n\npodem ser calculadas a partir da Eq. (5.54). \n\n \n\n \n\nA3.3. Regime de Opera\u00e7\u00e3o de Press\u00e3o de Fundo de Po\u00e7o \nPrescrita nos Po\u00e7os Produtores \n\n  \n\nEm situa\u00e7\u00f5es onde \u00e9 poss\u00edvel prescrever a press\u00e3o de fundo de po\u00e7o, a vaz\u00e3o de uma \n\nfase e a press\u00e3o do bloco ser\u00e3o relacionados a partir do seguinte modelo de po\u00e7o, \n\n \n\n( )fpm m p pq WI?= ?                     em     [L\n3.T-1]  (A3.15) \n\n \n\nonde fpp  \u00e9 a press\u00e3o de fundo de po\u00e7o, e WI \u00e9 o \u00edndice de po\u00e7o (Well Index) que cont\u00e9m \n\ninforma\u00e7\u00f5es geom\u00e9tricas e f\u00edsicas do po\u00e7o e do bloco que o cont\u00e9m, dado por \n\n  \n\n( )weq rr\nbk2\n\nWI\n/ln\n\n?\n=                            em     [L3] (A3.16) \n\n \n\nonde b \u00e9 a espessura da camada do reservat\u00f3rio, k \u00e9 a permeabilidade absoluta do bloco, req \u00e9 \n\num raio m\u00e9dio equivalente do bloco e rw \u00e9 o raio do po\u00e7o. \n\n As Eqs. (A3.15) e (A3.16) que definem este modelo de po\u00e7o adv\u00e9m da inspe\u00e7\u00e3o de \n\nque o escoamento \u00e9 aproximadamente radial na regi\u00e3o pr\u00f3xima ao po\u00e7o, e logo, a velocidade \n\npode ser calculada neste regi\u00e3o como \n\n \n\nm m\ndp\n\nu\ndr\n\n?= ?  (A3.17) \n\nou  \n\n\n\n210 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n \n\n2\nm\n\nm\nq dp\n\nrb dr\n?\n\n?\n= ?  (A3.18) \n\n \n\nonde 2 rb?  \u00e9 a \u00e1rea de passagem do fluxo. Rearranjando e integrando a equa\u00e7\u00e3o anterior, \n\n \n\n2\neq\n\nw fp\n\nr p\nm\n\nm\nr p\n\nq dr\nkb dp\n\nr\n? ?= ?? ?  (A3.19) \n\n \n\nchega-se a \n\n \n\nln( ) ln( ) 2 ( )m eq w m fpq r r kb p p? ?? ?? = ? ?? ?  (A3.20) \n\n \n\nou \n\n \n\n( )\n2 ( )\n\n( )\nln /\n\nm fp\nfpm m\n\neq w\n\nkb p p\np pq WI\n\nr r\n? ?\n\n?\n?\n\n= ? = ?  (A3.21) \n\n \n\nIMPES. Neste caso, o termo ( )o ow w o o Pq B q B+  da equa\u00e7\u00e3o da press\u00e3o ser\u00e1 dado por \n\n  \n\n( ) ( ) ( )o o o ofp fpw w o o P w w o op p p pq B q B WI B WI B? ?? ?+ = ? + ?? ?  (A3.22) \n\n  \n\n Como estamos expressando ( )o ow w o o P p pq B q B g p f+ = ? , para este regime de \n\nopera\u00e7\u00e3o, portanto, os coeficientes das equa\u00e7\u00f5es ser\u00e3o dados por \n\n \n\n. ( )\n\n( )\n\no o\nP fp w w o o\n\no o\nP w w o o\n\npf WI B B\n\ng WI B B\n\n? ?\n\n? ?\n\n= ? +\n\n= ? +\n  (A3.23) \n\n \n\ne na equa\u00e7\u00e3o da satura\u00e7\u00e3o o termo de fluxo ser\u00e1 dado por \n\n\n\n ANEXO 3 -  REGIMES DE OPERA\u00c7\u00c3O DOS PO\u00c7OS 211 \n\n \n \n \n\n \n\n( ) . ( )w w fpP Pq p pWI ?? ?= ? ?? ?  (A3.24) \n\n \n\nTotalmente Impl\u00edcito. O res\u00edduo associado ao termo de po\u00e7o das equa\u00e7\u00f5es de \n\nconserva\u00e7\u00e3o ter\u00e1 a forma \n\n \n\n( ) ( )m m fpPpo\u00e7os PR WI p p?= ? ?  (A3.25) \n\n \n\ne suas derivadas em rela\u00e7\u00e3o as vari\u00e1veis dependentes s\u00e3o dadas por \n\n \n\n( )m mm fp\npo\u00e7os P\n\nR\nWI p p\n\np p\n?\n\n?\n? ?? ?\n\n= ? + ?? ?? ?? ?\n (A3.26) \n\ne \n\n( )m m fp\nw wpo\u00e7os P\n\nR\nWI p p\n\ns s\n?? ?? ?\n\n= ? ?? ?? ?? ?\n  (A3.27) \n\n \n\n \n\nA3.4. Regime de Opera\u00e7\u00e3o de Press\u00e3o Prescrita no Bloco \nque Cont\u00e9m o Po\u00e7o Produtor \n\n \n\nNeste caso prescreve-se diretamente o valor da press\u00e3o no bloco que cont\u00e9m o po\u00e7o \n\nprodutor, devendo-se encontrar uma forma alternativa de calcular o fluxo da fase que \u00e9 \n\nutilizado na equa\u00e7\u00e3o de conserva\u00e7\u00e3o, que agora n\u00e3o \u00e9 mais prescrito.  \n\n \n\nIMPES. Neste m\u00e9todo n\u00e3o \u00e9 necess\u00e1rio resolver a equa\u00e7\u00e3o da press\u00e3o pois \u00e9 \n\nconhecido o valor de press\u00e3o do bloco que cont\u00e9m o po\u00e7o. Ent\u00e3o, diferentemente dos casos \n\nanteriores, agora al\u00e9m de utilizar os seguintes coeficientes \n\n \n\nPr\n\n0\nP\n\nP\n\npf\ng\n\n=\n=\n\n (A3.28) \n\n\n\n212 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n \n\ntorna-se necess\u00e1rio tamb\u00e9m substituir o coeficiente A(P,P) da matriz de coeficientes que \n\nassumir\u00e1 o valor 1, zerando os demais termos da linha de P. Este procedimento prescreve o \n\nvalor desejado da press\u00e3o no bloco. No entanto, as experi\u00eancias num\u00e9ricas t\u00eam mostrado que \n\npara a maioria dos casos a matriz de coeficientes \u00e9 formada por n\u00fameros com ordem de \n\ngrandeza muito menor que 1, o que pode, dependendo do solver utilizado, causar dificuldades \n\nna resolu\u00e7\u00e3o do sistema linear pela diferen\u00e7a de ordem de magnitude dos coeficientes. Por \n\nisso, uma forma alternativa que mant\u00e9m coeficientes da mesma ordem na matriz \u00e9 utilizar, ao \n\ninv\u00e9s da Eq. (A3.28), a seguinte equa\u00e7\u00e3o \n\n \n\n( ) Pr,P pf A P P=  (A3.29) \n\n \n\nmantendo inalterado o coeficiente A(P,P), e zerando, como antes, os demais termos da linha \n\nde P. \n\nEmbora n\u00e3o se tenha que resolver a equa\u00e7\u00e3o da press\u00e3o do bloco para este regime de \n\npo\u00e7o, a equa\u00e7\u00e3o da satura\u00e7\u00e3o necessita ainda ser resolvida. E neste caso tem-se a mesma \n\ndificuldade encontrada na se\u00e7\u00e3o A1.2 e que diz respeito \u00e0 necessidade de definir qual \u00e9 o \n\nvalor do fluxo de \u00e1gua utilizada na equa\u00e7\u00e3o da satura\u00e7\u00e3o. Uma forma de determin\u00e1-lo \u00e9 \n\nutilizar como ponto de partida a equa\u00e7\u00e3o da press\u00e3o escrita para o volume que cont\u00e9m o po\u00e7o \n\n(a que n\u00e3o foi utilizada devido a prescri\u00e7\u00e3o da press\u00e3o), isolando o termo de fluxos dos po\u00e7os, \n\n \n\ni w w o o\ni P\n\nm q B q B\n? ?\n\n= +?  (A3.30)  \n\n   ( ) ( )( )\nP P\n\noo ref o ref\no o o o w w w o o o\n\nw w o o i o oi i\ni P w o P P\n\nV p ps B c s B c\nB B k p S\n\nB B t\n?\n\n? ?\n? ?\n\n? ?? ?? ?\n? ?= ? + ? ?? ? +? ? ? ??? ? ? ?\n\n?  \n\n \n\nonde i\ni P\n\nm\n? ?\n?  \u00e9 o somat\u00f3rio dos fluxos de massa nas fronteiras do volume de controle que \n\ncont\u00e9m o po\u00e7o. Este somat\u00f3rio s\u00f3 n\u00e3o ser\u00e1 nulo nos blocos que contenham po\u00e7os, e pode ser \n\nfacilmente calculado ser for utilizada a seguinte express\u00e3o \n\n \n\n[ ]{ } { }'i p\ni P\n\nm A p e\n? ?\n\n? ?\n= +? ?\n\n? ?\n?  (A3.31) \n\n\n\n ANEXO 3 -  REGIMES DE OPERA\u00c7\u00c3O DOS PO\u00c7OS 213 \n\n \n \n \n\n \n\nonde [ ]'A  \u00e9 a pr\u00f3pria matriz global de coeficientes da equa\u00e7\u00e3o da press\u00e3o apresentada no Cap. \n5, sem os termos de po\u00e7os e sem zerar a linha correspondente ao bloco que cont\u00e9m o po\u00e7o,  \n\n{ }pe  \u00e9 o vetor com os termos de compressibilidade definido na Eq. (5.17), e { }p , por sua \nvez, \u00e9 o vetor que cont\u00e9m os valores mais recentes de press\u00e3o, incluindo o valor prescrito no \n\nbloco. \n\nAssim, isolando oq  da Eq. (A3.30) e substituindo a express\u00e3o resultante na Eq. (A3.9), \n\nobt\u00e9m-se uma equa\u00e7\u00e3o escrita em fun\u00e7\u00e3o da vaz\u00e3o de \u00e1gua, \n\n \n\no\nw w\n\no o\ni w o\n\nw i P\nw w\n\no o\n\nq\nm\n\nB\nq q\n\nB B\n\n?\n? ?\n\n? ?\n\n=\n+\n\n? +\n?\n\n (A3.32) \n\n \n\ne colecionando-se os termos semelhantes, na forma \n\n \n\n( ) 1\ni\n\no o o w i P\nw w o w w\n\no o\n\nm\nB\n\nq q\nB B\n\n? ? ? ? ?\n? ?\n\n? ?? ?+ = ? +? ?? ?? ?? ?? ?\n\n?\n (A3.33) \n\ne  \n\n \n\n1\no\n\no o o w w\nw w o w i\n\ni Po o\n\nB\nq m\n\nB B\n?\n\n? ? ?\n? ?\n\n? ?? ?\n+ ? ? =? ?? ?\n\n? ?? ?\n?  (A3.34) \n\n \n\nchega-se a equa\u00e7\u00e3o que determina o fluxo utilizado da equa\u00e7\u00e3o da satura\u00e7\u00e3o quando a press\u00e3o \n\ndo po\u00e7o \u00e9 prescrita no bloco, dada por \n\n \n\n( )\no\nw\n\nw io oP\ni Po o w w P\n\nq m\nB B\n\n?\n? ? ? ?\n\n? ?\n= ?? ?+? ?\n\n?  (A3.35) \n\n \n\n \n\n\n\n214 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n \n\nTotalmente Impl\u00edcito. Neste tipo de regime de po\u00e7o necessita-se prescrever o fluxo da \n\nfase em cada uma das equa\u00e7\u00f5es de conserva\u00e7\u00e3o da mesma forma como foi no IMPES. \n\nUtilizando o mesmo racioc\u00ednio utilizado naquele m\u00e9todo, pode-se mostrar que o termo de \n\nres\u00edduo dos po\u00e7os para a equa\u00e7\u00e3o da conserva\u00e7\u00e3o da \u00e1gua \u00e9 dado por \n\n \n\nw\nw ipo\u00e7os\n\ni Po o w w P\n\nR m\nB B\n\n?\n? ? ? ?\n\n? ?\n= ?? ?+? ?\n\n?  (A3.36) \n\n \n\nN\u00e3o \u00e9 necess\u00e1rio calcular o termo equivalente para a equa\u00e7\u00e3o de conserva\u00e7\u00e3o do \u00f3leo \n\nporque a equa\u00e7\u00e3o de conserva\u00e7\u00e3o total (aquela que fornecer\u00e1 o valor de p?  para este bloco) \n\nn\u00e3o ser\u00e1 utilizada. Na verdade, como o valor da press\u00e3o j\u00e1 \u00e9 conhecido e n\u00e3o se altera com o \n\ntempo, o valor de p?  para este bloco calculado pelo sistema linear da Eq. 5.27 dever\u00e1 ser \n\nzero, n\u00e3o modificando o valor da press\u00e3o do bloco que cont\u00e9m o po\u00e7o, como o desejado. Para \n\ntanto, deve-se anular na matriz jacobiana todos os coeficientes da linha referente a equa\u00e7\u00e3o \n\ndas derivadas da equa\u00e7\u00e3o da conserva\u00e7\u00e3o do \u00f3leo deste bloco, a menos do termo da diagonal \n\nprincipal. Deve-se zerar tamb\u00e9m a posi\u00e7\u00e3o correspondente do vetor de termos independentes.  \n\nQuanto a linha que cont\u00e9m os coeficientes da equa\u00e7\u00e3o de conserva\u00e7\u00e3o da \u00e1gua, a \n\nderivada do res\u00edduo do termo de po\u00e7os ser\u00e1 calculado a partir de  \n  \n\nw w\ni\n\ni Ppo\u00e7os o o w w P\n\nR\nm\n\nX X B B\n?\n\n? ? ? ?\n? ?? ?\n\n= ? ? ?? ? +? ?\n?  (A3.37) \n\n \n\nonde X = p, sw e  \n\n    \n\n( )2\n1\n\n                                   \n\nw w o\no o w\n\no o w w\n\no w\nw o w\n\no o w w\n\nB\nX B B X X\n\nB B\nX X B B\n\n? ? ?\n? ?\n\n? ?\n\n? ? ?\n? ?\n\n? ? ? ? ?? ? ?= ? +? ? ? ??? + ? ?? ??? ?\n? ? ?? ?? +? ??? ?? ? +?\n\n (A3.38) \n\n \n\nUm resumo com todos os regimes de opera\u00e7\u00e3o de po\u00e7os utilizados neste trabalho \u00e9 \n\napresentado na Tab. A3.1 para o IMPES e nas Tabs. A3.2 e A3.3 para o m\u00e9todo Totalmente \n\nImpl\u00edcito. \n\n\n\n ANEXO 3 -  REGIMES DE OPERA\u00c7\u00c3O DOS PO\u00c7OS 215 \n\n \n \n \n\n \n\nPar\u00e2metro associado ao termo fonte (soma-se ao vetor de termos independentes) \n\nPo\u00e7o \nInjetor \n\nRegime de Opera\u00e7\u00e3o 1 \n(Vaz\u00e3o de \u00e1gua prescrita) \n\nPrP w w\nf q B= ?  \n\nRegime de Opera\u00e7\u00e3o 1 \n(Vaz\u00e3o total prescrita:  \u00e1gua + \u00f3leo) \n\nPrTP\nqf =  \n\nRegime de Opera\u00e7\u00e3o 2 \n(Press\u00e3o de fundo de po\u00e7o prescrita) \n\n. ( )P fp w w o opf WI B B? ?= ? +   \nPf  1 x 1 \n\nPo\u00e7o \nProdutor \n\nRegime de Opera\u00e7\u00e3o 3 \n(Press\u00e3o prescrita no bloco que \n\ncont\u00e9m o po\u00e7o) \n\nPr\npf P =  \n\n \n\nPar\u00e2metro que se somar\u00e1 ao valor da diagonal principal de [A] correspondente ao bloco do po\u00e7o \n\nPo\u00e7o \nInjetor Regime de Opera\u00e7\u00e3o 1 0=Pg  \n\nRegime de Opera\u00e7\u00e3o 1 0=Pg  \n\nRegime de Opera\u00e7\u00e3o 2 ( )P w w o og WI B B? ?= ? +   \nPg  1 x 1 \n\nPo\u00e7o \nProdutor \n\n \n\n \n\nRegime de Opera\u00e7\u00e3o 3 \n\n \n\n \n\n0=Pg  \ntorna-se necess\u00e1rio tamb\u00e9m zerar os termos da linha \n\nde P, a menos do termo da diagonal - A(P,P), e \ntamb\u00e9m substituir na posi\u00e7\u00e3o respectiva no vetor de \ntermos independentes o valor prescrito da press\u00e3o \n\nmultiplicado pelo coeficiente A(P,P). \n\n \n\nPar\u00e2metro utilizado no c\u00e1lculo expl\u00edcito das satura\u00e7\u00f5es \n\nPo\u00e7o \nInjetor Regime de Opera\u00e7\u00e3o 1 \n\n( )\nPrwPw\n\nqq =  \n\nRegime de Opera\u00e7\u00e3o 1 ( )\nPr\n\nw\nm TP\n\nw o P\n\nq q\n?\n\n? ?\n? ?\n\n= ? ?+? ?\n \n\nRegime de Opera\u00e7\u00e3o 2 ( ) . ( )w w fpP Pq p pWI ?? ?= ? ?? ?   \n( )PIq  1 x 1 \n\nPo\u00e7o \nProdutor \n\nRegimes de Opera\u00e7\u00e3o 3 ( ) ww iP\ni Po o w w P\n\nq m\nB B\n\n?\n? ? ? ?\n\n? ?\n= ?? ?+? ?\n\n?  \n\nonde P  \u00e9 o n\u00f3 do volume que cont\u00e9m o po\u00e7o,  e i\ni P\n\nm\n? ?\n?  \u00e9 calculado como descrito na se\u00e7\u00e3o A1.4 \n\n \nTab. A3.1 \u2013 Resumo das express\u00f5es dos res\u00edduos associados ao termo de po\u00e7os para diferentes regimes de \n\nopera\u00e7\u00e3o utilizados no M\u00e9todo IMPES \n \n\n\n\n216 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n \n\nRes\u00edduo associado ao termo de inje\u00e7\u00e3o / produ\u00e7\u00e3o da fase \u00e1gua \n\nPo\u00e7o \nInjetor \n\nRegime de Opera\u00e7\u00e3o 1 \n(Vaz\u00e3o de \u00e1gua prescrita) \n\n( )\nPrw wpo\u00e7os P\n\nR q=  \n\nRegime de Opera\u00e7\u00e3o 1 \n(Vaz\u00e3o total prescrita:          \n\n\u00e1gua + \u00f3leo) \nPr\n\nw\nw Tpo\u00e7os\n\nw o P\n\nR q\n?\n\n? ?\n? ?\n\n= ? ? ?+? ?\n \n\nRegime de Opera\u00e7\u00e3o 2 \n(Press\u00e3o de fundo de po\u00e7o \n\nprescrita) \n( ) ( )w w fpPpo\u00e7os PR WI p p?= ? ?  \n\n \n \n \n \n \n\nRWpocos \n \n \n \n \n\n \n \n \n \n\nNpo\u00e7os \nx 1 \n\n \n\nPo\u00e7o \nProdutor \n\nRegime de Opera\u00e7\u00e3o 3 \n(Press\u00e3o prescrita no bloco \n\nque cont\u00e9m o po\u00e7o) \n\nw\nw ipo\u00e7os\n\ni Po o w w P\n\nR m\nB B\n\n?\n? ? ? ?\n\n? ?\n= ?? ?+? ?\n\n?  \n \n\nRes\u00edduo associado ao termo de inje\u00e7\u00e3o / produ\u00e7\u00e3o da equa\u00e7\u00e3o da press\u00e3o \n\nPo\u00e7o \nInjetor \n\nRegime de Opera\u00e7\u00e3o 1 \n(Vaz\u00e3o de \u00e1gua prescrita) \n\n( )\nPrT w wpo\u00e7os P\n\nR q B=  \n\nRegime de Opera\u00e7\u00e3o 1 \n(Vaz\u00e3o total prescrita:          \n\n\u00e1gua + \u00f3leo) \nPr\n\nT Tpo\u00e7os\nR q= ?  \n\nRegime de Opera\u00e7\u00e3o 2 \n(Press\u00e3o de fundo de po\u00e7o \n\nprescrita) \n( ) ( )T w w o o fpPpo\u00e7osR WI B B p p? ?= ? + ?\n\n \n\n \n \n \n \n\nRTpocos \n \n \n \n \n\n \n \n \n \n\nNpo\u00e7os \nx 1 \n\n \n\nPo\u00e7o \nProdutor \n\nRegime de Opera\u00e7\u00e3o 3 \n(Press\u00e3o prescrita no bloco \n\nque cont\u00e9m o po\u00e7o) \n0TR =  \n\n \nTab. A3.2 \u2013 Resumo das express\u00f5es dos res\u00edduos associados ao termo de po\u00e7os para diferentes regimes de \n\nopera\u00e7\u00e3o utilizados no M\u00e9todo Totalmente Impl\u00edcito \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n\n\n\n ANEXO 3 -  REGIMES DE OPERA\u00c7\u00c3O DOS PO\u00c7OS 217 \n\n \n \n \n\n \n\nDerivadas do res\u00edduo da equa\u00e7\u00e3o da \u00e1gua em rela\u00e7\u00e3o a p e sw  associadas ao termo de po\u00e7o \n\nPo\u00e7o \nInjetor \n\nRegime de Opera\u00e7\u00e3o 1 \n(Vaz\u00e3o de \u00e1gua prescrita) \n\n0w w\nwpo\u00e7os po\u00e7os\n\nR R\np s\n\n? ?\n= =\n\n? ?\n \n\nRegime de Opera\u00e7\u00e3o 1 \n(Vaz\u00e3o total prescrita:          \n\n\u00e1gua + \u00f3leo) \n\nPr\n\nw w\nT\n\nw opo\u00e7os P\n\nR\nq\n\np p\n?\n\n? ?\n? ?? ?? ?\n\n= ? ? ?? ?? ? +? ?? ?\n\nPr\n\nw w\nT\n\nw w w opo\u00e7os P\n\nR\nq\n\ns s\n?\n\n? ?\n? ?? ?? ?\n\n= ? ? ?? ?? ? +? ?? ?\n \n\nRegime de Opera\u00e7\u00e3o 2 \n(Press\u00e3o de fundo de po\u00e7o \n\nprescrita) \n\n( )w ww fp\npo\u00e7os P\n\nR\nWI p p\n\np p\n?\n\n?\n? ?? ?\n\n= ? + ?? ?? ?? ?\n\n( )w w fp\nw wpo\u00e7os P\n\nR\nWI p p\n\ns s\n?? ?? ?\n\n= ? ?? ?? ?? ?\n  \n\n \n\n \n \n \n \n\ndRWdpPocos \n \n \n \n\ndRWdsPocos \n \n \n \n \n \n\n1 x 1 \nPo\u00e7o \n\nProdutor \n\nRegime de Opera\u00e7\u00e3o 3 \n(Press\u00e3o prescrita no bloco \n\nque cont\u00e9m o po\u00e7o) \n\nw w\ni\n\ni Ppo\u00e7os o o w w P\n\nR\nm\n\nX X B B\n?\n\n? ? ? ?\n? ?? ?\n\n= ? ? ?? ? +? ?\n?\n\n \nDerivadas do res\u00edduo da equa\u00e7\u00e3o da press\u00e3o em rela\u00e7\u00e3o a p e sw  associadas ao termo de po\u00e7o \n\nPo\u00e7o \nInjetor \n\nRegime de Opera\u00e7\u00e3o 1 \n(Vaz\u00e3o de \u00e1gua prescrita) \n\n0T T\nwpo\u00e7os po\u00e7os\n\nR R\np s\n\n? ?\n= =\n\n? ?\n \n\nRegime de Opera\u00e7\u00e3o 1 \n(Vaz\u00e3o total prescrita:          \n\n\u00e1gua + \u00f3leo) \n\n0T T\nwpo\u00e7os po\u00e7os\n\nR R\np s\n\n? ?\n= =\n\n? ?\n \n\nRegime de Opera\u00e7\u00e3o 2 \n(Press\u00e3o de fundo de po\u00e7o \n\nprescrita) \n\n[\n,\n\nT\nm m\n\nm w opo\u00e7os\n\nR\nWI B\n\np\n?\n\n=\n\n?\n= ? +\n\n? ?  \n\n         ( )m mm m fpBB p pp p\n?\n\n?\n?? ?? ?\n\n+ + ? ?? ?? ?? ? ?\n \n\n( )\n,\n\nmT\nm fp\n\nm w ow wpo\u00e7os\n\nR\nWI B p p\n\ns s\n?\n\n=\n\n??\n= ? ?\n\n? ??  \n\n \n\n \n \n \n \n \n\ndRTdpPocos \n \n \n \n\ndRTdsPocos \n \n \n \n \n\n1 x 1 \nPo\u00e7o \n\nProdutor \n\nRegime de Opera\u00e7\u00e3o 3 \n(Press\u00e3o prescrita no bloco \n\nque cont\u00e9m o po\u00e7o) \nMant\u00e9m-se inalterado o valor na coluna 2P e \n\nanula-se os demais termos da linha \n\n \n\nonde P  \u00e9 o n\u00f3 do volume que cont\u00e9m o po\u00e7o, i\ni P\n\nm\n? ?\n?  \u00e9 calculado como descrito na se\u00e7\u00e3o A3.4, X = p, sw   e \n\n\n\n218 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n \n\n( )2\n1w o w\n\nw o\nw o w o\n\nX X X\n? ? ?\n\n? ?\n? ? ? ?\n\n? ? ? ?? ? ?= ?? ? ? ?? + ? ?? ? +? ?\n,           o w\n\nw o w oX X\n? ?\n\n? ? ? ?\n? ? ? ?? ?\n\n= ?? ? ? ?? + ? +? ? ? ?\n, \n\n( )2\n1w w o o w\n\no o w w o w\no o w w o o w w\n\nB B\nB\n\nX B B X X X X B B\n? ? ?\n\n? ? ? ? ?\n? ? ? ?\n\n? ? ? ? ? ? ? ?? ? ? ? ?= ? ? +? ? ? ? ? ?? ?? + ? ? ? ?? ? ? ? +? ?? ?\n \n\n \nTab. A3.3 \u2013 Resumo das express\u00f5es das derivadas dos res\u00edduos associados ao termo de po\u00e7os para diferentes \n\nregimes de opera\u00e7\u00e3o utilizados no M\u00e9todo Totalmente Impl\u00edcito \n \n\n\n\n219 \n\nAnexo    \n\n4 \nEESSQQUUEEMMAA  AALLTTEERRNNAATTIIVVOO  DDEE  \nTTRRAANNSSFFEERR\u00ca\u00caNNCCIIAA  DDEE  DDAADDOOSS  PPAARRAA  AASS            \nMMAATTRRIIZZEESS  EESSPPAARRSSAASS  \n\n \n\n \n\nQuando n\u00e3o se dispor de uma eficiente biblioteca num\u00e9rica capaz de gerenciar o \n\narmazenamento de matrizes esparsas e os processos de transfer\u00eancia dos coeficientes \n\ncalculados nas matrizes de cada elemento, pode-se utilizar o esquema proposto nesta se\u00e7\u00e3o e \n\nque consiste em criar matrizes locais em cada elemento contendo endere\u00e7os relativos as \n\nmatrizes esparsas. \n\nConsidere o esquema de armazenamento mais simples de matrizes esparsas  \n\ndenominado de \u201cformato coordenado\u201d (SAAD, 2000), no qual os dados passam a ser \n\nestruturados utilizando-se tr\u00eas vetores de mesmas dimens\u00f5es que definem todos os elementos \n\nn\u00e3o-nulos de uma matriz: \n\n \n\n1. Um vetor de inteiros com os \u00edndices das linhas; \n\n2. Um vetor de inteiros com os \u00edndices das colunas; \n\n3. Um vetor de n\u00fameros reais contendo os valores n\u00e3o-nulos localizados nas posi\u00e7\u00f5es \n\n(linha, coluna) definidas nos outros dois vetores; \n\n \n\nconforme explicado no Cap. 5. A utiliza\u00e7\u00e3o de outros formatos de armazenamento, como o \n\nformato de linha comprimida (Compressed Sparse Row - CSR), tamb\u00e9m podem ser aplicados \n\nno esquema proposto. \n\nA desvantagem da utiliza\u00e7\u00e3o do armazenamento de matriz esparsa \u00e9 a dificuldade de \n\nidentificar diretamente a localiza\u00e7\u00e3o de um coeficiente no vetor de valores. Dados os \u00edndices \n\nda linha e  coluna correspondentes da matriz cheia, em alguns casos torna-se necess\u00e1rio \n\n\u201cvarrer\u201d praticamente todas as posi\u00e7\u00f5es dos vetores de \u00edndices para identificar a localiza\u00e7\u00e3o \n\nde um coeficiente no vetor de valores. Essa dificuldade \u00e9 acentuada no m\u00e9todo EbFVM \n\nporque em cada elemento e a cada passo de tempo \u00e9 calculada uma matriz local contendo \n\nvalores que devem ser transportados para a matriz esparsa global. Este procedimento \n\n\n\n220 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nnormalmente acaba tendo um alto custo computacional, independentemente da \n\ndisponibilidade de algoritmos eficientes, porque de qualquer forma o algoritmo deve ter um \n\nprocedimento de busca da posi\u00e7\u00e3o correspondente no vetor de valores atrav\u00e9s da informa\u00e7\u00e3o \n\ndos \u00edndices da linha e coluna nos outros dois vetores. \n\nPara sanar essas dificuldades com o armazenamento de matrizes esparsas \u00e9 proposto \n\nnesta se\u00e7\u00e3o criar uma matriz para cada elemento da malha que contenha as posi\u00e7\u00f5es no vetor \n\nde valores da matriz global esparsa onde cada valor da matriz local de coeficientes deve ser \n\nadicionado. Essas matrizes de endere\u00e7os, compostas apenas de valores inteiros, s\u00e3o calculadas \n\nno in\u00edcio do processo e uma \u00fanica vez para toda a simula\u00e7\u00e3o. Atrav\u00e9s deste procedimento, \n\nportanto, n\u00e3o \u00e9 mais necess\u00e1rio, referenciar-se \u00e0 \u00edndices de coluna e linha na transfer\u00eancia de \n\ninforma\u00e7\u00e3o das matrizes locais para a global, o que \u00e9 muito conveniente pois evita o trabalho \n\nde pesquisa da posi\u00e7\u00e3o de um coeficiente no vetor de valores. \n\nA Fig. A4.1 ilustra o processo de representa\u00e7\u00e3o de matrizes esparsas, apresentando um \n\nexemplo de uma malha composta por dois elementos \u2013 um triangular e outro quadril\u00e1tero. \n\nNota-se que, semelhantemente ao processo de forma\u00e7\u00e3o das matrizes globais cheias, a matriz \n\nglobal esparsa representada desta forma \u00e9 montada a partir da informa\u00e7\u00e3o proveniente das \n\nmatrizes locais de coeficientes, como deveria ser. No entanto, a posi\u00e7\u00e3o no vetor de valores de \n\ncada um dos valores provenientes das matrizes locais depender\u00e1 da informa\u00e7\u00e3o contida nas \n\nmatrizes de endere\u00e7os dos elementos. \n\n \n\n\n\n ANEXO 4 \u2013 ESQUEMA DE TRANSFER\u00caNCIA DE DADOS PARA MATRIZES ESPARSAS 221 \n\n \n\n \n\n \n \n\nFig. A4.1 \u2013 Procedimento de preenchimento da matriz esparsa definida por tr\u00eas vetores que cont\u00eam os valores \n\nn\u00e3o-nulos e os \u00edndices que definem a posi\u00e7\u00e3o de cada um deles na matriz cheia \n\n \n\n \n\nPara exemplificar o papel das matrizes locais de posi\u00e7\u00f5es na forma\u00e7\u00e3o da matriz \n\nesparsa global, considere que a matriz de conectividades fornecida pelo gerador da malha da \n\nFig. A4.1 seja \n\n \n N\u00f3 local 1 N\u00f3 local 2 N\u00f3 local 3 N\u00f3 local 4 \n     \n\nElemento 1 1 2 4 5 \nElemento 2 4 2 3 - \n\n \n \n\nNeste caso, as matrizes de posi\u00e7\u00f5es de cada um dos elementos ter\u00e3o a forma \n\n \n\n1\n\n1 2 3 4\n5 6 8 9\n\ne\n13 14 16 17\n18 19 20 21\n\n? ?\n? ?\n? ?=\n? ?\n? ?\n? ?\n\n e 2\n\n16 14 15\ne 8 6 7\n\n12 10 11\n\n? ?\n? ?= ? ?\n? ?? ?\n\n \n\n\n\n222 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n \n\nque correspondem as posi\u00e7\u00f5es destacadas nos vetores de valores da Fig. A4.1. \n\nO procedimento de constru\u00e7\u00e3o da matriz esparsa (tr\u00eas vetores) e das matrizes locais de \n\nendere\u00e7os pode ser resumido da seguinte forma: \n\n \n\n1. Inicializar matrizes de valores inteiros de NNExNNE para cada elemento e dois vetores \n\nglobais de valores inteiros de dimens\u00f5es 1x(16*NElm), onde NNE  \u00e9 o n\u00famero de n\u00f3s \n\ndo elemento e NElm \u00e9 o n\u00famero de elementos da malha. \n\n \n\n2. Visitar cada elemento da malha e: \n\n \n\na) escrever a localiza\u00e7\u00e3o da linha e coluna da matriz global nos dois vetores \n\nglobais e escrever esta localiza\u00e7\u00e3o na matriz local de endere\u00e7os a partir da \n\nmatriz de conectividades fornecida pelo gerador de malhas; \n\nb) criar um vetor auxiliar que conter\u00e1 a localiza\u00e7\u00e3o do aparecimento do \n\nprimeiro n\u00f3. Esse vetor facilitar\u00e1 a procura por posi\u00e7\u00f5es correspondentes a \n\nconex\u00f5es entre n\u00f3s que j\u00e1 est\u00e3o definidas. \n\nc) sempre que se passar a um novo elemento, checar no vetor auxiliar se a \n\nposi\u00e7\u00e3o nos vetores correspondentes a uma posi\u00e7\u00e3o na linha i e coluna j j\u00e1 \n\nfoi criada. \n\n \n\n3. Eliminar as posi\u00e7\u00f5es alocadas nos vetores globais que n\u00e3o receberam valores. \n\n \n\n4. Inicializar um terceiro vetor global de valores de dupla precis\u00e3o, de mesmas \n\ndimens\u00f5es dos dois anteriores, que receber\u00e1 os dados da matriz de coeficientes.  \n\n \n\n5. Ordenar os vetores globais de posi\u00e7\u00e3o em ordem crescente de linha e coluna, para a \n\nobten\u00e7\u00e3o de vetores ordenados como os demonstrados na Fig. A4.1, e atualizar as \n\nmatrizes locais de endere\u00e7os de acordo com os novos vetores globais. Este \n\nprocedimento \u00e9 importante porque acelera o processo de resolu\u00e7\u00e3o do sistema linear, \n\nque passa a receber uma matriz esparsa com valores ordenados. \n\n \n\n6. Criar um vetor contendo a informa\u00e7\u00e3o da localiza\u00e7\u00e3o dos dados referentes a diagonal \n\nda matriz dos coeficientes nos vetores globais. Esse vetor ter\u00e1 muita utilidade na \n\n\n\n ANEXO 4 \u2013 ESQUEMA DE TRANSFER\u00caNCIA DE DADOS PARA MATRIZES ESPARSAS 223 \n\n \n\n \n\nadi\u00e7\u00e3o  das informa\u00e7\u00f5es dos termos transientes e de po\u00e7os na matriz esparsa em cada \n\nn\u00edvel temporal.  \n\n \n\nDeve destacar novamente que com este procedimento n\u00e3o \u00e9 mais necess\u00e1rio trabalhar \n\ncom os \u00edndices relacionados a uma matriz cheia. Isso s\u00f3 \u00e9 poss\u00edvel porque cada elemento \n\nconhece a posi\u00e7\u00e3o que os dados calculados devem ser acrescentados no vetor de valores. \n\nPortanto, uma vez definidos os vetores globais, n\u00e3o \u00e9 mais necess\u00e1rio qualquer correla\u00e7\u00e3o de \n\nposi\u00e7\u00f5es  linha-coluna com a posi\u00e7\u00e3o no vetor global. \n\n \n\n \n\nA4.1 Bibliografia \n \n\nSAAD, Y., 2000. Iterative Methods for Sparse Linear Systems, 2nd Ed., PWS Publishing \n\nCompany, Boston. \n\n \n\n\n\n \n\n\n\n225 \n\nAnexo    \n\n5 \nMM\u00c9\u00c9TTOODDOOSS  DDEE  RREELLAAXXAA\u00c7\u00c7\u00c3\u00c3OO    \nEEMMPPRREEGGAADDOOSS  NNOO  MMUULLTTIIGGRRIIDD  \n\n  \n\n \n\n \n\n Os m\u00e9todos utilizados para obter a solu\u00e7\u00e3o das diversas malhas empregadas no \n\nmultigrid s\u00e3o apresentados sucintamente neste cap\u00edtulo. Conforme mencionado no Cap. 6, as \n\nequa\u00e7\u00f5es da malha mais grosseira s\u00e3o resolvidas com o m\u00e9todo direto LU, enquanto que as \n\nequa\u00e7\u00f5es das demais malhas utilizadas no multigrid s\u00e3o resolvidas com os solvers iterativos \n\nILU(0) ou Gauss-Seidel.  \n\nOs dois primeiros solvers caracterizam-se por transformar a matriz original [A] em um \n\nproduto de duas matrizes triangulares [L] e [U], na forma \n\n \n\n [ ] [ ][ ]\n\n( ) ( )\n\n( ) ( )\n\n( )\n\n1 1\n11 1\n\n2 2\n22 221\n\n1 1\n\n1 0 0\n01\n\n0\n1 0 0\n\nn\n\nn\n\nn\nn nn nn\n\nUL\n\na a\n\na am\nA L U\n\nm m a?\n\n? ?? ? ? ?? ? ? ?? ?= = ? ?? ? ? ?? ? ? ?? ? ? ?\n\n (A5.1) \n\n \n\nonde [L] \u00e9 a matriz triangular inferior com diagonal unit\u00e1ria e [U] a matriz triangular superior. \n\nDessa forma, a solu\u00e7\u00e3o do sistema linear resultante pode ser obtida pelos processos de \n\nsubstitui\u00e7\u00e3o ascendente e descendente, como demonstrado na seq\u00fc\u00eancia. \n\n O m\u00e9todo de Gauss-Seidel, por sua vez, pertence \u00e0 classe dos m\u00e9todos ponto a ponto e \n\nresolve o sistema linear iterativamente, equa\u00e7\u00e3o por equa\u00e7\u00e3o, utilizando os valores das \n\nvari\u00e1veis calculadas no ciclo iterativo anterior e tamb\u00e9m as novas vari\u00e1veis neste ciclo. \n\n Os tr\u00eas solvers mencionados neste cap\u00edtulo ser\u00e3o descritos com mais detalhes na \n\nseq\u00fc\u00eancia, enfatizando, principalmente, aspectos de implementa\u00e7\u00e3o computacional. \n\n \n\n \n\n\n\n226 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nA5.1. M\u00e9todo Direto LU de Resolu\u00e7\u00e3o de Sistema Linear  \n  \n\n O m\u00e9todo direto de resolu\u00e7\u00e3o de sistema linear LU \u00e9 uma forma modificada do \n\nm\u00e9todo de Elimina\u00e7\u00e3o de Gauss. Neste m\u00e9todo o sistema linear original  \n\n \n\n [ ]{ } { }A b=?  (A5.2) \n \n\n\u00e9 escrito como \n\n  \n\n [ ][ ]{ } { }L U b=?  (A5.3) \n \n\nonde [L] e [U] s\u00e3o as matrizes definidas na Eq. (A5.1). Definindo um vetor auxiliar { }V como \n \n\n [ ][ ]{ }\n{ }\n\n{ }\nV\n\nL U b=?  (A5.4) \n\n \n\na solu\u00e7\u00e3o do sistema linear original pode ser obtida resolvendo-se dois sistemas lineares mais \n\nsimples, sendo o primeiro o que determina o vetor { }V  \n \n\n [ ]{ } { }L V b=  (A5.5) \n \n\ne na seq\u00fc\u00eancia, o que determina o vetor solu\u00e7\u00e3o desejado \n\n  \n\n [ ]{ } [ ]U V=?  (A5.6) \n \n\n Embora pare\u00e7a que o custo computacional \u00e9 grande pela resolu\u00e7\u00e3o de dois sistemas \n\nlineares, esse processo \u00e9 facilitado tomando-se proveito da defini\u00e7\u00e3o das duas matrizes \n\ntriangulares, resolvendo-se cada sistema das Eqs. (A5.5) e (A5.6) atrav\u00e9s de substitui\u00e7\u00f5es \n\nsucessivas: \n\n \n\n descendentes: \n\n\n\n ANEXO  5 \u2013  M\u00c9TODOS DE RELAXA\u00c7\u00c3O EMPREGADOS NO MULTIGRID 227 \n\n \n\n \n\n \n\n( )\n\n( )\n\n( ) ( ) ( )\n\n1\n1\n\n1 1\n11\n\n1\n\n1\n\n/                     para  desde 2 at\u00e9 \nk\n\nk k k\nk k kj j kk\n\nj\n\nb\nV\n\nL\n\nV b L V L k n\n?\n\n=\n\n?\n=?\n\n?\n?\n\n? ??\n= ?? ??\n\n? ? ?\n?\n\n (A5.7) \n\n \n\ne  \n\n ascendentes: \n\n \n\n( )\n\n( )\n\n( ) ( ) ( )\n\n1\n\n/                     para  desde ( -1) at\u00e9 1\n\nn\nn\n\nn n\nnn\n\nn\nk k k\n\nk k kj j kk\nj k\n\nV\nU\n\nV U U k n\n= +\n\n?\n=?\n\n?\n?\n\n? ?? = ?? ??\n? ? ?\n\n?\n\n?\n\n? ?\n\n (A5.8) \n\n \n\nonde n \u00e9 a dimens\u00e3o da matriz original. \n\n \n\n  \n\nA5.2. Determina\u00e7\u00e3o das Matrizes Triangulares [L]  e [U] \n \n\n O processo de determina\u00e7\u00e3o das matrizes utilizadas no m\u00e9todo LU consiste em (n -1) \n\npassos, onde os elementos ( )1kija\n+  da Eq. (A5.1) s\u00e3o constru\u00eddos a partir dos elementos ( )kija , \n\nconsiderando como ( )1ija  a matriz inicial. Este processo tem in\u00edcio pelo c\u00e1lculo dos termos \n\nmultiplicadores, ikm , que s\u00e3o aqueles que alimentam a matriz [L], e s\u00e3o utilizados para zerar \n\nos elementos necess\u00e1rios para criar a matriz [U], \n\n \n\n \n( ) ( )\n\n( ) ( ) ( )1\nij\n\n/                             para  desde  at\u00e9 \n\n                   para  desde  at\u00e9 \n\nk k\nik ik kk\n\nk k k\nij ik kj\n\nm a a i k + 1 n\n\na a m a i, j k + 1 n+\n\n? =?\n?\n? = ??\n\n (A5.9) \n\n \n\n No m\u00e9todo implementado neste trabalho n\u00e3o se considera a possibilidade de haver \n\ntermos nulos na diagonal, caso contr\u00e1rio seria necess\u00e1rio a troca de linhas antes de resolver a \n\nEq. (A5.9). \n\n \n\n \n\n\n\n228 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nA5.3. M\u00e9todo de Resolu\u00e7\u00e3o de Sistema Linear Baseado na \nDecomposi\u00e7\u00e3o Incompleta ILU(0) \n\n \n\nEste m\u00e9todo baseia-se na constru\u00e7\u00e3o de uma matriz de coeficientes incompleta, isto \u00e9, \n\nque n\u00e3o possui todos os coeficientes da matriz original, mas que \u00e9 bastante pr\u00f3xima dela, e \n\nbusca resolver iterativamente o sistema linear resultante atrav\u00e9s de um m\u00e9todo que \u00e9 eficiente \n\nao trabalhar com matrizes deste tipo (MALISKA, 2004). A decomposi\u00e7\u00e3o incompleta ILU(0) \n\n\u00e9 uma das formas de obter uma matriz pr\u00f3xima \u00e0 original. \n\nO processo de constru\u00e7\u00e3o das matrizes [L] e [U] incompletas \u00e9 praticamente id\u00eantico \n\nao do m\u00e9todo LU tradicional, a menos do fato de que apenas os valores n\u00e3o-nulos na matriz \n\noriginal s\u00e3o modificados. Esta \u00e9 uma caracter\u00edstica importante porque este procedimento, \n\ndenominado de fatora\u00e7\u00e3o ILU(0), n\u00e3o altera o formato de armazenamento da matriz de dados, \n\ne portanto, n\u00e3o demanda reformata\u00e7\u00e3o da matriz esparsa.  \n\nObtidas as matrizes incompletas, doravante denominadas de [ ]\u00b4L  e [ ]\u00b4U , inicia-se o \nprocesso iterativo, determinando-se uma corre\u00e7\u00e3o nas vari\u00e1veis com o m\u00e9todo de \n\ndecomposi\u00e7\u00e3o LU e as atualizando,  at\u00e9 atingir a norma do res\u00edduo escolhido, como \n\ndemonstrado na seq\u00fc\u00eancia. \n\nDefinindo a express\u00e3o de um res\u00edduo calculado com a matriz original [A] em uma \n\nitera\u00e7\u00e3o ? como \n\n \n\n { } [ ]{ } { }A b? ?= ??R  (A5.10)  \n \n\ne uma f\u00f3rmula de recorr\u00eancia que utiliza a express\u00e3o deste res\u00edduo e tamb\u00e9m as matrizes \n\nincompletas [L] e [U], dada por \n\n \n\n [ ][ ]{ } [ ][ ]{ } { }1\u00b4 \u00b4 \u00b4 \u00b4L U L U? ? ?+ = ?? ? R  (A5.11)  \n  \n\npode-se mostrar que a solu\u00e7\u00e3o convergida n\u00e3o tem influ\u00eancia das matrizes incompletas [ ]\u00b4L  e \n\n[ ]\u00b4U , pois, neste caso, o vetor { }R  se anula e { } { }1? ?+ =? ? .  \n Assim, reescrevendo a Eq. (A5.11) utilizando a defini\u00e7\u00e3o de uma corre\u00e7\u00e3o do campo \n\nde ?  na forma \n\n\n\n ANEXO  5 \u2013  M\u00c9TODOS DE RELAXA\u00c7\u00c3O EMPREGADOS NO MULTIGRID 229 \n\n \n\n \n\n { } { } { }1 1? ? ?? + += ?? ?  (A5.12)  \n \n\nobt\u00e9m-se \n\n  \n\n [ ][ ]{ } { }1\u00b4 \u00b4L U ? ?? + = ? R  (A5.13) \n \n\nComo as duas matrizes do sistema linear da equa\u00e7\u00e3o anterior s\u00e3o definidas como \n\ntriangulares inferior e superior, a solu\u00e7\u00e3o deste sistema pode ser obtida simplesmente \n\nfazendo-se dois processos de substitui\u00e7\u00f5es sucessivas, atrav\u00e9s da defini\u00e7\u00e3o de um vetor \n\nauxiliar { }V , \n \n\n { } [ ]{ }1 1\u00b4V U? ??+ +=  (A5.14) \n \n\no que reduz o sistema linear da Eq. (A5.13) a \n\n \n\n [ ]{ } { }1\u00b4L V ? ?+ = ? R  (A5.15) \n \n\n Obtido o campo de { }V  com a solu\u00e7\u00e3o da Eq. (A5.15), resolve-se a Eq. (A5.14) para \n\nobter o campo da corre\u00e7\u00e3o { }?  que \u00e9 utilizada, por sua vez, para avan\u00e7ar a solu\u00e7\u00e3o para o \nnovo n\u00edvel iterativo. Calcula-se o novo vetor de res\u00edduos, Eq. (A5.10), repetindo todo esse \n\nprocesso at\u00e9 que a norma do res\u00edduo seja menor que a toler\u00e2ncia especificada. \n\n \n\n \n\nA5.4. M\u00e9todo de Gauss-Seidel \n \n\n O M\u00e9todo de Gauss-Seidel, outra op\u00e7\u00e3o de solver-base do multigrid, foi implementado \n\nda forma tradicional que consiste em iterar um n\u00famero fixo de vezes em cada malha, \n\nresolvendo equa\u00e7\u00e3o por equa\u00e7\u00e3o, utilizando os valores das vari\u00e1veis calculadas no ciclo \n\niterativo anterior e tamb\u00e9m as novas vari\u00e1veis neste ciclo. Este procedimento pode ser \n\nresumido como \n\n\n\n230 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n \n1\n\n1 1\n\n1 1\n\n1 i n\ni i ij j ij j\n\nj j iii\n\nb a a\na\n\n? ? ?\n?\n\n+ +\n\n= = +\n\n? ?\n= ? ?? ?\n\n? ?\n? ?? ? ?  (A5.16) \n\n \n\nNo Cap. 8, no entanto, utilizou-se tamb\u00e9m o M\u00e9todo de Gauss-Seidel para avaliar o \n\ndesempenho do multigrid, isto \u00e9, procurou-se mostrar a superioridade do m\u00e9todo proposto \n\ncomparando-o com m\u00e9todos tradicionais, como o Gauss-Seidel. Neste caso dever-se-ia \n\ndeterminar a norma do res\u00edduo de cada equa\u00e7\u00e3o para ser utilizada como crit\u00e9rio de parada.  \n\nEm situa\u00e7\u00f5es onde o n\u00famero de itera\u00e7\u00f5es \u00e9 fixo, o solver Gauss-Seidel implementado de \n\nacordo com a Eq. (A5.16) aplica-se muito bem. Mas quando se necessita calcular diversas \n\nvezes o res\u00edduo, este solver pode ser implementado com bastante vantagem utilizando uma \n\nvers\u00e3o ligeiramente diferente, obtida incluindo o termo ii ia\n?? ?  dentro dos colchetes da Eq. \n\n(A5.16) e somando o termo i\n??  no lado direito desta equa\u00e7\u00e3o, resultando em \n\n \n\n \n1\n\n1 1\n\n1\n\n1 i n\ni i i ij j ij j\n\nj j iii\n\nb a a\na\n\n? ? ? ?\n?\n\n+ +\n\n= =\n\n? ?\n= + ? ?? ?\n\n? ?\n? ?? ? ? ?  (A5.17) \n\n \n\nonde o termo entre colchetes pode ser considerado uma boa estimativa do res\u00edduo da equa\u00e7\u00e3o. \n\nNeste caso n\u00e3o \u00e9 mais necess\u00e1rio o trabalho extra de calcular o res\u00edduo utilizado como crit\u00e9rio \n\nde interrup\u00e7\u00e3o do processo iterativo. Note tamb\u00e9m que o termo entre colchetes dividido por \n\niia  \u00e9 a corre\u00e7\u00e3o do valor de i\n?? . \n\n \n\n \n\nA5.5. Bibliografia \n \n\nMALISKA, C. R., 2004. Transfer\u00eancia de Calor e Mec\u00e2nica dos Fluidos Computacional, 2\u00aa.   \n\nEdi\u00e7\u00e3o revista e ampliada, Livros T\u00e9cnicos e Cient\u00edficos Editora, Rio de Janeiro. \n\n \n\n\n\n231 \n\nAnexo    \n\n6 \nFFLLUUXXOOGGRRAAMMAASS  DDOO  SSOOLLVVEERR  \n\nMMUULLTTIIGGRRIIDD  \n \n\n \n\n \n\nNesta se\u00e7\u00e3o s\u00e3o apresentados os fluxogramas1 que resumem as rotinas computacionais \n\nempregadas no software multigrid implementado nesta tese. O significado de cada um dos \n\ns\u00edmbolos utilizados pode ser visto na Tab. A6.1, enquanto que os fluxogramas s\u00e3o \n\napresentados nas Figs. A6.1 e A6.2. \n\n \n\n \nTab. A6.1 - S\u00edmbolos empregados nos fluxogramas \n\n \n\n \n \n\nTerminal Indica in\u00edcio ou fim do processo. \n\n \n\n \n \n\nOpera\u00e7\u00e3o \nProcedimento executado em um \n\nlocal diferente de onde foi \nchamado. \n\n \n\n \n \n\nOpera\u00e7\u00e3o Local Procedimento completamente executado no local que \u00e9 chamado. \n\n \n\n \n \n\nDecis\u00e3o \nIndica  poss\u00edveis desvios de acordo \n\ncom as condi\u00e7\u00f5es estipuladas na \ndecis\u00e3o. \n\n \n\n \n \n\nLa\u00e7o Repete a execu\u00e7\u00e3o de um conjunto de instru\u00e7\u00f5es. \n\n \n\n \n \n\nConector Indica final de la\u00e7o ou recebimento de fluxo desviado. \n\n                                                 \n1 Fluxograma \u00e9 a t\u00e9cnica de representa\u00e7\u00e3o gr\u00e1fica que utiliza s\u00edmbolos previamente convencionados e que \npermite a descri\u00e7\u00e3o clara e precisa do fluxo ou a seq\u00fc\u00eancia de um processo, facilitando a sua an\u00e1lise e redesenho. \n\n\n\n232 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n \n \n\nFig. A6.1 \u2013 Fluxograma geral do multigrid \n\n \n\n\n\n ANEXO 6 \u2013 FLUXOGRAMA DO SOLVER MULTIGRID 233 \n\n \n \n \n\n \n\n \n \n\nFig. A6.2 \u2013 Fluxogramas dos n\u00edveis 2 (lado esquerdo) e 3 (lado direito) do multigrid \n\n\n\n \n\n\n\n235 \n\nAnexo    \n\n7 \nCC\u00c1\u00c1LLCCUULLOO  DDOO  FFLLUUXXOO  NNAASS  MMAALLHHAASS    \nFFOORRMMAADDAASS  PPOORR  EELLEEMMEENNTTOOSS  TTRRIIAANNGGUULLAARREESS    \n\n((UUMMAA  AABBOORRDDAAGGEEMM  DDIIFFEERREENNTTEE  DDAA  AAPPRREESSEENNTTAADDAA  NNOO  CCAAPP..  55  EE  AA  CCOOMMPPAARRAA\u00c7\u00c7\u00c3\u00c3OO                  \nCCOOMM  AA  FFOORRMMUULLAA\u00c7\u00c7\u00c3\u00c3OO  UUTTIILLIIZZAADDAA  EEMM  OOUUTTRROOSS  TTRRAABBAALLHHOOSS))  \n\n \n\n \n\n \n\nO procedimento geral de obten\u00e7\u00e3o das equa\u00e7\u00f5es discretizadas no m\u00e9todo EbFVM \n\napresentado no Cap. 5 aplica-se para elementos triangulares e quadrangulares. Contudo, a fim \n\nde avaliar melhor a quest\u00e3o do aparecimento das transmissibilidades negativas discutida no \n\nCap. 7, os termos de fluxo das equa\u00e7\u00f5es s\u00e3o discretizados nesta se\u00e7\u00e3o a partir de um \n\nprocedimento um pouco diferente, aplic\u00e1vel apenas para elementos triangulares, mas que \n\nresulta nas mesmas equa\u00e7\u00f5es apresentadas no Cap. 5.  \n\n \n\nDedu\u00e7\u00e3o do termo de fluxo. No M\u00e9todo dos Volumes Finitos baseado em Elementos - \n\nEbFVM, a press\u00e3o \u00e9 avaliada em qualquer ponto do elemento em fun\u00e7\u00e3o dos valores nodais \n\nutilizando as fun\u00e7\u00f5es de forma. Para elementos triangulares, tem-se \n \n\n332211 pNpNpNp ++=  (A7.1) \n\n \n\nonde os operadores Ni s\u00e3o as fun\u00e7\u00f5es de forma e s\u00e3o definidos, para tri\u00e2ngulos, como \n\n \n\n( )\n( )\n( )\n\n1\n\n2\n\n3\n\n, 1\n\n,\n\n,\n\nN\n\nN\n\nN\n\n? ? ? ?\n? ? ?\n? ? ?\n\n= ? ?\n\n=\n\n=\n\n (A7.2) \n\n \n\nA Fig. A7.1 apresenta um elemento triangular nos planos f\u00edsico (x, y) e transformado \n\n(?, ?).  \n\n \n\n\n\n236 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n \n \n\nFig. A7.1 - Elemento triangular nos planos f\u00edsico e transformado \n\n \n\nPode-se mostrar que as coordenadas de qualquer ponto dentro do elemento tamb\u00e9m \n\npodem ser expressas em fun\u00e7\u00e3o dos valores de seus tr\u00eas n\u00f3s como \n\n \n\n( )\n( )\n\n1 1 2 2 3 3\n\n1 1 2 2 3 3\n\n,\n\n,\n\nx N x N x N x\n\ny N y N y N y\n\n? ?\n? ?\n\n= + +??\n?\n\n= + +??\n (A7.3)  \n\n \n\nSubstituindo-se as Eqs. (A7.2) em (A7.1) chega-se a \n\n \n\n( ) ( ) ( )1 2 31p p p p? ? ? ?= ? ? + +  (A7.4) \n \n\ne agrupando-se os termos semelhantes, a equa\u00e7\u00e3o anterior pode ser reescrita como \n\n \n\n( ) ( )\n( ) ( )\n\n3 1 2 1 1\n\n3 3 1 2 2 1 1  \n\np p p p p p\n\nN p p N p p p\n\n? ?= ? + ? +\n= ? + ? +\n\n (A7.5)  \n\n      \n\nPortanto, as derivadas de p em rela\u00e7\u00e3o a x e y ser\u00e3o dadas por \n\n \n\n( ) ( )\n\n( ) ( )\n\n3 2\n3 1 2 1\n\n,\n\n3 2\n3 1 2 1\n\n,\n\nN Np\np p p p\n\nx x x\n\nN Np\np p p p\n\ny y y\n\n? ?\n\n? ?\n\n? ???\n= ? + ?? ? ? ??\n\n?\n? ? ??\n\n= ? + ??? ? ??\n\n (A7.6) \n\n \n\n\n\n ANEXO 7 -  C\u00c1LCULO DOS FLUXOS EM ELEMENTOS TRIANGULARES 237 \n\n \n \n \n\n \n\nPor\u00e9m, para determinar as derivadas das fun\u00e7\u00f5es de forma xN i ?? /  e  yN i ?? /  utiliza-\n\nse a regra da cadeia, na forma \n\n \n\n??? ?\n?\n\n?\n?\n\n+\n?\n?\n\n?\n?\n\n=\n?\n? y\n\ny\nNx\n\nx\nNN iii       e       \n\n??? ?\n?\n\n?\n?\n\n+\n?\n?\n\n?\n?\n\n=\n?\n? y\n\ny\nNx\n\nx\nNN iii  (A7.7) \n\n \n\nque resulta em um sistema de duas vari\u00e1veis a duas inc\u00f3gnitas, onde apenas as derivadas de Ni \nem fun\u00e7\u00e3o de x e y n\u00e3o s\u00e3o conhecidas. Assim, resolvendo-se o sistema chega-se a \n\n \n\n1\ndet( )\n\n1\ndet( )\n\ni i i\n\ni i i\n\nN N Ny y\nx J\n\nN N Nx x\ny J\n\n? ? ? ?\n\n? ? ? ?\n\n? ? ?? ? ?? ?\n= ?? ? ?? ? ? ? ?? ? ?\n\n?\n? ? ?? ? ?? ?\n\n= ?? ? ?? ? ? ? ?? ? ?\n\n (A7.8) \n\n \n\nonde )det(J  \u00e9 o determinante da matriz jacobiana da transforma\u00e7\u00e3o, dado por \n\n \n\n???? ?\n?\n\n?\n?\n\n?\n?\n?\n\n?\n?\n\n=\nyxyx\n\nJ )det(  (A7.9) \n\n \n\nJ\u00e1 as derivadas de Ni, x e y  em fun\u00e7\u00e3o de ? e ?  podem ser obtidas atrav\u00e9s de \n\n \n\n31 2\n\n31 2\n\n1               0                1\n\n1               1                0\n\nNN N\n\nNN N\n\n? ? ?\n\n? ? ?\n\n?? ?? = ? = =? ? ? ?\n??\n?\n? ?? ?\n? = ? = =\n\n? ? ???\n\n (A7.10) \n\n \n\n31 2\n1 2 3 3 1\n\n31 2\n1 2 3 2 1\n\nNN Nx\nx x x x x\n\nNN Nx\nx x x x x\n\n? ? ? ?\n\n? ? ? ?\n\n?? ??? = + + = ??? ? ? ??\n?\n? ?? ??\n\n= + + = ???? ? ? ?\n\n (A7.11) \n\n \n\n\n\n238 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n31 2\n1 2 3 3 1\n\n31 2\n1 2 3 2 1\n\nNN Ny\ny y y y y\n\nNN Ny\ny y y y y\n\n? ? ? ?\n\n? ? ? ?\n\n?? ??? = + + = ??? ? ? ??\n?\n? ?? ??\n\n= + + = ???? ? ? ?\n\n (A7.12) \n\n \n\nSubstituindo-se as Eq. (A7.11) e (A7.12) em (A7.8), as derivadas das fun\u00e7\u00f5es de \n\nforma e o determinante da matriz jacobiana resultam em \n\n \n\n( ) ( ) ( )\n\n( ) ( ) ( )\n\n31 2\n2 3 3 1 1 2\n\n31 2\n3 2 1 3 2 1\n\n1 1 1\n          \n\ndet( ) det( ) det( )\n\n1 1 1\n          \n\ndet( ) det( ) det( )\n\nNN N\ny y y y y y\n\nx J x J x J\n\nNN N\nx x x x x x\n\ny J y J y J\n\n?? ?? = ? = ? = ?? ? ? ?\n??\n?\n? ?? ?\n? = ? = ? = ?\n\n? ? ???\n\n (A7.13) \n\n \n\n( )( ) ( )( )12131312)det( yyxxyyxxJ ?????=  (A7.14)  \n \n\n Substituindo-se as express\u00f5es da Eq. (A7.13) na Eq. (A7.6), e reconhecendo-se que o \n\ngradiente de p \u00e9 definido como \n\n \n\nj\ny\np\n\ni\nx\np\n\np \u02c6\u02c6\n?\n?\n\n+\n?\n?\n\n=?  (A7.15) \n\n \n\n pode-se reescrev\u00ea-lo na forma \n\n \n\n( ) ( ) ( ) ( )\n\n( ) ( ) ( ) ( )\n\n2 1 3 1 3 1 2 1\n\n3 1 2 1 2 1 3 1\n\n\u02c6\ndet( )\n\n\u02c6           \ndet( )\n\np p y y p p y y\np i\n\nJ\n\np p x x p p x x\nj\n\nJ\n\n? ? ? ? ?? ?\n? = +? ?\n\n? ?\n\n? ? ? ? ?? ?\n+ ? ?\n? ?\n\n (A7.16) \n\n \n\nPara simplificar a nomenclatura e facilitar a compara\u00e7\u00e3o com as dedu\u00e7\u00f5es utilizadas \n\nfreq\u00fcentemente na literatura (FUNG et al., 1991), adotar-se-\u00e1 a seguinte conven\u00e7\u00e3o \n\n \n\n1 3 2 2 1 3 3 2 1\n\n1 2 3 2 3 1 3 1 2\n\n                            \n\n                            \n\na x x a x x a x x\n\nb y y b y y b y y\n\n= ? = ? = ?\n\n= ? = ? = ?\n (A7.17)  \n\n\n\n ANEXO 7 -  C\u00c1LCULO DOS FLUXOS EM ELEMENTOS TRIANGULARES 239 \n\n \n \n \n\n \n\nonde 1, 2 e 3 s\u00e3o os n\u00f3s do elemento triangular dado na Fig. A7.1. Reescrevendo a Eq. \n\n(A7.16), \u00e9 poss\u00edvel mostrar que \n\n \n\n( )\n3\n\n1\n\n1 \u02c6 \u02c6\n2 i i ii\n\np b i a j p\nA =\n\n? = +?  (A7.18) \n\n \n\nonde, por conveni\u00eancia, o determinante da matriz jacobiana foi substitu\u00eddo pelo dobro da \u00e1rea, \n\nA, do tri\u00e2ngulo. \n\nSubstituindo-se a Eq. (A7.18) na express\u00e3o do termo de fluxo discretizado, \n\n \n\n( ). .\nV S\n\nk p dV k p dS? ?? ? = ?? ?  (A7.19) \n\n \n\nchega-se a \n \n\n( ) ( )\n3\n\n1\n\n1 \u02c6 \u02c6. .\n2 i i iiV S\n\nk p dV b i a j p k dS\nA\n\n? ?\n=\n\n? ? = +?? ?  (A7.20) \n\n \n\nA quest\u00e3o agora \u00e9 determinar o produto escalar da Eq. (A7.20). O vetor \u00e1rea presente \n\nnesta express\u00e3o deve ser definido de tal forma que a sua dire\u00e7\u00e3o normal aponte para fora do \n\nvolume de controle, pois garante que a forma usual do balan\u00e7o de massa no volume de \n\ncontrole seja satisfeito \n\n \n\n( )entra sai pi\npi\n\nM\nM M V dS\n\nt\n?\n\n?\n? = ? ? =\n\n??  (A7.21) \n\n \n\nonde entraM  e saiM  s\u00e3o os fluxos que entram e saem do volume de controle e /M t? ?  \u00e9 a sua \n\nvaria\u00e7\u00e3o de massa. \n\nAdotando um sentido anti-hor\u00e1rio de integra\u00e7\u00e3o na superf\u00edcie, pode-se mostrar \n\n(MALISKA, 2004) que o vetor normal \u00e0 determinada superf\u00edcie, Sd , estar\u00e1 sempre se \n\ndirigido para fora do volume de controle se for expresso como \n\n \n\njdxidySd \u02c6\u02c6 ?=  (A7.22) \n\n\n\n240 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nque escrevendo em termos das coordenadas locais (?, ?) e utilizando a regra da cadeia, chega-\n\nse a \n\n \n\njd\nx\n\nd\nx\n\nid\ny\n\nd\ny\n\nSd \u02c6\u02c6 ??\n?\n\n?\n??\n?\n\n?\n?\n?\n\n+\n?\n?\n\n???\n?\n\n?\n??\n?\n\n?\n?\n?\n\n+\n?\n?\n\n= ?\n?\n\n?\n?\n\n?\n?\n\n?\n?\n\n (A7.23) \n\n \n\nSubstituindo-se a Eq. (A7.23) em (A7.20), obt\u00e9m-se \n\n \n\n( ) ( )\n3\n\n1\n\n1 \u02c6 \u02c6. .\n2\n\n\u02c6 \u02c6                                       \n\ni i i\niV S\n\nk p dV b i a j p k\nA\n\ny y x x\nd d i d d j\n\n? ?\n\n? ? ? ?\n? ? ? ?\n\n=\n\n? ? = +\n\n? ?? ? ? ?? ? ? ?\n+ ? +? ?? ? ? ?? ? ? ?? ? ? ?? ?\n\n?? ?\n (A7.24) \n\n \n\nEm uma situa\u00e7\u00e3o bidimensional, o tensor k  \u00e9 escrito como \n\n \n\n?\n?\n\n?\n?\n?\n\n?\n=\n\nyyyx\n\nxyxx\n\nkk\nkk\n\nk   (A7.25) \n\n \n\n e substituindo-o na Eq. (A7.24), realizando-se o produto escalar, chega-se a \n\n \n\n( ) ( )\n( )\n\n( )\n\n1 1 2 2 3 3\n\n1 1 2 2 3 3\n\n1 1 2 2 3 3\n\n1\n.\n\n2\n\n                                   \n\n                                   \n\nxx\nV S\n\nxy\n\nyx\n\ny y\nk p dV k b p b p b p d d\n\nA\n\ny y\nk a p a p a p d d\n\nx x\nk b p b p b p d d\n\n? ? ? ?\n? ?\n\n? ? ?\n? ?\n\n? ? ?\n? ?\n\n? ? ?? ?\n? ? = + + + +? ? ?? ?? ??\n\n? ?? ?\n+ + + + +? ?? ?? ?\n\n? ?\n? + + +\n\n? ?\n\n? ?\n\n( )1 1 2 2 3 3                                   yy\nx x\n\nk a p a p a p d d? ? ?\n? ?\n\n? ?\n+? ?\n\n? ?\n?? ?? ?\n\n? + + + ?? ?? ?? ??\n\n (A7.26) \n\n            \n\n Substituindo-se as Eq. (A7.11) e (A7.12) em (A7.26), obt\u00e9m-se \n \n\n\n\n ANEXO 7 -  C\u00c1LCULO DOS FLUXOS EM ELEMENTOS TRIANGULARES 241 \n\n \n \n \n\n \n\n( ) ( ) ( )\n( ) ( )\n( ) ( )\n\n1 1 2 2 3 3 2 3\n\n1 1 2 2 3 3 2 3\n\n1 1 2 2 3 3 3 2\n\n1\n.\n\n2\n                                   \n\n                                   \n\n                        \n\nxx\nV S\n\nxy\n\nyx\n\nk p dV k b p b p b p b d b d\nA\n\nk a p a p a p b d b d\n\nk b p b p b p a d a d\n\n? ? ? ?\n\n? ? ?\n\n? ? ?\n\n? ? = + + ? +??\n\n+ + + ? +\n\n? + + ? +\n\n? ?\n\n( ) ( )1 1 2 2 3 3 3 2           yyk a p a p a p a d a d? ? ?? + + ? ??\n\n (A7.27) \n\n \n\nPercebe-se que todos os termos do integrando da Eq. (A7.27), com exce\u00e7\u00e3o da \n\nmobilidade ?, s\u00e3o constantes dentro do elemento, pois dependem apenas dos valores nodais, e \n\npodem ser tirados para fora da integral, na forma \n\n \n\n( ) ( )\n( )\n\n( )\n\n1 1 2 2 3 3\n\n1 1 2 2 3 3 2 3\n\n1 1 2 2 3 3\n\n1\n.\n\n2\n\n                                 \n\n1\n                                 \n\n2\n\n                               \n\nxx\nV\n\nxy\nS S\n\nyx\n\nk p dV k b p b p b p\nA\n\nk a p a p a p b d b d\n\nk b p b p b p\nA\n\n?\n\n? ? ? ?\n\n? ? = + + +??\n\n? ?\n?+ + + ? +? ??\n? ?\n\n?+ ? + + +?\n\n?\n\n? ?\n\n( )1 1 2 2 3 3 3 2  yy\nS S\n\nk a p a p a p a d a d? ? ? ?\n? ?\n\n? + + ?? ? ??\n? ?\n? ?\n\n (A7.28)  \n\n \n\nNeste momento torna-se necess\u00e1ria a defini\u00e7\u00e3o dos sub-volumes de controle, pois s\u00e3o \n\nsobre suas faces que a integra\u00e7\u00e3o de superf\u00edcie \u00e9 efetuada. A Fig. A7.2 apresenta os sub-\n\nvolumes nos planos f\u00edsico e transformado. Nota-se que cada um dos tr\u00eas sub-volumes \n\npertencentes a um elemento triangular far\u00e3o parte de tr\u00eas volumes de controle distintos. Estes \n\nvolumes de controle apresentam-se numerados de 1 a 3 no plano f\u00edsico da Fig. A7.2. Deve-se \n\nnotar tamb\u00e9m que os pontos de integra\u00e7\u00e3o est\u00e3o localizados no centro das faces que separam \n\nos sub-volumes num mesmo elemento. \n\n \n\n \n\n\n\n242 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n \n\nFig. A7.2 - Elemento triangular, destacando os sub-volumes (Svc) e os pontos de integra\u00e7\u00e3o (ip) \n\n \n\n \n\nOs sub-volumes s\u00e3o constru\u00eddos a partir de retas que saem do ponto m\u00e9dio de uma \n\nface at\u00e9 o baricentro do tri\u00e2ngulo. Portanto, as coordenadas x e y, no plano f\u00edsico, e ? e ?, no \n\nplano transformado, do ponto central ser\u00e3o dadas por \n\n \n3 3\n\n1 1\n/ 3                           / 3i i\n\ni i\nx x y y\n\n= =\n\n= =? ?  (A7.29) \n\ne \n3 3\n\n1 1\n\n/ 3 1/ 3                / 3 1/ 3i i\ni i\n\n? ? ? ?\n= =\n\n= = = =? ?  (A7.30) \n\n \n\nAssumindo que a integra\u00e7\u00e3o da mobilidade na superf\u00edcie de um volume de controle \n\npossa ser representada pelo valor m\u00e9dio nesta superf\u00edcie, ent\u00e3o as integrais da Eq. (A7.28), \n\npor inspe\u00e7\u00e3o da Fig. A7.2, resultam em dois poss\u00edveis valores em cada ponto de integra\u00e7\u00e3o \n\n \n\n( ) ( )\n\n( ) ( )\n\n( ) ( )\n\n1 11 1\n1 1\n\n2 22 2\n2 2\n\n3 33 3\n3 3\n\n1 1\n            \n\n3 6\n\n1 1\n           \n\n6 3\n\n1 1\n            \n\n6 6\n\nip ipSip Sip\nSip Sip\n\nip ipSip Sip\nSip Sip\n\nip ipSip Sip\nSip Sip\n\nd d\n\nd d\n\nd d\n\n? ? ? ? ? ? ? ? ? ?\n\n? ? ? ? ? ? ? ? ? ?\n\n? ? ? ? ? ? ? ? ? ?\n\n= ? = \u00b1 = ? = \u00b1\n\n= ? = \u00b1 = ? = \u00b1\n\n= ? = \u00b1 = ? = \u00b1\n\n? ?\n\n? ?\n\n? ?\n\n  (A7.31) \n\n \n\n\n\n ANEXO 7 -  C\u00c1LCULO DOS FLUXOS EM ELEMENTOS TRIANGULARES 243 \n\n \n \n \n\n \n\nonde Sip1 \u00e9 a superf\u00edcie que cont\u00e9m o ponto de integra\u00e7\u00e3o 1, e assim por diante. A defini\u00e7\u00e3o \n\nde que sinal dever\u00e1 ser utilizado no equacionamento depender\u00e1 do sub-volume que estar\u00e1 \n\nsendo submetido \u00e0 integra\u00e7\u00e3o. Deve-se lembrar que a regra adotada para a determina\u00e7\u00e3o das \n\n\u00e1reas consiste em percorrer no sentido anti-hor\u00e1rio os sub-volumes de controle, como \n\ndemonstram as setas apresentadas na Fig. A7.3, calculando-se ??  e ?? . \n\n \n\n \n\n \n\nFig. A7.3 - Elemento triangular, destacando, atrav\u00e9s de setas, a conven\u00e7\u00e3o adotada para a defini\u00e7\u00e3o do sinal das \n\nintegrais de superf\u00edcie  \n\n \n\n A implementa\u00e7\u00e3o computacional da Eq. (A7.28) para cada um dos sub-volumes de \n\ncontrole do elemento pode ser facilitada se o gradiente de press\u00e3o contido nela for escrito de \n\nforma diferente para cada sub-volume de controle: \n\n \n\nScv1:  ( ) ( ) ( ) ( ) ( )\n3\n\n2 1 3 1 3 1 2 1\n1\n\n\u02c6 \u02c6 \u02c6\ni i i\n\ni\nb i a j P p p y y p p y y i\n\n=\n\n+ = ? ? ? ? ? +? ?? ??                    \n\n                                         ( )( ) ( ) ( )3 1 2 1 2 1 3 1 \u02c6p p x x p p x x j+ ? ? ? ? ?? ?? ?  \n\n                                   ( ) ( ) ( ) ( )2 1 2 3 1 3 2 1 2 3 1 3\u02c6 \u02c6p p b p p b i p p a p p a j= ? + ? + ? + ?? ? ? ?? ? ? ?  \n\n (A7.32)  \n\n \n\nScv2:  ( ) ( )( ) ( ) ( )\n3\n\n1 2 2 3 3 2 1 2\n1\n\n\u02c6 \u02c6 \u02c6\ni i i\n\ni\nb i a j P p p y y p p y y i\n\n=\n\n+ = ? ? + ? ? +? ?? ??                    \n\n                                         ( ) ( ) ( ) ( )1 2 3 2 3 2 2 1 \u02c6p p x x p p x x j+ ? ? + ? ?? ?? ?  \n\n\n\n244 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n                                   ( ) ( ) ( ) ( )1 2 1 3 2 3 1 2 1 3 2 3\u02c6 \u02c6p p b p p b i p p a p p a j= ? + ? + ? + ?? ? ? ?? ? ? ?  \n\n (A7.33)  \n\n \n\nScv3:  ( ) ( )( ) ( ) ( )\n3\n\n1 3 2 3 2 3 3 1\n1\n\n\u02c6 \u02c6 \u02c6\ni i i\n\ni\nb i a j P p p y y p p y y i\n\n=\n\n+ = ? ? + ? ? +? ?? ??                             \n\n                                         ( ) ( ) ( ) ( )1 3 3 2 2 3 1 3 \u02c6p p x x p p x x j+ ? ? + ? ?? ?? ?  \n\n                                   ( ) ( ) ( ) ( )1 3 1 2 3 2 1 3 1 2 3 2\u02c6 \u02c6p p b p p b i p p a p p a j= ? + ? + ? + ?? ? ? ?? ? ? ?  \n\n (A7.34)  \n\n \n\n O gradiente de press\u00e3o escrito desta forma, diferente para cada sub-volume de \n\ncontrole, permite obter equa\u00e7\u00f5es discretizadas parecidas com as obtidas com o m\u00e9todo dos \n\nvolumes finitos tradicional, isto \u00e9, em cada uma delas o coeficiente da diagonal ser\u00e1 \n\ndeterminado diretamente pela soma dos coeficientes dos sub-volumes de controle vizinhos. \n\nIsso ser\u00e1 constatado nas equa\u00e7\u00f5es deduzidas a seguir. \n\n \n\nDedu\u00e7\u00e3o das equa\u00e7\u00f5es para o scv1. Para o sub-volume 1 da Fig. A7.3, por exemplo, \n\nos valores utilizados para a integral de superf\u00edcie em ? e ? nos pontos de integra\u00e7\u00e3o 1 e 2 \n\nser\u00e3o, respectivamente  \n \n\n1 1\n1 1 1 111\n\n1 11 1\n\n1 1\n           \n\n3 6\nSvc Svc\n\nip ip ip ipSipSip\nSip SipSvc Svc\n\nd d? ? ? ? ? ? ? ? ? ?= ? = ? = ? =? ?  (A7.35)  \n\ne \n\n1 1\n2 2 2 22 2\n\n2 21 1\n\n1 1\n           \n\n6 3\nSvc Svc\n\nip ip ip ipSip Sip\nSip SipSvc Svc\n\nd d? ? ? ? ? ? ? ? ? ?= ? = ? = ? =? ?   (A7.36) \n\n \n\nonde \n1\n\n2\n\nSvc\n\nSip\n??  representa o deslocamento na dire\u00e7\u00e3o ?  avaliada no ponto de integra\u00e7\u00e3o 2 na \n\nequa\u00e7\u00e3o do sub-volume de controle 1. Para os outros termos a explica\u00e7\u00e3o \u00e9 an\u00e1loga. A partir \n\ndeste ponto ser\u00e1 utilizada esta simbologia para a representa\u00e7\u00e3o das integrais nos pontos de \n\nintegra\u00e7\u00e3o. Assim, a Eq. (A7.28) ser\u00e1 escrita na forma \n\n \n\n\n\n ANEXO 7 -  C\u00c1LCULO DOS FLUXOS EM ELEMENTOS TRIANGULARES 245 \n\n \n \n \n\n \n\n( ) ( ) ( ){ 2 1 2 3 1 3\n1\n\n1\n.\n\n2 xxscv\nk p dV k p p b p p b\n\nA\n?? ? = ? + ? +? ?? ??    \n\n                            ( ) ( ) }2 1 2 3 1 3 2 1 2 3 1 21 1 1 16 3 3 6xy ip ip ip ipk p p a p p a b b? ? ? ?\n? ?? ? ? ?+ ? + ? + ? ? ? +? ? ? ? ? ?? ?? ?\n\n? ? ? ?? ?\n  \n\n   ( ) ( ){ 2 1 2 3 1 312 yxk p p b p p bA+ ? ? + ? +? ?? ?                             \n\n                            ( ) ( ) }2 1 2 3 1 3 2 1 2 3 1 21 1 1 16 3 3 6yy ip ip ip ipk p p a p p a a a? ? ? ?\n? ?? ? ? ?? ? + ? ? + + ? ?? ? ? ? ? ?? ?? ?\n\n? ? ? ?? ?\n \n\n (A7.37)  \n\n \n\nou colocando em evid\u00eancia os valores que multiplicam a mobilidade de um mesmo ponto de \n\nintegra\u00e7\u00e3o, \n\n \n\n( ) ( ) ( ){ 2 1 2 3 1 3\n1\n\n. xx\nscv\n\nk p dV k p p b p p b? ?? ? = ? + ? +? ?? ???    \n\n       ( ) ( ) 322 1 2 3 1 3 6 3xy\nbb\n\nk p p a p p a ? ??+ ? + ? + +? ?? ? ? ?? ? ?\n  \n\n    ( ) ( )2 1 2 3 1 3yxk p p b p p b?+ ? + ? +? ?? ??                             \n\n       ( ) ( ) 1322 1 2 3 1 3 6 3 2\nip\n\nyy\naa\n\nk p p a p p a\nA\n\n??? ??+ ? + ? + +? ? ?? ? ? ?? ? ??\n  \n\n            ( ) ( ){ 2 1 2 3 1 3xxk p p b p p b?+ ? + ? +? ?? ??    \n     ( ) ( ) 322 1 2 3 1 3 3 6xy\n\nbb\nk p p a p p a ? ??+ ? + ? + +? ?? ? ? ?? ? ?\n\n  \n\n  ( ) ( )2 1 2 3 1 3yxk p p b p p b?+ ? + ? +? ?? ??                                   \n\n                             ( ) ( ) 2322 1 2 3 1 3 3 6 2\nip\n\nyy\naa\n\nk p p a p p a\nA\n\n??? ??+ ? + ? +? ? ?? ? ? ?? ? ??\n (A7.38)  \n\n   \n\nDeve-se notar que o valor da mobilidade calculado em cada ponto de integra\u00e7\u00e3o \n\nmultiplica os tr\u00eas valores nodais da press\u00e3o. A equa\u00e7\u00e3o anterior pode, ainda, ser reescrita \n\nagrupando os termos que multiplicam cada diferen\u00e7a de press\u00e3o, na forma \n\n \n\n\n\n246 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\n( ) ( ) ( )\n( ) ( )\n\n1 1\n\n2 2\n\n1 13 3 1 12 2 1\n1\n\n2 3 1 2 113 12\n\n.\n\n                                 \n\nip ip\n\nip ip\n\nip\nscv\n\nip\n\nk p dV p p p p\n\np p p p\n\n? ? ? ?\n\n? ? ?\n\n? ?? ? = ? + ? +? ?\n\n? ?+ ? + ?? ?\n\n?\n (A7.39) \n\n \n\nonde \n\n \n\n1\n\n3 3 3 33 32 2\n13 2 6 3 2 6 3ip\n\nxx xy yx yyk b k a k b k ab ab a\nA A\n\n?\n+ +? ? ? ?? ? ? ?= + + +? ? ? ?? ? ? ?\n\n? ? ? ?? ? ? ?\n (A7.40) \n\n1\n\n2 2 2 23 32 2\n12 2 6 3 2 6 3ip\n\nxx xy yx yyk b k a k b k ab ab a\nA A\n\n?\n+ +? ? ? ?? ? ? ?= + + +? ? ? ?? ? ? ?\n\n? ? ? ?? ? ? ?\n (A7.41) \n\n2\n\n3 3 3 33 32 2\n13 2 3 6 2 6 3ip\n\nxx xy yx yyk b k a k b k ab ab a\nA A\n\n?\n+ +? ? ? ?? ? ? ?= + + +? ? ? ?? ? ? ?\n\n? ? ? ?? ? ? ?\n (A7.42) \n\n2\n\n2 2 2 23 32 2\n12 2 3 6 2 6 3ip\n\nxx xy yx yyk b k a k b k ab ab a\nA A\n\n?\n+ +? ? ? ?? ? ? ?= + + +? ? ? ?? ? ? ?\n\n? ? ? ?? ? ? ?\n (A7.43) \n\n \n\nA primeira parcela da Eq. (A7.39) corresponde ao fluxo entre os sub-volumes de \n\ncontrole 1 e 3 (Fig. A7.3), e a segunda parcela corresponde ao fluxo entre os sub-volumes de \n\ncontrole 1 e 2. \n\n Pode-se, ainda, reduzir a Eq. (A7.39) em uma forma tal em que s\u00e3o explicitadas os \n\ntermos erroneamente denominados de transmissibilidades. Assim,  \n\n \n\n( ) ( ) ( )13 3 1 12 2 1\n1\n\n.\nscv\n\nk p dV p p p p?? ? = ? ? + ? ??  (A7.44) \n\n \n\nonde \n\n1 213 1 13 2 13ip ipip ip\n? ? ? ?? = +  (A7.45) \n\n1 212 1 12 2 12ip ipip ip\n? ? ? ?? = +  (A7.46) \n\n  \n\nApenas nos casos envolvendo escoamentos monof\u00e1sicos e com propriedades \n\nconstantes, isto \u00e9, quando as mobilidades nas Eqs. (A7.45) e (A7.46) s\u00e3o id\u00eanticas, \u00e9 que \n\npode-se obter e utilizar a tradicional express\u00e3o utilizada em outros trabalhos (FUNG et al., \n\n1991) \n\n\n\n ANEXO 7 -  C\u00c1LCULO DOS FLUXOS EM ELEMENTOS TRIANGULARES 247 \n\n \n \n \n\n \n\n4\nxx i j xy j i yx j i yy i j\n\nij\n\nk bb k a b k b a k a a\nA\n\n+ + +? ?\n? = ?? ?\n\n? ?\n (A7.47) \n\n \n\nque \u00e9 obtida pela manipula\u00e7\u00e3o das Eqs. (A7.40) a (A7.43), e no caso particular analisado i \n\nassume valor 1 e j assume 2 e 3, resultando nas transmissibilidade 12?  e 13? , \n\nrespectivamente. Esta restri\u00e7\u00e3o na utiliza\u00e7\u00e3o da Eq. (A7.47) n\u00e3o \u00e9 evidente nos trabalhos \n\npublicados na literatura espec\u00edfica da \u00e1rea do petr\u00f3leo. \n\n \n\n \n\nA7.1. Bibliografia \n \n\nFUNG, L. S., HIEBERT, A. D. and NGHIEM, L., 1991. Reservoir Simulation With a \n\nControl-Volume Finite-Element Method, SPE paper 21224 presented at the 11th SPE \n\nSymposium on Reservoir Simulation, Anaheim, California, February 17-20. \n\nMALISKA, C. R., 2004. Transfer\u00eancia de Calor e Mec\u00e2nica dos Fluidos Computacional, 2\u00aa.   \n\nEdi\u00e7\u00e3o revista e ampliada, Livros T\u00e9cnicos e Cient\u00edficos Editora, Rio de Janeiro. \n\n \n\n\n\n \n\n\n\n249 \n\nAnexo    \n\n8 \nCCOONNSSIIDDEERRAA\u00c7\u00c7\u00d5\u00d5EESS  SSOOBBRREE  AA      \nUUTTIILLIIZZAA\u00c7\u00c7\u00c3\u00c3OO  DDAASS  FFUUNN\u00c7\u00c7\u00d5\u00d5EESS  DDEE  FFOORRMMAA  NNAA  \nAAVVAALLIIAA\u00c7\u00c7\u00c3\u00c3OO  DDAASS  MMOOBBIILLIIDDAADDEESS  NNAA  EEQQUUAA\u00c7\u00c7\u00c3\u00c3OO  DDAA  PPRREESSSS\u00c3\u00c3OO  \n\n \n\n \n\n \n\nNesta se\u00e7\u00e3o s\u00e3o apresentados os detalhes referentes \u00e0 obten\u00e7\u00e3o das equa\u00e7\u00f5es \n\nempregadas nos problemas do Cap. 8 quando \u00e9 utilizada a fun\u00e7\u00e3o de forma como fun\u00e7\u00e3o de \n\ninterpola\u00e7\u00e3o na equa\u00e7\u00e3o da press\u00e3o. Neste caso a fun\u00e7\u00e3o de interpola\u00e7\u00e3o upwind continua \n\nsendo usada apenas na equa\u00e7\u00e3o da satura\u00e7\u00e3o. \n\nPara que seja poss\u00edvel utilizar diferentes fun\u00e7\u00f5es de interpola\u00e7\u00e3o nas duas equa\u00e7\u00f5es \u00e9 \n\nnecess\u00e1rio reescrev\u00ea-las, isto \u00e9, escrev\u00ea-las diferentemente do que aparece no texto desta tese. \n\nPara demonstrar o procedimento de obten\u00e7\u00e3o destas novas equa\u00e7\u00f5es, considerar-se-\u00e1, para \n\nsimplificar, que os fluidos s\u00e3o incompress\u00edveis. Assim, como visto no Cap. 5, a equa\u00e7\u00e3o da \n\nsatura\u00e7\u00e3o tem a forma  \n\n \n\n( ) ( )( )om m m i m PP\ni PP\n\nV\ns s k p S q\n\nt\n?\n\n?\n? ?\n\n?? ? ? = ? ?? +? ??? ?\n?  (A8.1)  \n\n \n\ne a equa\u00e7\u00e3o da press\u00e3o \n\n \n\n( )( ) 0T i w o P\ni P\n\nk p S q q?\n? ?\n\n? ?? + + =?       (A8.2)                 \n\n \n\nonde oT w? ? ?= + . Essas s\u00e3o as Eq. (5.1) e (5.3) na sua forma simplificada.  \n\n Note que se for utilizada a fun\u00e7\u00e3o upwind na avalia\u00e7\u00e3o da mobilidade da equa\u00e7\u00e3o da \n\nsatura\u00e7\u00e3o, ao mesmo tempo que \u00e9 utilizada uma fun\u00e7\u00e3o diferente na avalia\u00e7\u00e3o da mobilidade \n\ntotal na equa\u00e7\u00e3o da press\u00e3o, existir\u00e1 uma clara inconsist\u00eancia que deve-se ao fato de que a \n\nequa\u00e7\u00e3o da press\u00e3o \u00e9 obtida pela substitui\u00e7\u00e3o das equa\u00e7\u00f5es de satura\u00e7\u00e3o de cada fase na \n\n\n\n250 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MEC\u00c2NICA  \n\n \n\n \n\nequa\u00e7\u00e3o da restri\u00e7\u00e3o. Por isso prop\u00f5e-se reescrever a equa\u00e7\u00e3o da satura\u00e7\u00e3o a fim de obter uma \n\nformula\u00e7\u00e3o consistente. \n\n Reconhecendo que o fluxo fracion\u00e1rio fm \u00e9 definido como a rela\u00e7\u00e3o entre a mobilidade \n\nda fase e a mobilidade total, \n\n \n\nm\nm\n\nT\n\nf\n?\n?\n\n=  (A8.3)              \n\n \n\npode-se mostrar que a equa\u00e7\u00e3o da satura\u00e7\u00e3o, Eq. (A8.1), pode ser escrita como \n\n \n\n ( ) ( )( )\ni\n\no\nm m m T i m PP\n\ni PP\n\nV\ns s f k p S q\n\nt\n?\n\n?\n? ?\n\n?? ? ? = ? ?? +? ??? ?\n?  (A8.4)  \n\n \n\nque apresenta termos que ser\u00e3o avaliados com diferentes fun\u00e7\u00f5es de forma: \n\n \n\n \nim\n\nf  :  Fun\u00e7\u00e3o de interpola\u00e7\u00e3o upwind \n\n T?  :  Fun\u00e7\u00f5es de forma \n\n \n\nComo o somat\u00f3rio dos fluxos fracion\u00e1rios de cada fase \u00e9 igual a unidade, percebe-se \n\nque a formula\u00e7\u00e3o que utiliza fun\u00e7\u00f5es de forma na avalia\u00e7\u00e3o da mobilidade total na equa\u00e7\u00e3o da \n\npress\u00e3o, Eq. (A8.2), tornou-se consistente. \n\n \n\n \n\n\n<<\n  /ASCII85EncodePages false\n  /AllowTransparency false\n  /AutoPositionEPSFiles true\n  /AutoRotatePages /None\n  /Binding /Left\n  /CalGrayProfile (Dot Gain 20%)\n  /CalRGBProfile (sRGB IEC61966-2.1)\n  /CalCMYKProfile (U.S. Web Coated \\050SWOP\\051 v2)\n  /sRGBProfile (sRGB IEC61966-2.1)\n  /CannotEmbedFontPolicy /Error\n  /CompatibilityLevel 1.4\n  /CompressObjects /Tags\n  /CompressPages true\n  /ConvertImagesToIndexed true\n  /PassThroughJPEGImages true\n  /CreateJDFFile false\n  /CreateJobTicket false\n  /DefaultRenderingIntent /Default\n  /DetectBlends true\n  /ColorConversionStrategy /LeaveColorUnchanged\n  /DoThumbnails false\n  /EmbedAllFonts true\n  /EmbedJobOptions true\n  /DSCReportingLevel 0\n  /EmitDSCWarnings false\n  /EndPage -1\n  /ImageMemory 1048576\n  /LockDistillerParams false\n  /MaxSubsetPct 100\n  /Optimize true\n  /OPM 1\n  /ParseDSCComments true\n  /ParseDSCCommentsForDocInfo true\n  /PreserveCopyPage true\n  /PreserveEPSInfo true\n  /PreserveHalftoneInfo false\n  /PreserveOPIComments false\n  /PreserveOverprintSettings true\n  /StartPage 1\n  /SubsetFonts true\n  /TransferFunctionInfo /Apply\n  /UCRandBGInfo /Preserve\n  /UsePrologue false\n  /ColorSettingsFile ()\n  /AlwaysEmbed [ true\n  ]\n  /NeverEmbed [ true\n  ]\n  /AntiAliasColorImages false\n  /DownsampleColorImages true\n  /ColorImageDownsampleType /Bicubic\n  /ColorImageResolution 300\n  /ColorImageDepth -1\n  /ColorImageDownsampleThreshold 1.50000\n  /EncodeColorImages true\n  /ColorImageFilter /DCTEncode\n  /AutoFilterColorImages true\n  /ColorImageAutoFilterStrategy /JPEG\n  /ColorACSImageDict&lt;<\n    /QFactor 0.15\n    /HSamples [1 1 1 1] /VSamples [1 1 1 1]\n  >>\n  /ColorImageDict&lt;<\n    /QFactor 0.15\n    /HSamples [1 1 1 1] /VSamples [1 1 1 1]\n  >>\n  /JPEG2000ColorACSImageDict&lt;<\n    /TileWidth 256\n    /TileHeight 256\n    /Quality 30\n  >>\n  /JPEG2000ColorImageDict&lt;<\n    /TileWidth 256\n    /TileHeight 256\n    /Quality 30\n  >>\n  /AntiAliasGrayImages false\n  /DownsampleGrayImages true\n  /GrayImageDownsampleType /Bicubic\n  /GrayImageResolution 300\n  /GrayImageDepth -1\n  /GrayImageDownsampleThreshold 1.50000\n  /EncodeGrayImages true\n  /GrayImageFilter /DCTEncode\n  /AutoFilterGrayImages true\n  /GrayImageAutoFilterStrategy /JPEG\n  /GrayACSImageDict&lt;<\n    /QFactor 0.15\n    /HSamples [1 1 1 1] /VSamples [1 1 1 1]\n  >>\n  /GrayImageDict&lt;<\n    /QFactor 0.15\n    /HSamples [1 1 1 1] /VSamples [1 1 1 1]\n  >>\n  /JPEG2000GrayACSImageDict&lt;<\n    /TileWidth 256\n    /TileHeight 256\n    /Quality 30\n  >>\n  /JPEG2000GrayImageDict&lt;<\n    /TileWidth 256\n    /TileHeight 256\n    /Quality 30\n  >>\n  /AntiAliasMonoImages false\n  /DownsampleMonoImages true\n  /MonoImageDownsampleType /Bicubic\n  /MonoImageResolution 1200\n  /MonoImageDepth -1\n  /MonoImageDownsampleThreshold 1.50000\n  /EncodeMonoImages true\n  /MonoImageFilter /CCITTFaxEncode\n  /MonoImageDict&lt;<\n    /K -1\n  >>\n  /AllowPSXObjects false\n  /PDFX1aCheck false\n  /PDFX3Check false\n  /PDFXCompliantPDFOnly false\n  /PDFXNoTrimBoxError true\n  /PDFXTrimBoxToMediaBoxOffset [\n    0.00000\n    0.00000\n    0.00000\n    0.00000\n  ]\n  /PDFXSetBleedBoxToMediaBox true\n  /PDFXBleedBoxToTrimBoxOffset [\n    0.00000\n    0.00000\n    0.00000\n    0.00000\n  ]\n  /PDFXOutputIntentProfile ()\n  /PDFXOutputCondition ()\n  /PDFXRegistryName (http://www.color.org)\n  /PDFXTrapped /Unknown\n\n  /Description&lt;<\n    /ENU (Use these settings to create PDF documents with higher image resolution for high quality pre-press printing. The PDF documents can be opened with Acrobat and Reader 5.0 and later. These settings require font embedding.)\n    /JPN&lt;FEFF3053306e8a2d5b9a306f30019ad889e350cf5ea6753b50cf3092542b308030d730ea30d730ec30b9537052377528306e00200050004400460020658766f830924f5c62103059308b3068304d306b4f7f75283057307e305930023053306e8a2d5b9a30674f5c62103057305f00200050004400460020658766f8306f0020004100630072006f0062006100740020304a30883073002000520065006100640065007200200035002e003000204ee5964d30678868793a3067304d307e305930023053306e8a2d5b9a306b306f30d530a930f330c8306e57cb30818fbc307f304c5fc59808306730593002>\n    /FRA&lt;FEFF004f007000740069006f006e007300200070006f0075007200200063007200e900650072002000640065007300200064006f00630075006d0065006e00740073002000500044004600200064006f007400e900730020006400270075006e00650020007200e90073006f006c007500740069006f006e002000e9006c0065007600e9006500200070006f0075007200200075006e00650020007100750061006c0069007400e90020006400270069006d007000720065007300730069006f006e00200070007200e9007000720065007300730065002e0020005500740069006c006900730065007a0020004100630072006f0062006100740020006f00750020005200650061006400650072002c002000760065007200730069006f006e00200035002e00300020006f007500200075006c007400e9007200690065007500720065002c00200070006f007500720020006c006500730020006f00750076007200690072002e0020004c00270069006e0063006f00720070006f0072006100740069006f006e002000640065007300200070006f006c0069006300650073002000650073007400200072006500710075006900730065002e>\n    /DEU&lt;FEFF00560065007200770065006e00640065006e0020005300690065002000640069006500730065002000450069006e007300740065006c006c0075006e00670065006e0020007a0075006d002000450072007300740065006c006c0065006e00200076006f006e0020005000440046002d0044006f006b0075006d0065006e00740065006e0020006d00690074002000650069006e006500720020006800f60068006500720065006e002000420069006c0064006100750066006c00f600730075006e0067002c00200075006d002000650069006e00650020007100750061006c00690074006100740069007600200068006f006300680077006500720074006900670065002000410075007300670061006200650020006600fc0072002000640069006500200044007200750063006b0076006f0072007300740075006600650020007a0075002000650072007a00690065006c0065006e002e00200044006900650020005000440046002d0044006f006b0075006d0065006e007400650020006b00f6006e006e0065006e0020006d006900740020004100630072006f0062006100740020006f0064006500720020006d00690074002000640065006d002000520065006100640065007200200035002e003000200075006e00640020006800f600680065007200200067006500f600660066006e00650074002000770065007200640065006e002e00200042006500690020006400690065007300650072002000450069006e007300740065006c006c0075006e00670020006900730074002000650069006e00650020005300630068007200690066007400650069006e00620065007400740075006e00670020006500720066006f0072006400650072006c006900630068002e>\n    /PTB&lt;FEFF005500740069006c0069007a006500200065007300740061007300200063006f006e00660069006700750072006100e700f5006500730020007000610072006100200063007200690061007200200064006f00630075006d0065006e0074006f0073002000500044004600200063006f006d00200075006d00610020007200650073006f006c007500e700e3006f00200064006500200069006d006100670065006d0020007300750070006500720069006f0072002000700061007200610020006f006200740065007200200075006d00610020007100750061006c0069006400610064006500200064006500200069006d0070007200650073007300e3006f0020006d0065006c0068006f0072002e0020004f007300200064006f00630075006d0065006e0074006f0073002000500044004600200070006f00640065006d0020007300650072002000610062006500720074006f007300200063006f006d0020006f0020004100630072006f006200610074002c002000520065006100640065007200200035002e00300020006500200070006f00730074006500720069006f0072002e00200045007300740061007300200063006f006e00660069006700750072006100e700f50065007300200072006500710075006500720065006d00200069006e0063006f00720070006f0072006100e700e3006f00200064006500200066006f006e00740065002e>\n    /DAN&lt;FEFF004200720075006700200064006900730073006500200069006e0064007300740069006c006c0069006e006700650072002000740069006c0020006100740020006f0070007200650074007400650020005000440046002d0064006f006b0075006d0065006e0074006500720020006d006500640020006800f8006a006500720065002000620069006c006c00650064006f0070006c00f80073006e0069006e0067002000740069006c0020007000720065002d00700072006500730073002d007500640073006b007200690076006e0069006e0067002000690020006800f8006a0020006b00760061006c0069007400650074002e0020005000440046002d0064006f006b0075006d0065006e007400650072006e00650020006b0061006e002000e50062006e006500730020006d006500640020004100630072006f0062006100740020006f0067002000520065006100640065007200200035002e00300020006f00670020006e0079006500720065002e00200044006900730073006500200069006e0064007300740069006c006c0069006e0067006500720020006b007200e600760065007200200069006e0074006500670072006500720069006e006700200061006600200073006b007200690066007400740079007000650072002e>\n    /NLD&lt;FEFF004700650062007200750069006b002000640065007a006500200069006e007300740065006c006c0069006e00670065006e0020006f006d0020005000440046002d0064006f00630075006d0065006e00740065006e0020007400650020006d0061006b0065006e0020006d00650074002000650065006e00200068006f00670065002000610066006200650065006c00640069006e00670073007200650073006f006c007500740069006500200076006f006f0072002000610066006400720075006b006b0065006e0020006d0065007400200068006f006700650020006b00770061006c0069007400650069007400200069006e002000650065006e002000700072006500700072006500730073002d006f006d0067006500760069006e0067002e0020004400650020005000440046002d0064006f00630075006d0065006e00740065006e0020006b0075006e006e0065006e00200077006f007200640065006e002000670065006f00700065006e00640020006d006500740020004100630072006f00620061007400200065006e002000520065006100640065007200200035002e003000200065006e00200068006f006700650072002e002000420069006a002000640065007a006500200069006e007300740065006c006c0069006e00670020006d006f006500740065006e00200066006f006e007400730020007a0069006a006e00200069006e006700650073006c006f00740065006e002e>\n    /ESP&lt;FEFF0055007300650020006500730074006100730020006f007000630069006f006e006500730020007000610072006100200063007200650061007200200064006f00630075006d0065006e0074006f0073002000500044004600200063006f006e0020006d00610079006f00720020007200650073006f006c00750063006900f3006e00200064006500200069006d006100670065006e00200071007500650020007000650072006d006900740061006e0020006f006200740065006e0065007200200063006f007000690061007300200064006500200070007200650069006d0070007200650073006900f3006e0020006400650020006d00610079006f0072002000630061006c0069006400610064002e0020004c006f007300200064006f00630075006d0065006e0074006f00730020005000440046002000730065002000700075006500640065006e00200061006200720069007200200063006f006e0020004100630072006f00620061007400200079002000520065006100640065007200200035002e003000200079002000760065007200730069006f006e0065007300200070006f00730074006500720069006f007200650073002e0020004500730074006100200063006f006e0066006900670075007200610063006900f3006e0020007200650071007500690065007200650020006c006100200069006e0063007200750073007400610063006900f3006e0020006400650020006600750065006e007400650073002e>\n    /SUO&lt;FEFF004e00e4006900640065006e002000610073006500740075007300740065006e0020006100760075006c006c006100200076006f0069006400610061006e0020006c0075006f006400610020005000440046002d0061007300690061006b00690072006a006f006a0061002c0020006a006f006900640065006e002000740075006c006f0073007400750073006c00610061007400750020006f006e0020006b006f0072006b006500610020006a00610020006b007500760061006e0020007400610072006b006b007500750073002000730075007500720069002e0020005000440046002d0061007300690061006b00690072006a0061007400200076006f0069006400610061006e0020006100760061007400610020004100630072006f006200610074002d0020006a0061002000520065006100640065007200200035002e00300020002d006f0068006a0065006c006d0061006c006c0061002000740061006900200075007500640065006d006d0061006c006c0061002000760065007200730069006f006c006c0061002e0020004e00e4006d00e4002000610073006500740075006b0073006500740020006500640065006c006c00790074007400e4007600e4007400200066006f006e0074007400690065006e002000750070006f00740075007300740061002e>\n    /ITA&lt;FEFF00550073006100720065002000710075006500730074006500200069006d0070006f007300740061007a0069006f006e00690020007000650072002000630072006500610072006500200064006f00630075006d0065006e00740069002000500044004600200063006f006e00200075006e00610020007200690073006f006c0075007a0069006f006e00650020006d0061006700670069006f00720065002000700065007200200075006e00610020007100750061006c0069007400e00020006400690020007000720065007300740061006d007000610020006d00690067006c0069006f00720065002e0020004900200064006f00630075006d0065006e00740069002000500044004600200070006f00730073006f006e006f0020006500730073006500720065002000610070006500720074006900200063006f006e0020004100630072006f00620061007400200065002000520065006100640065007200200035002e003000200065002000760065007200730069006f006e006900200073007500630063006500730073006900760065002e002000510075006500730074006500200069006d0070006f007300740061007a0069006f006e006900200072006900630068006900650064006f006e006f0020006c002700750073006f00200064006900200066006f006e007400200069006e0063006f00720070006f0072006100740069002e>\n    /NOR&lt;FEFF004200720075006b00200064006900730073006500200069006e006e007300740069006c006c0069006e00670065006e0065002000740069006c002000e50020006f00700070007200650074007400650020005000440046002d0064006f006b0075006d0065006e0074006500720020006d006500640020006800f80079006500720065002000620069006c00640065006f00700070006c00f80073006e0069006e006700200066006f00720020006800f800790020007500740073006b00720069006600740073006b00760061006c00690074006500740020006600f800720020007400720079006b006b002e0020005000440046002d0064006f006b0075006d0065006e0074006500720020006b0061006e002000e50070006e006500730020006d006500640020004100630072006f0062006100740020006f0067002000520065006100640065007200200035002e00300020006f0067002000730065006e006500720065002e00200044006900730073006500200069006e006e007300740069006c006c0069006e00670065006e00650020006b0072006500760065007200200073006b00720069006600740069006e006e00620079006700670069006e0067002e>\n    /SVE&lt;FEFF0041006e007600e4006e00640020006400650020006800e4007200200069006e0073007400e4006c006c006e0069006e006700610072006e00610020006e00e40072002000640075002000760069006c006c00200073006b0061007000610020005000440046002d0064006f006b0075006d0065006e00740020006d006500640020006800f6006700720065002000620069006c0064007500700070006c00f60073006e0069006e00670020006600f60072002000700072006500700072006500730073007500740073006b0072006900660074006500720020006100760020006800f600670020006b00760061006c0069007400650074002e0020005000440046002d0064006f006b0075006d0065006e00740065006e0020006b0061006e002000f600700070006e006100730020006d006500640020004100630072006f0062006100740020006f00630068002000520065006100640065007200200035002e003000200065006c006c00650072002000730065006e006100720065002e00200044006500730073006100200069006e0073007400e4006c006c006e0069006e0067006100720020006b007200e400760065007200200069006e006b006c00750064006500720069006e00670020006100760020007400650063006b0065006e0073006e006900740074002e>\n  >>\n>> setdistillerparams\n<<\n  /HWResolution [2400 2400]\n  /PageSize [612.000 792.000]\n>> setpagedevice"}]}}}