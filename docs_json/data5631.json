{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.09427"}, {"@name": "filename", "#text": "14403_tde.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "CARLOS ROBERTO PORF\u00cdRIO\n\nIMPLANTA\u00c7\u00c3O DE UM CONTROLADOR MULTIMODELOS EM\n\nUMA COLUNA DEPROPANIZADORA INDUSTRIAL\n\nDisserta\u00e7\u00e3o apresentada \u00e0 Escola\nPolit\u00e9cnica  da  Universidade  de\nS\u00e3o Paulo para obten\u00e7\u00e3o do t\u00edtulo\nde Mestre em Engenharia.\n\nS\u00c3O PAULO\nOutubro/2001\n\n\n\nCARLOS ROBERTO PORF\u00cdRIO\n\nIMPLANTA\u00c7\u00c3O DE UM CONTROLADOR MULTIMODELOS EM\n\nUMA COLUNA DEPROPANIZADORA INDUSTRIAL\n\nDisserta\u00e7\u00e3o apresentada \u00e0 Escola\nPolit\u00e9cnica  da  Universidade  de\nS\u00e3o Paulo para obten\u00e7\u00e3o do t\u00edtulo\nde Mestre em Engenharia.\n\n\u00c1rea de Concentra\u00e7\u00e3o:\nEngenharia Qu\u00edmica\n\nOrientador:\nProf. Dr Darci Odloak\n\nS\u00c3O PAULO\nOutubro/2001\n\n\n\n        Porf\u00edrio, Carlos Roberto\n     Implanta\u00e7\u00e3o de um Controlador Multimodelos em uma Coluna\n\nDepropanizadora Industrial.\n        S\u00e3o Paulo, 2001.\n\n      130p.\n\n      Disserta\u00e7\u00e3o (Mestrado) \u2013 Escola Polit\u00e9cnica  da  Universidade  de\nS\u00e3o Paulo. Departamento de Engenharia Qu\u00edmica.\n\n1. Controle de Processo     2. Controle Preditivo   3. Coluna\nDepropanizadora  4.  Controle Multimodelos\n\nI. Universidade de S\u00e3o Paulo.  Escola Polit\u00e9cnica. Departamento de\nEngenharia Qu\u00edmica II. T\n\n\n\ni\n\nA todos os meus mestres, que ao longo de minha\nvida me mostraram o valor da educa\u00e7\u00e3o, e a Deus\npor me dar for\u00e7as para conseguir superar todas as\ndificuldades enfrentadas nesta jornada.\n\n\n\nii\n\nAGRADECIMENTOS\n\nAo Prof. Dr. Darci Odloak pela orienta\u00e7\u00e3o e dedica\u00e7\u00e3o, tornando poss\u00edvel a realiza\u00e7\u00e3o\n\ndeste trabalho.\n\n\u00c0 minha esposa e filho, Ronilda e Gabriel, pela compreens\u00e3o e incentivo durante a\n\nrealiza\u00e7\u00e3o deste trabalho.\n\nAo engenheiro Euclides Almeida Neto pela paci\u00eancia, apoio e incentivo nas\n\nintermin\u00e1veis discuss\u00f5es durante a realiza\u00e7\u00e3o deste trabalho.\n\n\u00c0 Petrobras, em nome do engenheiro Ant\u00f4nio Maylinch Teruel, por permitir e\n\nincentivar  a realiza\u00e7\u00e3o desta especializa\u00e7\u00e3o profissional.\n\nAo colega Dr. Oscar Rotava pelas sugest\u00f5es e revis\u00e3o  final do trabalho.\n\nAo colega Dr. Marco Ant\u00f4nio Rodrigues pela ajuda na prepara\u00e7\u00e3o das transpar\u00eancias\n\npara a apresenta\u00e7\u00e3o final deste trabalho.\n\nA meu pai Onofre Porf\u00edrio e meus irm\u00e3os Maur\u00edcio, Elcio, Beatriz, Rodrigo e J\u00fanior\n\npelo incentivo durante toda minha vida acad\u00eamica e tamb\u00e9m pela amizade, carinho e\n\nconviv\u00eancia.\n\nAos Operadores da Unidade de Craqueamento Fluido da RPBC pelo aux\u00edlio durante os\n\ndiversos testes realizados na unidade durante a elabora\u00e7\u00e3o deste trabalho.\n\n\n\niii\n\nSUM\u00c1RIO\n\nINTRODU\u00c7\u00c3O ................................................................................................................ 1\n\n1.1 - Apresenta\u00e7\u00e3o da problem\u00e1tica de controle de colunas de pureza elevada............ 1\n\n1.2 - Revis\u00e3o bibliogr\u00e1fica ............................................................................................ 2\n\n1.3 - Objetivo do trabalho ............................................................................................. 6\n\nPROBLEMA DE CONTROLE DA COLUNA DEPROPANIZADORA ........................ 8\n\n2.1 - Especifica\u00e7\u00f5es dos produtos ................................................................................. 8\n\n2.1.1 - Especifica\u00e7\u00f5es do PROPANO ........................................................................... 8\n\n2.1.2 - Especifica\u00e7\u00f5es do BUTANO ............................................................................. 9\n\n2.2 - Descri\u00e7\u00e3o do processo........................................................................................... 9\n\n2.3 - Vari\u00e1veis operacionais ........................................................................................ 10\n\n2.3.1 - Vaz\u00e3o de carga ................................................................................................. 11\n\n2.3.2 - Temperatura da carga....................................................................................... 11\n\n2.3.3 - Composi\u00e7\u00e3o da carga ....................................................................................... 11\n\n2.3.4 - Press\u00e3o da coluna............................................................................................. 11\n\n2.3.5 - Vaz\u00e3o de refluxo .............................................................................................. 12\n\n2.3.6 - Vaz\u00e3o do fluido de aquecimento para refervedor ............................................ 12\n\n2.3.7 - Temperatura de topo ........................................................................................ 12\n\n2.4 - Fatores de desempenho do sistema ..................................................................... 13\n\n2.5 - Limita\u00e7\u00f5es do processo....................................................................................... 13\n\n2.6 - Estrat\u00e9gias de controle da coluna depropanizadora ............................................ 13\n\n2.6.1 - Temperatura de retorno do refervedor  - vaz\u00e3o de refluxo de topo ................. 14\n\n2.6.2 - Vaz\u00e3o do fluido de aquecimento do refervedor  - vaz\u00e3o de refluxo de topo ... 15\n\nDESCRI\u00c7\u00c3O SUM\u00c1RIA DO HYSYS\u2122.......................................................................17\n\nSIMULA\u00c7\u00c3O EST\u00c1TICA DA DEPROPANIZADORA .............................................. 19\n\n4.1 \u2013  Etapas da constru\u00e7\u00e3o do modelo est\u00e1tico .......................................................... 19\n\n4.1.1 \u2013 Defini\u00e7\u00e3o das bases de simula\u00e7\u00e3o ................................................................... 19\n\n4.1.2 \u2013 Caracteriza\u00e7\u00e3o da carga do sistema................................................................. 21\n\n4.1.3 \u2013 Defini\u00e7\u00e3o das opera\u00e7\u00f5es unit\u00e1rias envolvidas no processo............................. 22\n\n\n\niv\n\n4.1.4 \u2013 Especifica\u00e7\u00e3o dos graus de liberdade do sistema............................................ 24\n\n4.1.5 \u2013 Valida\u00e7\u00e3o do modelo est\u00e1tico ......................................................................... 25\n\n4.1.6 \u2013 Defini\u00e7\u00e3o dos estudos da simula\u00e7\u00e3o est\u00e1tica................................................... 27\n\nSIMULA\u00c7\u00c3O DIN\u00c2MICA DA DEPROPANIZADORA ............................................. 29\n\nCOMPORTAMENTO DO PROCESSO ........................................................................ 34\n\n6.1 \u2013 Regi\u00e3o de Opera\u00e7\u00e3o e Ganhos do Processo ....................................................... 35\n\nIDENTIFICA\u00c7\u00c3O DOS MODELOS DO SISTEMA .................................................... 43\n\n7.1 \u2013 Algoritmo de identifica\u00e7\u00e3o de modelos na forma anal\u00edtica................................ 44\n\n7.2 \u2013 Modelos de Processo Identificados .................................................................... 49\n\nALGORITMOS DE CONTROLE .................................................................................. 57\n\n8.1 \u2013 MPC com modelo n\u00e3o-param\u00e9trico ................................................................... 58\n\n8.1.1 \u2013 C\u00e1lculo das predi\u00e7\u00f5es das vari\u00e1veis controladas............................................. 58\n\n8.1.1.1 \u2013 Efeito da \u00faltima a\u00e7\u00e3o de controle................................................................. 58\n\n8.1.1.2 \u2013 Corre\u00e7\u00e3o das predi\u00e7\u00f5es com as leituras da planta ........................................ 60\n\n8.1.1.3 \u2013 Transla\u00e7\u00e3o da predi\u00e7\u00e3o corrigida ................................................................. 63\n\n8.1.2 \u2013 C\u00e1lculo das a\u00e7\u00f5es de controle ......................................................................... 64\n\n8.1.2.1 \u2013 Trajet\u00f3ria de refer\u00eancia das vari\u00e1veis controladas ....................................... 65\n\n8.1.2.2 \u2013 C\u00e1lculo dos erros das vari\u00e1veis controladas................................................. 67\n\n8.1.2.3 \u2013 Algoritmo de controle preditivo................................................................... 68\n\n8.1.2.3.1 \u2013 Algoritmo DMC ........................................................................................ 69\n\n8.1.2.3.2 \u2013 Algoritmo QDMC ..................................................................................... 70\n\n8.1.2.3.2.1 \u2013 Restri\u00e7\u00f5es de movimentos...................................................................... 72\n\n8.1.2.3.2.2 \u2013 Restri\u00e7\u00f5es de limites .............................................................................. 72\n\n8.2 \u2013 MPC com modelo de ordem reduzida................................................................ 74\n\n8.2.1 \u2013 Modelo de fun\u00e7\u00e3o de transfer\u00eancia ................................................................. 74\n\n8.2.2 \u2013 Predi\u00e7\u00e3o com modelos param\u00e9tricos............................................................... 78\n\n8.2.3 \u2013 C\u00e1lculo das predi\u00e7\u00f5es das vari\u00e1veis controladas............................................. 82\n\n8.2.3.1 \u2013 Efeito da \u00faltima a\u00e7\u00e3o de controle................................................................. 83\n\n8.2.3.2 \u2013 Corre\u00e7\u00e3o das predi\u00e7\u00f5es com as leituras da planta ........................................ 84\n\n8.2.3.3 \u2013 Transla\u00e7\u00e3o da predi\u00e7\u00e3o corrigida ................................................................. 86\n\n8.2.4 \u2013 C\u00e1lculo das a\u00e7\u00f5es de controle ......................................................................... 89\n\n8.2.4.1 \u2013 Trajet\u00f3ria de refer\u00eancia das vari\u00e1veis controladas ....................................... 89\n\n\n\nv\n\n8.2.4.2 \u2013 C\u00e1lculo dos erros das vari\u00e1veis controladas................................................. 90\n\n8.2.5 \u2013 Algoritmo de controle preditivo...................................................................... 92\n\n8.2.5.1 \u2013 MMPC (Multi-Model Predictive Control) ................................................... 92\n\n8.2.5.1.1 \u2013 Algoritmo MMPC ..................................................................................... 93\n\n8.2.5.1.2 \u2013 Representa\u00e7\u00e3o de incertezas do sistema.................................................... 94\n\nAPLICA\u00c7\u00c3O DO MPC \u00c0 COLUNA DEPROPANIZADORA .................................... 96\n\n9.1 \u2013  Compara\u00e7\u00e3o QDMC vs MMPC ........................................................................ 98\n\n9.1.1 \u2013 Ajuste sintonia dos controladores ................................................................... 99\n\n9.1.2 \u2013 QDMC e MMPC com sintonias ajustadas .................................................... 102\n\n9.1.3 \u2013 Altera\u00e7\u00e3o no modelo da planta...................................................................... 105\n\n9.2 \u2013 Implanta\u00e7\u00e3o do controlador MMPC na planta industrial ................................. 109\n\n9.2.1 \u2013 SICON - Sistema de Controle (da Petrobras)................................................ 118\n\nCONCLUS\u00d5ES E SUGEST\u00d5ES ................................................................................. 122\n\n10.1 \u2013 Conclus\u00f5es ..................................................................................................... 122\n\n10.2 \u2013 Sugest\u00f5es........................................................................................................ 123\n\nREFER\u00caNCIAS BIBLIOGR\u00c1FICAS .......................................................................... 125\n\nAP\u00caNDICE A - FUN\u00c7\u00c3O DE TRANSFER\u00caNCIA DOS MODELOS\n\nIDENTIFICADOS......................................................................................................... 129\n\n\n\nvi\n\nLISTA DE FIGURAS\n\nFigura 2.1 \u2013 Esquema de produ\u00e7\u00e3o de GLP em refinarias de petr\u00f3leo ............................. 8\n\nFigura 2.2 \u2013 Fluxograma de processo da coluna depropanizadora.................................10\n\nFigura 4.1 \u2013 Fluxograma de processo da simula\u00e7\u00e3o ....................................................... 22\n\nFigura 4.2 \u2013 Fluxograma de processo coluna simulada .................................................. 23\n\nFigura 5.1 \u2013 Esquema de controle da coluna depropanizadora. ...................................... 30\n\nFigura 5.2 \u2013 Diagrama em blocos da malha fechada. ..................................................... 33\n\nFigura 6.1 \u2013 Dualidade das qualidades dos produtos da coluna...................................... 34\n\nFigura 6.2 \u2013 Regi\u00e3o de opera\u00e7\u00e3o das vari\u00e1veis manipuladas .......................................... 37\n\nFigura 6.3 \u2013 Ganhos do C3- versus a vaz\u00e3o de refluxo................................................... 38\n\nFigura 6.4 \u2013 Ganhos do C3- versus Vaz\u00e3o de GOP ........................................................ 39\n\nFigura 6.5 \u2013 Ganhos do C4\n+  versus vaz\u00e3o de refluxo ..................................................... 39\n\nFigura 6.6 \u2013 Ganhos do C4\n+ versus vaz\u00e3o de GOP ......................................................... 40\n\nFigura 6.7 \u2013 Ganhos da Temperatura de Topo versus vaz\u00e3o de Refluxo........................ 40\n\nFigura 6.8 \u2013 Ganhos da Temperatura de Topo versus vaz\u00e3o de GOP............................. 41\n\nFigura 7.1 \u2013 Regi\u00e3o de opera\u00e7\u00e3o do processo ................................................................. 49\n\nFigura 7.2 \u2013Modelos de resposta ao degrau nas manipuladas. O modelo da planta real \u00e9\n\no FD......................................................................................................................... 51\n\nFigura 7.3 \u2013 Modelos de resposta ao degrau nas perturba\u00e7\u00f5es. O modelo da planta real \u00e9\n\no FD................................................................................................................... ......52\n\nFigura 9.1.a \u2013 Compara\u00e7\u00e3o QDMC( - - - ) x MMPC( \u2013\u2013\u2013 ) com mesma sintonia ....... 100\n\nFigura 9.1.b \u2013 QDMCsupr = 0.001(- - -) QDMCsupr = 0.5(\u2013\u2013\u2013) ................................. 101\n\nFigura 9.1.c \u2013 Altera\u00e7\u00e3o do \u201cset-point\u201d do teor de C3\n- QDMC( - - - )  MMPC( \u2013\u2013 ) ... 103\n\nFigura 9.1.d \u2013 Altera\u00e7\u00e3o da faixa de controle da Ttopo QDMC( - - - )  MMPC( \u2013\u2013 ).. 104\n\nFigura 9.1.e \u2013 Aplica\u00e7\u00e3o de degrau na vaz\u00e3o de carga QDMC( - - - )  MMPC( \u2013\u2013 ) ... 104\n\nFigura 9.1.f \u2013 Aplica\u00e7\u00e3o de degrau na TGOP QDMC( - - - )  MMPC( \u2013\u2013 ) ................. 105\n\nFigura 9.1.g \u2013 Mudan\u00e7a p/ modelo 1 no instante 20 QDMC( - - - )  MMPC( \u2013\u2013 )....... 106\n\nFigura  9.1.h - Mudan\u00e7a modelo p/ 2 no instante 20 QDMC( - - - )  MMPC( \u2013\u2013 ) ...... 107\n\nFigura 9.1.i - Mudan\u00e7a modelo para 3 no instante 20 QDMC( - - - )  MMPC( \u2013\u2013 )..... 107\n\nFigura 9.1.j - Mudan\u00e7a modelo para 4 no instante 20 QDMC( - - - )  MMPC( \u2013\u2013 )..... 108\n\nFigura 9.1.k - Mudan\u00e7a modelo p/ 5 no instante 20 QDMC( - - - )  MMPC( \u2013\u2013 ) ....... 109\n\n\n\nvii\n\nFigura 9.2.a1 \u2013 Vari\u00e1veis controladas em opera\u00e7\u00e3o t\u00edpica............................................ 113\n\nFigura 9.2.a2 \u2013 Vari\u00e1veis manipuladas em opera\u00e7\u00e3o t\u00edpica .......................................... 113\n\nFigura 9.2.a3 \u2013 Vari\u00e1veis perturbadoras em opera\u00e7\u00e3o t\u00edpica ........................................ 113\n\nFigura 9.2.b1 \u2013 Vari\u00e1veis controladas teste 1 ............................................................... 114\n\nFigura 9.2.b2 \u2013 Vari\u00e1veis manipuladas teste 1.............................................................. 114\n\nFigura 9.2.b3 \u2013 Vari\u00e1veis perturbadoras teste 1 ............................................................ 114\n\nFigura 9.2.c1 \u2013 Vari\u00e1veis controladas teste 2................................................................ 115\n\nFigura 9.2.c2 \u2013 Vari\u00e1veis manipuladas teste 2.............................................................. 115\n\nFigura 9.2.c3 \u2013 Vari\u00e1veis perturbadoras teste 2 ............................................................ 116\n\nFigura 9.2.d1 \u2013 Vari\u00e1veis controladas teste 3 ............................................................... 117\n\nFigura 9.2.d2 \u2013 Vari\u00e1veis manipuladas teste 3.............................................................. 117\n\nFigura 9.2.d3 \u2013 Vari\u00e1veis perturbadoras teste 3 ............................................................ 117\n\nFigura 9.2.e - Interfaces de controle.............................................................................. 118\n\nFigura 9.2.f \u2013 Tela de configura\u00e7\u00e3o/sintonia do controlador ........................................ 120\n\nFigura 9.2.g \u2013 Tela de configura\u00e7\u00e3o/sintonia de vari\u00e1vel controlada............................ 120\n\nFigura 9.2.h - Tela de configura\u00e7\u00e3o/sintonia de vari\u00e1vel manipulada .......................... 121\n\nFigura 9.2.i - Tela de Configura\u00e7\u00e3o de Vari\u00e1vel Perturbadora ..................................... 121\n\n\n\nviii\n\nLISTA DE TABELAS\n\nTabela 4.1 \u2013 Componentes puros considerados .............................................................. 20\n\nTabela 4.2 \u2013 Condi\u00e7\u00f5es da carga..................................................................................... 21\n\nTabela 4.3 \u2013 Composi\u00e7\u00e3o da carga.................................................................................. 21\n\nTabela 4.4 \u2013 Especifica\u00e7\u00f5es da simula\u00e7\u00e3o ...................................................................... 25\n\nTabela 4.5 \u2013 Resultados da simula\u00e7\u00e3o ............................................................................ 26\n\nTabela 4.6 \u2013 Vari\u00e1veis manipuladas ............................................................................... 27\n\nTabela 4.7 \u2013 Restri\u00e7\u00f5es do processo ............................................................................... 27\n\nTabela 5.1 \u2013 Dados geom\u00e9tricos dos equipamentos ....................................................... 30\n\nTabela 5.2 \u2013 Par\u00e2metros de configura\u00e7\u00e3o dos controladores .......................................... 31\n\nTabela 5.3 \u2013 Par\u00e2metros de sintonia dos controladores .................................................. 31\n\nTabela 6.1 \u2013 Par\u00e2metros dos modelos das infer\u00eancias .................................................... 36\n\nTabela 6.2 \u2013 Ganhos do processo em rela\u00e7\u00e3o \u00e0 vaz\u00e3o de refluxo ................................... 41\n\nTabela 6.3 \u2013 Ganhos do processo para a vaz\u00e3o de GOP. ................................................ 42\n\nTabela 6.4 \u2013 Ganhos do processo para a vaz\u00e3o de carga ................................................ 42\n\nTabela 6.5 \u2013 Ganhos do processo para a temperatura do fluido de aquecimento ........... 42\n\nTabela 7.1 \u2013 Pontos de opera\u00e7\u00e3o dos modelos do processo............................................ 50\n\nTabela 9.1 \u2013 Ganhos dos modelos identificados ............................................................. 99\n\nTabela 9.2: Caracter\u00edsticas dos controladores utilizados ................................................ 99\n\nTabela 9.3 \u2013 Par\u00e2metros de sintonia dos controladores para figura 9.1.a ..................... 100\n\nTabela 9.4 \u2013 Par\u00e2metros de sintonia dos controladores para figura 9.2.a ..................... 101\n\nTabela 9.5 \u2013 Sintonia dos controladores para item 9.1.2 .............................................. 102\n\nTabela 9.6 \u2013 Par\u00e2metros de sintonia do controlador industrial ..................................... 112\n\nTabela A1 \u2013 Par\u00e2metros da fun\u00e7\u00e3o de transfer\u00eancia para o modelo 1 .......................... 129\n\nTabela A2 \u2013 Par\u00e2metros da fun\u00e7\u00e3o de transfer\u00eancia para o modelo 2 .......................... 130\n\nTabela A3 \u2013 Par\u00e2metros da fun\u00e7\u00e3o de transfer\u00eancia para o modelo 3 .......................... 130\n\nTabela A4 \u2013 Par\u00e2metros da fun\u00e7\u00e3o de transfer\u00eancia para o modelo 4. ......................... 131\n\nTabela A5 \u2013 Par\u00e2metros da fun\u00e7\u00e3o de transfer\u00eancia para o modelo 5..........................131\n\nTabela A6 \u2013 Par\u00e2metros da fun\u00e7\u00e3o de transfer\u00eancia para modelo da planta industrial 132\n\n\n\nix\n\nLISTA DE ABREVIATURAS\n\nC3\n- % propano e componentes com pesos moleculares mais baixos\n\nC4\n+ % de iso-butano e componentes de maior peso molecular\n\nCV1 Vari\u00e1vel controlada 1\n\nCV2 Vari\u00e1vel controlada 2\n\nDDE Dynamic Data Exchange\n\nDEA Di-Etanol amina\n\nDet(Kp) Determinante da matriz de ganhos do processo\n\nDMC Dynamic Matrix Control\n\nFCC Craqueamento catal\u00edtico fl\u00faido\n\nFC Controlador de vaz\u00e3o\n\nFIR Finite Impulse Response\n\nGLP G\u00e1s Liq\u00fcefeito de Petr\u00f3leo\n\nGPC Generalized Predictive Control\n\nHYSYS? Software de simula\u00e7\u00e3o de processo da empresa Hyprotech Inc\n\nISE Integral do erro quadr\u00e1tico\n\nLDMC Linear Dynamic Matrix Control\n\nLC Controlador de N\u00edvel\n\nLMI Linear Matrix Inequality\n\nLP Programa\u00e7\u00e3o linear\n\nLREB N\u00edvel de fundo da coluna\n\nL/V Rela\u00e7\u00e3o molar l\u00edquido e vapor no est\u00e1gio da coluna\n\nMAC Model Algorithmic Control\n\nMatlab? Software Matem\u00e1tico da empresa Mathworks Inc\n\nMdl Modelo\n\nMMPC Multi-Model Predictive Control\n\nMPC Controlador preditivo multivari\u00e1vel\n\nMPHC Model Predictive Heuristic Control\n\nMV1 Vari\u00e1vel manipulada 1\n\nMV2 Vari\u00e1vel manipulada 2\n\nNC N\u00famero de componentes do sistema\n\n\n\nx\n\nOLE Object Link Embeding\n\nOP Sa\u00edda do controlador\n\nPCOND Press\u00e3o no condensador\n\nPI\u2122 Software de supervis\u00e3o do processo Plant Information\n\nPID Controlador proporcional integral e derivativo\n\nPV Vari\u00e1vel de processo\n\nP#24 Press\u00e3o no est\u00e1gio 24\n\nQcond Calor absorvido na condensa\u00e7\u00e3o\n\nQDMC Quadratic Dynamic Matrix Control\n\nQP programa\u00e7\u00e3o quadr\u00e1tica\n\nQREB Carga t\u00e9rmica do refervedor\n\nREFAP Refinaria Alberto Pasqualini\n\nREPLAN Refinaria de Paul\u00ednia\n\nREVAP Refinaria do Vale do Para\u00edba\n\nRPBC Refinaria Presidente Bernardes de Cubat\u00e3o\n\nSDCD Sistema Digital de Controle Distribu\u00eddo\n\nSICON Sistema de Controle da Petrobras\n\nSISO Sistema monovari\u00e1vel\n\nSP Setpoint\n\nSQP Programa\u00e7\u00e3o quadr\u00e1tica sucessiva\n\nTC Controlador de temperatura\n\nTGOP Temperatura do gas\u00f3leo pesado\n\nTTOPO Temperatura de topo da coluna\n\nUA Coeficiente global de troca t\u00e9rmica\n\nUFCC Unidade de Craqueamento Catal\u00edtico Fluido\n\nUGAV Unidade de Gasolina de Avia\u00e7\u00e3o\n\nUSP Universidade de S\u00e3o Paulo\n\nVBUTANO Vaz\u00e3o de butano\n\nVCARGA Vaz\u00e3o de carga\n\nVGOP Vaz\u00e3o de gas\u00f3leo pesado\n\nVPROPANO Vaz\u00e3o de propano\n\nVPP Vaz\u00e3o de propano\n\n\n\nxi\n\nVFR Vaz\u00e3o de Refluxo de Topo\n\n\n\nxii\n\nLISTA DE S\u00cdMBOLOS\n\na Termos do denominador do modelo do processo\n\nb Termos do numerador do modelo do processo\n\nc Par\u00e2metro do modelo dependente do tempo\n\nc0 Par\u00e2metro do modelo independente do tempo\n\nC Matriz dos par\u00e2metros do modelo dep. do tempo\n\nC Matriz diag. dos par\u00e2m. do modelo dep. do tempo\n\nC0 Matriz dos par\u00e2metros do modelo indep. do tempo\n\nd Coef. de atualiza\u00e7\u00e3o dos par\u00e2metros do modelo\n\nD Matriz de coef. de atualiza\u00e7\u00e3o dos par\u00e2metros\n\ndet Determinante de uma matriz\n\nE(t) Erro no instante t\n\ne Erro na controlada antes do controle\n\ne Vetor de erros nas controladas ap\u00f3s o controle\n\nek+? Erros das controladas no estado estacion\u00e1rio \n\nF Vaz\u00e3o do fluido\n\nFD Modelo da planta industrial\n\nf(t) Fun\u00e7\u00e3o exponencial do modelo do processo\n\ng(s) Fun\u00e7\u00e3o de transfer\u00eancia cont\u00ednua do processo\n\nIny Matriz diagonal de dimens\u00e3o ny\n\nJk Fun\u00e7\u00e3o objetivo do controlador preditivo\n\nK Matriz de corre\u00e7\u00e3o da predi\u00e7\u00e3o da sa\u00edda\n\nKc Ganho do controlador PID\n\nKMPC Matriz de ganhos do controlador preditivo\n\nKp Ganho do processo\n\nL N\u00famero de modelos alternativos do processo\n\nM Matriz de transi\u00e7\u00e3o de estado\n\nm Horizonte de controle\n\nn Instante de amostragem futuro n = 1, 2, \u2026\n\nna N\u00famero de p\u00f3los do processo\n\n\n\nxiii\n\nnp Horizonte de predi\u00e7\u00e3o\n\nnu N\u00famero de vari\u00e1veis manipuladas\n\nny n\u00famero de vari\u00e1veis controladas\n\nN Matriz de corre\u00e7\u00e3o do erro\n\nnr Horizonte de otimiza\u00e7\u00e3o\n\nNr Matriz de predi\u00e7\u00e3o para controle\n\nN\n~\n\nMatriz de propaga\u00e7\u00e3o dos setpoints das sa\u00eddas\n\nNp Matriz de repeti\u00e7\u00e3o das a\u00e7\u00f5es de controle\n\nn0 N\u00famero de transla\u00e7\u00f5es cont\u00ednuas das predi\u00e7\u00f5es\n\nnh N\u00famero de instantes esparsos das predi\u00e7\u00f5es\n\nOP sa\u00edda do controlador em percentagem\n\nOPSS Sa\u00edda do controlador no estado estacion\u00e1rio inicial\n\np0 Par\u00e2metro de predi\u00e7\u00e3o da sa\u00edda indep. do tempo\n\np Par\u00e2metro de predi\u00e7\u00e3o da sa\u00edda dep. do tempo\n\npi Vetor de par\u00e2metros indep. de predi\u00e7\u00e3o das sa\u00eddas\n\npt Vetor de par\u00e2metros dep. de predi\u00e7\u00e3o das sa\u00eddas\nc\nip Par\u00e2metro indep. corrigido de predi\u00e7\u00e3o da sa\u00edda\n\nc\ngjip ,, Par\u00e2metro dep. corrigido de predi\u00e7\u00e3o da sa\u00edda\n\nr Raiz do modelo do sistema\n\ns Resposta ao degrau unit\u00e1rio  \n\nS Matriz de resposta ao degrau unit\u00e1rio\n\nSm Matriz din\u00e2mica do sistema\n\nT Per\u00edodo de amostragem\n\nt Instante de tempo\n\nu Valor da entrada  (vari\u00e1vel manipulada)\n\nw Desvio da predi\u00e7\u00e3o em rela\u00e7\u00e3o \u00e0 planta\n\nWk Vetor de perturba\u00e7\u00e3o no estado do sistema\n\nyd Resposta ao degrau unit\u00e1rio\n\ny Valor da sa\u00edda (vari\u00e1vel controlada)\n\ny Vetor da predi\u00e7\u00e3o da sa\u00edda\n\ny? Valor de medida da sa\u00edda\n\n\n\nxiv\n\ncy Predi\u00e7\u00e3o corrigida da vari\u00e1vel controlada\n\ny% Vetor de predi\u00e7\u00e3o da sa\u00edda para controle\n\ny Vetor de predi\u00e7\u00e3o da sa\u00edda ap\u00f3s a\u00e7\u00e3o de controle\n\nysp Setpoint da controlada\n\nysp Vetor de setpoints das controladas\n\nS\u00edmbolos Gregos\n\n? Incremento de uma vari\u00e1vel\n\n?D  Tempo derivativo do controlador PID\n\n?I Tempo integral do controlador PID\n\n? Tempo morto\n\n? Peso que pune o desvio\n\n? Fator de supress\u00e3o da manipulada\n\n? Fator de import\u00e2ncia da controlada\n\n? Fatores de supress\u00e3o das manipuladas\n\n? Matriz dos fatores de import\u00e2ncia das controladas\n\n? Fun\u00e7\u00e3o objetivo do QDMC\n\n? Matriz de predi\u00e7\u00e3o das sa\u00eddas\n\n? Res\u00edduo da fun\u00e7\u00e3o objetivo do problema de NLP\n\n\n\nxv\n\nRESUMO\n\nAs colunas depropanizadoras existentes nas refinarias de petr\u00f3leo t\u00eam como\n\nfun\u00e7\u00e3o a separa\u00e7\u00e3o entre as correntes de propano e butano. O objetivo de controle nestas\n\ncolunas \u00e9 a especifica\u00e7\u00e3o de um teor m\u00e1ximo de iso-butano e mais pesados (C4\n+) na\n\ncorrente de propano e do teor m\u00e1ximo de propano e mais leves (C3\n-) na corrente de\n\nbutano. Controladores multivari\u00e1veis tradicionais, que normalmente s\u00e3o implementados\n\nnas colunas depropanizadoras, apresentam grande dificuldade para manter os produtos\n\ndentro de suas especifica\u00e7\u00f5es, isto se deve ao fato de que  este processo apresenta um\n\ncomportamento bastante n\u00e3o-linear ao longo de toda sua regi\u00e3o de opera\u00e7\u00e3o.\n\nNeste trabalho temos como objetivo estudar as dificuldades encontradas no\n\nprojeto de controle para esse tipo de sistema e implantar na planta industrial um\n\ncontrolador multivari\u00e1vel utilizando m\u00faltiplos modelos para controle da coluna. Para\n\nrealizarmos este estudo utilizamos o simulador de processos HYSYS? para\n\nverificarmos o comportamento est\u00e1tico e din\u00e2mico do processo. Os modelos utilizados\n\npara representar o processo s\u00e3o aqueles obtidos durante o estudo do comportamento\n\ndin\u00e2mico.  Para implanta\u00e7\u00e3o do controlador na unidade industrial \u00e9 utilizado o SICON\n\n(Sistema de Controle da Petrobras) sendo algumas de suas rotinas modificadas para\n\npermitir a inclus\u00e3o dos m\u00faltiplos modelos. Durante o estudo s\u00e3o comparadas as\n\nperformances dos controladores QDMC e MMPC (Multi-Model Predictive Control)\n\nresolvido atrav\u00e9s de um algoritmo para NLP (Non Linear Programming).\n\nO controlador multimodelos (MMPC) \u00e9 apresentado na forma de vari\u00e1veis de\n\nestado podendo controlar sistemas de grande porte, inclusive sistemas com din\u00e2micas\n\nlentas e r\u00e1pidas. Esta formula\u00e7\u00e3o permite prever as vari\u00e1veis controladas em instantes de\n\ntempo esparsos e diferentes para cada controlada. O MMPC \u00e9 capaz de tratar problemas\n\nde controle n\u00e3o-linear usando modelos lineares, introduzindo o conceito de robustez\n\ncom a utiliza\u00e7\u00e3o do conjunto de modelos. O MMPC exige um menor esfor\u00e7o de sintonia\n\nque o QDMC sendo adequado para uma regi\u00e3o mais ampla de opera\u00e7\u00e3o.\n\n\n\nxvi\n\nABSTRACT\n\nDepropanizer columns are used in oil refineries for the separation of the propane\n\nstream from the butane stream. The control objective of these columns is the\n\nspecification of a maximum content  of  iso-butane and heavier components (C4+) in the\n\npropane product and the maximum content of propane and lighter components (C3-) in\n\nthe butane product. Multivariable controllers usually implemented in depropanizer\n\ncolumns frequently present great difficulty to maintain the products inside their\n\nspecification ranges. This deficiency is due to the fact that the process presents a quite\n\nnon-linear behavior along its operating window.\n\nThe objective of the present work is to study the difficulties found in the design\n\nof the control system for the aforesaid process, and to implement in an industrial plant a\n\nmultivariable controller using multiple models for the control of the separation column.\n\nTo accomplish this study we used the HYSYS? process simulator  to verify the static\n\nand dynamic behavior of the process. The models used to represent the real process in\n\nthe controller are those obtained during the study of the dynamic behavior. The\n\ncontroller implementation in the industrial unit was done with SICON (Control System\n\nof Petrobras), which had some of its routines modified to allow the inclusion of multiple\n\nmodels. Along the work, performances of  QDMC and MMPC(Multi-Model Predictive\n\nControl) controllers were compared. MMPC was solved through an algorithm for NLP\n\n(Non Linear Programming).\n\nThe Multi-Model  (MMPC) controller was implemented using a state space\n\nformulation which allows for the implementation of very large systems and besides,\n\nsystems with simultaneous slow and fast dynamics. This formulation allows to foresee\n\nthe controlled  variables at sparse sample instants, that can be distinct for each\n\ncontrolled variable. MMPC is able to handle non-linear control problems using linear\n\nmodels by introducing the robustness concept with the use of a set of models. MMPC\n\ndemands a smaller tuning effort than QDMC, and can be adapted to a wide range of\n\noperating conditions.\n\n\n\n1\n\n1\n\nINTRODU\u00c7\u00c3O\n\n1.1 - Apresenta\u00e7\u00e3o da problem\u00e1tica de controle de colunas de pureza elevada\n\nAs colunas depropanizadoras presentes nas refinarias de petr\u00f3leo da Petrobras\n\nest\u00e3o localizadas nas unidades de Craqueamento Catal\u00edtico Fluido (UFCC\u2019s). Estas\n\ncolunas s\u00e3o utilizadas para permitir a separa\u00e7\u00e3o das correntes de propano e butano. No\n\ncaso da RPBC (Refinaria Presidente Bernardes Cubat\u00e3o) o propano \u00e9 enviado para o\n\npool de GLP (g\u00e1s liquefeito de petr\u00f3leo) e o butano \u00e9 enviado para a unidade de gasolina\n\nde avia\u00e7\u00e3o (UGAV).\n\nA estrat\u00e9gia de controle regulat\u00f3rio existente na coluna depropanizadora \u00e9 feita\n\nno SDCD (Sistema Digital de Controle Distribu\u00eddo) e consiste nos seguintes\n\ncontroladores principais: controlador de vaz\u00e3o de carga (sendo este cascateado pelo\n\ncontrolador de n\u00edvel do vaso de carga), controlador de press\u00e3o da coluna (controla a\n\npress\u00e3o no est\u00e1gio 24, manipulando  a vaz\u00e3o de retirada de produto de topo (propano)),\n\ncontrolador de n\u00edvel de fundo (manipula a vaz\u00e3o de retirada de produto de fundo\n\n(butano)), controlador de temperatura de fundo (manipula a entrada de flu\u00eddo de\n\naquecimento (gas\u00f3leo pesado) para o refervedor) e por \u00faltimo o controlador de vaz\u00e3o de\n\nrefluxo (tem a possibilidade de ser cascateado pela temperatura de topo). A atua\u00e7\u00e3o do\n\noperador para controle da qualidade dos produtos \u00e9 feita preferencialmente manipulando\n\no set-point do controlador de vaz\u00e3o de refluxo e o set-point do controlador de\n\ntemperatura de fundo da coluna.\n\nO controlador preditivo proposto neste trabalho tem a seguinte estrutura: duas\n\nvari\u00e1veis controladas que s\u00e3o o teor de C4+ (componentes mais pesados que o propano)\n\nno propano (ou a temperatura de topo) e o teor de C3- (componentes mais leves que o\n\npropano) no butano, duas vari\u00e1veis manipuladas que s\u00e3o o set-point da vaz\u00e3o de refluxo\n\ne o set-point da vaz\u00e3o de fluido de aquecimento do refervedor e duas vari\u00e1veis\n\nperturbadoras que s\u00e3o a vaz\u00e3o de carga e a temperatura do fluido de aquecimento. A\n\npr\u00e1tica mostra que a utiliza\u00e7\u00e3o do teor de C4+ como vari\u00e1vel controlada n\u00e3o \u00e9 adequada,\n\ndevido ao modelo (infer\u00eancia) atualmente dispon\u00edvel para c\u00e1lculo da mesma n\u00e3o\n\n\n\nCap\u00edtulo 1 - Introdu\u00e7\u00e3o 2\n\napresentar resultados satisfat\u00f3rios. Assim, neste trabalho, optou-se por utilizar a\n\ntemperatura de topo da coluna como feito normalmente na planta industrial. No entanto,\n\nos modelos de processo levantados para o controlador contemplam as duas vari\u00e1veis.\n\n Tradicionalmente o projeto do controlador preditivo, consiste em definir\n\ninicialmente o problema de controle e as fun\u00e7\u00f5es do controlador, al\u00e9m da escolha das\n\nvari\u00e1veis manipuladas, controladas e perturba\u00e7\u00f5es. Uma vez definidas as fun\u00e7\u00f5es de\n\ncontrole, identifica-se o processo atrav\u00e9s de testes em degrau nas vari\u00e1veis manipuladas\n\ne perturba\u00e7\u00f5es medidas, em um determinado ponto de opera\u00e7\u00e3o do processo. Em\n\nseguida, constr\u00f3i-se o controlador configurando e customizando a sua programa\u00e7\u00e3o.\n\nFinalmente, sintoniza-se o controlador fazendo uso de simula\u00e7\u00e3o para definir os\n\nmelhores valores dos par\u00e2metros de sintonia. Uma alternativa para se fazer a sintonia de\n\nforma sistem\u00e1tica para sistemas quadrados pode ser encontrada em Trierweiler et al.\n\n(2001). A etapa final consiste na interliga\u00e7\u00e3o do controlador preditivo aos controladores\n\nPID do processo, atrav\u00e9s de um sistema digital, normalmente SDCD (Sistema Digital de\n\nControle Distribu\u00eddo).\n\nCom o objetivo de estudar melhor os problemas de controle desta natureza,\n\npodemos utilizar simuladores est\u00e1ticos e din\u00e2micos rigorosos. Com esta ferramenta,\n\npodemos efetuar um estudo detalhado do problema de controle, determinando na regi\u00e3o\n\nde opera\u00e7\u00e3o das vari\u00e1veis manipuladas, os ganhos do processo e suas din\u00e2micas nos\n\ndiversos pontos de opera\u00e7\u00e3o. Com este estudo, podemos determinar os limites do\n\nsistema quanto \u00e0 sua capacidade de controle.\n\n1.2 - Revis\u00e3o bibliogr\u00e1fica\n\nOs controladores preditivos (MPC\u00b4s) s\u00e3o uma classe de algoritmos de controle\n\nque calculam uma s\u00e9rie de a\u00e7\u00f5es das vari\u00e1veis manipuladas com a finalidade de otimizar\n\no comportamento futuro da sa\u00edda da planta. As primeiras aplica\u00e7\u00f5es industriais foram\n\nimplementadas nas unidades de processo das refinarias de petr\u00f3leo.\n\nOs primeiros algoritmos MPCs  aplicados industrialmente surgiram nos meados\n\nda d\u00e9cada de 70, sendo a primeira aplica\u00e7\u00e3o industrial apresentada por Richalet em 1976\n\ne reportada em 1978 (Richalet et al., 1978). O controlador foi implementado em uma\n\ncoluna fracionadora de FCC e tamb\u00e9m em um sistema de gera\u00e7\u00e3o de vapor. Este\n\n\n\nCap\u00edtulo 1 - Introdu\u00e7\u00e3o 3\n\nalgoritmo ficou conhecido como MPHC (Model Predictive Heuristic Control) e tamb\u00e9m\n\ncomo MAC (Model Algoritmic Control). Paralelamente Cutler e Ramaker\n\ndesenvolveram o controlador DMC (Dynamic Matrix Control) sem restri\u00e7\u00f5es,\n\napresentado em 1979 (Cutler e Ramaker, 1979). Em 1980, Prett e Gillette descreveram\n\numa aplica\u00e7\u00e3o do algoritmo DMC sem restri\u00e7\u00f5es num conjunto reator/regenerador de\n\nFCC (Craqueamento Catal\u00edtico). Esta foi a primeira aplica\u00e7\u00e3o do controlador preditivo\n\nem dois n\u00edveis. O primeiro n\u00edvel consta de um algoritmo de programa\u00e7\u00e3o linear (LP),\n\nque resolve um problema de otimiza\u00e7\u00e3o no estado estacion\u00e1rio sujeito \u00e0s restri\u00e7\u00f5es do\n\nprocesso. O segundo n\u00edvel recebe os valores \u00f3timos das entradas e os setpoints das\n\nsa\u00eddas e resolve o problema atrav\u00e9s do controlador DMC sem restri\u00e7\u00f5es.\n\nOs controladores MAC e DMC  apresentavam dificuldade de incorporar as\n\nrestri\u00e7\u00f5es nos problemas de controle. Este fato levou ao surgimento de uma nova classe\n\nde controladores preditivos. O problema foi resolvido com a utiliza\u00e7\u00e3o dos algoritmos\n\nQDMC (Quadratic Dynamic Matrix Control) e LDMC (Linear Dynamic Matrix\n\nControl), nos quais as restri\u00e7\u00f5es aparecem explicitamente dentro do problema de\n\notimiza\u00e7\u00e3o. Em 1985 Morshedi, Cutler e Skrovanek descreveram o algoritmo LDMC e\n\nem 1986, Garcia e Morshedi descreveram o algoritmo QDMC e apresentaram os\n\nresultados de uma aplica\u00e7\u00e3o em um forno de pir\u00f3lise. Na abordagem do LDMC e\n\nQDMC, foi introduzido o controle por faixa, onde se controla o processo atrav\u00e9s de uma\n\njanela de opera\u00e7\u00e3o.\n\nNeste est\u00e1gio de desenvolvimento dos controladores preditivos, a Petrobras\n\ndecidiu implantar seus pr\u00f3prios controladores, sendo os mesmos desenvolvidos em\n\nconjunto com o departamento de engenharia qu\u00edmica da Escola Polit\u00e9cnica da USP.\n\nAssim, surgiu a primeira aplica\u00e7\u00e3o em um forno de res\u00edduo atmosf\u00e9rico da unidade de\n\ndestila\u00e7\u00e3o da Refinaria Presidente Bernardes de Cubat\u00e3o - RPBC (Zanin e Odloak,\n\n1992), onde se utilizou o controlador LDMC em uma camada. Em seguida surgiram\n\noutras aplica\u00e7\u00f5es de mesma natureza, como os controles da coluna debutanizadora da\n\nREPLAN, da coluna atmosf\u00e9rica da REPLAN (Magalh\u00e3es e Odloak, 1995) e da coluna\n\nde destila\u00e7\u00e3o \u00e0 v\u00e1cuo da REPLAN (Almeida et al., 1996). Al\u00e9m destas aplica\u00e7\u00f5es,\n\nsurgiram outras nas unidades de craqueamento catal\u00edtico fluido, onde se utilizou o\n\ncontrolador DMC em duas camadas. Dentre eles, temos o controle do conversor do FCC\n\nda Refinaria do Vale do Para\u00edba - REVAP (Moro e Odloak, 1994, Moro e Odloak,\n\n\n\nCap\u00edtulo 1 - Introdu\u00e7\u00e3o 4\n\n1995) e do conversor do FCC da REPLAN (Spandri et al., 1995). A partir destas\n\naplica\u00e7\u00f5es, estes controladores foram amplamente difundidos nas unidades da Petrobras,\n\nincluindo unidades de gasolina de avia\u00e7\u00e3o, coqueamento retardado, recupera\u00e7\u00e3o de\n\narom\u00e1ticos e outras.\n\nOs controladores DMC, LDMC e QDMC  j\u00e1 estavam consolidados em meados\n\nda d\u00e9cada de 80. A partir da\u00ed despertou-se o interesse dos pesquisadores pela an\u00e1lise da\n\nrobustez dos mesmos, isto \u00e9, a utiliza\u00e7\u00e3o da estrutura de controle junto \u00e0 planta, onde\n\nexistem incertezas nas medidas e nos modelos utilizados pelo controlador. Uma s\u00e9rie de\n\ntrabalhos exploraram este assunto, dentre eles podemos destacar Garcia e Morari (1982,\n\n1985); Rouhani e Mehra (1982); Morari e Doyle (1986) e Morari e Zafirou (1989).\n\nNeste ponto surgiram algumas propostas de an\u00e1lise de estabilidade dos MPC\u00b4s, entre\n\nelas uma abordagem param\u00e9trica dos MPCs, denominado GPC (Generalized Predictive\n\nControl) proposto por Clarke et al. em 1987. Esta abordagem estimulou uma\n\nuniformiza\u00e7\u00e3o dos MPCs sob a forma de vari\u00e1veis de estado. Li et al. (1989) apresentam\n\numa descri\u00e7\u00e3o bem detalhada do MPC em vari\u00e1veis de estado, explicando as suas\n\npropriedades e apresentando melhorias em rela\u00e7\u00e3o ao DMC, como a utiliza\u00e7\u00e3o do filtro\n\nde Kalman para modelar as perturba\u00e7\u00f5es n\u00e3o medidas.\n\nMorari e Lee (1991) propuseram solu\u00e7\u00f5es de controle para sistemas de grande\n\nporte, onde se utilizou a representa\u00e7\u00e3o do sistema em espa\u00e7o de estado, e o modelo da\n\nperturba\u00e7\u00e3o atrav\u00e9s do filtro de Kalman e incluiu-se a an\u00e1lise de robustez no projeto do\n\ncontrolador.\n\nOdloak (1995), apresentou o controlador DMC em vari\u00e1veis de estado, com\n\npossibilidade de analisar o sistema de controle em malha fechada, isto \u00e9, a resposta do\n\nprocesso \u00e0s a\u00e7\u00f5es de controle \u00e9 equacionada juntamente com o controlador. Esta\n\nabordagem permite a verifica\u00e7\u00e3o da estabilidade da malha fechada sem realizar as\n\nsimula\u00e7\u00f5es do sistema. Isto possibilita o estudo da estabilidade do controlador diante\n\ndos par\u00e2metros de sintonia e de poss\u00edveis configura\u00e7\u00f5es do controle.\n\nA utiliza\u00e7\u00e3o do controlador MPC tradicional em vari\u00e1veis de estado tem a\n\ndimens\u00e3o do estado correspondente ao n\u00famero de coeficientes da resposta ao degrau do\n\nmodelo do DMC. Assim, as principais limita\u00e7\u00f5es do DMC (Lundstr\u00f6m et al., 1995),\n\ncomo o esfor\u00e7o computacional para controladores de grandes dimens\u00f5es, e processos\n\ncom din\u00e2micas muito lentas, continuaram sendo restri\u00e7\u00f5es ao uso desta abordagem.\n\n\n\nCap\u00edtulo 1 - Introdu\u00e7\u00e3o 5\n\nCom objetivo de resolver este tipo de problema, foram apresentadas algumas propostas\n\nde truncamento do modelo de resposta ao degrau, entre elas (Hovd et al., 1993), que n\u00e3o\n\nteve por\u00e9m muita aceita\u00e7\u00e3o. Outra abordagem \u00e9 a compacta\u00e7\u00e3o do controlador atrav\u00e9s\n\nda redu\u00e7\u00e3o da ordem do modelo. Lee et al. (1994) propuseram uma redu\u00e7\u00e3o do estado\n\natrav\u00e9s da constru\u00e7\u00e3o de um filtro \u00f3timo (filtro de Kalman), cujo ganho \u00e9 resolvido\n\natrav\u00e9s da equa\u00e7\u00e3o de Riccati. Neste \u00faltimo trabalho foi realizada uma conex\u00e3o desta\n\nabordagem com o controlador DMC, por\u00e9m os autores n\u00e3o conseguiram manter\n\nexatamente a forma original do DMC e QDMC.\n\nCom a necessidade de se aplicar os MPC\u00b4s para sistemas de grande porte (um\n\n\u00fanico controlador para toda uma unidade de processo) ou sistemas com din\u00e2micas\n\nlentas, e diante das dificuldades de apresenta\u00e7\u00e3o do controlador DMC em sua\n\nformula\u00e7\u00e3o original em espa\u00e7o de estado e de forma reduzida, Odloak (1996) apresentou\n\numa forma eficiente do controlador em espa\u00e7o de estado de ordem reduzida. Nesta\n\nformula\u00e7\u00e3o, o modelo do processo \u00e9 apresentado de forma anal\u00edtica, atrav\u00e9s de modelos\n\nparam\u00e9tricos cont\u00ednuos ou discretos. Isto possibilitou a manuten\u00e7\u00e3o da forma original do\n\nDMC e a utiliza\u00e7\u00e3o de par\u00e2metros cont\u00ednuos, tais como, tempos mortos fracion\u00e1rios, a\n\npossibilidade da utiliza\u00e7\u00e3o de instantes de predi\u00e7\u00e3o esparsos, podendo at\u00e9 utilizar\n\nper\u00edodos de amostragem diferentes para cada vari\u00e1vel controlada, o que \u00e9 interessante\n\nquando num mesmo controlador temos vari\u00e1veis que apresentam din\u00e2micas lentas e\n\noutras r\u00e1pidas. Esta formula\u00e7\u00e3o tamb\u00e9m permitiu a an\u00e1lise de estabilidade dos MPCs\n\nsem muito esfor\u00e7o computacional (Gouv\u00eaa e Odloak, 1997).\n\nDiante da necessidade de resolver os problemas de controle n\u00e3o-lineares, como o\n\ncontrole de colunas de destila\u00e7\u00e3o de alta pureza que \u00e9 um caso t\u00edpico em unidades\n\npetroqu\u00edmicas, algumas alternativas de controladores n\u00e3o-lineares foram propostas,\n\nonde podemos utilizar modelos fundamentais (baseados em equa\u00e7\u00f5es diferenciais de\n\nconserva\u00e7\u00e3o de massa e energia e equa\u00e7\u00f5es constitutivas), modelos emp\u00edricos, obtidos\n\natrav\u00e9s de identifica\u00e7\u00f5es n\u00e3o-lineares e modelos h\u00edbridos, podendo-se at\u00e9 utilizar\n\nmodelos por redes neurais. Al\u00e9m disso, podemos resolver o problema de controle\n\natrav\u00e9s de otimiza\u00e7\u00e3o n\u00e3o-linear ou at\u00e9 mesmo a lineariza\u00e7\u00e3o do modelo no ponto de\n\nopera\u00e7\u00e3o e usar um controlador linear. Estas abordagens s\u00e3o descritas por Henson\n\n(1998) e Morari e Lee (1999).\n\n\n\nCap\u00edtulo 1 - Introdu\u00e7\u00e3o 6\n\nA utiliza\u00e7\u00e3o de controladores multi-modelos \u00e9 uma alternativa  interessante para\n\nresolvermos os problemas onde o processo \u00e9 variante no tempo e no estado. Nesta\n\nabordagem resolvemos o problema de controle que satisfaz a todos os poss\u00edveis modelos\n\nlineares do processo. Este problema de controle pode ser resolvido atrav\u00e9s do algoritmo\n\nLMI (Linear Matrix Inequality). Esta t\u00e9cnica foi motivada por recentes\n\ndesenvolvimentos na teoria e aplica\u00e7\u00f5es em problemas de controle, e na utiliza\u00e7\u00e3o de\n\notimiza\u00e7\u00e3o atrav\u00e9s de LMI (Boyd te al., 1994). Kothare et al. (1996) apresentaram uma\n\nsolu\u00e7\u00e3o de controle MPC usando LMIs, por\u00e9m n\u00e3o apresentando os modelos\n\nalternativos diretamente no problema de controle.\n\nOdloak tem estudado a utiliza\u00e7\u00e3o de MMPCs (Multi-Model Predictive Control),\n\nsendo que o conjunto de modelos e a equa\u00e7\u00e3o de Riccati aparecem inclusas no problema\n\nde controle. Neste caso o controlador \u00e9 projetado com garantia de estabilidade\n\n(Rodrigues e Odloak, 1999). Almeida, Rodrigues e Odloak (2000) apresentam uma\n\naplica\u00e7\u00e3o de multiplos-modelos utilizando-se LMI\u2019s  para controle de uma coluna\n\ndebutanizadora.\n\n1.3 - Objetivo do trabalho\n\nEste trabalho tem como objetivos estudar o sistema de controle de uma coluna\n\ndepropanizadora e implantar em uma unidade industrial um controlador preditivo\n\nmultivari\u00e1vel com m\u00faltiplos modelos (MMPC) sendo este resolvido atrav\u00e9s de um\n\nalgoritmo de programa\u00e7\u00e3o n\u00e3o linear (NLP).\n\nNeste trabalho procuramos fazer um estudo mais detalhado do sistema.\n\nPrimeiramente, procuramos estudar o comportamento est\u00e1tico do processo utilizando\n\nmodelos rigorosos, atrav\u00e9s de simulador. Nesta etapa, define-se a regi\u00e3o de opera\u00e7\u00e3o do\n\nsistema e o comportamento das vari\u00e1veis controladas ao longo desta regi\u00e3o. Depois,\n\ndeterminam-se os ganhos do processo ao longo da regi\u00e3o de opera\u00e7\u00e3o, sendo que nesta\n\netapa avaliamos as n\u00e3o-linearidades do sistema. Como resultado desta etapa, avaliam-se\n\nas propriedades da matriz de ganhos do processo na regi\u00e3o de opera\u00e7\u00e3o obtida. As\n\npropriedades analisadas est\u00e3o ligadas \u00e0s caracter\u00edsticas de intera\u00e7\u00f5es entre as vari\u00e1veis,\n\ncondicionamento e determinantes das matrizes de ganhos do processo. A etapa seguinte\n\ncorresponde \u00e0 constru\u00e7\u00e3o do modelo din\u00e2mico no simulador HYSYS? e \u00e0 identifica\u00e7\u00e3o\n\n\n\nCap\u00edtulo 1 - Introdu\u00e7\u00e3o 7\n\ndo processo em v\u00e1rios pontos ao longo da regi\u00e3o de opera\u00e7\u00e3o. A identifica\u00e7\u00e3o \u00e9 feita\n\nutilizando-se procedimento proposto por Odloak (1996) onde os modelos s\u00e3o obtidos na\n\nforma anal\u00edtica. Ap\u00f3s a  identifica\u00e7\u00e3o dos modelos constru\u00edmos o controlador no\n\nMatlab? e fazemos a simula\u00e7\u00e3o considerando um dos modelos como sendo o modelo\n\nda planta. Com o controlador constru\u00eddo, fazemos a convers\u00e3o de todas as rotinas para a\n\nlinguagem FORTRAN, pois o controlador industrial ser\u00e1 montado utilizando-se esta\n\nlinguagem. Com o controlador na linguaguem FORTRAN poderemos fazer a integra\u00e7\u00e3o\n\ndo mesmo com o SICON (Sistema Integrado de Controle) que \u00e9 uma estrutura para\n\nmontagem dos controladores preditivos desenvolvida pela Petrobras (veja item 9.2.1). A\n\nseguir o controlador \u00e9 colocado em opera\u00e7\u00e3o no modo de simula\u00e7\u00e3o para se fazerem os\n\najuste preliminares na sintonia do mesmo. Ap\u00f3s esta etapa de simula\u00e7\u00e3o o controlador \u00e9\n\ncolocado em opera\u00e7\u00e3o com atua\u00e7\u00e3o ativa sobre as vari\u00e1veis da unidade industrial. A\n\nseguir, s\u00e3o realizados testes para verificar a performance de opera\u00e7\u00e3o do controlador.\n\n\n\n8\n\n2\n\nPROBLEMA DE CONTROLE DA COLUNA\n\nDEPROPANIZADORA\n\nAs colunas depropanizadoras s\u00e3o utilizadas em refinarias para se fazer a\n\nsepara\u00e7\u00e3o das correntes propano e butanos. Na RPBC a corrente propano \u00e9 enviada para\n\no pool de GLP e a corrente de butanos enviada para a unidade de gasolina de avia\u00e7\u00e3o\n\n(UGAV).\n\nO esquema de produ\u00e7\u00e3o \u00e9 ilustrado na figura 2.1.\n\nFigura 2.1 \u2013 Esquema de produ\u00e7\u00e3o de GLP em refinarias de petr\u00f3leo\n\n2.1 - Especifica\u00e7\u00f5es dos produtos\n\nAs correntes de propano e butano fracionadas na coluna depropanizadora\n\npossuem especifica\u00e7\u00f5es que devem ser obedecidas rigorosamente.\n\n2.1.1 - Especifica\u00e7\u00f5es do propano:\n\n   Uma das especifica\u00e7\u00f5es mais importantes do propano \u00e9 o teor de C4+\n\n(componentes mais pesados que o propano) e dever\u00e1 ter um valor de 3% no m\u00e1ximo. O\n\nobjetivo \u00e9 a minimiza\u00e7\u00e3o das perdas de iso-butano para o pool de GLP, cuja perda \u00e9\n\ncompensada por importa\u00e7\u00e3o, com o correspondente custo adicional.\n\n\n\nCap\u00edtulo 2 - Problema de controle da torre depropanizadora 9\n\n2.1.2 - Especifica\u00e7\u00f5es do butano\n\n   No caso da corrente de butano, o teor de C3-  (componentes mais leves que o\n\nbutano) \u00e9 uma de suas principais especifica\u00e7\u00f5es e dever\u00e1 ter um valor de 3% no\n\nm\u00e1ximo, sendo o objetivo evitar  perda de controle operacional na unidade de gasolina\n\nde avia\u00e7\u00e3o (UGAV) devido \u00e0 presen\u00e7a de componentes leves no processo e por quest\u00f5es\n\nde seguran\u00e7a no armazenamento da corrente de butanos.\n\n2.2 - Descri\u00e7\u00e3o do processo\n\nA coluna depropanizadora estudada pertence \u00e0 unidade de craqueamento\n\ncatal\u00edtico da Refinaria Presidente Bernardes (RPBC), sendo sua carga (GLP)\n\nproveniente da se\u00e7\u00e3o de tratamento. O tratamento do GLP \u00e9 feito em duas etapas, ou\n\nseja, dois processos diferentes que s\u00e3o: tratamento DEA, no qual uma solu\u00e7\u00e3o de DEA\n\n(Dietanolamina) \u00e9 utilizada para remo\u00e7\u00e3o de contaminantes tais como CO2, CO, H2S;\n\nap\u00f3s este processo temos o tratamento Merox, que consiste na remo\u00e7\u00e3o de compostos de\n\nenxofre (mercaptans) que s\u00e3o transformados em dissulfetos pela a\u00e7\u00e3o de um catalisador\n\nem presen\u00e7a de soda ca\u00fastica. O tratamento tem como finalidade eliminar a\n\ncorrosividade do GLP.\n\nO GLP ap\u00f3s a se\u00e7\u00e3o de tratamentos \u00e9 enviado ao vaso V-01, do qual \u00e9 bombeado\n\npara a coluna depropanizadora  T-01, sendo sua vaz\u00e3o controlada atrav\u00e9s do FC-01, o\n\nqual \u00e9 cascateado pelo controle de n\u00edvel do V-01. Antes de entrar na coluna, o GLP \u00e9\n\npr\u00e9-aquecido no trocador de calor E-1 trocando calor com a nafta proveniente do fundo\n\nda debutanizadora. A temperatura do GLP \u00e9 mantida constante atrav\u00e9s da manipula\u00e7\u00e3o\n\nda vaz\u00e3o de nafta atrav\u00e9s do trocador E-01. O GLP entra na coluna no est\u00e1gio 16 (a\n\ncoluna \u00e9 composta de 31 pratos valvulados).\n\nEsta carga \u00e9 destilada sendo os vapores de topo totalmente condensados e\n\nsubresfriados no E-02 e enviados para o vaso de topo (V-02). Neste vaso, a corrente\n\nl\u00edquida \u00e9 dividida em duas sendo uma o refluxo de topo e a outra retirada como\n\ndestilado para pool de GLP.\n\n\n\nCap\u00edtulo 2 - Problema de controle da torre depropanizadora 10\n\nParte  do refluxo interno que atinge o fundo da coluna \u00e9 vaporizado no\n\nrefervedor (E-03) e outra parte \u00e9 retirado como produto de fundo sendo resfriado no E-\n\n04 e depois enviado para unidade de gasolina de avia\u00e7\u00e3o.\n\nFigura 2.2 \u2013 Fluxograma de processo da coluna depropanizadora\n\n2.3 - Vari\u00e1veis operacionais\n\n A coluna depropanizadora separa os componentes vol\u00e1teis no destilado\n\n(propano/propeno) e os componentes pesados no produto de fundo (butanos).\n\nPara garantirmos a especifica\u00e7\u00e3o dos produtos as seguintes vari\u00e1veis devem ser\n\nobservadas:\n\n1-Vaz\u00e3o de carga da coluna;\n\n2-Temperatura da carga da coluna;\n\n3-Composi\u00e7\u00e3o da carga;\n\n4-Press\u00e3o da coluna;\n\n5-Vaz\u00e3o de refluxo;\n\n6- Vaz\u00e3o de fluido de aquecimento para refervedor;\n\n7-Temperatura de topo da coluna.\n\n\n\nCap\u00edtulo 2 - Problema de controle da torre depropanizadora 11\n\n2.3.1 - Vaz\u00e3o de carga\n\nA vaz\u00e3o de carga n\u00e3o pode ser manipulada diretamente pelo operador, pois esta\n\nvaz\u00e3o \u00e9 resultado do controle de n\u00edvel do vaso de carga.\n\nUm aumento da vaz\u00e3o de carga provoca o aumento da vaz\u00e3o de fluido de\n\naquecimento do refervedor e um conseq\u00fcente aumento da vaz\u00e3o de refluxo para manter\n\na qualidade dos produtos.\n\n2.3.2 - Temperatura da carga\n\nConforme indicado na figura 2.2, existe um controlador de temperatura da carga\n\nda coluna no n\u00edvel regulat\u00f3rio. O set-point desse controlador pode ser manipulado\n\ndiretamente pelo operador. No entanto \u00e9 mantido sempre em um valor fixo. Assim, n\u00e3o\n\n\u00e9 uma vari\u00e1vel utilizada para controle da coluna.\n\n2.3.3 - Composi\u00e7\u00e3o da carga\n\nA composi\u00e7\u00e3o da carga n\u00e3o pode ser manipulada diretamente pelo operador, pois\n\na distribui\u00e7\u00e3o de componentes na carga \u00e9 fun\u00e7\u00e3o da natureza da carga introduzida na\n\nse\u00e7\u00e3o de convers\u00e3o da unidade e das vari\u00e1veis operacionais desta se\u00e7\u00e3o.\n\nUm aumento da fra\u00e7\u00e3o de leves na carga, provoca um aumento no rendimento da\n\ncorrente de propano e conseq\u00fcentemente  aumento da vaz\u00e3o de refluxo para manter a\n\nqualidade dos produtos.\n\n2.3.4 - Press\u00e3o da coluna\n\nA press\u00e3o da coluna tamb\u00e9m \u00e9 controlada no n\u00edvel regulat\u00f3rio e o\n\ncomportamento dessa malha \u00e9 muito bom o que leva a hip\u00f3tese de que essa vari\u00e1vel\n\npossa ser considerada como constante, s\u00f3 devendo ser alterada quando o resultado\n\ndesejado n\u00e3o puder ser obtido pela manipula\u00e7\u00e3o de outras vari\u00e1veis.\n\n\n\nCap\u00edtulo 2 - Problema de controle da torre depropanizadora 12\n\nUm aumento na press\u00e3o da coluna, provoca um aumento de dificuldade na\n\nsepara\u00e7\u00e3o entre os leves e pesados. Para que esta separa\u00e7\u00e3o ocorra de forma adequada,\n\ndeve-se aumentar a vaz\u00e3o de fluido de aquecimento do refervedor e a vaz\u00e3o de refluxo\n\nde topo.\n\n2.3.5 - Vaz\u00e3o de refluxo\n\nA vaz\u00e3o de refluxo \u00e9 uma das vari\u00e1veis mais importantes a serem manipuladas\n\npara garantir a especifica\u00e7\u00e3o dos produtos. Para cada n\u00edvel de fracionamento desejado\n\nh\u00e1 uma raz\u00e3o de refluxo adequada (rela\u00e7\u00e3o entre a vaz\u00e3o de refluxo e a vaz\u00e3o de\n\ndestilado).\n\nUm aumento da vaz\u00e3o de refluxo provoca uma redu\u00e7\u00e3o da quantidade de fra\u00e7\u00f5es\n\npesadas no destilado. Portanto para manter a qualidade do produto de fundo, \u00e9\n\nnecess\u00e1rio  aumentar a vaz\u00e3o de fluido de aquecimento do refervedor.\n\nO limite inferior da vaz\u00e3o de refluxo est\u00e1 ligado \u00e0 qualidade da separa\u00e7\u00e3o  e o\n\nlimite  superior est\u00e1 ligado \u00e0s capacidades do refervedor, do condensador, da bomba de\n\nrefluxo e \u00e0 hidr\u00e1ulica da coluna.\n\n2.3.6 \u2013 Vaz\u00e3o de Fluido de Aquecimento para refervedor\n\nA vaz\u00e3o e a qualidade da corrente de propano dependem da quantidade de\n\nvapores condensados no sistema de topo, que por sua vez, depende da vaz\u00e3o de fluido\n\nde aquecimento para o refervedor.\n\nUm aumento da vaz\u00e3o de fluido de aquecimento do refervedor ocorrer\u00e1 um\n\naumento da vaporiza\u00e7\u00e3o e conseq\u00fcentemente a necessidade de aumento da vaz\u00e3o de\n\nrefluxo de topo.\n\n2.3.7 - Temperatura de topo\n\nUma vari\u00e1vel alternativa \u00e0 vaz\u00e3o de refluxo \u00e9 a temperatura de topo, que quando\n\nutilizada manipular\u00e1 a vaz\u00e3o de refluxo.\n\n\n\nCap\u00edtulo 2 - Problema de controle da torre depropanizadora 13\n\nNeste caso, um aumento nesta temperatura provoca um aumento da quantidade\n\nde fra\u00e7\u00f5es pesadas no destilado. Portanto para manter a qualidade do produto \u00e9\n\nnecess\u00e1rio diminuir a vaz\u00e3o de fluido de aquecimento do refervedor.\n\n2.4 - Fatores de desempenho do sistema\n\nPara otimiza\u00e7\u00e3o da coluna depropanizadora devemos manipular a vaz\u00e3o de\n\nrefluxo de topo e a vaz\u00e3o de fluido de aquecimento para o refervedor, observando\n\nsempre as restri\u00e7\u00f5es do processo.\n\nEm termos econ\u00f4micos as vari\u00e1veis manipuladas devem ser utilizadas no sentido\n\nde se introduzir o m\u00ednimo de energia no refervedor e operar com o m\u00ednimo de refluxo\n\ninterno da coluna.\n\nOs limites de especifica\u00e7\u00e3o dos produtos s\u00e3o as principais restri\u00e7\u00f5es do processo\n\nque dever\u00e3o ser impostas ao sistema de controle.\n\nAssim, o problema de otimiza\u00e7\u00e3o tem a seguinte formula\u00e7\u00e3o:\n\nMinimizar:                  - Vaz\u00e3o de refluxo de topo e\n\n- Vaz\u00e3o de fluido de aquecimento do refervedor\n\nSujeito a restri\u00e7\u00f5es de:\n\n- % m\u00e1xima de C4+ no propano\n\n- % m\u00e1xima de C3- no butano\n\n2.5 - Limita\u00e7\u00f5es do processo\n\nA coluna depropanizadora n\u00e3o apresenta limita\u00e7\u00f5es f\u00edsicas para especifica\u00e7\u00e3o\n\ndos produtos, conseguindo a mesma fracionar toda a produ\u00e7\u00e3o de GLP da UFCC e\n\ntamb\u00e9m correntes de GLP de outras unidades.\n\n2.6 - Estrat\u00e9gias de controle da coluna depropanizadora\n\nUma coluna de fracionamento com separa\u00e7\u00e3o de produto de topo e fundo com\n\ncondensador total e tambor de topo inundado, tem 4 graus de liberdades e portanto 4\n\n\n\nCap\u00edtulo 2 - Problema de controle da torre depropanizadora 14\n\nvari\u00e1veis devem ser especificadas. Note que a vaz\u00e3o de carga \u00e9 manipulada em fun\u00e7\u00e3o\n\ndo n\u00edvel do vaso carga (V-01) e portanto n\u00e3o fornece nenhum grau de liberdade\n\nadicional\n\nA forma de utilizar estes graus de liberdade \u00e9 colocando controladores para\n\nespecificar estes itens. H\u00e1 uma s\u00e9rie de alternativas de arranjos para o sistema de\n\ncontrole usando os graus de liberdade do sistema. A escolha do melhor arranjo leva em\n\nconsidera\u00e7\u00e3o a sensibilidade do processo, a linearidade do comportamento na regi\u00e3o de\n\nopera\u00e7\u00e3o e o seu comportamento din\u00e2mico.\n\nOs graus de liberdade s\u00e3o utilizados pelos controladores do n\u00edvel regulat\u00f3rio e\n\ncujos \u201cset-points\u201d d\u00e3o origem \u00e0s vari\u00e1veis manipuladas.\n\nAs malhas do n\u00edvel regulat\u00f3rio normalmente especificadas nesta coluna s\u00e3o:\n\n1. Press\u00e3o da coluna (est\u00e1gio 24).\n\n2. Vaz\u00e3o de refluxo de topo da coluna.\n\n3. Temperatura de retorno do refervedor (cascateando a vaz\u00e3o do fluido\n\nde aquecimento para o refervedor).\n\n4. N\u00edvel do fundo da coluna.\n\nAs perturba\u00e7\u00f5es mais importantes deste sistema s\u00e3o:\n\n1. Composi\u00e7\u00e3o da carga.\n\n2. Vaz\u00e3o de carga da coluna.\n\n3. Temperatura do fluido de aquecimento.\n\nNormalmente, a press\u00e3o da coluna \u00e9 mantida no valor de projeto e o n\u00edvel de\n\nfundo \u00e9 controlado no n\u00edvel regulat\u00f3rio. Assim, restam dois graus de liberdade para\n\nserem utilizados no controle da coluna. Quando em opera\u00e7\u00e3o manual, o operador fixa a\n\nvaz\u00e3o de refluxo e a temperatura de sa\u00edda do refervedor. Uma outra alternativa seria\n\nespecificar uma vaz\u00e3o do fluido de aquecimento para o refervedor em vez da\n\ntemperatura de sa\u00edda do refervedor.\n\n2.6.1 - Estrat\u00e9gia temperatura de retorno do refervedor  - vaz\u00e3o de refluxo de topo\n\n\n\nCap\u00edtulo 2 - Problema de controle da torre depropanizadora 15\n\nNesta configura\u00e7\u00e3o a temperatura de retorno do refervedor para coluna \u00e9\n\nutilizada para especificar principalmente o teor de C3-  no butano, e a vaz\u00e3o de refluxo\n\nde topo para especificar preferencialmente o teor de C4+  no propano.\n\nA especifica\u00e7\u00e3o mais rigorosa \u00e9 o teor de C3- no butano, pois existe a\n\npreocupa\u00e7\u00e3o com o armazenamento desta corrente e tamb\u00e9m com a poss\u00edvel perda de\n\ncontrole operacional na unidade de gasolina de avia\u00e7\u00e3o caso tenhamos um teor de C3-\n\nacima dos limites. O controlador de temperatura deveria eliminar as poss\u00edveis\n\nperturba\u00e7\u00f5es do processo para manter a qualidade do butano.\n\nAssim, nesta configura\u00e7\u00e3o colocamos os seguintes controladores para utilizar os\n\ngraus de liberdade como mostra a figura 2.2:\n\n1. Controlador de press\u00e3o no est\u00e1gio 24 manipulando a v\u00e1lvula de\n\nretirada de destilado (propano).\n\n2. Controlador de n\u00edvel de fundo da coluna manipulando a v\u00e1lvula de\n\nretirada de butano.\n\n3. Controlador de temperatura de retorno do refervedor manipulando a\n\nvaz\u00e3o de fluido de aquecimento.\n\n4. Controlador de vaz\u00e3o de refluxo de topo manipulando a v\u00e1lvula de\n\nrefluxo de topo.\n\nEsta \u00e9 a configura\u00e7\u00e3o utilizada no controle regulat\u00f3rio normal (feito pelo SDCD)\n\ne n\u00e3o ser\u00e1 objeto de estudo deste trabalho.\n\n2.6.2 \u2013 Vaz\u00e3o de fluido de aquecimento para refervedor  - vaz\u00e3o de refluxo\n\nNesta configura\u00e7\u00e3o colocamos os seguintes controladores como mostra a figura\n\n2.2:\n\n1. Controlador de press\u00e3o no est\u00e1gio 24 manipulando a v\u00e1lvula de\n\nretirada de destilado (propano). Tendo em vista o projeto da unidade\n\nque considera o tambor de topo inundado (sem interface l\u00edquido-\n\nvapor), essa \u00e9 a \u00fanica configura\u00e7\u00e3o poss\u00edvel.\n\n\n\nCap\u00edtulo 2 - Problema de controle da torre depropanizadora 16\n\n2. Controlador de n\u00edvel de fundo da coluna manipulando a v\u00e1lvula de\n\nretirada de butano.\n\n3. Controlador de teor de C3-  no butano (AI2), podendo manipular a\n\nvaz\u00e3o de refluxo ou a vaz\u00e3o de fluido de aquecimento.\n\n4. Controlador do teor de C4+  no propano (AI1) ou da temperatura de\n\ntopo, podendo manipular a vaz\u00e3o de refluxo ou vaz\u00e3o de fluido de\n\naquecimento.\n\nVisto que a sintonia do controlador da temperatura de retorno do refervedor n\u00e3o\n\n\u00e9 trivial pois depende das condi\u00e7\u00f5es operacionais, que podem tornar a malha muito\n\nlenta, para o estudo desta coluna, optou-se por adotar, no n\u00edvel regulat\u00f3rio, uma\n\nestrat\u00e9gia onde \u00e9 manipulada a vaz\u00e3o de fluido de aquecimento para o refervedor.\n\n\n\n17\n\n3\n\nDESCRI\u00c7\u00c3O SUM\u00c1RIA DO HYSYS\n\nA crescente demanda por produtos com qualidades cada vez mais rigorosas, tem\n\nlevado as unidades industriais a operarem seus processos cada vez mais pr\u00f3ximos de\n\nsuas restri\u00e7\u00f5es. Isto faz com que a engenharia de controle necessite cada vez mais de\n\nmodelos em estado-estacion\u00e1rio e din\u00e2mico mais realistas para analisar melhor a\n\nestabilidade, robustez e performance dos sistemas de controle dos processos qu\u00edmicos.\n\nDiante deste quadro a utiliza\u00e7\u00e3o de um simulador de processo se torna\n\nfundamental, sendo o HYSYS\u2122  (Hyprotech Ltd) um simulador de processos que\n\ncombina a opera\u00e7\u00e3o no estado-estacion\u00e1rio com o din\u00e2mico no mesmo ambiente. Ele\n\npossibilita passar facilmente do regime estacion\u00e1rio para o din\u00e2mico e no sentido\n\ncontr\u00e1rio.\n\nO simulador foi desenvolvido em ambiente Windows e orientado \u00e0 objetos e\n\neventos, com compatibilidade OLE (Object Link Embeding) onde permite-se que o\n\nsimulador execute fun\u00e7\u00f5es de outros programas. O programa tamb\u00e9m disponibiliza os\n\nservi\u00e7os DDE (Dynamic Data Exchange) onde se pode transferir dinamicamente dados\n\npara outros programas, como Matlab\u2122 , e no sentido contr\u00e1rio.\n\nIsto permite ao engenheiro criar aplica\u00e7\u00f5es customizadas que acessam partes do\n\nHYSYS\u2122  ou construir interfaces customizadas.\n\nAl\u00e9m destas caracter\u00edsticas, possibilita a utiliza\u00e7\u00e3o de pacotes customizados, tais\n\ncomo:\n\n\u2022 Controladores\n\n\u2022 Cin\u00e9ticas de rea\u00e7\u00f5es\n\n\u2022 Modelos de colunas extratoras, filtros e etc.\n\n\u2022 Pacotes de propriedades\n\n\u2022 Outros\n\nEstas customiza\u00e7\u00f5es podem ser criadas a partir de programas escritos em\n\nlinguagem FORTRAN ou C/C++, e utilizando Visual Basic como inferface.\n\nAs opera\u00e7\u00f5es unit\u00e1rias s\u00e3o modulares e utilizam modelos rigorosos, onde s\u00e3o\n\ncombinadas com algoritmo de solu\u00e7\u00e3o n\u00e3o-sequencial. Neste algoritmo as informa\u00e7\u00f5es\n\n\n\nCap\u00edtulo 4 \u2013 Simula\u00e7\u00e3o est\u00e1tica da depropanizadora 18\n\ns\u00e3o processadas e os resultados de alguns c\u00e1lculos s\u00e3o automaticamente propagados no\n\nfluxograma para frente e para tr\u00e1s.\n\nA estrutura modular das opera\u00e7\u00f5es unit\u00e1rias significa que podem ser calculadas\n\nem ambas dire\u00e7\u00f5es, utilizando informa\u00e7\u00f5es de uma corrente de sa\u00edda para calcular as\n\ncondi\u00e7\u00f5es de entrada.\n\nO simulador din\u00e2mico permite verificar o comportamento do processo fora do\n\nestado-estacion\u00e1rio, analisando os casos servo e regulat\u00f3rio. Desta forma, o modelo\n\ndin\u00e2mico pode ser utilizado para fazer estudos de controle de processos.\n\nAssim um controlador preditivo pode ser utilizado junto ao modelo do processo\n\ndisponibilizado pelo simulador.\n\nO simulador de processos \u00e9 um ambiente de engenharia que se destina \u00e0s\n\nseguintes aplica\u00e7\u00f5es:\n\n\u2022 Projeto conceitual de processos qu\u00edmicos\n\n\u2022 Projeto b\u00e1sico de processos\n\n\u2022 Projeto detalhado de plantas\n\n\u2022 Projeto de sistemas de controle\n\n\u2022 Otimiza\u00e7\u00e3o de processos\n\n\u2022 Treinamento de operadores\n\n\u2022 An\u00e1lise de processos\n\n\u2022 Monitora\u00e7\u00e3o de performance do processo\n\nEm nosso trabalho utilizamos o HYSYS PROCESS 1.2, vers\u00e3o 1.2.4 de outubro\n\nde 1997.\n\n\n\n19\n\n4\n\nSIMULA\u00c7\u00c3O EST\u00c1TICA DA DEPROPANIZADORA\n\nNeste cap\u00edtulo apresentamos os detalhes da montagem do modelo est\u00e1tico do\n\nprocesso a ser utilizado no estudo de controle. Apresentamos as bases de simula\u00e7\u00e3o, a\n\ncaracteriza\u00e7\u00e3o da carga, a montagem das opera\u00e7\u00f5es unit\u00e1rias, converg\u00eancia da\n\nsimula\u00e7\u00e3o, valida\u00e7\u00e3o do modelo est\u00e1tico e as defini\u00e7\u00f5es dos estudos da simula\u00e7\u00e3o\n\nest\u00e1tica.\n\nPara a montagem do modelo din\u00e2mico do processo no  HYSYS?, inicialmente \u00e9\n\nnecess\u00e1rio construir o modelo em estado estacion\u00e1rio. Tendo o modelo em estado\n\nestacion\u00e1rio, \u00e9 poss\u00edvel estudarmos o comportamento do processo. Desta forma \u00e9\n\nposs\u00edvel determinar a regi\u00e3o de opera\u00e7\u00e3o, isto \u00e9, as poss\u00edveis combina\u00e7\u00f5es das vari\u00e1veis\n\nindependentes que correspondem \u00e0s situa\u00e7\u00f5es reais de opera\u00e7\u00e3o do sistema. Podemos\n\ntamb\u00e9m avaliar as n\u00e3o-linearidades dos ganhos do processo, que s\u00e3o importantes para\n\numa melhor avalia\u00e7\u00e3o do comportamento do sistema de controle.\n\n4.1 \u2013  Etapas da constru\u00e7\u00e3o do modelo est\u00e1tico\n\nOs seguintes aspectos devem ser verificados quando da elabora\u00e7\u00e3o do modelo\n\nestacion\u00e1rio a ser analisado:\n\n\u00fc Defini\u00e7\u00e3o das bases de simula\u00e7\u00e3o;\n\n\u00fc Caracteriza\u00e7\u00e3o da carga do sistema;\n\n\u00fc Defini\u00e7\u00e3o das opera\u00e7\u00f5es unit\u00e1rias envolvidas no processo;\n\n\u00fc Especifica\u00e7\u00e3o dos graus de liberdade do sistema;\n\n\u00fc Valida\u00e7\u00e3o do modelo est\u00e1tico;\n\n\u00fc Defini\u00e7\u00e3o dos estudos da simula\u00e7\u00e3o est\u00e1tica.\n\nNos pr\u00f3ximos itens apresentamos a seq\u00fc\u00eancia para constru\u00e7\u00e3o do modelo\n\nest\u00e1tico de acordo com os itens acima.\n\n4.1.1 \u2013 Defini\u00e7\u00e3o das premissas da simula\u00e7\u00e3o\n\n\n\nCap\u00edtulo 4 \u2013 Simula\u00e7\u00e3o est\u00e1tica da depropanizadora 20\n\nNos simuladores, inicialmente definimos as bases de simula\u00e7\u00e3o que consiste em\n\ndefinir o conjunto de equa\u00e7\u00f5es para os c\u00e1lculos de equil\u00edbrio, propriedades f\u00edsico-\n\nqu\u00edmicas e termodin\u00e2micas, e o conjunto de componentes qu\u00edmicos que ser\u00e3o utilizados\n\nna simula\u00e7\u00e3o.\n\nNa defini\u00e7\u00e3o do modelo de propriedades das subst\u00e2ncias envolvidas no sistema\n\nem estudo, especificamos a natureza qu\u00edmica dos componentes qu\u00edmicos da simula\u00e7\u00e3o.\n\nPara o nosso caso onde os  hidrocarbonetos s\u00e3o apolares, o modelo termodin\u00e2mico pode\n\nser representado por equa\u00e7\u00f5es de estado. Neste trabalho foi utilizado o modelo\n\ndesenvolvido por Peng e Robinson (1976), que prev\u00ea com boa precis\u00e3o as propriedades\n\npara estes tipos de hidrocarbonetos.\n\nCom o modelo de propriedades das subst\u00e2ncias envolvidas na simula\u00e7\u00e3o\n\ndefinido, caracterizamos os componentes presentes no sistema. Para a depropanizadora,\n\nas correntes envolvidas no sistema s\u00e3o constitu\u00eddas basicamente de hidrocarbonetos\n\npuros.\n\nOs componentes utilizados na simula\u00e7\u00e3o podem ser caracterizados atrav\u00e9s de\n\ncromatografia gasosa e est\u00e3o listados na tabela 4.1\n\nComponente S\u00edmbolo F\u00f3rmula\nPonto de\n\nebuli\u00e7\u00e3o (oC)\n\nMassa\n\nmolecular\n\nmetano C1 CH4 -161.52 16.04\n\netileno C2= C2H4 -103.75 28.05\n\netano C2 C2H6 -88.60 30.07\n\npropeno C3= C3H6 -47.75 42.08\n\npropano C3 C3H8 -42.10 44.10\n\niso-butano i-C4 C4H10 -11.73 58.12\n\niso-Buteno i-C4= C4H8 -6.85 56.11\n\n1,3-butadieno 13C4= = C4H6 -4.45 54.09\n\nn-butano n-C4 C4H10 -0.50 58.12\n\ntrans-buteno tr2-C4= C4H8 0.88 56.11\n\niso-pentano i-C5 C5H12 27.88 72.15\n\nn-pentano n-C5 C5H12 36.06 72.15\n\nn-hexano n-C6 C6H14 68.73 86.18\n\n      Tabela 4.1 \u2013 Componentes puros considerados\n\n\n\nCap\u00edtulo 4 \u2013 Simula\u00e7\u00e3o est\u00e1tica da depropanizadora 21\n\n4.1.2 \u2013 Caracteriza\u00e7\u00e3o da carga do sistema\n\nCom as bases de simula\u00e7\u00e3o definidas passamos para a fase de caracteriza\u00e7\u00e3o da\n\ncarga do sistema. Esta etapa consiste em definir as condi\u00e7\u00f5es de processo, como\n\npress\u00e3o, temperatura e vaz\u00e3o, bem como a sua composi\u00e7\u00e3o.\n\nNa planta industrial n\u00e3o \u00e9 poss\u00edvel caracterizar a carga da coluna\n\ndepropanizadora diretamente. Assim,  a caracteriza\u00e7\u00e3o da carga \u00e9 feita a partir dos\n\nprodutos da coluna. Os produtos s\u00e3o analisados separadamente e anotam-se as suas\n\nrespectivas vaz\u00f5es volum\u00e9tricas. Portanto, a carga (GLP) \u00e9 composta da combina\u00e7\u00e3o das\n\ncorrentes propano e butano. Ser\u00e3o utilizadas duas composi\u00e7\u00f5es de carga distintas,\n\nretratando perfis de convers\u00e3o diferentes no sistema de convers\u00e3o da unidade. As\n\ncondi\u00e7\u00f5es operacionais (temperatura, press\u00e3o e vaz\u00e3o) da carga ser\u00e3o as mesmas para os\n\ndois perfis de composi\u00e7\u00e3o.\n\nA carga foi composta nas seguintes condi\u00e7\u00f5es, a partir de dados da planta:\n\nCorrente Vaz\u00e3o Temp. Press\u00e3o\nCarga 2500 m3/d 75 oC 19.00 kgf /cm\n\n2 _man\n    Tabela 4.2 \u2013 Condi\u00e7\u00f5es da carga\n\nA composi\u00e7\u00e3o da carga foi obtida atrav\u00e9s da cromatografia dos dois produtos\n\ncomo mostra a tabela a seguir:\n\nComponente % Vol. carga 1 % Vol. carga 2\nmetano 0.8921 0.9357\netileno 0.4956 0.4678\netano 0.4956 0.4678\npropeno 24.1975 28.4370\npropano 14.8409 15.5408\niso-butano 16.2137 13.4214\niso-buteno 18.5411 19.6506\n1,3-butadieno 0.4654 0.8243\nn-butano 9.7452 7.0021\ntrans-buteno 13.7693 13.1535\niso-pentano 0.2861 0.0210\nn-pentano 0.0286 0.0781\nn-hexano 0.0289 0.0000\n\n    Tabela 4.3 \u2013 Composi\u00e7\u00e3o da carga\n\n\n\nCap\u00edtulo 4 \u2013 Simula\u00e7\u00e3o est\u00e1tica da depropanizadora 22\n\n4.1.3 \u2013 Defini\u00e7\u00e3o das opera\u00e7\u00f5es unit\u00e1rias envolvidas no processo\n\nCom a carga do sistema caracterizada, iniciamos a constru\u00e7\u00e3o das opera\u00e7\u00f5es\n\nunit\u00e1rias e das correntes envolvidas no sistema como mostrado na figura 4.1.\n\nFigura 4.1 \u2013 Fluxograma de processo da simula\u00e7\u00e3o\n\nAp\u00f3s aquecimento no trocador de calor M20, a corrente de carga \u00e9 introduzida\n\nno sistema \u00e0 75oC e 19 kgf/cm2man. O trocador de calor \u00e9 do tipo casco e tubo em\n\ncontra-corrente, onde a corrente de carga troca calor com a corrente nafta de fundo da\n\ncoluna debutanizadora (estabilizadora de gasolina). A perda de carga adotada \u00e9 no casco\n\nde 0.10 kgf/cm2man e nos tubos de 0.14 kgf/cm2man.\n\nAs temperaturas de entrada e sa\u00edda do lado do casco, e sa\u00edda do lado dos tubos\n\ns\u00e3o conhecidas. As vaz\u00f5es envolvidas tamb\u00e9m s\u00e3o conhecidas. O UA do trocador \u00e9\n\ncalculado e apresenta um valor de 3.5 x 104 kcal/ (oC/h) (o valor de projeto do trocador \u00e9\n\nde 11 x 104 kcal/( oC/h)).\n\nA carga aquecida \u00e9 introduzida no est\u00e1gio 16 da coluna N-2406, como mostra a\n\nfigura 4.2.\n\n\n\nCap\u00edtulo 4 \u2013 Simula\u00e7\u00e3o est\u00e1tica da depropanizadora 23\n\nFigura 4.2 \u2013 Fluxograma de processo coluna simulada\n\nA coluna tem 31 est\u00e1gios de equil\u00edbrio com 80 % de efici\u00eancia de Murphree\n\nlevantada experimentalmente. A perda de carga na coluna \u00e9 de 0.63 kgf/cm2man, com\n\npress\u00e3o no topo de 18.70 kgf/cm2man e no prato 24 de 19.18 kgf/cm2man. As press\u00f5es\n\ns\u00e3o manom\u00e9tricas cuja unidade \u00e9; kgf/cm2man.\n\nO perfil de temperatura tem os seguintes pontos b\u00e1sicos: a temperatura do\n\nest\u00e1gio de topo da coluna \u00e9 47 oC, do fundo de 106oC.\n\nO condensador da coluna \u00e9 total, ou seja, os vapores do topo s\u00e3o condensados e\n\nsubresfriados a 32 oC, n\u00e3o apresentando corrente gasosa como produto de topo. As\n\ncorrentes de sa\u00edda do condensador s\u00e3o: o propano (destilado) e o refluxo de topo. Al\u00e9m\n\ndestas duas correntes materiais, temos uma corrente de energia que \u00e9 o calor absorvido\n\nna condensa\u00e7\u00e3o (QCond). Nestas condi\u00e7\u00f5es a vaz\u00e3o de refluxo de topo \u00e9 de 4000 m3/d.\n\nEste condensador de topo, na realidade \u00e9 um conjunto condensador e vaso.\n\nNo fundo da coluna, temos um refervedor onde parte do l\u00edquido do fundo \u00e9\n\nvaporizado para fornecer energia ao processo de separa\u00e7\u00e3o. O l\u00edquido do \u00faltimo est\u00e1gio\n\n\u00e9 introduzido todo no refervedor. A parte vaporizada volta para a  coluna abaixo do\n\n\n\nCap\u00edtulo 4 \u2013 Simula\u00e7\u00e3o est\u00e1tica da depropanizadora 24\n\n\u00faltimo est\u00e1gio, sendo a fase l\u00edquida removida como produto de fundo. O l\u00edquido do\n\n\u00faltimo est\u00e1gio \u00e9 vaporizado \u00e0 106oC atrav\u00e9s do calor cedido (Qreb) de 7.85 x106 kcal/h\n\nque corresponde a uma vaz\u00e3o de fluido de aquecimento de 2090 m3/d.\n\nNas colunas industriais, a corrente l\u00edquida de produto de fundo n\u00e3o passa pelo\n\nrefervedor. Entretanto considerar que este l\u00edquido participa do equil\u00edbrio n\u00e3o representa\n\numa diferen\u00e7a percept\u00edvel em rela\u00e7\u00e3o ao processo real. Portanto, esta \u00e9 uma\n\nsimplifica\u00e7\u00e3o que n\u00e3o causa desvios nos resultados da simula\u00e7\u00e3o.\n\nFoi utilizada uma outra opera\u00e7\u00e3o unit\u00e1ria M23 que \u00e9 uma simula\u00e7\u00e3o do\n\nrefervedor para obtermos os valores de vaz\u00e3o do fluido de aquecimento (gas\u00f3leo\n\npesado). Dentro do ambiente de simula\u00e7\u00e3o da coluna calculamos a fra\u00e7\u00e3o de chave\n\npesado do propano, que corresponde a quantidade de componentes de 4 \u00e1tomos de\n\ncarbono ou mais, chamado de C4+, e tamb\u00e9m o chave leve do butano, que corresponde a\n\ncomponentes de 3 \u00e1tomos de carbono ou menos, chamado C3-.\n\nNeste estudo o C4+ \u00e9 composto de:\n\n65544444 3,14 nCiCnCtransCCiCnCiCC +++++++= ====\n+\n\nPara o C3- temos:\n\n122333 CCCCCC ++++= ==\n?\n\n4.1.4 \u2013 Especifica\u00e7\u00e3o dos graus de liberdade para simula\u00e7\u00e3o do sistema\n\nComo j\u00e1 visto, para tornar o modelo do sistema un\u00edvoco em termos de condi\u00e7\u00f5es\n\noperacionais, devemos especificar os graus de liberdade do sistema. Inicialmente\n\ndevemos especificar as caracter\u00edsticas da carga como: temperatura, press\u00e3o e\n\ncomposi\u00e7\u00e3o da carga. Ao passar pelo pr\u00e9-aquecedor de carga, temos que especificar a\n\nperda de calor pelas paredes do trocador de calor (no caso \u00e9 zero) e o produto UA do\n\ntrocador ou as temperaturas das correntes. Al\u00e9m disso devemos especificar as perdas de\n\ncarga no casco e nos tubos, ou as press\u00f5es das correntes. A carga pr\u00e9-aquecida entra na\n\ncoluna de destila\u00e7\u00e3o.\n\n\n\nCap\u00edtulo 4 \u2013 Simula\u00e7\u00e3o est\u00e1tica da depropanizadora 25\n\nA coluna depropanizadora no estado estacion\u00e1rio apresenta dois graus de\n\nliberdade al\u00e9m da press\u00e3o, que devem ser especificados conforme as vari\u00e1veis\n\nmanipuladas da estrat\u00e9gia de controle. Para simula\u00e7\u00e3o da coluna, adota-se a seguinte\n\nsimplifica\u00e7\u00e3o: a \u00e1gua de refrigera\u00e7\u00e3o para o condensador \u00e9 manipulada visando manter\n\nconstante a temperatura de subresfriamento do l\u00edquido que sai do condensador. Neste\n\ncaso, especificamos esta temperatura na simula\u00e7\u00e3o. Outras vari\u00e1veis manipuladas\n\nespecificadas s\u00e3o: a carga t\u00e9rmica do refervedor e a vaz\u00e3o de refluxo de topo. Como\n\nvisto, al\u00e9m dessas especifica\u00e7\u00f5es, devemos definir o perfil de press\u00f5es da coluna. Na\n\ntabela 4.4 apresentamos as especifica\u00e7\u00f5es para o caso base.\n\nOpera\u00e7\u00e3o unit\u00e1ria\n\nou corrente\n\nEspecifica\u00e7\u00e3o Valor\n\nM-20 Perda de calor (MMcal/h) 0.00\n\nTemp. ent. casco (oC) 42\n\nTemp. sai casco (oC) 75\n\n?emp. sai tubos (oC) 103\n\n?P no casco (kgf/cm\n2) 0.1\n\n?P nos tubos (kgf/cm\n2) 0.14\n\nN \u2013 2406 Subresfriam.cond. (oC) 32\n\nCarga t\u00e9rm. reb (MMcal/h) 7.85\n\nVaz\u00e3o refluxo topo (m3/d) 4000\n\n?P condensador (kgf/cm\n2) 0.07\n\nPress\u00e3o topo (kgf/cm2man) 18.63\n\nPress\u00e3o fundo (kgf/cm2man) 19.33\n\n?P refervedor (kgf/cm\n2) 0.0\n\nTabela 4.4 \u2013 Especifica\u00e7\u00f5es da simula\u00e7\u00e3o\n\n4.1.5 \u2013 Valida\u00e7\u00e3o do modelo est\u00e1tico\n\nCom o caso base convergido, devemos validar o modelo constru\u00eddo. Para\n\nvalidarmos o modelo devemos fazer as seguintes verifica\u00e7\u00f5es:\n\n\u00fc Verifica\u00e7\u00e3o do balan\u00e7o material\n\n\n\nCap\u00edtulo 4 \u2013 Simula\u00e7\u00e3o est\u00e1tica da depropanizadora 26\n\n\u00fc Verifica\u00e7\u00e3o do perfil de temperaturas\n\n\u00fc Verifica\u00e7\u00e3o da qualidade dos produtos\n\n\u00fc Verifica\u00e7\u00e3o das cargas t\u00e9rmicas do condensador e refervedor\n\nNo ajuste do modelo, elegemos os par\u00e2metros a serem manipulados, tais como,\n\nefici\u00eancias dos est\u00e1gios, modelo de equil\u00edbrio, composi\u00e7\u00e3o da carga, entre outros. Na\n\ntabela 4.5 apresentamos os resultados do ajuste do modelo para o caso base.\n\nVari\u00e1vel Valor real Valor simulado\n\nVaz\u00e3o de carga 2500 m3/d 2500 m3/d\n\nVaz\u00e3o de propano 1012.5 m3/d 1041 m3/d\n\nVaz\u00e3o de butano 1487.5 m3/d 1459 m3/d\n\nTemperatura carga aquecida 75. oC 75 oC\n\nTemperatura de refluxo 32 oC 31.8 oC\n\nTemperatura de topo 47 oC 46.4 oC\n\nTemperatura de fundo 106oC 106.4 oC\n\nC4+ no propano 2.51 %vol. 2.45 %vol.\n\nC3- no butano 0.50 %vol. 0.46 %vol.\n\nVaz\u00e3o de refluxo 4000 m3/d 4000 m3/d\n\nCarga t\u00e9rmica do refervedor 7.85 MMcal/h 7.85 Mmcal/h\n\n Tabela 4.5 \u2013 Resultados da simula\u00e7\u00e3o\n\nA vaz\u00e3o de propano para o caso base ficou em 1041 m3/d e a de butano em 1459\n\nm3/d. Na planta industrial, temos uma vaz\u00e3o de propano de 1012.5  m3/d e de butano de\n\n1487.5 m3/d. Tal diferen\u00e7a pode ser uma decorr\u00eancia de problemas de calibra\u00e7\u00e3o dos\n\ninstrumentos de medi\u00e7\u00e3o e n\u00e3o \u00e9 motivo de preocupa\u00e7\u00e3o pois os perfis de composi\u00e7\u00e3o e\n\ntemperatura est\u00e3o em bom acordo com os dados da planta.\n\nUma boa medida para o desempenho do processo de separa\u00e7\u00e3o \u00e9 a verifica\u00e7\u00e3o do\n\nperfil de temperaturas ao longo da coluna. No entanto, a medi\u00e7\u00e3o da temperatura em\n\ntodos os est\u00e1gios na planta industrial n\u00e3o \u00e9 economicamente vi\u00e1vel, portanto colocam-se\n\nsensores de temperatura somente nos pontos importantes. Na coluna depropanizadora,\n\nos pontos importantes s\u00e3o a temperatura de topo e do fundo da coluna, que apresentaram\n\nvalores bastante coerentes com os da planta (cf. tabela 4.5).\n\n\n\nCap\u00edtulo 4 \u2013 Simula\u00e7\u00e3o est\u00e1tica da depropanizadora 27\n\nQuanto \u00e0 qualidade dos produtos na simula\u00e7\u00e3o do caso base, obtivemos um\n\npropano com um teor de C4+ de 2.45 %vol., e para o butano o teor de C3- ficou em 0.46\n\n%vol., sendo estes valores bastante coerentes com os valores da planta industrial.\n\n4.1.6 \u2013 Defini\u00e7\u00e3o dos estudos da simula\u00e7\u00e3o est\u00e1tica\n\nCom a simula\u00e7\u00e3o est\u00e1tica ajustada, poderemos dar in\u00edcio ao estudo de casos.\n\nNeste estudo procuramos determinar a regi\u00e3o de opera\u00e7\u00e3o da coluna em fun\u00e7\u00e3o das suas\n\nvari\u00e1veis independentes, sujeitas \u00e0s restri\u00e7\u00f5es de opera\u00e7\u00e3o, tais como qualidade dos\n\nprodutos, hidr\u00e1ulica da coluna e outras.\n\nEm nosso estudo foram manipuladas a vaz\u00e3o de refluxo e a carga t\u00e9rmica do\n\nrefervedor. As restri\u00e7\u00f5es observadas foram o teor de C4+  no propano, teor de C3- no\n\nbutano, temperatura m\u00e1xima e m\u00ednima no topo e fundo da coluna e o limite de\n\nconverg\u00eancia do processo. Nas tabelas 4.6 e 4.7 apresentamos estes valores.\n\nVari\u00e1vel independente Limite m\u00ednimo Limite m\u00e1ximo Passo\n\nVaz\u00e3o refluxo 2300 m3/d 4000 m3/d 20 m3/d\n\nC. term. refervedor 5.00 MMcal/h 8.0 MMcal/h 0.02 MMcal/h\n\n    Tabela 4.6 \u2013 Vari\u00e1veis manipuladas\n\nRestri\u00e7\u00e3o Limite m\u00ednimo Limite m\u00e1ximo\n\nTeor de C4+ 0 5 %vol.\n\nTeor de C3- 0 5 %vol.\n\nTemperatura topo 44 \u00baC 51 \u00baC\n\nTemperatura fundo 103.5 \u00baC 107.5 \u00baC\n\nC. term. condensador N\u00e3o tem 10.95 MMcal/h\n\nC. term. refervedor N\u00e3o tem 8.32 MMcal/h\n\n    Tabela 4.7 \u2013 Restri\u00e7\u00f5es do processo\n\nA sensibilidade do processo \u00e9 avaliada nesta etapa do estudo de casos, sendo\n\nutilizado para isto a avalia\u00e7\u00e3o dos ganhos est\u00e1ticos do processo. Tamb\u00e9m, podemos\n\n\n\nCap\u00edtulo 4 \u2013 Simula\u00e7\u00e3o est\u00e1tica da depropanizadora 28\n\nanalisar o comportamento do processo, verificando as n\u00e3o-linearidades do processo,\n\nbem como avaliarmos as suas vari\u00e1veis importantes. No cap\u00edtulo 6 faremos uma\n\ndescri\u00e7\u00e3o do estudo de casos e comportamento do processo analisado.\n\n\n\n29\n\n5\n\nSIMULA\u00c7\u00c3O DIN\u00c2MICA DA DEPROPANIZADORA\n\nA constru\u00e7\u00e3o do modelo din\u00e2mico no HYSYS? \u00e9 uma etapa realizada ap\u00f3s a\n\nsimula\u00e7\u00e3o est\u00e1tica, ou seja, uma vez que o modelo f\u00edsico-qu\u00edmico est\u00e1tico esteja\n\nrepresentando a realidade da planta, \u00e9 necess\u00e1rio adicionar outras vari\u00e1veis e opera\u00e7\u00f5es\n\nque afetam a din\u00e2mica do processo, al\u00e9m das vari\u00e1veis da simula\u00e7\u00e3o est\u00e1tica (que requer\n\nsomente composi\u00e7\u00f5es, temperatura, vaz\u00f5es, etc.).\n\nAssim, para realizar a simula\u00e7\u00e3o din\u00e2mica, \u00e9 necess\u00e1rio definir os \u201choldups\u201d\n\n(ac\u00famulos) dos equipamentos, as dimens\u00f5es das v\u00e1lvulas de controle e os controladores\n\ndo n\u00edvel regulat\u00f3rio.\n\nH\u00e1 uma  s\u00e9rie de etapas a serem cumpridas na constru\u00e7\u00e3o do modelo din\u00e2mico\n\ndo HYSYS?, onde as seguintes s\u00e3o particularmente importantes:\n\n\u00fc Obten\u00e7\u00e3o da solu\u00e7\u00e3o do modelo est\u00e1tico;\n\n\u00fc Estabelecimento do esquema de controle para o processo;\n\n\u00fc Defini\u00e7\u00e3o das caracter\u00edsticas din\u00e2micas das opera\u00e7\u00f5es unit\u00e1rias;\n\n\u00fc Defini\u00e7\u00e3o dos controladores e v\u00e1lvulas de controle do sistema;\n\n\u00fc Chaveamento da simula\u00e7\u00e3o do modo est\u00e1tico para o din\u00e2mico.\n\nA seguir apresentaremos as etapas da constru\u00e7\u00e3o do modelo din\u00e2mico de acordo\n\ncom a seq\u00fc\u00eancia acima descrita. Na estrutura dos simuladores, inicialmente devemos\n\nsolucionar o problema de simula\u00e7\u00e3o est\u00e1tica. Para isto, devemos seguir o procedimento\n\ndescrito no cap\u00edtulo anterior.\n\nUma vez obtido o modelo est\u00e1tico, devemos definir as vari\u00e1veis manipuladas e\n\nperturba\u00e7\u00f5es (independentes) e as vari\u00e1veis controladas (dependentes) do esquema de\n\ncontrole do sistema, na forma de controle multimalhas. Deve-se tomar o cuidado de\n\nmanter a coer\u00eancia entre as especifica\u00e7\u00f5es na simula\u00e7\u00e3o est\u00e1tica e as especifica\u00e7\u00f5es das\n\nvari\u00e1veis manipuladas dos controladores para a simula\u00e7\u00e3o din\u00e2mica. Tamb\u00e9m \u00e9\n\nnecess\u00e1rio definir as caracter\u00edsticas din\u00e2micas das opera\u00e7\u00f5es unit\u00e1rias envolvidas na\n\nsimula\u00e7\u00e3o. Por exemplo os ac\u00famulos de l\u00edquidos, incluindo volumes dos pratos da\n\ncoluna, dos vasos, trocadores de calor e  tamb\u00e9m o \u201cset-point\u201d do n\u00edvel fundo da coluna.\n\nAssim, para a simula\u00e7\u00e3o aqui estudada, definimos as caracter\u00edsticas apresentadas na\n\ntabela 5.1.\n\n\n\nCap\u00edtulo 5 - Simula\u00e7\u00e3o din\u00e2mica da depropanizadora 30\n\nEquipamento Caracter\u00edstica Valor\n\nColuna Di\u00e2metro da coluna 3.050 m\n\nN-2406 Comprimento do vertedor 2.52 m\n\nAltura do vertedor 0.08 m\n\nVolume m\u00ednimo 0.58 m3\n\nCondensador M2422A/C Volume do condensador 18.44 m3\n\nO-2407 Volume do vaso 16.22 m3\n\nRefervedor Volume de fundo da torre e refervedor 8.66 m3\n\nM-2423 SP do n\u00edvel de fundo 50 %\n\n    Tabela 5.1 \u2013 Dados geom\u00e9tricos dos equipamentos\n\nAp\u00f3s definirmos os par\u00e2metros geom\u00e9tricos do sistema, devemos estabelecer as\n\nestruturas de controle e as caracter\u00edsticas dos controladores. Isto significa definir as\n\nvari\u00e1veis manipuladas e controladas de cada malha de controle e os seus par\u00e2metros de\n\nconfigura\u00e7\u00e3o e de sintonia.\n\nTemos a seguinte estrutura representada na figura 5.1.\n\n  \n\nFigura 5.1 \u2013 Esquema de controle da coluna depropanizadora.\n\n\n\nCap\u00edtulo 5 - Simula\u00e7\u00e3o din\u00e2mica da depropanizadora 31\n\nO controlador FC-151 \u00e9 um controlador de carga t\u00e9rmica do refervedor.\n\nA tabela 5.2 mostra os par\u00e2metros dos controladores e v\u00e1lvulas para a estrat\u00e9gia\n\nde controle adotada.\n\nMalha Vari\u00e1vel controlada Vari\u00e1vel manipulada A\u00e7\u00e3o\n\nNome Min. Max. No\n\nme\n\nMin. Max.\n\nFC-54 VRF 0 7000 m\n3/d VRF 0 7000 m\n\n3/d Reversa\n\nPC-81 P#24 7 25 kgf/cm2man VPP 0 3000 m\n3/d Direta\n\nFC-151 QREB 0 10 MMcal/h QRE\n\nB\n\n0 10 MMcal/h Reversa\n\nLC-29 LREB 0 100 % VBU\n\nTANO\n\n0 3000  m3/d Direta\n\nFC-52 vCARGA 0 100 % vCA\n\nRGA\n\n0 5000 m3/d Direta\n\n  Tabela 5.2 \u2013 Par\u00e2metros de configura\u00e7\u00e3o dos controladores\n\nSendo:\n\nVRF \u2013 Vaz\u00e3o de refluxo de topo;\n\nP#24    \u2013 Press\u00e3o no est\u00e1gio 24;\n\nQREB       \u2013 Carga t\u00e9rmica do refervedor;\n\nLREB    \u2013 N\u00edvel de fundo da coluna;\n\nVBUTANO \u2013 Vaz\u00e3o de butano;\n\nVPP         \u2013 Vaz\u00e3o de propano;\n\nVCARGA    \u2013 Vaz\u00e3o de GLP;\n\nMalha Par\u00e2metros de sintonia\nKc ?i ?d\n\nFC-54 0.75 0.25 0.0\n\nPC-81 0.35 1.35 0.0\n\nFC-151 0.8 0.1 0.0\n\nLC-29 1.0 0.2 0.0\n\nFC-52 1.0 0.1 0.0\n\n              Tabela 5.3 \u2013 Par\u00e2metros de sintonia dos controladores\n\n\n\nCap\u00edtulo 5 - Simula\u00e7\u00e3o din\u00e2mica da depropanizadora 32\n\nO sistema de controle do HYSYS? pode ser representado pela estrutura da\n\nmalha fechada na figura 5.2. A equa\u00e7\u00e3o do controlador (apresentada na se\u00e7\u00e3o 13.4.3\n\np\u00e1gina 425 do manual de refer\u00eancia na sua vers\u00e3o 1.0) tem a seguinte forma:\n\n( ) ( ) ( ) ( )\ndt\n\ntdE\nKdttE\n\nK\ntEKOPtOP DC\n\nI\n\nC\nCSS ??\n\n+++= ? (5.1)\n\nsendo:\n\nOP(t) - Sa\u00edda do controlador no instante t\n\nOPSS - Sa\u00edda do controlador no estado estacion\u00e1rio inicial\n\nE(t) - Erro no instante t\n\nKC - Ganho proporcional do controlador\n\n?I - Tempo integral do controlador\n\n?D - Tempo derivativo do controlador\n\nO erro deve ser definido tendo como refer\u00eancia a a\u00e7\u00e3o reversa do controlador, ou\n\nseja, se a PV ultrapassa o SP para cima, a sa\u00edda do controlador (OP) deve decrescer.\n\nPortanto, neste caso:\n\n( ) ( ) ( )tPVtSPtE ?= (5.1a)\nsendo:\n\nSP - Setpoint da vari\u00e1vel controlada\n\nPV - Vari\u00e1vel de processo da vari\u00e1vel controlada\n\nNo equacionamento do bloco de elemento final de controle da figura 5.2,\n\ndevemos aplicar o modelo da v\u00e1lvula para a fase l\u00edquida ou vapor, conforme o caso. A\n\nequa\u00e7\u00e3o da v\u00e1lvula de controle para a fase l\u00edquida \u00e9 dada por:\n\n( ) minminmax100\n%\n\nFFF\nOP\n\nF +?= (5.1b)\n\nsendo:\n\nF - Vaz\u00e3o atrav\u00e9s da v\u00e1lvula de controle\n\nOP% - sa\u00edda do controlador em percentagem\n\nFmax - Vaz\u00e3o m\u00e1xima atrav\u00e9s da v\u00e1lvula de controle\n\n\n\nCap\u00edtulo 5 - Simula\u00e7\u00e3o din\u00e2mica da depropanizadora 33\n\nFmin - Vaz\u00e3o m\u00ednima atrav\u00e9s da v\u00e1lvula de controle\n\nFigura 5.2 \u2013 Diagrama em blocos da malha fechada.\n\nNessa etapa a simula\u00e7\u00e3o din\u00e2mica est\u00e1 quase conclu\u00edda, restando apenas chavear\n\na simula\u00e7\u00e3o do modo est\u00e1tico para o din\u00e2mico. Esta opera\u00e7\u00e3o \u00e9 simples, e consiste do\n\nsimulador resolver o problema correspondente ao estado estacion\u00e1rio do modo din\u00e2mico\n\nutilizando os valores das vari\u00e1veis independentes e as propriedades iniciais da\n\nsimula\u00e7\u00e3o est\u00e1tica. Como o conjunto de equa\u00e7\u00f5es \u00e9 ligeiramente diferente do utilizado\n\nno modo est\u00e1tico, este fato faz com que tenhamos ligeiras diferen\u00e7as entre os estados\n\nestacion\u00e1rios dos dois modos.\n\nEstando no modo din\u00e2mico podemos iniciar os testes para obten\u00e7\u00e3o dos modelos\n\ndo processo.\n\n\n\n34\n\n6\n\nCOMPORTAMENTO DO PROCESSO\n\nA coluna depropanizadora tem como restri\u00e7\u00f5es especificar o teor do componente\n\nchave pesado no propano, representado pelo C4\n+, e o componente chave leve do butano,\n\nrepresentado pelo teor de C3\n-. O objetivo neste caso \u00e9 limitar a quantidade de fra\u00e7\u00f5es\n\npesadas no propano para termos o m\u00ednimo de perda de butanos. Avaliaremos a varia\u00e7\u00e3o\n\ndestas especifica\u00e7\u00f5es em toda a regi\u00e3o de opera\u00e7\u00e3o das vari\u00e1veis manipuladas.\n\nA caracter\u00edstica b\u00e1sica do controle dual \u00e9 a especifica\u00e7\u00e3o dos produtos de topo e\n\nfundo da coluna, sendo que, no processo de separa\u00e7\u00e3o a qualidade do produto de topo\n\nest\u00e1 ligada \u00e0 do fundo atrav\u00e9s do fracionamento da coluna. O fracionamento \u00e9 definido\n\nprincipalmente pela rela\u00e7\u00e3o L/V, que \u00e9 estabelecido externamente pela vaz\u00e3o de refluxo\n\ne a carga t\u00e9rmica do refervedor. A figura 6.1 apresenta a rela\u00e7\u00e3o entre as qualidades dos\n\ndois produtos para diferentes valores de QReb e L/V. Vemos que, para um dado QReb, a\n\nrela\u00e7\u00e3o entre as duas sa\u00eddas \u00e9 razoavelmente linear em grande parte do diagrama. Isto\n\nindica que as duas sa\u00eddas nessa regi\u00e3o s\u00e3o lineares em rela\u00e7\u00e3o a L/V. Entretanto, para\n\nvalores de C3\n-  e C4\n\n+ abaixo de 3%, esse comportamento deixa de ser linear, e a n\u00e3o-\n\nlinearidade aumenta acentuadamente na regi\u00e3o indicada na figura.\n\nQuando a carga t\u00e9rmica do refervedor aumenta, estamos aumentando o\n\nfracionamento da coluna, que \u00e9 representado pelas curvas mais a esquerda da figura.\n\nFigura 6.1 \u2013 Dualidade das qualidades dos produtos da coluna\n\n\n\nCap\u00edtulo 6 - Comportamento do processo 35\n\nAs vari\u00e1veis manipuladas pelo controle supervis\u00f3rio ter\u00e3o especial aten\u00e7\u00e3o no\n\nestudo, pois afetam diretamente a qualidade dos produtos. No pr\u00f3ximo item\n\napresentamos o comportamento do processo para as duas vari\u00e1veis de controle\n\nregulat\u00f3rio consideradas neste estudo.\n\n6.1 \u2013 Regi\u00e3o de opera\u00e7\u00e3o e ganhos do processo:\n\nA regi\u00e3o de opera\u00e7\u00e3o foi levantada considerando-se as seguintes vari\u00e1veis no\n\ncontrole preditivo:\n\n\u2022 Vari\u00e1veis Controladas\n\n\u00fc Teor de C4\n+ no propano (C4\n\n+)[%]\n\n\u00fc Temperatura de topo (Ttopo) [kPa], esta \u00e9 uma vari\u00e1vel redundante em\n\nrela\u00e7\u00e3o ao teor de C4\n+. Esta vari\u00e1vel ser\u00e1 utilizada em substitui\u00e7\u00e3o ao teor\n\nde C4\n+, pois a infer\u00eancia utilizada atualmente para c\u00e1lculo deste teor n\u00e3o\n\napresenta resultados satisfat\u00f3rios.\n\n\u00fc Teor de C3\n-  no butano (C3\n\n-) [%]\n\nOs modelos de infer\u00eancia para o teor de C4\n+ e C3\n\n-, s\u00e3o baseados em correla\u00e7\u00f5es\n\nmultilineares utilizando-se dados de an\u00e1lise cromatogr\u00e1fica das correntes de propano e\n\nbutano e vari\u00e1veis operacionais da planta industrial. Para obten\u00e7\u00e3o das correla\u00e7\u00f5es,\n\nnormalmente utiliza-se o m\u00e9todo dos m\u00ednimos quadrados para ajuste dos par\u00e2metros das\n\ncorrela\u00e7\u00f5es. Esta metodologia apesar de em alguns casos apresentar resultados\n\nsatisfat\u00f3rios a n\u00edvel industrial, n\u00e3o \u00e9 a mais recomendada principalmente nos casos em\n\nque os produtos t\u00eam pureza relativamente elevada como no caso da coluna\n\ndepropanizadora. Assim, a utiliza\u00e7\u00e3o de outras metodologias deve ser testada\n\nprincipalmente aquelas que levem em conta modelos fundamentais do equil\u00edbrio\n\nl\u00edquido-vapor.  Os modelos utilizados atualmente para o teor de C4\n+ e C3\n\n- s\u00e3o\n\napresentados a seguir:\n\nfxexdxcxxxxxbxaC ++++?+=? 9876543213 ***)*/()(***\n\n( ) exdxcxbxaC ++++=+ 432\n2\n\n14 ****\n\n\n\nCap\u00edtulo 6 - Comportamento do processo 36\n\nPAR\u00c2METROS PARA TEOR DE C3\n- PAR\u00c2METROS PARA TEOR DE C4\n\n+\n\nCoeficientes Vari\u00e1veis Coeficientes Vari\u00e1veis\n\na = -0.6586 x1 = temp. fundo a = 0.3714 x1 = temp. topo\n\nb = -1.6912 x2 = vaz\u00e3o GOP b = 0.6198 x2 = press\u00e3o est\u00e1gio 24\n\nc = -0.0239 x3 = temp. GOP c = -19.8385 x3 = temp. topo\n\nd = 0.02027 x4 = temp. fundo d = -0.04781 x4 = temp. refluxo\n\ne = 0.1720 x5 = vaz\u00e3o carga e = 464.19 -\n\nf = 50.80 x6 = temp. carga - -\n\n- x7 = temp. est\u00e1gio 24 - -\n\n- x8 = press\u00e3o est\u00e1gio 24 - -\n\n- x9 = temp. sa\u00edda\n\nrefervedor\n\n- -\n\nTabela 6.1 \u2013 Par\u00e2metros dos modelos das infer\u00eancias.\n\n\u2022 Vari\u00e1veis manipuladas\n\n\u00fc Vaz\u00e3o de refluxo de topo  (VRF)  [m\n3/d]\n\n\u00fc Carga t\u00e9rmica do refervedor  (QREB) [MMcal/h] , o controlador preditivo\n\nmanipular\u00e1 a vaz\u00e3o de fluido  de aquecimento (gas\u00f3leo pesado -  VGOP)\n\npara o refervedor.\n\n\u2022 Vari\u00e1veis perturbadoras (s\u00e3o vari\u00e1veis independentes e que s\u00e3o medidas)\n\n\u00fc Vaz\u00e3o de carga (VFD)  [m\n3/d]\n\n\u00fc Temperatura do fluido de aquecimento (TGOP)  [\u00baC]\n\nComo temos uma s\u00e9rie de restri\u00e7\u00f5es a serem obedecidas, as vari\u00e1veis\n\nmanipuladas n\u00e3o poder\u00e3o assumir valores quaisquer. A regi\u00e3o delimitada por\n\nestas condi\u00e7\u00f5es \u00e9 chamada de regi\u00e3o de opera\u00e7\u00e3o do sistema. No nosso caso a\n\nregi\u00e3o de opera\u00e7\u00e3o pode ser definida pelas seguintes restri\u00e7\u00f5es:\n\n\u00fc Existe um estado estacion\u00e1rio, isto \u00e9, h\u00e1 l\u00edquido em todos os est\u00e1gios da\n\ncoluna;\n\n\u00fc Quantidade m\u00e1xima de C4\n+ no propano em fun\u00e7\u00e3o da perda de componentes\n\nnobres (iso-butano). A perda elevada de iso-butano na corrente de propano\n\nir\u00e1 implicar na necessidade de importa\u00e7\u00e3o deste componente para suprir as\n\n\n\nCap\u00edtulo 6 - Comportamento do processo 37\n\nnecessidades da unidade de gasolina de avia\u00e7\u00e3o. O valor m\u00e1ximo\n\nconsiderado de butanos ( C4\n+ ) foi de 5%.\n\n\u00fc Quantidade m\u00e1xima de C3\n- no butano, a presen\u00e7a de componentes leves na\n\ncorrente de butano ir\u00e1 implicar na perda de controle operacional na unidade\n\nde gasolina de avia\u00e7\u00e3o, ocasionando a queima de produtos nobres no sistema\n\nde tocha da refinaria. O valor m\u00e1ximo considerado de C3\n- foi de 5%.\n\nO sistema apresenta folgas de projeto em rela\u00e7\u00e3o \u00e0s cargas t\u00e9rmicas do\n\ncondensador e refervedor, n\u00e3o apresentando restri\u00e7\u00f5es quanto \u00e0 vaz\u00f5es de\n\nrefluxo ou de flu\u00eddo de aquecimento para o refervedor. A hidr\u00e1ulica da coluna\n\ntamb\u00e9m apresenta folga, sendo poss\u00edvel processar todo o GLP produzido na\n\nunidade bem como correntes provenientes de outras unidades.\n\nDiante das restri\u00e7\u00f5es acima, temos a regi\u00e3o de opera\u00e7\u00e3o mostrada na figura\n\n6.2, onde vemos que h\u00e1 uma s\u00e9rie limitada de pares de valores das vari\u00e1veis\n\nmanipuladas onde o processo \u00e9 vi\u00e1vel. Para levantamento da regi\u00e3o de opera\u00e7\u00e3o,\n\nas vari\u00e1veis perturbadoras s\u00e3o mantidas constantes.\n\n           \n\n            Figura 6.2 \u2013 Regi\u00e3o de opera\u00e7\u00e3o das vari\u00e1veis manipuladas\n\nUma maneira eficiente para se observar o comportamento do processo \u00e9 avaliar\n\nas curvas de ganhos do processo. Esses ganhos s\u00e3o estimados utilizando-se a derivada\n\nem v\u00e1rios pontos ao longo da regi\u00e3o de opera\u00e7\u00e3o, por exemplo para o teor de C3\n- em\n\n\n\nCap\u00edtulo 6 - Comportamento do processo 38\n\nrela\u00e7\u00e3o \u00e0 vaz\u00e3o de refluxo ter\u00edamos:\n\nsendo:\n\n?\ni3,KpC - ganho est\u00e1tico para o teor de C3\n\n- no ponto de opera\u00e7\u00e3o atual.\n\n   ?i3,C  - teor de C3\n- no ponto de opera\u00e7\u00e3o atual.\n\n   ? ?1i3,C  - teor de C3\n- no ponto de opera\u00e7\u00e3o anterior.\n\n   iRF,V  - vaz\u00e3o de refluxo no ponto de opera\u00e7\u00e3o atual.\n\n   1iRF,V ?  - vaz\u00e3o de refluxo no ponto de opera\u00e7\u00e3o anterior.\n\nEstes ganhos est\u00e3o representadas nas figuras 6.3 a 6.8. Nas figuras podemos\n\nobservar que os ganhos do C3\n- com a VRF (vaz\u00e3o de refluxo) variam de 0.001 a 0.17\n\n%vol/(m3/d), do C3\n- com a VGOP (vaz\u00e3o de GOP) variam de \u20130.25 a \u20130.0015 %vol/(\n\nm3/d), do teor de C4\n+ com VRF  variam de \u20130.07 a \u20130.0005 %vol/( m\n\n3/d) e com a VGOP\n\nvariam de 0.0010 a 0.150, da temperatura de topo com a VRF variam de -0.015 a -0.0450\n\n\u00baC/(m3/d) e com a VGOP variam de 0.030 a 0.13 \u00baC/(m\n3/d). Isto mostra que, para um\n\ndado par (manipulada e controlada),  os ganhos do processo variam muito, o que leva a\n\ncrer que a utiliza\u00e7\u00e3o de um \u00fanico modelo para o controlador preditivo, poder\u00e1 levar a\n\numa performance n\u00e3o adequada do sistema.\n\n    Figura 6.3 \u2013 Ganhos do C3- versus a vaz\u00e3o de refluxo\n\n( ) ( )1iRF,iRF,1i3,i3,i3, VV/CCKpC ?? ??? ??=\n\n\n\nCap\u00edtulo 6 - Comportamento do processo 39\n\n \n\n  Figura 6.4 \u2013 Ganhos do C3- versus Vaz\u00e3o de GOP\n\n Figura 6.5 \u2013 Ganhos do C4\n+  versus vaz\u00e3o de refluxo\n\n\n\nCap\u00edtulo 6 - Comportamento do processo 40\n\nFigura 6.6 \u2013 Ganhos do C4\n+ versus vaz\u00e3o de GOP\n\n Figura 6.7 \u2013 Ganhos da temperatura de topo versus vaz\u00e3o de refluxo\n\n\n\nCap\u00edtulo 6 - Comportamento do processo 41\n\n Figura 6.8 \u2013 Ganhos da temperatura de topo versus vaz\u00e3o de GOP\n\nDiante dos valores apresentados, podemos concluir que o controle preditivo\n\nlinear encontrar\u00e1 dificuldades para manter a qualidade dos produtos. Este fato \u00e9 coerente\n\ncom a observa\u00e7\u00e3o do que ocorre em outras colunas de destila\u00e7\u00e3o nas plantas industriais,\n\nonde verifica-se que com esse tipo de varia\u00e7\u00f5es no ganho do modelo o controlador tem\n\nrea\u00e7\u00e3o muito lenta em determinadas condi\u00e7\u00f5es e oscila excessivamente em outras\n\ncondi\u00e7\u00f5es de opera\u00e7\u00e3o. Al\u00e9m disso, quando realizamos o teste em degrau na planta, em\n\ndeterminadas regi\u00f5es de opera\u00e7\u00e3o, as respostas das vari\u00e1veis controladas s\u00e3o diferentes\n\ndependendo se aplicamos degraus positivos ou negativos e dependendo da amplitude do\n\ndegrau. Isto \u00e9 evidenciado nas tabelas 6.2 e 6.3, onde variamos o degrau de 1 a 5% nas\n\nvari\u00e1veis manipuladas para cima e para baixo em torno do \u201ccaso base\u201d.\n\nDegrau (%) Kp C3\n- Kp C4\n\n+ Kp Ttopo\n\n-5.0 8.44E-04 -3.71E-02 -2.43E-02\n-3.0 1.09E-03 -3.90E-02 -2.61E-02\n-1.0 2.04E-03 -5.10E-02 -3.58E-02\n\n1.0 5.54E-02 -2.94E-02 -2.75E-02\n3.0 1.23E-01 -1.02E-02 -2.65E-02\n\nTabela 6.2 \u2013 Ganhos do processo em rela\u00e7\u00e3o \u00e0 vaz\u00e3o de refluxo.\n\n\n\nCap\u00edtulo 6 - Comportamento do processo 42\n\nDegrau (%) Kp C3\n- Kp C4\n\n+ Kp Ttopo\n\n-3.0 -6.49E-01 2.10E-02 9.60E-01\n-1.0 -1.36E-01 5.79E-02 5.70E-02\n\n1.0 -5.22E-03 1.14E-01 7.91E-02\n3.0 -8.97E-03 2.61E-01 1.73E-01\n5.0 -2.32E-03 8.07E-02 5.23E-02\n\n                   Tabela 6.3 \u2013 Ganhos do processo para a vaz\u00e3o de GOP.\n\nNas  tabelas 6.4 e 6.5 s\u00e3o apresentados os ganhos para as vari\u00e1veis perturbadoras\n\nque ser\u00e3o utilizadas no controlador. Aqui tamb\u00e9m \u00e9 poss\u00edvel observar a grande varia\u00e7\u00e3o\n\ndo ganho em fun\u00e7\u00e3o do degrau aplicado e do sentido (aumento ou redu\u00e7\u00e3o da vari\u00e1vel)\n\ndo mesmo.\n\nDegrau (%) Kp C3\n- Kp C4\n\n+ Kp Ttopo\n\n-10.0 0.00192 -0.01709 -0.01216\n-5.0 0.00155 -0.01782 -0.01255\n-3.0 0.00128 -0.01567 -0.01089\n-1.0 0.00096 -0.01284 -0.00859\n\n1.0 0.00266 -0.01525 -0.01104\n3.0 0.00671 -0.01350 -0.01026\n5.0 0.01355 -0.00923 -0.00798\n10.0 0.02007 -0.00478 -0.00566\n\n                  Tabela 6.4 \u2013 Ganhos do processo para a vaz\u00e3o de carga .\n\nDegrau\n(\u00baC)\n\nKp C3\n- Kp C4\n\n+ Kp Ttopo\n\n-3.6 -3.42742 0.34303 0.73712\n-1.6 -2.09024 0.75228 0.78103\n-0.6 -0.48027 1.58481 1.18692\n\n0.6 -0.11253 2.00225 1.42429\n1.6 -0.05985 1.39626 0.95874\n3.6 -0.04473 1.22596 0.82054\n\n            Tabela 6.5 \u2013 Ganhos do processo para a temperatura do fluido de aquecimento.\n\n\n\n43\n\n7\n\nIDENTIFICA\u00c7\u00c3O DOS MODELOS DO SISTEMA\n\nPodemos dizer que a identifica\u00e7\u00e3o do modelo do processo \u00e9 uma das etapas mais\n\nimportantes no projeto e an\u00e1lise de um controlador, pois caso se utilize um modelo\n\ninadequado, a performance do controle ficar\u00e1 prejudicada e sua an\u00e1lise ser\u00e1 incorreta.\n\nAssim, devemos ter em mente uma s\u00e9rie de considera\u00e7\u00f5es sobre os modelos a serem\n\nutilizados, tais como:\n\n\u2022 Que tipo de modelo o controlador utiliza?\n\nPara responder esta pergunta devemos considerar uma s\u00e9rie de caracter\u00edsticas do\n\nsistema, como: se o modelo deve ser linear ou n\u00e3o-linear, fenomenol\u00f3gico ou\n\nemp\u00edrico, invariante ou variante no tempo.\n\n\u2022 Qual a forma de apresenta\u00e7\u00e3o do modelo?\n\nDevemos responder se o modelo deve ser apresentado na forma de fun\u00e7\u00e3o de\n\ntransfer\u00eancia, ou resposta ao degrau ou impulso. Se apresentarmos o modelo na\n\nforma de fun\u00e7\u00e3o de transfer\u00eancia, devemos definir se o modelo ser\u00e1 apresentado\n\nno dom\u00ednio de tempo cont\u00ednuo ou discreto. Se o modelo estiver na forma de\n\nresposta ao degrau ou impulso, podemos apresent\u00e1-lo na forma de s\u00e9rie temporal\n\nou na forma anal\u00edtica.\n\n\u2022 Qual a necessidade de se utilizar mais de um modelo do processo?\n\nPara sistemas variantes no tempo, muitas vezes um \u00fanico modelo n\u00e3o atende \u00e0\n\nperformance desejada em toda a regi\u00e3o de opera\u00e7\u00e3o do sistema. Isto ocorre\n\nquando o processo altera suas caracter\u00edsticas, por exemplo, altera\u00e7\u00e3o da natureza\n\nda mat\u00e9ria-prima, ou degrada\u00e7\u00e3o do processo por desgaste do equipamento,\n\ncomo colunas de destila\u00e7\u00e3o cuja efici\u00eancia do est\u00e1gio cai por vazamento nas\n\nbandejas. Neste caso, devemos decidir se iremos utilizar um conjunto de\n\nmodelos pr\u00e9-definidos ou se adaptaremos algum par\u00e2metro do modelo do\n\nprocesso, por exemplo o seu ganho est\u00e1tico.\n\nNo caso da coluna depropanizadora temos regi\u00f5es de fortes  n\u00e3o-linearidades nos\n\nganhos, que devem ter, portanto, grandes altera\u00e7\u00f5es na sua din\u00e2mica, e temos regi\u00f5es\n\n\n\nCap\u00edtulo 7 - Identifica\u00e7\u00e3o dos modelos do sistema 44\n\nonde os modelos obtidos s\u00e3o incompat\u00edveis sob o aspecto de utiliza\u00e7\u00e3o em controle\n\npreditivo.\n\n7.1 \u2013 Algoritmo de identifica\u00e7\u00e3o com modelos na forma anal\u00edtica\n\nNeste trabalho utilizaremos um conjunto de modelos convenientemente\n\nescolhidos sendo apresentados na forma de resposta ao degrau anal\u00edtico no dom\u00ednio do\n\ntempo cont\u00ednuo. Esta representa\u00e7\u00e3o pode ser visualizada atrav\u00e9s das seguintes equa\u00e7\u00f5es:\n\n( ) ji\nna\n\ng\ngjigjijinji\n\njinji\n\nnTnTfccs\n\nnTs\n\n,\n1\n\n,,,,0,,,,\n\n,,, 0\n\n?\n\n?\n\n??+=\n\n??=\n\n?\n=\n\n(7.1)\n\nsendo:\n\ni - i-\u00e9sima vari\u00e1vel de sa\u00edda (controlada)\n\nj - j-\u00e9sima vari\u00e1vel de entrada (manipulada e perturba\u00e7\u00e3o)\n\n?i,j - tempo morto do par de vari\u00e1veis i,j\n\nn - instante de amostragem\n\n( )\n\n( ) ( )\n\n( )\n\nf t\n\nf t e r\n\nf t t r\n\ni j\n\ni j g\nr t\n\ni j g\n\ni j g i j i j g\n\ni j g i j\n\n, ,\n\n, , , ,\n\n, , , , ,\n\n, , ,\n\n0 1\n\n0\n\n0\n\n=\n\n= ? ?\n\n= ? ? =\n\n??\n\n?\n\nO comportamento din\u00e2mico da maioria dos processos pode ser representado por\n\nequa\u00e7\u00f5es diferenciais de primeira ou segunda ordem. No caso de processos em s\u00e9rie,\n\ncomo por exemplo \u201cn\u201d est\u00e1gios de equil\u00edbrio, a fun\u00e7\u00e3o de transfer\u00eancia resultante tem a\n\nordem correspondente \u00e0 multiplica\u00e7\u00e3o das v\u00e1rias fun\u00e7\u00f5es de transfer\u00eancia. Felizmente\n\nos processos qu\u00edmicos de ordens elevadas t\u00eam normalmente comportamento que pode\n\nser razoavelmente aproximado por um modelo de ordem menor. Os controladores em\n\nmalha fechada podem adicionar ra\u00edzes complexas ou zeros \u00e0s fun\u00e7\u00f5es de transfer\u00eancias.\n\nAl\u00e9m disso, sistemas com fun\u00e7\u00f5es de transfer\u00eancia em paralelo, podem adicionar zeros\n\nno processo resultante, gerando por exemplo, resposta inversa.\n\nDiante deste comportamento, podemos dizer que a maioria dos processos podem\n\nser representados pela seguinte fun\u00e7\u00e3o de transfer\u00eancia:\n\n\n\nCap\u00edtulo 7 - Identifica\u00e7\u00e3o dos modelos do sistema 45\n\n( ) ?se\nsasa\n\nsbb\nsG ?\n\n++\n+\n\n=\n2\n\n21\n\n10\n\n1\n(7.2)\n\nConsiderando o modelo sem a componente do tempo morto, temos:\n\n( )\n2\n\n21\n\n10\n\n1 sasa\nsbb\n\nsG\n++\n\n+\n= (7.3)\n\nConsiderando a aplica\u00e7\u00e3o de um degrau unit\u00e1rio ao sistema temos:\n\n( ) ( )\ns\n\nsGsyd\n1\n\n\u00d7= (7.4)\n\nsubstituindo a equa\u00e7\u00e3o (7.3) em (7.4), temos:\n\n( )\nssasa\n\nsbb\nsyd\n\n1\n1 221\n\n10 \u00d7\n++\n\n+\n=\n\nfatorando yd(s), temos:\n\n( )\n( )( )sss\n\nsbb\nsyd 11 21\n\n10\n\n++\n+\n\n=\n??\n\nou\n\n( )\nsss\n\nsbb\nsyd\n\n??\n?\n\n?\n??\n?\n\n?\n+??\n\n?\n\n?\n??\n?\n\n?\n+\n\n+\n=\n\n21\n\n10\n\n21 11\n1\n\n??\n??\n\nPortanto as ra\u00edzes do denominador s\u00e3o:\n\n0;\n1\n\n;\n1\n\n3\n2\n\n2\n1\n\n1 =?=?= rrr ??\n\nEnt\u00e3o a resposta ao degrau do sistema pode ser representada por:\n\n( )\n( )( )srsrs\n\nsbb\nrrsyd\n\n21\n\n10\n21 ??\n\n+\n=\n\nSeparando a resposta ao degrau em fra\u00e7\u00f5es parciais, temos:\n\n\n\nCap\u00edtulo 7 - Identifica\u00e7\u00e3o dos modelos do sistema 46\n\n( )\n2\n\n2\n\n1\n\n10\n\nrs\nc\n\nrs\nc\n\ns\nc\n\nsyd ?\n+\n\n?\n+=\n\nsendo:\n\n00 bc =\n\n12\n\n1\n1\n\n0\n\n1\n21\n\n110\n21 11\n\n1\n\nrr\n\nb\nr\n\nb\ncou\n\nrr\nrbb\n\nrc\n?\n\n+\n=\n\n?\n+\n\n=\n\n21\n\n1\n2\n\n0\n\n2\n12\n\n210\n12 11\n\n1\n\nrr\n\nb\nr\n\nb\ncou\n\nrr\nrbb\n\nrc\n?\n\n+\n=\n\n?\n+\n\n=\n\nPassando a resposta ao degrau para o dom\u00ednio do tempo e incluindo o termo do\n\ntempo morto, teremos:\n\n( ) ( ) ( )?? ?? ++= trtrd ececcty 21 210 (7.5)\n\nNo caso de um sistema SISO, podemos escrever a equa\u00e7\u00e3o da predi\u00e7\u00e3o da sa\u00edda\n\npara um instante qualquer, na seguinte forma param\u00e9trica:\n\n[ ] [ ] ( )??+= ?\n=\n\njTfppy g\nna\n\ng\nkgkj\n\n1\n0 (7.6)\n\n[ ] [ ] 10100 ?? ?+= kkk ucpp            (7.7)\n\n[ ] [ ] 11 ?? ?+= k\nTr\n\ng\nTr\n\nkgkg\nuecepp gg\n\nsendo:\n\ng = 1, 2, \u2026, na\n\n?\n?\n?\n\n?\n?\n?\n\n++= 1int\nT\n\nkj\n?\n\nsendo que:\n\nk = 1, 2,\u2026, ns-?/T-1\n\n? - tempo morto\n\n T - per\u00edodo de amostragem\n\nns - horizonte da predi\u00e7\u00e3o\n\nint() - valor inteiro\n\n\n\nCap\u00edtulo 7 - Identifica\u00e7\u00e3o dos modelos do sistema 47\n\nna - n\u00famero de p\u00f3los do processo\n\nA identifica\u00e7\u00e3o dos modelos do processo consiste na determina\u00e7\u00e3o dos\n\npar\u00e2metros cg, rg e ? para g = 0, 1, 2, \u2026, na da equa\u00e7\u00e3o (7.6). Este ajuste de par\u00e2metros\n\n\u00e9 efetuado atrav\u00e9s de um procedimento de busca n\u00e3o-linear. Normalmente na\n\nidentifica\u00e7\u00e3o do processo, os modelos s\u00e3o apresentados na forma discreta. Neste\n\ntrabalho, os modelos ser\u00e3o apresentados na forma cont\u00ednua.\n\nA identifica\u00e7\u00e3o do processo consiste das seguintes etapas:\n\n1 \u2013 Assumir os valores iniciais para os par\u00e2metros:\n\nConsiderando o modelo definido pela equa\u00e7\u00e3o (7.2), a predi\u00e7\u00e3o da sa\u00edda que \u00e9\n\ndada pela equa\u00e7\u00e3o (7.6), fica:\n\n[ ] [ ] ( ) [ ] ( )?? ?? ++= jTrkjTrkkj epeppy 21 210\nsendo:\n\n[ ] [ ] 11111 11 ?? ?+= k\nTrTr\n\nkk uecepp (7.8)\n\n[ ] [ ] 12122 22 ?? ?+= k\nTrTr\n\nkk uecepp (7.9)\n\nOs par\u00e2metros a serem ajustados, para os quais devemos assumir valores iniciais,\n\ns\u00e3o: c1, c2, r1, r2 e ?. Al\u00e9m disso, inicialmente assumimos que o processo esteja no\n\nestado estacion\u00e1rio, portanto:\n\n[ ] 110 yp =\n[ ] 011 =p\n[ ] 012 =p\n\nsendo:\n\ny1 \u2013 Valor inicial da sa\u00edda\n\n2 \u2013 Calcular as predi\u00e7\u00f5es da sa\u00edda:\n\nNesta etapa calculamos as predi\u00e7\u00f5es da sa\u00edda nos instantes k = 1, 2,\u2026, ns-?/T-1\n\ncom os par\u00e2metros calculados atrav\u00e9s das equa\u00e7\u00f5es (7.7) a (7.9).\n\n3 \u2013 Calcular o res\u00edduo da predi\u00e7\u00e3o atrav\u00e9s do crit\u00e9rio quadr\u00e1tico:\n\n\n\nCap\u00edtulo 7 - Identifica\u00e7\u00e3o dos modelos do sistema 48\n\n( )?\n+=\n\n?=\nsn\n\nTj\njjj yyISE\n\n1\n\n2\u02c6\n?\n\n?\n\nsendo:\n\njy  - valor medido da sa\u00edda no instante j\n\njy?  - valor da predi\u00e7\u00e3o da sa\u00edda no instante j\n\nj?  - peso que pune o desvio no instante j\n\n4 \u2013 Executar o procedimento de otimiza\u00e7\u00e3o dos par\u00e2metros do modelo, formulando o\n\nproblema da seguinte forma:\n\nISE\nrrcc ?,,,, 2121\n\nmin\n\nsujeito \u00e0:\n\n?\n=\n\n?=\nna\n\ng\ng cc\n\n1\n0 (7.10)\n\nA restri\u00e7\u00e3o apresentada pela equa\u00e7\u00e3o (7.10) garante que o sistema seja\n\nestritamente pr\u00f3prio. Os par\u00e2metros cg e rg do modelo podem ser complexos e o\n\npar\u00e2metro c0 \u00e9 um n\u00famero real. No caso do modelo utilizado neste trabalho, a equa\u00e7\u00e3o\n\n(7.10) fica:\n\n210 ccc +=?\n\nComo a predi\u00e7\u00e3o da sa\u00edda \u00e9 uma fun\u00e7\u00e3o exponencial, devemos utilizar um\n\nalgoritmo da programa\u00e7\u00e3o n\u00e3o-linear.\n\nNo processo de identifica\u00e7\u00e3o foram efetuados testes que consistiram na aplica\u00e7\u00e3o\n\nde degraus nas vari\u00e1veis manipuladas e perturbadoras individualmente, ou seja, aplicou-\n\nse um degrau em uma dada entrada, aguardou-se o processo atingir o estado estacion\u00e1rio\n\ne em seguida se aplicou um degrau na vari\u00e1vel seguinte. A escolha dos pontos de\n\nopera\u00e7\u00e3o onde os testes foram executados levou em conta as faixas de ganhos do\n\nprocesso e a regi\u00e3o de opera\u00e7\u00e3o em que o controlador dever\u00e1 operar.\n\nNo pr\u00f3ximo item apresentamos os resultados da identifica\u00e7\u00e3o dos modelos do\n\nprocesso para as duas composi\u00e7\u00f5es de carga utilizadas.\n\n\n\nCap\u00edtulo 7 - Identifica\u00e7\u00e3o dos modelos do sistema 49\n\n7.2 \u2013 Modelos de processo identificados:\n\nForam aplicados degraus nas seguintes vari\u00e1veis manipuladas e perturbadoras do\n\ncontrole supervis\u00f3rio:\n\n\u00fc Vaz\u00e3o de refluxo de topo (VRF) [m\n3/d]\n\n\u00fc Vaz\u00e3o de fluido de aquecimento (VGOP) [m\n3/d]\n\n\u00fc Vaz\u00e3o de carga (VCARGA) [m\n3/d]\n\n\u00fc Temperatura do fluido de aquecimento (TGOP)  [\u00baC]\n\nForam efetuados testes em 5 pontos da regi\u00e3o de opera\u00e7\u00e3o do sistema. Na figura\n\n7.1, vemos os pontos escolhidos assinalados de 1 a 5, que correspondem aos n\u00fameros\n\ndos modelos identificados. Os modelos de 1 a 3 s\u00e3o referentes \u00e0 composi\u00e7\u00e3o de carga 1\n\ne os modelos 4 e 5 se referem \u00e0 composi\u00e7\u00e3o de carga 2. O ponto FD corresponde a um\n\nmodelo obtido atrav\u00e9s de teste realizado na planta industrial, o teste consistiu na\n\naplica\u00e7\u00e3o de degraus nas vari\u00e1veis manipuladas e perturbadoras, sendo o modelo obtido\n\ntamb\u00e9m na forma anal\u00edtica como os demais.\n\nFigura 7.1 \u2013 Regi\u00e3o de opera\u00e7\u00e3o do processo.\n\n\n\nCap\u00edtulo 7 - Identifica\u00e7\u00e3o dos modelos do sistema 50\n\nOs pontos foram escolhidos visando obter modelos que representem as diversas\n\ncondi\u00e7\u00f5es do processo de forma a termos um politopo onde os v\u00e9rtices seriam\n\nrepresentados atrav\u00e9s deste conjunto de modelos. A id\u00e9ia \u00e9 ent\u00e3o representar qualquer\n\nmodelo correspondente \u00e0  outra condi\u00e7\u00e3o operacional atrav\u00e9s de uma combina\u00e7\u00e3o\n\nconvexa deste conjunto de modelos.\n\nOs modelos obtidos est\u00e3o representando bem a regi\u00e3o de opera\u00e7\u00e3o do\n\ncontrolador. Na tabela 7.1 apresentamos os pontos de opera\u00e7\u00e3o com suas principais\n\ncaracter\u00edsticas.\n\nModelo VRF\n\n(m3/d)\n\nVGOP\n\n(m3/d)\n\nTtopo\n\n(oC)\n\nC4\n+\n\n(%)\n\nC3\n-\n\n(%)\n\n1 4000 2104 47.74 4.30 0.38\n2 3160 1731 49.34 6.55 0.88\n3 2300 1331 47.82 4.60 4.81\n4 2240 1115 47.08 3.00 3.01\n5 3532 1837 44.35 0.08 4.35\n\n                     Tabela 7.1 \u2013 Pontos de opera\u00e7\u00e3o dos modelos do processo\n\nA figura 7.2 mostra o conjunto de modelos para resposta \u00e0s vari\u00e1veis\n\nmanipuladas e a 7.3 mostra o conjunto de modelos para as perturba\u00e7\u00f5es. Observa-se que\n\nh\u00e1 modelos de naturezas muito distintas, com ganhos e din\u00e2micas bem diferentes. Nas\n\nfiguras, n\u00e3o apresentamos os modelos relativos do teor C4\n+  para a planta industrial,\n\ndevido \u00e0 n\u00e3o confiabilidade da infer\u00eancia utilizada para medi\u00e7\u00e3o desta vari\u00e1vel.  \n\n\n\nCap\u00edtulo 7 - Identifica\u00e7\u00e3o dos modelos do sistema 51\n\n Figura 7.2 \u2013 Modelos de resposta ao degrau nas manipuladas. O modelo da planta real \u00e9\n\no FD.\n\n\n\nCap\u00edtulo 7 - Identifica\u00e7\u00e3o dos modelos do sistema 52\n\n Figura 7.3 \u2013 Modelos de resposta ao degrau nas perturba\u00e7\u00f5es. O modelo da planta real \u00e9\n\no FD.\n\n\n\nCap\u00edtulo 7 - Identifica\u00e7\u00e3o dos modelos do sistema 53\n\nA seguir apresentamos os par\u00e2metros dos modelos identificados, na forma de\n\nresposta ao degrau unit\u00e1rio anal\u00edtica, conforme apresentado anteriormente. No Ap\u00eandice\n\nA, apresentamos os modelos na forma de fun\u00e7\u00e3o de transfer\u00eancia\n\nPara o modelo 1:\n\n( )   )i)(  t - ..(-  )i)(  t - ..(- i)ee-.e-.(-i)ee-.-e-.(-.ty 1146100054500114610005450011 50800642490250800642490200044980 ?+ +++=\n\n( )   )i)(  t - ..(-  )i)(  t - ..(- i)ee-.e. (i)ee-.-e-.(.-ty 1214410176960121441017696012 478296372081478296372081003440 ?+ ++++=\n\n( )   )i)(  t - ..(-  )i)(  t - ..(- i)ee-.e-. (-i)ee-.e-.(-e-.ty 121340198701213401987013 33327033333033327033333000466666 ?+ ?+++=\n\n( )   )i)(  t - ..(-  )i)(  t - ..(- i)ee-.e-. (i)ee-.-e-.(e-.-ty 108130067101081300671014 23858029787023858029787000295741 ?+ +++=\n\n( )  )i)( t - ..(- )i)( t - ..(- i)e..(i)e.-.(e-.-ty 107280057101072800571021 00996001483000996001483000296622 ?+ +++=\n\n( )  )i)( t - ..(- )i)( t - ..(- i)e..(-i)e..(-e-.ty 106500067201065000672022 03379003803003379003803000260577 ?+ ?+++=\n\n( )  )i)( t - ..(- )i)( t - ..(- i)e..(i)e.-.(e-.-ty 108900078701089000787023 008128000880100081280008801000276031 ?+ +++=\n\n( ) )i)( t - .-.(-)i)( t - .+.(- i)e..(-i)e..(-.ty 106500067201065000672024 00510005700051000570141 ?+++=\n\n( )   )i)(  t - ..(-  )i)(  t - ..(- i)ee-.e-.(i)ee-.-e-.(.-ty 1054500065900105450006590031 034803670348036701530 ?+ +++=\n\n( )   )(  t - .-  )(  t - .- e. e..ty 1062100119840232 051800009005100 ?+=\n\n( )   )(  t - .-  )(  t - .- e. e..-ty 10731018517133 011500002001120 +?=\n\n( )   )(  t - .-  )(  t - .- e.e..ty 106215011984234 777500132076430 ?+=\n\nPara o modelo 2:\n\n( )   )(  t - .-  )(  t - .- e.-e..ty 1169400149080111 002092000042000167130 +=\n\n( )   )i)(  t - ..(-  )i)(  t - ..(- i)e.. (i)e.-.(.-ty 13263025197013263025197012 0033700060114000337000601140012020 ?+ +++=\n\n( )   )i)(  t - ..(-  )i)(  t - ..(- i)e..(-i)e..(-.ty 113020104801130201048013 00174000093310001740000933100018660 ?+ ?+++=\n\n( )   )i)(  t - ..(-  )i)(  t - ..(- i)e.. (i)e.-.(e-.-ty 108560066101085600661014 01136002028001136002028000205534 ?+ +++=\n\n( )  )( t - .- )( t - .- e.e.e-.-ty 10864016492021 05670000512000215775 +?=\n\n( )  )i)( t - ..(- )i)( t - ..(- i)e..(-i)e..(-e-.ty 109080063401090800634022 01807003854001807003854000270757 ?+ ?+++=\n\n( )  )i)( t - ..(- )i)( t - ..(- i)e..(i)e.-.(e-.ty 110100067801101000678023 00691001313000691001313000262562 ?+ +++?=\n\n( ) )i)( t - .-.(-)i)( t - .+.(- i)e..(-i)e..(-.ty 109080063401090800634024 230500230500990 ?+++=\n\n\n\nCap\u00edtulo 7 - Identifica\u00e7\u00e3o dos modelos do sistema 54\n\n( )   )(  t - .-  )(  t - .- e. e..-ty 1124700194770131 02600001002610 ++=\n\n( )   )(  t - .-  )(  t - .- e. e..ty 1112400172290032 06490009900550 ?+=\n\n( )   )(  t - .-  )(  t - .- e. e..-ty 10938017390033 017700006001700 +?=\n\n( )   )(  t - .-  )(  t - .- e.e..ty 11124017229034 834301269070740 ?+=\n\nPara o modelo 3:\n\n( )   )(  t - .-  )(  t - .- e.- e..ty 10823011090111 018980002180016790 +=\n\n( )   )(  t - .-  )(  t - .- e. e..-ty 10660012742012 055050011870043170 +?=\n\n( )   )(  t - .-  )(  t - .- e.- e..ty 10733014900013 023060001630021430 +=\n\n( )   )(  t - .-  )(  t - .- e. e..-ty 10660012742014 54000120004300 +?=\n\n( )  )( t - .- )( t - .- e.e..-ty 10871012653021 05308000748004560 +?=\n\n( )  )i)( t - .-.(- )i)( t - ..(- i)e..(i)e..(.ty 107120126301071201263022 0536003282005360032820065640 ??++?+= +\n\n( )  )i)( t - ..(- )i)( t - ..(- i)e..(i)e..(.ty 107650114701076501147023 0011710000869000117100008690017370 ?+ ++?+?=\n\n( )  )i)( t - ..(-)i)( t - .+.(- i)e.-.(-i)e..(-.ty 107120123601071201236024 530320530320650 ?+++=\n\n( )   )(  t - .-  )(  t - .- e. e..-ty 11391012625031 020500021002260 ++=\n\n( )   )(  t - .-  )(  t - .- e. e..ty 11089017869132 048800009004570 ??=\n\n( )   )(  t - .-  )(  t - .- e. e..-ty 11021017822033 010900001001100 ++=\n\n( )   )(  t - .-  )(  t - .- e. e..ty 11089017869134 442100086045060 ??=\n\nPara o modelo 4:\n\n( )   )(  t - .-  )(  t - .- e.- e.e-.ty 10704019176011 0083090000759000355017 +=\n\n( )   )(  t - .-  )(  t - .- e. e.e-.-ty 10417012187012 02422000381000204022 +?=\n\n( )   )(  t - .-  )(  t - .- e.- e.e-.ty 10585014526013 01129000105000202391 +=\n\n( )   )(  t - .-  )(  t - .- e. e..-ty 10417012187014 230040200 +?=\n\n( )  )i)( t - ..(- )i)( t - ..(- i)e..(i)e.-.(e-.-ty 104160075501041600755021 03019002960003019002960000291935 ?+ +++=\n\n( )  )i)( t - .-.(- )i)( t - ..(- i)e..(-i)e..(-.ty 104340052101043400521022 070640055320070640055320110 ?+++= +\n\n( )  )i)( t - ..(- )i)( t - ..(- i)e..(i)e..(e-.ty 104770048401047700484023 01679002010001679002010000202014 ?+ ++?+?=\n( ) )i)( t - .-.(-)i)( t - .+.(- i)e..(-i)e..(-.ty 104340052101043400521024 680530680530061 ?+++=\n\n\n\nCap\u00edtulo 7 - Identifica\u00e7\u00e3o dos modelos do sistema 55\n\n( )   )(  t - .-  )(  t - .- e. e..-ty 11078017790031 028500010002950 ++=\n\n( )   )(  t - .-  )(  t - .- e. e..ty 10482018120032 072600025007510 ??=\n\n( )   )(  t - .-  )(  t - .- e. e..-ty 10361018516133 026600003002630 +?=\n\n( )   )(  t - .-  )(  t - .- e. e..ty 10482018120034 694300237071800 ??=\n\nPara o modelo 5:\n\n( )   )(  t - .-  )(  t - .- e.-e.e-.ty 11154017011011 0089590001979000397956 +=\n\n( )   )(  t - .-  )(  t - .- e. e.e-.-ty 11136012281012 03551001706000284451 +?=\n\n( )   )(  t - .-  )(  t - .- e.-e.e-.ty 10876018127013 01084000131000353119 +=\n\n( )   )(  t - .-  )(  t - .- e. e..-ty 11136012281014 480230250 +?=\n\n( )  )( t - .- )( t - .- e.e.e-.-ty 10648011042121 04132000133000299853 +?=\n\n( )  )( t - .- )( t - .- e.e.e-.ty 10709012536022 03551001706000251937 +?=\n\n( )  )( t - .- )( t - .- e.e.e-.ty 10578012987023 03374000721000265352 +??=\n\n( )  ))( t - .-))( t - .- e.e..ty 10709012536024 321300021 ?+=\n\n( )   )(  t - .-  )(  t - .- e. e..-ty 11001010675131 019300001001930 +?=\n\n( )   )(  t - .-  )(  t - .- e. e..ty 10751013439232 045300008004610 ??=\n\n( )   )(  t - .-  )(  t - .- e. e..-ty 10595019223033 014200003001390 +?=\n\n( )   )(  t - .-  )(  t - .- e. e..ty 10779015952134 600800161061690 ??=\n\nPara o modelo da planta industrial:\n\n( )   )(  t - .-  )(  t - .- e.- e.e-.ty 11780013169311 0010830000125000458199 +=\n\n( )   )(  t - .-  )(  t - .- e. e..-ty 11584015403212 003881000027120003610 +?=\n\n( )   )(  t - .-  )(  t - .- e.- e..ty 12657011164113 005046000149500034870 +=\n\n( )   )(  t - .-  )(  t - .- e. e..-ty 1009200108398014 088710000490089230 ++=\n\n( )   )(  t - .-  )(  t - .- e. e..-ty 10625015755131 0123000023220012530 ++=\n\n( )   )(  t - .-  )(  t - .- e. e..ty 10271014027232 03192000047810031440 ?+=\n\n( )   )i)(  t - .-.(-  )i)(  t - ..(- i)e..(i)e.-.(.-ty 116261162611162611626133 0080270007228000802700072280014550 +++= +\n\n\n\nCap\u00edtulo 7 - Identifica\u00e7\u00e3o dos modelos do sistema 56\n\n( )   )i)(  t - ..(-  )i)(  t - .-.(- i)e..(i)e..(.ty 118870300701188703007034 5133033370513303337066750 +??++?+=\n\nNas equa\u00e7\u00f5es acima  yij(t) representa uma resposta da sa\u00edda i no instante t para um\n\ndegrau unit\u00e1rio aplicado na entrada  j no instante 0, onde:\n\n i = 1 - representa a concentra\u00e7\u00e3o de C3\n- na corrente de fundo da coluna.\n\n i = 2 - representa a concentra\u00e7\u00e3o de C4\n+ na corrente de topo da coluna.\n\n i = 3 - representa a temperatura de topo da coluna.\n\n j = 1 - representa a vaz\u00e3o de refluxo de topo da coluna.\n\n j = 2 - representa a vaz\u00e3o de fluido de aquecimento para o refervedor da coluna.\n\n j = 3 - representa a vaz\u00e3o de carga para a coluna.\n\n j = 4 - representa a temperatura do fluido de aquecimento para refervedor.\n\n\n\n57\n\n8\n\nALGORITMOS DE CONTROLE\n\nAs principais caracter\u00edsticas dos controladores preditivos inicialmente\n\ndesenvolvidos por Cutler e Ramaker (1979), Prett e Gillette (1980) e Richalet et al.\n\n(1978) s\u00e3o as seguintes:\n\n\u2022 Embora na engenharia de controle cl\u00e1ssico, o modelo do processo seja\n\ndefinido por um modelo de estado ou fun\u00e7\u00e3o de transfer\u00eancia, nos\n\ncontroladores preditivos, as sa\u00eddas futuras s\u00e3o previstas usando modelos de\n\nresposta ao degrau ou impulso.\n\n\u2022 Diante das incertezas no modelo identificado, varia\u00e7\u00f5es da planta e\n\nperturba\u00e7\u00f5es n\u00e3o medidas, introduziu-se o termo de corre\u00e7\u00e3o da predi\u00e7\u00e3o\n\ncomo a diferen\u00e7a do valor estimado e o valor medido.\n\n\u2022 As a\u00e7\u00f5es de controle minimizam um \u00edndice de performance definido pelo\n\nusu\u00e1rio. Normalmente \u00e9 minimizada a diferen\u00e7a quadr\u00e1tica entre a trajet\u00f3ria\n\ndesejada e a trajet\u00f3ria prevista.\n\n\u2022 As a\u00e7\u00f5es de controle s\u00e3o normalmente calculadas atrav\u00e9s de um algoritmo de\n\notimiza\u00e7\u00e3o, onde inclu\u00edmos pesos e restri\u00e7\u00f5es ao problema de controle.\n\n\u2022 O algoritmo de controle calcula a trajet\u00f3ria futura das entradas, por\u00e9m\n\nsomente a primeira a\u00e7\u00e3o de controle ser\u00e1 implementada na planta.\n\nNos controladores preditivos industriais as fun\u00e7\u00f5es s\u00e3o executadas em um ciclo\n\nde amostragem pr\u00e9-definido onde temos as seguintes etapas:\n\n\u2022 Leitura das entradas e sa\u00eddas da planta;\n\n\u2022 C\u00e1lculo das predi\u00e7\u00f5es das sa\u00eddas;\n\n\u2022 C\u00e1lculo do erro em rela\u00e7\u00e3o \u00e0 trajet\u00f3ria desejada;\n\n\u2022 C\u00e1lculo das a\u00e7\u00f5es de controle;\n\n\u2022 Implementa\u00e7\u00e3o das a\u00e7\u00f5es de controle na planta.\n\nA seguir apresentaremos a forma de evolu\u00e7\u00e3o do MPC onde ser\u00e3o abordados os\n\nseguintes pontos:\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 58\n\n\u2022 MPC com modelo n\u00e3o-param\u00e9trico;\n\n\u2022 MPC com modelo de ordem reduzida;\n\n\u2022 MPC com multi-modelos;\n\n\u2022 Solu\u00e7\u00e3o do algoritmo MPC com SQP.\n\n8.1 \u2013 MPC com modelo n\u00e3o-param\u00e9trico\n\nNeste tipo de algoritmo \u00e9 utilizado um modelo FIR (finite impulse response) ou um\n\nmodelo de resposta ao degrau para representar o comportamento din\u00e2mico do processo. O\n\nmodelo \u00e9 obtido como uma seq\u00fc\u00eancia de coeficientes num\u00e9ricos que relaciona as entradas\n\ncom as sa\u00eddas. Por exemplo, no caso do modelo FIR temos a sa\u00edda i relacionada com a\n\nentrada  j da seguinte forma:\n\n( ) ( )nubky j\nnb\n\nn\ni,j,ni\n\ni,j\n\n?=? ?\n=1\n\nSendo:\n\nnbi,j - n\u00famero de coeficientes do modelo\n\nbi,j,n - corresponde ao n-\u00e9simo coeficiente da resposta ao pulso unit\u00e1rio\n\n8.1.1 \u2013 C\u00e1lculo das predi\u00e7\u00f5es das vari\u00e1veis controladas\n\nAs predi\u00e7\u00f5es das vari\u00e1veis controladas s\u00e3o baseadas no modelo do sistema e nas\n\na\u00e7\u00f5es de controle j\u00e1 aplicadas ao processo.\n\nO c\u00e1lculo das predi\u00e7\u00f5es tem as seguintes etapas:\n\n\u2022 C\u00e1lculo do efeito da \u00faltima a\u00e7\u00e3o de controle;\n\n\u2022 Corre\u00e7\u00e3o da predi\u00e7\u00e3o atrav\u00e9s das leituras da planta real;\n\n\u2022 Transla\u00e7\u00e3o da predi\u00e7\u00e3o corrigida.\n\n8.1.1.1 \u2013 Efeito da \u00faltima a\u00e7\u00e3o de controle\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 59\n\nNo caso de um processo est\u00e1vel em malha aberta, podemos representar a\n\npredi\u00e7\u00e3o da vari\u00e1vel controlada como a composi\u00e7\u00e3o de duas parcelas, uma parte\n\ncorresponde aos efeitos das entradas passadas e a outra parte referente \u00e0 contribui\u00e7\u00e3o da\n\n\u00faltima a\u00e7\u00e3o de controle, esta predi\u00e7\u00e3o pode ser representada da seguinte forma:\n\n[ ] [ ]y y s ui k n k\nk\n\ni k n k\nk\n\ni j n j k\nj\n\nnu\n\n, , , , ,+\n?\n\n+ ?\n?\n\n?\n=\n\n= + ?\n1\n\n1\n1\n\n1\n1\n\n? (8.1)\n\nsendo:\n\nn - instante futuro n = 1, 2, \u2026\n\n[ ]y i k n k\nk\n\n, + ?\n?\n\n1\n1\n\n- predi\u00e7\u00e3o da vari\u00e1vel controlada i no instante futuro k+n\n\n  calculada no instante k-1 com informa\u00e7\u00f5es do processo at\u00e9 k-1.\n\n[ ]yi k n k\nk\n\n, +\n?1\n\n- predi\u00e7\u00e3o da vari\u00e1vel controlada i no instante futuro k+n\n\n  calculada  no instante k com informa\u00e7\u00f5es do processo at\u00e9 k-1.\n\nsi j n, , - coeficiente correspondente ao instante n da resposta ao degrau\n\n   da vari\u00e1vel controlada i com  a  vari\u00e1vel manipulada j\n\n?u u uj k j k j k, , ,? ? ?= ?1 1 2\n\nu j k, ?1 - valor da vari\u00e1vel manipulada j aplicada no instante k-1.\n\nu j k, ?2 - valor da vari\u00e1vel manipulada j aplicada no instante k-2.\n\nUsando (8.1) para calcular as predi\u00e7\u00f5es de todas as vari\u00e1veis controladas, temos:\n\n[ ] [ ]y y S uk n k\nk\n\nk n k\nk\n\nn k+\n?\n\n+ ?\n?\n\n?= +\n1\n\n1\n1\n\n1? (8.2)\n\nSendo:\n\n[ ] [ ] [ ]y y yk n k\nk\n\nk n k\nk\n\nny k n k\nk\n\nT\n\n+ ?\n?\n\n+ ?\n?\n\n+ ?\n?\n\n=\n?\n??\n\n?\n??\n\n1\n1\n\n1 1\n1\n\n1\n1\n\n, ,L [ ]yk n k\nk\n\nny\n+ ?\n\n?\n\n\u00d7? ?1\n1\n\n1\n\n[ ] [ ] [ ]y y yk n k\nk\n\nk n k\nk\n\nny k n k\nk\n\nT\n\n+\n?\n\n+\n?\n\n+\n?\n\n=\n?\n??\n\n?\n??1 1 1 1, ,\n\nL [ ]yk n k\nk\n\nny\n+\n\n?\n\n\u00d7? ?\n1\n\n1\n\n[ ]? ? ?u u uk k nu k\nT\n\n? ? ?=1 1 1 1, ,L ?uk\nnu\n\n?\n\u00d7? ?1\n\n1\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 60\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n=\n\nnnunynny\n\nnnun\n\nn\n\nss\n\nss\nS\n\n,,,1,\n\n,,1,1,1\n\nL\nMM\n\nL\nSn\n\nny nu? ? \u00d7\n\nsendo, nu o n\u00famero de vari\u00e1veis de entrada (manipuladas e perturba\u00e7\u00f5es) e ny o n\u00famero\n\nde vari\u00e1veis de sa\u00edda (controladas)\n\nNo enfoque convencional as predi\u00e7\u00f5es das vari\u00e1veis controladas s\u00e3o feitas em\n\ninstantes seq\u00fc\u00eanciais defasados de um per\u00edodo de amostragem at\u00e9 o maior horizonte de\n\nestabiliza\u00e7\u00e3o dos modelos, ou seja:\n\n( )ji\nji\n\nnh ,\n,\n\nmaxnp =  \n\nAssim, as predi\u00e7\u00f5es das vari\u00e1veis controladas em todos os instantes desejados,\n\npodem ser apresentadas da seguinte forma:\n\n[ ] [ ]y y S uk\nk\n\nk\nk\n\nk\n?\n\n?\n?\n\n?= +\n1\n\n1\n1\n\n1? (8.3)\n\nsendo:\n\n[ ] [ ] [ ] [ ]\nT\n\nT\nnpk\n\nT\nk\n\nT\nk\n\nk\nk\n\nk\nkk\n\nk\nk\n\nk\nyyyy ??\n\n?\n??\n?=\n\n?\n??\n\n?\n?\n\n? +++?\n?\n\n1\n11\n\n1\n1\n\n1 211\n1 L\n\n[ ] [ ] [ ] [ ]\nT\n\nT\nnpk\n\nT\nk\n\nT\nk\n\nk\nk\n\nk\nkk\n\nk\nk\n\nk\nyyyy ??\n\n?\n??\n?=\n\n???\n+++?\n\n111\n21\n\n1\nL\n\n[ ]? ? ?u u uk k nu k\nT\n\n? ? ?=1 1 1 1, ,L\n\n[ ]TTnpTT SSSS L21=\n\n8.1.1.2 \u2013 Corre\u00e7\u00e3o das predi\u00e7\u00f5es com as leituras da planta\n\nDiante das incertezas em rela\u00e7\u00e3o aos modelos da planta e perturba\u00e7\u00f5es n\u00e3o\n\nmedidas, \u00e9 necess\u00e1rio acrescentar um termo  de corre\u00e7\u00e3o das predi\u00e7\u00f5es das vari\u00e1veis\n\ncontroladas.\n\nCom os efeitos das a\u00e7\u00f5es de controle calculados, devemos corrigir as predi\u00e7\u00f5es\n\natrav\u00e9s da leitura das vari\u00e1veis controladas. As predi\u00e7\u00f5es dessas vari\u00e1veis, no primeiro\n\ninstante deveriam corresponder aos valores lidos das vari\u00e1veis controladas (se os\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 61\n\nmodelos fossem perfeitos). Para o c\u00e1lculo dessa corre\u00e7\u00e3o, utilizamos  apenas os termos\n\ncorrespondentes ao instante k+1 do vetor de predi\u00e7\u00f5es, ou seja:\n\n[ ] [ ]y N yk k\nk\n\nk\nk\n\n+\n? ?\n\n=1\n1 1\n\n(8.4)\n\nsendo:\n\n[ ] [ ] [ ] [ ]y y y yk k\nk\n\nk k\nk\n\nk k\nk\n\nny k k\nk\n\nT\n\n+\n?\n\n+\n?\n\n+\n?\n\n+\n?\n\n=\n?\n??\n\n?\n??1 1 1 1 1 2 1 1 1 1, , ,\n\nL\n\nN =\n\n?\n\n?\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n\n1 0 0 0 0\n0 1 0 0 0\n\n0 0 1 0 0\n\nL L\nL L\n\nM M O M M M\nL L\n\n; npnynyN .\u00d7??\n\nConsiderando a leitura da vari\u00e1vel controlada i representada por $ ,yi k , podemos\n\ncalcular o desvio da predi\u00e7\u00e3o em rela\u00e7\u00e3o \u00e0 leitura da planta como\n\n[ ]w y yi k i k i k k\nk\n\n, , ,$= ? +\n?\n\n1\n1\n\nPara todas as vari\u00e1veis controladas, obtemos:\n\n[ ]W y yk k k k\nk\n\n= ? +\n?\n\n$ 1\n1\n\n(8.5)\n\nsendo:\n\n[ ]\n[ ]Tknykk\n\nT\nknykk\n\nyyy\n\nwwW\n\n,,1\n\n,,1\n\n\u02c6\u02c6\u02c6 L\n\nL\n\n=\n\n=\n1\n\n1\n\n\u02c6 \u00d7\n\n\u00d7\n\n??\n\n??\nny\n\nk\n\nny\nk\n\ny\n\nW\n\nSubstituindo (8.4) em (8.5), temos:\n\n[ ]W y N yk k k\nk\n\n= ?\n?\n\n$\n1\n\n(8.6)\n\nA corre\u00e7\u00e3o deste desvio \u00e9 normalmente propagada para todas as predi\u00e7\u00f5es\n\nfuturas. A lei de propaga\u00e7\u00e3o da corre\u00e7\u00e3o adotada neste trabalho \u00e9 apresentada como:\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 62\n\n[ ] [ ] ki\nk\n\nknki\nk\n\nk\nc\n\nnki wyy ,\n1\n\n,\n1\n\n, +=\n?\n\n+\n?\n\n+\n\nsendo:\n\n[ ]yi k nc k\nk\n\n, +\n?1\n\n- predi\u00e7\u00e3o corrigida da vari\u00e1vel controlada i no instante futuro\n\nk+n calculado no instante k com informa\u00e7\u00f5es do processo em\n\nk-1.\n\nPodemos escrever as predi\u00e7\u00f5es corrigidas para todas as vari\u00e1veis controladas e\n\ntodos os instantes futuros escolhidos, assim temos:\n\n[ ] [ ]y y KWc k\nk\n\nk\nk\n\nk\n? ?\n\n= +\n1 1\n\n(8.7)\n\nsendo:\n\nK =\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n1 0 0\n0 1 0\n\n0 0 1\n1 0 0\n\n0 0 1\n\n1 0 0\n\n0 0 1\n\nL\nL\n\nM M O M\nL\nL\n\nM M M\nL\n\nM M M\nL\n\nM M M\nL\n\nSubstituindo as equa\u00e7\u00f5es (8.3) e (8.6) em (8.7), temos:\n\n[ ] [ ] [ ]y y S u K y N y S uc k\nk\n\nk\nk\n\nk k k\nk\n\nk\n?\n\n?\n?\n\n? ?\n?\n\n?= + + ? +\n?\n?\n? ?\n\n?\n???\n\n?\n?\n?\n?1 1 1 1 1 1 1\n\n? ?$\n\nAgrupando os termos, temos:\n\n[ ] ( )[ ] ( )y I KN y Ky I KN S uc k\nk\n\nk\nk\n\nk k\n?\n\n?\n?\n\n?= ? + + ?\n1\n\n1\n1\n\n1$ ? (8.8)\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 63\n\nsendo:\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n=\n\nny\n\nny\n\nny\n\nI\n\nI\nI\n\nI\n\nL\nMOMM\n\nL\nL\n\n00\n\n00\n00\n\n; I ny np ny np? ? \u00d7. .\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n\n?\n\n?\n\n=\n\n100\n\n010\n001\n\nL\nMOMM\n\nL\nL\n\nnyI ;\nnyny\n\nnyI\n\u00d7??\n\n8.1.1.3 \u2013 Transla\u00e7\u00e3o da predi\u00e7\u00e3o corrigida\n\nAs predi\u00e7\u00f5es das vari\u00e1veis controladas est\u00e3o atualizadas e corrigidas para o\n\ninstante k. Isto significa que:\n\n[ ]yi kc k\nk\n\n, +\n?\n\n2\n1\n - corresponde ao instante atual k+1\n\n[ ]yi kc k\nk\n\n, +\n?\n\n3\n1\n - corresponde ao instante futuro k+2\n\n      M\n\n[ ]\n1\n\n1,\n?\n\n++\nk\n\nk\nc\n\nnpkiy  - corresponde ao instante futuro k+np\n\nPortanto, dentro da filosofia dos controladores preditivos, que apresentam um\n\nhorizonte m\u00f3vel, \u00e9 necess\u00e1rio fazer a transla\u00e7\u00e3o de um per\u00edodo de amostragem em todo\n\nvetor de predi\u00e7\u00f5es e para todas as vari\u00e1veis controladas.\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 64\n\n[ ] [ ]\n\n[ ] [ ]\n[ ] [ ]\n\n[ ] [ ]\n\n[ ] [ ]\n\n[ ] [ ]\n1\n\n,1,\n\n1\n,11,1\n\n1\n3,2,\n\n1\n3,12,1\n\n1\n2,1,\n\n1\n2,11,1\n\n?\n+?+\n\n?\n+?+\n\n?\n++\n\n?\n++\n\n?\n++\n\n?\n++\n\n=\n\n=\n\n=\n\n=\n\n=\n\n=\n\nk\nk\n\nc\nnpkny\n\nk\nknpkny\n\nk\nk\n\nc\nnpk\n\nk\nknpk\n\nk\nk\n\nc\nkny\n\nk\nkkny\n\nk\nk\n\nc\nk\n\nk\nkk\n\nk\nk\n\nc\nkny\n\nk\nkkny\n\nk\nk\n\nc\nk\n\nk\nkk\n\nyy\n\nyy\n\nyy\n\nyy\n\nyy\n\nyy\n\nM\n\nM\n\nM\n\nM\n\nPara sistemas est\u00e1veis, assume-se que np \u00e9 suficientemente grande tal que:\n\n[ ] [ ]\n1\n\n,,\n?\n\n=\nk\n\nk\nc\nnpi\n\nk\nknpi yy\n\nVetorialmente, podemos representar a transla\u00e7\u00e3o da seguinte forma:\n\n[ ] [ ]\n1?\n\n=\nk\n\nk\nc\n\nk\nk yMy (8.9)\n\nsendo:\n\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n=\n\nny\n\nny\n\nny\n\nny\n\nI\nI\n\nI\nI\n\nM\n\nL\nL\n\nMOMMM\nL\nL\n\n000\n000\n\n000\n000\n\n; M ny np ny np? ? \u00d7. . (8.10)\n\nSubstituindo a eq. (8.8) na eq. (8.9), obtemos a seguinte express\u00e3o para as\n\npredi\u00e7\u00f5es das vari\u00e1veis controladas.\n\n[ ] ( )[ ] ( )y M I KN y MKy M I KN S uk\nk\n\nk\nk\n\nk k= ? + + ??\n?\n\n?1\n1\n\n1\n$ ? (8.11)\n\n8.1.2 \u2013 C\u00e1lculo das a\u00e7\u00f5es de controle\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 65\n\nO algoritmo de controle preditivo calcula as a\u00e7\u00f5es de controle segundo as\n\nseguintes etapas:\n\n\u2022 Recebe a trajet\u00f3ria refer\u00eancia para as vari\u00e1veis controladas em determinados\n\ninstantes futuros. O n\u00famero de instantes \u00e9 denominado  horizonte de\n\npredi\u00e7\u00e3o (np).\n\n\u2022 Calcula os erros das vari\u00e1veis controladas em rela\u00e7\u00e3o ao setpoint ou a uma\n\nfaixa de opera\u00e7\u00e3o, onde o erro \u00e9 nulo quando a predi\u00e7\u00e3o est\u00e1 dentro dos\n\nlimites estabelecidos para as vari\u00e1veis.\n\n\u2022 Calcula os valores das a\u00e7\u00f5es de controle nos instantes futuros de modo a\n\nminimizar os erros das vari\u00e1veis controladas em certos instantes futuros.\n\nA seguir ser\u00e3o descritas estas etapas.\n\n8.1.2.1 \u2013 Trajet\u00f3ria de refer\u00eancia das vari\u00e1veis controladas\n\nCalculadas as predi\u00e7\u00f5es das vari\u00e1veis controladas, utilizam-se estas mesmas no\n\nc\u00e1lculo das a\u00e7\u00f5es de controle. Na forma tradicional de c\u00e1lculo do controlador preditivo\n\no horizonte de predi\u00e7\u00e3o (np) corresponde aos instantes futuros at\u00e9 o maior tempo de\n\nestabiliza\u00e7\u00e3o dos modelos do processo. O horizonte de otimiza\u00e7\u00e3o (nr) \u00e9 relativo aos\n\ninstantes futuros em que o controlador ir\u00e1 minimizar os erros.\n\nPara o c\u00e1lculo das a\u00e7\u00f5es de controle, utilizamos apenas os termos\n\ncorrespondentes at\u00e9 o instante k+nr do vetor de predi\u00e7\u00f5es, pois comumente n\u00e3o \u00e9\n\ninteressante calcularmos as a\u00e7\u00f5es de controle considerando todos os instantes at\u00e9 o\n\nestado estacion\u00e1rio. Desta forma, podemos escrever:\n\n[ ] [ ]\nk\n\nkr\nk\n\nk yNy =~\n\nsendo:\n\n[ ] [ ] [ ] [ ]\nT\n\nT\nnrk\n\nT\nk\n\nT\nkk\n\nk\nk\n\nk\nk\n\nk\nk\n\nk\nyyyy ??\n\n?\n??\n?= +++ L21\n\n~\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 66\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n\n?\n\n?\n\n=\n\n00100\n\n00010\n00001\n\nLL\nMMMOMM\n\nLL\nLL\n\nrN\nnynpnynr\n\nrN\n.. \u00d7??\n\nAs predi\u00e7\u00f5es das vari\u00e1veis controladas s\u00e3o alteradas ao aplicarmos as a\u00e7\u00f5es de\n\ncontrole em cada instante. Os controladores preditivos t\u00eam a caracter\u00edstica de poder\n\ncalcular mais de uma a\u00e7\u00e3o de controle, que fornece mais graus de liberdade para o\n\ncontrolador preditivo. Quando aumentamos o n\u00famero de a\u00e7\u00f5es calculadas, permitimos\n\nao controlador distribuir de forma mais conveniente as suas a\u00e7\u00f5es. Desta forma, quando\n\naplicamos \u201cm\u201d a\u00e7\u00f5es de controle, temos:\n\n[ ] [ ]\n[ ] [ ]\n\n[ ] [ ]\n\n[ ] [ ] 1111\n\n1111\n\n11222\n\n111\n\n?++?+?++\n\n?++?++\n\n+++\n\n++\n\n?++?+?+=\n\n?++?+?+=\n\n?+?+=\n\n?+=\n\nmkmnrknrknr\nk\n\nknrk\nk\n\nknrk\n\nmkkmkm\nk\n\nkmk\nk\n\nkmk\n\nkk\nk\n\nkk\nk\n\nkk\n\nk\nk\n\nkk\nk\n\nkk\n\nuSuSuSyy\n\nuSuSuSyy\n\nuSuSyy\n\nuSyy\n\nL\nM\n\nL\nM\n\nNa forma vetorial, temos:\n\n[ ] [ ] uSyy mkkkk ?+=\n~\n\nsendo:\n\n[ ] [ ]T\nk\n\nknrkmkkkk\nk yyyyy ++++= LL21\n\n[ ]Tmkk uuu 1?+??=? L\n\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n=\n\n+??\n\n?\n\n11\n\n11\n\n12\n\n1\n\n0\n00\n\nmnrnrnr\n\nmm\nm\n\nSSS\n\nSSS\n\nSS\nS\n\nS\n\nL\nMMM\n\nL\nMMM\n\nL\nL\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 67\n\n8.1.2.2 \u2013 C\u00e1lculo dos erros das vari\u00e1veis controladas\n\nTendo a trajet\u00f3ria prevista das vari\u00e1veis controladas, podemos calcular os erros\n\nem rela\u00e7\u00e3o aos respectivos setpoints. Assim, para a vari\u00e1vel controlada i no instante\n\nfuturo j, o erro \u00e9 definido como:\n\n[ ] [ ]e y yi k j k\nk\n\nsp i k j k\nk\n\ni, ,+ +\n= ?\n\nsendo:\n\nisp\ny  - \u00e9 o setpoint correspondente \u00e0 vari\u00e1vel controlada i\n\nPodemos ent\u00e3o definir um vetor de setpoints dado por:\n\n[ ] [ ]e I y yk j k\nk\n\nny sp k j k\nk\n\n+ += ?\n\nsendo:\n\n[ ] [ ]T\nk\n\nkjknyjk\nk\n\nkjk eee +++ = ,,1 L ; [ ]ek j k\nk\n\nny\n+\n\n\u00d7? ? 1\n\n[ ] [ ]T\nk\n\nkjknyjk\nk\n\nkjk yyy +++ = ,,1 L ; [ ]yk j k\nk\n\nny\n+\n\n\u00d7? ? 1\n\n[ ]y y ysp sp sp Tny= 1 L ; ysp ny? ? \u00d71\n\nPara todos os instantes de predi\u00e7\u00e3o futuros, temos:\n\n[ ] [ ]\nk\n\nkspk\nk yyNe ~\n\n~\n?= (8.12)\n\nsendo:\n\n[ ] [ ]Tnrkkkkk eeee +++= L21\n\n[ ]y y ysp sp sp Tny= 1 L\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 68\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n=\n\n10\n\n01\n\n10\n\n01\n10\n\n01\n\n~\n\nL\nMOM\n\nL\nMM\n\nL\nMOM\n\nL\nL\n\nMOM\nL\n\nN ; nynr.nyN\n~ \u00d7??\n\n8.1.2.3 \u2013 Algoritmo de controle preditivo\n\nOs controladores de forma geral t\u00eam como principal objetivo minimizar os erros\n\ndas vari\u00e1veis controladas com os menores movimentos das vari\u00e1veis manipuladas.\n\nNo caso do controlador preditivo o objetivo \u00e9 minimizar a seguinte fun\u00e7\u00e3o:\n\n[ ] [ ] uueeJ T\nk\n\nk\nT\n\nk\nkk ???+?= (8.13)\n\nsendo:\n\n[ ] [ ] uSee mkkkk ??= (8.14)\n\n            [ ] [ ]Tnrkkkkk eeee +++= L21\n\n?   \u00e9 uma matriz de pesos para os erros nas vari\u00e1veis controladas\n\n?   \u00e9 uma matriz de pesos para os movimentos das vari\u00e1veis manipuladas\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n\n?\n?\n\n=?\n\nL\nMOMM\n\nL\nL\n\n00\n\n00\n00\n\n; nrnynrny .. \u00d7???\n\n? =\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n1 0\n\n0\n\nL\nM O M\n\nL ny\n\n; ? ? ? \u00d7ny ny\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 69\n\n?\n?\n\n?\n=\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\nL\nM O M\n\nL\n\n0\n\n0\n; numnum .. \u00d7???\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n=?\n\nnu?\n\n?\n\nL\nMOM\n\nL\n\n0\n\n01\n; nunu\u00d7???\n\nPara solucionar o problema, devemos desenvolver o equacionamento da fun\u00e7\u00e3o\n\nobjetivo do controlador. Desta forma, podemos substituir a equa\u00e7\u00e3o (8.14) em (8.13),\n\nresultando em:\n\n[ ]( ) [ ]( ) uuuSeuSeJ TmkkTmkkk ???+?????=\n[ ] [ ] [ ] [ ] ( ) uSSuuSeeSueeJ mTmTmT kkkk\n\nT\nm\n\nT\n\nk\nk\n\nT\n\nk\nkk ??+??+???????=     (8.15)\n\nOs algoritmos de controle preditivo convencionais se diferenciam na forma de\n\nminimizar a fun\u00e7\u00e3o objetivo.\n\nComo exemplo descreveremos os algoritmos: DMC, QDMC e MMPC\n\n8.1.2.3.1 \u2013 Algoritmo DMC\n\nO algoritmo DMC \u00e9 o de abordagem mais simples, e se baseia no m\u00e9todo dos\n\nm\u00ednimos quadrados.\n\nSua fun\u00e7\u00e3o objetivo \u00e9 dada pela eq. (8.15):\n\n[ ] [ ] [ ] [ ] ( ) uSSuuSeeSueeJ mTmTmT kkkk\nT\nm\n\nT\n\nk\nk\n\nT\n\nk\nkk ??+??+???????=\n\nComo os termos s\u00e3o todos escalares, podemos dizer que\n\n[ ] [ ] uSeeSu m\nT\n\nk\nk\n\nk\nk\n\nT\nm\n\nT ??=??\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 70\n\nportanto:\n\n[ ] [ ] [ ] ( ) uSSueSueeJ mTmTkk\nT\nm\n\nT\n\nk\nk\n\nT\n\nk\nkk ??+??+????= 2\n\nO valor m\u00ednimo da fun\u00e7\u00e3o objetivo corresponde ao ponto onde a derivada da\n\nfun\u00e7\u00e3o em rela\u00e7\u00e3o ao ?u \u00e9 zero, isto \u00e9:\n\n?\n?\n\nJ\nu\nk\n\n?\n= 0\n\nPortanto:\n\n[ ] ( ) uSSeS\nu\n\nJ\nm\n\nT\nmk\n\nk\nT\nm\n\nk ??+?+??=\n?\n\n22\n?\n?\n\ncomo \n?\n?\n\nJ\nu\nk\n\n?\n= 0 , portanto:\n\n[ ] ( ) uSSeS mTmkk\nT\nm ??+?+??= 220\n\nIsolando o termo em ?u, temos:\n\n( ) [ ]\nk\n\nk\nT\nmm\n\nT\nm eSSSu ??+?=?\n\n?1\n\nPodemos escrever a equa\u00e7\u00e3o do controlador na forma\n\n[ ]?u K eMPC k k=\n\nsendo:\n\n( ) ??+?= ? TmmTmMPC SSSK\n1\n\n(8.16)\n\n8.1.2.3.2 \u2013 Algoritmo QDMC\n\nO algoritmo QDMC utiliza o m\u00e9todo de otimiza\u00e7\u00e3o de programa\u00e7\u00e3o quadr\u00e1tica\n\n(QP) para encontrar a melhor solu\u00e7\u00e3o para o problema de controle.\n\nDe forma compacta podemos representar o problema da programa\u00e7\u00e3o quadr\u00e1tica\n\nda seguinte maneira:\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 71\n\nMinimizar x Hx C x\n\nsujeito a Ax b\nx\n\nu\n\nT T\n\n?\n? = +\n\n?\n?\n\n1\n2\n\n0\n\nPara resolvermos o controlador por QP, partimos da fun\u00e7\u00e3o objetivo b\u00e1sica,\n\nresultando numa forma equivalente \u00e0 eq.(8.15):\n\n[ ] [ ] [ ] ( ) uSSuuSeeeJ mTmTmT kkkk\nT\n\nk\nkk ??+??+????= 2\n\nO termo [ ] [ ]e ek\nk\n\nT\nk\n\nk\n?  na fun\u00e7\u00e3o objetivo Jk \u00e9 uma constante escalar. Neste caso,\n\npodemos eliminar este termo da fun\u00e7\u00e3o sem alterar a sua solu\u00e7\u00e3o final. Tamb\u00e9m\n\npodemos dividir a fun\u00e7\u00e3o objetivo por 2 sem alterar a sua solu\u00e7\u00e3o.\n\nAssim, a fun\u00e7\u00e3o objetivo do QDMC pode ser apresentada da seguinte forma:\n\n( ) [ ] uSeuSSu mT kkm\nT\nm\n\nT ?????+??=?\n2\n1\n\n(8.17)\n\nDe forma simplificada podemos representar ? como:\n\n? ? ? ?= +\n1\n2\n\nu H u C uT T\n\nsendo:\n\n?+?= m\nT\nm SSH\n\n[ ] m\nT\n\nk\nk\n\nT SeC ??=\n\nNa programa\u00e7\u00e3o quadr\u00e1tica, podemos incluir restri\u00e7\u00f5es do tipo:\n\nA u b? ?\n\nNeste caso, pode-se incluir as seguintes restri\u00e7\u00f5es:\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 72\n\n1. Restri\u00e7\u00f5es de movimento das vari\u00e1veis manipuladas\n\n2. Restri\u00e7\u00f5es de limites das vari\u00e1veis manipuladas\n\n8.1.2.3.2.1 \u2013 Restri\u00e7\u00f5es de movimentos\n\nEstas restri\u00e7\u00f5es podem ser apresentadas da seguinte forma:\n\nmaxmax uuu jk ?????? +\n\nPara o caso ? ?u uk j+ ? max com  j = 1, 2, \u2026, m, temos\n\nmax. uNuI unum ???\n\nsendo:\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n=\n\nnu\n\nnu\n\nu\n\nI\n\nI\nN M ; nunumuN\n\n\u00d7?? .\n\nPara o caso ? ? +? ?u uk jmax  temos\n\n? ?+? ?u uk j max\n\nmax. uNuI unum ????\n\ncompondo as duas condi\u00e7\u00f5es, temos:\n\n?\n?\n\n?\n?\n?\n\n?\n?\n?\n\n???\n?\n\n?\n?\n?\n\n?\n? max\n\nmax\n\n.\n\n.\n\nuN\nuN\n\nu\nI\n\nI\n\nu\n\nu\n\nnum\n\nnum\n\n8.1.2.3.2.2 \u2013 Restri\u00e7\u00f5es de limites\n\nAs restri\u00e7\u00f5es de limites podem ser apresentadas da seguinte forma:\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 73\n\nu u umin max? ?\n\ncomo:\n\nu\nu\n\nu\n\nI\nI I\n\nI I I\n\nu\nu\n\nu\n\nu\nu\n\nu\n\nk\n\nk\n\nk m\n\nnu\n\nnu nu\n\nnu nu nu\n\nk\n\nk\n\nk m\n\nk\n\nk\n\nk\n\n+\n\n+ ?\n\n+\n\n+ ?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n\n=\n\n?\n\n?\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n\n+\n\n?\n\n?\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n\n1\n\n1\n\n1\n\n1\n\n1\n\n1\n\n1\n\n0 0\n0\n\nM\n\nL\nL\n\nM M O M\nL\n\nM M\n\n?\n?\n\n?\n\nou\n\n1?+?= ku uuNu\n\nPara o caso u u? max\n\nmax1 uuuN ku ?+? ?\n\n1max ???? ku uuuN\n\nPara o caso u umin ?\n\n1min ?+?? ku uuNu\n\nmin1 uuuN ku ???? ?\n\ncompondo as duas condi\u00e7\u00f5es, temos:\n\n?\n?\n\n?\n?\n?\n\n?\n?\n?\n\n???\n?\n\n?\n?\n?\n\n?\n? ?\n\n?\n\nmin1\n\n1max\n\nuu\nuu\n\nu\nN\n\nN\n\nk\n\nk\n\nu\n\nu\n\ncompondo todas as restri\u00e7\u00f5es, temos:\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n\n?\n?\n\n??\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nmin1\n\n1max\n\nmax\n\nmax\n\n.\n\n.\n\nuu\nuu\n\nuN\nuN\n\nu\n\nN\nN\n\nI\nI\n\nk\n\nk\n\nu\n\nu\n\nu\n\nu\n\nnum\n\nnum\n\nPortanto:\n\nA u b? ?\n\nsendo:\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 74\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n\n?\n=\n\nu\n\nu\n\nnum\n\nnum\n\nN\nN\n\nI\nI\n\nA .\n.\n\n;\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n\n?\n?\n\n=\n\n?\n\n?\n\nmin1\n\n1max\n\nmax\n\nmax\n\nuu\nuu\n\nuNu\n\nuNu\n\nb\n\nk\n\nk\n\n8.2 \u2013 MPC com modelo de ordem reduzida\n\nOs MPC\u00b4s convencionais necessitam de todos os estados do processo at\u00e9 o\n\nestado estacion\u00e1rio, para poder representar corretamente as previs\u00f5es das vari\u00e1veis\n\ncontroladas. Algumas tentativas de reduzir a quantidade de estados foram apresentadas\n\npor Hovd et al. (1993), que prop\u00f5em truncar o modelo de convolu\u00e7\u00e3o antes de atingir o\n\nestado estacion\u00e1rio e Li et al. (1989) que transformam um modelo n\u00e3o param\u00e9trico em\n\num modelo em espa\u00e7o de estado.\n\nEntretanto, uma solu\u00e7\u00e3o inovadora de redu\u00e7\u00e3o de ordem do modelo foi proposta\n\npor Odloak (1996) e Gouv\u00eaa e Odloak (1997), na qual o modelo de estado \u00e9 obtido a\n\npartir de um modelo de fun\u00e7\u00e3o de transfer\u00eancia.\n\n8.2.1 \u2013 Modelo de fun\u00e7\u00e3o de transfer\u00eancia\n\nOs modelos do processo, originalmente eram representados atrav\u00e9s das respostas\n\ndas vari\u00e1veis controladas a degraus nas vari\u00e1veis de entrada (manipuladas e\n\nperturba\u00e7\u00f5es medidas). Obtinham-se estes modelos atrav\u00e9s do ajuste dos dados de um\n\nteste na planta a um modelo do tipo FIR (Finite Impulse Response).\n\nOs processos qu\u00edmicos cont\u00ednuos quando pr\u00f3ximos de suas condi\u00e7\u00f5es normais\n\nde projeto s\u00e3o normalmente bem representados por modelos lineares do tipo fun\u00e7\u00e3o de\n\ntransfer\u00eancia. Conforme Ljung (1987) seria interessante fazer uma representa\u00e7\u00e3o do\n\nprocesso atrav\u00e9s de modelos param\u00e9tricos de ordem reduzida. Portanto, para um sistema\n\nmultivari\u00e1vel, a rela\u00e7\u00e3o din\u00e2mica entre a i-\u00e9sima vari\u00e1vel controlada (ou sa\u00edda) e a j-\n\n\u00e9sima vari\u00e1vel manipulada (ou entrada), pode ser colocada na forma:\n\n( )\n( )\n\n( )\njie\n\nsa\n\nsb\nsG\n\nji\n\nji\nji\n\n,s\n\n,\n\n,\n, 1\n\n??\n\n+\n=\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 75\n\nsendo:\n\n( ) ji,\n,\n\nnb\nnb,,1,,0,,, sbsbbsb jijijijiji +++= L\n\n( ) ji\nji\nsasasa jijiji\n\n,\n\n,\n\nna\nna,,1,,, ++= L\n\n?i,j - tempo morto\n\nnbi,j - ordem do polin\u00f4mio bi,j(s)\n\nnai,j - ordem do polin\u00f4mio ai,j(s)\n\nOs par\u00e2metros relativos aos polin\u00f4mios ai,j(s) e bi,j(s) podem ser agrupados.\n\nDesta forma, podemos representar os par\u00e2metros do modelo da seguinte forma:\n\n[ ]\nj,ina,j,i2,j,i1,j,ij,i\n\naaaa L=\n\n[ ]\nj,inb,j,i1,j,i0,j,ij,i\n\nbbbb L=\n\nO sistema na forma multivari\u00e1vel, tem genericamente ny vari\u00e1veis controladas e\n\nnu vari\u00e1veis manipuladas e o modelo do sistema completo pode ser representado pela\n\nseguinte matriz de transfer\u00eancia:\n\n( ) ( ) ( )susGsy ?? =\nsendo:\n\n( ) ( ) ( )[ ]Tsysysy\nny\n\n???\n1\n\nL=\n\n( ) ( ) ( )[ ]Tnu sususu ??? 1 L=\n\n( )\n( ) ( )\n\n( ) ( )\nG s\n\nG s G s\n\nG s G s\n\nnu\n\nny ny nu\n\n=\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n1 1 1\n\n1\n\n, ,\n\n, ,\n\nL\nM\n\nL\n\nNo caso multivari\u00e1vel, \u00e9 conveniente agrupar todos os par\u00e2metros do modelo da\n\nseguinte forma:\n\n ( )\n( ) ( )\n\n( ) ( )?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n=\nss\n\nss\ns\n\nnu,ny1,ny\n\nnu,11,1\n\naa\n\naa\na\n\nL\nM\n\nL\n; ( )\n\n( ) ( )\n\n( ) ( )?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n=\nss\n\nss\ns\n\nnu,ny1,ny\n\nnu,11,1\n\nbb\n\nbb\nb\n\nL\nM\n\nL\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 76\n\n( )\n( ) ( )\n\n( ) ( )\n?\n\n? ?\n\n? ?\ns\n\ns s\n\ns s\n\nnu\n\nny ny nu\n\n=\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n1 1 1\n\n1\n\n, ,\n\n, ,\n\nL\nM\n\nL\n\nOs algoritmos de controle aqui utilizados, usam internamente modelos de\n\nresposta ao degrau em malha aberta. Portanto, aplicando um degrau unit\u00e1rio em ?u(s),\n\npara cada par ij, temos:\n\n( ) ( ) ( )susGsy jjid ji ?=? ,,\nsendo:\n\n( )?u s\nsj\n\n=\n1\n\nNa forma expl\u00edcita, temos a seguinte fun\u00e7\u00e3o correspondente \u00e0 resposta ao degrau\n\nunit\u00e1rio:\n\n( ) ( )\nji\n\nji\n\ns\n\nna\nnajiji\n\nnb\nnbjijiji\n\nd e\nsasas\n\nsbsbb\nsy ,\n\n,\n\n,,1,,\n\n,,1,,0,,\n\n1\n??\n\n+++\n\n+++\n=?\n\nL\n\nL\n\nAssumindo que o denominador n\u00e3o tenha ra\u00edzes m\u00faltiplas, o que \u00e9 razo\u00e1vel, pois\n\nem processos qu\u00edmicos dificilmente temos sistemas com constantes de tempo repetidas.\n\nPor conveni\u00eancia, as ra\u00edzes de 1+ai,j(s) s\u00e3o representadas como:\n\n[ ]r r ri j i j i j na\nT\n\n, , , , ,= 1 L\n1\n\n,\n\u00d7? najir C\n\nA resposta ao degrau do sistema pode ent\u00e3o ser fatorada, obtendo-se a seguinte\n\nexpress\u00e3o:\n\n( )\n( )\n\n( )( ) ( )\nji\n\nji\ne\n\nrsrsrss\n\nb\nsy\n\nnajijiji\n\nji\nd\n\n,\n\n,\n\ns?\n\n,,2,,1,,\n\n,\n\ns\n\ns ?\n???\n\n=\nL\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 77\n\nO termo repetido em \u201cs\u201d indica a presen\u00e7a de caracter\u00edsticas integradoras no\n\nprocesso.\n\nSeparando a resposta ao degrau unit\u00e1rio em fra\u00e7\u00f5es parciais, temos:\n\n( ) jijijiji\nji\n\nsnajis\n\nnaji\n\nnajis\n\nji\n\njisji\nd e\n\ns\n\nc\ne\n\nrs\n\nc\ne\n\nrs\n\nc\ne\n\ns\n\nc\nsy ,,,,\n\n, 2\n,,\n\n1,,\n\n1,,\n\n1,,\n\n1,,0,, ???? ??\n\n?\n\n??? +\n?\n\n++\n?\n\n+= L\n\nsendo:\n\n( ) ( )( )( ) ( )na,j,i2,j,i1,j,i\nj,i\n\ng,j,ig,j,i\ng,j,i\n\nlim\nrsrsrss\n\nsb\nrsc\n\nrs ???\n?=\n\n? L\n\nTransformando a express\u00e3o da resposta ao degrau para o dom\u00ednio do tempo\n\ntemos a seguinte forma geral:\n\n( ) ( ) ( ) ( )jinajitrnajitrjijid tcececcty jinajijijiji ,,,1,,1,,0,, ,1,,,1,,, ?\n?? ?++++= ???\n\n?? ?L\n\n(8.18)\n\nSimplificando a express\u00e3o (8.18), temos:\n\n( ) ( ) ( )jinaji\nna\n\ng\n\ntr\ngjid tcecty\n\njigji\n\nji ,,,\n\n1\n\n0\n,,\n\n,,,\n\n,\n?? ?+= ?\n\n?\n\n=\n\n??\n(8.19)\n\nOs coeficientes da resposta ao degrau do sistema podem ser obtidos a partir da\n\neq. (8.19):\n\n( ) ji\nna\n\ng\ngjigjijinji\n\njinji\n\nnTnTfccs\n\nnTs\n\n,\n1\n\n,,,,0,,,,\n\n,,, 0\n\n?\n\n?\n\n??+=\n\n??=\n\n?\n=\n\n(8.20)\n\nsendo:\n\nn - instante de amostragem\n\n( )\n( ) ( )\n\n( ) 0\n0\n\n1\n\n,,,,,\n\n,,,,\n\n0,,\n\n,,,\n\n=??=\n\n??=\n\n=\n??\n\ngjijigji\n\ngji\ntr\n\ngji\n\nji\n\nrttf\n\nretf\n\ntf\njigji\n\n?\n\n?\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 78\n\nPara o sistema multivari\u00e1vel \u00e9 conveniente agrupar os par\u00e2metros do modelo da\n\nseguinte forma:\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n=\n\n0,,0,1,\n\n0,,10,1,1\n\n0\n\nnunyny\n\nnu\n\ncc\n\ncc\nC\n\nL\nMM\n\nL\nC ny nu0 ? ?\n\n\u00d7 (8.21)\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n=\n\nnunyny\n\nnu\n\ncc\n\ncc\nC\n\n,1,\n\n,11,1\n\nL\nMM\n\nL\nnanunyC .\u00d7? C (8.22)\n\n                                                               ]...[ naj,i,j,2i,j,1i,ji, cccc =\n\nr0\n\n0 0\n\n0 0\n=\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\nL\nM M\n\nL\nr ny nu0 ? ?\n\n\u00d7 (8.23)\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n=\n\nnunyny\n\nnu\n\nrr\n\nrr\nr\n\n,1,\n\n,11,1\n\nL\nMM\n\nL\nnanunyr .\u00d7? C (8.24)\n\n                                                              ]...[ naj,i,j,2i,j,1i,ji, rrrr =\n\nA resposta ao degrau \u00e9 representada por:\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n=\n\nnnunynny\n\nnnun\n\nn\n\nss\n\nss\nS\n\n,,,1,\n\n,,1,1,1\n\nL\nMM\n\nL\nSn\n\nny nu? ? \u00d7\n\n8.2.2 \u2013 Predi\u00e7\u00e3o com modelos param\u00e9tricos\n\nPara um processo qualquer, podemos representar a predi\u00e7\u00e3o da vari\u00e1vel\n\ncontrolada da seguinte forma:\n\n[ ] [ ]y y s ui k n k\nk\n\ni k n k\nk\n\ni j n j k\nj\n\nnu\n\n, , , , ,+\n?\n\n+ ?\n?\n\n?\n=\n\n= + ?\n1\n\n1\n1\n\n1\n1\n\n? (8.1)\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 79\n\nPodemos substituir si,j,n  da eq. (8.20) na equa\u00e7\u00e3o (8.1), obtendo:\n\n[ ] [ ] ( )y y c f nT ui k n k\nk\n\ni k n k\nk\n\ni j g i j g j k\ng\n\nna\n\nj\n\nnu\n\n, , , , , , ,+\n?\n\n+ ?\n?\n\n?\n==\n\n= + ??\n1\n\n1\n1\n\n1\n01\n\n?\n\nSeparando os termos independentes dos dependentes do tempo, temos:\n\n[ ] [ ] ( )y y c u c f nT ui k n k\nk\n\ni k n k\nk\n\ni j j k\nj\n\nnu\n\ni j g i j g j k\ng\n\nna\n\nj\n\nnu\n\n, , , , , , , , , ,+\n?\n\n+ ?\n?\n\n?\n=\n\n?\n==\n\n= + +? ??\n1\n\n1\n1\n\n0 1\n1\n\n1\n11\n\n? ?\n\n(8.25)\n\nA equa\u00e7\u00e3o (8.25) nos induz a supor que a equa\u00e7\u00e3o da predi\u00e7\u00e3o pode ser reescrita\n\nda seguinte forma:\n\n[ ] [ ] [ ] ( )? ?\n= = ?\n\n?\n?\n\n?\n?\n\n+ +=\nnu\n\nj\ngji\n\nna\n\ng k\nkgji\n\nk\nki\n\nk\nknki nTfppy\n\n1\n,,\n\n1 1\n1,,\n\n1\n1\n\n1\n,   (8.26)\n\n? >n nT\ni\n\nij| max?\n\nsendo:\n\n[ ] [ ]p e pi k\nk\n\ni j g k\nk\n\n?\n? ? ?\n\n1\n1 1 1\n\n, ,   os par\u00e2metros dessa nova representa\u00e7\u00e3o.\n\nConsiderando apenas sistemas n\u00e3o integradores e usando a defini\u00e7\u00e3o de fi,j,g em\n\n(8.26), temos:\n\n[ ] [ ] ( )? ??\n= =\n\n?\n=\n\n?\n?\n\n?++\n?\n\n+ ?+?+=\nnu\n\nj\n\nna\n\ng\nkjgji\n\nTr\ngji\n\nnu\n\nj\nkjji\n\nk\nknki\n\nk\nknki unTfecucyy\n\ngji\n\n1 1\n1,,,,,\n\n1\n1,0,,\n\n1\n11,\n\n1\n,\n\n,,\n\n(8.27)\n\ncomo:\n\n[ ] [ ] [ ] ( )( )? ?\n= = ?\n\n?\n?\n\n?\n?\n\n?++ ++=\nnu\n\nj\ngji\n\nna\n\ng k\nkgji\n\nk\nki\n\nk\nknki Tnfppy\n\n1\n,,\n\n1 1\n1,,\n\n1\n1\n\n1\n11, 1\n\nou\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 80\n\n[ ] [ ] [ ] ( )? ?\n= = ?\n\n?\n?\n\n?\n?\n\n?++ +=\nnu\n\nj\ngji\n\nTr\nna\n\ng k\nkgji\n\nk\nki\n\nk\nknki nTfeppy\n\ngji\n\n1\n,,\n\n1 1\n1,,\n\n1\n1\n\n1\n11,\n\n,, (8.28)\n\nsubstituindo (8.28) na equa\u00e7\u00e3o (8.27) , temos:\n\n[ ] [ ]\n\n[ ] ( )? ?\n\n?\n\n= =\n?\n\n?\n?\n\n=\n?\n\n?\n?\n\n?\n+\n\n?\n?\n??\n\n?\n? ?++\n\n+?+=\n\nnu\n\nj\n\nna\n\ng\ngjikj\n\nTr\ngji\n\nTr\n\nk\nkgji\n\nnu\n\nj\nkjji\n\nk\nki\n\nk\nknki\n\nnTfuecep\n\nucpy\n\ngjigji\n\n1 1\n,,1,,,\n\n1\n1,,\n\n1\n1,0,,\n\n1\n1\n\n1\n,\n\n,,,,\n\n(8.29)\n\nDa\u00ed a eq. (8.29) pode ser reescrita como:\n\n[ ] [ ] [ ] ( )? ?\n= = ?\n\n??\n+ +=\n\nnu\n\nj\ngji\n\nna\n\ng k\nkgji\n\nk\nki\n\nk\nknki nTfppy\n\n1\n,,\n\n1 1\n,,\n\n11\n,\n\nsendo:\n\n[ ] [ ] ?\n=\n\n?\n?\n\n?\n?\n\n?+=\nnu\n\nj\nkjji\n\nk\nki\n\nk\nki ucpp\n\n1\n1,0,,\n\n1\n1\n\n1\n(8.30)\n\n[ ] [ ] 1,,,\n1\n\n1,,\n1\n\n,,\n,,,,\n\n?\n?\n\n?\n?\n\n?+= kj\nTr\n\ngji\nTr\n\nk\nkgji\n\nk\nkgji uecepp\n\ngjigji\n\nfazendo  d ei j g\nr Ti j g\n\n, ,\n, ,= , temos:\n\n[ ] [ ] 1,,,,,\n1\n\n1,,,,\n1\n\n,, ?\n?\n\n?\n?\n\n?+= kjgjigji\nk\n\nkgjigji\nk\n\nkgji udcpdp (8.31)\n\nAs equa\u00e7\u00f5es (8.30) e (8.31) s\u00e3o as equa\u00e7\u00f5es que atualizam os par\u00e2metros da\n\nequa\u00e7\u00e3o (8.26), que foi proposta para a predi\u00e7\u00e3o das vari\u00e1veis controladas.\n\nVamos procurar agora uma forma vetorial para a equa\u00e7\u00e3o (8.26), que pode ser\n\nescrita como:\n\n[ ] [ ] [ ] ( ) [ ] ( ){ }?\n= ??\n\n??\n+ +++=\n\nnu\n\nj\ni,j,na\n\nk\nki,j,nai,j,\n\nk\nki,j,\n\nk\nki\n\nk\nkni,k nTfpnTfppy\n\n1 1\n111\n\n1\n11\n\nL\n\n[ ] [ ] [ ] ( ) [ ] ( ){\n[ ] ( ) [ ] ( )}nTfpnTfp\n\nnTfpnTfppy\n\nnanui\nk\n\nknanuinui\nk\n\nknui\n\nnai\nk\n\nknaii\nk\n\nki\nk\n\nki\nk\n\nknki\n\n,,\n1\n\n,,1,,\n1\n\n1,,\n\n,1,\n1\n\n,1,1,1,\n1\n\n1,1,\n11\n\n,\n\n??\n\n????\n+\n\n+++\n\n+++++=\n\nL\n\nLL\n\n(8.32)\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 81\n\nEscrevendo a eq. (8.32) para i = 1, 2,\u2026,ny, temos:\n\n[ ] [ ] [ ] ( ) [ ] ( )\n\n[ ] ( ) [ ] ( )\n\n[ ] [ ] [ ] ( ) [ ] ( )\n\n[ ] ( ) [ ] ( )\n?\n?\n?+++\n\n?\n?\n? +++++=\n\n?\n?\n?+++\n\n?\n?\n? +++++=\n\n??\n\n????\n+\n\n??\n\n????\n+\n\nnTfpnTfp\n\nnTfpnTfppy\n\nnTfpnTfp\n\nnTfpnTfppy\n\nnanu,ny,nanu,ny,nu,1ny,nu,1ny,\n\nnany,1,nany,1,ny,1,1ny,1,1nynkny,\n\nnanu,1,nanu,1,nu,11,nu,11,\n\nna1,1,na1,1,1,1,11,1,11nk1,\n\n1k\nk\n\n1k\nk\n\n1k\nk\n\n1k\nk\n\n1k\nk\n\n1k\nk\n\n1k\nk\n\n1k\nk\n\n1k\nk\n\n1k\nk\n\n1k\nk\n\n1k\nk\n\nL\n\nLL\n\nM\n\nL\n\nLL\n\nVetorialmente temos:\n\n[ ] [ ] [ ]\n111 ???\n\n+ += kk\nt\n\nnk\nk\n\ni\n\nk\nknk ppy ? (8.33)\n\nsendo:\n\n[ ] [ ] [ ]\nT\n\nk\nknkny\n\nk\nknk\n\nk\nknk yyy ??\n\n?\n??\n?=\n\n?\n+\n\n?\n+\n\n?\n+\n\n1\n,\n\n1\n,1\n\n1\nL [ ] 1\n\n1\n\n\u00d7\n\n?\n+ ??\n\nny\n\nk\nknky\n\n[ ] [ ] [ ]\nT\n\nk\nkny\n\nk\nk\n\nk\nk\n\ni ppp\n??\n?\n\n??\n?=\n\n??? 11\n11\n\nL [ ] 1\n1\n\n\u00d7\n\n?\n?? ny\n\nk\nk\n\nip\n\n[ ] [ ] [ ] [ ] [ ]\n\n[ ] [ ] [ ] [ ] [ ] 1..\n11\n\n,,\n1\n\n1,,\n1\n\n,1,\n1\n\n1,1,\n\n1\n,,1\n\n1\n1,,1\n\n1\n,1,1\n\n1\n1,1,11\n\n\u00d7\n\n?????\n\n?????\n\n????\n?\n\n??\n?=\n\nnanuny\n\nk\nk\n\nt\nT\n\nk\nknanuny\n\nk\nknuny\n\nk\nknany\n\nk\nkny\n\nk\nknanu\n\nk\nknu\n\nk\nkna\n\nk\nk\n\nk\nk\n\nt\n\nppppp\n\nppppp\n\nLLL\n\nLLLL\n\n( )\n( )\n\n( )\n\n? n\n\nny\n\nf n\nf n\n\nf n\n\n=\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n1\n\n2\n\n0 0\n0 0\n\n0 0\n\nL\nL\n\nM M O M\nL\n\n; ? n\nny ny nu na? ? \u00d7 . . (8.34)\n\nsendo\n\n( ) ( ) ( ) ( ) ( )[ ]f n f n f n f n f ni i i na i nu i nu na= , , , , , , , ,1 1 1 1L L L     nyi ,,2,1 L=\n\nEscrevendo a eq. (8.30) para i = 1, 2,\u2026,ny, temos:\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 82\n\n[ ] [ ] 1111 ???? ?+= kokk\ni\n\nk\nk\n\ni uCpp (8.35)\n\nAnalogamente, a eq. (8.31) para i = 1, 2,\u2026,ny, leva \u00e0 seguinte rela\u00e7\u00e3o:\n\n[ ] [ ] 1111 ???? ?+= kpkk\nt\n\nk\nk\n\nt uCDNpDp (8.36)\n\nsendo:\n\n( )D d d d d d d d dna nu nu na ny ny na ny nu ny nu na= 1 1 1 1 1 1 1 1 1 1 1 1, , , , , , , , , , , , , , , ,L L L L L L L\nD ny nu na ny nu na? ? \u00d7. . . .\n\n( )C c c c c c c c cna nu nu na ny ny na ny nu ny nu na= 1 1 1 1 1 1 1 1 1 1 1 1, , , , , , , , , , , , , , , ,L L L L L L L\nnanunynanunyCC .... \u00d7?\n\nN\nJ\n\nJ\nJp\n\nny\n\ni=\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n=\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n1\n\n1 0 0\n\n1 0 0\n0 1 0\n\n0 1 0\n\n0 0 1\n\n0 0 1\n\nM\n\nL\nM M M\n\nL\nL\n\nM M M\nL\n\nM\nL\n\nM M M\nL\n\nJ\n\nN\n\ni\nnu na nu\n\np\nny nu na nu\n\n? ?\n\n? ?\n\n\u00d7\n\n\u00d7\n\n.\n\n. .\n\n8.2.3 \u2013 C\u00e1lculo das predi\u00e7\u00f5es das vari\u00e1veis controladas\n\nPara que a ordem do modelo seja reduzida \u00e9 necess\u00e1rio que se reduza o n\u00famero\n\nde estados utilizados para o c\u00e1lculo das predi\u00e7\u00f5es das vari\u00e1veis controladas.\n\nPara modelos param\u00e9tricos, o vetor de predi\u00e7\u00f5es tem duas partes com\n\ncaracter\u00edsticas diferentes. A primeira parte \u00e9 id\u00eantica ao caso em que se usa modelos de\n\nconvolu\u00e7\u00e3o (item 8.1) e a segunda parte que utiliza o modelo param\u00e9trico em instantes\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 83\n\npreviamente definidos, que normalmente est\u00e3o distribu\u00eddos em instantes de tempo\n\nesparsos.\n\nUma vantagem direta desta abordagem \u00e9 a redu\u00e7\u00e3o substancial das dimens\u00f5es do\n\nvetor da predi\u00e7\u00e3o e da matriz de transi\u00e7\u00e3o de estado (M), onde, tamb\u00e9m podemos incluir\n\ninstantes bem distantes e as predi\u00e7\u00f5es no estado estacion\u00e1rio.\n\nAs mesmas etapas utilizadas para o c\u00e1lculo das predi\u00e7\u00f5es com modelos n\u00e3o\n\nparam\u00e9tricos, feitas no par\u00e1grafo 8.1.1, s\u00e3o utilizadas no c\u00e1lculo das predi\u00e7\u00f5es com\n\nmodelos param\u00e9tricos. Nos pr\u00f3ximos itens apresentaremos as altera\u00e7\u00f5es feitas nos\n\nc\u00e1lculos das predi\u00e7\u00f5es com a utiliza\u00e7\u00e3o de modelos de ordem reduzida.\n\n8.2.3.1 \u2013 Efeito da \u00faltima a\u00e7\u00e3o de controle\n\nO vetor das predi\u00e7\u00f5es das vari\u00e1veis controladas \u00e9 composto de duas partes:\n\n1)  Parte referente ao tempo morto, onde a vari\u00e1vel controlada n\u00e3o sofre o efeito\n\ndo ?uk -1, ou instantes em que se deseja intervalos de tempo sucessivos acima\n\ndo tempo morto, ou seja:\n\ns nTi j n i j, , ,= ? ?0 ?\n\nA parte do vetor de predi\u00e7\u00f5es das sa\u00eddas, dentro do tempo morto, tem a mesma\n\nestrutura que o caso convencional apresentada em (8.1).\n\n2)  Parte onde ?uk -1 afeta os valores das predi\u00e7\u00f5es, que pode ter uma estrutura\n\ndiferente, por exemplo, considerando instantes de tempo esparsos.\n\nNa defini\u00e7\u00e3o dos instantes das predi\u00e7\u00f5es deve-se considerar a exist\u00eancia dessas 2\n\npartes. Assim, os instantes at\u00e9 o maior tempo morto mais um per\u00edodo de amostragem\n\ndevem ser seq\u00fcenciais, ou seja:\n\n?\n?\n?\n\n?\n?\n?\n\n?\n?\n?\n\n?\n?\n?= Tn\n\nji\n\nji\n\n,\n\n,\n0 intmax\n\n?\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 84\n\nAp\u00f3s o instante n0, as predi\u00e7\u00f5es podem ser calculadas em instantes esparsos.\n\nEntretanto, em todos os instantes desejados, elas podem ser corrigidas com a \u00faltima\n\na\u00e7\u00e3o de controle da seguinte forma:\n\n[ ] [ ]y y S uk\nk\n\nk\nk\n\nk\n?\n\n?\n?\n\n?= +\n1\n\n1\n1\n\n1? (8.37)\n\nsendo:\n\n[ ] [ ] [ ] [ ] [ ] [ ]\nT\n\nT\nnk\n\nT\nnk\n\nT\nnk\n\nT\nk\n\nT\nkk\n\nk\nk\n\nkh\nk\n\nk\nk\n\nkk\nk\n\nk\nk\n\nyyyyyy ?\n?\n?\n\n?\n?\n?\n\n=\n?\n\n?\n?\n\n?\n?\n\n??\n?\n\n?\n? +++++?\n\n?\n1\n\n1\n1\n\n11\n1\n\n101\n1\n\n1\n1 211\n\n1 LL\n\n[ ] [ ] [ ] [ ] [ ] [ ]\nT\n\nT\nnk\n\nT\nnk\n\nT\nnk\n\nT\nk\n\nT\nkk\n\nk\nk\n\nkh\nk\n\nk\nk\n\nkk\nk\n\nk\nk\n\nyyyyyy ?\n?\n?\n\n?\n?\n?\n\n=\n?????\n\n+++++?\n11\n\n1\n1\n\n0\n11\n\n211\nLL\n\n[ ]? ? ?u u uk k nu k\nT\n\n? ? ?=1 1 1 1, ,L\n\n[ ]TTTTTT\nhnnn\n\nSSSSSS LL\n101\n\n2=\n\nsendo:\n\nnp - n\u00famero de instantes de predi\u00e7\u00e3o\n\nnp = n0 + h\n\nn0  - n\u00fameros de instantes seq\u00fcenciais\n\nh  - n\u00famero de instantes esparsos\n\n8.2.3.2 \u2013 Corre\u00e7\u00e3o das predi\u00e7\u00f5es com as leituras da planta\n\nCom o efeito da \u00faltima a\u00e7\u00e3o de controle calculado, devemos corrigir as predi\u00e7\u00f5es\n\natrav\u00e9s da leitura das vari\u00e1veis controladas. Para o c\u00e1lculo dessa corre\u00e7\u00e3o, utilizamos\n\napenas os termos correspondentes ao instante k+1 do vetor de predi\u00e7\u00f5es da mesma\n\nforma da abordagem utilizada na predi\u00e7\u00e3o com modelos n\u00e3o param\u00e9tricos, por\u00e9m as\n\ndimens\u00f5es da matriz N s\u00e3o diferentes, ou seja:\n\n[ ] [ ]y N yk k\nk\n\nk\nk\n\n+\n? ?\n\n=1\n1 1\n\n(8.38)\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 85\n\nsendo:\n\nN =\n\n?\n\n?\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n\n1 0 0 0 0\n0 1 0 0 0\n\n0 0 1 0 0\n\nL L\nL L\n\nM M O M M M\nL L\n\n; ( )nanunpnynyN .1++\u00d7??\n\nPara as predi\u00e7\u00f5es atrav\u00e9s de modelos param\u00e9tricos, as corre\u00e7\u00f5es das predi\u00e7\u00f5es\n\ncom as leituras da planta s\u00e3o efetuadas da seguinte forma:\n\n[ ] [ ] [ ] ( ) i,k\nnu\n\nj\ni,j,g\n\nna\n\ng k\nki,j,g\n\nk\nki\n\nk-\nk\n\nc wnTfppy\nni,k\n\n++= ? ?\n= = ?\n\n?+\n1 1 1\n\n11\n\ncomo wi,k n\u00e3o \u00e9 fun\u00e7\u00e3o do tempo, a corre\u00e7\u00e3o s\u00f3 \u00e9 aplicada ao valor de [ ]\n1k\n\nkip\n?\n\n.\n\nPortanto, a corre\u00e7\u00e3o dos par\u00e2metros fica da seguinte forma:\n\n [ ] [ ] i,k\nnu\n\nj\nj,ki,j,\n\nk\nki\n\nk\nk\n\nc\ni wucpp ++= ?\n\n=\n?\n\n?\n?\n\n?\n1\n\n10\n1\n\n1\n1\n\n?\n\n[ ] [ ] 1\n1\n\n1\n1\n\n? ?\n?\n\n?\n?\n\n+= j,k\nTr\n\ni,j,g\nTr\n\nk\nki,j,g\n\nk\nk\n\nc\ni,j,g uecepp\n\ni,j,gi,j,g\n\nComo no controlador convencional, podemos corrigir o desvio da predi\u00e7\u00e3o em\n\nrela\u00e7\u00e3o \u00e0 leitura da planta utilizando uma matriz K com dimens\u00f5es relativas ao novo\n\nvetor de predi\u00e7\u00f5es, portanto a nova corre\u00e7\u00e3o \u00e9 apresentada como:\n\n[ ] [ ] kkkkk\nc KWyy +=\n\n?? 11\n(8.39)\n\nsendo:\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 86\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n=\n\n000\n\n000\n\n100\n\n001\n\n100\n\n001\n100\n\n010\n001\n\nL\nMMM\n\nL\nMMM\n\nL\nMMM\n\nL\nMMM\n\nL\nMMM\n\nL\nL\n\nMOMM\nL\nL\n\nK\n\n8.2.3.3 \u2013 Transla\u00e7\u00e3o da predi\u00e7\u00e3o corrigida\n\nAs predi\u00e7\u00f5es das vari\u00e1veis controladas est\u00e3o atualizadas e corrigidas para o\n\ninstante k. Isto significa que:\n\n[ ]yi kc k\nk\n\n, +\n?\n\n2\n1\n - corresponde ao instante atual k+1\n\n[ ]yi kc k\nk\n\n, +\n?\n\n3\n1\n - corresponde ao instante futuro k+2\n\n      M\n\n[ ]yi k nc k\nk\n\nk, + +\n?\n\n1\n1\n - corresponde ao instante futuro k+nk\n\nPortanto, dentro da filosofia dos controladores preditivos, que apresentam um\n\nhorizonte m\u00f3vel, \u00e9 necess\u00e1rio fazer a transla\u00e7\u00e3o de um instante de tempo em todo vetor\n\nde predi\u00e7\u00f5es e para todas as vari\u00e1veis controladas.\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 87\n\n[ ] [ ]\n\n[ ] [ ]\n[ ] [ ]\n\n[ ] [ ]\n\n[ ] [ ]\n\n[ ] [ ]\n1\n\n1\n\n1\n111\n\n1\n32\n\n1\n3121\n\n1\n21\n\n1\n2111\n\nk-\nk\n\nc\nnny,k\n\nk\nknny,k\n\nk-\nk\n\nc\nn,k\n\nk\nkn,k\n\nk-\nk\n\nc\nny,k\n\nk\nkny,k\n\nk-\nk\n\nc\n,k\n\nk\nk,k\n\nk-\nk\n\nc\nny,k\n\nk\nkny,k\n\nk-\nk\n\nc\n,k\n\nk\nk,k\n\nyy\n\nyy\n\nyy\n\nyy\n\nyy\n\nyy\n\nkk\n\n+++\n\n+++\n\n++\n\n++\n\n++\n\n++\n\n=\n\n=\n\n=\n\n=\n\n=\n\n=\n\nM\n\nM\n\nM\n\nM\n\npara     n ?  no\n\nsendo: no ?  m\u00e1x ?i,j\n\nPara n > no usamos a eq. (8.33), assim temos:\n\n[ ] [ ] [ ]\nk\n\nk\nt\n\nk\nk\n\ni\n\nk\nk1nk ppy 1n+++ ?+=\n\nPara os instantes esparsos temos:\n\n[ ] [ ] [ ]\n[ ] [ ] [ ]\n\n[ ] [ ] [ ]\nk\n\nk\nt\n\nk\nk\n\ni\n\nk\nknk\n\nk\nk\n\nt\n\nk\nk\n\ni\n\nk\nknk\n\nk\nk\n\nt\n\nk\nk\n\ni\n\nk\nknk\n\nppy\n\nppy\n\nppy\n\nk\n\n2\n\n1\n\n1n\n\n1n\n\n1n\n\nk\n\n2\n\n1\n\n++\n\n++\n\n++\n\n?+=\n\n?+=\n\n?+=\n\nM\n\nPara os par\u00e2metros da predi\u00e7\u00e3o n\u00e3o temos a opera\u00e7\u00e3o de transla\u00e7\u00e3o, ou seja:\n\n[ ] [ ]\nk\n\nk\nc\n\ngj,i,\nk\n\nkgj,i, pp =\n\n[ ] [ ]\nk\n\nk\nc\ni\n\nk\nki pp =           \n\nna  ,. . 1,.  g\nnu  ,. . 1,. j \nny  ,. . . 1,  i\n\n=\n=\n=\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 88\n\nJuntando as opera\u00e7\u00f5es de transla\u00e7\u00e3o, efeito da \u00faltima a\u00e7\u00e3o de controle e corre\u00e7\u00e3o\n\nda predi\u00e7\u00e3o temos:\n\n[ ] [ ] KWuSyMy k\n1-k\n\n1-k\nk\n\nk +?+= ?1 (8.40)\n\nsendo:\n\n [ ]\n[ ] [ ] [ ] [ ] [ ]\n\n[ ] [ ] [ ] [ ]\n\nT\n\nk\nk\n\nt\nk\n\nk\ni\n\nk\nknk\n\nk\nknk\n\nk\nknkk\n\nknk\nk\n\nk1nk\nk\n\nk2k\nk\n\nk1k\n\nk\nk\n\nppyy\n\nyyyyy\n\ny\nh2\n\n1\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n=\n\n++\n\n++?+++\n\nL\n\nL\n\n....\n\n...\n\n[ ] ( ) 1nu.na1npny\nk\n\nky\n\u00d7++??\n\nsendo  np = n0 + h\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n=\n\n+\n\n+\n\n+\n\n+\n\nD\nI\nI\n\nI\nI\nI\n\nI\n\nI\nI\n\nM\n\nny\n\nnny\n\nnny\n\nnny\n\nnny\n\nny\n\nny\n\nny\n\nh\n\n000000000\n000000000\n\n00000000\n\n00000000\n00000000\n00000000\n\n000000000\n\n000000000\n000000000\n\n1\n\n1\n\n1\n\n1\n\n2\n\n1\n\n0\n\nLL\nLL\nLL\n\nMMMOMMMMOMMM\nLL\nLL\nLL\nLL\n\nMMMOMMMMOMMM\nLL\nLL\n\n?\n\n?\n?\n?\n\n( ) ( )M ny np nu na ny np nu na? ? + + \u00d7 + +1 1. .\n\n[ ]TpTTnTnTnTnTnTT CDNCSSSSSSSS k 0111132 2100 ++++= LL\n( )S ny np nu na nu? ? + + \u00d71 .\n\nA matriz M fornece a transla\u00e7\u00e3o para instantes de tempo seq\u00fc\u00eancias e esparsos.\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 89\n\n8.2.4 \u2013 C\u00e1lculo das a\u00e7\u00f5es de controle\n\nO algoritmo de controle preditivo com modelo param\u00e9trico calcula as a\u00e7\u00f5es de\n\ncontrole da mesma forma descrita anteriormente, alterando apenas a constru\u00e7\u00e3o das\n\nmatrizes envolvidas. As etapas do algoritmo passam a ter a seguinte forma:\n\n8.2.4.1 \u2013 Trajet\u00f3ria refer\u00eancia das vari\u00e1veis controladas\n\nCom a utiliza\u00e7\u00e3o dos modelos de estado (param\u00e9trico), \u00e9 necess\u00e1rio calcular as\n\npredi\u00e7\u00f5es somente nos instantes em que o controlador ir\u00e1 minimizar o erro. Neste caso,\n\no horizonte de predi\u00e7\u00e3o (np) se confunde com o horizonte de otimiza\u00e7\u00e3o (nr).\n\nCom as predi\u00e7\u00f5es em tempos esparsos, os instantes de predi\u00e7\u00e3o podem ser\n\ndiferentes para cada uma das vari\u00e1veis controladas. Isto \u00e9, se tivermos k instantes\n\nesparsos, o vetor de instantes esparsos para a vari\u00e1vel j pode ser dado por:\n\n[ ]t t t tj j j j k= , , ,1 2 L\n\nA predi\u00e7\u00e3o transferida de um instante de amostragem para outro \u00e9 da forma:\n\n[ ] [ ]\nk\n\nk\nTti\n\nnhknknkkkk\nk ppyyyyyy +++++= LL 1021  (8.41)\n\nsendo:\n\n[ ]y y yk i k i ny k i\nT\n\n+ + += 1, ,L\n\nn0   - n\u00famero de instantes de predi\u00e7\u00e3o seq\u00fcenciais.\n\nh   - n\u00famero de instantes esparsos das predi\u00e7\u00f5es ( np \u2013 n0 )\n\nAs predi\u00e7\u00f5es das vari\u00e1veis controladas s\u00e3o alteradas pelas a\u00e7\u00f5es de controle em\n\ncada instante futuro. Desta forma, quando aplicamos \u201cm\u201d a\u00e7\u00f5es de controle, temos:\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 90\n\n[ ] [ ]\n[ ] [ ]\n\n[ ] [ ]\n\n[ ] [ ]\n[ ] [ ] 10100\n\n1111\n\n1111\n\n11222\n\n111\n\n?++\n\n?++?+?++\n\n?++?++\n\n+++\n\n++\n\n?++?+?+=\n\n?++?+?+=\n\n?++?+?+=\n\n?+?+=\n\n?+=\n\nmkkkk\nk\n\ni\n\nk\nk\n\ni\n\nmkmnkknkknk\nk\n\nknpk\nk\n\nknkk\n\nmkkmkm\nk\n\nkmk\nk\n\nkmk\n\nkk\nk\n\nkk\nk\n\nkk\n\nk\nk\n\nkk\nk\n\nkk\n\nuCuCuCpp\n\nuSuSuSyy\n\nuSuSuSyy\n\nuSuSyy\n\nuSyy\n\nL\n\nL\nM\n\nL\nM\n\nVetorialmente, temos:\n\n[ ] [ ] uSyy m\nk\n\nk\nk\n\nk ?+=\n\nsendo:\n\n[ ] [ ]T\nk\n\nk\ni\n\nnkkmk2k1k\nk\n\nk pyyyyy ++++= LL\n\n[ ]Tmuuu ??=? L1\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n=\n\n+??\n\n?\n\n000\n\n1mnk1nknk\n\n11mm\n\n12\n\n1\n\nm\n\nCCC\nSSS\n\nSSS\n\n0SS\n00S\n\nS\n\nL\nL\n\nMMM\nL\n\nMMM\nL\nL\n\nsendo:\n\nm - n\u00famero de a\u00e7\u00f5es de controle futuras calculadas pelo controlador,\n\n  conhecido como horizonte de controle\n\n8.2.4.2 \u2013 C\u00e1lculo dos erros das vari\u00e1veis controladas\n\nComo visto para o MPC com modelo n\u00e3o param\u00e9trico, no c\u00e1lculo dos erros em\n\nrela\u00e7\u00e3o aos respectivos setpoints, temos:\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 91\n\n[ ] [ ]\nk\n\nkjksp\nk\n\nkjk yye ++ ?=\n\n Na eq. (8.41), o vetor de predi\u00e7\u00f5es inclui os par\u00e2metros pi e pt da equa\u00e7\u00e3o de\n\npredi\u00e7\u00e3o (8.26). Assim, o vetor ysp deve incluir os valores correspondentes aos setpoints\n\ndesses par\u00e2metros. Pela eq. (8.26), se o sistema for est\u00e1vel em malha aberta, ent\u00e3o:\n\n[ ] [ ]\n1\n\n1\n1\n\nlim\n?\n\n?\n?\n\n+\n??\n\n=\nk\n\nk\ni\n\nk\nknk\n\nn\npy\n\nAssim, para pi o setpoint \u00e9 o mesmo das vari\u00e1veis controladas.\n\nResumindo, podemos representar o erro nas vari\u00e1veis controladas e par\u00e2metros\n\ncomo:\n\n[ ] [ ]\nk\n\nksp\nk\n\nk yNye ?= (8.42)\n\nsendo:\n\n[ ] [ ]Tknknknk2k1kkk eeeeeee k1 ?++++++= LL\n\n[ ]\nk\n\nk\nipye spk ?=?+\n\n[ ]y y ysp sp sp Tny= 1 L\n[ ] [ ]Ttinknknkkk\n\nk\nk ppyyyyyy\n\nk+++++\n= LL\n\n121\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 92\n\nN =\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n1 0\n\n0 1\n1 0\n\n0 1\n\n1 0\n\n0 1\n1 0\n\n0 1\n0 0\n\n0 0\n\nL\nM O M\n\nL\nL\n\nM O M\nL\n\nM M\nL\n\nM O M\nL\nL\n\nM O M\nL\nL\n\nM O M\nL ;\n\n( )N ny np nu na ny? ? + + \u00d71 .\n\n8.2.5 \u2013 Algoritmo de controle preditivo\n\nNo caso do controlador preditivo multivari\u00e1vel (MPC)  com modelos de ordem\n\nreduzida, temos para o erro ap\u00f3s as a\u00e7\u00f5es a mesma express\u00e3o que foi usada no item 8.1.2.3:\n\n[ ] [ ] uSee mkkkk ??= (8.14)\n\npor\u00e9m os vetores [ ]\nk\n\nke , e [ ]\nk\n\nke  e a matriz Sm s\u00e3o definidas de forma diferente conforme\n\napresentada na se\u00e7\u00e3o anterior.\n\nOs algoritmos de controle apresentados anteriormente podem tamb\u00e9m utilizar essa\n\nnova formula\u00e7\u00e3o.\n\n8.2.5.1 \u2013 MMPC (Multi-Model Predictive Control)\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 93\n\nDescreveremos agora uma nova formula\u00e7\u00e3o do controlador preditivo onde v\u00e1rios\n\nmodelos do processo s\u00e3o simultaneamente considerados. O problema de controle resultante\n\n\u00e9 ent\u00e3o resolvido usando a formula\u00e7\u00e3o da programa\u00e7\u00e3o n\u00e3o-linear (NLP) utilizando o\n\nalgoritmo tipo SQP (sequential quadratic programming) proposto por K. Schittkowski\n\n(1985).\n\nOs controladores multi-modelos procuram resolver o problema de controle preditivo\n\ncom sistemas variantes no tempo e no estado, isto \u00e9, t\u00eam uma faixa de opera\u00e7\u00e3o mais ampla\n\ndo que os controladores convencionais, em fun\u00e7\u00e3o das n\u00e3o-linearidades presentes no\n\nprocesso. O problema de controle \u00e9 resolvido atrav\u00e9s da utiliza\u00e7\u00e3o de um conjunto de\n\nmodelos, onde se descreve os diversos comportamentos do processo ao longo da regi\u00e3o de\n\nopera\u00e7\u00e3o do controlador.\n\n8.2.5.1.1 \u2013 Algoritmo MMPC\n\nO MMPC foi desenvolvido por Almeida Neto (1999) utilizando uma formula\u00e7\u00e3o\n\nbaseada em LMI\u2019s (Linear Matrix Inequalities). Entretanto, n\u00e3o temos dispon\u00edvel nenhum\n\npacote computacional para implementar essa solu\u00e7\u00e3o em sistemas industriais. Assim, neste\n\ntrabalho foi desenvolvida uma solu\u00e7\u00e3o que possa ser implementada com os pacotes de\n\nprograma\u00e7\u00e3o n\u00e3o-linear dispon\u00edveis. Para tal considere a fun\u00e7\u00e3o objetivo do controlador\n\nrepresentada pela equa\u00e7\u00e3o (8.15):\n\n[ ] [ ] [ ] [ ] ( ) uSSuuSeeSueeJ mTmTmT kkkk\nT\nm\n\nT\n\nk\nk\n\nT\n\nk\nkk ??+??+???????=    (8.15)\n\nConsiderando que Jk seja sempre menor do que um limite positivo ?, podemos\n\nrepresentar o objetivo  na forma:\n\nJ k ? ? ou ? ? ?J k 0\n\nou\n\n[ ] [ ] [ ] [ ] ( ) 0???+?????+??+?? uSSuuSeeSuee mTmTmT kkkk\nT\nm\n\nT\n\nk\nk\n\nT\n\nk\nk?\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle  94\n\nDai, o problema que o MPC resolve pode ser colocado na forma:\n\n                         (8.43)\n\nque \u00e9 um problema de otimiza\u00e7\u00e3o com fun\u00e7\u00e3o objetivo linear e restri\u00e7\u00f5es quadr\u00e1ticas,\n\nportanto um problema n\u00e3o-linear, que n\u00e3o pode ser resolvido com os pacotes\n\ncomputacionais de programa\u00e7\u00e3o linear (LP) ou quadr\u00e1tica (QP).\n\n8.2.5.1.2 \u2013 Representa\u00e7\u00e3o de incertezas do sistema\n\nEm geral, o modelo do processo varia ao longo do tempo, pois caracter\u00edsticas como:\n\nvaz\u00e3o de carga e produtos, composi\u00e7\u00e3o da carga e produtos, press\u00e3o de opera\u00e7\u00e3o, sujeira de\n\ntrocadores de calor variam no tempo. Estas incertezas podem ser incorporadas ao problema\n\nde controle atrav\u00e9s da utiliza\u00e7\u00e3o de v\u00e1rios modelos, sendo estes modelos colocados como\n\nnovas restri\u00e7\u00f5es a serem obedecidas pelo controlador, estas novas restri\u00e7\u00f5es seriam da\n\nforma:\n\n[ ] [ ] [ ] [ ] ( )\n[ ] [ ] [ ] [ ] ( )\n\n[ ] [ ] [ ] [ ] ( ) 0\n\n0\n\n0\n\n2222\n\n1111\n\n???+?????+??+??\n\n???+?????+??+??\n\n???+?????+??+??\n\nuSSuuSeeSuee\n\n.\n\n.\n\nuSSuuSeeSuee\n\nuSSuuSeeSuee\n\nm,L\nT\nm,L\n\nT\nm,L\n\nT\n\nk\nk\n\nk\nk\n\nT\nm,L\n\nT\n\nk\nk\n\nT\n\nk\nk\n\nm,\nT\nm,\n\nT\nm,\n\nT\n\nk\nk\n\nk\nk\n\nT\nm,\n\nT\n\nk\nk\n\nT\n\nk\nk\n\nm,\nT\nm,\n\nT\nm,\n\nT\n\nk\nk\n\nk\nk\n\nT\nm,\n\nT\n\nk\nk\n\nT\n\nk\nk\n\n?\n\n?\n\n?\n\nonde Sm,1 . . . . Sm,L  correspondem aos modelos obtidos em diferentes condi\u00e7\u00f5es\n\noperacionais.\n\nL \u2013 \u00e9 o n\u00famero de modelos alternativos do processo\n\n[ ] [ ] [ ] [ ] ( )\n\n0\n0\n\n0\n\n0\n\nmax\n\nmin\n\n???\n???\n\n?\n\n???+?????+??+??\n\n+?\n\n?\n\n?\n\nuu\nuu\n\nuSSuuSeeSueea:sujeito\n\nu\nMinimizar\n\nm\nT\nm\n\nT\nm\n\nT\n\nk\nk\n\nk\nk\n\nT\nm\n\nT\n\nk\nk\n\nT\n\nk\nk\n\n,\n\n?\n\n?\n\n?\n?\n\n\n\nCap\u00edtulo 8 - Algoritmos de controle 95\n\nNessa formula\u00e7\u00e3o, o problema do MMPC pode ser representado na seguinte forma:\n\n(8.44)\n\nObserve que o problema acima tem fun\u00e7\u00e3o objetivo linear e restri\u00e7\u00f5es quadr\u00e1ticas e\n\nportanto \u00e9 um problema de NLP. Na planta industrial o controlador MMPC definido pelo\n\nproblema \u00e9 resolvido com um solver comercial baseado em SQP (K. Schittkowski , 1985).\n\nNeste trabalho n\u00e3o se buscou investigar qual seria o solver mais adequado para o problema\n\ndo MMPC, que tem uma estrutura particular e talvez n\u00e3o a mais adequada para algoritmo\n\ntipo SQP. Em sistemas de grande porte essa considera\u00e7\u00e3o pode se tornar importante.\n\n[ ] [ ] [ ] [ ] ( )\n[ ] [ ] [ ] [ ] ( )\n\n[ ] [ ] [ ] [ ] ( )\n\n[ ] [ ] [ ] [ ] ( )\n\n0\n0\n\n0\n\n0\n\n0\n\n0\n\n0\n\nmax\n\nmin\n\n2222\n\n1111\n\n???\n???\n\n?\n\n???+?????+??+??\n\n???+?????+??+??\n\n???+?????+??+??\n\n???+?????+??+??\n\n?\n\n+?\n\n?\n\nuu\nuu\n\nuSSuuSeeSuee                    \n\n .                    \n .                    \n\nuSSuuSeeSuee                    \n\nuSSuuSeeSuee                     \n\nuSSuuSeeSueea:sujeito\n\n,u\nMinimizar\n\nm,L\nT\nm,L\n\nT\nm,L\n\nT\n\nk\nk\n\nk\nk\n\nT\nm,L\n\nT\n\nk\nk\n\nT\n\nk\nk\n\nm,\nT\nm,\n\nT\nm,\n\nT\n\nk\nk\n\nk\nk\n\nT\nm,\n\nT\n\nk\nk\n\nT\n\nk\nk\n\nm,\nT\nm,\n\nT\nm,\n\nT\n\nk\nk\n\nk\nk\n\nT\nm,\n\nT\n\nk\nk\n\nT\n\nk\nk\n\nm\nT\nm\n\nT\nm\n\nT\n\nk\nk\n\nk\nk\n\nT\nm\n\nT\n\nk\nk\n\nT\n\nk\nk\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n?\n\n\n\n96\n\n9\n\nAPLICA\u00c7\u00c3O DO MPC \u00c0 COLUNA DEPROPANIZADORA\n\nO algoritmo DMC em sua formula\u00e7\u00e3o tradicional apresenta algumas limita\u00e7\u00f5es\n\nque devem ser consideradas durante o projeto de controle. As limita\u00e7\u00f5es b\u00e1sicas s\u00e3o:\n\n\u00fc Utiliza\u00e7\u00e3o de modelos de convolu\u00e7\u00e3o discretos, que se constituem de uma seq\u00fc\u00eancia\n\nde coeficientes que correspondem aos valores da resposta ao degrau unit\u00e1rio em\n\ninstantes de amostragem sucessivos. Este fato faz com que o n\u00famero de coeficientes\n\nda resposta ao degrau leve a uma limita\u00e7\u00e3o computacional devido \u00e0 dimens\u00e3o do\n\nproblema, quando temos din\u00e2micas do processo muito lentas. Podemos contornar o\n\nproblema utilizando algumas op\u00e7\u00f5es como: for\u00e7ar o modelo a estabilizar no\n\nhorizonte desejado, o que provoca um desvio em rela\u00e7\u00e3o \u00e0 planta; truncar o modelo\n\ndo processo, tendo um modelo incompleto em rela\u00e7\u00e3o \u00e0 resposta da planta; ou\n\naumentar o per\u00edodo de amostragem, podendo perder alguma informa\u00e7\u00e3o importante\n\nentre duas amostragens sucessivas. Al\u00e9m disso fica muito dif\u00edcil conciliar modelos\n\ncom din\u00e2micas r\u00e1pidas e lentas com o mesmo n\u00famero de coeficientes da resposta ao\n\ndegrau.\n\n\u00fc Com a limita\u00e7\u00e3o do n\u00famero de coeficientes do modelo, a resposta ao degrau pode\n\nser semelhante \u00e0 de uma vari\u00e1vel integradora quando a constante de tempo do\n\nprocesso for muito elevada. Isto faz com que o controlador tenha mais dificuldade\n\nem resolver o problema de controle, porque o controlador preditivo n\u00e3o lida com\n\nsistemas integradores diretamente.\n\n\u00fc Utiliza\u00e7\u00e3o de modelos lineares invariantes no tempo. Assim, n\u00e3o s\u00e3o adequados para\n\nresolver problemas de controle onde o processo tem comportamento n\u00e3o-linear ou\n\nonde o modelo do sistema se altera ao longo do tempo. O modelo utilizado \u00e9\n\nidentificado em um ponto espec\u00edfico da regi\u00e3o de opera\u00e7\u00e3o do sistema. Da\u00ed o\n\ncontrolador \u00e9 projetado para operar numa regi\u00e3o onde o processo tem um dado\n\ncomportamento. Isto resulta em incertezas nos ganhos e constantes de tempo do\n\nprocesso e conseq\u00fcentemente em perda de desempenho do controlador, quando\n\noperando em outras regi\u00f5es.\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 97\n\nPara contornar estas limita\u00e7\u00f5es, neste trabalho modificamos o controlador\n\nconvencional. As modifica\u00e7\u00f5es testadas foram:\n\n\u00fc Uso do controlador em espa\u00e7o de estado com modelos de resposta ao\n\ndegrau anal\u00edtico no dom\u00ednio de tempo cont\u00ednuo;\n\n\u00fc Utiliza\u00e7\u00e3o de um controlador com m\u00faltiplos modelos, formulando o\n\nproblema de controle como um problema de Programa\u00e7\u00e3o n\u00e3o-linear\n\n(MMPC).\n\nForam comparadas as performances de duas estrat\u00e9gias de controle. A  primeira,\n\nque podemos chamar  de convencional, foi representada pelo QDMC. A segunda, que\n\npodemos chamar de robusta, ou que pelo menos tenta enfocar o problema de\n\nestabilidade do sistema para incertezas no modelo, representada pelo MMPC proposto\n\nneste trabalho. Na segunda, foram utilizados os 5 modelos levantados no simulador e\n\ntamb\u00e9m o modelo levantado na planta industrial.\n\n Os controladores foram avaliados atrav\u00e9s da observa\u00e7\u00e3o da capacidade dos\n\nmesmos em manter o sistema em malha fechada est\u00e1vel, tanto para as vari\u00e1veis\n\ncontroladas como as manipuladas, bem como a compara\u00e7\u00e3o das  performances dos\n\ncontroladores, considerando os efeitos dos seus par\u00e2metros de sintonia.\n\n A avalia\u00e7\u00e3o da performance de um sistema de controle, pode ser feita atrav\u00e9s do\n\nestabelecimento de algum padr\u00e3o de comportamento para o mesmo. Este padr\u00e3o pode\n\nestar ligado ao estado estacion\u00e1rio do sistema, ao comportamento no regime transiente,\n\n\u00e0 sensibilidade do sistema aos par\u00e2metros do controlador e aos efeitos das n\u00e3o-\n\nlinearidades do sistema.\n\nAs avalia\u00e7\u00f5es das performances dos controladores realizadas neste trabalho\n\nforam feitas de forma qualitativa para o caso servo e regulador. Inicialmente foram\n\ncomparadas as performances do QDMC e MMPC para alguns pontos de opera\u00e7\u00e3o\n\nconsiderando os mesmos par\u00e2metros de sintonia para os dois controladores. Ap\u00f3s o\n\najuste da sintonia foram aplicados degraus nas vari\u00e1veis controladas e perturba\u00e7\u00f5es,\n\nsendo verificada a estabilidade dos dois controladores. Em seguida, foi avaliada a\n\nperformance de cada controlador quando sujeito a altera\u00e7\u00f5es no modelo da planta,\n\nmantendo-se a mesma sintonia do item anterior. Finalmente o controlador MMPC foi\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 98\n\navaliado em opera\u00e7\u00e3o na planta industrial, considerando-se a melhor sintonia obtida\n\ndurante a simula\u00e7\u00e3o do controlador.\n\n9.1 \u2013  Compara\u00e7\u00e3o QDMC e  MMPC\n\nComo j\u00e1 vimos, o controlador tem a seguinte configura\u00e7\u00e3o:\n\nVari\u00e1veis manipuladas:\n               MV1  :  vaz\u00e3o de refluxo de topo (VRF)\n               MV2  :  vaz\u00e3o de fluido de aquecimento (VGOP)\n Vari\u00e1veis controladas:\n               CV1  : C3\n\n- do butano (%vol.) (C3\n-)\n\n               CV2  :  temperatura de topo da coluna (\u00baC) (Ttopo)\nVari\u00e1veis perturbadoras:\n               DV1  :  vaz\u00e3o de Carga (VFD)\n               DV2  :  temperatura do fluido de aquecimento (TGOP)\n\nOs controladores QDMC E MMPC utilizados t\u00eam uma s\u00e9rie de par\u00e2metros que\n\ns\u00e3o comuns. Durante o estudo foi utilizado um per\u00edodo de amostragem de 1 minuto que\n\n\u00e9 o valor desse par\u00e2metro usado na unidade industrial. O horizonte de controle (m) foi\n\nadotado igual a 2 em todas as simula\u00e7\u00f5es. No caso da utiliza\u00e7\u00e3o do MMPC o valor\n\ndesse par\u00e2metro deve ser o menor poss\u00edvel j\u00e1 que, como vimos no item 8.2.5.1.2, o\n\nproblema de controle recai em um problema de NLP cujo tempo de computa\u00e7\u00e3o\n\ndepende do horizonte de controle. Entretanto, as conclus\u00f5es n\u00e3o se alteram se um valor\n\nde (m) maior for utilizado.\n\nNo ajuste do controlador, o modelo nominal utilizado na predi\u00e7\u00e3o das vari\u00e1veis\n\ncontroladas foi um modelo obtido atrav\u00e9s de uma combina\u00e7\u00e3o de todos os modelos.\n\nEssa combina\u00e7\u00e3o consistiu na aplica\u00e7\u00e3o da m\u00e9dia aritm\u00e9tica para todos os par\u00e2metros\n\n(ganho e din\u00e2mica) para os modelos obtidos atrav\u00e9s do simulador e tamb\u00e9m aquele da\n\nplanta industrial. Para o modelo da planta utilizamos o modelo da planta industrial. No\n\nc\u00e1lculo da a\u00e7\u00e3o de controle utilizamos o \u201cmodelo combinado\u201d para o algoritmo QDMC,\n\ne os modelos 1, 2, 3, 4, 5 para o algoritmo MMPC. Al\u00e9m disso foram utilizados fatores\n\nde import\u00e2ncia (?) de 1 tanto para o C3\n- no butano como para a Ttopo. O C3\n\n-  \u00e9\n\ncontrolado no \u201cset-point\u201d e a Ttopo numa faixa de 1\u00baC entre os valores m\u00e1ximo e\n\nm\u00ednimo, j\u00e1 que sua especifica\u00e7\u00e3o n\u00e3o \u00e9 t\u00e3o rigorosa, Almeida et al (1996) apresenta uma\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 99\n\ndescri\u00e7\u00e3o de como implementar o controle por faixas.  Os instantes de amostragem\n\nutilizados para o c\u00e1lculo da predi\u00e7\u00e3o das vari\u00e1veis controladas foram 1, 2, 5, 7, 10, 15,\n\n20, 25, 30, 35, 40, 45, 50, 60, 70 para os dois controladores.\n\nNesta fase, comparamos a performance do MMPC e QDMC. Esta fase foi\n\ndividida em tr\u00eas etapas; sendo que na primeira fizemos o ajuste da sintonia do\n\ncontrolador (principalmente fator de supress\u00e3o das manipuladas), na segunda etapa foi\n\navaliada a performance dos controladores sujeitos a varia\u00e7\u00f5es nas vari\u00e1veis controladas\n\ne perturba\u00e7\u00f5es e por \u00faltimo os dois controladores foram avaliados quando sujeitos a\n\naltera\u00e7\u00f5es no modelo utilizado para a planta.\n\nNa tabela 9.1, apresentamos os ganhos dos modelos utilizados nos controladores:\n\nMdl VRF VGOP C3\n- Ttopo\n\nKp C3\n-\n\n(VRF)\n\nKp Ttopo\n\n(VRF)\n\nKp C3\n-\n\n(VGOP)\n\nKp Ttopo\n\n(VGOP)\nDet(Kp)\n\n1 4000 2104 0.38 47.74 4.498e-4 -0.0153 -0.003441 0.0510 -3.01e-5\n\n2 3160 1731 0.88 49.34 1.6713e-3 -0.0261 -0.012018 0.0550 -2.22e-4\n\n3 2300 1331 4.81 47.82 1.6792e-2 -0.0226 -4.3175e-2 0.0457 -2.08e-4\n\n4 2240 1115 3.01 47.08 7.5501e-3 -0.0295 -2.0402e-2 0.0751 -3.48e-5\n\n5 3532 1837 4.35 44.35 6.9795e-3 -0.0193 -1.8445e-2 0.0461 -3.42e-5\n\nFD 3800 1970 0.69 50.2 9.5821e-4 -0.01253 -3.61e-3 0.03144 -1.51e-5\n\nTabela 9.1 \u2013 Ganhos dos modelos identificados\n\n9.1.1 \u2013  Ajuste de sintonia dos controladores:\n\nComo mencionado acima, nesta primeira etapa foi feito o ajuste dos par\u00e2metros\n\nde sintonia dos controladores, sendo o principal ajuste feito no fator de supress\u00e3o das\n\nmanipuladas. Para as demais etapas foi mantido o melhor ajuste alcan\u00e7ado nesta etapa.\n\nNa tabela 9.2, apresentamos as principais caracter\u00edsticas dos dois controladores:\n\nControlador Modelo nominal Modelo planta Modelo de c\u00e1lculo\n\nda a\u00e7\u00e3o de controle\n\nQDMC Combina\u00e7\u00e3o dos modelos: 1\n\n2 3 4 5 FD\nFD (planta industrial) Modelo nominal\n\nMMPC Combina\u00e7\u00e3o dos modelos: 1\n\n2 3 4 5 FD\nFD (planta industrial) Modelos: 1 2 3 4 5\n\nTabela 9.2: Caracter\u00edsticas dos controladores utilizados\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 100\n\nNa figura 9.1.a apresentamos os dois controladores com a mesma sintonia\n\nconforme tabela 9.3. Este caso corresponde a um ponto dentro da regi\u00e3o mais freq\u00fcente\n\nde opera\u00e7\u00e3o. Podemos observar nessa figura que o controlador MMPC \u00e9 est\u00e1vel e o\n\nQDMC \u00e9 inst\u00e1vel, para um mesmo fator de supress\u00e3o das manipuladas. Note na figura,\n\nque o QDMC vai aumentando a sua amplitude de oscila\u00e7\u00e3o \u00e0 medida que o tempo passa,\n\nao passo que no MMPC rapidamente chegamos a uma condi\u00e7\u00e3o de estabilidade. Os\n\nn\u00fameros na abscissa de todos os gr\u00e1ficos representam o tempo decorrido em minutos.\n\nPAR\u00c2METRO QDMC MMPC\n\nPer\u00edodo de amostragem 1 min 1 min\n\nInstantes de c\u00e1lculo da\n\npredi\u00e7\u00e3o\n\n1 2 5 7 10 15 20 25 30 35 40 45 50\n\n60 70\n\n1 2 5 7 10 15 20 25 30 35 40 45\n\n50 60 70\n\nHorizonte de controle 2 2\n\nPeso das controladas 1 para as duas CV\u2019s 1 para as duas CV\u2019s\n\nSupress\u00e3o das manipuladas 0.001 para as duas MV\u2019s 0.001 para as duas MV\u2019s\n\nTabela 9.3 \u2013 Par\u00e2metros de sintonia dos controladores para figura 9.1.a\n\nFigura 9.1.a \u2013  Compara\u00e7\u00e3o QDMC( - - - ) x MMPC( \u2013\u2013\u2013 ) com mesma sintonia.\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 101\n\nNa figura 9.1.b apresentamos o QDMC com dois fatores de supress\u00e3o diferentes,\n\nveja sintonia na tabela 9.4, onde pode se observar que para o controlador se estabilizar \u00e9\n\nnecess\u00e1rio utilizar um fator de supress\u00e3o 500 vezes maior que aquele utilizado para o\n\nMMPC, no entanto este fator apesar de ser maior que o utilizado para o MMPC n\u00e3o\n\nchega a ser um valor t\u00e3o elevado.\n\nPAR\u00c2METRO QDMC QDMC\n\nPer\u00edodo de amostragem 1 min 1 min\n\nInstantes de c\u00e1lculo da\n\npredi\u00e7\u00e3o\n1 2 5 7 10 15 20 25 30 35 40 45 50 60 70\n\n1 2 5 7 10 15 20 25 30 35 40 45\n\n50 60 70\n\nHorizonte controle 2 2\n\nPeso das controladas 1 para as duas CV\u2019s 1 para as duas CV\u2019s\n\nSupress\u00e3o das\n\nmanipuladas\n0.001 para as duas MV\u2019s 0.5 para as duas MV\u2019s\n\nTabela 9.4 \u2013 Par\u00e2metros de sintonia dos controladores para figura 9.2.a\n\n Figura 9.1.b \u2013 QDMCsupr = 0.001(- - -) QDMCsupr = 0.5(\u2013\u2013\u2013)..\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 102\n\n9.1.2 \u2013QDMC e MMPC com sintonias ajustadas :\n\nNesta etapa foi avaliada a performance dos dois controladores frente a altera\u00e7\u00f5es\n\nnos set-points das vari\u00e1veis controladas e tamb\u00e9m varia\u00e7\u00f5es nas vari\u00e1veis perturbadoras.\n\nRepete-se aqui a estrutura dos controladores apresentada na tabela 9.2. Na tabela 9.5\n\napresentamos a sintonia utilizada para os controladores.\n\nPAR\u00c2METRO MMPC QDMC\n\nPer\u00edodo de Amostragem 1 min 1 min\n\nInstantes de c\u00e1lculo da\n\npredi\u00e7\u00e3o\n1 2 5 7 10 15 20 25 30 35 40 45 50 60 70\n\n1 2 5 7 10 15 20 25 30 35 40 45\n\n50 60 70\n\nHorizonte de controle 2 2\n\nPeso das controladas 1 para as duas CV\u2019s 1 para as duas CV\u2019s\n\nSupress\u00e3o das\n\nmanipuladas\n0.001 para as duas MV\u2019s 0.5 para as duas MV\u2019s\n\nTabela 9.5 \u2013 Sintonia dos controladores para item 9.1.2\n\nNa figura 9.1.c apresentamos o comportamento do controlador quando alteramos\n\no set-point do teor de C3\n- . Podemos observar que os dois controladores t\u00eam\n\npraticamente a mesma performance, ou seja, atingem o novo \u201cset-point\u201d proposto com a\n\nmesma facilidade.\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 103\n\n Figura 9.1.c \u2013 Altera\u00e7\u00e3o do \u201cset-point\u201d do teor de C3\n- QDMC( - - - )  MMPC( \u2013\u2013 ).\n\nNa figura 9.1.d apresentamos o comportamento do controlador quando alteramos\n\na faixa de controle da Ttopo em -1 \u00baC no instante 20. Aqui no entanto, a performance do\n\ncontrolador MMPC \u00e9 superior \u00e0 do QDMC, o que pode ser constatado atrav\u00e9s da\n\nobserva\u00e7\u00e3o do tempo necess\u00e1rio para que a vari\u00e1vel alcance a nova faixa de controle e o\n\nteor de C3\n-  retorne para o \u201cset-point\u201d. Com o MMPC o tempo de estabiliza\u00e7\u00e3o \u00e9 em\n\ntorno de 600 minutos ao passo que para o QDMC este tempo \u00e9 superior a 1000 minutos.\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 104\n\nFigura 9.1.d \u2013 Altera\u00e7\u00e3o da faixa de controle da Ttopo QDMC( - - - )  MMPC( \u2013\u2013 ).\n\nNa figura 9.1.e apresentamos a performance dos controladores quando aplicamos\n\nvaria\u00e7\u00f5es em degrau na vaz\u00e3o de carga para a coluna, que \u00e9 uma vari\u00e1vel perturbadora\n\ndo processo. O degrau aplicado foi de 50 m3/d no instante 30 min. Neste caso, podemos\n\nobservar que os dois controladores conseguem manter as vari\u00e1veis controladas no \u201cset-\n\npoint\u201d e faixa de controle respectivamente, sem grandes dificuldades.\n\nFigura 9.1.e \u2013 Aplica\u00e7\u00e3o de degrau na vaz\u00e3o de carga QDMC( - - - )  MMPC( \u2013\u2013 ).\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 105\n\nNa figura 9.1.f apresentamos a performance dos controladores quando aplicamos\n\nvaria\u00e7\u00f5es em degrau na temperatura do fluido de aquecimento para o refervedor, que \u00e9\n\numa vari\u00e1vel perturbadora do processo. O degrau aplicado foi de 5 \u00baC no instante 30\n\nmin. Neste caso, podemos observar que os dois controladores conseguem manter as\n\nvari\u00e1veis controladas no \u201cset-point\u201d e faixa de controle respectivamente, sem grandes\n\ndificuldades.\n\nFigura 9.1.f \u2013 Aplica\u00e7\u00e3o de degrau na TGOP QMDC( - - - )  MMPC( \u2013\u2013 ).\n\n9.1.3 \u2013 Altera\u00e7\u00e3o do modelo da planta:\n\nNesta etapa analisamos a performance dos controladores frente a altera\u00e7\u00f5es no\n\nmodelo utilizado para a planta. As avalia\u00e7\u00f5es consistiram em colocar o controlador em\n\nopera\u00e7\u00e3o tendo como modelo da planta aquele da planta industrial e no instante 20 min.\n\no modelo da planta era alterado para um novo modelo. Os modelos utilizados foram\n\ntodos aqueles levantados atrav\u00e9s do simulador, ou seja, 1, 2, 3, 4 e 5. Em todos os casos\n\nanalisados, sempre partimos com o teor de C3\n-  acima do \u201cset-point\u201d. A sintonia do\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 106\n\ncontrolador permaneceu a mesma do item anterior (veja tabela 9.5). Os casos analisados\n\ns\u00e3o apresentados nas figuras 9.1.g, 9.1.h, 9.1.i, 9.1.j e 9.1.k. A seguir analisamos a\n\nperformance para a altera\u00e7\u00e3o de cada modelo.\n\nNa figura 9.1.g apresentamos o comportamento dos controladores quando\n\nmudamos o modelo da planta para o modelo 1. Podemos observar que o MMPC\n\nconsegue levar o teor C3\n-  para o \u201cset-point\u201d apesar de levar um tempo maior do que\n\nquando n\u00e3o temos altera\u00e7\u00e3o no modelo da planta (veja figura 9.1.c). J\u00e1 o QDMC n\u00e3o\n\nconsegue levar o teor de C3\n-  para o \u201cset-point\u201d apresentando assim um \u201coff-set\u201d. O\n\nmesmo ocorre com a Ttopo.\n\nFigura 9.1.g \u2013 Mudan\u00e7a p/ modelo 1 no instante 20 min., QDMC( - - - )  MMPC( \u2013\u2013 ).\n\nNa figura 9.1.h apresentamos o comportamento dos controladores quando\n\nmudamos o modelo da planta para o modelo 2. Novamente aqui temos um\n\ncomportamento semelhante ao apresentado quando alteramos o modelo da planta para o\n\nmodelo 1. No entanto, o tempo de estabiliza\u00e7\u00e3o para o MMPC \u00e9 superior \u00e0quele quando\n\nn\u00e3o temos altera\u00e7\u00e3o do modelo da planta (figura 9.1c). O QDMC neste caso tamb\u00e9m\n\napresenta \u201coff-set\u201d para as vari\u00e1veis controladas.\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 107\n\nFigura  9.1.h - Mudan\u00e7a p/ modelo 2 no instante 20 min., QMDC( - - - )  MMPC( \u2013\u2013 ).\n\nNa figura 9.1.i apresentamos o comportamento dos controladores quando\n\nmudamos o modelo da planta para o modelo 3. Neste caso o comportamento do MMPC\n\n\u00e9 semelhante \u00e0quele apresentando na figura 9.1.c. No entanto, o QDMC apresenta um\n\nligeiro \u201coff-set\u201d para o teor de C3\n- o que n\u00e3o chega a comprometer sua performance.\n\nFigura 9.1.i - Mudan\u00e7a para modelo 3 no instante 20 min., QMDC( - - - )  MMPC( \u2013\u2013 ).\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 108\n\nNa figura 9.1.j apresentamos o comportamento dos controladores quando\n\nmudamos o modelo da planta para o modelo 4. Aqui no entanto, os dois controladores\n\napresentaram \u201coff-set\u201d para o teor C3\n-, sendo que para o MMPC o \u201coff-set\u201d \u00e9 menor do\n\nque aquele apresentado pelo QDMC. Para a Ttopo somente o QDMC apresentou \u201coff-\n\nset\u201d sendo que o MMPC levou a Ttopo para seu limite m\u00e1ximo.\n\nFigura 9.1.j - Mudan\u00e7a para modelo 4 no instante 20min., QDMC( - - - )  MMPC( \u2013\u2013 ).\n\nNa figura 9.1.k apresentamos o comportamento dos controladores quando\n\nmudamos o modelo da planta para o modelo 5. Temos neste caso um comportamento\n\nsemelhante ao apresentado quando alteramos o modelo da planta para o modelo 2, ou\n\nseja, o MMPC consegue levar o teor de C3\n- para o \u201cset-point\u201d e a Ttopo para seu limite\n\nsuperior, o que n\u00e3o ocorre com o QDMC, que apresenta \u201coff-set\u201d para as duas vari\u00e1veis\n\ncontroladas.\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 109\n\n Figura 9.1.k - Mudan\u00e7a modelo p/ 5 no instante 20 min., QDMC( - - - )  MMPC( \u2013\u2013 ).\n\nDe forma geral, podemos constatar que o QDMC necessita de fatores de\n\nsupress\u00e3o superiores ao MMPC para estabilizar o sistema de controle. Ap\u00f3s\n\nsintonizado, o QDMC apresentou, em alguns casos, comportamento semelhante ao\n\nMMPC (figuras 9.1.c, 9.1.e, 9.1.f) quando o modelo da planta n\u00e3o se alterava. No\n\nentanto, quando tivemos altera\u00e7\u00e3o no modelo da planta, o que no processo real equivale\n\na termos altera\u00e7\u00e3o do ponto de opera\u00e7\u00e3o, o QDMC se mostrou ineficaz em controlar o\n\nprocesso, apresentando \u201coff-set\u201d na maioria das situa\u00e7\u00f5es simuladas (figuras 9.1.g,\n\n9.1.h, 9.1.i, 9.1.k). Assim, podemos concluir que o QDMC n\u00e3o seria adequado para\n\ncontrole do nosso processo, ao passo que o MMPC se mostrou mais adequado,\n\napresentando melhor performance que o QDMC.\n\nTendo em vista que o controlador MMPC se mostrou mais eficiente que o\n\nQDMC, o mesmo foi implementado para controle da planta industrial. No pr\u00f3ximo item\n\napresentamos a performance do MMPC em opera\u00e7\u00e3o na unidade industrial.\n\n9.2 \u2013 Implanta\u00e7\u00e3o do controlador MMPC na planta industrial\n\nO controlador MMPC entrou em opera\u00e7\u00e3o na planta industrial no dia 14 de\n\nfevereiro de 2001, e tem operado continuamente demonstrando uma grande aceita\u00e7\u00e3o\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 110\n\npor parte dos operadores da unidade. Para implanta\u00e7\u00e3o do controlador na planta\n\nindustrial foi utilizado o SICON ( Sistema Integrado de Controle da Petrobras ). Este\n\nsistema \u00e9 descrito no item 9.2.1. As subrotinas do SICON tiveram que ser adaptadas\n\npara permitir a montagem do controlador na forma param\u00e9trica apresentada no item\n\n8.2.1, principalmente na parte de leitura dos modelos. Tamb\u00e9m foram implementadas\n\nnovas subrotinas no sistema para permitir o c\u00e1lculo das a\u00e7\u00f5es de controle atrav\u00e9s do\n\nSQP.\n\nPara verifica\u00e7\u00e3o da performance do controlador em opera\u00e7\u00e3o na planta industrial,\n\nforam coletados dados com o controlador em opera\u00e7\u00e3o sujeito \u00e0s varia\u00e7\u00f5es normais da\n\nplanta tais como: vari\u00e1veis perturbadoras medidas (vaz\u00e3o de carga e temperatura do\n\nflu\u00eddo de aquecimento) e vari\u00e1veis perturbadoras n\u00e3o medidas (composi\u00e7\u00e3o da carga,\n\nvaria\u00e7\u00f5es ambientais etc.). Tamb\u00e9m foram realizados testes para verifica\u00e7\u00e3o da opera\u00e7\u00e3o\n\ndo controlador frente \u00e0 altera\u00e7\u00f5es no  \u201cset-point\u201d das vari\u00e1veis controladas.\n\nAs figuras apresentadas abaixo foram obtidas atrav\u00e9s da interface gr\u00e1fica do PITM\n\n(Plant Information) da Oil System Inc, que \u00e9 o sistema de gerenciamento de dados de\n\nprocesso existente na RPBC. Este sistema consiste de uma interface de leitura dos dados\n\ndo SDCD enviando-os para um servidor onde fica a base de dados. Esta base de dados\n\npode ser acessada para gerar gr\u00e1ficos atrav\u00e9s da interface gr\u00e1fica do pr\u00f3prio programa e\n\ntamb\u00e9m atrav\u00e9s da planilha eletr\u00f4nica ExcelTM da Microsoft, permitindo uma an\u00e1lise\n\ndetalhada de todas as vari\u00e1veis operacionais do processo.\n\nPara um melhor entendimento das figuras apresentaremos a seguir uma descri\u00e7\u00e3o\n\nde cada item constante das mesmas:\n\n\u00fc Geral para todas as figuras:\n\n\u2022 campo superior esquerdo: \u00e9 uma descri\u00e7\u00e3o da vari\u00e1vel\n\n\u2022 o n\u00famero abaixo dos \u201ctag\u2019s\u201d \u00e9 o valor da vari\u00e1vel de processo (PV) no\n\ncaso das vari\u00e1veis controladas e perturbadoras, e o \u201cset-point\u201d (SV) no\n\ncaso das manipuladas. Este \u00e9 o valor real lido do SDCD e se refere ao\n\ninstante de tempo apresentado no lado direito inferior da figura.\n\n\u2022 parte inferior: s\u00e3o apresentados os instantes inicial e final do per\u00edodo de\n\ntempo em que a vari\u00e1vel \u00e9 observada.\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 111\n\n\u2022 a escala que aparece do lado esquerdo dos gr\u00e1ficos representa a faixa de\n\nopera\u00e7\u00e3o atual das vari\u00e1veis.\n\n\u00fc Vari\u00e1vel controlada teor de C3\n- :\n\n\u2022 AI2430 \u00e9 o \u201ctag\u201d da vari\u00e1vel de processo (PV).\n\n\u2022 AI2430MN \u00e9 o \u201ctag\u201d do limite m\u00ednimo da vari\u00e1vel para controle.\n\n\u2022 AI2430MX \u00e9 o \u201ctag\u201d do limite m\u00e1ximo da vari\u00e1vel para controle.\n\n\u00fc Vari\u00e1vel controlada Ttopo:\n\n\u2022 TC2483 \u00e9 o \u201ctag\u201d da vari\u00e1vel de processo (PV).\n\n\u2022 TC2483MN \u00e9 o \u201ctag\u201d do limite m\u00ednimo da vari\u00e1vel para controle.\n\n\u2022 TC2483MX \u00e9 o \u201ctag\u201d do limite m\u00e1ximo da vari\u00e1vel para controle.\n\n\u00fc Vari\u00e1vel manipulada Vrefluxo:\n\n\u2022 FC2454SV \u00e9 o \u201ctag\u201d do \u201cset-point\u201d (SV) da vari\u00e1vel.\n\n\u2022 FC2454SMN \u00e9 o \u201ctag\u201d do limite m\u00ednimo do \u201cset-point\u201d  (SV) para\n\ncontrole.\n\n\u2022 FC2454SMX \u00e9 o \u201ctag\u201d do limite m\u00e1ximo do \u201cset-point\u201d  (SV) para\n\ncontrole.\n\n\u2022 FC2454MD \u00e9 o modo da vari\u00e1vel manipulada no SDCD. Informa se a\n\nvari\u00e1vel est\u00e1 liberada para ser utilizada pelo controle supervis\u00f3rio. A\n\nop\u00e7\u00e3o RCAS (cascata remota) indica que o \u201cset-point\u201d est\u00e1 sendo\n\nfornecido pelo controle supervis\u00f3rio.\n\n\u00fc Vari\u00e1vel manipulada VGOP:\n\n\u2022 FC24151SV \u00e9 o \u201ctag\u201d do \u201cset-point\u201d (SV) da vari\u00e1vel.\n\n\u2022 FC24151SMN \u00e9 o \u201ctag\u201d do limite m\u00ednimo do \u201cset-point\u201d  (SV) para\n\ncontrole.\n\n\u2022 FC24151SMX \u00e9 o \u201ctag\u201d do limite m\u00e1ximo do \u201cset-point\u201d  (SV) para\n\ncontrole.\n\n\u2022 FC24151MD \u00e9 o modo da vari\u00e1vel manipulada no SDCD. Informa se a\n\nvari\u00e1vel est\u00e1 liberada para ser utilizada pelo controle supervis\u00f3rio. A\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 112\n\nop\u00e7\u00e3o RCAS (cascata remota) indica que o \u201cset-point\u201d est\u00e1 sendo\n\nfornecido pelo controle supervis\u00f3rio.\n\n\u00fc Vari\u00e1veis perturbadoras (Vcarga e TGOP):\n\n\u2022 FC2452SV ou TI24154 s\u00e3o os  \u201ctags\u201d das vari\u00e1veis perturbadoras\n\nmedidas, que s\u00e3o utilizadas no controle.\n\nNa tabela 9.6 apresentamos os par\u00e2metros de sintonia utilizados no controlador\n\nutilizado na planta industrial.\n\nPAR\u00c2METRO VALOR\n\nPer\u00edodo de amostragem 1 min\n\nInstantes de c\u00e1lculo da predi\u00e7\u00e3o 1 2 5 7 10 15 20 25 30 35 40 45 50 60 70\n\nHorizonte de controle 2\n\nPeso das controladas 1 para as duas CV\u2019s\n\nSupress\u00e3o de movimentos 0.01 para as duas MV\u2019s\n\nModelo nominal Combina\u00e7\u00e3o  dos modelos: 1  2  3  4  5 FD\n\nModelos para c\u00e1lculo da a\u00e7\u00e3o de\n\ncontrole\n1  2  3  4  5\n\nTabela 9.6 \u2013 Par\u00e2metros de sintonia do controlador industrial\n\nA seguir analisaremos os gr\u00e1ficos referentes aos casos estudados com o\n\ncontrolador em opera\u00e7\u00e3o na planta industrial.\n\nO primeiro conjunto de gr\u00e1ficos (figuras 9.2.a1 a 9.2.a3) representa um per\u00edodo\n\nde opera\u00e7\u00e3o do controlador onde n\u00e3o temos altera\u00e7\u00e3o do \u201cset-point\u201d das vari\u00e1veis\n\ncontroladas. O teor de C3\n- \u00e9 controlado no \u201cset-point\u201d, (AI2430MN = AI2430MX = 0.9\n\n%vol.), enquanto que a Ttopo \u00e9 controlada dentro de uma faixa (TC2483MN=49\u00baC e\n\nTC2483MX=50\u00baC), as vari\u00e1veis manipuladas t\u00eam seus limites bastante amplos (vaz\u00e3o\n\nde refluxo de 2000 a 4300 m3/d, vaz\u00e3o de GOP de 500 a 2300 m3/d). Estes limites das\n\nvari\u00e1veis manipuladas fazem com que o controlador tenha ampla liberdade para atuar no\n\ncontrole do processo. Podemos observar nessas figuras que o controlador consegue\n\nmanter as vari\u00e1veis controladas nas suas especifica\u00e7\u00f5es (\u201cset-point\u201d para o C3\n- e faixa de\n\ncontrole para a Ttopo), mesmo quando temos varia\u00e7\u00f5es significativas nos valores das\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 113\n\nvari\u00e1veis perturbadoras. Veja que em alguns momentos a vaz\u00e3o de carga (Fig. 9.2.a3)\n\nchega a variar 250 m3/d em um curto intervalo de tempo.\n\nFigura 9.2.a1 \u2013 Vari\u00e1veis controladas em opera\u00e7\u00e3o t\u00edpica.\n\nFigura 9.2.a2 \u2013 Vari\u00e1veis manipuladas em opera\u00e7\u00e3o t\u00edpica.\n\nFigura 9.2.a3 \u2013 Vari\u00e1veis perturbadoras em opera\u00e7\u00e3o t\u00edpica.\n\nNo pr\u00f3ximo conjunto de gr\u00e1ficos (figuras 9.2.b1 a 9.2.b3) apresentamos dados\n\nrelativos a um teste (teste 1), realizado para observar a performance do controlador\n\nfrente a altera\u00e7\u00f5es no \u201cset-point\u201d do teor de C3\n- no butano. O degrau aplicado foi de 0.3\n\n%vol., passando de 1.2 para 1.5 %vol.. Podemos observar que o novo patamar de \u201cset-\n\npoint\u201d \u00e9 atingido em aproximadamente 30 minutos. Observe que n\u00e3o ocorre viola\u00e7\u00e3o da\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 114\n\nfaixa de controle da temperatura de topo mesmo com severas varia\u00e7\u00f5es nas vari\u00e1veis\n\nperturbadoras como a vaz\u00e3o de carga que variou quase 200 m3/d durante o per\u00edodo de\n\nteste.\n\nFigura 9.2.b1 \u2013 Vari\u00e1veis controladas teste 1.\n\nFigura 9.2.b2 \u2013 Vari\u00e1veis manipuladas teste 1.\n\nFigura 9.2.b3 \u2013 Vari\u00e1veis perturbadoras teste 1.\n\nO segundo teste realizado na planta (teste 2), \u00e9 descrito pelas figuras 9.2.c1 a\n\n9.2.c3. Ele consistiu novamente na altera\u00e7\u00e3o do \u201cset-point\u201d do teor de C3\n- no butano. O\n\ndegrau aplicado foi de 0.3 %vol., s\u00f3 que desta vez no sentido contr\u00e1rio ao anterior,\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 115\n\npassando o \u201cset-point\u201d 1.2 %vol. para 0.9 %vol. Observe que quase simultaneamente \u00e0\n\naplica\u00e7\u00e3o do degrau no \u201cset-point\u201d tivemos uma grande varia\u00e7\u00e3o na vaz\u00e3o de carga da\n\ncoluna sendo que a mesma saiu de um patamar de 2050 m3/d baixou para 1800 m3/d, e\n\ndepois foi elevada para 2500 m3/d e finalmente retornou para o patamar de 2000 m3/d.\n\nEstas varia\u00e7\u00f5es ocorreram durante um per\u00edodo de aproximadamente 4 horas. Observe\n\nque tivemos tamb\u00e9m uma altera\u00e7\u00e3o no patamar da temperatura do fluido de\n\naquecimento passando a mesma de 259\u00baC para em torno de 261\u00baC. Veja que durante a\n\nocorr\u00eancia dessas perturba\u00e7\u00f5es o teor de C3\n- oscilou entre um m\u00e1ximo a 1.6 %vol. e um\n\nm\u00ednimo de 0.7 %vol.. A Ttopo violou 1\u00baC acima do limite m\u00e1ximo de controle. Observe\n\nque as vari\u00e1veis manipuladas variaram bastante para manter as vari\u00e1veis controladas\n\ndentro de suas especifica\u00e7\u00f5es durante a ocorr\u00eancia das perturba\u00e7\u00f5es, permanecendo o\n\ntempo todo ligadas (RCAS).\n\nFigura 9.2.c1 \u2013 Vari\u00e1veis controladas teste 2.\n\nFigura 9.2.c2 \u2013 Vari\u00e1veis manipuladas teste 2.\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 116\n\nFigura 9.2.c3 \u2013 Vari\u00e1veis perturbadoras teste 2.\n\nO terceiro teste (teste3), corresponde \u00e0s figuras 9.2.d1 a 9.2.d3. Ele consistiu na\n\naplica\u00e7\u00e3o de um degrau nos limites da temperatura de topo (Ttopo), permanecendo o\n\n\u201cset-point\u201d do C3\n- no mesmo valor. O degrau aplicado foi de 0.5\u00baC nos limites da Ttopo,\n\npassando o m\u00e1ximo de 50\u00baC para 49.5\u00baC e o m\u00ednimo de 49\u00baC para 48.5\u00baC. Observe que\n\no controlador em poucos minutos leva a Ttopo para dentro na nova faixa permanecendo\n\no C3\n- no \u201cset-point\u201d especificado. Veja que o patamar da vaz\u00e3o de refluxo muda da faixa\n\nde 2800 m3/d  para um patamar de 2950 m3/d sendo que a vaz\u00e3o de fluido de\n\naquecimento sofre um ligeiro acr\u00e9scimo. Ap\u00f3s a estabiliza\u00e7\u00e3o inicial da temperatura na\n\nnova faixa de controle, observamos que as vari\u00e1veis manipuladas mudam de patamar,\n\npassando a vaz\u00e3o de refluxo de 2950 m3/d para 3100 m3/d e a vaz\u00e3o de fluido de\n\naquecimento de 1900 m3/d para 2050 m3/d. Esta mudan\u00e7a de patamar provavelmente\n\nocorreu devido \u00e0 altera\u00e7\u00e3o principalmente nas vari\u00e1veis perturbadoras n\u00e3o medidas\n\nsendo a mais importante delas a qualidade da carga para a coluna. As vari\u00e1veis\n\nperturbadoras medidas n\u00e3o tiveram altera\u00e7\u00f5es significativas no per\u00edodo. Esta mudan\u00e7a\n\nno patamar das vari\u00e1veis manipuladas foi necess\u00e1rio para que as vari\u00e1veis controladas\n\nmantivessem suas especifica\u00e7\u00f5es.\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 117\n\nFigura 9.2.d1 \u2013 Vari\u00e1veis controladas teste 3.\n\nFigura 9.2.d2 \u2013 Vari\u00e1veis manipuladas teste 3.\n\nFigura 9.2.d3 \u2013 Vari\u00e1veis perturbadoras teste 3.\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 118\n\n9.2.1 - SICON - Sistema Integrado de Controle ( da Petrobras )\n\nPara que possamos implementar o controlador apresentado nos itens anteriores\n\nna planta industrial \u00e9 necess\u00e1rio termos um conjunto integrado de softwares e\n\ncomputadores para execu\u00e7\u00e3o dos algoritmos de forma segura. No caso da Petrobras este\n\nconjunto pode ser representado esquematicamente atrav\u00e9s da figura 9.2.e onde temos\n\ntr\u00eas interfaces descritas a seguir.\n\nFigura 9.2.e - Interfaces de controle\n\n1 -  Interface de opera\u00e7\u00e3o:  esta interface \u00e9 constitu\u00edda pelas telas gr\u00e1fica do SDCD\n\n(Sistema Digital de Controle Distribu\u00eddo), onde os operadores atuam para colocar/retirar\n\no programa de opera\u00e7\u00e3o, alterar os limites de m\u00e1ximo/m\u00ednimo das vari\u00e1veis quando for\n\nnecess\u00e1rio, colocar/retirar vari\u00e1veis do controle e monitorar o comportamento do\n\nprograma e das vari\u00e1veis.\n\n2 - Interface leitura de dados: esta interface \u00e9 constitu\u00edda pelo programa PI (Plant\n\nInformation? da Oil Systems) sendo a base de dados utilizada para leitura dos valores\n\ndas vari\u00e1veis utilizadas pelo programa de controle.\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 119\n\n3 - Interface de engenharia: esta interface \u00e9 constitu\u00edda de duas plataformas, sendo uma\n\nplataforma de engenharia e um computador de processo. A plataforma de engenharia \u00e9\n\nconstitu\u00edda basicamente por um computador PC com Windows, comunicando-se em\n\nrede com outros computadores. Nesta plataforma s\u00e3o executadas v\u00e1rias aplica\u00e7\u00f5es que\n\npermitem ao engenheiro de controle realizar as atividades de constru\u00e7\u00e3o, sintonia,\n\ncomissionamento e monitoramento das vari\u00e1veis dos controladores atrav\u00e9s de uma\n\ninterface gr\u00e1fica adequada. O ambiente do Computador de Processo prov\u00ea todos os\n\nservi\u00e7os necess\u00e1rios \u00e0 execu\u00e7\u00e3o de aplica\u00e7\u00f5es de controle, como por exemplo, a\n\naquisi\u00e7\u00e3o de valores de processo do SDCD, valida\u00e7\u00e3o destes valores para utiliza\u00e7\u00e3o pelo\n\ncontrolador, a execu\u00e7\u00e3o dos algoritmos de controle, o envio das a\u00e7\u00f5es de controle de\n\nvolta ao SDCD e a comunica\u00e7\u00e3o com a plataforma de engenharia. \u00c9 importante notar\n\nque as aplica\u00e7\u00f5es de controle s\u00e3o executadas nesta plataforma e n\u00e3o dependem da\n\nplataforma de engenharia. A partir desta plataforma \u00e9 feita a escrita dos valores de\n\ncontrole para o SDCD atrav\u00e9s da interface de comunica\u00e7\u00e3o Centap-plus? da Yokogawa.\n\nNas figuras 9.2.f a 9.2.i, apresentamos as telas de configura\u00e7\u00e3o relativas \u00e0\n\ninterface de engenharia, nestas telas temos os principais par\u00e2metros de configura\u00e7\u00e3o e\n\nsintonia do controlador e das vari\u00e1veis manipuladas, controladas e perturbadoras.\n\nBasicamente estas telas de configura\u00e7\u00e3o apresentam os seguintes campos de informa\u00e7\u00e3o:\n\n\u00fc Descri\u00e7\u00e3o: apresenta uma descri\u00e7\u00e3o do controlador ou da vari\u00e1vel correspondente.\n\n\u00fc Tags de entrada: s\u00e3o os valores lidos do SDCD ou fixados em um determinado\n\nvalor.\n\n\u00fc Tags de sa\u00edda: s\u00e3o valores que ser\u00e3o enviados para o SDCD ou PI.\n\n\u00fc Entradas: s\u00e3o par\u00e2metros de configura\u00e7\u00e3o do controlador ou das vari\u00e1veis que s\u00e3o\n\npreenchidos pelo engenheiro de controle.\n\n\u00fc Sa\u00eddas: s\u00e3o informa\u00e7\u00f5es fornecidas pelo programa a respeito da performance do\n\ncontrolador ou vari\u00e1vel.\n\n\u00fc Faixa de validade: s\u00e3o os limites aceit\u00e1veis para as vari\u00e1veis, fora destes limites a\n\nvari\u00e1vel ser\u00e1 desligada automaticamente pelo controlador.\n\n\u00fc Range da vari\u00e1vel: normalmente s\u00e3o os limites m\u00ednimo e m\u00e1ximo de leitura das\n\nvari\u00e1veis.\n\n\u00fc Auxiliares: s\u00e3o fatores de configura\u00e7\u00e3o adicionais que permitem a possibilidade de\n\ncustomiza\u00e7\u00e3o diferenciadas para cada controlador ou vari\u00e1vel.\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 120\n\nFigura 9.2.f \u2013 Tela de configura\u00e7\u00e3o/sintonia do controlador\n\nFigura 9.2.g \u2013 Tela de configura\u00e7\u00e3o/sintonia de vari\u00e1vel controlada\n\n\n\nCap\u00edtulo 9 \u2013 Aplica\u00e7\u00e3o do MPC \u00e0 coluna depropanizadora 121\n\nFigura 9.2.h - Tela de configura\u00e7\u00e3o/sintonia de vari\u00e1vel manipulada\n\nFigura 9.2.i - Tela de configura\u00e7\u00e3o de vari\u00e1vel perturbadora\n\n\n\n122\n\n10\n\nCONCLUS\u00d5ES E SUGEST\u00d5ES\n10.1 \u2013 Conclus\u00f5es\n\nEste trabalho \u00e9 a primeira aplica\u00e7\u00e3o industrial de um controlador preditivo\n\nbaseada no modelo de vari\u00e1veis de estado montado a partir de resposta ao degrau\n\nanal\u00edtica (ROSSMPC). As vantagens desse enfoque s\u00e3o:\n\n\u00fc Controlar sistemas com din\u00e2micas muito lentas, sem necessidade de\n\nmemorizar vetores e matrizes de grandes dimens\u00f5es.\n\n\u00fc Controlar sistemas com din\u00e2micas lentas e r\u00e1pidas no mesmo controlador;\n\n\u00fc Prever as vari\u00e1veis controladas em instantes de tempo diferentes para cada\n\numa delas;\n\n\u00fc Controlar sistemas de grandes dimens\u00f5es, ou seja, grande n\u00famero de\n\nvari\u00e1veis manipuladas e controladas. Isto possibilita controlar unidades de\n\nprocesso inteiras, sem grande esfor\u00e7o computacional.\n\n\u00fc Fazer adapta\u00e7\u00e3o dos ganhos e at\u00e9 mesmo dos par\u00e2metros das din\u00e2micas sem\n\ngrandes dificuldades.\n\nTamb\u00e9m nesse trabalho temos a descri\u00e7\u00e3o da primeira aplica\u00e7\u00e3o de um\n\ncontrolador baseado em m\u00faltiplos modelos onde o problema de otimiza\u00e7\u00e3o recai em\n\num problema tipo min-max., ou seja, o controlador escolhe uma a\u00e7\u00e3o de controle que\n\nminimiza o erro para o pior modelo. Alguns autores argumentam que esse controlador\n\nseria demasiadamente conservativo no caso de modelos bastante diferentes. Este \u00e9 o\n\ncaso da aplica\u00e7\u00e3o aqui estudada onde os modelos t\u00eam caracter\u00edsticas bastante\n\ndiferentes. Por exemplo, o ganho do teor de C3\n- em rela\u00e7\u00e3o \u00e0 vaz\u00e3o de refluxo para o\n\nmodelo 1 \u00e9 de 4.498E-4 e para o modelo 3 \u00e9 de 1.679E-2, portanto 37 vezes maior.\n\nAssim, esperava-se um comportamento n\u00e3o muito eficiente do controlador\n\nMMPC para a coluna depropanizadora. Entretanto, os resultados mostram que a\n\nperformance, em termos de velocidade de resposta e tempo de estabiliza\u00e7\u00e3o , \u00e9\n\nperfeitamente compat\u00edvel com as exig\u00eancias pr\u00e1ticas. Portanto, conseguiu-se um\n\ncontrolador com uma faixa de estabilidade bastante ampla e uma performance\n\nadequada.\n\n\n\nCap\u00edtulo 10 - Conclus\u00f5es e sugest\u00f5es 123\n\nEste controlador exige um esfor\u00e7o na sintonia menor do que o QDMC e esta\n\nsintonia \u00e9 mais adequada numa regi\u00e3o de opera\u00e7\u00e3o mais ampla do que a correspondente\n\ndo QDMC. Embora o esfor\u00e7o computacional do MMPC seja maior que para o QDMC\n\nessa desvantagem n\u00e3o \u00e9 importante para o caso estudado. No computador de controle de\n\nprocesso (Alpha 1000 server da Digital de 400 mhz com 512 mb de mem\u00f3ria ram) o\n\ntempo de computa\u00e7\u00e3o do MMPC n\u00e3o chega a 1 segundo, portanto n\u00e3o significativo em\n\ncompara\u00e7\u00e3o com o per\u00edodo de amostragem.\n\nTendo em vista estes resultados, espera-se que a utiliza\u00e7\u00e3o do MMPC se torne\n\num padr\u00e3o dentro da Petrobras.\n\nOutro aspecto importante do trabalho foi a utiliza\u00e7\u00e3o do simulador de processos\n\npara levantamento do conjunto de modelos. Esta utiliza\u00e7\u00e3o se mostrou bastante\n\ninteressante, pois atrav\u00e9s dela temos uma redu\u00e7\u00e3o da necessidade de realiza\u00e7\u00e3o de testes\n\nna planta industrial, o que seria demorado e dispendioso. Al\u00e9m, de podermos pesquisar\n\numa regi\u00e3o mais ampla do processo, o que dificilmente seria conseguido na planta\n\nindustrial.\n\n10.2 \u2013 Sugest\u00f5es\n\nEm fun\u00e7\u00e3o de uma s\u00e9rie de dificuldades e restri\u00e7\u00f5es do estudo, podemos sugerir\n\nalguns pontos para trabalhos futuros.\n\nOs componentes do conjunto de modelos e o modelo nominal para predi\u00e7\u00e3o\n\nforam escolhidos procurando abranger os diferentes pontos de opera\u00e7\u00e3o do sistema e em\n\nfun\u00e7\u00e3o dos determinantes das matrizes de ganhos nestes pontos. Estes crit\u00e9rios s\u00e3o\n\nnecess\u00e1rios, mas n\u00e3o suficientes, sendo que poder\u00edamos incluir os crit\u00e9rios de\n\nestabilidade dos controladores na sele\u00e7\u00e3o dos modelos.\n\nNeste estudo n\u00e3o inclu\u00edmos a an\u00e1lise de estabilidade do sistema no projeto de\n\ncontrole. Sugerimos ent\u00e3o que se inclua a an\u00e1lise de estabilidade no projeto de controle,\n\nat\u00e9 mesmo estudar algum algoritmo que otimize os par\u00e2metros do controlador segundo\n\nos crit\u00e9rios de estabilidade.\n\n\n\nCap\u00edtulo 10 - Conclus\u00f5es e sugest\u00f5es 124\n\nTamb\u00e9m pode-se estudar alguma forma eficiente de incluir os crit\u00e9rios de\n\nestabilidade no c\u00e1lculo da a\u00e7\u00e3o de controle. Isto poderia ser feito incluindo os crit\u00e9rios\n\nde estabilidade de Lyapunov no problema de controle.\n\nNo sentido de aumentar a estabilidade do controle, pode-se estabelecer algum\n\ncrit\u00e9rio de normaliza\u00e7\u00e3o das vari\u00e1veis manipuladas, perturba\u00e7\u00f5es, controladas e modelos\n\nde forma a condicionar adequadamente o sistema de controle, desacoplando-o da melhor\n\nforma poss\u00edvel.\n\nEm rela\u00e7\u00e3o ao sistema estudado, o ideal seria que control\u00e1ssemos efetivamente a\n\ncontamina\u00e7\u00e3o de componentes pesados no topo da coluna atrav\u00e9s da medi\u00e7\u00e3o do teor de\n\nC4\n+. Para isto seria necess\u00e1rio desenvolver uma infer\u00eancia com qualidade superior ao da\n\nexistente atualmente, que se baseia em correla\u00e7\u00e3o multilinear.\n\nOutro aspecto que poderia ser desenvolvido seria a implementa\u00e7\u00e3o de uma\n\ncamada de otimiza\u00e7\u00e3o no controlador, isto permitiria um ganho em economia de\n\nenergia, o que em uma coluna de fracionamento representa um grande incentivo, j\u00e1 que\n\no processo de separa\u00e7\u00e3o se baseia  na introdu\u00e7\u00e3o de energia para permitir a separa\u00e7\u00e3o\n\ndos produtos.\n\n\n\n125\n\nREFER\u00caNCIAS BIBLIOGR\u00c1FICAS\n\nALMEIDA, E. 1999. Controle preditivo multimodelos de uma torre debutanizadora.\n\n200p. Disserta\u00e7\u00e3o (Mestrado) - Escola Polit\u00e9cnica da Universidade de S\u00e3o Paulo.\n\nALMEIDA, E.; RODRIGUES, M. A.; ODLOAK D. (2000) Robust predictive control of\n\na gasoline debutanizer column. Brazilian Journal of Chemical Engineering, v.17,\n\nn\u00ba 04-07, p.967-977\n\nALMEIDA, E.; ZANIN, A. C.; ODLOAK, D. (1996). Advanced control and\n\noptimization of a crude vacuum unit. XI Congresso Brasileiro de Autom\u00e1tica, - I\n\nSimp\u00f3sio de Autom\u00e1tica Aplicada, Anais p.23-28, S\u00e3o Paulo\n\nASTM-D86 (1970). Part 17, Petroleum Products-Fuels, Solvents, Burner Fuel Oils,\n\nLubrificating Oils, Cutting Oils, Lubrificating Greases, Hydraulic Fluids. American\n\nSoc. For Testing &amp; Materials, Philadelphia, PA, p.8-20.\n\nBOYD, S.; GHAOUI, L. E.; FERON, E.; BALAKRISHNAN, V. (1994). Linear\n\nMatrix Inequalities in System and Control Theory. SIAM, Philadelphia\n\nCLARKE, D. W.; MOHTADI, C.; TUFFS, P.S. (1987). Generalized predictive control\u2013\n\nPart I: the basic algorithm. Automatica, v.23, n.2, p.137-148\n\nCLARKE, D. W.; MOHTADI, C.; TUFFS, P.S. (1987). Generalized predictive control\u2013\n\nPart II: extensions and interpretations. Automatica, v.23, n.2, p.149-160\n\nCUTLER, C. R.; RAMAKER, B. L. (1979). Dynamic matrix control \u2013 a computer\n\ncontrol algoritm. AIChE 86th National Meeting, Houton, TX\n\nGARCIA, C. E.; MORARI, M. (1982). Internal model control \u2013 Part 1: A unifying\n\nreview and some new results. Ind. Eng. Chem. Proc. Des. Dev., v.21, p.308-323\n\nGARCIA, C. E.; MORARI, M. (1985). Internal model control \u2013 Part 2: Design\n\nprocedure for multivariable systems. Ind. Eng. Chem. Proc. Des. Dev., v.24, p.472-\n\n484\n\nGARCIA, C. E.; MORARI, M. (1985). Internal model control \u2013 Part 3: Multivariable\n\ncontrol law computation and tuning guidelines. Ind. Eng. Chem. Proc. Des. Dev.,\n\nv.24, p.484-494\n\nGARCIA, C. E.; MORSHEDI, A. M. (1986). Quadratic programing solution of dynamic\n\nmatrix control (QDMC). Chem. Engng Commun., v.46, p.73-87\n\n\n\nRefer\u00eancias bibliogr\u00e1ficas 126\n\nGOUV\u00caA, M. T.; ODLOAK, D. (1997). ROSSMPC: A new way of representing and\n\nanalysing the predictive controllers. Trans IchemE, v.75, Part A, p.693-708\n\nHENSON, M. A. (1998). Nonlinear model predictive control: Current status and fucture\n\ndirections. Computers Chem. Engng, v.23, n.2, p.187-202\n\nHOYD, M.; LEE, J. H.; MORARI, M. (1993). Truncated step response model predictive\n\ncontrol. Journal of Process Control, v.3, n.2, p.67-73\n\nKOTHARE, K. V.; BALAKRISHNAN, V.; MORARI, M. (1996). Robust constrained\n\nmodel predictive control using linear matrix inequalities. Automatica, v.30, n.10,\n\np.1361-1379\n\nLEE, J. H.; MORARI, M.; GARCIA, C. E. (1994). State space interpretation of model\n\npredictive control, Automatica, v.30, n.4, p.707-717\n\nLI, S.; LIM, K. Y.; FISHER, D. G. (1989). A state space formulation for model\n\npredictive control, AIChE Journal, v.35, n.2, p.241-249\n\nLJUNG, L. (1987). System Identification: Theory for the user. Prentice-Hall,\n\nEnglewood Cliffs, NJ\n\nLUNDSTR\u00d6M, P.; LEE, J. H.; MORARI, M.; SKOGESTAD, S. (1995). Limitations of\n\ndynamic matrix control. Computers Chem. Engng, v.19, n.4, p.409-421\n\nMAGALH\u00c3ES, M. V. O.; ODLOAK, D. (1995). Multivariable quality control of a\n\ncrude oil frationator. DYDORD\u201995, IFAC Conference, Dynanics and Control of\n\nChemical Reactors, Distillation Columns and Batch Processes, p.583-488,\n\nCopenhagen\n\nMIQUEL, J.; CASTELLS, F.(1993). Easy characterization of petroleum fractions,\n\nHydroc. Processing, December 1993, p.101-105\n\nMORARI, M.; DOYLE, J. (1986). A unifying frameworks for control system design\n\nunder uncertainty and its implications for chemical process control. Proceedings of\n\nChemical Process Control - CPC III, p.5-52\n\nMORARI, M.; LEE, J. H. (1991). Model predictive control: The good, the bad, and the\n\nugly. Proceedings of Chemical Process Control - CPC IV, San Padre Island, TX,\n\np.410-444\n\nMORARI, M.; LEE, J. H. (1999). Model predictive control: past, present and future.\n\nComputers Chem. Engng, v.23, p.667-682\n\n\n\nRefer\u00eancias bibliogr\u00e1ficas 127\n\nMORARI, M.; ZAFIRIOU, E. (1989). Robust process control. Prentice-Hall,\n\nEnglewood Cliffs, NJ\n\nMORO, L. F. L.; ODLOAK, D. (1994). Controle de conversores de craqueamento\n\ncatal\u00edtico em leito fluido, I - Modelagem din\u00e2mica. Boletim T\u00e9cnico da Petrobras,\n\nv.37, n.1, p.3-12\n\nMORO, L. F. L.; ODLOAK, D. (1994). Controle de conversores de craqueamento\n\ncatal\u00edtico em leito fluido, II \u2013 Controle preditivo multivari\u00e1vel com restri\u00e7\u00f5es.\n\nBoletim T\u00e9cnico da Petrobras, v.37, n.2, p.111-124\n\nMORO, L. F. L.; ODLOAK, D. (1995). Constrained multivariable control of fluid\n\ncracking converters. Journal of Process Control, v.5, n.1, p.29-39\n\nMORSHEDI, A. M.; CUTLER, C. R.; SKROVANEK, T. A. (1985). Optimal solution\n\nof dynamic matrix control with linear programming techniques (LDMC). Proc. Am.\n\nControl Conf., Boston, MA, p.199-208\n\nNESTEROV, Y.; NEMIROVSKY, A. (1994). Interior-point polynomial methods in\n\nconvex programming. SIAM, Philadelphia\n\nODLOAK, D. (1995). Stability analysis of the dynamic matrix controller, Braz. Jour.\n\nChem. Engng, v.12, n.1, p.50-64\n\nODLOAK, D. (1996). A new state-space approach to model predictive control, Braz.\n\nJour. Chem. Engng, v.13, n.3, p.152-167\n\nPENG, D.Y.; ROBINSON, D.B. (1976). A new two constant equation of state. Ind.\n\nEng. Chem. Fundamen., v.15, p.59-64\n\nPRETT, D. M.; GILLETTE, R. D. (1979). Optimization and constrained multivarible\n\ncontrol of catalytic cracking unit, AIChE 86th National Meeting, Paper 51-C,\n\nHouton, TX\n\nPRETT, D. M.; GILLETTE, R. D. (1980). Optimization and constrained multivarible\n\ncontrol of a catalytic cracking unit, Proc. Automatic Control Conf., San Francisco,\n\nCA, Paper WP5-C\n\nRICHALET, J.; RAULT, A.; TESTUD, J. L.; PAPON, J. (1978). Model predictive\n\nheuristic control: application to industrial processes. Automatica, v.14, n.5, p.413-\n\n428\n\nRODRIGUES, M. A.; ODLOAK, D. (2000). Output feedback MPC with guaranteed\n\nrobust stability. Journal of Process Control, v.10, p. 557-572.\n\n\n\nRefer\u00eancias bibliogr\u00e1ficas 128\n\nROUHANI, R.; MEHRA, R. K. (1982). Model algorithmic control (MAC): basic\n\ntheoretical properties, Automatica, v.18, p.401\n\nSCHITTKOWSKI, K. (1985/6). A Fortran Subroutine Solving Constrained NonLinear\n\nProgramming Problems, Annals of Operations Research, vol. 5, p. 485-500\n\nSPANDRI, R.; MORO, L. F. L.; ODLOAK, D. (1995). Constrained multivariable\n\ncontrol of fluid catalytic cracking converters, a practical application. AIChE,\n\nSpring National Meeting, Paper 84b, Houston, TX\n\nTRIERWEILER, J. O.; FARINA, L. A.; DURAISKI R. G. (2001). RPN Tuning strategy\n\nfor model predictive control. DYCOPS, p.283-289, Jejudo Island, Korea\n\nZANIN, A. C.; ODLOAK, D. (1992). Advanced control of an atmospheric resid heater.\n\nProceedings of the First International Instrumentation, Systems and Industrial\n\nAutomation Meeting, p.33-42, Salvador, BA\n\n\n\n129\n\nAP\u00caNDICE  A\n\nFUN\u00c7\u00c3O DE TRANSFER\u00caNCIA DOS MODELOS\n\nIDENTIFICADOS\n\nNas tabelas A1 a A6 apresentamos na forma de fun\u00e7\u00e3o de transfer\u00eancia os\n\nmodelos identificados no cap\u00edtulo 7. Os par\u00e2metros da tabela obedecem seguinte\n\nequa\u00e7\u00e3o:\n\n( ) ?se\nasas\n\nsbb\nsG ?\n\n++\n+\n\n=\n21\n\n2\n10\n\nMODELO CV MV/DV b0 b1 a1 a2 ?\n\n1 C3\n- VRF 0.1094e-4 0.4227e-4 0.1090 0.0243 1\n\nVGOP -0.3824e-4 -1.2055e-4 0.1342 0.0111 1\n\nVcarga 0.5668e-2 -0.0945e-2 0.3975 0.0850 1\n\nTGOP -0.21740e-3 -0.6856e-3 0.1342 0.0111 1\n\nC4\n+ VRF -0.2539e-3 -0.2445e-3 0.1142 0.0086 1\n\nVGOP 0.6641e-3 0.7159e-3 0.1343 0.0087 1\n\nVcarga -0.2482e-3 0.0617e-3 0.1573 0.0141 1\n\nTGOP 0.0996e-1 0.1074e-1 0.1343 0.0087 1\n\nTTOPO VRF -0.1116e-3 -0.0873e-3 0.1317 0.0073 1\n\nVGOP 0.0070 0.0013 2.2605 0.1366 1\n\nVcarga -0.0015 -0.0004 1.9247 0.1353 1\n\nTGOP 0.1044 0.0194 2.2605 0.1366 1\n\nTabela A1 \u2013 Par\u00e2metros da fun\u00e7\u00e3o de transfer\u00eancia para o modelo 1\n\n\n\nAp\u00eandice A - Descri\u00e7\u00e3o sum\u00e1ria do HYSYS? 130\n\nMODELO CV MV/DV b0 b1 a1 a2 ?\n\n2 C3\n- VRF 0.4220e-3 -0.2722e-3 1.6602 0.2525 1\n\nVGOP -1.405e-4 -2.1828e-4 0.1322 0.0117 1\n\nVcarga 0.0521e-3 0.1503e-3 0.2097 0.0279 1\n\nTGOP -0.4740e-3 -0.7365e-3 0.1322 0.0117 1\n\nC4\n+ VRF -0.2891e-2 -0.1572e-2 0.7355 0.0561 1\n\nVGOP 0.0946e-2 0.1605e-2 0.1268 0.0123 1\n\nVcarga -0.3885e-3 -0.3830e-3 0.1355 0.0148 1\n\nTGOP 0.1216e-1 0.2064e-1 0.1268 0.0123 1\n\nTTOPO VRF -0.0063 -0.0034 2.0724 0.2428 1\n\nVGOP 0.0045 0.0002 0.8352 0.0812 1\n\nVcarga -0.0012 -0.0012 0.8328 0.0693 1\n\nTGOP 0.0575 0.0020 0.8352 0.0812 1\n\nTabela A2 \u2013 Par\u00e2metros da fun\u00e7\u00e3o de transfer\u00eancia para o modelo 2\n\nMODELO CV MV/DV b0 b1 a1 a2 ?\n\n3 C3\n- VRF 0.1532e-2 -0.0860e-2 1.1913 0.0912 1\n\nVGOP -0.7811e-3 -0.3770e-3 0.3402 0.0181 1\n\nVcarga 0.7698e-3 0.8929e-3 0.5633 0.0359 1\n\nTGOP -0.7701e-2 -0.3716e-2 0.3402 0.0181 1\n\nC4\n+ VRF -0.1053e-2 -0.2637e-2 0.3524 0.0231 1\n\nVGOP 0.1335e-2 0.0474e-2 0.2471 0.0203 1\n\nVcarga -0.3299e-3 -0.2002e-3 0.2293 0.0190 1\n\nTGOP 0.1316e-1 0.0467e-1 0.2471 0.0203 1\n\nTTOPO VRF -0.0008 -0.0034 0.4017 0.0365 1\n\nVGOP 0.0089 0.0064 1.8959 0.1946 1\n\nVcarga -0.0009 -0.0012 0.8844 0.0799 1\n\nTGOP 0.0877 0.0634 1.8959 0.1946 1\n\nTabela A3 \u2013 Par\u00e2metros da fun\u00e7\u00e3o de transfer\u00eancia para o modelo 3\n\n\n\nAp\u00eandice A - Descri\u00e7\u00e3o sum\u00e1ria do HYSYS? 131\n\nMODELO CV MV/DV b0 b1 a1 a2 ?\n\n4 C3\n- VRF 0.4881e-3 -0.1107e-3 0.9881 0.0646 1\n\nVGOP -0.1862e-3 -0.1763e-3 0.2605 0.0091 1\n\nVcarga 0.2710e-3 0.1854e-3 0.5111 0.0265 1\n\nTGOP -0.1781e-2 -0.1686e-2 0.2605 0.0091 1\n\nC4\n+ VRF -0.0440e-2 -0.1955e-2 0.1510 0.0074 1\n\nVGOP 0.5084e-3 -0.3732e-3 0.1041 0.0046 1\n\nVcarga -0.1856e-3 -0.3426e-3 0.0967 0.0046 1\n\nTGOP 0.4862e-2 -0.3570e-2 0.1041 0.0046 1\n\nTTOPO VRF -0.0025 -0.0039 0.8868 0.0840 1\n\nVGOP 0.0029 0.0055 0.8602 0.0392 1\n\nVcarga -0.0018 -0.0004 1.8877 0.0669 1\n\nTGOP 0.0281 0.0527 0.8602 0.0392 1\n\nTabela A4 \u2013 Par\u00e2metros da fun\u00e7\u00e3o de transfer\u00eancia para o modelo 4\n\n \n\nMODELO CV MV/DV b0 b1 a1 a2 ?\n\n5 C3\n- VRF 0.5647e-3 -0.3536e-3 0.8165 0.0809 1\n\nVGOP -0.4780e-3 -0.1427e-3 0.3417 0.0259 1\n\nVcarga 0.6786e-3 -0.1149e-3 0.9003 0.0712 1\n\nTGOP -0.6481e-2 -0.1935e-2 0.3417 0.0259 1\n\nC4\n+ VRF -0.2862e-2 -0.1206e-2 1.1691 0.0716 1\n\nVGOP 0.1352e-2 0.1303e-2 0.3245 0.0180 1\n\nVcarga -0.4581e-3 0.2032e-3 0.3565 0.0173 1\n\nTGOP 0.1833e-1 0.1767e-1 0.3245 0.0180 1\n\nTTOPO VRF -0.0021 -0.0019 1.1676 0.1069 1\n\nVGOP 0.0081 0.0053 2.4190 0.1761 1\n\nVcarga -0.7616e-3 -0.5323e-3 0.9818 0.0549 1\n\nTGOP 0.0766 0.0725 1.6731 0.1242 1\n\nTabela A5 \u2013 Par\u00e2metros da fun\u00e7\u00e3o de transfer\u00eancia para o modelo 5\n\n\n\nAp\u00eandice A - Descri\u00e7\u00e3o sum\u00e1ria do HYSYS? 132\n\nMODELO CV MV/DV b0 b1 a1 a2 ?\n\nFD C3\n- VRF 0.5656e-3 -0.2218e-3 3.4948 0.5902 1\n\nVGOP -0.001452 0.00007413 2.6987 0.4023 1\n\nVcarga 0.0001125 -0.0001138 0.4559 0.03227 1\n\nTGOP -0.01642 -0.01324 1.438 0.184 1\n\nC4\n+ VRF - - - - 1\n\nVGOP - - - - 1\n\nVcarga - - - - 1\n\nTGOP - - - - 1\n\nTTOPO VRF -0.001235 -0.001135 1.6380 0.09852 1\n\nVGOP 0.0020 -0.0003 2.4298 0.0651 1\n\nVcarga -0.0003829 0.0001715 0.2295 0.02632 1\n\nTGOP 0.006970 0.001998 0.1731 0.01045 1\n\nTabela A6 \u2013 Par\u00e2metros da fun\u00e7\u00e3o de transfer\u00eancia para o modelo da planta industrial\n\n\n\tIMPLANTA\u00c7\u00c3O DE UM CONTROLADOR MULTIMODELOS EM UMA COLUNA DEPROPANIZADORA INDUSTRIAL\n\tAGRADECIMENTOS\n\tSUM\u00c1RIO\n\tRESUMO\n\tABSTRACT\n\t1.INTRODU\u00c7\u00c3O\n\t1.1 - Apresenta\u00e7\u00e3o da problem\u00e1tica de controle de colunas de pureza elevada\n\t1.2 - Revis\u00e3o bibliogr\u00e1fica\n\t1.3 - Objetivo do trabalho\n\n\t2. PROBLEMA DE CONTROLE DA COLUNA DEPROPANIZADORA\n\t2.1 - Especifica\u00e7\u00f5es dos produtos\n\t2.2 - Descri\u00e7\u00e3o do processo\n\t2.3 - Vari\u00e1veis operacionais\n\t2.4 - Fatores de desempenho do sistema\n\t2.5 - Limita\u00e7\u00f5es do processo\n\t2.6 - Estrat\u00e9gias de controle da coluna depropanizadora\n\n\t3. DESCRI\u00c7\u00c3O SUM\u00c1RIA DO HYSYS\n\t4. SIMULA\u00c7\u00c3O EST\u00c1TICA DA DEPROPANIZADORA\n\t5. SIMULA\u00c7\u00c3O DIN\u00c2MICA DA DEPROPANIZADORA\n\t6. COMPORTAMENTO DO PROCESSO\n\t7. IDENTIFICA\u00c7\u00c3O DOS MODELOS DO SISTEMA\n\t7.1 \u2013 Algoritmo de identifica\u00e7\u00e3o com modelos na forma anal\u00edtica\n\t7.2 \u2013 Modelos de processo identificados\n\n\t8. ALGORITMOS DE CONTROLE\n\t8.1 \u2013 MPC com modelo n\u00e3o-param\u00e9trico\n\t8.2 \u2013 MPC com modelo de ordem reduzida\n\n\t9. APLICA\u00c7\u00c3O DO MPC \u00c0 COLUNA DEPROPANIZADORA\n\t9.1 \u2013 Compara\u00e7\u00e3o QDMC e MMPC\n\t9.2 \u2013 Implanta\u00e7\u00e3o do controlador MMPC na planta industrial\n\n\t10. CONCLUS\u00d5ES E SUGEST\u00d5ES\n\t10.1 \u2013 Conclus\u00f5es\n\t10.2 \u2013 Sugest\u00f5es\n\n\tREFER\u00caNCIAS BIBLIOGR\u00c1FICAS\n\tAP\u00caNDICE A"}]}}}