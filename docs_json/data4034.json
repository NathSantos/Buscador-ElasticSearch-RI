{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.07581"}, {"@name": "filename", "#text": "12300_Schiozer_DenisJose_M.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE ESTADUAL DE CAMPINAS\nFACULDADE DE ENGENHARIA DE CAMPINAS\nDEPARTAMENTO DE ENGENHARIA DE PETR\u00d3LEO\nDisserta\u00e7\u00e3o Apresentada a\nFaculdade de Engenharia de Campinas\nComo Requisito Parcial \u00e0 Obten\u00e7\u00e3o do\nT\u00edtulo de Mestre em Engenharia de Petr\u00f3leo\nESTUDO DE UM MODELO COMPOST ClONAL\nPARA SIMULA\u00c7XO DE RESERVAT\u00d3RIOS\n\n\u00edW-Gc\nC6/<SA\n\nlt\n\n\nAutor\nDeni s Jos\u00e9\nSchiozer\nOrientador\n: Ant\u00f4nio Cl\u00e1udio de Fran\u00e7a Corr\u00f3a\nJunho de 1QS9\nUNIVERSIDADE ESTADUAL DE CAMPINAS\nFACULDADE DE ENGENHARIA\n\u25ba\nDEPARTAMENTO DE ENGENHARIA DE PETROLEO\nA disserta\u00e7\u00e3o \"Estudo de um modelo Composicional para Simula\u00e7\u00e3o de Reservat\u00f3rios\", elaborada por Denis Jos\u00e9 Schiozer e aprovada por todos os membros da Banca Examinadora foi aceita pela Sub-Comiss\u00e3o de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Petr\u00f3leo como requisito parcial a obten\u00e7\u00e3o do T\u00edtulo de Mestre em Engenharia de Petr\u00f3leo.\nCampinas\u00bb28 de Junho de 1989.\nBanca Exami nador a\nAnt\u00f3ni\nAGRADECIMENTOS\nAos funcion\u00e1rios e professores do CEPETRO e da UNICAMP e aos colegas de curso, por tornarem esta tarefa mais f\u00e1cil e agrad\u00e1vel.\n\nINDI CE\nP\u00e1gi na\nAbstract...................................................... x\n13\tIntrodu\u00e7\u00e3o................................................... 1\nl\n1.1-\tA escolha\tdo modelo...................................... 3\n1.2-\tO modelo. ............................................... 4\n23\tModelo Matem\u00e1tico............................................ 6\n2.1-\tEqua\u00e7Bes\tdo\tEscoamento.................................. 6\n2.2-\tEqua\u00e7Ses\tde\tEquil\u00edbrio.................................. \u00d4\n2.3-\tEqua\u00e7Ses\tAdicionais.................................... 10\n33 Di scr et i z a\u00e7 \u00e3o.......................................... 11\n3.1-\tGrade.................................................. 11\n3.2-\tEqua\u00e7\u00f5es............................................... 12\n43 M\u00e9todo de Solu\u00e7\u00e3o............................................ 15\n4.1-\tFluxograma.............................................. 18\n4.2-\tEqua\u00e7\u00e3o de Press\u00e3o.........................  .\t. ...... l\u00e2\n4.\t3\u2014 Equa\u00e7\u00f5es das\tComposi\u00e7\u00f5es............................... 26\n4.\t4- Equa\u00e7\u00f5es das\tSatura\u00e7\u00f5es................................ 27\n3.1-\tEquil\u00edbrio L\u00edquido-Vapor............................... 29\n3. 2- Equa\u00e7Ses de Estado..........................F......... 32\n5.3-\tO \"Flash\".............................................. 35\n65\tT\u00f3picos especiais.......................................... 39\n6.1-\tPermeabilidade Relativa................................ 39\n6.2\u2014\tModelo de Po\u00e7o......................................... 41\n6.3\u2014\tBalan\u00e7o de Materiais................................... 44\n6. 4- Crit\u00e9rio de Converg\u00eancia.............................. 45\n6.5-\tModelo Radial.......................................... 46\n6.6-\tResolu\u00e7So do Sistema................................... 49\n6.7-\tControle do Intervalo de Tempo......................... 50\n6.8-\tModelo de Helfferich................................... 51\n73 Resul tados................................................. 53\n7.1-\tCaso 1 - Modelo Unidimensional - Inje\u00e7So de G\u00e1s........ 54\n7.2-\tCaso 2 - Condensa\u00e7\u00e3o Retr\u00f3grada........................ 63\n7.3-\tCaso 3 - Modelo de Helfferioh.......................... 68\n7.4-\tCaso 4 - Modelo Radial................................. 75\n7.5-\t' Caso 5 - Valida\u00e7So do Modelo......................... 76\n85 Concl uscSes................................................ 80\nANEXOS\n\u25ba\nBD Tabela de Convers\u00e3o de Unidades para o SI .................... 88\nO Listagem do Programa........................................... 89\nA\nDD Exemplo Entrada de Dados..................................... 113\nRefer\u00eancias Bibliogr\u00e1ficas................................... 115\nLISTA DE FIGURAS\n\u25ba\nP\u00e1gi na\nFigura 4.2\t: Sistema de Resolu\u00e7\u00e3o da Equa\u00e7\u00e3o da Press\u00e3o......\t21\nFigura 7.1.1 : Distribui\u00e7\u00e3o das Composi\u00e7Ses no Tempo\nCompara\u00e7\u00e3o do Modelo CNFA3 com o \u201cC0MP3\"........ 56\nFigura 7.1.2 : Distribui\u00e7\u00e3o das Composi\u00e7Ses nos Blocos\nCompara\u00e7\u00e3o do Modelo CNFA3 com o \"COMP3*'....... 57\nFi gur a 7.1.3 : Di str i bui \u00e7\u00e3o das Composi \u00e78es nos BI ocos\nCompara\u00e7\u00e3o do Modelo CNFA3 com o \"COMP3\"\nsem a Limita\u00e7\u00e3o da Equa\u00e7\u00e3o C3. 103.............. 5S\nFigura 7.1.4 : Composi\u00e7\u00e3o do Butano\nEfeitos da Limita\u00e7\u00e3o da Equa\u00e7\u00e3o C3. 103......... 5\u00d5\nFigura 7.1.5 : Composi\u00e7\u00e3o do Butano\nEfeitos da Varia\u00e7\u00e3o do N\u00famero de Blocos......... 60\nFigura 7.1.6 : Satura\u00e7\u00e3o de \u00d3leo\nCompara\u00e7\u00e3o do Modelo CNFA3 com o \u201cCOMP3\"........ 61\nFigura 7.2.1 : Satura\u00e7\u00e3o de \u00f5leo - Condensa\u00e7\u00e3o Retr\u00f3grada\nEfeitos da Varia\u00e7\u00e3o do Intervalo de Tempo....... 65\nFigura 7.2.2 ; Envelope de Fases para CMetano: 0.650653,\nC Butano: 0. 325513 e CDecano: O. 023843........ 66\nFigura 7.2.3 : Envelope de Fases para CMetano: 0.691893,\nCButano: 0.303043 e CDecano: 0.005073........... 67\nFigura 7.3.1 : Satura\u00e7\u00e3o de \u00f5leo - Modelo de Helfferich\nEfeitos da Varia\u00e7\u00e3o do n\u00famero de blocos......... 71\nEfeitos da Varia\u00e7\u00e3o da Formula\u00e7\u00e3o das Composi\u00e7Ses......................i................ 72\nFigura 7.3.3 : Composi\u00e7\u00e3o do Fluido Injetado \u2014 Modelo de Helfferich. Efeitos da Varia\u00e7\u00e3o do n\u00famero de blocos........................................................ 73\nFigura 7.3.4 : Composi\u00e7\u00e3o do Fluido Injetado - Modelo de Helfferich. Efeitos da Varia\u00e7\u00e3o da Formula\u00e7\u00e3o das Composi\u00e7Ses....................................... 74\n*\nRESUMO\nEste tipo de modelo \u00e9 usado na simuia\u00e72o do comportamento de reservat\u00f3rios de g\u00e1s condensado e \u00f3leo vol\u00e1til\u00bb na inje\u00e7\u00e3o de g\u00e1s e CO^ e em estudos de deslocamentos misc\u00edveis. A sua aplica\u00e7\u00e3o pode ser estendida para alguns problemas do tipo \"black-oilAs equa\u00e7Ses s\u00e3o resolvidas por um m\u00e9todo iterativo e sequencial, atrav\u00e9s do balan\u00e7o de moles dos hidrocarbonetos e da \u00e1gua, com base em um modelo de Nghiem. L.X. \u00bbFong, D. K. e Aziz, K. .\nO equil\u00edbrio e as propriedades das fases s\u00e3o estimadas por um \"flash\u201d usando uma equa\u00e7\u00e3o de estado que pode ser tanto a de Peng- Robinson como a de Soave-Redlich-Kwong, dentre outras. Um c\u00e1lculo \"flash\" eficiente permite o uso do modelo na regi\u00e3o cr\u00edtica.\nO modelo foi testado para v\u00e1rios casos e alguns deles s\u00e3o apresentados e discutidos.\nDevi do \u00e0 si mpli ci dade, tempo computaci onal e desempenho, este trabalho pode ser um primeiro passo para o desenvolvimento de um \"General Purpose Reservoir Simulator\".\nABSTRACT\nThis type of model is required in the simulation of the behavi or of gas condensate and volati1e oil reservoi r s, in enhanced oi1 recovery reservoirs by CO^ or enriched gas injection and in miscible displacement. It can be used also for some bl ack-oi1 problems.\nThe equations are based on the mol ar bal ance of the hydrocarbon components and water, and they are solved using an iterative-sequential method, based on a model by Nghiem, L. X. , Fong, D.K. , and Aziz, K. .\nThe composi ti onal phase equi1i brium and phase behavi or properties are estimated by a equilibrium flash calculation using an equation of state Cei ther Peng-Robi nson or Soave-Redli ch-Kwong?. An efficient flash-calculation permits the use of the model around the critical point.\nThe model has been tested agai nst some condi ti ons whi ch ar e presented and discussed.\nThi s model, due to the si mpli city to program, run-ti me and performance, can be useful1 as a first step for the development of a General Purpose Reservoir Simulator\n\u25ba\n1 - INTRODU\u00c7SO\nUm modelo de simula\u00e7\u00e3o de reservat\u00f3rios pode ser definido como um gr upo de equa\u00e7Ses de balan\u00e7o de materi ai s a ser r esolvi do nuiner i camente, geral mente por di fer en\u00e7as finitas.\nRecentemente, com o surgi mento de diferentes m\u00e9todos de\nr ecuper a\u00e7\u00e3o de \u00f3l eo e\ng\u00e1s, o n\u00famero de modelos de simula\u00e7\u00e3o de\nreserva t \u00f3r i os\ncresceu\nbastante. Os\naplicados\nna\ninje\u00e7\u00e3o\nde vapor ou\nem processos de combust\u00e3o\n\"in-situ\"\nem\nreser vat\u00f3r i os de 61eo\npesado. Os modelos qu\u00ed mi cos\nincluem a\ninje\u00e7\u00e3o de produtos qu\u00edmicos tais como pol\u00edmeros e soda\nc\u00e1ustica.\ns\u00e3o usados para simular reservat\u00f3rios naturalmente fraturados. Estes;, por\u00e9m, n\u00e3o pertencem ao alvo de discussSes deste trabalho.\nOs modelos do tipo \"black-oil\" s\u00e3o isot\u00e9rmicos e podem ser usados em estudos de recupera\u00e7\u00e3o convencionais de hidrocarbonetos\nem reservat\u00f3rios contendo \u00e1gua, \u00f3leo e g\u00e1s. O balan\u00e7o de massas \u00e9 feito com base nestas tr\u00e9s fases e as propriedades dos fluidos dependem apenas da press\u00e3o atuante e da press\u00e3o de satura\u00e7\u00e3o do si stema de hi drocarbonetos. Este ti po de modelo supSe ai nda composi\u00e7\u00f3es de \u00f3leo e g\u00e1s constantes e n\u00e3o considera a solubilidade do 61eo no g\u00e1s, isto \u00e9, a volati1idade do 61eo.\nNa d\u00e9cada de 70\u00bb com a eleva\u00e7\u00e3o acentuada do pre\u00e7o do petr\u00f3leo\u00bb cresceu a i mport\u00e2nci a dos m\u00e9todos especi ai s de recupera\u00e7\u00e3o. A necessidade de se aumentar a produ\u00e7\u00e3o dom\u00e9stica de \u00f3l eo fez com que po\u00e7os mai s pr ofundos fossem per furados, aumentando a freq\u00fc\u00e9ncia de reservat\u00f3rios de \u00f3leo vol \u00e1ti 1 e g\u00e1s condensado.\nDentro deste contexto\u00bb surgiu a necessidade de desenvolvi mento de si stemas mai s complexos capazes de si mui ar a produ\u00e7\u00e3o de \u00f3leo sob condi\u00e7Ses em que os modelos \"black-oil\" s\u00e3o i neficientes.\nGanharam \u00eanfase os model os \"blact-oi 1\" modi fi cados e os composicionais. Os primeiros s\u00e3o model os um pouco mai s sofisticados que os \"black-oil\" convencionais\u00bb com algumas altera\u00e7Ses como\u00bb por exemplo, m\u00fatua solubilidade entre as fases. Os modelos composicionais s\u00e3o utilizados quando o comportamento do r eser vat\u00f3r i o \u00e9 af etado pel a var i a\u00e7\u00e3o das pr opri edades PVT com a composi\u00e7\u00e3o dos hidrocarbonetos.\nO sucesso de alguns modelos composicionais, aliado \u00e1 r\u00e1pida evolu\u00e7\u00e3o dos computadores, faz com que as pesquisas se voltem para o desenvolvimento de um simulador capaz de englobar todos ou a maioria dos casos anteriores C\"General Purpose Reservoir Si mui ator\"D.\nA id\u00e9ia deste trabalho nasceu da possibilidade de se estudar um modelo composi ci onal si mples, que pudesse ser usado tamb\u00e9m para problemas do tipo \"black-oil\". Este \u00e9 o primeiro passo para o desenvolvimento de um \"General Purpose Reservoir Si mui ator\".\n1.1\t- A ESCOLHA DO MODELO\n\u25ba\nO estudo dos efeitos de mudan\u00e7as de composi\u00e7\u00e3o na simula\u00e7\u00e3o de reservat\u00f3rios come\u00e7ou com a introdu\u00e7\u00e3o do equi1i brio l\u00edquido-vapor CELVD nos modelos computacionais. Todas as tentativas\u00bb entretanto, apresentavam problemas de converg\u00eancia na regi\u00e3o critica.\nt\nEste problema come\u00e7ou a ser superado por Fussel1 e Fussel1 EFF791, com a introdu\u00e7\u00e3o de uma equa\u00e7\u00e3o de estado c\u00fabica CEOSD na determina\u00e7\u00e3o do equil\u00edbrio l\u00edquido-vapor.\nDesde ent\u00e3o, outros modelos utilizando equa\u00e7\u00caSes de estado foram apresentados. A refer\u00eancia \u00a3 TLS833 mostra uma compara\u00e7\u00e3o entre tr\u00eas modelos: o modelo total mente impl\u00edcito de Coats [CoaSO], o de Nghiem, Fong e Aziz ENFA813 e o de Young e Stephenson EYS831. A refer\u00eancia EWonSS] apresenta tamb\u00e9m algumas outras for muia\u00e7Ses e compar a\u00e7Ses.\nDe acordo com os resultados apresentados nestas refer\u00eancias, o modelo ENFA811 foi escolhido como base na f or m\u00fcla\u00e7\u00e3o do pr esente tr abaiho, pelos result ados apr esentados,\npelo menor\ttempo\tde desenvolvi mento\tdo\tpr ogr ama,\tpel a mai or\t\nsi mpli ci dade\tde constru\u00e7\u00e3o do modelo\t\te\tpelo menor\ttempo\tde\ncomputa\u00e7\u00e3o\tquando\tse\ttr abal ha\tcom\tum\tpequeno\tn\u00famero\tde\ncomponentes.\nA viabiliza\u00e7\u00e3o do estudo dos problemas do tipo \"black-oi 1\u201c seria conseguida pela redu\u00e7\u00e3o do n\u00famero de componentes. Com apenas doi s componentes, o tempo de computa\u00e7\u00e3o di mi nui bastante e a solubilidade entre as fases \u00e9 feita naturalmente pelo c\u00e1lculo do\nA escol ha dos componentes para cada caso deve ser feita a partir de dados experimentais de propriedades PVT.\n1.2-0 MODELO\nO model o computad onal a ser estudado \u00e9 do ti po composici onal, com c\u00e1lculo impl\u00ed cito da press\u00e3o e explici to das satura\u00e7\u00f5es e composi\u00e7\u00f5es.\nO equil\u00edbrio de fases \u00e9 calculado por um \"flash\" atrav\u00e9s de uma equa\u00e7\u00e3o de estado , que pode ser a de Peng-Robi nson ou a de Soave-Rediich-Kwong.\nA formula\u00e7\u00e3o da equa\u00e7\u00e3o da press\u00e3o leva a uma matriz sim\u00e9trica e diagonalmente dominante, o que \u00e9 uma caracter\u00edstica i mportante para a est\u00e1bilidade num\u00e9rica do modelo, e permi te a uti1i za\u00e7\u00e3o de m\u00e9todos de eli mi na\u00e7\u00e3o di reta par a a solu\u00e7\u00e3o do sistema de equa\u00e7\u00f5es.\nAs equa\u00e7\u00f5es s\u00e3o resolvidas atrav\u00e9s de um m\u00e9todo iterativo sequencial, conforme o fluxograma apresentado no item C4.1}.\nO modelo tem por base ainda as seguintes caracter\u00edsticas:\n-\tfluxo isot\u00e9rmico,\n-\tescoamento trif\u00e1sico C\u00f3leo,g\u00e1s e \u00e1gua},\n-\tbidimensional CX e Y},\n-\tmuiti componente,\n-\tpo\u00e7os de inje\u00e7\u00e3o ou produ\u00e7\u00e3o em qualquer bloco,\n-\tgravidade e press\u00e3o capilar desprezadas,\n-\tmeio homog\u00eaneo e isotr\u00f3pico,\n-\tblocos uniformes em cada dire\u00e7\u00e3o,\n-\tescoamento regido pela 1 ei de Darcy,\n-\tprodu\u00e7\u00e3o \u00e0 vaz\u00e3o ou press\u00e3o constante e,\n-\treser vaL\u00f3r i o fechado C sem f1uxo externoD.\n2 - MODELO MATEMATICO\n\n2.1-\tEQUA\u00c7\u00d5ES DO ESCOAMENTO\nAs equa\u00e7\u00f5es do escoamento serSo escritas com base no pri ncipio da conserva\u00e7\u00e3o de massa e na 1ei de Darcy.\n1\n\u2022 Conserva\u00e7\u00e3o de massa para fluxo monof\u00e1sico em uma dire\u00e7\u00e3o\nA equa\u00e7\u00e3o do escoamento para este caso \u00e9:\nC2. 12>\nonde, p\n0\nu\nX\n\u00abV\nq\n---> densi dade molar \u00bb\n---* por osi dade\u00bb\n---\u25ba veloci dade aparente e\n---> vaz\u00e3o molar por unidade de volume.\n\u2022 Fluxo Multidimensional\nA equa\u00e7\u00e3o C2.pode ser generalizada para mais de uma\ndimens\u00e3o\u00bb resultando:\n+ q\nC2. 2?\n\u2022 Fluxo Mui tif\u00e1sico\npode ser escrita como:\n\nonde\u00bb L\nSL\n- *\u2022(?&amp;) + SJ\n\u25a0+ Indice indicador da fase\n+ satura\u00e7\u00e3o da fase L\nLei de Darcy\nA lei de Darcy, modificada para\nfornece uma rela\u00e7\u00e3o entre\na veloci dade de\nCol\u00e9a, g\u00e1s\nescoamento\nescoamento\ne o gradiente de press\u00e3o\npara\nexpressa da\nforma,\nk\n\nk'l(\nonde,\nk\npermeabi1i dade\ni\nk , r l\n\u2666\nper meabi1i dade\na lei\nC2. 33\nou \u00e1gua3\n\nmu\u00ed bif\u00e1sico.\naparente, u^,\ncada fase. Esta rela\u00e7\u00e3o pode ser\nvPl- ]\nabsoluta\u00bb\nreiativa\na fase CL3 e,\nC2. 43\nPl\n\npress\u00e3o atuante na fase\nDefinindo-se o potencial de fluxo\n= 7Pl \u201c\t\u2022\nde Darcy pode ser expressa por:\nCD.\natrav\u00e9s de\nC2. 53\nk k\n\n* Equa\u00e7Hes de fluxo para as fases\nA fim de se produzi r as equa\u00e7Ses de escoamento par a cada\nfase, a equa\u00e7So C2.63 pode ser substitu\u00edda na C2.33 resultando em:\nV- \u2014+ 5t = -\u00c9j-\tSj .\nou\nV*\t+ qL\t<?t\tSl) \u2019\tca. 83\nonde a mobi1i dade da fase L \u00e9\tdefinida por:\t\nk\tk .\t\nX = \t\tr L \t o. .\tC2. 93\n\u2022 Equa\u00e7Ses de fluxo para os componentes\nO modelo composiclonal tem por base o balan\u00e7o de moles de cada componente do sistema de hidrocarbonetos. Com isto torna-se nec-ss\u00e1rio escrever tamb\u00e9m as equa\u00e7Ses de fluxo para cada componente, as quals s\u00e3o:\n\u2022+\t\u2022+\t\u00e2\n7\u2018x Vy + X y ) + q = \u2014-~r~ R z (p S + p S }1\nv o m o\tg m gy\tm\t<Tt L m o o\tg 9y J \u00bb\nm = 1. . . p , C 2. 103\nTH\nx -------* fra\u00e7So molar do componente Cm5 na fase l\u00edquida\u00bb\nm\t'\ny -------\u00bb fra\u00e7So molar do componente Cre\u00f3 na fase gasosa e,\nm\n\nn\u00famero de componentes.\n2.\t2 - EQUA\u00c7\u00d5ES DE EQUILIBRIO\ni\nA condi\u00e7\u00e3o de equil\u00edbrio termodin\u00e2mico exige igualdade de fugacidades \u00f1as fases \u00f3leo e g\u00e1s para cada componente:\nf = f \u00bb\tm = 1.-v .\tC2.115\nmo\tmg\nA\u00ednda como equa\u00e7Ges de equil\u00edbrio\u00bb est\u00e3o aquelas obtidas do\nbalan\u00e7o de materiais das fases \u00f3leo e g\u00e2s\u00bb ou seja\u00bb\n\tz = L x + V y , rn\tm\tm\tC2. 125\n\tP s I\t-\t\u00b0\t\u00b0\tC2. 135\n\tu\tp S + p S \u2019 \u00b0 O\t9 S\u00ed\t\ne\tp s V -\t3 9\tC2.145\n\tp S + p S \u2019 o o\tg g\t\nonde\u00bb L\t\t\u00bb fra\u00e7So molar do l\u00edquido\u00bb\t\nV\t\t\u25ba fra\u00e7\u00e3o molar do g&amp;s.\t\n2.3 - EQUA\u00c7\u00d5ES ADICIONAIS\ndefini\u00e7\u00f5es de fra\u00e7\u00e3o molar e satura\u00e7\u00e3o fornecem as seguintes\nrei a\u00e7\u00f5es:\nS + S + S = 1 , o g w\nk\nC2. 153\n\tL + V\t\t= 1 >\tC2. 163\ne\t\t\t\t\n\tp\t1?\tV\t\n\t\u00a3 z m\t= m\t= \u00a3y =1 \u201c m\tC2.173\n\tm=l\tm=l\tm=l\t\nDeste modo, obtem-se um sistema com n,C3v+63 equa\u00e7\u00f5es e\nD\nn C 3l>+63 i nc\u00f3gni tas \u25ba or i gi nadas pel a dl scr eti za\u00e7So das equa\u00e7\u00f5es O\ndiferenciais.\nAs inc\u00f3gnitas s\u00e3o: a press\u00e3o atuante no sistema Cp. 3, as\nsatura\u00e7\u00f5es CS .S . e S . 3 , as fra\u00e7\u00f5es molares totais no \u00f3leo CL 3 oi gi vi\tL\ne no g\u00e1s CVp e as fra\u00e7\u00f5es molares dos componentes na mistura\nCz .3, no \u00f3leo Cx .3 e no g\u00e1s Cy .3. O \u00edndice C\u00ed3 refere-se ao mi\tmt\tmt\nbloco e varia de Cl 3 a Cn 3 e o \u00edndice Cm3 refere-se ao O\ncomponente, variando de C13 a Cw3.\t\u2019>\t.\nAs equa\u00e7\u00f5es fi nais a serem utilixadas pelo si stema s\u00e3o: a\nC2.83, a C2.103, a C2.113 e da CS. 133 a C2.173.\n\n3\t- DISCRETIZA\u00c7\u00c0O\ni\n3.1-\tGRADE\nO primeiro passo para a discretiza\u00e7\u00e3o \u00f3 a defini\u00e7\u00e3o das caracter\u00edsticas do modelo, que s\u00e3o:\n\u2014\tbloco centrado,\n\u2014\tduas di mensSes C x e yD,\n\u2014\t'\"upstream mobility\",\n\u2014\t\"2-point upstream\" para fra\u00e7des molares,\n\u2014\tmalha de 5 pontos e,\n\u2014\tgrade uniforme em cada dire\u00e7\u00e3o.\n\nDeste modo,\nas equa\u00e7Bes dos componentes C2.1OD podem ser\nescritas pera as dire\u00e7Ses x e y :\nd \u00bfhc\na \u00e2x\n+\na\n+\nDo mesmo\nmodo,\nas\nequa\u00e7Ses C2.85 \u00bb\npara\n\u25ba\ncada fase\nficam:\nd f,\td\t1\td\tr\t0 d\t\td\t\ndx p\tnj +\t&amp;y\ts\tdy J\t+ ql=\tdt\tpl* sl\nca, a?\nk\n3.2\t- EQUA\u00c7\u00d5ES\nUti1 i zando-se\num\nesquema de\ndiferen\u00e7as\nfin\u00ed tas com 5\npontos, a equa\u00e7So C3.25 pode ser discretizada por:\nAx. I U l+\u00a3/2\nL L\nn+ 1\tn+ 1\nAx,\nt + 1/2\nn\nV-l/2\nn+ 1\nn+ i\n\nAx\n1-1/2\nn+ \u00a3\n1 Ay.\n(\\)n\nVj+\u00a3Z2\nn+ 1\nAy.\nj + l/2\nn+ \u00a3\tn+ \u00a3\n+ qn\nqUj\n\u00edc[(* asiF*\n(\\W\nAy.\nJJ-l/2\n\u00a3\u2666 pisJ\"l\nJij\nC3. 35\n. j \n+\nonde\u00bb q^ =\t\u25a0- qt - Vb ,\nVb\t\tr volunte do bloco CAx*AyAz5 e.\n(1\t\t\u25ba indica o intervalo de tempo.\nDefinindo-se a transmissiv\u00eddade por:\n\\ A V -\u00bfSr- \u25ba\nC3. 45\n\nonde, A \u00e9 a \u00e1rea transversal aberta ao fluxo, e\nmui ti pli\u00e7ando a\nequa\u00e7\u00e3o C3.35 pelo volume do bloco, V^, obtem-se:\nf n+1\n\\ W^i\nL+l/Z\nn+1-\t-\tn+1\nn+1\nn t i\nWi-t. J +\nr n+1\n+I?. (Wu\u00ab\nJ+1/2 *\u25a0\n>-\tn+i\nWuJ \u2019\nn+1\t-\nWi.j-J +\nk\n+ W- .5 \u25a0 -\u00a3[(*\t- (*\nNa forma simplificada, a equa\u00e7\u00e3o C3.55 fica :\na^1^ = -\u00a3[(> p1sl)\u201d\u2019* - &amp;\nA discretiza\u00e7\u00e3o par a as equa\u00e7Ses de cada componente,\neq.C3,15, pode tamb\u00e9m ser expressa desta forma, ou seja.\n1\n. R\u2014n n. n+1 \u201e\t\u2014n n. n+1 J , _n\nA T x Aui + T y Aw f + q\nI o m o\tgmg J\tm\nVb L1\n\u00c3t^\nn+1 n+1 \u00bb Z\nm\nS\n- o\n+ P s )n+1\n3\n- /znfp S + P s )n m V o o\tg g-7\tL,\tC3. 75\nAs transmissividade CT , T e \u00b0\tg\tT 5 V\tentre os blocos s\u00e3o\ncalculadas a partir das propri edades no bloco de maior\nAs compos!\u00e73es Cx &amp; y 3 tamb\u00e9m poderiam ser calculadas m\tm\ndesta forma, mas segundo a refer\u00eancia ENFA811, ipto pode causar\ndlspersSo num\u00e9rica excessiva. Para diminuir a dispersSo num\u00e9rica o\nc\u00e1lculo \u00e9 f ei to levando-se em conta os doi s blocos no senti do do\nmaior potencial C\"two-point upstream\"}.\nFor exemplo, se p. >p.\ni ~ 1 i\ntem\u2014se:\nonde CO \u00e9 um bloco da grade,\nm. -t-i/2\nAL + Al.\nL-1\tv - 2\n*\nC3. 83\nComo\nos blocos s\u00e3o uniformes\ntem-se queAU\nAt.\nL - 1\ne\nportanto:\nO w. >\nC3. 93\nSSo ai nda i mpostas as 1i mi ta\u00e7Ses,\nC3.103\npara minimizar problemas de \"overshoot\" e \"undershoot\".\nAs considera\u00e7\u00f5es apresentadas nas equa\u00e7Ses C3. 93\ne C3.103\nvalem tamb\u00e9m para y\nm\n4\t- M\u00c9TODO DE SOLU\u00c7\u00c3O\nO m\u00e9todo \u00e9 baseado no tratamento i mpl1ci to das press\u00f5es , ficando as satura\u00e7\u00f5es e as composi \u00e73es com um tratamento\n* expl\u00edcito. Deste modo, as transmissividades sSo calculadas no intervalo de tempo anteriores Cn3, e as equa\u00e7Bes de balan\u00e7o de massa ficam:\n\u2022 \u00e1gua\nn+4\nC4.13\n* componentes hidrocarbonetos\n* r_n n * n+1 , _n n. n+11 . n ATx Ay + T y Ay\t+ q\nloTn o\tgm gj\tm\n(p.3.+\n(* zJposo+\nC4. 23\nSomando-se as equa\u00e7Ses Cd.23, tem-se\na equa\u00e7\u00e3o de balan\u00e7o\nde massa para o sistema de hidrocarbonetos:\n\nm\n1. .\n\n\n_nA n+11 . n Vb\nJ + S, = -Al\n\nonde.\nv\nqh = E q.\n1\nC4. 43\nPara o caso particular de press\u00e3o capilar e efei tos\ngravi tacionais desprez\u00edveis,\nAy* = Au* = Au* = Ap o\tg\tw\n\u00bb\nC4. 33\nPortanto,\nas equa\u00e7Ses C4.13 a C4.33\npodem ser simplificadas\npara:\nC4. 63\n-\t[* ^oSo + p9s9)]n]tj\nC4. 73\n-\nC4, 83\nO m\u00e9todo de solu\u00e7\u00e3o pode ser melhor. . entendido atrav\u00e9s do\npor meio do seguinte processo iterativo:\n\nPasso 1\t\t\t\u00bb\tCombinar equa\u00e7Bes C4.63 a C4. 83 para\tformar\ta\n\t\t\tequa\u00e7\u00e3o da press\u00e3o, item C4.23.\t\t\nPasso\ta -\t\t\u25ba\tResolver a equa\u00e7\u00e3o da press\u00e3o obtendo pL+1.\t\t\nPasso\t3\t-\t\t1, + i Resolver equa\u00e7\u00e3o C4.63 obtendo S\t\t\nPasso\t4\t\tt\tResolver equa\u00e7\u00e3o de composi\u00e7\u00e3o obtendo\tt + i z m\t\nPasso\t\t\tFazer um flash obtendo x\u00ed + 1\t\u00bb yt + 1 m\tm\tvl + l\t\n\t\t\t\t\t\n\t\t\t,1+1\tl+l\tl+i L\t\u00bb p\te p o\tg\tsL + 1 O\t\nPasso\t6 -\t\t1\tResolver equa\u00e7Bes de satura\u00e7\u00e3o, obtendo\t\te\n\t\tSL + 1 9\t\t\t\nPasso\t7\t-\t\t-t\tTestar converg\u00eancia.\t\t\n\t\t\t*\tSe n\u00e3o houver converg\u00eancia, voltar ao\tpasso\t2\nf azendo C l=L+\u00b1J \u00bb\n----\u00bb- Se houver converg\u00eancia, passar para o pr\u00f3ximo\nintervalo de tempo Cn=n+13.\nObservar que o \u00edndice ClD \u00e9 usado para indicar o n\u00famero da itei a\u00e7\u00e3o e Cn3 para indicar o intervalo de tempo. Na primeira itera\u00e7\u00e3o Cl=i3\u00bb os valores das vari\u00e1veis s\u00e3o iguais aos do i n ter valo de tempo anterior Cn5. Quando a converg\u00eancia for ati ngi da\u00bb as var i \u00e1vei s do i nt er vaio de tempo C n+13 assumem os\nvaleros que possu\u00edam na itera\u00e7\u00e3o Cl+O.\n4. 1\nFLUXOGRAMA\nFigura 4. 1 : Fluxograma.\n4.2\t- EQUA\u00c7XO DA PRESSXO\n\u00ed\nA equa\u00e7\u00e3o da pressSo \u00ea obtida multiplicando-se a equa\u00e7\u00e3o\nC4.63 por um par\u00e2metro constante C\u00d43 e somando-se com a equa\u00e7\u00e3o\nC4.83. Tem-se ent\u00e3o:\n103\nEste fator pode ser\nem t-0 pela express\u00e3o:\ncalculado\n113\n\u00ed Segundo a refer\u00eancia [NFA81]* para os casos pr\u00e1ticos de densidades molares, o valor de &amp; fica entre 0*1 e 0,2.\n\u00ae Solu\u00e7\u00e3o da equa\u00e7\u00e3o da press\u00e3o\nA equa\u00e7\u00e3o da press\u00e3o C4.93 \u00e9 v\u00e1lida para os Cn 3 blocos da Q\ngrade. Deste modo* a resolu\u00e7\u00e3o desta equa\u00e7\u00e3o est\u00e1 baseada num sistema de Cn 3 equa\u00e7Ses e Cn 3 inc\u00f3gnitas.\no\tO\nA di screti za\u00e7\u00e3o fei ta no 1 tem C 33 determi na que a equa\u00e7\u00e3o\nO processo iterativo utilizado foi o m\u00e9todo de Newton\u00bb que determina o sistema:\nt\nC4. 120\ni = 1. .. nb .\nonde\u00bb J f11\t\t>\telementos do Jacobiano.\t\t\t\nt k\t\t\t\t\t4\nF( l) \u00ed\t\t*\tlado\tesquerdo da equa\u00e7\u00e1o\tde press\u00e3o\tC4. 90.\nA press\u00e3o\t\tna\titera\u00e7\u00e3o&lt;1+d\t\u00e9\tobtida a\tpartir das\npropriedades na itera\u00e7\u00e3o CO , sendo a primeira itera\u00e7\u00e3o baseada no intervalo de tempo anterior Cn).\nJfl\t_T1 2\t\tJ\t1\t\t' \u00d3P,\t\t-F '\n\t\t\tl.ny+l\t\t\u00b1\t\t1\nJ21\tJ22\tJ23\t-\t\t\u00d4P2\t\t-F 2\n\tJ32\tJ33\tJ34\t-\t\t\u00f3p3\t\t-F 3\n\t\t\u2022\tJ n-ny,nb\t\t\u2022\t\t-\nJ\t\t\t\t0\t\t\t\nny,i\t\t\t\t\t\t\t\n\t\tJ\tJ\t,\tJ t t\t\t<5p\t\t-F L\n\t\tnb, nb \u2014 ny\tr>b,nb-1\tnb,nb\t\tnb\t\trib\nFigura CA. 22)\nSistema para Resolu\u00e7\u00e3o da Equa\u00e7\u00e3o da Press\u00e3o\nonde\u00bb i.\n---t bloco C\u00ed=l..ri 2>,\nO\nn X\t\t\u25ba numero\tde\tblocos\tna\tdire\u00e7\u00e3o\tx,\nn y\t\t* n\u00famero\tde\tblocos\tna\tdi r e\u00e7\u00e3o\ty\u00bb\nnb\t\t\u25ba n\u00famero\tde\tblocos\ttotais\tCn. = nx*ny3 e b\t\t\n\t1*1\t1\t\t\t\t\t\n\u00f3p\t= p\t- p .\t\t\t\t\t\n\n\u25ba\n<b\nindica a\ninterface entre os blocos Ci} e\nCk}.\nNo caso deste trabalho as transmi ssi vi dades\nCT> s\u00e3o\ncalculadas no bloco de maior press\u00e3o C\"upstream mobility\"}.\nI\nO \u00faltimo termo da equa\u00e7\u00e3o C4.14} pode ser expandido para:\n*\n\u00f5CcpcD\n~&amp;P\nd<^\tda\n* 3?\nC4. 15?\nou ainda\u00bb\n\n= cr\ndp\n<9al\ndpj\nC4. 16}\nonde a compressibilidade\nda rocha \u00ea definida por:\nc\nr\n1 4>\ndp\nC4. 17}\nO termo\n\u00e9 tratado\nde forma diferente nas\nrefer\u00eancias\n[NFA811, lManSl3 e\nC NghSl], a\nsaber:\n\u2022 ENFA813\nDespreza as derivadas das satura\u00e7Ses e composi\u00e7Ges\nem rela\u00e7\u00e3o \u00e0 press\u00e3o ficando:\nC4. 18}\nonde,\np -------\u00bb densidade molar da \u00e1gua \u00e0 press\u00e3o de refer\u00eancia,\nd -------\u25ba compressl bil idade da \u00e1gua defini da por ,\n203\n213\n\n\u2022 [ManSlJ ----\u00bb\u25a0 Segundo Mansoori, existem certas condi\u00e7Ses de fluxo '\nno reservat\u00f3rio em que as deri vadas das satura\u00e7Ses em reia\u00e7\u00e3o a press\u00e3o n\u00e3o podem ser desprezadas. Deste modo, a utiliza\u00e7\u00e3o da equa\u00e7\u00e3o C4.183 pode resultar em diverg\u00eancia* oscila\u00e7\u00e3o ou converg\u00eancia lenta do m\u00e9todo de Newton C4.12D.\nUma nova formula\u00e7\u00e3o foi apresentada para eliminar estes pr oblemas:\n\u00d5CL \u00e2p\n\u00f4 s\nw\nC4. 233\nCombinando-se as equa\u00e7Ses C2. 133 e C2. 143\npode\u2014se obter:\nV Po \u00ed1 - S J\nPg + V(Po\" Ps)\n\u25ba\nPode-se escrever\u00bb &amp;ntS\u00edo:\nV Pp \u00ed1 - SJ Pg + V(po\u2018 Pg)\nC4. 253\nDerivando-se a equa\u00e7So C4. 253\nem rela\u00e7\u00e3o a\npress\u00e3o\u00bb\nresulta:\nfc(PoSo + PgSJ = C1 - SJ\nC4. 263\n<*[ p\nU 9\n+\nOU\nfe(poS\u00bb * Pg\u00a3j = C1 - SJ \u2022\nonde\u00bb p*\nC4.273\n\u00d5po dp\nV\u2019 =\nV \u201d V\np_______&lt;p-*-<5p >\n<5p\nC4. 283\n* [NghSl1\n+ Segundo\ncasos\npode ser resol vi do\npor um fator de amortecimento Cw3\ni\nl + i\t1\t.\t1\t= 1\npk = pk + w apk\nC4. 293\nonde,\n+ varia\u00e7So de pressSo obtida\npela equa\u00e7So\nC4.123 e\n&lt;L > w\n+ fator de amortecimentos\nC0<wl<13.\nNghiem ressalta a\u00ednda que o m\u00e9todo\nde Manssori\nrequer um\nflash\nadicional para cada bloco em cada itera\u00e7So, aumentando o\ntempo\ncomputaci onal.\nDeve-se\nlevar em considera\u00e7So\u00bb por\u00e9m\u00bb que o fator de\namor teci mento\npode aumentar o n\u00famero de itera\u00e7Bes\u00bb aumentando\ntamb\u00e9m o tempo\ncomputacional.\nNeste trabalho\u00bb o m\u00e9todo utilizado foi o de Mansoori e o\n\"flash\" adicional foi utilizado tamb\u00e9m para calcular p 1\nO\nP\nnumericamente\u00bb assim como foi feito para V* Cequa\u00e7So 4.283.\nA discussSo deste problema est\u00e1 no, item C83.\nNuma an\u00e1lise das equa\u00e7Ses C4.133 e C4. 143 permite concluir\nque como C\u00ab9^otZ'dp3 \u00e9 positivo e C &amp;q Xdp3 e CAq^/^p3 sSo negativos\nou nulos\u00bb o Jacoblano \u00e9 sim\u00e9trico e diagonalmente dominante.\nC6. 63.\n4.3\t- EQUA\u00c7\u00d5ES DAS COMPOSI\u00c7OES\nAs fra\u00e7Ses expli ci tamente a equa\u00e7\u00e3o C4.73.\nmolares na itera\u00e7\u00e3o Cl+\u00b1? \u00bb\tz<l+1>\u00ed s\u00e3o obtidas\nm\nparti r das pressSes pC 1 + 11 uti 1 i zando-se a\nIsol ando-se z L + 4 m\ntem\u2014se:\n&lt;l+i> z m\n{\u00bf(u. * vJ\"Apl\"]\nC4.303\n, O denominador da equa\u00e7\u00e3o anterior pode ser substitu\u00eddo por:\nC4. 31?\ncomponente flca entSo:\n\u25ba\n&lt;l+n z m\n=\t+ vJ\"Apltl]\nq + tf 0nfp s + m Atr\t[ q o\npS)\\\"L\ng gj m j\n* -[A[(T= + Tj\"Apl\u2019!] + %\nS + p S o g ff.\nC4. 323\n+\n+\n\nn\n4.4\ni\n- EQUA\u00c7\u00d5ES DAS SATURA\u00c7\u00d5ES\nAs satura\u00e7Ses na itera\u00e7\u00e3o d+u\ns\u00e3o tamb\u00e9m\nobti das\n(3 primeiro passo \u00e9 calcular P\u00bf+\u00b1\ne + 1 a partir das\nequa\u00e7Ses C4.173 e C4.1S3.\nAp\u00f3s isto, a equa\u00e7So\nSl+1, \u2019resultando:\nw\n\u2014I +1\t| . \u2014 n . L + 1\nS = MT \u00c0p + q + w\t1 V\nVk\t1 Pk\n\u00c3T * p\u00abSv J * Ut *\nL+i l + i]\np.)\nC4. 333\nJ\u00e1 para o c\u00e1lculo das\nsatura\u00e7Ses de \u00f3leo\ne g\u00e1s ,\nexi ste a\nnecessidade de obter +1\t\u201e\nm\nL + i\tL + i\tL + i\nym > p&amp; >\nm\to\tg\nI 4\u00bb 1 V x\nLl + i\nIsto \u00e9 feito por um \"flash\u201d conforme est\u00e1 explicado no\ni tem C 53 .\nSe o resultado do \"flash\" conduzir a vL + \u00a3 = ot\nent\u00e3o,\ne\nC4. 353\nPor outro lado, se\n= 1\nas satura\u00e7Ses se tornam:\n\u201el +1\t.\t_1+1\nS\t=1\t- S\n9\tV\nC4. 363\ne\nO .\nC4. 373\nCaso 0<VL+i<l , as satura\u00e7Ses sSo calculadas a partir das\nequa\u00e7Ses C2.153, C2. 163 e C2.173, resultando:\n\t=\t[ 0 - SJ L p9 1-\tC4. 383\n\t\t[ L * v J '\t\ne\t\t\t\n\tL = i -\t1 - s\t\tC4. 3Q3\n9\tV\to\t\t\nDepois de obtidas todas as propriedades na itera\u00e7SSo Cl+\u00f3, o processo segue para a pr\u00f3xima itera\u00e7So ou o pr\u00f3ximo intervalo de tempo, conforme a converg\u00eancia tenha sido obtida ou n\u00e3o. O crit\u00e9rio de converg\u00eancia est\u00e1 descrito no item C63.\n5\t- EQUIL\u00cdBRIO LIQUIDO-VAPOR - \u2018\u2018FLASH\"\nPara o caso de um modelo totalmente impl\u00edcito\u00bb estas equa\u00e7\u00e3es s\u00e3o incorporadas ao si stema, como na refer\u00e9ncia \u00a3 Coa80] no modelo de Coats,\nNo caso de um modelo sequenclal, assim como qualquer outro modelo n\u00e3o totalmente impl\u00edcito\u00bb o equil\u00edbrio 1\u00edquido-vapor \u00f3 resolvido separadamente, sendo chamado de libera\u00e7\u00e3o instant\u00e2nea ou \"flash\".\nO \"flash\" \u00e9 parte fundamental do modelo e, principalmente na regi\u00e3o cr\u00edtica, ele deve ser eficiente para evitar oscila\u00e7Ses ou diverg\u00eancia.\nO pri mei ro passo para evi tar estas osci1a\u00e7Ses na reg\u00ed So cr\u00edtica foi dado por \u201cFussell and Fussell\" CFF79J , com a introdu\u00e7\u00e3o de um modelo composicional com equa\u00e7\u00e3o de estado c\u00fabica.\n3.1\t- EQUILIBRIO LI QUIDO-VAPOR\nO crit\u00e9rio termodin\u00e2mico do equil\u00edbrio l\u00edquido-vapor em um sistema de CiZ) componentes implica em se minimizar a energia livre de Oibbs, G, de acordo com as equa\u00e7Ses:\ndG\n\u00e2u , ml\n\u00e2G dN\nm\n1 . . . V\nC5. 15\nmv\n\u25ba\nonde, N ,\nml\nN mv\nN\nm\nn\u00famero\tde\tmol es\tdo\tcomponente\tm na\tfase\t1\u00edquida\nn\u00famero\tde\tmoles\tdo\tcomponente\tm na\tf ase\tgasosa\nn\u00famero\tde\tmoles\tdo\tcomponente\tm\t\t\nComo N + N = N\nml mv\tm\npode ser mostrada que:\n<SG\t\u00e2G\t_ =\n5N ,\tdN\tml\nml\tmv\n- G mv\nC5. 25\nonde, G , mL\t\tk ener gi a\t1 i vre parei al mol ar\tde\tGibbs\tdo\n\tcomponente\tm na fase l\u00edquida,\t\t\t\nG\t\tk ener gi a\tlivre\tparcial molar\tde\tGibbs\tdo\nmv\ncomponente m na fase gasosa.\nA diferen\u00e7a G - G , para temperatura constante, pode ml\tmv\nser relacionada com as fugacidades dos elementos como se segue:\nf\t\t\nG - G - NRT In\t, ml\tmv\tk\tI mv\ti. = 1 ... 1\u00bb,\tCS.35\n\u25a0~>nde\u00bb f\nmv\nr\nmL\n---\u25ba fugacidade do elemento m na fase gasosa\u00bb\n---\u00bb fugacidade do elemento m na fase l\u00edquida,\n----k n\u00famero de moles.\n+ Temperatura.\n\u2014-\u2014+ Constante Universal dos Gases\nO conceito de fugacidade foi introduzido pois \u00e9 uma medida\nN\nR\nNo equil\u00edbrio termodin\u00e2mico, a transfer\u00eancia de massa entre as fases \u00e9 nula, o que exige:\nou ai nda,\nf mv\tCS. 43\ni - 0 .\tCS. 53\n\u25a0J\t\nOs coeficientes de fugacidade para cada fase podem ser\ndefi ni dos como:\nPL = fL/p -\nCS. 63\nf> = f /p\nV\tV\nCS. 73\nPara uma mistura de C v 3 componentes, a rela\u00e7So pode ser estendida usando-se as fra\u00e7Ses molares:\n\u2019\u2019ml. = fmlZ(P\t\u2019\nCS. 83\nCS. 93\nDas equa\u00e7Ses CS.43, CS.83 e CS.93:\nou.\nou ainda,\nonde, K m\nPnl P\nP P mv\nP mv\nrn\nP m\nP~ mv\nC5. 103\nC5.113\nC 5. 123\n+ constante\nde\nequil\u00edbrio\n11qui do-vapor.\nK m\nX m\n>\n\u00bb\n\n\n\nA\n5.\t2 - EQUA\u00c7\u00d5ES DE ESTADO\nAs equa^Ses de estado sSo usadas para cal cul ar as T'ugacidades dos elementos em cada fase. As equagSes de estado de melhor resultado e mais discutidas na literatura sSo as de Peng-Robinson e Soave-Redlich-Kwong, ambas modificagSes da equagSo de Van der Waals.\n5.2.1\t- PENG-ROBINSON CPR3\nA relapso PVT assume a forma:\na\nVCV + b3 + bCV - b3 \u2019\nCS. 133\nonde.\nb = 0.07780\nRT\n1\np-c\nC5. 143\n^2\u201e2 R T\naCT3\t= O.45724\tc \u2014p\t a >\tC5. 153\not\u00b0' 5\t= 1 + mfl\t- T\u00b0\u2018\t,\tC5. 163\n\t\tr J\t\n\t\t\t\nm = O.37464\t+ 1.54226\tto - 0. 26992 \u00fc)2 ,\tC5. 173\n\t\tN b\u00b0* 5 m thL m\t\n\t<J\u00d2\t\tC5.183\n\t\t\u00a3 N b\u00b0- 7 ml m m\t\n\t\t\u00bb fator\tac\u00eantrico da mistura,\t\nu m\t\t> fator\tac\u00e9ntrico do componente m,\t\nb m\t\t\u25ba constante de equa\u00e7So de estado Cfun\u00e7So\t\tde T e P 3 c\te\ne , N ----------\u25ba n\u00famero de moles do componente m na fase l.\nmL\nCom a introdu\u00e7So do f\u00e1tor de compressibil idade CZ=pv/RT3, a\nsegui nte equa\u00e7So c\u00fabi ca \u00e9 obti da:\nZa - Cl - B 3Z2 + CA - 3B2 - 2B3Z - CAB - B2 - B33 = O C5. 193\nonde, A = \u2014t\u2014\n2 2 R T\nR = bP\nB RT\nb\na = \u00a3 \u00a3 x xa ,\n, m l ml m l\na = (1 - 6 J a a\t,\nmt v\tml/ m\tL\nm\t >\tcomponente,\nl ------\u00bb\tfase,\n<5\t \u25ba\tcoeficiente\tde itera\u00e7\u00e3o bin\u00e1rio e\t*\nml\na , a , a --------\u00bb constantes da equa\u00e7\u00e3o de estado, fun\u00e7Ses\nml\tl\tm\nde p , T e w.\nG\tC\nO coeficiente\tde fugacidade p\t, m\tpara\tcada\tfase, \u00c9\t\u00a3 dado\npor:\t\t\t\t\t\nln = et(z - 9\t- 1 n f7 - Pl -\tpF\tV 1 L ml\tb 1 m\t\u2022\n\t(\t5 arSB\t1\ta\tb\t\n. ln|z +\t+ 13B1\n[z - ClTS - 13 Bj\n5.2.2\t- SOAVE-REDLICH-KWOMG CSRK3\nDa mesma forma\u00bb pode-se escrever para SRK,\nonde,\n08664\n42747\nRT\nfr\no.\n\u00ed\u00f4 - O. 176 oi2\nC5. 22}\nC5. 23}\nC5. 16}\nC5. 24}\n+\n1.\n\u00bb\n\u25ba\nA equa\u00e7So c\u00fabica do fator de compressibilidade fica:\n\tZ3 - Z2 + CA - B - B2}Z\t\t- AB = 0\t\tC5. 25}\nE o\tcoeficiente de fugacidade\t\u00e9\tdado por:\t\t\nb\t\tI\"2\tE xia. .\t1 Lm\tb 1\t\u2022d1+D\nln\t= ET\t\u2022 CZ - 1} - ln CZ - Bl - 1\t\tL\tm\t\n\t\t\tb\td\t\nCS. 26}\nAs constantes s\u00e3o as mesmas da equa\u00e7So de CPR}.\n5.3\t- O \"FLASH\"\nO c\u00e1lculo do equil\u00edbri o 1\u00edquido-vapor tem como ~ objeti vo\nprincipal, a determina\u00e7\u00e3o das fra\u00e7Ses molares dos componentes e\nUtilizando-se a defini^So da constante de equilibrio,\nC5,123, as equatjSes C2. 123,\tC2.163 e C2.173 podem ser combinadas\npar a f or necer :\ndas fases.\n\tz\t\n\t\tC5. 273\n\tm\t1 + VCK - 13\t\n\tm\t*\ne\tz K\t\n\tm m\tC5. 283\n\tym\t1 + VCK - 13 m\t\nDa equa^So C2.213 pode-se escrever\ngCV3\n- \u00bfy,\nm= 1\nX m\nC5.293\n= O .\nDas equa^Ses C5. 273 , C5. 283 e C5.293 vem:\nC5. 303\nSe F \u00e9 a razSo de fugacidades, segue-se que : m\nF\nm\ne, no equi11 br i o,\nf rnv\nF - 1\nm\nou ainda\u00bb\n0\nC5. 325\n\t fmlz\u00edp\t\t-F \u00ed m X i\nm\t<p mv\tfmvZ\u00cdP\tym)\t\nCS. 335\nUma vez obtidos os valores de K , V \u00e9 obtido de equa\u00e7\u00e3o m\nC5. 305 e as fra\u00e7Ses molares x e y s\u00e3o calculados a partir das TY1\tYtl\nequa\u00e7Ses CS. 275 e C5. 285 .\tk\n(5 processo de obten\u00e7\u00e3o de K \u00ab\u00e1 iterativo, e uma estimativa\ninicial pode ser dada pela rela\u00e7\u00e3o de Wilson:\nK m\n1\nP r m\n3727\nC5. 345\nonde, P --------\u00bb press\u00e3o reduzida\nr m\nT -------\u25ba temperatura reduzi da\nr m\nO novo valor de K \u00e9 obtido da rela\u00e7\u00e3o dos coeficientes de m\nfugacidade calculados pelas equa\u00e7Ses de estado CS. 205 ou C3.265.\n, A converg\u00eancia do flash \u00e9 obtida quando:\n1\nE fF - i)2 &lt;\u00c9\n\u201c v m\tc\nC 5. 365\nO valor de c est\u00e1 discutido na refer\u00eancia'[TL293J.\nDepois que o equil\u00edbrio \u00e9 atingido a densidade de cada fase\npode ser calculada a partir do fator de compressibilidade CZ5:\ncorrela\u00e7Ses que podem ser encontradas nas refer\u00eancias [BurTSJ\u00bb\n[ABW601 e [MC73] ou ainda na refer\u00eancia \u00a3 JS\u00cdS8].\t\u25ba\n6\t- T\u00d3PICOS ESPECIAIS\n\u25ba\n6.1\t- PERMEABILIDADE RELATIVA\nPara o c\u00e1lculo da permeabilidade relativa \u00e0s tr\u00eas fases, dois modelos de Stone t\u00eam sido mais comuns na literatura.\nOs dois modelos assumem que a permeabi1 idade reiati va a \u00e1gua \u00e1 f un\u00e7So apenas da satur a\u00e7\u00e3o de \u00e1gua, a permeabi1i dade relativa ao g\u00e1s \u00e9 fun\u00e7\u00e1o apenas da satura\u00e7\u00e3o de g\u00e1s e que a permeabilidade relativa ao 61 eo 6 fun\u00e7So das satura\u00e7Bes de \u00e1gua e g\u00e1s, ou seja:\n\tk rw\t- f(sJ \u2022\tC6.13\n\tk rg\t-'(%) \u2022\tC6. 23\ne\t\t\t\n\tk\t= ffk\t\u00bb Jc\t> 1c\t\u00bb k 1 >\tC6. 33\n\tro\trow\trog\trg\trvj\t\nonde.\t\t\t\n\tk r ou\t\u2018 f(so)\t\u2022\tC6. 43\nk r og\nC6. 53\nS = S + S L>\tO\tV\nC6. 63\nS = S + S h\to\tg\nC6. 7?\nOs vai ores de k , k t rov rog\nk e k s2lo tabelados &amp; usados rg\trv\ncomo entrada do programa. Um exemplo desta tabela pode ser visto\nno anexo CD? \u00bb nos dados de entrada dos os exemplos uti1izados\n* neste trabalho.\nAs expressS\u00e2s de k para os dois modelos s\u00e3o: r o\nModelo Cl?\nk = k fSl+k \u00cdS } - k fl \" S ) + { [S 1 Fk (1 - S ) -ro\trow v\trog &lt;L-7\trov V-\tves\tI t L.J I row V-\tvc^\n- * (sjlL (1 - S ) - k (SjlA fl - S ]ll C6. 8? r ov v. h'/ I | row*-\tvc-J\trogv I.-7 I\tt rowv\tvc-7 J |\nModelo CS?\n+ k\u201e(Si] +\t*\n-\t- M} \u25a0 Msv)+\nonde, S\nve\n+ Satura\u00e7\u00e3o de \u00e1gua conata.\nvaior es de k\tmai or es\nr o\nque 1.0,\nque pode acontecer em certos\ncasos.\nSe as equa\u00e7Ses C6. 93 e C6.S3 levarem a valores negativos de k faz-se Ck =03.\nra\tro\n6.2\t- MODELO DE PO\u00c7O\nO modelo proposto pode conter po\u00e7os em qual quer bloco da grade.\nPar a os po\u00e7os i nj etor es, a vaz\u00e3o molar de cada elemento deve ser especificada e, de acordo com a formula\u00e7\u00e3o apresentada, devem ter valores positivos.\nPara os po\u00e7os produtores podemos ter dois casos:\n\u2022 vaz\u00e3o volum\u00e9trica das fases\t\u00bb Q^) especificadas\nNeste caso as\tvaz Ses molar es\tdos\telementos devem ser\ncalculadas da seguinte\tmaneira:\t\t\n\tq = p Q V\tw\t\tC6.103\ne\t\t\t-\nQ = m\tn\tn\t.\tn\tn X p Q + y p moo\tmg\tQn g\tC6. 113\n\u2022 produ\u00e7\u00e3o a pressSo constante\nO valor de IP, constante, pode ser fornecido na entrada de dados, anexo CD3. Se o vai or fornecido na entrada de dados for zero, ele ser\u00e1, calculado da seguinte maneira Csegundo a refer\u00eancia EPedB413 .\nTO \u2014\th\t\tk C6. 123\n1 n ir Zr v o\t\t\nr = O. 14 Ax \u00a31 +\t\u201c ] \u2022\tC6, 133\nAx\t1\t\t\n\u201c \" \u00c3y \u2019\t\u00e3 -\ta &lt;2\tC6. 143\nh = Az\t\tC6.153\nDepois\nde cal cul ado o vai or\nde IP,\nas vazSes molares s\u00e3o\ndadas por:\nf\tk p\tk P\t1\t.\t.\t\t\t\n% = IP[\tr O o\t+\t* y mJ\tl(t\t\u00bb\tC6. 163\nC6. 173\nC6.1S}\nC6. 19}\nonde, p \u00e9 a press\u00e0o no fundo do po\u00e7o especificada.\nAs derivadas das\nvazSes em r ela\u00e7\u00e3o \u00e0 pr essSo\nde equa\u00e7\u00e3o\nC4.14} s\u00e3o:\n4\nC6. 20}\ne\ndq,\tv ~ h \u201c IP y\tfk p\tk p\t} X +\t'9 9 y\tC6.21}\t\n4\tfu\tW\u00ed\tu\tml\t\t\n\tIo\t9\tJ\t\t\nPara o caso de vaz\u00e3o constante as derivadas s\u00e3o nulas pois as propriedades s\u00a3o calculadads no intervalo de tempo Cn\u00ed.\nUma outra possibilidade \u00e9 calcular a vaz\u00e3o a cada itera\u00e7\u00e3o a pcrtir dos dados da itera\u00e7\u00e3o anterior CD. Isto foi testado com sucesso, diminuindo inclusive a pequena oscila\u00e7\u00e3o na produ\u00e7\u00e3o de \u00f3leo.\n6.3\t- BALAN\u00c7O DE MATERIAIS\nk\nO balan\u00e7o de materi ai s \u00e9 um 1mpor tante i nstrumento par a testar a ef i ci \u00eanci a do modelo, assi m como para a vaii dade do crit\u00e9rio de converg\u00eancia.\nO modelo est\u00c1 baseado no balan\u00e7o de moles de cada elemento dentro de cada bloco da grade. O balan\u00e7o de materiais \u00e9 usado para verificar se a varia\u00e7So de moles no reservat\u00f3rio \u00e9 igual \u00e0 vazSo de moles nos po\u00e7os.\nO erro, em n\u00famero de moles pode ser calculado como:\n\u2022 para os hidrocarbonetos\nerro C?O = 100\nm\nS x o m\n\n- *\"\t- pgV J\"] + At)} * v\u201e\nm ~ 1. . . v\nC6. 223\n\u2022 para a \u00e1gua\nerro\n233\nonde.\nV \u00e9 o n\u00famero de moles inicialmente no reservat\u00f3rio, m\n6. 4\nCRIT\u00c9RIO DE CONVERGENCIA\n\nNa refer\u00eancia ETLS83] o crit\u00e9rio de converg\u00eancia usado \u00e9\nbaseado nos res\u00edduos do balan\u00e7o de moles de cada componente, ou:\n|MIPl+1 - MIPn + fVL VN1*4\n1 m\tm v b m\nAt\nlYl\u00fcX\nC6. 243\nonde, MIP\n-\u2666 n\u00famero de moles Inicial do reservat\u00f3rio Cmoles\n\"in place'*3\nN --------\u25ba f1uxo molar superf i ci al do componente m\nTA\n\u2014 4\t\u2014 S\n\u00a3\t----\u00bb varia de 10 a 10\nO\nPor\u00e9m, para o caso espec\u00edfico deste model o, a mesma refer\u00eancia sugere um teste de converg\u00eancia baseado na itera\u00e7So da pressSo.\nO crit\u00e9rio de converg\u00eancia usado foi, entSo foi baseado na\nOU:\nonde,\n1 Kl2&lt;c\nL - 1\n- \u25a0 \u00a1 -X K+ VJ\nC6. 253\nC6. 263\n\u00a3\t---\u00bb varia delf\u00edaO. Ol\u00ed\u00ed .\nn. inj\nblocos de inje\u00e7\u00e3o .\nmoles de produ\u00e7\u00e3o.\nOs efeitos da varia\u00e7\u00e3o de\n\u00a3 est\u00e3o descritos no item\nC82>\n6.5\t- MODELO RADIAL\nO model o pr oposto pode\nser di screti zado para o\nfl uxo\n&amp;\nradial. A equa\u00e7\u00e3o CS. 95\u00bb pode\nser\nescrita do seguinte modo:\n1 \u00a3_\u00edrX \u00caE r ar L ar\n*v\nat\nC6. 275\n+\nA equa\u00e7\u00e3o discretizada\u00bb de\nacordo com as mesmas condi \u00e7Ses\nmencionadas no cap\u00edtulo C35\u00bb fica:\ni U r Ar I L+i/2 v L\nn+ 1\nr.\trl^../Al + X\"\nL+i/zIr - r. I L-i/2 l '-+1 U\nn+ 1\n-.[fert] ]\u2022\n+\n\u00bf[(*\t(* PA]\"] \u2022\nC6. 28?\nDef ine-se\no volume d\u00f3 bloco CV 3, o volume discretizado do D\nbloco CV 3 e o raio de curvatura r. pela aproxima\u00e7\u00e3o da m\u00e9dia d\tt+1/2\t\u25a0\nlogar\u00edtmica como se segue:\nV = n\u00edr2\nb\t1.+1/2\nrZ iXz\n1.-1/2J\nCS. 2Q3\nr.\nL+l/Z\nz\n\u00cd+1ZZ\n1 nC r .\tZr . 3\nt +1 t\nC6. 313\n2 2 r .\t- r ,\nL +1\tL\nr\n1 nC r .\tZr . 3 Z\nv + i v\nC6. 323\nMuiti pi i cando-se os termos de acumula\u00e7\u00e3o e fontes pel o\nvolume e o termo de fluxo pelo volume discretizado, obtem-se:\n- \u00a3\t(M\"l \u25a0\nC6. 333\nDefinindo-se ainda\u00bb\n2nAzX .\tr1* ,p\t_\tli+l/Z i + i/2\t2nAzX, , \t1-V + 1Z2\t\ni\u00ed+\u00b1z2\tr.\t- r. L + i\tL\tlnCr. Zr.3 i + i\ti\t\u00bb\nC6.343\na equa\u00e7\u00e3o final fica equivalente \u00e0 equa\u00e7\u00e3o C3. 63 * com varia\u00e7\u00e3o apenas no c\u00e1lculo das transmissividades e do volume CVb3.\nQuando a equa\u00e7\u00e3o C 3.63 \u00e9 resolvi da numericamente, blocos menores s\u00e3o necess\u00e1rios \u00e0 medida se aproxima do po\u00e7o. Isto resulta em uma grade altamente irregular.\nUma manei r a de se evi tar esta gr ade i r r egular \u00e9 a\nA equa\u00e7\u00e3o C6.273 pode ser escrita como;\nS\u00e7Us- 3\u00bf\\\t+ 5t = fcHsJ\nC6. 333\nA equa\u00e7\u00e3o final \u00e9 a mesma\ncom diferen\u00e7a apenas\nnos ter mos\nde transmissividade que ficam:\n2nAzk\n_\t_\tU +1/2\nL\u00cd.-H/2 \u00c7 .\t- \u00c7 .\ns t + 1\tv\nO espa\u00e7amento regular pode ser fei to atrav\u00e9s de;\n\u00bfF = Cln r - 1 n r 3/n,\no\tw\to\nonde.\nraio externo do reservat\u00f3rio .\nr\nC6. 363\nCG. 373\nDa mesma forma que para cada fase C\u00dc\u00bb pode-se escrever as equa\u00e7Ses de fluxo radial para cada hidrocarboneto. Elas ser\u00e3o semelhantes \u00e0s equa\u00e7Ses C3.73 com di feren\u00e7a nos ter mos de transmissividade &amp; no volume do bloco.\n6.6\t- RESOLU\u00c7\u00c3O DO SISTEMA\nA equa\u00e7\u00e3o CA. 123 resultante do m\u00e9todo de Newton determina a solu\u00e7\u00e3o do sistema penta-diagonal mostrado na figura 4.1. Para a resolu\u00e7\u00e3o deste sistema, o programa utiliza a subrotina GBAND da refer\u00eancia \u00edAS7Q], que \u00e9 um m\u00e9todo de el i mi na\u00e7\u00e3o de Gauss sem pi voteamento e pode resolver si stemas com qual quer n\u00famero de bandas, ou di agonai s.\n*\nPara os problemas de uma dimens\u00e3o, incluindo o radial, o sistema passa a ser tri-diagonal. Para estes casos, o algoritmo utilizado foi o de Thomas, que \u00e9 tamb\u00e9m uma forma de elimina\u00e7\u00e3o de Gauss.\nPara alguns casos, o sistema pode ser mal condicionado, principalmente os de vaz\u00e3o constante onde as derivadas da vaz\u00e3o em rela\u00e7\u00e3o \u00e0 press\u00e3o s\u00e3o nulas. Nestes casos o determinante da matriz Jacobiana \u00e9 pr\u00f3ximo de zero, fazendo com que a resposta oscile em torno da solu\u00e7\u00e3o real. Para certos casos, a converg\u00eancia pode nem ser atingida.\nUm artif\u00edcio matem\u00e1tico simples para se evitar esta oscila\u00e7\u00e3o est\u00e1 descrito na refer\u00eancia CPFTVS01. Supondo que o sistema a ser resolvido seja:\n[ AKu> =&lt;b> ,\tC6. 383\nse a matriz [AJ for mal condicionada, a solu\u00e7\u00e3o&lt;u> ser\u00e1 acrescida de um&lt;<5u>, resultando tamb\u00e9m em um&lt;\u00f3b> , ou seja:\n\n[AK\u00d3u> =&lt;\u00f3b> ,\nCG. 403\nde onde pode-se determi nar o valor de&lt;\u00f3u> que deve ser subtrai do da resposta inicial.\nA implementa\u00e7\u00e3o deste artif\u00edcio fez n\u00e3o s\u00f3 com que certos casos passasem a convergir, como diminuiu bastante o n\u00famero de itera\u00e7Ses necess\u00e1rias nos casos que j\u00e1 convergiam.\n6. 7 - CONTROLE DO INTERVALO DE TEMPO\nO contr ole do i ntervaio de tempo \u00e9 fei to na for ma convencional baseado nas varia\u00e7Bes m\u00e1ximas de press\u00e3o, satura\u00e7\u00e3o ou composi\u00e7Ses\u00bb e nos 1 imites estabelecidos para estas vari\u00e1veis\nSe todas estas vari\u00e1veis forem menores que seus limites, o pr \u00f3xi mo i nter vai o de tempo aumentar Ar az\u00e3o deste cr esci mento 6 a menor raz\u00e3o entre o limite estabelecido e o m\u00e1ximo calculado para ca'4\"' vari\u00e1vel.\nPor exemplo, se a menor raz\u00e3o for a da satura\u00e7\u00e3o de g\u00e1s:\nC6. 413\nexpli car melhor \u00bb admi te-se que* por exemplo * o caso mai s cr\u00ed ti co\nseja o de press\u00e3o\u00bb ou seja:\n\nmax\nC6. 423\n\u00e9 apli\u00e7ado um valor\nde seguran\u00e7a Ct?3 que deve ser aproximadamente Cl.33.\n\u00a3e\no pr\u00f3ximo intervalo\nde tempo\n*\ndimi nuir\u00e1\ndo seguinte modo:\nAtn+i\nAtn\nT\u00e3p f\n1 TY1O.X 1\nC6. 433\nSe\no pr\u00f3pr i o i nter vaio de tempo \u00e9\nc~\u00bblcul ado\nnovamente\nmas com um valor novo* usando\u2014se a equa\u00e7\u00e3o\nanterior\nC6. 433.\nO\ni nter vaio de tempo deve di mi nui r tamb\u00e9m quando h\u00e1\numa\nprevis\u00e3o\nde condensa\u00e7\u00e3o retr\u00f3grada.\n6. 8 - MODELO DE HELFFERICH\nUm modo de se validar o modelo \u00e9 atrav\u00e9s da' obten\u00e7\u00e3o de uma solu\u00e7\u00e3o anal\u00edtica, obtida a partir de algumas simplifica\u00e7Ses, e a compara\u00e7\u00e3o com a resposta deste modelo [H\u00e8l813. Admitindo-se que:\ne\n\u00a3 = 0 ,\nw\n\u00ed\nCS. 445\np\t= u = constante ,\tC6. 455\no\tg\t\np = p = constantef\nk = S2 ro\to\nCS. 465\nC6. 475\nk = S2 ,\tC6.485\nr\u00e7r\tg\ne que o \"flash\" tenha como resultado valores constantes das fra\u00e7\u00f5es molares do 11qui do e do g\u00e1s\u00bb e ainda reduzi ndo-se par a dois o n\u00famero de hidrocarbonetos, pode-se obter uma solu\u00e7So anal\u00edtica.\nNo item C7. 35 pode-se verificar a compara\u00e7\u00e3o entre os resultados do modelo e a solu\u00e7\u00e3o anal\u00edtica, obtidos a partir destas considera\u00e7Ses.\n7\t- RESULTADOS\nO erro no balan\u00e7o de materiais foi feito para todos os casos e n\u00e3o est\u00e1 mencionado para cada um em particular pois apr esentou vaior es acei t \u00e1vei s\u00bb sendo de no m\u00e1ximo da or dem de\n_g\n10\t. De manei r a geral * os erros eram mai ores nos bl ocos onde\nestava a frente de g\u00e1s ou \u00e1gua injetados ou quando havia uma maior varia\u00e7\u00e3o das satura\u00e7Ses.\nO n\u00famero de hidrocarbonetos dos casos testados foi de no m\u00e1xi mo tr\u00eas poi s* embora o programa acei te um n\u00famero mai or de -imponentes, este n\u00e3o \u00e9 o objetivo deste trabalho.\nEm todos os casos apresentados\u00bb a varia\u00e7\u00e3o da satura\u00e7\u00e3o de \u00e1y ua se deve exclusivamente \u00e1 varia\u00e7\u00e3o de press\u00e3o pois a \u00e1gua n\u00e3o flui entre os blocos.\nO efeito da utiliza\u00e7\u00e3o da formula\u00e7\u00e3o '*2\u2014point upstream\" para as fra\u00e7C\u00edes molares Cx e y D est\u00e1 descrito no caso C1D.\nm\tTn\nO m\u00e9todo \u00e9 comparado com uma solu\u00e7\u00e3o anal\u00edtica* obtida a pirtir de certas simplifica\u00e7\u00f5es, como pode ser visto no caso C3D.\nEste caso \u00e9 um exemplo da refer\u00e9ncia E TLS82] que compara os m\u00e9todos de ENFA811, EYS83] e ECoaSO]. E um caso unidimensional e os dados deste problema est\u00e3o nas tabelas C7.1.13 e C7.1.23.\nAs figuras de C7.1.13 a C 7. 1.63 mostram uma compara\u00e7\u00e3o do presente m\u00e9todo cora o simu\u00ed ador \"COMP3\u201d da PETROBR\u00c3S. Para esta compara\u00e7\u00e3o o intervalo usado foi de 3 di as e o reservat\u00f3rio foi dividido em 20 blocos. Os resultados s\u00e3o bastante pr\u00f3ximos e a diferen\u00e7a na satura\u00e7\u00e3o de \u00f3leo deve-se principalmente aos diferentes modelos de permeabilidade relativa. A produ\u00e7\u00e3o total de \u00f3leo \u00e9 bastante pr\u00f3xima nos dois casos mas a produ\u00e7\u00e3o em cada intervalo de tempo apresenta uma oscila\u00e7\u00e3o nos resultados do COMP3 e isto n\u00e3o acontece neste modelo. Esta oscila\u00e7\u00e3o acontecia antes do dispositivo explicado no \u00cdtem 6.6.\nUm outro ponto i mportante que deve ser menci onado \u00e9 a presen\u00e7a de dispers\u00e3o num\u00e9rica no presente m\u00e9todo. Todos os modelos apresentados nas refer\u00eancias demonstram uma preocupa\u00e7\u00e3o constante com este pr oblema, e a \u00fani ca manei r a encontr ada par a\nL\nameniz\u00e1-lo foi a utiliza\u00e7\u00e3o de formula\u00e7\u00e3o \"2-point upstream\" para as composi\u00e7Ses.\nEste tipo de formula\u00e7\u00e3o, por\u00e9m, traz um outro tipo de problema como pode ser verificado na figura C7.1.23 e \u00e9 conhecido como \"overshoot\" e \u201cundershoot\". A limita\u00e7\u00e3o imposta no item 3, equa\u00e7\u00e3o C3.1O3, diminui bastante este problema Cver figura 7.1.33.\nO que deve ser pesado, \u00e9 o fato de que \u00e0 medi da que se aumenta o n\u00famero de blocos, a dispers\u00e3o num\u00e9rica diminui mas este problema se agrava. O n\u00famero de blocos a ser utilizado, ent\u00e3o.\ndeve ser escolhido com cuidado.\n*\nTabela 7.1.1\nDados\nCaso 1\nVARI\u00c1VEL\tUNIDADE\tVALOR\ncompri mento\tCm3\t76. 2\n\u00e1rea transversal\tCm2)\t464. 5\npermeabi1i dade\tC md3\t2000\nporos\u00ed dade\t\t0. 3\ncompressibilidade da rocha\tClZpsiO\t4x10_<S\ncompress!bi 1idade da \u00e1gua\tClZpsi3\t3x1 O_d\ntemperatura\t\u00b0F\t160 *\nsat' a\u00e7Ses i ni ci ai s CS \u00bb S , S D o\tg\tv\t\tC0. 8, 0. 0, 0.23\npress\u00e3o inicial e de produ\u00e7\u00e3o\tCpsi)\t2000\n\u00cdndice de produtividade\t3 C f t \u2014cpZdi a-psi 3\t1.012X105\ntempo final\tCdias3\t210\nc omposi\u00e7So i ni c i al CC , nC , nC 0 \u00ed\t4\tIO\t\tC0. 2, 0.2, 0.63\nTabela 7.1.2 : Inje\u00e7\u00e3o - Caso 1\nVARIAVEL 1\tUNIDADE\tVALOR\ninje\u00e7\u00e3o de g\u00e1s\tCMSCFZdiaO\t83,5\n\tCKmolZdia3\t\u00cdOO\ncomposi\u00e7\u00e3o de g\u00e1s injetado CC , nC 3 1\t4\t\tCO. 8, 0.20\n1.0\n+ METANO NFA\nx METANO C0MP3 o DECANO NFA\n\u2666 DECANO COMPS\n0.8 -\nCOMPOSiCAO\nTEMPO (d)\nFigura 7.1.1 : DistribuigSo das ComposigSes no Tempo.\nComparagSo do Modelo CNFA3 com o \"COMP3'\u2019.\nCBloco de injegSoi.\n1.0\n+ METANO NFA x METANO C0MP3 o DECANO NFA\n* DECANO C0MP3\n0.8 -\nCOMPOSICAO\no.o H i i i i i i i i i\n0.0\t0.2\t0.4\t0.6\t0.8\t1.0\nDISTANCIA ADIMENSIONAL DO BLOCO DE INJECAO\nFigura 7.1.2 : Distribui\u00e7\u00e3o das Composi\u00e7Ses nos Blocos.\nCompara\u00e7\u00e3o do Modelo CNFA3 com o \"C0MP3\".\nC21O diasD.\n1.0\n4- METANO NFA x METANO C0MP3 o DECANO NFA\n* DECANO C0MP3\n0.8 -\nCOMPOSICAO\no.o H !\t] i i i i i i i\n0.0\t0.2\t0.4\t0.6\t0.8\t1.0\nDISTANCIA ADIMENSIONAL DO BLOCO DE INJECAO\nFigura 7.1.3 :\nDi str i bui \u00e7\u00e0o das Composi \u00e73es nos BIocos.\nCompara\u00e7\u00e3o do Modelo CNFA2) com o \"COMP3\" sem a\nLimita\u00e7\u00e3o da Equa\u00e7\u00e3o C3.1O3.\nCOMPOSICAO DO BUTANO\nFigura 7.1.4 : Compoai\u00e7So do Butano C210 dias5.\nEfeitos da Limita\u00e7\u00e3o da Equa\u00e7\u00e3o C3.103.\nCOMPOSICAO DO BUTANO\nFigura 7.1.5 : Composi\u00e7\u00e3o do Butano CEIO dias?.\nEfeitos da Varia\u00e7\u00e3o do N\u00famero de Blocos.\n1.0\nx NFA o C0MP3\n0.8\nSATURACAO DE OLEO\n0.6\n0.4\n0.2 -\no.o H\t 0\t\ti\t1\t 50\t100\t'\t150\t\tr- 200\n\t\t\tTEMPO (d)\t\nFigura 7.1.6\nSatura\u00e7\u00e3o de \u00d3leo no Bioco de Inje\u00e7\u00e3o.\nCompara\u00e7\u00e3o do Modelo CNFAD com o \"COMPS\".\n7.2\t- CASO 2- CONDENSA\u00c7\u00c3O RETR\u00d3GRADA\nDevido \u00e0 particularidade dos dados de produ\u00e7\u00e3o, a press\u00e3o e a temperatura permanecem aproximadamente constantes para cada bloco, ocorrendo varia\u00e7\u00e3o apenas na composi\u00e7\u00e3o dos hidrocarbonetos. Deste modo, como o fluido injetado \u00e9 mais rico em elementos mais leves, espera-se que a satura\u00e7\u00e3o de g\u00e1s aumente no bloco de inje\u00e7\u00e3o.\nCom a composi\u00e7\u00e3o de inje\u00e7\u00e3o da tabela C7.3D, isto ocorre at\u00e9 certo ponto, quando a satura\u00e7\u00e3o de \u00f3leo come\u00e7a a aumentar, como pode ser verificado na figura C7. 2. 1D.\nPara os pontos CID e C2D desta figura, foram tra\u00e7ados os envelopes de fase, figuras C7. 2. 2D e C7. 2. 3D \u00bb pelos quais se verifica a condensa\u00e7\u00e3o retr\u00f3grada.\nO maior problema da ocorr\u00eancia deste fen\u00f4meno \u00e9 o fato de que\u00bb como as trasmissividades s\u00e3o calculadas no intervalo de tempo anterior, esta invers\u00e3o no comportamento das satura\u00e7\u00f5es faz com que o modelo apresente uma certa oscila\u00e7\u00e3o. Isto pode ser verificado na figura C7.2.1D.\nLima maneira de se evitar esta oscila\u00e7\u00e3o \u00e9 atrav\u00e9s da diminui\u00e7\u00e3o do intervalo de tempo ap\u00f3s a previs\u00e3o da ocorr\u00eancia do fen\u00f3meno. O controle autom\u00e1tico do intervalo de tempo encarrega\u2014se naturalmente de lev\u00e1-lo novamente ao n\u00edvel anterior.\nIsto pode ser comprovado pela f igura . C 7. 2. 1D onde os dados\n63\ndiminui para 0.5 dias. A oscila\u00e7So diminui bastante.\nTabela 7.2 : Dados de inje\u00e7\u00e3o- Caso 2\nVARI\u00c1VEL\tUNIDADE\tVALOR\ninje\u00e7So de g\u00e2s\tC MSCF/di aD\t62, 5\n\tCKmolZdi a3\t74,8\ncomposi\u00e7So de g\u00e1s injetado CC , nC 3 i\t+\t\tCO. 8, 0.23\n1.0\nSATURACAO DE OLEO\nFigura 7.2.1 : Satura\u00e7\u00e3o de Oleo - Condensa\u00e7\u00e3o Retr\u00f3grada\nEfeitos da Varia\u00e7\u00e3o no Intervalo de Tempo.\nCBI oco de inje\u00e7\u00e3o!).\n1*7700 0NV33QPI9ZC0 ONVinQVlOSg O ONV13H1\n0V'JIS0dH03 V V8Vd S3SV3 30 3dO13AN3 ZZi DIJ\nIdo I WlVkJ3dW31\nPRESS\u00c3O IPSII\nPRESS\u00c3O (PSI)\nFIG. 7.2.3 ENVELOPE DE FASES PARA A COMPOSICAO\n(METANO 0 692),I0UTANO 0303) e (DECANO 0-051\n7.3\t- CASO 3- MODELO DE HELFFERICH\nAs tabelas de dados para esta compara\u00e7\u00e3o s\u00e3o a C7. 3. 12) e a C7. 3. 22) , de onde se obt\u00e9m os resultados mostrados nas figuras C7. 3. 12> a (27. 2. 22) , para um deslocamento de 50?\u00ed do volume poroso.\nA diferen\u00e7a entre as formula\u00e7Ses \"2-point upstream\" e \"1\u2014point upstream'* se faz presente nos blocos onde se encontra a regi\u00e3o de duas fases. Os resultados do \"2-point upstream\" s\u00e3o 1 igei ramente mel hores.\nA varia\u00e7\u00e3o de 20 para 80 blocos causa uma grande diferen\u00e7a nos resultados. Para 80 blocos o resultado \u00e9 bem pr\u00f3ximo do anal\u00edtico equanto que para 20 blocos os erros s\u00e3o razoavelmente andes.\nDeste modo, deve\u2014se escolher com cuidado o n\u00famero de blocos par a utjter a mel hor r ei a\u00e7\u00e3o entr e a pr eci s\u00e3o nos r esul tados e o tempo computacional. Para o caso unidimensional, pode ser vi\u00e1vel um grande n\u00famero de blocos, mas para o bidimensional isto deve ser estudado com maior cautela.\nA \u00fanica ressalva a ser feita para esta compara\u00e7\u00e3o \u00e9 o fato de que as simplifica\u00e7des feitas eliminam qualquer erro proveniente do \"f 1 ash\", mas \u00e9 um m\u00e9todo \u00fati 1 para testar o modelo quanto a intervalos de tempo e n\u00famero de blocos poss\u00edveis.\nTabela 7.3.1 : Dados \u2014 Caso 3\nVARI\u00c1VEL\tUNIDADE\tVALOR\ncomprimento\tCm3\t76. 2\n\u00e1rea transversal\tCr\u00f4\t464,. a\npermeabi1Idade\tCmd3\t200\nporosidade\t\t0. 3\ncompressi bi1i dade da rocha\tC1Zpsi 3\t0\ntemperatura\tT\t160\nsatura\u00e7Ses in\u00edciais CS t S 1 o\tg\t\tCl.OZ) , CO.OZ)\npress\u00e3o inicial e de produ\u00e7\u00e3o\tC psi3\t2000\n\u00edndii_= de produtividade\tC f t3 -cpzdi a-psi Z)\t1. OI 2x1 O=\ntempo Tinal\tCdiasZ)\t210\ncomposi\u00e7\u00e3o inicial cc.cz> 1\tiO\t\tCO. 03 . Cl. 03\nviscosidade Cu &amp; u 5 \u00b0\t9\tCcpZ)\tCl. 03 , Cl.03\ndensi\u00faades molar es\ta CgmolZm 3\t6000\nVARI\u00c1VEL\tUNI D ADE\tVALOR\ninje\u00e7\u00e3o de g\u00e1s\tCMSCFZdia3\t83,3\n\tC KmolZdia}\t100\ncomposi\u00e7\u00e3o de g\u00e1s injetado CC \u00bb C 3 1\tIO\t\tC1.0, 0.03\nSATURACAO DE OLEO\n1.0\nFigura 7.3.1 : Satura\u00e7\u00e3o de \u00f3leo - Modelo de Helfferich.\nEfeitos da Varia\u00e7So do N\u00famero de Blocos.\nSATURACAO DE OLEO\nFigura 7.3.2 : Satura\u00e7\u00e3o de \u00d3leo - Modelo de Helfferich.\nEfeitos da Varia\u00e7\u00e3o da Formula\u00e7\u00e3o das Composi\u00e7des.\nCOMPOSICAO DO FLUIDO DE INJECAO\n1.0\nDISTANCIA ADIMENSIONAL DO BLOCO DE INJECAO\nFigura 7.3.3\t: Composi\u00e7\u00e3o do Fluido Injetado - Modelo de\nHelfferich. Efeitos da Varia\u00e7\u00e3o do N\u00famero de\nBlocos.\nCOMPOSICAO DO FLUIDO DE INJECAO\n1.0\nFigura 7.3.4\t: Composi\u00e7\u00e3o do Fluido Injetado - Modelo de\nHeifferich. Efeitos da Varia\u00e7\u00e3o da Formula\u00e7\u00e3o das\nComposi\u00e7Ses.\n7.\t4 - CASO 4- MODELO RADIAL\nComo visto no item C6. 5? , este modelo pode ser estendido para o fluxo radial. O grande problema da utiliza\u00e7\u00e3o de um modelo semi-impl\u00edci to para este caso \u00e9 o f ato de que\u00bb devido \u00e0 grande queda de press\u00e3o, os blocos pr\u00f3ximos ao po\u00e7o devem ser muito pequenos\u00bb o mesmo acontecendo com o intervalo de tempo. Isto ocorre pois\u00bb nos modelos n\u00e3o totalmente impl\u00edcitos, o fluxo fica limitado pelo volume poroso dos blocos.\nPara se ter uma id\u00e9ia desta limita\u00e7\u00e3o, com um reservat\u00f3rio de mesmo volume do caso CO\u00bb o intervalo de tempo fica limitado a um valor\u00bb aproximadamente, trinta vezes menor.\nPor esta raz\u00e3o\u00bb os casos radi ai s n\u00e3o for am vali dados e estudados com maiores detalhes pois\u00bb para estes casos\u00bb o tempo computacional seri a muito grande, principalmente para um modelo ccmp _J-ional. Para problemas radiais, aconselha-se a utiliza\u00e7\u00e3o dos modelos totalmente impl\u00edcitos. Isto pode ser encontrado nas i\u00bfncias [JonSSl, [JR88], [JR893 e [Coa851.\n7.5 - CASO 5- VALIDA\u00c7\u00c3O DO MODELO\nC7. 1?\nonde qL \u2014\t-* vazSo total ,\nL \u2014\t\u2014> comprimento do reservat\u00f3rio,\nPo \u201d\t\u2014\u00bb pressSo na face x = 0 e,\nPc -\t\u2014> pressSo na face x = L .\nAs;\tsim, consi der ando a pressSo de i nje\u00e7So i gual \u00e0 origi nal\ndo reservat\u00f3rio Cp^3, a integral contendo os termos de permeabilidade relativa pode ser calculado por partes para cada bloco, ou seja,\nqL L\nA k\nC7.\u00a33\nConsiderando a mobi1idade total constante ao 1ongo de cada\nbloco, obt\u00e9m-se :\nqt L\tnb S\u201d \u00ed kro p + kr9 plcp.-p: j =i\t*\tC7. Sd \u25a0\t. f\nA k\t\t\nou, simplesmente,\tqt L - 1\tC7. 4D\nnb Ak\u00ed ( j = l\tk\tk\t- ro p + rg p 1 Cp - p, 3 \u00b0\t^g gJj J\tJ_1\t\nonde, pj *= p^ quando j = 1.\t\t\nA tabela C7.5.apresenta os dados para a alimenta\u00e7\u00e3o do modelo a ser validado. A tabela C7.5. 22) apresenta o resultado do quociente definido no lado esquerdo da equa\u00e7\u00e3o C7. 4D como fun\u00e7\u00e3o do n\u00famero de blocos. Observa-se que, com o refinamento da malha, o quoci ente tende \u00e0 uni dade.\nTabela 7.5.1 : Dados - Caso 5\nF\nVARI\u00c3VEL\tUNIDADE\tVALOR\ncomprimento\tC nD\t250\n\u00e1rea transversal\tCi\u00f4\t464. 5\nper meabi1i dade\tC mdl\t25\nporosi dade\t\t0. 3\nccmpressibi 1 idade da rocha\tClZpsO\t0.000004\ncompressibilidade da \u00e1gua\tC1Zpsi D\t0.000003\ntemperatura\t\u00b0F\t160\nsatura\u00e7Ses ini ci ai s CS . S , S 2) o\tg\tV\t\tC0. 8\u00bb 0.0\u00bb 0.23\npress\u00e3o inicial\tCpsiZ)\t3000\n\u00edndice de produtividade\tC ft3-cpZdi a-psi 3\t1.012x1 o5\ncomposi\u00e7\u00e3o inicial CC , C , C ? 14\t10\t\tC . 22> . C . 22>, C . 6D\n.az\u00e2o de produ\u00e7\u00e3o\tCSTBZdZ)\t78. O\n\u25a0 .imposi\u00e7\u00e3o de inje\u00e7\u00e3o\t\ti gual \u00c0 i ni ci al\nTabela 7.5.2 : Resultados - Caso 5\nN\u00daMERO DE BLOCOS\tQUOCIENTE DEFINIDO NA EQUA\u00c7\u00c3O C7.42)\n20\t0. 93\n40\t0. 97\n80\t0. 99\n8 - CONCLUS\u00d5ES\nA grande desvantagem \u00e9 a limita\u00e7\u00e3o do intervalo de tempo devido ao tratamento explicito das composi\u00e7\u00f5es e transmi ssi vi dades. Esta limita\u00e7\u00e3o pode ser pequena , como no caso do in\u00edcio da condensa\u00e7\u00e3o retr\u00f3grada mas tamb\u00e9m pode ser bastante severa, como no escoamento radial. Para estes casos, torna\u2014se necess\u00e1rio um modelo totalmente impl\u00edcito.\nOutro ponto importante \u00e9 a necessidade da implementa\u00e7\u00e3o do artif\u00edcio matem\u00e1tico explicado no item C62>. Nos casos de produ\u00e7\u00e3o \u00e0. press\u00e3o constante, o n\u00famero de itera\u00e7Ses por intervalo de tempo c-4tj\u00bb em m\u00e9dia, de tr\u00eas para uma. Nos casos de produ\u00e7\u00e3o constante, o sistema era mal condicionado e, muitas vezes. nem convergia. \u00c0 ref\u00e9i \u00ea\u00edicia [Won881 cita que a utiliza\u00e7\u00e3o do balan\u00e7o de moles ao inv\u00e9s' de fra\u00e7Ses molares pode ter o mesmo efeito, al\u00e9m de melhorar o balan\u00e7o de materiais.\no ->0001 o n\u00e3o apr esentou probi emas de converg\u00eanci a, pel o menos no^ casos testados. A refer\u00eancia (TLS833 cita que em certos casos surge a necessidade da uti1iza\u00e7\u00e3o do fator de amortecimento adotado por Nghiem CNgh823. Isto n\u00e3o foi necess\u00e1rio em nenhum caso estudado. A raz\u00e3o disto pode ser a implementa\u00e7\u00e3o da modifica\u00e7\u00e3o de um dos termos do Jacobiana, proposta por Manscori [Man823 e\nso\ndescrita no item C4D.\nser viabilizado atrav\u00e9s de um estudo bem mais detalhado, para ser apli\u00e7ado somente nos pontos necess\u00e1rias. O seu uso i ndi scr i mi nado em todos os intervai os de tempo pr ejudi ca a converg\u00e9ncia e aumenta demasiadamente o tempo computacional.\nUm ponto sempre menci onado por todos os modelos composicionais \u00e9 a presen\u00e7a de dispers\u00e3o num\u00e9rica. Segundo as refer\u00eancias ETLS831 e EWonSSJ, no modelo impl\u00edcito de Coais [CoaSO], este problema \u00e9 ainda mai s grave. Coats sugere a especi fica\u00e7\u00e3o da composi\u00e7\u00e3o do \u00f3leo como a original at\u00e9 que a satura\u00e7\u00e3o de g\u00e1s seja diferente de zero. A justificativa usada foi de que os erros na composi\u00e7\u00e3o do \u00f3leo seriam menores do que os causados pela di spers\u00e3o num\u00e9rica. A formui a\u00e7\u00e3o \"2-poi nt upstream\" para as composi\u00e73es, sugerida por ENFA81] pode apresentar pz 1 ' 'nas de \"overshoot\" e \"undershoot\u201c, mesmo com as limita\u00e7Bes da equa\u00e7\u00e3o C3.10D. Isto se agrava um pouco com o crescimento do n\u00famesi u de blocos.\nUm dos pontos pouco mencionados nos resultados, e que fazia parte do alvo inicial deste trabalho, foi o da aplica\u00e7\u00e3o deste modele\tproblemas do tipo \"black\u2014oil\". Uma das causas foi o\nmaior +&lt;=mpo computacional dos modelos composicionais em rela\u00e7\u00e3o aos \u201dblack-oi 1\". N\u00e3o parece vi\u00e1vel a utiliza\u00e7\u00e3o de um modelo t\u00e3o mai s complexo do que o problema a ser estudado. Algumas refer\u00e9ncias sugerem algumas simplifica\u00e7Bes nos \u201c modelos composi ci onai s que podem ser f ei tas para o estudo de problemas do\nANEXOS\nANEXO A\nNOMENCLATURA\na\tconstante na equa\u00e7\u00e3o de estado\n\u00c0\tCap/RZT22)\nb\tconstante na equa\u00e7\u00e3o de estado\nB\tCbP/RT)\nc r\tcompressibi1idade da rocha\nc V\t* compressibil i dade da \u00c1gua\nerro\terro no balan\u00e7o de materiais\nf\tfugacidade\nF\tlado esquerdo da equa\u00e7\u00e3o da press\u00e3o C4.11D\nF m\traz\u00e3o de fugacidade\ng\tacelera\u00e7\u00e3o da gravidade\nG 3\tenergia livre de Gibbs C\u00e2G,\nIP\t\u00edndic\u00bb de prodnt i'\u2019'dade\nJ\tJacobiano\nK m\tconstante de equil 1-brio 1\u00edquido\u2014vapor\nk\tpermeabilidade absoluta\nk r\tpermeabilidade relativa\nL\tfra\u00e7\u00e3o molar do l\u00edquido\nm\tconstante na equa\u00e7\u00e3o de estado\nn\tn\u00famero de moles\nnb\tn\u00famero de blocos\nP\tpress\u00e3o\nP w\tpress\u00e3o no fundo do po\u00e7o\np c\tpress\u00e3o cr\u00edtica 84\npressSo reduzida\nvaz\u00e3o mol ar\nvaz\u00e3o volum\u00e1 t r i ca\n\u25ba\nvaz\u00e3o molar por unidade de volume\nconstante universal dos gases\nrai o\nsatura\u00e7\u00e3o\ntempo\ntr ansmissi vi dade\ntemperatura cr\u00edtica\ntemperatura\ntemperatura reduzi da\nveloci dade\nfra\u00e7\u00e3o molar do g\u00e1s\nvolume do bloco\nvolume discretizado do bloco\nfator de amortecimento\nfra\u00e7\u00e3o molar do componente Cm2) no l\u00edquido\nfra\u00e7So molar do componente Cm2) no g\u00e1s\nfra\u00e7\u00e3o molar total' do componente Cn\u00fc\nfator de compressibilidade\nC&amp;p S + pS + p S 2)\nV V\to o\t9 9\ncoeficiente de itera\u00e7\u00e3o bin\u00e1rio\nfator para medir a converg\u00eancia\nporosi dade\npotenci al de f1uxo\ncoeficiente de fugacidade\ngradiente\nfator de seguran\u00e7a para o controle do intervalo de tempo\n85\nX.\tmobi1 i dade\nfj\tviscosidade\np\tdensidade molar\n\n\u00c7\tlineariza\u00e7\u00e3o de r Cln r?\n\u00d4\ttp S + p S 1/Ep CS + S)]\no o\t5 9\tw o\tg\nu\tn\u00famero de componentes\nos\tfator ac\u00e9ntrico\n*\nSUBSCRITO\nb\thidrocarboneto\ni-\u00bb j > k\tbl oco\nL\tf ase\nL\u00edm\t1 i mi te\nm\tcomponente\nmaje\tm\u00e1xi mo\no, g, v\tfasesC\u00f3leo, g\u00e1s e \u00e1gua?\nSC\tcondi\u00e7\u00e3o padr\u00e3o\nX\tdir .-\u00e7ao x\ny\tdire\u00e7\u00e3o y\nw\tpo\u00e7o SUPERESCRITO\nc\tColsi us\nF\tFa.r anheit\nL\titera\u00e7\u00e3o\nL>\taproxima\u00e7\u00e3o da m\u00e9dia logar\u00edtmica\nrs R\tintervalo de tempo Rankini\nANEXO B\nQUANTIDADE\tUNIDADE\tUNIDADE SI\tFATOR DE CONV. PARA O SI\nCompressi bi1i dades\t1/psi\t1/Pa\t1.450377E-04 %\nComprimento\tft in\tm\t3.O48OOOE-01 2.54OOOOE-O2\nDens\u00ed dade\t1bm/ft3 lbm/bbl\tKg/m3\t1.6O184\u00caE+O1 2.85301OE+OO\nMassa\tlbm\tKg\t4. 5359OE-O1\nPer meabi1i dade\tmd\t2 m\t9.869233E-16\nPress\u00e3o\tpsi a\tPa\t6.894757E+03\n1 Temper atura\t\u00b0C \u00b0F \u00b0R\tK\tT =TC+273. 15 k T, =\u20ac1^+459.673/1.8 k T, =Tr/1.8 k\nTempo\tdias\ts\t8.64OOOOE+O4\nVazSo\tSTB/dia ft3/dia\tm3Zs\t1.84O13OE-O6 3.277414E+OO\nViscosidade\tcp\tPa*s\tl.OE-03 *\nVol ume\tbbl fta\t3 m\t1.589873E-01 2.831685E02\nVaz\u00e3o molar\tlbmol\tKmol\t4.535Q24E-01\n* val or aproxi mado\nc c c c c c c c c c\nDENIS\nDATA\nC\nC\nC c c\nDE RESERVAT\u00d3RIOS\nJOSE SCHIOZER\nJUNHO - 1989\nDECLARACAO DE VARIAVEIS\nIMPLICIT REALES CA-H,K,O-Q,S-Z3\nREALMS ROO,ROG,ROW,RAUX,RO,RWELL,ROSCW,ROON\u00bbROGN,ROWN,ROOSC,ROGSC, +\tROOI , ROGI, ROWI\nCHARACTERS CHARA4C153\nCHARACTERS CHARA8C253\nCOMMON/ENT/CHARA4,CHARA8,1NTE01,1NTEO2,1NTE03,1NTE04C 253,\n1\tINTE05,1NTE06,1NTEO7,1NTEOS,INTEO9,1NTEi O,INTE11C 253 \u00bb\n2\tREAL01C 253,REAL02C 253,REAL03C 253,REAL04C 253,REAL05C 253,\n3\tREAL06C 253 \u201e REAL07C 253 , REAL08C 253 , REAL09\u00bb REAL10REAL11 .\n4\tREAL12,REAL13,REAL14,REAL15,REAL16,REAL17C 253\nCOMMON/SAI/INTEI2,REAL71,REAL72,REAL73,REAL74,REAL75,REAL76\n1\nCOMMON\n+\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nREAL77,REAL78,REAL79,I CONV,REALXC 253,REALYC253 zTMS/ TOC 503 , TGC 503 , TWC 503 , TC 503 , PC 50,103 , ALFAC 503 , FI C 503 ,\nTETA,VOLC 503,DFIA,VC 503,DELTAP\nZCOMPZ ZC50,103 , YC50* 103 , XC 50,103 , NCOMP /CONV/ FC503\nZVAZZ\n/PRTZ\nQWC 503 \u201e QHC 503 \u00bbQMC 50,103 \u00bbQOC 503 , QGC 503\nNDAY,ITEMAX,IPRI NT, DX , DY , XL , YL t DAYPRTC 303 . CP,CT,CO,CD,NFLAG\nIDTt DT,DPLIM\u00bb DSLIM.DPMAX,DSMAX\nZTSC/\n/JACOB/ GC50.5O3\n/SAT/ SOC 503,SGC 503 , SWC 503\n/DENS/ ROOC 503,ROGC 503>ROWC 503 /PROPI/\nZPROP1Z\nZPROP2Z\nZPROP3Z\nZPROP4Z\n/PW/ PWELLC503.DTN,CUMOIL\u00bbCUMGAS,GASINJ\n/PROPNZ SONC 503,SGNC 503,SWNC 503,PNC 50,103 ,ZNC 50,103,\nSOI ,SGI , SWI , PI , FII\nTEMPO,ITER,NX,NY,N,AUXX,AUXY.KM,EPI,NIP\nRAUX\u00bbPMAX,PMIN,CR,CW,POR.DZ.ROSCW,PROIND\nKROC 503,KRGC503,KRWC 503,VOC 503 ,VGC 503, VISW, NK\nIMAX. TK, DTMAX, QOMIN, QOMAX, QOSC, QGSC\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\n+ XNC50,103 \u00bbYNC50,103,ROONC 503,ROGNC 503,ROWNC 503,ALFANC 503 \u00bbFINC 503 COMMON\nCOMMON\nCOMMON\nCOMMON\n/PERM/ SSC203.KKOWC203,KKWC203.KKGC 203.KKOGC 203,KROWI /MOL/ PMC1O3,PMO,PMW,PMG\nZMATBZ ERROC103,ERROW >ERROCC103,ERROCW,ERTOT,VOLINI\nZPRT2/ VOLHIDC103,VOLIPCI03, QiC103,QpC103,VOLIPW,VOLWAT\nDIMENS!ON AC 5003,DELC 503,XIC 503,YIC 503 ,del2C 503\nIO\nOPENCI,FILE=\u2018SR. DAT\u20193 readCl\u201e103PROIND,DAMP,epl3 formate3C15x,flO. 233\nROTT NA DE LEITURA\nCALL INI READ\nCLOSEC13\nn n o n r> n\tnnn q q n\to n n\nOPENC 2.FILE=1 SR1. PRN * 3\nOPENC3.FILE=*SR2. PRN\u20183\nOPENC 4, FI LE= \u2019 SR3. PRN\u00bb2)\nOPENC 5,FILE=\u2018SR4.PRN13\nOPENC 6,FILE= > SR5. PRN\u20193\n100 ITER = O\nIDT = 0\nWRITEC*.7053TEMPOZCT\nCALCULO DAS TRANSMISSIVIDADES\nCALL TRANSCn3\n200 DO 110 I = 1 , N\nDO 11O J = l.N\n110 GCI , J3 = O. OdO\t4\nCALCULO DO JACOBIANO PARA RESOLU\u00c7\u00c3O DA EQUACAO DA PRESS\u00c3O\nCALL CALCULO\nRESOLU\u00c7\u00c3O DO SISTEMA TRI-DIAGONAL\nif Cny.ne.13 goto 203\ncal1 thomasCn,g,f,dei3 do 196 1=1, n\nfCi3 = - fCi3\ndo 194 j=l,n\n194\tfCi3 = fCi3 + gCi,J3*delCJ3\n196 continue\ncal1 thomasC n,g,f,dei23 do 198 1=1 ,n\n198 delCi3 = delC13 + del2Ci3\ngoto 208\nRESOLU\u00c7\u00c3O DO SISTEMA PENTADIAGONAL\nCONVERTE GCI,J3 EM ACIND3 PARA SOLUCAO 130 GBAND\n203\t1=0\nIND = O\n202 1=1+1\nIF CI.GT. N3 GOTO 206\nIF Cl.LE.NY3 J = O\nIF CI.GT. NY3 J = I - NY - 1\nIF\u2018 Cl. GE. N-NY3 L = N\nIF CI.LT. N-NY3 L = NY + I\n204\tJ = J + 1\n1ND = IND + 1\nACIND3 = GCI , J3\nIF CJ.EQ. L3 GOTO 202\nGOTO 204\n206 CONTTNUE\nu o u\n166 continue\t*\nCALL GBAND CA,F,DEL2,N,NY,EPS,IERR,03 do 168 i =1, n\n168 delCi3 = delC\u00cd3 + dol2Ci3\nC\nC\tATUALIZACAO DA PRESS\u00c3O PARA A NOVA ITERACAO\nC\n208 DO 210 I=1,NX DO 210 J~1,NY\nIJ - CI-13XNY + J\n210 PCI.J3 = PCI.J3 + damp * DELCIJ3\nCALCULO DAS COMPOSICOES E DA SATURACAO DA AGUA\nDO 400 I = 1,NX\nDO 400 J = 1, NY\nIJ =\u00ab CI-13*NY + J\nC\nIF Cl.NE.13 GOTO 222\nDEN = O. OdO\nSWCIJ3 = O. OdO\nDO 218 M = 1,NCOMP\n218 ZCIJ.M3 - O. OdO\nGOTO 240\n222\tAUX = PCI-1.J3 \u201c PCI,J3\nIF C AUX. LE. O. d03 GOTO 230\nDEN = AUX * CTOCIJ-NY3 + TGCIJ-NY33 * AUXX SWCIJ3 = AUX * TWCIJ-NY3 * AUXX\nDO 225 M=l,NCOMP\nIF Cl.NE.23 GOTO 223\nXX = XNCIJ-NY.M3 YY = YNCIJ-NY.MJ\nGOTO 225\n223\tIF CNTP. EQ. 03 THEN\nXX = 1.5d0 * XNCIJ-NY.M3 - O. 5dO * XNCI J-NY*2, M3 YY = 1.5d0 m YNCIJ-NY.M3 - O. 5dO * YNCIJ-NY*2\u00bbM3 IF CXX.GT. DMAX1CXNCIJ.M3,XNCIJ-NY\u00bbM333 THEN\nXX = DMAX1 C XNCI J, M3 , XNCI J-NY, M33 ENDIF\nIF CYY. GT. DMAX1CYNCIJ ,M3 , YNCI J-NY .M333 THEN YY = DMAX1 C YNCIJ,M3,YNCIJ-NY,M33\nENDIF\nIF CXX. LT. DMIN1CXNCIJ, M3 ,XNCIJ-NY,M33> THEN XX = DMI NI C XNCIJ.M3 ,XNCIJ-NY,M33\nENDIF\nIF CYY. LT. DMIN1C YNCI J, M3 , YNCI J-NY, M333 THEN YY = DMIN1 C YNCIJ.M3 , YNCI J-NY , M33\nENDIF\nELSE\nXX = XNCIJ-NY,M3\nYY = YNCIJ-NY.M3\nENDIF\n225 ZCIJ.M3 = AUX * CT0CIJ-NY3 m XX + TGCIJ-NY3 * YY3 * AUXX Q1\nXX = XNCIJ.MD\t>\nYY = YNCIJ.MD\nGOTO 235\n233 IF CNTP.EQ. OD THEN\nXX = 1.5d0 * XNCIJ,MD ' O.5d0 * XNCIJ+NY,MD\nYY = 1.5d0 * YNCIJ.MD - O.3d0 * YNCIJ+NY.MD ELSE\nXX = XNCIJ.MD\nYY = YNCIJ.MD\nENDIF\n235 ZCIJ.MD = AUX * CTOCIJD * XX + TGCIJD * YYD * AUXX\n240 IF CI.EQ. NXD GOTO 260\nAUX = PCI+l.JD - PCI.JD\t\u2018\nIF C AUX. I ,E. 0. dOD GOTO 250\nDEN = DEN + AUX * CTOCIJ+NYD + TGCIJ+NYDD * AUXX SWCIJD = SWCIJD + AUX * TWCIJ+NYD * AUXX\nDO 245 M=1,NCOMP\nIF CI.NE.NX-1D GOTO 243\nXX = XNCIJ+NY.MD\nYY = YNCIJ+NY.MD\nGOTO 245\n243\tIFCNTP. EQ. OD THEN\nXX = 1.5d0 * XNCIJ+NY,MD - O.5dO * XNCIJ+NY*2,MD YY ~ 1.5d0 w YNCIJ+NY.MD - 0.SdO * YNCIJ+NY*2,MD IF CXX. GT. DMAX1CXNCI J.MD .XNCIJ+NY,MDDD THEN\nXX = DMAX1 C XNCIJ.MD.XNCIJ+NY,MDD ENDIF\nIF CYY. GT. DMAX1CYNCIJ.MD .YNCIJ+NY,MDDD THEN YY = DMAX1 C YNCIJ,MD.YNCIJ+NY.MDD\nENDIF\nIF CXX. LT. DMIN1CXNCIJ ,MD . XNCI J+NY. MDDD THEN XX = DMIN1 C XNCIJ.MD\u00bbXNCIJ+NY,MDD\nENDIF\nIF CYY. LT. DMIN1C YNCI J, MD . YNCI J+NY, MDDD THEN\nt\tYY = DMIN1 C YNCIJ,MD.YNCIJ+NY,MDD\nENDIF\nELSE\nXX = XNCIJ+NY.MD YY = YNCIJ+NY.MD\nENDIF\n245\tZCIJ.MD = ZCIJ.MD + AUX * CTOCIJ+NYD * XX -+ TGCIJ+NYD * YYD\n+\t* AUXX\nGOTO 260\nDEN = DEN + AUX * CTOCIJD + TGCIJDD * AUXX SWCIJD = SWCIJD + AUX \u00ab TWCIJD * AUXX DO 255 M=1.NCOMP\nIF Cl.NE.1D GOTO 253\nXX = XNCIJ.MD YY = YNCIJ.MD\nGOTO 255\n253\tIF CNTP. EQ. OD THEN\nXX = \u00cd.SdO * XNCIJ.MD -\n92\nO.5dO * XNCIJ-NY.MD\n255\tZCIJ.M3 = ZCIJ.M3 + AUX x CTOCIJ3 * XX + TGCIJ3 x YY3 x AUXX\n260 IF CJ.EQ. 13 GOTO 280\nAUX = PCIU-O - PCI.J3\nIF CAUX. LE. O. dO3 GOTO 270\nDEN = DEN + AUX * CTOCIJ-13 + TGCIJ-133 x AUXY\nSWCIJ3 = SWCIJ3 + AUX X TWCIJ-13 x AUXY\nDO 265 M=1\u00bbNCOMP\nIF CJ.NE. 23 GOTO 263\nXX = XNCIJ-1 tM3\nYY = YNCI J-l \u00bbMJ\nGOTO 265\n263\tIF CNTP. EQ. 03 THEN\nXX = l.SdO x XNCIJ-1,M3 - O. 5d0 x XNCIJ-2.M3\t1\nYY = l.SdO x YNCIJ-ljM? - 0. SdO * YNCIJ--2,MD\nIF CXX. GT. DMAX1C XNCIJ t M3 \u00bbXNCI J-l , M333 THEN\nXX = DMAX1 C XNCI J> M3 k XNCI J-l > MJ3\nENDIF\nIF CYY. GT. DMAX1CYNCI J,M3 ,YNCIJ-1 .M333 THEN\nYY = DMAX1 C YNCIJ \u00bb M3 t YNCI J-l , M33\nENDIF\nIF CXX. LT. DMIN1CXNCIJ, bD fXNCI J-l ,bD33 THEN\nXX = DMIN1 C XNCIJ\u00bbM3 f XNCI J-l, M33\nENDIF\nIF CYY. LT. DMIN1C YNCI J, bD , YNCI J-l ,M333 THEN\nYY = DbUNl C YNCI J\u00bbM3 , YNCI J-l ,M33\nENDIF\nELSE\nXX = XNCIJ-l.MJ\nYY = YNCIJ\u20141\u00bbM3\nENDIF\n265\tZCIJ.M3 - ZCIJ\u00bbM3 + AUX x CTOCIJ-13 x XX + TGCIJ-13 * YY3\n+\tx AUXY\nGOTO 2S0\n270 DEN = DEN + AUX x CTOCIJ3 + TGCIJ33 * AUXY\n\u2018 SWCIJ3 = SWCIJ3 + AUX * TWCIJ3 X AUXY DO 275 M=1,NCOMP\nIF CJ.NE.NY3 GOTO 273\nXX = XNCIJ\u00bbM3\nYY = YNCIJ.M3\nGOTO 275\n273 IFCNTP.EQ. 03 THEN\nXX = 1.SdO \u00ab XNCIJ.bD - 0.SdO x XNCIJ+lfM3\nYY - l.SdO x YNCIJ,M3 - O.SdO x YNCIJ+1,M3 ELSE\nXX = XNCIJ\u00bbM3\nYY = YNCIJ.M3\nENDIF\n275\tZCIJ\u00bbM3 = ZCIJ.M3 + AUX x CTOCIJ3 * XX + TGCIJ3 x YY3 x AUXY\nC\n280 IF CJ.EQ. NY3 GOTO 300\nAUX = PCI\u00bbJ+13 - PCI.J3\nIF CAUX. LE. O. dO3 GOTO 290\n283\nDEN = DEN + AUX * SWCIJJ = SWCIJJ + DO 285 M-l.NCOMP\nIF CJ. NE. NY-1J XX = XNCI J+l.MJ YY = YNCI J+l .MJ GOTO 285 IF CNTP. EQ. OJ XX = 1.5dO YY = 1.5d0\nCTOCIJ+1J + T6CIJ+1JJ AUX * TWCIJ+1J * AUXY\nTHEN\n*\tXNCI J+l. MJ - O. 5d0 *\n*\tYNCI J+l. MJ - O. SdO *\n290\n* AUXY\nXNCIJ+2.MJ YNCIJ+2. MJ\nIF CXX. GT. DMAX1CXNCIJ\u00bbMJ.XNCIJ+l.MJJJ XX = DMAX1 C XNCI J. MJ ,XNCI J+l , MJJ\nENDIF\nIF CYY.GT.DMAX1CYNCIJ.MJ.YNCIJ+1 .MJJJ YY = DMAX1 C YNCI J,MJ , YNCI J+l .MJJ\nENDIF\nIF CXX. LT. DMIN1C XNCIJ . MJ , XNCI J+l , MJ J J\nXX - DMIN1 C XNCI J .MJ .XNCI J+l , MJ J\nENDIF\nIF CYY. LT. DMINICYNCI J, MJ , YNCI J+l .MJJJ YY - DMIN1 C YNCIJ.MJ .YNCIJ+l .MJJ\nENDIF\nELSE\nXX = XNCI J+l , MJ\nYY = YNCI J+l .MJ ENDIF\nZCIJ.MJ = ZCIJ.MJ + AUX * CTOCIJ+1J * XX\n* AUXY\nTHEN\nTHEN\nTHEN\nTHEN\n+ TGCIJ+1J * YYJ\n+\nGOTO 300\nDEN = DEN + AUX * CTOCIJJ + TGCIJ2O * SWCIJJ = SWCIJJ + AUX * TWCIJJ * AUXY DO 295 M=1> NCOMP\nIF CJ. NE. 1J GOTO 293\nAUXY\n\u25ba\n\nXX = XNCIJ.MJ YY ~ YNCIJ.MJ GOTO 295\n293\tIF CNTP. EQ. OJ THEN\nXX = 1.5d0 * XNCIJ.MJ - O.SdO * XNCIJ-l.MJ YY = 1.5d0 * YNCIJ.MJ - O.BdO \u00ab YNCIJ-l.MJ ELSE\n;\tXX = XNCIJ.MJ\nYY = YNCIJ.MJ\nENDIF\n295\tZCIJ.MJ = ZCIJ.MJ + AUX * CTOCIJJ * XX + TGCIJJ * YYJ * AUXY\n\u00ab\n300 DEN = DEN + QHCIJJ + VOLCIJJ/DT * FINCIJJ * C ROONCIJJ *\n+\tSONCIJJ + ROGNCIJJ * SGNCIJJ J\nDO 310 M=l.NCOMP\nZCIJ.MJ +\n310 ZCIJ.MJ\n= ZCIJ.MJ + QMCIJ.MJ + VOLCIJJ/DT * FINCIJJ * ZNCIJ.MJ * CROONCIJJ * SONCIJJ + ROGNCIJJ * SGNCIJJJ\n= ZCIJ.MJ / DEN\nROWCIJJ = ROSCW * Cl.dO + CW * CPCI.JJ - 14.7d0*CPJJ / PMW SWCIJJ = CSWCIJJ + QWCIJJ + VOLCIJJ/DT x FINCIJJ x ROWNCIJJ +\t* SWNCIJJJ / CVOLCIJJ/DT * FICIJJ * ROWCIJJJ\n400 CONTINUE\nc\nDO 450 1=1, NX\nDO 450 J=1,NY\nIJ = CI-lDwNY + J\t\u00bb\nREAL12 = SNGL CPCI,J5 Z CP2)\nDO 440 M=1,NCOMP\n440\t7CMZ) = SNGL CZCIJ.ND^\nCALL GPASIM\nCALL CONVERTEC XI , YI , VOCI JZ>, VGCI JD , QUAL,ROOCIJD , ROGCI JZ) , CD, NCOMPZ) DO 441 M=l,NCOMP\nXCIJ,MZ) = XICMZ)\n441\tYCU.ND = YICMZ)\nIF CQUAL. EQ. O. OdOZ) GOTO 442\nVCIJZ) = l.dOZ CCl.dO- QUALZJZQUAL * PMG ZPMO + 1 . dOZ) GOTO 444\n442\tVCI_D = O. OdO\nC\t*\nC\tSo,Sg eq 28-31\nC\n444 IF CVCIJD . NE. O. D GOTO 446\nSOCIJZ) = l.dO -SWCIJZ) GOTO 449\n446 IF CVCIZD . NE.1. dOZ) GOTO 448\nSOCIJZ) - O. dO\nGOTO 449\n448\tSOCIJZ) = Cl.dO- SWCIJZ)? * Cl.dO- VCIJZ)? * ROGCIJDZC Cl.dO- VCIJ?Z>\n+\t* ROGCIJ? + VCIJ? * ROOCIJ? 3\n449\tSGCIJZ) = 1. dO - SWCIJ? - SOCIJ?\nALFACIJ? = TETA*ROWCI J? \u00abSWCIJZ) + ROOCI JZ) \u00abSOCI JZ) + ROGC I J> \u00abSGCI JZ) FICIJ? = POR x Cl.dO+ CR * CPCI.J? - 14. 7dO*CP??\n450\tCONTINUE\nC\nC\tTESTE DE CONVERG\u00caNCIA\nC\nCALL TESTECTEST,N?\nWRITEC\u00bb,201? ITER,TEST\n201 FORMATC* ITERACAO *,12,\u2019 NORMA *,E10.2?\nC\nC \u2022 CALCULO DA TOLER\u00c2NCIA\nC\nTOL = EPI\nC\nIF CTEST. LE.TOLZ) GOTO 500\nITER = ITER + 1 J\nIF CITER. GT.ITEM\u00c0X? GOTO 800\nGOTO 200\nC\n500 CONTINUE\nC\nC CONTROLE DO INTERVALO DE TEMPO\nC\nC\tCALL TSTEP\nC\tIF CIDT. EQ. 1Z) GOTO\t1OO\nC\nC\tCALCULO DO BALAN\u00c7O\tDE MATERIAIS\nC\nCALL MATBAL\nC\nC\tATUALIZACAO DAS VARIAVEIS PARA O PROXIMO INTERVALO DE TEMPO\nG\nDO 600 1=1,NX\nDO 600 J=1,NY\t\u00bb\nIJ = CI-1} * NY + J\nPNCI,J} = PCI\u00bbJO\nSONCIJD = SOCIJD\nSGNCIJD = SGCIJ}\nSWNCIJD = SWCIJO\nALFANCIJO = ALFACIJD\nFINCIJ} = FICIJD\nROONCIJ} = ROOCIJD\nROGNCIJO = ROGCIJD\nROWNCIJD = ROWCI JO\nDO 610 M=l,NCOMP\nZNCIJ,M} = ZCIJ,M}\nXNCIJF.M} = XCIJ,M}\t\u201c\n610\tYNCIJF,ND = YCIJ,M}\n600 CONTINUE\nC\nC\tIMPRESS\u00c3O DOS RESULTADOS\nC\nCUMOIL = CUMOIL + QOSG * DTZct\nCUMGAS = CUMGAS + QGSC * DTZlOOOZct\nDO 700 M = 1,NCOMP\n700\tVOLIPCM} = O. ODO\nVOLIPW = 0. ODO\nDO 70S IJ = l.N\nAUX - VOLCIJ} M FICIJO * CROOCIJ} * SOCIJO + ROGCIJ} * SGCIJ}} VOLIPW = VOLIPW + VOLCI JO * FICIJ} * ROWCI JO * SWCIJD\nDO 701 M = 1\u00bbNCOMP\n701\tVOLIPCM} = VOLIPCM} + AUX * ZCIJ.M}\n705\tCONTINUE\nDO 703 M = 1,NCOMP\nQi CM} = Qi CM} + QMC1,M}*DT\n703\tQpCM} = QpCM} + QMCnx,M}*DT\nWRITEC*.790}iter ,Q0SC, SOC1} , SOCN} , ZC1,1} , ZC1 , NCOMP} ,\n+\tERROW,C ERROC M},M=1,NCOMP}\n! WRITEC*,792}PCI,1}zCP,PCNx.NY}ZCP\nIPRINT = IPRINT + 1\nIF CI PRINT. EQ. NFL AG} THEN\nIPRINT = O\nWRITEC 2,705}TEMPOzCT\nWRITEC2,765} QOSC,QGSCZ1OOO,CUMOIL,CUMGAS\nWRI TEC 2,713}\nDO 704 M=1,NCOMP\nWRI TEC 2,723} M, ERROC M} , Qi CM} , QpC M} , VOLI PC MI ,VOLHIDCM}\n704\tCONTINUE\nWRITEC2,735}ERROW,QwCI J} ,QwCI J} , VOLIPW, VOLWAT\nWRITEC2,745}\nDO 706 I=1\u00bb N\nWRI TEC2,755}I , PCI , 1 }ZCP, SOCI} , SGCI} , SWC1} , ZCI , 1} , ZCI , 3}\n706\tCONTINUE\nENDIF\n\n705\tFORMATC80C\u2019X\u20193,Z,20x,' Tempo Cdias3 = *,F6.0,Z3\n715 formate9X ,'BALAN\u00c7O\u2019,6X,4C'MOLES\u2019,7X3\u201eZ, \u00bbCOMP. *,4X, \u2019 DE MAT. \u2019 , 6X, + \u2019INJ. \u2019 \u00bb8X, * PROD. \u2019,5X, \u2019IN PLACE' , 4X, \u2019 INICI AIS\u2019 \u00bb Z,5C \u2019-* 3 , +\t5C3X,9C\u2019-*333\n725 FORMATC 13,2X,5C3X,E9. 333\n735 FORMATC2X, ' W\u2019 ,2X,5C3X,E9. 33 ,ZZ3\n745 formate'BLOCO PRESS\u00c3O\tSO\u2019, 8X, \u2019 SG\u2019, 8X , \u2019 SW\u2019, 7X , ' ZC 13 * , 6X,\n+ \u2019ZC33\u2019,Z, \u2019---- -----------'\u00bb5C2X,'--------'33\n755 FORMATCIX,I3,4X,F7.2,2x,3CF7. 4,3x33\n765 FORMATC\u2019POCO\n+\tZ, \u2019\n+\t//------\nOLEO\tGAS\nC STBZD3\tC MsefZD3\nOLEO ACUM.\nCSTB3\nGAS ACUM.\nCMMscf3\n\u25ba\n+\tZ,7X,E9. 3,2X, EQ. 3,4X,E1O. 4, 4X,E9. 3,Z3\nc\n790\tFORMATC iS,F8. 2, IX ,6CF8. 6,1X33\n791\tFORMATC4OF7.5,1X3\n792\tFORMATC2CF16. 5,1X33\n793\tFORMATC 40C F9.3,1X3 3\n794\tFORMATC4F8. 6,1X3\n795\tF0RMATC15,F8.2,1X,8CF8. 6,1X33\nIF CTEMPO. GE. TMAX3 GOTO 800 TEMPO = TEMPO + DT\nGOTO 10O\n800 CLOSEC23\nCLOSEC33\nCLOSEC43\nCLOSEC53\nCLOSEC63\nDO 810 I=1.3\n810\tWRITECw, \u2019C1X, Al3 \u20193CHARC73\n: STOP\nEND\nn n a n n\nW\u00bb ,h<aaxxXxKXXXXXXXXXXXX S|JBROTI NA I NI READ XXXXXXXXXXXXXXXXXXXXXXXX LEITURA DOS DADOS E INICIALIZA\u00c7\u00c3O DAS VARIAVEIS\nINI READ\nIMPLICIT REAL*6 CA-H,K,O-Q,S-Z3\nREAL** ROO,ROG,ROW,RAUX,RO,RWELL,ROSCW,ROON,ROGN,ROWN,ROOSC,ROGSC, +\tROOT , ROGI, ROWI\nCHARACTERS CHARA4C153\nCHARACTER*\u00a9 CHARA8C253\nCOMMONZENTZCHARA4,CHARA8,1NTEO1,1NTE02,1NTEO3,1NTEO4C 253,\n1\tINTE05,1NTE06,1NTEO7,1NTE08,1NTE09,1NTE10,1NTE11C 253,\n2\tREAL01C 253,REAL02C 253,REAL03C 253,REALO4C 253,REAL05C 253,\n3\tREAL06C 253,REALO7C 253,REALQ8C 253,REAL09,REAL10,REAL11,\n1\nCOMMON\nt\nREAL77 > REAL78,REAL7Q\u00bbICONV,REALXC 253,REALYC 253 ZTMSZ TOC 503 , TGC 503 , TWC 503 . TC 503 , PC 50,103 , ALFAC 503 , FI C 503 , TETA,VOLC 503,DFIA , VC 503,DELTAP ZCOMPZ ZC50,103,YC50,103,XC5O,1O3,NCOMP ZVAZZ ZPRTZ\nCOMMON COMMON COMMON\nQWC 503 , QHC 503 , QMC 50,103 , QOC 503 , QGC 503\nNDAY , ITEMAX, IPRI NT,DX,DY,XL,YL, DAYPRTC 303 , CP,CT,CQ, CD,NFLAG\nIDT,DT,DPLIM,DSLIM,DPMAX,DSMAX\nZTSCZ\nZJACOBZ GC50.503\nZSATZ SOC 503 , SGC 503 , SWC 503\nZDENSZ ROOC 503,ROGC 503,ROWC 503 ZPROPIZ\nZPROP1Z\nZPROP2Z\nZPROP3Z\nZPROP4Z\nZPROPNZ\nSOI , SGI , SWI \u00bbPI. FI I\nTEMPO,I TER\u00bb NX,NY,N,AUXX,AUXY,KM,EPI,NTP\nRAUX,PMAX,PMIN,CR,CW,POR,DZ,ROSCW,PROIND\nKROC 503 , KRGC 503 , KRWC 503 \u00bbVOC 503 , VGC 503 , VI SW, NK\nTMAX, TK, DTMAX , QOMIN, QOMAX , QOSC, QGSC\nSONC 503 , SGNC6O3 , SWNC503 , PNC5O,1O3 , ZNC50, lOb ,\nZPERMZ SSC 203 , KKOWC 203 , KKWC 203 , KKGC 203 , KKOGC 203 , KROWI\nZMOLZ PMC 103,PMO,PMW ,PMG\nZMATBZ EPROC103\u201eERROW tERROCC103,ERROCW,ERTOT,VOLINI\nZPWZ PWELLC 503,DTN,CUMOIL,CUMGAS ,GASINJ\nZPRT2Z VOLHIDC 103 ,VOLIPC 103 , Qi C103 , QpC103,VOLIPW,VOLWAT\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\n+ XNC 50,103 ,YNC 50,103,ROONC 503,ROGNC 503,ROWNC 503,ALFANC 503,FINC 503 COMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nDIMENSION XIC103,YIC103,ZIC103,ROSCC103,XXC503\nc\nc\nc\nREADCI,153 XL, YL,DZ,POR,PI,SOI,SGI,SWI,KX,KY,CR,CW,RWELL,PMAX, +\tPMIN,QOMAX,QOMIN,DPLIM,DSLIM,DTMAX,TMAX,DT,TK,EPI ,\n+\tepi 2,SWC,ROSCW,DELTAP,PMW,VI SW,RE\nREADC1,253 NX,NY,ITEMAX,NPRO, NI N J,NFLAG,NDAY,NK,NCOMP,MODELO, +\tNTP\n7\n10\nEPI AUX = O.OdO\nDO 10 1=1 ,NINJ\nREADC1,353 NI,N2 ni = CN1-13\u00bbNY+N2 READC1,S53QWC NI3 do 7 L=1.NCOMP\nr eadC 1,953 QMC ni , L3\nEPI AUX = EPIAUX + QMCni,L3 continue continue\nEPIAUX = EPIAUX + QWCni3 EPI = EPI * EPIAUX if Cepi . eq. O. OdO3 epi = epi 2 READC1,53\nc\n\u2022DO 12 1=1,NPRO\nREADCI,853 NI , N2, QOCC NI-13\u00abNY+N23 CONTINUE\n.READCI,53\nDO 20 J=l,NCOMP\nREADC 1,453 ZIC J3 ,PMC J3 , INTE11C J3\nPMCJ3 = PMCJ3 Z 1OOO. dO\nCONTINUE\nC\nuuu\nREADCI ,33\nREADCI,553 CDAYPRTC13,I=1,NDAY3\nREADCI,53\nREADCI ,653 CSSC13 ,KKOWCI3 >KKWC13 , KKGCI3 , KKOGC13,1 =1 ,NK3\nCALL INTERPC SS,KKOW,NK,C1. dO- SWC3,KROWI3\nRE ADC 1,53\nREADC1,753 INTE01,1NTE02.INTE03,1NTEO5,1NTE06\u00bbINTE07,1NTE08, +\tINTE09,INTE1O,REAL09,REAL1O,REAL11,REAL12,REAL13,\n+\tREAL14,REAL13\n\u2022INICIALIZACAO DAS VARIAVEIS\nINTE05 = NCOMP\nCQ = 1.84013D-06\nCP = 6894.757dO\nCT = 86400.dO\nCD = 16.01846d0\nVISW = VISW * O.OOldO\t'\nPMW = PMW ZlOOO.dO\nDT = DT * CT\nTMAX = TMAX * CT\nTEMPO = DT\nDO 22 I=1,NDAY\n22\tDAYPRTC 13 = DAYPRTCI3 * CT\nNDAY = 1\nIPRINT = 0\nPI = PI * CP\nDELTAP = DELTAP * CP\nDPLIM=DPLIM * CP\nPMAX = PMAX * CP\nPMIN = PMIN * CP\nCR = CP Z CP\nCW = CW Z CP\nDX = XLZNX\nDY = YLzNY\nXXE = DLOGCRE3\nXXW = DLOGCRWELL3\nDXX = CXXE - XXW3ZNX\n'DO 26 1=1,NX+1\n26\tXXCI3\t= XXW + CI-13 * DXX\nCUMOIL = O.dO\nCUMGAS = O.dO\nGASINJ = O. dO\nERROW = O. dO\nDO 33 M=1.NCOMP\n33\tEP.ROCCM3 = O.dO\nKX = XX * 1.D-1S\nKY = KY * 1 . D-l 5\nKM=DSQRTCKX*KY3\nIF \u00bfMODELO. NE. 03 THEN\nAUXX = KX * DY * DZ Z DX\nAUXY = KY \u00bb DX * DZ Z DY\nELSE\nAUXX = 2 * 3.14159D0 * KX * DZ Z DXX\nAUXY = O. ODO\nRAUX = DLOGC ROZRWELL3\t>\nPROIND = 2. dO * 3.1416d0 * KM * DZ Z RAUX\n31\tTETA = 0.15d0\nFII = POR * Cl.dO+ CR * CPI - 14.7dO*CP33\nROWI = ROSCW \u00abCl.dO + CW * CPI - 14.7dO*CP31 z PMW\nREALO9 = SNGLCTTO\nREAL12 = SNGLCPIZCP3\nDO 34 I = 1 .NCOMP\n34\tREAL17CI5 = SNGLCZICI53\nC\nCALL GPASIM\nCALL CONVERTE CXI,YI.VISO,VISG.QUAL.ROOI.ROGI,CD\u00bbNCOMP3 IF CQUAL. EQ. O. OdO5 GOTO 36\nVINI = l.dOZ CCl.dO- QUAL3ZQUAL * PMG ZPMO + 1. d03 GOTO 38\n36 VINI = O.OdO\n38 SOI = Cl.dO- SWID * Cl.dO- VI NI 3 * ROGIZC Cl.dO- VINI?\n+\t* ROGI + VINI * ROOI 5\nSGI = 1. dO - SWI - SOI\nALFAI = TETA*ROWI\u00abSWI + ROOI \u00abSOI + ROGI \u00abSGI\nVOLWAT = O. ODO\nVOLINI = O.ODO\nDO 40 M=1.NCOMP\n40\tVOLHIDCM5 - O.ODO\nC\nC\tINICIALICAZAO DAS PROPRIEDADES DA GRADE\nC\nDO 50 I=1\u00bbNX\nDO 50 J=1\u00bbNY IJ = CI-15MNY + J IF CMODELO. EQ. 05 THEN\nVOLCIJD = 3.14159D0 * DZ \u00ab C DEXP C 2\u00abXXCIJ+13 5 -+\tDEXPC 2MXXCIJ5 3 5\nELsE\nVOLCIJ5 = DX*DY*DZ\n\u00ed ENDIF\nAUX = VOLCIJ3 \u00ab FII * CROOI x SOI + ROGI \u00ab SGI3 VOLWAT * VOLWAT * V0LCIJ5 * FII * CROWI * SWI 3 VOLINI = VOLINI + AUX + VOLWAT\nDO 44 M=1 , NCOMP\n44\tV0LHIDCM3 = VOLHIDCM5 + AUX * ZICM3\nrei\u00bbJ3 = pi\nPNCI.JD = PI\nt-wELLCIJ3 = PMAX\nSOCIJ5 = SOI\nSGCIJ5 = SGI\nSWCIJ5 = SWI\nXONCIJ3 = SOI\nSGNCIJ3 = SGI\nSWNCIJD = SWI\nROONCIJD - ROOI\nROGNCIJ3 = ROGI\nROWNCIJ3 = ROWI\nROOCIJ3 = ROOI\nROGCIJ5 = ROGI\nROWCIJ5 = ROWI\nVOCIJ3 = VISO\nVGCIJ5 = VISG\nVCIJ5 = VI NI\nALFACIJ5 = ALFAI\nFICIJ5 = FII\nALFANCIJ5 = ALFAI\nFINCIJ5 = FII\nQHCIJ3 = O. OdO\nDO 48 M=1 , NCCMP\nZNCIJ.M5 = ZICM3\nZCIJ.hD = ZICM5\nXNCIJ,M5 = XICM5\nYNCIJ.M5 = YICM5\n48\tOHCIJ5 = QHCIJ5 + QMCIJ.M5\nQWCIJ5 = QWCIJ5 * CQ * ROSCW Z PMW\nQOC1J5 = QOCIJ5 * CQ\n50 CONTINUE\n\u00bb\n5\tFORMATCZ5\nIS FORMATCZZZ, 31C13X , FIO. O, Z55\n85 FORMATC11C15X\u00bbI3\u00bbZD,/5\n85 FORMA\u00cd(_2CaX,I255\n45 FORMATC3C 2X,F10.03,2X ,135\n55 FORMATCSX. F10. 05\n65 FORMATC SC 2X , F10. 05 5\n75 FORMATC9C15X , 13, Z5,7C15X,FIO. O,Z55\nBS FORMATC2C2X, 125 , C2X , FIO. 055\n95 formatC2X\u00bbFIO. 05\nRETURN\nEND\nC\nC KxxifMxxMKXXKitxxiofKXKMXx SUBROTTNA I NI PRINT xxxkxxxxxxxxkxxxxxxxxxxx C\tPRINT DATA\nC\nSUBROUTINE INIPRINT\nIMPLICIT REALMS CA-H,K,O-Q,S-Z5\nREALES ROO,ROG,ROW,RAUX,RO,RWELL\u00bbROSCW,ROON,ROGN>ROWN,ROOSC,ROGSC, s+\tROOI, ROGI , ROWI\nCOMMON ZVAZZ QWC 505 , OHC 305 , QMC 50,105 , QOC505 , QGC 505\nCOMMON ZPRTZ NDAY,ITEMAX,IPRINT,DX,DY,XL,YL,DAYPRTC3O5,\n+\tCP,CT, CQ,.CD. NFLAG\nCOMMON ZPROPIz SOI,SGI,SWI, PI , FI I\nCOMMON ZPROP1Z TEMPO,ITER,NX, NY, N, AUXX, AUXY, KM, EPI, NIP\nCOMMON ZPR0P2Z RAUX,PMAX,PMIN,CR,CW,POR,DZ,ROSCW,PROIND\nC\nSKIN=O.dO\nPC=O.dO\nWRITEC2,155\nWRI TEC2.253XL,YL,DZ,PP.QOMAX,QOMIN,PMIN,DSLIM,DPLIM,CR,CW,FII, +\tRWELL,SKIN, PC, SGI , SOI , SWI ,CKX*1. Dl 55 ,CKY*1. Dl 55\nFORMATCZZZZZ,3X,60C \u2019*\u20185,2Cz,3X, >*' , 58C *\t\u20185 , '*\u20195,Z,3X,\n+ \u2019*\tSIMULACAO DE RESERVAT\u00d3RIOS\t-\t,\n+ Z,3X,,5SC* \u20195,,Z.3X,\n+ \u2019*\tTESE\tm\u2019,\n+ 2CZ.3X,\t, 58C \u2019 \u20195,\u2019*\u20195,z,3X,\n1O1\n+\n+\n\u00bb\n4-\n\u2019 \u20193 \u00bb \u2019X\u2019} \u00bbZ,3X,\nO.\u2019x\u2019,Z.3X.\nTRI-FASICO\nif*\nZ,3X, *x* , 58C \u2019\n\u2019 x\n2CZ.3X.\u2019x\u2019,58C\nFORMATC 5X\u201e \u2019DADOS INI Cl AIS \u2018DIMENS\u00c3O - COMPRIMENTO.\nLARGURA.....\nPROFUNDIDADE\n\u2019PRESS\u00c3O INICIAL DO RESERVAT\u00d3RIO. . . \u2018MAXIMA \u2019MINIMA \u2018MINIMA \u2022MAXIMA\nDENIS JOSE SCHIOZER\nJUNHO\n\u2019 \u20193 , \u2018x\u20193 \u00bbZ\u00bb3X,60C \u2019x\u20193 .ZZZZZ3\n\u2019tZZ,3Xt\n4-\n\u2019MAXIMA\n*\nit*\n\u00bb\n*\n>\n\u00bb\n*\n1980\tX*\n\u00bbF7.0,\u2018\tm\u2019,Z,3X,\n\u00bbF7.O,\u2019\tm\u2018 ,Z,3X,\n,F7.0\u00bb\u2019\tm\u2019 \u00bbZ\u00bb 3X ,\n\u00bbF7. 0, \u2018\tPa\u2019,Z,3X,\n\u00bbF7.0, \u2019\t\u2019,z,3X\n,F7.0,\u2019\t\u2019\u00bbZ,3X\n\u00bbF7.0, \u2018\tPa\u2019\u00bb z, 3X, .\n1\n\u00bbF7.2\u00bbZ\u00bb3X>\n4-\n4-\nPRODU\u00c7\u00c3O DE OLEO................\nPRODU\u00c7\u00c3O DE OLEO. ..............\nPRESS\u00c3O NO POCO.................\nVARI ACAO DE SATURACAO NO \u2019\u00bbZ\u00bb3X\u00bb INTERVALO DE TEMPO..............\nVARIACAO DE PRESS\u00c3O NO \u2019,Z,3X\u00bb INTERVALO\n\u2019COMPRESSIBI LIDADE * COMPRESSIBILIDADE \u2018POROSIDADE A 14.7 \u2018RAIO DO POCO....\n\u2019SKIN ...........\n\u2019PRESS\u00c3O CAPILAR. . \u2018SATURACAO DE GAS INICIAL. \u2019SATURACAO DE OLEO INICIAL \u2019SATURACAO DE AGUA INICIAL \u2019PERMEABILIDADE DIRECAO. . . \u2019\tDIRETIO. ..\nDA DA psi\nDE TEMPO ROCHA. . .\nAGUA. . . . .\nPa* izPa\n\u00bbZ,3X> \u2018\u00bbZ,3X, IzPa\u2019\u00bbZ>3X,\n,F7.O*\u2019\t!\n\u00bbF7. 0,\u2018 ,F7.0\u00bb\u2018 \u00bbF7. 2,Z,2x,\n\u00bbF7. 2, \u2019 m\u2019 \u00bbZ,3x\u00bb\n,F7. O./^x.\n\u00bbF7.0\u00bb\u2018 Pa\u2019,Z,3x,\n\u00bbF7.2,Z\u00bb3x\u00bb\n\u00bbF7. 2, Zt 3x,\n\u00bbF7.2,Z\u00bb3x, \u00bbF7.0,\u2019 \u00bbF7.0\u00bb\u2019\nmd\u2019,/t3x, md\u2019t/f\u00e2x.\n+\n+\n+\n+\n23 ;\n+\n+\n+\n+\n+\n\n+\n+\n+\n\n\n\u25ba\n\u25ba\n\n\n\n>\n>\n\n\u25ba\n\n\n\u25ba\n>\n>\n\n\u00bb\n\u00bb\n\u00bb\n\u25a0 2CZ33 RETURN END\nuuuuu\nXKXKKXXKXKXXK^txxxxxxxx SUBROTI NA TRANS xxxxxx*xx*xxx*xxxxxxxxx*xx\nCALCULA AS TRANSMI SSI VIDADES\nSUBROUTINE TRANSCrO\nC\nIMPLICIT REALX8 CA-H\u00bbK\u00bbO-QtS-Z3\nREALxfi ROO,ROG,ROW,RAUX ,RO,RWELL\u00bbROSCW,ROON,ROGN,ROWN,ROOSC\u00bbROGSC, +\tROOI , ROGI . ROWI .\nCHARACTERX4 CHARA4C153\nCHARACTERS CH AR A8C 25 3\nCOMMON ZTMSZ TOC 503,TGC 503,TWC 503,TC 503,PC 50,103,\u00c0LFAC 503,FIC 503t +\tTETA\u201eVOLC 503 \u00bbDFIA\u00bbVC 503,DELTAP\u2018\nCOMMON ZSATZ SOC503,SGC503,SWC303\nCOMMON ZDENSZ ROOC 503 , ROGC 503 \u00bb ROWC 503\nCOMMON ZPROP3Z KROC503\u00bbKRGC503,KRWC503\u00bbVOC503\u00bbVGC503,VISW,NK\nCOMMON ZPROP4Z TMAX,TK,DTMAX,QOMIN.QOMAX,QOSC\u00bbQGSC\nCOMMON ZPROPNZ SONC5O3,SGNC303>SWNC503,PNC5O,103,ZNC50\u00bb103>\n+ XNC 50,103\u00bb YNC 50,103\u00bbROONC 503,ROGNC 503 \u00bb ROWNC 503,ALFANC503,FINC 503\nCOMMON ZPERMZ SSC2O3\u00bbKKOWC203,KKWC203,KKGC203\u00bbKKOGC2O3\u00bbKROWI\nC\nDO 10 I =1 , N\nCALL PERELCI?\nIF CSOCI?. EQ. O. ODO? THEN\nTOC 15 = O. ODO\nELSE\nTOCI? = KROCI? * ROOCI? Z VOCI? ENDIF\nIF CSGCI ? . EQ. O. ODO? THEN\nTGCI? = O. ODO\nELSE\nTGCI? = KRGCI? * ROGCI? Z VGCI? ENDIF\nTWCI? = \u00a1CRWCI? * ROWCI? Z VISW\n10\tTCI? = TOCI? + TGCI? + TETA*TWCI?\nRETURN\nEND\nn n o q r? n n\nxx-xx***** SUBROTI NA CALCULO xxxxxxxx CALCULA O JACOBI ANO E A FUNCAO \u201c F \"\nPARA A RTESOLUCAO DA EQUACAO DA PRESSAO\nSUBROUTINE CALCULO\nIMPLICIT REALS C A-H, K, 0-Q, S-Z?\nREALS ROO,ROG,ROW,RAUX,RO,RWELL,ROSCW,ROON,ROGN,ROWN,ROOSC,ROGSC +\tROOT , ROGI , ROWI\nCHARACTERS CHARA4C15?\nCHARACTERS CHARA8C25?\nCOMMONzENTzCHARA4,CHARA8,INTEO1,1NTE02,1NTE03,1NTEO4C 25?,\n1\tINTEO5,INTE08,INTE07,INTE08,INTEO9,INTE1O,INTE11C25?,\n2\tREAL01C 25?,REALO2C25? \u00bb REALO3C 25?,REAL04C 25?,REALO5C 25?\n3\tREAL06C 25?,REAL07C 25?,REAL08C 25?,REALO9,REAL10,REAL11,\n4\tREAL12,REAL!3,REAL14,REAL15,REAL! 6,REAL17C 25?\nCOMMONzSAIZlNTE12,REAL71,REAL72,REAL73,REAL74,REAL75,REAL76\n1\nCOMMON\nREAL77,REAL78,REAL79,1CONV.REALXC 25?,REALYC25? ZTMSZ TOC SO? , TGC 50? , TWC 50? , TC 50? , PC 50,10? , AL FAC 50? , FI C 50? .\nTETA,VOLC 50?,DFIA,VC 50?,DELTAP\nZCOMPZ ZC 50.10? , YC 50,10? , XC 50,10? ,NCOMP ZCONVz FC 50?\nZVAZz\nZPRTZ\nCOMMON\nCOMMON\ni COMMON\nCOMMON\n+\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\n+ XNC 50,10?,YNC 50,10?,ROONC 50?,ROGNC 50?,ROWNC 50?,ALFANC50?,FINC 50?\nQWC5O? ,QHC50? ,Q\u00a1MC50,10? ,QOC5O? \u00bbQGC50?\nNDAY,ITEMAX11PRINT,DX,DY\u00bbXL,YL,DAYPRTC 30?, CP,CT,CQ,CD,NFLAG\nIDT, DT, DPLIM, DSLIM. DPMAX, DSMAX\nZTSC/\nZJACO8Z GC50,50?\nZSATZ SOC50?,SGC50?,SWC50?\nZDENSZ ROOC50?,ROGC3O?,ROWC50?\nZPROP1Z TEMPO,ITER.NX,NY,N\u00bbAUXX,AUXY.KM.EPI,NTP\nZPROP2Z RAUX,PMAX,PHIN,CR,CW,POR,DZ,ROSCW,PROIND ZPROPNZ SONC 50?\u00bbSGNC 50?,SWNC 50?,PNC 50,10?,ZNC 50,10?,\nCOMMON COMMON COMMON COMMON\nZPROP3Z KROC 50?,KRGC 50? tKRWC 50?,VOC 50?,VGC 50? , VISW.NK\nZPROP4Z TMAX,TK,DTMAX,QOMIN,QOMAX,QOSC,QGSC\nZPERMZ SSC20?,KKOWC20?,KKWC 20?\u201eKRGC 20? , KKOGC2O?,KROWI ZPWZ PWELLC 50? >DTN,CUMOIL ,CUMGAS,GASINJ\nF -> FUNCAO DA PRESSAO\nC\tG -> JACOBIANO\nC\tCALCULO DOS TERMOS DE FLUXO\nC\nDO 300 I=1,NX\nDO 300 J=1,NY\nIJ=CI-1?*NY + J\t\u25ba\nIF Cl.NE.1? GOTO 20\nFCIJ? = O.OdO\nGCIJ,I J? = O.OdO\nGOTO 40\n20 AUX = PC 1-1,1? - PCI,J?\nIF C AUX. LE. 0. dO? GOTO 30\nC\nFCIJ? = -AUX * TCIJ-NY? * AUXX GCIJ.IJ? = - TCIJ-NY? * AUXX GCIJ.IJ-NY? = TCIJ-NY? * AUXX GOTO 40\n30 FCIJ? = -AUX * TCIJ? * AUXX\nGCIJ,IJ? = - TCIJ? * AUXX GCIJ,IJ-NY? = TCIJ? * AUXX\nC\n40 IF CI.EQ. NX? GOTO 60\nAUX = PCI+1..D - PCI.J?\nIF CAUX.LE.O. ? GOTO 50\nFCIJ? = FCIJ? - AUX * TCIJ+NY? * AUXX GCIJ.IJ? = GCIJ.IJ? - TCIJ+NY? * AUXX GCIJ.IJ+NY? = GCIJ,IJ+NY? + TCIJ+NY? * AUXX GOTO 60\n50 FCIJ? = FCIJ? - AUX \u00bb TCIJ? * AUXX GCIJ.IJ? = GCIJjIJ? - TCIJ? * AUXX GCIJ.IJ+NY? = GCIJ.IJ+NY? + TCIJ? * AUXX\nC\n60 IF CJ.EQ. 1? GOTO 80\nAUX = PCI.J-1? - PCI.J?\nIF C AUX. LE. O. dO? GOTO 70\nFCIJ? = FCIJ? - AUX * TCIJ-1? * AUXY GCIJ.IJ? = GCIJ.IJ? - TCIJ-1? m AUXY GCIJ.IJ-1? = GCIJ.IJ-l? + TCIJ \u20141? * AUXY GOTO 80\n70 FCIJ? = FCIJ? - AUX x TCIJ? * AUXY ! GCIJ.IJ? = GCIJ.IJ? - TCIJ? * AUXY\nGCIJ.IJ-1? = GCIJ.IJ-1? + TCIJ? * AUXY\nC\n80 IF CJ.EQ. NY? GOTO 1OO\nAUX = PCI.J+1? - PCI.J?\nIF C AUX. LE. O. dO? GOTO 90\nFCIJ?- = FCIJ? - AUX * TCIJ+1? * AUXY GC i i.IJ? - GCIJ.IJ? - TCIJ +11 x AUXY GCIJ.IJ+l? = GCIJ.IJ+1? + TCIJ+1? * AUXY GOiu 1OO\nWO FCIJ? = FCIJ? - AUX * TCIJ? * AUXY GCIJ.IJ? = GCIJ.IJ? - TCIJ? * AUXY GCIJ.IJ+1? = GCIJ.IJ+1? + TCIJ? x AUXY\nC\n1OO CONTINUE\nC\nC CALCULO DE ,'FM E DAS DERIVADAS PARA O JACOBIANO C\tTERMOS DE FONTE E ACUMULACAO\n104\nc\nIF CQOCIJ? . EQ. O. dO? GOTO 150\nCALL VAZAO CIJ \u00bbI\u00bb J \u00bbDQH?\n150 FCIJ? = FCIJ? - TETAxQWCIJ? - QHCIJ? + VOLCID/\u00fcT * CFICIJ? * +\tALFACIJ? - FINCIJ? * ALFANCIJ??\nDQW = 0.OdO\t>\nC DQH = O. OdO\nREAL13 = SNGLCCPCI.J? + DELTAP? Z CP?\nDO SOO M - 1\u00bbNCOMP\nSOO\tREAL17CM? = SNGLC ZCIJ , M? ?\nCALL GPASIM\nCALL CONVERTE CXI,YI>VISO\u00bbVISG>DV,DROO,DROG,CD,NCOMP?\nIF C DV. EQ. O. OdO? GOTO 310\nDV - l.dOZ CCl.dO- DV?ZDV * PMG ZPMO + 1. dO?\nGOTO 220\n210 DV = O. OdO\n220 DROO - CDROO - ROOCIJ?? Z DELTAP\nDROG = CDROG - ROGCIJ?? Z DELTAP\nDROW = CW * ROSCW\nDV = CDV - VCIJ?? Z DELTAP\nDFI = CR * POR\ndaux = CROGCIJ? + VCIJ? * CROOCIJ? - ROGCIJ???\nif Cdaux. EQ. O. ODO? THEN\nDALFA = O. ODO\nELSE\nDALFA = TETA * SWCIJ? * DROW + C DROO * ROGCIJ?**2 + VCIJ? * +\tCROOCIJ?**2 * DROG - ROGCIJ?**2 * DROO? - DV * ROOCIJ? *\n+\tROGCIJ? * CROOCIJ? - ROGCIJ?? ? * Cl.dO - SWCIJ?? Z daux\nendi f\nDFIA = DFI * ALFACIJ? + FICIJ? * DALFA\nGCIJ.IJ? = GCIJ.IJ? + TETA * DQW + DQH - VOLCIJ? * DFIA Z DT DQH = O. OdO DQW = O. OdO\n200 CONTINUE\nRETURN\nEND\n*********************** SUBROTINA TESTE ************************* :\tTESTE DE CONVERGENCIA\nTEST - NORMA\nSUBROUTINE TESTE CTEST.N?\nIMPLICIT REALES C A-H,K,0-Q, S-Z?\nCOMMON zCONVz FC50?\nTEST=0. dO\nDO 10 I =1 . N\nTEST=TEST+FCI? **2\n10 CONTINUE\nTEST=DSQRTC TEST?\nRETURN\nEND\no n o o\t.. n n n n n n\nSUBROTINA THOMAS\nRESOLU\u00c7\u00c3O DO SISTEMA TRI-DIAGONAL\nSUBROUTINE THOMASCN, a, b, x3\nIMPLICIT REALMS CA~H\u00bbK,O-Q,S-Z3\nDIMENSI ON xC 503 , aaC 503,bbC 503 , ccC 503,qqC 503 , ggC 503 +\t,bC503,aC50.503\ndo 3 i J =1 , n\naaCiJ3=aCiJ,iJ3\nif Cij.ne.n3 bbC i J3 =aC i j , i j +13\nif Cij.ne.13 ccdJ3=aCi j ,ij-13\n3\tcontinue\nwi = aaC13\nggC 13 =bC 13 Zwi\ndo 1 i =2, n\nqqC i -1 3 =bbC i -13 Zwi\nwi =aaC i 3 -ccC i 3 *qqC i -13\n1\tggC i 3 \u2014C bC i 3 -ecC i 3 *ggC i -13 3 Zwi\nxCn3 =ggCn3\ndo 2 i =2,n\nJ~n-i +1\n2\txC j 3 =ggC j 3 -qqC j 3 *xC j +13\nreturn\nend\nU'JUUU\nSOLUCAO DE SISTEMA DE EQUACOES COM MATRIZ DE BANDA SEM\nPIVOTAMENTO - AZIZ &amp; SETTARI - PAGINA 444\nSUBROUTT NE GB ANDC A \u201e D, X , N, M, EPS, I ERR\u00bbIFRST3\nIMPLICIT REALMS CA-H.K,O-Q,S-Z3\nREALMS ROO,ROG,ROW,RAUX,RO,RWELL,ROSCW,ROON >ROGN\u00bbROWN,ROOSC\u00bb ROGSC , +\t2001 , ROGI , ROWI\nDIMENSION AC13 ,DC13 ,XC13\nIERR = O\nJ = 1\nDO IO 1=1 ,N\nIE = M\nIF CI+M-N3 21,21,22\n22\tIE = N - I\n21 IEAUX = M\nIF CI-M3 23,23,24\n23\tIEAUX = I\n24\t' IE1 = IE + IEAUX\nMBIG = IE\nJI = J + IE1\nJ2 = JI\nIF CIFRST. GT. 03 GOTO 27\nTF ^DABSCACJ33 - EPE3 25,25,27\n23 I:\t-\u25a0 IERR + 1\nrtf i * i'iBIG3 10,10,26\nEC DC CO J0=1,MBIG\nS\t- ^J13ZACJ3\nlb&lt;_ j. r'RST. GT. 03 GOTO 35\nLO -fU LK=1,MBIG\n75- - JI + LK\nJK - J + LK\n30 ACJ1K3 = ACJ1K3 - ACJK3*S\n35\tCONTINUE\nIAUX = JO + I\nDC I AUX 3 = DC I AUX 3 - DCI3*S\n106\nIE = M\nIFCIAUX+M-N1 31,31,32\n32\tIE = N - I AUX\n31 IEAUX = M\nIFCIAUX-M3 23,33,34\n33\tIEAUX = I AUX\t\u2018\n34\tIE1 = IE + IEAUX\n20 JI = JI + IE1\n10 J - J2 + 1\nJ = J - M - 1\nNP1 = N + 1\nDO 40 IINV=1,N\nI = NPi - IINV\nIE = M\nIF ri+M-hD 41,41,42\n42\tIE = N - I\n41 MBI^ -IE\nXCI1 = DCI1\nIF lMBIGI 44,44,43\n43\tDO 50 LK=1,MBIG\nIK -\tI+LK\nJK =\tJ+LK\n50\tXCI1\t= XCI1\t-\tXCIK1*ACJK1\n44\tXCI1\t= XCI1ZACJ1\nIE =\tM\nIF CI+M-NP11 51,51,52\n52\tIE = NPi - I\n51\tIEAUX = M\nIFCI-1-M3 53,53,54\n53\tIEAUX =1-1\n54\tIE1 = IE + IEAUX\nJ = J - IE1 -1\n40 CONTINUE\nRETURN\nEND\nC\nC xxyyyxxxxxxxxxxKxyyyMxx SUBROTI NA\tPEREL xxxxxxx-oxxxxxxxxxxmwt\nC\tCALCULA PERMEABILI DADES RELATIVAS\nC\n\u25a0SUBROUTINE PERELCIJ1\nIMPLICIT REALMS C A-H, K, O-Q, S-2D\nREALMS ROO,ROG,ROW,RAUX,RO,RWELL,ROSCW,ROON,ROGN,ROWN,ROOSC,ROGSC, +\tROOT , ROGI . ROWI \u25a0\nCOMMON ZSATZ SOC503,SGC501,SWC501\nCOMMON ZDENSZ ROOC50J,ROGC501\u00bbROWC50J\nCOMMON ZPROP3Z KROC5O1 , KRGC 301, KRWC 501 , V0C501, VGC 501 , VISW, NK\nCOMMON ZPROPNZ SONC 501 , SGNC 501 , SWNC 501 , PNC 50', 101 , ZNC 50,101,\n+ XNC 50,101,YNC 50,101,ROONC 501,ROGNC 501,ROWNC 501,ALFANC 501,FINC 501 COMMON zPERMZ SSC 201,KKOWC 201,KKWC 201,KKGC 201,KKOGC 201,KROWI\nC DO 1O0 IJ=1,N\nC\tIF CCSOCIJ1. EQ. SONCI Jll. AND. CSGCIJ1. EQ. SGNCIJ111 GOTOIOO\nSH = 1. dO - SWCIJ1\nSL = l.dO - SGCI JI\nCALL INTERPCSS,KKOW,NK,SH,KROWI\nCALL INTERPC SS,KKW,NK,SWCI JI,KRWCI JI1\nCALL INTERPCSS,KKG,NK,SGCIJI,KRGCIJll\nCALL INTERPCSS,KKOG\u00bbNK,SL,KROG1\n107\nCALL INTERPCSS, KKOW, NK, SOCI J3 , KROW3\t*\nKROCIJ3 - KROW + KROG ~ KROWI + SL * C KROWI - AUXK3 *\n+\tCKROWI - KROG3 Z KROWI\nIF CKROCI J3 . GT. 1. d03 KROCIJ3 = 1. dO\n100 CONTIHUE\nRETURN\nEND\nU'J'JU'JCUU'J'J\tUUUl\nSUBROTI NA INTERP\txxxx x xxx x k x x-x x xxx x x xxx\nINTERPOLACAO\tLI NEAR\nX\tvetor i ndependente\nY\tvetores dependentes\nN\tnumero m\u00e1ximo de valores\tde\tX\nXX\targumento\nYY\tvalores das funcoes\tirrterpol adas\nSUBROUTINE INTERP CX, Y , N ,XX \u00bbYY3\nIMPLICIT REALES CA-H,K,O-Q.S-Z3\nREALES ROO, ROG,ROW,RAUX ,RO, RWELL tROSCW,ROON,ROGN,ROWN,ROOSC.ROGSC ,\n+\tROOT, ROGI,ROWI\nDIMENSION XC 203.YC 203\nIF CXX.GT. XCN3 3 GOTO 98\nIF CXX.LT.XC133 GOTO 99\n1=1\n30 I =1 +1\nIF CXX.GT. XCI33 GOTO 30\nYL = CYCI3-YCI-133ZCXCI3-XCI-133\nYY = YCI-13 + CXX-XCI-133 w YL\nRETURN\n98\tYY=YCN3\nRETURN\n99\tYY=YC13\nRETURN\nEND\nXXXXXXXXXXXMXXXKXXXXXX SUBROTINA CONVERTE xxxxxxxxxxxxxxxxxxxxxxxx\nCONVERCAO DE VARIAVEIS E UNIDADES DO GPASIM\nSUBROUTINE CONVERTE CX,Y,VISO,VISG,QUAL,DENSO,DENSG,CD,NCOMP3\nIMPLICIT REALES CA-H,K,O-Q,S-Z3\n^REALMS ROO,ROG,ROW,RAUX,RO,RWELL,ROSCW,ROON,RO6N,ROWN,ROOSC,ROGSC, +'\tROOI , ROGI , ROWI\n\u25a0 COMMONzSAIZlNTE12,REAL71,REAL72,REAL73,REAL74,REAL75,REAL76,\n1\tREAL77,REAL7B,REAL79,1CONV,REALXC 253,REALYC 253\nCOMMON ZMOLZ PMC1O3,PMO,PMW,PMG\nDIMENSION XC103,YClO3\nVISO = DBLECREAL743 * 0.001 dO\nVISG = DBLECREAL753 * O.OOldO\nQUAL = DBLECREAL763\nPMO = 0. OdO\nPMG = 0. OdO\nDO IO I=1,NCOMP\nXCI3 - DBLECREALXCI33\nYCI3 = DBLECREALYCI33 PMO = PMO + XCI3 * PMCI3\n10 PMG = PMG + YCI3 * PMCI3 IF CPMO. NE. O. OdO3 GOTO 20 DENSO = O.OdO\nGOTO 30\n20 DENSO = DBLECREAL783 * CD Z PMO IF CPMG. NE. O. Od03 GOTO 30\nDENSG = 0. dO\nGOTO 40\n30 DENSG = DBLECREAL793 x CD Z PMG 40 CONTINUE\nRETURN\nEND\nnon n\nCOMMON\nSU8ROTINA MATBAL BALANCO DE MATERIAIS\n\nSUBROUTINE MATBAL\nIMPLICIT REaL*8 CA-H,K,O-Q,S-Z3 REAL*8\nROO.ROG > ROW,RAUX.RO, RWELL,ROSCW tROON,ROGN\u00bbROWN,ROOSC,ROGSC, ROOI , ROGI t ROWI\nZTMSZ TOC 503 > TGC 305,TWC 503 , TC 503 , PC SO,103 ,ALEAC 503 , FIC 503 , TETA , VOLC 503,DFIA,VC 503,DELTAP\nZCOMFZ ZC5O,103,YC50,103,XC50,103,NCOMP\nZVAZZ QWC503 ,QHC5O3 ,QMC5O,1O3 ,Q0C503 ,QGC503\nZTSCZ IDT, DT, DPLIM, DSLIM,DPMAX,DSMAX\nZSATZ SOC 503 , SGC 503 , SWC 503\nZDENSZ ROOC 503 ,ROGC 503,ROWC 503\nZPROPIZ SOI ,SGI ,SWI ,PI ,FII\nZPROP1Z TEMPO,ITER, NX, NY, N,AUXX,AUXY,KM.EPI,NTP\nZPWZ PWELLC 503,DTN,CUMOIL,CUMGAS,GASINJ\nZPROPNZ SONC 503,SGNC 503,SWNC 503\u201ePNC 50,103,ZNC 50,103,\n\n10\nSO\n100\n150\nLuUl\u2019AJ\u2019JUJl\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\n+ XNC 50,103,YNC 50,103,ROONC 503,ROGNC503.ROWNC 503,ALF ANC 503, FI NC 503 COMMON ZMOLZ PMC103,PMO,PMW,PMG\nCOMMON ZMATBZ ERROC1O3,ERROW,ERROCC1O3,ERROCW,ERTOT,VOLINI ERROW - O.dO\nDO 10 M=l,NCOMP\nERROCM3 = O.dO\n: DO 100 1=1 ,N\nERROW = ERROW + V0LCI3 * CFICI3 * ROWCI3 * SWCI3 - FINCI3 \u00ab ROWNCI3 * SWNCI33 + QWCI3 * DT\nDO 50 M=1,NCOMP\nERROCMD = ERROCM3 + VOLC 13\nROGCI3 \u00ab SGC13 *\nSONCI3 * XNCI ,M3\nQMCI ,M3 * DT\nCONIT NUE\nCONTINUE\nERROW = ERROW Z VOLINI\nERROCW = ERROCW + ERROW\nDO 150 M = 1,NCOMP\nERROCM3 = ERROCM3 Z\nERROCCM3 = ERROCCM3\nCONTINUE\nRETURN\nEND\n* CFICI3 * CROOCI3 * SOC13 * XCI.M3 +\nYCI.M33 - FINCI3 * CROONCI3 *\n+ ROGNCX3 * SGNCI3 * YNCI.M333 +\nVOLINI + ERROCM3\n+\n+\n+\nuuuu\nSUBROUTINE VAZAO CIJ,I,J,DQH3\nIMPLICIT REALES C A H, K, 0 -Q, S-Z3\nRE\u00c0L*8 ROO, ROG, ROW, RAUX , RO, RWELL, ROSCW, ROON, ROGN, ROWN\u00bb ROOSC, ROGSC, +\tROOI , ROGI , ROWI\nCHARACTER*! CHAPA1C153\nCHARACTER*8 CHARA8C253\nCOMMONZENTZCHARA4,CHARAB,INTE01,1NTE02,1NTE03,1NTE04C 253 \u00bb\n1\tINTE05,1NTE06,INTEO7,1NTE08,1NTE09,1NTE10,1NTE11C 253,\n2\tREAL01C 253,PEAL03C 253,REAL02C 353,REAL04C 253,REAL05C 353,\n3\tREAL06C 253,REAL07C 253,REAL08C 253,REAL09,REAL10,REAL11,\n4\tREAL13,REAL13,REAL14,REAL15 > REAL16,REAL17C 353\nCOMMONZSAIZINTE12,REAL71,REAL72,REAL73,REAL74,REAL75,REAL76,\n1\nCOMMON\n+\nCOMMON\nCOMMON\nCOMMON\n+\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\n+ XNC 50,103,YNC 50,103,ROONC 503,ROGNC 503,ROWNC 503,ALFANC 503,FINC 503\nCOMMON ZPERMZ SSC 203,KKOWC203,KKWC 203,KKGC 203,KKOGC 203 >KROWI COMMON ZMOLZ PMC103,PMO,PMW,PMG\nDIMENSION XSCC1O3,YSCC1O3\nREAL77,REAL78,REAL7\u00d4,ICONV,REALXC 353,REALYC 253\nZTMSZ TOC 503,TGC 503,TWC 503.TC 503,PC 50,103,ALFAC 503{PIC 503, TETA,VOLC 503,DFIA,VC 503,DELTAP\nzCOMPZ ZC50,103 , YC 50,103 , XC 50,103 ,NCOMP ZVAZZ\nZPRTZ\nQWC5O3 .QHC3O3 ,QMC5O,1O3 ,QQC5O3 .QQC5O3\nNDAY,ITEMAX, IPRI NT, DX , DY , XL, YL,DAYPRTC 303, CP,CT,CQ,CD,NFLAG\nSOC 503 , SGC 503 , SWC 503\nTEMPO,ITER,NX,NY,N,AUXX,AUXY,KM,EPI,NTP\nRAUX\u00bb PMAX, PMIN, CR, CW,POR,DZ,ROSCW,PROIND\nKROC 503,KRGC 503,KRWC 503,VOC 503.VGC 503, VISW, NK TMAX,TK,DTMAX,QOMIN,QOM\u00c1X,QOSC,QGSC\nzSATz\nZDENSZ ROOC 503,ROGC 503,ROWC 503\nZPROP1/\nZPROP2Z\nZPR0P3Z\nZPROP4Z\nZPWZ PWELLC 503,DTN,CUMOIL,CUMGAS,GASINJ\nZPROPNZ SONC 503,SGNC 303,SWNC 503,PNC 50,103,ZNC 50,i 03,\n\u25ba\nR09AUX = REAL09\nREALO9 = 60.0\nR12AUX = REAL12\nREAL12 = 14.7\nfif CKROCIJ3.EQ. O.OD03 THEN\nFO = O. ODO\nELSE\nFO = l.ODO Z Cl. ODO + ROGCIJ3 * KRGCIJ3 * VOCIJ3 Z ROOCIJ3 Z KROCIJ3 Z VGCIJ3 3\nENDIF\nDO 10 M = 1, NCOMP\n' REAL17CM3 = SNGLCXNCIJ,M3*FO3 + SNGLC YNCI J, M3*C1. ODO - FO33\nPMOAUX = PMO\nPMGAUX = PMG\nCALL GPASIM\nCALL CONVERTE C X SC,YSC,VISO, VISG,QU AL,ROOSC,ROGSC,CD,NC0MP3 IF C QU AL. EQ. O. 03 GOTO 12\nVN - l.dOZ CCl.dO- QUAL3ZQUAL * PMG ZPMO + 1. d03 GOTO 14\n12 VN = O.OdO\n14 QHCIJD = O. OdO\nIF CPCI , T). GT. PMIND GOTO 18 WRITEC*,163\n16 FORMATC' PRESS\u00c3O M\u00cdNIMA ATINGI DAF STOP\n18 IF CPCI, JD . GE. PMAX2) GOTO 20\nOMOL = ROOSC * QOCIJD IF CVN.EQ. l.dO3 THEN \u201c GMOL - O. OdO\nELSE\nGMOL = VN * OMOL Z Cl.dO- VN? ENDIF DO ao M-l,NCOMP\nQMCIJ.M? =s REAL17CM? * COMOL + GMOL? QHCIJ2) = QHCIJD + QMCIJ.M?\n20\tCONTE NUE\nDQH = 0. OdO\nQOSC = QOCIJ? Z CQ\nGOTO 50\n30\tPWELLCIJ? = PMAX\n34\tKROAUX\t=\tKROCIJ?\nKRGAUX\t=\tKRGCIJ?\nKRWAUX\t=\tKRWCIJ?\nSOCIJ?\t= 2x SOCIJ?\t\t- SONCIJ?\t\nSGCIJ?\t= 2* SGCIJ?\t\t- SGNCIJ?\t\nSWCIJ?\t= 2* SWCIJ?\t\t- SWNCIJ?\t\nCALL PERELCIJ?\t\t\t\t\nKROCIJ?\t= O.5dO\tx\tCKROAUX +\tKROCIJ??\nKRGCIJ?\t= 0.5d0\tX\tCKRGAUX +\tKRGCIJ??\nKRWCIJ?\t= 0. 5d0\tX\tCKRWAUX +\tKRWCIJ??\nDO 40 M\t=1,NCOMP\t\t\t\nIF CVOCIJD.EQ. O. ODO? THEN\nQMdJ.M? = PROIND * KRGCIJ? * ROGCIJ? Z VGCIJ? * YNCIJ.M? *\n+\tCPWELLCIJ? - PCI.J??\nELSE\nQMCIJ,M? = PROIND * CKROCIJ? * ROOCIJ? Z VOCIJ? * XNCIJ.M? + + KRGCIJ? * ROGCIJ? Z VGCIJ? * YNCIJ.M?? \u00ab CPWELLCIJ? - PCI.J?? ; ENDIF\nQHCIJ? = QHCIJJ + QMCIJ.M?\n40 CONTINUE\nOMOL = QHCIJ? * Cl.ODO-VN?\nGMOL = QHCIJ? * VN\nIF CVN. EQ. 1. ODO? THEN\nQOSC = O. ODO\nDQH = - PROIND * CKRGCIJ? * ROGCIJ? Z VGCIJJ)\nELSE\nQOSC - OMOL Z ROOSC Z 1.84O13E-O6\nDQH = - PROIND * CKROCIJ? * ROOCIJ? Z VOCIJ? + KRGCIJ? *\n+\tROGCIJ? Z VGCIJ??\nENDI F\nKROCIJ? = KROAUX\nKRGCIJ? = KRGAUX\nKRWCIJ? = KRWAUX\nSOCIJD\t=\tCSOCIJ'J\t+\tSONCIJ55\nSgCIJZ)\t=\tCSgCIJZ)\t+\tSgNCIJ55\nSwCIJD\t=\tCSwCIJZ)\t+\tSwNCIJ}}\nOOO\n50\nQGSC = GMOL / ROGSC Z 3. \u00a377413E-04\nPMO = PMOAUX\nPMG = PMGAUX\nREALOQ = ROQAUX\nREAL12 = R12AUX\nRETURN\nEND\nC\nC\nFIM DO PROGRAMA\nC\nANEXO C\nXL YL DZ POR PI SOI SGI\nSWI\nKX KY CR cw RWELL PMAX PMIN QOMAX QOMIN DPLIM DSLIM DTMAX TMAX DT\nTEMPERATURA EPI\nEPI2 swc ROSCW DELTAP\nPMW\nVISW\nRE\nPR. INDEX DAMP\n>\n>\n>\n>\n> > > > > > > > > > >\n>\n>\n>\n> > > > > > > > > > > > > > >\n. 3d0 2000.dO . 8dO . OdO . 2d0 200.dO 200.dO\nO. IdO 5000.dO 1OOO. dO 1000. dO 1OO. dO 100.dO\nO. IdO\n3. dO 310. dO\n3.OOdO 160. dO\n76.196dO<\n30.479d0<\n15. 239d0<\n<\n<\n<\n<\n<\n<\n<\n.000004d0&lt;.000003d0<\n<\n<\n<\n<\n<\n<\n<\n<\n<\n<\n<\nO. OOl 00d0&lt;O. OOlOOdO&lt;. 2d0\t<\n1OOO. dO&lt;\n\u00cdO. OOdO<\n<\n<\n<\n4. S10D-O0<\n1.0&lt;\n18. dO . 41 dO 300. OdO\nOLEO\nCmJ COMPRIMENTO C rrD LARGURA CirD PROFUNDIDADE PPOROSIDADE CpsiaD PRESSAO INICIAL SATURACAO INICIAL DE\nSATURACAO INICIAL DE GAS SATURACAO INICIAL DE CmdZ) PERMEABILIDADE Cmd2> PERMEABILIDADE\nCl/psiL> COMPRESSI BI LI DADE Cl/psi} COMPRESSIBILIDADE CrrD RAIO DO POCO Cpsia) PRESSAO MAXIMA CpsiaJ PRESSAO M\u00cdNIMA CSTBZD5 VAZAO CSTB/D5 VAZAO Cpsi a5\nAGUA\nDIRECAO Y\nDIRECAO Y DA ROCHA . DA AGUA\nMAXIMA\nMINIMA\nVARI ACAO DE VARIACAO DE\nMAXIMA MAXIMA INTERVALO DE TEMPO TEMPO FINAL INTERVALO DE TEMPO entrada\nPRESSAO SATURACAO MAXIMO\ndo GPASIM\nIRREDUT\u00cdVEL\nDA AGUA- CONDICOES PADRAO\nC di as2 C di as2> C di asZ) C oF2) mudar Lambem\nTOLERANCIA TOLERANCIA SATURACAO DE AGUA CKg/m33 DENSIDADE\nCpsia? PARA CALCULO DAS DERIVADAS NUMERICAS PESO MOLECULAR DA AGUA\nCcpD VISCOSIDADE DA AGUA\nCnD RAI O EXTERNO DO RESERVAT\u00d3RIO\nINDICE DE PRODUTIVIDADE FATOR DE AMORTECIMENTO\nNX\t>\t20<\t\nNY ITEMAX\t> >\t01 &lt;15<\tNUMERO MAXIMO DE ITERA\u00c7\u00d5ES\nNPRO\t>\t1&lt;\tNUMERO DE POCOS - PRODU\u00c7\u00c3O\nNINJ\t>\t1&lt;\tNUMERO DE POCOS - INJECAO\nNFLAG\t>\t1&lt;\tIMPRIME A CADA NFLAG INTERVALOS DE TEMPO\nNDAY\t>\t1O<\tNUMERO DE VEZES A IMPRIMIR\nNK\t>\t17<\tNUMERO DE LEITURAS - PERMEABILIDADES\nNCOMP\t>\t3<\tNUMERO DE COMPONENTES\nMODELO\t>\t1<\t0 -> RADIAL\tl-> CARTESIANO\nNTP\t>\tO<\tO -> 2-POINT UPSTREAM 1 -> 1-POINT UPSTREAM\n1\tJ\tQW\t\t***** INJECAO\n<>\t1<> 1<>\t\n<>\t0.dO&lt;>\t\n<>\t. 915332DOO\tQL\n<>\t. 228833DOO\t02\n<>\t. OOOOOODOO\t03\nI\tJ O 1<> 1<>\t\t00 -78. d0 O CSTB/DZ)\txxxxx PRODU\u00c7\u00c3O xxxxx\n\tZCI?\tP MOL.\tINTE11\t\no\t. 2dO\t<>\t16. O43dO<> 020\tMETANO\no\t. 2d0\tO 58. 124d0<> 050\tISO BUTANO\no\t. 8d0\tO 142.286dO<> 140\tN DECANO\nLEITURA DO VETOR DE IMPRESS\u00c3O\nO\t365.dO O\t\t\nO\t730.dO\tO\t\nO\t1095.dO\tO\t\no\t1460.dO\to\t\no\t1825. dO\to\t\no\t2190. dO\to\t\no\t2555.dO\to\t\no\t2920.dO\to\t\no\t3285.dO\to\t\no\t3650.dO\to\t\nSAT\t\t\tKORWCSO\tKRWCSW3\t\tKRGC SG1\t\tKROGCSLD\t\t\nO\t-0. IdO\tO\t. OdO\tO\t. OdO\t<>\t. OdO\tO\t. OdO\t<\nO\t. 15d0\tO\t. OdO\t<>\t. OdO\t<>\t. OdO\t<>\t. OdO\t<\no\t. 2OdO\tO\t. 02d0\t<>\t. OdO\tO\t. OdO\tO\t. OdO\t<\no\t. 25d0\tO\t. 04d0\t<>\t. OdO\t<>\t. OdO\t<>\t. OdO\t<\no\t. 2SdO\tO\t.O52dO\t<>\t. OdO\t<>\t.OOBdO\t<>\t. OdO\t<\no\t. 3Od0\tO\t. OBdO\t<>\t.003dO\t<>\t. OldO\t<>\t. OdO\t<\no\t. 40d0\to\t. lldO\t<>\t. O2dO\t<>\t. 03d0\to\t. OdO\t<\no\t. 5Od0\to\t. 20d0\t<>\t. 08d0\t<>\t. O8dO\to\t. OdO\t<\no\t. 52d0\to\t. 28d0\t<>\t.O92dO\t<>\t.104d0\t<>\t. OdO\t<\no\t. BOdO\to\t. 35d0\t<>\t. 14d0\t<>\t. 2OdO\t<>\t. O3d0\t<\no\t. 65dO\to\t. 40d0\t<>\t. 18dO\t<>\t. 30d0\t<>\t.O45dO\t<\no\t. 7Od0\to\t. 36d0\tO\t. 22d0\t<>\t. 40d0\to\t..12d0\t<\no\t. 72d0\to\t1.OOdO\t<>\t.242dO\t<>\t. 44dO\t<>\t. 16dO\t<\no\t. 80d0\to\t1.OOdO\to\t. 33d0\t<>\t. BOdO\to\t. 31 dO\t<\no\t. 9OdO\to\t1.OOdO\t<>\t. 53d0\t<>\t. 80d0\to\t. 6OdO\t<\no\t1. OOdO\to\t1.OOdO\to\t1.OOdO\t<>\t1.OOdO\t<>\t1.OOdO\t<\no\t1.1 OdO\to\t1.OOdO\t<>\t1.OOdO\tO\t1.OOdO\t<>\t1.OOdO\t<\nENTRADAS GPASIM\nINTE01\t>\t1\t<\teq.\tde\testado \u2014> 1- PR\t2- SRK\nINTEO2\t>\t1\t<\tcal\tculo das propriedades\t\nINTE03\t>\t0\t<\tnumero\t\tde comp, hi poteticos\nINTE05\t>\t3\t<\tnumero\t\ttotal de componentes\nINTEO6\t>\t05<\t\topcao de calculo\t\t\nINTE07\t>\t3\t<\topcao de relatorio de salda .\t\t\nINTE08\t>\t1\t<\tunidades de entrada C 1-molzh 3~1bszh 3-bblZh\t\t\nINTE09\t>\t1\t<\tori gem\t\tde calculo\nINTE10\t>\t1\t<\torigem de entalpia e entropia\t\t\nREAL09\t>\t\t160.\t\t<\ttemperatura inicial\nREAL10\t>\t\t\t0.\t<\ttemperatura final\nREAL11\t>\t\t\t0.\t<\tincremento de temperatura\nREal.1 2\t>\t\t4800.\t\t<\tpress\u00e3o inicial - \"mudar pi\u201d\nREAL13\t>\t\t\t0.\t<\tpress\u00e3o final\nREAL14\t>\t\t\t0.\t<\tincremento de press\u00e3o\nREAL15\t>\t\t\t1.\t<\tfracao LzF\nBIBLIOGRAFIA\n\u2666\n[ABR8Q]\tAu, A\u00bb D. K. , Behie, A., Rubin, B. and Vinsome, P. K. W. .\t\"Techniques\tfor\tFully\tImplicit Reservoir Simulation\", SPE 9302, Setembro, 1980\nEABW6O3\tAmyx, J. W. , Bass, D. M. and Whiting, R. L. , \"Petroleum Reservoir Engineering\", McGraw Hill, i960.\nEADFB23\tAcs, G. , Dollschall, S. and Farkas, E. , \"General Purpose Compos!ti onal Model\", SPE 10515, 1982.\nEAS793\tAzi z, K. and Sett ar i , A. \"Petrol eum Reservoir Simulation\", Applied Science Publishers Ltd., London, 1979.\n[Bur79]\tBurcik, E. J. , \"Propr1erties of Petroleum Reservoir Fluids\", Jonh Wiley and Sons, New York, 1979.\nCCoa763\tCoats, K.H. , \"Simulation of Steamflooding with Distilation and Solution Gas\", SPE 5015, Outubro 1976.\n[Coa783\tCoats, K. H. , \"A Highly Implicit Steamflood Model\", SPE Journal, 369, Outubro 1978.\nC Coa803\tCoats, K.H., \"An Equation of State Compositional Model\", SPEJ, 363-376, Outubro 1980.\nECoa823\tCoats, K. H. , \"Reservoir Simulation\tState of Art\", JPT, 1633-1642, Agosto 1982.\nECoa853\tCoats,\tK. H. ,\t\"Simulation of\tGas\tCondensate\nReservoir Performance\", SPEJ, 1870-1886, 1983.\nECJR743\tCook, R. E. , Jacoby, R. H. and Ramesh, A. B. , \"A Beta\u2014Type Reservoir Simulator for Approximating Compositional Effects During Gas Injection\", SPEJ, vol.14, pp 471-481, 1974.\n[Cri771\tCrichlow, H. B. , \"Modern Reservoir Engineering : A Simulation Approach\", Prentice Hall, New Jersey, 1977.\nEFF793\tFussel, L. T. and Fussel, D. D. , \"An Iterative Technique\tfor\tCompositional Models\", SPEJ, 211-220, Agosto 1979.\nCFraBGJ\tFranchi ,\tJ.R. ,\t\"Boast-E3CR\t:\tBlack\tOil\tand Condensate Simulation on an IBM-PC\", SPE 13297, 1986.\nE FY78J\tFussel, D. D. and Yanosik, J. L. , \"An iterative Sequence\tfor\tPhase\tEquilibrium\tCalculations Incorporating\tthe\tRedlich-Kwong\tEOS\",\tSPEJ, 173-182, Junho 1978.\nE Helen\tHelfferich,\tF. G. ,\t\"Theory of Multicomponent, Muiti phase Di splacement i n Por ous Medi a\", SPEJ , 51\u201462, Fevereiro 1981.\nr Hua851\tHuan, G. R. , \"A Flash Black Oil Model\", SPE 15297, 1985.\n[JonSSJ Jones, J.R., \"Computation Analysis of Single Well\nResponses for Gas Condensate Systems\", The\nUniversity of Tulsa, 1985.\n\u00a3JR89J\nc jsreei\nEKB83]\nEKen83]\nEKumB?]\nE KVS78J\nELY853\nCMan82]\nFlowing Well Response in Gas-Condensate Wells\",\nSPE Formation Evaluation, 578-594,, Setembro 1988.\nJones, J.R. e Raghavan R. , \"Interpretation of\nBuildup Gas-Condensate Wells\", SPE Formation\nEvaluation, 93-104, Margo 1989.\nJossi, J.A., Stiel L.I., and Thodos G. , \"The Viscosity of Pure Substances in the Dense Gaseous and Liquid Phases\u201d, A. I. C. H. F. Journal, vol. 8, n? 1, pag 59-62, 1958.\nKenyon, O. E. and Behie, A. , \"Third SPE Comparative Soluction Project : Gas Cycling of Retrograde Condensate Reservoirs\", SPE 12278, 1983.\nKendall, R. P. et al, \"Development of a Multiple Aplication Reservoir Simulator for Use on a Vector Computer\", SPE 11483, 1983.\nKumar, S. , \"Gas Production Engineering\", Gulf Publishing Co., Houston, Texas, 1987.\nKazemi, H. , Vestal, C. R. and Shank, G. D. , \"An Efficient Multicomponent Numerial Simulation\", SPEJ, 355-368 ,Outubro 1978.\nLo, T. S. and Youngren G. K. , \"A New Approach to Li mi ted Composi ti onal Si mulati on ; Di rect Soluti on of the Phase Equilibrium Equations\", SPE 13518, 1985.\nMansoori, J. ,\"Discussion of .Compositional Modeling\n\twith an Equation of State\", SPE Journal f 202-203, Abril 1982.\nt Me 733\tMcCai n, W. D. , Jr, \"The Properties of Petroleum Fluids\", Pen Well, 1973.\n[NAL83]\tNghiem, L. X. , Aziz, K. and Li \u00a5. K. , \"A Robust Iterative\tMethod\tfor\tFlash\tCalculations Using the SRK or the PR Equation of State\", SPEJ, 521-530, Junho 1983.\n[NFA81]\tNghiem,\tL.X. ,\tFong,\tD. K.\tand\tAziz,\tK. , k \"Compositional\tModelig\twith an\tEquation\tof State\", SPEJ, 887-698, Dezembro 1981.\n[NghS2]\tNghiem, L.X. , \"Author\u2019s Reply to Discussion of Compositional Modeling with an Equation of State\", SPE Journal, 204, Abril 1982.\n[NWFA851\tNutakki R. , Wong T. > Firoozabadi A. , Aziz K. , \"Bevelopment\tof\tGeneral\tPurpose Simulators\", Stanford University,\tStanford, California, Jul ho 1985.\n[Ode81]\tOdeh.\tA. S. ,\t\"Comparison of\tSolution\tto\ta Three\u2014Di mensi onal Black \u2014Oi1 Reservolr Si mulati on Problem\", JPT, pp 13-25, Janeiro 1981.\n[Pea77]\tPeaceman,\tt). W. ,\t\"Fundamentals\tof\tNumerical Reservoir\tSi mul ati on\",\tElsevier\tScientific Publishing Co., New York, 1977.\nL?ed842\tPedrosa, Jr. O. A. , \"Use of Hybrid Grid in Reservoir Simulati on\", Stanford Uni versi ty, Stanford, Cali for ni a, Dezembro 1984.\nL PFTV861\tPress, W. H. , Flannery, B. P. , Teukolsky, S. A. ,\n\tVetterling, W. T. , \u2018'Numerical Recipes\", Cambridge University Press, Cambridge,1986.\nC StaBl J\tStanding, M. B. , \"Volumetric and Phase Behavior of Oil Field Hydrocarbon Systems\", Millet the Printer Inc., Dal las, 1981.\nCSV86]\tShank, G. D and Vestal, C. R. , \"Practical Technics in Two-Pseudo Component Bl ack-Oil Simulation\", SPE 15156\u00bb 1986.\nCTLS831\tThele, K. J. , Lake, L. W. > Sepehrnoori K. ,\t\"A Comparation of the Three Equation-of-State Compositional Simulator\", In Seventh SPE Symposium on Reservoir Simulation, San Francisco, n? 1224S, Novembro 1983.\n[Wat96]\tWatts, J. W. , \"A Compositional Formulation of the Pressure and Saturation Equations\", SPEJ, 243-252, Maio 1986.\n[WonSB]\tWong, T. W. , \"Compositional and Black Oil Modelling -with Emphasis on the Volume Balance Method\u201d, Stanford\tUni ver sity,\tSt anford,\tCalifornia, Fevereiro 19SS.\n[YS833\tYoung, L. C. and Stephenson, R. E. , \"A Generalized Compositional Approach for Reservoir Simulation\", SPE Journal 727\u2014742, Outubro 1983."}]}}}