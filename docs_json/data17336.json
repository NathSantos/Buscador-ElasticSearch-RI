{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.21273"}, {"@name": "filename", "#text": "4990_337433.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "FEDERAL UNIVERSITY OF SANTA CATARINA\nGRADUATE PROGRAM IN\n\nAUTOMATION AND SYSTEMS ENGINEERING\n\nLeonardo Salsano de Assis\n\nScheduling Dynamic Positioned Tankers with Variable\nTravel Time for O?shore O?oading Operations\n\nFlorian\u00f3polis\n\n2015\n\n\n\nFichaSdeSidentifica\u00e7\u00e3oSdaSobraSelaboradaSpeloSautor,\natrav\u00e9sSdoSProgramaSdeSGera\u00e7\u00e3oSAutom\u00e1ticaSdaSBibliotecaSUniversit\u00e1riaSdaSUFSC.\n\ndepAssis5pLeonardopSalsano\nSchedulingpDynamicpPositionedpTankerspwithpVariable\n\nTravelpTimepforpOffshorepOffloadingpOperationsp\u00e7pLeonardo\nSalsanopdepAssispzporientador5pEduardopCamponogarapz\ncoorientador5pAgustinhopPlucenio4p7pFlorian\u00f3polis5pSC5p)\u00e3(I4\n\n3Gpp4\n\nDisserta\u00e7\u00e3op\u00f3mestrado2p7pUniversidadepFederalpdepSanta\nCatarina5pCentropTecnol\u00f3gico4pProgramapdepP\u00f3s7Gradua\u00e7\u00e3opem\nEngenhariapdepAutoma\u00e7\u00e3opepSistemas4\n\nIncluiprefer\u00eancias\n\n(4pEngenhariapdepAutoma\u00e7\u00e3opepSistemas4p)4pOil\nTransportationpLogistics4pU4pMILP4pG4pShuttlepTankers4pI4\nRolling7Horizon4pI4pCamponogara5pEduardo4pII4pPlucenio5\nAgustinho4pIII4pUniversidadepFederalpdepSantapCatarina4\nProgramapdepP\u00f3s7Gradua\u00e7\u00e3opempEngenhariapdepAutoma\u00e7\u00e3ope\nSistemas4pIV4pT\u00edtulo4\n\n\n\nLeonardo Salsano de Assis\n\nScheduling Dynamic Positioned Tankers with Variable\nTravel Time for O?shore O?oading Operations\n\nDissertation presented to the Graduate\nProgram in Automation and Systems\nEngineering in partial ful?llment of the\nrequirements for the degree of Master in\nAutomation and Systems Engineering.\nAdvisor: Prof. Eduardo Camponogara,\nDr.\nCo-Advisor: Prof. Agustinho Plucenio,\nDr.\n\nFlorian\u00f3polis\n\n2015\n\n\n\n\n\nLeonardo Salsano de Assis\n\nScheduling Dynamic Positioned Tankers with Variable\nTravel Time for O?shore O?oading Operations\n\nThis dissertation is recommended in partial ful?llment of the re-\nquirements for the degree of \"Master in Automation and Systems Engi-\nneering\", which has been approved in its present form by the Graduate\nProgram in Automation and Systems Engineering.\n\nFlorian\u00f3polis, July 2nd 2015.\n\nProf. R\u00f4mulo Silva de Oliveira, Dr. - UFSC\nGraduate Program Coordinator\n\nProf. Eduardo Camponogara, Dr. - UFSC\nAdvisor\n\nProf. Agustinho Plucenio, Dr. - UFSC\nCo-Advisor\n\n\n\n\n\nDissertation Committee:\n\nProf. Eduardo Camponogara, Dr.\nAdvisor - DAS/UFSC\n\nProf. Erlon Cristian Finardi, Dr. - EEL/UFSC\n\nProf. Guilherme Ernani Vieira, Dr. - EPS/UFSC\n\nProf. Jomi Fred Hubner, Dr. - DAS/UFSC\n\nBruno Ferreira Vieira, Dr. - CENPES/TOOL PETROBRAS\n\n\n\n\n\nTo my family Bruno, Rossana and\nLarissa, and to Jessica.\n\n\n\n\n\nAcknowledgements\n\nThis work is the result of two and a half years of learning and e?ort.\nDuring this period I had the opportunity to acquire skills, whether tak-\ning courses or working with research, that will be extremely important\nto my training as a researcher.\n\nFirst, I would like to thank my advisor Prof. Eduardo Camponog-\nara for his enthusiasm, time, patience and willingness to teach.\n\nI would like to thank my family for all the support. I am very\ngrateful to my partner Jessica who was always on my side. I thank my\nfriends Alexandre, Fernando and Sydney for helping reduce the stress\nof this period. I am also grateful to my research colleagues Luiz, Eric,\nThiago, Eduardo, Lauvir, Marco Aur\u00e9lio, Caio, Ricardo and Angelo for\nhaving received and helped me when needed.\n\nLast but not least, I thank the Federal University of Santa Catarina\nand the Department of Automation and Systems for having accepted\nme and allowed the use of their facilities and resources. Also, I am very\ngrateful to CAPES and Petrobras for funding, without which this work\nwould not be possible.\n\n\n\n\n\nThe power of rational thinking is the pri-\n\nmary source of freedom in the world.\n\nNeil deGrasse Tyson\n\n\n\n\n\nResumo Extendido\n\nA opera\u00e7\u00e3o de campos de petr\u00f3leo em alto mar implica na transfer\u00eancia\nde \u00f3leo que acumula em Unidades Flutuantes de Produ\u00e7\u00e3o, Armazena-\nmento e Descarregamento (FPSOs em ingl\u00eas) para terminais em terra.\nUma frota de Petroleiros Dinamicamente Posicionados (DPTs em in-\ngl\u00eas), ou navios aliviadores, \u00e9 utilizada para a transfer\u00eancia de \u00f3leo\ndas plataformas ?utuantes at\u00e9 os terminais terrestres, onde depois o\npetr\u00f3leo \u00e9 transportado em grandes petroleiros ou por dutos at\u00e9 as\nre?narias. O escalonamento de uma frota de navios aliviadores, que\nminimiza os custos operacionais e que atenda \u00e0s restri\u00e7\u00f5es do sistema,\nconsiste em um problema complexo.\n\nEste trabalho prop\u00f5e uma formula\u00e7\u00e3o em Programa\u00e7\u00e3o Linear Inteira\nMista (MILP em ingl\u00eas) que avan\u00e7a em rela\u00e7\u00e3o \u00e0 trabalhos anteriores\npela contabiliza\u00e7\u00e3o de tempos de viagem vari\u00e1veis entre plataformas e\nterminais terrestres. As viagens dos navios aliviadores s\u00e3o modeladas\ncomo caminhos em um grafo direcionado tendo o terminal terrestre,\nplataformas ?utuantes e pontos de controle como n\u00f3s, enquanto os ar-\ncos representam os poss\u00edveis movimentos e opera\u00e7\u00f5es de carregamen-\nto/descarregamento dos navios aliviadores.\n\nDo ponto de vista econ\u00f4mico, a frota de navios aliviadores deve ser\nescalonada para maximizar a produ\u00e7\u00e3o de petr\u00f3leo nas plataformas\n?utuantes enquanto minimiza os custos gerados pelas viagens. A com-\nbina\u00e7\u00e3o da formula\u00e7\u00e3o MILP com um solver constitui uma ferramenta\npara auxiliar os engenheiros na tomada de decis\u00f5es. Este problema\npode ser resolvido diariamente utilizando a estrat\u00e9gia de rolling-horizon\npara responder a eventos inesperados.\n\nPalavras-chave: Log\u00edstica para Transporte de Petr\u00f3leo, FPSO, Navios\nAliviadores, Rolling-Horizon, Relax-and-Fix.\n\nNo cap\u00edtulo 1 apresentamos o problema do Planejamento do Supri-\nmento de Petr\u00f3leo que envolve desde a produ\u00e7\u00e3o de \u00f3leo e g\u00e1s nas\nplataformas at\u00e9 o atendimento da demanda do mercado com os sub-\nprodutos bene?ciados nas re?narias. O escalonamento de navios alivi-\nadores constitui um subproblema da cadeia produtiva de petr\u00f3leo e\n\n\n\npossui uma import\u00e2ncia t\u00e1tica dentro do planejamento das opera\u00e7\u00f5es.\n\nNo cap\u00edtulo 2 discutimos alguns conceitos importantes no campo da\notimiza\u00e7\u00e3o. Primeiro de?nimos o que \u00e9 otimiza\u00e7\u00e3o e o que \u00e9 um mod-\nelo de otimiza\u00e7\u00e3o utilizando como exemplo o Problema da Mochila. Em\nseguida, apresentamos o conceito de Programa\u00e7\u00e3o Inteira (IP) e Pro-\ngrama\u00e7\u00e3o Linear Inteira Mista (MILP) e fazemos uma breve discuss\u00e3o\nsobre algoritmos para a solu\u00e7\u00e3o de IPs e MILPs. Tamb\u00e9m introduzi-\nmos o conceito de relaxa\u00e7\u00e3o e sua relev\u00e2ncia na solu\u00e7\u00e3o de problemas de\notimiza\u00e7\u00e3o. Uma se\u00e7\u00e3o \u00e9 dedicada para a introdu\u00e7\u00e3o de conceitos rela-\ncionados com problemas de escalonamento e roteamento e por \u00faltimo\napresentamos alguns m\u00e9todos de otimiza\u00e7\u00e3o din\u00e2mica como o rolling-\nhorizon e relax-and-?x.\n\nNo cap\u00edtulo 3, apresentamos primeiro uma formula\u00e7\u00e3o pr\u00e9via do prob-\nlema que considera os tempos de viagem entre as plataformas e os\nterminais terrestres como ?xos e em seguida, propomos uma nova for-\nmula\u00e7\u00e3o que considera os tempos de viagem vari\u00e1veis. Uma revis\u00e3o da\nliteratura \u00e9 feita com o intuito de relacionar o modelo proposto com\noutros trabalhos. O cap\u00edtulo termina com resultados te\u00f3ricos obtidos\na partir do novo modelo.\n\nNo cap\u00edtulo 4 desenvolvemos a relaxa\u00e7\u00e3o Lagrangeana do problema que\norigina o problema Dual Lagrangeano. Em seguida, apresentamos os\nalgoritmos utilizados para a solu\u00e7\u00e3o do problema dual e ?nalizamos o\ncap\u00edtulo desenvolvendo a decomposi\u00e7\u00e3o da fun\u00e7\u00e3o Dual Lagrangeana\nque quebra a fun\u00e7\u00e3o dual em diversas fun\u00e7\u00f5es, uma para cada navio\naliviador e plataforma, permitindo assim computa\u00e7\u00e3o paralela.\n\nNo Cap\u00edtulo 5 de?nimos uma inst\u00e2ncia exemplo com campos de petr\u00f3leo,\nterminais terrestres e navios aliviadores, no qual as an\u00e1lises computa-\ncionais s\u00e3o feitas. A primeira an\u00e1lise consiste em comparar os limites\nobtidos pela relaxa\u00e7\u00e3o Lagrangeana e a relaxa\u00e7\u00e3o linear do problema.\nOs m\u00e9todos do subgradiente e de gera\u00e7\u00e3o de restri\u00e7\u00f5es sob demanda\nforam utilizados para a solu\u00e7\u00e3o do problema Dual Lagrangeano. Em\nseguida, comparamos a solu\u00e7\u00e3o est\u00e1tica, onde o problema \u00e9 resolvido\npara todo o horizonte de planejamento, com a solu\u00e7\u00e3o din\u00e2mica obtida\nutilizado as heur\u00edsticas de rolling-horizon e relax-and-?x. Estas em\ngeral fornecem solu\u00e7\u00f5es sub-\u00f3timas mas respondem de forma satis-\nfat\u00f3ria \u00e0s grandes inst\u00e2ncias e incertezas do problema. Fechando o\ncap\u00edtulo, a estrat\u00e9gia de rolling-horizon \u00e9 avaliada em um simulador\nque gera perturba\u00e7\u00f5es para vari\u00e1veis do modelo.\n\n\n\nNo cap\u00edtulo 6 conclu\u00edmos a disserta\u00e7\u00e3o com uma an\u00e1lise geral e con-\ntribui\u00e7\u00f5es do trabalho e propomos algumas dire\u00e7\u00f5es para pesquisas\nfuturas.\n\n\n\n\n\nAbstract\n\nThe logistics of operating oil ?elds o? the coast entails transferring\noil that accumulates in Floating Production Storage and O?oading\nUnits (FPSOs) to onshore terminals. A ?eet of Dynamically Positioned\nTankers (DPTs), or shuttle tankers, is deployed for transferring oil from\nthe ?oating platforms to onshore terminals, where the oil is transported\nin large tanker ships or by pipelines to re?neries. The scheduling of a\n?eet of shuttle tankers that minimizes the operating costs while satisfy-\ning the system constraints consists of a complex problem. To this end,\nthis work proposes a formulation in Mixed-Integer Linear Programming\n(MILP) that advances previous works by accounting for variable time\ntravel between ?oating platforms and the onshore terminal. The trips\nof the shuttle tankers are modeled as paths in a directed graph having\nthe onshore terminal, ?oating platforms, and control points as nodes\nand arcs representing possible moves and o?oading operations for the\nshuttle tankers. As a business case, the ?eet of shuttle tankers should\nbe scheduled to maximize oil production from the ?oating platforms\nwhile factoring in the transportation costs. The combination of the\nMILP formulation with an optimization solver constitutes a tool to aid\noperations engineers in making advised decisions. This formulation can\nbe systematically solved daily in a rolling-horizon framework to respond\nto unanticipated events.\n\nKeywords: Oil Transportation Logistics, FPSO, MILP, Shuttle Tankers,\nRolling-Horizon, Relax-and-Fix.\n\n\n\n\n\nContents\n\nList of Figures v\n\nList of Tables vii\n\n1 Introduction 1\n\n1.1 Objectives . . . . . . . . . . . . . . . . . . . . . . . . . . 3\n\n1.2 Dissertation Organization . . . . . . . . . . . . . . . . . 4\n\n2 Fundamentals 6\n\n2.1 Introduction to Mathematical Optimization . . . . . . . 6\n\n2.1.1 Integer Programming . . . . . . . . . . . . . . . 8\n\n2.1.2 MILPs . . . . . . . . . . . . . . . . . . . . . . . . 9\n\n2.2 Solving Strategies . . . . . . . . . . . . . . . . . . . . . . 9\n\n2.2.1 Branch and Bound . . . . . . . . . . . . . . . . . 10\n\n2.2.2 Cutting Plane . . . . . . . . . . . . . . . . . . . . 10\n\n2.2.3 Heuristics . . . . . . . . . . . . . . . . . . . . . . 12\n\n2.3 Lagrangean Duality . . . . . . . . . . . . . . . . . . . . 12\n\n2.3.1 Lagrangean Relaxation . . . . . . . . . . . . . . 13\n\n2.3.2 Lagrangean Dual Problem . . . . . . . . . . . . . 14\n\ni\n\n\n\n2.3.3 Subgradient Method . . . . . . . . . . . . . . . . 15\n\n2.3.4 Constraint Generation Method . . . . . . . . . . 17\n\n2.3.5 Bound Analysis . . . . . . . . . . . . . . . . . . . 18\n\n2.4 Dynamic Optimization . . . . . . . . . . . . . . . . . . . 20\n\n2.4.1 Rolling-Horizon Strategy . . . . . . . . . . . . . 20\n\n2.4.2 Relax-and-Fix Strategy . . . . . . . . . . . . . . 21\n\n2.5 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . 22\n\n3 Problem Formulation 23\n\n3.1 Fixed Travel Time Formulation (FTTF) . . . . . . . . . 23\n\n3.1.1 Formulation . . . . . . . . . . . . . . . . . . . . . 25\n\n3.2 Variable Travel Time Formulation (VTTF) . . . . . . . 28\n\n3.2.1 Problem Representation . . . . . . . . . . . . . . 28\n\n3.2.2 Problem Formulation . . . . . . . . . . . . . . . 29\n\n3.3 Literature Review . . . . . . . . . . . . . . . . . . . . . 34\n\n3.3.1 Similar Works . . . . . . . . . . . . . . . . . . . . 34\n\n3.3.2 Related Works . . . . . . . . . . . . . . . . . . . 36\n\n3.4 Theoretical Results . . . . . . . . . . . . . . . . . . . . . 38\n\n3.4.1 NP-Hardness . . . . . . . . . . . . . . . . . . . . 38\n\n3.4.2 Generalization . . . . . . . . . . . . . . . . . . . 39\n\n3.4.3 A Family of Valid Inequalities . . . . . . . . . . . 41\n\n3.5 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . 43\n\n4 Lagrangean Duality 44\n\n4.1 Lagrangean Relaxation . . . . . . . . . . . . . . . . . . . 44\n\n4.2 Lagrangean Dual Function Decomposition . . . . . . . . 46\n\n4.3 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . 48\n\nii\n\n\n\n5 Computational Analysis 49\n\n5.1 O?shore Oil?eld Scenario . . . . . . . . . . . . . . . . . 49\n\n5.2 Lagrangean Dual Bound . . . . . . . . . . . . . . . . . . 51\n\n5.2.1 Subgradient Solution . . . . . . . . . . . . . . . . 52\n\n5.2.2 Constraint Generation Solution . . . . . . . . . . 53\n\n5.3 Static and Dynamic Analysis . . . . . . . . . . . . . . . 53\n\n5.3.1 Static Solution . . . . . . . . . . . . . . . . . . . 54\n\n5.3.2 Dynamic Solution (Rolling-Horizon and Relax-\nand-Fix) . . . . . . . . . . . . . . . . . . . . . . . 55\n\n5.4 Uncertainty Solution . . . . . . . . . . . . . . . . . . . . 58\n\n5.4.1 Prototype Simulator . . . . . . . . . . . . . . . . 58\n\n5.4.2 Analysis . . . . . . . . . . . . . . . . . . . . . . . 60\n\n5.5 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . 61\n\n6 Conclusion 63\n\n6.1 Contributions . . . . . . . . . . . . . . . . . . . . . . . . 63\n\n6.2 Future Works . . . . . . . . . . . . . . . . . . . . . . . . 64\n\nBibliography 66\n\nAppendix A Mathematical Proofs 71\n\nA.1 Lagrangean Dual Problem Equivalence . . . . . . . . . . 71\n\niii\n\n\n\niv\n\n\n\nList of Figures\n\n1.1 Shuttle Tanker Scheduling Problem (STSP). . . . . . . . 2\n\n2.1 Classical Optimization Fields. . . . . . . . . . . . . . . . 7\n\n2.2 Lagrangean Dual Function l(?) (GUIGNARD, 2003). . 15\n\n2.3 Bound Analysis (GUIGNARD, 2003). . . . . . . . . . . 20\n\n2.4 Rolling-Horizon Strategy. . . . . . . . . . . . . . . . . . 21\n\n2.5 Relax-and-Fix Strategy. . . . . . . . . . . . . . . . . . . 22\n\n3.1 Fixed Travel Time Representation. . . . . . . . . . . . . 28\n\n3.2 Variable Travel Time Representation. . . . . . . . . . . 30\n\n5.1 Subgradient Convergence. . . . . . . . . . . . . . . . . . 53\n\n5.2 Constraint Generation Convergence. . . . . . . . . . . . 54\n\nv\n\n\n\nvi\n\n\n\nList of Tables\n\n3.1 Instance Parameters. . . . . . . . . . . . . . . . . . . . . 42\n\n5.1 Parameters for the Platforms. . . . . . . . . . . . . . . . 50\n\n5.2 Parameters for the Shuttle Tankers. . . . . . . . . . . . 50\n\n5.3 Operating Costs. . . . . . . . . . . . . . . . . . . . . . . 51\n\n5.4 Primal Solution and LP Solution GAP. . . . . . . . . . . 51\n\n5.5 Subgradient Parameters. . . . . . . . . . . . . . . . . . . 52\n\n5.6 Solution for Planning Horizon T = 20. . . . . . . . . . . 54\n\n5.7 Rolling-Horizon Solution. . . . . . . . . . . . . . . . . . 56\n\n5.8 Relax-and-Fix Solution. . . . . . . . . . . . . . . . . . . 57\n\n5.9 Solution Considering Uncertainties. . . . . . . . . . . . . 60\n\nvii\n\n\n\nviii\n\n\n\nChapter 1\n\nIntroduction\n\nOne of the many challenges in the Oil &amp; Gas Industry is\nthe Petroleum Supply Planning Problem (PSPP). In this problem the\ncrude oil is produced in o?shore platforms which is then transferred\nto onshore terminals by sub-sea pipelines or Dynamically Positioned\nTankers (DPTs), here simply called shuttle tankers. After arriving to\nthe onshore terminals, the crude oil is shipped to re?neries to supply\ndomestic demands with its sub-products which include: gaseous fuels,\nliquid fuels (gasoline, kerosene and others), lubricants, para?n wax,\nsulfur, petroleum coke, asphalt, petrochemicals, among others.\n\nWhen deep water o?shore oil exploration is considered, in\nmost of the cases there are no pipelines available and the oil produced\nby a group of wells must be stored in Floating Production Storage and\nO?oading Units (FPSOs), or platforms for short. Although these plat-\nforms have a large storage capacity, often they receive shuttle tankers\nto perform o?oading operations. For the large number of platforms, a\n?eet of shuttle tankers is needed due to high volume of oil that must be\ntransferred from the platforms to onshore terminals. This need gives\nrise to the necessity of scheduling trips of shuttle tankers among plat-\nforms and onshore terminals over a planning horizon. This problem\nis known as the Shuttle Tanker Scheduling Problem (STSP) which is\nillustrated in Figure 1.11. This scenario is composed by three platforms\n(named FPSO 1, FPSO 2 and FPSO 3), two shuttle tankers (named\n\n1Image Credit: Tracey Saxby, IAN Image Library\n(ian.umces.edu/imagelibrary/).\n\n1\n\n\n\n2 Introduction\n\nST1 and ST2) and onshore terminals.\n\nOnshore Terminals\n\nFPSO 1\n\nFPSO 2\n\nFPSO 3\n\nST 1\nST 2\n\nJ-38\n\nI-38\n\nJ-37\n\nFigure 1.1 ? Shuttle Tanker Scheduling Problem (STSP).\n\nThe shuttle tanker scheduling problem can be viewed as a\nbusiness case. First, it is not acceptable to halt production at a platform\ndue to the lack of storage capacity. Besides being a complex operation,\nthe shutting o? wells is a risk procedure that can compromise future\nproduction, since wells can take a considerable time to be brought back\nto full operation and production downtime represents a major loss of\nrevenue. Second, the amount of oil left in the platforms incurs a loss\nof revenue. In other words, the oil owner would have to pay interest\nto access the money equivalent left in the platforms in the form of\noil. On the other hand, there is a cost to bring the oil to the onshore\nterminals. This cost is related to the rental and operation of shuttle\n\n2\n\n\n\nIntroduction 3\n\ntankers. However, much more important than the costs involved in\nthe operation of shuttle tankers, is the need to keep the platforms\nwith su?cient storage capacity to receive the daily production of its\nwells. Therefore, the optimization algorithm must guarantee a proper\no?oading of the platforms.\n\nThe scheduling of shuttle tankers is a logistics problem. Lo-\ngistics decisions consist in deciding when and how materials should\nbe acquired, moved and stored and they can be divided in three hi-\nerarchical levels: strategic, tactical and operational. Strategic is in\nhighest level and the decisions are planned considering the long-term\n(usually over years). They deal with ?eet sizing, facility location and\nlayout and capacity sizing. Tactical decisions consider the medium-\nterm (months or quarterly) and deal with production and distribution\nplanning, transportation mode selection, storage allocations and order\npicking strategies. Finally, in the lowest level, operational decisions deal\nwith warehouse order picking, shipment and vehicle dispatching and are\nmade on a daily basis using very detailed data (GHIANI; LAPORTE;\nMUSMANNO, 2004). This dissertation deals with the tactical level,\nsince we assume that strategic decisions such as ?eet sizing, platforms\nand onshore terminal location, layout and capacity sizing, are already\nknown.\n\nFor the platforms important constraints and parameters like\nproduction rate, storage capacity, minimum volume of oil that the plat-\nforms should have stored to guarantee stability, the number of shuttle\ntankers that can o?oad platforms simultaneously and inventory bal-\nance equations should be considered. For the shuttle tankers, con-\nstraints and parameters like storage capacity, volume of oil to be of-\n?oaded from platforms and the inventory balance play an important\nrole.\n\n1.1 Objectives\n\nThe overall objective of this dissertation is the development,\nvalidation and analysis of a Mixed-Integer Linear Programming Model\nfor scheduling shuttle tankers for o?shore oil o?oading operations. The\nspeci?c goals are the following:\n\n? Extension of a previous formulation to account variable travel\n\n3\n\n\n\n4 Introduction\n\ntime for shuttle tankers and other operating constraints.\n\n? Theoretical assessment of the computational hardness of the vari-\nable travel-time formulation and its relation with preceding for-\nmulation.\n\n? Proposition and analysis of Lagrangean relaxation as strategy to\ngenerate dual bounds.\n\n? Computational analysis of the variable travel-time formulation\nfor scheduling shuttle tankers in representative o?shore oil ?elds.\n\n? Computational analysis of dynamic optimization strategies to\nhandle large problem instances, namely the rolling-horizon and\nrelax-and-?x strategies.\n\n1.2 Dissertation Organization\n\nThis dissertation is divided in six chapters. They are the\nfollowing:\n\n? In chapter 2, some optimization background is presented. We de-\n?ne what is optimization and what is an optimization model; the\nconcept of Integer Programming (IP) and Mixed-Integer Linear\nProgramming (MILP) and algorithms to solve it; the de?nition\nof a relaxation and its relevance to solving optimization prob-\nlems; scheduling and routing problems; and last but not least we\ndiscuss about dynamic optimization methods used to solve the\nShuttle Tanker Scheduling problem.\n\n? In chapter 3, we ?rst present a prior formulation for the STSP,\nwith ?xed travel times, and then propose a revised model with\nvariable travel times. A review of literature was carried out to\nrelate this dissertation to other technical works. The chapter ends\nwith theoretical results regarding some properties of the revised\nmodel.\n\n? In chapter 4, we present the Lagrangean relaxation of the STSP,\nalgorithms to solve the Lagrangean dual problem and the La-\ngrangean dual function decomposition.\n\n4\n\n\n\nIntroduction 5\n\n? In chapter 5, we propose an o?shore oil ?eld scenario for the\ncomputational analysis and the computational set up. A bound\nanalysis regarding the Lagrangean relaxation and the linear re-\nlaxation of the problem is presented. The rolling-horizon and\nrelax-and-?x heuristics are compared with respect to their per-\nformance in the scenario. Further, the rolling-horizon strategy\nis evaluated in a prototype simulator which generates random\nperturbations to the variables of the model.\n\n? In chapter 6, we conclude the dissertation with a general view\nand contributions of the work and propose some directions for\nfurther research.\n\n5\n\n\n\nChapter 2\n\nFundamentals\n\nIn this chapter, we present some optimization concepts con-\nsidering Integer Programming (IP) and Mixed-Integer Linear Program-\nming (MILP) to provide the mathematical foundation for the work\ndeveloped in this dissertation.\n\n2.1 Introduction to Mathematical Optimiza-\ntion\n\nA classical optimization problem is the Knapsack Problem\n(NEMHAUSER; WOLSEY, 1988). In this problem we have a set of\nitems (each one with a mass and a price) and a knapsack. We would\nlike to know which is the most valuable collection of items that we can\ncarry, given a ?xed knapsack with a limited capacity. The selection\nof the best items from a set, regarding some constraints (in this case,\nthe size of the knapsack), in order to maximize or minimize a quantity\ncan be a simple and direct way to illustrate optimization. This seems\ntrivial, however, optimization problems can become complex depending\non their nature and size.\n\nAn example of a Knapsack Problem taken from (FISHER,\n1985) can be seen in Problem 2.1. KS is formed by Equations (2.1a)-\n(2.1f) and represents the model of the Knapsack Problem. Equation\n(2.1a) is called objective function or cost function and it is the quantity\n\n6\n\n\n\nFundamentals 7\n\nthat we want to maximize. Equations (2.1b)-(2.1d) are the constraints\nof the problem. The domain is established by Equation (2.1e) and\nEquation (2.1f) de?nes the nature of the variables xj, j = 1, . . . , 4.\n\nProblem 2.1 belongs to a set of problems classi?ed as Integer\nProgramming, since its variables xj, j = 1, . . . , 4 are integers. Besides\nInteger Programming problems, the ?eld of optimization is composed\nby other sets of problems. Figure 2.1 shows the main ?elds of optimiza-\ntion.\n\nKS : f = max\nx\n\n16x1 + 10x2 + 4x4 (2.1a)\n\ns.t. :\n\n8x1 + 2x2 + x3 + 4x4 ? 10 (2.1b)\nx1 + x2 ? 1 (2.1c)\nx3 + x4 ? 1 (2.1d)\n0 ? xj ? 1, j = 1 . . . 4 (2.1e)\nxj ?Z, j = 1 . . . 4 (2.1f)\n\nCombinatorialROptimization\n\nConvexRandRNonsmoothROptimization\n\nGlobalROptimization\n\nIntegerRProgramming\n\nLinear,RConeRandRSemidefiniteRProgramming\n\nNetworkROptimization\n\nNonlinearROptimization\n\nRobustROptimization\n\nStochasticRProgramming\n\nDynamicRProgrammingHeuristics\n\nFigure 2.1 ? Classical Optimization Fields.\n\n7\n\n\n\n8 Fundamentals\n\n2.1.1 Integer Programming\n\nA wide variety of practical problems can be formulated and\nsolved using integer programming: train scheduling, airline crew schedul-\ning, production planning, electricity generation planning and cutting\nproblems, among others (WOLSEY, 1998). An integer program has its\nobjective function and constraints linear and its variables are discrete\nand continuous. A generic integer programming problem with only\ninteger variables is de?ned as follows:\n\nIP : f = max\nx\n\ncTx (2.2a)\n\ns.t. :\n\nAx ? b (2.2b)\nx ? Zn+ (2.2c)\n\nA is a m \u00d7 n matrix, x and c are n-dimensional column\nvectors and b is a m-dimensional column vector. Some variations of\nProblem 2.2 are: mixed-integer linear programming (MILP), binary\ninteger programming (BIP) and combinatorial programming (CP).\n\nFormulating an integer programming problem consists in de?n-\ning the parameters, variables, the set of constraints and the objective\nfunction of the problem. According to Wolsey (1998) the concept of\npolyhedron and formulation are de?ned as follows:\n\nDe?nition 1. A subset of Rn described by a ?nite set of linear con-\nstraints P = {x ?Rn : Ax ? b} is de?ned as a polyhedron.\n\nDe?nition 2. A polyhedron P ? Rn+p is a formulation for a set\nX ? (Zn \u00d7Rp) if and only if X = P ? (Zn \u00d7Rp), X being the set of\nall feasible solutions.\n\nA problem can have an in?nite number of formulations. Con-\nsidering that, it is possible to think that there should be a best one.\nWhen the perfect formulation is obtained it does not matter if the inte-\nger programming or its linear relaxation is solved, since they will both\ngive the same result. Wolsey (1998) de?nes the ideal formulation as\nfollows:\n\nDe?nition 3. Given a set X ?Rn, the convex hull of X, denoted by\nconv(X), is the convex combination of all points in X and it is de?ned\n\n8\n\n\n\nFundamentals 9\n\nas: conv(X) = {x : x =\n?t\ni=1 ?ix\n\ni,\n?t\ni=1 ?i = 1,?i ? 0 for i = 1, . . . , t,\n\nover all ?nite subsets {x1, . . . ,xt} of X}.\n\nConsidering De?nition 3 it is possible to conclude that conv(X)\nis a polyhedron and its extreme points all lie in X.\n\n2.1.2 MILPs\n\nThe Shuttle Tanker Scheduling problem, the focus of this dis-\nsertation, belongs to a speci?c set of optimization problems classi?ed as\nMixed-Integer Linear Programming (MILP). MILPs are a subset of in-\nteger programming problems whose objective function and constraints\nare linear and variables are discrete and continuous. A generic MILP\nproblem is formulated as follows:\n\nMILP : f = max\nx,y\n\ncTx + gTy (2.3a)\n\ns.t. :\n\nAx ? b (2.3b)\nCy ? d (2.3c)\nx ?Zn+ (2.3d)\ny ?Rm+ (2.3e)\n\nwhere c, g, x, y, b and d are vectors and A and C are matrices (all\nvectors and matrices are with the right dimensions).\n\n2.2 Solving Strategies\n\nConsidering the complexity of integer programming, some\nstrategies are necessary to solve this type of problems. In this sec-\ntion we discuss in a basic way the Branch and Bound, Cutting Plane,\nBranch and Cut and Heuristics. Other strategies like the Dantzig-Wolf\n(based on column generation) and Benders' (based on row generation)\ndecompositions can also be employed, but will not be discussed.\n\n9\n\n\n\n10 Fundamentals\n\n2.2.1 Branch and Bound\n\nThe branch and bound strategy can be seen as a decompo-\nsition algorithm based on a divide and conquer approach, in which a\nproblem is broken into smaller and easier subproblems and its lower and\nupper bounds are used to solve the original problem. This algorithm\nhas the structure of a tree, with nodes representing the subproblems\nand the edges the constraints (or bounds) to be added to the new sub-\nproblems.\n\n2.2.2 Cutting Plane\n\nFrom De?nition 3 we can conclude that it is possible to re-\nformulate an integer program as a linear program max{cTx : A?x ?\nb?,x ? 0}. In other words, an optimal extreme point solution of a lin-\near program is an optimal solution of an integer program provided that\nP? = {x : A?x ? b?,x ? 0} = conv(X) (WOLSEY, 1998). The same\nholds for MILPs.\n\nFor NP-Hard problems like the Shuttle Tanker Scheduling\nproblem it is very di?cult to describe conv(X). The aim of cutting\nplane algorithms is to try to approximate conv(X) for a given instance.\nSaid that, an important concept is the de?nition of a valid inequality:\n\nDe?nition 4. An inequality ?Tx ? ?0 is a valid inequality for X ?\nRn if ?Tx ? ?0 for all x ? X.\n\nValid inequalities can be seen simply as constraints that are\nsatis?ed by all x ? X.\n\n2.2.2.1 Chav\u00e1tal-Gomory Procedure\n\nAssuming that we do not have a family of valid inequalities,\nwe can use the Chav\u00e1tal-Gomory procedure to obtain them (Theorem\n1).\n\nTheorem 1. Every valid inequality for the set X = P ?Zn, where\nP = {x ? Rn+ : Ax ? b}, A is a m \u00d7 n matrix with columns\n{a1,a2, . . . ,an} and u ?Rm+ , can be obtained by applying the Chav\u00e1tal-\nGomory procedure a ?nite number of times.\n\n10\n\n\n\nFundamentals 11\n\nThe procedure is de?ned as follows:\n\n1. The inequality\n?n\nj=1 uajxj ? ub is valid for P , since u ? 0 and?n\n\nj=1 ajxj ? b is valid for P ,\n\n2. The inequality\n?n\nj=1buajcxj ? ub is valid for P as x ? 0,\n\n3. The right hand side must also be integer. Therefore, the inequal-\nity\n?n\nj=1buajcxj ?bubc is valid for X as x is integer.\n\nConsequently, the procedure generated the valid inequality?n\nj=1buajcxj ?bubc.\n\nThis procedure is su?cient to generate all valid inequalities\nfor an integer program. The challenge consists in de?ning the non-\nnegative weights vector u and verify how useful these valid inequalities\nare for the problem at hand.\n\n2.2.2.2 Cutting Plane Algorithm\n\nConsider that X = P ?Zn and that we have a family F of\nvalid inequalities ?Tx ? ?0, (?,?0) ?F for X. The set F can contain\nan enormous quantity of inequalities to be added a priori and some of\nthem may not be useful for the problem instance. An alternative is to\nadd valid inequalities from F interactively, so as to cut o? infeasible\nsolutions (solutions that violated some inequality of the family F)\n\nFirst we solve the linear relaxation of the problem. The opti-\nmal value is tested for being an integer solution. If not, we can search\nfor a linear inequality that separates this fractional solution from the\nfeasible set. The problem of ?nding such an inequality is called the sep-\naration problem and the inequality is a cut. When the cut is added to\nthe linear program, the current non-integer solution is no longer feasi-\nble to the relaxation. This process is repeated until an optimal integer\nsolution is reached or no cutting planes can be found.\n\nSome other strategies to generate valid inequalities like the\nGomory's Fractional Cutting Plane Algorithm, the Gomory Mixed In-\nteger Cut and Disjunctive Inequalities can also be used.\n\nIdeally, we would ?nd Strong Valid Inequalities that are ex-\npected to be more e?ective and to lead to a stronger formulation. The\n\n11\n\n\n\n12 Fundamentals\n\ninterested reader may refer to Wolsey (1998) for a detailed discussion\non strong valid inequalities.\n\nThe possibility of introducing cutting planes on demand has\ngiven rise to the Branch and Cut Method, a strategy based on branch\nand bound which adds cutting planes at the nodes of the enumeration\ntree. It is the branch and bound with cutting planes been generated\nalong its tree. Rather than reoptimizing fast at each node, like the\nbranch and bound strategy, the new philosophy attempts to tighten\nthe dual bound by introducing cutting planes and consequently reduce\nthe number of nodes. There is a trade-o? in the sense that if many\ncuts are added at each node, reoptimizing can take much longer and\nkeeping all information in the tree can take much more memory.\n\n2.2.3 Heuristics\n\nMany practical problems that we wish to solve are NP-Hard\nand approximation algorithms or heuristics play an important role in\nthat matter. Heuristics do not guarantee optimality, instead they at-\ntempt to quickly achieve a good feasible solution (WOLSEY, 1998).\nGreedy, local search, and genetic algorithms are examples of heuristics\nfor integer programming problems.\n\n2.3 Lagrangean Duality\n\nAccording to Geo?rion (1974), the relaxation of a optimiza-\ntion problem (a maximization one) is de?ned as follows.\n\nDe?nition 5. The problem RPmax : max{g(x)|x ? W} is a relax-\nation of the problem Pmax : max{f(x)|x ? V}, with the same decision\nvariables x, if and only if:\n\n1. The feasible set of RPmax contains the feasible set of Pmax, i.e.,\nW ?V.\n\n2. Over the feasible set of Pmax, the objective function of RPmax is\nalways equal or greater than the objective function of Pmax, i.e.,\n?x ?V,g(x) ? f(x).\n\n12\n\n\n\nFundamentals 13\n\nConsidering v(Pmax) the optimal value of problem Pmax, a\nconsequence of De?nition 5 is that v(RPmax) ? v(Pmax). In other\nwords, RPmax can be considered as an optimistic version of Pmax.\n\nTwo types of relaxations can be mentioned: the Linear Relax-\nation which ignores the integrality constraint on the decision variables\nand the Lagrangean Relaxation which will be discussed below.\n\nThe objectives of relaxing a problem are two: obtain bounds\non the optimal value of complex problems; use their solutions, that most\nof the cases are infeasible for the original problem, as initial points for\nspecialized heuristics to obtain a primal feasible solution.\n\n2.3.1 Lagrangean Relaxation\n\nThe Lagrangean relaxation is a technique which can be used\nto simplify an optimization problem and obtain dual bounds for the\nobjective function. This technique is presented and discussed in the\nworks of Guignard (2003), Geo?rion (1974), Fisher (1985) and Wolsey\n(1998), among others.\n\nA generic integer programming problem is given in Problem\n2.4, where c, x, b and d are vectors and A and C are matrices (all\nvectors and matrices are with the right dimensions). Suppose that the\nset of constraints (2.4b) is complicating, in the sense that if we remove\nit from the problem, it becomes easier to solve.\n\nZ : f = max\nx\n\ncTx (2.4a)\n\ns.t. : Ax ? b (2.4b)\nCx ? d (2.4c)\nx ? X (2.4d)\n\nwhere X de?nes the integrality constraints. The linear relaxation LP\nof Z is obtained by dropping the integratility constraints from problem\n(2.4), namely the problem given by Equations (2.4a) through (2.4c).\n\nThe Lagrangean relaxation of this problem is de?ned as fol-\n\n13\n\n\n\n14 Fundamentals\n\nlows:\n\nZLGR : l(?) = max\nx\n\ncTx + ?T (b?Ax) (2.5a)\n\ns.t. : Cx ? d (2.5b)\nx ? X (2.5c)\n\nwhere l(?) is the Lagrangean dual function. Note that Problem 2.5 is\na relaxation of Problem 2.4 for the following reasons:\n\n1. The objective function cTx + ?T (b ? Ax) ? cTx, since ? ? 0\nand b ? Ax ? 0 for any feasible solution of Problem 2.4. For\nan infeasible solution of Problem 2.4, the added term will have\nnegative sign.\n\n2. The feasible region of Problem 2.4 is contained in the feasible\nregion of Problem 2.5.\n\nIt is important to note that the bound provided by the La-\ngrangean dual function depends on which constraints were dualized.\nThe in?uence of the dualized constraints on the e?ectiveness of the\ndual bound will be described latter in this chapter.\n\n2.3.2 Lagrangean Dual Problem\n\nGiven the Lagrangean relaxation problem ZLGR, which ?\ngives the tightest bound for the integer problem Z? The goal is to\nminimize the increase that the dualized constraints provide in the ob-\njective function, meaning the minimization of l(?). From this arises\nthe Lagrangean dual problem:\n\nZLD : min\n?\n\nl(?) (2.6a)\n\ns.t. : ? ? 0 (2.6b)\n\nLet X = {x ? X : Cx ? d} be the set of feasible points of\nthe Lagrangean relaxation problem. Notice that X = {x1, . . . ,xm} is\na countable set assuming that the polyhedron {x ? Rn : Cx ? d} is\nbounded.\n\nNow, the Lagrangean dual function l(?) can be seen as the\n\n14\n\n\n\nFundamentals 15\n\nupper envelope of a set of a?ne functions of ? which lead to the fol-\nlowing reformulation of ZLD:\n\nZLD : min\n??0\n\nl(?) = min\n??0\n\nmax\nx?X\n\nf(x) + ?T (b?Ax)\n\n= min ?\n\ns.t. : ? ? f(x) + ?T (b?Ax), ?x ?X\n? ? 0\n\nThe Lagrangean dual problem ZLD becomes a convex non-\ndi?erentiable piecewise-linear minimization problem of ? (Figure 2.2).\nConsidering the characteristics of problem ZLD, special algorithms like\nthe Subgradient method and the Constraint Generation Method can be\napplied to ?nd the lowest upper bound for the optimal f.\n\n? = 2 + ?(  2) \n?\n\ncx b-Ax\n\n? = 1 + cx ? (\n1) \n\n1\n\n2\ncx\n\n?\n\ncx\nk\n\nb-Ax\n\nb-Ax\n\n? = k + cx ?( k ) \n\ncx\n\nl(?)\n\nFigure 2.2 ? Lagrangean Dual Function l(?) (GUIGNARD, 2003).\n\n2.3.3 Subgradient Method\n\nThe Lagrangean dual function l(?) is known to be convex\nand therefore can be minimized using descent methods (BAZARAA;\nSHERALI; SHETTY, 2006; FISHER, 1985). Because l(?) is non-\ndi?erentiable, the gradient descent method is not applicable and there-\n\n15\n\n\n\n16 Fundamentals\n\nfore the subgradient algorithm is an alternative.\n\nLet x(?) denote a solution for the Lagrangean dual function\nl(?) associated to ?. The ?rst step is computing the subgradient ?l(?)\nfor l at ?, which is easily obtained from x(?) as follows:\n\n?l(?) = b?Ax(?) (2.7)\n\nAt each iteration k the subgradient method solves l(?k) to\nobtain the dual solution xk(?k). Then, the subgradient ?l(?k) of l at\n?k is computed according with Equation (2.7) and the updating rule\nis used:\n\n?k+1 = max{?k ?\u00b5k?l(?k),0}\n\nto obtain the next Lagrange multiplier ?k+1, where \u00b5k > 0 is a scalar.\nThe subgradient method is described by Algorithm 1. The input data\nare the initial guess ?0 for the Lagrange multiplier vector, the ini-\ntial step \u00b5, the decrement of the step dec\u00b5 and the maximum num-\nber of iterations itmax. While the maximum number of iterations is\nnot achieved, we solve the Lagrangean relaxation problem ZLGR for\nthe current ?k and update xk(?k) and the Lagrangean dual bound\nactualLGRBOUND. Next, the subgradient and the Lagrange multiplier\n?k+1 for the next iteration are computed. The policy for updating the\nstep of the method \u00b5 is done by checking if the Lagrangean dual bound\nis decreasing in each iteration; if not, \u00b5 is multiplied by dec\u00b5.\n\nLet {\u00b5k}?k=1 be a sequence of positive steps satisfying a con-\nvergence condition such as the decreasing and non-summing condi-\ntion, namely\n\n??\nk=1 \u00b5k = ? and limk??\u00b5k = 0. For such a step\n\nsequence, the subgradient method yields a sequence of dual (upper)\nbounds {l(?k)}?k=1 converging to l(?\n\n?) (WOLSEY, 1998) which is the\nlowest higher bound induced by the optimal dual solution ?? of the\nLagrangean dual problem ZLD. Although this method is not expensive\ncomputationally, it does not have a stopping criteria and guarantees\nconvergence only in theory.\n\n16\n\n\n\nFundamentals 17\n\nAlgorithm 1: Subgradient Method.\n\nData: ?0,\u00b5,dec\u00b5, itmax.\nResult: ?k that minimizes l(?).\nprevLGRBOUND = 10e10;\nactualLGRBOUND = 10e10;\nwhile (it ? itmax) do\n\nprevLGRBOUND ? actualLGRBOUND;\nxk, actualLGRBOUND ? solve ZLGR for ?k;\nsubgradk ? (b?A?xk?k);\n?k+1 ? max{0,?k ?\u00b5?subgradk};\nif (actualLGRBOUND &lt;prevLGRBOUND) then\n\n\u00b5 ? \u00b5;\nelse\n\n\u00b5 ? \u00b5?dec\u00b5;\nend\nit = it + 1;\n\nend\n\n2.3.4 Constraint Generation Method\n\nThis method relies on the fact that the Lagrangean dual func-\ntion l(?) is the upper envelope of a family of linear functions.\n\nZLD : = min ?\n\ns.t. : ? ? f(x) + ?T (b?Ax), ?x ?X\n? ? 0\n\nwhere X is the set of all feasible solutions of the Lagrangean relaxation\nZLGR. At each iteration, the method generates constraints with the\nfollowing form:\n\n? ? f(x) + ?T (b?Ax)\n\nby solving the Lagrangean relaxation l(?k) for the current Lagrange\nmultiplier ?k to obtain the solution xk. These constraints are added\nto those generated previously to form the linear programming master\n\n17\n\n\n\n18 Fundamentals\n\nproblem MP :\n\nMP : ?k = min ? (2.8a)\n\ns.t. : ? ? f(xl) + ?T (b?Axl), l = 1, . . . ,k (2.8b)\n? ? 0 (2.8c)\n\nwhose solution yields the next iterate ?k+1 for the Lagrangean relax-\nation. The process terminates when ?k = l(?k+1), which is the optimal\nvalue of the Lagrangean dual problem ZLD. The constraint generation\nmethod is described in Algorithm 2. The entry data is the initial guess\n?0 for the Lagrange multiplier. The algorithm runs until the optimal\nvalue of the master problem MP (?k) is equal to the value of the La-\ngrangean dual function l(?k+1). In each iteration we solve the ZLGR\nfor the current ?k and and update the solution xk. Then, we calculate\nthe angular and coe?cients for the new cut to be added to the master\nproblem MP . The solution of the master problem generates the new\nLagrange multiplier ?MP to be used in the next iteration.\n\nAlgorithm 2: The Constraint Generation Method.\n\nData: ?0.\nResult: ?k that minimizes l(?k).\nwhile (?k 6= l(?k+1)) do\n\nxk ? solveZLGR for ?k;\nlinearCOEF ? cTxk;\nangularCOEF ? (b?A?xk);\nAddCut(? ? linearCOEF + ?MP ?angularCOEF);\n?MP ? solveMP;\n?k+1 ? ?MP ;\nk = k + 1;\n\nend\n\n2.3.5 Bound Analysis\n\nAccording to Geo?rion (1974) it is possible to prove that the\nLagrangean dual problem ZLD is equivalent to the following Primal\n\n18\n\n\n\nFundamentals 19\n\nRelaxation:\n\nPR : f = max\nx\n\ncTx (2.9)\n\ns.t. :\n\nAx ? b (2.10)\nconv{x ? X|Cx ? d} (2.11)\n\nProof.\n\nv(ZLD) = min\n??0\n\nv(ZLGR) (2.12)\n\n= min\n??0\n\nmax\nx\n{cTx + ?T (b?Ax)|Cx ? d,x ? X} (2.13)\n\n= min\n??0\n\nmax\nx\n{cTx + ?T (b?Ax)|x ? conv{x ? X|Cx ? d}}\n\n(2.14)\n\n= max\nx\n{cTx|Ax ? b,x ? conv{x ? X|Cx ? d}} (2.15)\n\n= v(PR) (2.16)\n\nwhere v(ZLD), v(ZLGR) and v(PR) are respectively the optimal values\nof the Lagrangean dual, Lagrangean relaxation and the Primal relax-\nation.\n\nEquation (2.14) is true because the maximum of a linear func-\ntion over a bounded, discrete set of points is equal to the maximum of\nthat linear function over the convex hull of this set of points. Equa-\ntion (2.15) is true by linear programming duality because conv{x ?\nRn|Cx ? b,x ? X} is a bounded polyhedron and the problem in\nEquation (2.15) is a feasible bounded linear program. This proof is\ndetailed in Appendix A.\n\nConsidering the demonstration above and Figure 2.3, it is\npossible to make the following observations:\n\n1. If conv{x ? X|Cx ? d} = {x|Cx ? d}, then v(Z) ? v(PR) =\nv(ZLD) = v(LP), where v(Z), v(PR), v(ZLD) and v(LP) stand\nfor, respectively, to the optimal values of the original problem, the\nprimal relaxation, the Lagrangean dual problem and the linear\nrelaxation of the original problem. In this case, the Lagrangean\ndual problem has the Integrality Property. In other words, if we\n\n19\n\n\n\n20 Fundamentals\n\nsolve the Lagrangean dual problem relaxing the integrality of its\ninteger variables, they would still get integer values. In this case,\nthe Lagrangean relaxation bound is equal to the linear relaxation\nbound.\n\n2. If conv{x ? X|Cx ? d} ? {x|Cx ? d}, then v(Z) ? v(PR) =\nv(ZLD) ? v(LP) and the Lagrangean relaxation bound is better\nthan the linear relaxation bound.\n\n{x?X Cx ? d} \n\n{x Cx ? d} \n{x Ax ? b} \n\nRELAX\n\nKEEP\n\nx \n\nx \n\nx \nx \n\nx \n\nx x x\n\n{x|Ax ? b}?\n{x?X |Cx? d}  \n\n|\n\n|\n|\n\nconv\n\nconv\n\nv(LP)\n\nv(PR)\n\nv(Z)\n\nFigure 2.3 ? Bound Analysis (GUIGNARD, 2003).\n\n2.4 Dynamic Optimization\n\nHere we present the rolling-horizon and the relax-and-?x strate-\ngies that were designed and implemented to solve the shuttle tanker\nscheduling problem. A synthesis of these strategies is given below.\n\n2.4.1 Rolling-Horizon Strategy\n\nConsider that we would like to plan the trips of the shuttle\ntankers for a planning horizon of length T periods. The rolling-horizon\nstrategy (RHS) (MOHAMMADI et al., 2010; LI; IERAPETRITOU,\n2010; TANG; JIANG; LIU, 2010; BERALDI et al., 2008), as illus-\ntrated in Figure 2.4, consists in de?ning a time window, also called\nprediction horizon (PH), which is smaller than the planning horizon\n\n20\n\n\n\nFundamentals 21\n\nT . The optimization algorithm runs over this time window and only\nthe actions of the ?rst period are implemented (highlighted in green).\nThen, the time window slides one period towards the future, the state\nof the system (state variables) is updated and the process is repeated\nuntil reaching the end of the planning horizon T . In general this strat-\negy gives sub-optimal solutions for the problem but is useful to deal\nwith large problems instances.\n\ni=1\n\ni=2\n\ni=T-PH+1\n\n1 2 TPH\n\n2 TPH\n\nPHT-PH+1\n\nPrediction Horizon (PH)\n\nPrediction Horizon (PH)\n\nPrediction Horizon (PH)\n\nFigure 2.4 ? Rolling-Horizon Strategy.\n\n2.4.2 Relax-and-Fix Strategy\n\nThe relax-and-?x strategy is a branch of the rolling-horizon\nstrategy (DILLENBERGER et al., 1994; MOHAMMADI et al., 2010;\nBERALDI et al., 2008). Like the RHS, we de?ne a prediction hori-\nzon smaller than the planning horizon T. The di?erence is that the\noptimization algorithm also takes into account the periods beyond the\nprediction horizon (highlighted in red). However, the variables beyond\nare relaxed and the variables inside preserve their integral nature. Only\nthe actions of the ?rst period are implemented (highlighted in green).\nThen, the time window slides one period towards the future, the state\nof the system (state variables) is updated and the process is repeated\nuntil reaching the end of the planning horizon T. Figure 2.5 illustrates\nthe process. Like the rolling-horizon, this strategy gives sub-optimal\nsolutions for the problem but is useful to deal with large problems in-\n\n21\n\n\n\n22 Fundamentals\n\nstances.\n\ni=1\n\ni=2\n\ni=T-PH+1\n\n1 2 PH\n\n2 PH\n\nPHT-PH+1\n\nPrediction Horizon (PH)\n\nT\n\nT\n\nPrediction Horizon (PH)\n\nPrediction Horizon (PH)\n\nFigure 2.5 ? Relax-and-Fix Strategy.\n\n2.5 Summary\n\nIn this chapter we introduced some optimization concepts\nsuch as what is optimization and what is an optimization model using\nas example the Knapsack problem. Following, we presented the concept\nof Integer Programming (IP) and Mixed-Integer Linear Programming\n(MILP) and made a brief discussion on strategies to solve IPs and\nMILPs. We also introduced the concept of relaxation and its relevance\nfor solving optimization problems. Finally, a section was dedicated to\ndiscuss rolling-horizon and relax-and-?x heuristics.\n\n22\n\n\n\nChapter 3\n\nProblem Formulation\n\nIn this chapter, we ?rst present a former formulation for the\nshuttle tanker scheduling problem with ?xed travel times. Then, we\npropose a revised new model which accounts with variable travel times.\nNext, a review of literature is carried out to relate the new proposed\nmodel to other technical works. The chapter ends with results regarding\nsome theoretical properties of the revised model.\n\n3.1 Fixed Travel Time Formulation (FTTF)\n\nIn this section we present and discuss the formulation pro-\nposed in (CAMPONOGARA; PLUCENIO, 2014) because this disser-\ntation will extend this previous formulation to account for variable\ntravel times for shuttle tankers.\n\nThe following parameters appear in the formulation:\n\n? F = {1, . . . ,F} is the set of platforms.\n\n? S = {1, . . . ,S} is the set of shuttle tankers to be scheduled.\n\n? T = {1, . . . ,T} is the set of periods, which de?nes a time horizon\nof length T , over which the shuttle tanker moves and o?oad-\ning/uploading operations are to be carried out. The periods of\nthe horizon correspond to days.\n\n23\n\n\n\n24 Problem Formulation\n\n? U = {0}?F is the set of platforms augmented with the onshore\nterminal, represented by 0.\n\n? G = (U,E) is a graph whose nodes U represent the positions where\nshuttle tankers can be stationed, with E = U\u00d7U being the set of\narcs representing their possible moves.\n\n? US0s ?U is the initial position and V D0s de?nes the initial volume\nof oil stored in a shuttle tanker s, in m3, which establish the initial\nconditions for the shuttle tankers.\n\n? V Dmaxs is the storage capacity of tanker s in m\n3.\n\n? V F 0u is the initial oil stock, V F\nmax\nu is the storage capacity and\n\nV F minu is the minimum volume that should be stored, in m\n3, in\n\na platform u.\n\n? V F oflu,s is the pre-de?ned volume of oil, in m\n3, that must be of-\n\n?oaded from platform u by shuttle tanker s each time a shuttle\ntanker visits the platform.\n\n? QFtu is the daily production rate of oil to be produced by platform\nu during period t, given in m3/day.\n\n? Ch,tu is the inventory holding cost tied up to the oil left in plat-\nforms, in $.\n\n? Ct0,u is cost of a shuttle tanker trip between the onshore terminal\nand a platform. This cost might be di?erent from the average\ncost of tanker trips between platforms.\n\n? Ctu,v is the cost of a trip between a given platform to another,\nwhich is considered the same for all pairs of platforms since the\ndi?erences between these distances are negligible. In an o?shore\noil ?eld, the distances between platforms are relatively small with\nrespect to the distance to the onshore terminal.\n\nThe variables of the formulation are the following:\n\n? xtu,s ? B = {0, 1} takes on value 1 if shuttle tanker s is at node u\nat the end of period t, otherwise it assumes value 0. This variable\nde?nes the scheduling of the shuttle tankers.\n\n? vdts is the volume of oil stored in shuttle tanker s at the end of\nperiod t, given in m3.\n\n24\n\n\n\nProblem Formulation 25\n\n? vftu is the volume of oil stored by platform u at the end of period\nt, in m3.\n\n? vdaux,ts is an auxiliary variable used to implement the shuttle\ntanker unloading at the onshore terminal, given in m3.\n\n? yt0,s ? B takes on value 1 if tanker s arrives at or departs from\nthe onshore terminal during period t and 0 otherwise.\n\n? ytu,s ? B takes on value 1 if tanker s arrives at platform u during\nperiod t coming from another platform.\n\n3.1.1 Formulation\n\nAfter introducing all sets, parameters and variables, the STSP\ncan be cast as the following MILP:\n\nP : min f =\n?\nu?F\n\n?\nt?T\n\nCh,tu\n(\nvftu ?V F\n\nmin\nu\n\n)\n+\n?\ns?S\n\n?\nt?T\n\nCt0,uy\nt\n0,s\n\n+\n?\nu?F\n\n?\ns?S\n\n?\nt?T\n\nCtu,vy\nt\nu,s (3.1a)\n\nsubject to: ?\nu?U\n\nxtu,s = 1, ?s ?S, ?t ?T ?{0} (3.2a)\n\n??\n?\n\nx0u,s = 1, u = US\n0\ns\n\nx0u,s = 0, ?u ?U \\{US0s}\nvd0s = V D\n\n0\ns\n\n?s ?S (3.2b)\n\nvf0u = V F\n0\nu, ?u ?F (3.2c)?\n\ns?S\nxtu,s ? 1, ?u ?F, ?t ?T (3.2d)\n\n25\n\n\n\n26 Problem Formulation\n\n???\n??\n\nvftu = vf\nt?1\nu + QF\n\nt\nu ?\n\n?\ns?S\n\nV F oflu x\nt\nu,s\n\nvftu ? V F maxu\nvftu ? V F minu\n\n?u ?F,?t ?T (3.2e)\n\n?????\n????\n\nvdaux,ts = vd\nt?1\ns +\n\n?\nu?F\n\nV F oflu x\nt\nu,s\n\nvdts ? V Dmaxs (1 ?xt0,s)\nvdts ? vdaux,ts ?V Dmaxs xt0,s\nvdts ? vdaux,ts\n\n?s ?S,?t ?T (3.2f)\n\n?yt0,s ? x\nt\n0,s ?x\n\nt?1\n0,s ? y\n\nt\n0,s, ?s ?S, ?t ?T (3.2g)\n\nxtu,s ?x\nt?1\nu,s ?x\n\nt?1\n0,s ? y\n\nt\nu,s, ?u ?F, ?s ?S, ?t ?T (3.2h)\n\nvdts ? 0, ?s ?S, ?t ?T ?{0} (3.2i)\nvdaux,ts ? 0, ?s ?S, ?t ?T (3.2j)\nvftu ? 0, ?u ?F, ?t ?T ?{0} (3.2k)\nxtu,s ?{0, 1}, ?u ?U, ?s ?S, ?t ?T ?{0} (3.2l)\nytu,s ?{0, 1}, ?u ?U, ?s ?S, ?t ?T . (3.2m)\n\nThe objective function, de?ned by Eq. (3.1a), minimizes the\ninventory holding in the platforms and the transportation costs of trips\namong platforms and between the platforms and the onshore terminal.\n\nTo ensure that each shuttle tanker is exactly at only one node\n(platform or onshore terminal) at the end of each period, constraint\n(3.2a) is required. The initial conditions for the shuttle tankers are de-\ntermined by the set of constraints (3.2b). Constraint (3.2c) establishes\nthe initial volume of oil in the platforms and constraint (3.2d) ensures\nthat at most one shuttle tanker can perform o?oading operations in a\nplatform during a time period.\n\nIn the constraint set (3.2e), the ?rst one de?nes the inventory\nbalance at the platforms, along with their volume capacity bounds. The\ninventory balance equation establishes that the current volume stored\nin a platform consists of the volume in the previous period added to the\nproduction and discounted the volume o?oaded by a shuttle tanker, if\nstationed at the platform.\n\nThe constraint set (3.2f) establishes the inventory balance for\n\n26\n\n\n\nProblem Formulation 27\n\nthe shuttle tankers. The variable vdaux,ts de?nes the volume of oil in the\nshuttle tanker at the end of a period, which corresponds to its previous\nvolume added by the amount taken from a platform (when xtu,s = 1).\nIts stock will be driven to zero at the end of the period if the shuttle\ntanker is positioned at the onshore facility (when xt0,s = 1). In other\nwords, every time a shuttle tanker visits the onshore terminal, it will\nupload all of its volume of oil into the terminal.\n\nThe constraints (3.2g) and (3.2h) express the behavior of the\nvariables ytu,s. It is possible to see that according with Eq. (3.2g),\n\nyt0,s ? |xt0,s ?x\nt?1\n0,s |. Since |x\n\nt\n0,s ?x\n\nt?1\n0,s | can be either 0 or 1: y\n\nt\n0,s = 1\n\nwhen the value of the expression is 1 (meaning that a shuttle tanker\narrived or departed from the onshore terminal); otherwise, yt0,s = 0\n(meaning that the shuttle tanker stayed at the onshore terminal). This\nleads to the conclusion that yt0,s ?{0, 1}.\n\nIn Eq. (3.2h), the left-hand side can assume one of the values\nin the set {?1, 0, 1}. If the value of the left-hand side is 1, ytu,s clearly\nassumes value 1, meaning that a shuttle tanker arrived in a platform.\nOtherwise, ytu,s ? 0 because it cannot be negative.\n\nThe remaining constraints (3.2i) through (3.2m) de?ne the\nnature of the decision variables.\n\nFor this formulation it is possible to de?ne the vector of de-\ncision variables ? = (vd,vdaux,vf,x,y) for any solution to P where\nvd = (vdts : s ? S, t ? T ?{0}) and vdaux, vf, x, and y are de?ned\nsimilarly.\n\nThe Fixed Travel Time Formulation (FTTF) for the STSP\ncan be represented by a directed graph G = (V,E) such as the simple\nscenario illustrated in Figure 3.1. The brown nodes (labeled ?Fu?)\nrepresent the platforms and the black node (labeled ?0?) represents the\nonshore terminal. Based on this representation and the formulation, it\nis possible to conclude the following:\n\n? Every displacement between nodes is performed in exactly 1 pe-\nriod of time no matter the distance among platforms or between\nthe onshore terminal and the platforms. Consider for instance\nthat 1 period of time is equivalent 1 day. This means that if in\na real operation the travel time for a shuttle tanker to go from\nplatform F2 to the onshore terminal is 1 day and to go from plat-\nform F2 to platform F3 is half of a day (12 hours), so in terms of\n\n27\n\n\n\n28 Problem Formulation\n\nthe model they all will be performed in 1 period of time, which\ntakes 1 day for this instance.\n\n? When an uploading or o?oading operation is scheduled, it takes\nplace in the same period of time used by the shuttle tanker to\ntravel to the node where the operation will happen.\n\n0\n\nF1\n\nF2\n\nF3\n\nFigure 3.1 ? Fixed Travel Time Representation.\n\n3.2 Variable Travel Time Formulation (VTTF)\n\nThis section extends the formulation of (CAMPONOGARA;\nPLUCENIO, 2014) to consider variable travel time among the platforms\nand between the onshore terminal and the platforms.\n\n3.2.1 Problem Representation\n\nFor the extended formulation, the STSP can be represented\nby a directed graph G = (V,E) such as in Figure 3.2. The brown nodes\n\n28\n\n\n\nProblem Formulation 29\n\n(labeled ?Fu?) represent the platforms; the black node (labeled ?0?)\nrepresents the onshore terminal; the blue nodes (labeled with positive\nnumbers) are control points, placed in the model to introduce variable\ntravel times. The control points can be used by the shuttle tankers\nas waiting points, since they cannot perform o?oading operations at\na platform if there is already another shuttle tanker stationed at the\nplatform.\n\nThe possible moves for the shuttle tankers are represented\nby the arcs in Figure 3.2. Each arc represents an one-period trip (one\nperiod corresponds to one day). Note that the arcs do not represent\nphysical paths but regions where the shuttle tankers can travel. Each\nshuttle tanker can perform two types of moves:\n\n? go from node u to v, during a period t, along the arc (u,v) ?E;\n\n? stay at node u, during a period t, represented by the self-loop\narcs (u,u) ? E. If the shuttle tanker performs this move when\nvisiting a platform, then an amount of oil can be o?oaded from\nthe platform; when visiting a control point (waiting point), it will\nstay there without performing any action; and when visiting the\nonshore terminal, the total volume of oil stored in its tanks will\nbe o?oaded.\n\nThe graph can be detailed as needed, enabling not only to\nrepresent days with the arcs, but also hours or minutes.\n\n3.2.2 Problem Formulation\n\nThe parameters required for problem statement are as follows:\n\n? G = (V,E) is a graph representing the moves that shuttle tankers\ncan perform in one time period, where V = {0, . . . ,V} is the set\nof nodes and E = V \u00d7V is the set of arcs.\n\n? The set of nodes is V = F ?I ? {0} with F being the set of\nplatforms, I the set of intermediate nodes, and 0 the onshore ter-\nminal. It is assumed that E contains self-loops for the nodes, that\nis {(u,u) : u ? V} ? E. A self-loop at a platform represents an\no?oading operation, whereas a self-loop at the onshore terminal\n\n29\n\n\n\n30 Problem Formulation\n\n0\n\nF1\n\nF2\n\nF3\n\n1\n\n2\n3\n\n4\n\n5\n\n6\n\nFigure 3.2 ? Variable Travel Time Representation.\n\nrepresents an uploading operation by a shuttle tanker. Self-loops\nat the intermediate nodes model periods during which a shuttle\ntanker is stationed.\n\n? T = {1, . . . ,T} is the set of periods that de?nes a planning hori-\nzon of length T, over which the shuttle tanker moves and o?oad-\ning/uploading operations are to be carried out. The periods of\nthe horizon correspond to days.\n\n? S = {1, . . . ,S} is the set of shuttle tankers.\n\n? V F 0u is the initial oil stock, V F\nmax\nu is the storage capacity, and\n\nV F minu is the minimum volume that should be stored in a platform\nu ?F.\n\n? QF min,tu and QF\nmax,t\nu are the minimum and maximum volume of\n\noil, respectively, that can be produced by platform u ? F in the\nperiod [Tt?1,Tt), t ?T .\n\n? V D0s is the initial volume of oil stored in shuttle tanker s, V D\nmax\ns\n\nis its capacity, and US0s is the initial position of the shuttle tanker,\nwhich can be a platform, the onshore terminal or a control point.\n\n30\n\n\n\nProblem Formulation 31\n\n? V F ofl,min,tu,s and V F\nofl,max,t\nu,s are the minimum and maximum vol-\n\nume of oil that can be o?oaded from platform u by shuttle tanker\ns during period t.\n\n? NSu is the maximum number of shuttle tankers that can o?oad\nfrom a platform u or upload at the onshore facility (when u = 0).\n\nThe following variables are required:\n\n? xs,tu,v ? B is 1 if shuttle tanker s moves from node u to v during\nperiod t, which stretches from time Tt?1 to Tt, where B = {0, 1}.\n\n? vftu is the volume of oil stored in platform u ?F at end of period\nt, while ?vftu is the volume of oil produced during this period.\n\n? vdts is the volume of oil stored in shuttle tanker s at the end of\nperiod t.\n\n? ?vdofl,tu,s is the volume of oil o?oaded from platform u or the\namount uploaded at the onshore facility by shuttle tanker s, dur-\ning period t.\n\nA feasible route for shuttle tanker s ?S is established by the\nfollowing constraints:?\n\n(v,u)?E\n\nxs,tv,u =\n?\n\n(u,v)?E\n\nxs,t+1u,v , u ?V, t ? (T\\{T}?{0}), (3.3a)\n\n?\n(u,v)?E\n\nxs,1u,v = 1, u = US\n0\ns, (3.3b)\n\nxs,1u,v = 0, u ?V\\{US\n0\ns )}, (u,v) ?E. (3.3c)\n\nThe initial stocks at the shuttle tankers and the platforms are\nestablished by the following constraints:\n\nvf0u = V F\n0\nu, u ?F (3.4a)\n\nvd0s = V D\n0\ns, s ?S (3.4b)\n\nThe number of shuttle tankers that can perform o?oading\noperations at the platforms and uploading operations at the onshore\n\n31\n\n\n\n32 Problem Formulation\n\nterminal, simultaneously, is limited:?\ns?S\n\nxs,tu,u ? NSu, u ?F ?{0}, t ?T . (3.5)\n\nThe inventory balance at the platforms are regulated by the\nfollowing oil conservation equations for all u ?F, t ?T :\n\nvftu = vf\nt?1\nu + ?vf\n\nt\nu ?\n\n?\ns?S\n\n?vdofl,tu,s , (3.6a)\n\nV F minu ? vf\nt\nu ? V F\n\nmax\nu , (3.6b)\n\nQF min,tu ? ?vf\nt\nu ? QF\n\nmax,t\nu , (3.6c)\n\nV F ofl,min,tu,s x\ns,t\nu,u ? ?vd\n\nofl,t\nu,s ? V F\n\nofl,max,t\nu,s x\n\ns,t\nu,u, s ?S. (3.6d)\n\nThe inventory balance at the shuttle tanker is governed the\nfollowing equations for all s ?S and t ?T :\n\nvdts = vd\nt?1\ns ??vd\n\nofl,t\n0,s +\n\n?\nu?F\n\n?vdofl,tu,s , (3.7a)\n\nvdts ? V D\nmax\ns . (3.7b)\n\nOil transfer equations are necessary at the onshore facility for\nall s ?S and t ?F:\n\n?vd\nofl,t\n0,s ? vd\n\nt?1\ns ?V D\n\nmax\ns (1 ?x\n\ns,t\n0,0), (3.8a)\n\n?vd\nofl,t\n0,s ? vd\n\nt?1\ns , (3.8b)\n\n?vd\nofl,t\n0,s ? V D\n\nmax\ns x\n\ns,t\n0,0, (3.8c)\n\nHaving introduced the notation and constraints, the prob-\nlem of scheduling shuttle tankers to transport oil from platforms to an\n\n32\n\n\n\nProblem Formulation 33\n\nonshore facility is cast as:\n\nP : min f =\n?\nu?F\n\n?\nt?T\n\nCh,tu (vf\nt\nu ?V F\n\nmin\nu )\n\n+\n?\nu?F\n\n?\nt?T\n\nCup,tu (QF\nmax,t\nu ??vf\n\nt\nu)\n\n+\n?\n\n(u,v)?E\n\n?\ns?S\n\n?\nt?T\n\nCs,tu,vx\ns,t\nu,v (3.9a)\n\ns.t. : (3.3)?(3.8) (3.9b)\nvftu ? 0, u ?F, t ?T ?{0} (3.9c)\n?vftu ? 0, u ?F, t ?T (3.9d)\nxs,tu,v ?{0, 1}, (u,v) ?E, s ?S, t ?T (3.9e)\nvdts ? 0, s ?S, t ?T ?{0} (3.9f)\n?vdofl,tu,s ? 0, u ?F ?{0}, s ?S, t ?T (3.9g)\n\nwhose objective accounts for inventory holding cost, production below\ncapacity, and transportation costs where:\n\n? Ch,tu is the inventory holding cost tied up to the oil left in plat-\nforms, which represents the tax the oil company has to pay in\norder to anticipate access to the money left in the platforms in\nthe form of oil.\n\n? Cup,tu being the cost for under production at platform u ?F.\n\n? Cs,tu,v being the cost for shuttle tanker s to travel along arc (u,v)\nduring period t.\n\nAn economic study should be carried out to de?ne values for\nthe following parameters: inventory holding cost (Ch,tu ), underproduc-\ntion cost(Cup,tu ) and tanker-travel cost (C\n\ns,t\nu,v).\n\nIt is possible to de?ne ? = (vf,?vf,x,vd,?vdofl) as the\nvector of decision variables for P where vf = (vftu : u ?F, t ?T ?{0})\nand ?vf, x, vd, and ?vdofl are de?ned similarly. With these vector\n\n33\n\n\n\n34 Problem Formulation\n\nde?nitions, the STSP can be recast in the following compact form:\n\nP : min f(?) (3.10a)\n\ns.t. : ? satisfies Eqs. (3.3)?(3.8) (3.10b)\n? ? dom(f) (3.10c)\n\nwhere dom(f) is the domain of f established by Eqs. (3.9c)-(3.9g).\n\n3.3 Literature Review\n\nSeveral models for optimizing oil transportation are found in\nliterature considering di?erent characteristics. In this section we relate\nthe new proposed model to other technical works. We divided this\nliterature in two subsections. In the ?rst one the works address the\nsame problem considered in this dissertation. The second one deals\nwith ship scheduling and oil transportation problems considering other\ncontexts.\n\n3.3.1 Similar Works\n\nIn (ROCHA; GROSSMANN; ARAG\u00e3O, 2013), the authors\naddressed the problem of transporting crude oil from o?shore platforms\nto onshore terminals. This is a sub-problem of the Petroleum Supply\nChain Problem, and the objective is to obtain the optimal schedule for\nthe shuttle tankers, that satis?es economic and operational constraints\n(re?nery demands, inventory capacity at the platforms and inventory\ncapacity at the terminals). In this problem, a company has several\nplatforms producing oil that is transported to terminals to supply re-\n?neries. The platforms produce only crude oil and they can only receive\nshuttle tankers of a speci?c class for o?oading operations. The trips\nare only made between platforms and terminals, in others words, there\nare no trips between platforms. It is assumed that the daily produc-\ntion of each platform, the demands of the re?neries, the travel time\nand routes between platforms and terminals are known in advance for\nthe entire planning horizon. Also, when a shuttle tanker o?oads a\nplatform, it must be loaded to full capacity. The number of shuttle\ntankers is considered unlimited for each class of tanker. An initial for-\nmulation is presented, which considers inventory balance equations and\n\n34\n\n\n\nProblem Formulation 35\n\nstorage capacity for the platforms and for the terminals. The cost func-\ntion minimizes the transportation cost over the planning horizon. The\nauthors propose a reformulation of the inventory balance constraints,\nnamed Cascading Knapsack inequalities, which has a special structure\nthat can be exploited by solvers. The new formulation accomplishes\nto write those constraints as Knapsack Inequalities, in which inventory\nvariables are eliminated, bringing forth to a 0-1 integer programming\nproblem. The new formulation is as tight as the initial one, however,\nits structure can be exploited by MILP solvers, as well as providing a\nbasis for the design of stronger formulations.\n\nThe work presented in (AIZEMBERG et al., 2014) and (ROCHA;\nGROSSMANN; ARAG\u00e3O, 2013) deals with the same problem . This\nwork has two objectives. The ?rst one is to compare mathematical\nformulations found in the literature for the oil transportation problem.\nFrom that, the authors proposed a new formulation that outperformed\nall previous ones when given to a solver. The second one is to propose\na column generation-based heuristics to solve di?cult instances of the\nproblem.\n\nThe formulation developed in this dissertation di?ers in some\naspects from the one presented in (ROCHA; GROSSMANN; ARAG\u00e3O,\n2013). They are presented as follows:\n\n1. Overall Objective. The work presented in (ROCHA; GROSS-\nMANN; ARAG\u00e3O, 2013) aims to determine the optimal shipment\nschedule in order to satisfy re?nery demands, avoid shutting down\nthe platforms and minimize the total cost of trips.\n\nThe formulation proposed in this dissertation has the goal to de-\ntermine the optimal schedule for the shuttle tankers, in order to\navoid shutting down platforms for lack of storage capacity, while\nrespecting operational constraints and minimizing a combination\nof inventory holding, underproduction and total cost of trips (Net\nPresent Value - NPV).\n\n2. Assumptions. In (ROCHA; GROSSMANN; ARAG\u00e3O, 2013),\nthe authors assume that o?oading operations must load the shut-\ntle tankers to full capacity; the number of shipments per period\nof time between each platform-terminal pair is limited to at most\none; the number of shutter tankers is unlimited; o?oading and\nuploading operations and the displacement between a platform-\nterminal pair are done in the same period of time.\n\n35\n\n\n\n36 Problem Formulation\n\nFor the formulation presented in this dissertation we considered\nthat the onshore terminal has unlimited capacity and the number\nof shuttle tankers is limited.\n\n3. Constraints. The work proposed in (ROCHA; GROSSMANN;\nARAG\u00e3O, 2013) considers inventory balance for platforms and\nonshore terminals; re?nery demands; limited capacity for plat-\nforms and onshore terminals; restrictions on the types of plat-\nforms that can supply each onshore terminal and types of vessels\nthat can perform o?oading operations in each platform.\n\nThe work presented in this dissertation considered inventory bal-\nance for platforms and shuttle tankers; limited capacity for plat-\nforms and shuttle tankers; network constraints; bounds for the oil\nproduction rate and bounds for the volume of oil o?oaded from\na platform.\n\n4. Output Decisions. As output, the model proposed in (ROCHA;\nGROSSMANN; ARAG\u00e3O, 2013) provides for each period of time\nif a shuttle tanker is assigned to o?oad a speci?c platform and\ndelivery oil at a speci?c onshore terminal.\n\nThe formulation proposed in this dissertation provides as output,\nfor each period of time, the schedule of the shuttle tankers, the\noil production rate and the amount of oil to be o?oaded at each\nplatform.\n\n3.3.2 Related Works\n\nThe work of Rocha (2010) aims to solve the Petroleum Supply\nChain Problem (PSCP) at Petrobras. First, the author describes the\nlogistic process of petroleum supply to re?neries in a strategic, tactical\nand operational hierarchical structure. In a general way, this problem\nconsists in planning the shipments of crude oil from platforms to re-\n?neries on a daily basis. The crude oil can be nationally produced or\nimported. The locally produced oil, mostly o?shore, can be transported\nto onshore terminals by shuttle tankers or pipelines. The imported oil\nis transported to the onshore terminals by shuttle tankers. At the on-\nshore terminals, the stored oil can be exported or sent to re?neries to\nsupply its demands. The proposed mathematical model is based in\na network ?ow structure and a discrete time representation. At the\nplatforms, it is considered inventory balance constraints; limits in the\n\n36\n\n\n\nProblem Formulation 37\n\nstorage capacity; limits on the number of shuttle tankers that leave a\nplatform in each period; and limits on the number of shuttle tankers\nthat arrive at the onshore terminal in each period of time. Regarding\nthe onshore terminals, the source of crude oil can be from the platforms\nor from an other terminal and a shuttle tanker can upload all its vol-\nume or only a partition of it at a speci?c terminal. Constraints such\nas maximum capacity and inventory balance at the terminals are con-\nsidered. For the re?neries, there is an optimal range of inventory that\nshould be respected. Volumes above (can generate logistical problems\nfor the re?nery) and below (re?nery may need to shut down production\nunits) that range are penalized. Also, an inventory balance constraint\nand a strategic plan for the re?neries supply (always considering the\nnext two months) are considered. For the shuttle tankers, it is de?ned\na constraint on the maximum number of additional tankers needed dur-\ning the planning horizon. The objective function minimizes shipping\ncost, penalty for out of range inventory at the re?neries, penalty for\ndeviation from the strategic planning and cost for additional tankers.\n\nAl-Yakoob (1997) deals with the Oil Tanker Scheduling Prob-\nlem for the Kuwait Petroleum Corporation (KPC). The problem con-\nsists in ship crude oil and re?ned oil-related products from ports in\nKuwait to customers (ports) located in Europe, North America and\nJapan. Deliveries are undertaken by KPC or by other shipping compa-\nnies and two routes are available for the tankers. Each vessel is a full\nshipload, and is characterizes by its type (oil, re?ned products, etc),\nloading port, loading date, discharging port, and discharging date.\n\nIn (CHOI; TCHA, 2007), the authors propose a tight integer\nprogramming model for the heterogeneous ?eet vehicle routing problem\nand its linear programming relaxation is solved using Column Genera-\ntion technique. The problems consists in de?ning a set of routs, each\nstarting and ending at a depot, for a heterogeneous ?eet of vehicles\nwhich services customers with known demands. Each customer is visit\nexactly one time and total demand of the route does not exceed the\ncapacity of the vehicle type assigned to it. The routing cost of a vehi-\ncle is the sum of its ?xed cost and a variable cost related to the travel\ndistance. The objective is to minimize the total of routing costs and\nthe number of vehicles of each type is assumed to be unlimited. The\nproblem is represented in a direct graph and based in a discrete time\nrepresentation. The nodes represent the central depot and customers\nand the arcs the available routes.\n\n37\n\n\n\n38 Problem Formulation\n\nThe works of (CHU et al., 2012) and (NISHI; YIN; IZUNO,\n2011) address the problem of crude oil transportation among ports.\nChu et al. (2012) demonstrate how the crude oil transportation prob-\nlem, by shuttle tankers or trucks, can be transformed in a single item lot\nsizing problem with limited production and inventory capacity. In this\nproblem the crude oil is shipped from a supplier port to n client ports\nto satisfy demands over a planning horizon of length T using a ?eet\nof identical shuttle tankers with limited capacity. Constraints regard-\ning inventory capacity of customers are considered and vary in time.\nThe objective function consists in minimizing the total cost over the\nplanning horizon. The assumption that the number of tankers are un-\nlimited and demands are independent allows independent shipments to\ncustomers, which can be seen as n independent problems. These prob-\nlems can be transformed into n single item lot sizing problems with\nlimited production and inventory capacity, where the tanker capacity\ncorresponds to production capacity in classical lot sizing models.\n\nIn (JETLUND; KARIMI, 2004), the authors consider the\nproblem of scheduling of a ?eet of multi-parcel tankers engaged in ship-\nping bulk liquid chemicals. The work presents a MILP model and pro-\nposes a decomposition strategy to transform the ?eet scheduling model\nin several one-ship model, which solves in reasonable time.\n\n3.4 Theoretical Results\n\n3.4.1 NP-Hardness\n\nProposition 1. The problem of scheduling shuttle tankers is NP-Hard.\n\nProof. The computational hardness of P can be shown by a reduc-\ntion from the Hamiltonian path. Let C denote the Hamiltonian path\nproblem for which one wants to ?nd a simple path visiting each node\nof an undirected graph GC = (VC,EC), assuming w.l.o.g. that VC =\n{1, . . . ,V}.\n\nThe reduction of C to P is as follows:\n\n1. Generate graphG = (V,E) whereV = VC?{0}andE = {(u,v), (v,u) :\n{u,v}? EC}?{(u,u), (0,u), (u, 0) : u ?V} with platforms corre-\nsponding to the nodes of the original graph.\n\n38\n\n\n\nProblem Formulation 39\n\n2. V F 0u = 1, V F\nmax\nu = 1, and V F\n\nmin\nu = 0 for each u ? F, where\n\nF = VC and so that I = ?.\n\n3. the planning horizon is T = {1, 2, . . . , 2V}, QF min,tu = QF max,tu =\n0 for t = 1, 2, . . . , 2V ? 1 but QF min,2Vu = QF max,2Vu = 1 for all\nu ?F.\n\n4. S = {1} with US0s = 0, V Dmaxs = V , and V D0s = 0.\n\n5. V F\nofl,min,t\nu,1 = 0, V F\n\nofl,max,t\nu,1 = 1 and NSu = 1 for all u ? F and\n\nt ?T .\n\n6. Ch,tu = 0 and C\nup,t\nu = 0 for all u ?F and t ?T .\n\n7. C1,tu,v = 0 for all (u,v) ?E and t ?T .\n\nClearly C contains a Hamiltonian path if, and only if, P is\nfeasible.\n\nIf C has a Hamiltonian path H = ?u1, . . . ,uV ?, then the\nshuttle tanker can visit the platforms in the order H, o?oading 1\nunit from each platform following the route (0,u1), (u1,u1), (u1,u2),\n(u2,u2), . . . , (uV?1,uV ), (uV ,uV ) which is clearly feasible in T = 2V\nperiods, since H is a Hamiltonian path and each platform will be empty\nat time 2V , when one unit is required to be produced.\n\nOn the other hand, if C does not have a Hamiltonian path,\nthen the shuttle tanker cannot visit and o?oad the volume stored in\neach platform during a planning horizon of 2V periods, which is re-\nquired for all platforms to receive one unit of production at time 2V ,\nthereby implying that P is infeasible.\n\n3.4.2 Generalization\n\nProposition 2. The problem of scheduling shuttle tankers with variable\ntravel time generalizes the problem with unique travel time that was\npresented in (CAMPONOGARA; PLUCENIO, 2014).\n\nProof. This generalization is demonstrated by means of a problem re-\nduction. Let H be an instance of the scheduling problem with unique\ntravel time.\n\n39\n\n\n\n40 Problem Formulation\n\nAn instance Hvtt of the scheduling problem with variable\ntravel time corresponding to H is obtained as follows.\n\n? Let the number of nodes be equal to the number of platforms\nV = F, F = {1, . . . ,V}, V = F?{0} with I = ?, and G = (V,E)\nwith E = {(u,v) : u ?V,v ?V}. Notice that G will have two arcs\nbetween each pair of nodes, as well as self-loops for all nodes.\n\n? Let T = {1, . . . , 2T}, which will have twice the number of periods\nin H because in this version a shuttle tanker travels and performs\nan o?oading operation during a single period, whereas in the\nvariable travel-time version these operations are distinct.\n\n? Let V F 0u = V F\nzero\nu , and V F\n\nmax\nu and V F\n\nmin\nu be as in H, and\n\nNSu = 1 for all u ?F.\n\n? Let QF max,tu be as given in H and QF min,tu = QF max,tu when t is\neven, whereas and QF min,tu = QF\n\nmax,t\nu = 0 when t is odd, for all\n\nu ?F and t ?T .\n\n? Let US0s = u\nzero\ns , V D\n\nmax\ns be as in H, and V D0s = V Dzeros for all\n\ns ?S.\n\n? Let V F ofl,min,tu,s = V F\nofl,max,t\nu,s = V F\n\nofl\nu when t is even, whereas\n\nV F ofl,min,tu,s = V F\nofl,max,t\nu,s = 0 when t is odd for all u ? F, s ? S,\n\nand t ?T .\n\n? Let Ch,tu = c1 for t even and C\nh,t\nu = 0 for t odd, and C\n\nup,t\nu = 0 for\n\nall u ?F, t ?T .\n\n? Let C\ns,t\n0,u = C\n\ns,t\nu,0 = c2 when t is odd, whereas C\n\ns,t\n0,u = C\n\ns,t\nu,0 = ?\n\nwhen t is even, for all u ?F, t ?T , and s ?S.\n\n? Let Cs,tu,v = C\ns,t\nv,u = c3 when t is odd, whereas C\n\ns,t\nu,v = C\n\ns,t\nv,u = ?\n\nwhen t is even, for all u ?F, v ?F\\{u}, t ?T , and s ?S.\n\n? Let Cs,tu,u = 0 for all u ?V, s ?S, and t ?T .\n\nLet X(H) be a solution to the instance H. Then, a corre-\nsponding solution X(Hvtt) to Hvtt is obtained as follows. For all t ?T ,\nu,v ?V, and s ?S, de?ne xs,2t?1u,v = 1 and xs,2tv,v = 1 in X(Hvtt) if only\nif xt?1u,s = 1 and x\n\nt\nv,s = 1 in X(H), whereas the remaining variables xs,tu,v\n\nare set to zero.\n\n40\n\n\n\nProblem Formulation 41\n\nFrom the structure of G, the de?nitions of the costs, produc-\ntion planning, and o?oading operations, one can verify that at the end\nof period 2t in X(Hvtt), the state of the platforms, shuttle tankers (po-\nsition and volumes), and accumulated transportation and holding costs\nwill be the same at the end of period t in X(H).\n\nSimilar reasoning can show that a solution X(Hvtt) to Hvtt\ncorresponds to an equivalent solution X(H) to H. The shuttle tankers\nin Hvtt can e?ectively move from one node to another only in odd-\nnumber periods, or else stay stationed at any node in such periods\nwithout incurring cost, while o?oading and uploading operations occur\nonly in even-numbered periods by moving along self-loops.\n\n3.4.3 A Family of Valid Inequalities\n\nLet x = (xs,tu,v : (u,v) ? E, s ? S, t ? T ) be a vector for\nthe xs,tu,v variables, and de?ne vectors vf, ?vf, vd, and ?vd in a\nsimilar manner. Further de?ne ? = (x,vf,?vf,vd,?vd) as a vec-\ntor encompassing all of the decision variables. Then, the polyhedron\nP = {? : Ai? ? bi, Aii? = bii, ? ? 0, x ? 1} is a formulation for\nthe problem of concern in this work if the rows of the systems (Ai,bi)\nand (Aii,bii) correspond to the constraints (3.3)-(3.8). This means\nthat X = P ? (Zsize(x) \u00d7Rsize(?)?size(x)) with X being the feasible set.\nAccording to convex analysis, the convex hull conv(X) of X is a poly-\nhedron.\n\nA valid inequality can be imposed on the number of o?oading\noperations performed at a subset U ?F of the platforms until time t.\n\nLet\n\nAV FtU =\n?\nu?U\n\nV F 0u +\n\nt?\nl=1\n\n?\nu?U\n\nQF min,lu (3.11)\n\nbe the minimum accumulated volume by the platforms U at end of\nperiod t. Then,\n\nNOFtU =\n\n?\nAV FtU ?\n\n?\nu?U V F\n\nmax\nu\n\nmax{V F ofl,max,lu,s : 1 ? l ? t, s ?S, u ?U}\n\n?\n(3.12)\n\nis a valid lower bound on the number of o?oading operations that must\n\n41\n\n\n\n42 Problem Formulation\n\nbe performed at the platforms U from period 1 through t in order to\navoid capacity violation. This leads to the following valid inequality.\n\nProposition 3. Given a subset U ? F of the platforms and period t,\nthe inequality\n\nt?\nl=1\n\n?\ns?S\n\n?\nu?U\n\nxs,lu,u ? NOF\nt\nU (3.13)\n\nis valid for conv(X).\n\nTable 3.1 ? Instance Parameters.\n\nPlatforms Storage Initial Minimum Maximum\n\nCapacity Volume Production O?oading\nV F maxu V F\n\n0\nu Rate Volume\n\n[103bbl] [103bbl] QF min,lu V F\nofl,max,l\nu,s\n\n[103bbl/day] [103bbl]\n1 1400 1100 180 500\n3 1450 600 230 400\n\nConsider the sample instance parameters shown in Table 3.1\nand the platform set U = {1, 3}. Then,\n\nAV F 10U = (600 + 1100) + 10(180 + 230) = 5800\n\nmax{V F ofl,max,lu,s : 1 ? l ? 10, s ?S, u ?U} = 500?\nu?U\n\nV F maxu = 1400 + 1450 = 2850.\n\nConsequently, NOF 10U = d(5800 ? 2850)/500e = d5.9e = 6. Similar\ncalculations lead to conclude that NOF 19U = d13.28e = 14.\n\nLet pt1,t2u,v = ?u1,u2, . . . ,ut2?t1+1? be a path in graph G from\nu1 = u to ut2?t1+1 = v, such that uj 6= 0 for all j ? Jofl(pt1,t2u,v ) =\n{1, 2, . . . , t2 ? t1 + 1}. Let Jofl(pt1,t2u,v ) ? J(pt1,t2u,v ) be the subset of max-\nimum cardinality such that j ? Jofl(pt1,t2u,v ) if, and only, if j &lt;|J|,\nuj = uj+1 and uj ?F.\n\nProposition 4. For t1, t2 ?T with t2 > t1 and u,v ?V\\{0}, let pt1,t2u,v\n\n42\n\n\n\nProblem Formulation 43\n\nbe a given path in G. If, for a given shuttle tanker s ?S,?\nj?Jofl(p\n\nt1,t2\nu,v )\n\nV F ofl,minuj,s > V D\nmax\ns (3.14)\n\nthen the inequality\n\n?\nj?Jofl(p\n\nt1,t2\nu,v )\n\nxs,t1+j?1uj,uj ? |Jofl(p\nt1,t2\nu,v )|? 1 +\n\nt2?t1?\nj=1\n\nx\ns,t1+j?1\n0,0 (3.15)\n\nis valid for conv(X).\n\n3.5 Summary\n\nIn this chapter we presented a former formulation for the\nshuttle tanker scheduling problem with ?xed travel times. Then, we\nproposed a revised new model, which accounts with variable travel\ntimes, and described its parameters, variables, constraints and objective\nfunction. Next, a review of literature was carried out to relate the new\nproposed model to other technical works.\n\nThe chapter ended with the presentation of theoretical re-\nsults establishing the computational hardness of the problem and the\ngeneralization of the previous model which assumes the travel times of\nthe shuttle tankers as ?xed. Also, a family of cutting planes derived\nfrom the classic knapsack cover inequalities was presented.\n\n43\n\n\n\nChapter 4\n\nLagrangean Duality\n\nIn this chapter we present the Lagrangean relaxation of the\nshuttle tanker scheduling problem, algorithms to solve the Lagrangean\ndual problem and the Lagrangean dual function decomposition.\n\n4.1 Lagrangean Relaxation\n\nThe use of the Lagrangean relaxation technique for this prob-\nlem is justi?ed by two factors:\n\n1. The distance between the primal optimal solution and the lower\nbound provided by the linear relaxation is signi?cantly high. The\ntechnique can be used to try to obtain tighter bounds for the\nprimal problem.\n\n2. The technique provided signi?cantly better bounds than the lin-\near relaxation in the work presented in (CAMPONOGARA; PLUCE-\nNIO, 2014).\n\nWe can use the Lagrangean relaxation to obtain lower bounds\nfor the Shuttle Tanker Scheduling Problem with Variable Travel Time\nby dualizing the coupling constraints (3.5) and (3.6a). To this end, let\n\n? = (?(3.5),?(3.6a)) where ?(3.5) = (?\n(3.5),t\nu ? 0 : u ? F ?{0}, t ? T )\n\n44\n\n\n\nLagrangean Duality 45\n\nand ?(3.6a) = (?\n(3.6a),t\nu ? R : u ? F, t ? T ) are vectors of Lagrange\n\nmultipliers associated with constraints (3.5) and (3.6a), respectively.\n\nThe Lagrangean dual function l(?), with respect to ?, con-\nsists in solving the following Lagranagean subproblem:\n\nLGR(?) : l(?) = min\n?\n\nf(?) +\n?\n\nu?F?{0}\n\n?\nt?T\n\n?(3.5),tu\n\n(?\ns?S\n\nxs,tu,u ?NSu\n\n)\n\n+\n?\nu?F\n\n?\nt?T\n\n?(3.6a),tu\n\n(\nvftu ?vf\n\nt?1\nu ??vf\n\nt\nu +\n\n?\ns?S\n\n?vdofl,tu,s\n\n)\n(4.1a)\n\ns.t. : ? satisfies Eqs. (3.3)?(3.4), (3.6b)?(3.6d), (3.7)?(3.8) (4.1b)\n? ? dom(f) (4.1c)\n\nwhere dom(f) is the domain of f established by Equations (3.9c)-(3.9g).\nIt is important to note that the bound provided by the Lagrangean dual\nfunction depends on which constraints were dualized.\n\nA Lagrange vector ? = (?(3.5),?(3.6a)) is dual feasible if\n\n?(3.5) ? 0, while ? is primal feasible if ? ? dom(f) and further satis?es\nEquations (3.3)-(3.8). From duality theory, l(?) ? f(?) for any dual\nfeasible ? and primal feasible ? (BAZARAA; SHERALI; SHETTY,\n2006).\n\nHaving introduced the Lagrangean dual function, we want to\n?nd ? that gives the tightest lower bound for problem P . By maximiz-\ning the Lagranagean dual function l(?) we obtain the Lagrangean dual\nproblem:\n\nLD : max\n?\n\nl(?) (4.2a)\n\ns.t. : ?(3.5) ? 0 (4.2b)\n\n?(3.6a) ? R (4.2c)\n\n? = (?(3.5),?(3.6a)) (4.2d)\n\nThis is a concave, non di?erentiable and piecewise linear maximization\nproblem on ?. Two methods were implemented to solve the Lagrangean\ndual problem: the subgradient method and the constraint generation\nmethod. The numerical results will be described in Section 5.2.\n\n45\n\n\n\n46 Lagrangean Duality\n\n4.2 Lagrangean Dual Function Decomposi-\ntion\n\nIt is possible to decompose the computation of the Lagran-\nagean dual function l(?) in S+F subproblems, S being the number of\nshuttle tankers and F the number of platforms.\n\nFrom the structure of the primal problem P , the dualiza-\ntion of the coupling constraints in the objective function renders the\nLagrangean dual function separable, with independent terms for the\nshuttle tankers and platforms as follows:\n\nl(?) =\n?\ns?S\n\nls(?) +\n?\nu?F\n\nlu(?) ?\n?\n\nu?F?{0}\n\n?\nt?T\n\n?(3.5),tu NSu\n\n+\n?\nu?F\n\n?\nt?T\n\n(\nCup,tu QF\n\nmax,t\nu ?C\n\nh,t\nu V F\n\nmin\nu\n\n)\n(4.3)\n\nwhere ls and lu are computed by solving subproblems concurrently or\nin parallel as de?ned below.\n\nGiven the Lagrange vector ?, lu(?) is calculated for platform\nu ?F by solving:\n\nLu(?) : lu(?) =\n\n= min\n?\nt?T\n\n(\nCh,tu vf\n\nt\nu ?C\n\nup,t\nu ?vf\n\nt\nu\n\n)\n+\n?\nt?T\n\n?(3.6a),tu\n(\nvftu ?vf\n\nt?1\nu ??vf\n\nt\nu\n\n)\n= min\n\n?\nt?T\n\n(\nCh,tu + ?\n\n(3.6a),t\nu\n\n)\nvftu ?\n\n?\nt?T\n\n(\n?(3.6a),tu\n\n)\nvft?1u\n\n?\n?\nt?T\n\n(\nCup,tu + ?\n\n(3.6a),t\nu\n\n)\n?vftu\n\n= min ??(3.6a),1u vf\n0\nu +\n\nT?1?\nt=1\n\n(\nCh,tu + ?\n\n(3.6a),t\nu ??\n\n(3.6a),t+1\nu\n\n)\nvftu\n\n+\n(\nCh,Tu + ?\n\n(3.6a),T\nu\n\n)\nvfTu ?\n\n?\nt?T\n\n(\nCup,tu + ?\n\n(3.6a),t\nu\n\n)\n?vftu (4.4a)\n\ns.t. : vf0u = V F\n0\nu (4.4b)\n\n46\n\n\n\nLagrangean Duality 47\n\n{\nV F minu ? vftu ? V F maxu\nQF min,tu ? ?vftu ? QF max,tu\n\nt ?T (4.4c)\n\nvftu ? 0, t ?T ?{0} (4.4d)\n?vftu ? 0, t ?T (4.4e)\n\nwhich is a linear programming problem. Actually, Lu(?) is solved an-\nalytically as follows:\n\nvf0u = V F\n0\nu (4.5a)\n\nvftu =\n\n{\nV F minu if (C\n\nh,t\nu + ?\n\n(3.6a),t\nu ??\n\n(3.6a),t+1\nu ) ? 0\n\nV F maxu otherwise\nfor t ? (T\\{T})\n\n(4.5b)\n\nvfTu =\n\n{\nV F minu if (C\n\nh,T\nu + ?\n\n(3.6a),T\nu ) ? 0\n\nV F maxu otherwise\n(4.5c)\n\n?vftu =\n\n{\nQF max,tu if (C\n\nup,t\nu + ?\n\n(3.6a),t\nu ) ? 0\n\nQF min,tu otherwise\nfor t ?T (4.5d)\n\nSimilarly, ls(?) is calculated for a shuttle tanker s ? S by\nsolving the MILP program:\n\nLs(?) : ls(?) = min\n?\n\n(u,v)?E\n\n?\nt?T\n\nCs,tu,vx\ns,t\nu,v\n\n+\n?\n\nu?F?{0}\n\n?\nt?T\n\n?(3.5),tu x\ns,t\nu,u\n\n+\n?\nu?F\n\n?\nt?T\n\n?(3.6a),tu ?vd\nofl,t\nu,s (4.6a)\n\ns.t. :\n?\n\n(v,u)?E\n\nxs,tv,u =\n?\n\n(u,v)?E\n\nxs,t+1u,v , u ?V, t ? (T\\{T}?{0}) (4.6b)\n\n47\n\n\n\n48 Lagrangean Duality\n\n?\n(u,v)?E\n\nxs,1u,v = 1, u = US\n0\ns (4.6c)\n\nxs,1u,v = 0, u ?V\\{US\n0\ns )}, (u,v) ?E (4.6d)\n\nvd0s = V D\n0\ns (4.6e)\n\nV F ofl,min,tu,s x\ns,t\nu,u ? ?vd\n\nofl,t\nu,s ? V F\n\nofl,max,t\nu,s x\n\ns,t\nu,u, u ?F, t ?T (4.6f)\n\n???????\n??????\n\nvdts = vd\nt?1\ns ??vd\n\nofl,t\n0,s +\n\n?\nu?F ?vd\n\nofl,t\nu,s\n\nvdts ? V Dmaxs\n?vd\n\nofl,t\n0,s ? vd\n\nt?1\ns ?V Dmaxs (1 ?x\n\ns,t\n0,0)\n\n?vd\nofl,t\n0,s ? vd\n\nt?1\ns\n\n?vd\nofl,t\n0,s ? V D\n\nmax\ns x\n\ns,t\n0,0\n\nt ?T (4.6g)\n\nxs,tu,v ?{0, 1}, (u,v) ?E, t ?T (4.6h)\n\nvdts ? 0, t ?T ?{0} (4.6i)\n\n?vdofl,tu,s ? 0, u ?F ?{0}, t ?T (4.6j)\n\n4.3 Summary\n\nIn this chapter we presented the Lagrangean relaxation of the\nshuttle tanker scheduling problem. From the Lagrangean relaxation we\nderived the Lagrangean dual problem which can be solved using the\nsubgradient and the constraint generation methods. At the end of the\nchapter we presented the Lagrangean dual function decomposition that\ngenerated S+F subproblems, S being the number of shuttle tankers\nand F the number of platforms, which can be solved concurrently or in\nparallel to reduce computational time.\n\n48\n\n\n\nChapter 5\n\nComputational Analysis\n\nIn this chapter we present a basic o?shore oil ?eld scenario\nand the computational set up in which the analysis are carried out.\nThe ?rst analysis compares the Lagrangean dual bound with the linear\nrelaxation bound. The second analysis compares the static solution,\nwhen the problem is solved for the entire planning horizon, with the\ndynamic solution obtained using the rolling-horizon and relax-and-?x\nheuristics. Finally, we evaluate the rolling-horizon strategy in a proto-\ntype simulator which generates random perturbations to the variables\nof the model.\n\n5.1 O?shore Oil?eld Scenario\n\nThe o?shore oil ?eld scenario is formed by 3 platforms, 2\nshuttle tankers and 1 onshore terminal. Table 5.1 presents the following\nparameters for the platforms:\n\n? Storage capacity V F maxu , in 10\n3bbl;\n\n? Minimum volume that must remain on the platforms V F minu , in\n103bbl;\n\n? Initial volume V Fu(0), in 10\n3bbl;\n\n? Production rate interval [QF min,tu ,QF\nmax,t\nu ], in 10\n\n3bbl/day;\n\n49\n\n\n\n50 Computational Analysis\n\n? Maximum and minimum o?oading volume where V F ofl,min,tu,s =\n\nV F ofl,max,tu,s , in 10\n3bbl;\n\nwhere bbl and bbl/day stands for barrels and barrels per day respec-\ntively.\n\nTable 5.1 ? Parameters for the Platforms.\n\nFPSO Storage Min. Initial Prod. O?oad.\n\nCapacity Vol. Volume Rate Vol.\n[103bbl] [103bbl] [103bbl] [103bbl/day] [103bbl]\n\n1 1400 500 650 [75, 80] 450\n2 1350 500 750 [95, 100] 500\n3 1450 500 600 [125, 130] 400\n\nTable 5.2 gives the required parameters of the shuttle tankers,\nnamely storage capacity (V Dmaxs ) and initial volume (V D\n\n0\ns).\n\nTable 5.2 ? Parameters for the Shuttle Tankers.\n\nShuttle Capacity Initial\n\nTanker [103bbl] Volume\n[103bbl]\n\n1 2000 0\n2 1800 0\n\nFor this scenario three categories of costs are de?ned and they\ncan be seen in Table 5.3. Parameter Cs,tu,v is the cost to travel from u\nto v in dollars [$]; Cup,tu is the cost for under production in dollars per\nbarrel per day [$ ? barrel?1 ?day?1]; and Ch,tu represents the cost for\ninventory holding in dollars per barrel per day [$?barrel?1?day?1]. It is\nassumed that only one shuttle tanker can perform o?oading operations\nin a platform at a time, however up to two shuttle tankers can perform\nuploading operations at the onshore terminal simultaneously. Also, all\nshuttle tankers are initially stationed at the onshore terminal.\n\nThe computational set up consisted in expressing the MILP\nformulation of the scenario in AMPL (FOURER; GAY; KERNIGHAN,\n2003), which was optimized with IBM ILOG CPLEX 12.2.0. The com-\nputational experiments were performed in a workstation with an Intel\nCPU i7 @ 2.00 GHz, Windows operating system and 8 GB of RAM.\n\n50\n\n\n\nComputational Analysis 51\n\nTable 5.3 ? Operating Costs.\n\nOperating Costs Ch,tu C\nup,t\nu C\n\ns,t\nu,v\n\n[ $\nbbl?day ] [\n\n$\nbbl?day ] [$]\n\nLow Cost 17 17 15 000\nBaseline Cost 17 17 45 000\nHigh Cost 17 17 80 000\n\n5.2 Lagrangean Dual Bound\n\nTable 5.4 presents the solution of the original problem (Primal\nSolution) and its respective linear relaxation bound (LP Solution) for\nfour lengths of planning horizon (T = 10, T = 15, T = 20 and T = 25\ndays). The scenario is presented in Section 5.1 and the baseline cost\nis shown in Table 5.3. The GAP1 and the CPU Time, in seconds, for\nsolving the original problem are also presented. From Table 5.4, one\ncan observe two points as the planning horizon varies:\n\n? The GAP is signi?cantly high and increases with the length of\nthe planning horizon.\n\n? The CPU Time grows exponentially with the length of the plan-\nning horizon.\n\nThese observations motivate the search for tighter lower bounds. To\nthis end, the Lagrangean relaxation technique was applied.\n\nTable 5.4 ? Primal Solution and LP Solution GAP.\n\nPlanning Primal LP GAP CPU\n\nHorizon Solution Solution Time\n\n[days] [103$] [103$] [s]\n\n10 132 650 63 507.2 52.12% 0.515\n15 229 150 63 957.2 71.76% 73.25\n20 336 700 64 407.2 80.87% 1 282.09\n25 462 100 64 857.2 85.96% 75 445.03\n\n1GAP = P rimalSolution?LP Solution\nP rimalSolution\n\n? 100.\n\n51\n\n\n\n52 Computational Analysis\n\nTo ?nd optimal Lagrange multipliers, two methods were im-\nplemented to solve the Lagrangean dual problem: subgradient and con-\nstraint generation. In this analysis, we consider the scenario presented\nin Section 5.1, a planning horizon of T = 10 days and the baseline cost\nshown in Table 5.3.\n\n5.2.1 Subgradient Solution\n\nThe subgradient ?l(?) = (?l(?(3.5)),?l(?(3.6a))) for the La-\ngrangean dual function l(?) at ? is de?ned as follows:\n\n?l(?(3.5),tu ) =\n?\ns?S\n\nxs,tu,u ?NSu, u ?F ?{0}, t ?T (5.1a)\n\n?l(?(3.6a),tu ) = vf\nt\nu ?vf\n\nt?1\nu ??vf\n\nt\nu +\n\n?\ns?S\n\n?vdofl,tu,s , u ?F, t ?T\n\n(5.1b)\n\nFigure 5.1 shows the convergence of the subgradient method.\nOne can observe in green the primal solution P = 132 650 103$, in red\nthe LP bound LP = 63 507.2 103$ and in blue the bounds provided\nby Lagrangean dual function l(?k) for all ?k. Table 5.5 presents the\nchosen parameters of the subgradient method.\n\nTable 5.5 ? Subgradient Parameters.\n\nParameters Value\n\nInitial step size ?k 2.0\nStep decrement ?dec 0.7\nNumber of iterations 3 000\n\nGeo?rion (1974) shows that the Lagrangean relaxation must\nprovide a bound at least as good as the LP bound, which is not ac-\ncomplished for this instance using the subgradient method (Figure 5.1).\nThis method has proved to be not practical for this instance since it\ndoes not have a stopping criteria and guarantees convergence only in\ntheory.\n\n52\n\n\n\nComputational Analysis 53\n\n0 500 1000 1500 2000 2500 3000\n0\n\n20\n\n40\n\n60\n\n80\n\n100\n\n120\n\n140\n\nIteractions\n\nl(\n?\n)\n\n[1\n0\n\n6 ]\n\nLinear Relaxation Bound\n\nLinear Relaxation Bound\n\nLagrangean Relaxation Bound\n\nPrimalPOptimalPValue\n\nPrimalPOptimalPValue\n\nLagrangeanPBound\n\nFigure 5.1 ? Subgradient Convergence.\n\n5.2.2 Constraint Generation Solution\n\nFigure 5.2 shows the convergence of the constraint generation\nmethod. It is possible to observe in green the primal solution P =\n132 650 103$, in red the LP bound LP = 63 507.2 103$ and in blue the\nbounds provided by Lagrangean dual function l(?k) for all ?k.\n\nThe method converged after 141 iterations, providing a bound\nLGR = 63 498 103$ which is approximately the same as the LP bound.\nIf the Lagrangean relaxation had provide a better bound than the LP\nsolution, it would be interesting to use it as the relaxation strategy\nin the branch-and-bound strategy. However, for this instance the La-\ngrangean dual bound do not o?er advantages since it is almost the same\nas the LP bound, although with a higher computation time.\n\n5.3 Static and Dynamic Analysis\n\nIn this section we compare the results obtained from the static\nand dynamic solutions. The static solution consists in solving the prob-\nlem for the entire planning horizon T and the dynamic solution in solv-\ning the problem using rolling-horizon and relax-and-?x strategies to\nrespond to unanticipated events and large instances of the problem.\n\n53\n\n\n\n54 Computational Analysis\n\n0 50 100 150\n?150\n\n?100\n\n?50\n\n0\n\n50\n\n100\n\n150\n\nIteractions\n\nl(\n?\n)d\n\n[1\n0\n\n6 ]\n\nPrimaldOptimaldValue\n\nPrimaldOptimaldValue\n\nLagrangeandRelaxationdBound\n\nLineardRelaxationdBound\n\nLineardRelaxationdBound\n\nLagrangeandBound\n\nFigure 5.2 ? Constraint Generation Convergence.\n\n5.3.1 Static Solution\n\nHere, we assume that there are no uncertainties in the op-\nerations. In other words, there will not be shutdowns or failures at\nthe platforms, shuttle tankers or terminals; the production volume, the\no?oading and uploading volumes, among other parameters and vari-\nables, are known in advance for the entire planning horizon and will be\nas predicted.\n\nThe computational results, for the three types of transporta-\ntion cost, are shown in Table 5.6, for a planning horizon of T = 20.\nCPU time (in seconds) is the time taken by CPLEX to ?nd the opti-\nmal schedule.\n\nTable 5.6 ? Solution for Planning Horizon T = 20.\n\nTransportation Optimal Value CPU Time\n\nCost [103$] [s]\n\nLow Cost 335 500 855.51\nBaseline Cost 336 700 1282.09\nHigh Cost 338 100 4215.17\n\n54\n\n\n\nComputational Analysis 55\n\n5.3.2 Dynamic Solution (Rolling-Horizon and Relax-\nand-Fix)\n\nIf uncertainties in the operations are not considered and re-\nliable predictions of the parameters are known for the entire planning\nhorizon T, then it is possible to solve the problem and obtain an op-\ntimal solution. However, two di?culties can arise when we run the\noptimizer for the entire planning horizon:\n\n? Problem size. Depending on the size of the problem, determined\nby the number of platforms, shuttle tankers and the length of the\nplanning horizon T , it can become hard to ?nd a feasible solution,\nlet alone an optimal one.\n\n? Uncertainties. It is not reliable to schedule the shuttle tankers\nover the planning horizon based only on the available predictions\nat the current time. At the end of each period, the state variables\n(the position of each shuttle tanker; the volume of oil of each ?oat-\ning platform; and the volume of oil of the shuttle tankers) may\ndi?er from what was planned due to uncertainties and thereby\nshould be revised.\n\nTo e?ectively respond to unanticipated events and handle\nlarge instances of the problem, two strategies are considered to solve\nthe scheduling problem: rolling-horizon and relax-and-?x.\n\n5.3.2.1 Rolling-Horizon Strategy (RHS)\n\nTable 5.7 presents the computational results obtained by ap-\nplying the RHS to the experimental scenario for a varying length of\nthe prediction horizon and considering the size of the planning horizon\nas T = 20 days. The table gives the best value obtained with RHS,\nthe CPU time, and the solution GAP2, which is the relative distance\nbetween the objective value induced by the RHS and the optimal so-\nlution, namely the one obtained by solving the problem for the entire\nplanning horizon (see Table 5.6).\n\n2GAP =\nRolling?HorizonBestV alue?OptimalV alue\n\nOptimalV alue\n? 100. The same formula is\n\napplied to the relax-and-?x GAP.\n\n55\n\n\n\n56 Computational Analysis\n\nBy comparing the results depicted in Tables 5.6 and 5.7, for\nthe three types of transportation cost, it can be noticed that the RHS\nachieves the optimal solution with a relatively short prediction horizon\nand a substantially smaller CPU time. The RHS reaches the optimum\nwith only 11 periods for the PH, taking less than 50 seconds, whereas\nthe standard solution can take more than 4 000 seconds.\n\nTable 5.7 ? Rolling-Horizon Solution.\n\nTransp. Prediction Best GAP CPU\n\nCost Horizon Value Time\n\n[days] [103$] [s]\n\n7 367 800 9.62% 5.15\n8 367 800 9.62% 6.85\n9 367 800 9.62% 11.76\n\nLow 10 367 800 9.62% 24.65\nCost 11 335 500 0% 40.01\n\n12 335 500 0% 78.03\n13 335 500 0% 145.60\n14 335 500 0% 952.31\n7 369 000 9.59% 5.23\n8 369 000 9.59% 10.07\n9 369 000 9.59% 11.32\n\nBaseline 10 369 000 9.59% 22.68\nCost 11 336 700 0% 39.62\n\n12 336 700 0% 95.00\n13 336 700 0% 237.54\n14 336 700 0% 625.76\n7 370 400 9.55% 5.21\n8 370 400 9.55% 8.03\n9 370 400 9.55% 11.18\n\nHigh 10 370 400 9.55% 22.48\nCost 11 338 100 0% 47.28\n\n12 338 100 0% 93.78\n13 338 100 0% 171.53\n14 338 100 0% 453.79\n\n56\n\n\n\nComputational Analysis 57\n\n5.3.2.2 Relax-and-Fix Strategy (RFS)\n\nTable 5.8 gives the computational results for the experimental\nscenario for a varying length of the prediction horizon and transporta-\ntion costs. The size of the planning horizon is T = 20 days.\n\nTable 5.8 ? Relax-and-Fix Solution.\n\nTransp. Prediction Best GAP CPU\n\nCost Horizon Value Time\n\n[days] [103$] [s]\n\n7 335 500 0% 39.93\n8 378 000 12.66% 100.73\n9 335 500 0% 131.48\n\nLow 10 364 400 8.61% 258.73\nCost 11 343 150 2.28% 447.89\n\n12 343 150 2.28% 803.89\n13 335 500 0% 1181.78\n14 335 500 0% 1306.73\n7 336 700 0% 42.12\n8 379 200 12.62% 110.92\n9 336 700 0% 148.15\n\nBaseline 10 365 600 8.58% 287.76\nCost 11 344 350 2.27% 484.62\n\n12 344 350 2.27% 907.37\n13 336 700 0% 1079.23\n14 336 700 0% 1415.57\n7 338 100 0% 45.79\n8 380 600 12.57% 86.59\n9 338 100 0% 95.90\n\nHigh 10 367 000 8.54% 210.64\nCost 11 345 750 2.26% 357.79\n\n12 345 750 2.26% 791.23\n13 338 100 0% 1267.92\n14 338 100 0% 949.81\n\nWhen Table 5.6 and 5.8 are compared, for all types of trans-\nportation cost, it is possible to observe that the RFS presents a smaller\nCPU Time. However, for some choices of prediction horizon, the CPU\ntime is higher and the relax-and-?x does not reach the optimal value.\nA comparison between relax-and-?x and rolling-horizon suggests that\n\n57\n\n\n\n58 Computational Analysis\n\nrelax-and-?x can reach the optimum with a shorter prediction horizon,\nhowever the behavior is somewhat erratic since solution quality can\ndeteriorate with the increase of prediction horizon length.\n\n5.4 Uncertainty Solution\n\nThe goal of this analysis is to model uncertainties for the shut-\ntle tanker scheduling operation and use the rolling-horizon strategy to\nrespond to these unanticipated events. A simulator is used to generate\nthe uncertainties. An analysis regarding the best value of the objective\nfunction and di?erent lengths of prediction horizon is presented.\n\n5.4.1 Prototype Simulator\n\nAt the end of each period of the planning horizon T , the\nsystem can be characterized by three state variables:\n\n? The volume of oil vftu at each platform u ?F;\n\n? The volume of oil vdts in each shuttle tanker s ?S;\n\n? The position v of each shuttle tanker s, considering that xs,tu,v = 1.\n\nWhen the operation obeys the predictions, in other words,\nthere are no uncertainties or measurement errors, the values of the\nstate variables will be as planned for the entire planning horizon T .\nHowever, in a real operational environment, variations in the predic-\ntions may occur and they should be taken into account. Some examples\nare described as follows:\n\n? A platform can fully or partially halt the production due to tech-\nnical problems. This may cause the oil production rate (?vftu)\nto be out of the acceptable range [QF min,tu ,QF\n\nmax,t\nu ], violating\n\nconstraint (3.6c).\n\n? The volume (vftu) in a platform can be lower or higher than the\nprediction due to a variation in the oil production rate (?vftu)\nor in the o?oaded volume (?vdofl,tu,s ). This may cause an infea-\nsibility problem, violating constraint (3.6b), in the minimum or\nmaximum volume of oil that a platform should have in storage.\n\n58\n\n\n\nComputational Analysis 59\n\n? The volume in a shuttle tanker (vdts ) can vary depending on the\no?oaded volume from a platform (?vdofl,tu,s ), violating constraint\n(3.7b).\n\n? A shuttle tanker can stop operating due to technical problems or\nmaintenance reasons. In this case, the ?eet may have its capacity\ndiminished or a new shuttle tanker, with or without the same\ncapacities, can replace it. Also, a shuttle tanker may have to fol-\nlow another path due to the operator's decision or meteorological\nconditions. In all cases, this change should be taken into account\nin the optimization process.\n\nOne way to account for uncertainties and unanticipated events\nconsists in relying on feedback and reoptimizing at the end of each pe-\nriod. The goal of designing a prototype simulator is to generate un-\ncertainties to simulate real operations. These uncertainties consist of\ndeviations from the predicted problem data. For the moment, we will\nonly consider variations on the oil production rate at the platforms\n(?vftu). However, to represent in a more faithful way the uncertain-\nties that arise in operations, a much more complete simulator would be\nnecessary, taking into account the following situations:\n\n? Variations in the oil production rate.\n\n? Partial production reduction or complete shutdown of a ?oating\nplatform.\n\n? Failure in a shuttle tanker.\n\n? Interruption of operations at the onshore terminal.\n\n? Deviation from the planned route of shuttle tankers.\n\n? Measurement errors.\n\n5.4.1.1 Modeling Uncertainty for the Oil Production Rate\n\nTo avoid economic loss, a platform must produce at its max-\nimum capacity but uncertainties or unanticipated events can lead to\nunder production. For all u ? F and t ? T the simulator will gener-\nate the uncertainty parameter ??vfu,t for the oil production rate ?vf\n\nt\nu.\n\n59\n\n\n\n60 Computational Analysis\n\nThe uncertainty is modeled as follows:\n\n??vfu,t = max\n{\n\nmin\n{\nN(0,?2), 0\n\n}\n,??\n\n}\n(5.2)\n\nwhere ??vfu,t is in barrels of oil per day and according to the model\nwill be limited to the range [??, 0]. N(0,?2) is a normal distribution\nwith mean 0 and standard deviation ?. If the parameter ??vfu,t = 0,\n\nthere are no uncertainties and if ??vfu,t = ?? the platform will have\nits oil production rate diminished by ?.\n\n5.4.2 Analysis\n\nTable 5.9 shows the best values obtained using the rolling-\nhorizon strategy for several types of prediction horizon and three types\nof standard deviation: ? = 0 (no uncertainties), ? = 500 and ? = 1000\nbarrels per day. We considered the scenario presented in Section 5.1,\na planning horizon of T = 25 days and the baseline cost parameters\nshown in Table 5.3.\n\nTable 5.9 ? Solution Considering Uncertainties.\n\nPrediction Best Value Best Value Best Value\n\nHorizon [103$] [103$] [103$]\n\n[days] (for ? = 0 (for ? = 500 (for ? = 1 000\n\nbarrels/day) barrels/day) barrels/day)\n\n7 407 105 441 846 439 205\n8 398 605 441 889 439 343\n9 398 605 441 892 439 355\n10 406 510 459 777 457 346\n11 405 150 459 848 449 037\n12 395 375 451 364 449 098\n13 403 620 451 364 449 098\n14 402 175 448 049 445 783\n15 382 030 427 060 425 006\n\nThe objective function of the problem accounts for three types\nof costs: inventory holding, underproduction and traveling cost. Before\nsolving the problem using the rolling-horizon heuristic, intuition led us\nto think that with the increase of the standard deviation the value of\n\n60\n\n\n\nComputational Analysis 61\n\nthe objective function would also increase since the oil production rate\nwould get lower. However, from Table 5.9, we observe, for all prediction\nhorizons, that the values using the standard deviation ? = 500 barrels\nper day are the largest, followed up by the values using ? = 1000 barrels\nper day and then by the values considering no uncertainties.\n\n1. Traveling Cost3. The costs related to the trips of the shuttle\ntankers were all the same for the three types of standard devia-\ntion. However, they presented a di?erent schedule and performed\ndi?erent o?oading and uploading operations.\n\n2. Underproduction Cost4. A higher value of the uncertainty\ngenerates a smaller value for the oil production rate, which pro-\nduces a higher value of underproduction. In that sense, the solu-\ntion using ? = 1000 barrels per day had the higher cost related to\nthe underproduction, followed up by the solution using ? = 500\nbarrels per day and then by the solution with no uncertainties. Is\nworth mentioning that the di?erences between the underproduc-\ntion costs, for the three types of standard deviation, were small.\n\n3. Inventory Holding Cost5. The solution using ? = 500 barrels\nper day removed the smallest amount of oil from the platforms,\ngenerating the largest inventory holding cost, followed up by the\nsolution using ? = 1000 barrels per day and then by the solution\nwith no uncertainties.\n\nFor this instance, the solution using ? = 500 barrels per day\nachieved the largest values for its objective function, which was caused\nby the impact of the inventory holding cost. However, since we are\ndealing with heuristics it is not possible to generalize this analysis.\n\n5.5 Summary\n\nIn this chapter we presented a basic o?shore oil ?eld sce-\nnario and the computational set up in which the analysis were carried\nout. The ?rst analysis consisted in comparing the Lagrangean dual\n\n3Traveling Cost =\n?\n\n(u,v)?E\n?\n\ns?S\n?\n\nt?T C\ns,t\nu,vx\n\ns,t\nu,v.\n\n4Underproduction Cost =\n?\n\nu?F\n?\n\nt?T C\nup,t\nu (QF\n\nmax,t\nu ? ?vftu).\n\n5Inventory Holding Cost =\n?\n\nu?F\n?\n\nt?T C\nh,t\nu (vf\n\nt\nu ? V Fminu ).\n\n61\n\n\n\n62 Computational Analysis\n\nbound, obtained via the Lagrangean relaxation, with the linear relax-\nation bound. The subgradient and the constraint generation methods\nwere used to solve the Lagrangean dual problem.\n\nNext we compared the static solution, when the problem is\nsolved for the entire planning horizon, with the dynamic solution ob-\ntained using the rolling-horizon and relax-and-?x heuristics which in\ngeneral give sub-optimal solutions but perform well in large problems\ninstances and with unanticipated events such as uncertainties.\n\nClosing the chapter, the rolling-horizon strategy was evalu-\nated in a prototype simulator which generated random perturbations\nto the variables of the model.\n\n62\n\n\n\nChapter 6\n\nConclusion\n\nIn this dissertation we have modeled and solved the Shuttle\nTanker Scheduling problem, an important sub-problem of the Petroleum\nSupply Planning. The proposed model advances the previous work of\nCamponogara e Plucenio (2014) by proposing a mathematical formula-\ntion for scheduling shuttle tankers to account for variable travel times.\nFrom the formulation, we were able to establish theoretical properties\nsuch as the computational hardness, the generalization of the previ-\nous model and a family of cutting planes derived from classic knapsack\ncover inequalities. In addition, we have presented Lagrangean duality,\nLagrangean decomposition and dual bounds obtained via subgradient\nand constraint generation methods. Also, we developed rolling-horizon\nand relax-and-?x heuristics for solving large instances of the problem\nand to respond to uncertainties in the operations. Finally, these strate-\ngies were evaluated computationally in a prototype simulator in order\nto assess their e?ectiveness in response to uncertainties in operations.\n\n6.1 Contributions\n\nThis dissertation achieved the following contributions:\n\n? An MILP formulation for scheduling shuttle tankers for o?oading\noperations in large o?shore oil ?elds with variable travel times for\nthe vessels.\n\n63\n\n\n\n64 Conclusion\n\n? Theoretical properties establishing the computational hardness of\nthe problem and the generalization of the previous model which\nassumes the travel times of the shuttle tankers as ?xed.\n\n? A family of cutting planes derived from the classic knapsack cover\ninequalities.\n\n? Rolling-horizon and relax-and-?x heuristics for solving large prob-\nlem instances.\n\n? A prototype simulator to assess the e?ectiveness of the model and\nthe heuristics in response to uncertainties in operations.\n\n? Lagrangean duality, Lagrangean decomposition and dual bounds\nobtained by subgradient and constraint generation methods.\n\n6.2 Future Works\n\nThere are some topics that were not investigated during the\ndissertation and that we believe could generate signi?cant contribu-\ntions:\n\n? Implementation of the family of cutting planes and analysis of\nthe improvement on computational results in a typical o?shore\noil?eld scenario.\n\n? Extension of the prototype simulator to include other uncertain-\nties such as partial production reduction or complete shutdown\nof a ?oating platform; failure in a shuttle tanker; interruption of\noperations at the onshore terminal; deviation from the planned\nroute of shuttle tankers; and measurement errors.\n\n? Identify and treat degeneracies and symmetries, that are usually\npresent in scheduling problems, in order to reduce computation\ntime.\n\n? Extend the proposed formulation to consider other constraints\nsuch as inventory holding, inventory balance and limits on the\nstorage capacity at the onshore terminals; demands at the re-\n?neries; platforms producing di?erent types of oil; restrictions on\nwhich platforms can supply each onshore terminal; restrictions\n\n64\n\n\n\nConclusion 65\n\non which tankers can o?oad each platform and upload each on-\nshore terminal; oil batches at the onshore terminals reserved for\nthe exporting or originated from the importing or from pipelines.\n\n? The necessity to take into account uncertainties has been recog-\nnized as an important issue in logistics problems. Two problems\ncan arise. The ?rst one is how to model the uncertainties involved\nin the problem. The second problem is that, usually, mathemat-\nical models that incorporate uncertainties have a large number\nof variables and constraints, and are computationally hard to\nsolve. From that, some research directions can be pursued such\nas: uncertainty modeling, development of stochastic formulations\nto deal with uncertainties and the design of optimization strate-\ngies to solve large-sized instances.\n\n65\n\n\n\nBibliography\n\nAHUJA, R.; MAGNANTI, T.; ORLIN, J. Network ?ows: theory, algo-\nrithms, and applications. [S.l.]: Prentice Hall, 1993.\n\nAIZEMBERG, L. et al. Formulations for a problem of petroleum trans-\nportation. European Journal of Operational Research, v. 237, n. 1, p.\n82?90, 2014.\n\nAIZEMBERG, L. et al. Optimization model for the problem of oil trans-\nportation with local search by MIP and simulation. In: Proceedings of\nthe XLIII Brazilian Symposium on Operations Research (SBPO). [S.l.:\ns.n.], 2011.\n\nAL-YAKOOB, S. Mixed-Integer Mathematical Programming Optimiza-\ntion Models and Algorithms for an Oil Tanker Routing and Scheduling\nProblem. Tese (Doutorado) ? Virginia Polytechnic Institute and State\nUniversity, 1997.\n\nASSIS, L. S. de; CAMPONOGARA, E.; PLUCENIO, A. A MILP for-\nmulation for scheduling oil tankers for o?oading operations with vari-\nable travel time. In: Proceedings of the International Conference on\nEngineering Optimization. [S.l.: s.n.], 2014. p. 873?878.\n\nBALAS, E. Facets of the knapsack polytope. Mathematical Program-\nming, v. 8, p. 146?164, 1975.\n\nBALAS, E.; ZEMEL, E. Facets of the knapsack polytope from minimal\ncovers. SIAM Journal on Applied Mathematics, v. 34, n. 1, p. 119?148,\nJanuary 1978.\n\nBANASZEWSKI, R. et al. Planning transport of crude oil derivatives\nwith simultaneous auctions. In: Proceedings of the IEEE International\n\n66\n\n\n\nBIBLIOGRAPHY 67\n\nConference on Systems Man and Cybernetics (SMC). [S.l.: s.n.], 2010.\np. 2820?2827.\n\nBAZARAA, M. S.; SHERALI, H. D.; SHETTY, C. M. Nonlinear Pro-\ngramming: Theory and Algorithms. 3rd edition. ed. [S.l.]: John Wiley\n&amp; Sons, 2006.\n\nBERALDI, P. et al. Rolling-horizon and ?x-and-relax heuristics for\nthe parallel machine lot-sizing and scheduling problem with sequence-\ndependent set-up costs. Computers &amp; Operations Research, v. 35, n. 11,\np. 3644 ? 3656, 2008.\n\nBURDEN, R.; FAIRES, J. Numerical Analysis. [S.l.]: Cengage Learn-\ning, 2004.\n\nCAMPONOGARA, E.; PLUCENIO, A. Scheduling dynamically posi-\ntioned tankers for o?shore oil o?oading. International Journal of Pro-\nduction Research, v. 52, n. 24, p. 7251?7261, 2014.\n\nCAMPONOGARA, E.; PLUCENIO, A.; PEREIRA, F. A model for\noptimizing trips of dynamically positioned shuttle tankers for o?shore\noil transfer. In: Proceedings of the International Conference on Engi-\nneering Optimization. [S.l.: s.n.], 2012.\n\nCHOI, E.; TCHA, D.-W. A column generation approach to the het-\nerogeneous ?eet vehicle routing problem. Computers &amp; Operations Re-\nsearch, v. 34, n. 7, p. 2080?2095, 2007.\n\nCHU, C. et al. A polynomial dynamic programming algorithm for crude\noil transportation planning. IEEE Transactions on Automation Science\nand Engineering, v. 9, n. 1, p. 42?55, 2012.\n\nCROWDER, H.; JOHNSON, E. L.; PADBERG, M. Solving large-scale\nzero-one linear programming problems. Operations Research, v. 31, n. 5,\np. 803?834, 1983.\n\nDILLENBERGER, C. et al. On practical resource allocation for pro-\nduction planning and scheduling with period overlapping setups. Euro-\npean Journal of Operational Research, v. 75, n. 2, p. 275?286, 1994.\n\nFISHER, M. L. An applications oriented guide to lagrangian relaxation.\nInterfaces, v. 15, p. 10?21, 1985.\n\nFOURER, R.; GAY, D.; KERNIGHAN, B. AMPL: a modeling lan-\nguage for mathematical programming. [S.l.]: Thomson/Brooks/Cole,\n2003.\n\n67\n\n\n\n68 BIBLIOGRAPHY\n\nGEOFFRION, A. M. Lagrangian relaxation for integer programming.\nMathematical Programming Study 2, p. 82?114, 1974.\n\nGHIANI, G.; LAPORTE, G.; MUSMANNO, R. Introduction to Logis-\ntics Systems Planning and Control. [S.l.]: Wiley, 2004. (Wiley Inter-\nscience Series in Systems and Optimization).\n\nGHIANI, G.; LAPORTE, G.; MUSMANNO, R. Introduction to Lo-\ngistics Systems Management. [S.l.]: Wiley, 2013. (Wiley Essentials in\nOperations Research and Management Science).\n\nGUIGNARD, M. Lagrangean relaxation. TOP: An O?cial Journal of\nthe Spanish Society of Statistics and Operations Research, Springer-\nVerlag, p. 151?200, 2003.\n\nHAKSEVER, C.; RENDER, B. Service Management: An Integrated\nApproach to Supply Chain Management and Operations. [S.l.]: Pearson\nEducation, 2013.\n\nJETLUND, A. S.; KARIMI, I. Improving the logistics of multi-\ncompartment chemical tankers. Computers &amp; Chemical Engineering,\nv. 28, n. 8, p. 1267 ? 1283, 2004.\n\nLI, Z.; IERAPETRITOU, M. G. Rolling horizon based planning and\nscheduling integration with production capacity consideration. Chemi-\ncal Engineering Science, v. 65, n. 22, p. 5887?5900, 2010.\n\nMOHAMMADI, M. et al. Rolling-horizon and ?x-and-relax heuristics\nfor the multi-product multi-level capacitated lotsizing problem with\nsequence-dependent setups. Journal of Intelligent Manufacturing, v. 21,\nn. 4, p. 501?510, 2010.\n\nNEMHAUSER, G. L.; WOLSEY, L. A. Integer and Combinatorial Op-\ntimization. [S.l.]: Wiley-Interscience, 1988.\n\nNISHI, T.; YIN, S.; IZUNO, T. Column generation approach to ship\nscheduling problems for international crude oil transportation. In: Pro-\nceedings of the IEEE Conference on Automation Science and Engineer-\ning (CASE). [S.l.: s.n.], 2011. p. 468?473.\n\nROCHA, R. Petroleum supply planning: models, reformulations and\nalgorithms. Tese (Doutorado) ? Departamento de Inform\u00e1tica, PUC-\nRio, 2010.\n\n68\n\n\n\nBIBLIOGRAPHY 69\n\nROCHA, R.; GROSSMANN, I. E.; ARAG\u00e3O, M. V. Poggi de.\nPetroleum allocation at petrobras: Mathematical model and a solu-\ntion algorithm. Computers &amp; Chemical Engineering, v. 33, n. 12, p.\n2123?2133, 2009.\n\nROCHA, R.; GROSSMANN, I. E.; ARAG\u00e3O, M. V. Poggi de. Cas-\ncading knapsack inequalities: reformulation of a crude oil distribution\nproblem. Annals of Operations Research, v. 203, n. 1, p. 217?234, 2013.\n\nSAWIK, T. Scheduling in Supply Chains Using Mixed Integer Program-\nming. [S.l.]: Wiley, 2011.\n\nSILVA, T. L.; CAMPONOGARA, E. A computational analysis of mul-\ntidimensional piecewise-linear models with applications to oil produc-\ntion optimization. European Journal of Operational Research, v. 232,\nn. 3, p. 630?642, 2014.\n\nTAHA, H. Operations Research: An Introduction, 9/E. [S.l.]: Pearson,\n2011.\n\nTANG, L.; JIANG, S.; LIU, J. Rolling horizon approach for dynamic\nparallel machine scheduling problem with release times. Industrial &amp;\nEngineering Chemistry Research, v. 49, n. 1, p. 381?389, 2010.\n\nWOLSEY, L. Integer Programming. [S.l.]: John Wiley &amp; Sons, 1998.\n\n69\n\n\n\n70 BIBLIOGRAPHY\n\n70\n\n\n\nAppendix A\n\nMathematical Proofs\n\nA.1 Lagrangean Dual Problem Equivalence\n\nIn this section we intend to show in details the mathematical\nproof of the following proposition:\n\nProposition 5. According to Geo?rion (1974) it is possible to prove\nthat the Lagrangean dual problem ZLD is equivalent to the following\nPrimal Relaxation:\n\nPR : f = max\nx\n\ncTx (A.1)\n\ns.t. : Ax ? b (A.2)\nconv{x ? X|Cx ? d} (A.3)\n\nProof:\n\nConsider the following generic integer programming problem:\n\nZ : f = max\nx\n\ncTx (A.4a)\n\ns.t. : Ax ? b (A.4b)\nCx ? d (A.4c)\nx ? X (A.4d)\n\nwhere c, x, b and d are vectors, A and C are matrices (all vectors and\n\n71\n\n\n\n72 Mathematical Proofs\n\nmatrices are with the right dimensions); and X de?nes the integrality\nconstraints.\n\nSuppose that the set of constraints (A.4b) is complicating, in\nthe sense that if we remove it from the problem, it becomes easier to\nsolve. The Lagrangean relaxation of this problem is de?ned as follows:\n\nZLGR : l(?) = max\nx\n\ncTx + ?T (b?Ax)\n\ns.t. : Cx ? d\nx ? X\n\nwhere l(?) is the Lagrangean dual function.\n\nGiven the Lagrangean relaxation problem ZLGR, which ?\ngives the tightest bound for the integer problem Z? The goal is to\nminimize the increase that the dualized constraints provide in the ob-\njective function, meaning the minimization of l(?). From this arises\nthe Lagrangean dual problem:\n\nZLD : min\n?\n\nl(?) (A.6a)\n\ns.t. : ? ? 0 (A.6b)\n\nHaving introduced PR, ZLGR and ZLD, it is possible to write\nthe following:\n\nv(ZLD) = min\n??0\n\nv(ZLGR) (A.7)\n\n= min\n??0\n\nmax\nx\n{cTx + ?T (b?Ax)|Cx ? d,x ? X} (A.8)\n\n= min\n??0\n\nmax\nx\n{cTx + ?T (b?Ax)|x ? conv{x ? X|Cx ? d}}\n\n(A.9)\n\nwhere v(ZLD) and v(ZLGR) are respectively the optimal values of\nthe Lagrangean dual and the Lagrangean relaxation. Assuming that\n{x ? Rn : Cx ? d} is a bounded polyhedron, the step of going from\nEquation (A.8) to Equation (A.9) is true because the maximum of a\nlinear function over a bounded, discrete set of points is equal to the\nmaximum of that linear function over the convex hull of this set of\npoints.\n\nLet X = {x ? X : Cx ? d} be the set of feasible points of\n\n72\n\n\n\nMathematical Proofs 73\n\nthe Lagrangean relaxation problem. Notice that X = {x1, . . . ,xm} is\na countable set assuming that the polyhedron {x ? Rn : Cx ? d} is\nbounded.\n\nNow, the Lagrangean dual function l(?) can be seen as the\nupper envelope of a set of a?ne functions of ? which lead to the fol-\nlowing reformulation of ZLD:\n\nv(ZLD) = min\n??0\n\nl(?) = min\n??0\n\nmax\nx?X\n\ncTx + ?T (b?Ax)\n\n= min ?\n\ns.t. : ? ? cTx + ?T (b?Ax), ?x ?X\n? ? 0\n\n= min ?\n\ns.t. : ? ??T (b?Ax) ? cTx, ?x ?X\n? ? 0\n\nwhich is a linear programming problem. This problem can be placed\nin a matrix form as follows:\n\nv(ZLD) = min\n??0\n\n? (A.10a)\n\ns.t. :\n\n?\n????\n\n1 ?(b?Ax1)T\n1 ?(b?Ax2)T\n...\n\n...\n1 ?(b?Axm)T\n\n?\n????\u00d7\n\n[\n?\n?\n\n]\n?\n\n?\n????\ncTx1\n\ncTx2\n\n...\ncTxm\n\n?\n???? (A.10b)\n\n? ? 0 (A.10c)\n\nIn a linear programming problem, the optimal values of the\nobjective function of the primal and dual problem are equal (strong du-\nality). The dual of the primal Problem (A.10), with variables \u00b51, . . . ,\u00b5m\n\nbeing the dual variables associated with each constraint, can be de?ned\n\n73\n\n\n\n74 Mathematical Proofs\n\nas:\n\nv(ZLD) = max c\nTx1\u00b51 + cTx2\u00b52 + . . . + cTxm\u00b5m (A.11a)\n\ns.t. :\n\n\u00b51 + \u00b52 + . . . + \u00b5m = 1 (A.11b)\n\n\u00b5j ? 0, j = 1, . . . ,m. (A.11c)\n\n[\n?(b?Ax1) . . . ?(b?Axm)\n\n]\n\u00d7\n\n?\n?? \u00b5\n\n1\n\n...\n\u00b5m\n\n?\n?? ?\n\n?\n?? 0...\n\n0\n\n?\n?? (A.11d)\n\nwhich can be rewritten as:\n\nv(ZLD) = max\nx\n\ncTx (A.12a)\n\ns.t. : Ax ? b (A.12b)\n\u00b51 + \u00b52 + . . . + \u00b5m = 1 (A.12c)\n\nx = x1\u00b51 + x2\u00b52 + . . . + xm\u00b5m (A.12d)\n\n\u00b5j ? 0, j = 1, . . . ,m. (A.12e)\n\nNotice that Equations (A.12c), (A.12d) and (A.12e) de?ne\nthe convex hull of the set X = {x1, . . . ,xm}. Hence,\n\nv(ZLD) = max\nx\n\ncTx (A.13)\n\ns.t. : Ax ? b (A.14)\nx ? conv{x ? X : Cx ? d} (A.15)\n\nwhich is the de?nition of the Primal Relaxation. Therefore, v(ZLD) =\nv(PR), that is, the Lagragean dual problem is equivalent to the Primal\nRelaxation.\n\n74"}]}}}