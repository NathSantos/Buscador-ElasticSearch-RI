{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.09321"}, {"@name": "filename", "#text": "14292_346334.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE FEDERAL DE SANTA CATARINA DEPARTAMENTO DE AUTOMACAO E SISTEMAS\nGUSTAVO ARTUR DE ANDRADE\nControl of Systems Modeled by Hyperbolic Partial Differential Equations\nGustavo Artur de Andrade\nControl of Systems Modeled by Hyperbolic Partial Differential Equations\nTese de doutorado submetida ao Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Automa\u00e7\u00e3o e Sistemas para a obten\u00e7\u00e3o do Grau de Doutor em Engenharia de Automa\u00e7\u00e3o e Sistemas.\nOrientador: Prof. Daniel Juan Pagano, Dr.\nFicha de identifica\u00e7\u00e3o da obra elaborada pelo autor, atrav\u00e9s do Programa de Gera\u00e7\u00e3o Autom\u00e1tica da Biblioteca Universit\u00e1ria da UFSC.\nde Andrade, Gustavo Artur\nControl of systems modeled by hyperbolic partial differential equations / Gustavo Artur de Andrade ; orientador, Daniel Juan Pagano - Florian\u00f3polis, SC, 2017.\n162 p.\nTese (doutorado) - Universidade Federal de Santa Catarina, Centro Tecnol\u00f3gico. Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Automa\u00e7\u00e3o e Sistemas.\nInclui refer\u00eancias\n1. Engenharia de Automa\u00e7\u00e3o e Sistemas. 2. Controle de processos. 3. Equa\u00e7\u00f5es diferenciais parciais. 4. Sistemas hiperb\u00f3licos. I. Pagano, Daniel Juan. II. Universidade Federal de Santa Catarina. Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Automa\u00e7\u00e3o e Sistemas. III. T\u00edtulo.\nGustavo Artur de Andrade\nCONTROL OF SYSTEMS MODELED BY HYPERBOLIC PARTIAL DIFFERENTIAL EQUATIONS\nEsta tese de doutorado foi julgada adequada para a obten\u00e7\u00e3o do T\u00edtulo de \u201cDoutor em Engenharia de Automa\u00e7\u00e3o e Sistemas\u201d e aprovada em sua forma final pelo Programa de Pos-Gradua\u00e7ao em Engenharia de Automa\u00e7ao e Sistemas.\nFlorian\u00f3polis, 22 de fevereiro de 2017.\nProf. Daniel Ferreira Coutinho, Dr.\nCoordenador do Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Automa\u00e7\u00e3o e Sistemas\nBanca Examinadora:\nProf. Daniel Juan Pagano, Dr. - DAS - UFSC Presidente - Orientador\nProf. Julio Elias Normey-Rico, Dr. - DAS - UFSC\nProf. Luis Antonio Aguirre, Dr. - DELT - UFMG\nProf. Nestor Roqueiro, Dr. - DAS - UFSC\nProf. Ricardo H. C. Takahashi, Dr. - MTM - UFMG\nACKNOWLEDGMENTS\nI would like to thank the supervisor of my thesis professor Dr. Daniel Juan Pagano for his support and encouragement.\nI also thank professors Dr. Manuel Berenguel Soria, Dr. Jos\u00e9 Luis Guz-m\u00e1n Sanchez and Dr. Francisco Gabriel Aci\u00e9n Fern\u00e1ndez for helpful discussions during my stay at the Grupo de Autom\u00e1tica, Rob\u00f3tica y Mecatr\u00f3nica, Universidad de Almer\u00eda, Spain, in 2014. This visit was funded by the project CAPES-DGU 220/2010.\nI thank professor Dr. Rafael Vazquez Valenzuela from Universidad de Sevilla for his valuable comments and fruitful discussions.\nFurthermore, I thank the Conselho Nacional de Desenvolvimento Cient\u00edfico e Tecnol\u00e1gico (CNPq) for the financial support.\nFinally, I would like to thank my family and friends for their incessant support.\nRESUMO\nControl of Systems Modeled by Hyperbolic Partial Differential Equations\nGUSTAVO ARTUR DE ANDRADE\nFevereiro/2017\nOrientador: Prof. Daniel Juan Pagano, Dr.\n.\u00c1rea de concentra\u00e7ao: Controle, Automacao e Sistemas\nSistemas com par\u00e2metros distribu\u00eddos representam uma vasta gama de processos da engenharia. Neste caso, as variAaveis do sistema ir\u00e2o conter termos dependentes do tempo assim como gradientes espaciais e, portanto, e natural represent\u00e1-los por equa\u00e7\u00f5es diferenciais parciais. Exemplos podem ser encontrados em diversas \u00e1reas: desde processos qu\u00edmicos e t\u00e1rmicos, sistemas de produc\u00f5o e distribui\u00e7ao de energia, e problemas relacionados ao transporte de fluidos e ciencia m\u00e1dica.\nEsta tese trata dois tipos de problemas: estabiliza\u00e7\u00f5o de equa\u00e7\u00f5es diferenciais parciais hiperbo\u00e1licas lineares com vari\u00e1avel de controle na condi\u00e7ca\u00f5o de contorno e controle regulat\u00e1orio de sistemas descritos por equac\u00e7\u00f5oes diferenciais parciais hiperb\u00e1olicas quasilineares com vari\u00e1avel de controle no dom\u00e1nio. Com rela\u00e7c\u00f5ao ao primeiro, estudaram-se duas metodologias de controle: (i) uma lei de controle est\u00e1tica que garante converg\u00eancia do sistema para o ponto de equilibrio desejado. A metodologia de controle utiliza uma fun\u00e7\u00f5o de Lyapunov para encontrar os valores dos par\u00eametros do controlador que garantem estabilidade exponencial em malha fechada. Resultados de simulac\u00e7\u00f5ao para o problema de supress\u00f5ao de golfadas em sistemas de produ\u00e7ao de petr\u00e1leo s\u00f5o apresentados para ilustrar a efici\u00eancia do m\u00e1-todo; (ii) uma lei de controle baseada nas ferramentas cl\u00e1ssicas do dom\u00ednio da frequ\u00eancia. Neste caso, aplicamos a transformada de Laplace \u00e0 equa-\u00e7ca\u00f5o diferencial parcial para obter uma fun\u00e7c\u00f5ao de transfer\u00eaencia irracional e entao, ferramentas classicas do dom\u00ednio da frequ\u00eancia s\u00f5o usadas para projetar o controlador, de maneira similar aos sistemas de dimensao finita com fun\u00e7c\u00f5ao de transfer\u00eaencia racional. Estes resultados foram aplicados experimentalmente no problema de controle de oscila\u00e7c\u00f5oes termoacusticas do tubo de Rijke, mostrando a efetividade do metodo. Para o segundo problema, utiliza-se o metodo das caracter\u00edsticas combinado com a tecnica de controle por modos deslizantes. O metodo das caracter\u00edsticas \u00e9 usado para\ntransformar o sistema de equa\u00e7\u00f5es diferenciais parciais em um conjunto de equa\u00e7\u00f5es diferenciais ordin\u00e1rias que descrevem o sistema original. O projeto de controle \u00e1 ent\u00f5o realizado a partir deste conjunto de equa\u00e7\u00f5es diferenciais ordin\u00e1rias atrav\u00e1s de resultados bem conhecidos da teoria de equa\u00e7\u00f5es diferenciais ordin\u00e1rias. Os resultados obtidos foram testados experimentalmente em dois sistemas de escala industrial: uma planta solar e um fotobiorreator tubular.\nPalavras-chaves: controle de processos; controle por modos deslizantes; dom\u00ednio da frequ\u00eancia; equac\u00f5es diferenciais parciais; estabiliza\u00e7\u00f5o; fun\u00e7\u00f5o de transfer\u00eancia irracional; m\u00e9todo das caracter\u00edsticas.\nABSTRACT\nControl of Systems Modeled by Hyperbolic Partial Differential Equations\nGUSTAVO ARTUR DE ANDRADE\nFebruary/2017\nSupervisor: Prof. Daniel Juan Pagano, Dr.\nConcentration area: Control, Automation and systems\nDistributed parameter systems represent a wide range of engineering processes. In this case, the system variables will contain temporally dependent terms as well spatial gradients and, therefore, it is natural to represent them by partial differential equations. Examples can be found in many fields: chemical and thermal processes, production and distribution energy systems, and problems related to fluid transport and medical science.\nThis thesis deals with two different problems: stabilization of linear hyperbolic partial differential equations with boundary control and regulatory control of systems described by quasilinear hyperbolic partial differential equations with in domain control. Concerning the boundary control problem, we studied two control methodologies: (i) a static control law that guarantees convergence of the system to the desired equilibrium point. This control methodology uses a Lyapunov function to find the values of the control parameters that guarantee closed-loop exponential stability. Simulation results for the slugging control problem in oil production facilities are presented to illustrate the efficiency of the methodology; (ii) a control law based on the frequency domain tools. In this case, we applied the Laplace transform on the partial differential equation to obtain an irrational transfer function and then classical frequency domain tools are used to design the control law. These results were applied experimentally to the control problem of thermoacoustic oscillations in the Rijke tube, showing the effectiveness of the method. Regarding the regulatory control problem, we use the method of characteristics together with the sliding mode control methodology. The method of characteristics is used to transform the partial differential equations into a system of ordinary differential equations that describes the original system without any kind of approximation. Then, the control design is performed on the ordinary differential equations with well-known results of the theory of lumped parameter systems. The results\nwere validated experimentally in two industrial scale systems: a solar power plant and a tubular photobioreactor.\nKeywords: process control; sliding mode control; frequency domain; partial differential equations; irrational transfer function; stabilization; method of characteristics.\nContents\nList of Figures\t17\nList of Tables\t21\nNotation\t23\n1\tIntroduction\t25\n1.1\tMotivation and state of the art ........................... 25\n1.2\tProblem definition......................................... 27\n1.3\tObjectives................................................. 29\n1.3.1\tGeneral objective................................... 29\n1.3.2\tSpecific objectives ................................ 30\n1.4\tContributions.............................................. 30\n1.4.1\tPublications........................................ 31\n1.5\tOrganization of the thesis................................. 32\n2\tFirst-order hyperbolic systems\t35\n2.1\tFirst-order hyperbolic systems............................. 35\n2.2\tCharacteristic form of a hyperbolic systems ............... 37\n2.3\tThe Cauchy problem......................................... 40\n2.4\tMixed initial-boundary value\tproblem ...................... 43\n3\tBoundary control of linear hyperbolic systems\t45\n3.1\tDefinitions and notations ................................. 45\n3.2\tThe boundary control law................................... 47\n3.2.1\tStability analysis.................................. 47\n3.2.2\tExplicit dissipative boundary conditions............ 48\n3.3\tApplication of the boundary control strategy to the suppres-\nsion of slugging oscillations in oil facilities............ 50\n3.3.1\tSteady-state and linearized system.................. 50\n3.3.2\tModel in terms of characteristic coordinates......... 52\n3.3.3\tStability analysis................................. 54\n3.3.4\tDesign of the control law ......................... 56\n3.3.5\tSimulation results ................................ 57\n3.4\tConclusions.............................................. 58\n4\tBoundary control of a Rijke tube using irrational transfer\nfunctions\t59\n4.1\tOpen-loop transfer function of the Rijke tube ........... 59\n4.1.1\tPoles and zeros of the\topen-loop system............ 62\n4.2\tClosed-loop system....................................... 63\n4.2.1\tProposed control law............................... 63\n4.2.2\tStability analysis................................. 64\n4.3\tResults.................................................. 68\n4.4\tConclusions.............................................. 69\n5\tIn domain control of quasi-linear hyperbolic systems\t71\n5.1\tDefinitions and\tnotations ............................... 71\n5.2\tDistributed sliding mode control for quasilinear hyperbolic\nsystems................................................... 73\n5.2.1\tThe case of 1-D quasilinear hyperbolic systems with\nrelative\tdegree\tone................................ 74\n5.2.2\tThe case of 1-D quasilinear hyperbolic systems with\nrelative\tdegree\ttwo............................. 82\n5.3\tConclusions.............................................. 92\n6\tConclusions and future works\t95\n6.1\tFuture works............................................. 97\nBibliography\t99\nA\tModeling of slug flow phenomenon in oil installations\t107\nA.1 Description of slug flow....................................107\nA.2 Mathematical model..........................................109\nA.2.1 Formulating the model as a quasilinear hyperbolic system..............................................110\nA.\t2.2 Well-posedness....................................112\nA.\t3\tSimulation results ......................................113\nB Modeling thermoacoustic phenomenon in the Rijke Tube 115\nB.\t1\tSystem description.......................................115\nB.\t1.1 The Rijke tube ...................................115\nB.1.2 The thermoacoustic phenomenon in the Rijke tube . 116\nB.2\tMathematical model...........................................118\nB.\t3\tModel validation.............................................122\nC Modeling of solar power plants\t125\nC.\t1\tSystem description...........................................125\nC.2\tMathematical model...........................................126\nC.\t2.1 Well-posedness........................................127\nC.\t3\tModel validation ........................................... 128\nD Modeling biomass production in outdoor tubular photobiore-\nactors\t131\nD.\t1\tSystem description...........................................131\nD.2\tMathematical model...........................................134\nD.\t2.1 External loop mathematical\tmodel......................134\nD.\t2.2 Bubble column mathematical\tmodel......................139\nD.\t3\tModel validation ........................................... 141\nE Optimization of biomass production in outdoor tubular photobioreactors\t145\nE.\t1\tThe photobioreactor optimization problem...............145\nE.2\tOptimal control for biomass production ......................146\nE.\t2.1 First-order necessary Conditions for\toptimality\t.\t.\t.\t150\nE.2.2 Second-order sufficient conditions for optimality\t.\t.\t151\nE.3\tNear-optimal strategy .......................................152\nE.4\tResults................................................153\nE.4.1 Simulation results .................................... 153\nE.4.2 Experimental results .................................. 156\nE.5\tConclusions ................................................ 161\nList of Figures\n1.1\tSystems of interest for the in domain control problem. ...\t29\n2.1\tRepresentation of the characteristic curves............... 39\n3.1\tBottom and top pressure, and choke opening with the proposed control law. At t = 3.3 h the control was switched on\nand at t = 15 h the control was again switched off........ 57\n4.1\tLocation of the poles of the open-loop transfer function\n(4.14). They were calculated numerically by finding roots of (4.15). Note that there is an unstable pole at 131 Hz on the imaginary axis, and infinite stable poles that tend asymptotically towards (4.16)............................. 62\n4.2\tNyquist plot of r^(s) showing two clockwise encirclements\nof the origin as w decreases from I to to \u2014to............. 68\n4.3\tPressure fluctuations at the microphone location and control\nsignal as a function of time. At t = 3.5 s the controller is actived. At t = 12 s the control is deactivated........... 69\n5.1\tExperimental result of the solar power plant with DSMC\ncontroller in a clear day. Results of October 3rd, 2013. ...\t81\n5.2\tExperimental result of the solar power plant with DSMC\ncontroller in a cloudy day. Results of October 2nd, 2013. . .\t82\n5.3\tBlock diagram of control structure........................ 89\n5.4\tTime-response dynamics of the total inorganic carbon, the\nCO2 injection, and the pH when a step change at the total inorganic carbon reference was applied ................... 90\n5.5\tExperimental result of the tubular photobioreactor with DSMC\ncontroller. Results of July 1st, 2014..................... 91\n5.6\tExperimental result of the tubular photobioreactor with DSMC\ncontroller. Results of July 3rd, 2014..................... 92\nA.1 Family of systems subjected to the slugging phenomenon [67].108\nA.2 Typical bifurcation diagram considering the outlet valve opening as the bifurcation parameter. A stable limit cycle undergoes from a supercritical Hopf bifurcation HBsup. . . 108\nA.\t3 Bottom and top pressure for different choke opening values. 114\nB.\t1 Rijke tube schematic and detailed view of the prototype used\nfor the experiments.......................................116\nB.2 (a) Microphone signal at the onset of instability showing growth, and then saturation of the limit cycle. A zoomed-in picture shows the periodic, but nonsymetric, limit-cycle behavior. (b) Bifurcation diagram of non-dimensional velocity\nwith heat release as bifurcation parameter................117\nB.\t3 Validation result: bode plot of the Rijke model and the ex-\nperimental plant..........................................123\nC.\t1 Solar field in CIESOL [75]...............................126\nC.\t2 Validation results: simulated and experimental data of the\noutlet temperature as a function of solar radiation and volumetric flow..............................................129\nD.\t1 A schematic view of a tubular photobioreactor at Las Pal-\nmerillas experimental station, Almeria-Spain..............132\nD.2 Distribution of the forms of inorganic carbon in the photobioreactor with changes in pH. .......................... 138\nD.\t3 Validation results: simulated and experimental data of dis-\nsolved oxygen (DO) concentration, pH, and biomass concentration as a function of CO2 injection and solar radiation. . 143\nE.\t1 Surface of daily biomass production, calculated from the\nmodel (D.22) and (D.30) and cost function (E.1), as a function of the initial time and final switching time, in local hours. The dark blue contour level corresponds to wash out of the photobioreactor and the dark red contour to maximal daily production..........................................153\nE.2 Simulation results for the classic, near-optimal and optimal daily biomass production strategies. The graphics show (top) the biomass concentration at the outlet of the bubble column, Cb,out, (middle) the medium flow, Qm and (bottom) the solar irradiance profile............................................ 154\nE.3 Experimental result of the classic harvesting strategy being used at the Palmerillas Experimental Station. The harvesting process starts around 8:00 h and lasts 1 hour. The total cumulated flow is 0.3061 and the daily biomass production obtained is 0.2956 kg/m3....................................157\nE.4 Experimental result of the near-optimal harvesting strategy. The harvesting process starts around 18:00 h and lasts 1 hour. The total cumulated flow is 0.2485 and the daily biomass production obtained is 0.2947 kg/m3.........................158\nE.5 Experimental result of the near-optimal harvesting strategy. The harvesting process starts around 18:00 h and lasts 1 hour. The total cumulated flow is 0.2485 and the daily biomass production obtained is 0.3435 kg/m3.........................159\nE.6 Experimental result of the optimal harvesting strategy. The harvesting process starts around 13:00 h and lasts around 7 hours. The total cumulated flow is 0.1737 and the daily biomass production obtained is 0.0832 kg/m3.................160\nE.7 Experimental result of the optimal harvesting strategy. The harvesting process starts around 13:00 h and lasts around 9 hour. The total cumulated flow is 0.0918 and the daily biomass production obtained is 0.0392 kg/m3.................161\nList of Tables\nA.\t1 Parameters of the slug flow model......................114\nB.\t1 Values of the parameters of the system.................122\nC.\t1 Solar plant model parameters [75]......................128\nD.\t1 Composition of the culture medium used in the tubular\nphotobioreactor..........................................133\nD.\t2\tPhotobioreactor model\tparameters [40, 64]..............141\nE.\t1 Convergence behavior of the tubular photobioreactor opti-\nmization problem.........................................154\nE.2\tSensitivity to solar\tirradiance........................155\nE.3 Performance indexes calculated from the response of the experimental results of the classic, near-optimal and optimal strategies................................................162\nNotation\nSets\nR\tset of real numbers\nC\tset of complex numbers\nC+\tset of all complex numbers with real part larger than or equal zero\n\u25a0 Mm, n (R)\tset of m x n real matrices\nDn\tset of n x n diagonal real matrices with strictly positive diagonal\nFunction spaces and norms\nBy Ck we denote the class of k times continuously differentiable functions.\nConsider a function f : (0, 1) R and define, for p G [1, to)\nIfII Lp(0,1)\nThen, for p G [1, to), the Lp((0, 1); R) space is defined as\nLp((0, 1);R) = {f : ||f|lp(o,i) &lt;to}.\nFor p = to, we define\nLTO((0, 1);R) = {f : ||f||l~(o i) = sup |f(x)| &lt;to}. z\u00a3(0, i)\nDefine\nIIf^h2(o,i) = (jo |f(x)|2dx1 dX|2dx+jo 1\t|2dx)\nThen the Sobolev space H2((0, 1);R) is defined as\nh2((0, 1);R) = {f : IfIIh2(o,i) &lt;to}.\nConsider the holomorphic function G : C+\tC and define\nIIg(s)IIh(c+) = sup |G(s)|-\nk '\tRe(s)>0\nBy HTO(C+; C) we denote the following Hardy space:\nH\tC) = {G : HGHh^&lt;\nChapter 1 Introduction\n1.1\tMotivation and state of the art\nIn the last decades, the development of control techniques for linear and nonlinear systems with distributed parameter systems based on partial differential equations (PDEs) has received great attention from the scientific community [1, 2]. These control methodologies exploit the properties of the PDE system to ensure the control problem specifications. Applications of this research area can be found in many fields: chemical and thermal processes, distribution and energy production systems, and systems related with fluid transport and medical science [3].\nBased on the location of the actuators and sensors, the control methodologies for distributed parameter systems can be divided into (i) in domain control and (ii) boundary control. In the first case, the actuation and sensing are inside the domain of the PDE system or are evenly distributed everywhere in the domain. From a practical point of view, this means that the sensing and actuation are intrusive. In the second case, the sensing and actuation are not intrusive. Thus, in the mathematical formulation we have the actuation and sensing variables in the boundary condition of the PDE system. The boundary control is considered more realistic due to the fact that actuation and measurement are not intrusive in practice [4].\nSeveral control methodologies for boundary control and in domain control can be found in the literature. Motivated by several industrial processes, boundary control methodologies are most focused on stabilization. In [2, 5] the stabilization of linear PDEs is investigated through a frequency domain approach, whereas [6] focuses on the disturbance rejection problem for system modeled by linear first-order hyperbolic PDEs. In [7], a static control law based on a Lyapunov function is introduced for the particular\ncase of 2 x 2 linear hyperbolic PDEs without in domain coupling. In [8], this result was extended to n x n linear hyperbolic PDEs weakly coupled in domain. The case of first-order nonlinear hyperbolic PDEs was treated in [9]. Other extensions and applications of this control methodology can be seen in [10-12]. The backstepping method is another promising control methodology for boundary control stabilization problem in PDEs [4]. The main idea is to construct an invertible coordinate transformation (Volterra integral transform) and a control law in order to target the system to the desired closed-loop form. The closed-loop desired form is called target system. The choice of the target system is different for each class of PDEs. This requires that the control designer has a reasonable knowledge about the stability properties of the different classes of PDEs. Some results of this control methodology for hyperbolic PDEs can be seen in [1], and for parabolic PDEs in [13, 14].\nRegarding in domain control methodologies, in [15, 16] a feedback linearization control strategy for regulation and disturbance rejection problem was developed for linear and quasilinear hyperbolic PDEs. Other contributions for hyperbolic PDEs range from optimal control methods (e.g. [17-19]) and Lyapunov based methods [20]. The case of regulation and disturbance rejection through sliding mode control is studied in [21-24]. This method is based on the combination of the method of characteristics and the classical concepts of sliding mode control for lumped parameter systems. Methods based on spectral decomposition techniques can be seen in [25, 26]. This approach takes advantage of the spatial differential operator structure and used the Galerkin method to approximate the system by a low-dimensional set of ODEs and to design the controller [27].\nAlthough the research of control methodologies for distributed parameter systems based on the theory of PDEs has become increasingly active, many problems associated with general technical methodology, computational tractability and experimental applications in industrial systems remain open. Probably, these problems are related with the mathematical challenges of PDEs. Even simple problems such as heat equations and wave equations require the user to have a considerable background in PDEs and functional analysis before one can study the control design methods for these systems [4]. In this context, further research into the control of PDEs is necessary to yield results for a broader class of models.\nIn this thesis we will study the control problem of systems represented by quasilinear and linear first-order hyperbolic PDEs and applications, mainly taking into account the problems mentioned in the former paragraph.. These PDEs are used to represent a wide range of systems encountered in engineering processes. The focus of the study is on the nominal model of\nthe system and parametric uncertainties are not considered.\n1.2\tProblem definition\nIn this thesis we consider two distinct and disjoint control problems:\ni. The boundary stabilization problem of 1-D linear hyperbolic PDEs. In this case, these PDEs have the following expression:\ndu\td u\n\u2014 (x, t) + A\u2014(x, t) + Mu(x, t) = 0,\n(1.1)\nwhere t e [0, +to) is the time variable, x e [0, L] is the space variable, u : [0, +to) x [0, L] Rn is the vector of state variables, A and M are n x n real matrices.\nThe initial condition of (1.1) is\nu(x, 0) = uo(x), x e [0, L],\t(1.2)\nand the boundary conditions are\ngi,o(u(0, t),uo(t),Ci,oX(t)) = 0, t e [0, +<X>),\t(1.3)\ngijL(u(L, t),uL(t),CijLX(t))=0, t e [0, +to),\t(1.4)\ni = l,...,n,\nwhere gifi, gi,L : Rn+2 R, u0, uL : [0, +to) R are the control VariaM^, Ci,0 (ci1,0 . . . cip,0) and Ci,L (ci1,L . . . cip,L) are row vectors with real entries and\n(t) = f (X (t), u(L,t), u(0,t)),\nwith X e Rp, X(0) = X0, f : Rp+2n\tRp.\nii. The regulation and disturbance rejection problem of 1-D quasilinear hyperbolic PDEs with in domain control. These systems are given by\nd n\tdn\ndn(x, t) + A(n( x, t), u(t))dx(x, t) = F(n( x, t)),\t(1.5)\nwhere n : [0, +^) x [0, L]\tRn is the vector of state variables,\nA : Rn+1 Mn,n (R), u : [0, +to) R and F : Rn Rn.\nThe initial condition of (1.5) is\nand the boundary conditions are\nhi, o(n(0,t), Bi, oY (t)) = 0, t \u20ac [0, +to), hi,L(n(L,t), Bi,LY(t)) =0, t \u20ac [0, +to), i = i,...,n,\n(1.7)\n(1.8)\nwhere hit0,\thi,L\t:\tRn+1\tR,\tBit0\t=\t(b^y\t...\tbip,0)\tand\tBi,L\t=\n(bi1,L ... bip,L) are row vectors with real entries and\n(t) = \" Y (t) n(L,t) n(0,t))\nwith Y \u20ac Rp, Y(0) = Yo,\t: Rp+2n\tRp.\nThe control problem (1.1)-(1.4) is studied with an eye on the application of suppressing slugging oscillations in oil production facilities and thermoacoustic oscillations in the Rijke tube.\nSlugging is a well-known phenomenon that occurs in oil production facilities and is characterized by an intermittent axial distribution of gas and liquid, leading to an oscillating flow pattern. Consequently, sudden variations of oil production due to changes in pressure and flow rates of liquid and gas may occur. Slugging may have undesirable effects on the oil production process [28]. It will affect the oil production and will reduce the lifetime and increase the maintenance costs of the processing equipment. Therefore, its suppression by automatic control is of great economic interest.\nRegarding the phenomenon of thermoacoustic oscillations, it is described by high levels of sound produced due to the feedback between heat release rate fluctuations and acoustic pressure fluctuations in confined spaces. This phenomenon remains a serious problem in the development of gas turbines for aeroengines as well as for power generation applications [29]. In such applications, the thermoacoustic instabilities are undesirable due to the additional mechanical strain caused by the pressure waves on the components. Moreover, suppress these oscillations is essential for developing engines for propulsion and power generation with high efficiency, increased performance, and low emissions. In this thesis, we use the Rijke tube as a prototype system to study this problem, since the absence of combustion process in the Rijke tube turns the modeling and system analysis problem significantly more treatable than the other cases where thermoacoustic instability occurs [30].\nThe motivation for the study of the class of systems (1.5)-(1.8) emerged during a stay at the Grupo de Autom\u00e1tica, Bob\u00e1tica y Mecatr\u00f3nica of the Universidad de Almer\u00eda, Spain, under the supervision of the professors\n(a) Solar power plant at CIESOL building, (b) Tubular photobioreactor at Las Pal-Almeria - Spain\tmerillas experimental station, Almer\u00eda -\nSpain.\nFigure 1.1: Systems of interest for the in domain control problem.\nManuel Berenguel Soria and Jos\u00e9 Luis Guzm\u00e1n Sanchez, in which we developed control methodologies for an experimental solar plant at the Solar Energy Research Center (CIESOL) and an industrial tubular photobioreactor located at Las Palmerillas experimental station (Figure 1.1).\nThe control objective in the solar power plant is to maintain the outlet temperature of the field at a desired level in spite of disturbances (in this case the solar irradiance, ambient temperature and the inlet temperature of the fluid). Regarding the tubular photobioreactor, the control objective is to regulate the pH in its optimal value to maximize the biomass production and also to attenuate the undesirable transient caused by the disturbances.\nAlthough these systems have similar control objective, they have different relative degrees. As will be shown, the solar power plant has relative degree one, i.e., the output variable must be derived only one time to establish an explicit relation with the control variable. Whereas the photobioreactor has relative degree two. This property influences directly the control design [31].\n1.3\tObjectives\n1.3.1\tGeneral objective\nThe general objective of this thesis is to study and explore control methodologies, in a theoretical-experimental way, for the specific class of control problems of systems modeled by hyperbolic PDEs described in Section 1.2. The focus of this study is on the nominal model of the systems and para\nmetric uncertainties are not considered. Moreover, the results are presented, whenever possible, in a general form, in order to generate results of interest to a significant portion of the scientific community.\n1.3.2\tSpecific objectives\nIn order to achieve the general objective, the following specific objectives are listed:\n\u2022\tTo study the properties of first-order hyperbolic systems.\n\u2022\tTo study, in the bibliography, relevant information about the control of first-order hyperbolic systems.\n\u2022\tTo develop control methodologies that solve the control problem of the systems of interest.\n\u2022\tTo test experimentally the control methodologies in the control problems of interest.\n1.4\tContributions\nRegarding the use of the theoretical tools, it can be highlighted as contribution of this thesis the application and experimental validation of infinitedimensional control methodologies on industrial processes. Generally, these control methodologies are only tested by simulation on simple numerical examples.\nIn Chapter 3, we develop a static boundary stabilizing control law for the slugging problem of oil production facilities, based on the methodology of [7]. The proposed control law guarantees the convergence of the states to the origin in the L2-norm. Comparing to other control methodologies applied on the slugging problem, the proposed control law guarantees stability for greater values of the choke opening. Most of the control methodologies (see for instance [28]) stabilize the system for choke opening at the maximum of 20-25%, whereas the control law developed in this thesis can achieve values of choke opening of more than 45%.\nAnother contribution is the development of necessary and sufficient conditions for closed-loop stability of the thermoacoustic oscillations in the Rijke tube, presented in Chapter 4. In this case, we used some properties of the system transfer function to guarantee the input-output stability through the use of Nyquist-type test.\nIn Chapter 5, we develop a control law for the regulation problem of a solar power plant and a tubular photobioreactor. The control methodology\nused to solve these control problems is the sliding mode control together with the method of characteristics [21-24]. Moreover, an equivalent control law is developed for these systems to avoid the chattering phenomenon, an inherent characteristic of sliding mode control [32]. Furthermore, we suggested to use the total inorganic carbon as output to control the pH of the tubular photobioreactor. The main advantage of this approach is that it allows to derive an easier control law expression if compared to using directly the pH variable for designing the controller, due to the model complexity. Moreover, a comparative study between this control methodology and another classic methodologies, such as PID and model predictive controllers, was shown in [41, 42]. Through a set of numerical tests it was shown that the DSMC approach is better than PID and model predictive controllers in settling time and disturbances rejection.\nFinally, in Appendix E we develop two methodologies to maximize the biomass production in tubular photobioreactors. These methodologies achieved higher biomass production than the classical strategy that is currently used in the industry. However, as this is not the main topic of this thesis, we present these results as an appendix.\nI.\t4.1 Publications\nParts of the thesis are contained in the following conference papers and articles.\nConference papers\n[33]\tG. A. Andrade, D. J. Pagano, I. Fern\u00e1ndez, J. L. Guzm\u00e1n, and M. Berenguel. Boundary control of an industrial tubular photobioreactor using sliding mode control. In: Proceedings of the 19th World Congress of the International Federation of Automatic Control. Cape Town, South Africa, 2014. p. 4903-4908.\n[34]\tG. A. Andrade, D. J. Pagano, J. L. Guzman, and M. Berenguel. Op-timizaci\u00e1on de la produccio\u00e1n de biomasa en fotobiorreactores tubular. In: Proceedings of the 35th Jornadas de Autom\u00e1tica. Valencia, Spain, 2014. p. 513-519.\n[35]\tI. Fern\u00e1andez, G. A. Andrade, J. L. Guzm\u00e1an, M. Berenguel, and D.\nJ.\tPagano. Modelo NARMAX de pH en un fotobiorreactor tubular de microalgas. In: Proceedings of the 34th Jornadas de Automa\u00e1tica. Barcelona, Spain, 2013. p. 550-557.\n[11] G. A. de Andrade, and D. J. Pagano. Boundary control for stabilization of slugging oscillations. In: Proceedings of the 2th IFAC Workshop on\nAutomatic Control in Offshore Oil and Gas Production. Florian\u00f3polis, Brazil, 2015. p. 77-82.\n[36]\tI. Fernandez, M. Berenguel, J. L. Guzm\u00f3n, F. G. Aci\u00f3n, G. A. Andrade, and D. J. Pagano. Hierarchical non-linear control of a tubular photobioreactor. In: Proceedings of the 5th IFAC Conference on Nonlinear Model Predictive Control. Seville, Spain, 2015. p. 224-229.\n[37]\tG. A. de Andrade, Vazquez, R. and D. J. Pagano. Boundary feedback control of unstable thermoacoustic oscillations in the rijke tube. In: Proceedings of the 2th IFAC Workshop on Control of Systems Governed by Partial Differential Equations. Bertinoro, Italy, 2016. p. 48-53.\n[38]\tG. A. de Andrade, Vazquez, R. and D. J. Pagano. Boundary control of a Rijke Tube using irrational transfer functions with experimental validation. Submitted to the 20th World Congress of the International Federation of Automatic Control.\nArticles\n[39]\tG. A. Andrade, D. J. Pagano, J. D. Alvarez, and M. Berenguel. Distributed sliding mode control: Application to a solar power plant. Journal of Control, Automation and Electrical Systems, v.25, n. 3, p. 291-302, 2014.\n[40]\tI. Fern\u00f3andez, F. G. Aci\u00f3en, M. Berenguel, J. L. Guzm\u00f3an, G. A. Andrade, and D. J. Pagano. A lumped parameter chemical-physical model for tubular photobioreactors. Chemical Engineering Science, v. 112, p. 116-129, 2014.\n[41]\tG. A. de Andrade, J. D. Alvarez, D. J. Pagano, and M. Berenguel. Nonlinear controllers for solar thermal plants: a comparative study. Control Engineering Practice, v. 43, p. 12-20, 2015.\n[42]\tG. A. de Andrade, D. J. Pagano, J. L. Guzm\u00f3n, M. Berenguel, I. Fer-n\u00f3andez, and F. G. Aci\u00f3en. Distributed sliding mode control of pH in tubular photobioreactors. IEEE Transactions on Control Systems Technology, v. 24, p. 1160-1173, 2016.\n[43]\tG. A. de Andrade, M. Berenguel, J. L. Guzm\u00f3n, D. J. Pagano, and F. G. Aci\u00f3en. Optimization of biomass production in outdoor tubular photobioreactors. Journal of Process Control, v. 37, p. 58-69, 2016.\n[44]\tI. Fern\u00f3andez, M. Berenguel, J. L. Guzma\u00f3n, F. G. Aci\u00f3en, G. A. de Andrade, and D. J. Pagano. Hierarchical control for microalgae biomass production in photobioreactors. Control Engineering Practice, v. 54, p. 246-255, 2016.\n1.5\tOrganization of the thesis\n\u2022\tChapter 2 focus on the properties and main theorems related to first-order hyperbolic systems. The definition of hyperbolicity, the Cauchy problem and the mixed initial-boundary value problem are introduce. The definition of characteristic coordinates, which is used to transform the PDE system into the well-known characteristic form is also introduced. All these definitions and properties will be used in the remaining chapters for the controllers design.\n\u2022\tIn Chapter 3 we study the problem of suppressing slugging phenomenon in oil facilities by means of a stabilizing boundary control law. We start the chapter by stating the proposed control methodology for general 1-D linear hyperbolic PDE systems. Then, we show how to apply this methodology to the slugging control problem. The resulting control law only needs measurements of pressure at the outlet valve, the bottom pressure and total flow-rate measurement through the outlet valve. The closed-loop stability result is stated and proved by Lyapunov function approach. Simulation results on a nonlinear model of the slugging phenomenon shows the effectiveness of the results.\n\u2022\tIn chapter 4 we focuses on the stabilization of thermoacoustic oscillations in the Rijke tube, under a frequency domain approach. First, the theoretical model of the Rijke tube is rigorously studied to derive an irrational transfer function. Then, a control law is designed by using classical frequency domain tools to guarantee input-output stability. We test the proposed control methodology in an experimental setup to show its effectiveness and real-life applicability of the method.\n\u2022\tIn Chapter 5 we study the regulation problem and disturbance rejection of hyperbolic PDEs with in domain control. For this case, we use the sliding mode control methodology together with the method of characteristics. We state this methodology for systems with relative degree one and two, respectively. The development of an equivalent control law to avoid the chattering phenomenon, an intrinsic characteristic of this methodology, is treated. The results are tested experimentally in a solar power plant and a tubular photobioreactor of industrial scale.\n\u2022\tThe concluding remarks and future perspectives are given in Chapter 6.\n\u2022\tIn Appendices A-D we describe the systems that were used to validate the control methodologies in Chapters 3- 5. In each of these\nappendices is given a brief description of the plant, the mathematical model and the control problem.\n\u2022 Appendix E gives two methods to calculate the optimal medium culture flow rate in order to maximize the biomass production in outdoor photobioreactors. One methodology is based on the optimal control theory. In this context, a direct method is used to discretize the optimal control problem and a nonlinear programming technique is applied into the resulting optimization problem. The other methodology calculates only the culture medium injection time, while the culture medium flow rate is maintained constant during this time. The results are validated experimentally in a tubular photobioreactor of industrial scale. However, as this is not the main topic of this thesis, we present these results in Appendix E.\nChapter 2\nFirst-order hyperbolic systems\nIn this chapter, we discuss the main concepts related to first-order hyperbolic systems: hyperbolicity, characteristic coordinates, the Cauchy problem and the mixed initial-boundary value problem. The material shown in this chapter was extracted from [45-48]. The chapter is organized as follows. In section 2.1 we define the class of first-order hyperbolic systems of interest in this thesis. The characteristic form of first-order hyperbolic systems is introduced in Section 2.2. The Cauchy problem and mixed initial-boundary value problem are discussed in Sections 2.3 and 2.4, respectively.\n2.1\tFirst-order hyperbolic systems\nWe consider the following first-order quasilinear system\nd u .\t.\t. . .\t.. du .\t.\t\u201e. .\n\u2014 (x, t) + A(u(x, t)) \u2014 (x, t) = F(u(x, t)),\n(2.1)\nwhere t e [0, +to) is the time, x e [0, L] is the space, u : [0, L] x [0, +to) Rn is the state vector, A : Rn Mn,n(R) and F : Rn Rn are of class C 1.\nDefinition 2.1. The system (2.1) is hyperbolic if, for any given u on the domain under consideration, A(u(x, t)) has n real eigenvalues Ai(u(x, t)), . .., , An(u(x, t)), a complete set of left (respectively right) eigenvectors li(u( x, t)) = (l\u00bbi(v(x, t)), ..., /\u00bfn(u(x, t)) (respectively rj(u( x, t)) = (rw(v(x, t)), . .., rni(u(x, t))T), for i = 1,. .. ,n, such that\nand\nA(u(x, t))ri(u(x, t)) = Aj(u(x, t))ri(u(x, t)).\t(2.3)\nWe have\ndet |/jj(u(x, t))| = 0,\t(respectively det |rjj(u(x, t))| = 0).\t(2.4)\nWithout loss of generality, we may assume that on the domain under consideration\nli(u(x, t))rj(u(x, t)) = Sij\t(i,j = 1,. .., n)\nand\nrl(u(x, t))ri(u(x, t)) = 1\t(i = 1,.. ., n),\n(2.5)\n(2.6)\nwhere hi,j stands for the Kronecker symbol. Let\nL(u(x, t)) =\n&lt;li(u(x, t)) \\\n.\tI = lij(u(x, t)),\nln(v(x, t)) J\nR(u(x, t)) =\nri(u(x, t))\n. rn\n= rij (u(x i)),\n(2.7)\n(2.8)\nbe the matrices composed of the left and right eigenvectors respectively, and\nA(v(x, t)) = diag{Ai(u(x, t)), ..., An(u(x, t))}.\t(2.9)\nThen, by (2.2)-(2.3), immediately follows that\nL(u(x, t))A(u(x, t)) = A(u(x, t))L(u(x, t)),\t(2.10)\nand\nA(u(x, t))R(u(x, t)) = A(u(x, t))R(u(x, t)).\t(2.11)\nMoreover, by (2.5) we have\nL(u(x, t))R(u(x, t)) = I,\t(2.12)\nDefinition 2.2. If, for any given u(x, t) on the domain under consideration, A(u(x, t)) has n distinct real eigenvalues, i.e.,\nAi(u(x, t)) &lt;A2(v(x, t)) &lt;\u2022 \u2022 \u2022 &lt;An(v(x, t)),\t(2.13)\nthen, the set of left (respectively right) eigenvectors must be complete. This kind of hyperbolic system (2.1) is called to be a strictly hyperbolic system.\nAs shown in [47], for any strictly hyperbolic system, all Aj (u(x, t)), /j(r(x, t)) and rj(r(x, t)) (i = 1, ..., n) have the same regularity as A(u(x, t)). However, it is not always the case for general hyperbolic systems.\nExample 2.1. Let\n,\t( 0 u\nA(u)=( u2\t0\nNote that A(u) G C '\u25a0, but the eigenvalues A1,2(o) = \u00b1u2 / C '\u25a0 at u = 0.\nExample 2.2. Let\nA(u) =\n0,\n___1_\ne u2\ncos sin\nsin cos ( U ) A - cos (U )\nu=0\nu=0\nIt is easy to see that A(u) G C '' and the eigenvalues Ai,2 = \u00b1e-U2 G C '' . However, one can not find a complete set of left (respectively right) eigenvectors {li(u), \u00bf2(0)} (respectively {ri(0), r2(u)}) depending continuously on u at u = 0.\n2.2\tCharacteristic form of a hyperbolic systems\nFor hyperbolic systems, there exists a change of coordinates \u00a3(x, t) = ^(v(x, t)) such that (2.1) can be transformed into a system of coupled transport equation\ndf\tdf-\n-7^(x, t) + Aj\u00ab(x, t))-dx(x, t) = ^\u00bf\u00ab(x, t))\n\u2022\tThe function : Rn\tRn is a diffeomorphism:\nC(x, t) = y>(v(x, t))\tu(x, t) = ^-1\u00ab(x, t)),\nwith Jacobian matrix ^(u(x, t)) = d^/dv.\n\u2022\tThe Jacobian matrix ^(u(x, t)) diagonalizes the matrix A(u(x, t)):\n^(u(x, t))A(u(x, t)) = A(u(x, t))^(u(x, t)).\nClearly, this change of coordinates exists for any hyperbolic PDE system with A e Mn,n(R) constant and A diagonalizable. If the entries of A are nonlinear, finding the change of coordinates \u00a3(x, t) = ^(u(x, t)) requires to find a solution of the first order PDE ^(u(x, t))A(u(x, t)) = A(u(x, t))^(u(x, t)).\nExample 2.3. channel\tConsider the linearized Saint- Venant system for a single open du .\t, du .\t.\t. (x, t) + A \u2014 (x, t) = F(u(x, t)),\na (V H )\u2022\t(-\u25a0 -\u25a0 Cf\u2022\u25a0\u25a0)\nwith\n' ( V)\nIn these expressions, h(x, t) = H(x, t) \u2014 H and v(x, t) = V(x, t) \u2014 V denote the deviations of the water height, H, and water velocity, V, with respect to the steady-states H and V, respectively. The gravity constant is denoted by g and C is a friction parameter.\nNotice that A has two distinct non-zero eigenvalues, namely,\nAi = V + N gH > 0,\nA2 = V \u2014 V gH &lt;0.\nThe corresponding left eigenvectors can be taken as\nh =\nI2 =\nIt follows that the characteristic coordinates can be defined as\n\u00a31(x, t) = v(x, t) + h(x, t)\nThe inverse transformation can also be computed from the above equation:\nh(x, t) =\nfi(x, t) -&amp;(x, t) [h\n2 V\nv(x, t) =\nf1(x, t) + &amp;(x, t)\n2\nOne can observe that the quantity fi can be seen as the directional derivative dfi/dt at point (x, t) along the curve (xi(x, t, s),Tj(x, t, s)) satisfying\ndx\n-(x-(x,t, s),Ti(x,t, s)) = Ai\u00ab(xi(x,t, s),Ti(x,t, s)), x-(x,t, 0) = xo, ds\n(2.15)\ndTi (xi(x,t, s), Ti(x,t, s)) = 1, ds\nTi(x,t, 0) = 0.\n(2.16)\nThis curve is called characteristic curve. The quantity Xi is called characteristic velocity and its sign directly influences the direction of the solution propagation fi. This property, illustrated in Figure 2.1, is very important and will be used for the results that will be developed in the following chapters.\nFigure 2.1: Representation of the characteristic curves.\nThe derivative of fi with respect to s then can be written\ndfi\n~T(x-(x, t, s),Ti(x, t, s)) = gi(C(x-(x, t, s), Ti(x, t, s)) ds\nRemark 2.1. If gi,(fi(x, t)) = 0 for some i, then ( is constant (or invariant) along the i-th characteristic curve, since (xi(x, t, s),Tj(x, t, s)) = 0. In this case, the quantity ( is called Riemann invariant.\nDefinition 2.3. The vector field\nKi = (gi\u00ab(xi(x, t, s), Ti(x, t, s))), Xi('Xi(x, t, s)), Ti(x, t, s)), 1)\nis called i-th characteristic vector field of (2.14).\nThis method of transforming the PDE system (2.14) into a set of ODEs along the characteristic curvers is called method of characteristics [45]. Once these ODEs are found, they can be solved and transformed into a solution for the original PDE system. However, it is generaly not possible to separately solve the differential equations of the characteristic curves (2.15)-(2.16) and the system variables (2.17). Therefore, it is necessary to integrate them simultaneously, generally using numerical methods.\nThe existence and unicity of continuously differentiable solutions of the above PDE system on an interval t e [0, J] is known as Cauchy problem and has been intensively studied in the literature [45, 47, 49]. In general, this is shown on the basis of the integral representation\n(i(x, t) = (i(xi(x, t, 0), 0, 0) + / gi(C(xi(x, t, s),Ti(x, t, s))ds\nJo\nof (2.17). In the next section we give a sufficient condition for the existence of a solution for the Cauchy problem.\n2.3\tThe Cauchy problem\nConsider the Cauchy problem for system (2.1)\ndu .... .\t.. du .\t.\t\u201e. .\n(x, t) + A(u(x, t)) \u2014 (x, t) = F(u(x, t))\nu(x, 0) = ^(x),\tx e (\u2014to, to),\n(2.18)\n(2.19)\nwhere ^(x) = (^(x), ...,&lt;y>n(x)) is a given C1 function of x with bounded C1 norm ||u||1 = supx |u(x)| + supx |u'(x)|.\nNoting that in the corresponding characteristic form (2.14), for each i = 1, ..., n, the i-th equation is an ordinary differential equation along the i-th characteristic, we have that [47, 50]:\nTheorem 2.1. Suppose that Xfiyfix, t)), \u00a1i(v(x, t)) (i = 1,\tn) and\nF(u(x, t)) are all C1 functions and ^(x) is a C1 vector function with\nbounded C1 norm. Then, there exists 5 > 0 such that the Cauchy problem\n(2.18)-(2.19) admits a unique local C1 solution u on the domain\n{(x, t)|0 &lt;t &lt;5, \u2014to &lt;x &lt;+to} .\nMoreover, if\nF(0) = 0,\n(2.20)\nthen, for any given A(u(x, t)) and F(u(x, t)), 5 > 0 can be taken as 5 = 5(||^(x))||1) depending only on the C1 norm ||^(x))||1.\nExample 2.4. Consider the Cauchy problem for the Burgers equation\nu(x, 0) = y>(x),\n(2.21)\n(2.22)\nwhere ^(x) is a C1 function.\nOn the existence domain of the solution u to the Cauchy problem, the characteristic curve is defined by\nMoreover, along the characteristic curve we have\n(2.23)\n(2.24)\n(2.25)\nnamely, u takes a constant value and therefore u is Riemann invariant. Furthermore, since u is constant, it follows, by (2.23)-(2.24), that the characteristic curve must be a straight line.\nSolving (2.23)-(2.25) with the initial data (2.22), we get that the characteristic curve passing through any given point (x, t) = (xg, 0) is\nx = xg^(xg )t\n(2.26)\non which\nHence, if the C1 norm of&lt;y>(x) is bounded, for small values of t, by means of the implicit function theorem we can get from (2.26) that\nxo = xo(x, t).\t(2.28)\nSubstituting (2.28) into (2.27) gives the solution of the Cauchy problem (2.21)-(2.22):\nu = p(x0(x, t))\nNote that this solution exists in general only locally in time. In fact, if&lt;p(x) is not a non decreasing function of x, there exist two points (0, xa) and (0, xb) on the initial axis, such that xa &lt;xb and&lt;p(xa) >&lt;p(xb).\nThus, the characteristic curves passing through these two points are respectively\nx = xa + p(xa )t,\nx = xb + p(xb)t,\nmust intersect each other in a finite time and, since the solution u takes the different values&lt;p(xa) and p(xb) on these two characteristic curves, at the intersection point the value of the solution can not be uniquely determined.. In this case, the Cauchy problem (2.21)-(2.22) does not admits a global solution on t > 0, i.e., the solution to this Cauchy problem must blow up in a finite time.\nRemark 2.2. When the initial condition ^(x) is defined in a finite interval xa &lt;x &lt;xb instead of the whole x-axis, then, Theorem 2.1 is still valid on the corresponding maximum determinate domain:\n{(x, t)|0 &lt;t &lt;\u00bf, xa(x, t, s) &lt;x &lt;xb(x, t, s)} ,\nwhere x = xa(x, t, s) e x = xffx, t, s) are determined by\ndxa\nds dTa ds\nxa(x, t, 0) = xa,0\nTa(x, t, 0) = 0\nmax Ai(v(xa (x, t, i=1, ...,n\n1\ns), Ta(x, t, s)))\nand\nd^b = min Xi(v(xb(x, t, s), Tb(x, t, s))) ds\ti=1,...,n\ndTb = ,\nds\nxb(x, t, 0) = xb,o\nTb(x, t, 0) = 0\nIn other words, x = xa(x, t, s) is the rightmost characteristic passing through the point (x, t) = (xa, Ta) and x = Xb(x, t, s) is the leftmost characteristic passing through the point (x, t) = (x^, Tb).\n2.4\tMixed initial-boundary value problem\nWe consider the following mixed initial-boundary value problem:\ndu .... .\t.. du .\t.\t\u201e. .\n(x, t) + A(u(x, t)) \u2014 (x, t) = F(u(x, t))\nu(x, 0) = ^(x),\tx e [0, L],\nvs = hs(vi, .. ., vm, t),\t(s = m + 1, ..., n)\nvr = hr(vm+1, . .., vn, t),\t(r = 1, .. ., m)\n(2.29)\n(2.30)\n(2.31)\n(2.32)\nwhere\nVi = /j(^(x))u\t(i =1, ..., n).\nWithout loss of generality we assume that\ngi(t, 0, ..., 0) =0\t(i = 1, ..., n).\n(2.33)\nWe suppose that matrix A(u(x, t)), in (2.29), has no zero eigenvalues, i.e.,\nAr(u(x, t)) &lt;0 &lt;As(u(x, t))\t(r = 1, ..., m; s = m + 1, ..., n).\n(2.34)\nMoreover, the conditions of C1 compatibility are supposed to be satisfied at the points (x, t) = (0, 0) and (L, 0) respectively. More precisely, the conditions of C1 compatibility at the point (x, t) = (0, 0) are\nls(u\u00b0(0))u\u00b0(0) = hs(li(u\u00b0(0))u\u00b0(0), ..., lm(u\u00b0(0))u\u00b0(0),0)\n(s = m + 1, . .., n)\t(2.35)\nand\nd\td\n~Qt [ls(u\u00b0(0))u\u00b0(0)] = \u2014 [hs(li(u\u00b0(x))u\u00b0(0), ..., lm(u\u00b0(x))u\u00b0(0),0)] .\n(2.36)\nSimilarly, for the point (x, t) = (L, 0)\nls(u\u00b0(L))u\u00b0(L) = hs(li(u\u00b0(L))u\u00b0(L), ..., lm(u\u00b0(L))u\u00b0(L),0)\npara s = m + 1, ..., n\t(2.37)\nand\nd\td\n- [ls(u0(L))u0(L)] = - [hs(Mu0(L))u0(L), ..., lm(u0(L))u0(0),0)] .\n(2.38)\nUnder these assumptions, we have[47]:\nTheorem 2.2. Suppose that Xi (u(x, t)), li(u(x, t)), F(u(x, t)), hj(t) (i =\n1, . .., n), and ^(x) are all C1 functions with respect to their arguments. Suppose furthermore that (2.4), (2.33) and (2.34) hold. Suppose finally that the conditions of C1 compatibility are satisfied at the point (x, t) = (0, 0) and (L, 0) respectively. Then, there exists 5 > 0 such that the mixed initialboundary value problem (2.18)-(2.32) admits a unique local C1 solution u on the domain\nR(5) = {(x, t)|0 &lt;t &lt;5, 0 &lt;x &lt;L} .\nMoreover, if (2.20) holds, then, for any given A(u(x, t)), F(u(x, t)) and gi(t, \u2022) (i = 1, .. ., n), 5 > 0 can be taken as 5 = 5(||^||i, ||h|| 1), i.e., depending only on the C1 norms ||^||1 and ||h||1.\nRemark 2.3. Suppose that there are zero eigenvalues, but the following inequalities are satisfied\nXp(y(x, t)) &lt;Xq(u(x, t)) = 0 &lt;Xr(u(x, t))\n(p =1, . . . , l; q = l +1, ..., m; r = m +1, ..., n).\nThen, the boundary conditions (2.31)-(2.32) should be replaced by\nx = 0 : vr = gr(V1, .. ., Vi, vi+1, .. ., vm, t)\t(r = m + 1, . .., n)\nx L :\tvp\tgp(Vl+1?\t. . . ,\tvm,\tvm+1i\t. . . ,\tt)\t(p\t1 . . . , l)\nwith\nhp(t, 0, . .., 0) = hr(t, 0,. .., 0) = 0(p = 1, . .., l; r = m + 1, . .., n).\nIn order to Theorem 2.2 be applied.\nRemark 2.4. In [51] it was shown how to extend these results to the case of general differential boundary conditions with a much more involved technical development then Theorem 2.2.\nRemark 2.5. Extensions of the local existence results shown in Theorem 2.1 and 2.2 have been discussed in numerous contributions (cf. [49] and [47]). However, these results are in general valid only under very conservative assumptions on the initial condition.\nChapter 3\nBoundary control of linear hyperbolic systems\nIn this chapter, the problem of suppressing slugging phenomenon is investigated. Industrial facilities such as gas-lifted wells and offshore production oil-risers are examples of system where occurs such phenomenon. To study this problem, we consider that these systems are written as a set of 3 x 3 hyperbolic PDEs of balance laws, where the control variable appears at the right boundary condition (see Appendix A). By means of the characteristic coordinates approach, we deduce a stabilizing control law. The exponential stability of the equilibrium is proved by means of a Lyapunov stability analysis. The chapter is organized as follows. In section 3.1 we detail the notation used throughout the chapter. In Section 3.2 we derive the control methodology theory. The design of this control strategy to the slugging problem and simulation results are shown in Section 3.3. The conclusions are given in Section 3.4.\n3.1\tDefinitions and notations\nIn this section we give the definitions and notations used throughout this chapter. We are interested in the following 1-D n x n linear hyperbolic system:\nd\u00a3\td \u00a3\n-dt(x, t)+ AdX (x, t) - M\u00a3(x, t)=0,\t(3.1)\nwhere t e [0, +to) is the time variable, x e [0, L] is the space variable, \u00a3 : [0, +to) x [0, L] Rn is the vector of state variables, and A, M e\nMn,n(R). We assume that A is diagonal with non-zero real diagonal entries such that\nA = diag{Ai, A2, ..., An}, Ai > 0 V i G {1, ..., m},\nAi &lt;0 V i G {m + 1, . .. , n}.\nFor legibility and to facilitate the computations to be presented in this chapter, we introduce the following notations:\nu =\n\u00a3m+1\n\\ \u00a3n\n1\n(3.2)\nc =\nand\nA+ = diag{Ai,..., Am},\nA- = diag{Am+i,..., An}.\nUsing these notations, system (3.1) is rewritten to\nn 4 a+\nM c )\t0\n0 a JL( c+ A J dx \\ C\n(3.3)\nThe initial condition of (3.3) is\ni x- 0) = c0(xX\tx G [0, L],\t(3.4)\nand the boundary conditions are\t\t\ngi,0(C(0, t), C(L, t), u0(t)) =\t= 0, t G [0, +to),\t(3.5)\n9i,L(C(0, t), C(L, t),uL(t)) =\t= 0,\tt G [0, +to),\t(3.6)\ni = i,.\t\t\nwhere gi0, giL : Rn+1\tR and u0, uL\t: [0, +to)\tR are the\tcontrol\nvariables.\nOur objective is to design u0 and uL such that (3.3)-(3.6) is exponentially stable. We adopt the following definition for exponential stability of\n(3.3)-(3.6):\nDefinition 3.1. The linear hyperbolic system (3.3)-(3.6) is exponentially stable if for every T > 0, there exists C(T) > 0 such that, for every C\" G L2([0, L];Rn), the solution to the Cauchy problem (3.3)-(3.6) satisfies\nIICG t)||L2([0,L]) &lt;Ce-ai||C0||L2([0,L]).\n3.2\tThe boundary control law\nFollowing [52], a simple solution to guarantee exponential stability of system\n(3.3)-(3.6) is to impose a control action uo and uL such that boundary conditions (3.5)-(3.6) are transformed to\ne+(0, t)\t\\\t= / Koo\tK01 \\\ti e+(L, t)\t\\\t(3\nC(L,t)\t) K10\tKxJ C(0,t)\t)\t,\t(3.7)\n'------V------'\nK\nwhere K is a real matrix.\nThe Cauchy problem (3.3), with initial condition (3.4) and boundary condition (3.7) is well-posed [51]. This means that for any initial condition \u00a30 e L2([0, L]; Rn) and for every T > 0, there exists C(T) > 0 such that a solution g(x, t) e Co([0, +to); L2([0, L]; Rn)) exists, is unique and satisfies\nll\u00a3(> t)|L2([o,L]) &lt;C(T) ||\u00a3 Hl2([o,l]) , ^t e [0, T].\nIn the next subsection we will impose sufficient conditions for (3.3)-(3.4) under the boundary conditions (3.7) to guarantee exponential stability according to Definition 3.1.\n3.2.1\tStability analysis\nConsider the following Lyapunov function\nV = i\tP(x)<dx,\t(3.8)\no\nwhere P(x) =&lt;liag{p.,/ 'T'/,x. i = 1, ..., n}, with p > 0, pi > 0 positive real numbers and Oj = sign(Aj).\nThe time derivative of V along the system (3.3)-(3.4) and (3.7) is\ndV- = f (\u2014AP<*>\u00ab\u2014\u00abTP<*>A '+ i M P<*>\u00ab+\nThen, integrating by parts, we have:\ndV\ndt\n= \u2014 ( &lt;(L, t)\niT (0, t)\n( APqL)\n0\t\\ (&lt;(l, t) \\ +\n\u2014ap(0) J m \u25a0\t'\n<T (\u2014p|A|P(x) + MtP(x) + P(x)m) I dx.\nNote that if dV/dt is negative definite, then the system is exponentially stable. We then have following theorem [8]:\nTheorem 3.1. The system (3.3) with initial condition (3.)) and boundary conditions (3.5)-(3.6), with uo and uL such that (3.7) holds, is exponentially stable if there exist p > 0 and pi > 0, i = 1, .. ., n such that\n1. The boundary quadratic form\n( I (\u00a3, i) I (0, i) ) ( AP0(L) \u2014 aP(#) ) (\t,\nis positive definite under the constraints of the linear boundary conditions\n<+ (0, t) \u2014 Kooi+(L, t) \u2014 Koi<-(0, t) = 0, C(L, t) \u2014 K!oi+(L, t) \u2014 Koi<-(0, t) = 0,\nVt > 0 along the solutions of system (3.3) with initial condition (3.)) and boundary conditions (3.5)-(3.6), with uo and ul such that (3.7) holds.\n2. The matrix \u2014p| A|P + Mt P( x) + P(x)M is negative definite Vx e (0, L).\nDefinition 3.2. Boundary conditions that satisfy condition 1 of the previous theorem are called dissipative boundary conditions.\n3.2.2\tExplicit dissipative boundary conditions\nIn this section, we will show a variant of Theorem 3.1. This approach allow us to obtain an explicit characterization of a dissipative boundary condition which guarantees the system exponential stability in the case where ||M|| is sufficiently small.\nLet Dp denote the set of diagonal pxp real matrices with strictly positive diagonal entries. Then, the Lyapunov function (3.8) is rewritten to\nr L\nV = / [(<+TPoI^ '\t+ (<-Tdx, (3.9)\nwhere p > 0 and Po e Dm, Pi e Dn.\nConsider the following norm for the matrix K:\np(K) A inf {||AKA -i||, A e S} ,\t(3.10)\nwhere || \u2022 || is the usual matrix 2-norm and\nS = {A = diag{Do, Di}, D0 = P0A+, D? = PiA -} .\t(3.11)\nWe have then the following theorem:\nTheorem 3.2. If p(K) &lt;1, there exist \u00a3 > 0 such that, if \\\\M\\\\ &lt;\u00a3, then the linear hyperbolic system (3.3) with initial condition (3.4) and boundary conditions (3.5)-(3.6), with uo and ul such that (3.7) holds, is exponentially stable.\nProof. Consider the candidate Lyapunov function (3.9). The time derivative of V is\ndV\ndt\n= d (<+TPoA+ C+) e-dx+/\u00b0 dx (* -TPiA -C -dx\n+\n(MtP + pm) C dx.\n(3.12)\nwhere P A (Poe \u00a1ix. Pie^x).\nThen, integrating by parts:\n% = Vi+ V2,\t(3.13)\nwhere\nVi a\n[C+TPoA+e+e-^x] L + [c-TPi ATe^] L ,\nV2 A j CT (-pPA + MTP + pm) C dx.\nTo show that dV/dt is negative definite we will show that Vi and V2 are negative definite.\nIn order to show that Vi is negative definite we introduce the following notations:\nSubstituting the boundary condition (3.7) in V1, we have\nVi = - [<+TPoA+e+e-^x]L + T PiA-CeMX]L\n= - (e+T PoA+e+e-^+e\tm-e-) +\n(e+T kTO+e-T kTi) PoA+ (Koo<+ + Koieo) +\n(e+T Kfo+e-T KTi) PiA- (Kioe++KUe-) \u25a0\u25a0.\t(3.14)\nSince p(K) &lt;1 by hypothesis, there exist Do G Dn, D1 G Dn-m and A = diag{D0, Di} such that\nIIAKA-11| &lt;1.\t(3.15)\nSelect Po and P1 such that P0A+ = DO and P1A- = Dp\nDefine z0 = Do\u00a3-, z1 = D1e+ and zT = (zT,zT). Then, using the inequality (3.15), we have\n(e+T kTo+e-T KTi)PoA+(Kooe++Koie-) + (e+T K0+ e-TKTi)PiA-(Kioe+ + Kiie-) = ||AKA-iz||2 &lt;||z||2\n= e+TPoA+e++e-T PiA-e-.\t(3.16)\nComparing (3.16) with (3.14) we can therefore conclude that there exists p, sufficiently small such that V is negative definite.\nIn order to show that V2 is negative definite, it is easy to see that if there exist \u00a3 > 0 such that ||M|| &lt;\u00a3 then there exists a > 0 such that\ndV\nV2 &lt;\u2014aV\t\u2014 = Vi + V2 &lt;\u2014aV.\ndt\nConsequently the solutions of the system (3.3) with initial condition\n(3.4)\tand boundary conditions (3.6) exponentially converge to the origin in L2 -norm.\t\u25a1\n3.3\tApplication of the boundary control strategy to the suppression of slugging oscillations in oil facilities\n3.3.1\tSteady-state and linearized system\nWe assume that the steady-state solution for system (A.10) is a constant solution e(x, t) = e*, Vt G [0, +^), Vx G [0, L], satisfying the boundary\nconditions (A.6)-(A.8) and the condition\n2 (1\u2014u\u00a3 )(\u201d(1\u2014u\u00a3 )M2uf +2MRTpiu\u00a3uP + R2T 2pfu \u00a3 fu3-----\"--------------------L--------\n2 AMdpi uf ((1-u\u00a3 )Muf + RTpiu\u00a3)\nAMpi\n\u25a0tz-#\t\u2014-gsin0(x).\n(1\u2014u\u00a3)Muf + RTpiu 3^\t- 7\nIn order to linearize the system (A.10) and its boundary conditions (A.6)-(A.7), we define the deviations of the states v1(x, t), v2(x, t) and v3(x, t) with respect to the steady-states v*, v* and v* by\n6vi(x, t) = vi(x, t) \u2014 v*,\n5v2(x, t) = v2(x, t) \u2014 v2,\nSv3(x, t) = v3(x, t) \u2014 v3.\nThen, the linearized quasilinear model (A.10) around the steady-state (see [52]) is described by\n^dtU(x, t) + F(u*)(x, t) + S(u*)6u(x, t) = 0,\n(3.17)\nwhere\nJu = [ Ju1 5v2 8v3 ]T ,\nu* = [ V* V* v* ]T ,\nS(u*) 4 [ dS(u*) d(u*) dS(u*) ] .\nLet ql = (1 \u2014 U;h\u20192. Then, the linearized boundary condition (A.6) results in the following expression:\nPI6vi(0, t) + (1 \u2014 U*)\u00a3v2(0, t) \u2014 u2\u00a3^(0, t) = 0.\t(3.18)\nSimilarly, consider qg = u3u2. Then, the linearized boundary condition (A.7) is given by\nv*8v2(0, t)+ v*8v3(0,t) =0.\t(3.19)\nFinally, the linearized boundary condition (A.8) is expressed as\n8v2(L, t) = Kuf 8v1(L, t) + Ku38v3(L, t) + Ku8u(t),\t(3.20)\nwhere bu(t) = u(t) \u2014 u*, being u* the choke opening steady-state value, and\nKu3\nKV1\n(pLRT \u2014 u*)u2\n2(pLRTv3 + (1 \u2014 u3)u*) \u2019\nrLu Wl//cy \u25a0 i u3p-wL///ty________u2\n2(pLRTv3 + (1 \u2014 u3 )u *)\tpLv *(u *\nPsY\nKu\n= Cout\n_______PLu*______\nPlRTv^ + (1 \u2014 ui )u *\n(u*\nPs)-\n>\n3.3.2\tModel in terms of characteristic coordinates\nIn this section, we transform the system (3.17) into the so-called characteristic form by using the characteristic coordinates [52].\nTo this aim, let us consider the following change of coordinates:\n\u00a31 (x , t) =\tJu2(x ,\tt) +\tadu3(x ,\tt) +\tbbu 1 (x ,\tt),\t(3.21)\n\u00a32(x , t) =\tJu2(x ,\tt) +\taJu3(x ,\tt) \u2014\tbbu i(x ,\tt),\t(3.22)\n\u00a33(x, t) =\tJu3(x,\tt),\t(3.23)\nwhere\nRTpiV2 \u2014 MuiV2 ( 1\u2014U3)Mui+RTpiU3 i\nb __ p Aui VM3 RTV3 \u2014 MRTV3V2\n=\tMui(( 1\u2014U3)MuiRTpiU3) '\nWith these new coordinates, the system (3.17) is rewritten in the following form:\nd\u00a3\td\u00a3\n-^1 (x, t) + A(x, t) + S\u00a3(x, t)=0,\t(3.24)\nwith\n\u00a3 = [ \u00a31 (x, t) \u00a32(x, t) \u00a33(x, t) ]T ,\nand A is the matrix with the transport speeds, given by\nwith\nA=\nA 1\t0\t0\n0 \u2014|A2|\t0\n00\ta3\n(3.25)\n(( 1\u2014U3) AMv 2 + ART P1V3V 1) VMARTvI, AM2 RTP1V3V 1\nI u2( 1\u2014 u3)\t1\n'\tApi\t+\nRU3U2\nAMui ,\nA\t((1\u2014u3)AMu]i+ARTpiu3ui) VM 3RTu3\nA2 =\tAM 2RTpiV3U i\nU2(1\u2014U3)\nApi\nI RU3U2\n1 AMui ,\nA3 = \u2014U2\n(1\u2014U3)Mu i +RTpiU3 AMpiu i\nA 1 =\nthese expression satisfy the following inequalities:\nVx \u20ac [0, L],\tX2 &lt;0 &lt;A3 &lt;Ax.\nThe expression for S is complicated to be written in details. Then, to save space, we express its structure as\n\t0-1,1\t01,2\t&amp;1,3\nS =\t02,1\t^2,2\t&amp;2,3\n\t0\t0\t0\n(3.26)\nNote that the last line of S is filled with 0. This occurs because the state variable u3(x, t) is a Riemann invariant [53]. This structure is also preserved by the transformation shown in this section.\nSeveral numerical tests performed for the system considered in this work (see Table A.1 for details about the system geometry) have shown that the following inequalities hold:\n&amp;1,3 = ^2,3 &lt;0 &lt;CT1,1 = ^2,1 &lt;&amp;1,2 = ^2,2\nTypical values are ct1,3 = a2,3 \u00ab -425, a1,2 = a2,2 \u00ab 15224, and ^1,1 = ^2,1 ~ 0.4.\nFinally, the boundary conditions (3.18)-(3.20), in characteristic coordinates, are expressed as\n\u00a31(0, t) -&lt;2(0,t)=0,\t(3.27)\n^2(L, t)\t+ k1\u00a31(L,\tt) +\tk2\u00a32(0,\tt)\t+ k3\u00a33(L\tt)\t=\t0,\t(3.28)\n\u00a33(0, t) - .,P (0, t) = 0,\t(3.29)\nor in matrix form\n\u00a31(0, t)\n&amp;(L, t)\n\u00a33(0, t)\n0\t\t0\t\u2019 \u00a31 (L, 0) \u25a0\n-k1\t-k2\t-k3\t\u00a32(0, t)\n0\tA\t0\t\u00a33.L-, t)\nK\n(3.30)\n7\nwhere\nA\nPIU3\nPIau3 \u2014 2u.,u2 \u2014 PIbu^ \u2019\nu, + 2bu2\nu3 \u2014 2bu2,\nand fej, i = 1,3 are constant design parameters that have to be tuned to guarantee the stability of the linear system (3.17), as will be shown in the next section.\nThe change of coordinates (3.21)-(3.23) is inverted as follows:\n\u00a3i(x, t) + &amp;(x,t) - 2a^(x, t)\n\u00bfu1(x, t) = --------------2---------------\nx\t\u00a31(x, t) -\ndv?(x, t) = ------------------,\n\u00bf\u00ab3(x, t) = &amp;(x, t).\n(3.31)\n(3.32)\n(3.33)\n3.3.3\tStability analysis\nUsing Theorem 3.1 and Theorem 3.2 the system stability under the boundary conditions (3.30) may be expressed as the following two conditions:\n1.\n0\n0\nyAipi\nI A3 |p3\n0\n0\n\n\n\n^A2P2\nI A3 |p3\n(3.34)\n&lt;1\n2.\nk1|A3|p3\nAipi\nMA3IP3\nA2P2\nk3\n(Mi + 2aii)pie-^x ^2'p2'+ ffi2Pie-MX ai3Pie-MX\nCT2iP2eMX + ^i2Pie-^x\n(^|A2I + 2^22 P2'\"' ^23p2'\nQ\n^i3Pie-^x \\\n^23P2eMX\tI\nM3P3e-MX /\n(3.35)\nis positive definite.\nNote that condition (i) is satisfied if and only if\n^AmaxAKA T(AKA)) &lt;1,\nwhere Amax(-) denotes the maximum eigenvalue of its argument.\nA sufficient condition for Q to be positive definite is that its principal\nminors be strictly positive. This fact results in the following inequalities:\npAi + 2'ii > 0,\t(3.36)\np|A2| + 2'22 > 0,\t(3.37)\n(pAi + 2aii)(p|A21 + 2.'>22)piP2 - ^2'p2'\t+ 'i2Pie-MX)2 > 0, (3.38)\npX3p3e-^x [(pAi + 2'11 )(p|A21 + 2'22)piP2 - ('21P2'\t+ 'i2PieMX)2] -\n'23P2eMX [(pAi + 2'11)'23P1P2 - '>2'/'2'/;' + '12Pie-MX)'13Pie-MX + ' 2;p-'\t[('2iP2eMX + 'i2Pie-MX)'23P2eMX-\n(p| A2 | + 2'22)'13P1P2] > 0,\t(3.39)\nConditions (3.36)-(3.37) are satisfied for any p > 0. Condition (3.38) is satisfied for sufficiently small p > 0 if the parameters p1,p2 are selected such that '12p1 = '21p2, as shown in [52]. Indeed, the term ('21p2e-MX + '12p1eMX)2 is maximum either at x = 0 or at x = L. For x = 0, we have\n(pAi + 2'ii)(p|A21 + 2'22)piP2 - ('21P2 + ' 12P1 )2\n=\tP1P2\t(p2Ai|A2|)\t+ 2p ('22Ai\t+ 'ii|A2|)\t- ('22P2\t- '12P1)2\n=\tP1P2\t(p2Ai |A21)\t+ 2p ('22A1\t+ '111A21)\t> 0,\nfor any p > 0. On the other hand, for x = L we have\n(pAi + 2'ii)(p|A2 | + 2'22)piP2 - ('2iP2eML + '32P3e(ML)2\n= P1P2 (p2 Ai |A2 |) + 2p ('22 Ai + '11 |A2 |) -\n('22P2eML - 'i2Pie-ML^ > 0,\nfor p > 0 sufficiently small because the function\nF(p) 4 ('np2e-ML - '22P3eML)2\nis exponential in p.\nFinally, inequality (3.39) is satisfied for a sufficiently large p3. It follows that there exists a > 0 such that\ndV\nV2&lt;\t-aV\t=^\t\u2014 = Vi\t+ V2\t<\t-aV\tv&lt;=\t0.\t(3.40)\ndt\nHence, V is a Lyapunov function along the solutions of the linearized slugging model and its solutions exponentially converge to 0 in L2([0, L]; R3)-\nRemark 3.1. The Lyapunov function used in this section to show the stability of the linear system cannot be used to analyze the local stability of the nonlinear case. To this aim, an augmented Lyapunov function must be used, to prove convergence in H2-norm. This proof is much more complicated than the linear case shown in this section. More detail about the nonlinear case are given in [7, 52].\n3.3.4\tDesign of the control law\nIn the previous section, we have seen that the system stability is guaranteed if the feedback control law (3.28) holds. Therefore, in this section we shall present how the explicit expression of the control law can be obtained using the boundary condition (3.20).\nWe introduce the following notations:\n<ML) = ML, t),\n\u00bf\u00ab2(P) \u00bfu2(L, t),\n\u00bf\u00abs(L) \u00bfvs(L, t),\n\u00bf\u00ab1(0) = \u00bf\u00ab1(0, t),\n\u00bf\u00ab2(0) = \u00bf\u00ab2(0, t), \u00bf\u00ab3(0) = \u00bf\u00ab3(0, t).\nUsing the definition of the characteristic coordinates (3.21)-(3.23) the boundary condition (3.28) is rewritten as\n\u00bf\u00ab3(L)(a+feia+fe3) \u2014 \u00bf\u00abi(feib \u2014\u00bf^\u00bf\u00ab3(L)(1 + fei)+fe2 (\u00bf\u00ab2(0)+a^\u00ab3(0)-\n^\u00bfv1 (0)) = 0. (3.41)\nThen, by eliminating \u00bfu3(L) between (3.20) and (3.41), and eliminating \u00bfu2(0) and \u00bfu3(0) between (3.18), (3.19) and (3.41), we get the following expression for the control law\nu(t) = u* + KPu2 \u00bf\u00ab2 (L) + /w . \u00bf\u00ab1 (L) + Kpo \u00bf\u00ab1 (0),\n(3.42)\nwhere\nKp.\nKp.\nKpo\n\u00a33 + Ku3 + a + k1 a + k1Ku3\nKz (a + k1a + k3)\t\u2019\nKz (a+kia+M ^k1b \u2014 b \u2014 ~K]~ (a + k1a + ^3)) , Ku3 k2 (PI(a\u00ab3/\u00ab2 \u2014 1) \u2014 b)\nKz (a + k1a + k3)\t'\n2\n1\nIt must be noted that the feedback control law (3.42) needs measurements of pressure at the outlet valve, the bottom pressure and total flow-rate\nTime (h)\nFigure 3.1: Bottom and top pressure, and choke opening with the proposed control law. At t = 3.3 h the control was switched on and at t = 15 h the control was again switched off.\nmeasurement through the outlet valve. For the simulations results shown in Section 3.3.5, we consider that all these variables are being measured. In some real cases this is not true. Therefore, the use of a state observer together with the control law is probably the best option in these cases.\n3.3.5 Simulation results\nThis section shows the simulation results obtained when using the proposed controller to stabilize the quasilinear model (A.10). We consider a 2500 meter long vertical well with reservoir pressure Pr = 180 bar and separator pressure Ps = 10 bar. Table A.1 gives a list of the parameters used for the computations. The space was divided in N sections and the space derivatives were written using a finite difference scheme. An ODE solver was used to obtain the solution.\nIn Fig. 3.1 the results obtained with the control technique proposed in this thesis are shown. The operating point was chosen to be Z* = 48%. The steady-state values of u* (0), u* (L) and u* (L), necessary for the control\nlaw, can be obtained by computing the steady-state model (A.10) in such operating point. The controller gains were chosen to be ki = -0.5, k2 = 2.3 and = 300. These parameters were found after several simulations in order to improve the control system performance. At t = 3.3 h the control was switched on. It can be noted that the oscillations are suppressed and the system remains in the desired operating point. At t = 15 h the control was switched off and as expected, the system comes back to the oscillatory regime.\n3.4\tConclusions\nIn this chapter we studied the boundary stabilization problem in linear hyperbolic PDE systems by using dissipative boundary conditions. We have shown, by means of a Lyapunov function, that under certain considerations in boundary conditions, the solution of the system decays exponentially to the origin in the L2-norm. These results were applied to the slug control problem in oil facilities. Although the theoretical results guarantee stability only for the linearized system, simulations have shown relatively promising results when the control law is applied to the nonlinear system.\nChapter 4\nBoundary control of a Rijke tube using irrational transfer functions\nThis chapter is concerned with boundary stabilization of thermoacoustic oscillations in the Rijke tube. To study this problem we consider that the mathematical model takes the form of two interconnected compartments. Each compartment is described by the linearized Euler equations of gas dynamics and the interaction between these compartments is given by the heater model. The control input is applied on the left boundary condition of the cold zone (see Appendix B). From this model we derive an irrational transfer function to design a stabilizing boundary control in the frequency domain. In particular, we derive necessary and sufficient conditions for the input-output stability through the use of Nyquist-type test. Experimental results show the effectiveness and real-life applicability of the method. The chapter is organized as follows. Section 4.1 presents the characterization of the transfer function. The closed loop system and its stability is studied in Section 4.2. The experimental results are shown in Section 4.3. Finally, the main conclusions are presented in Section 4.4.\n4.1\tOpen-loop transfer function of the Rijke tube\nIn the following, we will compute a transfer function G(s) from the speaker to the microphone pressure based on model (B.2)-(B.7). To derive this transfer function, note that equations (B.2)-(B.3) represent the wave equation. To see that, take both a time and space derivative in (B.3) and subtract\nthe resulting expressions. One obtains\ndttF>i(t, xi) = c'd,,/' t, xi),\ti = 1, 2\t(4.1)\nwhere c = y Ypp is the speed of sound.\nIt is well known that the solution of (4.1) is given by the D\u2019Alambert formula [54]. Therefore, the acoustic pressure in the upstream propagates according to\nPi(t,x) = f (t \u2014 C) + g (t + D , \u2014x\u201e&lt;x&lt;0,\t(4.2)\nand similarly to the downstream side\nP2(t,x) = h (t \u2014 C) + j (t + C) , 0 &lt;x &lt;xd,\t(4.3)\nwhere f, g, h, j are arbitrary function (not stated and unimportant for the following developments) which satisfy the boundary and initial conditions.\nUsing (4.2)-(4.3) and (B.2), we obtain the velocity fluctuations at the upstream and downstream part of the tube:\nvi(t, x) =\tpc\tf\t(t \u2014 D \u2014 g (t + 0) ,\t\u2014x\u201e&lt;x&lt;0,\t(4.4)\nV2(t, x)=\tPc\t(h\t(t \u2014 C) \u2014 j (t + x)) ,\t0 > x > xd.\t(4.5)\nConsidering x = 0 and substituting (4.2)-(4.5) into (B.4)-(B.5), and applying the Laplace transform into these equations, we obtain\nX (\u2022**.\u2019) ) = Y ( J w )+ Z*\u2019>,\t46\nwhere G, \u2014, F and J are the Laplace transform of g, h, f and j, respectively, and\n\u20141\nX(s\u2019 =\n1\thv\nTS + 1 \u2019\nyPA\n(4.7)\n(4.8)\n(4.9)\nFrom the boundary conditions (B.7), we obtain that f (t) = \u2014 g (t \u2014 2y2) + u(t \u2014 Xr) and j(t) = \u2014 h (t \u2014 2yr). These reflections at tube ends are modeled for ideal condition. A more realistic model should include acoustic reflection losses at the boundary. Therefore, we introduce the constants Ru, Rd G ( \u20141, 0) to account for acoustic reflection losses. It follows that these boundary conditions are rewritten to\nf (t) = R\u201eg (t \u2014 r\u201e) + u(t \u2014 y) ,\t(4.10)\nj(t) = Rdh (t \u2014 Td),\t(4.11)\nwhere tu = 2 \u2014 and Td = 2\t.\nTaking the Laplace transform of (4.10)-(4.11) and substituting them into (4.6) we finally obtain\n\u2014 1 \u2014 R\u201ee-T\u201cs (1-R\"ye U } (1 + Y^(s))\n1 + Rde-Trs\n1-Rde-Tds\nY\ne 2s\nY\ne 2 s\n(4.12)\nwhere U is the Laplace transform of u.\nNotice that from (4.12) we obtain\nH (s)\nU (s)\n2e- 2s Y det(S)\n(1 + 7^(s))\n(4.13)\nwhere\n\u2014 1 \u2014 R\u201ee-T\u201cs (1-R2e U } (1 + 7^(s))\n1 + Rde-Tds\n1-Rde-Tds\nY\nThe open-loop transfer function required, G(s), is from the speaker to the microphone pressure Pmic. This can be obtained from (4.13) and by expressing Pmic in terms of the acoustic waves using (4.3):\nG(s) =\nPmic ( s )\nU (s)\n_( )s r .\n2e (\tc\t)s\t2 \u2019 m,c \u2019d\\ s\n(1 + Rde I c ) )(1 + 7^(s)),\nY det(S)\n\n16000\n14000\n\u2014 12000 N\n-\"10000 -\nw\n3 8000 -\n>>\n| 6000\nCD\n4000\n2000\n0\n-6\n131 Hz\nx\n-4\t-2\t0\t2\t4\nReal axis (Hz)\nFigure 4.1: Location of the poles of the open-loop transfer function (4.14). They were calculated numerically by finding roots of (4.15). Note that there is an unstable pole at 131 Hz on the imaginary axis, and infinite stable poles that tend asymptotically towards (4.16).\n4.1.1\tPoles and zeros of the open-loop system\nThe poles of G(s) characterize the open-loop dynamic behavior of the linearized system. They are given by the solutions of the following equation:\nV>(s)\t7PA(rs + 1)(1 - Rde-Tus)(1 - Rde-Tds)-\n(1 - R\u201ee-Tus)(7PA(rs + 1) + 7h^)(1 + Rde-TdS) = 0. (4.15)\nIn general, this equation has no explicit solution. Numerical resolution for the values in Table B.1 leads to the poles depicted in Figure 4.1. As can be seen, there is a pair of unstable complex conjugated poles at the frequency 131 Hz on the imaginary axis, which corresponds to the frequency of oscillation, and infinite poles on the left hand side of the complex plane. The following proposition provides a closed solution of (4.15) to explain the poles behavior for high frequency:\nProposition 4.1. When |s|\t0, the solutions of (4-15) tend asymptotically\ntowards\nlog(R\u201eRd)\t2jnk\nP\u00b1k =\t\u00b1\t,\t(4.16)\nTu + Td\tTu + Td\nwhere k e N, and the approximation error is at the first-order given by:\nP\u00b1k ~ P\u00b1k -\nfi(p\u00b1k ) fi'(p\u00b1k ) .\n(4.17)\nProof. Equation (4.16) follows directly from a high frequency analysis of (4.15).\nWriting the Taylor expansion of fi around p\u00b1k = p\u00b1k + p\u00b1k + o(p'\u00b1k) we get\nfi(p\u00b1k) = fi(p\u00b1k) + fi'(pk )p\u00b1k + o(p\u00b1k).\t(4.18)\nNote that fi(pk) = 0, and fi'(pk) = 0. Therefore, equation (4.18) leads to (4.17). This concludes the proof.\t\u25a1\nThe zeros of (4.14) are the values of s such that G(s) is zero. In this case, the zeros are given by\nz\u00b1k =\nlog ( Rd)\tjkn\n2 xmic xd\txmic xd ,\n(4.19)\nwhere k e N.\nAs can be seen in (4.19), the zeros have real negative part and therefore are in the left-hand side of complex plane. Furthermore, it can be seen from this equation that the microphone location only affect the zeros of the system. The poles remain unchanged independent of the microphone position.\n4.2\tClosed-loop system\n4.2.1\tProposed control law\nAs shown in Equation (B.8), the thermoacoustic oscillation in the Rijke tube occurs when acoustic energy is greater than the loss. The gain and loss of energy depend on the acoustic field. However, conditions can change completely if the field in the tube is disturbed by a different sound source, which in this work is produced by a loudspeaker. The inclusion of a sound source changes the difference between energy gain and loss, which can become larger or smaller than the unperturbed acoustic field.\nTherefore, it is reasonable to consider the control law given by\nwhere Kc and tc are design parameters. Note that with this control law the loudspeaker reproduces an amplified and delayed pressure wave of the tube.\n4.2.2\tStability analysis\nIn this work, the following definition of stability is adopted.\nDefinition 4.1. If a system maps every input u G L2([0, to); C) to an output y G L2([0, to); C) and\nlly|L2([0, to)) sup ij-jj--------- &lt;to,\nu=o IIuIIl2([0, to))\nthe system is stable. A system is said to be unstable if it is not stable.\nRemark 4.1. Stability of systems described by their transfer functions can be checked by Theorem A.2 of [55]. In this case, a linear system is stable if and only if its transfer function G belongs to H00 (C+; C).\nWith control law (4.20), the closed-loop transfer function is given by\nG-(\u2018> = 1 - GSU \u25a0\t(4;21>\nwhere C(s) = Kce-TcS.\nFor the stability result we will use the following necessary and sufficient condition [56].\nTheorem 4.1. The closed-loop system is stable if and only if\n1.\tinf\t|1 - C(s)G(s)| > 0\nRe(s)>o\n2.\tC(pi) = 0, i = 1, .. ., no, where pi are the poles of G in C+.\nCondition 1 of Theorem 4.1 can be checked through the graphic Nyquist criterium. In our case, the open-loop is non stricly proper, and the application of the graphic Nyquist criterium is more delicate [56]. Condition 2 of the previous theorem corresponds to a condition preventing an instability due to the cancellation of an unstable pole of G by a zero of C.\nSince the proposed control law (4.20) is not strictly proper, we have to take into account the behavior of the Nyquist plot at infinity. We propose below a way to circumvent this problem by analyzing the closed-loop poles for high frequencies. First, we state a technical result that will be used in the stability analysis.\nLemma 4.1. Consider the neutral delay equation\nM\n1 - \u00a3 aie-riS =0,\ni=1\n(4.22)\nwith the components r = (ri, r^, ..., ru) rationally independent1 * *.\nThe solutions of (4.22) lie in the left of complex plane if and only if\nM\nE N &lt;I-\t(4.23)\ni=1\nProof. See Theorem 2.2 and Corollary 2.4 of [57].\n\u25a1\nConsider that the system fulfills the following assumption\nAssumption 4.1. The set\nr = {xu + xd,\nCTc + Xd + x\nmic,\nCTc + 3xd \u2014 x\nmic\n},\nis rationally independent.\nThen, we have the following result:\nProposition 4.2. Let tc, xmic > 0 such that\nr\t(xu + xd- cTd + xd + xmic, cTc + 3xd\txmic) ,\nis rationally independent. Then, the following inequality is a necessary condition of closed-loop stability:\n|Kc|(1 + |Rd|) &lt;1 \u2014 RdRu\t(4.24)\nProof. For |s|\t0, the closed-loop poles can be approximated as the\nsolution of\n1 \u2014 RuRde-(Tu +Td)s \u2014 Kce\n(\n\n)\ns\n\n\u2014 KcRde\n^CTc +3xd-xmi^ s\n= 0.\n(4.25)\n\nThen, choosing tc, xmic > 0 such that\nr = (Xu + Xd, CTd + Xd + Xmic,\nCTc + 3Xd \u2014 X\nmic\n),\nis rationally independent we can apply Lemma 4.1 to obtain the inequality (4.24). This concludes the proof.\t\u25a1\n1We say that the real numbers ai, an are rationally independent if the only\nn-tuple of integers ki, ..., kn such that kiai + \u2022\u2022\u2022 + knan = 0 is the trivial solution in\nwhich every ki, i = 1, ...,n is zero.\nUsing this result we can restrict the test of the Nyquist criterion to a finite range of frequencies, as stated in the corollary bellow.\nCorollary 4.1. If Proposition f.2 is verified, then there exists so > 0 such that condition 1 of Theorem f.1 needs only be tested on a finite range |s| &lt;so.\nProof. For sake of simplification in the following computations, define G(s) as the approximated transfer-function of (4.14) for |s|\t0.\nNote that if Proposition 4.2 holds, then there exists \u00a3 > 0 such that\n|1 - C(s)G(s)| >\u00a3.\nMoreover, for |s| > s0 we have that\n||C(s)G(s)|-|C(s)G(s)||&lt;\u00a3.\nIt follows that,\n|1 - C(s)G(s)| > ||1 - C(s)G(s)| - |C(s)G(s) - C(s)G(s)|| > 0.\nTherefore, there exists s0 such that |1 - C(s)G(s)| > 0 when condition\n\u25a1\n(4.24) is satisfied.\nThe Nyquist stability criterion which accommodates infinite dimensional system is stated in the next theorem [3].\nTheorem 4.2. Let g be a function which is meromorphic on an open set containing C+ and suppose that g has no poles or zeros on the imaginary axis. Furthermore, assume that g has a non-zero limit at to in C+, i.e., there exists a g(TO) G C, g(TO) = 0 such that\nlim sup\t|g(s) - g(TO)| = 0.\nP -\t,,\t,\nsec+,||s||>p\nThen g has at most finitely many poles and zeros in C+ and\n2nj J-- gj-\t2n\t-\nwhere No and Po are the number of zeros and poles of g, respectively, in C+. Furthermore, No - Po equals the number of times that g(jo), known as the Nyquist contour, winds the origin as o decreases from +to to -to.\nIn the next proposition we show the conditions that the Nyquist contour must obey in this finite range of frequencies in order to guarantee the stability of the closed-loop system.\nProposition 4.3. Let nu be the number of open-loop poles of (4.14) in C+. Denote the Nyquist contour of\n^(s) 1 +\n2Ke (\tc\t)s\t2xmic-x^s\n(1+ Rde 2 c ' )x\n\n(Y \u2014 1)det(S)\n(1+ YXs))\t(4.26)\nby r^(s). Then the transfer function Gci is\n1. Unstable if r^(s) does not encircles the origin nu times in the clockwise direction.\n2. Stable if r^(s) encircles the origin nu times in the clockwise direction.\nIn the limiting case that r^(s) does not encircle but crosses \u20141, the stability is undetermined.\nProof. First we have to show that ^(s) is meromorphic in C in order to apply Theorem 4.2. Note that the exponential function is an entire function and it is well-known that the composition of entire functions also results in an entire function. Thus is expressed as the ratio of entire functions, meaning that it is meromorphic. Further,\nlim\nsup\t|^(s)|\n_{s\u00a3C+ | |s| >m}\n= 0.\nNext we show that ^(s) has finitely many poles in C+. Note by (4.26) that the poles of are the same as the open-loop system. Therefore, by Proposition 4.1, we now that the poles are asymptotic to (4.16), which clearly have negative real part. Assume that the open-loop system is unstable (if the open-loop system is stable than there is nothing to do because there are not poles in C+), then there exist poles in C+. We have to show that there are finite poles in C+, say p\u00b11, ..., p\u00b1n0. Indeed, since the open-loop poles are asymptotic to (4.16), then there exists n0 6 N such that Vn > no Re(p\u00b1n) &lt;0. Therefore, there are p\u00b11, ..., p\u00b1n0 poles, with n0 6 N, in C+. Define nu = 2n0. Then, nu is the counterclockwise number that the Nyquist contour of encircles the origin. Likewise, the number of zeros of - that is, the closed-loop system poles - in C+ is the number of times the Nyquist contour of encircles the origin in the clockwise\nReal axis\nFigure 4.2: Nyquist plot of r^(s) showing two clockwise encirclements of the origin as w decreases from I to to \u2014to.\ndirection. This means that Gcl G HTO(C+; C) if r^(s) encircles the origin nu times in the clockwise direction and Gcl / HTO(C+; C) if r^(s) does not encircles the origin nu times in clockwise direction, making it a stable or unstable transfer function according to Theorem 4.2.\t\u25a1\nIn sum, the necessary and sufficient conditions developed in this section can be checked by the algebraic equation (4.24) and by choosing tc and xmic such that Assumption 4.1 and the Nyquist criterion are satisfied.\n4.3\tResults\nIn this section, we present results of real experiments in the Rijke tube configuration described in Section B.1 with control law (4.20).\nWe choose Kc = 0.002 in order to satisfy inequality (4.24), and tc was designed in order to r^(s) encircles the origin twice in the clockwise direction since, as shown in Figure B.3(a), the system has a pair of complex conjugated poles in C+. The Nyquist plot of r^(s) for tc = 0.001 is depicted in Figure 4.2. There are two clockwise encirclements of the origin as w decreases from +to to \u2014to. Thus, the closed-loop system must be stable and should be reasonably robust to plant's uncertainties and changes.\nUnfortunately, the value of tc must be chosen by trial and error, since we have not developed analytical conditions for this control parameter.\nFigure 4.3 shows the sound pressure at the microphone location and the control signal with the control law (4.20). At the beginning of the experiment, no controller is active, and the system is in the limit cycle. At t = 3.5 s the controller is actived. It can be noted that the oscillations are suppressed and the system remains in the operating point. At t = 12 s the control is deactivated and as expected, the system comes back to the oscillatory regime.\nFigure 4.3: Pressure fluctuations at the microphone location and control signal as a function of time. At t = 3.5 s the controller is actived. At t = 12 s the control is deactivated.\n4.4\tConclusions\nWe have addressed the issue of boundary stabilization of thermoacoustic oscillations of the Rijke tube by a frequency domain approach. We have used some properties of the system transfer function to derive necessary and sufficient conditions for input-output stability of the boundary controlled system. Experimental results for a Rijke tube prototype shows the effectiveness of the proposed approach.\nChapter 5\nIn domain control of quasi-linear hyperbolic systems\nIn this chapter we are concerned with tracking and disturbance rejection problem in 1-D quasilinear hyperbolic systems, where the control variable is modeled in the domain of the PDE system. The control methodology is based on the sliding mode control strategy together with the method of characteristics. This proposal allows us to characterize the sliding regimes and their fundamental properties by a geometric approach. A basic material about the main concepts of this methodology is presented in Section 5.2. An approach to apply this control methodology in systems with relative degree one is shown in Section 5.2.1. Also in that section, a smooth control law is developed based on the concept of equivalent control, and experimental tests on a solar collector field are presented to show the effectiveness of the approach. In Section 5.2.2, we present this control methodology for systems with relative degree two. In the end of this section, we apply the obtained results to the pH control problem of a tubular photobioreactor. Concluding remarks are discussed in Section 5.3.\n5.1 Definitions and notations\nWe are interested in the following 1-D n x n quasilinear hyperbolic systems:\n(x,t) + A(u(t))H(x,t) = f\u00ab(x, t)),\nwhere t e [0, to) is the time variable, x e [0, L] is the space variable, \u00a3 : [0, to) x [0, L] Rn is the vector of state variables, A : R Mn,n(R) and f : Rn Rn. The control variable is u : [0, to) R and the controlled variable is denoted by y : Rn R. We assume that the system relative degree1 is at maximum two, i.e., the controlled variable must be differentiated at most twice to obtain an explicit relation with the control variable. Moreover, we assume that A is a diagonal matrix:\nA = diag{Ax, A2, ..., An},\nand A1 = u(t).\nThe initial condition of (5.1) is\ni x- 0) = ^(x^ x e [0,H\t(5.2)\nwhere \u00a30 e C 1([0, L]; Rn), and the boundary conditions are\n9i,0(\u00a3(t, 0)) = 0, t e [0, +to),\t(5.3)\n9i,L(\u00a3(t, L)) = 0, t e [0, +to),\t(5.4)\ni = 1...\nwhere gifi, gi,L : Y\tR.\nThe existence and uniqueness of the solution of (5.1)-(5.4) can be proved using the method of characteristics. Then, if \u00a30(x) is a continuously differentiable function of its arguments, one can show, using Theorem 2.2, that the solutions are continuously differentiable with respect to their arguments, i.e., \u00a3(x, t) e C1([0, L] x [0, +to);Rn). Moreover, since the i-th equation of system (5.1) is an ordinary differential equation along the i-th characteristic we can use the Caratheodory theorem for ordinary differential equation to guarantee existence and uniqueness of the solution even when u is discontinuous [58].\nIn terms of characteristic equations, system (5.1) is given by\nd^i\ndi (xi(x, t, s),Ti(x, t, s)) = fi(C(xi(x, t, s), Ti(x, t, s))), dx \u25a0\n-1 (xi(x,t, s),Ti(x,t, s)) = Ai(\u00a3(xi(x,t, s),u(Ti(x, t, s)))), ds\ndTi\n-A (xi(x,t, s), Ti(x,t, s)) = 1,\nds\n(i = 1 ..., n)\n(5.5)\n1A similar concept, called characteristic index, was introduced by Christofides and Daoutidis [15]. However, in this thesis, the term relative degree is preferred over characteristic index.\nor briefly\ndzi\ndt\nKi\u00ab(xi(x, t, s),Ti(x, t, s)), u(Ti(x, t, s)), Ti(x, t, s)),\n(5.6)\n(i = 1, ..., n), where\nKi\nfi (C(xi(x, t, s), Ti(x, t, s))) Ai\u00ab(xi(x,t, s),u(Ti(x, t, s)))) 1\nWe recall that Ki is the i-th characteristic vector field of (5.1).\n5.2\tDistributed sliding mode control for quasilinear hyperbolic systems\nSliding mode control is a classical nonlinear control methodology characterized by a commuted control action. The main idea of this methodology is to design a surface in such a way that the system has some desired performance. Once on the surface, the system trajectories are induced to the desired operating point, i.e., a pseudo-equilibrium of the commuted system. If this pseudo-equilibrium is stable, the system trajectories remain there. A Lyapunov-like stability condition guarantees that the distance to the surface decreases along all system trajectories and constrains the trajectories to point toward the surface. The basic elements of this control methodology for lumped parameter systems can be seen in [59]. In this section, an approach for 1-D quasilinear hyperbolic systems, called distributed sliding mode control (DSMC), is presented following the ideas of [21, 22, 24].\nThe following switching control law determines the control action of system (5.1)-(5.4):\ni\tw+(C(x,\tt),\tx,\tt)\tif\th(\u00a3(x,\tt), x,\tt)\t> 0\n1\tu-(\u00a3(x,\tt),\tx,\tt)\tif\th(\u00a3(x,\tt), x,\tt)\t&lt;0\n(5.7)\nwhere u+ > u- and h : Rn\tR is the switching boundary function.\nUnder the switching control law (5.7), the characteristic equations (5.6), for i = 1, have two characteristic curves generated by the characteristic vector field k u+ and Ky u-, respectively. It is referred to k u+, when u = u+ is the control input and similarly Ky u-, when u = u-. The other characteristic vector fields, k2, ... ,Kn, are not affected by changing the control u from u+ to u-. Therefore, the characteristic curves associated\nwith k2, ..., Kn are not defined for both values of the binary switching control law.\nDefinition 5.1. The condition h(\u00a3(x, t), x, t) = 0 defines an isolated smooth manifold \u00a3(x, t) = y>(x, t), called sliding surface, and is defined as\nS = {(\u00a3(x, t), x, t) G Rn+2 : g(x, t) = ^(x, t)}.\t(5.8)\nAt the points where S is a hypersurface, it is assumed that h is a smooth surface with locally nonzero gradient, except possibly on a set of zero measure.\nBasically, system (5.1)-(5.4) with control law (5.7) has three different behaviors at the sliding surface: (i) crossing; (ii) attractive sliding; and (iii) repulsive sliding. The main idea in sliding control systems is to perform the following:\n1.\tto define the desired operating point (a stable pseudo-equilibrium point) in such a way that it is in the attractive sliding region;\n2.\tto guarantee that the system trajectories reach the surface (in finite time) from a defined local set of initial conditions.\nIf these objectives are achieved, then, once the system trajectories are on this surface they slide toward the pseudo-equilibrium point and remain there. In the next sections we describe a methodology to induce attractive sliding regime for systems with relative degree one and two, respectively.\n5.2.1 The case of 1-D quasilinear hyperbolic systems with relative degree one\nIn this section, we will describe a methodology to induce attractive sliding regime for 1-D hyperbolic systems that fulfill the following assumption:\nAssumption 5.1. The system (5.1)-(5.f) has relative degree one, i.e., the output y must be differentiated (in time) once to obtain an explicit relation with the input u. Furthermore, we assume that h(\u00a3(x, t), x, t) = h(\u00a3i(x, t), x, t).\nDefinition 5.2. An attractive sliding regime for systems with relative degree one is said to locally exist on an open set Sas C S if the total derivative of h satisfies\ndh / /\t\\\t\\\ndt (^i(x, t), x, t) &lt;0, dh / /\t\\\t\\\ndt (^i(x, t), x, t) > 0,\nif h(\u00a3i(x, t), x, t) > 0,\nif h(\u00a3i(x, t), x, t) &lt;0.\n(5.9)\nNote that the total derivative of h along the characteristic lines can be computed by the Lie derivative of h with respect to the vector field k2:\ndh dh dh dh\nd = dTi+ deifi + dxiu = Lki-\u201c h\nwhere LK1 u h denotes the Lie derivative of h with respect to the vector field Ki for a given control input u.\nThe next theorem, extracted from [24], exposes a relation between the PDE system (5.1)-(5.4) characteristic equations (5.6) and the switching control law (5.7).\nTheorem 5.1. Suppose that system (5.1)-(5.f) satisfies Assumption 5.1. Then, an attractive sliding regime locally exists for system (5.1)-(,5.f) on an open set Sas C S, if and only if the phase flows corresponding to the controlled characteristic vector field exhibit a local sliding regime under the influence of some switching law (5.7).\nProof. Suppose an attractive sliding regime locally exists for (5.1)-(5.4) with control law (5.7), then the time derivative of h, evaluated on an open neighborhood of S satisfy (5.9). The total time derivative can be computed in terms of the directional derivative of h along the controlled characteristic direction field k2 u+ and k2 u-. The directional derivative is evaluated on points above and below the switching boundary function which lie in a small vicinity of the sliding surface. Then,\n\u2022 If h > 0:\ndh\ndt\ndh dh dh + dTi+ dei fi + dxiu\tL\nK1, u +\nh &lt;0.\n\u2022 If h &lt;0:\ndh dh dh dh dt dT1 + d\u00a3i 1 + dx1\nL\u00ab1, u- h > 0.\nHence the flows corresponding to the characteristic vector fields k2 u+ and Ki u- satisfy the conditions for the existence of an attractive sliding regime on an open set Sas C S.\nSufficiency follows by assuming an attractive sliding mode exists for the controlled characteristic system while hypothesizing that an attractive distributed sliding mode does not exist. By reversing the arguments presented above, a contradiction is easily established.\t\u25a1\nFrom now on, we can perform the analysis on the closed loop system using the characteristic equations.\nIn [60] it was shown, by a Lyapunov argument, that condition (5.9) guarantee reachability of the system trajectories to an open set Eas C E in finite time. Basically, to ensure that the system trajectories enter in the region of attractive sliding regime in finite time the time derivative of the Lyapunov function V = 1 h2dx must be such that dV/dt &lt;\u2014 p(VV)a, where p > 0 and 0 &lt;a &lt;1. Then, by the comparison principle for first-order differential inequalities [61] we obtain that 2vV &lt;V(0) \u2014 pt, Vt. Since -\\/V > 0, then -\\/V must reach VV = 0 in finite time, which means that V must reach V = 0 in finite time with upper bound V(0)/p.\nUnder attractive sliding condition, the system trajectories are constrained in h = 0. In this case it is also assumed that dh/dt = LK1,uh = 0. Let a solution to dh/dt = 0 exist. Then, we have the following definition:\nDefinition 5.3. For all states \u00a3 located on an open set of E, the unique control function, ueq, locally constraining the distributed trajectories on an open set Eas C E, is known as the equivalent control. The resulting dynamics, constrained to E, will be addressed as ideal sliding dynamics.\nThe flows generated by \u00a3 under the influence of ueq locally adopt an integral surface [24]. It follows that the gradient of h is orthogonal to the controlled characteristic vector field K1jMeq, i.e.,\ndh dh dh\nLh =\t+ deTf1 + dX1Ueq =\tK1\u2019\u201c- > =0-\n\u2022 ueq\nTo see that ueq is well defined, we will prove in the next theorem that the above equality locally defines ueq in a unique way. Moreover, it will be established that the equivalent control is necessarily locally intermediate among the extreme feedback control laws u+ and u -.\nTheorem 5.2. Suppose a sliding regime locally exists for system (5.1)-(5.f), with control law (5.7), on E. Then, there exists a unique smooth feedback control law u = ueq such that the characteristic direction field of (5.1) controlled by ueq locally adopts as an integral surface the graph of the function \u00a3(x, t) = p(x, t). Moreover, locally on E:\nu &lt;ueq &lt;u ',\nProof. The proof amounts to demonstrating the existence of a smooth equivalent control for the corresponding attractive sliding regime of the characteristic system. Indeed, since the local invariance of h = 0 necessarily\nrequires dh/dt = 0, one has LK1 u h = 0. On the other hand, the existence of a local attractive sliding regime on S implies, necessarily, that locally on S: dLKh/du = 0, i.e., LK1 uh = 0 has, according to the implicit function theorem, a unique solution u = ueq. Hence, if an attractive sliding regime exists, the equivalent control locally exists and is uniquely defined.\nSuppose now that an attractive sliding regime locally exists on S for the switching feedback control law (5.7). Then, locally on S, the following three relations hold:\nLK1 u+ h &lt;0\t(5.10)\nLk1 , ueq h =\t0,\t(5.11)\nLk1 u- h> 0.\t(5.12)\nSubtracting (5.11) from (5.10) and (5.12) from (5.11) we obtain\nLK1 u+ h\tLK,Ueq h &lt;0,\nLK1, ueq h\tLki u \u2014 h &lt;0.\nFrom the mean value theorem, there exists smooth functions u^ and u- such that\nLK,U+ h\tLK,Ueq h\n(Vh, Ki,u+ - Ki,ueq) = (u+ - ueq){yh,dniu+ /du) &lt;0,\nLK,Ueq h \u2014 LK,U- h\n(yh, K1,Ueq \u2014 K1,u-) = (ueq \u2014 u-)(Vh, 9k1u-/du) > 0,\nwhere u+ and u-, respectively, satisfy ueq &lt;u+ &lt;u+ and u- &lt;u- &lt;ueq, i.e., locally on S we have u- &lt;ueq &lt;u+.\t\u25a1\nRemark 5.1. The existence of u+ &lt;ueq &lt;u- is a necessary and sufficient condition for the existence of attractive sliding regimes.\nDevelopment of a smooth equivalent control law\nIt is well known that the switching control law (5.7) causes oscillations in the controlled variables and infinitely fast control actions are impossible to be applied in several systems with mechanical actuators. A possible solution to guarantee the reachability of the system to the sliding surface and, at the same time, to reduce the chattering problem is to design a continuous control law as\nwhere uN is the control action designed for the reaching phase during which the system trajectories starting off the sliding surface moves toward it, and ueq is the control component that acts when the system is on the attractive region of the sliding surface. In what follows, a methodology, based on a Lyapunov function, to obtain such control law is described.\nConsider the following Lyapunov function\nV =|^ (h(fii(x, t), x, t))2 dx.\nIf dV/dt is negative definite, then the system trajectories will decrease until they reach the sliding surface. Evaluating such operation results in\ndV\ndt\nh \u2014 dX dt\nh (LK1 h) dX.\nNote that if we take LK1 h = \u2014Ah, then dV/dt &lt;0, for any A > 0. In fact, the implicit function theorem guarantees that LK1 h + Ah = 0 can be solved for u, since d(LK1 h + Ah)/du = 0, in order to get dV/dt &lt;0. By the comparison principle for first-order differential inequalities, this implies that V(t) &lt;V(0)e-Ai. Therefore, the system's trajectories decrease towards the sliding surface as t to given any initial condition.\nThe explicit expression of (5.13), after some algebraic manipulations, is given by\ndhfi(i(.X, t)) + fi(\u00a31(X, t)) + Xh(^i(X, t)) XXtt\u00c1X t))\n(5.14)\nNote that (5.14) is valid if and only if dh/dx = 0. With this result, we have proved the following theorem:\nTheorem 5.3. Consider the system (5.1) with initial condition (5.2) and boundary conditions (5.4) and such that Assumption 5.1 is satisfied.. Then, the control law (5.14), with A> 0 enforces the system trajectories of (5.1)(5.4) to the sliding surface h = 0.\nApplication to the solar power plant control problem\nThe solar collector field used to test the control methodology is located at the CIESOL (Centro de Investigaci\u00f3n de la Energia Solar, in Spanish) building, a Solar Energy Research Center in the University of Almer\u00eda -Spain. A brief description of the process is given in Appendix C.\nThe control objective in a distributed collector field is to maintain the temperature of the field at a desired level. The reference value is set\naccording to the plant operation mode. The main disturbances are the inlet temperature variation, the ambient temperature and changes of the solar irradiance. The controlled variable is the mean outlet temperature of the collector loops and the control variable is the fluid velocity/flow by a pump. The flow range is 2 to 12 m3/h.\nSince the objective in solar thermal plants is to maintain the temperature at a desired reference value, we consider the following sliding surface:\n1 f *\nh = Tf (x,t) - Tfref (x,t) + \u2014\t(Tf (x,t) - Tfref (x, tf)dt = 0, (5.15)\nTi J0\nwhere the first term in the right hand side denotes the error between the measured temperature, Tf, and the set-point profile, Tf,ref. The second term corresponds to the integral of this error and T is the integral time constant, and (\u2022) is the mean value of its argument. We assume that the set-point profile is given by\nTf,ref (x, t) = Tin(t) + S(x)(T*ut(t) - Tin(t)),\t(5.16)\nwhere Tin(t) = Tf (0, t) is the inlet fluid temperature, T*ut(t) is the desired outlet temperature at Tf (L, t), and S(x) is a spatial dependent function, where \u00bf(0) = 0 and d(L) = 1, and when x G (0, L) this function must be designed in such a way that (5.16) behaves as the stationary solution of (C.2).\nRemark 5.2. It is important to emphasize that to achieve the reference error equal zero on the sliding surface (5.15), it is necessary and sufficient that the dynamics of the error is stable. This can be guaranteed by adequately choosing the parameter Tj,.\nFor this system we can not apply directly the switching control law (5.7). Therefore, we have to develop a continuous control law. In what follows we describe the development of such control law based on the approach described in Section 5.2.1.\nUsing the method of characteristics we obtain the following set of equations that generate the vector field np.\ndTf\n\u2014T(xi(x, t, s),Ti(x, t, s)) = ds\nDinh*\nPf Cf Af\n(Tm(xi(x, t, s),T1(x, t, s))-\nTf (xi(x, t, s),T1(x, t, s))),\ndxi \u2014(T\u00ed(x, t, ds\ns)) =\nu(ti(x, t, s))\nAf\nd,Ti ds\nwhere u = ql.\nConsider the rate of change of h over the solution of (5.17) given by the\nLie derivative:\nLK1 h(xi(x, t, s),Ti(x, t, s)) =\n(Tm(xi(x, t, s),Ti(x, t, s))-LPf Cf Af\nm&lt;<\t\\\t/\tdh .\t.\t.\t.\t..\tu(ti(x, t, s))\nTf (xi(x C s),Ti(X C\tC shTiGx C s)) +------------X\ndTf\tAf\ndh\tdh\n\u2014 (xi(x, t, s),Ti(x, t, s)) + \u2014(xi(x, t, s),Ti(x, t, s)),\t(5.18)\nSubstituting (5.15) and (5.18) in (5.14), the smooth equivalent control law is obtained\n, .\tAf\nu(t) = dTf,ref\ndx\nDinht (Tm(x, t) - Tf (x, t)) + (a + Ty) (Tf (x, t)\nA it\n-Tf,ref U t)) + T j (Tf (x -)\nf (x, -))d- ,\t(5.19)\nwhere the control parameters are Tj and A. To eliminate the necessity for the slope of the temperature set-point profile along the solar collector field, equation (5.19) is averaged with respect to space. This results in the following expression\nu(t) = T\tf~\\X=L Di nht(Tm(t) - Tf (t)( + fA +\nTf,ref lx=0 L\t\\\ni\u2018 t\n- T -\t- Tf,ref (a))da ,\nTi J 0\n(Tf (t)\tTf,ref (t)) +\n(5.20)\nRemark 5.3. In [62] it was shown that implementing a control law based on the average tracking error as (5.20) guarantee the point-wise convergence of the distributed tracking error T(x, t) - Tref (x, t).\nIn addition, the control law (5.20) contains an open-loop observer to estimate the collector plate temperature, since there is no measurement of such variable in the real plant. The observer is given by the real-time numerical integration of the model (C.1)-(C.2) to estimate the temperature of the fluid and collector plate, and use them in the control law (5.20). Moreover, we use the real measurement of the inlet temperature in boundary condition (C.3).\nThe control parameters were chosen to be A = 50 and Tj = 5.7 min. These values were chosen by simulating control law (5.20) in model (C.1)-(C.3) under real data disturbances and analyzing the controller response for set-point tracking and disturbance rejection.\nFigure 5.1 shows the experimental results with the DSMC controller in a clear day. At the beginning of the experiment the gas heater was operating on automatic mode by an on-off controller, causing the oscillations in the inlet temperature, as can be seen in the bottom graph of Figure 5.1. At about t = 11 h the gas heater coupled to the installation was set on manual mode to eliminate the oscillations in the inlet temperature. It is the reason of the oscillations in the control signal during this time period. Notice that, the solar irradiance is smooth along the experiment . As can be seen the output response shows a small overshoot of less than 1 oC and the settling time is of around 11 minutes for a set-point change of 3 oC. Although the solar irradiance is smooth, the inlet temperature changes inside a wide range, from 60 oC to 67 oC causing strong disturbances in the system. This fact produces that the volumetric flow rates during the test cover almost its whole range from 4 to 10 m3/h.\n12\n10\n8\n4\n2\n$\n59\n63\n61\nO\n\u00a3 n ro\n<D\nQ.\nE\n1\u00ae\n67\n65\nFigure 5.1: Experimental result of the solar power plant with DSMC controller in a clear day. Results of October 3rd, 2013.\nAnother experiment is shown in Figure 5.2 where the controller performance against solar irradiance disturbances can be appreciated. In this scenario, three different set-points were imposed. The inlet temperature has small changes along the test. The system response is smooth and a small overshoot of less than 1 OC can be seen. At around t = 12.70 h a small cloud leads to a fast decrease in the solar irradiance. The controller does not respond because the inlet temperature was increasing and it compensates the impact of the solar irradiance disturbance. After the disturbance it can be noted that the controller quickly reestablishes the set-point tracking.\nO\n<D\n\u25a1\n<D\nCL\nFigure 5.2: Experimental result of the solar power plant with DSMC controller in a cloudy day. Results of October 2nd, 2013.\n66\n64\n62\n5.2.2\tThe case of 1-D quasilinear hyperbolic systems with relative degree two\nIn this section we are going to develop an sliding mode control methodology for systems that fulfill the following assumption:\nAssumption 5.2. The system (5.1)-(5.f) has relative degree two, i.e., the output y must be differentiated (in time) twice to obtain an explicit relation with the input u. Furthermore, we assume that h(\u00a3(x, t)) = h(\u00a3*(x, t)).\nIt is easy to see that the attractive sliding condition (5.9) can not be applied in systems that satisfy the Assumption 5.2. Indeed, if the system relative degree is two, then dLK*h/du = 0. Consequently, the equivalent control function ueq does not exist and, according to Remark 5.1, attractive sliding regime can not be induced by the results of the previous section. To deal with this problem, a second-order sliding manifold is developed in this section in order to create a local sliding motion for system (5.1)-(5.4).\nDefinition 5.4. An attractive sliding regime for systems with relative degree two is said to locally exist on an open set Sas C S if the total derivative of h satisfies\ndt* (^*(x, t), x, t) &lt;0, d* h\ndt* (^*(x, t), x, t) > 0,\nif h(\u00a3*(x, t), x, t) > 0,\nif h(\u00a3*(x, t), x, t) &lt;0\n(5.21)\nThese attractive sliding conditions can be computed by the Lie derivative of LK2h with respect to the vector field Ki:\nd2h dt2\nd\td\td\ndT\" (Lk2 h) +\t(LK2\t+ dX\" (LK2\n(LK2 h),\nL\n, U\nwhere LK1, U(LK2 h) represents the Lie derivative of LK2 h with respect to the vector field Ki,u for a given control input u.\nTheorem 5.1 can be easily adapted for the case (5.21). This result is stated below.\nTheorem 5.4. Consider the system (5.1)-(5.f) such that Assumption 5.2 is satisfied. Then, an attractive sliding regime locally exists for system (5.1)(5.4) on an open set Sas C S, if and only if the phase flows corresponding to the controlled characteristic vector field exhibit a local sliding regime under the influence of the switching law (5.7).\nIn sum, the idea of this methodology is to induce the vector field K1, by means of the feedback switching controller (5.7), to the hypersurface LK2 h = 0, which is contained in h = 0. In this way, it becomes possible to indirectly induce the vector field k2 to h = 0, since the vector fields K1 and k2 are coupled. Furthermore, with a similar argument used in Section 5.2.1 we can show that the attractive sliding condition (5.21) guarantees the reachability of the systems trajectories into an open set Sas C S in finite time.\nNote that the invariance condition h = 0 implies that dh/dt = LK1 h = 0 and also d2h/dt2 = LK1,U(LK2 h) = 0. According to Definition 5.3, the control function u = ueq such that LK1,U(LK2 h) = 0 is called equivalent control. Furthermore, the gradient of LK1 h is orthogonal to the controlled vector field K2,Ueq:\nLK,Ueq\nd\td\td\n(LK1 h)\tdT (LK2 h) +\t(LK2 h)f1 + dx (LK2 h)u\n(VL\u00ab2 h, K1,Ueq )\t=0,\t(5.22)\nwhere K1,Ueq stands for the ideal sliding dynamics induced by the interactions of the two vector field K1 U- and K1 U+. Note that this orthogonality condition also implies that the gradient of h is orthogonal to the vector field k2.\nThe equivalent control is given by the solution of (5.22) for ueq, which is derived on the nominal system dynamics, and is effective only once the attractive sliding region is reached. Moreover, using the same argument of Theorem 5.2 we can show that ueq is well defined and locally intermediate among the extreme feedback control laws u+ and u -.\nDevelopment of a smooth equivalent control law\nIn this section we are concerned in developing a continuous control law of the form\nu \u2014 ueq + uN,\nin order to avoid the chattering problem. To do that, consider the following Lyapunov function\ndh 2\n(x z + Aih(6(x\tx j) j\ndx,\nwhere Ai > 0.\nThe time derivative of this Lyapunov function is\ndV\ndt\n/\u201e Q+Aih)(diQ+A,h))dx=\n[\t(LK2 h + A1h)(LKl u (LK2 h + A1h))dx.\t(5.23)\nJ0\nNotice that if (LK1 u(LK2h + A1h)) = \u2014A2(LK2h + A1h)), with A2 > 0, then equation (5.23) is negative definite. Since d(LK2 u (LK1 h + A1h)) + A2(LK1 h + A1h))/du = 0, the implicit function theorem guarantees the existence of u such that\n(Lk2 ,u (Lk1 h + A1h)) + A2 (LK1 h + A1h)) = 0.\t(5.24)\nThen, by the comparison principle for first-order differential equations we have that V(t) &lt;V(0)e-A2i, i.e., the system\u2019s trajectories decrease exponentially to the sliding surface given any initial condition. With this result we have the following theorem:\nTheorem 5.5. Consider the system (5.1) with initial condition (5.2) and boundary conditions (5.)) and such that Assumption 5.2 is satisfied. Then, the control law obtained as the solution of (5.2)), with A1, A2 > 0 enforces the system trajectories of (5.1)-(5.)) to the sliding surface h = 0.\nApplication to the tubular photobioreactor control problem\nThe tubular photobioreactor used in this thesis to test the automatic control strategy is located at the Palmerillas Experimental Station, property of CAJAMAR foundation (Almer\u00eda, Spain). A brief description of the system\nis given in Appendix D. The pH control problem in tubular photobioreactors deals with keeping the outlet pH of the external loop at a desired reference value in spite of disturbances. For this microalga specie, the optimal pH reference value is 8 [63].\nThe pH behavior in a microalgal culture is mainly influenced by two phenomena. On one hand, the intake of CO2 as nutrient causes the formation of carbonic acid, leading to a decrease in the pH of the culture. On the other hand, when the microalgae perform the photosynthesis they consume CO2 and generate O2, causing an increase in the pH. The provided CO2 is transferred to the culture medium as a function of mass transfer coefficient in the system. Remaining fractions of injected CO2 produce an oscillatory behavior in the measured pH, because of the continuous recirculation of the culture, until its total elimination.\nThe main system disturbances are the medium injected to perform the biomass harvesting, which introduces total inorganic carbon to the culture, and thus decreasing the pH value, and solar irradiance changes, caused by the solar cycle and presence of clouds, producing changes in the rate of photosynthesis and thus in the rise of pH. The control variable is the CO2 flow/velocity provided by a valve, located at the beginning of the loop (see Figure D.1), which flow range is 0 to 5 L/min. In this work, a control design based on controlling the total inorganic carbon is proposed. It must be stressed that this is not the only way to control this process. However, using the total inorganic carbon as controlled variable reduces the complexity of the calculus involved on the control law design if compared to using directly the pH variable for control design, due to the model equations.\nSince the total inorganic carbon, [CT], is the controlled variable and the gas velocity/flow, Vg, is the control variable, then the system's relative degree is two. Therefore, the approach developed in Section 5.2.2 will be used to solve this control problem. Moreover, the continuous control law must be used to avoid the chattering problem.\nUsing the method of characteristics in (D.5) we obtain the following set of equations that generate the vector field ki:\n[CT]( ( t )\t( t ))\tPC\u00b02 Cb\n\u2014\u2014(xi(x i, s),Ti(x, i, s)) = \u2014-------\nds\tMco2\n(xi(x, t, s),Ti(x, t, s)) = Vl,\nds\ndTi\nds\n+ Kiai\nCO2 ([CO2] - [CO2])\n(5.25)\nof equations that generates the vector field k2 :\ndy/s'' (x2(x, t, s),T2(x, t, s)) = -KiOijCO2([CO2*] - [CO2]) ^s2 ((T2(x,\ts)) = U\ndT2 ds\n(5.26)\nwhere u = Vg.\nThe sliding surface is chosen to be\nh([CT], x, t) = ([CT](x, t) - [Ct]re/(x, t))+\n([Ct](x, a) - [Ct]re/(x, a)) da,\n(5.27)\nwhere Ti is the time constant of the integral term, [CT]ref (x, t) is the total inorganic carbon reference profile and 0 is the mean value of its arguments. We consider that the reference profile [CT]ref (x, t) is calculated as\n[Ct]ref (x, t) = [Ct](0, t) + J(x)([Ct]re/(L, t) - [Ct](0,t)),\t(5.28)\nwhere J(x) = aebx is a spatial dependent function valid for x e [0, L], where a = 0.039 and b = -0.014. The [CT](0, t) value is obtained directly from the state observer (we will comment on the state observer in the following paragraphs). Equation (5.28) is used to compute the set-point profile in the DSMC control law. This expression was obtained by fitting the steady-state numerical solution of (D.5) over the photobioreactor operating point.\nThe control law is based on equation\n(Lk2j\u201e + A2)(Lk1 h + A1h) = 0\nwhich must be solved for u. It uses the two sets of characteristic vector fields to define the equivalent sliding dynamics. Evaluating such equation, it is obtained\nd2 h\td2 h\n(lk2>\u201e + a2)(lk1 h + Aih))(LK1 h + Aih) =\t^2 +\n,Tr d2h\tA\t(dh dh\\ A (dh T,dh\\ A A ,\n+ (Vi + u) dtdx\t+ A at+ udiJ + AIt+ V+ A1A2h =\t0,\nwhere Ai = |Ai and A2 = |A2. Substituting h into (5.29) yields\nd2[CT] , (\t, V) 92[Ct] ,\t' c\n+ (U + '\t+uVl\n'') + Ai\n)\n,\t( d[CT]\n+ u\\~dT -\n( d[C1T ]\nU\\ dx \u2019\n'V dx\ndx\n9[Ct [ref\ndx\n9[Ct ]\n________uV d2[CT[ref + 1 d[CT] dx2_____1\tdx2\tTi dt\nT + T ([CT] - [CT[ref ) +\nT i\ndt + T ([Ct ] - [Ct ]ref)\ndt\n+ A2\t[CT\nd[CT[ref\n1 f *\t1\n+tw\t([Ct] - [Ct[ref)dt = 0. (5.30)\nTiJ0\ndx\n+ A1A2 [CT] - [Ct[ref\nNotice that the three first terms in (5.30) can be expressed by the Lie derivative of [CT] with respect to the two characteristic fields, i.e.,\nLk2 (Lki [Ct]) =\nd2 [ct]\ndt2\n+ Vg Vl\nd2 [ct]\ndx2\n+ (Vg + Vl)\nd2 [ct] dtdx\nKiai,CO2\nd[CO2] + V d[CO2] dt\ts dx\n+\nVmol\n\u00a3\n(1 - \u00a3)Kiai,co2HCO2Pt([CO2]\n- [CO2])\tPco2 (vdCb + dCfa\t( - Ucoe '' dx + dt) . (5.31)\nSubstituting (5.31) in (5.30) the following control law is obtained\nu=\n+ A2\nKiai,co2 Hco2Pt\n(1 - \u00a3)Kiai,co2 ([CO2] - [CO2]) + fa\nPco2 Cb\n_ Mco2\n+ Kiai,co2 ([CO2] - [CO2]) - Vl\t'\n+ ^AiA2 + ~1 T\t([CT] - [CT ^ref) + AiA -\t-\n+^TT L ([Ct] - [Ct]ref}dt + t '- j I { lVd2[CT [ref\tK\td[CO2[\n+ Vl ----------Ka,co2 n---------Ai\ndx2\tdx\nTi dx\nd [ct ]\ndx\nPco2 dCb\nMco2 dx\n'\t' ]|, (5.32)\ndx\nwhere\nft\nft\nft\n-V+ ^MrC + KiOi,CO2([co;] - [CO2]), dx\tMco2\nft\nP2 - [CO2X1P3 \u2019\n-V\t+ P\u00b02C6Yp/x,\nKi\t, 2/\\K2\n[H+P + [H+]3 \u2019\nP2\n1 +\nKi , AM [H+] + [H+]2 \u2019\nP3\nKi + 2K1K2 [H+] + [H+ ]2\n1 ,\tKw\t, Ki[CO2] , 4 2K1K2 '\n1+ [H+ ]2 +\t[H+]2\t+4 [H+]3\nTo avoid the requirement of setting the slope of the total inorganic carbon profile set-point along the photobioreactor tube, equation (5.32) is averaged with respect to space. This results in the following final control law\nu \u2014 |Kiai,co2 Hco2Pt\n(1 - \u00a3)KiOi,co2 ([co;]-\n[CO2]) + (ft)] + ft\t'\nM\t+ Kiai,co2 ([co;] - [CO2])-\nMCO2\nVl [CT]ref |L] + ^ftft + '1 T '2\n' y 2\t([CT] - [CT]ref-\n2 Cbl0L + V dx\n([CT] - [CT]ref ) + ft (ft)\nd[Cj ]ref\nMcO\t+ Ti [Ct]l\u00b0 } /\nL\n- Ko,co2 [CO2]|L\n0\n-ft ([Ct] - [Ct]ref )lL} ,\t(5.33)\nIt is noteworthy that, for implementation purposes, the derivative terms of the control law (5.33) were discretized by a backward finite difference scheme. Moreover, the implementation of the control law (5.33) contains an state observer to estimate the total inorganic carbon and the other variables present in the control law that are not measured in the real plant.\nThis observer is given by (D.22) and (D.30). The initial condition of these equations were obtained from the real plant. Moreover, these equations were solved by the method of lines using a backward finite difference approximation. To ensure stability and to impose limits in the computational cost, the Courant-Friedricks-Lewy condition was used. Since this model was validated with real photobioreactor data with a discrepancy of around 1.2% between the values of the model states and the real system states [40, 64], no correction mechanism between the estimated state values and the real system states was used.\nIn addition to the DSMC controller, an outer feedback loop with integral action is used to calculate the total inorganic carbon concentration set-point required to maintain the system pH in its optimal value. The outer feedback loop is a PI controller with the following structure\n[CT]ref (L,t) = kp ApH(t) +\t1\tApH(t)dT ,\t(5.34)\nTi,pH 0\nwhere ApH = pHref (t) \u2014 pH(t) and pHref is the desired pH reference. The pH reference is kept in its optimal value during the experiments to guarantee maximal photosynthesis rate, i.e., pHref (t) = 8. A block diagram of the entire control system is shown in Figure 5.3.\nFigure 5.3: Block diagram of control structure.\nFor a constant set-point [CT]ref (L,t) (calculated by the PI controller), the set-point profile [CT]ref (x,t) is obtained from (5.34), which is a steady state solution of the total inorganic carbon. This set-point profile is modified to obtain a perfect match between the desired pHref and the pH of the plant.\nThe design of the PI controller of the outer feedback loop was based on the AMIGO tuning rule [65]. This tuning rule methodology is based on a first-order transfer function plus dead time of the system. Thus, the reaction curve method based on an open-loop test [65] was used to calculate such model. In this way, during the night period of the day, where the solar irradiance does not affect the system, a step change at the total inorganic\ncarbon reference was applied to capture the dynamics between the total inorganic carbon and the pH, as shown in Figure 5.4. For this experiment the inner DSMC-photobioreactor closed-loop system was considered.\nTime (h)\nFigure 5.4: Time-response dynamics of the total inorganic carbon, the CO2 injection, and the pH when a step change at the total inorganic carbon reference was applied\nAs can be observed in Figure 5.4, the increase in the total inorganic carbon produces a decrease in the pH, observing a time delay of 390 s. The evolution of the pH response is governed by two main dynamics [66], one second-order oscillatory term (natural frequency v, = 0.0140 rad/s and relative damping factor \u00a3 = 0.0420) and one overdamped dynamics (with time constant 450 s). The fraction of the remaining injected CO2 is recirculated producing the oscillatory behavior in the measured pH. However, to design the PI controller only the overdamped dynamic is considered. Then, the following first-order model with dead time, relating the pH output to the total inorganic carbon input, is obtained\nG(s) =\n1.59 e-390s\n450s + 1\t\u2019\n(5.35)\nwhere s is the Laplace variable. The resulting PI parameters, using the AMIGO tuning rule are kp = -0.1778 (m3 L)/(mol min) and 7\u2019,..pH = 547.9434 s. For the DSMC controller, we chose A1 = 128, A2 = 126 and T = 600 s. These values were find in simulation by a trial and error procedure in order to improve the closed-loop performance.\nIn Figure 5.5 the response of the sliding mode controller on July 1st, 2014 is shown. The experiment lasted around 12:30 h. Between 9:00 and 11:00 the harvesting of the culture was performed, where fresh medium is\n\t1\t1\t1\t1\t1\t1\u2014\t\t\t\t\t\nPn\t\t\t\t\t-\n_ Arx-w\t-\t\t\t\t\t\nl\t1\t1\t1\t1\t1\n10\t12\t14\t16\t18\t20\nCO, injection\nMedium injection\n9\n1000\n800 -\n600 -\n0 B\n8\n\u2022g 4 -\n_E\no. -J 3 -O r\u00b0 B 2 -\n1 -\nFigure 5.5: Experimental result of the tubular photobioreactor with DSMC controller. Results of July 1st, 2014.\n400 -\n200 -\n\t10\t12\t14\t16 18\t20\n-\t1\t1 1\tl\t1\t1\n\t\t\t\u201c \u201c Reference l\tl\t-\n\t1\t1 1\t\t1\n\t10\t12\t14\t16 18\t20\nTime (h)\n5\ninjected in the photobioreactor. The controller responds by decreasing the carbon dioxide injection. It can be observed in the bottom graphic of Figure 5.5 that the total inorganic carbon remains constant along the day in such a way that the pH of the photobioreactor tracks the reference. Smooth changes in irradiance are about 100 W/m2 and the controller compensates it in such a way that no tracking errors (more than \u00b10.1) were found.\n8\t10\t12\t14\t16\t18\t20\n1000 -\n800 -\n600 -\n400 -\n200 -\n0\n8\n10\n12\n14\n16\n20\nFigure 5.6: Experimental result of the tubular photobioreactor with DSMC controller. Results of July 3rd, 2014.\nAnother experiment, performed on July 3rd, 2014 is shown in Figure 5.6. The harvesting operation was performed between 9:00 and 11:00 h. The controller was regulating the dioxide carbon flow correctly during the whole test. In spite of the disturbances, the system response is smooth and the tracking error was less than \u00b1 0.1 for the pH. This is a promising result, taking into account the disturbances affecting the plant and the uncertainties present in the system model.\n5.3\tConclusions\nIn this chapter we describe the development of a sliding mode control methodology for the tracking and disturbance rejection problem in systems modeled by 1-D quasilinear hyperbolic systems with in domain control. The central idea of the control approach is the combination of the method\nof characteristics and sliding mode control. The method of characteristics is employed for a general first-order hyperbolic PDE to derive a nonlinear ODE system, which exactly describes the original PDE system. Then, the control design is performed in the ODE system instead of the original PDEs, which means that results for the description of sliding regimes in the control theory of lumped parameter systems become available for the PDE control problem. This approach was first proposed in [24]. A comparative study between this control methodology and another classic methodologies, such as PID and model predictive controllers, was shown in [41, 42]. Through a set of numerical tests it was shown that the DSMC approach is better than PID and model predictive controllers in settling time and disturbances rejection.\nChapter 6\nConclusions and future works\nMost of the results in the literature for analysis of control systems and development of algorithms for controller design are for systems modeled by ODEs. However, in many practical engineering systems the variable to be controlled depends on several independent variables (for example time and space). When there is more than one independent variable, it is natural to model the dynamics of the system by PDEs. In this thesis we studied and developed control methodologies for systems with dynamics modeled by first-order hyperbolic PDEs.\nFor a better understanding of the dynamic behavior of these systems, in Chapter 2 it was first studied the main properties of first-order hyperbolic PDEs. It was shown that for these systems there exist a coordinate transformation, called characteristic coordinates, that transform the PDEs into its diagonal form. Interestingly, in this framework the PDE can be transformed, along specific curves, into a set of ODEs without any approximation. This methodology of transforming the hyperbolic system into a set of ODEs is called method of characteristics and it can be used for the solution of the Cauchy problem associated with the PDE. Furthermore, the method of characteristics yields valuable insights into different aspects of the solution, that leads to the development of the control methodologies considered throughout this thesis.\nThese control methodologies were studied and developed for a set of specific control problems, but the results were presented, whenever possible, in a general form. More precisely, the control methodologies were studied and developed for the application on the following control problems: (i) suppression of slugging phenomenon in oil production facilities; (ii) stabilization of thermoacoustic oscillations in the Rijke tube; (iii) control of temperature of a solar power plant, and; (iv) control of pH of a tubular photobioreactor.\nSince there is no general control theory to deal with PDEs and due to the fact that these systems have different control problems and mathematical models, we used different control methodologies to treat them.\nIn Chapter 3 we have described a control methodology, developed in [8], for the suppression of slugging phenomenon in oil production facilities. We first present this methodology for a general n x n first order linear hyperbolic system. The idea is to impose a new boundary condition into the system as a linear combination of the system states, where each state is multiplied by a coefficient. By a Lyapunov based design method, the value of these coefficients are chosen to ensure the exponential stability of the system. The control variable is then designed such that the boundary condition of the system behaves like this new boundary condition that guarantee the system stability. Simulation results applied in the nonlinear model showed the effectiveness of the method. Comparing to other control methodologies applied on this system, the proposed control law guarantees stability for greater values of the choke opening. Most of the control methodologies (see for instance [28]) stabilize the system for choke opening at the maximum of 20-25%, whereas the control law developed in this thesis can achieve values of choke opening of more than 45%. However, the main limitation of this control law is, of course, the requirement of sensors of pressure at the outlet valve, bottom pressure and total flow-rate. In some real cases this is not feasible. The development of a state observer together with the control law is probably the best option in these cases. Moreover, in the simulations it was considered constant inlet of gas. From a practical point of view, it should be considered influxes of gas. These issues should be solved before to apply the control law into a real system.\nIn Chapter 4 we focused on the boundary feedback stabilization of the thermoacoustic phenomenon in the Rijke tube by a frequency domain approach. For this system, we first compute theoretically an irrational transfer function, based on its linearized PDE model, and then we provide a detailed characterization of the poles and zeros of the system. To stabilize the system, a proportional control law with delayed output is proposed. Using the Nyquist theorem for infinite dimensional systems and analyzing the closed-loop poles for high frequencies we derived necessary and sufficient conditions for the input-output stability. Experimental results on a prototype show the effectiveness and real-life applicability of the method.\nIn Chapter 5 we have addressed the problem of regulation and disturbance rejection for first-order quasilinear hyperbolic systems with the control variable in the domain of the PDE. The control methodology used was the distributed sliding mode control and was first proposed in [24]. Its central idea is the combination of the method of characteristics and\nsliding mode control. The method of characteristics is employed to derive a nonlinear ODE system that exactly describe the original PDE system. Then, the control design is performed in the ODE system instead of the original PDEs, which means that all known results for the description of sliding regimes in the control theory of lumped parameter systems become available for the PDE control problem. Besides, the well-known chattering problem of sliding mode control is solved by applying a continuous control law derived from a candidate Lyapunov function. We have developed this methodology for systems with relative degree one and two, respectively. The controllers were implemented, together with a state observer, in a solar power plant and a tubular photobioreactor. In both cases, the control law demonstrate promising results not only in set-point tracking in spite of nonlinear dynamics and uncertainties, but also in the presence of strong disturbances. Moreover, in [41, 42] it was showed, through a set of numerical tests, that the closed-loop system with the DSMC approach has better performance than PID and model predictive controllers in settling time and disturbances rejection.\nIn general, the methodologies studied for controlling first-order hyperbolic PDEs have better performance than classical control approaches. This second one is based on simplifying assumptions that the control and controlled variables are spatially uniform. Yet, many control problems involve regulation or stabilization of variables which are distributed in space, and cannot be effectively solved with the traditional approaches. Moreover, the trend in industrial processes is to meet increasingly stringent safety regulations, and tighter product quality and energy specification [15]. In addition, they must be flexible enough to meet the product demands of a rapidly changing world market, utilize feedstocks, and minimize the use of dangerous chemicals. If these processes have distributed parameters, then the methodologies studied in this thesis and others in literature will be critical for the economic success of the industry.\nThese needs, together with the advances in the development of mathematical models that predict the behavior of distributed parameter systems provide a strong justification of the use of feedback control of these processes based on PDEs.\n6.1 Future works\nThis thesis is an ongoing work, hence, there are topics that need further research. The main ones are the following:\n(A.10). In order to prove the local stability of the nonlinear system the following augmented Lyapunov function should be used\nV = I [(u+tP0u+) e-^1- + (u-TPiu-) e-^1-] dx+\n0\n\u00a3 [(e+TQo<+) e-^2x + (rTQiC) e-^2x] dx+\nI [(w+TBow+) e-M2X + (w-TBiw-) e-M2-] dx, 0\nwhere\nPo = D2 (a+)-1 ,\nQo = DO (A+),\nBo = D2 (A+)3 ,\nand \u00a3 = dr and w = -d-r.\ndx\tdx2\nPi = d? (a-)-Qi = d? (a-) ,\nBi = D? (A-)3 ,\nii.\tTo show that the input-output stability of the proposed control law for the Rijke tube control problem, studied in Chapter 4, implies the exponential stability of the states of the system.\niii.\tDevelopment of state observers based on PDE models, with convergence guaranteed, for the cases studied in Chapter 3 and 5. Thus, the results of this thesis can been generalized to output-feedback control systems.\niv.\tTo test the control law developed in Chapter 3 in an experimental plant to further corroborate the results presented here.\nv.\tTo analyze the effect of parametric uncertainties in the control methodologies studied throughout this thesis.\nBibliography\n[1]\tM. Krstic and N. Bekiaris-Liberis . Nonlinear stabilization in infinite dimension. Annual Reviews in Control, v. 37: p. 220-231, 2013.\n[2]\tX. Litrico and V. Fromion . Boundary control of hyperbolic conservation laws using a frequency domain approach. Automatica, v. 45: p. 647-656, 2009.\n[3]\tR. F. Curtain and H. Zawrt. An introduction to infinite dimensional linear systems theory. Springer-Verlag, 1995.\n[4]\tM. Krstic and A. Smyshlyaev. Boundary control of PDEs: a course on backstepping designs. Philadelphia: SIAM Advances in Design and Control, 2008.\n[5]\tF.M. Callier and C. A. Desoer. An algebra of transfer functions for distributed linear time-invariant systems. IEEE Transactions on Circuits and Systems, v. 9: p. 651-662, 1978.\n[6]\tO. A. Aamo. Disturbance rejection in 2 x 2 linear hyperbolic systems. IEEE Transactions on Automatic Control, v. 58: p. 10951106, 2013.\n[7]\tJ.-M. Coron, B. d\u2019Andrea Novel, and G. Bastin. A strict Lyapunov function for boundary control of hyperbolic systems of conservation laws. IEEE Transactions on Automatic Control, v. 52: p. 2-11, 2007.\n[8]\tA. Diagne, G. Bastin, and J.-M. Coron. Lyapunov exponential stability of 1-D linear hyperbolic systems of balance laws. Automatica, v. 48: p. 109-114, 2012.\n[9]\tJ.-M. Coron and G. Bastin. Dissipative boundary conditions for one-dimensional quasi-linear hyperbolic systems: Lyapunov stability for the C1-norm. SIAM Journal on Control and Optimization, v. 53: p. 1464-1483, 2015.\n[10]\tG. Bastin, J.-M. Coron, and O. Tamasoiu. Stability of linear density-flow hyperbolic systems under PI boundary control. Automatica, v. 53: p. 37-42, 2015.\n[11]\tG. A. de Andrade and D. J. Pagano. Boundary control for stabilization of slugging oscillations. In: Proceedings of the 2nd IFAC workshop on automatic control in offshore oil and gas production. Florianopolis, Brazil, 2015. p. 77-82.\n[12]\tV. dos Santos, G. Bastin, J.-M. Coron,and B. d'AndrEa Novel. Boundary control with integral action for hyperbolic systems of conservation laws: Stability and experiments. Automatica, v. 44: p. 1310-1318, 2008.\n[13]\tR. Vazquez and M. Krstic. Control of 1-D parabolic PDEs with Volterra nonlinearities - Part I: design. Automatica, v. 44: p. 2778-2790, 2008.\n[14]\tR. Vazquez and M. Krstic. Control of 1-D parabolic PDEs with Volterra nonlinearities - Part II: analysis. Automatica, v. 44: p. 2791-2803, 2008.\n[15]\tP. CHRISTOFIDES. Nonlinear and robust control of partial differential equations: methods and applications to transport-reaction processes. Boston: Birkhauser, 2001.\n[16]\tD. B. Pourkargar and A. Arm aou. Geometric output tracking of nonlinear distributed parameter systems via adaptive model reduction. Chemical Engineering Science, v. 116: p. 418-427, 2014.\n[17]\tM. J. Balas . Finite dimensional control of distributed parameter systems by Galerkin approximation of infinite dimensional controllers. Journal of Mathematical Analysis and Applications, v. 114: p. 17-36, 1986.\n[18]\tJ. L. Lions . Optimal control of systems described by partial differential equations. Berlin: Springer-Verlag, 1971.\n[19]\tB. Bamieh, F. Paganini, and M. Dahleh. Distributed control of spatially invariant systems. IEEE Transactions on Automatic Control, v. 47: p. 1091-1107, 2002.\n[20]\tP. K. C. Wang. Asymptotic stability of distributed parameter systems with feedback controls. IEEE Transactions on Automatic Control, v. 11: p. 46-54, 1966.\n[21]\tE. M. Hanczyc and A. Palazoglu. Sliding Mode Control of Nonlinear Distributed Parameter Chemical Processes. Industrial and Engineering Chemistry Research, v. 34: p. 557-566, 1994.\n[22]\tE. M. Hanczyc and A. Palazoglu. Nonlinear control of a distributed parameter process: The case of multiple characteristics. Industrial and Engineering Chemistry Research, v. 45: p. 4406-4412,\n1995.\n[23]\tH. Sira-Ramirez. Distributed sliding mode control in systems described by quasilinear partial differential equations. Systems and Control Letters, v. 13: p. 177-181, 1989.\n[24]\tH. Sira-Ramirez and J. Rivero-Mendonza. Slidingmode control of nonlinear first-order distributed parameter systems. Pure Mathematics and Applications, v. 1: p. 123-141, 1990.\n[25]\tS. Y. Shvartsman and I. G. Kevrekidis. Nonlinear model reduction for control of distributed systems: a computer-assisted study. A. I. Ch. E. Journal, v. 44: p. 1579-1595, 1998.\n[26]\tD. Shi, N. H. El-Farra, P. MHASKAR,and P. D. Christo f ides. Predictive control of particle size distribution in particulate processes. Chemical Engineering Science, v. 1: p. 268-281, 2006.\n[27]\tC. Vilas, M. R. Garc\u00eda, J. R. Banga,and A. A. Alonso. Robust feed-back control of distributed chemical reaction systems. Chemical Engineering Science, v. 62: p. 2941-2957, 2007.\n[28]\tJ. Godhavn, M. P. Fard, and P. H. Cuchs. Newslug control strategies, tuning rules and experiments results. Journal of Process Control, v. 15: p. 547-557, 2003.\n[29]\tM. Krstic, A. Krupadanam, and C. Jacobson. Selftuning control of a nonlinear model of combustion instabilities. IEEE Transactions on Control Systems Technology, v. 7: p. 424-436, 1999.\n[30]\tJ. P. Epperlein, B. Bamieh, and J. Astrom. Thermoacoustics and the Rijke tube: Experiments, identification and modeling. Control Systems Magazine, v. 35: p. 57-77, 2015.\n[31]\tJ. J. E. Slotine and W. Li. Applied nonlinear control. New Jersey: Prentice Hall, 1991.\n[32]\tH. Sira-Ramirez. Nonlinear variable structure systems in sliding mode: the general case. IEEE Transactions on Automatic Control, v. 34: p. 1186-1188, 1989.\n[33]\tG. A. Andrade, D. J. Pagano, I. Fernandez, J. L. GuzAn, and M. Berenguel. Boundary control of an industrial tubular photobioreactor using sliding mode control. In: Proceedings of the 19th World Congress of the International Federation of Automatic Control. Cape Town, South Africa, 2014. p. 4903-4908.\n[34]\tG. A. Andrade, D. J. Pagano, J. L. Guz\u00c1N, and M. Berenguel. Optimizaci\u00f3n de la producci\u00f3n de biomasa en foto-biorreactores tubular. In: Proceedings of the 35th Jornadas de Autom\u00e1tica. Valencia, Spain, 2014. p. 513-519.\n[35]\tI. Fern\u00e1ndez, G. A. Andrade, J. L. Guz\u00c1N, M. Berenguel, and D. J. Pagano. Modelo NARMAX de pH en un fotobiorreactor tubular de microalgas. In: Proceedings of the 19th World Congress of the International Federation of Automatic Control. Barcelona, Spain, 2014. p. 550-557.\n[36]\tI. Fern\u00e1ndez, M. Berenguel, J. L. Guz\u00c1N, F. G. Aci\u00e9n, G. A. Andrade, and D. J. Pagano. Hierarchical non-linear control of a tubular photobioreactor. In: Proceedings of the 5th IFAC Conference on Nonlinear Model Predictive Control. Seville, Spain, 2015. p. 224-229.\n[37]\tG. A. de Andrade, R. Vazquez, and D. J. Pagano. Boundary feedback control of unstable thermoacoustic oscillations in the rijke tube. In: Proceedings of the 2nd IFAC workshop on control of systems governed by partial differential equations. Bertinoro, Italy,\n2016.\tp. 48-53.\n[38]\tG. A. de Andrade, R. Vazquez, and D. J Pagano. Boundary control of a Rijke Tube using irrational transfer functions with experimental validation. Accepted for IFAC World Congress\n2017,\t2016.\n[39]\tG. A. Andrade, D. J. Pagano, J. D. Alvarez, and M. Berenguel. Distributed sliding model control: Application to a solar power plant. Journal of Control, Automation and Electrical Systems, v. 26: p. 1-12, 2014.\n[40]\tI. Fern\u00e1ndez, F. G. Aci\u00e9n, M. Berenguel, J. L. Guz-m\u00c1n, G. A. Andrade, and D. J. Pagano. A lumped parameter chemical-physical model for tubular photobioreactors. Chemical Engineering Science, v. 112: p. 116-129, 2014.\n[41]\tG. A. de Andrade, J. D. Alvarez, D. J. Pagano, and M. Berenguel. Nonlinear controllers for solar thermal plants: a comparative study. Control Engineering Practice, v. 43: p. 12-20, 2015.\n[42]\tG. A. de Andrade, D. J Pagano, J. L. Guzm\u00e1n, M. Berenguel, I. Fern\u00e1ndez, and F. G. Aci\u00e9n. Distributed sliding mode control of pH in tubular photobioreactors. IEEE Transactions on Control Systems Technology, v. 24: p. 1160-1173, 2016.\n[43]\tG. A. de Andrade, M. Berenguel, J. L. Guzm\u00e1n, D. J Pagano, and F. G. Aci\u00e9n. Optimization of biomass production in outdoor tubular photobioreactors. Journal of Process Control, v. 37: p. 58-69, 2016.\n[44]\tI. Fern\u00e1ndez, M. Berenguel, J. L. Guzm\u00e1n, F. G. Aci\u00e9n, G. A. Andrade, and D. J. Pagano. Hierarchical control for microalgae biomass production in photobioreactors. Control Engineering Practice, v. 54: p. 246-255, 2016.\n[45]\tV. I. Arnold. Geometrical methods in the theory of ordinary differential equations. London: Springer, 1983.\n[46]\tS. Alinhac. Hyperbolic Partial Differential Equations. New York: Springer, 2009.\n[47]\tT. T. Li. Controllability and observability for quasilinear hyperbolic systems. Beijing: Higher Education Press, 2009.\n[48]\tF. John. Partial Differential Equations. New York: Springer-Verlag, 1982.\n[49]\tT. T. Li, Z. Q. Shao, and D. X. Kong. Global existence of classical solutions to the Cauchy problem on a semi-bounded initial axis for a nonhomogeneous quasilinear hyperbolic system. Mathematical Analysis and Applications, v. 325: p. 205-225, 2007.\n[50]\tP. D. Lax. Hyperbolic Partial Differential Equations. Providence: American Mathematical Society, 2006.\n[51]\tJ.-M. Coron and G. Bastin. Stability and boundary stabilization of 1-D hyperbolic systems. New York: Birkhauser Basel, 2016.\n[52]\tG. Bastin, J.-M. Coron, and B. d\u2019Andr\u00e9a Novel. Boundary feedback control and Lyapunov stability analysis for physical networks of 2x2 hyperbolic balance laws. In: Proceedings of the 47th IEEE Conference on Decision and Control. Cancun, Mexico, 2008. p. 1454-1458.\n[53]\tR. Di Meglio F. Vazquez, M. Krstic, and N. Petit. Backstepping stabilization of an underactuated 3x 3 linear hyperbolic system of fluid flow equation. In: Proceedings of the American Control Conference 2012. Montreal, Canada, 2012. p. 3365-3370.\n[54]\tL. C. Evans. Partial differential equations. American Mathematical Society, 2010.\n[55]\tR. Curtain and K. Morris. Transfer functions of distributed parameter systems: A tutorial. Automatica, v. 45: p. 1101-1116, 2009.\n[56]\tC. A. Desoer and M. Vid YAS AGAR. Feedback systems: input output properties. New York: Academic Press, 1975.\n[57]\tJ. K. Hale and S. M. V. Lun el . Strong stabilization of neutral functional differential equations. IMA Journal of Mathematical Control and Information, v. 19: p. 5-23, 2002.\n[58]\tA. F. FILIPPOV. Differential equations with discontinuous righthand side. Dordrecht: Kluwe Academic Publishers, 1988.\n[59]\tJ. Y. Hung, W. Gao, and J. C. Hung. Variable Structure Control: A Survey. IEEE Transactions on Industrial Electronics, v. 40: p. 2-22, 1993.\n[60]\tV. Utkin, J. GULDNES, and J. SHI. Sliding mode controlin eletro-mechanical systems. New York: CRC Press, 2009.\n[61]\tH. K. Khalil. Nonlinear systems. New Jersey: Prentice Hall,\n1996.\n[62]\tS. Mechhoud and T.-M. Laleg-Kirati. Observer-based bilinear control of first-order hyperbolic PDEs: application to the solar collector. In: Proceedings of the 5fth Annual Conference on Decicion and Control. Osaka, Japan, 2015. p. 4909-4914.\n[63]\tJ. F. SAnchez, J. M. Fernandez, F. G. AciEn, A. Rueda, J. PErez-Parra, and E. Molina. Influence of culture conditions on the productivity and lutein content of the new strain Scenedesmus almeriensis. Process Biochemistry, v. 43: p. 398405, 2008.\n[64]\tI. Fernandez, F. G. AciEn, M. Berenguel, and J. L. GuzmAn. First principles model of a tubular photobioreactor for microalgal production. Industrial &amp; Engineering Chemistry Research, v. 27: p. 11121-11136, 2014.\n[65]\tK. J. Astrom and T. HAgglund. Advanced PID control. Research Triangle Park, USA: ISA - The Instrumentation, Systems, and Automation Society, 2005.\n[66]\tM. Berenguel, F. Rodr \u00edguez, F. G. AciEn, and J. L. G arc \u00cd A. Model predictive control of pH in tubular photobioreactors. Journal of Process Control, v. 14: p. 377-387, 2004.\n[67]\tF. Di Meglio, N. Petit, V. Alstad, and G.-O. Kaasa. Stabilization of slugging in oil production facilities with or without upstream pressure sensors. Journal of Process Control, v. 22: p. 809822, 2012.\n[68]\tM. E. Stasiak, D. J. Pagano , and A. Plucenio .A new discrete slug-flow controller for production pipeline risers. In: Proceedings of the 1th IFAC Workshop on Automatic Control in Offshore Oil and Gas Production. Trondheim, Norway, 2012. p. 122-127.\n[69]\tF. Di Meglio, G. O. Kaasa, N. Petit, and V. Alstad. Model-based control of slugging: advances and challenges. In: Proceedings of the 1th IFAC Workshop on Automatic Control in Offshore Oil and Gas Production. Trondheim, Norway, 2012. p. 109-115.\n[70]\tF. Di Meglio, G.-O. Kaasa, N. Petit, and V. Alstad. Slugging in multiphase flow as a mixed initial-boundary value problem for a quasilinear hyperbolic system. In: Proceedings of the American Control Conference 2012. San Francisco, USA, 2012. p. 35893596.\n[71]\tJ. W. S. Rayleigh. The theory of sound. New York: Dover, 1945.\n[72]\tK. Kashinath, I. Waugh, and M. P. Juniper. Nonlinear self-excited thermoacoustic oscillations of a ducted premixed flame: bifurcations and routes to chaos. In: Proceedings of the N3L International Workshop T.U.M. Munich, Germany, 2013.\n[73]\tM. A. Heckl. Active control of the noise from a Rijke tube. Journal of Sound and Vibration, v. 124: p. 117-133, 1988.\n[74]\tJ. P. Epperlein. Topics in modelling and control of spatially distributed systems. PhD thesis. University of California.\n[75]\tM. Pasamontes, J. D. Alvarez, J. L. GuzmAn, M. Berenguel , and E. F. Camacho. Hybrid modeling of a solarthermal heating facility. Solar Energy, v. 97: p. 577-590, 2013.\n[76]\tA. Meaburn and F.M. Hughes. Resonance characteristics of distributed solar collector fields. Solar Energy, v. 51: p. 215-221, 1993.\n[77]\tE. F. Camacho, M. Berenguel, F. R. Rubio, and D. MART\u00cdNEZ. Control of solar energy systems. London: Springer, 2012.\n[78]\tF. G. AciEn, F. Garc\u00eda, SAnchez PErez, J. M. Fern A n d e z , and E. Molina. Modeling of biomass productivity in tubular photobioreactors for microalgal cultures: effects of dilution rate, tube diameter and solar irradiance. Biotechnology Bioengineering , v. 58: p. 605-616, 1998.\n[79]\tI. Fern\u00e1ndez, F. G. Aci\u00e9n, J. M. Fern\u00e1ndez, J. L. Guzm\u00e1n, J. J. MaG\u00c1N,and M. Berenguel. Dynamic model of microalgal production in tubular photobioreactors. Bioresource Technology, v. 126: p. 172-181, 2012.\n[80]\tF. C\u00e1m\u00e1cho, F. G. Aci\u00e9n, J. A. S\u00e1nchez, F. G\u00e1rc\u00ed\u00e1, and E. M o L i N \u00e1 . Prediction of dissolved oxygen and carbon dioxide concentration profiles in tubular photobioreactors for microalgal culture. Biotechnology Bioengineering, v. 62: p. 71-86, 1999.\n[81]\tF. Grogn\u00e1rd, A. Akhmetzh\u00e1nov, and O. Bern\u00e1rd. Optimal strategies for biomass productivity maximization in a photobioreactor using natural light. Autom\u00e1tica, v. 50: p. 358-368, 2014.\n[82]\tE. Pol\u00e1K. Computational methods in optimization. New York: Academic Press, 1971.\n[83]\tJ. T. Betts. Practical methods for optimal control and estimation using nonlinear programming. Philadelphia, USA: SIAM Advances in Design and Control, 2010.\n[84]\tC. Buskens and H. M\u00e1urer. SQP methods for solving optimal control problems with control and state constraints: adjoint variables, sensivity analysis and real-time control. Journal of Computational and Applied Mathematics, v. 120: p. 85-108, 2000.\n[85]\tM. B\u00e1Z\u00e1R\u00e1\u00e1, H. D. Sher\u00e1LI, and C. M. Shetty. Nonlinear programming theory and algorithms. New Jersey: Wiley-Interscience, 2006.\n[86]\tP . Dupuis and M. R. J\u00e1mes. Rates of convergence for approximation schemes in optimal control. SIAM Journal on Control and Optimization, v. 36: p. 719-741, 1998.\n[87]\tM. B\u00e1Z\u00e1R\u00e1\u00e1, H. D. Sher\u00e1LI, and C. M. Shetty. Nonlinear programming theory and algorithms. New Jersey: Wiley-Interscience, 2006.\nAppendix A\nModeling of slug flow phenomenon in oil installations\nThis appendix deals with the slug flow phenomenon in oil well and flow lines. In Section A.1 we briefly describe the characteristics of the slug flow and its impact on the level of oil production. Then, in Section A.2, we present a mathematical model for two-phase flow able to reproduce the slugging phenomenon. Numerical results are presented in Section A.3 to demonstrate that the model reproduces the slug flow phenomenon similarly to other results in the literature.\nA.1 Description of slug flow\nSlug flow is a multiphasic flow regime that occurs mainly in oil installations, such as gas lift well and flowline risers (Figure A.1 summarizes the family of systems we are focusing in this appendix). This phenomenon is characterized by intermittent axial distribution of gas and liquid that lead to oscillatory flow patterns. Consequently, there may be dangerous variations in oil production due to changes in pressure and liquid and gas flow. Mature oil fields, increase of gas-oil ratio and increase of water fraction are probably the main cause of this type of unstable flow.\nA typical slugging bifurcation diagram, considering the outlet vale opening (production choke) as a bifurcation parameter, is shown in Figure A.2. As can be seen, a supercritical Hopf bifurcation takes place at the point HBsup, giving rise to a stable limit cycle. As negative effects of this type of phenomenon, it can be mentioned the oil production detriment and several issues concerning safety of operations on the surface equipment, which can\nFigure A.1: Family of systems subjected to the slugging phenomenon [67].\nprovoke several undesired effects as deteriorating the separation quality and level overflow in the multiphase flow separator [68].\nSeveral methodologies have been developed to avoid the undesirable slugging phenomenon, between them, the active control of the outlet valve has been shown a promising method to suppress these oscillations [28]. These controllers use mainly upstream pressure sensors (a sensor located\nFigure A.2: Typical bifurcation diagram considering the outlet valve opening as the bifurcation parameter. A stable limit cycle undergoes from a supercritical Hopf bifurcation HBsup.\nat the bottom of the pipe) in the feedback-loop to stabilize the flow by outlet valve actuation.\nA.2 Mathematical model\nSystems subjected to slugging phenomenon consist of pipes ranging from several hundreds to several thousands meter-long pipes filled with oil, gas, and sometimes water. The distributed nature of these systems suggests models consisting of PDEs [69]. The model used in this work is similar to that proposed by [70], but the friction against the pipe walls is considered and a homogeneous model for the two-phase flow is used. Moreover, it is assumed constant temperature along the pipe, incompressible oil, and no mass transfer between the gas and liquid phase. In this context, the PDEs that describe the system behavior are given by\ndag Pg , 1 d'h = 0\ndt A dx , daipi + I dqi = 0\ndt A dx , dpmVm\tdP + pm vm\ndt\tdx\n2dPmV\nPmgsind(x),\n(A.1)\n(A.2)\n(A.3)\nf\n2 m\nwhere, for k = g or l, ak denotes the volume fraction of phase k, pk its density and qk its flow rate. The pressure is denoted by P, pm is the density of the mixture, vm is the velocity of the mixture, f accounts for the friction factor, d is the pipe diameter and A its cross-section area, and d(x) is the inclination of the pipe. The time variable is t e [0, +to) and x e [0, L] is the space variable, where L is the length of the pipe. Note that in the above equations we have omitted the time and space arguments for sake of legibility.\nBesides the PDE model (A.1)-(A.3), the following algebraic equations are used for system closure:\nag + al = 1 p = Pg RT\nM '\npm\tagpg + alpl,\t(A.4)\nw =\nag pg ag Pg + aiPi\n(A.5)\nwhere R is the specific gas constant, M is the gas molar weight, w is the gas mass fraction, and T is the temperature.\nRegarding the boundary conditions, they are given at both ends of the pipe. At the bottom, two boundary conditions are given: one for the liquid flow rate, assuming that it is linearly depend on the pressure drop between\nthe pipe and the oil reservoir, and other boundary condition for the gas flow rate, assumed to be constant. They are expressed as\nqi(0, t) = PI[Pr - P(0, t)], qg(0, t) = qg,\n(A.6)\n(A.7)\nwhere ql is the liquid flow rate, qg is the gas flow rate, PI is a constant coefficient called productivity index and Pr is the pressure in the reservoir, assumed to be constant.\nAt the top, the total flow rate, qt = ql + qg, is assumed to be governed by a valve equation of given by\nqt(L, t) = Cout u(t) ^pm(L, t)(P(L, t) - Ps),\t(A.8)\nwhere Ps is the pressure in the separator, Cout is a valve constant and u is the valve opening, which is the manipulated variable.\nA.2.1 Formulating the model as a quasilinear hyperbolic system\nConsider the following state vector\nr\t1 T\tI\"\ta g P g\nU M U1 U2 u3\t= [ agpg+aipl\niT\nP qt ] .\nCombining Equations (A.1)-(A.3), with relations (A.4)-(A.5), it is possible to rewrite the system as\ndH\tdF ,\t..\n(u(x, t)) + -dx(u(x, t)) = G(u(x, t)).\n(A.9)\nNote that 8Ha(u) = H'(u)du, therefore the above equation can be rewritten to\nd u\tdu\n(x, t) + A(u(x, t)) \u2014 (x, t) = S(u(x, t)).\n(A.10)\nwhere\nA(u(x, t)) = H'(u(x, t)) xF'(u(x, t)) S(u(x, t)) = H'(u(x, t))-1G(u(x, t))\nThe expression of A(u(x, t)) and S(u(x, t)) are given by (A.11) and (A.12), respectively.\n\n(1--U1 )Mv2 + RTplv-\u00ed\n3 AMpiv2 v3(Mv2-RTpi)((l-v1)Mv2 + RTpiv1) AMRTp^V!\nRTpiv3\u2014Mv2v3\nAM P1V2\n\n\n______AMpi_______\n(1\u2014f 1 )Mv2 + RT pi vi\ngsine(x) + fvj\n0 0\t\\\nq\t((l--ui)M-U2 + -RTp;-ui)I 2\nAMRTp^V!\n-RT-Uj-U2 r,(l\u2014y1')Mv2lJ3 + RTpiV1V3\nAMv%\tAMpiV2\tJ\n(A.ll)\nA.2 Mathematical model\nI\nI\n>i)((l-t;i)M2t;2 + 2MRTpit;it;2) + _R2T2p^2\nA.2.2 Well-posedness\nTo guarantee that A and all the other functions of u belong to Ci, we restrict our study to a set\nu G K c (0, L) x (Ps, Pr) x (0, +to) c R3\nFor each value of u G K, A has 3 real eigenvalues Ai(u), i =1, 2, 3, as / li(u) \\ well as a set of linearly independent left eigenvectors l(u) = I l2 (u) I .\n\\ l3(u) J The following inequalities hold\nVu G K, A2(u) &lt;0 &lt;Ai(u) &lt;A3(u).\nThis ensures that the system is strictly hyperbolic, according to Definition 2.2. In order to apply Theorem 2.2, to establish the well-posedness of the mixed initial-boundary value problem, we have to rewritte the boundary conditions (A.6)-(A.8). More precisely, given a C1 initial condition p : [0, L] K, there must exist two functions gl : R R2 and gr : R2 R such that Equations (A.6)-(A.8) are equivalent to\nz = 0 : (vi(0, t), V3(0, t)) = gl(v2(0, t)) z = L : V2(L, t) = gr(vi(L, t), V3(L, t), u)\nwhere v(x, t) = l(p(x))u(x, t).\nThe existence of such functions only depends on the choice of the initial condition p. Rewriting (A.6)-(A.8) in the u variables we get, for the left boundary conditions,\nhl(vi, U2, U3) =\n(1 - Ui (0, t))u3(0, t) - PI(Pr - U2(0, t)) (1 - U1(0, t))u3(0, t) - qg\nwhereas the right boundary condition reads\nhr (Ui, U2, U3, u) = U3 - Cout u(t)x\n\n____________U2(L, t)plM____________\nMu2(L, t)(1 - ui(L, t)) + ui(L, t)RTpl\n(u2(L, t) - Ps) = 0.\nIn the u variables, these equations can be rewritten to\nz = 0 : hl(Ui, U2, U3) = hl(miu, m2v, m3u) = 0,\nz = L :\thr(Ui,\tU2,\tU3,\tU) =\thr(Ui, U2,\tU3)\t=\thr(miu,\tmpi),\tmpj,\tU) = 0\n/ mi(u) where the are line vectors such that m(u) = I m2(u)\n\\ m3(u)\nA necessary and sufficient condition for the functions gi and gr to exist is that the following Jacobian matrices\n( ftV2(0), V3(0)) ft(\u00ab1(0), v2(0), V3(0)) )\nand\n( ft (\u00ab1(L), v2(L), \u00ab3(L)) )\nare nonsigular. Then, the Implicit Function Theorem guarantees the existence of gl and gr. Further, the well-posedness follows, according to Theorem 2.2 given that p also verifies conditions of C1 compatibility.\nA.3 Simulation results\nThis section shows the simulation results of the open-loop quasilinear model (A.10). The model parameters are shown in Table A.1. We consider a 2500 meter long vertical well with reservoir pressure Pr = 180 bar and separator pressure Ps = 10 bar. For the numerical simulations, the space was divided in N sections and the space derivatives were written using a finite difference scheme. These equations were solved by using ODE solver. To ensure numerical stability, the Courant-Friedricks-Lewy condition was used.\nIn Figure A.3 is shown an open loop simulation of the quasilinear system (A.10). The simulation starts with the production choke opened to Z = 100% and then after t = 8 h the production choke is closed to Z = 50% and to Z = 20% after more 8 hours. The oscillations have a period around of 50 minutes. For this case study, the supercritical Hopf bifurcation point, HBsup take place at a valve opening Z(t) = 22% (this value was found by performing several simulations for different valve openings). The corresponding open-loop bifurcation diagram for the valve opening is shown in Figure A.2.\nTable A.1: Parameters of the slug flow model.\nSymbol\tDescription\tValue and units\nA\tpipe cross-section area\t0.0094 mi 2\nCout\tvalve constant\t0.0024 [-]\nd\tpipe diameter\t0.1092 m\ng\tgravity constant\t9.81 m s-2\nR\tuniversal gas constant\t8.31 J K mol-1\nL\tlength of the tube\t2500 m\nM\tgas molar weight\t0.016 Kg mol-1\ne\tinclination pipe\t90o\npi\tproductivity index\t0.3 kg (s bar)-1\nPr\treservoir pressure\t180 bar\nPs\tseparator pressure\t10 bar\nT\ttemperature\t300 K\nChoke opening (%)\tTop pressure (bar)\tBottom pressure (bar)\n80\n70\n60\n50\n30\n25\n20\n15\n10\n00\n50\n0\n\nI I I I I I I\u2014\n0\t5\t10\t15\t20\t25\t30\t35\n------------------1-----------------1-----------------1-----------------1------------------1-----------------1-----------------r-\nI I 1 I I I 11111 RaAAaaa/\u2014:--i\nA A A u\n0\t5\t10\t15\t20\t25\t30\t35\nn---------------1--------------1--------------1--------------1--------------r-\n\ni i i i i i i\n0\t5\t10\t15\t20\t25\t30\t35\nTime (h)\nAppendix B\nModeling thermoacoustic phenomenon in the Rijke Tube\nThis appendix describes the thermoacoustic phenomenon in the Rijke tube. In Section B.1, we briefly describe the Rijke tube and the thermoacoustic phenomenon. Its mathematical model is presented in Section B.2. In this work, the Rijke tube is modeled as a heating section embedded within a network of pipes. Simulation results validating the model with real data from the system are shown in Section B.3.\nB.1 System description\nB.1.1 The Rijke tube\nThe Rijke tube experiment basically consists of a vertical tube opened in both ends and a heater source in the lower half. A speaker placed to a slight distance under the tube is used as actuator, while a microphone placed near the top of the tube provides the pressure measurement.\nIn this work, all the experiments were performed on a simple 1.3 meter long glass tube with an electrical heating element made of nichrome wire coil (see Figure B.1). The power is delivered into the coil using a DC power supply with power output 360 W. The location of the electrical heating element was chosen to be a quarter of the tube length. The sound pressure in the tube is measured with a clip-on microphone with built-in preamplifier. This signal is sent to a control computer through a data acquisition device. The control system is implemented as part of a SCADA program based on a LabVIEW software. In such configuration the control algorithm is implemented as Matlab function executed from the SCADA program. For\nFigure B.1: Rijke tube schematic and detailed view of the prototype used for the experiments.\nthe closed-loop experiments it was used a 30 W ceiling speaker as the actuator together with a linear amplifier.\nB.1.2 The thermoacoustic phenomenon in the Rijke tube\nIn the Rijke tube, thermoacoustic phenomenon refers to the creation of sound due to the transfer of energy from a thermal source to acoustic waves. In this system, the heat source excites acoustic waves: the heat source transfers heat to the air in the tube, making the air to rise up and creating an upward flow. The rising hot air becomes dense by coming in contact with the cooler walls of the upper half of the tube. This means that in the lower half of the tube, the air always experiences expansion, while in the upper part, the air always experiences compression. This explains how the heat source in the lower half of the tube leads to creation of a standing wave. But it is not enough to clarify how the heat source sustains the already excited acoustic waves. This part of the phenomenon is formulated by the Rayleigh's criterion [71]. This criterion states that if heat be given to the air at the moment of greatest condensation, or be taken from it at the moment of greatest rarefaction, the oscillation is encouraged. On the other hand, if heat be given at the moment of greatest rarefaction, or taken from\n0\t5\t10\t15\t20\t25\n20\t20.02\t20.04\t20.06\nTime (s)\n(a)\n(b)\nFigure B.2: (a) Microphone signal at the onset of instability showing growth, and then saturation of the limit cycle. A zoomed-in picture shows the periodic, but nonsymetric, limit-cycle behavior. (b) Bifurcation diagram of non-dimensional velocity with heat release as bifurcation parameter.\nit at the moment of greatest condensation, the oscillation is discouraged. In mathematical terms, the Rayleigh\u2019s criterion is formulated in terms of the Rayleigh integral over the control volume V:\nI = j P(t)Q(t)dt,\t(B.1)\nwhere P is the acoustic pressure fluctuation, Q is the fluctuation in heat power released in the heater, and t is time.\nAccording to the Rayleigh\u2019s criterion, if I &lt;0, the acoustic oscillations will damp out. If I > 0, then acoustic oscillations will grow. And, if I = 0, the oscillations will neither be damped out nor amplified.\nA typical sound pressure output evolution is shown in Fig. B.2(a). At the beginning of the experiment, the heater coil power supply was turned on and increased until 300 W, which is the critical heater power which the tube begin to hum. As can be seen in that figure, at this point the sound pressure grows exponentially, behaving then as a linear system. When the pressure amplitude grows beyond the bounds of linearity the system behavior moves into nonlinear regime (limit cycle). The sound frequency, under standard conditions, is approximately twice the length of the tube (see the bottom graphic of Figure B.2(a)).\nFigure B.2(b) depicts the bifurcation graphic of the Rijke tube considering the heat release as bifurcation parameter. For small values of heat power, the system equilibrium is stable and all perturbations decay asymptotically resulting in steady flow within the tube. As the heat power increases, the\nstability margin of the system decreases and at a critical value of the heat power a Hopf bifurcation takes place, giving rise to a limit cycle. This limit cycle is unstable and the Hopf bifurcation is subcritical in nature. As the amplitude of this limit cycle increases in magnitude, it collapses with a stable limit cycle in a Fold bifurcation. Note that between the Fold and the Hopf Bifurcation points coexist (i) one stable equilibrium point, (ii) and two periodic orbits, one unstable (inner limit cycle) and other stable (outer). This is the range of bistability, depending on amplitude of the initial perturbation either a steady state or a limit cycle is reached. The influence of other bifurcation parameters, such as the heat release position, can be seen in [72].\nB.2 Mathematical model\nThe Rijke tube can be modeled as a heating section embedded within a network of pipes. We assume that the fluctuations of pressure, density, and velocity occur only along the axial direction. Therefore, the system can be described by the one-dimensional mathematical model of compressible gas dynamics. Furthermore, the heating release zone is assumed to be located in a very narrow section.\nThe Rijke tube is composed of 2 compartments described by the linearized Euler equations of gas dynamics:\ndVj ,\t.\t1 dPi .\t.\n(t, Xi) + - \u2014 (t, Xi) = 0, dt\tp dxi\ndPi .\t.\t\u2014 dVi .\t.\n\u201cdf (t, Xi) + Y^dX\" (t, Xi) = 0,\ni = 1, 2,\n(B.2)\n(B.3)\nwhere t e [0, +to) is the time, Xi e (\u2014Xu, 0), x2 e (0, Xd), xu, Xd > 0, 7 is the adiabatic ratio, P is the pressure fluctuation, and V is the velocity fluctuation. The steady-state density and pressure are denoted by p and P, respectively. It is important to emphasize that in this work the steadystate density, pressure and velocity are assumed to be constant along the space. Furthermore, the steady-state values are considered the same for both compartments of the tube.\nThe initial condition is defined by\nVi(0, Xi) = Vi,o(Xi), i = 1, 2.\nPi'0- Xi) i,o(Xi),\nWe represent the interconnection between the downstream and upstream part of the system by the following algebraic relations, which can be directly obtained by linearizing the equations conservation of mass, momentum and energy across the heat zone x = 0,\nP2 (t, 0) - Pi(t, 0) = 0,\t(B.4)\n7P52(t, 0) - YPvi(t, 0) = YQ(t),\t(B.5)\nwhere A is the cross-sectional area of the tube and Q is the fluctuation of heat power released in the heater. Following [30], we assume that the fluctuation of heat power is expressed by the following ordinary differential equation (ODE)\n(t) = -Q(t) + hv vi(t, 0),\t(B.6)\nwhere thr is the heat release time constant and hv is the velocity-dependent heat transfer coefficient.\nMoreover, the system (B.2)-(B.3) is subjected to the following boundary conditions\nPi(t, -x\u201e) = u(t),\tP^2(t, xd)=0,\t(B.7)\nwhere u is the control input.\nRemark B.1. In [73] it was computed an explicit estimation for the Rayleigh integral (B.1) from the equations (B.2)-(B.7). The thermoacoustic oscillations amplitude grows if the acoustic energy stored in the tube increases in time average, i.e.,\nI-p(0)Q > P(L>(L) - P(0)v(0) + nLc (\t\" + Pv2(0) j , (B.8)\npc2\tA\t\\ pc2\t/\nwhere \u2022 is the mean value (in time) of its argument, nLc\t+ pv2(0)^\nis the Stokes layer, and n is the attenuation constant of the sound wave traveling along the tube.\nWell-posedness\nTo study the existence and uniqueness of the solution of system (B.2)-(B.7), we will introduce the characteristic coordinates. This result is presented in the following lemma, which can be easily proved by direct computation.\nLemma B.1. Consider the invertible linear transformation T : L2(0,1) x L2(0,1) \u2014> L2(0,1) x L2(0,1) such that\nThe transformed linear system from (B.2)-(B.3) is written as\n-df (t, Xi) +\t(t, Xi) = 0,\nd\u00a3i2 a x A d\u00a3i2 a x \u201e p/(t, xi) - AaX\u201c(t, xi) = 0,\ni = 1, 2,\n(B.9)\n(B.10)\nwhere A =\nThe initial condition is defined by\n\u00a3i1(0, xi) \u00a3i1,0(xi), \u00a3i2(0, xi) \u00a3i2,0(xi), i = 1, 2.\nThe boundary conditions (B.f)-(B.7) are given by\n\u00a321(t 0) = \u00a311(t, 0) +\n\u00a312(t 0) = \u00a322(t 0) +\n(t)\t' '-A p ..\n\u00a311(A xu)\t\u00a312(t, xu) I 2u(t),\n\u00a322(t, Xd) = -\u00a321(t,Xd).\nAv^c5(t),\nv (\u00a311(t0) - \u00a312(t,0)),\n(B.11)\n(B.12)\n(B.13)\n(B.14)\n(B.15)\nWithout loss of generality, it can be assumed that, by re-scaling the space variable, the two counterparts of PDE (B.9)-(B.15) evolve in the domain from 0 to 1. Indeed, define z = Xu+x for x e [\u2014xu, 0), and z = Xd-x for x e (0,Xd], and consider\nd = i xu dx\tif x e [\u2014J 0)\ndz\t1 \u2014 xd dx if x e (0,xd)\nThis leads to express the system (B.9)-(B.15) into\na?(/,z) + A a! \u00ab\u25a0 z) = \u00b0, C(0,z) = C0(z)\t(B.16) (B.17)\n\u00a321 (t, 1) = \u00a311(t, 1) +\tY^_Q(t), Av Pyp\t(B.18)\n1) = \u00a322(t 1) +\t,=\u2014 Ay Pyp\t(B.19)\nt dt (t) = Q(t)+2(\u00a311 (t, 1)\t\u00a312(t, 1)),\t(B.20)\n^1^ 0) = \u2014\u00a312(t 0) + 2U(t)\t(B.21)\n0) = \u2014\u00a321(t 0)\t(B.22)\nwhere z G [0, 1] is the re-scaled space variable, and\nC = (\u00a311, \u00a312, \u00a321, \u00a322^\nA = diag { - A/xq, A/x\u201e, A/xd, - A/xd} .\nIn the framework (B.16)-(B.22), the rijke tube mathematical model is represented by four transport PDEs evolving in the domain z G [0,1] and coupled at the boundaries.\nThe existence and uniqueness of the solution of system (B.16)-(B.22) can be proved by the method of characteristics, which enables us to restate the PDE as a set of classical ODEs. Then, if Co and u are continuously differentiable functions of their arguments and if Co and the boundary conditions verify conditions of C1 compatibility, one can show that the solutions of the system are continuously differentiable with respect to their arguments, i.e., C G C4([0, 1] x [0, to); R4). Moreover, based on a extension of [2], there exist M > 0 and n such that for any t G [0, to), any C G C4([0, 1]; R4) and any u(t) G L2([0, t]; R4) n C4([0, t], R4), there exists Kt such that\nllC(', t)|L2([0, 1];R4) + |Q(t) | \u2014 Me^ (||\u00a3q|Il2([0, 1];R4) + |(Q(0) |)\n+ Kt\nu(t)||\n2\n7\nTable B.1: Values of the parameters of the system.\nSymbol\tDescription\tValue\np\tDensity\t1.2 kg/m3\nP\tPressure\t105 N/m2\nV\tVelocity\t0.35 m/s\nY\tAdiabatic ratio\t1.4\nY\tY\u20141\t0.4\nL\tTube length\t1.3 m\nx0\tHeater position\t1L\nd\tTube diameter\t0.0762 m\nRu\tReflection coefficient\t\u20140.95\nRd\tReflection coefficient\t\u20140.95\nthr\tHeat-release time constant\t0.002\nhv\tVelocity-dependent heat transfer coefficient\t200\nB.3 Model validation\nThis section shows the validation results of the Rijke model (B.2)-(B.7) in the frequency domain. The model parameters used for the results are shown in Table B.1. They were based on the estimation made in [74].\nFigure B.3(a) shows the open-loop frequency response for the experiment described in Section B.1. For this experiment, the system was first brought to the unstable regime. Then, a feedback control law is turned on, and the test signal, in this case a sine sweep over the frequency range 100 \u2014 900 Hz, is added to the feedback signal. The microphone, positioned at xmic \u00ab 3j6L, records the sound pressure for the duration of the experiment (the data used here was collected over 20 s). Notice that with this experiment we will obtain the frequency response of the closed-loop system, but the open-loop frequency response can be recovered using some simple algebra. The open-loop frequency response of model (B.2)-(B.7) is depicted in Figure B.3(b).\nAs can be seen, by comparing Figure B.3(b) and Figure B.3(a), the model qualitatively capture the most important features of the real system: resonant peaks, a phase increase of 180 \u00b0 at the first peak for the unstabilized open loop, and phase drops of the same amount at the higher-order peaks. There remain however unknown parameters in G(s): overall gain due to the unknown conversion factors of speaker and microphone, the linear gain hv, time constant t and assumptions about friction, diffusive effects, and the stead upward flow. It should be emphasized however, that the real power\nof the model lies in the explaining the thermoacoustic stability with a very simple model.\n40\n20\n0\n-20\n-40\n100\t200\t300\t400\t500\t600\t700\t800\t900\n-180\n-540\n-900\n-1260\n-1620\n100\t200\t300\t400\t500\t600\t700\t800\t900\nFrequency (Hz)\n(a) Bode plot obtained by applying a sine sweep, over the range 100 \u2014 900 Hz, into the experimental plant.\n\u00a3 40 r\n'J' 20 -| o\u00ed i-20f ro -40 L\n100\t200\t300 400\t500\t600\t700\t800 900\no2 -180\n-540\n-900\nCL\n-1260\n\t\t\t\t\t\t\nJ\tX\tX\t\tV\t\t\t-\n-\t\t\t\t\u2014V.\t\t-\n100\t200\t300 400\t500\t600\t700\t800 900\nFrequency (Hz)\n(b) Bode plot of model (4.14).\nFigure B.3: Validation result: bode plot of the Rijke model and the experimental plant.\nAppendix C\nModeling of solar power plants\nThis appendix presents the solar thermal plan located at the CIESOL (Centro de Investigaci\u00f3n de la Energia Solar, in Spanish) building, a Solar Energy Research Center in the University of Almer\u00eda - Spain. In Section C.1, we give the description of this solar thermal plant and its control objective. The mathematical model of the system is described in Section C.2. Then, in Section C.3 the mathematical model is validated with real data from the real system.\nC.1 System description\nThe solar collector field used in this work is located at the CIESOL (Centro de Investigaci\u00f3n de la Energia Solar, in Spanish) building, a Solar Energy Research Center in the University of Almer\u00eda - Spain. The energy generated by the heat generation process is applied to an absorption cooling unit in order to obtain chilled water. More details about the CIESOL solar cooling process can be found in [75].\nBasically, the solar energy facility is composed of a solar flat collector field installed in the roof of the building, two tanks used for hot water storage, and a gas heater as auxiliary heat source. These elements are connected by a net of pipes, including three-way valves to modify the operation mode and a variable radial pump that allows to set the flow rate. Since the focus of this paper is the control of the outlet temperature of the solar collector field, just such subsystem is considered to be described in this work. The interested reader can found more details of the whole plant in [75].\nIts main purpose is to increase the temperature of the fluid to provide the desired outlet temperature in an operation range between 50 \u00b0C and 100 \u00b0\nFigure C.1: Solar field in CIESOL [75].\nAn inherent characteristic of the solar collector fields is the presence of resonance modes, producing unacceptable oscillatory behavior in the outlet temperature. This phenomena is excited, mainly, when fast rise time specifications of the control system or when there exist hard disturbances [76, 77].\nThe main disturbances are the inlet temperature variation, the ambient temperature and abrupt changes of the solar irradiance. The controlled variable is the mean outlet temperature of the solar collector field and the control variable is the fluid velocity/flow provided by the pump which flow range is 2.5 to 11 m3/h.\nC.2 Mathematical model\nThe modeling of the solar thermal system of the CIESOL building was firstly presented in [75]. The subsystem of the solar collector field has been modeled by two coupled hyperbolic PDEs, one for the collector plate and one for the thermal fluid (water).\nThe equation for collector plate takes into account the influence of solar irradiance and the thermal losses to the ambient and the fluid. It is defined\nas\ndT\nPm Cm Am\t(x, t) = q C I (t) - hi(Tm(x, t) - Ta(t))-\nDi n ht (Tm(x,t) - Tf (x,t)), (C.1) where Tm is the metal temperature, Tf is the fluid temperature, Am is the metal cross-sectional area, and Cm and pm are the metal specific heat capacity and metal density, respectively. The Global coefficient of thermal losses is given by hl, Ta is the ambient temperature, ht is the coefficient of metal-fluid transmission, Di is the inner diameter of the pipe line, I is the solar irradiance, and C and go are the mirror optical aperture and mirror optical efficiency, respectively.\nOn the other hand, the equation for the fluid temperature, considers the convection effect of the fluid flow, and the thermal transference produced between the collector plate and the fluid. The dynamic behavior of the fluid is defined as\ndTf\tdTf\nPf Cf Af ~df &amp; t) + Pf Cf qi(t)~dxft) =\nDi n ht (Tm(x, t) - Tf (x, t)) (C.2)\nwhere Af is the fluid cross-sectional area, Cf is the fluid specific heat capacity, pf is the fluid density and ql is the oil pump volumetric flow rate (control variable).\nBesides, the system has one boundary defined by the inlet fluid temperature:\nTf (0,t) = Tin(t).\t(C.3)\nwhere Tin is the inlet fluid temperature.\nC.2.1 Well-posedness\nWe admit the following assumptions for model (C.1)-(C.2):\nAssumption C.1. q, I, and Ta are restricted to the following sets:\nq(t) \u20ac\tQq = {q &amp; C 1([0,t];R)\t: 0&lt;\tqmin&lt;\tq(t)\t&lt;11, Vt > 0} ,\n1 (t) &amp;\tQI = {I &amp; C1([0,t]5 R)\t: 0&lt;\tImin&lt;\t1 (t)\t&lt;Imaxt V > 0} ,\nTa(t) &amp; QT = {Ta &amp; C1([0,t]; R) : 0 &lt;Ta,min &lt;Ta(t) &lt;T^max, 'Vt > 0} \u25a0\nThese assumptions are compatible with the physical characteristics of the solar power plant. They also ensure the well-posedness of the PDE. Indeed, applying the method of characteristics into (C.1)-(C.2), we can restate the PDE as a set of classical ODEs. Then, given a C1 initial condition p : [0, L] R2 that verifies the conditions of C1 compability, the system must be well-posed, according to Theorem 2.2.\nC.3 Model validation\nThe model calibration was performed by comparison of the real data with the simulations response obtained using estimated parameter values. These parameters values (see Table C.1) were determined by a genetic algorithm fitting the ISE (integral of squared error) criterion. For more details about the model calibration and validation procedure the interested reader is referred to [75].\nFigure C.2 shows the outlet temperature of the model compared to real experimental data.\nAs can be seen in the upper graphic of Figure C.2 The initial temperature transient of the model and real system shows a significant difference due to the fact that is very hard to know the initial temperature profile of tube and fluid. But, after the initial transient, the model tends to the real system temperature with a maximum discrepancy of \u00b12 \u00b0C.\nTable C.1: Solar plant model parameters [75].\nSymbol Description\t\tValue and units\nL\tSolar collector field length\t18.29 m\nPm\tMetal density\t1100 kg/m3\nPf\tFluid density\t1000 kg/m3\nCm\tMetal specific heat capacity\t440 J/(K kg)\nCf\tFluid specific heat capacity\t1100 j/(K kg)\nA m\tMetal cross-sectional area\t0.0038 m2\nAf\tFluid cross-sectional area\t0.0013 m2\nno\tMirror optical efficiency\t0.67\nG\tMirror optical aperture\t0.9143 m\nhi\tGlobal coefficient of thermal losses\t20.773 W/(m2 K)\nht\tCoefficient of metal-fluid transmission\t1283.2 W/(m2 K)\nDi\tInner diameter of the pipe line\t0.04 m\nDo\tExternal diameter of the pipe line\t0.07 m\n75\n70\n65\n60\nCL\n55\n50\n_\t\u2014 Outlet temperature - real\t\t\t\t\n\tOutlet temperature - model\t\t\t\t\n_\t\u2014 Volumetric flow\t\t\t\t\nq_\t\t\tr__.\t\n\t\t\t\t-\n12\n10\n8\n6\n4\n2\nTemperature (\u00b0C)\tVolumetric flow (m3/h)\nthe\nFigure C.2: Validation results: simulated and experimental data of outlet temperature as a function of solar radiation and volumetric flow.\nAppendix D\nModeling biomass production in outdoor tubular photobioreactors\nThis appendix describes the biomass production process of the outdoor tubular photobioreactor located at Las Palmerillas Experimental Station, property of Cajamar fundation, in Almeria-Spain. In Section D.1, we briefly describe this tubular photobioreactor. Its mathematical model is presented in Section D.2. In this work, the mathematical model is formed of two interconnected compartments: a bubble column and a solar receiver. Each of this compartments is described by a set of mass balances for the liquid and gas phase. Simulation results validating the model with real data from the system are shown in Section D.3.\nD.1 System description\nThe photobioreactor used in this work for the design of control strategies is based on a tubular photobioreactor located at Las Palmerillas Experimental Station, property of Cajamar fundation, in Almeria-Spain. This photobioreactor is located inside a greenhouse where the Scenedesmus almeriensis microalga is cultivated. This kind of microalga is characterized by a high growth rate, withstanding temperature up to 45 \u00b0C and pH values up to 10 [78].\nA general scheme of the plant is depicted in Figure D.1, showing the main components: (i) the external loop and (ii) the bubble column.\nThe external loop is made of transparent tubes with 0.09 m diameter\nFigure D.1: A schematic view of a tubular photobioreactor at Las Palmeri-llas experimental station, Almeria-Spain.\nand joined into a loop configuration to obtain a total horizontal length of 400 m, with a capacity of 2200 L. The objective of the external loop is to increase the surface exposed to the sun in order to the microalgae capture a larger amount of radiation and perform photosynthesis. Moreover, CO2 in gas phase is injected at the beginning of the loop to provide the inorganic carbon to growth and to control the pH of the culture.\nThe bubble column is 3.25 m high and 0.5 m in diameter, with a capacity of 400 L, and performs several functions. On one hand, it is used for mixing the culture and desorption of O2 produced during the photosynthesis by air injection at a flow rate of 140 L/min. On the other hand, nutrients are also added in the column and the biomass harvesting is performed in this part of the process. The culture is continuously recirculated between the loop and the column using a pump located in the bottom of the column. The culture medium composition is shown in Table D.1. Furthermore, the culture is operated in nutrient-sufficient conditions: nutrients are ever at concentrations not limiting the growth.\nTable D.1: Composition of the culture medium used in the tubular photobioreactor. _______________________________________\nComponent\tConcentration [mmol/L]\nCa(NOs)2\t7.92\nKH2PO3\t2.45\nMgSO4\t2.71\nFe-EDTA\t4.8190x10-3\nZn-EDTA\t6.566x10-4\nMn-EDTA\t3.8647x10-3\nCu-EDTA\t2.829x10-4\nMo\t6.949X10-4\nB\t2.15850X10-2\nThe pH, temperature, and dissolved oxygen are measured with Crison probes at several points of the solar receiver of the photobioreactor: three positions for dissolved oxygen, five positions for pH and temperature. These measurements are well distributed along the tube. The biomass concentration is estimated from a turbidity meter located at the bubble column. Moreover, liquid and gas flow rates are measured using digital flow meters. All these measurements are connected to a control computer through a data acquisition device NI Compact FieldPoint.\nThe pH control problem in tubular photobioreactors deals with keeping the outlet pH of the external loop at a desired reference value in spite of disturbances. For this microalga specie, the optimal pH reference value is 8 [63].\nThe pH behavior in a microalgal culture is mainly influenced by two phenomena. On one hand, the intake of CO2 as nutrient causes the formation of carbonic acid, leading to a decrease in the pH of the culture. On the other hand, when the microalgae perform the photosynthesis they consume CO2 and generate O2 , causing an increase in the pH. The provided CO2 is transferred to the culture medium as a function of mass transfer coefficient in the system. Remaining fractions of injected CO2 produce an oscillatory behavior in the measured pH, because of the continuous recirculation of the culture, until its total elimination.\nThe main system disturbances are the medium injected to perform the biomass harvesting, which introduces total inorganic carbon to the culture, and thus decreasing the pH value, and solar irradiance changes, caused by the solar cycle and presence of clouds, producing changes in the rate of photosynthesis and thus in the rise of pH. The control variable is the CO2 flow/velocity provided by a valve, located at the beginning of the loop (see\nFigure D.1), which flow range is 0 to 5 L/min.\nD.2 Mathematical model\nThe microalgal culture is a two-phase system and it is formed of two interconnected compartments: a bubble column and a solar receiver. In the liquid phase, biomass, dissolved oxygen and total inorganic carbon concentrations mass balances are considered, while the gas phase takes into account the mass balance of carbon dioxide and oxygen molar fraction. The dynamic model of microalgal production of photobioreactors was previously developed and described in [40, 64, 79]. The photobioreactor used in this work operates under atmospheric pressure, in which no significant overpressure existing in whatever place of the reactor. The flow is assumed to be one-dimensional. The reactor operates under controlled temperature conditions. The variation of temperature along the solar receiver is lower than 1 \u00b0C and ranging from 20 to 28 \u00b0C along the daily cycle, thus no large changes taking place. For this reason, the temperature balance is not considered in this work. In the following, the photobioreactor model is briefly described.\nD.2.1 External loop mathematical model\nThe biomass mass balance is directly dependent on the photosynthesis rate, thus the equation for the biomass concentration is expressed as\ndC\tdC\n-C-(x, t) + Vi (t)-C(x, t) = P02 (x, t)C-(x, t)Yp/x,\n(D.1)\nwhere t G [0, +to) is the time, x G [0, L] is the space, Cb is the biomass concentration, Yp/x is the biomass yield coefficient produced by the oxygen unit mass, V) = Qi/(A(1 \u2014 e)) is the liquid velocity, A is the cross-sectional area of the tube, e is the gas hold-up and Ql is the volumetric flow rate of liquid. The oxygen production rate per biomass mass unit is given by\nPO2 (x, t)\np\tTn\nP O2 max laV\nK \u25a0 m + Inv\n-C1\n^B1e( pJ-(x,\u2018)) \u2014 B2e( pH(x-t> )) \u2014 rPO2 max,\n(D.2)\n*\nwhere Kq2 is the oxygen inhibition constant, [O2] is the dissolved oxygen concentration, Pq2 max is the maximum photosynthesis rate for microorganisms under the culture conditions, Bi and B2 are preexponential factors,\nCi and C2 are the activation energies, r is the respiration factor, and /v,., m and z are form parameters. The average solar irradiance Iav is given by the following expression:\n(D.3)\nwhere I0 is the solar radiation on an obstacle-free horizontal surface, Ka is the extinction coefficient and dt, i is the external loop tube diameter. Notice that the solar radiation is modulated by a factor al, which represents the solar radiation fraction available in the particular area of the reactor.\nRegarding the dissolved oxygen, this is related to the gas-liquid mass transfer rate and the photosynthesis rate as\n+ Klal,o2 (x, t)([O2](x, t) - [O2](x, t)), (D.4)\nwhere MO2 is the molecular weight of oxygen, Kiai,o2 is the volumetric gasliquid mass transfer coefficient for oxygen, [O2 ] = HO2 PTyO2 is the oxygen equilibrium concentration with gas phase, HO2 is the Henry's constant for oxygen, PT is the total pressure, and yO2 is the oxygen molar fraction in the gas phase.\nThe mass balance of the total inorganic carbon concentration is written in a similar way to the dissolved oxygen balance as\n+ Klal,cO2 (x, t)([CO2](x, t) - [CO2](x, t)), (D.5)\nbeing [CT] the total inorganic carbon concentration, Kt ai ,CO2 is the mass transfer coefficient for CO2, PCO2 = \u2014PO2 is the carbon dioxide consumption rate, [CO2] = HCO2PTycO2 is the dioxide carbon in equilibrium with the gas phase, HCO2 is the Henry's constant for carbon dioxide, [CO2] is the dissolved carbon dioxide and ycO2 is the carbon dioxide molar fraction in the gas phase.\nThe gas phase is made of CO2 and O2 molar fractions. The mass balance for carbon dioxide molar fraction is described as\n~ (x, t) + Vg (t) dyCO' (x, t) =\n\u2014 4^(1 \u2014 \u00a3(x, t))Kiai,CO2([CO2](x, t) \u2014 [CO2](x, t)), (D.6) \u00a3 ( x, t )\nwhere Vg = Qg/(Ac) is the gas phase velocity (control variable), Qg is the volumetric flow rate of the gas, and Vmoi the molar volume.\nFor the oxygen, an analogous mass balance can be established\ndyo2\ndt\n(X, t) + Vg (t)\n(X t) =\n-\t- \u00a3(x t))K\u2018a\u2018O2t) - t)).\n(D.7)\nThe boundary conditions for model (D.1)-(D.7) are given by\nCb(0,t) = Cb,\u00b0ut(t), lCO2 (0,t) = lCO2 in (t)\n[O2](0,t) = [O2]\u00b0ut(t),\t[CT](0,t) = [Ct ]\u00b0ut(t),\nyCO2 (0, t) = yCO2 in (t)\t(D.8)\nwhere Cbout, [O2]out and [CT]out are the biomass, dissolved oxygen and total inorganic carbon concentration at the outlet of the bubble column, respectively. These values are obtained from the bubble model described in Section D.2.2. yco2 in and yO2 in are the injection of molar fraction of CO2 and O2, respectively.\nEquations (D.1)-(D.7) describe the photobioreactor state equations. In addition, a relationship between the total inorganic carbon concentration and the dissolved carbon dioxide in the culture is also needed for system closure. Such relationship is described as follows.\nIn microalgal cultures, the changes in pH are due mainly to consumption of carbon dioxide; pH variations due to consumption of other nutrients and degradation of excreted metabolites can be neglected [80]. As dioxide carbon in gas phase dissolves in the media, it breaks down into different species, namely dissolved dioxide carbon, CO2, carbonic acid H2CO3, bicarbonate, HCO\u2014, and carbonate CO((-. This chemical process can be described as follows. First, CO2 reacts with water to yield carbonic acid\nCO2 + H2O\tH2CO3.\t(D.9)\nH2CO3 is a weak acid and it dissociates, yielding HCO-,\nH2CO3\tH+ +HCO-.\t(D.10)\nThe reaction equilibrium (D.10) can be described by an equilibrium constant Ki, expressed as\n[HCO-][H +] [CO2]\n= 10-6.381\n(D.11)\nThe HCO3- that is produced will further dissociate as\nHCO- H+ + CO3-\n(D.12)\nThe dissociation (D.12) can also be described by a second equilibrium constant, K2, such that\nK2 =\n[CO3-][H +] [HCO-]\n10.377\nFinally, the water dissociates according to\nH2O OH- +H+,\nwhich is described by the following equilibrium constant\nKw = [OH-] \u2022 [H+] = 10-14.\n(D.13)\n(D.14)\n(D.15)\nThe [H+] concentration is generally given as a pH value, defined as the negative logarithm, pH= \u2014 log10[H+].\nThe total inorganic carbon is equal to the sum of inorganic carbon species,\n[Ct ] = [CO2] + [HCO-] + [CO3-].\t(D.16)\nCombining (D.11), (D.13) and (D.16), it is obtained\n[Ct] = (* + A + KK2) [CO2]'\t(D'17\u2019\nd[Ct] =\t(.\t+\tK1\t+\tK1K2)\td[CO2]\t(\tK1\t+\t2K1K2)\t[CO ] d[H+]\ndt v\t[h+] + [h+]2; dt\tv [h+]2 + [h+]3 ;\t2 dt\n(D.18)\nIn addition, the following electroneutrality constraint must be satisfied\nd[H+]\td [Cat+]\ndt + dt\nd [OH-] + d[HCO-] + 2 d [CO|-] + d [An-] dt + dt + dt + dt .\n(D.19)\nAssuming constant concentrations of cations, [Cat+], and anions, [An ], equation (D.19) is rewritten as\nd [H+ ] =\t[k+] + -tf+f\td[CO2]\ndt 1 I Kw + K1[c\u00b02] + 2 K1K2\tdt\n1+ [H+]2 + H +\t+2 H +\n(D.20)\nThe boundary conditions for [H+] and [CO2] are given by\n[H+](0,t) = [H+]out(t),\t[CO2](0,t) = [COO),\t(D.21)\nwhere [H+]oui and [CO2]out are the concentrations of [H+] and [CO2] at the outlet of the bubble column, respectively. These values are obtained from the equations of the bubble column, presented in Section D.2.2.\nIf the chemical equilibria between the different forms are disturbed - as when dioxide carbon is added to the culture, removed in photosynthesis, or vented to the air - the reaction will shift one way or the other in an attempt to reestablish equilibrium. For example, when CO2 is added to the system the H+ increases following the production of H2CO3, as can be seen in (D.9) and (D.10). So, the pH decreases and consequently the total inorganic carbon rises. Conversely, when CO2 is removed during photosyntheis or lost to the air by diffusion, the reactions shift to the left in (D.9) and (D.10). The H+ concentration declines, but the COi(- concentration slightly rises, preventing a rise in pH and a decrease in the total inorganic carbon concentration.\nFigure D.2 shows the distribution of the forms of inorganic carbon in the photobioreactor with changes in pH in steady state. Note that at pH 6.5-10.5, bicarbonate is the most abundant form. CO2 dominates at low pH, while carbonate dominates at high pH values.\nAs can be noted, if the pH is at an equilibrium point, so the total inorganic carbon, with its inorganic carbons species, is at equilibrium too. In\nFigure D.2: Distribution of the forms of inorganic carbon in the photobioreactor with changes in pH.\nthe case treated in this thesis, carbon consumed by microalgae is compensated by supplying CO2 to maintain pH and, as a consequence, a desired level of inorganic carbon is achieved. Based on this hypothesis, in this work the total inorganic carbon is used as output variable to control the pH.\nIn sum, the tubular photobioreactor model is given by equations (D.1)-(D.8), (D.18) and (D.20)-(D.21), which can be written in the following compact form\ndz\tdz\n- + A(z(x, t)) \u2014 = G(z(x, t)),\nz(0, t) = ^(t),\n(D.22)\nwhere z = [C [O2] [Ct] [CO2] [H+] yco2 yo2 ]T, A is a 7 x 7 matrix and G is a vector function.\nD.2.2 Bubble column mathematical model\nFor the bubble column, a similar formulation can be applied taking into account several considerations [79]. Moreover, the dilution process must be added to the liquid phase balances. Then, for the biomass concentration the following mass balance can be established:\nVliqc(t) dCbOut (t) + Qiiq,c(t)(Cb,out(t) \u2014 Cb,in(t)) =\nVliq,c(t)Po2 (t)Cb,OutYp/x \u2014 Qm(t)Cb,Out(t), (D.23)\nwhere the subscript c refers to the bubble column, Cb,in is the inlet biomass concentration (solar receiver output), Vliq,c is the liquid volume in the column and Qm is the volumetric flow rate of culture medium. The oxygen production rate per biomass mass unit, PO2 is calculated in the same way as the external loop, which is given by (D.2)-(D.3).\nIn the case of the total inorganic carbon, the relationship between the inlet medium [CT]m and the outlet overflow is included in the mass balance, resulting in\nVliq,c(t) [ dtOUt (t) + Qliq,c(t)([CT]out(t) \u2014 [Ct]in(t)) =\nViiq,c(t)PCO2 (t)Cb,out(t) + Vliq,c(t)Klal,CO2c(t)([CO2*](t) \u2014 [CO2](t))lm \u2014 MCO2\nQm(t)([CT ]m \u2014 [Ct ]out (t)),\t(D.24)\nwhere [CT]in(t) is the total inorganic carbon at the inlet of the bubble column. The mass transfer coefficient for CO2 in the bubble column is\ndefined as Kiai,co2c, [CT]m is the inorganic carbon concentration in the culture medium, and (\u2022 )lm is the logarithm mean driving force.\nRegarding the dissolved oxygen, a similar procedure is evaluated to obtain the following mass balance:\nd[O2]out dt\n(t)+Q iiq,c(t)([O2]out(t) \u2014 [O2]in(t)) \u2014 +Viiq,c(t)\nPq-2 (t)[Cfe]OMt (t)\nMq2\n+ Viiq,c(t)Kiai,Q2c(t)([O^](t) \u2014 [O2](t))im \u2014 Qm(t)([O2]m \u2014 [O2]out(t)),\n(D.25)\nwhere [O2]in(t) is the oxygen concentrations in the liquid phase at the inlet of the bubble column. Klal,O2C is the volumetric gas-liquid mass transfer coefficient for oxygen in the bubble column, and [O2]m is the dissolved oxygen in the culture medium.\nRegarding the gas phase, the mass balance for the O2 to N2 molar ratio for the bubble column is described by\nVgas,c (t)\t(t) + FN2C\t(Yo2,out (t) - Y02,in(t)) =\ndt\tVn2,c\n- Vliq,c(}Vmol Kiai,o2c(t)([O2](t) - [O2](t))im, (D.26) yN2>c\nwhere Vgas,c(t) is the gas volume of the column, and yN2C is the nitrogen molar fraction in the bubble column. The O2 to N2 molar ratio in the gas phase is defined at the inlet, YO2in, and outlet, YO2 OUt, of the bubble column.\nThe carbon dioxide to nitrogen molar ratio is regarded as the following mass balance:\nVgas,c (t) dYC00t2\u2019\u00b0Ut (t) + F\t(Ya02,out (t) - YcO2,in(t)) =\ndt\tt\n- Vliq,c(t}Vmol Kiai,co2c(t)([CO2*](t) - [CO2](t))im,\t(D.27)\nyN2,c\nwhere YCO2 in and YCO2 out is the carbon dioxide to nitrogen molar ratio in the inlet and outlet of the bubble column, respectively. The relationship between the molar fraction and the molar ratio is known to be defined as\nY y = 1+ Y'\nAs well as the mathematical model of the solar receiver, a relationship between the total inorganic carbon and dissolved carbon dioxide in the\nbubble column must be established. This result in the following equations:\n-[Ct ]out\n-t\n(t)\t(1+[H+U(t) + [H+ ]2ut(t)\n[C\u00b02]o\u00abi(t) f [h+]2 (,) ._______\nVH ]out(t)+ [H+]|ut(t)\nKi\nK1K2\t-[CO2]out (t)_\n-t ()\n-[H+ ]out (t),\t(D.28)\n-t\nKi\n2K1K2\n-- ' 1 3\nand\n-[H +]\nKi\n___________.\t2K1K2\n[H+ ]o\u201et(t) ' H+]|\u201et(t) Kw :o\u201et(t)\nout\n-t ( ) = 1 I\tKw\t. Ki[CO2]o\u201et(t) . 2 K1K2\n1+ H+]2\u201et(t) ' H+]2\u201et(t)\t12 H+]|ut(t)\n-[CO2] out (t)\n-t ().\n(D.29)\nEquations (D.23)-(D.29) can be rewritten as\n- E\n(t) = ^(E(t)) + B(E(t))Qm(t),\n(D.30)\nwhere E [Cb,out [Ct]out [O2Ut Yo2<out Yao2,out [CO2] [H +]]T is the state vector, and ^(E(t)) and B(E(t)) are vector functions with appropriated dimensions.\nD.3 Model validation\nThe calibration and validation of the system were performed by comparison of the real data with the simulation responses obtained using estimated parameter values. These parameter values (see Table D.2) were determined by an optimization algorithm which minimizes the ISE (Integral of Squared Error) criterion [40, 64].\nTable D.2: Photobioreactor model parameters [40, 64].\nParameters\tDescription\tValue and units\nAc\tCross-sectional area of the column\t0.1257 m2\nAi\tCross-sectional area of the loop\t0.0055 m2\nBi\tPreexponential factor\t2.4098\nB2\tPreexponential factor\t533.009\nCo\tDrift flux model parameter\t0.996\nCi\tActivation energy\t6.2684\nC2\tActivation energy\t68.8062\n[CT ]m\ttotal inorganic carbon in medium\t8 mol/m3\nTable D.2 - (continued)\nParameters\tDescription\tValue and units\ndt,c\ttotal column diameter\t0.4 m\ndt,l\ttotal loop diameter\t0.084 m\nHco2\tHenry's const. for carbon dioxide\t38.36 mol/ (atm m3)\nH02\tHenry's const. for oxygen\t1.07 mol/ (atm m3)\nKa\tExtinction coefficient\t133.0324 m2/ kg\nKCO2,c\tTransfer coeff. const. for CO2 in column\t0.91\nKco2,i\tTransfer coeff. const. for CO2 in solar receiver\t0.91\nK02,c\tTransfer coeff. const. for O2 in column\t0.91\nKo2,l\tTransfer coeff. const. for O2 in solar receiver\t0.91\nKi\tForm parameter\t173.9504\n\t\t^E/(m2 s)\nK02\tOxygen inhibition constant\t0.7202 mol/ 3\nLc\tLength of column\tm 3.2 m\nLi\tLength of loop\t400 m\nm\tForm parameter\t0.0015\nMCO2\tMolecular weight of CO2\t32 g/mol\nM02\tMolecular weight of O2\t44 g/mol\nn\tForm exponent\t0.9779\n[O2]m\tDissolved oxygen in medium\t0.2812 mol/m3\nPo2,max\tMaximum photosynthesis rate\t4.37 x 105 kg of O2/(kg s)\nPT\tTotal pressure\t1 atm\nr\tRespiration factor\t0.01\nR\tgas constant\t8.31 J K/mol\nSc\tColumn area\t4.0212 m2\nYo/x\tBiomass yield coefficient\t0.9713 kg of O2\nz\tForm parameter\t5.4333\nac\tDistribution solar factor for bubble column\t0.1052\nai\tDistribution solar factor for solar receiver\t0.9725\nDO solar receiver - model \u201c \u201c DO column - model O DO solar receiver - real \u25a1 DO column - real ~ 400\n-o S\n> p\n200\nS oj 1\n0\n0\t5\t10\t15\t20\t25\t30\t35\t40\t45\n9\n8\nI\nQ.\n7\npH solar receiver - model\tpH solar receiver - real\n\n20\n25\n30\n35\n40\n45\n1.25\nE\n\"ft\n0.75\n0.5 -\n0.25 L\n0\n20\n25\n30\n35\n40\n45\nCO2 injection\nMedium injection\n\u2022g 2 1\n\u2022| 0 \u25a0 0\n10\n15\n20\nMJ\n25\n30\n35\n40\n45\n10\n8\n6\n4\n2\n0\n1500\nf.\n1000 -\n500 -\n-L\n5\n\u2014I\u2014\n20\nU\n25\nu\n30\n35\t40\n\u2014i\n45\n6 L\n0\n5\n1\n6\nE\n4\n0 -\n0\n5\n5\nTime (h)\nFigure D.3: Validation results: simulated and experimental data of dissolved oxygen (DO) concentration, pH, and biomass concentration as a function of CO2 injection and solar radiation.\nFigure D.3 shows the results for the validation process. For the validation procedure we considered the photobioreactor operating in continuous mode with a dilution rate of 0.34 L/day, circulation velocity of 1 m/s and volumetric flow of 140 L/min at the bubble column. Regarding CO2 injections, a sequence of pulses were used, adapting its amplitude and weight according to the period of day to keep the pH value in an appropriate and secure range.\nThe mathematical model reproduces the system dynamics with a mean error of 4.7 % for the dissolved oxygen measured at the output of the external loop, and a mean error of 5.4% for the dissolved oxygen measured at the output of the bubble column. On the other hand, the mean error between the real pH and the simulated pH was 1.4% at the output of the external loop. These results show that the mathematical model reproduces the system dynamics for these operating conditions.\nAppendix E\nOptimization of biomass production in outdoor tubular photobioreactors\nIn this appendix we are concerned with microalgal biomass production optimization in outdoor tubular photobioreactors. The main purpose of such optimization system is to calculate the culture medium flow rate in order to maximize the biomass production over a determined period of time. Two different methods are proposed in this work: (i) an optimal and (ii) a near-optimal strategy. Simulation and experimental results allow the user to evaluate the effectiveness of the biomass production optimization strategies proposed, compared with a classical harvesting strategy. The appendix is organized as follows. In Section E.1 we describe the photobioreactor optimization problem. Section E.2 outlines the optimal biomass production strategy. The near-optimal strategy is shown in Section E.3. Simulation and experimental results obtained with the proposed optimization strategies are shown in Section E.4.\nE.1 The photobioreactor optimization problem\nWe consider the optimization of the biomass long term production under the influence of day/night cycles. This optimization problem consists to find the time evolution of the culture medium flow rate, maximizing the total quantity of biomass produced and diluted out of the reactor, over a period of time. The photobioreactor used to test the optimization methodology is located at Palmerillas Experimental Station, property of CAJAMAR\nfoundation (Almer\u00eda, Spain). The description of this system is given in Appendix D.\nA steady state analysis of the dynamic model presented in Appendix D shows that QmCb,out = Vliq,cPO2 Cb,outYp/x I Q liq,c(Cb,in Cb,out)j in which the term (Cb,in - Cb,out) can be considered zero, since in the steady-state regime, the biomass concentration at the inlet and outlet of the bubble column is the same. Therefore, maximizing ,Qm Cbout, amounts to maximizing PO2 Cb,outYp/x which is the biomass productivity and is a concave function for Cb,out. It follows that the solution of\n(PO2 Cb,outYp/x) =\ndCb,out\nfor Cb,out is the optimal biomass concentration, C out, and Q*m = Vliq,cPO2 x Yp/x yields the optimal medium flow rate. Note that PO2 Cb,outYp/x is increasing for Cb,out &lt;Cb,out and decreasing for Cb,out > Cb,out. Also note that PO2 is a function of Cb,out (see Appendix D).\nIn a constant light environment, the optimal medium flow rate, Qm , computed above is a positive constant value since the photosynthesis rate is always greater than the respiration rate, i.e., the therm rPO2 max in (D.2). In this case it is possible to attain an instantaneous biomass output flow optimization. However, in an environment with varying light it is not possible to settle the medium flow rate for an instantaneous productivity optimization. For example, during the night there is no algal growth, only respiration (see (D.2)), so that harvesting during this period would result in loss of biomass. For these systems, the photobioreactor operating in the long term must be considered to solve the biomass production optimization problem [81]. This is the case for the outdoor tubular photobioreactor studied. Hence, the next sections are dedicated to present an optimal and a near-optimal strategy to solve the biomass production optimization problem for outdoor tubular photobiorectors.\nE.2 Optimal control for biomass production\nThe objective of the optimal control strategy is to find the time evolution of the culture medium flow rate, Qm , that maximizes a given cost function J. This cost function considers the daily biomass production, that is, the biomass produced and diluted out of the reactor over the period of one day. Let tf = 24 h be the period of time, then the following optimal control\nproblem is obtained\n(E.1)\n(E.2)\nrf\nmax J(Qm(t)) = max\tD(Qm(t))Cb,out(t) dt,\nQm(t)\tJ 0\nsubject to\ndE\n-dt (t) = ^(E(t)) + B(E(t))Qro(t),\nan\td H\n(x, t) + A(H(x, t)) \u2014 (x, t) = ^(H(x, t)), (E.3)\nH(to, x)= H0(x), E(to) = E0,\n0 &lt;Qm(t) &lt;10,\nCb,out(t f ) = Cb,out(t0),\n(E.4)\n(E.5)\n(E.6)\nwhere D = is the dilution rate, being V)iq = Vliql + Vliqc, and H0(x) and E0 are the initial conditions for the solar receiver and bubble column model, respectively. The term D Cbout represents the biomass productivity. Constraint (E.5) refers to valve operating conditions (the valve flow range goes from 0 to 10 L/min), while the terminal constraint (E.6) is included to guarantee the same operating point of the photobioreactor every day.\nTo solve the optimal control problem (E.1)-(E.6) there are basically two methods: (i) the Pontryagin\u2019s maximum principle and; (ii) direct methods (numerical optimization). When the mathematical model involved is not complex, the Pontryagin\u2019s maximum principle is straightforward to be used and analytic solutions can be provided. However, when the system is complex, as the case treated here, it should be hard to derive explicit solutions. Hence, methods based on numerical optimization are more suitable for these cases.\nThe numerical optimization scheme used in this work is based on the control parametrization concept [82]. In this technique, the control variable, Qm, is discretized in M constant piece-wise values along the control horizon [t0, tf], such that Tk \u20ac [t0, tf], k = 1, .. ., M, is the mesh or grid points with\n<0 = T1 &lt;... &lt;Tm-1 &lt;Tm = tf.\n(E.7)\nThe discretization (E.7) is assumed to be equidistant for the sake of simplicity, where\nh ~ M - 'I, Ti = t0 + (i \u201c 1)h, i = 1,M.\t(E.8)\nTherefore, the control vector in the grid points, is defined as\nU = [Qm(1) Qm(2) \u2022\u2022\u2022 Qm(M )]T .\t(E.9)\nBesides the control variable discretization, the photobioreactor mathematical model (D.22) and (D.30) must also be discretized. The discrete approximation used in this work implies in a finite difference Euler scheme for time and space. The spatial partial derivative, in a given time instant, is approximated by\ndH (\tH(j, t) - H(j - 1,t)\ndx (X\u2019 )\tAx\nwhere Ax = L/S is the spatial derivative discretization length, being S the number of points, and j = 1, 2,..., S the j-th spatial volume.\nRegarding the time derivative, we use the following approximations for (D.22) and (D.30):\ndH (\tH(j, k + 1) - H(j, k)\ndt (x )\th\ndE (t) = E(k + 1) - E(k). (E.U) dt\th\nNote that using the time and spatial derivative approximations (E.10)-(E.11), the models (D.22) and (D.30) are transformed into discrete algebraic expressions. For sake of simplicity, the discrete algebraic expressions of (D.22) and (D.30) are written in a compact form as\nX (k + 1) = X (k) + $(X (k), Qm(k)),\t(E.12)\nwhere\nX \u25a0 = (HE(,kk)) \u25a0\nA(H(j, k))\"\tk) -AHx(j - 1 k) + ^(H(j, k))\n^(k)(E(k)) +xB(E(k))Qm(k)\nConsider the optimization variables\nz A [X(1) X(2) ... X(M) Qm(1) Qm(2) ... Qm(M)]T e RNz,\n(E.13)\nwhere Nz = (8S + 8)M.\nThe optimal control problem (E.1)-(E.6) is replaced by the following discretized control problem in the form of a NLP problem with equality\nand inequality constraints\nM\nmax J(z) =maxY' D(Qm(k))Cb,out(k)\nz\tz '\nk=1\nsubject to\nX (k + 1) = X (k) + $(X (k), Qm(k)),\nX (0) = e0,\n0 &lt;Qm(k) &lt;10,\nCb,out (M) = Cb,out(0),\t(E.14)\nwhere \u00a30 = [H0(j) E0]T, j = 1, 2,..., S, is the initial condition of (E.12).\nNote that problem (E.14) has a large number of optimization variables, (7S + 8)M, and constraints, (7S + 10)M + 1. Even so, this problem can be efficiently solved if the sparse structure of the Jacobian and the Hessian of the associated Lagrangian are taking into account [82-84].\nNevertheless, the dimension of (E.14) can be reduced if the control variable is treated as the only optimization variable, while the state variables are obtained recursively from the state equation. This approach is called recursive approach [83]. Using the recursive approach, the optimization variables are rewritten as\nz = [Qm (1) Qm(2) ... Qm(M )]T G RM,\t(E.15)\nand the state variables from (E.12) are computed recursively as functions of the control variable with initial condition X(0) = \u00a30. In this context, we obtain the following biomass production maximization problem:\nM\nmax J(z) =ma^y D(Qm(k))Cb,out(k) zz k=1 subject to 0 &lt;Qm(k) &lt;10, Cb,out(M) = Cb,out(0).\t(E.16)\n\t(E.17) (E.18)\nProblem (E.16)-(E.18) results in a dense structure in the Hessian of the Lagrangian, since the number of optimization variables were reduced and 50% of the elements in the Jacobian of the constraints are zero [84]. In this work, we use the SQP algorithm to solve this problem [83, 85].\nThe SQP algorithm is an iterative algorithm for nonlinear programming. At each step, a quadratic sub-problem based on a second-order\nTaylor approximation of the Lagrangian function of problem (E.16)-(E.18) and the linearization of the cost function (E.16) with respect to the constraints (E.17)-(E.18) is solved. The solution of the quadratic sub-problem is then used to obtain the search direction where the cost function is maximized. Moreover, to enforce convergence from any initial point, a line search method with a merit function is used.\nThe interested reader can find convergence results of approximations to optimal control problems in [86]. In next subsections it is stated the first-order necessary conditions and second-order sufficient conditions for optimality of (E.16)-(E.18).\nE.2.1 First-order necessary Conditions for optimality\nConsider the final constraint (E.18) expressed as\n(XM ) = Cb,out(M) \u2014 Cb,out(0) = 0\t(E.19)\nand the box constraint (E.17) rewritten as two inequalities constraints given by\ng(Q\u2122(k))=( Qm(kl(fc)1<=0^) , for k = V..,M.\t(E.20)\nThen, the Lagrangian function for the NLP problem (E.16)-(E.18) can be introduced as\nM\nL(z, PM, A) = J(z)+ PM$m (Xm) +\t(A(k))T g(Qm(k)), (E.21)\nk=1\nwhere L : X xRxR2M\tR, pM e R, A(k) G R2, A = (A(1) ... A(M))T g\nR2M.\nThe first-order necessary condition of optimality for the problem (E.16)-(E.18) are given by the KKT conditions, since (E.16)-(E.18) is a finitedimensional nonlinear mathematical program. This conditions are given by\nVL(z, pm, A) = 0,\t(A(k))T g(Qm(k)), k = 2, ..., M \u2014 1, (E.22)\nwhere the subscript z denotes the partial derivative with respect to z.\nE.2.2 Second-order sufficient conditions for optimality\nIn this section, second-order sufficient conditions for optimality of problem (E.16)-(E.18) are shown. Consider the following notation\nG(z) = (G1(z), ...,GNc(z)),\t(E.23)\nwhere G(z) is the collection of functions defining the equality and inequality constraints (E.17)-(E.18), and Ne = 1, and Nc = Ne + 2M.\nThen, problem (E.16)-(E.18) is rewritten as\nM\nmax J(z) =max V D(Qm(k))Cb,out(k)\t(E.24)\nz\tz '\nk = 1\nsubject to\nG1(z) = 0,\t(E.25)\nGi(z) &lt;0, for i = Ne + 1,...,Nc,\t(E.26)\nand its associated Lagrangian function is given by\nL(z, p) = J(z) + MtG(z),\t(E.27)\nwhere p G RNc.\nA numerical check for second-order sufficient condition for optimality is then evaluated as follows. Let z be an optimal solution for (E.24)-(E.26) with associated Lagrange multiplier ~p satisfying the KKT conditions. Also, consider the set of active indexes defined by Ia = {i G {1,..., Nc}|Gj(z) = 0} and let ma = #Ia. Denote Ga = (Gi)ieI as the active constraints and ~pa g Rm\u201c the corresponding Lagrange multiplier to active constraints. Then, the second-order sufficient condition can be stated under the following assumption [87].\nAssumption E.1. Assume that\n1.\tJ (z), G(z) are twice continuously differentiable with respect to z;\n2.\tthe gradients in VzGa are linearly independent, i.e., rank(Ga(z)) = ma;\n3.\tstrict complementarity ~pa of the Lagrange multipliers holds;\n4.\tthe Hessian of the Lagrangian is positive definite on Ker(Ga(z)),\nvTLzz(z, ~p)v > 0, Vv G Ker(VzGa(z)), v = 0.\t(E.28)\nThen z is a local minimum for (E.24)-(E.26).\nAs shown in [84], a numeric check of the second-order sufficient condition consists in evaluating the projected Hessian on Ker(VzGa) and verify if its eigenvalues are positive.\nE.3 Near-optimal strategy\nIn this section, a near-optimal strategy for biomass production is presented. From a practical point of view, this strategy is mainly important for those photobioreactors that are not equipped with a continuous medium valve or for those cases where the medium valve flow rate cannot be setted in the values obtained from the optimal strategy described in the previous section.\nThe idea of the near-optimal strategy is to simulate the model (D.22) and (D.30) to compute the initial switching time, t = tin, from Qm(t) = 0 L/min to Qm(t) = 10 L/min, to start the harvesting process, and the time t = tfn to switch from Qm(t) = 10 L/min to Qm(t) = 0 L/min, to close the photobioreactor. It must be stressed that the culture medium flow rate is equal zero if t / [tin,tfn]. For sake of simplicity, in this thesis, these simulations were performed considering a clear day solar irradiance model [77], and the process variables adequately regulated in their optimal operating point.\nFigure E.1 shows the surface of daily biomass production, calculated from the model (D.22) and (D.30) and cost function (E.1), for several different switching times. The dark blue contour level corresponds to wash out of the photobioreactor and the dark red contour to maximal daily production.\nAs can be seen in Figure E.1, the daily biomass production is constant along its contour levels, which means that the daily production is mainly dependent of the total medium injected through the system. Therefore, it can be concluded from Figure E.1 that a total cumulated flow of 0.23 starting after 17:30 h must bring the biomass productivity close to the optimal operating point. It must be stressed that the results shown in this section are mainly valid for the studied photobioreactor. Due to the different biological system parameters, such as respiration factor, photosynthesis rate, and the photobioreactors structure, the switching time of the near-optimal strategy must be studied case by case.\nFigure E.1: Surface of daily biomass production, calculated from the model (D.22) and (D.30) and cost function (E.1), as a function of the initial time and final switching time, in local hours. The dark blue contour level corresponds to wash out of the photobioreactor and the dark red contour to maximal daily production.\nE.4 Results\nThis section shows simulation and real experiments using the optimization strategies to maximize the daily biomass production in tubular photobioreactors. First, the optimization strategies were tested and compared by simulation, where the nonlinear model described in Appendix D was used as virtual plant. The actual harvesting system, that will be called classic strategy (that is based on photobioreactor design optimization), is also shown for comparison purposes. Afterwards, the proposed optimization systems were verified through real experiments on the industrial photobioreactor described in Appendix D.\nE.4.1 Simulation results\nThe simulations were performed for a period of 1 day, where the solar irradiance profile was collected from the real photobioreactor. Regarding the optimal strategy, several simulation tests were made to analyze the influence of the number of grid points of the control variable in the cost function value. Numbers greater than 15 did not show a significant change in the value of the cost function, as can be seen in Table E.1, where M is the number of grid points, CPU is the computing time in seconds, and ERR denotes the relative error of the KKT conditions given in (E.22). Furthermore, a numerical check\nTable E.1: Convergence behavior of the tubular photobioreactor optimization problem.\nM\tCPU [s]\tJ [kg/m3]\tERR\n5\t3252\t0.2407542\t2.27 x 10-3\n10\t7591\t0.2410867\t3.39 x 10-4\n15\t15646\t0.2411018\t4.74 x 10-4\n20\t21974\t0.2411025\t4.94 x 10-4\n30\t47498\t0.2411035\t5.19 x 10-4\n40\t61035\t0.2411089\t5.35 x 10-4\nof the projected Hessian was positive definite with vmin = 0.001 as the smallest eigenvalue for all studied cases. All numerical computations were performed in a workstation Intel Core i7\u00ae @2.00 Gigahertz and 4096 KB memory cache.\nFigure E.2 shows the response of the optimal, near-optimal and classic strategies for a day with small disturbances in the solar irradiance.\n10\n8\n6\nH 4 \"= 2\n0\n0\nII\n_\t\t\u2014 Classic strategy\t\t\t1\t1\t\t1 = 1\t1 \u25a0\t1\t\u201c\t\n-\t\u2014 \u2014 Near optimal strategy\t\t\t-\n\t\u2014 Optimal strategy\t\t1 \u25a0\t\n\t\t\tZZ1\n4\n12\n16\n20\n24\n1000\nE _g gj J\n500 -\n0 u\n0\n4\t8\t12\t16\t20\nTime (h)\nFigure E.2: Simulation results for the classic, near-optimal and optimal daily biomass production strategies. The graphics show (top) the biomass concentration at the outlet of the bubble column, Cb,out, (middle) the medium flow, Qm and (bottom) the solar irradiance profile.\nAs can be seen in Fig. E.2 there is no biomass harvesting during the dark phase of the day cycle for neither of the strategies. This fact is quite obvious since there is only microalgal respiration during this period and therefore perform the harvesting would result in loss of biomass. Moreover, using the optimal strategy the reactor is kept closed until the afternoon, which means that Cb,out &lt;C , as explained in Section E.1. The medium flow changes from Qm\t= 0 to Qm\tQm,\twhere 0&lt;\tQm\t<\tl0,\twhen\tCb,out +\tCb,out\nin order to maintain the maximal biomass production. The harvesting process finish at the night, when a sufficient level of biomass concentration is reached to satisfy the terminal constraint (E.18).\nThe total cumulated flow Jtf D(Qm(t))dt of the classical strategy is 0.1820, i.e., 18.2% of the medium has been renewed during the 24 h, performed by the injection of culture medium from 9:00 to 10:00 with a flow rate of 10 L/min. The resulting daily biomass production for this strategy is 0.2337 kg/m3. Using the near-optimal strategy the daily biomass production was of 0.2488 kg/m3, i.e., an increase of 6.4613% over the classic harvesting strategy was obtained with total cumulated flow of 0.1577. Finally, using the optimal strategy proposed in this work, a daily biomass production of 0.2578 kg/m3 with a total cumulated flow of 0.1629.\nThe optimal strategy proposed in this work resulted in an increase of 10.3124% over the classic harvesting strategy and an increase of 3.8511% with respect to the near-optimal strategy. Note that these results are even more relevant when extrapolated to an industrial level with several photobioreactors in series with a continuous production over all year. Moreover, using the optimal strategy it is possible to maintain the perennity of the process due to the terminal constraint. Also note that, although the classic and near-optimal strategies have guaranteed the perennity of the process for the specific day shown in Figure E.2, this cannot be ensured for all days because these strategies do not take into account the process dynamics. In this context, using the optimal strategy it is possible to prevent that the culture density be very high and consequently avoid that the culture be affected by the shadow effect.\nSince in real experiments the presence of uncertainties between the model and real plant may be relevant, a sensitivity analysis with solar irra-\nTable E.2: Sensitivity to solar irradiance.\nUncertainty [%]\tJ [kg /m3]\t\u00bfM [kg/m3]\n-10\t0.2400353\t-0.0127\n+10\t0.2419881\t0.0061\ndiance uncertainties conditions was developed. Table E.2 summarizes the sensitivity results. As can be seen the solar irradiance has a low sensitivity in the cost function and terminal constraint.\nE.4.2 Experimental results\nThis section shows the results obtained when using the classic, near-optimal and optimal strategies to maximize biomass production in a real tubular photobioreactor. The experiments have been performed at the plant described in Appendix D. All experiments performed consider the pH and temperature adequately controlled in their optimal operating points. Moreover, the microalgae is continuously aerated to remove the dissolved oxygen produced during the photosynthesis process.\nThe harvesting strategies were implemented on an industrial computer located at the plant facility. A LabVIEW-based software executes the optimal, near-optimal or classic harvesting strategies, which are coded in the Matlab environment. All systems sensors and actuators are connected to the Compact-FieldPoint unit from National Instruments. It must be stressed that the biomass concentration is estimated by a turbidity meter, which was calibrated by comparing biomass concentration values obtained from laboratory with the signal values obtained from the sensor. Although this apparatus has a good measurement accuracy, the facility has a high noise level. In this context, the biomass graphics shown in this section were treated and filtered for better viewing.\nClassic Harvesting Strategy\nFigure E.3 shows a representative experimental result of the classic harvesting strategy in the tubular photobioreactor. As can be seen in the upper graphic of Figure E.3, the biomass concentration operating point was of 1.1 kg/m3 and the solar irradiance was smooth (bottom graphic of Figure E.3) during the experiment. For this particular day, the classic harvesting strategy obtains a daily biomass production of 0.2956 kg/m3 with a total cumulated flow of 0.3061. The mean biomass productivity was estimated in 2.3976x10-6 kg/(m3-s).\nNear-Optimal Harvesting Strategy\nThe near-optimal harvesting strategy was implemented with the starting harvesting time t = 18 : 00h and the closing time t = 19 : 05h, resulting in a total cumulated flow of 0.2485.\nFigure E.3: Experimental result of the classic harvesting strategy being used at the Palmerillas Experimental Station. The harvesting process starts around 8:00 h and lasts 1 hour. The total cumulated flow is 0.3061 and the daily biomass production obtained is 0.2956 kg/m3.\nFigure E.4 shows an experimental result obtained with the near-optimal biomass production strategy. The biomass concentration operating point was around 1 kg/m3. It can be seen in the bottom graphic of Figure E.4 that the solar irradiance is smooth along the day. The daily biomass production obtained from this experiment was 0.2947 kg/m3 and the mean biomass productivity was estimated in 4.2937x10-6 kg/(m3-s).\nAnother experiment with the near-optimal strategy is shown in Figure E.5. As can be seen in the bottom graphic of Figure E.5 there are small transients in the solar irradiance, due to passing clouds. The daily biomass production obtained from this experiment was 0.3435 kg/m3 and the mean biomass productivity was estimated in 3.4000x10-6 kg/(m3-s).\nOptimal Harvesting Strategy\nThe medium flow calculated by the optimal daily biomass production strategy is performed offline. In this way, initial conditions obtained from the real plant are used in the model (D.22)-(D.30), and the optimization procedure\n800\nTime (h)\nFigure E.4: Experimental result of the near-optimal harvesting strategy. The harvesting process starts around 18:00 h and lasts 1 hour. The total cumulated flow is 0.2485 and the daily biomass production obtained is 0.2947 kg/m3.\nis then applied. The solar irradiance is estimated through a meteorological model [77]. This model calculates the solar irradiance for a clear day of a desired location, in this case, Almer\u00eda - Spain. Although clear days are not always a realistic scenario, the slow biomass dynamics and the sensitivity analysis presented in Table E.2 shown that this solar irradiance model gives a good model prediction for the optimization system. Moreover, to minimize the errors between the model and the real system caused by unmodelled dynamics and unmeasured disturbances, the error e = Cb,out(M) \u2014 Cbr (M), where Cbr (M) is the real biomass concentration value, obtained from the last sampling time, is summed to the terminal constraint. Note that using this approach, the optimization system works as a sliding horizon methodology. Finally, a PI controller is used in the medium valve to set the flow rates obtained from the optimizer.\nFigure E.6 shows a representative day of the photobioreactor operating with the optimal biomass production strategy. Note that the biomass operating point is of 0.5 kg/m3 . The system was operating with low cell density because in this period of the year (summer) the microalga suffers stress and\nT\nT\n10 -\nE 3 S S\n-L.\n16\n-L.\n20\n24\n800\nE 600 -\nS 400 -\n200 -\n8 12 16 20\nTime (h)\n24\nc\nI\ni\n\n4 -\n2 -\n0 u\n0\n0 L\n0\nT\nT\nFigure E.5: Experimental result of the near-optimal harvesting strategy. The harvesting process starts around 18:00 h and lasts 1 hour. The total cumulated flow is 0.2485 and the daily biomass production obtained is 0.3435 kg/m3.\nthe cells may adhere in the photobioreactor tube wall, due to high temperatures and solar irradiance. For this experiment, a daily biomass production of 0.0832 kg/m3 was achieved with a total cumulated flow of 0.1737. The estimated mean biomass productivity is 2.8964x10-6 kg/(m3-s). As can be noted in the upper graphic of Figure E.6, the final constraint was not assured due to the unmodelled dynamics and unmeasured disturbances. The terminal constraint error was of -0.0681 kg/m3. In order to reduce this error, the optimization problem solved for the next time horizon was considering this error in the terminal constraint.\nThe experiment performed in the next day is shown in Figure E.7. Observe that in this experiment, the culture medium injected in the system is much lower than the experimental test shown in Figure E.6, as an attempt to fulfill the terminal constraint. It results in a total cumulated flow of 0.0918, daily biomass production of 0.0392 kg/m3 and mean biomass productivity of 2.5163x10-6 kg/(m3-s). The terminal constraint error is of -0.0103 kg/m3, as expected the error was reduced.\nTime (h)\nFigure E.6: Experimental result of the optimal harvesting strategy. The harvesting process starts around 13:00 h and lasts around 7 hours. The total cumulated flow is 0.1737 and the daily biomass production obtained is 0.0832 kg/m3.\ngies are summarized in Table E.3. This table shows the total cumulated flow (TCF), mean biomass productivity (Pb), daily biomass production (DBP), and the normalized daily biomass production (NDBP). This last index corresponds to the ratio between daily biomass production and the integral of the biomass concentration over the time horizon. This index was calculated to minimize the influence of the system operating point over the results.\nAs can be seen in Table E.3, the optimal strategy had worst performance than the near-optimal strategy. This is due to the fact the photobioreactor was operating with a low cell density during the experiments to avoid the shadow effect caused by the adherence of the microalgae cells in the photobioreactor tube wall (typical phenomenon that occurs in the period of the experiments). Consequently, the biomass growth rate was low during those days. However, it is expected that the optimal strategy has better performance when operating with the same cell density of the other experimental cases.\nFigure E.7: Experimental result of the optimal harvesting strategy. The harvesting process starts around 13:00 h and lasts around 9 hour. The total cumulated flow is 0.0918 and the daily biomass production obtained is 0.0392 kg/m3.\nE.5 Conclusions\nIn this appendix, the daily biomass production optimization problem in tubular photobioreactors was studied. To deal with this problem, two strategies were proposed: (i) an optimal biomass production strategy and; (ii) a near-optimal biomass production strategy. Regarding the optimal biomass production strategy, a direct optimization method together with the control parametrization concept was used to solve the nonlinear programming problem. In the case of the near-optimal strategy, the biomass harvesting time for a constant medium flow rate value is computed. This calculus is evaluated directly from the system dynamical model, under real conditions.\nSimulation results shown that both strategies proposed in this work achieved higher biomass production than the classical strategy currently used in the real plant. In addition, these results also shown that the best period of time to perform the biomass harvesting process is at the afternoon till the night, contrary to the classical strategy in which is carried out at the beginning of the day. For the experimental results, the proposed strategies\nTable E.3: Performance indexes calculated from the response of the experimental results of the classic, near-optimal and optimal strategies.\nStrategy\tIndex\tDay\t\n\t\t1\t2\n\tTCF\t0.3061\t\nClassic Strategy\tDBP [kg/m3]\t0.2956\t\n\tNDBP\t1.9164x10-4\t\n\tPb [kg/(m3-s)]\t2.3976x10-6\t\n\tTCF\t0.2485\t0.2485\nNear-optimal\tDBP [kg/m3]\t0.2947\t0.3435\nStrategy\tNDBP\t2.3028x10-4\t2.2765X10-4\n\tPb [kg/(m3-s)]\t4.2937x10-6\t3.4000X10-6\n\tTCF\t0.1737\t0.0918\nOptimal Strat-\tDBP [kg/m3]\t0.0832\t0.0392\negy\tNDBP\t1.2077X10-4\t6.6293X10-5\n\tPb [kg/(m3-s)]\t2.8964X10-6\t2.5163X10-6\nalso shown promising results. However, due to the fact that it is not possible to reproduce the tests under the same conditions, it is hard to quantify the improvement obtained in the photobioreactor with such optimization systems.\nAlthough the evaluation performed in this work is based on a single tubular photobioreactor, the results can be easily extrapolated to an industrial level with several photobioreactors in series with a continuous production. In such case, the benefits are even more visible."}]}}}