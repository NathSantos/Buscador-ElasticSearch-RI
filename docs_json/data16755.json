{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.20538"}, {"@name": "filename", "#text": "4115_Vidal_JoseOliveira_M.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE ESTADUAL DE CAMPINAS\nFACULDADE DE ENGENHARIA DE CAMPINAS\nDEPARTAMENTO DE ENGENHARIA DE PETR\u00d3LEO\nDisserta\u00e7\u00e3o Apresentada A\nFaculdade de Engenharia de Campinas\nComo Requisito Parcial A Obten\u00e7Ao do\nTitulo de Mestre em Engenharia de Petr\u00f3leo\nAN\u00c1LISE AUTOMATIZADA DE TESTES DE PRESS\u00c3O EM\nPO\u00c7OS\nNAO SURGENTES\n\nSe\to-\n^\\KD.^aclMO~\t^0/03/Sc?t -\n\n\nU- -\nAUTOR\n\u00ed\nJ\nJos\u00e9 Oliveira Vidal\n\nORIENTADOR\nAnt\u00f4nio Cl\u00e1udio de Fran\u00e7a Corr\u00eaa\nMar\u00e7o. 1089\nUNIVERSIDADE ESTADUAL DE CAMPINAS\nFACULDADE DE ENGENHARIA DE CAMPINAS\nDEPARTAMENTO DE ENGENHARIA DE PETR\u00d3LEO\nA disserta\u00e7\u00e3o \"An\u00e1lise Automatizada de testes de press\u00e3o em po\u00e7os n\u00e3o surgentes\", elaborada por Jos\u00e9 01 i veir a Vi dal e apr ovada por todos os membr os da Banca Examinadora foi aceita pela Sub-Comiss\u00e3o de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Petr\u00f3leo como requisito parcial \u00e0 obten\u00e7\u00e3o do T\u00edtulo de Mestre em Engenharia de Petr\u00f3leo\nCampinas, 20 de mar\u00e7o de 1989\nBanca Examinadora\nMaria Cristina Cunha Bezerra, Ph, D.\nPara meus familiares\nPara minha esposa\nRoseane\nPar a mi nha f i1ha\nCec\u00edlia\ni\u00ed\nAGRADECIMENTOS\nAgrade\u00e7o ao Centro de Engenharia de Petr\u00f3leo da Universidade Estadual de Campinas pela disposi\u00e7\u00e3o durante a execu\u00e7\u00e3o deste trabalho.\nAos meus pais, Oscar e Maria, pela educa\u00e7\u00e3o recebida.\nAo meu orientador. Prof. Ant\u00f4nio Cl\u00e1udio de F. Corr\u00eaa, pela ajuda, compreens\u00e3o e determina\u00e7\u00e3o em todas as etapas da tese.\nAos professores Jos\u00e9 Martinez, Maria Cristina e Martin Tygel do I. M.E.C. C/UNICAMP e ao prof. Secundino da Faculdade de Engenhar ia El\u00e9tr ica/UNICAMP pelos eselareei mentos imprescind\u00edveis neste estudo.\nA todos aqueles, inclusive aos amigos da PETROBRAS, que de alguma forma contribuiram para a realiza\u00e7\u00e3o desta tarefa.\nSum\u00e1rio\nAgradecimentos ........................................... ii\u00ed\nSum\u00e1rio................................................     iv\nLista de figuras ............................*............ vii\nLista de tabelas ........................................   tx\nResumo....................................................  xi\nAbstract.........................................    .\txii\n1.\tIntrodu\u00e7\u00e3o..................-..........................   1\n1.1\tHist\u00f3rico da an\u00e1lise de teste de forma\u00e7\u00e3o ............ \u00a3\n1.2\tHist\u00f3rico da an\u00e1lise automatizada de teste ....\t5\n1.3\tObjetivo e metodologia .............................. 6\n2.\tModelo matem\u00e1tico do problema de DST .................... 7\n2.1\tEqua\u00e7des dimensionais ................................ 8\n2. 2 Equa\u00e7Ses normalizadas ...........................    10\n3.\tSolu\u00e7Ses das equa\u00e7Ses para po\u00e7os n\u00e3o surgentes ...\t12\n3.1\tAs equa\u00e7\u00f3es governantes ............................  12\n3.1.1\tSolu\u00e7\u00e3o para o periodo de fluxo................. 13\n3.1.2\tSolu\u00e7\u00e3o para o problema de DST................. 14\n4.\tEstimativa dos par\u00e2metros por regress\u00e3o ................ 17\n4.1\tEscolha do m\u00e9todo de estimativa ....................  18\n4.2\tProblema de\tquadrados\tm\u00ednimos\tn\u00e3o lineares ....\t19\n4.\t2.1 M\u00e9todo\tde\tNewton.............................. 20\n4.\t2. 2 M\u00e9todo\tde\tGouss-.............................. 20\n4. 2. 3 M\u00e9todo\tde\t\u00bf.evember^-A\u00edorqxt\u00f3zrd\u00ed. ........... 21\n4.3\tJustificativa te\u00f3rica do m\u00e9todo ................     22\n6.\tInterpreta\u00e7\u00e3o automatizada com dados simulados....\t26\n5.\t1 No f 1 uxo por di f er en\u00e7as f i ni tas ............ 26\n5.1.1\tDiscuss\u00e3o do m\u00e9todo e resultados  .............. 27\n6.2\tNo fluxo por invers\u00e3o num\u00e9rica.....................  28\n5.2.1\tDiscuss\u00e3o do m\u00e9todo e resultados.........\t30\n5.3\tNa est\u00e1tica por inversSo num\u00e9rica .................. 35\n5.3.1\tM\u00e9todos de solu\u00e7\u00e3o da integral ...............  36\n5.3.2\tAplica\u00e7\u00e3o do m\u00e9todo .........................  40\n5.\t3. 2. 1 Discuss\u00e3o do m\u00e9todo e resultado . . .\t42\n5.4\tNos per\u00edodos de fluxo e est\u00e1tica.................... 43\n5.4.1\tAplica\u00e7\u00e3o do m\u00e9todo ........................... 45\n5.\t4. 2 Discuss\u00e3o e novas propostas . ..............  47\n6.\tInterpreta\u00e7\u00e3o automatizada em dados reais ............. 51\n6.1\tPo\u00e7os de alta produtividade......................... 51\n6.1.1\tDiscuss\u00e3o dos resultados ....................   55\n6.1.2\tNova proposta...............................   55\n6.1.3\tUso de pesos diferenciados .................   56\n6.1.4\tOutros exemplos..............................  58\n6.2\tPo\u00e7os de baixa produtividade....................... 63\n6.2.1\tDiscuss\u00e3o dos resultados ...................... 67\n6.2.2\tRetirando pontos da est\u00e1tica ................. 62\n6.3\tAn\u00e1lise estat\u00edstica da regress\u00e3o .................. 70\n7.\tOtimiza\u00e7\u00e3o no DST por diferen\u00e7as finitas........\t72\n7.1\tUso em dados simulados ...........................   73\n7.\t2 Uso em dados reais .  ...........................   78\n7.2. 1 Outros exemplos .............................  83\n7.2.2\tDiscuss\u00e3o do m\u00e9todo .......................... 84\n8.\tConclus\u00e3o e Recomenda\u00e7\u00e3o..............................  26\n8.1\tConclus\u00f5es .......................................   86\n8.2\tRecomenda\u00e7\u00f5es ....................................  88\n9.\tMonencl atura........................................   89\n10.\tRefer\u00eancia bibliogr\u00e1fica.............................. 93\nAp\u00eandice A\nSolu\u00e7\u00e3o da equa\u00e7\u00e3o do \"51 ug Test\" dimensionalizada ..\t96\nAp\u00eandice B\nDeriva\u00e7\u00e3o do \"Slug Test\" em rela\u00e7\u00e3o aos par\u00e2metros ..\t98\nCaso \"skin\" positivo..................................   98\nCaso \"skin\u201d negativo ..................................   100\nAp\u00eandice C\nSolu\u00e7\u00e3o do problema do DST em forma dimensional ......... 103\nAp\u00eandice D\nDeriva\u00e7\u00e3o do DST em rela\u00e7\u00e3o aos par\u00e2metros............... 105\nCaso \"skin\" positivo................................    105\nCaso \u201cskin\" negativo................................... 100\nAp\u00eandice E\nAlternativas de solu\u00e7\u00e3o da integral do DST..............  114\nAp\u00eandice F\nSolu\u00e7\u00e3o do problema do DST por diferen\u00e7as finitas ...\t122\nAp\u00eandice G\nListagens dos programas de otimiza\u00e7\u00e3o...................  126\n<3.1 No fluxo por diferen\u00e7as finitas para c\u00e1lculo\nde k > S, p e C, ................................. 127\nG. 2 No fluxo por inversSo num\u00e9rica para c\u00e1lculo de\nkf S, e p\t131\no\nG.3 Na est\u00e1tica por invers\u00e3o num\u00e9rica para c\u00e1lculo\nde k, S e p.....................................   134\nL\nG.4 Em um ciclo por invers\u00e3o num\u00e9rica para c\u00e1lculo\nde L \u00a3\u00bb p. e p ................................... 144\nV\to\nAp\u00eandice H\nListagem do programa gerador de dados de press\u00e3o ....\t175\nAp\u00eandi ce I\nListagem do programa de otimiza\u00e7\u00e3o por diferen\u00e7as\nfinitas..............................................     183\nLista de figuras\nP\u00e1cti na\nFigura\t3.1\tFun\u00e7\u00e3o degrau\nFigura\t4.1\tEsquema de um\nFigura\t5.1\tOtimiza\u00e7\u00e3o no\nFigura\t5.2\tOtimiza\u00e7\u00e3o no\nFi gura\t5. 3\tOtimiza\u00e7\u00e3o no\nFigura\t3. 4\tSensibi1i dade\nFigura\t\tSensi bi1i dade\nFigura\t5.6\tSensibilidade\nFi gura\t5. 7\tOtimiza\u00e7\u00e3o na\nFigura\t5. 3\tDados gerados\nFi gur a\t5. 0\tOtimiza\u00e7\u00e3o no\nFigura\t3. 10\tFun\u00e7SEo objeti\u2019'\ne complemento ................ 15\nDst Cl ciclo} ................ 17\nfluxo Ck, S e p } ............ 31\n<s\nfluxo CS, Cf e SSR} .......... 33\nfluxo Ck, SeC) ............... 33\nde k com C ................... 33\nde k e S com API \u00f3leo ........ 34\nde S com C .................   35\nest\u00e1tica Ck, S . p.5 ......... 43\npara DST Cl ciclo} ........... 45\nfluxo e est\u00e1tica . ,.......... 46\no durante otimiza\u00e7\u00e3o ......... 40\nFigura\t5.11\nFi gur a\t5.12\nFigura\t5.13\nFigura\t6. 0\nFi gur a\t6. i\nFi gur a\t6. 2\nFigura\t6.3\nFigura\t6. 4\nFigura\t6, 5\nFigura\t6. 6\nFigura\t6. 7\nFigura\t6. 8\nFigura\t6.0\nFigura\t6. 10\nFi gura\t6. 11\nFigura\t6.12\nFigura\t6.13\nOtimiza\u00e7\u00e3o no DST Ck, S, p^ e pO ....... 49\nSensibi1idade dos par\u00e2metros com C .... 50 Sensibilidade dos par\u00e2metros com C^ ... 50 Carta do DST no po\u00e7o A ................. . 53\nOtimiza\u00e7\u00e3o no DST do po\u00e7o A Csem peso) ..\nOtimiza\u00e7\u00e3o no DST do po\u00e7o A Ccom peso) ..\nResultados manual vs otimizado ..........\n37\nOtimiza\u00e7\u00e3o sem\tpeso\tno\tCpllS............. 50\nOtimiza\u00e7\u00e3o com\tpeso\tno\tCpllS............. 59\nOtimiza\u00e7\u00e3o sem\tpeso\tno\tCpl37............. 60\nOtimiza\u00e7So com\tpeso\tno\tCpl37............. 60\nOtimiza\u00e7\u00e3o sem\tpeso\tno\tCp222............. 61\nOtimiza\u00e7\u00e3o com\tpeso\tno\tCp222 ............. 61\nOtimiza\u00e7\u00e3o sem\tpeso\tno\tCp2Q3............. 62\nOtimiza\u00e7\u00e3o com\tpeso\tno\tCp293............. 62\nCarta DST do po\u00e7o CP760 ..........  .\t. . .\nOtimiza\u00e7So com peso Cp760 CN=20} ......\nvi i\n63\n66\nFigura 6.14 Otimiza\u00e7\u00e3o com peso Cp760 CN=1O2) ............ 67\nFigura 6.13 Otimiza\u00e7\u00e3o com peso Cp760 ttrechoj ...... 6D Figura 7.1 PressBes por diferen\u00e7as finitas e por\ninvers\u00e3o num\u00e9rica..........................  74\nFigura 7.2\tOtimiza\u00e7\u00e3o no fluxo e no DST\tcompleto\t...\t75\nFigura 7.3\tOtimiza\u00e7\u00e3o para DST por diferen\u00e7as\nfinitas ................................     76\nFigura 7.4\tOtimiza\u00e7\u00e3o no fluxo................... 77\nFigura 7.3\tFun\u00e7\u00e3o objetivo na otimiza\u00e7\u00e3o .............. 77\nFigura 7.6\tOtimiza\u00e7\u00e3o por diferen\u00e7as\tfinitas\tno\nCP760 Csem pesoD .........................   78\nFigura 7.7\tOr\u00e1fico cartesiano do CP760 ................ 78\nFigura 7.8\tOtimiza\u00e7\u00e3o\tPor\tdiferen\u00e7as\tfinitas\tno\nCP760 Ccom peso2> ............ ............. 80\nFigura 7. \u00a9\tOtimiza\u00e7\u00e3o\tpor\tdiferen\u00e7as\tfinitas\tno\nCP760 C trecho! ........................     81\nFigura 7.10\tOtimiza\u00e7\u00e3o\tpor\tdiferen\u00e7as\tfinitas\tno\nCP7\u00ca0 Ctrecho} ............................. 88\nFigura 7.11\tOtimiza\u00e7\u00e3o\tno\tDST\tdo\tFu22.................. 83\nFigura 7.12\tOtimiza\u00e7\u00e3o\tno\tDST\tdo\tFu2\u00a3\tCcom peso}\t....\t83\nFigura 7.13\tOtimiza\u00e7\u00e3o\tno\tDST\tdo\tFu22\tCtrecho} ........ 85\nLista de tabelas\nP\u00e1qi na\nTabela 3.1\tDefini\u00e7\u00e3o das\tvari\u00e1veis\tadmensiona\u00eds\t11\nTabela 5.1\tDados de fluido e rocha\t .............. 23\nTabela 5.2\tDados gerados\tpara fluxo ...................    23\nTabela 5.3\tC\u00e1lculo de k,\tS\u00bb C. e p\tno\tfluxo........ 27\nf\to\nTabela 5.4\tDados de flu\u00eddo e rocha.......................  26\nTabela 5.5\tDados gerados para fluxo ...................... 29\nTabela 5.5\tC\u00e1lculo de k, S, C, e P no fluxo............... 30\nTabela 5.7\tM\u00e9todos de integra\u00e7\u00e3o ......................... 37\nTabela 5.8\tCompara\u00e7\u00e3o da integra\u00e7\u00e3o de FCt? .............. 38\nTabela 5.8\tCompara\u00e7\u00e3o da integra\u00e7\u00e3o de GCt? .............. 38\nTabela 5.10 Dados de flu\u00eddo e mec\u00e2nico do po\u00e7o.......... .\t40\nTabela 5.11\tDados gerados de press\u00e3o est\u00e1tica ............. 41\nTabela 5.12\tC\u00e1lculo de k\u00bb S, p. e C. na est\u00e1tica......\t42\nTabela 5.13\tDados simulados de um DST Cl ciclo? ......\t44\nTabela 5.14\tC\u00e1lculo de k, S, p.\u00bb C. e C no DST ......\t46\nTabela 5.15\tC\u00e1lculo de k, S, p. e p no DST................  47\ni.\to\nTabela 5.16\tC\u00e1lculo de k, S e p. no DST.................... 48\nL\nTabela 6.1\tDados po\u00e7o A Cdo SFE 16802? ................... 52\nTabela 6.2\tInterpreta\u00e7\u00e3o manual do po\u00e7o A................. 53\nTabela 6.3 Interpreta\u00e7\u00e3o autom\u00e1tica do po\u00e7o A\nCsem peso? ...............................      54\nTabela 6.4 Interpreta\u00e7\u00e3o autom\u00e1tica do po\u00e7o A\nCcom peso? .................................... 56\nTabela 6.5\tExemplos de \u00ednterpreta\u00e7\u00e3o autom\u00e1tica ....\t58\nTabela 6.6\tPress\u00e3o no po\u00e7o Cp760 ..................- - .\t64\nTabela 6.7\tDados do po\u00e7o, rocha e flu\u00eddo\tdo\tCp760 ...\t65\nTabela 6.8\tInterpreta\u00e7\u00e3o manual do Cp760\t .......... 65\nTabela 6.9 Interpreta\u00e7\u00e3o autom\u00e1tica do Cp760\nC completo? . .....\nLX\nTabela 6.10 Interpreta\u00e7\u00e3o autom\u00e1tica do Cp760 CtrechcO 60 Tabela 6.11\tIntervaio\tde\tconf1an\u00e7a\tdo\tpo\u00e7o\t\u00c0\nC sem pescD ................................. 71\nTabela 6.12\tIntervalo\tde\tconfian\u00e7a\tdo\tpo\u00e7o\tA\nCcom pesca) ................................. 71\nTabela 7.1 Dados simulados DST Cl aiclcD ............  .\t73\nTabela 7.2\tC\u00e1lculo de\tk t\tS e pi no Cp7BO............... 81\nTabela 7.3\tC\u00e1lculo de\tk,\tS e pi no Cp76O Ctrecho3\t...\t82\nTabela 7.4\tResultados\tde\tinterpreta\u00e7\u00e3o no\tFu82\t..... 84\nTabela 7.5\tResultados\tde\tinterpreta\u00e7\u00e3o no\tpo\u00e7o\tA ....\t85\nTabela 9.1 Convers\u00e3o de unidade de grupos\nadimensionais...........................      92\nTabela 9.2 Constantes de transforma\u00e7\u00e3o de unidades ..\t92\nRESUMO\nEste trabalho apresenta um m\u00e9todo para interpreta\u00e7\u00e3o de teste de press\u00e3o em po\u00e7os n\u00e3o surgentes Cou DST?.\nO m\u00e9todo faz um ajuste dos dados de campo com os dados gerados por modelo te\u00f3rico de reservat\u00f3rio, usando uma t\u00e9cnica de regress\u00e3o irrestrita, n\u00e3o linear sob o crit\u00e9rio dos quadrados m\u00ednimos, acoplado a um algoritmo de invers\u00e3o num\u00e9rica de transformada de \u00bf.aplace para os dados de press\u00e3o de fluxo e est\u00e1tica.\nObteve-se a solu\u00e7\u00e3o da press\u00e3o no po\u00e7o por t\u00e9cnica de transformadas de \u00bf.\u00a1zplexce, modelando o teste de forma\u00e7\u00e3o como sendo um \u201cslug test\" com uma mudan\u00e7a brusca de estocagem.\nOs gradientes de press\u00e3o necess\u00e1rios para implementar a t\u00e9cnica de regress\u00e3o foram determinados analiticamente e depois invertidos numericamente para o espa\u00e7o real usando o algoritmo de Sieh/est.\nAnalisou-se o per\u00edodo de fluxo, o per\u00edodo de est\u00e1tica e ambos os per1odos si mui taneamente C um ci clo completo? do teste de forma\u00e7\u00e3o para o caso de um reservat\u00f3rio homog\u00e9neo, i nfi ni to com f1uxo r adi ai par a o po\u00e7o e i nclui ndo os efei tos de estocagem e \u2018'skin\" Cpositivo ou negativo?.\nEsta an\u00e1lise fornece a press\u00e3o est\u00e1tica inicial do reservat\u00f3rio, a permeabilidade da forma\u00e7\u00e3o e o dano no po\u00e7o.\nAtri buiu-se pesos individuais aos dados de press\u00e3o vs tempo para compensar os efeitos de flutua\u00e7\u00e3o devido instabilidade dos registradores de press\u00e3o.\nAnalisou~se testes com dados reais e simulados para ilustrar a aplica\u00e7\u00e3o do m\u00e9todo, e verificou-se os resultados com um algoritmo de diferen\u00e7as finitas.\nEmbor a n\u00e3o sej a necess\u00e1ria a deter mi na\u00e7\u00e3o da vaz\u00e3o de fluxo para esta an\u00e1lise, \u00e9 de vital import\u00e2ncia a estimativa da densidade m\u00e9dia dos fluidos produzidos.\nEste m\u00e9todo reduz o tempo gasto para an\u00e1lise do teste e elimina a subjetividade da interpreta\u00e7\u00e3o.\nABSTRACT\nThis paper presents a method for automatic interpretation of drillstem tests when produced fluids do not fill the dri. iirf'Lr'i nci\nThe method matches the field data wi th theoreti cal reservoir models using\tan unconstrained, nonlinear,\nleast-squares regression technique coupled with numerical Laplace inversion of both flowing and shut in pressures.\nThe solution for the pressure at the wellbore has been obtained by Laplace transformation, by modelling a drillstem test as a slug test with a step- change in wellbore storage.\nThe parameter gradients needed to implement the regression technique were determined analiticaly and then numerically inverted to real space using the Stehfest algorithm.\nAnalysis of the flow period, of the shut in period and of both peri ods Cone eompl ete cycl e2> of a drill stem test were done for a single, homogeneous and infinite system with wellbore storage and skin effect Cboth positive and negati veJ . Thi s analysi s may provi de the i ni ti al reservo!r pressure, the formation permeabili ty and the skin effect factor.\nThe pressure vs time data points have been properly weighted in order to eliminate the effects of fluctuations or instability on data aquisition device.\nSimulated pressure tests and actual field data are analyzed to il\u00fastrate the aplication of the method.\nThe results are checked by a finite difference algorithm.\nAlthough flow rate measurements are not required for the applications of the proposed method, it is very important to estimate correctly the average density of the produced fluids for a good interpretation of the test.\nThe method reduces the time to perform drillstem test analysis and minimizes the subjectivity of interpretation.\nxi i\n1.\tINTRODU\u00c7\u00c3O\n\u00c3 pr\u00e1tica atual de interpreta\u00e7\u00e3o de teste consiste em usar t\u00e9cnicas 1og-1og e semi ~1og principalmente durante o per\u00edodo de est\u00e1tica. Em po\u00e7os n\u00e3o surgent.es uma vaz\u00e3o m\u00e9dia \u00e9 estimada do volume recuperado, e procede-se A interpreta\u00e7\u00e3o com um dado modelo de comportamento a fim de determinar a permeabilidade CkJ, o efeito de pel\u00edcula CSD e a press\u00e3o est\u00e1tica Cp.>.\nN\u00e3o \u00e9 feito contudo um estudo dos resultados da interpreta\u00e7\u00e3o para verificar a sua validade com os dados de press\u00e3o versus tempo obtidos doj po\u00e7o.\nEste trabalho apresenta uma t\u00e9cnica de interpreta\u00e7\u00e3o de de teste em po\u00e7os n\u00e3o surgentes> usando um microcomputador digital, para determina\u00e7\u00e3o dos principais par\u00e2metros do sistema po\u00e7o-reservat\u00f3rio considerando os efeitos de estoeagem e de pel\u00edcula no po\u00e7o.\nEste cap\u00edtulo 1 apresenta uma cronologia dos estudos da interpreta\u00e7\u00e3o de teste em po\u00e7os n\u00e3o surgentes, um hist\u00f3rico da interpreta\u00e7\u00e3o automatizada e as defini\u00e7\u00f5es do objetivo e metodologia usadas. Nos cap\u00edtulos 2 e 3 introduz-se os modelos f\u00edsicos e matem\u00e1ticos usados. No cap\u00edtulo 4 estuda-se crit\u00e9rios matem\u00e1ticos para aplica\u00e7\u00e3o do algori tmo que ser\u00e1 aplicado inicialmente para os dados simulados no capitulo 3.\nO cap\u00edtulo S apresenta a aplica\u00e7\u00e3o do m\u00e9todo a dados reais e novos crit\u00e9rios pr\u00e1ticos para serem usados. O cap\u00edtulo 7 discute o m\u00e9todo por diferen\u00e7as finitas e no cap\u00ed tulo 8 apresentam-se as conclus\u00f5es e recomenda\u00e7\u00f5es.\nNos ap\u00eandices \u00c0 e C est\u00e3o as dedu\u00e7\u00f5es das equa\u00e7\u00f5es da press\u00e3o durante os per\u00edodos de fluxo e est\u00e1tica para o \u201cskin\u201d positivo e negativo. Nos ap\u00eandices 8 e D est\u00e3o as respectivas express\u00f5es anal\u00edticas dos gradientes de press\u00e3o. O ap\u00eandice E apresenta um estudo comparativo de m\u00e9todos de integra\u00e7\u00e3o. O ap\u00eandice F mostra o m\u00e9todo de diferen\u00e7as finitas e nos ap\u00eandices G e H est\u00e3o as listagens dos programa usados.\n1.1.\tHIST\u00d3RICO DA TEORIA DE AN\u00c1LISE DO TESTE DE FORMA\u00c7\u00c3O\nO teste de forma\u00e7\u00e3o Cou DSTD \u00e9 a mais antigo m\u00e9todo usado na determina\u00e7\u00e3o de par\u00e2metros de reservat\u00f3rio. O DST pode ser visto como uma completa\u00e7\u00e0o provis\u00f3ria do po\u00e7o. As ferramentas de teste s\u00e3o descidas no po\u00e7o e uma sequ\u00eancia de per i odos de pr odu\u00e7ao e f echamento \u00e9 fei ta com o obj et i vo de registrar o comportamento de press\u00e3o durante o teste.\nDurante o per\u00edodo de fluxo Ctamb\u00e9m dito \"slug test\"? \u00e9 imposta uma mudan\u00e7a de press\u00e3o no po\u00e7o devido \u00e0 entrada de fluido da forma\u00e7\u00e3o para o interior da coluna. A an\u00e1lise deste per\u00edodo. que normalmente \u00e9 curto, pode nos fornecer a transmisaibilidade da forma\u00e7\u00e3o e as condi\u00e73es do po\u00e7o CdanoJ.\nNo periodo de est\u00e1tica, ap\u00f3s o fluxo, a press\u00e3o do reservat\u00f3rio \u00e9 recomposta e a an\u00e1lise deste crescimento de press\u00e3o pode fornecer a transmissibilidade. o efeito de pel\u00edcula e a press\u00e3o est\u00e1tica do reservat\u00f3rio..\nO desenvolvi mento da teoria de an\u00e1li se do DST dependeu do progresso da an\u00e1lise do per\u00edodo de fluxo C\u2018*slug test\"2> e da elabor a\u00e7\u00e3o de m\u00e9todos coerentes par a o per \u00ed odo de est\u00e1tica.\nA teor\u00eda do \"slug test*' progrediu em complexidade desde a considera\u00e7\u00e3o do po\u00e7o como uma fonte linear at\u00e9 a inclus\u00e3o de efeitos de pel\u00edcula e estocagem num po\u00e7o de raio finito.\nEm 1954 Ferris&lt;&amp; Knowles estenderam o conceito de fonte linear de Theis ti9331 para a solu\u00e7\u00e3o de longo tempo do \"slug test\" para determinar a transmissibilidade em aqu\u00edferos.\nEm 1960 Ccxrslau\u00ed &amp;\tapresentaram em estudo de calor .\na solu\u00e7\u00e3o no espa\u00e7o de Loplcce para o problema do \"slug test\" considerando ralo finito e incluindo o efeito de estocagem, mas sem efeito de pel\u00edcula C\"skin\"l.\nCooper C19601 aplicou esta solu\u00e7\u00e3o para fluido semi~ compress\u00edvel em um aqu\u00edfero usando an\u00e1lise semilog do \"slug test\nA t\u00e9cnica de ajuste em curva tipo semilog foi usada pela\nprimeira vez em an\u00e1lise de DST par Koh.lh.aas em 197S.\n.i^arual &amp; Ramey C197\u00a3> mostraram que a solu\u00e7\u00e3o do \u2019\u2019slug test\u2019* \u00e9 proporcional \u00e0 derivada em rei a\u00e7\u00e3o ao tempo da solu\u00e7\u00e3o da press\u00e3o de fluxo para po\u00e7os produzindo com vaz\u00e3o constante, incluindo os efeitos de estocagem e \u201cskin\".\nRamey at aL. C18721 apresentaram duas novas curvas tipo log-Tog incluindo o efeito de pelicuia. sendo que uma descreve o \"slug test\" em tempos iniciais, e a outra os tempos finais. As curvas apresentadas por Cooper foram consideradas v\u00e1lidas para os tempos intermedi\u00e1rios.\nContudo, devido a extens\u00e3o do estudo do \"slug test\" o conceito do efeito de pel\u00edcula n\u00e3o foi solucionado corretamente, e as curvas tipo de Ramey n\u00e3o valem para os tempos iniciais e intermedi\u00e1rios.\nEm recente publi ca\u00e7\u00e3o A. Sa^eev C1986? apresentou a solu\u00e7\u00e3o do \"slug test\" com efeito de estocagem e \"skin\" atrav\u00e9s de curvas tipo e concluiu:\nO S\u00e3o necess\u00e1rias \u00a3 curvas tipo log-log para a an\u00e1lise da resposta do \"slug test\" nos tempos iniciais, dependendo da presen\u00e7a do efeito de pel\u00edcula.\n\u00edO O efeito de pel\u00edcula causa uma vaz\u00e3o constante nos tempos iniciais de produ\u00e7\u00e3o, durante o qual o par\u00e2metro de correla\u00e7\u00e3o deve ser S nas curvas tipo.\n\u00bf\u00a3D O par\u00e2metro de correla\u00e7\u00e3o para tempos longos na curva tipo log-log \u00e9 C^expCS S) como apresentado por Ramey.\nEm geral o per\u00edodo de fluxo do DST C\"slug test\"3 \u00e9 curto e os m\u00e9todos de an\u00e1lise simplifi\u00e7ados n\u00e3o podem ser aplicados, poi s n\u00e3o se atinge o trecho reto no gr\u00e1fico de press\u00e3o versus inverso do tempo, ficando pois a interpreta\u00e7\u00e3o restrita aos m\u00e9todos manuais ou automatizados de ajustes em curvas tipo.\nNo per\u00edodo da est\u00e1ti ca do DST a vaz\u00e3o da for ma\u00e7\u00e3o decresce rapidamente com o tempo, fornecendo uma curva suave de cresci mento de press\u00e3o. Hi stori camente este per1 crdo tem sido interpretado pelo m\u00e9todo de Worner, o qual foi concebido\npara, po\u00e7os produzindo com vaz\u00e3o constante. O m\u00e9todo de Worner apresenta resultados exatos para po\u00e7os produzidos com press\u00e3o constante Ccomo \u00e9 o caso de muitos DST3 desde que se utilize como tempo de produ\u00e7\u00e3o a raz\u00e3o entre o volume total recuperado dividido pela \u00faltima vaz\u00e3o antes do fechamento.\nftorw C19313 aplicou o princ\u00edpio da superposi\u00e7\u00e3o com a solu\u00e7\u00e3o de vaz\u00e3o constante a fim de obter uma equa\u00e7\u00e3o para a press\u00e3o est\u00e1tica\u00bb a qual poderia ser usada como m\u00e9todo para estimar a permeabilidade e a press\u00e3o est\u00e1tica da forma\u00e7\u00e3o.\nEhli g-Eeanom.1 des &amp; Rarney C19723 usar amai ntegr al de superposi\u00e7\u00e3o para computar a press\u00e3o est\u00e1tica ap\u00f3s um per\u00edodo de produ\u00e7\u00e3o com press\u00e3o constante. Eles concluiram.que a linha correta do m\u00e9todo de Worner poderia ser obtida usando o tempo de produ\u00e7\u00e3o calculado por balan\u00e7o de materiais; e que a per meabi1i dade cor r eta dever i a ser calculada usando a \u00falti ma vaz\u00e3o antes do fechamento do po\u00e7o.\nUratet &amp; Ra^hauan Cl 9793 resolveram o mesmo problema usando \u00e0 t\u00e9cnica de diferen\u00e7as finitas\u00bb e concluiram que deveria ser usado o tempo de produ\u00e7\u00e3o correto no m\u00e9todo de ttorner\u00bb e tamb\u00e9m a vaz\u00e3o m\u00e9dia para determina\u00e7\u00e3o da permeabilidade do reservat\u00f3rio.\nSol\u00edmari C19S13 usou a fun\u00e7\u00e3o degrau unit\u00e1rio para representar a condi\u00e7\u00e3o de contorno interna para c\u00e1lculo da press\u00e3o est\u00e1tica ap\u00f3s um per\u00edodo de fluxo com vaz\u00e3o constante.\nCorr\u00eaa C19SS3 apresentou a solu\u00e7\u00e3o anal\u00edtica exata para os per1odos de f1uxo e de est\u00e1tica atrav\u00e9s da solu\u00e7\u00e3o da equa\u00e7\u00e3o da difusividade com uma condi\u00e7\u00e3o de contorno mista. \u00c0 solu\u00e7\u00e3o inclue os efeitos de estocagem e **skin\"\u00bb e foi obtida por transformada de Laplace e generalizada para o caso de v\u00e1rios ciclos de produ\u00e7\u00e3o e fechamento.\nA solu\u00e7\u00e3o geral de Corr\u00eaa para o DST ser\u00e1 usada neste trabalho em conjunto com o algoritmo para invers\u00e3o num\u00e9rica da transformada de Laplase desenvolvido por Stehfest Cl9703\u00bb para a interpreta\u00e7\u00e3o automatizada dos dados de teste de\npress\u00e3o de po\u00e7os n\u00e1a surgentes CDETJ, usando regress\u00e3o n\u00e3o 1inear,\nl.a. HIST\u00d3RICO DA AN\u00c1LISE AUTOMATIZADA DE TESTE DE PRESS\u00c3O\nEcrlou^her \u00bf5 Ker-sch C1972? apresentaram 2 exemplos de an\u00e1lise de teste transiente de press\u00e3o com dados de campo.\nEles usaram a solu\u00e7\u00e3o da fonte linear para reservat\u00f3rio infinito e empregaram um m\u00e9todo de an\u00e1lise de regress\u00e3o para determina\u00e7\u00e3o de par\u00e2metros de reservat\u00f3rio em teste de interfer\u00eancia e fall-off.\nEm 1972 Wernandes &amp; Swtft formularam um algoritmo diferencial de quadrados m\u00ednimos que eliminava os problemas de lineariza\u00e7\u00e3o de sistemas n\u00e2o lineares.\nChen at oi. Cl 9741 compararam a efici\u00eancia de v\u00e1rios m\u00e9todos CSteepest descent, 6<xuss-Atei\u00ed>\u00edon e gradiente conjugado? para obterem ajustes com hist\u00f3rico de press\u00e3o de reservat\u00f3rio.\nEm 1981 Rod^er et al empregaram t\u00e9cnicas de regress\u00e3o n\u00e2o linear para estimar permeabilidade, dif usi vidade, press\u00e3o inicial e dist\u00e2ncia geom\u00e9trica em reservat\u00f3rios limitados sem incluir efeitos de estocagem e \"skin\u201d.\nEm 1983 Rosa testou alguns m\u00e9todos quase Afeu\u00edton Cou seja m\u00e9todos que otimizam usando somente a deri vada pri mei ra? para ajuste autom\u00e1tico de dados de campo em curvas tipo geradas em cada itera\u00e7\u00e3o. Foram considerados modelos de reservat\u00f3rio homog\u00eaneo e heterog\u00eaneos, com estocagem e \"skin\" positivo, mas a an\u00e1lise foi desenvolvida somente para o per\u00edodo de fluxo em po\u00e7os surgentes.\nNo estudo de Roscc as solu\u00e7\u00f2es da press\u00e3o para os diversos modelos de fluxo em reservat\u00f3rios foram obtidas no espa\u00e7o de \u00bf.aptoce, tendo sido invertidas numericamente para o espa\u00e7o real a fim de se fazer o ajuste com os dados de campo. Isto possibilitou n\u00e0o s\u00f3 a estimativa dos par\u00e2metros do reservat\u00f3rio como tamb\u00e9m os do po\u00e7o.\nRosa escreveu a algoritmo de regress\u00e3o passo a passo e explorou v\u00e1rios aspectos dos m\u00e9todos de Gawss e de Gauss-Marguord\u00ed. Ctamb\u00e9m conhecido como Lewember^-N\u00f3rguordO tais como:\ni 3 Si ngular i dade nas matr i zes devi do a depend\u00e9nci a 1 i near entre os par\u00e2metros a serem determinados.\nt i 5 Con J unto de par \u00e1metr os que podem ser deter mi nados par a cada modelo de reservat\u00f3rio.\n\u00a3\u00a3O Influ\u00eancia do par\u00e2metro de Harguardt CX3 que cresce com o n\u00famero de condi\u00e7\u00e3o da matriz.\n\u00bfv? Necessidade de restri\u00e7\u00e3o nos par\u00e1metros para evitar respostas negativas indesej\u00e1veis.\nvi Intervalo de confian\u00e7a dos par\u00e1metros determinados .\nPara cada modelo de reservat\u00f3rio deve-se estudar qual o melhor algoritmo de regress\u00e3o a ser aplicado, e isto parece ser o problema mais dif\u00edcil.\n//orne&lt;&amp; Bctruo C19855 publ i car am v\u00e1rios ar ti gos sobre a escolha e uso de diversos algoritmos para aplica\u00e7\u00e3o em regress\u00e3o n\u00e3o linear para an\u00e1lise de teste de press\u00e3o. Parece que informa\u00e7\u00f5es complementares, como uso de algoritmo cora derivada segunda e ou inclus\u00e3o do comportamento da vaz\u00e3o vs tempo, podem melhorar o mal condicionamento dos par\u00e1metros e at\u00e9 mesmo permitir a determina\u00e7\u00e3o de maior quantidade deles.\nComparando os diversos algoritmos Worns \u00ca gar\u00faa concluem que o m\u00e9todo de Levember^-Narguard\u00ed \u00e9 o melhor Cem t\u00e9rmos de converg\u00eancia e menor trabalho nos c\u00e1lculos das derivadas), quando s\u00f3 existe apenas um par\u00e1metro mal condicionado.\nNeste trabalho ser\u00e1 usado o m\u00e9todo de \u00bfevember^-Norguizrd\u00ed. sem restri\u00e7\u00e3o nos par\u00e2metros do modelo.\n1.3.\tOBJETIVO E METODOLOGIA\nO principal objetivo deste estudo \u00e9 a determina\u00e7\u00e3o dos par\u00e2metros do po\u00e7o e do reservat\u00f3rio automaticamente, atrav\u00e9s do uso de algoritmo de regress\u00e3o n\u00e3o linear, e da solu\u00e7\u00e3o\nrecentemente desenvolvida por Corr\u00eaa. para po\u00e7os n\u00e3o surgentes.\nAs equa\u00e7\u00f3es das press\u00f3es de f1uxo e est\u00e1tica Cl oi cio) ser\u00e3o usadas em conjunto para determina\u00e7\u00e3o da press\u00e3o de fluxo inicial Cp^'J, da press\u00e3o est\u00e1tica do reservat\u00f3rio Cp 3 , da permeabilidade CkX do efeito de pel\u00edcula ou \"\u2018skin\" CS, e dos coeficientes de estocagem no fluxo CCp e est\u00e1tica CC^L).\nComo as solu\u00e7\u00f5es exatas das pressdes dos per\u00edodos de fluxo e est\u00e1tica s\u00f3 s\u00e3o conhecidas explicitamente no espa\u00e7o de toplace, os seus valores e dos seus respectivos gradientes com rela\u00e7\u00e3o aos par\u00e2metros desconhecidos ser\u00e3o obtidos no espa\u00e7o real atrav\u00e9s da invers\u00e3o- num\u00e9rica pelo o algoritmo de S\u00edeh/est C1970J. O ajuste dos dados com o modelo ser\u00e3o ent\u00e3o feito no espa\u00e7o real.\nSer\u00e1 estudado o caso do D\u00a3T em reservat\u00f3rio infinito com fluxo radial, homog\u00e9neo, e inieialmente em repouso.\n2.\tMODELO MATEM\u00c1TICO DO PROBLEMA DE TESTE DE FORMA\u00c7\u00c3O\nA dedu\u00e7\u00e3o da equa\u00e7\u00e3o que descreve o comportamento da press\u00e3o como fun\u00e7\u00e3o da posi\u00e7\u00e3o e do tempo para o fluxo de fluido em um meio poroso, \u00e9 baseada nos seguintes princ\u00edpios: CA)) Conserva\u00e7\u00e3o da massa CED Equa\u00e7\u00e3o de Estado\nCO Equa\u00e7\u00e3o de escoamento Ciei de DarcyD\nQ princ\u00edpio da conserva\u00e7\u00e3o de massa produz a equa\u00e7\u00e3o da continuidade que, combinada com a equa\u00e7\u00e3o de fluxo e com a equa\u00e7\u00e3o de estado adequada fornece a equa\u00e7\u00e3o diferencial que descreve o comportamento da press\u00e3o no modelo proposto.\nPara resolver esta equa\u00e7\u00e3o difer enei al par ci al \u00e9 necess\u00e1rio a defini\u00e7\u00e3o das condi\u00e7\u00f5es iniciais e de contorno.\nComo o DST \u00e9 um teste de curta dura\u00e7\u00e3o, e devido a geometria cil\u00edndrica do po\u00e7o, o fluxo no reservat\u00f3rio pode ser descrito pela equa\u00e7\u00e3o da difusividade em forma radial\n2.1.\tEqua\u00e7\u00f5es dimensionais\nAs equa\u00e7\u00f3es no sistema internacional de unidades ser\u00e3o:\n2.1.1.\tEqua\u00e7\u00e3o diferencial parcial da difusividade\nd2 p +\t1 d p\tp c d p\n\t \t \tL \u2014\tC2.i? d 2 r----------------------------------------------r d r-k &amp; t\nNa deri va\u00e7\u00e3o da equa\u00e7\u00e3o da\tdlf usi vi dade\taci ma\u00bb\nforam feitas as seguintes hip\u00f3teses :\nCl? Fluxo horizontal radial\nCS? Meio poroso isotr\u00f3pico e homog\u00e9neo\nC3? Fluxo monof\u00e1sico\nC4? Fluido com viscosidade constante\nCS? Fluido com pequena compressibilidade\nC6? Gradiente de press\u00e3o pequeno em todo o reservat\u00f3rio\n2.1.2.\tCondi\u00e7\u00e3o inicial do reservat\u00f3rio :\nAssume-se que o reservat\u00f3rio tenha uma distribui\u00e7\u00e3o de press\u00e3o homog\u00eanea antes do teste, ou seja \u25a0.\npC r , O) - p , r > r\tC 2. 2?\nL\tw\n2.1.3.\tCondi\u00e7\u00e3o de contorno externa :\nDevido \u00e0 curta dura\u00e7\u00e3o do DST os efeitos de limites externos do reservat\u00f3rio n\u00e3o afetam o seu comportamento de press\u00e3o.\n11 m pCmt) = p\tC2. 3?\nr=$ tr\n2.1.4.\tCondi\u00e7\u00e3o inicial do po\u00e7o :\nPor causa da entrada instant\u00e2nea de fluido no po\u00e7o e ou a presen\u00e7a de um colch\u00e3o de fluido na coluna de teste, tem-se:\nC2. 43\n2.1,5.\tPer\u00edodo de fluxo :\nComo o per\u00edodo de f1ux\u00fc \u00e9 pequeno e nenhum 1\u00ed qui do \u00e9 pr oduzi do na super f 1 ei e t a taxa de acumul a\u00e7\u00e3o de f 1 ui do no po\u00e7o deve ser igual \u00e0 vazSo da forma\u00e7\u00e3o.\ndp\nq Ct3 - C \u201cw = O\u00bb O &lt;t &lt;t\tC2.53\nw\tf dt\tp\nDetermina-se C pela equa\u00e7\u00e3o de balan\u00e7o de materiais:\n-Vaz\u00e3o do reservat\u00f3rio:\n2nkhr dp qf r 3 =\t. p\tdr\tca. 83\n2nkhpr dp dp\t\nH\t~ Hr\tM\tdp dr\tC2.73\nc w\t1 dp p dr\t\tCequa\u00e7\u00e3o de estado?\t\t\tC2. 83\n\t\t2rrkhpr\t1\tdp\t2rrkhr\tdp\t\nq\t\t\t\t\t\t\u2014\tca. \u00a93\n\t\tp\tc p dr\tp c\tdr\t\n\t\t\tV\t\t\t\nTaxa de acumula\u00e7\u00e3o\t\tde fluido no po\u00e7o\t\t\t\t\n\t\t\t1\t\t\t\nms\t=\tPvdV\t= AJA, dl\t\t\tca. to?\n\t\t\t\t\t\t\ndms\t\t\tdl\t\t\t\n\u2014\t=\tq =\tA p \u2014\t\t\tca.li?\ndt\t\t\tdt\t\t\t\n\t\t1\t\t\t\t\nP\t=\tf p g dh\t\t\t\tca. ia?\n\t\to\t\t\t\t\ndl\t\t1\tdp\t\t\t\n\t=\t\t. \t\t\t\tCa. 133\ndt\t\tP 9 w\tdt\t\t\t\nDerivando parcialmente e substituindo C2, 83 em CS. 133\ntem-se:\n\u00c1\tdp\np g c dt w\nC2.143\nIgualando as equa\u00e7\u00f3es\tC2.S3 e C2.143\tteremos que :\t\n2nkhr\t\u00e2p\tA\tdp\t\n\t\t = \t\u2014\t\u2014\tC2.133\nu a w\t\u00e2r\tp g c V\tdt\t\n\tA\t2 n r\t\nent\u00e3o\tc \u201e\t\u201e \t P\tC2. 163\n\t'\tPu 9\tr V\t\n2.1.6.\tPer\u00edodo de est\u00e1tica\nAp\u00f3s o fechamento, atrav\u00e9s da v\u00e1lvula de fundo, o flu\u00eddo proveniente do reservat\u00f3rio \u00e9 comprimido abaixo do ponto de fechamento, o que pode ser descrito por :\n\tdp\t\t\nq Ct3 w\t_Cs dt\"\to , t > t p\tC 2. 163\nonde:\tC = c \u00e2\tv\tV w\tC2. 163\nA semelhan\u00e7a entre as equa\u00e7\u00f3es do per\u00edodo de fluxo C2.S3 e da est\u00e1tica C2.183 sugere que o problema de DST pode ser visto como um \u201c sl ug test\u201c com uma mudan\u00e7a brusca do coeficiente de estocagem.\n2\u00bb1.7. Condi\u00e7\u00e3o de aclopamento\nAssumindo a exist\u00eancia de um efeito de pel\u00edcula num raio infinitesimal no po\u00e7o. Segundo Van Everd\u00edn^ert &amp; Hurs-t Cl 9333, pode-se relacionar a press\u00e3o do reservat\u00f3rio com a press\u00e3o no po\u00e7o por:\np Ct3 = pCr ,t) -qCO Sf \u00a3 > O\tC2.i\u00a3D\nNo caso de \u201cskin\" negativo pode-se usar o conceito de raio efetivo do po\u00e7o Csegundo Nottews &amp; /\u00edussel C196733:\np Ct3 = pCr ,t3,\tS &lt;O\tC2. 203\nW\tva\n2.2\t~ Equa\u00e7des normalizadas :\nUsando os grupos adimensionais da tabela 2.1 , obt\u00e9m-se\npara o problensa do DST as seguintes equa\u00e7\u00f5es ;\n2.2.1.\tEqua\u00e7\u00e3o da difus\u00edvidade no reservat\u00f3rio:\nd2 pr,\t1\td p\td Pr>\t\no\t+\t\u201e _P =\tD\tC2. 215\n&amp; r n\tr \u00bf? r D\tD\t\u00f4 t D\t\n2.2.2.\tCondi\u00e7\u00e3o inicial do reservat\u00f3rio :\np Cr ,05 = O\tC2. 225\n2.2.3.\tCondi\u00e7\u00e3o de contorno externa do reservat\u00f3rio :\nlim p Cr ft 5\t=0\tC2. 235\nD B D\nr=3 co\n2.2.4.\tCondi\u00e7\u00e3o inicial no po\u00e7o :\np C0+5 = 1\tC2.245\nWD\n2.2.5.\tEqua\u00e7\u00e3o de fluxo no po\u00e7o :\n0<t&lt;t&lt;0\nD pD\nca. 253\no\na. 2. 6. Equa\u00e7ao da est\u00e1tica na po\u00e7a :\ndt\nD\nt >t\nD pD\nC2. 263\nO\n2\u00bb2.7. Equa\u00e7\u00e3o da vaz\u00e3o no po\u00e7o;\nq\tCt 3\t\ta p v - r \u25a0 j, ,\n\\'D\tn\t\tD &amp; t D\nC2. 273\n2* 2.8. Equa\u00e7\u00e3o da vaz\u00e3o na forma\u00e7\u00e3o :\np Ct 3= p Cl,t 3 + S q Ct 3, \u00a3>O\nD\tD\tD\tWD D\np C t 3 = p C e , t ) , S&lt;O \u2018wD D\tD\tD\nC2. 283\nC2. 293\n3.\tSOLU\u00c7\u00c3O DO MODELO MATEM\u00c1TICO PARA PO\u00c7OS NXO SURGENTES\n3.1,\tAs equa\u00e7Ses governantes\nA equa\u00e7\u00e3o diferencial que descreve o escoamento de flu\u00eddo no meio poroso, e as condi\u00e7\u00f3es iniciais e de contorno, que delimitam as hip\u00f3teses de solu\u00e7\u00e3o do problema, j\u00e1 foram discutidas no cap\u00edtulo anterior.\nO problema do DST pode agora ser resolvido analisando o per\u00edodo do fluxo, que pode ser visto como um \"slug test\", e o respectivo per\u00edodo de fechamento. A solu\u00e7\u00e3o ser\u00e1 ent\u00e3o uma fun\u00e7\u00e3o cont\u00ednua por partes, onde:\np Ct3 \u2014 \u2022/\"\tPwfC\u00b0\tse 0&lt;\tt\t&lt;t p\tC3.13\n1\tp Ct3\tse\tt\t> t\tC3. \u00a33\n\t\t\t\tp\t\n3.1.1. Solu\u00e7\u00e3o do\tper\u00ed odo\tde fluxo\tou\t\"Slug testf>\t\nEmbora muitas v\u00eazes seja conveniente trabalhar com as equa\u00e7\u00f3es em forma adimensional t no nosso caso ser\u00e1 preciso escrev\u00ea-la num sistema consistente de unidades. Isto porque deseja-se estimar os v\u00e1rios par\u00e2metros do reservat\u00f3rio, os quais precisam aparecer explicitamente na solu\u00e7So da equa\u00e7\u00e3o diferencial.\nPara o per\u00edodo de fluxo o problema estar\u00e1 bem posto com as equa\u00e7des C2. 213 a C2. 233 mais as equa\u00e7Ses C2.283 ou C2.293. Todas elas est\u00e3o reunidas no Ap\u00eandice A que apresenta esta solu\u00e7\u00e3o do \u201dslug test\" atrav\u00e9s do uso de transformada de Lctplcce.\nA equa\u00e7\u00e3o CA.183 que mostra a solu\u00e7\u00e3o final no espa\u00e7o de Ltxpltxce. \u00e9 dada por Cem unidades do Sistema Internacional}:\n% 1\tKoC r\t~\u2018/\u2019n 3 *\tw\t\"S s +\t2nkh p.\n\trW-/*^ K\u2018Crv/1\u00c7? ,\tCf p s\ns \u2022<\t\t\"\"* KoCr y \"/d 3 r\tW\tn s -#\u25a0\t2nkh\n\tr / s \u2019 K\u00b1Cr / s *3 wv Z77\tvV ZfJ\tJ\t\u25a0\t+\tA\t Cf p\nOs par\u00e2metros do reservat\u00f3rio estimados pela equa\u00e7\u00e1o acima normalmente s\u00e3o: permeabilidade Ck3f fator de pel\u00edcula CS3. e press\u00e3o de fluxo inicial ou de abertura Cp^3. A an\u00e1lise cartesiana convencional permite, em alguns casos, a estimativa da transmi ssibil idade CkhZpi e do fator de pel\u00edcula CS3.\nA t\u00e9cnica de ajustagem em curva tipo Cfetmey -\t1970?\npropSe a estimativa da transmissibilidade CkhZ(u3f e do\nproduto \u00e0o fator de pe\u00ed i eula C 25 pe\u00edo eoef iciente de estocagem adi mena!onal\tsendo que na pr\u00e1tica este\nprocedi mento de ajustagem \u00e9 muito dif\u00edcil de ser' obtido.\nObservando-se a equa\u00e7\u00e3o C3. 35 que rege o comportamento da press\u00e3o de flujos em po\u00e7os n\u00e3o surgentes, nota-se que n\u00e3o \u00e9 poss\u00edvel obter a invers\u00e3o anal\u00edtica para o espa\u00e7o real devido \u00e0 complexidade da express\u00e3o,, a qual \u00ea fun\u00e7\u00e3o n\u00e3o linear dos par\u00e2metros do sistema.\n3.1.2.\tSolu\u00e7\u00e3o do per\u00edodo de est\u00e1tica ou do problema de DST\nA solu\u00e7\u00e3o deste problema foi desenvolvida por Corr\u00eaa\nCl98851 sem envolver superposi\u00e7\u00e3o , atrav\u00e9s do uso de uma\nnova condi\u00e7\u00e3o de contorno interna dependente do tempo.\nUma vez que o po\u00e7o \u00e9 fechado\u00bb a produ\u00e7\u00e3o do reservat\u00f3rio fica confinada abaixo do ponto de fechamento e a press\u00e3o est\u00e1tica \u00e9 afetada pela magnitude do coeficiente de estocagem\ndo po\u00e7o. Um balan\u00e7o de materiais nesse per\u00edodo nos fornece a equa\u00e7\u00e3o C2.285.\nA semelhan\u00e7a entre as equa\u00e7des C2.235 e C.2. 265 sugere que o problema de DST pode ser visto como uma solu\u00e7\u00e3o de \"slug test1\u2019 com uma mudan\u00e7a do coeficiente de estocagem. Para todos\nos tempos menores que t , o mecanismo de produ\u00e7\u00e3o \u00e9 governado pela mudan\u00e7a do n\u00edvel de l\u00edquido no po\u00e7o, e ap\u00f3s o fechamento\ndo po\u00e7o C tempos maiores que t 5, o mecanismo passa a ser P\ndominada pela compress\u00e3o do fluido no volume confinado abaixo do ponto de fechamento.\nAs equa\u00e7\u00f3es CS.255 e CS.265 podem ser combinadas\u00bbatrav\u00e9s da fun\u00e7\u00e3o degrau de Weovts\u00edde\u00bb que \u00e9 apresentada na Figuras 3.1\u00bb gerando uma nova condi\u00e7\u00e3o de contorno.\n1\n1\no\no\nFigura 3.1 - Fun\u00e7\u00e3o degrau unit\u00e1rio e seu complemento\nEsta nova condi\u00e7\u00e3o de contorno interna para o problema do\nDST \u00e9 v\u00e1lida para todos os tempos de teste:\n[C1\u201cS,3 C + S, C\t]\tdp 'JB\td p\tn - r a .\t\t=\t0\u00bb\tt\t> 0\nk\tfD\tk aD\tdt\tD d t\t\t4\tD\t\n\tD\tD\tJ\tr = D\t1\tC3. 43\nonde k \u00e9 equivalente\tao\ttempo de produ\u00e7\u00e3o\t\tt . p\t\n0 problema de\tDST\tpoder\u00e1 ent\u00e3o\tser\tresolvido\tse\ntormarmos as equa\u00e7Ses CS. 213 a CS. 263, CS. 283 ou C2.283 e a equa\u00e7\u00e3o C3.43 acima.\nPara se resolver esta equa\u00e7\u00e3o diferencial com as respectivas condi\u00e7Ses de contornos e iniciais, incluindo a condi\u00e7\u00e3o de contorno dada por C3.43, atrav\u00e9s de t\u00e9cnicas de\nTransformadas\t\t\tde\tLcpiace, foram\tdesenvoivi das por\tCorr\u00eaa\nnovas\tregras\t\tpara\ttransformadas das\tquais ser\u00e3o usadas:\t\nH\t\u00a3fc\tFCt3 J\t=\tk fCs3 - Je\"st FCt3 dt o\t\tC3. 53\nt\t\t\t\t\t,\tk\tA \u201dltS\tr* \u201cSt\t\nn J i\tc?\t4\tk, W ,>Z\t}\ts fCs3 - FCk_3e\t\" Je\tFCt3 dt o\tC3. S3\nQ ap\u00eandice C mostra o desenvolvimento te\u00f3rico da solu\u00e7\u00e3o exata em forma di mensi onal deste pr oblema f no espa\u00e7o de taplace, para o Sistema Internacional de unidades\u00bb que \u00e9:\nZ\nl\"ws\nonde:\ns\nS\n+\n1\nKoCr /szk5 ____y______\n\nr \u25a0/sZk KiCr t/ s/k5> w\tw\n+ c -\nc\nf t\np\n|e~stp ,Ct?'dt+C,Uc J\tvf\td .\no\t-5\nv\na\n1\nX\n+\nS\nc\ne\nC 2nh/p5 k\nC3. 75\n\nC\n0\nC \u201cc\nC3. 8?\nC2nh/p5 k\nC8nh/p5k\nr\n\u201cd\n\u201cSt\n= Prf e\tp\nc\nf\nC3. 95\nC\ne\nPo\nC3.105\nA\n-FTt\ndever \u00e1\nC 2rh/p5 k\nbtenc\u00e3o do comportamento de ser feita atrav\u00e9s da invers\u00e3o\npress\u00e3o no num\u00e9rica da\nExiste aqui a n\u00e3o linearidade da par\u00e2metros do reservat\u00f3rio e do po\u00e7o,\nr eservat\u00f3r1o nor malmente\nfun\u00e7&amp;>\ncom\ncampo real\neq. C3.75,\nrela\u00e7\u00e3o aos\nm\u00e9todos\nOs par\u00e2metros de de an\u00e1li se\nde\nestimados pelos no per1odo de\nest\u00e1tica\nn\u00e3o\npar a po\u00e7os de pel\u00edcula reservat\u00f3rio Cp,5.\nt,\nA an\u00e1lise convencionai semi-log ter apli ca\u00e7\u00e3o restrita aos casos vaz\u00e3o constante, com o uso do tempo\nbalan\u00e7o de materiais. Determina-se ent\u00e3o k,S e pi.\nefeitos\nou\nteste de press\u00e3o\nsurgentes sfc: permeabilidade Ck5 , \"skin\" CS5 e press\u00e3o est\u00e1tica do\nCm\u00e9todo de Horner5 parece de po\u00e7os produzidos com de produ\u00e7\u00e3o calculado por\nA an\u00e1lise cartesiana Cm\u00e9todo de Corr\u00eaa? \u00e9 aplic\u00e1vel para po\u00e7os onde o tempo de fechamento seja longo,se comparado ao tempo de produ\u00e7\u00e3o, para a determina\u00e7\u00e3o de k e p Para a determina\u00e7\u00e3o do \u201cskin*\" faz-se o estudo do per iodo de fluxo\npelas curvas de \"slug test\" ou usa-se uma f\u00f3rmula que se baseia na hip\u00f3tese de produ\u00e7\u00e3o com vaz\u00e3o constante.\nA an\u00e1lise atrav\u00e9s de curva tipo n\u00e3o \u00e9 dispon\u00edvel para o per\u00edodo de est\u00e1tica em po\u00e7os n\u00e3o surgentes.\n4.\tESTIMATIVA DOS PAR\u00c2METROS POR REGRESS\u00c3O NAO LINEAR\nA determi na\u00e7\u00e3o dos par\u00e2metros do po\u00e7o e do reservat\u00f3ri o por regress\u00e3o n\u00e3o 1i near pode ser fei ta no per1odo de f1uxo, no per\u00edodo de est\u00e1tica ou em ambos os per\u00edodos de teste simuitaneamente.\nA Figura 4.1 com as equa\u00e7bes C3. 33 e&lt;3.73 definem o modelo esquem\u00e1tica e matematicamente.\nTempo\nFigura 4.1 - Desenho esquem\u00e1tico de um DST\nAs inc\u00f3gnitas do modelo s\u00e3o os par\u00e2metros do reservat\u00f3rio.\nDeseja-se determinar os valores de par\u00e2metros que fazem as equa\u00e7bes&lt;3. 33 e C3. 70 ajustarem-se aos dados de press\u00e3o\nobtidos do teste de campo, resultando em um problema ajustagem de um mod\u00e9lo n\u00e3o linear.\n4.1.\tEscolha do m\u00e9todo de estimativa\n\u00c0pesar de existirem v\u00e1rios m\u00e9todos para a estimativa de par\u00e2metros em regressSo, ser\u00e1 usado neste trabalho o m\u00e9todo dos quadrados m\u00ednimos.\nSeja\to valor te\u00f3rico da press\u00e3o no po\u00e7o no tempo\nti,definido pela invers\u00e3o num\u00e9rica das equa\u00e7Ses C3. 33 ou C3.9\\ dependendo do valor de t ser maior ou menor que o tempo de produ\u00e7\u00e3o t .\nSeja \u00edp ] o valor registrado ou observado de press\u00e3o no teste do po\u00e7o n\u00e3o surgente no tempo t .\nO procedimento do m\u00e9todo dos quadrados m\u00ednimos procura minimizar a soma dos quadrados dos res\u00edduos definida por:\nSSRCfo =\t- Pupt }\tC4.15\n*\tf\nonde x- Ck,S,p ,p.,...C.,C3 \u00e9 o vetor formado pelos m O L\tI S\npar\u00e2metros desconhecidos* cujos valores devem ser determinados.\nSSR \u00e9 fun\u00e7\u00e3o somente dos par\u00e2metros do reservat\u00f3rio, pois a vari\u00e1vel tempo \u00e9 conhecida. SSR d\u00e1 uma medida da proximidade ou afastamento dos pontos reais do mod\u00e9lo te\u00f3rico e \u00e9 conhecida como fun\u00e7\u00e3o objetivo.\nProcura-se por um vetor x no qual a fun\u00e7\u00e3o objetivo seja m\u00ednima. A determina\u00e7\u00e3o do valor m\u00ednimo de SSRCxj denomina-se otimiza\u00e7\u00e3o, a qual pode ser do tipo restrito ou irrestrito.\nQuando o problema a ser resolvido n\u00e3o imp\u00f3e nenhuma restri\u00e7\u00e3o sobre os valores que as vari\u00e1veis independentes podem assumir, o m\u00e9todo \u00e9 dito sem restri\u00e7\u00e3o, \u00c0lguns destes m\u00e9todos s\u00e3o: gr adi ente pr oj etado, gr adi ente reduzi do, gradiente conjugado, m\u00e9todo de N&amp;wton e quase Wewtcn Cou Newion modificado!), etc.\nOs problemas de quadrados mi nimos n\u00e3o 1i neares s\u00e3o um caso especial de minimiza\u00e7\u00e3o sem restri\u00e7ESes, embora para\nmuitos problemas j\u00e1 se sabe a prior\u00ed que certos valores s\u00e3o inaceit\u00e1veis como solu\u00e7\u00e3o.\nAs restri\u00e7\u00f5es nos valores das vari\u00e1veis s\u00e3o do tipo 1i near e n\u00e3o 1i near .\nNa otimiza\u00e7\u00e3o restrita existem dois m\u00e9todos b\u00e1sicos:\n1. Transformar o problema r estr1 to numa sequ\u00eanci a de problemas irrestritos; com isto a solu\u00e7\u00e3o n\u00e3o \u00e9 fact\u00edvel mas \u00e9 \u00f3tima. Tamb\u00e9m o valor inicial nSo precisa ser fact\u00edvel. Os m\u00e9todos mais usados s\u00e3o: o m\u00e9todo de penalidades, o m\u00e9todo de barreiras Cque \u00e9 uma exce\u00e7So pois a solu\u00e7\u00e3o e o valor inicial i ni ci al s\u00e2to f acti vei sJ, duali dade\u00bb 1agrangeano aumentado e lagrangeana projetado.\nS.\tAdaptar as t\u00e9cnicas de otimiza\u00e7\u00e3o irrestrita onde a solu\u00e7\u00e3o \u00e9 sempre facti vel e tamb\u00e9m o vaior forneci do inicialmente necessita ser fact\u00edvel. C?s m\u00e9todos mais usados s\u00e3o: Gradiente projetado,Gradiente reduzido,etc.\nAdotar um m\u00e9todo de otimiza\u00e7\u00e3o restrita parece mais vantajoso, pois j\u00e1 se sabe que par\u00e2metros como por exempla a permeabilidade e press\u00e3o de reservat\u00f3rio n\u00e3o podem assumir valores negativos. Por\u00e9m estes algoritmos t\u00eam de ser desenvolvidos para cada modelo espec\u00edfico, considerando as restri\u00e7\u00f5es desejadas. Os algoritmos sem restri\u00e7\u00f5es funcionam bem para valores iniciais pr\u00f3ximos da solu\u00e7\u00e3o e ser\u00e3o usados neste trabalho.\n4.2.\tEscolha do m\u00e9todo de procedimento para o problema de de quadrado m\u00ednimo n\u00e3o linear\nO problema de quadrados m\u00ednimos n\u00e3o lineares, para ajuste de dados\tL~ ......n- com um modelo pCx,t^D\nconsiste em se determinar um vetor x, tal que o ajuste seja o melhor poss\u00edvel, no sentido de que a soma dos quadrados dos res\u00edduos seja minimizada.\nDa equa\u00e7\u00e3o C4.13, seja :\nconhecida como fun\u00e7\u00e3o residual, a qual\n\u00e9\nO problema se torna ent\u00e0o :\nMin\nonde n > m e FCxJ V\n\u00e9 n\u00e1o linear em x.\nSerSo apresentados a seguir, alguns m\u00e9todos para resolver\nproblemas de quadrados m\u00ednimos nSo lineares segundo Dennts &amp;\nSehnabell Cl\u00a3833 .\n4.2.1.\tM\u00e9todo de Newtan. para quadrados m\u00ednimos rs\u00e1o lineares\nAs derivadas de SSRCxJ s\u00e3o : primeira derivada\tn\n7 SSRCxD- aV F.Cx2>-7 F.Cx^ = 2JJC xJL. FCxJ \u00bf1 L\tL\ti\ni=l\tC4.4J\nsegunda derivada x_\tn\n72SSRCx3= sY CVF.C&amp;.V F.C&amp;1 + FCxJ72FCx3J\nZj\tt\tv\tL\tL\nt=\u00ed\tC4.5J\n=\tSC^C\u00e3bjJC^ +\tDSC\u00edb?\tC4.83\nm\nonde\tDSCx3\t=\tJ FCxOS^FC\u00edb\tC4.\u00a3D\nt = 1\to\nDSCxJ s\u00e3o informa\u00e7Ses de FCxJ de segunda ordem em v \u00a3SR.\nO m\u00e9todo de Wewton aplicado ao problema de minimiza\u00e7So sem restri\u00e7des fornece o valor de x, dado um vetor inicial x , atrav\u00e9s da seguinte express\u00e3o:\n$ -\t[d?^k + DS ] d\u00a3 Ffc\tC4. 102)\nA sua converg\u00eancia \u00e9 quadr\u00e1tica mas a maior dificuldade \u00e9 para se obter DSCxJ, ou seja a express\u00e3o da 2a, derivada, al\u00e9m da estimativa de DSCxZJ exigir aproximadamente Cm2 + 3m D avalia\u00e7des da fun\u00e7\u00e3o res\u00edduo FCx> por itera\u00e7\u00e3o.\n4.2.2.\tM\u00e9todo de Gctuss para quadrados m\u00ednimos n\u00e3o lineares\nJc\nDada uma aproxima\u00e7\u00e3o $ \u201e os m\u00e9todos tipo Cuuss Cou Ga.uss~N&amp;wt.oriG usanu para determinar uma nova aproxima\u00e7\u00e3o )R para o mod\u00e9lo linear de FCx? em torno de\ta seguinte\n\u00ca?ss si So *\n\u00c3 = \u00cak- [ JkJ>k ] *j\u2018 Fk\tC4.11J\n\u00c0s equa\u00e7\u00f5es C4.10? e C4.11? diferem somente peio t\u00earmo DSCx?.\nOutras conclusSes do m\u00e9todo de Gauss :\n~\u00c1 converg\u00eancia local \u00e9 quadr\u00e1tica em problemas de res\u00edduo zero,\n-A converg\u00eancia local \u00e9 linear em problemas n\u00e3o lineares e que tenham res\u00edduos razoavelmente pequenos.\n-Resolve problema de quadradas m\u00ednimos lineares em uma \u00edtera\u00e7\u00e3o.\n-Converg\u00eancia local linear lenta em problemas que s\u00e3o suficientementes n\u00e3o lineares ou que tenham res\u00edduos razoavelmente grandes.\n-N\u00e3o convergente localmente em problemas que sejam muito n\u00e3o-lineares ou que tem res\u00edduos muitos grandes.\n4.2.3.\tM\u00e9todo de \u00bfeuember#-#orguord\u00ed ou \u00facuss-Nctrquardt para problemas de quadrados m\u00ednimos n\u00e3o lineares.\ntforguord\u00ed. Cl963? desenvolveu um m\u00e9todo que evita a di verg\u00e9nci a do m\u00e9todo de iScws\u00ed e tamb\u00e9m acelera a converg\u00eanci a do m\u00e9todo gradi ente. Ele mostrou que resolver o sistema (E \u00c8\u00d4 = $ \u00e9 equivalente a resolver o sistema:\nC E + 1 3 1 \u00a1D = QJ\tC4. IS?\nonde 0 \u00e9 a matriz identidade e X \u00e9 uma constante.\n\u00c0s itera\u00e7des s\u00e3o dadas pela express\u00e3o :\n$ =\t[yj), +10 ] S1 F\tC4.13?\nk k\t** k k\nA solu\u00e7\u00e3o do vetor de par\u00e2metros a serem determinados ap\u00f3s cada itera\u00e7\u00e3o k+1 \u00e9 dada em termos da solu\u00e7\u00e3o k> por:\n$<W\u00b1\u00cd =\t+\tC4.14\u00cd\nonde \u00ed\u00d4 \u00e9 a solu\u00e7\u00e3o do sistema normal de equa\u00e7\u00f5es modificadas pelo m\u00e9todo de Zfctr quctr d t.\nO procedimento ser\u00e1:\nCaJ Iniciar com X = O. 01\nCbJ Substituir X por O. IX se SSR^<k + il \u00a3 &lt;SSR{$<k)^\nCcD Caso contr\u00e1rio determinar um fator de relaxa\u00e7\u00e3o dado por\n= \u00e1<k>+\ttal que ssg^C^Op ssR^Ck^\ne substituir X por 10X.\nConclus\u00f5es sobre o m\u00e9todo de \u00bfevember^-M\u00edzrquujrd\u00ed.:\n-Se o res\u00edduo de F\u00edx for zero, o m\u00e9todo converge quadraticamente.\n-O m\u00e9todo pode ainda, ter converg\u00eancia local lenta em problemas de res\u00edduos grandes ou muito n\u00e3o lineares.\nEste m\u00e9todo \u00e9 melhor que o de Gauss quanto ao:\nO mal condicionamento da matriz do sistema. \u00a3\u00bf3 tamanho do passo na dire\u00e7\u00e3o da m\u00e1xima descida.\nExistem tamb\u00e9m os m\u00e9todos tipo secante para problemas de quadrados m\u00ednimos n\u00e3o lineares, que na pr\u00e1tica s\u00e3o muito eomplexos quanto a i mplementa\u00e7\u00e3o, e devem ser apli cados a problemas com res\u00edduos grandes ou n\u00e3o muito lineares.\nUma boa implementa\u00e7\u00e3o dos m\u00e9todos de Cause-?fezrqtt\u00edxrdt e do m\u00e9todo secante fornece valores semelhantes, para problemas de res\u00edduos relativos pequenos ou pouco n\u00e3o lineares.\nPela simplicidade e disponibilidade de v\u00e1rias implementa\u00e7\u00f5es do m\u00e9todo de Gauss-\u00ed\u00edcxrguardi, al\u00e9m de outras utiliza\u00e7\u00f5es em problemas semelhantes com sucesso, justifica-se o seu uso neste trabalho. A vers\u00e3o do algoritmo utilizada \u00e9 a apresentada por Press, ht H. \u00aet oi. C\u00cd98\u00d5J.\n4.3.\tJustificativa te\u00f3rica do uso do m\u00e9todo na determina\u00e7\u00e3o, de k, Se p^\nPara a utiliza\u00e7\u00e3o de algoritmos de\notimiza\u00e7\u00e3o sem\nrestri\u00e7\u00e3o aos problemas de quadrados m\u00ednimos n\u00e3o lineares\u00bb\ntem-se que determinar o m\u00ednimo da fun\u00e7\u00e3o objetivo:\n2{tf\u2019W1t=V - pwp. }\n\u00c2 condi\u00e7\u00e3o necess\u00e1ria para exist\u00eancia de m\u00ednimo \u00e9 que a derivada primeira se anule:\nC4.153\nlogo\ndSSFCx3 -------- = o\nC4.183\nn\nV SSRCx3 = V F.Cx3.V F.Cx3 \u00a3j v\ti\n1=1\nC4.173\nQuando se tem 7FCx3 anui ado. obtem-se o m\u00ednimo\nda fun\u00e7\u00e3o\nres\u00edduo e tamb\u00e9m o m\u00ednimo da fun\u00e7\u00e3o objetivo.\nComo se deseja minimizar\no desvio entre as\npress S\u00edes\nobservadas e te\u00f3rica\nF\u00c7x3\n[ p ] ,\t-\n*v t =t\ni\npelo m\u00e9todo de Gauss-\u00edtorquardi\tdeveremos\nlineariza\u00e7\u00e3o de cada res\u00edduo\nC4.183\nf azer\nF, L\nna\ns\u00e9rie de Taylor at\u00e9\ncyrpr 3\")\n\u00e2 x\np\nO\na\na\nderivada primeira\nF.Ck \u00bbStp.3 t\tt\n<3F.\nCS-S 2\nOf\ndS 3s=s\nO\n<?F\n<?k\n#F.\nL\ndp.\nCk\u201cko3 + k=k\no\nCp. -p. 3 C 4. 193 *1 vO\np. =p.\nt vo\n+\nSendo os gradientes calculados\n1 ni o\u00edais\npr\u00f3xi mos\nPara\nC4. 203\nC4. 213\nolutrf\tno\nespa\u00e7o\nreal\npois\n\u00bfaplace:\nd F.C x\u00bbt 2 t\tM \"I\t\tdp 1 a x }\u2022\nd\t\u2014\t\n\tX. J\tj\n\tonde\tj\t~ 1,2,\t,m.\nC4. 243\nAs expressSes das derivadas com rela\u00e7\u00e3o a cada par\u00e2metro encontram-se no ap\u00eandice B para o per\u00edodo de fluxo\u00bb e no ap\u00eandice D para o per\u00edodo de est\u00e1tica.\nPode-se tamb\u00e9m usar um algoritmo que avalie numericamente estas derivadas em rei a\u00e7\u00e3o aos par\u00e2metros, atrav\u00e9s de diferen\u00e7as finitas.\n5.0. INTERPRETA\u00c7\u00c3O AUTOMATIZADA EM DADOS SIMULADOS\nPara evitar problemas causado pelos dados, fixaram-se os dados de flu\u00eddo e rocha CTabela 3.1D e geraram\u2014se dados de pr ess\u00e0d vs tempo pel o pr ogr ama do anexo H CTabela 5. 23.\nPar\u00e2metro\tvai or assumi do\tuni dade\nPermeabl1i dadeC k 3\t1.384\tDorcy\nFlu\u00eddo: \u00d5leo\t25. 92\tAPI -i\nCompr. total Cc*}\t149. 9\tatm\nEfeito Pelic.CSJ\t-2.\t-\nP. flux\u00bb \u00edn.Cpp\tS. 85\tatm\nP. est\u00e1tica Cp.3 L\tao. 68\tatm\nVi scosi dade C p3\t60.\tcp\nEspessura\tCh?\t38.\tp\u00e9s\nRaio po\u00e7o\tCr&lt;3\t4. 248\tpol.\nRaio tuba\tCr 3 p\t1.908\tpol.\nPorosidade\tC$0\t0.062\t\u2014\nTabela 5.1-Dados de flu\u00eddo e rocha para \"slug test\" simulado.\ntc hr3\tPufCpsig3\ttChr3\tPvfCpsig3\ttC hr3\tPu(Cpslg2\n0. 022\t151.968\t0.166\t359.328\t0. 470\t377.893\n0. 026\t160. 472\t0. 187\t380. 819\t0. 328\t604.529\n0. 034\t176.479\tO. 209\t401.907\t0. 590\t629. 653\n0.041\t189. 614\t0. 235\t425.153\t0. 662\t655.165\n0. 053\t210. 657\t0. 264\t449.182\t0.774\t688. 467\n0. 067\t233.345\t0. 295\t472. 901\t0. 833\t703. 914\n0. 084\t258.766\t0. 334\t300. 206\t0. 938\t726.506\n0. 106\t288.897\t0. 372\t524.424\t1.051\t747. 149\n0. 132\t321.266\t0. 418\t530.996\t1.126\t758.896\nTabela 5.2 - Dados gerados de press\u00e3o de fluxo vs tempo.\n5.1.\tOTIMIZA\u00c7\u00c3O NO PER\u00cdODO DE FLUXO\nGRADIENTES POR DIFEREN\u00c7AS FINITAS\nCOM C\u00c1LCULO DOS\nO c\u00e1lculo dos par \u00e2metros ser\u00e1 Lei to\nconsiderando-se os dados referentes ao per\u00edodo\ni ni oi almente\nde f 1 uxo do\nteste de forma\u00e7\u00e3o.\nSabe-se que, o m\u00e9todo de Levember^-Wargiiord\u00ed defi ni do pei a equa\u00e7\u00e3o C 4.133 exi ge que calculemos as derivadas da fun\u00e7\u00e3o objetivo com rela\u00e7\u00e3o \u00e0s inc\u00f3gnitas in\u00fameras vezes, porque a solu\u00e7\u00e3o \u00e9 encontrada atrav\u00e9s de uma sequ\u00eancia de aproxima\u00e7tSes at\u00e9 o ponto de m\u00ednimo.\nPode-se calcular estas derivadas por avan\u00e7adas:\ne?F\ndi f eren\u00e7as fi ni tas\n{\n}\ndx.i\nh j\nou diferen\u00e7as centradas;\n1\nh.3\nj\n- f Cx>\nt\ndx j\n/ f.Cx\n2h. I 1\nhD\nj\nf .Cx\nL\n-h .3 j\ncomputador, J o n\u00famero\nde\npar\u00e2metros, e \u00ed=\n\n4-\n+\n}\nequa\u00e7\u00e3o C3.33 atrav\u00e9s\nter mos.\nAs pressSes ser\u00e3o calculadas pela\ndo algoritmo de invers\u00e3o num\u00e9rica de Steh/es\u00ed com 8 \u00c0 i mplementa\u00e7\u00e3o do m\u00e9todo de mi ni mi sa\u00e7\u00e3o por m\u00ednimos de \u00bf.evember^-Zforquord\u00ed. * calculando-se as\nquadrados\nder i vadas\npor diferen\u00e7as finitas\u00bb ser\u00e0 feita atrav\u00e9s de um programa da biblioteca de\trotinas- matem\u00e1ticas do IMSL para\nmicrocomputadores padr\u00e3o IBM-PC, a fim de testar a aplicabilidade do algoritmo apresentado no ap\u00eandice G.1.\nO per\u00edodo de f1uxo do DST C ou \"siug test\"3 depende basicamente de 4 par\u00e2metros do reservat\u00f3rio, que para estes\ndados gerados apresentados na Tabela 3.2 s\u00e3o k = 1.384 Darcy. r = *^40 cm3/atm\u00bb S = -8 e p = 3 85 atm.\nT\to\nNa primeira tentativa aplicou-se o algoritmo para a deter mi na\u00e7\u00e3o de todos os 4 par \u00e2metros. A segui r apli cou-se\nnovamente o m\u00e9todo para se determinar 3 par\u00e2metros \u20acfixando 1 par\u00e2metro} e finalmente para se determinar 3 par\u00e1metros Cfixando 3}.\nOs valores iniciais arbitrados foram os mesmos nas 3 tentativas\u00bb sendo k = i. 00 Dcrcy, C = 80000 cm3/atm, S = 0. 0 e p =5. 85 atm.\na\nO crit\u00e9rio de converg\u00eancia adatada exige que a diferen\u00e7a entre a soma dos quadrados dos residuos entre 2 itera\u00e7\u00f5es sucessivas seja menor que 10~ .\nA Tabela 3.3 abaixo apresenta o resumo, dos resultados.\nParametros\tSolu\u00e7\u00e3o\tNum.\tSSR\tValor\tErro\narbitrados\tcalculada\ttotal\t\treal\tper-\ninicialmente\t\titera-\t\tparam.\tcen-\nCsis. Dorcy?\tC s. Darcy}\t\u00e7Ses\tCatm2}\tC s. Dcrcyl\t%\nk =\t1.\tk = o. so\t\t3x10\u21226\tk =1.384\t-35.\nS =\t0.\tS =-l. 79\tS\t\t\t-10.\np =\t9.69 o\tp = 5. 85 o\t\t\t\t0.\nC = 80000 f\tC = 58500\t\t\tS = -2.\t-31\nk =\t1.\tk =1.05\t\t\t\t-24.\nS =\t0.\tS = -l. 86\t9\t3x1O~5\t\t\nC( = 80000\tC = 64460\t\t\tp =5\u00bb 85 Q\t-24.\nk =\t1.\tk = 1.383\t8\t\"**6 7x10\t\t0. 07\nC \u201c 80000\tC = 85200\t\t\tC =85240\tO. 05\nTabela 3.3 ~ Resultado do m\u00e9todo de L&amp;vember-g-tfarquard.t com c\u00e1lculo das derivadas por diferen\u00e7as finitas para o periodo de fluxo do DST, tentando-se calcular k, S, Cf e p .\n3.1.1.\tDiscuss\u00e3o do m\u00e9todo usado e dos resultados\nUma vez que a soma dos quadrados dos res\u00edduas s\u00e3o da \u20143\nordem de 10 ou menor, os 3 resultados podem ser aceitos\ncomo solu\u00e7\u00abto do problema\u00bb por\u00e9m como os dados foram gerados ar ti f i clalmente e a solu\u00e7\u00e3o correta \u00e9 conheci da, v\u00ea-se que existe eombina\u00e7\u00e3o de par\u00e2metros que n\u00e3o reproduzem a solu\u00e7\u00e3o verdadeira com unicidade. A causa disto pode ser a alta\ncorrela\u00e7\u00e3o existente entre os par\u00e2metros a serem\ndeter mi nados,\nou o \u00ear r o no\ne\u00e1l cul o das\nderivadas por\ndiferen\u00e7as fi ni tas,\ndevido a\nprecis\u00e3o\ndo\ncomputador\ne a\nsensibilidade do m\u00e9todo com rela\u00e7\u00e3o ao n\u00famero de par\u00e2metros a\nserem estimados.\nPode-se pesquisar todas as combina\u00e7\u00f5es poss\u00edveis de par\u00e2metros com este algoritmo\u00bb mas devida ao longo tempo envolvido no c\u00e1lculo das derivadas\u00bb esta pesquisa ser\u00e1 feita calculando-se as derivadas atrav\u00e9s de invers\u00f5es num\u00e9ricas de express\u00f5es anal\u00ed ticas.\n3.2\t- OTIMIZA\u00c7XO NO PER\u00cdODO DE FLUXO\nA otimiza\u00e7\u00e3o para o per\u00edodo de fluxo ser\u00e1 baseada no c\u00e1lculo dos gradientes de press\u00e3o por invers\u00e3o num\u00e9rica das express\u00f5es no espa\u00e7o de \u00bf.cxplcxce.\nO ap\u00eandice B apresenta as derivadas da solu\u00e7\u00e3o do per\u00edodo de fluxo, com rela\u00e7\u00e3o aos par\u00e2metros k\u00bb S, p\u00a3 \u201e p^ e Cf.\nPara aplica\u00e7\u00e3o do m\u00e9todo foram usados:\nil> O algoritmo de SteZi/est \u201e para a invers\u00e3o num\u00e9rica das express\u00f5es da press\u00e3o e derivadas obtidas no espa\u00e7o de Laploce\u00bb com 8 termos.\niiD Um crit\u00e9rio de converg\u00eancia baseado na varia\u00e7\u00e3o da soma dos quadrados dos res\u00edduos entre duas itera\u00e7\u00f5es sucessivas,\n! SSR - SSR. j &lt;IO-2,\niii3 Valores iniciais dos par\u00e2metros arbitrados de modo a evitar a diverg\u00eancia ou impossibilitar converg\u00eancia nas i tera\u00e7\u00f5es sucessivas.\ni\tv3 Uso das equa\u00e7\u00f5es A. 16, B. 1.8\u00bb B. 1.12\u00bb\tB.1.13\u00bb B. 1.14 e\nB. 1.15 para c\u00e1lculo da press\u00e3o e dos gradientes de press\u00e3o.\nv3 O programa de otimiza\u00e7\u00e3o apresentado no anexo G.2.\nPara o teste do m\u00e9todo foram geradas presst\u00e2es de f 1 uxo com o programa apresentado no Ap\u00eandice F. Os par\u00e2metros fixados para as propriedades de fluido e rocha estSo na Tabela 5.4\u00bb e os valores obtidos de pressSo vs tempo est^o na Tabel a 5.5.\nPar\u00e2metro\tvaior assumi do\tuni dade\nPer meabi1i dadeC k1\t1.384\tDtrrcy\nEstoc. fluxoCCD f\t85240\t3 cm Zatm\nEfeito Pelic. C3D\t2.\t\nP. fluxo in. Cp 2? G\t5. 85\tatm\nP. estatica Cp. 2?\t60. 68\tatm\nViscosidade Cp\u00ed\t60.\tcp\nEspessura\tCh>\t38.\tp\u00e9s\nRalo po\u00e7o\t4. 248\t\u00a33Ojl *\nPor osi dade\tC&lt;f\u00fc\t0.062\t\u2014\nTabela 5.4 -Dados de flu\u00eddo e rocha para \"slug test\" simulado\ntChrZ)\tPvfCpsigD\ttChr?\tPvfC psi gl\ttChrD\tPwfCpsig5\n0. 022\t107.887\t0. 166\t215. 743\t0. 470\t381.277\n0. 026\t111.445\tO. 187\t229. 337\t0. 528\t406.778\n0.034\t118. 367\t0.209\t243. 156\t0.590\t432.344\n0. 041\t124. 266\t0. 235\t258. 970\t0. 662\t460. 022\n0. 053\t134. ose\t0. 264\t275.990\t0. 774\t499.211\n0. 067\t145,186\t0. 295\t293. 512\t0. 835\t518. 768\n0. 084\t158. 217\t0. 334\t314.638\t0. 938\t549,225\n0. 106\t174.438\t0. 372\t334.308\t1.051\t379.306\n0. 132\t192. 820\t0. 418\t007\t1.126\t597.544\nTabela 5.5 - Dados gerados de press\u00e3o de fluxo vs tempo.\nA Tabela 5.6 a seguir apresenta o resumo dos resultados;\nPar\u00e2metros\tSolu\u00e7\u00e1o\tNum.\tSSR\tValor\tErro\narbitrados\tcalculada\ttotal\t\treal\tper-\ninicialmente\t\titera-\t\tparam.\tcen-\nCslsfj\tx\u00bb'8)\tC S. r\u00a1rtr-r-y>\t\u00e7\u00a35es\tCatm5\tCs. ZkzrcyZ)\t\nk =\t0.5\tk = 1.384\t\t5x10\tk = 1.384\t0.\nS =\t0.\tS =-2. 00\t7\t\t\t0.\np ~\t9,69 o\tp = 5. 85 o\t\t\tS = \u201d2.\t0.\nk =\t1.\tk = 1 . 15\t\t\t\t-17.\nS -\t2.\tS =2.09\t10\t5x10\tp =5.85 O\t4. 3\nC = 80000 f\tC = 70838 f\t\t\t\t20.\nk =\t0.5 S =\t5.\tk = 1.405 S = 1.97\t9\t5x10\u2122\u00ae\tp. -\u00a90u 68 L\t5. 8 -1.5\nCf \u201c 75000\tC = 90242 f\t\t\tCf =85240\t5. 8\nTabela 5.6 - Resultado do m\u00e9todo de Levember^-Narquctrd\u00ed com c\u00e1lculo das derivadas por invers\u00e3o n\u00famerica para o per\u00edodo de fluxo do DST, tentando calcular combina\u00e7\u00f5es de k , S\u00bb p^ e Cf.\n5.2.1.\tDiscuss\u00e3o do m\u00e9todo e dos resultados obtidos:\nde\nDos resultados acima nota-se que, quando a combina\u00e7\u00e3o par\u00e2metros a serem determi nados \u00e9 k, Se p^, o m\u00e9todo funciona com muita rapidez Ctempo total de execu\u00e7\u00e3o menor que 30 segundos\u00ed e\nQuando h\u00e1\ndados iniciais\na resposta \u00e9 precisa.\na inclusSo de C , que afeta principal mente os\no m\u00e9todo n\u00e2o converge com unicidade\nAs 3 Figuras a seguir mostram este\ndo teste,\ncorreta.\n3. 1\nos\nvalores das respostas obtidas nas\ncada par\u00e2metro foram normalizadas com as raz\u00caSes dever\u00e3o\npara a solu\u00e7\u00e3o comport amento.\nNa Figura\ndiversas itera\u00e7des para rela\u00e7\u00e3o ao valor correto, sendo que todas\nser unit\u00e1rias quando a converg\u00eancia for correta. De fato, obteve-se este resultado correto quando tentou-se determinar\nk,\t\u00a3 e p mantendo fixos p. e C\nO\t1\tf\nFigura 5.1 - Otimiza\u00e7\u00e3o no fluxo\nO mesmo J\u00e1 nSo ocorre ao se tentar determinar k, S e C^, \u00a3 v\u00ed de Fi gur a \u25a1. 2D mantendo-se fixo p e ; poi s embor a a solu\u00e7\u00e3o tenda para 1 muito lentamente, observa-se que existe uma aparente depend\u00eanei a entre k e Cf, poi s os doi s par\u00e2metros crescem a uma mesma taxa. O crit\u00e9rio de converg\u00eancia \u00e9 sempre satisfeito com os mesmos res\u00edduos antes que se atinja a solu\u00e7\u00e3o correta, o que sugere uma limita\u00e7\u00e3o da capacidade do microcomputador, ou do algoritmo utilizado.\nA Figura 3,3 mostra que, para o mesmo procedimento, mantendo-se f i xo o vaior da per meabi1i dade pode-se determinar \u00a3 e C'.\nf\n1.5\n5E+\u00cdW7\nEigur\u00ed! 5.2 - O\u00fcrniza\u00e7oa poro o fiunp\nFiguro 5.3 - Otimizo\u00e7So poro o ftuxc\nEstas observa\u00e7Ses permitem se concluir:\ni> \u00a3 poss\u00edvel se determinar k, Se p^ com rapidez e precis\u00e3o mantendo-se fixos, em seus valores correto, a estocagem no fluxo\te press\u00e3o est\u00e1tica do reservat\u00f3rio Cp^5.\n\u00fc) Quando se deseja determinar Cf e S, deve-se conhecer com exatid\u00e3o os valores de k, p e p..\no\tt\niii? O n\u00famero m\u00e1ximo de par\u00e2metros que pode ser determinado para este caso \u00e9 aparentemente 3.\nPelo exposto seria interessante estudar a influ\u00eancia na determina\u00e7\u00e3o de k e S, de pequenas varia\u00e7\u00f5es de C .\nO valor de Cf, quando n\u00e3o se tem varia\u00e7\u00e3o no di\u00e2metro das ferramentas de teste, depende apenas da densidade do fluido produzido Cvide equa\u00e7\u00e3o 2,i\u00a3D.\nAs S Figuras a seguir mostram esta influ\u00eancia.\nA Figura s- apresenta o resultado da permeabilidade calculada como fun\u00e7\u00e3o da estocagem adotada, sendo ambos os\npar \u00e2met r os nor mal 1 zados com r el a\u00e7\u00e3o a seus vai or es r eai s -Nota-se que existe uma rela\u00e7\u00e3o linear entre estes dois par\u00e2metros, ou seja adotando-se um valor de C diferente do real causa-se o mesmo erro na permeabilidade. \u00ca importante lembrar que a densidade do fluido pode variar bastante com a produ\u00e7\u00e3o de g\u00e1s, sendo dif\u00edcil estabelecer um valor m\u00e9dio correto para o valor de Cf que satisfa\u00e7a ao modelo.\nF\u00edg. 5.4 \u2014 Sensibiiidade da permeabilidade com a estocagem\nPor- out r o 1 ado se o r eser vat\u00f3r i o pr aduz i r apenas \u00e1gua ou \u00f3leo morto, a densidade ser\u00e1 fun\u00e7\u00e3o do grau \u00c0PI m\u00e9dio do l\u00edquido, medido nas condi\u00e7Ses de press\u00e3o e temperatura do reservat\u00f3rio. A vari a\u00e7\u00e3o de k e S com o grau API \u00e9 apresentada na Figura 3.3.\nFig. 5. 5 ~ Sensibilidade da permeabilidade e sk\u00edn com o AP! do flu\u00eddo\nA Figura 3.6 mostra a influ\u00eancia de pequenos erres no c\u00e1lculo do coeficiente de estocagem do fluxo Cf sobre o valor Skin, revelando que quanto mais acima do valor real estiver o valor de Cf adotado\u00bb menor em termos reais ser\u00e1 o valor do sk\u00edn calculado.\nLogo, se o valor de Cf estiver super-estimado, o valor da permeabilidade obtida dever\u00e1 estar acima da real, e o valor obtido para o skin estar\u00e1 abaixo do real.\n1.60\nQ --------------*------------1-------------!____________I\n&amp;80 1.00 1.20 Cf(adotado)/Cf(reo\u00ed)\nF\u00edg. 5.6 \u2014 Sensibilidade do skin com a estocagem\n5.3.\tOTIMIZA\u00c7\u00c3O NO PER\u00cdODO DE EST\u00c1TICA\nA otimiza\u00e7\u00e3o para o per\u00edodo de est\u00e1tica ser\u00e1 realizada com\tno cAlculo des gr adi entes de pressAo atr av\u00e9s da\ninvers\u00e3o num\u00e9nea das express\u00f5es no espa\u00e7o de Laplace.\nA equa\u00e7\u00e3o C3. 73, deduzida no ap\u00eandice C, e as derivadas determinadas no ap\u00eandice D\u00bb ser\u00e3o usadas para o processo de otimiza\u00e7\u00e3o no per\u00edodo de est\u00e1tica.\nA equa\u00e7\u00e3o&lt;3.73 permite o c\u00e1lculo dos valores das press\u00f5es par a todos os tempos do teste. durante os per \u00ed odos de fluxo e de est\u00e1tica, sendo que para o per\u00edodo de fluxo ela pode ser simplificada para a equa\u00e7\u00e3o C3. 33.\nO c\u00e1lculo da press\u00e3o no per\u00edodo de est\u00e1tica exige que se caldtl e o valor de uma integral dependente do per\u00edodo de\nfluxo definida por:\nt P\nIntegral =\t| e^p CO dt\nJo w\n5.3.1.\tEstudo dos m\u00e9todos de solu\u00e7\u00e3o da integral acima\nEstudaram-se v\u00e1rias alternativas de solu\u00e7\u00f3es para esta integral, visando-se principalmente a rapidez e a precis\u00e3o nos c\u00e1lculos.\nEsta integral deve ser calculada numericamente em instantes discretos, ou seja, nos pontos onde se conhece os valores de press\u00e3o no per\u00edodo de fluxo, ou nos tempos onde se calculou o valor de p ttD atrav\u00e9s da invers\u00e3o num\u00e9rica da wf\nsua express\u00e3o obtida no campo de \u00bf.cplczce.\nDeve-se notar que o tipo de fun\u00e7\u00e3o existente no integrando \u00e9 o produto de uma fun\u00e7\u00e3o com decl\u00ednio exponencial Ce D pelos valores de pressSes de fluxo no intervalo CO-tpD, que neste caso s\u00e3o sempre crescente para o po\u00e7os n\u00e3o surgentes. O resultado \u00e9 um i ntegrando decrescente rapidamente com o tempo.\nDentre os princ\u00edpios utilizados para a resolu\u00e7\u00e3o desta\nintegral podemos citar: i> Integra\u00e7\u00e3o direta qualquer para p^CO, anal i tica.\ni\u00ed 5\nConsiste em se adotar uma fun\u00e7\u00e3o tornando-se poss\u00edvel a integra\u00e7\u00e3o\nIntegra\u00e7\u00e3o atrav\u00e9s\ndas\nf6r mui as de Mswton~C\u00d4tes,\nque\nutilizam valores calculados da fun\u00e7\u00e3o p^fCt.D, para tempos regularmente espa\u00e7ados.\niii3 Integra\u00e7\u00e3o atrav\u00e9s da f\u00f3rmula de quadratura \u00f3uctss\u00edctno.\nque utiliza pontos diferentementes espa\u00e7ados, onde este es pa\u00e7 amento \u00e9 deter mi nado por c er t as pr opr i edades dos\npol1n\u00f4mi os or togonai s.\niv? Integra\u00e7\u00e3o direta dos coeficientes dos polin\u00f3mios c\u00fabicos obtidos ap\u00f3s interpola\u00e7\u00e3o de p Ct) por splines c\u00fabicos.\nvJ Quadratura da biblioteca de subrotinas do IMSL que\nutiliza basicamente os mesmos princ\u00edpios do item Civl acima, vi? Integra\u00e7\u00e3o usando t\u00e9cnicas de transformada de Laplaee. vii? Integra\u00e7\u00e3o atrav\u00e9s de uso da fun\u00e7\u00e3o 8-splines com quadr ados m\u00ed ni mos.\nO ap\u00eandice E apresenta o desenvolvimento te\u00f3rico e comparativo de cada um destes m\u00e9todos.\nA Tabela 3.7 a segui r apresenta uma compara\u00e7\u00e3o resund da entre os resultados obtidos Cseguindo a mesma numera\u00e7\u00e3o ac\u00ed ma?, pri nci palmente quanto ao tempo gasto e quanto a conf i abi1i dade,\nM\u00e9todo\tVantagens\tDesvantagens\ttempo padr\u00e3o\n\tRapi dez\tN\u00e3o \u00e9 gen\u00e9rico\t80 seg\nii\tFacilidade\tDemora\t7S00seg\ni i i\tFaci1i dade\tN\u00e3o confi\u00e1vel\t40 seg\ni V\tPrecis\u00e3o\tN\u00e3o \u00e9 gen\u00e9rico\t30 seg\nV\tPrecis\u00e3o\tRepetiti vo\t53 seg\nvi\tPrecis\u00e3o\tN\u00e3o confi\u00e1vel\t33 seg\nvii\tGener aii dade\t\t5 seg\nTempo r equer i do par a c\u00e1l cul o e i mpr essao de um per \u00ed odo de est\u00e1tica padr\u00e3o formado por 33 pontos.\nTabela 3.7-Quadro comparativo de m\u00e9todos de integra\u00e7\u00e3o.\nAs Tabelas 3.8 e 5.9 a seguir apresentam um estudo comparativo dos diversos m\u00e9todos para a solu\u00e7\u00e3o da integraih no casos em que pwftt? = t ou pwfCt? = -/t para s = tp = 1.\nEstas fun\u00e7Ses tem derivadas diferentes no tempo zero de fluxo, o que \u00e9 uma condi\u00e7\u00e3o auxiliar usada na interpola\u00e7\u00e3o por splines.\nA fun\u00e7\u00e3o pv{CO = t tem um comportamento crescente e linear semelhante ao crescimento de press\u00e3o de fluxo em po\u00e7os n\u00e3o surgentes de baixa produtividade. Suas derivadas primeira e segunda s\u00e3o constantes iguais a um e zero respectivamente.\nEstudo comparativo dos m\u00e9todos de solu\u00e7\u00e3o de . t.dt\t=*\tpvfBt>tp\u201cS\u201cl.\t\t\t\nM\u00e9todo\tPr i nci pi o matem\u00e1tico\tResultado\tErro %\nIntegra\u00e7ao anal\u00edtica\tIntegra\u00e7\u00e3o por par tes\t0.364341117\tO\nIntegra\u00e7\u00e3o dos coeficientes de interp.\tSpli nes c\u00fabi cos\t0.264341117\t0\nQuadratura do IMSL\tSpli nes c\u00fabi cos\t0.2642407138\t-8D-4\nTr ansformada de 1aplace\tInvers\u00e3o n\u00famerica por Sleli/esl\t0.3651804479\tO. 36\nTr ansf or mada de \u00bf.aplace\tInvers\u00e3o n\u00famerica por Crump\t0. 864341117\t0\nInter pola\u00e7\u00e3o com quadrados mini mos\tB\u2014Spli nes com quadr ados mi ~ n\u00ed mos\t0.864841117\t0\nTabela 5.8 ~ Compar a\u00e7Ses dos\tresultadas da i ntegr a\u00e7\u00e3o\n\u2014t\nda fun\u00e7\u00e3o FCt> \u201cte atrav\u00e9s de diversos m\u00e9todos.\nA fun\u00e7\u00e3o Pwf\u00a3 tD \u201c t tem um comportamento crecente e levemente assint\u00f3tico que assemelha ao crescimento inicial de press\u00e3o de fl uxo em po\u00e7os n\u00e3o surgentes de alta produtividade. Suas derivadas primeira e segunda tem valores infinito no tempo zero.\nEstudo comparativo dos m\u00e9todos de solu\u00e7\u00e3o de\t\t\t\nU\tr\tdt \u00edo\t\"wf=7t,tp=S:i.\t\ninteg. Gauss, com 3 pontos pZ 100 subdi v\tPolin\u00f3mios ortogonal s\tO.378947357\t6D-4\nIntegragSo dos coeficien-tes de interp.\tSpli nes c\u00fabicos\tO.378943890\tO\nQuadratura do IMSL\tSpli nes c\u00fabicos\t0.3763631362\t-0. 71\nTransfermada de Laplace\tInvers\u00e3o num\u00e9rica por Crwnp\t0.37894343823\t0\nIntergraq2to cZ quadrados min.\tB-Splines cZ quadrados m\u00ednimos\t0.37609861199\t-1.0\nTabela 3.9\t- Compara\u00e7\u00f5es dos resultados da integra\u00e7\u00e3o\nda fun\u00e7\u00e3o FC t> - V t e atrav\u00e9s de diversos m\u00e9todos.\nDo estudo feito para escolha do m\u00e9todo apropriado para o c\u00e1lculo da integral conclue-se que:\n15\tAs melhores rotinas para o c\u00e1lculo da integral quanto ao crit\u00e9rio da precis\u00e3o dos resultados s\u00e3o: Quadradatura do IMSL, Integra\u00e7\u00e3o num\u00e9rica usando a transformada de \u00bfap\u00edace e a integra\u00e7\u00e3o num\u00e9rica dos coeficientes da fun\u00e7\u00e3o B-splines com quadrados m\u00ednimos.\n113 O algoritmo desenvolvido por Crump fornece valores conf1\u00e1vei s par a o c\u00e1lculo da i ntegr al atr av\u00e9s do uso de transformadas de lapiace.\niii3 Como a quadratura do IMSL exige muito tempo para calcular o valor da integral, e o m\u00e9todo da transformada de Laplace exige o conhecimento das fun\u00e7\u00f5es de Bessei modificadas para argumentos complexos Cque n\u00e3o est\u00e3o dispaniveis5, deve-se ent\u00e3o usar o processo de integra\u00e7\u00e3o dos quadrados m\u00ednimos com a fun\u00e7\u00e3o B-spiines, que foi o m\u00e9todo que exigiu menor tempo de computa\u00e7\u00e3o e \u00e9 igualmente preciso e\ngen\u00e9rico.\niv) No m\u00e9todo de integra\u00e7\u00e3o por fun\u00e7\u00f5es B-splines com quadrados m\u00ednimos, existe a dep\u00eandencia da preeisSo da integrai com o n\u00famero de fun\u00e7Ses B~splines utilizado\u00bb que define o n\u00famero de sub-intervalos que ser\u00e3o usados para fazer a interpola\u00e7\u00e3o. Por\u00e9m concluiu-se atrav\u00e9s de integrais conhecidas que para o n\u00famero de B-splines igual a 2\u00bb obt\u00e9m-se o valor exato da integra\u00e7\u00e3o.\nv3 As integrais obtidas pela deriva\u00e7\u00e3o da express\u00e3o da press\u00e3o com rela\u00e7\u00e3o aos par\u00e2metros Cvide ap\u00e9ndice O devem ser resolvidas por este m\u00e9todo.\n5.3.2.\tOtimiza\u00e7\u00e3o para o per\u00edodo de est\u00e1tica\nPara o teste do m\u00e9todo foram gerados dados de press\u00e3o est\u00e1tica a partir de:\n13 Par\u00e2metros de fluido e rocha mostrados na Tabela 5.1.\nii3 Dados do fluxo artificialmente gerados e apresentados na Tabela 5.2.\n1113 C\u00e1lculo da integral pelo m\u00e9todo de integra\u00e7\u00e3o por fun\u00e7\u00f5es B-splines com quadrados m\u00ednimos.\niv3 Par\u00e2metros de flu\u00eddo produzido e dados mec\u00e2nicos do po\u00e7o, para o c\u00e1lculo de C , definidos por:\nSi\nDados do po\u00e7o e do flu\u00eddo\nC = 88.2 x 10\"6 atm_\u00ed\nv\nProf. packer = 810.39 m\tFundo do po\u00e7o = 882. Si m\nTabela 5.10\t- Dados arbitrados para gera\u00e7\u00e3o de press\u00e3o\nest\u00e1tica.\nA partir destes dados, pode-se determinar o volume da\n<5\t3\nc\u00e2mara de estocagem Vw =0.44694-8545x10 cm e o fator de estocagem da est\u00e1tica C =39.42 cm\u2019/atm.\ns\nA Tabela 5,10 apresenta cs dados de press\u00e3o est\u00e1tica resultante.\ntChr?\tpvacPsieP |\ttChrl\tPvaCpsig3 |\t1 tC hrl\t77^77\n0. 022\t718. 304\t0. 209\t780.089\t0.774\t861.560\n0. 025\t719. 896\t0.235\t786. 814\t0. 835\t863. 179\n0. 034\t723.044\t0.264\t793. 846\t0. 938\t870. 107\n0. 041\t725.737\t0. 295\t800.846\t1.051\t874.139\n0.053\t730. 319\t0. 334\t808.941\t1. 181\t877. 519\n0. 067\t735. 502\t0. 372\t816.120\t1.325\t880.080\n0. 084\t741.595\t0. 418\t823.955\t1.486\t881.953\n0. 105\t749. 161\t0. 470\t831.792\t1.666\t883. 240\n0. 132\t757.630\t0. 528\t839.400\t1.870\t884.068\n0. 166\t768.042\t0. 590\t846.377\t2. 098\t884. 541\n0. 187\t774.073\t0.662\t833. 196\t2. 189\t884.652\nTabela 5.11 - Dados gerados de press\u00e3o est\u00e1tica vs tempo.\nPara a aplica\u00e7\u00e3o do m\u00e9todo ser\u00e3o usados:\n13 As condi\u00e7\u00f5es Ci3, Cii3 e Ciii3 da se\u00e7\u00e3o 5.2.\nii3 A equa\u00e7\u00e3o CD. 1.13 e as derivadas deduzidas no ap\u00eandice D. v3 o programa apresentado no ap\u00eandice G.3.\nDeseja-se encontrar o grupo de par\u00e2metros atrav\u00e9s de minimiza\u00e7\u00e3o da fun\u00e7\u00e3o objetivo considerando apenas o per\u00edodo de est\u00e1tica.\n\u00c2 Tabela 5.12 a seguir resume os resultados obtidos:\nPar\u00e2metros\tSolu\u00e7\u00e3o\tNum.\tSSR\tValor\tSr ro\narbitr ados\tcalculada\ttotal\t\t\tper-\ninici al mente\t\ti tera-\t\tparam.\teen-\nc si.\tf cr\tA Ir.\tV -f\t\u00e7des\tC atmZ2?\tCs. Dorcyl\tV \u2022* w\nk = 0. 50 S =0.\tk = 1.384 S =2.00\t8\t-4&lt;10\tk =1.384\t0. 0.\np. =60. 18 *L\tp. =60. 68 t\t\t\tS =+2.\t0.\nk = 0.1384 S =0.20\tk = 1.385 S =1.88\t8\t\u201d1&lt;10\tp =5.85 O\t0. 07 0.\nC - 3. 34 s\tC =70-44 a\t\t\t\t78.\nk = 0.028 = 0.78\tk = 1.384 C =50. 02 s\t6\t-1&lt;1O\tp. =60, 66 L\t0. 27.\nS =0.667 =19.71\tS =1.99 =45.27\t6\t-1&lt;10\tCf =85240\t0. 05 15.\np. =60. 18 \u00ed. = 0. 78\tpT =60, 18 *L c =50.oa \u00a3\t8\t-1&lt;10\tC =33,43 Gt\t0. 27.\nTabela 5.12 - Resultado do m\u00e9todo de Z.evem&amp;er^-?farQuardt com c\u00e1lculo das derivadas por invers\u00e3o n\u00famerica para o per\u00edodo de est\u00e1tica do DST, tentando determinar k, S( p. e C .\n5.3.2-1 \u201c Discuss\u00e3o do m\u00e9todo e dos resultados obtidos\nPara o per\u00edodo de est\u00e1tica, o conjunto de par\u00e2metros melhor determinado \u00e9 formado por k, S, e P . Quando o conjunto de par\u00e2metros inclui o fator de estocagem C \u00bb h\u00e1 converg\u00eancia sem que se atinja os valores corretos dos par\u00e2metros. \u00c2 Figura 5.7 mostra a evolu\u00e7\u00e3o das par\u00e2metros calculados durante as itera\u00e7des.\n1.5\n1.0 ----------\u2014J-------------1--------------1------------\n0\t2\t4\t^6\t8\nN. de Itera\u00e7\u00f5es\nFigura 5.7 ~ Otimiza\u00e7\u00e3o para a estdtica\n5.4.\tOTIMIZA\u00c7\u00c3O NQS PER\u00cdODOS DE FLUXO E DE EST\u00c1TICA\nA otimiza\u00e7\u00e3o ser\u00e1 feita com base na c\u00e1lculo dos gradientes de press\u00e3o por invers\u00e3o num\u00e9rica das expressSes no espa\u00e7o de Lapioce.\nUsando-se a experi\u00eancia obtida nas aplicacSes dos m\u00e9todos descritos nos itens 5. \u00a3 e 5.3, ser\u00e3o determinados os par\u00e2metros que explicam simultaneamente os dados do fluxo e est\u00e1tica.\nGeraram-se dados de press\u00e3o vs tempo para um DST completo, os quais est\u00e3o apresentados na Tabela \u00a35.14 e na Figura 5.8 :\nDados de press\u00e3o\t\t\t\t\t\t\t\nPer\u00edodo de fluxo\t\t\t\tPer\u00edodo de est\u00e1tica\t\t\t\nt\t\t\t\tAt\tp ws\tAt\tp\nChr?\tf\" rsc* i z-x\t3 Chr?\tCpsigD\tChrD\tCpsi \u00e7p\tChrZ)\tC psi gl\n0. 000\t86. 0\t0. 264\t449. 1\t0.000\t759. 4\t0.372\t850.6\n0. 022\t152. 0\t0. 295\t472. 8\t0.022\t781.4\t0. 418\t853. 9\n0.025\t160. 5\t0. 334\t500. 0\t0.026\t782. 7\t0. 470\t856. 4\n0. 034\t176.5\t0. 372\t524. 3\t0.034\t785. 2\t0. 528\t858. 5\n0. 041\t183.6\t0. 418\t550. 8\t0.041\t787. 4\t0. 590\t859. 9\n0.053\t210. 7\t0. 470\t577. 7\t0. 053\t791.1\t0.662\t860. 9\n0.057\t233. 3\t0. 528\t604. 4\t0. 067\t795. 2\t0. 774\t862. 0\n0. 084\t258. 8\t0.590\t629. 6\t0.084\t800. 2\t0. 835\t862.6\n0.106\t288. 9\t0. 662\t&lt;iMi\t0.106\t806. 3\t0. 938\t863. 6\n0. 132\t321.2\t0. 774\t688. 8\t0.132\t813. 0\t1.051\t864.8\n0. 166\t359. 3\t0. 835\t704. 1\t0.166\t821.0\t1.810\t866. 3\n0. 187\t380. 7\t0. 938\t726.8\t0. 187\t825. 4\t1.325\t868. 1\n0. 209\t401.8\t1.051\t747. 6\tO. 209\t829. 8\t1.486\t870. 1\n0. 235\t425. 1\t1.260\t759. 4\t0.235\t834. 3\t1.666\t872. 0\n\t\t\t\t0. 264\t838. 8\t1.870\t873. 9\n\t\t\t\t0. 295\t843. 0\t2. 098\t875. 5\n\t\t\t\t0. 334\t847. 2\t2. 189\t876. 1\nTabela 5.13 - Dados simulados de um DST completo Cum ciclcD.\nOs dados gerados Cvide ap\u00eandice H?, para o DST completo, assumem os valores apresentados nas Tabelas 5.1 e 5.2, assim como os dados mec\u00e2ni cos do pa\u00e7o e do flu\u00ed do produzi do\nr esumidos\tna\tTabela 5. 10,\tconsidera-se tamb\u00e9m\tque:\t\n\t\tr P vf\tse\t0<t<tp\tCequa\u00e7\u00e3o\t3. 33\n\t~\t4\tp CtD\tse\tt>tp\tC equa\u00e7\u00e3o\t3. 7>\n\u00c3 Figura 5.8 abaixo mostra os dados: gerados de press\u00e3o vs tempo para este DST.\nFig. 5.8 \u2014 Dados gerados para DST\n5.4.1.\tOtimiza\u00e7\u00e3o para o DST completo\nA Tabela 14 abaixo apresenta uma tentativa de se determinar todos os 6 par\u00e2metros que definem o DST, usando o programa do ap\u00eandice G. 4.\nPar\u00e2metros iniciai s Csis.\tSol u\u00e7\u00e3\u00edo calcuiada Cs. DarcyO\tNum. itera-\u00e7E5es\tSSR C atmZD\tValor real Cs. DecreyO\tErro %\nk = 0.923 S - 1.333 p =50.04 C =59.13 K c =56330 p =40.65 o\tk = 0.783 \u00a3 = 2. 28 p. =60. 68 L C =21.56 8 C =48250 p =5.85 o\t5\t-3&lt;1O\tk = 1.384 \u00a3 = 2. 00 p.=60. 68 i C =39.42 fit C =85240 f p = 5.85 o\t-43. 14. 0. ~45. -43. 0.\nTabela 3.14 - Resultado do m\u00e9todo de\tcom\nc\u00e1lculo das derivadas por invers\u00e3o n\u00famerlca para o DST de um ciclo, tentando determinar k, S, p.\u00bb C . C , e p .\nt e f\to\nA\tFi gur a 5.9 mostra a ader\u00e9nci a perfei ta que existe\nentre os valores medidos e calculados com os dados acima.\nFig. 5.9 - Otimiza\u00e7\u00e3o no fluxo e na est\u00e1tica\n5.4.2.\tDiscuss\u00e3o dos resultados obtidos e novas propostas para determina\u00e7\u00e3o dos par\u00e2metros.\nDa experiencia num\u00e9rica, v\u00ea-se que n\u00e3o \u00e9 poss\u00edvel deter mi nar todos os sei s par\u00e2metros simuitaneamente pois n\u00e3o h\u00e1 converg\u00eancia para os valores corretos, embora o res\u00edduo final seja baixo.\nPara se determinar apenas 3 ou 4 par\u00e2metros deve-se fixar os demais. Para a aplica\u00e7\u00e3o do algoritmo num caso real, quando n\u00e3o s\u00e3o conhecidos os valores corretos a serem fixados deve-se descobrir uma maneira de determin\u00e1-los corretamente.\nNas aplica\u00e7Ses anteriores do m\u00e9todo, os dois par\u00e2metros que apresentam pi or condi ci onamento eram os coefi ci entes de eslocagem no fluxo e na est\u00e1tica, e C.\nSuponhamos que se fixem os valores dos coeficientes de estocagem, restando ent\u00e3o 4 par\u00e2metros a se determinar: k, S. p. e po.\nEstes quatro par\u00e2metros podem ser determinados simultaneamente para dados gerados, como mostra a tabela 5.15.\nPar\u00e2metros\tSolu\u00e7\u00e3o\tNum.\tSSR\tValor\tErro\narbitrados\tcalculada\ttotal\t\treal\tper-\ni rri i**- 4 -i 1 a. a * a. i\u00bb d.\ta i w Vw\t\ti i oi r- o *\u2014 A. S?\t\u00abA\t\tparam.\tcen~\nCs. liare y 5\tCs. Deurcyl)\t\u00e7<3e?s\tC atra*}\tC s. \u00a3jetrcy>\t5\u00ed\nk = 1.110\tk = 1 .384\t\t\tk = 1.384\t0.\ns =-i.\tS =-2.\t\t\tS =-2. 00\t0.\np =60.92 L\tp -60,68 t\t5\t<10\tp. =60. 68 t\t0.\np = 6.80 o\tp =5.85 Ct\t\t\tp = 5. 83 a\t0.\nTabela 5.15 - Resultado do m\u00e9todo de \u00bfevember^-^orquordi com c\u00e1lculo das derivadas por invers\u00e3o n\u00famerica, para o DST completo, tentando determinar k, S, p. e p .\nOutra al ter nativa \u00e9 a de se otimizar os par\u00e2metros por etapas:\nO \u00c1plica-se a regress\u00e3o n\u00e3o linear ao fluxo usando como p o\ni\n\u00falti mo vaior lido da est\u00e1ticat ou o vai or extr apolado do gr\u00e1fico do m\u00e9todo de Corr\u00eao, e determina-se k, S e p\nQ\niil Com os valores aproximados estimados em Cil aplioa-se a regress\u00e3o n\u00e3o linear na est\u00e1tica e determina-se p^ correto. 1113 Volta-se ao item Ci3 com p. correto e determina-se p\nX\to\ncorreto.\nvi3 Com o valor de p correto determina-se ent\u00e3o os valores o\nde k,S e p^ que satisfazem o fluxo e est\u00e1tica dentro do crit\u00e9rio estabelecidos.\n\u00c0 Tabela 5.16 a segui r resume este \u00falti mo procedi mento:\nPar\u00e2metros\tSolu\u00e7\u00e3o\tNum.\tSSF\tVai or\tErro\narbitrados\tcalcul ada\ttotal\t\treal\tper -\ninicialmente\t\titera-\t\tparam.\tcen-\nC si s. Z?arcy3\tCs. Darcy3\t\u00e7\u00f5es\tCatm23\tC s. Dar cy3\t%\nk -0.50\tk = 1.384\t\t\tk -1.384\t0.\nS -0.\tS = 2. OO\t8\t<10~4\tS =+2. 00\tO.\np. =60.18\tp =60,68 L\t\t\tp,=60, 68\t0.\nTahei a 5.16 - Pesultado do m\u00e9todo de tevember^-^orquord\u00ed com c\u00e1lculo das deri vadas por i nversSo n\u00famerica t para o DST completo, determinando k, S, p corretos.\nO comportamento da fun\u00e7\u00e3o objetivo dur ante as v\u00e1r i as etapas da otimiza\u00e7\u00e3o est\u00e1 apresentado na Figura 3.10, que nos mostra que em cada per\u00edodo h\u00e1 uma redu\u00e7\u00e3o brusca nos valores dos res\u00edduos.\nCalculado/Real\tFuncao objetivo (atm2)\nFig. 5.10 \u2122 Funcao objetivo nas etapas da otimizacao\nFuncao objetivo (atm2)\nRtgura 5.11 \u2014 Otimiza\u00e7\u00e3o no fluxo e na est\u00e1tica\nO estudo de sensibi1idade do ajuste aos par\u00e2metros C e C est\u00e3o apresentados nas Figuras 3.18 e 3.13. Eles indicam \u00a3\nque os par\u00e2metros k, S e p s\u00e3o pouco sens\u00edveis \u00e0 varia\u00e7\u00e3o de C^. Entretanto, esta indica\u00e7\u00e3o precisa de investiga\u00e7\u00e3o mais profunda, uma vez que a regi \u00e3o de mai or \u00ed nf1uenci a de encontra-se logo ap\u00f3s o fechamento do po\u00e7o, onde o gradiente de press\u00e3o em rela\u00e7\u00e3o ao tempo \u00e9 elevado, podendo causar imprecis\u00e3o no c\u00e1lculo da transformada inversa atrav\u00e9s do m\u00e9todo de Stehfest.\n\nCf(grtiiiroao)/Cf(n>o!)\tCs(ortiitrqda}/Cs{real)\n- Serxi&amp;iiiOAQe aos\trcs a estocagr?\nce per i crscj ere \u00ed 1 ux\u00bb\npens 2 bii i naoe act ci*rart\u00bbetr\u00a9s a ectc\u00e7acer oi* p\u00e9tiO\u00edtc- tiv eti\u00e1.u*\nQuanto \u00e0 sensibil\u00eddade dos par\u00e2metros em rela\u00e7\u00e3o a C , nota-se que existe uma rela\u00e7\u00e3o linear entre a varia\u00e7\u00e3o de Cf e a permeabilidade, e inversamente proporcional em rela\u00e7\u00e3o ao \u201cskin**. No caso estudado na Figura 3.12 o \"skin\" \u00e9 negativo e por isto embora seu valor real descres\u00e7a a raz\u00e3o entre valores calculado e real \u00e9 crescente.\nO c\u00e1lculo de C depende pr i nci palmente da densi dade do flu\u00eddo produzido. \u00c2 sensibilidade dos c\u00e1lculos doa par\u00e2metros com o valor de C mostra a import\u00e2ncia da determina\u00e7\u00e3o correta da densidade m\u00e9dia dos flu\u00eddos produzidos no teste.\n6.0. APLICA\u00c7\u00c3O DA INTERPRETA\u00c7\u00c3O AUTOMATIZADA EM DADOS REAIS\nAt\u00e9 agora, discutiu-se basicamente a solu\u00e7\u00e3o anal\u00edtica do DST e sua aplica\u00e7\u00e3o no \"\"match\" automatizado dos dados simulados. Descobriu-se que os par\u00e2metros que podem ser determinados pela regressSo nSo linear sSo k. S. p. e p=.\nViu-se tamb\u00e9m que entre todos os par\u00e2metros que foram mantidos fixos, o que mais influencia os resultados da an\u00e1lise do teste \u00e9 a densidade do fluido produzido, pois dele depende o coeficiente de estocagem do fluxo C .\nPassaremos ent\u00e3o A aplicar este m\u00e9todo de regress\u00e3o n\u00e3o linear a dados reais de campo obtidos nos testes de forma\u00e7\u00e3o.\n6.1.\tOtimiza\u00e7\u00e3o em po\u00e7os de alta produtividade.\nNos po\u00e7os de alta produtividade h\u00e1 uma tend\u00eancia de - amortecimento de press\u00e3o durante o fluxo.\nA aplica\u00e7\u00e3o da regress\u00e3o n\u00e3o linear para o teste composto de um ei cl o compl eto ser\u00e1 f ei ta de acordo com os princ\u00edpios apresentados na se\u00e7\u00e3o 5.4.\nPara a determina\u00e7\u00e3o dos valores iniciais dos par\u00e2metros para o processo de otimiza\u00e7\u00e3o usou-se os seguintes crit\u00e9rios: i> O m\u00e9todo de Cor-r\u00e9c, o qual foi automatizado para c\u00e1lculo de k, e p , tomando-se os 6 pontos finais da est\u00e1tica. Li\u00c7 O valor lido da press\u00e3o de abertura para p .\niii3 O \u00faltimo valor lido na est\u00e1tica como sendo p..\nt\niv2) O valor discreto do Sfein entre -3 e 3 que conduz ao menor res\u00edduo entre os dados observados e calculados durante o fluxo.\nVamos estudar inicialmente o exemplo A apresentado por Corr\u00eaa C1SS8X Trata-se de um DST feito a po\u00e7o aberto num campo de \u00f3l eo vi scoso C Car m\u00f3pol i s -SE j . O r eser vat\u00f3r i o \u00e9 um conglomerado que foi completamente aberto para fluxo.\nO detalhe dos dados de press\u00e3o vs tempo e demai s informa\u00e7bes est\u00e3o apresentados na Tabela 6.1, e Figura 6.0.\n\tDados do po\u00e7o do flu\u00eddo e\t\t\t\tda rocha\t\t\n= 0.\t062\t\t\th = 38\tft\t\t\nAPI =\t25.92\t\t\tC = 10. t\t.\t\u20146\t, ~1 v \u00ed A\trsc-'\u00ed f*r \u201c\tp-** w,\t\t\nr = 0 w C =6 V\t.354 ft .0x10\t-6 psxg\t-1\tr = 0.159 ft p -1 C = 0.0365 RB/psig\t\t\t\np = 60 cp\t\t\t\t\t\t\t\nProf.\tpacker\t= 810. 39 m\t\tFundo do po\u00e7o\t\t= 822.61 m\t\n\t\tDados de\t\tpress\u00e3o\t\t\t\nPer i odo\t\tde fluxo\t\tPer\u00edodo\t\tde est\u00e1tica\t\n\tPvf\t+ .\tpvf\tAt\t^ve\tAt\tp WS\nChr)\tC ps 1 g?\tC hr3\tCpaigl\tChrO\tCpa tg3\tC hr \u25a1\tC pa t gZ>\n0.000\t142. 4\t0.264\t430. 3\t0.000\t712. 2\t0. 372\t856. 6\n0. 022\t186. 2\t0. 295\t449. 6\t0. 022\t766. 9\tO. 418\t858.2\n0. 026\t195. 1\t0- 334\t470. 9\t0. 026\t798. 7\t0. 470\t859. 4\n0.034\t209. 9\t0. 372\t491.0\t0.034\t816. 4\t0. 528\t861.0\n0. 041\t221.6\t0. 418\t511.1\t0. 041\t824. 0\tO. 590\t862. 2\n0.053\t239. 3\t0. 470\t537.7\t0. 053\t830. 9\t0. 662\t863. 4\n0. 067\t261.8\t0. 528\t561.0\t0 . 067\t835. 7\t0. 774\t864. 6\n0. 064\t282. 3\t0. 590\t583. 9\t0. 084\t838. 9\t0. 835\t865. 8\n0.106\t310. 5\t0. 662\t607. 3\t0. 106\t841.3\t0. 938\t867. 4\n0. 132\t333. 4\t0. 774\t630. 2\t0. 132\t844. 1\t1.051\t868. 7\n0. 166\t364.0\t0. 835\t655. 1\t0. 166\t846. 9\t1.810\t870. 3\n0. 187\t380.0\t0. 938\t677.2\t0. 187\t848. 5\t1.325\t871.5\n0. 209\t394.9\t1.051\t698. 9\t0. 209\t849.8\t1.486\t872.3\n0. 235\t412. 2\t1.260\t712.2\t0. 235\t851.4\t1.666\t873. 3\n\t\t\t\t0. 264\t852. 6\t1.870\t874. 7\n\t\t\t\t0.295\t853. 8\t2.098\t876. 3\n\t\t\t\t0. 334\t855. 4\t2. 189\t876. 3\nTabela 6.1 ~ Dados po\u00e7o A - C SPE 16802 3\nFigura 6.0 ~ Carta do DST no po\u00e7o \u00c0 C SFE 168020\n\u00c1 interpretac\u00e3o manual foi feita pelo m\u00e9todo de Corr\u00e9ez na est\u00e1tica para calcular k e p^, e pela an\u00e1li se da press\u00e3o de fluxo vs raiz quadrada do tempo para calcular S e p .\nO\nPar\u00e2metro\tVaior calculado\tUni dade\nPermeabi1i dade C k 1\t1.884\tDarcy\nEfeito de Pel\u00edcula CS)\t-3. 4\t-\nPress\u00e3o est\u00e1tica reserv. Cpil\t60.68\t\nPress\u00e3o fluxo inicial Cpol\t5. as\tatm\nTabela 6.2 - Interpreta\u00e7\u00e3o gr\u00e1fica manual po\u00e7o A ~ SFE 16802.\nA Interpreta\u00e7\u00e3o automatizada foi feita usando o programa apresentado no ap\u00eandice 6. 4 e tivemos o seguinte resultado:\nPar\u00e2metro\tValor I ni ei ai\tValor CalcuIado\tUni dade\nPermeabilidade CIO\t1.16\t1.03\tDarcy\nEfeito de Pel\u00edcula CS)\t~1.0\t-2. 21\t-\nPress\u00e3o est\u00e1tica Cp.3 L\t60. 54\t61.46\tatm\nPress\u00e3o inicial Cp D O\t9. 69\t8. 28\tatm\nTabela 6,3 - Interpreta\u00e7\u00e3o automatizada po\u00e7o A \u2014 SPE 16802. Vejamos a Figura 6.1 para discuss\u00e3o dos resultados.\n1000\nT\nT\nT\n800 -\nCL\n600\no o~ o CL\no e\nO iO\ntn\n<n o k.\no.\n400\n200\nLegenda\nDados lidos do DST\nDados calculados de press\u00e3o\nRes\u00edduo (~ P. lida \u2014 P. cale.)\n+\u25a0\nf*****M*l |.M > *++ *- + + ++ ++\t+\t+\t+ +\n+ + + +H.\n~20&amp;\u00ed)\ni____________!______._____!---\n1.0\t2.0\t3.0\nTempo acumulado de teste (h)\n4.0\nF\u00edg, 6.1 - Otimiza\u00e7\u00e3o no DST do po\u00e7o A\n\n* o\n6.1.1.\tDiscuss\u00e3o dos resultados\nPela aplica\u00e7\u00e3o do m\u00e9todo verificou-se que:\n13\tO programa funcionou bem e a converg\u00eancia foi r\u00e1pida.\n\u00dc3 Q valor final da fun\u00e7\u00e3o objetivo \u00e9 de 41.08 atmz.\niii3 Os trechos que apresentaram maiores res\u00edduos foram o final do fluxo\u00bb o in\u00edcio da est\u00e1tica e o final da est\u00e1tica. iv3 Os\tmenores res\u00edduos foram obtidos nos trechos\ni\tntermedi \u00e1ri os.\nv3 Quanto \u00e0 compara\u00e7\u00e3o dos resultados obtidos pela interpreta\u00e7\u00e3o automatizada e pela interpreta\u00e7\u00e3o manual\u00bb observa-se diferen\u00e7as acentuadas nos valores dos par\u00e2metros.\n6.1.2.\tNova proposta para otimiza\u00e7\u00e3o do DSTT&lt;1 cicloJ\nNa an\u00e1lise de DST\u2019s os trechos mais importantes para interpreta\u00e7\u00e3o com gr\u00e1ficos espec\u00edficos Cm\u00e9todos de Corr\u00eaa, Worner, Cartesiano\u00bb etc.3\u00bb s\u00e3o os finais da est\u00e1tica e do fluxo uma vez que os dados nestas faixas est\u00e3o pouco influenciados pela estocagem .\nSabe-se tamb\u00e9m que os registradores de press\u00e3o tem seu intervalo de medi\u00e7\u00e3o ideal que \u00e9 de aproximadamente de 30% a 80% de sua capacidade m\u00e1xima. Este fato\u00bb junto ao grande choque iniciai imposto \u00e0 forma\u00e7\u00e3o no DST\u00bb podem explicar a m\u00e1 qualidade da leitura obtida de press\u00e3o obtida neste trecho.\nPara a otimiza\u00e7\u00e3o foram fixados os valores dos coeficientes de estocagem de fluxo CCf3 e est\u00e1tica\t\u00bb o\nque torna o per\u00edodo de estocagem quase definido.\nPor outro lado\u00bb os valores de press\u00e3o calculados para os pontos iniciais da est\u00e1tica n\u00e3o s\u00e3o confi\u00e1veis devido \u00e0 limita\u00e7\u00e3o do algoritmo de invers\u00e3o num\u00e9rica de Steh/est.\nPor todos estes motivos expostos acima parece que se houver minimiza\u00e7\u00e3o dos res\u00edduos nos trechos finais dos respectivos per\u00edodos o resultado da interpreta\u00e7\u00e3o do teste ser\u00e1 mais confi\u00e1vel. Isto pode ser feito atribuindo pesos\nE55\nindividuais aos pontos lidos proporcionalmente ao seu valor de press\u00e3o.\n6.1.3.\tInterpreta\u00e7\u00e3o automatizada usando pesos diferenciados por pontos.\nUsando o mesmo programa apresentado no ap\u00eandice F't mas atribuindo pesos para cada ponto lido, proporcional \u00e0 press\u00e3o\ndo per\u00edodo.\tque em forma\tde desvio padr\u00e3o \u00e9:\t\n\tPff\t\t\no. \u201c\ti - 1 ,\tndf.\tPara pontos do fluxo e\n\t\t\t\no. =\tPvef .\td t = l,\tnde.\tPara pontos da est\u00e1tica.\n\tp\t\t\nO res\u00edduo ser\u00e1 a diferen\u00e7a de pressSo dividido por o..\nO resultado da interpreta\u00e7\u00e3o automatizada fica ent\u00e3o:\nPar\u00e2metro\tVai or Inicial\tValor Calculado\tUni dade\nPermeabi1idade Ck?\t1.18\t1.31\tDcrcv -y\nEfeito de Pel\u00edcula CSD\t-1.0\t-1.31\t-\nPress\u00e3o est\u00e1tica Cp, 3\t60. 34\t60. 78\tatm\nPress\u00e3o inicial Cp J 0\t9.69\t9. 13\tatm\nTabela 6, 4 ~ Interpreta\u00e7\u00e3o automatizada po\u00e7o A ~ SPE 16802.\nObservando a Figura 8.2 apresentada na p\u00e1gina seguinte vemos que os trechos com maiores res\u00edduos s\u00e3o os trechos iniciais do fluxo e da est\u00e1tica. O trecho com menor res\u00edduo agora \u00e9 o final da est\u00e1tica, com a fun\u00e7\u00e3o objetivo da \u00faltima\n2\nitera\u00e7So igual a 22.73 atm . Este ajuste parece explicar melhor o hist\u00f3rico da press\u00e3o. Na Figura 6. 3 a curva gerada com os dados da .interpreta\u00e7\u00e3o manual \u00e9 o que apresenta pior desempenho, talvez devido aos valores err\u00f4neos obtidos para o skin e a press\u00e3o inicial do gr\u00e1fico pwfCtD vs /t\nFfg. 6.2 - Otimiza\u00e7\u00e3o com peso no DST do poco A\n1000\n300\ng> *w\nQ.\n\u00ab fl \u2022\nO u o CL\no\nc:\no \u2018O\n<\u00edi td li\na.\n600\n400\nLegenda\nDados fidos do DST\nDados calculados de press\u00e3o Dados interpreta\u00e7\u00e3o manual\n200 F\n8.o\n---\u00ed---------------i______________L\u2014.-.\u25a0\u25a0\u25a0 t\n1*0\t2,0\t3,0\nTempo acumulado&lt;\u00ede teste (h)\n4.0\nS\n4\n\nT\n* \u2022 \u2666\n0\n* o\nfrg. 6,3 - Compara\u00e7\u00e3o dos resultados manual x otimizado\n6.1\u00bb4. Outros exemplos estudados\nA Tabela 6.6 abaixo apresenta os resultados comparativos em outras aplica\u00e7\u00f5es do m\u00e9todo para teste de forma\u00e7\u00e3o de um eielo em po\u00e7os de alta produtividade.\nPo\u00e7o\tPar\u00e2metro\tResul tado das i nter preta\u00e7\u00caSes do teste\t\t\n\t\tGr\u00e1fica Manual\tAutomati zada Csem pescD\tAutomati zada Ccom pescO\nCp-113\tk E md]\t6. 5\t4.8\t5. 3\n\tS [ ]\t2. 3\t-1.3\t-0. 9\n\tp. E atm]\t19.07\t19.13\t19.08\n\tp \u00a3 atm] O\t7.07\t6. 71\t6. 81\nCp-137\tk E md3\t4. 00\t2.16\t3. 21\n\tS E 1\t-2.01\t\t-3. 97\n\tp [ atm]\t25. 99\t27. 99\t27. 22\n\tp EatmJ o\t3. 49\t\t4.68\nCp-222\tk E mdJ\t81.60\t17. 46\t20. 01\n\tS \u00a3 ]\t-3.10\t-3. 38\t-a pia\n\tp, E atml t\t41.80\t42. 64\t42. 30\n\tp E atm] O\t8. 67\t3. 92\t3. 68\nCp-295\tk E md]\t264.00\t310. 80\t318. 90\n\tS E ]\t-3.46\t~3. 28\t\"3. 33\n\tp. E atm] t\t38. 33\t38.00\t38. 00\n\tp E atml O\t3.58\t1.48\t0. 00\nTabela 6. 3 ~ Outros exemplos de otimiza\u00e7\u00e3o em po\u00e7os\nAs Figuras 6.4 a 6.11 a seguir mostram os respeetivos ajustes de curvas obtidos. A an\u00e1lise dos res\u00edduos* indicar\u00e1 a aplicabilidade do modelo e/ou a qualidade dos dados do DST.\nPress\u00e3o no po\u00e7o (ps\u00edg)\tPress\u00e3o no po\u00e7o (psig)\nFig. 6.4 ~ Otimiza\u00e7\u00e3o sem peso \u2014 po\u00e7o CP 115\nFtg. 6.5 \u2014 Ot\u00edmiza\u00e7ao com peso \u2014 po\u00e7o CP 115\n5Q\nPress\u00e3o no poco (psig)\tPress\u00e3o no po\u00e7o (psig)\nF\u00edg. 6.6 \u2014 Otimiza\u00e7\u00e3o sem peso - po\u00e7o CP 137\nF\u00edg. 6.7 - Otimiza\u00e7\u00e3o com peso \u2014 po\u00e7o CP 137\n\u00d4O\nPress\u00e3o no po\u00e7o (psig)\tPress\u00e3o no po\u00e7o (psig)\n500\n300\n100\n$\n*\n*\n*\n*\no -\nf\n\u00a5\n+ o\n\n-,0&amp;\n\t\t\nLegenda\nDados lidos do DST\nDados calculados de press\u00e3o Res\u00edduo P. Sida - P. calc.)\n1\n1\nTo\nTempo acumulada de teste (h)\nF\u00edg. 6.8 ~ Otimiza\u00e7\u00e3o sem peso ~ po\u00e7o CP 222\n700\n500 -\n300\n100\n\n\nT\nT\nT\nT\nT\nT\nT\n8.0\n****** * \u2666 * *\n\u2666\n\u2666\nf\n*\u2666*\nLegenda\n* Dados lidos do DST\n+ Dados calculados de press\u00e3o o Res\u00edduo P. lida - P. calc.)\nG Q O C \u00cdJ O O O CJ 0 O 0\nT\n1\n__}\nA.O Tempo acumulada de teste (h) ^E\u00edg. 6.9 \u2014 Otimiza\u00e7\u00e3o com peso \u2014 po\u00e7o CP 222\n1Ofio\n1\n8.0\nPress\u00e3o no po\u00e7o (psig)\tPress\u00e3o no po\u00e7o (psig)\nFig. 6.10 \u2014 Otimiza\u00e7\u00e3o sem peso - Poco CP 295\nF\u00edg. 6.11 \u2014 Otimiza\u00e7\u00e3o com peso - Po\u00e7o CP 295\n6.2\t- Otimiza\u00e7\u00e3o em po\u00e7os de baixa produtividade\nNos po\u00e7os de baixa produtivadade h\u00e1 um crescimento cont\u00ednuo de press\u00e3o, sem tend\u00eancia de amortecimento.\nIniciaimente ser\u00e1 aplicado a regress\u00e3o n\u00e3o linear, para o teste composto de um ciclo completo, usando-se os mesmos pri nc\u00ed pi os da se\u00e7\u00e3o 6.1.3 para defini \u00e7\u00e2o dos vai ores i ni ci ai s dos par\u00e2metros e da se\u00e7\u00e3o 5.4 para a converg\u00eancia do m\u00e9todo.\nO TFR**3 CTeste de forma\u00e7\u00e3o revestido n? 33 do po\u00e7o 7-Cp~760-Se \u00e9 um exemplo de DST com baixa produtividade, conforme mostra o desenho esquem\u00e1tico da carta na Figura 6.12 abaixo:\nFig.6. 12 - DST no po\u00e7o 7 - Cp - 760 - Se CTFR-33.\nA Tabela 6.6 mostra as respectivas pressSes no po\u00e7o:\nDados lidos de press\u00e3o do po\u00e7o : 7-Cp-76O~Se\t\t\t\t\t\t\t\nPer\u00edodo de fluxoCK)\t\t\t\tPer\u00edodo de est\u00e1tica\t\t\t\nt\tpwf\tt\tPvf\tAt\tp va\tAt\tp\nCpolZJ\tCpolO\tC poi 5 C pol ?\t\tCpolO\tC pol 3 C pol 2)\t\tcpon\n0.000\t0. 143\t0.318\t0. 416\t0. 004\t0. 629\t0.110\t1.599\n0.043\t0.182\t0. 379\t0. 378\t0.006\t0.642\t0. 120\t1.608\n0.086\t0.221\t0.441\t0. 491\t0.009\t0.660\t0.140\t1.629\nO. 129\t0.261\t0.502\t0. 529\t0. 011\t0. 679\t0.155\t1.631\nA 1 TM W * \u00abh \u00ed a\u00bb\t0.300\t0. 563\t0. 366\t0.014\t0. 706\t0. 175\t1.641\n0. 214\t0. 339\t0.624\t0. 604\t0.017\t0. 733\t0.195\t1.650\n0. 257\tO. 378\t\t\t0.019\t0. 7&amp;&amp;\t0.220\t1.659\n\t\t\t\t0.022\t0.827\t0. 245\t1.667\n\t\t\t\t0.025\t0. 904\t0.275\t1.674\n\t\t\t\t0. 028\t0. 996\t0. 310\t1.682\n\t\t\t\t0.031\t1.082\t0.350\t1.689\n\t\t\t\t0.035\t1.186\t0. 390\t1.695\n\t\t\t\t0.039\t1.275\t0. 440\t1.702\n\t\t\t\tO. 044\t1.341\tO. 490\t1.708\n\t\t\t\t0.049\t1.405\t0.550\t1.714\n\t\t\t\t0.065\t1.456\t0. 620\t1.720\n\t\t\t\t0. 062\t1.499\t0.780\t1.730\n\t\t\t\t0. 069\t1.326\t0.870\t1.734\n\t\t\t\t0.078\t1.552\t1.980\t1.738\n\t\t\t\t0.087\t1.568\t1.100\t1.743\n\t\t\t\t0.098\t1.584\t1.205\t1.746\nEqua\u00e7\u00e3o\tde calibra\u00e7\u00e3o\t\tregistrador e constante do rel\u00f3gio\t\t\t\t\n\tPvf =\tM t + A\tou\tp Vfi\t\u2014\tM At + A\t\t\n\tM\t377.81200 psigZpoi.\t\u00bf\t\t\tL =\t\u201c3.\t0431 psi g\t\n\tKr ei .\t=\t4.8 hZpol.\t\t\t\t\t\nC Os dadas de pr ess\u00f5es de f 1 uxo foram obti dos por i nter pola\u00e7\u00e3o 1i near em 2 trechos, por que s\u00f3 se di spunha da press\u00e3o de fluxo inicial e final no relat\u00f3rio de teste.\nO teste foi executado com o obj eti vo de determi nar a produtividade\u00bb permeabilidade\u00bb dano, press\u00e3o est\u00e1tica e demais par\u00e2metros da forma\u00e7\u00e3o. O tempo de fluxo foi de 3 horas e o de est\u00e1tica de 6 horas.\nA Tabela 6.7 mostra os demais dados a serem usados para a interpreta\u00e7\u00e3o do teste:\nDados de fluido e rocha do po\u00e7o: 7-Cp-760-Se\n<\u00a3 = 0.146\th = 6. O m\nAPI = 22.8\tCt- 9. 62 x lO^psig\"1\nr = 3.183 pol.\tp = 61.9 cp\nW -6-1 \u00b0\nC = 6.0 X 10 psig\n*J\t3\t3\nCapacidade da coluna de produ\u00e7\u00e3o \u00bb 0.00302 m Zm\nProf, packer = 577.00 m\tFundo do po\u00e7o ~ 350.24 m\nTabela 6. 7 - Dados de flu\u00eddo, rocha e mec\u00e2nico do 7-Cp-7SO-Se\nA Tabela 6.8 mostra o resultado da interpreta\u00e7\u00e3o manual\nPar\u00e2metro\tVaior calculado\tM\u00e9todo\nPermeabilidade E md 1\t113.76\tHorner\nCoeficiente de pel\u00edcula [ 3\t0. 92\tHorner\nPress\u00e3o est\u00e1tica Eatrn]\t45.79\tHorner\nPress\u00e3o fluxo inicial Eatm 3\t3. 60\t-\nTabela 6. 8 - Interpreta\u00e7\u00e3o gr\u00e1fica manual po\u00e7o 7-Cp-760-\u00a3e.\nA Interpreta\u00e7\u00e3o automatizada foi feita usando o programa do apresentado no ap\u00eandice G. 4, com o seguinte resultado:\nPar\u00e2metro\tValor I ni ci ai\tValor Calculado CO\tValor Calculado C**T\nPermeabilidade E Md 1\t59.9\t86. 2\t133.0\nEfeito de Pel\u00edcula E 1\t-1.0\t1.07\t3. 58\nPress\u00e3o est\u00e1tica EAtm)\t46.11\t46. 33\t45. 57\nPress\u00e3o fluxo EAtml\t3.47\t2.78\t2. 78\n* Interpreta\u00e7\u00e3o com p\u00easo diferenciado e SteA/est com N ~ 20. \u00ab\u00abInterpreta\u00e7\u00e3o com p\u00easo diferenciado e SteA/est com N = 10. Tabela 6. 9 - Interpreta\u00e7\u00e3o automatizada po\u00e7o 7-Cp-760-Se.\nAs Figuras 6.13 e 6.14 mostram estes resultados:\n\u00e7n\nt/i\nn\no\no\nCL\n0 c\no o w cn a>\nCL\n800\t\tT\"'\t  T\t  '\t!\t\t\u00ed\t\t\n600\t\t.$tm*** * * * * *\t*\t* \u00e0\t-\n\t\t$\t\t-\n400\t\tf &amp;\tLegenda\t\t\n\t\t* * Dados lidos \u00bb +\u25a0 Dados calculados\t\t\n\t\t\t\t\n\t\t1 o Residuo(= lido-calc.)\t\t\n200\t-\t* * *\t\t-\n\t\t*\t\t-\n\t\tA\t\t\n0\thJ e a o o \u00bb o\te \u00a9\t\u00ab o t\u00bb\t0 Q o g o\t9\to\t4\tO\t0\t\n\t\to s\t\t\n\u201c2C\u00ae\t\t0 / 1 1 1\t1\t\n\t0\t4.\u00d3\t8.0\t\n\t\tTempo acumulado de teste\t\t\nFig. 6.13 - Otimizacao com peso \u2014 Poco CP 760\n700\n500\n300\n/\n\u2666\n*\n*\tLegenda\n/ * Dados lidos\n*\t4- Dados calculados\no Res\u00edduo(~ l\u00eddo-ca\u00edc.)\n100\n-\n,r\n<s o \u00ab a \u00bb\nCl\nT\n*\n*\n*\n9\no\n-100\n1\n-3O<9.o\n1\n__\u00ed\tI\tI_ 4.0____________________________8.0\nTempo acumulado de teste (h)\nF7q 6.14- - Otim\u00edzacao com peso ~~ Poco CP 760\n(N = 10)\nC3. a. 1 ~ Discuss\u00e3o dos resultados\nPela aplica\u00e7\u00e3o do m\u00e9todo verificou-se que:\nxl O programa funcionou bem e a converg\u00eancia foi r\u00e1pida.\n113 O valor final da fun\u00e7\u00e3o objetivo \u00e9 alto O \u00a1238.7 atmz3. iiiO O trecho com maiores res\u00edduos foi o do inicio da est\u00e1tica.\niva Nos demais trechos verificou-se res\u00edduos baix\u00edssimos.\nv> Quanto a eompar a\u00e7\u00e3o dos resultados obti dos pela interpreta\u00e7\u00e3o manual e automatizada \u00edcom p\u00easos e para diferentes par\u00e2metros N de S\u00a3eh/est3 nota-se semelhan\u00e7as bastantes acentuadas nos valores finais dos par\u00e2metros.\nO m\u00e9todo dos quadrados m\u00ednimos n\u00e3o lineares faz um ajuste final da curva de tal modo que, al\u00e9m da soma dos quadrados ser\tm\u00ednima, h\u00e1 uma distribui\u00e7\u00e3o uniforme dos erros ou\nres\u00edduos. Como isto aconteceu no exemplo acima, podemos dizer\nque o m\u00e9todo de regress\u00e3o funcionou satisfatoriamente e os resultados podem ser aceitos.\nO grande problema da aplica\u00e7\u00e3o desta metodologia de otimiza\u00e7\u00e3o est\u00e1 exatamente no algoritmo de invers\u00e3o num\u00e9rica das express\u00f5es da press\u00e3o e gradientes de press\u00e3o para po\u00e7os de baixa produti vidade.\nO algoritmo de Stehf&amp;st usado tem apenas controle sobre a precis\u00e3o dos seus coeficientes\u00bb mas n\u00e3o tem nenhuma condi\u00e7\u00e3o de converg\u00eancia imposta para diferentes tipos de fun\u00e7\u00f5es a serem invertidas\u00bb lago ele fornece uma resposta que pode ser incorreta.\nPara a invers\u00e3o de fun\u00e7\u00f5es cont\u00ednuas\u00bb mas com descont\u00ednuidades nas derivadas\u00bb como \u00e9 o caso da express\u00e3o da press\u00e3o de fluxo para a est\u00e1tica em po\u00e7os de baixa produtividade, o algoritmo de Stehfest n\u00e3o fornece valores corretos.\nUma alternativa para a an\u00e1lise do teste \u00e9 aplicar o m\u00e9todo reti rando estes pontos i ni ci ai s da est\u00e1ti ca onde o algor11mo n\u00e3o funciona corretamente e prossegu\u00edr a an\u00e1lise normalmente.\nOutra alternativa \u00e9 fazer esta an\u00e1lise do teste por regress\u00e3o n\u00e3o linear avaliando as press\u00f5es e gradientes de press\u00f5es numericamente como por exemplo atrav\u00e9s do m\u00e9todo das diferen\u00e7as finitas.\n6\u00bb 2.3. Interpreta\u00e7\u00e3o automatizada retirando os pontos iniciais da est\u00e1tica\nSer\u00e1 usado o mesmo programa anterior\u00bb que \u00e9 apresentado no ap\u00eandice G. 4\u00bb e tamb\u00e9m o mesmo crit\u00e9rio de pesos diferenciados estabelecido anteriormente; apenas retirando os 34 pontos iniciais da est\u00e1tica.\nA Tabela 6.12 da p\u00e1gina seguinte apresenta o resultado desta interpreta\u00e7\u00e3o automatizada, que mostra um resultado bastante pr\u00f3ximo da interpreta\u00e7\u00e3o manual gr\u00e1fica.\nPar\u00e2metro\tVai or I ni ci al\tValor Final\nPermeabilidade \u00a3 md 3\t39. 90\t90. 0\nEfeito de Felicuia \u00a3 3\t-1.\t1.19\nPress\u00e3o est\u00e1tica \u00a3atml\t46.11\t46. 09\nPress\u00e3o fluxo \u00a3atml\t3. 47\t\u00a3.78\nTabela 6.10 - Interpreta\u00e7\u00e3o automatizada po\u00e7o 7-Cp-76O-Se.\nA Figura 6. IS mostra a curva finai e os res\u00edduos obtidos\u00bb donde se concl ui que neste caso o r esui tado f i nal f az um ajuste muito bom com os dados de campos usados.\nT\n700\ncn\ncu\n500\no u o CL\no c\no o w (71 cu L-.\nCL\n300\n100\n\u2666 *++*** * * *\nLegenda\n* Dadas lidos\n+ Dados calculados\no Res\u00eddua(- lido-calc.)\n\u201eCr c o 6 fr \u00e2&lt;S 0 u q 0\t&amp;\n4.0\n8.0\nTempo acumulado de teste (h)\n\u25a0Ftg. 6.13 - Ot\u00edmizacao com peso \u2014 Poco CP 760\n6.3.\tAN\u00c1LISE ESTAT\u00cdSTICA D\u00e1 REGRESS\u00c3O\nAt\u00e9 agora tratou-se apenas de se obter uma estimativa pontual de um par\u00e2metro desconhecido. Existem contudo v\u00e1rios m\u00e9todos estat\u00edsticos, tais como intervalo de confian\u00e7a e coeficientes de correla\u00e7\u00e3o, que podem conduzir a resultados mais significati vos da an\u00e1lise da regress\u00e3o. Assim ao inv\u00e9s de \u00ed nf or mar apenas o vai or \u00f3t 1mo de um dado par \u00e2metr o, pode-se fornecer um 1ntervai o com um certa probabi1i dade de conter \u00easse par\u00e2metro calculado.\nIntervai os de confi an\u00e7a mui to grande i ndi cam que a an\u00e1li se n\u00e3o \u00e9 confi \u00e1vel.\n0 intervaio de confian\u00e7a de cada par\u00e2metro \u00e9 computado, segundo Rort\u00edey Cl3643, pela seguinte rela\u00e7\u00e3o aproximada:\ncom n\u00edvel\nv. de 952-\u00c9 oi\not\na\nescolhi do\nde\n5>0.\npara\nt\t= valor da distribui\u00e7\u00e3o de S\nOtX2,n-m\nrisco a CExp. : para inter\nO n\u00edvel de risco&lt;x \u00e9 tal que\nOtZ2;n-m\nAssi m, quanto menor o n\u00ed vel de r\u00ed st an\u00e1lise da regress\u00e3o, maiores ser\u00e3o os intervalos da confian\u00e7a dos par\u00e2metros, embora esses dependam tamb\u00e9m da qualidade dos pontos registrados \u00e9 da quantidade de pontos n.\nQuanto maior o n\u00famero de pontos, menor ser\u00e1 o intervalo de confian\u00e7a e maior ser\u00e1 a confian\u00e7a nos resultados da otimiza\u00e7\u00e3o.\nAdotaremos para este estudo n\u00edvel de risco o =\tque\nequivale aos intervalos de confian\u00e7a de \u00e2SS-\u00ed.\n}\no\nO programa apresentado no ap\u00eandice G. 4 fornece os intervalos de confian\u00e7a para este caso.\nAs Tabelas abai xo trazem cs 1imites destes i nter vai os para o po\u00e7o A que est\u00e1 sendo anal i sado\u00bb consi der ando-se a otimiza\u00e7\u00e3o sem p\u00easo e com p\u00eas o diferenciado nos pontos.\nPar\u00e2metro Eunid. 3\tLimi te Inferior\tLi mi te Superior\tValor \u00d5timo\nPer meabi1i dade E Dorcy]\t-0. 60\t2. 72\t1.03\nEfeito de Pel\u00edcula E 1\t-2.29\t-2.12\t-2. 21\nPress\u00e3o est\u00e1tica Eatml\t61.18\t61.74\t61.46\nTabela 6.11 - Intervalos de confian\u00e7a da otimiza\u00e7\u00e3o sem p\u00easo do po\u00e7o A - SPE 16802.\nPar\u00e2metro Eunid.3\tLimite Inferior\tLi mi te Superior\tVai or \u00f5ti mo\nPer meabi1i dade E Dctrcy3\t0.05\t2.37\t1.31\nEfeito de Pel\u00edcula E 3\t-1.43\t-1.20\t-1.31\nPress\u00e3o est\u00e1tica Eatm]\t60. 34\t61.02\t60. 78\nTabela 6.12 - Intervalos de confian\u00e7a da otimiza\u00e7\u00e3o com p\u00easo do po\u00e7o A - SPE 16802.\nComo vemos o intervalo de confian\u00e7a de maior comprimento \u00e9 o da permeabilidade. Isto evidencia que nesta an\u00e1lise este par\u00e2metro pode ser o menos confi\u00e1vel, o que est\u00e1 coerente com a an\u00e1li se de sensi bi1i dade fei ta anteri ormente no qual verificou\u2014se que este par\u00e2metro era o mais sens\u00edvel aos valores de densidade m\u00e9dia de fluido adotado.\n7.0 - OTIMIZA\u00c7\u00c3O NO DST USANDO DIFEREN\u00c7AS FINITAS\nEstudaremos; a otimiza\u00e7\u00e3o por regressSo nSo linear, sob o crit\u00e9rio dos quadrados minimos, calculando as pressSes e gradientes de press\u00f3es com rela\u00e7\u00e3o aos par\u00e2metros do reservat\u00f3rio via diferen\u00e7as finitas com o objetivo de:\ni3\tCompara\u00e7\u00e3o entre os resultados obtidos anteriormente pela inversdes num\u00e9rica da press\u00e3o e gradientes via algoritmo de S t eh/es t.\niiD Apresenta\u00e7\u00e3o de um algoritmo capaz de interpretar todos os dados de press\u00e3o vs tempo de um teste de forma\u00e7\u00e3o de baixa produti vi dade.\nO c\u00e1lculo das pressGes por diferen\u00e7as finitas consiste em determinar novos valores de press\u00e3o no espa\u00e7o e no tempo, a partir de padr\u00f3es iniciais conhecidos, como press\u00e3o de fluxo inicial Cp reservat\u00f3rio em repouso, etc.\nO\nO ap\u00eandice F apresenta o desenvolvimento te\u00f3rico do m\u00e9todo atrav\u00e9s das discretiza\u00e7\u00f3es:\nO Da equa\u00e7\u00e3o diferencial parcial para fluxo radial em r eservat\u00f3r i o homogeneo,\niD Da condi\u00e7\u00e3o de contorno interna, que considera o problema do DST como um \"slug tesf* com uma mudan\u00e7a brusca do coeficiente de estocagem,\niiil Da condi\u00e7\u00e3o de contorno externa, que considera o sistema ccm extens\u00e3o radial infinita.\nO ap\u00eandice I apresenta o programa que :\ni3\tCalcula as pressSes no po\u00e7o atrav\u00e9s das diferen\u00e7as fi ni tas.\nii3 Usa a subrotina ZERXTS. LIB da biblioteca de programas do IMSL para c\u00e1lculo das gradientes de press\u00e3o em rela\u00e7\u00e3o aos par\u00e2metros a serem determinados, e tamb\u00e9m para a regress\u00e3o n\u00e3o linear por quadrados m\u00ednimos atrav\u00e9s do algoritmo de tevert\u00f3MBrg-Warquardi.\nii3 Calcula as pressSes nos tempos lidos e em mais um ponto intermedi\u00e1rio para melhorar a precis\u00e3o do resultado.\n7.1\t- Otimiza\u00e7\u00e3o por diferen\u00e7as finitas em dados simuidaos\nPara evitar erros causados pelos dados na aplica\u00e7\u00e3o do m\u00e9todo\u00bb gerou-se dados de pressSes de um DST completo, usando o algoritmo de S\u00ed&amp;tif&amp;st e o algoritmo de diferen\u00e7as finitas, que est\u00e1 resumido na Tabela 7.1 abaixo.\nOs par\u00e2metros de flu\u00eddo\u00bb rocha e po\u00e7o s\u00e0o os mesmos das Tabelas 5.1 e 3.10.\nDados simulados de press\u00e3o no po\u00e7o\t\t\t\t\t\t\t\nPer\u00edodo\t\tde fluxo\t\tPer\u00edodo de\t\test\u00e1tica\t\nt\tpvf\tt\t\tAt\tPv\u00ab\t\u00bft\tp\nCh2)\tC psi g2>\tCbJ CpsigD\t\t\tC psi gj\tChD\tCpsig3\n0. 000\t86.0\t0.122\t306. 3\t0.005\t687. 8\t0. 209\t818, 1\n0. 003\t106. 3\t0.132\t318. 4\t0.011\t712. 4\t0. 315\t832. 4\n0.011\t123. 4\t0. 149\t337.8\t0.022\t734. 9\t0. 418\t841.6\n0, 023\t149. 0\t0. 166\t356. 2\t0.024\t738. 2\t0.500\t847. 0\n0. 024\t153. 4\t0. 177\t367. 7\t0. 026\t741.2\t0.662\t854. 9\n0.023\t137. 7\t0. 187\t377. 7\t0.030\t746. 4\t0. 800\t839. 7\n0.028\t161.9\t0. 198\t388. 5\t0. 034\t750. 9\t0. 938\t863. 4\n0. 034\t173. 8\t0. 209\t398. 8\t0. 037\t754. 1\t1.325\t870. 2\n0. 037\t179. 5\t0. 222\t410. 7\t0. 041\t757. 9\t1.400\t871.2\n0. 041\t186. 9\t0. 235\t422. 1\t0. 045\t761.3\t1.486\t872. 1\n0. 045\t194. 2\t0. 250\t434. 7\t0. 053\t767, 3\t1.520\t872.5\n0. 053\t208. 0\t0. 264\t446. 1\t0. 060\t771.9\t1.666\t873. 9\n0. 030\t219. 6\t0.279\t457. 8\t0.067\t775.9\t1.750\t874.6\n0. 037\t230. 7\t0.295\t469. 8\t0.075\t780.2\t1.870\t875. 5\n0. 075\t242. 9\t0. 382\t527. 2\t0. 084\t784. 4\t1.950\t876.1\n0. 084\t256. 0\t0. 400\t537. 8\t0.095\t788.9\t2, 098\t877. 1\n0.094\t270. 1\t0. 460\t569. 7\t0.106\t793. 0\t2.140\t877. 3\n0.1 oa\t286. 1\t0. 500\t588. 9\t0. 119\t797. 3\t2. 189\t877. 6\nTabela 7.1 - Dados simulados de DST com baixa produtividade\nA Figura 7.1 apresenta a compara\u00e7\u00e3o das press3es no po\u00e7o obtidas por estes dois m\u00e9todos.\nFig, 7.1 - Press\u00f5es por invers\u00e3o num\u00e9rica x por dif, finita\nUsando apenas os dados gerados por diferen\u00e7as finitas, vamos aplicar o m\u00e9todo de otimiza\u00e7\u00e3o por diferen\u00e7as finitas da ap\u00eandice I\u201e para determinar a permeabilidade CkD, o efeito de pel\u00edcula \u00cdS) e a press\u00e3o est\u00e9tica Cp^.\nOs crit\u00e9rios usados para os valores iniciais dos par\u00e2metros s\u00e3o os mesmos do item 6.1.\nSer\u00e1 feita inicialmente uma regress\u00e3o apenas nos dados do fluxo at\u00e9 a converg\u00eancia e depois no per\u00edodo de fluxo e est\u00e9tica em conjunto at\u00e9 a otimiza\u00e7\u00e3o final.\nA Figura 7. S mostra os valores das razESes entre os valores calculados e os valores reais, usados para gerar os dados de k, S e pi para as diversas itera\u00e7\u00f5es, sendo as 19 itera\u00e7Ses iniciais no per\u00edodo de fluxo e as restantes no DST\ncompleto Cfluxo e est\u00e1tica}.\n1.8\nQ.8 L---~\u00ed---------------------------J-------i-\n0\t10\t20\t30\nN. de Itera\u00e7\u00f5es\nFigura 7, 2\nOtim\u00edzacao para o fluxo e fluxo +est\u00e1tico\n\u00c0 Figura 7.3 mostra as cur vas de pressdes obtidas na primeira itera\u00e7\u00e3o no DST completo, na otimiza\u00e7\u00e3o finai e a curva gerada para aplica\u00e7\u00e3o do m\u00e9todo. Nota-se que quando iniciou-se o processo de otimiza\u00e7\u00e3o no DST completo os valores dos par\u00e2metros j\u00e1 estavam praticamente iguais aos valores finais, mas a fun\u00e7\u00e3o objetivo ainda diminuiu.\nFig. 7.3 - Ot\u00edmizacao para fiuxo e estatica por dif. finita\nPara a oti mi za\u00e7\u00e3o 1 ni ci ai que \u00e9 apenas no f 1 uxo os valores iniciais ainda s\u00e3o distantes dos valores finais como mostra a Figura 7. \u00bf1.\nA Figura 7. E3 resume este comportamento da fun\u00e7\u00e3o obJeti vo. El a mostr a a con ver g\u00eancia r \u00e1pi da dos par \u00e2metros durante o fluxo nas 19 itera\u00e7des iniciais e lenta a para o DST completo. H\u00e1 tamb\u00e9m um aumento da fun\u00e7\u00e3o objetivo no in\u00edcio da otimiza\u00e7\u00e3o em todo DST que \u00e9 devido ao maior n\u00famero de pontos analisados.\nEm termos de valores absolutos a permeabilidade, skin e press\u00e3o est\u00e1tica t\u00eam valores iniciais 1,11 darcy, -1, e 60.8 atm ; atingem 1.378 darcy, -8.005, com pi= 60.8 C fixcD no fluxo e convergem para seus valores exatos no DST completo.\nFig/7, 4- Otimiza\u00e7\u00e3o na fiuxa por dif. finitas\n8E+004\nf\n\u25a0^68+004\nS\no\no\n>\n4E>004\n\u00edo\no\no \u00a1O \u00edjr'\n\u00bf 2E+004\n-\u00a160\n*\nOE+QQC^\n* Fiuxa\no Huxo e est\u00e1tico l\ni\nf\ni\ni.\ni\n!\n40\nd2\u00b0\n1G\t20\nNumero de iterocoes\n301\nF\u00ede, 7.5 \u2014 Fun\u00e7\u00e0c osjst\u00edva nas etooas d\u00fc athTrjzac\u00f3c\n7\u201e 2. Otimiza\u00e7\u00e3o por diferen\u00e7as finitas em dados reais\nO m\u00e9todo de otimiza\u00e7\u00e3o baseado na invers\u00e3o num\u00e9rica das expressdes obtidas em Laplacs n\u00e3o funcionou em po\u00e7as de baixa produti vidade devido \u00e0 1 imita\u00e7\u00e3o no algoritmo que faz a invers\u00e3o num\u00e9rica das respectivas equa\u00e7Ses. Para que o algoritmo de Steh/est seja confi\u00e1vel a fun\u00e7\u00e3o deve ser monot\u00e2nica, e sem descontinuidade brusca nas derivadas.\nO algor\u00edtmo de oti mi za\u00e7\u00e3o que calcula a press\u00e3o e gradientes atrav\u00e9s de diferen\u00e7as finitas em po\u00e7os de baixa produtividade forneceu valores exatos e convergiu rapidamente na sua aplica\u00e7\u00e3o para dados simulados.\nPara a aplica\u00e7\u00e3o em dados reais \u00e9 necess\u00e1rio que se fa\u00e7a um escalonamento dos par\u00e2metros a determinar, colocando-os na mesma ordem de grandeza, para que na converg\u00eancia todos eles tenham a mesma quantidade de n\u00famero significativos.\nA Figura 7.6 seu uso no DST do po\u00e7o 7-Cp-760-Se.\ncb\nvi Cu\nO \u00fc-o Cl\n0 c\no \u00cdO\nw Kl\n800 ----!---!----T~--f--------!---1----r---r\n\t. 0 \u00bb 9\t8 , B 9 \u2019 \u2022 * \t\t\t *\t\u2019\t\t\n600\t\t<\u00ed9\t\n400\t\t/ \u00ed\tLegenda \u00ed * Dados lidos\t\u2014\u25a0\n200\t* \u2666\t, . ;\to\u2019otimizacao finai - *\to\t+ res\u00edduos T + *\t-\n0\t* * s \u00ab 9 \u00bb * + * 1\t5 t > \u201c 9 \u00bb \u00ed\t\t 1 1!1!.\t1\tt 1\t-\n9001----1-----1----1-----1----i----1----1----\u00ed_____\u00ed____\nCW\t2.0\t4.0\t6.0\t8.0\t10.0\nTempo acumu\u00edado de teste (h)\nFlg. 7.6 - Otimizacao por dif. finitas para 7\u2014Cp\u2014760\u2014Se\nO resultado da otimiza\u00e7\u00e3o n\u00e3o \u00e9 bom. O algoritmo n\u00e3o converge e os res\u00edduos s\u00e3o altos. Tudo isto devido aos valores de pressdes finais da est\u00e1tica que s\u00e3o diferentes dos valores calculados por diferen\u00e7as finitas, o que causa um deslocamento de toda a curva do DST na tentativa da min\u00edmiza\u00e7\u00e3o dos quadrados m\u00ednimos.\nO gr\u00e1fico de Corr\u00eaa na Figura 7.7 mostra o comportamento\nan\u00f3malo existente no per\u00edodo de estocagem.\n\u00e7n\nCJ.\nO O O\nCL\n0 c\no\nCO cn\n0?\nu.\nCl\n800\t\t~i\tj\tj\t1\tr\t1 i\ti \tr\t\t\n\t\t\u2022 * O g _\t\t\n600\t\t\u201d * \t\t-\t: j B\u00bb\t%\t\n\t\t\t\u2022\u00bb. \u2022\u2022 % \u2022 % a \u00e2 V \\\t\n400\t\t\t0O 0\t-\n\t\tLegenda\t*\t\n\t\t* Dados lidos\to\t\n\t\to otimiza\u00e7\u00e3o final\t\u2022 X\t\n200\t\t4- res\u00edduos\t0 o\t-\n\t\t\t\t\n0\t\t\t\t-\n\t\t\tt * + *\t\n-20ft\t\ti .\t. i . . ..\t>\t\u00a1\tt\t1\t1\t\u00ed\tI\t\n\t2\t0.4\t0.6\t0.8 1.0\t1.\ntp / (tp + dt)\nF\u00edg. 7.7 \u2014 Grafico cartesiano da ot\u00edm\u00edz. do 7\u2014Cp-760-Se\nA aplica\u00e7\u00e3o de qualquer m\u00e9todo de an\u00e1lise para dados\nreais \u00e9 sempre mais complicada\u00bb porque existem fen\u00f3menos tais\ncomo fric\u00e7\u00e3o, in\u00e9rcia. simplifica\u00e7\u00e3o da equa\u00e7\u00e3o da\ndifusividade na lineariza\u00e7\u00e3o Conde se despreza os gradientes\nde pr i mei r a or dem) r var i a\u00e7SSes dos coef i ci entes de est ocagem\nno fluxo e est\u00e1tica Cque pelo modelo s\u00e3o constantes}.\nA primeira id\u00e9ia que surge \u00e9 o uso de pesos diferenciados para os pontos, de tal modo se que force o ajuste sempre nos\n\u00e9 onde se tem mai or\nconfian\u00e7a no modelo\nmatem\u00e1tico e nos\ndados medi dos.\nEstes pesos sSo fatores\nintroduzidos nos\nc\u00e1lculos dos residuos ou\na\nonde\nSSR Cx3\n= 5\u00cdC[P\\4\u201cP\t.3/ o. 1\nL\tW t=U WpL\tV J\ni\npar a per i odo de f1uxo\nC7.13\nC7. 33\no. -t\npara a an\u00e1lise em todo o DST C7. 33\nCp 1.\t. e p est\u00e3o definidos no item C4.13.\nw t=t\tWpl\nEste m\u00e9todo tamb\u00e9m n\u00e3o convergiu e apresenta resultados ruins, embora os pontos finais da est\u00e1tica estejam mais pr\u00f3ximos como mostra a Figura 7.8 abaixo.\n800\n600\no.\n8 400\no\ntx\nO\nc:\no 200\no\nv\nk_\nCl\n0\nQ\t&amp;\n\u00b0 \u2019 **\t_ .\u00bb * s s ?\n- + > +\nLegenda\n* Dados \u00fcdos\no otimizacao finai + residuos\n-20&amp;\nJ---------1----i----\u00a1----1----t____L.\n2.0\t4.0\t6.0\t8.0\nTempo acumulado de teste (h)\n10.0\nFlg. 7 S \u201c Otimizacao por dtf. finitas para 7~-Cp~760\u201cSe\n0\nT\nT\nT\nT\nT\nT\nT\nT\n1\n\u00ed\n\u2019H'\n\u2666\n1\n1\n\n1\nSe retirar mos os 15 pontos i ni ciai s da est\u00e1tica no computo do res\u00edduo e aplicarmos a m\u00e9todo\u00bb usando pesos para os pontos, h\u00e1 converg\u00eanci a e os resul tados ser\u00e3o real i st as como mostra a Ta bei a 7. 2 e a Figura 7.9 abaixo.\nPar\u00e2metro\tValor I ni ci al\tVai or Final\nPermeabilidade t md 3\t39.90\t66. 3\nEfeito de Peiicula t 1\t\u201d1.\t-0.09\nPress\u00e3o est\u00e1tica \u00edatmJ\t43. 11\t46.13\nTabela 7. 2 - Interpreta\u00e7\u00e3o automatizada po\u00e7o 7-Cp\u201c760-Se\u00bb por diferen\u00e7as finitas para determinar k\u00bb S e p..\n800\nT\nT\nT\nT\nT\nT\nT\nT\n7\n600 -\n\u00c7H 'w\no.\nu \u2019\n\u00bfsi000\no o o cu\no\n400\no o w\nM e CL\n200 -\nLegenda\n* Dados lidos\n\u2022 o otimizacao final + .res\u00edduos\nOp-\u00bb\u00bb\n2O\u00a3o\n+\u2022\nr 4* 4- +\u25a0 s\u00bb\nI\t1\tI_,...,,,1 . L_____\u00ed-----\u00cd------L_\n2.0\t4.0\t6.0\t8.0\nTempo acumulado de teste (h)\nJu\n10.0\n\n\u00bb\n. \u2022\n\n4\n\nf\nFig. 7.9 \u2014 Otimizacao por dif. finitas para 7\u2014Cp\u2014760\u2014Se\nEstes valores ainda podem ser melhorados se retirarmos os 34 pontos Iniciais da est\u00e1tica como fizemos na an\u00e1lise por inversSo num\u00e9rica da transformada de Laplaae para este po\u00e7o.\nA Figura 7.10 mostra o ajuste obtido.\n800\nT\nT\nT\nT\n> a\n600\nJ 5 ! \u00bb \u2022\t*\t\u2018\ng>\n\u00a3X\nO U' o\nQ.\nO a\n400 H\no 'O\ntf\u00ed\n<n\n4)\nc CL\n200\n\u201c2Ofto\nHg. /J0\nA Tabela\nLegenda\n* Dados lidos c otimiza\u00e7\u00e3o final 4- res\u00edduos\ni L.\nTempo acumulado Otimiza\u00e7\u00e3o por dif.\n7. 3 apresenta um\ninterpreta\u00e7\u00e3o pelo dois m\u00e9todos.\n_i_____1-\t....1..\n5.0\t8.0\nde teste (h) finitas para 7\u2014Cp~760~Se\nquadr o compar at\u00edvo da\n10.0\n0\n\n\u00bb \u00bb\nv\n\na\n4 *\n\u2666\n+\nf- *\n1\n1\nPar\u00e2metro\tInvers\u00e3o num\u00e9- rica CS\u00edeh./esU\tDiferen\u00e7as finitas com po= pfi\nPermeabilidade \u00ed md 1\t90. 00\t66.17\nEfeito de Pel\u00edcula C 1\t1.19\t0. 03\nPress\u00e3o est\u00e1tica Eatm]\t46. 09\t46.10\nTabela 7. 3 - Interpreta\u00e7\u00e3o automatizada po\u00e7o 7-Cp~7\u00a90~Se.\n7.8.1.\tOutro exemplo estudado por diferen\u00e7a finita\nAplicou-se o m\u00e9todo no po\u00e7o 7-Fu-8r2-Al.\nAs Figuras 7.11 e 7.18 mostram o resultado com todos os pontos do DST e sem os 11 pontos i ni ci ai s de pressSo vs tempo respectivamente.\n1800\n1600\n* \u2022 \u2022\nuoo\n\u00a31200\ngJOOO\no\u201d a\no\nc\nO o w\n(0\nV \u00a3\n500 -\n600\n400 -\n200 -\n'*'200q\nLegende\nDados \u00dcdos otimiza\u00e7\u00e3o finai res\u00edduos\n..*\u00bb<\u00ab*-* t t\t.\n----1------\u00ed-------1------i______I___\n4\t8\t12\nlampo acumulado de teste (h)\n16\nF1g> 7*11 - Otim\u00edzacao por dif, finitas paro 7\u2014Fu\u201422\u2014AJ\n1800\n1600 -\n'\u00ed............1\u2014\n&lt;\u2022 \u2666 *\n400 -\ncr* \u00a31200 -\nT\n\u00b0 W00h o cu\no c\no IO\nff\u00bb ffl\nQ.\nsoo -\n600\n400 -\n200 -\nLegenda \u00ab.Dados lidas o otimiza p\u00e3o final + residuos\n0 -\n\nf\n\n*\no\nT\nT\n\n0 -\n\u201d2OOo\n~~4\t' \u00c9\t12\nTempo c\u00e7umulodo de teste (h)\n16\nFrg, 7J 2 - Otimiza\u00e7\u00e3o por dif. finitas para 7~Fu\u20142.2\u2014Al\nA Tabela 7.4 abaixa apresenta a resultado comparativo dos\nm\u00e9todos:\nPar\u00e2metros\tValores finais calculados pelos m\u00e9todos\t\t\t\n\tManual gr\u00e1fi ca\t\tAutomatizada por dif. fin.\t\n\tCorr\u00eaa\tWorner\ttodas pontos\t-li pantos*\nk E mdl\t8. 0\t11.3\t3. 7\t7. 3\n\u00a3 [ 1\t~0. 5\t\u201c2.0\t\u201c2.7\t\u201c2. 6\np. \u00a3 atml\t117. 3\t116. 8\t120.2\t118.1\n* retirando os 11 pontos iniciais da est\u00e1tica.\nTabela 7.4 - Resultados dos m\u00e9todos gr\u00e1ficos e de otimiza\u00e7\u00e3o por diferen\u00e7as finitas no DST do po\u00e7o 7-Fu~22-Al.\n7.2.2. Discuss\u00e3o do m\u00e9todo\nPodemos afirmar que o melhor resultado \u00e9 o que apresenta menores res\u00edduos principalmente para os pontos finais da est\u00e1tica.\nOs exemplos analisados tinham poucos pontos lidos no\ninclu\u00eddo no programa.\nPara os po\u00e7os de m\u00e9dia e alta produtividade os m\u00e9todos de diferen\u00e7as finitas e o m\u00e9todo de invers\u00e3o num\u00e9rica apresentam resultados bem pr\u00f3ximos, embora esta compara\u00e7\u00e3o seja dif\u00edcil porque a press\u00e3o de fluxo inicial, que \u00e9 importante no estudo do DST, \u00e9 calculada pelo m\u00e9todo de invers\u00e3o num\u00e9rica e \u00e9 um valor fixo fornecido pelo m\u00e9todo das diferen\u00e7as finitas.\nA Tabela 7.3 abaixo mostra as resultados das duas an\u00e1lises para o po\u00e7o A Cdo SPE 1\u00caJ8OED que vinha sendo estudado.\nPar\u00e2metro\tInvers\u00e3o num\u00e9- rica CSteh/est.)\tDiferen\u00e7as finitas com po= pfi\nPermeabilidade \u00a3 md ]\t1130.00\t1145.00\nEfeito de Pel\u00edcula \u00a3 1\t-1.31\t- 1.74\nPress\u00e3o est\u00e1tica tatml\teo. 78\t\u00a91.45\nPress\u00e3o fluxo in. \u00a3atml\t0. 13\t9. \u00a99\nTabela 7.5\t- Resultados da interpreta\u00e7\u00e3o automatizada por\ndiferen\u00e7as finitas e por invers\u00e3o num\u00e9rica no po\u00e7o A.\nA Figura 7. 13 mostra o ajuste final por diferen\u00e7as finitas*\nF\u00edg. 7,13 \u2014 Ctimiza\u00e7\u00f5o por dif. finita no po\u00e7o A\n83\n8.0. CONCLUS\u00d5ES E RECOMENDA\u00c7\u00d5ES\nA interpreta\u00e7\u00e3o automatizada para po\u00e7os n\u00e3o surgentes \u00e9 mai s um m\u00e9todo de an\u00e1l i se de teste , que somente deve ser aceito ap\u00f3s verifica\u00e7\u00e3o da qualidade do ajuste, an\u00e1lise estat\u00edstica e principaimente com informa\u00e7\u00f5es de outras fontes como testemunhos, perfis e geologia.\nEstudou-se aqui a apli ca\u00e7\u00e3o do m\u00e9todo de an\u00e1lise para o caso do reservat\u00f3rio homog\u00e9neo, infinito e com fluxo radial para o po\u00e7o. Este modelo parece ser v\u00e1lido para a maioria dos testes, mas n\u00e3o para todos.\nComo nem todos os par\u00e2metros podem ser calculados pelo algori tmo de regress\u00e3o, porque alguns deies podem ter correla\u00e7\u00e3o entre si e outros podem ter pouco efeito na resposta de press\u00e3o, os primeiros estudos foram para deter mi nar quals par \u00e2metr os podem ser deter mi nados com unicidade e precis\u00e3o.\nA premissa b\u00e1sica para a an\u00e1lise de ajuste automatizado \u00e9 que o modelo matem\u00e1tico escolhido descreva o comportamento do po\u00e7o/reser vat\u00f3r i o. Se isto n\u00e3o ocor r er o pr ocesso de regress\u00e3o por quadrados m\u00ednimos simplesmente for\u00e7ar\u00e1 um ajuste que melhor explique os dados de campo. Tamb\u00e9m \u00e9 importante a estimativa inicial dos par\u00e2metros a serem calculados, e principal mente a qualidade dos dados do teste.\n8.1\t- Conclus\u00f5es\n1.\t- O m\u00e9todo de an\u00e1lise automatizado para po\u00e7os n\u00e3o surgentes, num ciclo completo de fluxo e est\u00e1tica, permite a deter mi na\u00e7\u00e3o dos 4. par \u00e2metr os gover nantes do teste que s\u00e3o: permeabilidade Ck2>, efeito de pel\u00edcula \u00cdS, press\u00e3o est\u00e1tica do reservat\u00f3rio CpiD e press\u00e3o de fluxo inicial Cpol.\n8.- A inclus\u00e3o nesta an\u00e1lise das equa\u00e7\u00f5es com alternati vas de determi na\u00e7\u00e3o do skin positi vo ou negati vo tornou a interpreta\u00e7\u00e3o mais abrangente &amp; realista.\n3.- \u00c0 an\u00e1lise simult\u00e2nea do fluxo e da est\u00e1tica constitue um avan\u00e7o em termos de t\u00e9cnicas de an\u00e1lise automatizada de teste. As informa\u00e7des adicionais do per\u00edodo de est\u00e1tica permitiram a determina\u00e7\u00e3o de maior quantidade de par\u00e2metros e maior confiabilidade na interpreta\u00e7\u00e3o.\nA. - O uso de pesos diferenciados para cada ponto de press\u00e3o vs tempo do fluxo e est\u00e1tica for\u00e7a o ajuste da curva CmatchJ nos trechos mais conf i\u00c3veis do teste. Estes trechos s\u00e3o aqueles com maior densidade de medi\u00e7Ses e com press\u00e3o de fluxo mais pr\u00f3xima da capacidade ideal do registrador.\n3.- Embora este m\u00e9todo de an\u00e1lise n\u00e3o exija o c\u00e1lculo das vazdes de teste, \u00e9 i mpresci ndi vel a determi na\u00e7\u00e3o correta da densi dade m\u00e9di a do f1 ui do produzi do para uma an\u00e1li se realista, devido sua influencia no c\u00e1lculo do coeficiente de estocagem do fluxo.\n\u00f4.- A sensibilidade dos par\u00e2metros calculados com rela\u00e7\u00e3o ao coeficiente de estocagem da est\u00e1tica CC 3 \u00e9 muito baixa, e portanto o seu c\u00e1lculo Cque depende do volume de estocagem do teste e da compressibilidade do flu\u00eddo! n\u00e3o precisa ser rigoroso.\n7.\t- A an\u00e1lise automatizada apenas no per\u00edodo de fluxo do DST Cou slug testJ permite a determina\u00e7\u00e3o de 3 par\u00e2metros que podem ser: k, S e po ou k, S e pi. No caso de k , S e pi \u00e9 necess\u00e1rio que haja uma tendencia de estabiliza\u00e7\u00e3o de press\u00e3o Camortecimento!.\n8.\t- \u00c0 vers\u00e3o usada do algoritmo de regress\u00e3o de quadrados m\u00ednimos n\u00e3o lineares de \u00bfevember#~?tarquardt com c\u00e1lculo dos gradientes de press\u00e3o pela express\u00e3o anal\u00edtica obtida no espa\u00e7o de Loploce \u00e9 mais r\u00e1pida que a vers\u00e3o que calcula estes gradientes atrav\u00e9s de diferen\u00e7as finitas.\n9.\t-0 m\u00e9todo foi usado para an\u00e1lise de testes em po\u00e7os n\u00e3o surgentes de alta, m\u00e9dia e baixa produtividade e mostrou-se mai s reali sta para an\u00e1li se em teste de alta e m\u00e9dia produtividade.\n&amp;7\n8.2\t- RecomendacSes\nl.~ Investigar a possibilidade de uso dos algoritmos de regress\u00e3o n\u00e3o linear com c\u00e1lculo das derivadas de segunda ordem Cpor exemplo o algoritmo de Newton-GreenstacD, com o objetivo de determina\u00e7\u00e3o de f\u00f4 par\u00e2metros do DST que s\u00e3o: k, S, p \u25ba p . C e C .\nS.\t- Implementar algoritmos que calculem a fun\u00e7\u00e3o de Besse\u00ed modificada de segunda esp\u00e9cie e ordem zero e um para argumentos complexos. Eles ser\u00e3o usados em conjunto com o algoritmo de Crwnp para invers\u00e3o num\u00e9rica da transformada de La.pt ac e para resolver a integral do DST conforme m\u00e9todo apresentado no ap\u00eandice E. 6.\n3.\t- Implementar este algoritmo apresentado para problemas de DST com v\u00e1rios ciclos, e tamb\u00e9m para outros tipos de modelo de fluxo e reservat\u00f3rios* tais como:\n\u00b13 Fluxo linear, esf\u00e9rico e el\u00edptico\n\u00ediJ Sistema heterog\u00e9neos:\tdupla porosidade, dupla\npermeabilidade e reservat\u00f3rio composto.\niiiD Reservat\u00f3rios limitados com press\u00e3o constante nos limites ou com falha plana selante.\n4.\t~ Incluir neste estudo os efeitos inerciais e de turbul\u00eancia existentes em po\u00e7os n\u00e3o surgentes de alt\u00edssima pr oduti vi dade.\n\u2014\u25a0 T 1 r\tdai f fiC* td\u00f4 '\u00ed fidf&amp;r*/'5' \u00ed \u00c7i\u00e7 HtfC*\n*\tA 4 4^w *A \u00ab, *\tW lnlAiiif\tW 4 W\t1\u2014*. 4 * U, *A\natrito, gradientes de press\u00e3o de primeira ordem em rela\u00e7\u00e3o ao espa\u00e7o e varia\u00e7\u00f3es do coeficiente de estocagem do fluxo CCp existentes em po\u00e7os n\u00e3o surgentes de baixa produtividade.\n9.\tMONENCL\u00c1TURA\nS\u00cdMBOLOS ROMANOS: s\nA\t= \u00e1rea da se\u00e7\u00e3o transversal da -tubo \u00a3cml\n~3\nC\t= constante de estocagem, [ atmH cml\n\u20141\nc\t= compressibilidade total, latml\n1\t\u2014i\nc\t= compressibilidade do fluido do po\u00e7o\u00bb \u00a3atml\nw\nd\t~ operador diferencial\n\u00d4\t-\tvetor solu\u00e7\u00e3o do sistema de equa\u00e7\u00f5es lineares\nDSCxD -\tDeriva\u00e7\u00f5es de segunda ordem da fun\u00e7\u00e3o objetivo\ntE\t-\tmatriz\tdos coeficientes do sistema\tnormal\nE\t-\tmatriz\tinversa dos coeficientes\tdo\tsistema\tnormal\nF\t*\tfun\u00e7\u00e3o\tres\u00edduo C- diferen\u00e7a\tentre os\tvalores\ncomputados e medidos em cada itera\u00e7\u00e3o da regress\u00e3o) h\t\u00bb\tespessura da forma\u00e7\u00e3o,\u00edcml\n\u201d2\nq\t= constante de acelera\u00e7\u00e3o da gravidade CcmlCs]\n0\t-\tmatriz identidade\nJJ\t-\tJacobiano\n3\nk\t\u00ab\tpermeabilidade da\tforma\u00e7\u00e3o.\u00a3 cm]\nKo\t\u00ab\tfun\u00e7\u00e3o Bessei modificada de 2a.\tesp\u00e9cie ordem\tO.\nKi\t-\tfun\u00e7\u00e3o fesse\u00ed modificada de 2o..\tesp\u00e9cie ordem\t1.\nEL\t-\toperador de letp\u00edace\n1\t-\taltura de flu\u00eddo no tubo \u00a3cml\nm\t\u00bb\tn\u00famero de par\u00e2metros a serem determinados\nms\t=\tmassa espec\u00edfica\tdo flu\u00eddo\nn\t=\tn\u00famero de pontos\tde tempo\tvs. press\u00e3o do teste\nndf\t-\tn\u00famero de pontos\tlidos no\tper\u00edodo\tde fluxo\nnde\t=\tn\u00famero de pontos\tlidos no\tper\u00edodo\tde est\u00e1tica\np\t=\tpress\u00e3o,\u00a3atml\np^\t\u25a0-\tsolu\u00e7\u00e3o do fluxo\tpara S.C\te vaz\u00e3o\tconstantes\np.\t=\tpress\u00e3o inicial do reservat\u00f3rio, \u00a3 atml\np\t=\tpress\u00e3o de fluxo inicial\u00bbE atm]\nO\np\t-\tpress\u00e3o\tde fluxo final.Catm]\np\t~\tpress\u00e3o\testatica final.Eatml\nVO\np\t-\tpress\u00e3o\tno po\u00e7o.Eatm]\np\t=\nws\nq CO \u00ab\nq CO =\npress\u00e3o fluxo no po\u00e7o Cespa\u00e7o Lcp\u00edctce^ , \u00ed atml\npress\u00e3o lida no teste, Eatml\npress\u00e3o est\u00e1tica no po\u00e7o Cespa\u00e7o Lap Latee\u2019} , \u00edatml 3\t-1\nvaz\u00e3o instant\u00e1nea da forma\u00e7\u00e3o,Ecml Es]\n3\t\u20141\nvaz\u00e3o espec\u00edfica, EcmJ Es]\ndist\u00e2ncia radial do po\u00e7o.Ecm]\nr\t=\traio externo do reservat\u00f3rio,Ecm]\nr\t=\traio interno da tubula\u00e7\u00e3o de produ\u00e7\u00e3o* \u00a3 cm3\nP\nr\t= raio do po\u00e7o.Ecm]\nw\nr\t= raio efetivo do po\u00e7o Crwa \u00ab= rw. DexpC-S3J Ecm]\nw<x\ns\t- vari\u00e1vel ou argumento no espa\u00e7o de Laptcce\nSSR = fun\u00e7\u00e3o objetivo ou soma dos quadrados dos res\u00edduos\nem cada passo&lt;\u00a3atm]>\nS\t= fator de pel\u00edcula ou fator skin ou skin\nS&amp; ~ fun\u00e7\u00e3o degrau unit\u00e1rio\nt\nT\ntempo, \u00a3 s ] transposto\nt\nP\nt\nOtj, n-m\n2\nV\nw\nX\n*\nX\ntempo de produ\u00e7\u00e3o ou de fluxo. Es]\ndistribui\u00e7\u00e3o de student com n\u00edvel de risco oi e n-m graus de liberdade\n3\nvolume da camera de estocagem do fundo,\u00a3cm]\nvetor composto dos par\u00e2metros da forma\u00e7\u00e3o/reservat\u00f3rio.\nvetor solu\u00e7\u00e3o da minimiza\u00e7\u00e3d da fun\u00e7\u00e3o objetivo\nS\u00cdMBOLOS GREGOS:\ncx\t- ni vel de r i sco para o i nter vai o de conf i an\u00e7a com\nprobabilidade Cl-o\u00f4\nQr\t~\tdesvio padr\u00e3o m\u00e9dio da regress\u00e3o\nAP\t-\ttransformada de laplace de ApCr,tZ>\nd\t=\toperador diferencial parcial\n$\t-\tporosidade, fra\u00e7\u00e3o do volume total\nyw ~\tespec\u00edfico do fluido do po\u00e7o, \u00ed gf ] Ecm]\na \u20141\nX)\t~\tconstante de difusividade,EcmJ Csl\nX.\t=\tpar\u00e2metro do m\u00e9todo de Gauss-Mar-quarrit\np\t= viscosidade do fluido do reservat\u00f3rio,CcpJ\np\t~\tdensidade do flu\u00eddo produzido no teste, \u00edgHcml\na.\t=\tfator do p\u00e9so para c\u00e1lculo do res\u00edduo 1-1.........n\n\u00d4 ~ fator de relaxa\u00e7\u00e3o usado por Gauss-rfar\u00edjucu^t\nsubscritor\n\u00bb\t-\tadmens ionai\nd\t=\tadmens i onal\na\t=\test\u00e1tica\nf\t=\tfluxo\ni\t=\tn\u00famero do ponto\nJ\t=\tn\u00famero do par\u00e2metro\nk\t=\tn\u00famero da itera\u00e7\u00e3o\no\t\ti nici al\nw\t\tpo\u00e7o\nwf\t-\tfluxo no po\u00e7o\nwe\t\test\u00e1tica final no pi\nSuperescrito:\t\t\n\u00bb \u2666 S*\t22 t Unidades\t\tderivada primeira derivada segunda transp\u00f4sto f\u00edsicas:\nELJ\t\tcomprimento\nCM3\tSS\tmassa\nCT1\t-\ttempo\nSistema\t\tDARGY de unidade\nCL]\t\tcent\u00ed metro\nCM]\t-\tgrama\ntf]\t-\tsegundos\nQuantidade\tUni dade \u00edkxrcy\tMui ti pl i car por\tUni dade SI\n\t2\t1\t017-/1\t2\n\t\t\t\nComprimento\tcm\t1.OE-2\tm\nCompressi bi1 idade\tatm 1\t9.867E-6\tPa\nMassa espec\u00edfica\t3 gZcm\t1.OE+3\tkg/m3\nPer meabi1i dade\tDarcy\t9.869E-7\ta m\nPress\u00e3o\tatm\t1.OI32E-1\tMpa\nVi sc\u00fcsidade\tcp\t1.OE-3\tPaZs\n~ Constantes de transforma\u00e7\u00e3o de unidades\nTabel a 9.2\n10.\tREFER\u00caNCIA BIBLIOGRAFICA\n1.\t\u00c2bramovitz, M. and Stegun, I. A. editores : Handbook of Mathematical fu\u00f1etinos, Dover Publications Inc., New York C19703.\n2.\tBarua, J. and Horne, R. N. : Improved Estimation Algorithm for Automated Type Curve Analysis of Well Test Data - SPE 14265C 1985.3.\n3.\tBarua, J. and Horne, R. N. : Computerized Analysis for ThermalRecovery Well Test Data ~ SPE 12745 Cl9843.\n4.\tBarua, J. and Horne, R. N. : Using Simultaneous Downhole FlowRate and Pressure Measurement to Improve Analysis of WellTest Data - SPE 12985 Cl 9843.\n5.\tChang, J. and Ershaghi, I. : An Improved Microcomputer Approachto Well Test Interpretation ~ SPE 15928 Cl 9863.\n6.\tCorr\u00eaa,A. C.: An\u00e1lise de Teste de Press\u00e3o em Po\u00e7os Produzidos com Press\u00e3o Constante - Trabalho Apresentado no Segundo Congresso Brasileiro de Petr\u00f3leo, Rio De JaneiroCRJD Brasil , Outubro 3-7, 1982.\n7.\tCorr\u00eaa, A. C. and Ramey, H. J. Jr. : Combined Effects of Shut-In and Production : Solution with a New Inner Boundary Condition- SPE 15579 Cl9863.\n8.\tCorr\u00eaa, A. C. : Application fo the Unit Step Function to Transient Flow Problems with Time-Dependent Boundary Conditions, Disserta\u00e7\u00e3o de Ph. D. , Stanford University, Stanford, CA, Mar\u00e7o, 1988.\n9.\tCorr\u00eaa. A. C. and Ramey, H, J. Jr. : A Method forPressure Buildup Analysis of Drill Stem Test - SPE 16803 Cl 9875.\n10.\tDennis , J. E. Jr. and Schnabel1. R.B.: Numeri cal Methods for unconstrained Optimization and Nonlinear Equations - Ed. Academic Press, London - Chapter 10 Cl9855.\n11.\tEarlougher\u201e Robert C.Jr.: Advances in Well Test Analysis, Monograph Series, Society of Petroleum Engineers of Ai me, Dal1 as Chapter 8 C19775.\n18. Hanson, J. M. : Nonlinear Inversion of Pressure Transient Data- SPE 18848 C19845.\n13.\tHefeman, P. S. and Abbaszadh,M. : A Simulator for Drillstem Test Interpretation - SPE 16380 Cl9875.\n14.\tMarquardt, D. W. :\tAn Algorithm for Least Squares\nEstimation of Nonlinear Parameter - J.Soc. Ind. Appl. Math, vol. 11, No. a, Vol.il, No. a, 431-41 CJune 19635.\n15.\tPress, W. H. , Fannery, B. P. , Teukolsky S. A. and Vetterling W. T. : Numerical Recipes - Cambridge University Press, 1986.\nIS. Ramey, Henry J. , Jr. and Agarwal, R. : Annulus Unloading Rates as influenced by Wellbore Storage and Skin Effects -Soc. Pet. Eng. J. 463-468; Trans. , Aime, 253 CJuly-Sept. 19755.\n17. Ramey, Henry J.\nJr. ,\nand Agarwal, R. and Martin, I.:\nAnalysis\nof \u2019 SIug\nTest *\nor Dst Fl ow\nPeriod Data , J.\nCdn.\nPet. Tech.\nC July\nSept.\n19855 37 -42.\n18. Rosa,\nA.\nJ.\nand Horne, R. N. :\nAutomated Type\nCurve\nMatching\nin\nWei 1\tTest\tAnal ysi s\nUsi ng Laplace\nSpace\nDetermination of parameter Gradients , paper SPE 12131 presented at the 1983 SPE Annual techni cal Conference and Exhibit!on, San Francisco, Oct. 3~8.\nWater Resources\n20. Santos, S. A.\nAlgoritmo\nTabelada Segundo\npara aproxima\u00e7\u00e3o de Fun\u00e7\u00e3o\nMlni mos Usando B-Spli nes,\nCDez-19875.\n21.\nScales, L.E. : Introduction\nEd.\nSpr i nger - Ver 1 ag\nt o Non -Li near Opt i mi zat i on\nNew York Inc. Chapter 4 - Cl9835.\n22.\nSilva, M.L. F.\nGeometrias Di versas\nSolu\u00e7Ses para Testes de Forma\u00e7\u00e3o com\n\", Disserta\u00e7\u00e3o de Mestrado, Universidade\nCMar\u00e7o, 19895\n23.\tStehfest, H. :\tNumerical Inversion of Laplace\nTransform - commucications to the ACM, Volume 13, N. 1, Algorithm 36SCJan. 19705.\n24.\tWylie,C. R. : Advanced Engineering Mathematics\u00bb Ed. Macgraw Hill Book Company, New York Cl9755.\n25.\tVan Everdingen, A. F. and Hurst, W. : The Application of Laplace Transformation to Flow Problems in Reservoirs, Trans. Aime Vol. 186, 303-324, Cl9495.\n\u00c2PENDICE a - SOLU\u00c7\u00c3O DA EQUA\u00c7\u00c3O DO SLUG TEST EM FORMA\nDIMENSIONAL C Sistema Internacional3\nConsiderando o fluxo radial de um fluido com viscosidade pequena e com baixa compressibilidade escoando num meio poroso homog\u00e9neo isotr\u00f3pico de espessura constante teremos as seguintes equa\u00e7\u00f5es diferencial* inicial e de contorno:\n+ 1\td p\t\u00e2 p \"o\to\n\t\ndr\tr\td r\td t\nd\tn\tD\tD\np C r , 0 D\tU\t3=0\nlim p C r\tft 3 \u00ab 0 'x\trs\nCA. 13\nCA. 23\nCA. 23\nCA. 43\nCA. 53\nC\nD\n<?P WD\ndt\nCA. S3\nUsando os grupos dimensionais da tabela 1 e os conceitos de:\nqueda de press\u00e3o no reservat\u00f3rio: ApCr,t3 = p. - pCr,t3\nqueda de press\u00e3o no po\u00e7o: Ap^Ct3 = pi - p^Ct3\no problema se torna ent\u00e3o:\nd2Ap 1 3 Ap 1 dAp\nCA. 73\n\ne r\nr \u00e2 r\n\u00e2 t\nAp C r , 05 -O\nCA. 85\n11m Ap Cr,t5 = 0 r-+<\u00ae\nAp C 0+5 - 1\nCA. 95\nCA. 105\nAp C t 5\nV\n\u00f5Ap\nApC r ,t5 ~ Sr -----------\nv\tt?r r-r\nCA. 115\n<?Ap\n<?r..\n- cf p\nCA. 125\nr=r\nw\n8 n k h \u00e2 t\nr w\nCA. 145 A transformada\tde\ttap\u00edoce\tda\teondi\u00e7So de contorno\ninterna, equa\u00e7\u00e3o CA. 125, \u00e9:\nC\tp\t_\n=\t------\u2014_ C s p ~ p 5\tCA. 155\n2\tn\tk h\tvt\nr=r\nw\nSubstituindo CA.155 na equa\u00e7\u00e3o CA.145 e resolvendo para p teremos:\nwf\no\n\n....*\tJ ..%\nS/77 K C r v SZy) 3\nV\t1 w\ncf p s\n\nJ*\ns\n1\nt,\nS + -7=^\nr /%\nv\nK Cr \u2022/SZp 3 O v\nK C\ni\nr VSZi) 3 w\n\n\u25ba\n\n2 n k h\n\u2019+\u25a0\nCf p\nCA. 163\nAPENDICE B\n- DERIVA\u00c7\u00c3O\nREI.A\u00c7\u00c3O AOS PAR\u00c2METROS DO\nDAS\nEQUA\u00c7\u00d5ES\nDO \"SLUG TEST\" COM\nRESERVAT\u00d3RIO\nB. 1\nCaso\ndo\nPo\u00e7o\ncom efeitcr de pel\u00edcula positivo CSkin > 03\nA equa\u00e7\u00e3o\npara\np Cx>s3 foi deduzida wf\nno ap\u00eandice A.\nDefinindo\nC\ni\nv $ u e r z t V\n\u00a15 n h\ne\n\n\u00a1u\nEnt\u00e3o a equa\u00e7\u00e3o CA. 163 se torna :\n/*\u2022\npo&lt;\nc\n2\nk\n\n+\u25a0\u2022\nCf s\nP\u00ed\np , wf\nCB. 1.13\n\ns\n\ns\n\nK CC -/Szk 3\no i_________. .\nC /SZk K C C -/SZk 3\n1\t* i\tJ\nC k\n2\n1\nCf\ndefinindo as\nsegui ntes\nfun\u00e7\u00f5es auxiliares, teremos:\nK CC -/^ZY. 3\nAuxl\nS +\nCB. 1.23\nAux2\nAux3\nC k p.\n2\tl.\nC B.1.33\n'\u201c\u2018f\ns\npo Auxl + Aux2\nr\n\u201c2\nAux8 = s Auxl + \u00c0ux4\nA express\u00e3o da press\u00e3o no po\u00e7o se torna Aux3\nCB. 1.43\nCB. 1.53\nCB. 1 . S3\nCB. 1.73\nAux8\nA derivada da press\u00e3o com rela\u00e7\u00e3o \u00e0 permeabilidade ser\u00e1;\n<3 Pvf\nd k\nCC ZC,3Cp.-p 3-\u00cdAuxl/k- Aux7\n2 f \u201e L O 1_______________ \u00bb\nCAux83^\nCB. 1.83\nAux5 =\nccp^/k'\n1.\n3\n1\n\u2022 *\nCB. 1.93\n3\n2\nAuxS =\t1 - Aux5\nCB. 1.103\nAux\u00f5\nAux7 - -----\n2 k\nAs outras derivadas s\u00e3o: .\n13 Em rela\u00e7\u00e3o ao \"skin\":\n\u00e2 p .\tAux4 Cp - p 3\n'-ft \u201e\t________o_____v\n\u00b0 S\tC AuxSlf\n113 Em rela\u00e7\u00e3o a p : o\n\u00e2 p,\tAuxl\n\u00bf? po\tAuxS\nCB. 1. 113\nCB. 1.123\nCB. 1.133\nQ9\niW Em rela\u00e7\u00e3o a Cf\n\u2022' p.\u201e(\tC AuxlZC 5 C p Aux4 - s Aux25 f\to\n\u00e2 CL f\tC Aux85~'\nCB. 1. 145\n\u00cdv5 Em rela\u00e7\u00e3o a pressSo do reservat\u00f3rio p. :\nrs\tAtT-vzt\nw \u00a3-/\t<r*4 U* ww\n---w\u00a3 -\t\t c B. 1,155 \u00e2 p;\ts Aux8\nForam usadas as seguintes reia\u00e7des para a deriva\u00e7\u00e3o da fun\u00e7\u00e0o de Bessei modificadas :\no5\t\t<* xp K Ca x 5 dx 1\tp\t= -\t\u25a0 a xp K C a x 5 (p-i\u00ed\t\t\tCB.1.165\n&amp;5\ta\t\u201d SC Ca x 5 = dx p\t\u201c &lt;K\u201et\ta 5 + K C P\ta x\t\tCB. 1.155\n\t\tlembrando que\tK Ca x ~p\t5 = K Ca p\tx 5\t\t\n\tregra da cadeia\t\t\t\t\t\t\n\ta\tK C C /s/k 3 V \u2019\tO\t\u00a3\t<\td \u25a0<\t\u2019 K Ca x5 1 o\t} *\tX\tCB. 1.165\n\t\t\t&amp; X\t\t\tdk\t\nB. 2 ~ Casa do Pa\u00e7o com efeito de pel\u00edcula negativo CSkin &lt;0)\nA equa\u00e7So para PufCx,si foi deduzida no ap\u00eandice A.\nNeste caso usa-se o conceito de raio efetivo do po\u00e7o Cr 5\nwo. r - r expC ~\u00a35\nwa w\nDefinindo C\n\u25a0t\n- V u c r 2 t wa\ne\nent^o a equa\u00e7\u00e3o CA.165 se torna :\n\t\"\u25a0\tJ\t\t1\t*1 K CC /SZk 3 O\t1\tC\tk p.\no\tC ^Zk K C C -ZSZk3 1 11 K\tJ\t\u00bb + Cf s\nwf\tK CC /BZk 3 O\t1\ns&lt;\tC T^Zk \u00a1C C C ZSZk 3 1 11\nsendo:\nAuxl =\nK CC /SZk 5\no i_________\nC /Szk K c C -/SZk 3 \u00b1\tti\nC k p.\nAuxa =\t-----v\nC, s f\nAux3 = p Auxl + \u00c0ux2\no\nk\nAux4 \u2014 C ---\nh\nAux8 = s Auxl + Aux4\nCB. a. 13\nCB.a. S3\nCB. a. 33\nCB. a. 43\nCB. a. S3\nCB. a. S3\nA express\u00e3o da press\u00e3o no po\u00e7o se torna :\n__\tAux3\nPvfC*\u2019s5 =\t-----\nAuxB\nCB. a. 73\nA derivada da press\u00e3o com rela\u00e7\u00e3o a permeabilidade \u00e9:\n\u00e2 p\tCC ZC 3 Cp. - p 34 Auxl - k Aux7 $\u25a0\nwt_______Z f\to }\nd k\tCAux83z\nCB. a. S3\n\u00c0ux\u00d4\nAuxZ = -----\na k\nCB. a. 93\nAuxB =\t1 - AuxS2\nCB. 2.102\nAux5\nCC / /k 2\n\u00ed\t..\nCC^y S/k 2\n.2\nCB. 2. 112\nAs outras derivadas s\u00e2o:\n13\tEm rela\u00e7\u00e3o ao \"skin\u201d:\n\u00ca a expressSo mais complicada, pois a fun\u00e7\u00e3o de Bessel depende tamb\u00e9m deste par\u00e2metro; que pode ser explicitado\n1 ogo,\n3 p-.-r\nCAuxl/C,3Cp Aux4 - s Aux23\n f o.............\nCB. 2.123\nCAux832\nd \u00a3\na\nii3 Em rela\u00e7So\np=\n\nAuxl\nCB. 2.113\ndp\nO\nAuxB\n1113\nEm rela\u00e7\u00e3o\na a,\nt\nd p .\n*vf\ndCf\nC Auxl/G, 3 C p \u00c0ux4 - s Aux23 ______ f____o________\nCAux83S\nCB. 2. 123\npress\u00e3o do\nreservat\u00f3rio p^\na\nAt !v^\nCB. 2. 133\n\u00e0 p.\nUsou-se a\ns \u00c0uxS\nrela\u00e7\u00e3o para\na deriva\u00e7\u00e3o da fun\u00e7\u00e3o\nde Bessel:\nd\no3\t\u2014\u2014 -\u00ed K C \u00f2t x 3 1\ndx 1 i\tf\nCa x 3\n1\n--- K Co x3\ni\nx\nCB. 2.143\na K\no\nAP\u00c9NDICE C\nSOLU\u00c7\u00c3O DO DST EN FORMA DIMENSIONAL\nCSistema Internacional^\nUsando as mesmas hip\u00f3teses estabeleci das no Ap\u00e9ndi ce A\npara a solu\u00e7\u00e3o do\t\"si ug\ttest\u201d o problema\tdo DST ser\u00e1 dado por.-\ni 2p \td P D\t\tCC. 13\n&amp; r\tr\td r\t\u00e2 t\t\nD\t\u00dc\to\td\t\np Cr , 03 D\tD\t= 0\t\tCC. 33\n= O\nlim p C 'n\nr ->c\u00bb\nD\nr t 3 D, D\nCC. 33\nP \u2018wD\tC0+3\t= 1\tr\ti\t\np\tC t 3\t= p C r \u00bb t 3 ~S\tu r \u2014\t\n\u2018wi>\t\tD\tO\tD\tD\tJ L\tn J\tr =1 \u00bb\nCC. 43\nCC. 52?\nCC. 02?\nUsando os grupos adimensionais da tabela 1 e os conceitos:\n\u00bf3 queda de pressSo no reservat\u00f3rio ApCr.t) = p^ ~ pCr,t3 \u00bfi? queda de press\u00e3o no po\u00e7o : Ap^Ct3 = p - p^QCt3\no problema se torna ent&amp;o:\ndz&amp;p\t1\t\u00e2\tAp\t1\tdAp\t\n\t + .\t\t\t\t \u2014\t\u2014\t\tCC. 73\na rZ\tr\ta\tr\tT?\td t\t\nAp C r \u00bb\t0\t3\t= 0\t\t\tCC. 83\nCC. 93\nlim Api r, t 2? = O r-K\u00fc\nAp C0+3 = 1\nAp\u201e Ct3 = ApCFtr,t3 \u201cS\n- \u00e1p\ni----\ndr r-r u\tw\nCC. 103\nCC. 113\n(C1\t~ s 3C 4- se >\t\t\u2018^Ap ~\t\t<?Ap\t\tCC. 123\n1\tk\to.\tfc b j\t\td r\tr -r w\t- dr 3\tr=r V\t\nOnde\ts\tp\t\t\t\t\tCC. 133\n\t2 n\th\tk\t\t\t\t\n\tC\tV\t\t\t\t\tCC.143\n\t\u201cb ~ a n\th\tk\t\t\t\t\nAplicando-se a transformada de \u00bfaplace As equa\u00e7Ses CC. 73 a CC. 113\u00bb e resolvendo-se a equa\u00e7Ao ordin\u00e1ria resultante\u00bb\nCC. 163\nA transformada interna, eq, CC. 123 \u00bb\tde \u00bfcxpiace \u00e9:\tda condi\u00e7\u00e3o de\tcontorno\nT &amp; CApll\tt\t\t\nr \t - L \u00e2 r\t-\u00bb\ta r-r\tt o\tp Ct3 dt + p._ e S\t*\u2022}\u2022\nw\t\t\t\n4- C a\tp - S C. p o\to\tva\t\tCC. 173\nSubstituindo a equa\u00e7\u00e3o CC. 173 em CC.16D e resolvendo-se\npara p CsJ, resulta:\nws\np\nw\nr\np. -t.\n\u2014\ns\n\u00a3+\u25a0\ns\n1 1\nK Cr -/*Sri >\n________O y_______'______\nr t/SZy? K Cr sZr\u00e7 3>\nV\t1 V\n- +\u25a0\n/ t\nP\t-v\ne~stp\tCt3dt+C l + C\nvf\td[\t4>\nro\tJ\nV\nk.\nK Cr -/~^'r\u00a1 3\nO v\t\u2019\n'\u2022'\"S.\u2022\"*\nZT) 3\nr /sZt?\u2019 K Cr\nV\t1 V\nC 2nhZp3 k\nCC. 183\nonde\nCC. 193\nC SrrhZjuT k\tC 2nhzp3 k\nC\nCC. 803\nc - [\nc J\n\n\nr-\n4*\nC\ns\nC\nf\nc\ns\nC = a\nf\nC2nhz^3k\nAP\u00caNDICE D\nDERIVA\u00c7\u00c3O DA EQUA\u00c7\u00c3O DO\nDST COM RELA\u00c7\u00c3O AOS\nPAR\u00c2METROS DO RESERVAT\u00d3RIO EM FORMA DIMENSIONAL\nD,1 - Caso do po\u00e7o com efeito de pel\u00edcula positivo CSkin > 03\nA equa\u00e7\u00e3o geral do DST para o caso de um\nciclo foi\ndeduzida no ap\u00e9ndice C.\nDefinindo-se C\ni\nr\n2 n h\n\nent\u00e3o a equa\u00e7\u00e3o CC.183 se torna :\ns\n\nsendo\n<\nS^J\nK CC /Szk3 ________o i\t C y^Zk K CC \u201c/szk3>' 1_______4\t1\nc 4 c\nle Stp COdt +Cl + C J\twf\td\t<\n0\tJ\nv\n\u00f4\na\nc\n1\nK CC 7\u00aeZk 3\no l\nC /^Zk K CC -/Szk 1\n1 1\n1\n\n\nc ..te.\nC 2nhZp3 k\nC D. X . 13\ncf\nc\ns\nCD. 1.23\nC EtnhZp3 k\nC 2nhZp3 k\nC2nh/p3k\ndefinindo-se:\nK CC /Bzk 3\nAuxlO = -----------...S....'...'.;.,  - . _ \u25a0  ,\t,\nCC / zk3K C C / zk 3\ni\tli\nCD. 1.33\nCD. 1.43\nCD. 1.33\nAuxl1 =\t1\n\tK S\to c/s u\t1\nAuxl 2 = C. = b\tC &amp; c k\nAuxl 3 \u2014 C = d\t2 c f C k \u2019 2\n\t\nCC -/szk 3 1\t,\tCD. 1.63\nZk K C C /sZk 3 ti\tJ\tCD. 1.73\n\tC D. 1.83\nAuxl4 \u00bb C - C\no. b\nAuxl 3\nAuxl 2,\nCD. 1.93\nAuxl 5 - p\u201e. e\nt\nP\n\u25ba\nCD. 1.103\nPi\nAuxl 6 =\u2014\u201c Auxl 1\ns\nt\nAuxlA-jsJ e pvfCC3dl +\n\u00c1uxl 51- + p Auxl 3,\n*\to\nCD. 1.113\nAuxl7 = Auxll + s. AuxlS,\nCD. 1.123\n\u00bf?p\n<?k\nentSo:\tp\nws\nAuxl 7 C Auxl 63 *\nAuxl 6\n\u00c1uxl 7\nCD. 1.133\nAuxl 6 C Auxl 73 \u2018\nC Auxl 73 a\n\u00bb\u25a0\nCD. 1.143\nsendo:\nAuxl. 6\nCAuxl63 \u00bb\n3\n~p. Auxl 9 Auxll\nv\ne\nO k\ns\n\n\u00c1uxl 4\ncidkJ\nAuxl 5 AuxSO\nAuxl 9\nAuxSO\nCI\ns CI AuxSO +\np Auxl 3 o\nk\nCD. 1.1S3\n\nr r\n1\n3 1\n3\nl K C C /S/k 3 j\nv i\ti\n-)\u25a0\nCD. 1.163\nAuxl 8\n\nC D. 1.173\nak\nAuxl 4\n\n\nCD. 1.183\nCD. 1.193\nCIDK\np p ~st n ~1 \u00ed\tCx.sJ 1\t,,\nI e L\t! \u25a0\nC D. 1. 203\n<?C Auxl 73\nCAuxl 73\u2019 = -------\n2\n-Auxl9 Auxil\ns AuxlS\nd k\nk\nC D. 1.21D\n\u00c0s outras derivadas s\u00e3o:\n\u00dc3 Em rela\u00e7\u00e3o ao \"skin\u201d:\nC Auxl 1D SC Auxl 6 ~ p. Auxl7/s3\n___ t\t____\nAuxl 7 Auxl 4\ns\nCIOS\ndS\nCAuxl 73 2\nCD. 1.223\n\nCIOS\nJ\n0\nl\nP -st.\nq_ :/-TA Cx.s3\n( \u00e2 S\nJ dt\nCD. 1.233\niii? Em rela\u00e7\u00e3o a\nestocagem dimensional\nda est\u00e1tica\u00bb Cs:\n* va\n\u00e2c\n{ cTT }{AUX17 {s CI *\nCAuxl 73 2\nAuxl 5 J - s Auxl 6 J\nCD. 1.243\niv3 Em rela\u00e7\u00e3o\ncrp\nyq\na press\u00e3o est\u00e1tica* p^:\n^AuxllZs - s Auxl 4 Cl PI J\nCD. 1.253\n\u00bf?p.\nsendo\nAuxl 7\nt\nA...\nCl PI\nJ\no\nwf Cx,s3\n}dt .\nCD. 1.2S3\n\u00bfto\nwa\nAuxl 3 - s\ndpa\nde fluxo inicial, p :\no\nAuxl 4 CIPO\n\nC D. 1.273\nAuxl 7\ntos\nsendo\nriPrt =\tp p -st j e o\trt -1 \u00ed ^wf Cx, s3 l *po\t} dt\tCD. 1 . \u00a383\n\u00cd\u00dc3 Em rela\u00e7\u00e3o\ta est\u00fccagem dimensional\t\tdo fluxo, C :\ndp vs\tf 1\t~ Auxl5 - s\tClJ - s CICF AuxlA\n\tk\t\t\n\t\tC Auxl 73\tCD. i. \u00a393\nsendo:\t\t\t\nCICF =\tt r p -st J e o\tC\u00cd>s3 \u2019\t} dt\"\tCD. 1.303\nD.i - Casa do po\u00e7o com efeito de pel\u00edcula positivo CSkin &lt;03\nequa\u00e7\u00e3o Qeral do DST para\nt r*y '\u00ed H d\u00bb rir**\u00bb\tip^\u00e9T'\u00edH -\u00ed r^c\u00edSi\tf**4 f\t\u00ed** \u00ed 55\"^\n^\u2014\u25a0\u2014\tU\tW*-r rA.V^Z-Z \u00bb\u25a0\nDefinindo-se C = i/&lt;\u00a3 p cr^\ni\tt va\nonde r = r exp C-SO,\nva\tv\nent\u00e3o a equa\u00e7\u00e3o CC.103 se torna :\n! 1 i\tK\t1\t- +\n\tK CC 7 SZk3 o 1\t\n\t&lt;C /3/k K CC 7 SZk3^ 1\ti\t1\t\nP\t\u201c vs&lt;\tZ\t1\t>\t\n\tK CC J*/*. 3 a\t1 > C /SZk K CC /SZk 3z 1 1 \u00b1\t\nonde:\no\tcaso de\tUffi\tciclo\tfoi\n\t\t2 n\th\t\ne\tS ~ \u25a0\tP\t\u00bb\t\nc -e\tz t p fe stpvfCt3dt\t\t+ c d\t+c Q\n\t0\t\tJ\t\n\tc a\t\t\t\u00bb\n+ s\tC2nhzp3\tk\tCD.\t\u00a3.13\nc\na\n\nC\nsi\nC 2nhZp5 k\nC 2nhZp5 k\nCC. a. \u00a33\nC,\na\n\u201cSt Pff e p\n>\nCD. 2. 35\nC\nc f\n-----------, p ,\nC2nhZp5k\nCD. 2. 45\ndef 1 n\u00ed ndo-se\nAuxl O\nK CC -/\u00aezk 5\n____o___i___________\nC -/ z~k. K c C / \u00ae zk 5\ni\tti\nCD. 2. 55\nr\n1\nAuxl 1\nAuxi a\nAuxl 3\nAuxl 4\nAuxl 5\nAuxl 6-\nK CC /Szk 5 o i________\nC -/^zk K C C -/ Zk 5\ni\ncb\nC\n<x\nC\na.\nPff\n\u00a3\nCD. 2. 65\n1\n1\nP\u00ed\n--- Auxll\n\nAuxl7 =\np Cx,s)\nW\u00abt\nC s\nC k\n2\ns\nC k\n2\n\n-K. tp e\nAuxl 4\nAuxll +\n5\nAuxl 6\nAuxl 7\nCD. 2. 75\n\u00bb\nfr\nCD. a. 85\nAuxl3 - Auxl2>\nC D. 2. 83\nCD. 2. 105\n\n\nt\np \u00a1' o\n-st, P\nvf\nAuxl 2\n\n\nCL5 dt +\nAuxl 5 J *\nCD. a. 115\nCD. a. 125\nCD. 2. 135\nA derivada em rela\u00e7So a permeabilidade \u00e9 :\n\u00bfto ws \u00e1k\nAuxl7.C Auxl631\nAuxl 6. CAuxl73\nC &amp;WX\u00cd 73 \u00a3\npara\nC Auxl 63 \u2019\n\u00e1CAuxl63 -p. . AuxlS. C Auxll3\u00a3\n 1. \n\nk\ns\nAuxl 5 Aux20 i- - p Auxl 3 >\ni\t\u2018o.\n\ne\nii3 Em\nI \u00a3X W\nAuxl 8\nAuxl \u00d5\nAux20\nCI\nt P\nJ\na\nC Auxl73\n1\nX\u00bb\ni\na CC^ S/k 3\nC -/ ^/k 3\n1\nF\n[KiC\n}\u2018\n\u00bb\n1\n---Auxl 8,\n2 k\n-Auxl 4\nk\n~st\ne\n>\nr t '\u00ed\npvf\nt P\n\u201cSt\ne\ndt,\ne1/.\nJ a k\nCx\u00bbs3\n}\ndt t\n\u00e0s outras\nAuxllS Auxl 9\nderivadas s2o:\n\u2019\u2019skin'*\ns\nk\nrela\u00e7\u00e3o ao\nCAuxll3\u00a3AuxlSCAuxl6 -p, Auxl7/s3\nJ-\nCAuxl73\u00a3\nAuxl 2.\nAuxl 7\nsenda:\n> CD, 2. 143 s CI. Aux20 +\u2022\nCD. 2. 153\nCD. 2. 163\nCD. 2. 173\nCD. 2. 183\nCD. 2.193\nCD. 2. 203\nCD. 2. 213\nAuxl4 s CIOS\n\u00bb\nCD. 2. 223\nCIOS =\nftp -stn-V\tf *\u2022\u201e, Cx.s5\t\nJ\te\t[L &lt;O\tl~s\t> dt\nCD. 2. 233\nAuxl 8 -&lt;\tr\tfK CC y^Zk 3 i O\t1\t2 .\n\tX \u25a0\u201c\t\u00ab\tK C C */\u00aeZk 3 k\t' > *\nCD. 2.243\nC :\nS\nCD. 2. 253\niv3 Em rela\u00e7ao a press\u00e3o est\u00e1tica\u00bb\nAuxll\ns\n<?p.\nCD. 2. 253\nAuxl 7\nD. 3 - Coment\u00e1rios adicionais:\nOs termos do tipo\n273\n\u00d4FCx\u00bbt3 -i\n-------- _\ndx\nonde l = 1,2\u00bb....\u00bbm\nx = par\u00e2metros Ck,s,.. ,C)\nrepresentam a transformada inversa de \u00bf.\u00abxplaee da deriva\u00e7\u00e3o da\npress\u00e3o do per\u00edodo de f 1uxo\u00bb em reia\u00e7\u00e3o aos par\u00e2metros a\nserem determinados\n(3 termo Cl ~ je p^fCt3dt representa a integra\u00e7\u00e3o sobre\no per\u00edodo de fluxo, para cada argumento de La.pla.c&amp; s do per\u00edodo de est\u00e1tica,\nPara a deriva\u00e7\u00e3o desta integral em rela\u00e7\u00e3o aos par\u00e2metros foi usada a regra de L&amp;\u00edbri\u00ed t-z:\nda\n$2Ca3\nJ FCx,a3dx\n$iCa3\n$zCa3\n<?f\n----- dx +\nJ da\n<\u00a3iCa3\nd^i\nFC^t.o\u00fa----\nda\nd<\u00a3z\nFC , \u00ab3--------\ndot\nd\nCD, a. 283\nPara\nno tempo\nzero,a qual n\u00e3o \u00e9\nde se obter por invers\u00e3o\nnum\u00e9rica\nda transformada de\nfoi\nusado o\nvalor inicial:\nlim\ns->cr\n(L^fCO fv\nlim fCt3 t->o\nCD. 2, 293\n\n\nusando as\nequa\u00e7\u00e2es B.1.8\u00bb\tB.1.10\u00bb\t8.1.11\u00bb\n8.1.12 e 8,1.13 respectivamente:\n...__\nd k\nCD. 2. 303\nr\u00edtt\n(as\nCD, 2. 313\n\u00ed^d&lt;ts3 I \u00b0 Po\nCD, 2. 323\nf\nt \u00e2 Pi\n/\tCx,s3\nt * S\nCD. 2. 333\no.\nCD. 2. 343\nAPENDICE E\nM\u00c9TODOS INVESTIGADOS COMO ALTERNATIVAS PARA\nSOLU\u00c7\u00c3O DA INTEGRAL DO PROBLEMA DO DST\nE. 1\t- Integra\u00e7\u00e3o direta atrav\u00e9s do uso de express\u00f5es para\npwfCtl como por exemplo: pwfCtl w ai/t '+ b t + c\nVantagens:\n\u00a35 A integra\u00e7\u00e3o \u00e9 r\u00e1pida.\nDesvantagens:\nO Perde-se muito tempo na determina\u00e7\u00e3o de a,b, &amp; c atrav\u00e9s de regress\u00e3o n\u00e3o linear, e muitas vezes obt\u00e9m-se residuos multo grandes.\n\u00bfO A express\u00e3o n\u00e3o \u00e9 gen\u00e9rica, pa\u00eds depende do comportamento das press\u00f5es de fluxo.\n\u00a3 \u00a3 \u00bf3 Este processo n\u00e3o pode' ser api i cado para resolver as demais integrais que dependem da deriva\u00e7\u00e3o de par\u00e1metros no f1uxo.\nE. S- Integra\u00e7\u00e3o atrav\u00e9s de avalia\u00e7\u00f5es do integrando pelos m\u00e9todos trapezoidais:\tRegra de Slmpson, m\u00e9todo\nde Newton-Cotes, Quanc8 etc.\nEstes algoritmos exigem que se forne\u00e7a a express\u00e3o para o c\u00e1lculo do integrando, no caso atrav\u00e9s de invers\u00e3o n\u00famerica da express\u00e3o obtida em \u00bfaplace, em pontos igualmente espa\u00e7ados.\n-Vantagens:\nO Facilidade de uso do m\u00e9todo\n-Desvantagens:\nO Exige-se muito tempo para convergir para o valor correto, devido aos fatos:\n\u00bf.13 O integrando n\u00e3o \u00e9 uma fun\u00e7\u00e3o suave,\n\u00bf.23 Para se determinar cada valor do integrando tem-se que fazer a invers\u00e3o num\u00e9rica da express\u00e3o em \u00bfaplace.\n\u00a3. 33 Exige-se a estimativa de muitos valores do integrando\tpara a converg\u00e9nciaC em torno de 200\nestimativas^.\nE. 3 - Integra\u00e7\u00e3o atrav\u00e9s de m\u00e9todo tipo polin\u00f3mios ortogonais: m\u00e9todo de Gauss.\nDeve-se fornecer a express\u00e3o para c\u00e1lculo do integrando, atrav\u00e9s da invers\u00e3o num\u00e9rica, em pontos diferentemente espa\u00e7ados.\n-Vantagens:\n\u00bf3 Facilidade de uso\nt- -#\u2022\t\u00edtkrfj\u00bb i\u00bb, aaa u wj,\n\u00bf\u00bf\u00bf3 Possibilidade de melhorar a precis\u00e3o do resultado atrav\u00e9s de subdivis\u00f5es do intervalo de integra\u00e7\u00e3o.\n\u2014Des vantagens:\n\u00bf3 A preci s\u00e3o do m\u00e9todo depende da quanti dade de subdi vi sSes do intervalo, e nSo se sabe qual a subdivis\u00e3o ideal para cada caso.\n\u00bfO O tempo gasto para a integra\u00e7\u00e3o \u00e9 proporcional a quantidade de subdivis\u00f5es do intervalo de integra\u00e7\u00e3o.\nE. 4\nIntegra\u00e7\u00e3o atrav\u00e9s de uso do splines c\u00fabicos\nInterpola-se os valores obtidos de pwfCt3 ou dpwfCtJZdxj atrav\u00e9s do polin\u00f3mio c\u00fabico definido por:\nfCO = CCi ,33 . Ct-ti33 + CCi\u00bb2XCt-ti32 + CCi,13.Ct-U3 + PCi3\ne integra-se a express\u00e3o resultante analiticamente.\nO problema se torna ent\u00e3o a determina\u00e7\u00e3o dos coeficientes CCi ,33, CCi,23 e CCi,13 para cada caso.\nPode-se tamb\u00e9m usar a fun\u00e7\u00e3o degrau unit\u00e1rio para efetuar esta integra\u00e7\u00e3o, e transformar a integra\u00e7\u00e3o do intervalo de zero a tp em:\ntp\tn tCi+13\n\u00a1.-t rtu dl,\ni=l tC13\n11\t=\tCCi ,33. El. CE2CA13+A23-6Zs43\tCE.\t43\n12\t=\tCCi,23.El.CE2CBl3+\u00cdZs33+2Zs33\tCE.\tS3\n13\t=\tCCi ,13. El. CE2. BI + \u00cdZS^\tCE.\t63\n14\t=\tPCi3.El.CE2 + 1ZS3\tCE.\t73\nonde\nDt =\tTii\u00ed - Ti\tCE.\t83\nAl =\tCDt - lzs3\tCE.\t93\n\u00c02\t=\t3. DtZs2-5Zs3\tCE. 103\nBI\t-\tDt + izs\tCE. 113\nEl\t=\te\u201csTl-\tCE.1E3\n-e~S'Dt\tCE. 133\n-Vantagens:\n\u00a33 Rapidez no c\u00e1lculo da integral\n\u00bf\u00a33 Precis\u00e3o nos resultados\n-Desvantagens:\n\u00a33 O m\u00e9todo de integra\u00e7\u00e3o s\u00f3 funciona bem para integra\u00e7\u00e3o com dados gerados Csent ruidos3. porque a varia\u00e7\u00e3o dos valores da interpola\u00e7\u00e3o entre os pontos tem que ser suave.\nti3 Para alguns casos deve-se modificar os valores das condi\u00e7\u00f5es auxiliares do splines c\u00fabicos, que geralmente s\u00e3o os vaiores das der i vadas pr i mei ra ou segunda, devi do \u00e0 mudan\u00e7a das derivadas nos tempos inicial e final de um teste para outro dependendo do comportamento do po\u00e7o.\nii3gasta-se um tempo grande calculando os coeficientes do splines.\nE. 5 - C\u00e1lculo da integral atrav\u00e9s do uso de quadratura dos coeficientes do splines c\u00fabicos pelo IMSL:\ncalcular\nC3.C\u00cd3. Vwii or\no integrando\npara gerar\nos coefi ci entes\ndo splines c\u00fabicos, os quais ser\u00e3o usados no c\u00e1lculo da\nintegral.\n-Vantagens:\ni3\tFacilidade de uso\nti3 Precis\u00e3o nos resultados\n-Desvantagens:\n\u00a33 Demora nos c\u00e1lculos das integrais\n6.\tIntegra\u00e7\u00e3o atrav\u00e9s do uso de transformada de Laplace.\n\u00bb\n162)\npwfCz\nO m\u00e9todo consiste em obter uma nova express\u00e3o no espa\u00e7o de Laplace, a qual possa ser Invertida numericamente, seja\nt\np\nCl - j e\u201cst.p^.CtCdt\tCE. 143\nJo w\nAplicando-se a transformada de \u00bfctplcxce a eq. E.\u00cd4 tem-se:\nOL^CI ~ pTfCz + s2>,\tCE.15D\nLogo\nCl \u00ab a.\"4/ - .\nI\tz\nonde:\nz \u00e9 o novo argumento da transformada de Laplaae\nPvfCz + s) \u00e9 a transformada de taploce da press\u00e3o p calculada em Cz + sD.\n-Vantagens;\n\u20ac3 Rapidez e simplicidade do m\u00e9todo\n-Desvant agens:\nO A precis\u00e3o do m\u00e9todo depende basicamente da preci s\u00e3o do algoritmo de invers\u00e3o num\u00e9rica da transformada de La.ploce.\n\u00bft? D algoritmo que apresenta melhor precis\u00e3o \u00e9 o algoritmo de Crurrtp > que i ncl usi ve tem o contr\u00f4l e do erro m\u00e1xi mo permitido. Entretanto, sua utiliza\u00e7\u00e3o requer o conhecimento das fun\u00e7Ses de \u00d4esse^ modificadas para argumentos complexos, as quais n\u00e3o est\u00e3o dispon\u00edveis.\n\u00bf\u00bf\u00bfD O algoritmo de Steh/est apresentou erros consider\u00e1veis quando aplicado ao exemplo, principalmente para os dados finais do per\u00edodo de est\u00e1tica.\nE. 7\t- C\u00e1lculo da integral atrav\u00e9s do uso dos quadrados\nm\u00ednimos com fun\u00e7Ses B-Splines c\u00fabicos.\nPara se resol ver\ntp\nintegral Cl = j\" a stp dt no a\tw\nintervalo de zero a tp Ctempo de produ\u00e7\u00e3o?, pode-se usar um ajuste que n2o passa necessariamente pelos pontos observados, O m\u00e9todo consiste em se aproximar o integrando p Ct?\n20\tW por\n<Ns+2)\nPwfCt? = ACiX\tCE.17?\nL=\u00b1\nonde Ns \u00e9 o n\u00famero de B-splines do intervalo BXt? s\u00e3o valores definidos pela base B-splines, AC 13 s\u00e3o coeficientes que minimizam o res\u00edduo ao quadrado definido por:\n\tn\t<N\u00bb+2)\t2\t\nRCACi?? = Min\t1 f t.co\t- 2 ACi?.\tBC t? ]\tCE. 183\nj=t\t\ti\u20141\t\t\nPara determi na\u00e7ao\tde ACi} dever-se derivar a\t\t\texpress\u00e3o\nacima com rela\u00e7\u00e3o a\tcada AC i 3\te obter\to vai or\tnulo da\nderivada:\t\t\t\t\na R\t\t\t\t\n\t = O\tpara\ti = 1,2, , . .\t. . \u25ba ns+2\t\tCE. 19?\ndACi?\nResultando em um sistema normal com ns+2 equa\u00e7des ns+2 inc6gnitas> as quais s\u00e3o os coeficientes ACi?.\nPara se efetuar o c\u00e1lculo da integral em sub-intervaios definidos entre os tempos tj e tj+i\u00bb deve-se novamente multiplicar a integral pela fun\u00e7\u00e3o degrau unit\u00e1rio [Si+\u00ed-Si], a fim de restringir o limite de integra\u00e7\u00e3o:\ntp \u00edNa+2)\ttv+l\nACj? [*e~st B.Ct? dt CE. 20} \"0\t'f~*\tt=i\tX.\ni\nNesse caso a fun\u00e7\u00e3o B-Splines tamb\u00e9m deve ser definida no intervalo de tt a ti+i ao inv\u00e9s de t\u00ed-2 a t\u00ed+2 como\n+3Ct-t \u00eds+e s\u00eah3+ 3^ Ct.-t? + 3hCt.-t3S -3CL, -C33 + j\tj+i\tj+i\tj+i\nCE. 333\ncuja solu\u00e7\u00e3o \u00e9:\nCl = 1/h3 CACj~13 li + ACJ3 12 + ACj+13 Ia + \u00c0Cj+23 It\u00ed,\npara j= 1,2\u00bb\t,Ns+2.\tCE, 243\nonde:\t\n3\t2\t3\t4\t\nI\u00b1 = E1CE2CA1 + 3dtZs - 5/s5 + GZs3\tCE. 253\nIz ~ E1CE2 A2 - A3Zs3\tC E, 253\nIs - E3CE4 B2 + B3zs3\tCE. 273\n\u00cd4 = E3CE4CB13 + 3 DtZs3 + 5 Zs3 3 + 6Zs43\tCE. 283\ncom\t\nAl = Dt - iZs\tCE. 293\nsendo\tDt = tj+i -tj\tCE. 303\nA2 \u00ab h3 + 3hZsS - SDtZs3 + 16Zs3 - SAIC\u00c1I3 - Al h\t2 - h 3\n\tCE. 313\nA3 ~ Ch-lZsD3 + 3hZs3 + IQZs3\tCE. 323\nBI - Dt + IZs\tCE. 333\nB\u00a3 - h3 + 3hZsa ~ QDtZs3 ~ 13Zs3 ~ 3BlCBia - Bi h\t~ h33\n\tCE. 343\nB3 = Ch+lZs33 + 3hZs3 + 19Zs3\tCE. 353\n\u2122.\t\u201cS tj+l Ei ~ e\tCE. 363\ns Dt\t\n\u00a35\tCE. 373\nE3 =\tCE. 383\n~s Dt\t\nE4 =\t-\tCE. 393\ns\n-Vantagens do m\u00e9todo:\nRapidez no c\u00e1lculo da integral\n\u00bf\u00a33 Precis\u00e3o nos resultados\n\u00bf\u00bf\u25a1Permite suavizar a curva .de fluxo pela minimiza\u00e7\u00e3o dos ru\u00eddos.\n\u00a3v3 Permite o c\u00e1lculo das integrais envolvendo a derivada da press\u00e3o no integrando com rela\u00e7\u00e3o aos par\u00e2metros.\n-Desvantagens do m\u00e9todo:\n\u00a33 Com rela\u00e7\u00e3o aos m\u00e9todos pesquisados n\u00e3o h\u00e1 desvantagem.\nAP\u00caNDICE H - SOLU\u00c7\u00c3O DO PROBLEMA DO DST ATRAV\u00c9S DE DIFEREN\u00c7AS\nFINITAS\nConsiderando a equa\u00e7\u00e3o diferencial parcial para um fluxo\nradial de um fl*\ti\u00ed do\tcom vi scosi dade\t\tpequena e\tcom bai xa\ncompr es si bi 1 i dade\t^5\tcoando\tnum mei o\tporoso\thomog\u00e9neo.\nisotr\u00f3pieo\u00bb de *> j*\tespessura\t\tconstante\tteremos a\tsegui nte\n1 3 L.\ta p\t- 1 ~ \u25a0\ta p\t\tCH. 13\nr \u00e2 r t\t&amp; r\tJ\ta t\t\t\nx \u201c ir*\tr-\t\tX r- \u2014\t\tCH. 23\n1\t&amp;\tf Jr\ta p\t1 \u25a0)\ti\ta p\t\tCH. 33\nr* \u00bf? x -\ta x\tr J\tr\ta t\t\t\nCH. 43\nA discretiza\u00e7\u00e3o fica:\t\t\nx=a\tAx\tAx\nX=Xn\n\u00ed\ti\ti\ti\ni \u201c0\tl~\"\u00ed\t1\tt+\u00ed\nnx\na^ p\tp\t\u2014 2 p + p\nL - i\tL + 1\n2:\t. 2\nd x\tAx\nCH. 53\n\u00e2 p\tn+i p. -\t\tn pv\na t\t\tAt\t\nCH. 63\nsendo\nn\u00edvel de tempo atual\nn + 1&lt;\u2666 n\u00edvel de tempo futuro\nO m\u00e9todo totalmente impl\u00edcita fica\nP.-i\n\u25a0 a p. + p.\nI\ttfl\nj.\nAx\nMi\nSx f P t\n= e\n{\u25a0\nn\nP- 1\nAt2_ }\nCH.53\nn+1\ni-i\nni-1\npi\nAx 2 1\nAt\nn+i\nP\ni+t\nC zx,3\n-e t\nz\nAx n ~At~ Pt\nChamando ce\n^2X 3\nB L\nCH. 63\nn+i p.\nt+1\nn+1\nP\nt\n\u25a0b\nn+1\nP\nt+i\nAx At\nn -a p.\nCH.73\nCH. 83\n[ a + .\u00ab\n[\na + o\n]\na&lt;\n&lt;nx\ni\ni.\nDiscretiza\u00e7\u00e3o da condic\u00e3o de\t\tcontorno interna\t\nd p\tf\t* P i\t\t\nC \t-\t-\t\u2014\t= O\tCH. 93\nd t\tc\td r\t-*r =\t1\t\nonde\n{C\tno fluxo\nC\tna est\u00e1tica\ns\nFazendo a substitui\u00e7\u00e3o de vari\u00e1vel\nd p.\n<? P\nCH.93\nn+t rP, \u201e l At\nrite. L\nH+i r c pi [\"\u00c3t +\nn+i\nP\n\u00c3X\n4-\nz\n^2\nn+1\nP 1\nC\nAt\nCH. 103\nCH.113\nd t\n\u00e0 x\nn\n= 0\nC\n]\n- O\n1\n\nn P *2\nchamando\nn+1\nn+t\nCH. 123\nCH. 133\ncontorno externa\nConsidera-se um\nreservat\u00f3rio limitado com\nraio externo grande o suficiente\npara que a queda de press\u00e3o\nem r = ro seja nulo.\np\n[\n\na r\nCH. 143\na p\n]\n-*X ~ X\n0\nCH. 133\na x\n*\u00bfX1\u00bfX I\nnx-i nx\tnx+*\nponto\no\nCnx+13 \u00e9 um ponto imagin\u00e1ria.\nQ p\nn+1\nP n+ 1\nn+1\nPn-1\nCH. 163\nO\na x\na \u00bfx\nP\nn+1\nn+\u00ed\nn-f-1\nCH. 173\nMontagem do sistema tridiagonal\ni\t= 1\n.\t1\tn+1\tn+1\tn\n*+1J p- + p\u2018 - -e p.\nCH. 133\n1 24\nA X\nA t\nCH. 143\ni &lt;2 &lt;nx ~ 1\nn+i\t! p.\t-\t2 V+A\tt\t+\tr>+\u00b1 p\t= -\u00ab L+l\tn p\u00ed\tCH. 153\npara\t\tC zx 3&lt;x, \u2014 e\t\u00ed\tZAx\tCH. 163\n\t\t\tAt\t\ni - nx\t\t\t\t\n...\tn+1 r 2. p\t- nx-t\t{\t.\t1\tn+1 2 + a 1 p nx i\tnx\tn - -O\u00ed\tp nx nx\t\tCH. 173\nSi \u00a3 tema t r i di agonal\nSeja \u00c3 a matriz dos coeficientes abaixo:\ni -\nrix-l\nnx\n1\n-ca-no\ti\n1\t3\nnx\n1\na\nSe ja IB &amp;&lt;C os vetores coluna abaixo:\nA solu\u00e7\u00e3o das pressSes ser\u00e1 dada por &amp; EB = C\nprograms\nI,. I* \u00bb\u00bb M\n\u00ed U\u00cdKC\u00bb \u00e0W\n\u00bfK4 wat \u00bfifl *5\u00a1ft \u00abS tv*.\nruf u nA\nAp\u00eandice G. 1 - Otimiza\u00e7\u00e3o no fluxo para c\u00e1lculo de k, S, p e\nC f\n-\tAs subrotinas Coeff, S18acf, &amp; SlSadf est\u00e1d no ap\u00eandice G. 4\n\u2014\tA subrotina Zxssq \u00e9 da biblioteca do IMSL para micro PC.\nProgram zero\nExternal Pressa,Coeff , SISacf, SI8adf\nInteger M,bf,Ixjac,Nsig, Maxfn, Iopt, I,Infer,ler\nReal ParamC43 ,XC43 ,FC273 ,XJacC27,43 ,XjtJCiO> , Work&lt;843 ,Eps,Del ta w\u00edSsq,XlC43\nReal*8 Timet 273 , Pwf C273 ,DpwfC27? ,P1 ,Pe, Po, Rw,Ct,Phi , Vi sc, Th, Cl, C2, mC3\nCommon /Dados/Time,Pwf\nCommon /calc/ Dpwf\nCommon /reser/Po,Pe,Rw,Ct,Phi,Vise, Th, Pi,Cl,C2,C3\nOpen Cl,File = \u2019Topo. dat *3\nOpen C 2, File = * c: slug, dat \u2019 3\nOpenCS, Fi le = * C: itera, datf 3\nOpenC4,File = \u2019C: curva, dat\u20183\nC. . . .. Parametros para a rotina de minimizacao.........................\nM = 27\nN = 4\nIxjac = 27\nNsig = 8\nEps =0.0\nDelta = 0.0\nMaxfn = 300\nIopt = 2\nParamC13 = 0.01\nParamCSl = 25.\nslihC 33\t130 \u201e\nParamC43 =0.1\nC....Vai cross i r>i ci'ai s dos parsmotro k , c , pi , s.................\nX1C13 = 1.\nX1C23 = 80000.\nX1C33 = 0.\nX1C43 = S.6S\nC.....Outros dadosC Unidades Americanas?\nCt = 10.20D-Q6\nPhi= 0.062\nVisc= 60.0\nPe = 8S2.\nTh = 38.\nRw = 4.248\nC\nC. ,...parametros iniciais de reservat\u00f3rios k,c,po e s C Unidades Darcy?... WriteC2,200?\n200 FormatClh,/,49x,/,10x,\u2019PermeabilidadeCdarcy?\u2019,\n-x3x, \u2019EstocagemCcm3/atm? \u2019 , 3x, \u2019 PoCatm? \u2019 ,5x, \u2019Skin* , /?\nWriteC2,2iO3XlC13,XlC23,XlC43,XlC33\n210 Format\u00ed 10x,Dll. 4,9x,Dll. 2,10x,D12. 3,5x,D12. 3,/3\nC.....parametros de fluido e rocha........................................\nWriteC2*1805\n180 FormatCz*25x*1 Dados de fluido e rocha't/,3x,'Compress. Cl/ps\u00a35\u2019, *3x, \"Poros!dade\u2019 , 3x* * viscCcp5 * ,4xt \u2019Pi Cps!5 ' ,3x,'Th\u00edpes) \\3x, \u00bb\u2019RwCin5 \u2019 ,/5\nWri teC 8.1405Ct,Phi,Vi se,Pe,Th,Rw\n140 FormatCIx,El0.3.10x,F8.3\u00bb7x,F6. 3,3x.F9. 8,6x\u00bbF6. 8,3x*FS.35 C.....Transformacao dos dados para o sistema Darcy de undidades.\nCt = Ct\u00bb14. 7\nPe = Pe/14.7\nTh = Th*30.48\nRw = Rw\u00bb2. 54\nC.....Parametro auxiliar\nP1 =4.\u00abDatant1.0D05\nC1 ~ DsartCPhi*Visc*Ct*Rw*Rw5\nC8 = 8. xPl*Th/Visc\nC3 = DlogC2.D05\nC\nC.....Escalonamento dos parametros para minimizacao.......................\nXC15 = X1C15\nXC85 = X1C25/100000.\nXC35 = XIC 35/10.\nXC45 = XIC 45/10.\nCali ZxssqCPressa,M,N*NSIG( EPS*DELTA\u00bbMAXFN,I<5PT, PARAM, X *SSQ,F* wXJAC * IXJAC , X JTJ * WORK * INFER*IER5\nC: :::::::::::::::::: : Impress\u00e3o dos dados finais:\nWriteC2,35Ssq*Infer.Ier\n3\tFormatCSx*\u2019Soma dos quadrados dos residuos = \u2019,D10.5,/,5x,\u2019Criterio *e de convergencia que foi satisfeito =\u2019(I3,/,ox,\u2019Erro =\u2019,I3,//,3x, \u00ab\u2019Valores residuais = Pmed. \u2014Peal na ultima convergencia\u2019 * /5\nC.....Descalonamento dos residuos apos minimizacao\n150 51 I s 1 ,M\n31 FCi5 ~FCi5*PwfCi5\nWriteC2.8205\n880 FormatClH*////,13x,\u2019Press\u00f5es Geradas no file 4\u2019,//*19x,\u2019tChr5\u2019*3x* x\u2019PwfCpsi5\u2019,5x,'DpwfCPsi5\u2019,5x,\u2019Residuos\u2019,/5\nWriteC4,24O5CTimeCi5 *PwfCi5 *Dpwf\u00edi5 *FCi5 *1=1 ,M5\n840 FormatCl7x*F7. 4*3x,F9. 2*5x*F9. 3*3x*F10. 55\nC. . . . .Descalonamento dos parametros apos a minimizacao........    .\t. . .\nXC15 = XC15\nXC25 = XC25W1OOOOO.\nXC35 = XC35*1O.\nXC45 = XC45W10.\nWriteC8*15Ci,XCi5*i = 1,45\n1 For matt Sx. \u2019Valor otimo = \u2019 * \u2019XC \u2019 * i3, \u20195= \u2019,2x,DlO. 45\nWriteC\u00a3,115\n11\tF\u00f3rmate//,5x,\u2019Matriz aproximada do ultimo j acobi ano \u2019 ,/5\nDo 7 I = 1*13\n7 WriteC2,95 I *CXjacCi *J5,j = 1*45\n9\tFormatC2x*i2*4C4x*lPel2.555\nWriteC2,135\n13 F\u00f3rmate/* i x. \u2019 Vetor norma grad- num iteracoes~num d\u00edgitos signific-~ e marquadt algorit resp. \u2019,/)\nWriteC2,15?Cl .WorkCl? ,i=l ,5?\n15\tFormatCSx,rWorkC*,12,*3= \u2019.FIS.S?\nCi\ti \u25a0'\u00bb\nClose C2?\nm\t3^\nS-4A\tiw\u00eari?\nCloseC4?\nEnd\nBlock Data Entra\nC..... Dados de press\u00e3o do teste\nReal*8 Ti meC 273,PwfC273\ncommon ZDadosZ Ti me,Pwf\nData Time ZO.022.0.026,0.034,0.041,0.053,0.067,0.084 *,0. 106,0. 132.0. 166.0. 187.0. 209.0. 236,0. 264,0. 296,0. 334, *0.372.0.418,0.47,0.528,0.59,0.662,0. 774,0. 836,0. 938,1.061. Ml.126Z\nC\nData Pwf Zl54. 36,162. 77,178. 64,191.66.212. 33,235. 07,260.33\n*,290. 27.322. 43,360. 31,381.69,402. 68,426. 82,449. 74,473.37,500.57, *524.7,651.18,678.,604.36,629.63,655.09,688.34,703.76,726.34, *746.97,758. 71Z\nEnd\nSubr out i ne Pr essat X, M, N, F?\nInteger M.N.M1,NL\u00bbI,K.J.Ifail\nReal *8 PwtC 275 , Ti meC 272 , AC 27? , VC 20? . DPwf C 373 , SI 8acY.\n\u00abSI 8adf,Xs,Cl, C2, C3, BkO, Bkl , Auxl , Aux2,Aux3, \u00c0ux4, Sumr , Plapr , Y, Z, Pi M,Pe,Po.Rw,Ct,Phi , visc,Th\nReal XCNJ.FCM?\nCommonzl pl ZV, Ml\nCommon zDadosZTi me,Pwf\nCommon ZcaleZDpwf\nCoKiinon /reser/Po,Fe,Rw,Ct,Phi , Vise ,Th, PI ,Cl , C2,C3\nC.....Descaionamento dos par\u00e2metros para minimizacao.......................\nXC1? = XC1?\nX\u00cd2? = XC 2? *100000.\nKC3? = XC3?*10.\nXC4? = XC4?*10.\nC. ... Impress\u00e3o dos par\u00e2metros que ser\u00e3o minimizado........................\nWriteC3,42?CXC1?,i=l,N?\n42\tFormatC3x,4C3x,Fl5.3??\nC. . . . . Calculo da funcao com invers\u00e3o de laplace.......................\nMl = 8\nMl = 1\nDo 10 i = 1 ,M\n10\tTimeCi? = Ti met i ? *3600.\nGama = DsqrtCXCl??\nAl f a = ClzGama\nAux4 = C2*XC1?ZXC2?\nC\nD0 20 1=1,M\n20 ACI?=C3ZTlmeCI?\nC\nCali CoeffCNl?\nC\nDo 40 i = 1j M\nSumr = 0.\nEto 30 J = 1,N1\nZ = J * ACiD\nY = DsqrtCzD\nXs = Y* Alfa\nBkO = SISACFCXs. IFAILD\nBkl = S18ADFCXstIFAILD\n\u00c0uxl = XC32) + BkOzCXs * BK12)\nAuxZ = C2*XCll*PeZCX\u00ed3D*ZD\nAux3 = XC 42) *Auxl + Aux2\nPlapr ~ Aux3ZCZ*Auxl + Aux4 D\n30\tSumr = Sumr + VCJ2)*Plapr\n40 DpwfCiD- Sumr* AC 12)\nC\nDo 50 I = 1,M\nDpwfCiD = DpwfCi2)*14. 7\nTi meC i D = Ti meC i D Z3S00.\nFC12) = CPwfCiD - DpwfCiDDzPwfClD\n30\tWrite C*^1DFC1D\n1 FormatC3x> \u2019 F =* , El5. 82)\nC\nC.....Impress\u00e3o do valor da soma dos quad. res\u00edduo nesta iteracao..........\nTot = 0.\nDo 31 jk=l(M\n31\tTot Tot + FCjkDwFCjkD\nC.....Escalonamento dos par\u00e2metros para minimizacao........................\nXC1D = XC1D\nXC22) ~ XC2DZ100000.\nXC32) = XC32JZ1O.\nXC42? = XC4DZ10.\nWriteCl t32DCXCI5 fI\u00abl \u00bbN2> >Tot\n32\tFormatCSF14.43\nEeturn\nEnd\nAp\u00eandice G. 2 - Otimiza\u00e7\u00e3o no fluxo para c\u00e1lculo de k, Sep O\n\u2014As subrotinas Mrqmin, SISacf, SL8adf, Coeff est^o apresentadas\nno ap\u00eandice G. 4.\nProgram Kspoposi\nImplicit real*8Ca-h, o-zD\nExternai Mrqmi n * Funes\nDi mensi on XC 273 ,Fwf C 273 , Si gC 273 . AC 33 , Li staC 33 , \u00abCevarC 3 , 33 t Al f aC 3,33 , VC 203\nCommon /reser/Cf * Pe, Rw, Ct , Phi , Vi sc , Th, PI. Cl ,C2, C3\nCommon ZLplzV,Ml\nSave Ic\nC\nOpenC2,file = \u2019Kspo.dat\u20193\nData IcZlZ\nData X ZO.O22,O. 026,0.034,0. 041,0. 053,0. 067,0.084\n\u00ab,0.106.0.132,0.166,0.187,0.206,0. 235,0. 264,0. 295,0. 334, \u00abO.372,0. 418,0. 47,0.328,0.69,0. 662,0.774,0.835,0.938,1.031, Ml . 12\u00d4Z\nC\nData Pwf xl07. 897,111.445.118.367,124.266,134.099,145.196,158. 217 M,174.438,192. 820,215.743,229. 337,243. 156,258. 970,275.990,293.512, *314.638,334. 308,356.997,381.277,406.778,432.344,460.022,499.211, M61S.768,549. 225,579.306,597. 544Z\nC\nData A Z. 5,0. ,8. 5Z\nMl = 1\nNdp = 27\nNp = 3\nNca = 3\nMfit = 3\nAl amda \u25a0= -\u00ed.\nChisgi = 0.\nListad D =1\nLi staC 2D =2\nListaC 33 =3\nC.. . . . Outras dadosCUnidades DarcyD\nCf = 85239.7\nCt = 10. 20D-06M14. 7\nPhi ~ 0.062\nVisc= 60.0\nPe = 892. Z14. 7\nTh = 38. *30. 48\nRw = 4.248*2.54\nC. ... .Impress\u00e3o dos par\u00e2metros\nWriteC2,O ' Valores arbitrados inicial mente para otimizacao \u2019 WriteC2,200D\n200 FormatC lOx, \u2019 PermeabilidadeCdarcyD \u2019 , 5x, >Ski n \u2019 , 3x, * PoC atmD \u2019 , ZO Wri teC 2,21OD AC ID , AC2D , \u00c0C3D\n210 FormatC 10x, Dll.4,9x, Dl 1.2,10x, Dl2. 3D\nC. . . . .parametros de Tluido e rocha....................................\nWriteC2,1203\n120 FormatCZ,25x,* Dados de fluido e rocha1,z,2x,\u2019Compress. C1Zatm3 f\u201e *t\u00e2x.\u2019Porosidade\u2019\u00bb2x.\u2018viscCcp3 \u2018 ,3x,\u2019Pi Catm3 \u2019,3x, !ThCcm3 \u2019,3x. \u00ab\u2019Cf* .2x, \u2019KwCcnO \u2019 ,Z3\nWri teC2\u00bb1403Ct, Phi ,Vise, Pe, Th\u00bb Cf\u00bb Rw\n140 FormatClx,El0. 3,7x,F8. 3,5x,F6. 3,4x,F8. 2,5x,F8. 2.2x.F8.5\u00bb2x.F8. 33 C.....Parametro auxiliar .................................................\nPI = 4.\u00abDatanCl.ODO3\nCl = Dsqr tC Phi *Vi sc\u00abCtmRwmRw3\nC2 = 2. \u00abPlMThzVise\nC3 = DlogC2. DOO\nC.....Transfornacao do Tempo para unidades Darcy..........................\nDo 10 1 = 1\u00bb Ndp\nXC13 = XCi3*36O0.\nPwfC13 = PwfCi3Z14.7\n10\tSigCi3 = l.D-03\nC\n190 Call MrqminCX,Pwf\u00bbSig,Ndp, A, Np, Lista\u00bbMfi t,Covar , Alfa,Nca,Chisq *\u00bb Funcs,Alamda3\nWr i teC\u00ab\u00bb 1553Chi sq, Alamda\n155 FormatCSx, \u2019Chisq= \u2019 ,F25. 7,3x, \u2019 Alamda=\u2019 ,F15. 103\nC\tWriteCl ,1603\nC 160 FormatClOx, \u2019 Permeab. Cdarcy3 \u2018 , 3x, \u2019 PoCatm3 \u2019 , 5x, \u2019 Ski n \u2019 3 WriteCl ,18031c,CACI3,1=1 ,Np3\n180 FormatCI3,3x,F11.4,3x,F12. 3\u00bb3x\u00bbF12. 33\nIc = Io + 1\nIfCCChisq-Chi sql3 . Ge. O. 3 Then\nChisql = Chisq\nGo to 190\nEndif\nIfCCDabsCChisq\u201cCh\u00edsql33.Le.1.0D\u201c23 Go to 195\nChisql = Chisq\nGo to 190\n193 Do 55 I = 1, Ndp\nCall FuncsCXCi3,A,Dpwf,Dp.Np3\n35 Wri teCS\u00bb 113CXC13Z36OO. 3 ,CPwfCi3M4. 73 ,CDpwfX14. 73 ,CPwfCi3 -Dpwf3* *14. 7\n11\tFormate3x, FIO. 3,3C3x, F13. 53 3\nCloseC23\nEnd\nSubroutine FuncsCXl,A,Dpwf,Dp,Np3\nC esta funes e para o caso de determina\u00e7\u00e3o de K,S e Po.\nImplieit real\u00abSCa~h,o~z3\nExternai Coeff,SISacf.SlSadf\nDi mensi on AC Np3 , DpC Np3 , VC 203\nCommon ZLplZV, Ml\nCommon Zr eserZCf,Pe,Rw,Ct,Phi \u00bbVi sc\u00bbTh\u00bbPI , Cl,C2,C3\nC\nWri teC\u00ab, *3C AC 13 ,i=l ,Np3\nC. . . . .Calculo da funcao com invers\u00e3o de laplace.......................\nNI = 8\nDo 40 I = 1\u00bbNp-l,3\nGama = DsqrtCACI33\nAlfa = ClzGama\nAux4 = CSMACID/Cf\nc\nAl = C3ZX1\nC\nIfCMl. Eq. N13Ga to 11\nC\nCall CoeffCN13\nC\n11 Sumr = 0.\nSumbl - 0.\nSuiKhS = 0.\nSumb3 = O.\nDo 30 j = 1 * N1\nZ = J * Al\n\u00a5 = DsqrtCZ)\nXs = YM Alfa\nBkO \u00ab SISACFCXs*IFAIL3\nBkl \u00bb S18ADFCXs,IFAIL3\nB ~ BkOzBkl\nAuxl = AC I *13 + BzXs\nAux2 = C2\u00abACI3-*PeZCCf *zD\nAux3 = ACI+2j*Aux1 * Aux2\nAuxS = C1.ZC2. *ACI333mC1.-B*\u00ae3\nAux8 = Z*Auxl + Aux4\nPlapr = Aux3ZAux8\nPlap2 = CZ*Aux2 ~ ACT *23 *Aux43 *C Auxl ZC AC 13 3\nPlap3 = C Aux8*ACI*23 \u2014Aux3*Z3 ZC AuxQ*Aux83\nPlap4 = AuxlZAuxB\nSumr = Sumr + VC J 3 *P1 apr\nSumhl = Sumbl + VC J 3 *P1 ap2\nSumb2= Sumb2* VCJ3MPlap3\n30 Sumb3= Sumb3+ VCJ3*Plap4\nDpwf - Sumr* Al\nDpCi3 = SumblxAl\nDpCi*13= SuniD2*Al\n40 DpC 1 *23 = Sumb3*Al\nReturn\nEnd\nAux33 ZCAuxQxAuxSl\nAp\u00eandice G. 3 ~ Otimiza\u00e7\u00e3o na est\u00e1tica para c\u00e1lculo de ktS \u2666 Pi.\n\u2014As rotinas Mrqmin, SISacf , SlSadf, Coeff e Q\u00ed\u00ed\u00edbs est\u00e3o apresentadas no ap\u00eandice G. 4.\nd ei n ft n\nPROGRAM DSTp\nI mpl i cx t real *8C a-h t o-z3 Externai Mrqmin,Funcs Dimension AC63 ,Lista.CS> ,CovarC6,6) , AlfaC6,65 Real*8 TCNxD.PCNxJ\nReal *8 DpweC Ndx3 , X tC Ndx3 . Si gC Ndx5 , VC 203 Common ZLplz V.Ml Common zCestzVw.Cw\nCommon Zr eserZCl,CE,C3\nCommon zSplZT.P.Sig.Xt,Dpwe\nCommon zPontosZN.Ndp.Nx,Nde,Ndx\nCommon zPvtzCt,Phi,Vi sc .Po\u00bbPf f,Th,Rw,PI,Cs,Cf . Pk,S\u00bbPe Common ZVazA\nSave ZVaz\nC: : : : : Abre-se arquivo para dados de saida: I:::::::::::::::::::::::::::::: QpenCE.file \u2014 f Dstp.dat '3\nC:::::Chama-se todos os dados do fluxo, estatica e Pvt CVia CommonD: : : ::: Cal1 Dados\nC::::: Chuta-se os par\u00e2metros iniciais para otimizacao: ::::::::::::::::::: AC15 - Pkz6.\nAC23 = Sz5.\nAC 35 - DpweC Ndx3 AC45 = Cw*VwZ2. AC 35 = Cf\nAC63 = Po\nC: : : :Define-se os parametros para o algoritmo de otimizacao: Np = 6 Nca = 6\nMfit = 4\nAlamda = -1.\nChisql = O. ListaC 13=1 ListaC 23 =2 ListaC 35 =3 ListaC 43 =4 Li staC 55 =5 ListaC 65=6\n:::;;Imprime os valores iniciais das variaveis: WriteC2.*3 \u2019Valores e itera\u00e7\u00f5es de K.S.Pi.Cs.Cf e Po sao:\u2019 WriteC2,13O5CACI5.1=1 , Np5\n180 FormatC6C2x, D10. 453\n: : : : : Processo de otimizacao: I:::::;:::::::::::::::::::::::::::::::::::::\n190 Call MrqminCXt,DPwe,Sig,Ndx,A,Np,Lista.Mfit,Covar.Alfa.Nca.Chisq\nr> n\nM,Funcs. Alamda3\nC: : : : Imprime-se os resultados da regress\u00e3o nao linear:\nWr iteC*.1553Chisq\u00bbAlamda\n155 FormatCSx. >Chisq= >/E15. 5.3x, \u2019 Alamda-\u2018 , F26. 153 WriteC2,1853C ACI3.1-1 . Np3\n183 FormatC6C3x,D10. 433\nIfCCChisq-Chisql3 . Ge. (3. 3 Then\nChisql = Chisq\nGo to 190\nEndif\nIfCCDabsCChisq-Chisql33 . Le. 1. OD-23 Go to 195\nChisql = Chisq\nGo to 190\n195 WriteC2,1653\n155 FormatCSx^ * Valores finais de K S Pi Cs Cf e Po apos a otimizacao\u20193 WriteC2.1833CACI3.I-l.Np3\n183 FormatC6C3x, Dl0. 433\nDo 55 I = 1 , Ndx\nCal 1 FuncsC I. XtCi3 .A,Dpws, Dp(Np3\n55 Wri teCS. 113CCXtCi33z3600. 3 > CDpweCi3*l 4. 73 ,CDpws*14. 73 .\n*C DpweC i 3 -Dpws3 *14.7\n11\tFormatC3x. FIO. 5,3C3x\u00bbF15. 533\nCloseC S3\nReturn\nEnd\n: ::: :Entrada de todos os dados do fluxo\u00bbestatica e Pvt: ::::::::::::::::: Subroutine Dados\nImplici t Real*8C a-h,o-z3\nReales VC203\nReal *8 Ti meC Ndp3 , Pwf C Ndp3 , TC Nx3 , PC Nx3\nReal*8 XC Nde3\u201ePwsC Nde3,DpweC NdxS\u201eXtC Ndx3,EigC Ndx3 CommonZl.pl ZV, Ml\nCommon ZCestZVw,Cw\nCommon ZreserZCl.C2\u00bbC3\nCommon ZSplzT,P(Sig\u00bbXt,Dpwe\nCommon Zpontos/N,Ndp.Nx,Nde.Ndx\nCommon zPvtzct.Phi .Vi sc,Pa.Pff\u00bbTh, Rw, PI, Cs, Cf * Pk \u00bbS, Pe\nC:\t:os parametros para o calculo dos coeficientes de Stehfest\nMl \u2014 1\nN ~ 8\nC: : : : : Dados relativos ao Spline: ::::::::::::::::::::::::::::::::::\nNdp = 27\nNde = 33\nNx = Ndp + 1\nIc ~ Ndp\nNdx = Ndp + Nde\nC: : : : : Outros dadosCUnidades Americanas3 ::::::::::::::::::::::::::::::::::\nCt ~ 10.20-05\nPhi = 0.062\nVise = 60.\nPo = 86.\nPff = 397.344\nTh = 38. Rw \u00bb . 354\nC: : : : : Calculo do par\u00e1metro auxiliar PI\nPI = 4. \u00abDatanCl. DOZ)\nCPA= 1. /14. 7\nC: : :: :As unidades relativas a est\u00e1tica ja est\u00e3o em DARCY:\nVw = O.446S48545E+06\nCw = 6.0E-O6*14.7\nCs = Cw*Vw\nRp =&lt;3. 826/25*2. 54\nGrad = 0.00087017\nC: : : : : Parametros de reservat\u00f3rios k,c,pi e s CUnidades DARCYj:::::::::::: Pk = 1.384\nCf \u00ab CPI\u00abRpxRpD/Grad\nS =\t2.\nPe = 892.MCPA\nC: : : : :Transformacao dos outros dados para o sistema DARCY: : :::::::::::: : Ct = Ct*14.7\nPo = Po*CPA\nPff = Pff*CPA\nTh = Th*3O.48\nRw = Rw\u00ab30. 48\nC: : : : : Parametro auxiliar: ::::::::::::::::::::::::::::::::::::::::::::::::\nC1 = DsqrtCPhi*Visc*Ct*Rw*Rw3\nC2 = 2. *PI*Th/Visc\nC3 = DlogC2. EX\u00bb\nC:::::Impress\u00e3o dos parametros::::::::::::::::::::::::::::::::::::::::::: C\tWr i teC *, 2002)\nC 200 F\u00f3rmatelOx,\u2019Permeabi1idadeCdarcy?\u2019,Sx,'Skin\u2019,5x,\u2666PICatnO *,/O\nC\tWriteC*,21O0Pk,S,Pi\nC 210 FormatClOx.Dll. 4,9x,Dll. 2,5x,D12. 32)\nC: : : : : Parametros de fluido e rocha: \u00a1i::::::::::::::;:.*::::;:::::::;:::::: C\tWriteC2,1203\nC120 FarmatC/, 2Sx, ' Dados de fluido e rocha\u2019t/,3x,\u2019Compresa. Cl/atm)\u2019, C \u00bb3x,1 Porosidade*\u00bb3x,\u2019viscCcpD*,4x,\u2019Pff Catm2> * , 3x, \u2019 IThCcml\u00ed *,3x, C w\u2019RwCci\u00ed\u00fc * ,zO\nC\tWri teC2,1403Ct,Phi , Vise, Pf f,Th,Rw\nC140 FormatClx,E10. 3,10x,F8. 3,7x,F6. 3,6x, F8. 2,4x, F8. 2,2x,F8. 32?\nC\nData Time /O. 022D0,0.026D0,0.03400,0. 04100,0.O53DO,O.067D0.0.O84D0 \u00bb,O.10600,0.13200,0.166DO,O. 187D0,0.20900,0. 23500,0.264,0.295,0.334 *,0.372,0. 418,0.47,0.528,0. 59,0. 662,0. 774,0. 835,0. 938,1.051,1.126/\nC\nData Pwf ZL07. 897,111.445,118. 366,124. 266,134. 099,145. 196,158. 217 *,174. 438,192. 820,215. 743,229. 337,243. 156,258. 970,275.990,293. 512, *314. 638,334.308,356.997,381.277,406.778,432.344,460.022,499.211, *518. 768,549. 225,579. 306,597. 544/\nc\nData X Z0.O22D0,0.Oa6D0,0,034D0,0.O41D0,O.053D0\u00bb0.067D0\u00bb0.084D0 *,0.106D0,0. \u00cd32EX>.0.166Ex3,0. 187!X),0. 2C9DO.O. 235DO.O. 264,0. 295,0. 334 x,O.372\u00bbO, 418,0. 47,0. 528,0. 59,0.662,0.774,0.835,0.938,1.051,1.181. *1.326,1.486,1.666,1.87,2. 098,2.189Z\nC\nData Pws z718. 327,719. 993,723. 106,725. 840,730.437.735.658,741.793, *6749. 407,757. 946,768. 390,774. 449,780. 488,787. 236.794. 288,801.302, *809. 408,816. 592,824. 426,832. 254,839.846,846.801,853.591.861.905, *865.498,870. 382,874. 390,877. 707,880.226,882.063.883.319,884.120, *884.573,884. 677Z\nC\nC.. . . .Transformacao do Tempo para unidades Darcy......................\nTC 13 = 0.\nPC13 = Po\nDo 10 I = l,Ndp\nK - I + 1\nTCKD - Timed 3*3600.\nXtCI3 \u00ae TCK3\nPCK3 = PwfCi3zl4.7\nSigCI3 = l.D-03\n10\tDpweCID = PCK3\nDo 17 K = Nx,Ndx\nle = K-Ndp\nDpweC SO - PwsC I e3 Z14. 7\nXtCK3 -\tXCIe3*3600. + TCNx3\n17 SigCKD \u00ab 1.D-O3\nReturn\nEnd\nSUBROUTINE FUNCSCKF.XI,A,DPWF,DP,NP3\nImplicit real*8Ca-h,o-zD\nExternal Coeff\nDi mensi on AC Np3 , DpC Np3 , VC 203\nReal*8 TC503 , PC50D , SigClOO3 , XtClOOD , DpweClOOD\nCommon zLpl/V.Ml\nCommon ZReser ZC1,C2,C3\nCommon ZControleZld\u201eIcent\nCommon ZSplZT,P,Si g,Xt,Dpwe Common ZPontosZN,Ndp,Nx,Nde,Ndx Common ZDeri ZGarna, Al f a,Auxl2,Auxl3,Auxl4,Aux20 Save ZControlez,zDeri z\nC: : : : : Calculo da funcao com invers\u00e3o de laplace: ::::::::::::::::::::::::: IfCKf. LE. NdpDThen\nCALL FLUXOCX1 ,A,DPWF,DP,NP3\nI cont = Icont + 1\nReturn\nEndif\nAl = C3ZX1\nIfCMl. Eq. ND Go to 9\nCALL COEFFCN3\nQ\tIfCId.Eq.13 Go to 11\nCALL CONSTCNP.A3\n11\tContinue\nSuiRT = 0.\nSumbl = 0.\nSurab2= O.\nSumb3= 0.\nSumb4= 0.\nSumb5= O.\nSumb6= O.\nDo 30 J = 1,N Z = J * Al\nY - DsqrtCZ3\nXs = Y* Alfa\nCALL PDESTATICAC A,NP,XS,Z,FLAP , PLAP1\u00bbPLAPE,FLAPS, * PLAP4,FLAPS,PLAP63\n30\nSumr ~ Sumr + Sumbl- Sumbl+ Sumb2= Sumb2+ Sumh3= \u00a3umb3+ Sumb4= Sumb4+ SumbS- SumbS+ Sum.b6= Sumb6+\nVCp*Pl ap VC J3*F1 api\nVC p*Pl ap2 VC p*Pl ap3 VCj3*Plap4 VCJ3*Plap5\nVC J3*Plap6\nDpwf = Sumr* Al\nWriteC*,*OCXI/3600. 3 .Dpwf*14. 7\nDpC 13= Sumbl *A1\nDpC 23 = Sumb2*Al\nDpC 33= Sumb3*Al\nDpC 43 = Sumb4*Al\nDpC53= Sumb5*Al\nDpC 63= \u00a3umb6*Al\nIcont = Icont + 1\nIfCleant. Eq. Ndx3 Then\nId = 0\nIcont = 0\nEndif\nReturn\nEnd\nSUBROUTINE C0NSTCMP.A3\nImplicit Peal*8 Ca-h,0-2:3\nDi mens!on AC Np3\nCommon /ReserZC1.C2.C3\nCommon /Deri/Gama, Al f a,Auxl2,Auxl3,Auxl4,AuxSO\nCommon /Pvt/Ct , Phi,Vise,Po,Pff,Th\u00bb Rw,FI,Cs\u00bbCf, Pk \u00bb\u00a3,Pe Save ZDer iZ\nGama = DsqrtCAC133\nAlfa = Cl/Gama\nCte = 1./CC2 M AC133\nAuxl2 = CAC403* Cte\nAuxl3 = CAC533* Cte\nAuxl 4 = Auxl3-Auxl2\nAux20 = -Auxl4ZAC13\nRetur n\nEnd\nSUBROUn NE PDFLUXOC A, ZE. NP t CI, CI DK. CI OS, CI PI , CI CF, CI PO3\nImplicit realx-SCa-h, o-zj\nExternal Coeff,SISacf, SISadf,Mqbs,Cint eg\nDi mensi on AC Np3 , VC 203 \u00bbTC 503 , PC 503 . Si gC 1003 , X tC 1003 , DpweC 1003\nReal*8 PwfC503,DkC503,DsC503 \u00bbDpi C 503.Dpcf C 503 ,DppoC 503\u201eA2C 503\nReal *8 AsC 43 , BsC 43 > CswC 43 , DspC 43 , EsC 43 , FsC 43\nCommon ZL.pl ZV> Ml\nCommon ZReser ZC1,C2,C3\nCommon zControleZId ,1cont\nCommon zSplZT,P,Sig,Xt*Dpwe\nCommon ZPontosZhi > Ndp, Nx, Nde, Ndx\nCommon ZDeri ZGama, Al f a, Auxl 2, Auxl 3, Auxl 4 * Aux20\nCommon ZPvtzCt,Phi \u00bbVise * Po,Pff>Th, Rw, PI,Cs,Cf\u00bbPk,S,Pe\nSave ZControleZ,zDeriZ,As,Bs,Csw,Dsp,Es\u25baFs\nIfCId. Eq. 13 Go to 45\nAux4 = C2MAC13ZAC53\nPwfC13 = PC13\nDkC13 = O.\nDsC13 = 0.\nDpiC13 = 0.\nDpcfC13 = O.\nDppoC13 = 1.\nDo 40 I = 2,Nx\nA2C13 = C3ZTCI3\nSumbO = 0.\nSumbl - 0.\nSumb2 = 0.\nSumb3 = 0.\nSumb4 = 0.\nSumbS = O.\nDo 30 J - 1,N\nZ = J * A2C13\nY = DsqrtCZ3\nX = Y * Alfa\nBkO \u00ab SIBacf CX, If al 13\nBkl = S18adfCX,Ifa\u00b113\nzi - i. zz\nAuxS = BkOZBkl\nAuxl - AC 23 + AuxSzX\nAux2 \u00bb Aux4*AC33*Zi\nAux3 = AC 63 *Auxl + Aux2\nAuxS = 1.-Aux5*Aux5\nAux7 = Aux6ZC2. *AC133\n30\n40 C\n45\nC\nAux8 = Z * Auxl + Aux4\nAuxSl= 1. ZAux8\nAuxSqi = AuxSi *Aux8i\nPressa \u00ab Aux3*Aux8i\nDerk = C C2ZAC 53 3 *C AC 33 - AC 63 3 *C Auxl ~ AC13*Aux73\u00abAuxSqi\nDersw = Aux4*CAC63 ~ AC333*Aux8qi\nDerpi = Aux4*Zi*AuxBi\nDercf = Auxl ZAC 53 *CAC63*Aux4-Z*Aux23*Aux8ql\nDerpo = Auxl*Aux8i\nSumbO\t=\tSumbO\t+\tVCJ3\u00abPressa\nSumbl\t=\tSumbl\t+\tVCj3\u00abDerk\nSumbS\t=\tSumb2\t-4-\tVCj3*Dersw\nSumb3\t=\tSumb3\t+\tVCJ3*Derpi\nSumb4\t=\tSumb4\t+\tVCJ3\u00abDercf\nSumb5\t=\tSumbB\t+\tVCJ3\u00abDerpo\nPwfCi3\t\tSumbO\t\tA2Ci3\nDkCi3\t\tSumbl\ta\tA2CiD\nDsCi3\t\tSumbS\t\tA2C13\nDpiCi3\t\tSumbS\t\tA2C13\nDpcfCi3\t=\tSumb4\t\tA2C13\nDppoCiD\t\tSumb5\t\tA2C13\nCALL QMBSCT, PWF > AS2)\nCALL QHBSCT,DK,BS3\nCALL QMBSCT,DS,CSW3\nCALL QMBSCT ,DPI>DSP3 CALL QMBSCT. DPCF, ES3 CALL QMBSC T, DPPO, FS3\nId = 1\nCALL CINTEGCZE.CI ,T, AS3 CALL CINTEGCZE,CIDK,T,BS3 CALL CINTEGCZE, CIOS, T, CSW3 CALL CI NTEGC ZE, CI PI ,T,DSP3 CALL CINTEGCZE,CICF,T,ES3 CALL CINTEGCZE.CIPO,T\u00bbFS3 Return\nEnd\nSUBROUTINE PDESTATICACA.NP.XS,Z,PLAPR,PLAP1,PLAP2,PLAF3,PLAP4,\nFLAPS,PLAP63\nI mpl ici t Real *8C a-h, o~z3\nReal *8 AC NpD , TC 503 , PC 503 , Si gC 1003 , XtC 1003 , DpweC 1003\nCommon ZReser ZC1,C2,C3\nCommon ZSplzT,P,Sig,XL,Dpwe\nCommon ZPontoszN,Ndp,Nx,Nde,Ndx\nCommon zDeri zGama,Alfa, Auxl2. Auxl3, Auxl 4, Aux2O\nCommon zPvtzCt, Phi , Vi sc, Po, Pf f, Th, Rw, PI, Cs, Cf, Pk , S, Pe\nCALL PDFLUXOC A, Z, NP, CI , CI DK, CI OS, CI PI ,CICF,CIPO3\nBkO - S18ACFCXs.IFAIL3\nBkl = SlBADFCXs, IFAIL3\nB = BkOZBkl\nZi- l.ZZ\nAuxlO = BzXs\nAuxl 1 = 1.ZCAC2D + Auxl03\nAuxllq = Auxl 1* Auxl 1\nAuxl 5 = Pf f*DexpC -TCNx3*Z3\nAuxlS = CAC33*Zi3*Auxll - Auxl4*CZ*CI + Auxl 53 + AC63*Auxl3\nAuxl 7 = Auxll + Z* Auxl 2\nAuxl 71 ~ 1. ZAuxl 7\nAuxi7qi = Auxl 7i *Auxl 71\nAuxl 8 = 1.- B*B\nAuxl 9 = AuxlB/Ca. *ACi:n\nDauxlS = C - AC 33 * Auxl 9*Auxl 1 q*Zi 3 ~Z*CCi*Aux2O +\u2022 Ci dk* Auxl 43\n* -Auxl5*Aux20 - AC 63 * Auxl3Z AC 13\nDauxl? \u00ab ~Z*Auxl2ZAC13 - Auxl9*Auxllq\nAux = Auxl2ZAC43\nPlapr = Auxl6*Auxl7i\nPlapl = C Auxl 7*Dauxl 6 - Auxl 6*Dauxl 73 * Auxl 7qi\nPl ap2 = C Auxl 1 q*C Auxl S-AC 33 *Zi *Auxl 73 ~Z*Ci os* Auxl 4*Auxl 73 *Auxl 7qi\nPlap3 = CAuxll*Zi - ZxCipi *Auxl 43 XAuxl 71\nPlap4 \u00bb Aux*CAuxl7*CZ*CI+Auxl53-Z*Auxl63*Auxl7qi\nPl ap5 = C Aux*&lt;AC 63 - Auxl 5-Z*Ci 3 ~Z*Ci c f \u00abAuxl 43 *Auxl 7i\nPlaptS = C Auxl 3-ZwCi po*Auxl 43 *Auxl 71\nReturn\nEnd\nC\nSUBROUTINE FLUXOCX1,A,DPWF,DP,NP3\nImpl1ci t real*8Ca-h,o~z3\nExternal Coeff,SlSacf,SISadf\nDimension AC Np3 , DpC Np3 , VC 203\nCommon ZLpl ZV, Ml\nCommon ZReserZCl,C2, C3\nCommon ZPontosZN,Ndp,Nx,Nde,Ndx\nCommon zPvtzCt, Phi , Vi so, Po, Pf f, Th, Rw, PI, Cs, Cf, Pk:, S, Pe\nC... ..Calculo da funcao com inversao de laplace..........................\nGama = DsqrtCAC133\nAl fa \u2014 ClZGama\nAux4 = C2*AC13ZAC53\nAl = C3ZX1\nIfCMl. Eq.N3Go to 11\nCALL C0EFFCN3\n11\tSumr = 0.\nSumbl= 0.\nSumbS\u2014&lt;3.\nSumb3= Ch\nSumb5= 0.\nSumb6= O.\nDo 30 j = 1,N\nZ = J * Al\nY = DsqrtCZD\nXs = Y* Alfa\nBkO - \u00a318ACFC Xs . I FAT. L3 Bkl = S18ADFCXs\u00bbIFAIL3 Zi = l.ZZ\nAuxS = BkOZBkl\nAuxl = AC 23 + AuxSZXs\nAux2 = Aux4*AC 33*Zi\nAux3 ~ ACxAuxl + AuxS\nAux6 \u201c 1. -Aux6*Aux5\nAux7 = AuxoZC2. *AC 133\nAuxB = ZXAuxl * Aux4 AuxSi= 1.ZAuxS\nAuxSqi- Aux8i*Aux8i Pressao = Aux3*Aux8i\n30\nDer k = C2ZAC 33 *C AC 33 - AC 63 3 *C Auxl - AC 13 *Aux73 *Aux8qi\nDer sw - Aux4\u00abC AC 63 - AC 33 3 MAuxSqi\nDer pi = Aux4*Zi *Aux8i\nDercf - AuxlZAC 53 *C AC63*Aux4-2*Aux23*Aux8qi\nDerpo - Auxl*Aux8i\nSumr = Sumr + Sumbl = Sumbl + Sumb2\u201c Sumb2+ Sumb3- Sumb3+ SurnbES- Sumb5+ Sumb6\u201c Sumb6+\nVC j3*Pressao\nVC J3*Derk\nVC j3*Dersw\nVCJ3\u00abDerpi\nVCJ3 *Dercf\nVCJ3 \u00abDerpo\nDpwf = Sumr* Al\nWriteC*\u00bb \u00ab3CX1Z3600. 3 ,Dpwf*14. 7\nDpC13= SumblMAl DpC23 = SumbgxAl DpC33= \u00a3umb3\u00abAl DpC43as 0.\nDpC53= Sumb5*Al DpC63 = Sumb6\u00abAl Pet urn\nEnd\nC\nSUBROUTINE CINTEGCZ.CI\u00bbX.A3\nImplicit real*8 Ca-hto-x3 Real\u00ab8 XCNx3,ACO:33 CommonZVetor2ZCC 0:103 CommonZGer alZNp, Ns\u00bbH\nCommon ZPontos ZN,Ndp(Nx,Nde >Ndx Tp = XCNP3\nHq = H\u00abH\nHe = H*H*H\nHoi = 1. ZHc\nZi = l./Z\nZq = Z\u00abZ\nZqi - 1. ZZq\nZe = Zq*Z\nZci - 1. /\"Z\u00a1z\nCl = 6. *Zqi*Zqi\nHg = H+Zi\nHgc ~ Hg*Hg*Hq\nHl = CH-ZO\nHie\u00bb\nCi = O.\nT1 = O\nra = Tp\nDt = TS-T1\nAl \u00ab Dt~Zi\nAlq = Al* Al\nAl c = Al q*Al\nA2 = He + 3. *H*Zqi - Q*Dt*Zqi + 15. *Zci -3. *A1*C Alq~Al *H-Hql\nA3 = Hie + 3. *H*Zqi +\u25a0 19. *Zci\nBl = Dt+Zi\nBlq- B1\u00bbB1\nBle\u00bb Blq*Bl\n\u00a132 ~ He + 3. *H*Zqi - 9. *Dt*Zqi ~ 13. *Zci ~ 3. *B1*C81q-Bl*H-Hql\nB3 = Hgc + 3. *H*Zqi - 19,*Zci\nEl = DexpC-Z*T31\nEE \u2014 DexpC Z*Dtl *Zi\nE3 = DexpC~Z*Tll\nE4 = - DexpC ~Z*Dtl*Zi\nC21 - El*CE2*CAlc + 3. *Dt*Zqi - 5. *Zcil * CO\nQ2 = E1*CE2*A2 -A3*Zil\nQ3 = E3*CE4*B2 +B3*Zil\nQ4 \u00bb E3*C E4*CBle+3. *Dt,*Zqi+5. *Zcil+CO\nd = CI + Qi *AC 01+Q2* AC 11+Q3*AC 21+04* AC 31\nCI \u00bb CI*Hci\nReturn\nEnd\nBLOCK DATA COM\nI mpl i ci t Real *8 C a-h.o-zl\nCommon ZControleZIdLIcont\nData Id,Icont z0,0z\nEnd\npnnnnnnnnnnnnannannnnnnnannannnnnnnnnnnnonannnnai\nPROGRAMA AUTO\nAUTOR : Jos\u00e9 oliveira VIDAL CSET/885\nOBJETIVO :\nCalcular os par\u00e2metros k\u00bbS,Pi e Po atrav\u00e9s do autom\u00e1tico em po\u00e7os n\u00e3o surgentes de um ciclo\nMETODO UTILIZADO :\nRegress\u00e3o n\u00e2o linear de Levemberg-Marquardt\nUSO :\ni5Rodar programa em fortran Ccom co-processador ii5Nome do programa : Auto\niii5Argui vo de dados :\nDados.dat ou outro\najuste completo\n80875\nnome sem extens\u00e3o\nNLFF TIME.PWF NLE X.PWS CCM CCA CR\nCT\nPHI vise\nTH RW\nPP\nFP CW\nCDP\nDO\nCinclusive em t=05 Cinclusive em t=05\nPAR\u00c2METROS DE ENTRADA :\nLEITURA DO TESTE\nN\u00famero de pontos lidos no fluxo\nPares de pontos lidos no fluxo\nN\u00famero de pontos lidos na est\u00e1tica Csem Dt - 05\nPares de pontos lidos na est\u00e1tica Csem Dt = 05 Constante do registrador Epsig/poll ou EpsigZmml Constante do registrador \u00a3 psigl\nConstante do rel\u00f3gio CpoiZh] ou Cmmxhl LEITURA PVT E DO PO\u00c7O\nCompressibilidade total [psig-12\nPorosidade [Fra\u00e7\u00e3o 0-1J Viscosidade Ccpl\nEspessura do reservat\u00f3rio ou net pay Im] Raio do po\u00e7o Cpol = polegadas!\nProfundidade vertical do packer [ml Profundidade vertical do Fundo po\u00e7o Cm] Compressibilidade do flu\u00eddo produzido Cpsig-ll Capacidade da coluna de teste Cm3zm31\nDensidade m\u00e9dia do fluido produzido C \u00e1gua -11\nPARAMETROS DE SAIDA : k\nS\nPi\nPo\nCf\nCs\nPermeabilidade do reservat\u00f3rio Cdarcy]\nskin ou efeito de pelicula [ 3\nPress\u00e3o estatica do reservat\u00f3rio \u00edatm]\nPress\u00e3o de abertura ou de fluxo inicial latml Coeficiente de estocagem de fluxo Cfixo5 [atm/cmSl Coeficiente de estocagem est\u00e1tica Cfixo5CatmZcm3]\nPROGRAM AUTO\nn n n n n n\nESTE PROGRAMA PRINCIPAL ABRE OS ARQUIVOS DE ENTRADA E SAIDA, DEFINE OS VETORES DE TRABALHO E LE ARQUIVO DE DADOS DO FLUXO + ESTATTCA, E CHAMA \u00c1S ROTINAS AUXILIARES DE OTTMIZAC\u00c0O.\nESTA VERS\u00c3O CONSIDERA O CASO DO SKIN POSITIVO EzOU NEGATIVO,\nIMPLICIT REALm8CA-H,O~Z2\nREALMS TI MEC 502 ,PWFC502,SIGFC 502\nREALMS XC 502 , PWSC 502 , SI GEC 500 , XTC1002 , DPWEC1002 , SI GC1002 , VC 202\nCHARACTERM30 DADOS\nCOMMON ZLPLZ V,ML\nCOMMON ZCESTZVW,CW,RP,GRAD\nCOMMON zPONTO\u00a3ZN,NDP,NX,NDE,NDX\nCOMMON ZPVTZCT.PHI,VISC,PO,PFF,TH,RW.PI,CS,CF,PR,S,PE\nC:::: Parametros para o calculo dos coeficientes de Stehfest :::::::::: ML = 1\nN =\t20\nC:::: Arquivos de entrada e saida de dados I::::;:::::::::::::::::;:::: CALL LIMPA\nWRITECM, *CA\u20192 * ENTRE NOME DO ARQUIVO DE DADOS PRESS\u00c3O E PVT: * READCm, \u00bbC BN, A302 \u2019 2 DADOS\nIFCDADOS. EQ. \u00bb \u20192DADOS = * DADOS\u2019\nOPENCl.FILE = DADOS,STATUS = \u2019OLD\u20192\nOPENC2,FILE = \u2019AUTO. DAT\u20192\nC: ; : ; Dados relativos a leitura do fluxo e estatica\nREADC1,102NLFF\nREADC1.202TEMPO,PO\nNLF \u00bb NLFF -1\nREADCl ,2O2CTTMECI2 ,PWFCI2,1=1 ,NLF2\nREADCl,102NLE\nIFCNLE.EQ. 02 GO TO 5\nREADCl,202CXCJ2,PWSCJ2,J=1,NLE2\n10 FORMATCI22\n20 FORMATC2F15. 02\n5 READCl,3O2CCM\nREADCl,302CCA\nREADCl,302CR\n30\tFORMATCF15. 02\nPO = POMGCM + CCA\nDO 15 I = 1, NLF\nTIMECI2 = TIMECI2MCR\n15 PWFCI2 = PWFCI2MCCM + CCA\nDO 25 I = l.NLE\nXCI2 - XCI2MCR\n25 PWSCI2=PWSCI2mCCM + CCA\nNDP = NLF\nNDE = NLE\nNX = NDP + 1\nNDX = NDP + NDE\nG\nCALL DSTPCTI ME,PWF,X,PWS,XT,DPWE,SIGF,SIGE,SIG2\nCL0SEC12\nCL0SEC22\nCLOSEC33\nEND\nr\nSUBROUTINE DSTPCTIME* PWF, X , PWS, XT, DPWE, SIGF, SI GE, SIG3\nu u u u\nESTA SUBROTINA PASSA TODOS OS DADOS DE ENTEADA PARA O SISTEMA CGS* . CALCULA OS PARAMETROS INICI\u00c1IS E PASSAZRECEBE DADOS DA OTIMIZACAO .\nIMPLICIT REALX8CA-H.O-ZD\nEXTERNAL MRQMIN,FUNCS\u00cdPIKSR2 DIMENSION SWC33.CHIC53 DI MENSI ON AC 63 * LI STAC 63 * COVARC 6.63. ALFAC 6 * 63 REALMS TC 603 * PC 503, II MEC NDP3 * PWFCNDP3 * SIGFCNDP3 REALMS XC NDE3,PWSC NDE3 * SIGEC NDE3,DPWECNDX3 * XTC NDX3,SIGC NDX3,VC 203 COMMON ZLPLZ V,ML COMMON ZSPLZT.P\nCOMMON ZRESERZC1,C2.C3\nCOMMON ZCESTZVW.CW,RP*GRAD\nCOMMON ZPONTOSZN*NDP,NX.NDE*NDX\nCOMMON ZPVTZCT, PHI * VISC,PO* PFF ,TH,RW,PI * CS* CF * PK.S.PE COMMON ZV\u00c1Z\u00c1\nSAVE ZVAZ\nC; : : Chamam-se todas os dados do fluxo, est\u00e1tica e Pvt CVia CommorD : : CALL DADOSCTIME, PWF.X * PWS, XT, DPWE, SIGF* SIGE* SIG3\nC;::: Regress\u00e3o nao linear nos pontos somente do fluxo IFCNDE.EQ. 03 GO TO 5\nC: : : : Estima-se pelo m\u00e9todo cartesiano K e Pi como valores iniciais ::: CAP = PlwRPwRP\nJ = NDX \u201c S\nDT = TCNX3 MC1. ZXTCNDX3-1\u00ab zXTC J33\nDP - CDPWECNDX3-DPWEC333*14. 7\nDC = -DPZDT\nDPF- CPWFCNDP3-PWFC133\nDH = DPFZGRAD\nDV \u00bb DHmCAP\nDTF= C TI MECNDP3 -TI MEC 133/336400.\nQW = DV*6. 29D-06ZDTF\nPKC- 2. 151888*QW*VISCZCDC\u00abTH3\nFC1 - TCNX3ZXTCNDX3\nPEI = DPWECNDX3Ml4.7 + DOFC1\nPEI - PEIZ14. 7\nC: :: : Inicia-se alguns parametros para o processo de otimizacao ::::::: NP = 6\nNCA = 6\nALAMDA = -1.\nCHI SQL - 0.\nC:;:r Busca unidimensional para definir o valor do skin ::::::::::::::: AC13 = PKC\nAC 33 = PEI\nAC 43 = CS\nAC 53 - CF\nAC 63 = PO\nSWMAX = 3.\nSWMIN - ~5.\nDSW ~ SVMAX-SWMIN\nNB = 3\nM 20 I = l.NB+l\nSWCIO ~ SWMIN + DSWmCI-IOZNB\nAC23 = SWC\u00cd3\nSUMF = O.\nDO 30 KF - l.NDP\nCALL FLUXOC TI MEC KF3 \u00bbA\u00bbDPWF\u00bbDP. NP3\nRES = PWFCKFD-DPWF\n30 SUMF - SUMF + RES*RES\nCHICI3 = SUMF\n30 WRITEC*,*3 SWCI3(CHICI3\nCALL PIKSR2CNB,CHI,SWO\nS = SWC13\nWRITEC*,*}\u2019VALOR DO SKIN QUASE COIMO = * \u00bbS\nC:::: Primeira RegressaoCSomente no CluxoD para determinar K,S e Po :::\nAC13 = PKC\nAC23 = S\nAC 33 = PEI\nAC 43 = CS\nAC 50 = CF\nAC 63 - PO\nMFIT \u00bb 3\nLIST\u00c1C10 = 1\nLISTAC20 = 2\nLISTAC33 = 6\nM = 0\nICONTA-O\nWRITEC*,\u00abO >VALORES INICIAIS E ITERA\u00c7\u00d5ES DE K.S.Pi.CF e PO SAO: \u00bb WRITEC*. 4030\u00bb CACI3 , 1=1 , NPO\n15 CALL MRQMINCTTME, PWF\u00bb SIGF\u00bb NDP\u00bb A, NP\u00bb LISTA\u00bb MFIT\u00bbCOVAR, ALFA\u00bb NCA, CHISQ *,FUNCS,ALAMDA,ND\nWRITEC\u00bb, 4000, CACI>, 1=1 \u00bbNP2) .CHISQ\nCALL IMPRESSACM\u00bbA.NP.CHISQ3\nIFCCCHISQ-CHISQO.GE. O.D THEN\nCHISQ1 \u00bb CHISQ\nICONTA = ICONTA + 1\nIFCICONTA. GT. 5. AND. CCHISQ-CHISQ1'J . LT. 1 . D-033 GO TO 25\nGO TO 15\nENDIF\nICONTA = 0\n25\tIFC DABSCCHISQ-CHISQ13 . L.E. 1.00-010 GO TO 35\nCHI SQ1 = CHISQ\nGO TO 15\nC:::: Segunda RegressaoCSo na estatieaO para determinar K\u00bbS e Pi ::::::\n35 PK= AC 13\nS = AC23\nIFCAC63 . LT. 03 THEN\nAC 6D = O.\nENDIF\nPO= AC63\nPC13=PO\nCHI SOL - 0.\nALAMDA = -I.\nAC\u00cdD = PK\nAC25 \u00bb S\nAC 35 = PEI\nAC45 - CS\nAC 55 - CF\nAC 65 - PO\nMFIT = 3\nLISTAC15 = 1\nLISTAC2D = 2\nLISTAC3D = 3\nICONTA = O\nM = 1\nWRITEC*,*} \u2019VALORES INIC. E ITERA\u00c7\u00d5ES DE K,S,Pi ,CS,CF E PO SAO: \u2019 WRITEC*.4O51 ,CACID,I\u00ab1 ,NPD\n43 CALL MRQMINC X tPWS.SIGE,NDE , A, NP, LISTA,MFIT,COVAR,ALFA ,NCA* CHISQ\n* \u201e FUNCS, ALAMDA, MD\nWRITEC\u00ab,4OD1 ,CACID ,1-1 ,NPD .CHISQ\nCALL IMPRESSACM, A.NP.CHISQD\nIFCCCHISQ-CHISQ1D . GE. 0. 5 THEN\nCHI SO\u00cd = CHISQ\nICONTA = ICONTA + 1\nIFCI CONTA, GT. 3. AND. CCHISQ-CHISQ15 . LT. 1. D-065 GO TO 53\nGO TO 43\nENDIF\nI CONTA = O\n33 IFCCDABSCCCHISQ1-CHISQD/CHISQ1DD.LE. 1.OD-O1D GO TO 65\nCHI SQ1 = CHISQ\nGO TO 45\nCi : : : Terceira Regressao\u00edSomente no fluxoD para determinar KtS e Po : : : \u00a95 PE=AC35\nALAMDA \u00ab -1-\nCHISd - O,\nAC15 = PK\nAC 25 = S\nAC 3'5 \u00ab PE\nAC 45 \u00ab CS\nAC 55 = CF\nAC 65 = PO\nMFIT = 3\nLISTAC\u00cdD = 1\nLI ST AC 25 = 2\nLI ST AC 35 = 6\nM = O\nICONTA= 0\nWRITECw.O \u2019Valores iniciais e itera\u00e7\u00f5es de K,S,Pi,Cf e Po sao:\u2019 WRITEC*, 4050, C ACID , 1=1 ,NPD\n73 CALL MRQMINCTTME, PWF, SIGF, NDP, A, NP,LISTA, MFIT, COVAR, ALFA\u00bb NCA, CHISQ *,FUNCS,ALAMDA,MD\nWRITEC*. 4050, CACID ,1=1 ,NP5 , CHISQ\nCALL IMPRESSACM, A, NP, CHISQD\nIFCCCHISQ-CHISQL5 . GE. 0. 5 THEN\nCHI sen - CHI se\nICONTA = ICONTA + 1\nIFCIC0NTA.GT.5. AND. CCHISQ-CHISQ12.LT. 1.D-O32 GO TO 83\nGO TO 75\nENDIF\nICONTA = O\n85 IFCCDABSCCHISQ-CHISen22. LE. 1. OD-12 GO TO 95\nCHI SO\u00cd = CHISO\nGO TO 75\nC: : : : Quarta RegressaoCno f 1uxa+estaticaO para determinar K,S,Pi :::::: 05 PK=AC1D\nS -AC22\nIFCAC62.LT. 02 THEN\nAC62 = O.\nENDIF\nPO=AC62\nPC12=PO\nCHISQ1 = O.\nALAMDA=~1.\nAC12 \u00ab PK\nAC 22 = S\nAC 32 = PE\nAC42 = CS\nAC 52 = CF\nAC 62 \u00ab PO\nMFIT \u00bb 3\nLISTAC12 = 1\nLISTAC22 - 2\nLI STAC 32 = 3\nWRITEC*,*2 \u2019VALORES INIC. E ITERA\u00c7\u00d5ES DE K,S,Pi.CS,CF E PO SAO: \u2019 WRITEC*,4022,C ACI2 ,1 =1 ,NP2\n4O FORMATCI2.7CD10. 422\nICONTA = O\nM S\n105 CALL MRQMINCXT.DPWE.SIG.NDX , A, NP.LISTA.MFIT.COVAR. ALFA, NCA.CHISQ x,FUNCS, ALAMDA,M2\nWEITEC*,4O2\u00a3,CACI2,1=1 , NP2 ,CHISQ\nCALL IMPRESSACM\u00bbA\u00bbNP.CHISa>\nIFCCCHISQ-CHISQ12.GE. O. 2 THEN\nCHI SO\u00cd = CHISO\nICONTA = ICONTA + 1\nIFCICONTA. GT. 3.AND. CCHISQ~CHISCn2.LT. 1.D-O52 GO TO 115\nGO TO 105\nENDIF\nICONTA = O\n115 IFCCDABSCCCHISen-CHISQ2zCH\u00cdSQ122.LE.l.OD\u201c22 GO TO 125\nchi sen = cHisQ\n60 TO 105\nC: : : : Calculo e Impress\u00e3o dos valores finais otimizadas K,S(Po,Pi : : : : : 125 WRITEC2.1352\n135 FORMATO 5XVALORES FINAIS DE K S Pi CS CF E PO APOS A OTIMIZAC\u00c1O\u20192 WRITEC2,1452M,CACI2,1=1 ,NP2\n145 FORMATCI2,1X,6C2X,D1O. 422\n14Q\nALAMDA = O.\nSSR = O.\nDO 50 I = 1, NDX\nCALL FUNCSCI.XTCI1,A.DPWS.DP.NP.20\nSSR - SSR + CDPWECIO - DPWSO*CDPWECID - DPWSO\n50 WRITEC2.6O3CCXTCI3JZ36OO. 0 .CDPWECIO\u00ab14. 70 tCDPWS*14. 70 , *CDPWECI0-DPWS0*14. 7.SIGCIJ\n60\tFORMATC3X . F10. 3 . 4C 3X , F12. 300\nWR\u00cdTEC2.O\u2019VALOR DA FUNCAO OBJETIVO NA ULTIMA I TER AC AO \u2019 , SSR CALL MRQMINC XT.DPWE, SI G.NDX. A,NP ,LISTA.MFIT,COVAR.ALFA,NCA,CHISQ \u00ab, FUNCS. ALAMDA. MO\nC: : : : Estudo estat\u00edstico dos valores finais dos par\u00e2metros\nEMS = SSRZCNDX ~ 30\nVARK = DSQRTCEMS*COVARC1.100\nSTUD = TI N VE RC NDX-30\nPKINF- AC10-STUD*VARK\nPKSUP- AC10+STUDMVARK\nWRITEC2,*0>CPKINF tPKSUP0\u2019.PKINF,PKSUP\nVARS = DSQRTCEMS*COVARC2.200\nSKINF- AC20-STUD\u00abVARS\nSKSUP- AC20+STUD*VARS \u2019VEITEC2. *0 'CSKINF.SKSUP1 \u2019 .SKINF.SKSUP VARPI~ DSQRTCEMSmCOVARC3.300\nPIINF\u00bb AC31-STUD*VARPI\nPISUP= AC30+\u00a3TUD*VARPI\nWRITEC2.X1 \u2018CPIINF. PISUP0 \u2019 ,PIINF, PISUP RETURN\nC:::: Final da regress\u00e3o nos dados completos do Dst ::::::::::::::::::: C:::: Regress\u00e3o ou analise so do slug teste Cse for o caso) ::::::::::: 5 WRITEC\u00bb.\u2019CA'0\u2019 ENTRE VALOR PROV\u00c1VEL DA PERMEABILIDADE EMdl READCM, 'CBN.FIO. 30 \"0PKC\nWRITEC\u00ab( *C\u00c1*0 \u2019 PRESS\u00c3O EST\u00c1TICA PROV\u00c1VEL EM \u00a3 Psig 1\t: >\nRE\u00c1DC*, \u2018CBN.FIO. 30 f0PEI\nNP = 6\nNCA = 6\nALAMDA = -l.\nCHI SO\u00cd = O.\nAC 10 = PKC/lOOO.\n\u00c0C30 = PEI/14.7\nAC40 = O.\nAC 50 = CF\nAC 60 = PO\nSWMAX = 5.\n\u25a0OWK\u00cdT m =\t\u2014 k:\nDSW = SWMAX-SWMIN\nNB = 6\nDO 70 I = 1 , NB+1\nSWCI0 = SWMIN + DSW\u00abCI~10ZNB\nAC20 = SWCiO\nSUMF = O.\nDO 80 KF = 1. NDP\nCALL FLUXOC TI MEC KFO .A.DPWF,DP.NPO\nRES = PWFCKFO-DPWF\nu u u\n80 SUMF = SUMF + RESwRES\nCHICI3 = SUMF\n70 WRITEC*\u00bb*3 SWCI3.CHICI3\nCALL PIKSRSCNB.CHI ,SW3\ns ~ swcn\nWRITEC*,*3-VALOR DO SKIN QUASE OTTMO = \u2019 ,S\nAtas ==\u25a0 s\nMFIT - 3\nLISTAC13 = 1\nLI STAC S3 = 8\nLI STAC 33 = 3\nM = 0\nIC0NTA=0\nWRITEC*,*! \u2018VALORES INICIAIS E ITERA\u00c7\u00d5ES DE K,S,Pi,CF E PO SAO: \u2019 WRITEC*, 4030. CACI3,1=1 ,NP3\n135 CALL MRQMINC TIME\u00bb PWF. SI GF, NDP, A, NP, LISTA, MFTT\u00bb COVAR, ALFA\u00bb NCA, CHISQ *, FUNCS, ALAMDA, M3\nWRITEC*,4O3O,CACI3.1=1 ,NP3 .CHISQ\nCALL IMPRESS\u00c0C M, A, NP, CHI SQ3\nIFCCCHIEQ-CHISQ13 . GE. 0. 3 THEN\nCHI SQL = CHI SQ\nICONTA \u00bb ICONTA + 1\nX FC I CONTA, GT, 5, AND. C CHI SQ-CHISQ13 . LT. 1. D-l 03 GO TO 166 GO TO 155\nENDIF\nICONTA = 0\n165 IFCDABSCCHISQ-CHISQ13 . LE. 1.0D-013 GO TO 173\nCHI SQL = CHISQ\nGO TO 155\n175 WRITEC2.903\nSO\tFORMATC5X.*VALORES FINAIS DE K S Pi CF E PO APOS A OTIMIZACAO\u20193\nWRITEC2,1003M, C ACI3,1 =1 , NP3\n100 FORMATCIS\u00bb1X, SC2X,DlO. 433\nALAMDA = O.\nSSR = O.\nDO 110 1=1, NDX\nCALL FUNCSCI, XTC13 , A,DPWS,DP,NP,03\nSSR = SSR + CDPWECI3 - DPWS3\u00abCDPWECI3 - DPWS3\n110 WRITEC2,1S03CCXTCI33Z3600. 3 ,CDPWECI3*14. 73 ,CDPWS*14. 73 \u00bb *C DPWEC13 -DPWS3 *14. 7, SI GC13\n120 FORMATC3X, F1O. 3, 4C3X.F12. 333\nRETURN\nEND\nRotina, de impress\u00e3o dos par\u00e2metros calculadas nas itera\u00e7\u00f5es\nSUBROUTINE IMPRESSACM\u00bb A, NP.CHISQ3\nIMPLICIT REALMS CA-H.O-23\nREALMS ACNP3\nIFCM. EQ. 03 THEN\nWRITEC2.103 M.CACI3.I = 1,NP3, CHISQ\nRETURN\nENDIF\nIFCM. EQ. ID THEN\nWRI TEC 2\u00bb1ODM, C AC ID,1 =1,NPD.CHISQ RETURN\nENDIF\nIFCM. EQ. 2D THEN\nWRITEC2.10D M.CACID.I =1,NPD,CHISQ 10 FORMATCI 2,7CIX, E10. ADD\nENDIF\nRETURN\nEND\nC\nC\nc\nTransformacao de Ledos os dados de Entrada para unidades Darcy\nZSPL/T.P\nZRESERZCl,C2.C3\nZCEST/VW.CW.RP.GRAD\nZPONTOSZN.NDP>NX,NDE,NDX\nZPVTzCT.PHI,VISC.PO,PFF,TH.RW,PI,CS.CF.PK,S.Pe\nSUBROUTINE DADOSCTI ME* PWF, X . PWS, XT, DPWE, SI GF, SI GE. SIGD\nIMPLICIT REAL*8CA~H,O-ZD\nREAL*8 IT MEC NDPD,PWFCNDPD,SIOFCNDPD,TC 50D,PC 50D\nREALES XCNDED , PWSCNDED , SIGECNDED . DPWECNDXD , XTCNDXD ,SIGCNDXD ,VC20D COMMONZLPLZV,ML\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nC: : : : Calculo dos parametros auxiliares PI e CPA I:::::::::::::::::::::\nPI = 4. \u00abDATANC1.DOD\nCPA\u2014 \u00cd./14. 7\nC: : : : Outros dadosCUnidades Americanas e SI\nC: : : ; Ct, CwCPsx-1D ; Th, Pp, FpCmD ; RwC polD ; CdpCm3Zm3D ; DoCD , PhiCdeci malD :::\nREADCI,10DCT\nREADC 1.1ODPHI\nREADC1,1ODVISC\nREADC 1.1OD TH\nREADCI,1ODRW\nREADCI,1ODPP\nREADCI ,1ODFP\nREADCI,1ODCW\nREADCI ,10DCDP\nREADCI,1ODDO\n10 FORMATCF25. OD\nC: ::: Transformacaa dados fluido e reservat\u00f3rio para o sistema DARCY :\nRP = DSQRTCCDPZPID*100.\nGRAD=DO\u00bbO.000966307\nCF = CPIMRPMRPDZGRAD\nCW = CW*14.7\nRW = RWx2.54\nVW = PI\u00bbRW*RW*CFP--PPD*100.\nCS = CW*VW\nCT = CTM14.7\nPO = POMCPA\nPE = PWSCNDED mCPA\nppp = PWFCNDPD*CPA\nTH = THM00.\nC:::: Calculo dos parametros auxiliares C2 e C3\nca = 2. *PI*THzVISC\nC3 - DLOGC2.DO3\nC: : : : Impress\u00e3o dos parametros I::::::::::;:::::::::::::::::::::::::::: WRITEC2.\u00caO3\n\u00a30 FORMATC Z, 25X, \u2019DADOS DE FLUIDO E ROCHA\u2019,Z,3X,\u2018COMPRESS. ClZatm3\u2019, *3X, \u2019POROSIDADE* ,3X, *VISCCcp3 \u2019 , 4X. \u2019THCcrrD \u2019 ,3X, *RWCcm3* ,z3\nWRITECE, 403CT, PHI . VISC, TH, RW\n40\tFORMATC1X,E1O. 3,1\u00d4X,F8. 3,7X,F6.3,5X,F8.2,3X,F\u00d4.33\nC:::: Transforroacao do Tempo e press\u00e3o para unidades Darcy ::::::::::::\nTC13\t= 0.\nPC13\t= PO\nDO 50 I\t\u00bb 1,NDP\nK\t= 1+1\nTCK3\t= TIMECI3*3600.\nIT MECI 3\t= TCK3\nXTCI3\t= TCK3\nPCK3\t= PWFCI3Z14.7\nPWFCI3\t= PCK3\nSIGCI3\t= PffZPCKD\nSIGFCI3\t= SIGCI3\n50\tDPWECI3\t= PCK3\nDO 60 X\t~ NX,NDX\nIE\t\u00bb K-NDP\nDPWECK3\t\u00ab PWSCIE3Z14.7\nPWSCIE3\t= DPWECK3\nXTCK3\t= XCIE3*3600. + TCNX3\nXCIE3\t= XTCK3\nSIGCK3\t= PEZPWSCIE3\n60\tSIGECIE3\t= SIGCK3\nRETURN\t\nEND\t\nSUBROUTINE FUNCSCKF.Xl,A,DPWF,DP,NP,MPER3\t\nn n n n\nEsta rotina calcula os valores de press\u00e3o e gradiente de press\u00e3o em relacao aos par\u00e1metros para os periodos de fluxo eZou est\u00e1tica .\nIMPLICIT REALX8C A-H. C\u2019-ZD\nREALMS TCSOD.PC503\nDI MENSI ON AC NP3 , DPC MP3 , VC 203\nEXTERNAL COEFF\nCOMMON ZLPLZV.ML\nCOMMON ZSPLZT.P\nCOMMON zRESERzCl,C2.C3\nCOMMON ZCONTROLEZID,ICONT\nCOMMON ZPONTOSZN,NDP,NX,NDE,NDX\nCOMMON ZDERIZGAMA,ALFA,AUX12.AUX13,AUX14,AUX20,CTE\nSAVE ZCONTROLEZ,ZDERIZ\nIFCAC13.LT. 03THEN\nAC13=DABSCAC133\nWRITEC*,*3\u2019Convergencia dif\u00edcil devido dados de entrada\u2019\nENDIF\nIFCMPER. EQ-13 GO TO 7\nIFCMPER. EQ. 2. AND. KF. Gt. NDP3 GO TO 7\n7\nQ\nIX\n30\nIFCKF. LE. NDP. AND. MPER. EQ. 0. OR. MPER. EQ. 23THEN\nCALL FLUXOCX1,A.DPWF,DP,NP3\nIFC MPER. EQ. 23THEN\nICONT = ICONT + 1\nRETURN\nENDIF\nIFCMPER. EQ. O. AND. KF. EQ. NDP3THEN\nICONT = O\nID = 0\nRETURN\nENDIF\nIFCMPER. EQ. O. AND. KF. LT. NDP3THEN\nI CONT - I CONT 4- X\nRETURN\nENDIF\nENDIF\nAl - C3ZX1\nIFCML. EQ. N3G0 TO 9\nCALL COEFFCN3\nIFCID. EQ. 13 GO TO 11\nCALL C0NSTCNP,A3\nCONTINUE\nSUHR = 0.\nSUMB1- 0.\nSUMB2= 0.\nSUMB3= O.\nSUMB4= 0.\nSUMS5= O.\nSUMB6= O.\n\nVCJ3*PLAPR VCJ3MPLAP1 VCJ3XPLAP2 VC J3*PLAP3 VCJ3*PLAP4 VC J3*PLAPS VCJ3\u00abFLAPS\nDO 30 J = 1,N\nZ = J M Al\nY = DSQRTCZD\nXS \u00ab Y* ALFA\nCALL PDESTATICACAfNP,XS,Z.PLAPR,PLAP1,PLAP2,PLAP3\nFLAP4.FLAPS,PLAP83\nSUHR =\nSUMB1 =\nSUMB2=\nSUM83-\nSUMB4=\nSUMB5=\nSUMPS-\nDPWF =\nDPC13 =\nDPC23 =\nDPC33 =\nEPC 43 =\nCPC S3 =\nDPC63 =\nIFCMPER. EQ. 1. AND. I CONT. LT. CNDE-133 THEN\nICONT=ICONT+1\nRETURN\nENDIF\nSUHR + SUMB1 + SUMB2+ SUMB3+ SUMB4+ SUMBS+ SUMB6+\nSUMP* Al SUMB1WA1 SUMB2*A1 SUMB3WA1 SUMB4\u00abA1 SUMB5*A1 SUMB6MA1\n1S4\nn\tnon\nI FC MPER. EQ. 1. AND. I CONT. EQ. C NDE-12 3 THEN\nICONT=O\nID \u201c O\nRETURN\nENDIF\nI FCMPER. EQ. a. AND. ICONT. LT. CNDX-133THEN\nI CONT = ICONT + 1\nRETURN\nENDIF\nIFCMPER. EQ. \u00a3. AND. ICONT. EQ. CNDX-iDDTHEN\nID - O\nICONT = O\nRETURN\nENDIF\nEND\nC\nSUBROUTINE CONSTCNP*AD\nC. . . .................................................................\nEsta retina calcula os valores de alguns parametros auxiiiares da . estatica que sao usados varias vezes.\nIMPLICIT REAL*8CA-H,O-ZD\nDIMENSION ACNPD\nCOMMON ZRESERZCI.C2,C3\nCOMMON ZDERI/'GAMA,ALFA*AUX12*AUX13 > AUX14,AUX20,CTE\nCOMMON ZPVTZCT*PHI,VISC*PO*PFF* TH,RW*PI\u00bbCS*CF*PK*S,PE SAVE ZDERIZ\nGAMA = DSQRTCAC1DD\nI FC AC 23 . LT. OD THEN\nRWA\t=\tRW*DEXPC -AC 23D\nCl\t=\tDSQRTC PHI*VI SC*CT*RWA*RWA3\nELSE\nCl\t\u00bb\tDSQRTCPHIKVISC*CT*RWmRW3\nENDIF\nALFA C1ZGAMA\nCTE = l.ZCCS * AC1DD\nAUX12 = CAC4DD\u00bb CTE\nAUX13 = CACSDD* CTE\nAUX 14 = AUX13-AUX12\nAUX 20 = -AUX14ZAC1D\nRETURN\nEND\nSUBROUTINE PDFLUXOCA,ZE*NP*CI *CIDK,CIOS*CIPI ,CICF, CIPOD\nEsta retina calcula os valores da integracao sobre o fluxo para a pressao e para os gradientes de pressao.\nIMPLICIT REAL*8CA-H*O-Z3\nEXTERNAL COEFF * SI8ACF,SI8ADF,QMBS\nDI MENSI ON AC NPD * VC 203 , TC 503 , PC 503\nREALMS ASCO: 3D *BSCO: 3D ,CSWCO: 3D *DSPCO: 3D * ESCO: 3D .FSCO: 3D\nREALMS DKC SOD * DSC SOD * DPIC SOD * DPCFC SOD * DPPOC SOD,A2CSOD\nCOMMON ZLPLZV.ML\nCOMMON ZSPL/TQP\nCOMMON ZRESERZCI\u201eC2,C3\nCOMMON ZCONTROLEZID,ICONT\nCOMMON ZPONTOSZN.ND?,NX>NDE,NDX\nCOMMON ZDERIZGAMA. ALFA. AUX 12\u00bbAUX13.AUX14, ALJX20,CTE\nCOMMON ZPVTZCT,PHI,VISC >PO\u00bbPFF > TH > RW,PI.CS,CF,PK,S,PE SAVE ZCONTROLEZ,ZDERI Z,AS,BS.CSW,DSPfES.FS\nIFCID. EQ. 13 GO TO 45\nAUX4 = C2*AC13ZAC53\nPC1D = AC63\nDKC13 = O.\nDSC13 = 0.\nDPIC13 = O.\nDPCFC13= O.\nDPP0C13= 1.\nDO 40 1= 2,NX\n\u00c02CI3 = C3ZTCI3\nSumbO = O,\nSUMB1 =\u25a0- a.\nSUMB2 = 0.\nSUMB3 = 0.\nSUMB4 = O.\nSUMB5 = O.\nDO 30\t1,N\nZ \u201c J * A2CI3\nY * DSQRTCZ3\nX \u201c Y * ALFA\nBKO - SI 8ACFCX,IFALHA3\nBK1 = S1SADFCX,IFALHA3\nZI = l.ZZ\nAUXS = BK0ZBK1\nIFCAC23.LT. 03 THEN\nAUX1 = AUX5ZX\nELSE\nAUX1 = AUX3ZX 4- AC 23\nENDIF\nAUX2 = AUX4*AC33*ZI\nAUX 3 = AC63*AUX1 + AUX2\nAUX6 = 1. -AUX5kAUXS\nAUX7 = AUX6ZC2. \u00abAC133\nAUX8 = Z * AUX1 + AUX 4\nAUX8I = 1.ZAUX8\nAUX8QI = AUX 81* AUX 81\nPRESSA = AUX3*AUX8I\nDERK = C C2ZAC 533 *C AC 33 - AC633*CAUX1 - AC 13 * AUX 73 * AUX 8 QI\nIFC\u00c0C23.LT. 03 THEN\nDERSW = AUX4*AUX6*C.AC63 - AC333*AUX8QI\nELSE\nDERSW = AUX4MCAC63 - AC33 3*AUX8QI\nENDIF\nDERPI = AUX4KZI *AUX81\nDERCF = AUX1ZAC 53 *C AC 63 *AUX4-Z*AUX23*AUX8 QI\nao\n40 C\nDERPO\t= AUX1*AUX8I\t\t\t\nSumbO\t-\tSumbO\t+\tVCJD*PRESSA\nSUMB1\t-\tSUMB1\t+\tVCJD*DERK\nSUMB2\t\tSUMBB\t+\tVCJDmDERSW\nSUMB3\t\tSUMB3\t+\tYCJDxDERPI\nSUMB4\t\u2014\tSUMB4\t+\tVCJ>*DERCF\nSUMB5\t=\tSUMBS\t+\tVCJD*DERPO\npen\t=\tSumbO\t\tA2CID\ndkcid\t\tSUMB1\t\tAscn\nosen\t\tSUMBS\t\tA2CID\nDPICID\t\tSUMB3\t*\tA2CID\nDPCFCI3\t=\tSUMB4\t*\tA2CID\nDPPOCID\t=\tSUMBS\t-M\tA2CID\n43\nCALL QMBSCT.P.ASD\nCALL QMBSC T, DK, BSD\nCALL QMBSCT,DS,CSWD\nCALL QMBSCT,DPI , DSPD\nCALL QMBSCT.DPCF.ESD\nCALL OMBSC T, DPPO. FSD\nID = 1\nCALL CINTEGCZE\u00bbCI>T.AS>\nCALL CI NTEGCZE, CIDK, T\u00bb BSD\nCALL CI NTEGCZE, CIOS\u00bb T\u00bbCSWD\nCALL CI NTEGCZE. CI PI ,T,DSFD\nCALL CI NTEGCZE. CI CF, T, ESD\nCALL CINTEGCZE.CIPO.T.FED\nRETURN\nEND\nSUBROUTT HE P DE ST ATICACA, NP, XS. Z,FLAPS,PLAP1.FLAPS. PLAP31PLAP4.\nx FLAPS\u00bbPLAP6D\nC............................-........................  -...............\nC Esta rotina calcula os valores de press\u00e3o estatica e os respect!- , C vos gradientes em relacao aos parametros.\nC.......................................................................\nIMPLICIT REAL*8CA-H,O-ZD\nREAL*\u00a9 ACNPD, TC30D.PCSOD\nCOMMON /SPL/T.P\nCOMMON /RESER/'Cl ,C2.C3\nCOMMON ZPONTOS/N\u201eNDP,NX\u00bbNDE\u00bbNDX\nCOMMON /DERI/GAMA\u00bbALFA,AUX!2,AUX13\u00bb AUX14,AUX20,CTE\nCOMMON /PVT/CT.PHI, VISC. PO, PFF. TH, RW, PI\u00bbCS\u00bbCF,PK>S,PE\nCALL PDFLUXOCA.Z.NP.CI \u00bbCI DK, CI OS\u00bb CI PI .CICF.CIPOD\nBKO = S1BACFCXS\u00bbIFALHAD\nBK1 = S18ADFCXS. IFALHAD\nB - BK0/BK1\nZI = l./Z\nAUX10 = B/XS\nIFCAC2D.LT. OD THEN\nAUX11 = 1./AUX10\nELSE\nAUX\u00cd1 = 1./CAUX10 + AC2DD\n1ST\nnnnfi\nENDIF\nAUX11Q ~ AUX11*AUX11\nAUX15 = PFFmDEXPC-TCNX3*Z3\nALFX16 = C AC3D*ZI3xAUXll - AUX14*CZmCI + AUX133 + AC63*AUX13\n\u00c0UX17 = AUX11 + ZMAUX12\nAUX17I = 1.Z\u00c2UX17\nAUX17QI = AUX17I*AUX17I\nAUX18 = 1. ~ B*B\nAUX19 = \u00c0UX18ZC2. *AC13 3\nDAUX16 = C-AC33*AUX1Q*AUX11Q*ZI3 -Z*C Cl *AUX20 + CIDK*AUX143\n*\t-AUX15*AUX20 \" \u00c0C63*AUX13ZAC13\nDAUX17 = -Z*fAUX12zAC13 - \u00e0UX19*AUX11Q\nPLAPR = AUX16*AUX17I\nPLAP1 = C AL\u2019X17*DAUX16 - AUX16*DALIX173 *AUX17QI\nIFCAC23. LT. 03 THEN\nPLAP2 = C AUX11OAUX18MC AUX16-AC33kZI*ALJX173-Z*CIOS*AUX14*AUX173*\n*\tAUX1 7QI\nELSE\nPLAP2 = C AUXllOC AUX16\u201cAC33*ZImAUX17j-Z*CIOS-m-AUX14*AUX173k\nM AUX17QI\nENDIF\nPLAP3 - CAUX11*ZI ~ Z*CIPI*AUX143*AUX17I\nPLAP4 = CTE*C AUX17MCZMCI +A\u00dcX153-Z\u00bbAUX163*AUX17QI\nPLAP3 = CCTE*C AC63-AUX15-Z*CI3-ZxCICF*AUX143*AUX17I\nPLAP6 = C AUX13\u201cZmCIPOAUX143*AUX17I\nRETURN\nEND\nSUBROUTT NE FLUXOC XI\u00abA,DPWF> DP,NP3\nEsta rotina calcula os valores da press\u00e3o no periodo de fluxo e dos respectivos gradientes com reiacao aos par\u00e2metros.\nIMPLICIT REAL\u00bb8CA-H.O-Z3\nEXTERNAL COEFF,S18ACF,S18ADF\nDI MENSI ON AC NP3 , DPC NP3 ,VC 203\nCOMMON ZLPLZV.ML\nCOMMON ZRESERZCl\u00bbC2\u00bbC3\nCOMMON ZPONTOSZN\u00bbNDP\u00bbNX\u00bbNDE\u00bbNDX\nCOMMON ZPVTZCT.PHI,VISC*PO\u00bbPFF\u00bbTH\u00bbRW,PI\u00bbCS,CF,PfC\u00bbS.PE\nGAMA = DSQRTCAC133\nIFC AC 23 . LT. 03 THEN\nRWA = RW*DEXPC-AC233\nCl = DSQRTC PHI *VI SC*CT*RWA*PWA'.)\nELSE\nCl = DSQRTCPHI*VISC*CT*RWRW3\nENDIF\nALFA = C1ZGAMA\nAUX4 = C2KAC13ZAC33\nAl C3ZX1\nIFCML. EQ. N3GO TO 11\nCALL C0EFFCN3\n11\tSUMR = O.\n30\nO.\nO.\nO.\nO.\nO.\n= 1\u00bbN\nSUMB1-\nSUMB2=\nSUMB3-\nSUMB5=\nSUMB6=\nDO 30 J\nZ = J * Al\nY = DSQRTCZ3\nXS = Y\u00ab ALFA\nBKO = S\u00ed8ACFCXS.IFALH\u00c23\nBK1 \u00ab SlSADrCXS.IFALH\u00c1D\nZI \u00ab l.ZZ\nAUX5 BK0ZBK1\nIFCAC23. LT. 03 THEN\nAUX1 =\nELSE\nAUXl \u00ab\nENDIF\nAUX2 \u00bb\nAUX3 \u00ab\nAUX6 =\nAUX7 =\nAUX8 -\nAUX8I =\nAUX8QI\nPRESS\u00c3O = AUX3\u00abAUX8I\nDERK = C2ZAC 53 *C AC 33 -AC 63 3 \u00abC AUXl - AC 13 \u00abAUX73 \u00abAUX8QI\nIFCAC23.LT. 03 THEN\nDERSW = AUX4*AUX6*C AC 63 -AC 333 \u00abAIJX8QI\nAUXSzXS\nAUX3ZXS + AC 23\nAUX4*AC33\u00abZI AC.63XAUX1 + AUX2 1. ~AUX3*AUX6 AUX6ZC2. \u00abAC 133 Z*AUX1 + AUX4\n1.ZAUX8\n; AUX8I\u00abAUX8I\nAUX4*C AC 63 ~AC 33 3 *AUX8QI\nVC J3\u00abPRESS\u00c3O VCJ3\u00abJ3ERK VCJ3*DER\u00a3W\nVCJ3WDERPI\nVCJ3*DERCF .\nVCJ3MDERPO\nSUBROUTINE CINTEGCZ.CI fXt A3\nC. . ,\nC Esta rotina executa a integracao dos coeficientes da \u00eduncao B-C splines obtidos por quadrados m\u00ednimos.\nC...............- -..............-...............................    .\t. .\nIMPLICIT REAL*8C A-H, O-ZD\nE'EAL*8 X\u20acNXD,AC0:33\nCommonZGERALZNP fNS,H\nCOMMON ZPONTOSZN.NDP,NX>NDE,NDX\nIP = XCNFO\nHQ - H*H\nHC = H*H*H\nHCI = l.ZHC\nzi = i.zz\nZQ = Z*Z\nZQI = l.ZZQ\nZC \u00ab ZQ*Z\nZCI - l.zZC\nCl = 6.*ZQI*ZQI\nHG = H+ZI\nHGC = HG*HG*HG\nHl = CH-ZI3\nH1C\u2122 H1*H1*H1\nCl = O.\nDO 3 J = 1 \u00bbNS-1\nTI = TP*C J -13 ZC NS-13\nT2 = TP*t IZCNS-im\nDT = T2-T1\nAl = DT-ZI\nA1Q = A1*A1\n\u00c01C = A1Q*A1\nA2 = HC + 3,*H*ZQI - 9*DT*ZQI + 13. *ZCI -3. *A1*C\u00c21Q-A1*H~HQ3 A3 = H1C + 3. *H*ZQI + 19. *ZCI\nBI = DT+ZI\nBiQ- BI *B1\nB1C= BlOBl\nBB = HC * 3. \u00abH*ZQI - 9. *DT*ZQI - 15. *ZCI - 3. *81 BIQ-Bl*H-HQ2 B3 \u00ab HGC + 3. *H*ZQI - IQ.mZCI\nEl = DEXPC\u2014Z*T23\nES = DEXPCZ*DTT*ZI\nE3 \u00ab DEXPC-Z\u00abT12>\nE4 = -DEXPC-Z*DTJ *ZI\nQ1 = E1*CE2\u00abCA1C + 3. *DT\u00abZQI - 5. \u00abZCIi\u00ed + C12>\nQS = E1\u00abCE2mAB -A3MZIJ\n03 = E3\u00abCE4\u00abBS +B3*ZID\nQ4 = E3*C E4\u00abC BlC+3.*DT\u00bbZQI +5. *ZCII+C11\n5 Cl = Cl + Q1*AC J-1'1^Q3*AC .jj+Q3*AC J+\u00cd3+Q4*AC J +2D\nCl = Cl \u00abHCI\nRETL\u00cdRN\nEND\nC\nBLOCK DATA COM\nC................................-......................................\nC\tEstas variaveis servem para controle do fluxo nos c\u00e1lculos da\nC\tpress\u00e3o e gradientes para o per\u00edodo de estatica.\nc.......................................................................\nIMPLICIT REALxSCA~H.O-Z3 COMMON ZCONTROLEZlD,ICONT DATA ID.ICONT ZO>OZ END\nSUBROUTINE COEFFCN3\nC.......................................................................\nC\tCalculo dos; coef icientes para o algor it mo de Stehfest\nC..........................................-............................\nIMPLICIT REAL*8CA-H.O~Z3\nINTEGER ItMfN,ML\u00bbKtKlfK2,NH\nDI MENS! ON GC 0-203 > HC103 , VC 203\nCommonZLPLzV\u201eML\nIF CML.EQ. N3 GO TO 100\nML = N\nGC03 = 1.\nGC13 = 1.\nNH = NZ2\nDO 5 I = 2\u00bbN\n3\tGCI3 = GCI-13 * I\nHC13 = a.ZGCNH-13\nDO 10 I = 2.NH\nFT = I\nIF CI.EQ.NHD GO TO 8\nHCI3 = FI**NH*GC2*I3ZCGCNH-I3*GCI3*GCI ~133\nGO TO 10\n8 HCI3 ~ FI**NH*GC2*13ZCGC13*GCI -133\n10 CONTINUE\nSN = 2*C NH~NHZ2*23-1\nDO 50 I ~ 1 \u00bbN\nVCID = 0.\nKI = CI+13Z2\nK2 =1\nITCK2.GT. NH3 K2 = NH\nDO 40 K = KI.K2\nIFC2*K-I. EQ. 03 GO TO 37\nI FC I. EQ. JO GO TO 38\nVCI3 =\\d3 + HC K3 ZC GC I HO *GC2*K~13 3\nGO TO 40\n37\tVCI3 = VCI3 + HCK3ZCGCI-K3.3\nGO TO 40\n38\tVCI3 = VCI3 + HCK3ZGC2*K-I3\n40 CONTINUE\nVCI3 - SN* VCI3\nSN = -SN\n50 CONTINUE\n100 CONTI NUE\nRETURN\nEND\nC\tFuncoes de Bessel :::::: r\t:\nDOUBLE PRECISION FUNCTION S18ACFCX. IFAIL3\nC................................................................      ~\nc\nC\tBESSEL FUNCTION .KOCX? FROM NAG LIBRARY\nC........................................................................\nDOUBLE PRECISION X INTEGER I FAIL\nDOUBLE PRECISION SRNAME\nDOUBLE PRECISION EGAM, G, T, XBIG, XVSMAL. Y\nDOUBLE PRECISION DLOG, DEXP, DSORT\nDATA SRNAME Z8H S18ACF Z\nDATA XVSMAL,EGAMZ3. 2D-9,3. 77215664Q01532861D~1Z\nDATA XBIG Z86.4D0Z\nDATA Qi , 02,03. Q4. Q5. \u2022Q6. Q7Z1.25331414D0, -0. 7832358D-1,0. 218Q568D-1 , M-0.1062446D-1,0.587872D-2.-0. 2513400-2,0. 53208D-3Z\nIF CX.LE.O.ODO? GO TO 120\nIFAIL = 0\nIF CX. LT. XBIG? GO TO 20\nY = 2.0ZX\nS1SACF \u00bb \u20acDEXPC\u201cX^ZDSQRTCXD2\u00abCai+YMCC^+Y*CQ3+Y*\u20acQ4+\u00a5*CC0+Y*CQ6+Y* *Q7??????\nGO TO 140\n20 IF CX. GT. 4. ODO? GO TO 100\nIF CX. GT. 2. ODO? GO TO 80\nIF CX.GT. l.ODO? GO TO GO\nIF CX.GT. XVSMAL? GO TO 40\nS18ACF = -CDLOGCO. 5D0*X?+EGAM?\nGO TO 140\n40 T =\nG=\nAT\u00ab<\nBT*C\nCT*C\nY=\nAT*C\nBT*C\nCT*C\nDT*C\nS18ACF = GO TO 140\n2. ODO*X*X - l.ODO\n+1.12896092945412762D+0+TX\n+4. 07157485171389048D-3+T*C'\n+4.34562671546158210D-7+T*C +7.49110736894134794D-12+T*C +2.618418792586870550-1+T*C\n+6.63513979313943827D-3+T*<\n+9. 57878493265929443D-7+T*C +1.92405264219706684D-11+T*\u00a3\n+1.05407718191360000D-1633333333 \u25a0DLOGCX?*G + Y\n-*-1.32976966478338191 D~1 +\n+5.59702338227915383D-5+\n+2.16382411824721532D-9+\n+1.9067419751466128OD-143335333\n+1,52436921799395196D-1+\n+1.09534292632401542D-4+\n+5.19906865800665633D-9+\n+6.168678869463321600-14+\n60 T - 2.ODO*X ~ 3.ODO\n\u00a5=\t+9.582100S3294896496D-1+T*C\nAT *4\t+3. 23582010649653009D-2+T*C\nBT*C +2. 24709729617770471D-3+T*C C.TX +1.8265246008934278QD-4+T*&lt;DT*C +1.6018597414Q720562D-5+Tx&lt;ET*C +1.47055796078231691D-6+T*C FT*C +1.392172702246141S3D-7+T*C GT*C +1.34790467361340101D-8+T*C HT*C +1.32069362385968867D-9+T*C\nIT\u00abC +1.37999268074442719D-1O+T*C\nJT*C +9. 74410152270679245D-12+T*C\n-1.42477910128828234D-1+\n-8.27780330331692662D-3+ -6.32678357460594866D-4+ -5.37101208898441760D-5+ -4.. 83134250336922161D-6+ -4.51017292375200017D~7+ -4.32185089841834127D-8+ -4.20597329258249948D-9+ -4. 33326665618780914D~10+\n-3.19241059198852137D-11+\n-7.83738609108569293D-12+\nKT*C +2. S7466288575820595D-12??????????????????????\nS16ACF = DEXPC-Xj\u00bbY\nGO TO 140\n80 T = X - 3. ODO\n10. ODOZC1. ODO + X 3 ~ 1. ODO\n.23688664769425422D+0+TxC\n-9,25551464765637133D-4+T*C\n-6.31692398333746470D~6+T*C\n-4,16044811174114579D-8+T*&lt;+1.753393212735806030-10+T*&lt;+3. 495642932665459620-11 +T*F. +2.86481235167705907D-12+T*C +8.06328892562554880D-13+T*C\n+4, 43741979886551040D-14^3^^2)33333^35^32 DEXPC-X3 *YZDSQRTCX3\n-1.72683652385321641D~2+\n\u201c9.02553345187404564D-5+\n-7.69177622529272933D-7+\n-9.41555321137176073D-9+ -2.22829582288833265D-10+ -1.113917585726476390-11+ -7.31344482663931904D-13+ -1.28108310826991616D-13+\nY= +6.97\nAT*C +8. 5\nBT*C +1.8\nCTxC +1.5\nDT*C +1.4\nET*C +1.3:\nFTxC +1. S\nGTxC +1.2\nHT*C +1,2;\nIT*C +1.88\nJT*C +9.11:\nKT\u00bbC +2.43\nS18ACF - ;\n<30 TO 140\n100 T =\nY=\nAT*C\nBT*Z\nCT*C\nDT*<\nET*C\nFT*C\nGT*C\nHT*C\nS18ACF = 1\nGO TO 140\n120 I FAIL = 1\nWRI TEC *, 999993SRNAME\u00bbIF Al L\n99999 FORMAT ClHO, 38HERR0R DETECTED BY NAG LIBRARY ROUTINE , AS,\nx 11H - IFAIL = . I5ZZ3\nS18ACF = O. ODO\n140 RETURN\nEND\n** END OF S18ACFTEXT\nxUPTODATE S18ADFTEXT\nDOUBLE PRECISION FUNCTION S18ADFCX, IFAIL3\nannn\nBESSEL FUNCTION K1CX3 FROM NAG LIBRARY\nDOUBLE PRECISION X\nINTEGER IFAIL\nDOUBLE PRECISION SRNAME\nDOUBLE PRECISION G, T. XBIG. XSEST. XSMALL. Y\nDOUBLE PRECISION DLOG. DEXP, DSQRT\nDATA SRNAME z8H S18ADF Z\nDATA XSMALL Z7.9D-10Z\nDATA XBIG.XSEST Z86.4DO.3. 9D-39Z\nDATA QI . 02,03. Q4,05.06,07Z1.2533141400,0.23498619D0,-0.3655620D-1, xO.1504268D-1,-0.7803530-2,0. 325614D-2.-0. 68245D-3Z\nIF CX.LE. O.OD03 GO TO 120\nIF CX. LE. XSEST3 GO TO 140\nIFAIL = O\nIF CX.LT. XBIG3 GO TO 20\nY - 2. OzX\nS.18ADF = CDEXPC-XIZDEQRTCXTOMQ1+YMQ2+YMQ3+YMQ4+Y*CQ6+YMQ6+Y*\nM27TOTOTO\nGO TO ISO\n20 IF CX. GT. 4.0D03 GO TO 100\nIF CX. GT. 2.0003 GO TO 30\nIF CX. GT. 1.0D03 GO TO 60\nIF CX. GT. XSMALL3 GO TO 40\nS18ADF = I.ODOZX\nGO TO 160\n40 T - 2.000*X*X - l.ODO\n6=\t+3.31907865913352762D-1+TM\nATM +6. 716428058734986530-4+TM BTM +4. 327648236429977530-8+TM CTM +5.338882686656589440-13+TM\nY \u00bb\t+3. 51825828289325S36D-1+TM\nATM +1.20333585658219028D-3+TM BTM +9.966866892737815310-8+TM\nCTM +1.40917103024514301 D-l 2+TM\n+3.257259681371104950-2+\n+6.953002745482062370-6+\n+1.797847923801557520-10+\n+1.1896496243991O4OOD-15TO TO TOD\n+4.50490442966943726D-2+\n+1.44612432533006139D-3+\n+4.46828628435618679D-10+\n+3. 298810580198656000-133 TO TO TO\nS18ADF = I.ODOZX + XM DLOGC XD *G~Y3\nGO TO 160\n60 T = 2.ODO*X - 3.ODO\nY \u201c\t+1.24316387355255299D+0+TM\t-2. 71 QI0714388689413D-1 +\nATM +8.202502208606938880-2+TM BTM +8. 57388087067410089D-3+TM CTM +9. 34594154387642940D-4+TM DTM +1.029827467000607300-4+TM ETM +1.13930169202553526D-5+TM FTM +1.262635783319419230-6+TM GTM +1.401383319851835O9D-7+TM HTM +1.54456653\u00d50S012693D-8+TM ITM +1.82808381381205361D-9+TM JTM +1.280440239499462570-10+TM KTM +4. 274043305687672420-11 +\n-2.62545818729427417D-2+ -2.82450787841655931D-3+ -3.10007681013626626D-4+ -3.42424912211942134D-5+ -3.792276988211429080-6+ -4.205071523389349560-7+ -4.6692891Bl68020101D-8+ -5.13783508140332214D-9+ -6.158114168988950860-10+ -4. 02591066627023831D-l1 +\nL.TM -1.4663Q29178\u00a3948454D\u201c1133333333333333333333333\nS18ADF = DEXPC-X3M\nGO TO 160\nBOTOX - 3.ODO\nY= +8.066634801287869030-1+TM\nATM +4.58591S28414023064D-2+TM\nBTM +4. 55865751206724687D-3+TM\nCTM +4. 867071747786636520-4 +TM\nDTM +3. 28712919123131781D-5+TM\nETM +3. 806923118422967240-6+TM\nFTM +6. 403818140373982740-7+TM\nGTM +7,087233666965698800-8+TM\nHTM +7.79421651144832709D-9+TM\nITM +9, 20781685906110546D-10+TM\nJTM +6. 44913423545894175D-11+TM\nKTM +2.14736751063133220D-11+\n-1.60052611291327173D-1+\n-1.423631366844236460-2+\n-1.481854720326885230-3+\n-1.59994873621599146D-4+\n-1,750895943540799440-5+\n-1.Q2794586996432593D-6+\n-2.129692293463103430-7+\n-2.338556184610232650-8+\n-2.5Q0393\u00d59308009059D-9+ -3.09667392343243062D-10+ -2.02680401514733862D-11+\nLTM -7.36478297050421658D-1233333333333333333333333\nE18ADF = DEXPC-X3M\nGO TO ISO\n100 T = 10. ODOZCl. 0D0+X3 ~ 1. ODO\nY =\t+1.30387573604230402D+0+T*C\nAT*C +4. 3.163S434283445364D-3+T*C BT*C +4. 04720631528493020D-5+TMC CT*C +4,07563856931843484D~7+T\u00abC DT*C +3. 82717692121438315D-9+T*C ET*C +6,9707537911773137QD-\u00cd2+T*C FT*C -3. 60774502020271104D-12+T*C GT*C -2. 19287104441802732D-13+T*C\n+3.44845254318331612D-2+\n-4.29373370898766831D-4+\n+4. 32776409784235211D-6+\n+4.86651420008153956D-8+ +6.77688943857588882D-1O+ +1.72026097285930936D-11+ +8.58211523713560576D-13+ +1.39321122940600320D-13+\nHT*C -4. 77850238111380160D-143333333333333333\nS18ADF = DEXPC-X3*Y/DSQRTCX3\nGO TO 160\n120 IFAIL = 1\nWRI TEC *L999983 SRNAME,IFAIL\n99998 FORMAT Cl HO, 38HERROR DETECTED BY NAG LIBRARY ROUTINE > A8, * 11H - IFAIL = , IS/Z3\nS18ADF = 0.000\nGO TO 160\n140 IFAIL = 2\nWRITEC *,999983 SRNAME, IF Al L\n99997 FORMAT ClHO, 38HERR0R DETECTED BY NAG LIBRARY ROUTINE , A8, * UH - IFAIL = \u00bb I5ZZ)\nS18ADF = l.ODO/XSEST\n160 RETURN\nEND\nEND OF S18ADFTEXT\nSUBROUTINE MRQMINCX.Y,SIG,NDATA,A,MA,LISTA,MFIT.\nm\tCOVAR,ALPHA,NCA,CHISQ,FUNCS,ALAMDA,MPER3\nuuu\nEsta rotina executa a regress\u00e3o nao linear\nIMPLICIT REAL*8CA-H.O-ZO\nEXTERNAL FUNCS\nPARAMETER CMMAX=203\nDI MENSI ON XC NDATA3 , YC NDATA3 , SI GC NDATA3 , AC MA3 , LI STAC MAO ,\nM COVARCNCA,NCAO,ALPHACNCA,NCA3,ATRYCMMAXO,BETACMMAXO,DACMMAX3 IFCALAMDA. LT. O. 3THEN\nKK\u00abMFIT+1\nDO 12 J=1 , MA\nIHIT=O\nDO 11 K=1,MFIT\nI FC LI STAC KO . EQ. JO I HI T=I HI T+l\n11\tCONTINUE\nIF CI HIT. EQ. 03 THEN\nLISTACKK3 =J\nKK=KK+1\nELSE IF CIHIT. GT. 13 THEN\nPAUSE \u2019Improper permutation in LISTA\u2019 ENDIF\n12\tCONTINUE\nIF CKK. NE. CMA-s-103 PAUSE \u2019Improper permutation in LISTA\u2019 ALAMDA=O. 001\nCALL MRO\u00c7OFC X \u00bb Y(SIG,NDATA,A,MA.LISTA, MFT T\u00bbALPHAtBETA\u00bbNCA, CHI SQ\u00bbF \u00abUNCS\u00bb MPER2?\nOCHISQ\u2014CHISQ\nDO 13 J-l.MA\nATRYC J2)=AC JD\n13\tCONTINUE\nENDIF\nDO 15 J=1\u00bbMFIT\nDO 14 K-l\u00bbMFIT\nCOVARCJ,Kl=ALPHACJ.Kl\n14\tCONTINUE\nCOVARCJ,JI-ALPHACJ,\u00abC1. +ALAMDA1\nDACJ1 =BETACJ?\n13 CONTINUE\nCALL GAUSSJCCOVAR, MFIT\u00bb NCA\u00bb DA\u00bb 1 \u00bb12) IFCALAMDA. EG. O- 1THEN\nCALL COVSRTC COVAR\u00bbNCA, MA\u00bbLI STA, MFI TO\nRETURN\nENDIF\nDO 16 J=1,MFIT\nATRYC LI ST AC JI 2> -AC LI STAC J1 1 +DAC J1\n16\tCONTINUE\nCALL MRQCOFCX\u00bbY,SIG,NDATA,ATRY\u00bbMA\u00bbLISTA,MFIT.COVAR,DA,NCA.CHISQ\u00bbFU \u00abNCS.MPER1\nIFC CHISQ. LT. OCHISQ1THEN\nALAMDA=O. 1*ALANDA\nOCHISQ\u2014CHISQ\nDO 18 J~1 , MFIT\nDO 17 K=1 \u00bbMFIT ALPHAC J ,Kl =COVARC J , Kl\n17\tCONTINUE\nBETACJ1 =D\u00c0CJ2?\nAC LI STAC J12) =ATRYC LI STAC J2) 2)\n18\tCONTINUE\nELSE\nALAMDA-10. XALAMDA\nCHISQ=OCHISQ\nENDIF\nRETURN\nEND\nSUBROUTINE MRQCOFCX, Y,SIG,NDATA\u00bbA\u00bb MA\u00bb LISTA\u00bb MFIT, ALPHA,BETA,NALP\u00bb \u00abCHI SQ. FUNCS, MPER2)\nEsta rotina executa a regress\u00e3o nao linear\nq n o\nIMPLICIT REAL\u00ab8CA-H,0-ZD\nEXTERNAL FUNCS\nPARAMETER CMMAX=BO2)\nDI MENSI ON XC NDATAl , YC NDATA1 , SI GC NDATA1 \u00bb ALPHAC NALP, NALP1 , BET\u00c1C MA1 , \u00ab DYDACMMAX1 .LISTACMFIT1 , ACMA1\nDO 1\u00a3 J=1, MFIT\nDO 11 K=1,J\nALPHACJ,Kl =0.\n11\tCONTIHUE\nBETACJJ=O.\n12\tCONTINUE\nCHI\u00a3Q=O.\nDO 13 I=1>NDATA\nCALL FUNCSCIkZCI),A.YMOD.DYDA.MA.MPER)\n\u00a31021=1. ZCSIGCI)*\u00a3IOCI))\nDY=YCI)~YMOD\nDO 14 J=1 \u00bbMFIT\nWT=DYDAC LI STAC J) )*SI G2I\nDO 13 K-L.J\nALPHAC J , K3 =ALPHAC J t K) +WT\u00bbDYDAC LI STAC IO 3\n13\tCONTINUE\nBETACJ? =BETAC J) +DY*WT\n14\tCONTINUE\nCHISO=CHISQ+DY*DY*SI021\n13 CONTINUE\nDO 17 J=2.MFIT\nDO 13 K=1 ,J-l\nALPHAC KJ) =ALPHAC J , IO\n16\tCONTINUE\n17\tCONTINUE\nRETURN\nEND\nSUBROUTINE OAUSSJCA,N.NP.B.M,MP)\nC.....................................- ................................\nC Esta rotina executa a regress\u00e3o nao linear\nC. . .................-...............-.................................\nIMPLICIT REAL\u00ab8CA-H.O-Z)\nPARAMETER CNMAX=50J\nDIMENSION ACNP\u00bb NP) , BCNP\u00bb MP) r IPIVCNMAX) * INDXRCNMAX) , INDXCC NMAX)\nDO 11 J-l.N\nI PIVCJ)=o\n11\tCONTINUE\nDO 22 I =1 ,H\nBI 0=0.\nDO 13 J=1,N\n\u201c~I FC I PI VC J) . NE. 1) THEN\nFy) 1 p Z\u20141 N\nIF CIPIVCK). EQ. 0) THEN\nIF CDABSCACJtK)).GE.BIG)THEN\nBI O=DABSC AC J , IO )\nIROW=J\nICOL=fC\nENDIF\nELSE IF CIPIVCK) . OT. 1) THEN\nPAUSE \u2019Singular nsatrix\u2019\nENDIF\n12\tCONTINUE\nENDIF\n13\tCONTINUE\nI PI VC I COL) =1 PI VC I COL) +1\nIF CIROW.NE.ICOL) THEN\nDO 14 L=1,N\nDUM=ACIROW,LD\nAC I ROWf LD - AC I COL, LD\nAC I COL, LD =DUM\n14\tCONTINUE\nDO IS L=1,M\nDUM-BCIROW,LD\nBCIROW,LD -BCICOL,LD\nBCICOL.LD=DUM\n15\tCONTINUE\nENDIF\nI NDXRC I D=I ROW\nI NDXCC I D=I COL\nIF C AC I COL, I COLD. EQ. O. D PAUSE \u2019Singular matrix.\u2019\nPI VINV-1, ZAC I COL. I COLD\nAC ICOL,ICOLD=1.\nDO IS L=1,N\nACI COL, LD =AC I COL, LD *PI VI NV\nIS\tCONTINUE\nDO 17 L-l.M\nBCICOL,LD =BCICOL,LD*PIVINV\n17\tCONTINUE\nDO El LL-i,N\nIFCLL. NE. I COLD THEN\nDUM=ACLL,ICOLD\nAC LL, I COLD-0.\nDO 18 L=1,N\nAC LL,LD =AC LL,LD-ACICOL,LD *DUM\n18\tCONTINUE\nDO 10 L=1.M\nBCLL >LD =BCLL,LD-BCICOL,LD *DUM\n19\tCONTINUE\nENDIF\n21\tCONTINUE\n22\tCONTINUE\nDO 24 L\u00bbN,1,~i\nIFCINDXRCLD. NE. INDXCC LDDTHEN\nDO 23 K=1,N\nDUM=AC K,INDXRC LD D\nAC K, I NDXRC LD D =AC K, I NDXCC LD D\nAC X, INDXCC LD D =DUM\n23\tCONTINUE\nENDIF\n24\tCONTINUE\nRETURN\nEND SUBROUTI NE COVSRTC COVAR,NCVM, MA, LISTA,MFI ID\nC. . . .....................-.............-............................\nC Esta rotina executa a regress\u00e3o nao linear\nC......................................................................\nIMPLICIT REAL*8CA-H.O-ZD\nDIMENS!ON COVARCNCVM,NCVMD,LISTAC MFITD\nDO 12 J=1 ,MA-1\nDO 11 I=J+1 .MA\nCOVARCI,J3=0.\n11\tCONTINUE\n12\tCONTINUE\nDO 14 1=1 ,MFTT~1\nDO 13 J=I+1 ,MFIT\nI FC LI STAC JO . GT. LI STAC 133 THEN\nCOVARC LISTAC J3 ,LISTAC133=COVARCI,J3\nELSE\nCOVARC LI STAC 13 , LI STAC J 3 3 =COVARC I\u00bbJ 3\nENDIF\n13\tCONTINUE\n14\tCONTINUE\nSWAP=COVARC1,13\nDO 15 J=1, MA\nCOVARC1 , J 3 -COVARC J,J3\nCOVARCJ, J3=O.\n15\tCONTINUE\nCOVARC LI STAC13 , LISTAC133-SWAP\nDO 16 J=2,MFIT\nCOVARC LISTAC J3,LISTAC J3 3 -COVARC1,J3\nIS\tCONTINUE\nDO 18 J=2,MA\nDO 17 1=1 , J~1\nCOVARCI,J3 -COVARC J, 13\n17\tCONTINUE\n18\tCONTINUE\nRETURN\nEND\nSUBROUTINE QMBSCX.Y.A3\nC.......................................................................\nC\tEsta rotina calcula os coeficientes do B-splines com quadrados\nC\tmi ni mos\nC. ...............................................    -.......-.........\nIMPLICIT REALMS CA-H.O-Z3\nREALMS XCNX3 , YCNX3 , ACO: 33\nCOMMONZGERALZNP,NS,H\nCOMMONZVETOR2ZCCO:103\nCOMMONZVETOR3ZTC303\nCOMMONZMATRIZZBCO: 3,0: 33\nCOMMONZPONTOSZN\u00bbNDP.NX,NDE,NDX\nNP = NX\nNS = 2\nH=C XC NP3 ~XC 13 3 ZC NS~13\nDO 10 1=0,3\nDO 10 J=I,3\nCALL SOMACI,J,0,X,Y3\n10 CONTINUE\nDO 20 I=O,NS+1\nS0M=O.\nDO 30 J=1,NP\nSOM=SOM*YCJ3*BSPCI,XCJ3,X,Y3\n30\tCONTINUE\nCCI3=S0M\nao CONTINUE\nIPOS=O\nDO 40 IE=1,NS~1\nDO 50 I =1 \u00bb3\nRMULT=BC0.I>ZBCO\u00bb05\nDO 60 J=I,a\nBC I \u00bbJ3 =BC I \u00bbJ3-RMuLTxBC0, J3\n60\tCONTINUE\nCCIE+I -15 =CC IE+I -15 -RMULTxCC I E-l 5\n50\tCONTINUE\nDO 70 J=0\u00bb3\nIPOS=IPOS+1\nTCIPOS3 =BCOf J3\n70\tCONTINUE\nIF CIE .NE. NS-13 THEN\nDO 60 i=o\u00bba\nDO 80 J=I \u00bb2\nBCI \u00bbJ3=BCI*1 >J+13\n60\tCONTINUE\nDO 80 1=0\u00bb 3\nCALL SOMACI . 3, IE.X/Y5\n80\tCONTINUE\nENDIF\n40 CONTINUE\nDO 100 K=1\u00bba\nDO 100 I=K+1,3\nRMULT=BCK\u00bb13ZBC K, K3\nDO 110 J=I,3\nBCI\u00bbJ5\u00abBCI.J3 \u201d RMULT x BCK.J3\n110\tCONTINUE\nCCNS+I-23 = CCNS+I-23 ~ RMULTxCCNS+K-23\n100 CONTINUE\nAC NS+13 =CC NS+15 ZBC 3 (33\nACNS3=CCCNS> -CBC2\u00bb 33 *AC NS+13 3 3 z*BC 2,23\nACNS-13=CCCNS-13\u201cCBC1\u00bb23 \u00abAC NS3+BC1 \u00bb33 \u00abAC NS+13 3 3 ZBC1,13\nDO 120 I=CNS~23,O\u00bb~1\nIPOS=4*I +1\nSOM=O,\nDO 130 J=l\u00bb3\nSOM=SOM+TCIPOS+J3*ACI+J3\n130\tCONTINUE\nAC 13 =C CC13-SOM3/TC I PO\u00a33\n120 CONTINUE\n2ETURN\nEND\nC INICIO DAS SUBROTINAS\nSUBROUTTNE SOMACI ,J > IE\u00bb X,Y3\nC. . .....................................................................\nc\tEsta rotina calcula as coeficientes do B-splines com quadrados mi-\nC\tnimos.\nC.........................................................................\nIMPLICIT REALx-8 CA-H.O2D\nn n n o\nREALMS XCNP3.YCNP3\nCOMMON/GERAL/NP, NS, H\nCOMMON/VET0R2ZCC0: 103\nCOMMON/VET0R3/TCSCO\nCOMMON/MATPIZZBC 0:3.0:33\nSOM-O.\n\u25a10 140 K-1,NP\nIF CI, EQ. J3 THEN\nAUX=BSPCI+IE\u00bbXCK3 \u00bbX,Y3\nSOM=SOM+AUX*AUX\nELSE SOM=SOM+BSPC I +1E * XC K3\u00bbX, Y3 \u00abBSPC J+IE, XC K3 , X t Y3 ENDIF\nBCI ,.D-S0M\n140 CONTINUE\nRETURN\nEND\nC\tINICIO DA FUNCAO BSP\nREALES FUNCTION BSPCI,Z,X,Y3\nEsta retina calcula os coeficientes do B-splines com quadrados mini mos\nIMPLICIT REALMS C\u00c2-H.O-Z3\nREALMS XCNP3,YCNP3\nCOMMON/GERAL/NP,NS,H COMMON/VETOR2/CCO:103 COMMONZVETOR3/TC503\nCOMMON/MATRIZ/BC0:3,0:33\nV-C Z-XC 13 -CI -13 MH3 /H\nIF CZ , LT. XC13-H .OR. Z .GT. XCNP3+H3 THEN\nBSP-O.\nELSE\nIF CI.EQ. NS3 THEN\nIF CZ .LT. CXCNP3~a\u00bbH33 THEN\nBSP=O.\nft\n~~ IF CZ .LT. CXCNP3-H33 THEN\nBSP=RINTERVC1,V3\nELSE\nIF CZ .LT. XCNP33 THEN\nBSP=RINTERVC 2,V3\nELSE\nBSP=RINTERVC3,V3\nENDIF\nENDIF\nENDIF\nELSE\nIF CI .EQ. NS+13 THEN\nIF CZ .LT. CXCNP3-H33 THEN\nBSP=O.\nFI .SR\nIF CZ .LT. XCNP33 THEN\nBSP=RINTERVC1 , VO\nELSE\nBSP-RINTERVC2. VO\nENDIF\nENDIF\nELSE\nIF CI . EQ. 05 THEM\nIF CZ .GT. CXC13+-HOO THEN\nBSP=O.\nELSE\nIF CZ .LT. XC103 THEN\nBSP-RINTERVC3. VO\nELSE BSF=RINTERVC4fVO\nENDIF\nENDIF\nELSEIF CI .EQ. 13 THEN\nIF CZ .GT. CXC10+2*H03 THEN\nBSP=O.\nELSE\nIF CZ . LT. XC100 THEN BSP^RI NTERVC 2, VO\nELSIE\nIF CZ .LT. CXC10+H0D THEN\nBSP\u2014RINTERVC 3 r VO\nELSE\nBSP=RINTERVC4, VO\nENDIF\nENDIF\nENDIF\nIF CCZ.LE.CXC13+CI~33*H3D.OR.CZ.GT.CXC13+CI+13*H333 THEN BSP=O.\nELSE\nIF CZ. LE. CXC10 +CI -23KH00 THEN BSP=RINTERVC1 , VO\nELSE\nIF CZ. LE. CXCIO-<-CI ~13*H33 THEN\nBSP-RIN TER VC 2. VO\nELSE\nIF CZ. LE.CXC1O4-IMH00 THEN B\u00a3P=RINTERVC 3,VO\nELSE\nBSP=RINTERVC4>VO\nENDIF\nENDIF\nENDIF\nENDIF\nENDIF\nENDIF\nENDIF\nENDIF\nRETURN\nEHD\nC\tFUNCAO RINTERV\nKEALM8 FUNCTION RINTERVCK.VD\nC. ......................................................................\nC\tEsta rotina calcula os coeficientes do B-splines com quadrados\nC\tnimos.\nIMPLICIT REALMS CA-H.O-ZD\nIF\tCK\t.EQ.\t13\nIF\tCK\t.EQ.\t23\nIF\tCK\t\u2022 EQ.\t35\nIF\tCK\t\u25a0 EQ.\t43\nRETURN\nRI NTERV=C V+2D MC V+2D *C V+23\nEl NTERV=1 +3*C V+l3 mC1 -V*C V+l 2> 3\nRI NTERV=1 +3*C1 -VD MC 1 +V*C 1 -VD 3\nRI NTERV=C 2-VD \u00abC 2-VD *C \u00a3~V3\nEND\nSUBROUTINE PIKSR2CN,ARR.BRRD\nC.......................................................................\nC\tEsta rotina ordena os valores obtidos na busca unidimensional\nC\tda funcao objetivo para determinar o valor inicial do Skin.\nC................. ..............................................\nIMPLICIT REAL*8CA-H.O-ZD\nDI MENSI ON ARRC ND , E3RRC ND\nDO 12 J=2,N\nA=ARRC\nB=BRRC J?\nDO 11 I =1-1,1 , -I\nIFCARRCIO. LE. AO GO TO 10\nARRCI+1D-ARRCID\nBRRCI+iJ^BRRCn\n11\tCONTINUE 1=0\n10\tARRCI+13=A BRRCI+1D=B\n12\tCONTINUE\nRETURN\nEND\nREALMS FUNCTION TINVERCNDXD\nIMPLICIT REALMS CA-H.O-ZD\nREALMS TALFAC90D\nDATA TALFA Z12.7062,4.3027,3.1824.2.7764.2.5706,4469,2.3646, m2. 3060,2. 2622,2. 2281 ,2. 2010,2. 1788,2.1604,2.1448,2.1315,2. 1199, *2.1098,2.1009,2.0930,2. 0860,2.0796,2.0739,2.0687,2.0639,2.0595, m2.0555,2.0518.2.0484,2.0452,2.0423,2. 0395,2.0369,2.0345,2.0322, M2.0301,2.0281,2.0262,2.0244,2.0227,2.0211,2.0195,2.0181,2.0167, Mg,0154,2. 0141,2.0129,2. 0117,2. 0106,2.0096,2.0086,2.0076,2.0066, m2.0057,2.0049,2.0040,2. 0032,2.0025,2.0017,2.0010,2.0003,1.9996, Ml.9990,1.9983,1.9977,1.9971,1.9966,1.9960.1.9955,1.9949,1.9944, Ml.9939,1.9935.1.9930,1.9925,1.9921.1.9917,1.9913,1.9908,1.9905, Ml.9901,1.9897,1,9893,1.9890,1.9886,1.9883,1.9879,1.9876,1.9873, Ml.9870,1.9S67Z\nUN VER = TALFACNDXD\nRETURN\nEND\nSUBROUTINE LI MPA\nWRI TEC *,10337,^7\n10 F0RMATC1X\u00bb Al > \u201d EH* ( Al > * E\nEND\nAp\u00eandice H - Programa gerador de dados de fluxo ou de um DST completo Cum ciclcD.\n\u2014 As subrotinas Coeff, S18aef . SIBadf e QMBS est&amp;o no ap\u00eandice\n6.4.\nu u\nPROGRAM GERADOR\n..Este programa gera dados de press\u00e3o de fluxo e press\u00e3o estatica ..Para o caso de Skin positivo e do Skin negativo.\nIMPLICIT REALX8CA~H,0-23\nII MEC 1003\nXC1003 . XTC 2003 ,VC 203\nZLPLZ V.ML\nZCESTZVW,CW\u00bbRF,GRAD\nZPONTOSZN ,NDP,NX.NDE,NDX\nZPVTzCT.PHI.VISC .PO,PFF,TH.RW rPI, CS,CF.PK,S,PE\nC:\nREALES\nREALMS\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nParametros para o calculo dos coeficientes de Stehfest ML - 1\nN =\t20\nC:::::Dados relativos a leitura do fluxo e estatiea:::::::::\nOPENCI,FILE = \u2019TEMPOS. DAT\u20193\n0PENC2.FILE = \u2019GERADOR. DAT\u20193\n0PENC3.FILE \u2019PVT. DAT\u20193\n0PENC4.FILE = \u2019GERA. DAT\u20193\nREADCI,23NLF\nREADCI ,43CTTMECI3.1=1 ,NLF3\nREADCI.23NLE\nREADCI.43CXCJ3,J=1,NLE3\nFORMATCI23\nFORMATCF1O. 03\nNDP = NLF\nNDE = NLE\nNX = NDP + 1\nNDX ~ NDP + Nde\n2\n4\nC\nC\nSUBROUTINE DSTPC TI ME * X, XT3\nIMPLICIT REALM8CA~H,0-23\nEXTERNAL FUNCS, Si 8 ACF, SI 8ADF,MQBS REALES REAL*\u00bb COMMON COMMON COMMON COMMON COMMON\nTC 1003 , PC 1003 , TI MEC NDP3 . AC 63\nXCNDE3 t XTC NDX3 ,VC203\nZLPLZ V.ML\nZSPLZT.P\nZRESERZCl.C2.C3\nZCESTZVW,CW.PP , GR A D\nZPONTOSZN>NDP,NX tNDE.NDX\nCOMMON ZPVTZCT,PHI,VISC,PO,PFF,TH,RW,PI,CS,CF,PK,S,PE COMMON ZPARZA\nDADOSCTTME,X,XT3\n6\n= AC 13 ZC PHIMVISCMCTMRWMRW3\n1. ZC2. MPIMPHIMTHMCTMRWMRW3 = AC33 - AC63\n\u00c0C43MCTE2\nAC53MCTE3\n= TCNX3MCTE1\n17\n19\n160\n161\nTD *.4X /\nTCH3 \u2019 ,4X, \u2019\nPD '3\nPC PSI&lt;53\nC: : ; ::Chamam~se Lodes os dados do fluxo, estatica e Pvt CVia Common3 : : : CALL NP = CTE1 CTE2 CTE3 CSD > CFD &lt;TPD\nWRITEC2,173\nFORMATCIOX,\u2019 CSD \u2019,10X,\u2019 CFD \u2019,1OX,*\nWRITEC 2,193 CSD,CFD,TPD\nFORMATC7X, Fl0. 3,6X, E15. 3, IX , E1S. 33\nWRI TECS, 1603\nFORMATCZ,21X>\u2019\nWRI TEC4,1613\nFORMATCZ, 21X , \u2019\nDO 35 I = 1, NDX\nCALL FUNCSCI,XLCI3,A,DPWS,NP,23\nTD = XTCI3MCTE1\nPD = CAC33-DPWS3ZCTE3\nW\u00a3ITEC2,113 TD,PD\nIFCI. EQ. 13LHEN\nWRITEC4,m3 \u2019\nENDIF\nIFCI.EQ. NX3 THEN\nWRI TEC 4, m3 \u2019\nENDIF\nIFCI. GT. NDP3THEN\nWRITEC4,113CCXTCI33Z36OO. 3 . DPWS*14. 7\nELSE\nWRITEC4,113CXTCI3Z36OO. 3 ,DPWS*14. 7\nENDIF\nCONTINUE\nFORMATC15X. 2F13. 43\nRETURN\nEND\nC:::::Transformacao de todos os dados de Entrada\nSUBROUTINE DADOSCTTME, X ,XT3\nIMPLICIT REALmSCA~H,0-Z3\nREALMS TTMEC NDP3 , TC1003 , PC 1003 , AC 63\nREALMS XCNDE3 , XTCNDX3 , VC203\nCOMMONZPARZ A\nCOMMONzLPLzV,ML\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nCOMMON\nC:::::Calculo dos parametros auxiliares PI e CPA\nPI = 4. mDATANC1. DO3\nDADOS\nDADOS\nDO\nDA\nTPD *3\nFLUXO\u2019\nESTATICA \u2019\npara unidades Darcy: : :\nZSPLZT,P\nZRESERZCI,C2,C3\nZCESTZVW,CW,RP,GRAD\n/PONTOSZN,NDP , NX tNDE , NDX\nZPVTZCT,PHI,VISC,PO,PFF,TH,RW,PI,CS.CF,PK*S.PE\nCPA= 1. Z14. 7\nC: ; : : : Outras dadosCUnidades Americanas e S::\t:\nC: : : : : Ct\u00bb CwC Psi -13 ; Th, Pp t FpCrrO ; RwC pal 3 ; CdpC m3Zm33 ; DoC 3 , Phi C deal mal D : : : : : : C: : : : : Po,PeCPs\u00cdg3:\t: : : : : : : : :::::::::::::: : :::::::: : : : : : : : : ;\nREADC3t63CT\nREADC3>63PHI\nRE ADC 3163 VI SC\nREADC3,63TH\nREADC3.63RW\nREADC3.63PP\nREADC3.63FP\nREADC3.63CW\nREADC 3.63 CDP\nREADC3.63DO\nREADC3.63PK\nREADC3>63S\nREADC3.63PO\nREADC3.63PE\na FORMATCF25.03\nC: : : : : Transformacao dados fluido e reservat\u00f3rio para o sistema DARCY: : :\nRP = DSC32TCCDPZPI3M\u00cdOO.\nGRAD=DO\u00abO. 000966397\nAC 33 = CPI*RP*RP3ZGRAD\nCW = CW*14.7\nRW = RW*2. 54\nW = PI\u00abRW*RWmCFF-PP3*100.\nAC 43 = CW*VW\nCT = CTM4.7\nPO = P0*CPA\nPE = PE*CPA\nTH = THMOO.\nAC13-PK\nAC S3=S\nAC33=FE\nAC 63 =PO\nC: : : : : Calculo dos parametros auxiliares Cl ,C2 e C3:\nCE = a. *PlwTH/VISC\nC3 = DL.O0C2. D03\nC: : : : :Impress\u00e3o dos parametros: ::::::::::: : :::::::: ::::::::::::: : : :::::: :\nWRITEC2.1203\n120 FORMATCZt2SXDADOS FIXADOS \u2019 . Z> 3X * \u2019 CTC1ZATM3 \u2019 , 2X, \u2019 COC1Z\u00c0TM3 \u2019 t\n\u00ab3X\u00bb\u2018POROSIDADE\u2019 >3X( 'VISCCCP3 \u2019 ,3Xh \u2018THCCM3 \u00bb \u00bb5X\u00bb \u2018RWCCM3\u20183\nWRITEC 2.1403 CT.CW .PHI,VISC,TH.RW\n140 FORMATCIX,E10.3t4XtE8.3.3X.F8,3,6X>F6.3.3X,F8.2,3X\u00bbF8.3,Z3\nWRI TEC 2 * 1503\n150\tFORMATC25X,\u2019DADOS DO RESERVAT\u00d3RIO *3\nWRI TEC2,1353\n155 F0RMATC10X, \u2019 PERM. CDARCY3 \u2018 ,13X\u00bb \u2019SKIN\u2019 ,10X. \u2018P. ESTATICAC \u00c0TM3 \u2019 3\nWRITEC2,1583 AC 13 >AC23 , AC 33\nWRI TEC2t 1573\n157\tFORMATC11X\u00bb\u2018CS CCM3ZATM3\u2019>9X,\u2018CF CCM3ZATM3\u2019\u201e8X.\u2019POCATM3\u20193\nWRI TEC 2,1583 AC 43 \u00bbAC53 , AC 63\n158\tFORMATC7X, FIO. 3,14Xf FIO. 3,6X, FIO. 3, Z3\nC: : :\n10\n17\nC: : : :\n8\n11\n30\nC\nWRITEC4.1205\nWRI TEC 4.1405 CT. CW, PHI, VI EC, TH\u00bbRW\nWRITEC4,1SO5\nWRITEC4*1555\nWRITEC4>1585AC15 >AC25 , AC35\nWRI TEC 4,1575\nWRITEC 4.1385 AC 45 ( AC 55 , AC 65\n: Transformaeao do Tempo e pressao para unidades Darcy::::::::::::::: TC15 = 0.\nPC15 = Po\nDO 10 I =1,NDP\nK =1+1\nTCK5 = TIMECI5*3600.\nXTCI5 = TCK5\nDO 17 K = NX\u00bbNDX\nIE = K-NDP\nXTCK5 =\tXCIE5*3600. + TCNX5\nRETURN\nEND\nSUBROUTINE FUNCSCKF,XI>A\u00bbDrWF,NP,MPER5\nImplicit real*8Ca-h,o~z5\nReal*8 TC 505 \u00bbPC 505\nDi mens! on AC NpD * VC 205\nExternal Coeff\nCommon zLplZV,Ml\nCommon ZSpl ZT.P\nCommon ZReserZCltC2*C3\nCommon zControleZld.Icont\nCommon ZPbntosZN,Ndp,Nx,Nde\u00bbNdx\nCommon ZDer1/Gama.Alfa\u00bbAuxl2.Auxl3 * Auxl4 * Aux2O\nSave zControleZ,/DeriZ\n:Calculo da funcao com inversao de laplaee::::::::::::::::::::::::::\nIfCKf. LE. NdpDThen\nCALL FLUXOCKf tXl . A.DPWLNPD\nReturn\nEndif\nAl = C3ZX1\nIfCMl. Eq. N3Go to 9\nCALL COEFFCN5\nIfCId.Eq. 15 Go to 11\nCALL CONSTCNP,A5\nConti nue\nSumr = 0.\nDo 30 J = 1.N\nZ = J * Al\nY = DsqrtCZl\nXs = Y* Alfa\nCALL PDESTATICACA,NP,XS>ZiPLAP5\nSumr ~ Sumr + VCJ5*Plap\nDpwf = Sumr* Al\nWriteC*t*5CXlZ3600, 5 ,Dpwf*14. 7\nIfCKf. Eq. Ndx5Then\nId = 0\nIcant = O\nReturn\nEndif\nEnd\nSUBROUTINE CONSTCNP.AD\nImplicit Real*\u00ae Ca-h.o-z)\nDimension ACNpD\nCommon zReserZC1.C2.C3\nCommon ZDer i ZGama. Al f a,Auxl2,Auxl3,Auxl4,Aux20\nCommon ZPvtZCt.Phi,Visc.Po.Pff,Th,Rw,PI ,0s,Of.Pk,S,Pe Save ZDeriZ\nGama = DsqrtCAClDD\nIfCACSD. Lt. OD Then\nRwa\t= Rw*DexpC-AC 23'J\nCl\t= DsqrtCPhi*Visc*CtMRwaKRwaD\nElse\n01\t= DsqrtCPhi*Visc*Ct*RwMRwD\nEndif\nAlfa ~ ClzGama\nCte = 1.ZCC2 * AC1DD\nAuxl 2 \u00ab CAC4DD* Cte\nAuxl 3 - C AC 5D 3* Cte\nAuxl4 = Auxl3-Auxl2\nAuxSO = ~ Auxl 4ZAC13\nReturn\nEnd\nSUBROUTINE PDFLUXOCZE. CID\nImplicit real*8Ca~h.o~zD\nExternal Q mbs, Cinteg\nDimension FC503 , PC503 , AsCO: 103\nCommon ZSplZT,P\nCommon ZControleZld.Icont\nSave /Controle/, As\nIfCId. Eq. ID Go to 45\nCALL QM8SCT.P.ASD\nId = 1\n45 CALL CI NTEGC ZE. CI . T, ASD\nReturn\nEnd\nSUBROUTINE PDESTATICAC A. NP. XS.Z.PLAPRD\nImplicit Real*8Ca-h. o-zD\nReal *8 AC NpD , TC SOD , PC 50D\nCommon ZSplzT,P\nCommon /ReserZC1.C2.C3\nCommon ZPontoaZN.Ndp>Nx,Nde,Ndx\nCommon ZDeri ZGama.Alfa.Auxl2,Auxl3.Auxl4\u00bb Aux20\nCommon ZPvtZCt.Phi\u201eVi sc.Po.Pff. Th\u00bb Rw\u00bbPI,Cs,Cf.Pk.S,Pe\nCALL PDFLUXiXZ.Cn\nBkO = SIBACFCXs.IFAILD\nBkl = SIBADFCXs . IFAILD\nB = BkOzBkl\nZ\u00ed = l.zZ\nAuxlQ = BzXs\nIfC\u00c0C23. Lt. 03 Then\n\u00c0uxll = l.ZAuxiO\nElse\n\u00c0uxll = l.ZCAuxlO + AC233\nEndif\nAuxlS = Pf f*DexpC -TC Nx3*Z3\n\u00c2UX16 = C AC 33 *Z\u00cd 3 *\u00c1uxl 1 - Auxl4*CZ*CI + Auxl53 + AC63*Auxl3\nAuxl7 = \u00c0uxll + ZxAuxlS\nAuxl 71 = 1, ZAuxl 7\nFlapr = Auxl6*Auxl71\nReturn\nEnd\nC\nSUBROUTINE FLUXOCKf *X1 , A*DPWF,NP3\nI mpl i c\u00edt real *8C a~h \u00bb o~z3\nExternai Coeff *S18acf ,S18adf\nDl mens!on AC Np3 s VC \u00a303\nEM mens!on TC 503,PC 503\nCommon zSplzT*P\nCommon zLplzV*Ml\nCommon ZReserZCl,C2.C3\nCommon ZPontosZN,Ndp,Nx*Nde *Ndx\nCommon ZPvtzCt,Phi,Vise*Po* Pff,Th*RwtPI,Cs,Cf *Pk,S,Pe\nC.....Calculo da funcao com invers\u00e3o de laplaee............................\nGama = DsqrtCAC133\nXfCAC23 . Lt. 03 Then\nRwa \u25a0= Rw*DexpC \u201cAC233\nCl = DsqrtCPhi \u00abVI sc*Ct*Rwa\u00bbRwa3\nElse\nCl = DsqrtCPhi \u00abVi sc*Ct*fRw*Rw3\nEnd! f\nAlfa = ClzGama\nAux4 = C\u00a3*AC1 JZAC53\nAl = C3ZX1\nIfCMl. Eq.N3Go to 11\nCALL C0EFFCN3\n11\tConti nue\nSumr = 0.\nDo 30 j = 1 * N\nZ = J * Al\nY = DsqrtCZ3\nXs = Y* Alfa\nBkO = SlBACFCXs * IFAIL3\nBkl = SlBADFCXs * XFAIL3\nZi = 1.ZZ\nAux5 = Bk OZBk1\nIfC\u00c0C23 . Lt. 03 Then\nAuxl = AuxSzXs\nEl se\nAuxl ~ AuxSzXs + AC 23\n30\nC\nc\nEndif\nAuxB = Aux4*AC33*Zi\nAux3 - AC63*Auxl + Aux2\nAux6 = 1.-Aux5*Aux5\nAux7 = Aux\u00d4ZCS. *AC133\nAux8 = Z*Auxl +\u25a0 Aux4\nAuxBi = 1. ZAuxB\nAux8qi= Aux\u00d5i*Aux8i\nPressa = Aux3*Aux8i\nSumr = Sumr + VCJ3*Pressa\nDpwf = Sumr* Al\nK = Kf + 1\nPC 50 = Dpwf\nIfCKf.Eq.Ndp3 Then\nPff = Dpwf\nEndif\nWr i teC *, *3 C XIZ3600. 3 fPCk3*14. 7\nReturn\nEnd\nSUBROUTINE CINTEGCZ,CI , X. A3\nImplicit real*8 Ca\u201ch,O\"z3\nRealMB XCNx3 , ACO: 103\nCommonZVetor2/CC0:103\nCommon/'Ger alZNp * Ns. H\nCommon ZPontosZN,Ndp f Nx,Nde\u201eNdx\nTp = XCNP3\nHq = H*H\nHe = H*H*H\nHci ~ 1./He\nZi = l.ZZ\nZq = 2>Z\nZqi = l./Zq\nZe = Zq*Z\nZci = l.ZZc\nCi = 6,*Zqi*Zqi\nHg = H+Zi\nHge = Hg*Hg*Hg\nHl = CH-Z\u00cd3\nHle= H1*H1*H1\nCi = O.\nTl = O\nIB = Tp\nDt = T2-T1\nAl = Dt-Zi\nAiq = Al*Al\nAl c -Al q*Al\nA3 = He + 3. *H*Zqi ~ 9*Dt*Zqi + 15. *Zci -3. *A1 *C Alq-Ai\nA3 = Hie + 3. *H*Zqi + 19. xZci\nBi = Dt+Zi\nBlq= Bl \u00ab81\nBlc = Biq*Bl\nB2 = He + 3.*H*Zqi - 9. *Dt*Zqi - 15. *Zei - 3. *Bl*CBlq\u201cBl*H-Hq3\n1 Bl\nB3 = Hgc + 3.*H*Zqi ~ 19. *Zci\nEl = DexpC-ZWT2?\nE2 = DexpCZ*DO*Zi\nE3 = DexpC-Z*Tl?\nE4 = ~DexpC-Z*DtO*Zi\nQI = El*CE2\u00bbCAle + 3. *Dt*Zqi - 5. *Zei? + Cl?\n02 - \u00a31*CE2*A2 ~A3*Zi?\n03 = E3*CE4*B2 +B3MZ13\n04 E3*CE4*CBle+3. *eDt*Zqi+S. MZci?+Cl?\nCI = CI + QI *AC 0? +Q2\u00bbAC 1 ? +Q3*AC 2? +Q4*AC 3?\nCI = ClwHci\nReturn\nEnd\nBLOCK DATA COM\nImplicit Reales ia-h,o-z)\nCommon zControlezId,leont\nData I d (Icont ZO,Oz\nEnd\nAp\u00eandice I - Otimiza\u00e7\u00e3o em um ciclo completo de um DST para calcular k, S, p e p. atrav\u00e9s de diferen\u00e7as finitas.\nO\tt\n- As entradas de dados de campo para an\u00e1lise neste programa \u00e9 id\u00eantica ao programa Auto do ap\u00eandice 0.4 cujo exemplo \u00e9;\n41\tnumero de pontos do fluxo\n.0000,86\n. 005,106. 86783\ntempo e press\u00e3o lidos\n.470,574.68563\n. 500,588. 88144\n66\tnumero de pontos da estatica\n.005,687. 64880\ntempo e press\u00e3o lidos\n8. 140,877.30984\t\n3, 189,877.59765 1.\tM ~ const, calib. em psigZpol,\n0.\tA ~ const, calib. em psig.\n1.\tk = const, do relogio em hZpol\nIO. 2D\u201406\tCt= compress, total em lZpsig\n0. 063\tPhi = porosidade O\n60.\tVise = viscosidade em cp\n11.5834\tTh =\u25a0 espessura em m\n4.348\tRw = rs\u00edLa do poco em pai.\n810. 39\tpp = prof, packer em m.\n822. 61\tFP - prof, poco em m.\n6. 0E-06\tCw = compres, fluido em lZpsig\n0.007417323\tCdp = capacidade do tubo m3Zm3\n0. 90042954\tDo \u00ab densidade fluido Cagua=l\nPROGRAM FINITA\n\nESTE PROGRAMA PRINCIPAL ABRE 0S ARQUIVOS DE ENTRADA E SAIDA, DEFINE.\nC OS VETORES DE TRABALHO E LE ARQUIVO DE DADOS DO FLUXO + ESTATICA, . C E CHAMA AS ROTINAS AUXILIARES DE OTTMIZACAO.\nC ESTA VERS\u00c3O CONSIDERA O CASO DO SKIN POSITIVO E/OU NEGATIVO.\nC.......................................................................\nIMPLICIT REALm8CA~H,O-Z>\nRE\u00c0L*8 TI MEC 1003 ,PWFC1003\nR\u2019EAL*8 XC1003 , PWSC1003 , XTC \u00a3003 . DPWEC 2003\nCHARACTER**3\u00d5 DADOS\nCOMMON /CESTzVW,CW,RP,GRAD\nCOMMON ZPONTOSZN,NDP,NX,NDE.NDX\nCOMMON ZPVTZCT,PHI, VTSC,PO,PFF,TH,RW,PI,CS,CF,PK,S,PE\nC: : : : Arquivos de entrada e sa\u00edda de dados\nCALL LIMPA\nWRITEC*, *CA\u20193 * ENTRE NOME DO ARQUIVO DE DADOS PRESS\u00c3O E PVT: \u2018 READC *,\u2019 C BN,A303\u20193DADOS\nIFCDADOS.EQ. * \u20193DADOS = \u2019DADOS*\nOPENCl.FILE = DADOS,STATUS = \u2019OLD\u20183 OPENC2,FILE = \u2019 GERADO. DAT\u20193\nOPENC3.FILE = \u2019FINITA. DAT\u20193\nC; : : : Dados relativos a leitura do fluxo e estatica\nREADC 1,103NLFF\nREADC1,203 TEMPO,PO\nNLF = NLFF -1\nREADC1,203CTIMECI3 , PWFCI3,1=1 , NLF3\nREADC1,103NLE\nIFCNLE. EQ. 03 GO TO 3\nREADC1,2O3CXCJ3,PWSCJ3,J=1,NLE3\n10 FORMATCI23\n20\tF0RMATC2F15. 03\n3\tREADC1 ,303 CCM\nREADC1,303CGA\nREADC1,303CR\n30 F0RMATCF15. 03\nPO = POMCCM + CCA\nDO 15 I = 1,NLF\nTIMECI3 = TI MEC II \u00abCR\n15 PWFCI3 = PWFCI3\u00abCCM + CCA\nDO 25 I = 1 ,NLE\nXCI3 = XCI3MCR\n25\tPWSCI3-PWSCI 3\u00abCCM + CCA\nNDP = NLF\nNDE = NLE\nNX = NDP + 1\nNDX = NDP + NDE\nC\nCALL DSTPCTIME,PWF,X.PWS,XT,DPWE3\nCLOSEC13\nCLOSEC23\nCLOSEC33\nEND\nC\nSUBROUTINE DSTPCU ME, PWF, X, PWS, XT, DPWE3\nU'JUU\nEST\u00c1 SUBROTTNA PASSA TODOS OS DADOS DE ENTRADA PARA O SISTEMA CGS. CALCULA OS PARAMETROS INICIAIS A SER USADO DURANTE A OTIMIZACAO\nIMPLICIT REAL*8C A-H. O-ZD\nEXTERNAL PIKSR2\nDIMENSION SWC 503, CHIC 603\nDIMENSION AC63\nREALMS TC1\u00d503 , PC 1003 . IT MEC1003 ,PWFC 1003 , VC 203\nREALES X C1003,PWSC1003.DPWEC2003,XTC 2003\nREAL FC\u00a3003 \u00bbXJACC\u00a300,43,X JTJC103,WORKC5123,EPS,DELTA,SSQ,XIC63\nCOMMON ZSPLzT.P\nCOMMON ZLPLZV.ML\nCOMMON ZRESERZCI.C2,C3\nCOMMON ZFATORZFATORK,FATORP\nCOMMON ZCESTZVW.CW.RP.GRAD\nCOMMON ZPONTOSZN,NDP,NX,NDE.NDX\nCOMMON ZPVTZCT.PHI, VISC, PO, PFF. TH. RW, PI,CS.CF,PK,S,PE\nCOMMON ZVAZA\nSAVE ZVAZ\nC:::: Chamam-se todos os dados do fluxo, estatica e Pvt CVia Common3 : :\nCALL DADOSCTIME, PWF, X. PWS, XT, DPWE3\nC: : : : Estima-se pelo m\u00e9todo cartesiano K e Pi como valores iniciais : : : CAP = PIMRPMRP\nJ - NDX ~ 5\nDT = TCNX3MC1. ZXTCNDX3-1. ZXTCJ33\nDP \u00ab CDPWECNDX3-DPWECJ33M14.7\nDC = -DPZDT\nDPF= CPWFCNDP3-PWFC133\nDH = DPFZGRAD\nDV \u00bb DHMCAP\nDTF= CTIMECNDP3\u201cTIMEC133ZS6400.\nGW = DVM6. 29D-O6ZDTF\nPKC= 2.151888*QW*VISCzC DCMTH3\nFC1 ~ TCNX3ZXTCNDX3\nPEI = DPWECNDX3*1 4. 7 + DCmFCI\nPEI = PEIZ14.7\nWRI TEC M, M3 PKC, PEI\nC: ::: Busea unidimens!onal para definir o valor do skin :::::::::::::::\nAC13 = PKC\nAC 33 = PEI\nAC 43 \u00ab CS\nAC 53 = CF\nAC 63 = PO\nSWMAX = 5.\nSWMIN = \"5.\nDSW = SWMAX-SWMIN\nMB = 50\nDO 20 I = 1.NB+1\nSWCI3 = SWMIN + DSWMCI-13ZNB\nAC23 = SWCI3\nSUMF = 0.\nDO 30 KF = 1,NDP\nCALL FLUX OC ITMEC KFD.A.DP WF \u201eNPD\nRES = PWFCKFD-DPWF\n30 SUMP = SUMF + RES*RES\n20 CHICID = SUMF\nCALL PIKSR2CNB.CHI . SWD\nS = SWC1D\nWRITEC*t*D > VALOR DO SKIN QUASE OTIMO = f,S\nC: : : : Priineira RegressaoCSomente no fluxoD para determinar K,S e Po : : ACID = PKC\nAC2D = S\nAC 3D = PEI\nACAD = CS\nAC3D - CF\nAC6D = PO\nNP = 3\nX1C1D = SNGLC ACID *1000. D\nIfCXiClD. LT. C1000.D. AND. X1C1D. GT. C100.DD THEN\nFATORK =100.\nELSE\nFATORK = 1000.\nENDIF\nIFCX1C1D. LT. C100. DD THEN\nFATORK =10.\nENDIF\nX1C2D = SNGLCAC2DD\nX1C3D = SNGLC AC 3D *14. 71\nIFCX1C3D . LT. CIOOO. D . AND. X1C3D . GT. C100. DD THEN\nFATORP = 1OO.\nELSE\nFATORP = 1000.\nENDIF\nIFCX1C3D . LT. C100. DD THEN\nFATORP = 10.\nENDIF\nX1C4D = SNGLCAC4D*4. 279D-07D\nX1CSD = SNGLCAC ED *4.279D-07D\nXICOD = SNGLCACSD*14. 7D\nN1 = CNP + lD*NP/2\nN2 = 5*NP + 2*NDX +N1\nCALL FINITACXT.DPWE.XI,F,XJAC.XJTJ.NP,N1,N2.WORKD\nRETURN\nEND\nSUBROUTINE FI NITAC XT. DPWE. XI . F. X J AC, X JTJ ,NP.Nl. NS. WORKD\nIMPLICIT REAL*8CA-H,O~ZD\nEXTERNAL FUNC.SLUG\nREAL PARAMC4D .XICOD .FCNDXD ,XJACCNDX.NPD , XJTJCN1D , W0RKCN2D . XPC2D , *XPPC3D\nREAL*8 DPWECNDXD,XTCNDXD\nCOMMON zFATORZFATORK,FATORP\nCOMMON zLIDAZ TTC200D.PWEC200D\nCOMMON ZPONTOSZN,NDP,NX,NDE,NDX\nCOMMON /PVTZCT.PHI, VISC.PO.PFF.TH.RW.PI,CS.CF.PK,S.PE\nCOMMON ZPVTl/CTl . PHI1, VISC1, PO1 , TH1, RW1 > CS1, CF1,PI1 TTC1D = O.\nPWEC1D = PO*14. 7\nDO S I = 1,NDX\nTTCI-HD = XTCIDZ3600.\n5 PWECI+1D = DPWECIDM4.7\nM - NDP\nnp = a\nIXJAC NDP\nNSIG = 3\nEPS = O.OO1\nDELTA = 0.0001\nMAXFN = 300\nI0PT = 1\nCS1 = X1C4D\nCF1 = X1C5D\nP01 = XI COD\nPHI1 =-- PHI\nVISC1 = vise\nCT1 - CT/14.7\nTH1 =\u2022 TH/30. 48\nRW1 = RW/30.48\nXPC1D = X1C1DZFATORK\nXPC2D \u00bb X1C2D\nPI1 = X1C3D\nCALL ZXSSQCSLOG.M.NP.NSIG.EPS\u00bbDELTA.MAXFN,IOPT.PARAM,XP.SSQ.F, MXJAC,IXJAC.X JTJ,WORK,INFER,IERD\nXPC1D = XPC1D*FATORK\nXPC2D = XPC2D\nWRITEC3,6ODCI ,XPCID ,I = 1.2D\n60 F0RMATC5X,\u2019VALOR OTIMO = \u2019 , *XC \u2019 ,13, \u2019D = \u2019.2X.DiO.4D\nNSIG = 4\nM \u00ab NDX\nMP = 3\nIXJAC = NDX\nXPPC1D = XPC1DZFAT0RK\nXPPC2D = XPC2D\nXPPC3D = XIC3DZFATORP\nCALL ZXSSQCFUNC.M.NP.NSIG,EPS.DELTA.MAXFN,IOPT\u00bbPARAM,XPP.SSQ.F, *XJAC,IXJAC,XJTJ,WORK,INFER,I ERD\nXPPC1D = XPPC1D*FATORK\nXPPC2D = XPPC2D\nXPPC3D = XPPC3D\u00abFAT0RP\nWRITEC3,10DCI , XPPCID . I = 1,3D\n10 FORMATC5X, 'VALOR OTIMO = \u2019,\u2019XC\u2019.I3.D- \u2019.2X.D10.4D\nWRITEC3.403\n40 FORMAT!Z,IXVETOR NORMA GRAD\u2122 NUM ITERACOES-NUM DIGITOS SIGNIFIC-\n* E MARQUARDT CONST. \u2019. Z>\nWRITEC3,503CI .WORKCI3 ,1=1 ,53\n50 FORMATC5X, \u2019 WORKC \u2019 ,12, * 3 = \u2019,F15.53\nRETURN\nEND\nC\nG................. .....................................................\nC\tTransformacao de todos os dados de Entrada para unidades Darcy\nC.......................................................................\nSUBROUTINE DADOSCUME, PWF. X, PWS, XT, DPWE3\nIMPLICIT REAL*8CA\"H,O\u2122Z3\nREALES TIMEC NDP3,PWFCNDP3 ,TC1003.PC1003\nREAL*8 XC NDE3 , PWSC NDE3 , DPWEC NDX3 , XTCNDX3 , VC203\nCOMMON Zl.PL.ZV, ML\nCOMMON ZSPLZT.P\nCOMMON ZRESERZCI.02,C3\nCOMMON ZCESTzVW,CW,RP,GRAD\nCOMMON ZPONTOSZN,NDP.NX,NDE.NDX\nCOMMON ZPVTZCT,PHI,VISC.PO,PFF,TH,RW,PI,CS,CF,PK>S,Pe\nC:::: DEFINICAO DOS PARAMETROS PARA A INVERS\u00c3O DE STEHFEST:i:::::::::::\nN = 8\nML= 1\nC: : ; : Calculo dos parametros auxiliares PI e CPA i::::::;;::::;::::::::\nPI = 4. M3ATANC1. D03\nCPA= 1. Z14. 7\nC:::: Outros dadosCUnidades Americanas e SI i:::::::::::::::::;:::::::: C: : : : Ct,CwCPsi -13 ;Th.Pp, FpCm3 ;RwC pol3 ; CdpCm3Zm33 ; Dot) , PhiCdecimal3 : : :\nREADCI ,103CT\nREADCI,103PHI\nREADCI ,103VISC\nREADCI ,103TH\nREADCI,103RW\nREADCI,103PP\nREADCI ,103FP\nREADCI ,103CW\nREADCI,103CDP\nREADCI .103DO\n10\tFORMAT!F25.03\nC:::: Transformacao dados fluido e reservat\u00f3rio para o sistema DARCY :\nRP = DSQRTCCDPZPI3*100.\n0RAD=DO*O. 000966397\nCF = CPI*RP*RP3zGRAD\nCW = CW*14. 7\nRW = RW*2. 54\nVW = PI*RW*RW\u00abCFP-PP3*100.\nCS ~ CW*VW\nCT = CTM4.7\nPO = POMCPA\nPE = PWSCNDE3*CPA\nPFF = PWFCNDP3*CPA\nTH = TH*100.\nC: : : : Calculo dos parametros auxiliares C2 e C3\nC2 = 2. xPlxTHZVISC\nC3 = DLOGC2.DO3\nC: : : : Impress\u00e3o dos parametros WRITEC2,203\n20 FORMATCZ, 23X .* DADOS DE FLUIDO E ROCHA\u2019,Z\u00bb3X,\u2019 COMPRESS.ClZatnD \u2019, *3X, \u2019POROSIDADE\u2019 ,3X. \u2019 VISCCcpj \u2019 , 4X, \u2019 THCcirD \u2019.3X, \u2019RWCcnO \u2019 , Z3 WRITEC2,403CT, PHI , VISC, TH, RW\n40\tFGRMATC\u00cdX,E10.3,10X,F8. 3,7X,F6. 3,5X,F8.2,3X,F8.33\nC:::: Transformacao do Tempo e press\u00e3o para unidades Darcy TC13 = O.\nPC 13 = PO\nDO 50 I = 1 ,NDP\nK =1+1\nTCK3 = TI MEC 13 *3600.\nTIMECI3 = TCK3\nXTCI3 = TCJC3\nPCK3 = PWFCI3Z14.7\nPWFCI3 = PCK3\nSO DPWECI3 = PCK3\nDO 60 K = NX,NDX IE = K-NDP\nDPWECK3 = PWSCIE3Z14.7\nPWSCIE3 = DPWECKD\nXTCK3 = XCIE3*36OO. + TCNX3\n60 XCIE3 = XTCK3\nRETURN\nEND SUBROUTINE FLUXOCX1,A,DPWF,NP3\nC...........................-...........................................\nC Esta rotina calcula os valores da press\u00e3o no periodo de fluxo e dos respectivos gradientes com relacao aos par\u00e2metros.\nn n\nIMPLICIT REAL*8CA-H.O-Z3\nEXTERNAL COEFF.SI8ACF,SI8ADF\nDIMENSION AC NP3, VC 203, TCI 003, PC 1003\nCOMMON ZSPLzT,P\nCOMMON ZLPLZV,ML\nCOMMON ZRESERZC1,C2,C3\nCOMMON ZPONTOSZN,NDP,NX,NDE,NDX\nCOMMON ZPVTZCT,PHI,VISC,PO,PFF,TH,RW,PI,CS,CF,PK,S,PE\nGAMA = DSQRTCAC133\nIFCAC23.LT. 03 THEN\nRWA = RWxDEXPC~AC233\nCl \u00ab DSQRTCPHIXVISC*CT*RWA*RWAD\nELSE\nCl = DSQRTCPHIXVISC*CTxRW*RW3\nENDIF\nALFA = C1ZGAMA\nAUX4 = C2XAC13ZACS3\nAl \u00ab C3ZX1\nIFCML. EQ. N3GO TO 11\nCALL COEFFCN3\n11\tCONTINUE\nSUHR = 0.\nDO 30 J = 1 , N\nZ = J * Al\nY = DSQRTCZ3\nXS = Y* ALFA\nBKO = S18ACFCXS, IFALHA3\nBK1 = S18ADFCXS.IFALHA3\nZI ~ 1. ZZ\nAUX 5 = BKOzBKl.\nI FC AC 23. LT. 03 THEN\nAUX1 = AUX5ZXS\nELSE\nAUX1 = AUX3ZXS + AC 23\nENDIF\nAUX 2 = AUX4*AC3D*ZI\nAUX 3 = AC63*AUX1 + AUX 2\nAUX8 = Z\u00abAUX1 + AUX4\nAUX8I = 1.ZAUX8\nPRESSAO = AUX3*AUXSI\n30\tSUHR - SUMR + VCJ3*PRE\u00a3SAO\nDPWF = SUMR* Al\nRETURN\nEND\nSUBROUTINE FUNC CX1>M,NPO.F3\nuuuuuuuuuu\nNP = NUMERO DE INTERVALOS DE TEMPO NO FLUXO\nNE = NUMERO DE INTERVALOS DE TEMPO NA ESTATE CA\nN = NUMERO DE GRID POINTS\nIMPLICIT REALES CA-H.O-Z3\nREAL XI C NPO3 , FC M3 , FRC 2003\nCOMMON Z TRI Z AC 603 > BC 603 , CC 603 > DC 603 , PDC 603 . PC 2003 . TC 2003\nCOMMON ZPVTIZCT.PHI.AMI,PO,H,RW1\u00bbCS,CF,PI1\nCOMMON ZPONTOSzN\u00bbNDP.NX,NDE,NDX\nCOMMON ZLIDAZ TTC2003tPWEC2003\nCOMMON ZFATORZFATORK,FATORP\nAK = DBLECX1C13\u00abFAT0RK3\nS = DBLECX1C233\nPI - DBLECX1C33 \u00abFATORF3\nWRITEC*,\u00ab3\u2019K\u00bbS\u00bbPI \u2018 .AK.S.PI\nWRI TEC 2. *3 AK. S, PI\nNP = NDP\nME = NDE\nc\nCALL E\u00c1D CAK.S>PI ,NP.NE3\nC\nPC13 = PO\nDO 3 I = 2.M + 1\nJ = I - 1\nFRCJ3 = SNGLCPWECI3-PCI33\nWRITEC2.1OO3TTCI3 ,PWECI3 ,PCI3 ,FRCJ3\nFCJ3 - FRC J3*PC 13 ZP WEC13\n3 COm NUE\n100 FORMATCF6. 3,2X,F15. 5,2X\u00bbF15. 5,2X,F15. S3\n:::: RESIDUO\nSSR = 0.\nDO 4 X =lfM\nSSR ~ SSR + FrCI3*FrCI3\n4\tCONTINUE\nWRITEC3t*3 \u2019SSR-\u2019 >SSR\nRETURN\nEND\nu u\tuuuu\tu\tu u u o u u\nSUBROUTINE RAD CAK^S^PIfNP,NE3\nIMPLICIT REAL *8 CA-H.O-Z3\nCOMMON Z TRI Z AC 603.BC 603 .CC603 . DC603.PDC603,PC 2003\u201eTC 2003\nCOMMON ZPVT1 /CT, PHI\u00bbAMI, PO, H t RW1 \u00bbCS\u00bb CF f PI 1\nCOMMON ZLIDAZ TTC2003,PWEC2003\nIF CS. GE. 0.0003 RW = RW1\nIF CS. LT. 0.0003 RW = RW1 * DEXP C -S3\nAUX\t= PHI\t* CT * RW * RW\nAuxl\t= AUX\t: * H * l.HSOOOOSdO\nCTO\t= AUX\t* AMI * 3792.18809300\nCSD\t= CS z auxl\t\nCD =\tCF Z\tauxl\nN \u00bb\t51\t\nXN =\tOLOG\tCl. 0153\nDX =\tXN Z\tCN-13\nDIF\t= PI\t- PO\nNT\t= NP\t+ NE\nCONDI CAO INICIAL\nTO = 0. DO PDC13 = 1.000\nDO 1 I = 2,N\nPDCI3 = O. DO\n1 c\tCONTINUE DO 2 I = 2*NT + 1 I FC I. GT. CNP+1D. AND. I. LT. CNP+1ODD THEN DT = CCTTCID-TTCI-IDDZCTDDZI. DO 3 J = 1,1 TD = TD + DT CALL MONTAGEM CCD,DX,DT,XN, ND\na\tCONTINUE GO TO 7 ENDIF\nc\tDT = CCTTCID-TTCI-IDDzCTDDzl. DO 5 J = 1,1 ID = TD + DT\nC\tCALL MONTAGEM CCD,DX\u00bbDT,XN,ND\n5 C\tCONTINUE TCID = TD * CTD PCID = PI - DIF * PDC1D I FCS. GT. O.DOD THEN 0 = CF*CPCID-POLDDZDT POLD = PCID PCID = PCID -Q*S ENDIF\nc\tIF CI. EQ. CNP+1DD THEN CD = CSD ENDIF\n2 C\tCONTINUE RETURN END\non\tn n n n n no no\nSUBROUTINE MONTAGEM CCD, DX , DT, XN t ND\nIMPLICIT REAL*8 CA-H,O-ZD\nCOMMON / TRI Z AC SOD , BC 603 , CC SOD , DC SOD , PDC SOD , PC SOOD , TC SOOD\nMONTAGEM DA MATRIZ TRI DIAGONAL\nI = 1 -> CONDICAO DE CONTORNO INTERNA\nSETA = - DX * CD z DT\nBC1D = BETA - l.ODO\nCC1D = l.ODO\nDC1D = BETA * PDC1D\nI = 2,N-1\nDO 2 I = 2,N-1\nX = Cl-10 * DX\nALFA = - DEXP C2.DO * XO * DX * DX Z DT\nACID = 1, ODO\nBCID = ALFA - 2. DO\nCCID = l.ODO\nDCID = ALFA * PDCID\n2 CONTINUE\nnnannnnnnnnonn nr> n n n n\tnnn\nI - N -> CONDICAO DE CONTORNO EXTERNA\nALFA = - DEXP C2.D0 * XND * DX * DX / DT AC ND = 2. ODO\nBCND = ALFA - 2. ODO\nDC ND = ALFA * PDCND\nCALL TRIDAG CND\nRETURN\nEND\nSUBROUTINE TRI DAG CND\nIMPLICIT REAL*8 CA-H.O-Z2\nCOMMON Z TRI Z AC 60D , BC \u00d5QD , CC 60D > DC 60D , PDC 6GD . PC 200D 6 TC 2CQD\nA -> DIAGONAL INFERIOR\nB -> DIAGONAL PRINCIPAL\nC -> DIAGONAL SUPERIOR\nD -> VETOR INDEPENDENTE\nP -> VETOR SOLUCAO\nN ~> NUMERO DE EQUA\u00c7\u00d5ES\nDO 1 I = 1 , N-l\nL = I + 1\nBCLD = BCLD \u201d CCID * ACLD Z BC ID\nDCLD = DCLD - DCID * ACLD Z BCID\n1 CONTINUE\nPDCND = DCND Z BCND\nDO 2 I = N~1 ,1 t-l\nL = 1+1\nPDCID \u00ab C DCID - CCID * PDCLD D Z BCID\nCONTINUE\nRETURN\nEND\nC\nSUBROUTINE SLUG CXltM,NPO>F3\nIMPLICIT REALMS CA-H.O-ZD\nREAL X1CNPO5 ,FCM0\u00bbFrCSOOO\nCOMMON Z TRI Z AC 603 , BC603 ,CC600 , DC 603 , PDC603 ,PC\u00a3003 ,TC2OO3\nCOMMON ZPVT1ZCT > PHI,AMI\u00bbPO>H,RW1,CS,CF,PI\nCOMMON ZPONTOSZN,NDP,NX>NDE,NDX\nCOMMON ZLIDAZ TTC2005,PWEC\u00a3003\nCOMMON ZFATORZFATORK.FATORP\nC; c : DESCALONAMENTO E USO ADEQUADO\nAK - DBLECX1C13\u00abFATORKO\nS\t= DBLECX1C233\nWRITEC*. *3 \u2019K.S' ,AK.S\nWRITECS, \u00abOAK. S,PI\nNP = NDP\nNE = 0\nC\nCALL RADI CAK.S,NP,NE3\nC\nPC 13 - PO\nDO 3 I = 2\u00bbM + 1\nJ = I - 1\nFRCJ3 = SNGLCPWECI3-PCI33\nFC JO - FRC J3ZCPWECNDP+13 -PC 13 0 WRITEC2,1003 TTCI3 > PWEC 13 (PC 15 ( Fr C JO\n3 CONTINUE\n100 FORMATCF6. 3,2X,F15. 5.2X, FIS. 5,2X,F15. S3\nC\nC: : : : RES DUO\nSSR = 0,\nDO 4 I =1,M\nSSR SSR + FrCIOMFrCID\n4\tCONTINUE\nWRITEC3, *3SSR\nRETURN\nEND\nu u u u\nSUBROUTINE RADI CAK,S\u00bbNP.NE3\nIMPLICIT REALMS CA-H.O-Z3\nCOMMON Z TRI S AC 603 , BC 603 t CC 600 , DC 600 , PDC 603 , PC 2003 , TC 2000\nCOMMON ZPVT1ZCT, PHI , AME , PO, H,RW1,CS,CF,PI\nCOMMON ZLIDAZ TTC2000.PWEC2000\nIF CS. GE. 0.0D03 RW = RW1\nIF CS. LT. 0. ODOO RW = RW1 * DEXP C-S3\nAUX\t- PHI\t* CT * RW m RW\n\u00c0uxl\t= AUX * H * 1.11000006d0\t\nCTD\tAUX\t* AMI * 3792.18809300\nCSD\t- CS Z AUX1\t\nCD =\tCF Z\tAUX1\nN =\t51\t\nXN =\tDLOG\tCl .Dl 53\nDX ~\tXN z\tCN-13\nDIF\t= PI\t~ PO\nNT\t= NP\t+ NE\nu-uu\nCONDICAO INICIAL\nTD - 0. DO\nPDC13 - l.ODO\nDO 1 I - S,M\nPDCID = O. DO\n1\tCONTE NUE\nDO 2 I - 2fNT + 1\nDT \u00ab CCTTC13-TTC 1-1>\u20193ZCTD3Z1.\nDO 3 J = 1,1\nTD = TD + DT\nCALL MONTAGEM CCDtDXtDT\u00bbXN.N3\n3 CONTINUE\nTCI3 = TD * CTD\nPCI2> = PI \u201d DIF * PDC1D IFCS. GT. O. DOD THEN\nQ = CF*CPCI3-POLD3ZDT POLD = PC 13\nPCI3 = PCI3 -Q*S ENDIF\nIF Cl. EQ. CNP+133 THEN\nCD = CSD\nENDIF\n2\tCONTINUE\nRETURN\nEND"}]}}}