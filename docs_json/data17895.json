{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.21874"}, {"@name": "filename", "#text": "5677_arquivo2293_1.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE FEDERAL DE PERNAMBUCO \nCENTRO DE TECNOLOGIA E GEOCI\u00caNCIAS \n\nPROGRAMA DE RECURSOS HUMANOS DA ANP \u2013 PRH 26 \n \n \n\n \n \n \n\nTESE DE DOUTORAMENTO \n \n \n\nSimula\u00e7\u00e3o de Escoamento Bif\u00e1sico Ol\u00e9o-\u00c1gua em Reservat\u00f3rios de Petrol\u00e9o Usando \nComputadores Paralelos de Mem\u00f3ria Distribu\u00edda \n\n \nBolsista DSc. Rog\u00e9rio Soares da Silva \n\n \n \n\nOrientador: Prof. Paulo Roberto Maciel Lyra (PhD) \nCo-Orientador: Prof. Ramiro Brito Willmersdorf (PhD) \n\n \n \n \n \n\n \n \n \n \n \n \n \n \n\nRECIFE \u2013 2008 \n\n\n\nUniversidade Federal de Pernambuco \nCentro de Tecnologia e Geoci\u00eancias \nDepartamento de Engenharia Civil \n\n \n \n \n\nSimula\u00e7\u00e3o de Escoamento Bif\u00e1sico Ol\u00e9o-\n\u00c1gua em Reservat\u00f3rios de Petr\u00f3leo Usan-\ndo Computadores Paralelos de Mem\u00f3ria \n\nDistribu\u00edda \n \n\n \n\n \n\nRog\u00e9rio Soares da Silva \n\n \n\n \n\n \nTESE SUBMETIDA AO CORPO DOCENTE DO CURSO DE P\u00d3S-\nGRADUA\u00c7\u00c3O EM ENGENHARIA CIVIL DA UNIVERSIDADE FEDERAL \nDE PERNAMBUCO COMO PARTE DOS REQUISITOS NECESS\u00c1RIOS \u00c0 \nOBTEN\u00c7\u00c3O DO GRAU DE DOUTOR EM CI\u00caNCIAS DE ENGENHARIA \nCIVIL.  \n \n \n\n\u00c1REA DE CONCENTRA\u00c7\u00c3O: \nESTRUTURAS (ENGENHARIA DE PETR\u00d3LEO) \n\n \n \n\n \nPaulo Roberto Maciel Lyra, PhD \n\n(Orientador) \n \n \n \n \n \n \n\nRecife, Pernambuco, Brasil. \n\u00a9Rog\u00e9rio Soares da Silva, Outubro de 2008. \n\n\n\n \n\n \nS586s Silva, Rog\u00e9rio Soares da. \n\nSimula\u00e7\u00e3o de escoamento bif\u00e1sico \u00f3leo-\u00e1gua em reservat\u00f3rios de \npetr\u00f3leo usando computadores paralelos de mem\u00f3ria distribu\u00edda / Ro-\ng\u00e9rio Soares da Silva. \u2013 Recife: O Autor, 2008. \n\nxiv, 144 folhas, il : tabs., grafs. \n \nTese (Doutorado) \u2013 Universidade Federal de Pernambuco. CTG. \n\nPrograma de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia Civil, 2008. \n \nInclui Bibliografia e Ap\u00eandice.  \n \n1. Engenharia civil. 2. Reservat\u00f3rio de petr\u00f3leo. 3. M\u00e9todo dos vo-\n\nlumes finitos. 4. IMPES. 5. Programa\u00e7\u00e3o orientada a objetos. 6. C++. 7. \nComputa\u00e7\u00e3o paralela.  I. T\u00edtulo. \n\n                                                                    UFPE \n          \n624  CDD (22. Ed.)                         BCTG/ 2009-067                             \n \n  \n\n\n\n \n\n\n\nii \n\nAgradecimentos \n \n \n Ao Programa de Recursos Humanos da Ag\u00eancia Nacional de Petr\u00f3leo (PRH-26-\nANP), pela bolsa concedida durante o per\u00edodo de realiza\u00e7\u00e3o do doutorado. \n \n A todo o pessoal t\u00e9cnico e administrativo do PRH-26, particularmente a S\u00f4nia pela \ndedica\u00e7\u00e3o em resolver problemas burocr\u00e1ticos. \n \n Ao coordenador do PRH-26 Prof. M\u00e1rio Filho pela disposi\u00e7\u00e3o, alegria e aten\u00e7\u00e3o \ndespendida durante os congressos e reuni\u00f5es. \n \n Aos colegas Daniel Ventura, Alessandro Antunes e D. Eliane, secret\u00e1ria da p\u00f3s-\ngradua\u00e7\u00e3o do DEMEC, pela amizade e descontra\u00e7\u00e3o durante o intervalo do caf\u00e9 das 10h e \ndas 15h.  \n \n Tamb\u00e9m agrade\u00e7o ao colega Alessandro Antunes pelas id\u00e9ias trocadas sobre pro-\ngrama\u00e7\u00e3o paralela. \n \n Agrade\u00e7o especialmente ao colega Darlan Carvalho, a quem devo imensamente a \najuda prestada em todos os momentos da tese com id\u00e9ias, sugest\u00f5es e cr\u00edticas que foram de \ngrande contribui\u00e7\u00e3o para este trabalho. \n \n Aos alunos de inicia\u00e7\u00e3o cient\u00edfica do PADMEC: \u00c9rika Oliveira e Bruno Pascaretta \npelos trabalhos que desenvolvemos juntos. \n \n Ao Professores Paulo Lyra e Ramiro Willmersdorf pela orienta\u00e7\u00e3o, clareza, conse-\nlhos e sugest\u00f5es durante meu trabalho. \n \n Aos meus pais Arlete e S\u00e9rgio pelo apoio que me deram ao longo desses quatro a-\nnos de estudo e dedica\u00e7\u00e3o. \n \n Agrade\u00e7o a minha namorada Ana Janaina, uma pessoa formid\u00e1vel e de uma alegria \ncontagiante que me apoiou durante todos os momentos do meu trabalho. \n\n\n\niii \n\nResumo \n \n \n\nA busca por t\u00e9cnicas de alto desempenho por engenheiros e pesquisadores no cam-\npo da simula\u00e7\u00e3o num\u00e9rica em reservat\u00f3rios de petr\u00f3leo \u00e9 um caminho que vem sendo per-\ncorrido desde o in\u00edcio da d\u00e9cada de 1950 com o advento dos primeiros computadores digi-\ntais. Prever o comportamento de um reservat\u00f3rio ao longo de sua vida produtiva e extrair a \nm\u00e1xima quantidade de hidrocarbonetos economicamente vi\u00e1vel \u00e9 uma tarefa que exige um \nconhecimento mais detalhado das caracter\u00edsticas dos fluidos (l\u00edquidos e/ou gasosos) e do \nmeio poroso por onde escoam. A modelagem matem\u00e1tica da f\u00edsica envolvida no escoamen-\nto de fluidos em meios porosos resulta em equa\u00e7\u00f5es diferenciais parciais (EDPs) n\u00e3o-\nlineares que apenas apresentam solu\u00e7\u00f5es anal\u00edticas em casos muito simplificados.  \n M\u00e9todos num\u00e9ricos como os de diferen\u00e7as finitas e de volumes finitos, e mais re-\ncentemente de elementos finitos, t\u00eam sido aplicados neste campo e exigem um tratamento \nespecial quando se deseja empreg\u00e1-los em simula\u00e7\u00f5es com o aux\u00edlio de computadores pa-\nralelos partindo desde a fase de pr\u00e9-processamento, passando pela estrutura de dados do \nsimulador, at\u00e9 a resolu\u00e7\u00e3o das equa\u00e7\u00f5es discretas. \n\nO uso de computadores paralelos de mem\u00f3ria distribu\u00edda \u00e9 apresentado como uma \nferramenta de alto desempenho que pode permitir uma redu\u00e7\u00e3o significativa no tempo total \nde simula\u00e7\u00e3o ou pode viabilizar a simula\u00e7\u00e3o de problemas de grande porte, ou seja, pro-\nblemas que excedem a capacidade de mem\u00f3ria de uma \u00fanica m\u00e1quina devido a enorme \nquantidade de dados envolvidos. \n\nNeste trabalho, \u00e9 apresentado um simulador de reservat\u00f3rios de petr\u00f3leo paralelo \ndesenvolvido em C++ e que faz uso de pacotes gratuitos de c\u00f3digo aberto voltados \u00e0 pro-\ngrama\u00e7\u00e3o paralela como FMDB, ParMetis e Petsc que desempenham tarefas espec\u00edficas \nimportantes como o gerenciamento de malhas distribu\u00eddas, o balan\u00e7o de carga entre pro-\ncessadores e a utiliza\u00e7\u00e3o de resolvedores (solvers) iterativos paralelos, respectivamente. \n\nUma formula\u00e7\u00e3o de volumes finitos centrada nos v\u00e9rtices e baseadas em uma estru-\ntura de dados por arestas (Carvalho, 2005), aqui chamada de EBFV1 (Edge Based Finite \nVolume), \u00e9 utilizada na discretiza\u00e7\u00e3o das equa\u00e7\u00f5es governantes para simular o escoamento \nincompress\u00edvel \u00f3leo-\u00e1gua em meios porosos heterog\u00eaneos e anisotr\u00f3picos tanto em malhas \nde tri\u00e2ngulos quanto de tetraedros. Nesta formula\u00e7\u00e3o, a heterogeneidade do meio est\u00e1 asso-\nciada a subdom\u00ednios. O m\u00e9todo de integra\u00e7\u00e3o no tempo IMPES (IMplicit Pressure Explicit \nSaturation) \u00e9 adotado nas simula\u00e7\u00f5es em conjunto com um procedimento adaptativo no \npasso de tempo (Hurtado et al., 2006).  \n Uma segunda formula\u00e7\u00e3o de volumes finitos (EBFV2) tamb\u00e9m com volumes de \ncontrole centrados nos v\u00e9rtices e onde a heterogeneidade do meio est\u00e1 associada aos ele-\nmentos da malha \u00e9 apresentada e comparada com a formula\u00e7\u00e3o EBFV1 para tratar proble-\nmas el\u00edpticos em malhas 2-D. Exemplos obtidos da literatura e tratados por outras formula-\n\u00e7\u00f5es de volumes finitos s\u00e3o usados para avaliar o erro e a taxa de converg\u00eancia para ma-\nlhas com diferentes n\u00edveis de refinamento. Mostram-se como as duas formula\u00e7\u00f5es s\u00e3o ca-\npazes de lidar com problemas envolvendo meios porosos com raz\u00e3o de heterogeneidade e \nanisotropia elevada. \n \nPalavras-chave: Reservat\u00f3rios de petr\u00f3leo, M\u00e9todos dos volumes finitos, Programa\u00e7\u00e3o \norientada a objetos, C++, Computa\u00e7\u00e3o paralela. \n \n\n\n\niv \n\nAbstract \n \n \n High performance techniques has been applied to petroleum reservoir simulations \nby engineers and researches since the advent of electronic computers in the 1950\u2019s. The \nrequirement to forecast the reservoir behaving along its production life obtaining the max-\nimum of hydrocarbons includes a detailed knowledgement of the fluids (liquids and gases) \nand the rocks characteristics. Mathematical modeling of fluid flow in porous media results \nin non-linear partial differential equations that in general cannot be solved by analical \nmeans. \n Numerical methods like finite difference and finite volume method, and more re-\ncently the finite element method, have been applied in petroleum reservoir field. A special \nattention must be given to such methods when they are used in simulations with parallel \ncomputers since the pre-processors stage, passing through the data structure up to the solv-\ner of the system of equations. \n Parallel computers with distributed memory are presented as a high performance \ntool that helps to decrease the time of simulations or to allow large scale simulations that \ncould not be possible using a single machine due the large amount of data. \n In this work is presented a parallel petroleum reservoir simulator written in C++ \nand making use of open source parallel libraries such as FMDB (Flexible Distributed Mesh \nData Base), ParMetis and PETSc (Portable Extensible Toolkit for Scientific computation) \nperforming specialized tasks like distributed mesh management, mesh partition and solving \nof system of equations. \n A vertex centered finite volume formulation using an edge-based data structure \n(Carvalho, 2005) called EBFV1 (Edge Based Finite Volume) is used to discretize the in-\ncompressible two-phase oil-water flow equations in heterogeneous and anisotropic media \nusing triangle and tetrahedral elements meshes. Heterogeneity is associated to sub-\ndomains. A modified IMPES method of time integration is adopted with an adaptive pro-\ncedure in the time step (Hurtado et al., 2006). \n A second vertex centered finite volume formulation (EBFV2) using an edge-based \ndata structure is also presented but associating the porous media heterogeneity to the mesh \nelements. The formulation is compared to the EBFV1, to others numerical formulations \nand to the analytical solutions of 2-D elliptic problems taken from literature. Acuracy and \nconvergence ratio for meshes with different level of refinement are evaluated to show how \nboth formulation can deal with porous media with high heterogeneity and anisotropic ratio. \n \nKeywords: Petroleum Reservoir, Finite volume method, Object-oriented programming, \nC++, Parallel computing. \n \n \n\n\n\nv \n\nSum\u00e1rio \n \nResumo ................................................................................................................................. iii \nAbstract ................................................................................................................................. iv \nLISTA DE S\u00cdMBOLOS ....................................................................................................... vii \nLISTA DE ACR\u00d4NIMOS ..................................................................................................... x \nLISTA DE FIGURAS ........................................................................................................... xi \nLISTA DE TABELAS ........................................................................................................ xiv \n1. INTRODU\u00c7\u00c3O ............................................................................................................... 15 \n\n1.1 Motiva\u00e7\u00e3o e Considera\u00e7\u00f5es Gerais ............................................................................ 15 \n1.2 Objetivos e Contribui\u00e7\u00f5es do Presente Trabalho ....................................................... 19 \n1.3 Organiza\u00e7\u00e3o Geral da Tese ........................................................................................ 20 \n\n2. EQUA\u00c7\u00d5ES GOVERNANTES ...................................................................................... 22 \n2.1 Introdu\u00e7\u00e3o .................................................................................................................. 22 \n2.2 Escoamentos Bif\u00e1sicos e Imisc\u00edveis em Meios Porosos ............................................ 23 \n\n2.2.1 Conceitos Fundamentais ..................................................................................... 23 \n2.2.2 Equa\u00e7\u00e3o de Press\u00e3o ............................................................................................. 25 \n2.2.3 Equa\u00e7\u00e3o de Satura\u00e7\u00e3o ......................................................................................... 28 \n2.2.4 Condi\u00e7\u00f5es Iniciais e de Contorno ....................................................................... 30 \n\n3. M\u00c9TODO DE VOLUMES FINITOS POR ARESTA .................................................... 31 \n3.1 Introdu\u00e7\u00e3o .................................................................................................................. 31 \n3.2 Formula\u00e7\u00e3o Matem\u00e1tica ............................................................................................ 33 \n3.3 Formula\u00e7\u00e3o Num\u00e9rica ................................................................................................ 34 \n\n3.3.1 M\u00e9todo de volumes finitos baseados em aresta 1 - (EBFV1) ............................. 34 \n3.3.2 M\u00e9todo de volumes finitos baseados em aresta 2 - (EBFV2) ............................. 41 \n\n3.4 An\u00e1lise de erro ........................................................................................................... 42 \n3.5 Exemplos ................................................................................................................... 43 \n\n3.5.1 Meio homog\u00eaneo e isotr\u00f3pico ............................................................................. 43 \n3.5.2 Meio homog\u00eaneo e anisotr\u00f3pico ......................................................................... 45 \n3.5.3 Meio heterog\u00eaneo e anisotr\u00f3pico ........................................................................ 46 \n3.5.4 Meio homog\u00eaneo e anisotr\u00f3pico com solu\u00e7\u00e3o n\u00e3o-suave .................................. 50 \n\n4. M\u00c9TODOS DE INTEGRA\u00c7\u00c3O NO TEMPO ............................................................... 54 \n4.1 Introdu\u00e7\u00e3o .................................................................................................................. 54 \n4.2 IMPES ........................................................................................................................ 54 \n4.3 Descri\u00e7\u00e3o do m\u00e9todo IMPES ..................................................................................... 55 \n4.3 IMPES modificado .................................................................................................... 57 \n4.4 Resultados .................................................................................................................. 60 \n\n4.4.1 Problema de \u00bc de five-spot invertido com meio homog\u00eaneo e raz\u00e3o de \nviscosidade moderadamente adversa ........................................................................... 60 \n4.4.2 Problema de \u00bc de Cinco Po\u00e7os Heterog\u00eaneo com Raz\u00e3o de Viscosidade \nModeradamente Adversa. ............................................................................................ 69 \n\n4.4 Outros m\u00e9todos: Seq\u00fcencial Impl\u00edcito, Totalmente Impl\u00edcito e Adaptativo Impl\u00edcito-\nExpl\u00edcito ........................................................................................................................... 75 \n\n5. COMPUTA\u00c7\u00c3O PARALELA........................................................................................ 77 \n5.1 Introdu\u00e7\u00e3o .................................................................................................................. 77 \n5.2 Filosofia adotada na implementa\u00e7\u00e3o .......................................................................... 79 \n5.3 Decomposi\u00e7\u00e3o de dom\u00ednios ....................................................................................... 80 \n5.4 Programa\u00e7\u00e3o Orientada a Objetos ............................................................................. 81 \n\n\n\nvi \n\n5.4.1 A linguagem C++ ............................................................................................... 83 \n5.5 Ferramentas computacionais paralelas ...................................................................... 84 \n\n5.5.1 Interface paralela de mensagens (MPI) .............................................................. 85 \n5.5.2 Particionamento de malha e balan\u00e7o de carga (ParMetis) .................................. 86 \n5.5.3 Estrutura de dados distribu\u00edda (FMDB) .............................................................. 87 \n5.5.4 Resolu\u00e7\u00e3o de sistemas de equa\u00e7\u00f5es (PETSc) ..................................................... 92 \n\n5.6 Implementa\u00e7\u00e3o paralela ............................................................................................. 97 \n5.6.1 Pr\u00e9-processador ................................................................................................... 97 \n5.6.2 Simulador ............................................................................................................ 99 \n\n5.7 An\u00e1lises de desempenho .......................................................................................... 106 \n6. CONCLUS\u00d5ES E TRABALHOS FUTUROS.............................................................. 114 \n\n6.1 Conclus\u00f5es ............................................................................................................... 114 \n6.2 Trabalhos Futuros .................................................................................................... 115 \n\nAP\u00caNDICE A .................................................................................................................... 117 \nBIBLIOGRAFIA ............................................................................................................... 130 \n \n\n\n\nvii \n\nLISTA DE S\u00cdMBOLOS \n \n\nKA  :\u00c1rea da superf\u00edcie de controle \n\nLIJ\nC\n?\n\n  : Vetor \u00e1rea normal a superf\u00edcie de controle associada \u00e0 aresta LIJ  no inte-\n\n  rior do dom\u00ednio \n\nr\n\nLIJ\nC ?\n?\n\n  : Vetor \u00e1rea normal da superf\u00edcie de controle associada \u00e0 aresta LIJ  para o \n\n  interior do subdom\u00ednio r?  \n\nLIJ\nD\n?\n\n  : Vetor \u00e1rea normal da superf\u00edcie de controle associada \u00e0 aresta LIJ  no con-\n\n  torno do dom\u00ednio  \n\nr\n\nLIJ\nD?\n?\n\n  : Vetor \u00e1rea normal da superf\u00edcie de controle associada \u00e0 aresta LIJ  para o \n\n  contorno do dom\u00ednio r?  \n\nL HIJ J\nD\n?\n\n  : Vetor \u00e1rea normal da superf\u00edcie de controle triangular no contorno, \n\n  formada pelos n\u00f3s I, JL e JH \n\nE   : Norma do erro assint\u00f3tico de truncamento \n\nfi  : Fluxo fracional da fase i \n\nF\n?\n\n  : Fluxo advectivo exato \n\nr\n\nLIJ\nF ?   : Fluxo advectivo aproximado associado a uma aresta LIJ  \n\ng  : M\u00f3dulo da acelera\u00e7\u00e3o gravitacional \n\ni  : Fase i = \u00f3leo (o) ou \u00e1gua (w) \n\nI, JL  : N\u00f3s gen\u00e9ricos da malha, atrav\u00e9s dos quais s\u00e3o definidos os volumes de \n\n  controle \n\nI\n?\n\n  : Tensor Identidade \n\nLIJ   : Aresta formada pelos n\u00f3s I e LJ  \n\nK  : Tensor permeabilidade absoluta do meio poroso \n\nrik   : Permeabilidade relativa da fase i \n\nm, n  : Par\u00e2metros emp\u00edricos para o modelo de Van Genuchten \n\nn\n?\n\n  : Vetor \u00e1rea normal \n\nkn\n?\n\n  : Vetor unit\u00e1rio normal a \u00e1rea k A \n\nNN  : N\u00famero de n\u00f3s vizinhos conectados ao um n\u00f3 I atrav\u00e9s de uma aresta LIJ  \n\npc  : Press\u00e3o capilar \n\n\n\nviii \n\npd  : Par\u00e2metro emp\u00edrico para o modelo de Brooks e Corey \n\npi  : Press\u00e3o da fase i \n\npm  : Press\u00e3o m\u00e9dia das fases \n\nqi  : Termos de fonte ou sumidouro (i.e. po\u00e7os) \n\nQ  : Vaz\u00e3o volum\u00e9trica espec\u00edfica total \n\nQi  : Vaz\u00e3o volum\u00e9trica espec\u00edfica da fase i \n\nQI  : Vaz\u00e3o volum\u00e9trica total no po\u00e7o injetor \n\nQP  : Vaz\u00e3o volum\u00e9trica total no po\u00e7o produtor \n\nSi  : Satura\u00e7\u00e3o da fase i \n\nSro  : Satura\u00e7\u00e3o residual de \u00f3leo \n\nSrw  : Satura\u00e7\u00e3o residual de \u00e1gua \n\nv\n?\n\n  : Velocidade total do fluido ou velocidade de transporte advectivo \n\niv\n?\n\n  : Vetor velocidade da fase i \n\nVI  : Volume de controle associado a um n\u00f3 I \n\nt  : Instante de tempo \n\nu  : Vari\u00e1vel escalar gen\u00e9rica (i.e. temperatura, press\u00e3o, concentra\u00e7\u00e3o, etc.) \n\nIu   : Valor exato da vari\u00e1vel escalar u num ponto I \n\n\u02c6\nIu   : Valor aproximado da vari\u00e1vel escalar u num ponto I \n\nLIJ\nu   : Valor exato da vari\u00e1vel escalar u no ponto m\u00e9dio de uma aresta LIJ  \n\n\u02c6\nLIJ\n\nu   : Valor aproximado da vari\u00e1vel escalar u no ponto m\u00e9dio de uma aresta LIJ  \n\nL HIJ J\nu   : Valor aproximado da vari\u00e1vel escalar u associado a uma superf\u00edcie  \n\n  de controle triangular formada pelos n\u00f3s I, JL e JH \n\n\u02c6\nIu?   : Gradiente aproximado da vari\u00e1vel escalar u no n\u00f3 I \n\n\u02c6\nLIJ\n\nu?   : Gradiente aproximado da vari\u00e1vel escalar u no ponto m\u00e9dio da aresta LIJ\n\n  obtido por volumes finitos repetidos \n\n( )r\nL\n\nN\nIJu\n?\n\n?  : Componente do gradiente aproximado da vari\u00e1vel escalar u normal a aresta \n\n  LIJ  no ponto m\u00e9dio da mesma, obtido por volumes finitos repetidos \n\n(P)r\nLIJ\n\nu ??  : Componente do gradiente aproximado da vari\u00e1vel escalar u paralelo a \n\n  aresta LIJ  no ponto m\u00e9dio da mesma, obtido por volumes finitos repetidos \n\n \n\nS\u00edmbolos Gregos \n\n\n\nix \n\n \n\n?  : Par\u00e2metro emp\u00edrico para o modelo de Van Genuchten \n\n?  : Porosidade \n\ni?  : Mobilidade da fase i \n\nLIJ\nI?  : Termo de mobilidade total avaliado no ponto m\u00e9dio da aresta LIJ  \n\nI?  : Superf\u00edcie de controle associada a um volume de controle I?  \n\n?  : Contorno ou fronteira \n\ni\u00b5  : Viscosidade da fase i \n\n?  : Dom\u00ednio \n\n?  : Par\u00e2metros emp\u00edricos para o modelo de Brooks e Corey \n\ni?  : Densidade ou massa espec\u00edfica da fase i \n\nLIJ\n?  :Comprimento de uma aresta LIJ  \n\n \n\nMatrizes de Aresta \n\n \n\n[ ]\n( )\n\n( )\n\n2 2ndim\n\nL rIJ\n\nx\nE\n\n?\n : Matriz da aresta LIJ  respons\u00e1vel pela proje\u00e7\u00e3o do gradiente numa dire\u00e7\u00e3o \n\n normal a aresta \n\n[ ]\n( )\n\n( )\n\n2ndim 2\n\nL rIJ\n\nx\nF\n\n?\n : Matriz da aresta LIJ  para o c\u00e1lculo do gradiente nodal pelo MVFA para \n\n meios homog\u00eaneos \n\n[ ]\n( )\n\n( )\n\n2 2\n\nL rIJ\n\nx\nG\n\n?\n : Matriz de aresta LIJ  para a discretiza\u00e7\u00e3o do termo el\u00edptico que cont\u00e9m o \n\n termo de proje\u00e7\u00e3o do gradiente numa dire\u00e7\u00e3o paralela a aresta \n\n \n\n\n\nx \n\nLISTA DE ACR\u00d4NIMOS \n \nAPI  : Application Programming Interface \n\nASM  : Additive Schwarz Method \n\nBiCG  : Gradiente Bi-Conjugado \n\nBiCG  : Gradiente Bi-Conjugado Estabilizado \n\nBlas  : Basic Linear Algebra Subprograms \n\nCAF  : Co-Array Fortran \n\nCPU  : Central Processing Unit \n\nCG   : Gradiente Conjugado \n\nCGNR  : Conjugate Gradient Normal Residual  \n\nDSM  : Distributed Shared-Memory \n\nEBFV1 : Edge Based Finite Volume 1 \n\nEBFV2 : Edge Based Finite Volume 2 \n\nFMDB  : Flexible Distributed Mesh Database \n\nGMRES : Generalized Minimum RESidual \n\nHPC  : High Performance Computing \n\nHPVM  : High Performance Virtual Machines \n\nLAPACK : Linear Algebra PACKage \n\nMflops  : Milh\u00f5es de opera\u00e7\u00f5es de ponto flutuante por segundo \n\nMPI  : Message Passing Interface \n\nMIMD  : Multiple \u2013 Instruction, Multiple \u2013 Data stream \n\nMISD  : Multiple-instruction, Single-Data \n\nNOW  : Network of Workstations \n\nPCR  : Preconditioned Conjugate Gradient \n\nPETSc  : Portable, Extensible, Toolkit for Scientific Computation \n\nPRS  : Petroleum Reservoir Simulator \n\nQMR  : Quasi-Minimal Residual \n\nSIMD  : Single \u2013 Instruction, Multiple \u2013 Data stream \n\nSISD  : Single-Instruction, Single-Data \n\nSTL  : Standard Template Library \n\nUPC  : Unified Parallel C \n\n\n\nxi \n\nLISTA DE FIGURAS \n \nFigura 3.1 \u2013 Volume de controle subdividido por dois tipos diferentes de rocha ............... 37 \n \nFigura 3.2 \u2013 Equa\u00e7\u00e3o el\u00edptica com coeficientes isotr\u00f3picos e cont\u00ednuos: campo escalar u \nobtido com o EBFV2 usando uma malha triangular (65x65). ............................................. 44 \n \nFigura 3.3 \u2013 Meio homog\u00eaneo e anisotr\u00f3pico: a) malha triangular (9x9); b) campo escalar \nu obtido com o EBFV1. ....................................................................................................... 46 \n \nFigura 3.4 \u2013 Linhas de contorno da fun\u00e7\u00e3o escalar ( , )u x y  obtidas com o EBFV1 usando \numa malha estruturada triangular (65x65) para diferentes valores de ? : (a) 1.0? = ; (b); \n\n10.0? =  (c) 100.0? = ; (d) 1000.0? =  .............................................................................. 48 \n \nFigura 3.5 \u2013 Geometria e malha triangular n\u00e3o-estruturada usada para resolver o problema \nhomog\u00eaneo e anisotr\u00f3pico com solu\u00e7\u00e3o n\u00e3o suave. ............................................................ 51 \n \nFigura 3.6 \u2013 Solu\u00e7\u00e3o num\u00e9rica para o problema homog\u00eaneo e anisotr\u00f3pico com solu\u00e7\u00e3o \nn\u00e3o suave: \u00e2ngulo de rota\u00e7\u00e3o / 6? ?= ; a) EBFV1; b) EBFV2. ......................................... 52 \n \nFigura 3.7 \u2013 Solu\u00e7\u00e3o num\u00e9rica para o problema homog\u00eaneo e anisotr\u00f3pico com solu\u00e7\u00e3o \nn\u00e3o suave: \u00e2ngulo de rota\u00e7\u00e3o 5 / 6? ?= ; a) EBFV1; b) EBFV2. ........................................ 52 \n \nFigura 3.8 \u2013 Comportamento da vari\u00e1vel u ao longo de uma reta paralela ao eixo x \npassando pelo centro do dom\u00ednio. Para um problema com valores prescritos m\u00ednimo e \nm\u00e1ximo de 0.0 e 2.0, respectivamente, esperava-se que os resultados ficassem confinados \ndentro desse intervalo. Devido a forte anisotropia, verifica-se a presen\u00e7a de \u201cundershoots\u201d, \nou seja, valores calculados abaixo do m\u00ednimo esperado. .................................................... 53 \n \nFigura 4.1 \u2013 Curvas de \u00f3leo recuperado. V\u00e1rios DVTOL do IMPES modificado \nconfrontados com o IMPES cl\u00e1ssico para malhas de (a) 2004 e (b) 10.201 n\u00f3s. ................ 62 \n \nFigura 4.2 \u2013 Curvas de \u00f3leo acumulado. V\u00e1rios DVTOL do IMPES modificado \nconfrontados com o IMPES cl\u00e1ssico para as malhas de 2004 (a) e 10.201 B (b) n\u00f3s. ........ 63 \n \nFigura 4.3 \u2013 Amplia\u00e7\u00e3o das curvas de \u00f3leo recuperado na regi\u00e3o onde a \u00e1gua atinge o po\u00e7o \nprodutor (breakthrough) para as malhas de 2004 (a) e 10.201 B (b) n\u00f3s. ........................... 64 \n \nFigura 4.4 \u2013 Amplia\u00e7\u00e3o das curvas de \u00f3leo acumulado destacando a discrep\u00e2ncia entre os \nresultados para v\u00e1rios DVTOL e o IMPES tradicional para as malhas de 2004 (a) e 10.201 \nB (b) n\u00f3s. .............................................................................................................................. 65 \n \nFigura 4.5 \u2013 Rela\u00e7\u00e3o entre o tempo total de CPU e a acur\u00e1cia dos resultados para v\u00e1rios \nDVTOL. \u00c9 tomada como refer\u00eancia a curva de \u00f3leo acumulado do m\u00e9todo IMPES \ntradicional. Apenas para a malha de 10.201 n\u00f3s com meio homog\u00eaneo. ............................ 66 \n \nFigura 4.6 \u2013 Rela\u00e7\u00e3o entre o tamanho do passo de tempo impl\u00edcito pelo passo de tempo \nexplicito para as malhas de 2004 (a) e 10.201 B (b) n\u00f3s. .................................................... 68 \n \nFigura 4.7 \u2013 Curvas de \u00f3leo recuperado para malhas de 2021 (a) e 10.448 (b) n\u00f3s. ........... 70 \n\n\n\nxii \n\nFigura 4.8 \u2013 Curvas de produ\u00e7\u00e3o acumulada para malhas de 2021 (a) e 10.448 (b) n\u00f3s. ... 71 \n \nFigura 4.9 \u2013 Amplia\u00e7\u00e3o das curvas de \u00f3leo recuperado para o instante onde a \u00e1gua chega \nao po\u00e7o produtor. ................................................................................................................. 72 \n \nFigura 4.10 \u2013 Amplia\u00e7\u00e3o das curvas de \u00f3leo acumulado. ................................................... 73 \n \nFigura 4.11 \u2013 Rela\u00e7\u00e3o entre o tamanho do passo de tempo impl\u00edcito pelo passo de tempo \nexpl\u00edcito para uma malha de 2021 (a) e 10.448 (b) n\u00f3s respectivamente. ........................... 74 \n \nFigura 4.12 \u2013 Rela\u00e7\u00e3o entre o tempo total de CPU e a acur\u00e1cia dos resultados para v\u00e1rios \nDVTOL. \u00c9 tomada como refer\u00eancia a curva de \u00f3leo acumulado do m\u00e9todo IMPES \ntradicional. Apenas para a malha de 10.448 n\u00f3s com meio heterog\u00eaneo ............................ 75 \n \nFigura 5.1 \u2013 Taxonomia de importantes classes de computadores paralelos e distribu\u00eddos.\n ............................................................................................................................................. 77 \n \nFigura 5.2 \u2013 Exemplo de uma malha 3-D de tetraedros particionada entre 5 processadores. \n\u00c0 esquerda (a), o particionamento considera apenas o balan\u00e7o em termos do n\u00famero de \nelementos, ou seja, cada processador tem basicamente a mesma quantidade de elementos. \nA direita (b), particionamento otimizado baseado no ParMetis onde o n\u00famero de entidades \ncom c\u00f3pias remotas \u00e9 reduzido significativamente. ............................................................ 87 \n \nFigura 5.3 \u2013 Diagrama de classes para mEntity. .................................................................. 91 \n \nFigura 5.4 \u2013 Malha 2-D distribu\u00edda entre tr\u00eas processadores. A malha com a numera\u00e7\u00e3o \nglobal inicial dos n\u00f3s (a) gera uma troca maior de informa\u00e7\u00f5es entre processadores. A \nmalha com os n\u00f3s renumerados (b) permite que a maior parte das equa\u00e7\u00f5es referente a \ncada n\u00f3 seja montada localmente, aumentando assim, a efici\u00eancia na montagem da matriz.\n ............................................................................................................................................. 93 \n \nFigura 5.5 \u2013 Poss\u00edvel \u00e1rvore de decis\u00f5es na escolha do m\u00e9todo iterativo para problemas de \ngrande porte e n\u00e3o deve ser tratada como uma regra \u00fanica. ................................................ 97 \n \nFigura 5.6 \u2013 Diagrama de classes ManagerData. .............................................................. 102 \n \nFigura 5.7 \u2013 Parti\u00e7\u00e3o de uma malha mostrando o campo de satura\u00e7\u00e3o de \u00e1gua em um dado \ninstante da simula\u00e7\u00e3o. ........................................................................................................ 104 \n \nFigura 5.8 \u2013 Malha de tri\u00e2ngulos distribu\u00eddos entre tr\u00eas processos destacando pelas linhas \ntracejadas n\u00f3s com c\u00f3pias remotas. ................................................................................... 104 \n \nFigura 5.9 \u2013 Vetor distribu\u00eddo entre tr\u00eas processos acumulando a contribui\u00e7\u00e3o local de uma \npropriedade escalar (fluxo) associada aos n\u00f3s remotos de uma malha de tri\u00e2ngulos. ....... 105 \n \nFigura 5.10 \u2013 Compara\u00e7\u00e3o entre as curvas de speed-up ideal e real para a malha de 150.725 \nn\u00f3s. ..................................................................................................................................... 109 \n \nFigura 5.11 \u2013 Redu\u00e7\u00e3o do tempo m\u00e9dio de execu\u00e7\u00e3o por passo de tempo para a malha de \n150.725 n\u00f3s. ....................................................................................................................... 109 \n\n\n\nxiii \n\nFigura 5.12 \u2013 Compara\u00e7\u00e3o entre as curvas de speed-up ideal e real para a malha de 589.487 \nn\u00f3s. ..................................................................................................................................... 110 \n \nFigura 5.13 \u2013 Redu\u00e7\u00e3o do tempo m\u00e9dio de execu\u00e7\u00e3o por passo de tempo para a malha de \n589.487 n\u00f3s. ....................................................................................................................... 110 \n \nFigura 5.14 \u2013 Compara\u00e7\u00e3o das curvas de efici\u00eancia para duas malhas. ............................ 111 \n \nFigura 5.15 \u2013 Compara\u00e7\u00e3o entre curvas de speed-up para o um mesmo problema tratado \ncom malhas de tamanhos diferentes. ................................................................................. 112 \n \n \n\n\n\nxiv \n\nLISTA DE TABELAS \n \nTabela 3.1 \u2013 Solu\u00e7\u00e3o num\u00e9rica da equa\u00e7\u00e3o el\u00edptica em um meio homog\u00eaneo e isotr\u00f3pico. \nErros e taxa de converg\u00eancia rates para: a) CVFA; b) EBFV1; c) EBFV2. ........................ 45 \n \nTabela 3.2\u2013 Solu\u00e7\u00e3o num\u00e9rica da equa\u00e7\u00e3o el\u00edptica em um meio homog\u00eaneo e anisotr\u00f3pico. \nErros e taxas de converg\u00eancias para: a) FCFV; b) EBFV1; c) EBFV2. .............................. 46 \n \nTabela 3.3 \u2013 Solu\u00e7\u00e3o num\u00e9rica da equa\u00e7\u00e3o el\u00edptica em um meio anisotr\u00f3pico com \ncoeficiente de difus\u00e3o descont\u00ednuo 1.0? = . Erros e taxas de converg\u00eancias para: a) FCFV; \nb) EBFV1; c) EBFV2. ......................................................................................................... 49 \n \nTabela 3.4\u2013 Solu\u00e7\u00e3o num\u00e9rica da equa\u00e7\u00e3o el\u00edptica em um meio anisotr\u00f3pico com \ncoeficiente de difus\u00e3o descont\u00ednuo 10.0? = . Erros e taxas de converg\u00eancias para: a) FCFV; \nb) EBFV1; c) EBFV2. ......................................................................................................... 49 \n \nTabela 3.5\u2013 Solu\u00e7\u00e3o num\u00e9rica da equa\u00e7\u00e3o el\u00edptica em um meio anisotr\u00f3pico com \ncoeficiente de difus\u00e3o descont\u00ednuo 100.0? = . Erros e taxas de converg\u00eancias para: a) \nFCFV; b) EBFV1; c) EBFV2. ............................................................................................. 49 \n \nTabela 3.6 \u2013 Solu\u00e7\u00e3o num\u00e9rica da equa\u00e7\u00e3o el\u00edptica em um meio anisotr\u00f3pico com \ncoeficiente de difus\u00e3o descont\u00ednuo 1000.0? = . Erros e taxas de converg\u00eancias para: a) \nFCFV; b) EBFV1; c) EBFV2. ............................................................................................. 50 \n \nTabela 5.1 \u2013 Exemplos de solvers e pr\u00e9-condicionadores dispon\u00edveis no PETSc. .............. 92 \n \nTabela 5.2 \u2013 Malha com 150.725 n\u00f3s. ............................................................................... 108 \n \nTabela 5.3 \u2013 Malha com 589.487 n\u00f3s. ............................................................................... 108 \n \nTabela 5.4 \u2013 Tempo, em segundos, consumido por v\u00e1rios est\u00e1gios a cada passo de tempo \nda simula\u00e7\u00e3o para a malha de 589.487 n\u00f3s ........................................................................ 113 \n \n\n\n\n15 \n\n1. INTRODU\u00c7\u00c3O \n \n\n1.1 Motiva\u00e7\u00e3o e Considera\u00e7\u00f5es Gerais \n \n O crescimento econ\u00f4mico de qualquer pa\u00eds do mundo est\u00e1 intimamente ligado ao \n\naumento do consumo de energia. Apesar dos constantes apelos de organiza\u00e7\u00f5es ambientais \n\npela redu\u00e7\u00e3o da emiss\u00e3o de gases que causam o efeito estufa, o uso de combust\u00edveis f\u00f3s-\n\nseis, em particular o petr\u00f3leo, ainda \u00e9 a principal fonte de energia de muitos pa\u00edses. A de-\n\nmanda por petr\u00f3leo e g\u00e1s natural no mundo se acentuou nas \u00faltimas d\u00e9cadas com o cresci-\n\nmento econ\u00f4mico dos chamados pa\u00edses emergentes, entre eles o Brasil. \n\n A produ\u00e7\u00e3o de hidrocarbonetos exigida pelo mercado depende do conhecimento de \n\ncomo o reservat\u00f3rio de petr\u00f3leo se comporta ao longo de sua vida produtiva. Um conheci-\n\nmento mais detalhado das caracter\u00edsticas f\u00edsicas e geol\u00f3gicas do mesmo implica em uma \n\nmaior confiabilidade nas previs\u00f5es do seu comportamento e na otimiza\u00e7\u00e3o das an\u00e1lises de \n\nviabilidade econ\u00f4mica. \n\n A simula\u00e7\u00e3o num\u00e9rica de reservat\u00f3rios aparece como um instrumento de previs\u00e3o \n\nmais detalhada por permitir o estudo de modelos de reservat\u00f3rios mais complexos envol-\n\nvendo, por exemplo, falhas geol\u00f3gicas, varia\u00e7\u00f5es t\u00e9rmicas, rea\u00e7\u00f5es qu\u00edmicas e a presen\u00e7a \n\nde v\u00e1rias fases e de v\u00e1rios componentes. Dessa forma, pode-se definir a melhor estrat\u00e9gia \n\nde produ\u00e7\u00e3o economizando recursos e maximizando os lucros da empresa petrol\u00edfera. Ou-\n\ntras t\u00e9cnicas, por sua vez, mais simples de serem empregadas s\u00e3o o m\u00e9todo baseado na e-\n\nqua\u00e7\u00e3o de balan\u00e7o de materiais, restrito a poucos casos, e a an\u00e1lise de curvas de decl\u00ednio, \n\nlargamente empregada, por exemplo, em casos onde h\u00e1 uma escassez de dados (Rosa et al., \n\n2006).  \n\n Por permitir uma analise mais detalhada do campo em estudo, a simula\u00e7\u00e3o de re-\n\nservat\u00f3rios, pode trazer diversas vantagens como: \n\n \n\n\u2022 Fazer estimativas de reservas; \n\n\u2022 Minimizar incertezas; \n\n\u2022 Avaliar a efic\u00e1cia de m\u00e9todos de recupera\u00e7\u00e3o secund\u00e1ria e escolher a melhor t\u00e9cni-\n\nca de produ\u00e7\u00e3o e a que taxa; \n\n\u2022 Otimizar as estrat\u00e9gias de drenagem definindo quantos e onde os po\u00e7os devem ser \n\nposicionados ao longo de sua vida produtiva; \n\n\n\n16 \n\n\u2022 Analisar se os hidrocarbonetos devem ser recuperados por deple\u00e7\u00e3o natural ou por \n\nalgum processo de recupera\u00e7\u00e3o melhorada. \n\n \n\n A modelagem matem\u00e1tica de fluxo em meios porosos se baseia, em geral, na equa-\n\n\u00e7\u00e3o de conserva\u00e7\u00e3o da massa e na lei de Darcy cujo resultado \u00e9 um conjunto de equa\u00e7\u00f5es \n\ndiferenciais parciais n\u00e3o-lineares, que na grande maioria das vezes n\u00e3o podem ser resolvi-\n\ndas analiticamente. Um par\u00e2metro de extrema import\u00e2ncia presente nas equa\u00e7\u00f5es de fluxo \n\n\u00e9 a permeabilidade da rocha. Seu conhecimento \u00e9 importante para qualquer explora\u00e7\u00e3o de \n\nreservat\u00f3rios e pode sofrer mudan\u00e7as abruptas de v\u00e1rias ordens de grandeza em um curto \n\nespa\u00e7o e ao longo do tempo (Crumpton et al., 1995; Verma, 1996; Geiger et al., 2004).  \n\n Outra caracter\u00edstica que faz da rocha reservat\u00f3rio um meio poroso complexo de ser \n\nestudado \u00e9 a poss\u00edvel presen\u00e7a de v\u00e1rias camadas sedimentares depositadas de maneias di-\n\nferentes criando dire\u00e7\u00f5es preferenciais ao fluxo de fluidos, fazendo do reservat\u00f3rio um \n\nmeio anisotr\u00f3pico. Al\u00e9m dessas dificuldades, a geometria do reservat\u00f3rio com suas falhas e \n\ncamadas selantes faz o uso dos m\u00e9todos num\u00e9ricos a alternativa mais apropriada para a \n\nobten\u00e7\u00e3o de dados que possam determinar de forma aproximada, por exemplo, a melhor \n\ndistribui\u00e7\u00e3o de po\u00e7os para a produ\u00e7\u00e3o dos hidrocarbonetos. \n\n A id\u00e9ia b\u00e1sica de qualquer m\u00e9todo aproximado \u00e9 substituir o problema original por \n\noutro mais f\u00e1cil de ser resolvido e cuja solu\u00e7\u00e3o \u00e9, de alguma forma, pr\u00f3xima da solu\u00e7\u00e3o do \n\nproblema original (Aziz and Settari, 1979). O m\u00e9todo de diferen\u00e7as finitas surgiu no in\u00edcio \n\nda d\u00e9cada de 1950 e logo foi aplicado ao estudo de fluxo de fluidos em meios porosos. A-\n\ninda hoje \u00e9 bastante usado no meio acad\u00eamico e em v\u00e1rios simuladores num\u00e9ricos comer-\n\nciais (IMEX e ECLIPSE) e livres (BOAST). Tal interesse se deve em parte ao relativo bai-\n\nxo consumo de mem\u00f3ria e utiliza\u00e7\u00e3o de CPU. \n\n O crescimento do poder de processamento dos computadores tem permitido aos \n\nengenheiros simular problemas grandes e complexos de reservat\u00f3rios e aplicar novas t\u00e9c-\n\nnicas de simula\u00e7\u00e3o. Como conseq\u00fc\u00eancia vem tornando-se poss\u00edvel lidar de forma mais a-\n\ncurada com as heterogeneidades, anisotropias e demais caracter\u00edsticas dos processos. Ao \n\nmesmo tempo, engenheiros e cientistas procuram meios de reduzir o custo de simula\u00e7\u00e3o \n\ndesenvolvendo solvers lineares e pr\u00e9-condicionadores mais robustos, t\u00e9cnicas adaptativas e \n\nestruturas de dados alternativas. \n\n O desenvolvimento da capacidade de processamento dos computadores est\u00e1 con-\n\ncentrado em quatro \u00e1reas: velocidade das CPUs, mem\u00f3ria, computa\u00e7\u00e3o paralela e lingua-\n\ngens de programa\u00e7\u00e3o (Cao, 2002). Cada uma delas contribui para o desenvolvimento da \n\n\n\n17 \n\nsimula\u00e7\u00e3o ao seu modo. A velocidade das CPU cresceu 2000 vezes desde a d\u00e9cada de 1970 \n\nat\u00e9 meados da d\u00e9cada de 90 e continua crescendo, por\u00e9m em um ritmo mais lento. O au-\n\nmento na capacidade das mem\u00f3rias saltou de megabyte para gigabytes permitindo realizar \n\nsimula\u00e7\u00f5es maiores e mais completas. A computa\u00e7\u00e3o de alto desempenho \u00e9 alcan\u00e7ada pelo \n\nuso de m\u00faltiplos processadores trabalhando em paralelo na solu\u00e7\u00e3o do mesmo problema. \n\nAs linguagens orientadas a objetos tais como C++ facilitam o projeto e o desenvolvimento \n\nde programas de computador grandes e complexos. O uso de ferramentas modernas torna \n\nos programas mais f\u00e1ceis de serem mantidos. \n\n O desenvolvimento de computadores paralelos tornou poss\u00edvel conduzir simula\u00e7\u00f5es \n\nde grande porte em reservat\u00f3rios de petr\u00f3leo. Na \u00faltima d\u00e9cada, o n\u00famero total de blocos \n\nusados em simula\u00e7\u00f5es t\u00edpicas de reservat\u00f3rio cresceu de milhares para milh\u00f5es (Chen et \n\nal., 2006). A computa\u00e7\u00e3o paralela pode reduzir o tempo de computa\u00e7\u00e3o do c\u00f3digo de simu-\n\nla\u00e7\u00e3o por um fator proporcional ao n\u00famero de processadores, entretanto o desenvolvimento \n\ndo c\u00f3digo se torna mais complexo. \n\n  Uma das mais populares arquiteturas de computa\u00e7\u00e3o paralela \u00e9 a de mem\u00f3ria dis-\n\ntribu\u00edda que pode ser constitu\u00edda de centenas a milhares de processadores, onde cada um \n\npossui uma mem\u00f3ria local e o fluxo de dados independe de outros processadores. Na arqui-\n\ntetura de mem\u00f3ria compartilhada, o mesmo endere\u00e7o global de mem\u00f3ria est\u00e1 dispon\u00edvel \n\npara todos os processadores atrav\u00e9s de um caminho comum. Como n\u00e3o requer passagem \n\nexpl\u00edcita de mensagens entre processadores, o desenvolvimento de aplica\u00e7\u00f5es \u00e9 geralmente \n\nmais f\u00e1cil quando comparada \u00e0 arquitetura de mem\u00f3ria distribu\u00edda. \n\n T\u00e9cnicas de computa\u00e7\u00e3o paralela para simula\u00e7\u00e3o num\u00e9rica de reservat\u00f3rios de pe-\n\ntr\u00f3leo t\u00eam se tornado uma \u00e1rea de grande interesse de pesquisa e da ind\u00fastria. Nos \u00faltimos \n\nanos, companhias petrol\u00edferas, companhias de servi\u00e7o, universidades e institutos de pesqui-\n\nsa t\u00eam empregado t\u00e9cnicas de processamento paralelo para reduzir custos de produ\u00e7\u00e3o e \n\nmelhorar a efici\u00eancia de trabalhos (Han, 2005). \n\n O uso de clusters como um sistema de computadores paralelos foi primeiro desen-\n\nvolvido na d\u00e9cada de 1960 pela IBM como uma alternativa a interconex\u00e3o de grandes ma-\n\ninframes para fornecer uma forma de paralelismo a um custo mais atrativo (Buyya, 1999). \n\nEsses consistem de um conjunto de computadores interconectados trabalhando com um \n\n\u00fanico sistema integrado (Pfister, 1998). \n\n A computa\u00e7\u00e3o com clusters ganhou for\u00e7a com o surgimento de microprocessadores \n\nde alto desempenho, redes de alta velocidade e ferramentas padronizadas para computa\u00e7\u00e3o \n\ndistribu\u00edda de alto desempenho. Os recentes avan\u00e7os nessas tecnologias e suas disponibili-\n\n\n\n18 \n\ndades e baixos pre\u00e7os t\u00eam feito dos clusters uma solu\u00e7\u00e3o muito atrativa para a computa\u00e7\u00e3o \n\nparalela. A tend\u00eancia da computa\u00e7\u00e3o paralela \u00e9 se afastar dos tradicionais supercomputado-\n\nres especializados tais como o Cray/SGI T3E para sistemas mais baratos e de uso geral \n\nconsistindo de PCs de um ou m\u00faltiplos processadores (Yeo et al, 2006), pois permite que \n\nse construa uma plataforma para um dado or\u00e7amento apropriado a um grande grupo de a-\n\nplica\u00e7\u00f5es.  \n\n O surgimento de plataformas de clusters foi conduzido por muitos projetos acad\u00ea-\n\nmicos tais como, Beowulf, Berkeley NOW (Network of Workstations), and HPVM (High \n\nPerformance Virtual Machines) que apresentam as vantagens dos clusters sobre todas as \n\noutras plataformas tradicionais. Essas vantagens incluem obter o alto desempenho de su-\n\npercomputadores a baixo custo, possibilidade de incorporar novas tecnologias em um sis-\n\ntema de f\u00e1cil atualiza\u00e7\u00e3o, uso de plataformas de desenvolvimento de c\u00f3digo aberto e n\u00e3o \n\nrestri\u00e7\u00e3o a um \u00fanico vendedor. Hoje, os clusters s\u00e3o largamente usados em pesquisas e de-\n\nsenvolvimento de aplica\u00e7\u00f5es em ci\u00eancias, engenharias, com\u00e9rcio e ind\u00fastria que deman-\n\ndam computa\u00e7\u00e3o de alto desempenho.  \n\n Os modelos de programa\u00e7\u00e3o paralela em clusters t\u00eam sido tradicionalmente dividi-\n\ndos em categorias baseadas na rela\u00e7\u00e3o de programas com os dados que os programas ope-\n\nram (Flynn, 1972). O modelo SISD (Single-Instruction, Single-Data) que define o tradicio-\n\nnal computador de von Neumann, o modelo MIMD (Multiple-Instruction, Multiple-Data) \n\nque inclui a maioria dos clusters de hoje. Os modelos SIMD (Single-Instruction, Multiple-\n\nData) e MISD (Multiple-instruction, Single-Data) completam a divis\u00e3o. \n\n Em simula\u00e7\u00e3o num\u00e9rica com computadores paralelos, o uso de softwares especiali-\n\nzados torna o desenvolvimento de aplica\u00e7\u00f5es mais r\u00e1pido e menos prop\u00edcio a erros. Muitos \n\ncentros de pesquisas t\u00eam investido no desenvolvimento de ferramentas de alto desempenho \n\npara os mais diversos fins. ParMetis, Jostle e Zoltan aparecem como op\u00e7\u00f5es para distribui-\n\n\u00e7\u00e3o e  balan\u00e7o de carga de malhas discretas. Blas (Basic Linear Algebra Subprograms) e \n\nLAPACK (Linear Algebra PACKage) fornecem rotinas eficientes para problemas de \u00e1lge-\n\nbra linear com vetores e matrizes cheias. O Petsc (Portable, Extensible Toolkit for Scienti-\n\nfic Computation), que faz uso dos dois \u00faltimos, fornece v\u00e1rias op\u00e7\u00f5es de resolvedores (sol-\n\nvers), pr\u00e9-condicionadores e interface de alto n\u00edvel para a manipula\u00e7\u00e3o de matrizes e veto-\n\nres distribu\u00eddos. \n\n Todos esses pacotes trabalham sobre uma API (Application Programming Interfa-\n\nce) que se encarrega do trabalho de envio e recebimento de mensagens entre os computa-\n\n\n\n19 \n\ndores. As interfaces mais conhecidas s\u00e3o: o PVM (Parallel Virtual Machine) e o MPI \n\n(Message Programming Interface), amplamente usado em computa\u00e7\u00e3o paralela. \n\n \n\n1.2 Objetivos e Contribui\u00e7\u00f5es do Presente Trabalho \n\n \n\n No presente trabalho, foi desenvolvido um simulador de reservat\u00f3rios de petr\u00f3leo \n\nem linguagem de programa\u00e7\u00e3o C++ para fluxo bif\u00e1sico \u00f3leo-\u00e1gua em meios porosos hete-\n\nrog\u00eaneos e anisotr\u00f3picos 2-D/3-D usando computadores paralelos de mem\u00f3ria distribu\u00edda. \n\n A contribui\u00e7\u00e3o deste trabalho se d\u00e1 como continua\u00e7\u00e3o do trabalho efetuado por \n\nCarvalho (Carvalho, 2005) onde uma formula\u00e7\u00e3o conservativa de volumes finitos foi de-\n\nsenvolvida para resolver as equa\u00e7\u00f5es diferenciais parciais que surgem da modelagem do \n\nescoamento de fluidos em meios porosos. Nesta formula\u00e7\u00e3o, baseada em uma estrutura de \n\ndados por aresta, os volumes de controle, obtidos pelo m\u00e9todo das medianas, s\u00e3o centrados \n\nnos v\u00e9rtices da malha primal e outros coeficientes geom\u00e9tricos da formula\u00e7\u00e3o est\u00e3o associ-\n\nados \u00e0s arestas e \u00e0s faces (no caso 3-D) da malha primal. \n\n O objetivo principal foi migrar do ambiente MATLAB, onde todo o estudo de Car-\n\nvalho foi desenvolvido, para um ambiente que permitisse construir um simulador capaz de \n\nlidar com problemas de grande porte em computadores paralelos de mem\u00f3ria distribu\u00edda e \n\nque t\u00e9cnicas de alto desempenho pudessem ser aplicadas de uma forma mais eficaz. Tal \n\nambiente foi criado em linguagem C++ seguindo os paradigmas da programa\u00e7\u00e3o orientada \n\na objetos, tendo assim, um programa mais f\u00e1cil de ser administrado e modificado. \n\n Como t\u00e9cnicas de alto desempenho adotadas, podem-se citar alguns como o uso da \n\nestrutura de dados por aresta que oferece ganhos computacionais significativos em termos \n\nde uso de mem\u00f3ria e uso de CPU (L\u00f6hner, 1994), (Lyra, 1994), (L\u00f6hner, 2001), (Rees, \n\n2004), (Lewis e Malan, 2005). Uso de uma linguagem compilada como o C++ que oferece \n\num ganho substancial de uso de CPU comparado a uma linguagem interpretada como o \n\nMATLAB. A aplica\u00e7\u00e3o do m\u00e9todo IMPES (Implicit Pressure Explicit Saturation) adaptati-\n\nvo, explorado no presente trabalho, tende a reduzir o tempo total de simula\u00e7\u00e3o reduzindo o \n\nn\u00famero de c\u00e1lculos a cada passo de tempo. O uso de computadores paralelos com mem\u00f3ria \n\ndistribu\u00edda permite dividir o trabalho em dois ou mais sub-trabalhos entre os processadores \n\nenvolvidos reduzindo ainda mais o tempo de simula\u00e7\u00e3o. \n\n Ao longo deste trabalho, tamb\u00e9m foi desenvolvida outra formula\u00e7\u00e3o de volumes \n\nfinitos, com volumes de controle definidos sobre uma malha dual e que \u00e9 an\u00e1loga ao tradi-\n\n\n\n20 \n\ncional m\u00e9todo de volumes finitos baseado em elementos (CVFEM). Essa formula\u00e7\u00e3o foi \n\ndesenvolvida apenas para casos 2-D e seu c\u00f3digo paralelizado para resolver apenas pro-\n\nblemas el\u00edpticos. Essa formula\u00e7\u00e3o possibilita tratar problemas em meios porosos altamente \n\nheterog\u00eaneos e exige muito menos opera\u00e7\u00f5es de ponto flutuante para a montagem do sis-\n\ntema de equa\u00e7\u00f5es.  \n\n Uma ferramenta de grande import\u00e2ncia que marcou o in\u00edcio deste trabalho foi o de-\n\nsenvolvimento de um pr\u00e9-processador paralelo 2-D/3-D para malhas n\u00e3o-estruturadas. As \n\ninforma\u00e7\u00f5es produzidas por esta ferramenta podem ser armazenadas em arquivos e usadas \n\nem sucessivas simula\u00e7\u00f5es mudando apenas as vari\u00e1veis de entrada do problema. O pr\u00e9-\n\nprocessador paralelo traz a vantagem de economizar tempo de processamento e comunica-\n\n\u00e7\u00e3o entre processadores em casos de simula\u00e7\u00f5es de grande porte. \n\n Vale ainda mencionar que, em paralelo ao trabalho aqui desenvolvido, foi tamb\u00e9m \n\nconstru\u00edda, na mesma filosofia do simulador, uma ferramenta para adapta\u00e7\u00e3o de malhas 2-\n\nD para problemas seriais (um processador apenas) envolvendo outros membros do grupo \n\nde trabalho (PADMEC) ao qual pertencem os professores orientadores. Esta ferramenta de \n\nadapta\u00e7\u00e3o de malhas, cujo trabalho est\u00e1 em andamento, ser\u00e1 estendida ainda para proble-\n\nmas envolvendo malhas 3-D em m\u00faltiplos processadores. \n\n \n\n1.3 Organiza\u00e7\u00e3o Geral da Tese \n\n \n\n O presente texto foi dividido em sete cap\u00edtulos mais a bibliografia e uma lista de \n\ntr\u00eas ap\u00eandices. \n\n No presente cap\u00edtulo, uma introdu\u00e7\u00e3o \u00e9 feita visando contextualizar os temas abor-\n\ndados no trabalho, mostrando de forma sucinta a import\u00e2ncia da simula\u00e7\u00e3o num\u00e9rica e do \n\nuso da computa\u00e7\u00e3o de alto desempenho no estudo da explora\u00e7\u00e3o de reservat\u00f3rios de petr\u00f3-\n\nleo, assim como os principais objetivos e contribui\u00e7\u00f5es da tese. \n\n No cap\u00edtulo dois, s\u00e3o apresentadas as equa\u00e7\u00f5es que descrevem o fluxo bif\u00e1sico de \n\n\u00e1gua e \u00f3leo em meios porosos. \n\n No cap\u00edtulo tr\u00eas, o m\u00e9todo dos volumes finitos por aresta (MVFA) em malhas n\u00e3o-\n\nestruturadas \u00e9 descrito resumidamente, incluindo a discretiza\u00e7\u00e3o conservativa de termos \n\nel\u00edpticos em meios heterog\u00eaneos e anisotr\u00f3picos. Esta formula\u00e7\u00e3o \u00e9 comparada com outra \n\nformula\u00e7\u00e3o an\u00e1loga ao CVFEM e que foi desenvolvida durante o trabalho e descrita em \n\ndetalhes no ap\u00eandice A. Neste cap\u00edtulo, s\u00e3o comparados acur\u00e1cia e taxa de converg\u00eancia \n\n\n\n21 \n\nentre ambas e resultados anal\u00edticos e num\u00e9ricos de problemas modelos (benchmarks) en-\n\ncontrados na literatura. \n\n No cap\u00edtulo quatro, \u00e9 introduzido o m\u00e9todo IMPES e sua variante adaptativa no \n\ncontexto da computa\u00e7\u00e3o de alto desempenho. Resultados de acur\u00e1cia e desempenho s\u00e3o \n\nconfrontados entre os dois m\u00e9todos. Tamb\u00e9m \u00e9 apresentado, por\u00e9m de forma muito breve, \n\nos m\u00e9todos Seq\u00fcencial Impl\u00edcito e Totalmente Impl\u00edcito que n\u00e3o foram explorados neste \n\ntrabalho. \n\n No cap\u00edtulo cinco, \u00e9 descrita em detalhes a paraleliza\u00e7\u00e3o do c\u00f3digo do simulador, o \n\nuso da programa\u00e7\u00e3o orientada a objetos, o uso dos pacotes de c\u00f3digo aberto pelo programa. \n\nPor fim s\u00e3o apresentadas an\u00e1lises de desempenho paralelo. \n\n No cap\u00edtulo seis, s\u00e3o relatadas as principais conclus\u00f5es, onde as contribui\u00e7\u00f5es do \n\ntrabalho s\u00e3o listadas e s\u00e3o indicadas as dire\u00e7\u00f5es para futuras pesquisas. \n\n No ap\u00eandice A, s\u00e3o apresentados os passos de discretiza\u00e7\u00e3o da equa\u00e7\u00e3o de difus\u00e3o \n\nbaseado na formula\u00e7\u00e3o EBFV2. Os passos mostram, para uma malha 2-D de tr\u00eas elemen-\n\ntos, como a matriz global \u00e9 montada por arestas. \n\n Por fim, \u00e9 apresentada a bibliografia utilizada durante o desenvolvimento do pre-\n\nsente trabalho \n\n\n\n22 \n\n2. EQUA\u00c7\u00d5ES GOVERNANTES \n\n \n\n2.1 Introdu\u00e7\u00e3o \n\n \n\n As equa\u00e7\u00f5es fundamentais que regem o problema relacionado ao escoamento bif\u00e1-\n\nsico \u00f3leo-\u00e1gua em meios porosos s\u00e3o abordadas neste cap\u00edtulo apresentando as formula-\n\n\u00e7\u00f5es mais gerais para o escoamento no interior de rochas. \n\n As equa\u00e7\u00f5es diferenciais parciais (EDPs) resultantes da modelagem matem\u00e1tica do \n\nfluxo de massa podem ser classificadas como: parab\u00f3licas, hiperb\u00f3licas ou el\u00edpticas (Tan-\n\nnehill et al., 1997; Fortuna, 2000). Esta classifica\u00e7\u00e3o junto com o conhecimento das pro-\n\npriedades f\u00edsicas e matem\u00e1ticas das equa\u00e7\u00f5es tratadas aqui \u00e9 de grande import\u00e2ncia para \n\nconstruir esquemas num\u00e9ricos eficientes e acurados. \n\n A interpreta\u00e7\u00e3o f\u00edsica destas equa\u00e7\u00f5es pode levar a outra classifica\u00e7\u00e3o: difus\u00e3o, ad-\n\nvec\u00e7\u00e3o ou advec\u00e7\u00e3o-difus\u00e3o (Crank, 1973; Fortuna, 2000). \n\n As equa\u00e7\u00f5es de difus\u00e3o est\u00e3o associadas a diversos problemas f\u00edsicos em que efei-\n\ntos dissipativos s\u00e3o importantes, tais como, problemas de condu\u00e7\u00e3o de calor em s\u00f3lidos e \n\ndetermina\u00e7\u00e3o do campo de press\u00f5es em escoamentos mono ou multif\u00e1sicos. \n\n As equa\u00e7\u00f5es de advec\u00e7\u00e3o ou convec\u00e7\u00e3o est\u00e3o associadas a problemas de transporte \n\nde ondas idealizados sem amortecimento, caracter\u00edstico, por exemplo, da din\u00e2mica dos ga-\n\nses. \n\n As equa\u00e7\u00f5es de advec\u00e7\u00e3o-difus\u00e3o envolvem o transporte de informa\u00e7\u00e3o com amor-\n\ntecimento estando presentes no estudo de uma ampla gama de problemas que v\u00e3o desde \n\nproblemas da biomec\u00e2nica computacional ao transporte de contaminantes em meios poro-\n\nsos. De maneira geral, pode-se fazer a seguinte associa\u00e7\u00e3o: \n\n \n\nTipo de Equa\u00e7\u00e3o Problema F\u00edsico \n\nEl\u00edpticas e parab\u00f3licas Difus\u00e3o \n\nHiperb\u00f3licas Convec\u00e7\u00e3o ou Advec\u00e7\u00e3o \n\nCar\u00e1ter parab\u00f3lico \nAdvec\u00e7\u00e3o-Difus\u00e3o \n\n(difusivo dominante) \n\nCar\u00e1ter hiperb\u00f3lico \nAdvec\u00e7\u00e3o-Difus\u00e3o \n\n(advectivo dominante) \n\n\n\n23 \n\n Maiores detalhes sobre a classifica\u00e7\u00e3o das EDPs podem ser encontrados nos traba-\n\nlhos de Hirsch (1988), Lyra (1994), Tannehill et al. (1997) e Fortuna (2000). \n\n \n\n2.2 Escoamentos Bif\u00e1sicos e Imisc\u00edveis em Meios Porosos \n\n \n\n2.2.1 Conceitos Fundamentais \n\n \n\n As equa\u00e7\u00f5es que modelam os escoamentos bif\u00e1sicos \u00f3leo-\u00e1gua em meios porosos \n\ns\u00e3o baseadas, em geral, na equa\u00e7\u00e3o da continuidade (equa\u00e7\u00e3o diferencial de conserva\u00e7\u00e3o \n\nda massa) e na equa\u00e7\u00e3o de momento. A equa\u00e7\u00e3o de momento empregada no escoamento \n\nem meios porosos \u00e9 conhecida como Lei de Darcy. Essa lei, obtida experimentalmente pela \n\nprimeira vez por Henry Darcy em 1856, pode ser vista como uma lei experimental, cujo \n\ndom\u00ednio de validade se restringe a escoamentos laminares em meios porosos r\u00edgidos (bear, \n\n1972; Helmig, 1997). \n\n O resultado dessa modelagem matem\u00e1tica \u00e9 um conjunto de equa\u00e7\u00f5es diferenciais \n\nparciais n\u00e3o-lineares devido \u00e0 depend\u00eancia que as propriedades f\u00edsicas presente nas equa-\n\n\u00e7\u00f5es como permeabilidade relativa da rocha e viscosidade e densidade dos fluidos t\u00eam com \n\na satura\u00e7\u00e3o e a press\u00e3o das fases. \n\n Essas equa\u00e7\u00f5es podem ser resolvidas de forma simult\u00e2nea, onde a Lei de Darcy \u00e9 \n\nsubstitu\u00edda diretamente na equa\u00e7\u00e3o de conserva\u00e7\u00e3o de massa para cada fase produzindo um \n\nconjunto de EDPs parab\u00f3licas, ou de forma segregada, onde a equa\u00e7\u00e3o de press\u00e3o, de car\u00e1-\n\nter parab\u00f3lico quase el\u00edptico, \u00e9 resolvida separada da equa\u00e7\u00e3o de satura\u00e7\u00e3o, uma equa\u00e7\u00e3o \n\nde advec\u00e7\u00e3o-difus\u00e3o, n\u00e3o-linear, de car\u00e1ter parab\u00f3lico quase hiperb\u00f3lico. O acoplamento \n\nentre estas equa\u00e7\u00f5es \u00e9 feito atrav\u00e9s de um termo de velocidade total ou de fluxo total de-\n\npendendo de como s\u00e3o escritas estas equa\u00e7\u00f5es. \n\n No presente trabalho, ser\u00e1 apresentada detalhadamente a formula\u00e7\u00e3o segregada \n\nproposta inicialmente por Peaceman (1977) para o escoamento imisc\u00edvel de \u00f3leo e \u00e1gua em \n\nreservat\u00f3rios de petr\u00f3leo.  \n\n Antes de definir as equa\u00e7\u00f5es, s\u00e3o adotadas algumas hip\u00f3teses simplificadoras: \n\n \n\n\u2022 O meio poroso est\u00e1 totalmente saturado pelas fases l\u00edquidas; \n\n\u2022 O fluido e a rocha s\u00e3o incompress\u00edveis; \n\n\n\n24 \n\n\u2022 Escoamento imisc\u00edvel; \n\n\u2022 Escoamento isot\u00e9rmico; \n\n\u2022 Os fluidos obedecem \u00e0 lei de Darcy generalizada (Helmig, 1997); \n\n \n\n Considerando as hip\u00f3teses simplificadoras acima, a Lei de Darcy generalizada para \n\numa fase i pode ser escrita conforme a seguir: \n\n \n\n ( ).i i i iv K p g Z? ?= ? ? ? ?\n?\n\n?\n (2.1) \n\n \n\n Na Eq. (2.1), iv  \u00e9 a velocidade aparente da fase i, K\n?\n\n \u00e9 o tensor de permeabilidade \n\nabsoluta do meio, representando uma propriedade apenas da rocha, assim como a porosi-\n\ndade que representa a raz\u00e3o entre o volume de vazios que pode ser ocupado por um fluido \n\ne o volume total da rocha, ip  \u00e9 a press\u00e3o da fase i, i?  \u00e9 a massa espec\u00edfica ou a \u201cdensida-\n\nde\u201d da fase i, g \u00e9 o m\u00f3dulo da acelera\u00e7\u00e3o gravitacional, Z \u00e9 o componente do vetor deslo-\n\ncamento orientado para baixo e i ri ik? \u00b5=  \u00e9 a mobilidade da fase i, onde rik  e i\u00b5  s\u00e3o a \n\npermeabilidade relativa e a viscosidade da fase i, respectivamente. O tensor de permeabili-\n\ndade absoluta do meio poroso K\n?\n\n \u00e9 definido em coordenadas cartesianas como: \n\n \n\n.\nxx xy xz\n\nyx yy yz\n\nzx zy zz\n\nK K K\n\nK K K K\n\nK K K\n\n? ?\n? ?\n\n= ? ?\n? ?\n? ?\n\n?\n (2.2) \n\n \n\n Por sua vez, a equa\u00e7\u00e3o de conserva\u00e7\u00e3o da massa para cada uma das fases, pode ser \n\nescrita como (Bear 1972; Helmig, 1997; Kovarik, 2000): \n\n \n\n ( )\n( )\n\n.i ii i i\nS\n\nv q\nt\n\n??\n?\n\n?\n?? ? + =\n\n?\n\n?\n (2.3) \n\n \n\n Na Equa\u00e7\u00e3o (2.3), ?  \u00e9 a porosidade, iq  denota termos fonte ou sumidouros (i.e., \n\npo\u00e7os), e iS \u00e9 a satura\u00e7\u00e3o da fase i, que representa a percentagem do volume poroso ocupa-\n\ndo por esta fase. Pela primeira hip\u00f3tese simplificadora adotada, pode-se escrever a equa\u00e7\u00e3o \n\nconstitutiva ou de restri\u00e7\u00e3o das satura\u00e7\u00f5es, como: \n\n\n\n25 \n\n \n,\n\n1i\ni o w\n\nS\n=\n\n=?  ou ainda 1,o wS S+ =  (2.4) \n\n \n\nonde o, w representam, respectivamente, \u00f3leo e \u00e1gua. \n\n A press\u00e3o capilar \u00e9 definida como a diferen\u00e7a entre as press\u00f5es das fases n\u00e3o-\n\nmolhante (\u00f3leo) pela molhante (\u00e1gua), ou seja: \n\n \n\n .c o wp p p= ?  (2.5) \n\n \n\n A press\u00e3o capilar existe sempre que os poros est\u00e3o saturados com duas ou mais fa-\n\nses. Ela \u00e9 uma fun\u00e7\u00e3o da satura\u00e7\u00e3o ( )c c wp p S=  e do hist\u00f3rico de satura\u00e7\u00e3o (drenagem e \n\nembebi\u00e7\u00e3o) para uma dada rocha e fluidos a uma temperatura e composi\u00e7\u00e3o constante. \n\nDois modelos emp\u00edricos cl\u00e1ssicos utilizados para relacionar press\u00e3o capilar e satura\u00e7\u00e3o da \n\n\u00e1gua s\u00e3o o modelo de Brooks e Corey, Eq.(2.6), e o modelo de Van Genuchten, Eq. (2.7). \n\n \n\n ( )\n\n1\n\n,\n1\n\nw wr\nc w d\n\nwr\n\nS S\np S p\n\nS\n\n?\n?\n\n? ??\n= ? ?\n\n?? ?\n  (2.6)  \n\n \n\n ( )\n\n1\n1\n\n1\n1 ,\n\n1\n\nn\nm\n\nw wr\nc w\n\nwr\n\nS S\np S\n\nS?\n\n?? ?\n? ??? ?= ?? ?? ??? ?? ?? ?\n\n (2.7)  \n\n \n\nonde wrS  \u00e9 a satura\u00e7\u00e3o residual da \u00e1gua. Para maiores detalhes sobre ambos os modelos, e \n\nparticularmente sobre os coeficientes emp\u00edricos ,dp  , , m? ?  e n , consultar Helmig \n\n(1997). \n\n \n\n2.2.2 Equa\u00e7\u00e3o de Press\u00e3o \n\n \n\n Eliminando as derivadas da satura\u00e7\u00e3o da Eq (2.3), obt\u00e9m-se a equa\u00e7\u00e3o da press\u00e3o \n\nde modo a resolver uma equa\u00e7\u00e3o diferencial parcial com apenas uma vari\u00e1vel. Partindo da \n\nEq (2.3), escrita para cada fase i = o, w e expandindo as derivadas no tempo fica: \n\n \n\n\n\n26 \n\n ( ) ,oo o o o o o\nS\n\nv q S\nt t\n\n?\n? ? ??\n\n??\n?? ? + = +\n\n? ?\n\n?\n  (2.8) \n\n \n\n ( ) .ww w w w w w\nS\n\nv q S\nt t\n\n?\n? ? ??\n\n??\n?? ? + = +\n\n? ?\n\n?\n (2.9) \n\n \n\n Onde o?  e w? s\u00e3o constantes uma vez que os fluidos foram considerados incom-\n\npress\u00edveis. Dividindo a Eq. (2.8) por o? , e a Eq. (2.9) por w? , e utilizando a segunda hip\u00f3-\n\ntese simplificadora, isto \u00e9, fluido e rocha s\u00e3o incompress\u00edveis: \n\n \n\n ,oo o\nS\n\nv Q\nt\n\n?\n?\n\n?? ? + =\n?\n\n?\n (2.10) \n\n \n\n ,ww w\nS\n\nv Q\nt\n\n?\n?\n\n?? ? + =\n?\n\n?\n (2.11) \n\n \n\nOnde i i iQ q ?=  \u00e9 a vaz\u00e3o volum\u00e9trica espec\u00edfica da fase i. Somando as Eqs. (2.10) e \n\n(2.11), obt\u00e9m-se: \n\n \n\n ( ) ( ) ,o wo w o w\nS S\n\nv v Q Q\nt t\n\n?\n? ?? ?\n\n?? ? + + + = +? ?\n? ?? ?\n\n? ?\n  (2.12) \n\nou ainda: \n\n \n\n ( ) ( )\n( )\n\n.o wo w o w\nS S\n\nv v Q Q\nt\n\n?\n? +\n\n?? ? + + + =\n?\n\n? ?\n  (2.13) \n\n \n\n Usando a Eq. (2.4), e rearranjando os termos, obt\u00e9m-se em termos da velocidade total: \n\n \n\n .v Q? ? =\n?\n\n (2.14) \n\n \n\n Na Eq. (2.14), o wv v v= +\n? ? ?\n\n \u00e9 a velocidade total do fluido e o wQ Q Q= + \u00e9 a vaz\u00e3o vo-\n\nlum\u00e9trica espec\u00edfica total. Agora, a lei de Darcy Eq. (2.1) \u00e9 introduzida na Eq. 2.14 atrav\u00e9s \n\ndo termo de velocidade: \n\n\n\n27 \n\n ( ) ( )( ) .o o o w w wK p g Z K p g Z Q? ? ? ?? ? ? ? ? ? ? ? ? ? =\n? ?\n\n  (2.15) \n\n \n\nDefinindo a press\u00e3o m\u00e9dia das fases como: \n\n \n\n .\n2\n\no w\nm\n\np p\np p\n\n+\n= =   (2.16) \n\n \n\nDa equa\u00e7\u00e3o anterior e da defini\u00e7\u00e3o da press\u00e3o capilar, Eq. (2.5) resulta ainda: \n\n \n\n \n2\n\nc\no\n\np\np p= +  e .\n\n2\nc\n\nw\n\np\np p= ?   (2.17) \n\n \n\nReescrevendo a Eq. (2.15) em fun\u00e7\u00e3o da press\u00e3o m\u00e9dia das fases e da press\u00e3o capilar, fica: \n\n \n\n ( ) .\n2 2\n\nc c\no w o o w w\n\np p\nK p p g Z Q? ? ? ? ? ?\n\n? ?? ?? ? ? ?\n? ? ? ? + + ? ? ? + ? =? ?? ?? ? ? ?\n\n? ? ? ?? ?? ??\n (2.18) \n\n \n\n Rearranjando os termos pode-se escrever: \n\n \n\n ( )\n( )\n\n( ) .\n2\n\no w\no w c o o w wK p p g Z Q\n\n? ?\n? ? ? ? ? ?\n\n? ??? ?\n? ? ? + ? + ? ? + ? =? ?? ?? ?\n\n? ?? ??\n (2.19) \n\n \n\n Como se pode facilmente observar, a equa\u00e7\u00e3o de press\u00e3o, no caso incompress\u00edvel, \u00e9 \n\numa equa\u00e7\u00e3o el\u00edptica ou de difus\u00e3o (Ewing, 1983). Devido \u00e0s heterogeneidades ao longo \n\nde reservat\u00f3rios t\u00edpicos, o coeficiente K\n?\n\n \u00e9, em geral, vari\u00e1vel e n\u00e3o-isotr\u00f3pico (Ewing, \n\n1983; Verma, 1996; Verma e Aziz, 1996; Edwards 2000). Portanto, a equa\u00e7\u00e3o de press\u00e3o, \n\nno caso incompress\u00edvel, \u00e9 uma equa\u00e7\u00e3o el\u00edptica com coeficientes descont\u00ednuos. \n\n A partir da Eq.(2.19), a velocidade total \u00e9 escrita como: \n\n \n\n ( )\n( )\n\n( ) ,\n2\n\no w\no w c o o w wv K p p g Z\n\n? ?\n? ? ? ? ? ?\n\n?? ?\n= ? + ? + ? ? + ?? ?\n\n? ?\n\n?\n\n?\n  (2.20) \n\nou ainda: \n\n \n\n\n\n28 \n\n ( )\n( )\n\n( ) .\n2\n\no w\no w c o o w wv K p K p gK Z\n\n? ?\n? ? ? ? ? ?\n\n?\n= ? + ? ? ? + + ?\n?\n\n? ? ?\n (2.21) \n\n \n\n Na Equa\u00e7\u00e3o (2.21), observam-se tr\u00eas termos compondo a velocidade total do esco-\n\namento, onde estes est\u00e3o relacionados ao gradiente da press\u00e3o m\u00e9dia dos fluidos, ao gradi-\n\nente da press\u00e3o capilar e \u00e0 for\u00e7a gravitacional, respectivamente. \n\n \n\n2.2.3 Equa\u00e7\u00e3o de Satura\u00e7\u00e3o \n\n \n\n Nesta se\u00e7\u00e3o \u00e9 definida a equa\u00e7\u00e3o de satura\u00e7\u00e3o para a fase \u00e1gua. Utilizando a \n\nEq.(2.1), as velocidades das fases \u00e1gua e \u00f3leo podem ser escritas, respectivamente, como: \n\n \n\n ( ) ,w w w wv K p g Z? ?= ? ? ? ?\n?\n\n?\n (2.22) \n\n \n\n ( ).o o o ov K p g Z? ?= ? ? ? ?\n?\n\n?\n (2.23) \n\n \n\n Multiplicando a Eq. (2.22) por o?  e a Eq. (2.23) por w?  obtem-se:  \n\n \n\n ( ) ,o w w o w wv K p g Z? ? ? ?= ? ? ? ?\n?\n\n?\n (2.24) \n\n ( ).w o o w o ov K p g Z? ? ? ?= ? ? ? ?\n?\n\n?\n (2.25) \n\n \n\n Subtraindo a Eq. (2.24) da Eq.(2.25), chega-se a \n\n \n\n ( ).w o o w o w o o w wv v K p g Z p g Z? ? ? ? ? ?? = ? ? ? ? ? ? + ?\n? ?\n\n?\n (2.26) \n\n \n\n Derivando a Eq. (2.5) e usando-a na Eq. (2.26), tem-se: \n\n \n\n ( ) .w o o w o w c o w o wv v K p K g Z? ? ? ? ? ? ? ?? + = + ? ? ? ?\n? ?\n\n? ?\n (2.27) \n\n \n\n Rearranjando os termos e usando ainda que o wv v v= ?\n? ? ?\n\n, e que w o? ? ?= +  pode-se \n\nescrever \n\n\n\n29 \n\n ( )( ).w w o w c w ov v K p g Z? ? ? ? ? ?= + ? + ? ?\n? ?\n\n?\n (2.28) \n\n \n\n Definindo ainda o fluxo fracional de uma fase i como ,i if ? ?=  e para simplificar \n\na nota\u00e7\u00e3o definindo \n( )o w c\n\nw\nw\n\ndp\nh\n\ndS\n\n? ?\n\n?\n= ? , tem-se: \n\n \n\n ( ) .w w w w o w w ov f v Kh S K f g Z? ? ?= ? ? + ? ?\n? ?\n\n? ?\n (2.29) \n\n \n\n Desta forma conseguimos escrever a velocidade da fase \u00e1gua, wv\n?\n\n em fun\u00e7\u00e3o da ve-\n\nlocidade total v\n?\n\n. Substituindo a equa\u00e7\u00e3o anterior na Eq. (2.3), com i = w, e rearranjando os \n\ntermos: \n\n \n\n \n( )\n\n( )( )( ) .w w w w w w o w w o w\nS\n\nf v Kh S K f g Z q\nt\n\n??\n? ? ? ?\n\n?\n= ?? ? ? ? + ? ? +\n\n?\n\n?\n\n? ?\n (2.30) \n\n \n\n Utilizando as hip\u00f3teses de que o meio poroso \u00e9 r\u00edgido e que os fluidos s\u00e3o incom-\n\npress\u00edveis pode-se ainda escrever: \n\n \n\n \n( )\n\n( )( )( ) .ww w w w w o w w o w\nS\n\nf v Kh S K f g Z q\nt\n\n?? ? ? ? ?\n?\n\n= ? ? ? ? ? + ? ? +\n?\n\n?\n\n? ?\n (2.31) \n\n \n\n Finalmente, dividindo por w?  e assumindo que w w wQ q ?=  chega-se a: \n\n \n\n ( )( ) .w w w w o w w o w\nS\n\nf v Kh S K f g Z Q\nt\n\n? ? ? ?\n?\n\n= ?? ? ? ? + ? ? +\n?\n\n?\n\n? ?\n (2.32) \n\n \n\n A Eq. (2.32) \u00e9 conhecida como a equa\u00e7\u00e3o de satura\u00e7\u00e3o da fase \u00e1gua num meio po-\n\nroso r\u00edgido. Esta equa\u00e7\u00e3o \u00e9 similar a uma equa\u00e7\u00e3o de advec\u00e7\u00e3o-difus\u00e3o-rea\u00e7\u00e3o n\u00e3o-linear. \n\nEm muitos casos, como por exemplo, na vizinhan\u00e7a de po\u00e7os de inje\u00e7\u00e3o ou em partes do \n\nreservat\u00f3rio onde o fluido de inje\u00e7\u00e3o ainda n\u00e3o chegou, ou de maneira geral, onde a velo-\n\ncidade total for alta, esta equa\u00e7\u00e3o assume um car\u00e1ter fortemente advectivo, compartilhando \n\nmuitas das propriedades das equa\u00e7\u00f5es hiperb\u00f3licas de primeira ordem (Ewing, 1983; Cha-\n\nvent e Jaffre, 1986). \n\n\n\n30 \n\n2.2.4 Condi\u00e7\u00f5es Iniciais e de Contorno \n\n \n\n As equa\u00e7\u00f5es de press\u00e3o e satura\u00e7\u00e3o apresentadas definem um problema de valor \n\ninicial e de contorno cuja solu\u00e7\u00e3o \u00fanica exige uma descri\u00e7\u00e3o completa do que ocorre nas \n\nfronteiras e como o reservat\u00f3rio se apresenta no in\u00edcio da simula\u00e7\u00e3o. \n\n A seguir, s\u00e3o apresentadas um conjunto de condi\u00e7\u00f5es iniciais e de contorno associ-\n\nadas a um reservat\u00f3rio com po\u00e7os injetores (I) e produtores (P). Usualmente estes po\u00e7os \n\ns\u00e3o tratados como \u201cfronteiras internas\u201d dos reservat\u00f3rios e as condi\u00e7\u00f5es aplicadas a estes \n\npo\u00e7os s\u00e3o chamadas de condi\u00e7\u00f5es de \u201ccontorno internas\u201d (Chavent e Jaffre, 1986; Aziz, \n\n1993; Ertekin et al., 2001). \n\n \n\n Poss\u00edveis condi\u00e7\u00f5es de contorno: \n\n \n\n\u2022 Primeiro tipo (Dirichlet): press\u00e3o \u00e9 especificada nas fronteiras ou nos po\u00e7os; \n\n\u2022 Segundo tipo (Neumann): expressa o fluxo atrav\u00e9s da fronteira e pode ser usada pa-\n\nra especificar taxa de produ\u00e7\u00e3o em po\u00e7os ou influxo de um aq\u00fc\u00edfero,  \n\n\u2022 Terceiro tipo: combina\u00e7\u00e3o dos dois tipos anteriores e podem surgir quando as fron-\n\nteiras de dois reservat\u00f3rios coincidem; \n\n\u2022 Quarto tipo: conhecida como condi\u00e7\u00e3o de contorno c\u00edclica e podem surgir em re-\n\nservat\u00f3rios em forma de anel (Aziz, 1979). \n\n \n\n Para o mesmo reservat\u00f3rio, as condi\u00e7\u00f5es de contorno e inicial para a equa\u00e7\u00e3o de \n\nsatura\u00e7\u00e3o podem ser escritas, respectivamente, como: \n\n \n\n \n( ) [ ]\n\n[ ]\n\n, em 0, ,\n\n0 em 0, .\n\nw w I\n\nw w N\n\nS x t S X T\n\nKh S n X T\n\n= ?\n\n? ? = ?\n\n?\n\n?\n\n?\n\n (2.33) \n\n ( ) 0, 0 em .w wS x S= ?\n?\n\n \n\n \n\n Onde I? e N?  representam as fronteiras de valores de satura\u00e7\u00e3o e a vaz\u00e3o prescrita, \n\nrespectivamente, e n\n?\n\n representa o vetor normal \u00e0s fronteiras do dom\u00ednio ? . \n\n \n\n\n\n31 \n\n3. M\u00c9TODO DE VOLUMES FINITOS POR ARESTA \n\n \n\n3.1 Introdu\u00e7\u00e3o \n\n \n\n A simula\u00e7\u00e3o num\u00e9rica de fluxo de massa em problemas com meio heterog\u00eaneo e \n\nanisotr\u00f3pico representa um grande desafio do ponto de vista matem\u00e1tico e num\u00e9rico. Vari-\n\na\u00e7\u00f5es abruptas no campo de permeabilidade (coeficiente de difus\u00e3o) s\u00e3o comuns em simu-\n\nla\u00e7\u00e3o de escoamento de fluidos em reservat\u00f3rios de petr\u00f3leo e aq\u00fc\u00edferos devido \u00e0 pr\u00f3pria \n\nnatureza do processo de forma\u00e7\u00e3o geol\u00f3gica das rochas sedimentares.  \n\n Nas \u00faltimas d\u00e9cadas, muito esfor\u00e7o foi dedicado em m\u00e9todos num\u00e9ricos que fazem \n\nuso de malhas n\u00e3o-estruturadas, como os tradicionais m\u00e9todos de elementos finitos (MEF) \n\ne m\u00e9todo de volumes finitos (MVF), devido principalmente ao fato de que esses m\u00e9todos \n\npermitem uma melhor modelagem de geometrias complexas e porque permitem uma f\u00e1cil \n\nincorpora\u00e7\u00e3o de procedimentos adaptativos. Ao lidar com leis de conserva\u00e7\u00e3o, os m\u00e9todos \n\nde volumes finitos s\u00e3o particularmente \u00fateis, pois conservam massa localmente (volume de \n\ncontrole) e globalmente. \n\n Os convencionais m\u00e9todos de diferen\u00e7as finitas 2-D de cinco pontos s\u00e3o incapazes \n\nde lidar com tensores cheios ou malhas n\u00e3o-ortogonais. Al\u00e9m disso, esses m\u00e9todos intro-\n\nduzem erros de primeira ordem na aproxima\u00e7\u00e3o dos termos de fluxo entre materiais des-\n\ncont\u00ednuos (Edwards, 2000), tornando-os, assim, inapropriados para simula\u00e7\u00e3o de proble-\n\nmas de difus\u00e3o em meios heterog\u00eaneos e anisotr\u00f3picos. \n\n Esquemas localmente conservativos tais como o m\u00e9todo de elementos finitos base-\n\nado em volumes de controle (CVFEM), o m\u00e9todo de volumes finitos de fluxo cont\u00ednuo \n\n(FCFV) tamb\u00e9m conhecido como Multipoint Flux Approximations (MPFA) e o m\u00e9todo de \n\nelementos finitos mistos (MFEM) foram extensivamente estudados na literatura (Ewing, \n\n1983; Aavatsmark et al., 1998; Edwards, 2000; Klausen e Eigestad, 2004). \n\n No contexto de fluxo de fluidos em meios porosos, o rec\u00e9m desenvolvido FCFV \u00e9 \n\ndefinido assumindo press\u00f5es constantes (pointwise ou continuidade completa) e fluxo \n\nnormal atrav\u00e9s das interfaces dos volumes de controle. Apesar do custo computacional as-\n\nsociado a estes m\u00e9todos, particularmente o MFEM, ambos os m\u00e9todos s\u00e3o capazes de lidar \n\ncom equa\u00e7\u00f5es el\u00edpticas com tensores cheios em meios heterog\u00eaneos usando malhas estru-\n\nturadas ou n\u00e3o-estruturadas. Vale ainda mencionar que o m\u00e9todo de elementos finitos, que \n\n\n\n32 \n\n\u00e9 globalmente conservativo, mas n\u00e3o localmente (no elemento), requer algum tipo de recu-\n\npera\u00e7\u00e3o de fluxo de forma a garantir formalmente conserva\u00e7\u00e3o local (Loula et al. 1999). \n\n Neste trabalho, s\u00e3o descritas duas formula\u00e7\u00f5es de volumes finitos baseadas em uma \n\nestrutura de dados por aresta e centradas nos n\u00f3s. As acur\u00e1cias de ambas as formula\u00e7\u00f5es \n\ns\u00e3o comparada entre si para tratar problemas el\u00edpticos em meios heterog\u00eaneos e anisotr\u00f3pi-\n\ncos, assim como problemas com coeficientes de difus\u00e3o descont\u00ednuos.  \n\n A formula\u00e7\u00e3o EBFV1 (edge-based finite volume 1) foi desenvolvida e validada por \n\nCarvalho (Carvalho, 2005) em v\u00e1rios casos extra\u00eddos da literatura tratando problemas de \n\nescoamento em reservat\u00f3rios de petr\u00f3leo e de dispers\u00e3o de contaminantes em aq\u00fc\u00edferos em \n\nambiente MATLAB. Pela efic\u00e1cia comprovada, esta formula\u00e7\u00e3o foi empregada na constru-\n\n\u00e7\u00e3o do simulador paralelo 2-D/3-D usando programa\u00e7\u00e3o orientada a objetos em C++ para \n\ntratar problemas de grande porte desenvolvido no presente trabalho. A dedu\u00e7\u00e3o da discreti-\n\nza\u00e7\u00e3o das equa\u00e7\u00f5es ser\u00e1 feita de uma forma mais direta. \n\n Como o objetivo deste cap\u00edtulo est\u00e1 voltado \u00e0 avalia\u00e7\u00e3o da acur\u00e1cia apenas de pro-\n\nblemas el\u00edpticos, a discretiza\u00e7\u00e3o do termo advectivo da formula\u00e7\u00e3o EBFV1 ser\u00e1 apresenta-\n\nda no cap\u00edtulo 5, onde o simulador paralelo \u00e9 descrito. \n\n A outra formula\u00e7\u00e3o, EBFV2 (edge-based finite volume 2), foi desenvolvida de \n\nforma a associar a cada elemento da malha uma propriedade f\u00edsica do meio poroso. Isso \n\npermite, por exemplo, tratar problemas que apresentam uma grande varia\u00e7\u00e3o de permeabi-\n\nlidade e porosidade. \n\n O desenvolvimento da formula\u00e7\u00e3o EBFV2, que se apresenta como uma das contri-\n\nbui\u00e7\u00f5es do presente trabalho, se deu quando este simulador encontrava-se em um est\u00e1gio \n\nmuito avan\u00e7ado de desenvolvimento e sua implementa\u00e7\u00e3o resumiu-se apenas a resolu\u00e7\u00e3o \n\nde problemas el\u00edpticos em computadores seq\u00fcencial e paralelo em malhas 2-D de elemen-\n\ntos triangulares. Em trabalhos futuros, esta formula\u00e7\u00e3o ir\u00e1 tratar problemas multif\u00e1sicos 2-\n\nD e 3-D. \n\n Para ambos os m\u00e9todos, s\u00e3o usados volumes de controle constru\u00eddos a partir de \n\numa malha dual (Donald\u2019s dual) obtida a partir dos pontos m\u00e9dios da malha primal, embo-\n\nra isso n\u00e3o seja obrigat\u00f3rio. As formula\u00e7\u00f5es s\u00e3o baseadas em uma estrutura de dados por \n\naresta onde os coeficientes geom\u00e9tricos s\u00e3o associados \u00e0s arestas e aos n\u00f3s da malha pri-\n\nmal. Essas formula\u00e7\u00f5es s\u00e3o capazes de lidar com meios heterog\u00eaneos e anisotr\u00f3picos u-\n\nsando malhas estruturadas ou n\u00e3o-estruturadas. \n\n O primeiro algoritmo, EBFV1, consiste em uma modifica\u00e7\u00e3o da aproxima\u00e7\u00e3o em \n\ndois passos de Crumpton baseada nas arestas. O segundo algoritmo, EBFV2, \u00e9 an\u00e1logo a \n\n\n\n33 \n\numa implementa\u00e7\u00e3o baseada em arestas do m\u00e9todo de elementos finitos usando volumes \n\nde controle (CVFEM). Ambas as formula\u00e7\u00f5es incluem termos de difus\u00e3o cruzada garan-\n\ntindo conserva\u00e7\u00e3o local mesmo para malhas n\u00e3o-ortogonais e coeficientes descont\u00ednuos, \n\nmantendo acur\u00e1cia de segunda ordem para o campo de press\u00e3o, e pelo menos, acur\u00e1cia de \n\nprimeira ordem para os fluxos em malhas triangulares e malhas ortogonais quadrilaterais, \n\npermitindo assim, serem utilizadas tanto na solu\u00e7\u00e3o de problemas el\u00edptico-parab\u00f3licos \n\nquanto hiperb\u00f3licos que s\u00e3o caracter\u00edsticos das leis que regem o fluxo de fluidos em meios \n\nporosos. \n\n Por serem centradas nos n\u00f3s, as formula\u00e7\u00f5es EBFV1 e EBFV2 permitem um menor \n\nuso de mem\u00f3ria quando comparadas a esquemas centrados nos elementos (Luo et al., 1995, \n\nMalan, 2002, Rees, 2004 e Rees et al., 2004). Isso favorece a ado\u00e7\u00e3o de uma estrutura de \n\ndados por aresta, onde uma malha n\u00e3o-estruturada \u00e9 representada pelas arestas dos elemen-\n\ntos e pelos n\u00f3s e suas coordenadas espaciais. Para malhas 3-D, dependendo do tipo de in-\n\ntegra\u00e7\u00e3o no contorno, as arestas s\u00e3o substitu\u00eddas por faces (Carvalho, 2005). \n\n Mostra-se que uma economia significativa de mem\u00f3ria e no n\u00famero de opera\u00e7\u00f5es \n\nde ponto flutuante pode ser alcan\u00e7ada, pois evita que certas redund\u00e2ncias de armazenamen-\n\nto, opera\u00e7\u00f5es de coleta e de distribui\u00e7\u00e3o de dados e opera\u00e7\u00f5es de ponto flutuante ocorram \n\n(Barth, 1994; L\u00f6hner, 1994; L\u00f6hner, 2001). \n\n A escolha de uma estrutura de dados por aresta exige que uma fase de pr\u00e9-\n\nprocessamento seja realizada sobre a malha de elementos obtida atrav\u00e9s do gerador de ma-\n\nlhas. No cap\u00edtulo 5, quando o simulador paralelo for apresentado, esta etapa ser\u00e1 melhor \n\ndescrita. \n\n \n\n3.2 Formula\u00e7\u00e3o Matem\u00e1tica \n\n \n\n No modelo bidimensional, a equa\u00e7\u00e3o que define um problema el\u00edptico em um meio \n\nheterog\u00eaneo e anisotr\u00f3pico pode ser escrita como: \n\n \n\n ( )( ) ( )K x u f x ,? ? ? ? =\n? ?\n\n?\n com ( ) 2,x x y= ? ? ?\n\n?\n?  (3.1) \n\nonde: \n\n \n\n\n\n34 \n\n ( ) .\nxx xy\n\nyx yy\n\nK K\nK x K\n\nK K\n\n? ?\n= = ? ?\n\n? ?\n\n?\n\n? ?\n (3.2) \n\n \n\n\u00e9 uma matriz sim\u00e9trica que pode ser descont\u00ednua nas fronteiras do dom\u00ednio ? . De forma a \n\ndefinir formalmente um problema el\u00edptico (Crumpton, 1995), assume-se inicialmente que: \n\n \n\n 2 .xx yy xyK K K?  (3.3) \n\n \n\nIntegrando a Eq. (3.1) e aplicando o teorema da diverg\u00eancia no lado esquerdo, implica: \n\n \n\n ( ) .K u n f\n? ?\n\n? ? ? ?? = ??? ?\n?\n\n?\n (3.4) \n\n \n\n A Eq. (3.4), que \u00e9 a forma integral da Eq.(3.1), define, por exemplo, o campo de \n\npress\u00f5es do fluxo bif\u00e1sico \u00f3leo-\u00e1gua em reservat\u00f3rios de petr\u00f3leo (Rees, et al., 2004; Car-\n\nvalho et al., 2007). \n\n \n\n3.3 Formula\u00e7\u00e3o Num\u00e9rica \n\n \n\n3.3.1 M\u00e9todo de volumes finitos baseados em aresta 1 - (EBFV1) \n\n \n\n A presente abordagem foi originalmente usada por Crumpton et al (1997) para a \n\ndiscretiza\u00e7\u00e3o de termos de difus\u00e3o nas equa\u00e7\u00f5es de Navier-Stokes com as modifica\u00e7\u00f5es \n\npropostas por Lyra et al (2004), Carvalho et al (2005) e Carvalho et al (2007). Nesta abor-\n\ndagem, de forma a se obter um sistema de equa\u00e7\u00f5es discretas final, primeiro s\u00e3o calculados \n\nos gradientes nodais como fun\u00e7\u00f5es do campo escalar discreto e ent\u00e3o estes gradientes s\u00e3o \n\nusados para calcular os termos el\u00edpticos em um segundo passo (Crumpton et al, 1997; Rees \n\net al, 2004; Carvalho et al, 2007). Os gradientes calculados no primeiro passo s\u00e3o usados \n\npara calcular os termos de difus\u00e3o cruzadas que surgem naturalmente em problemas que \n\nlidam com tensores cheios ( )i.e. 0.0xy yxK K= ?  ou quando se usa malhas n\u00e3o-ortogonais, \n\nonde ambos os problemas podem ser vistos como equivalentes. \n\n\n\n35 \n\n Para um n\u00f3 I arbitr\u00e1rio da malha, usando uma estrutura de dados baseada em ares-\n\ntas, a Eq. (3.4) pode ser aproximada como: \n\n \n\n .\nL L L L\n\nI I\n\nIJ IJ IJ IJ I I\nL L\n\nF C F D f V? ?\n\n? ? ? ?\n\n? + ? =? ?\n?? ? ?\n\n (3.5) \n\n \n\nonde \nIJ IJL L\n\nF K u? ?= ? ?\n?\n\n?\n \u00e9 a fun\u00e7\u00e3o de fluxo definida na superf\u00edcie de controle para uma aresta \n\nLIJ , IV \u00e9 o volume de controle associado ao n\u00f3 I, IJ L\nu ?? \u00e9 o gradiente aproximado no ponto \n\nm\u00e9dio da aresta LIJ , o \u00edndice ?  representa aproxima\u00e7\u00f5es que est\u00e3o associadas a todas as \n\narestas LIJ  da malha primal conectadas ao n\u00f3 I, ? refere-se apenas \u00e0s arestas de contorno \n\nconectadas a este n\u00f3, o somat\u00f3rio \nIL ? ?\n? \u00e9 feito sobre todas as arestas conectadas ao n\u00f3 I e \n\nIL ? ?\n? \u00e9 feito apenas sobre as arestas do contorno. Os coeficientes geom\u00e9tricos LIJC\n\n?\n e \n\nLIJ\nD\n?\n\n \n\ns\u00e3o definidos como: \n\n \n\n 1\n\n.\n\nL\n\nL\n\nNT\n\nIJ k k\nk\n\nIJ L L\n\nC A n\n\nD A n\n\n=\n\n=\n\n=\n\n?\n? ?\n\n? ?\n (3.6) \n\n \n\n Na Equa\u00e7\u00e3o (3.6), KA  e Kn\n?\n\n representam, respectivamente, a \u00e1rea e o vetor normal \u00e0 \n\nsuperf\u00edcie de controle definida por todos os NT elementos que dividem a aresta LIJ . Para o \n\ncoeficiente \nLIJ\n\nD\n?\n\n, LA  e Ln\n?\n\n possuem o mesmo significado que KA  e Kn\n?\n\n, por\u00e9m para as ares-\n\ntas de contorno. Para problemas 3-D, dois vetores 0\nLIJ\n\nD\n?\n\n e 1\nLIJ\n\nD\n?\n\ns\u00e3o usados, pois uma aresta \n\npode estar associada a duas superf\u00edcies com condi\u00e7\u00f5es de contorno distintas. \n\n Os vetores \nLIJ\n\nC\n?\n\n e \nLIJ\n\nD\n?\n\n s\u00e3o obtidos na fase de pr\u00e9-processamento e associados \u00e0s \n\narestas da malha primal. Mais detalhes podem ser encontrados em Carvalho (2005). \n\n \n\n \n\n \n\n\n\n36 \n\n3.3.1.1 C\u00e1lculo do gradiente \n\n \n\n A aproxima\u00e7\u00e3o do gradiente no ponto m\u00e9dio da aresta \nIJ L\n\nu ?? necess\u00e1rio para resol-\n\nver a equa\u00e7\u00e3o (3.5) parte da aplica\u00e7\u00e3o do teorema da diverg\u00eancia para integrar o gradiente \n\nda vari\u00e1vel escalar u no n\u00f3 I, obtendo-se: \n\n \n\n .\nI I\n\nI I Iu u n\n? ?\n\n? ?? = ??? ?\n?\n\n (3.7) \n\n \n\nAssumindo que o gradiente m\u00e9dio Iu?  no volume de controle I \u00e9 constante, pode-se \n\ndefini-lo como: \n\n \n\n .\nI\n\nI I I Iu u V\n?\n\n? ?\n? = ? ??? ?\n\n? ?\n? ?\n?  (3.8) \n\n \n\n Similarmente \u00e0 Eq. (3.5) e fazendo I Iu u? = ? , a forma discreta da Eq. (3.7) pode \n\nser escrita como: \n\n \n\n .\nL L L L\n\nI I\n\nI I IJ IJ IJ IJ\nL L\n\nu V u C u D? ? ?\n\n? ? ? ?\n\n? ?\n? = +? ?\n\n? ?\n? ?\n\n? ?\n (3.9) \n\n \n\n A principal diferen\u00e7a entre a abordagem de Crumpton e a formula\u00e7\u00e3o apresentada \n\nem Carvalho et al (2007) \u00e9 que no \u00faltimo, os gradientes s\u00e3o recuperados para cada subdo-\n\nm\u00ednio separadamente a fim de evitar inconsist\u00eancias f\u00edsicas.  \n\n Neste caso, como mostra a Fig. (3.1), para um problema 2-D envolvendo mais de \n\num dom\u00ednio, um n\u00f3 situado na interface possui dois volumes de controle com propriedades \n\nf\u00edsicas distintas.  \n\n Assim, as defini\u00e7\u00f5es dos fluxos sobre as superf\u00edcies de controle localizados na in-\n\nterface entre materiais diferentes podem ser amb\u00edguas (Helmig, 1997). Se os gradientes \n\nnodais calculados como descrito na Eq. (3.9) forem usados para calcular os fluxos, uma \n\ninconsist\u00eancia f\u00edsica seria obtida ao longo das superf\u00edcies de controle adjacentes as descon-\n\ntinuidades dos materiais.  \n\n\n\n37 \n\n De forma a contornar este problema, os gradientes s\u00e3o recuperados para cada um \n\ndos subdom\u00ednios. \n\n \n\n?1\n\nmJ\n\nJL\n\nI mn\n\nLn\n\nm-n\n\nL-n\n\nJm-1\n\nL+1J\n\nm+1J\n\nL-1J\n\nJm\n\nm+1J\n\nJL-1\n\nJL\n\nm-1J\n\nL+1J\n\nJL\n\nI I\n\nJm\n\n?1 2? ??11 ? 2\n\n \n\nFigura 3.1 \u2013 Volume de controle subdividido por dois tipos diferentes de rocha \n\n \n\n Para a malha considerada na Fig. (3.1), \u00e9 necess\u00e1rio incluir novos coeficientes ge-\n\nom\u00e9tricos na interface entre dom\u00ednios de forma a se definir duas superf\u00edcies de controle e \n\nobter, assim, um gradiente cont\u00ednuo por partes. \n\n  Dessa forma, para um meio heterog\u00eaneo, a Eq. (3.9) pode ser reescrita como: \n\n \n\n \n\n( ) ( ) ( )\n\n`\n\n1 1 1\n\n1\n.\n\nr RI RE\n\nr r r r r\n\nL L L L L Lr\n\nNN NN NN\n\nI IJ IJ IJ IJ IJ IJ\nL L LI\n\nu u C u D u D\nV\n\n? ? ?\n\n? ? ? ? ?? ?\n\n?\n= = =\n\n? ?\n? = + +? ?\n\n? ?? ?\n? ? ?\n\n? ? ?\n (3.10) \n\n \n\n Na equa\u00e7\u00e3o (3.10), rIu\n?\n\n? e RIV\n? s\u00e3o o gradiente nodal e o volume de controle asso-\n\nciados ao n\u00f3 I referentes ao subdom\u00ednio r? . Os coeficientes \nr\n\nLIJ\nC ?\n?\n\n e r\nLIJ\n\nD?\n?\n\n s\u00e3o os coeficien-\n\ntes geom\u00e9tricos da aresta LIJ  referentes ao subdom\u00ednio r? . Vale mencionar que na forma \n\nde recuperar os gradientes por dom\u00ednios, r\nLIJ\n\nD?\n?\n\nse refere tanto as arestas externas quanto as \n\ndas interfaces entre dom\u00ednios, e RE?  e RI?  referem-se, respectivamente, aos la\u00e7os sobre as \n\narestas de contorno externas e sobre as arestas das interfaces entre dom\u00ednios. \n\n A Eq. (3.10) acima \u00e9 constru\u00edda para cada um dos subdom\u00ednios, ou seja, \u00e9 feito um \n\nla\u00e7o sobre cada subdom\u00ednios de forma a garantir que os gradientes nodais e os fluxos se-\n\njam aproximados de forma correta para cada material ao longo da interface das arestas. A \n\ncada subdom\u00ednio pode-se associar uma propriedade f\u00edsica do meio como porosidade e \n\npermeabilidade. \n\n\n\n38 \n\n Para arestas no interior do dom\u00ednio, a vari\u00e1vel escalar \nLIJ\n\nu da Eq. (3.10) pode ser \n\naproximada como a m\u00e9dia aritm\u00e9tica entre os n\u00f3s I e JL, que corresponde a uma aproxima-\n\n\u00e7\u00e3o de diferen\u00e7as finitas de segunda ordem. \n\n \n\n .\n2\n\nL\n\nL\n\nI J\nIJ\n\nu u\nu ?\n\n+\n=  (3.11) \n\nInspirada no MEF, uma aproxima\u00e7\u00e3o de segunda ordem da vari\u00e1vel \nLIJ\n\nu  nos con-\n\ntornos para malhas 2-D de tri\u00e2ngulos e 3-D de tetraedros pode ser obtida, respectivamente, \n\natrav\u00e9s de: \n\n \n\n \n5\n\n,\n6\n\nL\n\nL\n\nI J\nIJ\n\nu u\nu ?\n\n+\n=  (3.12) \n\n \n\n \n6\n\n.\n8\n\nL K\n\nL\n\nI J J\nIJ\n\nu u u\nu ?\n\n+ +\n=  (3.13) \n\n \n\nPara o caso tridimensional, \u00e9 necess\u00e1rio ter uma segunda estrutura de dados com as \n\nfaces dos tetraedros que definem o contorno. Neste caso, o coeficiente \nLIJ\n\nD\n?\n\nassume outra \n\nnota\u00e7\u00e3o, \nL HIJ J\n\nD\n?\n\n, que est\u00e1 associado \u00e0 face do volume de controle sobre o contorno do do-\n\nm\u00ednio e \u00e9 definido como: \n\n \n\n .\n3\n\nL H L H\n\nL H\n\nIJ J IJ J\nIJ J\n\nn A\nD =\n\n?\n?\n\n (3.14) \n\n \n\nonde, \nL HIJ J\n\nn\n?\n\n e \nL HIJ J\n\nA  s\u00e3o o vetor normal e \u00e1rea do tri\u00e2ngulo, respectivamente. Dessa forma, \n\no gradiente nodal pode ser calculado para malhas 2-D de tri\u00e2ngulos e 3-D de tetraedros \n\ncomo: \n\n \n\n\n\n39 \n\n \n\n( )( ) ( )( )\n\n( )( )\n1 1\n\n1\n\n51\n\n2 6\n\n5\n.\n\n6\n\nr RE\n\nL L Hr r r\n\nL Lr\n\nL L\n\nRI\n\nL H r\n\nL\n\nL\n\nNN NN\nI J I J J\n\nI IJ IJ\nJ JI\n\nNN\nI J J\n\nIJ\nJ\n\nu u u u\nu C D\n\nV\n\nu u\nD\n\n? ?\n\n?\n\n? ? ?\n\n?\n= =\n\n?\n\n=\n\n? + +\n?? = + +\n?\n?\n\n?+\n?\n?\n?\n\n? ?\n\n?\n\n? ?\n\n?\n (3.15) \n\n \n\ne \n\n \n\n \n\n( )( ) ( )( )\n\n( )( )\n1 1\n\n1\n\n61\n\n2 8\n\n6\n.\n\n8\n\nr RE\n\nL L Hr r r\n\nL L Hr\n\nL L\n\nRI\n\nL H r\n\nL H\n\nL\n\nNN NN\nI J I J J\n\nI IJ IJ J\nJ JI\n\nNN\nI J J\n\nIJ J\nJ\n\nu u u u u\nu C D\n\nV\n\nu u u\nD\n\n? ?\n\n?\n\n? ? ?\n\n?\n= =\n\n?\n\n=\n\n? + + +\n?? = +\n?\n?\n\n?+ +\n?+\n?\n?\n\n? ?\n\n?\n\n? ?\n\n?\n (3.16) \n\n \n\n Definida uma forma de se obter os gradientes nodais e de forma a calcular os fluxos \n\ndescritos pela Eq. (3.5), utiliza-se um sistema local e ortogonal de coordenadas no qual um \n\neixo est\u00e1 orientado ao longo da dire\u00e7\u00e3o da aresta (P) e outro eixo em uma dire\u00e7\u00e3o ortogo-\n\nnal a (P). Assim, o gradiente no ponto m\u00e9dio da aresta \u00e9 decomposto em duas componen-\n\ntes: \n\n \n\n ( ) (P) .r r r\nL L L\n\nN\nIJ IJ IJu u u\n? ? ?\n\n? = ? + ?  (3.17) \n\n A componente do gradiente paralela \u00e0 dire\u00e7\u00e3o da aresta (P)r\nLIJ\n\nu ??  pode ser calculada \n\npor: \n\n \n\n ( )(P) .r r\nL L L LIJ IJ IJ IJ\n\nu u L L? ?? = ? ? ?\n? ?\n\n (3.18) \n\n \n\ne a componente normal ( )r\nL\n\nN\nIJu\n?\n\n?  por: \n\n \n\n ( ) ( ) .r r r\nL L L\n\nN P\nIJ IJ IJu u u\n? ? ?\n\n? = ? ? ?  (3.19) \n\n \n\n\n\n40 \n\nAplicando a Eq. (3.18) na Eq. (3.19) e aproximando r\nLIJ\n\nu ??  pela m\u00e9dia aritm\u00e9tica dos gra-\n\ndientes nodais, ( )r\nL\n\nN\nIJu\n?\n\n?  pode ser reescrita como: \n\n \n\n ( )\n2 2\n\nL Lr\n\nL L L\n\nI J I JN\nIJ IJ IJ\n\nu u u u\nu L L?\n\n? + ? ? + ?? ?\n? = ? ? ?? ?\n\n? ?\n\n? ?\n (3.20) \n\n \n\n Substituindo a componente (P)r\nLIJ\n\nu ??  por uma aproxima\u00e7\u00e3o de diferen\u00e7as centradas, \n\nobt\u00e9m-se: \n\n \n\n(P) .Lr\nL L\n\nL\n\nJ I\nIJ IJ\n\nIJ\n\nu u\nu L?\n\n?\n? = ?\n\n?\n\n?\n (3.21) \n\n \n\n.\n2 2\n\nr r r r\n\nL L Lr\n\nL L L L\n\nL\n\nI J I J J I\nIJ IJ IJ IJ\n\nIJ\n\nu u u u u u\nu L L L\n\n? ? ? ?\n\n?\n? ?? ?? + ? ? + ? ?\n\n? = ? ? ? + ?? ?? ?\n? ?? ??? ?? ?\n\n? ? ?\n (3.22) \n\n \n\n Assim, chega-se a uma aproxima\u00e7\u00e3o para o gradiente no ponto m\u00e9dio da aresta que \n\n\u00e9 uma aproxima\u00e7\u00e3o \u201ch\u00edbrida\u201d de volumes finitos para a componente normal e de diferen\u00e7as \n\nfinitas centradas para a componente paralela do gradiente, ambas de segunda ordem. A \n\nfun\u00e7\u00e3o de fluxo da Eq. (3.5) pode ser escrita como: \n\n \n\n .\n2 2\n\nr r r r\n\nL L Lr r\n\nL L L L\n\nL\n\nI J I J J I\nIJ IJ IJ IJ\n\nIJ\n\nu u u u u u\nF K L L L\n\n? ? ? ?\n\n? ?\n? ?? ?? + ? ? + ? ?\n\n= ? ? ? ? + ?? ?? ?\n? ?? ??? ?? ?\n\n? ? ?\n\n?\n (3.22) \n\n \n\n Embora este esquema h\u00edbrido pare\u00e7a ser mais complicado que a aproxima\u00e7\u00e3o usual \n\nde fluxo de dois pontos (TPFA) e a t\u00e9cnica do valor m\u00e9dio do gradiente nodal, esse es-\n\nquema permite o correto c\u00e1lculo do termo de difus\u00e3o cruzada que \u00e9 o principal ponto fraco \n\ndo TPFA. Ao mesmo tempo, tamb\u00e9m evita problemas conhecidos como checkerboarding \n\nou a ocorr\u00eancia de oscila\u00e7\u00f5es par-\u00edmpar caracter\u00edsticas de formula\u00e7\u00f5es cl\u00e1ssicas que utili-\n\nzam est\u00eancil estendido, onde o gradiente nodal \u00e9 calculado como uma m\u00e9dia aritm\u00e9tica em \n\nmalha quadrilaterais ortogonais igualmente espa\u00e7adas. De fato, pode-se provar que essas \n\nduas t\u00e9cnicas usuais s\u00e3o aproxima\u00e7\u00f5es inconsistentes de volumes finitos para o operador \n\nLaplaciano discreto em malhas triangulares (Sv\u00e4rd e Nordstr\u00f6m, 2003). \n\n\n\n41 \n\n Usando a aproxima\u00e7\u00e3o de fluxo na superf\u00edcie do volume de controle dada pela \n\nEq.(3.22), pode-se redefinir a Eq. (3.5) como: \n\n \n( ) ( )\n\n*\n\n1 1\n\n.r r r r r r\nL L L L\n\nI Ir r\n\nNdom Ndom\n\nIJ IJ IJ IJ I I\nr L L r\n\nF C F D f V\n? ?\n\n? ? ? ? ? ?\n\n= =\n\n? ?\n? ?? + ? =\n? ?\n? ?\n\n? ? ? ?\n?? ? ?\n\n (3.23) \n\nonde Ndom refere-se ao n\u00famero de dom\u00ednios que cercam o n\u00f3 I, e o termo rIf\n?  est\u00e1 rela-\n\ncionado a termos de fonte/sumidouro associados ao volume rIV\n?  que faz parte do sub-\n\ndom\u00ednios r? . \n\n \n\n3.3.2 M\u00e9todo de volumes finitos baseados em aresta 2 - (EBFV2) \n\n \n\n Esta abordagem pode ser obtida considerando-se uma varia\u00e7\u00e3o linear da vari\u00e1vel \n\nescalar \u201cu\u201d atrav\u00e9s das arestas da malha primal. Neste caso, os gradientes s\u00e3o considerados \n\nconstantes sobre os elementos da malha primal e os fluxos podem ser calculados atrav\u00e9s da \n\nmalha dual, pois o coeficiente de difus\u00e3o \u00e9 constante entre dois volumes de controle adja-\n\ncentes sobre um mesmo elemento da malha primal. \n\n Esta metodologia \u00e9 an\u00e1loga ao tradicional m\u00e9todo de elementos finitos com volu-\n\nmes de controle (CVFEM). Na formula\u00e7\u00e3o presente, para um n\u00f3 arbitr\u00e1rio I da malha, o \n\nlado esquerdo da Eq. (3.4) pode ser escrita como: \n\n \n\n ( ) ( ) .i i i i i\ni iI\n\ne e e e e\nI IJ IJ IJ\n\ne e\n\nK u n K u C F C\n?\n\n? ? ? ?? = ? ? ? = ?? ??\n? ???\n\n? ?\n (3.24) \n\n \n\n Na Eq. (3.24) o sobrescrito \u201ce\u201d refere-se \u00e0 contribui\u00e7\u00e3o do fluxo i i ie e eIJF K u= ? ?\n?\n\n?\n \n\nque vem da aresta IJ e que est\u00e1 associada ao elemento \u201ce\u201d adjacente \u00e0 aresta IJ.  \n\n Para um elemento qualquer da malha primal, o gradiente pode ser calculado como: \n\n \n\n \n( )\n\n( )\n1\n\n2 .\n2\n\ne\n\nI Je e\nIJe\n\nIJ\n\nu u\nu D\n\nV\n\n+\n? = ?\n\n?\n (3.25) \n\n \n\nonde eV  \u00e9 o volume (\u00e1rea em 2-D) do elemento, eIJD\n?\n\n s\u00e3o os vetores \u00e1rea normais \u00e0s arestas \n\ne o somat\u00f3rio \u00e9 feito sobre todas as arestas da malha primal que define este elemento. Nes-\n\n\n\n42 \n\nte trabalho, apenas elementos triangulares foram usados. Assim, para um elemento triangu-\n\nlar qualquer definido pelos n\u00f3s 1, 2 e 3, pode-se escrever: \n\n \n\n \n( )\n\n( )\n( )\n\n( )\n( )\n\n( )1 2 2 3 3 112 23 13\n1\n\n2 2 2 .\n2 2 2\n\ne e e e\ne\n\nu u u u u u\nu D D D\n\nV\n\n+ + +? ?\n? = + +? ?\n\n? ?\n\n? ? ?\n (3.26) \n\n \n\n Este gradiente \u00e9 ent\u00e3o substitu\u00eddo na Eq. (3.24) de forma a calcular os fluxos atra-\n\nv\u00e9s das superf\u00edcies de controle. Ap\u00f3s algumas manipula\u00e7\u00f5es geom\u00e9tricas e alg\u00e9bricas, des-\n\ncrito em mais detalhes no Ap\u00eandice A, \u00e9 poss\u00edvel escrever as contribui\u00e7\u00f5es dos fluxos de \n\nforma totalmente por arestas. Esta formula\u00e7\u00e3o produz um sistema de equa\u00e7\u00f5es sim\u00e9tricas \n\nmontado aresta por aresta que pode ser resolvido por um m\u00e9todo iterativo tipo gradiente \n\nconjugado. \n\n Esta formula\u00e7\u00e3o foi desenvolvida e usada apenas para resolver uma equa\u00e7\u00e3o el\u00edpti-\n\nca com coeficientes descont\u00ednuos representada, por exemplo, pelo campo de press\u00f5es em \n\nescoamento em meios porosos.  \n\n O intuito neste trabalho foi apenas em desenvolver e validar uma formula\u00e7\u00e3o de \n\nvolumes finitos por aresta capaz de lidar de uma forma mais simples, conseq\u00fcentemente \n\npermitindo criar um c\u00f3digo de computador mais r\u00e1pido de ser implementado, com as hete-\n\nrogeneidades do meio poroso. Essa dever\u00e1 ser explorada no contexto de escoamentos mul-\n\ntif\u00e1sicos em trabalhos futuros. \n\n \n\n3.4 An\u00e1lise de erro \n\n \n\n Para avaliar a acur\u00e1cia de ambos os procedimentos de volumes finitos baseado em \n\narestas para os problemas com coeficientes descont\u00ednuos e anisotr\u00f3picos, define-se o erro \n\nde truncamento assint\u00f3tico como: \n\n \n\n ( )1 .q qhE Ch O h\n+\n\n= +  (3.27) \n\n \n\nonde h \u00e9 o espa\u00e7amento da malha, q \u00e9 a ordem do erro, que representa a taxa de conver-\n\ng\u00eancia, C \u00e9 uma constante que n\u00e3o depende de h e ?  \u00e9 alguma norma especificada. Neste \n\ncaso, a taxa de converg\u00eancia \u00e9 estimada como: \n\n\n\n43 \n\n 2\n2\n\nlog .\nh\n\nh\n\nE\nq\n\nE\n?  (3.28) \n\n \n\ncom h/2 representando a malha com espa\u00e7amento igual \u00e0 metade de h. \n\n As taxas de converg\u00eancias foram estimadas usando a norma dos m\u00ednimos quadra-\n\ndos m\u00e9dios (RMS - Root Mean Square), \nRMS\n\nE , que \u00e9 calculada como: \n\n \n\n ( )\n1 2\n\n2\n\n1\n\n\u02c6 \u02c6 .\nRMS\n\nNP\n\nI IRMS L\nI\n\nE u u u u NP\n=\n\n? ?\n= ? = ?? ?\n\n? ?\n?  (3.29) \n\n \n\nonde u \u00e9 a solu\u00e7\u00e3o exata, u? \u00e9 a solu\u00e7\u00e3o aproximada e NP \u00e9 o numero de n\u00f3s livre da malha \n\ncomputacional. \n\n \n\n3.5 Exemplos \n\n \n\n3.5.1 Meio homog\u00eaneo e isotr\u00f3pico \n\n \n\n Este problema, que envolve a solu\u00e7\u00e3o de uma equa\u00e7\u00e3o el\u00edptica em meio homog\u00eaneo \n\ne isotr\u00f3pico, foi apresentado por Chen et al. (2006) que o resolveu usando dois m\u00e9todos \n\ndiferentes: o tradicional m\u00e9todo de elementos finitos baseados em volumes de controle \n\n(CVFEM) e o m\u00e9todo de fun\u00e7\u00e3o de aproxima\u00e7\u00e3o de volumes de controle (CVFA - control \n\nvolume function approximation method) que \u00e9 um m\u00e9todo localmente conservativo no qual \n\ns\u00e3o usadas fun\u00e7\u00f5es de interpola\u00e7\u00e3o, tais como splines, no processo de aproxima\u00e7\u00e3o. Na \n\nforma compacta, o problema pode ser descrito pelas seguintes equa\u00e7\u00f5es: \n\n \n\n ( ) ( ) ( )22 cos cos 0 1 0 1.K u x y for x and y? ? ?? ? = &lt;&lt;&lt;<\n?\n\n (3.30) \n\n \n\nonde o coeficiente de difus\u00e3o K\n?\n\n\u00e9 definido por: \n\n \n\n \n1 0\n\n.\n0 1\n\nK\n? ?\n\n= ? ?\n? ??\n\n (3.31) \n\n\n\n44 \n\ne as condi\u00e7\u00f5es de contorno s\u00e3o dadas por: \n\n ( )\n\n( )\n\n0, 0, 1 0 1\n\ncos , 0 1 0\n\ncos , 0 1 1\n\nu n para x x e y\n\nu x para x e y\n\nu x para x e y\n\n?\n\n?\n\n? ? = = = &lt;<\n\n= &lt;&lt;=\n\n= ? &lt;&lt;=\n\n?\n (3.32) \n\n \n\n A solu\u00e7\u00e3o peri\u00f3dica anal\u00edtica para este problema \u00e9 ( ) ( )cos cosu x y? ?=  definida \n\nem um dom\u00ednio quadrado unit\u00e1rio ( )\n2\n\n0,1? = . A figura 3.2 mostra o campo escalar u obti-\n\ndo usando-se uma malha triangular ( )65x65  que est\u00e1 em excelente concord\u00e2ncia com a \n\nsolu\u00e7\u00e3o anal\u00edtica. \n\n \n\n \n\nFigura 3.2 \u2013 Equa\u00e7\u00e3o el\u00edptica com coeficientes isotr\u00f3picos e cont\u00ednuos: campo escalar u \n\nobtido com o EBFV2 usando uma malha triangular (65x65). \n\n \n\n Nas tabelas 3.1, 3.2 e 3.3 est\u00e3o representados os erros e as taxas de converg\u00eancia \n\nobtida usando os m\u00e9todos: CVFA, EBFV1 e EBFV2, respectivamente e para malhas com \n\ndiferentes espa\u00e7amentos (9x9), (17x17), (33x33) e (65x65) n\u00f3s. \n\n Como se pode observar, os tr\u00eas m\u00e9todos t\u00eam acur\u00e1cia de segunda ordem para a va-\n\nri\u00e1vel escalar u, com resultados muito similares. Pode-se tamb\u00e9m perceber, para este e-\n\nxemplo em particular, ambos os m\u00e9todos de volumes finitos baseados em arestas se com-\n\nparam favoravelmente em rela\u00e7\u00e3o ao CVFA, com o EBFV2 apresentando erros ligeiramen-\n\nte menores. \n\n \n\n\n\n45 \n\nTabela 3.1 \u2013 Solu\u00e7\u00e3o num\u00e9rica da equa\u00e7\u00e3o el\u00edptica em um meio homog\u00eaneo e isotr\u00f3pico. \n\nErros e taxa de converg\u00eancia rates para: a) CVFA; b) EBFV1; c) EBFV2. \n\nN \nRMS\n\nE\n RMS\n\nq   RMSE  RMS\nq   RMSE  RMS\n\nq  \n\n9 1.21e-002 ----------  6.88e-003 ---------  2.82e-003 ---------- \n\n17 3.00e-003 2.0199  1.41e-003 2.2899  6.24e-004 2.1773 \n\n33 7.45e-004 2.0087  3.21e-004 2.1309  1.46e-004 2.0914 \n\n65 1.85e-004 2.0050  7.70e-005 2.0616  3.50e-005 2.0451 \n\n (a) CVFA  (b) EBFV1  (b) EBFV2 \n\n \n\n3.5.2 Meio homog\u00eaneo e anisotr\u00f3pico \n\n \n\n Este problema foi originalmente proposto por Crumpton (1995) que o resolveu u-\n\nsando um m\u00e9todo de volumes finitos de fluxo continuo centrado na c\u00e9lula (FCFV). Nova-\n\nmente, os dom\u00ednios considerados \u00e9 um quadrado de lado unit\u00e1rio ( )\n2\n\n0,1? = , com condi-\n\n\u00e7\u00f5es de contorno de Dirichlet extra\u00eddas da solu\u00e7\u00e3o exata que \u00e9 dada por xyu e= . Na forma \n\ncompacta, este problema pode ser descrito por: \n\n \n\n ( ) ( )2 22 1 .xyK u x xy y e? ? = ? + + +\n?\n\n (3.33) \n\n \n\nonde o tensor de difus\u00e3o K\n?\n\n \u00e9 dado por: \n\n \n\n \n2 1\n\n.\n1 2\n\nK\n? ?\n\n= ? ?\n? ??\n\n (3.34) \n\n \n\n S\u00e3o mostradas nas Fig. (3.3a) e Fig. (3.3b) uma malha triangular com (9x9) n\u00f3s e \n\nos contornos do campo escalar u, respectivamente, para a mesma.  \n\n A tabela 3.2 mostra os erros m\u00e9dios quadr\u00e1tico, \nRMS\n\nE , e as taxas de converg\u00ean-\n\ncias, RMSq , para os m\u00e9todos CVFA, EBFV1 e EBFV2, respectivamente. Os resultados ob-\n\ntidos com o FCFV e ambas as formula\u00e7\u00f5es de volumes finitos baseadas em arestas s\u00e3o es-\n\nsencialmente de segunda ordem no espa\u00e7o. Al\u00e9m disso, elas se comparam favoravelmente \n\nem rela\u00e7\u00e3o aos obtidos por Crumpton (1995) usando o FCFV. \n\n\n\n46 \n\n \n\nFigura 3.3 \u2013 Meio homog\u00eaneo e anisotr\u00f3pico: a) malha triangular (9x9); b) campo escalar \n\nu obtido com o EBFV1. \n\n \n\nTabela 3.2\u2013 Solu\u00e7\u00e3o num\u00e9rica da equa\u00e7\u00e3o el\u00edptica em um meio homog\u00eaneo e anisotr\u00f3pico. \n\nErros e taxas de converg\u00eancias para: a) FCFV; b) EBFV1; c) EBFV2. \n\nN \nRMS\n\nE\n RMS\n\nq   RMSE  RMS\nq   RMSE  RMS\n\nq  \n\n9 1.16e-003 -------  3.09e-003 -------  5.35e-004 ------- \n\n17 2.89e-004 2.0005  7.14e-004 2.1106  1.12e-004 2.1122 \n\n33 7.28e-005 1.9891  1.72e-004 2.0545  2.60e-005 2.0758 \n\n65 1.83e-005 1.9921  4.20e-005 2.0280  6.00e-006 1.9278 \n\n (a) CVFA  (b) EBFV1  (b) EBFV2 \n\n \n\n3.5.3 Meio heterog\u00eaneo e anisotr\u00f3pico \n\n \n\n O exemplo seguinte foi proposto originalmente por Crumpton (1997) e consiste em \n\num quadrado de lado unit\u00e1rio formado por dois materiais diferentes. As condi\u00e7\u00f5es de con-\n\ntorno de Dirichlet s\u00e3o dadas pela solu\u00e7\u00e3o exata. Crumpton (1997) resolveu este problema \n\nusando o FCFV com malha estruturada quadrilateral ortogonal. O problema \u00e9 definido por: \n\n \n\n ( ) ( ), .K u f x y? ? =\n?\n\n (2.35) \n\n \n\n\n\n47 \n\nonde os termos de fonte e o coeficiente de difus\u00e3o, ambos descont\u00ednuos, s\u00e3o dados, respec-\n\ntivamente, por: \n\n \n\n ( )\n( ) ( ) ( )\n\n( ) ( )\n\n2 cos    para 0\n, .\n\n2 exp cos         para  0\n\nsin y y x sin y x\nf x y\n\nx y x\n\n?\n\n?\n\n? ? ? ? ?? ??? ?\n= ?\n\n>??\n (3.36) \n\n \n\ne \n\n \n\n \n\n1 0\n        para 0\n\n0 1\n.\n\n2 1\n        para 0\n\n1 2\n\nx\n\nK\n\nx?\n\n? ? ?\n<? ? ?\n\n? ? ?\n= ?\n\n? ??\n>? ??\n\n? ??\n\n?\n (3.37) \n\n \n\nonde ? controla a intensidade da descontinuidade, ou seja, o salto na propriedade do mate-\n\nrial entre as duas regi\u00f5es distintas. A solu\u00e7\u00e3o exata para este problema, encontrada em \n\nCrumpton (1997) \u00e9 apresentada pela Eq. (3.30). \n\n \n\n ( )\n( ) ( ) ( )\n\n( ) ( )\n\n2 cos      para 0\n, .\n\nexp cos                                 para   0\n\nsin y y x sin y x\nu x y\n\nx y x\n\n?? + + ?? ??? ?\n= ?\n\n>??\n (3.38) \n\n \n\n Neste trabalho, o problema foi resolvido usando uma seq\u00fc\u00eancia uniforme de malhas \n\nestruturadas triangulares e quadrilaterais ortogonais com ( )9x9N = , ( )17x17 , ( )33x33  e \n\n( )65x65  n\u00f3s. S\u00e3o mostradas as linhas de contorno da fun\u00e7\u00e3o escalar ( ),u x y  obtidas para \n\nos m\u00e9todos EBFV1 e EBFV2 para uma malha triangular de ( )65x65  n\u00f3s associadas a \n\n1.0? = , e 1000.0? =  nas Fig. (3.4a) a (3.4d), respectivamente. \n\n As tabelas 3.3 a 3.6 representam os erros m\u00e9dios quadr\u00e1ticos \nRMS\n\nE  e as taxas de \n\nconverg\u00eancia RMSq  para quatro valores diferentes de ? obtidos com o m\u00e9todo FCFV de \n\nCrumpton (1997) usando malhas quadrilaterais ortogonais e os esquemas EBFV1 e EBFV2 \n\nusando malhas triangulares estruturadas. \n\n\n\n48 \n\n  \n\n                                      (a)                                        (b) \n\n  \n\n  \n\n                                      (c)                                        (d) \n\nFigura 3.4 \u2013 Linhas de contorno da fun\u00e7\u00e3o escalar ( , )u x y  obtidas com o EBFV1 usando \n\numa malha estruturada triangular (65x65) para diferentes valores de ? : (a) 1.0? = ; (b); \n\n10.0? =  (c) 100.0? = ; (d) 1000.0? =  \n\n \n\nComo se pode observar nas tabelas 3.3 a 3.6, para este problema particular de ben-\n\nchmark, apesar do fato do aumento da intensidade da descontinuidade tamb\u00e9m aumentar a \n\nmagnitude do erro para os tr\u00eas m\u00e9todos, estes mostram acur\u00e1cia de segunda ordem no es-\n\npa\u00e7o para todos os valores de ? . \n\n Pode-se tamb\u00e9m notar que para todos os casos testados, os esquemas EBFV1 e \n\nEBFV2 s\u00e3o bastante similares ao m\u00e9todo FCFV. Vale mencionar que os experimentos nu-\n\n\n\n49 \n\nm\u00e9ricos (n\u00e3o apresentados aqui) tamb\u00e9m mostram que o EBFV1 gera resultados um pouco \n\nmelhores que o FCFV quando malhas estruturadas quadrilaterais s\u00e3o usadas. \n\n \n\nTabela 3.3 \u2013 Solu\u00e7\u00e3o num\u00e9rica da equa\u00e7\u00e3o el\u00edptica em um meio anisotr\u00f3pico com coefici-\n\nente de difus\u00e3o descont\u00ednuo 1.0? = . Erros e taxas de converg\u00eancias para: a) FCFV; b) \n\nEBFV1; c) EBFV2. \n\nN \nRMS\n\nE\n RMS\n\nq   RMSE  RMS\nq   RMSE  RMS\n\nq  \n\n9 3.33e-003 ----------  6.02e-003 ----------  1.49E-003 ---------- \n\n17 9.37e-004 1.8294  1.50e-003 1.9989  3.92E-004 1.9300 \n\n33 2.45e-004 1.9353  3.77e-004 2.0012  1.00E-004 1.9590 \n\n65 6.25e-005 1.9709  9.40e-005 2.0014  2.56E-005 1.9780 \n\n (a) CVFA  (b) EBFV1  (b) EBFV2 \n\n \n\nTabela 3.4\u2013 Solu\u00e7\u00e3o num\u00e9rica da equa\u00e7\u00e3o el\u00edptica em um meio anisotr\u00f3pico com coefici-\n\nente de difus\u00e3o descont\u00ednuo 10.0? = . Erros e taxas de converg\u00eancias para: a) FCFV; b) \n\nEBFV1; c) EBFV2. \n\nN \nRMS\n\nE\n RMS\n\nq   RMSE  RMS\nq   RMSE  RMS\n\nq  \n\n9 1.62e-002 ----------  4.57e-002 ----------  2.18E-003 ---------- \n\n17 4.35e-003 1.9146  1.17e-002 1.9569  5.72E-004 1.9361 \n\n33 1.11e-003 1.9705  2.98e-003 1.9829  1.47E-004 1.9601 \n\n65 2.81e-004 1.9819  7.49e-004 1.9925  3.73E-005 1,9780 \n\n (a) CVFA  (b) EBFV1  (b) EBFV2 \n\n \n\nTabela 3.5\u2013 Solu\u00e7\u00e3o num\u00e9rica da equa\u00e7\u00e3o el\u00edptica em um meio anisotr\u00f3pico com coefici-\n\nente de difus\u00e3o descont\u00ednuo 100.0? = . Erros e taxas de converg\u00eancias para: a) FCFV; b) \n\nEBFV1; c) EBFV2. \n\nN \nRMS\n\nE\n RMS\n\nq   RMSE  RMS\nq   RMSE  RMS\n\nq  \n\n9 1.81e-001 ----------  4.40e-001 ----------  1.09E-002 ---------- \n\n17 4.74e-002 1.9330  1.13e-001 1.9538  2.97E-003 1.8845 \n\n33 1.21e-002 1.9699  2.88e-002 1.9813  7.69E-004 1.9497 \n\n65 3.04e-003 1.9929  7.24e-003 1.9916  1.95E-004 1.9762 \n\n (a) CVFA  (b) EBFV1  (b) EBFV2 \n\n \n\n\n\n50 \n\nTabela 3.6 \u2013 Solu\u00e7\u00e3o num\u00e9rica da equa\u00e7\u00e3o el\u00edptica em um meio anisotr\u00f3pico com coefici-\n\nente de difus\u00e3o descont\u00ednuo 1000.0? = . Erros e taxas de converg\u00eancias para: a) FCFV; b) \n\nEBFV1; c) EBFV2. \n\nN \nRMS\n\nE\n RMS\n\nq   RMSE  RMS\nq   RMSE  RMS\n\nq  \n\n9 4.39e-000 ----------  4.39e-000 ----------  1.14E-001 ---------- \n\n17 1.13e-000 1.9536  1.13e-000 1.9536  1.14E-001 1.8812 \n\n33 2.87e-001 1.9812  2.87e-001 1.9812  3.10E-002 1.9489 \n\n65 7.22e-002 1.9915  7.22e-002 1.9915  8.04E-003 1.9760 \n\n (a) CVFA  (b) EBFV1  (b) EBFV2 \n\n \n\n3.5.4 Meio homog\u00eaneo e anisotr\u00f3pico com solu\u00e7\u00e3o n\u00e3o-suave \n\n \n\n Este \u00faltimo exemplo foi resolvido por Lipnikov et al. (2007) usando um esquema \n\nde volumes finitos mon\u00f3tono n\u00e3o-linear centrado na c\u00e9lula (NLMFV) desenvolvido especi-\n\nficamente para produzir solu\u00e7\u00f5es monot\u00f4nicas, ou seja, que preserva a positividade da so-\n\nlu\u00e7\u00e3o na presen\u00e7a de materiais altamente heterog\u00eaneos e anisotr\u00f3picos. O dom\u00ednio compu-\n\ntacional consiste de um quadrado de lado unit\u00e1rio que um furo quadrado em seu centro \n\n( ) [ ]\n22\n\n0,1 4 9 , 5 9? =  como \u00e9 mostrado na Fig. (3.5). Este problema pode ser brevemente \n\ndescrito com: \n\n \n\n ( ) ( ), .K u f x y? ? =\n?\n\n (3.39) \n\n \n\nonde: \n\n \n\n 1\n\n2\n\n0cos sin cos sin\n.\n\n0sin cos sin cos\n\nk\nK\n\nk\n\n? ? ? ?\n\n? ? ? ?\n\n?? ?? ? ? ?\n= ? ?? ? ? ?\n\n?? ? ? ?? ??\n (3.40) \n\n \n\nCom ( ), 0f x y =  e condi\u00e7\u00f5es e contorno dadas por 0u =  nas fronteiras externas e 2u =  \n\nnas fronteiras internas, isto \u00e9: \n\n \n\n\n\n51 \n\n \n\n( )\n\n( )\n\n( )\n\n( )\n\n0 1 0 1\n0, .\n\n0 1 0 1\n\n4 9 5 9 4 9 5 9\n2, .\n\n4 9 5 9 4 9 5 9\n\nx e y ou y\nu para\n\ny e x ou x\n\nx e y ou y\nu para\n\ny e x ou x\n\n&lt;&lt;= =??\n= ?\n\n&lt;&lt;= =??\n\n&lt;&lt;= =??\n= ?\n\n&lt;&lt;= =??\n\n (3.41) \n\n \n\n \n\nFigura 3.5 \u2013 Geometria e malha triangular n\u00e3o-estruturada usada para resolver o problema \n\nhomog\u00eaneo e anisotr\u00f3pico com solu\u00e7\u00e3o n\u00e3o suave. \n\n \n\n Este problema foi resolvido usando dois valores diferentes para o \u00e2ngulo 6? ?=  e \n\n5 6? ?=  e a raz\u00e3o 1 2 1000k k = . N\u00e3o h\u00e1 solu\u00e7\u00e3o anal\u00edtica para este problema, mas os re-\n\nsultados devem claramente ficar entre os valores das fronteiras no interior do dom\u00ednio, isto \n\n\u00e9, ( )0 , 2u x y? ? , sem \u201covershoots\u201d ( ( ), 2u x y > ) ou \u201cundershoots\u201d ( ( ), 0u x y &lt;).  \n\n Foi usada uma malha triangular n\u00e3o-estruturada com um espa\u00e7amento m\u00e9dio de \n\n1 18h ? . As Fig. 3.6 e 3.7 mostram isolinhas da vari\u00e1vel escalar u para ambos os m\u00e9todos \n\ne ambos os valores de rota\u00e7\u00e3o. Pode-se perceber nestas figuras que os resultados obtidos \n\ns\u00e3o qualitativamente bastantes similares um com o outro e muito pr\u00f3ximos dos obtidos \n\ncom o NLMFV de Lipnikov et al. (2007). \n\n Embora ambos os m\u00e9todos EBFV1 e EBFV2 n\u00e3o apresentem \u201covershoots\u201d, estes \n\nproduziram uma quantidade razo\u00e1vel de \u201cundershoots\u201d com mais de 30% dos n\u00f3s livres \n\nenquanto o NLMFV produziu alguns \u201covershoots\u201d.  \n\n Para a malha n\u00e3o-estruturada usada aqui, os valores m\u00ednimos de u foram: \n\n0.03146u = ?  para 6? ?=  e 0.03024u = ?  para 5 6? ?= , para o EBFV1 e \n\n\n\n52 \n\n0.03331u = ?  para 6? ?=  e 0.02734u = ?  para 5 6? ?= , para o EBFV2, respectiva-\n\nmente.  \n\n O comportamento da vari\u00e1vel u ao longo de uma reta paralela ao eixo x passando \n\npelo centro da figura para um dos casos ( 5 6? ?= , EBFV2) pode ser visto na Fig. (3.8) \n\nonde se verifica a presen\u00e7a de \u201cundershoots\u201d. \n\n A fim de melhorar a monotonicidade da solu\u00e7\u00e3o, em Lipnikov et al. (2007), autores \n\nsugerem que se use a estrat\u00e9gia diferente (inverse distance weighting) para interpolar a va-\n\nri\u00e1vel escalar u pelo dom\u00ednio ao inv\u00e9s de usar as t\u00e9cnicas mais tradicionais de interpola\u00e7\u00e3o. \n\n \n\n  \n\n(a) (b) \n\nFigura 3.6 \u2013 Solu\u00e7\u00e3o num\u00e9rica para o problema homog\u00eaneo e anisotr\u00f3pico com solu\u00e7\u00e3o \n\nn\u00e3o suave: \u00e2ngulo de rota\u00e7\u00e3o / 6? ?= ; a) EBFV1; b) EBFV2. \n\n \n\n  \n\n(a) (b) \n\nFigura 3.7 \u2013 Solu\u00e7\u00e3o num\u00e9rica para o problema homog\u00eaneo e anisotr\u00f3pico com solu\u00e7\u00e3o \n\nn\u00e3o suave: \u00e2ngulo de rota\u00e7\u00e3o 5 / 6? ?= ; a) EBFV1; b) EBFV2. \n\n\n\n53 \n\n \n\n Al\u00e9m disso, eles tamb\u00e9m estabeleceram que \u201covershoots\u201d n\u00e3o s\u00e3o observados com \n\no NLMFV quando os gradientes acentuados est\u00e3o alinhados com as arestas da malha. Este \n\nexemplo mostra claramente que outros melhoramentos podem ser feitos para ambos os \n\nEBFVs caso se deseje garantir monotonicidade nos resultados em problemas mais comple-\n\nxos. \n\n \n\n \n\n \n\n \n\nRegi\u00e3o de \u201cundershoot\u201d \n\nFigura 3.8 \u2013 Comportamento da vari\u00e1vel u ao longo de uma reta paralela ao eixo x pas-\nsando pelo centro do dom\u00ednio. Para um problema com valores prescritos m\u00ednimo e m\u00e1-\nximo de 0.0 e 2.0, respectivamente, esperava-se que os resultados ficassem confinados \ndentro desse intervalo. Devido a forte anisotropia, verifica-se a presen\u00e7a de \u201cunder-\nshoots\u201d, ou seja, valores calculados abaixo do m\u00ednimo esperado. \n\n\n\n54 \n\n4. M\u00c9TODOS DE INTEGRA\u00c7\u00c3O NO TEMPO \n\n \n\n4.1 Introdu\u00e7\u00e3o \n \n As equa\u00e7\u00f5es de fluxo multif\u00e1sico em reservat\u00f3rios de petr\u00f3leo envolvem um con-\n\njunto de equa\u00e7\u00f5es diferenciais parciais n\u00e3o-lineares, acopladas e dependentes do tempo. \n\nUm importante problema de simula\u00e7\u00e3o num\u00e9rica em reservat\u00f3rios de petr\u00f3leo \u00e9 desenvol-\n\nver esquemas est\u00e1veis, robustos e acurados para resolver estas equa\u00e7\u00f5es acopladas (Li et \n\nal, 2004). Essencialmente, existem quatro esquemas de solu\u00e7\u00e3o importantes: IMPES (IM-\n\nplicit Pressure Explicit Saturation), seq\u00fcencial impl\u00edcito, totalmente impl\u00edcito e o adaptati-\n\nvo impl\u00edcito-expl\u00edcito. Neste trabalho, ser\u00e1 dada \u00eanfase ao m\u00e9todo IMPES por ser o m\u00e9to-\n\ndo de integra\u00e7\u00e3o no tempo adotado na constru\u00e7\u00e3o do simulador bif\u00e1sico \u00f3leo-\u00e1gua e em \n\nparticular ser\u00e1 apresentado uma estrat\u00e9gia do IMPES modificado baseado no trabalho de \n\nHurtado et al. (2006). \n\n \n\n4.2 IMPES \n\n \n\n O m\u00e9todo IMPES surgiu no in\u00edcio das simula\u00e7\u00f5es de reservat\u00f3rios e tornou-se bas-\n\ntante popular na resolu\u00e7\u00e3o das equa\u00e7\u00f5es de fluxo multif\u00e1sico. Para o caso bif\u00e1sico, ele se \n\ncaracteriza por ser um m\u00e9todo segregado que resolve de forma parcialmente desacoplada \n\nas vari\u00e1veis de press\u00e3o e satura\u00e7\u00e3o. Este desacoplamento parcial resulta essencialmente na \n\nresolu\u00e7\u00e3o de duas equa\u00e7\u00f5es, uma na forma impl\u00edcita (press\u00e3o), atrav\u00e9s de um sistema de \n\nequa\u00e7\u00f5es lineares, e outra na forma expl\u00edcita (satura\u00e7\u00e3o).  \n\n Este m\u00e9todo foi escolhido devido \u00e0 sua simplicidade de implementa\u00e7\u00e3o comparada \n\na outros m\u00e9todos e pela relativa baixa demanda computacional para certas classes de pro-\n\nblemas e dimens\u00f5es m\u00ednimas dos elementos da malha.  \n\nUma grande desvantagem deste m\u00e9todo surge devido \u00e0 aproxima\u00e7\u00e3o expl\u00edcita da \n\nsatura\u00e7\u00e3o que imp\u00f5e uma severa restri\u00e7\u00e3o de estabilidade quanto ao tamanho do passo de \n\ntempo, o que pode representar um custo de CPU extremamente elevado tornando-o proibi-\n\ntivo para problemas de grande porte com malhas muito refinadas. \n\n Para problemas de fluxo bif\u00e1sico incompress\u00edveis, o m\u00e9todo IMPES produz bons \n\nresultados. Entretanto, em problemas com forte n\u00e3o-linearidade como nos casos black-oil e \n\ncomposicional, este m\u00e9todo n\u00e3o \u00e9 eficiente e robusto (Li et al, 2003).  \n\n\n\n55 \n\nPara ambos os casos, envolvendo malhas muito refinadas ou apresentando forte \n\nn\u00e3o-linearidade, m\u00e9todos adaptativos s\u00e3o usados para melhorar a efici\u00eancia do m\u00e9todo \n\nIMPES. Geralmente, estes m\u00e9todos adaptativos, s\u00e3o baseados na condi\u00e7\u00e3o Courant\u2013\n\nFriedrichs\u2013Lewy (CFL), de forma a determinar quando os blocos da malha s\u00e3o tratados \n\nimplicitamente ou quando s\u00e3o tratados explicitamente (Li et al, 2003). \n\n \n\n4.3 Descri\u00e7\u00e3o do m\u00e9todo IMPES \n\n \n\nPartindo de um campo de satura\u00e7\u00f5es inicial, \n0\n\n( , 0)w wS t S? = = , monta-se um siste-\n\nma de equa\u00e7\u00f5es para o c\u00e1lculo do campo de press\u00f5es atrav\u00e9s da Eq. (4.1): \n\n \n\n ( ). ( ) .wK S p q??? ? =  (4.1) \n\n \n\nonde K, ( )wS?  e q representam a permeabilidade absoluta da rocha, a mobilidade da fase \n\n\u00e1gua, que \u00e9 fun\u00e7\u00e3o da satura\u00e7\u00e3o, e um termo fonte/sumidouro, respectivamente. Por ques-\n\nt\u00e3o de simplifica\u00e7\u00e3o, os termos de gravidade e capilaridade, inicialmente apresentados na \n\nEq. (2.19), foram removidos. \n\n O novo campo de satura\u00e7\u00f5es \u00e9 obtido atrav\u00e9s da Eq. (4.3), uma simplifica\u00e7\u00e3o da \n\nEq. (2.32): \n\n \n\n ( ) .w w w\nS\n\nf v Q\nt\n\n?\n?\n\n= ?? ? +\n?\n\n?\n (4.3) \n\n \n\n Como se percebe na Eq. (4.3), o campo de satura\u00e7\u00f5es depende do termo de fluxo, \n\nfun\u00e7\u00e3o do campo de velocidades. Logo, tr\u00eas passos precisam ser efetuados antes na seguin-\n\nte ordem: recupera\u00e7\u00e3o dos gradientes de press\u00e3o, c\u00e1lculo do campo de velocidades e c\u00e1lcu-\n\nlo dos termos de fluxo. Os gradientes de press\u00e3o e os termos de fluxo est\u00e3o associados aos \n\nvolumes de controle, enquanto o campo de velocidades est\u00e1 associado \u00e0s arestas. Esse \u00fal-\n\ntimo \u00e9 obtido por meio da lei de Darcy, Eq. (2.1), cuja equa\u00e7\u00e3o discreta avalia a vari\u00e1vel \n\nno ponto m\u00e9dio da aresta, sobre a superf\u00edcie de controle. O gradiente, calculado de forma \n\nnodal, \u00e9 aproximado conforme a Eq. (3.22), o que implica: \n\n \n\n\n\n56 \n\n \n\n( )\n( ) ( )\n\n( )\n\n\u02c6 \u02c6 \u02c6 \u02c6\n\n2 2\n\n\u02c6 \u02c6\n                             .\n\nr r r r\n\nL Lr r L\n\nL L L\n\nL\n\nL\n\nL\n\nI J I JIJ\nIJ T IJ IJ\n\nJ I\n\nIJ\n\nIJ\n\np p p p\nv K L L\n\np p\nL\n\n?\n\n? ? ? ?\n\n? ?\n? ? ?? + ? ? + ?\n? ? ?= ? ? ? +\n\n? ??\n? ??\n\n??\n?\n??\n?\n\n? ??\n\n?\n\n?\n\n (4.4) \n\n \n\n O \u00edndice r? indica que, para problemas com meios heterog\u00eaneos, o campo de velo-\n\ncidades deve ser calculado dom\u00ednio a dom\u00ednio onde os n\u00f3s na interface entre materiais a-\n\ncumulam a contribui\u00e7\u00e3o de cada campo. O fluxo de massa em cada volume de controle po-\n\nde, ent\u00e3o, ser obtido por: \n\n \n\n .\n2\n\nLr r r r\n\nL L L L\n\nI J\nIJ IJ IJ IJ\n\nf f\nF C v C AD? ? ? ?\n\n+? ?\n? = ? +? ?\n\n? ?\n\n? ??\n (4.5) \n\n \n\nonde AD corresponde a um de termo de difus\u00e3o num\u00e9rica. Dessa forma, utilizando o m\u00e9-\n\ntodo Euler expl\u00edcito, o novo campo de satura\u00e7\u00f5es pode ser obtido atrav\u00e9s de sua forma dis-\n\ncreta por: \n\n \n\n \n( )\n\n( )\n\n( )\n\n( )\n\n1\n\n1 1 1\n\n\u02c6 \u02c6 .\nr r\n\nr r r r r r\n\nL LL Lr r\n\nn\nNdom NN NN\n\nn n\nw w IJ IJ I IIJ w IJ w\n\nr L LI\n\nt\nS S F C F D Q V\n\nV?\n\n? ?\n\n? ? ? ? ? ?+\n\n? ?\n= = =\n\n? ??\n= ? ? + ? +? ?? ?\n\n? ?\n? ? ?\n\n?? ? ?\n (4.6) \n\n \n\nonde r? ?  representa a porosidade do dom\u00ednio r?  e t?  corresponde ao avan\u00e7o no tempo. \n\nEste avan\u00e7o corresponde a uma discretiza\u00e7\u00e3o temporal de primeira ordem que satisfaz um \n\nr\u00edgido crit\u00e9rio de estabilidade (CFL). \n\n O m\u00e9todo IMPES implementado neste trabalho pode, ent\u00e3o, ser descrito pelo algo-\n\nritmo 4.1. A resolu\u00e7\u00e3o do sistema de equa\u00e7\u00f5es para o c\u00e1lculo do campo de press\u00f5es repre-\n\nsenta mais de 80% do tempo de CPU consumido para cada itera\u00e7\u00e3o do m\u00e9todo e sua cons-\n\ntante atualiza\u00e7\u00e3o torna-se uma barreira para problemas maiores ou quando se leva em con-\n\nta, por exemplo, a presen\u00e7a de efeitos de capilaridade. \n\n Um m\u00e9todo incondicionalmente est\u00e1vel como o totalmente impl\u00edcito (fully impli-\n\ncit), onde as mesmas vari\u00e1veis s\u00e3o resolvidas de forma acoplada em um \u00fanico sistema de \n\nequa\u00e7\u00f5es, permite que passos de tempo maiores sejam empregados, por\u00e9m trazendo a des-\n\nvantagem de exigir mais mem\u00f3ria e tempo de CPU para cada itera\u00e7\u00e3o. \n\n\n\n57 \n\nSw(?,t=0) \nEnquanto (tempo_simula\u00e7\u00e3o &lt;tempo_total){ \n  \n La\u00e7o sobre os dom\u00ednios{ \n\n La\u00e7o sobre as aresta e faces do contorno (se 3-D) para: \n C\u00e1lculo do campo de press\u00f5es por meio de um sistema de equa\u00e7\u00f5es; \n} \n \nLa\u00e7o sobre os dom\u00ednios{ \n\nLa\u00e7o sobre as aresta e faces do contorno (se 3-D) para: \nRecupera\u00e7\u00e3o dos gradientes nodais; \n \nLa\u00e7o sobre as arestas para: \nC\u00e1lculo do campo de velocidades; \n \nLa\u00e7o sobre as arestas para: \nC\u00e1lculo dos termos de fluxo nodal e determina\u00e7\u00e3o de rt ?? ; \n\n{ \n( )rt min t ?? = ? ; \n\n \nLa\u00e7o sobre os n\u00f3s para: \nC\u00e1lculo do campo de satura\u00e7\u00f5es; \n \n\n_   _  tempo simula\u00e7\u00e3o tempo simula\u00e7\u00e3o t= + ? ; \n} \nAlgoritmo 4.1 \u2013 M\u00e9todo IMPES. \n \n\n A escolha de que m\u00e9todo usar \u00e9 fortemente influenciada pelo tipo de problema e \n\nisto pode trazer um ganho de tempo de simula\u00e7\u00e3o significativo. Embora exista uma ten-\n\nd\u00eancia em se adotar m\u00e9todos mais robustos como o totalmente impl\u00edcito para simula\u00e7\u00e3o de \n\nreservat\u00f3rios, ainda existe um interesse consider\u00e1vel no uso e aperfei\u00e7oamento do m\u00e9todo \n\nIMPES (Chen et al., 2004, Hurtado et al., 2006). Neste trabalho, \u00e9 apresentado um proce-\n\ndimento adaptativo do m\u00e9todo IMPES que visa reduzir o tempo total de simula\u00e7\u00e3o para \n\nproblemas de fluxo bif\u00e1sico \u00f3leo-\u00e1gua.  \n\n4.3 IMPES modificado \n\n \n\n No presente trabalho, \u00e9 implementada uma metodologia IMPES modificada se-\n\nguindo essencialmente o trabalho de Hurtado et al. (2006), cuja implementa\u00e7\u00e3o por ele-\n\nmento \u00e9 bastante direta sendo bem mais simples e mais econ\u00f4mica computacionalmente \n\nque a estrat\u00e9gia proposta em Chen et al. (2004). A diferen\u00e7a b\u00e1sica entre as duas metodo-\n\n\n\n58 \n\nlogias se concentra essencialmente na forma de se controlar o intervalo de tempo em que o \n\ncampo de press\u00f5es e de velocidades devem ser atualizados.  \n\n Na metodologia proposta por Chen et al. (2004), o controle do passo de tempo se \n\nbaseia no controle da varia\u00e7\u00e3o local m\u00e1xima do campo de satura\u00e7\u00f5es, enquanto que na t\u00e9c-\n\nnica proposta por Hurtado et al. (2006) este controle se d\u00e1 pela varia\u00e7\u00e3o temporal do cam-\n\npo de velocidades. A implementa\u00e7\u00e3o por arestas adotada, al\u00e9m de ser bastante direta, pode \n\nser utilizada indistintamente para problemas 2-D e 3-D.  \n\nA estrat\u00e9gia por tr\u00e1s do IMPES modificado adotado aqui consiste em permitir que a \n\nequa\u00e7\u00e3o de press\u00e3o seja resolvida um n\u00famero menor de vezes atribuindo passos de tempo \n\nmais longos, por\u00e9m limitados, de forma a n\u00e3o comprometer significativamente a acur\u00e1cia \n\nda solu\u00e7\u00e3o num\u00e9rica obtida. O c\u00e1lculo do campo de satura\u00e7\u00f5es continua sendo regido pela \n\ncondi\u00e7\u00e3o de CFL. Os passos a serem seguidos podem ser melhor compreendidos atrav\u00e9s do \n\nalgoritmo 4.2. \n\n O algoritmo para o IMPES modificado faz uso de duas vari\u00e1veis booleanas para o \n\ncontrole do avan\u00e7o impl\u00edcito e expl\u00edcito atrav\u00e9s de _avan\u00e7o imp  e _avan\u00e7o exp respecti-\n\nvamente. Durante o la\u00e7o sobre as arestas para o c\u00e1lculo do campo de velocidades, tamb\u00e9m \n\n\u00e9 calculada uma norma \nn\n\nTv?\n?\n\n \npara esta vari\u00e1vel e que ser\u00e1 usada para determinar o avan\u00e7o \n\nde tempo impl\u00edcito 1nPt\n+\n\n? . Na pr\u00e1tica, este avan\u00e7o representa o intervalo de tempo em que \n\nos campos de press\u00f5es e velocidades s\u00e3o atualizados e \u00e9 calculado como: \n\n \n\n 1n nP Pn\nT\n\nDVTOL\nt t\n\nv\n+\n\n? = ?\n?\n?  (4.7) \n\n \n\nonde DVTOL \u00e9 uma toler\u00e2ncia prescrita e \nn\n\nTv?\n?\n\n \u00e9 uma norma para a varia\u00e7\u00e3o do campo de \n\nvelocidades longo do intervalo de tempo nPt? . No in\u00edcio da simula\u00e7\u00e3o, assume-se \n\nn\nP CFLt t? = ? , ou seja, o mesmo passo de tempo regido pela condi\u00e7\u00e3o de CFL. A partir de \n\numa pequena modifica\u00e7\u00e3o do trabalho de Hurtado et al. (2006), \nn\n\nTv?\n?\n\n \u00e9 calculada como \n\numa norma L2 por arestas: \n\n \n\n \n( )\n\n2\n, , 1\n\n.\nr r r\n\nr\n\nr\n\nn n\nIJ IJ IJn\n\nT\nIJ IJ\n\nv v C\nv\n\nC\n?\n\n? ? ? ?\n\n?\n\n? ?? ?\n? ?? =\n? ?\n? ?\n\n?\n\n?? ?\n\n?\n?  (4.8) \n\n\n\n59 \n\nSw(t=0) \nEnquanto (tempo_simula\u00e7\u00e3o &lt;tempo_total){ \n\nLa\u00e7o sobre os dom\u00ednios{ \n  La\u00e7o sobre as aresta e faces do contorno (se 3-D) para: \n\n C\u00e1lculo do campo de press\u00f5es por meio de um sistema de equa\u00e7\u00f5es; \n} \n \n\n_avan\u00e7o imp verdadeiro=  \n_avan\u00e7o exp verdadeiro=  \n\nSe ( _avan\u00e7o exp verdadeiro= ){ \nLa\u00e7o sobre os dom\u00ednios{ \n Se ( _avan\u00e7o imp verdadeiro= ){ \n\n La\u00e7o sobre as aresta e faces do contorno (se 3-D) para: \n Recupera\u00e7\u00e3o dos gradientes nodais; \n \n La\u00e7o sobre as arestas para: \n C\u00e1lculo do campo de velocidades e\n\n \n\n( )\n2\n\n, , 1\n\n;\nr r r\n\nr\n\nr\n\nn n\nIJ IJ IJn\n\nT\nIJ IJ\n\nv v C\nv\n\nC\n?\n\n? ? ? ?\n\n?\n\n? ?? ?\n? ?? =\n? ?\n? ?\n\n?\n\n?? ?\n\n?\n?  \n\n} \n La\u00e7o sobre as arestas para: \n\nC\u00e1lculo dos termos de fluxo nodal e determina\u00e7\u00e3o de rt ?? ; \n} \n\n_avan\u00e7o imp falso=  \n\n( )rt min t ?? = ?  \n\n1n n\nP Pn\n\nT\n\nDVTOL\nt t\n\nv\n+\n\n? = ?\n?\n?  \n\n_ _sum exp sum exp t= + ?  \n\nSe ( 1_ nPsum exp t\n+\n\n? ? ) \n\n _avan\u00e7o exp falso=\n\n  Sen\u00e3o \n La\u00e7o sobre os n\u00f3s para: \n C\u00e1lculo do campo de satura\u00e7\u00f5es; \n\n} \n1_   _  nPtempo simula\u00e7\u00e3o tempo simula\u00e7\u00e3o t\n\n+\n= + ?  \n\n} \nAlgoritmo 4.2 \u2013 M\u00e9todo IMPES modificado. \n \n Esta norma representa a varia\u00e7\u00e3o do campo de velocidades durante o intervalo de \n\ntempo nPt? , obtida a partir da varia\u00e7\u00e3o m\u00e9dia das vaz\u00f5es (fluxos normais) ao longo das su-\n\nperf\u00edcies de controle para todos os volumes de controle da malha, onde \nIJ\n?  indica que o \n\nsomat\u00f3rio \u00e9 realizado para todas as arestas da malha. No algoritmo 4.2, _sum exp acumula \n\n\n\n60 \n\nos avan\u00e7os de tempo do campo de satura\u00e7\u00f5es dentro do intervalo de tempo 1nPt\n+\n\n? . Enquan-\n\nto o somat\u00f3rio dos passos de tempo da equa\u00e7\u00e3o de satura\u00e7\u00e3o _sum exp  for inferior a \n\n1n\nPt\n\n+\n? , os campos de press\u00f5es e velocidades permanecem inalterados. \n\n Com o objetivo de evitar uma varia\u00e7\u00e3o (crescimento ou decrescimento) muito r\u00e1pi-\n\nda no intervalo de tempo para o campo de press\u00f5es, utiliza-se uma restri\u00e7\u00e3o da forma: \n\n \n\n \n1\n\n0.75 1.25\nn\nP\n\nn\nP\n\nt\n\nt\n\n+\n?\n\n? ?\n?\n\n (4.9) \n\n \n\n Portanto, se 1nPt\n+\n\n?  calculado pela Eq. (4.7) estiver fora dos limites fornecidos pela \n\nEq. (4.9) adota-se 1 0.75n nP Pt t\n+\n\n? = ?  ou 1 1.25n nP Pt t\n+\n\n? = ? . \n\n A fim de utilizar esta metodologia de modo seguro, \u00e9 necess\u00e1rio que se verifique o \n\nefeito que a mesma tem na acur\u00e1cia das solu\u00e7\u00f5es num\u00e9ricas obtidas. Inicialmente, deve-se \n\ndeterminar quais os valores da toler\u00e2ncia DVTOL fornecem o melhor compromisso entre \n\nacur\u00e1cia e custo de CPU. \n\n A seguir, s\u00e3o apresentados testes realizados com malhas de tetraedros para um pro-\n\nblema de \u00bc de cinco po\u00e7os com meio homog\u00eaneo e heterog\u00eaneo. Nestes testes, procura-se \n\nmostrar para v\u00e1rios DVTOL a rela\u00e7\u00e3o entre ganho de tempo de CPU e acur\u00e1cia nos resulta-\n\ndos de \u00f3leo recuperado e \u00f3leo acumulado para dois tipos de malhas com refinamentos de \n\numa ordem de grandeza de diferen\u00e7a. \n\n \n\n4.4 Resultados \n\n \n\n4.4.1 Problema de \u00bc de five-spot invertido com meio homog\u00eaneo e raz\u00e3o de viscosida-\n\nde moderadamente adversa \n\n \n\n Este exemplo \u00e9 uma vers\u00e3o adimensionalizada do cl\u00e1ssico problema de \u00bc de five-\n\nspot invertido, no qual um po\u00e7o injetor de \u00e1gua est\u00e1 rodeado por quatro po\u00e7os produtores \n\nde \u00f3leo. Para este problema, adaptado de Durlofsky (1993) e Carvalho (2005), as satura-\n\n\u00e7\u00f5es residuais de \u00e1gua e \u00f3leo s\u00e3o 0.0rw roS S= =  e o meio poroso \u00e9 considerado homog\u00ea-\n\nneo e isotr\u00f3pico com K I=\n?\n\n atrav\u00e9s de todo o dom\u00ednio. \n\n\n\n61 \n\n Considera-se ainda que a porosidade \u00e9 constante, mas seu valor real n\u00e3o \u00e9 relevan-\n\nte, j\u00e1 que a mesma \u00e9 utilizada apenas para adimensionalizar o tempo. As viscosidades da \n\n\u00e1gua e do \u00f3leo s\u00e3o, respectivamente, 1.0w\u00b5 =  e 4.0,o\u00b5 =  de modo que a raz\u00e3o entre as \n\nviscosidades \u00e9 ( ) 4.0.o wM \u00b5 \u00b5= =  As condi\u00e7\u00f5es de contorno s\u00e3o 1.0iS =  no po\u00e7o injetor \n\ne press\u00f5es nos cantos diagonais superior esquerdo e inferior direito 0.0.se idP P= =  Admite-\n\nse ainda fluxo nulo atrav\u00e9s das fronteiras do reservat\u00f3rio. \n\n Durlofsky (1993) resolveu este problema, que apresenta um efeito de orienta\u00e7\u00e3o de \n\nmalhas moderado devido \u00e0 raz\u00e3o entre as viscosidades 1.0,M >  utilizando uma formula-\n\n\u00e7\u00e3o h\u00edbrida, em que o problema press\u00e3o-velocidade foi resolvido a partir do m\u00e9todo dos \n\nelementos finitos mistos e a equa\u00e7\u00e3o de satura\u00e7\u00e3o foi resolvida utilizando um m\u00e9todo de \n\nvolumes finitos de alta ordem.  \n\n Para avaliar o efeito de orienta\u00e7\u00e3o de malhas, Durlofsky (1993) utilizou duas ma-\n\nlhas estruturadas e uniformes com 400 elementos triangulares, uma cujos elementos s\u00e3o \n\norientados segundo a dire\u00e7\u00e3o do escoamento (malha alinhada) e outra, cujos elementos s\u00e3o \n\norientados transversalmente ao escoamento.  \n\n No presente trabalho, s\u00e3o utilizadas duas malhas tetra\u00e9dricas n\u00e3o-estruturadas: uma \n\ncom 2.004 n\u00f3s e 7.641 elementos e outra com 10.201 n\u00f3s e 45.127 elementos (malha B). \n\nNas Figuras 4.1 (a) e (b) s\u00e3o apresentados os valores do \u00f3leo recuperado e nas Figuras 4.2 \n\n(a) e (b) os valores de \u00f3leo acumulado, ambos obtidos pelo m\u00e9todo IMPES convencional e \n\npelo m\u00e9todo IMPES modificado para os seguintes valores de DVTOL: 10-4, 5x10-4, 10-3, \n\n5x10-3, 10-2, 5x10-2, 10-1. \n\n O volume poroso injetado (Pore volume injected \u2013 PVI) \u00e9 o par\u00e2metro usado para \n\ndeterminar a dura\u00e7\u00e3o das simula\u00e7\u00f5es e representa o tempo adimensionalizado e calculado \n\npor \np\n\nQdt\n\nV?\n, onde Vp \u00e9 o volume total de poros do sistema e Q \u00e9 a vaz\u00e3o total Aqui, todas as \n\nsimula\u00e7\u00f5es s\u00e3o realizadas para PVI=1.0. Uma amplia\u00e7\u00e3o \u00e9 feita sobre as curvas de \u00f3leo \n\nrecuperado, Figs. 4.3a e 4.3b e de \u00f3leo acumulado, Fig. 4.4a e 4.4b, pr\u00f3xima a regi\u00e3o de \n\nirrup\u00e7\u00e3o de \u00e1gua mostrando a ocorr\u00eancia de uma forte discrep\u00e2ncia nas diferentes curvas \n\nobtidas para diferentes valores de DVTOL. \n\n \n\n\n\n62 \n\n \n\n(a) \n\n \n\n(b) \n\nFigura 4.1 \u2013 Curvas de \u00f3leo recuperado. V\u00e1rios DVTOL do IMPES modificado confronta-\n\ndos com o IMPES cl\u00e1ssico para malhas de (a) 2004 e (b) 10.201 n\u00f3s. \n\n\n\n63 \n\n \n\n(a) \n\n \n\n \n\n(b) \n\nFigura 4.2 \u2013 Curvas de \u00f3leo acumulado. V\u00e1rios DVTOL do IMPES modificado confronta-\n\ndos com o IMPES cl\u00e1ssico para as malhas de 2004 (a) e 10.201 B (b) n\u00f3s. \n\n \n\n\n\n64 \n\n \n\n \n\n(a) \n\n \n\n(b) \n\nFigura 4.3 \u2013 Amplia\u00e7\u00e3o das curvas de \u00f3leo recuperado na regi\u00e3o onde a \u00e1gua atinge o po\u00e7o \n\nprodutor (breakthrough) para as malhas de 2004 (a) e 10.201 B (b) n\u00f3s. \n\n \n\n\n\n65 \n\n \n\n(a) \n\n \n\n(b) \n\nFigura 4.4 \u2013 Amplia\u00e7\u00e3o das curvas de \u00f3leo acumulado destacando a discrep\u00e2ncia entre os \n\nresultados para v\u00e1rios DVTOL e o IMPES tradicional para as malhas de 2004 (a) e 10.201 \n\nB (b) n\u00f3s. \n\n\n\n66 \n\n A partir das Figs.4.3 e 4.4 e tomando como refer\u00eancia o m\u00e9todo IMPES convencio-\n\nnal observa-se claramente que os DVTOLS que melhor reproduzem tanto a curva de \u00f3leo \n\nrecuperado quanto a curva de \u00f3leo acumulado s\u00e3o aqueles variando entre \n\n4 31.10 5.10DVTOL? ?? ? . Fica claro tamb\u00e9m que, \u00e0 medida que se aumenta a toler\u00e2ncia \n\npara valores maiores ( )21.10DVTOL ?? , tanto os valores de \u00f3leo produzido quanto os va-\n\nlores de \u00f3leo acumulado v\u00e3o se distanciando do valor referencial, havendo ainda um retar-\n\ndamento do tempo de irrup\u00e7\u00e3o de \u00e1gua (breakthrough). \n\n Outro fator importante a ser considerado, e que na verdade \u00e9 a motiva\u00e7\u00e3o inicial \n\npara a utiliza\u00e7\u00e3o da vers\u00e3o modificada do m\u00e9todo IMPES, \u00e9 a quest\u00e3o do ganho computa-\n\ncional obtido com a utiliza\u00e7\u00e3o do procedimento e sua rela\u00e7\u00e3o com a varia\u00e7\u00e3o da acur\u00e1cia \n\ndo m\u00e9todo. \n\n Na Figura 4.5, s\u00e3o apresentados, no mesmo gr\u00e1fico, os tempos de computa\u00e7\u00e3o \n\n(normalizados pelo tempo gasto pelo m\u00e9todo IMPES tradicional), bem como os erros rela-\n\ntivos na produ\u00e7\u00e3o acumulada de \u00f3leo, comparando-se o m\u00e9todo IMPES tradicional com o \n\nm\u00e9todo IMPES modificado utilizando-se os diferentes valores da toler\u00e2ncia DVTOL. \n\n \n\nFigura 4.5 \u2013 Rela\u00e7\u00e3o entre o tempo total de CPU e a acur\u00e1cia dos resultados para v\u00e1rios \n\nDVTOL. \u00c9 tomada como refer\u00eancia a curva de \u00f3leo acumulado do m\u00e9todo IMPES tradi-\n\ncional. Apenas para a malha de 10.201 n\u00f3s com meio homog\u00eaneo. \n\n \n\n\n\n67 \n\n Novamente, fica claro nesta figura, que os valores de DVTOL que apresentam me-\n\nlhor concord\u00e2ncia com o m\u00e9todo IMPES tradicional s\u00e3o aqueles compreendidos no inter-\n\nvalo 4 31.10 5.10DVTOL? ?? ? . Na verdade, para os valores de 41.10DVTOL ?=  e \n\n45.10DVTOL ?=  os valores para o erro percentual da produ\u00e7\u00e3o acumulada s\u00e3o menores \n\nque 0,004% enquanto que para 11.10DVTOL ?=  este erro foi de 0,44% ao final de 1,0 PVI. \n\nPor outro lado, o tempo de an\u00e1lise decresce com o aumento do DVTOL, atingindo um va-\n\nlor \u201cm\u00ednimo\u201d para 11.10DVTOL ?=  no intervalo considerado, como pode claramente ser \n\nvisto na Fig. 4.5. \n\n A partir da figura 4.5, pode-se ainda concluir que um bom compromisso entre acu-\n\nr\u00e1cia e tempo de computa\u00e7\u00e3o \u00e9 obtido no intervalo 3 31.10 5.10DVTOL? ?? ? , em que o erro \n\nrelativo percentual para a produ\u00e7\u00e3o acumulada de \u00f3leo varia entre \n\n0, 00619% 0, 039%Err? ?  e o tempo relativo percentual de computa\u00e7\u00e3o entre as metodo-\n\nlogias IMPES e IMPES modificado varia entre 15, 05% 11, 65%TR? ? . \n\n As figuras 4.6a e 4.6b mostram a raz\u00e3o entre o tamanho do passo de tempo impl\u00edci-\n\nto (avan\u00e7o do campo de press\u00f5es e de velocidades) pelo tamanho do passo de tempo expl\u00ed-\n\ncito (avan\u00e7o do campo de satura\u00e7\u00f5es) para as malhas de 2.004 e 10.201 n\u00f3s, respectiva-\n\nmente. Percebe-se que para a malha menor e para a faixa de DVTOL que apresentam resul-\n\ntados mais pr\u00f3ximos do IMPES tradicional, o m\u00e9todo s\u00f3 come\u00e7a a acelerar a partir da che-\n\ngada da \u00e1gua ao po\u00e7o produtor ( 0.45)PVI ? . \n\n Com a malha de 10.201 n\u00f3s, a curva com 35 10DVTOL ?= ? , por exemplo, cujos \n\nresultados n\u00e3o se distanciam demasiadamente do IMPES tradicional, permite que se ganhe \n\nalgum tempo de simula\u00e7\u00e3o antes do breakthrough. \n\n \n\n\n\n68 \n\n \n\n(a) \n\n \n\n \n\n(b) \n\nFigura 4.6 \u2013 Rela\u00e7\u00e3o entre o tamanho do passo de tempo impl\u00edcito pelo passo de tempo \n\nexplicito para as malhas de 2004 (a) e 10.201 B (b) n\u00f3s. \n\n \n\n\n\n69 \n\n4.4.2 Problema de \u00bc de Cinco Po\u00e7os Heterog\u00eaneo com Raz\u00e3o de Viscosidade Mode-\n\nradamente Adversa. \n\n \n\n Neste exemplo, todas as condi\u00e7\u00f5es iniciais e de contorno s\u00e3o id\u00eanticas as do pro-\n\nblema anterior, onde a \u00fanica modifica\u00e7\u00e3o feita foi a introdu\u00e7\u00e3o de uma barreira quadrada \n\nno interior do dom\u00ednio com 210K I?= ?\n?\n\na fim de avaliar se este tipo de configura\u00e7\u00e3o pode-\n\nria causar alguma modifica\u00e7\u00e3o importante na determina\u00e7\u00e3o do DVTOL \u00f3timo de simula-\n\n\u00e7\u00e3o.  \n\n Novamente, foram utilizadas duas malhas tetra\u00e9dricas com as 2021 e 10.448 n\u00f3s. \n\nNas Figuras 4.7 (a) e (b) e 4.8 (a) e (b) s\u00e3o apresentadas, respectivamente, os valores do \n\n\u00f3leo recuperado e do \u00f3leo acumulado, ambos obtidos pelo m\u00e9todo IMPES convencional e \n\npelo m\u00e9todo IMPES modificado para os mesmos valores de DVTOL: 10-4, 5x10-4, 10-3, \n\n5x10-3, 10-2, 5x10-2, 10-1 utilizados na aplica\u00e7\u00e3o anterior. \n\n As Figuras 4.9 (a) e (b) apresentam uma amplia\u00e7\u00e3o para a curva do \u00f3leo recuperado \n\nna regi\u00e3o pr\u00f3xima a irrup\u00e7\u00e3o de \u00e1gua e nas figuras 4.10 (a) e (b) apresenta-se outra amplia-\n\n\u00e7\u00e3o para as curvas de \u00f3leo acumulado numa regi\u00e3o onde ocorre uma discrep\u00e2ncia nas dife-\n\nrentes curvas obtidas para diferentes valores de DVTOL. \n\n A partir das figuras 4.9 e 4.10 e tomando como refer\u00eancia o m\u00e9todo IMPES con-\n\nvencional, observa-se claramente que os DVTOLS que melhor reproduzem, tanto a curva \n\nde \u00f3leo recuperado, quanto a curva de \u00f3leo acumulado s\u00e3o aqueles variando entre \n\n4 31.10 5.10DVTOL? ?? ? . Fica claro tamb\u00e9m que, \u00e0 medida que aumentamos a toler\u00e2ncia \n\npara valores maiores ( )21.10DVTOL ?? , tanto os valores de \u00f3leo produzido quanto os va-\n\nlores para o \u00f3leo acumulado v\u00e3o se distanciando do valor referencial, havendo ainda um \n\nforte retardamento do tempo de irrup\u00e7\u00e3o de \u00e1gua. \n\n Na Figura 4.11 s\u00e3o apresentados no mesmo gr\u00e1fico os tempos de computa\u00e7\u00e3o \n\n(normalizados pelo tempo gasto pelo m\u00e9todo IMPES cl\u00e1ssico), bem como os erros relati-\n\nvos na produ\u00e7\u00e3o acumulada comprando-se com o m\u00e9todo IMPES tradicional como o m\u00e9-\n\ntodo IMPES modificado utilizando-se os diferentes valores de DVTOL.  \n\n Novamente, fica claro nesta figura, que os valores de DVTOL que apresentam me-\n\nlhor concord\u00e2ncia com o m\u00e9todo IMPES cl\u00e1ssico s\u00e3o aqueles compreendidos no intervalo \n\n4 31.10 5.10DVTOL? ?? ? . Na verdade, para os valores de 41.10DVTOL ?=  e \n\n\n\n70 \n\n45.10DVTOL ?=  os valores para o erro percentual da produ\u00e7\u00e3o acumulada s\u00e3o menores \n\nque 0,004% enquanto que para 11.10DVTOL ?=  este erro foi de 0,44% ao final de 1,0 PVI. \n\n \n\nFigura 4.7 \u2013 Curvas de \u00f3leo recuperado para malhas de 2021 (a) e 10.448 (b) n\u00f3s. \n\n \n\n(a) \n\n \n\n(b) \n\n\n\n71 \n\n \n\n(a) \n\n \n\n(b) \n\nFigura 4.8 \u2013 Curvas de produ\u00e7\u00e3o acumulada para malhas de 2021 (a) e 10.448 (b) n\u00f3s. \n\n \n\n\n\n72 \n\n \n\n(a) \n\n \n\n \n\n(b) \n\nFigura 4.9 \u2013 Amplia\u00e7\u00e3o das curvas de \u00f3leo recuperado para o instante onde a \u00e1gua chega \n\nao po\u00e7o produtor. \n\n\n\n73 \n\n \n\n(a) \n\n \n\n(b) \n\nFigura 4.10 \u2013 Amplia\u00e7\u00e3o das curvas de \u00f3leo acumulado. \n\n \n\n \n\n \n\n\n\n74 \n\n \n\n \n\n(a) \n\n \n\n \n\n(b) \n\nFigura 4.11 \u2013 Rela\u00e7\u00e3o entre o tamanho do passo de tempo impl\u00edcito pelo passo de tempo \n\nexpl\u00edcito para uma malha de 2021 (a) e 10.448 (b) n\u00f3s respectivamente. \n\n\n\n75 \n\n As figuras 4.12 (a) e (b) mostram a rela\u00e7\u00e3o entre o tamanho do passo de tempo im-\n\npl\u00edcito (avan\u00e7o do campo de press\u00f5es e de velocidades) pelo tamanho do passo de tempo \n\nexpl\u00edcito (avan\u00e7o do campo de satura\u00e7\u00f5es) para as malhas de 2.000 e 10.000 n\u00f3s. Nos dois \n\nexemplos, todos os DVTOLS que oferecem os melhores resultados, apenas aceleram a si-\n\nmula\u00e7\u00e3o a partir do ponto de irrup\u00e7\u00e3o de \u00e1gua com exce\u00e7\u00e3o do 35 10DVTOL ?= ?  como \n\naconteceu no caso homog\u00eaneo. Isso mostra que \u00e9 poss\u00edvel j\u00e1 obter um ganho computacio-\n\nnal antes do instante de ( 0.45)PVI ? . \n\n \n\n \n\n \n\nFigura 4.12 \u2013 Rela\u00e7\u00e3o entre o tempo total de CPU e a acur\u00e1cia dos resultados para v\u00e1rios \n\nDVTOL. \u00c9 tomada como refer\u00eancia a curva de \u00f3leo acumulado do m\u00e9todo IMPES tradi-\n\ncional. Apenas para a malha de 10.448 n\u00f3s com meio heterog\u00eaneo \n\n4.4 Outros m\u00e9todos: Seq\u00fcencial Impl\u00edcito, Totalmente Impl\u00edcito e Adap-\n\ntativo Impl\u00edcito-Expl\u00edcito \n\n \n\n O m\u00e9todo seq\u00fcencial impl\u00edcito e o m\u00e9todo totalmente impl\u00edcito (fully implicit), \n\ntamb\u00e9m conhecido como m\u00e9todo de solu\u00e7\u00e3o simult\u00e2nea s\u00e3o m\u00e9todos mais robustos do que \n\no IMPES e empregados em problemas com maior grau de acoplamento implicando em \n\numa n\u00e3o-linearidade mais forte das equa\u00e7\u00f5es. O m\u00e9todo seq\u00fcencial impl\u00edcito aparece como \n\n\n\n76 \n\num m\u00e9todo intermedi\u00e1rio em termos de efici\u00eancia computacional e robustez quando com-\n\nparado ao IMPES e ao totalmente impl\u00edcito. J\u00e1 este \u00faltimo aparece no extremo de m\u00e1xima \n\nrobustez e m\u00e1ximo uso de CPU e mem\u00f3ria sendo o mais indicado na resolu\u00e7\u00e3o de proble-\n\nmas utilizando o modelo black-oil. Para problemas de grande porte, o m\u00e9todo de solu\u00e7\u00e3o \n\nsimult\u00e2nea pode se tornar um grande desafio em termos de custo computacional. O m\u00e9todo \n\nadaptativo impl\u00edcito-expl\u00edcito tenta aliar a economia do m\u00e9todo IMPES e a robustez do \n\nm\u00e9todo totalmente impl\u00edcito (Chen et al. 2006). \n\n Vale a pena enfatizar que, neste trabalho, o prop\u00f3sito de construir um simulador de \n\nreservat\u00f3rios em computadores paralelos j\u00e1 traz uma s\u00e9rie de desafios a serem suplantados \n\ne a escolha do m\u00e9todo IMPES (modificado) como m\u00e9todo de integra\u00e7\u00e3o no tempo foi feito \n\napenas devido a simplicidade de implementa\u00e7\u00e3o do m\u00e9todo. \n\n\n\n77 \n\n5. COMPUTA\u00c7\u00c3O PARALELA \n \n\n5.1 Introdu\u00e7\u00e3o \n \n\n Aplica\u00e7\u00f5es de computador podem ser geralmente classificadas como aplica\u00e7\u00f5es \n\nseriais, distribu\u00eddas ou paralelas. Aplica\u00e7\u00f5es seriais, onde uma inst\u00e2ncia de uma aplica\u00e7\u00e3o \n\n\u00e9 executada em um \u00fanico processador, representa a grande maioria dos softwares usados \n\npelas pessoas em seus computadores pessoais. Aplica\u00e7\u00f5es distribu\u00eddas fazem uso de m\u00falti-\n\nplos computadores que contem tarefas independentes que n\u00e3o interagem entre si. Um tipo \n\nde tarefa distribu\u00edda pode ser visto nas simula\u00e7\u00f5es de Monte Carlo, onde tipicamente o \n\nmesmo algoritmo \u00e9 executado v\u00e1rias e v\u00e1rias vezes com diferentes par\u00e2metros de entrada. \n\nAs aplica\u00e7\u00f5es em paralelo, o foco deste trabalho, tamb\u00e9m fazem uso de v\u00e1rios computado-\n\nres, mas contem tarefas interdependentes que trocam dados enquanto est\u00e3o sendo executa-\n\ndas. A figura 5.1 apresenta de forma geral a taxonomia de importantes classes de computa-\n\ndores paralelos e distribu\u00eddos. \n\n \n\n \n\nFigura 5.1 \u2013 Taxonomia de importantes classes de computadores paralelos e distribu\u00ed-\ndos. \n\n \n\n Dentro da classe de computadores paralelos, onde se insere o presente trabalho, os \n\ncomputadores de mem\u00f3ria compartilhada e de mem\u00f3ria distribu\u00edda, conhecidos como \n\ncomputadores MIMD (Multiple \u2013 Instruction, Multiple \u2013 Data stream), t\u00eam em comum o \n\nfato dos processadores executarem instru\u00e7\u00f5es de forma completamente independentes. J\u00e1 \n\nos computadores de arquitetura SIMD (Single \u2013 Instruction, Multiple \u2013 Data stream), todos \n\n\n\n78 \n\nos processadores completam a execu\u00e7\u00e3o de uma instru\u00e7\u00e3o antes de prosseguir para outra \n\ninstru\u00e7\u00e3o. \n\n M\u00e1quinas paralelas com arquitetura SIMD se diferenciam das duas anteriores por \n\nusarem processadores mais especializados (processadores vetoriais) e exigirem hardware \n\nespecificamente projetado para us\u00e1-los (Flynn, 1996) (Fujimoto, 2000). \n\nEmbora os clusters, uma cole\u00e7\u00e3o de Wokstations/PCs conectados em rede, tenham preva-\n\nlecido como a arquitetura mais usada em aplica\u00e7\u00f5es de computa\u00e7\u00e3o alto desempenho, \n\n(HPC) High Performance Computing, (Strohmaier et al, 2005), computadores vetoriais \n\ncomo o Earth Simulator mostram que muitas aplica\u00e7\u00f5es cient\u00edficas podem se beneficiar \n\ndos computadores vetoriais (Strohmaier et al, 2005). \n\n Os primeiros testes de simula\u00e7\u00e3o realizados neste trabalho foram feitos usando um \n\ncluster (zumbi) adquirido pelo grupo de processamento de alto desempenho (PADMEC) \n\nda UFPE que contem 48 n\u00f3s, onde cada n\u00f3 possui dois processadores de 32bits, 2GB de \n\nRAM, HD 40GB. A rede \u00e9 controlada por 3 switches 3 Com Fast Ethernet e o sistema ope-\n\nracional \u00e9 o Linux. \n\n Os resultados de desempenho e escalabilidade foram obtidos usando um cluster \n\nmais moderno comparado ao zumbi e que faz parte do N\u00facleo de Atendimento em Compu-\n\nta\u00e7\u00e3o de Alto Desempenho (NACAD) da COPPE/UFRJ. O cluster do NACAD \u00e9 um SGI \n\nAltix ICE 8200 com as seguintes configura\u00e7\u00f5es: \n\n \n\n\u2022 38 CPUs Quad Core Intel Xeon: 152 cores \u2013 64 bits  \n\n\u2022 Mem\u00f3ria: 304 Gbytes RAM (distribu\u00edda) \n\n\u2022 Armazenamento em disco: SGI Infinite Storage NAS (32 TBytes)  \n\n\u2022 Sistema operacional: Suse Linux Enterprise Server + SGI ProPack \n\n\u2022 Compiladores: Intel e GNU (Fortran-90 e C/C++) com suporte OpenMP e MPI \n\n\u2022 Rede: Inifiniband e Gigabit \n\n \n\n Embora todo o desenvolvimento do simulador tenha sido pensado para funcionar \n\nem computadores de mem\u00f3ria distribu\u00edda, vale mencionar o surgimento de um novo para-\n\ndigma em computa\u00e7\u00e3o paralela com o uso de m\u00e1quinas de mem\u00f3ria distribu\u00edda-\n\ncompartilhada, distributed shared-memory (DSM), nas comunidades cient\u00edficas. O interes-\n\nse \u00e9 fazer o melhor uso destes dois sistemas onde a combina\u00e7\u00e3o destas duas metodologias \n\n\n\n79 \n\nde paraleliza\u00e7\u00e3o pode fornecer uma forma mais efetiva para explorar os modernos sistemas \n\ncom mem\u00f3ria distribu\u00edda e compartilhada (Hughes, 2003) \n\n Simula\u00e7\u00f5es de grande porte que requerem computadores de alto desempenho s\u00e3o \n\nimportantes em muitas \u00e1reas da engenharia. Problemas que envolvem din\u00e2mica dos flui-\n\ndos, eletromagnetismo, ac\u00fastica, entre outros, geralmente s\u00e3o definidos por equa\u00e7\u00f5es dife-\n\nrenciais parciais n\u00e3o-lineares dependentes do tempo que consomem um grande tempo de \n\ncomputa\u00e7\u00e3o.  \n\n A simula\u00e7\u00e3o em reservat\u00f3rios de petr\u00f3leo representa outra \u00e1rea da engenharia onde \n\no uso da computa\u00e7\u00e3o paralela \u00e9 imprescind\u00edvel. Al\u00e9m do grande n\u00famero de blocos usados \n\nna discretiza\u00e7\u00e3o do reservat\u00f3rio, que pode conter de centenas de milhares a milh\u00f5es, de-\n\npendendo do modelo usado (black-oil, composicional ou t\u00e9rmico, por exemplo), o proble-\n\nma pode conter v\u00e1rias inc\u00f3gnitas como press\u00e3o, satura\u00e7\u00e3o das fases, composi\u00e7\u00e3o e tempe-\n\nratura (Chen, 2004).  \n\n A seguir, s\u00e3o descritos os procedimentos e conseq\u00fcentes esclarecimentos a respeito \n\nda paraleliza\u00e7\u00e3o do simulador de fluxo \u00f3leo-\u00e1gua em reservat\u00f3rios de petr\u00f3leo abordando a \n\nfilosofia paralela adotada, o tipo de linguagem de programa\u00e7\u00e3o e das ferramentas auxilia-\n\nres usadas e uma descri\u00e7\u00e3o do simulador e de seu pr\u00e9-processador. \n\n \n\n5.2 Filosofia adotada na implementa\u00e7\u00e3o \n \n\n A computa\u00e7\u00e3o paralela tem como principal filosofia a divis\u00e3o de uma tarefa em ou-\n\ntras menores onde cada uma destas \u00e9 chamada de processos. Uma das premissas para se \n\natingir o m\u00e1ximo desempenho em simula\u00e7\u00f5es paralelas \u00e9 atribuir um processo a uma \u00fanica \n\nunidade de processamento (CPU). \n\n Projetar um programa para ser executado em paralelo requer uma forma diferente \n\nde pensar daquela usada para se construir um programa puramente seq\u00fcencial. Um pro-\n\ngrama paralelo \u00e9 constru\u00eddo para ser executado com se fosse um \u00fanico programa onde cada \n\nprocessador executa uma c\u00f3pia deste e processa apenas uma fra\u00e7\u00e3o do problema total. A \n\nsimula\u00e7\u00e3o de reservat\u00f3rios de petr\u00f3leo, por exemplo, faz uso de uma malha que representa \n\no reservat\u00f3rio discretizado a ser simulado. Todos os processadores executam o mesmo \n\nprograma, por\u00e9m lidando com partes distintas do problema. \n\n Em computadores de mem\u00f3ria distribu\u00edda, cada processo atua de forma ass\u00edncrona, \n\nou seja, por possu\u00edrem uma CPU e uma mem\u00f3ria pr\u00f3pria (acesso local), estes trabalham de \n\n\n\n80 \n\nforma independe uns dos outros. Eventualmente, h\u00e1 necessidade de troca de informa\u00e7\u00f5es \n\nentre os processos (acesso remoto), pois lidam com as partes de um todo. \n\n O programa paralelo deve ser projetado de tal modo que todos os processos envol-\n\nvidos troquem entre si o m\u00ednimo de informa\u00e7\u00f5es poss\u00edveis. O tempo de acesso a uma in-\n\nforma\u00e7\u00e3o remota \u00e9 muito maior do que a uma informa\u00e7\u00e3o armazenada localmente podendo \n\nser superior uma ordem de grandeza ou mais (Fujimoto, 2000). \n\n O tempo de troca de uma mensagem de tamanho L entre processadores ( )C L? \u00e9 \n\nfortemente dependente do hardware utilizado e \u00e9 comumente associado a dois par\u00e2metros \n\nque exercem uma rela\u00e7\u00e3o linear com o tempo total demonstrado pela seguinte express\u00e3o: \n\n \n\n ( ) .C SL L? ? ?= +  (5.1) \n\n \n\nonde S?  \u00e9 a lat\u00eancia (ou atraso) que representa o tempo requerido para enviar um pacote de \n\nmensagem da fonte para o destino. A largura de banda, ? , expressa geralmente em bits \n\npor segundo, refere-se \u00e0 quantidade de dados que podem ser transferidos por segundo. \n\n A distribui\u00e7\u00e3o do trabalho entre os processadores tem um grande impacto no de-\n\nsempenho geral da simula\u00e7\u00e3o. O item 5.4.3 apresenta mais detalhes sobre como a distribui-\n\n\u00e7\u00e3o de carga afeta a simula\u00e7\u00e3o paralela. \n\n \n\n5.3 Decomposi\u00e7\u00e3o de dom\u00ednios \n \n\n T\u00e9cnicas de decomposi\u00e7\u00e3o de dom\u00ednios s\u00e3o largamente usadas em computa\u00e7\u00e3o pa-\n\nralela. Este m\u00e9todo divide o dom\u00ednio computacional em n subdom\u00ednios tal que um proces-\n\nsador trabalha sobre apenas um subdom\u00ednio. Como o mesmo problema \u00e9 dividido entre n \n\nprocessadores, espera-se um ganho significativo de tempo (speed-up), pois o tempo total \n\nde processamento T \u00e9 reduzido a T/n. \n\n Em geral, as t\u00e9cnicas de decomposi\u00e7\u00e3o de dom\u00ednios se dividem entre decomposi\u00e7\u00e3o \n\ncom e sem sobreposi\u00e7\u00e3o de dom\u00ednios. Na primeira, tamb\u00e9m conhecida como overlapping, \n\nos n\u00f3s da regi\u00e3o sobreposta pertencem a mais de um subproblema e na outra (non-\n\noverlapping) apenas os n\u00f3s comuns da fronteira entre subdom\u00ednios pertencem a mais de \n\num subproblema. Esta ultima, \u00e9 a t\u00e9cnica adotada neste trabalho e tem como vantagem a \n\nredu\u00e7\u00e3o computacional dos subproblemas. \n\n\n\n81 \n\n5.4 Programa\u00e7\u00e3o Orientada a Objetos \n \n\n Uma introdu\u00e7\u00e3o sobre programa\u00e7\u00e3o orientada a objetos d\u00e1 uma id\u00e9ia de como os \n\nprogramas que s\u00e3o projetados podem se beneficiar desse paradigma. \n\n A defini\u00e7\u00e3o mais aceita nas comunidades de programadores sobre uma linguagem \n\norientada a objetos \u00e9 que esta deve suportar diretamente: \n\n \n\n\u2022 Abstra\u00e7\u00e3o. \n\n\u2022 Hierarquia. \n\n\u2022 Polimorfismo. \n\n \n\no que inclui as seguintes linguagens: Ada95, Beta, C++, CLOS, Eiffel, Simula, Smalltalk \n\nentre outras. \n\n Por abstra\u00e7\u00e3o, que n\u00e3o significa \u201cvago\u201d ou \u201cimpreciso\u201d, entende-se a capacidade de \n\nrepresentar conceitos de forma direta e independente por meio de classes. Na constru\u00e7\u00e3o de \n\num gerenciador de malhas, o conceito de n\u00f3, por exemplo, \u00e9 bastante claro, pois representa \n\numa entidade com caracter\u00edsticas bem definidas como uma numera\u00e7\u00e3o global (ID) e tr\u00eas \n\ncoordenadas espaciais (x,y e z). \u00c9 por meio das classes que s\u00e3o criados os objetos. Para este \n\nexemplo, valeria a seguinte linha de c\u00f3digo: \n\n \n\nCNode node; \n\n \n\nonde CNode \u00e9 a classe ou o conceito por tr\u00e1s de um n\u00f3, e o objeto node \u00e9 o n\u00f3 de fato, e \n\nque pode acessar e modificar dados a este associados por meio de fun\u00e7\u00f5es definidas em \n\nCNode. \n\n A hierarquia est\u00e1 associada \u00e0 reutiliza\u00e7\u00e3o de classes, onde outras novas s\u00e3o criadas \n\nbaseadas nas existentes e que possuem componentes em comum. Em problemas de adapta-\n\n\u00e7\u00e3o, por exemplo, deseja-se que uma entidade possa acessar seus filhos ou pais. Assim \n\ncomo node \u00e9 um objeto, um objeto aresta (edge), que deu origem a duas outras arestas em \n\num processo de refinamento, deve ser capaz de acessar suas entidades filhos.   \n\n Uma classe CEntity pode fornecer o meio de obter estes filhos n\u00e3o apenas para o \n\nobjeto aresta, mas como tamb\u00e9m para qualquer outro objeto que represente uma entidade \n\nda malha (tri\u00e2ngulo, quadril\u00e1tero, tetraedro, prisma, pir\u00e2mide, etc) que tenha sido refinado. \n\nO trecho de c\u00f3digo abaixo exemplifica tal rela\u00e7\u00e3o: \n\n\n\n82 \n\n \n\n// defini\u00e7\u00e3o de um objeto edge \n\nCEdge edge; \n\n \n\n// acesso \u00e0s entidades filhos por meio de uma fun\u00e7\u00e3o escrita na classe  \n\n// CEntity da qual CEdge \u00e9 derivada \n\nedge.getLeaves(); \n\n \n\n Se houvessem outros objetos representando outros tipos, a fun\u00e7\u00e3o getLeaves pode-\n\nria ser usada para cada um destes objetos sem a necessidade de escrever novas linhas c\u00f3di-\n\ngos. \n\n Por fim, o conceito de polimorfismo fecha as defini\u00e7\u00f5es do que se espera que uma \n\nlinguagem orientada a objetos tenha. O polimorfismo permite que membros de classes pos-\n\nsam ser (re)definidos em classes derivadas. Uma fun\u00e7\u00e3o hipot\u00e9tica getType() definida em \n\nCEntity pode assumir v\u00e1rias formas (implementa\u00e7\u00f5es distintas) em cada classe derivada \n\ninformando, por exemplo, que tipo de entidade ela \u00e9. Usando a sintaxe de C++, um poss\u00ed-\n\nvel trecho de c\u00f3digo seria: \n\n \n\nvirtual CType getType() const=0; \n\n \n\n A palavra virtual indica que getType pode servir de interface para outras classes \n\nque venham a ser derivada desta. Aqui, getType n\u00e3o faz nada. \u00c9 puramente virtual. Dentro \n\nda defini\u00e7\u00e3o da classe CEdge, que herda CEntity, getType passa a ter um prop\u00f3sito claro e \n\nque est\u00e1 relacionado com a classe CEdge retornando um objeto hipot\u00e9tico do tipo CType. \n\n \n\ngetType CType getType(){ \n\n return edgeType; \n\n} \n\n \n\n  Na descri\u00e7\u00e3o do simulador no item 5.5.2 fun\u00e7\u00f5es virtuais s\u00e3o usadas para permitir \n\nque uma equa\u00e7\u00e3o possa ser resolvida por mais de uma formula\u00e7\u00e3o num\u00e9rica.  \n\n \n\n \n\n \n\n\n\n83 \n\n5.4.1 A linguagem C++ \n \n\n Uma linguagem usada essencialmente em todos os dom\u00ednios de programa\u00e7\u00e3o, des-\n\nde drivers para dispositivos \u00e0s aplica\u00e7\u00f5es industriais e acad\u00eamicas de grande porte, de apli-\n\nca\u00e7\u00f5es para os mais modestos computadores aos mais avan\u00e7ados supercomputadores, C++ \n\ntem sido amplamente adotada por pesquisadores, projetistas e desenvolvedores profissio-\n\nnais ao redor do mundo. \n\n Criada por Bjarne Stroustrup na d\u00e9cada de 1980, a linguagem de programa\u00e7\u00e3o ori-\n\nentada a objetos C++ \u00e9 baseada principalmente na linguagem C, definida pelo pr\u00f3prio in-\n\nventor como um superconjunto desta, e na linguagem Simula67, da qual herdou os concei-\n\ntos de classes, heran\u00e7a e fun\u00e7\u00f5es virtuais (Stroustrup, 1997). Tomando ainda como inspira-\n\n\u00e7\u00e3o o conceito de sobrecarga de operadores da linguagem Algol68, C++ se tornou uma das \n\nlinguagens mais populares no meio cient\u00edfico. \n\n Como C, C++ n\u00e3o foi especificamente projetada para computa\u00e7\u00e3o cient\u00edfica. No \n\nentanto, muitas computa\u00e7\u00f5es num\u00e9ricas, cient\u00edficas e de engenharia foram feitas em C++ \n\n(Stroustrup, 2000). Uma importante raz\u00e3o para isto \u00e9 que o trabalho num\u00e9rico tradicional \n\nfreq\u00fcentemente deve ser combinado com gr\u00e1ficos e com computa\u00e7\u00f5es baseadas em estru-\n\nturas de dados que n\u00e3o se ajustam \u00e0 forma de Fortran (Stroustrup, 2000). O principal poder \n\nde C++ est\u00e1 na sua capacidade de ser eficazmente usada para aplica\u00e7\u00f5es que abrangem di-\n\nversas \u00e1reas de aplica\u00e7\u00e3o. \n\n A tarefa de projetar um programa passa basicamente por tr\u00eas est\u00e1gios: compreender \n\nde forma clara o problema (an\u00e1lise), identificar os principais conceitos envolvidos na solu-\n\n\u00e7\u00e3o (projeto) e expressar a solu\u00e7\u00e3o em um programa (programa\u00e7\u00e3o). Geralmente, os dois \n\nprimeiros est\u00e1gios s\u00f3 se tornam realmente claros e bem definidos quando se tenta express\u00e1-\n\nlos e execut\u00e1-los em um programa de forma aceit\u00e1vel. Neste momento \u00e9 que a escolha da \n\nlinguagem de programa\u00e7\u00e3o faz diferen\u00e7a. \n\n As principais raz\u00f5es que fazem C++ ser uma linguagem usada em aplica\u00e7\u00f5es de \n\ndiversas naturezas s\u00e3o: \n\n \n\n\u2022 H\u00e1 compiladores C++ para essencialmente todos os tipos de m\u00e1quinas, desde com-\n\nputadores pessoais (PC), passando por workstations e mainframes, at\u00e9 super com-\n\nputadores. \n\n\u2022 A padroniza\u00e7\u00e3o da linguagem torna-a port\u00e1vel entre diferentes plataformas. \n\n\n\n84 \n\n\u2022 C++ foi desenvolvida para ter uma efici\u00eancia equipar\u00e1vel a C, uma linguagem esco-\n\nlhida para sistemas operacionais e outros sistemas que exigem alto desempenho. \n\n\u2022 C++ \u00e9 uma linguagem de m\u00faltiplos prop\u00f3sitos e n\u00e3o est\u00e1 voltada para um campo \n\nparticular da programa\u00e7\u00e3o. \n\n\u2022 C++ permite que se construam interfaces que possam acessar bibliotecas constru\u00ed-\n\ndas em FORTRAN, beneficiando-se, assim, de rotinas j\u00e1 implementadas e testadas. \n\n \n\n Quando a linguagem C++ foi padronizada por um comit\u00ea internacional ISSO/ANSI \n\nno final de1997, uma biblioteca padr\u00e3o foi inclu\u00edda ao desenvolvimento de C++. O STL \n\n(Standard Template Library) \u00e9 uma biblioteca gen\u00e9rica que oferece solu\u00e7\u00f5es de gerencia-\n\nmento de cole\u00e7\u00f5es de dados junto com o uso de algoritmos modernos e eficientes. Todos \n\nos componentes da STL s\u00e3o classes templates, o que significa que estas podem ser usadas \n\npara tipos arbitr\u00e1rios de elementos.  \n\n O STL dispensa o programador de criar arrays din\u00e2micos, listas encadeadas, \u00e1rvo-\n\nres bin\u00e1rias ou algoritmos de busca. Basta que se escolha o tipo apropriado de container e \n\nse use as fun\u00e7\u00f5es membros e algoritmos para processar os dados. \n\n O uso desta biblioteca \u00e9 constante tanto no simulador, item 5.5.2, quanto no c\u00f3digo \n\ndo pacote FMDB, item 5.4.4, onde toda a estrutura de dados para gerenciar a malha se be-\n\nneficia das estruturas primitivas do STL. \n\n \n\n5.5 Ferramentas computacionais paralelas \n \n\n Como dito anteriormente, projetar um programa para ser executado em paralelo re-\n\nquer uma forma diferente de pensar quando comparado a um programa serial. Uma s\u00e9rie \n\nde desafios surge \u00e0 medida que se aumenta a complexidade do programa, seja na distribui-\n\n\u00e7\u00e3o da malha entre os processadores ou na resolu\u00e7\u00e3o de um sistema de equa\u00e7\u00f5es em para-\n\nlelo. Todas s\u00e3o tarefas que exigem um certo grau de experi\u00eancia em programa\u00e7\u00e3o paralela \n\ne muito tempo de desenvolvimento. Assim, a tentativa de produzir c\u00f3digos para tratar tare-\n\nfas complexas em paralelo demanda um longo tempo de trabalho desviando, assim, do fo-\n\nco da constru\u00e7\u00e3o do simulador. Isto pode resultar em programas pouco robustos ou inefici-\n\nentes. \n\n Uma s\u00e9rie de pacotes de c\u00f3digo aberto desenvolvidos por terceiros permite que n\u00e3o \n\nse reinvente a roda a cada momento que se deseje realizar algum trabalho que envolva tro-\n\n\n\n85 \n\nca de mensagens entre processos. Esses pacotes s\u00e3o bibliotecas que foram incorporados ao \n\nsimulador de forma a poupar tempo e obter resultados mais eficientes e acurados. S\u00e3o eles: \n\n \n\n\u2022 AutoPack \n\n\u2022 FMDB \n\n\u2022 ParMetis \n\n\u2022 PETSc \n\n \n\n Estes quatro pacotes de c\u00f3digo aberto, que ser\u00e3o detalhados mais adiante, s\u00e3o todos \n\nescritos em linguagem C com exce\u00e7\u00e3o do FMDB que \u00e9 escrito em C++. Esta linguagem foi \n\nescolhida para o desenvolvimento do simulador por ser uma linguagem orientada a objetos \n\n\u2013 um paradigma para escrever \u201cbons\u201d programas para um conjunto de problemas (Strous-\n\ntrup, 2000) e que ser\u00e1 apresentada logo adiante no item 5.4.1.  \n\n O envio e recebimento de mensagens entre processos \u00e9 uma tarefa complexa e que \n\n\u00e9 exigida pelos quatro pacotes citados. Este tipo de tarefa \u00e9 realizado pelo MPI, uma bi-\n\nblioteca que se tornou um padr\u00e3o na passagem de mensagens em computadores paralelos \n\nde mem\u00f3ria distribu\u00edda. Todos estes pacotes s\u00e3o utilizados na constru\u00e7\u00e3o do pr\u00e9-\n\nprocessador e do simulador paralelo e onde ambos s\u00e3o detalhados nos itens 5.5.1 e 5.5.2, \n\nrespectivamente. \n\n \n\n5.5.1 Interface paralela de mensagens (MPI) \n \n\n Atualmente, o padr\u00e3o predominante de programa\u00e7\u00e3o paralela de mem\u00f3ria distribu\u00ed-\n\nda \u00e9 baseado na passagem de mensagens usando MPI (Message Passing Interface). Uma \n\ntecnologia com mais de 15 anos, o MPI \u00e9 uma biblioteca de rotinas para escrever progra-\n\nmas paralelos por passagem de mensagem de forma eficiente e port\u00e1til. MPI n\u00e3o \u00e9 uma \n\nlinguagem, mas uma especifica\u00e7\u00e3o de rotinas que podem ser chamadas de um programa \n\n(El-Rewini, 2005). Embora a portabilidade dos programas baseados no MPI seja garantida, \n\no desenvolvimento destes tem um alto custo (Reed, 2003).  \n\n Como alternativas para tornar mais f\u00e1cil o projeto de programas paralelos, pode-se \n\nmencionar: o Co-Array Fortran (CAF) e o Unified Parallel C (UPC) (Reed, 2003). Ambas \n\ns\u00e3o extens\u00f5es das linguagens Fortran 95 e C, respectivamente, e s\u00e3o voltadas para o desen-\n\nvolvimento em computa\u00e7\u00e3o de alto desempenho em m\u00e1quinas paralelas de grande porte. \n\n\n\n86 \n\nCom suporte a hardwares de mem\u00f3ria distribu\u00edda e compartilhada estes dois sistemas de \n\nprograma\u00e7\u00e3o podem oferecer grandes vantagens em termo de portabilidade, desempenho e \n\nprodutividade. \n\n \n\n5.5.2 Particionamento de malha e balan\u00e7o de carga (ParMetis) \n \n\n A primeira preocupa\u00e7\u00e3o que surge quando se faz simula\u00e7\u00e3o paralela usando malhas \n\nn\u00e3o-estruturadas \u00e9 como distribu\u00ed-las entre os processadores. O particionamento de malhas \n\nem computadores de mem\u00f3ria distribu\u00edda exige que algumas medidas sejam tomadas a fim \n\nde n\u00e3o comprometer o desempenho geral da simula\u00e7\u00e3o, pois caso contr\u00e1rio, uma simula\u00e7\u00e3o \n\nserial poderia ser mais r\u00e1pida do que com v\u00e1rios processadores. Primeiro, deve-se garantir \n\nque cada processador receba a mesma quantidade de n\u00f3s, se poss\u00edvel, de forma a evitar um \n\ndesbalan\u00e7o de trabalho onde um processador pode ficar sobrecarregado enquanto outro \n\npermanece ocioso. Segundo, o n\u00famero de n\u00f3s com c\u00f3pias remotas deve ser m\u00ednimo de \n\nforma a reduzir a num\u00e9ro de troca de informa\u00e7\u00f5es entre processadores durante a simula\u00e7\u00e3o.  \n\n Diversos pacotes dispon\u00edveis na internet foram desenvolvidos com o intuito de oti-\n\nmizar a interface das parti\u00e7\u00f5es. Alguns exemplos podem ser citados como: ParMetis, Zol-\n\ntan , Jostle e Scotch. Neste trabalho, o ParMetis foi adotado, pois \u00e9 usado internamente pe-\n\nlo gerenciador de malhas FMDB.  \n\n A Fig. 5.2 mostra um exemplo de um particionamento paralelo de uma malha 3-D \n\nde tetraedros que \u00e9 distribu\u00edda entre cinco processos de duas formas diferentes. Cada pro-\n\ncesso, que \u00e9 representado por uma cor, recebeu a mesma quantidade de elementos garan-\n\ntindo um equil\u00edbrio aproximado de carga de trabalho. Na Fig. 5.2a, a malha \u00e9 distribu\u00edda \n\nseguindo a ordem em que as conectividades dos elementos aparecem no arquivo produzido \n\npelo gerador de malhas, ou seja, para uma malha com mil elementos, por exemplo, os du-\n\nzentos primeiros elementos da lista presentes no arquivo s\u00e3o destinados ao processo 0, os \n\nduzentos seguintes para o processo 1 e assim por diante. Dessa forma, o n\u00famero de n\u00f3s \n\ncom c\u00f3pias remotas se torna extremamente alto e por isso indesejado, pois os processos \n\npassam a consumir mais tempo trocando mensagens entre si do que realizando os c\u00e1lculos \n\nda simula\u00e7\u00e3o. \n\n Na Fig. 5.2b, o ParMetis, baseado no particionamento da Fig. 5.2a, consegue de-\n\nterminar uma distribui\u00e7\u00e3o \u00f3tima onde n\u00e3o apenas o balan\u00e7o de carga \u00e9 garantido como \n\n\n\n87 \n\ntamb\u00e9m o n\u00famero de n\u00f3s nas fronteiras das parti\u00e7\u00f5es \u00e9 reduzido drasticamente, o que refle-\n\nte diretamente no tempo total gasto no envio e recebimento de dados. \n\n O ParMetis apenas informa qual ser\u00e1 a distribui\u00e7\u00e3o dos elementos, i.e, informa para \n\nqual processador cada elemento deve ser enviado. Este trabalho de envio, que \u00e9 realizado \n\numa \u00fanica vez, fica a cargo do usu\u00e1rio que deve implementar algum algoritmo de distribu-\n\ni\u00e7\u00e3o de dados. No presente trabalho, a biblioteca FMDB, que ser\u00e1 apresentada a seguir no \n\nitem 5.4.4, foi usada com esse intuito. \n\n \n\n(a) (b) \n\nFigura 5.2 \u2013 Exemplo de uma malha 3-D de tetraedros particionada entre 5 processadores. \n\u00c0 esquerda (a), o particionamento considera apenas o balan\u00e7o em termos do n\u00famero de \nelementos, ou seja, cada processador tem basicamente a mesma quantidade de elementos. \nA direita (b), particionamento otimizado baseado no ParMetis onde o n\u00famero de entidades \ncom c\u00f3pias remotas \u00e9 reduzido significativamente. \n \n\n5.5.3 Estrutura de dados distribu\u00edda (FMDB) \n \n\n O ponto inicial para a constru\u00e7\u00e3o de qualquer simulador que lida com malhas n\u00e3o-\n\nestruturadas \u00e9 definir que tipo de estrutura de dados ser\u00e1 usado para acessar os elementos \n\n(n\u00f3s, aresta, faces e volumes) da malha ao longo da simula\u00e7\u00e3o. Se tratando de computa\u00e7\u00e3o \n\nparalela, outra preocupa\u00e7\u00e3o que surge na aus\u00eancia de um gerador de malhas paralelo \u00e9 co-\n\nmo distribuir a malha entre os processadores e obter informa\u00e7\u00f5es entre elementos nas fron-\n\nteiras das parti\u00e7\u00f5es.  \n\n A constru\u00e7\u00e3o de rotinas eficientes para esses tipos de tarefas \u00e9 complexa e requer \n\nmuito tempo e experi\u00eancia do programador. Por esses motivos e tendo de concentrar esfor-\n\n\u00e7os na constru\u00e7\u00e3o de um simulador que demanda muito trabalho foi pesquisado uma bibli-\n\noteca que fosse capaz, por exemplo, de construir uma estrutura de dados por aresta com \n\nmalhas 2-D/3-D distribu\u00eddas a partir de uma malha de elementos finitos.  \n\n\n\n88 \n\n O FMDB (Flexible Distributed Mesh Database) (Seol, 2005) \u00e9 um pacote com uma \n\ns\u00e9rie de rotinas escritas em C++ que se apresenta como uma boa op\u00e7\u00e3o no gerenciamento \n\nde malhas seriais ou distribu\u00eddas em computadores paralelos. Fazendo uso constante da \n\nbiblioteca padr\u00e3o do C++ (STL), o FMDB tamb\u00e9m utiliza o ParMetis e o Autopack na dis-\n\ntribui\u00e7\u00e3o da malha entre processadores, tendo o MPI como base para todas as rotinas de \n\nenvio e recebimento de dados remotos.  \n\n A flexibilidade que o pr\u00f3prio nome FMDB passa vem do fato de que \u00e9 poss\u00edvel cri-\n\nar estruturas de dados de acordo com as necessidades do usu\u00e1rio, ou seja, pode-se criar \n\numa estrutura com entidades que geralmente n\u00e3o s\u00e3o fornecidas pelo gerador de malhas \n\ncomo as arestas. \n\n As estruturas de dados obtidas atrav\u00e9s do FMDB podem auxiliar, por exemplo, em \n\nproblemas envolvendo multigriding onde \u00e9 necess\u00e1rio conhecer as entidades que circun-\n\ndam um dado elemento. \n\n Outro ponto interessante deste pacote \u00e9 a possibilidade de trabalhar com adapta\u00e7\u00e3o \n\nde malhas onde elementos filhos s\u00e3o criados a partir dos pontos m\u00e9dios das arestas que \n\ncomp\u00f5e cada elemento pai. Dessa forma, um elemento triangular d\u00e1 origem a quatro novos \n\ntri\u00e2ngulos e um tetraedro d\u00e1 origem a oito novos tetraedros. Embora n\u00e3o tenha sido explo-\n\nrado, o FMDB se prop\u00f5e a tratar o desbalanceamento de carga gerado quando a malha dis-\n\ntribu\u00edda \u00e9 refinada ou desrefinada. \n\n A constru\u00e7\u00e3o da estrutura de dados do simulador come\u00e7a com a defini\u00e7\u00e3o de um \n\nobjeto do tipo mMesh como mostra a seguinte linha de c\u00f3digo: \n\n \n\nmMesh *theMesh; \n\n \n\n A classe mMesh representa uma interface para manipular todos os elementos da \n\nmalha que pode tamb\u00e9m ser distribu\u00edda. Por meio desta classe s\u00e3o criadas as estruturas de \n\nn\u00f3s e de elementos baseadas nas conectividades dos mesmos e que s\u00e3o oriundos do gerador \n\nde malhas. A constru\u00e7\u00e3o de um elemento tetra\u00e9drico, por exemplo, pode ser realizado da \n\nseguinte forma: \n\n \n\n// primeiro s\u00e3o criados os n\u00f3s do tetraedro \n\nmVertex* v1 = theMesh->createVertex(x,y,z,ID1); \n\nmVertex* v2 = theMesh->createVertex(x,y,z,ID2); \n\nmVertex* v3 = theMesh->createVertex(x,y,z,ID3); \n\nmVertex* v4 = theMesh->createVertex(x,y,z,ID4); \n\n\n\n89 \n\n \n\n// o tetraedro \u00e9 criado em seguida \n\nmRegion* tet = theMesh->createTetWithVertices(v1,v2,v3,v4); \n\n \n\n Inicialmente, os v\u00e9rtices do tetraedro s\u00e3o definidos atrav\u00e9s das coordenadas espaci-\n\nais e de suas respectivas numera\u00e7\u00f5es globais por meio da fun\u00e7\u00e3o createVertice, e em se-\n\nguida \u00e9 criado o elemento tetra\u00e9drico por meio da fun\u00e7\u00e3o createTetWithVertices. \n\n Criando uma rotina de automatiza\u00e7\u00e3o, todos os n\u00f3s e elementos do arquivo de ma-\n\nlha podem ser passados para a estrutura criada pelo FMDB \u00e0 medida que novos elementos \n\ns\u00e3o inseridos. No caso de malhas distribu\u00eddas, o FMDB fornece uma fun\u00e7\u00e3o que l\u00ea alguns \n\ntipos de arquivos de malha entre eles os do gerador Gmsh. A tarefa de leitura e distribui\u00e7\u00e3o \n\nda malha \u00e9 completamente automatizada por meio da chamada da fun\u00e7\u00e3o M_load como \n\nmostrado a seguir: \n\n \n\nM_load(theMesh,fileName); \n\n \n\n Onde fileName \u00e9 um ponteiro do tipo char* e refere-se ao nome do arquivo a ser \n\naberto. Esta fun\u00e7\u00e3o realiza de forma serial a leitura do arquivo de malha para montar uma \n\nestrutura de n\u00f3s e de elementos. Em seguida, uma estrutura de arestas \u00e9 criada para, com o \n\naux\u00edlio do ParMetis, distribu\u00ed-la entre todos os processos. \n\n A redistribui\u00e7\u00e3o de uma malha com as caracter\u00edsticas apresentadas pela Fig. 5.2(a), \n\nonde a leitura da malha foi feita de forma paralela e cada processo recebeu uma fra\u00e7\u00e3o dos \n\nelementos da malha, para atingir a configura\u00e7\u00e3o da Fig. 5.2(b) ser\u00e1 alvo de trabalhos futu-\n\nros. Isso permite que malhas que representam problemas de grande porte possam ser carre-\n\ngadas na mem\u00f3ria.  \n\n Embora a forma como a fun\u00e7\u00e3o M_load lida com o carregamento da malha possa \n\nparecer um empecilho para malhas com milh\u00f5es de n\u00f3s isso n\u00e3o \u00e9 um problema grave aqui, \n\npois o FMDB permite que, ap\u00f3s a distribui\u00e7\u00e3o da mesma entre os processos, os elementos \n\nde cada parti\u00e7\u00e3o possam ser subdivididos at\u00e9 que um n\u00edvel de refinamento seja atingido. \n\nEssa caracter\u00edstica tamb\u00e9m ser\u00e1 tema de trabalhos futuros. \n\n O membro modifyState, definido na classe mMesh, \u00e9 respons\u00e1vel pela cria\u00e7\u00e3o das \n\nestruturas de dados adicionais como a de arestas. Esta, criada em fun\u00e7\u00e3o dos tetraedros, \n\npode ser constru\u00edda por meio de uma \u00fanica chamada: \n\n \n\ntheMesh->modifyState(3,1); \n\n\n\n90 \n\n As entidades da malha (v\u00e9rtices, arestas, faces e tetraedros) possuem dimens\u00f5es 0, \n\n1, 2 e 3, respectivamente, e \u00e9 por meio destes valores que uma entidade \u00e9 diferenciada da \n\noutra. A fun\u00e7\u00e3o modifyState permite criar qualquer tipo de estrutura de vizinhan\u00e7as para \n\numa entidade como, por exemplo, arestas ao redor de arestas, tetraedros ao redor de n\u00f3s, \n\nfaces ao redor de arestas, etc. \n\n No caso do simulador aqui desenvolvido, a formula\u00e7\u00e3o de volumes finitos empre-\n\ngada necessita apenas dos n\u00f3s e das arestas da malha tornando, assim, o uso da fun\u00e7\u00e3o mo-\n\ndifyState necess\u00e1ria apenas na fase de pr\u00e9-processamento onde a estrutura de arestas \u00e9 cri-\n\nada e os coeficiente geom\u00e9tricos calculados. No simulador, as arestas podem ser criadas de \n\nforma semelhante \u00e0 cria\u00e7\u00e3o dos tetraedros como mostrado a seguir: \n\n \n\n// criam-se primeiro os n\u00f3s \n\nmVertex* v1 = theMesh->createVertex(x,y,z,ID1); \n\nmVertex* v2 = theMesh->createVertex(x,y,z,ID2); \n\n \n\n// em seguida as arestas \n\nmEdge* edge = theMesh->createEdge(v1,v2); \n\n \n\n Vale lembrar ainda que a classe mMesh fornece fun\u00e7\u00f5es do tipo get para obter um \n\nentidade qualquer como, por exemplo, getEdge(v1,v2) \n\n \n\nmEdge *edge = theMesh->getEdge(v1,v2); \n\n \n\n e uma fun\u00e7\u00e3o para remo\u00e7\u00e3o da entidade da estrutura de dados DEL(entity) \n\n \n\ntheMesh->DEL(edge); \n\n \n\n\u00fatil em problemas de adapta\u00e7\u00e3o. \n\n Cada entidade da malha \u00e9 definida por uma classe (mVertex, mEdge, mFace e mRe-\n\ngion). Ent\u00e3o, um n\u00f3 ou tetraedro \u00e9 um objeto do tipo mVertex e mRegion, respectivamente. \n\nTodas estas classes s\u00e3o derivadas de uma classe base chamada mEntity como mostra o dia-\n\ngrama de heran\u00e7a na Fig. 5.3. \n\n \n\n\n\n91 \n\n \n\nFigura 5.3 \u2013 Diagrama de classes para mEntity. \n  \n\n Todas as classes s\u00e3o agrupadas dentro do namespace AOMD (Algorithm Oriented \n\nMesh Database) do qual o FMDB herdou, aperfei\u00e7oou e adicionou recursos para o geren-\n\nciamento de malhas distribu\u00eddas. \n\n Um objeto do tipo mEntity pode ter qualquer conjunto de adjac\u00eancias, ou seja, pode \n\nter ponteiros para todas as outras entidades a ele conectado. Uma entidade pode tamb\u00e9m \n\nser dividida recursivamente e permite que a entidade pai e seus filhos possam ser acessa-\n\ndos.  \n\n Tanto no pr\u00e9-processador quanto no simulador se faz necess\u00e1rio associar \u00e0s entida-\n\ndes da malha informa\u00e7\u00f5es (escalar ou vetor) como coeficientes geom\u00e9tricos ou dados f\u00edsi-\n\ncos como press\u00e3o, velocidade e satura\u00e7\u00e3o. As tr\u00eas fun\u00e7\u00f5es abaixo permitem anexar um va-\n\nlor inteiro, um valor de ponto flutuante e um ponteiro to tipo void*, respectivamente, a \n\nqualquer ponteiro mEntity por meio de um identificador pMeshDataId. Este identificador \u00e9 \n\n\u00fatil quando se deseja que mais de um dado seja associado a uma entidade. \n\n \n\nvoid EN_attachDataInt(mEntity *, pMeshDataId, int); \n\nvoid EN_attachDataDbl(mEntity *, pMeshDataId, double); \n\nvoid EN_attachDataPtr(mEntity *, pMeshDataId, void *); \n\n \n\n A \u00faltima fun\u00e7\u00e3o \u00e9 especialmente interessante, pois abre a possibilidade de associar \n\na entidade um tipo definido pelo usu\u00e1rio que pode conter mais de um dado. Cada uma des-\n\ntas fun\u00e7\u00f5es possui uma equivalente para extrair os dados antes anexados. \n\n \n\nint EN_getDataInt(mEntity *, pMeshDataId, int *); \n\nint EN_getDataDbl(mEntity *, pMeshDataId, double *); \n\nint EN_getDataPtr(mEntity *, pMeshDataId, void **); \n\n \n\n Uma das principais fontes de overhead, i.e, a quantidade de tempo requerida para \n\ncoordenar tarefas paralelas que n\u00e3o se traduz como trabalho \u00fatil, em sistemas de mem\u00f3ria \n\ndistribu\u00edda \u00e9 a comunica\u00e7\u00e3o entre processadores. A distribui\u00e7\u00e3o da malha e o consecutivo \n\nbalan\u00e7o de carga exige a troca de muitas mensagens pequenas podendo ocasionar um custo \n\n\n\n92 \n\nexcessivo de tempo (Seol, 2005). Oculto ao usu\u00e1rio, o FMDB consegue fazer este trabalho \n\ninternamente de forma eficiente atrav\u00e9s da biblioteca Autopack. Este consegue agrupar v\u00e1-\n\nrias mensagens de tamanhos pequenos e as envia em um \u00fanico pacote. O Autopack tem \n\ncomo prop\u00f3sito reduzir o n\u00famero de troca de fragmentos de mensagens entre parti\u00e7\u00f5es. \n\nSuas fun\u00e7\u00f5es, assim como as do ParMetis, ficam a cargo do FMDB. Nenhuma delas preci-\n\nsa ser usada explicitamente pelo usu\u00e1rio a menos que deseje algo que n\u00e3o seja fornecido \n\npelo FMDB. \n\n \n\n5.5.4 Resolu\u00e7\u00e3o de sistemas de equa\u00e7\u00f5es (PETSc) \n \n\n Em simula\u00e7\u00e3o num\u00e9rica, sistemas de equa\u00e7\u00f5es lineares ou n\u00e3o-lineares comumente \n\nsurgem e seus tamanhos podem variar entre milhares e milh\u00f5es de graus de liberdade. A \n\nresolu\u00e7\u00e3o destes sistemas, que geralmente envolvem matrizes esparsas, exige m\u00e9todos ro-\n\nbustos e eficientes para resolv\u00ea-los de forma acurada. O PETSc (Portable, Extensible, To-\n\nolkit for Scientific Computation) cont\u00e9m uma s\u00e9rie de m\u00e9todos iterativos baseados nos sub-\n\nespa\u00e7os de Krylov para a resolu\u00e7\u00e3o de sistemas de equa\u00e7\u00f5es de forma serial ou paralela.  \n\n Para acelerar a taxa de converg\u00eancia destes m\u00e9todos ou at\u00e9 mesmo para permitir \n\nque os mesmos convirjam, uma s\u00e9rie de pr\u00e9-condicionadores est\u00e1 \u00e0 disposi\u00e7\u00e3o. A tabela \n\n5.1 mostra algumas op\u00e7\u00f5es de m\u00e9todos iterativos e de pr\u00e9-condicionadores dispon\u00edveis no \n\nPETSc. \n\n O PETSc cont\u00e9m um conjunto de rotinas, entre muitas outras, que fornecem v\u00e1rias \n\ninterfaces de alto n\u00edvel para a manipula\u00e7\u00e3o de matrizes e de vetores. Por interface de alto \n\nn\u00edvel, entende-se uma interface simples onde tarefas trabalhosas ou complexas ficam ocul-\n\ntas. \n\nTabela 5.1 \u2013 Exemplos de solvers e pr\u00e9-condicionadores dispon\u00edveis no PETSc. \n\nSolvers Pr\u00e9-condicionadores \n\nGradiente Conjugado (CG) ILU \n\nGradiente Bi-Conjugado (BiCG) LU \n\nGradiente Bi-Conjugado Estabilizado (BiCG) Jacobi \n\nGeneralized Minimum RESidual (GMRES) ASM (additive Schwarz method) \n\n \n\n\n\n93 \n\n Uma dessas rotinas de alto n\u00edvel, chamada de applicationOrdering, \u00e9 utilizada no \n\nmapeamento da numera\u00e7\u00e3o de uma malha distribu\u00edda. A figura 5.4 mostra uma malha 2-D \n\nde tri\u00e2ngulos com 21 n\u00f3s particionada entre tr\u00eas processadores e onde cada parti\u00e7\u00e3o teve \n\nsua interface minimizada como descrito no item 5.3.4.  \n\n Supondo que todos os n\u00f3s sejam livres, a matriz A  do sistema de equa\u00e7\u00f5es ter\u00e1 21 \n\nlinhas que devem ser distribu\u00eddas de forma balanceada entre os processos a fim de que to-\n\ndos tenham a mesma carga de trabalho.  \n\n Logo, A ser\u00e1 distribu\u00edda e cada um dos tr\u00eas processos ter\u00e1 sete linhas. A numera\u00e7\u00e3o \n\ndas linhas segue uma seq\u00fc\u00eancia global e ordenada de 1 a 21 onde ao processo de rank 0 \n\ns\u00e3o atribu\u00eddas as linhas 1 a 7, ao rank 1 as linhas de 8 a 14 e ao rank 3 as linhas de 15 a 21. \n\nO n\u00famero de colunas de A  \u00e9 sempre o mesmo para todos os processos. \n\n Montar as equa\u00e7\u00f5es de cada n\u00f3 em uma linha correspondente a sua numera\u00e7\u00e3o glo-\n\nbal ocasiona um excesso de comunica\u00e7\u00e3o entre os processadores devido ao grande n\u00famero \n\nde equa\u00e7\u00f5es montadas remotamente. Estas opera\u00e7\u00f5es s\u00e3o representadas pelas linhas trace-\n\njadas na Fig. 5.5 (a) e relativas apenas ao processo de rank 0. Percebe-se que o n\u00famero de \n\nopera\u00e7\u00f5es paralelas supera o n\u00famero de opera\u00e7\u00f5es locais.  \n\n \n\n \n\n(a) (b) \n\nFigura 5.4 \u2013 Malha 2-D distribu\u00edda entre tr\u00eas processadores. A malha com a numera\u00e7\u00e3o \nglobal inicial dos n\u00f3s (a) gera uma troca maior de informa\u00e7\u00f5es entre processadores. A ma-\nlha com os n\u00f3s renumerados (b) permite que a maior parte das equa\u00e7\u00f5es referente a cada \nn\u00f3 seja montada localmente, aumentando assim, a efici\u00eancia na montagem da matriz. \n \n\n\n\n94 \n\n Atribuindo agora uma nova numera\u00e7\u00e3o por meio do applicationOrdering aos n\u00f3s \n\nda malha global, Fig. 5.4 (b), apenas as equa\u00e7\u00f5es referentes aos n\u00f3s nas fronteiras entre \n\nparti\u00e7\u00f5es s\u00e3o montadas remotamente. Dessa forma, a situa\u00e7\u00e3o se inverte e se passa a ter \n\nmais opera\u00e7\u00f5es locais que paralelas. \n\n O applicationOrdering cria um objeto que permite acessar de forma simples e efi-\n\nciente a nova numera\u00e7\u00e3o atribu\u00edda aos n\u00f3s e, assim, montar as equa\u00e7\u00f5es de forma mais lo-\n\ncal poss\u00edvel. \n\n Na pr\u00e1tica, alguns n\u00f3s da malha tem valores prescritos (condi\u00e7\u00e3o de Dirichlet) para \n\nque o problema esteja bem posto e logo, n\u00e3o devem ser renumerados. A numera\u00e7\u00e3o \u00e9 atri-\n\nbu\u00edda apenas aos n\u00f3s livres (as inc\u00f3gnitas do problema). \n\n No presente trabalho, o termo el\u00edptico apresentado pela Eq. (3.22) pode ser escrito \n\nna seguinte forma matricial: \n\n \n\n ( )Ax EFx Gx= +  (5.2) \n\n \n\nonde [ ]G  representa a proje\u00e7\u00e3o do fluxo paralelo \u00e0 dire\u00e7\u00e3o da aresta e o produto [ ]E [ ]F  \n\nrepresenta a proje\u00e7\u00e3o normal do mesmo \u00e0 aresta.  \n\n As matrizes [ ]E , [ ]F  e [ ]G  s\u00e3o montadas por arestas e por faces (se 3-D) pelas \n\nEq. (5.3), (5.4) e (5.5) respectivamente: \n\n \n\n [ ]\n( )\n\n( ) ( ) ( )\n\n( ) ( )\n2 2ndim\n\n,\n2\n\nr L\nL L L LL r r\n\nL\n\nL L L L\n\nIJ\nIJ IJ IJ IJIJ T\n\nIJx\n\nIJ IJ IJ IJ\n\nI L L I L LK\nE C\n\nL L I L L I\n\n?\n?\n\n? ?\n\n? ?? ? ? ?? ? ?= ?\n? ?? ? ? ?\n? ?\n\n? ? ? ?\n\n?\n? ?\n\n? ? ? ? ?\n\n? ?\n\n (5.3) \n\n \n\n [ ]\n( )\n\n( )\n\n2ndim 2\n\n1 1\n\n.\n1 12\n\nr\n\nL r L\n\nL L\n\nIJ I IIJ\n\nx\n\nJ J\n\nV VC\nF\n\nV V\n\n?\n?\n\n? ?\n? ?\n? ?=\n? ?\n\n?? ?\n? ?\n\n?\n\n (5.4) \n\n \n\n [ ]\n( )\n\n( )\n\n2ndim 2ndim\n\n1 1\n,\n\n1 1\n\nr\n\nL r L Lr L\n\nL\n\nIJ IJ IJIJ\nTx\n\nIJ\n\nL C\nG K ?\n\n?\n? ?\n\n? ?? ?\n= ? ? ?\n\n?? ? ?\n\n??\n\n?\n (5.5) \n\n \n\n\n\n95 \n\n Nas Eq. (5.3), (5.4) e (5.5), ndim refere-se ao n\u00famero de dimens\u00f5es do dom\u00ednio (2-\n\nD ou 3-D), I\n?\n\n \u00e9 a matriz identidade, IJL\n?\n\n o vetor paralelo \u00e0 aresta, K\n?\n\n o tensor de permeabi-\n\nlidade, LIJT?  \u00e9 a m\u00e9dia aritm\u00e9tica da mobilidade total definida nos n\u00f3s I e J e LIJ?  o com-\n\nprimento da aresta IJ. \n\n Todas as matrizes [ ]E , [ ]F  e [ ]G  s\u00e3o esparsas e s\u00e3o definidas como tais no c\u00f3digo \n\na fim de poupar mem\u00f3ria. Opera\u00e7\u00f5es de multiplica\u00e7\u00e3o e adi\u00e7\u00e3o de matrizes com perfis de \n\nesparsidade diferentes representam um custo extremamente elevado de uso de CPU torna-\n\ndo, assim, impratic\u00e1vel este tipo de tarefa para problemas de grande porte.  \n\n Por esse motivo, um esquema livre de matriz (matrix-free) suportado pelo PETSc \n\nfoi usado de forma a n\u00e3o realizar opera\u00e7\u00f5es entre matrizes. De fato, todas s\u00e3o montadas e \n\napenas opera\u00e7\u00f5es matriz-vetor s\u00e3o realizadas. A matriz final A  n\u00e3o \u00e9 montada. O PETSc \n\npermite que sistemas de equa\u00e7\u00f5es lineares possam ser resolvidos por m\u00e9todos iterativos \n\ncomo o GMRES ou o Gradiente Conjugado usando apenas o produto Ax . \n\n O PETSc permite criar uma matriz sem que suas entradas sejam de fato armazena-\n\ndas na mem\u00f3ria atrav\u00e9s da chamada MatCreateShell. A esta matriz deve-se associar algu-\n\nma opera\u00e7\u00e3o fornecida pelo usu\u00e1rio, neste caso uma opera\u00e7\u00e3o matriz-vetor, de forma a ter \n\no produto desejado. Isto \u00e9 feito atrav\u00e9s da chamada MatShellSetOperation. Quando a cha-\n\nmada respons\u00e1vel pela resolu\u00e7\u00e3o do sistema de equa\u00e7\u00f5es do PETSc \u00e9 executada (KSPSol-\n\nver), a opera\u00e7\u00e3o definida pelo usu\u00e1rio \u00e9 invocada, internamente, para retornar o produto \n\nAx  a cada itera\u00e7\u00e3o do m\u00e9todo escolhido. Esta opera\u00e7\u00e3o se resume em tr\u00eas passos apresen-\n\ntados pelas Eqs. (5.6), (5.7) e (5.8) respectivamente. \n\n \n\n y Gx=  (5.6) \n\n \n\n z Fx=  (5.7) \n\n \n\n y y Ez= +  (5.8) \n\n \n\n Partindo de uma solu\u00e7\u00e3o inicial 0x , primeiro \u00e9 calculado o produto Gx da Eq. (5.5) \n\natribuindo o resultado a um vetor y como mostra a Eq. (5.6). Em seguida, um segundo ve-\n\ntor z calcula o produto Fx  como na Eq. (5.7). Por \u00faltimo, o vetor y conclui as opera\u00e7\u00f5es \n\nmatriz-vetor da Eq. (5.5) representando o produto Ax . \n\n\n\n96 \n\n \u00c9 poss\u00edvel fazer este tipo de opera\u00e7\u00e3o sem realmente montar matrizes. Entretanto, \n\npara resolver problemas envolvendo EDPs n\u00e3o-lineares o uso de uma matriz pr\u00e9-\n\ncondicionadora pode trazer um ganho computacional significativo em termos de uso de \n\nCPU reduzindo o n\u00famero de itera\u00e7\u00f5es necess\u00e1rias para a converg\u00eancia do sistema linear, \n\npodendo at\u00e9 mesmo ser imprescind\u00edvel para que a solu\u00e7\u00e3o do sistema de equa\u00e7\u00f5es convir-\n\nja, i.e, garante estabilidade. \n\n Ao se definir o m\u00e9todo de resolu\u00e7\u00e3o para o sistema Ax b= , pode-se associar uma \n\nmatriz pr\u00e9-condicionadora \u00e0 matriz de elementos. Como neste trabalho todas as matrizes \n\ns\u00e3o montadas, [ ]G  \u00e9 usada como tal. A matriz [ ]G  \u00e9 o resultado de uma aproxima\u00e7\u00e3o de \n\ndiferen\u00e7as finitas que gera uma matriz esparsa, sim\u00e9trica e positiva-definida. As matrizes \n\n[ ]E  e [ ]F  n\u00e3o podem ser usadas porque n\u00e3o s\u00e3o quadradas. \n\n Saber que tipo de m\u00e9todo iterativo e de pr\u00e9-condicionador usar \u00e9 uma tarefa com-\n\nplexa e que em muitos casos pode haver mais de uma boa op\u00e7\u00e3o. O que obviamente pode \n\nser uma boa solu\u00e7\u00e3o para simula\u00e7\u00f5es seriais pode n\u00e3o ser em paralelo. Certas medidas de-\n\nvem ser tomadas na escolha do melhor m\u00e9todo a ser usado e baseado nas propriedades da \n\nmatriz A deve-se examinar se: \n\n \n\n\u2022 A \u00e9 bem ou mal-condicionada \n\n\u2022 A \u00e9 sim\u00e9trica ou n\u00e3o-sim\u00e9trica \n\n\u2022 A \u00e9 positivo-definida \n\n\u2022 A \u00e9 esparsa \n\n \n\n Apesar da matriz A n\u00e3o ser realmente montada, esta \u00e9 esparsa, mal-condicionada e \n\nn\u00e3o-sim\u00e9trica devido \u00e0 introdu\u00e7\u00e3o dos termos de difus\u00e3o cruzada produzido pelo produto \n\ndas matrizes [ ]E  e [ ]F . Karniadakis (2003) sugere uma poss\u00edvel \u00e1rvore de decis\u00f5es Fig. \n\n5.5 na escolha do m\u00e9todo iterativo mais apropriado para resolver problemas de grande por-\n\nte.  \n\n\n\n97 \n\n \n\nFigura 5.5 \u2013 Poss\u00edvel \u00e1rvore de decis\u00f5es na escolha do m\u00e9todo iterativo para problemas de \ngrande porte e n\u00e3o deve ser tratada como uma regra \u00fanica. \n  \n\n Na Fig 5.5, QMR, CGNR e PCR referem-se aos algoritmos Quasi-Minimal Residu-\n\nal (uma vers\u00e3o mais est\u00e1vel do gradiente bi-conjugado), Conjugate Gradient Normal Resi-\n\ndual, Preconditioned Conjugate Gradient respectivamente. Para a classe de problemas a-\n\nbordados neste trabalho, o solver e o pr\u00e9-condicionador adotado nas simula\u00e7\u00f5es foram \n\nGMRES e ASM (Additive Schwartz Method) respectivamente. \n\n \n\n5.6 Implementa\u00e7\u00e3o paralela \n \n\n Nos itens 5.5.1 e 5.5.2 seguintes, s\u00e3o descritos os aplicativos desenvolvidos no pre-\n\nsente trabalho. Estes consistem de um pr\u00e9-processador 2D/3D seq\u00fcencial e paralelo e de \n\num simulador de escoamento bif\u00e1sico \u00f3leo-\u00e1gua em meios porosos tamb\u00e9m seq\u00fcencial e \n\nparalelo para malhas de tri\u00e2ngulos e tetraedros. Estes aplicativos foram desenvolvidos u-\n\nsando todo o ferramental apresentado nos itens anteriores e escritos em C++. \n\n \n\n5.6.1 Pr\u00e9-processador \n \n\n A formula\u00e7\u00e3o de volumes finitos baseada em arestas utilizada na discretiza\u00e7\u00e3o das \n\nequa\u00e7\u00f5es de escoamento do presente trabalho e que foi detalhada no cap\u00edtulo 3 exige que \n\numa fase de pr\u00e9-processamento seja realizada sobre a malha de elementos. Este pr\u00e9-\n\nprocessamento consiste na montagem da estrutura de dados de arestas e no c\u00e1lculo de coe-\n\n\n\n98 \n\nficientes que, para esta formula\u00e7\u00e3o, representam os vetores \u00e1reas das superf\u00edcies de contro-\n\nle associados ( IJC\n?\n\n e IJD\n?\n\n) e o volume dos volumes de controle ( IV ). Os coeficientes de \u00e1-\n\nrea s\u00e3o associados \u00e0s arestas da malha e os volumes aos n\u00f3s da mesma. No caso 3-D, o co-\n\neficiente IJKD\n?\n\n, pode ser associado \u00e0s faces do contorno. Cada coeficiente representa a con-\n\ntribui\u00e7\u00e3o de todos os elementos que usam a mesma aresta ou n\u00f3. \n\n Antes do c\u00e1lculo destes coeficientes, \u00e9 preciso criar uma estrutura de arestas a partir \n\nda malha de elementos. A biblioteca FMDB permite criar tal estrutura a partir de uma ma-\n\nlha de tri\u00e2ngulos ou de tetraedros. Por possuir uma interface de leitura para malhas do ge-\n\nrador Gmsh, a obten\u00e7\u00e3o de uma estrutura de arestas se torna uma tarefa muito simples tan-\n\nto para malhas seq\u00fcenciais quanto distribu\u00eddas. O Gmsh \u00e9 um gerador de malhas seq\u00fcenci-\n\nais de c\u00f3digo aberto com uma interface gr\u00e1fica amig\u00e1vel e que permite produzir malhas 2-\n\nD ou 3-D a partir de modelos geom\u00e9tricos onde podem ser definidas as condi\u00e7\u00f5es de con-\n\ntorno do problema. \n\n Ap\u00f3s a gera\u00e7\u00e3o da malha e cria\u00e7\u00e3o da estrutura de dados de arestas, as etapas exe-\n\ncutadas pelo pr\u00e9-processador consistem em varrer os elementos (tri\u00e2ngulos ou tetraedro) \n\nextraindo as informa\u00e7\u00f5es necess\u00e1rias e associando-as \u00e0s arestas e aos n\u00f3s do elemento de \n\nforma acumulativa, ou seja, ao final da varredura, uma aresta ou n\u00f3 ter\u00e1 a contribui\u00e7\u00e3o de \n\ntodos os elementos que os compartilham. No caso de malhas 3-D, devido ao tipo de inte-\n\ngra\u00e7\u00e3o adotada, os elementos de face dos contornos s\u00e3o usados e logo, deve-se ter uma es-\n\ntrutura de dados para armazen\u00e1-los. \n\n Quando se usa malhas distribu\u00eddas, os coeficientes associados \u00e0s arestas e aos n\u00f3s \n\npresentes nas fronteiras das parti\u00e7\u00f5es ficam incompletos, pois parte dos elementos que \n\ncompartilham estas entidades est\u00e3o presentes em outros processos. Neste caso, o procedi-\n\nmento adotado aqui foi fazer com que uma aresta ou um n\u00f3 que possui uma ou mais c\u00f3pias \n\nremotas tenha os mesmos coeficientes caso a mesma malha fosse pr\u00e9-processada de forma \n\nseq\u00fcencial. Isto evita certas complica\u00e7\u00f5es e inconsist\u00eancias, por exemplo, no momento da \n\nmontagem de matrizes distribu\u00eddas para o c\u00e1lculo de sistemas de equa\u00e7\u00f5es. Dessa forma, \n\npara problemas em paralelo, mais uma etapa se faz necess\u00e1ria ao pr\u00e9-processamento. Ape-\n\nnas os coeficientes associados \u00e0s arestas e aos n\u00f3s presentes nas fronteiras das parti\u00e7\u00f5es \n\ns\u00e3o somados. Os passos do pr\u00e9-processamento podem ser entendidos atrav\u00e9s do algoritmo \n\n5.1. \n\n Na etapa paralela, onde as entidades com c\u00f3pias remotas s\u00e3o varridas, pi refere-se a \n\ntodos os processos que cont\u00eam a entidade em quest\u00e3o. Ao final da fase de pr\u00e9-\n\n\n\n99 \n\nprocessamento, uma lista de n\u00f3s com suas respectivas numera\u00e7\u00f5es globais, coordenadas \n\nespaciais e volume dos volumes de controle associados a este n\u00f3 e mais uma lista de ares-\n\ntas e faces de contorno com seus respectivos coeficientes s\u00e3o necess\u00e1rios para iniciar a si-\n\nmula\u00e7\u00e3o, descartando, assim, a malha de elementos finitos original. \n\n \n\n// Etapa seq\u00fcencial \nLa\u00e7o sobre os elementos{ \n La\u00e7o sobre as arestas do elemento{ \n\n  \n     IJ IJC C contribui\u00e7\u00e3o do elemento \u00e0 aresta IJ= +\n\n? ?\n\n \n } \n La\u00e7o sobre os n\u00f3s do elemento{ \n\n  \n     I IV V contribui\u00e7\u00e3o do elemento ao n\u00f3 I= +  \n\n } \n} \nLa\u00e7o sobre os elementos da face do contorno (se 3-D){ \n\n \n     IJKD contribui\u00e7\u00e3o do elemento \u00e0 face IJK=\n\n?\n\n \n} \n// Etapa paralela \nLa\u00e7o sobre as arestas com c\u00f3pias remotas{ \n\n \n\nip\nIJ IJ\n\ni\n\nC C= ?\n? ?\n\n \n} \nLa\u00e7o sobre os n\u00f3s com c\u00f3pias remotas{ \n\n \n\nip\nI I\n\ni\n\nV V= ?\n \n\n} \n\nAlgoritmo 5.1 \n\n \n\n5.6.2 Simulador \n \n\n O principal foco deste trabalho consiste na constru\u00e7\u00e3o de um simulador para resol-\n\nver problemas de escoamento \u00f3leo-\u00e1gua em reservat\u00f3rio de petr\u00f3leo com malhas 2-D de \n\ntri\u00e2ngulos ou 3-D de tetraedros usando computadores paralelos de mem\u00f3ria distribu\u00edda. O \n\nuso da programa\u00e7\u00e3o orientada a objetos em C++, assim como da biblioteca STL (Standard \n\nTemplate Library) foram usados intensivamente no desenvolvimento deste simulador de \n\nforma a definir bem alguns conceitos por meio de classes. Isto tr\u00e1s a possibilidade de reu-\n\ns\u00e1-las em outros simuladores com o m\u00ednimo de altera\u00e7\u00f5es.  \n\n De forma a proteger as classes existentes da incorpora\u00e7\u00e3o de outras definidas por \n\nterceiros ao simulador que possam ter nomes coincidentes, foi escolhido um namespace \n\n\n\n100 \n\nchamado PRS (Petroleum Reservoir Simulator) para melhor caracterizar a finalidade do \n\nprograma aqui desenvolvido. \n\n Este item apresenta as principais classes com trechos de c\u00f3digos e algoritmos que \n\ntentam passar uma id\u00e9ia clara de como o simulador funciona e como se d\u00e1 o uso dessas \n\nclasses no programa. \n\n Como dito anteriormente, a formula\u00e7\u00e3o IMPES empregada envolve o c\u00e1lculo de \n\numa equa\u00e7\u00e3o el\u00edptica e outra hiperb\u00f3lica, onde ambas s\u00e3o resolvidas pelo m\u00e9todo EBFV1. \n\nVisando possibilitar a utiliza\u00e7\u00e3o da estrutura do simulador junto com suas classes em ou-\n\ntras formula\u00e7\u00f5es que podem vir a ser incorporadas ao programa, o conceito de polimorfis-\n\nmo do C++ foi aplicado tendo-se um objeto referente \u00e0 resolu\u00e7\u00e3o da equa\u00e7\u00e3o de difus\u00e3o e \n\noutro referente \u00e0 resolu\u00e7\u00e3o da equa\u00e7\u00e3o hiperb\u00f3lica. Na principal classe do simulador, SI-\n\nMULATION_core, s\u00e3o definidos dois ponteiros, um para cada tipo de equa\u00e7\u00e3o: \n\n \n\nElliptic_equation* pElliptic_eq; \n\nHyperbolic_equation* pHyperbolic_eq; \n\n \n\nA inicializa\u00e7\u00e3o destes ponteiros \u00e9 baseada na escolha feita pelo usu\u00e1rio que resulta em: \n\n \n\npElliptic_eq = new EBFV1_elliptic; \n\npHyperbolic_eq = new EBFV1_hyperbolic; \n\n \n\n Neste caso, os ponteiros pElliptic_eq e pHyperbolic_eq s\u00e3o inicializados de forma a \n\nresolver suas respectivas equa\u00e7\u00f5es por meio da formula\u00e7\u00e3o EBFV1. Como outras formula-\n\n\u00e7\u00f5es podem ser incorporadas, estes ponteiros podem estar associados \u00e0 formula\u00e7\u00f5es dife-\n\nrentes como a EBFV2 discutida no cap\u00edtulo tr\u00eas. \n\n O trecho de c\u00f3digo abaixo mostra o m\u00e9todo tsSolver (time step Solver) respons\u00e1vel \n\npelo processo de avan\u00e7o no tempo da simula\u00e7\u00e3o. O crit\u00e9rio de parada fica a cargo do obje-\n\nto pSimPar da classe SimulationParameters que \u00e9 repons\u00e1vel por todos os dados f\u00edsicos, \n\nnum\u00e9ricos e de simula\u00e7\u00e3o fornecidos pelo usu\u00e1rio. \n\n \n\nint SIMULATION_core::tsSolver(){ \n\n double timeStep, simTime = .0; \n\n while ( !pSimPar->finishSimulation(simTime) ){ \n\n \n\n  // solve elliptic equation \n\n\n\n101 \n\n  pElliptic_eq->solver(); \n\n   \n\n  // solve hiperbolic equation \n\n  pHyperbolic_eq->solver(timeStep); \n\n \n\n  simTime += timeStep; \n\n } \n\n} \n\n \n\n O uso de polimorfismo permite que n\u00e3o haja altera\u00e7\u00f5es ao membro SIMULATI-\n\nON_core::tsSolver() poupando o desenvolvedor de tarefas adicionais. Para isso, o uso de \n\nm\u00e9todos virtuais \u00e9 necess\u00e1rio de forma que o ponteiro pElliptic_eq, que \u00e9 definido como \n\num Elliptic_equation, possa acessar os membros da classe EBFV1_elliptic como \u00e9 o caso \n\nda fun\u00e7\u00e3o solver. Esta \u00e9 declarada como uma fun\u00e7\u00e3o puramente virtual \n\n \n\nvirtual solver() const=0; \n\n \n\npois permite que em cada classe derivada ela possa ser implementada de acordo com a \n\nformula\u00e7\u00e3o desejada. O mesmo princ\u00edpio \u00e9 utilizado para as classes da equa\u00e7\u00e3o hiperb\u00f3li-\n\nca. \n\n Classes auxiliares complementam o trabalho de c\u00e1lculo das equa\u00e7\u00f5es apresentadas \n\nde forma a fornecer as informa\u00e7\u00f5es de uma forma bem definida e clara. Um ponto interes-\n\nsante da programa\u00e7\u00e3o orientada a objetos est\u00e1 em permitir que outros desenvolvedores \n\npossam criar novas funcionalidades sobre algo que j\u00e1 existe sem necessidade de conhecer \n\ncomo esta base funciona. Um exemplo neste trabalho est\u00e1 no uso da fun\u00e7\u00e3o do FMDB \n\n \n\nvoid EN_attachDataPtr(mEntity * ,pMeshDataId, void *); \n\n \n\nque permite associar um ponteiro (void*) a uma entidade (mEntity*) da malha por meio de \n\num identificador (pMeshDataId). \n\n A classe ManagerData foi criada de forma a servir de base para outras classes de-\n\nsenvolvidas com o prop\u00f3sito de inserir e extrair dados \u00e0s entidades da malha sem se ater \n\naos detalhes do funcionamento das fun\u00e7\u00f5es EN_attachDataPtr e EN_getDataPtr. \n\nAl\u00e9m disso, esta classe permite que se construam c\u00f3digos mais enxutos, pois evita a repeti-\n\n\u00e7\u00e3o de linhas de c\u00f3digo toda vez que se deseje acessar dados de uma entidade. \n\n\n\n102 \n\n O c\u00f3digo abaixo mostra os principais membros (getDataPointer e setDataPointer) \n\nda classe ManagerData onde o uso de fun\u00e7\u00f5es templates permite a parametriza\u00e7\u00e3o dos da-\n\ndos a serem associados a uma entidade da malha tornando-as, assim, gen\u00e9ricas para qual-\n\nquer tipo de ponteiro. \n\n \n\ntemplate&lt;class T> \n\nT* getDataPointer(pEntity ent){ \n\n void *p; p=0; \n\n EN_getDataPtr(ent,dataAttached_id,&amp;p); \n\n return (p) ? (T*)p : new T; \n\n} \n\n \n\ntemplate&lt;class T> \n\nvoid setDataPointer(pEntity ent, T* ptr){ \n\n void *p; p=0; \n\n p = (T*)ptr; \n\n EN_attachDataPtr(ent,dataAttached_id,p); \n\n} \n\n \n\n Duas classes que herdam ManagerData s\u00e3o GeometricCoefficientsData e Physi-\n\ncalPropertiesData como mostra o diagrama de hierarquia na Fig. (5.6). \n\n \n\n \n\nFigura 5.6 \u2013 Diagrama de classes ManagerData. \n \n\n Ao inicializar um objeto de uma destas classes, o construtor da classe base (Mana-\n\ngerData) \u00e9 chamado e este se encarrega de gerar um identificador (pMeshDataId). Estas \n\nclasses foram criadas para gerenciar os dados geom\u00e9tricos da formula\u00e7\u00e3o de volumes fini-\n\ntos e dados f\u00edsicos do problema como press\u00e3o, gradiente de press\u00e3o, velocidade, fluxo e \n\nsatura\u00e7\u00e3o. Para associar estas informa\u00e7\u00f5es a uma entidade, estas s\u00e3o agrupadas em uma \n\nestrutura (struct). No caso da classe PhysicalPropertiesData uma estrutura agrupa todas as \n\npropriedades f\u00edsicas nodais como press\u00e3o, gradiente de press\u00e3o, satura\u00e7\u00e3o de \u00e1gua e o ter-\n\nmo de fluxo como mostra o c\u00f3digo abaixo. \n\n \n\n\n\n103 \n\nstruct NodePhysicalProperties{ \n\n double p;    // pressure \n\n std::vector<double> p_Grad; // pressure gradient \n\n double Sw;    // water saturation \n\n double flux;   // flux term \n\n}; \n\n \n\n A classe PhysicalPropertiesData fornece apenas as fun\u00e7\u00f5es de inser\u00e7\u00e3o (set) e ob-\n\nten\u00e7\u00e3o (get) de dados. Para cada n\u00f3 da malha, um novo ponteiro (NodePhysicalProperti-\n\nes*) \u00e9 alocado para esta entidade. Como exemplo, a vari\u00e1vel de satura\u00e7\u00e3o tem seu valor \n\nalterado em um n\u00f3 por meio do membro setSaturation (pEntity, double) onde um ponteiro \n\npara a estrutura NodePhysicalProperties \u00e9 definido e inicializado com o valor de retorno \n\nda fun\u00e7\u00e3o getDataPointer que \u00e9 um membro da classe base ManagerData. O trecho de c\u00f3-\n\ndigo a seguir mostra como funciona a fun\u00e7\u00e3o para mudar a satura\u00e7\u00e3o de um n\u00f3. \n\n \n\nvoid PhysicalPropertiesData::setSaturation(pEntity node, double Sw){ \n\n \n\n // Define um ponteiro que agrupa dados. \n\n NodePhysicalProperties* pNode; \n\n \n\n // getDataPointer retorna um ponteiro do tipo NodePhysicalPro -  \n\n // perties associado a node. \n\n pNode = getDataPointer<NodePhysicalProperties>(node); \n\n \n\n // acessa a vari\u00e1vel Sw referente \u00e0 satura\u00e7\u00e3o atribuindo um no-  \n\n // novo valor. \n\n pNode->Sw = Sw; \n\n} \n\n \n\n A vari\u00e1vel velocidade n\u00e3o est\u00e1 associada aos n\u00f3s, mas sim \u00e0s arestas. Dessa forma, \n\numa estrutura EdgePhysicalProperty \u00e9 definida e um novo ponteiro \u00e9 associado a cada a-\n\nresta da malha.  \n\n As classes GeometricCoefficientsData e PhysicalPropertiesData apresentadas n\u00e3o \n\nrealizam nenhuma tarefa relacionada a troca de mensagens entre processos. Essas tarefas, \n\npor sua vez, s\u00e3o atribu\u00eddas \u00e0 classe MeshData que serve de base ao envio e recebimento de \n\ndados. Informa\u00e7\u00f5es sobre n\u00f3s livres e n\u00f3s de valores prescritos local e global e o mapea-\n\nmento de n\u00f3s usando a rotina applicationOrdering do PETSc discutido no item 5.4.5 s\u00e3o \n\n\n\n104 \n\nimplementadas de forma a auxiliar principalmente a montagem do sistema de equa\u00e7\u00f5es \n\npara a resolu\u00e7\u00e3o do campo de press\u00f5es. \n\n Para que cada processo possa exportar em arquivo os dados para posterior visuali-\n\nza\u00e7\u00e3o como o campo de satura\u00e7\u00f5es mostrado na Fig. 5.7, as propriedades f\u00edsicas sobre os \n\nn\u00f3s nas fronteiras das parti\u00e7\u00f5es devem ser id\u00eanticas \u00e0s das suas c\u00f3pias remotas. \n\n \n\n \n\nFigura 5.7 \u2013 Parti\u00e7\u00e3o de uma malha mostrando o campo de satura\u00e7\u00e3o de \u00e1gua em um dado \ninstante da simula\u00e7\u00e3o. \n \n\n Um membro da classe MeshData \u00e9 respons\u00e1vel por coletar todos os valores de uma \n\ncerta propriedade relacionados aos n\u00f3s nas fronteiras das parti\u00e7\u00f5es somando-os e em se-\n\nguida distribuindo os resultados. \n\n \n\nFigura 5.8 \u2013 Malha de tri\u00e2ngulos distribu\u00eddos entre tr\u00eas processos destacando pelas linhas \ntracejadas os n\u00f3s com c\u00f3pias remotas. \n \n\n A figura 5.8 mostra uma malha formada por tr\u00eas tri\u00e2ngulos distribu\u00edda entre tr\u00eas \n\nprocessos. Nesta malha, os n\u00f3s 1, 3 e 5 possuem c\u00f3pias remotas cuja propriedade f\u00edsica \n\n\n\n105 \n\nnodal \u00e9 obtida pela contribui\u00e7\u00e3o das arestas locais conectadas a estes. Um exemplo seria o \n\nfluxo. \n\n As etapas para o c\u00e1lculo do fluxo compreendem inicialmente uma fase seq\u00fcencial \n\nseguida de uma fase paralela. A tarefa de coleta e distribui\u00e7\u00e3o \u00e9 dada pela fun\u00e7\u00e3o updateS-\n\ncalarData da classe MeshData. \n\n \n\nLa\u00e7o sobre as arestas{ \n\n C\u00e1lculo local dos termos de fluxo nodal \n\n} \n\n \n\n// Coleta e distribui\u00e7\u00e3o dos fluxos sobre n\u00f3s com c\u00f3pias remotas \n\npMData->updateScalarData(theMesh,&amp;PhysicalPropertiesData::nonvisc); \n\n \n\n Na chamada de updateScalarData, a malha e um ponteiro de fun\u00e7\u00e3o s\u00e3o passados \n\ncomo argumentos. As estruturas de vetores e matrizes distribu\u00eddas do PETSc s\u00e3o usadas \n\npara realizar as tarefas de coleta e distribui\u00e7\u00e3o dos dados onde um mapeamento semelhante \n\nao discutido no item 5.4.5 \u00e9 usado para n\u00f3s com c\u00f3pias remotas. Para este exemplo, um \n\nvetor de tr\u00eas posi\u00e7\u00f5es recebe e soma os valores dos tr\u00eas n\u00f3s como mostra a Fig. 5.9. \n\n \n\n \n\nFigura 5.9 \u2013 Vetor distribu\u00eddo entre tr\u00eas processos acumulando a contribui\u00e7\u00e3o local de uma \npropriedade f\u00edsica associada aos n\u00f3s remotos de uma malha de tri\u00e2ngulos. \n \n\n Outra propriedade que tamb\u00e9m passa pelo mesmo procedimento \u00e9 o gradiente de \n\npress\u00e3o, que como o termo de fluxo, tamb\u00e9m est\u00e1 associado aos n\u00f3s e \u00e9 obtido pela contri-\n\nbui\u00e7\u00e3o das arestas. Neste caso, a propriedade se trata de um vetor com coordenadas x, y e \n\n\n\n106 \n\nz. Seguindo o mesmo procedimento da Fig. 5.9, cada n\u00f3, com uma ou mais c\u00f3pias remotas, \n\nenvia seus dados a uma matriz de tr\u00eas colunas, e n\u00e3o um vetor, distribu\u00edda entre os proces-\n\nsos. \n\n A distribui\u00e7\u00e3o dos resultados coletados e somados segue um caminho um pouco \n\ndiferente. Vetores e matrizes do PETSc permitem que um valor seja inserido remotamente, \n\nou seja, permite que um processo insira um valor em uma posi\u00e7\u00e3o do vetor ou em uma li-\n\nnha da matriz que \u00e9 local a outro processo. Essa tarefa \u00e9 feita por meio da fun\u00e7\u00e3o: \n\n \n\nMatSetValue(matrix,&amp;row,&amp;col,value,ADD_VALUES); \n\n \n\n Por\u00e9m, para um processo obter dados de linhas que s\u00e3o remotas a ele, usa-se uma \n\nsegunda matriz, que tamb\u00e9m \u00e9 distribu\u00edda, cujas linhas locais cont\u00eam os dados requeridos \n\npor este processo. Esta coleta de dados \u00e9 feita pela fun\u00e7\u00e3o do PETSc: \n\n \n\nMatGetSubMatrixRaw(A, \n\n   pMData->get_A_nrows(), \n\n   pMData->get_A_rows_idx(), \n\n   pMData->get_ncols(), \n\n   pMData->get_A_cols_idx(), \n\n   PETSC_DECIDE,MAT_INITIAL_MATRIX, \n\n   &amp;B); \n\n \n\n A matriz A \u00e9 de onde se deseja extrair as linhas e B \u00e9 a matriz que recebe (coleta) os \n\ndados requeridos. O ponteiro pMData \u00e9 do tipo MeshData e \u00e9 usado para informar as li-\n\nnhas e colunas de A que devem ser importadas. \n\n A constru\u00e7\u00e3o de classes e a rela\u00e7\u00e3o entre elas quando preciso demanda um bom \n\ntempo de trabalho, pois devem ser projetadas de forma a representar bem os conceitos que \n\npretendem moldar, facilitando, assim, a constru\u00e7\u00e3o do programa. As classes que comp\u00f5em \n\no simulador e que foram aqui apresentadas tentam expressar da forma mais clara poss\u00edvel \n\nseus prop\u00f3sitos permitindo que estas possam ser estendidas a outros programas. \n\n \n\n5.7 An\u00e1lises de desempenho \n \n\n Geralmente, a an\u00e1lise de desempenho de um programa paralelo refere-se a como \n\neste se compara a um programa seq\u00fcencial. Se ambos levam o mesmo tempo para resolver \n\n\n\n107 \n\num mesmo problema, ent\u00e3o o primeiro \u00e9 completamente in\u00fatil, pois se espera que o tempo \n\nfinal de execu\u00e7\u00e3o de um programa paralelo seja reduzido significativamente \u00e0 medida que \n\nse aumenta o n\u00famero de processadores. \n\n Duas formas de medidas comumente usadas para avaliar o desempenho de progra-\n\nmas paralelos s\u00e3o: o speed-up e a efici\u00eancia. O speed-up compara o tempo de execu\u00e7\u00e3o do \n\nprograma paralelo com o do programa seq\u00fcencial. A primeira vista, pode-se imaginar que \n\nse um programa seq\u00fcencial leva um tempo seqt t= , logo o tempo de execu\u00e7\u00e3o do progra-\n\nma paralelo resolvendo o mesmo problema usando, por exemplo, dois processadores seria \n\n/ 2par seqt t= , com tr\u00eas processadores / 3par seqt t=  e assim por diante. Entretanto, o que a-\n\ncontece \u00e9 diferente. Programas paralelos trocam informa\u00e7\u00f5es entre si durante a execu\u00e7\u00e3o e \n\nesta tarefa consume um tempo que n\u00e3o existe em programas seq\u00fcenciais e esse custo tende \n\na afastar o tempo de execu\u00e7\u00e3o paralelo real do ideal. H\u00e1 programas paralelos que conse-\n\nguem uma aproxima\u00e7\u00e3o muito boa do ideal, mas como j\u00e1 foi dito esses resultados s\u00e3o con-\n\nseq\u00fc\u00eancia de anos de aprimoramento do c\u00f3digo. \n\n O speed-up, que representa a raz\u00e3o do tempo de execu\u00e7\u00e3o do programa seq\u00fcencial \n\npelo tempo de execu\u00e7\u00e3o em paralelo para um mesmo problema. \n\n \n\n ( )\n( )\n\n( )\n,\n\n,\nseq\n\npar\n\nT n\nS n p\n\nT n p\n=  (5.9) \n\n \n\nOnde n representa o tamanho do problema e p o n\u00famero de processadores. \n\n Com os dados de speed-up tra\u00e7a-se um gr\u00e1fico que mostra como o programa para-\n\nlelo se comporta com o aumento do n\u00famero de processadores. Neste trabalho, um proble-\n\nma de \u00bc de \u201cfive-spot\u201d foi analisado com duas malhas representando a mesma geometria e \n\ncom as mesmas condi\u00e7\u00f5es de contorno, por\u00e9m com n\u00famero de n\u00f3s diferentes sendo uma \n\ncom 150.725 n\u00f3s e 846.855 tetraedros e a outra com 589.487 n\u00f3s e 3.299.170 tetraedros. \n\nEsta \u00faltima foi a maior que pode ser executada por um \u00fanico processador.  \n\n Em ambas as an\u00e1lises foram usados: 1, 2, 4, 8,16 e 32 processadores. Como a cada \n\npasso de tempo do problema as opera\u00e7\u00f5es de ponto flutuante e o n\u00famero de envio e rece-\n\nbimento de mensagens se repetem, foi obtida uma m\u00e9dia do tempo de execu\u00e7\u00e3o para vinte \n\npassos de tempo. As tabelas 5.2 e 5.3 mostram os resultados obtidos para as duas an\u00e1lises, \n\nonde NP refere-se ao n\u00famero de processadores e o tempo acumulado refere-se ao tempo de \n\nexecu\u00e7\u00e3o consumido ap\u00f3s 20 passos de tempo. \n\n\n\n108 \n\n \n\n \n\nTabela 5.2 \u2013 Malha com 150.725 n\u00f3s. \n Tempo [s] Speed-up  \n\nNP Acumulado M\u00e9dio Obtido Ideal Efici\u00eancia \n\n1 6133 360,76 1 1 1 \n\n2 3668 215,76 1,67 2 0,83 \n\n4 2602 153,05 2,35 4 0,58 \n\n8 1482 87,17 4,13 8 0,51 \n\n16 1098 64,58 5,58 16 0,34 \n\n32 412 24,23 14,88 32 0,46 \n\n \n\n \n\n \n\nTabela 5.3 \u2013 Malha com 589.487 n\u00f3s. \n Tempo [s] Speed-up  \n\nNP Acumulado M\u00e9dio Obtido Ideal Efici\u00eancia \n\n1 89988 4499,4 1 1 1 \n\n2 66106 3305,3 1,36 2 0,68 \n\n4 28979 1448,95 3,10 4 0,77 \n\n8 19855 992,75 4,53 8 0,56 \n\n16 12416 620,8 7,24 16 0,45 \n\n32 4093 204,65 21,98 32 0,68 \n\n \n\n O gr\u00e1fico de speed-up da figura 5.10 mostra que apesar de haver um ganho de tem-\n\npo com o aumento do n\u00famero de processadores este vai sendo reduzido e tendendo a se \n\nestabilizar como se pode observar na figura 5.11. \n\n As figuras 5.10 e 5.11 mostram as curvas de speed-up e a queda de tempo de exe-\n\ncu\u00e7\u00e3o para o problema com a malha de 150.725 n\u00f3s. \n\n \n\n \n\n\n\n109 \n\n  \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nFigura 5.10 \u2013 Compara\u00e7\u00e3o entre as curvas de speed-up ideal e real pa-\nra a malha de 150.725 n\u00f3s. \n\nFigura 5.11 \u2013 Redu\u00e7\u00e3o do tempo m\u00e9dio de execu\u00e7\u00e3o por passo de \ntempo para a malha de 150.725 n\u00f3s. \n\n\n\n110 \n\n \n\nFigura 5.12 \u2013 Compara\u00e7\u00e3o entre as curvas de speed-up ideal e real para a malha de 589.487 \nn\u00f3s. \n \n Em outras palavras, dedicar mais processadores \u00e0 execu\u00e7\u00e3o do programa n\u00e3o impli-\n\ncar\u00e1 em ganho de tempo. Pelo contr\u00e1rio, a partir de um certo n\u00famero de processadores a \n\ntend\u00eancia \u00e9 que a execu\u00e7\u00e3o em paralelo passe a consumir mais tempo devido, principal-\n\nmente, ao custo de comunica\u00e7\u00e3o entre processadores.  \n\n \n\n \n\nFigura 5.13 \u2013 Redu\u00e7\u00e3o do tempo m\u00e9dio de execu\u00e7\u00e3o por passo de tempo para a malha de \n589.487 n\u00f3s. \n \n\n\n\n111 \n\n Nas figuras 5.12 e 5.13 s\u00e3o apresentados os gr\u00e1ficos de speed-up e de redu\u00e7\u00e3o de \n\ntempo para o problema com a malha de 589.487 n\u00f3s. \n\n O prop\u00f3sito de usar uma malha maior \u00e9 mostrar como o tamanho do problema pode \n\ninfluenciar a efici\u00eancia do programa paralelo que \u00e9 um outro par\u00e2metro de medida usado \n\nna avalia\u00e7\u00e3o de desempenho. A efici\u00eancia \u00e9 definida como a raz\u00e3o do speed-up pelo n\u00fame-\n\nro de processadores usados. \n\n \n\n ( )\n( ),\n\n,\nS n p\n\nE n p\np\n\n=  (5.10) \n\n \n\n Para um problema de tamanho fixo, \u00e0 medida que se aumenta o n\u00famero de proces-\n\nsadores o n\u00famero de comunica\u00e7\u00f5es remotas passa a representar uma parte maior do tempo \n\ntotal de processamento. Quando se trata de problemas maiores, que ocupam a maior parte \n\nda mem\u00f3ria dispon\u00edvel, esse tempo de comunica\u00e7\u00e3o tende a representar uma percentagem \n\nmenor desse tempo total e, conseq\u00fcentemente, a efici\u00eancia do programa paralelo pode ser \n\nmelhor avaliada. A figura 5.14 mostra as curvas de efici\u00eancias para as duas malhas usadas. \n\n \n\n \n\nFigura 5.14 \u2013 Compara\u00e7\u00e3o das curvas de efici\u00eancia para duas malhas. \n \n\n Como era de se esperar, o programa paralelo apresentou uma efici\u00eancia maior com \n\na malha de 589.487 n\u00f3s. A figura 5.15 abaixo tamb\u00e9m mostra que o speed-up para a malha \n\nmaior tamb\u00e9m ficou acima da malha de 150.725 n\u00f3s. \n\n\n\n112 \n\n \n\n \n\nFigura 5.15 \u2013 Compara\u00e7\u00e3o entre curvas de speed-up para o um mesmo problema tratado \ncom malhas de tamanhos diferentes. \n \n\n As an\u00e1lises de desempenho aqui apresentadas mostram que apesar do programa pa-\n\nralelo ter atingido seu objetivo de reduzir o tempo de simula\u00e7\u00e3o com o aumento do n\u00famero \n\nde processadores, v\u00e1rios aprimoramentos precisam ser realizados no c\u00f3digo visando um \n\nuso mais eficiente da m\u00e1quina. A parte da simula\u00e7\u00e3o que representou o maior custo no uso \n\nde CPU (99%) foi o c\u00e1lculo do campo de press\u00f5es efetuado atrav\u00e9s da biblioteca PETSc.  \n\n A tabela 5.4 mostra o tempo, em segundos, utilizado para a montagem das matrizes \n\n[ ]E , [ ]F  e [ ]G  e para o c\u00e1lculo do sistema de equa\u00e7\u00f5es, assim como o n\u00famero de itera-\n\n\u00e7\u00f5es necess\u00e1rias para a sua converg\u00eancia e o n\u00famero de opera\u00e7\u00f5es de ponto flutuante por \n\nsegundo. Foram mantidas as configura\u00e7\u00f5es padr\u00f5es do PETSc para o solver iterativo: \n\n \n\nToler\u00e2ncia absoluta de converg\u00eancia: 1e-50 \n\nToler\u00e2ncia relativa de converg\u00eancia:  1e-8 \n\nToler\u00e2ncia de diverg\u00eancia:   10.000 \n\nN\u00famero m\u00e1ximo de itera\u00e7\u00f5es :  10.000 \n\nN\u00famero de restarts do m\u00e9todo GMRES: 30 \n\n \n\n Pela tabela 5.4, v\u00ea-se que o custo computacional da equa\u00e7\u00e3o hiperb\u00f3lica, resolvida \n\nexplicitamente, \u00e9 extremamente inferior ao da equa\u00e7\u00e3o el\u00edptica. \n\n \n\n\n\n113 \n\nTabela 5.4 \u2013 Tempo, em segundos, consumido por v\u00e1rios est\u00e1gios a cada passo de tempo \nda simula\u00e7\u00e3o para a malha de 589.487 n\u00f3s \n\nNP \nEq. El\u00edptica Eq. Hiperb\u00f3lica \n\nt1 t2 t3 N\u00famero de itera\u00e7\u00f5es *Mflops \n\n1 63 4436 4499 4082 154 24 \n\n2 449 2856 3305 4937 78 13 \n\n4 260 1188 1448 4701 124 7 \n\n8 177 815 992 4259 117 3,37 \n\n16 86 534 620 7533 136 1,58 \n\n32 55 149 204 4213 98 0,81 \n\nt1- montagem das matrizes; t2 \u2013 resolu\u00e7\u00e3o do sistema de equa\u00e7\u00f5es; t3 \u2013total; \n*Mflops \u2013 Milh\u00f5es de opera\u00e7\u00f5es de ponto flutuante por segundo. \n\n\n\n114 \n\n6. CONCLUS\u00d5ES E TRABALHOS FUTUROS \n \n\n6.1 Conclus\u00f5es \n \n Neste trabalho, foram apresentados alguns resultados de acur\u00e1cia de duas formula-\n\n\u00e7\u00f5es de volumes finitos baseados em arestas (EBFV1 e EBFV2) que podem ser aplicados \n\npara resolver equa\u00e7\u00f5es el\u00edpticas com coeficientes altamente descont\u00ednuos usando estruturas \n\nde dados por arestas. Estas equa\u00e7\u00f5es el\u00edpticas s\u00e3o bastante comuns em in\u00fameras \u00e1reas do \n\nconhecimento, particularmente em problemas de condu\u00e7\u00e3o de calor e escoamento de flui-\n\ndos em meios porosos, tais como o fluxo bif\u00e1sico \u00f3leo-\u00e1gua em reservat\u00f3rios de petr\u00f3leo e \n\ntransporte de contaminantes em aq\u00fc\u00edferos. Tensores cheios (coeficientes de difus\u00e3o n\u00e3o-\n\ndiagonal) e malhas n\u00e3o-ortogonais s\u00e3o lidadas naturalmente por ambas as formula\u00e7\u00f5es \n\nEBFV e os termos de difus\u00e3o cruzada s\u00e3o corretamente calculados. \n\n De forma a mostrar o potencial dos dois procedimentos de volumes finitos apresen-\n\ntados, foram resolvidos alguns problemas benchmark envolvendo coeficientes de difus\u00e3o \n\nn\u00e3o-diagonais e descont\u00ednuos e termos fonte distribu\u00eddos descont\u00ednuos. Ambos os m\u00e9todos \n\nmostraram acur\u00e1cia de segunda ordem para a vari\u00e1vel escalar, por exemplo press\u00e3o, para \n\nsolu\u00e7\u00f5es com anisotropia suave e moderada. Ambos os m\u00e9todos demandam mais melho-\n\nramentos caso se deseje garantir monotonicidade  na presen\u00e7a de solu\u00e7\u00f5es com alta aniso-\n\ntropia. Os m\u00e9todos n\u00e3o foram comparados em termos de efici\u00eancia computacional. Os re-\n\nsultados s\u00e3o bem promissores e se comparam favoravelmente com outros resultados en-\n\ncontrados na literatura. \n\n A formula\u00e7\u00e3o EBFV2 foi desenvolvida com o intuito de se ter uma formula\u00e7\u00e3o de \n\nvolumes finitos capaz de lidar com a heterogeneidade do meio poroso associada aos ele-\n\nmentos da malha e n\u00e3o a dom\u00ednios como originalmente foi desenvolvida a formula\u00e7\u00e3o \n\nEBFV1. \n\n O uso de um modelo de passo de tempo adaptativo para a formula\u00e7\u00e3o IMPES mos-\n\ntrou ser poss\u00edvel obter um ganho de tempo de uso de CPU significativo para problemas de \n\nfluxo bifasico \u00f3leo-\u00e1gua tanto em meios homog\u00eaneos quanto heterog\u00eaneos e garantindo \n\nresultados muito pr\u00f3ximos dos obtidos pelo m\u00e9todo IMPES tradicional. A determina\u00e7\u00e3o do \n\nmelhor par\u00e2metro de toler\u00e2ncia para a varia\u00e7\u00e3o do campo de velocidade DVTOL foi feita \n\nap\u00f3s v\u00e1rias an\u00e1lises de acur\u00e1cia e efici\u00eancia computacional para diferentes malhas e dife-\n\nrentes meios porosos. Em um dos problemas, por exemplo, onde uma malha de aproxima-\n\ndamente 10.000 n\u00f3s num meio heterog\u00eaneo foi avaliada, para o \n35 10DVTOL ?= ? , foi pos-\n\n\n\n115 \n\ns\u00edvel efetuar uma simula\u00e7\u00e3o ate PVI=1.0 resolvendo o campo de press\u00e3o e velocidade ape-\n\nnas 151 vezes contra 5882 vezes do campo de satura\u00e7\u00e3o.  \n\n Esse resultado mostra que o problema de estabilidade que restringe severamente o \n\ntamanho do passo de tempo do termo hiperb\u00f3lico, maior entrave ao uso do m\u00e9todo IMPES \n\npara problemas com malhas muito refinadas, pode ser superado e se conseguir resultados e \n\npr\u00f3ximos do IMPES cl\u00e1ssico. \n\n O uso de computadores paralelos aparecem como uma importante ferramenta na \n\nsimula\u00e7\u00e3o num\u00e9rica de alto desempenho em reservat\u00f3rios de petr\u00f3leo para problemas de \n\ngrande porte. O simulador desenvolvido no presente trabalho, escrito em C++ e fazendo \n\nuso dos paradigmas da programa\u00e7\u00e3o orientada a objetos, permite a avalia\u00e7\u00e3o de problemas \n\nde fluxo \u00f3leo-\u00e1gua em meios homog\u00eaneos e heterog\u00eaneos tanto em computadores seq\u00fcen-\n\nciais (um processador) ou computadores paralelos (m\u00faltiplos processadores) de mem\u00f3ria \n\ndistribu\u00edda. \n\n Diversos pacotes de c\u00f3digo aberto voltados \u00e0 programa\u00e7\u00e3o paralela foram estuda-\n\ndos e incorporados ao simulador, e estes desempenham diversas tarefas tais como: o geren-\n\nciamento de malhas distribu\u00eddas (FMDB), o balan\u00e7o de carga entre processadores (ParMe-\n\ntis) e a resolu\u00e7\u00e3o de sistemas de equa\u00e7\u00f5es lineares e manipula\u00e7\u00e3o de matrizes e vetores dis-\n\ntribu\u00eddos (PETSc).  \n\n Apesar da aus\u00eancia de um gerador de malhas paralelo que permitiria produzir ma-\n\nlhas de grande porte a ponto de ocupar a maior parte da mem\u00f3ria dispon\u00edvel dos processa-\n\ndores envolvidos na simula\u00e7\u00e3o, pode-se produzir malhas relativamente grandes e extrair \n\nalguns resultados qualitativos e de desempenho. A complexidade do uso dos pacotes em-\n\npregados exigiu um bom tempo de dedica\u00e7\u00e3o no uso de suas rotinas da forma mais eficien-\n\nte poss\u00edvel. \n\n \n\n6.2 Trabalhos Futuros \n\n \n\n\u2022 Aplicar a formula\u00e7\u00e3o EBFV2 em problemas de simula\u00e7\u00e3o de reservat\u00f3rios usando o \n\nm\u00e9todo IMPES e IMPES modificado. \n\n \n\n\u2022 Empregar t\u00e9cnicas de aproxima\u00e7\u00e3o de alta ordem para o termo de satura\u00e7\u00e3o para \n\nambas as formula\u00e7\u00f5es. \n\n \n\n\n\n116 \n\n\u2022 Acrescentar outras f\u00edsicas \u00e0 simula\u00e7\u00e3o de reservat\u00f3rios como press\u00e3o capilar e gra-\n\nvidade. \n\n \n\n\u2022 Estudo de t\u00e9cnicas que garantam a monotonicidade de resultados para problemas \n\ncom heterogeneidade e anisotropia elevada. \n\n \n\n\u2022 Estudo e valida\u00e7\u00e3o de outros m\u00e9todos de integra\u00e7\u00e3o no tempo de grande interesse \n\ncomo o seq\u00fcencial impl\u00edcito e o totalmente impl\u00edcito. \n\n \n\n\u2022 Estudo e implementa\u00e7\u00e3o da formula\u00e7\u00e3o black-oil. \n\n \n\n\u2022 Estudar novas t\u00e9cnicas para o melhoramento de opera\u00e7\u00f5es que exigem troca de \n\nmensagens entre processadores, em particular a montagem e a resolu\u00e7\u00e3o de siste-\n\nmas de equa\u00e7\u00f5es lineares em paralelo. \n\n \n\n\u2022 Estudo de t\u00e9cnicas de alto desempenho como adapta\u00e7\u00e3o de malhas e multgrid apli-\n\ncados tanto em simula\u00e7\u00f5es seq\u00fcenciais como em simula\u00e7\u00f5es paralelas. \n\n \n\n\u2022 Na aus\u00eancia de geradores de malha paralelo, estudar a possibilidade de aplicar pro-\n\ncedimentos de refinamento nas parti\u00e7\u00f5es da malha distribu\u00edda de forma a gerar pro-\n\nblemas de grande porte e avaliar a capacidade de escalabilidade do simulador. \n\n\n\n 117\n\nAP\u00caNDICE A \n \n \n Equa\u00e7\u00e3o de press\u00e3o para escoamento monof\u00e1sico em meios porosos totalmente he-\n\nterog\u00eaneo (elemento por elemento) e anisotr\u00f3pico usando MVFA. \n\n \n\nTermo de Fluxo (equa\u00e7\u00e3o de press\u00e3o): \n\n \n\n( ). ( ) ( ) 0K x u x? ? ? =\n?\n\n (A.1) \n\n \n\nonde:  \n\n \n\n2( , )x x y= ? ? ? ?  e ( )\nxx xy\n\nyx yy\n\nK K\nK x\n\nK K\n\n? ?\n= ? ?\n? ?\n\n \n\n \n\n Considerando a malha 2D de elementos triangulares representada pela figura A.1 e \n\nonde cada cor representa um material com permeabilidade e porosidade diferentes, s\u00e3o \n\nconstru\u00eddos volumes de controle ao redor de cada n\u00f3 da malha ligando-se os pontos m\u00e9dios \n\ndas arestas e o baricentro dos elementos. As setas representam os vetores ortogonais \u00e0s fa-\n\nces do volume de controle conseq\u00fc\u00eancia da aplica\u00e7\u00e3o do teorema da diverg\u00eancia ao termo \n\nde fluxo mostrada na equa\u00e7\u00e3o 2. \n\n \n\n \n\nAplicado o teorema da diverg\u00eancia na equa\u00e7\u00e3o 1: \n\n \n\n\n\n 118\n\n( ) ( ). .K u K u n\n?\n\n? ? ? ?? = ? ? ??? ?\n? ? ?\n\n (A.2) \n\n \n\n Considerando K constante em cada elemento (Cell-Based Scheme) o lado direito da \n\nEq. (A.2) pode ser aproximado para um n\u00f3 I como: \n\n \n\n( ) ( ). .m m m\nNE\n\ne e e\nI\n\nm\n\nK u n K u C\n?\n\n? ? ?? = ? ???\n?? ??\n\n (A.3) \n\n \n\nonde: \n\n \n\nm e NE s\u00e3o o elemento e o n\u00famero de elementos associado ao n\u00f3 I, e  \n\n \n\nm m me e e\nI IJ IKC C C= +\n? ? ?\n\n (A.4) \n\n \n\nExpandindo o somat\u00f3rio da Eq. (A.3) para o n\u00f3 1, fica: \n\n \n\n( ) ( ) ( ) ( ) ( )\n\n( ) ( )\n\n1 1 1 1 2 2 2 2\n\n3 3 3 3\n\n1 12 13 13 14\n\n12 14\n\n.m m m\nNE\n\ne e e e e e e e e e e\n\nm\n\ne e e e\n\nK u C K u C C K u C C\n\nK u C C\n\n?? ? = ? + + ? + +\n?\n\n?? +\n?\n\n?\n? ? ? ? ?? ? ?\n\n? ??\n (A.5) \n\n \n\n A Eq. (A.5) precisa ser escrita em termos dos valores nodais de u. Dessa forma, \n\numa nova aproxima\u00e7\u00e3o deve ser feita para os gradientes que s\u00e3o admitidos constantes nos \n\nelementos. Aplicando o teorema da diverg\u00eancia ao gradiente de um elemento e: \n\n \n\n.\ne e\n\ne eu u n\n? ?\n\n? ?? = ??? ?\n? ?\n\n (A.6) \n\n \n\nO lado direito da Eq. (A.6) pode ser aproximado como: \n\n \n\n. .\nIJe\n\ne IJu n u D\n??\n\n?? = ???\n??\n\n (A.7) \n\n \n\n\n\n 119\n\nonde: \n\n \n\nIJu  \u00e9 a media aritm\u00e9tica dos valores nodais I e J e IJD\n?\n\n\u00e9 vetor normal \u00e0 aresta e externo ao \n\nelemento. \n\n \n\nAdmitindo a seguinte aproxima\u00e7\u00e3o \n\n \n\n3\ne\n\ne e\neu u V\n\n?\n\n? ?? = ??  (A.8) \n\n \n\no gradiente eu? do elemento pode ser escrito como: \n\n \n\n1\n2\n\n3 2e\nIJ\n\ne I J\nIJe\n\nu u\nu D\n\nV ?\n\n? ?+? ?\n? = ? ?? ?? ?? ?? ?\n\n?\n?\n\n (A.9) \n\n \n\nonde eV  corresponde a 1/3 da \u00e1rea total do elemento e IJD\n?\n\n representa 1/2 da aresta. \n\nEscrevendo a Eq. (A.9) para todos os elementos da malha, fica: \n\n \n\n?\n?\n\n?\n?\n?\n\n? +\n+\n\n+\n+\n\n+\n=? 13\n\n31\n23\n\n32\n12\n\n21 .2\n2\n\n.2\n2\n\n.2\n23\n\n1\n1 D\n\nuu\nD\n\nuu\nD\n\nuu\n\nV\nu\n\ne\n\ne\n????\n\n (A.10) \n\n \n\n?\n?\n\n?\n?\n?\n\n? +\n+\n\n+\n+\n\n+\n=? 14\n\n14\n34\n\n43\n13\n\n31 .2\n2\n\n.2\n2\n\n.2\n23\n\n1\n2\n\n2 D\nuu\n\nD\nuu\n\nD\nuu\n\nV\nu\n\ne\ne\n\n????\n (A.11) \n\n \n\n?\n?\n\n?\n?\n?\n\n? +\n+\n\n+\n+\n\n+\n=? 12\n\n12\n24\n\n24\n14\n\n41 .2\n2\n\n.2\n2\n\n.2\n23\n\n1\n3\n\n3 D\nuu\n\nD\nuu\n\nD\nuu\n\nV\nu\n\ne\ne\n\n????\n (A.12) \n\n \n\nRearranjando as Eq. (A.10) a (A.12), fica: \n\n \n\n( ) ( ) ( )[ ]231332312213121\n1\n\n1\n\n3\n\n1\nDDuDDuDDu\n\nV\nu\n\ne\ne\n\n???????\n+++++=?  (A.13) \n\n \n\n\n\n 120\n\n( ) ( ) ( )[ ]341443413314131\n2\n\n2\n\n3\n\n1\nDDuDDuDDu\n\nV\nu\n\ne\ne\n\n???????\n+++++=?  (A.14) \n\n \n\n( ) ( ) ( )[ ]241442412214121\n3\n\n3\n\n3\n\n1\nDDuDDuDDu\n\nV\nu\n\ne\ne\n\n???????\n+++++=?  (A.15) \n\n \n\nSabendo que: \n\n \n\nJIIJ DD\n??\n\n?=  (A.16) \n\n0=++ JKIKIJ DDD\n???\n\n (A.17) \n\n \n\nAs Eq. (A.13) a (A.15) podem ser reescritas como: \n\n \n\n[ ]123132231\n1\n\n1\n\n3\n\n1\nDuDuDu\n\nV\nu\n\ne\ne\n\n????\n++=?  (A.18) \n\n \n\n[ ]134143341\n2\n\n2\n\n3\n\n1\nDuDuDu\n\nV\nu\n\ne\ne\n\n????\n++=?  (A.19) \n\n \n\n[ ]124142241\n3\n\n3\n\n3\n\n1\nDuDuDu\n\nV\nu\n\ne\ne\n\n????\n++=?  (A.20) \n\n \n\n Com os gradientes dos elementos agora conhecidos, as Eq. (A.18) a (A.20) s\u00e3o in-\n\ntroduzidas na Eq. (A.5) que calcula o termo de fluxo para o n\u00f3 1. Em seguida s\u00e3o deduzi-\n\ndas as equa\u00e7\u00f5es para os n\u00f3s 1, 2, 3 e 4 respectivamente. \n\n \n\nN\u00f3 1: \n\n \n\n( ) ( ) ( ) ( ) ( )\n\n( ) ( )\n\n1 1 1 1 2 2 2 2\n\n3 3 3 3\n\n1 12 13 13 14\n\n12 14\n\n.m m m\nNE\n\ne e e e e e e e e e e\n\nm\n\ne e e e\n\nK u C K u C C K u C C\n\nK u C C\n\n?? ? = ? ? + + ? + +\n?\n\n?? +\n?\n\n?\n? ? ? ? ?? ? ?\n\n? ??\n (A.21) \n\n \n\n\n\n 121\n\n( ) ( )\n\n( ) ( )\n\n( ) ( )\n\n1\n\n1 1\n\n1\n\n2\n\n2 2\n\n2\n\n3\n\n3 3\n\n3\n\n1 23 2 13 3 12 12 13\n\n1 34 3 14 4 13 13 14\n\n1 24 2 14 4 12 12 14\n\n3\n\n       \n3\n\n       \n3\n\ne\ne e\n\ne\n\ne\ne e\n\ne\n\ne\ne e\n\ne\n\nK\nu D u D u D C C\n\nV\n\nK\nu D u D u D C C\n\nV\n\nK\nu D u D u D C C\n\nV\n\n?\n= ? + + + +?\n\n?\n\n+ + + +\n\n?\n+ + + ?\n\n?\n\n? ?? ? ?\n\n? ?? ? ?\n\n? ?? ? ?\n\n (A.22) \n\n \n\nRearranjando a Eq. (A.22), fica: \n\n \n\n( ) ( ) ( )\n\n( ) ( )\n\n( )\n\n1 2 3\n\n3 31 1 2 2\n\n31 2\n\n1 3\n\n3 31 1\n\n31\n\n1 2\n\n1 1\n\n1\n\n23 34 24\n1 12 13 13 14 12 14\n\n13 14\n2 12 13 12 14\n\n12 14\n3 12 13\n\n1\n\n3\n\n           \n\n           \n\ne e e\ne ee e e e\n\nee e\n\ne e\ne ee e\n\nee\n\ne e\ne e\n\ne\n\nK D K D K D\nu C C C C C C\n\nV V V\n\nK D K D\nu C C C C\n\nV V\n\nK D K D\nu C C\n\nV\n\n? ? ??\n= ? + + + + + +? ? ?\n\n? ? ??\n\n? ?\n+ + + +? ?\n\n? ?\n\n+ +\n\n? ? ?\n? ? ? ? ? ?\n\n? ?\n? ? ? ?\n\n? ?\n? ?\n\n( )\n\n( ) ( )\n\n2 2\n\n2\n\n2 3\n\n3 32 2\n\n32\n\n13 14\n\n13 12\n4 13 14 12 14           \n\ne e\ne\n\ne e\ne ee e\n\nee\n\nC C\nV\n\nK D K D\nu C C C C\n\nV V\n\n? ?\n+ +? ?\n\n? ?\n\n?? ??\n+ + + ?? ?\n\n?? ??\n\n? ?\n\n? ?\n? ? ? ?\n\n (A.23) \n\n \n\n Na Eq. (A.23), nota-se que 432 ,, uuu dependem de coeficientes JKC\n?\n\n que n\u00e3o concor-\n\nrem com o n\u00f3 I. Isso inviabiliza a montagem da matriz das equa\u00e7\u00f5es nodais por aresta. Lo-\n\ngo, \u00e9 preciso escrever o coeficiente JKC\n?\n\n em fun\u00e7\u00e3o do n\u00f3 I. Isso \u00e9 feito atrav\u00e9s de um sim-\n\nples artif\u00edcio geom\u00e9trico. Por exemplo, 2u depende de 13C\n?\n\nque n\u00e3o concorre com o n\u00f3 2. \n\nObservando o elemento 1 do malha em quest\u00e3o, tem-se que: \n\n \n\n012131213 =+++ CCDD\n????\n\n (A.24) \n\n \n\n \n\n Como conseq\u00fc\u00eancia do teorema da diverg\u00eancia. Al\u00e9m disso, do triangulo 1B3 se \n\nobt\u00e9m pelo mesmo princ\u00edpio que: \n\n \n\n121213 32 CDD\n???\n\n=+  (A.25) \n\n \n\n\n\n 122\n\nOnde 12 (1 / 3) 3C B=\n?\n\n (A.26) \n\n \n\ne 3B  \u00e9 a dist\u00e2ncia do ponto m\u00e9dia da aresta 1-2 ao n\u00f3 3. \n\n \n\nIntroduzindo Eq. (A.26) em (A.25) em fun\u00e7\u00e3o de 13D\n?\n\n, fica: \n\n \n\n12\n1212\n\n1312\n2\n\n3\nD\n\nDC\nCC\n\n?\n??\n\n??\n?\n\n+\n=+  (A.27) \n\n \n\n2\n\n3 1212\n1312\n\nDC\nCC\n\n??\n?? ?\n\n=+  (A.28) \n\n \n\n Como se nota na Eq. (A.28), 13C\n?\n\n pode ser escrito em fun\u00e7\u00e3o das arestas que usam o \n\nn\u00f3 2. A Eq. (A.28) pode ent\u00e3o ser escrita na forma gen\u00e9rica: \n\n \n\n2\n\n3 1 IJIJ\nIKIJ\n\nDC\nCC\n\n??\n?? ?\n\n=+  (A.29) \n\n \n\nAdotando-se este artif\u00edcio na Eq. (A.23), fica: \n\n \n\n( )\n\n( ) ( ) ( )\n1 2 3\n\n3 31 1 2 2\n\n31 2\n\n1 3 31\n\n31\n\n31\n\n1\n\n23 34 24\n1 12 13 13 14 12 14\n\n13 12 12 14 12 12\n2 12 12\n\n.\n\n1\n\n3\n\n- -\n       \n\n2 2\n\n   \n\nm m m\n\nNE\ne e e\n\nm\n\ne e e\ne ee e e e\n\nee e\n\ne e ee\nee\n\nee\n\nK u C\n\nK D K D K D\nu C C C C C C\n\nV V V\n\nK D C D K D C D\nu C C\n\nV V\n\n? ? =\n\n? ? ??\n? + + + + + +? ? ?\n\n? ? ??\n\n? ?? ? ? ?\n+ + + +? ?? ? ? ?\n\n? ?? ? ? ?? ?\n\n?\n??\n\n? ? ?\n? ? ? ? ? ?\n\n? ?? ? ? ?\n? ?\n\n1 21 2\n\n1 2\n\n1 2\n\n2 3 32\n\n32\n\n32\n\n13 13 13 1312 14\n3 13 13\n\n13 14 14 12 14 14\n4 14 14\n\n- -\n    \n\n2 2\n\n- -\n       \n\n2 2\n\ne ee e\ne e\n\ne e\n\ne e ee\nee\n\nee\n\nC D C DK D K D\nu C C\n\nV V\n\nK D C D K D C D\nu C C\n\nV V\n\n? ?? ? ? ?\n+ + + +? ?? ? ? ?\n\n? ?? ? ? ?? ?\n\n?? ?? ? ? ? ?\n+ + +? ??? ? ? ?\n\n? ?? ? ? ? ?? ??\n\n? ?? ?? ?\n? ?\n\n? ?? ? ? ?\n? ?\n\n (A.30) \n\n \n\n\n\n 123\n\n( )\n\n( ) ( ) ( )\n1 2 3\n\n3 31 1 2 2\n\n31 2\n\n1 3 31\n\n31\n\n1\n\n1\n\n23 34 24\n1 12 13 13 14 12 14\n\n13 12 12 14 12 12\n2\n\n3\n\n.\n\n1\n\n3\n\n3 3\n        \n\n2 2\n\n        \n\nm m m\n\nNE\ne e e\n\nm\n\ne e e\ne ee e e e\n\nee e\n\ne e ee\n\nee\n\ne\n\nK u C\n\nK D K D K D\nu C C C C C C\n\nV V V\n\nK D C D K D C D\nu\n\nV V\n\nK\nu\n\n? ? =\n\n? ? ??\n? + + + + + +? ? ?\n\n? ? ??\n\n? ?? ? ? ?? ?\n+ +? ?? ? ? ?\n\n? ?? ? ? ?? ?\n\n?\n??\n\n? ? ?\n? ? ? ? ? ?\n\n? ?? ? ? ?\n\n?\n1 22 2\n\n1 2\n\n2 3 32\n\n32\n\n13 13 13 1312 14\n\n13 14 14 12 14 14\n4\n\n3 3\n\n2 2\n\n3 3\n        \n\n2 2\n\ne ee e\n\ne e\n\ne e ee\n\nee\n\nC D C DD K D\n\nV V\n\nK D C D K D C D\nu\n\nV V\n\n? ?? ? ? ?? ?\n+ +? ?? ? ? ?\n\n? ?? ? ? ?? ?\n\n?? ?? ? ? ?? ? ?\n+? ??? ? ? ?\n\n? ?? ? ? ? ?? ??\n\n? ?? ??\n\n? ?? ? ? ?\n\n (A.31) \n\n \n\nN\u00f3 2: \n\n \n\n( ) ( )( ) ( )( )[ ]33331111 241223122. eeeeeeee\nNE\n\nm\n\neee CCuKCCuKCuK mmm\n????????\n\n+??++???=?? ?  (A.32) \n\n \n\nManipulando apenas o lado direito da Eq. (A.32): \n\n \n\n( ) ( )\n\n( ) ( )\n\n1\n\n1 1\n\n1\n\n3\n\n3 3\n\n3\n\n1 23 2 13 3 12 12 23\n\n1 24 2 14 4 12 12 24\n\n3\n\n       \n3\n\ne\ne e\n\ne\n\ne\ne e\n\ne\n\nK\nu D u D u D C C\n\nV\n\nK\nu D u D u D C C\n\nV\n\n?\n= ? + + ? + +?\n\n?\n\n?\n+ + ? + ?\n\n?\n\n? ?? ? ?\n\n? ?? ? ?\n (A.32) \n\n \n\n( ) ( )\n\n( ) ( )\n\n( )\n\n1 3\n\n3 31 1\n\n31\n\n1 3\n\n3 31 1\n\n31\n\n1\n\n1 1\n\n1\n\n3\n\n3\n\n23 24\n1 12 23 12 24\n\n13 14\n2 12 23 12 24\n\n12\n3 12 23\n\n12\n4\n\n3 3\n\n        \n3 3\n\n        \n3\n\n        \n3\n\ne e\ne ee e\n\nee\n\ne e\ne ee e\n\nee\n\ne\ne e\n\ne\n\ne\n\ne\n\nK D K D\nu C C C C\n\nV V\n\nK D K D\nu C C C C\n\nV V\n\nK D\nu C C\n\nV\n\nK D\nu\n\nV\n\n? ? ??\n= ? ? + + ? + +? ? ?\n\n? ? ??\n\n? ?\n? + + ? + +? ?\n\n? ?\n\n? ?\n? + +? ?\n\n? ?\n\n?\n\n? ?\n? ? ? ?\n\n? ?\n? ? ? ?\n\n?\n? ?\n\n?\n?\n\n( )3 312 24e eC C\n?? ??\n\n+ ?? ?\n?? ??\n\n?\n\n (A.33) \n\n \n\n\n\n 124\n\n( ) ( )\n\n1 31 1\n\n31\n\n31\n\n1 3\n\n3 31 1\n\n31\n\n11\n\n1\n\n23 12 12 24 12 12\n1 12 12\n\n13 24\n2 12 23 12 24\n\n23 2312\n3\n\n1\n\n3 2 2\n\n           \n\n           \n2\n\ne ee e\nee\n\nee\n\ne e\ne ee e\n\nee\n\nee\n\ne\n\nK D C D K D C D\nu C C\n\nV V\n\nK D K D\nu C C C C\n\nV V\n\nC DK D\nu\n\nV\n\n? ? ?? ? ? ?? ? ? +?\n= ? ? + + ? + +? ?? ? ? ? ?\n\n? ?? ? ? ?? ? ??\n\n? ?\n? + + ? + +? ?\n\n? ?\n\n?\n+\n\n? ?? ? ? ?\n? ?\n\n? ?\n? ? ? ?\n\n? ??\n\n1\n\n3 3\n\n3\n\n3\n\n23\n\n12 24 24\n4 24           \n\n2\n\ne\n\ne e\ne\n\ne\n\nC\n\nK D C D\nu C\n\nV\n\n? ?? ?\n+? ?? ?\n\n? ?? ?? ?\n\n?? ?? ?? ?\n+? ??? ?\n\n? ?? ? ?? ??\n\n?\n\n?? ?\n?\n\n (A.34) \n\n \n\n( ) ( )\n\n1 31 1\n\n31\n\n1 3\n\n3 31 1\n\n31\n\n11\n\n1\n\n23 12 12 24 12 12\n1\n\n13 24\n2 12 23 12 24\n\n23 2312\n3\n\n3 31\n\n3 2 2\n\n           \n\n3\n           \n\n2\n\ne ee e\n\nee\n\ne e\ne ee e\n\nee\n\nee\n\ne\n\nK D C D K D C D\nu\n\nV V\n\nK D K D\nu C C C C\n\nV V\n\nC DK D\nu\n\nV\n\n? ? ?? ? ? ?? ? ? ??\n= ? + +? ?? ? ? ? ?\n\n? ?? ? ? ?? ? ??\n\n? ?\n? + + ? + +? ?\n\n? ?\n\n? ?? ??\n? ?? ?\n? ?? ?? ?\n\n? ?? ? ? ?\n\n? ?\n? ? ? ?\n\n? ??\n\n3 3\n\n3\n\n12 24 24\n4\n\n3\n           \n\n2\n\ne e\n\ne\n\nK D C D\nu\n\nV\n\n+\n\n?? ?? ?? ?\n? ??? ?\n? ?? ? ?? ??\n\n?? ?\n\n (A.35) \n\n \n\nN\u00f3 3: \n\n \n\n( ) ( )( ) ( )( )[ ]22221111 341323133. eeeeeeee\nNE\n\nm\n\neee CCuKCCuKCuK mmm\n????????\n\n+??+????=?? ?  (A.36) \n\nManipulando apenas o lado direito da Eq. (A.36): \n\n \n\n( ) ( )\n\n( ) ( )\n\n1\n\n1 1\n\n1\n\n2\n\n2 2\n\n2\n\n1 23 2 13 3 12 13 23\n\n1 34 3 14 4 13 13 34\n\n3\n\n       \n3\n\ne\ne e\n\ne\n\ne\ne e\n\ne\n\nK\nu D u D u D C C\n\nV\n\nK\nu D u D u D C C\n\nV\n\n?\n= ? + + ? ? +?\n\n?\n\n?\n+ + ? + ?\n\n?\n\n? ?? ? ?\n\n? ?? ? ?\n (A.37) \n\n \n\n\n\n 125\n\n( ) ( )\n\n( )\n\n( ) ( )\n\n1 2\n\n1 1 2 2\n\n1 2\n\n1\n\n1 1\n\n1\n\n1 2\n\n1 1 2 2\n\n1 2\n\n2\n\n23 34\n1 13 23 13 34\n\n13\n2 13 23\n\n12 14\n3 13 23 13 34\n\n13\n4\n\n1\n\n3\n\n           \n\n           \n\n           \n\ne e\ne e e e\n\ne e\n\ne\ne e\n\ne\n\ne e\ne e e e\n\ne e\n\ne\n\nK D K D\nu C C C C\n\nV V\n\nK D\nu C C\n\nV\n\nK D K D\nu C C C C\n\nV V\n\nK D\nu\n\n? ? ??\n= ? ? ? + ? + +? ? ?\n\n? ? ??\n\n? ?\n? ? +? ?\n\n? ?\n\n? ?\n? ? + ? + +? ?\n\n? ?\n\n? ?\n? ? ? ?\n\n?\n? ?\n\n? ?\n? ? ? ?\n\n?\n\n( )2 2\n2\n\n13 34\ne e\n\ne\nC C\n\nV\n\n?? ??\n? + ?? ?\n\n?? ??\n\n? ?\n\n (A.38) \n\n \n\n( )\n\n1 1 2 2\n\n1 2\n\n1 2\n\n1 1\n\n1\n\n1\n\n1 2\n\n1 1\n\n1\n\n23 13 13 34 13 13\n1 13 13\n\n13 23 23\n2 23\n\n12 14\n3 13 23\n\n1\n\n3 2 2\n\n           \n2\n\n           \n\ne e e e\ne e\n\ne e\n\ne e\ne\n\ne\n\ne e\ne e\n\ne e\n\nK D C D K D C D\nu C C\n\nV V\n\nK D C D\nu C\n\nV\n\nK D K D\nu C C\n\nV V\n\n? ? ?? ? ? ?? ? ? ??\n= ? ? + + ? + +? ?? ? ? ? ?\n\n? ?? ? ? ?? ? ??\n\n? ?? ?? ?\n? +? ?? ?\n\n? ?? ?? ?\n\n? ? +\n\n? ?? ? ? ?\n? ?\n\n?? ?\n?\n\n? ?\n? ?\n\n( )2 2\n2\n\n2 2\n\n2\n\n2\n\n13 34\n\n13 34 34\n4 34           \n\n2\n\ne e\n\ne e\ne\n\ne\n\nC C\n\nK D C D\nu C\n\nV\n\n? ?\n? + +? ?\n\n? ?\n\n?? ?? ?? ?\n+? ??? ?\n\n? ?? ? ?? ??\n\n? ?\n\n?? ?\n?\n\n (A.39) \n\n \n\n( ) ( )\n\n1 1 2 2\n\n1 2\n\n1 1\n\n1\n\n1 2\n\n1 1 2 2\n\n1 2\n\n23 13 13 34 13 13\n1\n\n13 23 23\n2\n\n12 14\n3 13 23 13 34\n\n3 31\n\n3 2 2\n\n3\n           \n\n2\n\n           \n\ne e e e\n\ne e\n\ne e\n\ne\n\ne e\ne e e e\n\ne e\n\nK D C D K D C D\nu\n\nV V\n\nK D C D\nu\n\nV\n\nK D K D\nu C C C C\n\nV V\n\n? ? ?? ? ? ?? ? ? ??\n= ? + +? ?? ? ? ? ?\n\n? ?? ? ? ?? ? ??\n\n? ?? ?? ?\n+? ?? ?\n\n? ?? ?? ?\n\n? ?\n? ? + ? +?\n\n? ?\n\n? ?? ? ? ?\n\n?? ?\n\n? ?\n? ? ? ?\n\n2 2\n\n2\n\n13 34 34\n4\n\n3\n           \n\n2\n\ne e\n\ne\n\nK D C D\nu\n\nV\n\n+?\n\n?? ?? ?? ?\n? ??? ?\n? ?? ? ?? ??\n\n?? ?\n\n (A.40) \n\n \n\nN\u00f3 4: \n\n \n\n( ) ( ) ( ) ( ) ( )3 3 3 32 2 2 24 34 14 14 24.m m m\nNE\n\ne e e e e e ee e e e\n\nm\n\nK u C K u C C K u C C? ?? ? = ? ? ? ? + ? ? ?\n? ??\n\n? ? ? ? ?? ? ?\n (A.41) \n\n \n\nManipulando apenas o lado direito da Eq. (A.41): \n\n\n\n 126\n\n \n\n( ) ( )\n\n( ) ( )\n\n1\n\n2 2\n\n1\n\n3\n\n3 3\n\n3\n\n1 34 3 14 4 13 34 14\n\n1 24 2 14 4 12 14 24\n\n3\n\n       \n3\n\ne\ne e\n\ne\n\ne\ne e\n\ne\n\nK\nu D u D u D C C\n\nV\n\nK\nu D u D u D C C\n\nV\n\n?\n= ? + + ? ? +?\n\n?\n\n?\n+ + ? ? ?\n\n?\n\n? ?? ? ?\n\n? ?? ? ?\n (A.42) \n\n \n\n( ) ( )\n\n( )\n\n( )\n\n( )\n\n2 3\n\n3 32 2\n\n32\n\n3\n\n3 3\n\n3\n\n2\n\n2 2\n\n2\n\n2 3\n\n2 2\n\n2\n\n34 24\n1 34 14 14 24\n\n14\n2 14 24\n\n14\n3 34 14\n\n13 12\n4 34 14\n\n1\n\n3\n\n           \n\n           \n\n           \n\ne e\ne ee e\n\nee\n\ne\ne e\n\ne\n\ne\ne e\n\ne\n\ne e\ne e\n\ne\n\nK D K D\nu C C C C\n\nV V\n\nK D\nu C C\n\nV\n\nK D\nu C C\n\nV\n\nK D K D\nu C C\n\nV\n\n? ? ??\n= ? ? ? + ? ? +? ? ?\n\n? ? ??\n\n? ?\n? ? +? ?\n\n? ?\n\n? ?\n? ? +? ?\n\n? ?\n\n? ? +\n\n? ?\n? ? ? ?\n\n?\n? ?\n\n?\n? ?\n\n? ?\n? ?\n\n( )3 3\n3\n\n14 24\ne e\n\ne\nC C\n\nV\n\n?? ??\n? ? ?? ?\n\n?? ??\n\n? ?\n\n (A.43) \n\n \n\n2 3 32\n\n32\n\n32\n\n3 3\n\n3\n\n3\n\n22\n\n2\n\n2\n\n34 14 14 14 14 14\n1 14 14\n\n14 24 24\n2 24\n\n34 3414\n3 34\n\n1\n\n3 2 2\n\n           \n2\n\n           \n2\n\ne e ee\nee\n\nee\n\ne e\ne\n\ne\n\nee\ne\n\ne\n\nK D C D K D C D\nu C C\n\nV V\n\nK D C D\nu C\n\nV\n\nC DK D\nu C\n\nV\n\n? ? ?? ? ? ?? ? ? ??\n= ? ? + + ? + +? ?? ? ? ? ?\n\n? ?? ? ? ?? ? ??\n\n? ?? ?? ?\n? + +? ?? ?\n\n? ?? ?? ?\n\n? ? ?\n? +\n?\n\n? ?? ? ? ?\n? ?\n\n?? ?\n?\n\n? ??\n?\n\n( ) ( )\n2 3\n\n3 32 2\n\n32\n\n13 12\n4 34 14 14 24           \n\ne e\ne ee e\n\nee\n\nK D K D\nu C C C C\n\nV V\n\n? ??\n+? ?? ?\n\n? ??? ?\n\n?? ??\n? ? + ? ? ?? ?\n\n?? ??\n\n? ?\n? ? ? ?\n\n (A.44) \n\n \n\n2 3 32\n\n32\n\n3 3\n\n3\n\n22\n\n2\n\n34 14 14 14 14 14\n1\n\n14 24 24\n2\n\n34 3414\n3\n\n4\n\n3 31\n\n3 2 2\n\n3\n           \n\n2\n\n3\n           \n\n2\n\n           \n\ne e ee\n\nee\n\ne e\n\ne\n\nee\n\ne\n\ne\n\nK D C D K D C D\nu\n\nV V\n\nK D C D\nu\n\nV\n\nC DK D\nu\n\nV\n\nK\nu\n\n? ? ?? ? ? ?? ? ? ??\n= ? + +? ?? ? ? ? ?\n\n? ?? ? ? ?? ? ??\n\n? ?? ?? ?\n+? ?? ?\n\n? ?? ?? ?\n\n? ?? ?? ?\n+? ?? ?\n\n? ?? ?? ?\n\n? ?? ? ? ?\n\n?? ?\n\n? ??\n\n( ) ( )\n2 3\n\n3 32 2\n\n32\n\n13 12\n34 14 14 24\n\ne\ne ee e\n\nee\n\nD K D\nC C C C\n\nV V\n\n?? ??\n? ? + ? ? ?? ?\n\n?? ??\n\n? ?\n? ? ? ?\n\n (A.45) \n\n\n\n 127\n\nEscrevendo as Eq. (A.31), (A.35), (A.40) e (A.45) na forma matricial, fica: \n\n \n\n( ) ( ) ( )\n1 2 1 1 2 23 3 31 1 2\n\n3 31 1 2 2\n\n3 31 2 1 1 2\n\n23 34 13 13 13 13 13 1324 12 12 14 12 12 12 14\n12 13 13 14 12 14\n\n3 33 3\n\n2 2 2 2\n\n1\n\n3\n\ne e e e e ee e ee e e\ne ee e e e\n\ne ee e e e e\n\nK D K D K D C D C D K DK D C D K D C D K D K D\nC C C C C C\n\nV V V V V V V V\n\n? ? ? ?? ? ? ? ? ?? ?\n+ + + + + + +? ? ? ?? ? ? ?\n\n? ? ? ? ? ? ? ?\n\n?\n\n? ?? ?? ? ? ? ? ?? ? ? ? ? ?\n? ? ? ? ? ?\n\n( ) ( )\n\n3 32\n\n32\n\n1 1 13 3 31 1 1\n\n3 31 1\n\n3 3 31 1 1\n\n14 14 12 14 14\n\n23 13 23 2312 12 24 12 12 14 12 12\n12 23 12 24\n\n3 3\n\n2 2\n\n33 3\n\n2 2 2\n\ne ee\n\nee\n\ne e ee e ee e e\ne ee e\n\ne e ee e e\n\nC D K D C D\n\nV\n\nK D K D C DC D K D C D K D K D K D\nC C C C\n\nV V V V V V\n\n? ? ? ?? ?\n+? ? ? ?\n\n? ? ? ?\n\n? ?? ? ? ? ?? ? ? ?\n+ ? + + ? + ? ?? ? ? ?\n\n? ? ? ? ? ?\n\n? ?? ? ?\n\n?? ?? ? ?? ? ? ? ? ?\n? ? ? ?\n\n( ) ( )\n\n3\n\n1 1 2 2 1 1 1 2 22\n\n1 1 2 2\n\n1 2 1 1 2 2\n\n2\n\n2\n\n24 24\n\n23 13 13 34 13 13 13 23 23 13 13 34 3414\n13 23 13 34\n\n34\n\n3\n\n2\n\n3 3 3 3\n\n2 2 2 2\n\n3\n\ne\n\ne e e e e e e e ee\ne e e e\n\ne e e e e e\n\ne\n\ne\n\nC D\n\nK D C D K D C D K D C D K D K D C DK D\nC C C C\n\nV V V V V V\n\nK D\n\nV\n\n? ??\n? ?\n? ?\n\n? ? ? ? ? ? ? ?? ? ? ? ? ? ?\n+ ? ? + ? +? ? ? ? ? ? ? ?\n\n? ? ? ? ? ? ? ?\n\n?\n\n? ?\n\n? ? ? ?? ? ? ? ? ? ? ? ??\n? ? ? ?\n\n?\n\n( ) ( )\n2 23 3 3 3 32 2\n\n3 32 2\n\n3 3 32 2\n\n34 34 1314 14 14 14 14 14 24 24 14 12\n34 14 14 24\n\n33 3\n\n2 2 2 2\n\ne ee e e e ee e\ne ee e\n\ne e ee e\n\nC D K DC D K D C D K D C D K D K D\nC C C C\n\nV V V V V\n\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n\n? ?? ? ? ? ? ? ? +? ? ? ? ?? ?+ ? ? + ? ?? ?? ? ? ? ? ?? ?\n? ? ? ? ? ? ? ?? ?\n\n?? ? ? ? ?? ? ? ? ? ? ?\n? ? ? ?\n\n (A.46) \n\n \n\nManipulando os sinais dos elementos da parte abaixo da diagonal principal e fazendo \nn n\n\nm\n\nn\n\ne e\ne LK\n\nLK e\n\nK D\nW\n\nV\n=\n\n?\n?\n\n, fica:  \n\n \n\n( ) ( ) ( ) ( ) ( ) ( ) ( ) ( ) ( )\n\n( )\n\n3 3 3 3 3 3 31 1 1 2 2 2 1 1 1 1 2 2 2 2\n\n1 1\n\n23 12 13 34 13 14 24 12 14 13 12 12 14 12 12 12 13 13 14 13 13 13 14 14 12 14 14\n\n23 12 12 24\n\n2 3 3 3 3 3 3\n\n31\n\n6\n\ne e e e e e ee e e e e e e e e e e e e e\n\ne e\n\nW C C W C C W C C W C D W C D W C D W C D W C D W C D\n\nW C D W\n\n? ?+ + + + + ? + ? ? + ? ? + ?\n? ?\n\n? ? +\n?\n\n? ? ? ? ? ? ? ? ? ? ? ?? ? ? ? ? ? ? ? ? ? ? ? ?\n\n?? ? ?\n\n( ) ( ) ( ) ( ) ( )\n\n( ) ( ) ( ) ( )\n\n3 3 3 3 3 31 1 1 1 1 1\n\n1 1 2 2 1 1 1 1 1 2 2\n\n12 12 13 12 23 14 12 24 12 23 23 12 24 24\n\n23 13 13 34 13 13 13 23 23 12 13 23 14 13\n\n3 2 3 3\n\n3 3 3 2\n\ne e e e e ee e e e e e\n\ne e e e e e e e e e e\n\nC D W C C W C C W C D W C D\n\nW C D W C D W C D W C C W C C\n\n? ? ? ?? ? + + ? + ? ?\n? ? ? ?\n\n? ? ? ?? ? ? ? ? ? ? ? + ? +\n? ? ? ?\n\n? ? ? ? ? ? ?? ? ? ? ?\n\n? ? ? ? ? ? ?? ? ? ? ? ? ?\n\n( ) ( )\n\n( ) ( ) ( ) ( ) ( ) ( )\n\n2 2 2\n\n3 3 3 3 3 3 32 2 2 2 2 2 2\n\n34 13 34 34\n\n34 14 14 14 14 14 14 24 24 14 34 34 13 34 14 14 14 24\n\n3\n\n3 3 3 3 2\n\ne e e\n\ne e e e e e ee e e e e e e\n\nW C D\n\nW C D W C D W C D W C D W C C W C C\n\n? ?\n? ?\n? ?\n? ?\n? ?\n\n? ? ?? ?\n? ?? ?\n\n? ?? ? ? ? ? ? ? ?? + ? ? ? ? ? ? ? ? + ? ?\n? ? ? ? ? ? ? ?? ?\n\n?? ?\n\n? ? ? ? ? ? ? ?? ? ? ? ? ? ? ? ?\n\n (A.47) \n\n \n\n \n\n \n\n\n\n 128\n\nA seguir, s\u00e3o montadas as matrizes para as arestas no interior do dom\u00ednio. \n\n \n\nAresta 1-2 \n\n \n\n( ) ( )\n\n( ) ( )\n\n3 3 3 31 1 1 1\n\n3 3 31 1 1 1 1\n\n23 12 24 12 13 12 12 14 12 12\n\n23 12 12 24 12 12 13 12 14 12\n\n2 3 31\n\n6 3 3 2\n\ne e e ee e e e\n\ne e ee e e e e\n\nW C W C W C D W C D\n\nW C D W C D W C W C\n\n? ?? ?+ ? + ?? ?? ??\n? ?? ? ? ?? ?? + + + ? +? ?? ?? ?\n\n? ? ? ?? ?\n\n? ? ? ?? ?\n (A.49) \n\n \n\nAresta 1-3 \n\n \n\n( ) ( )\n\n( ) ( )\n\n1 1 2 2 1 1 2 2\n\n1 1 2 2 1 1 2 2\n\n23 13 34 13 12 13 13 14 13 13\n\n23 13 13 34 13 13 12 13 14 13\n\n2 3 31\n\n6 3 3 2\n\ne e e e e e e e\n\ne e e e e e e e\n\nW C W C W C D W C D\n\nW C D W C D W C W C\n\n? ?? ?+ ? + ?? ?? ??\n? ?? ? ? ?? ?? + + + ? +? ?? ?? ?\n\n? ? ? ?? ? ? ? ? ?\n\n? ? ? ?? ? ? ? ? ?\n (A.50) \n\n \n\nAresta 1-4 \n\n \n\n( ) ( )\n\n( ) ( )\n\n3 3 3 32 2 2 2\n\n3 3 3 32 2 2 2\n\n34 14 24 14 13 14 14 12 14 14\n\n34 14 14 14 14 14 13 14 12 14\n\n2 3 31\n\n6 3 3 2\n\ne e e ee e e e\n\ne e e ee e e e\n\nW C W C W C D W C D\n\nW C D W C D W C W C\n\n? ?? ?+ ? + ?? ?? ??\n? ?? ? ? ?? ?? + + + ? +? ?? ?? ?\n\n? ? ? ?? ? ? ? ? ?\n\n? ? ? ?? ? ? ? ? ?\n (A.51) \n\n \n\nMatrizes para arestas no contorno. As arestas s\u00e3o: 2-3, 3-4, 2-4 \n\n \n\nAresta 2-3 \n\n \n\n( )\n\n( )\n\n1 1 1 1\n\n1 1 1 1\n\n13 23 12 23 23\n\n13 23 23 12 23\n\n2 31\n\n6 3 2\n\ne e e e\n\ne e e e\n\nW C W C D\n\nW C D W C\n\n? ?? ? ?? ?? ??\n? ?? ? ? ?? ?? + ? ? ?? ?? ?\n\n? ?? ? ?\n\n? ?? ? ?\n (A.52) \n\n \n\nAresta 3-4 \n\n \n\n( )\n\n( )\n\n2 2 2 2\n\n2 2 2 2\n\n14 34 13 34 34\n\n14 34 34 13 34\n\n2 31\n\n6 3 2\n\ne e e e\n\ne e e e\n\nW C W C D\n\nW C D W C\n\n? ?? ? ?? ?? ??\n? ?? ? ? ?? ?? + ? ? ?? ?? ?\n\n? ?? ? ?\n\n? ?? ? ?\n (A.53) \n\n \n\nAresta 2-4 \n\n \n\n\n\n 129\n\n( ) ( )\n\n( ) ( )\n\n3 3 3 3\n\n3 3 3 3\n\n14 24 12 24 24\n\n14 24 24 12 24\n\n2 31\n\n6 3 2\n\ne e e e\n\ne e e e\n\nW C W C D\n\nW C D W C\n\n? ??\n? ??\n? ?? ?? ?? + ?\n\n? ?? ?\n\n? ?? ? ?\n\n? ?? ? ?\n (A.54) \n\n \n\n\n\n 130\n\nBIBLIOGRAFIA \n \n \nAavatsmark, I.; Barkeve, T.; B\u00f8e, \u00d8.; Mannseth, T. Discretization on Unstructured Grids \n\n for Inhomogeneous, Anisotropic Media. Part I: Derivation of The Methods. SIAM J. \n\n Sci. Comput. v. 19, p. 1700-1716, 1998a. \n\n \n\nAavatsmark, I.; Barkeve, T.; B\u00f8e, \u00d8.; Mannseth, T. Discretization on Unstructured Grids \n\n for Inhomogeneous, Anisotropic Media. Part II: Discussion and Numerical Results. SI\n\n AM J. Sci. Comput. v. 19, p. 1717-1736, 1998b. \n\n \n\nAbou-Kassem, J. H.; Farouq Ali, S. M.; Islam, M. R. Petroleum Reservoir Simulation \u2013 A \n\n basic Approach. Gulf Publishing Company, Houston, Texas, 2006. \n\n \n\nAhmed, T. Reservoir Engineering Handbook. Gulf Publishing Company, Houston, Texas, \n\n 2000. \n\n \n\nAziz, K., In: Notes for Petroleum Reservoir Simulation. Stanford University, Stanford, \n\n 1993. \n\n \n\nBarth, T. J. In: Computational Fluid Dynamics: Aspects of Unstructured Grids and \n\n Finite Volume Solvers for the Euler and Navier-Stokes Equations. NASA Ames \n\n Research Center, Moffet Field, 1994. \n\n \n\nBarth, T. J.; Linton, W. S. An Unstructured Mesh Newton Solver for Compressible \n\n Fluid Flow and Its Parallel Implementation. Technical Report, AIAA-95-0221, p. 1- \n\n 16, 1995. \n\n \n\nBarton, J. J. e Nackman, L. R. Scientific and Engineering C++: An Introduction with \n\n Advanced Techniques and Examples. Addison-Wesley, 7\u00aa ed., 2001. \n\n \n\nBastian, P. Numerical Computation of Multiphase Flows in Porous Media. Habilitationss\n\n chrift, Universit\u00e4t Kiel, Heidelberg, June 1999. \n\n \n\nBear, J. Dynamics of Fluids in Porous Media., Dover, New York, 1972. \n\n\n\n 131\n\n \n\nBinning, P.; Celia, M. A. Pratical Implementation of the Fractional Flow Approach to \n\n Multi-Phase Flow Simulation. Advances in Water Resources, v. 22, p. 461-478, \n\n 1999. \n\n0  \n\nBOAST, http://www.netl.doe.gov/technologies/oil-gas/software/simulat.html \n\n \n\nBuckley, S. E.; Leverett, M. C. Mechanism of fluid displacement in porous media. \n\n Petroleum Technology, p. 107-116, 1942. \n\n \n\nBuyya, R. High Performance Cluster Computing: Architectures and Systems. Prentice \n\nHall, vol 1, 1999. \n\n \n\nByer, T. J. Preconditioned Newton Methods for Simulation of Reservoirs with Surface \n\n Facilities. PhD Thesis, Stanford University, May 2000. \n\nCao, H. Development of techniques for general purpose simulators. Ph.D. Tese de \n\n Doutorado,Stanford University, 2002. \n\n \n\nCarvalho, D. K. E.; Lyra, P. R. M.; Willmersdorf. Towards A Numerical Reservoir \n\n Simulator Using an Unstructured Finite Volume Formulation with the Aid of High \n\n Performance Tools. Segundo Workshop dos Programas de Forma\u00e7\u00e3o de Recursos \n\n Humanos para o Setor de Petr\u00f3leo e G\u00e1s da UFPE, Recife-PE. p.31-35, 2002b. \n\n \n\nCarvalho, D. K. E.; Lyra, P. R. M.; Willmersdorf. A First Step Towards a Petroleum \n\n Reservoir Simulator Using an Edge -Based Unstructured Finite Volume Formulation. \n\n 2o Congresso Brasileiro de P&amp;D em Petr\u00f3leo e G\u00e1s Natural, Rio De  Janeiro, 2003. \n\n \n\nCarvalho, D. K. E.; Lyra, P. R. M.; Willmersdorf, R. B. Two and Three Dimensional \n\n Simulation of Immiscible Two-Phase Flows in Porous Media Using an Edge-Based \n\n Control Volume Formulation. Congresso Ibero-Latino Americano Em M\u00e9todos \n\n Computacionais Em Engenharia (CILAMCE 2005), Guarapari. 2005. \n\n \n\nCarvalho, D. K. E.; Luna, B. G. B.; Willmersdorf, R. B.; Silva, R. S.; Lyra, P. R. M. Some \n\nResults on the Accuracy of na Edge-based Finite Volume Formulation for the Solution \n\n\n\n 132\n\nof Elliptic Problems in Heterogeneous and Anisotropic Porous Media. 19th International \n\nCongress of Mechanical Engineering, 2007. \n\n \n\nCarvalho, D. K. E.; Willmersdorf, R. B.; Silva, R. S.; Luna, B. G. B.; Lyra, P. R. M. A Ver-\n\ntex-Centered Control Volume Procedure for the Solution of Diffusion Type Problems in \n\nHeterogeneous and Anisotropic Porous Media. IV Congresso Nacional de Engenharia \n\nMec\u00e2nica (CONEM), 2006. \n\n \n\nCarvalho, L. M.; Dickstein, F.; Rodrigues, J. R. P.; Santos, R. W. Um Esquema GMRES \n\nPrecondicionado para Simula\u00e7\u00e3o de Reservat\u00f3rios. Tendencias em Matem\u00e1tica Aplica-\n\nda e Computacional, 3, No 2, p. 63-72, 2002. \n\n \n\nChavent, G.; Jaffre, J. In: Mathematical Models and Finite Elements for Reservoir \n\n Simulation: Single Phase, Multiphase and Multicomponent Flows Through Porous \n\n Media. Amsterdam, North-Holland, 1986. \n\n \n\nChen, Z.; Ewing, R; Espedal, M. Multiphase Flow Simulation with Various Boundary \n\n Conditions. Computational Methods in Water Resources Kluwer Academic Publishers, \n\n Netherlands, pp. 925-932, 1994. \n\n \n\nChen, Z.; Ewing, R. Comparison Of Various Formulations Of Three-Phase Flow In Por\n\n ous Media. Journal of Computational Physics, v. 132, p. 362-373, 1997. \n\n \n\nChen, Z.; Huan, G.; LI, B.; LI, W.; Espin, D. Comparison Of Practical Approaches To Re-\n\nservoir Simulation. 2nd Meeting on Reservoir Simulation, Buenos Aires, Argentina, \n\n2002 (em CD-ROM). \n\n \n\nChen, Z.; Huan, G. Numerical Experiments with Various Formulations for Two Phase \n\n Flow in Petroleum Reservoir. Transport in Porous Media, v. 51, p. 89-102, 2003. \n\n \n\nChen, Z.; Huan, G.; LI, B. An Improved IMPES Method For Two-Phase Flow in Porous \n\nMedia. Transport in Porous Media, v. 54, p. 361-376, 2004. \n\n \n\n\n\n 133\n\nCraft, B. C., Howkins, M., Applied Petroleum Reservoir Enginnering, Prentice Hall, \n\n Upper Saddle River, NJ, 2\u00aa ed., 1991. \n\n \n\nCrank, J., In: The Mathematics of Diffusion. New York, Oxford University Press, 1973. \n\n \n\nCrumpton, P. I. Discretization Multigrid Solution of Elliptic Equations with Mixed Deriva\n\n tives Terms and Strongly Discontonous Coefficients. Journal of Computational Physics, \n\n v. 116, p. 343-358, 1995. \n\n \n\nCrumpton, P. I.; Moinier, P.; Giles, M. B. T. J. An Unstructured Algorithm for High \n\n Reynolds Number Flows on Highly Stretched Grids. In: C. Taylor and J. T. Cross, \n\n 179 (eds.), Numerical Methods In Laminar and Turbulent Flow, Pineridge Press, p. \n\n 561-572, 1997. \n\n \n\nCuller, D. and Singh, J. P. Parallel Computer Architecture A Hardware / Software \n\n Approach. Morgan Kaufmann Publishers, 1997. \n\n \n\nDevloo, P. R. B. and Longhin, G. C. Object Oriented Design Philosophy for Scientific \n\n Computing. Mathematical Modelling and Numerical Analysis, Vol. 36, No 5, pp. \n\n 793\u2013807, 2002. \n\n \n\nDouglas JR. J. Finite Difference Methods for Two-Phase Incompressible Flow in \n\n Porous Media. Journal of Numerical Analysis (SIAM), v. 20, p. 681-697, 1983. \n\n \n\nDurlofsky, L. J. A Triangle Based Mixed Finite Element-Finite Volume Technique for \n\n Modeling Two Phase Flow Through Porous Media. Journal of Computational \n\n Physics, v. 105, p. 252-266, 1993. \n\n \n\nEclipse Reservoir Engineering Software, http://www.slb.com/content/services/software/ \n\n reseng/index.asp. \n\n \n\nEdwards, M. G. Cross Flow Tensors And Finite Volume Approximations with Deferred \n\n Correction. Computer Methods in Applied Mechanics and Engineering, v. 151, p. \n\n 143-161, 1998. \n\n\n\n 134\n\n \n\nEdwards, M. G.; Rogers C. F. Finite Volume Discretization with Imposed Flux Continui ty \n\nfor the General Tensor Pressure Equation. Computational Geosciences 2, v. 2, p. 259-\n\n290, 1998. \n\n \n\nEdwards, M. G. M-Matrix Flux Splitting for General Full Tensor Discretization  Operators \n\non Structured and Unstructured Grids. Journal of Computational Physics, v. 160, p. 1-\n\n28, 2000. \n\n \n\nEl-Rewini, H. and Abd-El-Barr, M., Advanced Computer Architecture And Parallel \n\n Processing, Wiley-Interscience, 2005. \n\n \n\nSilva, E. O.; Silva, R. S.; Luna, B. G. B.; Carvalho, D. K. E.; Lyra, P. R. M. Adapta\u00e7\u00e3oTi-\n\npo-h Aplicada \u00e0 Simula\u00e7\u00e3o de Reservat\u00f3rios de Petr\u00f3leo usando Programa\u00e7\u00e3o Orien-\n\ntada a Objetos em C++. Congresso \u00cdbero-Latino Americano de M\u00e9todos Computacio-\n\nnais em Engenharia (CILAMCE), 2008. \n\n \n\nErtekin, T.; Abou-Kassem, J. H.; King, G. R. In: Basic Applied Reservoir Simulation. \n\n Richardson, TX, Society of Petroleum Engineers (SPE), 2001. \n\n \n\nEymard, R. In: R.Herbin and D. Kr\u00f6ner, (eds.). Finite Volume for Complex Applications \n\n III: Problems and Perspectives. Two-Phase Flow in Porous Media and Finite Volume \n\n Schemes. Hermes Penton Science, p. 65-79, 2002. \n\n \n\nEwing, R. E. In: Ewing, R. E. (editor), The Mathematics of Reservoir Simulation. \n\n Philadelphia, SIAM, 1983. \n\n \n\nFanchi, J. R. In: Principles of Applied Reservoir Simulation. Boston, Gulf Professional \n\n Publishing, 2001. \n\n \n\nFortuna, A. O. In: T\u00e9cnicas Computacionais para Din\u00e2mica dos Fluidos: Conceitos \n\n B\u00e1sicos e Aplica\u00e7\u00f5es. S\u00e3o Paulo, EDUSP, 2000. \n\nFlynn, M. J. and Rudd, K. W. Parallel Architectures. ACM Computer Surveys,  1996. \n\n \n\n\n\n 135\n\nFlynn, M. Some computer organizations and their effectiveness. IEEE Transactions on \n\n Computers, vol. C-21, no. 9, Sep. 1972, pp. 948-960. \n\n \n\nFujimoto, R. M., Parallel and distributed simulation systems. Wiley-Interscience \n\n Publicati on, 2000. \n\n \n\nFuhrmann, S. Advanced Concepts in C++: Garbage Collection Techniques in C++ \n\n Smart Pointers for automated memory management. Darmstadt University of  Technol\n\n ogy, Germany, 2005  \n\n \n\nGarcia, E. L. M. Formula\u00e7\u00f5es Bi e Tri Dimensionais do M\u00e9todo dos Elementos Finitos \n\n para a Simula\u00e7\u00e3o Paralela de Escoamentos em Reservat\u00f3rios de Petr\u00f3leo. Tese de \n\n 180 Doutorado em Engenharia Civil - Universidade Federal do Rio de Janeiro \n\n (UFRJ), Rio de Janeiro-RJ, 1997. \n\n \n\nGeiger, S.; Matthai, K.; Roberts S.; Zoppou, C. Combining Finite Volume and Finite \n\n Element Methods to Simulate Fluid Flow in Geologic Media. Australian &amp; New \n\n Zealand Industrial and Applied Mathmatics Journal, v. 44, p. c180-c201, 2003. \n\n \n\nGeiger, S.; Roberts S.; Matthai, K.; Zoppou, C.; Burri, A. Combining Finite Element and \n\n Finite Volume for Efficient Multiphase Flow Simulations in Highly Heterogeneous and \n\n Structuraly Complex Geologic Media. Geofluids, v. 4, p. 284- 299, 2004. \n\n \n\nGresho, P. M.; Sani, R. L. In: Incompressible Flow and the Finite Element Method: Vo\n\n lume One, Advection-Diffusion. New York, Wiley &amp; Sons, 2000. \n\n \n\nGuimar\u00e3es, C. S. C.; Lima, R. C. F.; Lyra, P. R. M.; Carvalho, D. K. E. Aplica\u00e7\u00e3o de Uma \n\n Ferramenta Computacional Utilizando o M\u00e9todo dos Volumes Finitos em Malhas N\u00e3o-\n\n Estruturadas na Simula\u00e7\u00e3o do Tratamento por Hipertermia em Tumures de Duodeno. \n\n 55\u00aa Reuni\u00e3o Anual da Sociedade Brasileira para o Progresso  da Ci\u00eancia (SBPC, \n\n 2003), Recife, 2003. \n\n \n\nHarten, A. High Resolution Schemes for Conservation Laws. Journal of Computational \n\n Physics v. 49, p. 357-393, 1983. \n\n\n\n 136\n\n \n\nHeimsund, B. O., Mathematical and Numerical Methods for Reservoir Fluid Flow \n\n Simulation, Doctor Scientiarum thesis, Department of Mathematics, University of \n\n Bergen, 2005. \n\n \n\nHelmig, R. In: Multiphase Flow and Transport Processes in the Subsurface (A Contributi\n\n on to the Modeling of Hydrosystems). Springer, Berlin, Germany, 1997. \n\n \n\nHelmig, R.; Huber R. Comparison of Galerkin-Type Discretization Techniques for \n\n Two-Phase Flow Problems in Heterogeneous Porous Media. Advances in Water \n\n Resources, v. 21, p. 697-711, 1998.  \n\n \n\nHirsch, C. In: Numerical Computation of Internal and External Flows: Volume I, \n\n Fundamentals of Numerical Discretization. New York, Wiley &amp; Sons, 1988. \n\nHirsch, C. In: Numerical Computation of Internal and External Flows: Volume II, \n\n Computational Methods for Inviscid and Viscous Flows. New York, Wiley &amp; Sons, \n\n 1990. \n\n \n\nHugues, T. In: The Finite Element Method: Linear Static and Dynamic Element  Analysis. \n\n Dover, Mineola, New York, 2000. \n\n \n\nHughes, C.; Hughes, T. Parallel and Distributed Programming Using C++. Publisher: \n\n Addison Wesley, 2003 \n\n \n\nHubbard, J. R. Schaum\u2019s outline of theory and problems of programming with C++. \n\n Schaum\u2019s outline series, 1996 \n\n \n\nHurtado, F. S. V.; Maliska, C. R.; Silva, A. F. C.; Cordazzo, J.; Ambrus, J.; Contessi, B. A. \n\n An Element-Based Finite Volume Formulation for Simulating Two-Phase Immiscible \n\n Displacements in Core Samples. Proceedings of the 10th Brazilian Congress of Thermal \n\n Sciences and Engineering (ENCIT 2004), Rio de Janeiro, 2004. \n\n \n\n\n\n 137\n\nHyman, J.; Shashkov, M.; Steinberg, S. The Numerical Solution of Diffusion Problems in \n\n Heterogeneous Non-Isotropic Materials. Journal of Computational Physics, v. 132, p. \n\n 130-148, 1997. \n\n \n\nIMEX, http://www.cmgroup.com/software/imex.htm \n\n \n\nJameson, A.; Schmidt, W.; Turkel, E. Numerical Simulation of Euler Equations by \n\n Finite Volume Methods Unising Runge-Kutta Time Stepping Schemes. Techinical \n\n Report, 81-1259, AIAA, Paper, 1981. \n\n \n\nJenny, P.; Lee, S. H.; Tchelepi, H. A. Adaptive fully implicit multi-scale finite-volume me-\n\nthod for multi-phase flow and transport in heterogeneous porous media. Journal of \n\nComputational Physics, 217, p. 627-641, 2006. \n\n \n\nJostle- \u2013 graph partitioning software http://staffweb.cms.gre.ac.uk/~c.walshaw/jostle/ \n\n \n\nJosuttis, N. M. The C++ Standart Library: A Tutorial and Reference. Addison Wesley, \n\n 11\u00aaed., 2003. \n\n \n\nKelley, C. T. Iterative Methods for Linear and Nonlinear Equations. Society for  Industrial \n\n and applied mathematics (SIAM), 1995 \n\n \n\nKovarik, K. In: Numerical Models in Grounwater Pollution. New York, Springer, 2000. \n\n Klausen R. A.; Eigestad, G. T. Multi-Point Flux Approximations and Finite Element \n\n Methods: Practical Aspects of Discontinuous Media. 9th European Conference on \n\n the Mathematics of Oil Recovery. Cannes, France, 2004. \n\n \n\nLeveque, R. J. In: Numerical Methods for Conservation Laws. Berlin, Birkhauser, 1992. \n\n \n\nLeveque, R. J. In: Finite Volume Methods for Hyperbolic Problems. Cambridge,  Cabridge \n\n University Press, 2002. \n\n \n\n\n\n 138\n\nLewis R. W., Malan, A. G. Continuum Thermodynamic Modeling of Drying Capillary \n\n Particulate Materials via an Edge-Based Algorithm. Computer Methods in Applied \n\n Mechanics v. 194, p. 2043-2057, 2005. \n\n \n\nLi, R.; Chen, Z.; Wu, W. In: Generalized Finite Differences Methods for Differential \n\n Equations: Numerical Analysis of Finite Volume Methods. New York, Marcel \n\n Dekker, 2000. \n\n \n\nLi, B.; Chen, Z.; Huan, G. Control Volume Function Approximation Methods and Their \n\n Applications to Modeling Porous Media Flow. Advances in Water Resources, v. 26, p. \n\n 435-444, 2003a. \n\n \n\nLi, B.; Chen, Z.; Huan, G. The Sequential Method for Black Oil Reservoir Simulation on \n\n Unstructured Grids. Journal of Computational Physics, v. 192, p. 36-72, 2003b. \n\n \n\nL\u00f6hner, R. Edges, stars, superedges and chains. Computer Methods in Applied Mechaics \n\n and Engineering, v. 111, p. 255-263, 1994. \n\n \n\nL\u00f6hner, R. In: Applied CFD Techniques: An Introduction Based on Finite Element \n\n Methods. New York, Wiley &amp; Sons, 2001. \n\n \n\nLoula, A. F. D.; Garcia, E. L. M.; Coutinho, A. L. G. A. Miscible Displacement Simultion \n\nby Finite Element Methods in Distributed Memory Machines. Computer Methods in \n\nApplied Mechanics and Engineering, v. 174, p. 339-354, 1999. \n\n \n\nLyra, P. R. M. Unstructured Grid Adaptive Algorithms for Fluid Dynamics and Heat \n\n Conduction. 332 f. Tese de Doutorado em Engenharia Civil, University of Wales, \n\n Swansea, 1994. \n\n \n\nLyra, P. R. M.; Morgan K. A Review and Comparative Study of Upwind Biased Schemes-\n\nfor Compressible Flow Computation. Part III: Multidimensional Extension on Unstruc-\n\ntured Grids. Arch. Comput. Meth. Engng, v. 9, p. 207-256, 2002. \n\n \n\n\n\n 139\n\nLyra, P. R. M.;, Lima, R. C. F. de, Guimar\u00e3es, C. S. C., Carvalho, D. K. E. An Edge-\n\n Based Unstructured Finite Volume Procedure for the Numerical Analysis of Heat \n\n Conduction Applications. Journal of the Brazilian Society of Mechanical Engineering. \n\n Brazil, v., 26, p. 160-169, 2004a. \n\n \n\nLyra, P. R. M.; Lima, R. C. F.; ; Carvalho, D. K. E.; Silva, G. M. L. L. An Axisymmetric \n\n Finite Volume Formulation for the Solution of Heat Conduction Problems Using \n\n Unstructured Meshes. Journal of the Brazilian Society of Mechanical Science,.v. 27, \n\n p.1-18, 2005. \n\n \n\nLuo, H.; Baum, J. D.; L\u00f6hner, R. An Improved Finite Volume Scheme for Compressible \n\n Flows on Unstructured Grids. Technical Report AIAA-95-0348, p. 1-9, 1995. \n\n \n\nMcCain, W. D. Jr. The Properties of Petroleum Fluids. PennWell Books, Tulsa,  Oklohma, \n\n 2\u00aa ed., 1989. \n\n \n\nMalan, A. G. Investigation into the Continuum Thermodynamic Modeling of Investment \n\n Casting Shell-Mould Drying. Tese de Doutorado em Engenharia Civil, University of \n\n Wales, Swansea, 2002. \n\n \n\nMaliska, C. R. In: Transfer\u00eancia de Calor e Mec\u00e2nica dos Fluidos Computacional. Rio de \n\n Janeiro, Livros T\u00e9cnicos e Cient\u00edficos (LTC), 2004. \n\n \n\nMalta, S. C.; Loula, A. F. D.; Garcia, E. L. M. A Post-Processing Technique to Approxi-\n\n mate the Velocity Field in Miscible Displacement Simulations. Laborat\u00f3rio Nacional de \n\n Computa\u00e7\u00e3o Cient\u00edfica, (LNCC) Relat\u00f3rios de Pesquisa e Desenvolvimento, No. 24/93, \n\n 1993. \n\n \n\nMartins, M. A. D. Solu\u00e7\u00e3o Iterativa em Paralelo de Sistemas de Equa\u00e7\u00f5es do M\u00e9todo \n\n dos Elementos Finitos Empregando Estruturas de Dados por Arestas. Disserta\u00e7\u00e3o de \n\n Mestrado em Engenharia Civil, Universidade Federal do Rio de Janeiro, (UFRJ), Rio \n\n de Janeiro - RJ, 1996. \n\n \n\n\n\n 140\n\nMattax, C. C.; Dalton, R. L. In: Reservoir Simulation. Richardson, TX, Society of \n\n Petroleum Engineers (SPE), 1990. \n\n \n\nMorton, K. W., In: Numerical Solution of Convection-Diffusion Problems. London, \n\n Chapman &amp; Hall, 1996. \n\n \n\nPacheco, P. S., Parallel programming with MPI. Morgan Kaufmann Publishers Inc, \n\n 1997. \n\n \n\nParMetis, Parallel Graph Partitioning and Fill-reducing Matrix Ordering, \n\n http://glaros.dtc.umn.edu/gkhome/metis/parmetis/overview. \n\n \n\nPatankar, S. V., In: Numerical Heat Transfer and Fluid Flow. New York, Hemisphere \n\n Publishing Corporation, 1980. \n\n \n\nPeaceman, D. W., In: Fundamentals of Numerical Reservoir Simulation. New York, \n\n Elsevier, 1977. \n\n \n\nPeraire J., Peiro, J., Morgan, K Finite Element Multigrid Solution of Euler Flows \n\n Past Installed Aero-Engines. Journal of Computational Mechanics, v. 11, p. 433\u2013\n\n 451, 1993. \n\n \n\nPetsc \u2013 Portable, Extensible Toolkit for Scientific Computation, http://www.unix.mcs.\n\n anl.gov/petsc/petsc-as/. \n\n \n\nPfister, G. F., In Search of Clusters, 2nd Edition, Prentice Hall, 1998. \n\n \n\nRosa, A. J.; Carvalho, R. de S.; Xavier, J. A. Engenharia de Reservat\u00f3rios de Petr\u00f3leo. Ed. \n\nInterci\u00eancias, Rio de Janeiro, 2006. \n\n \n\nRosa, A. J.; Carvalho, R. de S. Previs\u00e3o de Comportamento de Reservat\u00f3rios de  Petr\u00f3leo. \n\n Ed. Interci\u00eancias, Rio de Janeiro, 2002. \n\n \n\n\n\n 141\n\nReed, D. A. Workshop on The Roadmap for the Revitalization of High-End Computing. \n\n 2003. \n\n \n\nRees, I. Development of an Edge-Based Finite Volume Solver for Porous Media \n\nApplcaions. Tese de Doutorado em Engenharia Civil, University of Wales, Swansea, 2004. \n\n \n\nRees, I.; Masters, I.; Malan, A. G.; Lewis, R. W. An Edge-Based Finite Volume Scheme \n\n for Saturated-Unsaturated Groundwater Flow. Computer Methods in Applied Mechani-\n\n cs and Engineering, v. 193, p. 4741-4759, 2004. \n\n \n\nReichenberger, V., Jakobs, H.; Bastian, P.; Helmig, R. A mixed-dimensional finite volume \n\nmethod for two-phase flow in fractured porous media. Advances in Water Resources 29 \n\np.1020-1036, 2006. \n\n \n\nReis, G. Data Abstraction And Polymorphism in C++. Centre de Math\u00e9matiques et de \n\n Leurs Applications, ACCU Spring Conference, France, 2002. \n\n \n\nRoe P. L. Approximate Rieman Solvers, Parameters Vectors and Difference Schemes. \n\n Journal of Computational Physics, v. 43, p. 357-372, 1981. \n\n \n\nScotch \u2013 Software package and libraries for graph, mesh and hypergraph partitioning, \n\n static mapping, and parallel and sequential sparse matrix block ordering. \n\n http://www.labri.fr/perso/pelegrin/scotch/ \n\n \n\nSouza, D. A. F.; Coutinho, A. L. G. A.; Alves, J. L. D. Three Dimensional Finite Element \n\n Solutions of Immiscible Two-Phase Flow Through Porous Media. Congresso \u00cdbero-\n\n Latino Americano de M\u00e9todos Computacionais em Engenharia (CILAMCE 2004), (Em \n\n CD-ROM), 2004. \n\n \n\nSterling, T. Beowulf Cluster Computing with Linux. The MIT Press Cambridge,  Masschu\n\n setts, 2002. \n\n \n\n\n\n 142\n\nStrohmaier, E., Dongarra, J., Meuer, H., Simon, H. Recent Trends in the Marketplace of \n\n High Performance Computing. CTWatch Quarterly, Volume 1, Number 1, February \n\n 2005. \n\n \n\nStroustrup, B. The C+ + Programming Language. Third Edition, AT&amp;T Labs MurrayHill, \n\n New Jersey, 1997. \n\n \n\nStroustrup, B. Why C++ is not just an Object-Oriented Programming Language. AT&amp;T \n\n Bell Laboratories, Murray Hill, New Jersey 07974. \n\n \n\nStroustrup, B. Learning Standard C++ as a New Language. The C++ Users Journal, 1999. \n\n \n\nStroustrup, B. Abstraction and the C++ Machine Model. Texas A&amp;M University, \n\n ICESS\u201904, 2005. \n\n \n\nSv\u00e4rd M., Nordstr\u00f6m, J. A Stable and Accurate Summation by Parts Finite Volume Formu\n\n lation of the Laplacian Operator. Uppsala Universitet, Institutionen f\u00f6r Informations \n\n teknologi, Technical Report 003, 2003. \n\n \n\nTai, C. H.; Zhao, Y.; Liew, K. M. Parallel Computation of Unsteady Three-Dimensional \n\nIncompressible Viscous Flow using an Unstructured Multigrid Method. Computers and \n\nStructures, 82, p. 2425-2436, 2004. \n\n \n\nTannehill, J. C.; Anderson, D. A.; Pletcher, H. R., In: Computational Fluid Mechanics \n\n and Heat Transfer. Philadelphia, Taylor &amp; Francis, 1997. \n\n \n\nThiele, M. R.; Batycky, R. P.; Iding, M.; Blunt, M. Extension of Streamline-Based Dual \n\n Porosity Flow Simulation to Realistic Geology. 9th European Congress on the \n\n Mathematics of Oil Recovery, 2004. \n\n \n\nWang, H. F.; Anderson, M. P. In: Introduction to Groundwater Modeling: Finite Differ\n\n ences and Finite Elements Methods. New York, Academic Press, 1983. \n\n \n\n\n\n 143\n\nWheeler, M. F.; Russel, T. F. In: Ewing, R. E. (editor), The Mathematics of Reservoir \n\n Simulation. Philadelphia, SIAM, 1983. \n\n \n\nWillmersdorf, R. B.; Lyra, P. R. M.; Carvalho, D. K. E. Unstructured Control Volume \n\n Formulation for Solving Biphasic Flows in Porous Media. 13th Finite Elements in \n\n Flow Problems 2005 (FEF2005), 2005, Swansea, Reino Unido. 2005. \n\n \n\nWoll, C.; Correia, A. C.; Carvalho, D. K. E.; Willmersdorf, R. B.; Lyra, P. R. M. An \n\n Object-Oriented Implementation of the Finite Volume Method with an Edge-Based \n\n Data Structure for a Parallel Computing Environment. Congresso Ibero-Latino \n\n Americano em M\u00e9todos Computacionais em Engenharia (CILAMCE 2004),Recife. \n\n 2004. \n\n \n\nVargas, R. S. Matrix Iterative Analysis. Prentice-Hall, Englewood Cliffs, 1962. \n\n \n\nVerma, S. K.; Aziz, K. Three Dimensional Flexible Grids for Reservoir Simulation. Fifth \n\n European Conference on the Mathematics of Oil Recovery, Leoben, Austria, p. 1-13, \n\n 1996. \n\n \n\nVerma, S. K. Flexible Grids for Reservoir Simulation, Stanford University, Stanford, \n\n USA, 1996. \n\n \n\nYeo, C. S.; Buyya, R.; Pourreza H.; Eskicioglu, R.; Graham, P.; and Sommers, F. Cluster \n\n Computing: High-Performance, High-Availability, and High-Throughput Processing on \n\n a Network of Computers, Handbook of Nature-Inspired and Innovative Computting. \n\n pp.521-551 (Chapter 16), Springer Science+Business Media Inc., New York, USA, \n\n 2006. \n\n \n\nZhang, K.; Wu, Y. S.; Ding, C.; Pruess, K.; Elmroth, E. Parallel Computing Techniques \n\nfor Large-Scale Reservoir Simulation of Multicomponent and Multiphase Fluid Flow. \n\nSPE 66343, 2001. \n\n \n\nZoltan \u2013 Parallel Partitioning, Load Balancing and Data-Management Services \n\n http://www.cs.sandia.gov/Zoltan/ \n\n\n\n 144\n\nZienkiewicz, O. C.; Morgan K. In: Finite Elements and Approximations. New York, \n\n Wiley &amp; Sons, 1983."}]}}}