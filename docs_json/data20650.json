{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.24697"}, {"@name": "filename", "#text": "9143_Dissertacao_Flavio_Augusto_Martins_Strutzel.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE DE S\u00c3O PAULO \nESCOLA POLIT\u00c9CNICA \n\nDEPARTAMENTO DE ENGENHARIA QU\u00cdMICA \n\nFLAVIO AUGUSTO MARTINS STRUTZEL \n\nCONTROLE IHMPC DE UM PROCESSO INDUSTRIAL \nDE HIDROTRATAMENTO DE DIESEL \n\nS\u00e3o Paulo \n2014 \n\n \n \n\n\n\n \n \n\n2 \n \n\nUNIVERSIDADE DE S\u00c3O PAULO \nESCOLA POLIT\u00c9CNICA \n\nDEPARTAMENTO DE ENGENHARIA QU\u00cdMICA \n\nFLAVIO AUGUSTO MARTINS STRUTZEL \n\nCONTROLE IHMPC DE UM PROCESSO INDUSTRIAL \nDE HIDROTRATAMENTO DE DIESEL \n\n \n \n \n \n \n\nDisserta\u00e7\u00e3o apresentada \u00e0 Escola \nPolit\u00e9cnica da Universidade de S\u00e3o \nPaulo para obten\u00e7\u00e3o do t\u00edtulo de Mestre \nem Ci\u00eancias, Programa de Engenharia \nQu\u00edmica. \n\n \n\nS\u00e3o Paulo \n2014 \n\n\n\n \n \n\n3 \n \n\n \n \n\nFLAVIO AUGUSTO MARTINS STRUTZEL \n\nCONTROLE IHMPC PARA UMA PLANTA \nDE HIDROTRATAMENTO DE DIESEL \n\n \n\nDisserta\u00e7\u00e3o apresentada \u00e0 Escola \nPolit\u00e9cnica da Universidade de S\u00e3o \nPaulo para obten\u00e7\u00e3o do t\u00edtulo de Mestre \nem Ci\u00eancias, Programa de Engenharia \nQu\u00edmica. \n \n \n\u00c1rea de concentra\u00e7\u00e3o:  \nEngenharia Qu\u00edmica \n \nOrientador:  \nProf. Dr. Darci Odloak \n\nS\u00e3o Paulo \n2014 \n\n\n\n \n \n\n4 \n \n\nEste exemplar foi revisado e corrigido em rela\u00e7\u00e3o \u00e0 vers\u00e3o original, sob \nresponsabilidade \u00fanica do autor e com a anu\u00eancia de seu orientador. \n \nS\u00e3o Paulo,      de fevereiro de 2014. \n \n \nAssinatura do autor   ____________________________ \n \n \nAssinatura do orientador   _______________________ \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n\n  \n\n \n \n \n\n FICHA CATALOGR\u00c1FICA \n\n  \n\n \n \n \n \n \n \n \n \n \n\n  \n\n \n \nStrutzel, Flavio Augusto Martins \n\nControle IHMPC de um processo industrial de hidrotratamen- \nto de diesel / F.A.M. Strutzel. \u2013 vers\u00e3o corr. -- S\u00e3o Paulo, 2014. \n\n106 p. \n \n\nDisserta\u00e7\u00e3o (Mestrado) - Escola Polit\u00e9cnica da Universidade  \nde S\u00e3o Paulo. Departamento de Engenharia Qu\u00edmica. \n \n\n1.Controle preditivo 2.Controle de processos 3.Tempo-real \n(Otimiza\u00e7\u00e3o) 4.Hidrorefino de petr\u00f3leo I.Universidade de S\u00e3o \nPaulo. Escola Polit\u00e9cnica. Departamento de Engenharia Qu\u00edmica \nII.t. \n\n \n\n\n\n \n \n\n5 \n \n\nAgradecimentos \n \n\n \n\nAo Prof. Darci Odloak, pela orienta\u00e7\u00e3o e por todo o inestim\u00e1vel apoio \n\ndado durante a condu\u00e7\u00e3o deste trabalho. \n\n \n\n\u00c0 minha amada esposa Pamela, meus pais, irm\u00e3os e demais familiares, \n\npelo carinho e incentivo dado ao longo desse per\u00edodo. \n\n \n\n\u00c0 Petrobras, por incentivar e viabilizar a educa\u00e7\u00e3o continuada dos seus \n\nprofissionais. \n\n  \n\nAos nobres colegas da Refinaria Presidente Arthur Bernardes da \n\nPetrobras, a RPBC, por todo o apoio, sobretudo ao Engenheiro Oswaldo Luiz \n\nCarrapi\u00e7o e ao meu Coordenador Ant\u00f4nio Maylinch Teruel. \n\n \n\nAo Engenheiro Ant\u00f4nio Carlos Zanin da Petrobras, pelas preciosas \n\ncontribui\u00e7\u00f5es. \n\n  \n\n  \n\n\n\n \n \n\n6 \n \n\n \n\n\u201cOh, qu\u00e3o insuficiente \u00e9 a palavra e qu\u00e3o ineficaz / ao meu conceito!\u201d \n\nPara\u00edso, Dante Alighieri \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nO Mist\u00e9rio das Cousas \n\n \n\nO mist\u00e9rio das cousas, onde est\u00e1 ele?  \n\nOnde est\u00e1 ele que n\u00e3o aparece  \n\nPelo menos a mostrar-nos que \u00e9 mist\u00e9rio?  \n\nQue sabe o rio disso e que sabe a \u00e1rvore?  \n\nE eu, que n\u00e3o sou mais do que eles, que sei disso?  \n\nSempre que olho para as cousas e penso no que os  \n\nhomens pensam delas,  \n\nRio como um regato que soa fresco numa pedra.  \n\nPorque o \u00fanico sentido oculto das cousas  \n\n\u00c9 elas n\u00e3o terem sentido oculto nenhum,  \n\n\u00c9 mais estranho do que todas as estranhezas  \n\nE do que os sonhos de todos os poetas  \n\nE os pensamentos de todos os fil\u00f3sofos,  \n\nQue as cousas sejam realmente o que parecem ser  \n\nE n\u00e3o haja nada que compreender.  \n\nSim, eis o que os meus sentidos aprenderam sozinhos: \n\nAs cousas n\u00e3o t\u00eam significa\u00e7\u00e3o: t\u00eam exist\u00eancia.  \n\nAs cousas s\u00e3o o \u00fanico sentido oculto das cousas.  \n\n \n\nAlberto Caeiro, \"O Guardador de Rebanhos - Poema XXXIX\" \n\nHeter\u00f4nimo  de Fernando Pessoa  \n\n \n\n \n\n\n\n \n \n\n7 \n \n\n\u00cdNDICE DE FIGURAS \n\n \nFigura 1.1 \u2013 Esquema simplificado de uma UHDT..................................................................26         \n\nFigura 1.2 \u2013 Esquem\u00e1tico da UHDT da PETROBRAS \u2013 RPBC..............................................28 \n\nFigura 4.1 \u2013 Esquema da estrat\u00e9gia de otimiza\u00e7\u00e3o em tr\u00eas camadas........................................55 \n\nFigura 4.2 \u2013 Esquema da estrat\u00e9gia de otimiza\u00e7\u00e3o em duas camadas......................................57 \n\nFigura 4.3 \u2013 Representa\u00e7\u00e3o da pir\u00e2mide do controle de processos..........................................57 \n\nFigura 4.4 \u2013 Intera\u00e7\u00e3o entre os n\u00edveis da pir\u00e2mide do controle de processos...........................58 \n\nFigura 4.5 \u2013 Ilustra\u00e7\u00e3o do Conceito de Funnel.........................................................................63 \n\nFigura 4.6 \u2013 Funnel sem Tempo Morto....................................................................................64 \n\nFigura 4.7 \u2013 Funnel com Tempo Morto....................................................................................66 \n\nFigura 5.1 \u2013 Estudo de Caso 1 \u2013 Vari\u00e1veis Controladas (y1 \u2013 WABT [\u00baC]; y2 \u2013 Enxofre \n\n[ppm]; y3 \u2013 Total de Inst\u00e1veis [m\n3/d])......................................................................................81 \n\nFigura 5.2 \u2013 Estudo de Caso 1 \u2013 Vari\u00e1veis Controladas (y4 \u2013 Excesso de H2 [kNm\n3/d]; \n\ny5 \u2013 Press\u00e3o de H2 para C-02  [kgf/cm\n2])..................................................................................81 \n\nFigura 5.3 \u2013 Estudo de Caso 1 \u2013 Vari\u00e1veis Manipuladas (u1 \u2013 Carga [m\n3/d]; u2 \u2013 Vaz\u00e3o de \n\nInst\u00e1veis [m3/d]; u3 \u2013 T. Sa\u00edda do Forno [\u00baC])..........................................................................82 \n\nFigura 5.4 \u2013 Estudo de Caso 1 \u2013 Vari\u00e1veis Manipuladas (u4 \u2013 T. Entrada R1L2 [\u00baC]; u5 \u2013 T. \n\nEntrada R2L1 [\u00baC]; u6 \u2013 T. Entrada R2L2 [\u00baC]).......................................................................82 \n\nFigura 5.5 \u2013 Estudo de Caso 1 \u2013 Evolu\u00e7\u00e3o do Valor Total da Fun\u00e7\u00e3o Objetivo......................83 \n\nFigura 5.6 \u2013 Estudo de Caso 2 \u2013 Vari\u00e1veis Controladas (y1 \u2013 WABT [\u00baC]; y2 \u2013 Enxofre \n\n[ppm]; y3 \u2013 Total de Inst\u00e1veis [m\n3/d])......................................................................................85 \n\nFigura 5.7 \u2013 Estudo de Caso 2 \u2013 Vari\u00e1veis Controladas (y4 \u2013 Excesso de H2 [kNm\n3/d]; \n\ny5 \u2013 Press\u00e3o de H2 para C-02  [kgf/cm\n2])..................................................................................85 \n\nFigura 5.8 \u2013 Estudo de Caso 2 \u2013 Vari\u00e1veis Manipuladas (u1 \u2013 Carga [m\n3/d]; u2 \u2013 Vaz\u00e3o de \n\nInst\u00e1veis [m3/d]; u3 \u2013 T. Sa\u00edda do Forno [\u00baC])..........................................................................86 \n\nFigura 5.9 \u2013 Estudo de Caso 2 \u2013 Vari\u00e1veis Manipuladas (u4 \u2013 T. Entrada R1L2 [\u00baC]; u5 \u2013 T. \n\nEntrada R2L1 [\u00baC]; u6 \u2013 T. Entrada R2L2 [\u00baC]).......................................................................86 \n\nFigura 5.10 \u2013 Estudo de Caso 2 \u2013 Evolu\u00e7\u00e3o do Valor Total da Fun\u00e7\u00e3o Objetivo....................87 \n\nFigura 5.11 \u2013 Estudo de Caso 3 \u2013 Vari\u00e1veis Controladas (y1 \u2013 WABT [\u00baC]; y2 \u2013 Enxofre \n\n[ppm]; y3 \u2013 Total de Inst\u00e1veis [m\n3/d])......................................................................................88 \n\nFigura 5.12 \u2013 Estudo de Caso 3 \u2013 Vari\u00e1veis Controladas (y4 \u2013 Excesso de H2 [kNm\n3/d]; \n\ny5 \u2013 Press\u00e3o de H2 para C-02  [kgf/cm\n2])..................................................................................89 \n\n\n\n \n \n\n8 \n \n\nFigura 5.13 \u2013 Estudo de Caso 3 \u2013 Vari\u00e1veis Manipuladas (u1 \u2013 Carga [m\n3/d]; u2 \u2013 Vaz\u00e3o de \n\nInst\u00e1veis [m3/d]; u3 \u2013 T. Sa\u00edda do Forno [\u00baC])..........................................................................89 \n\nFigura 5.14 \u2013 Estudo de Caso 3 \u2013 Vari\u00e1veis Manipuladas (u4 \u2013 T. Entrada R1L2 [\u00baC]; u5 \u2013 T. \n\nEntrada R2L1 [\u00baC]; u6 \u2013 T. Entrada R2L2 [\u00baC]).......................................................................90 \n\nFigura 5.15 \u2013 Estudo de Caso 3 \u2013 Evolu\u00e7\u00e3o do Valor Total da Fun\u00e7\u00e3o Objetivo....................90 \n\nFigura 5.16 \u2013 Estudo de Caso 4 \u2013 Vari\u00e1veis Controladas (y1 \u2013 WABT [\u00baC]; y2 \u2013 Enxofre \n\n[ppm]; y3 \u2013 Total de Inst\u00e1veis [m\n3/d])......................................................................................92 \n\nFigura 5.17 \u2013 Estudo de Caso 4 \u2013 Vari\u00e1veis Controladas (y4 \u2013 Excesso de H2 [kNm\n3/d]; \n\ny5 \u2013 Press\u00e3o de H2 para C-02  [kgf/cm\n2]).................................................................................92 \n\nFigura 5.18 \u2013 Estudo de Caso 4 \u2013 Vari\u00e1veis Manipuladas (u1 \u2013 Carga [m\n3/d]; u2 \u2013 Vaz\u00e3o de \n\nInst\u00e1veis [m3/d]; u3 \u2013 T. Sa\u00edda do Forno [\u00baC])..........................................................................93 \n\nFigura 5.19 \u2013 Estudo de Caso 4 \u2013 Vari\u00e1veis Manipuladas (u4 \u2013 T. Entrada R1L2 [\u00baC]; u5 \u2013 T. \n\nEntrada R2L1 [\u00baC]; u6 \u2013 T. Entrada R2L2 [\u00baC]).......................................................................93 \n\nFigura 5.20 \u2013 Estudo de Caso 4 \u2013 Evolu\u00e7\u00e3o do Valor Total da Fun\u00e7\u00e3o Objetivo....................94 \n\nFigura 5.21 \u2013 Estudo de Caso 5 \u2013 Vari\u00e1veis Controladas (y1 \u2013 WABT [\u00baC]; y2 \u2013 Enxofre \n\n[ppm]; y3 \u2013 Total de Inst\u00e1veis [m\n3/d])......................................................................................95 \n\nFigura 5.22 \u2013 Estudo de Caso 5 \u2013 Vari\u00e1veis Controladas (y4 \u2013 Excesso de H2 [kNm\n3/d]; \n\ny5 \u2013 Press\u00e3o de H2 para C-02  [kgf/cm\n2])..................................................................................96 \n\nFigura 5.23 \u2013 Estudo de Caso 5 \u2013 Vari\u00e1veis Manipuladas (u1 \u2013 Carga [m\n3/d]; u2 \u2013 Vaz\u00e3o de \n\nInst\u00e1veis [m3/d]; u3 \u2013 T. Sa\u00edda do Forno [\u00baC])..........................................................................97 \n\nFigura 5.24 \u2013 Estudo de Caso 5 \u2013 Vari\u00e1veis Manipuladas (u4 \u2013 T. Entrada R1L2 [\u00baC]; u5 \u2013 T. \n\nEntrada R2L1 [\u00baC]; u6 \u2013 T. Entrada R2L2 [\u00baC]).......................................................................97 \n\nFigura 5.25 \u2013 Estudo de Caso 5 \u2013 Evolu\u00e7\u00e3o do Valor Total da Fun\u00e7\u00e3o Objetivo....................98 \n\nFigura 5.26 \u2013 Estudo de Caso 6 \u2013 Vari\u00e1veis Controladas (y1 \u2013 WABT [\u00baC]; y2 \u2013 Enxofre \n\n[ppm]; y3 \u2013 Total de Inst\u00e1veis [m\n3/d])......................................................................................99 \n\nFigura 5.27 \u2013 Estudo de Caso 6 \u2013 Vari\u00e1veis Controladas (y4 \u2013 Excesso de H2 [kNm\n3/d]; \n\ny5 \u2013 Press\u00e3o de H2 para C-02  [kgf/cm\n2])................................................................................100 \n\nFigura 5.28 \u2013 Estudo de Caso 6 \u2013 Vari\u00e1veis Manipuladas (u1 \u2013 Carga [m\n3/d]; u2 \u2013 Vaz\u00e3o de \n\nInst\u00e1veis [m3/d]; u3 \u2013 T. Sa\u00edda do Forno [\u00baC])........................................................................100 \n\nFigura 5.29 \u2013 Estudo de Caso 6 \u2013 Vari\u00e1veis Manipuladas (u4 \u2013 T. Entrada R1L2 [\u00baC]; u5 \u2013 T. \n\nEntrada R2L1 [\u00baC]; u6 \u2013 T. Entrada R2L2 [\u00baC]).....................................................................101 \n\nFigura 5.30 \u2013 Estudo de Caso 6 \u2013 Evolu\u00e7\u00e3o do Valor Total da Fun\u00e7\u00e3o Objetivo..................101 \n\n \n\n\n\n \n \n\n9 \n \n\n\u00cdNDICE DE TABELAS \n \n \nTabela 5.1 \u2013 Modelos de Processo em Fun\u00e7\u00e3o de Transfer\u00eancia Cont\u00ednua..............................76 \n\nTabela 5.2 \u2013 Estudo de Caso 4 \u2013 Modelos de Processo em Fun\u00e7\u00e3o de Transfer\u00eancia \n\nCont\u00ednua....................................................................................................................................91 \n\n\n\n \n \n\n10 \n \n\nResumo \n \nNeste trabalho \u00e9 abordado o problema de controle e de otimiza\u00e7\u00e3o de unidades industriais de \nhidrotratamento de diesel (UHDT) por controladores MPC (Model Predictive Control). \u00c9 \napresentado um breve hist\u00f3rico dos controladores MPC convencionais e de horizonte infinito \n(IHMPC), bem como uma breve descri\u00e7\u00e3o do processo de Hidrotratamento de Diesel e das \nparticularidades da aplica\u00e7\u00e3o do controle de processos a este tipo de planta industrial. \n \nEm seguida foi gerado, passo a passo, um algoritmo de controle que sumarizou e agregou \ncaracter\u00edsticas de v\u00e1rios controladores MPC dispon\u00edveis na literatura aberta, em especial os \nque foram desenvolvidos ao longo dos \u00faltimos anos pelo laborat\u00f3rio de simula\u00e7\u00e3o e controle \nda USP (LSCP), a fim de se obter um algoritmo adequado para a solu\u00e7\u00e3o do problema de \ncontrole abordado. Em ambiente computacional de simula\u00e7\u00e3o, o algoritmo resultante \npossibilitou controlar e otimizar simultaneamente processos cont\u00ednuos, sendo capaz de \nestabilizar a planta industrial de forma robusta e, ao mesmo tempo, aumentar a lucratividade \nde sua opera\u00e7\u00e3o. \n \nPara tanto, foi desenvolvida uma \u201cfun\u00e7\u00e3o objetivo\u201d econ\u00f4mica que aumentou a convers\u00e3o da \ncarga bruta em produtos hidrotratados e minimizou o consumo de insumos, sendo que essa \ncorrela\u00e7\u00e3o foi agregada ao algoritmo de controle. As simula\u00e7\u00f5es permitiram que as estrat\u00e9gias \nde controle previamente discutidas pudessem ser testadas e seus resultados apresentados e \ndebatidos. \n \n \n \n \n \nPalavras-chave: Controle Preditivo Baseado em Modelos (MPC), Unidades de \nHidrotratamento de Diesel, Hidrorefino de Petr\u00f3leo. \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n\n\n\n \n \n\n11 \n \n\nAbstract \n \nThis work addresses the control and optimization problem of industrial diesel hydrotreating \nunits (UHDT) by MPC controllers (Model Predictive Control). It is presented a brief \nhistorical of conventional MPC controllers and infinite horizon controllers (IHMPC), as well \nas a brief description of the Diesel Hydrotreating process and the particulars of the application \nof process control for this type of industrial plant. \n \nIt was then generated, step by step, one algorithm that summarized and aggregated control \ncharacteristics of various MPC controllers available in the open literature, in particular those \nthat have been developed over the past few years by USP\u2019s laboratory of simulation and \ncontrol of (LSCP), in order to obtain an algorithm suitable for solving the addressed control \nproblem. In a computational simulation environment, the resulting algorithm allowed to \nsimultaneously control and optimize continuous processes, being able to robustly stabilize the \nindustrial plant and at the same time increase the profitability of its operation. \n \nFor this purpose, an \"objective function\" was developed which increased the economic \nconversion of crude feed to hydrotreated product and minimized the consumption of raw \nmaterials, and this correlation was added to the control algorithm. The simulations allowed \nthat the previously discussed control strategies could be tested and the results presented and \ndiscussed. \n \n \n \nKeywords: Model Predicted Control (MPC), Diesel Hydrotreating Units, Petroleum \nHydrorefining. \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n\n\n\n \n \n\n12 \n \n\n \n \n\nLista de S\u00edmbolos \n\n \n\nS\u00edmbolos Latinos \n\n \n\nA  matriz caracter\u00edstica do modelo incremental em malha aberta \n\n*A  matriz A  modificada que limita predi\u00e7\u00f5es das sa\u00eddas no infinito \n\nA%  matriz caracter\u00edstica do modelo posicional em malha aberta, em fun\u00e7\u00e3o de A, C, p e m \n\n~\n\nAB  matriz auxiliar em fun\u00e7\u00e3o de A , B  e m  \n\nB  matriz de distribui\u00e7\u00e3o das entradas do modelo incremental em malha aberta \n\nB%  matriz de distribui\u00e7\u00e3o das entradas do modelo posicional em malha aberta \n\nC  matriz das sa\u00eddas do sistema, com base no modelo incremental \n\nfC  matriz auxiliar da fun\u00e7\u00e3o objetivo dos problemas de programa\u00e7\u00e3o quadr\u00e1tica \n\nC%  matriz das sa\u00eddas do modelo posicional \n\nC  matriz auxiliar em fun\u00e7\u00e3o de A , C  e np  \n\nC\n==\n\n matriz auxiliar em fun\u00e7\u00e3o de A , B , C , m  e np  \n\nc  gradiente da fun\u00e7\u00e3o objetivo dos problemas de programa\u00e7\u00e3o quadr\u00e1tica \n\n0D  matriz dos ganhos de regime permanente \n\n0\nmD  matriz \n\n0D  estendida ao longo do horizonte de controle \n\ndD  matriz dos res\u00edduos de regime permanente \n\nD%  matriz auxiliar em fun\u00e7\u00e3o de 0D , m  e t?   \n\nd  coeficientes obtidos pela expans\u00e3o em fra\u00e7\u00f5es parciais de ( )zG ji,  \n\ne  erro entre uma dada sa\u00edda y qualquer e seu valor de refer\u00eancia spy  \n\nF  matriz incremental do regime transiente do sistema \n\nuF  matriz auxiliar em fun\u00e7\u00e3o de \ndD , F  e N  \n\nxF  matriz auxiliar em fun\u00e7\u00e3o de F  \n\nG  matriz auxiliar em fun\u00e7\u00e3o de 0D , F  e N  \n\nG  matriz auxiliar em fun\u00e7\u00e3o de 0D , ? , F  e N  \n\n( )zG  matriz das fun\u00e7\u00f5es de transfer\u00eancia entre as sa\u00eddas e as entradas \n\n\n\n \n \n\n13 \n \n\n( )zG ji,  fun\u00e7\u00e3o de transfer\u00eancia entre uma sa\u00edda i  e uma entrada j  \nH  matriz Hessiana da fun\u00e7\u00e3o objetivo dos problemas de programa\u00e7\u00e3o quadr\u00e1tica \n\nI  matriz identidade \n\nnyI  matriz identidade de dimens\u00e3o nyxny \n\nnuI  matriz identidade de dimens\u00e3o nuxnu \n\nmuI  matriz auxiliar u\nsp ao longo de m \n\nI  matriz auxiliar de ysp ao longo de p \n\nI  matriz auxiliar das vari\u00e1veis de folga sk?  ao longo do horizonte de controle \nsp\n\nI  matriz auxiliar de ysp ao longo de p e estendido para os estados \n\nJ  matriz auxiliar em fun\u00e7\u00e3o de nu  e na  \n\nk  instante qualquer de tempo discreto \n\nFK  ganho do observador de estados (Filtro de Kalman) \n\nL  matriz auxiliar em fun\u00e7\u00e3o de ? e F  \n\nM  matriz auxiliar para spy ?  \n\nL  matriz L  estendida ao longo do horizonte de controle   \n\nm  horizonte de controle das vari\u00e1veis manipuladas \n\nN  matriz auxiliar usada na resposta do sistema ao degrau \n\nN\n~\n\n matriz auxiliar quando da considera\u00e7\u00e3o de refer\u00eancias para as entradas \n\n,i jna  n\u00famero de p\u00f3los da fun\u00e7\u00e3o de transfer\u00eancia entre a sa\u00edda iy  e a entrada ju  \n\nnd  n\u00famero de estados  \n\nnp  horizonte de predi\u00e7\u00e3o finito das vari\u00e1veis controladas \n\nnu  n\u00famero de entradas (vari\u00e1veis manipuladas) \n\nny  n\u00famero de sa\u00eddas (vari\u00e1veis controladas) \n\nP  matriz auxiliar do Filtro de Kalman em fun\u00e7\u00e3o de A , C , V  e W  \n\nPotim  peso da fun\u00e7\u00e3o objetivo econ\u00f4mica \n\nQ  matriz de Lyapunov \n\nQ  matriz de pondera\u00e7\u00e3o das vari\u00e1veis controladas \n\nQ%  matriz Q  estendida ao longo de um horizonte definido m ou np  \n\nQu  matriz de pondera\u00e7\u00e3o das entradas manipuladas \n\nR  matriz de supress\u00e3o das vari\u00e1veis manipuladas \n\n\n\n \n \n\n14 \n \n\nR%  matriz R  estendida ao longo do horizonte de controle \n\nr  p\u00f3lo de uma fun\u00e7\u00e3o de transfer\u00eancia \n\n S respostas ao degrau do sistema \n\nkS  matriz dos coeficientes da resposta ao degrau referente ao instante de tempo k  \n\n1S  matriz de pondera\u00e7\u00e3o das vari\u00e1veis de folga \ns\nk?  \n\nSu  matriz de pondera\u00e7\u00e3o das vari\u00e1veis de folga das entradas \n\nt  tempo \n\nT  matriz auxiliar das vari\u00e1veis de folga ik?  ao longo do horizonte de controle \n\nT per\u00edodo de amostragem do controlador preditivo \n\nu  vetor das vari\u00e1veis manipuladas \n\numax vetor de valores m\u00e1ximos para as vari\u00e1veis manipuladas \n\numin vetor de valores m\u00ednimos para as vari\u00e1veis manipuladas \n\nU  espa\u00e7o da regi\u00e3o vi\u00e1vel de solu\u00e7\u00e3o das vari\u00e1veis manipuladas \n\nusp  refer\u00eancias ou \u201ctargets\u201d para as entradas manipuladas \n\nV  matriz de sintonia do filtro de Kalman \n\nkV  fun\u00e7\u00e3o custo do algoritmo de controle num dado instante de tempo k  \n\nx  vetor de estados do modelo, [ ]Tds xxx =  \n[ ]\n\n/ 1k k\nx\n\n?\nvetor de estados no instante k  com informa\u00e7\u00f5es da planta do instante anterior \n\n[ ]\n/k k\n\nx   vetor atualizado dos estados com informa\u00e7\u00f5es da planta do instante atual \n\nsx  vetor de estados integradores gerado pela forma incremental do modelo \n\ndx  vetor de estados est\u00e1veis do modelo \n\ny  vetor das vari\u00e1veis controladas \n\nmax,iy  limite m\u00e1ximo para a sa\u00edda i \n\nmin,iy  limite m\u00ednimo para a sa\u00edda i \n\nspy  vetor de refer\u00eancia (setpoints) das vari\u00e1veis controladas \n\n1\nspy  vetor estendido de setpoints das vari\u00e1veis controladas \n\np\nky  vetor de sa\u00eddas da planta medidas no instante k  \n\nspy ?  vetor de refer\u00eancias para as sa\u00eddas controladas ao longo de p \n\nW  matriz de sintonia do filtro de Kalman \n\n\n\n \n \n\n15 \n \n\nS\u00edmbolos Gregos \n\n \n\n?  operador diferen\u00e7a \n\n?u  vetor de varia\u00e7\u00f5es nas vari\u00e1veis manipuladas \n\n?u,max  vetor de varia\u00e7\u00f5es m\u00e1ximas nas vari\u00e1veis manipuladas \n\n?u,min  vetor de varia\u00e7\u00f5es m\u00ednimas nas vari\u00e1veis manipuladas \n\n?  matriz da parcela din\u00e2mica associada aos estados transientes  \n\n?  matriz auxiliar para a atualiza\u00e7\u00e3o dos estados \n\n?  autovalores de uma matriz quadrada \n\n?  constante de tempo de um sistema de primeira ordem (dom\u00ednio de Laplace) \n\n?  matriz dos tempos mortos do sistema \n\n,i j?  tempo morto entre uma sa\u00edda i  e uma entrada j  \n\ns\nk?  vari\u00e1veis de folga num dado instante de tempo k , relacionadas aos p\u00f3los   \n\n            integradores criados pela forma incremental do modelo \n\n \n\nSiglas \n\n \n\nDCS  Digital Control System \n\nDMC  Dynamic Matrix Control \n\nIHMPC Infinite Horizon Model Predictive Control \n\nMIMO  Multi-Input Multi-Output \n\nMPC  Model Predictive Control \n\nOPOM  Output Prediction Oriented Model \n\nQDMC Quadratic Dynamic Matrix Control \n\nQP  Quadratic Programming \n\nRMPCT  Robust MPC Technology \n\nROSSMPC Reducer Order State Space MPC \n\nSISO  Single-Input Single-Output \n\n \n\nSobrescritos \n\nT opera\u00e7\u00e3o de transposi\u00e7\u00e3o de uma matriz. \n\nSP  \u201csetpoint\u201d \n\n\n\n \n \n\n16 \n \n\nSUM\u00c1RIO \n\n \n1 \u2013 Introdu\u00e7\u00e3o e Objetivos.....................................................................................................18 \n\n1.1 \u2013 Introdu\u00e7\u00e3o aos Controladores MPC............................................................................18 \n\n1.2 \u2013 O Desenvolvimento dos Controladores MPC de Estabilidade garantida.................21 \n\n1.3 \u2013 Novas aplica\u00e7\u00f5es dos controladores MPC...................................................................24 \n\n1.4 \u2013 Introdu\u00e7\u00e3o ao Processo de Hidrotratamento..............................................................25 \n\n1.4.1 \u2013 A Unidade de Hidrotratamento de Diesel da RPBC................................................26 \n\n1.4.2 \u2013 Se\u00e7\u00e3o de Rea\u00e7\u00e3o e Reciclo de H2...............................................................................29 \n\n1.5 \u2013 Introdu\u00e7\u00e3o ao Problema de Controle de Unidades de Hidrotratamento de \n\nDiesel........................................................................................................................................30 \n\n2 \u2013 Modelos de Processo para Controladores MPC.............................................................32 \n\n2.1 \u2013 Apresenta\u00e7\u00e3o de um Modelo em Vari\u00e1veis de Estado para Sistemas \n\nIntegradores.............................................................................................................................32 \n\n2.1.1 \u2013 Sistema \u201cMIMO\u201d de Fun\u00e7\u00f5es de Transfer\u00eancia......................................................32 \n\n2.1.2 \u2013 Modelo de Resposta ao degrau..................................................................................32 \n\n2.2 \u2013 Modelo em Vari\u00e1veis de Estado para Sistemas sem Tempo Morto..........................35 \n\n2.3 \u2013 Modelo em Vari\u00e1veis de Estado para Sistemas com Tempo Morto..........................37 \n\n3 \u2013 Controlador IHMPC.........................................................................................................39 \n\n3.1 \u2013 Controlador IHMPC com vari\u00e1veis de folga...............................................................44 \n\n3.2 \u2013 IHMPC Estendido para Sistemas com Tempo Morto................................................46 \n\n3.3 \u2013 Observador de Estados..................................................................................................53 \n\n4 \u2013 Otimiza\u00e7\u00e3o Integrada ao Controlador Preditivo...........................................................55 \n\n4.1 - MPC convencional em duas Camadas - Camada de Otimiza\u00e7\u00e3o de Estado \n\nEstacion\u00e1rio.............................................................................................................................58 \n\n4.2 \u2013 IHMPC Estendido com Controle por Zonas e Targets para as \n\nEntradas...................................................................................................................................61 \n\n\n\n \n \n\n17 \n \n\n4.3 \u2013 IHMPC Estendido com Funnel.....................................................................................63 \n\n4.4 - Integra\u00e7\u00e3o da Otimiza\u00e7\u00e3o Online ao Controle Preditivo ...........................................67 \n\n4.5 \u2013 IHMPC - Estendido com \u201cFunil\u201d e Otimizador Online com Targets.......................69 \n\n5 \u2013 Estudo de Caso \u2013 Simula\u00e7\u00e3o de uma UHDT..................................................................75 \n\n5.1 - Otimiza\u00e7\u00e3o Online para a UHDT .................................................................................77 \n\n5.2 \u2013 Simula\u00e7\u00f5es e Resultados................................................................................................78 \n\n5.2.1 \u2013 Estudo de Caso 1 ........................................................................................................80 \n\n5.2.2 \u2013 Estudo de Caso 2 ........................................................................................................84 \n\n5.2.3 \u2013 Estudo de Caso 3 ........................................................................................................88 \n\n5.2.4 \u2013 Estudo de Caso 4.........................................................................................................91 \n\n5.2.5 \u2013 Estudo de Caso 5.........................................................................................................95 \n\n5.2.6 \u2013 Estudo de Caso 6 ........................................................................................................98 \n\n6 \u2013 Conclus\u00f5es........................................................................................................................102 \n\n7 \u2013 Refer\u00eancias Bibliogr\u00e1ficas..............................................................................................104 \n\n \n\n  \n\n\n\n \n \n\n18 \n \n\n1 \u2013 Introdu\u00e7\u00e3o e Objetivos \n\nO objetivo deste trabalho \u00e9 apresentar os problemas de controle e de otimiza\u00e7\u00e3o de unidades \n\nindustriais de hidrotratamento de diesel (UHDT) e propor uma solu\u00e7\u00e3o para os mesmos \n\natrav\u00e9s do uso de controladores MPC (Model Predictive Control). A solu\u00e7\u00e3o proposta \n\nabordar\u00e1, simultaneamente, ambos os problemas de controle e otimiza\u00e7\u00e3o num \u00fanico \n\nalgoritmo, cumprindo a fun\u00e7\u00f5es de promover a estabilidade da planta e melhorar sua \n\nrentabilidade. \n\n \n\nNeste primeiro capitulo ser\u00e1 apresentado um breve hist\u00f3rico dos controladores MPC \n\nconvencionais e de horizonte infinito (IHMPC), bem como uma breve descri\u00e7\u00e3o do processo \n\nde Hidrotratamento de Diesel e das particularidades da aplica\u00e7\u00e3o do controle de processos a \n\neste tipo de planta industrial. No segundo capitulo s\u00e3o discutidos diversos modelos de \n\nprocessos em vari\u00e1veis de estado que ser\u00e3o utilizados ao longo do presente trabalho. Em \n\nseguida, no terceiro cap\u00edtulo, \u00e9 feita uma revis\u00e3o sobre os fundamentos dos controladores \n\nIHMPC, bem como sobre observadores de estado e o filtro de Kalman. \n\n \n\nNo quarto cap\u00edtulo, \u00e9 realizada uma breve revis\u00e3o dos conceitos de otimiza\u00e7\u00e3o de processo e \n\ndas formas dispon\u00edveis de implement\u00e1-los. Ainda no quarto cap\u00edtulo s\u00e3o apresentados o \n\ncontrole MPC por zonas e o controle \u201cFunnel\u201d. E em seguida foi gerado, passo a passo, um \n\nalgoritmo de controle MPC que agregou todas as caracter\u00edsticas apresentadas at\u00e9 ent\u00e3o.  \n\n \n\nNo quinto cap\u00edtulo, s\u00e3o apresentados seis diferentes estudos de caso baseados num modelo de \n\nprocesso real de uma unidade UHDT. Por meio de simula\u00e7\u00f5es em ambiente computacional, o \n\nalgoritmo foi testado e seus efeitos avaliados. \n\n \n\n \n\n1.1 \u2013 Introdu\u00e7\u00e3o aos Controladores MPC \n\n \n\nMarlin (2000) apresenta os controladores preditivos baseados em modelo, ou MPC (Model \n\nPredictive Control), como sendo algoritmos de controle desenvolvidos para estabilizar plantas \n\nde processos multivari\u00e1veis, permitindo que estas operem mais pr\u00f3ximas das suas restri\u00e7\u00f5es, \n\nsejam estas restri\u00e7\u00f5es na qualidade dos produtos ou restri\u00e7\u00f5es derivadas dos limites de \n\nopera\u00e7\u00e3o dos equipamentos.  \n\n\n\n \n \n\n19 \n \n\nPode-se citar como exemplo de restri\u00e7\u00e3o referente \u00e0 qualidade do produto o \u201cponto de \n\ncongelamento\u201d do querosene de avia\u00e7\u00e3o, que deve ser uma temperatura baixa o bastante para \n\nque o combust\u00edvel n\u00e3o congele durante um voo. Como restri\u00e7\u00e3o que surge a partir de limites \n\nde opera\u00e7\u00e3o dos equipamentos se pode citar a temperatura m\u00e1xima da tubula\u00e7\u00e3o de um forno \n\nindustrial, ou \u201cskin point\u201d. O valor m\u00e1ximo dessa vari\u00e1vel \u00e9 dado pelo limite metal\u00fargico do \n\na\u00e7o utilizado na constru\u00e7\u00e3o do tubo. \n\n \n\nUma discuss\u00e3o sobre as vantagens e desvantagens dos controladores MPC pode ser \n\nencontrada em Campos, Teixeira, Liporace e Gomes (2009), e de forma resumida pode-se \n\nlistar suas principais caracter\u00edsticas como sendo as seguintes: \n\n \n\n- Multivari\u00e1veis: ao contr\u00e1rio dos cl\u00e1ssicos controladores PID, que s\u00e3o capazes de manipular \n\napenas uma vari\u00e1vel e controlar outra vari\u00e1vel, os MPC podem manipular diversas vari\u00e1veis, \n\nbuscando manter todo um conjunto de controladas nos seus \u201csetpoints\u201d, ou ainda dentro de \n\nfaixas toler\u00e1veis, na medida em que esse objetivo seja numericamente poss\u00edvel. \n\n \n\n- Preditivos: os MPC possuem modelos din\u00e2micos do processo que descrevem o \n\ncomportamento esperado de todas as vari\u00e1veis controladas em rela\u00e7\u00e3o a varia\u00e7\u00f5es ou \n\ndist\u00farbios em todas as vari\u00e1veis manipuladas, ao longo de um dado per\u00edodo de tempo. \n\nTamb\u00e9m levam em conta os dist\u00farbios medidos antes que estes afetem as demais vari\u00e1veis de \n\nprocesso. \n\n \n\n \n\n- Otimizam a opera\u00e7\u00e3o da planta: uma vez que uma ou mais vari\u00e1veis controladas estejam \n\ndentro de seus limites toler\u00e1veis, ou seja, o \u201ccontrole por zonas\u201d esteja sendo implementado \n\ncom sucesso, um controlador MPC comum n\u00e3o ir\u00e1 tomar a\u00e7\u00f5es de controle relacionadas a \n\nestas vari\u00e1veis, e estas ir\u00e3o oscilar livremente enquanto estiverem dentro de sua zona \n\npermitida. Ou seja, o controlador permanecer\u00e1 ocioso e ir\u00e1 atuar apenas quando as vari\u00e1veis \n\ncontroladas infringirem os limites de zona. Nessas condi\u00e7\u00f5es, haver\u00e1 graus de liberdade \n\ndispon\u00edveis para a utiliza\u00e7\u00e3o por algoritmos de otimiza\u00e7\u00e3o econ\u00f4mica integrados aos \n\ncontroladores MPC.  \n\n \n\n\n\n \n \n\n20 \n \n\nEm geral, a otimiza\u00e7\u00e3o se d\u00e1 ao se aproximar as controladas dos seus limites, na medida do \n\nposs\u00edvel sem, contudo, ultrapass\u00e1-los. O mesmo vale para as manipuladas. Muitas vezes h\u00e1 \n\nganho econ\u00f4mico em se minimizar ou maximizar uma vari\u00e1vel manipulada. Por exemplo, se a \n\ncarga de uma planta de processo for uma manipulada, em geral t\u00eam-se um ganho em mant\u00ea-la \n\nno maior patamar poss\u00edvel. Da mesma forma, se a concentra\u00e7\u00e3o de uma dada subst\u00e2ncia numa \n\ncorrente de processo \u00e9 uma vari\u00e1vel controlada e possui um valor m\u00ednimo que deve ser \n\nrespeitado, e esta restri\u00e7\u00e3o limita a vaz\u00e3o total desta corrente, um algoritmo de otimiza\u00e7\u00e3o ir\u00e1 \n\nreduzir a vari\u00e1vel controlada ao menor valor poss\u00edvel. Em geral o MPC dever\u00e1 ser \n\nconfigurado de modo a minimizar o consumo de energia da planta e maximizar a produ\u00e7\u00e3o \n\ndas correntes mais rent\u00e1veis. \n\n \n\n- Exigem uma hierarquiza\u00e7\u00e3o das vari\u00e1veis controladas: muitas vezes n\u00e3o \u00e9 \n\nnumericamente poss\u00edvel manter todas as vari\u00e1veis dentro dos limites o tempo todo, portanto \n\natribu\u00edmos pesos e se prioriza as vari\u00e1veis cr\u00edticas. \n\n    \n\n- Utilizam Algoritmos de Otimiza\u00e7\u00e3o: a cada instante de amostragem, ou passo, um \n\nproblema de otimiza\u00e7\u00e3o \u00e9 solucionado, gerando vetores de novos valores que ser\u00e3o atribu\u00eddos \n\n\u00e0s manipuladas no instante presente e nos pr\u00f3ximos. \n\n \n\n \n\nA implanta\u00e7\u00e3o de um MPC \u00e9 complexa: O projeto de implanta\u00e7\u00e3o deve se adequar \u00e0 \n\nestrutura de hardware computacional onde os algoritmos ser\u00e3o executados e sua interliga\u00e7\u00e3o \n\ncom os sistemas de automa\u00e7\u00e3o e controle da planta de processo. \n\n \n\nDeve ser definido claramente qual \u00e9 o problema de controle a ser resolvido, para a partir da\u00ed \n\nse selecionar as vari\u00e1veis manipuladas, controladas e dist\u00farbios, e suas respectivas faixas \n\noperacionais, pesos e como otimiz\u00e1-las. Definidas as vari\u00e1veis, levanta-se o modelo do \n\nprocesso atrav\u00e9s de testes em degrau ou pulso nas vari\u00e1veis manipuladas e nos dist\u00farbios. \n\n \n\nA partir da\u00ed \u00e9 escolhida uma \u201cfun\u00e7\u00e3o objetivo\u201d que ser\u00e1 minimizada a cada passo pelo \n\nalgoritmo de otimiza\u00e7\u00e3o. Os pesos de vari\u00e1veis s\u00e3o ajustados de forma a se obter movimentos \n\nsuaves nas manipuladas. Interliga-se o MPC aos sistemas de controle e s\u00e3o realizados novos \n\ntestes e ajustes finais. \n\n\n\n \n \n\n21 \n \n\nCamacho e Bordons (2007) enumeram as principais vantagens dos controladores MPC como \n\nsendo: \n\n\u2022 Simplicidade conceitual; \n\n\u2022 Aplicabilidade para um grande n\u00famero de processos, inclusive com longos tempos \n\nmortos, sistemas de fase n\u00e3o m\u00ednima e processos inst\u00e1veis; \n\n\u2022 Facilidade em lidar com o caso multivari\u00e1vel e compensa\u00e7\u00e3o intr\u00ednseca de tempos \n\nmortos; \n\n\u2022 Introduzem controle antecipat\u00f3rio de forma a compensar dist\u00farbios medidos; \n\n\u2022 Totalmente baseados em metodologias abertas que permitem extens\u00f5es futuras. \n\n \n\nCamacho e Bordons (2007) tamb\u00e9m discutem as poss\u00edveis desvantagens dos controladores \n\nMPC, destacando a maior exig\u00eancia de tempo computacional para calcular as a\u00e7\u00f5es de \n\ncontrole como uma restri\u00e7\u00e3o consider\u00e1vel \u00e0 formula\u00e7\u00e3o de algoritmos, bem como a \n\nnecessidade de um modelo de processo apropriado para o sistema. Camacho e Bordons \n\nargumentam que os benef\u00edcios obtidos pela implementa\u00e7\u00e3o do controlador MPC s\u00e3o \n\nreduzidos pelo grau de incerteza ou imperfei\u00e7\u00e3o do modelo de processo, ou seja, a diferen\u00e7a \n\nentre os par\u00e2metros de um modelo ideal que descreveriam perfeitamente o comportamento da \n\nplanta e os par\u00e2metros do modelo real. \n\n \n\n \n\n1.2 \u2013 O Desenvolvimento dos Controladores MPC de Estabilidade garantida  \n\n \n\nO primeiro controlador do tipo MPC foi proposto por Cutler e Ramaker (1979), e foi chamado \n\nde Dynamic Matrix Control, ou DMC. O m\u00e9todo era baseado em \u201chorizontes de predi\u00e7\u00e3o\u201d \n\nfinitos e em modelos de coeficientes de resposta ao degrau e ao impulso. \n\n \n\nVetores com esses coeficientes para cada par de vari\u00e1vel controlada e manipulada eram \n\nagrupados em matrizes, que adquiriam grandes dimens\u00f5es, pois era necess\u00e1ria a inclus\u00e3o de \n\ncoeficientes at\u00e9 a estabiliza\u00e7\u00e3o total do sistema. Para modelos desse tipo, a solu\u00e7\u00e3o dos \n\nproblemas de controle de sistemas com grande n\u00famero de vari\u00e1veis exigia um esfor\u00e7o \n\ncomputacional relevante - mesmo para os dias de hoje.  O resultado desse trabalho foi uma \n\naplica\u00e7\u00e3o bastante eficaz para sistemas est\u00e1veis, mas com limita\u00e7\u00f5es como, por exemplo, para \n\no uso em sistemas inst\u00e1veis ou integradores.  \n\n\n\n \n \n\n22 \n \n\nGarcia e Morshedi (1986) aperfei\u00e7oaram o DMC desenvolvendo o controlador QDMC, \n\nbaseado em programa\u00e7\u00e3o quadr\u00e1tica que requer menor esfor\u00e7o computacional. A partir dos \n\nanos 90 os modelos com realiza\u00e7\u00e3o em \u201cespa\u00e7o de estados\u201d passaram a ser predominantes na \n\nprodu\u00e7\u00e3o cient\u00edfica relacionada ao tema de controle preditivo multivari\u00e1vel, e os modelos \n\nbaseados em coeficientes de resposta n\u00e3o receberam mais aten\u00e7\u00e3o. \n\n \n\nUm artigo seminal que apresentou o desenvolvimento de controladores MPC de estabilidade \n\ngarantida foi apresentado por Rawlings e Muske (1993), demonstrando que se o \u201chorizonte de \n\npredi\u00e7\u00e3o\u201d das vari\u00e1veis controladas tender ao infinito, a estabilidade do sistema estar\u00e1 \n\ngarantida independentemente dos par\u00e2metros de sintonia utilizados. Esse algoritmo de \n\ncontrole foi denominado \u201cInfinite Horizon Model Predictive Control\u201d, ou IHMPC, e consistia \n\nem se obter o equivalente a um MPC de horizonte de predi\u00e7\u00e3o finito pela introdu\u00e7\u00e3o de um \n\npeso terminal que \u00e9 obtido pela solu\u00e7\u00e3o de uma equa\u00e7\u00e3o de Lyapunov. \n\n \n\nOdloak (1996) e Gouv\u00eaa e Odloak (1997) apresentaram uma formula\u00e7\u00e3o alternativa para os \n\nmodelos de processo de resposta ao degrau e que se mostrou mais compacta que as \n\nencontradas tradicionalmente. Ao inv\u00e9s de se usar, como antes, extensos vetores de dados, \n\nesta formata\u00e7\u00e3o fez uso dos par\u00e2metros das fun\u00e7\u00f5es de transfer\u00eancia para gerar modelos em \n\nvari\u00e1veis de estado de ordem reduzida, que requerem menor tempo computacional. Esse \n\nformato foi chamado de Reduced Order State Space MPC, ou ainda ROSSMPC.  \n\n \n\nCombinando essas diferentes abordagens no intuito de se criar um controlador garantidamente \n\nest\u00e1vel, Rodrigues e Odloak (2003) desenvolveram uma formula\u00e7\u00e3o alternativa para o MPC \n\nde horizonte infinito, baseada no ROSSMPC. Sua principal vantagem em rela\u00e7\u00e3o ao \n\ncontrolador de Rawlings e Muske (1993) foi a extens\u00e3o para sistemas n\u00e3o quadrados, ou seja, \n\nsistemas de diferente n\u00famero de manipuladas e controladas para o caso de \"output tracking\" \n\npois o IHMPC de Rawlings e Muske (1993) resolvia apenas o problema regulador. \n\n \n\nA partir do trabalho de Rodrigues e Odloak (2003), Carrapi\u00e7o (2004) expandiu o IHMPC de \n\nestabilidade nominal para processos com vari\u00e1veis de caracter\u00edsticas integradoras e com \n\ntempo morto, utilizando um filtro de Kalman para a estimativa dos estados do modelo a partir \n\ndas sa\u00eddas da planta. \n\n \n\n\n\n \n \n\n23 \n \n\nNovos trabalhos baseados em controladores MPC de estabilidade garantida, ou controladores \n\nnominalmente est\u00e1veis,  seguem aparecendo desde ent\u00e3o na literatura (Carrapi\u00e7o &amp; Odloak, \n\n2005; Gonz\u00e1lez &amp; Odloak, 2009), chegando a ser implementados com sucesso na pr\u00e1tica \n\n(Carrapi\u00e7o, Santos, Zanin, Odloak, 2009; Schnelle, Lamon, Badgwell, 2007). \n\n \n\nPara lidar com modelos que apresentam incerteza, ou seja, quando o modelo do processo a ser \n\ncontrolado n\u00e3o \u00e9 conhecido com boa precis\u00e3o, outras abordagens de controladores MPC de \n\nestabilidade garantida t\u00eam sido propostas, tendo-se obtido \u00eaxito ao lidar com certas classes de \n\nincerteza (Badgwell, 1997; Kothare, Barakrishnan &amp; Morari , 1996; Lee &amp; Yu, 1997;  Mayne, \n\nRawlings, Rao &amp; Scokaert, 2000; Odloak, 2004; Ralhan &amp; Badgwell, 2000; Rodrigues &amp; \n\nOdloak, 2003). Pelo menos uma dessas propostas p\u00f4de ser aplicada na pratica sem maiores \n\ndificuldades (Porfirio, Neto &amp; Odloak, 2003). \n\n \n\nParalelamente, prosseguiu o desenvolvimento de controladores comerciais por empresas tais \n\ncomo a empresa de automa\u00e7\u00e3o Honeywell, que possui um controlador propriet\u00e1rio chamado \n\nRobust Model Predictive Control Technology, ou RMPCT, que surgiu a partir da mescla do \n\nantigo RMPC, tamb\u00e9m da Honeywell, com o PCT, que era da Profimatic, empresa adquirida \n\npela Honeywell em 1995, no processo que deu origem a Honeywell Hi-Spec Solutions. O \n\nRMPCT, ou Profit\u00ae Controller, o nome com o qual vem sendo comercializado possui uma \n\ncaracter\u00edstica inovadora que \u00e9 o controle por funis (\u201cfunnel\u201d). Quando uma determinada \n\nvari\u00e1vel est\u00e1 fora de seu limite, ao inv\u00e9s de computar o erro total em rela\u00e7\u00e3o ao valor desejado \n\ne usar esse valor na fun\u00e7\u00e3o objetivo, esse controlador cria uma rampa entre o valor desejado e \n\no valor onde a vari\u00e1vel se encontra e calcula o erro em rela\u00e7\u00e3o a essa rampa. A vantagem seria \n\nliberar alguns graus de liberdade que poderiam ser utilizados para otimiza\u00e7\u00e3o, al\u00e9m de obter \n\na\u00e7\u00f5es de controles mais suaves. \n\n \n\nPacheco (2009) agregou o controle por funis ao IHMPC com modelo vari\u00e1veis em estado, \n\ncom caracter\u00edsticas integradoras e com tempo morto. \n\n \n\n \n\n \n\n \n\n \n\n\n\n \n \n\n24 \n \n\n1.3 \u2013 Novas aplica\u00e7\u00f5es dos controladores MPC \n\n \n\nO Controle Preditivo Baseado em Modelos, ou MPC, tem sido desenvolvido continuamente \n\npor mais de 30 anos e dessa forma j\u00e1 n\u00e3o pode mais ser considerado uma novidade na \u00e1rea de \n\ncontrole de processos.  \n\n \n\nAinda assim, inova\u00e7\u00f5es continuam surgindo ao se aplicar esta ferramenta a diferentes \n\nprocessos industriais cont\u00ednuos, ap\u00f3s se esgotarem os alvos mais evidentes para seu uso. Por \n\nexemplo, controladores MPC foram recentemente utilizados em unidades de refino de \n\npetr\u00f3leo nas quais antes n\u00e3o se enxergava a possibilidade de ganhos no seu uso. Ap\u00f3s nova \n\nan\u00e1lise, esses processos passaram a ser vistos como detentores de grande potencial de ganhos \n\nem lucratividade, estabilidade e seguran\u00e7a a partir da concep\u00e7\u00e3o e implanta\u00e7\u00e3o de novas \n\nestrat\u00e9gias de controle. \n\n \n\nUm destes casos \u00e9 o das Unidades de Hidrotratamento de Diesel, ou UHDT, que nos \u00faltimos \n\nanos v\u00eam se multiplicando no parque de refino brasileiro devido \u00e0s novas normas ambientais \n\ne requisitos de qualidade para combust\u00edveis, com o novo protocolo legal (PROCONVE - \n\nprograma controle polui\u00e7\u00e3o ar ve\u00edculos automotores) atualmente em fase final de implanta\u00e7\u00e3o \n\nno Pa\u00eds. No Brasil, o primeiro controlador MPC de uma UHDT que contemplou uma \n\nestrat\u00e9gia de controle completa para a \u201cSe\u00e7\u00e3o de Rea\u00e7\u00e3o\u201d da unidade foi implementado na \n\nUHDT da RPBC, em Cubat\u00e3o, S\u00e3o Paulo, uma refinaria de petr\u00f3leo pertencente \u00e0 Petrobras.  \n\n \n\nEssa aplica\u00e7\u00e3o utiliza uma ferramenta de controle comercial e propriet\u00e1ria, o \u201cProfit \n\nControler\u201d da Honeywell, cujas caracter\u00edsticas s\u00e3o conhecidas de forma qualitativa, mas cujo \n\nequacionamento e algoritmos s\u00e3o propriet\u00e1rios e n\u00e3o abertos e, portanto, desconhecidos. \n\nDessa forma, a despeito desta ser inegavelmente uma ferramenta bastante completa e bem \n\nsucedida, os usu\u00e1rios do \u201cProfit Controler\u201d n\u00e3o possuem entendimento integral do seu \n\nfuncionamento e normalmente s\u00e3o incapazes de alterar as caracter\u00edsticas de seu algoritmo, o \n\nque restringe as possibilidades de inova\u00e7\u00e3o ao se trabalhar com este controlador comercial. Os \n\ndemais produtos dispon\u00edveis no mercado possuem limita\u00e7\u00f5es semelhantes.  \n\n \n\n \n\n \n\n\n\n \n \n\n25 \n \n\n1.4 \u2013 Introdu\u00e7\u00e3o ao Processo de Hidrotratamento \n\n \n\nMeyers (2003) descreve o hidrotratamento como sendo um processo de refino de petr\u00f3leo no \n\nqual o enxofre \u00e9 removido de uma corrente de processo pela passagem dessa corrente por um \n\nleito de catalisador em presen\u00e7a de hidrog\u00eanio. Nesse processo, em geral, n\u00e3o se verifica uma \n\nredu\u00e7\u00e3o significativa do tamanho das cadeias moleculares.  \n\n \n\nO Hidrotratamento tamb\u00e9m \u00e9 utilizado na redu\u00e7\u00e3o do teor de compostos nitrogenados, para \n\nsaturar as olefinas e para reduzir o teor de arom\u00e1ticos. O enxofre \u00e9 o mais f\u00e1cil de remover, \n\nseguido pela remo\u00e7\u00e3o dos nitrogenados e pela satura\u00e7\u00e3o de cadeias arom\u00e1ticos. A satura\u00e7\u00e3o \n\nde olefinas e a remo\u00e7\u00e3o de enxofre e nitrog\u00eanio se d\u00e3o ao mesmo tempo. A press\u00e3o parcial de \n\nhidrog\u00eanio \u00e9 o fator fundamental neste processo, e seus valores requeridos variam conforme \n\nas caracter\u00edsticas da corrente a ser tratada, ou seja, depende da complexidade de suas cadeias \n\nmoleculares. Segundo Meyers (2003), para um petr\u00f3leo relativamente leve (grau API superior \n\na 30), a press\u00e3o parcial de hidrog\u00eanio oscila, por exemplo, numa faixa de 5 kgf/cm2 a 7 \n\nkgf/cm2 para a nafta obtida por destila\u00e7\u00e3o atmosf\u00e9rica, chegando at\u00e9 25 kgf/cm2 a 50 kgf/cm2 \n\npara um gas\u00f3leo de v\u00e1cuo.  \n\n \n\nCorrentes advindas de processos de craqueamento exigem mais hidrog\u00eanio que correntes \n\n\u201cvirgens\u201d com mesmo intervalo de temperaturas de ebuli\u00e7\u00e3o. As temperaturas empregadas \n\nest\u00e3o geralmente no intervalo de 330 \u00baC a 400 \u00baC.  \n\n \n\nO consumo de hidrog\u00eanio varia de 0 - 1,5 m3 H2/bbl para nafta destilada, at\u00e9 10 m\n3 H2/bbl \n\npara o gas\u00f3leo pesado. Mais uma vez, correntes craqueadas requerem maiores quantidades de \n\nhidrog\u00eanio. Quando se deseja tamb\u00e9m reduzir nitrogenados, pode ser necess\u00e1rio algo entre   \n\n15 - 35 m3 H2/bbl.  \n\n \n\nA corrente de alimenta\u00e7\u00e3o \u00e9 combinada com o reciclo e a reposi\u00e7\u00e3o de hidrog\u00eanio e aquecida \n\nem um forno e depois segue para um reator catal\u00edtico de leito fixo. O efluente do reator passa \n\nent\u00e3o para um vaso de alta press\u00e3o, onde \u00e9 separado em uma fase l\u00edquida e uma corrente de \n\nreciclo de hidrog\u00eanio. Um fluxograma simplificado do processo de hidrogenodessulfuriza\u00e7\u00e3o \n\n\u00e9 mostrado abaixo (ver Meyers (2003)): \n\n \n\n\n\n \n \n\n26 \n \n\n \n\n \n\nFigura 1.1 \u2013 Esquema simplificado de uma UHDT \n\n \n\n \n\n A corrente l\u00edquida de alta press\u00e3o segue para um vaso separador de baixa press\u00e3o onde ocorre \n\num \u201cflash\u201d, produzindo uma corrente gasosa e uma nova corrente l\u00edquida, que alimenta uma \n\ntorre de fracionamento. \n\n \n\n O g\u00e1s \u00e9 enviado para uma planta de tratamento para a recupera\u00e7\u00e3o de enxofre e \n\nhidrocarbonetos e o l\u00edquido \u00e9 fracionado em produto com hidrotratado e subst\u00e2ncias de menor \n\nponto de ebuli\u00e7\u00e3o produzidas na rea\u00e7\u00e3o. \n\n \n\n \n\n1.4.1 \u2013 A Unidade de Hidrotratamento de Diesel da RPBC \n\n \n\nEste trabalho se baseou numa unidade de processo real, a Unidade de Hidrotratamento de \n\nDiesel da Refinaria RPBC da Petrobras, em Cubat\u00e3o (U-22313), que processa 6.000 m3/d de \n\numa mistura de diesel pesado, \u00f3leo leve de FCC (LCO) e gas\u00f3leo leve de Coque (LGO). A \n\nFigura 1.2 mostra um fluxograma de processo simplificado para a unidade. \n\n \n\n\n\n \n \n\n27 \n \n\nO diesel pesado e o LCO s\u00e3o misturados e aquecidos no permutador P-01A/B antes de \n\nentrarem em uma torre retificadora de O2, T-01, a fim de minimizar o oxig\u00eanio dissolvido, \n\nque \u00e9 prejudicial ao catalisador.  \n\n \n\nA corrente de LGO \u00e9 adicionada junto \u00e0 sa\u00edda do fundo da retificadora.  A alimenta\u00e7\u00e3o \n\ncombinada, misturada com reciclo de g\u00e1s e com a reposi\u00e7\u00e3o de hidrog\u00eanio, \u00e9 aquecida pelo \n\nefluente do segundo reator nos permutadores P-03 e P-04, passa pelo forno F-01 e, em \n\nseguida, entra no primeiro dos dois reatores, R-01 e R-02. \n\n \n\nAmbos os reatores possuem 2 leitos catal\u00edticos. A temperatura de entrada do primeiro leito \u00e9 \n\ncontrolada na sa\u00edda do forno F-01, enquanto que as temperaturas nas sa\u00eddas dos leitos s\u00e3o \n\ncontroladas com \"quenches\" de g\u00e1s de reciclo. O efluente do reator R-02 \u00e9 resfriado pela \n\nalimenta\u00e7\u00e3o da retificadora de H2S , T-02, no permutador P-05 e pela corrente de entrada do \n\nforno F-01 nos permutadores P-03 e P-04 e pelo efluente do vaso separador de baixa press\u00e3o, \n\nV-04, no permutador P-06A/B antes de entrar no V-02, o vaso separador de baixa press\u00e3o. \n\nG\u00e1s rico em H2 vai para o compressor de reciclo, C-01, cuja press\u00e3o de suc\u00e7\u00e3o \u00e9 controlada \n\npela velocidade do compressor alternativo de reposi\u00e7\u00e3o de H2, C-02. \n\n \n\nA fra\u00e7\u00e3o l\u00edquida do separador de alta press\u00e3o V-02 \u00e9 \u201cflasheada\u201d no separador de baixa \n\npress\u00e3o V-04, onde s\u00e3o geradas 3 correntes: corrente de g\u00e1s contendo H2S, \u00e1gua \u00e1cida e uma \n\ncorrente de hidrocarbonetos l\u00edquidos. Esta \u00faltima \u00e9 conduzida para a retificadora de H2S,      \n\nT-02, onde vapor superaquecido \u00e9 introduzido no fundo da torre para remover o H2S, H2 e \n\nhidrocarbonetos leves. A nafta inst\u00e1vel, ou \u201cwild naphtha\u201d, \u00e9 retirada do vaso de refluxo da \n\ntorre T-02. O l\u00edquido do fundo flui para o sistema de secagem \u00e0 v\u00e1cuo a fim de remover a \n\n\u00e1gua. Pelo fundo da torre de v\u00e1cuo, T-03, o \u00f3leo diesel hidrotratado vai para o sistema de \n\ntancagem da refinaria. \n\n\n\n \n \n\n28 \n \n\n \n\n \n\nFigura 1.2 \u2013 Esquem\u00e1tico da UHDT da PETROBRAS - RPBC \n\n\n\n \n \n\n29 \n \n\n1.4.2 \u2013 Se\u00e7\u00e3o de Rea\u00e7\u00e3o e Reciclo de H2 \n\n \n\nNeste trabalho ser\u00e1 dado foco \u00e0 se\u00e7\u00e3o de rea\u00e7\u00e3o e reciclo de H2 da Unidade de HDT de \n\nDiesel.  \n\n \n\nA carga da torre retificadora de O2 T-01 \u00e9 constitu\u00edda por Diesel vindo das unidades de \n\ndestila\u00e7\u00e3o atmosf\u00e9rica e LCO. \u00c0 corrente de fundo dessa torre \u00e9 adicionado Gas\u00f3leo de \n\nCoque filtrado, e a corrente resultante \u00e9 misturada com o fluxo de hidrog\u00eanio proveniente do \n\ncompressor de g\u00e1s de reciclo C-01 e com a reposi\u00e7\u00e3o de g\u00e1s vinda do compressor C-02 A/B. \n\nA corrente resultante \u00e9 ent\u00e3o aquecida nos permutadores P-03 A/C e P-04, trocando calor com \n\nos efluentes dos reatores de hidrogena\u00e7\u00e3o, sendo ent\u00e3o aquecida no forno F-01. O efluente do \n\nforno, que \u00e9 ent\u00e3o uma corrente bif\u00e1sica, alimenta os dois reatores de hidrotratamento, R-01 e \n\nR-02.  \n\n \n\nA temperatura da entrada no reator \u00e9 controlada manipulando-se a vaz\u00e3o de g\u00e1s combust\u00edvel \n\nqueimado no forno. De modo a aumentar o tempo de campanha da unidade, diminuindo a \n\ninativa\u00e7\u00e3o do catalisador, e para permitir um melhor controle da temperatura m\u00e1xima no \n\ninterior dos leitos catal\u00edticos, o hidrog\u00eanio \u00e9 injetado como \"quench\" entre os leitos \n\ncatal\u00edticos.  \n\n \n\nOs efluentes dos reatores possuem elevada temperatura, e para ter seu calor aproveitado s\u00e3o \n\ndivididos em duas correntes, uma delas aquecendo a carga da unidade pelo permutador P-04, \n\ne a outra aquecendo a alimenta\u00e7\u00e3o da torre retificadora T-02, pelo permutador P-05. Depois \n\nde passar pelos trocadores, ambos os fluxos s\u00e3o misturados novamente, desta vez para pr\u00e9-\n\naquecer a alimenta\u00e7\u00e3o do reator, pelo permutador P-03. Finalmente, o efluente do reator, \n\naquece a carga ainda fria da Torre Retificadora, no pr\u00e9-aquecedor P-06. \n\n \n\nFinalmente, o efluente \u00e9 resfriado com \u00e1gua de resfriamento no P-07, de onde segue ao vaso \n\nseparador de alta press\u00e3o, V-02. \n\n \n\nO objetivo da UHDT \u00e9 hidrotratar componentes de \u00f3leo cru na faixa de destila\u00e7\u00e3o do diesel, \n\nde maneira a adicion\u00e1-los ao pool de diesel da refinaria. O hidrotratamento ir\u00e1 melhorar as \n\nseguintes especifica\u00e7\u00f5es: \n\n\n\n \n \n\n30 \n \n\n\u2022 Teor de Enxofre; \n\n\u2022 Teor de Nitrog\u00eanio; \n\n\u2022 \u00cdndice de Cetano; \n\n\u2022 Estabilidade qu\u00edmica para armazenamento. \n\n \n\nUm subproduto da UHDT \u00e9 nafta inst\u00e1vel ou \u201cwild naphtha\u201d, contaminada com H2S, que n\u00e3o \n\npode ser incorporada em nenhum pool de produtos e, portanto, \u00e9 encaminhada para tratamento \n\nem outras unidades da refinaria. O produto hidrotratado deve atender \u00e0s seguintes \n\nespecifica\u00e7\u00f5es: \n\n \n\n\u2022 Remo\u00e7\u00e3o superior a 90% da massa de enxofre; \n\n\u2022 Estabilidade, conforme teste DuPont \u2013 F31; \n\n\u2022 \u00cdndice de Cetano (ASTM D976) \u2013 48 (min). \n\n \n\nNas seguintes situa\u00e7\u00f5es pode ser necess\u00e1rio limitar a carga da UHDT: \n\n \n\n\u2022 Baixa press\u00e3o parcial de H2 ou baixa rela\u00e7\u00e3o H2/Hidrocarboneto; \n\n\u2022 Porcentagem de abertura da v\u00e1lvula de reciclo do C-02 aproximando de 0%; \n\n\u2022 Press\u00e3o de suc\u00e7\u00e3o do compressor de make-up se aproximando do m\u00ednimo; \n\n\u2022 Taxa de reposi\u00e7\u00e3o de H2 pr\u00f3xima do m\u00ednimo. \n\n \n\nO principal objetivo \u00e9 maximizar a propor\u00e7\u00e3o de LCO na carga. Entretanto, a refinaria produz \n\nmais gas\u00f3leo de coque e LCO que a capacidade de processamento da UHDT. A torre \n\nretificadora de O2 \u00e9 tamb\u00e9m utilizada como um vaso pulm\u00e3o de carga. Gas\u00f3leo de coque \u00e9 \n\ninjetado na torre e usado como \"quench\" para controlar a temperatura de entrada na bomba. \n\n \n\n1.5 \u2013 Introdu\u00e7\u00e3o ao Problema de Controle de Unidades de Hidrotratamento de Diesel \n\nOs objetivos de controle da unidade UHDT foram definidos visando \u00e0 obten\u00e7\u00e3o de m\u00e1xima \n\nrentabilidade, observando os requisitos de qualidade do produto. Para tanto, a carga ou \n\ncorrente de alimenta\u00e7\u00e3o da unidade de processo deve ser composta preferencialmente por \n\nsubcorrentes de menor valor comercial, de forma que o valor agregado pelo hidrotratamento \n\nseja maximizado. Tamb\u00e9m se deve minimizar o consumo de hidrog\u00eanio pelo processo, pois \n\n\n\n \n \n\n31 \n \n\neste \u00e9 um insumo caro de se produzir, sendo gerado com grande gasto energ\u00e9tico a partir de \n\ng\u00e1s natural. \n\n \n\nA massa de catalisador dos reatores de processo sofre acelera\u00e7\u00e3o no processo de desativa\u00e7\u00e3o \n\nquando exposto a temperaturas demasiadamente altas ou varia\u00e7\u00f5es bruscas de temperatura, \n\nreduzindo sua vida \u00fatil, sendo necess\u00e1rio, portanto, priorizar o controle da temperatura dos \n\nleitos catal\u00edticos. Esse \u00e9 talvez o maior beneficio advindo do controle MPC para unidades de \n\nhidrotratamento de diesel: a melhoria do controle da temperatura dos leitos catal\u00edticos permite \n\nque a unidade de processo tenha \u201ctempo de campanha\u201d (per\u00edodo em que a ela opera entre \n\nparadas de manuten\u00e7\u00e3o) maior e reduz o consumo de catalisador ao reduzir sua taxa de \n\ndesativa\u00e7\u00e3o. Por fim, o produto final, o \u00f3leo diesel hidrotratado, deve se encontrar dentro de \n\ntodas as especifica\u00e7\u00f5es aplic\u00e1veis. Em especial, o teor de enxofre n\u00e3o deve ser superior \u00e0 \n\nconcentra\u00e7\u00e3o m\u00e1xima. \n\n \n\nPortanto, os objetivos de controle s\u00e3o listados a seguir: \n\n \n\n\u2022 Maximizar o volume total de hidrocarbonetos processados pela unidade; \n\n \n\n\u2022 Maximizar a propor\u00e7\u00e3o de correntes inst\u00e1veis na carga (LCO + Gas\u00f3leo de Coque); \n\n \n\n\u2022 Coordenar a produ\u00e7\u00e3o de hidrog\u00eanio de acordo com os requisitos da UHDT; \n\n \n\n\u2022 Minimizar a queima de H2 na tocha; \n\n \n\n\u2022 Manter a concentra\u00e7\u00e3o de enxofre no diesel dentro das especifica\u00e7\u00f5es, atrav\u00e9s de uma \n\nacurada infer\u00eancia de c\u00e1lculo desta propriedade; \n\n \n\n\u2022 Manter o perfil de temperaturas dos leitos catal\u00edticos dos reatores dentro dos limites \n\nespecificados pela opera\u00e7\u00e3o da unidade. \n\n \n\n  \n\n\n\n \n \n\n32 \n \n\n2 \u2013 Modelos de Processo para Controladores MPC \n\n \n\nNeste cap\u00edtulo ser\u00e1 apresentada uma revis\u00e3o do equacionamento dos controladores MPC de \n\nhorizonte infinito ou \u201cIHMPC\u201d, e ser\u00e1 formulado um novo controlador que agrega as \n\ncaracter\u00edsticas apresentadas para ser usado na solu\u00e7\u00e3o do problema de controle de unidades \n\nUHDT. \n\n \n\n2.1 \u2013 Apresenta\u00e7\u00e3o de um Modelo em Vari\u00e1veis de Estado para Sistemas Integradores \n\n \n\nA proposta deste cap\u00edtulo \u00e9 apresentar o modelo din\u00e2mico do processo que ser\u00e1 empregado no \n\ndesenvolvimento de um controlador IHMPC e que apresente caracter\u00edsticas adequadas para \n\npromover os estudos propostos na se\u00e7\u00e3o introdut\u00f3ria deste trabalho. \n\n \n\nEsse modelo, que est\u00e1 em vari\u00e1veis de estado na forma incremental e \u00e9 denominado OPOM \n\n(Output Prediction Oriented Model) , foi desenvolvido por Odloak (1996). \n\n \n\n \n\n2.1.1 \u2013 Sistema \u201cMIMO\u201d de Fun\u00e7\u00f5es de Transfer\u00eancia \n\n \n\nA formula\u00e7\u00e3o mais usual para modelos de processo s\u00e3o as fun\u00e7\u00f5es de transfer\u00eancia. Para um \n\ndado sistema multivari\u00e1vel, com nu entradas e ny sa\u00eddas, pode-se considerar que haver\u00e1 uma \n\nfun\u00e7\u00e3o de transfer\u00eancia relacionando cada sa\u00edda yi a cada entrada uj: \n\n \n\n \n\n            (2.1) \n\n \n\n \n\n2.1.2 \u2013 Modelo de Resposta ao degrau \n\n \n\nA partir da expans\u00e3o em fra\u00e7\u00f5es parciais da resposta ao degrau da fun\u00e7\u00e3o de transfer\u00eancia Gi,j \n\npode-se chegar \u00e0 uma formula\u00e7\u00e3o que descreve a resposta da sa\u00edda yi a um degrau na entrada \n\nuj, no instante k. Se pudermos admitir que o sistema n\u00e3o possui p\u00f3los repetidos ou \n\n\n\n \n \n\n33 \n \n\nintegradores, a resposta do sistema apresentado em (2.1) ao degrau pode ser escrita na \n\nseguinte forma:         \n\n( ) [ ] kl\nna\n\nl\n\nd\nljijiji rddkS ?\n\n=\n\n+=\n1\n\n,,\n0\n,,      (2.2) \n\n \n\nOnde: \n\n \n\n nalrl ,,2,1, K=   Polos do sistema; \n\n \n\nd\nna\n\nd\ni ddd ,,,\n\n0\nK  Par\u00e2metros obtidos atrav\u00e9s de expans\u00e3o por fra\u00e7\u00f5es \n\nparciais da fun\u00e7\u00e3o s\nGij\n\n1?\n \n\n \n\nA partir do instante k, uma predi\u00e7\u00e3o da trajet\u00f3ria da sa\u00edda yi pode ser obtida ao se somar os \n\nefeitos de todas as entradas da seguinte forma: \n\n \n\n( ) ( ) ( )??\n= =\n\n+=\nnu\n\nj\n\nk\nlji\n\nna\n\nl\n\nd\nlji\n\ns\ni rkxkxky\n\n1\n,,\n\n1\n,, , para i = 1, ... , ny \n\n \n\nDe forma conveniente, define-se o vetor de estados como sendo composto por dois \n\ncomponentes: o vetor de estados integradores gerados pela forma incremental do modelo, xs, e \n\no vetor de estados est\u00e1veis, xd. Sendo que, para este sistema os estados xs e xd s\u00e3o definidos \n\ncomo: \n\n \n\n( ) ( ) ( )?\n=\n\n?+=+\nnu\n\nj\njji\n\ns\ni\n\ns\ni kudkxkx\n\n1\n\n0\n,1 , para i = 1, ... , ny \n\n \n\n( ) ( ) ( ), , , , , , , , , ,1d d di j l i j l i j l i j l i j l jx k r x k d r u k+ = + ? , para i = 1,..., ny; j = 1,..., nu; l = 1,..., na \n \n\n \n\n \n\n\n\n \n \n\n34 \n \n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n?\n0\n\n,\n0\n\n1,\n\n0\n,1\n\n0\n1,1\n\n0\n\nnunyny\n\nnu\n\ndd\n\ndd\n\nD\n\nK\n\nMOM\n\nK\n\nnuxnyD ??0,\n\nPara se obter predi\u00e7\u00f5es para as trajet\u00f3rias de todas as sa\u00eddas, \u00e9 conveniente apresentar o \n\nmodelo \u201cMIMO\u201d na forma matricial, definindo-se os seguintes vetores para os estados: \n\n \n\n[ ]Tsnysss xxxx K21=  \n \n\n \n\n \n\n \n\nAl\u00e9m das seguintes matrizes, que agregam os par\u00e2metros obtidos atrav\u00e9s de expans\u00e3o por \n\nfra\u00e7\u00f5es parciais das fun\u00e7\u00f5es de transfer\u00eancia, e os p\u00f3los: \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nOnde: . .nd ny nu na=  sendo que na \u00e9 a ordem m\u00e1xima das fun\u00e7\u00f5es de transfer\u00eancia. \n\n \n\n( )d nanunyd nunyd nanydnyd nanudnud nadd dddddddddiagD ,,1,,,1,1,1,,,11,,1,1,11,1,1 KKKKKKK=\nd nd x ndD ? ?\n\n[ ]Td nanunyd nunyd nanydnyd nanudnud nadd xxxxxxxxx ,,1,,,1,1,1,,,11,,1,1,11,1,1 KKKKKKK=\n\nnd x ndF ? ?\n\n( )nanunynunynanynynanununa rrrrrrrrdiagF ,,1,,,1,1,1,1,,1,,1,1,11,1,1 KKKKKKK=\n\n\n\n \n \n\n35 \n \n\n \n\n \n\nPortanto, a representa\u00e7\u00e3o em forma matricial dos estados xs e xd ser\u00e1: \n\n \n\n       ( ) ( ) ( )kuDkxkx ss ?+=+ 01      (2.3) \n \n\n    ( ) ( ) ( )kuNFDkxFkx ddd ?+=+ 1     (2.4) \n \n\n \n\n \n\n2.2 \u2013 Modelo em Vari\u00e1veis de Estado para Sistemas sem Tempo Morto \n\n \n\n \n\nCamacho e Bordons (2008) argumentam que os modelos em vari\u00e1veis de estado s\u00e3o \n\nprovavelmente os mais amplamente empregados na comunidade acad\u00eamica devido \u00e0 sua \n\nsimplicidade inerente, mesmo para o caso multivari\u00e1vel, e que a descri\u00e7\u00e3o por estados permite \n\nque se expressem facilmente crit\u00e9rios de estabilidade e robustez. \n\n \n\nAs equa\u00e7\u00f5es (2.3) e (2.4) correspondem a um modelo de vari\u00e1veis de estado incremental, pois \n\ntrabalha com a diferen\u00e7a entre os valores das vari\u00e1veis manipuladas em instantes \n\nconsecutivos. Ao contr\u00e1rio da chamada forma posicional, neste tipo de representa\u00e7\u00e3o as \n\nvari\u00e1veis envolvidas n\u00e3o s\u00e3o medidas como desvios em rela\u00e7\u00e3o a um determinado estado \n\nestacion\u00e1rio, que por sua vez n\u00e3o necessita, portanto, ser determinado. O modelo pode ser \n\ncolocado na forma: \n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n\nnyJ\n\nJ\n\nJ\n\nN\nM\n\n2\n\n1\n\nnuxndN ??,\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n\n1000\n\n1000\n\n0001\n\n0001\n\nK\n\nMOMMM\n\nK\n\nO\n\nK\n\nMOMMM\n\nK\n\niJ\n\nnyiJ nuxnanui ,...,2,1,\n. =??\n\n\n\n \n \n\n36 \n \n\n \n\n( ) ( ) ( )kuBkxAkx ?+=+ 1         (2.5) \n \n\n( ) ( )kxCky =           (2.6) \n \n\nNos estados definidos em (2.3) e (2.4), tem-se o vetor dos estados integradores gerados pela \n\nforma incremental do modelo, xs, e o vetor dos estados est\u00e1veis, xd. As equa\u00e7\u00f5es (2.5) e (2.6) \n\npodem ser estritas como segue: \n\n \n\n( )\n( )\n\n( )\n( )\n\n( )ku\nNFD\n\nD\n\nkx\n\nkx\n\nF\n\nI\n\nkx\n\nkx\ndd\n\ns\nny\n\nd\n\ns\n\n?\n?\n?\n?\n\n?\n\n?\n?\n?\n\n?\n+\n\n?\n?\n?\n\n?\n\n?\n?\n?\n\n?\n?\n?\n\n?\n?\n?\n\n?\n=\n\n?\n?\n?\n\n?\n\n?\n?\n?\n\n?\n\n+\n+ 0\n\n0\n\n0\n\n1\n\n1\n \n\n \n\n \n\n \n\nOnde: \n\n( )\n\n( )\n( )\n\n( )?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n\n?\n\n?\n\n?\n\n?\n?\n\n=?\n\nkT\n\nkT\n\nkT\n\nkT\n\nnyL\n\nMOMM\n\nL\n\nL\n\n00\n\n00\n\n00\n\n2\n\n1\n\nndxny???,  \n\n( ) [ ] ndirrrri kTnanuikTnuikTnaikTi eeeekT ???=? ,,,1,,,1,1,1, KKK , i = 1, 2, ..., ny \n\nDa mesma forma, pode-se reescrever o modelo de resposta ao degrau como segue: \n\n \n\n \n\n \n\n \n\nOnde T \u00e9 o per\u00edodo de amostragem. Este modelo apresentado, denominado OPOM por \n\nOdloak (1996), consegue gerar o equivalente a um modelo de resposta ao degrau a partir dos \n\npar\u00e2metros das fun\u00e7\u00f5es de transfer\u00eancia. \n\n \n\n( ) ( ) NDkTDTS dk ?+= 0\n\n( ) [ ] ( )\n( )?\n?\n?\n\n?\n\n?\n?\n?\n\n?\n?=\n\nkx\n\nkx\nIky\n\nd\n\ns\n\nny\n\n\n\n \n \n\n37 \n \n\n2.3 \u2013 Modelo em Vari\u00e1veis de Estado para Sistemas com Tempo Morto \n\n \n\nGouv\u00eaa e Odloak (1997) estenderam o modelo OPOM para sistemas com tempo morto, \n\ncriando o ROSSMPC (Reduced Order State Space MPC). Para sistemas com tempo morto, o \n\ncontrolador deve possuir um horizonte de predi\u00e7\u00e3o grande o suficiente para abranger todos os \n\natrasos ou tempos mortos das diversas entradas do processo: \n\n \n\n \n\n \n\n \n\nOnde: \n\n \n\n            o tempo morto entre a sa\u00edda i e a entrada j; \n\nm  o n\u00famero de a\u00e7\u00f5es de controle planejadas a partir do instante \n\natual, k, para os instantes seguintes, conhecido como horizonte \n\ndas a\u00e7\u00f5es de controle;  \n\n \n\nA matriz abaixo cont\u00e9m os tempos mortos de todas as entradas do sistema: \n\n \n\n \n\n \n\n \n\n \n\nO seguinte estado \u00e9 definido pelo ROSSMPC para sistemas com tempo morto: \n\n \n\n[ ] Tdsnpkkk xxyyyx +++= K21 , 1,nex ?? , ( )nanunpnyne .1. ++=  \n \n\nAs matrizes (2.5) e (2.6) foram reescritas para este caso na seguinte forma:  \n\n \n\n( ){ }Tmnp ji /maxint ,?+?\n\nji,?\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n=\n\nnunyny\n\nnu\n\n,1,\n\n,11,1\n\n??\n\n??\n?\n\nL\n\nMOM\n\nL\n\n\n\n \n \n\n38 \n \n\n \nnenynunenene CBA ,,, ;; ??????  \n\n \n\nPara k>np, os coeficientes do modelo de resposta ao degrau podem ser obtidos pela seguinte \n\nequa\u00e7\u00e3o ao longo do horizonte de predi\u00e7\u00e3o: \n\n \n\n \n\n \n\n \n\n \n\n \n\nOnde, \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nEste modelo ser\u00e1 empregado ao longo deste trabalho por possuir as caracter\u00edsticas desejadas \n\npara o estudo do problema de controle de unidades UHDT como, por exemplo, a forma \n\ncompacta, utiliza\u00e7\u00e3o de par\u00e2metros de fun\u00e7\u00f5es de transfer\u00eancia e por incluir modelos de \n\nvari\u00e1veis com tempo morto. \n\n( )[ ]\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n+?\n\n=\n\nF\n\nI\n\nTnpI\n\nI\n\nI\n\nI\n\nA\n\nny\n\nny\n\nny\n\nny\n\nny\n\n00000\n\n00000\n\n10000\n\n00000\n\n00000\n\n00000\n\nL\n\nL\n\nL\n\nL\n\nMMMOMMM\n\nL\n\nL\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n=\n\n+\n\nFND\n\nD\n\nS\n\nS\n\nS\n\nS\n\nB\n\nd\n\nnp\n\nnp\n\n0\n\n1\n\n3\n\n2\n\nM\n\n[ ]00 LnyIC =\n\n( ) nunyd\n\nknunyknykny\n\nknukk\n\nknukk\n\nk NDkTD\n\nSSS\n\nSSS\n\nSSS\n\nS ,0\n\n,,,2,,1,\n\n,,2,2,2,1,2\n\n,,1,2,1,1,1\n\n???+=\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n=\n\nL\n\nMOMM\n\nL\n\nL\n\n( )\n\n( )\n( )\n\n( )\n\nndny\n\nny kT\n\nkT\n\nkT\n\nkT ,\n2\n\n1\n\n,\n\n00\n\n00\n\n00\n\n???\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n=?\n\n?\n\n?\n?\n\nL\n\nMOMM\n\nL\n\nL\n\n( ) [ ] nanuikTnanuikTnuikTnaikTii nuinuiii rrrrkT .,,1,,,1,1,1, ,,,1,1, ??= ???? ?? ???? KKK\n\n\n\n \n \n\n39 \n \n\n3 \u2013 Controlador IHMPC \n\n \n\nA lei de controle em um controlador MPC de horizonte infinito \u00e9 dada pela solu\u00e7\u00e3o de um \n\nproblema de otimiza\u00e7\u00e3o que consiste na minimiza\u00e7\u00e3o da diferen\u00e7a, ou \u201cerro\u201d, entre as \n\npredi\u00e7\u00f5es para as sa\u00eddas do sistema ao longo de um horizonte infinito e as trajet\u00f3rias futuras \n\ndesejadas para cada sa\u00edda, atrav\u00e9s da escolha de um conjunto adequado de valores para as \n\nvari\u00e1veis manipuladas. \n\nConsidere a seguinte fun\u00e7\u00e3o Objetivo: \n\n \n\n \n\n             (3.1) \n\n \n\n \n\nOnde: \n\n \n\n\u00e9 o erro entre a predi\u00e7\u00e3o das sa\u00eddas e seus valores de   \n\nrefer\u00eancia, sendo que ( ) nykjke ??+ ; \n                                                      \n\n\u00e9 uma matriz definida positiva que serve de peso para \n\nponderar o erro das vari\u00e1veis controladas; \n\n                                                         \n\n\u00e9 uma matriz semi-definida positiva que serve de peso para \n\nponderar o movimento das vari\u00e1veis controladas; \n\n \n\n                                                        \u00e9 um vetor de valores de refer\u00eancia das sa\u00eddas (Set-Points). \n\n \n\n\u00c9 \u00fatil separar o primeiro termo da fun\u00e7\u00e3o objetivo (3.1) em dois, um referente ao erro gerado \n\nnos instantes correspondentes ao horizonte de controle, e outro que computa o erro at\u00e9 o \n\ninfinito. A fun\u00e7\u00e3o objetivo passa a ser: \n\n \n\n \n\n \n\n \n\n( ) ( ) ( ) ( )kjkuRkjkukjkeQkjkeJ\nm\n\nj\n\nT\n\nj\n\nT\n\nk +?+?+++= ??\n?\n\n=\n\n?\n\n=\n\n1\n\n01\n\n( ) ( ) spykjkykjke ?+=+\n\nnyxnyQ ??\n\nnuxnuR ??\n\nspy\n\n\n\n \n \n\n40 \n \n\n \n\n \n\n \n\n            (3.2) \n\n \n\n \n\nO segundo termo do lado direito de (3.2) pode ser desenvolvido como se segue: \n\n \n\n \n\n             (3.3) \n\n \n\n \n\n \n\nO termo                              n\u00e3o depende do \u00edndice j e, portanto, deve ser feito igual a zero para \n\nmanter o valor da fun\u00e7\u00e3o objetivo limitado. Portanto, a solu\u00e7\u00e3o do problema de controle deve \n\nse submeter \u00e0 seguinte restri\u00e7\u00e3o: \n\n \n\n            (3.4) \n\n \n\nIncorporando essa restri\u00e7\u00e3o (3.4), o termo da somat\u00f3ria infinita da fun\u00e7\u00e3o objetivo pode ser \n\nsimplificada como segue: \n\n \n\n \n\n            (3.5) \n\n \n\n \n\n \n\nO lado direito da equa\u00e7\u00e3o (3.5) pode ser reduzido para um \u00fanico termo: \n\n \n\n \n\n            (3.6) \n\n \n\n \n\n( ) ( )\n\n( )( ) ( )( ) ( ) ( )kjkuRkjkuykjkxCQykjkxC\n\nkjkeQkjkeJ\n\nm\n\nj\n\nT\n\nmj\n\nspTsp\n\nm\n\nj\n\nT\n\nk\n\n+?+?+?+?++\n\n++=\n\n??\n\n?\n?\n\n=\n\n?\n\n+=\n\n=\n\n1\n\n01\n\n1\n\n( )( ) ( )( )\n\n( ) ( )( ) ( ) ( )( )?\n\n?\n?\n\n=\n\n?\n\n+=\n\n+???++???+\n\n=?+?+\n\n1\n\n1\n\nj\n\ndjspsTdjsps\n\nmj\n\nspTsp\n\nkmkxFykmkxQkmkxFykmkx\n\nykjkxCQykjkxC\n\n( ) sps ykmkx ?+\n\n( ) 0=?+ sps ykmkx\n\n( )( ) ( )( )\n\n( ) ( ) ( )?\n\n?\n?\n\n=\n\n?\n\n+=\n\n+??+=\n\n?+?+\n\n1\n\n1\n\nj\n\ndjTTjTd\n\nmj\n\nspTsp\n\nkmkxFQFkmkx\n\nykjkxCQykjkxC\n\n( ) ( ) ( ) ( ) ( )kmkxQkmkxkmkxFQFkmkx dTd\nj\n\ndjTTjTd ++=+??+?\n?\n\n=1\n\n\n\n \n \n\n41 \n \n\nOnde Q \u00e9 a solu\u00e7\u00e3o da seguinte equa\u00e7\u00e3o de Lyapunov: \n\n \n\n \n\n      ,  \n\n \n\nA fun\u00e7\u00e3o objetivo (3.2) se torna: \n\n \n\n \n\n \n\n \n\n \n\n \n\n\u00c9 poss\u00edvel obter uma express\u00e3o mais simples para o objetivo de controle. Pode se demonstrar \n\nque: \n\n \n\n \n\n \n\nAplicando as express\u00f5es acima para os passos de tempo dentro do horizonte de controle, \n\nobt\u00e9m-se: \n\n \n\n \n\nOnde: \n\n \n\n( ) ( ) ( )kjkxkjkxkjky ds +?++=+\n\n( ) ( ) ( ) ( )\n\n( ) ( ) ( ) ( )\n( )kmkuFND\n\nkkuFNDFkkuFNDFkxFkjkx\n\nkjkuDkkuDkxkjkx\n\nd\n\ndjdjdjd\n\nss\n\n1...\n\n1\n\n1...\n\n21\n\n00\n\n?+?+\n\n++?+?+=+\n\n?+?++?+=+\n\n??\n\nFQFFQFQ TTT ??=?\n\n( ) ( )\n\n( ) ( ) ( ) ( )kjkuRkjkukmkxQkmkx\n\nkjkeQkjkeJ\n\nm\n\nj\n\nTdTd\n\nm\n\nj\n\nT\n\nk\n\n+?+?++++\n\n++=\n\n?\n\n?\n?\n\n=\n\n=\n\n1\n\n0\n\n1\n\n( ) kmss uDkxIx ?+= 0\n\nndxndQ ??\n\n\n\n \n \n\n42 \n \n\n \n\n \n\n \n\nAnalogamente, aplicando as mesmas express\u00f5es para os estados est\u00e1veis dentro do horizonte \n\nde controle, tem-se: \n\n \n\n \n\n \n\nA fun\u00e7\u00e3o objetivo (3.6) pode ent\u00e3o ser escrita como: \n\n \n\n \n\n \n\n \nOnde: \n\n \n\n( )\n\n( )?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n+\n\n+\n=\n\nkmkx\n\nkkx\n\nx\ns\n\ns\n\ns\nM\n\n1\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n=\n\nny\n\nny\n\nI\n\nI\n\nI M\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n?\n00\n\n0\n\n0\n\n0\n\nDD\n\nD\n\nDm\n\nK\n\nOM\n\n( )\n\n( )?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n?+?\n\n?\n??\n\nkmku\n\nkku\n\nuk\n1\n\nM\n\n( )\n( )\n\n( )\n\n( )\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n+\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n=\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n+\n\n+\n\n+\n\n??\nND\n\nND\n\nND\n\nIFF\n\nIF\n\nI\n\nkx\n\nF\n\nF\n\nF\n\nkmkx\n\nkkx\n\nkkx\n\nd\n\nd\n\nd\n\nmm\n\nd\n\nmd\n\nd\n\nd\n\nL\n\nMOMM\n\nL\n\nL\n\nL\n\nMOMM\n\nML\n\nL\n\nMM\n\n00\n\n00\n\n0000\n\n2\n\n1\n\n21\n\n22\n\n( ) kudxd uFkxFx ?+=\n\ncucuHuJ k\nT\n\nfk\nT\n\nkk +?+??= 2\n\nku?\n\n\n\n \n \n\n43 \n \n\n \n\n \n\nA restri\u00e7\u00e3o (3.4) pode ser escrita como: \n\n \n\n             \n\nOnde: \n\n \n\n \n\n \n\nO controlador MPC de horizonte infinito, que \u00e9 est\u00e1vel para sistemas com modelo perfeito \n\ncontendo polos est\u00e1veis, pode ser formulado como sendo a solu\u00e7\u00e3o do seguinte problema de \n\notimiza\u00e7\u00e3o: \n\n \n\n \n\n \n\nSujeito a: \n\n \n\n            (3.7) \n\n           \n\n \n\n            (3.8) \n\n \n\n \n\n \n\n \n\n( ) ( ) 1210110 RFQFFDQFDH uTuumTum ++?+?+=\n\n( ) ( ) ( )( ) ( )( )kxFQFkxFkeIQFDc dxTudxsTumf 21110 +?+?+=\n\n( ) ( ) ( ) ( )( ) ( ) ( )( ) ( )( ) ( )( )kxFQkxFkxFkeIQkxFkeIkQekec dxTdxdxsTdxssTs 2111 +?+?++=\n\n[ ]\n48476 m\n\nQQdiagQ ...1 = [ ]\n44 844 76 m\n\nQdiagQ 0...02 = [ ]\n48476 m\n\nRRdiagR ...1 =\n\n[ ]\n48476 m\n\ndiag ??=? ...1 ( ) ( )\nspss ykxke ?=\n\n( ) 0~ 0 =?+ ks uDke\n\n[ ]\n44 844 76 m\n\nDDD 000 ...\n~\n\n=\n\nccuHuJJ Tfk\nT\nkkk\n\nuk\n++??=\n\n?\n2,min\n\n\n\n \n \n\n44 \n \n\n \n\nEste controlador, quando implementado na pr\u00e1tica torna-se frequentemente invi\u00e1vel, pois \n\nocorre conflito entre as restri\u00e7\u00f5es de igualdade dadas pelas equa\u00e7\u00f5es (3.7) e (3.8). Isso \n\nacontece por exemplo, quando o controlador \u00e9 submetido a grandes varia\u00e7\u00f5es nos set-points \n\nou, quando o sistema sofre perturba\u00e7\u00f5es de amplitudes significativas. \n\n \n\n \n\n \n\n3.1 \u2013 Controlador IHMPC com vari\u00e1veis de folga \n\n \n\nPara aumentar a faixa de viabilidade do controlador, Rodrigues e Odloak (2003) apresentaram \n\numa abordagem que insere uma vari\u00e1vel de folga na fun\u00e7\u00e3o objetivo, a qual relaxa a solu\u00e7\u00e3o \n\nda restri\u00e7\u00e3o de igualdade dada pela Eq. (3.7). Essa solu\u00e7\u00e3o, que \u00e9 v\u00e1lida para sistemas \n\nest\u00e1veis, ser\u00e1 desenvolvida a seguir. Partindo da equa\u00e7\u00e3o (3.1), inserimos a vari\u00e1vel de folga \n\nda seguinte maneira: \n\n \n\n \n\n \n\n \n\n \n\n \n\n            (3.9) \n\nOnde: \n\n \n\n \n\n \n\nUtilizando-se o mesmo procedimento empregado para gerar a equa\u00e7\u00e3o (3.2), obt\u00e9m-se: \n\n \n\n \n\n \n\n \n\n                     (3.10) \n\n \n\n( )( ) ( )( )\n\n( ) ( ) kTk\nm\n\nj\n\nT\n\nj\nk\n\nT\n\nkk\n\nSkjkuRkjku\n\nkjkeQkjkeJ\n\n??\n\n??\n\n++?+?+\n\n?+?+=\n\n?\n\n?\n?\n\n=\n\n?\n\n=\n\n1\n\n0\n\n1\n\nnyxnyny\nk S ???? ,?\n\n( )( ) ( )( )\n\n( )( ) ( )( )\n\n( ) ( ) kTk\nm\n\nj\n\nT\n\nmj\n\nsp\nk\n\nTsp\nk\n\nm\n\nj\nk\n\nT\n\nkk\n\nSkjkuRkjku\n\nykjkxCQykjkxC\n\nkjkeQkjkeJ\n\n??\n\n??\n\n??\n\n++?+?+\n\n??+??++\n\n?+?+=\n\n?\n\n?\n\n?\n\n?\n\n=\n\n?\n\n+=\n\n=\n\n1\n\n0\n\n1\n\n1\n\n\n\n \n \n\n45 \n \n\n( )( ) ( )( )\n\n( ) ( )( ) ( ) ( )( )?\n\n?\n?\n\n=\n\n?\n\n+=\n\n+?+??++?+??+=\n\n??+??+\n\n1\n\n1\n\nj\n\ndjsp\nk\n\nsTdjsp\nk\n\ns\n\nmj\n\nsp\nk\n\nTsp\nk\n\nkmkxFykmkxQkmkxFykmkx\n\nykjkxCQykjkxC\n\n??\n\n??\n\n \n\nAnalogamente ao caso sem vari\u00e1veis de folga, o segundo termo da parte direita da equa\u00e7\u00e3o \n\n(3.10) pode ser desenvolvido como segue: \n\n \n\n \n\n                     (3.11) \n\n \n\n \n\n \n\nA restri\u00e7\u00e3o ao objetivo de controle (3.7) deve ser modificada com a adi\u00e7\u00e3o da vari\u00e1vel de \n\nfolga, que garante que o problema de controle sempre tenha uma solu\u00e7\u00e3o vi\u00e1vel: \n\n \n\n \n\n                     (3.12) \n\n                       \n\nOu ainda: \n\n \n\n                     (3.13) \n\n                        \n\n \n\nUtilizando-se Q , que \u00e9 a solu\u00e7\u00e3o da equa\u00e7\u00e3o de Lyapunov (3.6) a fun\u00e7\u00e3o objetivo se torna: \n\n  \n\n \n\n                     (3.14)  \n\n \n\n \n\n \n\nComo exposto por Carrapi\u00e7o (2004), a fun\u00e7\u00e3o objetivo (3.14) resolve os problemas de \n\ninviabilidade apontados anteriormente, e pode ser escrita como uma express\u00e3o quadr\u00e1tica, \n\nfacilitando a resolu\u00e7\u00e3o num\u00e9rica do problema.   \n\n \n\n \n\n \n\n( ) 0=??+ spks ykmkx ?\n\n( ) 0~ 0 =???+ spkks yuDkx ?\n\n( )( ) ( )( ) ( ) ( )\n\n( ) ( ) kTk\nm\n\nj\n\nT\n\ndTd\nm\n\nj\nk\n\nT\n\nkk\n\nSkjkuRkjku\n\nkmkxQkmkxkjkeQkjkeJ\n\n??\n\n??\n\n++?+?+\n\n+++?+?+=\n\n?\n\n?\n?\n\n=\n\n=\n\n1\n\n0\n\n1\n\n\n\n \n \n\n46 \n \n\n( )\n( )\n\n( )\n( )\n\n( )\n\n( )\n( )\n\n( )?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?+?\n\n+?\n\n?\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n+\n\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n=\n\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n+\n\n?+\n\n+\n\n+\n\n???\n\n?\n\n??\n\n?\n\nkmku\n\nkku\n\nkku\n\nBCABCABCA\n\nCABBCABCA\n\nCBBCABCA\n\nCBCAB\n\nCB\n\nkx\n\nCA\n\nCA\n\nCA\n\nCA\n\nknpky\n\nknpky\n\nkky\n\nkky\n\nmnpnpnp\n\nmm\n\nmm\n\nnp\n\nnp\n\n1\n\n1\n\n0\n\n00\n\n1\n\n2\n\n1\n\n21\n\n1\n\n21\n\n1\n\n2\n\nM\n\nL\n\nMOMM\n\nL\n\nL\n\nMOMM\n\nL\n\nL\n\nMM\n\n3.2 \u2013 IHMPC Estendido para Sistemas com Tempo Morto \n\n \n\nNesta se\u00e7\u00e3o ser\u00e1 definida uma nova lei de controle que possibilitar\u00e1 controlar sistemas que \n\napresentem uma ou mais sa\u00eddas com tempo morto. Retornando-se agora \u00e0 equa\u00e7\u00e3o (3.1), que \n\ndefine uma fun\u00e7\u00e3o objetivo que pondera os erros das predi\u00e7\u00f5es das sa\u00eddas e os movimentos \n\nnas vari\u00e1veis manipuladas: \n\n \n\n( ) ( ) ( ) ( )kjkuRkjkukjkeQkjkeJ\nTm\n\nj\n\nT\n\nj\nk +?+?+++= ??\n\n?\n\n=\n\n?\n\n=\n\n1\n\n00\n\n            (3.1) \n\nDesdobrando-se a primeira parcela da equa\u00e7\u00e3o (3.1) em dois termos que correspondem, \n\nrespectivamente, ao erro computado entre o instante atual e o horizonte de predi\u00e7\u00e3o e ao erro \n\ncomputado entre o horizonte de predi\u00e7\u00e3o e o infinito, obt\u00e9m-se: \n\n \n\n( ) ( )\n\n( ) ( ) ( ) ( )kjkuRkjkukjnpkeQkjnpke\n\nkjkeQkjkeJ\n\nTm\n\nj\n\nT\n\nj\n\nTnp\n\nj\nk\n\n+?+?++++++\n\n++=\n\n??\n\n?\n\n?\n\n=\n\n?\n\n=\n\n=\n\n1\n\n01\n\n0\n             (3.15) \n\n \n\nOs dois primeiros termos da equa\u00e7\u00e3o (3.16) ser\u00e3o agora desenvolvidos e agrupados \n\nconvenientemente na forma matricial. Denominando-os respectivamente de ( )1\nkJ  e \n\n( )2\nkJ  t\u00eam-\n\nse, dessa forma: \n\n \n\n                      (3.16) \n\nPode-se desenvolver ( )1\nkJ  calculando a predi\u00e7\u00e3o de sa\u00edda de forma recursiva a partir do \n\ninstante atual presente at\u00e9 o horizonte de predi\u00e7\u00e3o finito np, como segue: \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n( ) ( ) ( ) ( )kjkuRkjkuJJJ\nm\n\nj\n\nT\n\nkkk +?+?++= ?\n?\n\n=\n\n1\n\n0\n\n21\n\n\n\n \n \n\n47 \n \n\nA qual pode ser representada em forma compacta matricial: \n\n \n\n \n\n                      (3.17) \n\n \n\n \n\nSubstituindo-se a Eq.(3.17) na express\u00e3o de ( )1\nkJ  obt\u00e9m-se: \n\n \n\n \n\n                      (3.18) \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nPode-se agora desenvolver ( )2\nkJ . O vetor que multiplica Q pode ser definido como o erro entre \n\no valor desejado para as sa\u00eddas de processo e o valor obtido num dado instante ap\u00f3s o \n\nhorizonte de predi\u00e7\u00e3o: \n\n \n\n \n\n                      (3.19) \n\n \n\n \n\n \n\nIsso \u00e9 exatamente a defini\u00e7\u00e3o de erro discutida anteriormente. Substituindo a express\u00e3o para o \n\nerro, obt\u00e9m-se: \n\n \n\n                      (3.20) \n\n \n\n \n\n( ) ( )\nnumnynpnanunynynpnynynp\n\nK\n\nCCCCOnde\n\nuCkxCky\n.,...2.,. ,:\n\n,\n\n??\n\n?+=\n++\n\n[ ]( )\n\n[ ] nynpTspspspsp\n\nnynpnynp\n\nTTT\n\nyyyy\n\nQQQdiagQOnde\n\n.\n1\n\n.,.~:\n\n??=\n\n??=\n\nL\n\nL\n\n( ) ( )( ) ( )( )?\n?\n\n=\n\n?++?++=\n1\n\n2\n\nj\n\nspTsp\nk ykjnpkxCQykjnpkxCJ\n\n( ) ( ) ( )?\n?\n\n=\n\n++++=\n1\n\n2\n\nj\n\nT\nk jnpkeQjnpkeJ\n\n( ) ( )[ ] ( )[ ]spKTspKk yuCkxCQyuCkxCJ 111 ~ ??+??+=\n\n\n\n \n \n\n48 \n \n\nAgora a equa\u00e7\u00e3o 3.20 ser\u00e1 posta na forma matricial. Fazendo uso das equa\u00e7\u00f5es 2.5 e 2.6 \n\npodemos escrever recursivamente as predi\u00e7\u00f5es das sa\u00eddas do processo \n( )y k np+\n\nem fun\u00e7\u00e3o \n\ndo vetor de estados no instante k+m+1 e nos instantes seguintes. \n\n \n\nPara tal observe que para a sa\u00edda de processo, tem-se: \n\n \n\n  ( ) ( ) ( )( ) ( )mkxTnpmkxmknpky ds ++?++=+++ 11  \n( ) ( ) ( )( ) ( )\n\n( ) ( )( ) ( )mkxFTnpmkx\nmkxTnpmkxmknpky\n\nds\n\nds\n\n++?++=\n\n=+++?+++=+++\n\n1\n\n1112\n \n\n( ) ( ) ( )( ) ( )mkxFTnpmkxjmknpky djs ++?++=+++ 1\nM\n\n \n\n \n\nComo na formula\u00e7\u00e3o anterior, para garantir que a fun\u00e7\u00e3o objetivo seja limitada deve-se for\u00e7ar \n\na anula\u00e7\u00e3o do estado ( )kmkxs + . Isso pode ser feito pela anula\u00e7\u00e3o dos termos \ncorrespondentes aos polos integradores na matriz A. Da\u00ed define-se a matriz modificada A*. \n\n \n\n \n\n \n\n \n\n \n\nAssim, no instante j as previs\u00f5es das sa\u00eddas s\u00e3o obtidas por: \n\n \n\n( ) ( )( ) ( )mkxFTnpjmknpky Tdj ++?=+++ 1  \n \n\n \n\n\n\n \n \n\n49 \n \n\nOs estados ap\u00f3s o horizonte de predi\u00e7\u00e3o (k + np) ser\u00e3o: \n\n \n\n                      (3.21) \n\nCom o estado (3.21) substitu\u00eddo dentro da predi\u00e7\u00e3o das sa\u00eddas por: \n\n \n\n \n\n                      (3.22) \n\n \n\nSubstituindo (3.23) na express\u00e3o para ( )2\nkJ : \n\n \n\n \n\n \n\n                      (3.23) \n\n \n\n \n\n \n\n \n\n \n\nDa\u00ed resulta a seguinte a express\u00e3o para o erro: \n\n \n\n \n\n                      (3.24) \n\n \n\nA equa\u00e7\u00e3o (3.25) pode por sua vez ser substitu\u00edda em (3.24): \n\n \n\n \n\n                      (3.25) \n\n \n\n \n\n \n\nDa\u00ed define-se a vari\u00e1vel: \n\n \n\n                      (3.26) \n\n( ) ( ) ( )mkxAjnpkx mjnp +=++ ?+*\n\n( ) ( ) ( ) ( )mkxACjnpkxCjnpky mjnp +=++=++ ?+*\n\n( ) ( )[ ] ( )[ ]\n\n( )[ ] ( )[ ]\n\n( ) ( )\n\n[ ] nanunynynynpTTTspspspspsp\nj\n\nTT\n\nj\n\nspTsp\n\nj\n\nspTsp\nk\n\nTTTT\n\nyyyyyonde\n\nkjmkeCQCkjmke\n\nCykjnpkxCQCykjnpkxC\n\nykjnpkyQykjnpkyJ\n\n...2.\n2\n\n1\n\n1\n22\n\n1\n\n2\n\n00: ++\n\n?\n\n=\n\n?\n\n=\n\n?\n\n=\n\n??=\n\n++++=\n\n?++?++=\n\n?++?++=\n\n?\n\n?\n\n?\n\nL\n\n( ) ( ) ( )kmkeAkjnpke mjnp +=++ ?+*\n\n( ) ( ) ( ){ } ( ) ( ){ }\n( ) ( ) ( ) ( )kmkeAACQCAAkmke\n\nkjmkeACQCkjmkeAJ\n\nTmnp\n\nj\n\njT\nTjTmnpT\n\nj\n\njmnpT\nTjmnp\n\nk\n\n+??\n?\n\n?\n?\n?\n?\n\n?\n+=\n\n++++=\n\n?\n?\n\n=\n\n?\n\n?\n\n=\n\n+?+?\n\n?\n\n?\n\n*\n\n1\n\n***\n\n1\n\n**2\n\n?\n?\n\n=\n\n=\n1\n\n**\n\nj\n\njT\nTj\n\nACQCAQ\n\n\n\n \n \n\n50 \n \n\nQue pode ter seu valor determinado pela solu\u00e7\u00e3o de uma equa\u00e7\u00e3o de equa\u00e7\u00e3o de Lyapunov:  \n\n \n\n \n\n                      (3.27) \n\n \n\n \n\nSubstituindo (3.26) em (3.25) obt\u00e9m-se uma nova express\u00e3o para o termo correspondente \u00e0 \n\nsomat\u00f3ria infinita: \n\n \n\n                      (3.28) \n\n \n\n \n\nPortanto, a restri\u00e7\u00e3o (3.4): \n\n \n\n( ) 0=?+ sps ykmkx       (3.4)\n   \n\n   \n\nPoder\u00e1 ser reescrita de modo mais f\u00e1cil de se aplicar, da forma como segue: \n\n \n\n \n\n \n\n                      (3.29) \n\n \n\n \n\nO que \u00e9 equivalente a: \n\n \n\n \n\n                      (3.30) \n\n \n\n \n\n \n\n \n\n \n\n**** ACQCAQAQA T\nTT\n\n?=?\n\n( ) ( ) ( ) ( ) ( )kmkeAQAkmkeJ TmnpTmnpTk ++=\n?? **2\n\n( ) ( ) ( )\n( )\n\n( )\n\n( )?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?+?\n\n+?\n\n?\n\n+=+\n\nkmku\n\nkku\n\nkku\n\nDDDkkxkmkx ss\n\n1\n\n1\n000\n\nM\nL\n\n( ) 0~ =?+? ksps uDykkx\n\n\n\n \n \n\n51 \n \n\nReescrevendo o estado x no instante k+m: \n\n \n\n \n\n \n\n \n\n \n\n \n\nO que equivale \u00e0: \n\n \n\n \n\nPortanto, a fun\u00e7\u00e3o objetivo \u00e9 equivalente a: \n\n \n\n           (3.31) \n\n \n\n \n\n \n\nAo se incluir as vari\u00e1veis de folga na fun\u00e7\u00e3o objetivo definida em (3.2) e seguindo-se um \n\nprocedimento an\u00e1logo ao apresentado acima, chega-se \u00e0 seguinte fun\u00e7\u00e3o objetivo: \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n( )[ ] ( )[ ]\n( ){ } ( ){ } skTskKTkKmTKm\n\ns\nk\n\nsp\nK\n\nT\ns\nk\n\nsp\nKk\n\nSuRuuBAkkeAQuBAkkeA\n\nIyuCkkxCQIyuCkkxCJ\n\n??\n\n??\n\n1\n*\n\n11\n\n~~~\n\n~\n\n+??+?+?++\n\n???+???+=\n\n( ) ( ) [ ]\n( )\n\n( )\n\n( )?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?+?\n\n+?\n\n?\n\n+=+ ??\n\nkmku\n\nkku\n\nkku\n\nBBABAkkxAkmkx mmm\n\n1\n\n1\n21\n\nM\nL\n\n( )[ ] ( )[ ]\n( )[ ] ( )[ ] kTkkmTkm\n\nsp\nk\n\nT\nsp\n\nkk\n\nuRuuBAkkeAQuBAkkeA\n\nyuCkkxCQyuCkkxCJ\n\n??+?+?++\n\n??+??+=\n~~~\n\n~\n\n*\n\n11\n\n\n\n \n \n\n52 \n \n\nOnde: \n\n \n\n \n\n \n\n \n\n \n\nDessa forma o problema de controle do IHMPC para processos com tempo morto fica \n\ndefinido como: \n\n \n\n \n\n \n\nSujeito a: \n\n \n\n \n\n \n\n \n\nOnde: \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n( )xnynynp\n\nny\n\nny\n\nny\n\nI\n\nI\n\nI\n\nI\n\nI ., ??\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n=\nM\n\n[ ]\n??\n\n?\n?\n?\n\n??\n\n?\n?\n?\n\n+?\n?\n\n?\n?\n?\n\n??\n+?\n?\n\n?\n?\n?\n\n??\n?\n\n?\n2\n\n,\n2min c\n\nu\nC\n\nu\nHu\n\ns\nk\n\nkT\nfs\n\nk\n\nkTs\nk\n\nT\nk\n\nu skk ??\n?\n\n?\n\n( )\n\n( ) 0,\n\n0\n~\n\n??+?\n\n=??+?\n\njkjku\n\nuDykkx skk\nsps\n\nU\n\n?\n\n\n\n \n \n\n53 \n \n\n3.3 \u2013 Observador de Estados \n\n \nQuando o modelo \u00e9 representado sob a forma de vari\u00e1veis de estado, deve-se em geral usar \n\num observador de estado para atualizar os estados como uma fun\u00e7\u00e3o dos erros entre as sa\u00eddas \n\npreditas e as sa\u00eddas reais, que s\u00e3o medidas. Seu prop\u00f3sito \u00e9 utilizar medi\u00e7\u00f5es de grandezas \n\nrealizadas ao longo do tempo (contaminadas com ru\u00eddo e outras incertezas) e gerar resultados \n\nque tendam a se aproximar dos valores reais das grandezas medidas.  O observador de estados \n\nconsiderado neste trabalho pode ser representado pelas seguintes equa\u00e7\u00f5es: \n\n \n\n( ) ( ) ( )\n( ) ( ) ( ){ }\n\n( ) ( )[ ] ( ) ( )[ ] ( ) pkFFF\n\np\nkF\n\nyKkkuBCKIkkxACKIkkx\n\nkkxCyKkkxkkx\n\nkkuBkkxAkkx\n\n+????+???=\n\n??+?=\n\n???+??=?\n\n1111\n\n11\n\n11111\n\n \n\n \n\nOnde: \n\nyk\np \u2013 \u00e9 o vetor de sa\u00eddas da planta, aferidas no instante k; \n\nKF - matriz de ganho do observador. \n\n \n\nUsualmente, os controladores MPC corrigem as sa\u00eddas adicionando o erro atual para todas as \n\nprevis\u00f5es futuras. Na nossa representa\u00e7\u00e3o esta estrat\u00e9gia corresponde a um filtro dado por: \n\n \n\n \n\n \n\n \n\n \n\nPara garantir a estabilidade do controlador em malha fechada, o ganho do observador, KF, \n\ndever\u00e1 ser tal que todos os autovalores da matriz [(I - KF C) A] estejam dentro do c\u00edrculo \n\nunit\u00e1rio, o que corresponde \u00e0 obten\u00e7\u00e3o de polos est\u00e1veis do sistema em malha fechada. \n\n \n\nO estimador de estado que ser\u00e1 utilizado neste trabalho \u00e9 o filtro de Kalman. O Filtro de \n\nKalman, que pode ser utilizado para estimar uma vari\u00e1vel a partir do conhecimento de outras \n\nvari\u00e1veis, baseia-se num modelo estat\u00edstico (estoc\u00e1stico) do processo. Foi originalmente \n\ndesenvolvido para sistemas lineares com ru\u00eddos gaussianos e, neste caso, apresenta uma \n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n=\n\n0\nny\n\nny\n\nF\nI\n\nI\n\nK\nM\n\n\n\n \n \n\n54 \n \n\nsolu\u00e7\u00e3o fechada, ou em outras palavras, demonstra-se que \u00e9 o estimador de m\u00ednima vari\u00e2ncia \n\npara esse tipo de sistema, conforme apresentado em Ricker (1990). Entretanto, para aplicar o \n\nFiltro de Kalman para sistemas n\u00e3o lineares \u00e9 necess\u00e1rio fazer adapta\u00e7\u00f5es e extens\u00f5es do \n\nalgoritmo original. Uma discuss\u00e3o e dedu\u00e7\u00e3o formal do Filtro de Kalman pode ser encontrada \n\nna literatura, como por exemplo, em Jazwinski (1997).  \n\n \n\nO filtro de Kalman produz estimativas dos valores reais de grandezas medidas predizendo um \n\nvalor, estimando a incerteza do valor predito e calculando uma m\u00e9dia ponderada entre o valor \n\npredito e o valor medido. O peso maior \u00e9 dado ao valor de menor incerteza. As estimativas \n\ngeradas pelo m\u00e9todo tendem a estarem mais pr\u00f3ximas dos valores reais que as medidas \n\noriginais, pois a m\u00e9dia ponderada apresenta uma melhor estimativa de incerteza que ambos os \n\nvalores utilizados no seu c\u00e1lculo. \n\n \n\nPode-se demonstrar (Astrom e Wittenmark, 1990) que para um tempo de observa\u00e7\u00e3o \n\nsuficientemente grande, o ganho do filtro de Kalman \u00e9 definido pelas seguintes equa\u00e7\u00f5es: \n\n \n\n( )\n\n[ ] WCPACPCVAPCAPAP\n\nCPCVAPCK\n\nTTTT\n\nTT\nF\n\n++?=\n\n+=\n\n?\n\n?\n\n1\n\n1\n\n                (3.29) \n\n \n\nOnde: \n\n \n\nV e W s\u00e3o as matrizes de covari\u00e2ncia dos ru\u00eddos na sa\u00edda e estado respectivamente podem ser \n\nusadas como par\u00e2metros de sintonia do filtro de Kalman. \n\n \n\n  \n\n\n\n \n \n\n55 \n \n\n4 \u2013 Otimiza\u00e7\u00e3o Integrada ao Controlador Preditivo \n\n \n\nNeste cap\u00edtulo s\u00e3o apresentadas diversas metodologias para integrar a otimiza\u00e7\u00e3o com o \n\ncontrole de processos. Kwong (1992) argumenta que isto pode ser realizado utilizando-se a \n\nestrat\u00e9gia de multicamadas, tamb\u00e9m conhecida como estrutura hier\u00e1rquica.  \n\n \n\nUma estrutura hier\u00e1rquica comum para integrar a otimiza\u00e7\u00e3o em tempo real (Real Time \n\nOptimization, RTO) com controle MPC \u00e9 atrav\u00e9s de uma estrutura de tr\u00eas camadas (Ying &amp; \n\nJoseph, 1999), onde na camada superior se encontra uma aplica\u00e7\u00e3o de RTO, que se baseia \n\nnum modelo rigoroso n\u00e3o-linear de estado estacion\u00e1rio do processo. A camada RTO resolve \n\num problema de otimiza\u00e7\u00e3o que define as condi\u00e7\u00f5es de opera\u00e7\u00e3o \u00f3timas para processos \n\ncont\u00ednuos sujeitos a restri\u00e7\u00f5es provenientes de equipamentos e especifica\u00e7\u00f5es dos produtos. \n\nOu seja, a camada de otimiza\u00e7\u00e3o, que \u00e9 baseada num modelo econ\u00f4mico, busca as melhores \n\ncondi\u00e7\u00f5es de opera\u00e7\u00e3o para o processo. A camada de controle MPC calcula e implementa as \n\na\u00e7\u00f5es visando a estabilidade e otimiza\u00e7\u00e3o processo, dentro de certos limites. A camada do \n\nprocesso representa a planta em si, incluindo as opera\u00e7\u00f5es unit\u00e1rias, a instrumenta\u00e7\u00e3o do \n\nprocesso e o controle regulat\u00f3rio. \n\n \n\n \n\nFigura 4.1 - Esquema da estrat\u00e9gia de otimiza\u00e7\u00e3o em tr\u00eas camadas. \n\n \n\nComo representado na figura 4.1, as entradas e sa\u00eddas ideais do sistema, calculadas pelo RTO \n\ns\u00e3o, em seguida, passadas para uma camada interm\u00e9dia em que, com base na estimativa dos \n\ndist\u00farbios d(k), setpoints vi\u00e1veis para as entradas e sa\u00eddas s\u00e3o recalculados atrav\u00e9s da solu\u00e7\u00e3o \n\n\n\n \n \n\n56 \n \n\nde um problema de programa\u00e7\u00e3o quadr\u00e1tica (QP) baseado em modelos est\u00e1ticos lineares do \n\nprocesso. O problema de programa\u00e7\u00e3o quadr\u00e1tica refere-se \u00e0 minimiza\u00e7\u00e3o ou maximiza\u00e7\u00e3o de \n\numa fun\u00e7\u00e3o objetivo quadr\u00e1tica que \u00e9 linearmente restrita (Coelho &amp; Mariani, 2006). O \n\ncontrolador MPC resolve o problema de controle implementado dinamicamente os setpoints \n\nvi\u00e1veis de otimiza\u00e7\u00e3o. \n\n \n\nOutra possibilidade mais simples, apresentada por Kwong (1992) \u00e9 a estrutura da estrat\u00e9gia de \n\notimiza\u00e7\u00e3o em duas camadas. Nesta estrutura, representada de forma simplificada como \n\nmostrado na figura 4.2, a camada de otimiza\u00e7\u00e3o em tempo real ou RTO envia diretamente os \n\ntargets \u00f3timos ao controlador MPC. Essa estrutura apresenta algumas dificuldades. Devem-se \n\ntomar cuidados para que o problema de controle resultante seja sempre vi\u00e1vel. Al\u00e9m disso, a \n\nfrequ\u00eancia com que o RTO consegue convergir e enviar resultados ao controlador \u00e9 baixa. \n\nEntres duas itera\u00e7\u00f5es bem sucedidas, pode decorrer um intervalo de v\u00e1rias horas, no qual o \n\nprocesso pode sofrer dist\u00farbios e os resultados perderem relev\u00e2ncia. Por exemplo, a carga \n\nprocessada pelo reator de uma planta petroqu\u00edmica pode se alterar, modificando as condi\u00e7\u00f5es \n\nde opera\u00e7\u00e3o do processo. Por estas raz\u00f5es, justifica-se a estrat\u00e9gia em 3 camadas representada \n\nna figura 4.1. \n\n \n\nNo item 4.1 ser\u00e1 apresentada a camada de c\u00e1lculo de target e sua intera\u00e7\u00e3o com o controlador \n\nMPC. Neste trabalho, ser\u00e1 desenvolvido um controlador capaz de implementar targets (sejam \n\neles gerados por uma camada QP ou diretamente por um RTO). Alternativamente, este \n\ncontrolador MPC tamb\u00e9m contemplar\u00e1 uma outra estrat\u00e9gia de otimiza\u00e7\u00e3o denominada \n\notimiza\u00e7\u00e3o online, que consiste em acrescentar um terno de otimiza\u00e7\u00e3o econ\u00f4mica \u00e0 fun\u00e7\u00e3o \n\nobjetivo. Descrita no item 4.4, esta estrat\u00e9gia ameniza as dificuldades decorrentes do elevado \n\ntempo que o RTO exige para fornecer novos resultados. O objetivo da estrutura de controle \n\nadotada \u00e9 possibilitar a resolu\u00e7\u00e3o um \u00fanico problema de programa\u00e7\u00e3o quadr\u00e1tica que \n\ncontemple simultaneamente o problema de controle e o problema de otimiza\u00e7\u00e3o. \n\n \n\n\n\n \n \n\n57 \n \n\n \n\n \n\nFigura 4.2 - Esquema da estrat\u00e9gia de otimiza\u00e7\u00e3o em duas camadas. \n\n \n\nQuando se aplica uma estrat\u00e9gia de controle em m\u00faltiplas camadas, na pr\u00e1tica, deve-se \n\nconsiderar de uma maneira mais ampla o controle de processos, que se d\u00e1 em dois ambientes \n\ncomputacionais distintos, o SDCD ou Sistema Digital de Controle Distribu\u00eddo, tamb\u00e9m \n\nchamado de DCS (Distributed Control System), no qual est\u00e1 ligada toda a instrumenta\u00e7\u00e3o de \n\nprocesso, e um outro computador que roda as aplica\u00e7\u00f5es de controle MPC e otimiza\u00e7\u00e3o, que \u00e9 \n\ndenominado como \u201ccomputador de processo\u201d. Dependendo das dimens\u00f5es do processo, pode \n\nser necess\u00e1rio utilizar mais de uma computador para minimizar o tempo computacional. \n\n \n\nPode-se considerar que estes sistemas interdependentes formam uma pir\u00e2mide, pois o bom \n\nfuncionamento das aplica\u00e7\u00f5es de controle MPC dependem integralmente de uma correta \n\nconcep\u00e7\u00e3o e implementa\u00e7\u00e3o das malhas de controle regulat\u00f3rio que rodam no SDCD e do \n\nbom funcionamento da instrumenta\u00e7\u00e3o de campo. O bom funcionamento da camada de \n\notimiza\u00e7\u00e3o depende da defini\u00e7\u00e3o de objetivos de controle consistentes. A figura 4.3 apresenta \n\numa representa\u00e7\u00e3o esquem\u00e1tica da pir\u00e2mide das sistemas de automa\u00e7\u00e3o e controle de \n\nprocessos. \n\n \n\n \n\nFigura 4.3 \u2013 Representa\u00e7\u00e3o da pir\u00e2mide do controle de processos \n\n\n\n \n \n\n58 \n \n\nNo presente trabalho interessa explorar as melhores maneiras de unir as camadas de \n\notimiza\u00e7\u00e3o e controle, fazendo considera\u00e7\u00f5es adequadas para o controle de UHDT. Nas \n\npr\u00f3ximas se\u00e7\u00f5es ser\u00e3o exploradas alternativas para este fim. \n\n \n\n \n\n4.1 - MPC convencional em duas Camadas - Camada de Otimiza\u00e7\u00e3o Simplificada do \n\nEstado Estacion\u00e1rio \n\n \n\nEsta estrutura cl\u00e1ssica de controle, envolve um simulador com um modelo rigoroso que \u00e9 \n\nusado na otimiza\u00e7\u00e3o em estado estacion\u00e1rio, que \u00e9 realizada em tempo real em um intervalo \n\nde tempo maior do que o per\u00edodo utilizado na camada de controle (Kwong,1992). Esta \n\ncamada de otimiza\u00e7\u00e3o estacion\u00e1ria envia periodicamente valores de refer\u00eancia, ou \u201ctargets\u201d, \n\nao controlador MPC. Retomando a analogia da uma pir\u00e2mide dos sistemas de automa\u00e7\u00e3o e \n\ncontrole, pode-se visualizar este processo na figura 4.3. \n\n \n\n \n\nFigura 4.4 \u2013 Intera\u00e7\u00e3o entre os n\u00edveis da pir\u00e2mide do controle de processos \n\n \n\n \n\nNesta estrutura, definida na figura 4.4, existe uma forte intera\u00e7\u00e3o entre as camadas, mas suas \n\na\u00e7\u00f5es s\u00e3o realizadas em procedimentos distintos. Agora ser\u00e1 discutido o funcionamento da \n\ncamada de otimiza\u00e7\u00e3o no estado estacion\u00e1rio. Utilizando-se a mesma formula\u00e7\u00e3o da se\u00e7\u00e3o 2, \n\na partir das equa\u00e7\u00f5es 2.5 e 2.6, a predi\u00e7\u00e3o do vetor de sa\u00eddas no estado estacion\u00e1rio pode ser \n\ndescrita da seguinte forma: \n\n\n\n \n \n\n59 \n \n\n \n\n( ) ( ) [ ]\n( )\n\n( )\n\n( )?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n\n?\n\n?\n\n?+?\n\n+?\n?\n\n+=+ ???\n\n1\n\n121\n\nmku\n\nku\n\nku\n\nBCABCABCAkxCANky mNNNN\nM\n\nL   (4.1) \n\n \n\nOnde N \u00e9 suficientemente grande para aproximar o estado estacion\u00e1rio. Portanto, quando \n\n??N  a equa\u00e7\u00e3o (4.1) pode ser escrita da seguinte forma: \n\n \n\n   ( ) ( ) ( )?\n?\n\n=\n\n?? +?+=?+\n1\n\n0\n\nm\n\ni\n\nikuBCAkxCAky      (4.2) \n\n \n\nPor\u00e9m, ( ) ( )?+=?+ kumku 1  que corresponde ao estado da sa\u00edda e, portanto, a equa\u00e7\u00e3o \n(4.2) torna-se: \n\n   ( ) ( ) ( ) ( )( )1???++=?+ ?? kukuBCAkxCAky     (4.3) \n \n\nSupondo-se que haja uma fun\u00e7\u00e3o objetivo econ\u00f4mico do tipo: \n\n \n\n( ) ( ) ?? ?CkuCkyC TuTy +?++?+=      (4.4) \n \n\nSujeita \u00e0s seguintes restri\u00e7\u00f5es: \n\n \n\n( ) ?? +??+?? maxmin ykyy  \n( ) maxmin ukuu ??+?  \n\n \n\nOnde Cy e Cu s\u00e3o vetores de pre\u00e7os (se positivos) ou custos (se negativos) das entradas e \n\nsa\u00eddas, ? \u00e9 uma vari\u00e1vel de folga que assegura a viabilidade do problema e C? \u00e9 sua matriz de \n\nganhos. Assim, a camada superior do controlador resolve o seguinte problema: \n\n \n\n( ) ( )\n( ) ( ){ }?? ?CkuCkyC TuTy\n\nkyku\n+?++?+=\n\n?+?+ ,\nmax     (4.5) \n\n \n\n\n\n \n \n\n60 \n \n\n( )( ) ( )( )[ ] ( )( ) ( )( )[ ]\n( ) ( )[ ]?\n\n?\n?\n\n=\n\n=\n\n+?+?+\n\n??+??++?+?+=\n\n1\n\n1\n\n1\n\n//\n\n/1/1//\n\nm\n\nj\n\nT\n\nsp\nu\n\nTsp\nnp\n\nj\n\nspTsp\nk\n\nkjkuRkjku\n\nukmkuRukmkuykjkyQykjkyJ\n\nAo resolver este problema definido pela equa\u00e7\u00e3o (4.5), s\u00e3o obtidos \"setpoints\" \u00f3timos para a \n\ncamada din\u00e2mica, ou seja, os targets: \n\n \n\n \n\nUm controlador MPC convencional poderia ser modificado para que se tenha os targets \n\nimplementados atrav\u00e9s da seguinte fun\u00e7\u00e3o objetivo: \n\n \n\n \n\n \n\n       (4.6) \n\n \n\nOnde Ru \u00e9 uma matriz de pesos de dimens\u00f5es adequadas. \n\n \n\nPortanto, a camada inferior ou din\u00e2mica do controlador resolve o seguinte problema: \n\n( ) ( ) kmkuku\nJ\n\n1,,\nmin\n\n?+?? K\n \n\nSujeito \u00e0s seguintes restri\u00e7\u00f5es: \n\n \n\n \n\n \n\nComo se pode observar, o erro entre a entrada e seu \"target\" s\u00f3 \u00e9 ponderado no \u00faltimo \n\ninstante do horizonte de controle, pois isto \u00e9 conveniente para separar o controle das sa\u00eddas da \n\notimiza\u00e7\u00e3o das entradas. Desta forma, o controlador dar\u00e1 prioridade para controlar as sa\u00eddas \n\nnos valores desejados e mover as entradas para os seus \"alvos\" apenas quando h\u00e1 n\u00famero \n\nsuficiente de graus de liberdade. A otimiza\u00e7\u00e3o, ou obten\u00e7\u00e3o dos targets, deve incluir todas as \n\nrestri\u00e7\u00f5es do processo. Esta \u00e9 a estrat\u00e9gia de otimiza\u00e7\u00e3o em tempo real utilizada pelos pacotes \n\ncomerciais dispon\u00edveis atualmente para implementa\u00e7\u00f5es industriais, inclusive o Profit Suite. \n\n( ) ( )?+=?+= kuCukyy Tuspsp ,\n\n\n\n \n \n\n61 \n \n\n \n\nConforme exposto por Porf\u00edrio (2011), uma desvantagem da estrutura representada na figura \n\n4.1 \u00e9 que podem ocorrer instabilidades caso ocorra um dist\u00farbio no processo ao mesmo tempo \n\nem que os \u201ctargets\u201d est\u00e3o sendo alterados (Gouv\u00eaa &amp; Odloak, 1998). Deve-se considerar que \n\nplantas que sofrem muitos dist\u00farbios, especialmente dist\u00farbios n\u00e3o medidos pela \n\ninstrumenta\u00e7\u00e3o de processo, tal como as unidades de UHDT, os \u201ctargets\u201d de otimiza\u00e7\u00e3o \n\npoder\u00e3o n\u00e3o mais representar o melhor ponto operacional ou serem invi\u00e1veis. Uma adapta\u00e7\u00e3o \n\ndeste esquema ao IHMPC \u00e9 apresentada na se\u00e7\u00e3o 4.4.  \n\n \n\n4.2 \u2013 IHMPC Estendido com Controle por Zonas e Targets para as Entradas \n\n \n\nGonzalez e Odloak (2009) estenderam o controlador MPC de horizonte infinito para o caso \n\nem que as sa\u00eddas s\u00e3o controladas por faixas e as entradas possuem targets, ou alvos, que s\u00e3o \n\nvalores de refer\u00eancia, em geral providos por um algoritmo de otimiza\u00e7\u00e3o econ\u00f4mica e \n\ndefinem o ponto \u00f3timo de opera\u00e7\u00e3o. Neste se\u00e7\u00e3o, apresenta-se a proposta de Gonzalez e \n\nOdloak (2009) e, em seguida, a extens\u00e3o realizada por Pacheco (2009) para o caso de controle \n\npor funnel das sa\u00eddas mantendo os targets para as entradas. A fun\u00e7\u00e3o objetivo do controlador \n\nIHMPC incluindo o controle por zona e metas (targets) para as entradas pode ser definida \n\ncomo se segue: \n\n \n\n \n\n \n\n                      (4.7) \n\n \n\nOnde: \n\nErro entre as sa\u00eddas e seus valores de refer\u00eancia \n\nErro entre as entradas e seus valores de refer\u00eancia \n\nTargets para as entradas \n\nMatriz peso positiva que pondera os \u201ctargets\u201d das \n\nentradas \n\nVari\u00e1vel de folga para a implementa\u00e7\u00e3o do target \n\nMatriz peso positivo que pondera as slacks dos \n\n\u201ctargets\u201d das entradas \n\n( ) ( )\n( ) ( )\n\nu\n\nnuu\nk\n\nu\n\nsp\n\nnu\nu\n\nsp\nu\n\nsp\n\nS\n\nQ\n\nu\n\neukjkukjke\n\nykjkykjke\n\n??\n\n???+=+\n\n?+=+\n\n?\n\n,\n\n( )[ ] ( )[ ] ( )[ ] ( )[ ]\n\n( ) ( ) uku\nTu\n\nk\ns\nk\n\nTs\nk\n\nj\n\nT\n\nj\n\nu\nkuu\n\nTu\nku\n\nj\n\ns\nk\n\nTs\nkk\n\nSSkjkuRkjku\n\nkjkeQkjkekjkeQkjkeV\n\n????\n\n????\n\n+++?+?+\n\n?+?++?+?+=\n\n?\n\n??\n?\n\n=\n\n?\n\n=\n\n?\n\n=\n\n1\n0\n\n00\n\n\n\n \n \n\n62 \n \n\n( )[ ] ( )[ ]\n( ){ } ( ){ }\n\n( ){ } ( ){ }\nu\nku\n\nTu\nk\n\ns\nk\n\nTs\nk\n\nk\nT\nk\n\nspsp\nk\n\nmTspsp\nk\n\nm\n\nu\nkmu\n\nsp\nmukmuu\n\nTu\nkmu\n\nsp\nmukmu\n\ns\nk\n\nsp\nk\n\nT\ns\nk\n\nsp\nkk\n\nSS\n\nuRuyIuBAkkxCAQyIuBAkkxCA\n\nIuIuNkkuIQIuIuNkkuI\n\nIyuCkkxCQIyuCkkxCV\n\n????\n\n??\n\n??\n\n++\n\n??+??+??++\n\n???+???++\n\n???+???+=\n\n1\n\n*\n\n11\n\n~~~\n\n~~~\n\n~\n\nm\n\nI\n\nI\n\nI\n\nnu\n\nnu\n\nmu\n\n?\n?\n\n?\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n= M ( )( ) nynanunynyp\nny\n\nny\n\nsp\np\n\nI\n\nI\n\nI ...1\n\n0\n\n1 ++??\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n+\n?\n?\n\n?\n?\n\n?\n\n=\nM\n\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n=\n\n44 844 76\n\nL\n\nOMM\n\nL\n\nL\n\nm\n\nnununu\n\nnunu\n\nnu\n\nIII\n\nII\n\nI\n\nN\n0\n\n0\n\n00\n\n~\n\nPara que a fun\u00e7\u00e3o objetivo definida em (4.7) seja limitada, deve-se impor a restri\u00e7\u00e3o (3.13), \n\nque garante que o primeiro somat\u00f3rio infinito seja limitado, e a seguinte restri\u00e7\u00e3o: \n\n \n\n( ) 01 =???+ ukspukmku ?      (4.8) \n \n\nA restri\u00e7\u00e3o (4.8) garante que o segundo somat\u00f3rio infinito tamb\u00e9m seja limitado. Em seguida \n\ndefinimos as seguintes matrizes que permitem representar a fun\u00e7\u00e3o objetivo de forma \n\ncompacta: \n\n \n\n             (4.9) \n\n \n\n \n\n \n\n \n\nIncluindo estas matrizes e expandindo a fun\u00e7\u00e3o objetivo (4.7) da mesma forma que foi feito \n\nna se\u00e7\u00e3o 2.2, obt\u00e9m-se: \n\n \n\n \n\n                      (4.10) \n\n \n\n \n\n \n\n\u00c9 poss\u00edvel ent\u00e3o substituir a express\u00e3o para no terceiro termo da equa\u00e7\u00e3o (4.10), \n\nobtendo o IHMPC com targets para as entradas e faixas para o controle de sa\u00eddas, definido \n\npela seguinte fun\u00e7\u00e3o objetivo: \n\n \n\n \n\n                      (4.11) \n\n \n\n \n\n \n\n \n\n( )[ ] ( )[ ]\n( ){ } ( ){ }\n( ){ } ( ){ } ukuTukskTskkTkkmTkm\n\nu\nkmu\n\nsp\nmukmuu\n\nTu\nkmu\n\nsp\nmukmu\n\ns\nk\n\nsp\nk\n\nT\ns\nk\n\nsp\nkk\n\nSSuRuuBAkkeAQuBAkkeA\n\nIuIuNkkuIQIuIuNkkuI\n\nIyuCkkxCQIyuCkkxCV\n\n????\n\n??\n\n??\n\n++??+?+?++\n\n???+???++\n\n???+???+=\n\n1\n*\n\n11\n\n~~~\n\n~~~\n\n~\n\n( )kke\n\n\n\n \n \n\n63 \n \n\nO problema de controle do IHMPC estendido com controle por zonas e targets para as \n\nentradas fica definido como: \n\n[ ]\n?\n?\n\n?\n?\n\n?\n\n?\n?\n\n?\n?\n\n?\n\n+\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n??\n\n+\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n??\n\n?\n?\n\n33,3\n,,\n\n2min c\n\nu\n\nC\n\nu\n\nHu\nu\nk\n\ns\nk\n\nk\n\nT\nf\n\nu\nk\n\ns\nk\n\nk\nTu\n\nk\n\nTs\nk\n\nT\nk\n\nu uk\ns\nkk\n\n?\n?\n\n?\n???\n\n??\n \n\nSujeito a: \n\n \n\nA matriz hessiana H3 e as matrizes Cf,3 e c3 podem ser obtidas de maneira semelhante ao \n\nprocedimento utilizado no item 4.5. \n\n \n\n4.3 \u2013 IHMPC Estendido com Funnel \n\n \n\nMaciejowski (2000) argumenta que embora seja comum representar os objetivos de controle \n\ncomo trajet\u00f3rias de refer\u00eancia que as sa\u00eddas do processos devem seguir, na maioria das \n\naplica\u00e7\u00f5es os valores exatos dessas sa\u00eddas n\u00e3o s\u00e3o relevantes, o importante \u00e9 mant\u00ea-las dentro \n\nde certos limites espec\u00edficos ou zonas. Dessa forma, uma vari\u00e1vel ter peso nulo no problema \n\nde controle enquanto se encontrar dentro desses limites. Maciejowski (2000) apresenta uma \n\nvaria\u00e7\u00e3o dessa representa\u00e7\u00e3o cl\u00e1ssica dos objetivos de controle que s\u00e3o os Funnel, ou funis, \n\nque s\u00e3o id\u00eanticos \u00e0 abordagem por zonas, exceto que se tornam mais estreitos ao longo do \n\nhorizonte de predi\u00e7\u00e3o. \n\n \n\nFigura 4.5 \u2013 Ilustra\u00e7\u00e3o do Conceito de Funnel  \n\n\n\n \n \n\n64 \n \n\nAs \u00e1reas hachuradas na figura 4.5 mostram a penaliza\u00e7\u00e3o da trajet\u00f3ria, que ocorre apenas \n\nquando esta deixa a regi\u00e3o do Funnel. \n\n \n\nPortanto, o \"funil\" (Funnel) \u00e9 um conceito cujo objetivo \u00e9 suavizar as a\u00e7\u00f5es do controlador, a \n\nfim de tornar o controle menos agressivo, ao mesmo tempo abrindo espa\u00e7o para que os \n\nobjetivos de otimiza\u00e7\u00e3o sejam cumpridos. Controlar sa\u00eddas atrav\u00e9s de funis e zonas, em vez \n\nde trajet\u00f3rias espec\u00edficas, \u00e9 uma forma de liberar graus de liberdade adicionais ao processo de \n\notimiza\u00e7\u00e3o. \n\n \n\n \n\nFigura 4.6 \u2013 Funnel sem Tempo Morto \n\n \n\n \n\nConforme representado na Fig. 4.6, \u00e9 poss\u00edvel combinar os conceitos de controle por zona, \n\nonde ao inv\u00e9s de Set-Point t\u00eam-se limites m\u00e1ximos e m\u00ednimos, com o controle por funil, \n\natrav\u00e9s da defini\u00e7\u00e3o das seguintes restri\u00e7\u00f5es para as vari\u00e1veis controladas: \n\n \n\n \n\n \n\n( ) ( ) ( ) ( )( ) m,1,2,j   ,max,max, K=???+?> iiispiii yky\nm\n\nj\nkyjkyyky\n\n( ) ( ) ( ) ( )( ) m,1,2,j   ,min,min, K=?+?+?&lt;kyy\nm\n\nj\nkyjkyyky iii\n\nsp\niii\n\n\n\n \n \n\n65 \n \n\n( )[ ] ( )[ ]\n( ){ } ( ){ }\n\n( ){ } ( ){ }\nu\nku\n\nTu\nk\n\ns\nk\n\nTs\nk\n\nk\nT\nk\n\nspsp\nk\n\nm\nTspsp\n\nk\nm\n\nu\nkmu\n\nsp\nmukmuu\n\nTu\nkmu\n\nsp\nmukmu\n\ns\nk\n\nsp\n\nk\n\nT\ns\nk\n\nsp\n\nkk\n\nSS\n\nuRuMyIuBAkkxCAQMyIuBAkkxCA\n\nIuIuNkkuIQIuIuNkkuI\n\nIyuCkkxCQIyuCkkxCJ\n\n????\n\n??\n\n??\n\n++\n\n??+??+??++\n\n???+???++\n\n???+???+=\n\n??\n\n??\n\n1\n\n* ~~~\n\n~~~\n\n~\n\nDa\u00ed, a fun\u00e7\u00e3o custo (4.11) para o IHMPC desenvolvido pode ser reescrita da seguinte forma: \n\n \n\n \n\n \n\n                (4.12) \n\n \n\n \n\n \n\n \n\nOnde: \n\n \n\n \n\n \n\n \n\nTamb\u00e9m \u00e9 conveniente definir uma matriz M como segue: \n\n \n\n \n\n \n\n \n\nDa\u00ed resulta que: \n\n( ) spsp yMknpky ?=+ /  \n \n\nObserva-se que os \u201cset-points\u201d fixos para as controladas se tornam de fato um vetor de \u201cset-\n\npoints\u201d ao longo do horizonte de predi\u00e7\u00e3o np. Finalmente, a fun\u00e7\u00e3o custo torna-se: \n\n \n\n \n\n \n\n                (4.13) \n\n \n\n \n\nPara cada intervalo de amostragem em que o problema seja resolvido, o funil define novos \n\nlimites para as sa\u00eddas. O controlador \u00e9 livre para encontrar o melhor caminho para as sa\u00eddas, \n\ndesde que se mantenham dentro dos limites determinados pelo funil. \n\n?\n?\n\n?\n\n?\n\n?\n?\n\n?\n\n?\n=\n\n44 344 21\nL\n\nnp\n\nnyIM 00\n\n( )[ ] ( )[ ]\n( ){ } ( ){ }\n\n( ) ( ){ } ( ) ( ){ }\nu\nku\n\nTu\nk\n\ns\nk\n\nTs\nkk\n\nT\nk\n\nspsp\nk\n\nmTspsp\nk\n\nm\n\nu\nkmu\n\nsp\nmukmuu\n\nTu\nkmu\n\nsp\nmukmu\n\ns\nk\n\nsp\n\nk\n\nT\ns\nk\n\nsp\n\nkk\n\nSSuRu\n\nkpkyIuBAkkxCAQkpkyIuBAkkxCA\n\nIuIuNkkuIQIuIuNkkuI\n\nIyuCkkxCQIyuCkkxCJ\n\n????\n\n??\n\n??\n\n++??+\n\n+??++??++\n\n???+???++\n\n???+???+= ??\n\n1\n\n*\n\n~\n\n~~\n\n~~~\n\n~\n\n( )\n\n( )\nnpny\n\nsp\n\nsp\n\nsp\n\nknpky\n\nkky\n\ny .\n\n/\n\n/1\n\n??\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n\n?\n\n?\n\n+\n\n+\n=? M\n\n\n\n \n \n\n66 \n \n\nSe h\u00e1 qualquer erro para a sa\u00edda do sistema no instante k, o funil determina limites para esta \n\nsa\u00edda a partir deste momento at\u00e9 ao final do horizonte de controle, k + m. O funil estabelece \n\ntais limites estabelecendo uma linha que conecta o valor atual de sa\u00edda para o alvo ou limite \n\nexcedido pela sa\u00edda (em rela\u00e7\u00e3o ao qual o erro \u00e9 calculado), k + m. \n\n \n\n \n\n \n\nFigura 4.7 \u2013 Funnel com Tempo Morto \n\n \n\n \n\nPara sistemas com tempo morto, o comportamento do funil \u00e9 mostrado na Fig. 4.7. Neste \n\ncaso, o funil limita a sa\u00edda a partir do final do tempo morto at\u00e9 o instante k + p. Esta forma de \n\nimplementa\u00e7\u00e3o assegura que o efeito do funil n\u00e3o ser\u00e1 anulado pelo tempo morto do sistema. \n\nAs restri\u00e7\u00f5es de funil para os sistemas com tempo morto se tornam: \n\n \n\n( ) ( )\nT\n\njkykjky ii\nsp\ni\n\n?\n,,2,1, K=<+  \n\n( ) ( ) ( ) ( )( ) p\nTT\n\njyky\nm\n\nj\nkykjkyyky iii\n\nsp\nii\n\nsp\ni ,,2,1,max,max, K?\n\n?\n\n?\n?\n?\n\n? +?\n?\n\n?\n?\n?\n\n? +=???+?>\n??\n\n \n\n \n\n( ) ( )\nT\n\njkykjky ii\nsp\ni\n\n?\n,,2,1, K=>+  \n\n( ) ( ) ( ) ( )( ) p\nTT\n\njkyy\nm\n\nj\nkykjkyyky iii\n\nsp\nii\n\nsp\ni ,,2,1,min,min, K?\n\n?\n\n?\n?\n?\n\n? +?\n?\n\n?\n?\n?\n\n? +=?+?+?<\n??\n\n \n\n\n\n \n \n\n67 \n \n\n4.4 - Integra\u00e7\u00e3o da Otimiza\u00e7\u00e3o Online ao Controle Preditivo  \n\n \n\nNesta se\u00e7\u00e3o \u00e9 discutida uma alternativa para se integrar o controle de processos atrav\u00e9s de \n\ncontrole preditivo multivari\u00e1vel e a otimiza\u00e7\u00e3o econ\u00f4mica em tempo real.  \n\n \n\nConforme apresentado por Porf\u00edrio (2011), uma poss\u00edvel solu\u00e7\u00e3o pode ser uma estrat\u00e9gia de \n\ncontrole integrada, numa \u00fanica camada, na qual os problemas de controle e otimiza\u00e7\u00e3o \n\necon\u00f4mica s\u00e3o resolvidos simultaneamente, na mesma fun\u00e7\u00e3o objetivo. \n\n \n\nSupondo que o objeto da otimiza\u00e7\u00e3o econ\u00f4mica possa ser dado por uma fun\u00e7\u00e3o convexa das \n\nentradas e sa\u00eddas do processo, um controlador MPC com otimiza\u00e7\u00e3o econ\u00f4mica poder\u00e1 ser \n\nobtido atrav\u00e9s da inclus\u00e3o do gradiente reduzido do objetivo econ\u00f4mico na fun\u00e7\u00e3o objetivo do \n\ncontrolador preditivo. \n\n \n\nConsiderando-se que o controle din\u00e2mico das vari\u00e1veis \u00e9 realizado por bandas, a fun\u00e7\u00e3o \n\nobjetivo torna-se: \n\n \n\n( )( ) ( )( )[ ] ( ) ( )[ ] otimotim\nm\n\nj\n\nT\nnp\n\nj\n\nspTsp\nk fPkjkuRkjkuykjkyQykjkyJ ++?+?+?+?+= ??\n\n?\n\n==\n\n1\n\n11\n\n////  \n\n \n\n \n\nAssumindo que a predi\u00e7\u00e3o para as vari\u00e1veis controladas no estado estacion\u00e1rio \n\ncorrespondentes a um determinado conjunto de valores para as entradas, u, \u00e9 representado por \n\ny\n)\n\n, ent\u00e3o a fun\u00e7\u00e3o objetivo econ\u00f4mico associada a este estado estacion\u00e1rio pode ser \n\nrepresentada por uma fun\u00e7\u00e3o gen\u00e9rica: \n\n \n\n ( )uyfF ,\n)=                           (4.14) \n\n \n\nAlterando o vetor de controle para o valor uu ?+ , a aproxima\u00e7\u00e3o de primeira ordem do \n\ngradiente da fun\u00e7\u00e3o objetivo (4.14) ser\u00e1: \n\n \n\n         u\ndu\n\nFd\n\ndu\n\ndF\n\ndu\n\ndF\n\nuuu\nuu ?+==\n\n?+\n?+ 2\n\n2\n\n?                     (4.15) \n\n\n\n \n \n\n68 \n \n\nSe n\u00e3o h\u00e1 restri\u00e7\u00f5es sobre a otimiza\u00e7\u00e3o da opera\u00e7\u00e3o, estar-se-\u00e1 procurando um ponto extremo \n\nonde 0=?+ uu? . Se o modelo rigoroso no estado estacion\u00e1rio for conhecido, a equa\u00e7\u00e3o \ndiferencial (4.15) pode ser representada da seguinte forma: \n\n \n\nu\n\nF\n\nu\n\ny\n\ny\n\nF\n\ndu\n\ndF\n\n?\n?\n\n+\n?\n?\n\n?\n?\n\n=\n)\n\n)                (4.16) \n\n \n\n2\n\n22\n\n2\n\n22\n\n2\n\n2\n\n2\n\n2\n\nu\n\nF\n\nyu\n\nF\n\nu\n\ny\n\nu\n\ny\n\ny\n\nF\n\nu\n\ny\n\nuy\n\nF\n\ny\n\nF\n\nu\n\ny\n\ndu\n\nFd\nTT\n\n?\n?\n\n+\n??\n\n?\n?\n?\n\n?\n?\n?\n\n?\n\n?\n?\n\n+\n?\n?\n\n?\n?\n\n+\n?\n?\n\n?\n?\n?\n\n?\n\n?\n?\n?\n\n?\n\n??\n?\n\n+\n?\n?\n\n?\n?\n\n?\n?\n?\n\n?\n\n?\n?\n\n= )\n))\n\n)\n\n)\n\n))\n\n)\n\n                    (4.17) \n\n \n\n \n\nDefinindo-se \nu\n\ny\n\n?\n?)\n\ncomo o ganho do processo no estado estacion\u00e1rio e o denominando Kp, e \n\nsubstituindo-se as equa\u00e7\u00f5es (4.16) e (4.17) na equa\u00e7\u00e3o (4.15), obt\u00eam-se: \n\n \n\nu\nu\n\nF\n\nyu\n\nF\nK\n\nu\n\ny\n\ny\n\nF\nK\n\nuy\n\nF\nK\n\ny\n\nF\nK\n\nu\n\nF\n\nu\n\ny\n\ny\n\nF T\nppp\n\nT\npuu ??\n\n?\n\n?\n?\n?\n\n?\n\n?\n?\n\n+\n??\n\n?\n+??\n?\n\n?\n??\n?\n\n?\n\n?\n?\n\n?\n?\n\n+\n??\n\n?\n+\n\n?\n?\n\n+?\n?\n\n?\n?\n?\n\n?\n\n?\n?\n\n+\n?\n?\n\n?\n?\n\n=?+ 2\n22\n\n2\n\n22\n\n2\n\n2\n\n)\n\n)\n\n)))\n\n)\n\n)?     (4.18) \n\n \n\n \n\nOu ainda: \n\n \n\nuGduu ?+=?+?  \n \n\nOnde: \n\n \n\n?\n?\n\n?\n?\n?\n\n?\n\n?\n?\n\n+\n??\n\n?\n+??\n?\n\n?\n??\n?\n\n?\n\n?\n?\n\n?\n?\n\n+\n??\n\n?\n+\n\n?\n?\n\n=\n\n?\n?\n\n?\n?\n?\n\n?\n\n?\n?\n\n+\n?\n?\n\n?\n?\n\n=\n\n2\n\n22\n\n2\n\n22\n\n2\n\n2\n\nu\n\nF\n\nyu\n\nF\nK\n\nu\n\ny\n\ny\n\nF\nK\n\nuy\n\nF\nK\n\ny\n\nF\nKG\n\nu\n\nF\n\nu\n\ny\n\ny\n\nF\nd\n\nT\nppp\n\nT\np )\n\n)\n\n)))\n\n)\n\n)\n\n \n\n \n\n \n\n\n\n \n \n\n69 \n \n\nDado o horizonte de controle m, a varia\u00e7\u00e3o na fun\u00e7\u00e3o econ\u00f4mica seria calculada pela equa\u00e7\u00e3o \n\n(4.19): \n\n \n\n[ ]\n\n( )\n( )\n\n( )?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?+?\n\n+?\n\n?\n\n+=?+\n\nkmku\n\nkku\n\nkku\n\nGGGduu\n\n1\n\n1\n\nM\nL?                     (4.19) \n\n \n\nO vetor gradiente representado na equa\u00e7\u00e3o (4.19) acima pode ser interpretado como um vetor \n\nde erros em rela\u00e7\u00e3o a um \"setpoint\", cujo ponto \u00f3timo corresponde a zero. Assim, zerar este \n\nvetor deve ser um dos objetivos do controlador. Esse conjunto de equa\u00e7\u00f5es de erro pode ser \n\ninclu\u00eddo na fun\u00e7\u00e3o objetivo do algoritmo MPC. Assim, a fun\u00e7\u00e3o objetivo torna-se: \n\n \n\n \n\n( )( ) ( )( )[ ] ( ) ( )[ ] uuotimuuT\nm\n\nj\n\nT\nnp\n\nj\n\nspTsp\nk PkjkuRkjkuykjkyQykjkyJ ?+?+\n\n?\n\n==\n\n++?+?+?+?+= ?? ??\n1\n\n11\n\n \n\nOu ainda: \n\n \n\n( )( ) ( )( )[ ] ( ) ( )[ ]\n[ ] [ ]uGdPuGd\n\nkjkuRkjkuykjkyQykjkyJ\n\notim\nT\n\nm\n\nj\n\nT\nnp\n\nj\n\nspTsp\nk\n\n?+?++\n\n++?+?+?+?+= ??\n?\n\n==\n\n1\n\n11  \n\n \n\n \n\n4.5 \u2013 IHMPC - Estendido com \u201cFunil\u201d e Otimizador Online com Targets  \n\n \n\nEmbora n\u00e3o se deseje trabalhar simultaneamente com otimiza\u00e7\u00e3o online e com targets para as \n\nvari\u00e1veis manipuladas, uma vez que ambos servem ao mesmo prop\u00f3sito de otimizar a planta \n\nde processo e n\u00e3o faz sentido fornecer dois objetivos para que isso ocorra, ser\u00e1 gerado um \n\nalgoritmo contendo ambas as caracter\u00edsticas. Pode-se, de qualquer forma, desativar facilmente \n\na otimiza\u00e7\u00e3o online ou os targets ao tornar nulas suas respectivas matrizes de peso na fun\u00e7\u00e3o \n\nobjetivo.   \n\n \n\n\n\n \n \n\n70 \n \n\nSomando-se numa \u00fanica fun\u00e7\u00e3o objetivo todas as caracter\u00edsticas apresentadas nas se\u00e7\u00f5es \n\nanteriores, obt\u00e9m-se: \n\n \n\n( )[ ] ( )[ ]\n( ){ } ( ){ }\n\n( ){ } ( ){ }\n[ ] [ ]kotimTkuku\n\nTu\nk\n\ns\nk\n\nTs\nkK\n\nT\nk\n\nspsp\nk\n\nm\nTspsp\n\nk\nm\n\nu\nkmu\n\nsp\nmukmuu\n\nTu\nkmu\n\nsp\nmukmu\n\ns\nk\n\nsp\n\nk\n\nT\ns\nk\n\nsp\n\nkk\n\nuGdPuGdSSuRu\n\nyMIuBAkkxCAQyMIuBAkkxCA\n\nIuIuNkkuIQIuIuNkkuI\n\nIyuCkkxCQIyuCkkxCJ\n\n?+?++++??+\n\n??+??++\n\n???+???++\n\n???+???+=\n\n??\n\n??\n\n????\n\n??\n\n??\n\n1\n\n*\n\n~\n\n~~\n\n~~~\n\n~\n\n     (4.20) \n\n \n\n \n\nComo antes, esta fun\u00e7\u00e3o objetivo (4.20) estar\u00e1 sujeita \u00e0s seguintes restri\u00e7\u00f5es: \n\n \n\n \n\n \n\nEstar\u00e1 sujeita tamb\u00e9m \u00e0s restri\u00e7\u00f5es que definem o Funil: \n\n( ) ( )\nT\n\njkykjky ii\nsp\ni\n\n?\n,,2,1, K=<+  \n\n( ) ( ) ( ) ( )( ) p\nTT\n\njyky\nm\n\nj\nkykjkyyky iii\n\nsp\nii\n\nsp\ni ,,2,1,max,max, K?\n\n?\n\n?\n?\n?\n\n? +?\n?\n\n?\n?\n?\n\n? +=???+?>\n??\n\n \n\n \n\n( ) ( )\nT\n\njkykjky ii\nsp\ni\n\n?\n,,2,1, K=>+  \n\n( ) ( ) ( ) ( )( ) p\nTT\n\njkyy\nm\n\nj\nkykjkyyky iii\n\nsp\nii\n\nsp\ni ,,2,1,min,min, K?\n\n?\n\n?\n?\n?\n\n? +?\n?\n\n?\n?\n?\n\n? +=?+?+?<\n??\n\n \n\n \n\n\n\n \n \n\n71 \n \n\nAgora a fun\u00e7\u00e3o objetivo (4.20) ser\u00e1 posta em forma quadr\u00e1tica, possibilitando a utiliza\u00e7\u00e3o de \n\nalgoritmos num\u00e9ricos para problemas de programa\u00e7\u00e3o quadr\u00e1tica na obten\u00e7\u00e3o da solu\u00e7\u00e3o do \n\nproblema. Desenvolvendo o primeiro termo: \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nAnalogamente, desenvolvendo o segundo termo t\u00eam-se: \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nDesenvolvendo o terceiro termo: \n\n \n\n \n\n \n\n \n\n \n\n \n\nE, por fim, desenvolvendo os demais termos: \n\n \n\n \n\n \n\n \n\n( )[ ] ( )[ ]\n( ) ( ) ( ) ( )\n\n( ) ( )\n( )\n\n( ) skT\nTs\n\nk\n\nspTTs\nkk\n\nTTs\nk\n\nTTs\nk\n\nspTsp\n\nk\n\nTspTsps\nk\n\nT\nT\n\nk\n\nspTT\nkk\n\nT\nT\n\nk\n\nT\nT\n\nk\ns\nk\n\nTT\n\nspTT\n\nk\nTTTT\n\ns\nk\n\nsp\n\nk\n\nT\ns\nk\n\nsp\n\nk\n\nIQIyQIuCQIkkxCQI\n\nyQyuCQykkxCQyIQCu\n\nyQCuuCQCukkxCQCuIQCkkx\n\nyQCkkxuCQCkkxkkxCQCkkx\n\nIyuCkkxCQIyuCkkxC\n\n?????\n\n?\n\n?\n\n??\n\n~~~~\n\n~~~~\n\n~~~~\n\n~~~\n\n~\n\n++???\n\n+?????\n\n????+?+?\n\n??+\n\n=???+???+\n\n?\n\n????\n\n?\n\n?\n\n??\n\n( ){ } ( ){ }\n( ) ( ) ( ) ( ) ( )\n\n( )\n( )\n( ) ukmuuTmu\n\nTu\nk\n\nsp\nmuu\n\nT\nmu\n\nTu\nkku\n\nT\nmu\n\nTu\nkmuu\n\nT\nmu\n\nTu\nk\n\nu\nkmuu\n\nT\nmu\n\nTspsp\nmuu\n\nT\nmu\n\nTsp\nku\n\nT\nmu\n\nTsp\nmuu\n\nT\nmu\n\nTsp\n\nu\nkmuu\n\nTT\nk\n\nsp\nmuu\n\nTT\nkku\n\nTT\nkmuu\n\nTT\nk\n\nu\nkmuu\n\nT\nmu\n\nTsp\nmuu\n\nT\nmu\n\nT\n\nku\nT\n\nmu\n\nT\n\nmuu\nT\n\nmu\n\nT\n\nu\nkmu\n\nsp\nmukmuu\n\nTu\nkmu\n\nsp\nmukmu\n\nIQIuIQIuNQIkkuIQI\n\nIQIuuIQIuuNQIukkuIQIu\n\nIQNuuIQNuuNQNukkuIQNu\n\nIQIkkuuIQIkkuuNQIkkukkuIQIkku\n\nIuIuNkkuIQIuIuNkkuI\n\n?????\n\n?\n\n?\n\n?\n\n??\n\n~~~~~\n\n~~~~~\n\n~~~~~~~~~\n\n~~~~~\n\n~~~\n\n++???\n\n++???\n\n??????+?+\n\n???+\n\n=???+???+\n\n( ){ } ( ){ }\n( ) ( ) ( ) ( )\n\n( )\n( ) spspTspTTk\n\nTspTTmTspTT\n\nspspTTT\nkk\n\nTTT\nk\n\nmTTT\nk\n\nspspTmTT\nk\n\nTmTTmTmTT\n\nspsp\nk\n\nm\nTspsp\n\nk\nm\n\nyMIQIMyuBAQIMykkxCAQIMy\n\nyMIQABuuBAQABukkxCAQABu\n\nyMIQACkkxuBAQACkkxkkxCAQACkkx\n\nyMIuBAkkxCAQyMIuBAkkxCA\n\n????\n\n?\n\n?\n\n??\n\n+???\n\n????+?+\n\n??+\n\n=??+??+\n\n***\n\n***\n\n***\n\n*\n\n~\n\n~~~~\n/\n\n~\n\n~~\n\n[ ] [ ]\n\nkotim\nTT\n\nkotim\nTT\n\nk\n\nkotim\nT\n\notim\nTu\n\nku\n\nTu\nk\n\ns\nk\n\nTs\nkk\n\nT\nk\n\nkotim\nT\n\nk\nu\nku\n\nTu\nk\n\ns\nk\n\nTs\nkk\n\nT\nk\n\nuGPGudPGu\n\nuGPddPdSSuRu\n\nuGdPuGdSSuRu\n\n??+?+\n\n?++++??\n\n=?+?++++??\n\n????\n\n????\n\n1\n\n1\n\n~\n\n~\n\n\n\n \n \n\n72 \n \n\nAgora \u00e9 poss\u00edvel agrupar adequadamente todos os termos da fun\u00e7\u00e3o objetivo na seguinte \n\nforma quadr\u00e1tica: \n\n \n\n \n\n \n\n \n\n \n\n \n\n  \n\nOnde: \n\n \n\nOnde: \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n4\n\n4,4\n\n3,4\n\n2,4\n\n1,4\n\n44342414\n\n34332313\n\n24232212\n\n14131211\n\n2 c\ny\n\nu\n\nC\n\nC\n\nC\n\nC\n\ny\n\nu\n\nHHHH\n\nHHHH\n\nHHHH\n\nHHHH\n\nyuJ\n\nu\nk\n\ns\nk\n\nsp\n\nk\n\nf\n\nf\n\nf\n\nf\n\nu\nk\n\ns\nk\n\nsp\n\nk\n\nTTT\n\nTT\n\nT\nTu\n\nk\n\nTs\nk\n\nTspT\nkk +\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n? ?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n+\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n? ?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n??\n?\n\n??\n? ?=\n\n??\n?\n\n?\n?\n\n?\n?\n\n??\n\nmuu\nT\n\nT\n\nspTT\nT\n\notim\nTTT\n\nu\nT\n\nT\n\nIQNH\n\nIQCH\n\nMIQABQCH\n\nGPGRBAQABNQNCQCH\n\n~~\n\n~\n\n~~\n\n~~~~~~~\n\n14\n\n13\n\n*\n12\n\n*\n11\n\n=\n\n?=\n\n??=\n\n++++=\n\n( ) ( ) ( )\n( ) ( )\n( )\n( )\n\n( ) ( ) ( ) ( ) ( )\n( ) ( ) ( ) dPdkkxACQACkkxuIQIukkuIQIu\n\nuIQIkkukkuIQIkkukkxCQCkkxc\n\nIQIuIQIkkuC\n\nIQCkkxC\n\nMIQACkkxQCkkxC\n\nGPdNQIuNQIkkuBAQACkkxCQCkkxC\n\nIQH\n\nMIQIMQH\n\notim\nTmTmTTsp\n\nmuu\nT\n\nmu\n\nTsp\nmuu\n\nT\nmu\n\nTsp\n\nsp\nmuu\n\nT\nmu\n\nT\n\nmuu\nT\n\nmu\n\nTTT\n\nmuu\nT\n\nmu\n\nTsp\nmuu\n\nT\nmu\n\nT\n\nf\n\nTT\n\nf\n\nspTmTTTT\n\nf\n\notim\nT\n\nu\nT\n\nmu\n\nTsp\nu\n\nT\nmu\n\nTTmTTTT\n\nf\n\nspTspT\n\n+++?\n\n?+=\n\n+?=\n\n?=\n\n??=\n\n+?++=\n\n=\n\n+=\n\n*\n\n4\n\n4,4\n\n3,4\n\n*\n2,4\n\n*\n1,4\n\n23\n\n*\n22\n\n~~\n\n~~~\n\n~~\n\n~\n/\n\n~\n\n~~~~~\n/\n\n~\n\n~\n\n~\n\n\n\n \n \n\n73 \n \n\nO par\u00e2metro c4 \u00e9 a constante da fun\u00e7\u00e3o objetivo dos problemas de programa\u00e7\u00e3o quadr\u00e1tica. A \n\nmatriz Hessiana da fun\u00e7\u00e3o objetivo, H4, \u00e9 definida por: \n\n \n\n \n\n \n\n \n\n \n\n \n\nE a matriz auxiliar da fun\u00e7\u00e3o objetivo, Cf4, \u00e9 dada por: \n\n \n\n \n\n \n\n \n\n \n\n \n\nDessa forma o problema de controle do IHMPC estendido com \u201cFunil\u201d, Otimizador Online e \n\ntargets na forma quadr\u00e1tica fica definido como: \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nEsse controlador possui todas as caracter\u00edsticas necess\u00e1rias para realizar o controle e \n\notimiza\u00e7\u00e3o de processos de unidades de UHDT. Ele \u00e9 capaz de lidar com os grandes tempos \n\nmortos existentes nesse processo, atuando mais lentamente e liberando graus de liberdade \n\npara a execu\u00e7\u00e3o da otimiza\u00e7\u00e3o devido ao controle por Funil, e pode otimizar a planta tanto \n\natrav\u00e9s de \u201ctargets\u201d fornecidos por uma camada de otimiza\u00e7\u00e3o baseada na simula\u00e7\u00e3o est\u00e1tica \n\nde um modelo rigoroso, ou ent\u00e3o por otimiza\u00e7\u00e3o online acoplada \u00e0 camada de controle. \u00c9 \n\nnecess\u00e1rio optar por uma entre as duas \u00faltimas op\u00e7\u00f5es, ou seja, utilizar num dado momento \n\napenas um tipo de otimiza\u00e7\u00e3o.  \n\n \n\n?\n?\n\n?\n\n?\n?\n\n?\n\n?\n\n?\n?\n\n?\n\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n? ?\n\n+\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n? ?\n\n??\n?\n\n??\n? ?\n\n??\n?\n\n? ?\n\nu\nk\n\ns\nk\n\nsp\n\nk\n\nf\n\nu\nk\n\ns\nk\n\nsp\n\nk\n\nTu\nk\n\nTs\nk\n\nTspT\nK\n\nyu\n\ny\n\nu\n\nC\ny\n\nu\n\nHyu\nu\nk\n\ns\nk\n\nsp\nk\n\n?\n?\n\n?\n?\n\n??\n??\n\n4,4 2min\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n=\n\n44342414\n\n34332313\n\n24232212\n\n14131211\n\n4\n\nHHHH\n\nHHHH\n\nHHHH\n\nHHHH\n\nH\n\nTTT\n\nTT\n\nT\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n=\n\n4,4\n\n3,4\n\n2,4\n\n1,4\n\n4\n\nf\n\nf\n\nf\n\nf\n\nf\n\nC\n\nC\n\nC\n\nC\n\nC\n\n\n\n \n \n\n74 \n \n\nOu seja, no caso da unidade de processo contar com um software otimizador em tempo real \n\n(RTO) cujos resultados formam um conjunto de \u201ctargets\u201d para as vari\u00e1veis manipuladas e \n\ncontroladas, e este estiver obtendo converg\u00eancia adequada e resultados coerentes, n\u00e3o haver\u00e1 \n\nnecessidade de acionar a otimiza\u00e7\u00e3o online acoplada \u00e0 camada de controle, pois esta \u00e9 menos \n\nprecisa. \n\n \n\nEntretanto, quando o simulador est\u00e1tico n\u00e3o for capaz de convergir com a rapidez necess\u00e1ria, \n\no que de fato \u00e9 uma ocorr\u00eancia bastante frequente, levando-se em conta que o tempo entre \n\nduas tentativas subsequentes de converg\u00eancia de um RTO pode ser bastante longo, \n\nusualmente 2 a 5 horas, a otimiza\u00e7\u00e3o online acoplada \u00e0 camada de controle poder\u00e1 ser \n\nutilizada para conduzir o processo ao \u00f3timo econ\u00f4mico na indisponibilidade de resultados \n\nvindos da camada de RTO. Uma discuss\u00e3o aprofundada da otimiza\u00e7\u00e3o em tempo real e \n\nestrat\u00e9gias de otimiza\u00e7\u00e3o pode ser encontrada em Rotava e Zanin (2005) e Zanin, Gouv\u00eaa e \n\nOdloak (2000). \n\n \n\n  \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n\n\n \n \n\n75 \n \n\n5 \u2013 Estudo de Caso \u2013 Simula\u00e7\u00e3o de uma UHDT \n\n \n\nPara testar a efic\u00e1cia do controlador desenvolvido na se\u00e7\u00e3o 4 na solu\u00e7\u00e3o do problema \n\nproposto (controle e otimiza\u00e7\u00e3o econ\u00f4mica de unidades de processo UHDT), foram realizadas \n\nsimula\u00e7\u00f5es computacionais para se obter a resposta do processo em malha fechada, para \n\nmodelos sem incerteza e tamb\u00e9m para modelos com incerteza. Ou seja, num primeiro \n\nmomento, o pr\u00f3prio modelo do controlador foi utilizado para gerar a resposta do sistema, o \n\nque equivale a supor que o modelo \u00e9 perfeito, e posteriormente um modelo diferente foi \n\nutilizado, isto \u00e9, um modelo imperfeito. \n\n \n\nPara realizar este teste, de acordo com as premissas descritas na se\u00e7\u00e3o introdut\u00f3ria do presente \n\ntrabalho (se\u00e7\u00e3o 1), foram selecionadas as seguintes vari\u00e1veis de processo de uma UHDT, que \n\ns\u00e3o as mais significativas para a estrat\u00e9gia de controle empregada no presente trabalho: \n\n \n\nVari\u00e1veis controladas: \n\n  \n\n y(1) \u2013 WABT (\u201cWeighted Average Bed Temperature\u201d) total da rea\u00e7\u00e3o (\u00baC); \n\n y(2) \u2013 Enxofre no diesel (ppm); \n\n y(3) \u2013 vaz\u00e3o total de inst\u00e1veis (LCO + gas\u00f3leo de coque) (m3/d); \n\n y(4) \u2013 excesso de H2 na rea\u00e7\u00e3o (kNm\n3/d) (vaz\u00e3o corrigida para 100 kPa e 0 \u00baC); \n\n y(5) \u2013 press\u00e3o de H2 da PSA para o Compressor C-02 (kgf/cm\n2); \n\n \n\n \n\nVari\u00e1veis manipuladas: \n\n  \n\n u(1) \u2013 volume de carga da unidade (m3/d); \n\n u(2) \u2013 vaz\u00e3o de LCO (\u201cLight Cycle Oil\u201d) (m3/d); \n\n u(3) \u2013 temperatura de Sa\u00edda do Forno (\u00baC); \n\n u(4) \u2013 temperatura de Entrada R1L2 (\u00baC); \n\n u(5) \u2013 temperatura de Entrada R2L1 (\u00baC); \n\n u(6) \u2013 temperatura de Entrada R2L2 (\u00baC); \n\n \n\n \n\n\n\n \n \n\n76 \n \n\nO filtro de Kalman foi adotado para as corre\u00e7\u00f5es dos estados com a leitura da planta, \n\nconforme a Equa\u00e7\u00e3o (2.6). O filtro foi sintonizado para garantir que todos os autovalores da \n\nmatriz [ ]ACKI F?  sejam pertencentes ao c\u00edrculo unit\u00e1rio [-1,1], resultando em p\u00f3los \nest\u00e1veis do sistema em malha fechada. \n\n \n\nAs vari\u00e1veis est\u00e3o correlacionadas entre si pelos modelos de fun\u00e7\u00e3o de transfer\u00eancia cont\u00ednua \n\nque est\u00e3o representados na Tabela 5.1. Estes modelos representam a din\u00e2mica real de uma \n\nplanta de processo quando o conjunto de vari\u00e1veis n\u00e3o est\u00e1 muito distante do estado \n\nestacion\u00e1rio. O objetivo destes testes iniciais foi o de observar se o controlador \u00e9 \n\nnumericamente consistente e operacional, quando submetido a testes com situa\u00e7\u00f5es que \n\ncorrespondem com precis\u00e3o \u00e0s situa\u00e7\u00f5es que se encontram na pr\u00e1tica em plantas de \n\nhidrotratamento de diesel.   \n\n \n\nTabela 5.1 \u2013 Modelos do Processo em Fun\u00e7\u00e3o de Transfer\u00eancia Cont\u00ednua (tempo em minutos) \n\n  y(1) y(2) y(3) y(4) y(5) \n\nu(1)   \n \n\n13\n\n074,0\n\n+s\n \n\n  \n \n\nse\ns\n\n20\n\n115\n\n04,0 ?\n+\n\n?\n  \n\nse\ns\n\n20\n4\n\n115\n\n10 ?\n?\n\n+\n?\n\n \n\nu(2)   13\n\n1,0\n\n+s\n   \n\n13\n\n1\n\n+s\n \n\nse\ns\n\n20\n\n115\n\n6,0 ?\n+\n\n?\n  \n\nse\ns\n\ns 15\n2 17,27192\n\n00348,01009,0 ?\n++\n\n??\n  \n\nu(3) \n \n\nse\nss\n\ns 14\n2 19,22131\n\n444,063,11 ?\n++\n\n+\n \n\n16\n\n25,1\n\n+\n?\n\ns\n  \n\n  \n\nse\ns\n\n10\n\n116\n2,0 ?\n\n+\n?\n\n   \nse\n\ns\n10\n\n116\n\n0024,0 ?\n+\n\n?\n \n\nu(4) \nse\n\nss\n\ns 3\n2 125150\n\n328,0545,9 ?\n++\n\n+\n  \n\n16\n\n25,1\n\n+\n?\n\ns\n  \n\n  \n\nse\ns\n\n10\n\n116\n\n2,0 ?\n+\n\n?\n  \n\nse\ns\n\n10\n\n116\n\n0024,0 ?\n+\n\n?\n  \n\nu(5) \n \n\nse\nss\n\ns 3\n2 138361\n\n415,056,15 ?\n++\n\n+\n  \n\n16\n\n25,1\n\n+\n?\n\ns\n \n\n  \n\nse\ns\n\n10\n\n116\n\n2,0 ?\n+\n\n?\n  \n\nse\ns\n\n10\n\n116\n\n0024,0 ?\n+\n\n?\n  \n\nu(6) \n \n\nse\nss\n\ns 3\n2 135303\n\n415,049,13 ?\n++\n\n+\n  \n\n16\n\n25,1\n\n+\n?\n\ns\n \n\n  \n \n\nse\ns\n\n10\n\n116\n\n2,0 ?\n+\n\n?\n \n\nse\ns\n\n10\n\n116\n\n0024,0 ?\n+\n\n?\n  \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n\n\n \n \n\n77 \n \n\n5.1 - Otimiza\u00e7\u00e3o Online para a UHDT  \n\n \n\nConforme discutido anteriormente. Os maiores ganhos da otimiza\u00e7\u00e3o de uma planta de \n\nHidrotratamento de Diesel s\u00e3o obtidos ao se aumentar a vaz\u00e3o de carga total da unidade, \n\naumentar a propor\u00e7\u00e3o de correntes inst\u00e1veis na carga, e ao mesmo tempo manter a \n\nconcentra\u00e7\u00e3o de enxofre no diesel dentro das especifica\u00e7\u00f5es e o perfil de temperaturas dos \n\nleitos catal\u00edticos dos reatores dentro dos limites requeridos pelo catalisador. Ou seja: \n\n \n\n\u2022 Maximizar a carga total da unidade at\u00e9 o limite operacional   ( ){ }21max,1min uu ??  \n \n\n\u2022 Maximizar a propor\u00e7\u00e3o de correntes inst\u00e1veis na carga (LCO) at\u00e9 o limite operacional   \n\n( ){ }22max,2min uu ?? ; \n \n\nUsando a nomenclatura do item anterior, pode-se definir a seguinte fun\u00e7\u00e3o objetivo \n\necon\u00f4mica: \n\n \n\n( ) ( )22max,221max,1 uuuuF ?+?= ??                          (5.1) \n \n\nOnde ?? , s\u00e3o constantes. Expandindo a equa\u00e7\u00e3o (5.1): \n2\n\n22max,2\n2\n\nmax,2\n2\n\n11max,1\n2\n\nmax,1 22 uuuuuuuuF ?????? +?++?=                                      (5.2) \n\n \n\n \n\nComo F depende apenas do conjunto de vari\u00e1veis manipuladas, u, pode-se simplificar as \n\nequa\u00e7\u00f5es (4.16) e (4.17) como segue: \n\n \n\n?\n?\n\n?\n?\n?\n\n?\n\n?\n?\n\n=?\n?\n\n?\n?\n?\n\n?\n\n?\n?\n\n=\n2\n\n2\n\nu\n\nF\nG\n\nu\n\nF\nd  \n\n \n\nPara o modelo da UHDT, \u00e9 obtido: \n\n \n\n\n\n \n \n\n78 \n \n\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n\n?\n?\n\n?\n?\n\n?\n?\n\n?\n?\n\n?\n?\n\n?\n?\n\n?\n?\n\n?\n?\n\n?\n?\n\n?\n?\n\n?\n?\n\n=?\n?\n\n?\n?\n?\n\n?\n\n?\n?\n\n=\n\n?\n?\n\n?\n?\n?\n\n?\n\n?\n?\n\n?\n?\n\n?\n?\n\n?\n?\n\n?\n?\n\n?\n?\n\n=?\n?\n\n?\n?\n?\n\n?\n\n?\n?\n\n=\n\n2\n6\n\n2\n\n56\n\n2\n\n46\n\n2\n\n36\n\n2\n\n26\n\n2\n\n6\n\n2\n\n61\n\n2\n\n51\n\n2\n\n41\n\n2\n\n31\n\n2\n\n21\n\n2\n\n2\n1\n\n2\n\n2\n\n2\n\n654321\n\n1\n\n,\n\nu\n\nF\n\nuu\n\nF\n\nuu\n\nF\n\nuu\n\nF\n\nuu\n\nF\n\nuu\n\nF\n\nuu\n\nF\n\nuu\n\nF\n\nuu\n\nF\n\nuu\n\nF\n\nuu\n\nF\n\nu\n\nF\n\nu\n\nF\nG\n\nu\n\nF\n\nu\n\nF\n\nu\n\nF\n\nu\n\nF\n\nu\n\nF\n\nu\n\nF\n\nu\n\nF\nd\n\nMMMMMM  \n\nDada a defini\u00e7\u00e3o da fun\u00e7\u00e3o objetivo econ\u00f4mico, os termos n\u00e3o nulos s\u00e3o: \n\n \n\n2max,2\n2\n\n1max,1\n1\n\n22\n\n22\n\nuu\nu\n\nF\n\nuu\nu\n\nF\n\n??\n\n??\n\n+?=\n?\n?\n\n+?=\n?\n?\n\n \n\n?\n\n?\n\n2\n\n2\n\n2\n2\n\n2\n\n2\n1\n\n2\n\n=\n?\n?\n\n=\n?\n?\n\nu\n\nF\n\nu\n\nF\n\n \n\n \n\nConsiderando-se os pesos da otimiza\u00e7\u00e3o da carga total e da vaz\u00e3o de inst\u00e1veis iguais \u00e0 1, ou \n\nseja, 1== ?? , obt\u00e9m-se: \n\n \n\n \n\n \n\nEstes par\u00e2metros definem a fun\u00e7\u00e3o de Otimiza\u00e7\u00e3o Online para o presente estudo de caso.  \n\n \n\n5.2 \u2013 Simula\u00e7\u00f5es e Resultados \n\n \n\nO seguinte conjunto de par\u00e2metros de sintonia ser\u00e1 utilizado em todos os estudos de caso, a \n\nmenos que se fa\u00e7a men\u00e7\u00e3o em contr\u00e1rio: \n\n \n\nLimites m\u00e1ximos e m\u00ednimos para as Vari\u00e1veis Controladas: \n\n \n\ny1,min = 357;  y1,max = 377; \n\ny2,min = 29,4;  y2,max = 49,4; \n\ny3,min = 1976;  y3,max = 1996; \n\ny4,min = 18,4;  y4,max = 38,4; \n\ny5,min = 9,5;  y5,max = 29,5; \n\n[ ]\n[ ]( )0,0,0,0,2,2\n\n0,0,0,0,22,22 2max,21max,1\ndiagG\n\nuuuud\n\n=\n+?+?=\n\n\n\n \n \n\n79 \n \n\nLimites m\u00e1ximos e m\u00ednimos para as Vari\u00e1veis Manipuladas: \n\n \n\nu1,min = 5000;  u1,max = 6000; \n\nu2,min = 800;  u2,max = 1000; \n\nu3,min = 363;  u3,max = 403; \n\nu4,min = 363;  u4,max = 403; \n\nu5,min = 369;  u5,max = 409; \n\nu6,min = 371;  u6,max = 411; \n\n \n\nVaria\u00e7\u00e3o m\u00e1xima de cada vari\u00e1vel manipulada: dumax = [0,01*[ umax - umin]]; \n\n \n\nPer\u00edodo de amostragem (minutos): T = 1; \n\n \n\nHorizonte de controle: m = 1; \n\n \n\nHorizonte de predi\u00e7\u00e3o para inclus\u00e3o dos tempos mortos: np = 22; \n\n \n\nVetor de supress\u00e3o das varia\u00e7\u00f5es das manipuladas: R = [1200 300 3600 3600 3600 3600]; \n\n \n\nVetor de peso das controladas: Q = [0,50   2,00   0,50   1,00   1,00]; \n\n \n\nVetor de peso dos Targets: uQ\n~\n\n = [0 0 0 0 0 0]; \n\n \n\nMatriz de pesos das vari\u00e1veis de folga s\nk? : S1=1000,0; \n\n \n\nMatriz de pesos das vari\u00e1veis de folga u\nk? : Su=0,0; \n\n \n\nEstado estacion\u00e1rio das vari\u00e1veis controladas em unidades de engenharia: \n\n yo_ss = [367  39,4  1986  28,4  19,5]; \n\n \n\nEstado estacion\u00e1rio das vari\u00e1veis manipuladas em unidades de engenharia: \n\n uo_ss = [5500   900   383   383   389   391]; \n\n \n\n\n\n \n \n\n80 \n \n\nPeso da fun\u00e7\u00e3o de Otimiza\u00e7\u00e3o Online na resolu\u00e7\u00e3o do problema de controle: \n\n \n\nPotim = diag([0,0    0,0    0,0    0,0    0,0   0,0)]; \n\n \n\nO vetor de pesos da fun\u00e7\u00e3o objetivo de otimiza\u00e7\u00e3o online Potim foi zerado no caso base \n\nporque neste n\u00e3o inclui otimiza\u00e7\u00e3o online.  \n\n  \n\n5.2.1 \u2013 Estudo de Caso 1 \u2013 Mudan\u00e7as nas Faixas Operacionais de WABT e Teor de \n\nEnxofre, modelo sem incerteza \n\n \n\nNesta simula\u00e7\u00e3o ocorrem duas mudan\u00e7as sequenciais nas faixas operacionais das vari\u00e1veis \n\nWABT (y1) e teor de enxofre no produto (y2). Os limites m\u00e1ximos e m\u00ednimos das vari\u00e1veis \n\nforam mudados da seguinte forma nos instantes k = 2 e k=150: \n\n \n\nPara k =2: \n\n \n\ny1,min = 369,5;  y1,max = 377,0; \n\ny2,min = 29,4;  y2,max = 35,4; \n\n \n\n \n\n \n\nPara k =150: \n\ny1,min = 357,0;  y1,max = 366,0; \n\ny2,min = 41,4;  y2,max = 45,4; \n\n \n\n \n\nOs resultados dessas altera\u00e7\u00f5es se encontram nas figuras 5.1, 5.2, 5.3, 5.4 e 5.5: \n\n \n\n \n\n\n\n \n \n\n81 \n \n\n \n\nFigura 5.1 \u2013 Estudo de Caso 1 \u2013 Vari\u00e1veis Controladas (y1 \u2013 WABT [\u00baC]; y2 \u2013 Enxofre \n\n[ppm]; y3 \u2013 Total de Inst\u00e1veis [m\n3/d]) \n\n \n\n \n\nFigura 5.2 \u2013 Estudo de Caso 1 \u2013 Vari\u00e1veis Controladas (y4 \u2013 Excesso de H2 [kNm\n3/d]; \n\ny5 \u2013 Press\u00e3o de H2 para C-02  [kgf/cm\n2]) \n\n\n\n \n \n\n82 \n \n\n \n\nFigura 5.3 \u2013 Estudo de Caso 1 \u2013 Vari\u00e1veis Manipuladas (u1 \u2013 Carga [m\n3/d]; u2 \u2013 Vaz\u00e3o de \n\nInst\u00e1veis [m3/d]; u3 \u2013 T. Sa\u00edda do Forno [\u00baC]) \n\n \n\n \n\nFigura 5.4 \u2013 Estudo de Caso 1 \u2013 Vari\u00e1veis Manipuladas (u4 \u2013 T. Entrada R1L2 [\u00baC]; u5 \u2013 T. \n\nEntrada R2L1 [\u00baC]; u6 \u2013 T. Entrada R2L2 [\u00baC]) \n\n\n\n \n \n\n83 \n \n\n \n\nFigura 5.5 \u2013 Estudo de Caso 1 \u2013 Evolu\u00e7\u00e3o do Valor Total da Fun\u00e7\u00e3o Objetivo \n\n \n\n \n\nNo instante k=2, conforme se pode observar na figura 5.1, a faixa operacional do teor de \n\nenxofre teve seus limites m\u00e1ximo e m\u00ednimo reduzidos. O controlador atuou elevando as \n\ntemperaturas de entrada nos leitos de rea\u00e7\u00e3o (u3, u4, u5, u6), como se v\u00ea nas figuras 5.3 e 5.4. \n\nPercebe-se que a eleva\u00e7\u00e3o dessas temperaturas foi al\u00e9m da necess\u00e1ria para atingir a redu\u00e7\u00e3o \n\nno teor de enxofre, pois tamb\u00e9m tiveram o objetivo de atingir o valor m\u00ednimo de WABT. \n\n \n\n \n\nNo instante k=150, ocorreu o movimento no sentido contr\u00e1rio, com eleva\u00e7\u00e3o dos limites da \n\nfaixa operacional do teor de enxofre no diesel tratado e redu\u00e7\u00e3o nos de WABT. Para atingir \n\nesse novo objetivo de controle, o controlador elevou a vaz\u00e3o de inst\u00e1veis e reduziu as \n\ntemperaturas dos leitos. Ap\u00f3s as a\u00e7\u00f5es de controle o sistema por fim se estabilizou com todas \n\nas vari\u00e1veis dentro de seus limites estabelecidos. \n\n \n\n \n\n \n\n\n\n \n \n\n84 \n \n\n5.2.2 \u2013 Estudo de Caso 2 \u2013 Mudan\u00e7as Seguidas nas Faixas Operacionais de WABT e \n\nTeor de Enxofre, modelo sem incerteza, com otimiza\u00e7\u00e3o online \n\n \n\nNesta simula\u00e7\u00e3o, de forma semelhante ao estudo de caso 1, item 5.2.1, ocorrem duas \n\nmudan\u00e7as sequenciais nas faixas operacionais das vari\u00e1veis WABT (y1) e teor de enxofre no \n\nproduto (y2). Os limites m\u00e1ximos e m\u00ednimos das vari\u00e1veis foram mudados em rela\u00e7\u00e3o ao caso \n\nbase no instante k=1:  \n\ny1,min = 357;  y1,max = 377; \n\ny2,min = 29.4;  y2,max = 49.4; \n\ny3,min = 1970;  y3,max = 2000; \n\ny4,min = 18.4;  y4,max = 38.4; \n\ny5,min = 9.5;  y5,max = 29.5; \n\n \n\nAs mudan\u00e7as nos batentes das faixas operacionais, que podem ser observadas na figura 5.6, \n\nocorreram nos instantes k = 2 e k = 150, da seguinte forma: \n\n \n\nPara k =2: \n\ny1,min = 369,0;  y1,max = 377,0; \n\ny2,min = 29.4;  y2,max = 35.4; \n\n \n\n \n\nPara k =150: \n\ny1,min = 357,0;  y1,max = 367; \n\ny2,min = 41.4;  y2,max = 45.4; \n\n \n\nAl\u00e9m disso, nesta simula\u00e7\u00e3o tamb\u00e9m foi empregada otimiza\u00e7\u00e3o online acoplada \u00e0 camada de \n\ncontrole, conforme descrita no item 5.1. Os resultados dessas altera\u00e7\u00f5es se encontram nas \n\nfiguras 5.6, 5.7, 5.8, 5.9 e 5.10, onde se pode observar os resultados das a\u00e7\u00f5es de otimiza\u00e7\u00e3o \n\nsobre o sistema: \n\n\n\n \n \n\n85 \n \n\n \n\nFigura 5.6 \u2013 Estudo de Caso 2 \u2013 Vari\u00e1veis Controladas (y1 \u2013 WABT [\u00baC]; y2 \u2013 Enxofre \n\n[ppm]; y3 \u2013 Total de Inst\u00e1veis [m\n3/d]) \n\n \n\n \n\nFigura 5.7 \u2013 Estudo de Caso 2 \u2013 Vari\u00e1veis Controladas (y4 \u2013 Excesso de H2 [kNm\n3/d]; \n\n y5 \u2013 Press\u00e3o de H2 para C-02  [kgf/cm\n2]) \n\n\n\n \n \n\n86 \n \n\n \n\nFigura 5.8 \u2013 Estudo de Caso 2 \u2013 Vari\u00e1veis Manipuladas (u1 \u2013 Carga [m\n3/d]; u2 \u2013 Vaz\u00e3o de \n\nInst\u00e1veis [m3/d]; u3 \u2013 T. Sa\u00edda do Forno [\u00baC]) \n\n \n\n \n\nFigura 5.9 \u2013 Estudo de Caso 2 \u2013 Vari\u00e1veis Manipuladas (u4 \u2013 T. Entrada R1L2 [\u00baC]; u5 \u2013 T. \n\nEntrada R2L1 [\u00baC]; u6 \u2013 T. Entrada R2L2 [\u00baC]) \n\n\n\n \n \n\n87 \n \n\n \n\nFigura 5.10 \u2013 Estudo de Caso 2 \u2013 Evolu\u00e7\u00e3o do Valor Total da Fun\u00e7\u00e3o Objetivo \n\n \n\nNovamente, a faixa operacional de WABT tem seus limites aumentados e a faixa operacional \n\ndo teor de enxofre tem seus limites reduzidos no instante k=2, gerando como a\u00e7\u00e3o de controle \n\neleva\u00e7\u00f5es nas temperaturas de entrada nos leitos de rea\u00e7\u00e3o, conforme as figuras 5.6, 5.7, 5.8 e \n\n5.9. Da mesma forma que no estudo de caso 1, essas eleva\u00e7\u00f5es de temperatura foram feitas na \n\nmedida para atingir o novo valor m\u00ednimo de WABT (y1) e ao mesmo tempo o valor m\u00ednimo \n\ndo teor de enxofre (y2), que tem maior peso. Paralelamente a isso, a otimiza\u00e7\u00e3o online atuou \n\naumentando a carga total da unidade e a vaz\u00e3o de inst\u00e1veis (u1 u2). Contudo, essa a\u00e7\u00e3o foi \n\nlimitada pelo limite m\u00e1ximo do total de Inst\u00e1veis (y3). \n\n \n\nNo instante k=150, com a redu\u00e7\u00e3o na faixa operacional de WABT e o aumento na faixa do \n\nteor de enxofre, o controlador reduziu as temperaturas dos leitos e manteve a vaz\u00e3o de \n\ninst\u00e1veis (u2) constante, pois esta continuou limitada pelo total de Inst\u00e1veis (y3), e prosseguiu \n\naumentando a carga total da planta, (u1). \n\n \n\nO sistema por fim se estabilizou com todas as vari\u00e1veis dentro de seus limites estabelecidos e, \n\ndevido \u00e0 otimiza\u00e7\u00e3o online, houve um aumento relevante nas cargas total e de inst\u00e1veis \n\nprocessadas. \n\n\n\n \n \n\n88 \n \n\n5.2.3 \u2013 Estudo de Caso 3 \u2013 Mudan\u00e7as Seguidas nas Faixas Operacionais de WABT e \n\nTeor de Enxofre, modelo sem incerteza, com otimiza\u00e7\u00e3o online e controle \u201cFunnel\u201d \n\n \n\nNesta simula\u00e7\u00e3o foram utilizados exatamente os mesmos par\u00e2metros do item 5.2.2, por\u00e9m \n\ndesta vez o algoritmo contemplou a estrat\u00e9gia do Funnel, conforme descrita no item 4.3. A \n\nmudan\u00e7a no algoritmo faz com que, ao inv\u00e9s de perseguir uma trajet\u00f3ria de refer\u00eancia fixa e \n\nigual ao limite m\u00e1ximo ou m\u00ednimo para as controladas, o controlador procura fazer com que \n\nas controladas transitem para sua zona operacional seguindo uma trajet\u00f3ria linear. Nesse caso, \n\nusando o mesmo peso para as vari\u00e1veis \u201cslack\u201d do problema de controle, obt\u00e9m-se \n\nnaturalmente movimentos mais lentos das vari\u00e1veis manipuladas e controladas, conforme \u00e9 de \n\nfato o objetivo do controle MPC com \u201cFunnel\u201d. Sob todos os demais aspectos, a atua\u00e7\u00e3o do \n\ncontrolador foi id\u00eantica e os resultados, bastante semelhantes, como pode-se observar nas \n\nfiguras 5.11, 5.12, 5.13, 5.14 e 5.15 a seguir: \n\n  \n\n \n\nFigura 5.11 \u2013 Estudo de Caso 2 \u2013 Vari\u00e1veis Controladas (y1 \u2013 WABT [\u00baC]; y2 \u2013 Enxofre \n\n[ppm]; y3 \u2013 Total de Inst\u00e1veis [m\n3/d]) \n\n\n\n \n \n\n89 \n \n\n \n\nFigura 5.12 \u2013 Estudo de Caso 2 \u2013 Vari\u00e1veis Controladas (y4 \u2013 Excesso de H2 [kNm\n3/d]; \n\n y5 \u2013 Press\u00e3o de H2 para C-02  [kgf/cm\n2]) \n\n \n\n \n\nFigura 5.13 \u2013 Estudo de Caso 2 \u2013 Vari\u00e1veis Manipuladas (u1 \u2013 Carga [m\n3/d]; u2 \u2013 Vaz\u00e3o de \n\nInst\u00e1veis [m3/d]; u3 \u2013 T. Sa\u00edda do Forno [\u00baC]) \n\n\n\n \n \n\n90 \n \n\n \n\nFigura 5.14 \u2013 Estudo de Caso 2 \u2013 Vari\u00e1veis Manipuladas (u4 \u2013 T. Entrada R1L2 [\u00baC]; u5 \u2013 T. \n\nEntrada R2L1 [\u00baC]; u6 \u2013 T. Entrada R2L2 [\u00baC]) \n\n \n\n \n\n \n\nFigura 5.15 \u2013 Estudo de Caso 2 \u2013 Evolu\u00e7\u00e3o do Valor Total da Fun\u00e7\u00e3o Objetivo \n\n\n\n \n \n\n91 \n \n\n5.2.4 \u2013 Estudo de Caso 4 \u2013 Mudan\u00e7as Seguidas nas Faixas Operacionais de WABT e \n\nTeor de Enxofre, modelo com incerteza, com otimiza\u00e7\u00e3o online e controle \u201cFunnel\u201d \n\n \n\nEste estudo de caso adota exatamente as mesmas altera\u00e7\u00f5es de faixas operacionais e \n\npar\u00e2metros que os estudos de caso 2 e 3 e, assim como no estudo de caso 3, utilizou-se o \n\ncontrolador com \u201cFunnel\u201d. Entretanto, modelos distintos foram utilizados para simular a \n\nresposta da planta de processo e para calcular as a\u00e7\u00f5es de controle. Ou seja, foram gerados \n\nmodelos com incertezas para a vari\u00e1vel y2, teor de enxofre, em rela\u00e7\u00e3o \u00e0s temperaturas de \n\nentrada nos leitos reacionais u3, u4, u5 e u6. Estes novos modelos possuem ganhos est\u00e1ticos \n\n15% maiores que os do modelo original. \n\n \n\nTabela 5.2 \u2013 Estudo de Caso 4 \u2013 Modelos de Processo em Fun\u00e7\u00e3o de Transfer\u00eancia Cont\u00ednua \n\n y2 (planta) y2 (modelo) \n\nu3 \n16\n\n1.4375-\n\n+s\n \n\n16\n\n25,1\n\n+\n?\n\ns\n \n\nu4 \n16\n\n1.4375-\n\n+s\n \n\n16\n\n25,1\n\n+\n?\n\ns\n \n\nu5 \n16\n\n1.4375-\n\n+s\n \n\n16\n\n25,1\n\n+\n?\n\ns\n \n\nu6 \n16\n\n1.4375-\n\n+s\n \n\n16\n\n25,1\n\n+\n?\n\ns\n \n\n \n\n \n\n \n\nOs resultados obtidos pela simula\u00e7\u00e3o com modelo com incertezas se encontram nas figuras \n\n5.16, 5.17, 5.18, 5.19 e 5.20 a seguir: \n\n \n\n\n\n \n \n\n92 \n \n\n \n\nFigura 5.16 \u2013 Estudo de Caso 3 \u2013 Vari\u00e1veis Controladas (y1 \u2013 WABT [\u00baC]; y2 \u2013 Enxofre \n\n[ppm]; y3 \u2013 Total de Inst\u00e1veis [m\n3/d]) \n\n \n\n \n\n \n\nFigura 5.17 \u2013 Estudo de Caso 3 \u2013 Vari\u00e1veis Controladas (y4 \u2013 Excesso de H2 [kNm\n3/d]; \n\ny5 \u2013 Press\u00e3o de H2 para C-02  [kgf/cm\n2]]) \n\n\n\n \n \n\n93 \n \n\n \n\nFigura 5.18 \u2013 Estudo de Caso 3 \u2013 Vari\u00e1veis Manipuladas (u1 \u2013 Carga [m\n3/d]; u2 \u2013 Vaz\u00e3o de \n\nInst\u00e1veis [m3/d]; u3 \u2013 T. Sa\u00edda do Forno [\u00baC]) \n\n \n\n \n\nFigura 5.19 \u2013 Estudo de Caso 3 \u2013 Vari\u00e1veis Manipuladas (u4 \u2013 T. Entrada R1L2 [\u00baC]; u5 \u2013 T. \n\nEntrada R2L1 [\u00baC]; u6 \u2013 T. Entrada R2L2 [\u00baC]) \n\n\n\n \n \n\n94 \n \n\n \n\nFigura 5.20 \u2013 Estudo de Caso 3 \u2013 Evolu\u00e7\u00e3o do Valor Total da Fun\u00e7\u00e3o Objetivo \n\n \n\nComparando-se estes resultados do caso 3 com os do caso 2, percebe-se na figura 5.16 que \n\nsurgiu uma lenta oscila\u00e7\u00e3o nas vari\u00e1veis controladas y1 (WABT) e y2 (Enxofre), mas que esta \n\nse deu quase totalmente dentro da suas respectivas zonas operacionais, o portanto n\u00e3o \n\npenalizou a fun\u00e7\u00e3o objetivo de forma significativa. Essa oscila\u00e7\u00e3o ocorreu devido \u00e0 oscila\u00e7\u00e3o \n\nnas vari\u00e1veis manipuladas u3, u4, u5 e u6, conforme se observa nas figuras 5.18 e 5.19, e por \n\nsua vez essa oscila\u00e7\u00e3o foi causada pelo erro de 15% no modelo dessas vari\u00e1veis. A oscila\u00e7\u00e3o \n\ntamb\u00e9m n\u00e3o \u00e9 penalizada de forma significativa, pois os valores da matriz de supress\u00e3o das \n\nvari\u00e1veis manipuladas s\u00e3o pequenos em rela\u00e7\u00e3o aos demais par\u00e2metros da fun\u00e7\u00e3o objetivo.  \n\n \n\nDesta forma, mesmo havendo certa degrada\u00e7\u00e3o nas respostas do controlador esta n\u00e3o impediu \n\na obten\u00e7\u00e3o de uma resposta satisfat\u00f3ria do algoritmo de controle utilizando um modelo de \n\nprocesso com incertezas, tendo sido capaz de atingir de forma adequada os objetivos de \n\ncontrole definidos. De fato, as figuras 5.15 (modelo perfeito) e 5.20 (modelo com incerteza), \n\nque mostram a evolu\u00e7\u00e3o do valor da fun\u00e7\u00e3o objetivo ao longo do tempo de simula\u00e7\u00e3o em cada \n\ncaso n\u00e3o apresentam diferen\u00e7as marcantes entre si. Mesmo assim, fica claro que o controlador \n\nproposto \u00e9 sens\u00edvel \u00e0 incerteza e, portanto, n\u00e3o muito robusto. \n\n \n\n \n\n\n\n \n \n\n95 \n \n\n5.2.5 \u2013 Estudo de Caso 5 \u2013 Implementa\u00e7\u00e3o de targets para as vari\u00e1veis manipuladas \n\n \n\nNesta simula\u00e7\u00e3o, os seguintes valores foram estabelecidos como targets para as seis \n\nmanipuladas: \n\n \n\nUsp,i =  [ 5600   920    386,5   386,0   391,5   393,0]; \n\n \n\nSendo que estes valores tomam o estado estacion\u00e1rio como refer\u00eancia. Os limites m\u00e1ximo e \n\nm\u00ednimo das controladas foram estabelecidos de forma a obter uma zona de controle \n\nsuficientemente ampla para evitar que sua manuten\u00e7\u00e3o entrasse em conflito com a \n\nimplementa\u00e7\u00e3o dos targets das vari\u00e1veis manipuladas. \n\n \n\n Dessa forma, definiu-se:   \n\n \n\ny1,min = 360;  y1,max = 374; \n\ny2,min = 29.4;  y2,max = 49.4; \n\ny3,min = 1956;  y3,max = 2016; \n\ny4,min = 3.4;  y4,max = 53.4; \n\ny5,min = 17.5;  y5,max = 21.5; \n\n \n\nTodas as controladas est\u00e3o ativas, mas por estarem longe dos batentes o controlador pode \n\nimplementar os targets sendo limitado apenas pelo limite de m\u00e1ximo movimento e o peso \n\nfator de supress\u00e3o de movimento no algoritmo de otimiza\u00e7\u00e3o. Al\u00e9m disso, os par\u00e2metros \n\nreferentes ao peso dos targets foram modificados em rela\u00e7\u00e3o ao caso base: \n\n \n\nSu=diag([24 120 300 300 300 300]); \n\n \n\nuQ\n~\n\n = diag([1 1 1 1 1 1] [1 1 1 1 1 1] [1 1 1 1 1 1]); \n\n \n\nOs resultados s\u00e3o apresentados a seguir nas figuras 5.21, 5.22, 5.23, 5.24 e 5.25: \n\n \n\n\n\n \n \n\n96 \n \n\n \n\nFigura 5.21 \u2013 Estudo de Caso 5 \u2013 Vari\u00e1veis Controladas (y1 \u2013 WABT [\u00baC]; y2 \u2013 Enxofre \n\n[ppm]; y3 \u2013 Total de Inst\u00e1veis [m\n3/d]) \n\n \n\n \n\n \n\nFigura 5.22 \u2013 Estudo de Caso 5 \u2013 Vari\u00e1veis Controladas (y4 \u2013 Excesso de H2 [10\n-3 m3/d, \n\nCNPT]; y5 \u2013 Press\u00e3o de H2 para C-02  [kgf/cm\n2]]) \n\n \n\n \n\n\n\n \n \n\n97 \n \n\n \n\nFigura 5.23 \u2013 Estudo de Caso 5 \u2013 Vari\u00e1veis Manipuladas (u1 \u2013 Carga [m\n3/d]; u2 \u2013 Vaz\u00e3o de \n\nInst\u00e1veis [m3/d]; u3 \u2013 T. Sa\u00edda do Forno [\u00baC]) \n\n \n\n \n\nFigura 5.24 \u2013 Estudo de Caso 5 \u2013 Vari\u00e1veis Manipuladas (u4 \u2013 T. Entrada R1L2 [\u00baC]; u5 \u2013 T. \n\nEntrada R2L1 [\u00baC]; u6 \u2013 T. Entrada R2L2 [\u00baC]) \n\n\n\n \n \n\n98 \n \n\n \n\nFigura 5.25 \u2013 Estudo de Caso 5 \u2013 Evolu\u00e7\u00e3o do Valor Total da Fun\u00e7\u00e3o Objetivo \n\n \n\nObserva-se nas figuras 5.23 e 5.24 que todas as vari\u00e1veis manipuladas de fato caminharam ao \n\nsimultaneamente para os targets estipulados e, sem restri\u00e7\u00f5es, a fun\u00e7\u00e3o objetivo pode ser \n\nquase zerada. De fato, com um maior tempo de simula\u00e7\u00e3o, a fun\u00e7\u00e3o objetivo de fato atingiria \n\no valor zero quando a vaz\u00e3o de carga total, u1, atingisse o seu target. \n\n \n\n \n\n5.2.6 \u2013 Estudo de Caso 6 \u2013 Implementa\u00e7\u00e3o de targets para as vari\u00e1veis manipuladas, \n\ncom restri\u00e7\u00f5es nas vari\u00e1veis controladas \n\n \n\nNesta simula\u00e7\u00e3o, os targets das manipuladas utilizados no estudo de caso 5, item 5.2.5, foram \n\nmantidos, bem como os demais par\u00e2metros: \n\n \n\nUsp,i =  [ 5600   920    386,5   386,0   391,5   393,0]; \n\n \n\nSendo que, novamente, estes valores tomam o estado estacion\u00e1rio como refer\u00eancia. \n\nEntretanto, um novo e mais restrito limite m\u00ednimo foi definido para y2, de forma que os \n\ntargets n\u00e3o podem ser atingidos sem que y2 venha a violar seu limite m\u00ednimo, sendo que os \n\ndemais limites permaneceram constantes. Definiu-se: \n\n\n\n \n \n\n99 \n \n\n \n\ny1,min = 360;  y1,max = 374; \n\ny2,min = 38.4;  y2,max = 49.4; \n\ny3,min = 1956;  y3,max = 2016; \n\ny4,min = 3.4;  y4,max = 53.4; \n\ny5,min = 17.5;  y5,max = 21.5; \n\n \n\nOs resultados da simula\u00e7\u00e3o com otimiza\u00e7\u00e3o pela por implementa\u00e7\u00e3o de targets se encontram \n\nnas figuras 5.26, 5.27, 5.28, 5.29 e 5.30 abaixo: \n\n \n\n \n\n \n\nFigura 5.26 \u2013 Estudo de Caso 6 \u2013 Vari\u00e1veis Controladas (y1 \u2013 WABT [\u00baC]; y2 \u2013 Enxofre \n\n[ppm]; y3 \u2013 Total de Inst\u00e1veis [m\n3/d]) \n\n\n\n \n \n\n100 \n \n\n \n\nFigura 5.27 \u2013 Estudo de Caso 6 \u2013 Vari\u00e1veis Controladas (y4 \u2013 Excesso de H2 [10\n-3 m3/d, \n\nCNPT];  y5 \u2013 Press\u00e3o de H2 para C-02  [kgf/cm\n2]]) \n\n \n\n \n\n \n\nFigura 5.28 \u2013 Estudo de Caso 6 \u2013 Vari\u00e1veis Manipuladas (u1 \u2013 Carga [m\n3/d]; u2 \u2013 Vaz\u00e3o de \n\nInst\u00e1veis [m3/d]; u3 \u2013 T. Sa\u00edda do Forno [\u00baC]) \n\n\n\n \n \n\n101 \n \n\n \n\nFigura 5.29 \u2013 Estudo de Caso 6 \u2013 Vari\u00e1veis Manipuladas (u4 \u2013 T. Entrada R1L2 [\u00baC]; u5 \u2013 T. \n\nEntrada R2L1 [\u00baC]; u6 \u2013 T. Entrada R2L2 [\u00baC]) \n \n\n \n\nFigura 5.30 \u2013 Estudo de Caso 6 \u2013 Evolu\u00e7\u00e3o do Valor Total da Fun\u00e7\u00e3o Objetivo \n\n \n\n\n\n \n \n\n102 \n \n\nObserva-se nas figuras 5.28 e 5.29 que as vari\u00e1veis manipuladas referentes \u00e0s temperaturas de \n\nentrada dos leitos (u3, u4, u5, u6) se aproximaram dos targets, mas esta aproxima\u00e7\u00e3o foi \n\nlimitada pelo limite inferior de y2, teor de enxofre, que atuou como restri\u00e7\u00e3o, impedindo que a \n\nfun\u00e7\u00e3o objetivo pudesse ser zerada, como se pode observar na figura 5.26. Ou seja, para evitar \n\nque o teor de enxofre m\u00ednimo no produto fosse violado o controlador teve que moderar os \n\naumentos nas temperaturas dos leitos reacionais e, consequentemente, nas taxas de rea\u00e7\u00e3o. \n\n \n\n  \n\n\n\n \n \n\n103 \n \n\n6 \u2013 Conclus\u00f5es \n\n \n\nNo presente trabalho, foi estudada a implementa\u00e7\u00e3o de um controle avan\u00e7ado MPC para uma \n\nunidade de refino de hidrotratamento \u00f3leo diesel. As estrat\u00e9gias encontradas na ind\u00fastria \n\nmundial de refino de petr\u00f3leo para controle de UHDT foram discutidas e em seguida foram \n\nreplicadas atrav\u00e9s da utiliza\u00e7\u00e3o um algoritmo de controle experimental. O controlador MPC \n\nconsiderado aqui possui algumas caracter\u00edsticas interessantes como o horizonte infinito de \n\npredi\u00e7\u00e3o e o controle por zonas e funis das sa\u00eddas do processo. O horizonte infinito de \n\nprevis\u00e3o resulta em estabilidade nominal do sistema em malha fechada e o controle por zonas \n\ne funis das sa\u00eddas libera alguns graus de liberdade para a otimiza\u00e7\u00e3o em tempo real do \n\nprocesso.  \n\n \n\nA otimiza\u00e7\u00e3o pode ser obtida atrav\u00e9s de duas abordagens distintas: na primeira abordagem os \n\n\u201ctargets\u201d ou valores de refer\u00eancia para as vari\u00e1veis, calculados por um otimizador externo, s\u00e3o \n\ninclu\u00eddos na fun\u00e7\u00e3o objetivo de controle atrav\u00e9s de um termo adicional que penaliza a \n\ndist\u00e2ncia entre as entradas do processo e os \u201ctargets\u201d previstos; na segunda abordagem a \n\notimiza\u00e7\u00e3o do processo \u00e9 inclu\u00edda diretamente no controlador, sem a presen\u00e7a de um \n\notimizador externo. Nesse caso a otimiza\u00e7\u00e3o \u00e9 feita atrav\u00e9s da inclus\u00e3o de um termo na \n\nfun\u00e7\u00e3o objetivo que penaliza o gradiente de uma fun\u00e7\u00e3o objetivo econ\u00f4mica diretamente no \n\ncontrolador, de forma que quando o processo se afasta do ponto operacional \u00f3timo econ\u00f4mico \n\nesse movimento \u00e9 penalizado, o que resulta em a\u00e7\u00f5es de controle em sentido contrario. Na \n\nvers\u00e3o estendida do controle MPC considerada aqui o controle por zonas das sa\u00eddas \u00e9 \n\nexpandido com a inclus\u00e3o de trajet\u00f3rias em funil para as sa\u00eddas cuja predi\u00e7\u00e3o se encontra fora \n\ndas respectivas zonas de controle.  \n\n \n\nAs simula\u00e7\u00f5es apresentadas aqui demonstraram que a estrutura de controle avan\u00e7ado proposta \n\npara UHDT em conjunto com o algoritmo de controle MPC apresentado t\u00eam bom \n\ndesempenho para cen\u00e1rios operacionais usuais. O controlador \u00e9 capaz de estabilizar o sistema \n\nsuavemente e direcionar a unidade de processo as condi\u00e7\u00f5es mais rent\u00e1veis. Ficou \n\ndemonstrado que esse controlador, se bem sintonizado, atua de forma muito consistente e \n\nsuave no processo e possui as caracter\u00edsticas desejadas de estabilidade e efic\u00e1cia e poderia, em \n\ntese, ser implementado numa planta real. \n\n\n\n \n \n\n104 \n \n\n7 \u2013 Refer\u00eancias Bibliogr\u00e1ficas \n\n \n\nASTROM, K. J., WITTENMARK B., Computer Controlled Systems: Theory and Design, \n\nPrentice-Hall, 2\u00aaedi\u00e7\u00e3o, (1990). \n\nBADGWELLl, T. A. (1997). Robust model predictive control of stable linear systems. \n\nInternational Journal of Control, 68, 797\u2013818. \n\nCAMACHO, E. F., &amp; BORDONS, C. A., Model Predictive Control, Springer, 2\u00aa edi\u00e7\u00e3o, \n\n(2008). \n\nCAMPOS, M., TEIXEIRA, H., LIPORACE, F., GOMES, M., Challenges and problems with \n\nadvanced control and optimization technologies, Advanced Control of Chemical Processes, \n\nVolume # 7 | Part# 1, Ko\u00e7 University Campus, Turkey, (2009). \n\nCARRAPI\u00c7O \u00b8 O. L., SANTOS, M. M., ZANIN, A. C., &amp; ODLOAK, D. (2009). Application \n\nof the IHMPC to an industrial process system with integrating output. In Symposium on \n\nadvanced control of chemical processes (ADCHEM 2009) Istambul, Turkey. \n\nCARRAPI\u00c7O, O. L. (2004). Controle Preditivo de Horizonte Infinito para Processos \n\nIntegradores com Tempo Morto. Disserta\u00e7\u00e3o de Mestrado. EPUSP, S\u00e3o Paulo. \n\nCARRAPI\u00c7O\u00b8 O. L., &amp; ODLOAK, D. (2005). A stable model predictive control for \n\nintegrating process. Computers and Chemical Engineering, 29, 1089\u20131099. \n\nCOELHO, L.S., MARIANI, V.C., Evolu\u00e7\u00e3o diferencial h\u00edbrida com programa\u00e7\u00e3o quadr\u00e1tica \n\naplicada ao problema de despacho econ\u00f4mico de energia el\u00e9trica. Sba Controle &amp; \n\nAutoma\u00e7\u00e3o vol.17 n\u00ba4 Campinas (2006). \n\nCUTLER, C. R. &amp; RAMAKER, B. L. (1979). Dynamic matrix control \u2013 a computer control \n\nalgorithm. AIChE 86th National Meeting, Houston, TX. \n\nGARCIA, C. E. &amp; MORSHEDI, A. M. (1986). Quadratic programing solution of dynamics \n\nmatrix control (QDMC). Chem. Engng Commun., v.46, p.73-87. \n\nGONZALEZ, A &amp; ODLOAK, D. (2009). A stable MPC with zone control. Journal of Process \n\nControl, 19, p.110-122. \n\n\n\n \n \n\n105 \n \n\nGOUV\u00caA, M. T. &amp; ODLOAK, D. (1997). ROSSMPC: A new way of representing and \n\nanalysing the predictive controllers. Trans IchemE, v.75, n.4, p.707-717. \n\nGOUV\u00caA, M. T. &amp; ODLOAK, D. One-layer real time optimization of LPG production in the \n\nFCC unit: procedure, advantages and disadvantages. Computers Chem. Engng., 22, Suppl., p. \n\n191 (1998). \n\nJAZWINSKI, A. H. Stochastic Processes and Filtering Theory. 1st ed. V. 1. Academic Press, \n\nUSA, (1997). \n\nKALID, R. A. (1999). Modelagem, Simula\u00e7\u00e3o, Controle e Otimiza\u00e7\u00e3o de Conversores de \n\nAcetileno. Disserta\u00e7\u00e3o de Doutorado. EPUSP, S\u00e3o Paulo. \n\nKOTHARE, M. V., BARAKRISHNAN, V., &amp; MORARI, M. (1996). Robust constrained \n\nmodel predictive control using linear matrix inequalities. Autom\u00e1tica, 32, 1361\u20131379. \n\nKWONG, W. H. Otimiza\u00e7\u00e3o de Plantas Industriais Complexas, Tese de Doutoramento, \n\nUniversidade de S\u00e3o Paulo/EPUSP, S\u00e3o Paulo (1992). \n\nLEE, J. H., &amp; YU, Z. (1997). Worst case formulation of model predictive control for systems \n\nwith bounded parameters. Automatica, 33(5), 763\u2013781. \n\nMACIEJOWSKI, J., Predictive Control with Constraints, Prentice Hall, 1\u00aa edi\u00e7\u00e3o, (2000). \n \nMARLIN, T., Process Control: Designing Processes and Control Systems for Dynamic \n\nPerformance, McGraw-Hill Science/Engineering/Math, 2\u00aa edi\u00e7\u00e3o, (2000). \n\nMAYNE, D. Q., RAWLINGS, J. B., RAO, C. V., &amp; SCOKAERT, P. O. (2000). Constrained \n\nmodel predictive control: stability and optimality. Automatica, 36, 789\u2013814. \n\nMEYERS, R., Handbook of Petroleum Refining Processes, McGraw-Hill Professional, 3\u00aa \n\nedi\u00e7\u00e3o (2003). \n\nODLOAK, D. (1996). A new state-space approach to model predictive control, Brazilian \n\nJournal of Chem. Engng, v.13, n.3, p.152-167. \n\nODLOAK, D. (2004). Extended robust model predictive control. AIChE Journal, 50(8), \n\n1824\u20131836. \n\n\n\n \n \n\n106 \n \n\nPACHECO, D. A. (2009). Controle do sistema de produ\u00e7\u00e3o de alum\u00ednio com RMPCT de \n\nhorizonte infinito. Disserta\u00e7\u00e3o de Mestrado. EPUSP, S\u00e3o Paulo. \n\nPORF\u00cdRIO, C. R. (2011). Implanta\u00e7\u00e3o de Otimizador Online acoplado ao Controle Preditivo \n\n(MPC) de uma Coluna de Tolueno. Disserta\u00e7\u00e3o de Mestrado. EPUSP, S\u00e3o Paulo. \n\nPORFIRIO, C. R., NETO, E. A., &amp; ODLOAK, D. (2003). Multi-model predictive control of \n\nan industrial C3/C4 splitter. Control Engineering Practice, 11(7), 765\u2013779. \n\nRALHAN, S., &amp; BADGWELL, T. A. (2000). Robust control of stable linear systems with \n\ncontinuous uncertainty. Computer and Chemical Engineering, 24, 2533\u20132544. \n\nRAWLINGS, J.B &amp; K.R MUSKE (1993). The stability of constrained multivariable receding \n\nhorizon control. IEEE Trans. Autom. Cont., 38, p.1512-1516. \n\nRICKER, N, L. Model Predictive Control with State Estimation. Industrial Engineering \n\nChemical Reser., v. 29, p. 374-382 (1990). \n\nRODRIGUES, M. A. &amp; ODLOAK D. (2003). An infinite horizon model predictive control \n\nfor stable and integrating processes. Computers Chem. Engng, v.27, p. 1113-1128. \n\nROSSITER, J.A., Model-Based Predictive Control: A Practical Approach, CRC Press, 1\u00aa \n\nedi\u00e7\u00e3o (2003). \n\nROTAVA, O., &amp; ZANIN, A. C, Multivariate Control and real time optimization. \n\nHydrocarbon Processing, Agosto, p 63, 2005. \n\nSCHNELLE, P. D., LAMON, J., &amp; BADGWELL, T. A. (2007). Application of state space \n\nMPC to a commercial scale dilution/pasteurization/drying process. In Proceedings of the \n\nannual ISA analysis division symposium 4, October , pp. 2828\u20132855. \n\nSOUZA, G. F. (2007). Integra\u00e7\u00e3o da Otimiza\u00e7\u00e3o em Tempo Real com Controle Preditivo. \n\nDisserta\u00e7\u00e3o de Mestrado. EPUSP, S\u00e3o Paulo. \n\nYING, C. M., &amp; JOSEPH, B. (1999). Performance and stability analysis of LP-MPC and QP-\n\nMPC cascade control systems. AIChE Journal, 45(7), 1521\u20131534. \n\nZANIN, A.C., GOUV\u00caA, M.T., ODLOAK, D. Comparing different real-time optimization \n\nstrategies for the FCC catalytic converters. In: ADCHEM 2000 International Symposium on \n\nAdvanced Control of Chemical Processes, Pisa, June, 14-16, 2000, Proceedings, 2000a."}]}}}