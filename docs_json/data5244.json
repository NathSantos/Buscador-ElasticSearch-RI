{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.09572"}, {"@name": "filename", "#text": "14552_Pinheiro_NathalieCarvalho_M.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "Universidade Estadual de Campinas\nFaculdade de Engenharia ElEtrica e de Computa\u00e7Ao\nNathalie Carvalho Pinheiro\nControle Impulsionai para Limita\u00e7\u00e3o da Varia\u00e7\u00e3o de N\u00edvel com Minimiza\u00e7\u00e3o das Atua\u00e7\u00e3es\nUNICAMP\nNathalie Carvalho Pinheiro\nControle Impulsionai para Limita\u00e7\u00e3o da Varia\u00e7\u00e3o de Nivel com Minimiza\u00e7\u00e3o das Atua\u00e7\u00f5es\nDisserta\u00e7ao de mestrado apresentada a Faculdade de Engenharia El\u00e9trica e de Computa\u00e7ao como parte dos requisitos exigidos para a obten\u00e7\u00e3o do t\u00e9tulo de Mestre em Engenharia El\u00e9trica.\nArea de concentracao: Automa\u00e7\u00e3o.\nOrientador: Jo\u00e3o Bosco Ribeiro do Val\nFICHA CATALOGR\u00c1FICA ELABORADA PELA\nBIBLIOTECA DA \u00c1REA DE ENGENHARIA E ARQUITETURA - BAE - UNICAMP\nPinheiro, Nathalie Carvalho\nP655c\tControle impulsionai para limita\u00e7\u00e3o da varia\u00e7\u00e3o de\nn\u00edvel com minimiza\u00e7\u00e3o das atua\u00e7\u00f5es / Nathalie Carvalho Pinheiro. --Campinas, SP: [s.n.], 2009.\nOrientador: Jo\u00e3o Bosco Ribeiro do Val.\nDisserta\u00e7\u00e3o de Mestrado - Universidade Estadual de Campinas, Faculdade de Engenharia El\u00e9trica e de Computa\u00e7\u00e3o.\n1. Teoria de controle estoc\u00e1stico. 2. Equa\u00e7\u00f5es diferenciais parciais estoc\u00e1sticos - Solu\u00e7\u00f5es num\u00e9ricas. 3. Escoamento multifasico. I. do Val, Jo\u00e3o Bosco Ribeiro. II. Universidade Estadual de Campinas. Faculdade de Engenharia El\u00e9trica e de Computa\u00e7\u00e3o. III. T\u00edtulo.\nT\u00edtulo em Ingl\u00eas: Impulse control with liquid level limits and minimization of actuations\nPalavras-chave em Ingl\u00eas: Stochastic control theory, Differential equations, partial -Numerical solutions, Multiphase flow\n\u00c1rea de concentra\u00e7\u00e3o: Controle e Automa\u00e7\u00e3o\nTitula\u00e7\u00e3o: Mestre em Engenharia El\u00e9trica\nBanca examinadora: Daniel Oliveira Cajueiro, Rafael Santos Mendes\nData da defesa: 30/07/2009\nPrograma de P\u00f3s Gradua\u00e7\u00e3o: Engenharia El\u00e9trica\nCOMISS\u00c3O JULGADORA - TESE DE MESTRADO\nCandidata: Nathalie Carvalho Pinheiro\nData da Defesa: 30 de julho de 2009\nT\u00edtulo da Tese: \"Controle Impulsionai para Limita\u00e7\u00e3o da Varia\u00e7\u00e3o de N\u00edvel com Minimiza\u00e7\u00e3o das Atua\u00e7\u00f5es\"\nProf. Dr. Jo\u00e3o Bosco Ribeiro do Vai (Presidente^\nProf. Dr. Daniel Oliveira Cajueiro:\nProf. Dr. Rafael Santos Mendes:\nPara minha fam\u00edlia, Neuman e Nathan.\nNilton,\nAgradecimentos\nAgrade\u00e7o,\nao Prof. Jo\u00e3o Bosco pelos dois anos de excelente orienta\u00e7ao acad\u00eamica e valorosos conselhos;\naos professores Rafael Mendes, Jos\u00e9 Ricardo Mendes e Adriane Serapi\u00e3o e ao Paulo Gasse pela oportunidade de participar do projeto do VASPS e pelo \u00e9timo grupo de trabalho;\n\u00e0 UnB e a Unicamp, as duas grandes universidades que marcaram minha vida;\naos amigos do DT, Renato, Ricardo, Walter, Ta\u00eds, Eduardo, Ceara, Giuliano, Julio, Tiago, Jurandyr, Alessandro, Victor e Heber, pela companhia e por todo o conhecimento adquirido nas horas do caf\u00e9e;\naos outros amigos da FEEC, Anzai, Grace, Alim, Leonardo, Felipe, Michell, Leonardo Lustosa e Val\u00e9ria, pela for\u00e7a durante essa caminhada e, em especial, \u00e0 Michele, pela imensa ajuda quando meu computador me deixou na m\u00e3ao;\naos amigos de Bras\u00e9lia que tamb\u00e9em vieram para c\u00e9a, Maice, Renata, Andr\u00e9e, Fla\u00e9vio, Fontes, Chico, Ednei e Maguila;\naos brasilienses que ficaram torcendo por n\u00e9s \u00e0 distancia;\naos meus pais e meu irm\u00e3o, por todo o amor, apoio e confian\u00e7a;\nao Claudio, pelo amor e pela \u00e9tima companhia, mesmo que nem sempre pudesse estar ao meu lado.\nEsse trabalho contou com o apoio da Funda\u00e7\u00e3o de Amparo a Pesquisa do Estado de S\u00e3o Paulo, FAPESP.\nResumo\nOs elevados custos de produ\u00e7\u00e3o na extra\u00e7\u00e3o de petr\u00f3leo mar\u00edtimo s\u00e3o reduzidos com um sistema inovador que a Petrobras est\u00f3 desenvolvendo, denominado VASPS (do ingl\u00eas, Vertical Annular Separation and Pumping System), capaz de separar g\u00f3s e l\u00edquido ainda no assoalho oceanico. Esta disserta\u00e7\u00e3o trata do ajuste do n\u00edvel de l\u00edquido no reservat\u00f3rio do VASPS, via controle impulsional estoc\u00f3stico, que se distancia bastante de um regulador convencional. A vaz\u00e3o de entrada flutua e o controle consiste em alterar a velocidade da bomba de sa\u00edda do tanque, mantendo o n\u00edvel numa faixa de operac\u00e3o, na qual ele varia livremente sem preju\u00edzo. Todavia, \u00f3 necess\u00f3rio de um lado observar o risco de operar proximo aos extremos de n\u00edvel e de outro minimizar o nu\u00f3mero de interven\u00e7co\u00e3es na velocidade da bomba para prolongar sua vida \u00fatil. Optou-se por modelar o sistema por meio de um processo de difus\u00e3o e formular por controle impulsional. Para a sua solu\u00e7\u00e3o, o controle impulsional \u00f3e convertido em uma sequ\u00eaencia de problemas de parada \u00f3otima iterados, resolvidos utilizando-se a Discretizac\u00e3o do Valor M\u00e9dio, MVS (do ingl\u00eas, Mean Value Scheme). Esta disserta\u00e7c\u00e3ao introduz o uso do controle impulsional nesta aplica\u00e7ca\u00e3o al\u00f3em da t\u00f3ecnica citada para resolver problemas de parada o\u00f3tima.\nPalavras-chave: Processos de difus\u00e3o, controle impulsional, controle estoc\u00f3stico, soluc\u00e7\u00e3ao num\u00f3erica de equa\u00e7c\u00e3oes diferenciais parciais, m\u00f3etodo de discretiza\u00e7c\u00e3ao do valor m\u00f3edio, separador multifa\u00f3sico.\nAbstract\nThe high costs in offshore oil production are reduced with the use of an innovative system which has been developed by Petrobras, the Brazilian oil company. Called VASPS (Vertical Annular Separation and Pumping System), it consists of an undersea gas/liquid separator. This work presents a strategy for the liquid level adjustment in the VASPS tank, which is subject to uncertain liquid inflow. This is far from a strict control regulator problem, since the liquid level may drifts freely inside an operation range. Although, in one hand, it is necessary to account for a risky operation near the limits, on the other hand, acting freely and continuously in the controlled pump may drastically shorten the lifetime of the equipment. To prevent premature worn with halt in the oil production, the control input variations should be meager. We propose a stochastic impulse control for varying the outflow pump speed. This formulation is transformed in a sequence of iterated optimal stopping problems, which results in a sequence of variational inequalities. We employ the numerical method called Mean Value Scheme (MVS) to solve this type of problem. This monograph introduces impulse control to the resevoir level adjustment of VASPS, together with the application of the MVS to its solution.\nKey-words: Diffusion process, impulse control, stochastic control, numerical solution of partial differential equations, mean value scheme, multiphase separation.\nLista de Figuras\n1.1\tEsquema de sistema de produ\u00e7\u00e3o de petr\u00f3leo com VASPS.......................... 2\n1.2\tRepresenta\u00e7\u00e3o esquem\u00f3tica da estrutura do VASPS............................... 3\n1.3\tEspa\u00e7o de estados no modelo do VASPS.......................................... 6\n1.4\tEspa\u00e7o de estados no modelo do VASPS.......................................... 7\n3.1\tRegi\u00e3o coberta por bolas regulares para utiliza\u00e7\u00e3o do MVS.............................\n28\n4.1 Dimens\u00e3es do VASPS.....................................................\n36\n4.2\n4.3\n4.4\n4.5\nCurvas de n\u00edvel do risco de continua\u00e7ao.......................................\n(a)Regioes e destinos e (b) Compara\u00e7ao entre Vz e M[Vi-1], com ^max = 20,\n^min\t10, rmax\t1; csoma\t0,01 e Cmult\t1,5.\nRegioes e destinos para ^ax = 20, ^min = 10, rmax = 1, 0\u00bbma = 0,01 e: (a) cmult \u2014 1 e (b) cmult \u2014 2.........................................................\nRegi\u00e3es e destinos para: (a) a = 0,4, ^ax = 20, ^min = 10, rmax = 1, 0\u00bbma = 0,01 e cmult 1,5; (b) ^max 2; ^min 1; (c) rmax 2 e (d) a 0,2...........................\n37\n39\n40\n41\n5.1\tDiagrama de blocos principal do programa em Simulink.......................... 44\n5.2\tSub-blocos da simula\u00e7ao em Simulink........................................... 44\n5.3\tSimula\u00e7\u00e3o com controlador conservador da Figura 4.4(a)........................ 45\n5.4\tSimula\u00e7ao com controlador moderado da Figura 4.3(a)........................... 46\n5.5\tSimula\u00e7\u00e3o com\tcontrolador liberal da Figura 4.4(b).......................... 47\n5.6\tUtiliza\u00e7\u00e3o da estimativa da vaz\u00e3o de entrada para alterar o\tmapeamento........ 48\n5.7\tQueda de poco\tcom controlador conservador da Figura 4.4(a).................. 49\n5.8\tQueda de po\u00e7o\tcom controlador moderado da Figura 4.3(a)..................... 50\n5.9\tQueda de po\u00e7o\tcom controlador liberal da Figura 4.4(b)...................... 50\n5.10\tEnvelhecimento de pocos com controlador conservador da Figura 4.4(a)......... 51\n5.11\tEnvelhecimento de po\u00e7os com controlador moderado da Figura 4.3(a)............ 51\n5.12\tEnvelhecimento de po\u00e7os com controlador liberal da Figura 4.4(b)............. 52\n5.13\tRepresenta\u00e7\u00e3o esquem\u00e1tica do modelo para controle de n\u00edvel de l\u00edquido........ 53\n5.14\tAlgoritmo de uma itera\u00e7ao do filtro de Kalman, vide [1]...................... 54\n5.15\tGera\u00e7\u00e3o de medidas de n\u00edvel de l\u00edquido.................................... 54\n5.16\tEstimativa da vaz\u00e3o de entrada usando filtro de Kalman.................... 55\nLista de S\u00edmbolos\nqt\tVaz\u00e3o de entrada no reservat\u00f3rio do VASPS.\nqS\tVazao de sa\u00edda do reservat\u00f3rio do VASPS.\nX?\tEspa\u00e7o de estados (conjunto fechado).\nX Espa\u00e7o de estados, excluindo sua fronteira (conjunto aberto). dX Fronteira do espaco de estados.\nht\tN\u00edvel de l\u00edquido no VASPS (primeira componente do vetor de estados).\n5t\tBalan\u00e7o de vaz\u00e3o no VASPS (segunda componente do vetor de estados).\nCusto terminal (custo de atingir a fronteira).\nc\tCusto de intervenc\u00e3o.\nr\tCusto de continuac\u00e3o.\nAr\tArea da se\u00e7ao transversal do VASPS.\nx\tEstado inicial.\na\tFator de desconto no problema com custo descontado.\nTi\tTempo de parada da ocorr\u00eancia do i-\u00f3sima intervencao.\n1{.}\tFun\u00e7\u00e3o indicadora: vale 1 quando {. } \u00f3 verdadeira e 0 caso contrario.\nT Tempo final (representa instante que a fronteira \u00f3 alcan\u00e7ada).\nEx[.] Valor esperado da express\u00e3o, com o processo iniciando-se em x, isto \u00f3, E [.|Xo = x].\nJ Fun\u00e7ao de custo do controle impulsional sem limite de interven\u00e7\u00e3es.\nXt\tVetor de estados.\nG Conjunto de valores de impulso admiss\u00f3veis.\nr Func\u00e3o que descreve pr\u00f3ximo estado ap\u00f3s interven\u00e7ao.\nV Conjunto de sequ\u00eancias de controle admiss\u00f3veis para controle impulsional sem limite de interven\u00e7c\u00e3oes.\nv Sequ\u00eancia de controle admiss\u00f3vel para controle impulsional sem limite de interven\u00e7c\u00e3oes.\nt*\tTempo de explosao:= limR_ .x inf{t > 0; |X(t)| > R}.\nVn\tConjunto de sequ\u00eancias de controle admiss\u00f3veis para controle impulsional\ncom n interven\u00e7\u00f5es.\nJn\tFuncao de custo do controle impulsional de at\u00e9 n intervencoes.\nVn\tCusto do n-\u00f3simo problema de parada \u00f3tima iterado.\nq.c. Quase certamente (defini\u00e7\u00e3o no Ap\u00eandice A).\nA Gerador de um processo de difus\u00e3o.\nC0(U)\nCk (U)\nCo (U)\nQx\nT\nVn\nT\nT\nNo\nN\nMo\nM\nro\nQ\nIn\nal, a% e af\nTo\nTf\nClasse de fun\u00e7\u00f5es limitadas e cont\u00ednuas em U.\nClasse de fun\u00e7\u00f5es com derivadas at\u00e9 k-\u00e9sima ordem cont\u00ednuas em U.\nClasse de fun\u00e7\u00f5es com derivadas at\u00e9 k-\u00e9sima ordem cont\u00ednuas e com suporte compacto em U.\nLei de probabilidade de Xt iniciando-se em x.\nConjunto de todos os tempos de parada menores que o tempo final T. Sequ\u00eancia de controle admiss\u00edvel obtida truncando-se v ap\u00f3s n intervencoes. Tempo final utilizando-se a sequ\u00eancia de controle v.\nTempo final utilizando-se a sequ\u00eancia de controle truncada vn.\nNumero de linhas de nos na rede quadrada do MVS, incluindo a fronteira.\nNumero de linhas de nos na rede quadrada do MVS, excluindo a fronteira. Numero de colunas de nos na rede quadrada do MVS, incluindo a fronteira. Nu\u00e9mero de colunas de n\u00e9os na rede quadrada do MVS, excluindo a fronteira. Distancia entre nos na rede quadrada do MVS.\nBolas do m\u00e9todo MVS.\nCobertura parcial do espa\u00e7o de estados no MVS (uniao das bolas).\nFuncao de Bessel modificada de n-\u00e9sima ordem.\nElementos da matriz de covari\u00e2ncias aaT.\nFator de escalonamento no tempo.\nConstante de tempo do filtro passa-baixas no filtro de Kalman implementado.\no / \u2022\nSumario\n1\tIntrodu\u00e7\u00e3o\t1\n1.1\tO projeto VASPS............................................................ 1\n1.2\tObjetivo desta disserta\u00e7\u00e3o................................................. 4\n1.3\tA proposta de solu\u00e7ao ..................................................... 5\n1.4\tApresenta\u00e7ao da disserta\u00e7ao................................................ 7\n2\tControle Impulsionai e sua Aplica\u00e7\u00e3o no VASPS\t9\n2.1\tModelagem do sistema....................................................... 9\n2.2\tCusto do controle impulsional............................................. 10\n2.3\tProblemas de parada otima iterados........................................ 12\n2.4\tDescri\u00e7\u00e3o por desigualdades variacionais.................................. 14\n2.5\tDemonstracoes dos Teoremas 2.1 e 2.3 e do Lema 2.1........................ 17\n2.5.1\tDemonstra\u00e7\u00e3o do Teorema 2.1........................................ 18\n2.5.2\tDemonstra\u00e7\u00e3o do Lema 2.1 ......................................... 21\n2.5.3\tDemonstra\u00e7\u00e3o do Teorema\t2.3....................................... 24\n3\tDiscretiza\u00e7ao do Valor M\u00e9dio\t26\n3.1\tClassifica\u00e7\u00e3o de equa\u00e7\u00e3es diferenciais parciais .......................... 26\n3.2\tDescri\u00e7\u00e3o do m\u00e9todo....................................................... 27\n3.3\tObten\u00e7\u00e3o da equa\u00e7\u00e3o de Helmholtz.......................................... 30\n3.4\tAplica\u00e7\u00e3o do MVS ao VASPS................................................. 31\n4\tResultados Num\u00e9ricos\t34\n4.1\tEscalonamento no tempo.................................................... 34\n4.2\tDescri\u00e7\u00e3o dos exemplos simulados.......................................... 36\n4.3\tRegi\u00e3es obtidas........................................................... 38\n4.3.1\tVaria\u00e7\u00e3o do custo de interven\u00e7\u00e3o - tr\u00eas cen\u00e9rios................... 40\n4.3.2\tVariac\u00e3o de outras func\u00e3es......................................... 40\n5\tO simulador do VASPS\t43\n5.1\tSimula\u00e7\u00e3o do sistema................................................... 43\n5.2\tResultados............................................................. 45\n5.2.1\tSimula\u00e7\u00e3es dos tr\u00eas cen\u00e1rios: condi\u00e7\u00e3es normais de vaz\u00e3o......... 45\n5.2.2\tSimula\u00e7\u00e3es dos tr\u00eas cen\u00e1rios: vaz\u00e3es de entrada especiais........ 49\n5.3\tEstima\u00e7\u00e3o da vaz\u00e3o de entrada ......................................... 51\n6\tConclus\u00f5es\t56\nBibliografia\t59\nA\tConceitos Basicos\tno\tEstudo de Processos de Difusao\t63\nB\tMatrizes expandidas\tdo MVS\t66\nIntrodu\u00e7\u00e3o\nA motiva\u00e7\u00e3o deste trabalho vem de desafios que surgiram no desenvolvimento de um sistema inovador da indUstria do petr\u00f3leo, denominado Sistema Separador e Bombeador Anular Vertical, VASPS (do ingl\u00eas, Vertical Annular Separation and Pumping System), capaz de aumentar bastante o ganho de produ\u00e7\u00e3o na extrac\u00e3o de petr\u00f3leo do leito marinho. Este sistema est\u00f3 sendo desenvolvido pela Petrobras e faz parte de um conv\u00eanio de coopera\u00e7ao com o Departamento de Engenharia do Petr\u00f3leo da FEM/Unicamp. Um dos objetivos do conv\u00eanio \u00f3 o desenvolvimento de um novo controlador para a bomba centr\u00edfuga que atenda a novos requisitos e \u00f3 nesse contexto que esta dissertac\u00e3o est\u00f3 inserida. Neste cap\u00f3tulo \u00f3 apresentada uma visao geral do projeto e os objetivos do ponto de vista do m\u00f3dulo de controle, al\u00e9m de um resumo do conteudo dos pro\u00f3ximos cap\u00f3tulos.\n1.1\tO projeto VASPS\nO objetivo do VASPS \u00f3 realizar no leito marinho a separa\u00e7\u00e3o multifasica da produ\u00e7\u00e3o de po\u00e7cos de petr\u00f3oleo mar\u00f3timos e fazer o bombeio do l\u00f3quido em uma tubulac\u00e7\u00e3ao separada do g\u00f3as. Atualmente a separac\u00e7a\u00e3o de g\u00f3as, o\u00f3leo e \u00f3agua \u00f3e feita nas plataformas, por\u00f3em isso acarreta um custo muito elevado. Um dos motivos \u00f3 o fato de fluidos multif\u00f3sicos estarem sujeitos a padr\u00e3es de escoamento bastante irregulares, que s\u00e3ao agravados pela subida do leito marinho at\u00f3e o n\u00f3vel do mar. Particularmente, os sif\u00e3es e a estrutura vertical do riser (linha de subida para a plataforma) induzem o escoamento com golfadas severas, em que h\u00f3a a forma\u00e7ca\u00e3o de grandes bolhas de gas, vide [2]. Acrescente-se a isso o fato que os sistemas separadores convencionais s\u00e3ao compostos por tanques grandes e pesados, o que torna as plataformas muito caras, vide\n[3]. A utiliza\u00e7\u00e3o do VASPS permitir\u00f3 a redu\u00e7\u00e3o do numero de plataformas, com cada VASPS recebendo a produ\u00e7c\u00e3ao de v\u00f3arios po\u00e7cos de perfura\u00e7ca\u00e3o e fazendo a separa\u00e7ca\u00e3o e o bombeio para plataformas pr\u00f3ximas, conforme o esquema da Figura 1.1.\nA separa\u00e7ca\u00e3o de l\u00f3quido e ga\u00f3s \u00f3e feita no leito marinho utilizando o conceito de separa\u00e7c\u00e3ao cicl\u00eaonica, caracterizado por um peso menor e um custo reduzido, quando comparado aos sepa-\nFigura 1.1: Esquema de sistema de produ\u00e7\u00e3o de petr\u00f3leo com VASPS.\nradores convencionais. O sistema, mostrado na Figura 1.2, \u00f3 uma estrutura cil\u00f3ndrica constitu\u00f3da por uma bomba e um vaso separador, onde a mistura de l\u00edquido e g\u00f3s entra e sofre o processo de separacao atrav\u00f3s de tr\u00eas est\u00f3gios, [3] [4]:\n\u2022\tna c\u00e2mara de expans\u00e3o a maioria do gas se separa e sobe pela linha que o leva \u00e0 plataforma;\n\u2022\tna helice quase todo o g\u00f3s restante sofre separa\u00e7\u00e3o centr\u00edfuga e penetra na tubula\u00e7\u00e3o central por meio de pequenos orif\u00edcios na parede interna;\n\u2022\tno reservat\u00f3rio uma pequena quantidade de g\u00f3s ainda se separa por gravidade e emana na tubulac\u00e3o central. O l\u00f3quido \u00f3 bombeado para a plataforma por meio de uma bomba centr\u00edfuga submersa (BCS) localizada neste est\u00f3gio. O g\u00f3s, por sua vez, n\u00e3o precisa ser bombeado, pois se desloca para cima atrav\u00e9s da diferen\u00e7a de press\u00e3o que existe entre o separador e o vaso coletor na plataforma.\nO n\u00f3vel de l\u00f3quido no reservat\u00f3rio deve ser mantido dentro de uma faixa de excurs\u00e3o permitida e \u00f3 controlado por meio da varia\u00e7\u00e3o na frequ\u00eancia da bomba. Deste modo, a bomba modifica o fluxo de sa\u00edda para equilibrar grandes varia\u00e7\u00e3es do fluxo de entrada, por\u00f3m evitando atuacoes desnecessarias. Essa preocupa\u00e7ao \u00f3 importante para prolongar a vida \u00fatil da bomba, uma vez que para a troca da bomba \u00f3 uma opera\u00e7\u00e3o muito cara. Al\u00f3m da compra de uma bomba nova, o pre\u00e7o do aluguel das sondas capazes de efetuar este trabalho \u00f3 muito alto e a produ\u00e7ao dos po\u00e7os ligados ao VASPS fica parada enquanto a manutenc\u00e3o n\u00e3o \u00f3 realizada.\nOs dois principais fatores que causam uma altera\u00e7ao no fluxo de entrada sao a ocorr\u00eancia de golfadas severas e a queda de po\u00e7os, isto \u00f3, a parada na opera\u00e7ao de um ou mais po\u00e7os. De\nSa\u00edda de l\u00edquido\nacordo com dados experimentais da Petrobras, os efeitos das golfadas no VASPS n\u00e3o devem, em princ\u00edpio, ser muito preocupantes, uma vez que o impacto na alteracao do n\u00edvel de l\u00edquido \u00e9 menor que a faixa de excurs\u00e3o aceit\u00e1vel. De fato, uma vaz\u00e3o de entrada no reservat\u00f3rio muito turbulenta \u00e9 dif\u00edcil de ocorrer devido ao posicionamento no leito marinho do VASPS e \u00e0 atenua\u00e7\u00e3o que ocorre na passagem pela h\u00e9lice. Al\u00e9m disso, o reservat\u00e1rio faz o papel de um acumulador, o que tamb\u00e9m atenua os impactos de varia\u00e7\u00e3es de vaz\u00e3o de entrada.\nA queda de um po\u00e7co, no entanto, \u00ede um processo mais complicado, pois na\u00e3o \u00ede transito\u00edrio e pode ter um impacto na opera\u00e7\u00e3o de propor\u00e7\u00e3es bem maiores que a golfada. Em um campo de prospec\u00e7ao de petr\u00f3leo, a mistura que entra no VASPS \u00e9 proveniente do manifold, que \u00e9 respons\u00e1vel pela jun\u00e7\u00e3o da mistura de varios po\u00e7os de perfurac\u00e3o. Desta forma, a queda de um po\u00e7o nao provoca a parada completa no abastecimento do VASPS, porem causa uma grande variac\u00e3o no fluxo de entrada. Essa varia\u00e7\u00e3o depende da import\u00e2ncia percentual do poco que deixou de produzir e est\u00e9 associada \u00e0 quantidade de pocos ligadas ao manifold, que pode variar de um campo para o outro.\nA Petrobras j\u00e9 construiu um VASPS em car\u00e9ter experimental no campo de Marimb\u00e9 e\npretende fazer outros de maior porte. O conv\u00eanio tecno-cient\u00edfico entre a Petrobras e a Unicamp para atua\u00e7\u00e3o no desenvolvimento do VASPS encontra-se em sua segunda fase, na qual esta disserta\u00e7\u00e3o est\u00e1 inserida. Na primeira, um controlador para a bomba do VASPS foi desenvolvido usando um PID controlado por logica fuzzy [5]. Agora est\u00e1 sendo projetado um novo controlador, capaz de representar com maior realismo as condi\u00e7c\u00e3oes de opera\u00e7c\u00e3ao do sistema. A se\u00e7ca\u00e3o a seguir descreve com mais detalhes quais condicoes devem ser atendidas pelo m\u00e1dulo de controle.\n1.2\tObjetivo desta disserta\u00e7\u00e3o\nO problema estudado refere-se \u00e0 estrat\u00e1gia de controle usada para alterar a frequ\u00eancia da bomba centr\u00edfuga, relacionada com o fluxo de sa\u00edda de l\u00edquido do VASPS, de modo a manter o n\u00edvel de l\u00edquido no reservat\u00e1rio dentro de uma faixa de operac\u00e3o. Se o n\u00edvel de l\u00edquido ultrapassar um limite ma\u00e1ximo, a efici\u00eaencia do processo de separa\u00e7c\u00e3ao diminui, uma vez que a \u00edarea u\u00edtil da h\u00edelice \u00ede reduzida. Por outro lado, se o n\u00edvel tornar-se menor que um limite m\u00ednimo, o funcionamento da bomba fica comprometido e ela pode sofrer danos graves, pois sua tolera\u00eancia \u00e0 entrada de g\u00e1s \u00e1 pequena. Dentro dos limites superior e inferior de excurs\u00e3o, o l\u00edquido pode variar livremente sem nenhum preju\u00edzo, por\u00edem deve-se atentar para o risco de operar pr\u00edoximo aos extremos de n\u00edvel permitidos.\nAl\u00edem disso, h\u00eda a preocupac\u00e7a\u00e3o com o aumento da vida u\u00edtil da bomba. Isso \u00ede particularmente importante porque qualquer interven\u00e7c\u00e3ao para reparos ou manutenc\u00e7\u00e3ao tem custos muito elevados por causa da localiza\u00e7\u00e3o submarina do VASPS. Ha, tamb\u00e9m, a perda pela parada dos po\u00e7os conectados ao sistema. E frequente, inclusive, que essa parada dure dias se a necessidade de interven\u00e7\u00e3o for inesperada, pois \u00e1 preciso que haja uma sonda de interven\u00e7\u00e3o espec\u00edfica dispon\u00edvel. O impacto destes altos custos deve ser levado em conta pelo controlador, que deve buscar o prolongamento da vida u\u00edtil da bomba. Isto \u00ede alcan\u00e7cado quando o acionamento evita mudan\u00e7cas frequentes na rota\u00e7c\u00e3ao da bomba. O controle deve, portanto, ter uma pol\u00edtica cautelosa, de modo a minimizar as altera\u00e7c\u00e3oes da frequ\u00eaencia do motor e consequentemente reduzir o seu desgaste.\nConforme j\u00e1 mencionado, a vaz\u00e3o de entrada pode variar por efeito de golfadas ou de queda de po\u00e7cos. Ela est\u00eda sujeita tamb\u00edem a um decaimento lento ao longo do tempo, relacionado ao envelhecimento dos po\u00e7cos, que pode ser tratado com um reajuste dos para\u00eametros do modelo baseado no comportamento m\u00e1dio da vaz\u00e3o em um per\u00edodo recente. A vaz\u00e3o de sa\u00edda \u00e1 controlada pela bomba centr\u00edfuga. Existem sensores para medir o n\u00edvel de l\u00edquido no reservat\u00e1rio, por\u00edem n\u00e3ao ha\u00ed medi\u00e7c\u00e3ao de vaza\u00e3o.\no tratamento do VASPS quando n\u00e3o ocorre queda de poco, visto que n\u00e3o h\u00e1 varia\u00e7\u00e3es muito grandes na vaz\u00e3o de entrada mas sim flutua\u00e7\u00e3es cont\u00ednuas. As quedas de po\u00e7os podem ser contornadas com a criac\u00e3o de v\u00e1rios modelos de difus\u00e3o ajustados para diferentes vaz\u00e3es nominais e usando as informacoes da vaz\u00e3o para alternar entre um modelo e outro, conforme ser\u00e1 comentado na Se\u00e7ao 5.2.\nUma aplicacao semelhante em que o objetivo nao \u00e1 a regulac\u00e3o, \u00e1 o controle de n\u00e1vel mediado de l\u00e1quido (em ingl\u00eas, Averaging Level Control), vide [9]. Ele aparece em muitas aplicac\u00e3es industriais para controle de n\u00e1vel de l\u00e1quido em reservato\u00e1rios com fun\u00e7c\u00e3ao de armazenamento (buffer) para evitar propaga\u00e7\u00e3o de disturbios. Em problemas desse tipo, o controlador deve manter o n\u00e1vel de l\u00e1quido dentro de uma faixa de excurs\u00e3ao, como no caso da nossa aplicac\u00e7\u00e3ao, por\u00e9m a outra preocupa\u00e7ao \u00e1 com a suavidade do fluxo de sa\u00e1da e n\u00e3o com a quantidade e intensidade das interven\u00e7\u00e3es. Ainda nesta linha, outras refer\u00eancias relevantes s\u00e3o [10] e [11]. Diferentes abordagens para o controle de n\u00e1vel mediado s\u00e3o discutidas em [12].\nUma outra proposta parecida com o controle de n\u00e1vel mediado \u00e1e o controle de faixa (em ingl\u00eas, Band control) proposto tamb\u00e1m para aplica\u00e7ao na industria de petroleo, em que se tem dispon\u00e1vel apenas a medida de n\u00e1vel e deseja-se mant\u00eae-lo dentro de uma faixa de excursa\u00e3o, com suaviza\u00e7\u00e3o da sa\u00e1da, vide [13]. Especificamente para o VASPS tamb\u00e1m foi utilizado um controlador PID com l\u00e1gica fuzzy, [5].\nA seguir, apresenta-se um primeiro esbo\u00e7co sobre a solu\u00e7ca\u00e3o adotada, que ser\u00e1a formalizada nos Cap\u00e1tulos 2 e 3.\n1.3\tA proposta de solu\u00e7\u00e3o\nDuas variaveis caracterizam o estado no VASPS, o n\u00edvel de l\u00edquido ht no reservat\u00f3rio e o balan\u00e7o entre vazao de entrada\t(qf)\te vazao de sa\u00edda\t(qf),\trepresentado por\tSt\t=\tqf\t\u2014\tqf.\tO\nespa\u00e7o de estados, denominado X?, \u00f3 representado na Figura 1.3.\nPara o VASPS, a equac\u00e7a\u00e3o do balanc\u00e7o de massa estabelece que o balan\u00e7co de vaz\u00e3ao de l\u00edquido no reservat\u00edorio induz um acr\u00edescimo ou diminuic\u00e7\u00e3ao do volume de l\u00edquido armazenado se o balanc\u00e7o for, respectivamente, positivo ou negativo. Como a \u00f3rea Ar da se\u00e7ao transversal \u00f3 constante, isto implica em uma varia\u00e7\u00e3o no n\u00edvel do reservat\u00f3rio, que pode ser expressa por\ndht\t1\n= Ar ' +\n(1.1)\nh /\\\nhmax\n\tX\nhmin\n-I---\n'min\n^max\n\u00d5\nFigura 1.3: Espa\u00e7o de estados no modelo do VASPS.\nJ(x) = inf Ex vev\n\u2022\tum custo de interven\u00e7\u00e3o c, que indica o desgaste causado pela altera\u00e7\u00e3o da frequ\u00eancia da bomba, pago a cada intervenc\u00e3o;\n\u2022\tum custo de continua\u00e7\u00e3o r, que representa o risco de continuar sem nenhuma atuac\u00e3o, continuamente pago como uma fun\u00e7c\u00e3ao do estado atual.\nO Cap\u00edtulo 2 apresenta com mais detalhes essa t\u00e9cnica, mas adianta-se que, se algumas hip\u00f3teses forem satisfeitas, [14], o custo \u00e9timo \u00e9 definido como\nT\ne~atr(Xt)dt +\te-aTic(XT-, AX^)1{t^<t} + e-aTX X)1{t<~}] , (1.2)\ni=1\nem que Ex[.] representa a esperanca matem\u00e9tica sobre o processo markoviano de difus\u00e3o t Xt, com Xt = (\u00e3t,ht), x indicando o estado inicial X0, a um fator de desconto, Ti as variaveis que representam os instantes de ocorr\u00eancia das interven\u00e7\u00e3es, T o instante em que a fronteira \u00e9 alcancada e 1{.} uma funcao indicadora que so vale 1 quando {\u2022 } \u00e9 verdadeira, ou em outras palavras quando x G {\u2022}, e\u00e9 nula em caso contrario.\nO risco de continuac\u00e7a\u00e3o r esta associado ao risco de manter a mesma frequ\u00eaencia no bombea-mento ao longo do caminho t Xt do processo. Assim, assume valores elevados quando o n\u00e9vel esta pr\u00e9ximo do maximo e o balan\u00e7o de vaz\u00e3o \u00e9 positivo ou o n\u00edvel est\u00e9 pr\u00e9ximo do m\u00ednimo e o balan\u00e7o de vazao \u00e9 negativo. Os resultados obtidos nesta disserta\u00e7\u00e3o foram baseados em uma fun\u00e7\u00e3o de risco quadr\u00e9tica com essas caracter\u00edsticas, conforme ser\u00e9 apresentado no Cap\u00e9tulo 4. A Figura 1.4 apresenta o espaco de estados com sinais \u201c-\u201d nas regioes menos arriscadas e sinais \u201c+\u201d onde \u00e9 mais perigoso continuar sem atuar.\nO custo terminal ^, definido nas fronteiras, segue l\u00e9gica semelhante, com valores elevados nos mesmos extremos em que o risco atinge seu valor m\u00e9aximo e valores menores nos extremos opostos.\nh /\\\n\t+\t+ +\n\t\t+\n\u2014\t\u2014\t\n\u2014\t\u2014\t\n+\t\t\n+ + +\t\t\u2014\n5\nFigura 1.4: Espa\u00e7o de estados no modelo do VASPS.\nQuanto maior o tamanho e o nUmero de varia\u00e7\u00e3es de frequ\u00eancia da bomba, maior o seu desgaste e, consequentemente, menor sua vida util. Como o custo de interven\u00e7ao c \u00e9 pago sempre que o controlador decide atuar, um grande numero de variac\u00e3es na frequ\u00eancia implica no aumento do custo \u00e9timo J. Para refletir o fato do desgaste ser proporcional \u00e0 amplitude da varia\u00e7c\u00e3ao da frequ\u00eaencia, o custo de interven\u00e7c\u00e3ao deve crescer com o aumento do tamanho das interven\u00e7\u00f5es. Uma fun\u00e7ao proporcional ao m\u00e9dulo da variac\u00e3o de frequ\u00eancia parece ser adequada.\nO problema de controle impulsional resulta em uma soluc\u00e3o espacial, em que se mapeia em quais estados o controlador deve atuar e qual deve ser o tamanho da atuac\u00e7\u00e3ao, sem depend\u00eaencia direta do tempo, j\u00e1 que os processos e custos s\u00e3o todos homog\u00eaneos no tempo. E necessario, portanto, conhecer o estado em que o sistema esta\u00e9 operando para decidir a a\u00e7c\u00e3ao de controle. Para a modelagem proposta, isso significa ter informa\u00e7\u00e3o do n\u00edvel do l\u00edquido e do balan\u00e7o de vaz\u00e3o, isto \u00e9, das vaz\u00e3es de entrada e de sa\u00edda. A vaz\u00e3o de sa\u00edda \u00e9 determinada pelo controlador, logo \u00e9e conhecida. E\u00e9 poss\u00e9vel medir o n\u00e9vel de l\u00e9quido no reservat\u00e9orio, no entanto os valores medidos possuem uma imprecisao que deve ser levada em conta. N\u00e3o ha medi\u00e7\u00e3o de vaz\u00e3o, por\u00e9m o balanc\u00e7o de vaza\u00e3o pode ser estimado com base na variac\u00e7a\u00e3o do n\u00e9vel de l\u00e9quido, utilizando um processo de estimac\u00e3o dos estados h e 5 via filtragem.\n1.4\tApresenta\u00e7\u00e3o da disserta\u00e7\u00e3o\nO Cap\u00e9tulo 2 descreve o modelo estoc\u00e1stico baseado em processo de difus\u00e3o usado para modelar o sistema e a teoria empregada para solucionar o problema de controle de n\u00e9vel com as restric\u00e3es comentadas anteriormente. Utilizou-se a t\u00e9cnica de controle impulsional para definir os instantes em que se deve intervir no sistema, al\u00e9em de determinar qual deve ser a intensidade de cada intervenc\u00e7\u00e3ao. O cap\u00e9tulo aborda tamb\u00e9em a transforma\u00e7ca\u00e3o do problema de controle para uma representa\u00e7ca\u00e3o por desigualdades variacionais, cujos passos intermedi\u00e9arios consistem em convert\u00eae-lo em uma sequ\u00eaencia de problemas de parada \u00e9otima iterados. A equival\u00eaencia entre as sequ\u00eancias de problemas de parada otima e o controle impulsional com quantidade maxima de intervenc\u00e3es n \u00e9 desenvolvida, bem como a equival\u00eancia entre os problemas de parada \u00e9tima e\nas desigualdades variacionais a eles associadas. Finalmente, analisa-se o comportamento limite, obtendo uma associa\u00e7ca\u00e3o entre a sequ\u00eaencia de problemas de parada \u00e9otima e o problema original de controle impulsional com nu\u00e9mero ilimitado de interven\u00e7c\u00e3oes.\nPara resolver o problema, utiliza-se um m\u00e9etodo num\u00e9erico que discretiza as desigualdades variacionais e obt\u00e9em sua formula\u00e7c\u00e3ao como problema de programac\u00e7\u00e3ao linear, para o qual existe diversos algoritmos de soluc\u00e7\u00e3ao conhecidos. O Cap\u00e9tulo 3 apresenta esse m\u00e9etodo num\u00e9erico, denominado Discretizac\u00e3o do Valor M\u00e9dio, MVS (do ingl\u00eas, Mean Value Scheme). O m\u00e9todo consiste na discretizac\u00e7\u00e3ao do espac\u00e7o de estados e na utilizac\u00e7\u00e3ao de bolas centradas em cada no\u00e9 para aproximar as integrais que aparecem na soluc\u00e7a\u00e3o anal\u00e9tica, por meio dos valores nos n\u00e9os vizinhos, que se encontram sobre a circunfer\u00eaencia. Como essa t\u00e9ecnica foi criada para resolver sistemas descritos por uma equa\u00e7c\u00e3ao de Helmholtz e a desigualdade variacional \u00e9e uma inequa\u00e7c\u00e3ao el\u00e9ptica, algumas transforma\u00e7co\u00e3es sa\u00e3o usadas para obter uma desigualdade na forma de Helmholtz. Essas transforma\u00e7c\u00e3oes tamb\u00e9em est\u00e3ao descritas nesse cap\u00e9tulo. Para facilitar a aplica\u00e7ca\u00e3o em outros casos, toda a teoria foi desenvolvida baseada em equa\u00e7c\u00e3oes gerais e a descri\u00e7c\u00e3ao para o caso particular do VASPS \u00e9e apresentada em uma sec\u00e7\u00e3ao separada.\nEm seguida, o Cap\u00e9tulo 4 apresenta os resultados obtidos na simula\u00e7c\u00e3ao do VASPS. Trata-se da obten\u00e7c\u00e3ao de uma regi\u00e3ao de continuidade no espa\u00e7co de estados e de uma curva de estados \u00e9otimos para onde a opera\u00e7c\u00e3ao do sistema deve migrar em caso de intervenc\u00e7\u00e3ao. Enquanto o sistema opera dentro da regia\u00e3o de continuidade, na\u00e3o deve ser feita nenhuma modificac\u00e7a\u00e3o na rota\u00e7c\u00e3ao da bomba centr\u00e9fuga. Ao sair dessa regi\u00e3ao, o atuador deve alterar a frequ\u00eaencia da rota\u00e7ca\u00e3o da bomba de modo a enviar o estado para o ponto indicado como \u00e9otimo a partir do estado em que ele se encontrava. Para a utiliza\u00e7c\u00e3ao de dados reais, foi necess\u00e9ario fazer um escalonamento no tempo, tamb\u00e9em descrito nesse cap\u00e9tulo.\nComo forma de validar os resultados obtidos e permitir uma an\u00e9alise do nu\u00e9mero de inter-ven\u00e7c\u00e3oes, foi criado um simulador do sistema, que cria uma sequ\u00eaencia de dados de vaz\u00e3ao e simula a din\u00eamica da planta e do controlador. No simulador tamb\u00e9m deve-se utilizar um filtro, que retorna dados estimados do n\u00e9vel de l\u00e9quido e da vaza\u00e3o de entrada a partir das medidas diretas do n\u00edvel. Uma proposta de abordagem para a filtragem e o simulador est\u00e3o descritos no Cap\u00edtulo\n5.\nPor fim, um resumo dos resultados obtidos e as perspectivas de trabalhos futuros s\u00e3ao apresentados no Cap\u00e9tulo 6.\nO Ap\u00eaendice A apresenta alguns conceitos de processos estoc\u00e9asticos em geral e em especial aqueles relacionados a processos de difus\u00e3ao. Para estudar os conceitos de forma mais aprofundada, sugere-se os livros [15] e [16] de introdu\u00e7\u00e3o a processos estoc\u00e1sticos e [17] para as propriedades do movimento browniano e de processos de difus\u00e3o. No Ap\u00eandice B s\u00e3o mostradas as matrizes expandidas citadas no Cap\u00e9tulo 3, necessarias para incluir os pontos de fronteira na formulac\u00e7\u00e3ao do problema de programac\u00e7a\u00e3o linear obtido com a aplicac\u00e7\u00e3ao do MVS.\nControle Impulsionai e sua Aplica\u00e7\u00e3o no VASPS\nO controle impulsional visa a minimiza\u00e7\u00f5o do valor esperado de um funcional de custo do processo que pesa o risco de continuar sem atuar e o custo de intervir. O objetivo \u00e9 achar os instantes de atua\u00e7c\u00f5ao e os tamanhos de cada interven\u00e7c\u00f5ao que tornam esse custo m\u00e9nimo. Para aplicar essa t\u00e9cnica ao VASPS, primeiro foi necess\u00e9rio obter um modelo estoc\u00e9stico em tempo cont\u00ednuo para o problema, como ser\u00e9 visto na se\u00e7ao 2.1. As sec\u00f5es 2.2 a 2.4 formulam o problema de controle impulsional, sua convers\u00f5ao em problemas de parada o\u00e9tima iterados e sua descric\u00f5o com desigualdades variacionais. A equival\u00eancia entre as sequ\u00eancias de parada \u00e9tima e o controle impulsional com quantidade m\u00e9xima de interven\u00e7\u00f5es n e a converg\u00eancia desse para o caso sem limitac\u00f5o de interven\u00e7\u00f5es s\u00f5o enunciadas na Se\u00e7\u00f5o 2.3 e a equival\u00eancia entre as desigualdades variacionais e o controle impulsional na Sec\u00f5o 2.4. As demonstrac\u00f5es desses resultados encontram-se na Se\u00e7\u00f5o 2.5.\n2.1\tModelagem do sistema\nComo descrito na Se\u00e7ca\u00f5o 1.3, o modelo do VASPS utiliza duas vari\u00e9aveis de estado, o n\u00e9vel de l\u00edquido no reservat\u00f3rio, ht, e o balanco entre vazao de entrada e vazao de sa\u00edda, isto \u00e9, 5t = qf \u2014 qf. Assim, definiu-se um espa\u00e7o de estados X? formado por um conjunto aberto X e sua fronteira dX, no qual o processo t Xt toma seus valores, com Xt = (\u00f4t,ht). O espa\u00e7o de estados \u00e9, ent\u00f5o, dado por X? = [\u00bfmin, \u00e3max] x [hmin, hmax], conforme representado na Figura 1.3.\nA incerteza na vazao de entrada de l\u00edquido \u00e9 modelada como uma flutua\u00e7\u00f5o em torno de um valor nominal, cuja variac\u00f5o \u00e9 induzida por um movimento browniano. Este processo formalmente representa a integral de um processo de ru\u00eddo branco cont\u00ednuo, [8]. O Ap\u00eandice A apresenta uma breve definic\u00e7\u00f5ao do processo denominado movimento browniano, ou processo de Wiener, e conceitos relevantes ao estudo deste processo e, de forma mais geral, de processos de difusa\u00f5o. E\u00e9 recomend\u00e9avel que o leitor deste cap\u00e9tulo que na\u00f5o esteja familiarizado com o assunto consulte esse ap\u00eaendice.\nUm processo de difus\u00e3o \u00f3 descrito por uma forma diferencial estocastica de It\u00f4 dada por\ndXt = b(Xt)dt + a(Xt)dBt,\n(2.1)\nem que b : Rk\tRk e a : Rk\tRkxm s\u00e3o fun\u00e7oes dadas que satisfazem a condi\u00e7\u00e3o de\nexist\u00eancia e unicidade de equa\u00e7\u00e3es diferenciais estoc\u00e1sticas (Teorema 5.2.1, [8]). A equac\u00e3o (1.1), que descreve a evolu\u00e7c\u00e3ao dos estados do sistema, pode ser formalizada por uma forma diferencial como (2.1), a saber\ndht\nd\u00f4t )\ndt +\naii\na21\na12\tdB1 \\\n022\tdB2 ) \u2019\n(2.2)\nem que B}, Bt2 sao movimentos brownianos padroes unidimensionais descritos em um espa\u00e7o de probabilidades filtrado (Q,F,{Ft}t^0,P) e Oj sao os coeficientes de desvio-padr\u00e3o relacionados a esses processos brownianos. Verifica-se facilmente que essa formula\u00e7c\u00e3ao satisfaz as condic\u00e7o\u00e3es do Teorema 5.2.1 de [8], pois os coeficientes aj sao constantes e os elementos do vetor b(Xt) possuem varia\u00e7c\u00e3oes lineares em rela\u00e7c\u00e3ao ao estado Xt.\nNo modelo do VASPS, sa\u00e3o usados movimentos brownianos descorrelacionados, isto \u00f3e, os coeficientes de desvio-padr\u00e3o cruzados (a12 e a21) sao nulos. O uso de ru\u00eddos correlacionados \u00f3 desnecess\u00f3rio, uma vez que o n\u00f3vel ht ja \u00f3 indiretamente afetado pelas flutuacoes no balanco de vazao, pois dht depende de \u00f4t. Al\u00f3m disso, essa suposicao simplifica a transforma\u00e7\u00e3o de estados do Cap\u00f3tulo 3, conforme ser\u00e1 comentado posteriormente. O coeficiente a22 est\u00e1 relacionado com a incerteza na vaz\u00e3o de entrada e a11 refere-se a uma incerteza no n\u00f3vel, que relaxa ligeiramente a rela\u00e7c\u00e3ao de balan\u00e7co de massa. Essa escolha pode ser justificada devido a imprecis\u00e3oes decorrentes tanto das flutuac\u00e7\u00e3oes na vaza\u00e3o quanto das medidas de n\u00f3vel.\n2.2\tCusto do controle impulsional\nA equa\u00e7c\u00e3ao (2.1) modela a evolu\u00e7c\u00e3ao do sistema entre interven\u00e7co\u00e3es. No instante de uma interven\u00e7ao, o processo Ft-adaptado t\tXt \u00f3 cont\u00f3nuo \u00e0 direita mas n\u00e3o a esquerda, isto \u00f3,\nlim Xt = XTi = lim Xt = XT -.\nO problema de controle impulsional consiste em determinar os tempos de parada Ft-mensura-veis t1 &lt;t2 &lt;..., nos quais as interven\u00e7\u00f5es ocorrem, e o tamanho de cada uma delas. Os tamanhos s\u00e3o dados por AXT1 ,AXT2,..., em que cada AXTi = XTi-X - \u00f3 suposto FTi-mensur\u00e1vel e AXTi G G, G um conjunto dado de valores de impulso admiss\u00f3veis. O efeito de um impulso AXTi \u00f3 que o estado salta imediatamente de um estado XT- para o novo estado XTi = r(XT- ,AXTi), r : Rk x G \u25a0 Rk. O conjunto V de todas as sequ\u00eancias de controle admiss\u00f3veis \u00f3 denotado por\nJ(x) = inf Ex\nvev\nA sequ\u00eancia de controle \u00f3tima v* \u00e9 determinada pela minimizacao na classe V da fun\u00e7\u00e3o custo. Conforme apresentado em (1.2), o custo \u00f3timo J, obtido pela minimiza\u00e7ao do valor esperado do funcional de custo do processo t Xt, \u00e9 definido por\nT\ne~atr(Xt)dt ^2 e~aTic(Xrr AXt\u00ed)1^<t} + e-aT^(XT)1{t<~}] ,\t(2.4)\ni=1\nem que X0 = x, a \u00e9 um fator de desconto, t\u00bf,i = 1,2,... s\u00e3o os tempos de parada nos quais as interven\u00e7\u00f5es ocorrem e T \u00e9 o instante em que a fronteira \u00e9 alcancada, isto \u00e9, T = inf{t > 0 : Xt G dX} [14]. No custo J, aparecem o custo terminal : dX R, se o estado atingir a fronteira, o custo de intervenc\u00e3o c : X x G \u25a0 R, pago em cada interven\u00e7ao e dependente do estado imediatamente antes da interven\u00e7ao, bem como do tamanho da mudan\u00e7a e o risco de continua\u00e7ao r : .'V ' R, que e continuamente pago como uma func\u00e3o do estado atual.\nDeve-se garantir que os estados nao ficar\u00e3o arbitrariamente grandes em um tempo finito. Isso significa que o tempo de explosao do vetor de estados Xt deve ser infinito quase certamente. O tempo de explos\u00e3o e definido como o primeiro instante em que a norma do vetor de estados ultrapassa um valor R arbitrariamente grande, isto \u00e9,\nT* = T\u00bb = lim inf{t > 0; |X(t)| > R}.\t(2.5)\nRx'x.\nPara que o problema seja bem formulado, sup\u00f5e-se ainda que c e r s\u00e3o fun\u00e7\u00f5es cont\u00ednuas\ne\n$\nt = x q.c.;\n(2.6)\nlim Tj = T q.c.;\njx^\nE x\n|e-atr(Xt )|dt\n&lt;x, Vx G Rk, v G V;\nn\nEx[!2\\e-aTic(XT-,AXn)1{t,<t}|] &lt;x, Vx G Rk,v G V;\ni=1\n(2.7)\n(2.8)\n(2.9)\nEx \\e-aTrf>(XT)\n&lt;x, Vx G Rk, v G V.\n(2.10)\nsatisfaz Tj &lt;Tj+i,j = 0,1,... q.c. para todo Xt G X; caso contrario a sequ\u00eancia {tj} poderia se acumular em tempo finito inferior a T e violaria (2.7).\nO desenvolvimento matem\u00f3tico de controle impulsional est\u00f3 detalhado em [6] e mais recentemente em [7]. Essa formula\u00e7\u00e3o \u00f3 muito aplicada em controle de estoques [18], [19], [20], em problemas de taxa de c\u00eambio [21], [22], [23], e na otimiza\u00e7\u00e3o de portfolios com custos de transac\u00e3o [24], [25]. Em [26] ha um levantamento das aplicac\u00e3es em matematica financeira (problema de gerenciamento de dinheiro (cash), controle otimo de uma taxa de c\u00eambio e otimiza\u00e7ao de portfolio com custos de transa\u00e7ao). Outra aplicac\u00e3o de controle impulsional encontrada na literatura \u00e9 na area de manejo de florestas, vide [27].\nAo resolver o problema de controle impulsional em aplica\u00e7\u00e3es, dificilmente e poss\u00edvel obter soluc\u00e3es anal\u00f3ticas. Um metodo de solu\u00e7\u00e3o direta \u00e9 explorado em [28] para problemas de difus\u00e3o unidimensionais; uma soluc\u00e3o num\u00e9rica para o problema \u00f3 estudada em [29], e uma aproximac\u00e3o estoca\u00f3stica com sintonia de coeficientes por meio de t\u00f3ecnicas de simula\u00e7c\u00e3ao exaustiva em [30]. Nesta dissertacao a abordagem utilizada \u00f3 a de descrever o problema como uma sequ\u00eancia de desigualdades variacionais e resolv\u00ea-las atrav\u00f3s do m\u00f3todo MVS, [31].\n2.3\tProblemas de parada \u00f3tima iterados\nO problema de controle impulsional com um nu\u00f3mero ilimitado de interven\u00e7c\u00e3oes na\u00e3o pode ser convertido diretamente em problemas de parada \u00f3otima, uma vez que a escolha do instante e da amplitude de uma intervenc\u00e7a\u00e3o influencia as pr\u00f3oximas escolhas. Por outro lado, o problema de controle impulsional com at\u00f3 n interven\u00e7\u00e3es pode ser convertido, sob certas condic\u00e3es, na solu\u00e7\u00e3o iterativa de n problemas de parada \u00f3tima. Al\u00f3m disso, quando n x, a fun\u00e7ao custo do problema restrito a at\u00f3e n interven\u00e7co\u00e3es pode convergir para a fun\u00e7c\u00e3ao custo do problema de controle impulsional com quantidade ilimitada de interven\u00e7co\u00e3es, contanto que certas condi\u00e7c\u00e3oes t\u00f3ecnicas sejam satisfeitas.\nConcentrando-se no problema limitado a n interven\u00e7\u00e3es, o conjunto Vn de todas as sequ\u00eancias de controle admiss\u00f3veis \u00f3e denotado por\nVn = {v := (ti,T2,...,Tk; AXT1 ,AXT2,...,AXTfc), k &lt;n}.\t(2.11)\nA sequ\u00eancia de controle otima v* com at\u00f3 n interven\u00e7\u00e3es \u00f3 determinada pela minimizac\u00e3o na classe Vn da fun\u00e7\u00e3o custo Jn\nJn(x) = inf Ex\nvevn\nn\ne-at r(Xt)dt +\ni=1\ne-aT\u2018 c(XT- ,AXr, )1(r,<T > + e-\u201cT^(Xr )1<T<\u00bb}\n(2.12)\nem que x, a, {t^} e T sao definidos como anteriormente.\nOs n problemas de parada \u00f3otima iterados que convergem para a mesma soluc\u00e7\u00e3ao do controle impulsional s\u00e3o descritos a seguir. Considere a fun\u00e7\u00e3o de custo terminal estendida, dada por ^(X),\tse X G dX,\nde classe C2(X), se X G X;\t( . )\n<^(X) = \u00ed\ne defina o operador M : C2(X)\tC2(X) tal que para (f> G C2(X) e qualquer x G X, M \u00e9\nescrito como\nM[?](x) = inf {c(x,y - x) + 0(y)\\ .\t(2.14)\nOs problemas sucessivos de parada \u00e9tima a serem resolvidos s\u00e3o formulados como\ne\nV0(x) = Ex\ne atr(Xt)dt + e aT<(Xt)1.{T<x\nV i(x) = inf Ex\nT\ne~atr(Xt)dt + e~aT M[V i-1](XT -)\n(2.15)\n(2.16)\n\n\ncom i = 1,... ,n.\nConforme mencionado, o custo final Vn obtido pelos n problemas de parada \u00e9tima iterados \u00e9 o mesmo do controle impulsional limitado a n interven\u00e7\u00f5es, com uma restric\u00e3o sobre as funcoes r, e M[Vi-1], como enunciado no Teorema 2.1 a seguir. Antes de enunciar o teorema, por\u00e9m, uma defini\u00e7c\u00e3ao \u00e9e necess\u00e9aria.\nUma func\u00e3o h : Rk\tR de crescimento polinomial satisfaz a propriedade de que existem\nconstantes C e m (dependentes de h) tais que\n\\h(x)\\ &lt;C(1 + |x|m),\tVx G Rk.\nTeorema 2.1 Se r, e MV 1] sao de crescimento polinomial para i = 1,2,..,n, entao\nn\nAs fun\u00e7oes r e $ s\u00e3o escolhidas de forma a satisfazer a condi\u00e7ao de crescimento polinomial. Como M[Vi-1] envolve o custo \u00f3timo resultado da minimiza\u00e7\u00e3o, em geral n\u00e3o \u00e9 poss\u00edvel afirmar que tenha crescimento polinomial. Na resolu\u00e7\u00e3o do problema, deve-se dar aten\u00e7ao a essa hip\u00e9tese para garantir que a solu\u00e7\u00e3o dos problemas de parada otima convirja \u00e0 solu\u00e7ao do controle impulsional.\nEsse teorema baseia-se no Teorema 7.2 de [7]. Sua demonstra\u00e7\u00e3o encontra-se na Se\u00e7ao 2.5 e \u00e9 semelhante a de [7], por\u00e9m com custo descontado e visando o problema de minimiza\u00e7\u00e3o do custo em vez de maximiza\u00e7c\u00e3ao de um lucro. Alem disso, o problema aqui abordado na\u00e3o envolve difus\u00e3ao com saltos, simplificando os resultados. O mesmo vale para a demonstrac\u00e7\u00e3ao do lema a seguir, baseado no Lema 7.1 de [7], que sera tambem apresentado na Se\u00e7\u00e3o 2.5. Esse lema estabelece que (2.12) converge para a fun\u00e7ca\u00e3o custo (2.4) do problema de controle impulsional com quantidade ilimitada de interven\u00e7c\u00e3oes:\nLema 2.1 Se 0\t0, ent\u00e3o\nlim Jn(x) = J(x), Vx G X.\t(2.17)\nn\u2014:<.\nA sec\u00e3o a seguir converte os problemas de parada otima iterados em uma sequ\u00eancia de desigualdades variacionais, o que permitira a aplicac\u00e3o do metodo numerico proposto no Cap\u00e9tulo 3 para solu\u00e7ao do problema.\n2.4\tDescricao por desigualdades variacionais\nO operador parcial diferencial de segunda ordem A de um processo de difus\u00e3o de It\u00ea Xt definido em R\u201d e homog\u00eaneo no tempo \u00f3 definido por\nAf (x) = lim EX[f (X\u2018)]- f (x), x E R\u201d.\ni.\u00b0\tx\t\u2019\n(2.18)\nt\nO operador A \u00f3 chamado gerador do processo Xt e o conjunto de funcoes f : R\u201d R para as quais o limite existe para todo x E R\u201d \u00f3 denotado por DA e consiste no dom\u00f3nio do gerador. Para um processo de difusao dado pela equa\u00e7ao (2.1) e f E Cj|(R\u201d), tem-se que f E DA e\nAf&lt;x) = \u00a3 Mx)f +1 \u00a3 - . \u00ab '\ni\tij\tJ\n(2.19)\nTeorema 2.2 [8] Seja f E Cq(R\u201d) e t um tempo de parada tal que Ex[t] &lt;x. Entao\nE x[f (Xt )] = f (x) + Ex\n\u00ed Af (Xs)ds .\n\u00b0\n(2.20)\nEssa expressao \u00e9 conhecida como formula de Dynkin. E interessante ressaltar que se t e escolhido como o instante da primeira sa\u00f3da de um conjunto limitado, ent\u00e3o Ex[t] &lt;x e (2.20) pode ser aplicada para qualquer func\u00e3o f E Cq.\nUma generalizac\u00e3o da formula de Dynkin pode ser usada para abranger func\u00e3es que tenham uma depend\u00eancia direta do tempo. A integral que aparece em (2.20) passa a operar sobre um diferencial d(.) da funcao. Assim, para o caso particular em que f (t,Xt) = e-atV(Xt), com V E Cq(X), obtem-se\nE X[e-aT V (Xt )] = e-a'\u00b0V (x) + Ex\nV (x) + Ex\nV (x) + Ex\n\u00ed d(e-asV(Xs))ds .\n\u00b0 {\u00a3&lt;e e-as\n\u00b0\n-asV(Xs)) + e-asAV(Xs)ds .\n(-aV(Xs) + AV(Xs))ds .\n(2.21)\nDessa forma, aplicando (2.21) para um tempo de parada t que coincida com uma intervenc\u00e3o e considerando que o processo e apenas cont\u00f3nuo \u00e0 direita,\nV (x) = Ex\n[ e-as(aV(Xs) - AV(X\u00e2))ds + e-aTV(Xt-) . \u00b0\n(2.22)\nDa equa\u00e7\u00e3o do problema de parada \u00f3tima iterado (2.16), percebe-se que V*(x) &lt;M[Vi-1 ](x) para todo x E X, pois quando XT- = x tem-se a igualdade Vz(Xt-) = M[Vi-1](XT-) e para qualquer t otimo diferente do instante inicial, a desigualdade estrita deve ser satisfeita para que\no m\u00ednimo nao ocorra exatamente no estado inicial x. Substituindo M[V* 1](XT-) em (2.16), obt\u00e9em-se\n&lt;Ex\nV i(x) = inf Ex\nT\ne-atr(Xt )dt + e-aT V Z(XT -)\ne-atr(Xt)dt + e-aT V i(XT -)\nEmpregando (2.22) com V = Vz em (2.24), obt\u00e9m-se\nEx\ne-as\n0\n(AVi(Xs) - aVi(Xs) + r(Xs)) ds > 0\n(2.23)\n(2.24)\n(2.25)\nComo Vz, AVz e r s\u00e3o fun\u00e7\u00e3es cont\u00e9nuas e a desigualdade deve valer para qualquer tempo de parada t, \u00e9 poss\u00edvel reescrever (2.25) dividindo-se por t e calculando o limite da expressao quando t 0+ [32]. Isso resulta em\nAV*(Xo) - aVi(Xo) + r(Xo) > 0.\n(2.26)\nObt\u00e9m-se, ent\u00e3o, o seguinte resultado:\nLema 2.2 Se Vz(x) G C2(X) e solu\u00e7\u00e3o do problema de parada \u00f3tima em (2.16), entao ela satisfaz\nVi(x) &lt;M[Vi-1](x),\nou\nAVi(x) \u2014 aVi(x) + r(x) > 0,\n(2.27a)\n(2.27b)\nsendo (2.27a) ou (2.27b) satisfeita com igualdade para todo x G X e com Vz(x) = f(x), para todo x G dX. Isso \u00e9 valido para i = 1,... ,n e Vo(x) e dado por (2.15).\nObservacao 1 Note que (2.27) determina regi\u00f5es de comportamentos distintos. Defina D = {x G X; V*(x) &lt;M[Vi-1 ]} e note que Dc U D = X. Enquanto o processo encontra-se no interior de D, ele evolui livremente e nao ocorrem interven\u00e7\u00f5es, por isso D e chamada regiao de continua\u00e7\u00e3o. Em Dc interven\u00e7\u00f5es devem ocorrer e, em geral, o processo e transferido de volta \u00e0 regiao de continuidade D.\nA dedu\u00e7c\u00e3ao acima mostra que o problema de parada o\u00e9tima da i-\u00e9esima itera\u00e7ca\u00e3o pode ser convertido nas desigualdades variacionais dadas por (2.27), mas n\u00e3o garantem que qualquer soluc\u00e3o desse sistema seja soluc\u00e3o do problema de parada \u00e9tima. O teorema a seguir, baseado no Teorema 10.4.1 de [8], estabelece as condi\u00e7\u00f5es para que isso seja verdade.\nTeorema 2.3 a) Suponha que seja poss\u00edvel encontrar uma fun\u00e7\u00e3o T : X?\tR que satisfa\u00e7a\nas seguintes condi\u00e7\u00f5es:\n1.\ttf G C1(X) n C(/V);\n2.\ttf G M[Vi-1] em X, M[Vi-1] G C2(X), e lim tf(Xt) = G(Xt)1.{t<x q.c.\nt^T-\nAlem disso, seja D = {x G X; tf(x) &lt;M[Vi-1 ](x)}. Sup\u00f5e-se que\n3.\tXt nao permanece na fronteira dD q.c., ou seja,\nE x\n(Xt)dt = 0,\nVx G X;\n4.\td D e uma superf\u00edcie de Lipschitz, isto e, para X G Rk, dD e localmente o grafo de uma fun\u00e7\u00e3o h : Rk-1\tR tal que existe K &lt;to com\n|h(x) - h(y)\\ G Klx - y\\,\tVx,y;\n5.\ttf G C2 (X\\dD) e as derivadas de segunda ordem de tf sao localmente limitadas proximo a dD;\n6.\tAtf \u2014 atf + r 0 em Dc.\nEnt\u00e3o,\ntf(x) G Vfix), Vx G X,\nem que Vz(x) e o custo do i-esimo problema de parada \u00f3tima, apresentado em (2.16).\nb) Suponha, ainda, que\n7. Atf \u2014 atf + r = 0 em D;\n8.\ttd := inf{t > 0; Xt / D} &lt;to q.c. em Qx, isto e, na lei de probabilidade de Xt iniciando-se em x, para todo x G X;\n9.\ta familia {tf(XT-); t G td ,t G T}, em que T e o conjunto de todos os tempos de parada menores que o tempo final T, e uniformemente integr\u00e1vel com respeito a Qx, para todo x E X.\nEntao obtem-se\nT\ntf(x) = Vfix') = inf Ex\nT eT\ne-atr(Xt)dt + e-aT M[Vz-1](Xt -)\n(2.28)\nVx G X,\ne td e um tempo de parada \u00f3timo para esse problema.\nComo visto no Teorema 2.1, o n-\u00f3simo problema de parada otima tem custo Vn igual ao custo do controle impulsional limitado a n interven\u00e7\u00e3es Jn e este converge para o custo do controle impulsional sem limite de interven\u00e7\u00e3es, J, conforme o Lema 2.1. J\u00f3 o Teorema 2.3 mostra que a solu\u00e7\u00e3o das desigualdades variacionais \u00f3 equivalente \u00e0 solu\u00e7ao do problema de\nparada \u00f3tima. Al\u00e9m disso, baseado no Teorema 6.2 de [7], a fun\u00e7\u00e3o T converge para a fun\u00e7\u00e3o custo de controle impulsionai J se modificarmos a condicao 2 para\n2\u2019. T &lt;M[T] em X e lim T(Xt) = MXT) 1\tq.c.\nt^T -\ne acrescentarmos as condi\u00e7c\u00e3oes\n10.\n|T(Xt \u25a0 \u25a0 |AT(X't)|dt\n&lt;x para todo t G T,x G X.\n11.\tAX G Argmin{c(x,.) + T(T(x,.))} G G existe para todo x G X e \u00e1 uma selec\u00e3o mensur\u00e1vel de Borel. Alem disso, T0 = 0 e define-se v = (T1,T2,...; AXi,AX2,...) indutivamente por T\u00ed+1 = inf{t > Tp X^ G D} A T e AXi+1 = X^ \u2014 X, em que X\u00e9 o resultado da\ni+1\tTi+1\naplicacao da sequ\u00eancia v\u00ed = (T1,...,T\u00ed; AX 1,...,AX\u00ed) em X.\n12.\tv G V e a fam\u00edlia {T(X-^v)); t G T} \u00e9 uniformemente integr\u00e1vel.\nCom as condi\u00e7\u00f5es 1-6 e 10 (e 2\u2019 no lugar de 2), demonstra-se que\nT(x) &lt;J(x), Vx G X,\ne as demais condic\u00e7\u00e3oes sa\u00e3o necessarias para demonstrar a igualdade.\nAs hip\u00f3teses do Lema 2.2 e do Teorema 2.3, juntamente com 2\u2019 e 10-12, garantem a cor-respond\u00eaencia entre a solu\u00e7ca\u00e3o do problema de controle impulsional e a solu\u00e7ca\u00e3o iterada das desigualdades variacionais. Algumas delas s\u00e3o de dif\u00edcil verifica\u00e7ao, como a hipotese de suavidade dos custos otimos obtidos via otimiza\u00e7\u00e3o (Lema 2.2 e hip\u00e1teses 1,2 e 5 do Teorema 2.3). Outra quest\u00e3o dif\u00edcil de verificar a priori s\u00e3o as condi\u00e7\u00e3es 4 e 8 do Teorema 2.3, sobre a regiao D, tamb\u00edem resultado da otimiza\u00e7ca\u00e3o. Deve-se observar se as soluc\u00e7\u00e3oes das desigualdades variacionais satisfazem essas hipo\u00edteses e assim resolvem o problema original de controle impulsional.\nPara resolver as desigualdades variacionais (2.27), \u00e1 necess\u00e1rio usar uma discretiza\u00e7ao no espa\u00e7co de estados e obter a solu\u00e7c\u00e3ao de um problema associado aproximado. Com esse intuito, essa disserta\u00e7ao prop\u00e3e a utiliza\u00e7\u00e3o do m\u00edtodo Discretiza\u00e7\u00e3o do Valor M\u00eddio (MVS - Mean Value Scheme), que ser\u00e1 descrito no cap\u00edtulo a seguir.\n2.5\tDemonstra\u00e7\u00e3es dos Teoremas 2.1 e 2.3 e do Lema 2.1\nEsses resultados foram baseados em teoremas e lemas apresentados em [7] e [8], no entanto aqui utiliza-se um fator de desconto e a otimiza\u00e7c\u00e3ao envolve a minimizac\u00e7\u00e3ao de um custo em vez da maximiza\u00e7c\u00e3ao de um lucro. Al\u00edem disso, aqui a modelagem n\u00e3ao envolve difus\u00e3ao com saltos, diferentemente do que se usa em [7]. Dessa forma, as demonstra\u00e7c\u00e3oes para os resultados dessa disserta\u00e7ca\u00e3o s\u00e3ao consideravelmente diferentes das mostradas nessas refer\u00eaencias e s\u00e3ao apresentadas nesta se\u00e7c\u00e3ao.\n2.5.1\tDemonstra\u00e7\u00e3o do Teorema 2.1\nConforme o Teorema 2.1, enunciado na se\u00e7\u00e3o 2.3, o custo final Vn obtido pelos n problemas de parada \u00f3tima iterados \u00e9 o mesmo do controle impulsionai limitado a n interven\u00e7\u00f5es, desde que r, e M[Vi-1] sejam de crescimento polinomial para i = 1,2,..,n. A demonstra\u00e7\u00f5o a seguir baseia-se na prova do Teorema 7.2 de [7].\nDemonstra\u00e7\u00e3o:\nPara fazer essa demonstra\u00e7\u00f5o, \u00e9 necess\u00f3ria a utiliza\u00e7ao de um princ\u00edpio da programa\u00e7\u00e3o din\u00e2mica, ou princ\u00edpio de Bellman, (Lema 7.3 e Corol\u00f3rio 7.4, [7]).\nLema 2.3 Suponha que G e uma fun\u00e7\u00e3o de crescimento polinomial e T e o conjunto de todos os tempos de parada menores que o tempo final T. Defina\ne\n[T e-asf (Xs)ds + e-aTG(Xt)1{t<^}\u2019 .\n0\n(a) Entao para todos os tempos de parada finitos fi tem-se\n\u00cd-T A/3\nI\te-asf(Xs)ds + e-aTG(Xt)1{t+ e-aifiX)1{t>m .\n0\n> 0, define-se\nD(e) = {x G X; fi(x) &lt;G(x) \u2014 e}\nfi(x) = inf Ex\nT eT\n(2.29)\nfi(x)\ninf Ex\nT eT\n(2.30)\n(b) Para\ne\nEntao, se fi\nT(e) = inf{t > 0; X(t) G D(e)}.\num tempo de parada finito tal que fi C t(e) para algum e > 0, tem-se e-as\n0\nfi(x) = Ex\nf(Xs)ds + e-a3fiX) .\n(2.31)\ne\nUm resultado importante deste lema que ser\u00e9 usado na demonstrac\u00e3o do Teorema 2.1 \u00e9 enunciado a seguir:\nCorol\u00e1rio 2.1 (a) Para cada tempo de parada t eT dado, o processo\nU(t) := \u00ed\n0\ntAT\ne-asf (Xs )ds + e-a(tAT )fi(X\u00cdAT)\nt fi 0\ne um submartingal (vide Ap\u00e9ndice A). Em particular, se t1,t2 sao tempos de parada finitos e t1 C t2 C T, ent\u00e3o\nEx[e-aT1 fi(XT1)] C Ex\ne-asf (Xs )ds + e-aT2 fi(XT2)\n(b) Para e > 0, t(e) definido como no Lema 2.3(b) e fi1, fi2 tempos de parada finitos tal que fi1 C fi2 C TEntao\nE x[e-a/31 fi(X^1)] = Ex\nInicialmente, note da equa\u00e7ao do problema de parada \u00f3tima iterado (2.16) que\nVn-i(x) C M[Vn-i-1](x),\tse n \u2014 i > 1\n(2.32)\ne isso vale para todo x G X, bastando tomar o valor t = 0 em (2.16).\nEscolhe-se uma sequ\u00eancia de controle admiss\u00edvel vn = (Ti,T2,...,Tn; AXT1 ,AXT2,...,AXTn), com Tn &lt;T e Tn+i = T. Se Xt representa o estado no tempo t de um processo submetido a esse controle, o Corolario 2.1(a) aplicado no custo do (n \u2014 i)-\u00e9simo problema de parada otima resulta em\nEx[e-aTiVn-i(X\u2019i)] C Ex\n'\u2019i+1\ne-atf(Xt)dt + e-aTi+1 Vn-i(XT-+J .\n(2.33)\nDa definicao do operador M, (2.14), segue que\nM[Vn-i-1](X1) C c(X\u2019- 1, AX\u2019i+1) + Vn-i-1 (X\u2019i+1), para t+ &lt;T.\ni+1\ti+1\n(2.34)\nCombinando (2.33)\u2014(2.34),\nEx[e-aTiVn-i(XTi)] C Ex\nTi+1\ne-af (Xt)dt +\t+ c(Xt-+1 , AX\u2019i+1 '\t\u2022\n\n+ e-\u201dTi+1 V\t1(X\u2019\u00a1+i ))\n\n(2.35)\npara i = 0,1,...,n \u2014 1, com t0 = 0. Somando (2.35) de i = 0 a i = n \u2014 1, obt\u00f3m-se\nn-1\n^Ex[e-aTiVn-i(XTi) \u2014 e-aTi+1 Vn-i-1(XTi+\u00ed)] C Ex\ni=O\nt \u00ed'Tn\n/\te-atf (Xt)dt\nL7o\nn\n+ \u00a3 e~\u201cT\u2018c(Xt- , AXt.)1(t,<t}\ni=1\n(2.36)\ne, portanto,\nEx[e-aOVn(Xo) \u2014 e-aTnVo(XTn)] C Ex\nAl\u00f3em disso, tem-se que\nTn\n/ e~atf(Xt)dt\nJo\nn\n+\te-aTi<\ni=1\nc(XT- > AX\u2019i)1{\u2019i<T}\t.\n(2.37)\nE x[Vn(Xo)] = Vn(x)\n(2.38)\ne, usando a propriedade forte de Markov, a lei das esperan\u00e7as iteradas (vide Ap\u00eandice A) e pelo fato que Tn &lt;T,\nEx^e-\u201d\u2019n VO(XTn)] = Ex EX\n= Ex\nT e-\u201d(t+Tn)f (Xt)dt + e-a(T+Tn^(XTI .\no\nT\t-|\n1 \u201df (Xt)dt + e~aT ^(Xt )1.{T<x\nTn\nSubstituindo (2.39) e (2.38) em (2.37),\nV\"(x) C Ex\n/ e-atf (Xt)dt +\te-aTic(X.-, AX.i)1u<t} + e-aT0(Xt\\\t-\ni=i\ti\n= J (vn)(x),\n(2.40)\nem que J(vn)(x) representa o valor esperado do funcional de custo no c\u00e1lculo do custo \u00f3timo Jn(x) do controle impulsional limitado a n interven\u00e7\u00f5es, (2.12) para uma sequ\u00eancia vn G Vn qualquer. Como a sequ\u00eancia vn G Vn escolhida foi arbitraria, conclui-se que\nV\"(x) C inf{J<\u2019\">(x);v\u201e G V\"} = J,,(x).\n(2.41)\nPara obter a desigualdade oposta, escolhe-se e > 0 e define-se uma sequ\u00eancia crescente de tempos de parada 0 = \u00ea0 &lt;\u00ea &lt;... &lt;\u00ean como se segue.\nPara i = 1,2,...,n, define-se\nD^ = {x G X; V*(x) &lt;M[Vi-1](x) - e}\ne\n\u00eai = inf{t> 0; X,\u00ed0) /D^}, em que X(0) = Xt \u00e9 o processo sem interven\u00e7oes. Entao escolha XX1 = XXC, com XX1 e-otimo para Vn-1, no sentido de que\nM[Vn-1 ](x) > c(x,XX1) + Vn-1(r(x,XX\u00ed1)) - e.\t(2.42)\nIterativamente, define-se\nfi+i = inf{t > fi; Xt(i) / D\"'-i},\nem que Xt(i) \u00e9 o processo obtido aplicando a sequ\u00eancia de controle f = (f1,...,fi; XX1,...,XX') e XXi = AX'. , com XXt e-otimo para Vra-i-1, no sentido de que\n1 i\nM[Vra\"i-1](x) > c(x, XX\u00cd+1) + Vra-i-1(r(x,XX\u00cd+1)) - e.\t(2.43)\nAgora procede-se de forma analoga aos passos (2.33)-(2.40), para a sequ\u00eancia de controle \u00ea\t(\u00ea1;...;\u00ean; XX 1;...;XXn).\nPelo Corolario 2.1(b), tem-se\nE x[e-a,i V\"-i(Xfi)] = Ex\n' f.i+1\t1\n/\te-atf (Xt)dt + e-a,i+1 V\"-\\X--J .\nJ Ti\n(2.44)\nComo para ocorrer uma intervencao no instante fi+1 \u00e9 necessario que X,- / d\"'-i, deduz-se\nTi + 1\nque\nV\"-i(X,- ) > M[V\"-i-1](X,- ) - e.\nx Ti+1'\tL\tJX Xx\n(2.45)\nUsando (2.43) para o processo X obtido aplicando-se a sequ\u00eancia v, tem-se\nM[Vn-i-1](X) > c(Xt- , AXi+1) + Vn-i-1(XTi+1) \u2014 e, para tw &lt;T. i+1\ti+1\n(2.46)\nCombinando (2.44)-(2.46),\nEx[e-aTiVn-i(XTi)] > Ex\nfTi+1\t,_____\n/\te-a\u2018f(Xt)dt + e-aTi+1c(Xv , AX,+i)1,t.+1<t)\nJ Ti\nSomando (2.47) de i = 0 a i = n \u2014 1, resulta em\n+ e-aTi+1 V n-i-1(X^i+\u00ed))\n\u2014 2e,\n(2.47)\nCTn\tn\n/\te-atf (Xt)dt +\te-aTic(Xt-, \u00c3X\u00ed)1{t\u00ed<t} + e-aTn\nJo\ti=i\ti\nU'\u00edA;.) - 2ne,\n(2.48)\nSubstituindo (2.39) em (2.48),\n..'T\tn\n/ e-at f (Xt)dt +\te-aTic(Xt-, \u00c3X\u00bfI^t} + e-\u201cT\nJo\ti=i\ti\n= J (vn)(x) \u2014 2ne,\n(2.49)\nComo e foi arbitrariamente escolhido, deduz-se que\nVn(x) > inf{J(vn)(x); vn G Vn} = Jn(x).\n(2.50)\nCombinando (2.50) com (2.41), obt\u00e9m-se a demonstra\u00e7\u00f5o do Teorema 2.1.\n2.5.2 Demonstra\u00e7\u00e3o do Lema 2.1\nO Lema 2.1, apresentado na se\u00e7\u00e3o 2.3, enuncia que o custo \u00f3timo do problema de controle impulsionai limitado a n interven\u00e7\u00f5es Jn(x), definido em (2.12), tende para o custo \u00f3timo com numero ilimitado de intervencoes J(x), definido em (2.4), quando n x. A demonstracao a seguir esta baseada na prova do Lema 7.1 de [7].\nDemonstra\u00e7\u00e3o:\nNote que Vn \u00c7 Vn+1 \u00e7 V para todo n, isto \u00f3, todas as sequ\u00eancias de controle poss\u00edveis em Vn pertencem a Vn+1, al\u00f3m de outras sequ\u00eancias, o que pode resultar em um custo otimo Jn+1\nmenor do que Jn.\nDessa forma, Jn(x) > Jn+1(x) > J(x). A desigualdade oposta pode ser obtida\ncomo ser\u00f3a visto a seguir.\nDenotando o valor esperado em (2.4) por J(v)(x), o valor esperado em (2.12) por J(vn)(x), o tempo final utilizando-se a sequ\u00eancia de controle v por T(v) e supondo J(x) > \u2014x, para cada\nVn(x) > Ex\nVn(x) > Ex\n<Kxt) 1 /. x \u2014 2ne\ne > 0 existe uma sequ\u00eancia de controle v E V tal que\nJ (v)(x) = Ex\nT(v)\tx\n/\te-atr(Xt)dt ^2 e-aTic(Xt- ,AXt\u00ed)1{Ti<t<\u00ab>}\n4o\ti=i\t1\n+ e aT ^>(XT(v) )1.{T(v)&lt;x\n&lt;J(x) + e.\n\u2022 ?\n(2.51)\nPara n = 1,2,..., define-se a sequ\u00eancia obtida truncando-se v ap\u00f3s n intervenc\u00f5es como vn = (T1,T2,...,Tn,T; AXT1 ,AXT2,...,AXTn). O estado obtido para ambas as sequ\u00eancias \u00f3 o mesmo para todo t &lt;Tn, isto \u00f3,\nxE = XE Vt \u00ab Tn.\n(2.52)\nComo, de (2.7), Tj\tT quase certamente quando j to, as hip\u00f3teses (2.8) e (2.9) esta-\nbelecem que existe n tal que\nE x\n,T(v)\t/,T(vn)\n\\e-atr(X\u00cdv))|dt +\t\\e-atr(X(tVn))\\di] &lt;e,\n(2.53)\nEx\n_i=n+1\nx\ne-aT c(X^.XXT, )1{t\u00ed<t w}|\n' i\n&lt;e.\n(2.54)\nem que T(vn) \u00f3 o tempo final utilizando-se a sequ\u00eancia de controle truncada vn.\nAl\u00f3m disso, Tn &lt;T(vn ) e, por (2.7), Tn\tT(v) quase certamente quando n to, logo\nlim T(vn) = T(v)\tq.c.\nn^x\n\u2022 1{t\tx\t1{t\tx\tq.c.\n\u00c9 poss\u00edvel, ent\u00e3o, escrever as igualdades:\nliminf 1{t\tx = limsup 1{t \u25a0&lt;x = 1{t\tx q.c.\nn^x\tn^x\n(2.55)\nUtilizando (2.52), tem-se\nlim sup J(vn) (x) = lim sup Ex\nn^x\tn^x\nn\n+ E e-aTi \u2018\u00a1(X^'AXt, )1(Ti<T Tn,} + e-aT \u201cn) MX^, )1{T(.n)<x)\ni=1\n-at r(x(vn))dt\nTn\n= lim sup Jv (x) + Ex n^x\nx\n- E^2 e-aTi\ni=n+1\n+ Ex |\"e-\u201cT(vn)\n,T(vn)\t/.T(v)\ne-atr(X(Vn))dt -\te-atr(X2'))dt\nn\tTn\nc(X^.XXri )1{t\u00ed<t M) ' i\n0(xj;n;, )i(T ..\u201e><\u00bb) - e-aT ^(xT\u00ed, )i{Tl.1<x}\ne\nDas propriedades do m\u00f3dulo, tem-se que y f2dt c\ny fidt -\ny fi dt +\ny f2dt c y |fi|dt+y ^dt\nE[fs] c |E[f3]| c E[|fs|].\nUtilizando essas propriedades e as express\u00f5es (2.53) e (2.54), obt\u00e9m-se\n-T(vn)\t\u201eT(v)\n|e-\"MXt(\"n))|dt +\t|e-\"\u00edr(X\u00ed(\")) |dt\n-\"tr(Xt(Vn))|dt +\nTn\nlimsup J(\"n)(x) c limsup J\"(x) + Ex\nn^x\tn^x\nx\n+ E'[ E |-e-\"\"aX-Uv,)1(I,<TW}|\ni=n+1\ne-\"T (vn)\n+ Ex\nc J\" (x) + 2e + lim sup Ex e\nn^x\nTn\n^(%TVnn))1{T(vn)\t. - e-\"T(v)X t\". I .\n^(XT(\"1) )1{T\tx\n-\"T (vn)\n- e-\"T \u201c 0(xT\";!, , )1{T(.><x)\nPelo Lema de Fatou (vide Ap\u00eandice A) e utilizando (2.55), limsup J(\"n)(x) c J\" (x) + 2e\nn^x\n(2.56)\n\u25a0\t0(%T\"n;,)1{t(\u00bb><\u00ab> -\t\"0(xT\"\u2019>)1{t<-><x})'\n((e-\"T\"n>0(XT\"\u00bf,) - e-\"T\u2018\u201d\u00bf(X\u00ab))1(T<\u00ab.><x)) 0(XT(v) 1{T(Vn)<x}\t1 {T(v,<x}))\n+ Ex lim sup \u00cd e\n- n^x x\n&lt;Jv (x) + 2e + Ex [lim sup ( (e\n+ lim sup fe_arW\nn^x x\nPor hip\u00f3tese, T(vn)\tT(v) e a fun\u00e7\u00e3o \u00e9 cont\u00ednua. Logo, pelo teorema da converg\u00eancia\ndominada de Lebesgue (vide Ap\u00eandice A),\nEx lim sup e\n- n^x x\n- \"T (vn)\t(\"n\u2019\t- \"T(v)\t(v) )\n^(XT (\"n) )\te\t^(XT (v)\t^{T (vn)<x} y\n0\ne limsup J(\"n)(x) c J\"(x) + 2e\nn^x\nAssim, usando (2.51) e (2.57),\n(2.57)\nlimsup Jn(x) &lt;limsup J(vn)(x) &lt;J(x) + 3e.\t(2.58)\nn^x\tn^x\nComo e > 0 pode ser escolhido arbitrariamente pequeno, a demonstra\u00e7\u00e3o est\u00e1 completa para J(x) finito. Se J(x) = x, para cada M > x existe v G V tal que J(v)(x) &lt;M. Para e = 1, a express\u00e3o (2.56) resulta em limsupn^x J(vn)(x) &lt;M + 2. Visto que M \u00e9 arbitrario, isso\nmostra que\nlimsup Jn(x) c limsup J(\"n)(x) = -to. n^x\tn^x\n2.5.3\tDemonstra\u00e7\u00e3o do Teorema 2.3\nConforme o Teorema 2.3, enunciado na se\u00e7\u00e3o 2.4, a solu\u00e7\u00e3o das desigualdades variacionais (2.27) corresponde a solu\u00e7\u00e3o de um problema do parada \u00f3tima na itera\u00e7\u00e3o i, apresentado em (2.16). A demonstra\u00e7\u00e3o a seguir baseia-se na prova do Teorema 10.4.1 de [8].\nDemonstra\u00e7\u00e3o:\nUsando os itens 1, 4 e 5 do teorema, \u00f3 poss\u00f3vel encontrar uma sequ\u00eancia de fun\u00e7oes Tj G C2(X) C C(\u00c3), j = 1,2,..., tal que (vide Ap\u00eandice D de [8]):\n(i)\tTj\tT uniformemente em subconjuntos compactos de X? quando j x.\n(ii)\tATj \u2014 aTj\tAT \u2014 aT uniformemente em subconjuntos compactos de X\\dD quando\nj x.\n(iii)\t{ATj \u2014 aTj}j=1 \u00f3 localmente limitada em X.\nSeja {XR}Rg=1 uma sequ\u00eancia de conjuntos abertos limitados XR tal que X = Ujf=1XR. Fa\u00e7a Tn = min(N, inf{t > 0; Xt / U){=1XR}). Seja t &lt;T um tempo de parada e x G X, ent\u00e3o, pela f\u00f3rmula de Dynkin,\nE x[e-\u00ab(T *tn )Tj (xT aTn )] = Tj (x) + Ex\nT ATn\ne-as(\u2014aTj (Xs) + ATj (Xs))ds\n(2.60)\nUsando (i)-(iii), o item 3 do teorema e o Teorema da Converg\u00eancia Limitada (vide Ap\u00eandice A),\nT(x) = lim Ex\nj\u2014x\nI\n0\nr tATn\n/\te-as(aT(Xs) \u2014 AT(Xs))ds + e-a(TATN)T(Xtatn) .\n0\n-tATn\ne-as(aTj(Xs) \u2014 ATj(Xs))ds + e-a(TaTn)Tj(XtaTn) .\n(2.61)\n(2.62)\n= Ex\nDos itens 2, 3 e 6 do teorema,\nT(x) &lt;Ex\n\u2022t ATn\t-\ne-asr(Xt)ds + e-a(TATN)M[Vi-1 ](Xtatn) .\n(2.63)\nPelo Lema de Fatou e (2.8) e considerando a familia {.MU' x](XT); t tempo de parada, t &lt;T} uniformemente integr\u00e1vel com respeito a Qx para todo x G Rk, tem-se\nT(x) &lt;lim inf Ex\n.Y -X\n/T e\n0\n\u2022T ATn\ne-asr(Xt)ds + e-a(T aTn )M[V\u00ed-1](Xt atn )\nI\n-asr(Xs)ds + e-aTM[Vi-1](XT) .\n(2.64)\n&lt;Ex\nComo T &lt;T \u00f3 arbitrario, conclui-se que\no que prova a parte a) do teorema.\nSe x / D, ent\u00f5o T(x) = M[Vi-1](x) > Vl(x) por (2.27a), entao de (2.65) tem-se\nT(x) = Vz(x) e T* = T*(x,ix) := 0 \u00f3 otimo para x / D.\t(2.66)\nPara completar a prova, agora supoe-se que x G D. Define-se uma sequ\u00eancia crescente de conjuntos abertos {Dk}k=1 tal que Dk C D, Dk \u00e9 compacto e D = Uk=1Dk. Fa\u00e7a Tk = inf{t > 0;Xt / Dk}, k = 1,2,.... Pela formula de Dynkin e pelo item 7 do teorema e das condicoes (i)-(iii), tem-se que, para x G Dk,\nT(x) = lim Tj (x)\n= lim Ex\nPTfc ATn\nI\te-\u201c*(\u00ab*j(X,) - ATj(X.))ds +\t>Tj(Xt.at,)\n0\n= Ex\n= Ex\nPTfe ATn\nI\te-as(aT(X,) - AT(X,))ds + e-a(TkaTn}T(XTkATN)\n0\nfTk ATn\t-\nI\te-asr(X,)ds + e-a(TkaTn^(X.^) ,\n0\npelo Teorema da Converg\u00eaencia Limitada.\nPela integrabilidade num\u00e9rica e pelos itens 2 e 8 do teorema, obt\u00e9m-se\nT(x) = lim Ex\nXk\u2014x\ne-asr(X,)ds + e-a(TkATN\tatn )\n= Ex\n= Ex\ne-asr(Xs)ds + e-aTD T(XTd )\nTTD e-asr(Xs)ds + e-aTD M[Vi-1](XTD) 0\nDe (2.16), por otimalidade,\nConclui-se, portanto, que\nT(x) > Vi(x)\nT(x) = Vz(x)Vx G X\ne o tempo de parada \u00f3otimo \u00f3e dado por\n0, se x / X TD, se x G X\n(2.67)\n(2.68)\n(2.69)\n(2.70)\n(2.71)\n*\nT\nCap\u00edtulo\nDiscretizac\u00e3o do Valor M\u00e9dio\nConforme j\u00e1 mencionado, essa disserta\u00e7\u00e3o prop\u00e3e a utiliza\u00e7ao da Discretiza\u00e7\u00e3o do Valor Medio para resolver as desigualdades variacionais (2.27) apresentadas na se\u00e7ao 2.4. Este metodo, conhecido pela sigla MVS (do ingl\u00eas, Mean Value Scheme), sera descrito com mais detalhes na\nse\u00e7ca\u00e3o 3.2. Ele e usado para obter numericamente a solu\u00e7ca\u00e3o de problemas de valor de contorno\ndo tipo Dirichlet envolvendo a equa\u00e7\u00e3o de Helmholtz. A se\u00e7\u00e3o 3.1 apresenta uma classifica\u00e7\u00e3o de equa\u00e7\u00e3es diferenciais parciais de segunda ordem e o problema de Dirichlet. Na se\u00e7ao 3.3 s\u00e3o apresentadas transformares que permitem que a desigualdade (2.27b) seja escrita na forma padr\u00e3o para usar o MVS e algumas particularidades da aplica\u00e7\u00e3o do metodo ao VASPS sao comentadas na se\u00e7ao 3.4.\n3.1\tClassifica\u00e7\u00e3o de equa\u00e7\u00f5es diferenciais parciais\nSeja X? uma regiao fechada em Rn, composta pela regi\u00e3o aberta X e sua fronteira dX. Defina uma funcao u : X?\tR e considere a equac\u00e3o diferencial parcial linear dada por\n(3.1)\nem que aij, bi, c e d sao constantes. Admite-se que a matriz dos coeficientes aij e simetrica.\nA equa\u00e7\u00e3o (3.1) e dita el\u00edptica se todos os autovalores da matriz dos coeficientes a^ forem\nn\u00e3ao nulos e tiverem o mesmo sinal. Se os autovalores forem diferentes de zero e apenas um tiver o sinal diferente, entao a equa\u00e7\u00e3o e do tipo hiperb\u00f3lica normal, ou simplesmente hiperb\u00f3lica.\nSe eles forem n\u00e3ao nulos e tiver pelo menos dois de cada sinal, ent\u00e3ao a equa\u00e7c\u00e3ao e chamada\nultra-hiperb\u00f3lica. Por fim, se pelo menos um dos autovalores for nulo, ent\u00e3o a equa\u00e7\u00e3o e parabo\u00f3lica, [33].\nPara o caso de duas variaveis, a equa\u00e7ca\u00e3o diferencial e escrita como\n(3.2)\ne a classifica\u00e7c\u00e3ao resulta que:\n\u2022\tse b2 \u2014 ac &lt;0, a equa\u00e7\u00e3o e el\u00edptica e uma transformac\u00e3o de variaveis pode leva-la \u00e0 forma canonica ugg + unn + h(ug,un,u) = 0;\n\u2022\tse b2 \u2014 ac > 0, a equacao \u00f3 hiperb\u00f3lica e a forma can\u00f4nica \u00f3 u^ \u2014 unn + h(ug,un,u) = 0;\n\u2022\tse b2 \u2014 ac = 0, a equa\u00e7\u00e3o \u00f3 parab\u00f3lica e uma transformac\u00e3o de vari\u00f3veis pode lev\u00f3-la a forma can\u00f4nica ugg + h(ug ,un,u) = 0,\nem que h(ug ,un,u) representa uma func\u00e3o que envolva apenas termos de u e de suas derivadas de primeira ordem, sem nenhuma derivada de segunda ordem.\nO metodo da Discretiza\u00e7\u00e3o do Valor Medio busca a solu\u00e7\u00e3o para problemas de contorno descritos por um tipo especial de equa\u00e7ao el\u00edptica, conhecida como equa\u00e7\u00e3o de Helmholtz, que tem a forma ugg + unn \u2014 A2u = g, em que A2 \u00f3 uma constante positiva.\nPara usar o MVS, a condi\u00e7ao de contorno deve ser do tipo Dirichlet, isto \u00e9, a solu\u00e7\u00e3o u da equac\u00e7\u00e3ao diferencial parcial analisada tem que assumir na fronteira o valor de uma fun\u00e7c\u00e3ao dada. Alem disso, o metodo sup\u00e3e que u G C5(X) n C0(A), em que C0(A) denota a classe de funcoes limitadas e cont\u00ednuas em A? e Ck (X) e a classe de funcoes cont\u00ednuas e com derivadas de ordem k cont\u00ednuas. Deste modo, o MVS resolve problemas da forma, [34]:\n\u00cdAu(x) \u2014 A2u(x) = f (x),\tx G X,\nu(x) = $(x),\tx G dX,\nem que Au = ugg + unn representa o Laplaciano de u (soma das derivadas parciais de segunda ordem).\nAssume-se, ainda, que a condicao basica de exist\u00f4ncia de uma unica solu\u00e7\u00e3o \u00f3 satisfeita, isto \u00f3, dX \u00f3 uma regi\u00e3o suave e G Cx (X?) [35].\n3.2\tDescri\u00e7\u00e3o do m\u00e9todo\nO m\u00f3todo MVS consiste em cobrir a regi\u00e3o em que o problema esta definido por bolas e aproximar localmente as integrais que aparecem na forma anal\u00edtica. Para isso, utiliza-se uma extensa\u00e3o do teorema do valor m\u00f3edio de func\u00e7\u00e3oes harm\u00f4onicas aplicado em equa\u00e7co\u00e3es de Helmholtz, por isso o nome dado ao m\u00f3etodo. O espa\u00e7co de estados \u00f3e discretizado e coberto por bolas que se sobrep\u00e3oem. Cada ponto do espa\u00e7co de estados \u00f3e centro de uma bola e os pontos vizinhos pertencem \u00e0 circunfer\u00f4ncia desta bola [36]. A integral em cada bola \u00f3 aproximada pela pondera\u00e7\u00e3o dos valores da func\u00e3o nos nos da sua circunfer\u00f4ncia. Neste trabalho, utilizou-se a rede quadrada por sua simplicidade de implementa\u00e7\u00e3o, [34], porem uma precis\u00e3o maior pode ser obtida com a rede triangular, [31].\nNa rede quadrada, o espa\u00e7co de estados e convertido para a forma discreta de modo a obter uma rede de N0 = N + 2 por M0 = M + 2 pontos, com dist\u00f4ncia r0 entre os nos. O espa\u00e7o de estados discreto e ent\u00e3ao dado por\nUm n\u00f3 nesta rede \u00e9 denotado por xi;j- = (\u00f4j ,hi) e podemos associar uma fun\u00e7\u00e3o discreta f : Sr R a qualquer func\u00e3o real f : X? R tal que f = f (xi,j). Para uma rede quadrada como em (3.4), cada n\u00f3 xi;j- \u00e9 o centro de uma bola aberta Br de raio r0 e a sobreposi\u00e7\u00e3o das bolas \u00e9 tal que cada circunfer\u00eancia cont\u00e9m quatro nos vizinhos. O numero de pontos internos \u00e9 NM e para verificar se um ponto xi;j- pertence ao interior \u00e9 suficiente observar se a distancia para a fronteira dX \u00e9 igual ou superior ao raio r0. Uma representacao da cobertura do dom\u00ednio \u00e9 mostrada na Fig. 3.1.\nFigura 3.1: Regi\u00e3o coberta por bolas regulares para utiliza\u00e7\u00e3o do MVS.\nCada bola aberta com raio r0 centrada no no interno xk \u00e9 representada por Bk = Br (xk), k = . As bolas s\u00e3o definidas de modo que Bi Gd?, Vi =\te, para todos os \u00e9ndices i\ne j em que i = j, vale\nBi C Bj = u > xi G dBj e xj G dBi.\nDefine-se, assim, uma cobertura parcial Q para d?, tal que Q = UiBi. O problema original e aproximado pela soluc\u00e3o do problema de valor de contorno no dom\u00e9nio Q. Para obter o resultado no dom\u00e9nio Q, tem-se como problema de partida a solu\u00e7ao em uma unica bola, que faz uso da seguinte proposic\u00e7\u00e3ao:\nProposi\u00e7\u00e3o 3.1 [34] Dada uma bola Br centrada no ponto x G X e uma fun\u00e7\u00e3o $ tal que na circunfer\u00eancia dB tem-se 0 $(ro,0) G Lp2n para algum 1 &lt;p &lt;em que Lpn e a classe de fun\u00e7\u00f5es 2n\u2014peri\u00f3dicas com norma\n1/p\nO problema de valor na fronteira dado por\nAu(x) \u2014 A2u(x) = f (x),\tx G Br,\nu(x) = \u00ed(x),\tx G \u00e2Br,\ntem solu\u00e7ao\nu(sfi) =\na0 I0(As)\n2 I0(Ar0)\nn=1\n(ancos(nO) + bnsen(nff)), In(Ar 0)\n0 C s &lt;r0,\nem que {an},n = 0,1,... e {bn},n = 1,2,... sao os coeficientes de Fourier da fun\u00e7ao $ e In e a fun\u00e7\u00e3o de Bessel modificada de n-\u00e9sima ordem.\nComo na formula\u00e7\u00e3o do MVS deseja-se calcular u no ponto central x = (\u00f4j,hi) que pertence \u00e0 rede Sr, \u00e9 necessario considerar apenas o caso s = 0. Como In(0) = 0, Vn = 0 e I0(0) = 1,\nsegue que\nUi,j =\n1\n2nI0(Ar0)\n\u00ed(ro,0)d0,\n0\n(3.6)\nem que I0, a fun\u00e7ao modificada de Bessel de ordem zero, pode ser representada pela s\u00e9rie\n~\t(x)2k\nI\u00fc(x) = k\t22k (k!)2'\n(3.7)\nO valor de $ so \u00e9 conhecido em quatro pontos da circunfer\u00eancia dBr, entao utiliza-se o valor nesses pontos para fazer uma aproxima\u00e7\u00e3o numerica pelo metodo dos trapezios para a integral em (3.6) [36].\nDe posse desse resultado, demonstra-se que a solu\u00e7ao do problema (3.3) definido no dom\u00ednio aproximado Q pode ser aproximada com precisao O(r0) por [36]\nf[1 - Wl} ,\n1\n4I0(Ar0)\nUi+1,j + Ui-1,j + Ui,j+1 + Ui,j-1 +\n(3.8)\nAo usar essa aproxima\u00e7\u00e3o para todos os nos internos da malha, obtemos um sistema de equac\u00e7\u00e3oes que pode ser escrito em forma matricial como\nAU = b,\nem que a matriz A e determinada pelas conex\u00f5es internas e o vetor b pelas conex\u00f5es com a fronteira e pela parte n\u00f5o-homog\u00eanea da equa\u00e7ao de Helmholtz. Obtem-se, ent\u00f5o,\n\t1 C) 0 1 1\t\t0\t... -I\t...\t0 0\t\nA=\t\t\t\t(3.9)\n\t0 ...\t-I\tCM-1\t-I\t\n\t0 ...\t0\t-I\tCm\t\ne\nb=\n^2 [1 - I0(Ar0)] + U1,0 + U0,1\nA24f21\n[1 - I\u201e(Ar\u201e)] + U2fi\n4fNM,NM\nA2\n[1 - hj(Ar0)] + UN,M+1 + un+1,m\nem que I representa a identidade de dimensao N x N e\n\t4Io(Aro)\t\u20141 \u2014 1\t4Io(Aro)\t0\t...\t0 \u20141\t...\t0\t\nCj =\t\t\t, j = 1,2,...,M.\n\t0 ...\t\u2014 1 4Io(Aro)\t\u20141\t\n\t0 ...\t0\t\u20141\t4Io(Aro)\t\n3.3 Obten\u00e7\u00e3o da equa\u00e7\u00e3o de Helmholtz\nUma equa\u00e7\u00e3o el\u00edptica da forma (3.2) pode ser escrita na forma can\u00f4nica e convertida para uma equa\u00e7\u00e3o de Helmholtz por meio de algumas transforma\u00e7\u00f5es [33]. Inicialmente, supoe-se que a = 1, o que pode ser obtido por uma simples normalizac\u00e3o, e completa-se quadrados de modo a evitar derivadas parciais cruzadas, resultando em\n( d , d \\2\t2 d2\t, d d\n+ b u + Y 2 u + d u + e u + gu = f. \\dx\tdy )\tdy2\tdx dy\n(3.11)\nem que y2 = (ac \u2014 b2) \u00e9 sempre positivo para equa\u00e7\u00e3es el\u00edpticas. Essa equa\u00e7ao pode ser reescrita com a defini\u00e7\u00e3o de novas vari\u00e9veis,\ny \u2014 bx\nY\n(3.12)\npois, como\nd_ dl\ndy\na equa\u00e7c\u00e3ao transformada resulta em\n1 \u2014 b\u2014 dx + dy' d d\n0 \u2022 dX + Y\u00e3Xj'\nd 2u\nd 2u dy2\ndu du\n+dY+pdXi+gu=f'\ndu\n(3.13)\nn =\n+\nl = X\ncom p = (e \u2014 bd)/Y. Quando d, e e g s\u00e3o constantes, os termos diferenciais de primeira ordem podem ser eliminados por meio da transforma\u00e7ca\u00e3o\nw(nl) = e'>^'u(y.ll). p(n,l) = dl+pn.\t(3.14)\nCom a utiliza\u00e7ao da regra da cadeia em (3.14), podemos reescrever (3.13) em fun\u00e7\u00e3o de w como uma equa\u00e7c\u00e3ao de Helmholtz dada por\nMt\u00f3 \u2014 A2w(n,\u00ed) = ee,nY (y,Q,\n(3.15)\nem que\nA2 = \u2014 g +\nd2 + p2\n4\n3.4 Aplica\u00e7\u00e3o do MVS ao VASPS\nA desigualdade (2.27b) n\u00e3o esta na forma de macoes descritas na se\u00e7\u00e3o 3.3 permite a convers\u00e3o\nInicialmente, obtem-se a express\u00e3o do gerador ca\u00e7ao da express\u00e3o por\n(2.19) no modelo\ndo sistema\nHelmholtz, por\u00e9m a aplica\u00e7\u00e3o das transfor-para esse tipo de inequa\u00e7\u00e3o.\ninfinitesimal para o VASPS, conforme apli-dado por (2.2). O gerador obtido e dado\n1 2 d2V\t2 d2V\n+ 2 a2 W + a 8ht85t \u2019\nsao os elementos (1,1), (2,2) e (1,2) da matriz de covariancias aaT, que \u00e9\nav (x)=A \u00f5t dht\n+ i d\u00fc + 2 a 1&lt;9ht2\n(3.16)\n2 2 2 em que a 2, a\u00a3 e ag\numa matriz simetrica.\nSubstituindo (3.16) em (2.27b), obtem-se uma desigualdade el\u00edptica. Utilizando o fato que a 2 > 0, definem-se os coeficientes para a desigualdade\nb=\tac2 a 2 ,\ty2\nd=\t25\te\n\ta 2Ar \u2019\t\n\t2a\t\ng =\t2,\tf\n\ta 2\t\na2\na2\n0,\n2 ( )\n---2 r(xL\nai\nObt\u00e9m-se, ent\u00e3o,\nd2\nd\nd\n(-dh\nV + d V + e V + gV >&lt;952 V + d\u00e2h\" + e<9V +\nf.\n(3.17)\n++y 2\nE importante ressaltar que (3.17) \u00e9 el\u00e9ptica somente se\ny\n2\nzl a2\n> 0,\no que \u00e9 o caso no modelo do VASPS, pois essa express\u00e3o est\u00e1 associada ao determinante da matriz de covariancias do movimento Browniano. Como o coeficiente de correla\u00e7\u00e3o entre duas\nvaria\u00e9veis, definido por\ta2 p 1 2 \u2022= , a a22\nsatisfaz sempre |p 1 2| C 1, percebe-se que o determinante de uma matriz de covari\u00e2ncias \u00e9 n\u00e3o negativo. Particularmente, para o VASPS usa-se movimentos brownianos n\u00e3ao correlacionados, isto \u00e9, a2 = 0 e, portanto, o determinante \u00e9 positivo.\nDefine-se Z um espa\u00e7o transformado tal que (3.12) realiza um mapeamento que transforma cada par (5,h) G X? em um par (r\u00e7,\u00a3) G Z. Utilizando a transforma\u00e7\u00e3o (3.14), a inequac\u00e3o (3.17) pode ser convertida no formato de uma desigualdade de Helmholtz em Z?, dado por\nAw \u2014 A2w > e^f,\t(n,^) G Z.\n(3.18)\nPara usar a transforma\u00e7\u00e3o (3.14), \u00e9 necessaria a hip\u00e9tese de que d, e e g sejam constantes, o que n\u00e3o \u00e9 verdade em geral, e particularmente no caso do VASPS, em que o modelo usado resulta em um par\u00e2metro d dependente de 5. Esta suposi\u00e7\u00e3o, no entanto, e razoavel quando se considera uma unica bola no MVS. Neste metodo, os valores dessas func\u00e3es sao aproximados em cada bola pelo valor que assumem no respectivo centro.\nEm um espa\u00e7o transformado com rede quadrada como o da Fig. 3.1, as desigualdades resultantes da aproxima\u00e7ao em cada ponto Zij da grade transformada podem ser expressas na forma matricial, resultando na desigualdade linear AW &lt;b, com A e b definidas como em (3.9), (3.10). Nesta express\u00e3o, W \u00e9 um vetor cujos elementos sao os valores aproximados no ponto Zj para o resultado w da transforma\u00e7ao (3.14) aplicada na versao discreta de V em Z.\nNo caso do VASPS, e poss\u00edvel transformar o sistema de desigualdades variacionais (2.27), discretizado como descrito, em um problema de programa\u00e7ao linear. No sistema (2.27), pelo menos uma das express\u00f5es deve ser satisfeita com igualdade. Isso significa que se deseja obter o maior vetor Vk sujeito as restric\u00e3es (2.27a) e (2.27b). O sistema \u00e9, ent\u00e3o, convertido na seguinte sequ\u00eaencia de problemas de programa\u00e7c\u00e3ao linear\nmax\te~3(zij }Wk (zj)\ni,j\nsujeito a AWk &lt;b,\tem Z,\t(3.19)\nWk(Zij) &lt;e3(ZijM[ z' >), Zj G Z,\nk = 0,... ,n, i = 0,...,N,N + 1 e j = 0,...,M,M + 1, \u00e0 exce\u00e7ao dos pares (i,j) dados por (0,0), (0,M +1), (N + 1,0) e (N + 1,M + 1). Note que W0 \u00e9 a fun\u00e7ao V0 de (2.15) representada no espaco transformado Z Nesse problema de programac\u00e3o linear, uma das restricoes deve ser satisfeita tambem na fronteira. O vetor de incognitas deve, portanto, incluir os nos de fronteira, \u00e0 exce\u00e7\u00e3o dos quatro nos dos cantos, que n\u00e3o pertencem \u00e0 regi\u00e3o coberta pelas bolas. Tornou-se necessario expandir a matriz A e modificar o vetor b para criar a nova desigualdade matricial AW &lt;\u00f2, em que W contem tambem os elementos de fronteira. As matrizes expandidas sao mostradas no Ap\u00eandice B.\nQuando d, e e g s\u00e3o constantes, o erro obtido usando a Discretiza\u00e7\u00e3o do Valor Medio com rede quadrada e de ordem O(r0). Apesar de essa ser a mesma ordem do erro obtido com o metodo tradicional de diferenc\u00e7as finitas discretizado pela Discretiza\u00e7ca\u00e3o no Valor Central, quando eles s\u00e3ao comparados observa-se uma melhora da precis\u00e3ao no MVS. Alem disso, o MVS pode ser usado com uma rede triangular [31] para reduzir a ordem do erro para O(r0). O efeito causado por par\u00eaametros variaveis ainda n\u00e3ao foi quantificado, mas desde que o passo de discretiza\u00e7c\u00e3ao r0 seja suficientemente pequeno, isso n\u00e3ao causa um grande incremento no erro. Como todas as fun\u00e7\u00e3es s\u00e3o cont\u00ednuas, a hipotese de que os par\u00eametros s\u00e3o constantes em uma bola torna-se mais irrelevante a medida que o raio r0 \u00e9 reduzido.\nCom a utiliza\u00e7\u00e3o da formulac\u00e3o (3.19) foi poss\u00e9vel resolver o problema de controle do VASPS e obter as regi\u00e3es de intervenc\u00e3o e os estados de destino para diferentes func\u00e3es de risco e de custo. O cap\u00e9tulo a seguir detalha os resultados obtidos.\nCap\u00edtulo\nResultados Num\u00e9ricos\nEste cap\u00e9tulo apresenta os resultados de controle impulsionai obtidos com diferentes func\u00f5es de custo e de risco. Define-se, desta forma, o mapeamento da regi\u00f5o de interven\u00e7ao e dos tamanhos otimos de intervenc\u00f5o na frequ\u00eancia da bomba para cada combinac\u00f5o de fun\u00e7\u00f5es. Esses resultados s\u00f5o apresentados na Sec\u00f5o 4.3. Antes, por\u00e9m, apresenta-se na Se\u00e7\u00f5o 4.1 o escalonamento no tempo, usado para regularizar a rede de discretiza\u00e7c\u00f5ao, e os dados para as simula\u00e7\u00f5es, descritos na Se\u00e7\u00f5o 4.2.\n4.1\tEscalonamento no tempo\nEm uma simula\u00e7ao num\u00e9rica utilizando o MVS, o espa\u00e7o de estados tem que ser discretizado em uma rede quadrada. Assim, se uma das vari\u00e1veis de estado possuir uma faixa de valores muito maior que as outras, o nu\u00e9mero de n\u00e9os nessa dimens\u00f5ao sera\u00e9 muito maior que nas demais. Isso ocorre no VASPS, em que as faixas de varia\u00e7\u00f5o do n\u00e9vel e do balan\u00e7o de vaz\u00f5o representam grandezas bem diferentes.\nPara ter uma boa precis\u00f5o nas variaveis de menor faixa, o numero de n\u00e1s na outra vari\u00e1vel pode se tornar muito grande, o que causa problemas computacionais. A forma encontrada para solucionar essa dificuldade foi fazer um escalonamento no tempo, o que afeta a vari\u00e9avel balan\u00e7co de vazao, 5, por\u00e9m nao influencia nos valores do n\u00e9vel, h. Como a vari\u00eancia do movimento browniano \u00e9 equivalente ao tempo decorrido desde o instante inicial, os processos utilizados para modelar o ru\u00e9do tamb\u00e9em s\u00f5ao afetados. A seguir, uma descri\u00e7c\u00f5ao mais detalhada do escalonamento utilizado \u00e9e apresentada.\nConforme mencionado, no modelo do VASPS s\u00f5ao usados movimentos brownianos descorrelacionados, isto \u00e9, os coeficientes de desvio-padr\u00f5o cruzados (a12 e a21) sao nulos. Al\u00e9m do uso de ru\u00eddos correlacionados ser desnecessario, a transforma\u00e7\u00f5o de estados do Cap\u00e9tulo 3, que leva do espa\u00e7o de estados X? ao espa\u00e7o transformado Z?, mapeia uma regi\u00f5o retangular em outra tamb\u00e9m retangular quando esses coeficientes s\u00f5o nulos, o que aumenta a conveni\u00eancia da escolha desse m\u00e9todo num\u00e9rico. A utiliza\u00e7ao de coeficientes a11 e a22 nao nulos \u00e9 necessaria para\nque a equa\u00e7\u00e3o (2.27b) seja el\u00edptica e o MVS possa ser aplicado. Assim, as formas diferenciais estoc\u00e1sticas que modelam o processo, apresentadas em (2.2), podem ser reescritas como\ndht\nd\u00f5t\n\u2014\u00f5tdt + andB \u00bfir\n^22 dBt2\n(4.1)\nSe for utilizada uma nova escala de tempo p, tal que\nP =\t,\nT0\no sistema \u00e9 reescrito como\ndhp\nd\u00f5p\n-1 \u00f3pdp + an^T0dBp\ndAr\na 22\\ZT\u00d5dBp\n(4.2)\nem que a relac\u00e3o entre as unidade de \u00f5t e \u00f5p \u00e9 dada por\n\u00f5t\n3\n-\n-T0s-\nO custo do controle impulsional, originalmente dado por (2.4), passa a ser expresso por\n[T e~aToPr(Xp)Todp + V e-aToTic(XT- ,AX^ )1{T<<r} + e-aToT0(XTI .\n\u2022/o\ti=i\t\u2019\n(4.3) pois o fator de desconto a tamb\u00e9m \u00e9 afetado, tornando-se aT0, al\u00e9m de dt = Todp, de modo que\nJ(x) = inf Ex vev\na nova fun\u00e7\u00e3o de risco vale T0r(Xp).\nCom esse escalonamento e considerando as covari\u00e2ncias cruzadas nulas, a nova desigualdade diferencial que descreve o sistema, correspondente a (3.17), \u00e9\nd2Vp + d2Vp +\t2\u00f5p BVp_ 2a\t2\ndhp a2 d\u00f5p Toa2 Ar dhp a2 p al\n(4.4)\nPara que o numero de linhas e colunas na rede quadrada seja o mesmo, o espaco transformado definido no Cap\u00edtulo 3, cujas vari\u00e1veis de estado sao n e deve ter faixas de valores de mesmo tamanho para as duas componentes, isto \u00e9, deve satisfazer\na\u00a3p \u2014 Adp,\nem que\nA<p\nA^p\n\u00c7max (p)\n^min (p)\n^max (p)\thmin (p) \u25a0\nDe (3.12), com b \u2014 0, na escala de tempo original, isso equivale a\nAhp\nA\u00f5p\nY\n\u2014\tA\u00f5p.\na22\n(4.5)\n(4.6)\n3\nL s J\nt\no \u00f5p\nz\n1 t\n\nUsando o fato que \u00f5p = To\u00f5t, \u00e9 poss\u00edvel escolher To de modo a igualar o numero de n\u00e1s nas duas dimens\u00f5es do espa\u00e7o transformado \u00c3, como segue\nAht \u2014 \u2014 ToA\u00f5t\na22\nCom a aplicac\u00e3o desse fator de escala no tempo, tornou-se poss\u00edvel fazer o c\u00f3lculo do controlador com equil\u00edbrio na discretiza\u00e7ao em cada dimens\u00e3o. Dessa forma, um requisito m\u00ednimo de precisa\u00e3o pode ser atendido sem que seja necess\u00f3ario deixar uma das dimenso\u00e3es com um nu\u00f3mero muito grande de no\u00f3s, reduzindo o esfor\u00e7co computacional. A seguir s\u00e3ao descritos os dados utilizados para fazer as simulac\u00e7\u00e3oes e posteriormente os resultados obtidos sa\u00e3o apresentados.\n4.2\tDescri\u00e7ao dos exemplos simulados\nA Petrobras tem previsao inicial de constru\u00e7\u00e3o de dois VASPS, para os quais foram realizados estudos de dimensionamento e das caracter\u00f3sticas de opera\u00e7ca\u00e3o. As dimens\u00e3oes resultantes desses estudos sao mostradas na Figura 4.1 e foram utilizadas para o calculo do controlador e nas simula\u00e7c\u00e3oes presentes nessa dissertac\u00e7\u00e3ao.\nFigura 4.1: Dimensoes do VASPS.\nComo mostrado na Figura 4.1(a), os 5m inferiores sao ocupados pelo reservat\u00f3rio de areia e de l\u00edquido. O n\u00edvel do l\u00edquido n\u00e3o pode ficar abaixo desse limite, pois a 4m do fundo encontra-se o tubo de suc\u00e7\u00e3o de l\u00edquido, no qual deve somente entrar l\u00edquido para n\u00e3o danificar a bomba. O controle do n\u00edvel de l\u00edquido deve mant\u00ea-lo no interior da faixa entre 5m e 9m, acima da qual a efici\u00eancia de separa\u00e7\u00e3o come\u00e7a a ser prejudicada pela diminui\u00e7\u00e3o do comprimento \u00fatil da h\u00edlice. Al\u00edm disso, como o l\u00edquido no reservat\u00f3rio ocupa todo o duto externo do VASPS (revestimento de pressuriza\u00e7ao), a dimens\u00e3o considerada na simula\u00e7ao para a area da se\u00e7\u00e3o transversal do reservato\u00edrio foi de um c\u00edrculo de 35 polegadas de dia\u00eametro, subtraindo-se as paredes do tubo\nda h\u00e9lice. Essas medidas correspondem ao VASPS da Figura 4.1, cujo di\u00e2metro externo \u00e9 de 40 polegadas, mas exclui-se a espessura das paredes, correspondente a 5 polegadas.\nCom rela\u00e7ao as caracter\u00edsticas de opera\u00e7\u00e3o, as simula\u00e7\u00e3es preveem uma varia\u00e7ao de vaz\u00e3o de entrada de 335m3/d em ciclos de 2,2 minutos. Esse valor de varia\u00e7\u00e3o foi considerado como um desvio-padr\u00e3o da distribui\u00e7ao do movimento browniano que modela o ru\u00eddo no balanco de vaz\u00e3o, a22. O desvio-padr\u00e3o da perturba\u00e7ao no n\u00edvel, an, foi arbitrariamente escolhido como sendo 0,1. Posteriormente, caso haja informa\u00e7ao sobre a precis\u00e3o do sensor de n\u00edvel, esta pode ser usada para aprimorar o valor desse coeficiente.\nPara uma vari\u00e9vel aleat\u00e9ria de distribui\u00e7\u00e3o gaussiana, h\u00e1 99,7% de probabilidade do valor assumido encontrar-se na faixa de \u00b13a. Por esse motivo, os balan\u00e7os m\u00e9ximo e m\u00ednimo de vaza\u00e3o foram determinados com base nas vaz\u00e3oes de entrada, considerando-se essa faixa com uma margem de seguran\u00e7a de 20%, isto \u00e9, 5max = \u20145min = 1,2 x 3 x a22.\nConforme mencionado na Sec\u00e3o 1.3, o risco r(Xt) de continuar com a mesma frequ\u00e2ncia no motor da bomba assume valores elevados quando o n\u00e9vel est\u00e9a pr\u00e9oximo do m\u00e9aximo e o balanc\u00e7o de vaz\u00e3ao \u00e9e positivo ou o n\u00e9vel esta\u00e9 pro\u00e9ximo do m\u00e9nimo e o balan\u00e7co de vaz\u00e3ao \u00e9e negativo. Para modelar esse efeito, escolheu-se uma fun\u00e7ao quadr\u00e9tica em h e 5 de modo a assumir valores mais altos nesses extremos. Como estar muito pr\u00e9oximo de um dos limites de n\u00e9vel \u00e9e ainda um pouco arriscado, mesmo se a tend\u00e2encia de varia\u00e7ca\u00e3o do n\u00e9vel for no sentido de se afastar, evitou-se a utiliza\u00e7c\u00e3ao de uma fun\u00e7c\u00e3ao que o n\u00e9vel m\u00e9nimo estivesse nos extremos do n\u00e9vel h, hmax e hmin. Para isso, a func\u00e7a\u00e3o quadra\u00e9tica foi adequadamente escolhida e rotacionada, conforme representado pelas curvas de n\u00e9vel, mostradas na Figura 4.2.\nFigura 4.2: Curvas de n\u00edvel do risco de continuacao.\nA express\u00e3ao geral usada para criar func\u00e7o\u00e3es quadra\u00e9ticas rotacionadas \u00e9e dada por\nri(5,h) = [h \u2014 ho\n5 \u2014 5o] \u2022 R \u2022\n1/a2\n0\n0\n1/b2\nh \u2014 ho\n5 \u2014 5o\t,\nem que (bo,ho) \u00e9 o ponto de valor m\u00e9nimo do paraboloide, a e b sao coeficientes que indicam o tamanho dos eixos das elipses no corte transversal e R \u00e9 uma matriz de rota\u00e7\u00e3o bidimensional. Para que o valor m\u00e9ximo da fun\u00e7ao pudesse ser facilmente escolhido, realizou-se uma normaliza-\u00e7ca\u00e3o seguida de uma multiplica\u00e7c\u00e3ao por um fator que determinasse esse ma\u00e9ximo, isto \u00e9e, a fun\u00e7c\u00e3ao r utilizada \u00e9 representada por\nr(\u00f5,h) = rmax\nri(\u00f4,h)\nmax r1(\u00f5,h)\n(4.9)\nO custo terminal ^>(Xt) foi escolhido de forma a variar linearmente em cada fronteira do espac\u00e7o de estados, seguindo a mesma tend\u00eaencia adotada para o risco de continua\u00e7c\u00e3ao de assumir valores elevados quando o n\u00e9vel est\u00e9 pr\u00e9ximo de hmax e \u00f4t > 0 ou o n\u00edvel aproxima-se de hmin e St &lt;0. Nesses dois extremos, a funcao atinge seu valor maximo, ^max e nos extremos opostos atinge o valor m\u00e9nimo, ^min.\nO custo de interven\u00e7ao c(XT- ,AXT) foi estabelecido como sendo a soma de uma parcela constante e uma parcela dependente de |A\u00e2T |, que corresponde a variacao do estado causada pela interven\u00e7c\u00e3ao, uma vez que a intervenc\u00e7\u00e3ao so\u00e9 altera instantaneamente o balan\u00e7co de vaza\u00e3o mas n\u00e3o o n\u00e9vel. Esse custo \u00e9, ent\u00e3o, descrito por\nc(Xt- AXt) = c\nsoma\n+ cmult | A\u00f5|n;\nem que |A\u00e2|ra representa o m\u00e9dulo normalizado pelo valor m\u00e9ximo que ele pode assumir, isto \u00e9,\n|A<\n|A\u00f5|\nmax I A\u00f5 I \u2019\n(4.10)\ncom \u00f51 e \u00f52 origem e destino, respectivamente.\nPor fim, supos-se um fator de desconto a de 0,4 e a discretizacao utilizada foi de 51 x 51 n\u00f3s. Nos resultados mostrados a seguir, varia-se alguns desses par\u00e2metros para mostrar o efeito de cada um deles na solu\u00e7ca\u00f5o do controle.\n4.3\tRegi\u00f5es obtidas\nConforme mencionado, a t\u00f3cnica de controle impulsional resulta no mapeamento de uma regi\u00f5ao de continuidade, ou regi\u00f5ao de n\u00f5ao-intervenc\u00e7\u00f5ao, no espa\u00e7co de estados, dentro da qual a melhor pol\u00edtica \u00f3 deixar o sistema evoluir livremente sem nenhuma altera\u00e7\u00f5o. A regi\u00f5o complementar dessa \u00f3 chamada de regi\u00f5o de intervenc\u00f5o e a amplitude da alteracao ideal para cada estado desta regiao tamb\u00f3m \u00f3 obtida como resultado do controle impulsional. Quando o estado passa para a regia\u00f5o de intervenc\u00e7a\u00f5o, uma atuac\u00e7\u00f5ao deve levar o sistema para um estado de destino \u00f3timo, obtido modificando-se o balan\u00e7o de vazao \u00f5 de acordo com a amplitude da altera\u00e7\u00f5o ideal determinada. Como o estado varia continuamente e logo que ele sai da regi\u00f5o de continuidade ocorre uma atua\u00e7ca\u00f5o, ao sair o estado n\u00f5ao deve afastar-se muito da fronteira entre essas regi\u00f5oes.\nDeste modo, na figuras a seguir utilizou-se apenas 2 linhas de estados de destino, correspondentes \u00e0s interven\u00e7\u00f5es otimas obtidas nos estados imediatamente ap\u00f3s as fronteiras esquerda e direita da regi\u00f5o de continuidade.\nAs figuras que se seguem mostram a regi\u00f5o de continuidade em amarelo e a de interven\u00e7\u00f5o em azul para diferentes par\u00e2metros do controlador. Os estados de destino quando o processo escapa da regi\u00f5ao de continuidade pela direita s\u00f5ao mostrados em verde e os estados quando escapa pela esquerda s\u00f5ao mostrados em vinho.\nA regi\u00f5o que ser\u00f3 tomada como base para compara\u00e7ao corresponde ao resultado com par\u00e2metros do controlador dados por ^max = 20, ^m\u00a1n = 10, rmax = 1, CsOma = 0,01 e cmu\u00a1t = 1,5. A Figura 4.3 mostra as regioes do espa\u00e7o de estados X? obtidas ap\u00f3s a estabilizac\u00f5o das regi\u00f5es e as correspondentes fun\u00e7oes Vz e M[Vi-1].\n9\n8.5\n7D\n7\n(D\n6.5\no >\nz 6\n5.5\n-600\t-400\t-200\t0\t200\t400\t600\nBalan\u00e7o de vaz\u00e3o \u00f4 (m3/d)\n12\n10\n8\n6\n4\n2\n0\n9\nV\u2019 (mesh) e MV\u2019 1 (surf)\n1000\n-1000\nh (m)\n(b)\nMV\n\u00f4 (m3/d)\nentre Vz e\n(a) Regi\u00e3o moderada.\nFigura 4.3: (a)Regi\u00f5es e destinos e (b) Compara\u00e7\u00f5o ^min \u2014 10, rmax \u2014 1 csoma \u2014 0,01 e Cmult \u2014 1,5\nM[Vz 1], com ^max = 20,\nNa Figura 4.3(b), as funcoes Vz e M[Vi-1] sao quase coincidentes, mas observa-se uma regi\u00f5o esbranquicada no canto correspondente a n\u00edvel de l\u00edquido baixo e balanco de vazao alto, que corresponde \u00e0 regi\u00f5o de continuidade, em que Vz \u00f3 menor que M[Vi-1]. Note que nessa figura \u00f3 poss\u00edvel observar que as funcoes obtidas parecem satisfazer a hip\u00f3tese do Lema 2.2 por formar uma curva suave, al\u00e9m das condicoes 1, 2 e 5 do Teorema 2.3. As condicoes 4 e 8 sobre a regiao D tamb\u00f3m parecem ser satisfeitas.\nmapas de controle.\n4.3.1\tVaria\u00e7\u00e3o do custo de interven\u00e7\u00e3o - tr\u00eas cen\u00f3rios\nInicialmente, variou-se a fun\u00e7\u00e3o de custo de interven\u00e7ao c, de modo a criar tr\u00eas cen\u00e9rios: um moderado, com os dados ja\u00e9 apresentados, um conservador, em que a preocupac\u00e7\u00e3ao com o risco de atingir a fronteira \u00e9e maior que o custo de interven\u00e7c\u00e3ao, e um liberal, que evita intervir com frequ\u00eancia. A regi\u00e3o moderada foi mostrada na Figura 4.3(a) e a Figura 4.4 apresenta as regi\u00e3oes conservadora e liberal.\n9\n8.5\n7D\n7\n(D\n6.5\n<u\n>\n6\n5.5\n5\n-600\t-400\t-200\t0\t200\t400\t600\nBalan\u00e7o de vaz\u00e3o 8 (m3/d)\n(a) Conservador.\nBalan\u00e7o de vaz\u00e3o 8 (m3/d)\n(b) Liberal.\nFigura 4.4: Regi\u00e3es e destinos para ^max = 20, ^m\u00a1n = 10, rmax = 1, c^ = 0,01 e: (a) cmuk = 1 e (b) cmult\t2.\nComo \u00e9 poss\u00edvel observar, ao aumentar o custo de interven\u00e7ao, o controlador torna-se mais liberal, pois o peso de cada interven\u00e7c\u00e3ao aumenta quando comparado com o risco de atingir a fronteira. Se, em vez de se variar o fator multiplicativo do m\u00e9dulo, a constante aditiva csoma fosse modificada, isso tamb\u00e9m seria observado. Al\u00e9m disso, a medida que a constante aditiva aumenta, as linhas de destino das interven\u00e7\u00f5es \u00e0 direita e a esquerda se aproximam. No caso extremo, quando cmult = 0, a linha de destino \u00e9 unica. Por outro lado, quando csoma = 0, as linhas de destino correspondem as fronteiras da regiao de continuidade.\n4.3.2\tVaria\u00e7ao de outras fun\u00e7oes\n9\n8.5\nT3\n7\n<u\n6.5\n<u\n>\nz 6\n5.5\n-600\t-400\t-200\t0\t200\t400\t600\nBalan\u00e7o de vaz\u00e3o 8 (m3/d)\nE, ZZ o \u25a0\u00c7\nz;\n\u00c7T\n<u \u25a0o \u00f5\n>\n9\n8.5\n8\n7.5\n7\n6.5\n6\n5.5\n5\n-600\t-400\t-200\t0\t200\t400\t600\nBalan\u00e7o de vaz\u00e3o 5 (m3/d)\n9\n8.5\nT3\n7\n<U\n6.5\n<U\n>\n6\n(a) Original.\n5.5\n-600\t-400\t-200\t0\t200\t400\t600\nBalan\u00e7o de vaz\u00e3o 8 (m3/d)\n9\n8.5\n7\n<U\n6.5\n<U\n>\n6\n(b) \u00d5/10.\n5.5\n-600\t-400\t-200\t0\t200\t400\t600\nBalan\u00e7o de vaz\u00e3o 8 (m3/d)\n(c) 2r(Xt).\n(d) a/2.\nFigura 4.5: Regi\u00f5es e destinos para: (a) a = 0,4, ^max = 20, ^min = 10, rmax = 1, csoma = 0,01 e cmult \u2014 1,5; (b) ^max \u2014 2j ^min \u2014 1; (c) rmax \u2014 2 e (d) a \u2014 0,2\nforma curva pr\u00f5xima aos extremos de n\u00edvel e torne-se praticamente uma faixa diagonal, como mostrado na Figura 4.5(b).\nO aumento do risco de continuacao r torna o controlador mais conservador, uma vez que as intervencoes ficam \u201cmais baratas\u201d quando comparadas com o risco de caminhar em direcao a uma fronteira. A diminui\u00e7ao do fator de desconto tamb\u00e9m tem esse efeito de aumentar o conservadorismo, pois significa que os tempos mais distantes no futuro passam a ter um peso maior que com a = 0,4. Desse modo, o custo terminal de se atingir a fronteira passa a ter um peso maior no custo total do controle impulsional e a regiao de continuidade fica menor.\nresto da fronteira o custo de interven\u00e7ao c \u00f3 pago e o processo \u00f3 transferido para o n\u00f3 do canto menos arriscado correspondente. Devido \u00e0 dinamica do sistema, o custo nas fronteiras em h fica fixo para todas as iterac\u00e3es, enquanto seu valor na fronteira em 5 se altera a medida que varia o m\u00ednimo do custo para cada n\u00f3vel h.\nOs resultados obtidos indicam qual o comportamento ideal do controlador. Para verificar se este comportamento est\u00f3a adequado ao funcionamento do sistema e qual a configura\u00e7ca\u00e3o das fun\u00e7\u00e3es mais ajustada \u00e0s necessidades operacionais, \u00f3 necessario fazer simula\u00e7\u00e3es de valida\u00e7ao das regi\u00e3es obtidas. Foi ent\u00e3o criado um simulador em Simulink com a gera\u00e7\u00e3o de um sinal de vaz\u00e3ao de entrada que imita as condi\u00e7c\u00e3oes de operac\u00e7a\u00e3o do VASPS e incorpora o modelo da planta. Uma descri\u00e7\u00e3o mais detalhada desse simulador e os resultados obtidos sao mostrados no cap\u00f3tulo a seguir.\nCap\u00edtulo\nO simulador do VASPS\nPara validar o resultado obtido para o controlador foram realizadas simula\u00e7\u00f5es do sistema em opera\u00e7ao, com a gera\u00e7\u00f5o de sinais de entrada semelhantes \u00e0s vaz\u00f5es que se espera encontrar. A Se\u00e7\u00f5o 5.1 apresenta a descri\u00e7\u00f5o do simulador criado e, em seguida, os resultados desses testes s\u00f5o apresentados na Se\u00e7ao 5.2. Por fim, a Se\u00e7\u00f5o 5.3 apresenta os estudos que foram realizados para obtenc\u00f5o de uma estimativa da vazao de entrada por meio de filtragem, necess\u00e1ria para a utilizac\u00f5o do controlador projetado.\n5.1\tSimula\u00e7\u00e3o do sistema\nA caracter\u00edstica prevista para a vaz\u00f5o de entrada de um VASPS em construcao pela Petrobras \u00e1 de um escoamento com golfadas que causam variacoes de 335m3/d em ciclos de 2,2 minutos e cujo valor m\u00e1dio \u00e1 de 3108,6m3/d. Para simular essa vaz\u00f5o, somou-se uma onda quadrada de m\u00e1dia nula com variac\u00f5o e frequ\u00eancia iguais as referidas, um valor constante equivalente ao valor m\u00e1dio e um movimento browniano aproximado, de desvio-padr\u00f5o 0,0001, capaz de causar flutuac\u00f5es aleat\u00e1rias na vaz\u00f5o.\nO sinal de vaz\u00f5o resultante dessa combina\u00e7ao \u00e1 uma entrada para o tanque que determina o n\u00e1vel, bem como a frequ\u00eaencia da bomba, que \u00e1e resultado da l\u00e1ogica de controle empregada. No simulador, constru\u00eddo em Simulink, essa l\u00f3gica, que retorna a vaz\u00f5o de sa\u00e1da desejada, \u00e1 calculada por meio de um c\u00e1digo em Matlab, responsavel pela chamada peri\u00f3dica do diagrama de blocos do Simulink mostrado na Figura 5.1. O c\u00e1digo em Matlab, juntamente com o bloco conversor de vazao em frequencia, mostrado na Figura 5.2(b), corresponde ao m\u00e1dulo do controlador. O conversor cont\u00e1em a curva inversa da bomba, que transforma a vaz\u00f5ao de sa\u00e1da requerida na correspondente frequ\u00eaencia de rota\u00e7ca\u00f5o da bomba, e um saturador, responsa\u00e1vel por manter as alterac\u00f5es na faixa de operacao da bomba, considerada entre 40Hz e 65Hz, conforme informac\u00f5es preliminares.\nA planta, mostrada na Figura 5.2(a) cont\u00e1m um sub-bloco que modela o comportamento da bomba, apresentado na Figura 5.2(c), e o calculo do n\u00e1vel no VASPS a partir das vaz\u00f5es de sa\u00e1da\nFigura 5.1: Diagrama de blocos principal do programa em Simulink.\nda bomba e de entrada. Na modelagem da bomba, uma fun\u00e7\u00e3o relaciona a frequ\u00eancia de rota\u00e7\u00e3o do motor com a vazao bombeada. Aqui, foi utilizada uma aproximac\u00e3o linear, considerando que a vazao m\u00e9dia corresponde a uma opera\u00e7\u00e3o em 60Hz, que \u00e9 a frequ\u00eancia de opera\u00e7\u00e3o nominal da bomba.\nBemba\tda\nse\u00e7ed transvErsal\n(a) Planta.\n(b) Conversor.\t(c) Bomba.\nFigura 5.2: Sub-blocos da simula\u00e7\u00e3o em Simulink.\nNessas simula\u00e7\u00e3es, a vazao de entrada gerada \u00e9 usada pela l\u00e9gica definida pelo mapa de controle para alterar ou n\u00e3o a vaz\u00e3o de sa\u00edda a partir do balan\u00e7o otimo determinado. As ocorr\u00eaencias de interven\u00e7c\u00e3oes na\u00e3o s\u00e3ao limitadas, apenas suas amplitudes devem obedecer a faixa de opera\u00e7c\u00e3ao da bomba. No sistema real, no entanto, na\u00e3o existe medi\u00e7ca\u00e3o da vaz\u00e3ao de entrada, apenas do n\u00edvel de l\u00edquido no reservat\u00e9rio. Deve-se, assim, estimar a vazao a partir das medidas de n\u00edvel por meio de um processo de filtragem. A Se\u00e7ao 5.3 aborda o filtro de Kalman implementado com este intuito, por\u00e9em o seu acoplamento ao simulador n\u00e3ao foi desenvolvido. A se\u00e7c\u00e3ao a seguir compara os resultados das simula\u00e7\u00e3es realizadas com as regi\u00e3es dos tr\u00eas cen\u00e1rios da Se\u00e7ao 4.3.1.\n5.2\tResultados\nForam realizadas simula\u00e7\u00e3es considerando a vaz\u00e3o de entrada descrita na se\u00e7\u00e3o anterior e algumas com casos especiais, como um pulso invertido para representar a queda de um po\u00e7o e o decaimento da vaz\u00e3o m\u00e9dia. Nos resultados a seguir, considerou-se que a vaz\u00e3o de entrada e o n\u00edvel s\u00e3o medidos sem nenhum ru\u00eddo. A Se\u00e7\u00e3o 5.2.1 mostra as simulac\u00e3es com as condic\u00e3es descritas na se\u00e7\u00e3o anterior e a Se\u00e7\u00e3o 5.2.2 refere-se \u00e0s condi\u00e7\u00e3es especiais.\n5.2.1\tSimula\u00e7\u00f5es dos tr\u00eas cen\u00e1rios: condi\u00e7\u00f5es normais de vazao\nA Figura 5.3 mostra a vaz\u00e3o de entrada, o n\u00edvel no reservat\u00e9rio e a frequ\u00eancia da bomba para uma simulacao com o controlador conservador constru\u00eddo na Se\u00e7\u00e3o 4.3.1. Al\u00e9m disso, mostra tamb\u00e9m a trajet\u00e9ria do sistema no espaco de estados.\nT5\nCO\nC\n\u00d4\n3400\n3200\n3000\n2800\n0\t5\t10\t15\t20\t25\n91\u2014\ng 8-\n\n5\ni\n10\n\u20141\n15\n20\n25\nZ 6-\n5 -0\n(a) Simulacao completa.\nTempo (h)\n(b) Primeiras horas.\no \u25a0\u00c7\n\u00c7T\n<D \u25a0u \"\u00d5\n>\n9\n8.5\n8\n7.5\n7\n6.5\n6\n5.5\n5 -600\n-400\t-200\t0\t200\t400\t600\nBalan\u00e7o de vaz\u00e3o 8 (m3/d)\n(c) Excurs\u00e3o em /V.\nE\nFigura 5.3: Simulacao com controlador conservador da Figura 4.4(a).\nDurante a simula\u00e7\u00e3o, que corresponde a pouco mais que um dia (105s), ocorreram 64 interven\u00e7\u00f5es do controlador, com altera\u00e7\u00f5o m\u00e9dia de 2,9337Hz, e o n\u00edvel ficou contido na faixa de 6 a 8m, demonstrando uma grande preocupa\u00e7\u00f5o com o risco de se aproximar dos extremos permitidos para o n\u00edvel. A Figura 5.3(b) mostra o trecho das duas horas iniciais da simula\u00e7\u00f5o. Nessa figura, \u00e9 poss\u00edvel observar o formato da vaz\u00f5o de entrada. Percebe-se, ainda, que o n\u00edvel tem pequenas flutua\u00e7\u00f5es correspondentes \u00e0s variac\u00f5es da componente de onda quadrada da entrada. Na Figura 5.3(c) \u00e9 poss\u00edvel ver que o estado tende a ficar apenas na parte central da regi\u00f5o de continuidade, evitando aproximar-se das fronteiras permitidas para o n\u00edvel.\nUma simula\u00e7\u00f5o semelhante para o controlador moderado \u00ed mostrada na Figura 5.4.\n3500\nCO\n3000\n0\n2500\n0\n5\n20\n25\n10\t15\nTempo (h)\n(a) Simula\u00e7\u00e3o completa.\n(b) Primeiras horas.\nE\nO \"0\n0\"\n(D \"0 \"\u00d5\n>\n5 -600\n-400\t-200\t0\t200\t400\nBalan\u00e7o de vaz\u00e3o 6 (m3/d)\n(c) Excursao em /V.\nFigura 5.4: Simulacao com controlador moderado da Figura 4.3(a).\nO total de interven\u00e7co\u00e3es do controlador ocorridas durante essa simula\u00e7c\u00e3ao diminuiu para 54, com alterac\u00e3es m\u00eddias de 2,9252Hz, praticamente o mesmo valor m\u00eddio que no cenario anterior. O n\u00edvel atingiu valores um pouco al\u00edm da faixa de 6 a 8m, demonstrando uma preocupa\u00e7\u00e3o um pouco menor com o risco de se aproximar dos extremos. Na Figura 5.4(c) \u00ed poss\u00edvel ver que o estado tamb\u00edem se mant\u00edem apenas na parte central da regi\u00e3ao de continuidade, evitando uma aproxima\u00e7c\u00e3ao das fronteiras de n\u00edvel, por\u00edem o fato da regi\u00e3ao de continuidade ser mais larga permite uma excurs\u00e3ao maior ao estado.\nO controlador liberal tamb\u00edm foi simulado e os resultados sao mostrados na Figura 5.5.\n3600 i-\n3400 -\n3200\n3000\n2800\n0\nT\nT\nT\nT\nT\n5\ni\n10\ni\n15\ni\u2014\n20\ni\u2014\n25\n(a) Simula\u00e7\u00e3o completa.\no \u25a0\u00e7\n\u00c7T\n<D \u25a0u \"\u00d5\n>\n77 60---------------------'\tI-----r\" -\nX\n50 -\t-\nLL\n40 I--1----1-----1----1---1-----1----1---1----1----\n0\t0.2\t0.4\t0.6\t0.8\t1\t1.2\t1.4\t1.6\t1.8\t2\nTempo (h)\n(b) Primeiras horas.\n9\n8.5\n8\n7.5\n7\n6.5\n6\n5.5\n5 -600\n(c) Excursao em /V.\nE\nFigura 5.5: Simula\u00e7\u00e3o com controlador liberal da Figura 4.4(b).\nm\u00e9dia das altera\u00e7\u00f5es subiu para 3,1065Hz. Percebe-se, ainda, que o controlador evita inter-ven\u00e7c\u00f5oes muito grandes, o que algumas vezes gera duas interven\u00e7c\u00f5oes muito pro\u00f3ximas, como pode ser observado inclusive nas duas primeiras horas, na Figura 5.5(b). A amplitude das alterac\u00f5es ficou ligeiramente maior que a dos outros controladores. O n\u00f3vel aproximou-se dos extremos, mas n\u00f5ao ocorreu nenhuma viola\u00e7ca\u00f5o para a vaza\u00f5o de entrada simulada. Na Figura 5.5(c) \u00f3e pos-s\u00f3vel ver que o estado tamb\u00f3em se mant\u00f3em apenas na parte central da regi\u00f5ao de continuidade, contudo esta \u00f3e bem larga, o que torna o controlador audacioso, permitindo uma grande variac\u00e7\u00f5ao do estado sem que nenhuma interven\u00e7ca\u00f5o ocorra.\nUm ponto interessante a observar \u00f3 que algumas vezes a frequ\u00e2ncia atingiu o valor de 65Hz, o que corresponde ao valor limite e mostra que pode ter ocorrido saturac\u00f5o. Isso se deve ao fato de a vaz\u00f5o m\u00f3dia estar pr\u00f3xima \u00e0 vaz\u00f5o m\u00f3xima de sa\u00edda da bomba, isto \u00f3, a vaz\u00f5o correspondente a 65Hz, que vale 3367,7m3/d. Dessa forma, a vaz\u00f5o de entrada prevista para o VASPS representa condi\u00e7\u00f5es bem rigorosas dado o seu dimensionamento, pois o controlador fica impossibilitado de criar um desbalanceamento mais negativo na vaz\u00f5o caso seja necessario. A pol\u00f3tica adotada deve ent\u00f5o ser suficientemente cautelosa para que isso nao ocorra.\nOs tr\u00e2s controladores mostraram-se eficientes nas simula\u00e7\u00f5es. Caso a entrada nao se distancie muito da que foi simulada, o controlador liberal \u00f3e mais interessante, uma vez que reduz o nu\u00f3mero de interven\u00e7\u00f5es. Como nem sempre a entrada se mant\u00f3m na forma aqui prevista, uma alternativa interessante \u00f3e utilizar os tr\u00e2es mapas e deixar que o operador decida qual deles est\u00f3a mais adequado para a presente condi\u00e7c\u00f5ao de atuac\u00e7\u00f5ao.\nO m\u00f3dulo de controle pode, ainda, guardar os mapas relacionados a diferentes pontos de atuac\u00e7\u00f5ao e identificar qual deles deve ser usado, de modo que, ao ocorrer uma altera\u00e7ca\u00f5o grande, ele consiga se adaptar sozinho as novas condi\u00e7oes. Isso \u00f3 particularmente \u00fatil para mudancas bruscas mas duradouras, como a queda de um poc\u00e7o, que provoca uma grande altera\u00e7ca\u00f5o na vaz\u00f5ao nominal de entrada. Utilizando um filtro nas medidas de n\u00f3vel, estima-se a vaz\u00f5ao de entrada e por meio da observa\u00e7c\u00f5ao dessas estimativas detecta-se o feno\u00e2meno de queda de po\u00e7co. Isso permite o chaveamento para outro mapeamento que tenha sido criado para um valor nominal de vaz\u00f5o mais pr\u00f3ximo do novo cen\u00f3rio ap\u00f3s a queda. A Figura 5.6 mostra um diagrama dessa tomada de decis\u00f5ao.\nFigura 5.6: Utilizacao da estimativa da vaz\u00f5o de entrada para alterar o mapeamento.\nCaso as condi\u00e7\u00f5es do sistema se alterem significativamente, novos mapeamentos podem ser gerados e as informa\u00e7\u00f5es atualizadas no controlador, de modo a se adequar ao novo ponto de operacao. E o caso, por exemplo, do decaimento que ocorre a longo prazo em decorr\u00eancia do envelhecimento dos po\u00e7os.\n5.2.2\tSimula\u00e7\u00f5es dos tr\u00eas cen\u00e1rios: vaz\u00f5es de entrada especiais\nDuas simula\u00e7\u00f5es foram feitas para testar o comportamento do controlador em situac\u00f5es extremas. A primeira \u00e9 a utiliza\u00e7ao de um pulso negativo na vazao m\u00e9dia, para representar a queda de um po\u00e7o e seu retorno \u00e0 opera\u00e7ao. As Figuras 5.7 e 5.8 mostram o comportamento dos controladores conservador e moderado, respectivamente, diante da queda de um po\u00e7co que representava 30% da vaz\u00f5o m\u00e9dia.\n1500\n3500\n3000\n2500\n2000\n5\n10\n15\n20\n25\n8\n40\n5\n10\n15\n20\n25\n60\n50\n5\n15\n20\n25\n0\n0\n0\nTempo (h)\nFigura 5.7: Queda de po\u00e7o com controlador conservador da Figura 4.4(a).\nA Figura 5.9 representa o comportamento do controlador liberal com a queda de um po\u00e7o de vazao m\u00e9dia igual a das figuras anteriores.\nNos tr\u00eas cenarios, os controladores foram capazes de lidar com essa situa\u00e7ao sem viola\u00e7\u00e3o dos limites de n\u00e9vel, embora tenha sido necessario dar saltos muito grandes na frequ\u00eancia da bomba. Numa queda de po\u00e7co real, no entanto, a diminuic\u00e7\u00e3ao da vaza\u00e3o na\u00e3o ocorre instantaneamente, na forma de um degrau. O controlador pode, portanto, dividir a atuac\u00e3o em atuac\u00e3es menores, de acordo com a alteracao da vazao de entrada. Se houver mais informa\u00e7\u00e3es sobre a duracao desse processo, a queda de poc\u00e7o pode ser simulada como uma rampa em vez de um degrau e uma simulac\u00e3o mais precisa pode ser obtida. Essas simulacoes, no entanto, sao importantes para mostrar que os controladores, embora constru\u00e9dos com o intuito de prolongar a vida u\u00e9til da bomba, t\u00eam capacidade de dar grandes saltos em frequ\u00eancia caso haja necessidade.\nA outra situac\u00e7\u00e3ao simulada foi o decaimento da vaza\u00e3o m\u00e9edia por envelhecimento dos poc\u00e7os, cuja ocorr\u00eaencia leva meses ou mesmo anos, mas nessas simula\u00e7c\u00e3oes esse processo foi acelerado para\n60\n0\n20\n25\n50-\n40 L 0\n20\n25\nTempo (h)\nFigura 5.8: Queda de poco com controlador moderado da Figura 4.3(a).\nFigura 5.9: Queda de po\u00e7o com controlador liberal da Figura 4.4(b).\nocorrer ao longo de um dia. A Figura 5.10 mostra o comportamento do controlador conservador com decaimento da vazao m\u00e9dia e a Figura 5.11 o comportamento do moderado. O controlador liberal \u00e9e mostrado na Figura 5.12.\n\n8\n\u00f5\n^6\n0\n5\n10\t15\t20\t25\nFigura 5.10: Envelhecimento de po\u00e7os com controlador conservador da Figura 4.4(a).\n0\n60\n5\n20\n\u2014I-\n25\n\u2014I-\n50-\n40 L 0\nJ I\n10\t15\nTempo (h)\nh\u2014L\nL\n20\nI\n25\n5\nFigura 5.11: Envelhecimento de pocos com controlador moderado da Figura 4.3(a).\ncontrolador conservador torna-se mais interessante, embora este atue mais, prejudicando a vida \u00fatil da bomba. Percebe- se, portanto, a import\u00e2ncia de se utilizar diferentes mapas de controle e de se ter um mecanismo de escolha do mapa mais adequado.\n5.3\tEstima\u00e7\u00e3o da vaz\u00e3o de entrada\nConforme mencionado na Se\u00e7ao 5.1, para que o controlador indique uma vazao de sa\u00edda para a bomba, ele precisa do balan\u00e7o de vazao otimo calculado pelo controle impulsional e de uma estimativa da vaz\u00e3o de entrada. Para fazer essa estima\u00e7ao, experimentou-se um Filtro de Kalman, por ser uma t\u00e9cnica de f\u00e9cil implementa\u00e7ao.\n4000\nT3\n2000\nFigura 5.12: Envelhecimento de po\u00e7os com controlador liberal da Figura 4.4(b).\nO Filtro de Kalman \u00e9 um estimador de estados para sistemas lineares dinamicos em tempo discreto afetados por ru\u00e9do branco, isto \u00e9, um ru\u00e9do cujo valor em um instante de tempo \u00e9 descorrelacionado do seu valor em tempos anteriores. O primeiro passo para sua implementac\u00e7a\u00e3o \u00e9, portanto, converter o modelo cont\u00ednuo do sistema para tempo discreto. Como a flutua\u00e7\u00e3o da vaz\u00e3ao de entrada n\u00e3ao \u00e9e um ru\u00e9do branco, possuindo inclusive uma componente perio\u00e9dica (onda quadrada), ela foi modelada como sendo o resultado da aplicacao de um filtro passa-baixas em um ru\u00eddo branco. Uma vez que a utiliza\u00e7\u00e3o do filtro passa-baixas representa o acr\u00e9scimo de mais um integrador ao sistema, tornou-se necess\u00e9ario a criac\u00e7a\u00e3o de uma terceira componente do estado, al\u00e9m do n\u00e9vel h e do balan\u00e7o de vaz\u00e3o 5. A nova componente w representa a variacao da vaza\u00e3o de entrada em torno de um valor nominal.\nUm filtro passa-baixas com func\u00e3o de transfer\u00eancia\nH (s) =\nTfs +1\naplicado em uma entrada e, resulta na sa\u00edda w que satisfaz a equacao diferencial\n-1\t1\nl\u00e3 = \u2014 w +-----e,\nTf\tTf\ncuja soluc\u00e7\u00e3ao \u00e9e dada por\nw(t) = e\tto>/Tf w(t0) +\te ds\nJ to\tTf\n= e~(t~to)/Tf w(t0) + (1 - e~(t~to)/Tf )e\n(5.1)\n(5.2)\nAssim, as equa\u00e7\u00f5es de estado para o sistema discreto podem ser obtidas considerando o passo\nde discretizac\u00e3o At = t \u2014 to e valem\nh(k + 1)\t=\th(k) + \u20145(k)\t(5.3a)\n\u00f5(k + 1)\t=\tQn + w(k) \u2014 Qb(k),\t(5.3b)\nw(k + 1)\t=\te~\u00c1t/Tf w(k) + (1 \u2014 e~\u00c1t/Tf)\te(k),\t(5.3c)\nem que e(k) \u00e9 um ru\u00eddo branco e gaussiano de m\u00e9dia nula usado para modelar a aleatoriedade das varia\u00e7\u00f5es da entrada, Qn \u00e9 a vaz\u00e3o m\u00e9dia de entrada, Qb \u00e9 a vazao de sa\u00edda, a vari\u00e9vel de controle, e Tf \u00e9 uma constante de tempo escolhida.\nO diagrama de blocos da Figura 5.13 mostra a modelagem do sistema em tempo discreto usada pelo filtro de Kalman.\nFigura 5.13: Representa\u00e7\u00e3o esquem\u00e9tica do modelo para controle de n\u00edvel de l\u00edquido.\nRepresentando o sistema (5.3) na forma matricial, com vetor de estados dado por x = [h 5 w]T, a equa\u00e7ao da din\u00e2mica da planta \u00e9\nx(k + 1) = F (k)x(k) + G(k)u(k) + r(k)e(k), k = 0,1,...,\t(5.4)\nem que e(k) \u00e9 denominado ru\u00eddo do processo e tem covariancia E[e(k)e(k)z] = rQ(k)rz e F e G s\u00e3ao obtidos a partir das equa\u00e7co\u00e3es (5.3).\nA equa\u00e7\u00e3o da medida de n\u00edvel \u00e9 representada por\ny(k) = H (k)x(k) + v(k), k = 1,2,...,\t(5.5)\ncom v uma sequ\u00e2ncia de m\u00e9dia zero, gaussiana e branca correspondente ao ru\u00eddo de medicao, cuja covari\u00e2ncia \u00e9 E[v(k)v(k)z] = R(k) e H(k) = [10 0].\nA m\u00e9dia condicionada a uma sequ\u00eancia Zk :=\tC k} de observa\u00e7\u00f5es dispon\u00edveis no\ninstante de tempo k \u00e9e representada por\nx(j|k) := E[x(j)|Zk].\nConforme explicado em [1], o algoritmo para implementa\u00e7\u00e3o do filtro de Kalman \u00e9 representado na Figura 5.14.\nO teste realizado com filtro de Kalman utilizou um sinal de vaz\u00e3ao de entrada criado externamente (obtido pelo gerador de vaza\u00e3o do simulador). Com isso, o primeiro somador e os blocos\nEvolu\u00e7\u00e3o Entrada conhecida do sistema\t(controle ou\n(estado verdadeiro)\tsensor)\nEstima\u00e7\u00e3o do estado\nCalculo da covariancia do estado\nFigura 5.14: Algoritmo de uma itera\u00e7ao do filtro de Kalman, vide [1].\nque o alimentam na Figura 5.13 foram substitu\u00eddos por um Unico bloco, correspondente aos dados usados como entrada. Esse novo diagrama, usado para a gerac\u00e3o das medidas de n\u00edvel, est\u00e1 mostrado na Figura 5.15.\nQin(k)\ny(k)\nv(k)\n+\n^^S(k + 1)\tAt/A\th(k)\nM *\tz2 \u2014 z\t\"O\nQb(k)\nFigura 5.15: Gera\u00e7ao de medidas de n\u00edvel de l\u00edquido.\nPara o teste realizado, ajustou-se as vari\u00e2ncias dos ru\u00eddos de processo e de medi\u00e7\u00e3o. A primeira foi escolhida como Q = 106 e a segunda, R = 0,1. Al\u00e9m disso, a constante de tempo do filtro passa-baixas foi ajustada para Tf = 100. Dadas as medidas de n\u00edvel, o filtro de Kalman estima o n\u00edvel real e a vaz\u00e3o de entrada. Para isso, necessita do valor da vaz\u00e3o de sa\u00edda. A\nvazao de sa\u00edda foi suposta inferior ao valor nominal da vazao de entrada em 100m3/d durante os primeiros 200s, igual ao valor nominal de 200s a 400s e superior em 100m3/d ap\u00f3s 400s. O resultado obtido \u00e9 mostrado na Figura 5.16.\n(a) 500s.\t(b) Amplia\u00e7\u00e3o: 35s.\nFigura 5.16: Estimativa da vaz\u00f5o de entrada usando filtro de Kalman.\nObserva-se que a vaz\u00f5o de entrada estimada n\u00f5o acompanha bem o valor real nos instantes de transic\u00f5es de frequ\u00eancia da bomba, em t = 200s e t = 400s, mas logo em seguida as estimativas voltam a aproximar-se bastante do valor real. Este filtro parece adequado para a utilizac\u00e7a\u00f5o em uma primeira etapa do projeto, pois acompanha bem os valores reais enquanto a vaz\u00f5o de sa\u00edda esta constante. Caso depois se mostre necess\u00e1rio obter estimativas mais precisas nas transi\u00e7\u00f5es da vaza\u00f5o de sa\u00edda, outros m\u00edetodos mais sofisticados de filtragem podem ser utilizados, como o filtro de part\u00edculas, em que cria-se diversos filtros paralelamente (part\u00edculas) e a evolucao deles \u00ede analisada e afetada por um processo de extinc\u00e7\u00f5ao das part\u00edculas que se distanciam do comportamento real do sistema. O resultado da filtragem com esta t\u00edecnica \u00ede uma ponderac\u00e7a\u00f5o dos filtros que melhor representam o sistema.\nCap\u00edtulo\nConclus\u00f5es\nEsta disserta\u00e7\u00f5o teve por objetivo propor um controlador para o n\u00f3vel do reservat\u00f3rio no VASPS, sistema inovador de separa\u00e7ao multif\u00f3sica no leito marinho, que apresenta caracter\u00f3s-ticas bem particulares do ponto de vista de controle. O n\u00f3vel tem que ser mantido dentro de uma faixa de opera\u00e7ca\u00f5o, na qual pode variar livremente, levando em conta que interven\u00e7co\u00f5es frequentes e de grande intensidade diminuem a vida u\u00f3til da bomba. Como o sistema encontra-se submerso no oceano, fazer manutenc\u00e7\u00f5ao ou reparos implica em um custo muito alto. Al\u00f3em disso, muitas vezes \u00f3e um processo demorado, por necessitar de sondas especiais que nem sempre est\u00f5ao a disposi\u00e7\u00f5o, resultando na perda da produ\u00e7\u00f5o de v\u00f3rios dias dos po\u00e7os ligados ao sistema. Por esse motivo, a preocupa\u00e7ca\u00f5o em prolongar a vida u\u00f3til da bomba adquire grande importa\u00e2ncia.\nA solu\u00e7c\u00f5ao adotada foi utilizar controle impulsional aplicado em um modelo do reservat\u00f3orio baseado em processos de difus\u00f5ao. O modelo criado baseou-se no balan\u00e7co de massa do sistema para relacionar n\u00f3vel de l\u00f3quido e diferen\u00e7ca entre vaz\u00f5ao de entrada e de sa\u00f3da. Al\u00f3em disso, as incertezas presentes, isto \u00f3, a flutua\u00e7\u00f5o da vaz\u00f5o de entrada e a imprecis\u00f5o na medida do n\u00f3vel, foram modeladas como movimentos brownianos.\nO controle impulsional consiste em determinar os instantes de atua\u00e7c\u00f5ao e a amplitude de cada interven\u00e7c\u00f5ao que minimizam o valor esperado de um funcional de custo do processo. A func\u00e7\u00f5ao custo representa o compromisso entre o risco de continuar sem atuar e o custo de cada interven\u00e7c\u00f5ao, bem como o custo de se atingir a fronteira do espa\u00e7co de estados, tido como estados terminais.\nPara obter a solu\u00e7c\u00f5ao do controle impulsional, utiliza-se uma sequ\u00e2encia associada de problemas de parada o\u00f3tima iterados. Estes, por sua vez, t\u00e2em correspond\u00e2encia com desigualdades variacionais. O Cap\u00f3tulo 2 prova a equival\u00e2encia entre a sequ\u00e2encia de paradas \u00f3otimas e o controle impulsional restrito a um numero arbitrario n de interven\u00e7\u00f5es e a converg\u00e2ncia deste para o caso com quantidade ilimitada de interven\u00e7co\u00f5es. Al\u00f3em disso, detalha-se tamb\u00f3em a correspond\u00e2encia dos problemas de parada \u00f3otima com desigualdades variacionais e a equival\u00e2encia entre a formu-la\u00e7ca\u00f5o com essas desigualdades e o problema de controle impulsional original. Essa disserta\u00e7ca\u00f5o propo\u00f5e a solu\u00e7c\u00f5ao desse problema pela aplica\u00e7c\u00f5ao do m\u00f3etodo num\u00f3erico Discretiza\u00e7c\u00f5ao do Valor\nM\u00f3dio, que permite a convers\u00e3o das desigualdades variacionais discretizadas em um problema de programac\u00e7\u00e3ao linear, cujas t\u00f3ecnicas de solu\u00e7ca\u00e3o sa\u00e3o amplamente conhecidas.\nO resultado obtido com o controle impulsional \u00f3e a definic\u00e7\u00e3ao de uma regi\u00e3ao de continuidade para os estados, dentro da qual deve-se deixar o sistema evoluir livremente de acordo com sua din\u00e2mica pr\u00f3pria. A regi\u00e3o complementar dessa \u00f3 chamada de regi\u00e3o de interven\u00e7ao, na qual o controle atua transferindo o estado para outro ponto, em geral contido na regia\u00e3o de continuidade. O controle impulsional tamb\u00f3em indica qual o valor dessa varia\u00e7c\u00e3ao de posi\u00e7c\u00e3ao para cada estado desta regi\u00e3ao cujo destino minimiza o custo.\nForam gerados mapas de controle para diferentes fun\u00e7c\u00e3oes de custo e em seguida o sistema foi simulado de forma a validar e comparar o controle executado por cada uma dessas regi\u00e3oes. As simula\u00e7\u00e3es foram baseadas na geracao de vaz\u00e3es de entrada com as caracter\u00edsticas que se espera encontrar no sistema real. Os resultados obtidos mostram que essa \u00f3 uma t\u00e9cnica de controle bastante interessante e que se encaixa bem no problema estudado.\nPerspectivas de trabalhos futuros\nEmbora as simula\u00e7\u00e3es indiquem um bom desempenho, alguns pontos ainda precisam ser implementados ou melhorados. O principal deles \u00f3 a implementacao do filtro que estima o n\u00f3vel real e a vaza\u00e3o de entrada por meio das medic\u00e7\u00e3oes de n\u00f3vel. Essa estimativa da vaza\u00e3o \u00f3e essencial para o funcionamento do controlador, pois o controle impulsional indica apenas o balanc\u00e7o ideal de vaz\u00e3ao e para calcular a vaz\u00e3ao de sa\u00f3da que deve ser fornecida pela bomba, \u00f3e necess\u00f3ario ter uma estimativa da vaz\u00e3o de entrada. Uma sugest\u00e3o de filtro de Kalman foi apresentada na Se\u00e7ca\u00e3o 5.3, mas seu acoplamento com o simulador ainda n\u00e3ao foi realizado. As simulac\u00e7\u00e3oes que foram realizadas consideravam que se tinha a informa\u00e7c\u00e3ao exata da vaza\u00e3o de entrada, o que n\u00e3ao corresponde ao sistema real.\nAl\u00f3em disso, uma melhoria a ser implementada \u00f3e permitir que o controlador fa\u00e7ca o chavea-mento entre diferentes mapas das regioes, conforme descrito na Sec\u00e3o 5.2. Isso permite o ajuste do controlador as caracter\u00edsticas de opera\u00e7ao do sistema, que variam ao longo do tempo.\nPretende-se, ainda, fazer as alterac\u00e7\u00e3oes no programa criado para gerac\u00e7\u00e3ao das regi\u00e3oes de modo que a faixa de varia\u00e7c\u00e3ao do balan\u00e7co de vaza\u00e3o n\u00e3ao precise ser sim\u00f3etrica. Isso permitir\u00f3a que a excursa\u00e3o m\u00f3axima da vaza\u00e3o de sa\u00f3da, determinada pelas frequ\u00e2encias ma\u00f3xima e m\u00f3nima da bomba, seja considerada.\nutilizar outras formas de fun\u00e7oes de risco e de custo mais ajustadas ao VASPS. Abordagens interessantes para esse assunto podem ser encontradas em [37], em que uma modelagem de risco \u00e9 proposta para determinar o momento que deve-se verter a agua de barragens para evitar enchentes e em [38], que descreve diversas modelagens de teoria de riscos.\nPublica\u00e7\u00f5es\n->\nO trabalho originou um artigo para o Conference on Decision and Control - CDC 2009, j\u00e9 aceito[39]. Al\u00e9em disso, os resultados est\u00e3ao sendo organizados para submiss\u00e3ao a um perio\u00e9dico da a\u00e9rea de controle.\nReferencias Bibliogr\u00e1ficas\n[1]\tY. Bar-Shalom, X. R. Li, and T. Kirubarajam, Estimation with Applications to Tracking and Navigation. John Wiley, 2004.\n[2]\tA. E. Dukler and Y. Taitel, \u201cFlow pattern transitions in gas-liquid systems: Measurement and modeling,\u201d Multiphase Science and Technology, vol. 2, pp. 1-94, 1986.\n[3]\tE. S. Rosa, F. A. Fran\u00e7a, and G. S. Ribeiro, \u201cThe cyclone gas-liquid separator: operation and mechanistic modeling,\u201d Journal of Petroleum Science and Engineering, vol. 32, no. 2-4, pp. 87- 101, 2001.\n[4]\tO. R. do Vale, J. E. Garcia, and M. Villa, \u201cVASPS installation and operation at campos basin,\u201d in Proc. OTC\u201902, Rio de Janeiro, Brazil, May 2002.\n[5]\tA. V. de Melo, A. B. S. Serapiao, and J. R. P. Mendes, \u201cM\u00e9todo da histerese por auto-ajuste para minimiza\u00e7\u00e3o de esfor\u00e7o de controle no separador submarino VASPS,\u201d SBA Controle &amp; Automa\u00e7\u00e3o, vol. 20, no. 1, 2009.\n[6]\tA. Bensoussan and J.-L. Lions, Impulse Control and Quasi-Variational Inequalities. Paris: Gauthier-Villars, 1984.\n[7]\tB. 0ksendal and A. Sulem, Applied Stochastic Control of Jump Diffusions, 2nd ed., ser. Universitext. Springer, 2007.\n[8]\tB. 0ksendal, Stochastic Differential Equations: An Introduction with Applications, 6th ed., ser. Universitext. Springer, 2007.\n[9]\tD. Sbarbaro and R. Ortega, \u201cAveraging level control: An approach based on mass balance,\u201d Journal Of Process Control, vol. 17, no. 7, pp. 621-629, 2007.\n[10]\tT.-F. Cheung and W. L. Luyben, \u201cNonlinear and nonconventional liquid level controllers,\u201d Industrial &amp; Engineering Chemistry - Fundamentals, vol. 19, no. 1, pp. 93-98, 1980.\n[11]\tA. Faanes and S. Skogestad, \u201cBuffer tank design for acceptable control performance,\u201d Industrial &amp; Engineering Chemistry Research, vol. 42, no. 10, pp. 2198-2208, 2003.\n[12]\tE. Horton, M. Foley, and K. Kwok, \u201cPerformance assessment of level controllers,\u201d International Journal Of Adaptive Control And Signal Processing, vol. 17, no. 7-9, pp. 663-684, 2003.\n[13]\tG. C. Nunes, A. A. R. Coelho, R. R. Sumar, and R. I. G. Mejia, \u201cA practical strategy for controlling flow oscillations in surge tanks,\u201d Latin American Applied Research, vol. 37, no. 3, pp. 195-200, 2007.\n[14]\tB. 0ksendal and A. Sulem, \u201cOptimal stochastic impulse control with delayed reaction,\u201d Appl. Math. Optim., vol. 58, pp. 243-255, 2008.\n[15]\tE. Cinlar, Introduction to Stochastic Processes. Englewood Cliffs: Prentice-Hall, 1975.\n[16]\tD. P. Bertsekas and J. N. Tsitsiklis, Introduction to Probability. Belmon: Athena Scientific, 2002.\n[17]\tS. E. Shreve, Stochastic Calculus for Finance II: Continuous-Time Models, 1st ed., ser. Springer Finance. Berlin: Springer, 2004.\n[18]\tJ. Harrison, T. Sellke, and A. Taylor, \u201cImpulse control of Brownian-motion,\u201d Mathematics of Operations Research, vol. 8, no. 3, pp. 454-466, 1983.\n[19]\tS. Barlev, M. Parlar, and D. Perry, \u201cImpulse control of a Brownian inventory system with supplier uncertainty,\u201d Stochastic Analysis and Applications, vol. 11, no. 1, pp. 11-27, 1993.\n[20]\tE. Arruda and J. D. Val, \u201cStability and optimality of a multi-product production and storage system under demand uncertainty,\u201d European Journal of Operational Research, vol. 188, no. 2, pp. 406-427, 2008.\n[21]\tM. Jeanblanc-Picque, \u201cImpulse control method and exchange rate,\u201d Mathematical Finance, vol. 3, pp. 161-177, 1993.\n[22]\tG. Mundaca and B. 0ksendal, \u201cOptimal stochastic intervention control with application to the exchange rate,\u201d Journal of Mathematical Economics, vol. 29, no. 2, pp. 225 - 243,\n1998.\n[23]\tA. Cadenillas and F. Zapatero, \u201cClassical and impulse stochastic control of the exchange rate using interest rates and reserves,\u201d Mathematical Finance, vol. 10, no. 2, pp. 141-156, 2000.\n[24]\tJ. Eastham and K. Hastings, \u201cOptimal impulse control of portfolios,\u201d Mathematics of Operations Research, vol. 13, no. 4, pp. 588-605, 1988.\n[25]\tA. J. Morton and S. R. Pliska, \u201cOptimal portfolio management with fixed transaction costs,\u201d Mathematical Finance, vol. 5, pp. 337-356, 1995.\n[26]\tR. Korn, \u201cSome applications of impulse control in mathematical finance,\u201d Mathematical Methods of Operations Research, vol. 50, no. 3, pp. 493-518, 1999.\n[27]\tL. H. R. Alvarez, \u201cStochastic forest stand value and optimal timber harvesting,\u201d SIAM Journal on Control and Optimization, vol. 42, no. 6, pp. 1972-1993, 2004.\n[28]\tM. Egami, \u201cA direct solution method for stochastic impulse control problems of onedimensional diffusions,\u201d SIAM Journal on Control and Optimization, vol. 47, no. 3, pp. 1191-1218, 2008.\n[29]\tZ. Chen and P. A. Forsyth, \u201cA numerical scheme for the impulse control formulation for pricing variable annuities with a guaranteed minimum withdrawal benefit (GMWB),\u201d Nu-merische Mathematik, vol. 109, no. 4, pp. 535-569, 2008.\n[30]\tJ. N. Tsitsiklis and B. V. Roy, \u201cOptimal stopping of Markov processes: Hilbert space theory, approximation algorithms, and an application to pricing high-dimensional financial derivatives,\u201d IEEE Transactions on Automatic Control, vol. 44, no. 10, pp. 1840-1851,\n1999.\n[31]\tM. G. Andrade and J. B. R. do Val, \u201cA numerical scheme based on mean value solutions for the Helmholtz equation on triangular grids,\u201d Mathematics of Computation, vol. 66, no. 218, pp. 477-493, April 1997.\n[32]\tW. H. Fleming and R. W. Rishel, Deterministic and Stochastic Optimal Control, ser. Apli-cations of Mathematics. New York: Springer-Verlag, 1982.\n[33]\tP. R. Garabedian, Partial Differential Equations. John Wiley &amp; Sons, 1964.\n[34]\tJ. B. R. do Val and M. G. Andrade, \u201cOn mean value solutions for the Helmholtz equation on square grids,\u201d Applied Numerical Mathematics, vol. 41, no. 4, pp. 459-479, 2002.\n[35]\tD. Gilbarg and N. S. Trudinger, Elliptic partial differential equations of second order, 2nd ed., ser. (Grundlehren der mathematischen Wissenschaften; v. 224). Berlin: Springer, 1983.\n[36]\tM. G. de Andrade Filho, \u201cUma abordagem num\u00e9rica para problemas de valor de contorno de Dirichlet envolvendo a equa\u00e7ao de Helmholtz,\u201d Faculdade de Engenharia El\u00e9trica e de Computa\u00e7\u00e3o, UNICAMP,\u201d Tese de Doutorado, Janeiro 1995.\n[37]\tM. G. Andrade, M. D. Fragoso, and A. A. Carneiro, \u201cA stochastic approach to the flood control problem,\u201d Applied Mathematical Modelling, vol. 25, no. 6, pp. 499-511, May 2001.\n[38]\tJ. Grandell, Aspects of Risk Theory, ser. Springer Series in Statistics. Springer-Verlag, 1991.\n[39]\tN. C. Pinheiro, J. B. R. do Val, and R. S. Mendes, \u201cStochastic intervention strategy applied to a level control with a trade-off between risky operation and actuator variations,\u201d in CDC 2009, December 2009, aceito.\nConceitos B\u00e1sicos no Estudo de Processos de Difus\u00e3o\nEspa\u00e7o mensur\u00e1vel: Se o espa\u00e7o amostrai de um processo \u00e9 representado por Q, diz-se que F representa uma a-\u00e9lgebra em Q quando F \u00e9 uma fam\u00e9lia de subconjuntos de Q com as seguintes propriedades:\n\u2022\t0GF;\n\u2022\tF F\tFC G F, em que FC = Q\\F \u00e9 o complemento de F em Q;\n\u2022\tAi,\u00c12,... G F A :=\tG F.\nA menor a-algebra formada por todos os subconjuntos abertos de um espa\u00e7o topologico Q \u00e9 chamada a-\u00e9lgebra de Borel e seus elementos s\u00f5o conjuntos de Borel. Uma fun\u00e7\u00f5o X : Q Rn \u00e9 dita F-mensur\u00e1vel se o seu dom\u00e9nio que gera um conjunto de Borel U pertence a a-\u00e1lgebra F, para todo conjunto boreliano U, isto \u00e9,\nX-1(U) := {w G Q; X(w) G U} G F, para todo conjunto de Borel U C Rn.\t(A.1)\nMedida de probabilidade e conceitos \u201cquase \u00e7ertamente\u201d e \u201cem quase todo lugar\u201d:\nDefine-se uma medida de probabilidade P em um espa\u00e7o mensur\u00e1vel (Q, F) como uma func\u00f5o P : F [0,1] tal que P(0) = 0, P(Q) = 1 e, se A1,A2,... G F e {Ai}j=1 \u00e9 disjunto (Ai C Aj = 0 se i = j), entao\nP (U\u201c1 Ai) = \u00a3 P(Ai).\t(A.2)\ni=1\nUsualmente, existem eventos A C Q tal que P(A) = 1. Se uma afirma\u00e7\u00f5o vale para todo w G A, diz-se que ela \u00e9 verdade quase certamente (q.c.) ou que a afirma\u00e7ao vale com probabilidade 1. Se a medida utilizada n\u00f5ao for uma probabilidade, diz-se que ela vale em quase todo lugar, ou para quase todo w G Q, quando \u00e9 valida para todo w fora de um conjunto de medida nula.\nFiltra\u00e7\u00e3o e {Ft}-adaptado: Uma filtrac\u00f5o em (Q,F) \u00f3 uma fam\u00f3lia {F}\u00ed>o de a-\u00f3lgebras Ft C F tal que 0 s &lt;t\tFS CZ F\u00bf. Um processo estocastico \u00f3 dito adaptado a uma\nfiltra\u00e7\u00f5o {Ft} se \u00f3 Ft-mensur\u00f3vel para todo t e um espa\u00e7o de probabilidades filtrado \u00f3 representado por (Q,F,{Ft}t^0,P).\nMovimento browniano: Um movimento browniano unidimensional Bt \u00f3 um processo estocas-tico cont\u00f3nuo com incrementos independentes estacion\u00f3nos de distribui\u00e7\u00f5o gaussiana, cujo valor esperado de cada incremento \u00f3e o estado inicial e a varia\u00e2ncia \u00f3e o tempo decorrido durante o intervalo. Escrito de outra forma [17], uma fun\u00e7\u00f5o cont\u00f3nua B(t) \u00f3 um movimento browniano se para todo 0 = t0 &lt;t1 &lt;... &lt;tm, os incrementos\nB(t1) - B(to), B(t2) - B(t1),..., B(tm) - B(tm_1)\ns\u00f5ao independentes e possuem distribuic\u00e7\u00f5ao gaussiana com\nE[B(ti+1) - B(ti)] = B(0) e E[(B(ti+1) - B(ti))2] = ti+1 - ti.\nTempo de parada: O tempo de parada de um processo estoc\u00f3stico Xt e uma variavel aleatoria T de modo que para qualquer t 0, \u00f3 poss\u00f3vel determinar se o evento {t &lt;t} ocorreu baseado no hist\u00f3rico {Xu; u &lt;t} do processo estoc\u00f3stico.\nPropriedade forte de Markov: A propriedade forte de Markov afirma que a probabilidade de um processo markoviano Xt encontrar-se em um estado j em um instante de tempo posterior a um tempo de parada T independe da trajet\u00f3ria do processo anterior a T, isto \u00f3e,\nP{Xt+s = j|X\u201e; u &lt;T} = PS(XT,j).\t(A.3)\nAl\u00f3em disso, em termos de valor esperado, essa independ\u00e2encia significa que para qualquer m natural, 0 &lt;s1 &lt;... &lt;sm e uma fun\u00e7\u00f5o positiva f definida em Fm, vale\nE[f (Xt+s,,.J\u00cdt+s.)|X,\u201e u \u00ab T] = E[f (Xs,,...,Xs\u201e)|Xo = Xt].\t(A.4)\nLei das esperan\u00e7as iteradas O valor esperado de qualquer esperan\u00e7a condicional de um processo X \u00f3e igual ao valor esperado de X, isto \u00f3e,\nE [E [X |U1,...,yra]] = E [X].\t(A.5)\nMartingal, supermartingal e submartingal: Um processo estocastico {Xt}t^0 em um es-paco (Q,F,P) \u00f3 chamado martingal com respeito a uma filtracao {Ft}t^0 (e com respeito a P) se\n(i)\tXt \u00f3 F-mensur\u00f3vel para todo t;\n(ii)\tE[|Xt|] &lt;x para todo t;\n(iii) E [Xs|Ft] = Xt para todo s t.\nSe (i) e (ii) sao validos e E[Xs|Ft] > Xt para todo s > t, entao Xt \u00e9 um submartingal. Por outro lado, se (iii) e substitu\u00eddo por E[Xs|Ft] &lt;Xt para todo s > t, entao Xt e um supermartingal.\nLema de Fatou: Se {fn} \u00e9 uma sequ\u00eancia de fun\u00e7\u00f5es mensur\u00e1veis nao-negativas, entao\nDe modo anaiogo,\nlim inf fnd^ &lt;lim inf fnd^\nn\tn\nlimsup fndy limsup\tfndy\t(A.7)\nn\tn\nComo E [f ] = f fdPf, em que Pf e a medida de probabilidade de f, vale tambem\n(A.6)\nE [lim sup fn] > lim sup E [fn].\nnn\n(A.8)\nConverg\u00eancia dominada de Lebesgue: Seja {fn} uma sequ\u00eancia de funcoes mensur\u00e1veis e g uma func\u00f5o integr\u00e1vel. Se |fn| &lt;g em quase todo lugar e fn\tf em quase todo lugar,\nent\u00f5o f e fn s\u00f5o integr\u00e1veis e J fndg,\tj fdp,.\nTeorema da Convergencia Limitada: Seja ^(Q) &lt;to e as fun\u00e7oes fn s\u00f5o uniformemente limitadas, ent\u00f5o fn\tf em quase todo lugar implica que f fndg,\tf fdp,.\nAp\u00eandice\nB\nMatrizes expandidas do MVS\nConforme mencionado na Se\u00e7ao 3.4, no problema de programa\u00e7ao linear descrito, uma das restri\u00e7\u00f5es deve ser satisfeita tamb\u00e9m na fronteira. O vetor de inc\u00e9gnitas W deve, portanto, incluir os n\u00e9s de fronteira, a excecao dos quatro nos dos cantos, que nao pertencem \u00e0 regiao coberta pelas bolas. Assim, W \u00e9 um vetor cujos elementos sao os valores aproximados no ponto Zj para o resultado w da transformacao (3.14) aplicada na versao discreta de V em Z. Para isso, foi necess\u00e1rio expandir a matriz A e modificar o vetor b, de modo a criar a nova desigualdade matricial AW &lt;b, com b dependendo apenas do termo nao-homog\u00e2neo para os nos internos e assumindo o valor da condi\u00e7cao de fronteira para os n\u00edos externos e\n\tA\tCup\tCbottom\t\u2014In 0]t\t[0 \u2014 In]t \u2019\t\n\t0\tIM\t0\t0\t0\t\nA =\t0\t0\tIM\t0\t0\t,\t(B.1)\n\t0\t0\t0\tIN\t0\t\n\t0\t0\t0\t0\tIN\t\nem que Cup, Cbottom representam matrizes de dimensao NM x M cujos elementos valem \u20141 nos pontos em que ha uma liga\u00e7ao do elemento de W correspondente \u00e0quela linha com as fronteiras superior e inferior, respectivamente; IM e IN sao as matrizes identidade de tamanho M x M e N x N, respectivamente; e 0 representa uma matriz de zeros com a dimensao adequada. O codigo em Matlab a seguir apresenta como construir a matriz A a partir da matriz A, do numero de linhas de n\u00edos internos, N, e do nu\u00edmero de colunas de n\u00edos internos, M.\nPer = 2*N+2*M;\nA2 = [A zeros(N*M,Per); zeros(Per,N*M+Per)]; for k=1:M\nA2((k-1)*N+1,N*M+k)=-1;\nA2(k*N,N*M+M+k)=-1;\nend\nA2(1:N,N*M+2*M+1:N*M+2*M+N) = -eye(N);\nA2(N*M-N+1:N*M,N*M+Per-N+1:N*M+Per) = -eye(N);\nA2(N*M+1:N*M+M,N*M+1:N*M+M) = eye(M);\nA2(N*M+M+1:N*M+2*M,N*M+M+1:N*M+2*M) = eye(M);\nA2(N*M+2*M+1:N*M+2*M+N,N*M+2*M+1:N*M+2*M+N) = eye(N);\nA2(N*M+2*M+N+1:N*M+Per,N*M+2*M+N+1:N*M+Per) = eye(N);\nComo exemplo, tome o caso em que M = N = 2. Tem-se, ent\u00e3o, uma regi\u00e3o com 4 nos em cada dimens\u00e3o, incluindo a fronteira. A matriz A, que n\u00e3o inclui os elementos de fronteira, tem dimensao MN x MN, isto e, 4 x 4 e vale\n\t4Io(Ar)\t-1\t-1\t0\nA =\t-1 -1\t4Io(Ar) 0\t0 4Io(Ar)\t-1 -1\n\t0\t-1\t-1\t4Io(Ar)\n(B.2)\nO vetor b tem dimens\u00e3o NM + 2(N + M) = 12 e vale\n4fn[1 - Io(Ar)]/A2 4/21 [1 - Io(Ar)]/A2 4/12[1 - Io(Ar)]/A2\n4/22[1 - Io(Ar)]/A2\nM[W '\nM[W k-1](zo2)\nM[W k-1](z3i)\nM[W k-1](z32)\nM[W k-1](zio)\nM[W k-1](z2o)\nM[W k-1](zi3)\nM[W k-1](z23)\n(B.3)\nem que / e a fun\u00e7\u00e3o da parte n\u00e3o-homog\u00eanea da desigualdade de Helmholtz e \u00e9 definida somente no interior e Zj, i = 0, . . . ,N,N + 1 e j = 0, . . . ,M,M + 1, representa um ponto em Z.\nA matriz A, de dimensbo (NM + 2(N + M)) x (NM + 2(N + M)) = 12 x 12, vale\n4Io(Ar)\t-1\t-1\t0\t-1\t0\t0\t0\t-1\t0\t0\t0\n-1\t4Io(Ar)\t0\t-1\t0\t0\t-1\t0\t0\t-1\t0\t0\n-1\t0\t4Io(Ar)\t-1\t0\t-1\t0\t0\t0\t0\t-1\t0\n0\t-1\t-1\t4Io(Ar)\t0\t0\t0\t-1\t0\t0\t0\t0\n0\t0\t0\t0\t1\t0\t0\t0\t0\t0\t0\t0\n0\t0\t0\t0\t0\t1\t0\t0\t0\t0\t0\t0\n0\t0\t0\t0\t0\t0\t1\t0\t0\t0\t0\t0\n0\t0\t0\t0\t0\t0\t0\t1\t0\t0\t0\t0\n0\t0\t0\t0\t0\t0\t0\t0\t1\t0\t0\t0\n0\t0\t0\t0\t0\t0\t0\t0\t0\t1\t0\t0\n0\t0\t0\t0\t0\t0\t0\t0\t0\t0\t1\t0\n0\t0\t0\t0\t0\t0\t0\t0\t0\t0\t0\t1"}]}}}