{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.08469"}, {"@name": "filename", "#text": "13307_Dissertacao_Mestrado_OLCarrapico.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "OSWALDO LUIZ CARRAPI\u00c7O \n \n \n \n \n \n \n \n \n \n \n \n \n\nCONTROLE PREDITIVO DE HORIZONTE INFINITO PARA  \n \n\nPROCESSOS INTEGRADORES COM TEMPO MORTO \n \n \n \n \n \n \n \n\nDisserta\u00e7\u00e3o apresentada \u00e0 Escola \n\nPolit\u00e9cnica  da  Universidade  de  \n\nS\u00e3o Paulo para obten\u00e7\u00e3o do t\u00edtulo \n\nde Mestre em Engenharia. \n\n \n \n \n \n \n \n \n \n \n \n \n \n\nS\u00e3o Paulo \n\nOutubro de 2004 \n\n\n\n \n \n \n\nOSWALDO LUIZ CARRAPI\u00c7O \n \n \n \n \n \n \n \n \n \n \n \n \n\nCONTROLE PREDITIVO DE HORIZONTE INFINITO PARA  \n \n\nPROCESSOS INTEGRADORES COM TEMPO MORTO \n \n \n \n \n \n\nDisserta\u00e7\u00e3o apresentada \u00e0 Escola \n\nPolit\u00e9cnica  da  Universidade  de  \n\nS\u00e3o Paulo para obten\u00e7\u00e3o do t\u00edtulo \n\nde Mestre em Engenharia. \n\n \n\n\u00c1rea de Concentra\u00e7\u00e3o: \n\nEngenharia Qu\u00edmica \n\n \n\nOrientador: \n\nProf. Dr Darci Odloak \n\n \n \n \n \n \n\nS\u00e3o Paulo \n\nOutubro de 2004 \n\n\n\n \nS\u00e3o Paulo \n\nOutubro de 2004 \n\n \n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n \n \n \n \n \n \n        Carrapi\u00e7o, Oswaldo Luiz \n\nControle Preditivo de Horizonte Infinito para Processos    \nIntegradores com Tempo Morto \n\n        S\u00e3o Paulo, 2004. \n102p. \n \nDisserta\u00e7\u00e3o (Mestrado) \u2013 Escola Polit\u00e9cnica  da  Universidade  de             \nS\u00e3o Paulo. Departamento de Engenharia Qu\u00edmica. \n\n \n1. Controle de Processos    2. Controle Nominal  3. Horizonte Infinito \n4. Processo Integrador       5. Tempo Morto         6. Reciclo \nI. Universidade de S\u00e3o Paulo.  Escola Polit\u00e9cnica. Departamento de  \nEngenharia Qu\u00edmica II. t \n\n \n\n\n\nAgradecimentos \n \n \n \nAo Prof. Dr. Darci Odloak pela orienta\u00e7\u00e3o dada na condu\u00e7\u00e3o deste trabalho \n \n\u00c0 minha esposa Elisa pelo enorme incentivo dado nessa caminhada, principalmente nos \nmomentos mais dif\u00edceis e que n\u00e3o foram poucos... \n \n\u00c0 Petrobras pela viabilidade de educa\u00e7\u00e3o continuada concedida aos seus profissionais \n \n\u00c0 Refinaria Presidente Bernardes RPBC, representada pelo Gerente Setorial Antonio \nMaylinch Teruel e pelo Gerente de Otimiza\u00e7\u00e3o Fernando Jos\u00e9 Novaes, por permitir e \nacreditar na realiza\u00e7\u00e3o dessa especializa\u00e7\u00e3o \n \nAo engenheiro Euclides Almeida Neto pelas contribui\u00e7\u00f5es feitas ao longo da trajet\u00f3ria \nprofissional de nossas carreiras \n \nAos colegas do setor, pelo incentivo \n \nAos meus pais, Fernanda e Ant\u00f4nio, pelo que representam.... \n \nAos meus av\u00f3s Br\u00edgida, Felismina (em mem\u00f3ria), Armindo (em mem\u00f3ria) e Rem\u00edzio (em \nmem\u00f3ria) que mostraram o caminho... \n \nAo engenheiro e professor Oscar Ros\u00e9 Filho (em mem\u00f3ria), pela inspira\u00e7\u00e3o da boa \nforma\u00e7\u00e3o de engenharia qu\u00edmica quando aluno... \n \nE em especial \u00e0 Deus, sem ele n\u00e3o seria poss\u00edvel...    \n\n\n\nSUM\u00c1RIO \n\nLista de Figuras i \n\nLista de Tabelas iii \n\nLista de S\u00edmbolos iv \n\nCap\u00edtulo 1 Introdu\u00e7\u00e3o e revis\u00e3o da literatura 1 \n\n1.1 Introdu\u00e7\u00e3o 1 \n\n1.2 Caracter\u00edsticas integradoras com tempo morto em processos qu\u00edmicos 2 \n\n1.3 Desenvolvimento dos controladores preditivos baseados em modelo (MPC\u2019s) 3 \n\nCap\u00edtulo 2 Modelo em vari\u00e1veis de estado para sistemas integradores 6 \n\n2.1 Introdu\u00e7\u00e3o 6 \n\n2.2 Representa\u00e7\u00e3o de modelos em vari\u00e1veis de estado 6 \n\n2.3 Modelo em vari\u00e1veis de estado para sistemas integradores sem tempo morto 7 \n\n2.4 Exemplo 14 \n\nCap\u00edtulo 3 Controlador IHMPC para sistemas integradores sem tempo morto 16 \n\n3.1 Introdu\u00e7\u00e3o 16 \n\n3.2 Controlador de horizonte infinito para sistemas integradores sem tempo morto 16 \n\n3.2.1 Lei de controle 16 \n\n3.2.2 O controlador IHMPC estendido de Rodrigues e Odloak (2003) 21 \n\n3.2.3 Nova extens\u00e3o para o IHMPC 24 \n\n3.2.4 Controlador IHMPC em duas camadas 28 \n\n3.3 Exemplos 30 \n\nCap\u00edtulo 4 IHMPC estendido para sistemas integradores com tempo morto 34 \n\n4.1 Introdu\u00e7\u00e3o 34 \n\n4.2 Modelo em vari\u00e1veis de estado para sistemas integradores com tempo morto 34 \n\n4.2.1 O ROSSMPC de Gouv\u00eaa e Odloak (1997) 34 \n\n4.2.2 Extens\u00e3o do ROSSMPC para sistemas integradores com tempo morto 36 \n\n4.3 Desenvolvimento do controlador IHMPC-E de modelo nominal 38 \n\n4.4 Observador de estados para o IHMPC-E 52 \n\n4.5 Aplica\u00e7\u00e3o do IHMPC-E a uma coluna de destila\u00e7\u00e3o 54 \n\n4.5.1 Descri\u00e7\u00e3o sum\u00e1ria do processo analisado 54 \n\n4.5.2 Representa\u00e7\u00e3o da coluna em vari\u00e1veis de estado 57 \n\n4.5.3 Filtro de Kalman para a coluna 59 \n\n4.5.4 Desempenho do IHMPC-E 60 \n\n4.5.4.1 Caso Nominal 60 \n\n4.5.4.2 Desempenho do IHMPC-E  para incertezas no modelo da planta 67 \n\n\n\nCap\u00edtulo 5 Aplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo 73 \n\n5.1 Descri\u00e7\u00e3o sum\u00e1ria do processo de \u00f3xido de eteno e seu problema de controle 73 \n\n5.2 Modelo em vari\u00e1veis de estado em sistemas integradores com tempos mortos diferentes 76 \n\n5.3 Conceitos de observabilidade de um sistema 79 \n\n5.4 Controle do sistema industrial de \u00f3xido de eteno com modelos aproximados 81 \n\nCap\u00edtulo 6 Conclus\u00f5es e Recomenda\u00e7\u00f5es 92 \n\n6.1 Conclus\u00f5es 92 \n\n6.2 Sugest\u00f5es para trabalhos futuros 93 \n\nRefer\u00eancias Bibliogr\u00e1ficas 94 \n\nAp\u00eandice A 96 \n\nA.1 Montagem matricial da predi\u00e7\u00e3o das sa\u00eddas ao longo do horizonte np  96 \n\nA.2 Fun\u00e7\u00e3o Custo do Problema P4.1 na forma quadr\u00e1tica 99 \n\nA.3 Fun\u00e7\u00e3o Custo do Problema P4.2 na forma quadr\u00e1tica 100 \n\nA.4 Fun\u00e7\u00e3o Custo do Problema P4.3 na forma quadr\u00e1tica 101 \n\n \n\n\n\ni \n\nLista de Figuras \n \n\nFigura 3.1- Resposta do sistema com os controladores I e II \n\nFigura 3.2- Fun\u00e7\u00f5es custo dos problemas P3.3 e P3.4b (controladores I e II) \n\nFigura 4.1- Esquema de controle convencional da coluna deisobutanizadora \n\nFigura 4.2- Tela gr\u00e1fica operacional da coluna deisobutanizadora no SDCD \n\nFigura 4.3- Auto-valores da matriz [ ]( )FI K C A?  \n\nFigura 4.4- Controladas 1y e 3y  com IHMPC-E  \n\nFigura 4.5- Manipuladas 1u e 2u  com IHMPC-E \n\nFigura 4.6- Fun\u00e7\u00e3o custo do caso servo em 1y e 3y com IHMPC-E  \n\nFigura 4.7- Controladas 1y e 4y  com IHMPC-E  \n\nFigura 4.8- Manipuladas 1u e 2u com IHMPC-E \n\nFigura 4.9- Fun\u00e7\u00e3o custo do caso servo em 1y e 4y  com IHMPC-E  \n\nFigura 4.10- Controladas 1y e 3y  em fun\u00e7\u00e3o da perturba\u00e7\u00e3o 1du  com IHMPC-E  \n\nFigura 4.11- Manipuladas 1u e 2u  em fun\u00e7\u00e3o da perturba\u00e7\u00e3o 1du  com IHMPC-E \n\nFigura 4.12- Fun\u00e7\u00e3o custo do caso regulador com perturba\u00e7\u00e3o 1du  com IHMPC-E  \n\nFigura 4.13- Controladas 1y e 3y  com IHMPC-E e incerteza nos ganhos  \n\nFigura 4.14- Manipuladas 1u e 2u  com IHMPC-E e incerteza nos ganhos \n\nFigura 4.15- Controladas 1y e 3y  com IHMPC-E e incerteza nas constantes de tempo  \n\nFigura 4.16- Manipuladas 1u e 2u  com IHMPC-E e incerteza nas constantes de tempo  \n\nFigura 4.17- Controladas 1y e 3y  com IHMPC-E e incerteza no tempo morto  \n\nFigura 4.18- Manipuladas 1u e 2u  com IHMPC-E e incerteza no tempo morto  \n\nFigura 5.1- Auto-valores da matriz [ ]( )FI K C A?  \n\nFigura 5.2- Varia\u00e7\u00e3o na composi\u00e7\u00e3o do g\u00e1s de reciclo : setpoints 1y e 2y  \n\nFigura 5.3- Manipuladas para o caso servo em 1y e 2y  \n\nFigura 5.4- Fun\u00e7\u00e3o custo do caso servo em 1y e 2y  \n\nFigura 5.5- Efeito do peso das vari\u00e1veis de folga no desempenho do IHMPC-E \n\nFigura 5.6- Varia\u00e7\u00e3o na temperatura de \u00f3leo t\u00e9rmico : setpoint 3y  \n\nFigura 5.7- Manipuladas para o caso servo em 3y  \n\n\n\nii \n\nFigura 5.8- Fun\u00e7\u00e3o custo do caso servo em 3y  \n\nFigura 5.9- Varia\u00e7\u00e3o na press\u00e3o do g\u00e1s de reciclo : setpoint 4y  \n\nFigura 5.10- Manipuladas para o caso servo em 4y  \n\nFigura 5.11- Perturba\u00e7\u00e3o na vaz\u00e3o de oxig\u00eanio: vari\u00e1veis controladas \n\nFigura 5.12- Perturba\u00e7\u00e3o na vaz\u00e3o de oxig\u00eanio: vari\u00e1veis manipuladas \n\n \n \n\n\n\niii \n\nLista de Tabelas \n \n\nTabela 3.1 \u2013 Par\u00e2metros de sintonia dos controladores I e II  \n\nTabela 4.1 \u2013 Par\u00e2metros de sintonia do IHMPC-E nominal  \n\nTabela 4.2 \u2013 Par\u00e2metros de sintonia do IHMPC-E de modelo incerto  \n\nTabela 5.1 \u2013 Par\u00e2metros de sintonia do IHMPC-E de modelo incerto  \n\n \n\n\n\niv \n\nLista de S\u00edmbolos \n \n\nA  matriz caracter\u00edstica do modelo incremental em malha aberta \n*A  matriz A  modificada que limita predi\u00e7\u00f5es das sa\u00eddas no infinito \n\nA%  matriz caracter\u00edstica do modelo posicional em malha aberta \n~\n\nAB  matriz auxiliar em fun\u00e7\u00e3o de A , B  e m  \n\nB  matriz de distribui\u00e7\u00e3o das entradas do modelo incremental em malha aberta \n\nB%  matriz de distribui\u00e7\u00e3o das entradas do modelo posicional em malha aberta \nC  matriz das sa\u00eddas do modelo incremental \n\nfC  matriz auxiliar da fun\u00e7\u00e3o objetivo dos problemas de programa\u00e7\u00e3o quadr\u00e1tica \n\nC%  matriz das sa\u00eddas do modelo posicional \nC  matriz auxiliar em fun\u00e7\u00e3o de A , C  e np  \n\nC\n==\n\n matriz auxiliar em fun\u00e7\u00e3o de A , B , C , m  e np  \n\nc  gradiente da fun\u00e7\u00e3o objetivo dos problemas de programa\u00e7\u00e3o quadr\u00e1tica \n0D  matriz dos ganhos de regime permanente \n0\nmD  matriz \n\n0D  estendida ao longo do horizonte de controle \n\niD  matriz dos coeficientes dos p\u00f3los integradores \ni\nmD  matriz \n\niD  estendida ao longo do horizonte de controle \n\ndD  matriz dos res\u00edduos de regime permanente \n\nD%  matriz auxiliar em fun\u00e7\u00e3o de 0D , iD , m  e t?  \ne  erro entre uma dada sa\u00edda y qualquer e seu valor de refer\u00eancia spy  \n\nF  matriz incremental do regime transiente do sistema \n\nuF  matriz auxiliar em fun\u00e7\u00e3o de \ndD , F  e N  \n\nxF  matriz auxiliar em fun\u00e7\u00e3o de F  \n\nG  matriz auxiliar em fun\u00e7\u00e3o de 0D , iD , F  e N  \n\nG  matriz auxiliar em fun\u00e7\u00e3o de 0D , iD , ? , F  e N  \n\n( )G s  matriz das fun\u00e7\u00f5es de transfer\u00eancia entre as sa\u00eddas e as entradas \n\n, ( )i jG s  fun\u00e7\u00e3o de transfer\u00eancia entre uma sa\u00edda i  e uma entrada j  \n\nH  matriz Hessiana da fun\u00e7\u00e3o objetivo dos problemas de programa\u00e7\u00e3o quadr\u00e1tica \n\n\n\nv \n\nI  matriz identidade \n* ( )I t  matriz referente a parcela din\u00e2mica associada aos p\u00f3los integradores \n\nI  matriz auxiliar das vari\u00e1veis de folga sk?  ao longo do horizonte de controle \n\nJ  matriz auxiliar em fun\u00e7\u00e3o de nu  e na  \n\nk  instante qualquer de tempo discreto \n\nFK  ganho do observador de estados (Filtro de Kalman) \n\nL  matriz auxiliar em fun\u00e7\u00e3o de ? e F  \n\nL  matriz L  estendida ao longo do horizonte de controle   \n\nm  horizonte de controle das vari\u00e1veis manipuladas \n\nN  matriz auxiliar usada na resposta do sistema ao degrau \n\n,i jna  n\u00famero de p\u00f3los da fun\u00e7\u00e3o de transfer\u00eancia entre a sa\u00edda iy  e a entrada ju  \n\nnd  n\u00famero de estados  \n\nnp  horizonte de predi\u00e7\u00e3o finito das vari\u00e1veis controladas \n\nnu  n\u00famero de entradas (vari\u00e1veis manipuladas) \n\nny  n\u00famero de sa\u00eddas (vari\u00e1veis controladas) \n\nP  matriz auxiliar do Filtro de Kalman em fun\u00e7\u00e3o de A , C , V  e W  \n\nQ  matriz de Lyapunov \n\nQ  matriz de pondera\u00e7\u00e3o das vari\u00e1veis controladas \n\nQ%  matriz Q  estendida ao longo de um horizonte definido m ou np  \nR  matriz de supress\u00e3o das vari\u00e1veis manipuladas \n\nR%  matriz R  estendida ao longo do horizonte de controle \nr  p\u00f3lo de uma fun\u00e7\u00e3o de transfer\u00eancia \n\ns  coeficiente da resposta ao degrau \n\nkS  matriz dos coeficientes da resposta ao degrau referente ao instante de tempo k  \n\n1S  matriz de pondera\u00e7\u00e3o das vari\u00e1veis de folga \ns\nk?  \n\n2S  matriz de pondera\u00e7\u00e3o das vari\u00e1veis de folga \ni\nk?  \n\nt  tempo \n\nT  matriz auxiliar das vari\u00e1veis de folga ik?  ao longo do horizonte de controle \n\nu  vetor das vari\u00e1veis manipuladas \n\nU  espa\u00e7o da regi\u00e3o vi\u00e1vel de solu\u00e7\u00e3o das vari\u00e1veis manipuladas \n\n\n\nvi \n\nV  matriz de sintonia do filtro de Kalman \n\nkV  fun\u00e7\u00e3o custo do algoritmo de controle num dado instante de tempo k  \n\nx  vetor de estados do modelo, \nTs d ix x x x? ?= ? ?  \n\n[ ] / 1k kx ? vetor de estados no instante k  com informa\u00e7\u00f5es da planta do instante anterior \n\n[ ] /k kx   vetor atualizado dos estados com informa\u00e7\u00f5es da planta do instante atual \nsx  vetor de estados integradores gerado pela forma incremental do modelo \ndx  vetor de estados est\u00e1veis do modelo \nix  vetor de estados integradores do modelo \n\ny  vetor das vari\u00e1veis controladas \n\nspy  vetor de refer\u00eancia (setpoints) das vari\u00e1veis controladas \n\n1\nspy  vetor estendido de setpoints das vari\u00e1veis controladas \n\np\nky  vetor de sa\u00eddas da planta medidas no instante k  \n\nW  matriz de sintonia do filtro de Kalman \n\n \n\nS\u00edmbolos Gregos \n \n\n?  operador diferen\u00e7a \n\nt?  per\u00edodo de amostragem do controlador preditivo \n\n( )t?  matriz da parcela din\u00e2mica associada aos estados transientes \n\n* ( )t?  matriz * ( )I t generalizada para integradores com diferentes tempos mortos \n\n?  matriz auxiliar para a atualiza\u00e7\u00e3o dos estados \n\n?  autovalores de uma matriz quadrada \n\n?  constante de tempo de um sistema de primeira ordem (dom\u00ednio de Laplace) \n\n?  matriz dos tempos mortos do sistema \n\n,i j?  tempo morto entre uma sa\u00edda i  e uma entrada j  \n\ns\nk?  vari\u00e1veis de folga num dado instante de tempo k , relacionadas aos p\u00f3los   \n\n            integradores criados pela forma incremental do modelo \ni\nk?  vari\u00e1veis de folga num dado instante de tempo k , relacionadas com os p\u00f3los  \n\n            integradores do sistema \n\n\n\nvii \n\nSiglas \n\n \n\nARX  Auto-Regressive with eXogenous inputs \n\nDCS  Digital Control System \n\nDMC  Dynamic Matrix Control \n\nFCC   Fluid Catalytic Cracking \n\nIHMPC Infinite Horizon Model Predictive Control \n\nIHMPC-E Extended Infinite Horizon Model Predictive Control \n\nLDMC  Linear Dynamic Matrix Control \n\nLP   Linear Programming \n\nMIMO  Multi-Input Multi-Output \n\nMPC  Model Predictive Control \n\nNLP  Non-Linear Programming \n\nOPOM  Output Prediction Oriented Model \n\nQDMC Quadratic Dynamic Matrix Control \n\nQP  Quadratic Programming \n\nROSSMPC Reducer Order State Space MPC \n\nSISO  Single-Input Single-Output \n\nSQP  Sequential Quadratic Programming \n\n \n\n \n\n \n\nSobrescritos \n\n \n\nT opera\u00e7\u00e3o de transposi\u00e7\u00e3o de uma matriz. \n\n \n\n\n\n \n\nRESUMO \n\n \n\nNa literatura de controle, os controladores preditivos dispon\u00edveis apresentam \n\naplica\u00e7\u00f5es limitadas em processos com caracter\u00edsticas integradoras. Uma dessas \n\nlimita\u00e7\u00f5es est\u00e1 relacionada \u00e0s propriedades estabilizantes que surgem da lei de controle \n\nquando o sistema \u00e9 colocado em malha fechada. O principal objetivo dessa disserta\u00e7\u00e3o \u00e9 \n\ndesenvolver um algoritmo de controle preditivo, nominalmente est\u00e1vel, baseado num \n\nhorizonte de predi\u00e7\u00e3o infinito das sa\u00eddas do sistema. Para essa finalidade, uma \n\nrepresenta\u00e7\u00e3o existente em vari\u00e1veis de estado \u00e9 analisada e estendida para ser capaz de \n\nser aplic\u00e1vel para processos est\u00e1veis e integradores, com tempo morto. \n\n \n\nDois m\u00e9todos distintos que garantem a estabilidade de sistemas integradores \n\nforam desenvolvidos com um MPC de horizonte infinito. Para o caso de realimenta\u00e7\u00e3o \n\nde estado, a estabilidade nominal do MPC proposto foi provada para os dois m\u00e9todos e \n\na efici\u00eancia dos controladores foi verificada atrav\u00e9s de exemplos da literatura de \n\ncontrole. Um dos controladores foi tamb\u00e9m aplicado em um processo de destila\u00e7\u00e3o de \n\numa refinaria de petr\u00f3leo. O algoritmo desenvolvido foi estendido para o caso de \n\nrealimenta\u00e7\u00e3o das sa\u00eddas com a inclus\u00e3o do filtro de Kalman para a estimativa dos \n\nestados do modelo. \n\n \n\nA aplica\u00e7\u00e3o do controlador em um sistema com diferentes tempos mortos entre \n\nas vari\u00e1veis integradoras foi tamb\u00e9m estudada. \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n\n\n \n\nABSTRACT \n\n \n\nIn the control literature, the available predictive controllers show limitations to \n\nbe applied in processes that have integrating behavior. One of these limitations is related \n\nto the stabilizing properties of the resulting control law when the system is in closed \n\nloop. The main objective of this work is to develop a nominal stable control algorithm \n\nbased on infinite prediction of system outputs. For this purpose  an existing state space \n\nrepresentation is explored and extended in order to be able to be applied to stable and \n\nintegrating process with dead time.  \n\n \n\nTwo distinct methods to assure stability of integrating systems were developed \n\nfor the infinite horizon MPC. For the case of state feedback, nominal stability of the \n\nresulting MPC was proved for the two methods and the efficiency of the controllers was \n\nverified through examples of the control literature. One of the controllers was also \n\napplied to an industrial distillation process of a petroleum refinery. The developed \n\nalgorithm was extended to the output feedback operation with the inclusion of a Kalman \n\nfilter for estimation of the model states.  \n\n \n\nThe application of the controller to a system with different dead times between \n\nintegrating variables was also studied. \n\n \n\n\n\n 1 \n\nCap\u00edtulo 1 \n\nIntrodu\u00e7\u00e3o e revis\u00e3o da literatura \n\n \n\n1.1 Introdu\u00e7\u00e3o \n \n\nDois importantes aspectos a serem observados em um determinado controlador \n\npreditivo multivari\u00e1vel s\u00e3o a sua aplicabilidade em sistemas que apresentam tempo \n\nmorto entre as entradas e as sa\u00eddas e a capacidade de tratar sistemas com p\u00f3los \n\nintegradores e/ou est\u00e1veis. Esses comportamentos combinados contemplam uma grande \n\nparcela dos processos qu\u00edmicos industriais e foi essa a principal motiva\u00e7\u00e3o no \n\ndesenvolvimento dessa disserta\u00e7\u00e3o, na qual prop\u00f5e-se um controlador nominalmente \n\nest\u00e1vel  e que possua a capacidade de combinar todas essas caracter\u00edsticas. \n\n \n\nOs primeiros algoritmos de controle preditivo multivari\u00e1vel baseado em modelo \n\n(MPC) surgiram no final da d\u00e9cada de 70 com o chamado DMC (Dynamic Matrix \n\nControl) proposto por Cutler e Ramaker (1979). O m\u00e9todo era baseado em horizonte de \n\npredi\u00e7\u00e3o finito e em coeficientes de resposta ao degrau e ao impulso. Esses coeficientes \n\narmazenados em uma matriz, s\u00e3o em grande n\u00famero coletados at\u00e9 a completa \n\nestabiliza\u00e7\u00e3o do sistema. Para sistemas de grande porte, exigia-se um grande esfor\u00e7o \n\ncomputacional para a \u00e9poca. A sua aplica\u00e7\u00e3o \u00e9 bastante satisfat\u00f3ria para sistemas \n\nest\u00e1veis mas possui limita\u00e7\u00e3o para uso em sistemas inst\u00e1veis ou integradores. Em 1986, \n\nGarcia e Morshedi desenvolveram o controlador QDMC baseado em programa\u00e7\u00e3o \n\nquadr\u00e1tica para uso nas restri\u00e7\u00f5es lineares das vari\u00e1veis manipuladas. \n\n \n\nA partir da\u00ed, diversas proposi\u00e7\u00f5es de abordar o problema de controle preditivo \n\npodem ser vistas na literatura ao longo do tempo. A primeira delas foi de representar o \n\nmodelo n\u00e3o mais em coeficientes de resposta, mas sim em vari\u00e1veis de estado. Como \n\ndecorr\u00eancia natural dessa representa\u00e7\u00e3o, tem-se duas maneiras de se tratar as entradas \n\nnesse modelo, ou seja, de forma posicional ou de forma incremental. Um outro aspecto \n\ninvestigado na literatura foi o horizonte de predi\u00e7\u00e3o das vari\u00e1veis controladas. Os \n\nprimeiros MPC\u2019s (convencionais) tiveram a sua formula\u00e7\u00e3o baseada em horizonte finito \n\npara as predi\u00e7\u00f5es, o qual \u00e9 parte integrante da lei de controle, tornando-se um par\u00e2metro \n\nde sintonia do controlador e influenciando a performance do mesmo.\n\n\n\nCap\u00edtulo 1 \u2013 Introdu\u00e7\u00e3o e revis\u00e3o da literatura       2 \n\n \n\n1.2 Caracter\u00edsticas integradoras com tempo morto em processos qu\u00edmicos  \n \n \n\nO sistema integrador mais conhecido em processos qu\u00edmicos \u00e9 o invent\u00e1rio em \n\nfase l\u00edquida de um determinado equipamento (n\u00edvel em vasos, reatores, fundos de \n\ncolunas de fracionamento, etc.). Normalmente essa din\u00e2mica vem acompanhada de \n\nalgum tempo morto, elevado ou n\u00e3o, conforme a particularidade de cada sistema. \n\n \n\nEm rela\u00e7\u00e3o a um processo como um todo, onde tem-se v\u00e1rios equipamentos \n\ninterligados, a caracter\u00edstica integradora aparece pelo fato de haver uma ou mais \n\ncorrentes de reciclo em algum ponto do processo.  \n\n \n\nMoro e Odloak (1995) descrevem que o conversor de uma unidade de \n\ncraqueamento catal\u00edtico em leito fluido (FCC), que existe na maioria das refinarias de \n\npetr\u00f3leo, torna-se integrador quando a temperatura do reator \u00e9 usada como vari\u00e1vel \n\nmanipulada pelo MPC. \n\n  \n\nRecentemente, Wu et al (2003) descreveram processos com caracter\u00edsticas \n\nintegradoras com tempo morto (reator interligado com reciclo de uma coluna de \n\ndestila\u00e7\u00e3o) e estabeleceram algumas estrat\u00e9gias de controle para esses casos, mas sem \n\nser considerado um controle preditivo. Nesse trabalho observa-se que h\u00e1 in\u00fameras \n\nrefer\u00eancias anteriores citadas, por exemplo, Luyben et al (1999), que apresentam \n\nestudos sobre a intera\u00e7\u00e3o entre processos integradores e estrat\u00e9gias de controle. \n\nPercebe-se ent\u00e3o que existe uma linha de pesquisa desse assunto na literatura ainda \n\naberta e com poucas publica\u00e7\u00f5es. \n\n \n\nAssim, efetivamente um algoritmo de controle ter\u00e1 que ser analisado sob \n\naspectos da teoria de controle, e tamb\u00e9m, com rela\u00e7\u00e3o \u00e0 capacidade de interagir com a \n\ndin\u00e2mica dos processos qu\u00edmicos, particularmente os integradores com tempo morto. \n\n \n\n\n\nCap\u00edtulo 1 \u2013 Introdu\u00e7\u00e3o e revis\u00e3o da literatura       3 \n\n \n\n1.3 Desenvolvimento dos controladores preditivos baseados em modelo (MPC\u2019s)  \n \n\nO controlador preditivo multivari\u00e1vel \u00e9 um algoritmo de controle em tempo \n\ndiscreto que incorpora internamente um modelo do processo que permite prever para \n\ninstantes futuros a resposta do mesmo. Em cada instante de amostragem, a lei de \n\ncontrole (sequ\u00eancia discretizada de a\u00e7\u00f5es das vari\u00e1veis manipuladas) \u00e9 obtida a partir da \n\notimiza\u00e7\u00e3o de uma fun\u00e7\u00e3o objetivo, a qual \u00e9 formulada ao longo de um horizonte de \n\notimiza\u00e7\u00e3o. Somente a primeira a\u00e7\u00e3o de controle \u00e9 implementada. No instante de \n\namostragem seguinte todo o procedimento \u00e9 repetido. \n\n \n\nCom rela\u00e7\u00e3o \u00e0 forma de representa\u00e7\u00e3o do modelo em vari\u00e1veis de estado, a \n\nmaioria dos trabalhos dispon\u00edveis em literatura usam a forma posicional. Sob o ponto de \n\nvista de aplica\u00e7\u00e3o industrial, a forma posicional n\u00e3o \u00e9 implement\u00e1vel em fun\u00e7\u00e3o de \n\nperturba\u00e7\u00f5es naturais no processo, que n\u00e3o s\u00e3o medidas e que podem levar o sistema a \n\nv\u00e1rios estados estacion\u00e1rios desconhecidos ao longo do tempo.  \n\n \n\nA representa\u00e7\u00e3o de um MPC em vari\u00e1veis de estado apareceu primeiramente \n\nformulada por Li e Fisher (1989) que explicam suas propriedades e mostram a \n\nutiliza\u00e7\u00e3o do filtro de Kalman para estimar o estado e perturba\u00e7\u00f5es n\u00e3o medidas do \n\nprocesso. Lee et al (1994) tamb\u00e9m desenvolveram um MPC em vari\u00e1veis de estado. \n\n \n\nLee e Xiao (2000), Lee e Cooley (2000) apresentam abordagens em vari\u00e1veis de \n\nestado na forma incremental.  \n\n \n\nOdloak (1996) apresenta um desenvolvimento original para a forma incremental \n\ndenominado OPOM (Modelo Orientado \u00e0 Predi\u00e7\u00e3o da Sa\u00edda) e utilizado por Rodrigues \n\ne Odloak (2003), o qual \u00e9 aqui estendido para aplica\u00e7\u00e3o em diversos tipos de processos, \n\nest\u00e1veis ou integradores, incorporando ou n\u00e3o tempo morto. A caracter\u00edstica principal \n\ndesse m\u00e9todo \u00e9 que a predi\u00e7\u00e3o passe a ser obtida de forma anal\u00edtica ao inv\u00e9s da maneira \n\nconvencional, que armazena todos os valores de resposta em forma de um vetor.  \n\n \n\n\n\nCap\u00edtulo 1 \u2013 Introdu\u00e7\u00e3o e revis\u00e3o da literatura       4 \n\nRodrigues (2001) considerou o OPOM para sistemas est\u00e1veis e inst\u00e1veis, n\u00e3o \n\nabordando o caso de sistemas com tempo morto. \n\n \n\nCano (2001) utilizou o OPOM em sistemas integradores puros sem tempo morto \n\nno desenvolvimento de um algoritmo de controle robusto. Uma das proposi\u00e7\u00f5es citadas \n\npara futuros trabalhos era a extens\u00e3o do m\u00e9todo para sistemas com p\u00f3los integradores e \n\nest\u00e1veis, incorporada agora nesta disserta\u00e7\u00e3o a qual \u00e9 tamb\u00e9m estendida para a inclus\u00e3o \n\nde tempo morto. \n\n \n\nCom rela\u00e7\u00e3o ao horizonte de predi\u00e7\u00e3o, Rawlings e Muske (1993) mostraram que \n\npara sistemas est\u00e1veis quando o estado \u00e9 medido e o horizonte de predi\u00e7\u00e3o tende a \n\ninfinito, ent\u00e3o o MPC \u00e9 inerentemente est\u00e1vel independentemente dos par\u00e2metros de \n\nsintonia utilizados pelo controlador. Neste caso, fica impl\u00edcita tamb\u00e9m a hip\u00f3tese de que \n\no modelo do processo seja perfeito, isto \u00e9, n\u00e3o contenha erros de modelagem. Esse caso \n\n\u00e9 definido como nominal. O algoritmo de controle \u00e9 denominado IHMPC (Controle \n\nPreditvo baseado em Modelo de Horizonte Infinito) e \u00e9 formulado em vari\u00e1veis de \n\nestado na forma posicional. Ele \u00e9 restrito a sistemas est\u00e1veis em malha aberta. A \n\nestrat\u00e9gia principal desse m\u00e9todo consiste em converter o horizonte de predi\u00e7\u00e3o infinito \n\npara um estado terminal equivalente cujo peso \u00e9 obtido pela equa\u00e7\u00e3o discretizada de \n\nLyapunov. \n\n \n\nRodrigues e Odloak (2000), usando o OPOM, desenvolveram uma formula\u00e7\u00e3o \n\nalternativa para o MPC de horizonte infinito (IHMPC) em rela\u00e7\u00e3o ao convencional. \n\nEssa nova formula\u00e7\u00e3o tem v\u00e1rias vantagens sobre a anterior. A principal delas \u00e9 que se \n\naplica a sistemas n\u00e3o quadrados (n\u00famero de manipuladas diferente do n\u00famero de \n\ncontroladas), o que n\u00e3o acontece com o controlador de Rawlings e Muske (1993). A \n\nformula\u00e7\u00e3o por\u00e9m, n\u00e3o contemplava na \u00e9poca os sistemas integradores.  \n\n \n\nEsta disserta\u00e7\u00e3o est\u00e1 dividida em seis cap\u00edtulos incluindo este introdut\u00f3rio.  \n\n \n\nNo Cap\u00edtulo 2 apresentamos a representa\u00e7\u00e3o de sistemas em vari\u00e1veis de estado, \n\ndando \u00eanfase \u00e0 forma incremental, mostrando a evolu\u00e7\u00e3o do OPOM desde seu in\u00edcio at\u00e9 \n\nincorporar sistemas est\u00e1veis e integradores sem tempo morto.  \n\n\n\nCap\u00edtulo 1 \u2013 Introdu\u00e7\u00e3o e revis\u00e3o da literatura       5 \n\nNo Cap\u00edtulo 3 apresentamos o desenvolvimento de um algoritmo de controle \n\npreditivo de horizonte infinito, nominalmente est\u00e1vel, para sistemas integradores sem \n\ntempo morto, baseado no OPOM. O m\u00e9todo \u00e9 uma exten\u00e7\u00e3o do utilizado por Rodrigues \n\ne Odloak (2003) o qual fornece a estabilidade para o caso nominal para condi\u00e7\u00f5es de \n\nprocesso mais amplas do que em m\u00e9todos anteriores. Sua caracter\u00edstica principal \u00e9 a \n\nelimina\u00e7\u00e3o do conflito entre as restri\u00e7\u00f5es das vari\u00e1veis manipuladas e as restri\u00e7\u00f5es de \n\nigualdade que surgem para anular o efeito dos modos integradores ao final do horizonte \n\nde controle. A formula\u00e7\u00e3o da lei de controle \u00e9 a definida em Cano e Odloak (2003) que \n\ncontempla sistemas est\u00e1veis e integradores. \n\n \n\nNo Cap\u00edtulo 4 \u00e9 desenvolvida a extens\u00e3o do controlador de horizonte infinito \n\nnominalmente est\u00e1vel para sistemas integradores com tempo morto. A corre\u00e7\u00e3o dos \n\nestados \u00e9 feita atrav\u00e9s de um observador, sendo utilizado o filtro de Kalman para essa \n\nfinalidade. Apresentaremos a aplica\u00e7\u00e3o desse controlador em um processo de destila\u00e7\u00e3o \n\nde hidrocarbonetos leves, t\u00edpico de uma refinaria de petr\u00f3leo.  \n\n \n\nNo Cap\u00edtulo 5 apresentamos os resultados do controlador de horizonte infinito \n\naqui desenvolvido para um sistema que possua tempos mortos diferentes entre as \n\nvari\u00e1veis integradoras. Nessa aplica\u00e7\u00e3o, \u00e9 verificada a performance de rastreabilidade \n\nem rela\u00e7\u00e3o aos \u2018setpoints\u2019 e a rejei\u00e7\u00e3o de perturba\u00e7\u00f5es. O processo analisado \u00e9 um \n\nreator catal\u00edtico com reciclo de uma corrente em fase vapor oriunda de coluna de \n\nabsor\u00e7\u00e3o. Esse sistema foi apresentado por Cano (2001) e Rodrigues e Odloak (2003), \n\npor\u00e9m sem a presen\u00e7a de tempos mortos e tamb\u00e9m com estrutura de controle diferente \n\nda que apresentaremos aqui. \n\n \n\nNo Cap\u00edtulo 6 apresentamos as conclus\u00f5es finais sobre a proposi\u00e7\u00e3o desse novo \n\nalgoritmo de controle.  \n\n \n\n\n\n 6 \n\nCap\u00edtulo 2 \n\nModelo em vari\u00e1veis de estado para sistemas integradores   \n\n \n\n2.1 Introdu\u00e7\u00e3o \n \n\nO objetivo deste cap\u00edtulo \u00e9 apresentar o modelo que ser\u00e1 utilizado no \n\ndesenvolvimento do MPC de horizonte infinito para sistemas com din\u00e2mica est\u00e1vel e \n\nintegradora simultaneamente, sem a presen\u00e7a de tempo morto, o qual ser\u00e1 visto no \n\ncap\u00edtulo seguinte. \n\nO modelo estudado est\u00e1 na forma de vari\u00e1veis de estado e, como veremos, com \n\ncaracter\u00edsticas bastante adequadas para a interpreta\u00e7\u00e3o f\u00edsica dos estados, o que facilita a \n\ndedu\u00e7\u00e3o das condi\u00e7\u00f5es necess\u00e1rias para a garantia da estabilidade da malha fechada. \n\n \n\n2.2 Representa\u00e7\u00e3o de modelos em vari\u00e1veis de estado \n \n\nEm sistemas discretos lineares invariantes no tempo, a representa\u00e7\u00e3o em \n\nvari\u00e1veis de estado de um sistema qualquer aparece na literatura de duas formas gerais. \n\nA primeira delas \u00e9 a chamada forma posicional e pode ser colocada na seguinte forma : \n\n \n\n[ ] [ ]\n[ ] [ ]\n\n1 kk k\n\nk k\n\nx A x B u\n\ny C x\n+\n\n= +\n\n=\n\n% % %\n%%\n\n \n \n\n(2.1) \n\nonde \n\n[ ]\nk\n\nx  \u00e9 o vetor de estados no instante de amostragem k \n\nnu\nku ?% R  \u00e9 o vetor de entradas manipuladas, que implicitamente corresponde \u00e0  \n\n               diferen\u00e7a entre o valor real da entrada e o valor correspondente ao  \n\n               estado estacion\u00e1rio : k k SSu u u= ?%  \nny\n\nky ?% R  \u00e9 o vetor de sa\u00eddas controladas.  \n               Analogamente, entende-se que k k SSy y y= ?%  \n\n            A% , B% e C%  s\u00e3o matrizes de dimens\u00f5es adequadas\n\n\n\nCap\u00edtulo 2 \u2013 Modelo em vari\u00e1veis de estado para sistemas integradores 7 \n\n            A segunda forma \u00e9 a incremental, assim chamada porque a entrada manipulada \u00e9 \n\ndefinida como a diferen\u00e7a entre instantes consecutivos. A representa\u00e7\u00e3o geral desse \n\nmodelo \u00e9 dada por   \n\n \n\n[ ] [ ]\n[ ] [ ]\n\n1 kk k\n\nk k\n\nx A x B u\n\ny C x\n\n?\n+\n\n= +\n\n=\n\n \n \n\n(2.2) \n\nonde \n\n-1-k k ku u u? =    , sendo k  o instante de amostragem. \n\n \n\nAs dimens\u00f5es das matrizes A , B  e C  ser\u00e3o diferentes das suas correspondentes \n\nA% , B%  e C%  do modelo posicional.  \n \n\nSer\u00e1 usada nesta disserta\u00e7\u00e3o, apenas a representa\u00e7\u00e3o de sistemas em vari\u00e1veis de \n\nestado na forma incremental. Essa abordagem traz vantagens em rela\u00e7\u00e3o \u00e0 forma \n\nposicional, pois, n\u00e3o h\u00e1 necessidade do conhecimento pr\u00e9vio do estado estacion\u00e1rio do \n\nprocesso e permite portanto, a considera\u00e7\u00e3o de perturba\u00e7\u00f5es n\u00e3o medidas no sistema.  \n\n \nApresentaremos a seguir, a descri\u00e7\u00e3o do modelo aqui utilizado at\u00e9 chegarmos \u00e0 \n\nsua formula\u00e7\u00e3o mais geral poss\u00edvel, que ser\u00e1 usada no cap\u00edtulo 3, na proposi\u00e7\u00e3o de um \n\ncontrolador preditivo de horizonte infinito para sistemas est\u00e1veis integradores sem \n\ntempo morto. No cap\u00edtulo 4, esse mesmo modelo ser\u00e1 estendido para sistemas est\u00e1veis e \n\nintegradores com tempo morto. \n\n \n \n2.3 Modelo em vari\u00e1veis de estado para sistemas integradores sem tempo morto    \n \n\nPara entender o desenvolvimento desse modelo, faremos a sua dedu\u00e7\u00e3o passo a \n\npasso inicialmente com um sistema SISO, para o qual se tenha a seguinte fun\u00e7\u00e3o de \n\ntransfer\u00eancia no dom\u00ednio de Laplace (\u00e9 assumido que o processo n\u00e3o tenha ra\u00edzes \n\nrepetidas) : \n\n \n\n( )\n( ) ( 1)\n\ny s K\nu s s s\n\n=\n? +  \n\n \n\n(2.3) \n\n \n\n\n\nCap\u00edtulo 2 \u2013 Modelo em vari\u00e1veis de estado para sistemas integradores 8 \n\nA resposta ao degrau unit\u00e1rio correspondente \u00e9 dada por \n\n( )\nt\n\nS t K K e K t\n?\n\n?= ? ? + ? +  \n \n\nEssa fun\u00e7\u00e3o pode ser colocada na seguinte forma gen\u00e9rica : \n\n \n\n0( )\nt\n\nd iS t d d e d t\n?\n\n?= + +  \n \n\n(2.4) \n\nonde \n\n        0d , dd  e id  s\u00e3o constantes.  \n\n \n\nDiscretizaremos o sistema representado em (2.3) considerando um intervalo de \n\namostragem t? e seguindo o seguinte procedimento : \n\n \n\n1) Admitamos que no instante de amostragem k, a sa\u00edda do sistema possa ser \n\nrepresentada por uma fun\u00e7\u00e3o similar \u00e0 da resposta ao degrau dada pela Eq.(2.4), na \n\nseguinte forma \n\n \n\n[ ( )] [ ] [ ] [ ]\nt\n\ns d i\nk k k ky t x x e x t\n\n?\n?= + +  \n\n \n\n(2.5) \n\nonde \n\n       [ ]s kx , [ ]\nd\n\nkx , e [ ]\ni\n\nkx  s\u00e3o par\u00e2metros da trajet\u00f3ria da sa\u00edda do sistema \n\n \n\n2) Em seguida consideremos o efeito da a\u00e7\u00e3o de controle ku?  \n\n[ '( )] [ ( )] ( )k k ky t y t S t u= + ?  \n \n\n3) Fazemos ent\u00e3o a transla\u00e7\u00e3o ao instante de amostragem seguinte k+1 e recalculamos \n\na trajet\u00f3ria da sa\u00edda usando esse instante como nova origem de tempo \n\n \n\n1[ ( )] [ '( )] [ ( )] ( )k k k ky t y t t y t t S t t u+ = + ? = + ? + + ? ?  \n(2.6) \n\n \n\nSubstituindo a  Eq.(2.4) e Eq.(2.5) na Eq.(2.6) obt\u00e9m-se  \n\n\n\nCap\u00edtulo 2 \u2013 Modelo em vari\u00e1veis de estado para sistemas integradores 9 \n\n( ) / 0 ( ) /\n1[ ( )] [ ] [ ] [ ] ( ) ( ( ))\n\ns d t t i d t t i\nk k k k ky t x x e x t t d d e d t t u\n\n? +? ? ? +? ?\n+ = + + + ? + + + + ? ?  \n\n                                                                                                                                   (2.7) \n\n \n\n4) Reescrevemos a Eq.(2.7) na seguinte forma adequada \n\n1 1 1 1[ ( )] [ ] [ ] [ ]\nt\n\ns d i\nk k k ky t x x e x t\n\n?\n?\n\n+ + + += + +  \nonde \n\n0\n1[ ] [ ] [ ] ( )\n\ns s i i\nk k k kx x t x d td u+ = + ? + + ? ?  \n\n(2.8) \n\n \n\n1[ ] [ ]\nt t\n\nd d d\nk k kx e x d e u\n\n? ?\n? ?\n\n? ?\n+ = + ?  \n\n \n\n(2.9) \n\n \n\n1[ ] [ ]\ni i i\n\nk k kx x d u+ = + ?  \n(2.10) \n\n \n\nPela Eq.(2.5), a sa\u00edda do sistema no instante de amostragem k  \u00e9 dada por  \n\n \n\n[ ] [ (0)] [ ] [ ]s dk k k ky y x x= = +  \n(2.11) \n\n \n\nAs equa\u00e7\u00f5es (2.8), (2.9), (2.10) e (2.11) podem ser agrupadas de maneira \n\nconveniente e assim sendo, representadas na forma de vari\u00e1veis de estado \n\n \n\n1[ ] [ ]k k kx A x B u+ = + ?  \n(2.12) \n\n \n\n[ ] [ ]k ky C x=  \n(2.13) \n\n \n\nonde \n\n \n\n[ ]\ns\n\nd\nk\n\ni\nk\n\nx\nx x\n\nx\n\n? ?\n? ?\n\n= ? ?\n? ?\n? ?      \n\n1 0\n\n0 0\n0 0 1\n\nt\n\nt\n\nA e\n?? ?\n\n?? ?\n? ?\n? ?=\n? ?\n? ?? ?       \n\n0 i\n\nt\nd\n\ni\n\nd d t\n\nB d e\nd\n\n?? ?\n\n? ?+ ?\n? ?\n? ?=\n? ?\n? ?\n? ?       [ ]1 1 0C =  \n\n\n\nCap\u00edtulo 2 \u2013 Modelo em vari\u00e1veis de estado para sistemas integradores 10 \n\nEssa formula\u00e7\u00e3o apresenta um aspecto importante que \u00e9 a capacidade da \n\npredi\u00e7\u00e3o de toda a trajet\u00f3ria das sa\u00eddas a partir do instante de amostragem k \n\n \n\n[ ( )] ( )[ ]k ky t C t x=  \nonde  \n\n          ( ) [1 ]\nt\n\nC t e t\n? ?=  \n\n \n\nNessa representa\u00e7\u00e3o, o estado sx  corresponde aos p\u00f3los integradores \n\nrelacionados \u00e0 forma incremental do modelo. O estado dx corresponde aos p\u00f3los \n\nest\u00e1veis do sistema. O estado ix  corresponde aos p\u00f3los integradores do pr\u00f3prio sistema. \n\nEsses p\u00f3los aparecem nos elementos da diagonal da matriz A . \n\n \n\nPara um sistema multivari\u00e1vel com nu entradas e ny sa\u00eddas, um procedimento \n\nan\u00e1logo ao caso do sistema SISO pode ser aplicado para a constru\u00e7\u00e3o do modelo em \n\nvari\u00e1veis de estado. Consideremos que para cada sa\u00edda iy  e entrada ju  exista uma \n\nfun\u00e7\u00e3o de transfer\u00eancia dada por  \n\n \n2\n\n, ,0 , ,1 , ,2 , ,\n, 2\n\n, ,1 , ,2 , ,\n\n( )\n(1 )\n\nnb\ni j i j i j i j nb\n\ni j na\ni j i j i j na\n\nb b s b s b s\nG s\n\na s a s a s s\n\n+ + + +\n=\n\n+ + + +\nL\n\nL\n \n\n \n\n(2.14) \n\nonde  { }, | 1na nb nb na? &lt;+\u00a5   \n \n\nAdmitindo que os p\u00f3los do sistema n\u00e3o sejam repetidos, a resposta ao degrau \n\npode ser escrita na seguinte forma \n\n \n\n0\n, , , ,\n\n1\n( ) [ ] l\n\nna r td i\ni j i j l i j\n\nl\nS t d d e d t\n\n=\n= + +?  \n\n \n\n(2.15) \n\nonde  \n\n        lr , l =1, 2, ..... , na s\u00e3o os p\u00f3los n\u00e3o-integradores do sistema  \n\n        0 , ,...,d di nad d d , \nid  s\u00e3o os coeficientes obtidos pela expans\u00e3o em fra\u00e7\u00f5es      \n\n                                      parciais da fun\u00e7\u00e3o de transfer\u00eancia ,i jG . \n\n \n\n\n\nCap\u00edtulo 2 \u2013 Modelo em vari\u00e1veis de estado para sistemas integradores 11 \n\nCombinando os efeitos de todas as entradas, no instante de amostragem k a \n\npredi\u00e7\u00e3o da trajet\u00f3ria da sa\u00edda iy  pode ser formulada na seguinte forma cont\u00ednua \n\n \n\n[ ] , ,, ,\n1 1\n\n( ) [ ] [ ] [ ]         1, ,i j l\nnu na r ts d i\n\ni i k i j l k i kk\nj l\n\ny t x x e x t i ny\n= =\n\n= + + =? ? \u2026  \n(2.16) \n\n \n\nPara esse sistema, os estados sx , dx  e ix s\u00e3o definidos por  \n\n \n\n0\n1\n\n1 1\n[ ] [ ] [ ] [ ] [ ] ,       1, ,\n\nnu nu\ns s i i\ni k i k i k ij j k ij j k\n\nj j\nx x t x d u t d u i ny+\n\n= =\n= + ? + ? + ? ? =? ? \u2026\n\n \n\n(2.17) \n\n \n\n, , , ,\n1[ ] [ ] [ ] i = 1, ... , ;   j = 1, ... , ;    l = 1, ... ,\n\ni j l i j lr t r td d d\nijl k ijl k ijl j kx e x d e u ny nu na\n\n? ?\n+ = + ?\n\n \n\n(2.18) \n\n \n\n1\n1\n\n[ ] [ ] [ ] ,       1, ,i i ij\nnu\n\ni i i\nk k j k\n\nj\nx x d u i ny+\n\n=\n= + ? =? \u2026\n\n \n\n(2.19) \n\n \n\nReescrevendo as equa\u00e7\u00f5es acima em nota\u00e7\u00e3o matricial, temos  \n\n \n0\n\n1[ ] [ ] [ ] ( )\ns s i i\n\nk k k kx x t x D tD u+ = + ? + + ? ?  \n(2.20) \n\n \n\n1[ ] [ ]\nd d d\n\nk k kx F x D FN u+ = + ?  \n(2.21) \n\n \n\n1[ ] [ ]\ni i i\n\nk k kx x D u+ = + ?  \n(2.22) \n\n \n\nonde \n\n \n\n1 2[ ] [ ]\ns s s s T\n\nnyx x x x= L ,     1 2[ ] [ ]\ni i i i T\n\nnyx x x x= L  \n \n\n1,1,1 1,1, 1, ,1 1, , ,1,1 ,1, , ,1 , ,[ ] [ ]\nd d d d d d d d d T\n\nna nu nu na ny ny na ny nu ny nu nax x x x x x x x x= L L L L L L L\n \n\n\n\nCap\u00edtulo 2 \u2013 Modelo em vari\u00e1veis de estado para sistemas integradores 12 \n\n0 0\n1,1 1,\n\n0\n\n0 0\n,1 ,\n\nnu\nny nu\n\nny ny nu\n\nd d\nD\n\nd d\n\n\u00d7\n\n? ?\n? ?= ?? ?\n? ?? ?\n\nL\nM O M \u00a1\n\nL\n; \n\n1,1 1,\n\n,1 ,\n\ni i\nnu\n\ni ny nu\n\ni i\nny ny nu\n\nd d\nD\n\nd d\n\n\u00d7\n\n? ?\n? ?= ?? ?\n? ?? ?\n\nL\nM O M \u00a1\n\nL\n \n\n \n\n( ),1,1 ,1, , ,1 , ,1,1,1 1,1, 1, ,1 1, ,diag ny ny na ny nu ny nu nana nu nu na r t r t r t r tr t r t r t r t nd ndF e e e e e e e e \u00d7? ? ? ?? ? ? ?= ?L L L L L L L \u00a3\n \n\n( )1,1,1 1,1, 1, ,1 1, , ,1,1 ,1, , ,1 , ,diagd d d d d d d d d nd ndna nu nu na ny ny na ny nu ny nu naD d d d d d d d d \u00d7= ?L L L L L L L \u00a3\n \n\n1\n\n2 nd nu\n\nny\n\nJ\nJ\n\nN\n\nJ\n\n\u00d7\n\n? ?\n? ?\n\n= ?? ?\n? ?\n? ?? ?\n\n\u00a1M            \n.\n\n1 0 0 0\n1 0 0 0\n\n1 0 0 0\n0 1 0 0\n0 1 0 0\n\n0 1 0 0\n\n0 0 0 1\n0 0 0 1\n\n0 0 0 1\n\nnu na nu\niJ\n\n\u00d7\n\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?= ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?? ?\n\nL\nL\n\nM M M L M\nL\nL\nL\n\n\u00a1M M M L M\nL\n\nM\nL\nL\n\nM M M L M\nL\n\n                                     (2.23) \n\nonde  \n\n. .nd ny nu na=  \n\n \n\nA eq.(2.16) pode ser utilizada para obter-se a express\u00e3o da sa\u00edda do sistema no \n\ninstante de amostragem k , ou seja, \n\n \n\n, ,\n1 1\n\n[ ] [ (0)] [ ] [ ]         1, ,\nnu na\n\ns d\ni k i k i k i j l k\n\nj l\ny y x x i ny\n\n= =\n= = + =? ? \u2026\n\n \n\n \n\n(2.24) \n\n \n\nAs equa\u00e7\u00f5es (2.20),(2.21),(2.22) e (2.24) escritas na forma de vari\u00e1veis de \n\nestado ficam na seguinte forma  \n\n1[ ] [ ]k k kx A x B u+ = + ?  \n(2.25) \n\n \n\n[ ] [ ]k ky C x=  \n(2.26) \n\n \n\n\n\nCap\u00edtulo 2 \u2013 Modelo em vari\u00e1veis de estado para sistemas integradores 13 \n\nonde \n\n1\n\n[ ]k\nny k\n\ny\ny\n\ny\n\n? ?\n? ?=\n? ?\n? ?? ?\n\nM\n         \n\n[ ]\n\ns\n\nnxd\nk\n\ni\n\nx\nx x\n\nx\n\n? ?\n? ?= ?\n? ?\n? ?? ?\n\n\u00a3\n        \n\n0\n0 0\n0 0\n\nny ny\nnx nx\n\nny\n\nI t I\nA F\n\nI\n\n\u00d7\n\n?? ?\n? ?= ?\n? ?\n? ?? ?\n\n\u00a3\n                   \n\n \n\n           \n\n0 i\n\nnx nud\n\ni\n\nD tD\nB D F N\n\nD\n\n\u00d7\n\n? ?+ ?\n? ?= ?\n? ?\n? ?? ?\n\nC                                                                         (2.27) \n\n \n\n. .\n\n1 0 0 1 1 1 0 0 0 0 0 0\n0 1 0 0 0 0 0 0 0 0 0 0\n\n0 0 1 0 0 0 1 1 1 0 0 0\n\nny nynu na nu na\n\nC\n\n? ?\n? ?\n? ?\n? ?=\n? ?\n? ?\n? ?\n? ?\n\n64748 64748 64748 64748\nL L L L\nL L L LLM M L M M M L M M M L M M M L M\nL L L L\n\n \n       com 2nx ny nd= +   \n\n \n\nA trajet\u00f3ria das sa\u00eddas dada pela Eq. (2.16) escrita na forma matricial ser\u00e1 dada \n\npor \n\n \n\n[ ] [ ]( ) ( )k ky t C t x=  \n(2.28) \n\n \n\nonde \n\n \n\n*( ) [ ( ) ( )] ny nxC t I t I t \u00d7= ? ? \u00a3  \n(2.29) \n\n \n\n1\n\n2\n\n( ) 0 0\n0 ( ) 0\n\n( )\n\n0 0 ( )\n\nny nd\n\nny\n\nt\nt\n\nt\n\nt\n\n\u00d7\n\n?? ?\n? ??? ?? = ?\n? ?\n? ?\n\n?? ?? ?\n\nL\nL\n\n\u00a3M M O M\nL\n\n \n\n \n\n(2.30) \n\n \n\n,1,1 ,1, , ,1 , ,( ) [ ] i = 1, 2,..., i i na i nu i nu na\nr t r t r t r t nd\n\ni t e e e e ny? = ?L L L \u00a3\n \n\n(2.31) \n\n \n\n\n\nCap\u00edtulo 2 \u2013 Modelo em vari\u00e1veis de estado para sistemas integradores 14 \n\n*\n1\n\n*\n* 2\n\n*\n\n( ) 0 0\n\n0 ( ) 0\n( )\n\n0 0 ( )\n\nny ny\n\nny\n\nf t\n\nf t\nI t\n\nf t\n\n\u00d7\n\n? ?\n? ?\n? ?\n\n= ?? ?\n? ?\n? ?\n? ?? ?\n\nL\nL \u00a1\n\nM M O M\nL\n\n \n\n \n\n(2.32) \n\nonde * ( )if t t=  se existir p\u00f3lo integrador associado \u00e0 sa\u00edda i ,  \n\n         caso contr\u00e1rio,  * ( ) 0if t = . \n\n \n\nA resposta ao degrau para o sistema multivari\u00e1vel fica representada por \n\n \n0 *( ) ( ) ( )d iS t D t D N I t D= + ? +  (2.33) \n\n \n\n \n\n \n\n2.4 Exemplo     \n \n\nPara ilustrar o desenvolvimento apresentado na se\u00e7\u00e3o anterior, tomemos para \n\nexemplo um sistema multivari\u00e1vel 2x2 (duas vari\u00e1veis controladas com duas vari\u00e1veis \n\nmanipuladas) e o representemos em vari\u00e1veis de estado na forma incremental. Esse \n\nsistema foi estudado por Rodrigues e Odloak (2003) sendo parte de um processo \n\nqu\u00edmico de um reator catal\u00edtico de oxida\u00e7\u00e3o de etileno. \n\n \n\nA matriz de fun\u00e7\u00f5es de transfer\u00eancia \u00e9 dada abaixo : \n\n  \n\n1,1 1,2\n\n2,1 2,2\n\n0,19 1, 7\n( ) ( ) 19, 5 1\n\n( ) ( ) / ( )\n( ) ( ) 0, 763 0, 235\n\n31, 8 1\n\nG s G s s s\nG s y s u s\n\nG s G s\ns s\n\n? ?? ?\n? ?? ? +\n? ?= = =? ? ?? ?? ?\n? ?+? ?\n\n \n\n \n\nConsiderando por exemplo, um intervalo entre amostragens de 1 mint? =  e \n\nusando a Eq.(2.2) obtemos a seguinte caracteriza\u00e7\u00e3o em vari\u00e1veis de estado na forma \n\nincremental : \n\n \n\n\n\nCap\u00edtulo 2 \u2013 Modelo em vari\u00e1veis de estado para sistemas integradores 15 \n\n \n\n[ ] [ ]\n[ ] [ ]\n\n1 kk k\n\nk k\n\nx A x B u\n\ny C x\n\n?\n+\n\n= +\n\n=\n\n \n \n\n(2.2) \n\n \n\n1 1\n\n2 2\n\n1 1\n\n2 2\n\n1 1\n\n2 2\n\n( 1) ( )1 0 0 0 1 0 0,1\n( 1) ( )0 1 0 0 0 1\n( 1) ( )0 0 0, 9500 0 0 0\n\n0 0 0 0,9690 0 0( 1) ( )\n0 0 0 0 1 0( 1) ( )\n0 0 0 0 0 1\n\n( 1) ( )\n\ns s\n\ns s\n\nd d\n\nd d\n\ni i\n\ni i\n\nx k x k\n\nx k x k\n\nx k x k\n\nx k x k\n\nx k x k\n\nx k x k\n\n? ? ? ?+ ?? ?? ? ? ?\n? ?? ? ? ?+\n? ?? ? ? ?\n? ?+? ? ? ?\n\n= +? ?? ? ? ?\n+ ? ?? ? ? ?\n\n? ?? ? ? ?+ ? ?? ? ? ?\n? ?? ?? ? ? ?+? ? ? ?\n\n900 1, 7000\n-0,7630 0,2350\n\n0 1,6150\n0,7394 0\n-0,1900 0\n\n0 0,2350\n\nku\n\n?? ?\n? ?\n? ?\n? ?\n\n?? ?\n? ?\n? ?\n? ?\n? ?? ?\n\n \n\n \n\n1\n\n2\n\n1 1\n\n2 2\n\n1\n\n2\n\n( )\n\n( )\n\n( ) ( )1 0 1 0 0 0\n( ) 0 1 0 1 0 0 ( )\n\n( )\n\n( )\n\ns\n\ns\n\nd\n\nd\n\ni\n\ni\n\nx k\n\nx k\n\ny k x k\ny k x k\n\nx k\n\nx k\n\n? ?\n? ?\n? ?\n? ?\n\n? ? ? ? ? ?\n=? ? ? ? ? ?\n\n? ?? ? ? ?\n? ?\n? ?\n? ?\n? ?  \n\n \n\nonde \n\n \n\n1\n-1\n\n2\n\n( )\n-\n\n( )k k k\nu k\n\nu u u\nu k\n\n?? ?\n? = = ? ??? ?\n\n \n\n \n\n[ ] 1\n2\n\n( )\n( )k\n\ny k\ny\n\ny k\n? ?\n\n= ? ?\n? ?\n\n \n\n \n\n[ ]\n\n1\n\n2\n\n1\n\n2\n\n1\n\n2\n\n( )\n( )\n\n( )\n( )\n\n( )\n( )\n\n( )\n( )\n( )\n\ns\n\ns\ns\n\nd\nd\n\ndk\ni\n\ni\n\ni\n\nx k\nx k\n\nx k\nx k\n\nx x k\nx k\n\nx k\nx k\nx k\n\n? ?\n? ?\n? ?? ?\n? ?? ?\n\n= = ? ?? ?\n? ?? ?\n\n? ? ? ?\n? ?\n? ?? ?\n\n \n\n\n\n 16 \n\nCap\u00edtulo 3 \n\nControlador IHMPC para sistemas integradores sem tempo morto  \n\n \n\n3.1 Introdu\u00e7\u00e3o \n \n\nO objetivo de um MPC qualquer \u00e9 determinar uma sequ\u00eancia de a\u00e7\u00f5es de \n\ncontrole futuras para que a predi\u00e7\u00e3o das sa\u00eddas da planta (vari\u00e1veis controladas), dentro \n\nde um horizonte de predi\u00e7\u00e3o (finito ou infinito), estejam o mais pr\u00f3ximo poss\u00edvel de \n\nseus valores de refer\u00eancia (\u2018setpoints\u2019) de acordo com alguma fun\u00e7\u00e3o custo pr\u00e9-\n\nestabelecida que leve em conta os desvios em rela\u00e7\u00e3o aos mesmos com o menor esfor\u00e7o \n\nposs\u00edvel nas a\u00e7\u00f5es das vari\u00e1veis manipuladas.  \n\n \n\nDo ponto de vista da aplica\u00e7\u00e3o industrial, da sequ\u00eancia de a\u00e7\u00f5es de controle \n\ndeterminadas, somente \u00e9 implementada a primeira a\u00e7\u00e3o de controle. No per\u00edodo de \n\namostragem seguinte, todo o procedimento \u00e9 repetido usando a \u00faltima medida da planta. \n\nEsta estrat\u00e9gia, conhecida como horizonte m\u00f3vel, permite compensar os erros de \n\nmodelagem ou perturba\u00e7\u00f5es futuras do sistema com as leituras da planta. \n\n \n\n \n \n3.2 Controlador de horizonte infinito para sistemas integradores sem tempo morto \n \n\n3.2.1 Lei de controle \n \n\nLevando em considera\u00e7\u00e3o o peso nas vari\u00e1veis controladas e as a\u00e7\u00f5es nas \n\nmanipuladas, prop\u00f5e-se a fun\u00e7\u00e3o custo do MPC de horizonte de predi\u00e7\u00e3o infinito para \n\nsistemas discretos dada por :  \n\n \n\n1\n\n1,\n0 0\n\n( ) ( ) ( ) ( )\nm\n\nT T\nk\n\nj j\n\nV e k j Q e k j u k j R u k j\n? ?\n\n= =\n\n= + + + ? + ? +? ?\n \n\n \n\n(3.1) \n\nonde \n\n         ny nyQ \u00d7? \u00a1  \u00e9 uma matriz definida positiva  \n         nu nuR \u00d7? \u00a1  \u00e9 uma matriz semi-definida positiva  \n\n\n\nCap\u00edtulo 3 \u2013 Controlador IHMPC para sistemas integradores sem tempo morto 17 \n\n        ( ) ( ) spe k j y k j y+ = + ?   \u00e9 o erro de predi\u00e7\u00e3o das vari\u00e1veis controladas no  \n\n                                                instante de amostragem \u2018k+j\u2019 incluindo o efeito  \n\n                                                das futuras a\u00e7\u00f5es de controle. \n\n        spy \u00e9 a trajet\u00f3ria de refer\u00eancia das vari\u00e1veis controladas. \n\n        m  \u00e9 o horizonte das a\u00e7\u00f5es de controle.  \n\n \n\nPara que as predi\u00e7\u00f5es das sa\u00eddas sejam limitadas no infinito e por consequ\u00eancia \n\no pr\u00f3prio valor da fun\u00e7\u00e3o custo 1,kV  dada pela Eq.(3.1), impomos a anula\u00e7\u00e3o do efeito \n\ndos estados s\nk m\n\nx\n+\n\n? ?? ?  e \ni\n\nk m\nx\n\n+\n? ?? ? no instante k m+ . Essa mesma proposi\u00e7\u00e3o foi usada por \n\nRawlings e Muske (1993). \n\n \n\nRelacionando o estado s\nk m\n\nx\n+\n\n? ?? ? em fun\u00e7\u00e3o de \ns\n\nk\nx? ?? ? e o estado \n\ni\n\nk m\nx\n\n+\n? ?? ? em fun\u00e7\u00e3o \n\nde i\nk\n\nx? ?? ?  temos as seguintes restri\u00e7\u00f5es de igualdade  \n\n \n0\n\n2,( ) ( ) 0\ns i\n\nm me k D D u+ ? ? =  (3.2) \n\n \n\n1,( ) 0\ni i\n\nmx k D u+ ? =  (3.3) \n\n \n\nonde \n\n \n\n( ) ( )s s spe k x k y= ?  \n\n0 0 0 0[ ]\n\nm\n\nmD D D D=\n644474448\n\nL .ny m nu\u00d7? \u00a1  \n\n1, [ ]\n\nm\n\ni i i i\nmD D D D=\n\n6447448\nL  .ny m nu\u00d7? \u00a1  \n\n2, 0 ( 1)\ni i i\n\nmD t D m t D? ?= ? ? ?? ?L  \n.ny m nu\u00d7? \u00a1  \n\n \n\n.\n\n( )\n\n( 1)\n\nm nu\n\nu k\nu\n\nu k m\n\n?? ?\n? ?? = ?? ?\n? ?? + ?? ?\n\nM \u00a1  \n\n\n\nCap\u00edtulo 3 \u2013 Controlador IHMPC para sistemas integradores sem tempo morto 18 \n\nConsiderando as condi\u00e7\u00f5es definidas pelas equa\u00e7\u00f5es (3.2) e (3.3) na Eq.(3.1), a \n\nfun\u00e7\u00e3o custo torna-se \n\n \n1 1\n\n1,\n1 0\n\n( ) ( ) ( ) ( ) ( ) ( )\nm m\n\nT d T d T\nk\n\nj j\nV e k j Q e k j x k m Q x k m u k j R u k j\n\n? ?\n\n= =\n= + + + + + + ? + ? +? ?\n\n \n\nonde \n__\n\nQ  \u00e9 obtida pela solu\u00e7\u00e3o da seguinte equa\u00e7\u00e3o discreta de Lyapunov  \n\n \n\nT T TQ F QF F Q F? = ? ?  \n \n\n \n\nPela Eq.(2.12) e Eq.(2.13) obtemos de forma recursiva as predi\u00e7\u00f5es entre o \n\ninstante k e o instante k+m  \n\n \n\n( ) ky Lx k G u= + ?  \n \n\nonde \n\n \n\n( 1) ( 2) ( )\nTT T Ty y k y k y k m? ?= + + +? ?L             (1) (2) ( )\n\nTT T TL L L L m? ?= ? ?L     \n( ) jny nyL j I F j t I? ?= ? ?? ?  \n\n1,1\n\n2,1 2,2 0\n,\n\n,1 ,2 ,\n\n0 0\n0\n\n; ( )i j l d ij l\n\nm m m m\n\nG\nG G\n\nG G D t D F D FN j l t D\n\nG G G\n\n?\n\n? ?\n? ?\n? ?= = + ? + ? + ? ?\n? ?\n? ?\n? ?? ?\n\nL\nO\n\nM M O M\nL\n\n   \n\n  \n\n \n\nO estado dx  no instante k+m obtido em fun\u00e7\u00e3o do instante k \u00e9 dado por \n\n \n\n( ) ( )d x ux k m F x k F u+ = + ?  \n\nonde \n\n0 0mx nd ny nd nyF F\u00d7 \u00d7? ?= ? ?         \n1d m d m d\n\nuF D F N D F N D FN\n?? ?= ? ?L  \n\n\n\nCap\u00edtulo 3 \u2013 Controlador IHMPC para sistemas integradores sem tempo morto 19 \n\nA fun\u00e7\u00e3o custo \u00e9 ent\u00e3o escrita sob a seguinte forma : \n\n \n\n1, 1 ,12\nT T\n\nk fV u H u C u c= ? ? + ? +   (3.4) \n\nonde \n\n1\nT T\n\nu uH G QG F QF R= + +% %  \n\n,1 ( ( )) ( )\nTTsp T T\n\nf x uC I y L x k QG x k F QF? ?= ? + +? ?\n%  \n\nny\n\nny\n\nI\nI\n\nI\n\n? ?\n? ?\n\n= ? ?\n? ?\n? ?\n\nM\n\n  \n( . )m ny nyI \u00d7? \u00a1  \n\n[ ( )] [ ( )] ( ) ( )sp T sp T Tx xc I y L x k Q I y L x k x k F QF x k= ? ? +%  \n\n[ ]\nm\n\nQ diag Q Q=\n64748\n\n% L  \n\n[ ]\nm\n\nR diag R R=\n64748\n\n% L  \n \n\nAssim, o MPC de horizonte infinito para sistema integradores sem tempo morto \n\npode ser resolvido atrav\u00e9s de um problema de otimiza\u00e7\u00e3o, formulado a seguir. \n\n \n \n \nProblema P3.1 \n\n \n\n             A Fun\u00e7\u00e3o Custo do Problema P3.1 a ser minimizada \u00e9 a Eq. (3.4) sem a parcela \nescalar c  dessa equa\u00e7\u00e3o que \u00e9 uma constante e n\u00e3o afeta a solu\u00e7\u00e3o do problema : \n\n \n\n1 ,1min 2\nT T\n\nf\nu\n\nu H u c u\n?\n\n? ?? ? + ?? ?  \n\ns. a.  \n0\n\n2,( ) ( ) 0\ns i\n\nm me k D D u+ ? ? =  (3.2) \n\n \n\n1,( ) 0\ni i\n\nmx k D u+ ? =  (3.3) \n\n \n\n( ) ,   0u k j j? + ? ?U  (3.5) \n\n\n\nCap\u00edtulo 3 \u2013 Controlador IHMPC para sistemas integradores sem tempo morto 20 \n\n \n\nonde \n\nmax max\n\nmin max\n\n0\n\n( )\n( ) ( ) 0;\n\n( 1) ( ) ; 0,1, , 1\nj\n\ni\n\nu u k j u\nu k j u k j j m\n\nu u k u k i u j m\n=\n\n? ?\n? ??? ? ? + ? ?? ?? ?\n\n= ? + ? + = ?? ?\n? ?\n\n? ? + ? + ? = ?? ?\n? ?? ?\n\n? L\nU:\n\n \n \n\n Apresentaremos a seguir o teorema e a sua demonstra\u00e7\u00e3o, no qual \u00e9 garantida a  \nconverg\u00eancia do sistema em malha fechada do Problema P3.1 enquanto o mesmo for \nvi\u00e1vel : \n \n\nTeorema 1 : Se o Problema P3.1 for vi\u00e1vel no instante k , a aplica\u00e7\u00e3o da solu\u00e7\u00e3o \u00f3tima  \n                     para esse problema  em um  processo sem perturba\u00e7\u00f5es  em malha fechada, \n                     levar\u00e1 as sa\u00eddas do sistema aos seus valores de refer\u00eancia (\u2018setpoints\u2019). \n \nProva  :  \n Para essa demonstra\u00e7\u00e3o, seguiremos o caminho usual para a prova da \nestabilidade de controladores de horizonte infinito, isto \u00e9, vamos provar que a fun\u00e7\u00e3o \ncusto 1,kV  definida pela Eq.(3.1) \u00e9 positiva e decrescente, ou seja, \u00e9 uma fun\u00e7\u00e3o de \nLyapunov. \n  \n Notamos inicialmente que a matriz hessiana 1H  \u00e9 positiva definida ( 1 0H > ). \nDesde que a hessiana seja positiva definida, o Problema P3.1 ter\u00e1 uma \u00fanica solu\u00e7\u00e3o \n\u00f3tima que satisfaz \u00e0s restri\u00e7\u00f5es nos estados e nas entradas, desde que o problema seja \nvi\u00e1vel. Para haver solu\u00e7\u00e3o, as restri\u00e7\u00f5es dadas pelas equa\u00e7\u00f5es (3.2) , (3.3) e (3.5) \ntamb\u00e9m tem que ser atendidas. \n \n Assim, se o problema P3.1 for vi\u00e1vel em k, existir\u00e1 uma \u00fanica solu\u00e7\u00e3o \u00f3tima que \nobedecer\u00e1 todas essas restri\u00e7\u00f5es. Seja essa solu\u00e7\u00e3o representada por : \n \n\n* * * *[ ( ) ( 1) ... ( 1) ]T T T Tk ku u u k u k u k m? = ? = ? ? + ? + ?  \n \ne o valor da fun\u00e7\u00e3o custo correspondente \u00e0 solu\u00e7\u00e3o \u00f3tima designado por *1,kV  \n \n\nSup\u00f5e-se agora que a a\u00e7\u00e3o de controle * ( )u k?  seja implementada na planta e \nque seja feita a transla\u00e7\u00e3o para o instante 1k + , onde o problema P3.1 \u00e9 resolvido \nnovamente. \n\n \nSeguindo a proposi\u00e7\u00e3o sugerida por Rawlings e Muske (1993), consideremos a \n\nseguinte sequ\u00eancia de a\u00e7\u00f5es de controle : \n \n\n\n\nCap\u00edtulo 3 \u2013 Controlador IHMPC para sistemas integradores sem tempo morto 21 \n\n* * *\n1 [ ( 1) ... ( 1) 0]\n\nT T T\nku u k u k m+? = ? + ? + ?  que \u00e9 vi\u00e1vel e tem uma fun\u00e7\u00e3o custo \n\nassociada '1, 1kV +  \n \nAgora \u00e9 f\u00e1cil verificar que a essa fun\u00e7\u00e3o custo \u00e9 dada por :  \n \n\n' * * *\n1, 1 1, ( ) ( ) ( ) ( )\n\nT\nk kV V e k Q e k u k R u k+ = ? ? ? ?  \n\n \nSendo as matrizes Q  positiva definida ( 0Q > ) e R  positiva semi-definida \n\n( 0R ? ), teremos assim \n \n\n\u00b4 *\n1, 1 1,k kV V+ &lt;  . Portanto, como \n\n* '\n1, 1 1, 1k kV V+ +?  , ent\u00e3o \n\n* *\n1, 1 1,k kV V+ ?  sendo a fun\u00e7\u00e3o custo \n\ndecrescente. ? \n                                                                                          \n\n \n\nApesar da estabilidade do problema P3.1, na pr\u00e1tica o mesmo torna-se invi\u00e1vel \ncom facilidade, pois, ocorre conflito entre as restri\u00e7\u00f5es de igualdade dadas pelas \nequa\u00e7\u00f5es (3.2) e (3.3) e a Eq.(3.5). Isso acontece por exemplo, quando o controlador \u00e9 \nsubmetido a grandes varia\u00e7\u00f5es nos \u2018setpoints\u2019, ou, quando o sistema sofre perturba\u00e7\u00f5es \nde amplitudes significativas. \n\n \n\n Para aumentar a faixa de viabilidade do controlador, Rodrigues e Odloak (2003) \napresentaram para sistemas est\u00e1veis, uma abordagem que insere uma vari\u00e1vel de folga \nna fun\u00e7\u00e3o custo, a qual relaxa a solu\u00e7\u00e3o da restri\u00e7\u00e3o de igualdade dada pela Eq. (3.2). \n \n\n \n\n \n\n3.2.2 O controlador IHMPC estendido de Rodrigues e Odloak (2003)  \n \n\nA fun\u00e7\u00e3o custo com a vari\u00e1vel de folga proposta \u00e9 a seguinte : \n \n\n1\n\n2, 1\n0 0\n\n[ ( ) ] [ ( ) ] ( ) ( )\nm Ts T s T s s\n\nk k k k k\nj j\n\nV e k j Q e k j u k j R u k j S\n? ?\n\n= =\n\n= + ? ? + ? ? + ? + ? + + ? ?? ?  \n \n\n(3.6) \n\nonde \n\n          sk?\nny? \u00a1  \u00e9 o vetor das vari\u00e1veis de folga que permite maior grau de               \n\nliberdade para a solu\u00e7\u00e3o do problema dentro da regi\u00e3o vi\u00e1vel U . \n          1S \u00e9 uma matriz de pesos, positiva definida.  \n\n \n\nA restri\u00e7\u00e3o dada antes pela Eq.(3.2) passa agora a ser representada por : \n\n \n\n\n\nCap\u00edtulo 3 \u2013 Controlador IHMPC para sistemas integradores sem tempo morto 22 \n\n0\n2 ,( ) ( ) 0\n\ns s i\nk m me k D D u+ ? + ? ? =  (3.7) \n\nUma vez que sk?  n\u00e3o \u00e9 limitada, a restri\u00e7\u00e3o dada pela Eq.(3.7) poder\u00e1 ser \n\natendida por qualquer sequ\u00eancia de a\u00e7\u00f5es de controle a qual tamb\u00e9m  atender\u00e1 a \n\nEq.(3.5) ou qualquer condi\u00e7\u00e3o de opera\u00e7\u00e3o que apare\u00e7a no termo ( )se k . Com essa nova \n\nvari\u00e1vel de folga sk? , a fun\u00e7\u00e3o custo do  problema de controle escrita em nota\u00e7\u00e3o \n\nmatricial ter\u00e1 a seguinte forma : \n\n \n\n2, 2 ,22\nTT s T\n\nk k fs s\nk k\n\nu u\nV u H C c\n\n? ?? ? ? ?? ?= ? ? + +? ? ? ?? ?? ? ? ?? ? ? ?\n \n\n \n\n(3.8) \n\n \n\nonde \n\n2\n1\n\nT T T\nu u\n\nT T\n\nG QG F QF R G QI\nH\n\nI QG I QI S\n\n? ?+ +\n= ? ?\n\n+? ?? ?\n\n% %\n% %  \n\n \n\n(3.9) \n\n \n\n,2 ( ( )) ( ) [ ( )]\nT\n\nTsp T T sp T\nf x uC I y L x k QG x k F QF I y L x k QI? ?? ?= ? + + ? +? ?? ?\n\n% %  \n\n[ ( )] [ ( )] ( ) ( )sp T sp T Tx xc I y L x k Q I y L x k x k F QF x k= ? ? +%  \n\n( ) ( ) ( ) ( )\nTs T d T i Tx k x k x k x k? ?= ? ?  \n\n \n\nAssim, podemos definir o problema representado por : \n\n \n\nProblema P3.2 \n\n \n\n2 ,2\n,\n\nmin 2\ns\nk\n\nTT s T\nk fs su k k\n\nu u\nu H C\n\n? ?\n\n? ?? ? ? ?? ?? ? +? ? ? ?? ?? ? ? ?? ? ? ?\n \n\n(3.10) \n\ns.a. \n\n1,( ) 0\ni i\n\nmx k D u+ ? =  (3.3) \n\n \n\n( ) ,   0u k j j? + ? ?U  (3.5) \n \n\n\n\nCap\u00edtulo 3 \u2013 Controlador IHMPC para sistemas integradores sem tempo morto 23 \n\n0\n2 ,( ) ( ) 0\n\ns s i\nk m me k D D u+ ? + ? ? =  (3.7) \n\n A converg\u00eancia das sa\u00eddas aos seus valores de refer\u00eancia com o sistema em \nmalha fechada com o controlador definido no Problema P3.2 \u00e9 assegurada pelo seguinte \nteorema : \n \nTeorema 2 : Para um sistema sem perturba\u00e7\u00f5es, com p\u00f3los est\u00e1veis e integradores,                                \n                      se o Problema P3.2 for vi\u00e1vel no instante k , ent\u00e3o, ser\u00e1 vi\u00e1vel para os \n                      instantes consecutivos 1k + , 2k + , ..., e al\u00e9m disso, as sa\u00eddas do  \n                      sistema em malha fechada com a lei de controle formulada no problema \n                      P3.2 ir\u00e3o convergir assintoticamente aos valores de refer\u00eancia. \n \nProva  :  \n\nSeguiremos o caminho feito no Teorema 1, ou seja, provaremos a converg\u00eancia \ndo MPC mostrando que a fun\u00e7\u00e3o custo \u00e9 positiva e decrescente no tempo. \n\n \n            Se o Problema P3.2 for vi\u00e1vel no instante k , existe uma solu\u00e7\u00e3o \u00fanica                         \nrepresentada por \n \n\n* * * *[ ( ) ( 1) ... ( 1) ]T T Tk ku u u k u k u k m? = ? = ? ? + ? + ?    e \n*s s\n\nk k? ?=  \n \n             Supondo que a a\u00e7\u00e3o de controle * ( )u k?  seja implementada na planta e                         \nque nos transladamos para o instante \u2018 1k + \u2019, onde o Problema P3.2 \u00e9                         \nresolvido novamente. \u00c9 f\u00e1cil mostrar que no instante \u2018 1k + \u2019, para um sistema sem \nperturba\u00e7\u00f5es, uma solu\u00e7\u00e3o vi\u00e1vel do Problema P3.2 \u00e9 dada por \n \n\n* *\n1 [ ( 1) ... ( 1) 0]\n\nT T T\nku u k u k m+? = ? + ? + ?    e  \n\n*\n1\n\ns s\nk k? ?+ =  \n\n \n              Agora, \u00e9 f\u00e1cil mostrar que a fun\u00e7\u00e3o custo correspondente \u00e9  \n \n\n* ** * *\n2, 1 2, [ ( ) ] [ ( ) ] ( ) ( )\n\ns T s T\nk k k kV V e k Q e k u k R u k? ?+ = ? ? ? ? ? ?  \n\n \n              Assim, a fun\u00e7\u00e3o custo ser\u00e1 estritamente decrescente se um dos termos                         \ncom sinal negativo da equa\u00e7\u00e3o acima for n\u00e3o-nulo. ? \n \n \n Para o caso regulador, o controlador definido no Problema P3.2 ser\u00e1 vi\u00e1vel para \numa regi\u00e3o maior de estados iniciais e/ou perturba\u00e7\u00f5es do que o controlador definido no \nProblema P3.1. Da mesma forma, para o caso de rastreabilidade nos valores de \nrefer\u00eancia, o Problema P3.2 ser\u00e1 vi\u00e1vel para mudan\u00e7as maiores nos valores de \n\u2018setpoints\u2019 do que o controlador definido no Problema P3.1. Entretanto, dependendo do \ntamanho das perturba\u00e7\u00f5es ou das varia\u00e7\u00f5es dos valores de refer\u00eancia, ainda poder\u00e1 \nhaver conflito entre a restri\u00e7\u00e3o de igualdade dada pela Eq. (3.3) e a regi\u00e3o vi\u00e1vel \ndefinida na Eq. (3.5). \n \n\n\n\nCap\u00edtulo 3 \u2013 Controlador IHMPC para sistemas integradores sem tempo morto 24 \n\n Para contornar essa limita\u00e7\u00e3o, usaremos uma extens\u00e3o na fun\u00e7\u00e3o custo, \nadicionando uma segunda vari\u00e1vel de folga para sistemas com p\u00f3los integradores, \nconforme apresentado em Cano e Odloak (2003). \n\n \n\n \n\n3.2.3 Nova extens\u00e3o para o IHMPC \n \n\nSeguindo a mesma sequ\u00eancia da formula\u00e7\u00e3o do problema anterior, a fun\u00e7\u00e3o \n\ncusto com as duas vari\u00e1veis de folga apresentar\u00e1 a seguinte forma : \n\n \n\n3,\n0\n\n1\n\n1 2\n0\n\n( ( ) ) ( ( ) )\n\n( ) ( )\n\ns i T s i\nk k k k k\n\nj\n\nm T TT s s i i\nk k k k\n\nj\n\nV e k j j t Q e k j j t\n\nu k j R u k j S S\n\n?\n\n=\n\n?\n\n=\n\n= + + ? + ? ? + + ? + ? ? +\n\n? + ? + + ? ? + ? ?\n\n?\n\n?\n \n\n \n\n \n\n(3.11) \n\n \n\nonde   2\nny nyS \u00d7? \u00a1  \u00e9 uma matriz positiva definida  \n\n           ik?  \u00e9 o segundo vetor de vari\u00e1veis de folga \n\n \n\nA restri\u00e7\u00e3o dada antes pela Eq.(3.3) passa agora a ser representada por : \n\n \n\n1,( ) 0\ni i i\n\nk mx k D u+ ? + ? =  (3.12) \n\n \n\nNo entanto, a solu\u00e7\u00e3o da fun\u00e7\u00e3o custo pela Eq.(3.11) sujeita \u00e0s restri\u00e7\u00f5es dadas \n\npelas equa\u00e7\u00f5es (3.5) , (3.7) e (3.12) n\u00e3o assegura que o valor da fun\u00e7\u00e3o seja decrescente. \n\nIsso \u00e9 decorrente do fato que no instante \u2018 1k + \u2019, a solu\u00e7\u00e3o mostrada abaixo n\u00e3o \u00e9 vi\u00e1vel \n\nporque n\u00e3o atende a Eq.(3.12) : \n\n \n\n \n* *\n\n1 ( 1) ( 1) 0\nTT T\n\nku u k u k m+ ? ?? = ? + ? + ?? ?L  \n\n \n*\n\n1\ns s\nk k? ?+ =   \n\n \n*\n\n1\ni i\nk k? ?+ =   \n\n \n\n\n\nCap\u00edtulo 3 \u2013 Controlador IHMPC para sistemas integradores sem tempo morto 25 \n\n Assim, uma estrat\u00e9gia diferente \u00e9 necess\u00e1ria para se obter um controlador \nest\u00e1vel que seja baseado na minimiza\u00e7\u00e3o da fun\u00e7\u00e3o custo definida pela Eq. (3.11). Para \nessa finalidade, prop\u00f5e-se uma fun\u00e7\u00e3o custo secund\u00e1ria , positiva, dada por : \n \n\n , 2\nTi i\n\nl k k kV S? ?=   \n \n\nConsideremos ainda que a seguinte restri\u00e7\u00e3o seja inclu\u00edda na solu\u00e7\u00e3o do \n\nproblema do controlador preditivo : \n\n \n\n, , 1l k l kV V ?&lt;%  \n(3.13) \n\n \n\nonde  \n\n , 1 1 2 1\nTi i\n\nl k k kV S? ?? ? ?= % %%  \n            , 1l kV ?%  \u00e9 calculado com 1ik? ?% , o qual \u00e9 obtido por : \n \n\n1 1, 1( 1)\ni i i\nk m kx k D u? ?? = ? ? ? ?% %  (3.14) \n\n \n\n( 1) ( ) ( 1)i i ix k x k D u k? = ? ? ?%  (3.15) \n\n \n\nPara um sistema sem perturba\u00e7\u00f5es, tem-se : \n\n \n\n ( 1) ( 1)\ni ix k x k? = ?%       \n\n1 1\ni i\nk k? ?? ?=%  \n\n \n\n Consequentemente, \u00e0 medida que as entradas do sistema no ponto de equil\u00edbrio \n\nestejam dentro da regi\u00e3o vi\u00e1vel U , a Eq.(3.13) ser\u00e1 atendida para qualquer max 0u? ?  e \n\n,l kV  ser\u00e1 decrescente.  \n\n \n\nEm sistemas com perturba\u00e7\u00f5es, a determina\u00e7\u00e3o do estado no instante 1k ?  \n\nusando a Eq.(3.15) tornar\u00e1 a Eq.(3.13) sempre vi\u00e1vel.  \n\n \n\n\n\nCap\u00edtulo 3 \u2013 Controlador IHMPC para sistemas integradores sem tempo morto 26 \n\nCom isso, colocamos a fun\u00e7\u00e3o custo da Eq.(3.11) na forma matricial e podemos \n\ndefinir o seguinte problema :   \n\n \n\nProblema P3.3 \n \n\n3 ,3\n, ,\n\nmin 2\ns i\nk k\n\nT TT s i s T s\nk k k f k\n\nu\ni i\nk k\n\nu u\n\nu H C\n? ? ?\n\n? ?? ? ? ?\n? ? ? ?? ?? ? ? ? + ?? ? ? ?? ?? ? ? ? ? ?? ?? ? ? ?\n\n \n\ns.a. \n\n \n\n( ) ,   0u k j j? + ? ?U  (3.5) \n \n\n0\n2 ,( ) ( ) 0\n\ns s i\nk m me k D D u+ ? + ? ? =  (3.7) \n\n \n\n1,( ) 0\ni i i\n\nk mx k D u+ ? + ? =  (3.12) \n\n \n\n, , 1l k l kV V ?&lt;%  (3.13) \n\n \n\nonde \n\n \n\n3 1\n\n2\n\nT T T T\nu u\n\nT T T\n\nT T T\n\nG QG F QF R G QI G QT\n\nH I QG I QI S I QT\n\nT QG T QI T QT S\n\n? ?+ +\n? ?\n\n= +? ?\n? ?\n\n+? ?? ?\n\n% % %\n% % %\n% % %\n\n    \n \n\n \n\n2\nny\n\nny\n\nny\n\nt I\nt I\n\nT\n\nm t I\n\n?? ?\n? ??? ?=\n? ?\n? ?\n\n?? ?? ?\n\nM\n \n\n \n\n,3 ( ( )) ( ) [ ( )] [ ( )]\nT\n\nTsp T T sp T sp T\nf x uC I y L x k QG x k F QF I y L x k QI I y L x k QT? ?? ?= ? + + ? + ? +? ?? ?\n\n% % %\n \n\n \n\n\n\nCap\u00edtulo 3 \u2013 Controlador IHMPC para sistemas integradores sem tempo morto 27 \n\nA converg\u00eancia do problema P3.3 \u00e9 assegurada pelo seguinte teorema :  \n\n \n\nTeorema 3:  Para sistemas com p\u00f3los est\u00e1veis e integradores, cujas entradas referentes  \n\n                     ao estado estacion\u00e1rio perten\u00e7am \u00e0 regi\u00e3o vi\u00e1vel U ,  a sequ\u00eancia das a\u00e7\u00f5es  \n                     de controle produzidas pela solu\u00e7\u00e3o sucessiva do problema P3.3 levar\u00e1 as  \n\n                     sa\u00eddas do sistema assintoticamente aos seus valores de refer\u00eancia. \n\n \n\nProva  : \n\n Consideremos os casos regulador e o de rastreabilidade das sa\u00eddas, ambos sem \n\nperturba\u00e7\u00f5es. Nestes casos, se as entradas do sistema correspondentes ao estado \n\nestacion\u00e1rio pertencem \u00e0 regi\u00e3o vi\u00e1vel U , o problema P3.3 ser\u00e1 vi\u00e1vel no instante k  e \npermanecer\u00e1 vi\u00e1vel nos instantes de amostragem seguintes.  \n\n \n\nAssim, a fun\u00e7\u00e3o ,l kV  convergir\u00e1 a zero. Com essa fun\u00e7\u00e3o convergida, a restri\u00e7\u00e3o \n\ndada pela Eq.(3.3) torna-se vi\u00e1vel e se manter\u00e1 nos instantes seguintes. Com isso, o \n\nproblem P3.3 se reduz ao problema P3.2 e a converg\u00eancia das sa\u00eddas do sistema \u00e9 \n\nassegurada pelo teorema 2.? \n\n \n\n \n\nA implementa\u00e7\u00e3o pr\u00e1tica dos controladores definidos pelos problemas P3.2 e \n\nP3.3 \u00e9 feita seguindo os seguintes passos : \n\n \n\n \n\n- no instante k  verifica-se a exist\u00eancia de solu\u00e7\u00e3o vi\u00e1vel definida entre a Eq.     \n\n(3.3) e a Eq.(3.5) \n\n \n\n \n\n- se existir, resolve-se o problema P3.2 e implementa-se a a\u00e7\u00e3o de controle \n\nresultante referente ao instante k . Caso contr\u00e1rio, resolve-se o problema \n\nP3.3 e implementa-se a a\u00e7\u00e3o de controle correspondente. \n\n \n\n\n\nCap\u00edtulo 3 \u2013 Controlador IHMPC para sistemas integradores sem tempo morto 28 \n\n \n\n3.2.4 Controlador IHMPC em duas camadas  \n \n\nDe forma alternativa, em cada instante de amostragem, o mesmo problema pode \n\nser resolvido em duas camadas, resolvendo-se dois problemas de maneira sequencial, \n\nque definiremos como problema P3.4 mostrado a seguir. \n\n \n \nProblema P3.4 \n \n\nProblema P3.4a \n\n,\n4 , 2 , ,\n\n,\nmin\ni\n\na kk\n\nTi i T\na k k k a k a k\n\nu\nV S u R u\n\n?\n? ?\n\n?\n= + ? ?\n\n \ns.a. \n\n( ) ,   0au k j j? + ? ?U  (3.5) \n \n\n1 ,( ) 0\ni i i\n\nk m a kx k D u+ ? + ? =  (3.12) \n\n \n\nonde  \n\n        ,\n( ) ( 1) ( 1)\n\nTT T T\na k a a au u k u k u k m? ?? = ? ? + ? + ?? ?L   \n\n        R  \u00e9 uma matriz positiva definida \n\n \n\n \n\nSeja ent\u00e3o a solu\u00e7\u00e3o \u00f3tima do problema P3.4a designada por :  ( )* *,,ik a ku? ?   \n \n\nA a\u00e7\u00e3o incremental total correspondente \u00e9 dada por :  \n\n \n1\n\n* *\n\n0\n\n( 1) ( 1) ( )\nm\n\na\nj\n\nu k m u k u k j\n?\n\n=\n\n+ ? ? ? = ? +?\n \n\n \n\n(3.14) \n\n \n\nEssa entrada incremental \u00f3tima \u00e9 repassada ao segundo problema mostrado a \n\nseguir, o qual \u00e9 resolvido no mesmo instante de amostragem: \n\n\n\nCap\u00edtulo 3 \u2013 Controlador IHMPC para sistemas integradores sem tempo morto 29 \n\nProblema P3.4b: \n\n,\n\n, ,\n4 , , 2 ,2\n\n,\nmin 2\n\ns\nb k k\n\nT b k b kT s T\nb k b k k fs su k k\n\nu u\nV u H C c\n\n? ?\n\n? ?? ? ? ?? ?= ? ? + +? ? ? ?? ?? ? ? ?? ? ? ?  \ns.a. \n\n( ) ,   0bu k j j? + ? ?U  (3.5) \n \n\n,\n\n0\n2,( ) ( ) 0b\n\ns s i\nk m m ke k D D u+ ? + ? ? =  (3.7) \n\n \n1\n\n*\n\n0\n\n( 1) ( 1) ( )\nm\n\nb\nj\n\nu k m u k u k j\n?\n\n=\n\n+ ? ? ? = ? +?  \n(3.14) \n\nonde  \n\n       ,\n( ) ( 1) ( 1)\n\nTT T T\nb k b b bu u k u k u k m? ?? = ? ? + ? + ?? ?L  \n\n \n\nPara a lei de controle obtida pela solu\u00e7\u00e3o sequencial dos problemas P3.4a e \n\nP3.4b a converg\u00eancia das sa\u00eddas do sistema aos seus valores de refer\u00eancia \u00e9 garantida \n\npelo seguinte teorema : \n\n  \n\nTeorema 4: Para um sistema com p\u00f3los est\u00e1veis e integradores, se no instante de  \n\n                    amostragem k  o problema P3.4a for vi\u00e1vel, ent\u00e3o o problema P3.4b   \n\n                    tamb\u00e9m ser\u00e1 vi\u00e1vel. Acrescentado a isso, a lei de controle resultante da  \n\n                    solu\u00e7\u00e3o sucessiva dos dois problemas levar\u00e1 as sa\u00eddas do sistema aos  \n\n                    respectivos valores de refer\u00eancia. \n\n \n\nProva  :  \n\nConsideremos o sistema sem perturba\u00e7\u00e3o e que no instante k  o problema P3.4a \n\nseja vi\u00e1vel. Designamos o valor \u00f3timo da fun\u00e7\u00e3o custo do problema P3.4a como *4 ,a kV .  \n\nO incremento total das entradas \u00e9 repassado ao problema P3.4b como restri\u00e7\u00e3o \n\nde igualdade dado pela Eq. (3.14). No problema P3.4b o decr\u00e9scimo da fun\u00e7\u00e3o custo \n\nn\u00e3o pode ser garantido a priori. Entretanto, o uso da vari\u00e1vel de folga sk?  garante que \n\nexiste solu\u00e7\u00e3o vi\u00e1vel, que satisfaz as restri\u00e7\u00f5es das equa\u00e7\u00f5es (3.5), (3.7) e (3.14).  \n\n\n\nCap\u00edtulo 3 \u2013 Controlador IHMPC para sistemas integradores sem tempo morto 30 \n\nDenominamos a solu\u00e7\u00e3o \u00f3tima do Problem P3.4b por ( )* *, , sb k ku? ? .A primeira \na\u00e7\u00e3o de controle * ( )bu k?  \u00e9 implementada na planta e nos transladamos ao instante \n\nseguinte \u2018 1k + \u2019.  \n\n \n\nNesse instante, a seguinte sequ\u00eancia \u00e9 solu\u00e7\u00e3o vi\u00e1vel do problema P3.4a : \n\n \n\n* *\n, 1 ( 1) ( 1) 0\n\nTT T\na k b bu u k u k m+ ? ?? = ? + ? + ?? ?L   ,   \n\n*\n1\n\ni i\nk k+? = ?  \n\n \n\nConsideremos agora que R  seja desprez\u00edvel em rela\u00e7\u00e3o a S2. O valor da fun\u00e7\u00e3o \n\ncusto do problema P3.4a \u00e9 ainda *,a kV . Consequentemente, a solu\u00e7\u00e3o \u00f3tima do problema \n\nP3.4a no instante \u2018 1k + \u2019 ser\u00e1 * *4 , 1 4 ,a k a kV V+ ? . Uma vez que selecionamos 2R S<&lt;, a \n\nfun\u00e7\u00e3o custo do problema P3.4a ir\u00e1 convergir a zero, que corresponde a ( ) 0i ikx k = ? = .  \n\n \n\nComo decorr\u00eancia da converg\u00eancia do problema P3.4a, temos que o problema \n\nP3.4b fica equivalente ao problema P3.2, que \u00e9 agora vi\u00e1vel. Ap\u00f3s converg\u00eancia, a \n\nsolu\u00e7\u00e3o do problema P3.4a se reduz a solu\u00e7\u00e3o trivial 0ik? = . Sendo assim, a \n\nconverg\u00eancia das sa\u00eddas do sistema aos valores de refer\u00eancia atrav\u00e9s da aplica\u00e7\u00e3o \n\nsucessiva das sequ\u00eancias de a\u00e7\u00f5es produzidas pela solu\u00e7\u00e3o dos problemas P3.4a e P3.4b \n\n\u00e9 assegurada pelo teorema 2.? \n\n \n\n \n\n3.3 Exemplos \n \n\nNesta se\u00e7\u00e3o, veremos algumas aplica\u00e7\u00f5es do controlador IHMPC proposto para \n\nsistemas integradores sem tempo morto. Tomemos como exemplo o sistema \n\napresentado no cap\u00edtulo anterior (se\u00e7\u00e3o 2.4) dado por : \n\n1,1 1,2\n\n2,1 2,2\n\n0,19 1, 7\n( ) ( ) 19, 5 1\n\n( ) ( ) / ( )\n( ) ( ) 0, 763 0, 235\n\n31, 8 1\n\nG s G s s s\nG s y s u s\n\nG s G s\ns s\n\n? ?? ?\n? ?? ? +\n? ?= = =? ? ?? ?? ?\n? ?+? ?\n\n \n\n\n\nCap\u00edtulo 3 \u2013 Controlador IHMPC para sistemas integradores sem tempo morto 31 \n\nObserva-se que as sa\u00eddas 1y  e 2y  s\u00e3o integradoras em rela\u00e7\u00e3o a uma das \n\nvari\u00e1veis manipuladas e est\u00e1veis em rela\u00e7\u00e3o \u00e0 outra.  \n\n \n\nO sistema ser\u00e1 simulado usando-se dois controladores. O primeiro ser\u00e1 \n\nconstitu\u00eddo pela solu\u00e7\u00e3o do problema P3.3 e o segundo, de duas camadas, pela solu\u00e7\u00e3o \n\nsequencial dos problemas P3.4a e P3.4b. \n\n \n\nOs par\u00e2metros de sintonia para ambos controladores est\u00e3o representados pela \n\ntabela a seguir : \n\n \n\n  m             Q              R          1S         2S       maxu?  \n\n   3 2 2[10 ,10 ]diag ? ?  2 2[10 ,10 ]diag ? ?  [10,10]diag  3 3[10 ,10 ]diag    [0, 2 , 0, 2]  \n\n \n\n         Tabela 3.1 \u2013 Par\u00e2metros de sintonia dos controladores I e II \n\n \n\n \n\nPara efeito de compara\u00e7\u00e3o entre os controladores I e II, o sistema ser\u00e1 simulado \n\npara o caso regulador e para o caso de rastreabilidade dos \u2018setpoints\u2019. Para o primeiro \n\ncaso, consideremos por exemplo, um estado inicial dado por [0 0]s Tx = ; \n\n[0 0]d Tx = ; [0, 4 0, 4]i Tx = ?  com \u2018setpoints\u2019 constantes [0 0]sp Ty = . Para o \n\nsegundo, consideramos que no instante 100k = sejam alterados os valores de refer\u00eancia \n\npara [2 2]sp Ty = . \n\n \n\nA figura 3.1 a seguir apresenta a resposta do sistema para os controladores I e II. \n\nObserva-se uma equival\u00eancia entre os controladores, uma vez que no caso regulador \n\n(instantes de 0k = at\u00e9 100k = ) o controlador II apresenta uma resposta das sa\u00eddas \n\nrelativamente melhor do que o controlador I, mas para o caso de rastreabilidade nos \n\n\u2018setpoints\u2019 ( instantes 100k > ), os controladores praticamente se equivalem. \n\n \n\n\n\nCap\u00edtulo 3 \u2013 Controlador IHMPC para sistemas integradores sem tempo morto 32 \n\n \n\n \nFigura 3.1-  Resposta do sistema com os controladores I e II \n\n \n\n\n\nCap\u00edtulo 3 \u2013 Controlador IHMPC para sistemas integradores sem tempo morto 33 \n\nA figura 3.2 a seguir apresenta o valor da fun\u00e7\u00e3o custo 3,kV do problema P3.3 \n\nobtida pelo controlador I, a qual \u00e9 comparada \u00e0 fun\u00e7\u00e3o 4 ,b kV do problema P3.4b do \n\ncontrolador II.  \n\n \n\nObserva-se que a fun\u00e7\u00e3o custo 4 ,b kV do controlador II n\u00e3o decresce no in\u00edcio do \n\ncaso regulador. Isso ocorre enquanto 4 , 0a kV ?  no problema P3.4a o que significa que o \n\nproblema P2 n\u00e3o seria vi\u00e1vel, n\u00e3o havendo assim, garantias no decr\u00e9scimo da fun\u00e7\u00e3o \n\ncusto.  \n\n \n\nNa medida em que 4 ,a kV  converge \u00e0 zero, os problemas P3.2 e P3.4b tornam-se \n\nequivalentes e a fun\u00e7\u00e3o 4 ,b kV  \u00e9 decrescente. \n\n \n\n \nFigura 3.2- Fun\u00e7\u00f5es Custo dos Problemas P3.3 (controlador I) e P3.4b (controlador II) \n \n \n \n \n \n\n\n\n 34 \n\nCap\u00edtulo 4 \n\nIHMPC estendido para sistemas integradores com tempo morto \n\n \n\n4.1 Introdu\u00e7\u00e3o \n \n\nNeste cap\u00edtulo, faremos a extens\u00e3o do controlador nominal preditivo com \n\nhorizonte de predi\u00e7\u00e3o infinito apresentado no cap\u00edtulo anterior, considerando agora a \n\nexist\u00eancia de tempo morto. Denominaremos esse controlador de IHMPC-E \n\n(Controlador Preditivo baseado em Modelo; de Horizonte Infinito, Estendido ) . \n\nUsaremos a formula\u00e7\u00e3o do modelo baseado em vari\u00e1veis de estado na forma \n\nincremental, contemplando agora caracter\u00edsticas integradoras, est\u00e1veis ou ambas, com a \n\nexist\u00eancia ou n\u00e3o de tempos mortos.  \n\n \n\n \n4.2 Modelo em vari\u00e1veis de estado para sistemas integradores com tempo morto \n \n\nGouv\u00eaa e Odloak (1997) desenvolveram para o caso de sistemas est\u00e1veis com \n\ntempo morto uma representa\u00e7\u00e3o de modelo em vari\u00e1veis de estado na forma incremental \n\ndenominado ROSSMPC. Utilizaremos essa mesma formula\u00e7\u00e3o, agora estendida para \n\nsistemas mistos (est\u00e1veis/integradores) com tempo morto e a aplicaremos no \n\ncontrolador IHMPC-E. \n\n \n \n4.2.1 O ROSSMPC de Gouv\u00eaa e Odloak (1997) \n \n\nEm sistemas est\u00e1veis com exist\u00eancia de tempo morto , o ROSSMPC considera \n\nque tem-se um horizonte de predi\u00e7\u00e3o adequado, de forma que ele englobe todos os \n\ntempos mortos do processo, ou seja :     \n\n \n\n{ },int max( / )i jnp m t?? + ?                                                                                                    (4.1) \n \nonde, \n \n          m  \u00e9 o horizonte de tempo das a\u00e7\u00f5es de controle \n         ,i j?  \u00e9 o tempo morto entre uma saida i  e uma entrada j   \n         t?  \u00e9 o intervalo de amostragem do controlador \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 35 \n\nA matriz de tempos mortos para o caso multivari\u00e1vel \u00e9 dada por : \n \n\n1,1 1,\n,\n\n,1 ,\n\nnu\nny nu\n\nny ny nu\n\n? ?\n?\n\n? ?\n\n? ?\n? ?\n\n= ?? ?\n? ?? ?\n\nL\nM O M\n\nL\nR                                                                                   (4.2) \n\n \n \n\nO modelo ROSSMPC na sua forma original desenvolvido para p\u00f3los est\u00e1veis \u00e9 \ndado por : \n \n[ ] [ ]\n[ ] [ ]\n\n1 kk k\n\nk k\n\nx A x B u\n\ny C x\n\n?\n+\n\n= +\n\n=\n\n \n                                                                                             (2.2) \n\n \nOs vetores e matrizes do ROSSMPC possuem as seguintes dimens\u00f5es :  \n, 1nex ? \u00a3 ; ,ne neA ? \u00a3 ; ,ne nuB ? \u00a3 ; ,ny neC ? \u00a1 , sendo ne  o n\u00famero de estados dado por \n.( 1 . )ne ny np nu na= + + . \n\n \n\n[ ] 1 2\nTT TT T T s d\n\nk k k npx y y y x x+ + +? ?= \u2026? ?\n                                                           (4.3) \n\n \nny  \u00e9 o n\u00famero de vari\u00e1veis controladas, nu  \u00e9 o n\u00famero de vari\u00e1veis manipuladas  e \nna  \u00e9 a ordem m\u00e1xima das fun\u00e7\u00f5es de transfer\u00eancia do sistema \n \n[ ]y ny? R  \n \n\n( )\n\n0 0 0 0 0\n0 0 0 0 0\n\n0 0 0 0 0\n0 0 0 0 [ 1 ]\n0 0 0 0 0\n0 0 0 0 0\n\nny\n\nny\n\nny\n\nny\n\nny\n\nI\nI\n\nA I\nI np t\nI\n\nF\n\n? ?\n? ?\n? ?\n? ?\n? ?\n\n= ? ?\n? ?? + ?\n? ?\n? ?\n? ?? ?\n\nL\nL\n\nM M M O M M M\nL\nL\nL\nL\n\n                                                (4.4) \n\n \n\n \n\n2\n\n3\n\n1\n0\n\nnp\n\nnp\n\nd\n\nS\nS\n\nB S\nS\nD\n\nD FN\n\n+\n\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?? ?\n\nM\n=                                                                                                          (4.5) \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 36 \n\n0 ... 0nyC I? ?= ? ?                                                                                               (4.6) \n\n \nA resposta ao degrau para cada instante no sistema multivari\u00e1vel \u00e9 obtida pela \n\nseguinte equa\u00e7\u00e3o :  \n \n \n\n( )\n\n1,1, 1,2, 1, ,\n\n2,1, 2,1, 2, , 0 ,\n\n,1, ,2, , ,\n\ni i nu i\n\ni i nu i d ny nu\ni\n\nny i ny i ny nu i\n\ns s s\ns s s\n\nS D t D N\n\ns s s\n\n? ?\n? ?\n? ?= = + ? ?\n? ?\n? ?\n? ?? ?\n\n \n\nL\nL\n\n\u00a1M M O M\nL\n\n                              (4.7) \n\n \n \n\n \n \n4.2.2 Extens\u00e3o do ROSSMPC para sistemas integradores com tempo morto \n \n\nPara essa extens\u00e3o do modelo ROSSMPC, podemos incluir nessa formula\u00e7\u00e3o a \nrepresenta\u00e7\u00e3o vista no cap\u00edtulo 2 para sistemas integradores, chegando-se na forma  \nrepresentada abaixo : \n\n \n[ ] [ ]\n[ ] [ ]\n\n1 kk k\n\nk k\n\nx A x B u\n\ny C x\n\n?\n+\n\n= +\n\n=\n\n \n                                                                                             (2.2) \n\n \n\nonde \n\n[ ] 1 2\nTT T TT T T s d i\n\nk k k npx y y y x x x+ + +? ?= \u2026? ?\n                                               (4.8) \n\n \n\n( ) ( )*\n\n0 0 0 0 0 0\n0 0 0 0 0 0\n\n0 0 0 0 0 0\n0 0 0 0 [ 1 ] [ 1 ]\n0 0 0 0 0\n0 0 0 0 0 0\n0 0 0 0 0 0\n\nny\n\nny\n\nny\n\nny\n\nny ny\n\nny\n\nI\nI\n\nI\nA\n\nI np t I np t\nI I t\n\nF\nI\n\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?= ? ?? + ? + ?\n? ?\n\n?? ?\n? ?\n? ?\n? ?? ?\n\nL\nL\n\nM M M O M M M M\nL\nL\nL\nL\nL\n\n                                (4.9) \n\n \n\n0\n2 3 1 [ ] [ ] [ ]...\n\nT\ni d TT T T T T i\n\nnp D F NB S S S D t D D+? ?? ?= + ?                         (4.10)   \n\n \n\n0 ... 0nyC I? ?= ? ?                                                                                               (4.11) \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 37 \n\nNa matriz de estado aparece a fun\u00e7\u00e3o ( )t?  que tem a forma : \n\n \n\n? =\n\n?\n\n?\n\n?\n?\n?\n?\n\nf f f f f f\nf f f f\n\nna na n na\n\nna\n\nu nu1 11 11 2 1 1 1 2 1 1 2 1\n\n2 1 1 2 1 2 2 1 2 2 1\n\n1 1 1 2 1\n\n2 1\n\n0 0 0 0\n0 0 0 0 0 0\n\n0 0 0 0 0 0 0 0 0 0\n\n, , , , , , , , , , , ,\n\n, , , , , , , ,\n\n, , ,\n\n,\n\nL L L L L\nL L L L L\n\nM M L M M L M L M M M L M M L\nL L L L L\n\n \n\n \n\n  \n\n... ... ... ... ... ... ...\n\n... ... ... ... ... ... ...\n\n... ... ... ... ... ... ...\n\n... ... ... ... ... ...\n\n, , , , , ,\n\n, , , , , , , , , ,\n\n, ,\n\n, ,\n\n0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0\n\n0 0 0 0\n\n2 2 2 1 2\n\n11 12 1 2 1 2\n\n2 2 2\n\n1\n\nf f f\n\nf f f f f\n\nna n n na\n\nn n n na n n na\n\nu u nu\n\ny y y ny y y ny\n\nM M M M M M M M M M M\n2 1\n\n... ..., , , , ,f fn n n n nay u y u ny nu\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n                  \n                                                                                                                     (4.12) \nonde  \n \n\n, , ,( )\n, , ( )\n\ni j g i jr t\ni j gf t e\n\n??\n=  \n \n\n \n\n Consideremos como hip\u00f3tese para o modelo que para cada sa\u00edda exista o mesmo \n\ntempo morto em todas as entradas que sejam integradas. Essa considera\u00e7\u00e3o \u00e9 \n\nrepresentada na fun\u00e7\u00e3o * ( )I t  no instante de tempo ( 1)np t+ ?  da seguinte forma : \n\n \n\n1\n\n* 2\n\n( 1) 0 0\n\n0 ( 1) 0\n[( 1) ]\n\n0 0 ( 1)\n\nu\n\nu\nny ny\n\nu\nny\n\nnp t\n\nnp t\nI np t\n\nnp t\n\n\u00d7\n\n? ?+ ? ? ?\n? ?\n? ?+ ? ? ?\n\n+ ? = ?? ?\n? ?\n? ?\n\n+ ? ? ?? ?? ?\n\nL\nL \u00a1\n\nM M O M\nL\n\n \n\n                                                                                                                     (4.13) \n\nonde \n \n\nu\ni?  \u00e9 o tempo morto associado ao p\u00f3lo integrador da sa\u00edda iy  \n\n \n\n \n\n A resposta ao degrau para o sistema multivari\u00e1vel \u00e9 dada por : \n\n \n0 *( ) ( ) ( )d iS t D t D N I t D= + ? +                                                                                (2.33) \n\n \n \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 38 \n\n4.3 Desenvolvimento do controlador IHMPC-E de modelo nominal \n \n\nO problema de otimiza\u00e7\u00e3o que definir\u00e1 a lei de controle ser\u00e1 o de minimizar uma \n\nfun\u00e7\u00e3o que pondere os erros das predi\u00e7\u00f5es das sa\u00eddas e os movimentos nas vari\u00e1veis \n\nmanipuladas. Prop\u00f5e-se ent\u00e3o, a fun\u00e7\u00e3o custo dada pela Eq.(3.1) : \n\n \n\n[ ] [ ]\n1\n\n1,\n0 0\n\n( ) ( ) ( ) ( )\nm\n\nT T\nk\n\nj j\n\nV e k j Q e k j u k j R u k j\n? ?\n\n= =\n\n= + + + ? + ? +? ?                              (3.1) \n \nonde \n \n\n( ) spk je k j y y++ = ?  \u00e9 o erro entre a predi\u00e7\u00e3o das sa\u00eddas e seus valores de refer\u00eancia \n\n                                 com ( )e k j+ ny? \u00a1  \nQ e R s\u00e3o matrizes positivas definidas que ponderam relativamente as vari\u00e1veis  \n           controladas e manipuladas, respectivamente \n \n\n \nDesdobrando a primeira parcela de 1,kV  , temos : \n\n \n1\n\n1,\n0 1 0\n\n( ) ( ) ( ) ( ) ( ) ( )\nnp m\n\nT T T\nk\n\nj j j\n\nV e k j Q e k j e k np j Q e k np j u k j R u k j\n? ?\n\n= = =\n\n= + + + + + + + + ? + ? +? ? ?\n \n\n1\n(1) (2)\n\n1,\n0\n\n( ) ( )\nm\n\nT\nk k k\n\nj\n\nV V V u k j R u k j\n?\n\n=\n\n= + + ? + ? +?  \n \n \nAgruparemos adequadamente os termos  (1)kV  e \n\n(2)\nkV  na forma matricial. \n\n \n \n\nPara isso, calculamos inicialmente de forma recursiva as predi\u00e7\u00f5es de sa\u00eddas \n\nentre o instante atual at\u00e9 o horizonte de predi\u00e7\u00e3o finito np , chega-se na seguinte \n\nequa\u00e7\u00e3o (ver dedu\u00e7\u00e3o no ap\u00eandice A1 ) : \n\n                             \n\n[ ]\n\n1\n2\n\n2\n\n1 2\n\n1\n1\n\n1\n\n1 2\n\n0 0\n0 ( )\n\n( 1)\n. .\n\n.\n. .\n\n.\n( 1)\n\nk\n\nk\n\nm m\nk\n\nm m\nnp\n\nk np\nnp\n\nk np np np np mk\n\nCB\ny CA\n\nCAB CB u k\ny CA\n\nu k\nx CA B CA B CB\n\nCA B CA B CAB\ny CA\n\nu k m\ny CA\n\nCA B CA B CA B\n\n+\n\n+\n\n? ?\n\n?\n?\n\n+ ?\n\n+ ? ? ?\n\n? ?\n? ? ? ? ? ? ?? ? ? ? ? ?\n? ? ? ? ? ? ? +\n? ? ? ? ? ?\n\n= +? ? ? ? ? ?\n? ? ? ? ? ?\n? ? ? ? ? ?\n? ? ? + ?? ? ? ?\n\n? ?? ? ? ?? ? ? ?? ?\n\nL\nL\n\nM M O M\nL\nL\n\nM M O M\nL\n\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?? ?\n\n    \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 39 \n\n       a qual pode ser representada em forma compacta matricial :    \n \n\n[ ] [ ]\n__\n\nkk k\ny C x C u\n\n==\n\n= + ?                                                                                               (4.14) \n \nonde   \n \n__\n\nC  . , . 2 . .np ny ny np ny ny nu na+ +? \u00a3  \n \n\nC\n==\n\n. , .np ny m nu? \u00a1  \n \n \n \n Substituindo-se a Eq.(4.14) na express\u00e3o de (1)kV  abaixo temos : \n \n \n\n__ __~\n(1)\n\n1 1( / ) ( / )\nT\n\nsp sp\nk k kV C x k k C u y Q C x k k C u y\n\n== ==? ? ? ?\n= + ? ? + ? ?? ? ? ?? ? ? ?\n\n                               (4.15) \n\n \nonde \n \n\n[ ]\n~\n\n( ... )Q diag Q Q Q= . , .np ny np ny? \u00a1  \n \n\n1 [ ... ]\nT T Tsp sp sp sp Ty y y y= .np ny? \u00a1  \n\n \n\n \n Colocaremos agora o termo (2)kV  dado abaixo na forma matricial : \n \n\n(2)\n\n1\n\n( ) ( )Tk\nj\n\nV e k np j Q e k np j\n?\n\n=\n\n= + + + +?                                                               \n \nonde    \n \n\n/( )\nsp\n\nk np j ke k np j y y+ ++ + = ?  \n \n \n \nFazendo uso da Eq.(2.2) e escrevendo recursivamente as predi\u00e7\u00f5es de sa\u00eddas do \n\nelemento k npy +  do vetor de estados no instante 1k m+ + e seguintes, temos : \n \n\n1\n(( 1) ) ( 1)s d ik np nyk m k m k m k my x np t x np t I x+ + + + + +? ? ? ? ? ?? ? = + ? + ? + + ?? ? ? ? ? ? ? ?  \n\n \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 40 \n\n2 1 1 1\n(( 1) ) ( 1)s d ik np nyk m k m k m k my x np t x np t I x+ + + + + + + + +? ? ? ? ? ?? ? = + ? + ? + + ?? ? ? ? ? ? ? ?  \n\n{ }. (( 1) ) ( 1)s i d iny ny nyk m k m k m k mI x I t x np t F x np t I x+ + + +? ? ? ? ? ? ? ?= + ? + ? + ? + + ?? ? ? ? ? ? ? ?\n            { }(( 1) ) . ( 1)s d iny nyk m k m k mx np t F x I t np t I x+ + +? ? ? ? ? ?= + ? + ? + ? + + ?? ? ? ? ? ?  \n \n  M  \n \n\n{ }(( 1) ) ( 1)s j d ik np ny nyk m j k m k m k my x np t F x I j t np t I x+ + + + + +? ? ? ? ? ?? ? = + ? + ? + ? + + ?? ? ? ? ? ? ? ?  \n \n \n\nObserva-se que para as predi\u00e7\u00f5es de sa\u00eddas serem limitadas no infinito e por \nconsequ\u00eancia o pr\u00f3prio termo (2)kV , temos que impor a anula\u00e7\u00e3o do efeito dos estados \n\ns\n\nk m\nx\n\n+\n? ?? ? , \n\ni\n\nk m\nx\n\n+\n? ?? ? no instante k m+ .  \n\n \nIsso pode ser feito atrav\u00e9s da matriz modificada *A , originada da matriz A  da \n\nEq. (2.2) anulando-se os termos correspondentes aos p\u00f3los integradores : \n \n \n\n                      \n( )( ) ( )( )\n\n*\n*\n\n0 0 0 0 0 0\n0 0 0 0 0 0\n\n0 0 0 0 0 0\n0 0 0 0 1 1\n\n0 0 0 0 0\n0 0 0 0 0 0\n0 0 0 0 0 0\n\nny\n\nny\n\nny\n\nny\n\nI\nI\n\nI\nA\n\nI np t I np t\n\nF\n\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?= ? ?? + ? + ?\n? ?\n? ?\n? ?\n? ?\n? ?? ?\n\n0 0\n\n0\n\nL\nL\n\nM M M O M M M M\nL\nL\nL\nL\nL\n\n          (4.16) \n\n \n \nassim, em qualquer instante j  as predi\u00e7\u00f5es das sa\u00eddas s\u00e3o obtidas por :       \n \n \n\n[( 1) ] [ ]j d Tk np k mk m jy np t F x+ ++ +? ? = ? + ?? ?  \n\n \n \nnessas condi\u00e7\u00f5es , os estados nos instantes posteriores a k np+  ser\u00e3o : \n \n \n\n[ ] [ ]( )* np j mk np j k mx A x\n+ ?\n\n+ + +\n=                                                                                      (4.17) \n\n \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 41 \n\ncom o estado [ ]\nk np j\n\nx\n+ +\n\n substitu\u00eddo na predi\u00e7\u00e3o das sa\u00eddas temos :  \n\n \n\n[ ] [ ] [ ]( )* np j mk np j k np j k my C x CA x\n+ ?\n\n+ + + + +\n= =                                                          (4.18) \n\n \nSubstituiremos agora a Eq.(4.18) na express\u00e3o de ( 2 )kV  e a colocaremos na forma \n\nmatricial atrav\u00e9s do seguinte vetor de \u2018setpoints\u2019 : \n \n\n2 ... 0 0\nTT T T Tsp sp sp sp sp T Ty y y y y? ?=\n\n? ?\n. 2 . .np ny ny ny nu na+ +? R  \n\n \n \nteremos assim , \n \n\n(2)\n\n1\n\n( / ) ( / )\nTsp sp\n\nk\nj\n\nV y k np j k y Q y k np j k y\n?\n\n=\n\n? ? ? ?= + + ? + + ?? ? ? ??  \n \n\n(2)\n2 2\n\n1\n\n[ ] [ ]\nTsp sp\n\nk k np j k np j\nj\n\nV C x C y Q C x C y\n?\n\n+ + + +\n=\n\n? ? ? ?= ? ?? ? ? ??  \n\n                        [ ] [ ]\n1\n\nT T\nk m j k m j\n\nj\n\ne C QC e\n?\n\n+ + + +\n=\n\n= ?                                                          (4.19) \n \nusando a eq.(4.16) tem-se : \n \n\n [ ] ( )* [ ]np j m k mk np je A e\n+ ?\n\n++ +\n=  \n\n \n\n[ ]{ } [ ]{ }( ) ( )(2) * *\n1\n\nTnp m j np m jT\nk k m k m\n\nj\n\nV A e C Q C A e\n?\n\n? + ? +\n\n+ +\n=\n\n= ?  \n\n    [ ] [ ]( ) ( )* * * *\n1\n\nT Tnp m j j np mT T\nk m k m\n\nj\n\ne A A C Q CA A e\n?\n\n? ?\n\n+ +\n=\n\n? ?\n= ? ?\n\n? ?\n?  \n\n \n\ndefinindo a matriz \n__\n\n* *\n\n1\n\nTj jT\n\nj\n\nQ A C Q CA\n?\n\n=\n\n= ?  e pr\u00e9-multiplicando e p\u00f3s-multiplicando \n__\n\nQ  \n\npor *\nT\n\nA e *A , respectivamente, e subtraindo da pr\u00f3pria \n__\n\nQ , obtemos ent\u00e3o a equa\u00e7\u00e3o de \nLyapunov : \n \n\n                           \n__ __\n\n* * * *T T TA Q A Q A C QCA? = ?  \n \nfinalmente, chega-se na express\u00e3o finita do termo (2)kV  : \n \n\n[ ] [ ]\n__\n\n( ) ( )(2) * *\nTnp m np mT\n\nk k m k m\nV e A Q A e\n\n? ?\n\n+ +\n=                                                                  (4.20) \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 42 \n\nA Eq.(4.20) pressup\u00f5e a validade de  duas restri\u00e7\u00f5es de igualdade atendidas : \n \n  \n                          ( ) 0s spx k m y+ ? =                                                                          (4.21) \n \n                          ( ) 0ix k m+ =                                                                         (4.22) \n \n \n\nDeterminaremos agora ( )sx k m+  em fun\u00e7\u00e3o de ( )sx k  para uso na Eq. (4.21). \nEntre os instantes k at\u00e9 k m+  podemos escrever de forma recursiva : \n \n \n\n( )0( 1) ( ) ( ) ( )s s i ix k x k t x k D t D u k+ = + ? + + ? ?  \n \n\n( )0( 2) ( 1) ( 1) ( 1)s s i ix k x k t x k D t D u k+ = + + ? + + + ? ? +  \n \n \nmas ( 1) ( ) ( )i i ix k x k D u k+ = + ?  que substitu\u00eddo acima resulta \n                            \n \n\n( ) ( )0 0( 2) ( ) 2 ( ) 2 ( ) ( 1)s s i i ix k x k t x k D t D u k D t D u k+ = + ? + + ? ? + + ? ? +  \n \n      M  \n \n\n0 0 0\n\n( )\n( 1)\n\n( ) ( ) ( ) ( 1) ...\n\n( 1)\n\ns s i i i i\n\nu k\nu k\n\nx k m x k m t x k D m t D D m t D D t D\n\nu k m\n\n?? ?\n? ?? +? ?? ?+ = + ? + + ? + ? ? + ?? ? ? ?\n? ?\n? + ?? ?\n\nM\n\n \nsubstituindo na Eq.(4.21) tem-se : \n \n \n\n( ) ( ) 0s sp i kx k y m t x k D u? + ? + ? =%                                                                         (4.23) \n \nonde \n \n \n\n0 0 0[ ( 1) ... ]i i iD D m t D D m t D D t D= + ? + ? ? + ?%  \n \n\n( )\n( 1)\n\n( 1)\n\nk\n\nu k\nu k\n\nu\n\nu k m\n\n?? ?\n? ?? +? ?? =\n? ?\n? ?\n? + ?? ?\n\nM\n \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 43 \n\nDeterminaremos agora ( )ix k m+  em fun\u00e7\u00e3o de ( )ix k  para uso na restri\u00e7\u00e3o de \nigualdade dada pela Eq. (4.22). \n \n\nEntre os instantes k at\u00e9 k m+  podemos escrever de forma recursiva , \n \n           ( 1) ( ) ( )i i ix k x k D u k+ = + ?  \n \n           ( 2) ( 1) ( 1)i i ix k x k D u k+ = + + ? +  \n                          ( ) ( ) ( 1)i i ix k D u k D u k= + ? + ? +  \n                   \n                  M  \n\n           \n\n( )\n( 1)\n\n( ) ( ) ...\n\n( 1)\n\ni i i i i\n\nu k\nu k\n\nx k m x k D D D\n\nu k m\n\n?? ?\n? ?? +? ?? ?+ = + ? ? ? ?\n? ?\n? + ?? ?\n\nM\n \n\n \n \n\n1,( ) 0\ni i\n\nm kx k D u+ ? =                                                                                                (4.24) \n                                                          \n  onde \n \n\n1, ...\ni i i i\n\nmD D D D? ?= ? ?  \n\n \n \n\nObtemos agora o estado completo [ ]k mx +  em fun\u00e7\u00e3o de [ ]kx  para uso em \n(2)\n\nkV . \n \n\nEntre os instantes k at\u00e9 k m+  podemos escrever , \n \n             [ ] [ ]1 ( )k kx A x B u k+ = + ?  \n \n             [ ] [ ]2 1 ( 1)k kx A x B u k+ += + ? +  \n                       [ ]2 ( ) ( 1)kA x AB u k B u k= + ? + ? +  \n \n             [ ] [ ]3 2 ( 2)k kx A x B u k+ += + ? +  \n                        [ ]3 2 ( ) ( 1) ( 2)kA x A B u k AB u k B u k= + ? + ? + + ? +  \n \n                M  \n \n\n              \n[ ] [ ] 1 2 3( ) ( 1) ( 2)\n\n... ( 1)\n\nm m m m\nk m k\n\nx A x A B u k A B u k A B u k\n\nB u k m\n\n? ? ?\n+\n\n= + ? + ? + + ? + +\n\n+ ? + ?\n \n\n \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 44 \n\nNa forma matricial temos :                  \n \n\n[ ] [ ] 1 2\n( )\n\n( 1)\n...\n\n( 1)\n\nm m m\nk m k\n\nu k\nu k\n\nx A x A B A B B\n\nu k m\n\n? ?\n+\n\n?? ?\n? ?? +? ?? ?= + ? ? ? ?\n? ?\n? + ?? ?\n\nM\n \n\n \nou ainda : \n \n\n[ ] [ ]\n~\n\nm\nkk m k\n\nx A x AB u\n+\n\n= + ?        \n \n\n[ ] [ ]\n~\n\nm\nkk m k\n\ne A e AB u\n+\n\n= + ?                                                                                          (4.25) \n \n \n\nSubstituindo a Eq. (4.25) na Eq. (4.20) , temos : \n \n \n\n[ ]{ } [ ]{ }~ ~(2) *\nT\n\nm m\nk k kk k\n\nV A e AB u Q A e AB u= + ? + ?                                                       (4.26) \n\n \n\nonde   \n__( ) ( )* * *\n\nTnp m np m\nQ A Q A\n\n? ?\n=  \n\n \n \nSubstituindo (1)kV  e \n\n(2)\nkV  na Fun\u00e7\u00e3o Custo do Controlador, chega-se na \n\nexpress\u00e3o matricial que determina o valor escalar de kV  :  \n \n \n\n__ __~\n\n1 1[ ] [ ]\nT\n\nsp sp\nk k k k kV C x C u y Q C x C u y\n\n== ==? ? ? ?\n= + ? ? + ? ?? ? ? ?? ? ? ?\n\n  \n\n           [ ]{ } [ ]{ }~ ~*\nT T\n\nm m T\nk k k kk k\n\nA e AB u Q A e AB u u R u+ + ? + ? + ? ?%                      (4.27) \n\n  \n \n A express\u00e3o acima pode ser colocada convenientemente na forma quadr\u00e1tica \nmostrada abaixo (ver dedu\u00e7\u00e3o no apendice A2), a qual \u00e9 minimizada no seu valor em \nfun\u00e7\u00e3o da sequ\u00eancia \u00f3tima de controle *ku?  : \n \n \n     2 TTk k k f kV u H u C u c= ? ? + ? +                                                                        (4.28) \n \n \n Assim, o MPC de horizonte infinito para sistemas integradores com tempo \nmorto, pode ser resolvido pelo problema de otimiza\u00e7\u00e3o, formulado a seguir. \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 45 \n\nProblema P4.1 \n \n\n1 ,1 1min 2\nT T\nk k f k\n\nu\nu H u C u c\n\n?\n? ?? ? + ? +? ?  \n\n \n               s. a.       ( ) ( ) 0s sp i kx k y m t x k D u? + ? + ? =%             (4.23)\n\n                                                 1( ) 0\ni i\n\nm kx k D u+ ? =             (4.24)\n\n                               ( ) ,   0u k j j? + ? ?U                                            (4.29) \n\n                        \n\nmax max\n\nmin max\n\n0\n\n( )\n( ) ( ) 0;\n\n( 1) ( ) ; 0,1, , 1\nj\n\ni\n\nu u k j u\nu k j u k j j m\n\nu u k u k i u j m\n=\n\n? ?\n? ??? ? ? + ? ?? ?? ?\n\n= ? + ? + = ?? ?\n? ?\n\n? ? + ? + ? = ?? ?\n? ?? ?\n\n? L\nU:  \n\nsendo , \n\n          \n~ ~\n\n*\n1\n\nT T\n\nH C Q C AB Q AB R\n== ==\n\n= + +% %  \n          [ ] [ ]\n\n~\n*\n\n,1 1\n\nTT TT sp m\nf k k\n\nC x C Q C y Q C e A Q AB\n== ==\n\n= ? +% %  \n          [ ] [ ] [ ] [ ] [ ]*1 1 11 2\n\nT T TT TT sp sp sp m m\nk k k k k\n\nc x C QC x y QC x y Qy e A Q A e= ? + +% % %  \n \n \n O teorema a seguir garante a converg\u00eancia do sistema em malha fechada do \nProblema 4.1 enquanto o mesmo for vi\u00e1vel. \n \n \nTeorema 4.1 : Se o Problema P4.1 for vi\u00e1vel no instante k , a aplica\u00e7\u00e3o da solu\u00e7\u00e3o  \n                        \u00f3tima para esse problema em um processo sem perturba\u00e7\u00f5es em                                 \n                        malha fechada, levar\u00e1 as sa\u00eddas do sistema aos seus valores de   \n                        refer\u00eancia ( \u2018setpoints\u2019 ). \n \nProva : A prova desse teorema \u00e9 similar e segue os mesmos passos apresentados no   \n              teorema 1 do cap\u00edtulo anterior. \n              \n O teorema acima garante a converg\u00eancia do sistema em malha fechada, \nenquanto o Problema P4.1 for vi\u00e1vel. Entretanto, na pr\u00e1tica, esse problema torna-se \ninvi\u00e1vel com facilidade, pois, ocorre conflito entre as restri\u00e7\u00f5es de igualdade dadas \npelas Eq. (4.23) e Eq. (4.24) com a Eq. (4.29). \n  \n Isso acontece, a exemplo do controlador do problema P3.1 visto no cap\u00edtulo \nanterior, quando o controlador \u00e9 submetido \u00e0 grandes varia\u00e7\u00f5es nos \u2018setpoints\u2019, ou, \nquando o sistema recebe perturba\u00e7\u00f5es de grandes amplitudes. \n \n Para aumentar a faixa de viabilidade do controlador, faremos uso da vari\u00e1vel de \nfolga na fun\u00e7\u00e3o custo, a qual relaxa a solu\u00e7\u00e3o da restri\u00e7\u00e3o de igualdade dada pela Eq. \n(4.23). \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 46 \n\nSeguindo a mesma sequ\u00eancia da formula\u00e7\u00e3o do problema de controle sem tempo \n\nmorto apresentado no cap\u00edtulo anterior, definimos a seguinte fun\u00e7\u00e3o custo : \n\n \n1\n\n2,\n0 0\n\n1\n\n( ) ( ) ( ) ( )\nmTs s T\n\nk k k\nj j\n\nTs s\nk k\n\nV e k j Q e k j u k j R u k j\n\nS\n\n? ?\n\n? ?\n\n? ?\n\n= =\n\n? ? ? ?= + ? + ? + ? + ? +? ? ? ?\n\n+\n\n? ?\n        (4.30) \n\n \n \n\nOs termos (1)kV  e \n(2)\n\nkV  neste caso ser\u00e3o dados por : \n\n \n \n\n(1)\n1 1[ ( / ) ] [ ( / ) ]\nsp s T sp s\n\nk k k k kV Cx k k C u y I Q Cx k k C u y I? ?\n== ==\n\n= + ? ? ? + ? ? ?%  \n \n\n(2)\n\n1\n\n[ ( ) ] [ ( ) ]s T sk k k\nj\n\nV e k m j Q e k m j? ?\n?\n\n=\n\n= + + ? + + ??  \n \n \n\nPara que o termo (2)kV  seja limitado, impomos : \n \n \n\n( ) 0s sp skx k m y ?+ ? ? =                                                                                          (4.31) \n \n\n( ) 0ix k m+ =                                                                                         (4.22) \n \n \n \n\nPor analogia \u00e0 Eq.(4.23), a Eq.(4.31) resulta em \n \n \n \n\n( ) ( ) 0s sp i sk kx k y m t x k D u ?? + ? + ? ? =%                                                                 (4.32) \n \n \n \n\nPor analogia \u00e0 Eq.(4.27) temos : \n \n \n\n[ ] [ ]2, 1 1\nT\n\nsp s sp s\nk k k k kk k\n\nV C x C u y I Q C x C u y I? ?\n== ==? ? ? ?= + ? ? ? + ? ? ?? ? ? ?? ? ? ?\n\n%  \n\n[ ]{ } [ ]{ }~ ~* 1\nT T\n\nTm m T s s\nk k k k k kk k\n\nA e AB u Q A e AB u u R u S? ?+ + ? + ? + ? ? +%    (4.33) \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 47 \n\nProblema P4.2  \n \n\nAnalogamente ao caso em que n\u00e3o temos tempo morto, o controlador passa a ser \n\ndefinido pelo seguinte problema : \n\n \n\n2 ,2 2\n,\n\nmin 2\ns\n\nT k kT s T\nk k fs su\n\nk k\n\nu u\nu H C c\n\n?\n?\n\n? ??\n\n? ?? ? ? ?? ?? ?? ?? + +? ? ? ?? ?? ?? ? ? ? ? ?? ?? ? ? ?? ?\n \n\n \n                s. a.  \n \n                         ( ) ( ) 0s sp i sk kx k y m t x k D u ?? + ? + ? ? =%                                       (4.32) \n \n   1( ) 0\n\ni i\nm kx k D u+ ? =                                                          (4.24) \n\n \n   ( ) ,   0u k j j? + ? ?U                                                                     (4.29) \n\n                         \n\nmax max\n\nmin max\n\n0\n\n( )\n( ) ( ) 0;\n\n( 1) ( ) ; 0,1, , 1\nj\n\ni\n\nu u k j u\nu k j u k j j m\n\nu u k u k i u j m\n=\n\n? ?\n? ??? ? ? + ? ?? ?? ?\n\n= ? + ? + = ?? ?\n? ?\n\n? ? + ? + ? = ?? ?\n? ?? ?\n\n? L\nU:  \n\nsendo , \n \n                 \n\n               \n\n~ ~\n*\n\n2\n\n1\n\nT T T\n\nT T\n\nC Q C AB Q AB R C QI\nH\n\nI Q C I QI S\n\n== == ==\n\n==\n\n? ?\n+ + ?? ?=\n\n? ?\n? +? ?? ?\n\n% %%\n% %\n\n \n\n \n \n\n               [ ] [ ] [ ]\n~\n\n*\n,2 1 1\n\nT TT T TT sp m T sp\nf k k k\n\nC x C Q C y Q C e A Q AB x C QI y QI\n== ==? ?= ? + ? +? ?? ?\n\n% % % %  \n \n \n\n                   [ ] [ ] [ ] [ ] [ ]{ }*1 1 12 1 2 T T TT TT sp sp sp m mk k k k kc c x C QC x y QC x y Qy e A Q A e= = ? + +% % %  \n \n \n A converg\u00eancia das sa\u00eddas aos seus valores de refer\u00eancia com o sistema em \nmalha fechada com o controlador definido no Problema P4.2 \u00e9 assegurada pelo seguinte \nteorema : \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 48 \n\nTeorema 4.2 : Para um sistema sem perturba\u00e7\u00f5es, com p\u00f3los est\u00e1veis e integradores,                                \n                        se o Problema P4.2 for vi\u00e1vel no instante k , ent\u00e3o, ser\u00e1 vi\u00e1vel para os \n                        instantes consecutivos 1k + , 2k + , ..., e al\u00e9m disso, as sa\u00eddas do sistema \n                        em malha fechada com a lei de controle formulada no Problema P4.2                      \n                        ir\u00e3o convergir assintoticamente aos valores de refer\u00eancia. \n \nProva : A prova desse teorema \u00e9 feita seguindo os mesmos passos apresentados no  \n             teorema 2, visto no cap\u00edtulo anterior.  \n \n \n Para o caso regulador, da mesma forma analisada no Problema P3.2 do cap\u00edtulo \nanterior, o controlador do Problema P4.2 ser\u00e1 tamb\u00e9m vi\u00e1vel para uma regi\u00e3o maior de \nestados iniciais e/ou perturba\u00e7\u00f5es do que o controlador do Problema P4.1. \n \n Para o caso de rastreabilidade nos valores de refer\u00eancia, o Problema P4.2 ser\u00e1 \ntamb\u00e9m vi\u00e1vel para mudan\u00e7as maiores nos valores de \u2018setpoints\u2019 do que o controlador \ndo Problema P4.1. \n \n Ainda assim, poder\u00e1 haver conflito entre as restri\u00e7\u00f5es de igualdades dadas pelas \nEq. (4.32) e Eq. (4.24) dependendo do tamanho das perturba\u00e7\u00f5es ou das varia\u00e7\u00f5es dos \nvalores de refer\u00eancia. \n \n Usaremos aqui a mesma extens\u00e3o na fun\u00e7\u00e3o custo, apresentada anteriormente, \nadicionando-se a segunda vari\u00e1vel de folga para sistemas com p\u00f3los integradores, \nconforme Cano e Odloak (2003) surgindo ent\u00e3o a defini\u00e7\u00e3o do Problema P4.3 a seguir. \n \n \n \n \nProblema P4.3 \n\n \n\nSeguindo a mesma sequ\u00eancia da formula\u00e7\u00e3o do problema anterior, a fun\u00e7\u00e3o \n\ncusto da Eq.(4.33) \u00e9 estendida agora pelo uso da segunda vari\u00e1vel de folga : \n\n \n1\n\n3,\n0 0\n\n1 2\n\n( ) ( ) ( ) ( )\nmTs i s i T\n\nk k k k k\nj j\n\nT Ts s i i\nk k k k\n\nV e k j j t Q e k j j t u k j R u k j\n\nS S\n\n? ? ? ?\n\n? ? ? ?\n\n? ?\n\n= =\n\n? ? ? ?= + ? ? ? + ? ? ? + ? + ? +? ? ? ?\n\n+ +\n\n? ?\n                    \n\n                                                                                                                               (4.34) \n \nonde  \n \n \n\n1S  e 2S  s\u00e3o matrizes positivas definidas que ponderam as vari\u00e1veis de folga \ns\nk? e  \n\n             ik? , respectivamente. \n \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 49 \n\nOs termos (1)kV  e \n(2)\n\nkV  ser\u00e3o dados por : \n \n\n[ ] [ ](1) 1 1\nT\n\nsp s i sp s i\nk k k k k k kk k\n\nV C x C u y I T Q C x C u y I T? ? ? ?\n== ==? ? ? ?= + ? ? ? ? + ? ? ? ?? ? ? ?? ? ? ?\n\n%  \n \n\n(2)\n\n1\n\n[ ( ) ] [ ( ) ]s i T s ik k k k k\nj\n\nV e k m j j t Q e k m j j t? ? ? ?\n?\n\n=\n\n= + + ? ? ? + + ? ? ??  \n \nonde  \n\n                 \n2\n\nny\n\nny\n\nny\n\nt I\nt I\n\nT\n\nnp t I\n\n?? ?\n? ??? ?=\n? ?\n? ?\n\n?? ?? ?\n\nM\n. ,np ny ny? R              \n\nny\n\nny\n\nny\n\nI\nI\n\nI\n\nI\n\n? ?\n? ?\n? ?=\n? ?\n? ?\n? ?? ?\n\nM\n. ,np ny ny? R  \n\n \n \nPara o termo (2)kV  ser limitado impomos : \n \n\n( ) 0s sp skx k m y ?+ ? ? =                                                                                          (4.31) \n \n\n( ) 0i ikx k m ?+ + =                                                                                        (4.35) \n \n\n( ) ( ) 0s sp i sk kx k y m t x k D u ?? + ? + ? ? =%                                                                 (4.32) \n \n\n1( ) 0\ni i i\n\nm k kx k D u ?+ ? + =                                                                                           (3.12) \n \n \n\n[ ] [ ]3, 1 1\nT\n\nsp s i sp s i\nk k k k k k kk k\n\nV C x C u y I T Q C x C u y I T? ? ? ?\n== ==? ? ? ?= + ? ? ? ? + ? ? ? ?? ? ? ?? ? ? ?\n\n%  \n\n             \n[ ]{ } [ ]{ }~ ~*\n\n1 2\n\nT T\nm m\n\nk kk k\n\nT TT s s i i\nk k k k k k\n\nA e AB u Q A e AB u\n\nu R u S S? ? ? ?\n\n+ + ? + ?\n\n+ ? ? + +%\n                                                 (4.36) \n\n \n \n A minimiza\u00e7\u00e3o da fun\u00e7\u00e3o custo 3,kV  sujeita \u00e0s restri\u00e7\u00f5es de igualdade da Eq. \n(4.32) e Eq. (3.12), n\u00e3o produz uma lei de controle que garanta que a fun\u00e7\u00e3o seja \ndecrescente no tempo. Tal fato decorre que no instante 1k +  as express\u00f5es abaixo n\u00e3o \natender\u00e3o a Eq. (3.12) : \n \n                * *1 [ ( 1) ... ( 1) 0]\n\nT T T\nku u k u k m+? = ? + ? + ?     \n\n               \n*\n\n1\ns s\nk k? ?+ =  \n\n                  \n*\n\n1\ni i\nk k? ?+ =  \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 50 \n\n Assim, usaremos a estrat\u00e9gia do cap\u00edtulo anterior para a obten\u00e7\u00e3o de um \ncontrolador est\u00e1vel que seja baseado na minimiza\u00e7\u00e3o da fun\u00e7\u00e3o custo dada pela Eq. \n(4.37). Dessa forma, prop\u00f5e-se a fun\u00e7\u00e3o custo secund\u00e1ria, positiva, j\u00e1 vista \nanteriormente dada por : \n \n \n\n, 2\n\nTi i\nl k k kV S? ?=                                                                                                                                \n\n \n \n Consideremos ainda a mesma restri\u00e7\u00e3o do cap\u00edtulo anterior \u00e0 ser incluida no \nproblema de otimiza\u00e7\u00e3o : \n \n\n, , 1l k l kV V ?&lt;%                                                                                                                 (3.13) \n \nonde  \n \n\n, 1 2\n\nTi i\nl k k kV S? ?? = % %%   \n\n \n \n\nO escalar , 1l kV ?% \u00e9 calculado com 1ik? ?%  , o qual \u00e9 obtido da seguinte maneira : \n \n\n1 1, 1( 1)\ni i i\nk m kx k D u? ?? = ? ? ? ?% %  (3.14) \n\n \n\n( 1) ( ) ( 1)i i ix k x k D u k? = ? ? ?%  (3.15) \n\n \n\nPara um sistema sem perturba\u00e7\u00f5es, tem-se : \n\n \n\n ( 1) ( 1)\ni ix k x k? = ?%       \n\n1 1\ni i\nk k? ?? ?=%  \n\n \n \n Assim, \u00e0 medida que as entradas do sistema no ponto de equil\u00edbrio estejam \ndentro da regi\u00e3o vi\u00e1vel U , a Eq. (3.13) ser\u00e1 atendida para qualquer max 0u? ? e ,l kV  ser\u00e1 \ndecrescente. \n \n Como j\u00e1 apresentado anteriormente, a Eq. (3.13) ser\u00e1 sempre vi\u00e1vel com a \ndetermina\u00e7\u00e3o do estado no instante 1k ?  usando a Eq. (3.15). \n \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 51 \n\n Com isso, a proposi\u00e7\u00e3o do controlador preditivo nominal de horizonte infinito \npara sistemas est\u00e1veis e/ou integradores com exist\u00eancia ou n\u00e3o de tempo morto ser\u00e1 \nformulado pela fun\u00e7\u00e3o custo do Problema P4.3, partindo da Eq. (4.36), na forma \nquadr\u00e1tica ( ver dedu\u00e7\u00e3o no ap\u00eandice A4 ) sujeito ao conjunto de restri\u00e7\u00f5es de igualdade \ndadas pelas Eq. (4.32) , Eq. (3.12) e pelas restri\u00e7\u00f5es de desigualdade dadas pelas  Eq. \n(4.29) e Eq. (3.13). \n \n \n\n3 ,3 3, ,\nmin 2s i\n\nk k\n\nT TT s i s T s\nk k k k f ku\n\ni i\nk k k\n\nu u\n\nu H C c\n? ?\n\n? ? ? ?\n\n? ?\n?\n\n? ?? ? ? ?? ?\n? ?? ? ? ?? ?? ?? + +? ? ? ?? ?? ? ? ? ? ?? ?\n\n? ? ? ?? ?? ? ? ?? ?\n\n  \n\n              s.a.   \n \n                      ( ) ( ) 0s sp i sk kx k y m t x k D u ?? + ? + ? ? =%                                       (4.32)      \n \n           1,( ) 0\n\ni i i\nm k kx k D u ?+ ? + =                                           (3.12) \n\n                       , , 1l k l kV V ?&lt;%                                                                                   (3.13) \n \n             ( ) ,   0u k j j? + ? ?U                                                                    (4.29) \n\n                       \n\nmax max\n\nmin max\n\n0\n\n( )\n( ) ( ) 0;\n\n( 1) ( ) ; 0,1, , 1\nj\n\ni\n\nu u k j u\nu k j u k j j m\n\nu u k u k i u j m\n=\n\n? ?\n? ??? ? ? + ? ?? ?? ?\n\n= ? + ? + = ?? ?\n? ?\n\n? ? + ? + ? = ?? ?\n? ?? ?\n\n? L\nU:  \n\nonde  \n \n\n   \n\n11 12 13\n\n3 12 22 23\n\n13 23 33\n\nT\n\nT T\n\nH H H\n\nH H H H\n\nH H H\n\n? ?\n? ?\n\n= ? ?\n? ?\n? ?\n\n \n\n  \n~ ~\n\n*\n11\n\nT T\n\nH C Q C AB Q AB R\n== ==\n\n= + +% %         12\nT\n\nH C QI\n==\n\n= ? %               13\nT\n\nH C QT\n==\n\n= ? %  \n\n12\nT TH I Q C\n\n==\n\n= ? %                                       22 1TH I QI S= +%             23 TH I QT= %  \n\n13\nT TH T Q C\n\n==\n\n= ? %                                       23\nT TH T QI= %                 33 2TH T QT S= +%  \n\n \n\n[ ] [ ] [ ]\n~\n\n*\n,3 1 1 1\n\nT T T TT T TT sp T m T sp T sp\nf kk k k\n\nC x C Q C y Q C e A Q AB x C QI y QI x C QT y QT\n== ==? ?= ? + ? + ? +? ?? ?\n\n% % % % % %\n\n \n\n [ ] [ ] [ ] *3 12\nT TT T sp T m m\n\nk kk k k\nc x C QC x y QC x e A Q A e= ? +% %  \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 52 \n\n4.4 Observador de estados para o IHMPC-E \n \n\nQuando o modelo do sistema que est\u00e1 representado dentro do controlador \n\npreditivo est\u00e1 na forma de vari\u00e1veis de estado, temos que necessariamente usar um \n\nobservador de estados que fa\u00e7a a atualiza\u00e7\u00e3o dos mesmos em fun\u00e7\u00e3o dos erros entre as \n\nsa\u00eddas previstas pelo modelo e as sa\u00eddas reais, medidas da planta.  \n\n \n\nCom a utiliza\u00e7\u00e3o do observador de estado, a Eq. (2.2) assume a seguinte forma : \n\n \n\n/ 1 1/ 1 1[ ] [ ]k k k k kx A x B u? ? ? ?= + ?               (4.37) \n\n{ }/ / 1 / 1[ ] [ ] [ ]pk k k k F k k kx x K y C x? ?= + ?              (4.38) \n \n\nonde \n\n \np\nky  - vetor de sa\u00eddas da planta real, medidas no instante k. \n\nFK  - matriz de ganho do observador. \n\n/ 1[ ]k kx ? - vetor dos estados no instante k , com informa\u00e7\u00f5es da planta do instante anterior \n\n/[ ]k kx    - vetor atualizado dos estados, com informa\u00e7\u00f5es da planta do instante atual \n\n \n\nsubstituindo a Eq. (4.37) na Eq. (4.38) : \n\n \n\n/ 1/ 1 1[ ] [( ) ] [ ] [( ) ]\np\n\nk k F k k F k F kx I K C A x I K C B u K y? ? ?= ? + ? ? +                                   (4.39) \n\n \n\nNos controladores preditivos convencionais usa-se a corre\u00e7\u00e3o de estados do \n\nDMC que corresponde a somar o erro da sa\u00edda atual da planta a todas as predi\u00e7\u00f5es \n\nfuturas. Essa estrat\u00e9gia corresponde no caso da nossa representa\u00e7\u00e3o em vari\u00e1veis de \n\nestado a um filtro dado por                      \n\n \n\n \n\n0\n\nny\n\nF\nny\n\nI\n\nK\nI\n\n? ?\n? ?\n? ?=\n? ?\n? ?\n? ?\n\nM\n    1np +  \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 53 \n\nEntretanto, quando o sistema \u00e9 integrador pode-se verificar que o filtro usado \n\npelo DMC n\u00e3o estabiliza os p\u00f3los integradores, ou seja, o modelo de predi\u00e7\u00e3o mais o \n\nobservador torna-se um sistema inst\u00e1vel. \n\n \n\nAssim, utilizaremos como observador de estados no IHMPC-E o filtro de \n\nKalman que far\u00e1 a corre\u00e7\u00e3o dos estados com as sa\u00eddas da planta. \n\n \n\nPara garantir a estabilidade do controlador em malha fechada, o ganho do \n\nobservador, FK , dever\u00e1 ser tal de modo que todos os auto-valores da matriz \n\n[( - ) ]FI K C A estejam dentro do c\u00edrculo unit\u00e1rio, o que corresponder\u00e1 a obten\u00e7\u00e3o de \n\np\u00f3los est\u00e1veis do sistema em malha fechada. \n\n \nPode-se demonstrar (Astrom e Wittenmark, 1990) que para um instante k \n\nsuficientemente grande, o ganho do filtro de Kalman \u00e9 definido pelas seguintes \n\nequa\u00e7\u00f5es : \n\n \n\n( ) 1T TFK APC V CPC\n?\n\n= +              (4.40) \n\n \n1T T T TP APA APC V CPC CPA W\n\n?\n? ?= ? + +? ?            (4.41) \n\n \n\nonde \n\n \n\nV  e W  s\u00e3o matrizes de sintonia do filtro de Kalman \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 54 \n\n4.5 Aplica\u00e7\u00e3o do IHMPC-E a uma coluna de destila\u00e7\u00e3o \n \n \n4.5.1 Descri\u00e7\u00e3o sum\u00e1ria do processo analisado \n \n\nO sistema industrial proposto abaixo para an\u00e1lise em malha fechada com o \n\ncontrolador IHMPC-E, possui caracter\u00edsticas integradoras e tempos mortos em algumas \n\nfun\u00e7\u00f5es de transfer\u00eancia.  \n\n \n\nNesse processo \u00e9 feita a separa\u00e7\u00e3o em coluna de destila\u00e7\u00e3o entre Isobutano + \n\nButenos leves (produto de topo) e n-Butano + Butenos pesados (produto de fundo) a \n\npartir de uma alimenta\u00e7\u00e3o denominada de Carga Olef\u00ednica constitu\u00edda de Isobutano,    \n\n1-Buteno, 2-Buteno, cis-2-Buteno, trans-2-Buteno, n-Butano e n-Pentano. \n\n \n\nAs fun\u00e7\u00f5es de transfer\u00eancia a seguir foram obtidas a partir de testes de \n\nidentifica\u00e7\u00e3o na planta utilizando a rotina ARX (Auto-Regressive with eXogenous \n\ninputs) do software Matlab : \n\n \n\n7\n\n7\n\n2, 3 0, 7\n\n4,7409 1, 4\n9, 32 1 6,83 1\n\n( )\n1, 04 0,1354\n\n17, 06 1 6,83 1\n\n7, 04 1,8\n20, 2 1 4,14 1\n\ns\n\ns\n\ns s\n\ns s\nG s\n\ne\ns s\n\ne\ns s\n\n?\n\n?\n\n?? ?\n? ?\n? ?\n? ?\n? ?+ +\n? ?=\n\n?? ?\n? ?+ +\n? ?\n? ?? ?\n? ?+ +? ?? ?\n\n sendo ( ) ( ) / ( )G s y s u s=  , ( )y s ?  R 4   e   ( )u s  ?  R 2 \n\n \nVari\u00e1veis Controladas \n\n     y 1 N\u00edvel no Vaso de Topo        % \n\n     y 2 Temperatura da Bandeja 68 da coluna        \no C \n\n     y 3 Rela\u00e7\u00e3o Isobutano/Olefinas no produto de topo        v/v \n\n     y 4 Teor de Isobutano no produto de fundo       % (vol.) \n\n \n\nVari\u00e1veis Manipuladas \n\n     u 1 Vaz\u00e3o de Vapor no Refervedor secund\u00e1rio da coluna        ton/h \n\n     u 2 Vaz\u00e3o de Refluxo de topo       km\n3/d  \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 55 \n\nA figura abaixo apresenta um fluxograma de processo simplificado do sistema \n\ncom as malhas de controle convencionais implementadas no SDCD (sistema digital de \n\ncontrole distribu\u00eddo). \n\n \n\nFigura 4.1 \u2013 Esquema de controle convencional da coluna deisobutanizadora \n\n \n\nEm se tratando de coluna de destila\u00e7\u00e3o convencional (uma \u00fanica alimenta\u00e7\u00e3o \n\ncom produtos de topo e de fundo) com 2 vari\u00e1veis manipuladas, fica f\u00e1cil perceber que \n\ntem-se 2 graus de liberdade. Controlando-se y1 (n\u00edvel no vaso de topo) com objetivo de \n\nfechamento din\u00e2mico de balan\u00e7o material na coluna, restar\u00e1 uma especifica\u00e7\u00e3o para \n\nescolha da outra vari\u00e1vel controlada, entre as 3 poss\u00edveis (y2,y3,y4). \n\n \n\nControlando-se uma dessas sa\u00eddas, as outras 2 ser\u00e3o dependentes da controlada \n\nque foi escolhida, que ser\u00e3o informa\u00e7\u00f5es complementares da resposta do processo em \n\nmalha fechada. Nesse caso, as vari\u00e1veis y3 e y4 s\u00e3o infer\u00eancias calculadas em tempo real \n\na partir das condi\u00e7\u00f5es de opera\u00e7\u00e3o do sistema ( vaz\u00f5es, press\u00f5es, temperaturas ), mas \n\npoderiam ser lidas, por exemplo, a partir de um analisador de processo instalado para \n\nessa medi\u00e7\u00e3o. Assim, quando houver indisponibilidade de leitura dessas informa\u00e7\u00f5es \n\n(exemplo: perda de algum instrumento necess\u00e1rio para o c\u00e1lculo ou manuten\u00e7\u00e3o no \n\nanalisador de processo), a temperatura da bandeja 68 (vari\u00e1vel y2) poder\u00e1 ser escolhida \n\ncomo vari\u00e1vel controlada. \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 56 \n\nO destilado, que \u00e9 uma das alimenta\u00e7\u00f5es ao reator da unidade, deve ter uma \n\nespecifica\u00e7\u00e3o adequada de 3y  (rela\u00e7\u00e3o Isobutano/Olefinas) pr\u00f3xima do valor \n\nestequiom\u00e9trico para as rea\u00e7\u00f5es que se processam no mesmo. Assim, essa coluna \n\nchamada de deisobutanizadora, tem a fun\u00e7\u00e3o de remover Isobutano da carga para o \n\ndestilado, por\u00e9m, com uma rela\u00e7\u00e3o Isobutano/Olefinas no produto de topo que n\u00e3o \n\ncomprometa o reator que existe nessa unidade o qual recebe o destilado como carga. O \n\nconhecimento desse processo, mostra que esse sistema possui 2 graus de liberdade para \n\no uso de um controlador preditivo. Assim, um conjunto de controladas desejadas seria \n\n1y  e 3y , ou um outro poss\u00edvel, tal como 1y  e 4y , ou ainda 1y  e 2y .  \n\n \n\nEm processos com grande n\u00famero de vari\u00e1veis controladas, essa an\u00e1lise tende a \n\nser mais complexa, para evitar que ocorram incoer\u00eancias tanto nos pesos relativos das \n\ncontroladas bem como na escolha incorreta das mesmas. \n\n \n\nA figura a seguir apresenta a tela gr\u00e1fica operacional desse sistema no SDCD \n\ncom valores t\u00edpicos do processo em tempo real : \n\n \n \n\nFigura 4.2- Tela gr\u00e1fica operacional da coluna deisobutanizadora no SDCD \n \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 57 \n\n4.5.2 Representa\u00e7\u00e3o da coluna em vari\u00e1veis de estado \n \n\n \n\nConsiderando um intervalo entre amostragens de 1mint? = , horizonte de \n\ncontrole 2m = , horizonte de predi\u00e7\u00e3o 10np =  e usando a Eq.(2.2) para sistemas \n\nintegradores com tempo morto, apresentada na se\u00e7\u00e3o 4.2.2, obt\u00e9m-se a seguinte \n\nrepresenta\u00e7\u00e3o do modelo em vari\u00e1veis de estado na forma incremental : \n\n \n\n[ ] [ ]\n[ ] [ ]\n\n1 kk k\n\nk k\n\nx A x B u\n\ny C x\n\n?\n+\n\n= +\n\n=\n\n \n                                                                                             (2.2) \n\n \n\nonde \n\n \n\n[ ] 1 2 10\nTT T TT T T s d i\n\nk k kx y y y x x x+ + +? ?= \u2026? ?\n56? R                                           (4.8) \n\n \n\n( ) ( )\n\n4\n\n4\n\n4\n*\n\n4\n\n4 4\n\n4\n\n0 0 0 0 0 0\n0 0 0 0 0 0\n\n0 0 0 0 0 0\n0 0 0 0 [ 11 ] [ 11 ]\n0 0 0 0 0\n0 0 0 0 0 0\n0 0 0 0 0 0\n\nI\nI\n\nI\nA\n\nI t I t\nI I t\n\nF\nI\n\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?=\n? ?? ? ?\n? ?\n\n?? ?\n? ?\n? ?\n? ?? ?\n\nL\nL\n\nM M M O M M M M\nL\nL\nL\nL\nL\n\n56,56? R                    (4.9) \n\n0\n2 3 11 [ ] [ ] [ ]...\n\nT\ni d TT T T T T iD F NB S S S D t D D? ?? ?= + ?\n\n56 , 2? R        (4.10)   \n \n\n[ ]4 0 ... 0C I= 4 , 56? R                                                                                   (4.11) \n \n\n4 ([1 1 1 1])I diag=  \n4 , 4? R  \n\n( )\n\n0 0 0 0 0 0 0 0\n0 0 0,3072 0, 3560 0 0 0 0\n\n[ 11 ]\n0 0 0 0 0, 7910 0,1998 0 0\n0 0 0 0 0 0 0,8204 0, 0702\n\nt\n\n? ?\n? ?\n? ?? ? =\n? ?\n? ?\n? ?\n\n4 , 8? R  \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 58 \n\n*\n\n11 0 0 0\n0 11 0 0\n\n[(11) ]\n0 0 4 0\n0 0 0 4\n\nI t\n\n? ?\n? ?\n? ?? =\n? ?\n? ?\n? ?\n\n                                                                              (4.13) \n\n \n\n([0 0 0,8983 0,9104 0,9431 0,8638 0,9517 0, 7854])F diag= 8 , 8? R  \n \n\n0 0\n4, 7409 1, 4\n\n1, 04 0,1354\n7, 04 1,80\n\noD\n\n? ?\n? ?\n? ?=\n? ??\n? ?\n\n? ?? ?\n\n                        \n\n2, 3 0, 7\n0 0\n0 0\n0 0\n\niD\n\n?? ?\n? ?\n? ?=\n? ?\n? ?\n? ?\n\n \n\n \n\n1 0\n0 1\n1 0\n0 1\n1 0\n0 1\n1 0\n0 1\n\nN\n\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?=\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?? ?\n\n \n\n \n\n([0 0 4, 7409 1, 4 1, 04 0,1354 7, 04 1,8])dD diag= ? ? ?  \n\n \n\n2 11S SL  s\u00e3o os coeficientes de resposta ao degrau obtidos atrav\u00e9s da Eq.(2.33) \ncorrespondentes aos instantes de tempo discretos 2, ,11k = L  \n \n \n\n2\n\n4, 6 1, 4\n0,9156 0, 2397\n\n0 0, 0344\n0 0, 6896\n\nTS\n\n?? ?\n? ?\n? ?=\n? ?\n? ?\n\n?? ?\n\n        . . .    11\n\n25, 3 7, 7\n3, 2845 0,9016\n0, 2174 0,1083\n1, 2647 1, 6737\n\nTS\n\n?? ?\n? ?\n? ?=\n? ??\n? ?\n? ?? ?\n\n \n\n \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 59 \n\n4.5.3 Filtro de Kalman para a coluna \n \n \n\n Para garantir a estabilidade do controlador em malha fechada, o filtro de Kalman \n\n( K F ) foi adotado para as corre\u00e7\u00f5es dos estados com a leitura da planta, conforme a Eq \n\n(4.38). Isso foi necess\u00e1rio para que todos os auto-valores da matriz [( - ) ]FI K C A fossem \n\nposicionados dentro do c\u00edrculo unit\u00e1rio, o que resulta em p\u00f3los est\u00e1veis do sistema em \n\nmalha fechada. \n\n \n\n Apresentamos na figura 4.3 os auto-valores da matriz [( - ) ]FI K C A obtidos com \n\no uso do filtro de Kalman para o sistema da coluna apresentado na se\u00e7\u00e3o anterior \n\nfazendo uso das matrizes A  e C   : \n\n \n\n \n\n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n\n \n\nFigura 4.3- Auto-valores da matriz [( - ) ]FI K C A  \n\n \n \n \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 60 \n\n4.5.4 Desempenho do IHMPC-E  \n \n \n4.5.4.1 Caso Nominal  \n \n\nApresentamos a seguir a resposta do processo em malha fechada em fun\u00e7\u00e3o da \n\nvaria\u00e7\u00e3o em \u2018setpoints\u2019 nas vari\u00e1veis controladas 1y  e 3y  com o seguinte conjunto de \n\npar\u00e2metros de sintonia : \n\n \n\n horizonte de controle   2m =   e  4m =  \n supress\u00e3o das manipuladas   ( [0 0] )R diag=  \n peso das controladas   [ ]( 1 1 )Q diag=  \n peso das vari\u00e1veis de folga s?    [ ]1 ( 800 800 )S diag=  \n peso das vari\u00e1veis de folga i?    [ ]2 ( 5 5 )S diag=  \n\n \n              Tabela 4.1 \u2013 Par\u00e2metros de sintonia do IHMPC-E nominal \n \n \n \n \n\nAs condi\u00e7\u00f5es iniciais e restri\u00e7\u00f5es consideradas foram as seguintes : \n \n \n\n[ ]50 % 1, 2 /inicialy vol vol=  \n \n\n34 / 2 /inicialu ton h km d? ?= ? ?  \n\n \n3\n\nmax 4,15 / 2, 6 /u ton h km d? ?= ? ?  \n\n \n3\n\nmin 3,85 / 1, 4 /u ton h km d? ?= ? ?  \n\n \n3\n\nmax 0, 04 / / min 0, 04 / / minu ton h km d? ?? = ? ?  \n\n \n \n\n As figuras 4.4 e 4.5 a seguir mostram um bom comportamento do sistema em \n\nmalha fechada para o caso servo nas controladas 1y (mudan\u00e7a de 50% para 55%) e \n\n3y (mudan\u00e7a de 1,2 para 1,15 v/v) com o IHMPC-E de modelo nominal (planta = ao \n\nmodelo usado internamente no controlador). \n\n \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 61 \n\nFigura 4.4- Controladas 1y  e 3y  com IHMPC-E \n \n \n \n\nFigura 4.5- Manipuladas 1u  e 2u  com IHMPC-E ( caso servo em 1y  e 3y ) \n \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 62 \n\nVemos na figura 4.4 um aparente offset na vari\u00e1vel controlada 3y  para um \n\nhorizonte de controle 2m = . Na mesma figura, vemos que quando esse horizonte \u00e9 \n\naumentado o offset \u00e9 eliminado. \n\n \n\n Na figura 4.6 representamos o comportamento ao longo do tempo da fun\u00e7\u00e3o \n\ncusto 3,kV  dada pela Eq.(4.37). Vemos que no instante 10 min, quando ocorre a varia\u00e7\u00e3o \n\nno \u2018setpoint\u2019 de 1y , 3,kV  assume valores muito altos os quais est\u00e3o relacionados \u00e0 \n\nnecessidade do controlador ter que usar as vari\u00e1veis de folga s? e i?  para manter-se \n\nvi\u00e1vel. A partir desse 3,kV  decresce monotonicamente at\u00e9 o instante 200 mint =  quando \n\n\u00e9 introduzida a varia\u00e7\u00e3o no \u2018setpoint\u2019 de 3y . Nesse ponto, 3,kV  obviamente volta a \n\naumentar, mas o aumento \u00e9 t\u00e3o pequeno que nem pode ser observado na figura. Isso \n\nindica que o controlador n\u00e3o precisou incluir vari\u00e1veis de folga que levam a um grande \n\naumento em  3,kV . \n\nFigura 4.6- Fun\u00e7\u00e3o custo do caso servo em 1y  e 3y  com IHMPC-E  \n \n\nVamos considerar agora a substitui\u00e7\u00e3o no IHMPC-E da vari\u00e1vel controlada \n\n3y (rela\u00e7\u00e3o Isobutano/Olefinas no topo) pela controlada 4y (teor de Isobutano no fundo \n\nda torre). \n\n As figuras 4.7 e 4.8 mostram que tamb\u00e9m nessa configura\u00e7\u00e3o o controlador \n\nIHMPC-E de modelo nominal com as mesmas restri\u00e7\u00f5es nas vari\u00e1veis manipuladas do \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 63 \n\ncaso anterior e mesma sintonia se comporta satisfatoriamente para o caso servo nas \n\ncontroladas 1y (mudan\u00e7a de 50% para 55%) e 4y (mudan\u00e7a de 8% para 7,5%).  \n\nFigura 4.7- Controladas 1y  e 4y  com IHMPC-E  \n \n\nFigura 4.8- Manipuladas 1u  e 2u  com IHMPC-E ( caso servo em 1y  e 4y ) \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 64 \n\nA figura 4.9 mostra que a fun\u00e7\u00e3o 3,kV tem para esse caso um comportamento \n\nsimilar ao comportamento do caso em que as controladas eram 1y  e 3y . Essa fun\u00e7\u00e3o \n\natinge valores muito pr\u00f3ximos de zero a partir do instante 50 min indicando que a partir \n\ndesse ponto as varia\u00e7\u00f5es de folga s? e i?  n\u00e3o s\u00e3o mais necess\u00e1rias. \n\n \n\nFigura 4.9- Fun\u00e7\u00e3o custo do caso servo em 1y  e 4y  com IHMPC-E  \n\n \n \n\nEm seguida consideramos o caso em que os valores de refer\u00eancia das \n\ncontroladas s\u00e3o mantidos fixos no tempo e que h\u00e1 alguma perturba\u00e7\u00e3o no processo.  \n\n \n\nSuponhamos por exemplo que ocorra uma perturba\u00e7\u00e3o instant\u00e2nea na \n\ntemperatura de vapor no refervedor secund\u00e1rio da coluna, causada por um descontrole \n\nqualquer na rede de distribui\u00e7\u00e3o de vapor da unidade. Nesse caso, as fun\u00e7\u00f5es de \n\ntransfer\u00eancia consideradas para essa an\u00e1lise incluindo essa perturba\u00e7\u00e3o que no caso \u00e9 \n\nmedida, foram tamb\u00e9m identificadas atrav\u00e9s de testes na planta e s\u00e3o dadas pela \n\nseguinte matriz ( )dG s  : \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 65 \n\n \n3\n\n0, 2\n\n0,396\n11, 48 1\n\n( )\n0,1295\n\n17, 06 1\n1,176\n\n33, 9 1\n\nd s\n\ns\n\ns\nG s\n\ne\ns\n\ns\n\n?\n\n? ?\n? ?\n? ?\n? ?\n? ?+\n? ?=\n\n?? ?\n? ?+\n? ?\n\n?? ?\n? ?+? ?? ?\n\n   onde    ( ) ( ) ( ) ( ) ( )d dy s G s u s G s u s= +  \n\n \nVari\u00e1veis Controladas \n\n     y 1 N\u00edvel no Vaso de Topo        % \n\n     y 2 Temperatura da Bandeja 68 da coluna        \no C \n\n     y 3 Rela\u00e7\u00e3o Isobutano/Olefinas no produto de topo        v/v \n\n     y 4 Teor de Isobutano no produto de fundo       % (vol.) \n\n \n\nVari\u00e1veis Manipuladas \n\n     u 1 Vaz\u00e3o de Vapor no Refervedor secund\u00e1rio da coluna        ton/h \n\n     u 2 Vaz\u00e3o de Refluxo de topo       km\n3/d  \n\n  \n\nVari\u00e1veis Perturba\u00e7\u00e3o \n\n     1du  Temperatura de fluido quente no refervedor secund\u00e1rio        \u00baC \n\n \n \n\nPara an\u00e1lise do desempenho de rejei\u00e7\u00e3o de perturba\u00e7\u00f5es do IHMPC-E, \n\nconsideremos, para cen\u00e1rio de simula\u00e7\u00e3o, que no instante 20k = , por exemplo, a \n\ntemperatura de fluido quente no refervedor secund\u00e1rio aumente de forma brusca de \n\n90,1 oC  para  91, 3 oC . \n\n \nAs figuras 4.10 e 4.11 a seguir apresentam os resultados dessa simula\u00e7\u00e3o \n\ncombinando \u2018setpoints\u2019 fixos em 1y  e 3y (caso servo) e perturba\u00e7\u00e3o em 1du  (caso \n\nregulador). Vemos que para esse tipo de perturba\u00e7\u00e3o e com a sintonia escolhida, existe \n\numa clara prefer\u00eancia pelo controle de 1y  que retorna ao seu \u2018setpoint\u2019 em menos de 10 \n\nmin, enquanto que 3y  s\u00f3 atinge o valor desejado ap\u00f3s cerca de 60 min. \u00c9 claro que um \n\ncomportamento diferente poderia ser obtido alterando-se a sintonia do controlador, \n\nparticularmente a rela\u00e7\u00e3o entre os pesos das vari\u00e1veis controladas. \n\n \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 66 \n\nFigura 4.10- Controladas 1y  e 3y  em fun\u00e7\u00e3o da perturba\u00e7\u00e3o 1du  com IHMPC-E  \n \n \n \n  \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \nFigura 4.11- Manipuladas 1u  e 2u  em fun\u00e7\u00e3o da perturba\u00e7\u00e3o 1du  com IHMPC-E  \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 67 \n\nNa figura 4.12 vemos o valor da fun\u00e7\u00e3o custo 3,kV  que tamb\u00e9m \u00e9 \n\nmonotonicamente decrescente a partir do instante 20 min, quando entra a perturba\u00e7\u00e3o \n\nno vapor. O aumento abrupto que ocorre nesse instante, mostra que o controlador tem \n\nque lan\u00e7ar m\u00e3o das vari\u00e1veis de folga para se manter vi\u00e1vel. A partir do instante 35 min \n\nas vari\u00e1veis de folga n\u00e3o s\u00e3o mais necess\u00e1rias. \n\nFigura 4.12- Fun\u00e7\u00e3o custo do caso regulador com perturba\u00e7\u00e3o 1du  com IHMPC-E \n\n \n4.5.4.2 Desempenho do IHMPC-E  para incertezas no modelo da planta \n \n\nTomemos como exemplo, incertezas da ordem de 25 % nos ganhos, taxas \n\nintegradoras, constantes de tempo e tempo morto em rela\u00e7\u00e3o ao modelo identificado na \n\nplanta das sa\u00eddas 1y  e 3y  com as entradas 1u  e 2u . Do ponto de vista industrial, esse \n\nn\u00edvel de incerteza j\u00e1 pode ser considerado elevado para esse tipo de coluna de \n\ndestila\u00e7\u00e3o. \n\nincerteza nos ganhos e nas taxas integradoras : \n\n                                        25 % abaixo do nominal             25 % acima do nominal \n\n                                  \n7\n\n1,84 -0,56\n\n( )\n-0,832 0,10832\n17, 06 1 6,83 1\n\nIa s\n\ns s\nG s\n\ne\ns s\n\n?\n\n? ?\n? ?\n? ?=\n? ?\n? ?+ +? ?\n\n           \n7\n\n2,875 -0,875\n\n( )\n-1, 3 0,16925\n\n17,06 1 6,83 1\n\nIb s\n\ns s\nG s\n\ne\ns s\n\n?\n\n? ?\n? ?\n? ?=\n? ?\n? ?+ +? ?\n\n \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 68 \n\nincerteza nas constantes de tempo : \n\n                                         25 % abaixo do nominal             25 % acima do nominal \n\n                                  \n7\n\n2, 3 -0, 7\n\n( )\n-1, 04 0,1354\n\n13, 648 1 5, 464 1\n\nIa s\n\ns s\nG s\n\ne\ns s\n\n?\n\n? ?\n? ?\n? ?=\n? ?\n? ?+ +? ?\n\n         \n7\n\n2.3 -0.7\n\n( )\n-1.04 0.1354\n\n21.325 1 8.5375 1\n\nIb s\n\ns s\nG s\n\ne\ns s\n\n?\n\n? ?\n? ?\n? ?=\n? ?\n? ?+ +? ?\n\n \n\nincerteza no tempo morto : \n\n                                         25 % abaixo do nominal             25 % acima do nominal \n\n                                  \n5,6\n\n2, 3 -0, 7\n\n( )\n-1, 04 0,1354\n17, 06 1 6,83 1\n\nIa s\n\ns s\nG s\n\ne\ns s\n\n?\n\n? ?\n? ?\n? ?=\n? ?\n? ?+ +? ?\n\n            \n8,75\n\n2, 3 -0, 7\n\n( )\n-1, 04 0,1354\n17,06 1 6,83 1\n\nIa s\n\ns s\nG s\n\ne\ns s\n\n?\n\n? ?\n? ?\n? ?=\n? ?\n? ?+ +? ?\n\n \n\n \nVari\u00e1veis Controladas \n\n     y 1 N\u00edvel no Vaso de Topo        % \n\n     y 3 Rela\u00e7\u00e3o Isobutano/Olefinas no produto de topo        v/v \n\n \n\nVari\u00e1veis Manipuladas \n\n     u 1 Vaz\u00e3o de Vapor no Refervedor secund\u00e1rio da coluna        ton/h \n\n     u 2 Vaz\u00e3o de Refluxo de topo       km\n3/d  \n\n \n\nApresentamos a seguir a resposta do processo em malha fechada em fun\u00e7\u00e3o da \n\nvaria\u00e7\u00e3o em \u2018setpoints\u2019 nas vari\u00e1veis controladas 1y  e 3y  com o seguinte conjunto de \n\npar\u00e2metros de sintonia : \n\n horizonte de controle   2m =   \n supress\u00e3o das manipuladas   ( [100 100] )R diag=  \n peso das controladas   [ ]( 1 1 )Q diag=  \n peso das vari\u00e1veis de folga s?    [ ]1 ( 800 800 )S diag=  \n peso das vari\u00e1veis de folga i?    [ ]2 ( 5 5 )S diag=  \n\n \n                  Tabela 4.2 \u2013 Par\u00e2metros de sintonia do IHMPC-E de modelo incerto \n \n\n \n\nVemos que em rela\u00e7\u00e3o aos par\u00e2metros da Tabela 4.1, apenas os pesos nas \n\nvari\u00e1veis manipuladas foram substancialmente aumentados para acomodar as incertezas \n\nno modelo. Isso foi necess\u00e1rio para tornar o controlador mais cauteloso uma vez que as \n\nincertezas n\u00e3o s\u00e3o explicitamente consideradas. \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 69 \n\nAs condi\u00e7\u00f5es iniciais e restri\u00e7\u00f5es consideradas foram as seguintes : \n \n \n\n[ ]50 % 1, 2 /inicialy vol vol=   \n \n\n34 / 2 /inicialu ton h km d? ?= ? ?  \n\n \n3\n\nmax 4,15 / 2, 6 /u ton h km d? ?= ? ?   \n\n \n3\n\nmin 3,85 / 1, 4 /u ton h km d? ?= ? ?  \n\n \n3\n\nmax 0, 04 / / min 0, 04 / / minu ton h km d? ?? = ? ?  \n\n \n \n\n As figuras 4.13 e 4.14 mostram que com essa sintonia o controlador apresenta \n\numa performance bastante satisfat\u00f3ria para o caso servo com varia\u00e7\u00f5es nos \u2018setpoints\u2019 \n\ndas controladas 1y (mudan\u00e7a de 50% para 55%) e 3y (mudan\u00e7a de 1,2 para 1,15 v/v) \n\npara incertezas de 25 % nos ganhos e nas taxas integradoras :  \n\n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \nFigura 4.13-  Controladas 1y  e 3y  com IHMPC-E e incertezas nos ganhos \n \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 70 \n\n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \nFigura 4.14- Manipuladas 1u  e 2u  com IHMPC-E e incertezas nos ganhos \n                     \n \n\nAnalogamente, as figuras 4.15 e 4.16 mostram o comportamento do sistema em \n\nmalha fechada para as mesmas varia\u00e7\u00f5es nos \u2018setpoints\u2019 de 1y  e 3y  com o IHMPC-E \n\ncom incertezas de 25 % nas constantes de tempo. Para essas incertezas, a performance \n\ndo controlador \u00e9 tamb\u00e9m bastante satisfat\u00f3ria. \n\n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \nFigura 4.15- Controladas 1y  e 3y  com IHMPC-E e incertezas nas constantes de tempo \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 71 \n\n                     \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \nFigura 4.16- Manipuladas 1u  e 2u  com IHMPC-E e incertezas nas constantes de tempo \n                     \n \n\nUm comportamento similar foi observado para o caso de incertezas no tempo \n\nmorto presente no sistema. As figuras 4.17 e 4.18 mostram o comportamento do sistema \n\nem malha fechada para o caso servo nas controladas 1y  e 3y  com o IHMPC-E com \n\nincertezas de 25 % no tempo morto entre a controlada 3y  e a manipulada 1u  : \n\n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \nFigura 4.17- Controladas 1y  e 3y  com IHMPC-E e incerteza no tempo morto \n\n\n\nCap\u00edtulo 4 \u2013 IHMPC estendido para sistemas integradores com tempo morto 72 \n\n                    \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \nFigura 4.18- Manipuladas 1u  e 2u  com IHMPC-E e incertza no tempo morto  \n                    \n \n \n \n\nComo resultado final desse exemplo, observamos pelas figuras apresentadas, que \n\ntanto para o caso nominal como tamb\u00e9m para os casos de incertezas no modelo, o \n\nIHMPC-E pode ser aplicado a coluna deisobutanizadora e apresenta um bom \n\ndesempenho tanto para o caso servo como para o caso regulador.  \n\n \n\nObservamos tamb\u00e9m que o procedimento de escolha dos par\u00e2metros de sintonia \n\ndo controlador \u00e9 convencional, praticamente n\u00e3o exigindo esfor\u00e7o de muitas tentativas \n\nno sentido de obter-se uma performance satisfat\u00f3ria. \n\n \n \n\n\n\n 73 \n\n Cap\u00edtulo 5 \n\nAplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo \n\n \n\nUm dos fatores motivantes deste trabalho foi o estudo do controle do sistema de \n\nprodu\u00e7\u00e3o de \u00f3xido de eteno j\u00e1 estudado em trabalhos anteriores por Cano (2001) e por \n\nRodrigues e Odloak (2003). Esse sistema tem a caracter\u00edstica de apresentar um grande \n\nn\u00famero de p\u00f3los integradores ao lado de p\u00f3los est\u00e1veis. \n\n \n\nUma altera\u00e7\u00e3o na estrutura do sistema de controle que havia sido estudado \n\nanteriormente por Rodrigues e Odloak (2003) levou ao aparecimento de tempos mortos \n\nnas v\u00e1rias fun\u00e7\u00f5es de transfer\u00eancia, tanto nas integradoras como nas est\u00e1veis. \n\n \n\nA seguir faremos uma breve descri\u00e7\u00e3o desse sistema antes de apresentar a \n\nconfigura\u00e7\u00e3o de controle que ser\u00e1 estudada, bem como as fun\u00e7\u00f5es de transfer\u00eancia \n\nobtidas experimentalmente. \n\n \n\n \n5.1 Descri\u00e7\u00e3o sum\u00e1ria do processo de \u00f3xido de eteno e seu problema de controle \n \n \n\nO processo \u00e9 dividido em tr\u00eas \u00e1reas principais integradas entre si, atrav\u00e9s de uma \n\ncorrente de reciclo ao reator, que s\u00e3o as \u00e1reas de rea\u00e7\u00e3o, de purifica\u00e7\u00e3o do \u00f3xido de \n\neteno e a de remo\u00e7\u00e3o de CO2. Maiores detalhes do processo podem ser vistos em Cano \n\n(2001) e em Rodrigues e Odloak (2003). \n\n \n\nA rea\u00e7\u00e3o principal \u00e9 a oxida\u00e7\u00e3o do etileno em fase vapor  catalisada por \u00f3xido de \n\nprata, representada pela seguinte equa\u00e7\u00e3o qu\u00edmica : \n\n2\n2 4 2 2 4\n\n1\n2\n\nAg OC H O C H O+ ????  \n\n \n\nUma rea\u00e7\u00e3o secund\u00e1ria e indesej\u00e1vel \u00e9 a combust\u00e3o completa do etileno : \n\n2 4 2 2 23 2 2C H O CO H O+ ??? +\n\n\n\nCap\u00edtulo 5 \u2013 Aplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo 74 \n\nOxig\u00eanio de alta pureza, nitrog\u00eanio, inibidor de combust\u00e3o (DCE, dicloroetano) \n\ne etileno s\u00e3o misturados com o g\u00e1s de reciclo e enviados ao reator catal\u00edtico. Como as \n\nrea\u00e7\u00f5es s\u00e3o altamente exot\u00e9rmicas, a temperatura de rea\u00e7\u00e3o \u00e9 controlada resfriando-se o \n\nreator com fluido t\u00e9rmico, com a gera\u00e7\u00e3o de vapor d`\u00e1gua de m\u00e9dia press\u00e3o. O efluente \n\ndo reator \u00e9 resfriado, aquecendo a corrente de reciclo que entra no reator. Em seguida, o \n\nefluente do reator em fase vapor \u00e9 enviado a uma coluna de absor\u00e7\u00e3o onde o \u00f3xido de \n\neteno \u00e9 absorvido em \u00e1gua. O g\u00e1s remanescente \u00e9 ent\u00e3o comprimido e reciclado ao \n\nreator.  \n\n \n\nPara evitar o ac\u00famulo de CO2 no sistema, uma parte do g\u00e1s de reciclo \u00e9 enviada \n\na um sistema de remo\u00e7\u00e3o de CO2, onde o di\u00f3xido de carbono \u00e9 absorvido quimicamente \n\npor uma solu\u00e7\u00e3o de carbonato de pot\u00e1ssio. Na sequ\u00eancia, o CO2 \u00e9 removido da solu\u00e7\u00e3o \n\ncom vapor de processo, que \u00e9 purgado para a atmosfera juntamente com o di\u00f3xido de \n\ncarbono. Para evitar o acumulo de inertes (Ar, N2 e C2H6) presentes no g\u00e1s de reciclo, \n\numa pequena purga de g\u00e1s, isento de \u00f3xido de eteno \u00e9 feita. \n\n \n\nA figura 5-1 a seguir apresenta um fluxograma simplificado do processo, \n\nconforme Rodrigues e Odloak (2003). \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nFigura 5.1- Fluxograma simplificado do processo de oxida\u00e7\u00e3o catal\u00edtica de etileno  \n\n\n\nCap\u00edtulo 5 \u2013 Aplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo 75 \n\nO controlador IHMPC-E a ser analisado, ter\u00e1 na sua estrutura 4 vari\u00e1veis \n\ncontroladas e 5 vari\u00e1veis manipuladas. Apresentamos a seguir, com base em testes de \n\nidentifica\u00e7\u00e3o executados na planta conforme Rodrigues et al (2004) sobre projeto de \n\ndesenvolvimento de controladores avan\u00e7ados para reator de \u00f3xido de etileno, a matriz \n\nde fun\u00e7\u00f5es de transfer\u00eancia entre as vari\u00e1veis, ( )pG s  :  \n\n4 3 3 2 2 2 6\n\n2 2 2\n\n4 3 4 8 3 2\n\n2\n\n10 ( 95 1) 2,3 10 3,2 10 ( 1) 3,5 10 ( 0,14 1) 7,5 10\n32,16 4,65 1 64,55 8,83 1 73,23 6,74 1\n\n1,69 10 2,1 10 1,9 10 (1,47 1) 5,47 10 ( 1)\n9,67 13,55 1\n\ns s s\n\ns s\n\ns e s e s e\ns s s s s s s s\n\ne e s s e\ns s s s\n\n? ? ? ? ? ? ? ?\n\n? ? ? ? ? ?\n\n? ? + ? \u00d7 ? \u00d7 ? + ? \u00d7 ? + ? \u00d7\n+ + + + + +\n\n? \u00d7 \u00d7 ? \u00d7 + ? \u00d7 +\n+ +\n\n6 4\n\n2\n\n3 4 5 15 3 2 4 3 10\n\n2 2 2\n\n5 4 5 8\n\n1,07 10\n3,91 10,31 1\n\n8,1 10 ( 0,02 1) 5,5 10 9,6 10 ( 1) 0,13( 2,66 1) 2,53 10\n52,45 11,92 1 54,42 6,58 1 55,11 7,84 1 25 1\n\n3,9 10 5,7 10 1,4 1\n\ns\n\ns s s s s\n\ns s\n\ns s s\n\ns e e s e s e e\ns s s s s s s s\n\ne e\ns s\n\n? ?\n\n? ? ? ? ? ? ? ? ?\n\n? ? ? ?\n\n? \u00d7\n+ +\n\n\u00d7 ? + ? \u00d7 \u00d7 + ? + ? \u00d7\n+ + + + + + +\n\n? \u00d7 \u00d7 ? \u00d7 3 2 6 5 6\n2 2\n\n0 ( 1) 4,39 10 ( 1) 7,6 10\n8,67 14,48 1 7,79 43,41 1\n\ns ss s e e\ns s s s s\n\n? ? ? ? ?\n\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?+ ? \u00d7 + \u00d7? ?\n? ?+ + + +? ?\n\n \n\n                                                                                                                                   (5.1) \n\nsendo ( ) ( ) / ( )pG s y s u s=  , ( )y s ?  R 4   e   ( )u s  ?  R 5 \n\nVari\u00e1veis Controladas \n\n     y 1 Teor de O2 no G\u00e1s de Reciclo na entrada do reator         % \n\n     y 2 Teor de C2H4 no G\u00e1s de Reciclo na entrada do reator          % \n\n     y 3 Temperatura do \u00d3leo T\u00e9rmico na entrada do reator \n           o C \n\n     y 4 Press\u00e3o do G\u00e1s de Reciclo na entrada do reator      kg/cm\n2g \n\n \n\nVari\u00e1veis Manipuladas \n\n     u 1 Vaz\u00e3o de O2 ao reator      kg/h \n\n     u 2 Vaz\u00e3o de C2H4 ao reator      kg/h \n\n     u 3 Abertura da v\u00e1lvula pequena de \u00d3leo T\u00e9rmico         % \n\n     u 4 Abertura da v\u00e1lvula grande de \u00d3leo T\u00e9rmico         % \n\n     u 5 Vaz\u00e3o de N2 ao reator      kg/h \n\n \n\nComo podemos verificar no modelo apresentado em (5.1), a vari\u00e1vel controlada \n\n1y  \u00e9 integradora sem tempo morto em rela\u00e7\u00e3o \u00e0s manipuladas 2u  e 5u . No entanto, a \n\ncontrolada 2y  \u00e9 integradora em rela\u00e7\u00e3o \u00e0s manipuladas 1u , 2u  e 5u  com tempos mortos \n\ndiferentes entre si. O mesmo fato repete-se para a controlada 4y (integradora com 1u , 2u  \n\ne 5u ). \n\n\n\nCap\u00edtulo 5 \u2013 Aplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo 76 \n\n5.2 Modelo em vari\u00e1veis de estado em sistemas integradores com tempos mortos \ndiferentes \n \n \n\n Para o modelo nominal, consideramos que para cada sa\u00edda exista o mesmo \n\ntempo morto em todas as entradas que eram integradoras. Agora, de uma maneira mais \n\ngen\u00e9rica, vamos considerar que existam tempos mortos diferentes entre cada sa\u00edda e as \n\nentradas que s\u00e3o integradoras. Tomando como exemplo, consideremos uma sa\u00edda 1y  \n\nque tenha tempos mortos diferentes com duas entradas 1u  e 2u , conforme a seguinte \n\nfun\u00e7\u00e3o de transfer\u00eancia : \n\n \n\n1,1 1,2\n1,1 1,2\n\n1 1 2\n1,1,1 1,1,2 1,2,1 1,2,2\n\n( ) ( )\n( )( ) ( )( )\n\ns sk e k e\ny u s u s\n\ns s r s r s s r s r\n\n? ?? ?\n\n= +\n? ? ? ?\n\n \n\n \n\nassim, as respostas ao degrau de 1y  em rela\u00e7\u00e3o \u00e0s entradas 1u  e a 2u  s\u00e3o dadas por  \n\n \n\n1,1,1 1,1 1,1,2 1,1( ) ( )0\n1,1 1,1 1,1,1 1,1,2 1,1 1,1( ) ( )\n\nr t r td d iS t d d e d e d t? ? ?? ?= + + + ?  \n\n \n\n1,2,1 1,2 1,2,2 1,2( ) ( )0\n1,2 1,2 1,2,1 1,2,2 1,2 1,2( ) ( )\n\nr t r td d iS t d d e d e d t? ? ?? ?= + + + ?  \n\n \n\na trajet\u00f3ria da sa\u00edda 1y  \u00e9 ent\u00e3o representada da seguinte forma : \n\n \n\n1,1,1 1,1 1,1,2 1,1 1,2,1 1,2 1,2,2 1,2( ) ( ) ( ) ( )\n1 1 1 2 3 4\n\n1 1,1 2 1,2\n\n( ) [ ] [ ] [ ] [ ] [ ]\n\n[ ] ( ) [ ] ( )\n\nr t r t r t r ts d d d d\nk k k k k\n\ni i\nk k\n\ny t x x e x e x e x e\n\nx t x t\n\n? ? ? ?\n\n? ?\n\n? ? ? ?= + + + + +\n\n+ ? + ?\n \n\n \n\nDessa forma, a atualiza\u00e7\u00e3o dos estados sx  , dx  e ix  seguindo as equa\u00e7\u00f5es \n\n(2.20), (2.21) e (2.22) apresentadas no cap\u00edtulo 2 \u00e9 a seguinte : \n\n \n0 0\n\n1 1 1 1,1 1 1,2 2 1,1 1 1,2 2[ ] [ ] ( ) ( ) ( ) ( )\ns s i i\n\nk kx x d u k d u k td u k td u k+ = + ? + ? + ? ? + ? ?  \n\n \n\n1,1,1 1,1,1\n1 1 1 1,1,1 1[ ] [ ] ( )\n\nr t r td d d\nk kx e x d e u k\n\n? ?\n+ = + ?  \n\n\n\nCap\u00edtulo 5 \u2013 Aplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo 77 \n\n1,1,2 1,1,2\n2 1 2 1,1,2 1[ ] [ ] ( )\n\nr t r td d d\nk kx e x d e u k\n\n? ?\n+ = + ?  \n\n \n\n1,2,1 1,2,1\n3 1 3 1,2,1 2[ ] [ ] ( )\n\nr t r td d d\nk kx e x d e u k\n\n? ?\n+ = + ?  \n\n \n\n1,2,2 1,2,2\n4 1 4 1,2,2 2[ ] [ ] ( )\n\nr t r td d d\nk kx e x d e u k\n\n? ?\n+ = + ?  \n\n \n\n1 1 1 1,1 1[ ] [ ] ( )\ni i i\n\nk kx x d u k+ = + ?  \n\n \n\n2 1 2 1,2 2[ ] [ ] ( )\ni i i\n\nk kx x d u k+ = + ?  \n\n \n\nObserva-se por esse exemplo que o estado ix  para uma sa\u00edda 1y  \u00e9 igual ao \n\nn\u00famero de entradas. \n\n \n\n Para o caso multivari\u00e1vel, a generaliza\u00e7\u00e3o \u00e9 feita na fun\u00e7\u00e3o * ( )I t  no instante de \n\ntempo ( 1)np t+ ?  modificando a Eq. (4.13) vista anteriormente : \n\n \n\n11 1\n\n21 2*\n\n1 .\n\n0 0 0 0 0 0\n0 0 0 0 0 0\n\n( )\n\n0 0 0 0 0 0\n\nnu\n\nnu\n\nny ny nu\n\nn t n t\nn t n t\n\nn t\n\nn t n t\n\n? ?\n? ?\n\n? ?\n\n? ? ? ?? ?\n? ?? ? ? ?? ?? ? =\n? ?\n? ?\n\n? ? ? ?? ?? ?\n\nL L L L\nL L L L\n\nM L M M L M O O O M L M\nL L L L\n\n \n\n                                                                                                                      (5.17) \n\nonde *[( 1) ]np t? + ? , .ny nu ny? R  \n \n\nDa\u00ed, a representa\u00e7\u00e3o generalizada em vari\u00e1veis de estado, \u00e9 representada na \n\nseguinte forma : \n\n \n[ ] [ ]\n[ ] [ ]\n\n1 kk k\n\nk k\n\nx A x B u\n\ny C x\n\n?\n+\n\n= +\n\n=\n\n \n                                                                                             (2.2) \n\nonde \n\n[ ] 1 2\nTT T TT T T s d i\n\nk k k npx y y y x x x+ + +? ?= \u2026? ?\n                                               (5.18) \n\n\n\nCap\u00edtulo 5 \u2013 Aplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo 78 \n\n( ) ( )*\n\n.\n\n0 0 0 0 0 0\n0 0 0 0 0 0\n\n0 0 0 0 0 0\n0 0 0 0 [ 1 ] [ 1 ]\n\n\u02c60 0 0 0 0\n0 0 0 0 0 0\n0 0 0 0 0 0\n\nny\n\nny\n\nny\n\nny\n\nny\n\nny nu\n\nI\nI\n\nI\nA\n\nI np t np t\n\nI I t\nF\n\nI\n\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?= ? ?? + ? ? + ?\n? ?\n\n?? ?\n? ?\n? ?\n? ?? ?\n\nL\nL\n\nM M M O M M M M\nL\nL\nL\nL\nL\n\n                    (5.19) \n\n \n\n0\n2 3 1 [ ] [ ] [ ]...\n\nT\ni d i TT T T T T\n\nnp D F N D NB S S S D t D+? ?? ?= + ?                (5.20)   \n\n \n\n0 ... 0nyC I? ?= ? ?                                                                                                (5.21) \n\n \n\n.\n\n1 1 0 0 0 0 0 0\n0 0 1 1 0 0 0 0\u02c6\n\n0 0 0 0 0 0 1 1\nny nu ny\n\nI\n\n\u00d7\n\n? ?\n? ?\n? ?=\n? ?\n? ?\n? ?\n\nL L L L\nL L L L\n\nM L M M L M O O O M L M\nL L L L\n\n \n\n \n\nnu\n\nnu\n\nnu\n\nI\nI\n\nN\n\nI\n\n? ?\n? ?\n? ?=\n? ?\n? ?\n? ?? ?\n\nM      ny          \n\n \n\n( )1,1 1, 2,1 2, ,1 ,i i i i i i inu nu ny ny nuD diag d d d d d d? ?= ? ?L L L L  \n \n\n \n\nCom isso, o modelo descrito acima descrever\u00e1 rigorosamente qualquer sistema \n\ncom integradores e tempos mortos. Entretanto, pode-se verificar que esse modelo n\u00e3o \u00e9 \n\ndetect\u00e1vel, ou seja, nem todos os estados conseguir\u00e3o ser detectados pelas sa\u00eddas.  \n\n \n\nDa literatura de controle (Sontag,1998), define-se como sistema detect\u00e1vel \n\naquele para o qual \u00e9 poss\u00edvel determinar um observador de estado tal que todos os auto-\n\nvalores da matriz [( - ) ]FI K C A estejam dentro do c\u00edrculo unit\u00e1rio.  \n\n\n\nCap\u00edtulo 5 \u2013 Aplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo 79 \n\nPode-se demonstrar que um sistema observ\u00e1vel \u00e9 tamb\u00e9m detect\u00e1vel e existem \n\ncrit\u00e9rios simples para verificar a observabilidade de um sistema. A seguir passaremos a \n\napresentar uma breve revis\u00e3o sobre o assunto. \n\n \n \n5.3 Conceitos de observabilidade de um sistema  \n \n \n\nUm sistema \u00e9 dito observ\u00e1vel , se cada estado (0)x  puder ser determinado a \n\npartir das sa\u00eddas ( )y t  em um intervalo finito de tempo 0 ft t? ? .Para um sistema ser \n\nobserv\u00e1vel, a seguinte matriz deve ter seu rank igual ao n\u00famero de estados do sistema :  \n\n \n2 1( ) ( )T T T T T T nd TC A C A C A C?? ?? ?L                                                         (5.22) \n\n \nTomemos como exemplo inicial dessa an\u00e1lise o modelo integrador  apresentado \n\nno cap\u00edtulo 2, se\u00e7\u00e3o 2.4 cuja matriz de fun\u00e7\u00f5es de transfer\u00eancia \u00e9 dada abaixo : \n\n1,1 1,2\n\n2,1 2,2\n\n0,19 1, 7\n( ) ( ) 19, 5 1\n\n( ) ( ) / ( )\n( ) ( ) 0, 763 0, 235\n\n31, 8 1\n\nG s G s s s\nG s y s u s\n\nG s G s\ns s\n\n? ?? ?\n? ?? ? +\n? ?= = =? ? ?? ?? ?\n? ?+? ?\n\n \n\n \n\ntemos nesse caso 6nd = (estados), obtendo-se a seguinte matriz resultante da Eq.(5.22): \n\n \n2 3 4 5( ) ( ) ( ) ( )T T T T T T T T T T TC A C A C A C A C A C? ? =? ?  \n\n1 0 1 0 1 0 1 0 1 0 1 0\n0 1 0 1 0 1 0 1 0 1 0 1\n1 0 0,95 0 0,9025 0 0,8574 0 0,8145 0 0, 7738 0\n0 1 0 0,969 0 0,939 0 0,9099 0 0,8816 0 0,8543\n0 0 1 0 2 0 3 0 4 0 5 0\n0 0 0 1 0 2 0 3 0 4 0 5\n\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?? ?\n cujo rank \u00e9 6. \n\n \n\nPortanto, esse sistema \u00e9 observ\u00e1vel, ou seja, todos os estados podem ser \n\ndeterminados a partir das sa\u00eddas ( )y t . \n\n\n\nCap\u00edtulo 5 \u2013 Aplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo 80 \n\nConsideramos agora para an\u00e1lise um sistema que possua integradores de tempos \n\nmortos diferentes para uma dada sa\u00edda em rela\u00e7\u00e3o \u00e0s entradas. Seja por exemplo um \n\ntempo morto de 1 minuto para a sa\u00edda 1y  com a entrada 1u  no seguinte sistema : \n\n \n\n1,1 1,2\n\n2,1 2,2\n\n0,19 1, 7\n( ) ( )\n\n( ) ( ) / ( )\n( ) ( ) 0, 763 0, 235\n\n31, 8 1\n\nse\nG s G s s sG s y s u s\nG s G s\n\ns s\n\n?? ?? ?\n? ?? ?\n? ?= = =? ? ?? ?? ?\n? ?+? ?\n\n \n\n \n\nPara um intervalo de amostragens de 1 mint? = , horizonte de controle 1m = , \n\nhorizonte 2np =  e usando a Eq.(2.2) para sistemas integradores com tempo morto, \n\napresentado no cap\u00edtulo 4, se\u00e7\u00e3o 4.2.2, obtem-se as seguintes matrizes A  e C  do \n\nmodelo : \n\n \n\n0 0 1 0 0 0 0 0 0 0 0 0\n0 0 0 1 0 0 0 0 0 0 0 0\n0 0 0 0 1 0 0 0 0 0 2 0\n0 0 0 0 0 1 0 0 0,91 0 0 3\n0 0 0 0 1 0 0 0 0 0 1 0\n0 0 0 0 0 1 0 0 0 0 0 1\n0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0,969 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 1 0\n0 0 0 0 0 0 0 0 0 0 0 1\n\nA\n\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?= ? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?? ?? ?\n\n , 1 0 0 0 0 0 0 0 0 0 0 0\n0 1 0 0 0 0 0 0 0 0 0 0\n\nC\n? ?\n\n= ? ?\n? ?\n\n \n\nteremos nesse caso 12nd = (estados) com a seguinte matriz resultante da Eq.(5.22) : \n\n2 3 11( ) ( ) ... ( )T T T T T T T T TC A C A C A C A C? ?? ?\n1 2 , 2 4? R  cujo rank \u00e9 9, sendo ent\u00e3o \n\nesse sistema n\u00e3o observ\u00e1vel, ou seja, nem todos os estados podem ser determinados a \n\npartir das sa\u00eddas ( )y t . \n\n \n\nAssim, n\u00e3o ser\u00e1 poss\u00edvel aplicar um controlador MPC nominal de horizonte \n\ninfinito para o sistema de \u00f3xido apresentado pela Eq.(5.1), pois o modelo apresenta \n\nalguns estados n\u00e3o-detect\u00e1veis em fun\u00e7\u00e3o de p\u00f3los integradores com tempos mortos \n\ndiferentes. Assim, h\u00e1 a necessidade de se usar um modelo aproximado que seja \n\ndetect\u00e1vel. \n\n\n\nCap\u00edtulo 5 \u2013 Aplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo 81 \n\n5.4 Controle do sistema industrial de \u00f3xido de eteno com modelos aproximados  \n \n\n \n\nPara a aplica\u00e7\u00e3o do IHMPC-E em sistemas integradores com tempos mortos \n\ndiferentes, faremos a aproxima\u00e7\u00e3o das din\u00e2micas integradoras com diferentes tempos \n\nmortos por din\u00e2micas de primeira ordem. Essa aproxima\u00e7\u00e3o consiste em aproximar a \n\nresposta em rampa de cada integrador para uma perturba\u00e7\u00e3o em degrau at\u00e9 instantes \n\npr\u00f3ximos de 400 minutos. Esse tempo foi escolhido a priori para que o sistema em \n\nmalha fechada n\u00e3o apresente respostas muito r\u00e1pidas, por conveni\u00eancia desse tipo de \n\nprocesso qu\u00edmico. Obviamente outros tempos poderiam ser escolhidos. Qualquer que \n\nseja a aproxima\u00e7\u00e3o adotada, o controlador n\u00e3o ter\u00e1 a sua estabilidade garantida, pois, o \n\nmesmo n\u00e3o ser\u00e1 mais o do caso nominal, visto no cap\u00edtulo anterior.  \n\n \n\nCom essa abordagem, as restri\u00e7\u00f5es de igualdade dada pela Eq.(3.12) e de \n\ndesigualdade dada pela Eq.(3.13) deixam de existir, ficando o problema de controle do \n\ntipo quadr\u00e1tico cuja solu\u00e7\u00e3o \u00e9 feita por programa\u00e7\u00e3o quadr\u00e1tica (QP), resolvida mais \n\nrapidamente ao inv\u00e9s de um problema do tipo programa\u00e7\u00e3o n\u00e3o-linear (NLP) \n\nsolucionado por programa\u00e7\u00e3o quadr\u00e1tica sucessiva (SQP).  \n\n \n\nApresentamos ent\u00e3o a matriz de fun\u00e7\u00f5es de transfer\u00eancia, ( )mG s que ser\u00e1 usada \n\ncomo modelo no controlador : \n\n \n4 3 2 2 2\n\n2 2 2\n\n3 8 3\n\n2\n\n10 ( 95 1) 0,0117 3,2 10 ( 1) 3,5 10 ( 0,14 1) 0,0047\n32,16 4,65 1 385 1 64,55 8,83 1 73,23 6,74 1 425 1\n\n0,082 0,1155 1,9 10 (1,47 1) 5,47\n300 1 400 1 9,67 13,55 1\n\ns s s\n\ns s\n\ns e s e s e\ns s s s s s s s\n\ne e s\ns s s s\n\n? ? ? ? ? ?\n\n? ? ?\n\n? ? + ? ? \u00d7 ? + ? \u00d7 ? + ?\n+ + + + + + + +\n\n? ? \u00d7 + ? \u00d7\n+ + + +\n\n2 6\n\n2\n\n3 4 15 3 2 4 3 10\n\n2 2 2\n\n4\n\n10 ( 1) 0,0589\n3,91 10,31 1 400 1\n\n8,1 10 ( 0,02 1) 0,0303 9,6 10 ( 1) 0,13( 2,66 1) 2,53 10\n52,45 11,92 1 400 1 54,42 6,58 1 55,11 7,84 1 25 1\n\n0,0205 0\n400 1\n\ns\n\ns s s s s\n\ns\n\ns e\ns s s\n\ns e e s e s e e\ns s s s s s s s\n\ne\ns\n\n? ?\n\n? ? ? ? ? ? ? ?\n\n?\n\n+ ?\n+ + +\n\n\u00d7 ? + ? \u00d7 + ? + ? \u00d7\n+ + + + + + + +\n\n?\n+\n\n8 3 2 6 6\n\n2 2\n\n,0314 1,4 10 ( 1) 4,39 10 ( 1) 0,0418\n400 1 8,67 14,48 1 7,79 43,41 1 400 1\n\ns s se s s e e\ns s s s s s\n\n? ? ? ? ?\n\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?? \u00d7 + ? \u00d7 +? ?\n? ?+ + + + + +? ?\n\n \n\n \n\n \n\nA figura 5.1 apresenta os auto-valores da matriz [( ) ]FI K C A?  usando o filtro de \n\nKalman, FK , como observador de estados para a corre\u00e7\u00e3o dos estados do modelo com a \n\nleitura das sa\u00eddas da planta : \n\n\n\nCap\u00edtulo 5 \u2013 Aplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo 82 \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nFigura 5.1- Auto-valores da matriz [( ) ]FI K C A?  \n\n \n\n \n\nVamos estudar a resposta do processo em malha fechada para alguns casos de \n\nrastreabilidade nos valores de refer\u00eancia das vari\u00e1veis controladas e de rejei\u00e7\u00e3o de \n\nperturba\u00e7\u00e3o, com o seguinte conjunto de par\u00e2metros de sintonia : \n\n \n\n horizonte de controle   5m =  e 10m =   \n supress\u00e3o das manipuladas   310 nuR I\n\n?=  \n peso das controladas   nyQ I=  \n\n peso das vari\u00e1veis de folga s?    41 10 nyS I=  \n \n             \n                     Tabela 5.1 \u2013 Par\u00e2metros de sintonia do IHMPC-E de modelo incerto \n\n \n \nAs condi\u00e7\u00f5es iniciais e restri\u00e7\u00f5es consideradas foram as seguintes : \n\n \n \n\n0 2\n2 2 46, 5 % 20 % 251 19, 5 /\n\ninicialy O C H C kg cm? ?= ? ?   \n\n \n[ ]2 2 4 26300 / 5100 / 50 % 30 % 60 /inicialu kg h O kg h C H kg h N=  \n\n\n\nCap\u00edtulo 5 \u2013 Aplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo 83 \n\n[ ]max 2 2 4 26900 / 5700 / 100 % 30, 02 % 95 /u kg h O kg h C H kg h N=  \n \n\n[ ]min 2 2 4 25700 / 4500 / 0 % 29, 98 % 25 /u kg h O kg h C H kg h N=  \n \n\n[ ]max 25 / / min 25 / / min 2 % / min 0, 01 % / min 10 / / minu kg h kg h kg h? =  \n \n \n\nAs figuras 5.2 e 5.3 apresentam a \u2018resposta\u2019 do processo para uma mudan\u00e7a na \n\ncomposi\u00e7\u00e3o do g\u00e1s de reciclo, subindo o teor de 2O  de 6, 5 %  para 6,8 %  ( 1\nspy ) e \n\nreduzindo o teor de 2 4C H de 20 % para 19, 7 %  ( 2\nspy ). Observa-se um desempenho \n\nsimilar para horizontes de controle 5m =  e 10m = . Notamos que a utiliza\u00e7\u00e3o de \n\naproxima\u00e7\u00f5es para as fun\u00e7\u00f5es de transfer\u00eancia integradoras por fun\u00e7\u00f5es de transfer\u00eancia \n\nest\u00e1veis torna a malha fechada bastante lenta, sendo necess\u00e1rio cerca de 300 min para \n\nque as controladas se aproximem dos valores desejados.  \n\n \n\nFigura 5.2- Varia\u00e7\u00e3o na composi\u00e7\u00e3o do g\u00e1s de reciclo : setpoints 1y  e 2y  \n\n \n\n\n\nCap\u00edtulo 5 \u2013 Aplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo 84 \n\nFigura 5.3- Manipuladas para o caso servo em 1y  e 2y  \n\n \n\n \n\nA figura 5.4 apresenta a fun\u00e7\u00e3o custo referente \u00e0 mudan\u00e7a citada na composi\u00e7\u00e3o \n\ndo g\u00e1s de reciclo.  \n\n \n\nObserva-se pela figura que a fun\u00e7\u00e3o n\u00e3o \u00e9 mais decrescente no tempo, pois, o \n\nmodelo deixou de ser o nominal. Para enfatizar o comportamento n\u00e3o monot\u00f4nico da  \n\nfun\u00e7\u00e3o custo do controlador, s\u00e3o apresentadas duas figuras com escalas diferentes para \n\n3,kV . Vemos que embora essa fun\u00e7\u00e3o tende para zero para valores altos de tempo, em \n\ninstantes intermedi\u00e1rios ela passa por m\u00e1ximos e m\u00ednimos.  \n\n \n\nFica claro ent\u00e3o que o IHMPC-E com modelos aproximados perde a propriedade \n\nde estabilidade. \n\n \n\n \n\n \n\n \n\n\n\nCap\u00edtulo 5 \u2013 Aplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo 85 \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n \n \n \nFigura 5.4- Fun\u00e7\u00e3o custo do caso servo em  1y  e 2y  \n \n\n \n\nPara verificar o efeito do peso das vari\u00e1veis de folga no desempenho do \n\ncontrolador IHMPC-E, mostramos na figura 5.5 para horizonte de controle 5m = , a \n\ncompara\u00e7\u00e3o dos valores da matriz 1S  adotada originalmente, \n4\n\n1 10 nyS I=  , com uma \n\nnova matriz 1S  dada por 1 800 nyS I= . Pode-se observar que o desempenho \u00e9 bem \n\nparecido.  \n\n \n\nEmbora valores mais altos no peso, tendem a melhorar ligeiramente a \n\nperformance do controlador, essa melhora n\u00e3o \u00e9 suficiente para tornar o controlador \n\nmais r\u00e1pido.  \n\n \n\n \n\n \n\n \n\n \n\n \n\n\n\nCap\u00edtulo 5 \u2013 Aplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo 86 \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nFigura 5.5- Efeito do peso das vari\u00e1veis de folga no desempenho do IHMPC-E \n\n \n\n \n\nA seguir, apresentamos nas figuras 5.6 e 5.7 as respostas do sistema com o \n\nIHMPC-E para uma mudan\u00e7a na temperatura do \u00f3leo t\u00e9rmico na entrada do reator. O \n\nvalor de refer\u00eancia dessa vari\u00e1vel passa de 251 oC  para 251, 5 oC  ( 3\nspy ), mantendo os \n\n\u2018setpoints\u2019 das demais controladas nos valores originais, ou seja, 1 6, 5 %\nspy = , \n\n2 20 %\nspy =  e 24 19, 5 /\n\nspy kg cm= .  \n\n \n\nObservamos novamente, um comportamento muito lento do controlador e \n\nsemelhante aos casos anteriores, tanto para 5m =  como 10m =   : \n\n \n\n \n\n \n\n \n\n \n\n\n\nCap\u00edtulo 5 \u2013 Aplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo 87 \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nFigura 5.6- Varia\u00e7\u00e3o na temperatura de \u00f3leo t\u00e9rmico : setpoint 3y  \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nFigura 5.7 Manipuladas para o caso servo em 3y  \n\n\n\nCap\u00edtulo 5 \u2013 Aplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo 88 \n\nA figura 5.8 apresenta a fun\u00e7\u00e3o custo referente \u00e0 mudan\u00e7a na temperatura do \n\n\u00f3leo t\u00e9rmico na entrada do reator. Observa-se novamente que a fun\u00e7\u00e3o n\u00e3o \u00e9 mais \n\ndecrescente no tempo, pois, o modelo deixou de ser o nominal :  \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nFigura 5.8- Fun\u00e7\u00e3o custo do caso servo em 3y  \n\n \n\n \n\n \n\nNas figuras 5.9 e 5.10 s\u00e3o apresentadas as respostas do processo para uma \n\naltera\u00e7\u00e3o no \u2018setpoint\u2019 da press\u00e3o do g\u00e1s de reciclo na entrada do reator. O valor de \n\nrefer\u00eancia \u00e9 alterado de 219, 5 /kg cm  para 220 /kg cm  ( 4\nspy ), mantendo as demais \n\ncontroladas nos \u2018setpoints\u2019 originais, ou seja, 1 6, 5 %\nspy = , 2 20 %\n\nspy =  e \n\n3 251\nsp oy C= . O desempenho do controlador continua semelhante aos casos anteriores. \n\n \n\n \n\n \n\n\n\nCap\u00edtulo 5 \u2013 Aplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo 89 \n\nFigura 5.9- Varia\u00e7\u00e3o na press\u00e3o do g\u00e1s de reciclo : setpoint 4y  \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nFigura 5.10- Manipuladas para o caso servo em 4y  \n\n\n\nCap\u00edtulo 5 \u2013 Aplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo 90 \n\nFaremos agora uma an\u00e1lise da performance do IHMPC-E de modelo \n\naproximado para a rejei\u00e7\u00e3o de uma perturba\u00e7\u00e3o na vaz\u00e3o de oxig\u00eanio que tem a seguinte \n\nforma : em um dado instante, por uma necessidade qualquer de processo, a vari\u00e1vel \n\nmanipulada 1u  (vaz\u00e3o de 2O ) \u00e9 desligada do controle preditivo, sendo a mesma \n\naumentada em 200 /kg h , permanecendo nessa situa\u00e7\u00e3o por 15  minutos. Ap\u00f3s esse \n\ntempo, a vari\u00e1vel 1u  \u00e9 recolocada novamente como manipulada do controlador. \u00c9 \n\ninteressante notar que o cen\u00e1rio acima \u00e9 operacionalmente equivalente a manter a \n\nvari\u00e1vel 1u  sempre ligada no controle, mas com seus limites de m\u00e1ximo e m\u00ednimo, \n\nmax\n1u  e \n\nmin\n1u , alterados simultaneamente para um mesmo valor. \n\n \n\nAs figuras 5.11 e 5.12 apresentam as vari\u00e1veis controladas e manipuladas, \n\nmostrando que o controlador \u00e9 capaz de rejeitar a perturba\u00e7\u00e3o. Apenas a press\u00e3o tem um \n\ncomportamento demasiadamente lento mas ainda aceit\u00e1vel. \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nFigura 5.11- Perturba\u00e7\u00e3o na vaz\u00e3o de oxig\u00eanio : vari\u00e1veis controladas \n\n \n\n \n\n\n\nCap\u00edtulo 5 \u2013 Aplica\u00e7\u00e3o do IHMPC-E no controle de um sistema industrial complexo 91 \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nFigura 5.12- Perturba\u00e7\u00e3o na vaz\u00e3o de oxig\u00eanio : vari\u00e1veis manipuladas \n\n \n\n \n\n \n\n  \n\n \n\n \n\n \n\n \n\n \n\n\n\n 92 \n\nCap\u00edtulo 6 \n\nConclus\u00f5es e Recomenda\u00e7\u00f5es \n\n \n\n6.1 Conclus\u00f5es \n \n\nOs controladores preditivos existentes na literatura apresentam limita\u00e7\u00f5es de uso \n\nem processos integradores, os quais exibem resposta n\u00e3o-estacion\u00e1ria nas sa\u00eddas frente \n\nao degrau nas entradas. Um dos contornos para essa limita\u00e7\u00e3o \u00e9 o truncamento da \n\nresposta ao degrau ap\u00f3s um n\u00famero finito de instantes. Essa abordagem, no entanto, \n\nacarreta um erro que pode instabilizar o processo em malha fechada. \n\n \n\nO presente trabalho teve seu enfoque principal no desenvolvimento de um \n\nalgoritmo de controle preditivo de horizonte de predi\u00e7\u00e3o infinito, nominalmente est\u00e1vel, \n\npara contemplar os processos que apresentam caracter\u00edsticas integradoras. Esse \n\nalgoritmo est\u00e1 baseado na representa\u00e7\u00e3o em vari\u00e1veis de estado na forma incremental \n\ndas entradas, cuja abordagem tamb\u00e9m \u00e9 bem escassa na literatura. Adicionalmente \n\nenfocou-se o caso real onde temos a presen\u00e7a de tempos mortos na fun\u00e7\u00e3o de \n\ntransfer\u00eancia do processo. \n\n \n\nDemonstrou-se que o IHMPC-E \u00e9 est\u00e1vel, independente da sintonia, para o caso \n\nnominal em sistemas observ\u00e1veis. \n\n \n\nA aplica\u00e7\u00e3o do controlador de horizonte infinito para sistemas integradores foi \n\nilustrada para dois processos industriais. O primeiro, uma coluna desisobutanizadora \n\nt\u00edpica de uma refinaria de petr\u00f3leo, foi simulado para o caso nominal e tamb\u00e9m para \n\nincertezas no modelo da planta. O segundo processo, um reator de oxida\u00e7\u00e3o catal\u00edtica de \n\netileno, que exibe diferentes tempos mortos para as vari\u00e1veis integradoras foi tamb\u00e9m \n\nestudado. Nesse caso, verificou-se que o modelo perfeito do processo n\u00e3o \u00e9 observ\u00e1vel \n\ne foi necess\u00e1ria a utiliza\u00e7\u00e3o de um modelo aproximado. Em ambos os casos foi usado o \n\nfiltro de Kalman no controlador. \n\n \n\n\n\nCap\u00edtulo 6 \u2013 Conclus\u00f5es e recomenda\u00e7\u00f5es \n \n93 \n\nO controlador IHMPC-E teve um bom desempenho no caso nominal da coluna \n\ndeisobutanizadora como tamb\u00e9m nos casos incertos da coluna. Os resultados com o \n\nsistema de \u00f3xido de eteno foram apenas razo\u00e1veis. A escolha dos par\u00e2metros de sintonia \n\ndo IHMPC-E mostrou-se relativamente simples, praticamente n\u00e3o exigindo nenhum \n\nesfor\u00e7o adicional em rela\u00e7\u00e3o aos par\u00e2metros dos MPC\u2019s convencionais de horizonte de \n\npredi\u00e7\u00e3o finita existentes na literatura. \n\n \n \n6.2 Sugest\u00f5es para trabalhos futuros \n \n\nUma extens\u00e3o natural deste trabalho seria o desenvolvimento de um MPC \n\nrobusto para processos integradores com incerteza no modelo. Usando as id\u00e9ias aqui \n\napresentadas, acreditamos que o trabalho de Cano e Odloak (2003) possa ser estendido \n\npara sistemas que associem din\u00e2micas est\u00e1veis e integradoras, al\u00e9m da presen\u00e7a de \n\ntempos mortos. \n\n \n\nUma sugest\u00e3o adicional refere-se \u00e0 necessidade de se desenvolver um \u2018solver\u2019 \n\nou aperfei\u00e7oar os solvers existentes para tratar com o problema de NLP espec\u00edfico desse \n\ncontrolador.  \n\n \n\nObservamos que a rotina fmincon do MATLAB, utilizada nesse trabalho, tem \n\numa performance insatisfat\u00f3ria tanto sob o aspecto de tempo computacional como sob o \n\naspecto de confiabilidade, gerando frequentemente \u2018ru\u00eddos\u2019 dados por solu\u00e7\u00f5es \n\nindesej\u00e1veis sem significado f\u00edsico algum, ou seja, entre instantes consecutivos, o solver \n\nchaveia sistematicamente algumas restri\u00e7\u00f5es ativas mesmo quando a fun\u00e7\u00e3o custo est\u00e1 \n\nbem pr\u00f3xima de zero, isto \u00e9, perto da condi\u00e7\u00e3o estacion\u00e1ria do sistema em malha \n\nfechada. \n\n \n\n \n\n \n\n\n\n 94 \n\n \n\nRefer\u00eancias Bibliogr\u00e1ficas \n \n\nAstrom, K.J. e Wittenmark, B. (1990). Computer controled systems. Theory and Design \n\nPrentice-Hall  \n\nCano, R.A.R. e Odloak, D. (2003). Robust model predictive control of integrating \n\nprocesses. Journal of Process Control, v.13, p.101-114. \n\nCano, R.A.R. (2001). Controle Robusto de Processos Qu\u00edmicos Integradores. \n\nDisserta\u00e7\u00e3o de Mestrado. EPUSP, S\u00e3o Paulo. \n\nCutler, C. R. e Ramaker, B. L. (1979). Dynamic matrix control \u2013 a computer control \n\nalgorithm. AIChE 86th  National Meeting, Houston, TX. \n\nGarcia, C. E. e Morshedi, A. M. (1986). Quadratic programing solution of dynamic \n\nmatrix control (QDMC). Chem. Engng Commun., v.46, p.73-87. \n\nGouv\u00eaa, M. T. e Odloak, D. (1997). ROSSMPC: A new way of representing and \n\nanalysing the predictive controllers. Trans IchemE, v.75, Part A, p.693-708. \n\nLee, J. H.; Morari, M. e Garcia, C. E. (1994). State space interpretation of model \n\npredictive control. Automatica, v.30, n.4, p.707-717. \n\nLee, J. H. e Cooley, B. L. (2000). Min-Max Predictive control Techniques for a Linear \n\nState Space System with a Bounded Set of Input Matrices. Automatica, v.36,  \n\np.463-473. \n\nLee, J. H. e Xiao, J. (2000). Use of two-stage optimization in model predictive control \n\nof stable and integrating systems. Computers Chem. Engng, v.24,  p.1591-1596. \n\nLi, S.; Lim, K. Y. e Fisher, D. G. (1989). A state space formulation for model predictive \n\ncontrol. AIChE Journal, v.35, n.2, p.241-249. \n\nLuyben, W.L.; Tyreus, B.D.; e Luyben, M.L. (1999). Plantwide process control.            \n\nMc Graw-Hill.  \n\nMoro, L. F. L. e Odloak, D. (1995). Constrained multivariable control of fluid cracking \n\nconverters. Journal of Process Control, v.5, n.1, p.29-39. \n\nOdloak, D. (1996). A new state-space approach to model predictive control, Brazilian \n\nJournal of Chem. Engng, v.13, n.3, p.152-167. \n\nRawlings, J.B e K.R Muske (1993). The stability of constrained multivariable receding \n\nhorizon control. IEEE Trans. Autom. Cont., 38, p.1512-1516. \n\n\n\nRefer\u00eancias bibliogr\u00e1ficas \n \n95 \n\n \n\nRodrigues, M. A. (2001). Estabilidade Robusta de Controladores Preditivos. Tese de \n\nDoutorado. EPUSP, S\u00e3o Paulo. \n\nRodrigues, M. A. e Odloak D. (2000). Output feedback MPC with guaranteed robust \n\nstability. Journal of Process Control, december, v.10, n.6, p. 567-572. \n\nRodrigues, M. A. e Odloak D. (2003). An infinite horizon model predictive control for \n\nstable and integrating processes. Computers Chem. Engng, v.27, p. 1113-1128. \n\nRodrigues, M. A; Carrapi\u00e7o,O.L.; Odloak D. e Moraes,R. (2004). Relat\u00f3rio do Projeto \n\nde Desenvolvimento de Controladores Avan\u00e7ados para Reator de \u00d3xido de Etileno. \n\nEscola Polit\u00e9cnica da USP, abril. \n\nSontag, E. D. (1998). Mathematical control theory. Springer-Verlag. \n\nWu, K.L.; Yu, C.C.; Luyben, W.L. e Skogestad,S. (2003). Reactor/Separator Processes \n\nwith recycles-2. Design for composition control Computers Chem. Engng,  v.27,  \n\nn. 3 , p.401 - 421. \n\n\n\n 96 \n\nAp\u00eandice A \n \n\nA.1 Montagem matricial da predi\u00e7\u00e3o das sa\u00eddas ao longo do horizonte np  \n\n \n\nEscrevendo as predi\u00e7\u00f5es de forma recursiva at\u00e9 o instante de controle m , temos : \n\n \n\n\u00e8instante 1k +   :   [ ] [ ]1 1k ky C x+ +=  \n \n                                                  [ ]{ }( )kC A x B u k= + ?  \n \n                                                  [ ] ( )kCA x CB u k= + ?  \n \n \n\u00e8instante 2k +   :   [ ] [ ]2 2k ky C x+ +=  \n \n                                                  [ ]{ }1 ( 1)kC A x B u k+= + ? +  \n \n\n                                                  [ ]{ }( ) ( 1)kC A A x B u k B u k? ?= + ? + ? +? ?  \n \n                                                  [ ]2 ( ) ( 1)kCA x CAB u k CB u k= + ? + ? +  \n \n \n\u00e8instante 3k +  :   [ ] [ ]3 3k ky C x+ +=  \n \n                                         [ ]{ }2 ( 2)kC A x B u k+= + ? +  \n \n                                         [ ]{ }1 ( 1) ( 2)kC A A x B u k B u k+? ?= + ? + + ? +? ?   \n \n\n                                         [ ]( ){ }( ) ( 1) ( 2)kC A A A x B u k B u k B u k? ?= + ? + ? + + ? +? ?   \n \n                                         [ ]3 2 ( ) ( 1) ( 2)kCA x CA B u k CAB u k CB u k= + ? + ? + + ? +                                 \n \n \ngeneralizando ent\u00e3o at\u00e9 o horizonte de controle m , temos : \n \n\u00e8para instantes de tempo j m?  : \n \n    [ ] [ ] 1 2( ) ( 1) ....... ( 1)j j jk j ky CA x CA B u k CA B u k CB u k j\n\n? ?\n+\n\n= + ? + ? + + + ? + ?  \n\n \n\n\n\nAp\u00eandice A 97 \n\nPara instantes acima do horizonte de controle, m j np&lt;? , n\u00e3o existe mais a\u00e7\u00f5es \nde controle. Escrevendo recursivamente teremos : \n \n \n\u00e8instante 1k m+ +  :  [ ] [ ]1 1k m k my C x+ + + +=   \n \n       mas, com [ ] [ ]1 k mk mx A x ++ + =  temos \n \n      [ ] [ ]{ }1 21 ( ) ( 1) ... ( 1)m m mk m kx A A x A B u k A B u k B u k m? ?+ + = + ? + ? + + + ? + ?  \n                   [ ]1 1( ) ( 1) ... ( 1)m m mkA x A B u k A B u k AB u k m\n\n+ ?= + ? + ? + + + ? + ?  \n \n       substituindo acima obtem-se : \n     \n  [ ] [ ]1 11 ( ) ( 1) ... ( 1)\n\nm m m\nk m k\n\ny CA x CA B u k CA B u k CAB u k m+ ?\n+ +\n\n= + ? + ? + + + ? + ?  \n \n \n \n\u00e8instante 2k m+ +  :  [ ] [ ]2 2k m k my C x+ + + +=   \n \n       mas, com [ ] [ ]2 1k m k mx A x+ + + +=  temos \n \n    [ ] [ ]{ }1 12 ( ) ( 1) ... ( 1)m m mk m kx A A x A B u k A B u k AB u k m+ ?+ + = + ? + ? + + + ? + ?  \n                 [ ]2 1 2( ) ( 1) ... ( 1)m m mkA x A B u k A B u k A B u k m\n\n+ += + ? + ? + + + ? + ?  \n \n       substituindo acima obtem-se : \n \n[ ] [ ]2 1 22 ( ) ( 1) ... ( 1)\n\nm m m\nk m k\n\ny CA x CA B u k CA B u k CA B u k m+ +\n+ +\n\n= + ? + ? + + + ? + ?  \n \nM  \n \n \n\u00e8instante k np+  :  [ ] [ ]\n\nk np k np\ny C x\n\n+ +\n=   \n\n \n \n[ ] [ ] 1 2( ) ( 1) ... ( 1)np np np np m\n\nk np k\ny CA x CA B u k CA B u k CA B u k m? ? ?\n\n+\n= + ? + ? + + + ? + ?  \n\n \n \n \nfazendo agora a generaliza\u00e7\u00e3o para instantes m j np&lt;?  obtem-se : \n \n[ ] [ ] 1 2( ) ( 1) ... ( 1)j j j j mk j ky CA x CA B u k CA B u k CA B u k m\n\n? ? ?\n+\n\n= + ? + ? + + + ? + ?  \n\n \n\n\n\nAp\u00eandice A 98 \n\n \nJuntando as duas parcelas generalizadas da predi\u00e7\u00e3o e representando na forma \n\nmatricial, teremos :      \n\n \n\n[ ]\n\n1\n2\n\n2\n\n1 2\n\n1\n1\n\n1\n\n1 2\n\n0 0\n0 ( )\n\n( 1)\n. .\n\n.\n. .\n\n.\n( 1)\n\nk\n\nk\n\nm m\nk\n\nm m\nnp\n\nk np\nnp\n\nk np np np np mk\n\nCB\ny CA\n\nCAB CB u k\ny CA\n\nu k\nx CA B CA B CB\n\nCA B CA B CAB\ny CA\n\nu k m\ny CA\n\nCA B CA B CA B\n\n+\n\n+\n\n? ?\n\n?\n?\n\n+ ?\n\n+ ? ? ?\n\n? ?\n? ? ? ? ? ? ?? ? ? ? ? ?\n? ? ? ? ? ? ? +\n? ? ? ? ? ?\n\n= +? ? ? ? ? ?\n? ? ? ? ? ?\n? ? ? ? ? ?\n? ? ? + ?? ? ? ?\n\n? ?? ? ? ?? ? ? ?? ?\n\nL\nL\n\nM M O M\nL\nL\n\nM M O M\nL\n\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?\n? ?? ?\n\n \n\n \n\nou de forma compacta : \n\n \n\n[ ] [ ]\n__\n\nkk k\ny C x C u\n\n==\n\n= + ?  \n\n \n\nonde , \n\n \n__\n\n2 TnpC CA CA CA? ?= ? ?L       ? R  np.ny  , ny+ne \n\n \n\n1 2\n\n1\n\n1 2\n\n0 0\n0\n\nm m\n\nm m\n\nnp np np m\n\nCB\nCAB CB\n\nC CA B CA B CB\nCA B CA B CAB\n\nCA B CA B CA B\n\n==\n? ?\n\n?\n\n? ? ?\n\n? ?\n? ?\n? ?\n? ?\n? ?\n\n= ? ?\n? ?\n? ?\n? ?\n? ?? ?\n\nL\nL\n\nM M O M\nL\nL\n\nM M O M\nL\n\n ? R  np.ny  ,  m.nu \n\n \n\n( )y k   ? R  np.ny                    \n \n\n( / )x k k   ? R  (ny+ne)          \n \n\n[ ]ku? ? R  m.nu  \n\n\n\nAp\u00eandice A 99 \n\nA.2 Fun\u00e7\u00e3o Custo do Problema P4.1 na forma quadr\u00e1tica \n\n \n\n[ ] [ ]\n__ __\n\n1 1\n\nT\nsp sp\n\nk k kk k\nV C x C u y Q C x C u y\n\n== ==? ? ? ?\n= + ? ? + ? ?? ? ? ?? ? ? ?\n\n%  \n\n           [ ]{ } [ ]{ }~ ~*\nT T\n\nm m T\nk k k kk k\n\nA e AB u Q A e AB u u R u+ + ? + ? + ? ?%             \n\n \nabrindo o primeiro termo da fun\u00e7\u00e3o custo : \n\n             \n\n                 [ ] [ ]\n__ __\n\n1 1\n\nT\nsp sp\n\nk kk k\nC x C u y Q C x C u y\n\n== ==? ? ? ?\n+ ? ? + ? ? =? ? ? ?? ? ? ?\n\n%  \n\n                                 \n\n[ ] [ ] [ ] [ ]\n\n[ ]\n\n[ ]\n\n__ __ __ __\n\n1\n\n__\n\n1\n\n__\n\n1 1 1 1\n\nT T T\nT T T sp\n\nkk k k k\n\nT T T\nT T T sp\n\nk k k kk\n\nT T Tsp sp sp sp\nkk\n\nx C Q C x x C Q C u x C Qy\n\nu C Q C x u C Q C u u C Qy\n\ny Q C x y Q C u y Qy\n\n==\n\n== == == ==\n\n==\n\n= + ? ?\n\n+ ? + ? ? ? ?\n\n? ? ? +\n\n% % %\n\n% % %\n\n% % %\n                  \n\n \n \nabrindo o segundo termo da fun\u00e7\u00e3o custo : \n\n \n\n                [ ]{ } [ ]{ }~ ~*\nT T\n\nm m T\nk k k kk k\n\nA e AB u Q A e AB u u R u+ ? + ? + ? ? =%  \n\n                                                        \n\n[ ] [ ] [ ]\n\n[ ]\n\n~\n* *\n\n~ ~ ~\n* *\n\nT TT Tm m m\nkk k k\n\nT T\nT Tm\n\nk k kk\n\nT\nk k\n\ne A Q A e e A Q AB u\n\nu AB Q A e u AB Q AB u\n\nu R u\n\n= + ?\n\n+ ? + ? ?\n\n+ ? ?%\n \n\n \n \nAgrupando de forma adequada os termos, obtem-se : \n \n \n\n1\nT\n\nk k kV u H u= ? ?   ,12 f kC u+ ?      1c+  \n \nonde \n \n\n          matriz Hessiana     \n~ ~\n\n*\n1\n\nT T\n\nH C Q C AB Q AB R\n== ==\n\n= + +% %  \n\n         [ ] [ ]\n__ ~\n\n*\n,1 1\n\nT\nTT Tsp m\n\nf k k\nC x C Q C y Q C e A Q AB\n\n== ==\n\n= ? +% %  \n\n         [ ] [ ] [ ] [ ] [ ]\n__ __ __\n\n*\n1 1 11 2\n\nT\nT T TT Tsp sp sp m m\n\nk k k k k\nc x C Q C x y Q C x y Qy e A Q A e= ? + +% % %  \n\n \n\n\n\nAp\u00eandice A 100 \n\nA.3 Fun\u00e7\u00e3o Custo do Problema P4.2 na forma quadr\u00e1tica \n\n \n\n[ ] [ ]\n__ __ __ __\n\n1 1\n\nT\nsp s sp s\n\nk k k k kk k\nV C x C u y I Q C x C u y I? ?\n\n== ==? ? ? ?\n= + ? ? ? + ? ? ?? ? ? ?? ? ? ?\n\n%  \n\n[ ]{ } [ ]{ }~ ~* 1\nT T\n\nTm m T s s\nk k k k k kk k\n\nA e AB u Q A e AB u u R u S? ?+ + ? + ? + ? ? +%  \n\n \nabrindo o 1\u00ba Termo : \n\n                [ ] [ ]\n__ __ __ __\n\n1 1\n\nT\nsp s sp s\n\nk k k kk k\nC x C u y I Q C x C u y I? ?\n\n== ==? ? ? ?\n+ ? ? ? + ? ? ? =? ? ? ?? ? ? ?\n\n%  \n\n[ ] [ ] [ ] [ ] [ ]\n\n[ ]\n\n[ ]\n\n[ ]\n\n__ __ __ __ __ __\n\n1\n\n__ __\n\n1\n\n__ __\n\n1 1 1 1 1\n\n__ __\n\nT T T T\nT T T Tsp s\n\nk kk k k k k\n\nT T T T\nT T T Tsp s\n\nk k k k k kk\n\nT T T Tsp sp sp sp sp s\nk kk\n\nT\nT Ts s\n\nk kk\n\nx C Q C x x C Q C u x C Qy x C Q I\n\nu C Q C x u C Q C u u C Qy u C Q I\n\ny Q C x y Q C u y Qy y Q I\n\nI Q C x\n\n?\n\n?\n\n?\n\n? ?\n\n==\n\n== == == == ==\n\n==\n\n= + ? ? ?\n\n+ ? + ? ? ? ? ? ?\n\n? ? ? + +\n\n? ?\n\n% % % %\n\n% % % %\n\n% % % %\n\n% __ __ __ __\n1\n\nT T T\nT Ts sp s s\n\nk k k kI Q C u I Qy I Q I? ? ?\n==\n\n? + +% % %\n\n                  \n\n \n \nabrindo o 2\u00ba Termo : \n\n[ ]{ } [ ]{ }~ ~* 1\nT T\n\nTm m T s s\nk k k k k kk k\n\nA e AB u Q A e AB u u R u S? ?+ ? + ? + ? ? + =%  \n\n                                                        \n\n[ ] [ ] [ ]\n\n[ ]\n\n~\n* *\n\n~ ~ ~\n* *\n\n1\n\nT TT Tm m m\nkk k k\n\nT T\nT Tm\n\nk k kk\n\nTT s s\nk k k k\n\ne A Q A e e A Q AB u\n\nu AB Q A e u AB Q AB u\n\nu R u S? ?\n\n= + ?\n\n+ ? + ? ?\n\n+ ? ? +%\n \n\n \nAgrupando de forma adequada os termos :  \n \n\n2 ,2 22 2\nT k kT s\n\nk k k fs s\nk k\n\nu u\nV u H C c?\n\n? ?\n\n? ? ? ?? ?\n? ?= ? + +? ? ? ?? ? ? ? ? ?? ? ? ?\n\n \n\nonde  \n \n\nmatriz  Hessiana :             \n\n__~ ~\n*\n\n2\n__ __ __\n\n1\n\nT T T\n\nT T\n\nC Q C AB Q AB R C Q I\nH\n\nI Q C I Q I S\n\n== == ==\n\n==\n\n? ?\n+ + ?? ?= ? ?\n\n? ?? +? ?\n\n% %%\n\n% %\n \n\n[ ] [ ] [ ]\n__ __ __ __~\n\n*\n,2 1 1\n\nT T\nT TT T Tsp m sp\n\nf k k k\nC x C Q C y Q C e A Q AB x C Q I y Q I\n\n== ==? ?\n= ? + ? +? ?\n\n? ?\n% % % %  \n\n[ ] [ ] [ ] [ ] [ ]\n__ __ __\n\n*\n1 1 12 1 2\n\nT\nT T TT Tsp sp sp m m\n\nk k k k k\nc c x C Q C x y Q C x y Qy e A Q A e\n\n? ?? ?\n= = ? + +? ?\n\n? ?? ?\n% % %  \n\n\n\nAp\u00eandice A 101 \n\nA.4 Fun\u00e7\u00e3o Custo do Problema P4.3 na forma quadr\u00e1tica \n\n \n\n[ ] [ ]\n__ __ __ __ __ __\n\n1 1\n\nT\nsp s i sp s i\n\nk k k k k k kk k\nV C x C u y I T Q C x C u y I T? ? ? ?\n\n== ==? ? ? ?\n= + ? ? ? ? + ? ? ? ?? ? ? ?? ? ? ?\n\n%  \n\n[ ]{ } [ ]{ }~ ~* 1 2\nT T\n\nT Tm m T s s i i\nk k k k k k k kk k\n\nA e AB u Q A e AB u u R u S S? ? ? ?+ + ? + ? + ? ? + +%\n\n \n \n \n \nabrindo o 1\u00ba Termo : \n \n\n[ ] [ ]\n__ __ __ __ __ __\n\n1 1\n\nT\nsp s i sp s i\n\nk k k k k kk k\nC x C u y I T Q C x C u y I T? ? ? ?\n\n== ==? ? ? ?\n+ ? ? ? ? + ? ? ? ? =? ? ? ?? ? ? ?\n\n%  \n \n\n[ ] [ ] [ ] [ ] [ ] [ ]\n\n[ ]\n\n[ ]\n\n__ __ __ __ __ __ __ __\n\n1\n\n__ __ __\n\n1\n\n__\n\n1 1 1 1\n\nT T T T T\nT T T T Tsp s i\n\nk k kk k k k k k\n\nT T T T T\nT T T T Tsp s i\n\nk k k k k k k kk\n\nT T Tsp sp sp sp\nkk\n\nx C Q C x x C Q C u x C Qy x C Q I x C Q T\n\nu C Q C x u C Q C u u C Qy u C Q I u C Q T\n\ny Q C x y Q C u y Qy y\n\n? ?\n\n? ?\n\n==\n\n== == == == == ==\n\n==\n\n= + ? ? ? ?\n\n+ ? + ? ? ? ? ? ? ? ?\n\n? ? ? + +\n\n% % % % %\n\n% % % % %\n\n% % %\n\n[ ]\n\n[ ]\n\n__ __\n\n1 1\n\n__ __ __ __ __ __ __ __\n\n1\n\n__ __ __ __ __ __ __ __\n\n1\n\nT Tsp s sp i\nk k\n\nT T T T T\nT T T T Ts s s sp s s s i\n\nk k k k k k k kk\n\nT T T T T\nT T T T Ti i i sp i s i i\n\nk k k k k k k kk\n\nQ I y Q T\n\nI Q C x I Q C u I Qy I Q I I Q T\n\nT Q C x T Q C u T Qy T Q I T Q T\n\n? ?\n\n? ? ? ? ? ? ?\n\n? ? ? ? ? ? ?\n\n==\n\n==\n\n+\n\n? ? ? + + +\n\n? ? ? + + +\n\n% %\n\n% % % % %\n\n% % % % %\n   \n \n \n \n \nabrindo o 2\u00ba Termo : \n \n\n[ ]{ } [ ]{ }~ ~* 1 2\nT T\n\nT Tm m T s s i i\nk k k k k k k kk k\n\nA e AB u Q A e AB u u R u S S? ? ? ?+ ? + ? + ? ? + + =%\n\n \n                                  \n\n                                                 \n\n[ ] [ ] [ ]\n\n[ ]\n\n~\n* *\n\n~ ~ ~\n* *\n\n1 2\n\nT TT Tm m m\nkk k k\n\nT T\nT Tm\n\nk k kk\n\nT TT s s i i\nk k k k k k\n\ne A Q A e e A Q AB u\n\nu AB Q A e u AB Q AB u\n\nu R u S S? ? ? ?\n\n= + ?\n\n+ ? + ? ?\n\n+ ? ? + +%\n \n\n \n \n\n\n\nAp\u00eandice A 102 \n\nAgrupando de forma adequada os termos na forma quadr\u00e1tica :  \n \n \n\n11 12 13\n\n12 22 23 ,3 33\n\n13 23 33\n\n2\n\nk k\n\nT T TT s i s s\nk k k k k f k\n\nT T i i\nk k k\n\nu uH H H\n\nV u H H H C c\n\nH H H\n\n? ? ? ?\n\n? ?\n\n? ? ? ?? ?? ?\n? ? ? ?? ?? ?= ? + +? ? ? ?? ?? ? ? ? ? ?? ?\n\n? ? ? ? ? ?? ? ? ?\n\n \n\n \n \nonde \n \n \n\n~ ~\n*\n\n11\n\nT T\n\nH C Q C AB Q AB R\n== ==\n\n= + +% %               \n__\n\n12\n\nT\n\nH C Q I\n==\n\n= ? %                \n__\n\n13\n\nT\n\nH C Q T\n==\n\n= ? %  \n__\n\n12\n\nT\nTH I Q C\n\n==\n\n= ? %                                      \n__ __\n\n22 1\n\nT\n\nH I Q I S= +%               \n__ __\n\n23\n\nT\n\nH I Q T= %  \n__\n\n13\n\nT\nTH T Q C\n\n==\n\n= ? %                                      \n__ __\n\n23\n\nT\nTH T Q I= %                   \n\n__ __\n\n33 2\n\nT\n\nH T Q T S= +%  \n \n \n \n\n[ ] [ ] [ ]\n~\n\n*\n,3 1 1 1\n\nT T T TT T TT sp T m T sp T sp\nf kk k k\n\nC x C Q C y Q C e A Q AB x C QI y QI x C QT y QT\n== ==? ?= ? + ? + ? +? ?? ?\n\n% % % % % %\n\n \n \n\n [ ] [ ] [ ] *3 12\nT TT T sp T m m\n\nk kk k k\nc x C QC x y QC x e A Q A e= ? +% %"}]}}}