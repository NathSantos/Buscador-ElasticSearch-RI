{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.19516"}, {"@name": "filename", "#text": "2873_Bonet_Luciane_M.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE ESTADUAL DE CAMPINAS\nFACULDADE DE ENGENHARIA MEC\u00c2NICA\nDEPARTAMENTO DE ENGENHARIA DE PETR\u00d3LEO\nDisserta\u00e7\u00e3o Apresentada \u00e0\nFaculdade de Engenharia Mec\u00e2nica Como Requisito Pardal \u00e0 Obten\u00e7\u00e3o do T\u00edtulo de Mestre em Engenharia de Petr\u00f3leo\nSIMULA\u00c7\u00c3O NUM\u00c9RICA DE RESERVAT\u00d3RIOS UTILIZANDO UM M\u00c9TODO DE IMPLICITUDE AUTO-ADAPT\u00c1VEL\nfcfc\to. ffetetVO\t\u00edM.\tt\nferra. UuMxne. B\u00eddw.T q\tj--\u25a0\nW ...\u00ed y u/yO\nUx , mV\u00c1;'\t111 c\n53/^0\nAutor : Luciane Bonet\nOrientador : Fernando Rodriguez de la Garza J\nnovembro de 1990\nUNIVERSIDADE ESTADUAL DE CAMPINAS\nFACULDADE DE ENGENHARIA MEC\u00c2NICA\nDEPARTAMENTO DE ENGENHARIA DE PETR\u00d3LEO\nA disserta\u00e7\u00e3o \u201cSimula\u00e7\u00e3o Num\u00e9rica de Reservat\u00f3rios Utilizando um M\u00e9todo de Implicitude Auto-adapt\u00e1vel\u201d, elaborada por Luciane Bonet e aprovada por todos os membros da Banca Examinadora foi aceita pela Sub-Comiss\u00e3o de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia. de Petr\u00f3leo como requisito parcial a obten\u00e7\u00e3o do t\u00edtulo de Mestre em Engenharia de Petr\u00f3leo.\nCampinas, 27 de Novembro de 1990.\nBanca Examinadora\nFernando Rodr\u00edguez de Ia Garza, Ph, D.\nSidney Stuckenbruck, Pb. D.\n4 Jos\u00e9 Carlos de Souza Cunha, pelo seu carinho e incentivo.\nAGRADECIMENTOS\n*\nA PETROBRAS, pela oportunidade e apoio financeiro.\nAos professores do Mestrado em Engenharia de Petr\u00f3leo da UNICAMP, pelos excelentes cursos ministrados.\nAos funcion\u00e1rios do Departamento de Engenharia de Petr\u00f3leo da UNICAMP pelo apoio recebido.\nAos colegas do curso pela boa conviv\u00eancia.\nA meu pai e primeiro mestre na inicia\u00e7\u00e3o cient\u00edfica Euclides, por ter me transmitido sua curiosidade \u00e0 respeito do mundo que nos cerca.\nA minha m\u00e3e In\u00e9s, pela dedica\u00e7\u00e3o e companheirismo de toda a vida.\nAos meus irm\u00e3os Jairo Lu\u00eds, L\u00facia In\u00e9s e Carolina pela, amizade, esperan\u00e7a e alegria.\nA Celso e C\u00e9lia Branco, que juntamente com sua filha Ana Luiza, foram minha fam\u00edlia em Campinas.\nA todos aqueles que colaboraram para a realiza\u00e7\u00e3o deste trabalho, com especial lembran\u00e7a a Antonio Cl\u00e1udio de Fran\u00e7a Corr\u00eaa, Pedro Wilson Teixeira, Oswaldo Antunes Pedrosa Jr., aos colegas do CENPES e de Campinas.\nRESUMO\nEste trabalho descreve o desenvolvimento e a aplica\u00e7\u00e3o de um m\u00e9todo para simula\u00e7\u00e3o num\u00e9rica de reservat\u00f3rios que se baseia em uma formula\u00e7\u00e3o de implicitude vari\u00e1vel e auto-adapt\u00e1vel.\nA formula\u00e7\u00e3o de implicitude vari\u00e1vel empregada fundamenta-se em uma abordagem geral dos m\u00e9todos de simula\u00e7\u00e3o de reservat\u00f3rios previamente apresentada na literatura. Nesta abordagem mostra-se que existe um n\u00edvel b\u00e1sico de implicitude em todos os m\u00e9todos ao qual associa-se uma matriz Jacobiana b\u00e1sica. A passagem ent\u00e3o, deste n\u00edvel b\u00e1sico para n\u00edveis mais impl\u00edcitos d\u00e1-se com a adi\u00e7\u00e3o de \u201cmatrizes corretivas\u201d. \u00c1 aplica\u00e7\u00e3o destas corre\u00e7\u00f5es a n\u00edvel local, nas c\u00e9lulas que constituem a malha de c\u00e1lculo, \u00e9 a base da formula\u00e7\u00e3o de implicitude vari\u00e1vel aqui descrita.\n0 m\u00e9todo em quest\u00e3o, diferentemente dos demais existentes na literatura, n\u00e3o objetiva diretamente a elimina\u00e7\u00e3o das inc\u00f3gnitas, relativas a uma determinada c\u00e9lula, para a composi\u00e7\u00e3o do problema matricial final. Objetiva sim, o menor grau de implicitude que deve ser localmente fornecido ao sistema de equa\u00e7\u00f5es nao lineares a ser resolvido, com garantia de estabilidade da solu\u00e7\u00e3o. Neste m\u00e9todo, diversos n\u00edveis de implicitude podem ser considerados, admitindo-se desde valores m\u00ednimos (IMPES) at\u00e9 valores m\u00e1ximos (Totalmente Impl\u00edcito).\nImplementou-se um crit\u00e9rio de troca autom\u00e1tica de implicitude que opera a n\u00edvel de c\u00e9lula ao longo da simula\u00e7\u00e3o. Este contempla apenas os n\u00edveis extremos de implicitude (IMPES - Totalmente Impl\u00edcito) e base\u00eda-se na an\u00e1lise de estabilidade para o m\u00e9todo IMPES, previamente apresentada na literatura.\nFinalizando, s\u00e3o apresentadas duas aplica\u00e7\u00f5es do modelo desenvolvido. Atrav\u00e9s de tabelas especiais mostra-se os graus de \u00edmplicitude em cada c\u00e9lula e como eles mudam no espa\u00e7o e no tempo durante a simula\u00e7\u00e3o. Apresenta-se tamb\u00e9m informa\u00e7\u00f5es relativas \u00e0 economia de tempo computacional quando comparado com um procedimento fixo totalmente impl\u00edcito.\nABSTRACT\nThis work presents the development and application of a reservoir simulation method, based on a variable and an to-adaptive implicit formulation.\nThe variable implicitness formulation is based on a general approach of reservoir simulation methods, already presented in the literature. In such approach a basic level of implicitness for all methods is recognized which yields a basic Jacobian matrix. The change from this basic level to a more implicit one is performed with the addition of \u201ccorrection matrices\u201d. The local application of these corrections to each gridblock is the basis for the formulation described in this work.\nThe method here presented difFers from those already given in the literature in that it does not directly focuses on the elimination of grid cell unknowns, to compose the final matrix problem. Rather it focuses on the minimum level of implicitness to be locally given to the non-linear difference equations to ensure stability. Under such approach various levels of implicitness are possible, ranging from IMPES type to Fully Implicit.\nA switching criteria for the automatic assignment of implicitness in each cell along the simulation time was implemented. It considers only IMPES and fully implicit type cells and is based on stability analysis previously presented In the literature for the IMPES formulation.\nA sparse-matrix method was adapted to solve the resulting linear systems of equations. The method allows an arbitrary ordering of the equations and unknowns. Such capability was particularly useful to take advantage of the matrix-structure of equations that results in applications of the auto-adaptive implicit method.\nFinally, two applications are presented. By using special displays we demonstrate the degrees of implicitness in each cell and how they shift in space and time\nConte\u00fado\n1\tIntrodu\u00e7\u00e3o\t1\n2\tEqua\u00e7\u00f5es Diferenciais do Escoamento de Fluidos em Reservat\u00f3rios\t4\n3\tSolu\u00e7\u00e3o Num\u00e9rica Atrav\u00e9s de um M\u00e9todo de Implicitude Vari\u00e1vel\t6\n3.1\tEqua\u00e7\u00f5es de Diferen\u00e7as .........................................  6\n3.2\tAntecedentes : Formula\u00e7\u00e3o Geral dos M\u00e9todos de Solu\u00e7\u00e3o do Sistema N\u00e3o\nLinear ......................................................     S\n3.3\tAplica\u00e7\u00e3o da Formula\u00e7\u00e3o Geral a N\u00edvel Local: Formula\u00e7\u00e3o de Implicitude\nVari\u00e1vel....................................................     15\n4\tAlgoritmo de Controle Autom\u00e1tico de Implicitude\t20\n5\tSolu\u00e7\u00e3o do Sistema Matricial Gerado na Utiliza\u00e7\u00e3o de um M\u00e9todo de\nImplicitude Auto-adapt\u00e1vel\t24\n6\tAplica\u00e7\u00f5es Pr\u00e1ticas\t29\n6.1\tCaso 1.......................................................    29\n6.2\tCaso 2 . ..................................................      39\n7\tConclus\u00f5es\t45\nNomenclatura\t47\nRefer\u00eancias\t51\nAp\u00eandice B - Elementos da Matriz Jacobiana : M\u00e9todo Impl\u00edcito\nAp\u00eandice C - \u201cMatrizes Corretivas\u201d\nAp\u00eandice D - Rotinas de Montagem e Ordena\u00e7\u00e3o\n55\n59\n67\nLista de Figuras\n3.1\tExemplo de Aplica\u00e7\u00e3o do M\u00e9todo de Implicitude Vari\u00e1vel (I-Totalmente\nImpl\u00edcita / E-IMPES).................................................   17\n3.2\tEstrutura das Diagonais Externas Impl\u00edcitas (I) e Expl\u00edcitas (E)....... 18\n5.1\tExemplo Bidimensional com um padr\u00e3o Totalmente-Impl\u00edcito (I) - IMPES(E) 26\n5.2\tMatriz J...........................................................     26\n5.3\tProblema Matricial ap\u00f3s Redu\u00e7\u00e3o de Gauss-Jordan nos Blocos Diagonais . 27\n5.4\tProblema Matricial Reduzido.........................................    27\n6.1\tModelo do Reservat\u00f3rio - Se\u00e7\u00e3o Transversal ............................ 30\n6.2\tPress\u00e3o de Fluxo de Fundo de Po\u00e7o versus Tempo (compara\u00e7\u00e3o com o\nSIMBEST) ............................................................   34\n6.3\tVaz\u00e3o de Oleo versus Tempo (compara\u00e7\u00e3o como\tSIMBEST)..............  35\n6.4\tRaz\u00e3o G\u00e1s-\u00d3leo versus Tempo (compara\u00e7\u00e3o com\to SIMBEST)..............35\n6.5\tPress\u00e3o de Fluxo de Fundo de Po\u00e7o versus Tempo (Caso 1).................37\n6.6\tVaz\u00e3o de Oleo versus Tempo (Caso 1) . . ..............................  38\n6.7\tRaz\u00e3o G\u00e1s-\u00d3leo versus Tempo (Caso 1).................................... 38\n6.8\tVaz\u00e3o de \u00d3leo versus Tempo (Caso 2) .... .............................. 40\n6.9\tGraus de Implicitude versus Tempo (Caso 2 ~ M\u00e9todo de Implicitude Auto-\nadapt\u00e1vel) .........................................................    42\n6.10\tConfigura\u00e7\u00e3o de Graus de Implicitude para a Abordagem de Implicitude\nVari\u00e1vel ................................- -..........................  43\n6.11\tVaz\u00e3o de \u00d3leo versus Tempo (Compara\u00e7\u00e3o entre Formula\u00e7\u00f5es)..............43\nLista de Tabelas\n6.1\tDescri\u00e7\u00e3o do Reservat\u00f3rio\te Dados\tB\u00e1sicos\t(Caso\t1)......................31\n6.2\tFun\u00e7\u00f5es da Satura\u00e7\u00e3o ............................ 32\n6.3\tPropriedades PVT do\tG\u00e1s...........................................    32\n6.4\tPropriedades PVT do\t\u00d3leo .......................................      33\n6.5\tPropriedades PVT da\t\u00c1gua..........................................    33\n6.6\tResultados do Caso 1\t......... ........................................ 36\n6.7\tDescri\u00e7\u00e3o do Reservat\u00f3rio\te Dados\tB\u00e1sicos\t(Caso\t2)..................... 39\n6.8\tResultados do Caso 2 . .\t. ............................................  41\n6.9\tPar\u00e2metros para a An\u00e1lise de Desempenho da Formula\u00e7\u00e3o de Implicitude\nVari\u00e1vel . ............................................................. 44\n1 Introdu\u00e7\u00e3o\nCom o aprimoramento da tecnologia de simula\u00e7\u00e3o de reservat\u00f3rios, a tend\u00eancia tem sido o desenvolvimento de simuladores que ofere\u00e7am solu\u00e7\u00f5es totalmente impl\u00edcitas. Historicamente, a evolu\u00e7\u00e3o dos modelos de simula\u00e7\u00e3o de reservat\u00f3rios progrediu de uma formula\u00e7\u00e3o impl\u00edcita na press\u00e3o, expl\u00edcita na satura\u00e7\u00e3o (IMPES) para as assim chamadas solu\u00e7\u00e3o simult\u00e2nea, semi-impl\u00edcita, impl\u00edcita sequencial e da\u00ed para a totalmente impl\u00edcita [1]. C\u00e1lculos impl\u00edcitos s\u00e3o geralmente necess\u00e1rios para manter a estabilidade da solu\u00e7\u00e3o, quando as vari\u00e1veis estudadas sofrem grandes varia\u00e7\u00f5es ao longo de um passo de tempo. Uma vantagem que pode ser obtida de um simulador de elevada implicitude, al\u00e9m da estabilidade, \u00e9 que se pode tolerar grandes intervalos de passo de tempo. No entanto, esta vantagem \u00e9 reduzida por maiores erros de truncamento no tempo, de esfor\u00e7o de processamento e demanda de mem\u00f3ria substancialmente mais elevados. A maioria dos simuladores comerciais oferece um n\u00edvel de implicitude fixo em cada bloco da malha, em cada passo de tempo. Tipicamente, no entanto, somente uma pequena parcela do total de blocos em um modelo de reservat\u00f3rios sofre mudan\u00e7as r\u00e1pidas nas vari\u00e1veis calculadas para, justificar um alto n\u00edvel de implicitude. Por exemplo, em um po\u00e7o que sofre conifica\u00e7\u00e3o de g\u00e1s ou \u00e1gua, as mudan\u00e7as r\u00e1pidas na press\u00e3o e na satura\u00e7\u00e3o ocorrem nos blocos pr\u00f3ximos da regi\u00e3o do po\u00e7o, enquanto que, nos trechos mais afastados do mesmo, as mudan\u00e7as s\u00e3o mais suaves. O modelo totalmente impl\u00edcito maneja adequadamente uma situa\u00e7\u00e3o como esta, com garantias de estabilidade, mas, obviamente, algum excesso de trabalho \u00e9 envolvido naquelas c\u00e9lulas onde as varia\u00e7\u00f5es s\u00e3o modestas. Por outro lado, um tratamento IMPES de um problema como este pode resultar em um trabalho muito reduzido, com riscos de instabilidade nos blocos pr\u00f3ximos ao po\u00e7o.\nUm simulador empregando a t\u00e9cnica de implicitude auto-adapt\u00e1vel, automaticamente seleciona o n\u00edvel de implicitude, necess\u00e1rio c\u00e9lula a c\u00e9lula, para se garantir uma solu\u00e7\u00e3o est\u00e1vel. Estes n\u00edveis, ou graus de implicitude, podem mudar tanto no espa\u00e7o quanto no tempo, com o decorrer da simula\u00e7\u00e3o. Um conjunto de blocos em uma malha, por exemplo, pode sofrer grandes varia\u00e7\u00f5es nos n\u00edveis de implicitude. Diferentemente de outras abordagens, que fornecem um grau de implicitude fixo em cada bloco da malha, a cada intervalo de tempo, o m\u00e9todo de implicitude auto-adapt\u00e1vel envolve o tratamento de n\u00edveis mistos de implicitude, que variam automaticamente ao longo do tempo e do espa\u00e7o. A vantagem \u00e9 a redu\u00e7\u00e3o substancial, em certas situa\u00e7\u00f5es a serem simuladas, do tempo de computa\u00e7\u00e3o e da mem\u00f3ria computacional necess\u00e1rias quando comparadas com formula\u00e7\u00f5es totalmente impl\u00edcitas, mantendo-se, tal como estas, solu\u00e7\u00f5es incondicionalmente est\u00e1veis.\nOs m\u00e9todos de implicitude auto-adapt\u00e1vel foram introduzidos na simula\u00e7\u00e3o de reservat\u00f3rios por Thomas e Thurnau em 1983 [20], Desde o trabalho original, outro m\u00e9todo com caracter\u00edsticas distintas foi sugerido. 0 m\u00e9todo original \u00e9 referido como AIM (\u201cAdaptive Implicit Method\u201d) [6],[20],[21] e o subsequente \u00e9 conhecido como IAN (\u201cInexact Adaptive Implicit Newton Method\u201d) [2].\nNo m\u00e9todo AIM a matriz Jacobiana AIM \u00e9 obtida a partir da matriz Jacobiana totalmente impl\u00edcita, desprezando-se nesta as derivadas espaciais relativas \u00e0s inc\u00f3gnitas expl\u00edcitas que aparecem tanto no bloco da diagonal principal como nos blocos das diagonais externas. As equa\u00e7\u00f5es resultantes sao ent\u00e3o reduzidas a uma parti\u00e7\u00e3o impl\u00edcita e uma expl\u00edcita, que sao resolvidas separadamente. Como resultado do processo de redu\u00e7\u00e3o, a matriz de coeficientes torna-se arbitrariamente estruturada, de modo que m\u00e9todos convencionais de solu\u00e7\u00e3o iterativa n\u00e3o podem ser usados.\nNo m\u00e9todo IAN, as derivadas com respeito \u00e0s vari\u00e1veis declaradas expl\u00edcitas s\u00e3o zeradas somente se aparecerem nos blocos das diagonais externas da matriz Jacobiana. A matriz resultante \u00e9 ent\u00e3o reduzida como no m\u00e9todo AIM convencional. Menciona-se a ocorr\u00eancia de erros de balan\u00e7o de material maiores e de dificuldades no m\u00e9todo de solu\u00e7\u00e3o nos diversos artigos que analisam este m\u00e9todo.\nUma varia\u00e7\u00e3o do m\u00e9todo IAN \u00e9 o m\u00e9todo de implicitude din\u00e2mica proposto por Vinsome [22]. Se o fluxo atrav\u00e9s da face de um bloco da malha for menor que um valor sugerido de 0.02 do m\u00ednimo volume poroso de dois blocos adjacentes, ent\u00e3o tudo menos a coluna de press\u00e3o do correspondente bloco diagonal externo da matriz \u00e9 zerado. Este m\u00e9todo n\u00e3o conduz \u00e0 redu\u00e7\u00e3o no n\u00famero de equa\u00e7\u00f5es resultante, mas ganhos em tempo s\u00e3o alcan\u00e7ados na constru\u00e7\u00e3o do Jacobiano em um m\u00e9todo de solu\u00e7\u00e3o especial que pode reconhecer os blocos diagonais externos na matriz de coeficientes que foi parcialmente zerada.\nE importante ressaltar que os m\u00e9todos de tratamento de implicitude vari\u00e1vel existentes atuam diretamente nas inc\u00f3gnitas (satura\u00e7\u00f5es e composi\u00e7\u00f5es) de um determinado bloco. Ou seja, inc\u00f3gnitas s\u00e3o tornadas expl\u00edcitas, ou impl\u00edcitas, o que implica em n\u00e3o se calcular ou se calcular, respectivamente os valores de derivadas em rela\u00e7\u00e3o a estas inc\u00f3gnitas na matriz Jacobiana.\nAplica\u00e7\u00f5es do m\u00e9todo AIM e IAN em problemas de simula\u00e7\u00e3o de reservat\u00f3rios tipo \u201cblack-oil\u201d est\u00e3o bem documentadas nas refer\u00eancias [2],[6],[20],[22] e em problemas composicionais/t\u00e9rmicos na refer\u00eancia [19]. A aplica\u00e7\u00e3o pr\u00e1tica do m\u00e9todo AIM em um problema puramente composicional \u00e9 apresentada na refer\u00eancia [4].\nA an\u00e1lise apresentada a seguir se restringir\u00e1 ao contexto de modelos tipo \u201cblack-oil\u201d. As equa\u00e7\u00f5es b\u00e1sicas utilizadas para simula\u00e7\u00e3o \u201cblack-oil\u201d consistem nas equa\u00e7\u00f5es da conserva\u00e7\u00e3o de massa do \u00f3leo, g\u00e1s e \u00e1gua. As velocidades das fases s\u00e3o dadas pela lei de Darcy [1], 0 modelo \u201cblack-oil\u201d admite que a fase \u00e1gua consiste inteiramente do componente \u00e1gua, que o componente \u00f3leo \u00e9 n\u00e3o vol\u00e1til e que o g\u00e1s pode estar presente tanto nas fases \u00f3leo como g\u00e1s. Este tipo de modelo \u00e9 comumente usado para estudos de deple\u00e7\u00e3o prim\u00e1ria e recupera\u00e7\u00e3o secund\u00e1ria (inje\u00e7\u00e3o de \u00e1gua).Na aproxima\u00e7\u00e3o aqui estudada a \u00e1gua \u00e9 considerada im\u00f3vel. A partir das hip\u00f3teses acima, resultam as seguintes equa\u00e7\u00f5es :\nConserva\u00e7\u00e3o do \u00f3leo:\nV.{W(VP, - q0VD)] + qo~ ^S0bo) = 0\t(2.1)\nConserva\u00e7\u00e3o do g\u00e1s:\n- 7sVD) + (XaboR,k(VPo - 7pVD)] + qg + q.Ra\n- ^sffbg + SoboR9)] = Q\t(2.2)\nConserva\u00e7\u00e3o da \u00e1gua:\n= 0\t(2.3)\nUma explana\u00e7\u00e3o mais detalhada do escoamento no meio poroso apresentada sob o ponto de vista da engenharia de petr\u00f3leo pode ser encontrada na refer\u00eancia\n[1].\n(2.4)\nAs press\u00f5es individuais da fase g\u00e1s e \u00f3leo s\u00e3o relacionadas atrav\u00e9s da press\u00e3o capilar Pc\nPs Po d\" fcgof\u00eag)\nAs equa\u00e7\u00f5es (2.1) a (2.5), em conjunto com as condi\u00e7\u00f5es inicial e de fronteira, definem de forma \u00fanica o problema de fluxo no reservat\u00f3rio.\n3.1\tEqua\u00e7\u00f5es de Diferen\u00e7as\nA aproxima\u00e7\u00e3o das equa\u00e7\u00f5es (2.1) a (2.5) atrav\u00e9s de um esquema de diferen\u00e7as finitas impl\u00edcito, usando diferen\u00e7as centradas no espa\u00e7o e regressivas no tempo, conduz ao seguinte conjunto de equa\u00e7\u00f5es de diferen\u00e7as n\u00e3o lineares:\nequa\u00e7\u00e3o do \u00f3leo:\napXAp. - 7.A\u00ed>)J\u00cd\u201d+1 \u2019 + \u00ab2\u201d\t- WJh = 0\t(3.1)\nequa\u00e7\u00e3o do g\u00e1s:\nAPi(AP\u00ed - 7,A\u00a3>)](\u201d+1\u2019 + A[7:7?,(APr. - 7.A\u00a3>))j\u201d+l\u2019 + \u00eds'\u201d+l1 + (R.?,)!\u201c+'>\n-\t+ SAH.)),- (\u2018KSA, + SAa))!\"') = 0\t(3-2)\nequa\u00e7\u00e3o da \u00e1gua:\n\u00edU\"+\u201d = sd\"\u2019[i -\t+&lt;O(rf\u201d+1) - d\"\u2019).-!\t(3 3)\ni = l,2,...,m\tm~n\u00famero de blocos na malha\nn = 0,1,2....\nAcima, o subescrito i refere-se ao i-\u00e9simo bioco da malha ou c\u00e9lula, e A \u00e9 um operador de diferen\u00e7as centradas do tipo, Aiq ~ \u00abi+i/a ~ \u00ab\u00ed\u20141/2- Os sobrescritos (n) ou (n + 1) referem-se aos n\u00edveis de tempo, conhecido e inc\u00f3gnita, respectivamente.\nNote que os termos das equa\u00e7\u00f5es (3.1) e (3.2), que resultam das aproxima\u00e7\u00f5es em espa\u00e7o, s\u00e3o chamados termos de fluxo, enquanto as aproxima\u00e7\u00f5es em tempo s\u00e3o chamadas termos de acumula\u00e7\u00e3o. Note que o termo de acumula\u00e7\u00e3o para a c\u00e9lula i cont\u00e9m somente vari\u00e1veis da c\u00e9lula i, enquanto o termo de fluxo cont\u00e9m vari\u00e1veis da c\u00e9lula i bem como vari\u00e1veis dos vizinhos mais pr\u00f3ximos da c\u00e9lula i. Este tipo de conectividade entre c\u00e9lulas origina unia mol\u00e9cula computacional de tr\u00eas pontos em uma dimens\u00e3o, de cinco pontos em duas dimens\u00f5es e de sete pontos em tr\u00eas dimens\u00f5es. Maiores detalhes do m\u00e9todo de discretiza\u00e7\u00e3o podem ser achados nas refer\u00eancias [1] e [12].\n0 acoplamento das equa\u00e7\u00f5es (2.4) e (2.5) em (3.1) e (3.2) conduz a um sistema de equa\u00e7\u00f5es em termos de p0 e como inc\u00f3gnitas em cada n\u00f3.\nPode-se resolver o sistema n\u00e2o linear de equa\u00e7\u00f5es constitu\u00eddo pelas equa\u00e7\u00f5es (3.1) e (3.2) de v\u00e1rias formas. As diversas maneiras d\u00e9 linearizar estas equa\u00e7\u00f5es t\u00eam originado diversos m\u00e9todos, conhecidos na literatura como IMPES, Solu\u00e7\u00e3o Simult\u00e2nea, Sequenciais, Semi-impl\u00edcito e Totalmente Impl\u00edcito.\nRodr\u00edguez [13] apresentou em 1988 uma abordagem geral dos m\u00e9todos empregados na simula\u00e7\u00e3o de reservat\u00f3rios, onde o m\u00e9todo de Newton-Raphson \u00e9 considerado o procedimento geral para solucionar os sistemas de equa\u00e7\u00f5es n\u00e3o lineares gerados na simula\u00e7\u00e3o num\u00e9rica de reservat\u00f3rios. Mostrou que os diversos m\u00e9todos publicados na literatura s\u00e3o casos particulares que resultam da lineariza\u00e7\u00e3o preliminar parcial das equa\u00e7\u00f5es de diferen\u00e7as. Conforme essa abordagem \u00e9 poss\u00edvel distinguir claramente um n\u00edvel de implicitude m\u00ednimo ou base, associado ao m\u00e9todo IMPES, e um n\u00edvel de ini-plicitude m\u00e1ximo, associado ao m\u00e9todo totalmente impl\u00edcito, e uma gama de n\u00edveis de implicitude intermedi\u00e1rios, alguns dos quais correspondem aos m\u00e9todos publicados na literatura.\nA seguir, revisar-se-\u00e1 sucintamente este enfoque geral e unificado dos m\u00e9todos empregados na simula\u00e7\u00e3o num\u00e9rica de reservat\u00f3rios. Partir-se-\u00e1 de um m\u00e9todo geral que consiste em resolver de maneira totalmente impl\u00edcita, mediante Newton-Raphson, as equa\u00e7\u00f5es n\u00e3o lineares de diferen\u00e7as (3.1) e (3.2) obtidas da aproxima\u00e7\u00e3o das equa\u00e7\u00f5es de fluxo multif\u00e1sico em reservat\u00f3rios.\nConsiderando-se, a bem da concis\u00e3o, um escoamento unidimensional, tem-se que a fun\u00e7\u00e3o de res\u00edduos para o componente \u00f3leo, F^, segue da equa\u00e7\u00e3o (3.1) como:\n, s\u201e\u201e) = A[r.(Ap. - 7oAJ9)]\u00ed\u201c+,) +&lt;U\"+,)\n-\t- (\u00bfSA)!\"\u2019] = 0\t(3-4)\nA fun\u00e7\u00e3o de res\u00edduo para o g\u00e1s, Fg[, \u00e9 similarmente definida da equa\u00e7\u00e3o (3.2).\nSOi+1) = A[Ts(Ap9 - 7sAD)],<\"+\u201d\n+A|T\u201e/\u00edt(Ap0 - -fcAfl)],1\"\"\u2019 + vj\"\"1 + (/?,\u00cd.\u00c7\u2018+\"\n(3.5)\nGeneralizando,\n, pOi,\t, pOi+1 5 ^>+j) \u2014 0\n/=\u00f3leo,g\u00e1s\nConsiderando (iz-f-l) como o n\u00edvel de itera\u00e7\u00e3o desconhecido, durante a solu\u00e7\u00e3o iterativa das inc\u00f3gnitas no n\u00edvel de tempo (n + 1), assim uma estimativa do res\u00edduo no n\u00f3 i, F^+1\\ pode ser feita atrav\u00e9s de uma expans\u00e3o em s\u00e9rie de Taylor deste res\u00edduo em torno de (f), retendo somente os termos inferiores,\nou\ni+l\ni=\u00bb-l\ndF^}\ndpo.\ndst\n= -F/t\u2019\n(3-6)\ni \u2014 l,2,...,m\nu = 0,1,2...,\nm=n\u00famero de blocos na malha\nonde \u00d3X(\u00ed?+1) s\u00e3o as mudan\u00e7as iterativas da inc\u00f3gnitas X(p0(,SOi), definidas como,\n\u00bfX(H-i) __\t\u2014 XM\n_fdri\nonde J \u00e9 a matriz Jacobiana ou a matriz de derivadas. Uma estimativa da solu\u00e7\u00e3o deve ser feita para se iniciar o processo de itera\u00e7\u00e3o; usualmente,\n;E(n+1)o) \u201e ^(n)\ne as itera\u00e7\u00f5es processam-se at\u00e9 que,\nQuando esta condi\u00e7\u00e3o \u00e9 satisfeita a solu\u00e7\u00e3o para o novo n\u00edvel de tempo (n + 1) \u00e9 alcan\u00e7ada.\nPara o n\u00f3 i, as equa\u00e7\u00f5es podem ser escritas como:\nr 9F-,\t3FO, -i\t(ri\tr\ta/% -i\t(ri\tr\t\t(ri\tL\t0 J\ti-1 \u00edi/4-11\tr\t1\t\n\t\t\t&amp;Po\u00ed\t\t\t\tasOi+1\t\t\u00bfPo\t\tFo\ndFv,\t3FSi\t\tSF9i\t\t\t\t3F91-\t\tx\u00e7\t\tF\nL\tJ\t\t. 5po,\taso, J\t\t- ^p\u00b0\u00ed+i\t^\u00ed+i J\t\t\tf 1/4-1 i\tL 1 9\nO Ap\u00eandice A cont\u00e9m a forma expandida das fun\u00e7\u00f5es de res\u00edduos para \u00f3leo e o g\u00e1s e o Ap\u00eandice B cont\u00e9m elementos da matriz Jacobiana.\nAntes de entrar em detalhes da abordagem geral, deve-se notar que as n\u00e3o linearidades nas equa\u00e7\u00f5es de diferen\u00e7as podem ser classificadas de acordo com sua origem nos termos de fluxo; de acumula\u00e7\u00e3o e de fonte/sumidouro, quais s\u00e3o:\n\u2022\tN\u00e3o linearidades nos termos de fluxo\nT - T(p, 5)\nA - Pc(^)\n7\t= 7\u00cdP, S)\n\u2022\tN\u00e3o linearidades nos termos de acumula\u00e7\u00e3o\n= ^(p)\nb = b(p,S)\n\u2022\tN\u00e3o linearidades provenientes dos termos fonte/sumi douro\nT = T(p, S)\nEni geral, as fun\u00e7\u00f5es de res\u00edduos cont\u00e9m n\u00e3o linearidades dos seguintes\ntipos:\nF {T(p, 5)[AP + AFC(5) + 7\u00dcb *?)],\t(T/To)(p, 5)\t,\t[^(p)\u00f2(p, 5)]\t};\n1,1\t\u201cV1 \"\t.S\ts,\ntermo de fluxo\ttermo fonte/sumidouro termo de acumula\u00e7\u00e3o\nassim, a matriz Jacobiana constitu\u00edda por derivadas parciais de F com rela\u00e7\u00e3o as vari\u00e1veis prim\u00e1rias pode ser decomposta na soma de matrizes particulares como se segue:\n[J]tj\tPH +\t\tdT' _dp_\t+\t'dT' dS\t+\t\u25a0^1+1 05]\t(\tdy dp\t4-\td'} dS\t}+\u2019.\tp\u00edTW] dp\t+\t[d(T/To)l dS\n+ (\t\t\t\t\t\ts >\t\t\t\t\t\t\t\n\tL &amp;P J\t\t\tL dS\t\t\t\t\t\t\t\t\t\nO Ap\u00eandice C mostra as quantidades envolvidas em cada uma destas\nmatrizes.\nOs m\u00e9todos de solu\u00e7\u00e3o existentes, conforme a, referencia [13], podem ser vistos como formas particulares do m\u00e9todo de solu\u00e7\u00e3o geral anteriormente descrito. Assim, m\u00e9todos podem ser deduzidos pela execu\u00e7\u00e3o, em um primeira etapa, de uma lineariza\u00e7\u00e3o preliminar parcial das fun\u00e7\u00f5es de res\u00edduos, reduzindo assim a matriz Jacobiana geral a su a correspondente forma:\nM\u00c9TODO 1 - M\u00c9TODO IMPES\nEste m\u00e9todo foi apresentado originalmente por Sheldon et alii [16] e Stone\n&amp;\tGarder [18] e a lineariza\u00e7\u00e3o preliminar parcial de F, conforme o mesmo, \u00e9:\nSimpes \u2014*\u2022\tS\u201d)[Ap + APC(5\") + 7(p\u201d, 5\")], (T/TJfp\", S\"), (<\u00a1AS)}\nSegue-se ent\u00e3o que,\n[J]zAfPES = P] +\n\u00edp(<MS)\nU\n\u00f3(^S)l dS\n\nM\u00c9TODO 2 - M\u00c9TODO DE SOLUC\u00c0O SIMULT\u00c2NEA\n0 m\u00e9todo de Solu\u00e7\u00e3o Simult\u00e2nea foi originalmente descrito por Douglas et alii [5], Posteriormente, novas vers\u00f5es foram apresentadas por Coats et alii [3] e Sheffield [15]. Uma revis\u00e3o destas \u00e9 apresentada por Aziz &amp; Settari [1]. A vers\u00e3o aqui descrita encontra-se na refer\u00eancia [1] que considera a seguinte lineariza\u00e7\u00e3o preliminar parcial de F,\n{T(p\\Sn)[Ap+APC(S) + 7^,S\u2019l)], (T/T\u00fa)^,Sn),(^S)}\nAssim,\n[J]ss = [T] +\n[W\t\t\t\td($bS)'\n_dS\t\u2022r s\tdp\tT\tdS\nou,\n\nM\u00c9TODO 3 - M\u00c9TODO SEM1-IMPL\u00cdCITO LINEARIZADO 1\nEste m\u00e9todo foi originalmente apresentado por diversos autores [8],[9],[10].\nNeste, a. lineariza\u00e7\u00e3o preliminar parcial de F \u00e9 como se segue,\n{T(p\\ S)[\u00e3p 4- APC(S) + 7(p\", 5\")], (T/T0)(pT 5), (^T)}\nAssim,\n+\n= [T] +\nd(T/Toy dS\n'&amp;(</>bsy\ndp\n\nou,\n= \u00a1T]ss +\nd(T/T0)'\ndS\nM\u00c9TODO 4 - M\u00c9TODO SEMI-IMPL\u00cdCITO LINEARIZADO 2\nUma alternativa ao m\u00e9todo anterior \u00e9 proposta na refer\u00eancia [13] na qual as transm\u00edssib\u00edlidades s\u00e3o avaliadas semi implicitamente tanto em press\u00e3o como em satura\u00e7\u00e3o. Desta forma, linearizando preliminarmente F como se segue,\nFsl-2 \u2014 Rp, T)[Ap + APC(S) + 7(pn>Sn)L (T/To)(p, S), (</>bS)}\nTem-se ent\u00e3o que,\n[J]sL-2 =\nfarl [arll\n4\n[apc]\nA 4- \u2014A\ndS\n'9(<i>bS)'\t\u00ed\t'\u00f4(4>bsy\ndp\t\"T\tdS\nm+{fe]\n+\n4\nou,\n[J]sL-2 =\t+\ndT\t\t\ndp\t3\tdp\ne finalmente,\nM\u00c9TODO 5 - M\u00c9TODO TOTALMENTE IMPL\u00cdCITO\nF\u201e {T^ s)[\u00e3p + AFXS) + 7\u00cdA S)]> (T/T0)(p, 5), (<f>bS)}\nSegue-se ent\u00e3o que,\n\t[dT\t\t\t\tppj\nP1 +\tdp\t+\t1&amp;S.\t+\tdS\n\t\t\t'd^bsy\t\t1\n1 dp .\t\t\u00ed\tdS\t\tJ\n[d\u00edT/T^\n[ dS\nou,\n[J]t/ = [JU-2 + |\t+ [^] }\nUm aspecto importante da abordagem geral dos m\u00e9todos apresentada na refer\u00eancia [13] \u00e9 a identifica\u00e7\u00e3o de uma matriz Jacobiana b\u00e1sica, associada ao m\u00e9todo IMPES, \u00bfimpes*. sendo que a sua transforma\u00e7\u00e3o \u00e0s matrizes Jacobianas dos outros m\u00e9todos d\u00e1-se mediante adi\u00e7\u00f5es de \u201cmatrizes corretivas\u201d. Assim, a abordagem geral permite estruturar de maneira simples e direta um simulador multi-formula\u00e7\u00f5es com diversos graus de implicitude.\nA refer\u00eancia [13] indica que as id\u00e9ias da abordagem geral s\u00e3o bastante convenientes sob o ponto de vista de uma formula\u00e7\u00e3o de implicitude vari\u00e1vel ou auto-adapt\u00e1vel; neste caso, as \u201ccorre\u00e7\u00f5es \u201d devem ser feitas a n\u00edvel local, em cada n\u00f3 da malha de c\u00e1lculo, conforme for preciso. Estas id\u00e9ias s\u00e3o aqui utilizadas e formara a base deste trabalho.\nComo mostrado anteriormente, o enfoque apresentado na refer\u00eancia [13] \u00e9 bastante conveniente sob o ponto de vista dos m\u00e9todos de implicitude vari\u00e1vel, uma vez que permite ir de um n\u00edvel de implicitude ao pr\u00f3ximo pela adi\u00e7\u00e3o de \u201cmatrizes corretivas\u201d \u00e0 matriz Jacobiana pr\u00e9via.\nA formula\u00e7\u00e3o de implicitude vari\u00e1vel aqui proposta resulta da aplica\u00e7\u00e3o destas corre\u00e7\u00f5es a n\u00edvel local em determinadas c\u00e9lulas da malha de c\u00e1lculo. Isto \u00e9, os componentes locais da matriz Jacobiana do m\u00e9todo totalmente impl\u00edcito s\u00e3o:\n\n\tJ\u00bb\tp7]\t\tra7i\nds.\ti\tdp\t+\tas]/ h J >\nd(4>bS) dS\nfpUVTJl\t. [W)l\t\t1\t'd^bsy\n.L dp\t\tdS ]\tJ.+\u00ed\t. dp .\n\n\u00c1 implicitude m\u00ednima no n\u00f3 i \u00e9\n{Pd/A\u00edFEs}\n'd(4>bsy\t\t'd^bsy\ndp\t4\u201c\tds\nOs diversos graus de implicitude requeridos localmente em cada n\u00f3 da malha s\u00e3o introduzidos com corre\u00e7\u00f5es operando a n\u00edvel local.\nUm aspecto importante que deve ser considerado na aplica\u00e7\u00e3o destas corre\u00e7\u00f5es \u00e9 que se deve compatibilizar o tratamento dos termos de fluxo entre as faces dos blocos da malha de c\u00e1lculo, que possuem graus de implicitude distintos. Objetiva-se com isto evitar a ocorr\u00eancia de erros de balan\u00e7o de massa. Considerando-se os n\u00f3s i e i \u2022+ 1, duas op\u00e7\u00f5es podem ser estudadas para resolver este problema.. A primeira, consiste no tratamento do termo de fluxo em (\u00ed + 1/2) com o grau de implicitude m\u00ednimo entre as\nFaz-se ent\u00e3o necess\u00e1rio sub-d\u00edvidir cada \u201cmatriz corretiva\u201d, relativa aos termos de fluxo, em duas outras: uma que relacione os termos provenientes do fluxo de i \u2014 1 para i e vice-versa denominada (\u00ed \u20141/2) e outra que relacione os termos provenientes do fluxo de i para i 4-1 e vice-versa denominada (\u00ed + 1 /2). Ou seja,\ntn = in_1/2+m,+1/2,\nar dp\n&amp;T\ndS\n\nA \u201cmatriz corretiva\u201d relativa aos termos de fonte/sumidouro \u00e9 sempre vinculada ao n\u00edvel de implicitude da, c\u00e9lula \u00e1 A \u201cmatriz de corre\u00e7\u00e3o\u201d relativa ao termo de acumula\u00e7\u00e3o \u00e9 sempre considerada com n\u00edvel de implicitude m\u00e1ximo (totalmente impl\u00edcito).\nPara exemplificar o tratamento local ser\u00e1 assumido que s\u00f3 existem dois tipos de c\u00e9lulas. Estas ser\u00e3o Totalmente Impl\u00edcitas ou IMPES. Suponha agora a situa\u00e7\u00e3o ilustrada na figura (3.1), para um n\u00facleo de c\u00e9lulas da malha de c\u00e1lculo.\nI (^1)\tI (0\tE (\u00ed + 1)\nFigura. 3.1: Exemplo de Aplica\u00e7\u00e3o do M\u00e9todo de Implicitude Vari\u00e1vel (\u00a1-Totalmente Impl\u00edcita / E-IMPES)\nComo mencionado anteriormente o termo de fluxo em (\u00bf4-1/2) e (i \u20141/2) dever\u00e1, para efeito de montagem do Jacobiano, ser admitido com a menor implicitude entre as c\u00e9lulas (i,i + 1) e (ij \u2014 1), respectivamente. Deduz-se com isto que a figura\n(3.1)\tapresenta uma face impl\u00edcita (\u00ed \u2014 1/2) e outra expl\u00edcita (i + 1/2). Pode-se ilustrar esquematicamente as equa\u00e7\u00f5es resultantes para o n\u00f3 i como\nKn =\t- 7oAjD))],-+1/3}/mpks - {[^(Apo \u25a0\u201d7o^jD))]\u00ed-i/2}t7\n+\u00ab\u00ab -\t- OSA)?0] = 0\ne FS1 pode ser obtida semelhantemente.\nPara a linha i da matriz Jacobiana tem-se que\nHH.H\n\u00bfX .\nex r = - [ F ],\n\u00bfX\nJ *4-1\nonde,\n\u00cd5T1\n[o],\nfarl\n\n\t\t\ndp\t\tdS \u00ed u J z\nDeve-se notar que as sub-matrizes [C]t- e [A]\u00bf possuem as parcelas (i \u2014 1/2) de todas as \u201cmatrizes corretivas\u201d uma vez que o fluxo em (i ~ 1 /2) \u00e9 considerado da maneira totalmente impl\u00edcita. Por outro lado, [A]; e [B]\u00bf possuem as parcelas (z + 1/2) apenas da sub-matriz de transmissibilidades [T];+i/2 de [jT]* pois, o fluxo em (\u00ed + 1/2) \u00e9 considerado do modo IMPES. Existem ainda em [A],- parcelas das \u201cmatrizes corretivas\u201d provenientes dos termos de acumula\u00e7\u00e3o e de fonte/sumidouro (derivadas em rela\u00e7\u00e3o a SOt e pOt).\nA figura (3.2) ilustra a estrutura matricial das equa\u00e7\u00f5es para o n\u00f3 com uma face impl\u00edcita e outra expl\u00edcita. Os x\u2019s representam valores n\u00e3o nulos. Notar que os valores nulos, para as derivadas em rela\u00e7\u00e3o \u00e0 satura\u00e7\u00e3o, na diagonal externa direita sao consequ\u00eancia do tratamento expl\u00edcito do termo de fluxo na face (i + 1/2).\nI\tI\tE\n(\u00ed-1)\t(0\t(i+1)\nDiagonal Externa Diagonal Central Impl\u00edcita\tP S\nDiagonal Externa\nExpl\u00edcita\nX x\nX X\nX o\nX o\nx x\nx x\nFigura 3.2: Estrutura das Diagonais Externas Impl\u00edcitas (I) e Expl\u00edcitas (E)\nEm resumo, assumindose que s\u00e3o conhecidos os graus de implicitude necess\u00e1rios a cada c\u00e9lula, monta-se o problema matricial, i.e. as fun\u00e7\u00f5es de res\u00edduos e a matriz Jacobiana, a partir da t\u00e9cnica anteriormente apresentada, o que constitui a formula\u00e7\u00e3o de implicitude vari\u00e1vel.\nEm geral, reconhece-se que graus de implicitude maiores s\u00e3o requeridos em regi\u00f5es onde as press\u00f5es e satura\u00e7\u00f5es sofrem varia\u00e7\u00f5es elevadas em um intervalo de tempo. Tipicamente, isso ocorre nas vizinhan\u00e7as de um po\u00e7o ou em processos que geram a forma\u00e7\u00e3o de frentes, como no caso de inje\u00e7\u00e3o de \u00e1gua e/ou g\u00e1s e segrega\u00e7\u00e3o gravitacional.\nPode-se fixar o grau de implicitude de duas formas, a saber: 1- manualmente e 2- automaticamente. No primeiro caso, define-se, com base na experi\u00eancia, um vetor fixo de implicitude que \u00e9 usado ao longo da simula\u00e7\u00e3o. Isto \u00e9, em um simulador assim equipado, fornece-se atrav\u00e9s de simples diretivas de entrada um grau de implicitude fixo a ser invocado em cada c\u00e9lula ativa ou sub-conjunto do n\u00famero total de c\u00e9lulas ativas. No segundo caso, \u00cdmplementa-se um algoritmo que permite controlar e modificar automaticamente, no espa\u00e7o e no tempo, o grau de implicitude em cada c\u00e9lula, conforme as necessidades locais. Este \u00faltimo procedimento d\u00e1 origem \u00e0 simula\u00e7\u00e3o com implicitude auto- adapt\u00e1vel.\nNo m\u00e9todo de implicitude auto-adapt\u00e1vel, os n\u00edveis de implicitude das c\u00e9lulas s\u00e3o definidos antes de se compor o problema matricial final. Acompanha-se o grau de implicitude em cada bloco da malha atrav\u00e9s de um vetor especial. 0 simulador toma conhecimento do valor deste vetor para cada bloco da malha quando, a cada momento, constr\u00f3i o problema matricial a ser resolvido. Claramente, o conte\u00fado deste poder\u00e1 mudar de itera\u00e7\u00e3o para itera\u00e7\u00e3o ou passo de tempo para passo de tempo,a medida que o grau de implicitude em cada c\u00e9lula muda. Desta maneira, na constru\u00e7\u00e3o de um m\u00e9todo de implicitude auto-adapt\u00e1vel, necessita-se da defini\u00e7\u00e3o de um crit\u00e9rio de troca que determine a implicitude adequada. Se este crit\u00e9rio n\u00e3o for eficiente na determina\u00e7\u00e3o dos graus de implicitude, o m\u00e9todo poder\u00e1 fornecer respostas inst\u00e1veis, bem como apresentar aumento no n\u00famero de itera\u00e7\u00f5es na resolu\u00e7\u00e3o de um passo de tempo.\nO problema do controle autom\u00e1tico de implicitude tem sido estudado em detalhes, como pode-se verificar na an\u00e1lise das referencias [6],[7],[11],[14],[19],[20]. Em geral, os m\u00e9todos de controle de implicitude operam a nivel de inc\u00f3gnita, urna vez que trabalham acoplados \u00e0 formula\u00e7\u00f5es que atuam tamb\u00e9m sobre estas. Por exemplo, alguns autores [6],[19],[20] defendem o uso de um crit\u00e9rio baseado em mudan\u00e7as observadas nas inc\u00f3gnitas expl\u00edcitas (satura\u00e7\u00f5es ou composi\u00e7\u00f5es). Em tal crit\u00e9rio, uma vez que uma inc\u00f3gnita mude de mais do que uma quantidade pr\u00e9-determinada em uma itera\u00e7\u00e3o ou passo de tempo, esta inc\u00f3gnita \u00e9 feita impl\u00edcita para o resto da simula\u00e7\u00e3o, ou pelo menos at\u00e9 a pr\u00f3xima mudan\u00e7a de vaz\u00e3o nos po\u00e7os.\nEste crit\u00e9rio, semelhantemente a outros encontrados na literatura, nao poderia ser acoplado diretamente \u00e0 formula\u00e7\u00e3o de implicitude vari\u00e1vel aqui apresentada. Neste estudo, o grau de implicitude, ou seja, o tratamento que se deve dar \u00e0s nao linearidades, tem que ser fixado de acordo com an\u00e1lises de estabilidade das poss\u00edveis formas de lineariza\u00e7\u00e3o das equa\u00e7\u00f5es. Desta maneira, a an\u00e1lise de estabilidade para o m\u00e9todo IMPES publicada na literatura [1],[11] foi adaptada e usada no desenvolvimento de um algoritmo de controle autom\u00e1tico que contempla dois n\u00edveis de implicitude extremos, IMPES e Totalmente Impl\u00edcito.\nA an\u00e1lise de estabilidade para o m\u00e9todo IMPES existente na literatura pode ser expressa por:\nAi vx , ----\u00a3_ &lt;i \u00bf Ax ~ \u2019\n(4.1)\nque significa que a frente de avan\u00e7o (em uma inje\u00e7\u00e3o de \u00e1gua, por exemplo) s\u00f3 pode caminhar a dist\u00e2ncia de um bloco por passo de tempo ou ainda, que o volume de fluido que escoa atrav\u00e9s de um bloco em um passo de tempo deve ser menor que o volume poroso deste. Em termos de vaz\u00e3o\nEste limite de estabilidade considera algumas hip\u00f3teses simplificadoras quais sejam:\n\u00ab fluxo incompress\u00edvel,\n\u00bb press\u00e3o capilar nula,\n* efeitos gravitad onais desprez\u00edveis.\nA troca de c\u00e9lulas totalmente impl\u00edcitas para c\u00e9lulas IMPES e vice-versa obedeceu ent\u00e3o a um crit\u00e9rio que se baseia na express\u00e3o (4.2). Ou seja, se o fluxo total atrav\u00e9s das faces do bloco da malha for maior que um fator,\tdo volume poroso no\nbloco a montante, ent\u00e3o, o bloco a montante \u00e9 considerado impl\u00edcito; caso contr\u00e1rio o m\u00e9todo IMPES \u00e9 usado. A experi\u00eancia mostrou que Fcor\u00ede\u20140.005 volumes porosos \u00e9 um bom crit\u00e9rio e o seu aumento muito acima deste valor faz com que o n\u00famero de itera\u00e7\u00f5es Newtonianas tenda a crescer. Por outro lado, o decr\u00e9scimo deste valor provoca o aumento do n\u00famero de c\u00e9lulas impl\u00edcitas e consequentemente a eleva\u00e7\u00e3o do tempo para solu\u00e7\u00e3o do problema.\nDois outros crit\u00e9rios auxiliares foram tamb\u00e9m usados: 1- Se a satura\u00e7\u00e3o de uma fase em um bloco da malha ultrapassar a satura\u00e7\u00e3o cr\u00edtica durante um dado passo de tempo, a c\u00e9lula \u00e9 ent\u00e3o considerada totalmente impl\u00edcita neste passo de tempo. Isto \u00e9 feito, principalmente, para evitar que mudan\u00e7as r\u00e1pidas no fluxo de g\u00e1s livre tornem o processo inst\u00e1vel. 2- Uma vez que um bloco tenha sido determinado como exigindo tratamento totalmente impl\u00edcito, ele fica desta forma em todas as demais itera\u00e7\u00f5es Newtonianas daquele passo de tempo.\nO crit\u00e9rio de mudan\u00e7a de implicitude empregado exige um trabalho adicional m\u00ednimo, j\u00e1 que os termos de fluxo, que s\u00e3o parte das fun\u00e7\u00f5es de res\u00edduos, s\u00e3o\nResumindo, um par\u00e2metro de entrada, i.e. Fcorte, controla o tipo de simula\u00e7\u00e3o. Se Fcori/. \u00e9 zero, a simula\u00e7\u00e3o \u00e9 totalmente impl\u00edcita. Se Fcorie for elevado, a simula\u00e7\u00e3o \u00e9 IMPES e se for em torno de 0.005 volume porosos, tem-se a escolha do grau de implicitude dos blocos dinamicamente a cada passo de tempo.\nO cap\u00edtulo anterior mostrou como um m\u00e9todo de implicitude vari\u00e1vel pode ser aplicado em problemas \u201cblack-oil\u201d, considerando-se que \u00e9 sabido os n\u00edveis de implicitude de cada c\u00e9lula. Definir o crit\u00e9rio de troca que determine a implicitude \u00e9 um dos principais desafios que deve ser superado em implementa\u00e7\u00f5es pr\u00e1ticas. Se o crit\u00e9rio permitir um grau de implicitude baixo em diversas c\u00e9lulas, a converg\u00eancia Newtoniana ser\u00e1 desacelerada, fornecendo respostas inst\u00e1veis. Se ele for\u00e7ar muitas c\u00e9lulas com elevados graus de implicitude o m\u00e9todo ir\u00e1 funcionar, mas o tempo computacional ser\u00e1 desperdi\u00e7ado e dispers\u00e3o num\u00e9rica desnecess\u00e1ria ir\u00e1 aparecer. Utilizou-se neste estudo um crit\u00e9rio que exige alguma participa\u00e7\u00e3o do usu\u00e1rio (na determina\u00e7\u00e3o de\te que n\u00e3o abrange toda a\ngama de graus de implicitude que poderiam ser considerados na formula\u00e7\u00e3o de implicitude vari\u00e1vel aqui apresentada.\nAs equa\u00e7\u00f5es discretizadas do m\u00e9todo de implicitude auto-adapt\u00e1vel foram apresentadas nas equa\u00e7\u00f5es (2.6) e (2.7). Como visto no cap\u00edtulo (3.2), ap\u00f3s alguma manipula\u00e7\u00e3o alg\u00e9brica, estas equa\u00e7\u00f5es podem ser reduzidas a forma matricial\nJ.\u00d3X = -F\nA matriz J tem uma estrutura de banda, por blocos sendo, no caso em estudo, cada bloco uma sub-matriz 2x2 correspondente a cada c\u00e9lula ativa da malha. Uma redu\u00e7\u00e3o de Gauss-Jord\u00e1n \u00e9 efetuada nas sub-matrizes ao longo da diagonal principal para reduzi-las a sub-matrizes diagonais [20],[21]. Ou seja, ap\u00f3s a constru\u00e7\u00e3o do sistema Jacobiano, cada linha de bloco da matriz \u00e9 multiplicada pela inversa correspondente da sub-matriz diagonal principal. Para c\u00e9lulas IMPES, esta opera\u00e7\u00e3o efetivamente elimina as vari\u00e1veis de satura\u00e7\u00e3o destas do sistema. A redu\u00e7\u00e3o do sistema pode ser vista como a seguir. Se a c\u00e9lula i for IMPES, ent\u00e3o ap\u00f3s a multiplica\u00e7\u00e3o pela inversa da diagonal, as \u00fanicas entradas n\u00e3o nulas nas colunas correspondentes a\taparecem na diagonal da\nsub-matriz diagonal para a c\u00e9lula i. Isto significa que a equa\u00e7\u00e3o resultante contendo as derivadas dependentes de\tpodem ser resolvidos em uma segunda etapa, uma vez que\nnenhuma outra equa\u00e7\u00e3o mostra depend\u00eancia nas derivadas de\tAp\u00f3s resolver para\nas outras vari\u00e1veis prim\u00e1rias,\tpode ser determinada por substitui\u00e7\u00e3o regressiva.\nEm nota\u00e7\u00e3o matricial tem-se que J \u00e9 colocada em uma forma reduc\u00edvei por opera\u00e7\u00f5es equivalentes para descobrir uma matriz de permuta\u00e7\u00e3o P tal que\nPJP7\nJS1 J12\n0\tj22\nAqui Jn \u00e9 uma sub-matriz diagonal constitu\u00edda de coeficientes modificados das vari\u00e1veis expl\u00edcitas, enquanto J12 e J22 s\u00e3o sub-matrizes constitu\u00eddas dos coeficientes modificados das vari\u00e1veis impl\u00edcitas. A ordem de J22 \u00e9 igual ao n\u00famero total de vari\u00e1veis impl\u00edcitas. Pela parti\u00e7\u00e3o de \u00bfX e F similarmente a PJPT, o problema matricial fica\n- -Fj\t(5.1)\nj22\u00bfx2 = -f2\t(5.2)\nA solu\u00e7\u00e3o da equa\u00e7\u00e3o (5.2) para a parti\u00e7\u00e3o impl\u00edcita X2 consome a maioria do tempo computacional; no entanto, \u00e9 significativamente menor do que aquele onde todas inc\u00f3gnitas s\u00e3o impl\u00edcitas e a equa\u00e7\u00e3o J.\u00e1X = \u2014F \u00e9 resolvida. Al\u00e9m do mais, neste caso a elimina\u00e7\u00e3o Gaussiana torna-se economicamente poss\u00edvel para malhas bastante grandes, o que n\u00e3o ocorre em uma abordagem totalmente impl\u00edcita. A solu\u00e7\u00e3o da equa\u00e7\u00e3o\n(5.1)\tpara a parti\u00e7\u00e3o expl\u00edcita \u00daXj consome essencialmente um tempo n\u00e3o superior do que uma substitui\u00e7\u00e3o regressiva em uma elimina\u00e7\u00e3o gaussiana. Mais ainda, pode-se economizar mem\u00f3ria uma vez que as equa\u00e7\u00f5es (5.1) e (5.2) s\u00e3o equa\u00e7\u00f5es matriciais independentes de menor ordem do que a equa\u00e7\u00e3o J.\u00d3X \u2014 \u2014 F. Uma vez que o n\u00famero total de c\u00e9lulas impl\u00edcitas \u00e9 sujeito a mudar de itera\u00e7\u00e3o para itera\u00e7\u00e3o (ou passo de tempo para passo de tempo), a ordem de J22 n\u00e3o \u00e9 fixa,mas pode mudar dinamicamente. Como ilustra\u00e7\u00e3o considere o sistema bidimensional simplificado de 3x2 com o padr\u00e3o de c\u00e9lulas impl\u00edcitas /IMPES como mostrado na figura (5.1). Admite-se uma ordena\u00e7\u00e3o normal para a malha. A estrutura da matriz Jacobiana correspondente a este problema \u00e9 mostrada na figura\n(5.2)\t. Os x\u2019s representam valores n\u00e3o nulos - alguns destes podem ser elementos nulos se uma fase em particular tornar-se im\u00f3vel. Esta matriz \u00e9 diagonalizada para alcan\u00e7ar\no problema matricial cuja estrutura \u00e9 mostrada na figura (5.3). 0 processamento preliminar da matriz para a redu\u00e7\u00e3o do bloco diagonal a sub-matrizes identidade de 2x2 n\u00e3o altera de nenhuma maneira a estrutura das entradas nulas. N\u00e3o \u00e9 necess\u00e1rio calcular as entradas nulas. Assim, existe uma economia de esfor\u00e7o na constru\u00e7\u00e3o do Jacobiano. Trocas apropriadas de linhas e colunas s\u00e3o ent\u00e3o efetuadas para se alcan\u00e7ar o problema reduzido mostrado na figura (5.4).\n2\n1\n1\t2\t3\nI\tE\tE\nI\tE\ttu\nFigura 5.1: Exemplo Bidimensional com um padr\u00e3o TotalmeateTmpI\u00edcito (I) - IMPES(E)\nX\tX\tX\to\t\t\tX\tX\t\t\t\t\nX\tX\tX\to\t\t\tX\tX\t\t\t\t\nX\to\tX\tX\tX\to\t\t\tX\t0\t\t\nX\t0\tX\tX\tX\t0\t\t\tX\t0\t\t\n\t\tX\to\tX\tX\t\t\t\t\tX\to\n\t\tX\to\tX\tX\t\t\t\t\tX\to\nX\tX\t\t\t\t\tX\tX\tX\t0\t\t\nX\tX\t\t\t\t\tX\tX\tX\to\t\t\n\t\tX\to\t\t\tX\to\tX\tX\tX\t0\n\t\tX\to\t\t\tX\to\tX\tX\tX\to\n\t\t\t\tX\to\t\t\tX\t0\tX\tX\n\t\t\t\tX\t0\t\t\tX\to\tX\tX\n6Snt\n$P<>33.\n\u00eapOi2\nSSOi2\n\u00e8SO22\n^P&amp;\u00edt\nSSQ32\nFigura 5,2: Matriz J\n1\t0\tX\t0\t\t\tX\tX\t\t\t\t\n0\t1\tX\to\t\t\tX\tX\t\t\t\t\nX\to\t1\to\tX\to\t\t\tX\to\t\t\nX\to\to\t1\tX\to\t\t\tX\to\t\t\n\t\tX\to\t1\to\t\t\t\t\tX\to\n\t\tX\to\to\t1\t\t\t\t\tX\to\nX\tX\t\t\t\t\t1\to\tX\to\t\t\nX\tX\t\t\t\t\t0\t1\tX\to\t\t\n\t\tX\to\t\t\tX\t0\t1\to\tX\to\n\t\tX\to\t\t\tX\to\to\t1\tX\to\n\t\t\t\tX\t0\t\t\tX\to\t1\to\n\t\t\t\tX\to\t\t\tX\to\to\t1\n\u00bfSO11\n^Po21 fj\u00c7\n\u00e8pasi\n^Pol2\nSSOli\n^P\u00b022\nSS^2 fyo32\nF*\n7 ffu\nP*\nou\nF\u2019\n921 F*\n\u00bb21\nF*\n531 /?*\naji\nF\u2019\n912\nF*\n012\nF*\n922 p*\n022\nF*\ngs2\nF*\n032\nFigura 5.3: Problema Matricial ap\u00f3s Redu\u00e7\u00e3o de Gauss-Jordan nos Blocos Diagonais\n^21 ^al\nssO32 \u00bfPon\n\u00bfSOll\nfy>O21\n&amp;PO31\n^Pt>12 \u00bfq\nVJO12 $PO22 ^Po^2\nF*\n021\nF\u00bb\n031\nF*\n022\nF*\n032\nF*\n911\nF*\nOu\nF*\n921 /?*\n531\nF*\n912\nF*\n012\nK1*\n522\nF*\n532\nFigura 5.4: Problema Matricial Reduzido\nNa implementa\u00e7\u00e3o do m\u00e9todo de implicitude auto-adapt\u00e1vel, n\u00e3o foi necess\u00e1rio programar literalmente as manipula\u00e7\u00f5es matriciais formais discutidas anteriormente. No entanto, as mesmas opera\u00e7\u00f5es num\u00e9ricas foram efetuadas. Processou-se o Jacobiano ap\u00f3s o seu c\u00e1lculo, para que este alcan\u00e7asse sua forma final da seguinte maneira. Multiplicou-se cada linha de bloco da matriz, inclusive o termo independente, pela\ninversa correspondente da sub-matriz diagonal. Resolveu-se ent\u00e3o o sistema resultante com a utiliza\u00e7\u00e3o da subrotina NSPIV [17]. Esta, rotina exige como dado de entrada um vetor que especifique a ordem de elimina\u00e7\u00e3o das equa\u00e7\u00f5es. Este vetor \u00e9 montado a cada itera\u00e7\u00e3o, a depender da. configura\u00e7\u00e3o de c\u00e9lulas IMPES-Impl\u00edcitas existentes na malha. Nas primeiras posi\u00e7\u00f5es est\u00e3o as equa\u00e7\u00f5es que relacionam as satura\u00e7\u00f5es das c\u00e9lulas IMPES em ordem de numera\u00e7\u00e3o da malha. Ap\u00f3s estas constam as inc\u00f3gnitas de press\u00e3o e satura\u00e7\u00e3o das c\u00e9lulas impl\u00edcitas intercaladas pelas inc\u00f3gnitas de press\u00e3o das c\u00e9lulas IMPES, utilizando-se o sentido de ordena\u00e7\u00e3o da malha. Resumindo, as etapas da figura (5.4) s\u00e3o efetuadas automaticamente pela rotina NSPIV, a partir do fornecimento da matriz da figura. (5.3) e de um vetor de ordena\u00e7\u00e3o adequado. Montou-se com isto um eficiente c\u00f3digo que combina alguns dos passos formais, tirando-se vantagem da esparsidade das matrizes envolvidas.\n6 Aplica\u00e7\u00f5es Pr\u00e1ticas\nUma compara\u00e7\u00e3o entre as abordagens de impl\u00edcitude vari\u00e1vel , auto-adapt\u00e1vel e totalmente impl\u00edcita foi efetuada atrav\u00e9s de dois casos-exemplos. A t\u00e9cnica totalmente impl\u00edcita usa o mesmo m\u00e9todo de solu\u00e7\u00e3o do que na abordagem de impl\u00edcitude auto-adapt\u00e1vel, exceto que iodos os blocos s\u00e3o impl\u00edcitos ao longo de toda a rodada. A abordagem de impl\u00edcitude vari\u00e1vel usa o mesmo m\u00e9todo de solu\u00e7\u00e3o do que na abordagem de impl\u00edcitude auto-adapt\u00e1vel, exceto que o grau de impl\u00edcitude dos blocos \u00e9 manualmente escolhido e permanece fixo ao longo de toda a simula\u00e7\u00e3o.\n6.1\tCaso 1\n0 caso-exemplo 1 teve como objetivo simular o fluxo radial de um reservat\u00f3rio horizontal produzindo por uni po\u00e7o. No caso em estudo, o reservat\u00f3rio encontrava-se inicialmente em repouso e contendo \u00f3leo subsaturado, n\u00e3o apresentando fluxo atrav\u00e9s do seu limite externo e produzindo com vaz\u00e3o constante na superf\u00edcie at\u00e9 o alcance de uma press\u00e3o m\u00ednima de fluxo. Quando a press\u00e3o m\u00ednima de fluxo \u00e9 atingida passa ent\u00e3o a produzir com press\u00e3o constante de fluxo, at\u00e9 atingir uma vaz\u00e3o m\u00ednima de produ\u00e7\u00e3o. 0 po\u00e7o est\u00e1 completado no bloco (1,1). Uma vista em se\u00e7\u00e3o transversal \u00e9 apresentada na figura (6.1) e as propriedades do reservat\u00f3rio e outros dados b\u00e1sicos pertinentes est\u00e3o relacionados na tabela (6.1). Fun\u00e7\u00f5es da satura\u00e7\u00e3o e propriedades PVT est\u00e3o ilustradas nas tabelas (6.2), (6.3), (6.4) e (6.5).\nFigura 6.1: Modelo do Reservat\u00f3rio - Se\u00e7\u00e3o Transversal\nEste simulador pode tamb\u00e9m operar com um m\u00e9todo de implicitude auto-adapt\u00e1vel (m\u00e9todo AIMj. O acionamento desta flexibilidade d\u00e1-se atrav\u00e9s de um simples par\u00e2metro de implicitude que \u00e9 fornecido como dado de entrada. Este pode variar de 1 a 3. Caso tenha valor id\u00eantico a 1, o SIMBEST resolver\u00e1 o problema de forma IMPES. Se for igual a 3, o problema ser\u00e1 resolvido com um m\u00e9todo totalmente impl\u00edcito. Valores intermedi\u00e1rios significam que o problema ser\u00e1 resolvido atrav\u00e9s do seu m\u00e9todo de implicitude auto-adapt\u00e1vel. Estes, quando fornecidos, procuram ser atendidos, mas o simulador aumenta ou reduz o valor deste par\u00e2metro de entrada de modo a manter a solu\u00e7\u00e3o est\u00e1vel. Para que o usu\u00e1rio tome conhecimento de como est\u00e1 sendo efetuada esta varia\u00e7\u00e3o s\u00e3o emitidos ent\u00e3o os valores adotados a cada passo de tempo, bem como o valor m\u00e9dio ao longo de toda a rodada.\nGeometria\nExtens\u00e3o radial, m\t500\nRaio do po\u00e7o, m\t0,1\nN\u00famero de blocos radiais\t10\nN\u00famero de camadas verticais\t10\nAngulo de mergulho, grau\t0\nProfundidade da forma\u00e7\u00e3o, m\t5060\nEspessura da forma\u00e7\u00e3o, m\t40\nDados de Rocha e Fluido\nPorosidade, fra\u00e7\u00e3o\t0,30\nPermeabilidade absoluta na dire\u00e7\u00e3o x, m2\t9,86923xl0~14\nPermeabilidade absoluta na dire\u00e7\u00e3o z^ m2\t9,86923xl0\u201d14\nCompressibilidadeda rocha, MPa\"1\t4,4xl0~4\nMassa espec\u00edfica do \u00f3leo em condi\u00e7\u00f5es padr\u00e3o, kg/m3\t49,2\nDensidade do g\u00e1s em condi\u00e7\u00f5es padr\u00e3o, adimensional\t0,79\nCondi\u00e7\u00f5es Iniciais\nProfundidade de refer\u00eancia, m\t5098\nPress\u00e3o na profundidade de refer\u00eancia, MPa\t33,09\nSatura\u00e7\u00e3o de \u00e1gua irredut\u00edvel, fra\u00e7\u00e3o\t0,12\nDados do Po\u00e7o\nBlocos completados\t(1,1)\nPress\u00e3o de fluxo de fundo de po\u00e7o m\u00ednima, MPa\t7\nVaz\u00e3o de \u00f3leo para abandono, m3/d\t30\nHist\u00f3rico de Produ\u00e7\u00e3o\nVaz\u00e3o m\u00e1xima de \u00f3leo produzida, m3/d\t300\nTabela 6.1: Descri\u00e7\u00e3o do Reservat\u00f3rio e Dados B\u00e1sicos (Caso 1)\nFun\u00e7\u00f5es G\u00e1s-\u00d3leo\nk\n(fra\u00e7\u00e3o )\nW\n0,000\t0,000\t1,0000\t0,0\n0,020\t0,000\t0,9970\t0,0\n0,050\t0,005\t0,9800\t0,00108\n0,130\t0,025\t0,7000\t0,00861\n0,180\t0,075\t0,3500\t0,02910\n0,230\t0,125\t0,2000\t0,06890\n0,280\t0,190\t0,0900\t0,13440\n0,380\t0,410\t0,0210\t0,36920\n0,430\t0,600\t0,0100\t0,55090\n0,530\t0,720\t0,0010\t1,07600\n0,580\t0,795\t0,0005\t1,25300\n0,630\t0,870\t0,0001\t1,43000\n0,730\t0,940\t0,0000\t2,36000\n0,780\t0,960\t0,0000\t2,94500\n0,830\t0,980\t0,0000\t3,53000\n0,880\t1,000\t0,0000\t5,03000\nTabela 6.2: Fun\u00e7\u00f5es da Satura\u00e7\u00e3o\nPropriedades PVT do G\u00e1s\nPress\u00e3o (MPa)\tg (m3CR/m3CS)\tViscosidade (Pa.s)\tMassa Espec\u00edfica (kg/m3)\n0,11\t0,83661\t0,0080xl0\u201d3\t1,2\n7,01\t0,01793\t0,0140xl0-3\t53,9\n13,90\t0,00905\t0,0189xl0\"3\t106,7\n20,79\t0,00606\t0,0228xl0~3\t159,4\n27,68\t0,00455\t0,0268xl0-3\t212,3\n34,57\t0,00364\t0,0309xl0\"3\t265,4\n41,46\t0,00311\t0,0349x1O\u201d3\t310,6\n48,35\t0,00272\t0,0389x1O\u20193\t355,1\n55,24\t0,00241\t0,0430xl0\u201d3\t400,8\n62,13\t0,00217\t0,0470xl0~3\t\n69,02\t0,00197\t0,0510xl0~3\t490,3\nTabela 6.3: Propriedades PVT do G\u00e1s\nPropriedades PVT do \u00d3leo Saturado\nPress\u00e3o\tB\u00ab\tViscosidade\tMassa Espec\u00edfica\tRaz\u00e3o de Solubilidade\n(MPa)\t(m3CR/m3CS)\t(Pa.s)\t(kg/m3)\t(m3CS/m3CS)\n0,11\t1,0628\tl,0394xl0~3\t741,8\t0,35\n7,01\t1,2952\t0,8299xl0-3\t657,7\t66,15\n13,90\t1,4352\t0,6949x10\"3\t660,5\t113,36\n20,79\t1,5650\t0,5940x10\u201d3\t605,7\t165,59 .\n27,68\t1,6950\t0,5100xl0~3\t593,8\t226,20\n34,57\t1,8270\t0,4490x10-3\t583,7\t288,20\n41,46\t1,9594\t0,3875xl0\"3\t574,2\t348,96\n48,35\t2,0918\t0,3261xl0~3\t565,9\t409,72\n55,24\t2,2242\t0,2646xl0\u201d3\t558,6\t470,48\n62,13\t2,3567\t0,2032xl0~3\t552,1\t531,25\n69,02\t2,4891\t0,1417xl0~3\t546,3\t592,01\nPropriedades PVT do \u00d3leo Sub-Saturado\nPress\u00e3o\tBo\tViscosidade\tMassa Espec\u00edfica\tRaz\u00e3o de Solubilidade\n(MPa)\t(m3CR/m3CS)\t(Pa.s)\t(kg/m3)\t(m3CS/m3CS)\n27,68\t1,695\t0,510xl0-3\t593,8\t226,2\n62,15\t1,579\t0,740xl0\"3\t637,6\t226,2\nTabela 6.4: Propriedades PVT do \u00d3leo\nPropriedades PVT da Agua\nPress\u00e3o (MPa)\t(m3CR/m3CS)\tViscosidade (Pa.s)\tMassa Espec\u00edfica (kg/m3)\n0,10\t1,0410\t0,310xl0~3\t997,0\n1,82\t1,0403\t0,310xl0~3\t997,7\n3,55\t1,0395\t0,310xl0~3\t998,4\n7,00\t1,0380\t0,310xl0\u201c3\t999,8\n13,89\t1,0350\t0,310xl0\u201d3\t1002,7\n17,34\t1,0335\t0,310xl0\"3\t1004,2\n20,79\t1,0320\t0,310xl0~3\t1005,7\n27,68\t1,0290\t0,310xl0'\"3\t1008,6\n34,57\t1,0258\t0,310xl0-3\t1011,7\n62,15\t1,0130\t0,310xl0-3\t1024,5\nTabela 6.5: Propriedades PVT da \u00c1gua\nUma compara\u00e7\u00e3o dos resultados da simula\u00e7\u00e3o (curvas de press\u00e3o de fluxo de fundo de po\u00e7o, vaz\u00e3o de \u00f3leo e raz\u00e3o g\u00e1s*\u00f3leo versus tempo) entre as rodadas totalmente impl\u00edcita e do SIMBEST com par\u00e2metro de implicitude igual a 3 (totalmente impl\u00edcito) \u00e9 mostrada nas figuras (6.2),(6.3) e (6.4). Em geral, as diferen\u00e7as apresentadas entre os resultados obtidos com o simulador num\u00e9rico desenvolvido e os obtidos com o SIMBEST s\u00e3o desprez\u00edveis.\n0 SIMBEST, no seu modo AIM, tamb\u00e9m foi utilizado na resolu\u00e7\u00e3o deste problema, tendo alcan\u00e7ada uma economia de tempo de 15% em rela\u00e7\u00e3o ao tempo gasto no seu modo totalmente impl\u00edcito. 0 par\u00e2metro de implicitude m\u00e9dio da rodada foi igual a 2,85 (praticamente o m\u00e9todo totalmente impl\u00edcito).\nFigura 6.2: Press\u00e3o de Fluxo de Fundo de Po\u00e7o versus Tempo (compara\u00e7\u00e3o com o SIMBEST)\n/\nFigura 6.3: Vaz\u00e3o de Oleo versus Tempo (compara\u00e7\u00e3o com o SIMBEST)\nOs resultados obtidos com o simulador desenvolvido para este caso sao mostrados na tabela (6.6). Para as rodadas de impl\u00edcitude auto-adapt\u00e1vel, o bloco do po\u00e7o e seus vizinhos mais pr\u00f3ximos foram considerados totalmente impl\u00edcitos inicialmente, enquanto que, no resto do reservat\u00f3rio, adotou-se blocos IMPES. Uma economia de tempo de 12% foi alcan\u00e7ada.\n\tA uto-adapt\u00e1vel\tTotalmente Impl\u00edcito\nN\u00famero total de passos de tempo\t534\t533\nN\u00famero total de itera\u00e7\u00f5es\t1248\t1235\nItera\u00e7\u00f5es /Passo de tempo\t2,34\t2,32\nTempo total (seg)\t3016\t3432\nTempo/Itera\u00e7\u00e3o (seg)\t2,42\t2,78\nC\u00e9lulas IMPES (%)\t18\t0\nTabela 6.6: Resultados do Caso 1\nUm primeiro aspecto a ser destacado \u00e9 a proximidade dos valores encontrados para a economia de tempo do m\u00e9todo de implicitude auto-adapt\u00e1vel em rela\u00e7\u00e3o ao m\u00e9todo totalmente impl\u00edcito nos dois simuladores. Note ainda que se pode fazer uma analog\u00eda com o alto valor para o par\u00e2metro de impl\u00edcitude m\u00e9dio obtido no SIMBEST e a porcentagem relativamente baixa de blocos IMPES no simulador desenvolvido. Ou seja, o problema exige, para sua solu\u00e7\u00e3o, um n\u00edvel de impl\u00edcitude bem alto, pr\u00f3ximo do m\u00e9todo totalmente impl\u00edcito. Outro aspecto \u00e9 que o SIMBEST relata par\u00e2metros de implicitude baixos e pr\u00f3ximos de 1 no in\u00edcio da simula\u00e7\u00e3o e que se elevam at\u00e9 valores bastante pr\u00f3ximos de 3 ao final. Por sua vez, a rodada com o simulador desenvolvido apresenta uma porcentagem de c\u00e9lulas IMPES bastante elevada no in\u00edcio da simula\u00e7\u00e3o, a qual se reduz para aproximadamente zero ao final da rodada. Pode-se notar com isto a concord\u00e2ncia no comportamento de ambos os simuladores.\nPode-se ver que o ganho de tempo com o m\u00e9todo de implicitude auto-adapt\u00e1vel foi modesto. Existem diversas raz\u00f5es para isto. 0 problema apresenta uma\nEste resultado \u00e9 t\u00edpico em problemas moderadamente dif\u00edceis para dif\u00edceis, os ganhos de tempo dos m\u00e9todos de impl\u00eddtude auto-adapt\u00e1vel s\u00e3o modestos. Em problemas simples, onde a maioria dos blocos s\u00e3o tratados expl\u00edcitamente, a economia de tempo \u00e9 significativa.\nUma compara\u00e7\u00e3o dos resultados da simula\u00e7\u00e3o (curvas de press\u00e3o de fluxo de fundo de po\u00e7o, vaz\u00e3o de \u00f3leo e raz\u00e3o g\u00e1s-\u00f3leo versus tempo) impl\u00edcita e de implici-tude auto-adapt\u00e1vel \u00e9 mostrada nas figuras (6.5),(6,6) e (6.7). Como esperado, as duas abordagens produzem resultados praticamente id\u00eanticos. Sendo assim, a prefer\u00eancia para uma abordagem sobre a outra baseia-se fundamentalmente no tempo de processamento, exig\u00eancia de mem\u00f3ria e facilidade de aplica\u00e7\u00f5es.\nFigura 6.6: Vaz\u00e1o de Oleo versus Tempo (Caso 1)\nFigura 6.7: Raz\u00e1o G\u00e1s-Oleo versus Tempo (Caso 1)\n6.2\tCaso 2\nUsualmente a simula\u00e7\u00e3o de problemas de conifica\u00e7\u00e3o de po\u00e7o requer um n\u00edvel de implic\u00edtude acima do de primeiro grau (m\u00e9todo IMPES), devido \u00e0s acentuadas varia\u00e7\u00f5es de fluxo nas vizinhan\u00e7as do po\u00e7o. A tend\u00eancia tem sido a de se tratar a coni-fica\u00e7\u00e3o de g\u00e1s com um simulador totalmente impl\u00edcito. Para determinar os verdadeiros n\u00edveis de implidtude exigidos por tais sistemas, investigaremos um problema hipot\u00e9tico no qual um po\u00e7o sofre uma severa conifica\u00e7\u00e3o de g\u00e1s. Outro objetivo \u00e9 determinar a quantidade de esfor\u00e7o desperdi\u00e7ada, se houver, envolvida em um tratamento impl\u00edcito.\nO modelo consiste de dez blocos na dire\u00e7\u00e3o radial, um na dire\u00e7\u00e3o angular e dez camadas verticais. Um po\u00e7o central produz da camada 5 com uma press\u00e3o de fundo de po\u00e7o fixa de 22,72 MPa na camada. A queda de press\u00e3o m\u00e9dia inicial nesta camada \u00e9 de aproximadamente 5 MPa, dando origem a uma produ\u00e7\u00e3o de 1085 rrt3/d. Esta cai para 65 m3/d ap\u00f3s 12 dias, como mostrado na figura (6.8), A simula\u00e7\u00e3o n\u00e3o continuou ap\u00f3s 12 dias, uma vez que o cone de g\u00e1s estabilizou e as mudan\u00e7as de satura\u00e7\u00e3o n\u00e3o foram t\u00e3o severas. Os dados adicionais para o problema s\u00e3o dados na tabela (6.7).\nEspessura das camadas, m\t5,4,3,2,2,2,4,5,6,7\nProfundidade da primeira camada, m\t5040\nProfundidade do contato g\u00e1s/\u00f3leo, m\t5052\nPress\u00e3o no contato g\u00e1s/\u00f3leo, MPa\t27,68\nRaio do po\u00e7o, m\t0,1\nRaio do externo, m\t500\nPermeabilidade absoluta na dire\u00e7\u00e3o x, m2\t9,86923x10\u201914\nPermeabilidade absoluta na dire\u00e7\u00e3o z, m2\t9,86923x10\u201914\nPorosidade, fra\u00e7\u00e3o\t0,30\nCompressibilidade da rocha, mPa~l\t4,4xl0\u201d4\nSatura\u00e7\u00e3o de \u00e1gua irredut\u00edvel , fra\u00e7\u00e3o\t0,12\nMassa espec\u00edfica do \u00f3leo em condi\u00e7\u00f5es padr\u00e3o, kg/rrp\t49,2\nDensidade do g\u00e1s em condi\u00e7\u00f5es padr\u00e3o, adimensioanal\t0,8\nTabela 6.7: Descri\u00e7\u00e3o do Reservat\u00f3rio e Dados B\u00e1sicos (Caso 2)\nFigura 6.8: Vaz\u00e3o de \u00d3leo versus Tempo (Caso 2)\nA tabela. (6.8) mostra a compara\u00e7\u00e3o de desempenho dos m\u00e9todos de implicitude auto-adapt\u00e1vel e totalmente impl\u00edcito na solu\u00e7\u00e3o do problema. Para a rodada de implicitude auto-adapt\u00e1vel, o bloco do po\u00e7o e seus vizinhos mais pr\u00f3ximos foram considerados totalmente impl\u00edcitos inicialmente, enquanto que, no resto do reservat\u00f3rio, adotou-se blocos IMPES. Note que h\u00e1 proximidade dos resultados obtidos, \u00e0 exce\u00e7\u00e3o daqueles que envolvem o tempo gasto no processamento. Uma economia de tempo de 49% foi alcan\u00e7ada.\nNa figura (6.9) ilustra-se os graus de implicitude correspondente a tr\u00eas pontos de tempo ao longo da simula\u00e7\u00e3o. Os n\u00fameros de 1 at\u00e9 10 no topo de cada mapa s\u00e3o os \u00edndices dos blocos da malha radial, enquanto os verticais s\u00e3o os n\u00fameros das camadas. Este indica quais blocos est\u00e3o sendo computados implicitamente, onde I indica bloco totalmente impl\u00edcito e E indica bloco IMPES. Notar que a 6 e 12 d\u00edas somente uma parcela dos blocos da malha est\u00e1 sofrendo c\u00e1lculos impl\u00edcitos. Obviamente, um modelo totalmente impl\u00edcito n\u00e3o \u00e9 necess\u00e1rio para este problema.\n\tAuto-adapt\u00e1vel\tTotalmente Impl\u00edcito\nN\u00famero total de passos de tempo\t'340\t342\nN\u00famero total de itera\u00e7\u00f5es\t566\t574\nItera\u00e7\u00f5es /Passo de tempo\t1,66\t1,68\nTempo total (seg)\t908\t1764\nTempo/Itera\u00e7\u00e3o (seg)\t1,6\t34\nC\u00e9lulas IMPES (%)\t49\t0\nTabela 6.8: Resultados do Caso 2\nEste caso foi tamb\u00e9m estudado, em uma segunda etapa, por interm\u00e9dio da abordagem de implicitude vari\u00e1vel aqui apresentada. Para tanto, definiu-se o mapa de configura\u00e7\u00e3o dos graus de implicitude mostrado na figura (6.10). Este permaneceu constante at\u00e9 o final da simula\u00e7\u00e3o. Os n\u00fameros de 1 a 10 no topo deste mapa sao os \u00edndices dos blocos da malha radial, enquanto os verticais s\u00e3o os n\u00fameros das camadas. Os diversos graus de implicitude s\u00e3o expressos da seguinte maneira: os valores 1 e 5 correspondem aos n\u00edveis b\u00e1sico (m\u00e9todo IMPES) e m\u00e1ximo (Totalmente Impl\u00edcito), respectivamente. Valores intermedi\u00e1rios significam n\u00edveis de implicitude entre os limites extremos que s\u00e3o, em ordem crescente, relacionados aos m\u00e9todos conhecidos por Solu\u00e7\u00e3o Simult\u00e2nea (grau\n2), Semi-impl\u00edcito Linearizado 1 (grau 3) e Semi-impl\u00edcito Linearizado 2 (grau 4).\nO gr\u00e1fico de vaz\u00e3o de \u00f3leo versus tempo apresentado na figura (6.11) mostra que as diferen\u00e7as entre os resultados obtidos, considerando-se as formula\u00e7\u00f5es totalmente impl\u00edcita, de implicitude vari\u00e1vel e auto-adapt\u00e1vel s\u00e3o, no que diz respeito \u00e0 estabilidade da solu\u00e7\u00e3o desprez\u00edveis.\ncamada\tlite-res,\t\t\t\t\t\t\t\t\t\ttempo \u00abcumulado (d\u00edas)\n\t1\t2\t3\t4\t&amp;\t6\t7\t8\t9\t10\t\n1\tE\tE\tE\tE\tE\tE\tE\tE\tE\tE\t\n2\tE\tE\tE\tE\tE\tE\tE\tE\tE\tE\t\n3\tE\tE\tE\tE\tE\tE\tE\tE\tE\tE\t\n4\tJ\tE\tE\tE\tE\tE\tE\tE\tE\tE\t\n5\t1\t1\tE\tE\tE\tE\tE\tE\tE\tE\t0,0\n6\t1\tE\tE\tE\tE\tE\tE\tE\tE\tE\t\n7\tE\tE\tE\tE\tE\tE\tE\tE\tE\tE\t\n8\tE\tE\tE\tE\tE\tE\tE\tE\tE\tE\t\n9\tE\tE\tE\tE\tE\tE\tE\tE\tE\tE\t\n10\tE\tE\tE\tE\tE\tE\tE\tE\tE\tE\t\n\t1\t2\t3\ti\t5\t0\t7\t8\t9\t10\t\nI\tE\tE\tE\tE\tE\tE\tE\tE\tE\tE\t\n2\tE\tE\tE\tE\tE\tE\tE\tE\tE\tE\t\n3\tI\tI\tI\t1\tE\tE\tE\tE\tE\tE\t\n4\tI\tI\tI\tI\tE\tE\tE\tE\tE\tE\t\n5\tI\ti\t\u00ed\t1\tE\tE\tE\tE\tE\tE\t0,5\n6\tI\t1\t1\tI\t1\tE\tE\tE\tE\tE\t\n7\tI\t1\t1\tI\tE\tE\tE\tE\tE\tE\t\n8\tJ\t1\tI\tI\tE\tE\tE\tE\tE\tE\t\n9\tE\tE\tE\tE\tE\tE\tE\tE\tE\tE\t\n10\tE\tE\tE\tE\tE\tE\tE\tE\tE\tE\t\n\t1\t2\t3\t4\t5\t6\t7\t8\t9\t10\t\n1\tI\t1\t1\tI\tI\tI\tE\tE\tE\tE\t\n2\tJ\tI\t1\tI\t1\tI\tE\tE\tE\tE\t\n3\ti\t1\tI\tI\tI\tI\tE\tE\tE\tE\t\n4\t1\tI\tI\t1\tI\tI\t1\tE\tE\tE\t\n&amp;\t1\tI\tI\t1\tI\tI\t1\tE\tE\tE\t6,0\n6\tI\tI\t1\t)\tI\tI\tI\tE\tE\tE\t\n7\tI\tJ\tI\t1\tI\tI\tE\tE\tE\tE\t\n8\tI\t1\tI\tI\tI\tI\tI\tE\tE\tE\t\n9\tI\tI\t1\tI\t1\t1\tI\tE\tE\tE\t\n10\tJ\tI\tI\t1\t1\t1\tI\tE\tE\tE\t\n\t1\t2\t3\t4\t5\t6\t7\t8\t9\t10\t\n1\t1\tI\tI\tI\t1\t1\tE\tE\tE\tE\t\n2\tI\t1\tI\tI\tI\tI\tE\tE\tE\tE\t\n3\tI\tI\tI\tI\tI\tI\tE\tE\tE\tE\t\n4\tI\tI\tI\tI\tI\tI\tI\tE\tE\tE\t\n5\tI\tI\tI\tI\t1\t1\tI\tE\tE\tE\t12,0\n6\tI\tI\tI\tI\tI\tI\t1\tE\tE\tE\t\n7\tI\tI\tI\tI\tI\tI\tE\tE\tE\tE\t\n8\tI\tI\tI\tI\tI\tI\t1\tE\tE\tE\t\n9\tI\tI\tI\tI\tI\t1\tI\tE\tE\tE\t\n10\tI\tI\t1\tI\t1\tI\tI\tE\tE\tE\t\nFigura 6.9: Graus de Implic\u00edtude versus Tempo (Caso 2 - M\u00e9todo de Implic\u00edtude Auto-adapt\u00e1vel)\ncamada\nblocos\n\t1\t2\t3\n1\t5\t5\t5\n2\t5\t5\t5\n3\t5\t5\t5\n4\t5\t5\t5\n5\t5\t5\t5\n6\t5\t5\t5\n7\t5\t5\t5\n8\t5\t5\t5\n9\t5\t5\t5\n10\t5\t5\t5\n4\t5\t6\t7\t8\t9\t10\n5\t5\t5\t4\t3\t2\t1\n5\t5\t5\t4\t3\t2\t1\n5\t5\t5\t4\t3\t2\t1\n5\t5\t5\t4\t3\t2\t1\n5\t5\t5\t4\t3\t2\t1\n5\t5\t5\t4\t3\t2\t1\n5\t5\t5\t4\t3\t2\t1\n5\t5\t5\t4\t3\t2\t1\n5\t5\t5\t4\t3\t2\t1\n5\t5\t5\t4\t3\t2\t1\nFigura 6.10; Configura\u00e7\u00e3o de Graus de Implicitude para a Abordagem de Implicitude Vari\u00e1vel\nFigura 6.11: Vaz\u00e3o de \u00d3leo versus Tempo (Compara\u00e7\u00e3o entre Formula\u00e7\u00f5es)\n\tImplicitude Vari\u00e1vel\tTotalmente Impl\u00edcito\nN\u00famero total de passos de tempo\t342\t342\nN\u00famero total de itera\u00e7\u00f5es\t561\t574\nItera\u00e7\u00f5es /Passo de tempo\t1,64\t1,68\nTempo total (seg)\t1206\t1764\nTempo/Itera\u00e7\u00e3o (seg)\t2,1\t3,1\nC\u00e9lulas IMPES (%)\t10\t0\nTabela 6,9: Par\u00e2metros para a An\u00e1lise de Desempenho da Formula\u00e7\u00e3o de Implidtude Vari\u00e1vel\nA compara\u00e7\u00e3o dos valores de tempo encontrados nas tabelas (6.8) e (6.9) mostra que a formula\u00e7\u00e3o de implicitude vari\u00e1vel forneceu uma economia de 32% no tempo de processamento quando comparada a uma formula\u00e7\u00e3o totalmente impl\u00edcita. Quando confrontada com o m\u00e9todo auto-adapt\u00e1vel, apresentou-se mais lenta. Isto deve-se ao fato que se manteve, ao longo de toda a rodada, n\u00edveis de implicitude fixos nas c\u00e9lulas da malha de c\u00e1lculo. Conclui-se ent\u00e3o a import\u00e2ncia do desenvolvimento de um crit\u00e9rio de troca de implicitude adequado. Ou seja, que objetive a minimiza\u00e7\u00e3o do tempo de processamento sem perda de estabilidade na solu\u00e7\u00e3o, levando-se em conta os n\u00edveis de implicitude intermedi\u00e1rios que podem ser invocados pela formula\u00e7\u00e3o de implicitude vari\u00e1vel apresentada neste estudo.\n7 Conclus\u00f5es\nUma formula\u00e7\u00e3o de implicitude vari\u00e1vel para a simula\u00e7\u00e3o do fluxo mul-tif\u00e1sico em reservat\u00f3rios, que permite a atribui\u00e7\u00e3o de graus de implicitude que variam de um valor m\u00ednimo (IMPES) at\u00e9 um valor m\u00e1ximo (Totalmente Impl\u00edcito), em cada c\u00e9lula da malha de c\u00e1lculo, foi apresentada.\nAdaptou-se um algoritmo para troca autom\u00e1tica do n\u00edvel de implicitude no espa\u00e7o e no tempo. Contemplou-se apenas dois n\u00edveis extremos de implicitude (IMPES - Totalmente Impl\u00edcito).\nO m\u00e9todo de implicitude auto-adapt\u00e1vel resultante do acoplamento do algoritmo de controle autom\u00e1tico de implicitude \u00e0 formula\u00e7\u00e3o de implicitude vari\u00e1vel foi implementado em um simulador num\u00e9rico.\nAdaptou-se um m\u00e9todo de solu\u00e7\u00e3o de sistemas com matrizes esparsas com capacidade para o ordenamento arbitr\u00e1rio das equa\u00e7\u00f5es e das inc\u00f3gnitas para a solu\u00e7\u00e3o do problema matricial obtido. Assim, foi poss\u00edvel tirar vantagem da estrutura particular dos sistemas gerados pelo m\u00e9todo de implicitude auto-adapt\u00e1vel desenvolvido.\nOs resultados, para um problema de simula\u00e7\u00e3o de reservat\u00f3rios \u201cblack-oil\u201d, obtidos atrav\u00e9s do m\u00e9todo proposto foram comparados a resultados provenientes de um simulador comercial, dotado tamb\u00e9m da facilidade de troca de implicitude. Essa compara\u00e7\u00e3o apresentou elevado grau de concord\u00e2ncia.\nEm problemas de simula\u00e7\u00e3o de reservat\u00f3rios \u201cblack-oil*1, o m\u00e9todo de implicitude auto-adapt\u00e1vel apresentou significativa redu\u00e7\u00e3o no tempo de processamento se comparado com o m\u00e9todo totalmente impl\u00edcito, mantendo, tal como este, a estabilidade da solu\u00e7\u00e3o.\n0 m\u00e9todo de implicitude auto-adapt\u00e1vel ainda n\u00e3o tira proveito de todos os n\u00edveis de implicitude que a formula\u00e7\u00e3o de implicitude vari\u00e1vel apresentada pode\nfornecer. Corno sugest\u00e3o, seria interessante o desenvolvimento de um crit\u00e9rio de escolha de irnplicitude robusto, que contemple uma gama maior de n\u00edveis de \u00edmplicitude.\nA an\u00e1lise aqui apresentada foi desenvolvida para um modelo \u201cblack-oil\u201d. Futuramente, uma investiga\u00e7\u00e3o de grande interesse seria a extens\u00e3o desta para modelos com posici\u00f3n ais, que pelo fato de exigirem a solu\u00e7\u00e3o simult\u00e2nea de um n\u00famero muito grande de equa\u00e7\u00f5es, os ganhos em termos de esfor\u00e7o computacional seriam ainda mais significativos.\nN omencla t ura\nS\u00edmbolos\nAIM - \u201cAdaptive Implicit Method\u201d\nBp - fator volume forma\u00e7\u00e3o da fase p, Jm3C'R/m3CF]\nb - fator de encolhimento\nbp - 1/BP fator de encolhimento da fase p, [m3CP/m3CR\\\nCP - condi\u00e7\u00f5es padr\u00e3o\nCR - condi\u00e7\u00f5es de reservat\u00f3rio\nCr - compressibilidade da rocha, [MFcT1]\n-\tcompressibilidade da \u00e1gua, [AfRa\"\"1]\nD - profundidade, [m]\nF - fun\u00e7\u00e3o de res\u00edduos\nFo - fun\u00e7\u00e3o de res\u00edduos do \u00f3leo\n-\tfun\u00e7\u00e3o de res\u00edduos do g\u00e1s\nFCM.te * crit\u00e9rio da vaz\u00e3o para escolha de implicitude\nIAN - \u201cInexact Adaptive Newton Method\u201d\nJ - matriz de coeficientes\nk - permeabilidade absoluta, [m2]\nkrg \u2022 permeabilidade relativa ao g\u00e1s, adimensional\n47\nkrt> - permeabilidade relativa ao \u00f3leo, adimensional\nP - matriz de permuta\u00e7\u00e3o\nps - press\u00e3o da fase g\u00e1s, [A\u00edPa]\npa - press\u00e3o da fase \u00f3leo, [MPa]\nP6 - press\u00e3o capilar\nPe?o - press\u00e3o capilar g\u00e1s-\u00f3leo, [Pa]\nq3 - termo fonte/sumidouro para o g\u00e1s, [m3/dza]\nqQ - termo fonte/sumidouro para o \u00f3leo, [rrP/dia]\nq^ - vaz\u00e3o total na dire\u00e7\u00e3o x, [m3/d\u00eda]\nRt - raz\u00e3o de solubilidade g\u00e1s-\u00f3leo, [m3CP/m3CP]\nre - raio externo do reservat\u00f3rio, [m]\nrw - raio do po\u00e7o, [m]\nSp - satura\u00e7\u00e3o da fase p, fra\u00e7\u00e3o\nT - transmissibilidade\nTs - transmissibilidade do g\u00e1s\nTo - transmissibilidade do \u00f3leo\nt - tempo, [dia]\nV - volume de uma c\u00e9lula, [m3]\nVp - volume poroso de uma c\u00e9lula, [m3]\n- componente x da velocidade de Darcy\nX - vetor solu\u00e7\u00e3o\nx - inc\u00f3gnita x\nx ~ coordenada espacial dire\u00e7\u00e3o x\n\u00e9 - mudan\u00e7a ao longo de uma itera\u00e7\u00e3o\nSx - mudan\u00e7a da inc\u00f3gnita x\nA - operador de diferen\u00e7a espacial\nA\u00ed - intervalo de tempo\nA\u00edt - dimens\u00e3o x de uma c\u00e9lula da malha de c\u00e1lculo e - toler\u00e2ncia, na converg\u00eancia do m\u00e9todo de Newton 7 - peso espec\u00edfico\n-\tpeso espec\u00edfico da fase \u00f3leo, [N/ m3]\n75 - peso espec\u00edfico da fase g\u00e1s, [\u00cdV/m3]\n-\tmobilidade da fase g\u00e1s =I~ro/pfl, [(Pa.s)-1]\n-\tmobilidade da fase \u00f3leo =kT<>/pu, [(Pn-.s)\"1]\npp - viscosidade da fase p, [Pu.s]\npP - massa espec\u00edfica da fase p, [\u00e8^/cm3]\n$ - porosidade, fra\u00e7\u00e3o\nSubescritos\nf - fase \u00f3leo ou g\u00e1s\ng - fase g\u00e1s\ni - \u00edndice na dire\u00e7\u00e3o x\no - fase \u00f3leo\np - qualquer fase\nx - \u00edndice na dire\u00e7\u00e3o x\nx - inc\u00f3gnita a:\nw - fase \u00e1gua\n\u2014 face na dire\u00e7\u00e3o do \u00edndice decrescente\n4- - face na dire\u00e7\u00e3o do \u00edndice crescente\nSobrescritos\nn - n\u00famero do intervalo de tempo\nT - transposta de um vetor\nv - n\u00famero da itera\u00e7\u00e3o Newtoniana\nRefer\u00eancias\n[1]\tAziz, K. &amp; Settari, A., Petroleum Reservoir Simulation, London, Applied Science Pub., 1979.\n[2]\tBertiger, W.L &amp; Kelsey, F..L, \u201cInexact Adaptive Newton Methods\u201d, Society of Petroleum Engineers, SPE 13501, 1985.\n[3]\tCoats, K.H., Nielsen, R.L., Terhune, MAI. &amp; Weber, A.G., \u201cSimulation of three-dimensional, two-phase flow in oil and gas reservoirs\u201d, Trans. SPE of AIMS, Vol. 240, pp. 377-388, 1967.\n[4]\tCollins, D.A., Nghiem C.X. &amp; Li Y-K, \u201cAn Efficient Approach to Adaptive-Implicit Compositional Simulation with an Equation of State\u201d , Society of Petroleum Engineers, SPE 15133, 1986.\n[5]\tDouglas, J.,Jr., Peaceman, D.W. &amp; Rachford, H.H.,Jr., \u201cA method for calculating multi-dimensional immiscible displacement\u201d, Trans. SPE of AIME, Vol. 216, pp. 297-306, 1959.\n[6]\tForsyth, P.A., Jr. &amp; Sammon, P.H., \u201cPractical Considerations for Adaptive Implicit Methods in Reservoir Simulation\u201d, Journal of Computational Physics, Vol. 62, pp. 265-281, 1986.\n[7]\tFung, L. S-K, Collins, D.A. &amp; Nghiem, L.X., \u201cAn Adaptive-Implicit Switching Criterion Based on Numerical Stability Analysis\u201d, SPE Reservoir Engineering, Vol. 4, No. 1, pp. 45-51, 1989.\n[8]\tLetkeman, J.P. &amp;: Ridings, R.L., \u201cA numerical coning model\u201d, SPE Journal, Vol. 19, No. 4, pp. 418-424, 1970.\n51\n[9]\tMacDonald, R.C. &amp; Coats, K.H., \u201cMethods for numerical reservoir simulation of water and gas coning\u201d, Trans. SPE of AIME, Vol. 249, pp. 425-436, 1970.\n[10]\tNolen, J.S. &amp; Berry, D.W., \u201cTests of the stability and time-step sensitivity of semi-implicit reservoir simulation techniques\u201d, Trans. SPE of AIME, Vol. 253, pp. 253-266, 1972.\n[11]\tPeaceman, D.W., \u201cDiscussion of An Adaptive-Implicit Switching Criterion based on Numerical Stability Analysis\u201d, SPE Reservoir Engineering, Vol. 4, No. 2, pp. 255-256, 1989.\n[12]\tPeaceman, D.W., Fundamentals of Numerical Reservoir Simulation, Amsterdam, Elsevier, 1977.\n[13]\tRodr\u00edguez, F., \u201cUn Enfoque Unificado de M\u00e9todos de Simulaci\u00f3n Num\u00e9rica de Yacimientos\u201d, Wokshop das Aplica\u00e7\u00f5es da Ci\u00eancia na Engenharia de Reservat\u00f3rios de Petr\u00f3leo, organizado pela CLAF, PUC/RJ e PETROBR\u00c1S, Rio de Janeiro, 15-19 de Agosto, 1988.\n[14]\tRussell, T.F., \u201cStability Analysis and Switching Criteria for Adaptive Implicit Methods Based on CFL Condition\u201d, Society of Petroleum Engineers, SPE 18416, 1989.\n[15]\tSheffield, M., \u201cThree phase flow including gravitational, viscous, and capillary forces\u201d, Trans. SPE of AIME, Vol. 246, pp. 255-269, 1969.\n[16]\tSheldon, J.W., Zondek, B. &amp;; Cardwell, W.T., \u201cOne-dimensional, incompressible, non-capillary, two-phase fluid flow in a porous medium\u201d, Trans. SPE of AIME, Vol. 216, pp. 290-296, 1959.\n[17]\tSherman, A.H., \u201cNSPIV, A Fortran Subroutine for Sparse Gaussian Elimination With Partial Pivoting\u201d, ACM Trans, Math. Software.\n[18]\tStone, H.L. &amp; Gander, A.O.,Jr., \u201cAnalysis of gas*cap or dissolved-gas reservoirs\u201d, Trans. SPE of AIME, Vol. 222, pp. 92-104, 1961.\n[19]\tTan, T.B., \u201cImplementation of an Improved Adaptive-Implicit Method in a Thermal Compositional Simulator\u201d, SPE Reservoir Engineering, Vol. 3, No. 4, pp. 1123-1128, 1988.\n[20]\tThomas, G.W. &amp; Thurnau, D.H., \u201cReservoir Simulation Using an Adaptive Implicit Method\u201d, Society of Petroleum Engineers, SPE 10120, 1983,\n[21]\tThomas, G.W. &amp; Thurnau, D.H., \u201cThe Mathematical Basis of the Adaptive Implicit Method\u201d, Society of Petroleum. Engineers, SPE 10495, 1982.\n[22]\tVinsome, P.K.W., \u201cFully Implicit versus Dynamic Implicit Reservoir Simulation\u201d, The Journal of Canadian Petroleum, No. 2, pp. 49-53, 1985.\nAp\u00eandice A - Forma Expandida das Fun\u00e7\u00f5es de Res\u00edduos\nNeste ap\u00eandice; a forma expandida das fun\u00e7\u00f5es de res\u00edduos \u00e9 apresentada. Estas s\u00e3o\nnecess\u00e1rias para se encontrar os elementos da matriz Jacobiana.\nOleo\n. 1 [Poi-f-\u00ed Po\u00ed (7oA2?),+1] lo i\u00cdPo\u00ed Poi-i *+2 2 \u2019\u201c2\n^{[i + Mp. - p^l\u00edW.' ~ (t\u00f3)?} = o\n(A,l)\nGas\n\u2014 Ts.+{pOi+1 Poj + Pc3oi+1 -Pcso. (7gAZ))\u00ed+i]\n\u201c\t\u00cdP\u00b0> ~ Poi-l + ^Sl\u00b0i ~~\t~ (Tj^^)\u00ed-|]\n+\tP<, \u201c \u00cd^AD),^]\n-\t(^Rs\u00edi-i\u00fc7^ \u201cP^i \u201d (7oAD)i_i] + qoiltTg/T^ d- Rai]\n-\tK{[1 + Cr(p0 _ pjjjiyi + S\" (Cw, + e,)(p0 - rt),. - S\u201d. - Sn)\n+ (\u00cd^AM - (6A + \u00a1>.B,S\u201e)\"} = O\t(A.2)\nonde\n~ D\u00ed\n2\nAjD^i \u2014 Di \u2014 -\u00cdZi-f-i\nAp\u00eandice B - Elementos da Matriz Jacobiana : M\u00e9todo Impl\u00edcito\ndFOi\n^7\tdT\nW> + a\u00ed?H^) -~\n(Bd)\n\ndpOi\ndT\u00b0i+l\n= -7k^(l +\t+ [po;+1 - pOi ~ (7oAZ))1+i]^-^-\n\u00bf7o i\t1\n- M1 \u201cax>h-^)-1*.\no;\n\u2019O\u00ed\n(B.2)\nM, dpOi+1\no.\n\u00bf7\n= To (1-AP\n\u2022+r\t2 \u00e0p,\n-^) + ki+J - Po, ~ (7oAP)\u00ed+i]\n7+1\ndT^\n(B.3)\n\nO(\ndSOi\n8F \u25a0\t^\u00b0i-\u00ed\n= \u201dho(\n- O<\n7\u20141\nO\u00ed-3\ndTa^\tdT\u00b0^\n[Poi-f-l P\u00aei ~~ \u00cd7o^-^)t+^] Qg\t[P\u00b0J Poj_l (7oA2?)1_1] q\u00e7,\n^{[l + ^(?o\u201cP\u201d)\u00ed]M\nOi\n0,\ndFOl\nQTO\n\u00cd\u00edWh - Po, ~\n(B.4)\n(B.5)\n(B.6)\n\n^7S. I\n5 dpoi-1\ndT i-i + Pcgo. ~ Pcs^ ~ (7sAZ))t\u201el]\n4- (OX41 +\n2\t2 \u00e1p^-y\nk,- - Po^ + O - K\n- ho.- \u201c Po^ ~\t\u00b1 \u2014\n2\t'\u201c2 (Jp(\n9T0 x\tdRs .\nA\u00b1+T ____\n+ M dp^ )\n(B.7)\nwSl\n&amp;Po\u00ed\n-r9M\u00edi + AP,.+j^\u00fc]\nO,\n+\ndT\n[Po\u00bf+1 ~ Poi + \u00cdc9o\u00ed+1 ~ -fcSOi ~~ ( 7? A Z))\u00ed+1 ] ~0p O i\nTs\u00a1 (1 \u2122 AP^i-\u2014l~i)\n-2\t2 dpOi\nar5. 1 [pO\u00ed + O. - pc^ - (isAX-lJxX (Wi+i(l + \u00e1Di+i-^\u00ed)\nOf\n+\ndT^\n'o.\n[Po.-n -p^ ~ (70AP)\u00ed+i](/?5i+,-\u2014\n(0X1(1 -ADM-\u00a1^)\n2\t2 dpO\u00ed\ndR\u00e1,\n+W>\ndTo ,\n\u2014i\n+\n\ndRs ,\ni&lt;t _______\u2018r.s. \\\n-i X M dpQi\n9p^\u00a1\t\u2019 dpOi }\n- P\u00ab) - s*' - sOt) + (Rssabo)t]\n9b.\n\n\u00cdP\u00b0t Poi-y\t(7o AD),_i](\u00f1Si\n(d(T3/To){ t dR.\n?o\u00edt--\u00e3------r\ndpoi\nKn - _\nAi\n[1 + cX ~Po\u00ed)]1^(1 +5\" (c^, +Cr)X -PoJ - -SJ t,.s^ + *) + s\u00b0h^f\u2018\n\u2022S\u00ed\nOi\nO\u00ed\nJ\u00ed\n>0\u00cd\n(B.8)\ndP^l\n+\n+\ndT bo\u00ed+l ~Poi + -^90,+ 1 \u201c\t\u201c \u00cd7s^^)\u00bf+i]'^\t~\n(Wi+\u00cd(l ~ ADM\u00cd^\u00dc.)\n2\t\u00abPo,+1\ndT\tdR\n+\n)\n(B.9)\ndF\n9i dSt\n0^1\n+\ndT -boi -Poi-x - (7sAPti + pCaOt -\ndP.\nT\t(\u2014-\u00a5\u00ed=\u00b1 4. AD, j \n\u00e3s^ +\t,-^(sOt_\u00ed\nti,\ndT0\n\\poi~Poi_! -\n(B.10)\nds.\nOi\n^\u00ed+i [po\u00bf+l \u2014 Po, (T^AD)^! + ^cS\u00b0t+i \u201d -^CgoJ Qg\ndPc .\td^i+L\nTs<+ i ( \u00e3So- + A\u00a3>\u00ed'-H ~dS^\nOi\ndSa\u00ed\n0,\n+\n\ndT\nboi P\u00b0i-1\t(7tfAZ))}\u2018_l \u201dt\u201d P^t/o, PcgUi-j ] Qg\ndP\t<?7g i\n\u00e0To\nboi+1 ~ Po, - (7oAP)i+i]Ki+i-J~-\ndTo\nbo. -Poi-\u00ed ~ (7oAD),_i]/?s^|-\u2122~i _\tK\u201dfH . .. z..\t,.Ju\u00edn\t,\n&amp;>* dS\t\u00e2i\t^\"Cr^ Ps\u00edd\u00ed^o^s ^)i}\n(B.ll)\ndl^\ng-i- U \u00ed) O\t\\P\u2019>i+\u00ed\n^O\u00ed+l\ndT\n_P\nC9O, 7 C) c\nl^\u00ed\t^CgQi+1 J C9O, / CjC\ndPc\n+ T^-^ + ADM\u00e3^;)\n1+1 dTa\n[po,'+l ~ Poi ~~\n\n\nit\u00b1\n(B.12)\nAp\u00eandice C - \u201cMatrixes Corretivas11\nComo visto anteriormente, para o n\u00f3 as equa\u00e7\u00f5es podem ser escritas como\n\t\t\t\t\t\t\t\t\t\u00bfPo\tOH-l)\nr &amp;FOi\t2\u00edhu 1\t(ri\tr 9F*.:\t1\t(ri\tr\t&amp;fQ\u00ed n\t(ri\t.\tj\t\u00ed-l Oh-1)\n^\u00ed-i\t\t\t9po\u00a1\t\t\t^\u00ed+i 8FSi\t9FS,\t\t6p0 . . 8p0\t\nL 3po\u00bf\u201ei\tJ\t\tL.\td$ot J\t\tL fyoi+i\t9-%,+1 J\t\t\t^+3)\n\t\t\t\t\t\t\t\t\t&amp;so\t\u00bf4-1\n\t\t\t\t\t\t\t\t\t\t\n\nou ainda,\nCi C2\nC3 C4\nAi A2\nA3 A4\n\tfyo\t(1'4-1)\t\n\t. \u00eaS\u00b0 .\t1\u20141 (p+1)\t\n\t\u00bfPo\t\tr F \u25a0* 0\n\t\u00f2S0\t\tF L 19 J\n\t\u00bfpo\ttw-i)\t\n\tJSO\t\u00bf4-1\t\nonde,\nBi\n\nA2\n&amp;fo\u00ed\n&amp;sOi\nB2~\n&amp;FOt\nBpOi+i\nA3 =\nB3 \u2014\nA4 ~\nB&lt;=\n55O,+ J\nCj c2\t\tAi A?\tB4 B2\nc3 c4\t\tA A4\tB$ B4\nC2 - 0\nC3 = (Ts + TaRs)^i\nc4 = 0\nAi == ~crM+rM)\nA2 \u2014 0\nA3 = -~(Tg + ToR\u00bf)i_i - (Tg +\nA = 0\nB2 = O\nB3 ~ (Ts + ToRs)\u00ed+l\nB4 = 0\nCj\nc3\nC2\nc4\nAl\nA3\nB, \u25a0\nb4\ndT\nCi = 4aPo~7oad]h^\u00b1\nc2 = o\nC3 = -[Ap5-7?AD]i_x^~Al\u201e[Ap\u00a3)\u21227DAD];\u201ex-^-^A\nC4 - 0\nA,\nA2\n^3\na4\ndTo\tQT\n-[APo - %AP]i+|-^l - [Ap\u201e - 7.AP],_{\n0\ndT\tdT\n[Ap, -\t[Aft ~ ^AP],.^-^\n[Ap\u201e - 7\u201eAO]j+i-\u00ed-\u20142i\u00b1i _ [APo _ 7oAB]j+i-^-Aj.\n0\n5T0\nB. = -[Ap. - 7t,A\u00a3>],.+17--!i\u00cd\n2\t^Pol+J\nb2 ~ o\ndTs .\td(T0Ra)i+\u00ed\nB3 = -[Ap^7jAD],+\u00ed\u2014 -[Aft-%AB],.+j^\u20141\nB4 ~ Q\nC.\nC3\nC4\nAj A2\nB1\nB2\nA3 A4\nr\nb3\nb4\nG\nC2\nC4\n0\n= 0\n= -~[Aps - 7gAD].\n- [Ap0 -\n99o\u00ed-i\n\u00c21 = 0\n9TO\tdT0\nA2 = -[Ap0~70A\u00a3].+i-^y^-[Ap0~70AD]\u00bf_i-\u2122\nA3 \u2014 0 &amp;Ta. x\td(Ts. .\nA4 ----- [Apa -7\u00e7A%i^ -[Aps~75AD].\u201el~\u00f5$ t\td(ToRa}i+\u00b1\tW).,\n[\u00e3Po - lo\u00e0D]ii\u00ed}.+ - [Ap0 - 70AP];+i\u2014^-*-\nBr = 0\n9T\nB2 ~ -[Ap0 -70AP]\u00bf+\u00ed -\n2\ta\u00fcOi+l\nB3 - 0\n9Tg\td(T0RX+L\nB4 = -[Ap^ -7sAP]!+i^y^- - [Apo ~7<M+i\u201d-----------*\u2022\nto\tto\tto\tte\nA-\tCC\t\u00abO\n\u00a1Jx\ni-L\n'afo\n\n\u00a1i ti\n\u00a1i \u00a1i\nK] o\nO O\nse H\nT\nI\tI\nn 03\th\u201c*\nO Q\n* w\nt----\t1\n! ....... i\n<c >-\n>U\n\u00ab--\u2022\t....i.iuJ\n.....\u00bb'i\n1\t1\no\nCi Ca\tAi A2\t\tBi B2\n. c3 c4\tA3 A4\t\tb3 b4\nC\\\nC,\nC3\nc4\n<fy0\n= (T0AC)(_iT^\u00cd\n= 0\n=\n'\u00b0\u00edxl\ta 7o. 1\nA = (T.AZ))i+1\u2014\u00cdL + (I;AZ>),._,-^i\n+ \u2019 dpn\t'' > dpOi\nA? ~ 0\nH\t$7\u00bb i\nA, = ^T^D)i+i-^\u00ed +\n2 dPoi\t*\t'* 2 dp&amp;t\nd/y^\t\u00bf7\n_(ToKsAP)\u00ed+i\u2014+ (UAP^x-^\n3\tapOi\t2 dp,\nB, =\t= -(T0AD)i+x~\u00dc 2 ^Oi+1\nB\u20192 -\t= 0\nB% -\t= ~(^),.+| ^U(TAA^,.+^ 07s !\nB4 =\t(r\u00b0AP)\u00bf+i\u00e1SOi\u201el\nf W/t.)\n] + [^\nC*i C2 c3 c4\nAi A2\nA3 A4\nB1 B2\nBs B4\nCl - 0\nc2 = 0\nc3 = 0\nc4 - 0\nAx = 0\n^2\nA3\nA4\n0\n. d[(T3/TG)i + RS\u00ed] q\u00b0\u2018 aPa\nd(T,/Ta\\\n\"\u00bb> ao\nBt = Q\nB2 = Q\nBs = 0\nB.\u00a1 = 0\nCi C2 c3 c4\nAi A%\nA3 A$\nBi B2\u2018\nB3 B<\nCl - 0\nc2 = 0\nc3 - 0\nc4 = 0\n= -^-{[l + CrtPo-P^MSo\u00ed^+Cr\u00edtAJi}\n712 = ^{[i+^(p.-p:).i^}\nA3 = ^Kfe,(i + 5;,(c\u00bb&lt;+ cr)(p..-p:,)-s\u201d - Sp.) + uw.).] + [1 + ^(P\u00ab, ~ of^\u00ed1 + s:,(e\u00bb, +&lt;v)(p., - tf,) - s\u201d - sj\n+ bgtSZt^i ++ s\u00b0\u2018b\u00b0<~r~ +\t\u00bfrH)\n\u2122Poi\tapQi\nA = ^\u00ed\u00ed + ^-^M-\u00f2^}\nBi =\t0\nB2 = 0\nBs - 0\nB4 = 0\nAp\u00eandice D - Rotinas de Montagem e Ordena\u00e7\u00e3o\nEste ap\u00eandice cont\u00e9m algumas das rotinas computacionais que fazem parte do simulador de fluxo bi-f\u00e1sico de implicitude auto-adapt\u00e1vel desenvolvido.\nAs rotinas listadas est\u00e3o agrupadas da seguinte forma:\nGrupo 1 - Rotinas para controle autom\u00e1tico do grau de implicitude ao longo do passo de tempo e ao longo da itera\u00e7\u00e3o (Rotinas CAIM1A e CAIM1B).\nGrupo 2 - Rotina para montagem das fun\u00e7\u00f5es de res\u00edduos e da matriz Jacobiana (Rotina FRGO).\nGrupo 3 - Rotinas para invers\u00e3o do bloco diagonal principal e montagem dos vetores de ordena\u00e7\u00e3o a serem fornecidos para a rotina de solu\u00e7\u00e3o NSPIV (Rotinas P0INT2, INVERT e SOLVE).\n67\nC SUBBOTINA PARA CONTROLS DA IMPLICITUDE AO LONGO DE UM PASSO DE TEMPO C\nC\nC VARIAVEIS PRINICIPAIS\nC --------------------------\nc\nc\nAIMO - MATRIZ DE IMPLICITUDE INICIAL\nC\nAIM1X - MATRIZ DE IMPLICITUDE ATUAL\nC\tQTX\nC\tQTZ\nC\tVP\n-\tVAZAO TOTAL NA DIRECAO X\n-\tVAZAO TOTAL NA DIRECAO Z\n-\tVOLUME POROSO\nC DELTAT - INTERVALO DE TEMPO\nC FIM - FATDR DE CORTE\nC\nC~-----------------------------------------------------------------------\nSUBROUTINE CAIM1A (NITS,FIM,QTX,QTZ)\nC\nPARAMETER (NTM=1O,NXM=15,NZM=15)\nIMPLICIT DOUBLE PRECISION (A~H,O-Z)\nREAL*8 XX,KZ,VP(NXM,NZM)\nREAL*8 TEPM(NTM),DTM(NTM),DX(NXM),Q0MAX(NTM)\nREAL*8 QTX(NXM,NZM),QTZ(NXM,NZM)\nINTEGER OPCAO,AIMO(NXM,NZM),AIM1X(NXM,NZM)\nC\nCOMMON /DADOS/PREF,QOMAX,QOMIN,PWFMIN,CTR,PHI(NZM) ,RW,RE,ESP,TEMP,\n#\tDG,SWI,ZMED,ZTW,ZTE,KX(NXM,NZM),KZ(NXM,NZM) ,DSAT,\n#\tTSAT,TPRES,DPRES,ITMAX,ITMIN,TMAX,DELTAT,DTMAX,\n#\tDTMIN,DTIMPR,DTIMPG,IXIMP,NX,NZ,DY,DTINI,AIMO,\n#\tAIM1X,OPCAO,DX,TEPM,DTM, JICAN, JFCAN,PWFL, JREF\nC\nCOMMON /DMALHA/RAIOI(NXM),RAIOE(NXM),FGX(NXM,NZM),FGZ(NXM,NZM),\n#\tZM(O:NXM+1,NZM),WX(NXM),WZ(NZM),VP,DZ(NZM)\nC\nIF(NITS.EQ.1) THEN\nDO 1 I \u00bb 1,NX\nDO 1 J = i,NZ\nAIM1X(I,J)\u00abAIMO(I,J)\n1\tCONTINUE\nELSE\nDO 2 J = 1,NZ~1\nAUXI\u00ab(QTX(2,J)+QTZ(1,J+1))*DELTAT/(VP(1,J)*86400.DO)\nIF(AUXI.GT.FIM) THEN\nAIM1X(1,J)*5\nELSE\nAIM1X(1,J)-1\nENDIF\n2\tCONTINUE\nDO 3 I \u00ae ltNX-l\nAUXI<QTX(l44,i)+QTZ(I,2))*DELTAT/(VP(I,l)*86400.D0) IF(AUXI.GT.FIM) THEN\nAIM1X(I,1)\u00ab5\nELSE\nAIM\u00cdX(I,1>1\nENDIF\n3\tCONTINUE\nDO 4 I = 2.NX-1\nDO 4 J = 2,NZ-1\nAUXI=(QTX(I+1,J)+QTZ(I,J+1))*DELTAT/(VP(I,J)*86400.DO) IF(AUXI.GT.FIM) THEN\nAIM1X(I, J)=5\nELSE\nAIM1X(I,J)-1\nENDIF\n4\tCONTINUE\nDO 5 I = 1,NX-1\nAUXI=(QTZ(I,NZ)+QTX(I+1,NZ))*DELTAT/(VP(I,NZ) *86400. DO) IF(AUXI.GT.FIM) THEN\nAIM1X(I,NZ)=5\nELSE\nAIM1X(I,NZ)=1\nENDIF\n5\tCONTINUE\nDD 6 J* 1,NZ~1\nAUXI=(QTZ(NX,J+l)+QTX(NX,J))*DELTAT/(VP(NX,J)*86400 . DO) IF(AUXI.GT.FIM) THEN\nAIMIX(NX,J)\u00abS\nELSE\nAIM1X(NX,J)\u00abl\nENDIF\n6\tCONTINUE\nAUXI=(qTZ(NX,NZ)+QTX(NX,NZ))*DELTAT/(VP(NX,NZ)*86400.D0)\nIF(AUXI.GT.FIM) THEN\nAIM1X(NX,N2)\u00bb5\nELSE\nAIM1X(NX,NZ)=1\nENDIF\nENDIF\nC\nRETURN\nEND\nC\nC------------------------:-----------------------------------------'-----\nC SUBBOTINA PARA CONTROLE DA IMPLICITUDE AO LONGO DE UMA ITERACAO\nC\nC VARIAVEIS PRINICIPAIS\nC ---------'---------------\nc\nc\tA IMO\t- MATRIZ DE IMPLICITUDE INICIAL\nc\tAIM1X\t- MATRIZ DE IMPLICITUDE ATUAL\nc\tQTX\t- VAZAO TOTAL NA DIRECAO X\nc\tQTZ\t- VAZAO TOTAL NA DIRECAO Z\nc\tVP\t- VOLUME POROSO\nc\tDELTAT\t- INTERVALO DE TEMPO\nc\tFIM\t- FATOR DE CORTE\nc\tSGCR\t- SATURACAO DE GAS CRITICA\nc\nc---------------.------------------------------\u25a0.----------------------\nSUBROUTINE CAIM1B (FIM^GCR^QTX^TZ)\nC\nPARAMETER (NTM=10,NXM=15,NZM=15)\nIMPLICIT DOUBLE PRECISION (A-H.O-Z)\nREAL*8 KX,KZ,VP(NXM,NZM),MIG1,MIG2\nREAL*8 TEPM(NTM),DTM(NTM) ,DX(NXM),QOMAX(NTM)\nREAL*8 QTX(NXM,NZM),QTZ(NXM,NZM)\nINTEGER OPCAO,AIMO(NXM,NZM),AIM1X(HXM,NZM)\nc\nCOMMON /DADOS/PREF^OMAX^OMIN.PWFMIN^TRjPHKNZM) ,RW,RE,ESP,TEMP,\n#\tDG, SWI, ZMED, ZTW, ZTE ,KX (NXM, NZM) ,KZ(NXM, NZM) , DSAT,\n#\tTSAT, TPRES, DPRES, ITMAX,ITMIN, TMAX, DELTAT , DTMAX,\n#\tDTMIN,DTIMPR,DTIMPG,IXIMP,NX,NZ,DY,DTINI ,AIMO,\n#\tAIM1X > OPCAO, DX ,TEPM,DTM, JICAN, JFCAN ,PWFL , JREF\nC\nCOMMON /DMALHA/RAIOKNXM) ,RAIOE(NXM) ,FGX(NXM,NZM) 5FGZ(NXM,NZM) ,\n#\tZM(O :NXM+1 ,NZM) ,WX(NXM) ,WZ(NZM) ,VP,DZ(NZM)\nCOMMON /Gi/BG1(NXM,NZM),SG1(NXM,\u00bbZM)\nC\nCOMMON /G2/BG2(NXM,NZM),MIG2(NXM,NZM),R0G2(NXM,NZM),SG2(NXM,NZM)\nC\nDO 1 J = 1,NZ-1\nAUXI\u00bb (QTX(2, J ) +QTZ (1, J+1) ) *DELTAT/ (VP(1, J ) *86400. DO) IF(AUXI.GT.FIM.OR.(SG2(1,J).GE.SGCR.AND.SGI(1,J).LE.SGCR))THEN AIM1X(1,J)\u00bb5\nENDIF\n1\tCONTINUE\nDO 2 I = 1,NX-1\nAUXI\u00bb(QTX(I+1,1)+QTZ(I,2))*DELTAT/(VP(IJl)*86400.D0)\nIF(AUXI.GT.FIM.OR.(SG2(I,1),GE.SGCR.AND.SG1(I,1),LE.SGCR))THEN\nAIM1X(I>1)=5\nENDIF\n2\tCONTINUE\nDO 3 I = 2,NX-1\nDO 3 J = 2.NZ-1\nAUXI=(QTX(I+1,J)+QTZ(I,J+l))*DELTAT/(VP(I,J)*86400.DO) IF (AUXI. GT. FIM, OR. (SG2(I, J) . GE. SGCR.AND,SGI(I,J).LE. SGCR) )THEN AIMlX(I,J)-5\nENDIF\n3\tCONTINUE\nDO 4 I = 1,NX-1\nAUXI=(QTZ(I,NZ)+QTX(I+1,NZ))*DELTAT/(VP(I,NZ)*86400.DO)\nIF(AUXI.GT.FIM.OR.(SG2(I,NZ).GE.SGCR.AND.SGI(I,NZ).LE.SGCR))THEN AIM1X(IfNZ)=5\nENDIF\n4\tCONTINUE\nDO 5 J - 1,NZ-1\nAUXI= (QTZ(NX, J+l)+QTX(NXJ) )+DELTAT/(VP(NX, J)*86400 . DO)\nIF(AUXI.GT.FIM.OR.(SG2(NX, J) . GE.SGCR.AND.SGI (NX,J).LE.SGCR))THEN AIM1X(NX,J)=5\nENDIF\n5\tCONTINUE\nAUX1'=(qTZ(NX,NZ)+QTX(NX,NZ))*DELTAT/(VP(NX,NZ)*86400.DO) IF(AUXI,GT.FIM.OR.(SG2(NX,NZ).GE.SGCR.AND.SG1(NX,NZ).LE.SGCR))THEN AIM1X(NX,NZ)=5\nENDIF\nRETURN\nEND\n\u00ab o\nC\tSUBROTINA PARA CALCULO DAS FUNCOES DE RES\u00cdDUO DO GAS E DO OLEO E\nC\tSUAS DERIVADAS (MONTAGEM DO JACOBIANO E TERMO INDEPENDENTE)\nC\nC VARIAVEIS PRINICIPAIS\nC\t---------------------\nc\nc\tAIM1X\t- MATRIZ DE IMPLICITUDE ATUAL\nc\tqTx\t- VAZAO TOTAL NA DIRECAO X\nc\tQTZ\t- VAZAO TOTAL NA DIRECAO Z\nc\tDELTAT\t- INTERVALO DE TEMPO\nc\tAl\t- MATRIZ JACOBIANA\nc\tFR\t- VETOR COM AS FUNCOES DE RES\u00cdDUOS\nC\nC----------------------------------------;-------------------------------\nSUBROUTINE FRGO (P01,PD2,QTX,QTZ)\nC\nPARAMETER (NPVT=20,NTM=10,NXM\u00ab15,NZM=15)\nIMPLICIT DOUBLE PRECISION (A-H.O-Z)\nREAL*8 P01(\u00bbXM,NZM),P02(0:\u00bbX\u00bbH,0:NZM+l),VP(NXM,NZM)\nREAL*8 MIG2,MID2,MIGFX,MI0FX,MIGFZ>MI0FZ,KX1KZ,KRG2,KR02\nREAL*8 TEPM(NTM),DTM(NTM),DX(NXM),QOMAX(NTM)\nREAL*8 QTX(NXM,NZM) ,QTZ(NXM,NZM)\nINTEGER OPCAO,AIMO(NXM,NZM),AIMtX(NXM,NZM)\nC\nCOMMON /DADOS/PREF,QOMAX.qOMINjPWFMIN.CTR,PHI(NZM),RW,RE,ESP,TEMP,\n#\tDG,SHI,ZMED,ZTW,ZTE,KX(NXM.NZM),KZ(NXM,NZM),DSAT,\n#\tTSAT,TPRES,DPRES,ITMAX,ITMIN,TMAX,DELTAT,DTMAX,\n#\tDTMIN,DTIMPR,DTIMPG,IXIMP,NX,NZ,DY,DTINI,AIMO,\n#\tAIM1X,OPCAO,DX ,TEPM,DTM,JICAN,JFCAN,PWFL,JREF\nC\nCOMMON /DMALHA/RAIOI(NXM),RAIOE(NXM),FGX(NXM,NZM),FGZ(NXM,NZM),\n#\tZM(O:NXM+1,NZM),WX(NXM),WZ(NZM),VP,DZ(NZM)\nC\nCOMMON /G1/BG1(NXM,NZM),SG1(NXM,NZM)\nC\nCOMMON /O1/BO1(NXM,NZM),RSO1(NXM,NZM),SO1(NXM,NZM)\nC\nCOMMON /W1/BW1(NXM,NZM),SW1(NXM,NZM)\nCOMMON /G2/BG2(NXM,NZM) ,MIG2(NXM,NZM) ,R0G2(NXM,NZM),SG2(NXM,NZM)\nC\nCOMMON /02/B02(NXM,NZM),MI02(NXM,NZM),R002(NXM,NZM),RS02(NXM,NZM),\n#\tSD2(NXM,MZM)\nC\nCOMMON /W2/BW2(NXM,NZM),CTW(NXM,NZM),SW2(NXM,NZM)\nC\nCOMMON /GFX/BGFX(0:NXM+1,NZM),MIGFX(O:NXM+1,NZM),\n#\tROGFX(O:NXM+1,NZM)\nC\nCOMMON /OFX/BOFX(O:NXM+1 ,NZM) ,MIOFX(O \u2018.NXM+1 ,NZM) ,\n#\tROOFX(O:NXM+1,NZM),RSQFX(O:NXM,NZM)\nC\nCOMMON /GFZ/BGFZ(NXM,NZM+1),MIGFZ(NXM,NZM+1),ROGFZ(\u00bbXM,NZM+1)\nC\nCOMMON /DFZ/BDFZ(NXM,NZM+1),MIOFZ(NXM,NZM+1),RO0FZ(NXM,NZM+1),\n#\tRSOFZ(NXM,NZM+1)\nC\n#\n#\n#\n#\n#\n#\n#\n#\n#\n#\n#\n#\nCOMMON/TRANSP/TGX(NXM+1,NZM),TOX(NXM+1,NZM),\nTGZ(NXM,NZM+1),TOZ(NXM,NZM+1),\nKRG2(NXM,NZM),KRO2(NXM,NZM),PC2(0:NXM+1,0:NZM+1), TGXOSA(NXM,NZM),TGXOSB(NXM,NZM),\nTOXOSA(NXM,NZM),TOXOSB(NXM,NZM),\nTGXISB(NXM.NZM),TGX1SC(NXM,NZM), TOX1SB(NXM,NZM),TOX1SC(NXM,NZM), :\tTGZOSA(NXM,NZM),TGZOSB(NXM,NZM),\nTOZOSA(NXM,NZM),TOZOSB(NXM,NZM),\nt\tTGZ1SB(NXM,NZM),TGZ1SC(NXM,NZM),\n:\tTOZ1SB(NXM,NZM),TOZ1SC(NXM,NZM),\n\u25a0\u25a0\tDKRGDS (NXM, NZM) , DKRODS (NXM, NZM) ,\ni\tDPCDS (0*. NXM+1,O:NZM+1)\nc\nCOMMON /DODP/DBODP(O:NXM+1,NZM+1),DMIODP(O:NXM+1,NZM+1), \u00bb\tDROODP(0:NXM+1,NZM+1),DRSODP(0:NXM+1,NZM+1)\nC\nCOMMON /DGDP/DBGDP(O:KXM+1,NZK+1),DMIGDP(O:NXM+1,NZM+1),\n#\tDROGDP(0:NXM+1,NZM+1)\nC\nCOMMON /DWDP/DBWDP(O:NXM+1,NZM+1)\nC\nCOMMON /DFRJ/QG(NZM),QO(NZM),DQGDP(NZM),DQGDS(NZM),\n#\tDqODP(NZM),DQODS(NZM)\nCOMMON /SIS/AI(NZM*(NXM*(2*NZM+1)-NZM~1),4),FR(NXM*NZM,2),\n*\tDXJ(NXM*NZM,2),KD(NXM*NZM,1)\nC\nCOMMON /DGDS/DBGDS(O:KXM+1,NZM+1),DMIGDS(O:NXM*1,N2M*1),\n*\tDROGDS(O:NXM+1,NZM+1)\nC\nAUXQ=86400.dO\nC\n-------------------------------------------------------------------'-----\nC C\u00c9LULAS 1=1>NX E J=1,NZ\nC------------------------------------------------------------------------\nC\nDO 3 I - 1,NX\nDO 3 J - 1,NZ\nC\nIK=NZ*(I-1)+J\nC\nIAI=KD(IK,1)\nC\nC\u2014 CALCULO DOS TERMOS DE ACUMULACAO DO OLEO E DO GAS\nC\nAUX1=1.0D0+CTR*(P02(I,J)-PO1(I,J))\nCTW(I,J)=DBWDP(I,J)/BW2(I,J)\nAUX2\u00ab1.0D0+SWl(I,J)*(CTW(I,J)+CTR)*(P02(I,J)-P01(I,J))\n*\t-SW1(I,J)-SO2(I,J)\nC\nACO=VP(I,J)*(AUX1*BO2(I,J)*S02(I,J)~BO1(I,J)*S01(I,J))/DELTAT ACG=(AUX1*(BG2(I,J)*AUX2+RS02(I,J)*S02(I,J)*B02(I,J))\n*\t-BG1 (I,J)*(1.ODO-SW1(I, J)-SO\u00cd(I,J))-RSO1(I,J)*SO1(I,J)\n*\t*BD1(I,J))*VP(I,J)/DELTAT\nC\nC\u2014 CALCULO DAS DERIVADAS DDS TERMOS DE ACUMULACAO DO OLEO E DO GAS EM\nC\nC RELACAO A SATURACAQ E A PRESSAO\nC\nDACODS=VP(I,J)*AUX1*BO2(I, J)/DELTAT\nDACGDS~VP(I,J)*AUX1*(RSO2(I,J)*B02(I,J)~BG2(I,J))/DELTAT\n*\t+VP(I,J)*AUX1*DBGDS(I,J)*AUX2/DELTAT\nC\nDACODP=VP(I,J)*(CTR*B02(I,J)*S02(I,J)+AUX1*SO2(I,J)*DBDDP(I,J))\n*\t/DELTAT\nDACGDP=(CTR*(BG2(I,J)*AUX2+RSD2(I,J)*SO2(1,15*602(I, J))\n*\t+AUXl*(DBGDP(I,J)*AUX2+BG2(I,J)*SWl(I,J)*(CTWa,J)+CTR)\n*\t+S02(I,J)*B02(I,J)*DRSDDP(I,J)+SQ2(I1J)*RS02(I,J)\n*\t*DBODP(I,J)))*VP(I,Jj/DELTAT\nC\nA3=0.0D0\nA4=0.0D0\nA1=O.ODO\nA2=0.0D0\nC3=0.0D0\n04=0.ODO\n01=0.ODO\n02=0.ODO\nC\nIF(I.NE.l) THEN\n0\nC~~ CALCULO DOS POTENCIAIS DO OLEO E DO GAS NO SENTIDO X\n0\nP0T0Xl=P02(I,J)-P02(I-l,J)-R00FX(I,J)*(2M(I-l,J)-2M(I,J))\nPOTGX1=PO2(I,J)-P02(I\u201dl,J)-ROGFX(I,J)*(2M(I-1,J)-2M(I,J))\n*\t+PC2(I>J)-PC2(I-1>J)\nC\nIF(AIM1XCI,J).LE.AIM1X\u00cdI-1,J)) THEN\nIG1\u00bbAIM1X(I,J)\nELSE\nIG1=AIM1X(I-1,J)\nENDIF\nC\nC~\u201c~-------------------------------------------------------------------\nC METODO #1 : IMPES\nC-----------------------------------------------------------------------\nC1=TOX(I,J)\nc\nA1=\"TOX(I,J)\nC\nC3=T0X(I,J)*RSOFX(IjJ)+TGX(I,J)\nC\nA3=~T0X(I,J)*RSOFX(I,J)-TGX(I,J)\nC-----------------------------------------------------------------------\nC METODO #2 : SOLUC\u00c1O SIMULTANEA\nC------------------------------------------------;----------------------\nIF(IG1.GE.2) THEN\nC4~TGX(I,J)*DPCDS(I~1,J)\nC\nA4=-TGX(I,I)*DPCDS(I,J)\nC\nENDIF\nC---------:--------------------------------------------------------------\nC M\u00c9TODO #3 : SEMI-IMPL\u00cdCITO LINEARIZADO 1\nIF(IG1.GE.3) THEN\nC\nC2\u00ab-POTOX1*TOXOSA(I,J)\nC\nA2=-POTOX1*TOXOSB(I,J)\nC\nC4-C4-RS0FX(I,J)*POTDX1*TOXOSA(I,J)-POTGX1*TGXOSA(I,J)\nC\nA4=A4-P0T0Xl*RS0FX(I,J)*TOXOSB(I,J)-POTGX1*TGXOSB(I,J)\nC\nENDIF\nC-----------------------_______-----------------------------------------\nC M\u00c9TODO #4 : SEMI-IMPL\u00cdCITO LINEARIZADO 2\nC----------------------------------------------------------.-------------\nIF(IG1.GE.4) THEN\nC\nC\u2014 CALCULO DAS DERIVADAS DAS TRANSMISSIBILIDADES EM RELACAO A PRESS\u00c3O\nC\nTOXOPA\u00ab(WX(I-1)-1.ODO)*TOX(I,J)\n*\t\u2666<DMIODP(I-1,J)/MIDFX(I,J)-DBODP(I\u201c1,J)/BOFX(I1J))\nTOXOPB=(-WX(I-1)*TOX(I,J)\n*\t\u2666(DMODP(I,J)/MIOFX(I>J)-DBODP(I,J)/BOFX(I,J)))\nTGXOPA\u00bb(WX(I-\u00cd)-1.ODO)*TGX(I,J)\n*\t*(DMIGDP Cl-1,J)/MIGFX(I,J)-DBGDP(1-1,J)/BGFX(I,J)) TGXOPB=(-WX(I-1)*TGX(I,J)\n*\t*(DMIGDP(I,J)/MIGFX(I,J)-DBGDP(I,J)/BGFX(I,J)))\nC\nC1=C1-POTOX1*TOXOPA\nc\nA1-A1~POTOX1*TOXOPB\nC\nC3C3-POTOX1* (TOXOPA*RSOFX (I, J)+TOX(I, J) \u2666 (1 .ODO-WX (I-1) )\n*\t*DRSODP(I-1,J))\n*\t-POTGX1*TGXOPA\nC\nA3=A3-P0T0Xl*(HSOFX(I > I)*TQX0PB+T0X(I,J)*WX(I-1)*DRSODP(I,J))\n*\t-POTGX1*TGXOPB\nC\nENDIF\nC-----------------------------------------------------------------------\nC METODO #5 : TOTALMENTE IMPLICITO\nC\u2014----------------------------------------------:-----------------------\nIFdG\u00cd.EQ.5) THEN\nC\nC\u2014 CALCULO DAS DERIVADAS DAS DIF, DE POTENCIAL EM RELACAO A PRESSAO\nC\nPOX1PA=(1.0DO-WX(I-1))*DROODP(W,J)*(ZM(I-1,J)-ZM(I,J)) POX1PB=WX(I-1)*DROODP(It J)*(ZM(I-1>J)-ZM(I,J))\nPGX1PA=(1,ODO-WX(I-1))*DROGDP(I-1,J)*(ZM(I-1,J)-ZM(I,J)) PGX1PB=WX(I-1)*DRDGDP(I,J)*(ZM(1-1,J)-ZM(I,J))\nC\nPGX1SA-(\u00cd.ODO-WX(I-1))*DROGDS(I-1,J)*(ZM(I-1>J)\u2019ZM(I,J)) PGX1SB=WX(I-1)*DROGDS(I,J)*(ZM(I-\u00cd,J)-ZM(I,J))\nC\nC1-C1+POX1PA*TOX(I,J)\nC\nA1\u00bbA1*POX1PB*TOX<I,J)\nC\nC3=C3+POX1PA*TOX(I,J)*RSOFX(I,J)+PGX1PA*TGX(I,J)\nC\nA3\u00bbA3+POX1PB*TOX(I,J)*RSOFX(I,J)+PGX1PB*TGX(I,J)\nC\nC4=C4+PGX1SA*TGX(I,J)\nC\nA4\u201cA4+PGXlSB*TGX(IfJ)\nC\nENDIF\nC\nAI(IAI,1)=A3\nAI(IAI,2)*A4\nAI(IAI\u00ed3)=A\u00cd\nAI(IAI,4)*A2\naKiai-nZ\u2019IX^\nAI(IAI-NZ,2)=C4\nAI(IAI-NZ,3)\u00abC1.\nAI (IAI-NZ,4)=C2\nC\nC\u2014 CALCULO DA FUNCAO DE RESIDUE) DO OLEO\nC\nFRO\u00ab-TDX(I,J)*POTOX1\nC\nC~~ CALCULO DA FUNCAO DE RESIDUE) DO GAS\nC\nFRG--TDX(I,J)*RSOFX(I,J)*POTOX 1-TGX(I,J)*POTGX1\nC\nFR(IK,1)\u00ab-FRG\nFR(IK,2>-FR0\nC\nQOl-FRO*AUXq/BOFX(I,J)\nQG1=-TGX(I,J)*POTGX1*AUXQ/BGFX(I,J)\nQGS1=-TOX(I,J)*RSOFX(I,J)*POTOX1*AUXQ/BGFX(I,J)\nQTX(I,J)=DABS(QO1)+DABS(QG1)+DABS(QGS1)\nC\nEND IF\nC\nA3=0.QD0\nA4=O.ODO\nA1=0.ODO\nA2=O.ODO\nB3=O.ODO\nB4=O.ODO\nB1=0.ODO\nB2=O.ODO\nC\nIF(I.HE.NX) THEN\nC\nC\u2014 CALCULO DOS POTENCIAIS DO OLEO E DO GAS NO SENTIDO X\nC\nPOTOX2=PO2(I+1jJ)~P02(IjJ)-R0OFX(I+1,J)*(ZM(IjJ)-ZM(I+1>J))\nP0TGX2=P02(I+l,J)-P02(IfJ)-ROGFX(I+1,J)*(ZM(I,J)-ZM(I+1,J))\n*\t+PC2(I+1,J)-PC2(I,J)\nC\nIF(AIM1X(I41,J).LE.AIM1X(I,J)) then\nIG1=AIM1X(I+1,J)\nELSE\nIG1\u00bbAIM1X(I,J)\nEND IF\nC METODO #1 : IMPES\nC------------------------------------------------------------------------\nAl\u2014TOX(I+1,J)\nC\nB1=TOX(I+1,J)\nC\nA3=~T0X(I+l,J)*RSOFX(I+1,J)-TGX(I+1,J)\nC\nB3=T0X(I+l,J)*RSDFX(I+1,J)+TGX(I+1,J)\nC~\u2014-----------------------------------------------------------,---:------\nC METODO #2 : SOLUCAO SIMULTANEA\nC-~----------------------------------------------------------------------\nIF(IG1.GE.2) THEN\nC\nA4=-TGX(I+1,J)*DPCDS(I, J)\nC\nB4=TGX(1+1tJ)+DPCDS(1+1,J)\nC\nENDIF\nC:-----------------------------------------------------------------------\nC METODO #3 : SEMI-IMPLICITO LINEARIZADO 1\nC------------------------------------------------------------------------\nIF(IG1.GE.3) THEN\nC\nA2=?OTOX2*TOX1SB(I,J)\nC\nB2^POTOX2*TOX1SC(I,I)\nC\nA4=A4+P0T0X2*RS0FX(1+1,1)*TOX1SB(I,J)+POTGX2*TGX1SB(I,J)\na\nB4-B4+POTOX2*RSOFX(I+i,J)+TOX\u00cdSC(I,J)+POTGX2*TGX1SC(I, J)\nc\nENDIF\nC------------------------------------------------------------------------\nC METODO #4 : SEMI-IMPLICITO LINEARIZADO 2\nC------------------------------------------------------------------------\nIFCIG1.GE.4) THEN\nC\nC\u2014 CALCULO DAS DERIVADAS DAS TRANSMISSIBILIDADES EM RELACAO A PRESS\u00c3O\nC\t'\nTOX1PB=(WX(I)-1.ODO)*TOX(I+1,I)\n*\t*(DMIDDP(I,J)/MIOFX(I+1, J)-DBODP(I, J)/BOFX(I+1, J)) TOXIPC--WX(I)*TOX(I+1,J)\n*\t*(DMIODP(I+1)J)/MIOFX(I+1\u00cdJ)-DBODP(I+1>J)/BOFX(I+1\u00cdJ)) TGX1PB=CWX(I)~1.ODO)*TGX(I+1,J)\n*\t*(DMIGDP(I,J)/MIGFX(I+1,J)-DBGDP(I,J)/BGFX(I+1,J)) TGX1PO-WX(I)*TGX(I+1,J)\n*\t*(DMIGDP(I+i,J)/MXGFX(I+1,J)-DBGDP(I+1,J)/BGFX(I+1,J)) C\nA1=A1+POTOX2*TOX1PB\nC\nB\u00cd=B1+PQTOX2*TOX1PC\nC\nA3=A3+P0T0X2*(RSOFX(1+1,J)*TOX1PB+TDX(I+1,J)*(l.ODO-WX(I))\n*\t*DRSODP(I\u00cdJ))\n*\t+POTGX2*TGX1PB\nC\nB3\u00abB3+P0T0X2*(RSDFX(I+l,J)*T0XlPC+T0X(I+l,J)*WX(I)\n*\t*DRSODP(I+1,J) )\n*\t+POTGX2*TGX1PC\nC\nENDIF\nC------------------------------------------------------------------------\nC METODO #5 : TOTALMENTE IMPLICITO\nC~----------------------_------------------------------------------------\nIF\u00cdIG1.EQ.5) THEN\nC\nC\u2014 CALCULO DAS DERIVADAS DAS DIF. DE POTENCIAL EM RELACAO A PRESSAO\nC\nP0X2PB=(\u00ed.ODO-WX(I))*DROODP(I,J)*(ZM(I,J)\"ZM(I+1,J))\nPOX2PC\u00bbWX(I)*DROODP(I+1,J)*(ZM(I,J)-ZM(I+1,J)) PGX2PB-(1.0D0\u201cWX(I))*DR0GDP(I,J)*(ZM(I>J)-ZM(I+ltJ))\nPGX2PC=WX(I) *DROGDP(I+1, J) *(ZM(I, J).-ZM(I+1, J))\nC\nPGX2SB\u00bb(1.ODO-WX(I))*DROGDS(I,J)\u2666(ZM(I,J)-ZM( 1+ \u00ed,J))\nPGX2SC=WX(I)*DR0GDS(I+l,J)*(ZM(I,J)-ZM(I+1,J))\nC\nAl=Al-P0X2PB*T0X(1+1,J)\nC\nBl\u00bbBl-P0X2PC*T0X(I+l,J)\nC\nA3=A3-P0X2PB*T0X(I+l,J)\u2666RSOFX(I+1,J)-PGX2PB*TGX(1+1,J)\nB3=B3~POX2PC*TOX(I+1,J)*RSOFX(I+1,J)-PGX2PC*TGX(I+1,J)\nC\nA4=A4-PGX2SB*TGX(1+1\u201eJ)\nC\nB4=B4~PGX2SC*TGX(I+1,J)\nC\nENDIF\nC\nAI(IAI,1>AI(IAI,1)+A3\nAI(IAI,2)=AI(IAIJ2)+A4\nAI(IAI,3)\u00bbAI(IAI,3)+A1\nAI(IAI,4)=AI(IAX,4)+A2\nAI(IAI+NZ,1)-AI(IAI+NZ,1)+B3\nAX(XAI+NZ,2)=AI(IAI+NZ,2)+B4\nAX(IAI+NZ,3)=AX(IAI+NZJ3)+B1\nAI(IAX+NZ,4)=AI(IAI+NZJ4)+B2\nC\nC\u2014 CALCULO DA FUNCAO DE RESIDUQ DO OLEO\nC\nFRO=TOX(1+1,J)*P0T0X2\nC\nC\u2014 CALCULO DA FUNCAO DE RESIDUO DO GAS\nC\nFRG\u00abT0X(I+l,J)*RS0FX(I+l,J)*P0T0X2+TGX(I+l,J)*P0TGX2\nC\nFR(IK,1)\u201cFR(IKJ1)-FRG\nFR(IK,2)=FR(IK,2)~FR0\nC\nENDXF\nC\nIF(NZ.NE.l) THEN\nC\nA3=0.0D0\nA4\u00aeO.ODO\nA1=O.ODO\nA2=0.0D0\nC3=0.0D0\nC4-0.ODO\nC1=O.ODO\nC2=0.0D0\nc\nIF(J.NE.l) THEN\nC\nC\u2014 CALCULO DOS POTENCIAIS DO OLEO E DO GAS NO SENTIDO Z\nC\nPOTOZ1=PD2(I,J)-P02(I,J-1)+ROOFZ(I,J)*(ZM(I,J)-ZM(I,J-l))\nP0TGZl\u00abP02(I,J)-P02(I,J-l)+R0GFZ(I,J)*(ZM(I,J)-ZM(I,J-l))\n*\t+PC2(I,J)-PC2(I,J-1)\nC\nIF(AIM1X(I,J).LE.AIM1X(I,J-l)) THEN IG1-AIM1X(I,J)\nELSE\nIG1=AIM1X(I,J-i)\nENDIF\nC\nC------------------------------------------------------------------------\nC METODO #1 : IMPES\n(J---:-----------------------------------------------:-------------------\nC1=TOZ(I,J)\nC\nA1\u00ab-TOZ(I,J)\nC\nC3=TOZ(I,J)*RSOFZ(I,J)+TGZ(I,J)\nC\nA3=-T0Z(I,J)*RSOFZ(I,J)-TGZ(I,J)\nC------------------------------------------------------------------------\nC METODO #2 : SOLUCAO SIMULTANEA\nIF(IG1.GE.2) THEN 1\t\nC4=TGZ(I,J)*DPCDS(I,J-l) 1\t\nA4=-TGZ(I,J)+DPCDS(I,J) F\t\nENDIF [\t\nC METODO #3 : SEMI-IMPLICITO LINEARIZADO 1\nC-------------------------------------------\nIF(IG1.GE.3) THEN\nC\nC2=-P0T0Zl*T0Z0SA(I,J)\nc\nA2--P0T0Zl*T0Z0SB(l,J)\nC4-C4-RS0FZ(I, J) *POTOZ1*TOZOSA(I, J) -POTGZ1*TGZOSA.(I, J)\nC\nA4=A4-POTOZ1*RSOFZ(I,J)*TOZOSB(I,J)~POTGZ1*TGZOSB(I,J)\nC\nENDIF\nC------------------------------------------------------------------------\nC METODO #4 : SEMI-IMPLICITO LINEARIZADO 2\nC------------------------------------------------------------------------\nIF(IG1.GE.4) THEN\nC\nC\u2014 CALCULO DAS DERIVADAS DAS TRANSMISSIBILIDADES EM RELACAO A PRESSAO\nC\nT\u00dcZOPA= (WZ ( J-1) -1 \u2022. ODO ) *TOZ (I, J )\n*\t*(DMIODP(I,J\"1)/MIOFZ(I,J)-DBODP(I,J\u20191)/BOFZ(I,J))\nTOZOPB\u00ae(-WZ(J-1)*TOZ(IJJ)\n*\t*(DMIODP(I,J)/MIOFZ(I,J)-DBODP(I,J)/BOFZ(I,J)))\nTGZOPA\u201c(WZ(J-1)-\u00cd.ODO)*TGZ(I,J)\n*\t*(DMIGDP(I,J-1)/MIGFZ(I,J)-DBGDP(I,J-1)/BGFZ(I,J))\nTGZOPB=(-WZ(J-1)*TGZ(I,J)\n*\t*(DMIGDP(I,J)/MIGFZ(I,J)-DBGDP(I,J)/BGFZ(I,J)))\nC\nC1=C1\u201cPOTOZ1*TOZOPA\nC\nA1\u2019A1-POTOZ\u00cd*TOZOPB\nC\nC3\u00aeC3~P0T0Zl*(T0Z0PA*RSQFZ(I,J)+TOZ(I,J)*(l.ODO-WZ(J-l))\n*\t*DRSODP(I,J-1))\n*\t-POTGZ1+TGZOPA\nC\nA3=A3-P0T0Zl*(RSQFZ(I,J)+TOZOPB+TOZ(I,J)*WZ(J-1)*DRSODP(I,J))\n*\t-POTGZ1*TGZOPB\nC\nENDIF\nC------------------------------------------------------------------------\nC METODO #5 : TOTALMENTE IMPLICITO\nC------------------------------------------------------------------------\nIF(IGl.EQ.S) THEN\nC\nC\u2014 CALCULO DAS DERIVADAS DAS DIF. DE POTENCIAL EM RELACAO A PRESSAO\nPOZ1PA=-(\u00cd.ODO-WZ(J-1))*DRDODP(I,J-1)*(ZM(IJJ)-ZM(IJJ-1))\nPOZlPB=-WZ(J-i)*DROODP(I>J)*(ZM(I,J)-ZM(I,J-l))\nPGZ1PA\u00ab-(1.ODO-WZ(J-1))*DROGDP(I,J-1)*(ZM(I,J)-ZM(I,J-1))\nPGZ1PB\u00ab\u201cWZ(J\u201c1)*DROGDP(IU)*(ZM(I,J)-ZM(I,J-1))\nC\nPGZ1SA=\u201c(1.ODO-WZ(J-1))*DROGDS(I,J~1)*(ZM(I,J)-ZM(ItJ-l)) PGZ1SB\u00ab-WZ(J-1)*DROGDS(I,J)*(ZM(I,J)~ZM(I,J-1))\nC\nC1\u00abC1+POZ1PA*TOZ(I,J)\nC\nA1\u00abA1+POZ1PB*TOZ(I, J)\nC\nC3=C3+POZ1PA*TOZ(I,J)*RS0FZ(I,J)+PGZ1PA*TGZ(I,J)\nC\nA3=A3+POZ1PB*TOZ(I,J)*RSOFZ(I,J)+PGZ1PB*TGZ(I, J)\nC\nC4=C4+PGZ1SA*TGZ(I,J)\nC\nA4=A4+PGZ1SB*TGZ(I,J)\nC\nEJ\u00cdDIF\nC\nAI\u00c7IAI,\u00ed)=AI(IAIf1)+A3\nAI(IAI,2)\u00abAI(IAI,2)+A4\nAI(IAI,3)\u00abAI(IAI,3)+A1\nAI(IAI,4)\u00abAI(IAI,4)+A2\nAI(IAI-1,1)\u00abAI(IAI-1,1)+C3\nAI(IAI-1,2)\u00abAI(IAI~\u00cd,2)+C4\nAI(IAI-1,3)\u00abAI(IAI-1,3)+C1\nAKlAI-l^WKlAI-i^\u00ed+CZ\nC\nC\u2014 CALCULO DA FUNCAO DE RESIDUO DO OLEO\nC\nFRO=-TOZ(I,J)*POTOZ1\nC\nC\u2014 CALCULO DA FUNCAO DE RESIDUO DO GAS\nC\nFRG=~TOZ(I,J)*RSOFZ(I,3)\u2666POTOZl-TGZ(I,J)*POTGZ1\nC\nFR(IK,1)\u00abFR(IK,1)-FRG\nFRCIK,2)\u00abFR(IK,2)-FRO\nQO1=FRO*AUXQ/BOFZ(I,J)\nQG1=-TGZ(1,1)*P0TG21*AUXQ/BGFZ(1,3)\nQGS1=\"TOZ(I,J)*RSOFZ(I,J)*POTDZ1*AUXQ/BGFZ(I, J)\nQTZ(ItJ)\u00abDABS(QDl)+DABS(QGl)+DABS(QGSl)\nC\nENDIF\nC\nA3=0.0D0\nA4=O.ODO\nA1=O.ODO\nA2=0.0D0\nB3=0.0D0\nB4=0.0D0\nB1=O.ODO\nB2=0,0D0\nC\nIF(J.NE.NZ) THEN\nC\nC~~ CALCULO DOS POTENCIAIS DO OLEO E DO GAS NO SENTIDO X\nC\nP0T0Z2=P02(I,J+l)~P02(I,J)+ROOFZ(I,J+1)*(ZM(I,J+1)-ZM(I,J))\nPOTGZ2=P02(I,J+1)-P02(I,J)+ROGFZ(I,J+1)*(ZM(I,J+1)-ZM(I,J))\n*\t+PC2(I,J+1)~PC2(I,J)\nC\nIF(AIM1X(I,J+l).LE.AIMlXfl,J)) THEN\nIG1\u00abAIM1X(I,J+1)\u2019\nELSE\nIG1\u00abAIM1X(I,J)\nENDIF\nC\nC------------------------------------------------------------------------\nC METODO #1 : IMPES\nC------------------------------------------------------------------------\nAi\u00bb-TOZ(I,J+l)\nC\nB1\u00bbTOZ(I,J+l)\nC\nA3=-T0Z(I,J+1)*RSOFZ(I,J+l)-TGZ(I,J+l)\nC\nB3=TOZ(I,J+1)*RSOFZ(I,J+1)+TGZ(I,J+l)\nC\u2014-----------------------------------------------------------------------\nC METODO #2 : SOLUCAO SIMULTANEA\nC---------------------------------:--------------------------------------\nIF(IG1.GE.2) THEN\nC\nA4=-TGZ(I,J+1)*DPCDS(I,J)\nC\nB4=TGZ(I,J+1)*DPCDS(I1J+1)\nc\nENDIF\nC------------------------------------------------------------------------\nC METODO #3 : SEMI-IMPL\u00cdCITO LINEARIZADO 1\nC------------------------------------------------------------------------\nIF(IG1.GE.3) THEN\nC\nA2=POTOZ2*TOZ1SB(I,J)\nC\nB2=POTDZ2*TOZ1SC(I,J)\nC\nA4-A4+P0T0Z2*RS0FZ(I,J+l)*TOZ1SB(I,J)+POTGZ2*TGZ1SB(I,J)\nC\nB4=B4+P0T0Z2*RS0FZ(I,J+1)*TDZ1SC(I,J)+PQTGZ2*TGZ1SC(I,J)\nC\nENDIF\nC------------------------------------------------------------------------\nC METODO #4 : SEMI-IMPLICITO LINEARIZADO 2\nC------------------------------------------------------------------------\nIF(IG1.GE.4) THEN\nC\nC\u2014 CALCULO DAS DERIVADAS DAS TRANSMISSIBILIDADES EM RELACAO A PRESSAO\nC\nTOZ1PB=(WZ(J)-1.ODO)*TOZ(I,J+l)\n*\t*(DMIODP(I,J)/MIOFZ(I,J+1)-DBODP(I,J)/BOFZ(I J+l))\nTOZ1PC=-WZCJ)*TOZ(I>J+1)\n*\t* (DMIODP(I, J+l) /MIOFZd, J+l) -DBODP (I, J+l) /BOFZ (I, J+l) ) TGZ1PB\u00ae(WZ(J)-1.ODO)*TGZ(I,J+l)\n*\t*(DMIGDP(I,J)/MIGFZ(IfJ+1)-DBGDP(I,J)/BGFZ(I,J+l)) TGZ1PC=-WZ(J)*TGZ(I,J+l)\n*\t*(DMIGDP(I,J+1)/MIGFZ(I,J+1)-DBGDPCI,J+1)/BGFZ(I,J+1))\nC\nA1=A1+POTOZ2*TOZ1PB\nC\nB1=B1+POTOZ2*TOZ1PC\nC\nA3=A3+P0TDZ2*(RSOFZ\u00cdIJ+l)*TOZ1PB+TOZ(I,J+l)*(1.ODO-WZ(J))\n*\t*DRSODP(I,J))\n*\t+PDTGZ2*TGZ1PB\nC\nB3=B3+P0T0Z2*(RS0FZ(I,J+1)*TOZ1PC+TOZ(I,J+1)*WZ(J)\n*\t*DRSODP(I,J+l))\n*\t+POTGZ2*TGZ1PC\nC\nENDIF\nC-----------:------------------:-----------------------------------------\nC METODO #5 : TOTALMENTE IMPLICITO\nC------------------------------------------------------------------------\nIF(IGl.EQ.S) THEN\nC\nC\u2014 CALCULO DAS DERIVADAS DAS DIF. DE POTENCIAL EM RELACAO A PRESSAO\nC\nP0Z2PB=-(l,ODO-WZ(J))*DRODDP(ItJ)*(ZM(I,J+1)~ZM(I,J)) POZ2PO-WZ(J)*DROODP(I, J+1)*(ZM(I, J+1)-ZM(I, J)) PGZ2PB=-(1.ODO\u201cWZ(J))*DROGDP(I,J)*(ZM(I,J+1)-ZM(I,J)) PGZ2PO\u201cWZ(J)*DROGDP(IIJ+1)*(ZM(I\u00cd J+1)-ZM(I, J))\nC\nPGZ2SB\u00bb-(1.0DO\"WZ(J))*DROGDS(I,J)*(ZM(I,J+1)\"ZM(I,J)) PGZ2SC\u00ae~WZ(J)*DR0GDS(I,J+1)*(ZM(I,J+1)-ZM(I,J))\nC\nA1=A1-POZ2PB*TOZ(I,J+l)\nC\nB1=B1-POZ2PC*TOZ(I,J+l)\nC\nA3-A3-P0Z2PB*T0Z(l,J+l) *RSOFZ(I,J+1)-PGZ2PB*TGZ(I,J+l)\nC\nB3=B3-P0Z2PC*T0Z(I,J+l)*RSOFZ(1,1+1)-PGZ2PC+TGZ(I,J+l)\nC\nA4=A4~PGZ2SB*TGZ(I,J+l)\nC\nB4=B4~PGZ2SC*TGZ(I,J+l)\nC\nENDIF\nC\nAI(IAI,1)~AI(IAI,1)+A3\nAI(IAI,2)=AI(IAIl2)+A4\nAI(IAI,3)=AI(IAI,3)+Al\nAI(IAI,4)=AI(IAI,4)+A2\nAI(IAI+1fl)=AI(IAI+1,i)+B3\nAI(IAI+1,2)\u00abAI(IAI+1,2)+B4\nAI(IAI+1,3)=AI(IAI+1,3)+B1\nAl(IAI+1,4)=AI(IAI+1,4)+B2\nC\nC\u2014 CALCULO DA FUNCAO DE RESIDUO DO OLEO\nC\nFRO=TOZ(I,J+1)+PDT0Z2\nC\nC\u2014 CALCULO DA FUNCAO DE RESIDUE) DO GAS\nC\nFRG-T0Z(I, J+D*RS0FZ(I, J+lJ+POTOZZ+TGZflj J+l)*P0TGZ2\nc\nFRdK,l)=FRdK1l)\"FRG\nFR(IK,2)\u00abFR(IK,2)-FR0\nC\nENDIF\nENDIF\nC\nIF(I.EQ.1.AND.(J.GE.JICAN.AND.J.LE.JFCAN)) THEN\nAl(IAI,1)=AI(IAI,1)-DACGDP-DQGDP(J)\nAldAI, 2)\u201cAI(IAI, 2)~DACGDS~DQGDS( J)\nAl(IAI,3)=AI(IAI,3)-DAC0DP-DQ0DP(J)\nAI(IAI,4)\u00abAI(IAI,4)-DACDDS-DQODS(J)\nc\nFR(IKjti)=\u2019FR(IK,l)+QG(J)+ACG\nFR(IK,2)\u00bbFR(IK,2)+QO(J)+ACO\nC\nELSE\nC\nAl (IAI 11)=AI (IAI,D-DACGDP\nAl(IAI,2)=AI(IAI,2)-DACGDS\nAl(IAI,3)=AI(IAIa3)-DACODP\nAl(IAI34)=AI(IAI,4)\u201cDACODS\nC\nFR(IK,1)SSFR(IK,1)+ACG\nFR(IK,2)=FR(IK,2)+AC0\nC\nENDIF\nC\n3 CONTINUE\nC\nRETURN\nEND\nC SUBBOTINA DE MONTAGEM DOS VETORES DE PONTEIROS \"IA \"/\u2019\u2019IA\" PARA NSPIV C~----------------------------------------------------------------------\nSUBROUTINE P0INT2 (IA,JA)\nC\nPARAMETER (NTM=10,NXM=15,NZM\u00bb15)\nIMPLICIT DOUBLE PRECISION (A-H,O~Z)\nREAL*8 KX,KZ,TEPM(NTM),DTM(NTM),DX(NXM),QOMAX(NTM)\nINTEGER OPCAO,AIMO(NXM,NZM),AIM1X(NXM,NZM)\nINTEGER NC(NXM*NZM*2)\nINTEGER IA(NXM*NZM*2+1),JA(5*NXM*NZM*4)\nC\nCOMMON /DADOS/PREF, QOMAX, QOMIN, PWFMIN, CTR, PHI(NZM) ,RW,RE,ESP,TEMP, t\tDG,SWI,ZMED,ZTW,ZTE,KX(NXM,NZM),KZ(NXM,NZM),DSAT,\n\u00bb\tTSAT,TPRES,DPRES,ITMAX,ITMIN,TMAX,DELTAT,DTMAX,\n#\tDTMIN,DTIMPR,DTIMPG, IXIMP,NX,NZ,DY,DTINI,AIMO,\n#\tAIM1X,OPCAO,DX ,TEPM,DTM , JICAN,JFCAN,PWFL,JREF\nC\nC\u2014 VETOR COM NUMERO DE VALORES NAO NULOS POR LINHA\nC\nK=1\nDQ1I= 1(NX\nDO 1 J = 1,NZ\nKK=1\nIF(I.NE.1.AND,(AIMIX\u00cdI,J).EQ.5.AND.AIM1X(I~1,J).EQ.5)) KK-KK+2 IF\u00cdI.NE.1.AND.(AIMIX\u00cdI,J).EQ.1.OR.AIM1X\u00cdI-1,J).EQ.l)) KK=KK+1 IF\u00cdI.NE.NX.AND.(AIMIX\u00cdI,J).Eq.5.AND.AIMlX(I+l,J).Eq.5)) KK=KK+2 IF(I.NE.NX.AND.(AIMIX\u00cdI,J).EQ.1.OR.AIM1X(I+1,J).EQ.l)) KK=KK+1 IF(J.NE.1.AND.(AIMIX\u00cdI,J).Eq.5.AND.AIMIX\u00cdI,J-l).EQ.5)) KK=KK+2 IF(J.NE.1.AND.(AIMIX\u00cdI,J).Eq,1-OR.AIMIX\u00cdI,1-1).EQ.l)) KK=KK+1 IF(J.NE.NZ.AND.(AIM1X(I,J).EQ.5.AND.AIM1X(I,J+l).EQ.5)) KK-KK+2 IF(J.NE.NZ.AND.(AIMIX\u00cdI,D.EQ.l.DR.AIMIX\u00cdI,J+l).EQ.l)) KK=KK+1 NC(K)=KK\nNC(K+1)=KK\nK=K+2\n1 CONTINUE\nC\nC-\u201c VETOR COM A POSICAO ACUMULADA DO PRIMEIRO VALOR NAO NULO DE CADA\nC LINHA\nC\nIA(1)\u00bb1\nKK=1\nM 2 I = 1,NX\nDO 2 J = 1,NZ\nIA(KK+1)-IA(KK)+NC(KK)\nIA(KK+2)=IA(KK+1)+NC(KK+1)\nKK=KK+2\n2\tCONTINUE\nC\nC\u2014 VETOR COM A POSICAO DE CADA UM DOS VALORES NAO NULOS DE CADA LINHA\nC\nKK=O\nJB=NZ\nDO 3 I - 1,NX\nDO 3 J = 1,NZ\nKK=KK+1\nKM-KK-2+JB\nKP=KK+2*JB\nKCL=IA(KK)\nJA(KCL)=KK\nM=1\nIF(J.EQ.NZ) GO TO 100\nLM=M\nJA(KCL+LM)=KK+2\nM-M+l\nIF(AIM1X(X,J).EQ.1.DR.AIM1X(I,J+l).EQ.1) GO TO 100\nJA(KCL+LM+l)-KK+3\nM=M+1\n100\tIF(J.EQ.l) GD TO 101\nLM=M\nJA(KCL+LM)=KK~2\nM=M+1\nIF(AIM1X(I,J).EQ.1.OR.AIM1X(I,J-1).EQ.l) GO TO 101\nJA(KCL+LM+1)=KK-1\nM=M+1\n101\tIF(I.EQ.l) GO TO 102\nLM-M\nJA(KCL+LM)=KM\nM=M+1\nIF(AIM1X(I,J).EQ.l.OR.AIM1X(I-1,J).EQ.l) GO TO 102\nJA(KCL+LM+1)=KM+1\nM=M+1\n102\tIF(I.EQ.NX) GO TO 103\n103\nC\n104\n105\n106\nLM-M\nJA(KCL+LM)=KP\nM=M+1\nIF(AIM1X(I,J).EQ. 1.0R. AIMlXQ+l, J).EQ.l) GO TO 103 JA(KCL+LM+1)=KP+1\nCONTINUE\nKK=KK+1\nKM=KK-2*JB\nKP=KK+2*JB\nKCL=IA(KK)\nJA(KCL)=KK\nM=1\nIF(J.EQ.NZ) GO TO 104\nLM=M\nJA(KCL+LM)=KK+1\nM=M+1\nIF(AIM1X(I,J).EQ.l.OR.AIM1X(I,J+1).EQ.l) GO TO 104 JA(KCL+LM+l)=KK+2\nM=M+1\nIF(J.EQ.l) GD TO 105\nLM=M\nJA(KCL+LM)=KK-3\nM=M+1\nIF(AIM1X(I,J)-EQ.l.OR.AIMlX(IfJ-l).EQ.l) GO TO 105 JA(KCL+LM+l)=KK-2\nM=M+1\nIF(I.Eq.l) GO TO 106\nLM=M\nJA(KCL+LM)=KM-1\nM=M+1\nIF(AIM1X(I,J).EQ.l.OR.AIM1X(I-1,J).EQ.l) GO TO 106 JA(KCL+LM+1)=KM\nM=M+1\nIF(I.EQ.NX) GO TO 107\nLM=M\nJA(KCL+LM)=KP-1\nM=M+1\nIF\u00cdAIM1XEQ.l.OR.AIM1X(I+1,J).EQ.l) GO TO 107 JA(KCL+LM+1)=KP\nCONTINUE\n3\tCONTINUE\nC\nRETURN\nEND\nC\nC------------------------------------------------------------------------\nC SUBBOTINA PARA INVERS\u00c3O DA MATRIZ BLOCO DIAGONAL PRINCIPAL DA MATRIZ E\nC JACOBIANA E MULTIPLICACAD DA RESPECTIVA LINHA DO SISTEMA DE EQUACOES\nC\nC\nC VARIAVEIS PRINICIPAIS\nC --------------------------\nC\nAIM1X - MATRIZ DE IMPLICITUDE ATUAL\nC Al\n- MATRIZ JACOBIANA\nC ER\n- VETOR COM AS FUNCOES DE RES\u00cdDUOS\nC\nO \u2014---------------------------------------------------------------------\nSUBROUTINE INVERT\nC\nPARAMETER (NTM=10iNXM=15>NZM=15)\nIMPLICIT DOUBLE PRECISION (A-H,O-Z)\nREAL*8 KX,KZ\nREAL*8 DTM(NTM),TEPM(NTM),DX(NXM),QOMAX(NTM)\nINTEGER OPCAD,AIMO(NXMtNZM),AIM1X(NXM,NZM)\nC\nCOMMON /DADOS/PREF.qOMAX^QOMIN.PWFMIN.CTRjPHKNZM) ,RW,RE\u00bbESP,TEMP,\n\u00ab\tDC,SWI,ZMED,ZTW,ZTE,KX(NXM,NZM),KZ(NXM,NZM)tDSAT,\n#\tTSAT,TPRES,DPRES,ITMAX,ITMIN,TMAX,DELTAT,DTMAX,\n#\tDTMIN,DTIMPR,DTIMPG,IXIMP,NX,NZ,DY,DTINI>AIMO,\n#\tAIM1X,OPCAO,DX,TEPM,DTM,JICAN,JFCAN,PWFL,JREF\nC\nCOMMON /SIS/AI(NZM*(NXM*(2*NZM+1)-NZM-1),4),FR(NXM*NZM,2),\n#\tDXJ(NXM*NZM , 2),KD(NXM*NZM,1)\nC\nDO 1 I = 1,NX\nDO 1 J = 1,NZ IK=NZ*(I~1)+J IAI=KD(IK,1)\nC\nC\u2014 INVERSA DE \u201dA(IAI,-\u2014)\"\nC\nDET=AI(IAI,1)*AI(IAI,4)-AI(IAI,2)*AI(IAI,3)\nA1=AI(IAI,1)\nA2-AI(IAI,2)\nA3\u00bbAI(IAI,3)\nA4=AI(IAI,4)\nC\nE1=A4/DET\nE2=-A2/DET\nE3--A3/DET\nE4=A1/DET\nC\nC\u2014 MULTIPLICANDO A LINHA \"IAI\" PELA INVERSA DE \"AI(IAI),!\nC\nc\nC\u2014 \u201dAI(IAI-NZ,\u2014)\"\nC\nIF(I.NE.l) THEN\nD1\u00abAI(IAI-NZ,1)\nD2\u00abAI(IAI-NZ,2)\nD3=AI(IAI-NZ,3)\nD4=AI(IAI~NZ,4)\nC\nAI(IAI-NZ,i)=El*Dl+E2*D3\nAI(IAI-NZ,3)=E3*D1+E4*D3\nIF(AIM1X(I,J).EQ.5.AND.AIM1X(I~1,J).EQ.5) THEN\nAI(IAI-NZ,2)=E1*D2+E2*D4\nAl(IAI-NZ,4)=E3*D2+E4*D4\nEND IF\nENDIF\nC\nC\u2014 \"Al (IAI+NZ,\u2014-)''\nC\nIF(I.NE.NX) THEN\nD1\u00abAI(IAI+NZ,1)\nD2=AI(IAI+NZ,2)\nD3=AI(IAI+NZ,3)\nD4=AI(IAI+NZ,4)\nC\nAl(IAI+NZ,1)=E1*D1+E2*D3\nAI(IAI+NZ,3)=E3*D1+E4*D3\nIF(AIM1X(I,J).EQ.5.AND.AIM1X(I+1,J).EQ.5) THEN\nAl(IAI+NZ,2)=E1*D2+E2*D4\nAI(IAI+NZ,4)=E3*D2+E4*D4\nENDIF\nENDIF\nC\nC\u2014 ,!AI(IAI-1,---)\u201d\nC\nIF(J.NE.l) THEN\nD1\u00bbAI(IAI-1,1)\nD2=AI(IAI-1,2)\nD3\u00abAI(IAI-1,3)\nD4=AI(IAI-1,4)\nC\nAI(IAI-1,1)-E1*D1+E2*D3\nAI(IAI-1,3)=E3*D1+E4*D3\nIF(AIM1X(I,J).EQ.S.AND.AIMlX\u00cdI.J-l).EQ.5) THEN\nAI(IAI-1,2)=E1*D2+E2*D4\nAI(IAI-1,4)=E3*D2+E4*D4\nENDIF\nEND IF\nC\nC\u2014 \"Al(IAI+l,\u2014)\"\nC\nIF(J.NE.NZ) THEN\nD1\u00abAI(IAI+1,1)\nD2=AI(IAI+1,2)\nD3=AI(IAI+1,3)\nD4\u00bbAI(IAI+1,4)\nC\nAI(IAI+1,1)=E1*D1+E2*D3\nAI(IAI+1,3)\u00abE3*D1+E4*D3\nIF(AIMIXCI.J).EQ.5.AND.AIM1X(I,1+1).EQ.5) THEN\nAI(IAI+1I2)=E1*D2+E2*D4\nAKIAI+1 J4)=E3*D2+E4*D4\nENDIF\nENDIF\nC\nC\u2014 \"AI(IAI,\u2014)*'\nC\nAI(IAI,1)=1.ODO\nAI(IAI,4)=1.ODO\nC\nC\u2014 *'FR(IAI,---)\"\nC\nD1~FR(IK,1)\nD2\u00bbFR(IK,2)\nFR(IK,1)\u00abE1*D1+E2*D2\nFR(IK,2)=E3*D1+E4*D2\nC\n1\tCONTINUE\nC\nRETURN\nEND\nC\nC------------------------------------------------------------------------\nC SUBRDTINA PARA MONTAGEM DO VETOR DE ORDENACAO E SOLUCAO DO SISTEMA\nC DE EQUA\u00c7\u00d5ES (ESTA SUBBOTINA CHAMA NSPIV)\nC\nC\nC VARIAVEIS PRINICIPAIS\nC -------------------------\nC\nC R,C - VETOR qUE INDICA A ORDEM DE ELIMINACAO DAS EQUACOES DO\nC\tSISTEMA A SER RESOLVIDO\nC\nC\nC------------------------------------------------------------------------\nSUBROUTINE SOLVE (X,FIM)\nC\nPARAMETER (NTM=10,NXM=15,NZM=15,MAX-100000)\nIMPLICIT DOUBLE PRECISION (A-H,O~Z)\nREAL*8 KX,KZ,DTM(NTM),TEPM(NTM),DX(NXM),QOMAX(NTM)\nINTEGER OPCAD,AIMO(NXM,NZM),AIM1X(NXM,NZM)\nDIMENSION A(5*NXM*NZM*4),B(NXM*NZM*2),X(NXM*NZM*2),\n#\tRTEMP(2*NXM*NZM+MAX)\nINTEGER IA(NXM*NZM*2+1),JA(5*NXM*NZM*4),\n#\tR(NXM*NZM*2)1C(NXM*NZM*2),ITEMP(4+NXM*NZM+MAX+2),\n#\tIC(NXM*NZM*2)\nINTEGER IND(NXM,NZM)\nC\nCOMMON /DADOS/PREF, QOMAX,QOMIN,PWFMIN,CTR, PHI (NZM) ,RW,RE,ESP,TEMP,\n#\tDG,SWI,ZMED,ZTW,ZTE,KX(NXM,NZM),KZ(NXM,NZM),DSAT,\n#\tTSAT,TPRES,DPRES,ITMAX,ITMIN,TMAX,DELTAT,DTMAX,\n#\tDTMIN,DTIMPR,DTIMPG,IXIMP,NX,NZ,DY,DTINI,AIMO,\n#\tAIM IX,DPCAO,DX,TEPM,DTM,JICAN,JFCAN,PWFL,JREF\nC\nCOMMON /SIS/AI(NZM*(NXM*(2*NZM+1)-NZM-1),4),FR(NXM*NZM,2), #\tDXJ(NXM*NZM,2),KD(NXM*NZM,1)\nC\nCALL P0INT2 (IA,JA,IND,FIM)\nC\nCALL INVERT\nC\nC\u2014 NUMERO DE EQUA\u00c7\u00d5ES E INC\u00d3GNITAS\nC\nN=2*NX*NZ\nC\nNPTO=IA(N+1)~IA(1)\nDO 1 IZ = 1,NPTO\nA(NPTO)=O.ODO\n1 CONTINUE\nC\nKK=O\nDD 2 I = \u00cd,NX\nDO 2 J = 1,NZ\nIK=NZ*(I-1)+J\nIAI\u00bbKD(IK,1)\nKK=KK+1\nKCL=IA(KK)\nA(KCL)=AI(IAI,1)\nM\u00bb1\nIF(J.EQ.NZ) GO TO 100\nLM=M\nA(KCL+LM)=AI(IAI+1,1)\nM\u00abM+1\nIF(AIM1X(I,J).EQ.1-OR.AIM1X(I,J+l).EQ.1) GO TO 100\nA(KCL+LM+1)-AI(IAI+1,2)\nM=M+1\n100\tIF(J.EQ.l) GO TO 101\nLM-M\nA(KCL+LM)=AI(IAI~1,1)\nM=M+1\nIF(AIM1X(I,J).EQ.l.OR.AIMlX(I.J-l).EQ.l) GO TO 101 A(KCL+LM+1MI(IAI-1,2)\nM=M+1\n101\tIF(I.EQ.l) GO TO 102\nLM=M\nA(KCL+LM)\u00abAI(IAI-NZ,1)\nM=M+1\nIF(AIM1X(I,J).EQ.1.OR.AIM1X(I-1,J).EQ.1) GO TO 102\nA(KCL+LM+1)=AI(IAI-NZ,2)\nM=M+1\n102\tIF(I.EQ.NX) GO TO 103\nLM=M\nA(KCL+LM)\u00abAI(IAI+NZ,1)\nM=M+1\nIF(AlMlX(I,J).EQ.l.DR.AIMiX(I+l,J).EQ.l) GO TO 103 A(KCL+LM+1)\u00abAI(IAI+NZ,2)\n103\tCONTINUE\nB(KK)\u00abFR(IK,1)\nC\nKK=KK+1\nKCL\u00abIA(KK)\nA(KCL)\u00abAI(IAI,4)\nM=1\nIF(J.EQ.NZ) GO TO 104\nLM=M\nA(KCL+LM)\u00abAI(IAI+1,3)\nM=M+1\nIF(AIM1X(I,J).EQ.l.OR.AIM1X(I,J+l).EQ.l) GO TO 104 A(KCL+LM+i)=AI(IAI+l,4)\nM=M+1\n104\tIF(J.EQ.l) GO TO 105\nLM\u00abM\nA(KCL+LM)*AI(IAI-1,3)\nM=M+1\nIF(AIM1X(I,J).EQ.l.OR.AIMIX\u00cdI,J-l).EQ.l) GO TO 105 A(KCL+LM+1)=AI(IAI-1,4)\nM=M+1\n105\tIF(I.EQ.l) GO TO 106\nLM=M\nA(KCL+LM)\u00abAI(IAI-NZ,3)\nM=M+1\nIF(AIM1X(I,J).EQ.l.OR.AIMIX(I-IJ).EQ.l) GO TO 106 A(KCL+LM+1)=AI(IAI-NZ,4)\nM-M+l\n106\tIF(I.EQ.NX) GO TO 107\nLM-M\nA(KCL+LM)\u00abAI(IAI+NZ,3)\nM=M+1\nIF(AIM1X(I,J).EQ.1.OR.AIM1X(I+1,J),EQ,1) GO TO 107\nA(KCL+LM+1)=AI(IAI+NZ,4)\n107\tCONTINUE\nB(KK)~FR(IK,2)\n4\n2\tCONTINUE\nKOR=Q\nKK=O\nDO 3 I \u00bb 1,NX\nDO 3 J = 1,NZ\nKK=KK+2\nIF(AIM1X(I,J).EQ.l) THEN\nKOR=KOR+1\nR(KOR)=KK\nC(KOR)=KK\nENDIF\n3\tCONTINUE\nI\nKK=O\nD04I= 1,NX\nDO 4 J = 1,NZ\nKK=KK+1\nIF(AIM1X(I,J).EQ.5) THEN\nK0R=K0R+l\nR(KOR)=KK\nC(KOR)=KK\nI\nKOR=KOR+1\nR(KOR>KK+1\nC(KOR)=KK+1\nKK-KK+1\nELSE\nKOR=KQR+1\nR(KOR)=KK\nC(KOR)~KK\nKK=KK+1\nENDIF\n4\tCONTINUE\nDO 5 I - 1,2*NX*NZ\nKOR-C(I)\nIC(KOR)~I\n5\tCONTINUE\nCALL NSPIV(N,IA,JA,AR,C,IC,X,ITEMP,RTEMP,IERR)\nIF(IERR.LE.O) THEN\nWRITE(*,*)\u2019IERR=\u2019,IERR\nSTOP\nEND IF\nRETURN\nEND"}]}}}