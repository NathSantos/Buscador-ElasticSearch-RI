{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.07538"}, {"@name": "filename", "#text": "12257_304790.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "PAULO RENATO DA COSTA MENDES\nCONTROLE AVANCADO DE UM SISTEMA DE SEPARACAo TRIFASICA E TRATAMENTO DE AGUA\nz\nFLORIANOPOLIS 2012\nUNIVERSIDADE FEDERAL DE SANTA CATARINA\nPROGRAMA DE P\u00d3S-GRADUACAo EM ENGENHARIA DE AUTOMACAO E SISTEMAS\nCONTROLE AVANCADO DE UM SISTEMA DE separacAo trifAsica E TRATAMENTO DE Agua\nDisserta\u00e7\u00e3o submetida \u00e0\nUniversidade Federal de Santa Catarina como parte dos requisitos para a obten\u00e7\u00e3o do grau de Mestre em Engenharia de Automa\u00e7ao e Sistemas.\nPAULO RENATO DA COSTA MENDES\nFlorian\u00f3polis, Mar\u00e7o de 2012.\nCataloga\u00e7\u00e3o na fonte pela Biblioteca Universit\u00e1ria da\nUniversidade Federal de Santa Catarina\nM538c Mendes, Paulo Renato da Costa\nControle avan\u00e7ado de um sistema de separa\u00e7\u00e3o trif\u00e1sica e tratamento de \u00e1gua [disserta\u00e7\u00e3o] / Paulo Renato da Costa Mendes ; orientador, J\u00falio Elias Normey-Rico. - Florian\u00f3polis, SC, 2012.\n159 p.: il., grafs., tabs.\nDisserta\u00e7\u00e3o (mestrado) - Universidade Federal de Santa Catarina, Centro Tecnol\u00f3gico. Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Automa\u00e7\u00e3o e Sistemas.\nInclui refer\u00eancias\n1. Engenharia de sistemas. 2. \u00c1gua - Purifica\u00e7\u00e3o. 3. Controle preditivo. 4. Amortecimento - (Mec\u00e2nica). I. Normey-Rico, J. E. (J\u00falio Elias). II. Universidade Federal de Santa Catarina. Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Automa\u00e7\u00e3o e Sistemas. III. T\u00edtulo.\nCDU 621.3-231.2(021)\nCONTROLE AVAN\u00c7ADO DE UM SISTEMA DE SEPARA\u00c7\u00c3O TRIFASICA E TRATAMENTO DE Agua\nPaulo Renato da Costa Mendes\n\u2018Esta Disserta\u00e7\u00e3o foi julgada adequada para a obten\u00e7\u00e3o do t\u00edtulo de Mestre em Engenharia de Automa\u00e7ao e Sistemas, \u00c1rea de Concentra\u00e7\u00e3o em Controle, Automa\u00e7\u00e3o e Sistemas, e aprovada em sua forma final pelo Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Automa\u00e7ao e Sistemas da Universidade Federal de Santa Catarina.'\nJulio Elias Normey-Ri\u00e7o, Dr. Orientador\nAgustinho Plucenio, Dr. Coorientador\nJos\u00e9 Eduardo Ribeiro Cury, Ph.D.\nCoordenador do Programa de P\u00e9s-Gradua\u00e7\u00e3o em Engenharia de Automa\u00e7\u00e3o e Sistemas\nBanca Examinadora:\nJulio Elias Normey-Ri\u00e7o, Dr. Presidente\nMario Cesar Mello Massa de Campos , Dr.\nDaniel Juan Pagano, Dr.\nRodrigo Ivan Goytia Mejia, Dr.\nO entusiasmo e a maior for\u00e7a da alma. Conserva-o e nunca te faltar\u00e1 poder para conseguires o que desejas. Napole\u00e3o Bonaparte v\nAGRADECIMENTOS\nAgrade\u00e7o...\nA minha fam\u00edlia que sempre me incentivou e me deu for\u00e7as em todos os momentos.\nAo meu orientador Julio Elias Normey-Rico pela orienta\u00e7\u00e3o, apoio, amizade e por sempre ter \u201d\u2018alguns minutinhos\u201d\u2019 para \u201d\u2018trocar uma id\u00e9ia\u201d\u2019.\nAo meu coorientador Agustinho Plucenio pelas dicas relevantes para a execuc\u00e3o deste trabalho.\nAo meu colega de pesquisa Rodrigo Le\u00e3o Carvalho pelo companheirismo ao longo do desenvolvimento deste trabalho.\nAos meus Amigos-Colegas-Conhecidos, que estiveram presentes em todos os momentos.\nResumo da Disserta\u00e7\u00e3o apresentada \u00e0 UFSC como parte dos requisitos necessarios para obten\u00e7\u00e3o do grau de Mestre em Engenharia de Automa\u00e7\u00e3o e Sistemas.\nCONTROLE AVAN\u00c7ADO DE UM SISTEMA DE SEPARA\u00c7\u00c3O TRIFASICA E TRATAMENTO DE Agua\nPaulo Renato da Costa Mendes\nMar\u00e7o/2012\nOrientador: Julio Elias Normey-Rico, Dr.\nArea de Concentra\u00e7\u00e3o: Controle, Automa\u00e7\u00e3o e Inform\u00e1tica Industrial\nPalavras-chave: Separa\u00e7\u00e3o Trif\u00e1sica, Tratamento de Agua, Controle Preditivo, Amortecimento de Perturba\u00e7\u00e3es Numero de P\u00e1ginas: xxviii + 131\nNesse trabalho s\u00e3ao abordadas t\u00e1ecnicas de controle pre-ditivo n\u00e3ao-linear aplicadas ao controle de um sistema de se-para\u00e7ca\u00e3o e tratamento de \u00e1agua da indu\u00e1stria do petr\u00e1oleo composto por um separador trif\u00e1asico e uma bateria de hidroci-clones. O separador trif\u00e1asico tem como fun\u00e7c\u00e3oes promover a separa\u00e7\u00e3o das tr\u00eas fases do fluido (\u00e1gua, oleo e gas) proveniente do reservat\u00e1orio de petr\u00e1oleo e amortecer as perturba\u00e7c\u00e3oes de carga atuando como tanque pulm\u00e3o. Na sa\u00edda de agua do separador se conecta uma bateria de hidrociclones que permitem extrair os res\u00e1duos de o\u00e1leo da \u00e1agua que \u00e1e recuperada no processo. Usualmente, os separadores industriais contam com tr\u00eaes controladores SISO PI, cada um relativo a uma das fases do fluido. A utiliza\u00e7\u00e3o desse esquema de controle, apesar de ser bastante comum na indu\u00e1stria, tem como principal desvantagem o fato de na\u00e3o amortecer as oscilac\u00e7\u00e3oes de carga. Um esquema utilizado pela Petrobras \u00e1e o controlador PI por bandas que apesar de utilizar t\u00e1ecnicas cl\u00e1assicas de controle monovari\u00e1avel proporciona um bom amortecimento das osci-la\u00e7c\u00e3oes de carga. O processo estudado \u00e1e multivari\u00e1avel e tem uma din\u00eaamica complexa, por isso s\u00e3ao estudados neste trabalho dois tipos de modelos de predi\u00e7c\u00e3ao na\u00e3o-lineares, sendo eles o modelo Hammerstein e um modelo fenomenologico simplificado do separador. Dois sistemas de controle foram desenvolvidos. O primeiro, multivari\u00e1avel, se baseia no controlador preditivo pratico, conhecido como PNMPC, desenvolvido em [33] e inclui diversas funcionalidades para melhorar o desempenho do sistema separador-hidrociclones. O segundo consiste de um conjunto de controladores PI com sintonia via MPC, o qual \u00e1 de grande simplicidade de implementac\u00e3o.\nForam realizados ensaios de simula\u00e7\u00e3o onde os controladores foram testados no controle do sistema integrado funcionando em regime permanente e sob a presen\u00e7ca de perturbac\u00e7\u00e3oes .\nAbstract of Dissertation presented to UFSC as a partial fulfillment of the requirements for the degree of Master in Automation and Systems Engineering.\nADVANCED CONTROL OF A THREE PHASE SEPARATION SYSTEM AND WATER TREATMENT\nPaulo Renato da Costa Mendes\nMar\u00e7o/2012\nAdvisor: Julio Elias Normey-Rico, Dr.\nArea of Concentration: Control, Automation and Industrial Informatics\nKeywords: Three-phase Separation, Water Treatment, Predictive Control, Disturbances Damping\nNumber of Pages: xxviii + 131\nThis work discusses techniques for nonlinear predictive control applied to the control of an oil industry separation system and water treatment which comprises a three-phase separator and a battery of hydrocyclones. The three phase separator function is to promote the three phases separation of the fluid from the oil reservoir (gas, oil and water) and act as a surge tank to attenuate load disturbances. A battery of hydrocyclones is connected to the separator water output to extract the residual oil in the water which is recovered in the process. Usually, industrial separators are controlled with three SISO PI controllers, each in one of fluid phases. This control scheme, though it is quite common in industry, has as main disadvantage that it does not damp load oscillations. A scheme used by Petrobras is the PI Band controller that uses monovariable classical techniques but provides a good damping of load oscillations. As the studied process is multiavariable and has quite complex dynamics, two types of non-linear prediction models are analyzed in this work, the Hammerstein model and a simplified phenomenological model of the separator. Using these models two control systems are developed and tuned. The first one is based on the algorith PNMPC (practical multivariable predictive controller) , developed in [33] and includes several features to improve the separator hydrocyclones system performance. The second one consists of a set of PI controllers tuned using a Zone MPC approach, which is simple to implement and use. Several simulations are presented to illustrate the use\nof the proposed controllers using a complete phenomenological model of the integrated system considering the operation in steady state and in the presence of disturbances.\nSum\u00e1rio\n1\tIntrodu\u00e7\u00e3o\t1\n1.1\tProcessamento Prim\u00e1rio de Petr\u00f3leo..................... 1\n1.2\tMotiva\u00e7\u00e3o.............................................. 3\n1.3\tObjetivos.............................................. 5\n1.4\tEstrutura da Disserta\u00e7\u00e3o............................... 6\n2\tModelo dos Processos\t7\n2.1\tCaracter\u00edsticas de Alimenta\u00e7\u00e3o do Separador Trif\u00e1sico\t....\t7\n2.2\tModelo Fenomenol\u00e1gico do Separador Trif\u00e1sico........... 9\n2.2.1\tEqua\u00e7\u00f5es dos Balan\u00e7os.............................. 11\n2.2.2\tCalculos Preliminares.............................. 15\n2.3\tModelo Fenomenologico do Hidrociclone................. 19\n2.3.1\tModelo do Escoamento .............................. 20\n2.3.2\tModelo da Efici\u00eancia............................... 23\n2.3.3\tModelo Hidrodin\u00eamico............................... 25\n2.4\tObjetivos de Controle..................................... 26\n2.4.1\tControle em Separadores ........................... 26\n2.4.2\tControle em hidrociclones.......................... 27\n2.4.3\tComentarios Finais................................. 28\n3\tControle Preditivo\t29\n3.1\tIntrodu\u00e7ao ao MPC (Model Predictive Control).......... 29\n3.1.1\tModelos de Predi\u00e7ao................................ 31\n3.1.2\tFun\u00e7ao Objetivo.................................... 32\n3.1.3\tC\u00e1lculo da Lei de Controle ........................ 33\n3.2\tPNMPC (MPC Pr\u00e1tico Para Sistemas N\u00e3o-Lineares)\t....\t33\n3.2.1\tObten\u00e7ao de F e Gpnmpc............................. 35\n3.2.2\tObten\u00e7ao da a\u00e7\u00e3o de controle....................... 37\n3.2.3\tTratamento de erro de predi\u00e7\u00e3o, ru\u00eddo e perturbac\u00e3o .\t38\n3.3\tControle NMPC com Restri\u00e7\u00e3es.............................. 39\n3.4\tControle NMPC por Zonas .................................. 43\n3.4.1\tComentarios Finais ................................ 44\n4\tIdentifica\u00e7\u00e3o e Modelos para Predi\u00e7\u00e3o\t45\n4.1\tModelo de Hammerstein....................................... 45\n4.2\tIdentifica\u00e7\u00e3o do Modelo de Hammerstein...................... 47\n4.2.1\tEstimador dos M\u00ednimos Quadrados...................... 47\n4.2.2\tProcedimento de Identifica\u00e7ao aplicado ao Separador\nTrif\u00e1sico............................................ 49\n4.3\tModelo Fenomenol\u00e1gico Simplificado.......................... 55\n4.4\tEstimador de Perturba\u00e7\u00e3es .................................. 56\n4.5\tPreditor de Perturba\u00e7\u00f5es.................................... 59\n4.6\tDetector de Perturba\u00e7\u00e3es.................................... 61\n4.6.1\tComentarios Finais................................... 64\n5\tResultados de Simula\u00e7\u00e3o\t65\n5.1\tControle do Separador Trif\u00e1sico com a\tpresen\u00e7a de Golfadas .\t65\n5.1.1\tEnsaio com PNMPC Hammerstein......................... 66\n5.1.2\tEnsaio com PNMPC Modelo Fenomenologico............... 69\n5.1.3\tEnsaio com Controlador por Bandas.................... 74\n5.1.4\tAn\u00e1lise de Desempenho dos Controladores.............. 75\n5.2\tControle do Separador Trif\u00e1sico com perturba\u00e7\u00e3es do tipo degrau 77\n5.2.1\tEnsaio com PNMPC Hammerstein......................... 78\n5.2.2\tEnsaio com PNMPC Modelo Fenomenol\u00e1gico............... 81\n5.2.3\tEnsaio com Controlador por Bandas.................... 85\n5.2.4\tAn\u00e1lise de Desempenho dos Controladores.............. 86\n5.3\tEnsaio com Controlador PI por Bandas e PNMPC Modelo\nFenomenol\u00e1gico por Zonas.................................... 88\n5.4\tControle do Sistema Integrado (Separador + Hidrociclone) . .\t92\n5.4.1\tComentarios Finais................................... 99\n6\tControlador PI com sintonia via MPC por Zonas\t101\n6.1\tFundamenta\u00e7\u00e3o Te\u00e1rica...................................... 101\n6.2\tEnsaio com PI com sintonia via MPC por Zonas............... 105\n6.3\tComentarios Finais......................................... 107\n7\tConclusao\t109\n7.1 Diretrizes para Trabalhos Futuros........................... 111\nA\tPar\u00e2metros de Simula\u00e7ao\t113\nB Lineariza\u00e7ao do\tModelo Simplificado do Separador\t117\nB.1\tLineariza\u00e7ao do Balanco\tde\tAgua no Separador............. 118\nB.2\tLinearizacao do Balanco\tde\t(Oleo no Separador............ 119\nB.3\tLinearizac\u00e7\u00e3ao do Balan\u00e7co\tde\tG\u00e1as no Separador ............ 120\nB.4 Modelo Linearizado ......................................... 121\nC\tControle PI por Bandas\t123\nNomenclat ura\nSeparador Trif\u00e1sico\nVari\u00e1vel\tDescri\u00e7\u00e3o\tUnidade\nB\tbase das placas paralelas\tm\nBSW\tconcentra\u00e7\u00e1o volumetrica de \u00e1gua na fase oleosa na alimenta\u00e7\u00e3o\tm /m\nCchic\tcomprimento da chicana\tm\nCd\tcomprimento da c\u00e2mara de \u00e1leo\tm\nCcs\tcomprimento da c\u00e2mara de separa\u00e7\u00e3o\tm\nCONClfwcs\tfrac\u00e3o volumetrica de \u00e1leo na fase aquosa da ca\u00e2mara de separa\u00e7c\u00e3ao\t33 m /m\nCplaca\tcomprimento das placas paralelas\tm\nCvmax, g\tcoeficiente de descarga m\u00e1ximo da va\u00e1lvula de ga\u00e1s\tKmols/Kgf /cm2\nCvmax, l\tcoeficiente de descarga m\u00e1aximo da\tKmols/Kgf\n\tva\u00e1lvula de \u00e1oleo\t/cm2\nCvmax, w\tcoeficiente de descarga m\u00e1aximo da\tKmols/Kgf\n\tva\u00e1lvula de \u00e1agua\t/cm2\nD\tdi\u00e2ametro do separador trif\u00e1asico\tm\ndg\tdensidade espec\u00e1fica do g\u00e1as\t-\ndl\tdensidade espec\u00e1fica do \u00e1oleo\t-\nDp\tdi\u00e2ametro da got\u00e1cula\tm\nDp50\tdia\u00e2metro correspondente a frac\u00e7\u00e3ao volum\u00e1etrica de 50%\tm\ndw\tdensidade espec\u00e1fica da \u00e1agua\t-\nEFLW\tefici\u00e2encia global de separa\u00e7c\u00e3ao do o\u00e1leo da fase aquosa\t-\nEFWL\tefici\u00e2encia global de separac\u00e7\u00e3ao do a\u00e1gua da fase oleosa\t-\ng\tacelerac\u00e7\u00e3ao da gravidade\tm/s2\nGin\tvazao de entrada da fase gasosa\tm3 /s\nGout\tvazao de sa\u00edda da fase gasosa\tm3 /s\nh\taltura maxima, na entrada das placas paralelas,\tm\nque garante a separa\u00e7\u00e3o das got\u00edculas\t\t\nhchic\taltura da chicana\tm\nhl\taltura da fase oleosa na c\u00e2mara de \u00f3leo\tm\nhplaca\tdist\u00e2ncia entre as placas paralelas\tm\nht\taltura total de l\u00edquido na c\u00e2mara de separa\u00e7\u00e3o\tm\nhw\taltura da fase aquosa na c\u00e2mara de separa\u00e7\u00e3o\tm\nK1\tcoeficiente de esfericidade das got\u00edculas\t-\nLin\tvaz\u00e3o de entrada da fase oleosa\tm3/s\nLout\tvaz\u00e3o de sa\u00edda da fase oleosa\tm3/s\nLweir\tvaz\u00e3ao na chicana\tm3/s\nMWg\tpeso molecular do g\u00edas\tkgf/m3\np\tpress\u00e3ao no separador\tkgf/cm2\npar\tpar\u00e2metro da distribui\u00e7\u00e3o sigmoidal\t-\npcomp\tpress\u00e3o da unidade de compressao, apos a v\u00f3lvula de g\u00edas\tkgf/cm2\npjus\tpressao a jusante das v\u00f3lvulas de oleo e agua\tkgf/cm2\nQ\tvaz\u00e3ao nas placas paralelas\tm3/s\nR\tConstante universal dos gases\t8, 31447 Jmol-1K -1\nsg\tFra\u00e7\u00e3o de abertura da v\u00f3lvula de g\u00f3s\t-\nsl\tFra\u00e7ao de abertura da v\u00f3lvula de \u00f3leo\t-\nsw\tFra\u00e7c\u00e3ao de abertura da v\u00edalvula de \u00edagua\t-\nT\ttemperatura da carga\tK\nTOG\tconcentra\u00e7c\u00e3ao volum\u00f3etrica de o\u00f3leo na fase aquosa na alimenta\u00e7ca\u00e3o\t33 m /m\nVcl\tvolume da ca\u00e2mara de \u00f3oleo\tm3\nVcs\tvolume da c\u00e2amara de separa\u00e7c\u00e3ao\tm3\nV fwcs\tvolume da fase aquosa da ca\u00e2mara de separa\u00e7c\u00e3ao\tm3\nVlfwcs\tvolume de o\u00f3leo na fase aquosa da c\u00e2amara de separa\u00e7c\u00e3ao\tm3\nvol\tvolume relativo ocupado pelas got\u00f3culas\t-\nVt\tvolume total do separador\tm3\nvter\tvelocidade terminal da got\u00f3cula\tm/s\nVwflcl\tvolume de \u00f3agua na fase oleosa da c\u00e2amara de \u00f3oleo\tm3\nVwflcs\tvolume de a\u00f3gua na fase oleosa da c\u00e2amara de separa\u00e7ca\u00e3o\tm3\nvx\tvelocidade da got\u00edcula na dire\u00e7\u00e3o x\tm/s\nWin\tvaza\u00e3o de entrada da fase aquosa\tm3/s\nW out\tvaza\u00e3o de sa\u00f3da da fase aquosa\tm3/s\nYi\tpeso especifico do oleo\tkgf/m3\nYw\tpeso especifico da agua\tkgf/m3\nn\teficiencia de coleta individual da goticula\t-\np\tviscosidade da fase continua\tkg/m/s\np\tmassa especifica da fase continua\tkg/m3\npd\tmassa especifica da fase dispersa\tkg/m3\npfw\tmassa especifica da fase aquosa\tkg/m3\npfl\tmassa especifica da fase oleosa\tkg/m3\npl\tmassa especifica do oleo\tkg/m3\npw\tmassa especifica da agua\tkg/m3\n\tesfericidade da goticula\t-\nHidrociclone\nVariavel a\nd\nCvmax, o\nCvmax, u\nDescri\u00e7\u00e3o\nraio do orif\u00edcio de sa\u00edda do rejeito oleoso di\u00e2metro das got\u00edculas de \u00f3leo coeficiente de descarga maximo da vaivula superior\ncoeficiente de descarga m\u00edaximo da v\u00edalvula inferior\nUnidade\nm\nm\nKmols/Kgf\n/cm2\nKmols/Kgf\n/cm2\ndl\tdensidade espec\u00edfica do \u00f3leo\ndw\tdensidade espec\u00edfica da \u00f3gua\nefic\tefici\u00e2ncia global de separac\u00e3o do hidrociclone\nf\tfator de rejeito\nfat\tfra\u00e7\u00e3o das got\u00edculas de di\u00e2metro \u201d\u2018d\u201d\u2019 separadas\nftr\tfator de perda na alimentac\u00e3o (inefici\u00e2ncias)\nL\taltura do trecho c\u00e2nico modelado\nP1\nPo\nPu q\nr\nRc\nrela\nso su\nUD\nV 0\nW\nWo\nWu\npress\u00e3o na alimenta\u00e7\u00e3o do hidrociclone press\u00e3o na descarga da linha superior pressao na descarga da linha inferior vazao de alimentacao do hidrociclone Coordenada do sistema de coordenadas esfericas composto das coordenadas (r, 0, X) raio interno do hidrociclone na secao de alimentacao (topo do trecho conico modelado) relacao entre a area dos orificios de alimentacao e a area transversal nominal abertura da valvula superior (topo) abertura da valvula superior (fundo) velocidade de migracao da goticula velocidade do fluido no bocal de alimentacao componente da velocidade perpendicular ao tampo, dirigida para o hidrociclone vazao na linha superior do hidrociclone vazao na linha inferior do hidrociclone\nm\nkgf/cm2\nkgf/cm2 kgf/cm2 m3/s\nm\nm\na\tsemi-angulo do trecho conico modelado\np\tmassa especifica do fluido (fase continua)\naiea2\tparametros de ajuste do modelo da perda de carga\nCoordenada do sistema de coordenadas esfericas composto das coordenadas (r, 0, X)\nm/s m/s m/s m3/s m3/s\nkg/m3\nAPo\n\u00c1Pu\ndiferen\u00e7a de pressao entre a corrente de alimentacao e a corrente de descarga superior do hidrociclone diferen\u00e7a de pressao entre a corrente de alimentacao e a corrente de descarga inferior do hidrociclone\nkgf/cm2\nkgf/cm2\nLista de Figuras\n1.1\tDistribui\u00e7\u00e3o dos fluidos Po\u00e7o x Superf\u00edcie. (Fonte: [8])\t. . . .\t2\n1.2\tPlanta offshore para tratamento de \u00e1gua. (Fonte: [8])\t....\t4\n2.1\tEvolu\u00e7\u00e3o de golfadas. (Fonte: [25]).............................. 8\n2.2\tSeparador trif\u00e1sico e seus dispositivos internos. (Fonte:\t[26]) .\t9\n2.3\tEsquema das variaveis envolvidas no separador trif\u00e1sico. ...\t11\n2.4\tSistemas gerados no interior do separador devido \u00e0 presen\u00e7a\nda chicana. (Fonte: [8])\t................................. 12\n2.5\tEsquema da trajet\u00e1ria da got\u00edcula nas placas paralelas.......... 18\n2.6\tEsquema de um hidrociclone vertical para \u00e1guas oleosas. (Fonte:\n[47])........................................................... 20\n2.7\tEsquema da parte c\u00f4nica do hidrociclone. (Fonte: [14]) ....\t21\n2.8\tEsquema da hidrodinamica do hidrociclone. (Fonte: [8]) ...\t25\n2.9\tEsquema do controle por DPR em hidrociclones. (Fonte: [8])\t27\n3.1\tDiagrama de Blocos do Algoritmo de Controle Preditivo Baseado em Modelo. (Fonte: [29]).............................. 30\n3.2\tDiagrama de Blocos para o tratamento do erro de modelagem\ne ru\u00e1do. (Fonte: [33]) ......................................... 38\n4.1\tModelo de Hammerstein..................................... 46\n4.2\tSinais PRBS .................................................... 49\n4.3\tExcita\u00e7c\u00e3ao em Malha Aberta\tdo sistema com\tsinais\tPRBS .\t.\t50\n4.4\tEnsaio\tde Identifica\u00e7\u00e3o e Validacao da \u00e1gua.................... 53\n4.5\tEnsaio\tde Identifica\u00e7\u00e3o e Valida\u00e7ao do \u00e1leo ................... 54\n4.6\tEnsaio\tde Identifica\u00e7c\u00e3ao e Valida\u00e7ca\u00e3o do ga\u00e1s ............... 54\n4.7\tVaz\u00e3es\tde Alimenta\u00e7\u00e3o Estimadas .............................. 58\n4.8\tVaz\u00e3es\tde Alimenta\u00e7\u00e3o Preditas................................ 60\n4.9\tJanela movel de n pontos\tde\tdados cerca\tdo\ttempo\tkth\t[15]\t.\t61\n4.10\tVaz\u00e3oes\tde a\u00e1gua e \u00e1oleo e vari\u00e1avel de detec\u00e7ca\u00e3o ............ 63\n4.11\tVaz\u00e3oes\tde a\u00e1gua e \u00e1oleo e vari\u00e1avel de detec\u00e7ca\u00e3o ............ 64\n5.1\tVari\u00e1veis de Processo..................................... 67\n5.2\tVazoes e alimentacao e sa\u00edda do separador.................... 67\n5.3\tVari\u00e1veis de Processo........................................ 68\n5.4\tVazoes e alimentacao e sa\u00e1da do separador.................... 69\n5.5\tEsquema de controle do PNMPC com controle local de vaz\u00e3o 70\n5.6\tVari\u00e1veis de Processo........................................ 71\n5.7\tVaz\u00e3es e alimentac\u00e3o e sa\u00e1da do separador.................... 72\n5.8\tVari\u00e1veis de Processo........................................ 73\n5.9\tVaz\u00e3es e alimentac\u00e3o e sa\u00e1da do separador.................... 73\n5.10\tVari\u00e1veis de Processo....................................... 74\n5.11\tVaz\u00e3es e alimentac\u00e3o e sa\u00e1da do separador................... 75\n5.12\tVari\u00e1veis de Processo....................................... 79\n5.13\tVaz\u00e3es e alimentac\u00e3o e sa\u00e1da do separador................... 79\n5.14\tVari\u00e1veis de Processo....................................... 80\n5.15\tVaz\u00e3es e alimentac\u00e3o e sa\u00e1da do separador................... 81\n5.16\tVari\u00e1veis de Processo....................................... 82\n5.17\tVazoes e alimentacao e sa\u00e1da do separador................... 83\n5.18\tVari\u00e1veis\tde Processo....................................... 84\n5.19\tVaz\u00e3es e alimentac\u00e3o e sa\u00e1da do separador................... 84\n5.20\tVari\u00e1veis\tde Processo....................................... 85\n5.21\tVaz\u00e3es e\talimentac\u00e3o\te\tsa\u00e1da do separador.................. 85\n5.22\tEsquema\tdo PNMPC\tcom\tcontrole\tsupervis\u00e1rio.............. 89\n5.23\tVari\u00e1veis\tde Processo....................................... 90\n5.24\tVaz\u00e3es e alimentacao e sa\u00e1da do separador................... 90\n5.25\tVari\u00e1veis\tde Processo....................................... 93\n5.26\tVaz\u00e3es e alimentac\u00e3o e sa\u00e1da do separador................... 93\n5.27\tEfici\u00eancias e concentra\u00e7\u00e3o de \u00e1leo no underflow do hidrociclone 94\n5.28\tDistribui\u00e7\u00e3o das gotas na sa\u00e1da do separador trif\u00e1sico ....\t95\n5.29\tVari\u00e1veis de Processo....................................... 96\n5.30\tVaz\u00e3es e alimentac\u00e3o e sa\u00e1da do separador................... 96\n5.31\tEfici\u00eancias e concentra\u00e7ao de \u00e1leo no underflow do hidrociclone 97\n5.32\tVari\u00e1veis de Processo....................................... 97\n5.33\tVaz\u00e3es e alimentac\u00e3o e sa\u00e1da do separador................... 98\n5.34\tEfici\u00eancias e concentra\u00e7\u00e3o de \u00e1leo no underflow do hidrociclone 98\n6.1\tVari\u00e1veis de Processo....................................... 106\n6.2\tVazoes e alimenta\u00e7\u00e3o e sa\u00e1da do separador................... 106\nLista de Tabelas\n4.1\tOrdem do modelo de Hammerstein para o\tn\u00edvel da \u00e1gua ...\t51\n4.2\tOrdem dos modelo de Hammerstein para\to n\u00edvel de oleo ...\t52\n4.3\tOrdem dos modelo de Hammerstein para\ta pressao..... 52\n4.4\tOrdem do modelo de Hammerstein final.................... 53\n4.5\tIndices de Desempenho .................................. 58\n4.6\tPerformance Indices..................................... 60\n5.1\tPar\u00e2metros de Ajuste do Controlador .................... 66\n5.2\tPar\u00e2metros de Ajuste do Controlador .................... 68\n5.3\tPar\u00e2metros de Ajuste do Controlador .................... 70\n5.4\tPar\u00e2metros de Ajuste do Controlador .................... 71\n5.5\tPar\u00e2metros de Ajuste do Controlador .................... 72\n5.6\tPar\u00e2metros de Ajuste do Controlador .................... 74\n5.7\tIndices de Desempenho .................................. 76\n5.8\tPar\u00e2metros de Ajuste do Controlador .................... 78\n5.9\tPar\u00e2metros de Ajuste do Controlador .................... 80\n5.10\tPar\u00e2metros de Ajuste do Controlador ................... 82\n5.11\tPar\u00e2metros de Ajuste do Controlador ................... 83\n5.12\tIndices de Desempenho ................................. 87\n5.13\tIndices de Desempenho - Golfadas....................... 91\n5.14\tIndices de Desempenho - Regime Permanente.............. 91\n6.1\tPar\u00e2metros de Ajuste do Controlador ................... 105\n6.2\tIndices de Desempenho ................................. 107\nCap\u00edtulo 1\nIntrodu\u00e7\u00e3o\n1.1\tProcessamento Prim\u00e1rio de Petr\u00f3leo\nA explora\u00e7\u00e3o de petr\u00f3leo \u00e9 um processo muito complexo que exige avan\u00e7ados equipamentos e tecnicas para a extra\u00e7ao dos fluidos das forma\u00e7\u00e3es geol\u00e9gicas. Um po\u00e7o de petr\u00e9leo \u00e9 criado, basicamente, perfurando-se a rocha at\u00e9 atingir o reservat\u00e9rio e em seguida introduzindo-se dutos para transportar o fluido at\u00e9e a superf\u00e9cie. A construc\u00e7\u00e3ao de um poco pode ocorrer em terra firme (onshore) ou sob lamina de agua (offshore).\nNo Brasil, grande parte da produ\u00e7ao de oleo e g\u00e9s vem da explo-racao de po\u00e7os localizados offshore. A exploracao nesses pocos exige a participa\u00e7c\u00e3ao de plataformas, que sa\u00e3o unidades de explora\u00e7ca\u00e3o e pr\u00e9e-processamento de o\u00e9leo e ga\u00e9s. A tecnologia de constru\u00e7c\u00e3ao de plataformas offshore \u00e9 bastante complexa, envolvendo varias areas da engenharia. Geralmente, a produ\u00e7\u00e3o de \u00f3leo se d\u00e9 atrav\u00e9s da explora\u00e7ao de v\u00e9rios po\u00e7os ligados a uma unidade de processamento (plataforma).\nBoa parte da complexidade dinamica do controle de processos offshore adv\u00e9em de instabilidades no escoamento de \u00e9oleo e ga\u00e9s provenientes dos pocos produtores de petr\u00e9leo. A geometria do arranjo linha-riser muitas vezes possibilita o acumulo da fase l\u00edquida na parte inferior impedindo a passagem do ga\u00e9s, o que acarreta no aparecimento das golfadas. Outro fator que pode intensificar as golfadas \u00e9 a utiliza\u00e7\u00e3o de m\u00e9etodos de eleva\u00e7c\u00e3ao artificial do fluido, como por exemplo o uso de gas-lift. Gas-lift \u00e9 uma entre as varias t\u00e9cnicas utilizadas para retirar hidrocarbonetos de forma artificial de poc\u00e7os onde a press\u00e3ao do reserva-t\u00e9orio \u00e9e insuficiente, ou economicamente invi\u00e9avel, para a explora\u00e7c\u00e3ao dos\nrecursos. O uso de um m\u00e9todo de eleva\u00e7\u00e3o artificial como o gas-lift se justifica pelo fato de que geralmente a press\u00e3o no fundo de po\u00e7o tem potencial para extra\u00e7\u00e3o de apenas 20 a 30% do total de \u00f3leo presente no reservat\u00f3rio, se n\u00e3o \u00f3 usado um metodo de elevac\u00e3o artificial.\nO escoamento com golfadas possui severas consequ\u00eancias para a opera\u00e7ao da plataforma de produ\u00e7ao [45]: (i) dificuldade de separa\u00e7ao da \u00f3gua e do oleo, comprometendo o desempenho de equipamentos ' jusante como tratadores de \u00f3leo e hidrociclones, e (ii) poss\u00edvel parada de emerg\u00eaencia da plataforma por n\u00f3vel muito alto dos vasos separadores.\nQuando os fluidos presentes nos reservat\u00f3rios de petr\u00f3leo s\u00e3o ex-tra\u00f3dos dos po\u00e7cos e levados at\u00f3e a superf\u00f3cie, eles ascendem em diferentes padr\u00e3es de escoamento e geralmente formam emuls\u00e3es. As emuls\u00e3es s\u00e3ao geradas pelo cisalhamento de misturas \u00f3agua-\u00f3oleo ao longo do escoamento do reservat\u00f3rio ate a planta de processo nas plataformas [28]. A Figura 1.1 mostra a mudanca de comportamento e de fase dos fluidos que saem dos reservat\u00f3orios e s\u00e3ao levados at\u00f3e a superf\u00f3cie.\nFigura 1.1: Distribui\u00e7ao dos fluidos Po\u00e7o x Superf\u00edcie. (Fonte: [8])\nSegundo [8], na superf\u00edcie, o \u00f3leo \u00e9 a parte dos hidrocarbonetos que permanece no estado l\u00edquido. O g\u00f3s produzido \u00e9 composto por tr\u00eas partes, sendo que a primeira \u00e9 proveniente dos hidrocarbonetos que, nas condi\u00e7\u00f5es de temperatura e press\u00e3o do reservat\u00f3rio, j\u00f3 se encontram no estado gasoso, chamado de g\u00f3s livre. A segunda parte \u00e9 oriunda dos hidrocarbonetos que se encontram dissolvidos no \u00f3oleo nas condi\u00e7co\u00e3es do reservat\u00f3orio e se vaporizam quando a mistura \u00f3e levada para as condi\u00e7c\u00e3oes de superf\u00f3cie. A terceira, e u\u00f3ltima parte, est\u00f3a relacionada com o g\u00f3as que se encontra dissolvido na a\u00f3gua nas condi\u00e7c\u00e3oes do reservato\u00f3rio, que normalmente \u00f3e desprez\u00f3vel.\nNa superf\u00edcie, a primeira etapa de tratamento desse fluido proveniente dos pocos \u00e9 chamada de tratamento prim\u00e1rio e pode ocorrer em v\u00e1rias etapas. Em sistemas de produc\u00e3o offshore (produ\u00e7\u00e3o mar\u00edtima) o tratamento prim\u00e1rio deve seguir as seguintes etapas:\n\u2022\tseparac\u00e3o do \u00e1leo, do g\u00e1s e da agua;\n\u2022\ttratamento ou condicionamento do \u00e1leo para que possa ser transferido para as refinarias onde \u00e9 realizado o processamento propriamente dito;\n\u2022\ttratamento da agua para reinje\u00e7\u00e3o no po\u00e7o ou descarte no mar.\nGeralmente, a primeira etapa do tratamento \u00e1 composta por um sistema de separa\u00e7c\u00e3ao trif\u00e1asico composto por um tanque com dimens\u00e3oes suficientes para absorver oscila\u00e7\u00f5es de carga. Um dos fatores cr\u00edticos do sistema de separa\u00e7c\u00e3ao trif\u00e1asico \u00e1e o tratamento da \u00e1agua para descarte. A legisla\u00e7\u00e3o ambiental exige que a \u00e1gua deve ter no m\u00e1ximo 20 ppms de \u00e1leo. Para alcan\u00e7ar esse valor, geralmente o sistema de tratamento da a\u00e1gua conta com hidrociclones conectados em s\u00e1erie ao separador tri-f\u00e1asico. Este equipamento efetua a separac\u00e7a\u00e3o do \u00e1oleo disperso na \u00e1agua pela a\u00e7c\u00e3ao de um campo centr\u00e1fugo gerado pelas suas caracter\u00e1sticas construtivas. Nessa configura\u00e7ca\u00e3o, o separador precisa atingir uma efici\u00eancia tal que a \u00e1gua de sa\u00e1da do tanque tenha ate 2000 ppms de \u00e1leo para que os hidrociclones e flotadores consigam diminuir esse valor para o exigido pela regulamenta\u00e7c\u00e3ao.\nNeste trabalho iremos considerar que o sistema de tratamento prim\u00e1ario do fluido tem como primeira etapa um sistema de separa\u00e7c\u00e3ao trif\u00e1asico conectado a uma bateria de hidrociclones para tratamento da \u00e1agua. Para essa configura\u00e7c\u00e3ao, devemos dar especial atenc\u00e7\u00e3ao ao amortecimento das oscila\u00e7c\u00e3oes na sa\u00e1da de \u00e1agua do separador pois os hidro-ciclones s\u00e3o equipamentos sens\u00e1veis \u00e0s pertubac\u00e3es. Ao mesmo tempo, esse aspecto n\u00e3ao \u00e1e t\u00e3ao preocupante para a sa\u00e1da de \u00e1oleo, j\u00e1a que em s\u00e1erie com esta existe um separador bif\u00e1asico que amortece as oscila\u00e7c\u00e3oes e entrega uma vaza\u00e3o constante ao tratador eletrosta\u00e1tico. E\u00e1 apresentado na figura 1.2 um esquema do processo estudado neste trabalho.\n1.2\tMotiva\u00e7ao\n->\nOs reservat\u00f3rios de petr\u00e1leo contam com fluidos em tres diferentes fases: g\u00e1s, oleo e \u00e1gua. Quando esse fluido chega a superf\u00edcie ele ascende na forma de emuls\u00e3oes e deve ser tratado por um sistema de\nFigura 1.2: Planta offshore para tratamento de \u00e1gua. (Fonte: [8])\ntratamento prim\u00e1rio que consiga separar com efici\u00eancia as tr\u00eas fases do fluido e tamb\u00e9m amortecer as oscila\u00e7\u00f5es de carga provenientes dos po\u00e7os, tamb\u00e9m conhecidas como golfadas.\nO tratamento prim\u00e9rio das emuls\u00f5es advindas dos po\u00e7os em plantas offshore ocorre em varias etapas e tem a finalidade de deixar o \u00e9oleo que ser\u00e9a transferido para as refinarias com baixo teor de impurezas e baixa concentra\u00e7\u00f5o de \u00e9gua, e deixar a agua para reinjecao nos po\u00e7cos ou descarte no mar com concentra\u00e7c\u00f5ao de \u00e9oleo dentro da faixa regulamentada pela legislac\u00f5o ambiental. Em um sistema convencional, o tratamento prim\u00e9rio \u00e9 composto de um conjunto de separadores gravitacionais conectados em s\u00e9erie e a primeira etapa do processo de separa\u00e7c\u00f5ao comec\u00e7a em um separador trif\u00e9asico.\nUsualmente, o controle de separadores trifasicos na industria \u00e9 realizado por tradicionais controladores SISO PI, cada um controlando uma das fases do fluido. Um exemplo de aplica\u00e7c\u00f5ao desta t\u00e9ecnica pode ser encontrado em [8]. Apesar dessa estrategia de controle ser a mais utilizada na industria, ela apresenta defici\u00eancias em rela\u00e7\u00f5o ao amortecimento de oscilac\u00e7\u00f5oes de carga e tamb\u00e9em por n\u00f5ao controlar a concen-trac\u00e7\u00f5ao dos fluidos na sa\u00e9da do separador.\nUma solu\u00e7c\u00f5ao mais apropriada para o separador visando o amortecimento das oscila\u00e7\u00f5es causadas pelas golfadas e apresentado em [27]. Neste trabalho se implementa uma estrat\u00e9gia de controle por bandas ainda baseada em controladores PI. As duas solu\u00e7c\u00f5oes anteriormente mencionadas utilizam t\u00e9ecnicas de controle SISO, a pesar de que o separador \u00e9 um sistema MIMO. Visando controlar o separador de forma\nMIMO e ao mesmo tempo conseguir tratar as restri\u00e7\u00f5es nas diferentes vari\u00e1veis envolvidas, alguns trabalhos da literatura tem proposto o uso de MPC ([26] e [40]).\nAs aplica\u00e7\u00f5es de controle citadas anteriormente s\u00e3o baseadas em m\u00e1todos lineares. E de amplo conhecimento que modelos lineares representam bem um processo em uma zona pr\u00e1xima a um ponto de equil\u00edbrio. As perturba\u00e7oes atuantes no processo provocam altera\u00e7\u00f5es no seu funcionamento, ocasionando oscila\u00e7co\u00f5es que tendem a afast\u00e1a-lo do ponto de opera\u00e7\u00e3o. Desta forma modelos n\u00e3o lineares podem representar de melhor forma o funcionamento do processo e permitindo um melhor desempenho dos controladores baseados nestes modelos. Algumas estrat\u00e1egias de controle voltadas ao amortecimento de oscilac\u00e7\u00e3oes preveem o funcionamento do separador em uma faixa de opera\u00e7ao ao inves de um ponto de equil\u00edbrio fixo.\nE\u00e1 abordado neste trabalho o uso de uma estrat\u00e1egia de controle preditivo nao linear com base em modelo de Hammerstein e modelos fenomenol\u00e1gicos simplificados. Para que haja um tratamento adequado \u00e0s golfadas e seja levada em considera\u00e7\u00e3o a efici\u00eancia do processo, esse trabalho tem como objetivo modelar dinamicamente o sistema e projetar um sistema de controle avan\u00e7cado que apresente melhores resultados que o sistema de controle tradicional no que diz respeito do atendimento das especifica\u00e7co\u00e3es de separa\u00e7c\u00e3ao.\n1.3\tObjetivos\nO objetivo deste trabalho \u00e1 contribuir para o desenvolvimento de um sistema de controle que amorte\u00e7a adequadamente oscilac\u00f5es de carga provenientes da opera\u00e7ao dos po\u00e7os e linhas de alimentac\u00e3o do separador, e ao mesmo tempo proporcione uma elevada eficiencia de separa\u00e7ca\u00e3o nos hidrociclones. Para tanto propo\u00e3e-se a utiliza\u00e7ca\u00e3o do controlador preditivo n\u00e3o linear desenvolvido em [33] . Sao utilizados como preditores modelos de Hammerstein e modelos fenomenol\u00e1ogicos simplificados. S\u00e3ao apresentadas ferramentas que possibilitam a estimac\u00e7\u00e3ao das perturba\u00e7c\u00e3oes atuantes no processo e a utiliza\u00e7ca\u00e3o dessas para realizar uma melhor predic\u00e7\u00e3ao e consequentemente um melhor ajuste do controlador.\n1.4\tEstrutura da Disserta\u00e7\u00e3o\n->\nARRUMAR ESTE PARAGRAFO INTRODUZINDO A PARTE DO PI VIA MPC\nNa sequ\u00eancia \u00e0 presente introdu\u00e7\u00e3o, s\u00e3o apresentados no cap\u00edtulo 2 os modelos fenomenol\u00f3gicos completos do separador trif\u00e1sico e do hi-drociclone, bem como seus objetivos de controle. No cap\u00edtulo 3, s\u00e3o apresentados os principais aspectos te\u00edoricos das estrat\u00edegias de controle utilizadas neste trabalho. Em seguida, no cap\u00edtulo 4, s\u00e3o abordadas t\u00e1cnicas de identifica\u00e7ao de sistemas nao lineares, a descricao dos modelos utilizados para a predi\u00e7\u00e3o e as ferramentas desenvolvidas para estimac\u00e3o e predi\u00e7ao das perturba\u00e7\u00e3es. No cap\u00edtulo 5, s\u00e3o apresentados e discutidos os resultados de simula\u00e7c\u00e3ao realizados primeiramente com o separador trif\u00edasico e posteriormente com o acoplamento da bateria de hidrociclones. Finalmente, no cap\u00edtulo 6, sao apresentadas as conclus\u00e3oes deste trabalho e sugest\u00e3oes para trabalhos futuros.\nCap\u00edtulo 2\nModelo dos Processos\nNa sequ\u00eancia ser\u00e3o apresentados os princ\u00edpios de funcionamento e modelos fenomenol\u00f3gicos do separador trif\u00e1sico e do hidrociclone. Outro assunto abordado neste cap\u00edtulo e a caracter\u00edstica da vaz\u00e3o dos fluidos na alimenta\u00e7\u00e3o do separador trif\u00e1sico e sua influ\u00eancia no processo de separa\u00e7\u00e3o. Finalmente ser\u00e3o apresentados os objetivos de controle dos processos.\n2.1\tCaracter\u00edsticas de Alimenta\u00e7\u00e3o do Separador Trif\u00e1sico\nA mistura que chega ao separador \u00e1 constitu\u00edda de fases dispersa de \u00e1leo em agua e agua em \u00e1leo, al\u00e1m do g\u00e1s. De acordo com [40] as quantidades de oleo em \u00e1gua e de agua em \u00e1leo nas emuls\u00e3es, e de g\u00e1s no fluxo de entrada do separador s\u00e3o definidas devido \u00e0s condicoes do(s) po\u00e7o(s) de onde est\u00e1 ocorrendo a extra\u00e7\u00e3o de petr\u00f3leo e das condi\u00e7\u00e3es de escoamento nos dutos, desde o(s) poco(s) at\u00e9 o separador.\nA condic\u00e7a\u00e3o do escoamento nos dutos \u00e1e respons\u00e1avel pela principal e mais preocupante perturba\u00e7ca\u00e3o na entrada do separador, o regime de golfadas severas (severe slugs) . Segundo [25], este regime \u00e1 caracterizado por uma instabilidade de fluxo que pode ocorrer a certas vaz\u00e3oes devido a um arranjo do conjunto linha-riser desfavor\u00e1avel, geralmente a baixas vazo\u00e3es em linhas relativamente longas.\nDe acordo com [10], essas oscila\u00e7\u00f5es provocam efeitos indesej\u00e1veis no processo de produ\u00e7\u00e3o, alterando os n\u00e1veis de fluido nos separadores, o que afeta a etapa de separa\u00e7c\u00e3ao e pode levar ao transbordamento.\nA oscila\u00e7\u00e3o da press\u00e3o, causa da oscila\u00e7\u00e3o das vaz\u00f5es, promove a diminui\u00e7\u00e3o da vida \u00fatil e o aumento da frequ\u00eancia de manuten\u00e7\u00e3o dos equipamentos de processo, podendo inclusive reduzir a produ\u00e7\u00e3o do po\u00e7o.\nE apresentado na figura 2.1 o comportamento c\u00edclico da golfada no riser que \u00fa dividido em quatro fases:\n\u2014\tGera\u00e7\u00e3o da Golfada - A golfada inicia-se com baixa press\u00e3o e velocidade dos fluidos na se\u00e7\u00e3o de alimenta\u00e7\u00e3o do encanamento, o liquido bloqueia o fluxo de g\u00fas no ponto-baixo do riser;\n\u2014\tProdu\u00e7\u00e3o da Golfada - Enquanto a quantidade de l\u00edquido no riser aumenta mais rapidamente que a variac\u00e7\u00e3ao da pressa\u00e3o entre o topo e a se\u00e7c\u00e3ao de alimenta\u00e7ca\u00e3o, a golfada continua crescendo;\n\u2014\tPenetra\u00e7\u00e3o da Bolha - Quando a pressao do gas na se\u00e7ao de alimenta\u00e7c\u00e3ao torna-se maior que o peso da coluna de l\u00faquido no riser, ocorre a explosao, ou seja, a quantidade de l\u00edquido acumulada \u00fae expelida para dentro do separador;\n\u2014\tProdu\u00e7\u00e3o de G\u00e1s - Ap\u00fas uma grande quantidade de gas e l\u00edquido deixarem o sistema, a pressa\u00e3o na sec\u00e7\u00e3ao de alimentac\u00e7\u00e3ao diminui, reiniciando o ciclo.\nFigura 2.1: Evolu\u00e7\u00e3o de golfadas. (Fonte: [25])\n2.2\tModelo Fenomenol\u00f3gico do Separador Trif\u00e1sico\nOs separadores trif\u00e1sicos s\u00e3o equipamentos pressurizados e utilizados no processamento prim\u00e1rio de petroleo, promovendo a separa\u00e7\u00e3o adequada das fases misturadas (\u00e1gua, \u00e1leo e g\u00e1s). Estes equipamentos tambem exercem a fun\u00e7\u00e3o de tanque pulm\u00e3o absorvendo as flutua\u00e7\u00e3es da carga devido as caracter\u00edsticas do escoamento multifasico advindo do reservat\u00e1rio (golfadas), e fornecendo para os equipamentos a jusante uma vaz\u00e3ao mais est\u00e1avel para na\u00e3o comprometer sua opera\u00e7c\u00e3ao.\nExistem v\u00e1arias concep\u00e7co\u00e3es de separadores com diferentes formas e tipos de dispositivos internos. Os separadores horizontais do tipo mostrado na Figura 2.2 sao os mais comuns e ser\u00e3o estudados nesse trabalho.\nFigura 2.2: Separador trif\u00e1sico e seus dispositivos internos. (Fonte: [26])\nDevido a consider\u00e1vel diferen\u00e7a de densidade entre as fases l\u00edquidas e gasosa, a separa\u00e7\u00e3o do g\u00e1s acontece de forma relativamente simples, bastando apenas uma dispersao inicial do fluido pelo emprego de dispositivos apropriados, seguido de um tempo de separa\u00e7\u00e3o adequado. A separa\u00e7\u00e3o da agua do oleo apresenta-se um pouco mais complexa, embora ambos sejam imisc\u00edveis, existe a formac\u00e3o de emulsao o que dificulta bastante a separac\u00e3o.\nNa entrada do separador pode-se notar a presen\u00e7a de uma placa defletora a qual e responsavel pela fragmenta\u00e7\u00e3o do fluido de alimenta\u00e7\u00e3o do tanque, facilitando, assim, a sa\u00edda do g\u00e1s e tamb\u00e1m aumentando o grau de dispers\u00e3o entre as fases. Apos se chocar com a placa defletora, oleo e \u00e1gua vao para a c\u00e2mara de separa\u00e7\u00e3o, onde ocorre parcialmente a separacao gravitacional entre os dois l\u00edquidos e o g\u00e1s \u00e1 expulso. De-\npendendo do tipo de \u00e1oleo pode ocorrer a forma\u00e7c\u00e3ao de espuma, geradora da dispersa\u00e3o de l\u00e1quidos na fase gasosa.\nAl\u00e1m das placas defletoras, v\u00e1rios outros dispositivos internos, apresentados na figura 2.2, s\u00e3ao utilizados para melhorar a efici\u00eaencia da separa\u00e7ao. Ligado \u00e0 parte superior do tanque est\u00e1 o eliminador de n\u00e1evoa, cuja fun\u00e7ca\u00e3o \u00e1e retirar da fase gasosa a dispers\u00e3ao de l\u00e1quido carregada pelo g\u00e1s. Na sa\u00e1da de gas vemos outro tipo de dispositivo interno utilizado com o mesmo objetivo. As placas paralelas, vistas na c\u00eaamara de separac\u00e7\u00e3ao, ajudam na coalesc\u00eaencia do \u00e1oleo presente na \u00e1agua e aumentam a efici\u00eancia de separa\u00e7\u00e3o l\u00edquido-l\u00edquido [25].\nAssim como qualquer outro processo, o processo de separac\u00e7\u00e3ao tambem conta com alguns problemas de operac\u00e3o. Segundo [47] os principais problemas encontrados sao:\n\u2014\tEspuma - as impurezas presentes no l\u00e1quido que chega no separador s\u00e3o as principais causadoras de espuma. Quando presente, ela dificulta o controle de n\u00e1vel do l\u00e1quido dentro do separador, ocupa um volume que poderia estar dispon\u00e1vel para a coleta de l\u00e1quido ou para decanta\u00e7c\u00e3ao, e pode ser arrastada pela corrente de g\u00e1as ou de \u00e1oleo desgaseificado. Portanto, quando for poss\u00e1vel prever a formac\u00e7\u00e3ao da espuma, o separador deve ser equipado com dispositivo interno para remov\u00eae-la, assegurando um tempo e uma superf\u00e1cie coalescedora suficientes para quebr\u00e1a-la.\n\u2014\tObstru\u00e7\u00e3o de parafinas - opera\u00e7\u00e3es de separa\u00e7\u00e3o podem ser afetadas por acu\u00e1mulo de parafina. As placas coalescedoras na se\u00e7c\u00e3ao l\u00e1quida e os extratores de n\u00e1evoa na sec\u00e7\u00e3ao gasosa s\u00e3ao particularmente suscept\u00e1veis a estas obstru\u00e7oes. Quando a parafina \u00e1 um problema real e potencial, extratores alternativos devem ser considerados e bocas de visitas e orif\u00e1cios devem ser providenciados para permitir a entrada de vapor ou solvente de limpeza dos elementos internos do separador.\n\u2014\tAreia - a areia que eventualmente chega com o l\u00e1quido no separador causa eros\u00e3ao nas va\u00e1lvulas, obstru\u00e7ca\u00e3o nos elementos internos e acumula-se no fundo do separador, de onde \u00e1e removida por jatos de a\u00e1gua e drenos. A melhor solu\u00e7c\u00e3ao do problema \u00e1e evitar a produc\u00e7a\u00e3o de areia dos reservat\u00e1orios.\n\u2014\tEmuls\u00f5es - a emuls\u00e3o que se forma na interface oleo/\u00e1gua pode ser particularmente problem\u00e1atica na opera\u00e7c\u00e3ao de um separador. Al\u00e1em de causar problemas com o controle de n\u00e1vel, o acu\u00e1mulo de emuls\u00e3ao diminui o tempo de retenc\u00e7\u00e3ao efetivo, resultando em\numa redu\u00e7\u00e3o na efici\u00eancia do processo. A adi\u00e7\u00e3o de calor ou de produtos qu\u00edmicos minimiza o acUmulo de emuls\u00e3o, por\u00e9m estes procedimentos s\u00e3o preferencialmente aplicados na fase de tratamento do \u00edoleo.\n\u2014 Arraste - este \u00e9 um problema t\u00edpico operacional. O arraste de \u00e9leo pela corrente de gas ocorre quando o n\u00edvel do l\u00edquido est\u00e9 muito alto, quando existe algum dano em algum componente interno, forma\u00e7ao de espuma, sa\u00edda de l\u00edquido obstru\u00edda, projeto impr\u00e9prio ou simplesmente porque o vaso est\u00ed operando com produ\u00e7\u00e3o superior do projeto. O arraste de gas pelo l\u00edquido pode ser um indicativo de n\u00edvel muito baixo de l\u00edquido ou falha no sistema de controle de n\u00edvel.\n2.2.1\tEqua\u00e7\u00f5es dos Balan\u00e7os\nE apresentado na figura 2.3 o esquema das vari\u00edveis envolvidas no processo e tamb\u00edm uma ideia f\u00edsica do que elas representam. A c\u00eamara situada entre a alimenta\u00e7\u00e3o do tanque e a sa\u00edda de \u00edgua ser\u00ed a partir daqui chamada de c\u00eaamara de separac\u00e7\u00e3ao. A c\u00eaamara que comporta a sa\u00edda de oleo ser\u00ed chamada de camara de \u00edleo e a barreira que separa as duas ca\u00eamaras sera\u00ed chamada de chicana.\nFigura 2.3: Esquema das vari\u00e1veis envolvidas no separador trif\u00e1sico.\nA modelagem do separador ser\u00e1 realizada baseada em algumas simplifica\u00e7\u00f5es e tem refer\u00eancia no trabalho [25] e [8]. Foram consideradas as seguintes hip\u00f3teses:\n\u2014 O n\u00edvel da camara de separac\u00f5o deve ser sempre maior que a altura da chicana;\n\u2014\tO n\u00edvel da fase oleosa na c\u00e2mara de \u00f3leo deve ser menor que a altura da chicana;\n\u2014\tDensidades das fases s\u00e3o consideradas iguais \u2014 nas condi\u00e7\u00f5es operacionais a densidade da agua \u00f3 965kg/cm3 e do oleo \u00f3 855kg/cm3, apresentando uma diferenca desprez\u00edvel para os calculos;\n\u2014\tS\u00e3o desprezados os efeitos t\u00f3rmicos;\n\u2014\tO separador \u00f3 do tipo horizontal;\n\u2014\tOs unicos dispositivos internos considerados sao as placas paralelas;\n\u2014\tN\u00e3o e considerada a influ\u00e2ncia dos agentes emulsificantes naturais do oleo;\n\u2014\tNao ha arraste l\u00edquido pela fase gasosa;\n\u2014\tNa\u00e3o h\u00f3a gerac\u00e7\u00e3ao de espuma;\n\u2014\tN\u00e3o sao consideradas as trocas de massa entre a fase l\u00edquida do \u00f3leo e a fase gasosa.\nDevido a presen\u00e7ca da chicana a modelagem do separador \u00f3e realizada considerando que o equipamento funciona em dois sistemas distintos, conforme pode ser visto na 2.4. No primeiro sistema tem-se dois vasos, a c\u00e2mara de separa\u00e7\u00e3o e a camara de \u00f3leo, onde o primeiro verte liquido no segundo; isso ocorre quando hi &lt;hchic. No segundo sistema temos um unico vaso, pois a chicana n\u00e3o mais influencia o escoamento; isso ocorre quando hl > hchic . A mudanca de um sistema para o outro somente influenciara\u00f3 a varia\u00e7ca\u00e3o temporal da altura total da c\u00e2amara de separa\u00e7c\u00e3ao e da altura da fase oleosa na c\u00e2amara de \u00f3oleo.\nSistema 1\t\t\t\tSistema 2\t\t\t\n\t\t|\tGout\t\t\t\tI\tGout\t\nGin\tr\t\t\tGin kj\t\t\t\nLin *\t\t\t\tLin \u25ba\t\t\t\nWin\tht\tI|\\\t\tWin\tht\t1.\th\tl\n\tu\thw|\t|hotV[hj\t\t\t\u201e\thw|\t\u2014Ihchic\t\n\t\t\"i \"\u00ed Wout Lout\t\t\t\t\u2022\u00ed \"I Wout Lout\t\nFigura 2.4: Sistemas gerados no interior do separador devido \u00e0 presen\u00e7a da chicana. (Fonte: [8])\nO modelo fenomenol\u00f3gico do separador trif\u00e1sico \u00e9 composto pelo conjunto de equac\u00f5es dos balan\u00e7os de massa na c\u00e2mara de separa\u00e7\u00e3o, c\u00e2mara de \u00f3leo e tamb\u00f3m no espaco ocupado pelo g\u00e1s, apresentadas a seguir.\nSistema 1:\n\u2014\tVaria\u00e7\u00e3o da altura total na c\u00e2mara de separa\u00e7\u00e3o\n+ Lin Lweir Wout\t(2 1)\n~dt _\t2 \u2022 Cc^h^(D \u2014 ht)\t(\t)\nonde\nWin - vazao de agua na alimentac\u00e3o Lin - vaz\u00e3o de oleo na alimentacao Lweir - vaz\u00e3o na chicana\nWout - vaz\u00e3o na sa\u00edda de agua\nCcs - comprimento da camara de separa\u00e7\u00e3o D - dia\u00e2metro do separador\n\u2014\tVaria\u00e7c\u00e3ao da altura da fase oleosa na ca\u00e2mara de \u00f3oleo\ndhl   Lweir Lout\n~dt _ 2 \u2022 Cc^kT~(^\u2014h)\t( . )\nonde\nLout - vaz\u00e3o na sa\u00edda de \u00f3leo\nCcl - comprimento da ca\u00e2mara de o\u00f3leo\nSistema 2:\n\u2014\tVaria\u00e7ao da altura total na c\u00e2mara de separa\u00e7\u00e3o\ndht   Win + Lin Lout Wout\t(2 3)\n~dt _ 2 \u2022 (Ccs + Cci)Vht \u2022 (D \u2014 ht)\t( . )\n\u2014\tVaria\u00e7ao da altura da fase oleosa na c\u00e2mara de oleo\ndhl\tdht\n- _\t-\t(2.4)\ndt\tdt\nEqua\u00e7\u00f5es comuns aos dois sistemas:\n\u2014\tVaria\u00e7c\u00e3ao da altura da fase aquosa na c\u00e2amara de separa\u00e7c\u00e3ao\ndhw _ Win \u2022 (1 - TOG \u2022 EFLW) - Wout + Lin \u2022 BSW \u2022 EFWL\ndt\t2 \u2022 Ccs^hw \u2022 (D - hw)\n(2.5) onde\nBSW - concentra\u00e7\u00e3o volum\u00e9trica de \u00e1gua na fase oleosa na alimenta\u00e7\u00e3o\nEFLW - efici\u00eancia global de separa\u00e7\u00e3o do \u00e1leo da fase aquosa EFWL - efici\u00eancia global de separa\u00e7\u00e3o da \u00e1gua da fase oleosa TOG - concentra\u00e7\u00e3o volumetrica de oleo na fase aquosa na ali-menta\u00e7c\u00e3ao\n\u2014 Varia\u00e7\u00e3o do volume de \u00e1gua na fase oleosa da c\u00eamara de separa\u00e7\u00e3o\ndVwflcs\ndt\n= Lin \u2022 BSW \u2022 (1 - EFWL) - Lweir \u2022 CONCwflcs\n(2.6)\nonde\nCONCwflcs - frac\u00e3o volum\u00e1trica de agua na fase oleosa da camara de separa\u00e7c\u00e3ao\n- Variac\u00e7a\u00e3o do volume de \u00e1oleo na fase aquosa da ca\u00eamara de separa\u00e7c\u00e3ao\ndVlfwcs\ndt\n= Win \u2022 TOG \u2022 (1 - EFWL) - Wout \u2022 CONClfwCS\n(2.7)\nonde\nCONCi fwcs - fra\u00e7ao volum\u00e1trica de \u00e1leo na fase aquosa da c\u00eamara de separa\u00e7c\u00e3ao\n- Variac\u00e3o do volume de \u00e1gua na fase oleosa da camara de \u00e1leo\ndVwflcl\ndt\nLweir \u2022 CONCwflcs - Lout \u2022 CONCwflcl\n(2.8)\nonde\nCONCwflcl - fra\u00e7\u00e3o volumetrica de agua na fase oleosa da camara de \u00e1oleo\n\u2014 Varia\u00e7\u00e3o da press\u00e3o no vaso\ndp __ (Gin +\tW-in\t+ Lin G out W'out\tLout)\t' p\t(2 9)\ndt _\tVt \u2014 Vcl \u2014 Vcs\t(\t)\nonde\nGin - vaz\u00e3o de gas na alimenta\u00e7\u00e3o\nGout - vaz\u00e3o na sa\u00edda de gas\nVcl - volume da camara de \u00f3leo\nVcs - volume da c\u00e2mara de separa\u00e7ao\nVt - volume total do separador\n2.2.2\tC\u00e1lculos Preliminares\nA seguir serao apresentadas as equa\u00e7\u00e3es estaticas utilizadas para o c\u00f3lculo das vaz\u00e3es de sa\u00edda e da chicana, volumes e concentra\u00e7\u00e3es presentes nas equa\u00e7\u00e3es din\u00e2micas apresentadas anteriormente.\n\u2014 Vaz\u00e3o da Chicana\nL\nweir \u2014\n110, 2046\n60\n[Cchic - o, 2 (ht - h\nchic\n)] ' (ht\thchic)\n1,5\n(2.10)\nonde\nCchic - comprimento da chicana hchic - altura da chicana\n- Volumes nas c\u00e2maras de separa\u00e7\u00e3o e de \u00f3leo\nCcs \u2022 D2\n4\nCci \u2022 D2\narccos\nsin\narccos\nsin\narccos\narccos\n(2.11)\n(2.12)\n0 - 2I)\n- Volume da fase gasosa\nVg = Vt - Vcs - Vcl\n(2.13)\n\u2014 Volume da fase aquosa na c\u00e2mara de separa\u00e7\u00e3o\n\u201e\tCcs \u25a0 D2\nV fwcs  \t.\n4\nhw\narccos 1 \u2014 2\u2014\nhw\n\u2014 sin arccos I 1 \u2014 2 \u2014 I\n\u25a0(*\u20142 '\u00ed)\n(2.14)\n\u2014 Concentra\u00e7\u00e3es\nCONf - (Vcf\t<*.*\u00ab\nCONCfwcs - VfL\t(2.16)\nVfwcs\nCONCwfici -\t(2.17)\nVcl\n\u2014 Densidades das fases aquosa e oleosa\nPfw \u2014 Pw(1 \u2014 CONCifwcs) + pi \u2022 CONCifWcs\t(2.18)\nPfi = Pi(1 \u2014 CONCwfics) + Pw \u2022 CONCwfics\t(2.19)\nonde\nPi - massa espec\u00edfica do oleo\nPw - massa espec\u00edfica do agua\n\u2014 Vazoes de sa\u00edda de \u00e1gua, \u00f3leo e g\u00e1s\nWout -\nCvmaxw \u25a0 sw \\7dw (p \u2014 pjus) + Yw \u25a0 hw + YI (ht \u2014 hw)\n0,0693 \u25a0 60 \u25a0 pfw\n(2.20)\nLout\nCVmaxl \u25a0 Sly/di(p \u2014 pjus) + Yl \u25a0 hl\n0, 0693 \u25a0 60 \u25a0 pfl\n(2.21)\nGout =\nCvmaxg ' sg\\/dg (p Paomp) ' (p + Paomp)\n(2.22)\n2,832-60-p-MWg\nRT\nonde\nCvmaxg - coeficiente de descarga m\u00e1ximo da v\u00e1lvula de g\u00e1s Cvmaxl - coeficiente de descarga maximo da vaivula de oleo Cvmaxw - coeficiente de descarga maximo da v\u00e1lvula de \u00e1gua dg - densidade espec\u00edfica do gas di - densidade espec\u00e1fica do \u00e1leo dw - densidade espec\u00e1fica do \u00e1agua MWg - peso molecular do g\u00e1s\nPcomp - pressao da unidade de compressao, apos a v\u00e1lvula de g\u00e1s Pjus - pressao a jusante das valvulas de \u00f3leo e \u00e1gua\nR - constante universal dos gases\nT - temperatura da carga\nYl - peso espec\u00e1fico do oleo\nYw - peso espec\u00e1fico da agua\n\u2014 Efici\u00eancia global de remo\u00e7ao de oleo da fase aquosa, EFLW (ou de agua da fase oleosa, EFWL)\nPara o calculo das efici\u00eancias de separa\u00e7\u00e3o, parte-se da conside-ra\u00e7ao de que h\u00e1 transfer\u00eancia de oleo da fase aquosa para oleosa, mas que n\u00e3o ocorre a transfer\u00eancia de oleo da fase oleosa para aquosa. A mesma considera\u00e7\u00e3o \u00e1 feita para \u00e1gua.\nA efici\u00eaencia \u00e1e calculada em func\u00e7\u00e3ao do processo de deposi\u00e7c\u00e3ao de got\u00e1culas na placa inferior (para gota de \u00e1gua), ou superior (para gota de oleo), quando a emuls\u00e3o passa entre duas placas paralelas, separadas pela dist\u00eancia hplaca. Na entrada proxima \u00e0s placas, as got\u00e1culas est\u00e3ao uniformemente dispersas no plano transversal ao escoamento, ou seja, todas as got\u00e1culas t\u00eaem a mesma probabilidade de se encontrar em qualquer ponto desse plano.\nParte-se da hip\u00f3tese que se uma got\u00e1cula de di\u00eametro Dp, que chega a entrada das placas numa dist\u00eancia h da placa em que vai se depositar, se deposita no final destas (comprimento Cplaca), todas as got\u00e1culas do mesmo dia\u00eametro que chegam numa dist\u00eaancia menor se depositam na placa e as que chegam numa maior n\u00e3ao se depositam, conforme esquematizado na figura 2.5.\nDe acordo com as formula\u00e7\u00e3es apresentadas em [25] e [8] a efici\u00eancia de separa\u00e7\u00e3o para uma got\u00e1cula de di\u00e2metro Dp \u00e9 dada pela seguinte equa\u00e7c\u00e3ao\nFigura 2.5: Esquema da trajet\u00f3ria da got\u00edcula nas placas paralelas.\n(D-) =6n2 - 4n3\n(2.23)\nD*\np\nonde Dp \u00e9 o di\u00e2metro de part\u00edcula cuja efici\u00eancia de separa\u00e7\u00e3o \u00e9\n50% (n = 0, 5), sendo calculado por\n9 \u2022 Q \u2022 p.\nD*\np\nK1 \u2022 B \u2022 Cpiaca \u2022 g \u2022 (pd\tP)\n(2.24)\nPode-se observar que a efici\u00eancia \u00e9 igual a 1 quando Dp = \\/2 \u2022 D*, ou seja, s\u00e3o got\u00edculas que chegam \u00e0 entrada das placas justamente na altura hpiaca. Isto quer dizer que para valores superiores a este valor de Dp, a efici\u00eancia de remoc\u00e3o individual \u00e9 igual a 1; got\u00edculas iguais ou maiores que \\/2 \u2022 D* sao separadas totalmente.\nA eficiencia global de separa\u00e7ao \u00e9 dada pela rela\u00e7\u00e3o entre o volume de got\u00edculas que \u00e9 coletado (vc) e o volume de got\u00edculas que entrou no sistema (ve)\n(2.25)\nVc ^global \u2014\ne\nO volume de got\u00edculas que entra (ve) \u00e9 dado pela soma dos volumes associados a cada diametro de got\u00edcula na distribui\u00e7\u00e3o de entrada. Foi utilizada a equa\u00e7\u00e3o 2.26 para descrever a distribui\u00e7ao do di\u00e2metro de gotas na entrada do separador trifasico, considerando que as got\u00edculas da emulsao est\u00e3o distribu\u00eddas de tal forma que o volume relativo ocupado por elas, ate o tamanho Dp, \u00e9 descrito por uma curva sigmoidal.\n(2.26)\nve (Dp)\t/ \u201e\t\\ par\nO volume de got\u00edculas coletado (vc) e dado pela soma dos volumes que entram para cada di\u00e2metro de got\u00edculas, multiplicados pelas\nefici\u00eancias individuais de coleta.\nvc (Dp) \u2014 ve (Dp) ' n (Dp)\n(2.27)\nA distribui\u00e7\u00e3o de tamanho das gotas de \u00f3leo na fase aquosa que sai do separador trifasico \u00e9 calculada por\nVs (Dp) \u2014 Ve (Dp) \u2022 [1 - n (Dp)]\n(2.28)\n2.3 Modelo Fenomenol\u00f3gico do Hidrociclone\nSegundo [40], originalmente os hidrociclones foram desenvolvidos para a separa\u00e7\u00e3o de s\u00f3lidos em l\u00edquidos e, ap\u00f3s v\u00e1rios estudos modifica\u00e7\u00f5es foram feitas para alcancar um equipamento semelhante para a separa\u00e7\u00e3o eficiente de l\u00edquidos. De acordo com [8], o hidrociclone para \u00e1guas oleosas \u00e1 um dos processos de separa\u00e7\u00e3o \u00f3leo/\u00e1gua mais utilizados pela industria do petr\u00f3leo atualmente, dado que \u00e1 importante utilizar equipamentos compactos capazes de atingir requisitos ambientais para descarte de seus efluentes.\nUm hidrociclone consiste em um tubo composto de trechos cil\u00e1n-dricos e c\u00eanicos justapostos, onde a entrada de um fluido, contendo uma fase dispersa de diferente densidade, \u00e1 feita tangencialmente \u00e0 se-\u00e7ca\u00e3o transversal do tubo, formando um fluxo axial e possibilitando um movimento de rota\u00e7c\u00e3ao do fluido ao redor do eixo do equipamento, chamado de v\u00e1rtice. Neste tipo de equipamento, o campo centr\u00edfugo \u00e1 da ordem de mil vezes maior que o campo gravitacional.\nO princ\u00e1pio de opera\u00e7\u00e3o deste tipo de equipamento consiste na entrada tangencial de \u00e1agua oleosa, sob press\u00e3ao, no trecho de maior di\u00eaametro do hidrociclone, sendo direcionada internamente, em fluxo espiral, em direc\u00e7\u00e3ao ao trecho de menor di\u00eaametro. O cont\u00e1nuo decr\u00e1es-cimo de di\u00eaametro faz com que este fluxo seja acelerado, gerando uma for\u00e7ca centr\u00e1fuga que for\u00e7ca o componente mais pesado (\u00e1agua) contra as paredes. O fluxo axial reverso ocorre, na parte central do equipamento, devido ao formato c\u00eaonico do hidrociclone e ao diferencial de pressa\u00e3o existente entre as paredes e o centro que se estabelece em consequ\u00eaencia do campo centr\u00edfugo, associado \u00e0 perda de intensidade do v\u00e1rtice ao longo do escoamento axial. A fase l\u00e1quida central que deixa o hidro-ciclone pela parte superior (topo), contendo o\u00e1leo em maior propor\u00e7c\u00e3ao, \u00e1e denominada rejeito. A sa\u00e1da de a\u00e1gua se localiza na parte inferior do equipamento (fundo), contendo uma certa quantidade de \u00e1leo residual. E ilustrado na figura 2.6 um exemplo esquem\u00e1tico do funcionamento\nde um hidrociclone para \u00e1guas oleosas.\nFigura 2.6: Esquema de um hidrociclone vertical para \u00e1guas oleosas. (Fonte: [47])\nDe acordo com [14], os principais fen\u00f4menos que caracterizam um hidrociclone s\u00e3o:\n\u2014\tCampo centr\u00edfugo intenso (da ordem de mil vezes maior que o gravitacional), gerado pela entrada tangencial e a conicidade;\n\u2014\tSegrega\u00e7\u00e3o das fases na se\u00e7\u00e3o transversal, promovida pela acelera\u00e7\u00e3o centr\u00edfuga devido a diferenca das massas espec\u00edficas entre as mesmas;\n\u2014\tFluxo axissim\u00e9trico longe da regi\u00e3o de entrada;\n\u2014\tFluxo reverso, por mudan\u00e7a do gradiente de press\u00e3o radial num certo ponto, nas proximidades do eixo, respons\u00edavel pela sa\u00edda no overflow da corrente de menor massa espec\u00edfica;\n\u2014\tNumero de Reynolds do escoamento muito elevado, anulando o efeito de viscosidade fora da camada limite;\n\u2014\tQuebra das got\u00edculas da fase dispersa;\n\u2014\tCoalesc\u00eancia das got\u00edculas da fase de menor massa espec\u00edfica.\n2.3.1\tModelo do Escoamento\nO modelo estatico para hidrociclones utilizado neste trabalho foi desenvolvido por [22] e amplamente difundido na literatura. Este modelo considera a parte c\u00eanica do hidrociclone, conforme a figura 2.7.\nApesar da figura 2.7 apenas mostrar uma entrada, por motivos de melhor visualizac\u00e7\u00e3ao, hidrociclones para \u00edagua oleosas apresentam dois\nFigura 2.7: Esquema da parte c\u00f4nica do hidrociclone. (Fonte: [14])\npontos de alimenta\u00e7\u00e3o diametralmente opostos, com o intuito de manter uma razo\u00e1vel simetria na entrada do equipamento. Esta simetria se faz necessaria para garantir que n\u00e3o haja uma regi\u00e3o de alta turbul\u00eancia na entrada do hidrociclone, evitando assim a quebra das got\u00e1culas de \u00e1leo a serem coletadas, que acarretariam numa diminui\u00e7\u00e3o da efici\u00eancia de separa\u00e7ao das mesmas.\nAs equa\u00e7\u00e3es de conservac\u00e3o de massa e da quantidade de movimento em coordenadas esfericas (r, 6, A) levam, ap\u00e1s algumas considera-c\u00e3es simplificadoras, a uma equa\u00e7\u00e3o diferencial em func\u00e3o da corrente,\n. sin(6) d / 1 \\ d\u00b1 = Vo2\t(\t)\ndr2 r2 d6 sin(6) d6 W\nAs linhas de corrente sao as trajet\u00f3rias do fluido ao longo do hidrociclone. O equacionamento acima, ap\u00e1s algumas considera\u00e7\u00f5es, resulta numa equacao para a velocidade tangencial qA,\npw qr d\td\nRdR ( \u25a0 qx) = dR\n1 d\nR dR\n(R\u2022qx)}\n(2.30)\nFazendo X = X(R) = RdR (R \u2022 qx), transforma-se essa equa\u00e7\u00e3o diferencial de segunda ordem em duas de primeira ordem. Sao elas:\nonde\ndX __ X pw qr\ndR\t/<\u201e\u25a0\ndqx _ X _qx\ndR\tR\nR\nqr (R, z) _ qr (R, z)-+ qg(R, z) cos\nz\nqz(R,z) _ qr(R,z)cos\nR qg (R,z) \u2014\n(2.31)\n(2.32)\n(2.33)\n(2.34)\nqr (R,z) _ 2Acos (+2B cos (In (g) + 2B -\t(2.35)\nqg(R,z) _ -2\nRR\nA + B ln\nzz\n(2.36)\nPara a determina\u00e7ao do movimento radial das got\u00edculas adota-se a equa\u00e7\u00e3o de Stokes\n\nvter\n1\nWw\n(pw\tpl)\n(2.37)\nR\nAs componentes axial e radial da velocidade das got\u00edculas s\u00e3o dadas por\ndz Vz _ dt\t(2.38)\ndR VR _ n\t(2.39)\nAssim, pode-se estabelecer uma equa\u00e7\u00e3o diferencial para a trajet\u00f3ria das got\u00edculas dentro do hidrociclone:\ndz _\tqz\ndR qr A vter\n(2.40)\n2.3.2\tModelo da Efici\u00eancia\nPrimeiramente ser\u00ed apresentado o modelo desenvolvido por [22]. Este modelo n\u00e3o leva em consideracao o fen\u00f4meno da quebra de gotas. Adota-se a hip\u00edtese que na se\u00e7\u00e3o de topo do trecho c\u00eanico modelado a entrada da dispers\u00e3o se faz na coroa circular R1 &lt;R &lt;Rc.\nAnalisando-se a trajet\u00f3ria da got\u00edcula de \u00edleo, tem-se que, se Rcrit > Rc entao todas as got\u00edculas de diametro Dp ser\u00e3o separadas no hidrociclone. Agora se Rcrit &lt;Rc deve-se analisar dois casos:\n\u2014 Se Rcrit &lt;Ri, para essas got\u00edculas de di\u00eametro Dp, a efici\u00eancia de separac\u00e3o \u00ed nula, pois, por hip\u00edtese, n\u00e3o h\u00ed fluxo na se\u00e7ao de topo para R &lt;R1. Assim, todas as got\u00edculas com esse diametro ser\u00e3o perdidas pelo underflow.\n\u2014 Se Rcrit > R\u00ed, nesse caso, para essas got\u00edculas de di\u00e2metro Dp, somente aquelas que, sa\u00edrem da se\u00e7\u00e3o de topo na regiao definida por R\u00ed &lt;R &lt;Rc ser\u00e3o separadas, e as que ficarem em Rcrit &lt;R &lt;Rc serao perdidas no underflow.\nConsidera-se por hip\u00f3tese que as got\u00e1culas de diametro Dp estejam uniformemente distribu\u00e1das no trecho R\u00ed &lt;R &lt;Rc, ou seja, em toda a \u00e1rea A\u00ed da sec\u00e3o do topo do hidrociclone, onde:\nA\u00ed = n (R - Rj)\t(2.41)\nA area da se\u00e7ao ocupada pelas got\u00edculas de di\u00e2metro Dp que serao separadas \u00e1e:\nA2 = n (RCrit - Rl)\n(2.42)\nA fra\u00e7ao de got\u00edculas de di\u00eametro Dp que \u00e9 separada \u00e9 definida por\nFat = Ar\nAi\n(Rcrit - R2\u00ed)\n(R2 - R2)\n(2.43)\nA efici\u00eancia de separa\u00e7ao do hidrociclone \u00ed calculada somando-se os volumes coletados de cada tamanho de got\u00edcula e dividindo-se pelo volume total de \u00f3leo que entra.\nefic _\nELiFat \u2022Fv(i) j=i Fv(i)\nonde\n(2.44)\n\u00ed0\n(RCrit-R2)\n|\t(R2-R?) \u2019\nse Rcrit &lt;R1\nse R1 &lt;Rcrit &lt;Rc\nse Rcrit > Rc\nO aumento de F (raz\u00e3o de split, porcentagem da vazao total Q que sai pelo orif\u00edcio de rejeito oleoso) deve ser considerado como um fator redutor da efici\u00eaencia, visto que, se por uma lado, ao aumentar-se F tem-se uma corrente de agua tratada com menor concentra\u00e7\u00e3o de oleo, tem-se tambem, por outro lado, uma menor vaza\u00e3o de agua tratada (= (1 \u2014 F)Q) e uma maior vaz\u00e3o de rejeito (= FQ). A efici\u00eancia absoluta da separa\u00e7c\u00e3ao, para a mesma vaz\u00e3ao e calculada por\neficabs = efic (1 \u2014 F)\t(2.45)\nDessa forma quando F tender a 1, o que significa que quase toda a vaz\u00e3o esta saindo pelo overflow, embora a efici\u00eancia global seja de 100%, a efici\u00eancia absoluta tenderia a zero.\nNo modelo fenomenologico, quanto maior a vaz\u00e3ao maior a efici\u00eancia de separac\u00e3o. Contudo, dados experimentais revelam que ha um ponto otimo a partir do qual a efici\u00eaencia cai com o aumento da vaza\u00e3o.\nFoi desenvolvido por [14] um modelo que leva em considera\u00e7\u00e3o o fen\u00eaomeno de quebra de gotas, definido pela seguinte equa\u00e7c\u00e3ao\nFvnovo(i) _ Fv(i) (1 \u2014 mWe'mod(i))\t(2.46)\nonde Wemod(i) e o numero de Weber modificado e calculado por\nWemod(i\nPcd(i)\n2y\n(-Q- \\\nnRc2\n(2.47)\nO modelo da quebra de gotas deve ser acoplado ao modelo de calculo das efici\u00eaencias de separac\u00e7\u00e3ao no ponto imediatamente anterior ao calculo da trajet\u00f3ria da got\u00edcula. Dessa forma, as gotas sao redistribu\u00eddas com as poss\u00edveis fra\u00e7\u00f5es volumetricas apos a quebra. Apos a obten\u00e7c\u00e3ao da trajetoria, calcula-se a efici\u00eaencia de separa\u00e7c\u00e3ao levando em conta o fen\u00eaomeno da quebra de gotas.\n2.3.3\tModelo Hidrodin\u00e2mico\nA modelagem desenvolvida por [22] permite admitir a n\u00e3o depend\u00eancia da efici\u00eancia em rela\u00e7ao a press\u00e3o interna no equipamento. No entanto, o conhecimento da perda de carga das linhas de topo e de fundo do hidrociclone e de fundamental import\u00eancia na determina\u00e7\u00e3o do sistema de controle de vazao do equipamento. E apresentado na figura 2.8 um esquema hidrodin\u00eamico do hidrociclone com as vari\u00e1veis envolvidas.\nPi q\nSu\nFigura 2.8: Esquema da hidrodin\u00e2mica do hidrociclone. (Fonte: [8])\nNeste trabalho foi utilizado o modelo desenvolvido por [8] que descreve a perda de carga em hidrociclones. O modelo e constitu\u00eddo pelas equa\u00e7c\u00e3oes a seguir\nAPO = ai \u2022 Wo\t(2.48)\nAPu = Q2 \u2022 Wu\n(2.49)\nAs vaz\u00e3oes de topo e de fundo sa\u00e3o calculadas atrav\u00e1es das equa\u00e7c\u00e3oes das v\u00e1alvulas\nCvmaxo ' So\\Jdl (P1\tAPo Po)\n0,0693 \u2022 60 \u2022 pfl\nWu =\nCv\nmaxu\nSu\tdw (Pi - APu - Pu)\n0,0693 \u2022 60 \u2022 pfw\n(2.51)\nSubstituindo as equa\u00e7\u00f5es 2.48 e 2.49 nas equa\u00e7\u00f5es 2.50, 2.51, obt\u00eaem-se equa\u00e7c\u00e3oes de segundo grau, que podem ser facilmente resol\nvidas para determina\u00e7\u00e3o das vaz\u00f5es de topo (Wo) e fundo (Wu).\nCom as vaz\u00e3es de sa\u00edda do hidrociclone determinadas, pode-se calcular a concentrac\u00e3o de oleo na sa\u00edda de agua do hidrociclone (CONCi,u), atrav\u00e9s da seguinte equa\u00e7\u00e3o:\nCONCi u = q ' CONClfwcs \u2022 (1 ~ efic)\t(2.52)\n\u2019\tq - Wo\n2.4\tObjetivos de Controle\n2.4.1\tControle em Separadores\nO separador trifasico apresenta tr\u00eas malhas de controle, press\u00e3o do vaso, n\u00edvel da fase oleosa e n\u00edvel da fase aquosa. As vari\u00e9veis manipuladas s\u00e3o as aberturas das v\u00e9lvulas de sa\u00edda de \u00e9gua, oleo e de g\u00e9s e as variaveis controladas s\u00e3o os n\u00edveis e a pressao. As perturba\u00e7oes atuantes no separador s\u00e3ao oriundas da evolu\u00e7c\u00e3ao do escoamento dos re-servatorios que alimentam o sistema de produ\u00e7\u00e3o. Dentre os regimes de escoamento, o mais prejudicial para o funcionamento do sistema de separa\u00e7ca\u00e3o, \u00ede o regime de golfadas severas.\nUsualmente, os controladores dos vasos de separa\u00e7ao contam com tres controladores SISO PI (proporcional e integral), cada um relativo a uma das fases do fluido. Um deles utiliza o valor de leitura da press\u00e3o dentro do separador e controla a abertura da v\u00edlvula de g\u00eds; o segundo controlador mede o n\u00edvel de \u00edoleo da c\u00eaamara de \u00edoleo e controla a abertura da v\u00edlvula de sa\u00edda e o ultimo controlador utiliza a leitura do n\u00edvel de \u00edagua da c\u00eaamara de separac\u00e7\u00e3ao e comanda a abertura da v\u00edalvula de sa\u00edda de \u00edagua.\nEsse esquema de controle \u00ed bastante comum na industria mas tem como principal desvantagem o fato de n\u00e3ao amortecer as oscilac\u00e7\u00e3oes de carga e n\u00e3ao possuir controle sobre as concentra\u00e7c\u00e3oes dos fluidos nas v\u00edal-vulas de sa\u00edda. Ao utilizar um controle que mant\u00edm os n\u00edveis das fases l\u00edquidas fixos em um determinado ponto, o sistema perde a capacidade de responder \u00e0s oscila\u00e7\u00f5es nas vaz\u00f5es de entrada, oferecendo baixa rejei\u00e7\u00e3o \u00e0s pertuba\u00e7\u00e3es e tambem n\u00e3o controla a efici\u00eancia da separac\u00e3o de cada fase.\nPara esses problemas, algumas solu\u00e7co\u00e3es alternativas podem ser adotadas, entre elas, adotar a varia\u00edvel controlada como sendo a con-centra\u00e7c\u00e3ao de \u00edoleo disperso na \u00edagua e a concentra\u00e7c\u00e3ao de \u00edagua dispersa no \u00edoleo ou mesmo fazer um controle por bandas permitindo certa os-cila\u00e7ao dos n\u00edveis dos fluidos. Neste contexto o melhor algoritmo de controle \u00ede aquele que consegue fazer com que o separador absorva as\nperturba\u00e7\u00f5es e obtenha uma elevada efici\u00eancia de separa\u00e7\u00e3o.\n2.4.2\tControle em hidrociclones\nA principal func\u00e3o do hidrociclone e separar o \u00f5leo presente na corrente aquosa de forma a ajustar os n\u00edveis de pureza (da agua a ser descartada) exigidos pelas normas. Este equipamento necessita de uma queda de press\u00e3o para promover a separa\u00e7ao das gotas de oleo da corrente aquosa. Os hidrociclones nao apresentam dinamica significativa, portanto sua modelagem e realizada considerando a opera\u00e7ao em estado quase estacionario. Segundo [8], o controle normalmente utilizado baseia-se na manutenc\u00e3o da razao de perdas de carga (DPR)\nP - po\nDPR = -------=-\t(2.53)\nP - Pu\tv\nPara o hidrociclone, a rela\u00e7ao entre as quedas de press\u00e3o da corrente de topo e de fundo, deve ser mantida constante, garantindo assim, uma melhor efici\u00eancia de separa\u00e7ao. A corrente a ser controlada e a de sa\u00edda de rejeito (WO) e a corrente secundaria e a de sa\u00edda da fase aquosa (WU). Esta estrategia de controle consiste em medir a queda de pressa\u00e3o da corrente secundaria e multiplica-la pela raza\u00e3o desejada, para obter a queda de pressao requerida na corrente de sa\u00edda de rejeito, ou seja, AP^P = R \u2022 AP^. A sa\u00edda do multiplicador e o valor desejado para o controlador de AP da corrente de rejeito. Como o APu varia, o valor desejado do controlador tambem varia, para manter a raz\u00e3ao R constante. E apresentado na figura 2.9 um esquema da estrategia de controle utilizando DPR.\nFigura 2.9: Esquema do controle por DPR em hidrociclones. (Fonte: [8])\n2.4.3\tComentarios Finais\nNeste cap\u00edtulo foram apresentados os princ\u00edpios de funcionamentos, modelos fenomenol\u00f3gicos e objetivos de controle do separador trif\u00e1sico e do hidrociclone. Estes modelos ser\u00e3o utilizados para a simula\u00e7\u00e3o dos processos nas simulac\u00e3es apresentadas no cap\u00edtulo 5. Com base nestes modelos, no cap\u00edtulo 4 ser\u00e3o apresentados modelos simplificados que ser\u00e3o utilizados em conjunto com controladores preditivos. No pr\u00f3ximo cap\u00edtulo ser\u00e1 realizada uma revis\u00e3o bibliogr\u00e1fica sobre MPC e t\u00edecnicas utilizadas para amortecimento de perturbac\u00e7\u00e3oes.\nCap\u00edtulo 3\nControle Preditivo\nNo cap\u00e1tulo 2 foram discutidos os princ\u00e1pios de funcionamentos e objetivos de controle do separador trif\u00e1asico e do hidrociclone. A seguir ser\u00e3ao apresentadas t\u00e1ecnicas de controle preditivo que ser\u00e3ao aplicadas a estes processos. Primeiramente ser\u00e1a realizada uma revisa\u00e3o bibliogr\u00e1afica sobre MPC e na sequencia apresentado a fundamentac\u00e3o teorica do controlador PNMPC. Posteriormente ser\u00e3o apresentadas tecnicas de controle NMPC com restric\u00e7\u00e3oes e por zonas que sa\u00e3o uteis em processos sujeitos a a\u00e7ca\u00e3o de perturba\u00e7co\u00e3es.\n3.1 Introdu\u00e7\u00e3o ao MPC (Model Predictive Control)\nA aplica\u00e7c\u00e3ao de MPC surgiu nas u\u00e1ltimas duas d\u00e1ecadas como uma poderosa e pra\u00e1tica t\u00e1ecnica de controle. Essa \u00e1e uma das poucas t\u00e1ecnicas avanc\u00e7adas de controle que tem alcan\u00e7cado impacto significante em sistemas de controle industriais. A principal raz\u00e3ao desse sucesso \u00e1e, talvez, a capacidade do MPC em lidar com as seguintes situa\u00e7\u00f5es: possibilidade de aplica\u00e7\u00e3o em sistemas SISO (uma entrada para uma sa\u00e1da) e MIMO (m\u00faltiplas entradas para multiplas sa\u00e1das), a realimenta\u00e7\u00e3o do sistema e o controle feedforward podem ser inclu\u00e1dos de forma direta na formula\u00e7\u00e3o do MPC, restri\u00e7\u00e3es de entrada e sa\u00e1das podem ser inclu\u00e1das na formula\u00e7\u00e3o da lei de controle atrav\u00e9s da otimiza\u00e7ao online e tamb\u00e9m ha a compensac\u00e3o intr\u00e1nseca de atrasos de transporte [24].\nPara dar uma visa\u00e3o histo\u00e1rica da ideia de utilizar a predic\u00e7\u00e3ao em sistemas de controle, os pr\u00e1oprios controladores PID j\u00e1a apresentam, de\ncerta forma, essa propriedade. A a\u00e7\u00e3o derivativa do cl\u00e1ssico controle PID utiliza uma forma de predi\u00e7ao atrav\u00e1s da a\u00e7\u00e3o derivativa expressa pelo termo \u2022 O preditor de Smith [42] utiliza uma forma de predi-\u00e7c\u00e3ao para a compensac\u00e7\u00e3ao do tempo morto. A id\u00e1eia \u00e1e simples e intuitiva. Conhecendo o comportamento do sistema (modelo entrada-sa\u00edda) \u00e1 poss\u00edvel determinar a sequ\u00eancia de a\u00e7\u00e3es de controle a serem tomadas no futuro de forma a seguir uma trajet\u00f3ria desejada com o m\u00ednimo esfor\u00e7o [33].\nO MPC n\u00e3o \u00e1 uma estrat\u00e1gia de controle espec\u00edfica, mas \u00e1 o nome dado a um conjunto muito grande de m\u00e1etodos de controle que foram desenvolvidos considerando algumas ideias comuns baseadas no conceito de predi\u00e7\u00e3o. Na Figura 3.1 mostra-se a estrutura geral de um MPC onde pode ser observado o funcionamento do algoritmo. A partir dos valores passados do controle e sa\u00e1da do processo as predic\u00e7\u00e3oes futuras s\u00e3ao calculadas por um modelo. O modelo de predic\u00e7\u00e3ao \u00e1e o elemento mais importante dentro do controlador, dado que ele deve ser capaz de representar adequadamente a din\u00eaamica do processo. A predi\u00e7ca\u00e3o da sa\u00e1da do processo pode ser separada em duas partes: a resposta livre que corresponde a predicao da sa\u00e1da quando a entrada \u00e1 igualada aos valores passados da entrada, e a outra, a resposta for\u00e7cada que corresponde as predicoes quando o controle \u00e1 igual zero. Com os valores das predi\u00e7co\u00e3es futuras, refer\u00eaencias futuras, restri\u00e7c\u00e3oes do processo e uma fun\u00e7c\u00e3ao objetivo, um m\u00e1odulo de otimizac\u00e7\u00e3ao calcula o sinal de controle a ser aplicado ao processo no pr\u00e1oximo passo. A finalidade da fun\u00e7c\u00e3ao objetivo \u00e1e minimizar o erro entre a previs\u00e3ao da sa\u00e1da e a refer\u00eaencia desejada penalizando o esfor\u00e7co de controle [2].\nFigura 3.1: Diagrama de Blocos do Algoritmo de Controle Preditivo Baseado em Modelo. (Fonte: [29])\nTodos os algoritmos de Controle Preditivo possuem alguns elementos em comum, s\u00e3o eles: o modelo de predi\u00e7\u00e3o, a fun\u00e7\u00e3o objetivo\ne um m\u00e9todo para a obten\u00e7\u00e3o da lei de controle. Os diferentes controladores encontrados na literatura se diferenciam na forma em que esses elementos s\u00e3o encontrados. A seguir ser\u00e3o apresentados de forma resumida os conceitos desses elementos que podem ser encontrados de forma mais detalhada em [2].\n3.1.1\tModelos de Predi\u00e7\u00e3o\nO modelo de predi\u00e7\u00e3o e composto pelo modelo do processo e pelo modelo das pertuba\u00e7\u00e3es e e o elemento mais importante em um algoritmo de controle preditivo. Como o MPC baseia todo seu calculo da lei de controle no modelo de predi\u00e7\u00e3o, todas as vantagens do uso de controle preditivo podem ser perdidas caso o modelo que esta sendo usado n\u00e3o seja fiel \u00e0 din\u00e2mica do processo.\nOs modelos lineares s\u00e3o os mais utilizados na pratica para representar o processo e podem ser de entrada sa\u00edda (resposta impulsiva, resposta ao degrau e func\u00e3o de transfer\u00e2ncia) ou de variaveis de estado. Os modelos de resposta impulsiva ou ao degrau s\u00e3ao bastante utilizados na pratica por oferecerem as seguintes vantagens: (a) s\u00e3o intuitivos e podem ser usados em plantas multivariaveis sem acrescentar complexidade; (b) quando identificados nao precisam de conhecimento a-priori do processo e (c) descrevem de maneira simples efeitos mais complexos da din\u00e2amica do processo como atrasos e comportamentos de fase na\u00e3o m\u00ednima. Por outro lado apresentam alguns inconvenientes: (a) n\u00e3o podem ser usados com plantas instaveis e (b) necessitam utilizar um grande numero de par\u00e2ametros para descrever o modelo, sobre tudo se o processo tiver um atraso grande [33].\nOs modelos representados por func\u00e7\u00e3oes de transfer\u00e2encia tem a vantagem de poderem ser usados em plantas instaveis e tambem de precisar de poucos par\u00e2ametros para descrever a dina\u00e2mica do processo. A desvantagem desse modelo e que quando o modelo for identificado a partir de ensaios experimentais e necessario conhecer a ordem dos polin\u00e2omios do numerador e denominador a priori.\nOs modelos de espac\u00e7o de estado podem ser usados tanto para processos nao-lineares quanto para processos multivariaveis. Sua desvantagem e a dificuldade na visualiza\u00e7ao do sistema, uma vez que geralmente muitos estados n\u00e3o possuem significado f\u00edsico.\nOs modelos n\u00e3ao lineares s\u00e3ao geralmente usados para descrever a din\u00e2amica do processo quando os modelos lineares na\u00e3o geram bons resultados. Modelos fenomenologicos [9], emp\u00edricos [23], redes neurais [44] ou logica nebulosa [41] podem ser usados em algumas aplica\u00e7\u00f5es\npara determinar o modelo de predicao. O inconveniente no uso destes modelos \u00e9 a maior complexidade tanto no procedimento de obten\u00e7\u00e3o do modelo do processo quanto no c\u00e9lculo da lei de controle [33].\nPara representar perturbac\u00e3es determin\u00edsticas e estoc\u00e9sticas o modelo mais usado \u00e9e conhecido como modelo autorregressivo integrado de m\u00e9dia m\u00e9vel (Auto-Regressive and Integrated Moving Average, ARIMA). Este modelo permite representar mudan\u00e7as aleatorias, off-sets (desvios) e outros fen\u00f4menos normalmente encontrados no meio industrial.\n3.1.2\tFun\u00e7\u00e3o Objetivo\nEntre os diversos algoritmos MPC existem diferentes formas de calcular a lei de controle, cada uma considerando uma forma de descrever as fun\u00e7\u00e3es de custo, sendo que o objetivo mais utilizado \u00e9 minimizar o erro entre a sa\u00edda futura y e a refer\u00eancia desejada w penalizando o esfor\u00e7o de controle Au.\nA express\u00e3ao geral para a fun\u00e7c\u00e3ao objetivo \u00e9e mostrada na equa\u00e7c\u00e3ao 3.1.\nN2\tNu\nJ(NbN2,Nu) = \u00a3 S(j)[y(t + j|t) -u(t+j)]2 +2X(t)[Au(t + j - 1)]2 Ni\tj=1\n(3.1) Em que N1 e N2 s\u00e3o os horizontes de predi\u00e7ao m\u00ednimo e maximo enquanto Nu \u00e9 o horizonte de controle. Esses \u00edndices definem os instantes em que deseja-se que a refer\u00eaencia siga a sa\u00e9da e onde \u00e9e importante limitar a a\u00e7ca\u00e3o de controle. Esses horizontes podem ser usados para compensar atrasos de transporte e fase n\u00e3o-m\u00e9nima. Nos casos com atraso de transporte d, deve-se escolher N1 > d pois nao havera resposta do sistema a um sinal de entrada u(t) antes de t = d. Em casos onde o processo n\u00e3o possui atraso de transporte utiliza-se N1 = 1 e N2 = N, onde N passa a ser o horizonte de predi\u00e7ca\u00e3o. A variac\u00e7a\u00e3o de Nu permite penalizar por mais ou menos tempo a ac\u00e7\u00e3ao de controle. Os coeficientes \u00f4(t) e A(t) s\u00e3o as sequencias de pondera\u00e7ao do erro e do esfor\u00e7co de controle e geralmente s\u00e3ao escolhidas constantes ou exponenciais, dependendo se queremos considerar mais instantes iniciais ou finais da resposta.\nEm alguns sistemas \u00e9e poss\u00e9vel conhecer valores futuros da refe-r\u00eaencia, para esses sistemas o MPC pode utilizar esses dados para fazer o calculo da lei de controle e permitir que o sistema atinja mais rapidamente o novo valor desejado. Os valores de w(t + j) utilizados na\nfun\u00e7\u00e3o objetivo n\u00e3o s\u00e3o necessariamente coincidentes com a refer\u00eancia real do sistema. Normalmente, nas aplica\u00e7\u00e3es pr\u00e1ticas, s\u00e3o utilizadas estrat\u00e9gias para suavizar as mudancas de refer\u00eancia, de forma similar aos filtros utilizados nas estruturas cl\u00e1ssicas de controle com dois graus de liberdade.\nE poss\u00edvel ainda estabelecer restri\u00e7\u00e3es para o algoritmo de mi-nimiza\u00e7\u00e3o. Como todo sistema real possui restri\u00e7\u00e3es das vari\u00e1veis a controlar (n\u00edveis m\u00e1ximos, press\u00e3o limite, etc.) e das vari\u00e1veis de controle (saturac\u00e3o de v\u00e1lvulas, pot\u00eancia de motores, limites de curso, etc.) esta caracter\u00edstica se mostra uma das mais interessantes da aplica\u00e7\u00e3o do MPC.\n3.1.3\tC\u00e1lculo da Lei de Controle\nPara o c\u00e1lculo de Au(t + k|t) alguns passos devem ser seguidos:\n1.\tC\u00e1lculo do valor de y(t + k) como fun\u00e7\u00e3o dos controles futuros;\n2.\tSubstituic\u00e3o dos valores de y e w na func\u00e3o J;\n3.\tMinimiza\u00e7ao da fun\u00e7\u00e3o J considerando-se os pesos e as restric\u00f5es, se existirem.\nO resultado \u00e9 uma sequ\u00eancia de a\u00e7\u00e3es de controle que devem ser aplicadas ao sistema para se alcancar os objetivos definidos. E importante ressaltar o conceito de janela deslizante. A janela de controle \u00e1 deslizante, ou seja, apesar da minimiza\u00e7c\u00e3ao da fun\u00e7c\u00e3ao objetivo resultar em um vetor de controles que devem ser aplicados no tempo, na amostra seguinte ao c\u00e1alculo apenas a primeira ac\u00e7\u00e3ao de controle ser\u00e1a aplicada e todas as a\u00e7c\u00e3oes de controle ser\u00e3ao recalculadas de acordo com as novas informa\u00e7c\u00e3oes obtidas do sistema real.\n3.2\tPNMPC (MPC Pratico Para Sistemas N\u00e3o-Lineares)\nO controle PNMPC desenvolvido em [33], \u00e1 baseado em algoritmos de controle preditivo que utilizam a representa\u00e7c\u00e3ao do vetor de predicoes ao longo do horizonte p, Y, como uma fun\u00e7\u00e3o do vetor com m mudan\u00e7as na a\u00e7ao de controle Au, conforme a equa\u00e7ao 3.2.\nNo DMC as sa\u00eddas da planta sao calculadas baseadas na resposta ao degrau unit\u00e1rio de cada entrada. Para um sistema de uma entrada e uma sa\u00edda estavel e linear a sa\u00edda pode ser descrita como na equa\u00e7\u00e3o\n3.3.\ny(k) =\tgiAu(k - 1) + n(k),\t(3.3)\ni=1\nonde gi s\u00e3o os elementos do vetor resposta ao degrau unitario na entrada e n s\u00e3o erros de modelagem ou perturbac\u00e3es futuras.\nA predi\u00e7\u00e3o da sa\u00edda no instante t no DMC pode ser descrita como nas equa\u00e7\u00f5es 3.4 e 3.5, considerando que os erros de predi\u00e7\u00f5es n(k + j\\k) s\u00e3ao todas iguais ao instante k, ou n(k).\ny(k + j\\k) =\tgi^u(k + j - i) + f (k + j),\t(3.4)\ni=1\nonde f (k + j) pode ser descrito como a equa\u00e7\u00e3o 3.5, truncando o somat\u00f3rio em N amostras ja que 3 N tal que gN+1 \u00ab gN.\nN\nf (k + j) = ym(k) + ^2(gj+i - gi)Au(k - 1),\t(3.5)\ni=1\nonde ym(k) e o valor da sa\u00edda real no instante k.\nO primeiro termo da equa\u00e7\u00e3o 3.4 e conhecido como resposta for\u00e7ada porque representa a mudan\u00e7a do processo devido \u00e0s mudancas nas a\u00e7co\u00e3es de controle futuras enquanto o segundo termo e conhecido como resposta livre, pois representa a sa\u00edda do processo devido as entradas que ocorreram ate o per\u00edodo de amostragem passado.\nEscrevendo-se a equa\u00e7ao 3.4 expandida, considerando-se o horizonte de controle Nu e o horizonte de predicao p tem-se a expressao 3.6, que pode ser reescrita como em 3.2:\ny(k + 1\\k)\t=\tg1Au(k)\t+ f (k + 1)\ny(k + 2\\k)\t=\tgzAu(k)\t+ g1Au(k + 1)\t+\tf (k + 2)\ny(k + 3\\k)\t=\tg3Au(k)\t+ g3Au(k + 1)\t+\tg1Au(k +\t2) + f (k\t+ 3)\ny(k + N\\k) = gNAu(k) + gN-1Au(k + 1) + ... + g*-N + 1Au(k + Nu - 1) + f (k + m)\t(3.6)\nA t\u00e1cnica PNMPC desenvolvida em [33], segue a mesma logica do DMC, mas por ser uma t\u00e1cnica n\u00e3o-linear ela deve atender algumas peculiaridades. Em modelos lineares \u00e1 possivel calcular Y de forma simples, utilizando o princ\u00edpio da superposi\u00e7ao, o que n\u00e3o n\u00e3o acontece para modelos na\u00e3o lineares em que \u00e1e necess\u00e1ario a obten\u00e7ca\u00e3o de uma aproximacao para Y.\nA t\u00e1cnica proposta por [33] se difere das demais t\u00e1cnicas NMPC principalmente pelo fato de utilizar modelos linearizados independentes dos pontos de equil\u00edbrio do sistema. E proposto uma forma de descrever a evolu\u00e7\u00e3o das sa\u00e1das do sistema ao longo do horizonte de predi\u00e7\u00e3o utilizando uma representa\u00e7\u00e3o linear das sa\u00e1das em rela\u00e7\u00e3o aos incrementos de controle futuros. Para isto n\u00e3ao se utiliza o conceito de\nponto de equil\u00edbrio, assumindo-se que as predi\u00e7\u00f5es Yp dependem apenas\n\u2014\u2014\t\u2014\u2014\ndas entradas passadas u, das sa\u00e1das passadas y e dos incrementos de\nentradas futuros Au,\n\u2014\u2014 Yp = f (y, u, Au)\t(3.7)\nO Vetor com as predi\u00e7\u00e3es \u00e1 reescrito como\t\nYp = F + Gpnmpc Au\t(3.8)\nonde\t\nf = f (y,\u2014)\t(3.9)\nG\tdYp GPNMPC = d Au\t(3.10)\nA matriz GpNMPC \u00e9 o Jacobiano de Yp. Esta representa\u00e7\u00e3o pode ser utilizada tanto para sistemas representados por modelos lineares como para aqueles representados por modelos n\u00e3o lineares desde que as sa\u00e9das sejam cont\u00e9nuos e diferenciaveis em rela\u00e7\u00e3o \u00e0s entradas.\n3.2.1\tObten\u00e7\u00e3o de F e Gpnmpc\nNo controlador PNMPC o vetor de resposta livre F e a matriz G s\u00e3o obtidos de forma numerica. Para isso executa-se um algoritmo que calcule o vetor com as p predi\u00e7\u00f5es Yp quando se fornece os valores das entradas e sa\u00e1das passadas e o vetor com os m incrementos de entrada futura Au. Se denominarmos o conjunto de entradas passadas de upassado e as entradas atuais e passadas de ypassado ent\u00e3o as predi\u00e7\u00e3es podem ser reescritas como na express\u00e3ao 3.11.\ny(k + 1)\t\u2014 f (y passado,upassado, Au(k))\ny(k + 2)\t\u2014 f (ypassado,upassado, Au(k), Au(k A 1))\ny(k + N)\tf (y passado, upassado, Au(k), Au(k A 1), . . . ,\nAu(k + Nu - 1))\t(3.11)\nPara um sistema SISO, por exemplo, a cada iterac\u00e3o executa-se o seguinte procedimento:\n1. Obt\u00e1m-se o vetor (dimens\u00e3o N x 1) executando o modelo com as entradas e sa\u00e1das passadas e com Au =[0 0 ... 0]T. F = Y\u00ae.\n2.\nCalcula-se a primeira coluna da matriz Gpnmpc \u2022 Obt\u00e1m-se o vetor Yp (dimensao N x 1) executando o modelo com as entradas\ne sa\u00e1das passadas e com Au = [e 0 ... 0]T, onde e \u00e1 um valor muito pequeno, , por exemplo. Gpnmpc(:, 1) = p e p .\n3. Calcula-se a segunda coluna da matriz Gpnmpc. Obtem-se o vetor Yp (dimensao N x 1) executando o modelo com as entradas e sa\u00e1das passadas e com Au = [0 e ... 0]T. Gpnmpc (:, 2) = Y 2_____y o\n__p __p\ne '\n4.\tProssegue-se com o c\u00e1lculo das demais colunas da matriz Gpnmpc at\u00e1 a ultima coluna onde obt\u00e1m-se o vetor Ym executando o modelo com as entradas e sa\u00eddas passadas e com Au =[0 0 ... e]T.\nY m_Y 0\nGpnmpc(:,m) = p e p .\nPara a aplica\u00e7\u00e3o da t\u00e1cnica PNMPC em sistemas multivari\u00e1veis \u00e1e necess\u00e1ario montar os vetores de predi\u00e7c\u00e3ao e incrementos de a\u00e7c\u00e3ao de controle aumentados. Assim, para um sistema de ne entradas e ns sa\u00e1das ter\u00e1amos os seguintes vetores.\nYp\nAu\n[AuiAu2... Aune]T\n(3.12)\nA obten\u00e7\u00e3o de F e Gpnmpc acontece da mesma forma como descrito anteriormente. A diferenca \u00e9 que agora a matriz Gpnmpc\npassa a ter ne x ns blocos calculados como no caso SISO para cada par de entrada e sa\u00edda.\n3.2.2\tObten\u00e7\u00e3o da a\u00e7\u00e3o de controle\nA a\u00e7\u00e3o de controle visa cumprir o objetivo geral de um MPC, que \u00e9 fazer com que a sa\u00edda futura y siga um determinado sinal de referencia w em um determinado horizonte e, ao mesmo tempo, o esfor\u00e7o de controle necessario Au para faz\u00ea-lo deve ser penalizado. A express\u00e3o geral para cumprir esse objetivo \u00e9 a mesma da equa\u00e7\u00e3o 3.1 e os par\u00eametros Ni, N2, Nu, R e Q podem ser sintonizados de acordo com as metodologias propostas em [2] e [24].\nUtilizando-se a equa\u00e7\u00e3o 3.8 como forma de expressar as predi\u00e7\u00e3es, pode-se reescrever a fun\u00e7ca\u00e3o objetivo dada pela equa\u00e7ca\u00e3o 3.1 da seguinte forma:\nJ = (Yp \u2014 W)T R (Yp \u2014 W)+AuTQAu\t(3.13)\nou\t(3.14)\nJ = (F + GpnmpcAu \u2014 W)T R (F + GpnmpcAu \u2014 W) + AuTQAu\nA minimizac\u00e7\u00e3ao da func\u00e7\u00e3ao custo para o caso sem restri\u00e7co\u00e3es pode ser obtida igualando-se a zero o gradiente da fun\u00e7ca\u00e3o custo dada pela equacao 3.13, ddJu =\n\u2014\u2014 = 2Gt RGAu + 2Gt RF \u2014 2Gt RW + 2QAu\t(3.15)\ndAu\nIsolando-se Au obtem-se :\nAu = K (W \u2014 F)\n(3.16)\nonde K e a primeira linha da matriz (GtRG + Q)-1GtR.\nUma vantagem do controlador PNMPC \u00e9 que apesar do modelo utilizado ser n\u00e3o-linear, para o calculo da a\u00e7\u00e3o de controle n\u00e3o \u00e9 necessario a utiliza\u00e7ao de otimiza\u00e7\u00e3o nao-linear, ao contrario do caso direto.\n3.2.3\tTratamento de erro de predi\u00e7\u00e3o, ru\u00eddo e perturba\u00e7\u00e3o\nO procedimento de tratamento de erros no PNMPC \u00e9 uma vers\u00e3o expl\u00edcita da vers\u00e3o utilizada pelo GPC. Os algoritmos de controle preditivo GPC e DMC corrigem as predicoes com erro entre o valor medido da vari\u00e9avel controlada e seu valor predito com o modelo em um instante k. Para sistemas lineares, em regime permanente, essa t\u00e9cnica garante erro nulo pois o esfor\u00e7o de controle em um instante k ser\u00e9 o mesmo nos instantes futuros devido a relacao linear entre a entrada e a sa\u00edda. Para o PNMPC esse mesmo procedimento nao garante erro nulo em regime devido ' varia\u00e7\u00e3o do ganho com o ponto de opera\u00e7\u00e3o do sistema.\nEm [33] um mecanismo de correcao das predi\u00e7\u00e3es foi proposto e consiste em adicionar um fator de corre\u00e7\u00e3o a cada predi\u00e7ao. Este fator de correcao \u00e9 calculado atrav\u00e9s da integral do erro de predi\u00e7\u00e3o filtrado. E apresentado na figura 3.2 o diagrama de blocos da t\u00e9cnica proposta para a corre\u00e7\u00e3o das predi\u00e7\u00f5es utilizando-se o algoritmo PNMPC. A cada instante de amostragem calcula-se o erro, descrito na equa\u00e7ao 3.17, entre a sa\u00e9da que o preditor calcula que a variavel teria no instante k [\u00e3(k/k \u2014 1)] e a sa\u00e9da real da vari\u00e1vel no instante k. O valor de [\u00e3(k/k \u2014 1)] \u00e9 o primeiro elemento do vetor de predi\u00e7\u00e3es obtido no instante k 1.\ne(k) = y (k) \u2014 y(k/k \u2014 1)\n(3.17)\nFigura 3.2: Diagrama de Blocos para o tratamento do erro de modelagem e ru\u00eddo. (Fonte: [33])\nAl\u00e9em de garantir o erro nulo em regime, o tratamento do erro de modelagem deve garantir que a din\u00e2mica do erro apresente um tempo de resposta desejado. Defini-se a fun\u00e7\u00e3o de transfer\u00e2ncia entre o erro de modelagem e o erro depois da corre\u00e7c\u00e3ao como\nh(z) =\te(z)\t=\tDF(z)(1 ~ z 1)\ny(k) - ySc(k)\tDF(z)(1 - z-1) + z-lki\n(3.18)\nonde DF(z) \u00e9 o denominador do filtro. Um filtro candidato \u00e1\nf (z) =\n1\n1 - fdz-1\n(3.19)\nSubstituindo-se 3.19 em 3.18 tem-se\nh(z) =\tz2 - (1 + fd)z + fd\nz2 - (1 + fd - ki)z + fd\n(3.20)\nO fator de correc\u00e3o n(k), calculado no instante de amostragem k para ser utilizado na predi\u00e7\u00e3o k +1 ate k + N \u00e1 obtido de acordo com a equac\u00e3o 3.21.\nn(z 1) =\n1\tki\n1 - fdz-1 1 - z-1\ne(z-1)\n(3.21)\nPara sintonizar os par\u00eaametros ki e fd compara-se o polino\u00eamio denominador da equa\u00e7c\u00e3ao 3.20 com um polin\u00eaomio desejado pd(z). Sup\u00e3oe-se um polin\u00eaomio desejado de segunda ordem criticamente amortecido,\npd(z) = (z - a)2, pd(z) = z2 - 2az + a2.\t(3.22)\nComparando o polin\u00eaomio denominador da equa\u00e7ca\u00e3o 3.20 com o polin\u00eaomio desejado da equa\u00e7c\u00e3ao 3.22, obt\u00e1em-se as igualdades,\nfd = a2, ki = 1 + a2 \u2014 2a\t(3.23)\nO projeto do filtro do preditor consiste em escolher o valor do par\u00eametro a e entao determinar fd e kj.\n3.3\tControle NMPC com Restri\u00e7\u00f5es\nO c\u00e1alculo da a\u00e7ca\u00e3o de controle descrito na equa\u00e7ca\u00e3o 3.16 foi formulado considerando que todos os sinais do processo possuem uma faixa de valores ilimitados. Esta abordagem n\u00e3ao \u00e1e muito realista porque na pr\u00e1atica todos os processos est\u00e3ao sujeitos a restric\u00e7\u00e3oes.\nAtuadores possuem um intervalo de ac\u00e7\u00e3ao e uma taxa de varia\u00e7c\u00e3ao limitada, como \u00e1e o caso de v\u00e1alvulas de controle que est\u00e3ao limitados a uma posi\u00e7c\u00e3ao totalmente fechada e totalmente aberta e uma m\u00e1axima\ntaxa de varia\u00e7\u00e3o. Raz\u00e3es construtivas e/ou de seguranca, bem como uma variedade de sensores, causam limita\u00e7c\u00e3oes nas varia\u00e1veis de processo, como no caso dos n\u00edveis nos reservat\u00f3rios, fluxos em tubula\u00e7\u00f5es e as presso\u00e3es em dep\u00e1ositos [2].\nOs sistemas de controle normalmente operam pro\u00e1ximo aos limites, o que pode acarretar violac\u00e7\u00e3oes de restri\u00e7c\u00e3ao. Cabe ao controlador antecipar e corrigir essas viola\u00e7c\u00e3oes de forma que n\u00e3ao aconte\u00e7cam, evitando a instabiliza\u00e7ca\u00e3o do sistema. Neste contexto os controladores MPC se mostram eficazes, uma vez que possuem a capacidade de prever poss\u00e1-veis viola\u00e7c\u00e3oes ao longo do horizonte de predi\u00e7c\u00e3ao e incluem as restri\u00e7c\u00e3oes na solu\u00e7ao do problema de otimiza\u00e7ao. Essas caracter\u00edsticas possibilitam que os controladores MPC evitem a ocorr\u00eaencia das mesmas.\nAs restri\u00e7\u00e3es se classificam em restri\u00e7\u00e3es hard e soft. As restricoes hard s\u00e3o aquelas que nunca podem ser violadas, uma vez que definem os limites f\u00edsicos de uma vari\u00e1vel do processo. Restri\u00e7\u00e3es soft podem ser violadas durante um transit\u00e1orio do sistema causado por perturba\u00e7c\u00e3oes, sendo que em regime permanente devem ser respeitadas. A seguir sera\u00e3o apresentadas os m\u00e1etodos para a inclus\u00e3ao de restric\u00e7\u00e3oes na otimiza\u00e7c\u00e3ao da fun\u00e7\u00e3o objetivo de controladores MPC.\nPara a solu\u00e7c\u00e3ao do problema de controle preditivo com restri\u00e7c\u00e3oes a minimiza\u00e7c\u00e3ao da fun\u00e7ca\u00e3o custo \u00e1e realizada com a aplicac\u00e7\u00e3ao de algoritmos de programa\u00e7\u00e3o quadr\u00e1tica QP. Estes algoritmos resolvem problemas do tipo:\nmin J =\t- xT Qx + cT x\n(3.24)\nx\t2\nSujeito a : Ax &lt;b\nA fun\u00e7ao objetivo da equa\u00e7\u00e3o 3.13 pode ser reescrita na forma de\nQP:\nJ (Au) =\tH Au + bAu + fo\nonde H = 2(GT RG + Q) b = 2(F - W)TRG fo = (F - W)T(F - W)\n(3.25)\nSegundo [48] existem tr\u00eas tipos principais de restri\u00e7\u00e3es frequentemente encontradas em aplica\u00e7\u00e3es pr\u00e1ticas. Os dois primeiros tipos tratam de restri\u00e7\u00e3es impostas na vari\u00e1vel de controle u(k), e o ter-\nceiro tipo est\u00ed relacionado a restri\u00e7\u00e3es na sa\u00edda y(k) ou nas vari\u00edveis de estado x(k). A seguir ser\u00ed apresentada a metodologia utilizada para representa\u00e7\u00e3o de restri\u00e7\u00f5es hard na variavel de controle e sa\u00edda.\n\u2014 Restri\u00e7\u00e3o na varia\u00e7\u00e3o da vari\u00edvel de controle (Au):\nDeseja-se que a varia\u00e7c\u00e3ao do sinal de controle esteja numa faixa (Aumin &lt;Au &lt;Aumax) onde os limites correspondem a limita-\u00e7\u00e3es f\u00edsicas do atuador. Essa restricao pode ser escrita como:\nIAu\t<\tAumax 1\nIAu\t<\tAumin1\n(3.26)\nonde I e a matriz identidade de dimens\u00e3o m x m e 1 \u00ed um vetor de dimensao m x 1 com todos elementos iguais a 1.\n\u2014 Restri\u00e7\u00e3o na vari\u00edvel de controle (u):\nDeseja-se que a amplitude do sinal de controle esteja numa faixa (umin &lt;u &lt;umax) onde os limites correspondem a satura\u00e7oes do atuador. Essa restri\u00e7ca\u00e3o pode ser escrita como:\nTAu &lt;(umax \u2014 u(t \u2014 1))1 \u2014TAu &lt;(\u2014 umin + u(t \u2014 1))1\n(3.27)\nonde T \u00ede uma matriz triangular inferior de dimens\u00e3ao m x m com todos elementos na\u00e3o nulos iguais a 1.\n\u2014 Restri\u00e7\u00e3o na sa\u00edda (y):\nDeseja-se que a amplitude da sa\u00edda esteja numa faixa (ymin &lt;y &lt;ymax) onde os limites correspondem limita\u00e7oes f\u00edsicas do processo. Essa restri\u00e7c\u00e3ao pode ser escrita como:\nGAu\t&lt;Vmax1\tF\nGAu\t<\tVmin1 + F\n(3.28)\nTodas as restri\u00e7\u00e3es podem ser expressas em conjunto montando as matrizes R e C tal que RAu &lt;C:\nR =\nI -I T -T\nG -G\n(u\n(\nC =\n^umax 1 A^min1 max\tu(t\t1))1\nmin + u(t\t1))1\nymax1 F\nymin 1 + F\n(3.29)\n(3.30)\nGrandes perturba\u00e7\u00f5es podem ocorrer inesperadamente, forcando o sistema a um estado do qual n\u00f5o ha nenhuma maneira de mant\u00ea-lo dentro os limites especificados, sem quebrar um conjunto de restri\u00e7\u00f5es. Problemas de infactibilidade tambem podem ocorrer devido a erros de modelagem, especialmente para sistemas linearizados [11]. Uma estrategia sistematica para lidar com o problema de infactibilidade \u00e9 utilizar restri\u00e7\u00f5es soft [18].\nUma forma simples de utilizar restri\u00e7\u00f5es soft \u00e9 adicionar variaveis de folga. Uma vantagem dessa abordagem e que a otimizac\u00e7\u00f5ao a ser realizada pelo controlador MPC a cada instante de tempo continua sendo uma QP. A inser\u00e7ao as variaveis de folga em um problema QP pode ser realizada modificando a equa\u00e7\u00f5o 3.24. Uma penaliza\u00e7ao quadr\u00e1tica das viola\u00e7oes de restri\u00e7\u00f5o \u00e9 adicionada problema original de acordo com:\nmin J = - xT Qx + cT x + eT Pe + pT e\t(3.31)\nx,e\t2\nSujeito a : Ax &lt;b + e\ne > 0\nEsta t\u00e9cnica permite inicialmente a viola\u00e7\u00e3o das restri\u00e7\u00f5es soft e atrav\u00e9s da minimiza\u00e7\u00e3o da variavel de folga e, for\u00e7a a variavel controlada a retornar para dentro da faixa delimitada pela restri\u00e7ao. Infor-ma\u00e7c\u00e3oes adicionais para a implementa\u00e7ca\u00e3o de restri\u00e7c\u00e3oes soft podem ser encontradas em [11], [18] e [34].\n3.4\tControle NMPC por Zonas\nEm grande parte das aplicacoes industriais, as vari\u00e1veis de sa\u00e1da s\u00e3o controladas por faixas de operacao ao inv\u00e1s de setpoints fixos. Esta estrat\u00e1gia \u00e1 usualmente adotada nos casos em que o numero de sa\u00e1-das controladas \u00e1e maior que o nu\u00e1mero de entradas manipuladas, com a intenc\u00e7\u00e3ao de obter alguns graus de liberdade que permitam levar o processo a seu target \u00f3timo, e suavizar a resposta do sistema perante perturbac\u00e7\u00e3oes [13].\nSegundo [18], em muitas aplica\u00e7\u00e3es o valor exato das vari\u00e1veis controladas n\u00e3ao \u00e1e importante, desde que permanec\u00e7am dentro dos limites especificados ou \u2019\u2019faixas\u201d. Isso significa que as sa\u00e1das somente sera\u00e3o tratadas como vari\u00e1aveis controladas quando os valores das pre-di\u00e7c\u00e3oes das mesmas estiverem fora dos limites definidos para as faixas correspondentes.\nDepois de atingir o ponto de opera\u00e7c\u00e3ao, o controlador passa a controlar uma faixa de refer\u00e2encia. Esta faixa \u00e1e extremamente importante do ponto de vista da identifica\u00e7c\u00e3ao do sistema, pois dentro dela h\u00e1a certa liberdade para se excitar a planta e retirar dela o seu comportamento natural.\nCom a finalidade de incorporar o controle por faixas ao controlador PNMPC, a fun\u00e7c\u00e3ao objetivo da equa\u00e7c\u00e3ao 3.1 \u00e1e modificada da seguinte forma:\nN2\nj(N\u00ed,N2,nu)=Y, \\\\y(t + j|t)-yb(t+j|t)Hl +\t(3.32)\nj=Ni\nNu\n\u00abAu(t + j - 1)hQ j=\u00ed\nDe acordo com [43], a estrat\u00e1egia de controle por faixas pode ser implementada da seguinte forma. Para cada sa\u00e1da i observamos sua predic\u00e3o no instante t + j:\n\u2022\tSe yi,min &lt;yi(t + j) &lt;yi\u00a1max, a sa\u00e1da yi deve ser ignorada (liberada ou removida dos c\u00e1alculos de controle) no instante . Portanto, o par\u00e2metro da matriz R correspondente a essa sa\u00e1da deve ser zero. yb(t + j) pode ser qualquer valor.\n\u2022\tSe y-\u00ed (t + j) > yi\u00a1max, a sa\u00e1da yi deve ser trazida para seu limite superior. Portanto, fazemos yb(t + j) = yimax. O par\u00e2metro da\nmatriz R correspondente a essa sa\u00edda \u00e9 um par\u00e2metro de sintonia do controlador.\n\u2022 Se yi(t + j) &lt;yi,min, a sa\u00edda yt deve ser trazida para seu limite inferior. Portanto, fazemos yb(t + j) _ yimin. O par\u00e2metro da matriz R correspondente a essa sa\u00edda \u00ede o mesmo do caso anterior.\n3.4.1\tComentarios Finais\nNeste cap\u00edtulo foi realizada uma revis\u00e3o bibliogr\u00e1fica sobre controle preditivo. Foi apresentado o controlador PNMPC desenvolvido em [33] e estrat\u00e1gias de controle que visam tratar o problema do amortecimento de oscila\u00e7\u00e3es de carga. No pr\u00e1ximo cap\u00edtulo ser\u00e3o discutidos t\u00e1cnicas de identifica\u00e7ao de modelos n\u00e3o-lineares e modelos simplificados para serem utilizados como preditores juntamente com controladores PNMPC. Tamb\u00e1m ser\u00e3o apresentadas ferramentas que visam incluir uma a\u00e7ao feedforward no controlador PNMPC.\nCap\u00edtulo 4\nIdentifica\u00e7\u00e3o e Modelos para Predi\u00e7\u00e3o\nNos cap\u00edtulos anteriores foram discutidos modelos fenomenolo-gicos dos processos e tecnicas de controle preditivo. Neste cap\u00edtulo ser\u00e3ao discutidos modelos utilizados para predi\u00e7c\u00e3ao junto ao controlador PNMPC. Primeiramente ser\u00e3o apresentados aspectos te\u00edricos sobre identifica\u00e7c\u00e3ao de sistemas n\u00e3ao-lineares e logo ap\u00edos a aplica\u00e7c\u00e3ao destas t\u00edcnicas para a identifica\u00e7\u00e3o de um modelo Hammerstein do separador trif\u00edsico. Tambem \u00ed apresentado um modelo fenomenol\u00edgico simplificado do separador. Posteriormente ser\u00e3ao apresentadas ferramentas desenvolvidas para auxiliar no tratamento das perturbac\u00e7o\u00e3es e adicionar uma a\u00e7\u00e3o feedforward ao controlador PNMPC. S\u00e3o elas o estimador de perturba\u00e7co\u00e3es, o preditor de perturba\u00e7co\u00e3es e o detector de perturba\u00e7c\u00e3oes.\n4.1\tModelo de Hammerstein\nO modelo de Hammerstein consiste de um elemento est\u00edatico n\u00e3ao-linear seguido por um sistema dina\u00eamico linear. Processos que possuem n\u00e3ao linearidades na entrada s\u00e3ao bem representados pelo modelo Hammerstein. Essa representa\u00e7ca\u00e3o possui propriedades que facilitam o projeto de controladores preditivos n\u00e3ao lineares, viabilizando soluc\u00e7\u00e3oes anal\u00edticas para os problemas de minimiza\u00e7c\u00e3ao da fun\u00e7c\u00e3ao custo (caso sem restric\u00e7\u00e3oes), mas principalmente, diminuindo os custos computacionais nos c\u00edlculos das leis de controle. E apresentado na figura 4.1 um diagrama de blocos do modelo.\nFigura 4.1: Modelo de Hammerstein\nO sinal intermediario x(t) \u00e9 uma pseudo-sa\u00e1da do sistema e \u00e9 obtido pelo mapeamento do sinal u(t) atraves da fun\u00e7\u00e3o nao-linear est\u00e1tica NL.\nSegundo [5], a representa\u00e7\u00e3o do bloco de n\u00e3o linearidade est\u00e1tica por um polin\u00f3mio d\u00e1-se quando n\u00e3o se disp\u00e3e de informa\u00e7\u00f5es a respeito da natureza da n\u00e3o linearidade. Essa representa\u00e7\u00e3o pode ser feita atrav\u00e1s de uma expansao polinomial finita do tipo:\nx(t) = Y1 u(t) + 72 u2 (t) + ... + Ym um (t)\t(4.1)\nem que t \u00e1 o instante de tempo, x(t) \u00e1 a pseudo-sa\u00e1da do bloco n\u00e3o linear, u(t) \u00e1 a variavel de entrada, Y\u00ed (i = 1, \u2014J) representam os coeficientes do polin\u00f3mio e m \u00e1 o grau de nao linearidade do modelo de Hammerstein. Normalmente considera-se y1 = 1, transferindo o ganho estatico para a parcela din\u00f3mica linear G(q_1), que pode ser representada por qualquer modelo linear. As duas parcelas do modelo podem ser obtidas separadamente ou ao mesmo tempo em um ensaio de identifica\u00e7c\u00e3ao. A representa\u00e7c\u00e3ao parametrica do modelo de Hammerstein pode ser escrita na forma:\nA(q_1 )y(t) = B (q _1 )x(t) + e(t)\t(4.2)\nem que a rela\u00e7ao linear entre a sa\u00e1da y(t) e a pseudo-sa\u00e1da x(t) \u00e1 apresentada. O termo e(t) representa a diferen\u00e7a entre o modelo e o processo (ru\u00e1do branco).\nA popularidade do modelo de Hammerstein deve-se ao fato da sua maior simplicidade em rela\u00e7\u00e3o \u00e0s outras representa\u00e7\u00f5es de sistemas n\u00e3ao-lineares, aliada a uma capacidade de representac\u00e7\u00e3ao da maioria dos processos pr\u00e1ticos [38]. Um exemplo do uso de modelos de Hammers-tein \u00e1e a aplicac\u00e7\u00e3ao em processos com din\u00f3amicas pro\u00e1ximas a sistemas lineares mas que tenham fortes n\u00e3o linearidades nos atuadores (ex. v\u00e1alvulas na\u00e3o lineares).\n4.2\tIdentificac\u00f5o do Modelo de Hammers->\ntein\nA identifica\u00e7ao de sistemas pode ser compreendida segundo [16] como uma aproxima\u00e7ca\u00e3o experimental a fim de obter um modelo mate-m\u00e1atico que reproduz as caracter\u00e1sticas dina\u00eamicas do processo a partir da observac\u00e7\u00e3ao das vari\u00e1aveis desse processo, sendo elas: vari\u00e1avel controlada y(t), variavel de controle u(t) e em alguns casos pertuba\u00e7oes v(t). Para a identifica\u00e7c\u00e3ao de modelos, alguns passos devem ser seguidos, sa\u00e3o eles:\n1.\tAquisi\u00e7c\u00e3ao dos dados do processo;\n2.\tPr\u00e1e-processamento dos dados registrados;\n3.\tSelec\u00e7\u00e3ao da estrutura do modelo;\n4.\tEstimac\u00e3o dos parametros do modelo;\n5.\tValida\u00e7ao do modelo.\nPara o ajuste dos par\u00eaametros do sistema e a defini\u00e7c\u00e3ao do modelo a ser identificado, existem alguns fatores que exercem forte influ\u00eancia, s\u00e3ao eles: (i) conhecimento a priori do sistema, (ii) propriedades do modelo do sistema identificado, (iii) sele\u00e7c\u00e3ao da medida do erro a ser minimizado e (iv) presen\u00e7ca de ru\u00e1dos.\n4.2.1\tEstimador dos M\u00ednimos Quadrados\nExistem v\u00e1arios m\u00e1etodos para ajustar os par\u00eaametros de um modelo a partir de informa\u00e7co\u00e3es de entrada-sa\u00e1da de um processo. Nesse trabalho foi utilizado o Estimador dos M\u00e1nimos Quadrados Recursivos.\nKarl Friedr\u00e1ch Gauss formulou o princ\u00e1pio dos m\u00e1nimos quadrados no final do s\u00e1eculo dezoito e usou isto para determinar as \u00e1orbitas de planetas e asteroides. Gauss declarou que, de acordo com esse princ\u00e1-pio, os par\u00eaametros desconhecidos de um modelo matem\u00e1atico devem ser selecionados de tal modo que \u201da soma dos quadrados da diferenca entre os valores observados e os valores calculados multiplicado por nu\u00e1meros que medem o grau de precis\u00e3ao seja m\u00e1nima\u201d.\nO m\u00e1etodo dos m\u00e1nimos quadrados recursivo \u00e1e um dos m\u00e1etodos mais utilizados na estimac\u00e7\u00e3ao de par\u00eaametros de sistemas, sendo ideal para aplica\u00e7\u00f5es on-line incluindo controle adaptativo e tambem pode\nser usado para aplica\u00e7\u00f5es off-line. Isso acontece pela efici\u00eancia e simplicidade do m\u00e9todo.\nO desenvolvimento matematico das equa\u00e7oes do m\u00e9todo dos m\u00ednimos quadrados recursivo pode ser visto em [6]. Abaixo seguem os passo para a implementa\u00e7\u00e3o do estimador dos m\u00ednimos quadrados recursivo.\n1.\tMedir a entrada e a sa\u00edda do sistema;\n2.\tAtualizar o vetor de medidas;\n<fiT(t + 1) = [-y(t) - y(t - 1)... u(t - d)u(t - d - 1)... ] (4.3)\n3.\tCalcular o erro de previs\u00e3o;\ne(t + 1) = y(t +1) - J(t + 1)\u00ea(t)\n4.\tCalcular o ganho do estimador;\nK (t + 1) =\n________P (t)y(t + 1)____________\n1 + ^T (t + 1)P (t)<fi(t + 1)\n5.\tCalcular o vetor de par\u00eametros estimados;\n\u00e8(t + 1) \u2014 $(t) + K (t + 1)e(t + 1)\n6.\tCalcular a matriz de covari\u00eaancia.\nP(t + 1) = P(t) - K(t + 1>T(t + 1)P(t)\n(4.4)\n(4.5)\n(4.6)\n(4.7)\nDe acordo com [7], a obten\u00e7\u00e3o do modelo de Hammerstein pode ser realizada por meio de um ensaio de identifica\u00e7\u00e3o utilizando o estimador MQR. Neste caso, o vetor de medidas \u00e9 formado como se estivesse tratando de um sistema SISO na forma\n^T(t) = [-y(t - 1) ... - y(t - na)u(t - d) .. . u(t - d - nb)\t(4.8)\nu2(t - d) . .. u2(t - d - nb)um(t - d) .. . um(t - d - nb)]\ncom dimens\u00e3ao\n[na + (nb +1)mxi]\t(4.9)\ne o vetor de par\u00eaametros:\n0 = [a,ia2 ... ana; boYibiYi ... &amp;nb7i5 boY2 ... &amp;nb725 \u2022..; &amp;07 m ... bnb7m]\n(4.10)\n4.2.2\tProcedimento de Identifica\u00e7ao aplicado ao Separador Trif\u00e1sico\nA excita\u00e7ao do processo com o sinal PRBS al\u00e9m de promover uma excitac\u00e3o permanente no sistema, tamb\u00e9m \u00e9 Util para testar a linearidade da planta. Como o sinal assume valores positivos e negativos, este \u00e9e usado para avaliar as n\u00e3ao linearidades presentes, ou n\u00e3ao no processo. Para sistemas na\u00e3o-lineares \u00e9e comum utilizar PRBS com amplitude va-ri\u00e9avel, pois atrav\u00e9es da aplica\u00e7c\u00e3ao deste \u00e9e poss\u00e9vel verificar a simetria do processo e a depend\u00eancia da amplitude do sinal de entrada.\nO experimento foi feito excitando-se com sinal PRBS nas tr\u00eas v\u00e9alvulas de controle do separador na faixa de opera\u00e7c\u00e3ao do sistema. As simula\u00e7c\u00e3oes foram feitas em um per\u00e9odo de 10000 segundos, sendo que a primeira metade \u00e9 destinada \u00e0 identifica\u00e7ao dos par\u00eametros do modelo e a segunda metade para valida\u00e7c\u00e3ao. O procedimento de valida\u00e7c\u00e3ao nada mais \u00e9e do que comparar as sa\u00e9das do modelo com as sa\u00e9das reais da planta e verificar qu\u00e3ao pro\u00e9ximas entre si elas est\u00e3ao.\nPara a gera\u00e7c\u00e3ao do sinal PRBS, foi utilizada um rotina autom\u00e9atica que, a partir da resposta em malha aberta do sistema, define a amplitude e frequ\u00eaencia ideal do sinal PRBS. A descri\u00e7c\u00e3ao desse procedimento pode ser encontrado em [46].\nPRBS - sw\nU\n1UU\n2UU\n3UU\n4UU\n5UU tempons] PRBS - sc\n5UU tempo[s]\n-U.U'\nU\n-U.U'\nU\n1UU\n1UU\n2UU\n\u00bfUU\n4UU\n5UU tempo[s] PRBS - sl\n2UU\n\u00bfUU\n4UU\nFigura 4.2: Sinais PRBS\nA Figura 4.2 mostra os sinais PRBS gerados para cada valvula. Nota-se que n\u00e3o ha a necessidade de todos terem a mesma frequ\u00eancia e amplitude. A dinamica do gas, por exemplo, \u00e9 muito mais r\u00e1pida que a din\u00eamica da agua e do oleo, isso justifica o fato do sinal PRBS que excita a valvula de gas ter uma frequ\u00eancia maior. Tambem seria poss\u00edvel diminuir a amplitude do sinal PRBS da valvula de gas para diminuir a pertubac\u00e7\u00e3ao no sistema de controle das valvulas de agua e gas.\nDepois de ter o sinal PRBS gerado, o proximo passo \u00e9 excitar o sistema com essa sequ\u00eancia binaria. A Figura 4.3 mostra o comportamento encontrado do sistema.\n0.6\n\u25a0g 0.55 -\ntempo [s]\n0.6\n\u2014 0.55 -\n10.5\ntempo is\n10 -\ntempo [s]\nFigura 4.3: Excita\u00e7\u00e3o em Malha Aberta do sistema com sinais PRBS\nPara descobrir qual o grau dos polino\u00eamios que melhor representam o sistema, foi criado uma rotina em Matlab que varia o grau do polin\u00f3mio A(q-1), B(q-1) e o grau da expans\u00e3o polinomial x(t) para encontrar a melhor combinacao da ordem de cada polin\u00f3mio. Essa rotina, varia o grau do polin\u00f3mio A de 1 a 9, do polin\u00f3mio B de 0 ate o grau do polin\u00f3mio A \u2014 1, e do grau da expansao de x(t) de 1 a 9 e, portanto, analisa 405 diferentes modelos e elege o melhor. As equacoes de A, B e x(t) podem ser encontradas nas equacoes 4.2 e 4.1.\nPara qualificar os modelos estimados e, portanto eleger o melhor modelo, existem algumas tecnicas de valida\u00e7c\u00e3ao do modelo. Para isso, sao calculados 2 \u00edndices de desempenho do modelo, equacoes 4.11 e 4.12.\nSomatorio do Erro Quadr\u00e1tico Medio - SEQM\n1 N\nseqm = ^YMk) \u2014 y(k)]2\t(4.11)\nv k=i\nCoeficiente de Correlac\u00e3o M\u00faltipla \u2014 R2\nR2 = 1\nZN=Mk) \u2014 y(k)]2\nN=i[y(k) \u2014 y]2\n(4.12)\nOs melhores resultados para a identifica\u00e7\u00e3o dos 405 modelos citados anteriormente est\u00e3o dispon\u00edveis nas tabelas 4.1, 4.2, 4.3. Para o \u00edndice SEQM, quanto mais pr\u00f3ximo seu valor \u00e9 de 0, melhor. Para o \u00edndice R2 o valor deve ser o mais pr\u00f3ximo poss\u00edvel de 1. Nas tabelas, na representa o grau do polin\u00f3mio A, nb do polinomio Be nh o grau do polin\u00f3mio y . Os \u00edndices de desempenho foram calculados no ensaio de valida\u00e7ca\u00e3o.\nTabela 4.1: Ordem do modelo de Hammerstein para o n\u00edvel da \u00e1gua\nhw\t\t\t\t\t\nModelo\tna\tnb\tnh\tR2\tseqm\n1\t1\t0\t2\t0,7626174791\t0,0000130573\n11\t2\t0\t2\t0,9640319883\t0,0000019784\n29\t3\t0\t2\t0,9879973121\t0,0000006602\n74\t4\t2\t2\t0,9935706372\t0,0000003537\n119\t5\t3\t2\t0,9958842871\t0,0000002264\n173\t6\t4\t2\t0,9969365633\t0,0000001685\n236\t7\t5\t2\t0,9976103048\t0,0000001314\n317\t8\t7\t2\t0,9980210001\t0,0000001089\n389\t9\t7\t2\t0,9983785215\t0,0000000892\nTabela 4.2: Ordem dos modelo de Hammerstein para o n\u00edvel de oleo\nhl\t\t\t\t\t\nModelo\tna\tnb\tnh\tr2\tSEQM\n9\t1\t0\t9\t0,9825394706\t0,0000025801\n27\t2\t1\t9\t0,9919624049\t0,0000011877\n54\t3\t2\t9\t0,9953645874\t0,0000006850\n90\t4\t3\t9\t0,9966054941\t0,0000005016\n135\t5\t4\t9\t0,9972700863\t0,0000004034\n189\t6\t5\t9\t0,9975688599\t0,0000003592\n252\t7\t6\t9\t0,9977040061\t0,0000003393\n324\t8\t7\t9\t0,9977252512\t0,0000003361\n405\t9\t8\t9\t0,9976792302\t0,0000003429\nTabela 4.3: Ordem dos modelo de Hammerstein para a pressao\np\t\t\t\t\t\nModelo\tna\tnb\tnh\tr2\tSEQM\n9\t1\t0\t9\t0,8110426509\t0,0213767446\n18\t2\t0\t9\t0,8319379628\t0,0190128580\n36\t3\t0\t9\t0,7790087770\t0,0250007367\n63\t4\t0\t9\t0,7163326443\t0,0320912874\n99\t5\t0\t9\t0,6225973772\t0,0426955581\n144\t6\t0\t9\t0,5250323535\t0,0537330890\n198\t7\t0\t9\t0,4933199639\t0,0573207116\n261\t8\t0\t9\t0,4747965830\t0,0594162616\n333\t9\t0\t9\t0,4643143087\t0,0606021213\nPelas tabelas 4.1, 4.2 e 4.3 percebemos que o melhor modelo de Hammerstein possui os \u00edndices mostrados na tabela 4.4.\nTabela 4.4: Ordem do modelo de Hammerstein final\nSa\u00edda\tna\tnb\tnh\tR2\tSEQM\nhw\t9\t7\t2\t0,9983785215\t0,0000000892\nhl\t8\t7\t9\t0,9977252512\t0,0000003361\nP\t2\t0\t9\t0,8319379628\t0,0190128580\nAp\u00e9s ter definido quais s\u00e3o os graus dos polin\u00e2mios, a pr\u00f3xima etapa do projeto \u00e9 a aplica\u00e7\u00e3o do metodo dos m\u00e9nimos quadrados recursivo para a identifica\u00e7ao dos par\u00e2metros do modelo de Hammerstein. O modelo final encontrado nao ser\u00e2 apresentado nesse trabalho pois os vetores com os par\u00e2metros possuem ordem elevada e n\u00e3o \u00e9 relevante para a compreens\u00e3ao do procedimento. Como o modelo do separador trif\u00e9sico \u00e9 MIMO com tr\u00eas entradas e tr\u00e2s sa\u00e9das, foram identificados tr\u00e2s modelos MISO que relacionam as tr\u00e2s entradas com cada uma das sa\u00eddas.\nAs Figuras 4.4, 4.5 e 4.6 mostram os ensaios de identificac\u00e3o da \u00e9gua, oleo e g\u00e9s respectivamente. Os primeiros 5000 segundos do ensaio sa\u00e3o utilizados para a identifica\u00e7c\u00e3ao dos par\u00e2ametros enquanto os u\u00e9ltimos 5000 segundos sa\u00e3o utilizados para a validac\u00e7a\u00e3o do modelo.\nFigura 4.4: Ensaio de Identifica\u00e7\u00e3o e Valida\u00e7\u00e3o da \u00e1gua\nFigura 4.5: Ensaio de Identifica\u00e7ao e Validacao do \u00f3leo\nEnsaio de identifica\u00e7\u00e3o da press\u00e3o\nFigura 4.6: Ensaio de Identificacao e Valida\u00e7ao do g\u00f3s\nO procedimento de identificac\u00e3o do modelo de Hammerstein utilizando MQR para ajuste dos par\u00e2metros se mostrou eficiente e ofereceu boa representacao do separador trif\u00e1sico. O modelo encontrado \u00e9 uma simplifica\u00e7ao do sistema real e, consequentemente, necessita de menos esfor\u00e7o computacional para ser simulado. Dessa forma, o modelo de Hammerstein passa a ser uma o\u00e1tima alternativa de preditor em controladores MPC.\n4.3\tModelo Fenomenol\u00f3gico Simplificado\nUma alternativa de modelo para ser utilizado juntamente com o controlador PNMPC \u00e1e utilizar um modelo fenomenol\u00e1ogico simplificado, uma vez que o controlador permite uma f\u00e1acil implementa\u00e7c\u00e3ao com este tipo de modelo. A vantagem de se utilizar um modelo simplificado \u00e1e a redu\u00e7c\u00e3ao do custo computacional, fator importante para aplica\u00e7c\u00e3oes pr\u00e1a-ticas. A diferenc\u00e7a entre o preditor e o modelo utilizado para simula\u00e7c\u00e3ao do processo, \u00e1e que este despreza os c\u00e1alculos das efici\u00eaencias de separac\u00e7\u00e3ao e o conhecimento de BSW e T OG na entrada do separador. Considerase a que a variacao do n\u00edvel de \u00e1gua na c\u00eamara de separa\u00e7\u00e3o depende somente da diferen\u00e7ca entre a vaz\u00e3ao de entrada e de sa\u00e1da. Este modelo \u00e1 descrito pelas equac\u00f5es (4.13), (4.14), (4.15) e (4.16).\ndht   Win + Lin Lweir Wo/<1\t(4 , 3)\n~dt =\t2 \u2022 Ccs -y/hT- (D - ht)\t( . )\ndh[  \tLweir Lout\n~dt = 2 \u2022 Cc[ Vh[ \u2022 (D - h[)\t( . )\ndhw  \tWin Wout\t(4 1 5)\n~dT = 2 \u2022 Ccs \u2022 /hj7(D - hw)\t( . )\ndp\t(Gin + ^^in + Lin\tGout Wout Lout} ' p\ndt =\tVt - VC[ - Vcs\t.\t<4'16>\nPara realizar as predi\u00e7co\u00e3es \u00e1e necess\u00e1ario o conhecimento dos valores das vazoes de alimenta\u00e7ao do separador. Como n\u00e3o \u00e1 poss\u00edvel medir as vaz\u00e3oes de alimenta\u00e7c\u00e3ao de a\u00e1gua, \u00e1oleo e g\u00e1as separadamente, foi desenvolvido por um estimador de perturba\u00e7c\u00e3oes que se baseia na medida dos n\u00edveis, press\u00e3o e vaz\u00e3es de sa\u00edda para estimar o valor atual das vaz\u00e3es na entrada do separador.\nGeralmente em controladores preditivos o que se utiliza \u00e1 considerar que as perturba\u00e7co\u00e3es s\u00e3ao constantes ao longo do horizonte de predi\u00e7c\u00e3ao, por\u00e1em essa abordagem nem sempre produz o melhor resultado. A utiliza\u00e7c\u00e3ao das estimativas futuras das pertuba\u00e7c\u00e3oes podem melhorar as predic\u00e7\u00e3oes e consequentemente o desempenho do sistema de controle. Foi desenvolvido um preditor de perturba\u00e7co\u00e3es, que consiste em um modelo auto regressivo e utiliza os valores anteriores estimados das perturba\u00e7c\u00e3oes para realizar as predic\u00e7\u00e3oes futuras das mesmas.\nDependendo do regime de funcionamento do po\u00e7co a alimenta\u00e7c\u00e3ao do separador pode assumir varios regimes de escoamento entre eles\nconstante ou oscilat\u00f3rio (golfadas). Se as vaz\u00e3es de alimentac\u00e3o s\u00e3o constantes a melhor alternativa \u00ede que as varia\u00edveis controladas sigam um setpoint fixo. Caso as vaz\u00e3es de alimenta\u00e7\u00e3o forem oscilat\u00f3rias a melhor estrat\u00edegia \u00ede permitir a oscila\u00e7c\u00e3ao das vari\u00edaveis controladas dentro de uma zona pr\u00ede-estabelecida. Neste contexto foi desenvolvido um detector de perturba\u00e7c\u00e3oes, que com base no c\u00edalculo do desvio padr\u00e3ao dos dados contidos em uma janela m\u00edovel, indica a presen\u00e7ca de perturba\u00e7c\u00e3oes.\n4.4\tEstimador de Perturbac\u00e3es\n->\nComo n\u00e3o \u00e9 possivel medir separadamente as vaz\u00e3es de \u00edgua, \u00edleo e g\u00eds na entrada do separador trif\u00edsico, a informa\u00e7\u00e3o das perturba\u00e7\u00e3es de carga caracterizadas por oscilac\u00e7\u00e3oes do tipo golfada nessas vaz\u00e3oes, nao pode ser utilizada por controladores cl\u00edssicos ou avancados para a rejeic\u00e3o das mesmas. Com a finalidade de adicionar caracter\u00edsticas feedforward ao controlador PNMPC foi desenvolvido um estimador das vaz\u00e3oes de alimentac\u00e7\u00e3ao do separador trif\u00edasico.\nO modelo desenvolvido por [25] depende do conhecimento das medidas de BSW e TOG, na entrada do separador, as quais se tornam dif\u00edceis de serem realizadas. O calculo das eficiencias de separac\u00e3o pode apresentar incertezas pois \u00e9 necess\u00edrio o conhecimento dos par\u00e2metros da distribui\u00e7ca\u00e3o das gotas das fazes dispersar na entrada do separador. Com o intuito de eliminar os c\u00edalculos das efici\u00e2encias de separa\u00e7c\u00e3ao e o conhecimento de BSW e TOG, o estimador foi desenvolvido baseado no modelo simplificado descrito na se\u00e7\u00e3o 4.3.\nA vazao de \u00edgua na entrada do separador \u00e9 estimada atrav\u00e9s da manipula\u00e7\u00e3o da equa\u00e7ao 4.15 que determina a varia\u00e7ao do n\u00edvel da fase aquosa na c\u00e2mara de separa\u00e7ao. Isolando Win, temos que a vazao de entrada de \u00edgua estimada \u00e9 dada pela equa\u00e7ao 4.17.\nWin = [ccs \u2022 2 \u2022 V(D - hw) \u2022 hw] \u2022\t+ Wout\t(4.17)\nA vaz\u00e3ao de \u00edoleo na entrada do separador \u00ede estimada atrav\u00edes da manipula\u00e7\u00e3o da equa\u00e7\u00e3o 4.13 que determina a variac\u00e3o do n\u00edvel total da fase l\u00edquida na c\u00e2mara de separa\u00e7ao. Isolando a vazao da alimenta\u00e7\u00e3o de oleo (Lin) chega-se a equa\u00e7\u00e3o 4.18.\nLin \u2014 Lweir + [Ccs ' 2 ' / (D \u2014 ht) ' h^ '\t(4.18)\n- [Ccs \u2022 2 \u2022 /(D \u2014 hw) \u2022 hw] \u2022\nA vazao da chicana pode ser estimada atrav\u00e9s da manipula\u00e7\u00e3o da equa\u00e7\u00e3o 4.14 que determina a varia\u00e7\u00e3o do n\u00e9vel de oleo na c\u00e1mara de oleo. Isolando a vazao da chicana (Lweir) chega-se a equa\u00e7\u00e3o 4.19.\nLweir \u2014 [Ccl \u2022 2 ' \\/(D \u2014 hl) \u2022 k] \u2022\t+ Lout\t(4.19)\nA vaz\u00e3ao de g\u00e9as na entrada do separador \u00e9e estimada atrav\u00e9es da manipulac\u00e3o da equa\u00e7ao 4.16 que determina a variac\u00e3o da press\u00e3o no separador. Isolando a vazao da alimenta\u00e7ao de gas (Gin) chega-se a equa\u00e7\u00e3o 4.20.\nGin \u2014 (Vt\t\u2014\tVp\t\u2014\tVd^)\t\u2022 dP \u2014\tWin\t\u2014\tLin\t(4.20)\n+Wout + Lout + Gout\nFoi realizado um experimento com o estimador de perturba\u00e7\u00f5es rodando em paralelo com o controlador PNMPC e utilizando o modelo fenomenol\u00e9gico do separador trifasico como processo. O estimador rodou a uma taxa de amostragem de 1 segundo, enquanto o controlador utilizou um per\u00edodo de amostragem de 10 segundos. Esta diferen\u00e7a no per\u00e9odo de amostragem deve-se ao fato de que um observador deve ter a sua dinamica r\u00e9pida o suficiente para convergir ao valor real da vari\u00e9-vel observada e garantir a estabilidade do sistema de controle. Como o estimador \u00e9e discreto uma forma de manter sua converg\u00e1encia \u00e9e utilizar um per\u00e9odo de amostragem menor que o do controlador. Em uma im-plementac\u00e7\u00e3ao pr\u00e9atica, por exemplo, o estimador utilizaria um per\u00e9odo de 1 segundo, enquanto o controlador calcularia a ac\u00e7\u00e3ao de controle a cada 10 segundos. Por\u00e9em o controlador utilizaria apenas 1 de cada 10 valores estimados devido a diferen\u00e7ca do per\u00e9odo de amostragem.\nAs vaz\u00e3oes de alimenta\u00e7ca\u00e3o utilizadas no teste foram obtidas por uma simula\u00e7\u00e3o realizada no software Olga [39]. Na figura 4.7 \u00e9 apresentado o resultado da estima\u00e7ca\u00e3o das 3 vaz\u00e3oes de alimenta\u00e7c\u00e3ao.\ntempo (segundos)\n0.15\n0.1\nGin\nest\nGin\n0.05 0\t1000\t2000\t3000\t4000\t5000\t6000\t7000\t8000\t9000 10000 tempo (segundos)\nFigura 4.7: Vazoes de Alimentacao Estimadas\nFoi realizada uma an\u00e1lise dos dados estimados visando a compara\u00e7\u00e3o com os dados reais de vaz\u00e3o. Os \u00e1ndices de desempenho utilizados para analisar a qualidade dos dados estimados sao Coeficiente de Corre-la\u00e7ao MUltipla (R2) [6] e o FIT [17]. Os \u00edndices de desempenho obtidos encontram-se na tabela 4.5.\nTabela 4.5: Indices de Desempenho\nVariaveis\tFIT\tR2\nWinest\t91.7574\t0.9932\nL\u00ednest\t90.7616\t0.9915\nGi\u2019neit\t99.8325\t1\nAnalisando os resultados pode-se concluir que o estimador de per-turba\u00e7c\u00e3oes pode ser utilizado em conjunto com controladores preditivos para possibilitar uma a\u00e7ao de controle feedforward. Os \u00e1ndices apresentados na tabela 4.5 indicam que os valores estimados no ensaio s\u00e3o muito proximos aos valores reais das perturba\u00e7c\u00e3oes.\n4.5\tPreditor de Perturba\u00e7\u00f5es\nEstimar perturba\u00e7\u00f5es \u00e1 muito \u00fatil do ponto de vista de controle para compensar os seus efeitos futuros sobre as vari\u00e1veis do processo. Muitos problemas em sistemas de controle podem ser reduzidos quando \u00e1 possivel obter estimativas futuras das perturba\u00e7\u00f5es. Geralmente em controladores preditivos o que se utiliza \u00e1 considerar que as perturba\u00e7\u00f5es sao constantes ao longo do horizonte de predi\u00e7\u00f5o, porem essa abordagem nem sempre produz o melhor resultado. A utilizac\u00f5o das estimativas futuras das pertuba\u00e7c\u00f5oes podem melhorar as predic\u00e7\u00f5oes e consequentemente o desempenho do sistema de controle.\nAtualmente existem muitos sistemas em que a estimativa per-turba\u00e7\u00f5o futura \u00e1 utilizada com o objetivo de melhorar o desempenho global do sistema de controle. Alguns exemplos de aplica\u00e7c\u00f5ao desta t\u00e1ec-nica podem ser encontrados em sistemas de controle de estufas [32] e processos de produ\u00e7\u00f5o de azeite de oliva [1].\nExistem inu\u00e1meras t\u00e1ecnicas para realizar a predic\u00e7\u00f5ao de perturba-\u00e7oes futuras. Para esse fim podem ser utilizados modelos de series temporais [31], [35] , Modelos autocorrelacionados [1] e redes neurais artificiais [30]. Neste trabalho foi utilizado um modelo auto regressivo (AR) para realizar as predi\u00e7\u00f5es dos valores futuros das vaz\u00f5es de ali-menta\u00e7c\u00f5ao. Este modelo \u00e1e apresentado na equa\u00e7c\u00f5ao 4.21 e conta somente com na medidas passadas da variavel a ser predita.\ny(k) _ \u2014 ai \u2022 y(k \u2014 1) \u2014 a2 \u2022 y(k \u2014 2)... \u2014 ana \u2022 y(k \u2014 na)\t(4.21)\nO preditor de perturbac\u00f5es consiste em um modelo auto regressivo, como na equa\u00e7\u00f5o 4.21, e seus par\u00e2metros s\u00f5o obtidos atraves do estimador dos M\u00ednimos Quadrados. O per\u00edodo de amostragem utilizado foi de 10 segundos uma vez que o controlador PNMPC utiliza esta amostragem. Foram estimados 3 modelos, um para cada vaz\u00f5o de alimenta\u00e7c\u00f5ao. O nu\u00e1mero de atrasos de cada modelo foi escolhido aproximadamente o per\u00edodo das golfadas. Adotou-se 250 atrasos (na _ 250) o que equivale a um per\u00edodo de oscilac\u00f5o de 2500 segundos. S\u00f5o apresentados nas figuras 4.8 os resultados gra\u00e1ficos do ensaio de valida\u00e7c\u00f5ao.\ntempo (segundos)\nO0\t2000\t4000\t6000\t8000\t10000\ntempo (segundos)\nFigura 4.8: Vaz\u00f5es de Alimenta\u00e7\u00e3o Preditas\nOs \u00edndices de desempenho obtidos para os modelos encontram-se na tabela 4.6.\nTabela 4.6: Performance Indices\nVariaveis\tFIT\tR2\n\u00cdHpred\t97.7077\t0.9996\nL\u00cdHpred\t97.6925\t0.9996\nGinpred\t98.6354\t0.9999\nAnalisando os resultados tabela 4.6 pode-se verificar que os modelos possuem otimos valores dos \u00edndices de desempenho. Este fato tambem pode ser verificado analisando os resultados gr\u00e1ficos apresentados. De acordo com os resultados pode-se concluir que os modelos identificados est\u00e3ao aptos a realizar a fun\u00e7ca\u00e3o de preditores de perturba-\u00e7co\u00e3es, o que possibilita melhorar as predic\u00e7\u00e3oes utilizadas nos controladores preditivos.\n4.6\tDetector de Perturba\u00e7\u00f5es\nSegundo [15] o conceito de detec\u00e7\u00e3o de estado estacion\u00e1rio originou-se da teoria de filtragem de ru\u00eddos. A vari\u00e2ncia ou desvio-padr\u00e3o de par\u00e1metros importantes \u00e9 normalmente utilizada para indicar a difusao estat\u00edstica na distribuicao de dados e pode ser usado para caracterizar varia\u00e7ao aleatoria dos sinais medidos. Neste trabalho estes conceitos se-r\u00e3ao utilizados para a concep\u00e7c\u00e3ao de um detector de oscila\u00e7c\u00e3oes nas vaz\u00e3oes de alimenta\u00e7c\u00e3ao do separador trif\u00edasico.\nUm m\u00e9todo simples para detectar perturba\u00e7\u00e3es consiste em analisar os dados atrav\u00e9s de uma janela de tempo pr\u00e9-estabelecida, onde os par\u00e1metros importantes s\u00e3o amostrados em intervalos regulares. Isso produz uma matriz de parametros do sistema que s\u00e3o continuamente atualizados e mantidos na mem\u00e9ria. Esta janela e ilustrada na figura 4.9.\nFigura 4.9: Janela m\u00f3vel de n pontos de dados cerca do tempo kth [15]\nO detector calcula o desvio padr\u00e3o de forma recursiva. Sup\u00f5e-se que em qualquer instante k, a media das ultimas n amostras de uma sequ\u00eancia de dados Xi , e dado por:\n1 k\nXk = -\tX\u00ed\t(4.22)\nn\ni=k-n+1\nA diferen\u00e7a entre duas medias das ultimas n amostras no momento atual, k, e no instante de tempo anterior, k \u2014 1, e\n1\n1\nXk - Xk-1 = -\nn\nk\n.i=k-n+1\nk-1\nXi -\tXi\ni=k-n\nXk-n]\nn\nReorganizando, a media atual e calculado por\nxk xk-1 +\t[xk\txk-n]\n(4.23)\nn\nEsta abordagem \u00ed conhecida como janela de media m\u00edvel porque a media a cada instante k \u00ed baseado no conjunto dos n valores mais recentes. A vari\u00e2ncia da janela m\u00edvel pode ser definida da mesma forma. A dedu\u00e7ao da equa\u00e7\u00e3o 4.24 \u00ed apresentada por Ross ([37]) no cap\u00edtulo 2 de seu livro.\n1 k 1 k\nVk = -\t(xi - Xk) =-\txf - xk\nnn\ni=k-n+1\ti=k-n+1\nvk = vk-1 + - (xl - xl-J - (xk - xk-1) n\n(4.24)\n(4.25)\nO desvio padr\u00e3ao da janela m\u00edovel \u00ede calculado por\n&amp; k\n(4.26)\nO detector utiliza o c\u00edalculo do desvio-padr\u00e3ao da janela m\u00edovel para indicar altera\u00e7c\u00e3oes no comportamento do sistema. Se o desvio padr\u00e3ao for menor que um limite pr\u00ede estabelecido significa que as vaz\u00e3oes de alimenta\u00e7ao s\u00e3o aproximadamente constantes, caso o desvio padr\u00e3o ultrapasse este limite o detector indicara\u00ed a presen\u00e7ca de perturba\u00e7c\u00e3oes. A indica\u00e7c\u00e3ao da presen\u00e7ca de perturbac\u00e7\u00e3oes pode ser utilizada no controlador PNMPC por zonas para a altera\u00e7\u00e3o da largura da zona dependendo do regime de escoamento na alimenta\u00e7c\u00e3ao do separador.\nA escolha do limite permitido para o desvio padr\u00e3ao e do tamanho da janela m\u00edovel s\u00e3ao fatores determinantes para o bom funcionamento do detector. Limites muito pequenos para o desvio padr\u00e3o podem acusar ru\u00eddos de medi\u00e7ca\u00e3o como transit\u00edorios nas vazo\u00e3es de alimentac\u00e7\u00e3ao, por outro lado limites grandes, apesar de filtrarem os ru\u00eddos, podem n\u00e3o acusar as oscilac\u00e3es quando elas ocorrem. Um valor plaus\u00edvel para o tamanho de janela \u00ede o per\u00edodo m\u00ededio das oscila\u00e7c\u00e3oes, uma vez que valores pequenos forem utilizados podem induzir, a interpreta\u00e7c\u00e3ao de pequenos valores de derivada existentes ao longo da perturbac\u00e7\u00e3ao, como regime permanente.\nCom a finalidade de calibrar os para\u00e2metros do detector recomendase um ensaio preliminar que consiste em capturar valores de n\u00edveis, press\u00e3ao e vaz\u00e3oes de sa\u00edda do separador por um longo per\u00edodo de tempo, e com esses dados realizar a estimac\u00e7\u00e3ao das vaz\u00e3oes de alimentac\u00e7\u00e3ao. Um\nestudo dos sinais estimados deve ser realizado a fim de obter o valor dos par\u00e1metros para o melhor funcionamento do detector.\nPara a implementa\u00e7\u00e3o do detector de perturba\u00e7\u00f5es foram analisadas as vazoes de alimenta\u00e7\u00e3o de agua e \u00f3leo. Foi utilizada uma janela de 250 amostras e um limite de 0.01 para o desvio padr\u00e3o. Valores de desvio padr\u00e3o abaixo do limite indicam valores constantes das vaz\u00e3es de alimenta\u00e7c\u00e3ao e valores acima indicam a presen\u00e7ca de golfadas. Para acusar a presen\u00e7ca de perturba\u00e7c\u00e3oes \u00f3e necessa\u00f3rio detectar valores acima do limite para as duas vaz\u00e3es de alimenta\u00e7ao. O ensaio foi realizado com um per\u00f3odo de amostragem de 10 segundos.\nE apresentado na figura 4.10 o ensaio realizado com o detector de perturba\u00e7oes. Nos dois primeiros gr\u00f3ficos sao apresentadas a vaz\u00e3o de \u00f3gua e oleo na entrada do separador, no terceiro gr\u00f3fico \u00e9 apresentada a vari\u00f3vel de detecc\u00e3o. Analisando a figura 4.10 \u00e9 poss\u00edvel verificar que as golfadas comec\u00e7am a ocorrer no tempo de aproximadamente 1000 segundos e o detector de perturba\u00e7co\u00e3es acusa a exist\u00e1encia das mesmas no tempo de 1370 segundos. Existe um atraso de 370 segundos na detec\u00e7c\u00e3ao, por\u00f3em n\u00e3ao \u00f3e significativo se comparado com o per\u00f3odo de oscila\u00e7\u00e3o da perturba\u00e7\u00e3o. Isto se deve ao fato da utiliza\u00e7ao de uma janela com um grande nu\u00f3mero de amostras.\n\n\ns\n\n\ntempo (segundos)\n\n\n\n\n\ntempo (segundos)\n\n\nQ\nQ\n\n1\ntempo (segundos)\n\nFigura 4.10: Vazoes de \u00e1gua e oleo e vari\u00e1vel de detec\u00e7\u00e3o\nFoi realizado um segundo ensaio, apresentado na figura 4.11, para verificar a robustez do detector na presen\u00e7a de ru\u00eddo nos sinais de vazao estimados. E possivel verificar que n\u00e3o houve altera\u00e7\u00e3o no funcionamento do detector.\n0.0131-\ntempo (segundos)\ntempo (segundos)\n1\nQ\nQ\n0\n1\ntempo (segundos)\n\n\n\n\n\n\nFigura 4.11: Vaz\u00f5es de \u00e1gua e \u00f3leo e vari\u00e1vel de detec\u00e7\u00e3o\n4.6.1\tComentarios Finais\nNeste cap\u00edtulo foram discutidos aspectos te\u00f3ricos de identifica\u00e7\u00e3o de sistemas nao-lineares e sua aplicacao no controle NMPC de separadores trifasicos. Tamb\u00f3m foi apresentado um modelo simplificado do separador para realizar as predicoes no controlador PNMPC. Por ultimo foram apresentadas ferramentas desenvolvidas com a finalidade de auxiliar controladores MPC no tratamento de perturbacoes. No pr\u00f3ximo cap\u00edtulo ser\u00e3o apresentados os resultados dos ensaios realizados com os controlador PNMPC utilizando as diferentes t\u00edecnicas e modelos ate aqui discutidos.\nCap\u00edtulo 5\nResultados de Simula\u00e7\u00e3o\nNos cap\u00edtulos anteriores foram discutidos modelos fenomenol\u00f3gi-cos dos processos, t\u00f3cnicas de controle preditivo n\u00e3o-linear e modelos utilizados para predi\u00e7\u00e3o. Neste cap\u00edtulo serao apresentados os resultados de simulac\u00e3o obtidos nos ensaios de controle. Os modelos apresentados no cap\u00edtulo 2 foram utilizados para a simulac\u00e7\u00e3ao dos processos enquanto os modelos do cap\u00edtulo 4 foram utilizados para predic\u00e3o no controlador PNMPC. Foram realizados ensaios primeiramente s\u00f3 com o separador trif\u00edasico e posteriormente com o sistema integrado incluindo uma bateria de hidrociclones na sa\u00edda de \u00f3gua do separador. Os dados utilizados para a simulac\u00e7\u00e3ao do modelo fenomenol\u00edogico do separador e do hidrociclone se encontram no ap\u00eandice A. Os sinais das vazoes de alimenta\u00e7c\u00e3ao utilizados nos ensaios de controle foram obtidos atrav\u00edes de uma simula\u00e7\u00e3o no software Olga [39]. Primeiramente s\u00e3o apresentados os ensaios com a presen\u00e7ca de golfadas na entrada do separador e posteriormente com vaz\u00e3oes de alimenta\u00e7ca\u00e3o com perturba\u00e7co\u00e3es do tipo degrau.\n5.1\tControle do Separador Trif\u00e1sico com a presen\u00e7a de Golfadas\nNesta se\u00e7ca\u00e3o ser\u00e3ao apresentados os resultados obtidos nos ensaios de controle do separador trif\u00edasico. S\u00e3ao apresentados resultados com o controlador PNMPC utilizando o modelo de Hammerstein e o modelo fenomenol\u00edgico simplificado como preditores. Para cada um dos pre-ditores foram utilizadas duas configura\u00e7\u00e3es do controlador PNMPC.\nS\u00e3o elas: com restri\u00e7\u00f5es hard e soft e por zonas. Foi realizado um ensaio de controle com o controlador PI por bandas desenvolvido por [27], com o intuito de comparar o desempenho do controlador PNMPC com o de um controlador que atualmente \u00e9 utilizado em plataformas da Petrobras.\n5.1.1\tEnsaio com PNMPC Hammerstein\nA seguir serao apresentados os ensaios com o controlador PNMPC utilizando o modelo de Hammerstein. Foi utilizado um per\u00edodo de amostragem de 10 segundos para simular o processo e o controlador . O sinal de controle calculado atua diretamente na abertura das valvulas de agua, oleo e gas.\n\u2014 Ensaio com PNMPC Hammerstein por Zonas\nO primeiro ensaio de controle do separador trifasico foi realizado utilizando a estrategia de controle PNMPC por Zonas. O ajuste dos par\u00e2metros do controlador \u00e9 apresentado na tabela 5.1. O controle por faixas foi aplicado somente aos n\u00edveis da agua e do oleo, sendo que para pressao foi utilizado setpoint fixo. O par\u00e2metro a de todas as confi-gurac\u00e7o\u00e3es do controlador PNMPC foi ajustado com o valor 0, pois com esse valor segundo [33], se obtem uma melhor rejei\u00e7\u00e3o a perturba\u00e7\u00e3es.\nTabela 5.1: Par\u00e2metros de Ajuste do Controlador\nPar\u00e2metro\tValor\nN\t[20; 20; 6]\nNu\t[15; 15; 2]\nR\t[30; 1; 1]\nQ\t[100000; 20000; 10000]\na\t[0; 0; 0]\nE apresentada na figura 5.1 a resposta das variaveis de processo com suas respectivas faixas. Na figura 5.2 sao apresentadas as vaz\u00e3es de alimenta\u00e7\u00e3o e as vaz\u00e3es de sa\u00edda.\n13\n12.5\n12\n11\n0\n1\n2\n3\ntempo (horas)\n\n\nFigura 5.1: Variaveis de Processo\nFigura 5.2: Vazoes e alimenta\u00e7\u00e3o e sa\u00edda do separador\n\u2014 Ensaio com PNMPC Hammerstein com Restric\u00e3es Hard e Soft\nO segundo ensaio de controle do separador trifa\u00e1sico foi realizado utilizando o controlador PNMPC com restri\u00e7co\u00e3es hard e soft. O ajuste dos par\u00e2metros do controlador \u00e9 apresentado na tabela 5.2. Foram utilizadas restri\u00e7co\u00e3es soft nas sa\u00e1das e restri\u00e7c\u00e3oes hard no incremento de controle, na amplitude do sinal de controle e nas sa\u00e1das.\nTabela 5.2: Par\u00e2metros de Ajuste do Controlador\nPar\u00e2metro\tValor\nN\t[20; 20; 6]\nNu\t[15; 15; 2]\nR\t[30; 1; 1]\nQ\t[100000; 20000; 10000]\na\t[0; 0; 0]\nE apresentada na figura 5.3 a resposta das variaveis de processo com seus respectivos setpoints e os limites impostos pelas restric\u00e7o\u00e3es soft. Na figura 5.4 s\u00e3o apresentadas as vaz\u00e3es de alimentac\u00e3o e as vazoes de sa\u00edda.\nFigura 5.3: Vari\u00e1veis de Processo\nFigura 5.4: Vaz\u00f5es e alimenta\u00e7\u00e3o e sa\u00edda do separador\nE poss\u00edvel verificar nos gr\u00e1ficos apresentados nesta se\u00e7\u00e3o que o controlador PNMPC utilizando o modelo Hammerstein obteve um bom desempenho nas duas configura\u00e7\u00f5es propostas. Nos dois ensaios a vaz\u00e3o de sa\u00edda de agua sofreu uma consider\u00e1vel redu\u00e7ao da oscilac\u00e3o se comparada com a vaz\u00f5ao de alimentac\u00e7a\u00f5o.\n5.1.2\tEnsaio com PNMPC Modelo Fenomenologico\nA seguir ser\u00e3o apresentados os ensaios com o controlador PNMPC utilizando o modelo fenomenol\u00edogico simplificado como preditor. Como o modelo de predi\u00e7c\u00e3ao possui como entradas as vazo\u00e3es de sa\u00edda ao inv\u00edes da abertura das valvulas, o sinal de controle do controlador PNMPC passa a ser um valor de vaz\u00e3ao a ser implementado nas sa\u00eddas do separador. Foram utilizados tr\u00eas controladores locais PI para implementar estas vaz\u00e3oes.\nPara a realizac\u00e7\u00e3ao da predic\u00e7a\u00e3o como modelo fenomenolo\u00edgico simplificado \u00ede necess\u00edario o conhecimento das vazo\u00e3es de alimentac\u00e7\u00e3ao do separador. Como estas na\u00e3o podem ser medidas foi utilizado o estimador de perturbac\u00f5es descrito no cap\u00edtulo 4, que com base nos dados de n\u00edveis, press\u00e3ao e vaz\u00e3oes de sa\u00edda infere os valores das vaz\u00e3oes de alimen-tac\u00e7a\u00e3o.\nCom base nos valores estimados das perturba\u00e7c\u00e3oes \u00ede poss\u00edvel considerar uma a\u00e7\u00e3o feedforward do controlador. Essa acao pode ser implementada atrav\u00e1s dos valores das perturbac\u00f5es calculados no tempo t. No entanto, os valores futuros dos distu\u00edrbios podem ser disponibilizados atrav\u00edes do uso do preditor de perturbac\u00e7o\u00e3es descrito no cap\u00edtulo 4 deste\ntrabalho, sendo estas informa\u00e7oes utilizadas pela lei de controle predi-tivo para o c\u00edlculo da sequ\u00eancia futura das a\u00e7\u00e3es de controle. Neste caso predi\u00e7c\u00e3ao das sa\u00eddas \u00ede calculado usando o vetor de valores futuros da acao de controle Au e perturba\u00e7\u00e3es Aq:\nY_ f (Au, Aq)\t(5.1)\ne a relac\u00f5o linearizada entre os valores futuros das entradas e o vetor predi\u00e7ca\u00f5o \u00e1e calculada usando o mesmo procedimento explicado no cap\u00e1tulo 3.\nPara a realiza\u00e7ca\u00f5o destes ensaios foi utilizado um per\u00e1odo de amostragem de 1 segundo para simular o processo, os controladores PI e o estimador de perturba\u00e7co\u00f5es e um per\u00e1odo de 10 segundos para simular o controlador PNMPC. O esquema de controle \u00e1e apresentado no diagrama da figura 5.5. Os par\u00e2ametros dos controladores de vaz\u00f5ao sa\u00f5o apresentados na tabela 5.3. O ajuste destes controladores foi realizado de forma que a vaz\u00f5ao de setpoint calculada pelo controlador PNMPC seja implementada antes do pr\u00e1oximo c\u00e1alculo do setpoint, ou seja, em menos de 10 segundos.\nWin Lin G,\nFigura 5.5: Esquema de controle do PNMPC com controle local de vaz\u00e3o\nTabela 5.3: Par\u00e2metros de Ajuste do Controlador\nVariaveis\tKc\tT- j-'t\nhw\t20\t1\nhl\t15\t1\np\t0 ,025\t1\n\u2014 Ensaio com PNMPC Modelo Fenomenol\u00f3gico com Restri\u00e7\u00f5es Hard e Soft\nO primeiro controlador testado foi o controlador PNMPC com restric\u00e3es. O ajuste dos par\u00e2metros do controlador \u00e9 apresentado na tabela 5.4. Foram utilizadas restri\u00e7\u00f5es soft nas sa\u00e9das e restri\u00e7\u00e3es hard no incremento de controle, na amplitude do sinal de controle e nas sa\u00e9das.\nTabela 5.4: Par\u00e2metros de Ajuste do Controlador\nPar\u00e2metro\tValor\nN\t[20; 20; 20]\nNu\t[5; 5; 5]\nR\t[1; 1; 10]\nQ\t[10000000; 100000; 100]\nP . 1 mm\t[1; 10; 1]\nP 1 max\t[1; 10; 1]\na\t[0; 0; 0]\nE apresentada na figura 5.6 a resposta das vari\u00e1veis de processo com seus respectivos setpoints. Na figura 5.7 s\u00e3o apresentadas as vazoes de alimenta\u00e7ao e as vaz\u00e3es de sa\u00e1da.\ntempo (horas)\nFigura 5.6: Variaveis de Processo\ni\nf\n2\t3\ntempo (horas)\n\n\nFigura 5.7: Vaz\u00f5es e alimenta\u00e7\u00e3o e sa\u00edda do separador\n- Ensaio com PNMPC Modelo Fenomenologico por Zonas\nO segundo ensaio de controle foi realizado com o controlador PNMPC por Zonas. O ajuste dos par\u00e2metros do controlador \u00e9 apresentado na tabela 5.5. O controle por faixas foi aplicado somente aos n\u00edveis da agua e do oleo, sendo que para pressao foi utilizado setpoint fixo.\nTabela 5.5: Par\u00e2metros de Ajuste do Controlador\nPar\u00e2metro\tValor\nN\t[20; 20; 20]\nNu\t[5; 5; 5]\nR\t[5; 3; 20]\nQ\t[1000000; 100; 1]\na\t[0; 0; 0]\nE apresentada na figura 5.8 a resposta das variaveis de processo com suas respectivas faixas. Na figura 5.9 s\u00e3o apresentadas as vazoes de alimenta\u00e7ao e as vaz\u00e3es de sa\u00edda.\n12.1\n12\n0\n1\n2\n3\ntempo (horas)\n\n\nFigura 5.8: Variaveis de Processo\nFigura 5.9: Vazoes e alimenta\u00e7\u00e3o e sa\u00edda do separador\nE poss\u00edvel verificar nos gr\u00e1ficos apresentados nesta se\u00e7\u00e3o que o controlador PNMPC utilizando o modelo fenomenolo\u00edgico simplificado obteve bons resultados. Em uma primeira an\u00edalise comparando com os resultados da se\u00e7ca\u00e3o anterior pode-se dizer que este controlador possibilitou uma vaza\u00e3o de sa\u00edda de \u00edagua mais contante, destacando principalmente o desempenho do controlador PNMPC por zonas.\n5.1.3\tEnsaio com Controlador por Bandas\nA seguir s\u00e3o apresentados os resultados obtidos com o controlador por bandas. Os aspectos te\u00f3ricos deste controlador s\u00e3o apresentados no ap\u00e2ndice C. O ajuste dos par\u00e2metros do controlador \u00e9 apresentado na tabela 5.6. O controle por bandas foi aplicado somente aos n\u00edveis da \u00edgua e do \u00edleo, sendo que para press\u00e3o foi utilizado setpoint fixo.\nTabela 5.6: Par\u00e2metros de Ajuste do Controlador\n\tDentro da Zona\t\tFora da Zona\t\nVari\u00edveis\tKc\tT-\tKc\tT-\nhw\t0, 001\t125\t0,1\t50\nhl\t0,01\t125\t0,02\t50\np\t0,03\t50\t0,03\t50\nE\u00e9 apresentada na figura 5.10 a resposta das vari\u00e9aveis de processo com suas respectivas faixas. Na figura 5.11 sa\u00e3o apresentadas as vaz\u00e3oes de alimenta\u00e7ca\u00e3o e as vaz\u00e3oes de sa\u00e9da.\n0\t1\t2\t3\t4\t5\n0\n1\n2\n3\ntempo (horas)\n\n\nFigura 5.10: Vari\u00e1veis de Processo\nFigura 5.11: Vaz\u00f5es e alimenta\u00e7\u00e3o e sa\u00edda do separador\nComo pode ser visto nas figuras apresentadas o controlador por bandas proporcionou um certo amortecimento na vaz\u00e3o de sa\u00edda de agua. Se comparado com o controlador PNMPC \u00e9 possivel identificar visualmente que este controlador se mostra inferior em termos de amortecimento de oscila\u00e7\u00e3es. Uma an\u00e9lise comparativa completa dos resultados sera apresentada no item 5.1.4\n5.1.4\tAn\u00e1lise de Desempenho dos Controladores\nA tabela 5.7 cont\u00e9m dados referentes as oscilac\u00e3es percentuais das vaz\u00e3es de entrada e sa\u00edda do separador trif\u00e9sico e a vari\u00e2ncia das vaz\u00e3es de sa\u00edda para cada ensaio de controle realizado. Nota-se tanto nos resultados gr\u00e9ficos como nos \u00edndices de desempenho, que em todos ensaios as vaz\u00e3es de entrada e sa\u00edda de g\u00e9s sao as mesmas. Isto ocorre devido \u00e0 preocupa\u00e7ao de manter a pressao constante no interior do separador. Em contrapartida, diferentes resultados para as vaz\u00e3es de \u00edoleo e \u00edagua foram obtidos com os diferentes controladores.\nTabela 5.7: Indices de Desempenho\nControlador\tVaz\u00e3o\tOscilac\u00e3o (%)\tVariancia\n\tWin\t21,01\t-\n-\tLin\t15, 29\t-\n\tGin\t32, 45\t-\n\tWout\t4, 57\t1,2821\u202210-8\nPNMPC Hammerstein CR\tLout\t31, 91\t1, 7867 \u2022 10-6\n\tGout\t32, 45\t2, 4828 \u2022 10-4\n\tWout\t3, 97\t1, 6559 \u2022 10-8\nPNMPC Hammerstein Zona\tLout\t30, 70\t1, 5770 \u2022 10-6\n\tGout\t32, 45\t2, 0830 \u2022 10-4\n\tWout\t4, 31\t3, 3260 \u2022 10-8\nPNMPC CR\tLout\t32, 61\t2, 6433 \u2022 10-6\n\tGout\t32, 45\t1, 4379 \u2022 10-4\n\tWout\t4, 00\t5, 7803 \u2022 10-9\nPNMPC Zona\tLout\t31,00\t2, 5111 \u202210-6\n\tGout\t32, 45\t1, 4590 \u2022 10-4\n\tWout\t6, 27\t3, 5313\u202210-8\nBandas\tLout\t65, 76\t1,5216\u202210-6\n\tGout\t32, 45\t1, 6118\u202210-4\nE\u00e1 poss\u00e1vel verificar que entre os controladores preditivos o maior amortecimento das oscilac\u00e7\u00e3oes na vaz\u00e3ao de sa\u00e1da de a\u00e1gua \u00e1e obtido pelo controlador PNMPC por zonas utilizando o modelo Hammerstein, obtendo um amortecimento com um fator de 5, 29 e uma vari\u00eancia de 1, 6559 \u2022 10-8. Porem o controlador preditivo que obteve a menor vari-\u00eaancia da vaz\u00e3ao de sa\u00e1da de \u00e1agua foi o controlador PNMPC por zonas utilizando o modelo fenomenol\u00e1ogico simplificado, com uma vari\u00eaancia de 5, 7803 \u2022 10-9 e um amortecimento com um fator de 5, 25.\nAnalisando os resultados gr\u00e1aficos obtidos com os dois controladores \u00e1e poss\u00e1vel verificar que a vaz\u00e3ao de sa\u00e1da de \u00e1agua se mant\u00e1em constante por um maior tempo com o segundo controlador, tendo variac\u00e7\u00e3oes em degrau quando n\u00e1vel de \u00e1agua sai para fora da zona. Por\u00e1em como primeiro controlador a vaz\u00e3ao varia ao longo do tempo de uma forma aproximadamente senoidal com pequena amplitude.\nLevando em conta a analises dos gr\u00e1ficos, o fato do amortecimento obtido com os dois controladores s\u00e3ao praticamente iguais e a varia\u00eancia obtida como segundo controlador \u00e1e consideravelmente menor, escolheu-\nse o controlador PNMPC por zonas utilizando o modelo fenomenologico simplificado como controlador mais adequado para situa\u00e7\u00f5es onde o processo esteja sob a a\u00e7\u00e3o de golfadas.\nAnalisando os resultados gr\u00e1ficos e os dados da tabela 5.7 nota-se que existe uma amplifica\u00e7ao das oscila\u00e7\u00e3es na vaz\u00e3o de sa\u00edda de oleo. Este fato pode ser explicado analisando a equa\u00e7\u00e3o da varia\u00e7ao da altura total na c\u00e2mara de separa\u00e7ao, tendo em vista que ha um aumento da oscila\u00e7c\u00e3ao das vaz\u00e3oes de entrada de oleo e agua e uma redu\u00e7c\u00e3ao da oscilac\u00e3o da vaz\u00e3o de sa\u00edda de agua devido ao controle aplicado, consequentemente ocorre um aumento da vaz\u00e3ao da chicana o que acarreta uma perturba\u00e7ca\u00e3o maior que a ocorrida na vaz\u00e3ao de entrada de oleo. Para obter o amortecimento desejado na vazao de sa\u00edda de agua \u00e9 ne-cessaria uma oscila\u00e7\u00e3o do n\u00edvel da agua, o que acarreta maior oscila\u00e7\u00e3o do n\u00edvel total de l\u00edquido na c\u00e2mara de separac\u00e3o e consequentemente aumenta a vaza\u00e3o da chicana.\nE expressa nos trabalhos de ([8]; [40]; [13]; [36]) entre outros, a preocupa\u00e7\u00e3o com o amortecimento na vaz\u00e3o de sa\u00edda de agua, uma vez que esta alimenta a entrada dos hidrociclones e influencia diretamente do comportamento dos mesmos. Se as perturbac\u00f5es forem repassadas ao hidrociclones estes ter\u00e3ao seu funcionamento comprometido do ponto de vista da efici\u00e2encia de separa\u00e7c\u00e3ao.\nE apresentado em [28] um diagrama de uma planta trifasica de processamento primario de petr\u00f3leo. Nesta existe um separador bif\u00e1sico oleo/gas em serie com a sa\u00edda de oleo do separador trifasico. O separador bifasico pode ser utilizado com filtro visando absorver estas oscila\u00e7c\u00e3oes de forma a fornecer uma vaz\u00e3ao constante ao tratador eletros-tatico que esta em serie.\n5.2\tControle do Separador Trif\u00e1sico com perturba\u00e7\u00f5es do tipo degrau\nNesta se\u00e7\u00e3o ser\u00e3o apresentados os resultados obtidos nos ensaios de controle do separador trifasico utilizando vaz\u00e3es de alimenta\u00e7\u00e3o com perturbac\u00e7o\u00e3es do tipo degrau. E importante analizar este tipo de situa\u00e7\u00e3o, porque ao longo do tempo o regime de escoamento nos po\u00e7os e risers podem alternar entre golfadas e mudancas em degrau nas vaz\u00e3es alternando com per\u00edodos de regime permanente. Os ensaios ser\u00e1o apresentados no mesmo formato da sec\u00e3o 5.1.\n5.2.1\tEnsaio com PNMPC Hammerstein\nA seguir ser\u00e3ao apresentados os ensaios com o controlador PNMPC utilizando o modelo de Hammerstein como preditor. Foi utilizado um per\u00edodo de amostragem de 10 segundos para simular o processo e o controlador . O sinal de controle calculado atua diretamente na abertura das v\u00e9lvulas de agua, \u00f3leo e g\u00e9s.\n\u2014 Ensaio com PNMPC Hammerstein por Zonas\nO primeiro ensaio de controle do separador trif\u00e9asico foi realizado utilizando a estrat\u00e9gia de controle PNMPC por Zonas. O ajuste dos par\u00e2metros do controlador \u00e9 apresentado na tabela 5.8. O controle por faixas foi aplicado somente aos n\u00e9veis da agua e do \u00e9leo, sendo que para press\u00e3o foi utilizado setpoint fixo. Neste ensaio foi utilizada uma largura da zona igual a zero de forma que o controlador funciona como se utiliza-se um set point fixo.\nTabela 5.8: Par\u00e2metros de Ajuste do Controlador\nPar\u00e2metro\tValor\nN\t[20; 20; 6]\nNu\t[15; 15; 2]\nR\t[20; 1; 1]\nQ\t[1000; 1000; 10000]\na\t[0; 0; 0]\nE apresentada na figura 5.12 a resposta das vari\u00e1veis de processo com suas respectivas faixas. Na figura 5.13 sao apresentadas as vaz\u00f5es de alimenta\u00e7\u00f5o e as vaz\u00f5es de sa\u00e1da.\n\n\n\n\n\n).46l\n\t\t\t\t\t\t\n\t\t\t\t\n\ta\t10 tempo (horas)\t\t\t\nA\t'\t'\t1 1\t\t\t\nr\tnr\t;\t\t\t\t\n2 4 6\ta\t10 tempo (horas)\t12\t14\t16\na\t10\ntempo (horas)\n\n\n\n\n\n\nFigura 5.12: Vari\u00e1veis de Processo\n\n1\nI\tWin I\nI\tWout |~\n\n\n\n\nT\nr\n\nI\tLin I\nI\tLout|~\n\n\nI\tGin I\nI----Gout[\n\n\n6\ta\t10\t12\ntempo (horas)\nFigura 5.13: Vaz\u00f5es e alimenta\u00e7ao e sa\u00edda do separador\n\u2014 Ensaio com PNMPC Hammerstein com Restri\u00e7\u00f5es Hard e Soft\nO segundo ensaio de controle do separador trifasico foi realizado utilizando o controlador PNMPC com restricoes hard e soft. O ajuste dos par\u00e2metros do controlador \u00e9 apresentado na tabela 5.9. Foram utilizadas restri\u00e7\u00f5es soft nas sa\u00eddas e restri\u00e7\u00f5es hard no incremento de controle, na amplitude do sinal de controle e nas sa\u00eddas.\nTabela 5.9: Par\u00e2metros de Ajuste do Controlador\nPar\u00e2metro\tValor\nN\t[20; 20; 6]\nNu\t[15; 15; 2]\nR\t[2; 1; 2]\nQ\t[1000; 1000; 10000]\na\t[0; 0; 0]\nE apresentada na figura 5.14 a resposta das variaveis de processo com seus respectivos setpoints e os limites impostos pelas restric\u00e7\u00e3oes soft. Na figura 5.15 sao apresentadas as vaz\u00e3es de alimentac\u00e3o e as vaz\u00e3es de sa\u00e9da.\ntempo (horas)\n\t2\t4\t6\t8 10\t12\t14\t16\n\t\t\ttempo (horas)\t\t\t\n-\t\t!\t\t\t\t4\t\t\t\t1\t\t-\\- -\n\t\tf\t\t\t\t\n\t\t4\t\t.|\t1\t\t\tJ\t1.\t\t1\t\t\t1\t\t\t1- - =\n\t\t\t8 10\t\t\t\n\t\t\ttempo (horas)\t\t\t\nFigura 5.15: Vaz\u00f5es e alimenta\u00e7ao e sa\u00edda do separador\nE\u00ed poss\u00edvel verificar nos gra\u00edficos apresentados nesta sec\u00e7\u00e3ao que o controlador PNMPC utilizando o modelo Hammerstein obteve um bom desempenho nas duas configurac\u00e7\u00e3oes propostas. Nos dois ensaios as va-ria\u00edveis controladas sofreram certa oscilac\u00e7\u00e3ao no momento em que ocorreu a perturba\u00e7ca\u00e3o nas vazo\u00e3es de alimente\u00e7ca\u00e3o por\u00edem posteriomente essas perturba\u00e7\u00f5es foram rejeitadas.\n5.2.2\tEnsaio com PNMPC Modelo Fenomenol\u00f3gico\nA seguir sera\u00e3o apresentados os ensaios com o controlador PNMPC utilizando o modelo fenomenol\u00f3gico simplificado como preditor. O principio de funcionamento deste controlador foi apresentado no item 5.1.2.\n\u2014 Ensaio com PNMPC Modelo Fenomenologico com Restric\u00f5es Hard e Soft\nO primeiro controlador testado foi o controlador PNMPC com restric\u00e7o\u00e3es. O ajuste dos par\u00eaametros do controlador \u00ede apresentado na tabela 5.10. Foram utilizadas restricoes soft nas sa\u00eddas e restri\u00e7oes hard no incremento de controle, na amplitude do sinal de controle e nas sa\u00eddas.\nTabela 5.10: Par\u00e2metros de Ajuste do Controlador\nPar\u00e2metro\tValor\nN\t[20; 20; 20]\nNu\t[5; 5; 5]\nR\t[20; 10; 10]\nQ\t[1000; 100; 100]\nP . 1 mm\t[1; 10; 1]\nP 1 max\t[1; 10; 1]\na\t[0; 0; 0]\nE apresentada na figura 5.16 a resposta das vari\u00e1veis de processo com seus respectivos setpoints. Na figura 5.7 s\u00e3o apresentadas as vazoes de alimenta\u00e7\u00e3o e as vaz\u00e3es de sa\u00e1da.\np\thl\thw\n-\t\t\t4\t1\t\t\t1\t4\t\t--I\t\t\t1\t\t\t\t1\t\t-\n\t\t\t\tK-/\t'\t\t\t\n\t\t4\t1\t\t\t1\t4\t\t\t1\t\t\t1\t\t\t\tI\t\t\n\t2\t4\t6 8 tempo (horas)\t10\t12\t14\t16\n-\t\t!\t1\t\t\t1\t4\t\t.1\t\t------ 4\t\t\t!\t\t\n-\t\t\t4\t1-\t\t\t1\t4\t\t- -1\t\t\t1\t\t\t\t1\t\t\t1- - -\n\t24\t68 tempo (horas)\t10\t12\t14\t16\n1 1 1 1 1 1 1 1\t\t\t\t\t\t\n1 1 1 1 1 1 1 1\t\t\t\t\t\t\n\t24\t6 8\t10\t12\t14\t16\ntempo (horas)\nFigura 5.17: Vazoes e alimentacao e sa\u00edda do separador\n\u2014 Ensaio com PNMPC Modelo Fenomenologico por Zonas\nO segundo ensaio de controle foi realizado com o controlador PNMPC por Zonas. O ajuste dos para\u00e2metros do controlador \u00e1e apresentado na tabela 5.11. O controle por faixas foi aplicado somente aos n\u00e1veis da a\u00e1gua e do \u00e1oleo, sendo que para pressa\u00f5o foi utilizado setpoint fixo. Neste ensaio foi utilizada uma largura da zona igual a zero de forma que o controlador funciona como se utiliza-se um set point fixo.\nTabela 5.11: Par\u00e2metros de Ajuste do Controlador\nPar\u00e2metro\tValor\nN\t[20; 20; 20]\nNu\t[5; 5; 5]\nR\t[5; 3; 20]\nQ\t[1000000; 100; 1]\na\t[0; 0; 0]\nE apresentada na figura 5.18 a resposta das variaveis de processo com suas respectivas faixas. Na figura 5.19 sao apresentadas as vazoes de alimenta\u00e7ca\u00e3o e as vaz\u00e3oes de sa\u00edda.\n12.5\n12\n0\t2\t4\t6\t8\ntempo (horas)\n12\t14\t16\nFigura 5.18: Vari\u00e1veis de Processo\ntempo (horas)\n----Gin ----Gout\n\u25a0Z\"\nL\n1\n1\nJ l\n8\t10\ntempo (horas)\n1\n1\n1\n0\n0\n\n\n\"21\nV\n\nFigura 5.19: Vaz\u00e3es e alimenta\u00e7ao e sa\u00edda do separador\nE poss\u00edvel verificar nos gr\u00e1ficos apresentados nesta se\u00e7ao que o controlador PNMPC utilizando o modelo fenomenol\u00edogico simplificado obteve bons resultados. Em uma primeira an\u00edalise comparando com os resultados da se\u00e7ca\u00e3o anterior pode-se dizer que este controlador possibilitou um melhor comportamento em regime permanente rejeitando as perturbac\u00e7o\u00e3es do tipo degrau nas varia\u00edveis controladas.\n5.2.3\tEnsaio com Controlador por Bandas\nA seguir s\u00e3o apresentados os resultados obtidos com o controlador por bandas. O ajuste dos par\u00e2metros do controlador \u00e9 apresentado na tabela 5.6. O controle por bandas foi aplicado somente aos n\u00e9veis da \u00e9agua e do \u00e9oleo, sendo que para press\u00e3ao foi utilizado setpoint fixo.\nE apresentada na figura 5.20 a resposta das vari\u00e9veis de processo com suas respectivas faixas. Na figura 5.21 sao apresentadas as vaz\u00e3es de alimenta\u00e7c\u00e3ao e as vaz\u00e3oes de sa\u00e9da.\nFigura 5.20: Vari\u00f3veis de Processo\nFigura 5.21: Vazoes e alimenta\u00e7ao e sa\u00edda do separador\nComo pode ser visto nas figuras apresentadas o controlador por bandas controlou com dificuldades o processo de forma que a cada degrau aplicado nas vaz\u00f5es de alimentac\u00e3o a vazao de sa\u00edda de \u00e1gua se tornou mais oscilat\u00e1ria, o que pode comprometer o funcionamento dos processos a jusante. Por\u00e1m as variaveis controladas nao excederam o limite da banda. Uma an\u00e1lise comparativa completa dos resultados ser\u00e1 apresentada no item 5.2.4\n5.2.4\tAnalise de Desempenho dos Controladores\nA tabela 5.12 contem dados referentes a vari\u00e2ncia das variaveis controladas e a vari\u00e2ncia das vazoes de sa\u00edda para cada ensaio de controle realizado.\nTabela 5.12: Indices de Desempenho\nControlador\tVaz\u00e3o\tVaria\u00f3ncia\t\n\tWout\t5, 8616 \u2022\t10-8\nPNMPC Hammerstein CR\tLout\t6, 2437 \u2022\t10-8\n\tGout\t1,0873 \u2022\t10-4\n\thw\t6, 2434 \u2022\t10-5\n\thl\t4, 2830 \u2022\t10-4\n\tp\t6,1686 \u2022\t10-3\n\tWout\t5, 6297 \u2022\t10-8\nPNMPC Hammerstein Zona\tLout\t6, 2395 \u2022\t10-8\n\tGout\t8, 2678 \u2022\t10-5\n\thw\t7,4913 \u2022\t10-6\n\thl\t7, 5026 \u2022\t10-6\n\tp\t5, 8653 \u2022\t10-3\n\tWout\t6,1237 \u2022\t10-8\nPNMPC CR\tLout\t6, 5308 \u2022\t10-8\n\tGout\t6,4893 \u2022\t10-5\n\thw\t6, 3942 \u2022\t10-5\n\thl\t4, 6847 \u2022\t10-7\n\tp\t1, 2264 \u2022\t10-4\n\tWout\t5, 7255 \u2022\t10-8\nPNMPC Zona\tLout\t6, 2849 \u2022\t10-8\n\tGout\t6,4872 \u2022\t10-5\n\thw\t5, 9366 \u2022\t10-6\n\thl\t3,0549 \u2022\t10-6\n\tp\t3, 9230 \u2022\t10-6\n\tWout\t7, 9442 \u2022\t10-8\nBandas\tLout\t1,1678 \u2022\t10-7\n\tGout\t6, 5061 \u2022\t10-5\n\thw\t4, 5637 \u2022\t10-4\n\thl\t2,1461 \u2022\t10-2\n\tp\t4, 6473 \u2022\t10-5\nAnalizando os resultados da tabela 5.12 \u00ed poss\u00edvel verificar que o controlador que apresenta melhor \u00edndice na vaz\u00e3o de sa\u00edda de agua \u00ed o controlador PNMPC por zonas utilizando o modelo hammerstein, com uma vari\u00f3ncia de 5, 6297 \u2022 10-8. Por outro lado o controlador PNMPC po Zonas utilizando o modelo fenomenol\u00edgico apresentou melhores re-\nsultados quanto a oscila\u00e7c\u00e3ao no n\u00edvel da \u00edagua, com uma varia\u00eancia de 5, 9366 \u2022 10-6. O segundo controlador obteve bons \u00edndices relativos a vaz\u00e3ao de sa\u00edda de \u00edagua, isto significa que o controlador rejeitou as per-turba\u00e7c\u00e3oes do tipo degrau nas vazo\u00e3es de alimenta\u00e7c\u00e3ao e ao mesmo tempo manteve uma boa separa\u00e7c\u00e3ao. O mesmo pode ser verificado nos gr\u00edaficos apresentados.\nDeve-se ressaltar que o controlador PI por bandas n\u00e3o obteve bons resultados neste ensaio por se tratar de um controlador concebido para o amortecimento de osci^\u00e3es do tipo golfada. Sua sintonia lenta dentro da banda permite uma oscila\u00e7ca\u00e3o por um longo per\u00edodo de tempo quando ha uma mudan\u00e7a na alimenta\u00e7\u00e3o do separador. Uma poss\u00edvel alternativa para melhorar o desempenho do controlar neste caso seria diminuir a banda de forma a aproxim\u00ed-lo de um controlador com setpoint fixo e uma sintonia mais agressiva, como efetuado com o controlador PNMPC por zonas utilizando o modelo fenomenol\u00edgico.\nQuanto menor vari\u00eancia nestes sinais, melhor \u00ed a separa\u00e7\u00e3o, uma vez que o n\u00edvel de \u00edgua se mantendo pr\u00edximo ao setpoint e a vazao de sa\u00edda de \u00edagua sendo constante, garantem que a distribuic\u00e7a\u00e3o do volume das gotas de o\u00edleo dispersas na corrente aquosa que alimenta a bateria de hidrociclones n\u00e3ao sofra altera\u00e7c\u00e3oes ao longo do tempo. Dessa forma o controlador al\u00edem de garantir o bom funcionamento do separador tamb\u00edem permite que os equipamentos a jusante funcionem de forma adequada.\nLevando em conta a an\u00edlises dos itens 5.1.4 e 5.2.4, escolheu-se o controlador PNMPC por zonas utilizando o modelo fenomenol\u00edogico simplificado como controlador preditivo de melhor desempenho, e ser\u00eda testado com o sistema integrado (Separador + Hidrociclone).\n5.3\tEnsaio com Controlador PI por Bandas e PNMPC Modelo Fenomenol\u00f3gico por Zonas\nE\u00ed apresentado na figura 5.22 o esquema de controle proposto, baseado no controlador PNMPC e nas estrat\u00edegias de estima\u00e7c\u00e3ao, predi\u00e7c\u00e3ao e detec\u00e7\u00e3o de perturba\u00e7oes, utilizado para obter um controle flex\u00edvel e eficiente para o separador. Como pode ser visto na figura o controlador possui tr\u00eaes n\u00edveis. No n\u00edvel local, tr\u00eaes controladores PI escravos s\u00e3ao usados para manipular as tr\u00eaes v\u00edalvulas e manter os fluxos de sa\u00edda de \u00edagua, o\u00edleo e g\u00edas nos valores do setpoint, definidos pelo controlador mestre (PNMPC).\nO PNMPC, que opera no segundo nivel, minimiza uma fun\u00e7\u00e3o objetivo que utiliza a\u00e7oes feedback e feedforward. Finalmente, a func\u00e3o objetivo a ser passada para o PNMPC \u00ed computada no terceiro n\u00edvel, que decide se o controlador deve trabalhar com uma faixa estreita ou larga nas especifica\u00e7\u00e3es de controle. Este n\u00edvel supervisor utiliza um detector de perturba\u00e7c\u00e3oes das vazo\u00e3es de alimentac\u00e7\u00e3ao para definir o modo de operac\u00e7\u00e3ao.\nW,\u201e\tL\u00a1\u201e\tG,\nFigura 5.22: Esquema do PNMPC com controle supervis\u00e1rio\nDependendo do regime de funcionamento do poco ou do riser, a vazao de fluido na entrada no separador pode ser est\u00edvel ou oscila-t\u00edorio. Para uma vaz\u00e3ao de alimenta\u00e7c\u00e3ao constante a melhor op\u00e7ca\u00e3o de controle \u00ed exigir que as vari\u00edveis do processo sejam mantidas em uma faixa estreita em torno de um setpoint fixo. Para uma vaz\u00e3o de fluido oscilat\u00edoria um melhor resultado \u00ede obtido permitindo uma maior osci-la\u00e7c\u00e3ao das varia\u00edveis controladas em torno do ponto de opera\u00e7ca\u00e3o, de tal forma que o separador funciona como um filtro para as perturbac\u00e7\u00e3oes.\nO detector de perturbac\u00e7\u00e3ao \u00ede uma ferramenta importante para a implementa\u00e7ca\u00e3o da estrat\u00edegia de controle. Portanto, a faixa em que \u00ede permitida a varia\u00e7ca\u00e3o das vari\u00edaveis controladas depende da amplitude das oscila\u00e7\u00f5es na entrada do separador. Esta estrategia garante o melhor desempenho de controle independentemente do regime de fluxo na alimenta\u00e7c\u00e3ao do separador.\nFoi realizado um ensaio com 38, 88 horas de dura\u00e7\u00e3o onde na primeira metade o separador de foi controlado com o controlador por bandas, e a partir do tempo 19, 44 horas at\u00ede o fim, foi utilizada a estrat\u00edegia de controle proposta. Para obter um chaveamento suave entre as duas estrat\u00edegias de controle, entre os intervalos de tempo de 13, 88 a 25, 00 horas, foi aplicada uma vaz\u00e3ao de alimenta\u00e7c\u00e3ao constante. Entre os intervalos de 16, 66 e 22, 22 horas foi aplicado um degrau nas vaz\u00e3oes de alimenta\u00e7ca\u00e3o. Os par\u00eaametros dos controladores s\u00e3ao os mesmos\napresentados nas tabelas 5.6, 5.5 e 5.11.\nE apresentada na figura 5.23 a resposta das variaveis de processo com suas respectivas faixas e setpoints. Na figura 5.24 sao apresentadas as vaz\u00f5es de alimenta\u00e7\u00e3o e as vaz\u00f5es de sa\u00edda.\n\\AvAaAA/WUVVVVVVVVV\\Pv/^-\n0.2\n\n0.2\ni\ti\ti\ti\ti\ti\tr\n\u2022JVAAAWAAAAAAAAAAAPw^- - -..........\u2014\u2014i\ni i i i i v \" T i\n0\t5\t10\t15\t20\t25\t30\t35\ntempo (horas)\nfill\t\u25a0MH\t ?\t\nHITO uyyyi\t1.111 1\t\n0\t5\t10\t15\t20\t25\t30\t35\ntempo (horas)\ni\ti\ti\ti\ti\ti\tr\n12.8\n12.6\nO. 12.4\n12.2\n12\ni i i i L\n5\t10\t15\t20\t25\t30\t35\ntempo (horas)\n0\nFigura 5.23: Vari\u00f3veis de Processo\n0\t5\t10\t15\t20\t25\t30\t35\ntempo (horas)\n0.022\ntempo (horas)\n25\t30\t35\n\n\n\n\n\n\nFigura 5.24: Vaz\u00f5es e alimentacao e sa\u00edda do separador\nSao apresentados na tabela 5.13 dados referentes \u00e0s oscilac\u00f5es percentuais e variancia das vazoes de sa\u00e1da do separador trifasico para cada controlador. O maior amortecimento das oscila\u00e7\u00f5es na vaz\u00f5o de sa\u00e1da de \u00e1gua \u00e1 obtido pelo controlador proposto com um fator de 7, 29\ncontra 3, 34 do controlador por bandas. o controlador proposto tambem apresentou uma menor varia\u00e2ncia na mesma vaza\u00e3o. E possivel verificar na figura 5.24 que, desde os instante 22, 51 horas a vaz\u00e3o de sa\u00edda de agua permanece constante ate que o final do teste, portanto, resultando em 10, 82 horas de sem nenhuma oscilac\u00e7\u00e3ao.\nTabela 5.13: Indices de Desempenho - Golfadas\nControlador\tVaz\u00e3ao\tOscilac\u00e3o (%)\tVari\u00e2ncia\n\tWout\t6, 27\t2, 3366 \u2022 10-8\nBandas\tLout\t65, 76\t1, 5443 \u2022 10-6\n\tGout\t32, 45\t1, 5589 \u2022 10-4\n\tWout\t2, 88\t2, 5775 \u2022 10-9\nPNMPC Proposto\tLout\t27, 49\t2,4778\u202210-6\n\tGout\t32, 45\t1, 3945 \u2022 10-4\nS\u00e3o apresentados na tabela 5.14 a variancia da vaz\u00e3o das tr\u00e2s sa\u00eddas do separador trifasico para cada controlador. Esta tabela contem informa\u00e7\u00e3es do per\u00edodo do ensaio onde n\u00e3o houve a presen\u00e7a de perturba\u00e7\u00e3es atuando no processo. Os \u00edndices expostos na tabela mostram que o controlador proposto obteve melhores resultados do que o controle por bandas, alem disso, ele mantem as vazo\u00e3es de sa \u00edda mais constantes e estabiliza as variaveis de processo com menor tempo de acomoda\u00e7c\u00e3ao, como pode ser observado na figura 5.23.\nTabela 5.14: Indices de Desempenho - Regime Permanente\nControlador\tVaz\u00e3ao\tVaria\u00e2ncia\n\tWout\t6, 5992 \u2022 10-8\nBandas\tLout\t1, 7679 \u2022 10-7\n\tGout\t2,4218\u202210-5\n\tWout\t2,1662\u202210-8\nPNMPC Proposto\tLout\t2, 3254 \u2022 10-8\n\tGout\t2,4137\u202210-5\nDe acordo com os resultados da simula\u00e7ao obtidos pode-se concluir que o uso da estrategia proposta permite um melhor amortecimento das perturba\u00e7c\u00e3oes do que outros controladores e tambem propor-\nciona um melhor desempenho quando o processo opera em condi\u00e7\u00f5es est\u00e1veis.\n5.4\tControle do Sistema Integrado (Separador + Hidrociclone)\nNesta se\u00e7ao ser\u00f5o apresentados os resultados oriundos do ensaio de controle com o sistema integrado (separador + hidrociclone). Foram utilizados os mesmos controladores e sinais de vazao de alimenta\u00e7\u00f5o do separador do ensaio da se\u00e7ao 5.3. Para predi\u00e7\u00f5o foram utilizados o modelo fenomenologico simplificado do separador e um modelo est\u00e1tico que relaciona a queda de press\u00f5o no overflow do hidrociclone com a vaz\u00f5o de sa\u00edda do overflow, vide equa\u00e7ao 2.48. A exemplo da se\u00e7\u00f5o\n5.3,\tna primeira metade do ensaio o separador foi controlado com o controlador por bandas, e a partir do tempo 19, 44 horas ate o fim, foi utilizado o controlador PNMPC.\nOs par\u00e2metros do controlador por bandas s\u00f5o os mesmos apresentados na tabela 5.6. Para o controlador PNMPC por zonas foram utilizados os par\u00e2metros das tabelas 5.5 e 5.11. Como o modelo da diferen\u00e7a de press\u00f5o no overflow do hidrociclone \u00e1 um modelo est\u00e1tico, foram utilizados os mesmos valores para os horizontes de predi\u00e7c\u00f5ao e controle sendo, N = Nu = 1.\nSao apresentados nas figuras 5.25, 5.26 e 5.27, respectivamente a resposta das vari\u00e1aveis de processo, as vaz\u00f5oes de alimenta\u00e7c\u00f5ao e as vaz\u00f5oes de sa\u00e1da do separador, e as efici\u00e2encias e concentra\u00e7c\u00f5ao de \u00e1oleo no underflow do hidrociclone.\ni \u201d06sJ''\\pAAM/'AAAAAAAAAAAA/\\.z'xy-Xy''x.-.\n\n1\n1\nI\n20\ntempo (horas)\nI\n\n30\n35\n\n\n\n1\n1\nl\n30\nl\n35\n30\n35\n20\ntempo (horas)\n\n\n\n\nFigura 5.25: Vari\u00e1veis de Processo\nFigura 5.26: Vaz\u00f5es e alimenta\u00e7\u00e1o e sa\u00edda do separador\n\ni\ti\ti\ti\nx\u00c27Ma/WWwvvvvvV\\Aa^\n_'___I___I____I____L_\n\n\n\n\n20\ntempo (horas)\n\n\n\n\u00e2 0.68\n05\t0.66\nx 10-6\n4]------\nJ I I I\n5\t10\t15\t20\ntempo (horas)\nL\n1\nL\nO Z 2 o o\n1\n1\n1\nI\n20\ntempo (horas)\nL\n1\n1\n\n\n\n\n\nFigura 5.27: Efici\u00eancias e concentra\u00e7ao de \u00e1leo no underflow do hidrociclone\nAnalisando os gr\u00e1ficos apresentados acima \u00e9 possivel verificar que apesar do controlador PNMPC fornecer uma vaz\u00e3ao constante por longos per\u00edodos de tempo para o hidrociclone, a efici\u00e2ncia de separac\u00e3o deste equipamento se torna mais oscilatoria que na metade do ensaio onde atua o controle por bandas. Isso se deve ao fato que o controlador PNMPC permite uma oscila\u00e7ao do n\u00edvel de agua do separador ao longo de toda faixa, o que acarreta uma varia\u00e7c\u00e3ao na distribui\u00e7ca\u00e3o de gotas na sa\u00edda do separador.\nNa figura 5.28 sao apresentadas as distribuicoes de gotas na sa\u00edda do separador em tr\u00e2s instantes de tempo. Nota-se que quando o n\u00edvel esta pr\u00f3ximo ao limite inferior da faixa (tempo de 29horas) aumenta o volume de gotas de oleo na sa\u00edda do separador, e quando ocorre a situac\u00e3o contraria, ou seja, n\u00edvel de agua proximo ao limite superior da faixa o volume de gotas de oleo diminui (tempo de 35horas). Deve-se ressaltar que para os tr\u00e2es instantes de tempo que foram apresentadas as curvas de distribui\u00e7ao de gotas a vazao de alimentac\u00e3o \u00e9 a mesma, como pode ser visto na figura 5.26.\nFigura 5.28: Distribui\u00e7\u00e3o das gotas na sa\u00edda do separador trifasico\nCom base na an\u00e1lise realizada anteriormente conclui-se que o ideal \u00e9 assumir um compromisso entre a largura da faixa utilizada e o amortecimento das oscilacoes na vazao de sa\u00edda do separador. Dessa forma acredita-se que \u00ed poss\u00edvel chegar a um ponto onde n\u00e3o haja uma varia-c\u00e3o significativa na distribuyo de gotas de oleo na entrada do hidroci-clone e consequentemente a oscilac\u00e3o das eficiencias e concentra\u00e7ao de oleo no underflow seja m\u00ednima.\nForam realizados dois ensaios onde a largura da faixa de oscilac\u00e7\u00e3ao permitida para o n\u00edvel de \u00edgua foi alterado de forma a verificar o efeito na separa\u00e7\u00e3o do hidrociclone. Sao apresentados nas figuras 5.29, 5.30 e 5.31 os resultados gr\u00e1ficos obtidos utilizando uma largura de faixa igual a 0, 2m.\n1\n8 10\ntempo (horas)\n0\t2\t4\t8\t8\t10\t12\t14\t18\t18\ntempo (horas)\n\n\n\n\n\n\n\n\n\n\n\u25a1\n\n0\t2\t4\t8\t8\t10\t12\t14\t18\t18\ntempo (horas)\nFigura 5.29: Variaveis de Processo\nf\n\u00ed\n8\t10\t12\t14\t18\t18\ntempo (horas)\n\n\n\nX/\n\nFigura 5.30: Vaz\u00f5es e alimenta\u00e7\u00e3o e sa\u00edda do separador\n0\t2\t4\t6\t8\t10\t12\t14\t16\t1t\ntempo (horas)\nFigura 5.31: Efici\u00eancias e concentra\u00e7\u00e3o de \u00f3leo no underflow do hidrociclone\nSao apresentados nas figuras 5.29, 5.30 e 5.31 os resultados gr\u00e1ficos obtidos utilizando uma largura de faixa igual a 0,1m.\ntempo (horas)\nFigura 5.32: Vari\u00e1veis de Processo\ni\nf\na\t10\t12\t14\t16\t18\ntempo (horas)\nFigura 5.33: Vazoes e alimenta\u00e7ao e sa\u00edda do separador\nL\nL\nL\nJ I\n8\t10\ntempo (horas)\n1\nl\n1\n066\nL\nL\nL\nJ I\n8\t10\ntempo (horas)\n1\n1\n1\n1\nO\nZ 1 -o o\n\nL\nL\nL\nJ I\n8\t10\ntempo (horas)\n1\n1\n1\n1\n\n\n\n\n\n\n\n\n\n\nFigura 5.34: Efici\u00eancias e concentra\u00e7\u00e3o de oleo no underflow do hidrociclone\nAnalisando os resultados apresentados anteriormente \u00e1 poss\u00edvel verificar que a medida que a largura da faixa \u00e9 reduzida, diminui o amortecimento das oscila\u00e7\u00f5es na vaz\u00e3o de sa\u00edda de agua do separador, porem reduz a oscilacao das efici\u00eancias de separacao do hidrociclone e consequentemente da concentrac\u00e3o de oleo no underflow.\nAcredita-se que uma soluc\u00e7\u00e3ao seja utilizar uma camada de otimi-za\u00e7ao superior que forne\u00e7a ao controlador PNMPC a largura de faixa que maximize a efici\u00eaencia de separa\u00e7c\u00e3ao do hidrociclone. Porem realizar uma otimiza\u00e7ca\u00e3o no modelo da efici\u00eaencia do hidrociclone pode ser uma\n5.4. Controle do Sistema Integrado (Separador + Hidrociclone)\ntarefa \u00e1rdua uma vez que os c\u00e1lculos s\u00e3o de grande complexidade.\nSao apresentados em [40] e [28] correla\u00e7\u00e3es que relacionam a varia\u00e7\u00e3o da vaz\u00e3o de alimentac\u00e3o e da razao de split no hidrociclone com a efici\u00eancia de separac\u00e3o. Por\u00e1m essas correla\u00e7\u00f5es assumem uma curva de distribui\u00e7\u00e3o de gotas de \u00e1leo na entrada do hidrociclone constante. Sugere-se para trabalhos futuros o desenvolvimento de uma correla\u00e7ao que relacione a varia\u00e7\u00e3o do n\u00edvel de agua no separador, a vaz\u00e3o de alimenta\u00e7ao do hidrociclone e a raz\u00e3o de split no mesmo com a eficiencia de separa\u00e7ao. Acredita-se que com uma equa\u00e7\u00e3o simplificada que possua estas caracter\u00edsticas seja poss\u00edvel implementar a camada de oti-miza\u00e7ao proposta. Uma outra alternativa a ser estudada \u00e1 a variac\u00e3o do split de forma a compensar os efeitos de varia\u00e7ca\u00e3o da distribui\u00e7ca\u00e3o de gotas na entrada do hidrociclone.\n5.4.1\tComentarios Finais\nNeste cap\u00edtulo foram apresentados os resultados dos ensaios de controle realizados em um primeiro momento somente com o separador e posteriormente com o sistema integrado. Foi realizada uma an\u00e1lise comparativa entre os controladores visando apontar o que obteve melhor desempenho. Foram constatados problemas referentes a oscila\u00e7c\u00e3ao da efici\u00eaencia de separac\u00e7a\u00e3o do hidrociclone e propostas para resolu\u00e7c\u00e3ao deste foram apresentadas. No pr\u00e1oximo cap\u00e1tulo ser\u00e3ao abordados aspectos te\u00f3ricos e aplica\u00e7ao do controlador PI com sintonia via MPC por zonas.\n100\n5. Resultados de Simula\u00e7ao\nCap\u00edtulo 6\nControlador PI com sintonia via MPC por Zonas\nNo cap\u00edtulo anterior foram apresentados os resultados obtidos com os controladores PNMPC e PI por bandas. No presente cap\u00edtulo se-rao apresentados os princ\u00edpios te\u00f3ricos do controlador PI com sintonia via MPC por zonas e experimentos praticos aplicados ao controle do separador trifasico. Este controlador foi concebido com o intuito de proporcionar as mesmas caracter\u00edsticas do controle MPC por zonas a um controlador PI, desse modo \u00e9 poss\u00edvel obter um controlador simples e eficiente.\n6.1\tFundamenta\u00e7\u00e3o Te\u00e1rica\nSera apresentado nesta se\u00e7\u00e3o o procedimento de sintonia do controlador PI utilizando o procedimento de otimiza\u00e7c\u00e3ao de um controlador MPC por zonas. De acordo com [24], \u00e9 possivel obter a sintonia de controladores classicos atraves do preditor utilizado pelo algoritmo GPC. A ordem do controlador esta diretamente ligada a ordem do modelo utilizado, assim, para um modelo de primeira ordem o controlador resultante e um PI.\nPara realizar este procedimento e necessario um modelo linear. Porem no controle por zonas, \u00e9 permitido que o processo funcione dentro de uma faixa, ao inves de um unico ponto de equil\u00edbrio. Neste caso\no mais apropriado \u00e9 a utiliza\u00e7\u00e3o de um modelo nao linear que pode representar melhor o processo em toda sua faixa de funcionamento. Como visto o controlador PNMPC realiza o procedimento de lineariza\u00e7\u00e3o do modelo n\u00e3o linear a cada per\u00edodo de amostragem. Em uma tentativa de adicionar as caracter\u00edsticas do controlador PNMPC por Zonas ao controlador PI, ser\u00e3o utilizados tr\u00eas modelos linearizados nos limites superiores e inferiores da zona e num ponto intermedi\u00edario entre os limites da zona.\nDe acordo com o apendice B, o modelo linearizado simplificado do separador trif\u00edasico \u00ede descrito por\n0\nK22 s\n0\n0\n0\nK33\n\t\u25a0 Wout \u25a0\n\tGOU\u00cd\n\tGout\n(6.1)\ns\nsendo que o valor dos ganhos das fun\u00e7\u00e3es de transfer\u00eancias podem variar de acordo com o ponto de equil\u00edbrio onde ocorre a lineariza\u00e7\u00e3o.\nO controle por zonas e utilizado somente no n\u00edvel de \u00e1gua e \u00f3leo, sendo que a pressa\u00e3o \u00ede mantida constante por um controlador PI de setpoint fixo. O desenvolvimento matem\u00edatico para a sintonia do controlador PI via MPC ser\u00eda demonstrado apenas para uma das func\u00e7\u00e3oes de transfer\u00eaencia da matriz de transfer\u00eaencia apresentada na equac\u00e7\u00e3ao 6.1.\nAssume-se que o processo \u00e1 descrito pela seguinte fun\u00e7\u00e3o de trans-fer\u00eaencia\nG(s) = -\t(6.2)\ns\nDiscretizando tem-se\nG(z) =\t(6.3)\n1 \u2014 z 1\nComo o controlador GPC utiliza o modelo CARIMA, ent\u00e3o o modelo \u00ede reescrito\nA(z-1)y(t) = B(z-1)z-du(t \u2014 1) + TDZz-i)A\t(6.4)\nonde A = 1 \u2014 z-1, d \u00e1o atraso de transporte e e(t) \u00e1 um ru\u00eddo branco. Os polin\u00eamios T(z-1) e D(z-1) representam a caracter\u00edstica estoc\u00e1astica do ru\u00e1do e como sa\u00e3o dif\u00e1ceis de serem estimados na pr\u00e1atica, \u00ed comum utilizar T(z-1) = 1 e D(z-1) = 1. Neste caso a equacao 6.4\npode ser reescrita como\nA(z-1)y(t) = B(z-1)z-d Au(t \u2014 1) + e(t)\t(6.5)\nonde A(z-1) = AA(z-1). Para o modelo da equac\u00e3o 6.3 temos A(z-1) = (1 \u2014 z-1)(1 \u2014 z-1) = 1 \u2014 2z-1 + z-2, B(z-1) = Kd = b0 e d = 0.\nAs predic\u00e3es podem ser obtidas resolvendo seguinte equac\u00e3o Di-ofantina\n1= A(z-1)E3 (z-1) + z-jFj (z-1)\t(6.6)\nonde Ej (z-1) possui o grau j \u2014 1 e Fj (z-1) possui o grau na.\nResolvendo recursivamente a Diofantina N vezes, onde N \u00e9 o horizonte de predi\u00e7\u00e3o, obtem-se\ny(t + i|t) y(t + 2|t)\t= G\tAu(t) Au(t + 1)\t+ H\tAu(t \u2014 1) Au(t \u2014 2)\n_ y(t + N|t) _\t\tAu(t + N \u2014 1)\t\tAu(t \u2014 nb)\n(6.7)\ny(t|t) y(t - i|t)\ny(t \u2014 na\\t)\nonde G, H e S s\u00e3o matrizes constantes com dimens\u00e3es N x N, N x nb e N x na +1. Como no modelo da equa\u00e7\u00e3o 6.5 tem-se nb = 0, as predi\u00e7c\u00e3oes n\u00e3ao dependem dos valores passados de Au e H = 0.\nDe acordo com [24] a fun\u00e7\u00e3o objetivo a ser minimizada \u00e9 descrita por\nJ = (Gu + Syi \u2014 w)T Qs (Gu + Syi \u2014 w) + uTQ\\u\t(6.8)\nonde Qs e Q\\ sao matrizes de pondera\u00e7\u00e3o diagonais com os elementos 5(j) e X(j) respectivamente.\nMinimizando J em rela\u00e7\u00e3o a u, tem-se\nonde M = GTQsG + Qx e P2 = GTQs s\u00e3o de dimens\u00e3o N x N e Po = -GTQsS possui dimens\u00e3o N x nb.\nEm um algoritmo de receding horizon \u00e9 calculado somente o valor de Au(\u00ed), e se mea primeira linha da matriz M, Au(\u00ed) \u00e9 dado por\nAu(t) = mPoy1 + mP2w\t(6.10)\nonde mPo = [lyily2 \u25a0 \u25a0 \u25a0 lyna+i] e mP2 = [ff ... fN]. Os coeficientes ly e f sao fun\u00e7\u00e3o de a\u00bf, bj, N, 5i e A\u00bf.\nSegundo [24] a fun\u00e7\u00e3o de transferencia discreta do controlador PI e dada por\nC (z) = -\nlyi + iy2 z 1\n1- z-1\n(6.11)\nO controlador da equa\u00e7\u00e3o 6.11 pode ser representado pela seguinte equac\u00e7\u00e3ao a diferen\u00e7cas\nu(k) = u(k \u2014 1) + qoe(k) + qi e(k \u2014 1)\t(6.12)\nonde qo = \u2014 lyi e qi = \u2014ly2.\nNo controle MPC por zonas a matriz de pondera\u00e7\u00e3o Qs \u00e9 zerada se a variavel controlada esta dentro da faixa e assume um valor ajustado se a variavel controlada sai para fora da faixa. O efeito obtido com esta tecnica e que dentro da faixa o controle fica \u201d\u2018livre\u201d\u2019, ou seja, em malha aberta e permite a oscilac\u00e3o da variavel controlada. Fora da faixa o controlador pondera o erro sendo que o setpoint e o limite da faixa, nessa situac\u00e7\u00e3ao o controle e feito em malha fechada.\nEste conceito pode ser traduzido para a sintonia do controlador PI, sendo que para o modelo linearizado dentro da faixa a matriz de pondera\u00e7\u00e3o Qs \u00e9 zerada, logo M = Q\\, P2 = 0 e Po = 0, o que implica nos coeficientes ly1 = ly2 = 0 e a equacao 6.12 \u00e9 reescrita como\nu(k) = u(k \u2014 1)\t(6.13)\nNota-se que na equac\u00e7\u00e3ao 6.13 n\u00e3ao e considerado o erro entre a variavel de processo e um setpoint. Enquanto a variavel controlada estiver dentro da faixa o controle sera constante e igual ao valor anterior, o que consiste em operar o processo em malha aberta.\nPara os dois modelos linearizados nos limites superiores e inferiores da faixa, o controlador obtido \u00e9 o mesmo da equa\u00e7ao 6.12. Neste caso o controle e realizado em malha fechada da mesma forma que o MPC por zonas. Para implementar esta estrategia de controle se faz necessario um controle supervisorio que monitora o valor da variavel\ncontrolada e determina qual das a\u00e7c\u00e3oes de controle deve ser aplicada.\n6.2\tEnsaio com PI com sintonia via MPC por Zonas\nA seguir s\u00e3ao apresentados os resultados obtidos no ensaio realizado utilizando o controlador PI com sintonia via MPC por zonas. O ajuste dos par\u00eametros do controlador \u00e1 apresentado na tabela 6.1. Para a sintonia dos par\u00eaametros do controlador foram utilizados os mesmos horizontes e pondera\u00e7\u00f5es do controlador PNMPC por zonas (tabela 5.5 do cap\u00e1tulo 5). Esta tecnica de controle foi aplicada somente aos n\u00e1veis da a\u00e1gua e do \u00e1oleo, sendo que para press\u00e3ao foi utilizado um controlador PI com setpoint fixo.\nTabela 6.1: Par\u00e2metros de Ajuste do Controlador\nVaria\u00edveis\tqo\tqi\nDentro da Zona\t\t\nhw\t0\t0\nhl\t0\t0\np\t0.124366\t\u20140.062195\nLimite superior da Zona\nhw\t0.018277\t\u20140.017027\nhl\t0.218717\t\u20140.135130\np\t0.124366\t\u20140.062195\nLimite Inferior da Zona\t\t\nhw\t0.022873\t\u20140.017027\nhl\t0.182294\t\u20140.107990\np\t0.124366\t\u20140.062195\nE apresentada na figura 6.1 a resposta das vari\u00e1veis de processo com suas respectivas faixas. Na figura 6.2 sao apresentadas as vazoes de alimenta\u00e7\u00e3o e as vaz\u00f5es de sa\u00e1da.\n12.4\n12.2 -\n11.8o\n12\n1\n2\n3\ntempo (horas)\n\n\nFigura 6.1: Variaveis de Processo\nFigura 6.2: Vaz\u00f5es e alimentacao e sa\u00edda do separador\nA tabela 6.2 cont\u00e9m dados referentes \u00e0s oscila\u00e7\u00f5es percentuais das vaz\u00f5es de entrada e sa\u00edda do separador trifasico e a variancia das vaz\u00f5es de sa\u00edda para cada ensaio de controle realizado. Foram utilizados os mesmos sinais das secao 5.1 para as vaz\u00f5es de alimenta\u00e7\u00e3o do separador trifasico.\nTabela 6.2: Indices de Desempenho\nControlador\tVazao\tOscilac\u00f5o (%)\tVariancia\n\tWin\t21, 01\t-\n-\tLin\t15, 29\t-\n\tGin\t32, 45\t-\n\tWout\t3, 74\t1,4793 \u2022 10-10\nPI via MPC\tLout\t36, 06\t2,2177\u202210-6\n\tGout\t32, 45\t2,3666\u202210-4\n\tWout\t4, 00\t5, 7803 \u2022 10-9\nPNMPC Zona\tLout\t31, 00\t2, 5111 \u202210-6\n\tGout\t32, 45\t1,4590 \u2022 10-4\n\tWout\t6, 27\t3,5313\u202210-8\nBandas\tLout\t65, 76\t1,5216\u202210-6\n\tGout\t32, 45\t1,6118\u202210-4\nAtrav\u00e9s dos dados apresentados na tabela 6.2 \u00e9 poss\u00edvel verificar que o controlador PI com sintonia via NMPC por zonas obteve \u00f3timos resultados com amortecimento das oscilac\u00f5es com um fator de 5, 6 e uma variancia de 1, 4793 \u2022 10-10. Se comparado com os resultados dos controladores apresentados no item 5.1.4, pode-se afirmar que este foi o controlador que obteve melhor desempenho no amortecimento de oscila\u00e7\u00f5es de carga.\nA principal vantagem deste controlador e o fato de ser de facil implementa\u00e7\u00f5o, uma vez que nao exige otimiza\u00e7ao online, e pode ser implementado em dispositivos programaveis como um CLP. A desvantagem deste controlador \u00e9 que este n\u00f5o trata o problema de controle atraves de uma estrategia multivari\u00e9vel e n\u00f5o utiliza as restri\u00e7\u00f5es f\u00e9sicas do processo. O controlador PI com sintonia via MPC por zonas pode ser uma alternativa ao controlador PNMPC por zonas em situa\u00e7oes onde o poder computacional seja limitado.\n6.3\tComentarios Finais\nNeste cap\u00e9tulo foi discutido o desenvolvimento matematico do controlador PI com sintonia via MPC por zonas. Foi realizado um ensaio de simula\u00e7c\u00f5ao onde o controlador foi aplicado ao separador trif\u00e9a-sico com o objetivo de amortecer as oscila\u00e7co\u00f5es de carga. Os resultados dos ensaios de controle se mostraram promissores e os \u00e9ndices de de\nsempenho obtidos foram melhores que os dos controladores do cap\u00edtulo anterior. O desenvolvimento deste controlador \u00e9 uma das principais contribui\u00e7\u00f5es deste trabalho e mostra um grande potencial para sua aplicac\u00e3o na industria do petr\u00e9leo, uma vez que \u00e9 de f\u00e9cil implementa-c\u00f5o e baixo custo computacional.\nCap\u00edtulo 7\nConclus\u00e3o\nEste trabalho aborda o estudo e o controle de processos de se-para\u00e7ca\u00f5o trifa\u00e9sica e tratamento de a\u00e9gua presentes em uma plataforma de produc\u00e7\u00f5ao de petr\u00e9oleo. Este processo \u00e9e composto por um separador trif\u00e9sico e uma bateria de hidrociclones conectada na sa\u00edda de \u00e9gua do separador. Foram desenvolvidas duas estrategias de controle, sendo a primeira baseada no controlador pr\u00e9atico preditivo n\u00f5ao-linear conhecido como PNMPC. Este controlador se difere de outros controladores preditivos n\u00f5ao lineares pelo fato de realizar a lineariza\u00e7ca\u00f5o do sistema independentemente do ponto de equil\u00e9brio. Foram abordados os m\u00e9todos para utiliza\u00e7\u00e3o de restri\u00e7\u00f5es hard e soft em controladores preditivos, bem como a implementa\u00e7ao do controle por zonas. Dois tipos de modelos de predic\u00e7a\u00f5o na\u00f5o-lineares foram estudados, sendo eles o modelo Hammerstein e um modelo fenomenologico simplificado do separador. Algumas ferramentas foram desenvolvidas com a finalidade de melhorar o tratamento das perturba\u00e7\u00f5es pelo controlador PNMPC, sendo elas o estimador de perturba\u00e7c\u00f5oes, o preditor de perturba\u00e7c\u00f5oes e o detector de perturbac\u00e7\u00f5oes. A segunda estrat\u00e9egia de controle utilizada neste trabalho consiste de um conjunto de controladores PI com sintonia via MPC, a qual \u00e9e de grande simplicidade de implementa\u00e7c\u00f5ao.\nForam realizados ensaios de simula\u00e7c\u00f5ao visando avaliar o desempenho dos controladores com o sistema operando sob o regime de golfadas e perturba\u00e7c\u00f5oes do tipo degrau na alimentac\u00e7\u00f5ao. Os resultados obtidos foram comparados com o controlador PI por bandas que \u00e9e atualmente utilizado pela Petrobras para o amortecimento de oscila\u00e7c\u00f5oes de carga. Verificou-se em ambos ensaios que o controlador PNMPC por zonas utilizando o modelo fenomenol\u00e9ogico obteve os melhores resultados.\nAs principais contribuic\u00e7o\u00e3es deste trabalho sera\u00e3o relacionadas a seguir:\n\u2022\tAplica\u00e7\u00e3o de controle preditivo n\u00e3o linear ao controle do separador trif\u00edsico e hidrociclone;\n\u2022\tIdentificac\u00e3o de modelos Hammerstein do separador;\n\u2022\tDesenvolvimento do estimador de perturba\u00e7\u00f5es;\n\u2022\tDesenvolvimento do controlador PI com sintonia via MPC por zonas.\nCom rela\u00e7ca\u00e3o a utiliza\u00e7c\u00e3ao do controlador PNMPC no controle de separadores e hidrociclones deve-se destacar que n\u00e3ao existe na literatura registros da aplica\u00e7c\u00e3ao de um controlador preditivo n\u00e3ao-linear a este problema. Este controlador apresentou bons resultados nas diferentes configura\u00e7c\u00e3oes propostas o que torna grande candidato a sua aplica\u00e7ca\u00e3o no meio industrial. A identifica\u00e7c\u00e3ao do modelo de Hammerstein al\u00edem de contribuir na implementac\u00e7\u00e3ao do controlador PNMPC se mostra inovadora, uma vez que na literatura s\u00e3ao somente encontrados modelos caixa preta lineares do separador. O desenvolvimento do estimador de perturba\u00e7c\u00e3oes possibilitou a utiliza\u00e7ca\u00e3o dos valores estimados das vaz\u00e3oes de alimenta\u00e7c\u00e3ao pelo controlador PNMPC, uma vez que essas grandezas n\u00e3ao podem ser medidas separadamente. Com o uso do estimador foram obtidos os melhores resultados de forma a melhorar o tratamento das perturba\u00e7\u00f5es pelo controlador PNMPC. Uma grande contribui\u00e7\u00e3o deste trabalho \u00ede o desenvolvimento do controlador PI com sintonia via MPC por zonas, o qual teve por objetivo agregar as caracter\u00edsticas do controle MPC por zonas a um controlador PI. Dessa forma foram obtidos \u00edotimos resultados referentes ao amortecimento de oscilac\u00e7\u00e3oes, compar\u00eda-veis aos do controlador PNMPC e superiores aos do controlador PI por bandas. Uma vantagem deste controlador \u00ede a simplicidade de imple-menta\u00e7c\u00e3ao podendo ser facilmente programado em dispositivos como os CLP's, o que o torna forte candidato a aplica\u00e7\u00e3es pr\u00edticas e substituto do controlador PI por bandas.\nComo contribui\u00e7c\u00e3ao para o estudo de controle avan\u00e7cado de processos de separac\u00e7\u00e3ao em plataformas de petro\u00edleo, este trabalho gerou as seguintes publicac\u00e7\u00e3oes:\n\u2022\tP. R. C. Mendes, R. L. Carvalho and J. E. Normey-Rico. Nonlinear predictive control applied to load oscillations damping in a three phase separator. Rio Pipeline Conference &amp; Exposition, 2011, Rio de Janeiro/RJ - Brasil;\n\u2022\tP. R. C. Mendes, J. E. Normey-Rico, A. Plucenio and R. L. Carvalho. Disturbance Estimator based Non Linear MPC of a Three Phase Separator. International Symposium on Advanced Control of Chemical Processes, 2012, Simgapore. (aceito para publica\u00e7\u00e3o)\n\u2022\tP. R. C. Mendes, J. E. Normey-Rico, A. Plucenio. Controle PI com sintonia via MPC por zonas. XIX Congresso Brasileiro de Autom\u00e9tica, 2012, Brasil. (submetido)\n7.1\tDiretrizes para Trabalhos Futuros\nOs Processos de separa\u00e7ca\u00e3o estudados neste trabalho representam somente uma parte dos equipamentos existentes em plataformas de petr\u00e9oleo. Existe muito trabalho a ser realizado na a\u00e9rea de modelagem fenomenol\u00e9ogica dos processos envolvidos na separa\u00e7c\u00e3ao e tratamento de \u00e9agua, o\u00e9leo e g\u00e9as. Pensando nisto, elaborou-se uma lista de poss\u00e9veis temas de pesquisa a serem realizadas futuramente com o objetivo de estudar melhor o comportamento dos processos de uma plataforma de produc\u00e7\u00e3ao de petr\u00e9oleo, simula\u00e9 los em ambiente computacional e estudar t\u00e9ecnicas de controle eficientes.\n\u2022\tTestar o desempenho do controlador PNMPC perante a um sistema mais real\u00e9stico de tratamento de \u00e9agua apresentado em [40]. Este sistema \u00e9e composta pelo separador trif\u00e9asico e por tr\u00eaes tipos diferentes de hidrociclones, o BOW (Bulk Oil-Water Cyclone), o PDC (Pre Deoiler Cyclone) e o De-oiler.\n\u2022\tAvan\u00e7car nos estudos de modelagem fenomenol\u00e9ogica tentando adicionar ao modelo do separador trif\u00e9asico os efeitos causados pelo fen\u00eameno de flashing. Dessa forma pode-se determinar a porcentagem de ga\u00e9s que sai juntamente com a vaz\u00e3ao de o\u00e9leo e a quantidade de o\u00e9leo dispersa na vaz\u00e3ao de sa\u00e9da de g\u00e9as. Com esse c\u00e9alculo ser\u00e9a poss\u00e9vel acoplar mais vasos separadores em s\u00e9erie, possibilitando simular um esquema de separa\u00e7c\u00e3ao em tr\u00eaes etapas.\n\u2022\tAcoplar o conjunto separador bifa\u00e9sico e tratador eletrosta\u00e9tico na sa\u00e9da de \u00e9oleo do separador trif\u00e9asico e efetuar seu controle.\n\u2022\tDesenvolver uma correlac\u00e7\u00e3ao que relacione a varia\u00e7c\u00e3ao do n\u00e9vel de \u00e9agua no separador com a vaz\u00e3ao de alimenta\u00e7c\u00e3ao, a raz\u00e3ao de split e a efici\u00eancia de separa\u00e7\u00e3o do hidrociclone.\n\u2022\tRealizar ensaios com uma camada de otimiza\u00e7ao que forne\u00e7a a largura de faixa ou set-point de split para o controlador PNMPC.\n\u2022\tRealizar ensaios com a presen\u00e7a de ruido nas vari\u00e1veis controladas para verificar a robustez do estimador de perturba\u00e7\u00e3es perante a presen\u00e7ca de ruidos.\n\u2022\tAvaliar o desempenho dos controladores propostos com os \u00edndices apresentados nos trabalhos de [12] e [49].\n\u2022\tUtilizar os metodos de detecc\u00e3o de estado estacion\u00e1rio apresentados em ([19], [20] e [21]), e comparar seu desempenho com o detector de perturba\u00e7c\u00e3oes proposto neste trabalho.\n\u2022\tComparar o desempenho dos controladores propostos com o controlador apresentado em [4] e [3].\nAp\u00eandice A\nPar\u00e2metros de\nSimula\u00e7\u00e3o\nSeparador Trifa\u00e1sico\nDimens\u00e3es do separador:\nCcs = 4,4m Cd = 1,0m D = 1, 8m hchic = 0, 867m Cchic 07 9m hplaca 07 0017m B = 1,4m Cplaca = 47 2m\nPar\u00e2metros fisico-quimicos:\nT = 360K\nMWg = 16, 48 pw = 965kg/m3 pi = 855kg/m3 dl = 0, 855 dw = 0, 965 dg = 16,4/29 Yi = 855kgf/ m3 Yw = 965kgf/m3 pw = 0, 001kg/m/s pi = 0, 0171kg/m/s\npjus = 1, 0kgf/cm2 pcomp = 8, 5kgf /cm2\nDados das v\u00f3lvulas:\nCvmaxi = 44, 43 Cvmaxw = 36, 70\nCvmaxg\t74, 05\nsw\t5\nsi =0, 5 sg = 0, 5\nCondic\u00f5es na alimenta\u00e7\u00e3o:\nBSW =0,1\nTOG = 0,13\nWin = 0, 0133m3/s\nLin = 0,0167 m3/ s\nGin = 0, 1300m3/s Dp$o = 100p,m par = 3\nCondi\u00e7\u00f5es iniciais: ht = 0, 9143m hw = 0,4976m hl = 0, 4931m\nVwfics = 0,0228m3\nVffwcs = 0,0002m3\nVw fici = 0,0040m3 p = 12kgf /cm2\nHidrociclone\nDimensoes do hidrociclone: Rc = 0,0175m a = 0, 0015m\nL = 1, 337m rela = 0, 35\nParametros fisico-quimicos: pw = 965kg/m3 pi = 855kg/m3 di = 0, 855\ndw = 0, 965 gw = 0, 001kg/m/s\nOutros parametros:\nftr = 0,4\na1 = 780\na2 = 50000\nValvulas de controle:\nCvmaxo\nCvmaxu\n1, 85\n45\nso = 0, 5\nsu = 0, 5\nPressoes:\nPo = 1, 0kgf /cm2 Pu = 1, 0kgf/cm2 APo = 3, 5kgf/cm2 APU = 3, 5kgf/cm2\nPi = 10kgf/cm2\nValor desejado de R:\n= 2, 5\n116\nA. Parametros de Simula\u00e7ao\nAp\u00eandice B\nLineariza\u00e7\u00e3o do Modelo\nSimplificado do\nSeparador\nAseguir ser\u00e3o apresentados os passos para a linearizacao do modelo simplificado do separador trif\u00edsico. O modelo linearizado \u00ed importante para a sintonia do controlador PI com sintonia via MPC por zonas apresentado no cap\u00edtulo 6. Como apresentado no item 4.3, o modelo fenomenol\u00edgico do separador trif\u00edsico \u00ed constitu\u00eddo pelas equa\u00e7\u00e3es (B.1), (B.2), (B.3) e (B.4).\nI\tLweir Wout\t(b i )\n~dt _ 2 \u2022 Ccs\t(D - ht)\t( . 1\ndhw   f  \tWout\t(B 2)\n_ 1 _ 2 \u2022 Ccs ^h~( D - hw)\t( . 1\ndhl\tLweir\tLout\n~dt _ f2 _ 2 \u2022 Cci \u2022 ^hi \u2022 (D - hi)\t( . 1\ndp\t(Gin + Win + Lin\tG out\tWout\t^out1 ' p\ndt _ f3 _\n(B.4)\nVt - Vd - Vcs\nPara utilizac\u00e7\u00e3ao na sintonia do controlador PI com sintonia via MPC por zonas \u00ede nessess\u00edario somente um modelo linear que relacione as tr\u00eas entradas do processo, no caso as vaz\u00e3es de sa\u00edda, com as tr\u00eas\nsa\u00eddas do processo. Este modelo \u00e9 representado na equa\u00e7\u00e3o B.5.\nhw\t\tGii 0\t0\t\t\u2019 Wout \u2019\nhl\t=\t0\tG22\t0\t\tLout.\np\t\tG31\tG32 G33\t\tG out\nNota-se na matriz de transferencia que o sistema possui acoplamento somente entre as tr\u00eas entradas com a pressao no separador. Como as vaz\u00f5es de sa\u00e1da de \u00e1gua e \u00e1leo sao utilizadas \u00e1 utilizada para controlar respectivamente os n\u00edveis de \u00e1gua e \u00e1leo, a unica entrada dispon\u00edvel para controlar a press\u00e3o \u00e9 a vaz\u00e3o de sa\u00e1da de g\u00e1s. Portanto para fins de sintonia do controlador pode-se admitir uma simplifica\u00e7ca\u00f5o no sistema linearizado como apresentado na equa\u00e7\u00e3o B.6.\nhw\t\tGii\t0\t0\t\t\u25a0 Wout \u2019\nhl\t=\t0 G22\t0\t\tLout\np\t\t0\t0\tG33\t\tGout\nz\nB.1 Lineariza\u00e7\u00e3o do Balan\u00e7o de .Agua no Separador\nNota-se que a equa\u00e7\u00e3o B.2 apresenta tr\u00eas vari\u00e1veis din\u00e2micas, ou seja, que variam com o tempo (Win, Wout, hw). Como s\u00f3 interessa um modelo que relacione a entrada com a sa\u00e1da \u00e1e somente necess\u00e1ario derivar a equac\u00e3o B.2 em relac\u00e3o a (Wout, hw). Assim tem-se:\ndWout\t2 \u2022 Ccs \u2022\thw \u2022 (D \u2014 hw)\ndf1 _ \u2014((D \u2014 2 \u2022 hw) \u2022 (Win \u2014 Wout))\t(B 8)\ndhw 4 \u2022 Ccs \u2022y/(hw \u2022 (D \u2014 hw))3\t( . )\nA expansao da equac\u00e3o em serie de Taylor \u00e9 dada por:\n= fLIN = f+f\t\u2022 (Wout \u2014 Wout) + f \u2022 (hw \u2014 hw) (b.9)\ndt\tdW out\tdhw\nDefinindo a equa\u00e7\u00e3o em vari\u00e9veis desvio com rela\u00e7\u00e3o a um estado\nestacion\u00edario:\n' dfi '\tdfi\t'\nfi =\t\u25a0\t- \u2022 Wo.t +\nSeparando as variaveis:\ndhw\tw\n(B.10)\nf'- dfi -h =\nf 1\thw\n\u2022 w' t\nJL\tdhw\tw\tdWout\tout\nA fim de simplificar a nota\u00e7\u00e3o, omitiu-se o s\u00edmbolo (), por\u00e9m as vari\u00e1veis continuam em desvio em rela\u00e7\u00e3o ao estado estacionario. Aplicando a transformada de Laplace tem-se:\n(B.11)\nhw (s) \u2022 s - hw (s) \u2022\t= df1\t\u2022 ^bout(s)\ndhw\tdWout\nRearranjando os termos em forma de fun\u00e7\u00f5es de transfer\u00eancia:\n(B.12)\ndfi\nG11 =\t(b.13)\nS\tdhw\nAo substituir os valores de equil\u00edbrio na equa\u00e7\u00e3o B.13, sendo que \u00e9 realizada a suposi\u00e7\u00e3o que Win = Wout, tem-se que o termo do denominador dh1 e zerado, o que implica na seguinte fun\u00e7\u00e3o de transfer\u00eancia:\nGii\nKii\ns\n(B.14)\nonde\nKii =\ndfi dWout\n-1\n2 \u2022 Ccs \u2022 \\/hw \u2022 (D\thw)\n(B.15)\nB.2\nz\nLineariza\u00e7\u00e3o do Balan\u00e7o de Oleo no\nSeparador\nDa mesma forma como realizado na se\u00e7\u00e3o anterior a equa\u00e7\u00e3o B.3 sera diferenciada em rela\u00e7\u00e3o a (Lout, hl). Assim tem-se:\ndf2 =\t-1 Lout\t2 \u2022 Cci \u2022 \\/hi \u2022 (D - hi)\t(B.16)\ndf2\t(Lout\tLweir) \u2022 (D\t2 \u2022 hl) dhi\t4. Cci^ V(hi -(D - hi))3\t(B.17)\nA expans\u00e3o da equa\u00e7\u00e3o em s\u00e9rie de Taylor definida em vari\u00e1veis desvio com rela\u00e7\u00e3o a um estado estacionario \u00e9 dada por:\n,'\tdf2\t' _ df2\t'\nf2 \u2014\t\u2022 hl \u2014\t' L out\ndhi\tdLOut\n(B.18)\nAplicando a transformada de Laplace tem-se:\nhi(s) \u2022 s \u2014 hi(s) \u2022\t\u2014\t\u2022 Lout(s)\t(B.19)\ndhl\tdLout\nRearranjando os termos em forma de fun\u00e7oes de transferencia:\ndf2\nG22 =\t(B.20)\n- + h\nSupondo Lin = Lout no equilibrio resulta a equacao B.20 \u00e9 simplificada como:\nG22\nK22\ns\n(B.21)\nonde\ndf2 _ ____________\u20141___________\nLout 2 \u2022 Cci \u2022 y/hi \u2022 (D \u2014 hi)\n(B.22)\nB.3 Lineariza\u00e7\u00e3o do Balan\u00e7o de G\u00e1s no Separador\nDe forma an\u00e1loga das se\u00e7oes anteriores a equa\u00e7\u00e3o B.4 ser\u00e9 diferenciada em relac\u00e3o a (Gout, p). Assim tem-se:\ndf~3 =_________p_______\t(b 23)\ndGout = Vci + Vcs - Vt\t( . )\ndf3   (Gin + Win + Lin\tG out\t~Wout\tLout)\n~dp _\tVt \u2014 Vci \u2014 Vcs\nA expans\u00f5o da equa\u00e7\u00f5o em s\u00e1rie de Taylor definida em vari\u00e1veis desvio com rela\u00e7ao a um estado estacion\u00e1rio \u00e9 dada por:\ndp\ndf3 dGout\n\u2022 Gout\n(B.25)\nAplicando a transformada de Laplace tem-se:\nP(s) \u2022 s - p(s) \u2022\t\u2022 Gout(s)\t(B.26)\ndp\tdGOut\nRearranjando os termos em forma de fun\u00e7\u00f5es de transfer\u00eancia:\ndp/dt\nG33 =\ndGout s . dp/dt s + dp\n(B.27)\nSupondo Gin = Gout no equil\u00edbrio resulta a equac\u00e3o B.27 \u00e9 simplificada como:\ns\n(B.28)\nonde\ndf3 dG out\np\nVcl + Vcs - Vt\n(B.29)\nB.4 Modelo Linearizado\nO modelo linearizado completo \u00e9 apresentado na equa\u00e7\u00e3o B.30.\nhw\tK\nhl\t=\t0\np0\n0\nK22 s\n0\n0\n0\nK33\ns\n\t\u25a0 Wout \u2019\n\tLout\n\tG Gout\n(B.30)\n122 B. Lineariza\u00e7ao do Modelo Simplificado do Separador\nAp\u00eandice C\nControle PI por Bandas\nO controle por bandas, sugerido por [27], tem a caracter\u00edstica principal de levar em conta que os separadores de opera\u00e7c\u00e3ao sofrem cont\u00ednuas mudanc\u00e7as de estrat\u00edegia, sendo alinhados diferentes po\u00e7cos segundo as conveni\u00eancias do momento. Dessa forma as vazoes de carga mudam permanentemente e isso requer mudan\u00e7cas no valor desejado do sistema. Nessa proposta usa-se uma forma de inferir as perturba\u00e7c\u00e3oes baseadas nos movimentos da v\u00edlvula de controle. Segue uma analise preliminar desse controlador por bandas.\nO modelo utilizado \u00ede\n' \u2014 O - O\n\u2014 Oin\tO out\ndt\n(C.1)\nsendo Qm a vazao de alimentac\u00e3o e Qout a vaz\u00e3o de sa\u00edda. Atrav\u00eds da equa\u00e7ca\u00e3o da v\u00edalvula obt\u00eden-se Oout\n0out u \u2022 c\nv\n(C.2)\nEste modelo n\u00e3o considera o peso da coluna de l\u00edquido para um vaso (o que faz sentido em vasos sob press\u00e3o)\n\u2014h\t/\nC \u2022 D \u2022 \u2014 \u2014 Oin - u \u2022 Cv -J\u00c3P dt\n(C.3)\nE argumentado, corretamente, que a vaz\u00e3o de sa\u00edda deve ser igual ao valor medio da vaz\u00e3o de entrada. Como esta n\u00e3o \u00e9 medida, tem que ser inferida. Essa infer\u00eancia \u00e9 feita atrav\u00e9s do pr\u00e9prio modelo, baseado nas medidas do n\u00edvel e da vaz\u00e3ao de sa\u00edda.\n,\tdhm\nQin = C \u2022 D \u2022 \u2014 + QXt\t(C.4)\nO valor m\u00e9dio \u00e9 calculado ao longo de um certo per\u00edodo de tempo, que neste caso e considerado o per\u00edodo com que acontecem as golfadas. Calculando a transformada de Laplace da equa\u00e7\u00e3o resultante tem-se que o valor desejado (setpoint) de um controlador que determina a vaz\u00e3o de sa\u00edda do vaso e dado por\nC \u2022 D\nT\nQdUs) =\n\u2022 (1 _ e-Ts) \u2022 hm(s) +\n(1 - e-Ts )\nT- s\nQZt(s)\n(C.5)\nConsiderando que se consegue um controle perfeito\nQXt(s) = QL(s) = u(s) \u2022 Cv\n(C.6)\nSubstituindo na equa\u00e7\u00e3o C.5, gera-se uma lei de controle que depende apenas da medi\u00e7\u00e3o de n\u00edvel.\nu\nC \u2022 D\nT\n(s) \u2022 Cv\n\u2022 (1 _ e-Ts) \u2022 hm(s) +\n(1 _ e-Ts)\nT- s\n\u2022 QXt(s)\n(C.7)\nAdota-se um controlador proporcional ao n\u00edvel em substitui\u00e7\u00e3o ao primeiro termo da equac\u00e3o C.7 o que, em termos praticos, implica em corrigir as diferen\u00e7as entre Qout e Qin por um valor proporcional ao acumulo de l\u00edquido no separador e n\u00e3o mais pela derivada do n\u00edvel [27]. A lei de controle passa a ser\n(1 _\nu(s) = Kc \u2022 [hd(s) - hm(s)] +\t) \u2022 u(s)\t(C.8)\nT \u2022 S\nIsolando-se u(s), tem-se\nT \u2022 s\nu(s) = Kc \u2022 T------\u2014\u2014T7 \u2022 [hd(s) - hm(s)]\t(C.9)\nDesta forma, valores altos de K propiciam menor filtragem do sinal de entrada (maior flutua\u00e7\u00e3o na vaz\u00e3o de sa\u00edda). Por outro lado, os limites da banda s\u00e3o ultrapassados com menor frequ\u00eancia.\nUma simplifica\u00e7\u00e3o a mais e possivel utilizando-se a aproxima\u00e7ao de Pade:\n2 - T \u2022 s\n2 + T \u2022 s\ne\n\u2014Ts\n(C.10)\nSubstituindo (C.10) em (C.9) leva a equac\u00e3o de um controle proporcional e integral em (C.11).\nKc \u2022\nT \u2022 s\nT \u2022 s - 1 + e-Ts\n= K \u2022 (1 +\nT2. )\n(C.11)\nNeste caso, o tempo integral Ti \u00e9 T/2. Esta aproxima\u00e7\u00e3o da bons resultados e simplifica muito a implementa\u00e7ao, uma vez que se pode utilizar o controlador de n\u00e9vel PID, existente em todas as plantas. E\u00e9 importante ter em mente que neste caso na\u00e3o se deve limitar a integral (reset wind-up) e sua janela de atua\u00e7\u00e3o deve ser igual ao per\u00e9odo T.\nPortanto, o sistema de controle \u00e9 acrescentado de uma a\u00e7ao hierarquicamente superior que enquanto o n\u00e9vel estiver dentro da banda a sintonia do PI \u00e9 ajustada de forma a permitir a oscilac\u00e3o do n\u00e9vel dentro da banda. Quando o n\u00e9vel do vaso ultrapassa os limites da banda, \u00e9e assumida uma sintonia mais dr\u00e9astica para o controlador PI, que se encarrega de levar o sistema ao seu valor desejado, dentro da banda. A sintonia do PI, quando o n\u00e9vel est\u00e9 dentro da banda, \u00e9 realizada de forma que a vaz\u00e3o de sa\u00e9da seja a media dos valores da golfada na vaz\u00e3o de alimentac\u00e3o e os par\u00e2metros devem ser ajustados de forma que Kc = K e Ti = T/2.\n126\nC.\tControle PI por Bandas\nRefer\u00eancias\nB ibliogr\u00e1ficas\n[1]\tC. Bordons and J. R. Cueli. Predictive controller with estimation of measurable disturbances. application to an olive oil mill. Journal of Process Control, 14:305-315, 2004.\n[2]\tE. F. Camacho and C. Bordons. Model Predictive Control. Springer, Berlin, 2004.\n[3]\tM. C. M. Campos and A. Texeira. Os benef\u00edcios e desafios da aplicac\u00e3o de t\u00e9cnicas de controle avan\u00e7ado e otimiza\u00e7\u00e3o em tempo real em unidades mar\u00edtimas de produ\u00e7ao. VI Congresso Rio Automa\u00e7\u00e3o, 2011.\n[4]\tM. C. M. Campos, L. A. Costa, A. E. Torres, and D. C. Schmidt. Controle avan\u00e7cado dos n\u00edveis dos separadores de plataformas de produ\u00e7\u00e3o. I Congresso de Instrumenta\u00e7\u00e3o, Controle e Automa\u00e7\u00e3o da PETROBRAS, 2008.\n[5]\tD. S. S. Casillo. Controle Preditivo N\u00e3o-Linear Baseado no Modelo de Hammerstein com Prova de Estabilidade. PhD thesis, Universidade Federal do Rio Grande do Norte, 2009.\n[6]\tA. A. R. Coelho and L. S. Coelho. Identifica\u00e7\u00e3o de Sistemas Din\u00e2micos Lineares. Ed. UFSC, Florian\u00f3polis, 2004.\n[7]\tE. Eskinat, S. H. Johnson, and W. L. Luyben. Use of hammerstein models in identification of nonlinear systems. AIChE Journal, 37: 255-268, 1991.\n[8]\tN. G. T. Filgueiras. Modelagem, an\u00edalise e controle de um processo de separacao Oleo/\u00e9gua. Master's thesis, COPPE/UFRJ, Rio de Janeiro, 2005.\n[9]\tM. J. P. Garcia, J. E. Normey-Rico, and E. Camponogara. Nonlinear model based predictive controller of a buck boost converter. Proceeding of the 16th IFAC World Congress, 1, 2005.\n[10]\tJ. M. Godhavn, M. P. Fard, and P. H. Fuchs. New slug control strategies, tuning rules and experimental results. Journal of Process Control, 15:547-557, 2005.\n[11]\tS. Hovland. Soft constraints in explicit model predictive control. Master's thesis, The Norwegian University of Science and Technology, Trondheim, 2004.\n[12]\tS-L. J\u00e2msa-Jounela, R. Poikonen, and K. Halmevaara. Evaluation of level control performance. 15th IFAC Triennial World Congress, Barcelona: Spain, 2002.\n[13]\tD. O. Azevedo Jr. and O. A. Z. Sotomayor. Controle de escoamentos no regime de golfadas em processos de produ\u00e7ca\u00e3o de petroleo. Mec\u00e1nica Computacional, XXIX:8447-8461, 2010.\n[14]\tC. A. Corr\u00e2ea Junior. Desenvolvimento de modelo computacional de previs\u00e3ao de quebra de gotas em simulador de separa\u00e7c\u00e3ao de oleo e agua em um hidrociclone. Master's thesis, Programa de Pos-Graduac\u00e7\u00e3ao em Modelage Computacional do Instituto Politecnico da Universidade do Estado do Rio de Janeiro, Rio de Janeiro, 2008.\n[15]\tM. Kim, S. H. Yoonand, P. A. Domanski, and W. V. Payne. Design of a steady-state detector for fault detection and diagnosis of a residential air conditioner. International Journal of Refrigeration, 31:790-799, 2008.\n[16]\tL. Ljung. System Identification, Theory for the User. PrenticeHall, Englewwod Cliffs, NJ, 1999.\n[17]\tL. Ljung and T. Glad. Modelling of Dynamical S\u2019ystems. PrenticeHall, Englewwod Cliffs, NJ, 1994.\n[18]\tJ. M. Maciejowski. Predictive Control with Constraints. Prentice Hall, New Jersey, 2002.\n[19]\tR. I. G. Mejia, M. B. Duarte, and J. O. Trierweiler. Avalia\u00e7c\u00e3ao do desempenho de metodos de identifica\u00e7ca\u00e3o de estado estacionario. XVIII Congresso Brasileiro de Autom\u00e1tica, 2010.\n[20]\tR. I. G. Mejia, M. B. Duarte, and J. O. Trierweiler. Contribui\u00e7\u00e3o para o ajuste autom\u00e3tico de tecnicas de identifica\u00e7\u00e3o de estado estacion\u00e3rio. XVIII Congresso Brasileiro de Autom\u00e1tica, 2010.\n[21]\tR. I. G. Mejia, M. B. Duarte, and J. O. Trierweiler. Identification de estado estacionario basada en la estimativa de la autocorrelation local. Bolivian Engineering and Technology Congress - BETCON, 2010.\n[22]\tC A. C. Moraes. Modelo fluidodin\u00e2mico para a estimativa de eficiencia em hidrociclones para Aguas oleosas. Master's thesis, COPPE/UFRJ, Rio de Janeiro, 1994.\n[23]\tO. Nelles. Nonlinear S\u2019ystem Identification. Springer, Berlin, 2001.\n[24]\tJ. E. Normey-Rico and E. F. Camacho. Control of Dead-Time Processes. Springer, Berlin, 2007.\n[25]\tG. C. Nunes. Modelagem e simula\u00e7\u00e3o din\u00e2mica do separador Agua/ Oleo/ gas. Master's thesis, COPPE/UFRJ, Rio de Janeiro, 1994.\n[26]\tG. C. Nunes. Design and Analysis of Multivariable Predictive Control Applied to an Oil-Water-Gas Separator: A Polynomial Approach. PhD thesis, University of Florida, 2001.\n[27]\tG. C. Nunes. Controle por bandas: Conceitos basicos e aplica\u00e7\u00e3o no amortecimento de oscila\u00e7c\u00e3oes de carga em unidades de produ\u00e7c\u00e3ao de petroleo. Technical report, Comunica\u00e7c\u00e3ao Tecnica - PETROBRAS, 2004.\n[28]\tG. C. Nunes, J. L. Medeiros, and O. Q. F. Ara\u00fajo. Modelagem e Controle na Produ\u00e7\u00e3o de Petr\u00f3leo - Aplica\u00e7\u00f5es em MATLAB. Blucher, S\u00e3ao Paulo, 2010.\n[29]\tI. D. o. Corr\u00e2a. Controle preditivo do n\u00edvel de agua em um tanque pressurizado. Technical report, Projeto de Gradua\u00e7\u00e3o - Universidade Federal do Espirito Santo, 2005.\n[30]\tC. Paoli, C. Voyant, M. Muselli, and M-L. Nivet. Solar radiation forecasting using ad-hoc time series preprocessing and neural networks. In De-Shuang Huang, Kang-Hyun Jo, Hong-Hee Lee, Hee-Jun Kang, and Vitoantonio Bevilacqua, editors, Emerging Intelligent Computing Technology and Applications, volume 5754, pages 898-907. Springer Berlin / Heidelberg, 2009.\n[31]\tA. Pawlowski, J. L. Guzm\u00e1n, F. Rodr\u00edguez, M. Berenguel, and J. S\u00e1nchez. Application of time-series methods to disturbance estimation in predictive control. IEEE Symposium on Industrial Electronics, Bari: Italy, pages 409-414, 2010.\n[32]\tA. Pawlowski, J. L. Guzm\u00e1n, F. Rodr\u00edguez, M. Berenguel, and J. E. Normey-Rico. Predictive control with disturbance forecasting for greenhouse diurnal temperature control. 18th IFAC World Congress, Milano: Italy, pages 1779-1784, 2011.\n[33]\tA. Plucenio. Desenvolvimento de T\u00e9cnicas de Controle N\u00e3o Linear para Eleva\u00e7ao de Fluidos Multif\u00e9sicos. PhD thesis, Programa de P\u00e1s-Gradua\u00e7\u00e3o em Engenharia de Automa\u00e7ao e Sistemas, DAS, Universidade Federal de Santa Catarina, 2010.\n[34]\tG. Prasath and J. B. Jorgensen. Soft constraints for robust mpc of uncertain systems. International Symposium on Advanced Control of Chemical Processes, 7, 2009.\n[35]\tG. Reikard. Predicting solar radiation at high resolutions: A comparison of time series forecasts. Solar Energy, 83:342-349, 2009.\n[36]\tC. H. P. Ribeiro. Simula\u00e7ao e avalia\u00e7\u00e3o de controle preditivo aplicado a sistemas de tratamento primario de petroleo. Technical report, Monografia de Gradua\u00e7ao - Universidade Federal do Rio de Janeiro, 2009.\n[37]\tS. M. Ross. Introduction to Probability Models. Elsevier, Berkeley, California, 2007.\n[38]\tJ. E. S. Santos. Controle Preditivo Ndo Linear para Sistemas Ham-merstein. PhD thesis, Universidade Federal de Santa Catarina, 2007.\n[39]\tScandpower. Users Manual OLGA 2000. Kjeller: Norway, 2003.\n[40]\tM. A. C. R. Silveira. Controle de um processo de tratamento prim\u00e1rio de petr\u00e1leo. Master's thesis, COPPE/UFRJ, Rio de Janeiro, 2006.\n[41]\tI. Skrlanc and D. Matko. Fuzzy Predictive Controller with Adap-tative Gain. Advances in Model-Based Predictive Control. Oxford University Press, Oxford, 1994.\n[42]\tO. J. M. Smith. Close control of loops with deadtime. Chemical Engineering Progress, 53:217-219, 1957.\n[43]\tO. A. Z. Sotomayor, D. Odloak, and L. F. L. Moro. Closed-loop model re-identification of processes under mpc with zone control. Control Engineering Practice, 17:551-563, 2009.\n[44]\tY. Tan and R. Keyser. Neural Network Based Predictive Control. Advances in Model-Based Predictive Control. Oxford University Press, Oxford, 1994.\n[45]\tL. T. A. Teixeira. Controle de oscila\u00e7\u00f5es em sistemas de eleva\u00e7\u00e3o artificial de petr\u00f3leo por inje\u00e7\u00e3o cont\u00ednua de g\u00e1s (gas-lift). Technical report, Trabalho de Conclus\u00e3o de Curso, Departamento de Engenharia El\u00e1trica/UFS, 2010.\n[46]\tF. F. Thom\u00f3e. Re-identifica\u00e7c\u00e3ao de processos em malha fechada com mpc robusto. Technical report, Relat\u00f3orio de Est\u00f3agio - Universidade Federal de Santa Catarina, 2010.\n[47]\tJ. E. Thomas. Fundamentos de Engenharia de Petr\u00f3leo. Editora Interci\u00eancia, Rio de Janeiro, 2001.\n[48]\tL. Wang. Model Predictive Control System Design and Implementation Using MATLAB. Springer, London, 2009.\n[49]\tJ. Yu and S. Qin. Statistical mimo controller performance monitoring. part ii: Performance diagnosis. Journal of Process Control, 18:297-319, 2008."}]}}}