{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.23813"}, {"@name": "filename", "#text": "8062_289799.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE FEDERAL DE SANTA CATARINA\nPROGRAMA DE P\u00d3S-GRADUA\u00c7\u00c3O EM ENGENHARIA MEC\u00c2NICA\n\nLeonardo Karpinski\n\nAPLICA\u00c7\u00c3O DO M\u00c9TODO DOS VOLUMES FINITOS BASEADO EM\nELEMENTOS EM UM SIMULADOR DE RESERVAT\u00d3RIOS\n\nQU\u00cdMICO-COMPOSICIONAL\n\nFlorianop\u00f3lis\n\n2011\n\n\n\n\n\nLeonardo Karpinski\n\nAPLICA\u00c7\u00c3O DO M\u00c9TODO DOS VOLUMES FINITOS BASEADO EM\nELEMENTOS EM UM SIMULADOR DE RESERVAT\u00d3RIOS\n\nQU\u00cdMICO-COMPOSICIONAL\n\nDisserta\u00e7\u00e3o submetida ao Programa de\nP\u00f3s-Gradua\u00e7\u00e3o em Engenharia Mec\u00e2nica\npara a obten\u00e7\u00e3o do grau de Mestre em\nEngenharia Mec\u00e2nica.\n\nOrientador: Clovis Raimundo Maliska\nCoorientador: Kamy Sepehrnoori\n\nFlorianop\u00f3lis\n\n2011\n\n\n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \nCataloga\u00e7\u00e3o na fonte pela Biblioteca Universit\u00e1ria \n\nda \n\nUniversidade Federal de Santa Catarina \n \n\n \n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n         \n\n. \n\n \n\n \n\n         \n\n          \n\n    \n\n K18a   Karpinski, Leonardo \n\n           Aplica\u00e7\u00e3o do m\u00e9todo dos volumes finitos baseado em \n\n        elementos em um simulador de reservat\u00f3rios qu\u00edmico- \n\n        composicional [disserta\u00e7\u00e3o] / Leonardo Karpinski ; orientador,  \n\n        Clovis Raimundo Maliska, co-orientador, Kamy Sepehrnoori. \n\n        - Florian\u00f3polis, SC, 2011.  \n\n           91 p.: il., grafs., tabs. \n\n \n\n           Disserta\u00e7\u00e3o (mestrado) - Universidade Federal de Santa \n\n        Catarina, Centro Tecnol\u00f3gico. Programa de P\u00f3s-Gradua\u00e7\u00e3o em  \n\n        Engenharia Mec\u00e2nica. \n\n  \n\n           Inclui refer\u00eancias \n\n \n\n           1. Engenharia mec\u00e2nica. 2. Petr\u00f3leo. 3. Reservat\u00f3rios. \n\n        4. M\u00e9todos de simula\u00e7\u00e3o. I. Maliska, Clovis Raimundo. \n\n        II. Sepehrnoori, Kamy. III. Universidade Federal de Santa  \n\n        Catarina. Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia Mec\u00e2nica.  \n\n        IV. T\u00edtulo.  \n\n                                                    CDU 621 \n\n \n\n \n\n \n\n                                                    \n\n \n\n \n\n\n\nLeonardo Karpinski\n\nAPLICA\u00c7\u00c3O DO M\u00c9TODO DOS VOLUMES FINITOS BASEADO EM\nELEMENTOS EM UM SIMULADOR DE RESERVAT\u00d3RIOS\n\nQU\u00cdMICO-COMPOSICIONAL\n\nEsta disserta\u00e7\u00e3o foi julgada adequada para a obten\u00e7\u00e3o do t\u00edtulo de\n\u201cMestre em Engenharia Mec\u00e2nica\u201d, e aprovada em sua forma final pelo\nPrograma de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia Mec\u00e2nica.\n\nFlorianop\u00f3lis, 11 de Mar\u00e7o 2011.\n\nEduardo Alberto Fancello, D.Sc., Coordenador do Curso\n\nClovis Raimundo Maliska, Ph.D., Orientador\n\nBANCA EXAMINADORA\n\nAnt\u00f3nio F\u00e1bio Carvalho da Silva, Dr.Eng., Presidente\n\nCelso Peres Fernandes, Dr.Eng.\n\nJos\u00e9 Ant\u00f4nio Bellini da Cunha Neto, Dr.\n\nKamy Sepehrnoori, Ph.D., Coorientador\n\n\n\n\n\nAC K N OW L E D G M E N TS\n\nI am sincerely and heartily grateful to my supervisor, Dr. Clovis R.\n\nMaliska, for the support and guidance he showed since I joined the SINMEC\n\nLab. I am sure this dissertation would not have been possible without\n\nhis help. I also would like to thank him for expressing his confidence by\n\nchoosing me as the first student to develop activities in the cooperation\n\nbetween SINMEC/UFSC and CPGE/UT (Center for Petroleum and Geosys-\ntems Engineering at The University of Texas at Austin), where I fulfilled\n\nmy curricular internship, during my undergraduate studies, and developed\n\npart of my Master\u2019s research.\n\nI am truly thankful to Dr. Kamy Sepehrnoori, for serving as my co-\n\nsupervisor from UT Austin and accepting me in this international cooper-\n\nation. It has been a pleasure to collaborate with a worldwide renowned\n\ngroup, which is the reservoir simulation group at CPGE/UT. I am also\ngrateful to him and his administrative associate for encouraging the use of\n\ncorrect grammar and consistent notation in my writings and for carefully\n\nreading and commenting on this manuscript.\n\nMy gratitude also goes to Dr. Francisco Marcondes for helping me\n\nsince the beginning of my research program in Austin. His guidance during\n\nthe period we were in Austin made my permanence abroad easier.\n\nI deeply appreciate everyone in the SINMEC Lab, for the great work\n\nenvironment. Special thanks to Prof. Ant\u00f3nio F\u00e1bio, Fernando Hurtado\n\nand Maur\u00edcio Tada for the long discussions regarding numerical reservoir\n\nsimulation. Also to Carlos Newmar, for generating the unstructured grids I\n\nused in this dissertation.\n\nI would like to show my gratitude to the Post-Graduation Program\n\nin Mechanical Engineering (POSMEC) and to the Mechanical Engineering\n\nDepartment of the Federal University of Santa Catarina (UFSC), for giving\n\nme all necessary conditions to fulfill this Master\u2019s dissertation. I thank the\n\nprofessors from the program, whose expertise and knowledge enabled me\n\nto develop a better understanding of the mathematics and physics of fluid\n\n\n\ndynamics.\n\nMost importantly, none of this would have been possible without the\n\nlove and patience of my family, which has been a constant source of love,\n\nconcern, support and strength all these years, supporting and encouraging\n\nmy education from the very beginning. I would like to express my gratitude\n\nto my parents, Pedro V. Karpinski and F\u00e1tima R. P. Karpinski, and to my\n\nbrother, Pedro Karpinski Neto. Also to Karina G. Fonseca, for being my\n\npartner during these two years.\n\nFinally, I would like to express my appreciation to Petrobras S. A. and\n\nto Dr. Sepehrnoori, for the financial support during the period I was in\n\nAustin.\n\n\n\nCO N T E N TS\n\nList of Figures iii\n\nList of Tables v\n\nNomenclature vii\n\nConversion Factors xi\n\nResumo xiii\n\nAbstract xv\n\n1 Introduction 1\n1.1 Preliminaries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1\n\n1.2 Literature review . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4\n\n1.3 Objectives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7\n\n1.4 Organization of the work . . . . . . . . . . . . . . . . . . . . . . . . . . . 9\n\n2 UTCHEM Simulator 11\n2.1 General description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11\n\n2.2 Features . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12\n\n2.3 Mathematical model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n\n2.3.1 Concentration equation . . . . . . . . . . . . . . . . . . . . . . 13\n\n2.3.2 Pressure equation . . . . . . . . . . . . . . . . . . . . . . . . . . 15\n\n2.3.3 Initial and boundary conditions . . . . . . . . . . . . . . . . 16\n\n3 Numerical Formulation 17\n3.1 Main geometrical entities . . . . . . . . . . . . . . . . . . . . . . . . . . 17\n\n3.2 Grid definition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19\n\n3.3 Coordinate transformation . . . . . . . . . . . . . . . . . . . . . . . . . 20\n\n3.4 Interpolation inside an element . . . . . . . . . . . . . . . . . . . . . . 21\n\n3.5 Three-dimensional elements . . . . . . . . . . . . . . . . . . . . . . . . 24\n\ni\n\n\n\n3.5.1 Tetrahedron . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25\n\n3.5.2 Hexahedron . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26\n\n3.5.3 Prism . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28\n\n3.5.4 Pyramid . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29\n\n3.6 Integration of the governing equations . . . . . . . . . . . . . . . . 30\n\n3.6.1 Pressure equation . . . . . . . . . . . . . . . . . . . . . . . . . . 31\n\n3.6.2 Concentration equation . . . . . . . . . . . . . . . . . . . . . . 34\n\n3.7 Well models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34\n\n3.8 Face mobility evaluation . . . . . . . . . . . . . . . . . . . . . . . . . . . 36\n\n3.9 Linear system assembling . . . . . . . . . . . . . . . . . . . . . . . . . . 37\n\n4 Timestepping Approaches 41\n4.1 IMPEC method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41\n\n4.2 Adaptive IMPEC method . . . . . . . . . . . . . . . . . . . . . . . . . . . 43\n\n4.3 Sequential method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46\n\n5 Results 51\n5.1 EbFVM validation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51\n\n5.2 FDM vs. EbFVM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55\n\n5.2.1 Case 1 \u2013 Single-phase . . . . . . . . . . . . . . . . . . . . . . . . 57\n\n5.2.2 Case 2 \u2013 Water-oil flooding . . . . . . . . . . . . . . . . . . . . 59\n\n5.2.3 Case 3 \u2013 Chemical flooding . . . . . . . . . . . . . . . . . . . . 62\n\n5.3 Timestepping approaches comparison . . . . . . . . . . . . . . . . 65\n\n5.3.1 Case 1 \u2013 Water-oil flooding . . . . . . . . . . . . . . . . . . . . 65\n\n5.3.2 Case 2 \u2013 Chemical flooding . . . . . . . . . . . . . . . . . . . . 69\n\n5.4 EbFVM potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73\n\n6 Conclusions 77\n6.1 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77\n\n6.2 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78\n\n6.3 Suggestions for future work . . . . . . . . . . . . . . . . . . . . . . . . . 79\n\nReferences 81\n\nA Peaceman\u2019s Well Model for Unstructured Grids 87\n\nii\n\n\n\nL I S T O F F I G U R E S\n\nFigure 1.1 Reservoir model representation using three different grid\n\ntypes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3\n\nFigure 1.2 Hypothetical reservoir discretization using an unstructured\n\ngrid. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8\n\nFigure 1.3 Discretization of areas of interest. . . . . . . . . . . . . . . . . . . . . . . . . . 8\n\nFigure 3.1 Main geometrical entities of the EbFVM. . . . . . . . . . . . . . . . . . . 18\n\nFigure 3.2 (a) Global numeration of nodes and elements. (b) Local\n\nnumeration of the nodes. (c) Connectivity list . . . . . . . . . . . . 19\n\nFigure 3.3 Element represented in global and local coordinate sys-\n\ntems. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n\nFigure 3.4 Standard tetrahedron and local coordinates of the nodes. . 25\n\nFigure 3.5 Faces in standard tetrahedron. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26\n\nFigure 3.6 Standard hexahedron and local coordinates of the nodes. . 27\n\nFigure 3.7 Faces in standard hexahedron. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27\n\nFigure 3.8 Standard prism and local coordinates of the nodes. . . . . . . . 28\n\nFigure 3.9 Faces in standard prism. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29\n\nFigure 3.10 Standard pyramid and local coordinates of the nodes. . . . . 30\n\nFigure 3.11 Faces in standard pyramid. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n\nFigure 3.12 (a) Upstream node for positive flux (b) and negative flux. . 37\n\nFigure 3.13 Matrix assembling example for a grid with four elements\n\nand eight nodes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38\n\nFigure 5.1 Subdivision of the hexahedron in different elements. . . . . . 53\n\niii\n\n\n\nFigure 5.2 Regular and distorted grids used in the validation problem. 54\n\nFigure 5.3 Error in the variable ? for regular and distorted grids. . . . . . 55\n\nFigure 5.4 Grids used in the comparison between FDM and EbFVM. . 56\n\nFigure 5.5 Different elements in the hybrid grid. . . . . . . . . . . . . . . . . . . . . . 57\n\nFigure 5.6 Pressure field for Case 1. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59\n\nFigure 5.7 Permeability field for Case 2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61\n\nFigure 5.8 Water and oil relative permeabilities for Case 2. . . . . . . . . . . . 61\n\nFigure 5.9 Production well curves for Case 2. . . . . . . . . . . . . . . . . . . . . . . . . . 63\n\nFigure 5.10 Production well curves for Case 3. . . . . . . . . . . . . . . . . . . . . . . . . . 64\n\nFigure 5.11 Timestep along the simulation for the grid 75 \u00d7 75 \u00d7 5 in\nCase 1. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66\n\nFigure 5.12 Oil cut for the grid 75\u00d775\u00d75 in Case 1. . . . . . . . . . . . . . . . . . . . 67\n\nFigure 5.13 CPU time for different routines in Case 1. . . . . . . . . . . . . . . . . . 68\n\nFigure 5.14 Timestep along the simulation for the grid 45 \u00d7 45 \u00d7 5 in\nCase 2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69\n\nFigure 5.15 Oil cut for the grid 45\u00d745\u00d75 in Case 2. . . . . . . . . . . . . . . . . . . . 70\n\nFigure 5.16 CPU time for different routines in Case 2. . . . . . . . . . . . . . . . . . 72\n\nFigure 5.17 Grid. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73\n\nFigure 5.18 Element types in the grid. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74\n\nFigure 5.19 Near-well region. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75\n\nFigure 5.20 Saturation field in the final time (1.08 PVI). . . . . . . . . . . . . . . . . 75\n\nFigure 5.21 Isosurfaces of saturation 0.5. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76\n\nFigure A.1 Well in an areal reservoir model. . . . . . . . . . . . . . . . . . . . . . . . . . . 88\n\nFigure A.2 Control volume and elements around a producer well. . . . . 89\n\niv\n\n\n\nL I S T O F TA B L E S\n\nTable 3.1 Tetrahedron shape functions. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25\n\nTable 3.2 Hexahedron shape functions. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26\n\nTable 3.3 Prism shape functions. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28\n\nTable 3.4 Pyramid shape functions. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29\n\nTable 5.1 Input data for Case 1. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58\n\nTable 5.2 Well flow rates. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59\n\nTable 5.3 Input data for Case 2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60\n\nv\n\n\n\n\n\nN O M E N C L AT U R E\n\nb Geometrical and medium information, similar to trans-\n\nmissibility, m3\n\nC? Overall concentration, fraction\n\nC Relative concentration, fraction\n\nC? Adsorbed concentration, fraction\n\nC o Component compressibility, Pa\u20131\n\nC r Rock compressibility, Pa\u20131\n\nC t Total compressibility, Pa\u20131\n\nCr Courant number\n~?D Dispersive flux vector, m/s\n\n[D] Matrix of partial derivatives of the shape functions\n\nF Fractional flux\n\nG w Residue of the water conservation equation, m3/s\n\nh Vertical depth, m\n\nK Absolute permeability tensor, m2\n\nk r Relative permeability\n\n[J] Jacobian matrix\n\nn cv Number of volume-occupying components\n\nnne Number of nodes per element\n\nn p Number of phases\n\nN Element shape functions\nP Pressure, Pa\n\nPc Capillary pressure, Pa\n\nq Volumetric flux, m3/s\n\nQ? Volumetric injection/production rate per bulk volume, s\u20131\n\nQ Volumetric injection/production rate, m3/s\n\nvii\n\n\n\nr Reaction rate, s\u20131\n\nR? Sink/source term per bulk volume, s\u20131\n\nS Saturation, fraction\n\n~S Surface area vector, m2\n\nt Time, s\n\n~u Darcy\u2019s velocity vector, m/s\n\nV Volume, m3\n\nw Parameter relative to capillary pressure and gravitational\n\nterms, Pa\n\nWI Well index, m3\n\nx , y , z Global coordinates, m\n\nGreek symbols\n\n?~S Face area vector, m2\n\n?t Timestep, s\n\n?V Volume of a control volume, m3\n\n? Specific weight, N/m3\n\n? Mobility, (Pa.s)\u20131\n\n\u00b5 Viscosity, Pa.s\n\n? Rock porosity, fraction\n\n? Density at reservoir conditions over density at standard\n\nconditions, fraction\n\n? Generic variable\n\n\" L2-norm of the numerical solution error\n\n?,?,? Local coordinates\n\nSubscripts\n\n1 Aqueous phase\n\ne Element\n\nf Face\n\nf? Integration point, located at the centroid of the face\n\nviii\n\n\n\n? Component\n\nl Phase\n\np Node\n\nref Reference condition\n\nstd Standard condition\n\nT Total\n\nwf Well\n\nSuperscripts\n\nn Current time level\n\nn ?1 Old time level\n? Generic time level\n\nSpecial symbols\n\n\u02c6 Nodal value\n\ne ?Ep Group of elements surrounding node p\nf ?Fp Group of faces in the control surface associated to node p\nf ?Fep Group of faces from element e in the control surface asso-\n\nciated to node p\n\nk ?Tp Group of nodes in the stencil of node p\nq ?Ne Group of nodes of element e\n\nix\n\n\n\n\n\nCO N V E R S I O N FAC TO R S\n\nCompressibility 1 psi\u20131 = 1.4504\u00d710?4 Pa\u20131\n\nLength 1 ft = 0.3048 m\n\nPermeability 1 mD = 9.8692\u00d710?16 m2\n\nPressure 1 psi = 6894.7572 Pa\n\nSpecific weight 1 psi/ft = 22620.5945 N/m3\n\nViscosity 1 cP = 0.001 Pa.s\n\nVolumetric flow rate 1 ft3/d = 3.2774\u00d710?7 m3/s\n\nxi\n\n\n\n\n\nR E S U M O\n\nEste trabalho apresenta uma an\u00e1lise do m\u00e9todo dos volumes finitos ba-\nseado em elementos (EbFVM) aplicado a um simulador de reservat\u00f3rios\ncomposicional com inje\u00e7\u00e3o de componentes qu\u00edmicos, desenvolvido na\nUniversidade do Texas em Austin. O m\u00e9todo emprega malhas n\u00e3o estru-\nturadas para a discretiza\u00e7\u00e3o espacial, considerando diferentes tipos de el-\nementos. Elementos dispostos de maneira n\u00e3o estruturada s\u00e3o adequados\npara representar de forma precisa e eficiente reservat\u00f3rios com geome-\ntrias complexas, combinando a flexibilidade do m\u00e9todo dos elementos\nfinitos com a garantia de conserva\u00e7\u00e3o local e global. Para a obten\u00e7\u00e3o\ndas equa\u00e7\u00f5es aproximadas para os volumes de controle, primeiramente\ncada elemento \u00e9 dividido em sub-volumes de controle, unindo o centr\u00f3ide\ndo elemento com os pontos m\u00e9dios de suas faces. Cada volume de\ncontrole \u00e9 ent\u00e3o formado por sub-volumes de controle que compartilham\no mesmo v\u00e9rtice, de acordo com o esquema de constru\u00e7\u00e3o cell-vertex.\nEste procedimento resulta em uma conveniente maneira de gerar malhas\ncapazes de representar importantes aspectos topol\u00f3gicos do reservat\u00f3rio,\nao mesmo tempo que preserva-se a ess\u00eancia do m\u00e9todo convencional de\nvolumes finitos, ou seja, a constru\u00e7\u00e3o de equa\u00e7\u00f5es aproximadas que garan-\ntem a conserva\u00e7\u00e3o de quantidades f\u00edsicas em n\u00edvel discreto. A solu\u00e7\u00e3o\ndas equa\u00e7\u00f5es foi obtida empregando-se diferentes esquemas de avan\u00e7o\ntemporal, sendo realizada uma compara\u00e7\u00e3o do tempo computacional re-\nsultante de cada m\u00e9todo, e ilustrando as vantagens e desvantagens de cada\num. Para o EbFVM, uma an\u00e1lise do erro das solu\u00e7\u00f5es num\u00e9ricas para difer-\nentes refinos de malha em um problema de difus\u00e3o com solu\u00e7\u00e3o anal\u00edtica\nconhecida \u00e9 apresentado, assim como compara\u00e7\u00f5es com o m\u00e9todo origi-\nnalmente presente no simulador, onde \u00e9 mostrado que o EbFVM fornece as\nmesmas solu\u00e7\u00f5es por\u00e9m com a vantagem de ser um m\u00e9todo mais flex\u00edvel.\nPor fim, para evidenciar mais claramente as potencialidades do m\u00e9todo\nno quesito geom\u00e9trico, um problema fisicamente simples em um dom\u00ednio\ncom geometria n\u00e3o-convencional, possuindo falhas geol\u00f3gicas e po\u00e7os\ncom trajet\u00f3rias arbitr\u00e1rias, \u00e9 resolvido. Tal geometria n\u00e3o \u00e9 poss\u00edvel de\nser discretizada atrav\u00e9s do m\u00e9todo originalmente presente no simulador,\nenquanto que com o m\u00e9todo proposto isso \u00e9 facilmente realizado.\n\nxiii\n\n\n\n\n\nA B S T R AC T\n\nAn investigation of the Element-based Finite Volume Method (EbFVM) ap-\nplied to a chemical flooding compositional reservoir simulator, developed\nat The University of Texas at Austin, is presented. The method employs\nthree-dimensional unstructured grids for the spatial discretization, con-\nsidering different types of elements. Unstructured elements are adequate\nto represent, in an accurate and efficient way, reservoirs with complex\ngeometries, combining the flexibility of the finite element method with\nlocal and global conservation enforcement. To obtain the approximate\nequations for the control volumes, first each element is divided into sub-\ncontrol volumes, by joining the centroid of the element with the midpoint\nof the faces. Each control volume is then formed by sub-control volumes\nof neighboring elements applying the cell-vertex construction. This pro-\ncedure results in a convenient way to build grids that represent important\nfeatures of the reservoir topology, such as geological faults and wells, at the\nsame time it preserves the essence of conventional finite volume meth-\nods, that is, the construction of approximate equations that guarantee\nthe conservation of physical quantities at discrete level. The solution of\nthe equations was obtained by considering different approaches for time\nadvancing. A comparison for the computational time of each approach\nis performed, illustrating the advantages and disadvantages of each one.\nFor the EbFVM, an analysis of the numerical error for different refinement\nlevels in a diffusion problem with analytical solution is presented, as well\nas comparisons of the proposed method and the finite difference method\noriginally used in the simulator, by applying different reservoir simulation\ncase studies. It is shown that the EbFVM provides the same solutions but\nwith the advantage of being a more flexible method. Finally, in order to\nevidence more clearly the element-based potentialities regarding geome-\ntry discretization, a physically simple flow problem in a non-conventional\ngeometry, containing geological faults and wells with arbitrary trajectories,\nis solved. Such geometry is not possible to be discretized by applying\nthe original method present in the simulator, while with the proposed\napproach it can be done smoothly.\n\nxv\n\n\n\n\n\nCHAPTER\n\n1\nI N T RO D U C T I O N\n\n1.1 Preliminaries\n\nReservoir engineering is one of the important fields in petroleum en-\n\ngineering. In this area, several parameters must be evaluated in order to\n\ndecide whether a natural reservoir is viable, predicting future performance\n\nand finding ways and means of increasing ultimate recovery [3]. Among\nthe techniques used to perform such a study is the application of numer-\n\nical methods for reservoir simulation, which has gained wide acceptance\n\nthroughout the petroleum industry in the last thirty years, mostly due to\n\nthe tremendous increase in computing speed and capacity and to improve-\n\nments in numerical algorithms for solving partial differential equations\n\n[44]. In this respect, reservoir simulation has become the standard for\nsolving reservoir engineering problems [2], and, therefore, has received\nattention by public and private research centers.\n\nReservoir simulation is the art of combining physics, mathematics,\n\nreservoir engineering, and computer programming to develop a tool for\n\npredicting hydrocarbon reservoir performance under various operating\n\nstrategies. The task of simulating a multiphasic flow problem in porous\n\nmedium is firstly conceived through a mathematical model formed by a\n\nhighly coupled system of non-linear partial differential equations. These\n\nPDEs, if solved analytically, would provide reservoir pressure, fluid satura-\n\ntions, and well flow rates as continuous functions of space and time [2].\n\n1\n\n\n\n2 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nBecause of the highly non-linear nature of the PDEs, however, the math-\n\nematical model is almost always too complex to be solved by analytical\n\nmethods. Hence, it is necessary to apply numerical procedures for con-\n\nverting PDEs into a linear system composed by algebraic equations. This\n\nprocess is called discretization, as the solution is obtained for a discrete\n\nnumber of points, where the fundamental equations are applied in their\n\napproximate form. Among these numerical procedures, the commonly\n\nmethods applied are the Finite Difference Method (FDM), Finite Volume\n\nMethod (FVM), Finite Element Method (FEM) and Element-based Finite\n\nVolume Method (EbFVM). It is important to emphasize that the FVM and\n\nFDM methods are different [36], however, even so the petroleum literature\nusually refers to the finite difference method as the discretization approach\n\nfor the governing equations, while many times the finite volume method is\n\nbeing applied. As this misunderstanding in the designation of the method\n\nused to discretize the equations is typical in the literature, it will be kept in\n\nthe present work intentionally.\n\nThe first petroleum simulators employed initially only orthogo-\n\nnal Cartesian grids. The difficulties associated with representing ade-\n\nquately complex reservoir geometries motivated the introduction of non-\n\northogonal Cartesian grids, known as corner-point grids. This type of\n\ngrid is nowadays commonly used in commercial simulators, even with the\n\ndisadvantage of still being structured, which presents difficulties in the\n\ngeometrical representation as well as in performing local grid refinements\n\nin areas of interest, as around wells and faults. Besides, such simulators use\n\ninaccurate schemes for the flux calculation when non-orthogonal grids are\n\nused [53]. Another discretization option, with more recent applications in\npetroleum problems, is the use of unstructured grids, similar to the ones\n\nused in the finite element method, where a complete geometrical flexibility\n\ncan be achieved. Figure 1.1 illustrates a reservoir model discretized using\n\nthe three different approaches cited.\n\nTherefore, the difficulties in the spatial representation of arbitrary\n\ndomains using structured grids, and the inaccurate techniques of local\n\nrefinements have motivated the application of unstructured grids in the\n\nsimulation of reservoir problems. These grids, composed by different\n\nelement types, are easier to conform to the reservoir domain, increasing\n\nthe flexibility in representing the main features of the reservoir, such\n\nas irregular geometries, wells, and faults. One method that deals with\n\n\n\nCH AP T ER 1 \u2013 INT RO DUCT IO N 3\n\nWell\n\nWell\n\nGeological fault\n\nWell\n\nCartesian grid\n\nStructured non-orthogonal grid\n\nUnstructured grid\n\nReservoir model\n\nFigure 1.1 \u2013 Reservoir model representation using three different grid\ntypes.\n\nunstructured grids is the Element-based Finite Volume Method (EbFVM),\n\nwhich follows the basic idea of the traditional finite volume method, but\n\nuses unstructured elements to represent complex geometries and to define\n\nthe spatial variation of physical media properties. Therefore, it combines\n\nthe flexibility of the Finite Element Method with local and global conser-\n\nvation enforcement, which is the essence of the FVM. Hence, physical\n\nbalances are made in the polygonal control volumes, with contributions\n\nfrom different elements, according to the cell vertex construction. This\n\nprocedure results in a convenient way to build grids with great flexibility,\n\nallied to the conservation of physical quantities at discrete level [36].\nAlthough this discretization approach is able to represent all details of\n\ngeological reservoir models that should be incorporated into the numerical\n\nsimulations, still little effort has been made in order to take advantage\n\n\n\n4 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nof numerical formulations that are able to deal with unstructured grids.\n\nThis dissertation is a sequence of other works performed in the SINMEC\n\nLab [15, 26, 27, 39\u201342], that are positioned precisely for filling this gap,\nthrough the development and implementation of a numerical formula-\n\ntion obtained with the application of a conservative approach based on\n\nelements.\n\n1.2 Literature review\n\nThe numerical technique considered in this work was originally de-\n\nveloped for solving the Navier-Stokes equations using unstructured grids\n\nin the 80s. The method arose by the application of the conservation\n\nprinciples directly in a finite element environment, in such a way that the\n\nphysical properties are conserved in discrete control volumes constructed\n\naround the grid nodes. This idea was firstly applied by Baliga and Patankar\n\n[5] for triangular elements, while Schneider and Zedan [50] applied it to\nquadrilateral elements. These authors denominated the Control Volume\n\nFinite Element Method (CVFEM), due to the geometrical flexibility and\n\nto the linear system assemblage performed element by element, this de-\n\nnomination being the most known in the literature. However, as argued by\n\nMaliska [36], this denomination is inaccurate, as it suggests a finite element\nformulation that uses control volumes for the integration of the equations.\n\nActually, it is a method conceived according to the same philosophy as the\n\nfinite volume method, using elements only as geometric supporting enti-\n\nties, by borrowing the concept of element and shape functions from the\n\nfinite element method. This way, Maliska [36] suggests a more appropriate\ndenomination: Element-based Finite Volume Method (EbFVM), which will\n\nbe applied in this work.\n\nA few years later, Raw [47] also developed a numerical formulation\nusing quadrilateral elements addressed to fluid dynamics and heat transfer\n\nproblems. The form applied in this dissertation derives from the formu-\n\nlation presented in his work, adapting the ideas for solving Navier-Stokes\n\nequations to the fluid flow in porous medium.\n\nThe first work in the literature using the EbFVM approach for\n\npetroleum problems was developed by Rozon [48], which denominated\nthe method as Generalized Finite Volume Method. The author discretized\n\nthe single-phase equations for quadrilateral elements and compared the\n\n\n\nCH AP T ER 1 \u2013 INT RO DUCT IO N 5\n\ntruncation error of this method with other traditional methods. In the\n\nbeginning of the 90s, other applications of this type of methodology were\n\nproposed [22, 24, 25], destined to the simulation of multiphasic flow prob-\nlems in complex reservoir domains applying unstructured triangular grids.\n\nHowever, some simplifications are introduced in these works, in order to\n\nobtain a similar structure as obtained in conventional discretizations with\n\nstructured grids. As analyzed in Cordazzo et al. [16]and Cordazzo et al. [17],\nthese simplifications, besides giving rise to an erroneous interpretation\n\nof some coefficients in the discretized equations, impose geometrical\n\nrestrictions to the grid used, that could be avoided if a more rigorous\n\ndeduction of the approximate equations was considered. More recently,\n\nHurtado [26] presented a formulation for two-phase displacement pro-\ncesses, and Karpinski et al. [29] extended such formulation to a chemical\nflooding compositional reservoir simulator employing two-dimensional\n\nhybrid grids.\n\nOnce the system of discretized equations is obtained, it is necessary\n\nto choose an adequate form for solving it. The simplest method consists\n\nin obtaining one equation that the only unknown is the pressure, and al-\n\ngebraic expressions for determining other variables, as saturations, giving\n\nrise to the IMPES denomination (IMplicit Pressure Explicit Saturation) in\n\nCoats\u2019 [11] work. Its basic idea is to obtain a single pressure equation by\na combination of the flow equations, updating explicitly the saturations\n\nafter the pressure has been advanced in time. The major limitation of\n\nthis approach is the restriction in the timestep size due to the explicit\n\nevaluation of saturations. Even with this restriction and with the advent\n\nof new techniques for solving linear and non-linear equations, still there is\n\ninterest in the use of this scheme in certain applications, as well as in the\n\ndevelopment of strategies for better performance of the method. In this\n\ncase, the method is improved with the possibility of using larger timesteps\n\nthat result in solutions free of numerical instabilities [10, 13, 14, 28].\nRecently, Chen et al. [10] proposed improvements to the IMPES algo-\n\nrithm, with the possibility of taking larger timesteps for the pressure equa-\n\ntion than the timesteps used in the saturation equation, as the stability\n\ncondition is associated only to the explicit approximation of the saturation.\n\nThis way, the pressure linear system would be solved less times along\n\nthe simulation, providing a meaningful reduction in the computational\n\ntime. However, in his work it was not clear how much larger this pressure\n\n\n\n6 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\ntimestep can be in relation to the saturation timestep without damaging\n\nthe numerical solution. Hurtado et al. [28] proposed an adaptive control\nstrategy based on the mean variation of the total velocity field as a way\n\nof determining a timestep for the pressure equation as large as possible\n\nwithout degrading the quality of the solution. In the demonstrated cases,\n\nan expressive time-saving was obtained without introducing further errors\n\nin the solutions.\n\nIn compositional models, where equations for different components\n\nare solved, the IMPSAT model (IMplicit Pressure and SATuration and\n\nExplicit Concentration) is usually applied. In this model, only the pressure\n\nand saturations are treated implicitly, whereas the concentration of all\n\ncomponents are treated explicitly. The method was further analyzed in\n\nthe last decade, establishing stability criterion and comparing them to\n\nthe IMPES and Fully Implicit (FIM) models [9]. There is no restriction,\nhowever, for using the IMPES approach in compositional simulators. In\n\nthis case, the correct designation would be IMPEC (IMplicit Pressure\n\nand Explicit Concentration), as the pressure and concentrations are the\n\nprimary variables and the saturation is determined through the phase be-\n\nhavior after solving for pressure implicitly and component concentrations\n\nexplicitly, as performed in Saad [49].\nThe fully implicit schemes arrived as an alternative to obtain faster so-\n\nlutions than the IMPES method, especially for finer grids and with regions\n\nthat present high-speed fluid flow, as its limitations in the timestep size\n\nare less restrictive [15]. They consist in the solution of a linear system that\ninvolve all variables, usually through the application of Newton\u2019s method.\n\nBlair and Weinaug [8] were the pioneers in using Newton\u2019s method in\npetroleum reservoir simulation and, since then, this method has been\n\napplied by most commercial software.\n\nAnother timestepping approach used in reservoir simulation is the\n\nsequential method (SEQ), which is situated between the IMPES and FIM\n\nmethods, with an intermediate level of implicitness. The basic idea of this\n\nscheme is to improve the stability of the IMPES method by incorporating\n\nimplicit treatment of saturations, but without solving simultaneously for\n\npressures and saturations. Therefore, it differs from IMPES only in the\n\nmanner of the saturation calculations. The pressure distribution, obtained\n\nin the same way as in IMPES, is used in a set of flow equations with\n\nappropriate linearization of the saturation dependent terms. This way, the\n\n\n\nCH AP T ER 1 \u2013 INT RO DUCT IO N 7\n\ncoefficients are treated implicitly in the saturation equation, alleviating the\n\ninstability of the IMPES method related to the explicit treatment of mobili-\n\nties, and, therefore, allowing for the use of larger timesteps. Such a scheme\n\nwas first formulated by MacDonald and Coats [34], but its use was better\nreported by Spillette et al. [52] and Coats [12]. These authors introduced\nthe use of semi-implicit mobility, which proved to be greatly superior to\n\nthe IMPES and fully implicit method with respect to computational effort,\n\nease of use, and maximum permissible timestep size.\n\n1.3 Objectives\n\nAs described in the previous sections, the main goal of the present\n\nwork is the application of the EbFVM formulation to three-dimensional\n\ndomains in a compositional simulator, called UTCHEM, originally pro-\n\nvided by the FDM method. This simulator was developed at The University\n\nof Texas at Austin, aiming to simulate enhanced oil recovery processes\n\nusing chemical flooding. The incorporation of a numerical method able\n\nto represent complex geometries with flexibility is an important addition\n\nto the simulator, which in terms of mathematical models already accounts\n\nfor several petroleum engineering options.\n\nRegarding flexibility, hybrid unstructured grids formed by different\n\nelement types can be easily conformed in order to represent efficiently\n\ncomplex spatial domains. Hexahedral elements allow for precise numer-\n\nical approximations; however, still there is no method for generating grids\n\ncomposed only by hexahedrons that guarantees satisfactory quality in\n\ndomains with arbitrary geometry [20, 39]. Hence, hybrid grids composed\nby hexahedrons and tetrahedrons is a good alternative. The transition\n\nbetween these elements, however, must be performed by elements with\n\nsimilar faces. That is where pyramids and prisms are used, as these\n\nelements have both quadrilateral and triangular sides.\n\nSimilarly as shown in Maliska et al. [39], Figure 1.2 illustrates a pos-\nsible discretization for a three-dimensional reservoir using a hybrid grid.\n\nSome additional details are shown in Figure 1.3, where it is possible to iden-\n\ntify different elements in different regions. The cylindrical region around\n\nthe well is discretized with prisms and hexahedrons, while the faults are\n\nrepresented by hexahedrons, with the rest of the reservoir discretized with\n\n\n\n8 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nFigure 1.2 \u2013 Hypothetical reservoir discretization using an unstructured\ngrid.\n\n(a) Near-well region (b) Geological fault\n\nFigure 1.3 \u2013 Discretization of areas of interest.\n\ntetrahedrons, which are easier to be conformed. The transition areas\n\nbetween hexahedrons and tetrahedrons are filled with pyramidal elements.\n\nBesides the application of the EbFVM, different timestepping ap-\n\nproaches will be applied in the simulator considered. The original solution\n\nmethod present in UTCHEM is implicit for the pressure and explicit for\n\nthe concentrations (IMPEC), which, similar to the IMPES method, has a\n\nmajor disadvantage due to the fact that it is highly unstable. Therefore,\n\nvery small timesteps in order to avoid oscillations in the solutions are\n\nnecessary. This way, other two approaches will be studied. The first one is\n\nstill the IMPEC method, but applying different timesteps for the pressure\n\nand concentration equations. The second one is the sequential method\n\n\n\nCH AP T ER 1 \u2013 INT RO DUCT IO N 9\n\n(SEQ), which solves implicitly for both the pressure and concentrations,\n\nbut in a sequential form with two separate linear systems. In this context\n\nstudies are still necessary for evaluating the performance of such methods,\n\nanalyzing both the quality of the solutions as well as the computational\n\ncost. This activity, jointly with the implementation of the element-based\n\napproach in the UTCHEM simulator, compose the central idea of this\n\ndissertation, which attempts to realize a comparative evaluation of the\n\nFDM and EbFVM methods as well as the time-advancing methods.\n\n1.4 Organization of the work\n\nThis dissertation is divided into five other chapters. The second\n\nchapter describes the UTCHEM simulator, outlining its features and the\n\nmathematical model present in the simulator.\n\nChapter 3 presents several geometrical aspects related to the\n\nElement-based Finite Volume Method (EbFVM). In the sequence, the inte-\n\ngration of the governing equations is performed, applying such a method.\n\nThe different options for treating the time-related variables that\n\nemerge during the time integration of the equations are explained in\n\nChapter 4, where the three different timestepping approaches are detailed.\n\nIn Chapter 5, the results for different examples are shown. In this\n\nchapter, first a validation of the implementation is presented for a diffusion\n\nproblem. In the sequence, comparisons with the formulation originally\n\nexistent in the simulator (FDM) are performed. Then the timestepping\n\napproaches are applied in conjunction with the EbFVM and FDM methods,\n\ncomparing the computational cost of each approach. Finally, a simple flow\n\nproblem in a synthetic reservoir is simulated, in order to demonstrate the\n\npotential of the method in discretizing complex domains.\n\nLastly, Chapter 6 concludes this work with a general discussion re-\n\ngarding the developments made. Some suggestions for future works are\n\nalso cited.\n\n\n\n\n\nCHAPTER\n\n2\nU TC H E M S I M U L ATO R\n\n2.1 General description\n\nThe simulator considered in this work is called UTCHEM, developed\n\nat The University of Texas at Austin to simulate enhanced oil recovery\n\nprocesses and enhanced remediation of aquifers, using chemicals in com-\n\nbination, such as surfactant, polymer, and alkaline flooding [18]. The\nsimulator is a multicomponent, multiphase, and compositional model,\n\naccounting for complex phase behavior and multiphase physical proper-\n\nties. Furthermore, it can model capillary pressures, three-phase relative\n\npermeabilities (water/gas/oil phases or water/oil/microemulsion phases),\ndispersion, diffusion, adsorption, chemical reactions, non-equilibrium\n\nmass transfer between phases and other related phenomena [55].\nIn this simulator, the flow and mass-transport equations are solved\n\nfor any number of user-specified chemical components (water, organic\n\ncontaminants, surfactant, alcohols, polymer, chloride, calcium, other elec-\n\ntrolytes, microbiological species, electron acceptors, etc.). These compo-\n\nnents can form up to four fluid phases (air, water, oil, and microemulsion)\n\nand any number of solid minerals depending on the overall composition.\n\nThe microemulsion forms only above the critical micelle concentration\n\nof the surfactant and is a thermodynamically stable mixture of water,\n\nsurfactant, and one or more organic components [55]. All of these features\ntaken together, but especially the transport and flow of multiple phases\n\n11\n\n\n\n12 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nwith multiple species and multiple chemical and biological reactions make\n\nUTCHEM unique.\n\nOriginally, the solution method is implicit in pressure and explicit\n\nin concentration (IMPEC type), and the formulation used to approximate\n\nthe governing equations is the traditional finite volume method, often\n\ncalled finite difference method in the petroleum literature. As stated\n\nbefore, it is the objective of this work to introduce a method that deals\n\nwith unstructured grids, the EbFVM in this case, besides the inclusion of\n\ndifferent timestepping schemes.\n\n2.2 Features\n\nHere some features of the simulator are listed, as in UTCHEM-9.0 [55]:\n\n\u2022 Three-dimensional;\n\n\u2022 Variable temperature;\n\n\u2022 Four phases (water, oil, microemulsion, and gas);\n\n\u2022 Heterogeneous permeability and porosity;\n\n\u2022 Full tensor dispersion coefficient and molecular diffusion;\n\n\u2022 Adsorption of surfactant, polymer, and organic species;\n\n\u2022 Solubilization and mobilization of oil;\n\n\u2022 Clay/surfactant cation exchange;\n\n\u2022 Water/surfactant (cosolvent)/oil phase behavior;\n\n\u2022 Polymer with non-Newtonian rheology;\n\n\u2022 Compositional density and viscosity functions;\n\n\u2022 Surfactant/foam model;\n\n\u2022 Multiple organic properties;\n\n\u2022 Trapping number including both viscous and buoyancy forces;\n\n\u2022 Several polymer/gel kinetics;\n\n\n\nCH AP T ER 2 \u2013 UTCH EM SIM UL ATOR 13\n\n\u2022 Equilibrium and rate-limited organic dissolution;\n\n\u2022 Rock dependent capillary pressure and relative permeability;\n\n\u2022 Brooks-Corey capillary pressure and relative permeability functions;\n\n\u2022 Water-wet hysteretic capillary pressure and relative permeability\nmodel of Parker and Lenhard;\n\n\u2022 Mixed-wet hysteretic two-phase oil/water capillary pressure and\nrelative permeability model of Lenhard;\n\n2.3 Mathematical model\n\nIn this section, a brief description of the mathematical formulation\n\npresent in the UTCHEM simulator is given. The detailed description of\n\nthe physical property models and phase behavior can be found elsewhere\n\n[18, 55], and additional features needed only for enhanced oil recovery can\nbe found in Bhuyan [7] and Saad [49].\n\nThe fundamental equations are the mass balance equation for each\n\nspecies (concentration equation), the aqueous phase pressure, and the\n\nenergy balance equation (not considered in this work). Therefore, in this\n\nwork, the primary variables are the component concentrations and the\n\naqueous phase pressure.\n\nThe aqueous phase pressure is obtained by an overall mass balance\n\non volume-occupying components (water, oil, surfactant, co-solvent, and\n\ngas), while the other phase pressures are computed by adding the capillary\n\npressure between phases. The phases are a single component gas phase\n\n(l = 4) and up to three liquid phases: aqueous (l = 1), oleic (l = 2) and\nmicroemulsion (l = 3), depending on the relative amounts and effective\nelectrolyte concentration (salinity) of the phase environment [55].\n\n2.3.1 Concentration equation\n\nThe continuity of mass for each component is expressed in terms of\n\noverall volume of component ? per unit pore volume as\n\n?\n\n?t\n\n?\n\n?C????\n?\n\n+~?\u00b7\n\n?\n\n?\n\nn p\n?\n\nl =1\n\n??\n?\n\nC?l ~ul ? ~?D?l\n?\n\n?\n\n?= R?? . (2.1)\n\n\n\n14 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nThe overall concentration of each component C?? is the sum of the\n\nspecific concentrations over all phases, including the adsorbed phases:\n\nC?? =\n\n \n\n1?\nn c v\n?\n\n?=1\n\nC??\n\n!\n\nn p\n?\n\nl =1\n\nS l C?l +C?? , (2.2)\n\nwhere n c v is the total number of volume-occupying components, n p is\n\nthe number of phases, S l is the phase saturation, C?l is the concentration\n\nof component ? in phase l , C?? is the adsorbed concentration, and\n~?D?l is\n\nthe dispersive flux, assumed to have a Fickian form, as shown in Bear [6]\nand UTCHEM-9.0 [55]. Also, ?? represents a relation between the density\nof the pure component at reservoir conditions and its density at standard\n\nconditions (usually 1 atm), assuming ideal mixing and small and constant\n\ncomponent compressibilities C o\n?\n\n:\n\n?? = 1+C\no\n?\n(P ?Pstd) . (2.3)\n\nA similar relation is considered for the rock porosity ?, assuming\n\nconstant rock compressibility C r :\n\n?=?ref [1+C r (P ?Pref)] . (2.4)\n\nThe superficial velocity of each phase is related to the pressure gradi-\n\nent by Darcy\u2019s law for multiphase flow, as\n\n~ul =??l K \u00b7\n?\n\n~?Pl ??l ~?h\n?\n\n, (2.5)\n\nwhere Pl is the phase pressure, K is the intrinsic permeability tensor,\n\nh is the vertical depth, ?l is the phase specific weight, and ?l is the\n\nphase relative mobility, expressed by a relation between the phase relative\n\npermeability k r l and the phase viscosity \u00b5l :\n\n?l =\nk r l\n\u00b5l\n\n. (2.6)\n\nThe source term R?? in Eq. (2.1) is a combination of injec-\n\ntion/production volumetric rates and chemical reactions for a particular\ncomponent, and may be expressed as\n\nR?? =?\nn p\n?\n\nl =1\n\nS l r?l +\n?\n\n1??\n?\n\nr?s +Q?? , (2.7)\n\n\n\nCH AP T ER 2 \u2013 UTCH EM SIM UL ATOR 15\n\nwhere Q?? is the injection or production rate for component ? per bulk\n\nvolume and r?l and r?s are the reaction rates for component ? in phase\n\nl and solid phase s , respectively.\n\n2.3.2 Pressure equation\n\nThe pressure equation is obtained by summing the mass balance\n\nequations over-all volume-occupying components, substituting Darcy\u2019s\n\nlaw for the phase velocity terms and using the definition of capillary\n\npressure. Thus, the pressure equation for the aqueous phase results in\n\n?ref C t\n?P1\n?t\n+~?\u00b7\n\n?\n\n?T c K \u00b7~?P1\n?\n\n=\n\n~?\u00b7\n\n?\n\n?\n\nn p\n?\n\nl =1\n\n?l c K \u00b7\n?\n\n~?Pc l 1 ??l ~?h\n?\n\n?\n\n?+\nn c v\n?\n\n?=1\n\nQ?? ,\n(2.8)\n\nwhere the phase relative mobility including the correction for fluid com-\n\npressibility ?l c is given by\n\n?l c =\nk r l\n\u00b5l\n\nn c v\n?\n\n?=1\n\n??C?l , (2.9)\n\nand the total relative mobility ?T c by\n\n?T c =\nn p\n?\n\nl =1\n\n?l c . (2.10)\n\nThe total compressibility C t is the volume-weighted sum of the rock\n\n(C r ) and component compressibilities (C o?):\n\nC t =C r +\nn c v\n?\n\n?=1\n\nC o\n?\n\nC?? . (2.11)\n\nNote that Eq. (2.8) is not in the conservative form, as the total\n\ncompressibility term is outside the time derivative. However, as the fluid\n\ncompressibilities are assumed to be small, there will not be major errors\n\nwith this action, facilitating the time integration as seen in Chapter 3.\n\nThe fundamental equations are, therefore, defined by Eqs. (2.1)\n\nand (2.8). As stated before, it is not the objective of this work to detail\n\n\n\n16 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nhow the saturations, viscosities and other physical properties are obtained\n\nthrough the primary variables pressure and concentration. These models\n\nare mathematical relations that do not involve geometry, and therefore, do\n\nnot interfere in the objectives of the present work.\n\n2.3.3 Initial and boundary conditions\n\nThe initial conditions in UTCHEM are given by an initial pressure\n\nand a initial saturation for the aqueous phase, whereas the basic boundary\n\nconditions are no convective and no dispersive flux through all boundaries.\n\nAlternatively, the no flow condition may be replaced in part by specified\n\npressure on the boundaries, as explained in UTCHEM-9.0 [55]. However,\nthis alternative will not be considered herein.\n\nFor the wells, both injection and production wells are considered as\n\nsource and sink terms in the flow equations. The condition for the wells\n\ncan be either constant total flow rate or constant bottom hole pressure,\n\nand will be further discussed in Chapter 3.\n\n\n\nCHAPTER\n\n3\nN U M E R I C A L F O R M U L AT I O N\n\nThe differential equations that describe the mathematical model\n\npresented in the previous chapter have no analytical solution. Thus,\n\nin order to solve them numerically, it is necessary to transform these\n\ndifferential equations in algebraic equations, through the application of a\n\nnumerical method. This transformation process is called discretization, as\n\na continuous problem is transformed into a discrete problem.\n\nThe method used to obtain the discrete equations in this work is the\n\nElement-based Finite Method (EbFVM), which uses some concepts of the\n\nFinite Element Method, but preserves the essential premise of any Finite\n\nVolume Method, that is the construction of approximate equations that\n\nsatisfy the conservation of physical quantities at discrete level.\n\n3.1 Main geometrical entities\n\nIn the EbFVM formulation, the discretization process is realized\n\nconsidering an unstructured grid. The geometrical entities that define this\n\ngrid are the elements, and they must cover all spots in the domain without\n\nsuperposing other elements or leaving blank spaces. The elements are\n\nalso used for defining the spatial variation of medium physical properties,\n\nas porosity and absolute permeability. This treatment permits to handle\n\nheterogeneous permeability distributions in a straightforward way.\n\n17\n\n\n\n18 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nThe unknowns of the problem are calculated at points called nodes,\n\nlocated at every element vertex. Even though the grid is defined by ele-\n\nments, the integration of the governing equations is realized in the control\n\nvolumes, where the conservation of physical quantities is guaranteed. The\n\ncontrol volumes are built around grid nodes, with contributions from\n\ndifferent elements sharing the same node, so that for each node there is\n\na control volume associated. Therefore, in contrast to traditional finite\n\nvolume methods, in the EbFVM elements and control volumes no longer\n\ncoincide. The portion that each element contributes to create a control\n\nvolume is called sub-control volume. In Fig. 3.1 the main geometrical\n\nentities of the method are shown for a two-dimensional situation, where\n\nthe representation is simpler. The same ideas can be easily extended to\n\nthree dimensions.\n\nControl \nvolume (       )\n\nControl \nsurface\n\nNode ( p)\n\nx\n\ny\n\npVD\n\nElement ( e)\n\nFace area \nvector (       )fDS\n\nr\n\nSub-control\nvolume\n\nIntegration \npoint ( f )\n\nFace ( f )\n\nFigure 3.1 \u2013 Main geometrical entities of the EbFVM.\n\nThe contour of a control volume, known as control surface, is com-\n\nposed by a group of faces. In two dimensions, the faces are line segments,\n\nas shown in Fig. 3.1, and in three dimensions the faces are triangles or\n\nquadrilaterals, as shown in section 3.5. As in any finite volume method,\n\nthe fluxes that compose the balance of a given physical quantity must\n\nbe approximated in each face present in the control surface. For this,\n\nthe best option is to apply the midpoint rule approximation, reason why\n\nthe midpoint (or centroid) of each face is usually known as integration\n\npoint. Since in this formulation the elements are homogeneous, that\n\n\n\nCH AP T ER 3 \u2013 NUM ER ICA L F O R M UL AT IO N 19\n\nis, properties such as porosity and permeability do not vary inside each\n\nelement, there is no need to perform any type of averaging procedure for\n\ncalculating these properties at integration points [15].\n\n3.2 Grid definition\n\nDifferently from traditional methods using structured grids, where\n\nthe grid can be defined simply by informing the number of gridblocks1 and\n\nthe domain length in each direction, the EbFVM needs a more detailed\n\ninformation of the grid. The easiest way to define it is by informing\n\nthe coordinates of the nodes and the element connectivity list, which\n\nspecifies, for each element, the nodes in its vertices, according to the global\n\nnumeration of the nodes. Figure 3.2 illustrates an example for a 2D grid\n\nwith four elements and eight nodes.\n\n1\n\n2\n3\n\n4\n\n5\n6\n\n8\n\n7\n\n34\n\n2\n1\n\n(a)\n\n1\n\n2\n\n3\n\n4\n\n4\n\n1\n2\n\n3\n\n4\n\n1\n\n1\n\n2\n\n3\n\n2\n\n1\n2\n\n3\n\n4\n\n3\n\n(b)\n\nElement Node 1\n\nConnectivity List\n\nNode 2 Node 3 Node 4\n\n1\n\n1\n\n2\n\n2\n\n23 3\n\n4\n\n4\n\n4\n\n5\n\n5 6 7\n\n7\n\n8\n\n8\n\n8\n\n8\n\n(c)\n\nFigure 3.2 \u2013 (a) Global numeration of nodes and elements. (b) Local nu-\nmeration of the nodes. (c) Connectivity list\n\n1 Gridblocks in the FDM are both the element and the control volume, as these entities\ncoincide in this method. In the EbFVM, the word \u201cgridblock\u201d is not commonly used, as\nelements and control volumes no longer coincide.\n\n\n\n20 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\n3.3 Coordinate transformation\n\nIn the EbFVM, the equations can be solved in the computational\n\ndomain using a standard element in a local coordinate system. This pro-\n\ncedure is borrowed from the finite element method, where each element is\n\ntreated identically and independently, no matter how complex the element\n\ngeometry is in the global coordinates. In this way, the conservation equa-\n\ntions for each control volume can be simply assembled with contributions\n\nfrom the neighboring elements. Figure 3.3 exemplifies the coordinate\n\ntransformation for a prism.\n\nCoordinate\ntransformation\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\nh\n\nx\n\ng\n\n1 3\n\n2\n\n4\n\n6\n\n5\n\ny\n\nz\n\nx\n\n( )x y z1 1 1\u02c6 \u02c6 \u02c6, , ( )x y z2 2 2\u02c6 \u02c6 \u02c6, ,\n\n( )0,0,0\n\n( )1,0,0\n\n( )0,1,0\n\n( )0,1,1\n\n( )0,0,1\n\n( )1,0,1\n\n( )x y z3 3 3\u02c6 \u02c6 \u02c6, ,\n\n( )x y z4 4 4\u02c6 \u02c6 \u02c6, ,\n\n( )x y z5 5 5\u02c6 \u02c6 \u02c6, ,\n\n( )x y z6 6 6\u02c6 \u02c6 \u02c6, ,\n\nFigure 3.3 \u2013 Element represented in global and local coordinate systems.\n\nSince the conservation equations are defined in respect to the global\n\ncoordinates\n?\n\nx , y , z\n?\n\n, mathematical relations that express the transforma-\n\ntion to the local coordinates\n?\n\n?,?,?\n?\n\nare necessary. This can be done in a\n\n\n\nCH AP T ER 3 \u2013 NUM ER ICA L F O R M UL AT IO N 21\n\nsimple way through the use of the element shape functions. Using these\n\nfunctions it is possible to relate the global coordinates of any point inside\n\nan element by\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nx\n?\n\n?,?,?\n?\n\n=\nnne\n?\n\nk=1\nNk\n?\n\n?,?,?\n?\n\nx? k\n\ny\n?\n\n?,?,?\n?\n\n=\nnne\n?\n\nk=1\nNk\n?\n\n?,?,?\n?\n\ny?k\n\nz\n?\n\n?,?,?\n?\n\n=\nnne\n?\n\nk=1\nNk\n?\n\n?,?,?\n?\n\nz? k ,\n\n(3.1)\n\nwhere nne is the number of nodes per element, which is variable for each\n\nelement type, (x? k , y?k , z? k) are the global coordinates of the element nodes\nand Nk\n\n?\n\n?,?,?\n?\n\nare the shape functions, described for each 3D element in\n\nSection 3.5.\n\n3.4 Interpolation inside an element\n\nDuring the discretization process, some physical properties will have\n\nto be evaluated inside an element, as for example, the pressure gradient\n\nat the integration points for the flux calculation. Knowing the local\n\ncoordinates of the point of interest, any physical property, denoted here\n\nby ?, can be expressed in terms of the element shape functions and the\nproperty values in the element vertices. That is,\n\n?\n?\n\n?,?,?\n?\n\n=\nnne\n?\n\nk=1\n\nNk\n?\n\n?,?,?\n?\n\n??k , (3.2)\n\nwhere ??k are the nodal values for the property. In a more compact way, Eq.\n(3.2) can be written as\n\n?=[N ]T [??]e , (3.3)\n\nwhere [??]e = [ ??1 ??2 \u00b7\u00b7\u00b7 ??nne ]T is the vector containing the nodal\nvalues of the property and [N ]T = [ N1 N2 \u00b7\u00b7\u00b7 Nnne ] is the vector\ncontaining the element shape functions.\n\nBased on the approximation given in Eq. (3.2), it is possible to express\n\nthe gradient of the variable of interest in terms of the local coordinate\n\n\n\n22 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nsystem. Differentiating this equation in relation to the global coordinates,\n\nthe gradient vector can be written as\n\n[??]?\n\n?\n\n?\n\n?\n\n?\n\n?x?\n?y ?\n?z?\n\n?\n\n?\n\n?\n\n?\n\n=\nnne\n?\n\nk=1\n\n?\n\n?\n\n?\n\n?\n\n?xNk\n?y Nk\n?zNk\n\n?\n\n?\n\n?\n\n?\n\n??k , (3.4)\n\nor in another form as\n\n[??]=\n\n?\n\n?\n\n?\n\n?\n\n?xN1 ?xN2 \u00b7\u00b7\u00b7 ?xNnne\n?y N1 ?y N2 \u00b7\u00b7\u00b7 ?y Nnne\n?zN1 ?zN2 \u00b7\u00b7\u00b7 ?zNnne\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n??1\n??2\n\n...\n\n??nne\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n. (3.5)\n\nThe key point is the determination of the shape function derivatives\n\nin relation to the global coordinates in Eq. (3.5). As the shape functions\n\nare continuous functions inside an element, they can be differentiated.\n\nConsidering the chain rule, it is possible to write\n\n?\n\n?\n\n?\n\n?\n\n??Nk\n??Nk\n??Nk\n\n?\n\n?\n\n?\n\n?\n\n=\n\n?\n\n?\n\n?\n\n?\n\n??x ??y ??z\n\n??x ??y ??z\n\n??x ??y ??z\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?xNk\n?y Nk\n?zNk\n\n?\n\n?\n\n?\n\n?\n\n, (3.6)\n\nwhere the matrix with dimensions 3\u00d73 in the right-hand side is known as\nthe Jacobian of the coordinate transformation, usually denoted as [J]. This\nequation can be rewritten, then, in a more compact form as\n\n?\n\n?\n\n?\n\n?\n\n??Nk\n??Nk\n??Nk\n\n?\n\n?\n\n?\n\n?\n\n=[J]\n\n?\n\n?\n\n?\n\n?\n\n?xNk\n?y Nk\n?zNk\n\n?\n\n?\n\n?\n\n?\n\n. (3.7)\n\nThe Jacobian matrix can be easily calculated by\n\n[J]=[D][?]e , (3.8)\n\nwhere [D] is the first-order partial derivatives of the shape functions\nwritten in a matrix form as\n\n\n\nCH AP T ER 3 \u2013 NUM ER ICA L F O R M UL AT IO N 23\n\n[D]=\n\n?\n\n?\n\n?\n\n?\n\n??N1 ??N2 \u00b7\u00b7\u00b7 ??Nnne\n??N1 ??N2 \u00b7\u00b7\u00b7 ??Nnne\n??N1 ??N2 \u00b7\u00b7\u00b7 ??Nnne\n\n?\n\n?\n\n?\n\n?\n\n, (3.9)\n\nand [?]e is a matrix containing the global coordinates of the nodes in the\nvertices of element e , as the form\n\n[?]e =\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nx? 1 y?1 z? 1\nx? 2 y?2 z? 2\n...\n\n...\n...\n\nx? nne y?nne z? nne\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n. (3.10)\n\nAfter determining the Jacobian matrix with Eq. (3.8), the derivatives of\n\nthe shape functions in relation to the global coordinates can be calculated\n\nby multiplying both sides of Eq. (3.7) by the inverse of [J],\n\n[J]\u20131\n\n?\n\n?\n\n?\n\n?\n\n??Nk\n??Nk\n??Nk\n\n?\n\n?\n\n?\n\n?\n\n=\n\n?\n\n?\n\n?\n\n?\n\n?xNk\n?y Nk\n?zNk\n\n?\n\n?\n\n?\n\n?\n\n. (3.11)\n\nExtending this equation to all nne nodes and commuting the sides,\n\none obtains\n\n?\n\n?\n\n?\n\n?\n\n?xN1 ?xN2 \u00b7\u00b7\u00b7 ?xNnne\n?y N1 ?y N2 \u00b7\u00b7\u00b7 ?y Nnne\n?zN1 ?zN2 \u00b7\u00b7\u00b7 ?zNnne\n\n?\n\n?\n\n?\n\n?\n\n=[J]\u20131 [D] . (3.12)\n\nFinally, substituting into Eq. (3.5), the gradient of the variable of\n\ninterest is given by\n\n[??]=[J]\u20131 [D][??]e . (3.13)\n\nEquation (3.13) approximates the gradient of the variable of interest\n\nat any point\n?\n\n?,?,?\n?\n\ninside an element. This equation will be used\n\nto approximate the pressure gradient during the integration process in\n\nsection 3.6.\n\n\n\n24 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\n3.5 Three-dimensional elements\n\nIn this section, the shape functions of the four different three-\n\ndimensional elements considered is presented. Other geometrical char-\n\nacteristics, for instance, the calculation of the area of the faces and the\n\nvolume of the sub-control volumes can be found elsewhere [27, 40]. It is\nimportant to note that the number of sub-control volumes of each element\n\nis equal to the number of vertices, and the number of faces2 is equal to the\n\nnumber of edges. The elements considered in this work are the following:\n\n\u2022 Tetrahedron, with four vertices, six edges, and four triangular sides.\n\n\u2022 Hexahedron, with eight vertices, twelve edges, and six quadrilateral\nsides.\n\n\u2022 Prism, with six vertices, nine edges and five sides, where two are\ntriangular and three are quadrilateral.\n\n\u2022 Pyramid, with five vertices, eight edges and five sides, where four are\ntriangular and one is quadrilateral.\n\nAs there is still no method for generating arbitrary unstructured grids\n\nonly with hexahedrons, hybrid grids with hexahedrons and tetrahedrons\n\nare a good alternative. However, prisms and pyramids are necessary to\n\nperform the transition between tetrahedrons and hexahedrons, in order to\n\navoid non-conformity of the grid, as two neighboring elements must have\n\none side with the same form, triangular or quadrilateral.\n\nIn three dimensions, the construction of the control volume is equiv-\n\nalent to the two-dimensional situation. Each element is first divided into\n\na certain number of sub-control volumes, according to its number of\n\nvertices, and then the control volume is assembled with the sub-control\n\nvolumes surrounding the same node. As in two-dimensions, there is one\n\ncontrol volume associated to each grid node. The main ideas employed\n\nhere were presented in Maliska et al. [40].\n\n2 According to the nomenclature adopted in this work, the faces always refer to the\ninterfaces where the fluxes are calculated and not to the faces in the element\u2019s external sides.\n\n\n\nCH AP T ER 3 \u2013 NUM ER ICA L F O R M UL AT IO N 25\n\n3.5.1 Tetrahedron\n\nThe shape functions of the tetrahedron are linear functions; thus,\n\nthe Jacobian matrix is constant along the element. Table 3.1 shows the\n\ndefinition of the four shape functions for this type of element.\n\nTable 3.1 \u2013 Tetrahedron shape functions.\n\nN x , h , g)k  (\n\n1 - x - h - g\n\nx\n\nh\n\nN2 \n\nN1 \n\nN3 \n\nN4 g\n\nIn the sequence, Fig. 3.4 shows the standard tetrahedron and the local\n\ncoordinates of its vertices.\n\n1\n\n2\n\nh\n\nx\n\ng\n\n3\n\n4\n\nNode hx g\n\n1\n\n1\n\n1\n\n1\n\n0\n\n0\n\n00\n\n0 0\n\n0\n\n0 0\n\n2\n\n3\n\n4\n\nFigure 3.4 \u2013 Standard tetrahedron and local coordinates of the nodes.\n\nThe tetrahedron division generates four sub-control volumes. All of\n\nthem are irregular hexahedrons, limited by six quadrilateral sides, where\n\nthree of them are inner faces. Figure 3.5 illustrates these faces for one sub-\n\ncontrol volume of the element. The centroid coordinate of the faces for\n\n\n\n26 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nthis and other elements, as well as other aspects relative to sub-control\n\nvolumes and faces can be found in Maliska et al. [40] and Hurtado [27].\n\n1\n\n2\n\n3\n\n4\n\nFigure 3.5 \u2013 Faces in standard tetrahedron.\n\n3.5.2 Hexahedron\n\nTable 3.2 shows the definition of the shape functions for the hexahe-\n\ndron element. They are tri-linear functions of the local coordinates.\n\nTable 3.2 \u2013 Hexahedron shape functions.\n\nN x , h , g)k  (\n\n(1 - x - h - g) (1 ) (1 )\n\n(1 - x - h g) (1 ) \n\nx - h g (1 ) \n\nx h g\n\n(1 - x h g) \n\nx - h - g(1 ) (1 )\n\nx h - g (1 )\n\n(1 x) h (1 )- - g\n\nN2 \n\nN6 \n\nN1 \n\nN5 \n\nN3 \n\nN7 \n\nN4 \n\nN8 \n\n\n\nCH AP T ER 3 \u2013 NUM ER ICA L F O R M UL AT IO N 27\n\nThe standard hexahedron is a regular cube, with eight cubic sub-\n\ncontrol volumes. Figure 3.6 illustrates the standard hexahedron and the\n\nlocal coordinates of the nodes.\n\nh\n4\n\n1\n\n2\n\n3\n\n5\n\n6\n\n7\n\n8\n\nx\n\ng\nNode hx g\n\n1\n\n5\n\n1\n\n1\n\n1\n\n1\n\n0\n\n1\n\n0\n\n0\n\n0\n\n0\n\n0\n\n1\n\n1\n\n1\n\n0\n\n0\n\n1\n\n1\n\n0\n\n1\n\n0\n\n0\n\n0\n\n1\n\n2\n\n6\n\n3\n\n7\n\n4\n\n8\n\nFigure 3.6 \u2013 Standard hexahedron and local coordinates of the nodes.\n\nAll twelve inner faces are quadrilateral, mutually perpendicular. Fig-\n\nure 3.7 shows the three faces for the sub-control volume associated to node\n\n2.\n\n4\n\n1\n\n2\n\n3\n\n5\n\n6\n\n7\n\n8\n\nFigure 3.7 \u2013 Faces in standard hexahedron.\n\n\n\n28 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\n3.5.3 Prism\n\nThe prism is used as a transition element between tetrahedrons and\n\nhexahedrons, as it has both triangular and quadrilateral sides. Its shape\n\nfunctions are defined in Table 3.3.\n\nTable 3.3 \u2013 Prism shape functions.\n\nN x , h , g)k  (\n\n(1 - x - g - h) (1 )\n\nx - g (1 )\n\nh (1 )- g\n\n(1 - x g - h) \n\nx g\n\nh g\n\nN2 \n\nN6 \n\nN1 \n\nN5 \n\nN3 \n\nN4 \n\nThe standard prism and the coordinates of the nodes in the trans-\n\nformed space are shown in Fig. 3.8.\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\nh\n\nx\n\ng\n\nNode hx g\n\n1\n\n5\n\n1\n\n0\n\n1\n\n1\n\n0\n\n1\n\n0\n\n1\n\n00\n\n0 0\n\n0\n\n1\n\n0\n\n0\n\n0\n\n1\n\n2\n\n6\n\n3\n\n4\n\nFigure 3.8 \u2013 Standard prism and local coordinates of the nodes.\n\nAs in the tetrahedron, the sub-control volumes in the prism are\n\nirregular hexahedrons. Figure 3.9 illustrates the faces for one sub-control\n\n\n\nCH AP T ER 3 \u2013 NUM ER ICA L F O R M UL AT IO N 29\n\nvolume.\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\nFigure 3.9 \u2013 Faces in standard prism.\n\n3.5.4 Pyramid\n\nAs well as the prism, the pyramid is a transition element between\n\ntetrahedrons and hexahedrons, as it has four triangular sides and a quadri-\n\nlateral base. It needs, however, non-polynomial shape functions, in order\n\nto guarantee the continuity of the variable with the other elements [40].\nThe shape functions are listed in Table 3.4, as in Maliska et al. [40] and\nZgainski et al. [58].\n\nTable 3.4 \u2013 Pyramid shape functions.\n\nN x , h , g)k  (\n\nN2 \n\nN1 \n\nN5 \n\nN3 \n\nN4 \n\n[ (1 - x g) (1 - h) -  + x h g / (1 - g) ]14\n\n[ (1 + x g) (1 - h) -  + x h g / (1 - g) ]14\n[ (1 + x g) (1 + h) -  + x h g / (1 - g) ]14\n\n[ (1 - x g) (1 + h) -  + x h g / (1 - g) ]14\ng\n\n\n\n30 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nIn Fig. 3.10 the standard pyramid and the local coordinates of its\n\nvertices are shown. Differently from the other elements, coordinates ? and\n\n? can be negative.\n\n4\n\n1\n\n2\n\n3\n\n5\n\nh\n\nx\n\ng\nNode hx g\n\n1\n\n5\n\n1\n\n1\n\n1\n\n-1\n\n0\n\n-1\n\n01\n\n-1 0\n\n0\n\n-1\n\n0\n\n0\n\n1\n\n2\n\n3\n\n4\n\nFigure 3.10 \u2013 Standard pyramid and local coordinates of the nodes.\n\nThe way to build the pyramid sub-control volumes differs from that\n\nof the previous elements. In the pyramid, all sub-control volumes have\n\nthe base centroid as a common point, while for the other elements the\n\ncommon point is the element centroid. As a consequence, the inner faces\n\nconnecting the nodes in the base of the pyramid are triangular, while the\n\nfaces connecting the apex with the base are quadrilateral, as noted in Fig.\n\n3.11 in the division for one sub-control volume.\n\n4\n\n1\n\n2\n\n3\n\n5\n\nFigure 3.11 \u2013 Faces in standard pyramid.\n\n3.6 Integration of the governing equations\n\nThis section describes the application of the EbFVM in the discretiza-\n\ntion process. In order to obtain the mass conservation for each control\n\n\n\nCH AP T ER 3 \u2013 NUM ER ICA L F O R M UL AT IO N 31\n\nvolume, it is necessary to integrate Eqs. (2.1) and (2.8) in space and time,\n\nconsidering a control volume as the integration domain.\n\n3.6.1 Pressure equation\n\nFirst, the integration of the pressure equation leads to\n\n?\n\n?t\n\n?\n\n?V\n\n?ref C t\n?P1\n?t\n\ndV dt +\n\n?\n\n?t\n\n?\n\n?V\n\n~?\u00b7\n?\n\n?T c K \u00b7~?P1\n?\n\ndV dt =\n\n?\n\n?t\n\n?\n\n?V\n\n~?\u00b7\n\n?\n\n?\n\nn p\n?\n\nl =1\n\n?l c K \u00b7\n?\n\n~?Pc l 1 ??l ~?h\n?\n\n?\n\n?dV dt +\n\n?\n\n?t\n\n?\n\n?V\n\nn c v\n?\n\n?=1\n\nQ?? dV dt .\n\n(3.14)\n\nApplying the divergence theorem to Eq. (3.14) for both the second\n\nterm of the LHS and the first term of the RHS, we obtain\n\n?\n\n?t\n\n?\n\n?V\n\n?ref C t\n?P1\n?t\n\ndV dt +\n\n?\n\n?t\n\n?\n\n?S\n\n?\n\n?T c K \u00b7~?P1\n?\n\n\u00b7d~S dt =\n\n?\n\n?t\n\n?\n\n?S\n\nn p\n?\n\nl =1\n\n?\n\n?l c K \u00b7~?w l\n?\n\n\u00b7d~S dt +\n?\n\n?t\n\n?\n\n?V\n\nn c v\n?\n\n?=1\n\nQ?? dV dt ,\n\n(3.15)\n\nwhere ~?w l =\n?\n\n~?Pc l 1 ??l ~?h\n?\n\nand d~S is the differential area vector, normal\nto the control volume contour in any point and pointing outside the\n\nvolume. The surface integrals are performed over the control surface.\n\nConsidering a polyhedric control volume, the surface integrals in Eq.\n\n(3.15) can be expressed as the sum of the integrals over all faces in the\n\ncontrol surface. That is,\n\n?\n\n?S\n\n?\n\n?T c K \u00b7~?P1\n?\n\n\u00b7d~S =\n?\n\nf ?Fp\n\n?\n\n?S f\n\n?\n\n?T c K \u00b7~?P1\n?\n\n\u00b7d~S , (3.16)\n\nwhere f ? Fp are all faces in the control surface, following the notation\nused in Maliska et al. [40]. Approximating these integrals by means of the\nmidpoint rule [3]:\n\n\n\n32 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\n?\n\nf ?Fp\n\n?\n\n?S f\n\n?\n\n?T c K \u00b7~?P1\n?\n\n\u00b7d~S =\n?\n\nf ?Fp\n\n?\n\n?T c K \u00b7~?P1\n?\n\nf?\n\u00b7?~S f , (3.17)\n\nwhere f? represents the integration point located at the centroid of face\n\nf and ?~S f denotes the face area vector, pointing outside of the control\nvolume.\n\nSubstituting Eq. (3.17) into Eq. (3.15) and applying the same proce-\n\ndure for the other term containing a surface integral, we obtain\n\n?\n\n?t\n\n?\n\n?ref ?V C t\n?P1\n?t\n\n?\n\np\ndt +\n\n?\n\n?t\n\n?\n\n?\n\n?\n\n?\n\nf ?Fp\n\n?\n\n?T c K \u00b7~?P1\n?\n\nf?\n\u00b7?~S f\n\n?\n\n?\n\n?\ndt =\n\n?\n\n?t\n\n?\n\nf ?Fp\n\n?\n\n?\n\n?\n\n \n\nn p\n?\n\nl =1\n\n?l c K \u00b7~?w l\n\n!\n\nf?\n\n\u00b7?~S f\n\n?\n\n?\n\n?\ndt +\n\n?\n\n?t\n\n \n\nn c v\n?\n\n?=1\n\nQ?\n\n!\n\np\n\ndt ,\n\n(3.18)\n\nwhere Q? =Q???V .\nEquation (3.18) refers to the control volume around node p , with\n\nvolume equal to ?Vp , and is formed by sub-control volumes from different\nelements. In three-dimensional domains each sub-control volume con-\n\ntributes with three faces f over a control surface. The exception is the\n\nsub-control associated to the apex of a pyramid, which contributes to the\n\ncontrol volume with four faces.\n\nFor the time integration, all terms with the exception of the pressure\n\ntime derivative will be considered constant during the time ?t . Therefore,\nthey have to be evaluated between the old time level (n \u20131) and the current\n\ntime level (n ), where the mobilities are unknowns. The most complex\n\ncase is when all time levels are chosen equal to the current time level\n\nn , generating a fully implicit scheme. This will not be considered in the\n\npresent work, as discussed in Chapter 4. In this work, the pressure and\n\nthe concentration equations are decoupled. Therefore, the terms that are\n\ndependent on the concentration will be evaluated at time level n \u20131. Note\n\nthat the total compressibility depends on the component concentrations,\n\nand, therefore, is known only at the old time level. Thus, Eq. (3.18) can be\n\nwritten in a matrix form as\n\n\n\nCH AP T ER 3 \u2013 NUM ER ICA L F O R M UL AT IO N 33\n\n?\n\n??ref ?V C\nn \u20131\nt\n\n?\n\nP n1 ?P\nn \u20131\n1\n\n?\n\n?t\n\n?\n\n?\n\np\n\n+\n\n?\n\ne ?Ep\n\n?\n\nf ?Fep\n\n(?T c)\nn \u20131\nf?\n[?S]T\n\nf?\n[K ]e [?P1]\n\nn\nf?\n=\n\n?\n\ne ?Ep\n\n?\n\nf ?Fep\n\nn p\n?\n\nl =1\n\n(?l c)\nn \u20131\nf?\n[?S]T\n\nf?\n[K ]e [?w l ]\n\nn \u20131\nf?\n+\n\nn c v\n?\n\n?=1\n\n?\n\nQ n\n?\n\n?\n\n?\n\np\n,\n\n(3.19)\n\nwhere e ? Ep are all elements that are around node p , contributing to\nthe control volume formation, f ? Fep are the faces from element e in\nthe control surface and ?t is the timestep. Note that in Eq. (3.18) the\nsummation is over f ? Fp and here it was split in two summations, as\nin Maliska et al. [40]. Another point is that the subscript of the well flow\nterm Q?, defined posteriorly in Eq. (3.25), is n?. Actually, when the well is\n\nproducing at a specified bottom hole pressure the phase mobility term is\n\nevaluated at time level n -1 and the pressure difference term is evaluated at\n\ntime level n .\n\nIt is necessary to introduce an approximation for the gradients\n\npresent in Eq. (3.19). The conventional approach in the EbFVM is to\n\nassume local variation in each element according to the same functions\n\nused in the coordinate transformation. Therefore, Eq. (3.13) can be used\n\ndirectly here, and Eq. (3.19) can be written as\n\n?\n\n??ref ?V C\nn \u20131\nt\n\n?\n\nP n1 ?P\nn \u20131\n1\n\n?\n\n?t\n\n?\n\n?\n\np\n\n+\n?\n\ne ?Ep\n\n?\n\nf ?Fep\n\n(?T c)\nn \u20131\nf?\n[b]T\n\nf?\n\n?\n\nP?1\n?n\n\ne\n=\n\n?\n\ne ?Ep\n\n?\n\nf ?Fep\n\nn p\n?\n\nl =1\n\n(?l c)\nn \u20131\nf?\n[b]T\n\nf?\n[w? l ]\n\nn \u20131\ne +\n\nn c v\n?\n\n?=1\n\n?\n\nQ n\n?\n\n?\n\n?\n\np\n,\n\n(3.20)\n\nwhere [w? l ]e is defined as\n\n[w? l ]e =\n?\n\nP?c l 1\n?\n\ne\n?\n?\n\n\u02c6?l h\n?\n\ne\n, (3.21)\n\nand [b]T\nf?\n\nis a vector defined for each face f inside element e as\n\n\n\n34 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\n[b]T\nf?\n=[?S]T\n\nf?\n[K ]e [J]\n\n?1\nf?\n[D] f? . (3.22)\n\nThis operator has the similar function of the transmissibilities in\n\nconventional finite volume methods, that is, a coefficient to connect the\n\npressure between neighboring control volumes. As it is a function only\n\nof the geometry and medium, and these entities do not vary along the\n\nsimulation, it is calculated only once in the beginning of the simulation.\n\n3.6.2 Concentration equation\n\nApplying the same approach for the concentration equation, the\n\nfollowing discrete equation is obtained:\n\n?\n\n??ref ?V\n\n?\n\nC? n\n?\n?C? n \u20131\n\n?\n\n?\n\n?t\n\n?\n\n?\n\np\n\n=\n\n?\n\nf ?Fp\n\nn p\n?\n\nl =1\n\nh\n\n(C?l )\n?\nf?\n\n?\n\nql\n??\n\nf? +(D?l )\n?\nf?\n\ni\n\n+\n\n?\n\nR?\n?\n\n??\n\n?\n\np\n\n,\n\n(3.23)\n\nwhere\n?\n\nql\n?\n\nf? is the flux of phase l across face f , defined as\n\n?\n\nql\n??\n\nf? =(?l c)\n?\nf?\n[b]T\n\nf?\n\nn\n\n?\n\nP?l\n?n\n\ne\n?\n?\n\n\u02c6?l h\n??\n\ne\n\no\n\n. (3.24)\n\nHere, the time level where properties are evaluated is represented by\n\n? for all terms except the phase pressure term. As stated before, in this\n\nwork the pressure and the concentration are decoupled, so that when the\n\nconcentration is solved the pressure at time level n is already determined.\n\nThis discussion is further detailed in the next chapter.\n\n3.7 Well models\n\nThe realistic representation of wells in numerical formulations has\n\nalways been a challenging problem in reservoir simulation. The main\n\nproblem resides in the difference in scale between the well, order of cen-\n\ntimeters, and the reservoir\u2019s order of kilometers. With these scales, in order\n\nto model the well and to capture the real pressure gradient in its vicinity, an\n\nextremely fine grid would be necessary. However, this kind of approach is\n\n\n\nCH AP T ER 3 \u2013 NUM ER ICA L F O R M UL AT IO N 35\n\nnot usual, since it would demand high computational effort. Therefore, an\n\nanalytical mathematical model for calculating a local solution is the usual\n\napproach to couple the well variables, as pressure and flow rate, with the\n\nreservoir variables. This approach is known as well model, which provides\n\nthe well index coefficient, and when formulated with too many restrictions\n\nresults in poor and non-realistic approximations to the local problem [54].\nAs stated previously, both injection and production wells are con-\n\nsidered source and sink terms in the flow equations. The condition for\n\nthe wells can be either constant volumetric flow rate or constant bottom\n\nhole pressure. In the first case, the flow rate Q? present in the integrated\n\nequations is equal to the value prescribed. For the second case, the flow\n\nrate must be related to the pressure gradient between well and reservoir\n\n[46], and may be expressed as\n\nQ? =\nn p\n?\n\nl =1\n\nC?l ?l WI\n?\n\nPwf ?Pl\n?\n\n. (3.25)\n\nIn this equation, WI is the well index coefficient, which is basically\n\na function of geometry and rock properties, and relates the well pressure\n\n(Pwf ) with the wellblock3 pressure (Pl ). This parameter plays a similar role\n\nas the operator [G]T\nf?\n\ndefined in Eq. (3.22), even with the same unity,\n?\n\nL3\n?\n\n.\n\nThe well models considered in UTCHEM are based on formulations\n\nby Peaceman [46] and Babu and Odeh [4]. Even though these models are\nbased on several assumptions, they are often used in situations where the\n\nassumptions are not respected, as more accurate models are not easy to\n\nobtain. Recently, several authors [1, 19, 35, 57] developed methodologies\nthat calculate the well index for arbitrary well configurations so that the\n\nclassical model assumptions can be avoided. These models are more\n\ncomplex than the common ones, as they are based on more complete\n\nanalytical solutions in the near well region, providing a less restrictive\n\nmodel. The formulation proposed by Maizeret [35], Ouyang and Aziz [43]\nand Wolfsteiner et al. [57], that uses Green\u2019s function for obtaining the\nanalytical solution, is explained with details in Karpinski et al. [30] and\nMaliska et al. [38].\n\n3 In traditional methods with structured grids, the well is located in the center of the grid-\nblocks, and a gridblock containing a well is the denominated wellblock. In this dissertation,\nthe well is located in the grid nodes, and the wellblock in this case will represent the control\nvolume containing a well in its node.\n\n\n\n36 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nIt is not the objective of this work to implement and use a complex\n\nwell model. Therefore, although cognizant of Peaceman\u2019s model\u2019s (1983)\n\nrestrictions, and that it is not the ideal model to be used with an unstruc-\n\ntured grid [27, 41], it will be used in the EbFVM application in UTCHEM, as\nit is the base model used in UTCHEM for cartesian grids.\n\nSince this model was originally obtained for cartesian grids, some\n\nchanges are necessary in order to adapt this model for unstructured grids\n\nand to obtain reasonable solutions. Appendix A describes how Peace-\n\nman\u2019s model can be implemented for two-dimensional unstructured grids,\n\naccording to the same procedure presented in Maliska et al. [37]. The\nextension for 3D grids is straightforward for vertical wells in grids that\n\ncontain only horizontal layers. In this case, each layer of the grid can be\n\nconsidered as an areal 2D grid and the same approach in Maliska et al. [37]\ncan be applied.\n\nIn order to run cases with more complex geometry or containing wells\n\nwith arbitrary trajectories, a compatible model with these features would\n\nbe necessary in order to obtain reliable results. If only the expected flow\n\nbehavior is being analyzed, then the well model present in UTCHEM is\n\nsufficient.\n\n3.8 Face mobility evaluation\n\nIn both discretized equations, (3.20) and (3.23), the only term that\n\nstill needs to be approximated is the mobility term in the face. The\n\ntechnique commonly used for spatial interpolation of mobility terms is\n\nthe upwind-type interpolation scheme. In this work a single-point upwind\n\nscheme is used, where the upstream weighting of the mobility in each\n\nface is determined analyzing whether the flux across the face is positive\n\nor negative [15], as respectively illustrated in Fig. 3.12.\nIn this example, if the flux across the face is positive, the property of\n\nnode 1 is used as the interpolated variable. On the other hand, if the flux\n\nis negative, the property of node 4 is used in the face. Although this is the\n\nmost simple upwind scheme, it provides physically consistent solutions, as\n\nthe monotonicity is guaranteed [31]. However, it can provide a significant\ngrid orientation effect, as it does not consider the actual flow direction into\n\nthe numerical approximations of the advective terms. In order to avoid this\n\n\n\nCH AP T ER 3 \u2013 NUM ER ICA L F O R M UL AT IO N 37\n\n12\n\n3 4\n\nDS\nrv\n\nr\n\n(a)\n\n1\n\n4\n\nv\nr\n\nDS\nr\n\n2\n\n3\n\n(b)\n\nFigure 3.12 \u2013 (a) Upstream node for positive flux (b) and negative flux.\n\nundesirable effect, other schemes that take into account the true direction\n\nof the flow could be used [28].\n\n3.9 Linear system assembling\n\nIn this section, the basic procedure for assembling the linear system\n\nfor the pressure equation is presented. The procedure described here is\n\nalso functional for the concentration equation when ? = n in Eq. (3.23),\nhowever the form of the equations in this case is different, as a Newton\n\nmethod is used in order to solve this equation implicitly. Therefore, for\n\ndidactic purpose, the pressure equation, Eq. (3.20), will be considered\n\nhere. Grouping the coefficients that multiply P1, the global conservation\n\nequation for a given control volume associated to node p can be written as\n\n?\n\n?ref ?V C n \u20131t\n?t\n\n?\n\np\n\n(P1)\nn\np +\n\n?\n\ne ?Ep\n\n?\n\nf ?Fep\n\n?\n\nq ?Ne\n(?T c)\n\nn \u20131\nf?\n\n?\n\nb q\n?\n\nf?\n(P1)\n\nn\nq =\n\n?\n\ne ?Ep\n\n?\n\nf ?Fep\n\nn p\n?\n\nl =1\n\n?\n\nq ?Ne\n(?l c)\n\nn \u20131\nf?\n\n?\n\nb q\n?\n\nf?\n(w l )\n\nn \u20131\nq +\n\nn c v\n?\n\n?=1\n\n?\n\nQ n\n?\n\n?\n?V\n?\n\np\n+\n\n?\n\n?ref ?V C n \u20131t\n?t\n\n?\n\np\n\n(P1)\nn \u20131\np ,\n\n(3.26)\n\nwhere q ?Ne are all the nodes located at the vertices of element e [40].\nIn the implementation of the EbFVM, it is common to perform the\n\nlinear system assembling element by element, as the discretization method\n\nitself is based on local approximations for elements. However, as Eq. (3.26)\n\n\n\n38 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\n1\n\n2\n3\n\n4\n\n5\n6\n\n8\n\n7\n\n3\n\n3\n\n4\n\n2\n1\n\n1\n2 3 4 5 6 7\n\n2\n3\n4\n5\n6\n7\n\n1 8\n\n8\n\n1\n2 3 4 5 6 7\n\n2\n3\n4\n5\n6\n7\n\n1 8\n\n8\n\n1\n2 3 4 5 6 7\n\n2\n3\n4\n5\n6\n7\n\n1 8\n\n8\n\n1\n\n1\n\n2\n\n2\n\n3\n\n3\n\n4\n\n4\n\n5\n\n5\n\n6\n\n6\n\n7\n\n7\n\n2\n\n2\n\n3\n\n3\n\n4\n\n4\n\n5\n\n5\n\n6\n\n6\n\n7\n\n7\n\n1\n\n1\n\n8\n\n8\n\n8\n\n8\n\n421\n\nL\no\n\nca\nl M\n\nat\nri\n\nx\n[A\n\n] e\nM\n\nat\nri\n\nx \nA\n\nss\nem\n\nb\nli\n\nn\ng\n\nG\nlo\n\nb\nal\n\n M\nat\n\nri\nx\n\n[A\n]\n\nElement Node 1\n\nConnectivity List\n\nNode 2 Node 3 Node 4\n\n1\n\n1\n\n2\n\n2\n\n23 3\n\n4\n\n4\n\n4\n\n5\n\n5 6 7\n\n7\n\n8\n\n8\n\n8\n\n8\n\nFigure 3.13 \u2013 Matrix assembling example for a grid with four elements and\neight nodes.\n\nindicates, to realize the assembling for a given control volume, first the\n\nelements that are present in the formation of the control volume should be\n\nvisited, then some faces in this element and then all nodes of this element.\n\nIf it was performed this way, a given element would be visited several times,\n\nas it contributes to several control volumes.\n\nThus, it is more advantageous to visit each element only once at each\n\ntime level, and calculate the contributions for each sub-control volume,\n\nstoring these portions in a local matrix. After visiting all elements, the\n\ncoefficients in the local matrix are transferred to the global matrix with\n\nthe information in the connectivity list to find the correct position in\n\nthe global matrix. The final form of the matrix is then assembled by\n\nsumming the contributions of each element. Figure 3.13 illustrates the\n\nmatrix assembling for a two-dimensional case containing one triangle and\n\n\n\nCH AP T ER 3 \u2013 NUM ER ICA L F O R M UL AT IO N 39\n\nthree quadrilateral elements. As this grid has eight nodes, the dimension\n\nof the global matrix is 8\u00d78.\nIn order to illustrate with more detail how the linear system is as-\n\nsembled, the local matrix of element 1 (E 1) will be obtained, and in the\n\nsequence, the equation of node 6 (N6). As only element 1 contributes to\n\nthe control volume associated with this node, with two faces involved in\n\nthe mass balance equation, building the matrix of this element is enough\n\nfor obtaining the equation of this control volume. Noting that each face\n\ncontributes with two sub-control volumes in a 2D case, with a positive\n\ncontribution for one control volume and a negative contribution for the\n\nother, one has in the local system:\n\n\u2022 Sub-control volume 1 (SC V 1), associated with node 5 (N5):\n\n(A 11)E 1 =\n\n?\n\n?ref ?V C n \u20131t\n?t\n\n?\n\nSV C 1\n\n+(?T c)\nn \u20131\nf? 1\n(b 1) f? 1 ?(?T c)\n\nn \u20131\nf? 4\n(b 1) f? 4\n\n(A 12)E 1 =(?T c)\nn \u20131\nf? 1\n(b 2) f? 1 ?(?T c)\n\nn \u20131\nf? 4\n(b 2) f? 4\n\n(A 13)E 1 =(?T c)\nn \u20131\nf? 1\n(b 3) f? 1 ?(?T c)\n\nn \u20131\nf? 4\n(b 3) f? 4\n\n(A 14)E 1 =(?T c)\nn \u20131\nf? 1\n(b 4) f? 1 ?(?T c)\n\nn \u20131\nf? 4\n(b 4) f? 4\n\n\u2022 Sub-control volume 2 (SC V 2), associated with node 6 (N6):\n\n(A 21)E 1 =(?T c)\nn \u20131\nf? 2\n(b 1) f? 2 ?(?T c)\n\nn \u20131\nf? 1\n(b 1) f? 1\n\n(A 22)E 1 =\n\n?\n\n?ref ?V C n \u20131t\n?t\n\n?\n\nSV C 2\n\n+(?T c)\nn \u20131\nf? 2\n(b 2) f? 2 ?(?T c)\n\nn \u20131\nf? 1\n(b 2) f? 1\n\n(A 23)E 1 =(?T c)\nn \u20131\nf? 2\n(b 3) f? 2 ?(?T c)\n\nn \u20131\nf? 1\n(b 3) f? 1\n\n(A 24)E 1 =(?T c)\nn \u20131\nf? 2\n(b 4) f? 2 ?(?T c)\n\nn \u20131\nf? 1\n(b 4) f? 1\n\n\u2022 Sub-control volume 3 (SC V 3), associated with node 7 (N7):\n\n(A 31)E 1 =(?T c)\nn \u20131\nf? 3\n(b 1) f? 3 ?(?T c)\n\nn \u20131\nf? 2\n(b 1) f? 2\n\n(A 32)E 1 =(?T c)\nn \u20131\nf? 3\n(b 2) f? 3 ?(?T c)\n\nn \u20131\nf? 2\n(b 2) f? 2\n\n(A 33)E 1 =\n\n?\n\n?ref ?V C n \u20131t\n?t\n\n?\n\nSV C 3\n\n+(?T c)\nn \u20131\nf? 3\n(b 3) f? 3 ?(?T c)\n\nn \u20131\nf? 2\n(b 3) f? 2\n\n(A 34)E 1 =(?T c)\nn \u20131\nf? 3\n(b 4) f? 3 ?(?T c)\n\nn \u20131\nf? 2\n(b 4) f? 2\n\n\n\n40 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\n\u2022 Sub-control volume 4 (SC V 4), associated with node 8 (N8):\n\n(A 41)E 1 =(?T c)\nn \u20131\nf? 4\n(b 1) f? 4 ?(?T c)\n\nn \u20131\nf? 3\n(b 1) f? 3\n\n(A 42)E 1 =(?T c)\nn \u20131\nf? 4\n(b 2) f? 4 ?(?T c)\n\nn \u20131\nf? 3\n(b 2) f? 3\n\n(A 43)E 1 =(?T c)\nn \u20131\nf? 4\n(b 3) f? 4 ?(?T c)\n\nn \u20131\nf? 3\n(b 3) f? 3\n\n(A 44)E 1 =\n\n?\n\n?ref ?V C n \u20131t\n?t\n\n?\n\nSV C 4\n\n+(?T c)\nn \u20131\nf? 4\n(b 4) f? 4 ?(?T c)\n\nn \u20131\nf? 3\n(b 4) f? 3\n\nIn these equations,\n?\n\n?ref ?V\n?\n\nSV C k\nrepresents the porous volume of\n\nsub-control volume k , and the porous volume of the CV is the sum of the\n\nporous volume of the SCVs that form this CV.\n\nThe local matrix of the first element is built with the equations listed.\n\nThe equation for node 6 can be directly assembled from line 2 of the matrix\n\n[A]E 1 , combining the independent term of Eq. (3.28). Therefore, for node 6\none can write\n\n(A 21)E 1 (P1)\nn\nN5\n+(A 22)E 1 (P1)\n\nn\nN6\n+(A 23)E 1 (P1)\n\nn\nN7\n+(A 24)E 1 (P1)\n\nn\nN8\n= BN6 , (3.27)\n\nwhere the independent term BN6 represents the RHS of Eq. (3.26). Writing\n\nEq. (3.27) in a more compact way for any node p ,\n\n?\n\nk ?Tp\n\nA k(P1)\nn\nk = Bp , (3.28)\n\nwhere k ?Tp represents all nodes in the stencil of node p [40]. This stencil\nis formed by the nodes from the elements that contain node p , that is, from\n\nthe elements that are present in the control volume construction.\n\nIn Eq. (3.28), A k are the not-null coefficients from the discrete\n\nequation, associated to nodes k , and the independent term Bp includes\n\nall terms in the equation of node p that are not function of P1 in the time\n\nlevel n . When all equations of all control volumes are grouped, a linear\n\nsystem with a sparse matrix is obtained. The finer the grid is, the higher\n\nthe sparsity of the coefficient matrix [36].\n\n\n\nCHAPTER\n\n4\nT I M E S T E P PI N G A P P ROAC H E S\n\nAs presented in the integrated concentration equation, Eq. (3.23), it is\n\nnecessary to choose the time level where the mobilities will be evaluated.\n\nDifferent formulations are obtained depending on this choice. In the case\n\nof ? = n \u20131, an explicit evaluation of the terms will be conducted (IMPEC\nmethod). On the other hand, if ? = n , a sequential semi-implicit formu-\nlation will be employed (SEQ method). This formulation is denominated\n\nsemi-implicit because, in this work, in a given time step the pressure is\n\nalways determined before the concentrations; thus, for the concentration\n\nequation the pressure is an explicit term. The fully implicit formulation,\n\nwhere both concentrations and pressure are determined implicitly and\n\ntogether in the same matrix, is not an available option in the UTCHEM\n\nsimulator.\n\nIn the next sections the IMPEC and SEQ methods are presented.\n\n4.1 IMPEC method\n\nIn this method, a complete explicit evaluation of the flux is per-\n\nformed, that is, ? = n . From Eq. (3.23) is possible to rearrange the terms\nas\n\n41\n\n\n\n42 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\n?\n\nC??\n?n\n\np\n=\n\n?t\n?\n\n??V\n?\n\np\n\n?\n\nf ?Fp\n\nn p\n?\n\nl =1\n\nh\n\n(C?l )\nn \u20131\nf?\n\n?\n\nql\n?n \u20131\n\nf? +(D?l )\nn \u20131\nf?\n\ni\n\n+\n\n?t\n?\n\n??V\n?\n\np\n\n?\n\nR n \u20131\n?\n\n??\n\n?\n\np\n\n+\n?\n\nC??\n?n \u20131\n\np\n,\n\n(4.1)\n\nwhere all terms in the RHS are known.\n\nIn this scheme, first the pressure is solved implicitly through a lin-\n\near system involving Eq. (3.27), using a time-lagged mobility, and then\n\nthe concentrations are updated through a group of algebraic equations,\n\nrepresented by Eq. (4.1). Although the IMPEC method reduces drastically\n\nthe computational effort in each time step, it imposes several restrictions\n\non the magnitude of the timestep that can be employed for obtaining the\n\nconcentrations without oscillations in the solutions [14]. The stability of\nthe solution is governed by the Courant number (Cr), that is written in\n\nUTCHEM as\n\nCr =?t\n?\n\n|Q T |\n??V\n\n?\n\nmax\n\n, (4.2)\n\nwhere Q T is the total injection/production rate per wellblock, ?t is the\ntimestep, and ??V is the porous volume.\n\nThe simulator has three automatic options for determining the time-\n\nstep size: selector based on the method of relative changes for the first\n\nthree components (water, oil, and surfactant), selector based on the\n\nmethod of relative changes for all components, and selector based on\n\nchanges in dimensionless concentration for all components, as described\n\nin UTCHEM-9.9 [56]. The Courant number calculated with the timestep\nfrom any of these options has to be between a minimum and a maximum\n\nvalue, specified by the user. In case either of these restrictions is not\n\nrespected, the timestep is recalculated using the minimum/maximum\nCourant number, isolating ?t from Eq. (4.2). In other works, studies were\nrealized in order to verify the limitations of this condition, as well as to\n\npropose different forms to evaluate the stability criterion [14, 23].\nOne point that is appealing in the IMPEC strategy is the fact that\n\nonly one linear system is solved in each time step, and the rest of the\n\nprocedure is realized through algebraic expressions. Therefore, this is the\n\n\n\nCH AP T ER 4 \u2013 T IM ES T EPPI NG AP P ROACH ES 43\n\nfastest approach on a pertimestep basis; however, the Courant stability\n\ncriterion for an explicit scheme always requires a limited timestep size.\n\nBoth the explicit updating of saturations or concentrations and the time-\n\nlagged and pressure-dependent mobility terms in the pressure equation\n\nare sources of instability. This instability can particularly arise in enhanced\n\noil recovery simulations where shear-dependent viscosities and capillary\n\nnumber dependence of relative permeabilities exist [23]. The stability\nrestrictions make the IMPEC method at times inefficient or even make it\n\nimpossible to solve some simulation problems.\n\nThe following is the summary of the procedure for one time step\n\napplying the IMPEC algorithm:\n\n1. Solve the pressure with the time-lagged mobilities.\n\n2. Calculate the phase velocity in each face, applying Eq. (3.24).\n\n3. Update the concentration field for all components, with Eq. (4.1).\n\n4. Determine the new phase mobility terms.\n\n5. Advance in time.\n\n6. Determine the new timestep, based on the Courant number.\n\n7. Return to step 1 until final time has reached.\n\nOriginally, the timestep adopted in the pressure and concentration\n\nequations are the same, usually being determined obeying the Courant sta-\n\nbility condition. However, in certain problems the pressure field changes\n\nmore slowly than the concentration field, and, in this way, it is possible\n\nto accelerate the algorithm calculating the pressure less times and, with\n\nthe same total velocity field obtained with this pressure field, to update\n\nthe concentration several times [28]. This method is an adaptation of the\nIMPEC method, described in the sequence, and will be designated as A-\n\nIMPEC.\n\n4.2 Adaptive IMPEC method\n\nSince the stability restriction in the IMPEC method is caused by the\n\nexplicit approximation of the concentration, Hurtado et al. [28] proposed\na scheme where the concentration would be updated with small timesteps\n\nduring a certain period, obeying the stability criterion, but keeping frozen\n\n\n\n44 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nthe total velocity field during this period. Only after this the pressure linear\n\nsystem would be solved again and the new total velocity updated.\n\nThe strategy of using larger timesteps for the pressure was first pro-\n\nposed by Chen et al. [10] in a two-phase problem. However, in his work\nit was not clear how much larger this pressure timestep could be without\n\ndamaging the numerical solution. In Hurtado et al. [28] an adaptive\nstrategy for controlling the pressure timestep, based on the mean variation\n\nof the total velocity, was proposed for two-phase cases in two-dimensional\n\ndomains. The scheme presented here is an extension for multiphasic\n\nthree-dimensional cases and was applied for both the FDM and EbFVM\n\nmethods. For the sake of simplicity, it will be described with more detail\n\nonly for the formulation studied in the present work, but the idea is the\n\nsame for both.\n\nAs the conventional IMPEC scheme, in a given time step n , first\n\nthe pressure is solved using the time-lagged mobilities. After solving the\n\npressure implicitly, the total velocity in each face,\n?\n\nqT\n?\n\nf? , is determined,\n\nusing (3.24) for all phases1. The idea now is to solve the concentration for\n\na certain number of steps, designated here by m steps, keeping this total\n\nvelocity stationary and determining the phase velocities in each step by\n\napplying the Buckley-Leverett expression, that is\n\n?\n\nql\n?\n\nf? =(Fl ) f?\n\n?\n\n?\n\n?\n\n?\n\nqT\n?\n\nf? +\nn p\n?\n\nj=1\n\n?j c [b]\nT\nf?\n\n?\n\n[w? l ]e ?\n?\n\nw? j\n?\n\ne\n\n?\n\n?\n\n?\n\n?\n, (4.3)\n\nwhere the subscript j is used in summing over the phases. The value j =l\ncan be included or not, as it does not contribute to the expression. The\n\nterm (Fl ) f? is the fractional flux of phase l , defined as\n\n(Fl ) f? =\n?l c\n\nn p\n?\n\nj=1\n?j c\n\n. (4.4)\n\nWith the phase velocity, the concentration equation, Eq. (4.1), can\n\nbe applied in order to update this variable. With the new concentrations,\n\nthe mobilities can be updated as well as the phase velocities, applying this\n\nprocess until the concentration is solved m times. Only after this period\n\n1 Actually, the fluxes are determined directly without calculating the velocities first, but it is\nmore intuitive to say that the velocities are obtained instead.\n\n\n\nCH AP T ER 4 \u2013 T IM ES T EPPI NG AP P ROACH ES 45\n\nthe pressure, as well as the total velocity field, are solved again. This period\n\nwhere the total velocity is kept frozen, between the time level n and n+m , is\ngiven by the pressure timestep (?t P ), that is larger than the concentration\ntimestep (?t C ).\n\nThe concentration timestep is determined with the same criterion\n\napplied in the conventional IMPEC formulation, and for the pressure\n\ntimestep an adaptive strategy is used, based on the variation of the total\n\nvelocity field, as performed in Maliska et al. [42]. The idea is to allow\nlarge timesteps when this field changes slowly, reducing it progressively\n\nwhen the velocity starts to change faster. For this, the following relation\n\nis employed [42]:\n\n?t n+mP =?t\nn\nP\n\nTOL\n?\n\n?q?T\n?n\n\nmax\n\n, (4.5)\n\nwhere ?t n+mP is the new pressure timestep, after solving the concentra-\ntions m times. The parameter TOL is the admissible variation for the\n\nparameter\n?\n\n?q?T\n?n\n\nmax, which is related to the maximum variation of the total\n\nvelocity, given by\n\n?\n\n?q?T\n?n\n\nmax =\n1\n\nNorm\nmax\n\np\n\n?\n\n?\n\n?\n\n?\n\n?\n\nf ?Fp\n\n?\n\n?\n\n?\n\n?\n\nqT\n?n\n\nf ?\n?\n\nqT\n?n \u20131\n\nf\n\n?\n\n?\n\n?\n\n?p?Vp\n\n?\n\n?\n\n?\n\n?\n\n. (4.6)\n\nThe numerator of the expression is the total flux variation in the\n\ncontrol surface of the control volume associated to node p , and it is divided\n\nby the porous volume of the CV. This expression is calculated for all control\n\nvolumes, in order to determine the maximum value in the grid. This\n\nmaximum value is normalized with the parameter Norm, given by\n\nNorm = max\np\n\n?\n\n?\n\n?\n\n?\n\n?\n\nf ?Fp\n\n?\n\n?\n\n?\n\n?\n\nqT\n?n=1\n\nf\n\n?\n\n?\n\n?\n\n?p?Vp\n\n?\n\n?\n\n?\n\n?\n\n, (4.7)\n\nwhich is similar to the parameter defined before, but evaluated at the first\n\ntime level, considering that\n?\n\nqT\n?n=0\n\nf = 0 in all faces of all control volumes.\nThere is no physical limit for the maximum pressure timestep size\n\nthat can be applied during a simulation. The constraint is related only to\n\nthe error for keeping the same total velocity during a large period of time.\n\nTherefore, in this work the value specified for the tolerance TOL is 0.01,\n\n\n\n46 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nwhich provided significant reductions in the computational time without\n\nintroducing notable errors in the numerical solutions.\n\nThe following is the basic procedure for one pressure time step, from\n\nlevel n to level n+m , applying the A-IMPEC algorithm:\n\n1. Solve the pressure with the time-lagged mobilities.\n\n2. Calculate the total velocity in each face, applying Eq. (3.24) for all\n\nphases.\n\n3. Determine the new pressure timestep, using Eq. (4.5), and store\n\nthe current time t old = t n .\n\n4. Repeat the following m times, until t n+1 > t old +?t n+mP :\n\n4.1. Calculate the phase velocity in each face, through Eq. (4.3).\n\n4.2. Update the concentration field for all components, with Eq.\n\n(4.1).\n\n4.3. Determine the new phase mobility terms.\n\n4.4. Advance the time by t n+1=t n +?t C .\n\n4.5. Determine the new concentration timestep, based on the\n\nCourant number.\n\n5. Return to step 1 until final time has reached.\n\nAs will be seen in Chapter 5, this scheme reduces the computational\n\ntime significantly, as the pressure linear system, usually the most consum-\n\ning process in a simulation, is solved less times than the conventional\n\nIMPEC formulation. The algorithm can be applied to problems with any\n\nnumber of components and phases. The only limitation is when any\n\ncompressibility is present. In this case the pressure, and, therefore, the\n\ntotal velocity, varies more in the same position when compared to an\n\nincompressible problem. Therefore, the pressure needs to be solved at\n\neach time step and the A-IMPEC approach cannot be used in this case.\n\n4.3 Sequential method\n\nThe idea of the sequential method is to improve the stability of the\n\nIMPEC method by incorporating implicit treatment of concentrations, but\n\nwithout solving simultaneously for pressures and concentrations. There-\n\nfore, it consists basically of two steps. The first step is to obtain an implicit\n\n\n\nCH AP T ER 4 \u2013 T IM ES T EPPI NG AP P ROACH ES 47\n\npressure solution, exactly in the same manner as for the IMPEC strategy.\n\nThe second step consists of an implicit solution for the concentrations,\n\napplying Newton\u2019s method and taking the derivatives of the mobility terms.\n\nIn this way, from Eq. (3.23) with ? = n , a non-linear system for the con-\ncentration is obtained, using the known pressure determined previously.\n\nThis equation will be rewritten here, but substituting the phase flux into\n\nthe conservation equation:\n\n?\n\n??ref ?V\n\n?\n\nC? n\n?\n?C? n \u20131\n\n?\n\n?\n\n?t\n\n?\n\n?\n\np\n\n=\n\n?\n\nf ?Fp\n\nn p\n?\n\nl =1\n\nh\n\n(C?l )\nn\nf?\n(?l c)\n\nn\nf?\n[b]T\n\nf?\n\n?\n\n?\n\nP?l\n?n\n\ne\n?\n?\n\n\u02c6?l h\n?n\n\ne\n\n?\n\n+(D?l )\nn\nf?\n\ni\n\n+\n?\n\nR n\n?\n\n??\n\n?\n\np\n\n.\n\n(4.8)\n\nThe generated equation is non-linear, as the concentration is present\n\nimplicitly in the mobility terms of the equation. Therefore, the application\n\nof Newton\u2019s method is viable in order to solve the non-linear system [15].\nThe implicit treatment of these variables yields more stability to the SEQ\n\nmethod than to the IMPEC method, creating the possibility to use larger\n\ntimesteps during the simulation. This benefit is generally more advanta-\n\ngeous than the use of the IMPEC method, even though some iterations in\n\neach time step are necessary.\n\nAlthough it is applicable to any number of components and phases,\n\nin this work the SEQ method is implemented only for two-phase problems\n\nwith two components (water/oil) for the EbFVM formulation. These\nrestrictions are due to the difficulty in adapting a computational code that\n\nis written and prepared for the explicit evaluation of the concentrations\n\nto an implicit method. The sequential strategy needs a flash routine, that\n\nmust be called along Newton\u2019s iterations, where all terms dependent on\n\nthe concentration are evaluated. Such a routine was not implemented in\n\nthe code; thus, it was not worth, for the present work, re-implementing all\n\nof the routines that are influenced by the concentrations, grouping them\n\ninto the flash routine. For a case restricted to the components water and\n\noil, the flash routine is much simpler, and, therefore, it was suitable to test\n\nthe method with this simpler flow problem, deciding whether or not it is\n\ndesirable to extend it for any number of components in future work.\n\nConsidering these two components, only the conservation equation\n\n\n\n48 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nof one of them needs to be solved. The concentration of the other\n\ncomponent can be determined from the restriction equation. Besides,\n\nonly two phases are present in this case, with the aqueous phase (l = 1)\ncomposed only by component water (? = w) and the oleic phase (l = 2)\ncomposed only by component oil (?=o). That is,\n\nC w 1 = 1 Co1 = 0\nC w 2 = 0 Co2 = 1 .\n\n(4.9)\n\nChoosing to solve the conservation equation of component water, the\n\nfirst step is to write Eq. (4.8) in terms of a residual function,\n\n(G w)p =\n\n?\n\n??ref ?V\n\n?\n\nC? nw ?C?\nn \u20131\nw\n\n?\n\n?t\n\n?\n\n?\n\np\n\n?\n\n?\n\nf ?Fp\n\nh\n\n(?r 1c)\nn\nf?\n[b]T\n\nf?\n\n?\n\n?\n\nP?1\n?n\n\ne\n?\n?\n\n\u02c6?1h\n?n\n\ne\n\n?\n\n+(Dw 1)\nn\nf?\n\ni\n\n?\n?\n\nR nw\n?w\n\n?\n\np\n\n,\n\n(4.10)\n\nwhere (G w)p is the residue of the mass conservation equation for compo-\nnent water.\n\nThe objective of Newton\u2019s method is to reduce this residue, calculated\n\nin all control volumes, to a sufficiently small value. For this, expanding\n\nthe residue relative to iteration k +1 in Taylor series, with second-order\ntruncation error, results in\n\nG k+1w =G\nk\nw +\n\n?G w\n?C? w\n\n?\n\n?\n\n?\n\n?\n\nk\n\n?C? w . (4.11)\n\nBy imposing G k+1w = 0 and omitting the superscript k , the residue can\nbe written as\n\n?G w =\n?G w\n?C? w\n\n?C? w . (4.12)\n\nNow it is necessary to calculate the derivatives of the residual func-\n\ntion, that will be part of the Jacobian matrix. In this work, only numerical\n\nderivatives were applied to the Jacobian assembling, in the form\n\n?G w\n?C? w\n\n=\nG w\n\n?\n\nC? w +?C? w\n?\n\n?G w\n?\n\nC? w\n?\n\n?C? w\n, (4.13)\n\n\n\nCH AP T ER 4 \u2013 T IM ES T EPPI NG AP P ROACH ES 49\n\nadopting ?C? w = 10?4.\nWhen substituting Eq. (4.10) into (4.12) and applying it for all control\n\nvolumes, a linear system for iteration k is obtained, in the form\n\n[J]{?C? w}=?{G w} , (4.14)\n\nwhere [J] is the Jacobian matrix, containing all partial derivatives of the\nresidues applied in all control volumes, {?C? w} is the vector with the\ncorrections for the water concentration, and {G w} is the vector containing\nthe residues referent to the available concentration values. The linear\n\nsystem here is assembled in the same fashion as explained in the previous\n\nchapter for the pressure equation.\n\nAfter solving this linear system, it is possible to update the water and\n\noil concentration by\n\n(\n\nC? k+1w =C?\nk\nw +?C? w\n\nC? k+1o = 1?C?\nk+1\nw .\n\n(4.15)\n\nWith the new concentration fields, the mobilities are updated in the\n\nflash routine, and the iterative process is repeated, until G w = 0 or ?C? w = 0,\ngiven a certain tolerance. In this work, only the second option, based on\n\nthe maximum ?C? w encountered in the grid, is checked, with the tolerance\nequal to 10?3. After this, the next time step is achieved.\n\nThe procedure for one time step can be summarized in the following:\n\n1. Solve the pressure with the time-lagged mobilities.\n\n2. Calculate the total velocity in each face, applying Eq. (3.24) for all\n\nphases.\n\n3. Repeat the following until convergence:\n\n3.1. With the available values for the concentrations, calculate the\n\nmobility terms in the flash routine.\n\n3.2. Calculate the phase velocity in each face, through Eq. (4.3).\n\n3.3. Compute the residue of the water equation in all control\n\nvolumes, with Eq. (4.10).\n\n3.4. Compute the partial derivatives of the residual functions in all\n\ncontrol volumes, obtained numerically through Eq. (4.13). In\n\norder to evaluate the term G w(C? w +?C? w), the flash routine\n\n\n\n50 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nmust be called again, with the provided increment in the\n\nconcentration.\n\n3.5. Solve the linear system given in Eq. (4.14).\n\n3.6. Update the concentrations with the correction from the solu-\n\ntion of the linear system, using Eq. (4.15).\n\n4. Advance in time.\n\n5. Determine the new timestep, in the same way as for the pressure\n\ntimestep in the A-IMPEC method.\n\n6. Return to step 1 until final time has reached.\n\nAfter achieving convergence for the component concentrations, the\n\ntime can be advanced with the new timestep. There are several ways for\n\ndetermining the timestep in the SEQ approach. In this work, the same\n\nstrategy applied for the pressure timestep in the A-IMPEC method is used\n\nfor both the concentration and the pressure, so that ?t SEQC = ?t\nSEQ\nP =\n\n?t A-IMPECP . Although there is less restriction in the SEQ method, since it\nis more stable than the IMPEC method, some attention is necessary in the\n\ntimestep size in order to produce solutions with the desirable precision.\n\nThis is due to the approximation in the time derivative as well as to the\n\ndecoupling between pressure and concentration in this method.\n\n\n\nCHAPTER\n\n5\nR E S U LTS\n\nIn this chapter some application examples employing the formu-\n\nlation described in previously chapters are presented. The examples\n\nwere chosen to demonstrate several aspects of the formulation could be\n\nevaluated. They will be presented according to the following division:\n\n\u2022 Section 5.1: The EbFVM formulation is validated using a diffusion\nproblem with known analytical solution.\n\n\u2022 Section 5.2: A comparison between the EbFVM and the original\nformulation (FDM) is performed for single-phase, two-phase, and\n\nthree-phase flow problems.\n\n\u2022 Section 5.3: The computational time is analyzed for the different\ntimestepping approaches presented in Chapter 4.\n\n\u2022 Section 5.4: A case with a more complex 3D geometry is presented,\nwhere the potentiality of the method is clearly evidenced.\n\n5.1 EbFVM validation\n\nIn this section, the implementation of all element types is validated\n\nby comparing the numerical solution for a diffusion problem with its\n\nanalytical solution. The problem considered here corresponds to an\n\nexample proposed for comparing different discretization methods, as used\n\n51\n\n\n\n52 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nin Maliska et al. [41] and LATP [33]. It considers a homogeneous and\nisotropic medium, described by the following diffusion equation:\n\n?~?2?= R in ? , (5.1)\n\nwhere ? is a generic variable, which could be the aqueous phase pressure\nP1 in the case of UTCHEM, and R is the source term, that can be the well\n\ninjection/production. The domain ? is a cubic box defined by 0 ? x ? 1,\n0 ? y ? 1 and 0 ? z ? 1.\n\nIn this problem, the source term considered is dependent on the\n\nposition, given by\n\nR(x , y , z)= 12?2 sin(2?x)sin(2?y )sin(2?z) . (5.2)\n\nThis way, the analytical solution is given by\n\n?(x , y , z)= sin(2?x)sin(2?y )sin(2?z) . (5.3)\n\nIn order to make UTCHEM able to simulate such a problem, the\n\npressure equation, Eq. (2.8), can be reduced to Eq. (5.1) by using only one\n\ncomponent and setting the porosity, absolute permeability, and mobility\n\nto 1 and setting the total compressibility, capillary pressure, and gravity to\n\n0.\n\nSeveral meshes were considered for solving this problem, in order\n\nto test the formulation with different element types and different levels\n\nof refinement. All four type of elements considered in the formulation\n\nare tested here, with meshes that include only one type of element at a\n\ntime. Hybrid grids are not considered in this test due to the difficulty in\n\ngenerating them automatically. Grids containing tetrahedron, prisms, and\n\npyramids were generated based on the hexahedron element, that is, each\n\nhexahedron was divided into six tetrahedrons, two prisms or six pyramids\n\n[41], as illustrated in Fig. 5.1. Note that the grid containing pyramids\nrequires an additional node in the middle of the hexahedron, thus the\n\nnumber of nodes in this grid is higher than in the grids composed by\n\nhexahedrons, tetrahedrons, or prisms.\n\nBoth regular elements, in equally spaced grids, and distorted ele-\n\nments, providing non-equally spaced grids are considered. The latter\n\nwere obtained by moving the grid nodes randomly. The purpose of using\n\nthese grids is to determine to what extent the irregularities affect the\n\n\n\nCH AP T ER 5 \u2013 R ESULTS 53\n\nHexahedron\n\n2 Prisms 6 Tetrahedrons 6 Pyramids\n\nFigure 5.1 \u2013 Subdivision of the hexahedron in different elements.\n\nconvergence rate of the numerical solutions. In order to determine the\n\nconvergence order, progressive refinements were considered for each type\n\nof grid, with the coarsest grid size composed by 8\u00d78\u00d78 elements and the\nfinest grid by 100\u00d7100\u00d7100 elements. Note that even for grids composed\nby tetrahedrons, prisms, or pyramids, the grid size is based on the number\n\nof hexahedrons before the element division. Figure 5.2 illustrates the\n\nregular and distorted grids for the coarsest option.\n\nAfter obtaining the numerical solution in each grid, the average values\n\nof the solution error were calculated. As performed in [41], the L2-norm of\nthe numerical solution error is computed using the following expression:\n\n\"=\n\n?\n\n?\n\n?\n\n?\n\np\n\n?\n\n?(x p , yp , z p)???p\n?2\n?Vp\n\n?\n\np\n\n?\n\n?(x p , yp , z p)\n?2\n?Vp\n\n?\n\n?\n\n?\n\n, (5.4)\n\nwhere the summations run over all grid nodes, ?(x p , yp , z p) is the analytical\nsolution evaluated at the node coordinates, and ??p is the numerical\nsolution obtained for node p .\n\nIn the sequence, the convergence order is presented for the regular\n\nand distorted grids considered. The graphics represent the variation of\n\nthe error as the grids are refined, with the horizontal axis corresponding\n\n\n\n54 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\n(a) Regular tetrahe-\ndron\n\n(b) Regular hexahe-\ndron\n\n(c) Regular prism (d) Regular pyramid\n\n(e) Distorted tetrahe-\ndron\n\n(f ) Distorted hexa-\nhedron\n\n(g) Distorted prism (h) Distorted\npyramid\n\nFigure 5.2 \u2013 Regular and distorted grids used in the validation problem.\n\nto the average size d of the grid elements, that is the edge length of the\n\ncorresponding regular hexahedron.\n\nAs expected, the convergence rate for variable ? is of second order\nfor all element types. Tetrahedrons provided the smallest error, while\n\nhexahedrons provided the highest error, both in the regular and distorted\n\ncases. For this problem, the element distortion produced only a very slight\n\nincrease in the errors, except for the pyramid, in which case it decreased.\n\nThe trendlines are practically the same as well, and therefore, the distortion\n\nhas a minor effect on the error norm.\n\nThis test does not guarantee that the implementation of the EbFVM\n\nin UTCHEM is free of errors, as it did not account for anisotropic and het-\n\nerogeneous medium, as wells as the advective term. However, it provides\n\na very good indication that at least the geometrical variables, as shape\n\nfunctions, face areas, etc., are correctly implemented. In order to verify\n\nfeatures not included in this test, the next section compares the solutions\n\nfrom the EbFVM and the original FDM method, which was extensively\n\ntested and validated by several ways, as presented in UTCHEM-9.0 [55].\n\n\n\nCH AP T ER 5 \u2013 R ESULTS 55\n\n2.03e = 3.7 d\n\n2.10e = 19.2 d\n\n2.05e = 12.2 d\n\n2.07e = 9.8 d\n\nPrism\n\nTetrahedron\n\nHexahedron\n\nPyramid\n\n(e\n)\n\nEdge length (d)\n10\n\n-2\n10\n\n-1\n10\n\n-4\n\n10\n-3\n\n10\n-2\n\n10\n-1\n\n10\n0\n\n(a) Regular elements\n\n2.01e = 4.5 d\n\n2.09e = 19.9 d\n\n2.05e = 12.6 d\n\n2.04e = 9.1 d\n\nPrism\n\nTetrahedron\n\nHexahedron\n\nPyramid\n\nEdge length (d)\n10\n\n-2\n10\n\n-1\n10\n\n-4\n\n10\n-3\n\n10\n-2\n\n10\n-1\n\n10\n0\n\n(e\n)\n\n(b) Distorted elements\n\nFigure 5.3 \u2013 Error in the variable ? for regular and distorted grids.\n\n5.2 FDM vs. EbFVM\n\nAs stated before, in this section the solution obtained by employing\n\nthe new implementation (EbFVM) is compared to the solution obtained\n\nwith the original formulation present in the simulator, which employs the\n\ntraditional finite difference method (FDM). Three cases were chosen in\n\norder to make this comparison:\n\n\u2022 Case 1: Single-phase problem (only water).\n\n\u2022 Case 2: Two-phase problem (water and oil).\n\n\u2022 Case 3: Three-phase problem (water, oil, and microemulsion).\n\n\n\n56 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nFor the sake of simplicity, no chemical reactions, no adsorptions,\n\nand zero capillary pressure are assumed. These effects do not depend on\n\nthe method used to discretize the equations as they do not require any\n\ngeometric information. They were neglected for the purpose of model\n\nverification.\n\nIn all tests, a Cartesian grid composed of 45 \u00d7 45 \u00d7 5 gridblocks\napplying the FDM method was used as the reference solution. Three\n\ngrids were used in the EbFVM method: two of them composed only by\n\nhexahedrons and one hybrid grid, composed by all four types of elements.\n\nThe domains contain one injection and one production well, and they can\n\nbe visualized in Fig. 5.4.\n\n(a) Cartesian - 45\u00d745\u00d75 gridblocks (b) Hexahedron - 15\u00d715\u00d75 elements\n\n(c) Hexahedron - 45\u00d745\u00d75 elements (d) Hybrid - 6647 elements\n\nFigure 5.4 \u2013 Grids used in the comparison between FDM and EbFVM.\n\nIt is important to note that the wells in the FDM method are located\n\nin the center of the gridblocks, while in the EbFVM the wells are defined\n\nin the grid nodes. Therefore, in order to place the wells in the same\n\nphysical position in both methods, a refinement in the corners of the\n\ngrids used in the EbFVM is necessary, as seen in Fig. 5.4. Furthermore,\n\nalthough this method is capable of dealing with complex geometries and\n\nunstructured grids, these simple structured grids are being used here only\n\n\n\nCH AP T ER 5 \u2013 R ESULTS 57\n\nfor the purpose of comparison. Moreover, the method will treat them as\n\nunstructured grids even though they are structured.\n\nThe elements in the hybrid grid are disposed in the five layers as\n\nillustrated in Fig. 5.5. The top of the first layer is composed of prisms.\n\nThe second and fourth layers are composed of both tetrahedrons and\n\npyramids. The third layer is composed by hexahedrons and, finally, the\n\nfifth layer is composed only of tetrahedrons.\n\n(a) Tetrahedron - 2nd , 4th and 5th layers (b) Hexahedron - 3rd layer\n\n(c) Prism - 1st layer (d) Pyramid - 2nd and 4th layers\n\nFigure 5.5 \u2013 Different elements in the hybrid grid.\n\n5.2.1 Case 1 \u2013 Single-phase\n\nFor the single-phase problem, only component water is present. The\n\ninput data for this case is shown in Table 5.1. It is important to note in\n\nthis table that in both wells the condition is the prescribed bottom-hole\n\npressure (BHP). Therefore, the well flow rate is an unknown of the problem,\n\nand will be determined by applying Eq. (3.25), which relates the flow rate\n\nto the pressure gradient between the reservoir and the well through the use\n\nof a well index. The flow rate will be correct only if both the well index and\n\nthe reservoir pressure are well-calculated.\n\n\n\n58 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nTable 5.1 \u2013 Input data for Case 1.\n\nReservoir domain 1500 x 1500 x 100 ft\n\nInitial saturation 100% water \n\nInitial pressure 1000 psi\n\nR\no\n\nck\n\nPorosity 20%\n\nPermeability X 100 mD\n\nPermeability Y 100 mD\n\nPermeability Z 10 mD\n\nCompressibility 0 psi-1\n\nF\nlu\n\nid\n\nWater viscosity 1 cP\n\nWater specific weight 0.43 psi/ft\n\nWater compressibility 0 psi-1\n\nW\nel\n\nls\n\nInjected fluid 100% water\n\nInjection BHP 5000 psi \n\nProduction BHP 500 psi\n\nAn observation must be made regarding the units used in the tests\n\nperformed in this work. They are a mixture of common units used in\n\nreservoir applications, such as millidarcy and centipoise, and units from\n\nthe English system. The use of reservoir units is commonsense in problems\n\ninvolving fluid flow in porous media, and, if converted to the International\n\nSystem of Units, would provide confusing values for the user that is used\n\nto using these units. Regarding the other variables expressed in the English\n\nsystem, although the simulator can input values in the International Sys-\n\ntem, it will always convert them to the English system of units, exporting\n\nthe results in such a system. The conversion factors to International\n\nSystem are exposed in the beginning of this dissertation.\n\nAs this case test considers incompressible fluids and rock, it is a\n\nsteady-state problem, and, therefore, there is only one value for the well\n\nflow rate during the simulation for each grid considered, as shown in Table\n\n5.2. The largest difference in the results is less than 1%; thus, the solutions\n\nare in good agreement and it is possible to say that the well model,\n\nresponsible for calculating the well index, is applicable to this type of grid.\n\n\n\nCH AP T ER 5 \u2013 R ESULTS 59\n\nAs stated in Chapter 3, the application of the modified Peaceman\u2019s model is\n\npossible only because the reservoir contains regular horizontal layers and\n\nthe wells are perpendicular to these layers, in the vertical direction.\n\nTable 5.2 \u2013 Well flow rates.\n\nGrid Flow rate [ft3/d] Difference\n\nCartesian - 45x45x5 57725 -\n\nHexahedron - 15x15x5 58194 0.81%\n\nHexahedron - 45x45x5 57938 0.37%\n\nHybrid - 6647 elements 57773 0.08%\n\nDifference is less than 1%For illustrative purpose, Fig. 5.6 shows the pressure field obtained for\n\nthis case, which is very similar for all grids considered.\n\nFigure 5.6 \u2013 Pressure field for Case 1.\n\n5.2.2 Case 2 \u2013 Water-oil flooding\n\nNow, a two-phase system is considered, with the aqueous phase com-\n\nposed only by component water and the oleic phase only by component\n\noil. Therefore, the phases, as well as the components, will be designated as\n\nwater and oil. Table 5.3 illustrates the input data for this case.\n\n\n\n60 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nTable 5.3 \u2013 Input data for Case 2.\n\nReservoir domain 1500 x 1500 x 100 ft\n\nInitial saturation 10% water - 90%oil\n\nInitial pressure 1000 psi\n\nR\no\n\nck\n\nPorosity 20%\n\nPermeability X Variable per layer\n\nPermeability Y Variable per layer\n\nPermeability Z 10 mD\n\nCompressibility 5x10-6 psi-1\n\nReference pressure 14.7 psi\n\nF\nlu\n\nid\n\nWater viscosity 1 cP\n\nWater specific weight 0.43 psi/ft\n\nWater compressibility 0 psi-1\n\nOil viscosity 10 cP\n\nOil specific weight 0.29 psi/ft\n\nOil compressibility 0 psi-1\n\nW\nel\n\nls\n\nInjected fluid 100% water\n\nInjection flow rate 40000 ft3/d\n\nProduction BHP 500 psi\n\nHere, the rock is compressible and the injection well condition is\n\nthe prescribed total flow rate. Also, the absolute permeabilities in the\n\nhorizontal directions are equal but variable per layer, as depicted in Fig.\n\n5.7. Another important variable that is not present in Table 5.3 is the phase\n\nrelative permeability. For this case, a very simple condition is used, as\n\nshown in Fig. 5.8.\n\nThe simulation time for this flow problem was 1500 days, which\n\nprovided 1.33 pore volumes injected (PVI)1. The timestepping approach\n\nused was the traditional IMPEC method, with a constant timestep, equal\n\n1 PVI is a dimensionless time commonly used in reservoir simulation, which relates the\ninjection flow rate, the time and the reservoir total porous volume.\n\n\n\nCH AP T ER 5 \u2013 R ESULTS 61\n\nFigure 5.7 \u2013 Permeability field for Case 2.\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n1\n\nR\nel\n\nat\niv\n\ne \np\n\ner\nm\n\nea\nb\n\nil\nit\n\ny\n\n0\n\n0.1\n\n0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1\n\nWater saturation\n\nFigure 5.8 \u2013 Water and oil relative permeabilities for Case 2.\n\nto 0.05 day for all grids. The maximum Courant number obtained with this\n\n?t was 0.34 in the finer grid, which provides stable solutions for water-oil\nflow problems.\n\n\n\n62 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nFigure 5.9 illustrates the cumulative oil recovery2, the oil cut3 and the\n\ntotal production rate for this case, where it is possible to note that the\n\nsolutions are in good agreement with the reference FDM solution.\n\n5.2.3 Case 3 \u2013 Chemical flooding\n\nFor this case two other components are present in the fluid flow:\n\nsurfactant and polymer. Consequently, another phase will be present\n\nalong the simulation, called microemulsion, which is a thermodynamically\n\nstable mixture of water, surfactant, and one or more organic components\n\n[55]. The basic input data is the same as used in Case 2, including\nthe data related to timestepping. The only difference is in the injected\n\ncomponents, where the aqueous phase injected contains 97% of water, 3%\n\nof surfactant, and 2000 ppm of polymer. Other parameters related to these\n\ntwo new components and to the phase behavior were based on an example\n\navailable in UTCHEM-9.0 [55], and will not be discussed here.\nThe production well curves are illustrated in Fig. 5.10, where again\n\na good agreement between the solutions is obtained. Comparing the\n\nwater-oil and chemical flooding results, it is clear that when surfactant\n\nand polymer are injected, the oil recovery is remarkably enhanced, with\n\na much sharper fluid front. Enhanced oil recovery processes, such as the\n\none considered here, have utilized surfactants as they create low interfacial\n\ntension in order to reduce capillary forces and thus mobilize trapped oil,\n\nwhereas polymers are used to reduce fluid mobility improving the sweep\n\nefficiency of the reservoir (i.e., increasing the volume of the permeable\n\nmedium contacted at any given time) [32, 51].\nhave utilized surfactants as they create low interfacial tension in order\n\nto reduce capillary forces and thus mobilize trapped oil, whereas polymers\n\nare used to reduce fluid mobility improving the sweep efficiency of the\n\nreservoir (i.e., increasing the volume of the permeable medium contacted\n\nat any given time) [32, 51].\n\n2 Cumulative oil recovery is the cumulative volume fraction of oil produced along the\nsimulation.\n\n3 Oil cut is defined as the oil production divided by the total production.\n\n\n\nCH AP T ER 5 \u2013 R ESULTS 63\n\nPVI\n\nC\nu\n\nm\nu\n\nla\nti\nve\n\no\nil\n\nre\nco\n\nve\nry\n\n0 0.25 0.5 0.75 1 1.25 1.5\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\nCartesian - 45x45x5\n\nHexahedron - 15x15x5\n\nHexahedron - 45x45x5\n\nHybrid - 6647 elements\n\n(a) Cumulative oil recovery\n\nPVI\n\nO\nil\n\ncu\nt\n\n0 0.25 0.5 0.75 1 1.25 1.5\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nCartesian - 45x45x5\n\nHexahedron - 15x15x5\n\nHexahedron - 45x45x5\n\nHybrid - 6647 elements\n\n(b) Oil cut\n\nPVI\n\nP\nro\n\nd\nu\n\nct\nio\n\nn\nra\n\nte\n[f\n\nt\u00b3\n/d\n\n]\n\n0 0.25 0.5 0.75 1 1.25 1.5\n0\n\n10000\n\n20000\n\n30000\n\n40000\n\n50000\n\nCartesian - 45x45x5\n\nHexahedron - 15x15x5\n\nHexahedron - 45x45x5\n\nHybrid - 6647 elements\n\n(c) Total production rate\n\nFigure 5.9 \u2013 Production well curves for Case 2.\n\n\n\n64 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nPVI\n\nC\nu\n\nm\nu\n\nla\nti\nve\n\no\nil\n\nre\nco\n\nve\nry\n\n0 0.25 0.5 0.75 1 1.25 1.5\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nCartesian - 45x45x5\n\nHexahedron - 15x15x5\n\nHexahedron - 45x45x5\n\nHybrid - 6647 elements\n\n(a) Cumulative oil recovery\n\nPVI\n\nO\nil\n\ncu\nt\n\n0 0.25 0.5 0.75 1 1.25 1.5\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nCartesian - 45x45x5\n\nHexahedron - 15x15x5\n\nHexahedron - 45x45x5\n\nHybrid - 6647 elements\n\n(b) Oil cut\n\nPVI\n\nP\nro\n\nd\nu\n\nct\nio\n\nn\nra\n\nte\n[f\n\nt\u00b3\n/d\n\n]\n\n0 0.25 0.5 0.75 1 1.25 1.5\n0\n\n10000\n\n20000\n\n30000\n\n40000\n\nCartesian - 45x45x5\n\nHexahedron - 15x15x5\n\nHexahedron - 45x45x5\n\nHybrid - 6647 elements\n\n(c) Total production rate\n\nFigure 5.10 \u2013 Production well curves for Case 3.\n\n\n\nCH AP T ER 5 \u2013 R ESULTS 65\n\n5.3 Timestepping approaches comparison\n\nIn this section, the timestepping approaches described in Chapter 4\n\nare applied, presenting the computational time for each approach in two\n\ntest cases: a two-phase and a three-phase problem, which are very similar\n\nto the test cases applied in Section 5.2. The main differences are that here\n\nthe rock is incompressible and that the absolute horizontal permeabilities\n\nare constant and equal to 100 mD, instead of variable per layer. In addition,\n\nthe grids used now are equally spaced, instead of finer in the corners, and\n\nthe vertical wells are located in the corners of the domain, as in the five-\n\nspot well pattern. The reservoir domain, however, is the same.\n\nIn the first case the IMPEC, A-IMPEC and SEQ approaches are applied\n\nonly for the EbFVM. For the chemical flooding case, the SEQ method is not\n\nused, as it is implemented only for water-oil flow problems. In this case, the\n\nIMPEC and A-IMPEC are applied for both FDM and EbFVM formulations.\n\n5.3.1 Case 1 \u2013 Water-oil flooding\n\nIn order to compare the CPU time for different grid refinements, the\n\nfollowing grid sizes are used in this case: 5 \u00d7 5 \u00d7 5, 15 \u00d7 15 \u00d7 5, 45 \u00d7 45 \u00d7 5,\nand 75 \u00d7 75 \u00d7 5.\n\nThe traditional IMPEC formulation uses the same timestep for both\n\nthe concentration and pressure equations. In all grids the minimum and\n\nmaximum Courant number accepted are 0.1 and 0.6, respectively, which\n\nprovided in the finer grid, for example, a minimum timestep equal to\n\n0.004 and a maximum equal to 0.019. The A-IMPEC method uses different\n\ntimesteps for each equation, with the same ?t from the IMPEC method for\nthe concentration and a larger timestep for the pressure equation. On the\n\nother hand, the SEQ method uses the same but a higher timestep for both\n\nequations.\n\nThe variation of the pressure timestep for the A-IMPEC and for the\n\ntimestep in the SEQ method along the simulation for the the finer grid are\n\nillustrated in Fig. 5.11. The curves for the other grid sizes are very similar,\n\nkeeping the same behavior and changing only slightly in the timestep\n\nmagnitudes.\n\nThe oscillation between 0.05 and 0.25 PVI in the pressure timestep\n\npresent in the A-IMPEC is due to the front of water that is reaching the\n\nproduction well. When this happens, the total velocity changes more\n\n\n\n66 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nPVI\n\nT\nim\n\ne\nst\n\ne\np\n\n0 0.2 0.4 0.6 0.8 1 1.2\n\n10-3\n\n10-2\n\n10-1\n\n100\n\n101\n\n102\n\nA-IMPEC (Pres. only)\n\nSEQ (Pres. and conc.)\n\nFigure 5.11 \u2013 Timestep along the simulation for the grid 75\u00d775\u00d75 in Case\n1.\n\nrapidly, and the method tries to increase the timestep but the total velocity\n\nvariation bars this increase in the next step by reducing it again. After a\n\nlarger volume of water has been produced, the total velocity field stabilizes\n\nand the pressure timestep can be increased without restrictions.\n\nWhile the concentration equation advances with a maximum of 0.019\n\nday, the pressure equation is solved in each 35-day period in the end of\n\nthe simulation. For the SEQ method, a smaller timestep is applied in the\n\npressure equation, but for the concentration it is much larger than the one\n\napplied in the A-IMPEC, reaching 2.6 days in the final time.\n\nIn order to verify that the solutions obtained with these different\n\napproaches are correct, the oil cut curve for the finer grid is compared to\n\nthe one obtained with the traditional IMPEC. This comparison is shown\n\nin Fig. 5.12, where a good agreement between the solutions is present.\n\nTherefore, the timesteps used in both the A-IMPEC and SEQ methods are\n\nadequate in this test case.\n\nIn the sequence, the CPU time spent for solving the pressure equation\n\nand the concentration equation as well as for the total simulation is\n\npresented. The comparison is made for different grid sizes using the three\n\ntimestepping approaches described, as shown in Fig. 5.13.\n\nAnalyzing first the pressure equation, where the linear system is\n\nassembled and then solved, it is possible to identify that both curves for the\n\nIMPEC and A-IMPEC have almost the same inclination, but with a smaller\n\nmagnitude for the adaptive option, being more than three times faster. The\n\n\n\nCH AP T ER 5 \u2013 R ESULTS 67\n\nPVI\n\nO\nil\n\ncu\nt\n\n0 0.2 0.4 0.6 0.8 1 1.2\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nIMPEC\n\nA-IMPEC\n\nSEQ\n\nFigure 5.12 \u2013 Oil cut for the grid 75\u00d775\u00d75 in Case 1.\n\nsequential method spends more time for coarser grids but it provides much\n\nbetter computational times when the grid becomes finer.\n\nFor the concentration equation, the IMPEC and A-IMPEC provide the\n\nsame CPU time, as these methods use the same concentration timestep\n\nfor solving it. Although the SEQ method uses larger timesteps for the\n\nconcentration equation, it needs some iterations in each step, due to the\n\nnon-linearities. For the grids analyzed, this resulted in additional costs,\n\nbut for even finer grids this method would be faster than the other two\n\nmethods, as its curve inclination is smaller.\n\nFinally, the total simulation time is the sum of the time spent in the\n\npressure and concentration equations as well as the time consumed in\n\nauxiliary routines. For both the IMPEC and A-IMPEC methods, the most\n\nconsuming process is solving the pressure equation, especially for the\n\nformer; thus, the total time curve has a similar behavior to the pressure\n\nequation curve. On the other hand, for the SEQ method, the time spent\n\nin the pressure and concentration equations is of a similar order and\n\nmagnitude, and the total time curve inclination is in between these two\n\ncurves, presenting meaningful reductions in the computational time for\n\nrefined grids. Therefore, it is a good indication for real reservoir problems\n\nwith more than two components, being a good topic of study for future\n\nwork.\n\n\n\n68 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\n1.57\nt a N\nSEQ - EbFVM\n\nt a N\n2.22\n\nA-IMPEC - EbFVM\n\n2.32\nt a N\nIMPEC - EbFVM\n\nNumber of unknowns (N)\n10\n\n2\n10\n\n3\n10\n\n4\n10\n\n5\n10\n\n-2\n\n10\n0\n\n10\n2\n\n10\n4\n\n10\n6\n\n(a) Pressure equation\n\n1.40\nt a N\nSEQ - EbFVM\n\nt a N\n2.17\n\nA-IMPEC - EbFVM\n\n2.17\nt a N\nIMPEC - EbFVM\n\nNumber of unknowns (N)\n10\n\n2\n10\n\n3\n10\n\n4\n10\n\n5\n10\n\n-2\n\n10\n0\n\n10\n2\n\n10\n4\n\n10\n6\n\n(b) Concentration equation\n\n1.45\nt a N\nSEQ - EbFVM\n\nt a N\n2.17\n\nA-IMPEC - EbFVM\n\n2.30\nt a N\nIMPEC - EbFVM\n\nNumber of unknowns (N)\n10\n\n2\n10\n\n3\n10\n\n4\n10\n\n5\n10\n\n-2\n\n10\n0\n\n10\n2\n\n10\n4\n\n10\n6\n\n(c) Total time\n\nFigure 5.13 \u2013 CPU time for different routines in Case 1.\n\n\n\nCH AP T ER 5 \u2013 R ESULTS 69\n\n5.3.2 Case 2 \u2013 Chemical flooding\n\nThis case has the same input data of Case 1; however, 3% of surfactant\n\nand 2000 ppm of polymer are injected. The finest grid used in the first case\n\nis not applied here, as the presence of chemical components requires more\n\ncomputational effort, and it would take too long to be solved. In addition,\n\nthe maximum Courant number accepted was set to 0.1 instead of 0.6, as\n\nthe problem became more unstable when surfactant and polymer were\n\ninjected. Therefore, the finest grid now is 45\u00d745\u00d75 elements.\nIn this case, the SEQ method was not used as it was not implemented\n\nfor chemical flooding processes; thus, only the traditional method and its\n\nadaptive option will be compared. The variation of the pressure timestep\n\nfor the A-IMPEC along the simulation using the EbFVM method for the\n\n45 \u00d7 45 \u00d7 5 grid is illustrated in Fig. 5.14. As the front of fluid is sharper\nwhen chemical components are injected, the water reaches the production\n\nwell later than in the water-oil flow problem. Thus, the total velocity stays\n\nstable for a longer period, providing larger timesteps during that period.\n\nThis will result in less time spent in the pressure equation compared to the\n\ntime spent in Case 1, as seen in the sequence.\n\nPVI\n\nT\nim\n\ne\nst\n\ne\np\n\n0 0.2 0.4 0.6 0.8 1 1.2\n\n10-3\n\n10-2\n\n10-1\n\n100\n\n101\n\n102\n\nA-IMPEC - EbFVM (Pres. only)\n\nFigure 5.14 \u2013 Timestep along the simulation for the grid 45\u00d745\u00d75 in Case\n2.\n\nSimilar to Case 1, the oil cut in the production well is presented in\n\nthe sequence in order to verify whether or not the timesteps used are\n\nadequate for this problem. Figure 5.15 compares the solutions for the FDM\n\n\n\n70 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nand EbFVM using both timestepping approaches, considering the original\n\nformulations as the reference solution.\n\nPVI\n\nO\nil\n\ncu\nt\n\n0 0.2 0.4 0.6 0.8 1 1.2\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nIMPEC - FDM\n\nIMPEC - EbFVM\n\nA-IMPEC - FDM\n\nA-IMPEC - EbFVM\n\nFigure 5.15 \u2013 Oil cut for the grid 45\u00d745\u00d75 in Case 2.\n\nAfter verifying that the solutions are in good agreement, the compu-\n\ntational time is compared in Fig. 5.16, in the same way as in the previous\n\ncase.\n\nFor the pressure equation, comparing the CPU time for cases 1 and\n\n2, the use of the traditional IMPEC method required more CPU time in the\n\nfirst case, due to the additional microemulsion phase. On the other hand,\n\nwhen using the adaptive option, although an additional phase is present,\n\nthe second case was simulated even faster, due to the pressure timesteps\n\nused here, illustrated previously in Fig. 5.14. Therefore, contrary to Case 1,\n\nthe inclination of the curves for the adaptive option is much smaller than\n\nthose for the traditional method.\n\nFurthermore, in this case the concentration equation is the most\n\nrestrictive process when the A-IMPEC algorithm is employed. Therefore,\n\nas it does not provide any reduction in the time consumed for solving\n\nthe concentrations, the time-saving during the whole simulation is not as\n\nsignificant as the time-saving in the pressure equation.\n\nIt is also possible to note that the EbFVM spends more time than\n\nthe FDM formulation, as it is a scheme that uses more points than the\n\nlatter. In the concentration equation, this difference is not as large as in\n\nthe pressure equation. This is mostly due to the assembling of the pressure\n\nlinear system, which demands extra time in the EbFVM formulation. This\n\n\n\nCH AP T ER 5 \u2013 R ESULTS 71\n\nprocess is not optimized in the current implementation, and it needs to be\n\naddressed in future work.\n\nFrom Fig. 5.16 it is clear that the A-IMPEC algorithm is a good\n\noption for saving computational time when incompressible problems are\n\nsimulated.\n\n\n\n72 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\n1.58\nt a N\nA-IMPEC - FDM\n\nt a N\n1.35\n\nA-IMPEC - EbFVM\n\nIMPEC - FDM\n2.43\n\nt a N\n\n2.26\nt a N\nIMPEC - EbFVM\n\nNumber of unknowns (N)\n10\n\n2\n10\n\n3\n10\n\n4\n10\n\n5\n10\n\n-2\n\n10\n0\n\n10\n2\n\n10\n4\n\n10\n6\n\n(a) Pressure equation\n\n2.10\nt a N\nA-IMPEC - FDM\n\nt a N\n2.16\n\nA-IMPEC - EbFVM\n\nIMPEC - FDM\n2.10\n\nt a N\n\n2.16\nt a N\nIMPEC - EbFVM\n\nNumber of unknowns (N)\n10\n\n2\n10\n\n3\n10\n\n4\n10\n\n5\n10\n\n-2\n\n10\n0\n\n10\n2\n\n10\n4\n\n10\n6\n\n(b) Concentration equation\n\nNumber of unknowns (N)\n10\n\n2\n10\n\n3\n10\n\n4\n10\n\n5\n10\n\n-2\n\n10\n0\n\n10\n2\n\n10\n4\n\n10\n6\n\n2.00\nt a N\nA-IMPEC - FDM\n\nt a N\n2.09\n\nA-IMPEC - EbFVM\n\nIMPEC - FDM\n2.09\n\nt a N\n\n2.21\nt a N\nIMPEC - EbFVM\n\n(c) Total time\n\nFigure 5.16 \u2013 CPU time for different routines in Case 2.\n\n\n\nCH AP T ER 5 \u2013 R ESULTS 73\n\n5.4 EbFVM potential\n\nHere, a simulation case with a more complex geometry is carried out.\n\nReservoirs with complex geometry can be modeled with great flexibility\n\nwith the proposed numerical technique. The hybrid unstructured grid\n\nused for discretizing this reservoir is shown in Fig. 5.17. In UTCHEM,\n\nthis mesh cannot be represented using the original method. However,\n\nthis geometry can be easily handled with the element-based formulation\n\nimplemented in this work.\n\nLocal grid refinement in regions around the wells is considered for a\n\nmore accurate solution in those locations. As stated before, this is one of\n\nthe main advantages of using unstructured grids, because small elements\n\ncan be concentrated only in localized areas of interest, without increasing\n\nexcessively the size of the complete discrete problem. Moreover, with un-\n\nstructured grids, the transition between refined and coarse regions can be\n\nperformed smoothly, in order to avoid introducing further discretization\n\nerrors associated with element sizes varying abruptly [28].\nTwo geological faults are present in the reservoir, and they are mod-\n\neled as internal nearly impervious boundaries. The grid was enforced to\n\nconform to the domain boundary, as well as to the internal faults.\n\nFigure 5.17 \u2013 Grid.\n\n\n\n74 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nIn this example, a cylindrical region is employed around the wells,\n\ndiscretized with prisms and hexahedrons. In Flandrin et al. [21], this\ntype of grid is suggested in order to capture the essentially radial flow\n\npattern around the wells with more fidelity. The wells are represented by\n\nthe lines in the middle of these regions, passing through the grid nodes.\n\nThe transition between hexahedrons and tetrahedrons is performed using\n\npyramids. Figure 5.18 shows where each element type is used in this grid\n\ndiscretization. Note that the faults are filled with hexahedrons.\n\n(a) Tetrahedron (b) Prism and hexahedron\n\n(c) Pyramid\n\nFigure 5.18 \u2013 Element types in the grid.\n\n\n\nCH AP T ER 5 \u2013 R ESULTS 75\n\nFigure 5.19 shows with more detail the region around the production\n\nwell, where it is possible to further evidence the cylindrical region around\n\nit.\n\nFigure 5.19 \u2013 Near-well region.\n\nIn order to visualize the flow behavior using the provided discretiza-\n\ntion, a water-oil flow problem is considered. The input data will not be\n\nshown, as the objective here is only to show qualitatively the fluid flow\n\npattern. Figure 5.20 shows the saturation field after injecting 1.08 pore\n\nvolumes of water.\n\nFigure 5.20 \u2013 Saturation field in the final time (1.08 PVI).\n\n\n\n76 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nFinally, Fig. 5.21 shows the saturation isosurfaces consisting of 50%\n\neach of water and oil at four different injection times. One can note that the\n\nsimulation provides results that are qualitatively reproducing the expected\n\nphysical behavior: the front of fluid is nearly radial around the injection\n\nwell, and the displaced fluid is restrained by the faults, which have much\n\nlower absolute permeability values.\n\n(a) 0.27 PVI (b) 0.54 PVI\n\n(c) 0.81 PVI (d) 1.08 PVI\n\nFigure 5.21 \u2013 Isosurfaces of saturation 0.5.\n\n\n\nCHAPTER\n\n6\nCO N C LU S I O N S\n\n6.1 Summary\n\nThis dissertation presented an application of the Element-based Fi-\n\nnite Volume Method in a chemical flooding compositional simulator devel-\n\noped at The University of Texas at Austin. In this method, the discretization\n\nof the domain is realized in an unstructured manner using elements with\n\ndifferent shapes, making it possible to represent complex geometries with\n\nhigh fidelity.\n\nSince the main differences between the EbFVM and the FDM are\n\nrelated to geometrical matters, a solid base for the representation of\n\ngeometrical entities considered in the formulation was established first.\n\nThe discretization process for the PDEs was then realized following the phi-\n\nlosophy of the conventional finite volume method, that is, the construction\n\nof discrete equations that satisfy the conservation of physical quantities\n\nat the control volumes. In order to take advantage of the element-based\n\nmethod, the integrated equations were written in a way they could be\n\nevaluated element by element, just by knowing the grid connectivity list.\n\nThis way, the final equation for the control volumes can be assembled with\n\ncontributions from the elements that are present in the control volume\n\nconstruction.\n\nOriginally in the simulator, the discretized equations were adapted to\n\nthe use of a decoupled solution algorithm, where separate systems of equa-\n\n77\n\n\n\n78 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\ntions are solved for the two primary variables, the aqueous phase pressure\n\nand the component concentrations. For this, the only scheme present\n\nin the simulator was the IMPEC algorithm, using the same timestep for\n\nboth equations. In this method, the pressure is obtained implicitly, with\n\nexplicit evaluation for the concentrations after solving for the pressure.\n\nThis method is known as the fastest one on a pertimestep basis, however\n\nthe stability criterion for the explicit evaluations always requires a limited\n\ntimestep size. As this stability restrictions make the IMPEC at times inef-\n\nficient or even impossible to solve some simulation problems, two other\n\ndecoupled schemes were studied and implemented in UTCHEM. Only\n\ndecoupled algorithms were implemented because the implementation of\n\na fully implicit method, where the pressure and concentration are solved in\n\na coupled way, would modify the whole code structure, not being worthy\n\nfor the present work.\n\nThe first one is a variant of the IMPEC method, designated as A-\n\nIMPEC, where an acceleration strategy is proposed by taking larger time-\n\nsteps for the pressure than for the concentrations, in order to solve the\n\npressure linear system less times along the simulation. The method can be\n\napplied to any number of components, but only for incompressible prob-\n\nlems. The other method considered is known as Sequential method, or\n\nSemi-Implicit method, where the concentration is also obtained implicitly,\n\nbut in a separate linear system, after solving for the pressure implicitly in\n\nthe same way as in the IMPEC. This method uses the same timestep for\n\nboth equations, but allows for larger timesteps than the IMPEC, as the\n\nstability restriction was due only to the explicit evaluation of concentra-\n\ntions. This method does not seem to have any restriction; however, for the\n\npurpose of this work it was implemented only for water-oil flow problems.\n\n6.2 Conclusions\n\nThe element-based conservative approach has shown to be efficient\n\nin all aspects of the objectives for the present work, evidencing its abil-\n\nity for solving petroleum reservoir problems in different configurations\n\nproposed in the examples. Although more computationally costly, the\n\nEbFVM presents several advantages in relation to traditional finite volume\n\nmethods. The main advantage is the possibility of a loyal representation\n\nof complex geometries with intrinsic details, as present in real reser-\n\n\n\nCH AP T ER 6 \u2013 CO NCLU SIO NS 79\n\nvoirs, through the use of unstructured grids with local grid refinements.\n\nFurthermore, contrary to the original scheme present in the UTCHEM\n\nsimulator, the method studied in this work applies multi-points in the flux\n\ncalculation, which provides correct calculations in cases where the grid is\n\nnon-orthogonal.\n\nRegarding the timestepping approaches for accelerating the simula-\n\ntion, they demonstrated good performance. The necessity of a numeri-\n\ncal formulation able to provide simulations in reasonable computational\n\ntimes motivated the consideration of such schemes. The A-IMPEC algo-\n\nrithm presents meaningful reductions in the time consumed for solving\n\nthe pressure equation along the simulation. However, it does not pro-\n\nvide any reduction in the time consumed for solving the concentrations.\n\nConsequently, in some cases, such as in chemical flooding, the time spent\n\nduring the whole simulation is restricted by the concentration equation,\n\nwhich is larger than the time consumed by the pressure equation. When\n\nthis happens, the total time-saving is not as significant as the time-saving\n\nin the pressure equation. The SEQ method, on the other hand, presented\n\nsignificant reductions for refined grids, being the most indicated, between\n\nthe methods studied, for real reservoir problems.\n\nThe results obtained for both the application of EbFVM and the dif-\n\nferent timestepping approaches clearly show the capacity of such schemes\n\nin producing consistent solutions with several advantages compared to\n\ntraditional schemes, which must motivate their use in other reservoir\n\nsimulator applications. In the case of UTCHEM, the incorporation of these\n\nnumerical schemes are an important addition to the simulator, which\n\nin terms of mathematical models already accounts for several petroleum\n\nengineering options.\n\n6.3 Suggestions for future work\n\nThe following is a list of possible topics of study for future work in this\n\narea, or even in the UTCHEM simulator.\n\n\u2022 Introduction of a full permeability tensor.\n\n\u2022 Use of higher-order upwind interpolation schemes for the mobilities.\n\n\u2022 Optimization of the implementation of the linear system assem-\nbling.\n\n\n\n80 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\n\u2022 A more rigorous analysis for the possibility of application of the A-\nIMPEC scheme in compressible problems.\n\n\u2022 Extension of the SEQ method for problems with more than two\ncomponents.\n\n\u2022 Tests with other parameters for determination of the timestep in\nboth the A-IMPEC and SEQ algorithms.\n\n\n\nR E F E R E N C E S\n\n[1] AAVATSM A R K, I.; KL AUS EN, R. A. Well index in reservoir simulation for\nslanted and slightly curved wells in 3D grids. SPE Journal, v. 8, n. 1,\npp. 41\u201348, 1969.\n\n[2] ABO U-KA SSEM, J. H.; FA RO UQ ALI, S. M.; ISL A M, M. R. Petroleum\nreservoir simulation: a basic approach. Gulf Publishing Company,\nHouston, 2006.\n\n[3] AZIZ, K.; SET TA R I, A. Petroleum reservoir simulation. Applied Science\nPublishers, London, 1979.\n\n[4] BA BU, D. K.; ODEH, A. S. Productivity of a horizontal well. SPE Reservoir\nEngineering , v. 4, n. 4, pp. 417\u2013421, 1989.\n\n[5] BA LIGA, B. R.; PATA NK A R, S. V. A control volume finite-element method\nfor two-dimensional fluid flow and heat transfer. Numerical Heat\nTransfer, v. 6, pp. 245\u2013261, 1983.\n\n[6] BEA R, J. Hydraulics of groundwater. McGraw-Hill, New York, 1979.\n\n[7] BH UYA N, D. Development of an alkaline/surfactant/polymer flood\ncompositional reservoir simulator. Ph.D. Dissertation, The University\nof Texas at Austin, 1989.\n\n[8] BL A IR, P. M.; WEIN AUG, C. F. Solution of two-phase flow problems using\nimplicit difference equations. SPE Journal, v. 9, n. 4, pp. 417\u2013424, 1969.\n\n[9] CAO, H.; AZIZ, K. Performance of IMPSAT and IMPSAT-AIM models\nin compositional simulation. SPE paper 77720 \u2013 SPE Annual Technical\nConference and Exhibition, San Antonio, TX, 29 September \u2013 2 October,\n\n2002.\n\n[10] CH EN, Z.; HUAN, G.; LI, B. An improved IMPES method for two-phase\nflow in porous media. Transport in Porous Media, v. 54, pp. 361\u2013376,\n2004.\n\n81\n\n\n\n82 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\n[11] COATS, K. H. Computer Simulation of Three-Phase Flow in Reser-\nvoirs. The University of Texas at Austin, 1968.\n\n[12] COATS, K. H. Simulation of Steamflooding With Distillation and\nSolution Gas. SPE Journal, v. 16, n. 5, pp. 235\u2013247, 1976.\n\n[13] COATS, K. H. A note on IMPES and some IMPES based simulation\nmodels. SPE Journal, v. 5, n. 3, pp. 245\u2013251, 2000.\n\n[14] COATS, K. H. IMPES stability: selection of stable timesteps. SPE\nJournal, v. 8, n. 2, pp. 181\u2013187, 2003.\n\n[15] CO R DAZ ZO, J. Simula\u00e7\u00e3o de reservat\u00f3rios de petr\u00f3leo utilizando o\nm\u00e9todo EbFVM e multigrid alg\u00e9brico. Doctoral Thesis (in Portuguese),\nFederal University of Santa Catarina, 2006.\n\n[16] CO R DAZ ZO, J.; MA LISK A, C. R.; SILVA, A. F. C.; HURTA DO, F. S. V. The\nnegative transmissibility issue when using CVFEM in petroleum reser-\nvoir simulation \u2013 1. Theory. Proceedings of the 10th Brazilian Congress\nof Thermal Sciences and Engineering \u2013 ENCIT 2004, Rio de Janeiro, 30\n\nNovember \u2013 3 December, 2004.\n\n[17] CO R DA ZZO, J.; MA LISK A, C. R.; SILVA, A. F. C.; HURTA DO, F. S. V. The\nnegative transmissibility issue when using CVFEM in petroleum reser-\nvoir simulation \u2013 2. Results. Proceedings of the 10th Brazilian Congress\nof Thermal Sciences and Engineering \u2013 ENCIT 2004, Rio de Janeiro, 30\n\nNovember \u2013 3 December, 2004.\n\n[18] DELSH A D, M.; PO PE, G. A.; SEPEH R NO OR I, K. A compositional simulator\nfor modeling surfactant enhanced aquifer remediation. Journal of\nContaminant Hydrology, n. 23, pp. 303\u2013327, 1996.\n\n[19] DIN G, Y. A generalized 3D well model for reservoir simulation. SPE\nJournal, v. 1, n. 4, pp. 437\u2013450, 1996.\n\n[20] DO UGL A SS, R. W.; CA R EY, G. F.; WH IT E, D. R.; HA NSEN, G. A.; KA LLIN DER IS,\nY. Current views on grid generation: summaries of a panel discussion.\nNumerical Heat Transfer, Part B, v. 41, pp. 211\u2013237, 2002.\n\n[21] FL A NDR IN, N.; BO RO UCH A K I, H.; BENN IS, C. 3D hybrid mesh gen-\neration for reservoir simulation. International Journal for Numerical\nMethods in Engineering , v. 65, n. 10, pp. 1639\u20131672, 2006.\n\n\n\nR EFER ENCES 83\n\n[22] FO R SY T H, P. A. A control-volume, finite-element method for local\nmesh refinement in thermal reservoir simulation. SPE Reservoir En-\ngineering , v. 5, n. 4, pp. 561\u2013566, 1990.\n\n[23] FO ULSER, R. W. S.; GO ODYEA R, S. G. Improved stability of the IMPES\nformulation for chemical flooding. SPE paper 18417 \u2013 SPE Reservoir\nSimulation Symposium, Houston, TX, 6\u20138 February, 1989.\n\n[24] FUNG, L. S.; HIEB ERT, A. D.; NGH IEM, L. Reservoir simulation with a\ncontrol-volume finite-element method. SPE Reservoir Engineering , v.\n7, n. 3, pp. 349\u2013357, 1992.\n\n[25] GOT TAR DI, G.; DA LL\u2019OLIO, D. A control-volume finite-element model\nfor simulating oil-water reservoirs. Journal of Petroleum Science and\nEngineering , v. 8, pp. 29\u201341, 1992.\n\n[26] HURTA DO, F. S. V. Uma formula\u00e7\u00e3o de volumes finitos baseada em\nelementos para a simula\u00e7\u00e3o do deslocamento bif\u00e1sico imisc\u00edvel em\nmeios porosos. Master\u2019s Dissertation (in Portuguese), Federal Univer-\nsity of Santa Catarina, 2005.\n\n[27] HURTA DO, F. S. V. Formula\u00e7\u00e3o tridimensional de volumes finitos para\nsimula\u00e7\u00e3o de reservat\u00f3rios de petr\u00f3leo com malhas n\u00e3o-estruturadas\nh\u00edbridas. Doctoral Thesis (in Portuguese), Federal University of Santa\nCatarina, 2011.\n\n[28] HURTA DO, F. S. V.; MA LISK A, C. R.; SILVA, A. F. C. A variable timestep\nstrategy for accelerating the IMPES solution algorithm in reservoir\nsimulation. Proceedings of the XXVII Iberian Latin American Congress on\nComputational Methods in Engineering \u2013 CILAMCE 2006, Bel\u00e9m, Brasil,\n\n3\u20136 September, 2006.\n\n[29] KA R PINS KI, L.; MA LISK A, C. R.; MA RCO NDES, F.; DELSH A D, M.;\nSEPEH R N OO R I, K. An element based conservative approach using\nunstructured grids in conjunction with a chemical flooding composi-\ntional reservoir simulator. Proceedings of COBEM 2009, Gramado, 15\u2013\n20 November, 2009.\n\n[30] KA R PINS KI, L.; TA DA, M. P.; SILVA, A. F. C.; MA LISK A, C. R.; SA NSO NI JR.,\nU. Peaceman\u2019s well model evaluation for non-isolated and partially\npenetrating wells. Rio Oil &amp; Gas Expo and Conference 2010, Rio de\nJaneiro, 13\u201316 September, 2010.\n\n\n\n84 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\n[31] KUZM I N, D.; M\u00d6 LLER, M. Algebraic flux correction I. Scalar conserva-\ntion laws. In: Kuzmin, D.; L\u00f6hner, R.; Turek, S. (eds.). Flux-corrected\ntransport: Principles, algorithms, and applications. Springer, Berlin,\n\n2005.\n\n[32] LA KE, L. W. Enhanced oil recovery. Prentice Hall, Englewood Cliffs,\n1989.\n\n[33] LA BO R ATO IR E D\u2019ANA LY SE, TO PO LOG IE, PRO BA B ILIT \u00c9S \u2013 MA R SEILLE.\nBenchmark on discretization schemes for anisotropic\ndiffusion problems on general grids in 3D. Available in\nhttp://www.latp.univ-mrs.fr/latp_numerique, accessed in November\n2010.\n\n[34] MACDO NA LD, R. C.; COATS, K. H. Methods for Numerical Simulation\nof Water and Gas Coning. SPE Journal, v. 10, n. 4, pp. 425\u2013436, 1970.\n\n[35] MA IZER ET, P. D. Well indices for non conventional wells. Master\u2019s\nThesis, University of Stanford, 1996.\n\n[36] MA LISK A, C. R. Transfer\u00eancia de calor e mec\u00e2nica dos fluidos com-\nputacional, 2nd edition (in Portuguese). Livros T\u00e9cnicos e Cient\u00edficos\nEditora S.A., Rio de Janeiro, 2004.\n\n[37] MA LISK A, C. R.; SILVA, A. F. C.; HURTA DO, F. S. V.; DO NAT T I, C.; PESCA DO R,\nA. V. B. Projeto de Simula\u00e7\u00e3o de Reservat\u00f3rios de Petr\u00f3leo pelo M\u00e9todo\nEbFVM e Solver Multigrid (SimReP) \u2013 Rede de Gerenciamento e Sim-\nula\u00e7\u00e3o de Reservat\u00f3rios (SiGeR). 1st Technical Report (in Portuguese),\nSINMEC Lab \u2013 Federal University of Santa Catarina, Florian\u00f3polis, 2008.\n\n[38] MA LISK A, C. R.; SILVA, A. F. C.; TA DA, M. P.; KA R PIN SKI, L.; PESCA DO R,\nA. V. B.; JO S\u00c9, F. A.; SO PR A NO, A. B.; VA LE, B. T. Desenvolvimento\nde um aplicativo para a simula\u00e7\u00e3o do escoamento acoplado po\u00e7o-\nreservat\u00f3rio ( WellRes) \u2013 Rede de Engenharia de Po\u00e7os (REDEP). 2nd\n\nTechnical Report (in Portuguese), SINMEC Lab \u2013 Federal University of\n\nSanta Catarina, Florian\u00f3polis, 2009.\n\n[39] MA LISK A, C. R.; SILVA, A. F. C.; HURTA DO, F. S. V.; DO NAT T I, C.; PESCA DO R,\nA. V. B. Projeto de Simula\u00e7\u00e3o de Reservat\u00f3rios de Petr\u00f3leo pelo M\u00e9todo\nEbFVM e Solver Multigrid (SimReP) \u2013 Rede de Gerenciamento e Sim-\nula\u00e7\u00e3o de Reservat\u00f3rios (SiGeR). 2nd Technical Report (in Portuguese),\nSINMEC Lab \u2013 Federal University of Santa Catarina, Florian\u00f3polis, 2009.\n\n\n\nR EFER ENCES 85\n\n[40] MA LISK A, C. R.; SILVA, A. F. C.; HURTA DO, F. S. V.; DO NAT T I, C.; PESCA DO R,\nA. V. B. Projeto de Simula\u00e7\u00e3o de Reservat\u00f3rios de Petr\u00f3leo pelo M\u00e9todo\nEbFVM e Solver Multigrid (SimReP) \u2013 Rede de Gerenciamento e Sim-\nula\u00e7\u00e3o de Reservat\u00f3rios (SiGeR). 3rd Technical Report (in Portuguese),\nSINMEC Lab \u2013 Federal University of Santa Catarina, Florian\u00f3polis, 2009.\n\n[41] MA LISK A, C. R.; SILVA, A. F. C.; HURTA DO, F. S. V.; DO NAT T I, C.; PESCA DO R,\nA. V. B. Projeto de Simula\u00e7\u00e3o de Reservat\u00f3rios de Petr\u00f3leo pelo M\u00e9todo\nEbFVM e Solver Multigrid (SimReP) \u2013 Rede de Gerenciamento e Sim-\nula\u00e7\u00e3o de Reservat\u00f3rios (SiGeR). 4th Technical Report (in Portuguese),\nSINMEC Lab \u2013 Federal University of Santa Catarina, Florian\u00f3polis, 2009.\n\n[42] MA LISK A, C. R.; SILVA, A. F. C.; HURTA DO, F. S. V.; DO NAT T I, C.; PESCA DO R,\nA. V. B. Projeto de Simula\u00e7\u00e3o de Reservat\u00f3rios de Petr\u00f3leo pelo M\u00e9todo\nEbFVM e Solver Multigrid (SimReP) \u2013 Rede de Gerenciamento e Sim-\nula\u00e7\u00e3o de Reservat\u00f3rios (SiGeR). 5th Technical Report (in Portuguese),\nSINMEC Lab \u2013 Federal University of Santa Catarina, Florian\u00f3polis, 2009.\n\n[43] OUYAN G, L.-B.; AZIZ, K. A simplified approach to couple wellbore flow\nand reservoir inflow for arbitrary well configurations. SPE paper 48936\n\u2013 SPE Annual Technical Conference and Exhibition, New Orleans, 27-30\n\nSeptember, 1998.\n\n[44] PEACEM A N, D. W. Fundamentals of numerical reservoir simulation.\nElsevier Scientific Publishing Company, Amsterdam, 1977.\n\n[45] PEACEM A N, D. W. Interpretation of well-block pressures in numerical\nreservoir simulation. SPE Journal, v. 18, n. 3, pp. 183\u2013194, 1977.\n\n[46] PEACEM A N, D. W. Interpretation of well-block pressures in numeri-\ncal reservoir simulation with nonsquare grid blocks and anisotropic\npermeability. SPE Journal, v. 23, n. 3, pp. 531\u2013543, 1983.\n\n[47] RAW, M. A new control volume based finite element procedure for\nthe numerical solution of the fluid flow and scalar transport equa-\ntions. Ph.D. Thesis, University of Waterloo, 1985.\n\n[48] RO ZO N, B. J. A generalized finite volume discretization method for\nreservoir simulation. SPE paper 18414 \u2013 SPE Reservoir Simulation\nSymposium, Houston, TX, 6\u20138 February, 1989.\n\n\n\n86 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\n[49] SA AD, N. Field scale studies with a 3-D chemical flooding simulator.\nPh.D. Dissertation, The University of Texas at Austin, 1989.\n\n[50] SCH NEIDER, G.; ZEDA N, M. Control-volume-based finite element\nformulation of the heat conduction equation. Spacecraft Thermal\nControl, Design and Operation, v. 86, pp. 305\u2013327, 1983.\n\n[51] SO R BI E, K. S. Polymer-improved oil recovery. CRC Press, Boca Raton,\n1991.\n\n[52] SPILL ET T E, A. G.; HILL ESTA D, J. G.; STO NE, H. L. A high-stability\nsequential solution approach to reservoir simulation. SPE paper 4542\n- Fall Meeting of the Society of Petroleum Engineers of AIME, Las Vegas,\n\n30 September \u2013 3 October, 1973.\n\n[53] TA DA, M. P. An\u00e1lise de esquemas num\u00e9ricos de cinco e nove pontos\npara malhas tipo corner-point. Master\u2019s Dissertation (in Portuguese),\nFederal University of Santa Catarina, 2009.\n\n[54] TA DA, M. P.; KA R PIN SKI, L.; SILVA, A. F. C.; MA LISK A, C. R.; SA NSO NI JR., U.\nTwo dimensional off-center well modeling in reservoir simulation. Rio\nOil &amp; Gas Expo and Conference 2010, Rio de Janeiro, 13\u201316 September,\n\n2010.\n\n[55] UTCHEM-9.0. Technical documentation for UTCHEM-9.0: a three-\ndimensional chemical flood simulator. Reservoir Engineering Re-\nsearch Program, Center for Petroleum and Geosystems Engineering.\n\nThe University of Texas at Austin, 2000.\n\n[56] UTCHEM-9.9. User\u2019s guide for UTCHEM-9.9: a three-dimensional\nchemical flood simulator. Reservoir Engineering Research Program,\nCenter for Petroleum and Geosystems Engineering. The University of\n\nTexas at Austin, 2008.\n\n[57] WO LFST EI NER, C.; DUR LO FSK Y, L. J.; AZIZ, K. Calculation of well\nindex for nonconventional wells on arbitrary grids. Computational\nGeosciences, v. 7, pp. 61\u201382, 2003.\n\n[58] ZGA IN SKI, F.-X.; CO ULO M B, J.-L.; MA R \u00c9CH A L, Y.; CL A EY SSEN, F.;\nBRUNOT T E, X. A new family of finite elements: the pyramidal elements.\nIEEE Transactions on Magnetics, v. 32, n. 3, pp. 1393\u20131396, 1996 (in\n\nPortuguese).\n\n\n\nAPPENDIX\n\nA\nPE AC E M A N\u2019S W E L L M O D E L F O R\n\nU N S T RU C T U R E D G R I D S\n\nOne of the pioneers in modeling the well in reservoir simulation\n\naccurately is Peaceman, who derived a relation between the well pressure\n\nand wellblock1 pressure for uniform structured grids in 1978 [45]. As in\nmost analytical techniques for well models, in order to determine the\n\nwell index, a single-phase flow problem in a homogeneous and isotropic\n\nmedium, with permeability K , is considered. Peaceman\u2019s model [45] also\nconsiders a steady-state regime. Therefore, for an areal reservoir model,\n\nwith thickness h , in the well neighborhood the pressure will depend only\n\non the radial coordinate r , as illustrated in Fig. A.1. Darcy\u2019s law, for these\n\nconditions, is reduced to\n\n?\nQ\n\n2?r h\n=?\n\nK\n\n\u00b5\n\ndP\n\ndr\n. (A.1)\n\nIntegrating Eq. (A.1) between the well radius rw and a generic radius\n\nnear the well, the following relationship for the pressure is obtained:\n\n1 As in Peaceman\u2019s work structured Cartesian grids are used, the well is located in the\ncenter of the gridblocks. A gridblock containing a well is denominated wellblock. In this\ndissertation, the well is located in the nodes, and, therefore, a node containing a well will be\ncalled wellnode.\n\n87\n\n\n\n88 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\nrw\nr\n\nWell\n\nReservoir\n\nFigure A.1 \u2013 Well in an areal reservoir model.\n\nP(r)= Pw +\nQ\u00b5\n\n2?h K\nln\n\n?\n\nr\n\nrw\n\n?\n\n. (A.2)\n\nAs performed in Peaceman [45], an equivalent radius, ro , is associated\nto the wellnode. This is the radius at which the steady-state flowing\n\npressure for the actual well is equal to the numerically calculate pressure\n\nfor the wellnode, Pp . This definition for ro gives\n\nQ =\n1\n\n\u00b5\n\n2?h K\n\nln(ro/rw)\n\n?\n\nPp ?Pw\n?\n\n. (A.3)\n\nThe constant portion related to geometry and medium is grouped in\n\na coefficient called well index, WI . Therefore, Eq. (A.3) can be written as\n\nQ =?WI\n?\n\nPp ?Pw\n?\n\n, (A.4)\n\nwhere ?=\u00b5?1.\nThe determination of the well index is reduced, therefore, to the\n\ndetermination of the equivalent radius, location where the nodal pressure\n\nand the pressure from the analytical solution are equal. This determination\n\nfor unstructured grids follows one of the ideas presented in Peaceman [45]\nfor structured and uniform grids. The idea is to apply a mass balance\n\nover the control volume where the well is located and equate the flux over\n\nall faces of the control surface with the well flow rate from the analytical\n\nsolution, given in Eq. (A.4). For this, considering a situation as illustrated\n\nin Fig. A.2, the well flow rate produced at the well must cross the faces in\n\nthe control surface. Thus, applying Eq. (3.24) for one phase with constant\n\n\n\nA PPEN DIX A \u2013 PEACEM A N\u2019S W ELL M O DEL FO R UN ST RUCT U R ED GR IDS 89\n\nWell (node p)\n\nro\n\nqf\n\nrk\n\nx\n\ny\n\nFigure A.2 \u2013 Control volume and elements around a producer well.\n\nmobility in a 2D areal domain, one can obtain\n\nQ =\n?\n\nf ?Fp\n\nq f =\n?\n\ne ?Ep\n\n?\n\nf ?Fep\n\n?[b]T\nf?\n[P?]e . (A.5)\n\nIn Eq. (A.5), q f are the individual fluxes through each of the faces that\n\nform the control surface. Since only one phase with constant viscosity is\n\nbeing considered, the subscripts related to the phase in Eq. (3.24) were\n\nomitted. After performing the summations in Eq. (A.5), a linear expression\n\nfor the nodal pressures is obtained, which can be written in a similar way\n\nas performed in Eq. (3.28):\n\nQ =\n?\n\nk ?Tp\n\n?ak Pk , (A.6)\n\nwhere k ?Tp represents all nodes in the stencil of node p [40]. This stencil\nis formed by the nodes from the elements that contain node p , that is,\n\nfrom the elements that are present in the control volume construction. The\n\ncoefficients ak are combinations of some components of vector [b] f? . This\ngroup of coefficients has the important property that the summation over\n\nall coefficients is always null [37, 47], that is,\n\n\n\n90 L. K AR PINSK I - M A ST ER\u2019S DI SSERTAT IO N IN M EC H A NICA L ENGI NEER IN G\n\n?\n\nk ?Tp\n\nak = 0 . (A.7)\n\nSubtracting from the RHS of Eq. (A.6), the term Pp\n?\n\nak , which is\n\nequal to zero, an equivalent relation is obtained:\n\nQ =\n?\n\nk ?Tp?\n?ak\n\n?\n\nPk ?Pp\n?\n\n, (A.8)\n\nwhere now the summation k ? Tp? is only over the neighboring nodes. This\nequation, derived from the use of shape functions for the pressure gradient\n\napproximation, must be related to the analytical expression obtained by\n\nintegrating Eq. (A.1). Assuming this equation is valid until the position\n\nwhere the wellnode neighbors are located, the integration of Eq. (A.1) from\n\nro to rk will provide\n\nPk = Pp +\nQ\u00b5\n\n2?h K\nln\n\n?\n\nrk\nro\n\n?\n\n, (A.9)\n\nwhere Pk is the pressure of each node in the wellnode stencil and rk is the\n\ndistance between node k and the wellnode p . Substituting Eq. (A.9) into\n\nEq. (A.8), one can obtain\n\nQ =\n?\n\nk ?Tp?\n?ak\n\nQ\u00b5\n\n2?h K\nln\n\n?\n\nrk\nrw\n\n?\n\n, (A.10)\n\nor\n\n1 =\n?\n\nk ?Tp?\nak\n\n1\n\n2?h K\nln\n\n?\n\nrk\nrw\n\n?\n\n. (A.11)\n\nFinally, from the previous expression it is possible to obtain the\n\nequivalent radius, which is given by\n\nro = exp\n\n?\n\n?\n\n?\n\n?\n\n?\n\nk ?Tp?\nak ln rk ?2?h K\n?\n\nk ?Tp?\nak\n\n?\n\n?\n\n?\n\n?\n\n. (A.12)\n\nThe present procedure provides the equivalent radius, and there-\n\nfore, the well index for vertical wells in unstructured grids, which are\n\nrepresented by a point in 2D areal reservoirs. In order to apply such a\n\n\n\nA PPEN DIX A \u2013 PEACEM A N\u2019S W ELL M O DEL FO R UN ST RUCT U R ED GR IDS 91\n\nscheme for vertical wells in 3D unstructured grids, the reservoir must have\n\nonly horizontal layers, in such a way the wells are perpendicular to the\n\nlayers. This way, each layer is treated as a 2D areal reservoir, and the same\n\nprocedure can be applied. Note that in this case, in order to perform the\n\nmass balance, the stencil of each wellnode is reduced to the neighbors\n\nlocated at the same layer. The nodes located on the top or bottom layers\n\nare ignored.\n\n\n\tLKdissertation - Folha aprova\u00e7\u00e3o.pdf\n\tPage 1"}]}}}