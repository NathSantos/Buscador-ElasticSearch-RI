{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.06207"}, {"@name": "filename", "#text": "10725_280141.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "AGUSTINHO PLUCENIO\nDESENVOLVIMENTO DE TECNICAS\nDE CONTROLE nAo LINEAR PARA elevacAo DE FLUIDOS multifAsicos\nFLORIANOPOLIS 2010\nUNIVERSIDADE FEDERAL DE SANTA CATARINA PROGRAMA DE p\u00f3s-gradua\u00e7Ao EM ENGENHARIA DE AUTOMA\u00c7A\u00f3 E SISTEMAS\nDESENVOLVIMENTO DE tECNICAS DE CONTROLE nA\u00f3 LINEAR PARA eleva\u00e7Ao DE FLUIDOS multifAsicos\nTese submetida \u00e0 Universidade Federal de Santa Catarina como parte dos requisitos para a obten\u00e7\u00e3o do grau de Doutor em Engenharia de Automa\u00e7ao e Sistemas.\nAgustinho Plucenio\nFlorian\u00f3polis, Maio de 2010.\nCataloga\u00e7\u00e3o na fonte pela Biblioteca Universit\u00e1ria da\nUniversidade Federal de Santa Catarina\nP733d Plucenio, Agustinho\nDesenvolvimento de t\u00e9cnicas de controle n\u00e3o linear para eleva\u00e7\u00e3o de fluidos multif\u00e1sicos [tese] / Agustinho Plucenio ; orientador, Daniel Juan Pagano. - Florian\u00f3polis, SC, 2010.\n275 p.: il., grafs., tabs.\nTese (doutorado) - Universidade Federal de Santa Catarina, Centro Tecnol\u00f3gico. Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Automa\u00e7\u00e3o e Sistemas.\nInclui refer\u00eancias\n1. Engenharia de sistemas. 2. Controle preditivo para sistemas n\u00e3o lineares. 3. Eleva\u00e7\u00e3o por inje\u00e7\u00e3o cont\u00ednua de g\u00e1s. I. Pagano, Daniel Juan. II. Universidade Federal de Santa Catarina. Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Automa\u00e7\u00e3o e Sistemas. III. T\u00edtulo.\nCDU 621.3-231.2(021)\nDESENVOLVIMENTO DE T\u00c9CNICAS DE CONTROLE NAO LINEAR PARA elevacAo DE FLUIDOS multifAsicos\nAgustinho Plucenio\n\u2018Esta Tese foi julgada adequada, servindo como requisito parcial para a obten\u00e7\u00e3o do T\u00edtulo de Doutor em Engenharia de Automa\u00e7ao e Sistemas, e aprovado em sua forma final pelo Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Automa\u00e7ao e Sistemas da Universidade Federal de Santa Catarina.'\nDaniel J. Pagano, Dr.\nOrientador\nEug\u00eanio de Bona Castelan Neto, Dr.\nCoordenador do Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Automa\u00e7\u00e3o e Sistemas\nBanca Examinadora:\nDaniel J. Pagano, Dr. Presidente\nAdhemar de Barros Fontes, Dr.\nMario C. Massa de Campos, Dr.\nPedro Garcia Gil, Dr.\nJulio Elias Normey Rico, Dr.\nEduardo Camponogara, Dr.\nDedicatoria\nA memoria de meus queridos pais Jos\u00e9 e Celina Aurelia Plucenio.\nvi\nAgradecimentos\nAgrade\u00e7o a minha esposa M\u00e1rcia e aos meus filhos Daniel, Renata e Guilherme pelo incondicional carinho e apoio.\nviii\nResumo da tese apresentada \u00e0 UFSC como parte dos requisitos necess\u00e1rios para obten\u00e7\u00e3o do grau de Doutor em Engenharia de Automa\u00e7ao e Sistemas.\nDesenvolvimento de T\u00e9cnicas de Controle N\u00e3o Linear para Elevacao de Fluidos\n->\nMultif\u00e9sicos\nAgustinho Plucenio\nMaio/2010.\nOrientador: Prof. Dr. Daniel Juan Pagano\nArea de Concentra\u00e7\u00e3o: Controle e Automa\u00e7\u00e3o\nPalavras-chave: Controle Preditivo para Sistemas N\u00e3o\nLineares, Eleva\u00e7\u00e3o por Injecao Cont\u00ednua de Gas\nNumero de Paginas: 341\nO ambiente no fundo de po\u00e7cos de petroleo e hostil. Altas press\u00e3oes e temperaturas frequentemente combinadas com a presenca de fluidos acidos s\u00e3o um desafio para a instala\u00e7\u00e3o de instrumentac\u00e3o de fundo de poco. Alem das condi\u00e7\u00f5es do ambiente, ha a dificuldade de prover alimenta\u00e7c\u00e3ao de energia para esses instrumentos e meios de comunica\u00e7\u00e3o com a superf\u00edcie. N\u00e3o menos importante \u00e9 o desafio tecnol\u00f3gico da medicao das vaz\u00e3es de agua, oleo e gas em escoamento multifasico com tecnicas nao intrusivas e com baixa perda de press\u00e3o. Para com-pleta\u00e7\u00e3es em aguas profundas e especialmente com a cabeca do po\u00e7o instalada no fundo do mar (arvore de Natal molhada), uma opera\u00e7ao para a troca de um instrumento de fundo de poc\u00e7o pode significar custos da ordem de ate dezenas de milh\u00e3oes de dolares. Esta situa\u00e7ca\u00e3o inibiu por muito tempo o desenvolvimento de instrumenta\u00e7c\u00e3ao para fundo de poco e possivelmente foi um dos fatores que influenciou o baixo n\u00edvel de\npesquisa em modelos e t\u00e9cnicas de controle e automa\u00e7\u00e3o da produ\u00e7\u00e3o j\u00e1 que para controlar deve-se medir. Felizmente, nos Ultimos 10 anos, tem havido um grande desenvolvimento de instrumentos de medic\u00e3o e atua\u00e7ao para uso no fundo de pocos. Paralelamente ao esfor\u00e7o na \u00e9rea de instrumentac\u00e7\u00e3ao tem havido avan\u00e7cos no desenvolvimento de t\u00e9ecnicas de controle e automa\u00e7c\u00e3ao para a produ\u00e7ca\u00e3o de petro\u00e9leo protagonizados pelas grandes empresas operadoras. As solu\u00e7\u00f5es propostas por cada empresa recebem diferentes denominac\u00e3es como Campo Inteligente, Po\u00e7o Inteligente, Gerenciamento digital e integrado da produ\u00e7\u00e3o, etc, mas, independente da denomina\u00e7c\u00e3ao, consistem na aplica\u00e7c\u00e3ao de t\u00e9ecnicas de controle, automac\u00e7\u00e3ao e otimiza\u00e7ca\u00e3o para o desenvolvimento de um campo de petro\u00e9leo. Frequentemente as solu\u00e7c\u00e3oes propostas sa\u00e3o incipientes e utilizam heur\u00edsticas nas tomadas de decisoes frente a falta de modelos representativos dos processos e da aus\u00eancia de medi\u00e7\u00e3o de todas as variaveis necess\u00e1rias. Em alguns projetos recentes de desenvolvimento de campos de petro\u00e9leo torna-se evidente que o avan\u00e7co da tecnologia de instrumenta\u00e7c\u00e3ao de fundo de po\u00e7co atropelou o desenvolvimento de modelos e algoritmos de controle que n\u00e3ao est\u00e3ao preparados para utilizar as novas medi\u00e7co\u00e3es e capacidade de atua\u00e7ca\u00e3o para a melhoria do controle dos processos de explota\u00e7\u00e3o. Nesses casos a empresa operadora depara-se com o problema de ter mais informac\u00e7\u00e3ao do que pode utilizar. Em algumas instalac\u00e7\u00e3oes modernas a quantidade de informa\u00e7ca\u00e3o \u00e9e tanta que a dificuldade \u00e9 determinar quais dados armazenar e em que taxa de amostragem uma vez que existe uma percepc\u00e7a\u00e3o de que essas informa\u00e7c\u00e3oes n\u00e3ao est\u00e3ao sendo utilizadas em toda sua plenitude.\nO algoritmo de controle preditivo para sistemas n\u00e3o lineares desenvolvido neste trabalho pode utilizar praticamente qualquer tipo de modelo do processo j\u00e9a que obt\u00e9em a representac\u00e7\u00e3ao linearizada do sistema de forma num\u00e9rica. Esta caracter\u00edstica deve permitir sua utiliza-c\u00e7\u00e3ao no controle e otimiza\u00e7ca\u00e3o da explota\u00e7c\u00e3ao de reservat\u00e9orios utilizando simulador de reservat\u00e9orio como modelo do processo. A din\u00eaamica lenta das principais vari\u00e9aveis e par\u00eaametros do reservat\u00e9orio permite tempos de amostragem ta\u00e3o grande como dias ou at\u00e9e meses o que facilitaria a aplica\u00e7c\u00e3ao do algoritmo.\nriser submarino. A eleva\u00e7\u00e3o por GLC \u00e9 um dos m\u00e9todos de eleva\u00e7\u00e3o artificial mais utilizados no Brasil respondendo por mais de 70 % da produ\u00e7ao do petr\u00e9leo nacional. Os desenvolvimentos pressup\u00e3em que os po\u00e7os operando via GLC disponham da medi\u00e7ao da pressao e temperatura de fundo dos po\u00e7os, da medi\u00e7\u00e3o da vazao de inje\u00e7ao de gas e da exist\u00eancia de chokes de inje\u00e7\u00e3o de g\u00e9s com atua\u00e7\u00e3o automatica.\nAs contribui\u00e7c\u00e3oes do trabalho sa\u00e3o\n\u2022\to desenvolvimento de modelos para utiliza\u00e7\u00e3o na descric\u00e3o fenome-nol\u00e9ogica, otimizac\u00e7\u00e3ao e controle do processo de eleva\u00e7c\u00e3ao por GLC,\n\u2022\tdesenvolvimento de um algoritmo de controle MPC distribu\u00eddo,\n\u2022\tdesenvolvimento de um algoritmo MPC pratico para sistemas n\u00e3o lineares,\n\u2022\taplica\u00e7c\u00e3ao de otimizac\u00e7\u00e3ao e controle a um grupo de po\u00e7cos operando via GLC e\n\u2022\ta aplica\u00e7\u00e3o de controle na operac\u00e3o de um riser submarino.\nAbstract of the Thesis presented to UFSC as a partial fulfillment of the requirements for the degree of Doctor in Automation and System Engineering.\nDevelopment of Non Linear Control Techniques for the lifting of Multiphase Fluids\nAgustinho Plucenio\nMay/2010.\nAdvisor: Prof. Dr. Daniel Juan Pagano\nArea of Concentration: Controle e Automa\u00e7\u00e3o Keywords: Model Based Predictive Control for Non Linear Systems, Gas-Lift\nNumber of pages: 341\nThe environment at the bottom of oil wells is hostile. High pressures and temperatures combined with the presence of acid fluids are a challenge for the installation of downhole instruments. Besides the environment conditions, there is a difficulty to provide power for the instruments and means of communication to the surface. Not less important is the technological challange for measuring the flow-rates of oil, water and gas in multiphase flow with non intrusive techniques with low pressure losses. For deep water completions and specially with the well production head at the sea bottom (wet xmas-tree completion), an operation to replace a faulty downhole instrument may cost up to tens of million dollars. For a long time this situation inhibited the development of downhole instruments and it is likely the cause for the low level of research on models and techniques for the control and automation of oil production since to control it is necessary to measure. Fortunately in the last 10 years there has been a big development of instrumentation for measuring and actuation for downhole wells. Parallel to the effort in the area of instrumentation there has been advances in developing techniques of control and automation for the oil production\nunder the leadership of the major operating companies. The solutions proposed by these companies receive different names as Inteligent Field Technology, Smar Well Technology, Digital and Integrated Oilfied Management, etc, but, regardless of denomination, are the implementation of control techniques, automation and optimization to develop an oil field.\nQuite often the proposed solutions are only incipient and use heuristics in making decisions due to the lack of representative process models and complete measurements of all variables.\nIn some modern oilfield development projects it becomes evident that advances in downhole instrumentation technology ran over the development of models and control algorithms that are not ready to use the new measurements and actuation capacity to improve the exploitation process. In this case the operating oil company faces the problem of having more information than it can use. In some modern facilities the amount of information is such that often the difficulty is determining what data to store and what sampling rate to adopt, as there is a perception that this information is not being used in all its fullness.\nThe model based predictive control algorithm for nonlinear systems developed in this work can use practically any kind of process model since it derives a linearized representation of the system numerically. This characteristic should allows its application in controlling and optimizing the exploitation of reservoirs using a reservoir simulator as the system model. The slow dynamics of the main reservoir variables and parameters allows sampling times as big as days or even months which would facilitate the implementation of the algorithm.\nOne of the first downhole instruments developed were the temperature and pressure downhole gages (PDG) that are being installed today in nearly all new offshore wells in Brasil. This work deals with the development of models and control techniques for multiphase flow lift approaching the gas-lift method and the fluid elevation in submarine risers. More than 70% of the oil production in Brazil is realized using ccontinuous gas-lift (GLC) as the artificial lift method. The developments assume that the wells operating with gas-lift have downhole pressure and temperature measurements, gas injection flow-rate measurements and automated injection chokes.\nThe contributions of this work are\n\u2022\tdevelopment of gas-lift models for the phenomenological description of the process, optimization and process control,\n\u2022\tdevelopment of an algorithm for distributed MPC,\n\u2022\tdevelopment of an algorithm MPC for nonlinear systems,\n\u2022\tapplication of control and optimization for a group of wells operating with gas-lift,\n\u2022\tapplication of control for the operation of a submarine riser.\nGloss\u00e1rio\nArvore de Natal - Conjunto de equipamentos como v\u00e1lvulas e conex\u00f5es instalados na cabe\u00e7a do po\u00e7o cuja fun\u00e7ao principal \u00e9 possibilitar o escoamento para fora ou para dentro do po\u00e7o. BSW - Basic sediments and water.\nCabeca do poco - O sistema de conex\u00f5es, v\u00e9lvulas e adaptadores variados que proporcionam o controle da press\u00f5ao de um poc\u00e7o de produc\u00e7\u00f5ao.\nCanhoneados - Regi\u00f5o do revestimento onde foi realizado operac\u00f5o de canhoneio visando estabelecer comunicac\u00f5o hi-dra\u00e9ulica entre o poc\u00e7o e a forma\u00e7c\u00f5ao.\nChoke - Dispositivo que incorpora um orif\u00edcio, utilizado para ajustar vaz\u00f5ao ou press\u00f5ao.\nCompleta\u00e7\u00f5o - Conjunto de opera\u00e7\u00f5es realizadas depois da perfura\u00e7c\u00f5ao do po\u00e7co que visam colocar o po\u00e7co em produ\u00e7c\u00f5ao. Depletado - Reservat\u00e9orio cuja press\u00f5ao caiu abaixo da press\u00f5ao original devido a produ\u00e7ao de fluidos.\nExplota\u00e7\u00f5o - Explorac\u00f5o econ\u00f4mica de um campo petrol\u00edfero. Explora\u00e7\u00f5o - Fase inicial das opera\u00e7\u00f5es de petr\u00e9leo que incluem a gera\u00e7c\u00f5ao de um prospecto e a perfurac\u00e7\u00f5ao de um po\u00e7co explorat\u00e9orio.\nFluido subsaturado - Fluido que na press\u00f5ao e temperatura em que se encontra \u00e9 100% l\u00edquido.\nGas lift manifold - Sec\u00f5o de duto que recebe g\u00e9s da unidade de compress\u00f5ao e de onde saem dutos que alimentam os po\u00e7cos operando via gas lift cont\u00ednuo.\nGOR - Gas Oil Ratio.\nPacker - Elemento instalado dentro do po\u00e7o revestido que permite isolar o espa\u00e7co anular revestimento-tubo de pro-duc\u00e7\u00e3ao do tubo de produ\u00e7c\u00e3ao.\nPerfilagem - Conjunto de registros de dados da formac\u00e3o obtidos por meio de ferramentas descidas no interior do po\u00e7co. Revestimento ou casing - Tubos de a\u00e7o de em se\u00e7oes de aproximadamente 12 metros utilizados para fazer o isolamento do po\u00e7co com a forma\u00e7ca\u00e3o.\nSlick line - Opera\u00e7c\u00e3ao onde ferramentas s\u00e3ao descidas dentro do poc\u00e7o na extremidade de um cabo de a\u00e7co para realizar operac\u00e7\u00e3oes como assentamento de v\u00e9alvulas de gas-lift, movimentar sliding-sleeves, etc.\nSliding Sleeve - Luva deslizante que permite bloquear ou abrir para fluxo uma zona do poco.\nTubos de produ\u00e7c\u00e3ao ou tubing - Tubos de a\u00e7co instalados no interior dos po\u00e7cos revestidos por onde fluem os fluidos produzidos ou injetados.\nSum\u00e1rio\n1\tIntrodu\u00e7\u00e3o\t1\n1.1\tObjetivos do Trabalho................................. 6\n1.2\tOrganiza\u00e7\u00e3o do Trabalho .............................. 6\n2\tEleva\u00e7\u00e3o Artificial via Inje\u00e7\u00e3o Cont\u00ednua de G\u00e1s\t9\n2.1\tO Processo de Eleva\u00e7\u00e3o por Inje\u00e7\u00e3o Cont\u00ednua de G\u00e1s -\nGLC................J................................. 10\n2.2\tModelagem do Processo de Eleva\u00e7ao por Inje\u00e7ao Cont\u00ednua de Gas ........................................ 14\n2.2.1\tUm modelo fenomenol\u00e1gico a par\u00e2metros concentrados ........................................... 18\n2.2.2\tUm modelo emp\u00edrico para otimizac\u00e3o da eleva\u00e7\u00e3o\npor GLC ...................................... 45\n2.2.3\tUm modelo din\u00e2mico para controle e otimizac\u00e3o 78\n2.3\tConclus\u00f5es e desenvolvimentos futuros................ 81\n3\tControle MPC Distribu\u00eddo\t83\n3.1\tDesenvolvimento de agentes para controle de processos .\t85\n3.2\tMPC distribu\u00eddo...................................... 87\n3.2.1\tDecomposi\u00e7\u00e3o da Formulac\u00e3o MPC sem restric\u00e3o 88\n3.2.2\tAplicac\u00e3o da t\u00e1cnica para um problema benchmark 94\n3.2.3\tCompara\u00e7\u00e3o entre o algoritmo MPC Centralizado\ne Distribu\u00eddo ................................ 97\n3.2.4\tDesempenho do algoritmo MPC distribu\u00eddo ...\t99\n3.3\tConverg\u00e2encia do Algoritmo MPC distribu\u00eddo ......... 101\n3.4\tMPC distribu\u00eddo na presenc\u00e7a de restri\u00e7co\u00e3es ....... 103\n3.4.1\tRestri\u00e7\u00f5es sobre Au............................105\n3.4.2\tRestri\u00e7\u00f5es sobre u.............................109\n3.4.3\tRestri\u00e7\u00f5es sobre y.............................112\n3.5\tConclus\u00f5es e desenvolvimentos futuros.................120\n4\tMPC Pr\u00e1tico para sistemas n\u00e3o lineares - PNMPC 121\n4.1\tIntrodu\u00e7\u00f5o............................................121\n4.2\tMetodologias de MPC para Processos N\u00f5o Lineares . . . 123\n4.2.1\tMPC com modelos de predi\u00e7\u00f5o nao-linear na Fun\u00e7\u00f5o\nObjetivo.......................................123\n4.2.2\tM\u00e9todos baseados em\tmodelos particulares . . . 124\n4.2.3\tM\u00e9todos baseados em\tlineariza\u00e7\u00f5es...........124\n4.3\tDesenvolvimento da t\u00e9cnica PNMPC......................127\n4.3.1\tA obten\u00e7\u00f5o de F e Gpnmpc.......................137\n4.3.2\tObten\u00e7\u00f5o da a\u00e7\u00f5o\tde controle..................138\n4.3.3\tExemplo 1......................................138\n4.4\tErro de predi\u00e7\u00f5o, ru\u00eddo e perturba\u00e7\u00f5es................141\n4.4.1\tExemplo 2......................................144\n4.5\tAplica\u00e7\u00f5o em processos multivari\u00e9veis.................148\n4.5.1\tExemplo 3 - PNMPC aplicado no controle de\numa Planta com 6 Tanques Esf\u00e9ricos.............148\n4.6\tPNMPC com Gradiente Ponderado.........................155\n4.6.1\tExemplo 4 - PNMPC aplicado no controle da\nreac\u00f5o Van Der Vussen..........................159\n4.7\tEstabilidade..........................................168\n4.7.1\tDesenvolvendo uma condi\u00e7\u00f5o suficiente para estabilidade .................................... 168\n4.7.2\tIntroduzindo a condi\u00e7ao para estabilidade na for-\nmula\u00e7\u00f5o MPC com PQ ............................170\n4.7.3\tAplica\u00e7\u00f5o da tecnica...........................172\n4.7.4\tM\u00e9todo iterativo para a restri\u00e7\u00f5o quadr\u00e1tica so-\nbre Au ........................................174\n4.8\tConclus\u00f5o e desenvolvimentos futuros .................192\n5\tControle aplicado a po\u00e7os operando via GLC\t195\n5.1\tIntroduc\u00e3o............................................196\n5.1.1\tElf 1990 ..................................... 197\n5.1.2\tSuez Oil Co. 1995 ............................ 198\n5.1.3\tShell 1998 ................................... 199\n5.1.4\tTexaco 1999 .................................. 203\n5.1.5\tTotalFinaElf 2002 ............................ 204\n5.1.6\tDubai Petroleum Company 2006 ................. 205\n5.1.7\tPetrobras 2006 ............................... 206\n5.2\tUm sistema de Controle autom\u00e1tico com \u00eanfase na otimiza-\n\u00e7\u00e3o da produ\u00e7\u00e3o.......................................208\n5.2.1\tObtencao da vaz\u00e3o de g\u00e1s dispon\u00edvel para inje\u00e7\u00e3o\nnos po\u00e7cos ................................... 209\n5.2.2\tControlador PI com a\u00e7ao Feed-Forward considerando\na din\u00eamica da valvula..........................217\n5.2.3\tS\u00e1ntese dos par\u00eametros de um Controlador Ro-\nbusto com ac\u00e7\u00e3ao FF .......................... 221\n5.2.4\tResultados obtidos com simula\u00e7ao na s\u00e1ntese do\ncontrolador robusto .......................... 222\n5.2.5\tImplementac\u00e3o da Proposta para Automa\u00e7\u00e3o de\num Grupo de Poc\u00e7os ........................... 227\n5.2.6\tUm estudo de caso para opera\u00e7\u00e3o com restri\u00e7\u00e3o . 230\n5.3\tUm sistema de Controle autom\u00e1tico utilizando a t\u00e9cnica\nde controle preditivo baseado em modelo PNMPC . . . 237\n5.3.1\tA formula\u00e7ao NMPC..............................238\n5.3.2\tA fun\u00e7\u00e3o custo para o algoritmo PNMPC .... 239\n5.3.3\tSintonia do algoritmo PNMPC....................246\n5.3.4\tResultados obtidos.............................248\n5.4\tConclus\u00e3es e desenvolvimentos futuros.................252\n6\tControle de escoamento em risers\t255\n6.1\tIntroduc\u00e3o............................................255\n6.2\tRevisitando a estrat\u00e1gia PI para suprimir slug-flow . . . 259\n6.3\tEstrat\u00e1gia Slug SMC...................................261\n6.4\tUma estrat\u00e1gia slug SMC modificada....................264\n6.5\tControle Slug Washout SMC.............................268\n6.6\tConclus\u00f5es ...........................................271\n7\tConclus\u00f5es e desenvolvimentos futuros\t275\nA Introdu\u00e7\u00e3o ao Controle Preditivo Baseado em Modelo281\nA.1\tIntrodu\u00e7\u00e3o......................................281\nA.2\tConceitos B\u00e1sicos de MPC .......................285\nA.2.1 Tipos de Controle Preditivo para Sistemas Lineares288\nA.2.2 DMC - Dynamic Matrix\tControl............289\nLista de Figuras\n2.1\tEleva\u00e7\u00e3o por Inje\u00e7\u00e3o Cont\u00ednua de G\u00e1s................. 11\n2.2\tCurva T\u00edpica da Vaz\u00e3o de L\u00edquido e Press\u00e3o na frente\ndos Canhoneados x Vazao M\u00e1ssica de G\u00e1s de Inje\u00e7ao . .\t12\n2.3\tPoco operando com Gas-lift........................... 20\n2.4\tFrac\u00e3o m\u00e1ssica de gas................................ 24\n2.5\tAlguns resultados para regime permanente............. 38\n2.6\tAlguns resultados de simula\u00e7\u00e3o din\u00e2mica I............ 39\n2.7\tAlguns resultados de simula\u00e7\u00e3o din\u00e2mica II........... 40\n2.8\tResultados com o simulador OLGA2000MR\tI......... 41\n2.9\tResultados com o simulador OLGA2000MR\tII........ 42\n2.10\tComportamento tipo \u00e1rbita fechada................... 42\n2.11\tEquil\u00e1brios com modelo desenvolvido................. 43\n2.12\tEquil\u00e1brios com OLGA2000MR.......................... 43\n2.13\tSimula\u00e7\u00e3o dinamica p/ Pr = 11 MPa com qgf = 0.55\nkg/s................................................. 44\n2.14\tModelo de influxo................................... 47\n2.15\tIPR\tlinear + Vogel.................................... 56\n2.16\tpwf\t=\tf (qinj)\tpara po\u00e7os UFSC-1\ta 4\t  66\n2.17\tpwf\t=\tf(qinj)\tpara po\u00e7os UFSC-5\ta 8\t  66\n2.18\tpwf\t=\tf (qi\u201ej)\tpara poco UFSC-15\t................. 68\n2.19\tpwf = f (qinj) para poco\n2.20\tpwf = f(qinj) para poco\n2.21\tpwf = f(qinj) para poco\n2.22\tpwf = f(qinj) para poco\n2.23\tpwf = f(qinj) para poco\nUFSC-17 ............... 70\nUFSC-20 ............... 71\nUFSC-21 ............... 73\nUFSC-23 ............... 74\nUFSC-75 ............... 76\n2.24\tpwf = f (qinj) para poco exemplo com Pr = 11.0 MPa 77\n2.25\tEstrutura do Modelo dinamico baseado em Hammerstein 79\n2.26\tPar\u00e2metros identificados................................. 80\n3.1\tEstrutura de Controle com Agentes......................... 86\n3.2\tDiagrama esquem\u00e1tico da coluna de destila\u00e7\u00e3o.............. 95\n3.3\tControle via agentes...................................... 97\n3.4\tResposta com DMC distribu\u00eddo.............................. 98\n3.5\tResposta com DMC centralizado............................. 99\n3.6\tCompara\u00e7\u00e3o entre o numero de itera\u00e7\u00e3es e o erro de\nseguimento de refer\u00e2ncia..................................100\n3.7\tResposta do MPC Distribu\u00e1do com restricao Au1 &lt;0.05 107\n3.8\tResposta do MPC Centralizado com restricao Au1 &lt;0.05108\n3.9\tResposta do MPC Distribu\u00eddo com restri\u00e7\u00e3o Au1 > -0.05109\n3.10\tResposta do MPC Centralizado com restri\u00e7ao Au1 >\n-0.05 ................................................... 110\n3.11\tResposta do MPC Distribu\u00eddo com restri\u00e7ao u1 &lt;0.35 . 112\n3.12\tResposta do MPC Centralizado com restri\u00e7ao u1 &lt;0.35 113\n3.13\tResposta utilizando MPC centralizado com restri\u00e7\u00e3o em\ny2, y2 &lt;0.26\t.......................................118\n3.14\tResposta utilizando MPC distribu\u00eddo com 35 trocas de\ninformac\u00e3o e restric\u00e3o em y2, y2 &lt;0.26 ..............118\n3.15\tResposta com MPC distribu\u00eddo com 50 trocas de informa\u00e7\u00e3o e restri\u00e7\u00e3o em y2, y2 &lt;0.26.....................119\n4.1\tResultados\tde seguimento\tde\trefer\u00e2ncia\tcom PNMPC .\t.\t139\n4.2\tResultados\tde seguimento\tde\trefer\u00e2ncia\tcom NEPSAC\t.\t139\n4.3\tResultados\tde seguimento\tde\trefer\u00e2ncia\tcom PNMPC .\t.\t140\n4.4\tResultados\tde seguimento\tde\trefer\u00e2ncia\tcom NEPSAC\t.\t140\n4.5\tDiagrama de Blocos para o tratamento de erro de modelagem e ru\u00eddo ....................................... 142\n4.6\tResposta\t'\tperturba\u00e7\u00e3o na\tsa\u00edda................145\n4.7\tResposta\t'\tperturba\u00e7\u00e3o na\tsa\u00edda\tcom ru\u00eddo e\ta =\t0\t.\t.\t.\t146\n4.8\tResposta\ta\tperturba\u00e7\u00e3o na\tsa\u00edda\tcom ru\u00eddo e\ta =\t0.7\t.\t.\t147\n4.9\tPlanta com\t6 Tanques Esf\u00edricos .........................150\n4.10\tRespostas em Malha Aberta................................152\n4.11\tRespostas de h3 e h6 em Malha Fechada...............152\n4.12\tA\u00e7\u00e3o de Controle em Malha Fechada...................153\n4.13\tRespostas de h1, h2, h4 e h5 em Malha Fechada .... 154\n4.14\tCompara\u00e7\u00e3o entre as predi\u00e7\u00f5es com o modelo e com o\nalgoritmo PNMPC em T=40.05 min.......................154\n4.15\tInterpreta\u00e7\u00e3o gr\u00e1fica do gradiente ponderado........156\n4.16\tCompara\u00e7\u00e3o entre predicao com modelo nao linear e mo-\ndelo linearizado com Gradiente Ponderado.............158\n4.17\tCompara\u00e7ao entre predi\u00e7\u00e3o com modelo n\u00e3o linear e mo-\ndelo linearizado com Gradiente Ponderado Simplificado 158\n4.18\tRela\u00e7\u00e3o entre cB e u em Regime Permanente (Curva de\nequil\u00edbrios do sistema)..............................160\n4.19\tRespostas em malha aberta...........................161\n4.20\tControle de cb com PNMPC............................163\n4.21\tControle de cb com PNMPC-Controle de erros .........163\n4.22\tCompara\u00e7\u00e3o entre Predi\u00e7\u00e3o com o modelo e com PNMPC164\n4.23\tTeste de Seguimento de Refer\u00eancia em torno de P1 ... 165\n4.24\tTeste de Seguimento de Refer\u00eancia em torno de P1 para\nuss &lt;15\t.........................................167\n4.25\tSimula\u00e7ao para erro de atraso =5....................174\n4.26\tSimula\u00e7\u00e3o sem erro no atraso........................175\n4.27\tDerivada da fun\u00e7ao de Lyapunov para erro de atraso=5 176\n4.28\tDesempenho do metodo com algoritmo iterativo .... 177\n4.29\tSistema de aquecimento de \u00e1gua em linha.............178\n4.30\tAplicac\u00e3o de PNMPC nao robusto......................184\n4.31\tAplicacao de PNMPC nao robusto com a2 = 0, 2 . . . . 185\n4.32\tAplicac\u00e7\u00e3ao de PNMPC robusto ...................... 187\n4.33\tAplica\u00e7\u00e3o de PNMPC robusto-vari\u00e1veis auxiliares .... 188\n4.34\tResposta com aplica\u00e7c\u00e3ao da t\u00e1ecnica robusta ...... 190\n4.35\tVari\u00e1veis auxiliares obtidas com a simulacao........190\n4.36\tDesempenho do algoritmo com diferentes pesos P .... 191\n4.37\tResultado da simulac\u00e3o sem aplicacao da t\u00e9cnica robusta 193\n4.38\tVariaveis auxiliares na simula\u00e7\u00e3o sem a t\u00e9cnica robusta 193\n5.1\tEstrat\u00e9gia de Controle Dynacon.......................202\n5.2\tGas lift manifold.....................................209\n5.3\tControle da pressao no Gas Lift Manifold - GLM .... 210\n5.4\tEstrat\u00e9gia de controle da pressao no GLM..............212\n5.5\tModelo simplificado do gas-lift manifold..............213\n5.6\tEstrutura de controle simplificada da press\u00e3o do gas-lift\nmanifold ............................................ 214\n5.7\tEstrutura de controle para an\u00e9lise da resposta a pertur-\nba\u00e7\u00e3o ................................................215\n5.8\tPerturba\u00e7\u00e3o tipo rampa................................216\n5.9\tEstrutura de controle incluindo din\u00e2mica do choke de\ninjec\u00e3o...............................................218\n5.10\tEstrutura de controle com a\u00e7\u00e3o feed-forward..........218\n5.11\tEfeito da perturba\u00e7\u00e3o rampa na vaz\u00e3o de entrada sobre\na pressa\u00e3o do gas-lift manifold ..................... 223\n5.12\tEfeito da perturba\u00e7\u00e3o rampa na vazao de entrada so-\nbre a press\u00e3ao do gas-lift manifold utilizando ac\u00e7\u00e3ao feedforward ............................................. 223\n5.13\tDiagrama de Nyquist mostrando o conceito de pico de\nsensibilidade ....................................... 225\n5.14\tResultados do projeto do PI Robusto utilizando Margem\nde Ganho=2............................................225\n5.15\tResultados do projeto do PI Robusto utilizando Pico de\nsensibilidade igual a 3.2 ........................... 226\n5.16\tSistema de Controle de Po\u00e7os alimentados por um man-\nifold comum ......................................... 228\n5.17\tEstrutura do Controlador PC2.........................230\n5.18\tCarta de alocac\u00e3o de gas-lift .......................231\n5.19\tVaz\u00e3o m\u00e9ssica de g\u00e9s entrando e saindo do GLM........232\n5.20\tPress\u00e3o no GLM com controle utilizando a\u00e7ao Feed For-\nward ................................................ 233\n5.21\tPress\u00e3o no GLM com controle nao utilizando a\u00e7ao Feed\nForward...............................................234\n5.22\tPwf de todos os pocos................................235\n5.23\tPorcentagem de g\u00e9as utilizada\tpor cada po\u00e7co ....... 235\n5.24\tProdu\u00e7ca\u00e3o de \u00e9oleo por po\u00e7co ...................... 236\n5.25\tGas-lift manifold-GLM .............................. 238\n5.26\tVaz\u00e3ao de g\u00e9as normalizada entrando no GLM ......... 249\n5.27\tPressao no GLM e no fundo dos po\u00e7os x vaz\u00e3es saindo\ndo GLM ............................................. 250\n5.28\tVaz\u00e3o de\tprodu\u00e7ao\tde \u00edleo de todos os po\u00e7os........251\n5.29\tVaz\u00e3o de\tprodu\u00e7ao\tde \u00edleo de cada po\u00e7o.............251\n6.1\tInstala\u00e7\u00e3o do riser\tsimulado no OLGA.................256\n6.2\tAbertura\tdo choke\tcomo par\u00e2metro de bifurca\u00e7ao - Um\nciclo limite est\u00edvel desenvolve-se a partir de uma Bifur-cac\u00e3o Hopf Supercr\u00edtica (HBsup)......................257\n6.3\tDiagrama de bifurca\u00e7ao no plano\tPi) ............258\n6.4\tDiagrama de Bifurca\u00e7ao no plano (Pl, P2).............258\n6.5\tResposta do sistema controlado pelo PI para pertur-bac\u00e3es na vazao de entrada (5Kg.s-1 para 3.5Kg.s-1) . 260\n6.6\tResposta do sistema controlado pelo PI para pertur-ba\u00e7\u00e3es na vazao de entrada (5Kg.s-1 para 3Kg.s-1) . . 261\n6.7\tBifurca\u00e7c\u00e3ao Grazing-sliding induzida no sistema ... 262\n6.8\tResposta do sistema no tempo com a estrat\u00edegia de controle SMC (Malha aberta e com controle realimentado aplicado). a) abertura do choke; b) estados do sistema . 265\n6.9\tDiagrama de espa\u00e7o de estados no plano (Pl, P2) .... 265\n6.10\tRespostas de controle e sa\u00edda com a lei de controle modificada (6.8) para uma perturba\u00e7\u00e3o na entrada .......267\n6.11\tDiagrama de espa\u00e7co de estados para o sistema com a lei\nde controle modificada (6.8).........................267\n6.12\tResposta de controle e sa\u00eddas do sistema com o slug\nwashout SMC para perturbac\u00e7a\u00e3o na vaz\u00e3ao de entrada do riser .............................................. 270\n6.13\tDiagrama de espac\u00e7o de estados do sistema com slug\nwashout SMC ........................................ 271\nA.1 Diagrama de Blocos do Algoritmo de Controle Preditivo Baseado em Modelo .................................. 284\nLista de Tabelas\n2.1\tVari\u00e1veis e par\u00e2metros utilizados no modelo....... 21\n2.2\tSubscritos utilizados no modelo................... 22\n2.3\tPar\u00e2metros do po\u00e7o de teste....................... 37\n2.4\tPar\u00e2metros utilizados nos testes realizados com o simu-\nlador Marlim...................................... 65\n2.5\tDados do Po\u00e7o UFSC-15............................. 68\n2.6\tPar\u00e2metros identificados para os\tdados do\tPo\u00e7o\tUFSC-15\t68\n2.7\tDados do Po\u00e7o UFSC-17............................. 69\n2.8\tPar\u00e2metros identificados para os\tdados do\tPo\u00e7o\tUFSC-17\t69\n2.9\tDados do Po\u00e7o UFSC-20............................. 71\n2.10\tPar\u00e2metros identificados para os\tdados do\tPoco\tUFSC-20\t71\n2.11\tDados do Po\u00e7o UFSC-21............................ 72\n2.12\tPar\u00e2metros identificados para os\tdados do\tPo\u00e7o\tUFSC-21\t72\n2.13\tDados do Po\u00e7o UFSC-23............................ 74\n2.14\tPar\u00e2metros identificados para os\tdados do\tPo\u00e7o\tUFSC-23\t74\n2.15\tDados do Poco UFSC-75............................ 75\n2.16\tPar\u00e2metros\tidentificados para os dados do Po\u00e7o\tUFSC-75\t76\n2.17\tPar\u00e2metros\tidentificados para os dados do exemplo [1]\t.\t78\n3.1\tPar\u00e2metros\tde sintonia do algoritmo MPC......... 98\n3.2\tPar\u00e2metros\tde sintonia do algoritmo MPC.........104\n4.1\tPar\u00e2metros e vari\u00e1veis do processo................179\n4.2\tPar\u00e2metros do processo de aquecimento.............181\n4.3\tPar\u00e2metros de sintonia do algoritmo PNMPC sem utiliza\u00e7\u00e3o da t\u00e1cnica robusta...........................183\n4.4\tPara\u00eametros de sintonia do algoritmo PNMPC com a uti-\nlizac\u00e7a\u00e3o da t\u00e1ecnica robusta ........................ 186\n4.5\tPar\u00eametros do modelo discreto..........................187\n4.6\tPar\u00eaametros de sintonia do algoritmo PNMPC com a uti-\nlizac\u00e7\u00e3ao da t\u00e1ecnica robusta p/ o controle do reator de oxido de etileno ..................................... 189\n5.1\tNomenclatura...........................................240\n5.2\tDados dos po\u00e7os........................................247\n5.3\tSintonia dos par\u00e2metros do Algoritmo\tPNMPC............248\n6.1\tPar\u00eametros utilizados na simula\u00e7\u00e3o\tdo\triser............256\n6.2\tPar\u00eametros da lei de controle..........................266\nCap\u00edtulo 1\nIntrodu\u00e7\u00e3o\nO ambiente no fundo de po\u00e7os de petr\u00f3leo \u00f3 hostil. Altas press\u00f5es e temperaturas frequentemente combinadas com a presen\u00e7a de fluidos \u00f3cidos sao um desafio para a instala\u00e7\u00e3o de instrumenta\u00e7\u00e3o de fundo de po\u00e7o. Al\u00e9m das condi\u00e7oes do ambiente, h\u00f3 a dificuldade de prover alimenta\u00e7\u00e3o de energia para esses instrumentos e meios de comunica\u00e7\u00e3o com a superf\u00edcie. O desenvolvimento de sensores de press\u00e3o, temperatura, vaz\u00e3o e aceleracao baseados na tecnologia de fibra \u00f3tica permite a utiliza\u00e7\u00e3o de instrumentos que n\u00e3o necessitam de energia el\u00e9trica para seu funcionamento. Tanto os sensores como a transmiss\u00e3o da informa\u00e7\u00e3o funciona com um feixe de luz viajando no interior da fibra e dos sensores. Esta tecnologia permite a aquisic\u00e7a\u00e3o de medi\u00e7co\u00e3es imunes ao ru\u00f3do eletromagn\u00f3etico e oferece seguranca intr\u00ednsica de forma natural. Infelizmente a dificuldade de se fabricar sistemas de conex\u00e3ao e desconex\u00e3ao de fibras-\u00f3oticas em \u00f3aguas profundas tem inibido a utiliza\u00e7ca\u00e3o desta tecnologia neste ambiente.\nN\u00e3o menos importante \u00e9 o desafio tecnol\u00f3gico da medic\u00e3o das vaz\u00e3oes de a\u00f3gua, o\u00f3leo e g\u00f3as em escoamento multifa\u00f3sico com t\u00f3ec-nicas n\u00e3ao intrusivas e com baixa perda de pressa\u00e3o. A ocupa\u00e7c\u00e3ao de um duto pelas fra\u00e7c\u00e3oes de \u00f3agua, \u00f3oleo e g\u00f3as e as velocidades dessas fra\u00e7c\u00e3oes variam conforme o padr\u00e3ao de escoamento, fazendo da medic\u00e7a\u00e3o das vaz\u00e3oes individuais um problema complexo quando se quer garantir passagem plena no duto. V\u00f3lvulas para fundo de poc\u00e7o com acionamento na superf\u00f3cie esta\u00e3o sendo instaladas em novos poc\u00e7os e podem trazer grandes benef\u00f3cios na implementa\u00e7c\u00e3ao\nde estrat\u00e9egias de produc\u00e7\u00e3ao em completac\u00e7\u00e3ao de po\u00e7cos com mu\u00e9lti-plas zonas produtoras. O m\u00e9etodo convencional utilizado para o controle da produ\u00e7c\u00e3ao individual de cada zona exigia em alguns casos a realiza\u00e7c\u00e3ao de perfilagens para a determina\u00e7c\u00e3ao das vaz\u00e3oes produzidas por cada zona seguida de operac\u00e7\u00e3oes corretivas. Essas opera\u00e7co\u00e3es corretivas podiam ser opera\u00e7c\u00e3oes de slik-line para atuar va\u00e9lvulas do tipo sliding-sleeve ou intervenc\u00e7\u00e3ao no poc\u00e7o com sonda para isolamento permanente de uma zona. Mesmo assim as solu\u00e7\u00f5es eram do tipo on-off enquanto atualmente, a disponibilidade de medi\u00e7\u00e3o e atuac\u00e3o permite o controle cont\u00ednuo das vazo\u00e3es produzidas por cada zona produtora do po\u00e7co.\nPo\u00e7os injetores em multiplas zonas podem tambem se beneficiar com o controle em tempo real da vaz\u00e3o de inje\u00e7\u00e3o por zona. Na aus\u00eaencia dessas v\u00e9alvulas perfis de injec\u00e7\u00e3ao tem de ser realizados periodicamente e dependendo da avalia\u00e7ca\u00e3o do perfil de inje\u00e7c\u00e3ao pode se decidir por reequipar o po\u00e7o com novos chokes a fim de estabelecer a distribui\u00e7\u00e3o de inje\u00e7\u00e3o desejada. Isto requer a ope-ra\u00e7c\u00e3ao com sondas com custos proibitivos em ambiente de a\u00e9guas profundas.\nPara completac\u00e7\u00e3oes em \u00e9aguas profundas e especialmente com a cabe\u00e7a do po\u00e7o instalada no fundo do mar (\u00e9rvore de Natal molhada), uma operac\u00e3o para a troca de um instrumento de fundo de po\u00e7co pode significar custos da ordem de at\u00e9e dezenas de milh\u00e3oes de d\u00e9olares. Esta situa\u00e7c\u00e3ao inibiu por muito tempo o desenvolvimento de instrumenta\u00e7c\u00e3ao para fundo de po\u00e7co e possivelmente, foi um dos fatores que influenciou o baixo n\u00e9vel de pesquisa em modelos e t\u00e9ecnicas de controle e automac\u00e7\u00e3ao da produ\u00e7c\u00e3ao, j\u00e9a que para controlar deve-se medir. Felizmente, nos ultimos 10 anos, tem havido um grande desenvolvimento de instrumentos de medi\u00e7c\u00e3ao e atua\u00e7c\u00e3ao para uso no fundo de poc\u00e7os. Paralelamente ao esfor\u00e7co na \u00e9area de instrumentac\u00e7a\u00e3o tem havido avanc\u00e7os no desenvolvimento de t\u00e9ecnicas de controle e automac\u00e7a\u00e3o para a produc\u00e7\u00e3ao de petr\u00e9oleo protagonizados pelas grandes empresas operadoras. As solu\u00e7c\u00e3oes propostas por cada empresa recebem diferentes denomina\u00e7c\u00e3oes tais como Campo Inteligente, Po\u00e7o Inteligente, Gerenciamento Digital e Integrado da Produ\u00e7c\u00e3ao, etc, mas, independente da denomi-na\u00e7c\u00e3ao, consistem na aplicac\u00e7\u00e3ao de t\u00e9ecnicas de controle, automa\u00e7c\u00e3ao e otimizac\u00e7\u00e3ao para o desenvolvimento de um campo de petr\u00e9oleo,\n[2], [3], [4], [5], [6], [7], [8], [9], [10].\nFrequentemente as solu\u00e7c\u00e3oes propostas sa\u00e3o incipientes e utilizam\nheur\u00edsticas nas tomadas de decis\u00f5es frente a falta de modelos representativos dos processos e da ausencia de medic\u00f5o de todas as variaveis necessarias. Em alguns projetos recentes de desenvolvimento de campos de petroleo torna-se evidente que o avan\u00e7o da tecnologia de instrumentac\u00f5o de fundo de po\u00e7o atropelou o desenvolvimento de modelos e algoritmos de controle que n\u00f5ao est\u00f5ao preparados para utilizar as novas medicoes e capacidade de at-ua\u00e7\u00f5o para a melhoria do controle dos processos de explotac\u00f5o. N\u00f5o e incomum nesses casos acontecer a situa\u00e7ao onde as empresas operadoras depararam-se com o problema de ter mais infor-ma\u00e7c\u00f5oes do que podem utilizar. Em algumas instala\u00e7co\u00f5es modernas a quantidade de informac\u00f5o \u00e9 tanta que a dificuldade \u00e9 determinar quais dados armazenar e em que taxa de amostragem. Existe uma percep\u00e7ca\u00f5o de que essas informa\u00e7c\u00f5oes na\u00f5o est\u00f5ao sendo utilizadas em toda sua plenitude. Ha de se observar entretanto que a maioria dos po\u00e7os existentes seguem funcionando com o m\u00ednimo de instrumentac\u00f5o na superf\u00edcie e nenhuma instrumenta\u00e7\u00f5o de fundo de poco. Os custos para a instalacao da instrumenta\u00e7ao nesses po\u00e7os, principalmente em aguas profundas \u00e9 elevad\u00edssimo. Mesmo a instalac\u00f5o de instrumentos de superf\u00edcie pode tornar-se inviavel devido a necessidade de parada da produ\u00e7c\u00f5ao do po\u00e7co, o que exige uma estrategia de agendamento em fun\u00e7c\u00f5ao de uma eventual parada do po\u00e7co para servi\u00e7co de manuten\u00e7c\u00f5ao.\nComo acontece em muitos processos, a explotac\u00f5o de um campo de petroleo n\u00f5o pode ser feita de forma eficiente em malha aberta. No caso do processo de produ\u00e7\u00f5o de petroleo tem-se um incentivo ainda maior para a aplica\u00e7c\u00f5ao de controle pois o processo esta em constante mudan\u00e7ca.\nPor maiores que tenham sido os avan\u00e7os nas tecnicas de modelagem de reservat orios baseados em aquisi\u00e7c\u00f5ao, tratamento e in-terpreta\u00e7\u00f5o de dados de s\u00edsmica, perfilagens, testes de forma\u00e7\u00f5o, etc, na\u00f5o se conhece totalmente o campo de petroleo que se explora. O conhecimento vai se aprimorando na medida em que novos po\u00e7os s\u00f5o perfurados e colocados em produ\u00e7\u00f5o. Ainda assim, seja qual for o modelo considerado, po\u00e7cos sa\u00f5o perfurados e sua opera\u00e7c\u00f5ao tem de ser otima dentro deste cenario. O conceito de malha lenta e r\u00e1pida expressa bem a situa\u00e7\u00f5o [2]. A malha lenta e onde se modela o reservatorio, decide-se pela loca\u00e7c\u00f5ao de novos po\u00e7cos, faz-se an alise de risco de investimentos, etc. A malha r apida e a malha da automa\u00e7c\u00f5ao dos metodos de eleva\u00e7c\u00f5ao artificial, da completa\u00e7c\u00f5ao inteligente, da otimiza\u00e7c\u00f5ao da produ\u00e7c\u00f5ao, etc.\nEspera-se que a troca de informa\u00e7\u00f5es entre as duas malhas seja a chave para uma explota\u00e7\u00f5o otimizada do reservat\u00f3rio. Para isto se faz necess\u00f3rio uma melhoria consider\u00f3vel na conectividade, disponibilidade de informa\u00e7\u00f5es e desenvolvimento de metodologias que possam refinar os modelos dos reservat\u00f3rios em func\u00f5o da entrada de novos dados. As tomadas de decis\u00f5es estar\u00f5o relacionadas principalmente com vaz\u00f5oes de \u00f3agua, \u00f3oleo e g\u00f3as e muito frequentemente em escoamento multif\u00f3sico. O controle de escoamento multifa\u00f3sico pode contribuir, por exemplo, na produ\u00e7c\u00f5ao de petr\u00f3oleo em risers submarinos ou na opera\u00e7c\u00f5ao de po\u00e7cos com el-eva\u00e7ao por inje\u00e7\u00f5o cont\u00ednua de gas (GLC), um dos m\u00e9todos de elevac\u00f5o artificial de petr\u00f3leo mais utilizados no Brasil.\nNa medida em que as novas descobertas de campos petrol\u00f3feros no Brasil se deslocam para longe da costa, como \u00f3e o caso dos campos do pr\u00f3e-sal, fica cada vez mais importante o desenvolvimento de t\u00f3ecnicas de controle e otimiza\u00e7c\u00f5ao que contribuam para o desenvolvimento de um sistema de opera\u00e7c\u00f5ao remota das unidades de produ\u00e7\u00f5o que, na conting\u00eancia de uma falha de comunicac\u00f5o, possa operar a unidade de forma segura, \u00f3tima e aut\u00eanoma por algum tempo. A literatura sobre controle e otimiza\u00e7ca\u00f5o da ope-ra\u00e7c\u00f5ao de po\u00e7cos operando com eleva\u00e7c\u00f5ao via GLC \u00f3e vasta mas os problemas tratados diferem em fun\u00e7c\u00f5ao das caracter\u00f3sticas dos po\u00e7os sendo considerados. No Brasil mais de 70% da produ\u00e7ao de petro\u00f3leo \u00f3e proveniente de a\u00f3guas profundas e realizada com elevac\u00e7\u00f5ao por GLC. Neste ambiente os custos de perfura\u00e7ca\u00f5o, com-pleta\u00e7c\u00f5ao e opera\u00e7c\u00f5ao dos po\u00e7cos \u00f3e muito elevado fazendo com que somente aqueles po\u00e7cos com consider\u00f3avel produ\u00e7ca\u00f5o sejam completados. Todos os esfor\u00e7os s\u00f5o feitos no sentido de garantir que os insumos necess\u00f3arios para a opera\u00e7c\u00f5ao o\u00f3tima dos po\u00e7cos estejam dispon\u00f3veis incluindo a compress\u00f5ao e tratamento de g\u00f3as para uti-liza\u00e7ca\u00f5o nos po\u00e7cos operando via GLC. Os po\u00e7cos atuais n\u00f5ao disp\u00f5oem de choke de produ\u00e7c\u00f5ao com acionamento automa\u00f3tico e somente nos u\u00f3ltimos anos iniciou-se um esfor\u00e7co para instalar chokes de in-jec\u00e7\u00f5ao automa\u00f3ticos nos po\u00e7cos operando via GLC. Nos u\u00f3ltimos dez anos tem havido tamb\u00f3em um esfor\u00e7co na instala\u00e7c\u00f5ao de medidores de pressao e temperatura de fundo de po\u00e7o (Permanent Downhole Gage). Muito mais recentemente tem havido a completa\u00e7\u00f5o de alguns poc\u00e7os com completa\u00e7ca\u00f5o inteligente onde s\u00f5ao instalados medidores de press\u00f5ao, temperatura e vaza\u00f5o al\u00f3em de v\u00f3alvulas com acionamento hidr\u00f3aulico ou el\u00f3etrico a partir da superf\u00f3cie.\nO cen\u00f3ario sobre o qual desenvolve-se este trabalho consiste de\npo\u00e7os com choke de produ\u00e7\u00e3o manual mas com choke de inje\u00e7\u00e3o de g\u00e1s autom\u00e1tico e com medi\u00e7\u00e3o da press\u00e3o e temperatura de fundo.\nEste trabalho procura contribuir em duas \u00e1reas distintas; i) desenvolvimento de modelos para utilizac\u00e3o no controle e otimiza\u00e7\u00e3o de po\u00e7os operando via GLC e ii) desenvolvimento de tecnicas de controle para aplica\u00e7ca\u00e3o em unidades de produc\u00e7a\u00e3o de petr\u00e1oleo.\nCom rela\u00e7ao ' primeira contribui\u00e7\u00e3o procura-se desenvolver modelos fenomenol\u00e1gicos mais simples do que aqueles utilizados por simuladores comerciais para determinar os diferentes comportamentos din\u00e2micos do po\u00e7o em fun\u00e7\u00e3o de suas principais caracter\u00edsticas. Desenvolve-se tamb\u00e1m modelos de regime permanente para utiliza\u00e7c\u00e3ao na otimiza\u00e7ca\u00e3o da distribui\u00e7c\u00e3ao de g\u00e1as dispon\u00e1vel e por u\u00e1ltimo um modelo para utiliza\u00e7c\u00e3ao em controle baseado na representa\u00e7\u00e3o Hammerstein que preserva a rela\u00e7\u00e3o de regime permanente e introduz um comportamento din\u00e2mico aproximado.\nAs contribui\u00e7\u00f5es no desenvolvimento de tecnicas de controle s\u00e3o duas: i) desenvolve-se uma t\u00e1cnica para a aplicac\u00e3o de controle preditivo distribu\u00e1do que permite o tratamento de restric\u00e7\u00e3oes em entradas e sa\u00e1das. A ideia \u00e1e poder implementar o controle de po\u00e7os de forma distribu\u00edda em trabalhos futuros. ii) Propoe-se um algoritmo pr\u00e1atico de controle preditivo baseado em modelo para sistemas n\u00e3o lineares (PNMPC). O algoritmo desenvolvido pode utilizar praticamente qualquer forma de modelo ja\u00e1 que a represen-ta\u00e7c\u00e3ao linearizada das predi\u00e7c\u00e3oes \u00e1e obtida de forma num\u00e1erica. Esta caracter\u00e1stica deve permitir sua utilizac\u00e7\u00e3ao no controle e otimiza-\u00e7c\u00e3ao da explotac\u00e7\u00e3ao de reservat\u00e1orios utilizando simulador de reser-vat\u00e1orio como modelo do processo. A natureza lenta da evolu\u00e7c\u00e3ao das principais vari\u00e1aveis e par\u00e2ametros do reservat\u00e1orio permite tempos de amostragem t\u00e3ao grande como dias ou at\u00e1e meses o que facilitaria a aplica\u00e7c\u00e3ao do algoritmo. O trabalho contribui tamb\u00e1em com a aplica\u00e7c\u00e3ao de t\u00e1ecnicas de controle e otimiza\u00e7c\u00e3ao sobre um sistema constitu\u00eddo de um manifold de gas lift e po\u00e7os operando via injec\u00e3o cont\u00ednua de gas. Uma primeira abordagem mostra a aplica\u00e7c\u00e3ao de controle com o objetivo de otimizar a produ\u00e7c\u00e3ao e estabilizar a press\u00e3o no manifold de gas lift sem atuar na estabi-liza\u00e7ca\u00e3o da dina\u00e2mica dos po\u00e7cos. Uma segunda abordagem apresentada consiste na aplica\u00e7\u00e3o do algoritmo PNMPC a um manifold de gas lift e um grupo de po\u00e7cos com o objetivo de otimizar a produ\u00e7\u00e3o, estabilizar a press\u00e3o no manifold e minimizar as os-\ncila\u00e7\u00f5es na vaz\u00e3o de produ\u00e7\u00e3o no fundo dos po\u00e7os. Para finalizar aplicam-se t\u00e9cnicas de controle de estrutura vari\u00e1vel na produc\u00e3o de petr\u00e9leo e g\u00e1s em um riser submarino com o objetivo de estabilizar a produ\u00e7\u00e3o com o m\u00ednimo de queda de press\u00e3o no choke de superf\u00e9cie.\n1.1\tObjetivos do Trabalho\nO objetivo deste trabalho \u00e9 contribuir com o desenvolvimento de modelos e t\u00e9ecnicas de controle e automac\u00e7\u00e3ao para a eleva\u00e7c\u00e3ao de fluido multif\u00e1sicos. A enfase principal \u00e9 na automa\u00e7\u00e3o e controle de po\u00e7os operando por Inje\u00e7\u00e3o Cont\u00ednua de Gas (GLC) e na es-tabiliza\u00e7c\u00e3ao do escoamento em risers submarinos de produ\u00e7c\u00e3ao.\n1.2\tOrganiza\u00e7\u00e3o do Trabalho\nNo cap\u00edtulo 2 apresenta-se o m\u00e9todo de eleva\u00e7\u00e3o artificial via inje\u00e7\u00e3o cont\u00e9nua de gas, GLC e tr\u00eas diferentes abordagens para a modelagem do processo.\nNo cap\u00e9tulo 3 apresenta-se uma t\u00e9cnica para a aplica\u00e7\u00e3o de controle preditivo baseado em modelo de forma distribu\u00e9da onde existe um agente para cada ac\u00e3o de controle. Esses agentes executam um mesmo tipo de algoritmo cuja instancia\u00e7c\u00e3ao depende dos relacionamentos com os agentes vizinhos o que \u00e9e dependente do tipo de acoplamento existente no processo sendo controlado. As a\u00e7\u00e3es de controle s\u00e3o obtidas depois de um determinado numero de troca de informa\u00e7c\u00e3oes entre os agentes. O sistema desenvolvido \u00e9e capaz de tratar as restri\u00e7co\u00e3es t\u00e9picas como limita\u00e7c\u00e3oes nas vari-a\u00e7c\u00e3oes da a\u00e7ca\u00e3o de controle entre tempos de amostragem, nos valores m\u00e9aximo e m\u00e9nimo das a\u00e7c\u00e3oes de controle e nos valores ma\u00e9ximo e m\u00e9nimo das sa\u00e9das.\nTaylor de segunda ordem. Desenvolve-se ainda um m\u00e9todo para tratar erros de modelagem e ru\u00eddo e uma forma de introduzir a demanda por estabilidade na fun\u00e7\u00e3o objetivo. O metodo e aplicado com sucesso a alguns sistemas apresentados na literatura.\nNo cap\u00edtulo 5 discute-se a aplica\u00e7\u00e3o de tecnicas de controle e otimiza\u00e7\u00e3o da produ\u00e7\u00e3o de pocos operando via GLC. Uma primeira abordagem desconsidera a din\u00e2mica dos po\u00e7os e prop\u00e3e uma tec-nica que estabiliza a press\u00e3o no manifold de gas lift e, utilizando os desenvolvimentos de modelos apresentados no cap\u00edtulo 2 garante a opera\u00e7c\u00e3ao dos po\u00e7cos ocorrendo de forma otima sob uma determinada metrica. Uma segunda abordagem utiliza a modelagem desenvolvida no cap\u00edtulo 2 e aplica a tecnica de controle predi-tivo para sistemas n\u00e3o lineares desenvolvida no cap\u00edtulo 4 a um sistema constitu\u00eddo de um manifold de gas lift e 4 po\u00e7os. O objetivo de controle e estabilizar a press\u00e3o no manifold, minimizar as oscilac\u00e7\u00e3oes na vaz\u00e3ao de produ\u00e7c\u00e3ao do fundo dos po\u00e7cos e otimizar a producao para a vazao de gas dispon\u00edvel.\nNo cap\u00edtulo 6 discute-se o Controle de escoamento em risers submarinos. A eleva\u00e7\u00e3o de flu\u00eddo multifasico em risers submarino pode ser afetada por um fen\u00e2meno conhecido como golfada severa induzida pelo terreno. Este fen\u00e2meno pode acontecer em determinadas geometrias do riser e vaz\u00f5es de l\u00edquido e gas. Para uma determinada geometria de riser consistindo de uma parte horizontal no fundo do mar e de uma parte vertical ou inclinada, pode acontecer uma acumulac\u00e3o de l\u00edquido na regi\u00e3o de tran-si\u00e7c\u00e3ao horizontal-vertical. Esta acumula\u00e7c\u00e3ao provoca uma restri\u00e7\u00e3o a subida do gas que se acumula aumentando a pressao neste ponto. Quando esta press\u00e3o atinge um determinado valor o gas acumulado desloca o fluido a jusante e o riser e dominado por gas baixando a press\u00e3o de fundo. O l\u00edquido come\u00e7a novamente a se acumular e um novo processo se inicia. Na superf\u00edcie tem-se a produ\u00e7c\u00e3ao na forma de golfadas alternadas dominadas por liquido ou gas. Este tipo de escoamento prejudica o processo de separac\u00e7\u00e3ao alem de contribuir para a fadiga do proprio riser. O trabalho prop\u00e3oe algumas tecnicas de controle para estabilizar o escoamento.\nIntrodu\u00e7\u00e3o\n8\nCap\u00edtulo 2\nEleva\u00e7\u00e3o Artificial via Inje\u00e7\u00e3o Cont\u00ednua de G\u00e1s\nEste cap\u00edtulo apresenta o processo de produ\u00e7\u00e3o de petr\u00f3leo utilizando Eleva\u00e7\u00e3o Artificial do Tipo Inje\u00e7\u00e3o Cont\u00ednua de Gas (GLC). Faz uma revis\u00e3o bibliogr\u00f3fica sobre os trabalhos na area de modelagem do processo, apresenta algumas abordagens para a modelagem do processo e apresenta compara\u00e7co\u00e3es com resultados obtidos com o software OLGA2000MR.\nEleva\u00e7\u00e3o Artificial \u00e9 a denominac\u00e3o para as t\u00f3cnicas que auxiliam a eleva\u00e7ao de fluido do interior de po\u00e7os de petr\u00f3leo. A Eleva\u00e7c\u00e3ao Artificial \u00ede normalmente adotada quando a press\u00e3ao do reservat\u00f3orio na\u00e3o \u00f3e mais suficiente para elevar o fluido produzido pela forma\u00e7ao at\u00f3 a superf\u00edcie. Entretanto estrat\u00f3gias modernas de explota\u00e7c\u00e3ao podem empregar m\u00f3etodos de eleva\u00e7c\u00e3ao artificial antes que este est\u00f3agio de depleta\u00e7c\u00e3ao do reservato\u00f3rio seja al-can\u00e7cado. Existem diversos m\u00f3etodos de eleva\u00e7c\u00e3ao artificial sendo que os mais comuns s\u00e3o:\n\u2014\tBombeio Mec\u00e2nico com Bomba de Haste Flex\u00edvel (BM)\n\u2014\tBombeio Mecanico com Bomba de Cavidade Progressiva (BCP)\n\u2014\tBombeio com Bomba El\u00e9trica Centr\u00edfuga Submersa (BCS)\n\u2014\tInjecao Cont\u00f3nua de Gas (GLC)\n\u2014 Injecao Intermitente de G\u00eds (GLI)\nA maioria desses m\u00edtodos s\u00e3o apresentados em [11]. Nesta tese abordaremos somente a eleva\u00e7ao por inje\u00e7\u00e3o cont\u00ednua de g\u00eds, GLC.\n2.1\tO Processo de Eleva\u00e7\u00e3o por Inje\u00e7\u00e3o Cont\u00ednua de G\u00e1s - GLC\nA Elevac\u00e3o por Inje\u00e7ao Cont\u00ednua de G\u00eds (GLC) ou gas lift utiliza a injec\u00e3o de gas em um ponto mais baixo da coluna de pro-du\u00e7ao de forma que a mistura g\u00eds-l\u00edquido presente na coluna de produ\u00e7c\u00e3ao exer\u00e7ca um press\u00e3ao na frente dos canhoneados inferior \u00e0 pressao do reservat\u00edrio. Desta forma a mistura g\u00eds-l\u00edquido \u00ed produzida na superf\u00edcie e direcionada a um separador \u00edgua-\u00edleo-g\u00edas. O g\u00edas produzido (ou parte do ga\u00eds dependendo do po\u00e7co) \u00ede tratado e recomprimido para reutiliza\u00e7c\u00e3ao no processo de el-eva\u00e7ao. A figura 2.1 mostra o princ\u00edpio de funcionamento do m\u00edetodo de Eleva\u00e7c\u00e3ao por GLC. A vaz\u00e3ao de g\u00edas injetado, controlada pela V\u00edlvula de Inje\u00e7\u00e3o de G\u00eds na superf\u00edcie, desce pelo espa\u00e7co anular revestimento-tubo de produ\u00e7ca\u00e3o e entra no tubo de produ\u00e7\u00e3o pela v\u00edlvula operadora de gas lift tipicamente alojada em um tubo especial chamado mandril de gas lift. Depois de passar pela v\u00edalvula de gas lift o g\u00edas sobe no interior do tubo de produ\u00e7c\u00e3ao e ao gaseificar o l\u00edquido no seu interior diminui a press\u00e3ao exercida na frente dos canhoneados. A diferen\u00e7ca de pressa\u00e3o entre a pressa\u00e3o de formac\u00e7\u00e3ao e a press\u00e3ao exercida pelo peso da coluna de l\u00edquido gaseificado permite a produ\u00e7c\u00e3ao da mistura. Os poc\u00e7os completados para operac\u00e7\u00e3ao com injec\u00e7\u00e3ao cont\u00ednua de g\u00edas s\u00e3ao em geral equipados com uma s\u00ederie de v\u00edalvulas de gas lift distribu\u00eddas ao longo da coluna de produc\u00e7\u00e3ao. Exceto pela v\u00edalvula localizada no fundo, as demais va\u00edlvulas s\u00e3ao utilizadas para a partida do po\u00e7co ou kick-off. Estas v\u00edlvulas permitem que o tubo de produ\u00e7\u00e3o seja gaseificado sequencialmente atrav\u00edes da abertura sequencial das va\u00edlvulas de cima para baixo. No final do processo de partida a u\u00ednica v\u00edalvula que permite a entrada de g\u00edas no interior do tubo de produ\u00e7c\u00e3ao \u00ede a v\u00edalvula localizada mais profundamente tamb\u00edem conhecida como v\u00edalvula operadora. Al\u00edem da v\u00edalvula operadora, uma v\u00edlvula de controle da injec\u00e3o de g\u00eds e um choke instalados na linha de injec\u00e7\u00e3ao e produ\u00e7c\u00e3ao respectivamente s\u00e3ao tamb\u00edem parte\nFigura 2.1: Eleva\u00e7\u00e3o por Inje\u00e7\u00e3o Cont\u00ednua de G\u00e1s\ndo sistema de controle do po\u00e7o. As v\u00e9lvulas de gas lift s\u00e3o con-struc\u00e3es mecanicas normalmente instaladas dentro de um tubo de produc\u00e3o especial chamado mandril de gas lift. Na maioria dos casos estas v\u00e9alvulas sa\u00e3o projetadas de forma a permitirem sua retirada do mandril de gas lift para manutenc\u00e7\u00e3ao atrav\u00e9es de uma opera\u00e7c\u00e3ao de slick line.\nDevido ao custo muito alto na interven\u00e7ca\u00e3o dos poc\u00e7os completados com cabe\u00e7ca de po\u00e7co instaladas no fundo do mar, alguns poc\u00e7os s\u00e3ao equipados sem as v\u00e9alvulas de descarga ja\u00e9 que estas poderiam falhar. Nestes casos a unica v\u00e9lvula presente \u00e9 a v\u00e9lvula operadora.\nFigura 2.2: Curva T\u00f3pica da Vaz\u00f5o de L\u00f3quido e Press\u00f5o na frente dos Canhoneados x Vazao M\u00f3ssica de G\u00f3s de Inje\u00e7\u00f5o\ndo efeito da gravidade na queda de pressa\u00f5o no tubo de produ\u00e7c\u00f5ao. Conforme a vaza\u00f5o de injec\u00e7\u00f5ao de g\u00f3as aumenta, cresce a queda de press\u00f5ao no tubo de produ\u00e7c\u00f5ao devido ao atrito e a inclina\u00e7ca\u00f5o da curva diminui at\u00f3 atingir-se o ponto P\\. Neste ponto qualquer aumento na vaza\u00f5o do ga\u00f3s injetado causara\u00f3 um aumento na queda de press\u00f5ao devido ao atrito maior do que o decr\u00f3escimo devido a diminuic\u00e7\u00f5ao do peso da mistura ga\u00f3s-l\u00f3quido resultante. O gra\u00f3fico da pressao (Pwf = g(Qi)) na frente da zona canhoneada exibe uma curva que \u00f3e quase uma imagem espelho da curva da vaz\u00f5ao de l\u00f3quido produzido com o m\u00f3nimo ocorrendo para o mesmo valor da vaza\u00f5o de inje\u00e7c\u00f5ao de g\u00f3as. O controle de um po\u00e7co operando via Inje\u00e7c\u00f5ao Cont\u00f3nua de Ga\u00f3s \u00f3e normalmente realizado de acordo com uma estrat\u00f3egia de otimiza\u00e7c\u00f5ao. Embora o g\u00f3as utilizado para a inje\u00e7c\u00f5ao na\u00f5o seja perdido, existe um custo para sua compress\u00f5ao desde a press\u00f5ao do separador at\u00f3e a press\u00f5ao de inje\u00e7c\u00f5ao. As fra\u00e7c\u00f5oes de \u00f3oleo, \u00f3agua e g\u00f3as produzidas por cada po\u00e7co tem diferente impacto econ\u00eaomico no processo de produc\u00e7\u00f5ao. A \u00f3agua produzida \u00f3e normalmente tratada antes do descarte, o g\u00f3as e o \u00f3oleo produzido pela forma\u00e7c\u00f5ao tem diferentes valores de mercado. Os recursos dispon\u00f3veis podem tamb\u00f3em impor restric\u00e7\u00f5oes como limites na ca\npacidade de separa\u00e7\u00e3o, transporte e compress\u00e3o e ter\u00e3o um impacto na distribui\u00e7\u00e3o de g\u00e1s comprimido para um grupo de po\u00e7os. Diversos trabalhos tem tratado este problema com diferentes t\u00e1c-nicas de otimiza\u00e7\u00e3o como em [12], [13], [14], [15] e [16]. Do ponto de vista do controle estas t\u00e1ecnicas visam a opera\u00e7ca\u00e3o do po\u00e7co dentro de uma regiao definida da curva Qnq. = f (Qinj) denominada de Regiao de Interesse Econ\u00f4mico. As considera\u00e7\u00e3es feitas dizem respeito ao comportamento esta\u00e1tico do sistema. Do ponto de vista din\u00f4amico diversos aspectos devem ser analisados.\nA vaz\u00e3o de um po\u00e7o operando por GLC pode tornar-se bastante oscilat\u00f3ria ao mudar-se a vaz\u00e3o de injec\u00e3o de g\u00e1s ou quando ocorrem mudan\u00e7cas na press\u00e3ao da cabec\u00e7a do po\u00e7co devido a pertur-ba\u00e7co\u00e3es causadas pelos processos a jusante do poc\u00e7o. Este comportamento oscilat\u00e1orio \u00e1e mais forte quando a queda de press\u00e3ao no Tubo de Produ\u00e7\u00e3o \u00e9 dominada pelo termo devido a gravidade e tende a diminuir quando o termo devido ao atrito torna-se com-paravel. Isto explica a raz\u00e3o para os operadores aumentarem a vaz\u00e3ao de inje\u00e7c\u00e3ao de gas como um ultimo recurso para estabilizar um po\u00e7o operando por GLC. Na maioria dos casos esta solu\u00e7\u00e3o n\u00e3ao e otima. Ao contrario, dependendo da disponibilidade de gas comprimido, da produ\u00e7ca\u00e3o do poc\u00e7o, dos custos envolvidos, o ponto de opera\u00e7\u00e3o otimo pode situar-se bem a esquerda do ponto Pi da figura 2.2. Alem disso a opera\u00e7ao dos po\u00e7os com oscila\u00e7\u00f5es sustentadas reduz a produ\u00e7ca\u00e3o dos poc\u00e7os em rela\u00e7c\u00e3ao a operac\u00e7\u00e3ao sem oscilac\u00f5es. Sem mencionar os problemas causados pelas oscila\u00e7\u00f5es nos processos de separac\u00e7\u00e3ao. Isto justifica um estudo de modelos din\u00f4amicos que permitam realizar um controle mais eficiente sistema aumentando a produtividade e diminuindo as oscilac\u00e7\u00e3oes.\nA modelagem do processo de eleva\u00e7c\u00e3ao por GLC apresenta diversas dificuldades. A principal e o fato de que o fen\u00f4omeno de transporte de fluido multifasico so pode ser descrito com rigor por um conjunto de equa\u00e7c\u00e3oes diferenciais parciais e algebricas para fra\u00e7c\u00e3oes muito pequenas do tubo onde ocorre o escoamento, vide [17] e [18]. Existem diversos estudos para descrever os diferentes padr\u00e3oes de escoamentos como tipo bolhas, misturado, golfada, anular, etc., que podem ocorrer na eleva\u00e7ao por GLC conforme [19]. Em geral busca-se determinar em que condi\u00e7c\u00e3oes se desenvolvem esses tipos de escoamento e quando ocorre a mudanc\u00e7a de um tipo de escoamento para outro, o que torna a descri\u00e7ca\u00e3o do processo ainda mais complexa.\nA aplica\u00e7\u00e3o da mec\u00f4nica classica juntamente com estudos experi\nmentais sobre as condi\u00e7\u00f5es para o forma\u00e7\u00e3o dos diferentes padr\u00f5es de escoamentos tem sido utilizada para o desenvolvimento de simuladores para processos que envolvem escoamentos multif\u00e1sicos incluindo a eleva\u00e7\u00f5o por GLC, vide [20].\nUma dificuldade adicional para a modelagem do processo de el-eva\u00e7c\u00f5ao por GLC \u00e1e a indisponibilidade da medic\u00e7\u00f5ao das principais vari\u00e1veis do processo como as vaz\u00f5es dos diferentes fluidos em determinados pontos do processo.\n2.2\tModelagem do Processo de Eleva\u00e7\u00e3o por Inje\u00e7ao Cont\u00ednua de G\u00e1s\nDiversos trabalhos sobre a modelagem e controle de po\u00e7os operando por GLC tem sido publicados nos ultimos anos [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]. Em [21] discute-se o comportamento din\u00e2mico obtido com um simulador do processo de elevac\u00f5o por GLC que contempla o fen\u00e2meno heading.\nEm [24] e [31] obt\u00e1m-se um modelo simplificado, a par\u00e2metros concentrados, do sistema de eleva\u00e7c\u00f5ao por GLC utilizando-se equa\u00e7c\u00f5oes de conservac\u00e7\u00f5ao de massa nos diferentes compartimentos do po\u00e7co. O modelo proposto \u00e9 representado por\nx 1 = -Wgc(x) + Wiv (x,U1)\t(2.1)\nx2\twiv(x) wpg (x, u2)\nX3\t= Wr (x) - WpO(x, U2 )\nonde\nx1 = Massa de g\u00e1s no anular\nx2 = Massa de gas no Tubo de Produ\u00e7ao\nx3 = Massa de \u00e1leo no Tubo de Produ\u00e7ao\nwgc = Vazao de gas atrav\u00e1s da valvula operadora de gas lift\nwiv = Vazao de gas atraves da valvula de inje\u00e7\u00f5o wpg = Vaz\u00f5o de gas atrav\u00e9s do choke de produ\u00e7ao wpo = Vaz\u00f5o de oleo atrav\u00e1s do choke de produ\u00e7\u00f5o wr (x) = Influxo de oleo do reservat\u00f3rio u1 = Abertura da valvula de Injec\u00f5o de Gas u2 = Abertura do choke de producao.\nOs problemas com este modelo s\u00e3ao diversos. A massa total nos compartimentos n\u00e3ao pode ser medida. O modelo n\u00e3ao leva em conta a componente devido ao atrito no c\u00e9alculo da press\u00e3ao de fundo. Al\u00e9em disso os estados na\u00e3o apresentam uma rela\u00e7c\u00e3ao direta com as vari\u00e9aveis comumente medidas na pr\u00e9atica que s\u00e3ao as press\u00f5es na superf\u00edcie e de fundo em alguns casos. Apesar disso o modelo \u00e9e interessante pela simplicidade e parece um candidato natural para o sistema.\nOs trabalhos [25], [26], [27], contribuic\u00e3es do autor desta tese, s\u00e3ao propostas onde o controle da din\u00eaamica do po\u00e7co \u00e9e realizado somente com a manipulac\u00e3o da vaz\u00e3o de inje\u00e7\u00e3o de gas. Supoe-se que a produc\u00e7\u00e3ao \u00e9e entregue a um separador mantido a uma press\u00e3ao constante. A proposta n\u00e3ao considera a manipula\u00e7ca\u00e3o do choke de produc\u00e3o de forma deliberada j\u00e9 que na maioria dos po\u00e7os em operac\u00e3o n\u00e3o se dispoe de chokes automatizados. Al\u00e9m disso qualquer queda de press\u00e3o no choke de produc\u00e3o significa aumento da pressa\u00e3o de fundo e diminui\u00e7c\u00e3ao da produ\u00e7c\u00e3ao.\nDiversos modelos lineares relacionando a vaz\u00e3o massica na cabe\u00e7a do po\u00e7co com a vaz\u00e3ao m\u00e9assica de g\u00e9as injetado sa\u00e3o obtidos em diferentes pontos de operacao do sistema. Utilizando estes modelos projeta-se um controlador robusto para o controle do processo dentro da regi\u00e3ao de interesse econ\u00eaomico. Infelizmente, por razo\u00e3es de seu alto custo, a medic\u00e7\u00e3ao da vaza\u00e3o m\u00e9assica na cabe\u00e7ca do po\u00e7co ainda na\u00e3o \u00e9e utilizada inviabilizando a implementa\u00e7c\u00e3ao desta t\u00e9ec-nica com a tecnologia de medic\u00e7\u00e3ao de escoamento multif\u00e9asico atual. Em [28] apresenta-se uma proposta de modelagem do processo muito interessante e inovadora. Define-se as constantes:\nR = Constante do G\u00e9s Ideal\nT = Temperatura do po\u00e7o\nPI = \u00edndice de Produtividade do Poco\nPr = Pressao do Reservat\u00f3rio\nPo = Press\u00e3o do Separador\ng = Acelera\u00e7ao devido a gravidade\nL = Comprimento do Tubo de Produ\u00e7\u00e3o.\nDefinem-se as variaveis:\nz = Dist\u00eancia vertical medida da superf\u00edcie em direc\u00e3o ao fundo do poc\u00e7o.\nrk(t, z) = Frac\u00e3o volum\u00f3trica de gas, se k = g ou l\u00edquido, se k = l.\nx(t, z) = Fra\u00e7\u00e3o m\u00f3ssica de g\u00f3s.\nP(t, z) = Press\u00e3o em algum ponto no interior do po\u00e7o. xL(t) = Fra\u00e7\u00e3o massica de gas em z = L.\nPL(t) = Pressao em z = L.\npk (t, z) = Densidade do g\u00f3s, se k = g ou do l\u00f3quido, se k = l.\npm = Densidade da mistura l\u00f3quido e gas.\nqk (t, z) = Fluxo m\u00f3ssico de l\u00f3quido, se k = l ou g\u00f3s se k = g.\nVk = Velocidade do l\u00f3quido, se k = l ou do g\u00f3s, se k = g.\nModela-se a press\u00e3o de fundo (na frente dos canhoneados) como\nP (t,z)= Po +\tpm(t,C )gdZ-\t(2.2)\n\u25a0Jo\nAssume-se\nPm = xpg + (1 - x)pi,\t(2.3)\npm\tpl + x(pg\tpl)-\nAssume-se tambem que a temperatura T seja constante, o gradiente de press\u00e3o constante igual a PrLPo e o comportamento ideal do g\u00f3s frente a Press\u00e3o e Temperatura. Substituindo (2.3) em (2.2)\nP(t, z) = Po + pigz +\tx(t, z)g(p(z) - pi(2.4)\nJo\nP(k z) = Po + pigz +\tx(t, Q)g((L\u2014\u2018LpT+ ^Pr - pi)dZ'\ndp + d (pv)\ndt dz\npode-se escrever para a fra\u00e7\u00e3o de g\u00e1s e l\u00edquido (considerando n\u00e3o existir troca de massa entre as fases),\nd(Pgrg) , d(PgrgVg) = 0 dt + dz\t\u2019\nd(Piri) , d(PiriVi) = 0 dt + dz\n(2.6)\nDefine-se a fra\u00e7\u00e3o m\u00e1ssica de g\u00e1s x como\nrg Pg rg Pg + ri Pi\n(2.7)\ne adota-se um modelo de relacionamento entre Vg e Vl, onde V-x_ e a velocidade que adquire uma bolha de g\u00e1s em uma coluna de l\u00edquido,\nVg - Vi = V^.\t(2.8)\nri\nPode-se combinar as equa\u00e7\u00e3es (2.6), (2.7) e (2.8) para obter\ndx ,. dx\n+ Vg d~z =0\n(2.9)\nOs autores prop\u00e3em a seguinte solu\u00e7ao para a equa\u00e7\u00e3o (2.9)\nT \u2014 z\nx(t,z) = xL(t------v\u2014 )\u2022\t(2.10)\nVg\nO significado da express\u00e3o (2.10) \u00e9 que a fra\u00e7ao de g\u00e1s ao longo do tubo de produ\u00e7c\u00e3ao \u00e1e igual ao valor que ocorreu no fundo do poco 0 = segundos atr\u00e1s. Para z = L, x(t, L) = xL(t).\nA express\u00e3o para P(t, L) dada pela equac\u00e3o (2.4) \u00e1 trabalhada para eliminar a dependencia de z escrevendo-se\nP(t,L) = PL(t) = Po + pigL +\tk(t - T)xL (t)df2.11)\nJt-s\nonde\n\u00f5\nk(t)\nL\nVg g(\ntPo + (\u00f5 \u2014 t)pr \u00f5RT\n\u2014 Pi)\ne\nt e [0, \u00f5].\n(2.12)\nNeste trabalho utiliza-se a o modelo da press\u00e3o de fundo para formular uma lei de controle. A lei de Controle obtida \u00e9 muito similar a um controle Proporcional e depende do calculo de um valor para Xref que depende do valor de Pref. Os resultados obtidos com simula\u00e7\u00e3o s\u00e3o promissores mas o ajuste do controlador nao parece simples alem de n\u00e3o dispor de ac\u00e3o integral e por isso dificilmente garantira erro nulo em regime permanente. Por outro lado o modelo obtido para a press\u00e3o de fundo, apesar de na\u00e3o incorporar o termo devido ao atrito e um resultado interessante.\npL(t) = po + pigL +\t- t)g(tP\u00b0\tt)Pr - pi)Vgdr\npara\nt G [0, S] e S = Vl\t(2.13)\nVg\n2.2.1\tUm modelo fenomenologico a par\u00e2metros concentrados\nNesta se\u00e7c\u00e3ao desenvolve-se um modelo fenomenologico para poc\u00e7os operando por GLC com baixo custo computacional. Utiliza-se o desenvolvimento realizado por [24], [31] e [28] para obter-se um modelo que exibe o comportamento din\u00e2mico do po\u00e7o para toda a faixa de vazao de injec\u00e3o. Diferentemente dos trabalhos citados, considera-se aqui o atrito no tubo de produ\u00e7\u00e3o. Existem dois fen\u00e2omenos que geram instabilidade em po\u00e7cos operando com gas lift. O fen\u00e2meno mais conhecido \u00e9 o heading que resulta da interac\u00e7\u00e3ao entre o escoamento no espac\u00e7o anular e no tubo de produ\u00e7\u00e3o quando a valvula operadora de gas lift opera em regime n\u00e3o\ncr\u00edtico. Escoamento cr\u00edtico \u00ede aquele onde a velocidade do fluido \u00ede superior a velocidade da propaga\u00e7c\u00e3ao do som nas condi\u00e7c\u00e3oes do escoamento. Mantida essa condi\u00e7\u00e3o, as perturba\u00e7oes na press\u00e3o em um ponto do escoamento n\u00e3ao se propagam na dire\u00e7ca\u00e3o contra\u00edria a direc\u00e7\u00e3ao do escoamento e a vaza\u00e3o depende somente da press\u00e3ao a montante. O escoamento de g\u00edas atrav\u00edes de um orif\u00edcio passa a ser cr\u00edtico quando a raz\u00e3ao entre a press\u00e3ao a juzante do orif\u00edcio e a press\u00e3o a montante do orif\u00edcio \u00ed menor que rcrit,\nk\n(2\t\\ k-1\tc\nrcrit =\u00ed k+1)\t\u2019 onde k = -p.\t(2.14)\nNa equac\u00e3o 2.14 cp e cv s\u00e3o respectivamente o calor espec\u00edfico do g\u00edas a pressa\u00e3o constante e a volume constante. Para metano e etano o valor de k \u00ed respectivamente 1, 31 e 1, 20. Para os gases utilizados no processo de elevac\u00e3o do tipo GLC rcrit tem um valor da ordem de 0, 55. Na pratica se diz que o escoamento \u00e9 cr\u00edtico quando a pressa\u00e3o a jusante \u00ede igual ou menor do que a metade da pressa\u00e3o a montante embora isto seja uma aproximac\u00e7\u00e3ao.\nO escoamento em v\u00edalvulas operadoras de gas lift do tipo orif\u00edcio ira\u00ed apresentar escoamento cr\u00edtico se a raz\u00e3ao entre a press\u00e3ao no tubo de produ\u00e7c\u00e3ao a jusante da v\u00edalvula e a pressa\u00e3o no anular a montante da v\u00edlvula for menor que rcrit. Neste caso n\u00e3o haver\u00ed o fen\u00eameno heading pois elimina-se a intera\u00e7\u00e3o entre o escoamento no tubo de produ\u00e7c\u00e3ao e o escoamento no espa\u00e7co anular.\nManter um escoamento onde a press\u00e3ao a montante seja aproximadamente o dobro da press\u00e3ao a jusante torna-se custoso pois a demanda de pot\u00eaencia depende do produto entre a press\u00e3ao e vaz\u00e3ao. Al\u00edem disso existem problemas t\u00edecnicos relacionados com a alta press\u00e3ao a que se submetera\u00e3o os equipamentos do po\u00e7co.\nO desenvolvimento de v\u00edalvulas operadoras do tipo Venturi permitiu escoamento supers\u00eaonico com perda de press\u00e3ao muito baixa. Existem v\u00edalvulas no mercado que fornecem escoamento cr\u00edtico com press\u00e3o a montante apenas 10% maiores do que a press\u00e3o a jusante da va\u00edlvula. Apesar da utiliza\u00e7ca\u00e3o de v\u00edalvulas operadoras de gas lift do tipo Venturi observou-se ainda fen\u00eaomenos os-cilat\u00edorios em determinados po\u00e7cos e em certas condi\u00e7c\u00e3oes de opera\u00e7\u00e3o. Estas oscila\u00e7\u00f5es se devem ao fen\u00eameno denominado densitywave. Neste fen\u00f4meno, mesmo com a vazao m\u00edssica de g\u00eds constante na sa\u00edda da v\u00edalvula operadora, desencadeia-se uma os-\nFigura 2.3: Po\u00e7o operando com Gas-lift\ncila\u00e7c\u00e3ao na press\u00e3ao de fundo.\nUm esquema de um po\u00e7o operando por eleva\u00e7ao tipo GLC \u00e9 apresentado na figura 2.3.\nAs equa\u00e7c\u00e3oes que descrevem o escoamento no tubo de produ\u00e7c\u00e3ao s\u00e3ao obtidas com a aplicac\u00e7\u00e3ao da conservac\u00e7\u00e3ao da massa e da quantidade de movimento, [1]. Estas equa\u00e7\u00f5es descrevem o escoamento em um elemento de tubo dz. Modelando-se tanto o espaco anular como o tubo de produc\u00e7\u00e3ao, o comportamento do reservat\u00e9orio e utilizando-se as equac\u00e3es de estado para os fluidos envolvidos pode-se aplicar t\u00e9ecnicas de integra\u00e7ca\u00e3o para obter-se o comportamento do po\u00e7co.\nApresenta-se na sequ\u00e2encia um modelo simplificado do processo que permita uma an\u00e9alise mais r\u00e9apida do comportamento din\u00e2amico do sistema. O trabalho utiliza algumas das id\u00e9eias desenvolvidas em [32], [24], [31] e [33].\nPara a descri\u00e7ca\u00e3o deste modelo define-se as vari\u00e9aveis e par\u00e2ame-tros apresentados na tabela 2.1 e os subscritos mais utilizados na tabela 2.2.\nTabela 2.1: Vari\u00f3veis e par\u00e2metros utilizados no modelo\nS\u00edmbolo\tdescri\u00e7\u00e3o\nz\tdist\u00e2ncia vertical a partir do fundo\nA\tArea do tubo de produc\u00e3o (TP)\nM.\tMassa de gas ou l\u00edquido\nq.\tVazao massica de gas ou l\u00edquido\nx\tFrac\u00e3o massica de gas\nr\tFracao \u00e1rea do TP ocup. por gas ou l\u00edquido\nw\tVeloc. terminal de uma bolha de gas\nV.\tVeloc. da fracao gas ou l\u00edquido\nUsl = -^A -l A\tVelocidade superficial de l\u00edquido\nu \u2014 -^g Us9\t-gA\tVelocidade superficial de g\u00e1s\np.\tDensidade do gas/l\u00edquido\nf\tFator de atrito\nD\tDi\u00e2ametro do tubo de produ\u00e7c\u00e3ao\nL\tDist\u00e2ancia entre sup. e fundo do po\u00e7co\ng\tAcelerac\u00e7\u00e3ao da gravidade\nM\tPeso molecular do g\u00edas\nZ\tCompressibilidade do g\u00eds\nR\tConstante universal do g\u00eds ideal\nT\tTemperatura\nT.\tTemperatura na cabec\u00e7a ou fundo\nPr\tPressa\u00e3o esta\u00edtica do reservato\u00edrio\npwf\tPress\u00e3ao na frente dos canhoneados\npwh\tPress\u00e3ao na cabec\u00e7a do po\u00e7co\nPs\tPressa\u00e3o no separador\nPI\t\u00edndice de produ\u00e7ao\nC\tConstante do choke de produ\u00e7c\u00e3ao\na\tConstante de tempo\nTabela 2.2: Subscritos utilizados no modelo\nS\u00edmbolo\tdescri\u00e7ao\ng\tga\u00eds\ni\tl\u00edquido\nf\tno fundo do poc\u00e7o\nc\tna cabec\u00e7a do poc\u00e7o\nif\tl\u00edquido no fundo\ngf\tga\u00eds no fundo\nic\tl\u00edquido na cabec\u00e7a\ngc\tg\u00edas na cabe\u00e7ca\ns\tseparador\nwh\twell head\nsi\tsuperficial de l\u00edquido\nsg\tsuperficial de ga\u00eds\nO modelo proposto e apresentado na equa\u00e7\u00e3o 2.15.\nMfg = qgf \u2014 qgc\nMi = qif \u2014 qic\nq'ff = ~[ \u2014 qif + PI (Pr \u2014 Pwf)]\t(2.15)\nO modelo proposto na equa\u00e7c\u00e3ao 2.15 baseia-se em tr\u00f4es equac\u00e7\u00e3oes diferenciais ordinarias. As duas primeiras representam o balan\u00e7co de massa de gas e de l\u00edquido no interior do tubo de produc\u00e3o. A terceira equac\u00e7\u00e3ao descreve uma din\u00f4amica de primeira ordem para a entrada de l\u00edquido no fundo do po\u00e7o. Esta \u00e9 uma dinamica simplificada e inspirada no trabalho de Fetkovich na descri\u00e7\u00e3o do mecanismo de influxo de agua em reservatorios de oleo subsaturado, [34].\nA fim de simplificar a modelagem, a dista\u00f4ncia entre a valvula de gas lift e a zona canhoneada \u00e9 desprezada e a pressao na frente da frente da valvula de gas lift \u00e9 considerada igual a pwf. Alem disso considera-se um poc\u00e7o vertical. Considera-se a vaz\u00e3ao de gas entrando diretamente no tubo de produ\u00e7c\u00e3ao atraves da valvula operadora. Esta considerac\u00e7a\u00e3o representa de certo modo o que acontece quando se tem escoamento cr\u00edtico. Nenhuma dessas sim-plifica\u00e7c\u00e3oes comprometem a generaliza\u00e7c\u00e3ao do modelo proposto mas facilitam a apresentac\u00e7\u00e3ao do mesmo. Pode-se incorporar ao modelo proposto a equa\u00e7ao para a conserva\u00e7\u00e3o da massa de gas no anular e o modelo da valvula operadora para obter-se uma rep-resenta\u00e7c\u00e3ao mais geral do processo GLC visando um estudo tanto do fen\u00f4meno heading como do density wave.\nUma variavel chave para a modelagem do fen\u00f4meno density wave e a frac\u00e3o massica de gas, x, apresentada na equac\u00e3o 2.7 e que representa a rela\u00e7c\u00e3ao entre a massa ocupada pela fra\u00e7c\u00e3ao da sec\u00e7\u00e3ao transversal do duto contendo gas pela massa total ocupada pelo duto.\nx\t,\t(2.16)\nrg Pg + riPl\n\\\t\t\nonde rg\tg\t\n\t= A \u2019\t\n\t\\i\t\nri\t= e\t\n\\\t=\tAg + Al .\t(2.17)\nAg e Ai s\u00e3o respectivamente as fra\u00e7\u00f5es da \u00e1rea da se\u00e7\u00e3o transversal do duto ocupada pelo g\u00e1s e pelo l\u00edquido.\nFigura 2.4: Fra\u00e7ao m\u00edssica de g\u00eds\nAs fra\u00e7\u00e3es rg e rl podem ser utilizadas na equacao da conservacao da massa para a fase g\u00e9s e l\u00e9quido fluindo no tubo de produ\u00e7\u00e3o, como\ndPg rg , dPg rg vg dt\tdz\ndPiri + dPiriVi dt\tdz\n0,\n0.\n(2.18)\nUm importante resultado de [33] foi utilizar o modelo de velocidade entre Vg e Vl apresentado na equacao 2.19 e as equac\u00e3es 2.7 e 2.18 para encontrar a din\u00eamica de x mostrada pela equa\u00e7ao diferencial parcial 2.20.\nV to\nVg = Vi + ----\nri\n(2.19)\ndx ,, dx\t.\t.\ndt+ Vg dz = 0\t(2.20)\nAplicando-se a Transformada de Laplace na equa\u00e7c\u00e3ao 2.20 obt\u00e9em-\nse\nsx(z, s) \u2014 x(z, 0) + Vg \u2014dz\u2014) = o.\t(2.21)\ndx(z, s)\ts \u201e\n= - dz x(z, s)\tVg\n(2.22)\nAssumindo a origem de z = 0 como o ponto do tubo de produ\u00e7\u00e3o na frente da valvula de gas lift e z = L como o ponto no tubo de produc\u00e7\u00e3ao igual a superf\u00e9cie, pode-se integrar a equac\u00e7a\u00e3o 2.22,\nz L dx(z, s) z=0 x(z,s)\nz=L\nz=0\n(2.23)\n<dz\nComo J dy/y = ln y, obtem-se,\nlnx(z, s) lL\nln\nx(L, s)A\nx(0, s) )\nL\n- V \u2019\u2022\nL\n\u25a0 V\nx(L, s)\n- L s x(0, s)e Vg ,\n(2.24)\nque no dom\u00ednio do tempo pode ser escrita como\nxsup\n(t) = xfundo(t\tV ).\nVg\n(2.25)\nA equac\u00e3o 2.25 expressa o fato que x (gas mass quality) viaja com a velocidade Vg. Isto significa que o valor de x na superf\u00edcie no instante t \u00e9 o mesmo que o valor de x do fundo no instante t \u2014 t sendo que t \u00e9 o tempo que levou para esta propriedade chegar at\u00e9 a superf\u00e9cie. Para uma velocidade constante do g\u00e9as, temos que T = L.\nA estrat\u00e9egia para modelar o comportamento do escoamento no tubo de produ\u00e7ca\u00e3o consiste em descrever as vari\u00e9aveis press\u00e3ao, fra\u00e7ca\u00e3o volum\u00e9etrica de g\u00e9as e l\u00e9quido, vaz\u00e3ao de ga\u00e9s e l\u00e9quido, densidade do g\u00e9as no fundo e na superf\u00e9cie. A varia\u00e9vel que vai permitir a conex\u00e3ao entre estes dois pontos de observac\u00e7\u00e3ao \u00e9e a frac\u00e7\u00e3ao m\u00e9assica de ga\u00e9s x. Assume-se que o sistema parte de um regime permanente est\u00e9avel com valores definidos para Pwf, Pgf, rgf, xf, Vgf, Vif, pwh, Pgc, r gcj Vgc- V etc.\nEstrat\u00e9gia para a implementa\u00e7\u00e3o do modelo\nAs variaveis, par\u00e2metros e constantes utilizados na modelagem s\u00e3o apresentados na tabela 2.1. A implementa\u00e7ao do modelo desenvolvido foi realizada com um pequeno programa que divide-se em 3 partes. Na primeira parte calcula-se a rela\u00e7ao em regime\npermanente entre Pw f e qgf. Nesta parte do programa determinase tamb\u00e9m, como ser\u00e1 explicado na sequ\u00eancia, a rela\u00e7\u00e3o entre a press\u00e3o na cabe\u00e7a do po\u00e7o e os estados Mg e Mi.\nNo segundo est\u00e1gio o usu\u00e1rio escolhe uma vaz\u00e3o de injec\u00e3o qgf que caracteriza o funcionamento do po\u00e7o em regime permanente. O programa desenvolvido calcula ent\u00e3o todas as condi\u00e7\u00f5es iniciais que serao utilizadas na simula\u00e7ao. No terceiro est\u00e1gio aplica-se uma vaza\u00e3o de inje\u00e7c\u00e3ao qgf desejada e o programa calcula a evolu\u00e7ca\u00e3o das vari\u00e1veis de interesse ao longo do tempo futuro definido pelo usua\u00e1rio.\nUma das dificuldades do modelo proposto \u00e9 a determina\u00e7\u00e3o dos valores em regime permanente para Mg e Mi, respectivamente a massa de g\u00e1s e a massa de l\u00edquido no tubo de produ\u00e7ao. A estrategia utilizada para encontrar uma solu\u00e7\u00e3o numerica que atende todas as relacco\u00e3es em regime permanente para uma determinada vaz\u00e3o de injecao de g\u00e1s qgf constante e explicada na sequ\u00eancia. Inicia-se o processo com um valor inicial para a press\u00e3o de fundo, por exemplo Pwf = .95Pr. Com este valor calcula-se todas as vari\u00e1aveis do fundo de poc\u00e7o,\nqlf\t= PI (Pr - Pwf ) M\npgf =\t= Pwf RT\nVgf =\t- Vlf +\t rlf\nVl\tqif piAif'\nAlf\t= rif A\nVgf =\tqif\ti V\u2014 pirif A\trif \u2019\nVgf =\t=\t\u2014(-f + V- )\u25a0\t(2.26) rif piA\nUtilizou-se a seguinte express\u00e3o para VTO, [35]\nV- = 0.35. lgD(pi - P\u2019f >\nPl\n(2.27)\nTamb\u00e1m necessita-se de uma express\u00e3o para rl f, que obt\u00e1m-se a\npartir de\nqgf = Pgf Vgf rgfA,\n1 \u2014 rif,\nrgf\nqgf\nrif\nPgf Vgf(1\trif)A,\n(1\nqgf\t)\nPgf Vgf A\n(2.28)\nCombinando as equa\u00e7\u00f5es 2.26 e 2.28,\nVgf\t(1 \u2014\t)-1( -f + V-), Pgf Vgf A\tPiA\nVgf\t=\t''A +\t+ V-.\t(2.29) PiA\tPgfA\nDe acordo com a equa\u00e7ao 2.29 a velocidade do gas no fundo \u00e9 igual a soma da velocidade superficial do l\u00edquido no fundo (uslf = pqpA), da velocidade superficial do gas no fundo (usgf = ipg\u00edA) e da velocidade terminal da bolha de gas, VTO,\nVgf = uslf + usgf +\t(2.30)\nO valor de rgf pode ser calculado como\n3\u2018\tVgf Pgf A\n(2.31)\nCom rl = 1 \u2014 rgf o valor de Xf pode ser calculado utilizando a equa\u00e7\u00e3o 2.7 e Vlf pode ser obtido com a equacao 2.19.\nPara a determina\u00e7c\u00e3ao das variaveis na cabe\u00e7ca do po\u00e7co, utiliza-se o fato de que as vaz\u00f5es massicas qk, k = loug sao iguais aquelas do fundo em regime permanente j a que\ndrkPk , drkPkVk\t_\n+\t=0, em regime permanente,\ndt\tdz\ndrkPk = 0\ndt = \u2019\ndrkPk Vk dz\ndAr-kPkVk\n0 ou, como A e constante,\ndz\ndqk dz\nAlem disso x na cabeca do poco \u00e9 igual ao valor no fundo do po\u00e7o em regime permanente, ja que xc = xf (t \u2014 a) e xf (t) \u00e9 considerado constante em regime permanente, isto e,\ndx\tdx\t\ndt + g dz\t=\t0, mas\ndx\t\n\t=\t0,\n~dt\t\ndx\t\n\t= 0,\ndz\t\nxc\t= xf\nqc\t=\tqf\nem regime permanente,\nUtiliza-se a expressao da vazao no choke de produ\u00e7\u00e3o,\nqc\tC/Pc(Pwh\tPs),\n(2.32)\nonde pc representa a densidade m\u00e9dia da mistura g\u00e1s-l\u00edquido na cabeca do poco que pode ser calculada pela equa\u00e7\u00e3o 2.33,\n_ = 1\nPc = Xc .\t(1-Xc) ,\npgc\tpl\n(2.33)\nonde\nCombinando-se as equa\u00e7\u00f5es 2.32, 2.33 e 2.34 pode-se obter o valor de pwh e determinar as demais variaveis na cabe\u00e7a do poco. O valor de pgc \u00e9 calculado utilizando-se a equa\u00e7ao 2.34. Utilizando-se o resultado obtido com a equa\u00e7\u00e3o 2.30 pode-se escrever por indu\u00e7c\u00e3ao que\nVgc = usgc + uslc +\t\u25a0\t(2.35)\nNovamente, como as vaz\u00e3es massicas de gas e l\u00edquido sao iguais as do fundo,\nVgc = qgf \u00a1APgc + qif \u00a1APl +\t\u25a0\t(2.36)\nO valor de rgc e calculado como\nqgf\nAPgcVgc\n(2.37)\nO valor de Vlc pode ser calculado como,\nV =_________qlf____\nic~ (1 - rgc)Apl-\nTendo definido as densidades, velocidades e as fra\u00e7c\u00e3oes da \u00edarea do tubo de produ\u00e7\u00e3o ocupadas pelo g\u00eds e pelo l\u00edquido, alem da press\u00e3o na cabe\u00e7a de produ\u00e7ao pode-se calcular um novo valor para a press\u00e3o de fundo. Uma expressao simplificada para a pressa\u00e3o de fundo consiste em considerar somente o termo devido \u00e0 gravidade e ao atrito.\nPwf-novo = Pwh + (Mg + Ml ) A + ^Patrito-\t(2.39)\nPara calcular as massas de g\u00eds e l\u00edquido considera-se o eixo vertical com a origem no fundo do po\u00e7o (z = 0) e com (z = L) na cabe\u00e7a. As express\u00f5es para Mg e Ml podem ser escritas como\nLL\nMg =\tAg (z)pg (z)dz = A\trg (z) p g (z)dz\nJ0\tJ0\nMi = A (1 - rg(z))pidz\t(2.40)\n\u25a0Jo\nNecessita-se de express\u00e3es para rg(z) e pg(z). Baseado no conhecimento do sistema optou-se por express\u00e3oes exponenciais como\nPg(z)\t= PgfekpZ\nrg (z) = rgfekrZ,\t(2.41)\nonde kp\nkr\n1ln( ),\nL\tpgf\n|ln( ).\nL\trgf\n(2.42)\nSubstituindo as express\u00e3es para pg (z) e rg (z) da equacao 2.41 na\nequac\u00e3o 2.40 e resolvendo, obt\u00e9m-se\nMg\t_ ( Pgf Argf )(e((kr+ko)L)\ti) (kr 1 kp)\nMi\t= PiA(L - ()(e(krL - 1)).\t(2.43) kr\nE interessante observar que utilizando-se tamb\u00e1m uma express\u00e3o exponencial para Vg (z) do tipo\nVg (z)\t= Vgfekvz, com\nkv = Lln( V),\t(2.44)\nL\tvgf\nobt\u00e9m-se em regime permanente\ndrg (z)Pg (z)Vg(z) dz\ndrg (z)Pg (z)Vg (z) dz\nkr + kp + kv\n0\n(kr + kp + kv )rgf Pgf Vgf '\t+ k?+kv\t= 0\n0.\n(2.45)\nA constata\u00e7\u00e3o de que kr + kp + kv = 0 assegura que a solucao obedece a lei da continuidade para escoamento onde n\u00e3ao h\u00e1a convers\u00e3ao g\u00e1s-l\u00edquido e vice-versa. Para o c\u00e1lculo da perda de press\u00e3o por atrito preferiu-se utilizar uma express\u00e3ao linear para a evolu\u00e7c\u00e3ao da densidade m\u00e1edia e da velocidade m\u00e1edia da mistura. Este procedimento ser\u00e1 utilizado tambem na simulacao din\u00e2mica onde n\u00e3o se conhece a distribuic\u00e7\u00e3ao espacial dessas vari\u00e1aveis e uma aproxima\u00e7\u00e3o linear \u00e1 um bom compromisso. Definindo-se as densidades medias no fundo pf e na cabe\u00e7a do po\u00e7o pc, tem-se\npf = rgf Pgf + (1 \u2014 rgf )Pl,\npc = rgcPgc + (1 \u2014 rgc )Pl.\t(2.46)\nAs velocidades da mistura s\u00e3ao definidas como em [1],\nuf\t\u2014 usgf + uslf\t\nuc\t=\tusgc + uslc\t\nonde usgf\tqgf\t\n\tPgf A\t\nuslf\tqif PiA\t\nusgc\tqgc PgcA\u2019\t\nuslc\tqic PiA'\t(2.48)\nA equa\u00e7\u00e3o para a velocidade da mistura ao longo do eixo z \u00e9 escrita como\n.\tuc \u2014 uf\nu(z) = Uf 3------\u2014-z.\t(2.49)\nL\nA taxa de queda de press\u00e3ao por atrito pode ser escrita como\ndp dz\nf\n2Dp(z)u(z')2, ou\n(2.50)\nf [L\nApatrito = 2d\tp(z)\u00fc(z)2dz\t(2.51)\nSubstituindo as equa\u00e7\u00f5es 2.47 e na equa\u00e7ao 2.51,\nApatrito = 2D f (Pf + L z)(uf +\n'\tz)2 dz\n(2.52)\nL\nA solu\u00e7ao da equa\u00e7\u00e3o 2.52 fornece\n2\nA = fL(2_____________) + l--2 +\nApatrito = 2d (12 Pf Uf Uc) + 12 Pc'Uf +\n2______.\t3 _ _2,\n12 PcUcUf ) + 12 PcUc )\n3 - -2\n--Pf Uf\n12Pf f\n12\n+ 12 PfUc +\n(2.53)\nTendo obtido um novo valor para a pressao de fundo, pw--novo, pode-se calcular o erro\nGTTOatual \u2014 pwf-novo\tpwf'\t(2.54)\nA correc\u00e3o no valor de pwf foi realizada utilizando a aplicac\u00e3o\nde um algoritmo de controle Proporcional Integral (PI) na forma discreta. O novo valor \u00e9 calculado como\nPwf = Pwf + Corr,\t(2.55)\ne o valor da corre\u00e7ao \u00e9 calculado como\nCorr = Corr anterior + (kp + ki)erroatuai - kperroanterior \u25a0 (2.56)\nO algoritmo \u00e9 interrompido quando atinge-se um erro com valor absoluto menor do que um valor admiss \u00edvel, eadmissvel. Na fase de regime permanente calcula-se a solucao para toda a faixa de valores de vaz\u00e3o de injecao de gas de interesse. Este procedimento permite determinar uma express\u00e3o para a press\u00e3o na cabe\u00e7a do po\u00e7o em fun\u00e7\u00e3o dos estados Mg e Ml.\nUma variavel chave para a descri\u00e7\u00e3o matematica do processo \u00e9 a press\u00e3o na cabe\u00e7a do poco. Em [33] calcula-se a press\u00e3o na cabe\u00e7a com a equa\u00e7\u00e3o 2.57,\nMg\tRTc\nPwhp = AL - Mi\t'\t(2.57)\npi\nEsta express\u00e3o foi proposta para um modelo bastante simplificado. Considerando o fator de compressibilidade do gas igual a 1, a express\u00e3o seria valida se a massa de gas Mg estive toda submetida a mesma press\u00e3o. No caso em que o tubo de produ\u00e7\u00e3o esta todo ocupado por gas MMI_9M \u00bb 1a expressao se aproxima da realidade ao se desprezar o efeito do peso do gas. Ja, para pocos n\u00e3o surgentes e, considerando que nao ha velocidade descendente de fluido, quando o tubo de produc\u00e3o esta todo ocupado por l \u00edquido, mM9m\t0, a press\u00e3o na cabe\u00e7a tende a pressao do separador,\nPs. Diante disso uma proposta \u00e9 a utilizacao da express\u00e3o\nMg\tRTc\nPwhp = AL - Mi pl\npwh\tppwhp + (1 p)Ps\n(2.58)\nObviamente deve-se tambem obter uma express\u00e3o para p. Pelo exposto e natural buscar uma express\u00e3o para p como funcao de Ig = mM9m . Como para cada valor de vazao de inje\u00e7ao qgf obtem-se valores para Mg, Mi, pwh e pwhp obtem-se suficiente\ninformac\u00e3o para ajustar uma fun\u00e7\u00e3o para p como fun\u00e7ao de Ig. A cada um dos n valores de qgf calcula-se\nP\nPwh Ps\nPwhp Ps\nMg\t.\nMg + Mo\n(2.59)\nAjusta-se ent\u00e3ao os par\u00f4ametros do polin\u00f4omio\nPestimado = k1 + k^Ig + k\u20183Ig +\t+ k5kg + k6kg\t(2.60)\nO modelo din\u00e2mico\nO modelo descrito pela equa\u00e7ao 2.15 \u00e9 discretizado com um tempo de amostragem Ts. A derivada de qualquer dos tr\u00eas estados \u00e9 aproximada pela express\u00e3ao de Euler. Na modelagem din\u00f4amica n\u00e3o se pode contar com algumas simplifica\u00e7\u00e3es poss\u00edveis para o modelo de regime permanente. A vaz\u00e3ao massica, por exemplo, n\u00e3o e necessariamente igual ao longo do eixo vertical z e tampouco o valor de x no instante kTs \u00e9 igual na cabeca e no fundo do po\u00e7co. Sabe-se que se a velocidade do gas fosse constante ent\u00e3ao, de acordo com a equa\u00e7c\u00e3ao 2.25,\nxc(t) = xf(t \u2014 t), com\t(2.61)\nt = L\t(2.62)\nVg\nO procedimento adotado para a obten\u00e7ca\u00e3o de xc(kTs) consiste em manter uma matriz H com Nh linhas e tr\u00eas colunas. Uma coluna para o valor de Vgc, outra para Vgf e outra para xf. Em regime permanente todas as linhas sa\u00e3o iguais.\nNa medida em que se inicia a simula\u00e7c\u00e3ao din\u00f4amica, passado o tempo Ts todas as linhas, exceto a primeira s\u00e3ao deslocadas para uma posi\u00e7c\u00e3ao mais abaixo e a ultima linha e descartada. A primeira linha recebe os valores atualizados de Vgc(Ts), Vgf (Ts) e xf (Ts). O valor de xc(kTs) sera igual a xf ((k + d)Ts) sendo que para encontrar o valor de d o seguinte procedimento \u00e9 adotado.\nDeve-se observar que para cada instante de tempo, no lugar de uma unica velocidade, temos a velocidade no fundo do poc\u00e7o, Vgf e na cabec\u00e7a do poc\u00e7o, Vgc. Assim no instante kTs podemos calcular\ne\t(2.63)\na distancia percorrida pelo gas como ALi = Vgc(kTs)Ts. Isso nos levaria para a segunda linha em um ponto Li abaixo da cabe\u00e7a do po\u00e7co. A velocidade do g\u00e9as na dist\u00eaancia Li abaixo da cabec\u00e7a no instante (k \u2014 1)Tspode ser obtida atrav\u00e9s de uma interpolacao considerando uma distribui\u00e7\u00e3o de velocidade linear entre Vgf ((k \u2014 1)Ts) e Vgc((k \u2014 1)Ts) cujos valores estao na segunda linha da matriz H. Ou seja, a seguinte rela\u00e7\u00e3o \u00e9 v\u00e9lida,\nVg (Li, (k \u2014 1)Ts) \u2014 Vgf ((k \u2014 1)Ts) =\nL \u2014 Li Vgc((k \u2014 1)TS) \u2014 Vgf ((k \u2014 1)TS)\nL\nVg(Li, (k \u2014 1)Ts)=\t(2.64)\nVgf ((k \u2014 1)Ts) +\t(Vgc((k \u2014 1)Ts) \u2014 Vgf ((k \u2014 1) Tfi )) .\nCom o valor de Vg(Li, (k \u2014 1)Ts) pode-se calcular o novo deslocamento, L2,\nL2 = Li + Vg (Li, (k \u2014 1)Ts )Ts\t(2.65)\nO procedimento \u00e9 continuado at\u00e9 que o valor calculado de Ld iguale L. Neste ponto,\nxc(kTs) = xf ((k \u2014 d)Ts).\t(2.66)\nUtilizando os dados da matriz H com Vgc na coluna 1, Vgf na coluna 2 e xf na coluna 3, o seguinte pseudo co\u00e9digo permite\ndeterminar o valor de xc(kTs).\nLe = 0;\ni = 0;\nwhile Le<L\ni = i + 1;\nVgz = H(i, 2) + (L - Le) * (H(i, 1) - H(i, 2))/L;\nLe = Le + Vgz * Ts;\nend\nT = i;\nxc = H(T, 3);\nO valor de pwh \u00e9 calculado utilizando-se a equa\u00e7\u00e3o 2.57 com p obtido com os coeficientes previamente calculados na fase de sim-ula\u00e7ao de regimes permanente. Com pwh pode-se calcular pgc e com xc obtido com o procedimento previamente descrito pode-se calcular a densidade media na cabe\u00e7a do po\u00e7o, pc utilizando-se a equa\u00e7\u00e3o 2.33. Como pc = rgcpgc + (1 \u2014 rgcpi), obtem-se rgc como\nrgc\n(Pl - Pc)\n(Pl \u2014 pgc)\n(2.67)\nCalcula-se na sequ\u00eancia a vazao massica total na cabeca do po\u00e7o para a condi\u00e7ao de abertura total do choke de produ\u00e7\u00e3o, u =1.\nqc = CusJPc(pwh - Ps)\n(2.68)\nSup\u00e3e-se que qc > 0. No caso em que rgc = 1, a vaz\u00e3o massica na cabe\u00e7ca do po\u00e7co e igual a vaza\u00e3o de g as e\nqgc\n^sgc\nVgc\nuslc\nVlc\nqc, qgc\nPgcA'\n^sgc\n0,\n0.\n(2.69)\nPara valores de rgc &lt;1, utiliza-se as seguintes rela\u00e7\u00f5es\n^sgc\tqgc pgcA qic\nuslc\tpi A5\nVgc\t=\t=\tusgc 1 uslc 1 ^^5\nqgc + qic =\tqc,\nqgc\t= rgcApgcVgc,\t(2.70)\npara obter-se\nVgc =\nqc + V^piA pc A\n(2.71)\nNota-se a vaz\u00e3o m\u00e9ssica virtual V^plA na equa\u00e7\u00e3o 2.71. A velocidade Vlc e calculada utilizando-se a equa\u00e7\u00e3o 2.19 e as vaz\u00e3es m\u00e9ssicas de g\u00e9s e l\u00edquido na cabeca do po\u00e7o s\u00e3o calculadas,\nqgc\trgcApgcVgci\nqic = (1 \u2014 rgc)ApiVic.\t(2.72)\nA press\u00e3ao de fundo \u00e9e recalculada a cada instante de tempo utilizando-se a equac\u00e3o 2.39.\nAplica\u00e7ao do modelo\nA fim de verificar a qualidade do modelo desenvolvido aplicou-se ao po\u00e7o tambem modelado por [1] com os par\u00e2metros definidos na tabela 2.3.\nA figura 2.5 mostra alguns resultados obtidos na fase regime permanente para o po\u00e7o com os par\u00e2metros da tabela 2.3. A figura 2.5-a mostra a rela\u00e7\u00f5o Press\u00f5o de fundo versus vazao de inje\u00e7\u00f5o de g\u00e1s. A figura 2.5-b mostra a press\u00f5o na cabeca do poco e seu valor estimado com o polin\u00e2mio descrito pela equac\u00f5o 2.60. A figura 2.5-c mostra a distribui\u00e7\u00f5o da fra\u00e7ao de vazio, rg, ao longo do eixo vertical para uma vaz\u00f5o de injecao de g\u00e1s de 1.0 kg/s. Nota-se que a curva \u00e9 muito semelhante aquela apresentada em\n[1]\tpara o poco com os mesmos par\u00e2metros e vaz\u00f5o de inje\u00e7ao e utilizando uma modelagem baseada na solu\u00e7c\u00f5ao das equac\u00e7\u00f5oes diferenciais parciais que regem o fen\u00e2meno. A figura 2.5-d mostra que x tem uma rela\u00e7ca\u00f5o praticamente linear em relac\u00e7\u00f5ao a vaz\u00f5ao de\nTabela 2.3: Par\u00e2metros do po\u00e7o de teste\nS\u00edmbolo Descri\u00e7\u00e3o\tUnidade\nT\tTemp. na cabe\u00e7a e fundo do po\u00e7o\t300 K]\nM\tMassa molar do gas\t0.0289 Kg/mol]\nL\tDist. da cabeca-fundo do poco\t2500 m]\nD\tDi\u00e2m. interno tubo de produ\u00e7\u00e3o\t0.125 m]\nf\tFator de atrito\t0.015]\nC\tConstante do choke de produ\u00e7\u00e3o\t0.0058 m2]\nPI\tIndice de Produtividade do poc\u00e7o\t4 x 10-6 Kg/sPa]\nrhoi\tDensidade do l\u00edquido produzido\t1000 Kg/m3]\nPr\tPress\u00e3ao estatica da forma\u00e7ca\u00e3o\t18 x 106 Pa]\nPs\tPressa\u00e3o do separador\t1 x 106 Pa]\nT\tConst. Tempo vazao da forma\u00e7\u00e3o\t600s]\ninje\u00e7\u00e3o de gas.\nA figura 2.6 apresenta o comportamento da pressao de fundo pwf e da vazao de l\u00edquido na cabe\u00e7a do po\u00e7o qlc para a vazao de injec\u00e3o de gas, qgf, com valor inicial de 2.0 kg/s que cai para 1.0 kg/s no tempo igual a 2 horas e cai novamente para 0.1 kg/s no tempo igual a 6 horas.\nO comportamento da press\u00e3o de fundo para a primeira mudanca na vaz\u00e3ao de inje\u00e7ca\u00e3o acontece dentro do esperado com uma rea\u00e7ca\u00e3o do tipo resposta inversa e pouca oscilacao. Quando a vaz\u00e3o cai para 0.1 kg/s ocorre o fen\u00e2meno density-wave caracterizado pelo comportamento com oscila\u00e7co\u00e3es sustentadas da press\u00e3ao de fundo e consequente vaz\u00e3o de produc\u00e3o de l\u00edquido na cabe\u00e7a do po\u00e7o na forma de golfadas.\nA figura 2.7 mostra o comportamento das variaveis Mg, Mi, rgc, rgf, Pwh e xf. Observa-se que todas as variaveis desenvolvem oscilac\u00e7\u00e3oes sustentadas apos a mudanc\u00e7a na vaz\u00e3ao de inje\u00e7ca\u00e3o de gas no tempo igual a 6 horas.\n(C)\n(d)\nFigura 2.5: Alguns resultados para regime permanente\ntativamente as respostas das vari\u00e1veis de interesse.\nA figura 2.8 mostra no topo a vaz\u00e3o de inje\u00e7\u00e3o de g\u00e1s seguida da pressao de fundo pwf logo e da vazao de produ\u00e7\u00e3o de l\u00edquido na cabe\u00e7a do po\u00e7o qic. Nota-se uma semelhan\u00e7a muito forte com os resultados obtidos com o simulador desenvolvido e apresentados na figura 2.6.\nA figura 2.9 apresenta no topo as fra\u00e7\u00e3es de g\u00e1s no fundo, rgf e na cabe\u00e7a do po\u00e7o, rgc seguida do grafico da press\u00e3o na cabe\u00e7a do poco, pwh e da fracao m\u00e1ssica de gas do fundo do poco, Xf. Percebe-se que qualitativamente existe uma semelhan\u00e7a no comportamento das mesmas varia\u00e1veis obtidas com o simulador desenvolvido e apresentadas na figura 2.7.\nA figura 2.10 mostra o mapa dos estados qif, Mg e Mi. Nota-se que a trajet\u00e1oria da curva atinge um ponto fixo na mudan\u00e7ca da vaz\u00e3o de injec\u00e3o para 1.0 kg/s mas entra em uma orbita fechada (ciclo-limite estavel) na mudanca para 0.1 kg/s.\nUtilizou-se o po\u00e7o com os par\u00e2metros da tabela 2.3 para realizar um estudo sobre a estabilidade do poc\u00e7o quando se varia a press\u00e3ao esta\u00e1tica da formac\u00e7\u00e3ao. Utilizando-se o modelo desenvolvido diminuiu-se a vaz\u00e3ao de inje\u00e7c\u00e3ao at\u00e1e o ponto onde o po\u00e7co\n(a)\n\u2014 2\nOl--------1-------i------iv\ti\ti\ti\ti\ti\ti\ti\ti\n0\t2\t4\t6\t8\t10\t12\t14\t16\t18\t20\t22\t24\nTempo [ h ]\nFigura 2.6: Alguns resultados de simula\u00e7ao din\u00e2mica I\ndesenvolve oscilac\u00f5es sustentadas ou um ciclo-limite. O resultado e apresentado na figura 2.11. Nota-se que na medida em que a press\u00e3o estatica da forma\u00e7\u00e3o aproxima-se de um valor que induziria surg\u00e2ncia do po\u00e7o diminui a vaz\u00f5o m\u00e1ssica de injec\u00f5o de g\u00e1s necessaria para levar o po\u00e7o a instabilidade. O modelo corrobora as observa\u00e7\u00f5es em [1] de que n\u00f5o ocorre o fen\u00f4meno density-wave em po\u00e7os surgentes.\nNota-se que as vaz\u00f5oes ma\u00e1ximas que geram ciclo-limites est\u00e1aveis sa\u00f5o menores que aquelas encontradas com o modelo mais completo de [1] para o mesmo po\u00e7o.\nEntretanto, os valores de vaz\u00f5ao de inje\u00e7c\u00f5ao m\u00e1axima que geram oscilac\u00e7\u00f5oes sustentadas para diferentes valores de press\u00f5ao est\u00e1atica de forma\u00e7c\u00f5ao est\u00f5ao muito pr\u00e1oximos aos valores encontrados com as simula\u00e7\u00f5es mostradas em [1] utilizando o simulador OLGA2000MR e apresentadas aqui na figura 2.12.\nFigura 2.7: Alguns resultados de simula\u00e7\u00e3o din\u00e2mica II\numa vaz\u00e3o de inje\u00e7\u00e3o m\u00ednima de g\u00e1s a fim de que o poco n\u00e3o desenvolva o fen\u00f4meno density-wave. Esta vazao m\u00ednima dever\u00e1 ser igual ao valor da vaz\u00e3o de inje\u00e7\u00e3o que leva o po\u00e7o a desenvolver oscila\u00e7\u00e3es sustentadas acrescido de um fator de seguran\u00e7a. No caso de haver uma incerteza muito grande no valor m\u00ednimo correto este fator de seguran\u00e7ca pode ser muito grande o que vai prejudicar a distribuicao otima de g\u00e1s dentre os po\u00e7os nos momentos de restri\u00e7c\u00e3ao.\nA figura 2.13 mostra uma simula\u00e7\u00e3o para o po\u00e7o exemplo com a pressao do reservat\u00e1rio igual a 11.0 MPa quando se faz uma mudanca na vazao de inje\u00e7\u00e3o de g\u00e1s de 2.0 kg/s para 0.55 kg/s. Nota-se claramente o desenvolvimento de um ciclo limite. Sim-ula\u00e7c\u00e3oes com vaz\u00e3oes ligeiramente maiores do que 0.55 kg/s d\u00e3ao origem a comportamento semelhante mas as oscilac\u00e7\u00e3oes apresentam uma tend\u00f4ncia de queda de amplitude. O ponto qgf = 0.55, Pr = 11.0 MPa e mostrado na figura 2.11.\nUm procedimento adequado para a determinac\u00e3o dos tipos de equil\u00e1brios seria analisar os autovalores da matriz Jacobiana J do modelo din\u00f4mico descrito pela equac\u00e3o 2.73 com os valores\n2\nq t [MPa]\tP\u201ef[MPa]\tqjkg/s]\n0\n0\t2\t4\t6\t8\t10\t12\t14\t16\t18\t20\t22\t24\n20\n10\n0\n0\t2\t4\t6\t8\t10\t12\t14\t16\t18\t20\t22\t24\nTempo [h]\nFigura 2.8: Resultados com o simulador OLGA2000MR I\nencontrados nos equil\u00edbrios.\nfi = Mg = qgf\tqgc\nfa = Mli = qif - qic\nf3 = qlf = T [-qif + PI (Pr - Pwf)]\t(2.73)\n\tr dfi dMg\tdfl dMi\tdfl I dqir\t\nJ =\t\u00d4Mg\tdf2 dMi\tdf2 Sqif\t(2.74)\n\tdf3\t\t\t\n\tL dMg\tdMi\tdqif -\t\nDada a complexidade do modelo, uma alternativa seria obter a matriz Jacobiana de forma num\u00e9rica, onde\ndfj\t= fj (M\u00a1q- + e)\ndMegq-\te\ndfj\t= fj M + e)\ndMfq'\te\ndfj\t= fj (qif' + e)\ndqfq-\t=\te\n(2.75)\nXf[-]\tPwh [MPa]\trgc e rgf [-]\nTempo [h]\n\u2019 ULJUUUUUI\u00c1JUUIAJUUIAJUU\n1.08\n1.04\n1\n0.96\n0\t2\t4\t6\t8\t10\t12\t14\t16\t18\t20\t22\t24\nTempo [h]\nFigura 2.9: Resultados com o simulador OLGA2000MR II\nFigura 2.10: Comportamento tipo orbita fechada\nVaz\u00e3o de inje\u00e7\u00e3o de g\u00e1s - q [ kg/s ]\nPress\u00e3o est\u00e1tica do reservat\u00f3rio pr [ bar ]\nFigura 2.11: Equil\u00edbrios com modelo desenvolvido\n1.3\n1.2\n1.1 _ 1.0 |0.9\n0.8\na>\n0.7\n0.6\nO\n0.5\nc\n0.4\n\u00abj\n0.3\n0.2\n0.1\n0.0\n50\n100\t150\t200\t250\n(b)\n:.bwwvwwwww\n8o\t2\t4\t6\t8\t10\t12\n(0\nFigura 2.13: Simula\u00e7\u00e3o din\u00e2mica p/ Pr = 11 MPa com qgf = 0.55 kg/s\n2.2.2\tUm modelo emp\u00edrico para otimiza\u00e7\u00e3o da eleva\u00e7\u00e3o por GLC 1\nA disponibilidade da medic\u00e3o das vazoes de agua, oleo e gas produzidas por cada po\u00e7co em tempo real ainda n\u00e3ao e uma realidade. Como alternativa busca-se estimar estas vaz\u00e3es da melhor forma poss\u00edvel. Com o aumento do uso de medidores de pressao e temperatura de fundo, surge uma oportunidade para melhorar a otimiza\u00e7\u00e3o da produ\u00e7\u00e3o dos pocos operando por GLC.\nA otimiza\u00e7c\u00e3ao da opera\u00e7c\u00e3ao de um grupo de po\u00e7cos depende fundamentalmente do conhecimento das relac\u00e7o\u00e3es entre as vaz\u00e3oes de oleo, agua e g as produzidas pelos poc\u00e7os em func\u00e7\u00e3ao da vaz\u00e3ao de inje\u00e7\u00e3o de gas (Curvas WPC- Well Performance Curve). Estas rela\u00e7c\u00e3oes mudam ao longo do tempo causando a necessidade de desenvolver-se uma tecnica para sua atualiza\u00e7c\u00e3ao. Os desenvolvimentos apresentados nesta se\u00e7c\u00e3ao baseiam-se em um novo cenario para po\u00e7cos sendo completados atualmente. Neste cen ario\n\u2014\tos pocos sao equipados com medicao de pressao de fundo.\n\u2014 Todos os pocos recebem gas para inje\u00e7ao de um mesmo manifold.\n\u2014 Todos os pocos sao equipados com medidores de vazao mas-sica de g as na linha de inje\u00e7ca\u00e3o.\n\u2014 Todos os pocos sao equipados com valvula de controle na linha de inje\u00e7ca\u00e3o de gas.\n\u2014 Todos os pocos podem ter sua producao direcionada para um separador de teste.\nO objetivo e encontrar uma forma de predizer as vaz\u00e3oes de agua, oleo e gas ou, no jarg\u00e3o da industria, determinar as curvas WPC. A estrategia que vai se adotar consiste em\n\u2014\tbuscar uma func\u00e3o que estime a pressao de fundo pwf em regime permanente em fun\u00e7ca\u00e3o da vaza\u00e3o de inje\u00e7c\u00e3ao de gas qinj,\n\u2014\tutilizar a curva IPR do po\u00e7o,\n\u2014\testabelecer uma estrategia de atualiza\u00e7ao do modelo pwf = f (qinj ).\n1 Parte deste trabalho foi publicado em [36] e tamb\u00e9m faz parte do projeto de pesquisa Desenvolvimento de Algoritmos de Controle para M\u00e9todos de Eleva\u00e7\u00e3o Artificial realizado em parceria com a Petrobras.\nDeve-se observar que mesmo tendo-se medic\u00e3es de superf\u00edcie das vaz\u00e3oes seria necess\u00edario conhecer tamb\u00edem o modelo que relaciona essas vaz\u00e3es com a vaz\u00e3o de injec\u00e3o de g\u00eds pois, principalmente no momento de restri\u00e7ca\u00e3o na disponibilidade de g\u00edas necessita-se de modelos para otimizar a distribui\u00e7\u00e3o de g\u00eds que maximize uma fun\u00e7\u00e3o objetivo como a m\u00edxima producao de \u00edleo, por exemplo. Antes de apresentar o desenvolvimento do modelo pwf = f (qinj) faz-se uma introdu\u00e7\u00e3o \u00e0 relac\u00e3o IPR na subse\u00e7\u00e3o seguinte.\nA curva IPR-Inflow Performance Relationship\nDesde o in\u00edcio da explorac\u00e3o de petr\u00edleo buscou-se uma rela\u00e7\u00e3o, em regime permanente, entre a vaz\u00e3ao de produ\u00e7ca\u00e3o e a press\u00e3ao de fundo na frente dos canhoneados. Para a raz\u00e3ao entre a varia\u00e7ca\u00e3o da vaz\u00e3o AQ e a variacao na pressao de fundo Apwf, ppQ deuse a denominacao de \u00edndice de Produtividade. M. Muskat, em 1942 j\u00ed apontava que as propriedades do petr\u00edleo e a distribuic\u00e3o da permeabilidade relativa e saturac\u00e7\u00e3ao variam de acordo com a queda de press\u00e3ao observada dentro do reservat\u00edorio em dire\u00e7c\u00e3ao ao po\u00e7co produtor. Assim, esperava que a rela\u00e7ca\u00e3o entre a vaz\u00e3ao e a press\u00e3o de fundo fosse mais complexa que linear, principalmente em reservat\u00edorios produzindo com press\u00e3ao abaixo do ponto de bolha.\nUma introdu\u00e7\u00e3o \u00e0 representa\u00e7\u00e3o da produ\u00e7\u00e3o de po\u00e7os de petr\u00edleo utilizando a curva IPR deve passar necessariamente por sua obten\u00e7c\u00e3ao anal\u00edtica, ainda que seja para condi\u00e7\u00e3es muito especiais. Mostrase aqui a obtenc\u00e3o da rela\u00e7\u00e3o IPR para um escoamento de l\u00edquido subsaturado (sempre a pressa\u00e3o acima do ponto de bolha).\nO escoamento em meio poroso \u00ed descrito pela conhecida formula de Darcy,\n= kAdP dr\u2019\nonde\n(2.76)\nq \u00e9 a vazao\n\u2014 k e a permeabilidade [m2],\n\u2014 A e a se\u00e7\u00e3o transversal ao escoamento ou area de drenagem [m2],\n\u2014\tP \u00e9 a Press\u00e3o [Pa]\n\u2014\tr \u00e9 a dist\u00e2ncia na direcao do fluxo [m],\n\u2014\ta \u00e9 a viscosidade do fluido \u2014 .\nm.s\nPe\nrw= raio do po\u00e7o re= raio de drenagem\nPw = press\u00e3o no interior do po\u00e7o Pe = press\u00e3o na fronteira h = expessura da zona canhoneada.\nq = vaz\u00e3o\nFigura 2.14: Modelo de influxo\nA figura 2.14 mostra o modelo utilizado na obten\u00e7\u00e3o anal\u00edtica da curva de influxo. Diversas premissas s\u00e3o assumidas como\n\u2014\ta formacao e homog\u00e2nea,\n\u2014\ta formacao e isotropica,\n\u2014\to fluido tem viscosidade constante,\n\u2014\to fluido tem compressibilidade baixa e constante,\n\u2014\to fluxo e isotermico e laminar,\n\u2014\tos efeitos da gravidade sao desprezados,\n\u2014\ta espessura do reservat\u00f3rio e constante com camadas imper-meaveis acima e abaixo da zona permeavel,\n\u2014\to fluxo no reservatorio e de fase unica.\nd2P\t1 dP 0act dP\nonde\n\u2014\tP e a press\u00e3o,\n\u2014\tr e a dist\u00e2ncia radial ao centro do poco,\n\u2014\te a porosidade da forma\u00e7ao,\n\u2014\td e a viscosidade do fluido,\n\u2014\tk e a permeabilidade da formacao,\n\u2014\tct e a compressibilidade total formac\u00e3o-fluido.\nAs seguintes condi\u00e7\u00e3es iniciais e de fronteira sao utilizadas, para r = rw, utilizando-se a equac\u00e3o de Darcy (equacao 2.76),\ndP\ndr\nq =\ndP\ndr\nA =\nr=rw\nkA dP d dr \u2019 Qd kA 2nrw h\nQd k2nrwh\n(2.78)\nA condi\u00e7\u00e3o de fronteira em r = rw \u00e9\ndP qd\nlim r =\nr\u2014>rw dr\tk2nh\n(2.79)\nPara a fronteira externa tr\u00e2s tipos s\u00e3o consideradas:\n\u2014\tReservat\u00f3rio com acao infinita. No in\u00edcio da explotacao do reservatorio a movimenta\u00e7c\u00e3ao de fluido ainda n\u00e3ao atingiu suas fronteiras e o perfil de press\u00e3ao e uma fun\u00e7ca\u00e3o do tempo. A condi\u00e7ca\u00e3o e ent\u00e3ao escrita como\nlim P(r,t) = Pi.\t(2.80)\nr----\n\u2014\tFronteira com fluxo nulo. O segundo tipo de fronteira e o de fluxo zero na fronteira ou\ndP(r, t)\ndr\n= 0.\n(2.81)\n\n\u2014 Fronteira com pressao constante. Assume que a press\u00e3o na fronteira mantem-se constante,\nP(re,t) = Pr .\n(2.82)\nNa express\u00e3o (2.80), Pi significa a pressao inicial do reservat\u00f3rio. A soluc\u00e3o da equa\u00e7\u00e3o da difus\u00e3o (2.77) para as tr\u00eas diferentes condic\u00e3es de fronteira gera as seguintes express\u00f5es:\n\u2014 Fluxo transiente\npwf = Pi -\n\u2014 3.23\n(2.83)\n\u2014 Fluxo em pseudo regime permanente\nqp,B\n0.00708kh\nlog(\u2014\\ \u2014 3.4\nrw\n(2.84)\n\u2014 Fluxo em regime permanente\nPw, = Pr \u2014 B log( \u00ede.)\nPwf r 0.00708kh rw )\n(2.85)\nNas express\u00f5es (2.83) a (2.85) as seguintes variaveis foram introduzidas:\n\u2014\tPi=Press\u00f5o inicial do reservat\u00f3rio (psia)\n\u2014\tP=Pressao media do reservatorio (psia)\n\u2014\tpwf =Press\u00f5o na frente dos canhoneados com o poco fluindo\n\u2014\tq=Vazao de oleo cru (STB/dia)\n\u2014\tk=Permeabilidade (miliDarcy)\n\u2014\th=expessura da zona canhoneada (ft)\n\u2014\tB=Fator volume de formacao (fra\u00e7ao)\n\u2014\tp,=Viscosidade do fluido (cP)\n\u2014\tre=Raio de drenagem (ft)\n\u2014\trw =Raio do po\u00e7o (ft)\nAs express\u00f5es obtidas para o poco vertical produzindo oleo de um reservatorio homog\u00eaneo e demais condi\u00e7\u00f5es citadas fornece uma\nrela\u00e7\u00e3o linear entre a vaz\u00e3o e a diferen\u00e7a de press\u00e3o P \u2014 pwf. Na pratica a rela\u00e7\u00e3o IPR mais conhecida e utilizada para fluidos subsaturados esta de acordo com a soluc\u00e3o anal\u00edtica obtida pela equa\u00e7\u00e3o (2.84).\nQo = J (P \u2014 pwf).\t(2.86)\nO \u00e9ndice de produtividade J leva em conta a permeabilidade relativa do oleo cru e o fator de skin que responde pela influ\u00eancia de danos na forma\u00e7c\u00e3ao vizinha ao poc\u00e7o.\nj\takh\tkr\n2n [ln() \u2014 3.4 + s] hB\n(2.87)\nPequeno Hist\u00f3rico da Rela\u00e7ao IPR\nA primeira apresenta\u00e7c\u00e3ao do conceito de curva IPR foi feita por Rawlins e Schellhardt em 1935, [37]. M. Muskat, em 1942, [38] ja apontava que as propriedades do petr oleo e a distribui\u00e7c\u00e3ao da permeabilidade relativa e saturac\u00e7\u00e3ao variam de acordo com a queda de press\u00e3ao observada dentro do reservatorio em dire\u00e7c\u00e3ao ao po\u00e7co produtor. Assim, esperava que a rela\u00e7c\u00e3ao entre a vaz\u00e3ao e a press\u00e3ao de fundo fosse mais complexa que linear, principalmente em reservat\u00f3rios produzindo com pressao abaixo do ponto de bolha. Uma formula sugerida para o \u00e9ndice de produtividade foi\nJ (Pwf) = \u2014\t.\t(2.88)\ndpwf\nComo o \u00edndice de produtividade dependeria da press\u00e3o, Muskat sugeriu uma express\u00e3o para o \u00e9ndice de produtividade para um decrescimo de pressa\u00e3o na frente dos canhoneados perto de zero a fim de estabelecer uma referencia,\nJ0 \u2014 J (pwf ) \u2014\n9Q(pwf) dpwf\nakh\n2n pn(rw) - 3.4 + s]\nkr\npB\nEm 1954, Gilbert, [39] introduziu o conceito de IPR na\n(2.89) otimiza-\n\u00e7ao da vaz\u00e3o de produc\u00e3o e press\u00e3o de fundo. Em 1968 J. V.\nP\np\nVogel trabalhou na busca de express\u00f5es para a vaz\u00e3o de oleo cru\nversus press\u00e3ao de fundo para po\u00e7cos produzindo por mecanismos de gas dissolvido (solution gas drive) em diferentes estagios de de-\nplec\u00e3o e diferentes caracter\u00edsticas de permeabilidade relativa, caracter\u00edstica do \u00f3leo produzido. Ele observou um comportamento adimensional muito similar para a maioria dos casos investigados e estabeleceu uma equac\u00e3o pr\u00f3tica que melhor se adequava.\n\u2014\u2014 = 1 - 0.2 f) - 0.8 f) .\t(2.90)\nqmax\tPr\tPr\nEsta equac\u00e7\u00e3ao era uma melhor ferramenta para analisar o comportamento de po\u00e7cos em reservat\u00edorios com mecanismo de produc\u00e7\u00e3ao do tipo g\u00edas em solu\u00e7c\u00e3ao do que a equac\u00e7\u00e3ao linear.\nEm 1973 M. J. Fetkovich propos outra forma de IPR onde assumia que a mobilidade () era uma simples funcao linear da press\u00e3o. (kro \u00e9 a permeabilidade relativa para a fase oleo fun\u00e7\u00e3o da satura\u00e7\u00e3o de oleo, So, ^o \u00e9 a viscosidade do \u00e1leo e Bo \u00e1e o fator de forma\u00e7ca\u00e3o do \u00e1oleo.) Fetkovich prop\u00f4os que\nkro(So)\nVoBo\n= aP.\n(2.91)\nA forma da fun\u00e7\u00e3o IPR de Fetkovich \u00e9\nn\nQo\nQom ax\n(2.92)\nEstudos mais recentes como o de Raghavan, [40] partem da ex-press\u00e3ao\nq\tpP feUSo) dp\n'\t= JP wf p.\u00b0bo\t(2.93)\nqomax\tPP kro(So) dp\nJo poBo dP\ne utilizam a suposi\u00e7c\u00e3ao da relac\u00e7\u00e3ao linear entre a mobilidade e a\npress\u00e3o para obter\nqo\t=\taPdP\nqo\u2122ax\tJp aPdP\nqo\t= (aP - aPWf)\n__2\nqomax\taP\nqo\nqomax\n(2.94)\nUma outra forma de IPR \u00e9 uma pequena altera\u00e7\u00e3o na equa\u00e7\u00e3o de Vogel proposta por Richardson and Shaw, [41], que permite uma maior flexibilidade de ajuste.\np2\nqo\t,\tpwf\tPwf\n= 1 - v - (1 -2\t(2.95)\nqomax\tP\tP\nSe a rela\u00e7ao linear da mobilidade com a pressao e modificada para incorporar um termo constante, mostra-se em [42] que existe uma depend\u00eancia de v com os valores da mobilidade.\n= a + 2bP.\n(2.96)\nMostra-se que o par\u00e2metro v na equac\u00e3o (2.95) torna-se\nv =\n2(\nkro (So )\n1-\u00edoBo\n)P=0\n( kro(So) )_\tI ( kro(So)\n( ^oBo\t) P = 0 + ( ^oBo\n)P\n(2.97)\nTrabalhos na busca de express\u00e3es IPR anal\u00edticas t\u00eam investido em pesquisas sobre o efeito das mudan\u00e7cas na mobilidade ao longo da vida produtiva do reservat\u00f3rio. Em [43] apresenta-se um procedimento para a obten\u00e7\u00e3o anal\u00edtica de IPR considerando o conhecimento da mobilidade e de suas derivadas em relac\u00e7\u00e3ao a press\u00e3ao media do reservatorio. Considerando o caso da fase oleo, por\nexemplo, obtem-se a express\u00e3o da vaz\u00e3o como\nJ \u00b0\nJ\u00b0 fP MS]\u00bfp onde\npwf PoBo\n2nkh\n(2.98)\nln( rw) - 3 + S\nPara um raio generico de poc\u00e7o pode-se considerar pwf = P. Para maior simplicidade faz-se uma troca de variaveis,\np = p - AP dP = -dAP.\n(2.99)\nOs limites de integra\u00e7ca\u00e3o s\u00e3ao mudados e a equa\u00e7c\u00e3ao para a vaza\u00e3o qo pode ser reescrita como\nqo = J\u00b0\tkro(So) dAP.\t(2.100)\nJq\tdoBO\nNormaliza-se a expressao multiplicando-se e dividindo-se por P.\n(2.101)\nPara facilitar a notacao define-se x = Neste caso a equa\u00e7ao (2.101) torna-se\nqo = J\u00b0P\tro^o) (x)dx.\t(2.102)\nJO\t\u00a1J>oBO\nA express\u00e3o para qo na equa\u00e7ao (2.102) pode ser aproximada por uma serie de Taylor.\ni=N\nqo = qo|(x=o)+\t-dp qo(x)\ni=1\n(2.103)\nAvaliando-se os termos da equacao (2.102):\n\u00edq\u00b0(x>\nx=0\nx=0\nx=0\n0\t(2.104)\njo p ( kro(So) A\n\\ poBo J (x=0)\nJO P1 d ( kro(So) A\n2 dx y ^oBo J (x=o)\nJOP1 d2\t( kro(So) A\n3! dx2 y f^oBo J (x=o)\nq (x)\t=\tjo P1 d\t(kr o (So n\ndxn o( ) x=0\tn! dxn-1 \\ PoBo )(x=0)\nEscrito em uma forma compacta\n^=n\tn\u20141\nqo = JOP\tj\u2014T\no\tn! dxn\u20141\nkro(So) A\nP-oBo J (x=0)\nxn\u20141\n(2.105)\nUm resultado muito importante \u00e9 obtido quando se calcula a vazao maxima com o objetivo de obter-se uma expressao normalizada, do tipo apresentada por Vogel. A vaz\u00e3o maxima sera aquela onde P = 0 ou x =\t= P-P = 1, isto e,\nqomax. =\n1 dn\u20141\nn! dxn\u20141 i=1\nkro(So)\\\nPoBo J (x=0)\n(2.106)\nObtem-se assim\nqo\nqo max\n=n 1 dn 1 ( kro(So) )\txn\u2014 1\n\u00bf^i=1 n! dxn 1 ( ^oBo )(x=0)x\n\u25a0s-^\u00ed=n 1 dn-1 ( kro(So) )\n= 1 n! dxn-1 ( ^oBo )(x=0)\n(2.107)\nseguinte express\u00e3o:\n<lo\nqomax\n= 1 + N1 (P) + N2(P)2 + N(P)3 + N(P)4, onde\n(2.108)\nN4\n1 d3 fcro(So),\n----------------|x=0\nN3\nN2\nNi\n24 dx3 ^oBo _ 1 d2 fcro (So)\n6 dx2 //oB,\n1\td kro (So) |\n2\tdx ^oBo x~u ' 2 dx2 ^oBo\nkro(Sok\td kro(So) |\n-\t|x = 0 +\tD |x = 0\n(2.109)\n|\t+\t1 d3 kro(So) |\n|x = 0 I z. 7\t3\tJ~i |x = 0\n'o\t6 dx3 poBo\n|\t, 1 d2 kro(So) |\t, 1 d3\n|x=0 +2 dx2 ,, b |x=0 +4 dx3 MoBo\nkro (So) I\n|x=0\n^o-Bo\tdx ^o-Bo\n1\td2 ( kroSo) |\t+ 1 d3 kro(So)\n2\tdx2\t^oBo x \"\t6 dx3 ^oBo\nI x=0\nkro(So) .\t+ 1 d kro(So) .\n|x=0 +2 dx poBo |x=0\nPoBo\n1 d3 kro(So) .\n24 dx3 poBo x=0\n1 d2 kro(so). _\n6 dx2 poBo x=0\n(2.110)\nD\no\n+\n+\nEstas express\u00f5es servem para validar as aproxima\u00e7\u00f5es polinomiais para as vaz\u00f5es de oleo do tipo\ni=n\tz \\ i\u20141\nqo(Pwf) = ^2 \"\u25a0' (\n(2.111)\nRela\u00e7ao IPR utilizada neste trabalho\nA rela\u00e7\u00e3o IPR utilizada neste trabalho considera a exist\u00eancia de uma parte da curva sendo descrita pela rela\u00e7\u00e3o linear para fluido subsaturado e outra parte para fluido saturado onde a press\u00e3o e temperatura de fundo caracteriza um ponto de opera\u00e7ao abaixo do ponto de bolha. Definem-se as seguintes vari\u00e1veis:\n\u2014\tPsat, Press\u00e3o de saturacao.\n\u2014\tqsat, Vazao de l\u00e1quido para press\u00e3o de fundo igual a press\u00e3o de saturac\u00e7\u00e3ao.\n\u2014\tQmax, Vaz\u00e3o m\u00e1xima de l\u00edquido para press\u00e3o de fundo igual a zero.\n\u2014\tpwf, Pressao na frente da zona canhoneada (Pressure well flowing).\nA equa\u00e7ao (2.112) mostra a rela\u00e7\u00e3o IPR utilizada. A express\u00e3o \u00e9 uma combina\u00e7\u00e3o de uma rela\u00e7\u00e3o linear para fluido subsaturado e a express\u00e3o de Vogel. Note-se que para pwf = psat tem-se a vazao igual a qsat e para pwf = 0 obtem-se a vazao maxima Qmax.\nq = qsat +\n(q\nmax\nqsat)\n0.2 pWf\npsat\n-0.8\u00cd pwf\\\npsat\n(2.112)\n1\nA figura 2.15 mostra um grafico t\u00e9pico para este tipo de representa\u00e7\u00e3o.\nFigura 2.15: IPR linear + Vogel\nEstrat\u00e9gia para a obten\u00e7ao da rela\u00e7ao atual qo, qa e qg x qinj\npo\u00e7o. Esta condi\u00e7\u00e3o e tipicamente a abertura total do choke de produ\u00e7c\u00e3ao e a manuten\u00e7c\u00e3ao da press\u00e3ao no separador.\nA atualiza\u00e7\u00e3o da rela\u00e7ao qo, qa e qg x Vazao de Injecao de gas deve ser realizada para que nos momentos de restri\u00e7c\u00e3ao na disponibilidade de gas para injec\u00e7\u00e3ao se possa levar os po\u00e7cos a operarem em pontos de opera\u00e7c\u00e3ao que se traduzam em uma opera\u00e7c\u00e3ao otima sob algum ponto de vista econ\u00f4mico. Testes de produc\u00e3o que necessitam da reduc\u00e7\u00e3ao da produ\u00e7ca\u00e3o dos po\u00e7cos n\u00e3ao s\u00e3ao bem vistos pelo setor de operac\u00e7o\u00e3es pois se traduzem em altos custos.\nCom a exist\u00f4encia da medi\u00e7c\u00e3ao da pressa\u00e3o de fundo e sua disponi-bilizac\u00e7\u00e3ao em um sistema de controle via rede pode-se conceber estrategias simples para a manuten\u00e7c\u00e3ao da opera\u00e7ca\u00e3o em pontos otimos para situa\u00e7\u00e3es em que n\u00e3o ocorram restri\u00e7\u00e3es. Uma ideia e realizar a aquisi\u00e7ca\u00e3o em regime permanente de alguns pontos (Vaz\u00e3o de injec\u00e3o, Press\u00e3o de Fundo) e levar o po\u00e7o a operar em um ponto onde a taxa de varia\u00e7c\u00e3ao da press\u00e3ao de fundo em relac\u00e7\u00e3ao a vazao de injecao seja zero (dpwf = 0). Este ponto corresponde ao ponto P\\ da figura 2.2 onde se mostra uma curva t\u00edpica relacionando tanto a vaza\u00e3o de produ\u00e7c\u00e3ao de oleo como a press\u00e3ao de fundo em func\u00e7\u00e3ao da vaz\u00e3ao de inje\u00e7c\u00e3ao de gas.\nEste procedimento pode ser suficiente quando n\u00e3ao existe restri\u00e7c\u00e3ao no fornecimento de gas e deseja-se otimizar a produ\u00e7c\u00e3ao de oleo sem levar em conta nenhum custo associado. Entretanto, para o caso em que ocorra uma restri\u00e7c\u00e3ao na disponibilidade de gas para inje\u00e7ca\u00e3o a aloca\u00e7ca\u00e3o de g as para cada poc\u00e7o necessita do conhecimento da relac\u00e7\u00e3ao entre a vaz\u00e3ao de produ\u00e7c\u00e3ao de oleo e a vaza\u00e3o de inje\u00e7ca\u00e3o de gas para cada po\u00e7co.\nA mesma necessidade existe caso se adote uma fun\u00e7c\u00e3ao objetivo que leva em conta o valor diferenciado da produc\u00e7\u00e3ao de oleo e gas, o custo de tratamento de agua e o custo da compress\u00e3ao do g as. Neste caso mesmo havendo disponibilidade total de g as o ponto otimo estara um pouco \u00e0 esquerda do ponto Pi da figura 2.2. A ideia e obter a rela\u00e7\u00e3o entre a Press\u00e3o de Fundo pwf e a Vaz\u00e3o de Inje\u00e7\u00e3o qinj, pwf = f (qinj) e entao utilizar o conhecimento dos par\u00f4metros da curva IPR, BSW e RGO para calcular as vaz\u00e3es de oleo, agua e gas em fun\u00e7\u00e3o de qinj conforme mostra a equac\u00e3o\n(2.113).\npwf \u2014 f (qinj ) qmin j\t&lt;qmax\nqinj \u2014 qtnj __ qinj\nqliq \u2014 qsat + (q max\n- qsat) 1 - 0.2pwf - 0.8\npsat\nf pwf\\ \\psat J\n2\"\nqo \u2014 (1 - BSW)qiiq\nqg \u2014 RGO(1 - BSW)qiiq qa \u2014 BSWqiiq\n(2.113)\nAs vaz\u00f5es expressas pela equa\u00e7\u00e3o (2.113) estao em unidades de volume por unidade de tempo em condi\u00e7\u00f5es padr\u00e3o de temperatura e pressao e podem ser convertidas facilmente para unidades de massa por tempo. O procedimento descrito pela equa\u00e7\u00e3o\n(2.113)\t\u00e9 de amplo conhecimento da industria do petr\u00f3leo mas sua aplica\u00e7\u00e3o torna-se fact\u00e9vel com a medi\u00e7\u00e3o da press\u00e3o de fundo. Para automatizar o procedimento de identifica\u00e7\u00e3o da rela\u00e7\u00e3o pwf = f (q\u00ednj) e diminuir a perda de produ\u00e7ao elaborou-se a seguinte estrat\u00e9gia. A estrategia proposta consiste nas seguintes etapas:\n1\tAplica\u00e7c\u00e3ao de um procedimento de busca do ponto de pressa\u00e3o\nde fundo m\u00ednima (pWf e a vaz\u00e3o de injecao correspondente q*nj tal que\t\\(Pwf\t)= 0 ).\n2\tProcedimento de aquisi\u00e7\u00e3o de pontos (pwf, qinj) nas proximidades do ponto (pWf, q*nj). A ideia \u00e9 fazer a aquisi\u00e7\u00e3o de pontos de forma que o valor de pwf n\u00e3o se afaste demasiado de pWf.\n3\tObten\u00e7\u00e3o da curva estendida pwf = f (qinj) com os pontos\nobtidos. A curva estendida visa extrapolar a rela\u00e7c\u00e3ao pwf = f (qinj) e cobrir todos os pontos operacionais\t&lt;qinj&lt;\nqmax )\nqinj ).\n4\tObten\u00e7\u00e3o da curva WPC a partir da curva estendida pwf = f (qinj) e dos par\u00e2metros IPR, BSW e RGO conforme equa\u00e7\u00e3o\n(2.113).\nE importante que as condi\u00e7\u00e3es de superf\u00edcie sejam mantidas durante os testes para a aquisi\u00e7\u00e3o dos pontos (pwf, qinj).\nPara o item 1 da estrat\u00e9gia prop\u00e3e-se um procedimento automatizado no controle da vaz\u00e3ao de inje\u00e7ca\u00e3o para a aquisi\u00e7ca\u00e3o do par\n(Press\u00e3o de Fundo, Vaz\u00e3o de Inje\u00e7\u00e3o) em regime permanente. Para tornar o procedimento mais eficiente e melhorar a qualidade dos dados obtidos a proposta e estabelecer uma janela de tempo onde os valores m\u00e9dios das duas vari\u00e1veis e suas vari\u00e2ncias s\u00e3o calculadas. O valor m\u00e9dio aceito para o teste \u00e9 aquele onde a vari\u00e2ncia estabilizou-se.\nA atualiza\u00e7\u00e3o dos par\u00e2metros da rela\u00e7ao IPR, BSW e RGO continuam necessitando do direcionamento da produ\u00e7c\u00e3ao do po\u00e7co para um separador de teste. Para minimizar a perda de produc\u00e7a\u00e3o poderia ser interessante alternar testes onde o po\u00e7co \u00e9e operado somente no ponto (pWf, Qinj) e testes com a opera\u00e7ao em pelo menos dois pontos onde o segundo ponto seria aquele com a maior press\u00e3ao de fundo atingida no teste para identifica\u00e7\u00e3o de pwf = f (qinj).\nA partir do resultado dos testes pode-se atualizar os valores de BSW, RGO e reavaliar os par\u00e2metros da curva IPR.\nConsiderando-se que a press\u00e3o de satura\u00e7\u00e3o, psat, mantenha-se constante busca-se a atualiza\u00e7ca\u00e3o de dois par\u00e2ametros da curva IPR qsat e qmax. E claro que os dois par\u00e2metros seriam melhor avaliados com a coloca\u00e7c\u00e3ao do poc\u00e7o em funcionamento em dois ou mais pontos de press\u00e3ao de fundo diferentes. Entretanto uma alternativa \u00e9e utilizar somente o teste de produ\u00e7ca\u00e3o para a press\u00e3ao de fundo m\u00ednima (m\u00e1xima produ\u00e7\u00e3o) o que evitaria qualquer perda de produ\u00e7\u00e3o. Como s\u00e3o dois par\u00e2metros a serem determinados precisaria-se de testes com pelo menos duas press\u00e3oes de fundo diferentes para sua determina\u00e7\u00e3o. Uma alternativa \u00e9 considerar que a rela\u00e7ao entre qmax e qsat se mantenha, isto \u00e9, q^*2 = q^^q1 = k. Neste caso pode-se determinar os valores atualizados de qmax e qsat sem perda de produ\u00e7ca\u00e3o.\nA estrat\u00e9egia para a atualiza\u00e7c\u00e3ao dos para\u00e2metros IPR, BSW e RGO pode considerar testes com 1 ponto alternados com testes de 2 pontos sendo que cada vez se faria tamb\u00e9em o levantamento dos pontos (pwf, qinj) para a obten\u00e7\u00e3o da rela\u00e7ao estendida pwf = f (qinj b\nO Modelo Matem\u00e1tico pwf = f (qinj)\nA busca por uma fun\u00e7c\u00e3ao matem\u00e9atica que possa descrever o comportamento da pressa\u00e3o de fundo em func\u00e7a\u00e3o da vaz\u00e3ao de inje\u00e7c\u00e3ao de g\u00e1s e orientada pelas seguintes observa\u00e7\u00f5es:\n\u2014\tBusca-se uma fun\u00e7\u00e3o que possa ser utilizada para extrapolar valores de press\u00e3o de fundo.\n\u2014\tO ajuste da curva devera ser feito com poucos pontos.\n\u2014\tSeria desejavel que a tecnica de ajuste permitisse a inser\u00e7ao de conhecimento sobre o processo.\nDiversas fun\u00e7\u00e3es foram testadas como func\u00e3es polinomiais, trigonometri-cas e exponenciais. Finalmente a seguinte fun\u00e7\u00e3o mostrou-se capaz de absorver a rela\u00e7\u00e3o para uma diferente gama de condi\u00e7\u00f5es:\nye\tpwf * pwf\t\nqi\tqinj\t\nU'\t\t\nye\t= \u00a9ie-f (\u201c\u201902) + \u00a92 + \u00a93u2,\t(2.114)\nonde p*wf e q*nj s\u00e3o respectivamente os valores de pwf e qinj onde dPwf = 0, \u00a9i, \u00a92, \u00a93 e \u00a94 sao par\u00e2metros ajustaveis como sera &amp;Qinj\nvisto a seguir.\nA fun\u00e7\u00e3o combina uma exponencial com uma fun\u00e7\u00e3o quadr\u00e1tica. A exponencial decrescente somada a funcao quadratica vai apresentar um ponto de m\u00ednimo como acontece com a fun\u00e7\u00e3o desejada. Alem disso, tanto a funcao exponencial como a func\u00e3o quadratica tem a capacidade de extrapola\u00e7c\u00e3ao muito boa quando comparadas, por exemplo, com express\u00e3oes polinomiais de ordem maior que 2. Alem disso a soma das duas func\u00e3es busca uma representa\u00e7c\u00e3ao onde predomine o decaimento para valores baixos de u e que a partir de um valor predomine o crescimento representando assim a diminuic\u00e3o devido a gravidade sendo dominada depois pelo crescimento devido ao atrito. Diversas fun\u00e7\u00e3es expoentes f (u) foram testadas desde a mais simples como f (u) = u, f (u) = \u00a92u, etc., mas um bom ajuste so pode ser obtido com a funcao f (u) = \u00a92um. O modelo final proposto torna-se ent\u00e3o\nye\nu\nye\npwf pWf qinj q* \u25a0\ninj\n\u00a9le-02\"\u2122 + \u00a93 + \u00a94u2,\n(2.115)\nonde m realiza uma forma de transforma\u00e7\u00e3o sobre a vari\u00e1vel vaz\u00e3o de inje\u00e7\u00e3o e depende das caracter\u00edsticas de cada po\u00e7o como sera apresentado na sequ\u00eancia.\nO ajuste dos par\u00e2metros do modelo\nO ajuste dos par\u00eaametros do modelo foi colocado como um problema de programa\u00e7\u00e3o quadr\u00e1tica sequencial. Inicialmente a matriz com n pares (pwf ,qinj) foi normalizada dividindo-se todas as pressoes pela pressao pwf e todas as vazoes por q*nj onde (pwf,qinj) e o ponto onde\t= 0. Este procedimento visa\nevitar problemas numericos. Partindo-se de um conjunto de pa-r\u00eametros iniciais &amp; = [ \u00a91 \u00a92 \u00a93 \u00a94 ] e dos n elementos de entrada ui, (i = 1 : n), calcula-se o vetor com os valores estimados Ye. A diferenca entre os valores reais Y e os valores estimados Ye e definida como o vetor de erros E = Y \u2014 Ye,\nE = Y - Ye\nyi - yei\ny2 - ye2\nyn - yen\n(2.116)\nA cada iterac\u00e7\u00e3ao calcula-se a variac\u00e7\u00e3ao otima do vetor de par\u00eaame-tros A&amp; que somada ao vetor &amp; ira anular uma frac\u00e3o p do vetor erro E . Ou seja, a cada iterac\u00e7a\u00e3o minimiza-se a seguinte func\u00e7a\u00e3o objetivo\nJ = (pE \u2014 HA&amp;)t (pE \u2014 HA&amp;).\t(2.117)\nNesta expressao p e um escalar entre 0.01 e 0.05 e corresponde a fra\u00e7\u00e3o do erro a ser anulado a cada iterac\u00e3o. H e o Jacobiano onde cada linha e o gradiente da sa\u00edda em rela\u00e7\u00e3o aos par\u00e2metros &amp;.\nH\n\" \u00f4pwf\t\t9pwf\t\t9pwf\t\t9pwf\n\u00d4\u00a91\tU=U1\td\u00a92\tU=U1\td\u00a93\tU=U1\t\u00d4\u00a94\n9pwf\t\t9pwf\t\t9pwf\t\t9pwf\nd\u00a9i\tU=U2\td\u00a92\tU=U2\td\u00a93\tU=U2\td\u00a94\n9pwf\t\t9pwf\t\t9pwf\t\t9pwf\n. d\u00a9i\tu=un\td\u00a92\tu=un\td\u00a93\tu=un\td\u00a94\nI U = Un\nI U=U1\n1 U=U2\n(2.118)\nOs elementos do gradiente s\u00e3o calculados a cada itera\u00e7\u00e3o como\ndye | dex 1\nU=U1\ne-02U\ndye | de21\nU=U1\n-e^e-0^\ndye | des1\nU=U1\ndye | de 41\nU= U1\n(2.119)\n1\nu\n2\n1\n1\n1\nA funcao objetivo expressa pela equa\u00e7ao (2.118) pode ser reescrita como\nJ = A\u00a9tHtHA\u00a9 - 2(3EtHA\u00a9 + p2ETE\t(2.120)\nDesprezando-se o termo p2EtE que n\u00e3o apresenta rela\u00e7ao com A\u00a9, pode-se expressar a funcao objetivo como um problema cl\u00e1ssico de programac\u00e7\u00e3ao quadr\u00e1atica a ser resolvido a cada itera\u00e7c\u00e3ao,\nA\u00a9\t= arg min J\ns. a.\nJ = |a\u00a9tHtha\u00a9 - PEtha\u00a9\n\u00a9min &lt;\u00a9ant + A\u00a9 &lt;\u00a9max\t(2.121)\nA vantagem da utiliza\u00e7\u00e3o da formula\u00e7\u00e3o em programa\u00e7\u00e3o quadr\u00e1tica ficara evidente na sequencia da exposi\u00e7\u00e3o deste trabalho.\nUtiliza\u00e7ao do Conhecimento das Caracter\u00edsticas do Po\u00e7o\nUm par\u00e2metro importante para o ajuste do modelo \u00f3 a press\u00e3o est\u00edtica da formac\u00e3o, Pest.\u2022 Existe normalmente um conhecimento aproximado de seu valor. Este valor pode ser modelado como sendo igual a um valor nominal, Pest-N, acrescido de uma incerteza, \u00b1ePest-N. O valor de Pest pode entao ser expresso pela equa\u00e7ao (2.122),\nPest-N(1 \u2014 e) &lt;Pest &lt;Pest-N(1 + e) \u2022\t(2.122)\nPara pocos n\u00e3o surgentes este conhecimento pode ser incorporado\nao problema de ajuste na formulac\u00e3o da programa\u00e7\u00e3o quadr\u00e1tica sequencial na forma de uma restri\u00e7ao. Para isso obtem-se o valor da equa\u00e7\u00e3o (2.115) para u = 0 que corresponde a press\u00e3o de fundo para vazao de injecao nula. E importante mencionar que a rela\u00e7\u00e3o pwf x qinj em regime permanente nao contempla todos os pontos existentes entre qinj = q*nj ate qinj = 0. Existem valores de vaz\u00e3ao de inje\u00e7c\u00e3ao de gas que na\u00e3o s\u00e3ao realizaveis pois existe um limite m\u00e9nimo para a vaz\u00e3o de injec\u00e3o que possibilita a eleva\u00e7\u00e3o de fluido. Mesmo antes deste limite o comportamento din\u00e2mico das vaz\u00e3oes torna-se muito oscilatorio e seria necessario a aplica\u00e7c\u00e3ao de controle ativo para a manuten\u00e7c\u00e3ao da operac\u00e7\u00e3ao. Entretanto, para um poc\u00e7o n\u00e3ao surgente, pode-se imaginar que a curva de regime permanente teria a tendencia de chegar a pressao de fundo igual a press\u00e3ao estatica para vaz\u00e3ao de injec\u00e7\u00e3ao nula. Assim, para valores de vaz\u00e3ao de inje\u00e7c\u00e3ao de gas bem maiores do que a vaz\u00e3ao que leva o po\u00e7o a oscilac\u00f5es sustentadas este procedimento \u00e9 razo\u00e1vel.\nDesta forma a equac\u00e3o (2.115) para u = 0 torna-se\ny(0) = ex + 03 = Pest.\t(2.123)\nCombinando-se a equa\u00e7ao (2.122) com a equa\u00e7\u00e3o (2.123) obtem-se\nPest-N(1 \u2014 e) &lt;ei + 03 &lt;Pest-N(1 + e)\ncomo\nei = eiant + A0!\n03 = 03ant + A03\nPest-N(1 \u2014 e) &lt;eiant + A01 + 03ant + A03\nPest-N(1 + \u00ca) > eiant + Aei + e3ant + Ae3\t(2 + 24)\nPara colocar no formato adequado para o algoritmo de progra-mac\u00e3o quadr\u00e1tica sequencial, introduz-se a desigualdade expressa pela equa\u00e7ao (2.124) como uma restri\u00e7\u00e3o na formula\u00e7ao do problema de otimiza\u00e7c\u00e3ao\nA\u00a9 = arg min J\ns. a.\nJ = 'a\u00a9 T HtHA\u00a9 -\tHA\u00a9\n2\t1\nA\u00a91 + A\u00a93 &lt;Pest-N (1 + e) \u2014 \u00ae1ant \u2014 \u00ae3ant\n\u2014 A\u00a91 \u2014 A\u00a93 &lt;\u2014Pest-N (1 \u2014 e) + \u00a91ant + \u00ae3ant\t(2.125)\nCom este procedimento pode-se incorporar ao algoritmo de ajuste dos par\u00e2metros as informa\u00e7\u00e3es dispon\u00edveis na seguinte formula\u00e7\u00e3o do problema:\nAjuste os par\u00e2metros da fun\u00e7\u00e3o expressa pela equa\u00e7\u00e3o (2.115) para o conjunto de pontos adquiridos em regime permanente do po\u00e7o ndo surgente i que apresenta um BSW aproximado de BSWi, um RGO em torno de RGOi e uma press\u00e3o est\u00e1tica nominal de Pest.Ni com uma incerteza de e100%.\nNos casos de po\u00e7os surgentes n\u00e3o se aplicam as restri\u00e7\u00f5es mas pode-se igualmente encontrar os par\u00e2metros do modelo.\nResultados Obtidos\nPara o estudo realizado na busca de uma metodologia para a obten\u00e7\u00e3o do expoente m da equa\u00e7ao (2.115) utilizaram-se todos os pares (pwf, qinj) gerados com o simulador de po\u00e7os para GLC em regime permanente Marlim. Inicialmente um po\u00e7o foi instanciado com caracter\u00edsticas representativas de po\u00e7os reais e variou-se os par\u00e2metros BSW e RGO em 8 diferentes combina\u00e7\u00e3es. Para cada caso obteve-se valores de vaza\u00e3o de produc\u00e7\u00e3ao e agua oleo e gas e press\u00e3ao de fundo para diferentes valores de vaz\u00e3ao de inje\u00e7c\u00e3ao de gas. A tabela 2.4 mostra os cenarios utilizados para a gera\u00e7\u00e3o dos dados utilizados neste estudo.\nTabela 2.4: Par\u00e2metros utilizados nos testes realizados com o simulador\nMarlim\nTeste\tBSW [%]\tRGO\n1\t15\t79\n2\t45\t79\n3\t58\t79\n4\t75\t79\n5\t85\t79\n6\t58\t50\n7\t58\t80\n8\t58\t105\navaliac\u00e3o da qualidade do ajuste, entretanto, utilizou-se todos os pontos dispon\u00edveis buscando assim determinar a capacidade de extrapola\u00e7\u00e3o da func\u00e3o identificada com poucos pontos.\nPara avaliar a qualidade do ajuste utilizou-se o fator R definido como\n1 -\nR =\n\nEL(y(\u00bb) - ye(i))2\nN=i(y(i) - y)2\n(2.126)\nonde N e o nUmero de pontos utilizados na identifica\u00e7\u00e3o, y representa o valor medio dos N valores das press\u00e3es y e ye e o valor estimado da press\u00e3o de fundo obtido com o modelo. As figuras 2.16 e 2.17 mostram o ajuste obtido para os dados dos pocos 1 a 4 e 5 a 8 respectivamente. Mais uma vez \u00e9 importante observar que a curva foi ajustada com os pontos mostrados em circulos pretos. Estes pontos foram selecionados de forma que a press\u00e3o maxima n\u00e3o atingisse mais do que 1% do valor otimo irrestrito (press\u00e3o m\u00ednima no fundo). Os pontos mostrados em circulos claros n\u00e3o foram utilizados para a identifica\u00e7c\u00e3ao dos para\u00e2metros dos modelos. Observa-se que a curva ajustada consegue extrapolar muito bem passando muito proximo a estes pontos.\nA fim de melhor avaliar o modelo proposto foi gerado dados de um grupo de po\u00e7cos com configurac\u00e7\u00e3oes completamente diferentes\nPress\u00e3o de fundo [ Kgf/cm2]\tPress\u00e3o de fundo [ Kgf/cm2]\tPress\u00e3o de fundo [ Kgf/cm2]\tPress\u00e3o de fundo [ Kgf/cm2]\nAjuste para conjunto de pontos 1-BSW=15%, RGO=79\nVaz\u00e3o de inje\u00e7\u00e3o [ m3/d * 1000 ]\nAjuste para conjunto de pontos 4-BSW=58%, RGO=79\nVaz\u00e3o de inje\u00e7\u00e3o [ m3/d * 1000 ]\nAjuste para conjunto de pontos 3-BSW=45%, RGO=79\nAjuste para conjunto de pontos 5-BSW=75%, RGO=79\nFigura 2.16: pwf = f (qinj) para pocos UFSC-1 a 4\nAjuste para conjunto de pontos 6-BSW=85%, RGO=79\nAjuste para conjunto de pontos 7-BSW=58%, RGO=50\nAjuste para conjunto de pontos 9-BSW=58%, RGO=105\nFT 2801\nE\n\u2019\u00ea, 260\nVaz\u00e3o de inje\u00e7\u00e3o [ m3/d * 1000 ]\nAjuste para conjunto de pontos 8-BSW=58%, RGO=80\nVaz\u00e3o de inje\u00e7\u00e3o [ m3/d * 1000 ]\n240\n220\n200\nO \u25a0Q\n\t\tPress\u00e3o de fundo estimada o Dados n\u00e3o utilizados p/ ajuste o Dados utilizados para ajuste\t\t\t\nV\t R=0.9996\t\t\t\t\n\t\t\t\t\n1801\n0\t100\t200\t300\t400\nVaz\u00e3o de inje\u00e7\u00e3o [ m3/d * 1000 ]\nFigura 2.17: pwf = f (qinj) para po\u00e7os UFSC-5 a 8\nentre si. Os dados de simula\u00e7c\u00e3ao disponibilizados s\u00e3ao Pressa\u00e3o de revestimento, Vaz\u00e3o de L\u00edquido produzido e Vazao de Inje\u00e7\u00e3o de\nG\u00e1s. Com estes dados deve-se obter a press\u00e3o de fundo pwf. Para isso deve-se utiliza-se a expressa\u00e3o para IPR combinada,\nqliq\tIP (Pest.\tpwf) para pwf > Psati e\t(2.127)\nqliq\nqsat + (qmax\n- qsat )\n0.2( pWf)\npsat\n0.8( pWf )2\npsat\n1\npara pwf &lt;Psat-\nPara os casos onde a press\u00e3ao est\u00e9atica \u00e9e menor que a press\u00e3ao de satura\u00e7c\u00e3ao o po\u00e7co vai operar sempre em regime saturado e a ex-press\u00e3ao para Vogel pode ser utilizada diretamente.\n- Poco UFSC-15\nCaracter\u00edsticas do Po\u00e7o UFSC-15\n\u2014\tPoco direcional\n\u2014\tPressao estatica:246.0\ncm2\n\u2014\tPressao de saturacao:224.8\ncm2\n\u2014 Pressao de Teste:245.0\nKgf cm2\n\u2014 Vazao de Teste:76.0 m3/d\n- RGOf:100.0 m3/m3\n- oAPI:24.7\n- BSW:60.3 %\n\u2014\tDensidade relativa da agua produzida:1.06\n\u2014\tDensidade relativa do g\u00e1s de formacao:0.619\n\u2014\tDensidade relativa do gas de injecao:0.780\n\u2014\tPress\u00e3o na superf\u00edcie:14.0\ncm2\nA tabela 2.5 apresenta os dados obtidos com a simula\u00e7c\u00e3ao do Po\u00e7co UFSC-15\nTabela 2.5: Dados do Po\u00e7o UFSC-15\nPressao Revest.\tQ\tm3 Qiiq.\td\tqinj\td\n128\t883.9\t37716.5\n133\t901.7\t53726.3\n143\t909.2\t73368.3\n158\t917.6\t107736.7\n173\t916.1\t174140.5\n188\t893.5\t211629.6\n203\t870.1\t240490.5\n233\t827.9\t284198.2\n263\t793.5\t316652\n293\t765.8\t342311.8\n323\t742.2\t364269.3\nFigura 2.18: pwf = f (qinj) para po\u00e7o UFSC-15\nTabela 2.6: Par\u00e2metros identificados para os dados do Po\u00e7o UFSC-15\n\u00a91\t\u00a92\t\u00a93\t\u00a94\tm\n0.0539\t1.5710\t0.9872\t0.0013\t0.175\n\u2014\tPress\u00e3o estatica:199.0\ncm\u00bf\n\u2014\tPress\u00e3o de saturacao:242.1\n\u2014\tRGOf:100.0 m3/m3\n\u2014\toAPI:29.0\n\u2014\tBSW:67.6 %\n\u2014\tDensidade relativa da agua produzida:1.06\n\u2014\tDensidade relativa do g\u00e1as de formac\u00e7a\u00e3o:0.790\n\u2014\tDensidade relativa do gas de injecao:0.780\n\u2014\tPress\u00e3o na superf\u00edcie:16.5\nr\tcm2\nA tabela 2.7 apresenta os dados obtidos com a simula\u00e7c\u00e3ao do Po\u00e7co UFSC-17\nTabela 2.7: Dados do Po\u00e7o UFSC-17\nPressao Revest.\tqiiq.\td\tqinj m\n132.81\t708.6\t35068\n140.81\t881.8\t62482.6\n148.81\t929.2\t77396.4\n156.81\t941.6\t185925.1\n173.81\t934.7\t214444.4\n188.81\t927\t234465.9\n198.81\t921.5\t246217.3\n223.81\t907.3\t271690.1\n248.81\t893.7\t293446.1\n298.81\t867.5\t332277.5\n348.81\t841.7\t367381.9\nA tabela 2.8 apresenta os par\u00e2metros identificados para o ajuste dos dados do poco UFSC-17:\nTabela 2.8: Par\u00e2metros identificados para os dados do Poco UFSC-17\nei\te2\tes\te4\tm\n0.0729\t7.5665\t0.9966\t0.0030\t1.1100\n- Poco UFSC-20\nCaracter\u00edsticas do po\u00e7o UFSC-20\nFigura 2.19: pwf = f (qinj) para po\u00e7o UFSC-17\n\u2014\tPo\u00e7o direcional\n\u2014\tPress\u00e3o estatica:197.0\ncm2\n\u2014\tPress\u00e3o de satura\u00e7\u00e3o:247.1\ncm2\n\u2014\tRGOf:100.0 m3/m3\n- oAPI:27.5\n\u2014\tBSW:79.7 %\n\u2014\tDensidade relativa da agua produzida:1.06\n\u2014\tDensidade relativa do gas de forma\u00e7ao:0.770\n\u2014\tDensidade relativa do gas de inje\u00e7\u00e3o:0.780\n\u2014\tPressao na superf\u00edcie:12.8\ncm2\nA tabela 2.9 apresenta os dados obtidos com a simula\u00e7c\u00e3ao do Po\u00e7co UFSC-20\nA tabela 2.10 apresenta os par\u00e2metros identificados para o ajuste dos dados do po\u00e7o UFSC-20:\n-\tPoco UFSC-21\nCaracter\u00edsticas do poco UFSC-21\n-\tPoc\u00e7o direcional\n\u2014 Press\u00e3o estatica:203.7\nTabela 2.9: Dados do Po\u00e7o UFSC-20\nPressao Revest.\tq\tm\u00bf qiiq- d\tqinj m\n115.54\t451.9\t36540.3\n130.54\t500\t73096.5\n140.54\t458.2\t176527.4\n145.54\t453.8\t186109.9\n155.54\t444.7\t203169.2\n160.54\t440.6\t210367\n165.54\t436.6\t217520.1\n175.54\t429.1\t230555.3\n190.54\t419\t247669.4\n215.54\t404.5\t272181.1\n265.54\t380.3\t314010.8\nFigura 2.20: pwf \u2014 f (qinj) para po\u00e7o UFSC-20\nTabela 2.10: Par\u00e2metros identificados para os dados do Poco UFSC-20\n\t\u00a92\t\u00a93\t\u00a94\tm\n0.2374\t8.8801\t1.0008\t0.0033\t1.9000\n\u2014 Press\u00e3o de saturacao:251.0\n- IP:7.7\nm3/d kgf / cm2\n- c=0.2\n\u2014\tRGOf:113.0 m3/m3\n-\toAPI:27.5\n\u2014\tBSW:34.1 %\n\u2014\tDensidade relativa da agua produzida:1.06\n\u2014\tDensidade relativa do gas de formacao:0.760\n\u2014\tDensidade relativa do gas de injecao:0.770\n\u2014\tPress\u00e3o na superf\u00edcie:13.0\ncm2\nA tabela 2.11 apresenta os dados obtidos com a simulacao do Po\u00e7o UFSC-21\nTabela 2.11: Dados do Po\u00e7o UFSC-21\nPress\u00e3o Revest. Kgf2- cm2\tq qlzq.\td\tqinj md\n97.4\t557.3\t50875.1\n107.4\t567.4\t67173.1\n117.4\t572.5\t78600.6\n122.4\t574\t83308.3\n137.4\t567.8\t187204.6\n147.4\t566.6\t199916.1\n172.4\t562.8\t228684.3\n197.4\t556.7\t254373.1\n247.4\t540.9\t299280.9\n297.4\t526.2\t338377.9\n322.4\t519.3\t356386.6\nA tabela 2.12 apresenta os par\u00e2metros identificados para o ajuste dos dados do po\u00e7co UFSC-21:\nTabela 2.12: Par\u00e2metros identificados para os dados do Po\u00e7o UFSC-21\n\u00a91\t\u00a92\t\u00a93\t\u00a94\tm\n0.9038\t3.5017\t0.9666\t0.0075\t0.5600\nFigura 2.21: pwf = f (qinj) para poco UFSC-21\n- Poco UFSC-23\nCaracter\u00edsticas do poco UFSC-23\n\u2014\tPoco direcional\n\u2014\tPress\u00e3o estatica:205.0\ncm2\n\u2014 Pressao de satura\u00e7ao:242.1\nKgf cm2\n\u2014 IP:16.0\nm3 /d kgf / cm2\n\u2014 c=0.2\n\u2014\tRGOf:100.0 m3/m3\n\u2014\toAPI:26.1\n\u2014 BSW:48.8 %\n\u2014\tDensidade relativa da agua produzida:1.06\n\u2014\tDensidade relativa do gas de formacao:0.750\n\u2014\tDensidade relativa do gas de injec\u00e3o:0.780\n\u2014\tPressao na superf\u00edcie:13.1\ncm2\nA tabela 2.13 mostra os dados obtidos com a simula\u00e7ao do Poco UFSC-23\nA tabela 2.14 apresenta os par\u00e2metros identificados para o ajuste dos dados do poc\u00e7o UFSC-23:\nTabela 2.13: Dados do Po\u00e7o UFSC-23\nPressao Revest.\tq qiiq-\td\tqinj m\n110\t784.1\t51304.7\n120\t801.8\t68982.2\n135\t811.9\t86840.5\n150\t817.7\t99786.2\n160\t783.8\t206224.5\n185\t766.6\t239616.6\n210\t755.4\t263522.4\n240\t743.9\t289697.4\n260\t735.4\t305919.2\n305\t716.4\t339712.9\n335\t704.5\t360586.4\nFigura 2.22: pwf = f (qinj) para poco UFSC-23\nTabela 2.14: Par\u00e2metros identificados para os dados do Poco UFSC-23\n\u00a91\t\u00a92\t\u00a93\t\u00a94\tm\n0.3886\t5.8173\t0.9971\t0.0052\t1.0400\n- Poco UFSC-75\nCaracter\u00edsticas do po\u00e7o UFSC-75\n\u2014\tPoco vertical\n\u2014\tPress\u00e3o estatica:217.2\ncm2\n\u2014 Press\u00e3o de saturacao:197.7 Kgf\ncm2\n- IP:42.9\nm3 /d kgf / cm2\n- c=0.2\n\u2014\tRGOf:100.0 m3/m3\n-\toAPI:29.7\n\u2014 BSW:3 %\n\u2014\tDensidade relativa da agua produzida:1.07\n\u2014\tDensidade relativa do g\u00e1s de formacao:0.860\n\u2014\tDensidade relativa do gas de injecao:0.780\n\u2014\tPress\u00e3o na superf\u00edcie:15.6\ncm2\nA tabela 2.15 mostra os dados obtidos com a simula\u00e7\u00e3o do Poco UFSC-75 A tabela 2.16 apresenta os par\u00e2metros identificados\nTabela 2.15: Dados do Po\u00e7o UFSC-75\nPress\u00e3o Revest. Kgf- cm2\tq\tm3 qliq-\td\tqinj m\n134.11\t1424.9\t112379.1\n144.11\t1447\t226058.7\n159.11\t1448.5\t266148.8\n174.11\t1444.7\t297014.5\n184.11\t1440.9\t314410.8\n209.11\t1429.7\t350476.4\n234.11\t1417.7\t379901.1\n259.11\t1405.5\t405699.7\n284.11\t1392.9\t429936\n334.11\t1366.8\t474798.1\n359.11\t1353.6\t495788.5\npara o ajuste dos dados do po\u00e7o UFSC-75:\nFigura 2.23: pwf \u2014 f (qinj) para poco UFSC-75\nTabela 2.16: Par\u00eametros identificados para os dados do Po\u00e7o UFSC-75\n\u00a91\t\u00a92\t\u00a93\t\u00a94\tm\n0.4005\t0.6138\t0.7748\t0.0083\t0.0900\nAdapta\u00e7ao do modelo para po\u00e7os altamente depletados\nPara po\u00e7cos n\u00e3ao surgentes o modelo desenvolvido considera a pressa\u00e3o de fundo igual a pressao estatica correspondendo a vazao de in-jec\u00e3o de gas nula na obten\u00e7ao da fun\u00e7ao pwf = f (qinj) em regime permanente. Na pratica isto e razo avel para po\u00e7cos onde a pressa\u00e3o estatica encontra-se pouco abaixo do limiar de surg\u00eancia. De acordo com os resultados obtidos na se\u00e7\u00e3o 2.2.1 e apresentados na figura 2.11, ao diminuir-se a vazao de injecao atinge-se um valor onde o metodo GLC nao consegue estabelecer uma pressao de fundo menor do que a press\u00e3ao estatica em regime permanente.\n11 MPa tem-se uma vaz\u00e3o m\u00ednima igual a 0.41 kg/s. Definindo ^inj como a m\u00ednima vazao de inje\u00e7\u00e3o realizavel com GLC, tem-se para o po\u00e7o exemplo, q\"j = 0.41 kg/s com Pr = 11 MPa. Nestes casos, antes de iniciar o procedimento de identifica\u00e7\u00e3o efetua-se uma primeira transforma\u00e7\u00e3o nas vaz\u00e3es de injec\u00e3o a serem utilizadas na obtenc\u00e3o do modelo subtraindo q\u2122r dos valores de vaz\u00e3o obtidos para obter q^-,\nqLj = qinj - qmj\t(2.128)\nA partir deste ponto utiliza-se todos os procedimentos j\u00e1 descritos. Isto \u00e1, obtem os valores que correspondem ao ponto de m\u00ednimo pwf, agora com os valores de vaz\u00e3o de inje\u00e7\u00e3o j\u00e1 diminu\u00eddos de q\u2122r, (q.\" j,PWf)\u2022 A normalizacao das vaz\u00f5es e da pressao de fundo \u00e1 feita com (q\u201cj e p*wf), respectivamente.\nFigura 2.24: pwf = f (qinj) para poco exemplo com Pr = 11.0 MPa\nTabela 2.17: Par\u00e2metros identificados para os dados do exemplo [1]\n\u00a91\t\u00a92\t\u00a93\t\u00a94\tm\n0.2281\t2.1125\t0.9430\t0.0293\t1.0\n2.2.3\tUm modelo din\u00e2mico para controle e otimiza\u00e7\u00e3o\nOs modelos matem\u00e1ticos servem a diferentes objetivos. O modelo fenomenol\u00f3gi- co \u00e1 importante para se conhecer o processo em profundidade e permitir uma an\u00e1lise param\u00e1trica com o objetivo de melhorar o seu desempenho, por exemplo. O modelo em regime permanente \u00e1 muito utilizado em algoritmos de otimiza\u00e7\u00e3o, principalmente para processos est\u00e1veis e que operam neste regime a maior parte do tempo. Para finalizar a discuss\u00e3o de modelos para processos GLC, prop\u00e3e-se nesta se\u00e7\u00e3o um modelo din\u00e2amico que utiliza o desenvolvimento realizado na se\u00e7ca\u00e3o anterior mas que acrescenta um comportamento dina\u00e2mico. O objetivo deste modelo \u00e1 ser o mais preciso poss\u00edvel em regime permanente para permitir a utiliza\u00e7c\u00e3ao do modelo em uma estrat\u00e1egia de controle preditivo que visa otimizar a distribui\u00e7c\u00e3ao de g\u00e1as enquanto atenua as oscila\u00e7c\u00e3oes causadas por varia\u00e7c\u00e3oes na disponibilidade de g\u00e1as.\nO modelo aqui descrito \u00e1e muito semelhante aquele apresentado em [44], exceto pela considera\u00e7ao de pocos altamente depletados discutidos na sec\u00e7\u00e3ao anterior.\nA ideia \u00e1 utilizar um modelo Hammerstein [45] modificado conforme a estrutura apresentada na figura 2.25\nO bloco A subtrai da vazao de inje\u00e7\u00e3o o valor q^j que corresponde ao valor da vaz\u00e3o m\u00ednima realizavel para o funcionamento do po\u00e7o em GLC. Para este valor de vaz\u00e3o de injec\u00e3o a press\u00e3o de fundo em regime permanente seria muito pr\u00e1oxima da press\u00e3ao esta\u00e1tica do reservat\u00f3rio Pr. Este valor pode ser considerado nulo para valores de press\u00e3ao de reservat\u00e1orio pr\u00e1oximos ao limiar do valor de surg\u00e2ncia. O bloco B normaliza o valor da vaz\u00e3o de injec\u00e3o (em relacao a qrn). O bloco C aplica a funcao desenvolvida na secao anterior para regime permanente que calcula a press\u00e3ao de fundo em fun\u00e7\u00e3o da vaz\u00e3o de inje\u00e7\u00e3o. O bloco D aplica uma fun\u00e7\u00e3o de transfer\u00e2encia de 2a. ordem com o zero, o fator de atenuac\u00e7\u00e3ao e a\nFigura 2.25: Estrutura do Modelo din\u00e2mico baseado em Hammerstein\nfrequ\u00eancia natural sendo fun\u00e7\u00f5es da vazao de inje\u00e7\u00e3o normalizada,\nu.\tA sa\u00edda do bloco D \u00e9 a press\u00e3o de fundo normalizada. O bloco E limita a press\u00e3o de fundo normalizada a press\u00e3o est\u00e9tica normalizada. O bloco F filtra a aplica\u00e7\u00e3o da satura\u00e7\u00e3o feita pelo bloco E. Finalmente o bloco D recupera a press\u00e3o de fundo ao multiplicar a pressao normalizada por p*wj.\nA figura 2.26 apresenta o resultado de um estudo realizado para o po\u00e7o modelo apresentado na se\u00e7\u00e3o 2.2.1 para a pressao de reservat\u00f3rio de 20 MPa. Para este caso considerou-se qmr = 0. \u25a0\u00edinj\nUtilizando o modelo fenomenol\u00e9gico desenvolvido na se\u00e7ao 2.2.1 determinou-se a depend\u00eancia dos par\u00eametros a, \u00c7 e wn em rela\u00e7\u00e3o a vaz\u00e3o de injecao normalizada u. A figura 2.26-a mostra os valores da vaz\u00e3ao de inje\u00e7c\u00e3ao e da press\u00e3ao de fundo utilizados na obten\u00e7c\u00e3ao da vaz\u00e3ao de inje\u00e7c\u00e3ao normalizada u. A figura 2.26-b apresenta alguns valores encontrados para o zero da func\u00e7\u00e3ao de transfer\u00eaencia de segunda ordem do modelo proposto em func\u00e7\u00e3ao da vaz\u00e3o de inje\u00e7\u00e3o normalizada. No mesmo gr\u00e9fico apresenta-se\na fun\u00e7\u00e3o ajustada para os pontos obtidos, a(u).\n3\t2\nP1U3 + P2U2 + P3U + P4 a(u)\t=\t2\nu2 + qpu + q2\nPi =\t-972,1\nP2\t=\t1294\nP3\t=\t-502,3\nP4\t=\t33,8\nqi = -1,476\nq2\t=\t= 0,5679\t(2.129)\nFigura 2.26: Par\u00e2metros identificados\nA figura 2.26-\u00e7 apresenta os valores encontrados para \u00c7 e a fun\u00e7\u00e3o ajustada para os mesmos.\n\u00c7(u) = 0.3488e-0'1266\u201c - 0.5265e-3'855u\t(2.130)\nA figura 2.26-d mostra os valores encontrados para a frequ\u00eancia natural wn e a fun\u00e7\u00e3o ajustada para os mesmos.\nwn(u) = \u20140,01713u4 + 0,04658u3 \u2014 0,04569u2\t(2.131)\n+ 0, 01909u + 0,0003956\n2.3\tConclus\u00f5es e desenvolvimentos futuros\nNeste cap\u00edtulo foram apresentadas tr\u00eas abordagens na modelagem da eleva\u00e7\u00e3o por GLC, i)uma modelagem fenomenologica baseada na propaga\u00e7\u00e3o da fra\u00e7\u00e3o massica de gas, ii)uma modelagem para a relac\u00e7\u00e3ao em regime permanente entre a press\u00e3ao de fundo e a vaz\u00e3o de inje\u00e7\u00e3o de gas e iii)um modelo baseado na representa\u00e7\u00e3o tipo Hammerstein modificada que preserva o modelo es-tatico desenvolvido e acrescenta uma din\u00eaamica aproximada em fun\u00e7ao da vazao de inje\u00e7\u00e3o de gas. A modelagem fenomenolo-gica desenvolvida apresenta bom desempenho din\u00eaamico exibindo os fen\u00f4menos de fase n\u00e3o m\u00ednima e o comportamento com sub-amortecimento progressivo conforme se diminui a vaz\u00e3ao de inje\u00e7c\u00e3ao ate atingir-se oscilac\u00e7o\u00e3es sustentadas para uma determinada vaz\u00e3ao suficientemente baixa. Um mapa desta vaz\u00e3ao para diferentes valores de press\u00e3ao est atica da formac\u00e7\u00e3ao mostrou uma semelhan\u00e7ca muito grande com os resultados obtidos para um po\u00e7co equivalente simulado no OLGA2000MR. O comportamento em regime permanente, por outro lado, exibe uma diferen\u00e7ca muito grande e exige mais desenvolvimento. Essas caracter\u00edsticas do modelo o tornam um candidato para utiliza\u00e7ca\u00e3o em predi\u00e7c\u00e3ao quando se pode medir a press\u00e3o de fundo em tempo real ja que \u00e9 poss\u00edvel aplicar os metodos de correc\u00e7\u00e3ao como o que foi apresentado neste trabalho. Um trabalho importante e a utiliza\u00e7c\u00e3ao do modelo feno-menologico desenvolvido para a modelagem do fen\u00eameno heading. Isto poderia ser relativamente simples ja que o que falta seria uma modelagem do escoamento de gas no anular e na v alvula operadora de gas-lift.\nexemplo tecnicas Monte Carlo de ajuste. Isto permitiria partir-se de sintonias de modelo com uma qualidade m\u00ednima inicial semelhante a qualidade da representac\u00e3o do simulador fenomenologico. Ha de se considerar que o custo para a obtencao de dados reais para a sintonia de modelo e custosa pois passa invariavelmente pela necessidade de variar o regime de funcionamento do po\u00e7co e assim opera-lo de forma sub-otima pelo tempo de aquisic\u00e7\u00e3ao.\nO modelo baseado na representa\u00e7\u00e3o Hammerstein modificado \u00e9 um esfor\u00e7co no sentido de preservar uma rela\u00e7c\u00e3ao de regime permanente de qualidade no modelo din\u00e2mico. Isto pode ser interessante em determinadas formula\u00e7c\u00e3oes de controle preditivo como a apresentada na sec\u00e3o 5.3 do cap\u00edtulo 5 onde nao se define os valores refer\u00e2encia para as press\u00e3oes de fundo na fun\u00e7c\u00e3ao objetivo. A fun\u00e7ca\u00e3o objetivo e formulada visando principalmente atingir um certo desempenho econo\u00e2mico e um determinado comportamento din\u00e2mico dos po\u00e7os e do manifold de gas lift, para diferentes disponibilidades de gas comprimido. Neste sentido, o modelo desenvolvido mostra-se bastante interessante pois ao incorporar um bom modelo de regime permanente pode atender o objetivo principal de controle. Desenvolver modelos fenomenologicos simples que preservem uma relac\u00e7a\u00e3o de regime permanente de qualidade suficiente para otimiza\u00e7\u00e3o em problemas de escoamento multi-fasico e um desafio muito grande. O comportamento dina\u00e2mico do modelo e aproximado mas pode atender ao objetivo de controle por tratar-se de fen\u00e2omeno com din\u00e2amica lenta e que na\u00e3o requer atua\u00e7c\u00e3ao agressiva de controle em malha fechada o que permite operar com erros de modelagem razoaveis. Ja a sintonia dos par\u00e2metros do modelo din\u00e2mico precisa ser simplificada havendo a\u00ed um grande espa\u00e7co para melhoras.\nCap\u00edtulo 3\nControle MPC\nDistribu\u00eddo\nA maioria dos sistemas din\u00e2amicos com multiplas entradas e multi-plas sa\u00eddas (MIMO) encontrados na industria apresentam intera-\u00e7c\u00e3oes entre as variaveis controladas frente as vari aveis manipuladas. De forma que raramente uma variavel \u00e9 controlada pela manipula\u00e7c\u00e3ao de uma unica ac\u00e7\u00e3ao de controle. O controle de processos que apresentam intera\u00e7c\u00e3oes utilizando estrategias do tipo uma entrada uma sa\u00edda (SISO) ainda que poss\u00edvel em alguns casos, faz com que a opera\u00e7c\u00e3ao se desenvolva muito longe dos limites impostos pelas restric\u00e3es do problema. A fim de evitar a violac\u00e3o das restric\u00e7\u00e3oes devido ao comportamento din\u00e2amico ocasionado pelas interac\u00e7\u00e3oes, o sistema e operado a uma dist\u00e2ancia muito grande da restri\u00e7c\u00e3ao. Isto diminui o desempenho da planta.\nO controle de plantas complexas \u00e9 tipicamente dividido em n\u00edveis hier\u00e1rquicos. No n\u00edvel basico est\u00e3o os controladores locais utilizados para implementar ac\u00e7o\u00e3es como vaza\u00e3o, velocidade de uma esteira, temperatura de uma solu\u00e7ca\u00e3o, concentra\u00e7c\u00e3ao de um produto, etc. Estas a\u00e7\u00e3es fazem parte de uma estrategia de controle cuja referencia e fornecida pelo nivel de controle imediatamente superior que e o controle avan\u00e7cado. Em termos de velocidade da dina\u00e2mica, os controladores locais trabalham com taxas de amostragem de segundos ou fra\u00e7c\u00e3ao de segundo enquanto que o controle avan\u00e7cado trabalha com vari aveis amostradas em intervalos de tempo algumas dezenas de vezes maiores. Acima do controle avanc\u00e7ado pode\nexistir algoritmos de otimizac\u00e3o em tempo real (RTO-Real Time Optimizer) que resolvem problemas de otimiza\u00e7ca\u00e3o tipicamente para a solu\u00e7c\u00e3ao em regime permanente do sistema e fornecem os set-points para o sistema de controle avan\u00e7ado. Estes algoritmos de otimiza\u00e7\u00e3o recebem informa\u00e7\u00e3o da camada de planejamento sobre a disponibilidade de recursos dispon\u00edveis e sobre as demandas futuras.\nAtualmente os controladores locais de muitas instala\u00e7\u00f5es como refinarias, por exemplo, utilizam controle via redes de campo. Dentre as redes de campo a rede Foundation Fieldbus tem se destacado pois permite que estrategias de controle sejam implementadas nos proprios instrumentos de campo atraves da uti-liza\u00e7ca\u00e3o de algoritmos encapsulados em blocos funcionais que s\u00e3ao interligados para executar as tarefas de medic\u00e7a\u00e3o, c alculo da a\u00e7ca\u00e3o de controle e atua\u00e7c\u00e3ao. Os instrumentos Foundation Fieldbus sa\u00e3o ligados a um barramento comum que e utilizado para a troca de informac\u00e7\u00e3ao alem de, opcionalmente, suprir a energia eletrica para seu funcionamento. As tarefas de controle s\u00e3ao executadas de forma determin\u00edstica dentro de um tempo fixo chamado de macrociclo. Alem do tempo assegurado para as tarefas de controle existe um tempo extra destinado ' troca de informa\u00e7\u00f5es com o sistema de controle avan\u00e7cado e supervis\u00e3ao.\nE um consenso entre pesquisadores e praticantes que a tecnica de controle avan\u00e7ado mais utilizada na industria \u00e9 o Controle Pred-itivo Baseado em Modelo. Uma estat \u00edstica recente e interessante sobre aplica\u00e7oes de controle avan\u00e7ado na industria qu\u00edmica do Jap\u00e3o e apresentada em [46].\nUma das caracter\u00edsticas mais apreciadas na tecnica de controle preditivo e sua capacidade de tratar as restri\u00e7c\u00e3oes sobre as entradas e sa\u00eddas de forma simples e elegante. Este tratamento de restricoes permite, por exemplo, a diminui\u00e7ao do \" give away\" em processos onde o produto deve manter uma determinada caracter\u00edstica dentro de uma faixa de valores sob pena de multa, por exemplo. Em geral a aplica\u00e7c\u00e3ao de Controle Preditivo baseado em modelo permite operar mais proximo das restri\u00e7c\u00e3oes sem viola-las. Apesar das inumeras vantagens da aplica\u00e7c\u00e3ao de controle preditivo existem alguns aspectos relacionados com sua implementa\u00e7c\u00e3ao e utiliza\u00e7\u00e3o que poderiam ser melhorados:\n\u2014 O MPC demanda um longo tempo para ajuste dos modelos e par\u00e2metros do controlador.\n\u2014\tA manuten\u00e7ao do algoritmo de controle exige o trabalho de especialistas.\n\u2014\tAltera\u00e7oes na planta exigem a revisao de todo o sistema de controle.\n\u2014\tAs solu\u00e7oes de controle avancado sao caras para pequenas empresas.\nUma proposta no sentido de responder a algumas das dificuldades citadas e a utiliza\u00e7c\u00e3ao de agentes para o controle de sistemas. Toma-se aqui o nome de agente para definir um objeto matem atico que comunicando-se com outros objetos matematicos similares, recebendo os valores das vari aveis do processo e tam-bem das refer\u00f4encias, fornece o valor de uma das a\u00e7c\u00e3oes de controle. A ideia e desenvolver um algoritmo de controle preditivo que sera calculado atraves da troca de informac\u00e7\u00e3oes entre os agentes de forma iterativa. A cada instante de amostragem cada agente recebe os valores calculados pelos demais agentes e recalcula sua a\u00e7c\u00e3ao de controle. Isto e repetido por um determinado numero de instantes de amostragem ate que os valores calculados por cada agente n\u00e3ao mudem mais que um certo percentual em rela\u00e7c\u00e3ao aos valores calculados anteriormente.\nA figura 3.1 mostra uma poss\u00edvel configura\u00e7\u00e3o do sistema. Cada agente poderia ainda ter modulos de supervis\u00e3ao, otimiza\u00e7c\u00e3ao, identifica\u00e7\u00e3o de modelo, etc. Do ponto de vista da implementa\u00e7\u00e3o em redes de comunica\u00e7c\u00e3ao para controle esta tecnica e plenamente viavel ja que o tempo de amostragem do controle avan\u00e7cado e tipicamente uma ordem de grandeza maior que o tempo de amostragem do controle local.\n3.1\tDesenvolvimento de agentes para controle de processos\nUm agente tal como definido na introdu\u00e7ca\u00e3o podera eventualmente resolver parte das dificuldades existentes no controle de processos. Entretanto, alem de resolver o problema de controle preditivo de forma distribu\u00edda seria desejavel que o agente\n\u2014\tdiminu\u00edsse o numero de horas gastas com a identificacao de modelos do processo,\nAgente N\nFigura 3.1: Estrutura de Controle com Agentes\n\u2014\tutilizasse o acesso as informa\u00e7\u00f5es para melhorar continuamente a qualidade do modelo do processo,\n\u2014\trespondesse a situacoes de falha de medi\u00e7\u00f5o e/ou atuac\u00f5o de forma segura.\n\u2014\ttornasse o controle avan\u00e7ado dispon\u00edvel para usuarios da tecnologia fieldbus.\nO controle de processos moderno \u00e9 realizado na medic\u00f5o e atuacao em intervalos de tempo fixo chamados de tempo de amostragem. Tanto na malha de controle local como na de controle avan\u00e7ado, uma a\u00e7ca\u00f5o de controle deve ser produzida a cada instante de tempo. Por isso, e considerando que o controle preditivo baseado em modelo tem se mostrado uma das tecnicas de controle mais bem aceitas na industria, desenvolve-se neste cap\u00edtulo uma proposta de agente que visa inicialmente resolver o problema de controle de forma distribu\u00edda.\nA expectativa \u00e9 incorporar neste agente basico outras funcionalidades que ir\u00e3o fazer com que o agente atenda todos os requisitos acima mencionados.\n3.2\tMPC distribu\u00eddo\nO objetivo desta se\u00e7ao \u00e9 apresentar uma decomposi\u00e7\u00e3o do problema de controle preditivo de forma que o problema possa ser resolvido por agentes. Estes agentes ser\u00e3o tantos quantas forem as acoes de controle do problema. Para simplificar a apresen-ta\u00e7c\u00e3ao da tecnica apresenta-se inicialmente a decomposic\u00e7a\u00e3o do algoritmo para formula\u00e7co\u00e3es sem restri\u00e7co\u00e3es. A maioria das ideias apresentadas neste trabalho foram tambem publicadas em [47]. Depois da apresenta\u00e7\u00e3o do algoritmo MPC distribu\u00eddo sem res-tri\u00e7co\u00e3es apresenta-se um algoritmo baseado em proje\u00e7c\u00e3oes vetoriais que resolve o problema MPC com restric\u00e7\u00e3oes.\nSupondo que possamos representar as relac\u00f5es entrada-sa\u00edda de uma planta na forma linear, ent\u00e3o poderia se esperar que a relac\u00e3o entrada sa\u00edda na forma de matriz fun\u00e7\u00e3o de transferencia fosse escrita em Laplace como\n(3.1)\nyi(s)\ny2(s)\n\u00ab3(s)\n\u00ab4(s)\n_ yn(s) _\nHii(s)\tH12(s)\tHi3(s)\t0 \u2022\t\u20220\t\tU1(s)\n0\tH22(s)\tH23(s)\t0 \u2022\t\u20220\t\tU2(s)\n0\tH32(s)\tH33(s)\tH34(s)\t\u2022\t\u20220\t\tU3(s)\n0\t0\t#43 (s)\tH||('s)\t\u2022\t\u20220\t\tU4(s)\n0\t\t0\t0 \u2022\t\u2022\tHnn(s) .\t\t. Un(s) _\nn-diagonal com n vari\u00e1vel. E claro que no caso em que nao houvesse nenhum acoplamento a matriz seria diagonal e cada agente resolveria um problema de controle do tipo SISO (Single InputSingle Output). O fato de que a matriz fun\u00e7\u00e3o de transfer\u00eancia t\u00edpica e dispersa favorece a utiliza\u00e7\u00e3o de agentes pois tipicamente cada agente necessita comunicar-se com poucos outros agentes.\n3.2.1\tDecomposi\u00e7\u00e3o da Formula\u00e7\u00e3o MPC sem restri\u00e7\u00e3o\nA maioria dos algoritmos de controle preditivo baseado em modelo determinam o vetor incremento de ac\u00e3o de controle Au minimizando a seguinte fun\u00e7c\u00e3ao objetivo:\nmin J\nAu\nJ = (W - Y)TR(W - Y) + AuTQAu,\t(3.2)\nonde\n-\tW \u00e9 o vetor com as refer\u00eancias futuras\n-\tY \u00e9 o vetor com as predi\u00e7\u00f5es das variaveis controladas\n-\tR e uma matriz diagonal com pesos para o seguimento de refer-\u00eaencias\n-\tAu e o vetor com as futuras mudan\u00e7as nas acoes de controle\n-\tQ e um matriz diagonal com pesos sobre as mudancas nas a\u00e7\u00f5es de controle\nPara No sa\u00eddas e N entradas, W, Y, R, Au e Q sao composi\u00e7\u00f5es de vetores e matrizes,\nAu\nQi 0\t...\t0\n0\tQ2 ...\t0\n(3.3)\nW\nR\nQ\n0\t0\t...\tQNi\nA fun\u00e7ao custo J pode ser escrita como\nJ =\t(Wi - Yi)TRi(Wi - Yi) +\n(W2 - Y2)tR2(W2 - Y2) +\n... +\n(WWo - YNo )TRn (Wn - YNo) +\nAuf Q1Au1 +\nAuf Q2AU2 +\n... +\nAuN QNi AuN\t(3.4)\nAs predi\u00e7c\u00e3oes s\u00e3ao calculadas na forma de resposta livre somada ao efeito das futuras mudan\u00e7cas na ac\u00e7\u00e3ao de controle corrente conforme se faz no algoritmo DMC e GPC, [48].\nY = F + GAu,\t(3.5)\nF \u00e9 o vetor com a resposta livre de todas as vari\u00e1veis controladas, isto e, a resposta quando n\u00e3o ha mudan\u00e7a nas entradas ou Au = 0. Ge a matriz din\u00e2mica no algoritmo DMC obtida com a resposta ao degrau de cada sa\u00edda para cada entrada. A matriz G e tambem utilizada no algoritmo GPC onde e frequentemente obtida resolvendo-se a equa\u00e7\u00e3o diof\u00e2ntica. Em [49] e [50] demonstra-se que a matriz G e a matriz Jacobiana das predi\u00e7\u00f5es em fun\u00e7ao dos incrementos de controle G = N\u2014.\n*\tmu\n\t\t\tFi\t\t\nF\t\t=\tF2\t\t(3.6)\n\t\t\tFN\t\t\n\tGii\tG12\t.\t\t.\tG1N\u00bf\t\nG =\tg21\tG22\t.\t\t.\tG2 V\t(3.7)\n\tGNO1\tGNo2\t.\t\t. G N V\t\nSubstituindo as equac\u00e3es 3.5, 3.6e3.7na equa\u00e7\u00e3o 3.4, e definindo WFi = Wi - Fi, WF2 = W2 - F2 e assim por diante, tem-se que\nNi\tNi\nj = (WFi -\tGiiAui)TRi(WFi -\tGiiAui)\ni=1\ti=i\nNi\tNi\n+ (WF2 -\tG2iAui)TR2(WF2 -\tG2iAui)\ni=i\ti=i\n+\t...\nNi\tNi\n+\t(WFn\t- G^Au/Rn(WFn -\tGNoiAui)\ni=i\ti=i\n+ Auf QiAu\u00ed\n+ Auf Q2Au2\n+ ...\n+ AuNi QNi AuN\t(3.8)\nDesenvolvendo a equa\u00e7\u00e3o (3.8) e multiplicando J por 1/2,\nNi\tNi\nj =\t5\tAuT GTi Ri\tGiiAui +\ni=1\ti=1\n1 Ni\tNi\n-\tAuT gT R2\tG2iAui +\ni=1\ti=1\n... +\n1 Ni\tNi\n-\tAuT GNo\u00cdRno\tGNoiAui\ni=1\ti=1\nNi\n-\tAuT GTiR1WF1\ni=1\nNi\n-\tAuT gTr2wf2\ni=1\n-...\t(3.9)\nNi\n-\tAuTG. R. WF\ni=1\n1\tNi\n+xEAuT QiAu\u00ab\ni=1\n1 N\n+~E WFTR WF, com\t(3.10)\n2\tj=1\ni = 1,..., Ni, j = 1, ...,NO.\nOs algoritmos de controle preditivo para sistemas lineares DMC e GPC aplicados a problemas sem restri\u00e7\u00e3es calculam o vetor Au que faz ddJu = 0. A ideia aqui \u00e9 buscar Au1, Au2, ..., AuNi que faz o gradiente\n\u25a0\tdJ\t\u25a0 Mui dJ Mu2\t\t1 \u2022 o o \t1\ndJ\t\t0\n\t\t\nObviamente isto equivale a ddju = 0.\nPara qualquer g = 1,Ni,\nd\u00c3--\t= GfgR\tG\u00fcAUi\t(3.12)\n-\ti= 1\nNi\n+GT- R2\tG2iAui\ni= 1\n+...+\nNi\n+ GNO-R\tGNoiAui\ni= 1\n\u2014GT- R1WF1\n\u2014GT- R2WF2\n\u2014G . R . WFno\n+Q- Au-\nAgrupando os termos com Aug,\nNo\t\\\ny? Gj- Rj Gj-+q- 1Au-+\t(3.13)\nNo\tNi\nGT-Rj I\tGjiAui \u2014 (Wj \u2014 Fj)\nj = 1\t\\i=1,i=-\nAntes de escrever uma expressao para Aug deve-se observar que um algoritmo MPC \u00e9 normalmente utilizado em sistemas de controle amostrados. Como j a mencionado, estes algoritmos normalmente entregam a\u00e7oes de controle em per\u00edodos de tempo fixo chamados tempo de amostragem. O valor do tempo de amostragem depende da natureza do processo sendo controlado mas e tipicamente muito maior do que o tempo de amostragem utilizado no controle local ou tambem chamado controle regulat orio. Uma figura t\u00edpica \u00e9 o macrociclo do n\u00edvel H1 de uma rede Foundation Fieldbus [51] que varia de 200 a 1000 ms, enquanto um tempo\nde amostragem do algoritmo MPC pode ser medido em minutos em muitas aplica\u00e7\u00f5es na indUstria do refino e petroqu\u00edmica, por exemplo.\nPoderia-se imaginar um sistema de controle MPC distribu\u00eddo rodando no n\u00edvel H1 de uma rede Foundation Fieldbus. Neste caso o valor final de cada a\u00e7\u00f5o de controle Aug calculada pelo controle MPC distribu\u00eddo seria disponibilizado somente ap\u00f3s um alto numero de macrociclos. Supondo que a func\u00f5o de cada agente seja encapsulada em um bloco funcional Foundation Fieldbus, a cada macrocilo todos os Ni blocos funcionais do tipo agentes MPC calculariam o valor Aug em uma forma iterativa. Depois de um determinado numero de macrociclos os valores de Aug calculados por cada agente teriam evolu\u00eddo para o valor final e seriam disponibilizados para o controle local tipicamente na forma de um set-point. Obviamente esta nao \u00f3 a unica forma de implementar o controle MPC distribu\u00eddo mas \u00f3 uma forma simples de se explicar seu funcionamento.\nPara a formula\u00e7\u00f5o sem restri\u00e7\u00f5es a express\u00f5o para cada Aug no tempo de amostragem t e na iterac\u00f5o k pode ser escrita como\nAu lk =\tOfc\nA ug 11\tg -g,\n(3.14)\nonde\n*g\nE Gjg R Gjg + Qg ) e\nNo\t\u00ed\tNi\n\u2014 = E GTgRj (Wj (t) -Fj (t)- E GjiAukNt) j=1\t\\\ti=i,i=g\nNa equa\u00e7\u00f5o (3.14)\n\u2014\tWj (t) \u00f3 o vetor p x 1 com as referencias futuras da sa\u00edda j no instante de amostragem t,\n\u2014\tFj (t) \u00ed o vetor p x 1 com as respostas livres da sa\u00edda j no instante de amostragem t,\n\u2014\tAuk-1(t) \u00ed o vetor m x 1 com os incrementos de controle da entrada i na itera\u00e7\u00f5o k \u2014 1 do instante de amostragem t,\n\u2014\tp \u00ed o horizonte de predi\u00e7ao e\n\u2014\tmeo horizonte de controle\nDeve-se ressaltar que a dificuldade computacional para obter-se Aus e muito menor do que aquela para obter o vetor Au completo. Conforme ja discutido, nesta abordagem distribu\u00edda, o vetor Au e determinado por agentes utilizando uma combina\u00e7\u00e3o de calculos repetidos de Aug e troca de informa\u00e7\u00f5es. Cada agente g inicia o tempo de amostragem t montando um valor inicial para Aug utilizando os valores finais obtidos no tempo de amostragem t \u2014 1 depois de N itera\u00e7\u00e3es,\nAUg I1\nAus IN! (2)\nAug IN! (3)\n(3.15)\n0\nO valor inicial utilizado para Aug I1 \u00e9 consistente com a filosofia dos algoritmos MPC que assumem como nulo o valor do incremento de controle no instante seguinte ao horizonte de controle, isto e, Au(m + 1) = 0. No instante de amostragem t, calcula-se o vetor incremento da ac\u00f5o de controle Aug |t utilizando-se um filtro conforme sera explicado posteriormente. Na equa\u00e7ca\u00f5o 3.16 o \u00edndice k refere-se ao numero do calculo de Aug |t realizado pelo agente g no instante de amostragem t.\nAug |k = (1 - a)Aug |k + aAug |k-1.\t(3.16)\n3.2.2\tAplica\u00e7\u00e3o da t\u00e9cnica para um problema\nbenchmark\nApresenta-se nesta se\u00e7ao a aplicac\u00e3o da tecnica de controle MPC distribu\u00eddo ao problema Shell Heavy Oil Fractionator descrito em [48]. Um diagrama esquematico da coluna \u00e9 apresentado na figura 3.2. A aplica\u00e7ao do Controle preditivo distribu\u00eddo tornase mais apropriada em situa\u00e7\u00e3es onde n\u00e3o existe acoplamento de todas as entradas com todas as sa\u00eddas que \u00e9 uma situa\u00e7\u00e3o esperada em grandes processos. Para a analise do desempenho do algoritmo proposto, entretanto, quanto maior o acoplamento maior sera a dificuldade imposta ao algoritmo. Por esse motivo utiliza-se esse processo para demonstrar a aplicac\u00e7\u00e3ao do metodo. A din\u00e2mica do processo \u00e9 descrita por um modelo baseado em fun\u00e7\u00e3o de transfer\u00e2ncia em Laplace que \u00e9 discretizada utilizando o tempo de amostragem de 4 minutos. As vari aveis controladas\nFigura 3.2: Diagrama esquem\u00e1tico da coluna de destila\u00e7\u00e3o\nsao a composi\u00e7\u00e3o de topo yi, composicao da sa\u00edda lateral y2 e a temperatura de refluxo de fundo y3. As variaveis manipuladas s\u00e3o a vaz\u00e3o de sa\u00edda de topo u1, a vazao de sa\u00edda lateral u2 e a vaz\u00e3o de recircula\u00e7\u00e3o de fundo u3. Deve-se observar que as variaveis manipuladas ui, u2 e u3 calculadas pelo controle avan\u00e7ado em um sistema com taxa de amostragem igual a 4 minutos (240 segundos) serao implementadas por controladores PID que rece-ber\u00e3ao estes valores como set-points e calculara\u00e3o a abertura dos posicionadores das valvulas de controle que implementara\u00e3o estas vaz\u00f5es na rede de controle local. Esta rede de controle local trabalha com tempo de amostragem da ordem de 1 segundo. Isto significa que se o controle local fosse implementado em uma rede Foundation Fieldbus, ent\u00e3ao os agentes que implementam o controle MPC distribu\u00eddo poderiam trocar informacao ate 240 vezes aproximadamente (dependendo do macrociclo da rede) antes de disponibilizarem as a\u00e7\u00e3es de controle como referencia para os controladores locais de vaza\u00e3o. Isto da uma ideia da factibilidade da\nt\u00e1cnica j\u00e1 que normalmente pode-se obter converg\u00eancia com um nu\u00edmero muito menor de itera\u00e7c\u00e3oes ou troca de informa\u00e7c\u00e3oes entre agentes. O modelo baseado em Funcao de Transfer\u00eancia no dom\u00e1nio Laplace \u00e9 dado pela equa\u00e7\u00e3o (3.17).\nyi(s)\ny2(s)\ny3(s)\n4.05e-27s\n1+50s\n5.39e-18s\n1+50s\n1.77e-28s\n1 + 60s\n5.72e-14s\n1 + 60s\n5.88e-27s\n1+50s\n6.9e-15s 1+40s\n4.38e-20s\n1+33s\n4.42e-22s\n1+44s\n7.2\n1+19s\nU1(s)\nU2(s)\nU3(s)\n(3.17)\nAs sa\u00eddas\ty2 e y3 estao sujeitas a perturbacoes. Dentre es-\ntas perturba\u00e7co\u00e3es esta\u00e3o aquelas devido a varia\u00e7co\u00e3es nas vaz\u00e3oes de refluxo de topo. As funcoes de transfer\u00e2ncia relacionando a per-turba\u00e7ao nas sa\u00eddas yi, y2 e y3 e as varia\u00e7\u00e3es nas vazoes de refluxo de topo s\u00e3o apresentadas pela equa\u00e7\u00e3o (3.18).\nyp1(s)\nyp2(s)\nyp3(s)\n1.44e-27s\n1+40s\n1,83e~15s\n1+20s\n1.26\n1+32s\nUp(s)\n(3.18)\nA figura 3.3 apresenta uma proposta de controle para a coluna Shell utilizando 3 agentes. Um agente para cada a\u00e7\u00e3o de controle. Como ja mencionado, se o controle regulat\u00f3rio da coluna fosse implementado via Foundation Fieldbus (FF), ent\u00e3o as acoes de controle seriam implementadas por controladores do tipo PID instanciados como blocos funcionais em posicionadores de va\u00edlvulas de controle FF. Os agentes seriam blocos funcionais e poderiam estar igualmente instanciados nos posicionadores. Desta forma a refer\u00e2encia para os controladores PID que efetivamente implementam as vaz\u00e3oes passariam dos agentes para os blocos funcionais PID sem sequer utilizar o barramento.\nFigura 3.3: Controle via agentes\nas predic\u00e7\u00e3oes de forma semelhante ao algoritmo DMC podem ser convertidas para a formula\u00e7\u00e3o distribu\u00edda.\n3.2.3\tCompara\u00e7\u00e3o entre o algoritmo MPC Centralizado e Distribu\u00eddo\nA fim de comparar a resposta entre o algoritmo MPC centralizado e o algoritmo distribu\u00eddo, utilizou-se o algoritmo MPC DMC (Dynamic Matrix Control) com os par\u00e2ametros apresentados na tabela\n3.1.\tOs pesos utilizados para a fun\u00e7\u00e3o custo MPC n\u00e3o sao o foco deste trabalho. A escolha dos valores seguiu o usual compromisso entre desempenho e robustez. A resposta com o algoritmo distribuido mostrado na figura 3.4 foi obtida usando um numero de troca de informa\u00e7c\u00e3oes entre agentes igual a 20. O criterio de parada utilizado foi o numero de itera\u00e7c\u00e3oes (igual a 20) mas existem outras possibilidades. Uma ideia e fixar um numero m aximo de itera\u00e7c\u00e3oes mas dar a possibilidade para a itera\u00e7c\u00e3ao parar mais cedo baseado\nTabela 3.1: Par\u00e2metros de sintonia do algoritmo MPC\nS \u00edmbolo\tdescri\u00e7\u00e3o\tvalor\np\tHorizonte de predi\u00e7\u00e3o\t15\nm\tHorizonte de controle\t3\nRi\tPeso seg. de refer\u00eancia p/ yi\tIpxp\nR2\tPeso seg. de refer\u00eancia p/ y2\tIpxp\nR3\tPeso seg. de refer\u00eancia p/ y3\tIpx p\nQi\tPeso esf. de controle Aui\t0-2Ipxp\nQ2\tPeso esf. de controle Au2\t0-2Ipxp\nQ3\tPeso esf. de controle Au3\t0 \u20221 Ip x p\n\tFiltro de referencia\t0.7\na\tAu Filtro p/ MPC distribu\u00eddo\t0.35\nFigura 3.4: Resposta com DMC distribu \u00eddo\n0.6\n0.4 -\n1\n0.2 -\n-0.2 -\n0\n\nr\n2\nX-2\n-0.4 L 0\n4\n6\n8\n10\t12\t14\t16\t18\t20\t22\t24\nTime [ h ]\nFigura 3.5: Resposta com DMC centralizado\n3.2.4\tDesempenho do algoritmo MPC distribu\u00eddo\nPara se ter uma id\u00e9ia do n\u00famero de troca de informa\u00e7\u00f5es entre agentes necess\u00e9ria para um certo desempenho, uma an\u00e9lise foi feita baseada no erro entre as sa\u00e9das e as refer\u00eancias. Para cada sa\u00e9da Yj a cada tempo de amostragem t o erro relativo et foi calculado como\n(Y* - W)\net =\tj Wt\t= 1 - 3, t = 1 ...N\t(3.19)\nAssim, e* = 1 significa um erro de 100%. Uma m\u00e9dia do erro absoluto foi calculada para cada sa\u00e9da bem como a m\u00e9edia das 3\nsa\u00e9das,\neabs (j ) \u2014\nN\n|ej (t)|\nt=1______\nN \u2019\n1 3\neabs \u2014\n3 j=i\nN\n/ Elej (t)l t=1\n(3.20a)\n(3.20b)\nN\n\\\n\\\n\nUm valor de eabs = .01 significa um erro m\u00e9dio de 1%. A figura\n3.6\tapresenta a percentagem com que o erro utilizando o algoritmo distribu\u00eddo e maior do que o erro utilizando o algoritmo centralizado. E evidente que os erros relativos tendem a zero na media em que no numero de troca de informa\u00e7\u00f5es entre os agentes aumenta. A equac\u00e3o utilizada para calcular cada erro percentual da sa\u00edda e\ne% = (- 1) * 100\t(3.21)\necent\nNota-se que para esta aplica\u00e7ao, obtem-se erros aceitaveis para\n5\t10\t15\t20\t25\t30\t35\t40\nN\u00famero de troca de informa\u00e7\u00f5es entre agentes\nFigura 3.6: Comparacao entre o numero de iteracoes e o erro de seguimento de refer\u00eancia\n3.3\tConverg\u00eancia do Algoritmo MPC distribu\u00eddo\nA convergencia do vetor Au\u00bf para seu valor verdadeiro (aquele que minimiza a fun\u00e7\u00e3o objetivo) tem de ser garantida para uma aplicac\u00e7\u00e3ao segura. Para uma aplica\u00e7c\u00e3ao sem restri\u00e7c\u00e3oes os desenvolvimentos feitos na area da computac\u00e3o distribu\u00edda podem ser utilizados abstraindo-se da problematica da comunica\u00e7ca\u00e3o entre agentes. A tecnica Jacobi overrelaxation, [52], \u00e9 adotada aqui para recalcular Aug como uma combina\u00e7\u00e3o linear dos valores calculados pela equa\u00e7\u00e3o (3.14) e o valor obtido na itera\u00e7\u00e3o anterior,\nAug|k = (1 - a)Aug|k + aAug(3.22)\nPara entender como o filtro a pode garantir estabilidade ou converg\u00eancia do algoritmo \u00e9 importante observar que a equac\u00e3o (3.14) mostra que Aug, g = 1 : Ni, depende de todos os demais vetores Au\u00bb, exceto do vetor Aug. Ao se agrupar as express\u00e3es para todos os Au\u00bb pode-se utilizar a equac\u00e3o (3.14) para obter-se a equac\u00e7\u00e3ao 3.23\nN\nAuilk =\tAij Auilk-1 + Bi,\t(3.23)\ni=i,i=g\nonde as matrizes Aj ter\u00e3o dimensao m xm e o vetor Bj dimensao m x 1. A matriz A\u00bb\u00bb \u00e9 nula. As matrizes Aj podem ser facilmente obtidas com a equa\u00e7c\u00e3ao 3.14. Escrevendo uma express\u00e3ao centralizada para Au = [ Au1 Au2 ... AuNi ] utilizando\na equa\u00e7\u00e3o (3.23),\nAu1\nAu2\nAun\u00ed\n(3.24)\no A12\nA21 0\nA1Ni\nA2 Ni\nAui\nAu2\nk-1\nAn\u00edi An\u00ed-ii\nAun\u00ed\n0\n+\nBi\nB2\n\nBn\u00ed\nque, numa forma compacta se torna\nAuk = AAuk-i + B.\t(3.25)\nAplicando o filtro de acordo com a equac\u00e3o (3.22),\nAuk = AFAuk-i + (1 - a)B,\nAf = (1 - a)A + ai.\t(3.26)\nNota-se que a a\u00e7\u00e3o do filtro e introduzir elementos na diagonal da matriz AF. No limite, para a =1, ter\u00edamos AF igual a matriz identidade. E obvio que a converg\u00e2encia sera obtida se os autovalores Xr de ((1 - a)A + aI) satisfazem\n||ArII2 &lt;1\n(3.27)\n3.4\tMPC distribu\u00eddo na presen\u00e7a de restri\u00e7\u00f5es\n->\nEm geral os algoritmos MPC utilizados na industria utilizam o algoritmo de Programa\u00e7ao Quadr\u00e1tica na determinac\u00e3o das a\u00e7\u00e3es de controle. Tipicamente o algoritmo de Programa\u00e7\u00e3o Quadr\u00e1tica resolve o seguinte problema a cada instante de amostragem:\nmin\tJ\t\nAu\t\t\ns. a\t\t\nJ =\t2aut 5Au + eT Au\t\nAAu&lt;\tB\t(3.28)\nNa equa\u00e7\u00e3o (3.28) a restri\u00e7ao expressa por AAu &lt;B representa uma fam\u00edlia de restribes que normalmente incluem.\n\u2014\tRestri\u00e7ao sobre os valores dos incrementos de controle Au, isto e, Aumin. (j) &lt;Au(j) &lt;Au max. (j).\n\u2014\tRestri\u00e7ao sobre os valores das acoes de controle u, isto \u00e9, umin. (j) &lt;u(j) &lt;umax. (j).\n\u2014\tRestri\u00e7ao sobre os valores das sa\u00eddas y, isto e, ymin (j) &lt;y(j) &lt;ymax.(j).\nEssa fam\u00edlia de restricoes responde pela maioria das necessidades da industria de processos. As restri\u00e7c\u00e3oes sobre os valores admiss\u00edveis para Au refletem a capacidade limitada da mudanca de valores que os atuadores podem fornecer. Uma valvula de controle, por exemplo, exige um tempo determinado para variar sua abertura desde 0% ate 100%. Para um determinado tempo de amostragem fixo, isto estabelece um maximo valor de incremento e de decremento de abertura realizavel a cada instante de amostragem. Esta limitac\u00e3o e tambem chamada de slew rate.\nAs restri\u00e7c\u00e3oes sobre os valores das a\u00e7co\u00e3es de controle, por outro lado, refletem os limites da capacidade do atuador. A mesma v alvula mencionada anteriormente, por exemplo, s o pode ter sua abertura entre os valores 0% e 100%.\nAs restri\u00e7\u00e3es sobre os valores das variaveis de sa\u00edda permitem exigir que algumas variaveis de interesse n\u00e3ao ultrapassem algum valor determinado. O cumprimento destas restric\u00e7\u00e3oes e valioso quando se deseja garantir que uma determinada concentrac\u00e7\u00e3ao de\numa subst\u00e2ancia, por exemplo, na\u00e3o seja menor ou maior que um determinado valor. Em um processo produtivo esta possibilidade e muito importante pois estes valores muitas vezes tem de ser assegurados devido a necessidade de se garantir a especifica\u00e7c\u00e3ao do produto sendo produzido sob pena de se perder a produ\u00e7c\u00e3ao quando estas especificac\u00e7\u00e3oes n\u00e3ao sa\u00e3o atendidas.\nA introdu\u00e7c\u00e3ao dessas restri\u00e7c\u00e3oes na formula\u00e7ca\u00e3o de controle melhora o desempenho do sistema. Ha de se considerar que o algoritmo de otimiza\u00e7ca\u00e3o resolve um problema numerico e, se na\u00e3o informado, na\u00e3o considera nenhuma limita\u00e7ca\u00e3o sobre o valor calculado de uma a\u00e7\u00e3o de controle, como 100% para a abertura de uma valvula de controle, por exemplo. Ao introduzir as restri\u00e7c\u00e3oes conhecidas do problema obtem-se uma a\u00e7c\u00e3ao de controle de melhor qualidade que efetivamente realiza o que se pretende com a fun\u00e7\u00e3o objetivo. Em [48] apresenta-se em detalhes a coloca\u00e7c\u00e3ao de todas essas restri\u00e7c\u00e3oes na forma MAu &lt;N.\nA fim de introduzir restri\u00e7\u00e3es na formula\u00e7ao distribu\u00edda reescreve-se o problema de Programa\u00e7\u00e3o Quadr\u00e1tica colocando-se as res-tric\u00e7\u00e3oes dentro da fun\u00e7ca\u00e3o custo utilizando-se multiplicadores de Lagrange, [53]. A maioria dos resultados que ser\u00e1o apresentados a seguir tambem fazem parte de um artigo apresentado em [54] e partes do trabalho est\u00e3ao em outro artigo submetido ao Congresso Brasileiro de Automatica 2010. As simulac\u00e3es realizadas nas sub-se\u00e7c\u00e3oes seguintes tanto para o algoritmo centralizado como para o distribu\u00eddo utilizaram os par\u00e2metros de sintonia apresentados na tabela 3.2.\nTabela 3.2: Par\u00e2metros de sintonia do algoritmo MPC\nS\u00edmbolo\tdescri\u00e7c\u00e3ao\tvalor\nP\tHorizonte de predic\u00e7\u00e3ao\t15\nm\tHorizonte de controle\t3\nRi\tPeso seg. refer\u00e2ncia p/ yi\tIpXp\nR2\tPeso seg. refer\u00e2ncia p/ y2\t0.2IpXp\nRs\tPeso seg. refer\u00e2ncia p/ y3\t3Ipxp\nQi\tPeso esf. de controle Au!\t0 \u20221 Ip X p\nQ2\tPeso esf. de controle Au2\t0-2Ipxp\nQ3\tPeso esf. de controle Au3\t0-15Ipxp\n\tFiltro de refer\u00e2ncia\t0.4\na\tAu Filtro p/ MPC distribu\u00eddo\t0.375\n3.4.1\tRestri\u00e7\u00f5es sobre Au\nPara restri\u00e7\u00f5es em Au e u n\u00e3o ha dificuldades pois a restricao e local. Para o caso de restric\u00e3o em Au a matriz A da equa\u00e7\u00e3o (3.28) e a matriz identidade de dimens\u00e3o m x m e o vetor B para o caso de limite superior seria escrito como B = Aumax1 onde o vetor 1 e um vetor de uns de dimensao m x 1. Para este caso pode-se reescrever a fun\u00e7ca\u00e3o objetivo como\nmin\tL\t\nAu\t\t\ns. a.\t^AuT4Au + eTAu + Ats (IAus -\t\nL=\t\t_ Au^ax 1)\nAT >\t0\t(3.29)\nd Aus dL\nAs\nPara todos os agentes g = 1 : Ni, exceto o agente g = s, calcula-se a a\u00e7\u00e3o de controle conforme a equa\u00e7\u00e3o (3.14) aqui repetida,\nAug |k = -4-1eg\t(3.30)\nPara o agente s, a solu\u00e7ca\u00e3o otima exige que\n= 4S Aus + es + As =0\n= IAus - Aumax1 =0\n>\t0\t(3.31)\nDefine-se o erro ao atendimento \u00e0 restri\u00e7\u00e3o S,\nS = IAus - Aum\u2018ax1.\t(3.32)\nExistem diversas formas de implementar um sistema iterativo com as equac\u00e7\u00e3oes 3.31 e 3.32 que resultem na soluc\u00e7\u00e3ao otima de 3.30. Uma ideia \u00e9 utilizar o erro ao atendimento da restri\u00e7\u00e3o, S, para modificar o vetor com os multiplicadores de Lagrange As de forma a modificar Aus e levar ao cumprimento da restric\u00e3o (S = 0). Deve-se ter em mente que a equac\u00e7\u00e3ao 3.31 e valida somente na ocorr\u00eancia da restri\u00e7\u00e3o. De qualquer forma quando As \u00e9 nulo a soluc\u00e7a\u00e3o e a mesma obtida pela equa\u00e7c\u00e3ao 3.30.\nA forma adotada para transformar o erro S em mudan\u00e7as no valor de As utiliza o fato de que manipulando-se as equa\u00e7\u00f5es 3.31 e 3.32 obt\u00e9m-se\ndA\ndS =\t(3.33)\nAssim, para um incremento de erro ASun. = [ 1\t1\t\u2022 \u2022 \u2022\t1 ]T\ndeve-se modificar o vetor As na direcao do vetor unitario Ad,\nAd = ||$AS|| $sAS\u201c\u201d--\t(3.34)\nDe forma que, para um determinado vetor erro S, calcula-se o incremento do vetor AA como a projec\u00e3o de S no vetor unit\u00e9rio Ad;\nAA = (S.Ad)Ad, ou\nAj = Aj-1 + (S.Ad)Ad\t(3.35)\nFinalmente pode-se escrever o processo iterativo proposto para obtenc\u00e3o da ac\u00e3o de controle obedecendo a restri\u00e7\u00e3o em Au. A a\u00e7\u00e3o de controle para o agente s pode ser calculada de forma iterativa inicializando o vetor As de dimensao m x 1 com zeros. Define-se o erro ao atendimento da restric\u00e3o na iteracao k como\nSj = IAuJ-1 - A<\u201c1\t(3.36)\nNa sequ\u00eancia atualiza-se o vetor Aj,\nAj = Aj-1 + (Sj .Ad) Ad,\nAj (j)\t> 0 para j=1:m\t(3.37)\ne calcula-se a ac\u00e7\u00e3ao de controle\nAuj = -$-1 (ej + Aj),\nAuj = (1 - a)AuJ + aAuJ-1.\t(3.38)\ntribu\u00eddo utilizou-se 35 trocas de informa\u00e7\u00f5es a cada instante de amostragem. Foi exigido uma restri\u00e7\u00e3o no incremento da a\u00e7\u00e3o de controle Au1 na forma Au1 &lt;0.05.\ny\n0.8\n0.05\n0.6\n0.5\n0.15\n0.25\n0\n0.05\n8\n8\n0\n0\nu1\nu2\nU3\n2\t4\t6\ntempo [ h ]\n246 tempo [ h ]\n-0.25\n0\ntempo [ h ]\nu\n------y,\n------y2\n------ys\nref,\nref2\nref3\n-0.05\ntempo [ h ]\n\t\t\t A(l) \t A,(2) \t A, (3)\n\t\t\t\n\t\t\nJL\t\t\n0\nFigura 3.7: Resposta do MPC Distribu\u00eddo com restri\u00e7\u00e3o Aui &lt;0.05\nA figura 3.7 apresenta os resultados obtidos com o algoritmo MPC distribu\u00eddo proposto. Observa-se que como o horizonte de controle e igual a 3, ha tambem 3 multiplicadores de Lagrange para restric\u00e3o nos incrementos de uma a\u00e7ao de controle. Esses multiplicadores assumem valores que otimizam a fun\u00e7\u00e3o objetivo atendendo a restri\u00e7c\u00e3ao.\nA figura 3.8 apresenta os resultados obtidos com o algoritmo MPC centralizado. Foi utilizado o MPC DMC com o algoritmo de pro-grama\u00e7ao quadr\u00e1tica quadprog do Matlab. A fim de fazer uma melhor comparacao extra\u00edram-se os multiplicadores de Lagrange utilizados pelo algoritmo quadprog do Matlab. Nota-se a grande semelhan\u00e7ca entre os valores dos multiplicadores de Lagrange obtidos na forma distribu\u00edda e centralizada dos algoritmos. Observando os valores das sa\u00eddas para a vers\u00e3o distribu\u00edda e centralizada percebe-se um comportamento ligeiramente mais pr oximo das referencias para o caso distribu\u00eddo. Com ambas as tecnicas as restri\u00e7c\u00e3oes sa\u00e3o obedecidas. Na\u00e3o se conhece em profundidade\ny\ntempo [ h ]\n0.75\n0.25\n0\n-0.25\n0\n8\n2\t4\t6\ntempo [ h ]\n02468 tempo [ h ]\nFigura 3.8: Resposta do MPC Centralizado com restri\u00e7\u00e3o Au &lt;0.05\na tecnica utilizada pelo otimizador quadprog no tratamento das restri\u00e7c\u00f5oes e por enquanto pode-se afirmar que o resultado obtido com o MPC distribu\u00eddo n\u00f5o \u00e9 pior do que aquele obtido com a tecnica centralizada, pelo menos para esta aplicac\u00e7\u00f5ao.\nPara restricoes do tipo Au > Aumm transforma-se a restri\u00e7\u00f5o fazendo\nAu\t>\tAu\u21221 equivale a\n\u2014Au &lt;\u2014 Au^l\t(3.39)\nA equac\u00f5o (3.29) deve ser reescrita como\nmin L\nAu\ns. a\nL =\t2 AuT 5Au + 0T Au + Af (\u2014IAus + Au^ax 1),\nAf > 0\t(3.40)\nNeste caso para o agente s,\ndL dAus dL\ndAs\n= $sAus + \u00a9s - As =0\n= S = \u2014IAus +A\u00abm\u201cx1 =0\n> 0\n(3.41)\nA\ns\nAs figuras 3.9 e 3.10 mostram os resultados de simula\u00e7ao para\ny\ntempo [ h ]\ntempo [ h ]\nA u\ntempo [ h ]\nFigura 3.9: Resposta do MPC Distribu\u00eddo com restri\u00e7\u00e3o Auj. > \u20140.05\na restric\u00e3o Aui > -0.05. A figura 3.9 mostra a resposta com o MPC distribu\u00eddo utilizando 50 trocas de dados entre os 3 agentes enquanto que a figura 3.10 apresenta os resultados com o MPC centralizado utilizado o otimizador quadprog do Matlab. Em geral as respostas s\u00e3ao bem semelhantes.\n3.4.2\tRestri\u00e7\u00f5es sobre u\nAs restri\u00e7\u00f5es sobre u podem ser tratadas de forma semelhante ao que foi feito com aquelas sobre os incrementos de controle Au. Deve-se ressaltar que qualquer ac\u00e3o de controle s pode ser escrita\ny\n0.6\ntempo [ h ]\nLambda\n-0.4 1-------111-----------------------1\n0\t2\t4\t6\t8\ntempo [ h ]\nFigura 3.10: Resposta do MPC Centralizado com restricao Au > -0.05\ncomo\nus = uS 11 + DAus, onde\nD\n10\t\u2022\u2022\u2022\t0\n11\t...\t0\n11\t...\t1\n(3.42)\nO vetor uS 11 de dimens\u00e3o m x 1 e composto pelos valores da a\u00e7\u00e3o de controle us implementada no instante de amostragem\nanterior. Para o caso de restri\u00e7\u00e3o no valor maximo de uma deter-\nminada a\u00e7ao de controle s, u\u2122\u2122, a funcao custo aumentada com\nos operadores de Lagrange seria escrita como\nmin\nAu\ns. a\nL =\nA\n>\nT\ns\nL\n-AuT5Au + eTAu + AT (DAus + \u00abs-11 - C\u201cx1)\n0\t(3.43)\nPara os agentes diferentes de s,\nAug Ik = -$-1eg\t(3.44)\nPara o agente s,\ndL dAus dL dA\n$sAus + es + Dt As \u2014 0\nDAus + \u00abs-11 - C\u201cx1 = 0\nAs >\t0\n(3.45)\nNeste caso define-se o erro ao atendimento da restri\u00e7ao como\n\u00a3 = Aus + D-1 (uS-11 -\t.\t(3.46)\nA partir da equa\u00e7ao (3.46) e (3.45) pode-se obter\n= G = - (DT)\u201c1 $SD-1\t(3.47)\nA equa\u00e7\u00f5o (3.47) mostra o gradiente de As em rela\u00e7\u00f5o ao vetor S, G. Para um vetor com um incremento unita\u00e9rio nos componentes\nde S = Sun pode-se obter o vetor unit\u00e9rio que mostra a direc\u00f5o\ndo ajuste de As,\nAd =\n-GAEun\ngae. .. \u2022\n(3.48)\nComo ja feito anteriormente, para um determinado vetor erro S pode-se calcular o incremento do vetor AAs como a projecao de S no vetor unit\u00e9rio Ad,\nAA \u2014 (E.Ad)Ad, ou\nAsk \u2014 Ask-1 + (E.Ad)Ad\nAk > 0\n(3.49)\nO processo iterativo \u00e9 semelhante ao que j\u00e1 foi explicado para a restri\u00e7\u00e3o em Au. As figuras 3.11 e 3.12 mostram a comparac\u00e3o entre a aplica\u00e7\u00e3o do algoritmo distribu\u00eddo e centralizado para o caso de uma restri\u00e7\u00e3o em ui, ui &lt;0.35. A figura 3.11 mostra a resposta obtida com o MPC distribu\u00eddo utilizando 35 trocas de informa\u00e7\u00e3o entre os 3 agentes utilizados. A figura 3.12 mostra a resposta obtida com o algoritmo MPC centralizado. Observase que as respostas s\u00e3ao muito semelhantes e ambas as tecnicas obedecem a restri\u00e7c\u00e3ao.\ny\nAu,\n\t\t\t\nOu.\t\t\t\n\t\tvr\t\n\t\t\t\n-0.2 ---------!----------!----------!---------\n0\t2\t4\t6\t8\ntempo [ h ]\nFigura 3.11: Resposta do MPC Distribu\u00eddo com restri\u00e7\u00e3o u1 &lt;0.35\n3.4.3\tRestri\u00e7\u00f5es sobre y\nEste e o principal desafio para a aplicac\u00e3o de controle preditivo na forma distribu\u00edda. A introduc\u00e3o de restri\u00e7\u00f5es sobre uma determinada sa\u00edda afeta um grupo de agentes responsaveis pelo comportamento desta sa\u00edda tornando o problema mais complexo do que foi para as restric\u00e3es sobre Au e u. Sem perda de generalidade discute-se aqui o tratamento para a restri\u00e7\u00e3o em uma das sa\u00eddas, sa\u00edda j, do tipo yj &lt;ymax. Como ja feito anteriormente ha de se restringir o valor de yj ao longo de todo o horizonte de predicao\n0\n8\n0\n8\n2\t4\t6\ntempo [ h ]\n246 tempo [ h ]\nFigura 3.12: Resposta do MPC Centralizado com restri\u00e7\u00e3o u1 &lt;0.35\nneste caso. Assim, do ponto de vista do controle MPC, equivale a dizer\nyj &lt;ymaxiPxi ou\nGjiAui + Gj2Au2 + \u2022 \u2022 \u2022 + Gjn Aun +\t&lt;yjax \u00edp^i50)\nA formula\u00e7\u00e3o do problema de Programa\u00e7\u00e3o Quadr\u00e1tica que determina a a\u00e7c\u00e3ao de controle na formula\u00e7c\u00e3ao centralizada e\nmin\tJ\t\nAu\t\t\ns. a\t\t\nJ =\t|aut 5Au + eT\tAu\nAAu&lt;\tB\t\nA=\t[ Gji Gj2\t\u2022 \u2022 \u2022\tGjn ]\nB=\ty\u201c\u201cx1pXi - Fj\t\nAu =\t[ Aui\tAu2\t\u2022 \u2022\t\u2022 Au\u201e ]T\nAntes de iniciar o procedimento de introduzir a restri\u00e7ao em uma fun\u00e7\u00e3o custo aumentada incorporando os multiplicadores de La-\ngrange, vamos supor que tanto a resposta livre Fj como a res-tric\u00e3o yj &lt;ymax possam ser divididas em tantas partes quantas forem as a\u00e7oes de controle, n. Assim, no lugar de 1 restri\u00e7\u00e3o, teremos n restri\u00e7\u00f5es. Esta suposi\u00e7ao \u00e9 apenas um artif\u00edcio matematico como sera demonstrado na sequ\u00e2encia,\nFj = Fj1 + Fj2 ' Fjn\n= yma + y\u2122ax + ... + y\u2122*\t(3.52)\nA formula\u00e7\u00e3o do problema descrito pela equa\u00e7\u00e3o (3.51) seria modificada para\nmin\t\tJ\t\nAu\t\t\t\ns. a\t\t^AuT\t\nJ\t\t\t$Au + eT Au\n\t\t2\t\nGj1Au1\t<\t\u201e max yji\t-\t-Fj!\nGj2Au2\t<\tmax yj2\t-\tFj2\nGjn Aun\t<\tmax yjn\t-\t_ Fjn-\nAgora pode-se propor uma fun\u00e7\u00e3o custo aumentada introduzindo-\nse as restri\u00e7c\u00e3oes com\t\tos multiplicadores de Lagrange.\nmin\t\tL\nAu\t\t\ns. a\t\t|aut 4Au + 0T Au +\nL\t\t\n\t\tA (GjjAu! - ymax + j + Af (Gj2Au2 - y\t+ Fj2) +\n\t\t... +\n\t\tAf (Gj\u201eaU - y\u2122nax + F .\nAi\t>\t0pX 1\nA2\t>\t0pX 1\nAn >\t0px1\n(3.54)\nSeguindo com a estrategia de se buscar\n[ dL dAu\u00ed\ndL dAu2\ndAUn ]T = [0 0 \u2022\u2022\u2022 0 ]T>\t(3.55)\naplica-se as cond^\u00e3es para minimiza\u00e7\u00e3o da equa\u00e7\u00e3o (3.54),\ndL dAui\ndL\ndAu2\ndL dAun dL d\u00c3i dL d\u00c3~2\ndL dAn\nAi\nA2\n$iAui + ei + Gt1Ai = 0\n$2Au2 + e2 + gt2a2 = 0\n$nAun + en + GTnAn = 0\nSi = GjiAui - ymx + Fji = 0\n\u00a32 = Gj2Au2 - ym2ax + Fj2 = 0\n= Sn = GjnAun - y^ + Fjn = 0\n>\t0px i\n>\t0px i\nA\u201e > 0pXi\t(3.56)\nDeve-se encontrar os vetores Aug, g = 1 : n, que satisfacam a equacao (3.56). E interessante observar que ao somar as ex-pressoes para \u00a3i, recupera-se a restri\u00e7ao original.\n\u00a3\t=\t\u00a3i + \u00a32 + \u2022 \u2022 \u2022 + \u00a3n, ou\n\u00a3 = GjiAu! - ymax + Fj! + Gj2Au2 - ym2ax + Fj2 +\n. +\nGj\u201eAu\u201e - ymax + Fjn\t(3.57)\nO grande desafio \u00e9 determinar os vetores Ag, g = 1 : n, pois cada agente calcula sua ac\u00e7\u00e3ao de controle como\nAug = -$g-1 (eg + GTg Ag )\t(3.58)\nTrabalhando-se com as equa\u00e7\u00f5es 3.56 e 3.57 as seguintes rela\u00e7\u00e3es s\u00e3o obtidas,\n(3.59)\nA equa\u00e7\u00e3o 3.59 sugere que uma pequena viola\u00e7\u00e3o na restri\u00e7\u00e3o para yj, AS, poderia ser eliminada mudando cada Ai pelo valor apresentado na equa\u00e7ca\u00e3o 3.60,\nAAi = (g^G^)-1 AS.\t(3.60)\nEntretanto a invers\u00e3ao da matriz apresentada na equa\u00e7c\u00e3ao 3.60 n\u00e3ao e realizavel para sistemas com atraso de transporte que ir\u00e3ao exibir um determinado numero de linhas com zeros para Gji. Diante disso buscou-se uma forma heur\u00edstica que mostrou bom resultados. Um vetor Vji \u00e9 montado conforme equacao 3.61,\nVji = (g^-G) 1,\t(3.61)\nem seguida, cada elemento n\u00e3o nulo de Vji \u00e9 invertido e o vetor resultante \u00e9 normalizado resultando no vetor Vj.orm. Para cada agente g, (g G 1 : N), o seguinte pseudo-codigo \u00e9 executado a cada instante de amostragem t,\n\u2014\tTodos os vetores A\u00ed s\u00e3o inicializados com zeros.\n\u2014\tOs vetores Vj\u00b0rm s\u00e3o computados offline,\n\u2014\tCada agente g calcula Sk, o erro ao atendimento a restri\u00e7\u00e3o,\nN\nGj\u00edAuk-1 + Fj - ymax1\t(3.62)\ni\n\u2014\tAg \u00e9 atualizado como\nAkg=Ag-1+yk.vn\u00b0ry v\u2122rm\n\u2014\tQualquer elemento negativo de Ag \u00e9 for\u00e7ado a zero.\n\u2014\tAug \u00e9 calculado de acordo com a equacao 3.58.\n(3.63)\n\u2014 Aplica-se o filtro em Au()\nAu^ = (1 \u2014 aJAuJ + aAug 1\t(3.64)\nO processo \u00e9 iterativo e aquelas a\u00e7\u00e3es de controle que n\u00e3o afetam a restri\u00e7\u00e3o acabam tendo um operador de Lagrange nulo devido a restricao Aj > 0. Deve-se observar que o procedimento iterativo permite que os valores positivos de Aj aumentem ou diminuam para atender a restri\u00e7c\u00e3ao sempre se mantendo na\u00e3o negativos. As figuras 3.13, 3.14e 3.15 mostram a resposta obtida com controle MPC DMC centralizado e distribu\u00e9do para uma restri\u00e7\u00e3o em y2, y2 &lt;0.26. Em todas as figuras apresenta-se na coluna \u00e0 esquerda as sa\u00e9das no topo e as ac\u00e3es de controle na base. Na coluna da direita apresenta-se uma ampliac\u00e7a\u00e3o na regi\u00e3ao onde a restri\u00e7c\u00e3ao est\u00e9a ativa no topo, e os operadores de Lagrange na base.\nA figura 3.13 mostra o resultado de simulac\u00e3o para o MPC centralizado com uma restri\u00e7\u00e3o em y2, y2 &lt;0.26. Neste caso sao utilizados somente 15 multiplicadores de Lagrange, p = 15. A figura 3.14 mostra a resposta obtida com a aplica\u00e7c\u00e3ao do controle MPC distribu\u00e9do proposto usando 35 trocas de informa\u00e7ca\u00e3o entre os agentes enquanto que a figura 3.15 apresenta a resposta quando o numero de troca de informac\u00f5es utilizado foi 50. Fica evidente que o aumento do numero de troca de informa\u00e7\u00e3es melhora a resposta. O resultado obtido com 35 trocas de informa\u00e7ca\u00e3o \u00e9e similar aquele obtido com o MPC centralizado enquanto que a resposta resultante da aplica\u00e7ca\u00e3o do algoritmo distribu\u00e9do com 50 trocas de informa\u00e7c\u00e3ao apresenta um comportamento melhor. Percebe-se que a resposta com o algoritmo distribu\u00e9do, al\u00e9em de atender a restric\u00e3o, segue melhor a referencia e apresenta uma perturbac\u00e3o menor na sa\u00e9da y2.\nUma poss\u00e9vel raz\u00e3o para esse resultado \u00e9 que o algoritmo dis-tribu\u00e9do utiliza um nu\u00e9mero de multiplicadores de Lagrange muito maior do que o algoritmo quadpro do Matlab. A t\u00e9cnica de calcular um vetor com os multiplicadores de Lagrange para cada agente a fim de anular o erro projetado resulta em um numero muito grande de multiplicadores de Lagrange o que acaba resultando em uma melhor resposta.\nFigura 3.13: Resposta utilizando MPC centralizado com restri\u00e7ao em y2, y2 &lt;0.26\ny\ntempo [ h ]\n-0.2 -------'-------'-------'-------\n0\t2\t4\t6\t8\ntempo [ h ]\ntempo [ h ]\nFigura 3.14: Resposta utilizando MPC distribu\u00eddo com 35 trocas de informa\u00e7\u00e3o e restric\u00e3o em y2, y2 &lt;0.26\ny\ntempo [ h ]\ny\ntempo [ h ]\ntempo [ h ]\nFigura 3.15: Resposta com MPC distribu\u00eddo com 50 trocas de informa\u00e7\u00e3o e restric\u00e3o em y2, y2 &lt;0.26\n3.5\tConclus\u00f5es e desenvolvimentos futuros\nA metodologia apresentada buscou resolver o problema de controle MPC multivariavel de forma distribu\u00edda frente as restri\u00e7\u00f5es tipicamente tratadas na industria. Acredita-se que esta tecnica permitir a a utiliza\u00e7ca\u00e3o de controle preditivo de forma mais intensa principalmente onde ja se utilizam sistemas de controle via redes fieldbus, por exemplo. Em uma rede Foundation Fieldbus, por exemplo, um bloco funcional poderia ser oferecido que, quando instanciado em diferentes instrumentos permitiria a obten\u00e7c\u00e3ao da lei de controle do MPC atraves da troca de informa\u00e7c\u00e3oes no bar-ramento H1 da rede. Uma solu\u00e7\u00e3o MPC desse tipo permitiria uma adapta\u00e7ao do algoritmo \u00e0 um aumento da planta de forma relativamente simples ja que novos blocos poderiam ser instanciados com comunica\u00e7co\u00e3es com outros blocos conforme a natureza da soluc\u00e7\u00e3ao. Para o caso sem restric\u00e7\u00e3oes apresentou-se as condi\u00e7c\u00e3oes necess arias para a estabilidade do algoritmo. Existem entretanto diversos aspectos que precisam ser estudados com mais profundidade. Na sequ\u00eaencia do trabalho pretende-se\n\u2014\tdesenvolver tecnicas que incorporem garantia de estabilidade para a solu\u00e7c\u00e3ao obtida com o processo iterativo dos agentes,\n\u2014\taplicar as tecnicas desenvolvidas no cap\u00edtulo 4 para o tratamento de erro de modelagem e acrescentar tecnicas de iden-tifica\u00e7c\u00e3ao em malha fechada que permitam a aplicac\u00e7a\u00e3o da tecnica em plantas com pouco conhecimento dos modelos din\u00eaamicos. Os agentes teriam a capacidade de identificar novos modelos na medida em que determinassem \u00edndices de desempenho com potencial para melhorias com os modelos atuais,\n\u2014\testudar o comportamento do sistema frente a falhas de co-munica\u00e7c\u00e3ao, falhas nos atuadores da camada regulat oria, etc,\n\u2014\tdesenvolver tecnicas para diminuir o numero de troca de informa\u00e7\u00f5es. Estudar a influencia do numero de troca de informa\u00e7c\u00e3oes frente a perturbac\u00e7\u00e3oes, seguimento de refer\u00eaencia, etc,\n\u2014\testudar a formula\u00e7ao para aplicacao de NMPC (Nonlinear MPC).\nCap\u00edtulo 4\nMPC Pr\u00e1tico para sistemas n\u00e3o lineares -PNMPC\n4.1\tIntrodu\u00e7\u00e3o\nDesde seu surgimento a tecnica de controle preditivo para sistemas lineares vem se tornando cada dia mais popular na industria, principalmente depois do surgimento do Controle Preditivo DMC. A aplica\u00e7ao de Controle Preditivo requer a determina\u00e7\u00e3o de um modelo do processo. Como a maioria dos processos sa\u00e3o efetivamente n\u00e3ao lineares recorre-se a tecnicas de lineariza\u00e7c\u00e3ao para a obten\u00e7c\u00e3ao do modelo. Para muitos processos este procedimento e aceit\u00e1vel, seja pelo n\u00edvel de nao linearidade do processo ser pequeno ou pelo fato da planta operar sempre em uma regi\u00e3ao muito proxima do ponto de opera\u00e7c\u00e3ao utilizado na lineariza\u00e7ca\u00e3o do modelo. Seja um processo sem acoplamento direto entrada-sa\u00edda descrito por\nx = f (x, u),\ny(x) = h(x),\n(4.1)\nonde x \u00e9 um vetor com os estados do processo e y um vetor com as sa\u00eddas. Os pontos de equil\u00edbrio do processo s\u00e3o obtidos fazendo-se X = 0, ou f (xeq., ueq.) = 0 e yeq. = h(xeq.), onde yeq., xeq., ueq. s\u00e3o respectivamente as sa\u00eddas, os estados e as entradas nos pontos de equil\u00edbrio do sistema. Para um ponto de equil\u00edbrio na origem, pode-se escrever\nx = Ax + Bu, y = Cx,\nonde\nA\nB\nC\n211\ndx lXe9' ,Ueq\n211\ndu lXeq' ?Ueq\ndh | dx|Xeq' \u2019Ueq\n(4.2)\n(4.3)\nNa equa\u00e7\u00e3o 4.3 a matriz A e conhecida como o Jacobiano de f(x, u). Seus autovalores definem a estabilidade dos pontos de equil\u00edbrio xeq, ueq..\nO modelo representado na forma de equa\u00e7\u00f5es de estado cont \u00ednua pela equac\u00e7\u00e3ao 4.2 pode ser convertido na forma de equa\u00e7c\u00e3oes de estado discreta ou na forma de fun\u00e7\u00e3o de transfer\u00eancia.\nA linearizac\u00e7\u00e3ao pode tambem ser realizada utilizando-se o conceito de vari avel desvio onde se aplica uma mudan\u00e7ca de vari aveis para levar o equil\u00edbrio \u00e0 origem.\nx\u00e1 = x - xeq.,\nU\u00e1 = U - Ueq..\t(4.4)\nNeste caso pode-se igualmente descrever o sistema pela equa\u00e7\u00e3o de estado para pontos de equil\u00edbrio nao triviais,\nxs = Axs + Bu,\ny = yeq. + Cx\u00e1.\t(4.5)\nA tecnica de lineariza\u00e7ao em pontos de equil\u00edbrio do sistema tem sido aplicada principalmente de duas formas. A forma tradicional considera o modelo linearizado invariante e utiliza-o para fazer as predic\u00e3es. Uma forma mais elaborada consiste em atualizar o\nmodelo a cada instante de amostragem e considera-lo invariante ao longo do horizonte de predi\u00e7\u00e3o.\n4.2\tMetodologias de MPC para Processos N\u00e3o Lineares\nExiste uma grande quantidade de tecnicas MPC que direta ou indiretamente tratam sistemas n\u00e3o-lineares [55]. Uma poss\u00edvel classifica\u00e7\u00e3o destas tecnicas as divide em 3 grupos: (a) as que utilizam diretamente um modelo n\u00e3ao linear generico e um algoritmo de otimiza\u00e7ao n\u00e3o linear de proposito geral; (b) as que utilizam modelos n\u00e3ao lineares particulares e metodos de otimiza\u00e7\u00e3o espec\u00edficos para o modelo escolhido; (c) as que utilizam um ou varios modelos lineares para representar o processo e algor\u00edti-mos de otimizac\u00e7\u00e3ao lineares. Evidentemente as vantagens de uma ou outra alternativa est\u00e3ao diretamente relacionadas ao compromisso desempenho-custo computacional. Nesta se\u00e7\u00e3o discute-se, com uma vis\u00e3o pratica, as vantagens e desvantagens de algumas destas tecnicas, para fornecer subs\u00eddios ao projetista na hora de escolher uma ou outra metodologia.\n4.2.1\tMPC com modelos de predicao nao-linear na Fun\u00e7ao Objetivo\nUma abordagem natural e a utiliza\u00e7c\u00e3ao das predi\u00e7co\u00e3es na fun\u00e7c\u00e3ao objetivo empregando o modelo n\u00e3o-linear. A minimizac\u00e3o da func\u00e7\u00e3ao objetivo e realizada com programas de otimiza\u00e7c\u00e3ao especializados na solu\u00e7c\u00e3ao de fun\u00e7c\u00e3oes na\u00e3o-lineares como Programa\u00e7c\u00e3ao N\u00e3o Linear ou Sequential Quadratic Programming (SQP), etc. S\u00e3o preservadas as caracter\u00edsticas de horizonte deslizante e a repeti\u00e7\u00e3o da otimiza\u00e7ao a cada per\u00edodo de amostragem. O problema de otimiza\u00e7c\u00e3ao a ser resolvido pode em geral ser colocado como\nu = argmin f (W, Y, 11, u)\t(4.6)\nSujeito a :\nh(u) = 0,\ng(u) &lt;0, onde\nW \u00e9 o vetor com as refer\u00eancias futuras, Y \u00e9 o vetor com as sa\u00eddas presentes e passadas, u \u00e9 o vetor com as entradas passadas e u \u00e9 o vetor com as entradas presente e futuras. Al\u00e9m disso, f : Rn \u2014> R, h : Rn \u2014> Rm e g : Rn \u2014> Rp sao func\u00f5es cont\u00e9nuas e diferenci\u00e9aveis.\nDo ponto de vista pratico a principal vantagem deste metodo reside no uso de um modelo n\u00f5o linear, que permite em geral, obter predi\u00e7\u00f5es muito pr\u00f3ximas as sa\u00e9das reais da planta. Como desvantagens devem citar-se as quest\u00f5es iterativas dos m\u00e9todos de otimiza\u00e7\u00f5o, a incerteza no tempo que levam para entregar uma resposta, a converg\u00eaencia, as solu\u00e7c\u00f5oes em m\u00e9nimos locais, etc. que fazem com que sua utiliza\u00e7\u00f5o para controle em tempo real seja ainda pouco difundida. Alguns deste pontos s\u00f5ao discutidos em [56].\n4.2.2\tM\u00e9todos baseados em modelos particulares\nUma forma de obter uma solucao mais simples que a correspondente ao modelo na\u00f5o linear gen\u00e9erico consiste em utilizar modelos n\u00f5o lineares particulares como por exemplo S\u00e9ries de Volterra ou modelos de Hammerstein [57, 58]. Estas alternativas s\u00f5o interessantes na pra\u00e9tica quando o caso estudado enquadra-se bem na aproxima\u00e7ao selecionada. O compromisso entre complexidade de c\u00e9lculo e desempenho \u00e9 novamente o fator determinante da escolha. A otimiza\u00e7\u00f5o nestes casos pode ser mais simples que no caso geral. Do ponto de vista pr\u00e9atico \u00e9e importante notar que o uso de um modelo mais complexo que represente melhor a din\u00eaamica do processo real somente ser\u00e9a vantajoso quando o erro de modelagem for pequeno. Em outros casos a des-sintonia do controlador necess\u00e9aria para manter a robustez pode eliminar a vantagem do uso de um melhor modelo.\n4.2.3\tMetodos baseados em lineariza\u00e7\u00f5es\ncontrolado ser\u00e1 proporcional as diferen\u00e7as entre o modelo e o processo. Diversas abordagens baseadas em simplifica\u00e7\u00f5es, lineariza\u00e7\u00f5es e LMPC tem sido propostas. Algumas delas sao analisadas no que segue.\nPondera\u00e7\u00e3o de m\u00faltiplos modelos lineares\nPara um determinado modelo n\u00f5o linear representado por\nx =\tf (x, u)\ny =\th(x)\n(4.7)\npodem-se obter modelos lineares nos equil\u00edbrios do sistema. Estes equil\u00edbrios s\u00f5o definidos pelo conjunto de pontos P = {(x*, u*) s. a X = f (x*, u*) = 0}. Um modelo linear pode ser obtido ao redor de um equil\u00edbrio (x\u00ae, u\u00ae) G P como\nx = Ai(x - xi) + Bi(u - ui)\t(4.8)\ny = h(xi) + Ci(x - xi), onde\nAi = df (x,u)\nA =\tdx\nl(xgu^), B\ndf (x,u) du\n|(x\u00bf,u\u00bf) e Ci =\ndh(x,u) dx\n|(x\u00bf,u\u00bf).\nOs modelos cont\u00ednuos obtidos tem um equivalente discreto com\nmatizes Ad, Bd, Cd. Em algumas condicoes, o modelo nao linear da planta pode ser recuperado pela combina\u00e7\u00f5o de N modelos politopicos\ni=N\ti=N\n[Ad, Bd] = ^2 OiAd\u2019 Bd], onde ^2 a\u00ae = 1\t(4.9)\ni=1\ti=1\nEsta ideia pode ser explorada no contexto de controle MPC robusto, MPC adaptativo ou MPC escalonado. Em [59], [60] e [61] discute-se a utiliza\u00e7ca\u00f5o de multiplos modelos lineares com enfoque na proposta de controle MPC robusto. Em [62] discute-se a utiliza-\u00e7c\u00f5ao de multiplos modelos em uma proposta de MPC escalonado. Em [63] um esquema adaptativo utilizando MPC DMC \u00e9 apresentado para um sistema de uma entrada e uma sa\u00edda. O custo computacional e o desempenho destes metodos esta diretamente relacionado ao numero de modelos necessarios e aos procedimentos de pondera\u00e7c\u00f5ao, que em geral n\u00f5ao s\u00f5ao simples de generalizar.\nM\u00e9todo min-max\nEste metodo foi desenvolvido para sistemas lineares que apresentam comportamentos dependentes de par\u00e2metros variaveis no tempo ou perturbac\u00e7\u00e3oes e pode ser usado para processos n\u00e3ao lineares quando estes sao representados aproximadamente por um conjunto de modelos lineares. A filosofia utilizada na tecnica min-max e determinar a a\u00e7c\u00e3ao de controle que minimiza uma fun\u00e7c\u00e3ao objetivo para o cenario em que o conjunto de perturbac\u00e7\u00e3oes e incertezas a maximizam. A func\u00e7\u00e3ao objetivo penaliza o desvio do comportamento predito pelo modelo e aquele desejado. Considerando o conjunto de vari aveis incertas ou perturb aveis como \u00a9 , pode-se escrever o problema da seguinte forma\nu = argmin J (W, Y, \"u, u)\t(4.10)\nJ = argmax J(W, Y, \"u, u, 0)\nsujeito \u00e0s restri\u00e7\u00e3es nas variaveis de controle e de processo. Esta tecnica e considerada custosa computacionalmente pois, dependendo do numero de variaveis incertas e dos horizontes de predi\u00e7\u00e3o e controle pode haver uma explosao de combina\u00e7oes a serem investigadas para a determinac\u00e7\u00e3ao do maximo. A tecnica de otimiza\u00e7ca\u00e3o min-max surgiu de pesquisas na area da teoria dos jogos din\u00e2micos. Em [64], [65], [66] e [67] prop\u00e3e-se a utiliza\u00e7\u00e3o da otimiza\u00e7\u00e3o min-max em MPC utilizando modelos baseados na resposta ao impulso. Outros autores desenvolveram algoritmos MPC utilizando a tecnica de otimiza\u00e7ca\u00e3o min-max para sistemas representados por equa\u00e7\u00e3es de estados. Em um trabalho recente nesta area, [68] prop\u00e3oe-se uma tecnica MPC baseada em otimiza\u00e7ca\u00e3o min-max mas que sugere uma forma de diminuir o custo computacional. No lugar de buscar o m aximo da fun\u00e7c\u00e3ao custo considerando todas as combinac\u00e3es poss\u00edveis para o conjunto de incertezas e o horizonte de predi\u00e7c\u00e3ao, os autores mostram uma tecnica onde se determina um limite superior (upper bound) para a maximizac\u00e3o da fun\u00e7\u00e3o custo que sera ent\u00e3ao minimizada.\nAssim, esta abordagem n\u00e3ao se apresenta interessante do ponto de vista pr atico dado que n\u00e3ao se mostra computacionalmente mais atrativa que a de NMPC.\nLineariza\u00e7\u00f5es a cada instante de amostragem\nMuitas pesquisas nesta area visam a resoluc\u00e7\u00e3ao, por metodos alternativos, do problema de otimizac\u00e3o n\u00e3o linear. Em alguns casos, como em [69], estende-se a ideia de resposta livre yi e for\u00e7ada yj usando um modelo n\u00e3o linear para o calculo de yl e um modelo linear para yf supondo que esta ultima pode convergir a zero num procedimento iterativo. Desta forma o problema de otimiza\u00e7c\u00e3ao n\u00e3o linear pode ser transformado numa sequ\u00eancia de problemas de otimiza\u00e7c\u00e3ao linear. Esta metodologia pode funcionar adequadamente em alguns casos praticos sem necessidade de muitas iter-a\u00e7co\u00e3es mas na\u00e3o garante a obtenc\u00e7\u00e3ao do otimo nem a converg\u00eaencia do processo iterativo [70]. Em outros casos utilizam-se lineariza-\u00e7c\u00e3oes sucessivas em torno ao ponto de opera\u00e7c\u00e3ao transformando o modelo num sistema variante no tempo, mas que permite utilizar algoritmos mais simples para minimizar J [71, 72].\nEm todos os casos anteriores onde s\u00e3ao usadas aproxima\u00e7co\u00e3es tratase de compensar as perdas no desempenho com a maior velocidade de processamento e simplicidade dos algoritmos. Assim, pode-se considerar como melhor aquele algoritmo que consiga o melhor compromisso desempenho-simplicidade-velocidade. Como se vera na proxima se\u00e7c\u00e3ao, este objetivo pode ser atingido com uma abordagem pratica e simples de NMPC.\n4.3\tDesenvolvimento da t\u00e9cnica PNMPC\nConforme discutido no ap\u00eaendice A, os algoritmos de controle preditivo para sistemas lineares como o DMC e o GPC utilizam a representacao do vetor de predicoes ao longo do horizonte p, Y, como uma funcao do vetor com m mudancas na ac\u00e3o de controle Au,\nY = F + GAu,\t(4.11)\nA tecnica proposta neste trabalho difere das propostas anteriores principalmente pelo fato de utilizar modelos linearizados independentes dos pontos de equil\u00edbrio do sistema. Deve-se perceber que ao se calcular as predicoes, para um sistema linear ou n\u00e3o linear, os unicos elementos que podem mudar os valores das predi\u00e7\u00e3es s\u00e3o os elementos do vetor incremento de controle Au.\nBusca-se uma forma de descrever a evolucao dos estados do sistema ao longo do horizonte de predi\u00e7ca\u00e3o utilizando uma represen-ta\u00e7c\u00e3ao linear dos estados em rela\u00e7ca\u00e3o aos incrementos de controle futuros. Para isto n\u00e3ao se utiliza o conceito de ponto de equil\u00edbrio. Assume-se que as predi\u00e7\u00f5es Yp dependem das entradas passadas ii, dos estados presentes e passados y\" e dos incrementos de entradas futuros Au,\nYp = f ( y , u, Au).\n(4.12)\nO Vetor com as predi\u00e7\u00e3es \u00e9 reescrito como\nF + GpnMPCAu,\n(4.13)\nYp\nonde\nF\nGpNMPC\nf( y\", u\"),\nd Yp\nd Au\nA matriz GpNMpC \u00e9 o Jacobiano de Yp.\nDesenvolve-se aqui uma forma de representa\u00e7c\u00e3ao das predic\u00e7\u00e3oes que pode ser utilizada tanto para sistemas representados por modelos lineares como para aqueles representados por modelos n\u00e3ao lineares desde que os estados sejam cont\u00ednuos e diferenci\u00edveis em rela\u00e7\u00e3o as entradas.\nSeja x \u00a3 e w um vetor de fun\u00e7oes cont\u00ednuas e diferenciaveis\nde x.\nw=\nw1(x1> x2 , ... , xm )\nW2(X!,X2, . . . ,Xm)\n(4.14)\nwp (x1, x2, ... , xm )\ne um vetor p x 1 das fun\u00e7\u00e3es de m vari\u00e9veis do vetor\nPara pequenas varia\u00e7\u00e3es de x igual a Ax em torno de xo,\nAx = [ Ax i Ax2 ... Axm ]T,\t(4.16)\npode-se obter uma aproxima\u00e7ao de w(xo + Ax) utilizando-se a s\u00e9rie de Taylor onde os termos de ordem maiores do que 1 s\u00e3o desprezados.\nw(xo + Ax) = w(xo) + dx (xo)Ax,\t(4.17)\nonde dx e o gradiente de w relativo a x calculado em x = xo.\nd w\nd x\ndw\u00ed\tdw\u00ed\tdw\u00ed\ndx\u00ed\tdx2\t\ndw2\tdw2\t\u2022\tdw2\ndx\u00ed\tdx2\t\ndwp\tdwp\ndx\u00ed\tdx2\ndwp\n(4.18)\nX=Xo\nSeja o sistema din\u00eamico nao linear cont\u00ednuo e diferenciavel com uma entrada e uma sa\u00e9da representado pela equa\u00e7c\u00e3ao (4.19):\ny(k) = f (y(k - na),y(k - na + 1)...,y(k - 1),\nu(k - nu), u(k - nu + 1), ..., u(k - 1)),\t(4.19)\nonde na e nb s\u00e3o os maiores atrasos de y e u respectivamente. Assume-se que as entradas ocorrer\u00e3ao em um horizonte de controle m. Neste horizonte aparecem as seguintes entradas\nu(k)\t= u(k - 1) + Au(k)\nu(k +1) = u(k) + Au(k + 1) = u(k - 1) + Au(k)\n+ Au(k + 1)\nu(k + m - 1) = u(k - 1) + Au(k) + Au(k + 1)\n+\t+ Au(k + m - 1).\n(4.20)\nAssume-se que as entradas nos instantes posteriores a k + m - 1 sejam iguais a u(k + m - 1). Calculando-se as predi\u00e7\u00e3es em um horizonte de predi\u00e7c\u00e3ao p a partir do modelo dado pela equa\u00e7ca\u00e3o\n(4.19)\ttem-se\ny(k + 1) = f (y(k - na + 1)..., y(k), u(k - nu + 1), ...,u(k)) (4.21)\ny(k + 2)\t=\tf (y(k - na\t+ 2)...,y(k\t+ 1),u(k - nu + 2), ...,u(k + 1))\ny(k + p)\t=\tf (y(k - na\t+ p)...,y(k\t+ p - 1),u(k - nu + 1), ...,u(k + m\t- 1))\nConsiderando as equa\u00e7\u00e3es 4.20, o conjunto de equac\u00e3es 4.21 pode ser reescrito como\ny(k + 1) = f (y(k - na + 1)...,y(k),u(k - nu + 1), ...,u(k - 1), Au(k)) y(k + 2) = f (y(k - na + 2)...,y(k + 1),u(k - nu + 2), ...,u(k - 1), Au(k), Au(k + 1))\ny(k + p) = f (y(k - na + p)...,y(k + p - 1),u(k - nu + 1), ...,u(k - 1), Au(k), Au(k + 1),Au(k + m - 1))\t(4.22)\nObserva-se que as predic\u00e3es s\u00e3o fun\u00e7\u00e3es de Au(k), Au(k+1),\tAu(k+\nm \u2014 1), das entradas passadas e das sa\u00eddas presentes e passadas. Se denominarmos o conjunto de entradas passadas de upassado e as entradas atuais e passadas de ypassado entao as predicoes podem ser reescritas como\ny(k + 1)\t\u2014\tf (ypassado, upassado,\tAu(k))\t(4.23)\ny(k + 2)\t\u2014\tf (ypassado,upassado,\tAu(k), Au(k + 1))\ny(k + p)\t\u2014\tf (ypassado, Upassado,\tAu(k), Au(k +1),..., Au(k +\tm \u2014 1))\nNota-se claramente que os unicos elementos com poder de variar as sa\u00eddas futuras s\u00e3o os incrementos da a\u00e7ao de controle Au(k), Au(k+ 1), \u2022\u2022\u2022 , e Au(k + m \u2014 1).\nDefinindo-se\t\nY \u2014\tConjunto de valores passados e presente de y.\nU \u2014\tConjunto de valores passados de u\nu\u2014\tuo + \u00e3u\nuo \u2014\tu(k - 1)1\t(\n\u00e3u \u2014\tDAu\nAu\t\u2014\t[ Au(k) Au(k + 1) ... Au(k + m \u2014 1) ]T\nonde, 1 \u00e9 um vetor de dimens\u00e3o m x 1 com todos elementos iguais a um e D e uma matriz triangular inferior m x m com todos elementos nao nulos iguais a um. As predic\u00e3es podem ser escritas como\nY = f(Y, *\u2014, u).\t(4.25)\nUtilizando o mesmo procedimento que na equa\u00e7\u00e3o 4.17,\nY \u2014 f(Y, Y, uo) +\nd Y du\n\u00e3u\nu=uo\n(4.26)\nUsando as equa\u00e7\u00e3es 4.24:\nd Y\ndY ?\n\u2014\u2014\u00e3u\nd Au\nAu\n(4.27)\nNomeando F = f (Y, u , uo) e Gpnmpc = \u00bfdY\u00fcl\t, onde F e\nu lu=uo\no vetor de predic\u00e3es que seria obtido para Au = 0 e GPNMPC e o gradiente das sa\u00eddas preditas com relac\u00e3o ao vetor dos incrementos de controle Au calculado para Au = 0, a seguinte representacc\u00e3ao compacta e obtida\nY \u2014 F + GpnmpcAu.\n(4.28)\nGpNMpC e a matriz dinamica generalizada que pode ser utilizada para sistemas lineares e para sistemas n\u00e3o lineares cont\u00ednuos e\ndiferenci\u00e1veis.\nGpnmpc \u2014\t\" dyk + 1 d&amp;ui dVk + 2\t0 \u2022 dyk + 2 S&amp;uk + 1\t\u2022\t0 \u2022\t0\t(4.29)\n\td yk+p\td yk+p\td yk+p\t\n\t_\td\u00e1uk\tSAuk+1\tdAuk + m-1\t.\t\nA express\u00e3o 4.28 pode ser escrita para um sistema de uma entrada e uma sa\u00edda como\n' y(k + 1) '\t\tf1(yi u')passado\ny(k + 2)\t\tf2(y u~)passado\n_ y(k + p)\t\tfp(yi u~)passado\n(4.30)\n- dy(k+1) dAu(k) dy(k+2) dAu(k)\n0\ndy(k+2) dAu(k + 1)\nAu(k)\nAu(k + 1)\n0\n0\n0\n0\ndy(k+p)\tdy(k+p)\n- dAu(k)\tdAu(k+1)\ndy(k+p)\n\u00f4Au(k+m-1)\nAu=0\nAu(k + m \u2014 1)\nNota-se neste caso a forma triangular inferior da matriz Jacobiano devido a causalidade do sistema, ou seja\ndy(k +j) dAu(k + i)\n= 0 para i >j\n(4.31)\nA expressao 4.30 representa a equa\u00e7ao 4.28 de forma mais detalhada onde\n\u2014\tY e o vetor p x 1 contendo as predi\u00e7\u00f5es no horizonte de predicao p.\n\u2014\tF \u00e1 o vetor p x 1 contendo as sa\u00eddas preditas supondo que as a\u00e7oes de controle no horizonte de controle m sao mantidas iguais a a\u00e7ao de controle no instante k \u2014 1, ou u(k) = u(k + 1) = ... = u(k + m \u2014 1) = u(k \u2014 1).\n\u2014\tGpnmpc \u00e1 a versao nao linear da matriz din\u00e2mica utilizada no Controle Preditivo DMC ou a versao generalizada v\u00e1lida para sistemas lineares ou nao lineares (p/ sistemas cont\u00ednuos e diferenciaveis). Sua dimensao \u00e9 p x m.\n- Au e o vetor m x 1 contendo os incrementos nas a\u00e7oes de controle no horizonte de controle m.\nE importante observar que para um sistema linear causal invariante no tempo e sem acoplamento direto entrada sa\u00edda, a matriz din\u00e2mica utilizada no Controle Preditivo DMC ou GPC \u00e9 igual aquela obtida com a matriz Gradiente definida na equa\u00e7\u00e3o (4.30).\nA matriz din\u00e2amica do algoritmo DMC ou GPC e normalmente obtida com os elementos da resposta a um degrau unitario aplicado no instante k a um sistema com condi\u00e7\u00f5es iniciais nulas. Ou seja\ny(k + j)\t=\t0 para\tj<0\nu(k + j)\t=\t1 para\tj > 0, ou\nAu(k + j)\t=\t1 para\tj=0\nAu(k + j)\t=\t0 para\tj=0\nSeja uma predi\u00e7\u00e3o yk+j \u2022\nyk+j = f (y(k + j - 1), ...,y(k + 1),u(k))\t(4.32)\nA derivada parcial d\u00a3+j \u00e9 definida como\ndyk+j   lim yk+j(uk-i + Auk) \u2014 yk+j(uk-1)\t(4 33)\nd Auk\tAu^\u20140\tAuk\nComo \u00fck+j e uma funcao linear de u(k) e portanto de u(k \u2014 1) e Au(k), ent\u00e3o yk+j(uk-1 + Auk) _ \u00fck+j(uk-1) + \u00fck+j(Auk) e a derivada pode ser reescrita como\n_ lim \u00fck+j(Auk)\t(4.34)\nd Auk\tAu^\u2014-o\tAuk\nlim f (x)\t_\t0\nx\u2014\u2014c\nlim g(x)\t_\t0, ent\u00e3o\nx\u2014\u2014c\nl.m =\t,\t(4.35)\nx -c g(x)\tx \" g (x)\nse existente. Neste caso devido ao numerador e denominador serem fun\u00e7\u00e3es lineares de Au(k) isto equivale numericamente a se tomar o limite para Auk 1. Assim\ndyk+j = yk+j (Auk = 1)\t(4 36)\nd Auk\t1\nA express\u00e3ao 4.36 representa a resposta do sistema no instante (k+j) ao degrau unitario no instante k que e por defini\u00e7\u00e3o o valor do elemento G(j, 1) da matriz dinamica do algoritmo DMC.\nComo para um sistema linear e invariante no tempo a resposta ao degrau unitario aplicado no instante k + j observado no instante k + j + 1 e igual \u00e0 resposta do sistema a um degrau aplicado no instante k + j + 1 observado no instante k + j + 2, a matriz Gradiente para sistemas lineares tem seus elementos da primeira coluna repetidos nas diagonais. Isto e, para uma matriz G com p > m, G(1,1) = G(2, 2) = ... = G(m, m), G(2,1) = G(3, 2) = ... = G( m +1, m), etc.\nOutra maneira mais simples de demonstrar que a matriz Jaco-biano Gpnmpc equivale a matriz din\u00eamica G do algoritmo DMC ou GPC para sistemas lineares e utilizar a equa\u00e7ao 4.37 apresentada no ap\u00eaendice A.\nNesta equac\u00e7\u00e3ao as predi\u00e7c\u00e3oes s\u00e3ao calculadas atraves da convoluc\u00e7\u00e3ao entre as respostas ao degrau unit ario e os incrementos de entrada.\nj\tto\ny(k +j/k) = ^2 giAu(k+j -i)+ ^2 giAu(k +j-i)+ n(k +j/k) i=1\ti=j+1\nk as predi\u00e7\u00f5es se resumem em\ny(k + j/k)\t=\t^2 g\u00aeAu(k + j - i) + \u00f5(k + j/k),\ni=1\nou\ny(k + 1)\t= gxAu(k)\ny(k + 2)\t= giAu(k + 1) + g2Au(k)\ny(k + j) = giAu(k + j - 1) + g2Au(fe + j - 2)+----+ gjAu(k)\nFica evidente que dy(k + 1) =\ndAu(k)\t= g1\u2019\ndy(k + 2) =\ndAu(k)\tg2\u2019\ndy(k + 2)\t=\nd Au(k +1)\tg1\u2019\ndy(k + j) dAu(k)\n(4.38)\nSeja o sistema din\u00eaamico representado pela equa\u00e7ca\u00f5o a diferen\u00e7cas\ny(k) = ay(k \u2014 1) + bu(k \u2014 1)\n(4.39)\nPara este sistema pretende-se determinar a matriz G utilizada pelo algoritmo DMC e GPC e compar\u00e1-la com a matriz obtida pelo m\u00e1todo generalizado proposto. Para isso avalia-se a resposta do sistema a um degrau unit\u00e1rio no instante k.\nUm degrau unitario em k produz as seguintes entradas no horizonte de controle m, u(k) = 1, u(k + 1) = 1,u(k + m \u2014 1) = 1 e Au(k) = 1, Au(k + 1) = 0,Au(k + m \u2014 1) = 0. A predi\u00e7\u00f5o da resposta do sistema ao degrau unita\u00e1rio no instante k para\ncondi\u00e7\u00e3o inicial nula (y(k) = 0) e\ny(k +1)\t=\tay(k) + bu(k) = b\t(4.40)\ny(k + 2)\t=\tay(k + 1) + bu(k +\t1)\t=\tab + b\ny(k + 3)\t=\tay(k + 2) + bu(k +\t2)\t=\ta(ab +\tb) + b = a2b + ab +\tb\ny(k + p)\t=\tak+p-1b + ak+p-2b\t+\t... + ab +\tb\nReescrevendo-se as predi\u00e7\u00f5es de forma alg\u00e9brica para k = k +1 at\u00e9 k = k + p e supondo m = p para simplificar, t\u00eam-se:\ny(k + 1) =bu(k) = b(u(k \u2014 1) + Au(k))\t(4-41)\n=bAu(k)\ny(k + 2) =ay(k + 1) + bu(k + 1)\n=abAu(k) + b(u(k) + Au(k + 1))\n=abAu(k) + bAu(k) + bAu(k + 1)\n=(ab + b)Au(k) + bAu(k + 1)\ny(k + 3) =ay(k + 2) + bu(k + 2)\n=a(ab + b)Au(k) + abAu(k + 1) + bAu(k)\n+bAu(k + 1) + bAu(k + 2)\n=(a2b + ab + b)Au(k) + (ab + b)Au(k + 1) + bAu(k + 2)\ny(k + p) =(ap 1b + ap 2b + ... + ab + b)Au(k) + ... +(ab + b)Au(k + m \u2014 2) + bAu(k + m \u2014 1)\nUtilizando-se a resposta ao degrau para a montagem da matriz G do Controle Preditivo DMC temos\ngdmc =\nb ab + b a2 b + ab + b\n00 b0 ab + b\tb\n00\n00\n00\nap 1 b + ap 2b + ... + ab + b . ..\ta2b + ab + b ab + b b\n(4.42)\nE evidente que utilizando-se a expressao do Gradiente dado pela equa\u00e7c\u00e3ao (4.30) sobre as predi\u00e7c\u00e3oes apresentadas pela equa\u00e7c\u00e3ao (4.41) conclui-se que Gpnmpc = Gdmc para o exemplo de sistema linear apresentado.\n4.3.1\tA obten\u00e7\u00e3o de F e Gpnmpc\nA tecnica de controle preditivo baseado em modelo pressupo\u00e3e a disponibilidade de um modelo matematico do processo. Neste trabalho estuda-se a aplicac\u00e7\u00e3ao de controle preditivo a sistemas amostrados a uma taxa de amostragem Ts. Devido a grande variedade de estruturas para representa\u00e7c\u00e3ao de processos como redes neurais, modelos NARMAX, equac\u00e3es a diferen\u00e7as n\u00e3o lineares, etc., torna-se pouco pratico propor uma solu\u00e7c\u00e3ao de controle baseado em express\u00e3es matematicas para F e Gpnmpc\u2022 Preferiu-se a sua obten\u00e7ca\u00e3o de forma numerica. Para isso pressup\u00e3oe-se simplesmente que pode-se obter um algoritmo que calcule o vetor com as p predi\u00e7\u00e3es, Yp quando se fornece os valores das entradas e sa\u00eddas passadas e o vetor com os m incrementos de entrada futura Au para o caso de um sistema com uma entrada e uma sa\u00edda, por exemplo. A cada itera\u00e7ao executa-se o seguinte procedimento:\n\u2014 Obtem-se o vetor p x 1 Yp executando o modelo com as entradas e sa\u00eddas passadas e com Au = [ 0 0\t...\t0 ]T.\nF = YP.\n\u2014 Calcula-se a primeira coluna da matriz Gpnmpc. Obtem-se o vetor p x 1 Yp executando o modelo com as entradas e sa\u00eddas passadas e com Au = [ e 0\t...\t0 ], onde e e um\nvalor muito pequeno, ^000 , por exemplo.\n1 _vo\nGpnmpc(:> 1) =\tp.\n\u2014 Calcula-se a segunda coluna da matriz Gpnmpc. Obtem-se o vetor p x 1 Yp executando o modelo com as entradas e sa\u00eddas passadas e com Au = [ 0 e ...\t0 ]. Gpnmpc(:, 2) =\nv 2 _v 0\nvp vp\ne '\n\u2014 Prossegue-se com o calculo das demais colunas da matriz\nGpnmpc ate a ultima coluna onde obtem-se o vetor YpJ1 executando o modelo com as entradas e sa\u00eddas passadas e __________________________________________________v0 com Au =[0 0\t... e ]. Gpnmpc(:, m) = p e p .\n4.3.2\tObten\u00e7\u00e3o da a\u00e7\u00e3o de controle\nO vetor com as p predi\u00e7\u00e3es, Yp \u00ed representado na forma\nYp = F + GpnmpcAu.\t(4.43)\nCada elemento do vetor resposta livre F \u00e9 calculado utilizando-se o modelo de predi\u00e7ca\u00e3o e assumindo Au =\t0 0\t. . .\t0 T e\nrecebe o acr\u00e9scimo do valor de n(k) conforme mostra a figura 4.5. A obtenc\u00e7\u00e3ao da a\u00e7c\u00e3ao de controle \u00ede realizada utilizando as t\u00edecnicas j\u00ed conhecidas e descritas no ap\u00eandice A.\n4.3.3\tExemplo 1\nAlguns dos resultados apresentados nesta se\u00e7ca\u00e3o foram tamb\u00edem apresentados em [73] e [49]. O modelo nao linear com uma entrada e uma sa\u00edda mostrado na equa\u00e7c\u00e3ao 4.44 \u00ede apresentado em\n[74]\tonde \u00ede controlado com uma t\u00edecnica de controle MPC iterativa denominada NEPSAC. A figura 4.1 mostra o resultado da aplicacao de controle utilizando a t\u00e9cnica PNMPC. Foi aplicado um horizonte de predi\u00e7ca\u00e3o igual a 3 e um horizonte de controle igual a 2. Com estes mesmos para\u00eametros foi realizado o controle utilizando a t\u00edecnica iterativa NEPSAC que adota a montagem da matriz G utilizando resposta ao degrau. Nota-se que para este modelo e para as refer\u00eaencias utilizadas ambas as t\u00edecnicas funcionaram bem com resultados muito semelhantes.\nPara mostrar a diferenc\u00e7a entre os dois m\u00edetodos, al\u00edem da necessidade de itera\u00e7co\u00e3es no m\u00edetodo NEPSAC, muda-se a refer\u00eaencia para um sinal senoidal com amplitude e frequ\u00eaencia variantes no tempo.\ny(k) = (l+y^-l^ + ^feU)2)\t(4.44)\n+0.3cos(.5(y(k \u2014 1) + y(k \u2014 2))) + 1.2u(k \u2014 1)\nControle com PNMPC\nAmostra\nFigura 4.1: Resultados de seguimento de refer\u00eancia com PNMPC\nControle com NEPSAC\nAmostra\nFigura 4.2: Resultados de seguimento de refer\u00eancia com NEPSAC\npara a maioria dos sistemas nao lineares. Como demonstrado na se\u00e7\u00f5o 4.3, os elementos da matriz dinamica G somente sao iguais a resposta ao degrau para sistemas lineares. Mesmo que o algoritmo NEPSAC utilize um processo iterativo para a determi-\nnac\u00e3o de Au, este procedimento baseia-se em uma representacao baseada na resposta ao degrau que n\u00e3ao se justifica como uma representa\u00e7c\u00e3ao de um sistema na\u00e3o linear.\nFigura 4.3: Resultados de seguimento de refer\u00eancia com PNMPC\nAmostra\nControle com NEPSAC\nFigura 4.4: Resultados de seguimento de referencia com NEPSAC\n4.4\tErro de predi\u00e7\u00e3o, ru\u00eddo e perturba\u00e7\u00f5es\nJ>\nOs algoritmos de controle preditivo como DMC e GPC utilizam um mecanismo para corrigir as predic\u00e7\u00f5oes. A t\u00e1ecnica de Controle DMC corrige as predi\u00e7c\u00f5oes com o erro entre o valor medido da vari\u00e1avel controlada e seu valor predito com o modelo no instante\nk.\tEsta t\u00e1cnica aplicada a sistemas lineares garante erro nulo em regime j\u00e1 que o incremento do esfor\u00e7o de controle necess\u00e1rio para a corre\u00e7ca\u00f5o do erro no instante k ser\u00e1a o mesmo nos instantes futuros devido a relacao linear entre entrada e sa\u00edda, isto \u00e1, o ganho \u00e1e constante. A aplicac\u00e7a\u00f5o deste mesmo procedimento para a t\u00e1cnica PNMPC aplicada a sistemas nao lineares n\u00f5o garante erro nulo em regime j\u00e1a que o ganho varia com o ponto de opera\u00e7c\u00f5ao do sistema. O mecanismo de corre\u00e7c\u00f5ao das predi\u00e7co\u00f5es adotado neste trabalho \u00e1 uma vers\u00f5o explicita daquele utilizado pelo algoritmo GPC. Soma-se a cada predi\u00e7\u00f5o a integral do erro de predi\u00e7\u00f5o filtrado.\nA figura 4.5 mostra o diagrama de blocos da t\u00e1cnica proposta para a corre\u00e7c\u00f5ao das predi\u00e7c\u00f5oes utilizando-se o algoritmo PNMPC. A cada instante de amostragem calcula-se o erro entre a sa\u00e1da que o preditor calcula que a vari\u00e1vel teria no instante k, y(k/k \u2014 1) e a sa\u00e1da real da vari\u00e1vel no instante k. O valor de y(k/k \u2014 1) \u00e9 o primeiro elemento do vetor de predi\u00e7c\u00f5oes obtido no instante k \u2014 1. Na discussao a seguir sera utilizado o operador atraso/avanco qj onde i e Z tal que q-1f (k) = f (k \u20141) e qf (k) = f (k+1) conforme\n[75]. Define-se\nysc = valor predito da sa\u00e1da sem corre\u00e7ao,\ny = valor real da sa\u00e1da,\nn = valor da corre\u00e7\u00f5o a ser somada a sa\u00e1da sem corre\u00e7\u00f5o, e = y \u2014 y erro entre a sa\u00e1da real y e a sa\u00e1da predita y, e = y \u2014 ysc erro entre a sa\u00e1da real e a sa\u00e1da sem corre\u00e7\u00f5o.\nFigura 4.5: Diagrama de Blocos para o tratamento de erro de modelagem e ru\u00eddo\npara isso utilizou-se o erro no instante de amostragem anterior e(k \u2014 1) para obter a corre\u00e7\u00e3o n(k).\nO erro entre a sa\u00edda do processo no instante atual e a sa\u00edda do modelo \u00e9 filtrado por um filtro passa-baixa F = D , integrado e somado \u00e0 sa\u00edda predita pelo modelo no instante seguinte. A t\u00e9cnica PNMPC sup\u00e3e que a integral do erro filtrado \u00e9 mantida constante durante as predi\u00e7\u00e3es calculadas no instante k. Assumindo que A = 1 \u2014 q-1 tem-se\ny(k) \u2014 y(k/k \u2014 1) =e(k)\t(4.45)\nk\ny(q) \u2014 (q-1 e(q)A F + y\u00abc(q)) =e(q)\nk\ny(q) \u2014 ySc(q) =e(q)(1 + q-11\u2014\u2014 F)\n1 \u2014 q 1\nF (\u201d = D^\ne(q)=(df cdA^/^\u2014y-c(q))\nSupondo que o sistema em malha fechada seja est\u00e9vel entao na vizinhan\u00e7a de um ponto de opera\u00e7\u00e3o pode-se substituir o operador q por z e aplicar o Teorema do valor final.\ne(z)\ny(z) - ysc(z)\n(D k) (y(z) - ysc(z)) suPondo (Df (z)A + z 1 ki)\nS\n1 - z-1\nDf (z)A\n-n\tDf (z)A\tS\n= Z\u21221( z )(Df(z)A + z-1ki)1 - z-1\nDF(z)(1 - z-1) S o\n= lim\tS = 0\nz\u2014>1 (Df (z)A + z 1ki)\n(4.46)\nPode-se perceber que a presenca de (1 - z-1) no numerador da equa\u00e7\u00e3o (4.46) garante erro nulo em regime permanente para uma entrada degrau de valor finito de y(1) - ysc(1) igual a 1_Z_1. Al\u00e9m de garantir erro nulo em regime, o tratamento do erro de modelagem deve garantir que a din\u00e2mica do erro apresente um tempo de resposta desejado. Esta caracter\u00edstica depende dos polos de h(z) =\t(fc) ou das ra\u00edzes do denominador de h(z).\nDefinindo-se e(k) = y(k) - ysc(k) e considerando-se pequenas diferen\u00e7as entre o modelo e o processo real pode-se fun\u00e7\u00e3o de transfer\u00e2ncia entre o erro de modelagem e pois da corre\u00e7c\u00e3ao como\nescrever a o erro de-\nh(z)\nh(z)\ne(z)\n4z)\nDf(z)(1 - z-1)\nDf(z)(1 - z-1) + z-1ki\n(4.47)\nO tratamento do erro de modelagem depende assim da escolha do denominador do filtro F e do ganho integral k^. Um filtro candidato \u00e9\nF (z) = f,\t(4.48)\nque fornece a seguinte fun\u00e7\u00e3o de transfer\u00eancia h(z),\nh( ) =\tz2 - (1 + fd)z + fd\nz z2 - (1 + fd - ki)z + fd\n(4.49)\nUm projeto simples para k e fd consiste em comparar o polinomio denominador de h(z) com um polin\u00e2mio desejado pd(z). Supondo\num polin\u00f3mio desejado de segunda ordem criticamente amortecido,\npd(z)\t=\t(z - \u00ab)2,\npd(z) = z2 - 2az + a2.\t(4.50)\nComparando o polin\u00f3mio denominador de h(z) da equa\u00e7ao 4.49 com o polin\u00f3mio desejado da equa\u00e7\u00e3o 4.50, obtem-se as igualdades,\n1 + fd\tki \u2014\t2a\nfd\t=\ta2\n(4.51)\nO projeto do filtro do preditor consiste em escolher o valor de a e enta\u00e3o determinar fd e ki.\nfd\t=\ta2\nki\t=\t1 + a2 \u2014 2a\n(4.52)\nA escolha de a tem um impacto na velocidade com que o erro responde \u00e0 uma perturbac\u00e3o. Quanto menor a mais rapidamente o erro tende a zero para uma perturbac\u00e3o do tipo degrau. Entretanto ha de se considerar o n\u00edvel de ru\u00eddo na escolha de a como sera discutido na sequencia. O fator de corre\u00e7\u00e3o n(k), calculado no instante de amostragem k para ser utilizado na predi\u00e7c\u00e3ao k + 1 ate k + p e obtido como\nn(z X) =\n1 1\n1 - fdz-1 1 - z-1\ne(z x), ou\nn(k) = n(k - 1)(1 + fd) - fdn(k - 2) + e(k)ki\n(4.53)\nO tratamento do erro de predic\u00e3o utiliza um filtro e um integrador. O ganho do filtro \u00e9 unitario somente para a \u2014 0, quando fd \u2014 0 e ki \u2014 1.\n4.4.1\tExemplo 2\nA fim de avaliar o desempenho da estrategia proposta para o tratamento de ru\u00eddos e erros de modelagem aplica-se a tecnica proposta para o exemplo 1 apresentado na subsec\u00e3o 4.3.3. Inicialmente avalia-se a resposta do controle PNMPC a entrada de um\nsinal degrau na sa\u00edda do processo para um sistema sem ru\u00eddo na medicao. A figura 4.6 apresenta a resposta obtida com a aplica\u00e7\u00e3o\nFigura 4.6: Resposta \u00e0 perturba\u00e7ao na sa\u00edda\ndo algoritmo PNMPC utilizando-se os seguintes par\u00eametros:\n\u2014\thorizonte de predi\u00e7ao igual a 3\n\u2014\thorizonte de controle igual a 3\n\u2014\tponderac\u00e3o no esfor\u00e7o de controle, A = 0.01\n\u2014\tfator a = 0\nDe acordo com a equac\u00e3o 4.52 a escolha de a = 0 equivale a\nfd = a2 =0, e\nki =\t1 + a2 \u2014 2a = 1.\t(4.54)\nOu seja, a utiliza\u00e7\u00e3o de a = 0 significa integrar o erro, ki = 1, sem a aplicacao de nenhum filtro, fd = 0. Observa-se que o efeito da perturba\u00e7ca\u00e3o na sa\u00edda aparece em um instante de amostragem e \u00ede eliminado no instante seguinte. Este seria um ajuste ideal na aus\u00eaencia de ru\u00eddo. A figura 4.7 apresenta a resposta do sistema sendo controlado com o algoritmo PNMPC utilizando os mesmos ajustes mas com a adic\u00e7a\u00e3o de ru\u00eddo branco na sa\u00edda al\u00edem da per-turba\u00e7c\u00e3ao degrau. A figura 4.7-a mostra a perturba\u00e7c\u00e3ao degrau e o\nFigura 4.7: Resposta ' perturba\u00e7\u00e3o na sa\u00edda com ru\u00eddo e a = 0\nru\u00eddo que foi somado a sa\u00edda do sistema. Nota-se que o sinal de sa\u00edda apresenta um n\u00edvel de ru\u00eddo um pouco maior do que o ru\u00eddo acrescentado, muito provavelmente pela tamb\u00e9m not\u00e1vel varia\u00e7\u00e3o no sinal de controle u como mostra a figura 4.7-b. Este ru\u00eddo na a\u00e7\u00e3o de controle \u00ed indesej\u00edvel pois prejudica o elemento final de controle como uma v\u00edlvula de controle, por exemplo. Neste caso pode-se escolher um valor de a maior do que zero e obter assim uma filtragem sobre o ru\u00eddo. O aspecto negativo disso \u00ed que a perturba\u00e7c\u00e3ao na\u00e3o sera\u00ed eliminada t\u00e3ao rapidamente como quando a = 0. A figura 4.8 mostra a resposta obtida com a = 0.7. Notase claramente que o sinal de controle apresenta-se bastante menos ruidoso e que o ru\u00eddo na sa\u00edda \u00ed semelhante ao ru\u00eddo acrescentado (n\u00e3o houve multiplicacao significativa de ru\u00eddo). De forma geral a conclus\u00e3o \u00ed que com a escolha de um s\u00ed par\u00e2metro, a, pode-se obter uma resposta mais ou menos r\u00edpida as perturba\u00e7\u00f5es. Para vari\u00edaveis do processo com presen\u00e7ca de ru\u00eddo existe um compromisso entre a rapidez na resposta ' perturba\u00e7\u00e3o e a contamina\u00e7\u00e3o de ru\u00eddo na a\u00e7\u00e3o de controle.\n(a)\n(b)\nFigura 4.8: Resposta \u00e0 perturba\u00e7ao na sa\u00edda com ru\u00eddo e a = 0.7\n4.5\tAplica\u00e7\u00e3o em processos multivar-i\u00e3veis\nApesar da apresenta\u00e7c\u00e3ao da tecnica PNMPC ter sido realizada para sistemas de uma entrada e uma sa\u00edda, n\u00e3o ha nenhuma res-tri\u00e7c\u00e3ao na aplica\u00e7ca\u00e3o da tecnica para sistemas com multiplas entradas e multiplas sa\u00eddas (Sistemas MIMO). Em realidade n\u00e3o h a praticamente nenhuma diferen\u00e7ca ja que havendo mais de uma entrada e mais de uma sa\u00edda basta montar os vetores de predi\u00e7\u00e3o e incrementos de a\u00e7ca\u00e3o de controle aumentados. Assim, para um sistema de ne entradas e ns sa\u00eddas ter\u00edamos os seguintes vetores,\nYp\t=\t[\tYp!\tYp2\t...\tYpns\t]T\nAu\t=\t[\tAu!\tAu2\t...\tAune\t]T\t(4.55)\nA obten\u00e7ao de F e Gpnmpc acontece da mesma forma como descrito para o caso de uma entrada e uma sa\u00edda. A diferen\u00e7a e que agora a matriz Gpnmpc tem mne colunas que serao obtidas calculando-se a derivada parcial de forma numerica calculando-se o vetor de predi\u00e7ao Yp com Au = 0 e o vetor de predicao obtido ao utilizar-se Au = 0 acrescido de e em cada um dos elementos de Au. Assim, para um sistema com 3 entradas e com horizonte de controle igual a 2 teriamos Gpnmpc com 6 colunas. A coluna 5, por exemplo, seria obtida como\nY^___y0\nGPNMPC(\u00cd 5)\t=\t(4.56)\ne\nYp\t=\tYp(Au = [ 0\t0\t0\t0\t0\t0\t]T)\nYp\t=\tYp(Au = [ 0\t0\t0\t0\te\t0\t]T)\n4.5.1\tExemplo 3 - PNMPC aplicado no controle de uma Planta com 6 Tanques Esfericos\nA figura 4.9 mostra um sistema desenvolvido na UFRGS e citado em [76]. A partir de um reservat\u00f3rio bombeia-se agua com uma unica bomba para seis tanques atraves de dois ramos diferentes com vaz\u00e3oes controladas por abertura de valvulas. O modelo\ndin\u00eaamico do sistema e descrito pelas seguintes equac\u00e7o\u00e3es:\n. dhi \u25a0\t= xiFi - R^/~h[\t(4.57)\ndh2 A 2 \u2014;\u2014 dt\t= R^/hi - R^y/hz\t\n, dh3 dt\t= (1 - x2)F2 + R2 V\tZh2 - R3\\/h3\n. dh4\t= x2F2 - R^/h4\t\n, dh5 A*~ddt\t= R^y/hi \u2014 R^y/hs\t\ndh6 \u25a0\t=\t(1 - xi)Fi + R5V\th5\tR6y/ h6\nonde\n-\tAi, (i = 1 : 6), e a area da secao de cada tanque em fun\u00e7ao do n\u00edvel de fluido no mesmo (hi) e do diametro para o n\u00edvel (Di).\n-\tRi, (i = 1 : 6), e a resist\u00eancia a passagem do fluido pelo orif\u00edcio no fundo de cada esfera.\n-\thi, (i = 1:6), e o n \u00edvel do fluido em cada um dos seis tanques esfericos.\n-\txi \u00e9 fracao da vazao de fluido Fi que flui para o tanque 1.\n-\thi, (i = 1:6), e o n\u00edvel do fluido em cada um dos seis tanques esfericos.\n-\tx2 e fracao da vazao de fluido F2 que flui para o tanque 4.\nNas equacoes 4.57\nAj = n(Djhi - h2)\t(4.58)\nRi\tai\\/2g\nAs equac\u00e7\u00e3oes 4.57 s\u00e3ao discretizadas utilizando-se a aproxima\u00e7c\u00e3ao de Euler com um Tempo de amostragem de 3 segundos. O processo multivariavel \u00e9 representado pelas sa\u00eddas h3 e h6 e as entradas F1\ne F2.\nPlanta com seis tanques esf\u00e9ricos\nFigura 4.9: Planta com 6 Tanques Esf\u00e9ricos\n\nH3\t\t\u25a0 F3 \u25a0\t+\tG11\tG12 \u25a0\t\t\u25a0 AF1 \u25a0\nh6\t\t. Fe .\t\t, G21\tg22\t\taf2\nO objetivo de controle \u00e9 levar os n\u00edveis h3 e h6 para valores desejados. As sa\u00eddas h3 e h6 apresentam dinamicas r\u00e9pidas ou lentas dependendo dos pontos de opera\u00e7\u00e3o. Isto demanda um horizonte de predic\u00e3o muito longo devido a necessidade de se utilizar um tempo de amostragem pequeno. Para evitar trabalhar-se com matrizes de dimenso\u00e3es muito elevadas adota-se a t\u00edecnica de se utilizar uma predi\u00e7ao a cada N instantes de amostragem futuro. Este procedimento \u00e9 uma generaliza\u00e7\u00e3o da proposta apresentada em [77] que sugere a utiliza\u00e7\u00e3o de pontos de coincid\u00eancia da trajet\u00f3ria de refer\u00eancia no lugar da utiliza\u00e7\u00e3o de todos os pontos. Este esquema \u00e9 de f\u00f3cil implementac\u00e3o com a t\u00e9cnica PNMPC proposta. Utilizou-se um horizonte de controle de 3 para cada entrada e um numero de predic\u00e3o de 210 para cada sa\u00edda. Este\nhorizonte de predic\u00e3o foi reduzido para 31, (210/7 +1), tomandose a primeira predi\u00e7\u00e3o e depois uma a cada 7. Desta forma o vetor F tem dimens\u00e3o 62 x 1 e a matriz Gpnmpc tem dimens\u00e3o 62 x 6. O horizonte de predi\u00e7c\u00e3ao ainda leva em conta a necessidade de se cobrir a din\u00e2mica das sa\u00eddas por um tempo suficiente maior que o tempo em que as sa\u00eddas apresentam resposta inversa devido o comportamento de fase n\u00e3ao-m\u00ednima. O processo Seis Tanques Esfericos apresenta um comportamento entrada-sa\u00edda n\u00e3o linear, comportamento de fase n\u00e3o-m\u00ednima e um pequeno atraso de transporte. As sa\u00eddas s\u00e3o representadas em [cm] e as entradas em [cm3/min]. Isto faz com que os valores dos sinais de entrada sejam muito maiores que os das sa\u00eddas. As matrizes de pondera\u00e7\u00e3o R e Q s\u00e3o inicialmente normalizadas levando em considera\u00e7c\u00e3ao os valores m\u00edaximos de ambas as grandezas. Al\u00edem disso faz-se um estimativa dos tempos de atraso e da durac\u00e7\u00e3ao do efeito de fase na\u00e3o-m\u00ednima predominante para diminuir os valores correspondentes na matriz de pondera\u00e7c\u00e3ao R. Este procedimento tem o efeito de priorizar a din\u00e2amica de fase m\u00ednima das sa\u00eddas e acredita-se que melhora a estabilidade num\u00ederica do algoritmo. O algoritmo PNMPC opera com os estados do sistema. Assim se fez necess\u00edario utilizar as medic\u00e7o\u00e3es de todos os 6 estados do sistema apesar do controle ser realizado apenas sobre as sa\u00eddas correspondentes aos estados h3 e h6. As medic\u00e3es de todos os estados s\u00e3o relevantes para a aplica\u00e7c\u00e3ao do algoritmo de tratamento de erro de predic\u00e3o j\u00e1 que os estados h3 e h6 dependem dos demais estados.\nA figura 4.10 mostra o resultado de alguns testes de simula\u00e7c\u00e3ao do sistema em malha aberta. As figuras 4.11, 4.13 e 4.12 mostram os resultados obtidos com a aplica\u00e7\u00e3o da t\u00edcnica PNMPC para uma s\u00ederie de mudan\u00e7cas de refer\u00e2encia propostas em [76]. Deve-se mencionar que na simulac\u00e7\u00e3ao supo\u00e3e-se que as refer\u00e2encias futuras n\u00e3ao s\u00e3ao conhecidas mas s\u00e3ao consideradas como iguais a refer\u00e2encia atual.\nNa figura 4.11 t\u00e2m-se o comportamento das sa\u00eddas h3 e h6 em compara\u00e7c\u00e3ao com as refer\u00e2encias estabelecidas. A figura 4.13 mostra o comportamento dos n\u00edveis hj, h2, h4 e h5. Diferentemente das refer\u00e2encias propostas em [76] para o controle do mesmo processo, preferiu-se utilizar refer\u00e2encias que exijam mais desempenho do sistema de controle.\nNo tempo igual a 25 minutos requer-se que o n\u00edvel 3 suba enquanto o n\u00edvel 6 diminua, por exemplo. No tempo igual a 60\n0\t2\t4\t6\t8\t10 12 14 16 18 20\nTempo [ min ]\n0\t2\t4\t6\t8\t10 12 14 16 18 20\nTempo [ min ]\nFigura 4.10: Respostas em Malha Aberta\nminutos muda-se a refer\u00eaencia do n\u00edvel 6 e pode-se perceber a per-turba\u00e7ca\u00e3o causada no n\u00edvel 3.\n(a)\n(b)\nFigura 4.11: Respostas de h3 e h6 em Malha Fechada\n(b)\nFigura 4.12: A\u00e7\u00e3o de Controle em Malha Fechada\nObserva-se que a t\u00e9cnica PNMPC proposta permite um \u00f3timo seguimento de refer\u00eancia com exce\u00e7\u00e3o do comportamento de fase n\u00e3o m\u00ednima que mant\u00e9m-se em malha fechada como esperado.\nPara avaliar a capacidade do algoritmo PNMPC em representar as predic\u00e3es utilizando-se a expressao Y = F + Gpnmpc^u compara-se as predi\u00e7co\u00e3es obtidas com esta express\u00e3ao com as predi-\u00e7oes obtidas diretamente do modelo n\u00e3o linear. A comparac\u00e3o foi realizada no instante de amostragem 801 que corresponde ao tempo t = 40.05 min.\nFigura 4.13: Respostas de hl, h2, h4 e h5 em Malha Fechada\n4.6\tPNMPC com Gradiente Ponderado\nA tecnica PNMPC proposta utiliza a matriz G igual ao gradiente ddYu calculada para Au = 0. O gradiente \u00e9 obtido a cada instante de amostragem atraves de um procedimento numerico como descrito na se\u00e7\u00e3o 4.3. Dependendo do grau da n\u00e3o linearidade do sistema pode ser interessante obter uma nova matriz G somente a cada N instantes de amostragem ou, ao contrario, pode ser desejavel melhorar o modelo de predic\u00e3o. Sistemas altamente n\u00e3o lineares e com comportamento de resposta inversa exigem bons modelos de predi\u00e7c\u00e3ao principalmente quando se deseja um desempenho rapido do sistema sendo controlado.\nNesta se\u00e7c\u00e3ao apresenta-se um procedimento que visa melhorar o modelo de predi\u00e7ca\u00e3o. Como ja mencionado a matriz gradiente G e calculada a cada instante de amostragem para Au = 0. Entretanto, devido a n\u00e3ao linearidade do modelo e processo, o gradiente varia em fun\u00e7ao do incremento de controle aplicado. Um procedimento que visa melhorar o calculo do gradiente consiste em calcula-lo em dois passos:\nPasso 1: Calcula-se o gradiente Gi como ja descrito na sec\u00e3o 4.3 utilizando-se Au = 0 .\nPasso 2: Utilizando o gradiente Gi calcula-se o incremento da a\u00e7ca\u00e3o de controle intermediario Au\u00a1 e com ele o gradiente G2. O gradiente que sera utilizado para o calculo da acao de controle definitiva \u00e9 G = 0.5G1 + 0.5G2\nUma interpretac\u00e3o grafica do procedimento \u00e9 mostrada na figura 4.15 para o caso de uma fun\u00e7\u00e3o y = f (x). Pode-se observar na figura 4.15 que o primeiro valor de Ax = Ax\u00ae \u00e9 diferente do valor que seria necessario para que a fun\u00e7c\u00e3ao atingisse o valor desejado yd = y(x + Ax). Utilizando-se o valor de Ax\u00ae obtido com o primeiro gradiente calculado em x, calcula-se o gradiente intermediario dyU+Aa: . Em seguida calcula-se o gradiente ponderado que e a media entre o gradiente em y(x) e em y(x+Ax\u00ae). A utiliza-c\u00e3o do gradiente ponderado ira fornecer um valor de Ax = Axp que e muito mais proximo do valor correto para que a fun\u00e7ca\u00e3o atinja yd = y(x + Ax). Este procedimento \u00e9 uma tentativa de atingir uma aproximac\u00e3o de Taylor de segunda ordem, onde\ny(x + Ax) a f (x) + \u00edl\u00edx^Ax + 1 fpA\u00bb\u2019\t(4.60)\nFigura 4.15: Interpreta\u00e7\u00e3o gr\u00e1fica do gradiente ponderado\nObtendo-se\nAx1 =\tX ), pode-se calcular\t(4.61)\ndx\ndf (x + Ax\u00ae)\t.\t\u201e\ne fazer a seguinte aproxima\u00e7ao\ndf(x+Ax^) _ df(x)\ndx_________dx\nAxi\ndx\nd2f(x)\ndx2\nAssim, a Eq. (4.60) pode ser reescrita como\n,\t. .\t...\tdf (x)\t1\ny(x + Ax) = f(x) + dx Ax +2\n~ df (xfAx*) _ df (x) ~ dx ___________dx\nAx\u00ae\nAx2.\n(4.62) Pode-se dizer que Ax1 = Ax(1 _5), onde 5 e um valor que depende da curvatura da fun\u00e7\u00e3o, sendo positivo para fun\u00e7\u00e3o concava e\nnegativa para fun\u00e7ao convexa. Introduzindo esta rela\u00e7ao na Eq.\n(4.62), tem-se\ny(x+Ax) = f (x)+ (1\n1\t) df (x)\t1\tdf (x + Ax\u00ae)\n2(1 _ \u00e3)) dx + 2(1 _ \u00e3) dx\n(4.63)'\nAx.\nO c\u00e9lculo de \u00f4 iria necessitar da avaliac\u00e3o da derivada segunda de f (x) que deseja-se evitar. Assim o melhor compromisso \u00e9 considerar \u00f4 = 0 e\ny(x + Ax) = f (x) +\ndf (x)\n0.5 -fT-Z+ 0.5\t\u201e\nx\tox\ndf (x + Ax\u00ae)\t.\nv\t7 Ax.\n(4.64)\nO resultado do caso escalar pode ser estendido para a Matriz Gradiente Ponderada.\nO procedimento descrito acima requer duas avalia\u00e7\u00f5es da Matriz Gradiente. A fim de se diminuir a carga computacional do algoritmo prop\u00f5e-se uma vers\u00f5o de Matriz Gradiente Ponderada simplificada onde o c\u00e1lculo do incremento da a\u00e7\u00f5o de controle intermediario Au\u00a1 \u00e1 realizado utilizando-se a matriz G obtida no instante de amostragem anterior.\nA figura 4.16 mostra a comparac\u00e7\u00f5ao entre a predi\u00e7c\u00f5ao calculada com o modelo n\u00f5ao linear e com o modelo linearizado utilizando a Matriz Gradiente Ponderada para o instante de tempo igual a t = 40.05 min. Comparando a resposta obtida com a versao linearizada que utiliza a Matriz Gradiente calculada para Au = 0 apresentada na figura 4.14, percebe-se uma melhora muito significativa. A figura 4.17 mostra o resultado obtido utilizando-se a Matriz Gradiente Ponderada Simplificada. O resultado \u00e1 muito similar ao obtido com a Matriz Gradiente que utiliza dois ca\u00e1lculos de Gradiente a cada instante de amostragem.\nFigura 4.16: Compara\u00e7\u00e3o entre predi\u00e7\u00e3o com modelo n\u00e3o linear e modelo linearizado com Gradiente Ponderado\nFigura 4.17: Compara\u00e7ao entre predi\u00e7ao com modelo nao linear e modelo linearizado com Gradiente Ponderado Simplificado\n4.6.1\tExemplo 4 - PNMPC aplicado no controle da rea\u00e7\u00e3o Van Der Vussen\nO Controle da Rea\u00e7\u00e3o Van Der Vussen \u00e9 um problema benchmark para o desenvolvimento de algoritmos de controle de processos nao lineares como pode ser visto em [78], [79], [80], [81], [82]. A rea\u00e7ao Van Der Vussen e um processo cont\u00ednuo que acontece em um reator do tipo tanque agitado isotermico. A rea\u00e7ao consiste do seguinte esquema\nA \u2014>kl B \u2014>k2 C\t(4.65)\n2A \u2014>k3 D\nA e o produto que entra no reator, B \u00e9 o produto desejado e C e D sao subprodutos indesejados. Utiliza-se neste exemplo o modelo do processo apresentado em [82]:\nCa\tkaca k3Ca V (cAin ca)u\ncb\tkica k2Cb\tcbu.\ny = cb\t(4.66)\nNeste modelo\n\u2014\tca \u00e9 a concentra\u00e7ao do produto A.\n\u2014\ty = cb \u00e9 a concentracao do componente B e a variavel controlada.\n\u2014\tu = Fr1 \u00e9 o inverso do tempo de residencia e a variavel manipulada sendo Fent a vazao de entrada e VR o volume do tanque.\n\u2014\tki = k2 = 15.0345 sao constantes de reacao dadas pela equac\u00e7ao de Arrhenius.\n\u2014\tk3 = 2.324 \u00e9 outra constante de rea\u00e7ao.\n\u2014\tCAin = 5.1 \u00e9 a concentracao de entrada de A.\n\t\tJ.P1\t\t\t\n\t\tr\t\t\t\n\t\t\t\t\t\n\t\ti\t\t\t\n\t\t1\t\t\t\n\t\t!\t\t\t\n\t\t\t\t\t\n\t\t!\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n0\t5\t10\t15\t20\t25\t30\t35\nu [ s-1]\nFigura 4.18: Rela\u00e7\u00e3o entre cB e u em Regime Permanente (Curva de equil\u00edbrios do sistema)\nOs estados estacionarios ou equil\u00edbrios do sistema sao obtidos fazendo-se ca = cb = 0. A figura 4.18 mostra a curva de equil\u00edbrios do sistema. Nota-se que existe um ponto Pi onde ocorre o valor maximo de sa\u00edda. Al\u00e9m disso este processo apresenta um comportamento de fase nao-m\u00ednima para opera\u00e7\u00f5es a esquerda do ponto Pi. A figura 4.19 mostra o comportamento da concentra\u00e7ao do produto B (cB) em malha aberta quando submetido a degraus na entrada. A figura 4.19-a mostra a resposta para um degrau positivo enquanto que a figura 4.19-b mostra o comportamento da sa\u00edda para um degrau negativo. As entradas correspondem a valores na regiao do lado esquerdo de Pi da figura 4.18. Nota-se claramente o comportamento do tipo resposta inversa ou fase na\u00f5o m\u00ednima em ambos os casos.\nO modelo cont\u00ednuo representado pela equac\u00f5o (4.66) foi discretizado com um tempo de amostragem de 18 segundos (0.005 horas) utilizando-se uma aproximacao de Euler (c =\t).\nu [ s-1 ]\tConcentra\u00e7ao B\nTempo [ min ]\nTempo [ min ]\nFigura 4.19: Respostas em malha aberta\nCa(k) _ ca(k \u2014 1) \u2014 Tski ca(k \u2014 1) \u2014 Tsk3ca(k \u2014 l)2\n+Ts(cae \u2014 Ca(k \u2014 1))u(k \u2014 1)\ncb(k) _ cb(k \u2014 1) + Tskica(k \u2014 1) \u2014 Tsk2cb(k \u2014 1) \u2014Tscb(k \u2014 1)u(k \u2014 1)\n\u00fc(k) _ cb(k)\t(4.67)\nA variavel que se deseja controlar \u00e9 cb. Entretanto, apesar de nao se controlar a variavel ca, supoe-se que dispoe-se de sua medicao. Para a aplica\u00e7ao da tecnica PNMPC se faz necessario manter o modelo nao linear de ca corrigido em func\u00e3o das medi\u00e7\u00f5es. Para isso, a cada iterac\u00e7a\u00e3o, o algoritmo determina o erro entre o valor das variaveis ca e cb medidas e os valores obtidos utilizando-se a representa\u00e7c\u00e3ao linearizada com a tecnica do gradiente ponderado. Com este procedimento garante-se erro nulo em regime permanente na presen\u00e7ca de erros de modelagem e perturba\u00e7c\u00e3oes utilizando a tecnica discutida na sec\u00e7a\u00e3o 4.4. Para os resultados de simulac\u00e3o que serao apresentados na sequ\u00eancia foram utilizados os seguintes par\u00e2metros de sintonia do controlador PNMPC:\n\u2014\tHorizonte de predicio igual a 30\n\u2014\tHorizonte de controle igual a 3\n\u2014\tPondera\u00e7ao no esfor\u00e7o de controle com A = 0.0025\n\u2014\tPar\u00e2metro controle do erro de modelagem a = 0\nN\u00e3o se aplicou nenhum filtro nas mudancas de referencia. Para instantes de tempo maiores que 90 minutos aplicou-se uma mudan\u00e7a nos par\u00e2metros da planta simulada.\nk1 = k2 = 1.1k1-nom.\nk3 = 0.9k3-nom.\t(4.68)\nUtilizou-se o algoritmo de programac\u00e7\u00e3ao quadr atica para obten\u00e7ca\u00e3o das a\u00e7co\u00e3es de controle. As restri\u00e7co\u00e3es utilizadas foram relativamente brandas nesta simula\u00e7c\u00e3ao:\numax.\numin.\numax.\nAu\nmin.\n35\n0\n20\n0\n(4.69)\nAs figuras 4.20 e 4.21 mostram o resultado da aplicac\u00e3o da tecnica PNMPC no controle de cB aplicando-se mudan\u00e7as de refer\u00eancia para valores na faixa ' esquerda de P1 da figura 4.18.\nA figura 4.20-a mostra que o algoritmo PNMPC consegue efetuar um bom seguimento de refer\u00eancia. Alem disso reage bem ' varia\u00e7\u00e3o no modelo da planta em rela\u00e7\u00e3o ao modelo utilizado para predi\u00e7\u00e3o ao levar a sa\u00edda para a refer\u00eancia desejada em um tempo pequeno e com um desvio maximo razoavel. A figura 4.20b mostra a a\u00e7ca\u00e3o de controle e o incremento da ac\u00e7\u00e3ao de controle e a forma como reagem ' varia\u00e7\u00e3o dos par\u00e2metros da planta para t > 90 min..\n-----erro ca\nTempo [ min.]\nFigura 4.20: Controle de cb com PNMPC\nerro c\nFigura 4.21: Controle de cb com PNMPC-Controle de erros\nFigura 4.22: Compara\u00e7\u00e3o entre Predi\u00e7\u00e3o com o modelo e com PNMPC\nO desempenho do algoritmo PNMPC depende fundamentalmente de sua capacidade de representar as predi\u00e7\u00f5es de forma linear utilizando a t\u00e9cnica do gradiente ponderado. Observando a figura 4.21-b pode-se perceber que o erro de modelagem a cada instante de amostragem \u00e9 mantido em valores baixos mesmo nos momentos de mudan\u00e7a de referencia. Entretanto uma amostra das predi\u00e7\u00f5es ao longo do horizonte de predi\u00e7\u00e3o p mostra que no momento da mudan\u00e7a de refer\u00eancia, mesmo para modelos de predic\u00e3o iguais ao da planta, acontece a maior diferen\u00e7a. Essa diferen\u00e7ca \u00e9e m\u00e9axima no momento da mudanc\u00e7a de refer\u00eaencia e diminui rapidamente nos instantes de amostragem seguintes como mostra a figura 4.22. No instante t = 39, 9 min. h\u00e9 uma mudan\u00e7a significativa na refer\u00eancia e na ac\u00e3o de controle resultando em uma diferenc\u00e7a grande na predi\u00e7c\u00e3ao feita com o modelo n\u00e3ao linear e o modelo linearizado enquanto que nos dois instantes de amostragem seguintes, t = 40, 2 min. e t = 40, 5 min. a diferen\u00e7a diminui significativamente. Sao nos instantes de mudanca de re-fer\u00eaencia ou entrada de perturba\u00e7c\u00e3oes que \u00e9e importante dispor de uma boa t\u00e9ecnica para obter as predi\u00e7c\u00e3oes.\nUma das dificuldades esperadas de um controlador baseado em um modelo linear seria a operac\u00e3o do processo no ponto Pi da rela\u00e7ao cb x u em regime permanente apresentada na figura 4.18 j\u00e1 que neste ponto o ganho do modelo linear seria zero. Em [82] prop\u00e3e-se um algoritmo MPC nao linear iterativo para o controle deste processo para uma sequ\u00eancia de refer\u00eancias visando mostrar a capacidade da t\u00e1ecnica proposta em controlar o processo ao redor do ponto Pi. A figura 4.23 mostra os resultados obtidos com\nFigura 4.23: Teste de Seguimento de Referencia em torno de Pi\na aplica\u00e7\u00e3o da t\u00e1cnica PNMPC para a sequ\u00eancia de referencias sugeridas em [82]. Utilizou-se um horizonte de predi\u00e7ao igual a 30, horizonte de controle igual a 3, pondera\u00e7\u00e3o do esfor\u00e7o de controle, A = 0,01 e o par\u00e2metro de controle de erro a = 0 . Para evitar a influ\u00eancia do comportamento tipo resposta inversa ou fase nao m\u00e1nima optou-se por fazer os primeiros 10 elementos da matriz de ponderac\u00e7\u00e3ao do seguimento de refer\u00eaencia igual a zero. Notase que a t\u00e1cnica PNMPC leva o sistema \u00e0s refer\u00eancias desejadas exceto para o valor 1,11 que n\u00e3o pertence ao conjunto de pontos realiz\u00e1veis da rela\u00e7\u00e3o em regime permanente cb x u. Nota-se entretanto que o sistema leva cb ao valor mais proximo poss\u00edvel, cb = 1, 09. Um ponto interessante a ser observado \u00e1 que ha dois valores de entrada u que levam o sistema at\u00e1 cb = 1,0 como pode ser visto na rela\u00e7ao de regime permanente cb x u.\nComo a func\u00e7\u00e3ao custo cresce com o quadrado da diferen\u00e7ca entre refer\u00eancia e resposta e a trajet\u00f3ria ate cb igual a 1,0 pelo lado direito de cb x u apresenta comportamento de fase nao m\u00ednima o sistema de controle chegou a cb = 1, 0 pelo lado direito que apresenta comportamento de fase m\u00e9nima e menor custo.\nUma forma de for\u00e7ar o sistema a permanecer no lado esquerdo da rela\u00e7ao em regime permanente cb x u \u00e9 modificar a funcao objetivo para introduzir um termo que penaliza afastamentos do valor de regime permanente da entrada conforme proposto em [83]. Para isso calcula-se o valor de regime permanente para cada valor da refer\u00eancia uss(yref(k)) e escreve-se a seguinte func\u00e3o custo:\nJ\n= (Yp - W)T R (Yp - W) + AuTQiAu\n+ (U - USS)T Q2 (U - Uss), onde\nU = uk-i [ 1\t1\t1 ]T +\n1\n1\n1\n0 0\n1 0\n11\nAu\nUss = uss(yref (k)) [ 1\t1\t1 ]T .\t(4.70)\nOs par\u00e2metros utilizados no ajuste do algoritmo foram\n\u2014\thorizonte de predkao p = 30;\n\u2014\thorizonte de controle m = 3;\nQ1 = 0-01!mxm;\nQ2 = 0-001!mxm;\n\u2014\tpar\u00e2metro para o controle de erro de modelagem a = 0\nDevido a presenca de comportamento de resposta inversa os primeiros\n10\telementos da matriz de ponderac\u00e3o de seguimento de refer\u00e2ncia R foram zerados. Os resultados da aplicacao do controle PNMPC s\u00e3o apresentados na figura 4.24. Pode-se perceber pela a\u00e7\u00e3o de controle e pelo comportamento de resposta inversa que a vari\u00e1vel cb vai de 1.09 at\u00e1 1.0 com valores de entrada pertencente ao lado esquerdo de Pi na figura 4.18.\n(a)\n(b)\nFigura 4.24: Teste de Seguimento de Refer\u00eancia em torno de Pi para Uss &lt;15\n4.7\tEstabilidade\nNa se\u00e7\u00e3o 4.4 discutiu-se uma t\u00e9cnica para manter nulo o erro de modelagem em regime permanente e garantir uma din\u00eaamica t\u00e3ao r\u00e9pida quanto poss\u00edvel para sua trajet\u00e9ria ate zero. Entretanto, sabe-se que alguns erros de modelagem podem desestabilizar o sistema sob controle. Especialmente aqueles erros de sincroniza-\u00e7c\u00e3ao temporal entre o comportamento da planta e o do modelo. Neste sentido erros no atraso de transporte podem ter um impacto grande na estabilidade do sistema. Uma das alternativas para conviver com este problema \u00e9e penalizar os incrementos de controle na func\u00e7\u00e3ao objetivo obtendo assim uma resposta lenta em malha fechada mas garantindo a estabilidade do sistema. Para sistemas lineares uma solu\u00e7c\u00e3ao que funcione para um valor de refer\u00eancia vai funcionar para todas as outras. Ja para sistemas n\u00e3o lineares a situac\u00e7\u00e3ao \u00e9e diferente. Esta sec\u00e7\u00e3ao apresenta uma t\u00e9ecnica para garantir que a a\u00e7ca\u00e3o de controle obtida a cada instante de amostragem com o algoritmo de controle PNMPC mantenha o sistema est\u00e9vel. Parte deste trabalho foi apresentado em [84].\n4.7.1\tDesenvolvendo uma condi\u00e7\u00e3o suficiente para estabilidade\nA proposta esta baseada nas ideias de Lyapunov sobre fun\u00e7\u00e3es do tipo energia decrescente no tempo. [85]. Considere a seguinte fun\u00e7c\u00e3ao de Lyapunov\nV\t=\t\u00e3T Pe, onde\ne\t=\tYp - W e\nYp = F + GAu.\t(4.71)\na cada instante de amostragem garantir-se que\ndV\no sistema ser\u00e1 est\u00e1vel. Deve-se observar que\nV(0) = 0 e\nV > 0 para e = 0.\t(4.73)\nO desafio \u00e1 desenvolver uma expressao para djt e assegurar-se que seu valor continue negativo a cada instante de amostragem com um custo computacional m\u00ednimo. Para isso desenvolve-se a express\u00e3ao para V na equa\u00e7c\u00e3ao 4.71. Observa-se que V depende de F, W e Au,\nV = f (F, W, Au),\ndV dV dF + dV d W + dV d Au ~dt = dF ~dt + dW ~dt~ + d\u00c3\u00fc dt\nDesenvolvendo a equa\u00e7ao 4.71,\ndV\ndF\ndV\ndW\ndV dAu\nAt\n(At P + AuT Gt P),\n-(At P + AuT Gt P),\n(AtPG + AuTGtPG), onde (4.75)\nFt - WT.\t(4.76)\nAs derivadas parciais , FW e ^77^ s\u00e3o obtidas utilizando uma matriz Toeplitz [83] modificada, equivalente ao operador derivada discreta A = 1 \u2014 z-1,\ndF\n~dt\ndW\n~dt dAu ~dT\nTpF,\nTpW,\nTmAu.\n(4.77)\nAo calcular as derivadas a divis\u00e3o por Ts, o tempo de amostragem, \u00e1e omitida uma vez que o resultado continua proporcional. Para\no caso de um sistema com uma entrada e uma sa\u00edda (Sistema SISO-Single Input Single Output), por exemplo, Tp e Tm sao respectivamente matrizes p x p e m x m, com p e m sendo os horizontes de predic\u00e7\u00e3ao e de controle respectivamente.\n\t\u25a0 \u20141 0\t1 \u20141\t0\t\u2022\u2022\u2022 1\t\u2022\u2022\u2022\t0 0\t\nT= T m,p \u2014\t0\t0\t\u2022 \u2022 \u2022 \u20141\t1\t(4.78)\n\t0\t0\t\u2022\u2022\u2022 0\t\u20141\t\nA utiliza\u00e7c\u00f5ao dessas matrizes limitam a aplica\u00e7ca\u00f5o da tecnica para m > 1. A matriz Toeplitz T pode ser utilizada para calcular a derivada do vector V como TV. Em sua forma original a primeira linha de T \u00e9 [ 1\t0\t0\t\u2022\u2022\u2022 0 ], o que e equivalente a assumir\nque o elemento que precede V(1) e zero. Para esta aplica\u00e7ao o oposto e valido. Isto e, a matriz Toeplitz sera aplicada ao vetor com a diferen\u00e7a entre a resposta livre e a referencia, A = F \u2014 W e ao vetor incremento de controle Au. Neste caso e mais natural assumir que Aum+i = 0 e que (F \u2014 W)p+i = 0. Ou seja, em MPC assume-se que o incremento de controle depois do horizonte de controle e zero e, na maioria das vezes, que no instante seguinte ao horizonte de predi\u00e7c\u00f5ao atingiu-se o valor de refer\u00e2encia. Isto justifica a utilizac\u00e7\u00f5ao da matriz Toeplitz modificada.\nCombinando as equa\u00e7\u00f5es 4.74, 4.77 e 4.78, chega-se a equa\u00e7\u00f5o\n= AT Tj PA +(At Tj PG + At PGTm)Au\n+AuTGtPGTmAu &lt;0\t(4.79)\n4.7.2\tIntroduzindo a condi\u00e7\u00e3o para estabilidade na formula\u00e7\u00e3o MPC com PQ\ncentar a expressao dV &lt;0 dada pela equacao 4.79 na funcao objetivo a ser minimizada. A minimiza\u00e7c ao da func\u00e7 ao custo contendo esta expressao pode tornar dg\u201d negativa mas isto nao garante que ser\u00e9a sempre negativa. Para isso se faz necess\u00e9ario acrescentar uma restricao na formulacao PQ.\nA introdu\u00e7ao da restricao dg\" &lt;0 na formula\u00e7ao QP apresenta uma dificuldade. A expressao 4.79 tem um elemento quadr\u00e9tico em Au e a maioria dos algoritmos de PQ nao admitem restric\u00e7oes nao lineares. Uma soluc\u00e7ao exata requer a utiliza\u00e7cao de algoritmos de programa\u00e7cao nao linear mas uma solu\u00e7cao aproximada pode ser obtida montando-se uma expressao para um dos vetores Au da expressao 4.79. Isto \u00e9 feito utilizando-se a cauda (tail) do vector Au calculado no instante de amostragem anterior, k \u2014 1, com seus elementos deslocados uma posic\u00e7ao para cima e acrescentando um zero no ultimo elemento como mostra a equa\u00e7ao 4.80 para um sistema SISO,\nAutail = [AuJ-^\u00fc] .\t(4.80)\nCom esta aproxima\u00e7ao a nova formulacao do problema de Pro-grama\u00e7ao Quadr\u00e1tica pode ser escrita como\nAu = arg min J\ns. t.\nMAu &lt;N, onde\nJ = ^AuT $Au + \u00a9T Au com\n$ = Gt RG + Q +\n$1 = GT PGTm\n0 = Gt RA + \u00a9T\n\u00a9T = AT T PG + At PGTm\n(4.81)\nNa equa\u00e7ao 4.81 a expressao MAu &lt;N agrupa todas as restricoes e ser\u00e1 explicada na sequ\u00eancia.\npor exemplo.\nN2 &lt;MAu &lt;Ni ou\nMAu &lt;N1\n\u2014MAu &lt;\u2014N2 com\nN1 = \u2014At Tj PA\nN2 = At Tj PA + \u00a3\nM = At Tj PG + At PGTm +\nAuT\tgT PGT\nAuaprox.G PGTm\n(4.82)\nA equac\u00e3o 4.82 \u00e9 a restri\u00e7\u00e3o que assegura que\n(4.83)\nH\u00e9 dois par\u00e2metros importantes a serem sintonizados, P e \u00a3, embora nas aplicac\u00e3es feitas ate agora uma boa escolha para P parece evitar que dt atinja o limite \u2014\u00a3. Aparentemente, para as apli-ca\u00e7\u00e3es feitas, um valor muito negativo para \u2014\u00a3 afeta o seguimento de refer\u00e2encia de forma que naturalmente um compromisso \u00e9e estabelecido e a restric\u00e7a\u00e3o n\u00e3ao foi alcanc\u00e7ada.\nO fato de haver tr\u00e2s matrizes, R, Q e P para serem sintonizadas oferece mais flexibilidade mas aumenta a complexidade da sintonia. Alguns experimentos mostraram que em caso de forte erros de modelagem obteve-se bons resultados diminuindo os primeiros elementos de R embora seja dif\u00edcil estabelecer uma regra geral.\n4.7.3\tAplica\u00e7\u00e3o da t\u00e9cnica\nA fim de verificar o desempenho obtido com a t\u00edecnica proposta e suas limita\u00e7\u00f5es, aplica-se a mesma a alguns problemas citados na literatura.\nExemplo 5\nRetomamos o processo utilizado no exemplo 2 na subse\u00e7c\u00e3ao 4.3.3.\ny(k) =\n2.5y(k _ 1)y(k _ 2) (1+ y(k _ 1)2 + y(k _ 2)2)\n+ y(k _ 2))) + 1.2u(k _ 1 _ d)\n+ 0.3cos(.5(y(k _ 1)\n(4.84)\nA planta sera simulada com o modelo mostrado na equa\u00e7\u00e3o (4.84) incluindo um atraso de transporte d enquanto que no modelo utilizado para obter as predic\u00e3es considera-se d = 0. A fim de comparar o desempenho do sistema de controle PNMPC utilizando a tecnica de introdu\u00e7ca\u00e3o de robustez proposta apresenta-se inicialmente o resultado obtido quando se aplica o procedimento convencional de aumentar a pondera\u00e7c\u00e3ao do esforc\u00e7o de controle aumentado o valor dos elementos da diagonal da matriz Q. Na sequ\u00eaencia apresenta-se o resultado com a tecnica proposta.\nOs seguintes par\u00eaametros foram utilizados nas simulac\u00e7\u00e3oes:\n\u2014\tp=10\n\u2014\tm=3\n\u2014\tPeso na ponderac\u00e7a\u00e3o do esforc\u00e7o de controle utilizando a soluc\u00e7a\u00e3o convencional: Q = 60I(m, m)\n\u2014\tPeso na ponderacao do esfor\u00e7o de controle utilizando a solucao robusta proposta:0.0\n\u2014\tPeso na pondera\u00e7ao da robustez: P = 0.03I(p,p)\n\u2014\tLimite inferior de dt: \u00a3 = _0.01\nAlem disso, aplicou-se uma perturba\u00e7\u00e3o na sa\u00edda igual a 0.25 no instante de amostragem igual a 275 com dura\u00e7c\u00e3ao de 4 amostras.\nA coluna esquerda da figura 4.25 mostra o resultado da aplica\u00e7c\u00e3ao da tecnica PNMPC utilizando a pondera\u00e7c\u00e3ao no esforc\u00e7o de controle para um erro de atraso de transporte entre modelo e planta igual a 5. A coluna da direita da mesma figura mostra o resultado com a aplica\u00e7ca\u00e3o da tecnica robusta proposta para o mesmo caso. Neste caso n\u00e3ao se utilizou nenhuma pondera\u00e7ca\u00e3o no esfor\u00e7co de controle para deixar evidente o efeito da tecnica. Nota-se que o resultado obtido com ambas as tecnicas e muito similar. O resultado com a tecnica robusta apresenta um sobressinal maior do que no caso convencional mas parece reagir melhor a perturba\u00e7c\u00e3ao.\nAmostra\n(b1)\n4i\t 7\t\t\t\t\t\t\t\n>J\t| I\t\t\t\t\t\t\t\n\u00e1 1 1 ...!\t\t\t\t\t\t\t\n\t\t\t\t\t\t\u2014\ty -\t- ref.\t\n\t\t\t\t\t-\t\t\n0\t50\t100 150 200 250 300 350\t\t\t\t\t\t\t\nAmostra\n(a2)\n(b2)\nFigura 4.25: Simula\u00e7\u00e3o para erro de atraso =5\nA diferen\u00e7a entre as duas t\u00e9cnicas se faz evidente com os resultados da figura 4.26 para o caso onde n\u00e3o h\u00e9 erro entre modelagem e planta. Neste caso fica evidente que a tecnica robusta proposta oferece uma resposta muito mais r\u00e9pida. Resumindo, significa que desconhecendo-se o erro no atraso a utiliza\u00e7\u00e3o da tecnica robusta proposta deve oferecer uma resposta mais r\u00e9apida sempre quando o erro entre a planta e o modelo adotado for pequeno enquanto que a t\u00e9ecnica convencional de ponderar o esforc\u00e7o de controle vai penalizar sistematicamente o desempenho da resposta.\nA figura 4.27 mostra a derivada da fun\u00e7\u00e3o de Lyapunov ao longo da simula\u00e7ao com erro de atraso igual a 5 amostras. Praticamente todos os valores s\u00e3ao menores ou iguais a zero como previsto.\n4.7.4\tM\u00e9todo iterativo para a restri\u00e7\u00e3o quadr\u00e1tica sobre Au\nOs resultados apresentados nas figuras 4.25, 4.26 e 4.27 utilizam o algoritmo robusto proposto com uma aproxima\u00e7\u00e3o para um dos vetores Au da expressao quadr\u00e9tica que aparece na restricao relacionada com a derivada da fun\u00e7ca\u00e3o de Lyapunov na equa\u00e7c\u00e3ao\n(a1)\nAmostra\n(b1)\nAmostra\n(a2)\nAmostra\n(b2)\nFigura 4.26: Simula\u00e7\u00e3o sem erro no atraso\n4.79.\nNa solu\u00e7\u00e3o iterativa o vetor Au utilizado na primeira iteracao \u00e1 obtido com a aproxima\u00e7\u00e3o Au = Autail como ja explicado. Nas itera\u00e7\u00f5es seguintes o vetor Autail \u00e1 atualizado com a contribui\u00e7ao do vetor obtido com a minimiza\u00e7c\u00e3ao,\nAuta\u00edi(k) = aAun + (1 - a)Autaii(k - 1).\t(4.85)\nO processo iterativo termina quando (Autail(k) \u2014 Auk)T(Autail(k) \u2014 Auk ) \u00e1e menor que um determinado valor pro\u00e1ximo de zero ou quando o nu\u00e1mero de itera\u00e7c\u00e3oes atinge um valor limite.\nA figura 4.28 apresenta os resultados obtidos com o algoritmo iterativo para a minimizac\u00e7\u00e3ao da fun\u00e7c\u00e3ao objetivo. As figuras da coluna esquerda apresentam os resultados para o caso em que h\u00e1a um erro no atraso de transporte entre o modelo da planta e o modelo de predi\u00e7ca\u00e3o igual a 5 instantes de amostragem. Na coluna da direita esta\u00e3o os resultados para o caso em que n\u00e3ao h\u00e1a erro de modelagem. Em ambas as colunas apresenta-se a sa\u00edda no grafico do topo, a a\u00e7c\u00e3ao de controle e o incremento de controle no gra\u00e1fico do meio e a derivada da fun\u00e7\u00e3o de Lyapunov no gr\u00e1fico da base. O objetivo n\u00e3ao \u00e1e propor um m\u00e1etodo para resolver problemas de\nFigura 4.27: Derivada da fun\u00e7\u00e3o de Lyapunov para erro de atraso=5\nPrograma\u00e7\u00e3o quadr\u00e1tica com restri\u00e7\u00f5es n\u00e3o lineares mas avaliar o desempenho da proposta NMPC robusta. O algoritmo iterativo mostrou-se bastante eficiente para este caso o que era de se esperar pois o valor inicial de Auio\u00fc \u00e9 muito bom ja que se nada mudar na refer\u00eancia ou se n\u00e3o houver perturba\u00e7\u00f5es seu valor seria exato. Para sistemas adequadamente amostrados n\u00e3o se espera grandes mudan\u00e7cas entre iterac\u00e7\u00e3oes sucessivas. Os resultados obtidos e apresentados na figura 4.28 mostram um comportamento da a\u00e7c\u00e3ao de controle mais suave e que o valor da derivada da fun\u00e7c\u00e3ao de Lyapunov se manteve sempre negativa. O efeito da perturbac\u00e3o na sa\u00edda foi tambem menor do que o obtido com o algoritmo aproximado.\nFigura 4.28: Desempenho do metodo com algoritmo iterativo\nExemplo 6\nA figura 4.29 mostra o diagrama de processo de um aquecedor de \u00e1gua em linha. O objetivo do processo \u00e9 manter a temperatura e a vazao na sa\u00e9da do duto em valores desejados. Para mostrar a vantagem da t\u00e9cnica robusta proposta sup\u00f5e-se que a medi\u00e7\u00e3o da temperatura \u00e9 realizada a uma dist\u00e2ncia Lt do aquecedor. O\nFigura 4.29: Sistema de aquecimento de \u00e1gua em linha\nmodelo do processo pode ser realizado utilizando-se um balanc\u00e7o de energia no volume do aquecedor. A varia\u00e7ca\u00f5o da energia no interior do aquecedor AEinterna \u00e9 igual a diferenca entre a energia que entra Eentra e a energia que sai, Esai.\nEentra Esai = ^Einterna\t(4.86)\nOs par\u00e2metros e variaveis do processo utilizados na simula\u00e7\u00e3o s\u00f5ao apresentados na tabela 4.1. Assumindo perdas nulas para simplificar,\nEentra\t=\tPaqAtCaTe + P At,\nE -\t- Esai\t_ paqAtcaTi-)\nAEinterna\t~\tpa Aa La ca AT\u00ed , ou\npaAaLaCaATi\t= PaqAtCaTe + PAt - paqAtcaTi (4.87)\nAT\u00ed\nAt\nq T + q T +\nAaLa 1 + AaLa e +\npacaAaEa\n(4.88)\nTabela 4.1: Par\u00e2metros e vari\u00e1veis do processo\nS\u00edmbolo Descri\u00e7\u00e3o\tValor\nT Te\tTemp. \u00e1gua entrando no aquecedor\tK]\nTi\tTemp. \u00e1gua interior do aquecedor\t\tK ]\nq\tVazao na linha\tm3/s J\nP\tPotencia forn. ao aquecedor\tW]\nca\tCalor espec\u00edfico da \u00e9gua\t4168 J/KgK ]\nLa\tComprimento do aquecedor\t0, 3m ]\nDa\tDiametro do aquecedor\t1, 5 x 0, 0254 m ]\nDt\tDiametro do duto\t0, 5 x 0, 0254 m ]\nLt\tDist. aquecedor-transm. temp.\t1, 25 m]\nno limite quando At \u2014> 0,\n=______q_T. + _^_Te +_______1_____\ndt\tAaLa\tAaLa\tpacaAa La\nA fim de utilizar a vazao em unidades litros/hora multiplica-se a vaz\u00e3o por kq = 1/1000 x 3600 e obt\u00e9m-se\ndTj dt\nkq q\nAaLa\nTi +\nkq q\nAaLa\nTe +\n----1----P.\npa caAa La\n(4.90)\nSupoe-se que a temperatura de sa\u00edda do aquecedor \u00e9 igual a temperatura interna Tj. Utilizando a aproximacao de Euler para a derivada pode-se reescrever a equa\u00e7ao 4.90 na forma discreta como,\ndTi = Ti(k) - Ti(k - 1) dt\tTs\n(4.91)\nT,(k -1)+T. kqAL1- Te+\nAaAa\nTi(k)= Ti(k - 1) - Ts Ts \u2014A-^p (k - 1).\npaca AaLa\nAaLa\nDefinindo-se\nki\nT skq\nk2\nAaLa'\nTs\nPacaAaLa\n(4.92)\npode-se escrever\nTi(k) = Ti(k - 1) - kiq(k - 1)T)(k - 1) + kiq(k - 1)Te + k2P(k - 1). (4.93)\nA medi\u00e7\u00e3o da temperatura \u00e9 realizada a uma dist\u00e2ncia Lt na dire\u00e7\u00e3o do fluxo. Nesta posi\u00e7\u00e3o, desprezando perdas, a temperatura medida no instante k, T(k) e igual a temperatura que aconteceu d instantes de tempo igual ao per\u00edodo de amostragem Ts atras na sa\u00edda do aquecedor. Na forma de equa\u00e7\u00e3o cont\u00ednua o atraso u deveria satisfazer a equa\u00e7\u00e3o\n' \u25a0\nLt\nv(t)\nv(t)dt,\nq(t) At\n(4.94)\ne o atraso d seria calculado como o valor inteiro mais proximo de Tp. Uma outra forma e buscar d que satisfaz\nd e Z\n\u2022t = v(k - i)Ts\nLt\nv(k - i)\nq(k - i) At\n(4.95)\nl\nDe forma que a temperatura T, medida na posi\u00e7ao Lt distante do aquecedor, pode ser escrita como\nT(k) = Ti(k - d).\n(4.96)\nSe colocarmos um atraso d em todas as variaveis da equa\u00e7ao 4.93,\nTj(k \u2014 d) = Tj(k \u2014 1 \u2014 d) \u2014 k^q(k \u2014 1 \u2014 d)Tj(k \u2014 1 \u2014 d) + kiq(k \u2014 1 \u2014 d)Te + k^P (k \u2014 1 \u2014 d).\t(4.97)\nUtilizando a equa\u00e7\u00e3o 4.96 em 4.97,\nT(k) = T(k - 1) - kiq(k - 1 - d)T(k - 1) + kiq(k - 1 - d)Te +\t(k - 1 - d).\t(4.98)\nA equa\u00e7\u00e3o 4.98 relaciona a temperatura medida T(k) com a vazao q(k - 1 - d) e com a pot\u00eancia eietrica aplicada P(k - 1 - d) no aquecedor de forma nao linear. N\u00e3o se aplicou o atraso na temperatura de entrada ja que sup\u00e3e-se que a mesma n\u00e3o esta sendo medida.\nPara mostrar o desempenho da tecnica PNMPC robusta proposta simula-se a aplica\u00e7\u00e3o de controle utilizando o algoritmo PNMPC com e sem a aplica\u00e7\u00e3o da tecnica proposta para lidar com erro de modelagem de forma robusta. O objetivo do controle \u00e9 levar a temperatura no ponto de medic\u00e7\u00e3ao para determinados valores desejados enquanto se mantem a vaz\u00e3o o mais proximo poss\u00edvel de um valor desejado. A tabela 4.2 apresenta os valores dos pa-r\u00eametros do processo utilizados na simula\u00e7ao: Trata-se de um\nTabela 4.2: Par\u00e2metros do processo de aquecimento\nVariavel\tValor\tUnidade\nQdes.\t500\tl/h\nTdes.\tdiversas\tK\nTe\t293\tK\np J max.\t10000\tW\nP - J min.\t0\tW\nQreax.\t2000\tl/h\npnin.\t250\tl/h\nproblema MPC com dois objetivos. Alem disso \u00e9 tambem um problema com duas entradas e duas sa\u00eddas. A fun\u00e7\u00e3o custo utilizada consiste em ponderar com pesos diferentes\n\u2014\to seguimento da temperatura de refer\u00eancia, (peso Ri),\n\u2014\to desvio da vazao desejada, (peso R2),\n\u2014\tos elementos do vetor Au relacionados com a Potencia eletrica, (peso Si),\n\u2014\tos elementos do vetor Au relacionados com a Vaz\u00e3o, (peso S2).\nDefinindo Im como a matriz identidade m x m, Ip como a matriz identidade p x p, 0m como a matriz de zeros m x m, e\n\t1\t\t0\t\t0\t\n\u00fc l-l\t1\t\t1\t\t0\t\n\t\t\t\t\t0\t\n\t1\t\t1\t\t1\t\n\t\t\t\t\t\tmxm\n\t\t\t\t\tn T\t\n1m =\t1\t1\t1\t\t1\t-1 mx 1\t\n1p =\t\t1\t\t1\t]T x\t\np\t\t\t\t\t-1 px 1\t\n0 =\t0\t0\t\t0\tr -1 mx 1\t\n(4.99)\nobtem-se\nRi\nR2b\nR2\na 1Ip\na2Im\n' 0m\n0m\n0m\nR2b\nSi = AxIm\nS2 = A2Im\nSi 0m\n0m\tS2\nS\nQ\nQd\nW\n0\nqk-11m\n0\nqdes.1\nTdes.lp\n0m\t0m\n0m Dl\nAu\n(4.100)\nm\nCom essas defini\u00e7\u00f5es pode-se escrever o problema de encontrar o vetor incremento de controle Au como a minimizac\u00f5o da seguinte\nfunc\u00f5o objetivo com restri\u00e7\u00f5es,\nmin J\nAu\ns. a.\nJ = (y- w)tR\u00ed (Y- W + (Q-Qd)TR2(Q-Qd)\n+AuT SAu\nPk \u2014 11 m\t+\tD1\t0m\tAu&lt;\t[ P\t11 J max.2-m\nqk \u2014 1 lm\t\t0m\tD1\t\tqmax. 1m\nPk \u2014 1\t+\tD1\t0m\tAu >\tP\t1 J mtn.2m\nqk\u2014 1\t\t0m D1\t\tqmin. 1m\n(4.101)\nonde Y \u00e9 o vetor com as predi\u00e7\u00f5es no horizonte de predi\u00e7ao p obtido com a tecnica PNMPC na forma Y = F + GAu. Os parametros de sintonia utilizados na aplica\u00e7\u00e3o do algoritmo PNMPC sem a tecnica robusta s\u00f5o apresentados na tabela 4.3.\nTabela 4.3: Par\u00e2metros de sintonia do algoritmo PNMPC sem utiliza-\u00e7ca\u00f5o da tecnica robusta\nPara\u00e2mero\tDescricao\tValor\np\tHorizonte de predicao\t100\nm\tHorizonte de controle\t3\na1\tPond. p/ refer. Temperatura\t1\n\u00ab2\tPond. p/ refer. Vazao\t0,00025\nA1\tPond. incremento Pot. Eletrica\t0,01\nA2\tPond. incremento Vazaao\t5\nAs simula\u00e7co\u00f5es com ou sem a utiliza\u00e7c\u00f5ao da tecnica robusta utilizam o mesmo modelo para predi\u00e7c\u00f5ao com um atraso fixo igual a 4 tempos de amostragem que e em geral menor do que o tempo de atraso que depende da vaza\u00f5o. A figura 4.30 mostra o resultado obtido com a aplicac\u00e7\u00f5ao do algoritmo PNMPC sem a utilizac\u00e7\u00f5ao da tecnica que introduz robustez proposta. Este e um dos resultados poss\u00edveis a depender do ajuste dos par\u00e2metros a2, Ai e A2 se considerarmos fixos os valores de a1, p e m. Nota-se que a temperatura apresenta um comportamento lento mas segue a refer\u00e2ncia desejada. Nesta simula\u00e7ao foi necessario a utilizac\u00f5o de um valor muito grande para a2 que pondera a variac\u00f5o nos incrementos de vaz\u00f5ao, Aq, a fim de garantir a estabilidade. Isto comprometeu\nTempo [ min. ]\nFigura 4.30: Aplica\u00e7\u00e3o de PNMPC n\u00e3o robusto\na capacidade do controle de levar a vaz\u00e3o para valores pr\u00f3ximos do valor desejado. A evolu\u00e7\u00e3o da vazao quando a referencia para a temperatura passa a 315 K e t\u00e3o lenta que a vazao se mantem t\u00e3o baixa a ponto de n\u00e3o utilizar toda a pot\u00eancia eletrica dispon\u00edvel para o aquecimento. O comportamento normal seria a vaz\u00e3o crescer ate o ponto em que a pot\u00eancia atingisse o valor maximo Pmax. = 10000 W. A figura 4.31 mostra que o sistema instabiliza quando se diminui a pondera\u00e7ca\u00e3o sobre a variac\u00e7a\u00e3o nos incrementos de vaz\u00e3o Aq utilizando a mesma ponderacao que no algoritmo PNMPC robusto. Para a simula\u00e7\u00e3o com o algoritmo robusto utilizou-se os par\u00eaametros apresentados na tabela 4.4.\nOs resultados da aplica\u00e7c\u00e3ao do algoritmo robusto s\u00e3ao apresentados nas figuras 4.32 e 4.33. Utilizou-se a versao iterativa do algoritmo PNMPC robusto onde o vetor Au e obtido com um metodo iterativo conforme ja descrito anteriormente. Observa-se neste caso que a temperatura atinge a refer\u00eancia de forma mais r\u00e1pida do que no caso n\u00e3o robusto e, alem disso, a vazao e t\u00e3o proxima do valor desejado quanto e poss\u00edvel pela satura\u00e7\u00e3o da pot\u00eancia em seu valor maximo. Isto \u00e9, na aus\u00eancia de satura\u00e7\u00e3o da potencia eletrica a vaz\u00e3ao atinge a vaz\u00e3ao desejada. No caso da satu-ra\u00e7ca\u00e3o da pot\u00eaencia eletrica para a temperatura de refer\u00eaencia igual a 315 a vazao fica limitada ao valor maximo que, com a pot\u00eancia\nTempo [ min. ]\nFigura 4.31: Aplica\u00e7\u00e3o de PNMPC nao robusto com a2 =0, 2\ndispon\u00edvel fornece a temperatura desejada. A figura 4.33 mostra algumas variaveis auxiliares obtidas com a simula\u00e7\u00e3o. A figura 4.33-a mostra o valor da derivada da fun\u00e7\u00e3o de Lyapunov a cada instante de tempo e nota-se que \u00e9 sempre menor ou igual a zero e maior que o valor m\u00ednimo estipulado. A figura 4.33-b mostra o valor do atraso real do processo durante a simulac\u00e7a\u00e3o onde observase que atinge um valor maximo igual a 23 tempos de amostragem que e muito maior do que o valor igual a 4 utilizado no modelo de predi\u00e7c\u00e3ao. A figura 4.33-c mostra o numero de vezes que o algoritmo de programac\u00e7\u00e3ao quadratica foi acionado para determinar Au. Nota-se que em regime permanente o numero \u00e9 igual a 1 o que significa que n\u00e3o houve itera\u00e7\u00e3es e a aproxima\u00e7\u00e3o de um dos vetores Au utilizando a cola ou tail do vetor calculado no instante de amostragem anterior \u00e9 um otimo valor inicial para o metodo iterativo. Nota-se tambem que o numero de itera\u00e7co\u00e3es utilizado foi relativamente pequeno. A figura 4.33-d mostra o erro de predic\u00e7\u00e3ao e o fator de corre\u00e7\u00e3o n. Como o erro simulado \u00e9 somente de atraso nota-se que o fator de corre\u00e7c\u00e3ao vai a zero em regime permanente. Nos momentos de mudan\u00e7a de refer\u00eancia tem-se valores nao nulos como era de se esperar.\nTabela 4.4: Par\u00eaametros de sintonia do algoritmo PNMPC com a uti-liza\u00e7c\u00e3ao da tecnica robusta\nParamero\tDescricao\tValor\np\tHorizonte de predi\u00e7\u00e3o\t100\nm\tHorizonte de controle\t3\n\u00ab1\tPond.p/ refer. Temperatura\t1\n\u00ab2\tPond. p/ refer. Vaza\u00e3o\t0,00025\nA1\tPond. incremento Pot. Eletrica\t0,0003\nA2\tPond. incremento Vaza\u00e3o\t0,2\nP\tPond. esfor\u00e7co de robustez\t0,01Ip\ne\tValor m\u00ednimo para a dt\t-0,5\nExemplo 7\nEm [86] apresenta-se uma tecnica de controle MPC robusta e sua aplica\u00e7ca\u00e3o a um reator de oxido de etileno. O sistema e modelado atraves de uma matriz func\u00e3o de transferencia na forma cont\u00ednua mostrada na equac\u00e7\u00e3ao 4.102 e na forma discreta equivalente (utilizando uma tempo de amostragem de 1 segundo) na equa\u00e7ca\u00e3o\n4.103.\nG(s) =\nG(z) =\n- 0.19\ns\nnc2i\ndc2is + 1\n-nci2\ndci2s + 1\n0.235\ns\n(4.102)\n-0.19 z-1\nndi2 z-ddi2\nnd2i\t0.235\nz-dd2i\tz-1\n(4.103)\nOs valores de nd12, nd21, dd12 e dd21 utilizados na simula\u00e7\u00e3o da planta s\u00e3o apresentados na tabela 4.5. Para testar a robustez do algoritmo de controle concebeu-se 4 modelos de predi\u00e7ao numerados de 1 a 4 com varia\u00e7\u00e3es nos valores dos par\u00e2metros. O desafio \u00e9 controlar o sistema utilizando os modelos de predi\u00e7\u00e3o com ganhos menores e constantes de tempo maiores do que a planta. A tecnica utilizando MPC com equac\u00e3es de estado denominada Cost Contracting Technique para sistemas integradores \u00e9 apresentada em [86] e controla o sistema. Apresenta-se aqui uma vers\u00e3o do algoritmo PNMPC para sistemas lineares mas incorporando a tecnica robusta proposta. Uma das quest\u00e3es sobre a utiliza\u00e7ao da tecnica robusta proposta diz respeito a factibilidade da soluc\u00e3o.\nTempo [ min. ]\nFigura 4.32: Aplicac\u00e3o de PNMPC robusto\nTabela 4.5: Par\u00e2metros do modelo discreto\nMod.\tndi2\tddu\tnd2i\tdd\u20182i\nTrue\t-0.5677\t0.8787\t-0.2178\t0.8963\n1\t-0.1226\t0.9738\t-0.0044\t0.9448\n2\t-0.0125\t0.9262\t-0.0143\t0.9932\n3\t-0.0045\t0.9738\t-0.0005\t0.969\n4\t-0.0850\t0.9500\t-0.0236\t0.8963\nOu seja, existe a solu\u00e7c\u00e3ao e o algoritmo proposto tem condic\u00e7o\u00e3es de encontr\u00e1-la? Para este problema resolveu-se mostrar que\n\u2014\ta matriz Hessiana da funcao objetivo \u00e1 positiva definida. Isto \u00e1e verificado mostrando que o determinante de todas as matrizes menores principais, (leading minors) da matriz Hes-siana s\u00e3ao maiores do que zero.\n\u2014\tO Numero de condi\u00e7ao da matriz Hessiana apresenta valores pequenos. A matriz Hessiana n\u00e3ao \u00e1e singular nem tampouco se aproxima da singularidade.\n\u2014\tO m\u00e9todo iterativo utilizado para tratar da restricao quadr\u00e1tica em Au converge em poucas itera\u00e7co\u00e3es. O m\u00e1etodo \u00e1e muito semelhante ao consagrado m\u00e1todo simplex, [87], utilizado na\nFigura 4.33: Aplica\u00e7\u00e3o de PNMPC robusto-vari\u00e1veis auxiliares\nsolu\u00e7\u00e3o de equa\u00e7\u00f5es lineares onde parte-se de um bom valor inicial e o sistema converge para o valor correto. Neste caso a natureza do problema fornece naturalmente um otimo valor iniciar que \u00e9 a cola ou tail do vetor Au obtido no instante de amostragem anterior.\n\u2014 O sistema controlado com a tecnica robusta proposta \u00e9 es-t\u00e9vel com uma ampla faixa de valores de pondera\u00e7\u00e3o na diagonal da matriz P. Isto sera mostrado variando-se o valor da diagonal da matriz P entre 1% e 100% do seu valor nominal.\nPara demonstrar o desempenho da t\u00e9cnica PNMPC robusta aplicada neste exemplo a planta foi simulada com o modelo real mostrado na tabela 4.5. O modelo utilizado para as predic\u00e3es inicia com o modelo 4 que \u00e9 substitu\u00eddo pelo modelo numero 3 no tempo igual a 100 s, pelo modelo numero 2 no tempo igual a 130 s e pelo modelo 1 a partir do tempo igual a 160 s. Os par\u00e2metros utilizados para a sintonia do algoritmo PNMPC robusto s\u00e3ao apresentados na tabela 4.6.\nAs restri\u00e7\u00e3es utilizadas s\u00e3o as mesmas adotadas em [86]. A escolha dos par\u00e2metros de sintonia como p, m e as pondera\u00e7\u00e3es\nTabela 4.6: Par\u00e2metros de sintonia do algoritmo PNMPC com a uti-lizacao da tecnica robusta p/ o controle do reator de oxido de etileno\t\t\nParamero\tDescri\u00e7\u00e3o\tValor\np\tHorizonte de predi\u00e7\u00e3o\t6\nm\tHorizonte de controle\t3\nRi\tPond.p/ refer\u00eancia sa\u00edda 1\t1 1Ip,p\nR2\tPond. p/ referencia sa\u00edda 2\t1, 1Ip,p\nQi\tPond. incr. controle p/ entrada 1\tIm,m\nQ2\tPond. incr. controle p/ entrada 2\t1 65I m,m\na\tConst. p/ filtragem erro de predic\u00e7\u00e3ao\ta = 0.8\nPi\tPeso para robustez erro 1\t0.06Ip,p\nP2\tPeso para robustez erro 2\t0.22Ip,p\ne\tMin. p/ a derivada da fun\u00e7\u00e3o de Lyapunov\t-2.0\na.max ui\tValor maximo para entrada 1\t0,75\n..max u2\tValor maximo para entrada 2\t0,75\n, .min ui\tValor min. para entrada 1\t-0,75\nmin u2\tValor min. para entrada 2\t-0,75\nAumax\tValor maximo p/ incr. entrada 1\t0,5\nAumin\tValor m\u00ednimo p/ incr. entrada 2\t-0,5\nutilizadas seguem a criterio tradicional de balancear desempenho e robustez e exceto pela matriz P nao serao discutidas.\nA figura apresenta as variaveis controladas e manipuladas aplicando a sintonia descrita. Nota-se que as variaveis atingem o valor de referencia sem oscilac\u00e3es e as a\u00e7\u00f5es de controle seguem as restri\u00e7\u00e3es impostas. A figura 4.35 mostra diversas variaveis de interesse. As figuras 4.35-a e 4.35-b mostram o erro de modelagem e a integral do erro filtrado para a variavel 1 e 2 respectivamente. Nota-se que a utiliza\u00e7\u00e3o de a = 0, 8 no algoritmo de tratamento do erro de modelagem resulta em uma integral do erro filtrado bastante suave. A figura 4.35-c mostra a evolu\u00e7c\u00e3ao da derivada da func\u00e3o de Lyapunov. Como exigido cada vez que se calcula a ac\u00e7\u00e3ao de controle ela e mantida sempre menor ou igual a zero e obedece o limite inferior igual a -2. Como o problema de encontrar o vetor Au significa encontrar o m\u00ednimo de uma funcao quadratica,\n(a)\n\t\t\t\t\t\t\t\t\t!\t\n! i 1 \tIz\t- V a y\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t-- - ref,\t\na / \u2019/y\t\t\t\t\t\t\t\t\t--- ref2\t\n\t\t\t\t\t\t\t\t\t\ty2\t\n0\t20\t40\t60\t80\t100\t120\t140\t160\t180\t200\nTempo [s]\n(b)\nFigura 4.34: Resposta com aplica\u00e7\u00e3o da t\u00e9cnica robusta\n(a)\n0.05 0\t\t\t\n\t\t\t\n0.05\t\u00ed\t\tErro1\t\n-0.1\t\u00ed\t\u2014li\t\n0\t50\t100\t1 50\t200\n(b)\n0\t50\t100\t150\t200\n\t14\tN\u00famero de\t/\ndL/dt\t12\tX condi\u00e7\u00e3o de |\t\n\t10\tL_\t\n\t8\t\t\n(e)\n(f)\n4.26\n4.24\n4.22\nMenor\tT\ndeterminante dos (Leading Minors de&lt;|>)\nmm\n4'20\t50\t100\t150\t200\nTempo [s]\n50\t100\t150\t200\nTempo [s]\n4\n2\nFigura 4.35: Vari\u00e9veis auxiliares obtidas com a simulac\u00e3o\nent\u00e3o e importante garantir que a matriz $ seja invers\u00edvel e tamb\u00e9m positiva definida. A figura 4.35-d mostra o nUmero de condi\u00e7\u00e3o da matriz $ e a figura 4.35-e mostra o valor do menor\nd 2 J determinante dentre os leading minors da matriz $ = ^\u00bf2 \u2022 Observa-se que o n\u00famero de condi\u00e7\u00e3o \u00e9 pequeno indicando que a matriz \u00e9 invers\u00e9vel e est\u00e9 longe da singularidade. O fato do menor valor dentre os determinantes dos leading minors da matriz $ ser positivo indica que a matriz \u00e9 positiva definida e a matriz apresenta um m\u00ednimo global na aus\u00eancia de restric\u00e3es. A figura 4.35-f apresenta o numero de vezes que se utilizou o algoritmo de programa\u00e7c\u00e3ao quadr\u00e9atica no processo iterativo devido a restricao quadr\u00e9tica. Nota-se que atingiu-se o erro aceitavel com no m\u00e9ximo 3 itera\u00e7\u00e3es e que em regime permanente, depois das mudan\u00e7as de modelo, n\u00e3o se fez necessario itera\u00e7\u00f5es extras devido a utiliza\u00e7\u00e3o do valor inicial de Auesp. igual a cola de Au utilizado no instante de amostragem anterior.\nA fim de mostrar a robustez da solu\u00e7c\u00e3ao robusta proposta simulou-se a aplica\u00e7ao do algoritmo PNMPC robusto com valores de P variando desde 1 % at\u00e9 110 % do valor nominal utilizado. Os resultados s\u00e3o apresentados na figura 4.36.\nFigura 4.36: Desempenho do algoritmo com diferentes pesos P\nPercebe-se que todas as escolhas da matriz de pondera\u00e7\u00e3o P fornecem uma resposta estavel das sa\u00eddas apesar de um comportamento din\u00e2mico diferente na mudanca de refer\u00eancia mostrando que n\u00e3o seria dif\u00edcil encontrar uma pondera\u00e7\u00e3o P que estabilize o sistema. A figura 4.37 mostra a resposta obtida sem a utiliza-\u00e7c\u00e3ao da tecnica robusta mas com todos os demais par\u00e2ametros de sintonia do algoritmo PNMPC robusto utilizados anteriormente. Observa-se que o algoritmo PNMPC sem a tecnica robusta consegue estabilizar o sistema ate o tempo igual a 100 segundos quando o modelo de predi\u00e7c\u00e3ao e o de numero 4. Para os modelos numero 3 e 2 utilizados a partir do tempo igual a 100 segundos o sistema instabiliza e so n\u00e3o cresce indefinidamente devido a restri\u00e7\u00e3o nos incrementos e nas a\u00e7\u00e3es de controle. A instabilidade fica tambem evidente pelos valores positivos da derivada da fun\u00e7c\u00e3ao de Lyapunov mostrada na figura 4.38-c. O comportamento dos erros de modelagem e fatores de corre\u00e7\u00e3o mostrados nas figuras 4.38-a e 4.38-b tambem mostram o comportamento oscilatorio durante o tempo em que o modelo de predi\u00e7c\u00e3ao utilizado foi o numero 3 e 2. O comportamento do sistema com o modelo numero 1, a partir do tempo igual a 160 segundos, apresenta uma oscila\u00e7\u00e3o moderada e as ac\u00e7\u00e3oes de controle n\u00e3ao atingiram seus valores de saturac\u00e7\u00e3ao. O sistema parece a beira da instabilidade e simula\u00e7co\u00e3es com a introducao de ru\u00eddo mostram que o sistema instabiliza para todos os modelos de predi\u00e7\u00e3o 4, 3, 2 e 1. Verificou-se tambem que a utiliza\u00e7ao do tratamento do erro de modelagem com a = 0 instabiliza o sistema para todos os modelos de 1 a 4. Ja a utiliza\u00e7\u00e3o de a = 0, 9 estabiliza o sistema para os modelos 4 e 1 mas n\u00e3ao para os modelos 3 e 2.\n4.8\tConclus\u00e3o e desenvolvimentos futuros\nApresentou-se neste cap\u00edtulo a proposta de um algoritmo MPC para aplica\u00e7c\u00e3ao em sistemas n\u00e3ao lineares com comportamento dos estados cont\u00ednuos e diferenciaveis em rela\u00e7\u00e3o as entradas. A t\u00e9cnica proposta, denominada de MPC N\u00e3ao linear pratico-PNMPC, prop\u00e3oe uma forma generalizada de representa\u00e7c\u00e3ao do vetor de predi\u00e7\u00f5es valida para sistemas lineares ou n\u00e3o lineares (sistemas com estados cont \u00ednuos e diferenciaveis em rela\u00e7\u00e3o as entradas). A rep-resenta\u00e7c\u00e3ao linear das predi\u00e7c\u00e3oes e realizada utilizando-se um pro-\nFigura 4.37: Resultado da simula\u00e7\u00e3o sem aplicacao da tecnica robusta\n(b)\nFigura 4.38: Variaveis auxiliares na simula\u00e7\u00e3o sem a tecnica robusta\ncedimento numerico e por isso o algoritmo pode ser aplicado as mais diversas formas de representac\u00e7\u00e3ao de sistemas n\u00e3ao lineares como redes neuronais, modelos NARMAX, etc.\nCom o intuito de obter melhores predi\u00e7\u00f5es, desenvolve-se um\nprocedimento num\u00e9rico de dois passos que obt\u00e9m uma aproxima\u00e7\u00e3o linear com qualidade pr\u00f3xima a representa\u00e7\u00e3o Taylor de 2a. ordem. A tecnica proposta incorpora uma metodologia para o tratamento de erros de modelagem baseada na escolha de um unico par\u00e2metro que pondera o requisito de filtragem de ru\u00eddo e velocidade de resposta.\nA estabilidade do algoritmo e fortemente melhorada com a incor-pora\u00e7ca\u00e3o de uma tecnica que coloca o requisito de estabilidade na fun\u00e7\u00e3o objetivo. Isto e realizado exigindo-se que a derivada de uma fun\u00e7\u00e3o de Lyapunov mantenha-se negativa no horizonte de predi\u00e7c\u00e3ao.\nA implementa\u00e7ao deste requisito no algoritmo de Programa\u00e7ao Quadratica enfrenta a dificuldade do surgimento de uma restric\u00e3o quadr atica no vetor incremento de controle Au.\nUma solu\u00e7\u00e3o inicial para este problema e apresentada e consiste na transformac\u00e7\u00e3ao da restri\u00e7c\u00e3ao quadratica sobre Au em linear ao se aproximar um dos vetores Au como a cola do vetor obtido no instante de amostragem anterior, Auio\u00a1\u00a1.\nNa sequ\u00e2ncia desenvolve-se um processo iterativo onde a restri-c\u00e7\u00e3ao e transformada em linear ao se estimar um valor inicial do vetor incremento de controle baseado na cola do vetor Au anterior, Au\u00edai\u00ed somente na primeira itera\u00e7\u00e3o. Este vetor e corrigido com parte do novo vetor obtido a cada itera\u00e7c\u00e3ao em um processo iterativo que e interrompido quando o erro entre este e o vetor Au atual obtido torna-se suficientemente pequeno.\nA soluc\u00e7\u00e3ao do problema de Programac\u00e7\u00e3ao Quadr atica com restri\u00e7c\u00e3ao quadratica n\u00e3ao e o objetivo principal deste trabalho mas deve ser investigada na continua\u00e7c\u00e3ao da pesquisa com o objetivo de aprimorar o algoritmo e estabelecer as condi\u00e7co\u00e3es de opera\u00e7c\u00e3ao segura do mesmo.\nN\u00e3ao e demais voltar a salientar que o algoritmo desenvolvido aplica-se a sistemas cont\u00ednuos em relac\u00e3o as entradas e que sejam amostrados seguindo as melhores tecnicas de amostragem de sistemas. O algoritmo e aplicado aos estados do sistema e este trabalho na\u00e3o pretende oferecer nenhuma novidade na quest\u00e3ao relacionamentos estado-sa\u00edda de sistemas.\nCap\u00edtulo 5\nControle aplicado a po\u00e7os operando via GLC\nNos Ultimos 10 anos algumas empresas atuando na explora\u00e7\u00e3o e produc\u00e3o de petr\u00f3leo come\u00e7aram a introduzir t\u00e9cnicas de controle e automa\u00e7ao na opera\u00e7\u00e3o de pocos de petr\u00f3leo. Essas iniciativas resultaram em tecnicas com nomes como smart wells, intelligent wells, smart fields ou Gerenciamento Digital Integrado da Produ\u00e7ao-GEIDG na Petrobras, [88]. A introdu\u00e7\u00e3o da tecnologia da informa\u00e7\u00e3o no sistema de produ\u00e7\u00e3o de petr\u00f3leo \u00e9 lento principalmente devido ao custo proibitivo da interven\u00e7c\u00e3ao em po\u00e7cos para a instala\u00e7ca\u00e3o dos sensores e atuadores necess\u00f3arios. Al\u00f3em disso os equipamentos a serem instalados no fundo dos po\u00e7os tem de suportar as condi\u00e7co\u00e3es adversas causadas por alta press\u00e3ao, temperatura e vibra\u00e7c\u00e3oes. Neste cap\u00f3tulo apresenta-se uma breve revis\u00e3ao do desenvolvimento de t\u00f3ecnicas de controle, otimiza\u00e7ca\u00e3o e automa\u00e7c\u00e3ao da operac\u00e7\u00e3ao de poc\u00e7os utilizando elevac\u00e7\u00e3ao do tipo GLC. Na sequ\u00e2ncia s\u00e3o apresentados duas abordagens para a au-tomac\u00e7\u00e3ao da operac\u00e7\u00e3ao.\n5.1\tIntrodu\u00e7\u00e3o\nO desenvolvimento de tecnicas de controle para po\u00e7os operando via GLC tem sido intenso no meio acad\u00e2mico e industrial como em [22], [89], [23], [24], [31], [25], [26], [27], [28], [29], [30],[44]. A otimiza\u00e7c\u00f5ao da produ\u00e7c\u00f5ao de po\u00e7cos operando via GLC tem recebido tambem a aten\u00e7\u00f5o de diversos pesquisadores com os primeiros trabalhos publicados na decada de 70. Em [90], o termo curva de desempenho (well performance curve ou WPC) foi introduzido e utilizado para modelar a rela\u00e7\u00f5o entre gas de injec\u00f5o e taxa de pro-du\u00e7\u00f5o. O metodo equal-slope foi proposto em [91]. A distribui\u00e7\u00f5o do gas de injec\u00f5o \u00e9 obtida computando a inclinacao (slope) das tangentes das curvas de desempenho que satisfazem as condi\u00e7co\u00f5es de otimalidade de primeira ordem (Karush-Kuhn-Tucker Conditions) [52].\nUma abordagem mais flex\u00edvel para o problema de alocac\u00f5o de gas de inje\u00e7\u00f5o foi proposta em [92, 93]. Nishikiori et al. desenvolveram um metodo, baseado no metodo quasi-Newton e pro-jec\u00e7\u00f5ao de gradiente, capaz de tratar limites de inje\u00e7ca\u00f5o nos poc\u00e7os alem da restri\u00e7c\u00f5ao de disponibilidade de gas de inje\u00e7c\u00f5ao. Um procedimento heur\u00edstico foi tambem desenvolvido para encontrar uma estimativa inicial que esteja dentro da regi\u00f5ao de converg\u00e2encia do algoritmo quasi-Newton.\nEm [94], um metodo com converg\u00e2encia global foi proposto para encontrar a aloca\u00e7c\u00f5ao otima de gas de inje\u00e7cao que maximiza a produc\u00e7a\u00f5o de oleo. Este metodo pode ser visto como uma exten-s\u00f5o do metodo proposto em [92, 93], o qual utiliza um algoritmo de programa\u00e7\u00f5o quadr\u00e1tica sequencial (PQS) [95] no lugar do metodo quasi-Newton. Em [96, 97], um modelo linear por partes alternativo e proposto para o problema de aloca\u00e7c\u00f5ao de gas de injec\u00e7a\u00f5o, para cenarios com restri\u00e7c\u00f5ao na disponibilidade de gas, limites inferiores e superiores para injec\u00e7\u00f5ao em cada poc\u00e7o e tratamento de curvas de desempenho n\u00f5ao-c\u00e2oncavas. Este trabalho traz grande aprofundamento teorico, atraves do estudo poliedrico do espa\u00e7co de restri\u00e7c\u00f5oes, e a concep\u00e7c\u00f5ao de cortes baseados na no\u00e7c\u00f5ao de cobertura em problemas da mochila [98, 99]. Estes desenvolvimento levam a algoritmos tipo cut-and-branch eficazes, capazes de resolver problemas de aloca\u00e7c\u00f5ao de grande porte e obter uma solu\u00e7ao comprovadamente otima.\nNa sequ\u00e2ncia \u00e9 apresentado um resumo de alguns projetos de\ncontrole da operac\u00e3o de po\u00e7os com eleva\u00e7\u00e3o do tipo GLC implementados por companhias operadoras.\n5.1.1\tElf 1990\nDiversos trabalhos sobre a otimizac\u00e3o da eleva\u00e7\u00e3o por gas lift tem sido publicados como [100] e [91] mas possivelmente o primeiro trabalho apresentado em Congresso descrevendo a automac\u00e7\u00e3ao da opera\u00e7\u00e3o de po\u00e7os operando via gas lift foi o de P. Letemayer e P. M. Miret para o campo de Gonelle no Gab\u00e3o [101]. Neste trabalho os autores descrevem os benef\u00edcios atingidos com a aplica\u00e7\u00e3o de uma t\u00e9cnica de controle e automa\u00e7\u00e3o dos po\u00e7os do campo de Gonelle, Gabao em Mar\u00e7o de 1990. Sem duvida os principais benef\u00edcios foram um aumento da producao de cerca de 20% com uma redu\u00e7\u00e3o da taxa de injecao de g\u00e9s tambem em cerca de 20%. Algumas caracter\u00edsticas da solu\u00e7\u00e3o adotada s\u00e3o:\n\u2014\tInfer\u00eancia da vazao de producao baseado na medic\u00e3o da Temperatura do fluido produzido na cabe\u00e7a do po\u00e7o.\n\u2014\tSistema de Controle Local mas conectado a um sistema su-pervis\u00edorio, isto \u00ede, PLC situado junto a cada po\u00e7co mas trocando informa\u00e7c\u00e3ao com a sala de comando.\n\u2014\tControle da Vazao de Inje\u00e7ao de Gas \u00e9 o ajuste principal.\n\u2014\tMedic\u00e3o das press\u00f5es na cabeca do po\u00e7o no tubo de produ\u00e7\u00e3o, THP, no revestimento, CHP, temperatura no topo do tubo de produ\u00e7ao, THT e vaz\u00e3o de injecao de gas, IGR.\n\u2014\tAtuac\u00e3o no choke de produ\u00e7ao \u00e9 utilizada para controle de partida e re-partida do po\u00e7co.\nE importante observar que defende-se neste trabalho o controle da vazao de inje\u00e7\u00e3o de g\u00e9s em malha fechada, Effectively, as a slight plugging occurs, the system detects an IGR decrease and immediatelly corrects choke opening. Plugging tendancy is therefore eliminated.\u201d\n(drawndown) ja que a forma\u00e7\u00e3o e pouco consolidada e exige cuidados especiais.\nO trabalho n\u00e3o apresenta maiores detalhes sobre a tecnica de otimiza\u00e7c\u00e3ao utilizada na alocac\u00e7\u00e3ao de gas e tampouco descreve os algoritmos de controle.\nDesde a publica\u00e7\u00e3o do trabalho de P. Letemayer e P. M. Miret no campo de Gonelle muitos outros trabalhos tem sido publicados sobre o tema.\n5.1.2\tSuez Oil Co. 1995\nEm [102] discute-se a utilizac\u00e3o de um modelo completo do sistema de produ\u00e7ao via gas-lift do campo Ras Budran no Golfo de Suez para utilizac\u00e3o na otimiza\u00e7\u00e3o do processo.\nO \u00eanfase e dado para a distribuicao otima de gas de inje\u00e7ao em cenarios de disponibilidade limitada de gas. Os po\u00e7cos produzem fortemente sub saturados o que permite a considera\u00e7ca\u00e3o de uma relacao linear para a curva IPR. Todas as perdas de press\u00e3o s\u00e3o modeladas utilizando correla\u00e7\u00f5es dispon\u00edveis na literatura. Para o escoamento multifasico vertical utilizou-se correla\u00e7\u00f5es de Orki-asewski Hagedorn e Brown e Mukherjee e Brill conforme a avali-a\u00e7c\u00e3ao do erro em relac\u00e7\u00e3ao a testes de press\u00e3ao efetuados. O trabalho apresenta de forma suscinta o metodo utilizado para a aloca\u00e7ca\u00e3o de gas. Trata-se do metodo equal slope. Um modelo matematico e obtido para cada po\u00e7o relacionando a vaz\u00e3o de inje\u00e7ao x de um poco j, (xj) com sua vaz\u00e3o de l\u00edquido total fj(x).\nn\nfj(x) =\tbj\u2019ixl\t(5J)\nl=1\nOs coeficientes bjl s\u00e3o determinados pelo metodo dos m\u00ednimos quadrados.\nEncontra-se para cada po\u00e7o j a vazao de injec\u00e3o (x*) que fornece o ponto onde o gradiente da vaz\u00e3o de produc\u00e3o de l\u00edquido e zero:\ndfj (x)\t.\t.\ndT' =0\t(5.2)\nNo caso em que a capacidade dos compressores nao possa fornecer a vaz\u00e3ao total exigida pelos poc\u00e7os para funcionarem nos seus pon-\ntos \u00e1timos resolve-se o seguinte problema de otimiza\u00e7\u00e3o:\nmax(f1(x1) +\t+ ... + fm(xm))\t(5.3)\nsujeito a\nxi + x2 + ... + xm &lt;X\nxi > 0\nO problema de otimiza\u00e7ao pode tornar-se mais complexo se outras restri\u00e7\u00e3es s\u00e3o introduzidas como limites para as vaz\u00e3es de inje\u00e7\u00e3o m\u00ednimas e restri\u00e7\u00f5es nos equipamentos a juzante do po\u00e7o como linhas de fluxo e separadores. O artigo conclui que\n\u2014\ta atualizacao do modelo desenvolvido com novas medi\u00e7oes \u00e1 essencial para sua utilizac\u00e3o como uma ferramenta para a otimiza\u00e7c\u00e3ao do processo.\n\u2014\tOs erros obtidos ficaram entre os modelos desenvolvidos e as medi\u00e7oes ficaram entre 1 e 1.5%.\n\u2014\t11 pocos foram melhor modelados com a correlac\u00e3o de Ork-iszewski, 4 com a correla\u00e7ao de Hagedorn e Brown e 1 com a de Mukherjee e Brill.\n5.1.3\tShell 1998\nEm [103] discute-se aspectos de otimiza\u00e7\u00e3o de gas lift sob o ponto de vista da tecnologia desenvolvida pela empresa Shell. O artigo mostra t\u00e1ecnicas para a obten\u00e7ca\u00e3o das vaz\u00e3oes de produ\u00e7c\u00e3ao e sua utiliza\u00e7\u00e3o na otimiza\u00e7\u00e3o do uso do g\u00e1s dispon\u00edvel para inje\u00e7\u00e3o. Nota-se a aplicac\u00e3o de controle tanto no choke de injec\u00e3o como no choke de produ\u00e7\u00e3o. Apresenta-se ainda diversas tecnicas desenvolvidas pela empresa Shell como:\n\u2014\tWellDone - WellDone \u00e9 o nome do algoritmo de otimiza\u00e7ao para teste de po\u00e7co que analisa medi\u00e7co\u00e3es de separadores de teste em tempo real. Otimiza o tempo de teste. Trata-se de um sistema automatizado para testes de poc\u00e7os. O sistema de teste inclui a cabeca do po\u00e7o, as linhas de fluxo entre a cabe\u00e7a do po\u00e7o e o separador, o separador de teste e sua instrumentac\u00e7\u00e3ao.\n\u2014\tDeltaP - E um m\u00e1todo para calcular a producao de l\u00e1quido baseado na queda de press\u00e3ao em um orif\u00e1cio instalado na linha de fluxo perto do separador.\n\u2014\tIGUF - Incremental Gas Utilization Factor. Determina a resposta da produ\u00e7c\u00e3ao do po\u00e7co para incrementos em sua vaz\u00e3ao de inje\u00e7c\u00e3ao de gas.\n\u2014\tDynaCon - usa a manipula\u00e7ao do choke de produ\u00e7ao para estabilizar po\u00e7cos que exibem comportamento insta\u00e1vel.\n\u2014\tSGAS - Shell usa um pacote de software para tempo real chamado SGAS para monitoramento do sistema de gas-lift e seus po\u00e7cos associados. Realiza uma distribui\u00e7c\u00e3ao autom\u00e1atica de g\u00e1as para os po\u00e7cos para manter uma pressa\u00e3o esta\u00e1vel no sistema de gas-lift e uma distribui\u00e7c\u00e3ao \u00e1otima e est\u00e1avel para os po\u00e7cos. SGAS monitora a press\u00e3ao na cabe\u00e7ca dos po\u00e7cos (THP e CHP - Tubing Head Pressure e Casing Head Pressure) e utiliza estas informa\u00e7c\u00e3oes para identificar poc\u00e7os inst\u00e1aveis.\n\u2014\tGLUE - A aloca\u00e7\u00e3o de gas \u00e1 baseada nas curvas de desempenho de gas-lift de todos os po\u00e7cos. As curvas de desempenho s\u00e3ao obtidas com um programa de an\u00e1alise de gas-lift chamado GLUE (Gas Lift Users Environment).\nShell utiliza a medi\u00e7c\u00e3ao da queda de press\u00e3ao em um orif\u00e1cio para calcular a vaz\u00e3ao de o\u00e1leo. Este \u00e1e o m\u00e1etodo DeltaP.\nAP = f (k,Qiiq.,Qg^ic)\t(5.4)\nO valor de k est\u00e1 associado com a abertura do orif\u00edcio, Qliq. representa a vaz\u00e3o de l\u00e1quido produzida e Qgt_lcrepresenta a vazao total de ga\u00e1s nas condi\u00e7c\u00e3oes da linha.\nQgt_sc = Qgisc + FGOR(1 \u2014 BSW )Qliq.\t(5.5)\nFGOR e BSW representam o GOR (Gas Oil Ratio) da formac\u00e3o e a satura\u00e7\u00e3o de \u00e1gua respectivamente. Qgt_sc e Qgi_sc sao a vaz\u00e3ao total de ga\u00e1s e a vaz\u00e3ao de inje\u00e7c\u00e3ao de g\u00e1as, respectivamente em condi\u00e7ca\u00e3o padra\u00e3o. A vaz\u00e3ao de o\u00e1leo pode ser calculada combinando-se as equa\u00e7co\u00e3es 5.4 e 5.5:\nQoil = f (k, Qg^sc, FLP, AP, FGOR, BSW)\t(5.6)\nFLP (Fow Line Pressure) \u00e1e usada para converter a vaz\u00e3ao de g\u00e1as da condic\u00e7\u00e3ao de linha para a condi\u00e7c\u00e3ao padr\u00e3ao. O fator de cali-\nbra\u00e7ao (depende do diametro do orif\u00edcio), o FGOR e BSW s\u00e3o determinados durante um teste de po\u00e7co. Assume-se que estes pa-r\u00e2ametros mantenham-se constantes entre os testes de po\u00e7cos. O di\u00e2metro do orif\u00edcio utilizado e selecionado de forma a inserir uma queda de press\u00e3o muito pequena, da ordem de 7 psi. Testes de campo realizados em 9 po\u00e7os offshore mostraram que em 90% das medi\u00e7\u00e3es realizadas com a tecnica DeltaP obteve-se um erro menor ou igual a 10%.\nDynacon e a tecnica de controle utilizada para estabilizar e minimizar a Press\u00e3o no topo do revestimento (CHP). Assume-se que a vazao de inje\u00e7\u00e3o seja implementada de forma independente, isto e, n\u00e3o se manipula a vaz\u00e3o de inje\u00e7\u00e3o para efeito de controle da din\u00e2amica. A estrategia de controle adota uma configura\u00e7c\u00e3ao de dois PIDs em cascata. A malha interna utiliza a medic\u00e3o da pressao no topo do revestimento (CHP) para obter uma ac\u00e3o de controle que e a abertura do choke de produ\u00e7\u00e3o. O valor de refe-r\u00e2encia para a malha interna e fornecido por uma malha que utiliza a medi\u00e7\u00e3o da abertura do choke de producao e tem como refer\u00eancia uma abertura desejada. O choke de produ\u00e7\u00e3o deveria estar sempre aberto para obter-se a maxima produ\u00e7\u00e3o. Entretanto, a fim de garantir uma certa margem de controle para estabilizar-se a press\u00e3ao de revestimento, deve-se mante-lo com uma abertura ligeiramente menor que 100%. Assim a refer\u00e2encia para a abertura do choke na malha PID externa e calculada em func\u00e7\u00e3ao da vaz\u00e3o de inje\u00e7\u00e3o. A figura 5.1 mostra a estrategia de controle Dynacon proposta neste trabalho. Sup\u00e3e-se que a velocidade de resposta da malha externa seja bem menor do que a malha interna a fim de que a malha interna possa atuar na estabiliza\u00e7ca\u00e3o da pressa\u00e3o do revestimento e que a longo prazo a abertura do choke de produ\u00e7c\u00e3ao atinja a abertura de refer\u00e2encia desejada suavemente. O fato da abertura de refer\u00e2encia do choke de produ\u00e7c\u00e3ao ser uma fun\u00e7ca\u00e3o da vaz\u00e3ao de inje\u00e7c\u00e3ao parece normal nesta estrategia uma vez que necessita-se de uma margem de atua\u00e7c\u00e3ao do choke maior para valores de inje\u00e7ca\u00e3o menores pois a din\u00e2amica do sistema tem uma atenua\u00e7c\u00e3ao menor para taxas de injec\u00e7\u00e3ao menores.\nFigura 5.1: Estrategia de Controle Dynacon\nvazao constante) e da queda de pressao no anular (pequena). Assim, controlar a pressa\u00f5o no topo do revestimento para uma vaza\u00f5o de inje\u00e7\u00f5o constante equivale a controlar a press\u00f5o no tubo de produ\u00e7\u00f5o no ponto de injecao de gas. Por outro lado a diferen\u00e7a da pressa\u00f5o neste ponto do tubo de produc\u00e7\u00f5ao para a press\u00f5ao na frente dos canhoneados deve-se praticamente a queda de press\u00f5o exercida pela coluna de fluido produzido pela forma\u00e7ao no intervalo entre a profundidade dos canhoneados e a valvula operadora. Desprezando-se o atrito, este valor seria constante e dependeria da densidade media do fluido produzido.\nO artigo defende uma estrategia de fechamento do choke de pro-du\u00e7c\u00f5ao para aumentar a produc\u00e7a\u00f5o em rela\u00e7c\u00f5ao aquela que seria obtida com o choke 100% aberto para pocos operando em regiao inst\u00e1vel. A justificativa \u00e9 que com o choke 100% aberto o comportamento do tipo slug-flow resulta em uma produc-ao media pequena comparada com a que se pode obter com o poc\u00e7o controlado atraves do fechamento do choke. A ideia seria utilizar o metodo DeltaP para buscar uma abertura de choke que maximize a produc\u00f5o. Esta parte do trabalho nao esta bem clara pois ao mesmo tempo defende-se uma estrategia para estabilizar o poc\u00e7o\nutilizando-se o Dynacon.\n5.1.4\tTexaco 1999\nEm [104] o trabalho desenvolvido pela Texaco Exploration and Production descreve um programa de automac\u00e3o de po\u00e7os operando por gas lift com exemplos do Lake Barre Field e Gulf of Mexico. Este trabalho defende a considera\u00e7\u00e3o do custo da taxa de injec\u00e3o de gas na obten\u00e7c\u00e3ao do ponto otimo assim como outros autores. Defende tambem a considera\u00e7c\u00e3ao do custo da agua produzida e o valor associado diferente para o gas produzido pelo poco. De acordo com os autores estas considera\u00e7c\u00e3oes ir\u00e3ao colocar o ponto otimo sem restri\u00e7ao um pouco \u00e0 esquerda do otimo que considera apenas a produ\u00e7\u00e3o total de petroleo. O objetivo principal do sistema e controlar a inje\u00e7c\u00e3ao de g as para cada po\u00e7co de forma que este receber a sua taxa de inje\u00e7c\u00e3ao otima. As taxas s\u00e3ao mantidas constantes mesmo quando a press\u00e3ao de suprimento varia.\nAs caracter\u00edsticas dos po\u00e7os s\u00e3o obtidas com testes do tipo step rate well test. Com estes testes, curvas que relacionam a vazao de produ\u00e7c\u00e3ao com a taxa de inje\u00e7c\u00e3ao de gas s\u00e3ao obtidas. Utilizando as sa\u00eddas do compressor (possivelmente press\u00e3o de descarga e re-circula\u00e7\u00e3o) e poss\u00edvel determinar a quantidade de gas dispon\u00edvel para inje\u00e7ca\u00e3o. Com estas informa\u00e7c\u00e3oes uma tabela de aloca\u00e7c\u00e3ao de gas pode ser obtida para cada poc\u00e7o. Esta tabela relaciona a vaz\u00e3ao otima de inje\u00e7ca\u00e3o para cada press\u00e3ao de suprimento de gas (possivelmente a press\u00e3o a montante do manifold de gas lift).\nOs autores defendem o step rate well test e a utiliza\u00e7\u00e3o da representa\u00e7\u00e3o da rela\u00e7ao Qo x Qi na forma de polin\u00f3mio. Os coeficientes dos fatores polinomiais seriam obtidos por um metodo de ajuste de curva utilizando m\u00ednimos quadrados.\nAssim como em outros artigos os autores ressaltam que as os-cila\u00e7c\u00e3oes devido a opera\u00e7c\u00e3oes em malha aberta atuam no sentido de diminuir a produ\u00e7c\u00e3ao di aria efetiva.\numa grande mudanca na vaz\u00e3o de inje\u00e7\u00e3o sem uma perda significativa de produc\u00e3o. Este resultado pode ser contra intuitivo ja que poderia se imaginar que a quantidade de gas a ser diminu\u00edda deveria ser reduzida do po\u00e7o com menor \u00edndice de produtividade. Concluem que uma inje\u00e7ao de gas feita com o aux\u00edlio de controladores de vaz\u00e3ao fornecendo uma vaz\u00e3ao constante garantem uma melhoria na produ\u00e7\u00e3o ao eliminar as oscila\u00e7\u00e3es devido a flutu-a\u00e7c\u00e3oes na press\u00e3ao de suprimento de gas. Mostram ainda a uti-liza\u00e7ao das medi\u00e7\u00f5es para a detec\u00e7\u00e3o de in\u00edcio de entupimento devido a hidratos. No momento da detec\u00e7\u00e3o, o choke \u00e9 atuado rapidamente para remover o deposito.\nO artigo e um pouco superficial mas \u00e9 importante observar que defendem o controle da vaz\u00e3ao de injec\u00e7\u00e3ao como uma forma de garantir uma produ\u00e7ao mais estavel e maior.\n5.1.5\tTotalFinaElf 2002\nEm [105] o trabalho apresentado por engenheiros da Elf-Congo e TotalFinaElf incluindo P. Letemayer fala das vantagens da apli-ca\u00e7c\u00e3ao de automa\u00e7c\u00e3ao na opera\u00e7c\u00e3ao de poc\u00e7os maduros operando via gas-lift no campo Sendji offshore Congo. Sem fornecer detalhes das solu\u00e7c\u00e3oes adotadas o artigo descreve apenas algumas caracter\u00edsticas da solu\u00e7ao e os objetivos atingidos. Fica clara a preocupa\u00e7\u00e3o com o controle da din\u00e2mica do po\u00e7o e defende-se a atuac\u00e3o simultanea do choke de inje\u00e7ao e de produ\u00e7\u00e3o na estabiliza\u00e7\u00e3o do po\u00e7co. O Algolritmo de Controle e baseado em sequ\u00e2encia sem utilizar calculos.\nA melhoria na produ\u00e7c\u00e3ao foi maior que 1300 bopd comparada com o esperado de 1000 bopd.\nO custo da implementa\u00e7ca\u00e3o do sistema foi de 4 milh\u00e3oes de dolares ou 66 Mil dolares por po\u00e7o. A solu\u00e7\u00e3o de controle \u00e9 do tipo distribu\u00edda para evitar problemas com conex\u00e3o. A solu\u00e7\u00e3o de controle inclui a repartida controlada dos poc\u00e7os. N\u00e3ao fica claro qual o metodo utilizado para aloca\u00e7c\u00e3ao de g as. O \u00e2enfase foi dado na elimi-na\u00e7c\u00e3ao das oscila\u00e7c\u00e3oes que causam diversos problemas operacionais alem da diminui\u00e7\u00e3o da produc\u00e3o efetiva de ate 50% em alguns casos. O artigo n\u00e3ao fala da alocac\u00e7\u00e3ao otima de gas e concentra-se em controlar a din\u00e2amica dos po\u00e7cos inclusive na repartida. Ainda assim os resultados obtidos s\u00e3ao impressionantes. N\u00e3ao mostra o algoritmo de controle utilizado afirmando apenas que atua tanto\nno choke de injec\u00e3o como no choke de produ\u00e7\u00e3o. Fica a impress\u00e3o de que as taxas de inje\u00e7ca\u00e3o de cada po\u00e7co s\u00e3ao selecionadas pelos operadores.\n5.1.6\tDubai Petroleum Company 2006\nEm [106] descreve-se um modelo de otimiza\u00e7\u00e3o para um sistema de produ\u00e7ao offshore Dubai operando com gas-lift pela companhia Dubai Petroleum Company.\nO modelo de otimiza\u00e7\u00e3o contempla todo o sistema: configura\u00e7ao de fundo de po\u00e7co, o sistema de escoamento da produ\u00e7c\u00e3ao, a rede de dutos para alimenta\u00e7c\u00e3ao de gas para inje\u00e7c\u00e3ao, separadores, compressores e bombas.\nA soluc\u00e7\u00e3ao do processo de otimiza\u00e7c\u00e3ao fornece valores recomendados para a taxa de inje\u00e7ca\u00e3o de cada po\u00e7co, press\u00e3ao de separadores, press\u00e3ao de descarga dos compressores e utiliza\u00e7c\u00e3ao de compressores.\nO projeto foi dividido em 3 fases. O sistema n\u00e3ao esta automatizado.\nPrincipais conclus\u00e3oes:\n1\t- Os resultados obtidos no processo de otimizac\u00e7\u00e3ao do sistema indicaram que a realocac\u00e7\u00e3ao de gas de inje\u00e7ca\u00e3o para todos os po\u00e7os a fim de manter estavel a press\u00e3o do manifold de gaslift resulta em menos perda de produ\u00e7c\u00e3ao. O artigo reconhece que o gradiente entre a vaz\u00e3ao de produ\u00e7c\u00e3ao e a taxa de in-jec\u00e3o de gas \u00e9 muito pequeno perto do otimo global (a curva e plana naquela regi\u00e3ao) e isto possibilita uma diminui\u00e7c\u00e3ao consider avel da taxa de inje\u00e7c\u00e3ao de g as com uma perda de produc\u00e3o muito pequena. Quando isto \u00e9 feito para todos os po\u00e7os e poss\u00edvel operar com muito menos gas e com uma perda de produc\u00e7a\u00e3o muito pequena.\n2\t- Devido as diferen\u00e7cas consideraveis de temperatura entre ver\u00e3ao e inverno, a capacidade de compressa\u00e3o varia para a pot\u00e2ncia instalada. No ver\u00e3o ocorre uma falta de gas e o processo de otimiza\u00e7c\u00e3ao da aloca\u00e7c\u00e3ao de g as permitiu trabalhar com os compressores existentes e ate mesmo desligar compressores no inverno.\n3\t- Na fase 1 o campo de Falah obteve um amento de 11% na produ\u00e7ao com uma reduc\u00e3o de 14% na taxa de inje\u00e7\u00e3o\nde g\u00e9s. Na fase 2 outros campos obtiveram melhorias um pouco menos expressivas.\n4\t- Os modelos sao atualizados a cada 3 meses e o processo de otimiza\u00e7\u00e3o permite a criac\u00e3o (offline) de tabelas contemplando diferentes cena\u00e9rios de disponibilidade de g\u00e9as para inje\u00e7\u00e3o.\nNo caso de falta de g\u00e9s j\u00e9 n\u00e3o se utiliza a pol\u00edtica anterior de fechar po\u00e7os. A pol\u00e9tica atual consiste em fazer uma redu\u00e7\u00e3o de 0,5 MMscf/D por po\u00e7o para um grupo de po\u00e7os (20) selecionados pelo algoritmo de otimiza\u00e7ao. Isto fornece uma economia de gas de 10 MMscf/D. Caso a indisponibilidade seja maior do que 10 MMscf/D enta\u00e3o a reduc\u00e7\u00e3ao de 0.5 MMscf/D \u00e9e aplicada a um novo grupo de po\u00e7cos (podem incluir alguns do primeiro grupo). Se a indisponibilidade for maior do que 20 MMscf/D ent\u00e3ao o sistema passa para o terceiro grupo, e assim por diante. Esta\u00e3o sendo feitos esfor\u00e7cos para a implementac\u00e7\u00e3ao de uma solu\u00e7c\u00e3ao de controle do tipo SCADA.\nO Projeto acontece em um sistema n\u00e3ao automatizado e, por isso, estabelece um sistema off-line de otimiza\u00e7\u00e3o. Ainda assim \u00e9 um sistema muito interessante pois leva em conta todos os processos envolvidos como linhas de fluxo, compressores, separadores, po\u00e7os, etc. O modelo \u00e9 atualizado conforme ocorrem modifica\u00e7\u00f5es no sistema e as estrat\u00e9egias s\u00e3ao reavaliadas a cada 3 meses quando se faz a realoca\u00e7c\u00e3ao de g\u00e9as. A grande dificuldade que esta solu\u00e7c\u00e3ao encontrar\u00e9a na pra\u00e9tica ao longo do tempo \u00e9e sua depend\u00e2encia do fator humano. Como os procedimentos na\u00e3o s\u00e3ao automatizados, algumas tarefas podem n\u00e3ao acontecer como se esperava ou na \u00e9epoca em que se esperava que acontecesse. Al\u00e9em disso a realo-cac\u00e7\u00e3ao de g\u00e9as somente a cada 3 meses parece deixar margem para melhoras j\u00e9 que neste per\u00edodo pode ter havido mudan\u00e7as que justificassem atualiza\u00e7c\u00e3oes. E\u00e9 claro que isto depende muito das caracter\u00edsticas dos reservat\u00f3rios e eventualmente pode ser suficiente para este caso mas n\u00e3ao parece ser uma soluc\u00e7\u00e3ao aplic\u00e9avel para todas as situa\u00e7c\u00e3oes. O artigo n\u00e3ao fornece nenhuma informa\u00e7c\u00e3ao sobre os modelos adotados e sobre os algoritmos utilizados.\n5.1.7\tPetrobras 2006\nEm [88] discute-se a visao da Petrobras do Gerenciamento Digital Integrado da Produc\u00e7\u00e3ao. Neste trabalho apresenta-se algumas\na\u00e7c\u00e3oes da Petrobras sobre a automac\u00e7\u00e3ao de poc\u00e7os de petroleo. Com rela\u00e7ao a eleva\u00e7\u00e3o por gaslift cont\u00ednuo os seguintes trabalhos s\u00e3o apresentados:\n\u2014\tDescreve-se uma investiga\u00e7ao sobre a sensibilidade da temperatura medida na cabe\u00e7a de produ\u00e7\u00e3o da plataforma \u00e0 varia\u00e7c\u00e3oes na taxa de produc\u00e7\u00e3ao medida em um separador de teste. O artigo conclui que apesar de comprovar-se a re-lac\u00e3o sua sensibilidade n\u00e3o \u00e9 suficiente para utiliza\u00e7\u00e3o na otimiza\u00e7c\u00e3ao do processo. A correla\u00e7c\u00e3ao da din\u00e2amica das va-riaveis mostra-se interessante para a identificac\u00e3o de regime permanente em testes de produ\u00e7c\u00e3ao.\n\u2014\tapresenta-se o desenvolvimento de uma estrategia de infer\u00eancia da vazao de produc\u00e3o em um escoamento multifasico de po\u00e7os com alto GOR e oleo leve no campo de Urucu. Uma rede neural utiliza medi\u00e7co\u00e3es de temperatura e deltaP em uma estrutura com duas placas de orif\u00edcios e infere a vaz\u00e3o. O fato dos po\u00e7os produzirem com alto GOR e operarem com choke atuado para estabiliza\u00e7\u00e3o justificam a estrategia ja que nenhuma press\u00e3o indesejavel \u00e9 adicionada na pressao de fundo pelo sistema de medi\u00e7ca\u00e3o. As medic\u00e7\u00e3oes inferidas sa\u00e3o utilizadas nos algoritmos de controle do po\u00e7co.\n\u2014\tDescreve-se uma aplica\u00e7ao de controle realizada no campo Riacho da Forquilha pertencente a unidade de negocios Rio Grande do Norte. O sistema e monitorado e operado remotamente, por uma conex\u00e3ao de radio, pelos analistas de po\u00e7cos trabalhando em Natal, 250 km do poco. O sistema de controle consiste de um CLP instalado junto a cabeca do po\u00e7o contendo o algoritmo de otimiza\u00e7ca\u00e3o. A estrategia baseia-se na medi\u00e7c\u00e3ao da press\u00e3ao de fundo como variavel controlada e na utiliza\u00e7c\u00e3ao da press\u00e3ao no revestimento como variavel manipulada. Um PID atua na vaza\u00e3o de inje\u00e7c\u00e3ao controlando a abertura de uma valvula de controle na linha de injec\u00e7\u00e3ao de g as. A metodologia e considerada eficiente para determinar novas taxas de inje\u00e7ca\u00e3o devido a mudan\u00e7cas na produc\u00e7\u00e3ao do po\u00e7o relacionados com GOR, BSW, garantia de escoamento, ou restri\u00e7co\u00e3es externas como instabilidade de compressores. Devido o grande numero de po\u00e7cos neste campo maduro, a atualiza\u00e7c\u00e3ao da taxa de inje\u00e7c\u00e3ao baseada em testes de pro-du\u00e7c\u00e3ao n\u00e3ao garantiria que a mudan\u00e7ca ocorresse no momento adequado (wrong time decision).\nNa sequ\u00eaencia ser\u00e3ao apresentadas duas abordagens para a ope-ra\u00e7c\u00e3ao autom atica de um grupo de po\u00e7cos utilizando eleva\u00e7c\u00e3ao do tipo GLC. Para ambas propostas considera-se instala\u00e7c\u00e3oes com as seguintes caracter\u00edsticas:\n\u2014 Os pocos sao equipados com medicao de pressao de fundo.\n\u2014 Todos os pocos recebem gas para inje\u00e7ao de um mesmo manifold.\n\u2014 Todos os pocos sao equipados com medidores de vazao mas-sica de g as na linha de inje\u00e7c\u00e3ao.\n\u2014 Todos os pocos sao equipados com valvula de controle na linha de inje\u00e7c\u00e3ao de gas.\n\u2014 Todos os pocos podem ter sua producao direcionada para um separador de teste.\n5.2\tUm sistema de Controle autom\u00e1tico com \u00eanfase na otimizac\u00e1o da produ\u00e7\u00e3o\n1 Nesta se\u00e7\u00e3o apresenta-se um algoritmo de controle para a ope-ra\u00e7c\u00e3ao de um grupo de po\u00e7cos equipados com sensores de fundo de po\u00e7o medindo press\u00e3o e temperatura. A medi\u00e7\u00e3o cont\u00ednua da pressa\u00e3o e temperatura de fundo na\u00e3o s\u00e3ao interessantes somente para o controle das operac\u00e7\u00e3oes mas sa\u00e3o informac\u00e7\u00e3oes valiosas para o gerenciamento da recuperac\u00e7a\u00e3o de oleo de todo o campo. Alem disso, cada po\u00e7o e equipado com medi\u00e7ao de vaz\u00e3o de inje\u00e7\u00e3o e um choke de injec\u00e7\u00e3ao com controle automatico. Este e um cenario real\u00edstico no Brasil para os pocos sendo completados atualmente para eleva\u00e7c\u00e3ao por GLC. Um controlador local atuando sobre um choke de inje\u00e7c\u00e3ao determina a vaz\u00e3ao de gas sendo injetada em cada po\u00e7o a partir de um gas lift manifold (GLM) comum conforme mostrado na figura 5.2. O sistema de automac\u00e3o deve operar os po\u00e7cos de forma otima sob condi\u00e7c\u00e3oes de alta disponibilidade de gas enquanto garante a operac\u00e3o estavel durante per\u00edodos de baixa disponibilidade de g as.\n1 Parte deste trabalho foi publicado em [36] e tamb\u00e9m faz parte do projeto de pesquisa Desenvolvimento de Algoritmos de Controle para M\u00e9todos de Eleva\u00e7\u00e3o Artificial realizado em parceria com a Petrobras.\nPo\u00e7o 1\nPo\u00e7o 2\nPo\u00e7o 3\nPo\u00e7o 4\nPo\u00e7o 5\n5.2.1\tObten\u00e7\u00e3o da vaz\u00e3o de g\u00e1s dispon\u00edvel para inje\u00e7\u00e3o nos po\u00e7os\nUma das dificuldades na distribui\u00e7\u00e3o do g\u00e1s procedente do sistema de compress\u00e3o \u00e1 garantir que o mesmo seja utilizado de forma otima enquanto se estabilize a pressao no gas lift mani-fold-GLM. Propoe-se uma estrat\u00e1gia que estabiliza a pressao no GLM e otimiza a distribui\u00e7\u00e3o de g\u00e1s comprimido dispon\u00edvel entre os pocos conforme mostra a figura 5.2. Gas do sistema de compress\u00e3ao entra no GLM a uma pressa\u00e3o igual a press\u00e3ao nominal de descarga do ultimo compressor. Durante operac\u00e3es normais, o sistema de controle do sistema de compress\u00e3ao fornece uma vaz\u00e3ao de g\u00e1as suficiente para manter a pressa\u00e3o no GLM alta o bastante para manter a vaz\u00e3o de inje\u00e7ao de gas sem restri\u00e7\u00e3o para cada po\u00e7o. Se por qualquer motivo a vaz\u00e3o de g\u00e1s entrando no GLM diminui, a press\u00e3ao no GLM ir\u00e1a cair se as vaz\u00e3oes de inje\u00e7ca\u00e3o de g\u00e1as para cada po\u00e7co forem mantidas em seus valores sem restri\u00e7c\u00e3ao. Eventualmente as vaz\u00f5es sem restric\u00e3o n\u00e3o poder\u00e3o ser implementadas mesmo com a abertura total dos chokes de inje\u00e7ao. Torna-se necess\u00e1rio uma estrat\u00e1gia que:\n\u2014\tEstabilize a pressao no GLM em um valor proximo a press\u00e3o de descarga nominal do compressor no caso do evento de uma diminui\u00e7\u00e3o na vazao de inje\u00e7ao entrando no GLM; e\n\u2014\tDetermine a vaz\u00e3o total de gas dispon\u00edvel para injec\u00e3o nos po\u00e7cos conectados ao GLM.\nO gas lift manifold-GLM conecta o subsistema de compress\u00e3o e o subsistema de po\u00e7os: Sua intera\u00e7\u00e3o define a quantidade de g\u00e1s de inje\u00e7ao disponibilizada para os po\u00e7os. Para que os po\u00e7os possam operar nos seus pontos \u00e1timos irrestritos a press\u00e3o no GLM deve exceder a maior press\u00e3o de revestimento dentre todos os pocos como mostrado na figura 5.3. Isto permite uma queda de press\u00e3o na linha conectando o GLM ao anular dos pocos. Assume-se que uma estrat\u00e1gia de controle seja implementada no subsistema de compressa\u00e3o de ga\u00e1s para manter a press\u00e3ao no GLM na regiao verde (operacao normal). Tal estrat\u00e1gia depende da estrutura montada no sistema de produ\u00e7\u00e3o (clientes para o g\u00e1s e prioridades do operador do sistema). Um sistema de controle supervis\u00e1orio monitora a press\u00e3ao no GLM e atualiza seu estado para (1) normal (range verde), (2) normal mas testes n\u00e3o permitidos (range amarelo) e (3) operac\u00e7\u00e3ao com restri\u00e7ca\u00e3o na disponibilidade de ga\u00e1s (range vermelho). Testes n\u00e3ao deveriam ser permitidos na regi\u00e3ao amarela j\u00e1a que existe uma grande possibilidade do sistema entrar na regia\u00e3o de opera\u00e7ca\u00e3o com restric\u00e7\u00e3ao. Apesar da exist\u00eancia do sistema de controle que visa manter a press\u00e3o na regiao verde (opera\u00e7\u00e3o normal) \u00e1 poss\u00edvel que falhas no subsistema de compress\u00e3ao na\u00e3o permitam a implementa\u00e7c\u00e3ao da vaz\u00e3ao de g\u00e1as necessa\u00e1ria para manter todos os po\u00e7cos operando em seus valores de injecao irrestritos. Neste caso a press\u00e3o no GLM iria cair ao ponto de tornar-se imposs\u00e1vel estabelecer uma vaz\u00e3ao de g\u00e1as do GLM ao anular dos po\u00e7cos. Obviamente uma a\u00e7ca\u00e3o tem de ser tomada antes que isso aconte\u00e7ca. A soluc\u00e7\u00e3ao proposta imple-\nLegend\nOpera\u00e7\u00e3o normal\n2 Opera\u00e7\u00e3o normal mas testes n\u00e3o permitidos\nOpera\u00e7\u00e3o com restri\u00e7\u00f5es\nsem restri\u00e7\u00e3o para po\u00e7os 1 :N\nFigura 5.3: Controle da press\u00e3o no Gas Lift Manifold - GLM\nmenta um segundo controlador de pressao do GLM (Controlador\nde Press\u00e3o do GLM-Pocos), PC2 na figura 5.4, que disputa o controle da press\u00e3o do GLM com o subsistema de compress\u00e3o: enquanto o controlador do subsistema de compress\u00e3o, PC1, atua no g\u00f3as entrando no GLM, o segundo controlador, PC2, manipula a vaz\u00e3ao de ga\u00f3s saindo do GLM quando o subsistema de com-pressao falha e a press\u00e3o no GLM cai abaixo da regi\u00e3o verde e assume um valor menor do que o valor de refer\u00e2encia do segundo controlador. O valor de refer\u00e2ncia (Pref) do segundo controlador e alto o suficiente para a opera\u00e7\u00e3o irrestrita dos po\u00e7os mas ligeiramente menor do que a pressa\u00e3o nominal de descarga do subsistema de compressao conforme mostra a figura 5.3.\nA sa\u00f3da do controlador PC2 \u00f3e limitada a um valor igual a soma das vazoes de inje\u00e7\u00e3o \u00f3timas irrestritas de todos os po\u00e7os. Assim, enquanto a press\u00e3o do GLM for maior do que o (Pref) do controlador PC2, a a\u00e7c\u00e3ao de controle deste ser\u00f3a constante e igual a soma das vazo\u00e3es de inje\u00e7c\u00e3ao \u00f3otimas irrestritas de todos os po\u00e7cos. A vaz\u00e3ao calculada pelo controlador PC2 \u00f3e implementada pelos controladores FC1, Fc2, ..., FCn.\nA vaza\u00e3o calculada pelo controlador PC2 \u00f3e informada a cada controlador local da vaza\u00e3o de cada po\u00e7co que disp\u00e3oem de uma tabela de aloca\u00e7c\u00e3ao, look-up table. Esta tabela relaciona a vaz\u00e3ao a ser implementada por cada poc\u00e7o em func\u00e7\u00e3ao da vaz\u00e3ao de sa\u00f3da fornecida pelo controlador PC2. Um algoritmo de otimiza\u00e7ao \u00e9 respons\u00f3vel por gerar as tabelas de aloca\u00e7\u00f5es para cada po\u00e7o calculando offline a vaz\u00e3ao de inje\u00e7c\u00e3ao de g\u00f3as a ser implementada por cada po\u00e7co em func\u00e7\u00e3ao da vaz\u00e3ao de ga\u00f3s dispon\u00f3vel. Cada po\u00e7co possui um valor de injec\u00e7\u00e3ao m\u00f3nimo de forma a evitar a opera\u00e7ca\u00e3o na regia\u00e3o de ciclo limite devido aos fen\u00e2omenos heading ou density wave. Assim, a vaz\u00e3ao total m\u00f3nima a ser implementada corresponde ao somat\u00f3orio da vaza\u00e3o m\u00f3nima de todos os po\u00e7cos. O controlador PC2 implementa uma estrat\u00f3egia anti wind-up.\nEnquanto a press\u00e3ao no GLM for normal, e portanto maior do que (Pref), a sa\u00edda do controlador PC2 cresce e \u00e9 limitada a um valor igual a soma das vaz\u00e3oes de injec\u00e7a\u00e3o \u00f3otimas irrestritas de todos os po\u00e7cos. Esta vaz\u00e3ao \u00f3e implementada atrav\u00f3es da ac\u00e7a\u00e3o dos controladores locais que recebem a a\u00e7ca\u00e3o de controle de PC2 e obt\u00f3em seus valores de referencia atrav\u00e9s de uma tabela de aloca\u00e7\u00e3o. Quando ocorre uma falha no subsistema de compress\u00e3ao que diminui a vaz\u00e3ao de entrada no GLM, a press\u00e3ao come\u00e7ca a cair. Quando a pressao no GLM atinge valores menores do que (Pref) a ac\u00e3o\nPo\u00e7o 1\nPo\u00e7o 2\nPo\u00e7o N\nGLM\nFigura 5.4: Estrategia de controle da press\u00e3ao no GLM\nde controle de PC2 age no sentido de manter a press\u00e3o no valor (Pref). Ao fazer isso a vaz\u00e3o calculada por PC2 se iguala a vaz\u00e3o de entrada. Esta vazao \u00e9 informada a cada controlador local que atraves da tabela de aloca\u00e7c\u00e3ao implementam as vaz\u00e3oes otimas que estabilizam a press\u00e3o no GLM. No momento em que a vaz\u00e3o de gas entrando no GLM cresce a press\u00e3o no GLM tambem cresce e eventualmente ao atingir valores maiores que (Pref) fazem com que a vaz\u00e3ao calculada por PC2 retorne ao valor igual a soma das vaz\u00e3oes de inje\u00e7ca\u00e3o otimas irrestritas de todos os poc\u00e7os.\nA figura 5.2 mostra um gas-lift manifold para a distribui\u00e7\u00e3o de gas a um grupo de pocos operando por Inje\u00e7\u00e3o Cont\u00ednua de Gas. Sup\u00f5e-se que o duto que traz o gas ate o ponto de distribui\u00e7\u00e3o e o duto de distribuic\u00e3o tem o mesmo di\u00eametro\te que\nos elementos entre a valvula de entrada e as valvulas de sa\u00edda conforme indicado pela linha tracejada na figura 5.2. A soma de todos os volumes dentro destes limites v\u00e3ao compor um unico volume, representado na figura 5.5 que sera utilizado na modelagem da dinamica do gas-lift manifold.\nFigura 5.5: Modelo simplificado do gas-lift manifold\nPara a configura\u00e7c\u00e3ao mostrada na figura 5.2 o volume total seria obtido como\n5\nV =\t+ $!L2 +\t$\u00ed+2Li+2).\t(5.7)\ni=1\nDe forma geral para este tipo de configura\u00e7c\u00e3ao, considerando que os dutos de gas para cada po\u00e7o podem ter di\u00f3metros ($p) e comprimentos (Lp) diferentes, ter\u00edamos\nN\nV = J(^1L1 + ^2L2 +\t^P\u00edLp\u00ed)-\t(5.8)\ni=1\nO comportamento da pressa\u00e3o no volume concentrado pode ser descrito aplicando-se a lei da conserva\u00e7c\u00e3ao da massa,\ndP RT\n~di = MV(Qe - Qs)j onde\t(5J)\n\u2014\tP - Pressao, Pa\n\u2014\tR - Constante universal dos gases, 8,3144126 Pam3mol/K\n\u2014\tT - Temperatura, K\n\u2014\tM - Peso molecular do gas, Kg/mol\n\u2014\tV - Volume, m3\n\u2014\tQe - Vaz\u00e3o massica de gas de injecao entrando no volume, Kg/s\n\u2014 Qs - Vaz\u00f5o massica de gas de inje\u00e7\u00f5o saindo do volume, Kg/s.\nDefinindo kp = MV, e aplicando a transformada de Laplace na equa\u00e7c\u00f5ao 5.9, obtem-se\n\u2014 k\nP (s) = \u2014p (Qe(s) \u2014 Qs(s))\t(5.10)\ns\nO controle da press\u00f5o no gas-lift manifold pode ser realizado por uma estrutura de controle do tipo PI (Controle Proporcional Integral). A estrutura de controle deve ter ac\u00e7\u00f5ao anti-windup incorporada ja que em condic\u00e7\u00f5oes normais o controlador operara saturado. Para simplificar a analise da resposta do sistema de controle pode-se desconsiderar a estrutura anti-windup ja que esta fun\u00e7ca\u00f5o e inoperante no momento da restri\u00e7c\u00f5ao na disponibilidade de g as.\nFigura 5.6: Estrutura de controle simplificada da press\u00f5o do gas-lift manifold\nA figura 5.6 mostra a estrutura de controle que sera utilizada para a s\u00edntese do controlador. E interessante mencionar que o principal objetivo de controle e manter a pressa\u00e3o em seu valor de refer\u00e2ncia Pref. diante de perturba\u00e7\u00f5es na vazao de entrada Qe. Diante disso parte-se para a obtenc\u00e7\u00e3ao da func\u00e7\u00e3ao de transfer\u00e2encia em malha fechada entre a variac\u00e3o de pressao na sa\u00edda AP e a varia\u00e7\u00e3o na vaz\u00e3o de injec\u00e3o de entrada AQe. A figura 5.7 mostra a estrutura de controle que ser a utilizada para analise da resposta \u00e0 perturba\u00e7ao. Considera-se o sistema em equil\u00edbrio e analisa-se a resposta \u00e0 uma varia\u00e7\u00e3o na vaz\u00e3o de entrada, AQe.\nFigura 5.7: Estrutura de controle para analise da resposta \u00e0 pertur-ba\u00e7ca\u00e3o\nEscrevendo-se a relac\u00e3o entre AP(s) e AQe(s) obtem-se:\n\u2014-\n(-AP (s)C(s) \u2014 AQe(s))\t= AP (s)\ns\n- -\nAQe(s) - = AP (s)(1 \u2014 C (s) -).\t(5.11)\nss\nPretende-se ajustar os par\u00e2metros K e Ti do controlador PI\nc (s) =\n-K (Tis + 1)\nTis\n(5.12)\nSubstituindo 5.12 em 5.11,\nAP (s) AQe(s) AP (s) AQe(s)\nkpTi s\nTis2 + KkpTis + Kkp \u2019\nkps s2 + Kkps +\n(5.13)\n______kps______5qe\ns2 + Kkps +\ts\n(5.14)\nAplicando-se o Teorema do Valor Final na equac\u00e3o (5.14),\nAP (to)\nAP (to)\nkps\t5qe\nlim s\t,\ns ' s2 + Kkps + Kk s\n0.\n(5.15)\nA perturba\u00e7\u00e3o mais prov\u00e9vel para a vaz\u00e3o de inje\u00e7ao talvez seja do tipo rampa como mostrada na figura 5.8. Este tipo de sinal\nrepresenta uma diminui\u00e7c\u00e3ao da vaz\u00e3ao de entrada de g\u00edas do tipo rampa com uma dura\u00e7ao igual a L numa taxa igual a \u2014. No dom\u00ednio Laplace este tipo de perturba\u00e7\u00e3o pode ser modelado\ncomo\tAQe(s) =\t1 (1 - e-Ls)\t(5.16) L s2\nA aplica\u00e7\u00e3o deste sinal na equac\u00e3o (5.13) fornece a seguinte per-turba\u00e7c\u00e3ao na pressa\u00e3o de sa\u00edda.\nAP (s) = \u25a0\tkps\tKk \u00d4qTe 12 (1\te-LS)\t(5.17) s2 + Kkps + KkP L s2\nA aplicac\u00e3o do Teorema do Valor Final ao sinal expresso pela equac\u00e3o (5.17) tambem resulta em valor igual a zero indicando que este tipo de perturba\u00e7c\u00e3ao tamb\u00edem \u00ede rejeitado em regime permanente.\nPara analisar o efeito na press\u00e3o durante a perturbac\u00e3o do tipo rampa, assume-se um sinal do tipo rampa de durac\u00e3o infinita e\naplica-se o Teorema do valor final,\nkps\t5qe 1\nlim \u2014 s________p___________\u2014___\n- s2 + Kkps +\tL s2\n^P(^) = \u2014 K \u00d4~L\t(5.18)\nA express\u00e3o (5.18) mostra a diminui\u00e7\u00e3o da press\u00e3o durante uma perturbacao do tipo rampa. E importante verificar que o efeito da perturba\u00e7\u00e3o rampa na press\u00e3o de sa\u00edda depende dos par\u00e2metros do controlador K. Ou seja a diminuic\u00e3o da press\u00e3o na sa\u00edda vai ser menor para um tempo de integra\u00e7ao Ti menor e um ganho K maior. Como visto na analise da resposta para regime permanente verifica-se que a perturba\u00e7c\u00e3ao e anulada se o sinal e uma rampa de dura\u00e7c\u00e3ao finita como a figura 5.8.\n5.2.2\tControlador PI com a\u00e7\u00e3o Feed-Forward considerando a din\u00e2mica da v\u00e1lvula\nEm geral uma valvula na\u00e3o responde imediatamente ao comando de abertura. Em alguns casos a modelagem considerando um atraso O na resposta \u00e9 suficiente. Em realidade o que se pretende modelar \u00e9 a rela\u00e7\u00e3o em malha fechada do sistema de controle de vaz\u00e3o que incorpora a din\u00e2mica do choke de inje\u00e7\u00e3o. A equa\u00e7\u00e3o\n(5.19)\tmostra a fun\u00e7ao de transfer\u00e2ncia que sera utilizada para considerar a din\u00e2mica do choke de produc\u00e3o. O comportamento dinamico do ckoke de inje\u00e7\u00e3o foi modelado como um sistema de primeira ordem com um atraso.\ne-0s\nFTMFchokeinj, =-----\u2014\t(5.19)\n&amp;v s \u2014 1\nO estudo da resposta do sistema ao controlador PI mostra que sua aplicac\u00e7\u00e3ao rejeita, em regime permanente, perturba\u00e7co\u00e3es do tipo degrau. Para perturbac\u00e7o\u00e3es do tipo rampa, t\u00e2em-se uma queda de pressa\u00e3o durante a ocorr\u00e2encia da mesma em um valor que depende da taxa da propria rampa e da rela\u00e7ao K do controlador. No momento que a vaz\u00e3ao de entrada se estabiliza a press\u00e3ao volta ao seu valor de refer\u00e2ncia. Se desejarmos evitar uma queda de press\u00e3ao muito grande devemos diminuir o tempo de integra\u00e7c\u00e3ao do controlador, Ti e aumentar seu ganho, K conforme mostra a\nAQ,\nFigura 5.9: Estrutura de controle incluindo din\u00e2mica do choke de in-je\u00e7c\u00e3ao\nequa\u00e7\u00e3o 5.18. Sob o ponto de vista da robustez do sistema isto nao e uma boa op\u00e7ao ja que, havendo erros de modelagem, n\u00e3o se pode diminuir a relacao T demasiado sob pena de instabilizar a resposta do sistema. Uma alternativa \u00e9 a utiliza\u00e7\u00e3o de uma estrutura de controle feed-forward em combinacao com o controle realimentado conforme mostra a figura 5.10.\nFigura 5.10: Estrutura de controle com a\u00e7\u00e3o feed-forward\nProcura-se a aplica\u00e7\u00e3o de uma ac\u00e3o feed-forward FF(s) que aplicada no sinal da vaz\u00e3o de entrada e somada a a\u00e7\u00e3o de controle garanta erro proximo a zero durante a ocorr\u00e2ncia da perturba\u00e7\u00e3o do tipo rampa.\nNa obten\u00e7ca\u00e3o do sinal a ser aplicado procede-se com a determi-na\u00e7ao de (S) em funcao de FF(s). Uma vez obtida a fun\u00e7\u00e3o de transfer\u00e2ncia, obtem-se a expressao para AP(s) supondo uma perturbacao AQe(s) = \u2014\t, isto \u00e9, uma rampa com taxa \u2014 \u00f5.\nFinalmente determina-se a express\u00e3o para FF(s) que pratica-\nmente elimina o erro em regime permanente para a rampa.\n\u2014k e-(0s)\n[-AP (s)C (s) + AQe(s)(FF (s) - 1)] (p\t= AP (s),\ns(av s + 1)\n(5.20)\nC (s) = -K\nTis + 1\ne es (<7V s + 1)\nTis\t\u2019\n,\t\u2022 \u25a0 s ^i - (0 +\t)s = 1 - &amp;T s,\ne\n- AQe(s)(FF(s) - 1)kp(1\tQtS) =\ns\nAP(s)[1 + Kk-(T\u201c +T 1)2(1 - \u00b0Ts)].\t(5.21)\nManipulando-se a equa\u00e7\u00e3o 5.21 obt\u00e9m-se\nAP(s) = -\t-s(FF(s) - 1)(1 - Qts)\t(5 22)\nAQe(s)\t(-T- - TiQt)s2 + (Ti - Qt)s + 1'\t(' )\nAssumindo uma perturbacao do tipo rampa, AQe(s) = -e aplicando na fun\u00e7\u00e3o de transfer\u00eancia expressa na equa\u00e7ao 5.22, tem-se\nKs(FF(s) - 1)(1 - Qts)\t\u00a3\n(-Tf - T\u00edQt)s2 + (Ti - Qt)s + 1 s2 \u2019\nK(FF(s) - 1)(1 - Qts)\t\u00f3\n(TTf- - T\u00edQt)s2 + (Ti - Qt)s + 1 s '\n(5.23)\nAplicando-se o Teorema do valor final a AP(s) fornecido pela equacao 5.23,\nAP (TO) :\tK(FF(s) - 1)(1 - Ots)\t\u00f5 '\t(fTkf - TiOt)s2 + (Ti - Ot)s + 1 s\u2019\nAP (to)\t= Um TK(FF(s) - 1)(1 - \u00b0t\u2019)\t\u00f5, '\t(Kf- - TOt)s2 + (Ti - Ot)s + 1 \u2019\nAP (to)\t= lim K(FF(s) - 1)\u00f5\t(5.24) s^0 K\nDe acordo com a equa\u00e7\u00e3o (5.24) o efeito da perturba\u00e7\u00e3o do tipo rampa na press\u00e3o sera nulo em regime se\nFF(s) \u2014 1\t=\t0 para s = 0, ou\nFF (0)\t=\t1\t(5.25)\nUma fun\u00e7\u00e3o que atende a equa\u00e7ao (5.25) \u00e9\nFF (s) = kdS + 1.\t(5.26)\nas + 1\nA escolha desta fun\u00e7\u00e3o alem de atender o objetivo de eliminar o efeito de uma perturba\u00e7c\u00e3ao do tipo rampa atende a recomenda\u00e7c\u00e3ao classica de filtro feed-forward que e a de buscar inverter o efeito da planta. Ou seja, a vaz\u00e3o de entrada n\u00e3o \u00e9 controlada pela valvula como a vaz\u00e3o de sa\u00edda. A vaz\u00e3o de sa\u00edda calculada pela acao feedforward e implementada pela valvula cuja din\u00e2mica foi modelada por um atraso e uma func\u00e3o de transfer\u00e2ncia de primeira ordem. N\u00e3o se pode inverter a fun\u00e7ao atraso mas pode-se buscar um numerador do filtro feed-forward que cancele em parte o efeito da fun\u00e7c\u00e3ao de transfer\u00e2encia de primeira ordem da valvula. Diante disso o filtro feed-forward proposto \u00e9\nFF (s) =\ts + 1.\t(5.27)\nas + 1\n5.2.3\tS\u00edntese dos par\u00e2metros de um Controlador Robusto com acao FF\nA tecnica utilizada na s\u00edntese dos par\u00e2metros do controlador PI nas se\u00e7c\u00e3oes anteriores \u00e9e em geral considerada agressiva e pode ser justificada para este processo quando a estrutura de controle n\u00e3ao utiliza a\u00e7c\u00e3ao feed-forward. Em realidade na aus\u00e2encia de a\u00e7ca\u00e3o feedforward seria recomenda\u00e9vel buscar um ajuste que de um lado minimize o efeito causado pela perturba\u00e7c\u00e3ao rampa e de outro oferec\u00e7a robustez para erros de modelagem. O efeito da rampa na press\u00e3o \u00e9 igual a K S, onde T e K sao respectivamente o Tempo de integrac\u00e3o e o ganho do controlador e S \u00e9 a taxa da pertur-ba\u00e7c\u00e3ao rampa. Sabe-se que ao buscar um ajuste dos par\u00e2ametros do controlador Ti e K que aumentem a robustez do sistema em malha fechada, a raz\u00e3o ? seria aumentada, aumentando assim o efeito da perturba\u00e7c\u00e3ao na pressa\u00e3o do gas-lift manifold. Contudo no caso de se utilizar a a\u00e7c\u00e3ao feed-forward na soluc\u00e7\u00e3ao de controle, elimina-se a perturba\u00e7c\u00e3ao em regime para uma perturbac\u00e7\u00e3ao do tipo rampa. Neste caso pode-se lanc\u00e7ar ma\u00e3o de t\u00e9ecnicas de ajuste do controlador PID mais conservadoras que garantam uma maior robustez na solu\u00e7c\u00e3ao.\nUma t\u00e9ecnica interessante para o ajuste dos para\u00e2metros do controlador que considera o aspecto de robustez \u00e9e aquela proposta por Sigurd Skogestad, [107]. Neste trabalho demonstra-se uma t\u00e9ecnica de ajuste simples que \u00e9e refinada com considera\u00e7c\u00e3oes sobre robustez. Al\u00e9em disso mostra-se a utiliza\u00e7c\u00e3ao da t\u00e9ecnica para diferentes fun\u00e7c\u00e3oes de transfer\u00e2encia. A planta foi modelada como ~sP (r s+i). De acordo com a t\u00e9cnica proposta em [107] o controlador poderia ser um PID completo (com a\u00e7ao integral) ou um controlador PI no caso em que uv seja pequeno e possa-se representar o sistema como\n,-@s\nG(s)\ng-Qr s\nkp-----, com\ns\n+ \u00a9\u2022\n(5.28)\nComo av esperado e pequeno pois representa a dinamica do controle da vaz\u00e3o pelo choke de inje\u00e7\u00e3o, adota-se a representa\u00e7ao do sistema pela fun\u00e7ao de transferencia da equa\u00e7ao (5.28). Para o sistema assim representado o ajuste recomendado para um con-\ntrolador PI \u00e9 dado pela equa\u00e7\u00e3o (5.29),\n1\nK\nkp(rc + \u00a9y)\u2019 Ti =\t4(tc + \u00a9t ).\n(5.29)\nNa equa\u00e7\u00e3o 5.29 tc representa a constante de tempo desejada para o sistema em malha fechada. O procedimento pode ser ent\u00e3o baseado na proposta de um tempo de estabiliza\u00e7\u00e3o desejado Test. que vai fornecer tc =\t. A partir de um modelo nominal do\nprocesso, (kp) e \u00a9T pode-se buscar o menor valor de que garanta uma determinada margem de ganho e margem de fase para determinadas incertezas nos par\u00e2metros.\n5.2.4\tResultados obtidos com simula\u00e7\u00e3o na s\u00edntese do controlador robusto\nPara analisar a proposta de controle discute-se nesta subse\u00e7c\u00e3ao sua aplica\u00e7ao a um cen\u00e9rio mostrado na figura 5.2 onde 5 po\u00e7os sa\u00e3o alimentados com ga\u00e9s a partir de um gas-lift manifold com as seguintes caracter\u00e9sticas\n\u2014\tVolume equivalente= 1 m3\n\u2014\tVaz\u00e3o nominal de entrada= 33.2 Kg/s\n\u2014\tPressao nominal do gas-lift manifold = 24 MPa\n\u2014\tPeso molecular do gas= 0.028 Kg/mol\n\u2014\tTemperatura do gas= 300 K\nA figura 5.11 mostra o efeito de uma perturba\u00e7\u00e3o rampa na vaz\u00e3o de entrada de ga\u00e9s no manifold sobre a press\u00e3ao no mesmo utilizando a estrutura de controle mostrada na figura 5.2.2. O Controlador PI utilizado tem os par\u00e2metros K = \u20141.1419e \u2014 006 e Ti = 40.68. A simula\u00e7\u00e3o mostra o efeito de uma queda na vazao de injecao a uma taxa de 0.05 Kg/s/s no intervalo de tempo entre 600s e 900s. A queda de press\u00e3ao resultante pode ser calculada pela equac\u00e3o 5.18,\nAP\n\u2014 \u2014\n-T- \u2014 = 1.7816e + 006 Pa, ou\nK L\n250\n$240\nCN 245\nE\n225\n400\n235\n230\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\\ AP=(Ti/K)8/L \\\t=18.16 Kaf/cm2\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n500\n600\n1000\n1100\n700\t800\t900\nTempo [ s ]\n1200\nFigura 5.11: Efeito da perturbac\u00f5o rampa na vazao de entrada sobre a press\u00f5ao do gas-lift manifold\nTempo [ s ]\nFigura 5.12: Efeito da perturbacao rampa na vazao de entrada sobre a pressao do gas-lift manifold utilizando acao feed-forward\nA figura 5.12 mostra a redu\u00e7\u00f5o da variacao da press\u00f5o no gaslift manifold quando utiliza-se ac\u00e7\u00f5ao feed-forward. Utilizou-se o controlador PI com os mesmos parametros e tambem a mesma perturbacao rampa com taxa de 0.05kg/s/s. A ac\u00f5o feed-forward utilizada e a vaza\u00f5o de entrada depois de aplicado o filtro mostrado na equac\u00f5o (5.26). Utilizou-se uv = 2 e a = 0.1. Como ja mencionado, a utiliza\u00e7c\u00f5ao da a\u00e7ca\u00f5o feed-forward permite a utiliza\u00e7c\u00f5ao de um controlador mais robusto \u00e0s incertezas de modelagem en-\nquanto diminui consideravelmente a variac\u00e7a\u00e3o no valor da press\u00e3ao do manifold como pode ser visto na figura 5.12.\nS\u00edntese do controlador robusto\nNos desenvolvimentos a seguir considerou-se os par\u00e2metros do modelo do choke como \u00a9 = 1 e tv = 2. A equacao (5.29) mostra que ao aumentar-se o valor de tc aumenta-se o valor de Tj e diminui-se o valor de K. Isto significa em geral menor ganho do sistema de controle e maior robustez. Considerando que tc e a constante de tempo do sistema em malha fechada, pode-se escrever tc em fun\u00e7ao do tempo de estabiliza\u00e7\u00e3o, tc =\t. Desta\nforma pode-se fazer a analise da robustez do sistema em malha fechada em fun\u00e7\u00e3o do tempo de estabiliza\u00e7ao desejado.\nA s\u00edntese dos par\u00e2metros K e Tj pode ent\u00e3o ser realizada da seguinte forma:\nEncontrar o tempo de estabiliza\u00e7ao que fornece uma margem de ganho igual a MG considerando que existe erros nos par\u00e2metros do modelo que minimizam a margem de ganho do sistema. Observando o modelo completo pode-se perceber que a margem de ganho e minimizada quando todos os para\u00e2metros s\u00e3ao maiores do que o nominal. Ou seja, o caso onde o ganho do sistema kp \u00e9 maior do que o ganho nominal kpN, o atraso \u00e9 maior do que o atraso nominal \u00a9vN e a constante de tempo tv \u00e9 maior do que tvN e a combinac\u00e3o que mais desestabiliza o sistema em malha fechada. Pode-se ent\u00e3o definir um erro maximo esperado para cada par\u00e2metro e buscar o Tempo de estabiliza\u00e7ao que garante uma determinada margem de ganho MG. A partir do Tempo de estabiliza\u00e7ca\u00e3o determinado calcula-se, utilizando-se tambem os par\u00e2metros nominais do processo, kpN, \u00a9vN e tvN os par\u00e2metros do controlador PI, K e Tj.\nProcedimento similar pode ser feito estabelecendo-se um pico de sensibilidade desejado\nMs\n1\n|1 + C(jw)H(jw)\\'\n(5.31)\nA figura 5.13 mostra o conceito utilizado. A ideia \u00e9 garantir uma dist\u00e2ncia segura entre a curva de Nyquist C(jw)H(jw) do ponto \u20141+j0 no caso em que os par\u00e2metros do processo sejam diferentes\ndaqueles considerados no projeto do controlador. Esta dist\u00e2ancia e definida como r na figura 5.13, onde r =\t\u2022\nFigura 5.13: Diagrama de Nyquist mostrando o conceito de pico de sensibilidade\nPercentual de erro dos par\u00e2metros [ % ]\nPercentual de erro dos par\u00e2metros [ % ]\nDiagrama de Nyquist\n0.1\n0\n-0.1\nMG=2\nPercentual de erro dos par\u00e2metros [ % ]\n+\nPonto -1+0j Ponto -0.5 +0j -----Curva para erro=+25% \u2014e\u2014 Curva para erro=+50% \u2014i\u2014 Curva para erro=+75% 0 Curva para erro=+100%\n-0.3\n-0.4\n-0.5\n-1\t-0.8\t-0.6\t-0.4\t-0.2\t0\neixo real\nFigura 5.14: Resultados do projeto do PI Robusto utilizando Margem de Ganho=2\nA figura 5.14 mostra os resultados obtidos com o projeto dos\npar\u00e2metros K e T do controlador PI quando se estabeleceu uma margem de ganho igual a 2 para erros de modelagem de kp, 0v e tv desde 25% ate 100% de seus valores nominais. A ideia \u00e9 mostrar que uma vez determinado o n\u00edvel de incerteza nos valores destes par\u00e2metros, pode-se obter os par\u00e2metros do controlador ainda com uma margem de ganho. Nota-se que na medida que se sup\u00f5e uma incerteza maior, menor e o ganho e maior e o tempo integral necessario para garantir a margem de ganho desejada.\na-Tempo de estabiliza\u00e7\u00e3o x erro\nPercentual de erro dos par\u00e2metros [ % ]\nPercentual de erro dos par\u00e2metros [ % ]\nPercentual de erro dos par\u00e2metros [ % ]\nd-Diagrama de Nyquist\neixo real\nFigura 5.15: Resultados do projeto do PI Robusto utilizando Pico de sensibilidade igual a 3.2\nA figura 5.15 mostra o resultado obtido utilizando um procedimento similar mas baseado no pico de sensibilidade desejado. Para efeito de compararlo estipulou-se um valor de pico de sensibilidade desejado de 3.2 que, para este processo resulta em uma margem de ganho de aproximadamente 2. A utilizacao do pico de sensibilidade pode se mostrar mais interessante do que a margem de ganho pois garante de forma global uma determinada dist\u00e2an-cia do ponto \u2014 1 + 0j. A utilizacao da margem de fase junto com a margem de ganho pode oferecer um criterio semelhante ao do pico de sensibilidade. Deve-se observar que o procedimento desenvolvido n\u00f5ao introduz nenhum conservadorismo ja que a funcca\u00f5o C(jw)H(jw) foi avaliada para a faixa de frequencia de interesse para cada valor de erro nos par\u00e2ametros.\nA figura 5.15-d mostra o Diagrama de Nyquist para cada L = Ci(jw)Hi(jw), onde i \u00e9 o \u00edndice que representa o erro considerado que vai de 25% at\u00e9 100% em passos de 25%. Conforme o valor do erro esperado, o controlador \u00e9 ajustado para manter o valor do pico de sensibilidade desejado.\n5.2.5\tImplementa\u00e7\u00e3o da Proposta para Automa\u00e7\u00e3o de um Grupo de Po\u00e7os\nA figura 5.16 mostra um sistema de controle para um grupo de po\u00e7os operando com eleva\u00e7\u00e3o artificial por gas-lift proposto. Um gas-lift manifold recebe g\u00e9s do sistema de compress\u00e3o e deve distribui-lo para um numero de po\u00e7os de forma a maximizar uma determinada fun\u00e7ao objetivo enquanto estabiliza a press\u00e3o no manifold. Isto deve ser feito tanto no caso em que h\u00e9 disponibilidade para a opera\u00e7\u00e3o no ponto \u00f3timo da curva Pwf = f (Qinj.) de cada po\u00e7co, como tamb\u00e9em nos casos em que ocorram diminui\u00e7c\u00e3oes na vazao de g\u00e9s sendo entregue ao gas-lift manifold. A estrutura de controle mostrada na figura 5.16 \u00e9 uma representa\u00e7\u00e3o em diagrama de blocos do sistema de controle em desenvolvimento. Percebe-se na figura diferentes elementos como\n\u2014\tControlador da Press\u00e3o PC2 no manifold de gas-lift. Este controlador cuja s\u00e9ntese foi discutida na subse\u00e7c\u00e3ao anterior estabiliza a press\u00e3ao no manifold ao calcular a vaza\u00e3o total de sa\u00e9da a ser implementada pelos controladores locais de vaz\u00e3ao de inje\u00e7\u00e3o de cada poco. Sua estrutura final \u00e9 mostrada na figura 5.17.\n\u2014\tControladores locais de vaz\u00e3o de inje\u00e7\u00e3o de cada poco, FC. Estes controladores recebem a tabela de aloca\u00e7ao do Bloco Algoritmo de Otimiza\u00e7\u00e3o sempre que ocorre uma nova ger-ac\u00e7\u00e3ao de tabelas. Recebem tamb\u00e9em constantemente o valor da vazao total dispon\u00e9vel do Controlador da Press\u00e3o no Manifold PC2. Com essas duas informa\u00e7\u00f5es o controlador FC determina o valor da vaz\u00e3ao de inje\u00e7ca\u00e3o a ser implementada (referencia do controlador local).\n\u2014\tBloco Controle Supervis\u00f3rio. Este bloco e responsavel por coordenar a integrac\u00e7a\u00e3o de todos os elementos que participam do sistema de controle. Com base na leitura da press\u00e3ao do manifold de gas-lift, por exemplo, determina se os poc\u00e7os podem entrar em regime de teste ou na\u00e3o. Al\u00e9em disso, baseado\nFigura 5.16: Sistema de Controle de Po\u00e7os alimentados por um manifold comum\nem uma estrategia pre-definida podem sugerir ao operador a realiza\u00e7c\u00e3ao de um teste de po\u00e7co para atualiza\u00e7c\u00e3ao da curva Pwf X Qinj..\n\u2014\tBloco Teste Autom\u00e1tico de Po\u00e7os. Este bloco \u00e9 responsavel por realizar o teste de po\u00e7co quando autorizado pelo terminal do operador. Os testes s\u00e3o realizados de forma a minimizar o tempo de ensaio ao mesmo tempo que garantem a qualidade dos dados conforme sera discutido neste cap\u00edtulo.\n\u2014\tBloco Algoritmo de Otimiza\u00e7\u00e3o. Este bloco \u00e9 responsavel por calcular as tabelas de aloca\u00e7c\u00e3ao de todos os po\u00e7cos sempre que recebe uma nova informa\u00e7c\u00e3ao que impacta a aloca\u00e7c\u00e3ao otima de gas. A principal informa\u00e7\u00e3o \u00e9 uma nova curva Pw f X Qinj. de um determinado poco recebida do bloco Teste Autom\u00e1tico de Pocos. Dependendo da func\u00e3o objetivo selecionada, atualiza\u00e7\u00f5es sobre os custos de compressao, tratamento de agua, valores atuais do oleo e gas produzido poderiam tambem iniciar o calculo de novas tabelas de aloca\u00e7\u00e3o. Neste cap\u00e9tulo discute-se a implementa\u00e7c\u00e3ao deste bloco.\n\u2014\tTerminal do Usu\u00e1rio. Este terminal pode em realidade ser divido em mais de um tipo de forma a atender diferentes objetivos. Um tipo de terminal seria aquele para utiliza\u00e7c\u00e3ao do operador. Este terminal poderia permitir um dialogo de alto n\u00edvel entre o operador e o sistema automatico de controle onde o operador poderia aceitar ou recusar a\u00e7c\u00e3oes propostas pelo sistema. O operador poderia, por exemplo, aceitar ou n\u00e3ao a sugest\u00e3ao do sistema em realizar um novo teste de um po\u00e7co. Poderia ainda aceitar o resultado do teste ou exigir a repeti\u00e7c\u00e3ao parcial ou total do mesmo, aceitar a sugest\u00e3ao do sistema em fazer a repartida de um po\u00e7co que foi fechado, etc. Um outro n\u00e9vel de terminal de usuario poderia permitir a visualiza\u00e7ca\u00e3o das principais variaveis do processo como press\u00e3o no manifold de gas-lift, vaz\u00e3o de injec\u00e3o de gas de cada po\u00e7co, etc. mas sem a possibilidade de interven\u00e7c\u00e3ao do usuario.\nFigura 5.17: Estrutura do Controlador PC2\nIsto \u00e9 poss\u00edvel pois os controladores locais teriam as informa\u00e7\u00f5es necess\u00e1rias para a tomada de decis\u00f5o sobre a vaz\u00f5o \u00e9tima a ser implementada em cada poco ou seja, a vazao total dispon\u00edvel informada pelo controlador local da pressao no manifold e a ultima tabela de aloca\u00e7ao. Desta forma o sistema poderia manter-se operando por um longo tempo sem a necessidade da rede de controle. E claro que \u00e9 o sistema de controle via rede que permite a atualiza\u00e7c\u00f5ao dos modelos e a gerac\u00e7a\u00f5o de novas tabelas de aloca\u00e7ca\u00f5o mas do ponto de vista operacional uma falha de comunicac\u00f5o da rede na\u00f5o impede o funcionamento do sistema.\n5.2.6\tUm estudo de caso para opera\u00e7\u00e3o com restri\u00e7\u00e3o\nEsta subse\u00e7c\u00f5ao descreve a aplica\u00e7c\u00f5ao dos algoritmos de otimiza-\u00e7ca\u00f5o e controle desenvolvidos para um estudo de caso com modelos de po\u00e7cos derivados do simulador de escoamento multif\u00e9asico OLGAmR\nO cen\u00e1rio \u00e9 aquele representado pela figura 5.2 no in\u00edcio desta se\u00e7\u00f5o, onde 8 po\u00e7os recebem gas de um unico GLM (Gas Lift Manifold).\nAlgumas caracter\u00edsticas do cenario simulado s\u00f5o:\n\u2014\tVolume equivalente: 1.0 m3\n\u2014\tPress\u00f5o nominal do GLM: 225.4 Kgf/cm2\n\u2014\tPress\u00f5o de refer\u00eancia do GLM sob restric\u00f5o: 224.4 Kgf/cm2\nO estudo de caso considera somente a restri\u00e7\u00e3o na capacidade de compress\u00e3o do sistema.\nCada poco possui um modelo de regime permanente relacionando sua vaz\u00e3o de inje\u00e7\u00e3o de g\u00e1s com a vaz\u00e3o de oleo produzido.\nA figura 5.18 mostra a alocacao de gas obtida com os modelos e a aplica\u00e7c\u00e3ao do algoritmo de otimizac\u00e7\u00e3ao para todo o range de disponibilidade de g\u00e1as.\nFigura 5.18: Carta de aloca\u00e7\u00e3o de gas-lift\nO objetivo da simula\u00e7ao \u00e9 mostrar o desempenho completo do sistema de automa\u00e7ao e otimiza\u00e7\u00e3o durante uma queda na disponibilidade de gas para inje\u00e7\u00e3o utilizando a estrutura de automa\u00e7\u00e3o mostrada na figura 5.16. Para isso a din\u00e2mica do GLM, dos chokes e dos po\u00e7os foram modelados e implementados.\nA figura 5.19 mostra a vazao de gas para inje\u00e7\u00e3o entrando e saindo do GLM. Como pode ser observado na figura, a estrat\u00e9gia de controle consegue distribuir a vaz\u00e3ao de g\u00e9as saindo do GLM em um valor praticamente igual aquela que entra. A figura 5.20 mostra a press\u00e3ao no GLM.\nFigura 5.19: Vaz\u00e3o m\u00e1ssica de g\u00e1s entrando e saindo do GLM.\nh\u00e1 praticamente nenhuma variac\u00e3o na pressao do GLM para as diferentes disponibilidades de vazao de g\u00e1s entrando no GLM.\nA fim de mostrar a vantagem na utiliza\u00e7\u00e3o da a\u00e7ao Feed-Forward no controle da press\u00e3o do GLM, a figura 5.21 mostra a press\u00e3o no GLM quando utiliza-se o controlador sem a\u00e7\u00e3o Feed Forward.\nConforme discutido anteriormente, variac\u00f5es na vaz\u00e3o de entrada do GLM do tipo rampa podem causar grandes varia\u00e7c\u00e3oes na press\u00e3ao do GLM com amplitudes dependentes dos par\u00e2metros do controlador e da taxa de variac\u00e3o da rampa. E muito importante manter a pressao no GLM t\u00e3o perto quanto poss\u00edvel do seu valor de refer\u00eancia durante as opera\u00e7\u00f5es com restri\u00e7\u00e3o na disponibilidade de g\u00e1as a fim de n\u00e3ao permitir o acionamento do controlador utilizado para opera\u00e7c\u00e3ao normal. A id\u00e1eia \u00e1e manter a press\u00e3ao no GLM em um valor ligeiramente menor do que o normal durante as opera\u00e7c\u00e3oes com restri\u00e7c\u00e3ao de forma que o subsistema compressor continuara\u00e1 tentando aumentar a vaz\u00e3ao de g\u00e1as entregue ao GLM a fim de recuperar o controle da press\u00e3ao para o valor normal. Assim que o subsistema compressor entregue uma vaz\u00e3ao maior do que a vaza\u00e3o de saturac\u00e3o do controlador PC2, a press\u00e3o no GLM crescer\u00e1 e ser\u00e1 mantida no seu valor normal. Isto pode ser observado nas figuras 5.20 e 5.19. A sequencia de eventos simulada no estudo de caso acontece conforme abaixo. O sistema esta operando normalmente com o GLM na pressao normal de 225.4 Kgf/cm2.\nFigura 5.20: Press\u00e3o no GLM com controle utilizando a\u00e7\u00e3o Feed Forward\nUma hora mais tarde acontece uma diminui\u00e7\u00e3o da vaz\u00e3o de entrada no GLM tipo rampa. O controlador PC2 reage e calcula a vaz\u00e3o a ser implementada (vaz\u00e3o de gas dispon\u00edvel) para manter a pressao no GLM em sua nova refer\u00eancia de 224.4 Kgf/cm2. A vaza\u00e3o calculada pelo controlador PC2 e passada para os controladores locais de cada po\u00e7o que possuem uma tabela de alocac\u00e3o pre calculada e apresentada na figura 5.18. A ac\u00e3o simultanea dos controladores locais de cada po\u00e7co implementam a vaz\u00e3ao calculada que estabiliza a pressao no GLM e maximiza a produc\u00e3o de oleo para aquela disponibilidade de vaz\u00e3o de gas. Sete horas e um quarto mais tarde o subsistema compressor consegue entregar a vaz\u00e3ao de entrada no GLM elevando sua press\u00e3ao para o valor normal.\nA figura 5.22 mostra o comportamento da press\u00e3o de fundo de todos os po\u00e7os conforme a vaz\u00e3o de gas de inje\u00e7\u00e3o varia durante o estudo de caso. As presso\u00e3es sobem conforme o esperado durante as operac\u00e7\u00e3oes com restri\u00e7c\u00e3ao na disponibilidade de gas para inje\u00e7c\u00e3ao. A figura 5.23 mostra a porcentagem do total de gas dispon\u00edvel utilizado por cada po\u00e7o e a figura 5.24 mostra a vaz\u00e3o de oleo produzida por cada po\u00e7co durante a operac\u00e7\u00e3ao com restric\u00e7\u00e3ao.\nO comportamento din\u00eaamico da vaz\u00e3ao de oleo apresentada na\nFigura 5.21: Press\u00e3o no GLM com controle nao utilizando a\u00e7\u00e3o Feed Forward.\nfigura 5.24 \u00e9 uma aproxima\u00e7ao do que acontece na frente dos canhoneados. Os valores em regime permanente s\u00e3o mais representativos.\nFigura 5.22: Pwf de todos os pocos\nFigura 5.23: Porcentagem de gas utilizada por cada po\u00e7o\n\t\t\t\t\t\t\t\tPo\u00e7o 1\t \t\tPo\u00e7o 2 \t\tPo\u00e7o 3 Po\u00e7o 4 \tPo\u00e7o 5 \u25a0\t Po\u00e7o 6 \t\tPo\u00e7o 7 \tPo\u00e7o 8\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t-\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\nTempo [ h ]\n1800\nFigura 5.24: Produ\u00e7ao de \u00f3leo por po\u00e7o\n5.3\tUm sistema de Controle autom\u00e1tico utilizando a t\u00e9cnica de controle preditivo baseado em modelo PNMPC\nNa se\u00e7\u00e3o 5.2 apresentou-se uma t\u00e9cnica para a automa\u00e7\u00e3o de um grupo de pocos operando com eleva\u00e7\u00e3o por GLC com o objetivo de garantir a distribui\u00e7\u00e3o otima de gas dentre os po\u00e7os. Nenhuma a\u00e7\u00e3o de controle foi projetada para agir no sentido de modificar o comportamento din\u00e2mico dos pocos. O algoritmo de otimiza\u00e7ao garante que a vaz\u00e3o m\u00ednima implementada em cada po\u00e7o seja superior ao valor que leva o po\u00e7o ao comportamento com oscila\u00e7\u00e3es sustentadas t\u00edpicos dos fen\u00e2menos heading ou density-wave. As motiva\u00e7\u00e3es para este tipo de solu\u00e7\u00e3o s\u00e3o diversas:\n\u2014\tA grande maioria dos po\u00e7os operando via GLC nao dispoem de choke de produ\u00e7\u00e3o com atuacao automatica dificultando a aplica\u00e7c\u00e3ao de tecnicas de controle avan\u00e7cadas.\n\u2014\tA opera\u00e7ao de pocos com baixa vazao de injec\u00e3o acarreta em significativas perdas de produ\u00e7\u00e3o e por isso, a maioria das instala\u00e7c\u00e3oes est\u00e3ao bem equipadas com compressores reserva para evitar essas situa\u00e7c\u00e3oes.\n\u2014\tExistem sistemas de superf\u00edcie preparados para mitigar os efeitos das oscilac\u00e7\u00e3oes causadas por eventual diminui\u00e7c\u00e3ao na vaz\u00e3o de injecao de gas como os slug-catcher, por exemplo.\n\u2014\tA utiliza\u00e7ao de valvulas do tipo Venturi praticamente eliminam a ocorr\u00eancia do fen\u00e2meno heading. Por outro lado o fen\u00e2meno density-wave n\u00e3o ocorre para pocos surgentes e acontece para vaz\u00e3oes de inje\u00e7c\u00e3ao muito baixas para po\u00e7cos operando em reservat\u00f3rios com baixo n\u00edvel de deple\u00e7ao conforme mostrado no cap\u00edtulo 2.2. A utiliza\u00e7\u00e3o de sistemas de recupera\u00e7c\u00e3ao via injec\u00e7\u00e3ao de agua em poc\u00e7os injetores contribui para a manuten\u00e7c\u00e3ao da press\u00e3ao de fundo dos po\u00e7cos.\nFigura 5.25: Gas-lift manifold-GLM\na press\u00e3o no GLM. A maior parte desta trabalho foi apresentada em [44] e [54].\n5.3.1\tA formula\u00e7ao NMPC\nComo ja mencionado, considera-se um conjunto de N po\u00e7os operando via GLC com medi\u00e7\u00e3o de press\u00e3o de fundo e equipados com medi\u00e7ao e controle via choke da vaz\u00e3o de inje\u00e7\u00e3o de gas. Todos os poc\u00e7os recebem gas de um GLM comum que nesta proposta de controle possui, alem das sa\u00eddas para todos os pocos, uma sa\u00edda extra para o queimador ou para recirculac\u00e3o conforme a instalac\u00e3o. Esta sa\u00e1da \u00e9 um mecanismo que permite ao gas ser descarregado em casos onde a vaz\u00e3ao de gas entrando no GLM e maior do que o necess ario para operar os po\u00e7cos em seus pontos otimos irrestritos.A vaz\u00e3o dessa sa\u00edda sera referida como a vaz\u00e3o de excesso.\nPara tal sistema mostrado na figura 5.25 desejamos\n\u2014\tmanter a press\u00e3o no GLM proximo ao seu valor de refer\u00eancia projetado de acordo com as necessidades dos po\u00e7cos,\n\u2014\tdistribuir a vaz\u00e3o de gas disponibilizada pelo subsistema compressor entre os po\u00e7cos de forma a maximizar um objetivo econ\u00eaomico e\n\u2014\tminimizar as oscila\u00e7\u00f5es na produ\u00e7\u00e3o causadas pelas mudan\u00e7as nas vaz\u00f5es de inje\u00e7\u00e3o de g\u00e1s. Essas oscila\u00e7\u00f5es causam problemas aos processos de separac\u00e3o.\nAlgumas restri\u00e7\u00f5es devem ser consideradas.\n\u2014\tManter a vazao de injecao de g\u00e1s de cada poco maior do que um valor m\u00ednimo.\n\u2014\tManter a press\u00e3o no GLM entre um limite inferior e superior.\nA tabela 5.1 apresenta a nomenclatura utilizada.\n5.3.2\tA fun\u00e7\u00e3o custo para o algoritmo PNMPC\nA formula\u00e7\u00e3o da fun\u00e7\u00e3o objetivo a ser utilizada no algoritmo MPC N\u00e3o Linear deve ser tal que sua minimiza\u00e7\u00e3o forne\u00e7a os objetivos propostos. Os objetivos sao o econ\u00f4mico e o de comportamento din\u00e2mico desejado.\nExistem diversos objetivos econ\u00f4micos que podem ser introduzidos como aqueles que consideram o valor diferenciado da pro-du\u00e7c\u00e3ao de \u00e1oleo e g\u00e1as e o custo do tratamento da a\u00e1gua produzida. Neste trabalho utiliza-se o objetivo econ\u00f4mico que considera o ganho devido a producao de \u00e1leo e o custo de compress\u00e3o de g\u00e1s para inje\u00e7ao. Para isso define-se a fun\u00e7\u00e3o custo econ\u00f4mico\nl = s\u00a3x [Po\t- qAqini)) + Cc<inj],\t(5.32)\nonde\n\u2014\tN \u00e1 o numero total de pocos,\n\u2014\tPo \u00e9 o preco do \u00e1leo,\n\u2014\tCc \u00e1 o custo de compress\u00e3o de g\u00e1s.\nAs vazoes de inje\u00e7\u00e3o q*nj que minimizam o custo L, no caso de n\u00e3ao haver restri\u00e7c\u00e3ao na disponibilidade de g\u00e1as, podem ser obtidas calculando-se\n\" dL \u25a0 dq1 \u25a0 dLn\t\t1 \u2022 \u2022 O O \t1\ndL\t\t0\ndqN \u25a0\t\t\nTabela 5.1: Nomenclatura\nSimb.\tDescri\u00e7\u00e3o da vari\u00e9vel\tUnidade\nqo1\tVaza\u00e3o de o\u00edleo do po\u00e7co i\tstdm3 .d-1\nqliq1\tVaz\u00e3ao de l\u00edquido do po\u00e7co i\tstdm3 .d-1\nqwl\tVaz\u00e3ao de a\u00edgua do po\u00e7co i\tstdm3 .d-1\nqg1\tVaza\u00e3o de g\u00edas do po\u00e7co i\tstdm3 .d-1\npWf\tPress\u00e3ao de fundo do po\u00e7co do po\u00e7co i\tkgf.cm-2\np\tPress\u00e3ao m\u00ededia do reservato\u00edrio\tkgf.cm-2\nPSat\tPressa\u00e3o de saturac\u00e7a\u00e3o do o\u00edleo do poc\u00e7o i\tkgf.cm-2\nqlSat\tVazao de l\u00edquido do po\u00e7o i para pWf = p'lsat\tstdm3 .d-1\nar \u00ed maa\tVaz\u00e3o maxima de l\u00edquido do po\u00e7o i (pwf = 0)\tstdm3 .d-1\nqomax\tVaz\u00e3ao m\u00edaxima de \u00edoleo do po\u00e7co i\tstdm3 .d-1\nqi - Vmi\tVaz\u00e3ao de inje\u00e7ca\u00e3o de g\u00edas do po\u00e7co i\tstdm3 .d-1\nQeqe\tVazao de excesso do GLM (queim. or recirc.)\tstdm3 .d-1\nPGLM\tPressao no GLM-Gas Lift Manifold\tkgf.cm-2\nsp pGLM\tPress\u00e3o de refer\u00eancia do GLM\tkgf.cm-2\nPuP\tValor de pwf utilizado na normalizac\u00e7\u00e3ao po\u00e7co i\tkgf.cm-2\n'iznj\tValor de qinj para pWf = pWf\tstdm3 .d-1\n...out qGLM\tVaza\u00e3o ma\u00edssica de ga\u00eds saindo do GLM\tkgs-1\nqGLM\tVaza\u00e3o m\u00edassica de ga\u00eds entrando no GLM\tkgs-1\nqGLM\tSomat\u00e9rio de q^ de todos o pocos\tkgs-1\nw\tValor predito da vari\u00e9vel w\nS\u00e9mb.. Constante\tUnidade\nV\tVolume equivalente do GLM\t3 m\nR\tContante Universal dos gases , 8.314472\tPa.m3 / Kmol\nM\tPeso molecular do ga\u00eds\tkg.mol-1\nBSW\tSaturac\u00e7a\u00e3o de a\u00edgua\t-\nGOR\tRaz\u00e3o G\u00e9s-\u00e9leo\t-\nIsto resulta em\n1- dqo^\u00c7qlnj) -1\t\ti oK\u00fcK \u2022\u2022 1\t\nd qinj \u25a0 n\tq)\t\t\n\t\t\ndqoN (qN)\t\tCc L Po\tJ\nd\u00d4iNj\t\t\nque \u00e9 o mesmo resultado obtido pelo m\u00e9todo equal-slope. O conjunto de vazoes implementadas \u00e9 tal que qualquer ganho econ\u00f4mico com um aumento da vazao de inje\u00e7\u00e3o de g\u00e9s em qualquer poco e superado pelo custo de compress\u00e3o de g\u00e9s. Para o caso sem restric\u00e7\u00e3ao na disponibilidade de g\u00e9as isto equivale a operar todos os po\u00e7os no ponto da curva qo\u00ae = f (qlinj) onde a inclinacao seja igual a raz\u00e3o entre o Custo de Compressao por unidade de vaz\u00e3o de gas e o preco por vazao de \u00f3leo, C. No caso de haver restri-c\u00e7\u00e3ao na disponibilidade de g\u00e9as para inje\u00e7c\u00e3ao o problema pode ser escrito como\nmin\tL\nq2 .\t... qN. 1\ninj\tin. J\n[ qinj\ns. a\nL = S^[(qoLx - qoi (qinj )) + kqinj]\nk C\nk = po\np o\nyN qi &lt;qdisp\npii= 1 inj\tinj\n(5.35)\nA solu\u00e7\u00e3o do problema expresso pela equa\u00e7\u00e3o 5.35 pode ser obtida reescrevendo-se o problema utilizando-se o multiplicador de Lagrange A para inserir a restri\u00e7\u00e3o na equac\u00e3o.\nqi1\ns.\nL\nmin\tL\nq2\tqN A l\nqinj ' ' ' qinj A\ninj\na\n= S\u00a31 [\t- qopq\u00ednj)) + kq*nj + A\n= r\nPo\n(5.36)\nk\nDevido a natureza convexa do problema a solu\u00e7\u00e3o \u00f3tima global\npode ser obtida calculando o vetor [ q1 \u2022 q2nj \u2022 \u2022 \u2022 q^ A ] que satisfaz\n- dL\t-\t\t\ndqi \u25a0\t\t0\ndL\t\t0\ndq^dj\t\t\ndL\t\t0\ndqN \u25a0 dL\t\t0\n- dX .\t\t\nAplicando-se 5.37 em 5.36 obt\u00e9m-se\ndq\u00b01(q1\u201ej)\n\u00d4qinj\ndqo^qijnj) dq2nj\ndqoN (qNj) dqn\ndL\ndA\nk + A\nyN qi _ qdisP = 0 ^i=H inj \"inj\tv\n(5.38)\nk + A\nk + A\nA equac\u00e3o 5.38 representa o m\u00e9todo equal slope com restri\u00e7\u00e3o na disponibilidade de gas. Na sequ\u00eancia define-se os elementos necess\u00e1rios para a formula\u00e7\u00e3o da fun\u00e7ao objetivo econ\u00f4mica a ser utilizada no algoritmo de controle preditivo PNMPC. Como a fun\u00e7\u00e3o objetivo ser\u00e9 minimizada ao longo do horizonte de predi\u00e7\u00e3o para as vaz\u00e3oes de \u00e9oleo que s\u00e3ao fun\u00e7c\u00e3ao da press\u00e3ao de fundo e das vaz\u00e3oes de injec\u00e7\u00e3ao ao longo do horizonte de controle h\u00e9a a necessidade de se compensar os diferentes intervalos de tempo preditos. Al\u00e9em disso as predic\u00e7\u00e3oes s\u00e3ao realizadas em fun\u00e7c\u00e3ao dos incrementos de vaz\u00e3o de inje\u00e7ao Aqi \u2022 para cada poco. Define-se o vetor com os incrementos de vazao de injec\u00e3o de cada poco i, AQi- como\nAQexc \u2014 [\t^qexc(k + 1) ' ' ' ^qexc(k + m 1)\t.\n(5.40)\nO vetor com todos os incrementos de vaz\u00e3o saindo do GLM e escrito como\nAQG\u201eLM = [ AQ. )t (AQ2\u201ej )T ... (AQNj )T\tAQ ]T.\n(5.41)\nA perda de faturamento devido a opera\u00e7\u00e3o abaixo da vaz\u00e3o \u00f3tima pode ser escrita como\nLp = PoSN=1Sp=1 (qomax - q\u00b0i(q'inj)(k + 3)) Ts.\t(5.42)\nJa a perda de faturamento devido o custo de compress\u00e3o pode ser expresso como\nLc =\t(qtnj (k + 3)) Ts.\t(5.43)\nO problema da otimizac\u00e3o da produ\u00e7ao pode ser colocado na func\u00e3o objetivo do algoritmo PNMPC como\nmin\tL1\t(5.44)\n[ A<. )T (Aq2\u201e3- )T \u2022\u2022\u2022 (AQiAj )T (AQexc)T f\ns. a\nL1 = S\"1 [S\u2019_,\t- W^\u00edni)(k + j)) T.\n+ PP \"\t(\u00abinj (k + 3)) T.\nO fator m compensa o fato de que a perda de producao acumulada e calculada no intervalo de tempo pT. enquanto que o custo da compressao de gas \u00e9 calculada no intervalo de tempo mTs .\nPara implementar a func\u00e3o custo na forma matricial define-se para cada poco i a perda de producao qoL,\n\u00aboL = q^max - \u00abO^PWf )>\t(5.45)\nonde qol(pwf)) \u00e9 a vaz\u00e3o de oleo calculada em fun\u00e7\u00e3o do valor predito de pWf. Com o intuito de escrever a fun\u00e7ao custo na forma\nmatricial monta-se o vetor com as perdas de produ\u00e7\u00e3o de todos os i po\u00e7os no horizonte de predi\u00e7\u00e3o p.\nQ\u00b0l = [ qoL(1) \u2022\u2022\u2022 \u00ab\u00b0l(p) \u2022\u2022\u2022 q\u00b0L(i) \u2022\u2022\u2022 q\u00b0L(p) ]T\n(5.46)\nA fim de minimizar as oscila\u00e7\u00e3es nas vaz\u00e3es de produc\u00e3o coloca-se na func\u00e3o objetivo um termo igual ao somat\u00f3rio do quadrado da derivada das perdas de produ\u00e7\u00e3o de todos os po\u00e7os ao longo do horizonte de predic\u00e7\u00e3ao.\nl=. y\ni= 1 j =\ndt\n(5.47)\nA derivada da vaz\u00e3ao de todos os po\u00e7cos ao longo do horizonte de predi\u00e7c\u00e3ao pode ser obtida de forma matricial utilizando a matriz T equivalente ao operador A = 1 \u2014 z- A Em sua forma original a matriz Toeplitz equivalente ao operador A = 1 \u2014 z-1 \u00f3 escrita\ncomo\n\t1 -1\t0 1\t0 0\t0 0\t...\t0 ...\t0\nD =\t\t\t\t\t... 0\n\t0\t0\t0\t\t-1 1\n(5.48)\nA utiliza\u00e7ca\u00e3o dessa matriz pressup\u00e3oe que o elemento que antecede o vetor ao qual ela seria aplicada tem valor nulo. Para a utilizac\u00e3o pretendida neste trabalho \u00f3 mais natural supor que no final do horizonte de predi\u00e7c\u00e3ao a derivada da perda de produ\u00e7c\u00e3ao sera muito pequena. Assim, utiliza-se uma matriz Toeplitz modificada, T que considera a u\u00f3ltima derivada nula.\n\t-1 0\t1 -1\t0 1\t0 0\t...\t0 ...\t0\nT =\t\t\t\t\t... 0\n\t0\t0\t0\t\t00\n(5.49)\nFinalmente pode-se apresentar o problema de otimiza\u00e7ao a ser\nresolvido pelo algoritmo PNMPC,\nmin\tJ (5.50)\n[\t)T (AQ?\u201ej )T ... (AQ^j )T (AQexc)T ]T\ns. a\nJ = WiQ\u00d5l + W2QG\u00cdm +\n(PGlm - PGLM)TW3(PGlm - PGLM)\n+ (tqgl)t W4 (tqg^ + (AQGLm )t W5AQG\u201cLm ,\nQout\tmin\nGLM > QGLM\nPD max\nGLM S P GLM P~\tD min\nGLM > P GLM\nOs primeiros dois termos da fun\u00e7ao custo implementam o objetivo econ\u00f4mico, o terceiro termo forca a press\u00e3o no GLM para seu valor de referencia, o quarto termo minimiza as oscilacoes na perda de produ\u00e7\u00e3o o que tem o mesmo efeito que minimizar as varia\u00e7\u00e3es na produ\u00e7ao de \u00f3leo. O quinto termo minimiza as mudan\u00e7as nas vazoes de injec\u00e3o dos po\u00e7os e da linha de excesso. Os vetores Wi e W2 podem ser ajustados para implementar o objetivo econ\u00f4omico e ponderar os custos de compressa\u00e3o e faturamento com a produ\u00e7ao de oleo. As matrizes W3, W4 e W5 devem ser ajustadas para a obten\u00e7ca\u00e3o do comportamento din\u00f4amico desejado frente ao objetivo principal que \u00f3e o econ\u00f4omico.\nObviamente que uma pondera\u00e7c\u00e3ao excessiva nestas matrizes pode resultar em um resultado econ\u00f4omico pior durante o comportamento transiente no momento de uma restric\u00e7\u00e3ao na disponibilidade de g\u00f3as para compress\u00e3ao. Mas, quando bem ajustadas, pode-se obter um comportamento din\u00f4amico mais suave das vaz\u00e3oes de \u00f3oleo e uma produ\u00e7ca\u00e3o igual ou maior do que a que seria obtida sem a aplicac\u00e3o de controle. Deve-se observar que em regime permanente os termos 3, 4 e 5 v\u00e3o a zero e atinge-se o resultado econ\u00f4omico de regime permanente.\nN\u00e3o se aplicou restri\u00e7\u00f5es nos valores m\u00e1ximos das vaz\u00f5es saindo do GLM mas poderia ser feito sem dificuldades. As vaz\u00f5es de injecao nos po\u00e7os poderiam ser limitadas a um valor ligeiramente maior do que a vaz\u00e3o que induz a maior produ\u00e7\u00e3o de oleo. Isto seria uma garantia a mais que nao se operaria de forma muito ineficiente no caso de alguma falha e deixaria uma margem para utiliza\u00e7c\u00e3ao no controle das oscila\u00e7c\u00e3oes.\nAplica-se tambem restri\u00e7\u00e3o na press\u00e3o do GLM. Apesar do algoritmo de controle ser normalmente capaz de manter a press\u00e3ao no GLM muito proxima do valor de refer\u00eancia, optou-se por introduzir uma restri\u00e7ao em seu valor m\u00ednimo e maximo correspondendo a uma faixa de 5 % para baixo e para cima respectivamente do valor de refer\u00eaencia. A press\u00e3ao no GLM e vital para que se possa realizar as vazo\u00e3es de inje\u00e7ca\u00e3o.\nO modelo utilizado para predi\u00e7ao da press\u00e3o de fundo utilizado \u00e9 descrito no cap\u00edtulo 2.2, se\u00e7\u00e3o 2.2.3. Este modelo fornece uma re-la\u00e7c\u00e3ao press\u00e3ao de fundo-vaza\u00e3o de inje\u00e7ca\u00e3o em regime permanente de alta qualidade. Este modelo de regime permanente foi utilizado em uma representa\u00e7\u00e3o Hammerstein modificada onde o comportamento din\u00eamico \u00e9 dependente da vaz\u00e3o de inje\u00e7ao. Para a press\u00e3o no GLM utilizou-se o modelo apresentado no cap\u00edtulo 2.2, se\u00e7ao\n2.2.2.\n5.3.3\tSintonia do algoritmo PNMPC\nPara testar a aplica\u00e7ao do algoritmo PNMPC no controle de um grupo de po\u00e7os, um total de 4 pocos foram modelados. Esses po\u00e7cos foram primeiramente modelados e simulados em um software da Petrobras desenvolvidos para a simula\u00e7\u00e3o de pocos operando via GLC em regime permanente. Os dados obtidos com este simulador foram utilizados para ajustar a rela\u00e7ao pwf x qinj em regime permanente descrita no cap\u00edtulo 2.2, se\u00e7\u00e3o 2.2.2. Os pa-r\u00eaametros que definem o comportamento em regime permanente dos pocos sao descritos na tabela 5.2. Em seguida um modelo din\u00eaamico hipotetico foi acrescentado a cada po\u00e7co na formula\u00e7c\u00e3ao Hammerstein descrita no cap\u00edtulo 2.2, se\u00e7\u00e3o 2.2.3.\nUma forma de sintonizar os par\u00e2metros da func\u00e3o objetivo do algoritmo PNMPC e iniciar com as pondera\u00e7co\u00e3es para os dois primeiros termos que representam o objetivo econ\u00eaomico. Em seguida as ponderac\u00e7\u00e3oes dos demais termos sa\u00e3o ajustadas para\nTabela 5.2: Dados dos po\u00e7os\t\t\t\t\nPar\u00e2ametro\tPoc\u00e7o 1\tPoc\u00e7o 2\tPo\u00e7co 3\tPo\u00e7co 4\nqmax[ m ]\t871.38\t7.739e+003\t5.177e+003\t1.558e+003\nBSW\t0.341\t0.676\t0.03\t0.488\nP*wf [kgf/cm2 ]\t110.0\t185.1\t182.9\t146.5\nq*inj [mi/d]\t8.33e+4\t1.859e+5\t2.661e+5\t9.98e+4\nP [kgf/cm2]\t203.7\t199\t217.2\t205\nai\t.9038\t0.067\t0.4003\t0.3885\na2\t3.5039\t8.0042\t0.6133\t5.8235\na3\t0.9666\t0.9972\t0.7751\t0.9972\na4\t0.0075\t0.0026\t0.0082\t0.0052\nm\t0.56\t1.11\t0.09\t1.04\nbalan\u00e7car os obj etivos atenuac\u00e7\u00e3ao de oscila\u00e7c\u00e3oes contra o objetivo econ\u00f4mico. Os par\u00e2metros de sintonia utilizados s\u00e3o mostrados na tabela 5.3.\nControlar o sistema composto pelo GLM e pocos tem uma grande vantagem de eliminar a restri\u00e7c\u00e3ao na disponibilidade de ga\u00e1s do problema de aloca\u00e7\u00e3o ja que todo o g\u00e1s distribu\u00e1do \u00e1 aquele que mant\u00e1m a press\u00e3o no GLM em equil\u00edbrio e portanto \u00e9 a vaz\u00e3o dispon\u00e1vel a cada momento. Muitos estudos sobre a otimiza\u00e7ca\u00e3o de po\u00e7cos operando por GLC consideram a a disponibilidade de g\u00e1s como uma restri\u00e7\u00e3o mas n\u00e3o indicam como esta informa\u00e7\u00e3o seria disponibilizada. Uma outra vantagem desta tecnica \u00e9 a possibilidade de aplicar otimiza\u00e7ca\u00e3o mesmo durante os transientes que podem ser mais ou menos frequentes dependendo das instala\u00e7c\u00e3oes e caracter\u00e1sticas dos pocos. O comportamento dinamico da press\u00e3o no GLM \u00e1e altamente dependente do volume interno dos dutos associados e \u00e1e normalmente mais ra\u00e1pido do que as press\u00e3oes de fundo dos pocos. No caso de utilizar-se um tempo de amostragem unico para todas as vari\u00e1veis h\u00e1 de se considerar a dinamica da press\u00e3o no GLM para a escolha. Para evitar horizontes de predi\u00e7ao muito grandes para a vari\u00e1vel qoL decidiu-se montar o vetor de predi-c\u00e7\u00e3oes com valores a cada 3 instantes de amostragem o que resultou em um horizonte p igual a 150.\nTabela 5.3: Sintonia dos par\u00eametros do Algoritmo PNMPC\t\t\nS \u00edmbolo.\tDescri\u00e7\u00e3o da vari\u00e1vel\tValor\nTs\tTempo de amostragem\t5s\nm\tHorizonte de controle\t3\nP\tHorizonte de predic\u00e3o para qoL\t150\nP1\tHorizonte de predicao para Pglm\t18\nW1\tElementos do vetor Wi 1 x 4p\t0,020\nW2\tElementos do vetor W2 1 x 5m\t5e-4\nW3\tElementos da diagonal da matriz W3 p1 x p1\t(1)\nW4\tElementos da diagonal da matriz W4 4p x 4p\t(2)\nW5\tElementos da diagonal da matriz W5 5m x 5m\t(3)\n1.\tw3(i) varia linearmente de 1 to 10 para i = 1 : 18\n2.\tw4(i) e funcao linear da vazao massica de gas normalizada (em rela\u00e7ao a qlQLM) entrando no GLM. 1 para qGnLM\u00b0rm = 1 e 12 para 7\u201c\u2122 = 0.25\n3.\tw5(i) = 1x10 5 para i=1:12. Para i=13:15 utilizou-se uma funcao\nlinear da vazao massica de gas normalizada entrando no GLM, qaLM\u00b0rm.\t(i, i) varia de 1x10 5 para 7^\u2014\u00b0\u2122 = 1,0 a\n15x10-5 para 7^\u00b0\u2122 = 0.25.\n5.3.4\tResultados obtidos\nA fim de testar a estrategia proposta simulou-se uma opera\u00e7\u00e3o de 24 horas cobrindo diferentes disponibilidades de gas para inje\u00e7\u00e3o. Assumiu-se um volume equivalente do GLM (soma de todos os volumes internos dos dutos associados ao GLM) igual a 1 m3. Cada po\u00e7o possui um valor de injec\u00e3o de gas que corresponde aproximadamente ao valor que induz a maior produc\u00e3o de oleo. Os valores da pressao de fundo e vaz\u00e3o de inje\u00e7\u00e3o correspondente a este ponto recebem o sobrescrito *. As press\u00f5es e vaz\u00f5es de cada po\u00e7co s\u00e3ao normalizadas com relac\u00e7\u00e3ao a esses valores.\nA figura 5.27 topo mostra a press\u00e3o de fundo de todos os po\u00e7os (valores normalizados) e a press\u00e3o no GLM (normalizada em re-la\u00e7ao ao valor de refer\u00eancia). Pode-se observar que as press\u00e3es variam suavemente devido a ac\u00e7a\u00e3o do controle. A pressa\u00e3o no GLM apresenta uma pequena mudan\u00e7a em relacao a refer\u00eancia nos momentos de mudan\u00e7ca na vaz\u00e3ao de entrada no GLM do tipo rampa mas nao ultrapassa os valores da restric\u00e3o. A figura 5.27-base\n1.2\n1\n0.8\n0.4\n\u00c9\nE O cr\n0.2\n0\t2\t4\t6\t8\t10 12 14 16 18 20 22 24\nTempo [ h ]\nFigura 5.26: Vaz\u00e3o de g\u00e1s normalizada entrando no GLM\nmostra as vaz\u00e3oes de gas de todos os po\u00e7cos e a vaza\u00e3o de excesso de gas. E interessante observar que quando a vaz\u00e3ao de gas entrando no GLM vai a 110% do seu valor nominal a vaz\u00e3o de excesso cresce para manter a pressa\u00e3o no GLM em seu valor de refer\u00eaencia e para evitar perda de produ\u00e7\u00e3o. Quando a vaz\u00e3o de gas entrando no GLM decresce de 50 % para 25 % de seu valor nominal, a vaz\u00e3ao na linha de excesso ajuda a evitar mudan\u00e7cas bruscas na vaz\u00e3ao de injec\u00e7a\u00e3o dos po\u00e7cos que causariam uma oscila\u00e7c\u00e3ao excessiva na vaza\u00e3o de produc\u00e7\u00e3ao de oleo. Este comportamento pode ser ajustado atraves da sintonia dos par\u00eaametros da fun\u00e7c\u00e3ao custo.\nFigura 5.27: Press\u00e3o no GLM e no fundo dos pocos x vaz\u00f5es saindo do GLM\nprodu\u00e7ao de \u00f3leo de todos os po\u00e7os \u00e9 mostrada na figura 5.29. As curvas com as linhas s\u00f3lidas foram obtidas com a simula\u00e7\u00e3o utilizando o controle de oscila\u00e7\u00f5es enquanto que as curvas com linhas tracejadas s\u00e3o resultados da simula\u00e7\u00e3o sem aplica\u00e7\u00e3o de controle de oscilacao. O poco 3 \u00f3 o principal produtor. E interessante notar que a queda na produ\u00e7ca\u00e3o n\u00e3ao \u00f3e muito afetada pela diminui\u00e7c\u00e3ao na vaza\u00e3o de g\u00f3as entrando no GLM devido a aloca\u00e7ca\u00e3o apropriada feita pelo algoritmo PNMPC. Apesar de haver pouco grau de liberdade para aplica\u00e7ao de controle (somente manipulac\u00e3o nas vaz\u00e3es de sa\u00edda do GLM) todos os objetivos de controle foram atingidos: 1) distribui\u00e7\u00e3o \u00f3tima de g\u00f3s, 2) controle da press\u00e3o no GLM e 3) atenuac\u00e7\u00e3ao das oscila\u00e7c\u00e3oes na produc\u00e7\u00e3ao de \u00f3oleo.\nFigura 5.28: Vazao de producao de \u00f3leo de todos os pocos\nFigura 5.29: Vazao de producao de \u00f3leo de cada poco\n5.4\tConclus\u00f5es e desenvolvimentos futuros\nO monitoramento permanente de press\u00e3o e temperatura de fundo de po\u00e7co est\u00f3a se tornando uma realidade para novos po\u00e7cos. Al\u00f3em disso a maioria dos novos po\u00e7cos \u00f3e tamb\u00f3em equipada com chokes de inje\u00e7ao com controle automatizado. Neste cap\u00edtulo apresentou-se duas abordagens para o controle de um grupo de po\u00e7cos operando via GLC. A primeira abordagem ignora o comportamento din\u00e2mico dos po\u00e7cos e pode ser utilizada sempre quando a disponibilidade de g\u00f3as comprimido para inje\u00e7c\u00e3ao permite o funcionamento dos po\u00e7cos com vaz\u00e3oes de inje\u00e7ca\u00e3o bem maiores do que a vaz\u00e3ao que leva o po\u00e7co ao funcionamento com oscila\u00e7co\u00e3es sustentadas. A t\u00f3ecnica de controle preditivo PNMPC apresentada e aplicada no controle de um grupo de po\u00e7cos operando via GLC contempla a operac\u00e7\u00e3ao dos po\u00e7cos para grandes restric\u00e7\u00e3oes na disponibilidade de g\u00f3as comprimido para injec\u00e3o. Nesses casos os pocos exibem um comportamento bastante oscilato\u00f3rio da press\u00e3ao de fundo que se traduz em produ\u00e7c\u00e3ao tamb\u00f3em oscilat\u00f3oria. Ainda que essas oscila\u00e7co\u00e3es tendam a desaparecer com o tempo se as vaz\u00e3oes de inje\u00e7ca\u00e3o de ga\u00f3s forem mantidas constantes, nos momentos das mudanc\u00e7as elas podem prejudicar bastante o processo de separa\u00e7ca\u00e3o das fases \u00f3agua, \u00f3oleo e g\u00f3as. A solu\u00e7c\u00e3ao de controle utilizando o algoritmo PNMPC \u00f3e mais geral e poder\u00f3a ser implementada em futuros po\u00e7cos propiciando operac\u00e7\u00e3oes mais rent\u00f3aveis e seguras. Alguns desenvolvimentos futuro nesta \u00f3area sa\u00e3o\n\u2014\ta incorporac\u00e3o de requisitos de desempenho do processo de separac\u00e7a\u00e3o \u00f3agua, \u00f3oleo e g\u00f3as na fun\u00e7ca\u00e3o objetivo do algoritmo de controle n\u00e3ao linear PNMPC apresentado. No lugar de minimizar as oscila\u00e7co\u00e3es nas vaz\u00e3oes de produ\u00e7c\u00e3ao com a expectativa de melhorar o processo de separa\u00e7ca\u00e3o, poderia-se minimizar diretamente as varia\u00e7c\u00e3oes nas varia\u00f3veis dos separadores como interface de \u00f3agua-\u00f3oleo, n\u00f3vel de \u00f3oleo e press\u00e3ao do separador,\n\u2014\tdesenvolver estrategias para a manutencao da operac\u00e3o dos po\u00e7cos mesmo quando a vaz\u00e3ao de g\u00f3as para inje\u00e7ca\u00e3o \u00f3e menor do que o somat\u00f3orio das vaz\u00e3oes operacionais m\u00f3nimas de dada po\u00e7o. Vaz\u00e3o operacional m\u00ednima sendo a vazao que leva cada poc\u00e7o a desenvolver oscila\u00e7co\u00e3es sustentadas devido ao fen\u00e2meno heading ou density-wave. Uma abordagem seria\no desenvolvimento de t\u00e1ecnicas de controle chaveado semelhantes a utilizadas no cap\u00e1tulo 6 para eliminar as oscila\u00e7\u00f5es para vaz\u00e3oes de inje\u00e7c\u00e3ao menores do que as vaz\u00e3oes operacionais m\u00e1nimas. Um sistema superviso\u00e1rio poderia comutar o sistema de controle do po\u00e7co entre o controle individual baseado em controle chaveado e controle PNMPC em fun\u00e7ca\u00e3o da disponibilidade de g\u00e1as dispon\u00e1vel. Obviamente mesmo com a utiliza\u00e7c\u00e3ao de controle chaveado a opera\u00e7c\u00e3ao do poc\u00e7o ser\u00e1a pos-s\u00e1vel para uma determinada faixa de vazao media de g\u00e1s, abaixo da qual o po\u00e7o teria de ser fechado. A aplica\u00e7\u00e3o da t\u00e1ecnica poderia garantir o funcionamento do poc\u00e7o para menores disponibilidades de ga\u00e1s em rela\u00e7c\u00e3ao a estrat\u00e1egia de fechar o po\u00e7co para vazo\u00e3es dispon\u00e1veis pr\u00e1oximas a vaza\u00e3o operacional m\u00e1nima.\nControle aplicado a pocos operando via GLC\n254\nCap\u00edtulo 6\nControle de escoamento em risers\n6.1\tIntrodu\u00e7\u00e3o\nO Transporte de fluido multifasico (\u00e1leo, \u00e1gua e g\u00e1s) \u00e1 um procedimento importante na indu\u00e1stria do petr\u00e1oleo. Atualmente h\u00e1a uma tend\u00eaencia em aumentar o nu\u00e1mero de po\u00e7cos atendidos por uma mesma plataforma ou sistema de produ\u00e7ca\u00e3o assim como o comprimento dos risers entre o conjunto de po\u00e7os e o sistema de produc\u00e7\u00e3ao. O escoamento simult\u00eaaneo de l\u00e1quido e g\u00e1as em dutos pode apresentar um fenomeno chamado slug-flow que \u00e1 caracterizado pela distribuic\u00e7\u00e3ao intermitente de g\u00e1as e l\u00e1quido ocupando grande parte do duto. As oscila\u00e7co\u00e3es nos n\u00e1veis de press\u00e3ao e vaz\u00e3ao durante o fen\u00eaomeno slug-flow podem provocar efeitos indesej\u00e1aveis nos dutos e equipamentos de superf\u00e1cie. Essas oscila\u00e7c\u00e3oes podem causar problemas s\u00e1erios na entrada dos separadores multifa\u00e1sicos, por exemplo, deteriorando a qualidade da separa\u00e7c\u00e3ao assim como transbordamento, [108]. T\u00e9cnicas de controle autom\u00e1tico realimentado podem ser utilizadas para a supressa\u00e3o deste tipo de oscilac\u00e7\u00e3ao. Como resultado obt\u00e1em-se vaz\u00e3oes esta\u00e1veis nos risers e minimiza-se o problema nos separadores multifa\u00e1sicos. Ao mesmo tempo pode-se operar com menos custo energ\u00e1etico e uma melhor utiliza\u00e7c\u00e3ao da capacidade dos equipamentos instalados aumentando a produ\u00e7c\u00e3ao.\nUm diagrama esquematico de um riser utilizado em um sistema de produ\u00e7\u00e3o offshore \u00e9 mostrado na figura 6.1 com os parametros utilizados apresentados na tabela 6.1. A opera\u00e7ao deste sistema foi simulado no OLGA1 *. Na figura 6.1 as press\u00f5es no fundo e no\nFigura 6.1: Instalac\u00e3o do riser simulado no OLGA.\nTabela 6.1: Par\u00e2metros utilizados na simulac\u00e3o do riser\nPar\u00e2metro\tvalor\tunidade\nVaz\u00e3o massica entrando no riser\t5\tKg.s-1\nPress\u00e3o no separador\t5.106\tPa\nFra\u00e7\u00e3o de vazio\t5\t%\nTemperatura na sa\u00edda do riser\t22\to C\nTemperatura na entrada do riser\t62\to C\ntopo do riser, respectivamente Pi e P2, sao medidas e utilizadas para calcular uma a\u00e7\u00e3o de controle que \u00e9 aplicada no choke. A\n1 Software para simula\u00e7\u00e3o de escoamento multif\u00e1sico comercializado pela Scand-\npower\nmodelagem deste sistema \u00e1e bastante complexa. Um procedimento usual consiste em utilizar equa\u00e7c\u00e3oes diferenciais parciais que expressam as leis de conserva\u00e7ca\u00e3o de massa, energia e movimento para os fluidos presentes e modelos matem\u00e1ticos de elementos como o choke, por exemplo. Um modelo simplificado baseado em um sistema com 3 equa\u00e7c\u00e3oes diferenciais ordin\u00e1arias e 3 estados pode ser encontrado em [109], [110].\nFigura 6.2: Abertura do choke como par\u00e2metro de bifurcacao - Um ciclo limite estavel desenvolve-se a partir de uma Bifurca\u00e7\u00e3o Hopf Su-percr\u00e1tica (HBsup).\nO diagrama de bifurca\u00e7c\u00e3ao considerando a abertura do choke como o par\u00e2ametro de bifurca\u00e7ca\u00e3o \u00e1e apresentado na figura 6.2 e foi obtido com os resultados da simula\u00e7\u00e3o do sistema de riser apresentado na figura 6.1 no simulador OLGA2000. Nesta simula\u00e7c\u00e3ao utilizou-se uma vazao m\u00e1ssica na entrada do riser de 5Kg.s-1 e considerou-se uma pressao no separador de 5.106Pa. O diagrama de bifurca\u00e7\u00e3o da figura 6.2 \u00e1 qualitativamente similar ao diagrama mostrado em [109].\nA variedade de equil\u00e1brios est\u00e1aveis e inst\u00e1aveis \u00e1e apresentada na figura 6.3. Nesta figura mostra-se tambem as curvas correspondendo aos valores m\u00e1aximos e m\u00e1nimos do ciclo limite. A pro-jec\u00e7\u00e3ao dos ciclos limite para diferente aberturas de choke no plano (P1, P2) \u00e1 apresentada na figura 6.4. Pode-se observar nesta figura que a rela\u00e7\u00e3o entre as press\u00f5es Pi e P2 no manifold de equil\u00e1brio esta\u00e1vel pode ser aproximada por uma reta.\nComo pode ser visto nas figuras 6.2-6.4, uma Bifurca\u00e7ao Hopf\nFigura 6.3: Diagrama de bifurca\u00e7\u00e3o no plano (u(\u00ed),Pi)\nFigura 6.4: Diagrama de Bifurca\u00e7ao no plano (P-\u00ed,P2)\nsupercr\u00edtica desenvolve-se no ponto HBsup dos diagramas dando origem a um ciclo limite esta\u00e1vel.\nMaior press\u00f5o para uma mesma vaz\u00f5o massica significa maior consumo de energia necessaria para o bombeamento do fluido. Por outro lado, risers conectados diretamente a poc\u00e7os poderiam aumentar a press\u00f5ao na frente da zona produtora causando a diminui\u00e7c\u00f5ao na produ\u00e7ao de oleo. Qualquer que seja o caso \u00e9 desejavel operar o riser com uma vaz\u00f5ao n\u00f5ao oscilatoria e com uma queda de press\u00f5ao m\u00ednima no choke de superf\u00edcie.\nDiversas leis de controle lineares tem sido propostas para prevenir oscilac\u00f5es devido ao fen\u00eameno slug-flow em risers submarinos como em [110] e [108].\nEsses controladores lineares s\u00f5o solu\u00e7\u00f5es validas para uma faixa de operac\u00e7\u00f5ao muito estreita e pode-se dizer que s\u00f5ao solu\u00e7co\u00f5es locais para um problema na\u00f5o linear complexo. Prop\u00f5oe-se neste trabalho uma solu\u00e7ao alternativa baseada na Teoria de Controle de Modos Deslizantes (Sliding Mode Control) de sistemas n\u00f5o lineares.\nEste cap\u00edtulo \u00e9 organizado como segue. Na sec\u00f5o 6.2 a lei de controle Proporcional Integral (PI) \u00e9 revisitada mostrando que n\u00f5ao e robusta para perturba\u00e7co\u00f5es na vaza\u00f5o de entrada do riser. Nas sec\u00f5es 6.3 e 6.4 prop\u00f5e-se diferentes estrategias SMC para controlar as oscila\u00e7\u00f5es devido o fen\u00eameno slug-flow. A estrategia SMC washout \u00e9 apresentada na se\u00e7\u00e3o 6.5. No final discute-se algumas limitac\u00e7o\u00f5es do metodo de controle proposto e prop\u00f5oe-se melhoramentos futuros.\n6.2\tRevisitando a estrat\u00e9gia PI para suprimir slug-flow\nNesta sec\u00e7\u00e3ao mostra-se atraves de simulac\u00e7\u00e3oes que a lei de controle pi na\u00e3o e robusta para perturba\u00e7co\u00e3es na vaz\u00e3ao de entrada do riser. Uma simula\u00e7\u00e3o foi realizada para avaliar a eficiencia da lei de controle PI dada por\nimplementada \u00e9 dada por\nu(k) = u(k \u2014 1) + soe(k) + sie(k \u2014 1)\nonde s0 = kc(1 + jjs), si = \u2014kc, Ts = 1s \u00e9 o tempo de amostragem e Ti e o tempo de integracao. A sintonia do controlador PI foi realizada utilizando regras simples de ajuste uma vez que n\u00e3o se disp\u00f5e de um modelo matematico de baixa ordem do processo.\nFigura 6.5: Resposta do sistema controlado pelo PI para perturba\u00e7\u00f5es na vaz\u00e3o de entrada (5Kg.s-1 para 3.5Kg.s-1)\nA simula\u00e7ao foi realizada com as seguintes caracter\u00edsticas:\n1.\ta abertura do choke foi fixada em 20% e o ponto de opera\u00e7\u00e3o calculado a partir da curva do manifold de equilibrio e caracterizado por (P*,P% ) = (6.93 \u2022 106 [Pa], 5.56 \u2022 106 [Pa]);\n2.\tem 5000s o controle e ligado;\n3.\tuma perturba\u00e7\u00e3o na entrada do riser e aplicada em 15000s;\n4.\to controle e desligado em 25000s.\nFigura 6.6: Resposta do sistema controlado pelo PI para perturba\u00e7\u00f5es na vazao de entrada (5Kg.s-1 para 3Kg.s-1)\nprimeira perturba\u00e7\u00f5o e na figura Fig.6.6 para a segunda pertur-ba\u00e7\u00f5o. Como pode ser observado, o controle PI rejeita a primeira perturba\u00e7\u00f5o mas n\u00f5o \u00e9 robusto o suficiente para a segunda per-turbac\u00f5o. A fim de atacar a dificuldade causada por grandes varia\u00e7\u00f5es de vaz\u00f5o na entrada do riser, prop\u00f5e-se tr\u00eas diferentes estrat\u00e9egias de controle baseadas em Controle de modos deslizante (Sliding Mode Control-SMC) nas sec\u00f5es seguintes.\n6.3\tEstrat\u00e9gia Slug SMC\nA ideia principal \u00e9e projetar uma lei de controle de modos deslizante (SMC) que induz uma bifurca\u00e7\u00f5o grazing-sliding no sistema, [111], mudando sua din\u00e2mica e, desta forma, controlando a amplitude do ciclo limite. Este tipo de bifurca\u00e7\u00f5o n\u00f5o suave introduz movimento deslizante parcial ao longo da superf\u00e9cie deslizante, reduzindo ou suprimindo a amplitude do ciclo limite n\u00f5ao desejado. Para explicar essas ideias, considere um sistema geral definido por\nx = F (x,u(x))\t(6.1)\nonde x G Rn \u00e9 um vetor de estados de dimens\u00f5o n, e u(x) G R \u00e9\no sinal de controle. A fun\u00e7\u00e3o F(x) = (Fi, F2,Fn) : Rn Rn, representa um sistema cont\u00ednuo n\u00e3o suave. Assume-se que como resultado de uma Bifurca\u00e7\u00e3o Hopf (cont\u00ednua ou n\u00e3o, [112]), o sistema exibe um comportamento oscilat\u00f3rio em regime permanente, onde um ciclo limite est\u00f3vel \u00f3 a soluc\u00e3o da equa\u00e7\u00e3o 6.1.\nA bifurcac\u00e3o grazing-sliding para suprimir um ciclo limite ocorre quando o ciclo limite \u00f3 atravessado por uma superf\u00edcie deslizante que gera uma transi\u00e7c\u00e3ao n\u00e3ao suave grazing-sliding onde parte da trajet\u00f3ria do ciclo limite permanece na superf\u00edcie deslizante como mostrado na figura 6.7.\nFigura 6.7: Bifurcacao Grazing-sliding induzida no sistema\nPor exemplo, em um sistema com dimens\u00e3o 2, considere-se a regiao Si da forma\n51\t:= {x = (xi, X2) : X2 > m}\npara um m arbitr\u00f3rio, sendo\nS := a(x) = {x = (xi, X2) : X2 = m}\ne\n52\t:= {x = (xi,x2) : x2 &lt;m}.\nCom a varia\u00e7ao de m, acontece uma bifurcac\u00e3o grazing-sliding e a amplitude do ciclo limite \u00f3e reduzida ou mesmo eliminada. Assim, o controle de modo deslizante sugerido \u00f3e\nu \u2014 u0 + Au sgn(a(x))\t(6.2)\nonde ofx) \u2014 0 e a superf\u00edcie deslizante, uma fun\u00e7ao dos estados do sistema que permite a mudan\u00e7a de sua din\u00e2mica; u0 e o valor da variavel de controle no ponto de operac\u00e3o e Au e o valor maximo que a variavel de controle pode assumir a partir de u0. A fun\u00e7ao sgn(-) pode ser definida como\nou\nsgn(a(x))\nse a(x) &lt;0; se a(x) > 0.\n(6.3)\nsgn(a(x))\n0, se a(x) &lt;0;\n1, se a(x) > 0.\n(6.4)\n\nAplicando as equa\u00e7\u00e3es acima, propoe-se a seguinte lei de controle dada por\nu \u2014 u0 + Au sgn(a),\t(6.5)\na(P1,P2) \u2014 P2 \u2014 P1 + p\n(6.6)\nonde p = P* \u2014 P2*; Au = u0 \u2014 umin; u0 \u00e9 a abertura desejada para o choke e umin \u00e9 o valor da a\u00e7\u00e3o de controle no ponto de Bifurca\u00e7\u00e3o de Hopf. A superf\u00edcie de chaveamento \u00e9 definida como P2 = P1 \u2014 ft e define-se sgn(-) para fechar o choke sempre que a > 0. O bias da abertura do choke u0 \u00e9 definido no ponto de opera\u00e7ao desejado. Neste ponto P*, P2* sao definidos na curva do manifold de equil\u00edbrios para uma dada vaz\u00e3o massica de entrada no riser como mostrado na figura 6.3.\nA escolha do valor bias da abertura do choke de superf\u00edcie deve considerar dois fatores. Por um lado o valor deveria ser grande o suficiente a fim de garantir uma queda de pressao m\u00ednima no choke. Por outro lado o bias n\u00e3o deveria estar muito longe dos valores que podem causar quedas de press\u00e3ao significativas no choke a fim de poder responder rapidamente \u00e0s perturbac\u00f5es. A abertura do choke perto de 100% causa uma queda de press\u00e3o m\u00ednima mas dependendo das caracter\u00edsticas do choke uma queda de press\u00e3o significativa no choke pode ser obtida somente para valores menores de 10%. A estrategia de controle pode ser interpretada como um mecanismo que for\u00e7ca um escoamento hipotetico em regime permanente que seria obtido sem o comportamento slug-flow. Para uma vaz\u00e3o massica de entrada de gas e l\u00edquido constante a press\u00e3o Pi pode ser expressa como Pi = P2 + onde\np levaria em conta os termos devido a gravidade e atrito para um pseudo escoamento estavel. Para um modelo homog\u00eaeneo simplificado de escoamento no riser pode-se escrever\n(6.7)\nonde A \u00e9 a se\u00e7\u00e3o do duto; mgr e mlr sao a massa do gas e a massa do l\u00edquido no riser; p \u00e9 a densidade media do fluido; v e a velocidade media do fluido no riser; h e a comprimento do riser; f \u00e9 o fator de atrito; dr \u00e9 o diametro do riser. Na equacao\n6.7\to primeiro termo corresponde a contribui\u00e7ao da gravidade e o segundo ao do atrito. A qualquer momento em que o relacionamento entre P1 e P2 dado pela equacao 6.7 e violado, uma a\u00e7\u00e3o \u00e9 tomada na abertura do choke para for\u00e7ar o relacionamento P1, P2 desejado. Obviamente isto \u00e9 feito de uma forma que forne\u00e7a uma abertura de choke desejada que minimiza P1 e consequentemente a energia utilizada para elevar o gas e o l\u00edquido entrando no riser. A resposta temporal em malha aberta \u00e9 apresentada na figura 6.8. Em t = 5000s o sistema de controle proposto \u00e9 ligado. Em t = 15000s uma perturba\u00e7ao na vaz\u00e3o de entrada (de 5Kg.s-1 a 3.5Kg.s-1) foi aplicada. Pode-se observar na figura 6.8 e 6.9 que a amplitude das oscila\u00e7\u00e3es \u00e9 diminu\u00edda em torno do ponto de opera\u00e7ca\u00e3o quando o controle e ligado.\nComo pode ser observado na figura 6.8, apos o desligamento do controle, em t = 250000s, as oscila\u00e7\u00f5es retornam ao sistema. O diagrama de espa\u00e7o de estados, no plano (P1,P2), \u00e9 apresentado na figura 6.9.\nA tecnica de controle SMC proposta opera bem para pequenas perturba\u00e7c\u00e3oes na vaz\u00e3ao de entrada do riser mas a ac\u00e7\u00e3ao de controle chaveia permanentemente para manter o equil\u00edbrio no ponto de opera\u00e7c\u00e3ao.\nFigura 6.8: Resposta do sistema no tempo com a estrat\u00e9gia de controle SMC (Malha aberta e com controle realimentado aplicado). a) abertura do choke; b) estados do sistema\nFigura 6.9: Diagrama de espaco de estados no plano (P1; P2)\nA ideia \u00e9 combinar duas leis de controle (i) o controle utilizado na se\u00e7\u00e3o 6.3 e (ii) uma forma discreta da lei de controle PI conforme apresentada na se\u00e7ao 6.2 por meio de uma funcao convexa como\nu(t) = M usmc + (1 - m) upi,\t(6.8)\nusmc = uo + Au sgn(a),\t(6.9)\nonde\nCT = P2 - P1 + P-\nuPI (k)\t= uPI (k \u2014 1) + s0 e(k) + Si e(k \u2014 1),\t(6.10)\nonde usmc e a lei de controle de chaveamento dada por 6.9 e uPI e o controle PI 6.10, com e(k) = P*(k) \u2014 P\u00ed(k).\nO par\u00e2metro g = g(Pi,P2) fornece uma transi\u00e7\u00e3o suave entre as leis de controle de tal forma que se as trajet\u00f3rias estao longe do ponto de equil\u00edbrio ent\u00e3o g tende a 1; de outra forma g se aproxima de 0. O par\u00e2metro g \u00e9 definido como\nM = 1+r\u00e2^)\n(6.11) A(PbP2) = ( pt \u2014 1)2 + (pt \u2014 1)2\nonde P* e o ponto de operac\u00e3o para a press\u00e3o de fundo e P2* \u00e9 o valor desejado para a pressao na entrada do choke de superf\u00edcie. Os valores dos par\u00e2metros para os controladores definidos pelas equa\u00e7\u00f5es 6.9, 6.10 e 6.11 s\u00e3o apresentados na Tabela 6.2. O par\u00e2metro p \u00e9 definido como p = P* \u2014 P*. A resposta do\nTabela 6.2: Par\u00e2metros da lei de controle\nPar\u00e2metro\tValor\tUnidade\nuo\t0.2\t\nAu\t0.12\t\nso\t-8.08 \u2022 10-6\tPa-1\nS1\t7.92 \u2022 10-6\tPa-1\nY\t8/S\t\nS\t0.008\t\nsistema com a lei de controle proposta para uma perturba\u00e7\u00e3o na vaz\u00e3o massica de entrada no riser \u00e9 mostrada na figura 6.10 e o\ndiagrama de espa\u00e7o de estados \u00f3 apresentado na figura 6.11. O tempo de amostragem adotado foi Ta = 1s. Em t = 15000s, a\nAbertura do choke\n\t\t\t\t\u2014\t\t\t\t\t\t\t\n\t\u25c4\u2014 Controle ligado\t\t\t\t: !\n\t\t\t\t\t\\\n\tvaz\u00e3o de entrada ~\t\t\t\t\u25c4 desligado\n\t\tA\t\u00ed\t\t\t\t\t, A\ti\t-\n\tj\t1\t\t\t\tM i\nTempo [s] xio\nvan ave is do sistema\nTempo [s] xio4\nFigura 6.10: Respostas de controle e sa\u00edda com a lei de controle modificada (6.8) para uma perturba\u00e7\u00e3o na entrada\nFigura 6.11: Diagrama de espa\u00e7o de estados para o sistema com a lei de controle modificada (6.8)\nvaz\u00e3o m\u00f3ssica de entrada no riser \u00f3 reduzida de 5kg/s to 3.5kg/s.\nEsta perturbac\u00e7\u00e3ao muda as condic\u00e7\u00e3oes de opera\u00e7c\u00e3ao do processo. A estrategia de controle SMC proposta controla o sistema reduzindo a amplitude das oscila\u00e7c\u00e3oes.\nEm t = 25000s, o controle \u00e9 desligado e o sistema comeca a exibir oscilac\u00e7\u00e3oes de pressa\u00e3o e vaza\u00e3o novamente. Isto acontece porque o valor de abertura de choke encontra-se na regi\u00e3ao de instabilidade. Uma desvantagem de usar o algoritmo SMC discutido nesta Se\u00e7\u00e3o \u00e1e que na\u00e3o \u00e1e poss\u00e1vel estabilizar o sistema para grandes pertur-bac\u00e7\u00e3oes na vaz\u00e3ao.\n6.5\tControle Slug Washout SMC\nTodas as t\u00e1ecnicas apresentadas anteriormente para o controle de golfadas utilizam refer\u00eaencias para obter a lei de controle. Essas estrat\u00e1egias tem um problema quando ocorrem mudanc\u00e7as na vaz\u00e3ao m\u00e1assica entrando no riser. Mesmo um escoamento estabilizado ir\u00e1 exibir valores diferentes para Pi e P2 frente a diferentes vaz\u00e3es m\u00e1assicas de g\u00e1as j\u00e1a que os termos devido a gravidade e atrito na express\u00e3ao para a queda de press\u00e3ao no riser bem como a queda de press\u00e3ao no choke crescem com o aumento da vaz\u00e3ao.\nPara a t\u00e1ecnica de controle de modos deslizante a manuten\u00e7c\u00e3ao da refer\u00eaencia frente a mudan\u00e7cas na vaz\u00e3ao m\u00e1assica entrando no riser significam requerer que o sistema opere em um ciclo limite n\u00e3ao suficientemente colapsado ou exigir o estabelecimento de um escoamento infact\u00e1vel.\nVisto que o objetivo pra\u00e1tico \u00e1e estabilizar a vaz\u00e3ao mantendo o choke com uma queda de press\u00e3o m\u00e1nima, a id\u00e1ia de refer\u00eancia de press\u00e3ao perde significado. Poderia-se dizer que o problema de controle \u00e1 bem resolvido se as press\u00e3es e vaz\u00e3es enquanto o choke de superf\u00e1cie \u00e1e mantido aberto bem acima do valor que caracteriza o in\u00e1cio do ciclo limite. A ideia \u00e1e desenvolver um estrat\u00e1egia de controle que suprime as oscila\u00e7c\u00e3oes enquanto mant\u00e1em a abertura do choke operando em torno de um valor desejado. Se as oscilac\u00e7o\u00e3es s\u00e3ao suprimidas as press\u00e3oes resultantes sera\u00e3o uma con-sequ\u00eaencia da vaz\u00e3ao ma\u00e1ssica de entrada, caracter\u00e1sticas do fluido e geometria do sistema.\nA fim de atender as restri\u00e7c\u00e3oes prop\u00e3oe-se neste Se\u00e7c\u00e3ao uma nova estrat\u00e1egia SMC para rejeitar perturba\u00e7c\u00e3oes na vaz\u00e3ao de entrada\ndo riser baseada em filtros washout. Os filtros washout sao usados intensivamente para controlar sistemas ca\u00f3ticos por meio de t\u00e9cnicas baseadas na teoria de bifurca\u00e7\u00f5es [113] e em sistemas de controle de v\u00f4o [114]. Recentemente, filtros washout foram aplicados em inversores de eletr\u00f4nica de pot\u00f4ncia em conjunto com controladores SMC a fim de rejeitar perturbac\u00f5es de carga [115]. Um filtro washout \u00e9 um filtro passa alta linear que elimina a componente de regime permanente da entrada enquanto permite a passagem da componente transiente. A utilizacao de filtros washout assegura que todos os pontos de equil\u00edbrio do sistema original sejam preservados no sistema controlado, i. e., sua localiza\u00e7ca\u00f5o permanece inalterada.\nA funcao de transferencia de um filtro washout t\u00edpico \u00e9 dada por\nGf (s) =\ns\tw\nI\t1\tI\t,\ns + w\ts + w\nonde w denota a reciproca da constante de tempo do filtro que \u00e9 positiva para filtros estaveis. Assume-se que seja poss\u00edvel filtrar a variavel x para obter um novo sinal xF e definir uma variavel auxiliar z de forma a satisfazer a seguinte equa\u00e7ao\ndz\n= w(x \u2014 z). dt\nuWSMC\nuo + Au sgn((j),\n(6.13)\nxp = x \u2014 z.\nEnt\u00e3o o efeito do filtro washout pode ser representado por meio de uma equa\u00e7ca\u00e3o diferencial adicional,\n(6.12)\nDois filtros washout sao utilizados, um para Pr e outro para P2 de tal forma que\nzi = wi(Pi \u2014 z) = wi pi\n-\u00bf2 = W2 (P2 \u2014 z) = W2\u00cd)2\nonde\n^(\u00c3,-P2) = P - \u00c3-\t(6.14)\nNote que 6.14 \u00e9 similar a 6.6 mas agora o par\u00e2metro p \u00e9 nulo. A superf\u00edcie de deslizamento \u00e9 agora definida como P2 = \u2014Pl e ela n\u00e3o depende do ponto de opera\u00e7\u00e3o.\nEm t = 10000s o controle automatico \u00e9 ligado e em t = 30000s vazao de entrada no riser \u00e9 reduzida de 5kg/s para 3kg/s.\nEm t = 50000s o controle \u00e9 novamente desligado e o sistema retorna ao comportamento oscilat\u00f3rio. Os resultados de simula\u00e7\u00e3o sao apresentados na figura 6.12.\nFigura 6.12: Resposta de controle e sa\u00eddas do sistema com o slug washout SMC para perturba\u00e7ao na vaz\u00e3o de entrada do riser\nFigura 6.13: Diagrama de espaco de estados do sistema com slug washout SMC\n6.6\tConclus\u00f5es\nA falta de robustez no controle de oscila\u00e7\u00f5es devido ao fen\u00f4meno slug-flow em risers submarinos utilizando o sistema de controle classico PI foi abordada neste trabalho aplicando t\u00e9cnicas SMC. Tr\u00f4es controladores SMC diferentes foram propostos para suprimir as oscila\u00e7c\u00f5oes devido o feno\u00f4meno slug-flow em risers. Resultados de simula\u00e7c\u00f5ao foram obtidos utilizando o software OLGA a fim de comparar as diferentes estrat\u00e9egias SMC sujeitas a perturba\u00e7\u00f5es na vazao m\u00e1ssica na entrada do riser de 5Kg.s-1 to 3Kg.s-1. A t\u00e9cnica SMC revela-se uma forma robusta de suprimir os ciclo limites quando o modelo matem\u00e9atico do processo n\u00f5o \u00e9 dispon\u00e9vel na pr\u00e9tica. A din\u00f4mica do sistema riser apresentando o comportamento slug-flow em malha aberta com ponto de opera\u00e7c\u00f5ao desconhecido foi tratado neste trabalho utilizando filtros washout. Esta situa\u00e7\u00f5o se manifesta na presenca de perturba\u00e7oes na vaz\u00f5ao m\u00e9assica de entrada no riser. Um obst\u00e9aculo pr\u00e9atico para a aplica\u00e7c\u00f5ao da t\u00e9ecnica SMC padr\u00f5ao no campo \u00e9e a componente de alta frequ\u00f4encia no sinal de controle produzido conhecida como chattering. Este problema pode levar ao desgaste prematuro de elementos do choke. A presen\u00e7ca do efeito chattering na a\u00e7c\u00f5ao de controle podera\u00e9 ser eliminada com futuros trabalhos utilizando-se controladores de modos deslizante de alta ordem (High Order\nSliding Mode - HOS\u2019M controllers) ou ajustando a func\u00f5o sign() por uma fun\u00e7\u00f5o suave cont\u00ednua, mantendo dentro do poss\u00edvel as condi\u00e7\u00f5es de atratividade do sistema comutado.\nControle de escoamento em risers\n273\nControle de escoamento em risers\n274\nCap\u00edtulo 7\nConclus\u00f5es e desenvolvimentos futuros\nEste trabalho apresentou as seguintes contribuic\u00f5es:\n\u2014\tModelagem da opera\u00e7ao de elevacao de petroleo via injecao cont\u00f3nua de g\u00f3as (GLC),\n\u2014\tdesenvolvimento de um algoritmo de controle MPC distribu\u00eddo,\n\u2014\tdesenvolvimento de uma tecnica de controle MPC para sistemas n\u00e3ao lineares\n\u2014\taplica\u00e7ao de 2 t\u00f3cnicas de controle para um sistema constitu\u00eddo por um manifold de gas-lift e um grupo de po\u00e7os\n\u2014\taplica\u00e7ao de controle na estabilizac\u00e3o do escoamento em um riser submarino.\nAlguns desenvolvimentos futuros do trabalho s\u00e3ao:\n\u2014\tEstudar um mecanismo para que o modelo fenomenologico da eleva\u00e7c\u00e3ao por gas-lift forne\u00e7ca uma rela\u00e7c\u00e3ao em regime permanente de melhor qualidade.\n\u2014\tPara o modelo da rela\u00e7\u00e3o pwf = f (qinj) em regime permanente desenvolver uma metodologia baseada na utiliza\u00e7\u00e3o de um simulador de fenomenol\u00f3gico de regime permanente e t\u00f3cni\u00e7as do tipo Montecarlo que permita obter seus par\u00e2metros em fun\u00e7\u00e3o das caracter\u00edsticas do po\u00e7o.\n\u2014\tDesenvolver um m\u00f3todo num\u00f3rico robusto para resolver o problema de programac\u00e7a\u00e3o quadra\u00f3tica com restric\u00e7\u00e3ao quadr\u00f3atica para a t\u00f3cnica PNMPC com requisito de estabilidade na fun\u00e7\u00e3o objetivo.\n\u2014\tPara a aplica\u00e7\u00e3o da t\u00f3cnica PNMPC no controle de um grupo de po\u00e7os e manifold de gas-lift, testar a inclus\u00e3o de requisitos para o controle do separador \u00f3agua-\u00f3oleo e g\u00f3as no lugar de minimizar as oscila\u00e7c\u00e3oes das vaz\u00e3oes de produ\u00e7c\u00e3ao.\n\u2014\tEstudar a aplicac\u00e3o de controladores de modos deslizante de alta ordem (High Order Sliding Mode - HOSM controllers) ou substitui\u00e7\u00e3o da fun\u00e7\u00e3o sign() por uma fun\u00e7\u00e3o suave cont\u00ednua para diminuir ao m\u00f3ximo a presen\u00e7a do efeito chattering na a\u00e7\u00e3o de controle dos risers submarinos.\n\u2014\tA t\u00f3cnica de controle preditivo baseado em modelo para sistemas n\u00e3ao lineares desenvolvida obt\u00f3em a representac\u00e7\u00e3ao linearizada do sistema de forma num\u00f3erica a cada instante de amostragem e por isso pode fazer uso das mais diversas formas de representa\u00e7c\u00e3ao do sistema a ser controlado. Por outro lado existe um desenvolvimento tecnol\u00f3ogico muito grande na produc\u00e7\u00e3ao de simuladores num\u00f3ericos de reservat\u00f3orios que sa\u00e3o utilizados para representar o comportamento dos mesmos. Um trabalho futuro interessante \u00e9 aplicar a t\u00f3cnica de controle preditivo desenvolvida no controle da produ\u00e7ca\u00e3o de um reservato\u00f3rio utilizando como modelo do sistema um simulador num\u00f3erico de reservat\u00f3orio. Acredita-se que o tempo de amostragem nesta aplica\u00e7ca\u00e3o seria muito grande comparado com os tempos necess\u00f3arios para a obtenc\u00e7\u00e3ao da representa\u00e7c\u00e3ao linearizada do sistema o que facilitaria a implementac\u00e7\u00e3ao da t\u00f3ecnica.\nPublica\u00e7\u00f5es realizadas:\nEm Revistas brasileiras de divulga\u00e7\u00e3o:\n\u2014\tA. Plucenio e D. J. Pagano, Tend\u00eancias do controle e automa\u00e7\u00e3o no setor upstream da indUstria do petroleo, Revista Petro&amp;Qu\u00e1mica-Editora Valete, pag. 84-90, Setembro de 2005.\n\u2014\tM. P. Castro and E. Camponogara and A. Plucenio, Escalonamento de compressores em campos de petroleo operados por gas-lift: uma formula\u00e7\u00e3o em programa\u00e7ao matematica, Revista Petro&amp;Qu\u00edmica-Editora Valete, pag.63-70, Setembro de 2007.\nEm Revistas Internacionais\n\u2014\tEduardo Camponogara, Agustinho Plucenio, Alex F. Teixeira, and Sthener R.V. Campos. An automation system for gas-lifted oil wells: Model identification, control, and optimization. Journal of Petroleum Science and Engineering, 70(3-4):157 167, 2010.\n\u2014\tEduardo Camponogara, Melissa Pereira de Castro, Agustinho Plucenio and Daniel J. Pagano, Compressor scheduling in oil fields:Piecewise-linear formulation, valid inequalities, and computational analysis, Optimization and Engineering, October 2009.\nEm Congressos Nacionais\n\u2014\tA. Plucenio, D. J. Pagano e J. E. Normey-Rico, Controle robusto aplicado a produ\u00e7ca\u00e3o de petr oleo por elevac\u00e7a\u00e3o artificial tipo gas-lift, Congresso Brasileiro de Autom\u00e1tica, 2004;\n\u2014\tR. Oenning, A. Plucenio, Desenvolvimento de uma unidade experimental: Micro-po\u00e7co de petroleo com elevac\u00e7\u00e3ao por in-jec\u00e3o cont\u00ednua de gas, 3 Congresso Brasileiro de Petr\u00e1leo de P&amp;D em Petr\u00e1leo e Gas (PDPetro),2005-Salvador-BA.\n\u2014\tL. F. Pozas, A. Plucenio, Melhoria da converg\u00eancia de algoritmo genetico utilizado em aloca\u00e7c\u00e3ao de po\u00e7cos, 3 Congresso Brasileiro de P&amp;D em Petr\u00e1leo e G\u00e1s (PDPetro), 2005, Salvador-BA;\n\u2014\tS. G. Boff, D. J. Pagano and A. Plucenio e R. Alves, Apli-ca\u00e7ca\u00e3o de um SCADA a uma unidade experimental de coluna de destilac\u00e3o, 3o. Congresso Brasileiro de P&amp;D em Petr\u00e1leo e G\u00e1as (PDPetro), 2005, Salvador-BA;\n\u2014\tA. Plucenio, D. J. Pagano, G. A. Mafra e A. H. Bruciapaglia, Uma extens\u00e3o do controle preditivo MPC para sistemas n\u00e3o lineares, Congresso Brasileiro de Autom\u00e1tica, 2006;\n\u2014\tD. J. Pagano, A. Plucenio e P.K. Salvato, Controle de os-cila\u00e7co\u00e3es utilizando sistemas comutados, Congresso Brasileiro de Autom\u00e1tica, 2006;\n\u2014\tA. Plucenio, J. E. Normey-Rico, D. J. Pagano e A. H. Bruciapaglia, Controle Preditivo na industria do Petr\u00f3leo e G\u00f3s, 4o. Congresso Brasileiro de P&amp;D em Petr\u00f3leo e G\u00e1s (PDPetro), Outubro de 2007, Campinas-SP;\n\u2014\tA. Plucenio e E. Camponogara, Automac\u00e3o da elevacao artificial com injec\u00e3o cont\u00ednua de g\u00f3s-Tend\u00eancias industriais e acad\u00eamicas, 4o. Congresso Brasileiro de P&amp;D em Petr\u00f3leo e G\u00e1as (PDPetro), Outubro de 2007, Campinas-SP;\n\u2014\tM. P. de Castro, E. Camponogara e A. Plucenio, Escalonamento de compressores em campos de petr\u00f3oleo operados por gas-lift:formula\u00e7ca\u00e3o linear por partes, 4o. Congresso Brasileiro de P&amp;D em Petr\u00f3leo e Gas (PDPetro), Outubro de 2007, Campinas-SP;\n\u2014\tA. Plucenio, D. J. Pagano, J.E. Normey-Rico, J. Pavei e C. Moya, Including Robustness in the MPC Cost Function, Congresso Brasileiro de Autom\u00e1tica, 2008, Juiz de Fora-MG.\n\u2014\tA. Plucenio, D. J. Pagano, E. Camponogara, H. F. Scherer e M. Lima, A simple distributed MPC algorithm, Congresso Brasileiro de Autom\u00e1atica, 2008, Juiz de Fora-MG.\n\u2014\tD. J. Pagano, A. Plucenio e C. A. Gonzaga, Controlling oscillations and re-starting operations in gas-lift wells, Congresso Brasileiro de Autom\u00e1tica, 2008, Juiz de Fora-MG.\n\u2014\tL. B. Resende, A. Plucenio e D. J. Pagano, CFD com controle aplicado na modelagem de um separador g\u00f3as-liquido em linha, 5o Congresso Brasileiro de Pesquisa e Desenvolvimento em Petr\u00f3leo e G\u00e1s (PDPetro), Outubro de 2009, Fortaleza-CE;\n\u2014\tA. Plucenio, Sistema de multiplos agentes no controle de processos de refino, 5o Congresso Brasileiro de Pesquisa e Desenvolvimento em Petr\u00e1oleo e G\u00e1as (PDPetro), Outubro de 2009, Fortaleza-CE.\nSubmetidos:\n\u2014\tA. Plucenio, D. J. Pagano e Cleber A. Ganzaroli, Din\u00e2mica do fen\u00f4meno density wave em po\u00e7os com elevac\u00e3o por gaslift, Congresso Brasileiro de Autom\u00e1tica, 2010, Bonito-MS.\n\u2014\tA. Plucenio, A simple distributed MPC algorithm II, Congresso Brasileiro de Autom\u00e1tica, 2010, Bonito-MS.\n\u2014\tA. Plucenio, D. J. Pagano, C. Ganzaroli, Modelos Dinamicos de Pocos operando via Gas-Lift Cont \u00ednuo, Rio Oil &amp; Gas Expo and Conference 2010.\nEm Congressos Internacionais:\n\u2014\tA. Plucenio, G. A. Mafra and D. J. Pagano, A control strategy for an oil well operating via gas-lift, ADCHEM 2006, Proceedings of the IFAC International Symposium on Advanced Control of Chemical Processes, 2006, volume II, Gramado, RS;\n\u2014\tD. J. Pagano, V. Dallangnol Filho, A.Plucenio, Identification of polinomial NARMAX models for an oil well operating by continuos gas lift, ADCHEM 2006, Proceedings of the IFAC International Symposium on Advanced Control of Chemical Processes, 2006, volume II, Gramado, RS;\n\u2014\tE. Camponogara, M. P. Castro, A. Plucenio, The facility location problem: model algorithm and application to compressor allocation, ADCHEM 2006, Proceedings of the IFAC International Symposium on Advanced Control of Chemical Processes, 2006, volume I, pag. 247-252, Gramado, RS;\n\u2014\tA. Plucenio, D. J. Pagano, A. H. Bruciapaglia, J. E. Normey-Rico, A practical approach to predictive control of nonlinear processes, Proceedings of the NOLCOS 2007-7th, IFAC Symposium on Nonlinear Control Systems, Pretoria-South Africa;\n\u2014\tE. Camponogara, M. P. de Castro, A. Plucenio, Compressor Scheduling in Oilfields: A Piecewise-Linear Formulation, Automation Science and Engineering, 2007. Case 2007. IEEE International Conference, Pages: 426-441, September 2007;\n\u2014\tE. Camponogara, A. Plucenio, Lift-gas allocation under precedence constraints: 1-configuration inequalities, Systems, Man and Cybernetic, 2007, IEEE International Conference, Pages:2727-2732, October 2007;\n\u2014\tA. Plucenio, D. J. Pagano, E. Camponogara, A. Traple, Gaslift Optimization and Control with Nonlinear MPC, AD-CHEM 2009, IFAC International Symposium on Advanced Control of Chemical Processes, July 12-15, 2009 Koc University, Istanbul, Turkey;\n\u2014\tH. Scherer, E. Camponogara and A. Plucenio, Distributed Optimization for Predictive Control of a Distillation Column with Output,Control-Input Constraints, ADCHEM 2009, IFAC International Symposium on Advanced Control of Chemical Processes, July 12-15, 2009 Koc University, Istanbul, Turkey;\n\u2014\tD. J. Pagano, A. Plucenio and A. Traple, Slug-flow Control in Submarine Oil-risers using SMC Strategies, ADCHEM 2009, IFAC International Symposium on Advanced Control of Chemical Processes, July 12-15, 2009 Koc University, Istanbul, Turkey;\nAp\u00eandice A\nIntrodu\u00e7\u00e3o ao Controle Preditivo Baseado em Modelo\nA.1 Introdu\u00e7\u00e3o\n->\nUma introducao \u00e0s t\u00e9cnicas de Controle Preditivo baseado em Modelo pode ser encontrada em [116], [77], etc. A id\u00e9ia da predi\u00e7\u00e3o para o c\u00e9lculo da a\u00e7ao de controle n\u00e3o \u00e9 nova. A a\u00e7\u00e3o derivativa do classico Controle PID utiliza uma forma de predi\u00e7\u00e3o atraves da a\u00e7ao derivativa expressa pelo termo kddy. O Preditor de Smith [117] ja utilizava uma forma de predicao para a compensa\u00e7\u00e3o do tempo morto. A ideia \u00e9 simples e intuitiva. Conhecendo o comportamento do sistema (modelo entrada-sa\u00edda) determinar a sequ\u00eancia de a\u00e7\u00e3es de controle a serem tomadas no futuro de forma a seguir uma trajet\u00f3ria desejada tambem conhecida com o m\u00ednimo de esfor\u00e7o. Aplicar a primeira a\u00e7\u00e3o da sequencia e no instante seguinte repetir o processo.\nUm bom exemplo da aplicac\u00e7\u00e3ao de controle preditivo para n\u00e3ao especialistas e aquele praticado pelo motorista de um automovel. Conhecendo o ve\u00edculo que dirige o motorista observa a pista desde o trecho que est\u00e9 logo a sua frente como aquele que est\u00e9 mais afastado e toma as a\u00e7\u00e3es necessarias para seguir sua trajet\u00f3ria. Se olhasse somente para o trecho logo a sua frente teria de fazer\nseguidos movimentos na dire\u00e7\u00e3o corrigindo a trajet\u00f3ria do ve\u00edculo. Olhando somente para o trecho mais afastado poderia deixar de fazer um seguimento correto e andar at\u00e9 mesmo na contramao. E olhando um trecho que vai desde os primeiros metros a frente do ve\u00edculo e alguma dist\u00e2ncia mais a frente que o motorista consegue seguir a trajet\u00e9ria com pequenos movimentos corretivos na dire\u00e7ca\u00e3o e na acelera\u00e7ca\u00e3o. O comprimento da pista ou o a dist\u00e2an-cia a ser percorrida sob an\u00e9lise representa aqui o horizonte de predi\u00e7c\u00e3ao.\nEm geral as t\u00e9ecnicas de controle preditivo baseado em modelo t\u00e2em em comum a minimiza\u00e7c\u00e3ao de uma fun\u00e7c\u00e3ao custo.\nSuponha que deseje-se fazer uma viagem de autom\u00e9vel de forma segura, confort\u00e9vel, r\u00e1pida e econ\u00e2mica. Para isto se enumeram os seguintes objetivos:\n\u2014\tseguir na pista da direita,\n\u2014\tterminar a viagem em tempo m\u00ednimo,\n\u2014\tseguir as praticas seguras e regras de tr\u00e2nsito obedecendo os limites de velocidade,\n\u2014\tfazer uma viagem confort\u00e9vel.\n\u2014\tgastar o m\u00e9nimo de combust\u00e9vel.\nSe o ve\u00e9culo fosse dotado de sensores e acionadores adequados poderia ser conduzido por um processador que minimizasse uma fun\u00e7ao objetivo na forma de uma express\u00e3o matem\u00e9tica. Mesmo atuando de forma manual o motorista age como se minimizasse uma func\u00e3o custo pois minimiza os desvios da trajet\u00e9ria mantendo-se na pista da direita. Minimiza o afastamento da velocidade ideal respeitando as restri\u00e7co\u00e3es impostas pela sinaliza\u00e7ca\u00e3o e dis-t\u00e2ancia m\u00e9nima do ve\u00e9culo a sua frente. Minimiza o desconforto adaptando a velocidade as condic\u00e7\u00e3oes da pista. Minimiza o gasto de combust\u00e9vel selecionando a marcha ideal para a velocidade do ve\u00e9culo e posic\u00e7\u00e3ao do pedal do acelerador.\nvelocidade ideal e h\u00f3 um peso para o n\u00edvel de solavancos, a mini-mizacao da fun\u00e7\u00e3o objetivo resulta na viagem com as caracter\u00edsticas desejadas.\nPara finalizar deve-se mencionar a necessidade do constante ajuste do modelo frente as oberva\u00e7\u00e3es ou medi\u00e7\u00f5es das vari\u00f3veis do processo. No exemplo da viagem do carro isto se manifesta, por exemplo, quando o motorista detecta que o ve\u00edculo sacoleja mais ou menos do que o previsto. Isto \u00e9 observado pelo motorista e ser\u00e9 levado em considera\u00e7\u00e3o nas sua predic\u00e3es futuras.\nO controle preditivo baseado em modelo (mpc) \u00e9 uma das t\u00e9cnicas de controle moderno mais potentes e provavelmente a que teve mais \u00eaxito em aplicac\u00e3es industriais [118] principalmente na industria do petr\u00f3leo. As principais causas deste exito devem-se a que as estrategias de mpc podem ser aplicadas tanto a sistemas monovari\u00e9aveis como multivariaveis lineares ou n\u00e3ao lineares, as restricoes nas sa\u00e9das e nas a\u00e7oes de controle podem ser consideradas no projeto da lei de controle em tempo real e, pela pr\u00e9opria definic\u00e7\u00e3ao dos algoritmos, podem ser usadas para controlar processos com atrasos [119].\nO mpc nao \u00e9 uma estrategia de controle espec\u00e9fica, mas \u00e9 o nome dado a um conjunto muito grande de m\u00e9etodos de controle que foram desenvolvidos considerando algumas ideias comuns baseadas no conceito de predi\u00e7\u00e3o. Na figura A.1 mostra-se a estrutura geral de um mpc onde pode ser observado o funcionamento do algoritmo: com o controle e o erro atuais e um modelo calcula-se primeiro a predi\u00e7c\u00e3ao da sa\u00e9da futura do processo; com estas informa\u00e7co\u00e3es um mo\u00e9dulo de otimiza\u00e7c\u00e3ao calcula o sinal de controle a ser aplicado ao processo no pr\u00e9oximo passo considerando a minimiza\u00e7ca\u00e3o de um determinado \u00e9ndice de desempenho e as restric\u00e7\u00e3oes nas varia\u00e9veis de processo e/ou de controle [48].\nA maioria dos sistemas reais t\u00f4m din\u00f4mica n\u00e3o linear, porem quando o processo opera numa pequena faixa ent\u00e3o a sua dinamica pode ser aproximada satisfatoriamente atrav\u00e9es de modelos lineares. Isto tem motivado a que muitas t\u00e9cnicas de mpc foram abordadas utilizando modelos lineares: Matriz Din\u00f4amica de Controle (dinamic matrix control-dmc), [120]; Controle Algor\u00edtmico Baseado em Modelo (model algorithm control-mac), [121]; Controle Preditivo Generalizado (generalized PREDICTIVE control-gpc), [122]); Controle Preditivo Adaptativo (extended PREDICTIVE SELF ADAPTIVE CONTROL-EPSAC), [123].\nFigura A.1: Diagrama de Blocos do Algoritmo de Controle Preditivo Baseado em Modelo\nS\u00e3o muitas as aplicacoes de controle baseadas em softwares comerciais que implementam LMPC nas refinarias de petroleo no Brasil e no mundo [48].\nAs principais vantagens do LMPC estao vinculadas as facilidades de obten\u00e7c\u00e3ao de modelos lineares, se comparados aos n\u00e3ao lineares, e as menores dificuldades para se resolver os problemas de otimiza-\u00e7c\u00e3ao associados. Porem, quando os processos t\u00e2em din\u00e2amica muito n\u00e3ao linear ou quando a faixa de opera\u00e7c\u00e3ao e variavel, ent\u00e3ao necessariamente devera ser tomado em conta o modelo n\u00e3ao linear no projeto do controle, de forma que permita manter o desempenho desejado para o sistema em malha fechada.\nDo ponto de vista conceitual o MPC nao linear (nmpc) n\u00e3o apresenta dificuldades. Considerando a mesma fun\u00e7ao objetivo (J) que no caso linear e um modelo n\u00e3o linear para o calculo das pre-di\u00e7co\u00e3es o objetivo consiste novamente em encontrar o controle que minimize a func\u00e7\u00e3ao objetivo num algoritmo de horizonte deslizante. Ja do ponto de vista pratico s\u00e3ao varias as dificuldades encontradas neste problema (se comparado ao caso linear): (a) a determinac\u00e7\u00e3ao do modelo do processo quando deve ser obtido por identifica\u00e7c\u00e3ao, (b) a obten\u00e7ca\u00e3o do sinal de controle requer, em geral, a solu\u00e7c\u00e3ao de um problema otimizac\u00e7\u00e3ao n\u00e3ao convexo e (c) a analise de estabilidade e robustez da solu\u00e7ao. Por estes motivos o NMPC e um campo aberto para pesquisas tanto na area de determinac\u00e3o de modelos como nos procedimentos e algoritmos de otimiza\u00e7c\u00e3ao para o calculo do controle [48, 124].\nA.2 Conceitos B\u00e1sicos de MPC\nOs algoritmos MPC possuem algumas caracter\u00edsticas comuns [48]: (a) usam um modelo expl\u00edcito do processo e das perturba\u00e7\u00f5es para predizer a sa\u00edda do mesmo num determinado horizonte finito; (b) calculam as a\u00e7\u00f5es de controle para todo o horizonte a partir da minimiza\u00e7\u00e3o de uma determinada fun\u00e7\u00f5o objetivo; (c) o horizonte e deslizante, pelo que para cada per\u00edodo de amostragem o horizonte e deslocado um passo para frente, aplica-se unicamente a a\u00e7c\u00f5ao de controle de aquele instante e desconsidera-se o resto dos controles dentro do horizonte.\nAs diferencas entre os diversos algoritmos existentes devem-se basicamente \u00e0 forma de escolher os modelos para o processo e as perturba\u00e7co\u00f5es, ao tipo de fun\u00e7ca\u00f5o objetivo e ao procedimento para manipular as restric\u00f5es e o calculo do controle [125].\nO modelo de predi\u00e7c\u00f5ao e provavelmente o elemento mais importante dentro do controlador dado que ele deve ser capaz de representar adequadamente a dinamica do processo para permitir o calculo das predi\u00e7oes da sua sa\u00edda, ser intuitivo e ao mesmo tempo permitir uma analise teorica do sistema. As diferentes estrategias de MPC utilizam diferentes formas para representar as rela\u00e7co\u00f5es entre entradas manipuladas, perturba\u00e7\u00f5es e sa\u00eddas do processo. Em geral o modelo \u00e9 separado em duas partes: no modelo do processo propriamente dito e no modelo das perturba\u00e7c\u00f5oes; ambos necessarios para o calculo das predi\u00e7c\u00f5oes. Os modelos lineares s\u00f5ao os mais usados na pratica para representar o processo e podem ser de entrada sa\u00edda (resposta impulsiva, resposta ao degrau e fun\u00e7ao de transfer\u00eancia) ou de variaveis de estado.\nOs modelos de resposta impulsiva ou ao degrau s\u00f5ao bastante utilizados na pratica por oferecem as seguintes vantagens: (a) s\u00e3o intuitivos e podem ser usados em plantas multivariaveis sem acrescentar complexidade; (b) quando identificados n\u00e3o precisam de conhecimento a-priori do processo e (c) descrevem de maneira simples efeitos mais complexos da dina\u00eamica do processo como atrasos e comportamentos de fase n\u00e3o minima. Por outro lado apresentam alguns inconvenientes: (a) na\u00f5o podem ser usados com plantas instaveis e (b) necessitam utilizar um grande numero de par\u00eaametros para descrever o modelo, sobre tudo se o processo tiver um atraso grande.\nO modelo de func\u00e7\u00e3ao de transfer\u00eaencia tem como vantagens prin-\ncipais que pode ser usado para plantas instaveis e que precisa, em geral, de poucos para\u00e2metros para descrever o comportamento do sistema (o atraso, por exemplo, pode ser descrito apenas com um par\u00e2metro). Ja seu principal inconveniente \u00e9 a necessidade de conhecer a priori a ordem dos polinomios numerador e denominador quando o modelo deve ser identificado a partir de dados experimentais.\nOs modelos de espa\u00e7co de estados podem ser usados diretamente para processos multivariaveis e n\u00e3o lineares. Como inconvenientes cabe mencionar que em geral os estados n\u00e3o tem significado f\u00edsico e que na maioria das vezes e necessario o uso de observadores, aumentando assim a complexidade de calculo do controle.\nOs modelos n\u00e3ao lineares s\u00e3ao geralmente usados para descrever a din\u00e2amica do processo quando os modelos lineares n\u00e3ao geram bons resultados. Modelos fenomenologicos [126], emp\u00edricos [127], redes neurais [128] ou logica nebulosa [129] podem ser usados em agumas aplica\u00e7c\u00e3oes para determinar o modelo de predic\u00e7\u00e3ao. O inconveniente no uso destes modelos e a maior complexidade tanto no procedimento de obtenc\u00e7\u00e3ao do modelo do processo quanto no c alculo da lei de controle.\nA escolha de um modelo para as perturba\u00e7c\u00e3oes e t\u00e3ao importante quanto a do processo. O modelo mais utilizado para a descri\u00e7ca\u00e3o de perturba\u00e7c\u00e3oes deterministicas e estocasticas e o conhecido como modelo autoregressivo integrado de media movel (Auto-Regressive and Integrated Moving Average, ARIMA) [122]. Este modelo permite representar mudan\u00e7as aleatorias, \u201doff-sets\u201de outros fen\u00e2-menos normalmente encontrados no meio industrial.\nA fun\u00e7c\u00e3ao objetivo a ser minimizada pode ter diferentes formas mas a mais utilizada e do tipo quadratica contendo o somatorio do quadrado do erro entre uma trajetoria desejada e a trajetoria obtida ao longo de um horizonte de predi\u00e7c\u00e3ao e o somatorio do quadrado dos incrementos de a\u00e7c\u00e3ao de controle em um horizonte de controle [125].\nSeja\n-\tJ uma func\u00e3o custo;\n-\tk a denominac\u00e7\u00e3ao do instante de tempo ou amostra atual, k \u2014 1o instante anterior e k + j o instante j depois do atual;\n-\tp o horizonte de predic\u00e3o ou numero de amostras depois da amostra atual onde as predi\u00e7c\u00e3oes e trajet orias futuras s\u00e3ao\n(A.1)\nconsideradas;\n-\tm o horizonte de controle ou numero de amostras onde as entradas s\u00e3ao manipuladas para minimizar a func\u00e7\u00e3ao custo;\n-\ty(k + j/k) a sa\u00edda y no instante j depois do instante atual k calculada com o modelo do sistema;\n-\tAu(k + i) a varia\u00e7\u00e3o na a\u00e7\u00e3o de controle no instante (k + i) com relac\u00e3o a a\u00e7\u00e3o de controle no instante anterior u(k + i \u2014 1). Ou seja Au(k + i) = u(k + i) \u2014 u(k + i \u2014 1).\nUma func\u00e7\u00e3ao custo gen\u00e9erica \u00e9e dada pela equac\u00e7\u00e3ao (A.1) onde o termo Jseg. ref. leva em conta o seguimento de refer\u00eancia e o termo Jesf. cont. o esfor\u00e7o de controle.\nJ\tJseg. ref. + Jesf. cont\nPara um sistema com uma entrada e uma sa\u00edda (SISO - Single Input Single Output) uma fun\u00e7\u00e3o custo t\u00edpica \u00e9 a apresentada na equac\u00e7a\u00e3o (A.2).\nNi+p-1\tm\u20141\nJ =\tYj(y(k + j) \u2014 r(k + j))2 +\tXiAu(k + i)2. (A.2)\nj=Ni\ti=0\nNa equacao (A.2) e Xj s\u00e3o as pondera\u00e7\u00f5es, respectivamente sobre o seguimento de refer\u00eancia e o esfor\u00e7o de controle. Em muitos casos as pondera\u00e7c\u00e3oes para o caso SISO sa\u00e3o constantes. N1 \u00e9 o numero de amostras que determina o in\u00e9cio do horizonte de predi\u00e7\u00e3o. O problema a ser resolvido \u00e9 obter o vetor Au = [ Au(k) Au(k + 1) \u2022\u2022\u2022 Au(k + m \u2014 1) ] que minimiza a fun\u00e7\u00e3o Custo J sujeito a restri\u00e7c\u00e3oes sobre os incrementos de controle Au, as a\u00e7\u00e3es de controle u = [ u(k) u(k + 1) \u2022\u2022\u2022 u(k + m \u2014 1) ] e a sa\u00e9da predita y(k + j) = [ y(k + 1) y(k + 2) \u2022\u2022\u2022 y(k + p) ]T.\n\u2014 Modelo dinamico do sistema\n\u2014\tModelo da perturba\u00e7ao\n\u2014\tFuncao Custo\n\u2014\tForma de obtencao da Lei de Controle\nPara sistemas din\u00e2amicos representados por modelos entrada-sa\u00e9da lineares os modelos dina\u00e2micos mais comuns s\u00f5ao:\n\u2014\tRepresenta\u00e7ao por Resposta ao Impulso\n\u2014\tRepresenta\u00e7ao por Resposta ao degrau\n\u2014\tRepresenta\u00e7\u00f5o por Funcao de Transfer\u00e2ncia\nA.2.1 Tipos de Controle Preditivo para Sistemas Lineares\nOs tipos de controle preditivo mais conhecidos s\u00f5o:\nModel Predictive Heuristic Control ou Model Algorithmic Control (MAC) - Utiliza o modelo do sistema baseado na resposta ao impulso. Por basear-se na resposta ao impulso \u00e9e um m\u00e9etodo de controle preditivo v\u00e9alido para sistemas est\u00e9aveis. A trajet\u00f3ria \u00e9 desejada tem uma dinamica de primeira ordem que evolui desde a sa\u00edda atual ate a refer\u00e2ncia desejada. Os horizontes de predic\u00e7a\u00f5o e controle s\u00f5ao iguais.\nDynamic Matrix Control - Utiliza o modelo do sistema baseado na resposta ao degrau.\nPredictive Functional Control (PFC) - Utiliza modelo do tipo equa\u00e7ca\u00f5o de estados e \u00e9e aplic\u00e9avel a processos lineares e n\u00f5o lineares, est\u00f3veis e inst\u00f3veis. No lugar de buscar o seguimento de refer\u00e2encia ao longo do horizonte de predic\u00e7a\u00f5o, este m\u00e9etodo busca a coincid\u00e2encia das predi\u00e7c\u00f5oes com alguns pontos da trajet\u00f3ria desejada. A acao de controle consiste em uma combina\u00e7ca\u00f5o de fun\u00e7co\u00f5es base pr\u00e9e-selecionadas.\nExtended Prediction Self Adaptive Control - Utiliza modelo baseado em Fun\u00e7c\u00f5ao de Transfer\u00e2encia. Uma caracter\u00f3stica marcante deste m\u00f3etodo \u00f3e que o horizonte de controle \u00f3e igual a 1.\nGeneralized Predictive Control (GPC) - M\u00e9todo proposto por Clarke et al. [130]. Utiliza o modelo CARIMA para as predi\u00e7c\u00f5oes. Um aspecto importante do algoritmo GPC \u00f3e a forma como trata o erro de modelagem. As predi\u00e7c\u00f5oes incorporam a integral do erro filtrado.\nA.2.2 DMC - Dynamic Matrix Control\nDesenvolvido nos anos setenta por Cutler e Ramaker da empresa Shell, a t\u00e9cnica de Controle Preditivo DMC \u00e9 uma das mais utilizadas na indUstria, principalmente em petroqu\u00edmicas [116]. A tecnica de controle preditivo DMC (Dynamic Matrix Control) utiliza a representac\u00e3o do modelo da planta na forma nao param\u00e9trica. As sa\u00eddas da planta sao calculadas baseadas na resposta ao degrau unit\u00e9rio de cada entrada. Para um sistema de uma entrada e uma sa\u00e9da est\u00e9avel e linear pode-se escrever\ny(k) =\t9iAu(k - i) + n(k),\t(A.3)\ni=1\nonde g-\u00ed s\u00e3o os elementos do vetor resposta ao degrau unitario na entrada. Utilizando-se a equac\u00e3o (A.3) para escrever-se a predic\u00e3o da sa\u00edda y em um instante j unidades de tempo de amostragem futuros t\u00eam-se\ny(k + j/k) = ^2 9iAu(k + j - i) + n(k + j/k)\t(A.4)\ni=1\nA equac\u00e3o (A.4) pode ser reescrita dividindo-se o tempo entre 1 : j e (j + 1) : to.\nj\ny(k +j/k) =\tg\u00edA\u00ab(k +j - i)+\tgi^u(k +j - i)+ n(k+j/k)\n\u00ed=1\ti=j+1\n(A.5) Deve-se observar que se substitu\u00e9mos os limites do somato\u00e9rio do primeiro termo a direita da equa\u00e7\u00e3o (A.5) verifica-se que este termo representa a contribui\u00e7ao das entradas [Au(k), ... Au(k + j - 1)] na sa\u00e9da do processo enquanto que o segundo termo representa o efeito de todas as entradas desde (k - 1) at\u00e9 (k + j - to) ou (-to). Ou seja, o primeiro termo representa a mudan\u00e7a do processo devido as mudanc\u00e7as nas a\u00e7c\u00e3oes de controle futuras enquanto o segundo termo representa a sa\u00e9da do processo no instante (k + j) devido as entradas que ocorreram at\u00e9 o momento (k - 1). A t\u00e9ecnica DMC sup\u00e3oe que os erros de modelagem ou perturba\u00e7\u00f5es futuras n(k + j/k) s\u00e3o todas iguais a que ocorreu no\ninstante k, ou n(k). Ent\u00e3o\n+ j/k) = ym(k) - y(k/k),\t(A.6)\nonde ym(k) \u00e9 o valor da sa\u00edda real no instante k, mas\nn(k + j/k) = ym(k) - 529iAu(k - i) e\t(A.7)\ni=1\nsubstituindo-se (A.7) em (A.5) tem-se\nj\ny(k+j/k) = ^2 9iAu(k+j-i)+ ^2 9iAu(k+j-i)+y m (k)-\t9iAu(k-i).\ni=1\ti=j+1\ti=1\n(A.8)\nOs tr\u00eas Ultimos termos da equa\u00e7\u00e3o (A.8) podem ser combinados e t\u00eam-se\nj\ny(k + j/k) =\t9iAu(k + j - i) + f (k + j)\t(A.9)\ni=1\nonde\nf (k + j) = ym(k) ^2(9j+i - 9i)Au(k - i)\t(A.10)\ni=1\nEntretanto como os elementos gi da resposta ao degrau unitario de um sistema estavel convergem em um determinado numero de amostras N pode-se truncar o somat\u00f3rio da equa\u00e7ao (A.10) em N ja que 3 N tal que gN+1 = 9n\u2022 Com esta considera\u00e7ao a equa\u00e7ao (A.10) \u00e9 reescrita como\nN\nf (k + j) = ym(k) + ^2(9j+i - 9i)Au(k - i)\t(A.11)\ni=1\nbem manipulados. Da\u00ed surge a ideia do horizonte de controle m. Pode-se perceber que se o o horizonte de controle for muito pequeno estaremos tirando graus de liberdade da ac\u00e7\u00e3ao de controle e as acoes de controle tendem a tornar-se mais ativas. Horizontes de Controle menores facilitam o calculo da a\u00e7\u00e3o de controle. Ja o horizonte de predi\u00e7c\u00e3ao determina o intervalo de tempo futuro sobre o qual se quer ter controle. Escrevendo-se a expressao (A.9) expandida considerando-se o horizonte de controle m e o horizonte de predi\u00e7ao p t\u00e2m-se\ny(k + 1/k)\t\u2014\tgiAu(k)\t+\tf (k + 1)\ny(k + 2/k)\t\u2014\tg2Au(k)\t+\tgiAu(k + 1)\t+ f (k + 2)\ny(k + 3/k)\t\u2014\tg3Au(k)\t+\tg3Au(k + 1)\t+ giAu(k + 2) + f (k + 3)\ny(k + p/k)\t\u2014\tgpAu(k)\t+\tgp_iAu(k +\t1) + ... + gp-m+\u00edAu(k + m - 1) -\nO conjunto de equa\u00e7\u00f5es (A.12) pode ser reescrito em uma forma compacta pela equa\u00e7c\u00e3ao (refdmccom).\nY \u2014 F + GAu,\t(A.13)\nonde G e a Matriz Dinamica definida pela equac\u00e3o (A.15).\ngi\t0\t... 0\n92\tgi\t... 0\n\t\t... 0\ngm\tgm-1\t. . .\tg1\ngP\tgP-i\t. . .\tgp-m+1\n(A.14)\ny(k + 1/k)\ny(k + 2/k)\ny(k + p/k)\n(A.15)\nf (k + 1) f (k + 2)\nf (k + p)\nAu =\nAu(k)\nAu(k + 1)\nAu(k + m \u2014 1)\n(A.16)\n(A.17)\nUtilizando-se a forma de expressar as predic\u00e7\u00e3oes com a equac\u00e7\u00e3ao (A.13) pode-se tambem reescrever a fun\u00e7c\u00e3ao objetivo dada pela equac\u00e7\u00e3ao (A.2) em uma forma mais compacta como\nJ = (Y \u2014 W)T R(Y \u2014 W) + AuT QAu,\t(A.18)\nou\nJ =\t(F + GAu \u2014 W)T R(F + GAu \u2014 W) + AuT QAu\nonde R e uma matriz diagonal contendo as ponderac\u00e7\u00e3oes sobre o seguimento de refer\u00e2encia ao longo do horizonte de predic\u00e7a\u00e3o, W e o vetor contendo as trajet\u00f3rias futuras desejadas no horizonte de predic\u00e7a\u00e3o e Q e uma matriz diagonal contendo as pon-dera\u00e7co\u00e3es sobre o esfor\u00e7co de controle. A express\u00e3ao (A.1) e valida para sistemas com multiplas entradas e multiplas sa\u00e1das (Sistemas MIMO-Multiple Inputs Multiple Output) como tambem para sistemas com uma entrada e uma sa\u00e1da (Sistemas SISO-Single Input Single Output). Para os sistemas com uma entrada e uma sa\u00e1da \u00e1e comum considerar R como a matriz identidade e a matriz Q = AI\u201e \u201e . Neste caso a expressao (A.1) transforma-se em\nJ = (F + GAu \u2014 W)T (F + GAu \u2014 W) + \u00c0AuT A(A.19)\nNo caso de sistemas MIMO com Ne entradas e Ne sa\u00e1das, a matriz G sera composta por NeNs submatrizes, o vetor F sera composto de Ns vetores e o vetor Au por Ne vetores. Como exemplo, para um sistema com 2 entradas e 2 sa\u00e1das t\u00e2em-se\nYi\nY2\nF1\t+\tG11\tG12\t\tAu1\nF2\t\tG21\tG22\t\tAu2\n(A.20)\nA minimizac\u00e7\u00e3ao da fun\u00e7c\u00e3ao custo para o caso sem restric\u00e7o\u00e3es pode ser obtida igualando-se a zero o gradiente da fun\u00e7c\u00e3ao Custo dada pela equa\u00e7\u00e3o (A.1), dd^\u00fc = 0.\nd J\n\u2014\u2014 = 2GtRGAu + 2GtRF \u2014 2GtRW + 2QAu (A.21) dAu\nIsolando-se Au obt\u00f3m-se ;\nAu = (Gt RG + Q)- 1Gt R(W \u2014 F)\t(A.22)\nComo g^\u00fc2 = 2(GtRG + Q) e R e Q sa\u00e3o matrizes diagonais com elementos positivos, ent\u00e3o 9\\'\u00fc2 \u00f3 definida positiva e o m\u00ednimo encontrado \u00ede um m\u00ednimo global.\nNa presen\u00e7ca de restric\u00e7\u00e3oes sobre a ac\u00e7\u00e3ao de controle ou sobre a pro\u00edpria sa\u00edda a minimiza\u00e7c\u00e3ao da func\u00e7a\u00e3o Custo \u00ede obtida com a aplicac\u00e3o de algoritmos de Programa\u00e7\u00e3o Quadr\u00edtica. Estes algoritmos resolvem problemas do tipo\nmin xT $x + 0T x\t(A.23)\nx\nsujeito a\nAx &lt;b\nManipulando-se a fun\u00e7ao Custo definida na equacao (A.1) pode-se coloc\u00ed-la no formato da equa\u00e7ao (A.23) fazendo-se\n$ = Gt RG + Q,\t(A.24)\ne\n0 = Gt Rt (F \u2014 W).\nAs restri\u00e7c\u00e3oes podem ser aplicadas tanto sobre as entradas como sobre as sa\u00eddas. Sobre as entradas pode-se aplicar restri\u00e7\u00f5es tanto na taxa de mudan\u00e7ca da a\u00e7c\u00e3ao de controle como em seus valores m\u00edaximos e m\u00ednimos. Para denotar a restric\u00e7\u00e3ao de que as varia\u00e7c\u00e3oes m\u00edaximas da a\u00e7c\u00e3ao de controle em um intervalo de tempo igual a um per\u00edodo de amostragem sejam aquelas que o elemento atuador pode fornecer, (Aumin &lt;Au &lt;Aumax), escreve-se para o caso\nSISO\nIAu&lt;\nIAu&lt;\t\u00c2Umin1,\n(A.25)\nonde I \u00e9 a matriz identidade de dimens\u00e3o m x m e 1 \u00e9 um vetor de dimens\u00e3o m x 1 com todos elementos iguais a 1.\nPara a aplica\u00e7\u00e3o de restric\u00e3es sobre u escreve-se\nu = u(k \u2014 1)1 + DAu,\n(A.26)\nonde D e uma matriz triangular inferior m x m com todos os elementos n\u00e3o nulos iguais a 1. Para expressar que umin. &lt;u &lt;umax. escreve-se\nDAu&lt;\t(umax \u2014 u(k \u2014 1))1\t(A.27)\n\u2014DAu &lt;(\u2014umin + u(k \u2014 1))1,\nPara introduzir restri\u00e7\u00e3es sobre a sa\u00edda do tipo ymtn. &lt;y &lt;ymax., escreve-se Y = F + GAu e\nGAu &lt;ymax1 \u2014 F\t(A.28)\n\u2014 GAu&lt;\t\u2014 ymin1 + F,\nTodas as restric\u00e3es podem ser expressas montando-se uma matriz A e B tal que AAu &lt;B.\nA =\nI \u2014I D \u2014D\nG \u2014G\n(A.29)\nAu\nmax\n1\nAumin 1\nB =\n(umax\tu(k\tl))1\n( umin + u(k\t1))1\nVm^ax1\tF\nymin 1 + F\n(A.30)\nPara o caso de m\u00faltiplas entradas e m\u00faltiplas saldas pode-se igualmente montar matrizez A e B de forma a expressar as restricoes sobre todas as entradas e saldas. Por exemplo, para o caso de 2 entradas ui e u2 e 2 saldas y1 e y2,\nA =\nI\t0mxm\n0mxm\tI\n-I\t0mxm\n0mxm\t-I\nD\t0mxm\n0mxm\tD\n-D\t0mxm\n0mxm\t-D\nGii\tGi2\nG2i\tg22\n-Gii\t-Gi2\n-G2i\t-G22\n(A.3l)\nB=\nAumax 1mx 1\nAumax 1mx 1\n- Aumin1mx1\nAumin 1m x 1 (u1max ~U1(k - 1))1mx1 (u2max -u2(k - 1))1mx1 (-u1min + u1(k - 1))1mx1 (-u2min + u2(k - 1))1mx1\n\u201e,1\ti\trpl\nymax1px1\tF px1\n\u201e,2\ti\t_ T72\nymax1px1\tF px1\nymin1px1 + F px1 ymin1px1 + F px1\n(A.32)\nonde 0 \u00e9 uma matriz de zeros, I \u00e9 uma matriz identidade m x m, D e uma matriz triangular inferior m x m com todos elementos n\u00e3o nulos iguais a 1 e Gy e uma das submatrizes que compoem\na matriz G e que relaciona a sa\u00e9da i com a entrada j.\nA facilidade com que as restri\u00e7c\u00e3oes s\u00e3ao introduzidas no ca\u00e9lculo da a\u00e7c\u00e3ao de controle quando utiliza-se Controle Preditivo, a facilidade com que os problemas multivari\u00e9aveis s\u00e3ao tratados faz com que a cada dia aumente-se a utiliza\u00e7c\u00e3ao desta t\u00e9ecnica no controle de Processos. Dentre as diversas formula\u00e7co\u00e3es, produtos baseados na t\u00e9cnica DMC ainda s\u00e3o os mais utilizados no setor downstream da indu\u00e9stria do petr\u00e9oleo.\nReferencias\nB ibliograficas\n[1]\tBin Hu. Characterizing gas-lift instabilities. Master's thesis, Department of Petroleum Engineering and Applied Geophysics, Norwegian University of Science and Technology University, Trondheim, Norway, 2004.\n[2]\tS.R.V. Campos et al. Spe99956 right-time decision of artificial-lift management for fast loop control. 2006 SPE Intelligent Energy Conference and Exhibition, 2006.\n[3]\tW. S. Going et al. Spe99834 intelligent-well technology: Are we ready for closed-loop control? 2006 SPE Intelligent Energy Conference and Exhibition, 2006.\n[4]\tL.A. Saputelli et al. Spe83798 promoting real time optimization of hydrocarbon-producing system. 2003 Offshore Europe Conference, September, 2003.\n[5]\tM. McCelvey et al. Spe88506 intelligent well system with hydraulic adjustable chokes and permanent monitoring improves conventional esp completion for an operator in ecuador. 200f Asia Pacific Oil and Gas Conference and Exhibition, October, 2004.\n[6]\tC. Oberwinker et al. Spe96645 real time information to the engineer's desktop-how murphy e&amp;p improved production management. 2005 Offshore Europe Conference, September, 2005.\n[7]\tL. J. Durlofsky P. Sarma and K. Aziz. Spe94241 efficient closed-loop production optimization under uncer-\ntainty. 2005 SPE Europe/EAGE Annual Conference, June,\n2005.\n[8]\tD. B. Silin et al. Spe95685 waterflood surveillance and control: Incorporating hall plot and slope analysis. 2005 SPE Annual Technical Conference and Exhibition, October,\n2005.\n[9]\tM. Hauser T. Unneland. Spe96390 real time manage-ment:from vision to engagement-an operator\u2019s experience. 2005 SPE Annual Technical Conference and Exhibition, October, 2005.\n[10]\tM. F. Silva Jr. et al. Spe95917 technologies trials of intelligent field implementation in carm\u00f3polis field. 2005 SPE Annual Technical Conference and Exhibition, October, 2005.\n[11]\tM. J. Economides, A. D. Hill, and C. E. Economides. Petroleum Production Systems. Prentice Hall, Inc., 1994.\n[12]\tCamponogara E. Nakashima P. Otimiza\u00e7ao da aloca\u00e7\u00e3o de g\u00f3s de inje\u00e7\u00e3o para um conjunto de po\u00e7os operando via gas-lift. XV Congresso Brasileiro de Automdtica-CBA 2004,\n2004.\n[13]\tP. Nakashima P. and E. Camponogara. Alocacao \u00f3tima de taxas de injeca\u00e3o de gas-lift utilizando programac\u00e3ao linear inteira mista. Petro &amp; Quimica 263, 2004.\n[14]\tE. Camponogara and A. Deconto. Gas-lift allocation under precedence constraints:piecewise-linear formulation and k-covers. 44 IEEE Conference on Decision and Control, and The European Control Conference, 2005.\n[15]\tP. Nakashima and E. Camponogara. Optimization of liftgas allocation using dynamic programming. IEEE Transactions on Systems, Man, and Cybernetics-Part A, 2005,\n2005.\n[16]\tAlarc\u00f3n G.A., Torres C. F., and G\u00f3mez E. Global optimization of gas allocation to a group of wells in artificial lift using nonlinear programming. Journal of Energy Resources Technology, 124 : 262 \u2014 268, December-2002.\n[17]\tY.Tang. Transient dynamic characteristics of gas-lift unloading. Master's thesis, University Tulsa, Tulsa, USA,\n1998.\n[18]\tN. Petalas and K. Aziz. A mechanistic model for multiphase flow in pipes. 4-9 Annual Technical Meeting of the Petroleum Society of the Canadian Institute of Mining, Metalurgy and Petroleum, 1998.\n[19]\tY. Chen. Modeling gas-liquid flow in pipes:flow pattern transitions and drift-flux modeling. Master's thesis, University of Stanford, Stanford, USA, 2001.\n[20]\tScandpower Petroleum Technologies. Olga 2000 v. 4-10 User Manual. Scandpower P. T., Kjeller, Norway, 2003.\n[21]\tG. Defaye L. Caralp and C. Vidal. Dynamic behaviour of a gas-lift simulator. European Symposium on Computer Aided Process Engineering-2, 2002.\n[22]\tB. Jansen et al. Automatic control of unstable gas lift wells. SPE Annual Technical Conference and Exhibition, Outubro\n1999.\n[23]\tGisle Otto Eikrem, Bjarne Foss, Lars Imsland, Bin Hu, and Michael Golan. Stabilization of gas lifted wells. Proceedings of the IFAC 15th World Congress, Barcelona, 2002.\n[24]\tLars Imsland, Gisle Otto Eikrem, and Bjarne Foss. State feedback control of a class of positive systems: Application to gas lift control. ECC\u201903, Cambridge, 2003.\n[25]\tA. Plucenio. Automa\u00e7ao da produ\u00e7\u00e3o de pocos de petr\u00f3leo operando com eleva\u00e7ao artificial por injecao cont\u00ednua de g\u00e1s. Master's thesis, Programa de Pos-Gradua\u00e7\u00e3o em Engenharia El\u00edetrica, Universidade Federal de Santa Catarina, Florian\u00edopolis, 2003.\n[26]\tA. Plucenio, D. J. Pagano, and J. Normey-Rico. Au-toma\u00e7ca\u00e3o de um grupo de po\u00e7cos de petr\u00edoleo operando com elevac\u00e3o cont\u00ednua de gas. II Congresso Brasileiro de P&amp;D em Petr\u00f3leo e Gas, 2003.\n[27]\tA. Plucenio, D. J. Pagano, and J. Normey-Rico. Controle robusto aplicado \u00e0 produ\u00e7\u00e3o de petr\u00f3leo por eleva\u00e7ao artificial tipo Gas-Lift. XV Congresso Brasileiro de Autom\u00e1tica-CBA 2004, 2004.\n[28]\tL. Sin\u00e8gre et al. Distributed model for density wave dynamics in gas-lifted wells. 44 IEEE Conference on Decision and Control, and European Control Conference, Dec. 2005.\n[29]\tD. J. Pagano, V. D. Filho, and A. Plucenio. Identification of polynomial narmax models for an oil well operating by continuous gas-lift. International Symposium on Advanced Control of Chemical Process-ADCHEM 2006, pages 1113\u2014 1118, 2006.\n[30]\tA. Plucenio, D. J. Pagano, and G. A. Mafra. A control strategy for an oil well operating via gas lift. International Symposium on Advanced Control of Chemical Process-ADCHEM 2006, pages 1081-1086, 2006.\n[31]\tGisle Otto Eikrem, Bjarne Foss, and Lars Imsland. Stabilization of gas lifted wells based on state estimation. IFAC ADCHEM 2003, Hong Kong, 2004.\n[32]\tL. S. Imsland, B. A. Foss, and G. O. Eikrem. State feedback control of a class of positive systems: Application to gas lift stabilization. Cambridge, United Kingdom, 2003.\n[33]\tL. Sinegre. Etude des instabilit\u00f3es dans les puits activ\u00f3es par gas-lift. Master's thesis, Ecole des Mines de Paris, Paris, France, 2006.\n[34]\tAdalberto J. Rosa and Renato de S. Carvalho. Previs\u00e3o de comportamento de reservat\u00e1orios de petro\u00e1leo. Editora Interciencia Ltda., 2002.\n[35]\tA.R. Hasan, C.S. Kabir, and M. Sayarpour. A basic approach to welbore two-phase flow modeling. pages 384-389, Anaheim-California-U.S.A., 2007.\n[36]\tE. Camponogara, A. Plucenio, A. F. Teixeira, and S. R. V. Campos. An automation system for gas-lifted oil wells: Model identification, control, and optimization. Journal of Petroleum Science and Technology, 2009.\n[37]\tE.L. Rawlins and M.A. Schellhardt. Backpressure Data on Natural Gas Wells and Their Application to Production Practices. In Monograph Series-USBM, 1935.\n[38]\tH.H. Evinger and M. Muskat. Calculation of Theoretical Productivity Factor. In Proc. Trans. AIME, 1942.\n[39]\tW.E. Gilbert. Flowing and Gas-Lift Well Performance. In Drilling and Production Practice, API, 1954.\n[40]\tR. Raghavan. Well Test Analysis. In Petroleum Engineering Series, Englewood Cliffs, New Jersey-USA, 1993.\n[41]\tJ.M. Richardson and A.H. Shaw. Two-Rate IPR Testing-A Practical Production Tool. In JCPT, March-April 1982.\n[42]\tY.D.C. Maravi. NEW INFLOW PEFORMANCE RELATIONSHIPS FOR GAS CONDENSATE RESERVOIRS. Master's thesis, Texas A and M University, 2003.\n[43]\tJ.R.C. Torrico. Desenvolvimento anal\u00edtico das curvas IPR a partir de um simulador de reservat\u00f3rios. Master's thesis, Universidade Estadual de Campinas, 1995.\n[44]\tA. Plucenio, D. J. Pagano, E. Camponogara, A. Traple, and A. Teixeira. Gas-lift optimization and control with nonlinear mpc. International Symposium on Advanced Control of Chemical Process-ADCHEM 2009, 2009.\n[45]\tF. Giri, F.Z. Chaoui, M. Haloua, Y. Rochdi, and A. Naitali.\nHammerstein model identification.\t10th Mediterranean\nConference on Control and Automation - MED2002, July-2002.\n[46]\tManabu Kano and Morimasa Ogawa. The state of the art in advanced chemical process control in japan. In AD-CHEM\u201909: Proceedings of the International Symposium on Advanced Control of Chemical Processes, pages Part I,11\u2014 26, 2009.\n[47]\tA. Plucenio, D. J. Pagano, E. Camponogara, H. F. Scherer, and M. Lima. A simple distributed mpc algorithm. XVII Congresso Brasileiro de Autom\u00e1tica,, 2008.\n[48]\tE.F. Camacho and C. Bordons. Model Predictive Control. Springer, Berlin, 2004.\n[49]\tA. Plucenio, D. J. Pagano, A. H. Bruciapaglia, and J. E. Normey-Rico. A practical approach to predictive control for nonlinear processes. NOLCOS 2007 - 7th IFAC Symposium on Nonlinear Control Systems, 2007.\n[50]\tA. Plucenio, J. E. Normey-Rico, and A. H. Bruciapaglia. Controle preditivo n\u00e3o linear na industria do petr\u00f3leo e g\u00e1s. 40 Congresso Brasileiro de P e D em Petr\u00f3leo e Gas, 2007.\n[51]\tJonas Berge. Fieldbus for Process Control: Engineering, Operation, and Maintenance. ISA-The Instrumentation, Systems, and Automation Society, Reasearch Triangle Park, NC,USA, 2001.\n[52]\tD. P. Bertsekas. Nonlinear Programming. Athena Scientific, 1995.\n[53]\tDimitri P. Bertsekas. Constrained Optimization and Lagrange Multiplier Methods (Optimization and Neural Computation Series). Athena Scientific, 1 edition, 1996.\n[54]\tA. Plucenio. Sistema de mu\u00f3ltiplos agentes no controle de processos de refino. 5o. Congresso Brasileiro de P&amp;D em Petr\u00f3leo e Gas, Outubro-2009.\n[55]\tR. Findeisen and F. Allgower. An introduction to nonlinear model predictive control. 21st Benelux Meeting on Systems and Control, pages 229-237, 2002.\n[56]\tMark Cannon. Efficient nonlinear model predictive control algorithms. Annual Reviews in Control, 28:229-237, 2004.\n[58]\tJ.E.S. Santos. Controle Preditivo nao Linear para Sistemas de Hammerstein. Tese de doutroado. UFSC., 2005.\n[57]\tH.H.J. Bloemen, T.J.J. van den Boom, and H.B. Verbruggen. Model-based predictive control for hammerstein systems. In Proceedings of the 39th IEEE Conference on Decision and Control. Sydney, Australia, 2000.\n[59]\tV. Balakrishnan M.V. Kothare and M. Morari. Robust constrained model predictive control using linear matrix inequalities. Automatica, 32:1361-1379, 1996.\n[60]\tJ.Y. Choi W.K. Son and O.K. Kwon. Robust predictive control of uncertain nonlinear systemv with constrained input. Transaction on Control, Automation and Systems Engineering, 4:289-295, 2002.\n[61]\tV. Sakizlis A.M. Manthanwar and E.N. Pistikopoulos. Robust parametric predictive control design for polytopically uncertain systems. American Control Conference, 2005.\n[62]\tY.Lu and Y.Arkunl. A scheduling quasi-minmax mpc for lpv systems. American Control Conference, pages 22722276, 1999.\n[63]\tY.Lu and Y.Arkunl. A practical multiple model adaptive strategy for single-loop mpc. Control Engineering Practice, 11:141-159, 2003.\n[64]\tP.J. Campo and M. Morari. Robust model predictive control. 1987 American Control Conference, pages 1021-1026,\n1987.\n[65]\tE. Zafiriou. Robust model predictive control of processes with hard constraints. Comp. Chem. Eng., 14(4/5):359-371, 1990.\n[66]\tH. Genceli and M. Nikolaou. Design of robust constrained model predictive controllers with volterra series. AIChE Journal, 41(9):2098-2107, 1995.\n[67]\tZ.H. Zheng and M. Morari. Robust stability of constrained model predictive control. American Control Conference, pages 379-383, 1993.\n[68]\tD.R.Ramirez, T. Alamo, E.F. Camacho, and M. de la Penha. Min-max mpc based on a computationally efficient upper bound of worst case cost. Journal of Process Control, 16:511-519, 2006.\n[69]\tR.M.C. De Keyser. A gentle introduction to model based predictive control. In PADI2 International Conference on Control Engineering and Signal Processing, Piura, Peru, 1998.\n[70]\tM. J. Pomar Garcia c. Controle Preditivo Nao Linear com Aplica\u00e7\u00e3o a Eletr\u00f4nica de Pot\u00eancia, school=Universidade\nFederal de Santa Catarina, Florianopolis, SC C., Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia El\u00e9trica. PhD thesis, 2005.\n[72]\tF. Kunhe. Controle Preditivo aplicado a Rob\u00f3tica M\u00f3vel. Diss. de Mestrado, UFRGS, 2005.\n[71]\tB. Kouvaritakis, M. Cannon, and J.A. Rossiter. Non-linear model based predictive control. International Journal of Control, 72(10):919-928, 1999.\n[73]\tA. Plucenio, D.J. Pagano, G. A. Mafra, and A. H. Bru-ciapaglia. Uma extensao do controle preditivo DMC para sistemas n\u00e3o lineares. XVI Congresso Brasileiro de Automa\u00e7\u00e3o, 1:2644-2649, 2006.\n[74]\tMircea Lazar. Nonlinear controler based on the epsac approach. Master's thesis, University of Ghent, Department of Control Engineering and Automation, Flanders, Belgium,\n2001.\n[75]\tK.J. Astrom and B. Wittenmark. Computer Controlled S\u2019ystems-Theory and Design. Prentice Hall, Upper Saddle River, New Jersey, USA, 1997.\n[76]\tM. Escobar and J.O. Trierweiler. Multimodel approach to multivariable low order structured-controller design. International Symposium on Advanced Control of Chemical Process, pages 1021-1026, 2006.\n[77]\tJ.M. Maciejowski. Predictive Control with Constraints. Prentice Hall, Edinburgh Gate, Harlow, Essex,CM202JE, England, 2002.\n[78]\tJ.O. Trierweiler and A. R. Secchi. Exploring the potentiality of using multiple model approach in nonlinear model predictive control. Progress in Systems and Control Theory, 26:191-203, 2000.\n[79]\tA. Kremling H. Chen and F. Allgower. Nonlinear predictive control of a benchmark cstr. Proc. of 3rd ECC, pages 32473252, 1995.\n[80]\tS. Engell and K.-U. Klat. Nonlinear control of a nonminimum-phase cstr. Proc. of American Control Conference, pages 2041-2045, 1993.\n[81]\tJ.O. Trierweiler and S. Engell. Controllability analysis via the rpn for a cstr with van de vusse reaction. Proc. of European Control Conference, 1997.\n[82]\tP. B. Fernandes S. Koch, R. G. Duraiski and J.O. Trierweiler. Nmpc with state-space models obtained through linearization on equilibrium manifold. International Symposium on Advanced Control of Chemical Process, pages 1015-1020, 2006.\n[83]\tJ. A. Rossiter. Model-Based Predictive Control-A practical Approach. CRC PRESS, Boca Raton, Florida, USA, 2003.\n[84]\tA. Plucenio, D. J. Pagano, J. E. Normey-Rico, J. Pavei, and C. Moya. Including robustness in the mpc cost function. XVII Congresso Brasileiro de Autom\u00e1tica, 2008.\n[85]\tH. K. Khalil. Nonlinear Systems. Prentice Hall, New Jersey-USA, 1995.\n[86]\tD. Odloak A. H. Gonzales, J.L. Marchetti. Extended robust model predictive control for integrating systems. International Symposium on Advanced Control of Chemical Process, 1:129-134, 2006.\n[87]\tMokhtar S. Bazaraa, John J. Jarvis, and Hanif D. Sher-ali. Linear Programming and Network Flows. Wiley-Interscience, 2004.\n[88]\tSthener R. V. Campos, Manoel F. Silva Junior, Jose F. Correa, Edson Bolonhini, and Durval F. Filho. Right time decision of artificial lift management for fast loop control. In Proc. of the SPE Intelligent Energy Conference and Exhibition, Amsterdam, Netherlands, 2006.\n[89]\tG.O. Eikrem L. S. Imsland, B. A. Foss. State feedback control of a class of positive systems:application to gas lift stabilization. In submitted to ECC'03, Trondheim, Norway.\n[90]\tJ. D. Redden, T. A. G. Sherman, and J. R. Blann. Optimizing gas-lift systems. In Proceedings of the 49th Annual Fall Meeting of Petroleum Engineers of AIME, Houston, USA, October 1974. Paper SPE 5150.\n[91]\tE. P. Kanu, J. Mach, and K. E. Brown. Economic approach to oil production and gas allocation in continuous gas lift. Journal of Petroleum Technology, 33:1887-1892, October 1981. Paper SPE 9084.\n[93]\tN. Nishikiori, R. A. Redner, D. R. Doty, and Z. Schmidt. An improved method for gas lift allocation optimization. ASME Journal of Energy Resources Technology, 117:87-92, 1995.\n[92]\tN. Nishikiori, R. A. Redner, D. R. Doty, and Z. Schmidt. An improved method for gas lift allocation optimization. In Proceedings of the SPE 64th Annual Technical Conference and Exhibition, San Antonio, USA, October 1989. Paper SPE 19711.\n[94]\tG. A. Alarcon, C. F. Torres, and L. E. Gomez. Global optimization of gas allocation to a group of wells in artificial lift using nonlinear constrained programming. ASME Journal of Energy Resources Technology, 124(4):262-268, December\n2002.\n[95]\tP. T. Boggs and J. W. Tolle. Sequential quadratic programming. Acta Num., 4:1-52, September 1995.\n[97]\tP. H. R. Nakashima. Otimiza\u00e7\u00e3o de processos de produ\u00e7\u00e3o de petroleo via injecao cont\u00ednua de gas. Ph.D. Thesis Proposal, Graduate Program in Electrical Engineering, Federal University of Santa Catarina, April 2004.\n[96]\tE. Camponogara and P. H. R. Nakashima. Optimizing gaslift production of oil wells: Piecewise linear formulation and computational analysis. IIE Transactions, 38(2):173-182,\n2006.\n[99]\tE. Balas and E. Zemel. Facets of the knapsack polytope from minimal covers. SIAM Journal of Applied Mathematics, 34:119-148, 1978.\n[98]\tL. A. Wolsey. Integer Programming. John Wiley &amp; Sons, 1998.\n[100]\tT.D. Mayhill. Simplified method forf gas-lift well problem identification and diagnosis. In Proc. 49th Annual Fall\nMeeting of the Society of Petroleum Engineers of AIME, Houston-Texas, USA, 1974. Paper SPE 5151.\n[101]\tP. Lemetayer and P. M. Miret. Tool of the 90's to optimize gas lift efficiency in the gonelle field, gabon. In Proc. SPE Offshore Europe Conference, Aberdeen September 1991. Paper SPE 23089.\n[102]\tY. A. W. El-Massry and A. D. Price. Development of a network and gas lift allocation model for production optimization in the ras budran field. In Proc. SPE Middle East Oil Show, Bahrain\u201e March 1995. Paper SPE 29782.\n[103]\tC.L. Dunham and H.N.J. Poulisse. Real-time artificial lift optimization. In Proc. 8th Abu Dhabi International Petroleum Exhibition and Conference, Abu Dhabi,, October 1998. Paper SPE 49463.\n[104]\tTerry Bergeron, Andrew Cooksey, and J.Scott Reppel. New automated continuous gas-lift control system improves operational efficiency. In Proc. SPE Mid-Continent Operations Symposium, Oklahoma City-Oklahoma, USA, March 1999. Paper SPE 521123.\n[105]\tO. Boisard, B. Makaya, A. Nzossi, J.C. Hamon, and P. Lemetayer. Automated well control increases performance of mature gas-lifted fields, sendji case. In Proc. 10th Abu Dhabi International Petroleum Exhibition and Conference, Abu Dhabi\u201d October 2002. Paper SPE 78590.\n[106]\tM.S.Nadar, T.S Schneider, K.L. Jackson, C.J.N. McKie, and J. Hamid. Implementation of a total system production optimization model in a complex gas-lifted offshore operation. In Proc. SPE Annual Technical Conference and Exhibition, San Antonio-Texas, USA, September 2006. Paper SPE 103670.\n[107]\tS. Skogestad. Probably the best simple pid tuning rules in the world. submitted to the Journal of Process Control,\n2001.\n[108]\tJ. Godhavn, M. P. Fard, and P. H. Fuchs. New slug control strategies, tuning rules and experiments results. Journal of Process Control, 15:547-557, 2005.\n[109]\tE. Storkaas and S. Skogestad. Cascade control of unstable systems with application to stabilization of slug flow. IFAC Symposium ADCHEM 2003, January 2004.\n[110]\tE. Storkaas. Stabilizing control and controllability. Control solutions to avoid slug flow in pipeline-riser systems. PhD thesis, Norwegian University of Science and Technology, Norwegian, 2005.\n[111]\tF. Angulo, M. di Bernardo, E. Fossas, and G. Olivar. Feedback control of limit cycle: a switching control strategy based on nonsmooth bifurcation theory. IEEE Transactions on Circuit and Systems-I, 52(2):366-378, February 2005a.\n[112]\tA. R. Champneys M. di Bernardo, C. Budd and P.S. Kowalczyk. Piecewise-smooth Dynamical Systems: Theory and Applications. Applied Mathematical Sciences 163. Springer, 2008.\n[113]\tH. Wang and E. H. Abed. Bifurcation control of a chaotic system. Automatica, 31:1213-1226, 1995.\n[114]\tH. C. Lee and E. H. Abed. Washout filter in the bifurcation control of high alpha flight dynamics. In Proc. of the American Control Conference, pages 206-211, Boston, MA, 1991.\n[115]\tF. B. Cunha and D. J. Pagano. DC-DC step-up converter controlling by SMC and with an auxiliary washout filter. In Proc. of Congresso Brasileiro de Automatica, CBA2002,\n2002.\t(in portuguese).\n[116]\tE.F. Camacho and C. Bordons. Model Predictive Control. Springer, London, 1999.\n[117]\tO. J. M. Smith. Close control of loops with deadtime. Chemical Engineering Progress, 53:217, 1957.\n[118]\tH. Takatsu, T. Itoh, and M. Araki. Future needs for the control theory in industries-report and topics of the control technology survey in the japanese industry. Journal of Process Control, 8(5-6):369-374, 1998.\n[119]\tJ.E. Normey-Rico and E.F. Camacho. Control of Dead-time Processes. Spinger, Berlin, 2007.\n[120]\tC.R. Cutler and B.L. Ramaker. Dynamic matrix control - A computer control algorithm. In AIChE 86th National Meeting, Houston, TX, 1988.\n[121]\tJ. Richalet, A. Rault, J.L. Testud, and J. Papon. Algorithm control for industrial processes. In Proc. 4th IFAC Symp. on Identification and System Parameter Estimation, Tbilisi, USSR, 1976.\n[122]\tD.W. Clarke, C. Mothadi, and P.S. Tuffs. Generalized predictive control. Part I: The basic algorithm. Part II: Extensions and interpretations. Automatica, 23(2):137-160, 1987.\n[123]\tR. De Keyser. A gentle approach to predictive control. In Eolss Publishers Co. Ltd., editor, Encyclopedia of Life Support Systems (EoLSS), Oxford, April 2003.\n[124]\tc D. Limon. Control Predictivo de Sistemas No Lineales Sujetos a Resticciones: Estabilidad y Robustez. PhD thesis, Universidad de Sevilla, 2002.\n[125]\tJ.A. Rossiter. Model-Based Predictive Control: A practical Approach. CRC Press, 2003.\n[126]\tM. Pomar, J.E. Normey-Rico, and E. Camponogara. Non linear model based predictive controller of a buck boost converter. In Proc. of the XVI IFAC World Congress, Prague, 2005.\n[127]\tO. Nelles. Nonlinear System Identification. Spinger, Berlin, 2001.\n[128]\tY. Tan and R. De Keyser. Advances in Model-Based Predictive Control, chapter Neural Network Based Predictive Control. Oxford University Press, 1994.\n[129]\tI. Skrjanc and D. Matko. Advances in Model-Based Predictive Control, chapter Fuzzy Predictive Controller with Adaptive Gain. Oxford University Press, 1994.\n[130]\tC. Mohtadi D. W. Clarke and P.S. Tuffs. Generalized predictive control-part i-the basic algorithm. Automatica, 23(2):137-148, 1987."}]}}}