{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.10792"}, {"@name": "filename", "#text": "15960_000330728.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL \n\n ESCOLA DE ENGENHARIA \n\n Curso de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia El\u00e9trica - CPGEE \n\nEFEITOS BIOL\u00d3GICOS DAS RADIA\u00c7\u00d5ES DE R\u00c1DIO \nFREQ\u00dc\u00caNCIAS DE TELEFONIA CELULAR \n\n- \nSIMULA\u00c7\u00c3O FDTD   \n\n  \n\n CLAUDIO ENRIQUE FERN\u00c1NDEZ RODR\u00cdGUEZ \n\n Disserta\u00e7\u00e3o para obten\u00e7\u00e3o do t\u00edtulo de Mestre em Engenharia \n\n Porto Alegre \n\n 2001\n\n\n\n \n\nUNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL \n\n ESCOLA DE ENGENHARIA \n\n Curso de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia El\u00e9trica - CPGEE \n\n EFEITOS BIOL\u00d3GICOS DAS RADIA\u00c7\u00d5ES DE R\u00c1DIO \nFREQ\u00dc\u00caNCIA DE TELEFONIA CELULAR                                \n\nSIMULA\u00c7\u00c3O FDTD \n  \n\n CLAUDIO ENRIQUE FERN\u00c1NDEZ RODR\u00cdGUEZ \n\n Engenheiro Eletricista \n\n  \n\n  \n\nDisserta\u00e7\u00e3o apresentada ao Curso de P\u00f3s-Gradua\u00e7\u00e3o em \nEngenharia El\u00e9trica - CPGEE, como parte dos requisitos \npara a obten\u00e7\u00e3o do t\u00edtulo de Mestre em Engenharia. \n\u00c1rea de concentra\u00e7\u00e3o: Eletr\u00f4nica e Comunica\u00e7\u00f5es. \nDesenvolvida no Laborat\u00f3rio de Comunica\u00e7\u00f5es Eletro-\n\u00d3ticas do Departamento de Engenharia El\u00e9trica da \nUniversidade Federal do Rio Grande do Sul. \n\n  \n\n  \n\n \n Porto Alegre \n\n 2001\n\n ii\n\n\n\n \n\nEFEITOS BIOL\u00d3GICOS DAS RADIA\u00c7\u00d5ES DE R\u00c1DIO \nFREQ\u00dc\u00caNCIA DE TELEFONIA CELULAR                                \n\nSIMULA\u00c7\u00c3O FDTD \n  \n\n CLAUDIO ENRIQUE FERN\u00c1NDEZ RODR\u00cdGUEZ \n\n  \n\n Esta disserta\u00e7\u00e3o foi julgada adequada para a obten\u00e7\u00e3o do t\u00edtulo de Mestre em Engenharia \n\ne aprovada em sua forma final pelo Orientador e pela Banca Examinadora. \n\n  \n\n Orientador:_________________________________ \n\n Prof. \u00c1lvaro Augusto de Almeida Salles, UFRGS \n\n PhD. pela University College of London, UK \n\n Banca Examinadora: \n\n  \n\n Prof. Francisco de Assis Tejo, UFPB \n\n Dr. pela Universidade Federal da Para\u00edba \u2013 UFPB \u2013 1996 \n\n Prof. Marcelo S. Alencar, UFPB. \n\n PhD. pela University of Waterloo \u2013 1993 \n\n Prof. Jorge R. S. Sabadal, UFRGS       \n\n Dr. pela Universidade Federal do Rio Grande do Sul \u2013 UFRGS \u2013 1994 \n\n Prof. Jorge A. Lisb\u00f4a, UFRGS. \n\n Dr. pela Universidade Federal do Rio Grande do Sul \u2013 UFRGS \u2013 1988 \n\n  \n\n Coordenador do CPGEE:_____________________________ \n\nProf. Dr. Altamiro A. Susin \n\n  \n\n Porto Alegre, agosto de 2001.\n\n iii\n\n\n\n \n\n \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n  \n\n para Juan Felipe y Diego \n\n iv\n\n\n\n \n\nAGRADECIMENTOS \n\n Aos Professores Dr. \u00c1lvaro Salles e Dr. Jorge Lisb\u00f4a pela orienta\u00e7\u00e3o e colabora\u00e7\u00e3o em \n\ntodas as etapas do trabalho.  \n\n Ao Professor Dr. Marco Vilhena por traduzir sua vasta experi\u00eancia com m\u00e9todos \n\nnum\u00e9ricos em certeiros conselhos.  \n\n Ao Engenheiro, MSc. Luis Sch\u00e4ffer pela colabora\u00e7\u00e3o na concep\u00e7\u00e3o e nas primeiras etapas \n\ndo desenvolvimento do algoritmo apresentado. \n\n Ao Engenheiro Rodrigo Stoll pela implementa\u00e7\u00e3o dos algoritmos originais de forma \n\nadequada ao supercomputador.   \n\n Ao Engenheiro, MSc. (cdt) S\u00e9rgio Severo pelo interc\u00e2mbio de id\u00e9ias sobre o algoritmo \n\nimplementado e pela colabora\u00e7\u00e3o na implementa\u00e7\u00e3o de rotinas de sa\u00edda gr\u00e1fica. \n\n Ao Engenheiro (cdt) Mateus Bonadimann pela valiosa ajuda com a constru\u00e7\u00e3o do dom\u00ednio \n\ndo problema, nas simula\u00e7\u00f5es e implementa\u00e7\u00f5es de antenas.  \n\n Ao Engenheiro Paulo Serafini pela ajuda com o projeto, implementa\u00e7\u00e3o e medi\u00e7\u00f5es de \n\nantenas. \n\n Aos funcion\u00e1rios do CESUP \n\n A todos pelo incentivo al\u00e9m das colabora\u00e7\u00f5es, meus agradecimentos.   \n\n  \n\n v \n\n\n\n \n\nSUM\u00c1RIO \n\nLISTA DE FIGURAS............................................................................................................viii \n\nLISTA DE TABELAS .............................................................................................................. x \n\nLISTA DE ABREVIATURAS E S\u00cdMBOLOS......................................................................xi \n\nRESUMO................................................................................................................................xiv \n\nABSTRACT ............................................................................................................................ xv \n\n1 INTRODU\u00c7\u00c3O ................................................................................................................ 1 \n1.1 MOTIVA\u00c7\u00c3O ................................................................................................................ 1 \n1.2 PLANO DO TRABALHO ................................................................................................. 1 \n\n2 CONTEXTO DO PROBLEMA ...................................................................................... 3 \n2.1 DIFUS\u00c3O DAS COMUNICA\u00c7\u00d5ES PESSOAIS VIA R\u00c1DIO ................................................... 3 \n2.2 ONDAS ELETROMAGN\u00c9TICAS ...................................................................................... 4 \n2.3 EFEITOS BIOL\u00d3GICOS E RISCOS \u00c0 SA\u00daDE .................................................................... 5 \n\n2.3.1 Efeitos T\u00e9rmicos................................................................................................. 6 \n2.3.2 Efeitos N\u00e3o-T\u00e9rmicos......................................................................................... 7 \n2.3.3 Efeitos e Riscos .................................................................................................. 9 \n\n2.4 EXPOSI\u00c7\u00c3O HUMANA A CAMPOS ELETROMAGN\u00c9TICOS............................................... 9 \n2.4.1 Par\u00e2metros Dosim\u00e9tricos .................................................................................... 9 \n2.4.2 Principais Normas e Recomenda\u00e7\u00f5es............................................................... 11 \n2.4.3 Postura Precaut\u00f3ria ........................................................................................... 12 \n\n2.5 CAMPO DISTANTE ..................................................................................................... 12 \n2.5.1 C\u00e1lculos para uma Esta\u00e7\u00e3o de Radiocomunica\u00e7\u00e3o........................................... 13 \n2.5.2 Medidas ............................................................................................................ 16 \n\n3 SIMULA\u00c7\u00c3O NUM\u00c9RICA .......................................................................................... 17 \n3.1 M\u00c9TODO FDTD......................................................................................................... 18 \n\n3.1.1 Calculo dos Campos El\u00e9tricos e Magn\u00e9ticos ................................................... 19 \n3.2 MODELO DO DOM\u00cdNIO DO PROBLEMA ....................................................................... 24 \n3.3 MODELO DA FONTE ................................................................................................... 28 \n3.4 SIMULA\u00c7\u00c3O DO ESPA\u00c7O LIVRE ................................................................................. 30 \n3.5 CONVERG\u00caNCIA DO M\u00c9TODO .................................................................................... 32 \n3.6 VALIDA\u00c7\u00c3O DO ALGORITMO IMPLEMENTADO........................................................... 33 \n3.7 O ALGORITMO IMPLEMENTADO ................................................................................ 34 \n\n4 RESULTADOS OBTIDOS............................................................................................ 35 \n4.1 COMPARA\u00c7\u00d5ES COM OUTRAS SIMULA\u00c7\u00d5ES .............................................................. 40 \n4.2 COMPARA\u00c7\u00d5ES COM MEDIDAS .................................................................................. 41 \n\n vi\n\n\n\n \n\n5 PROJETO DE ANTENAS DIRETIVAS ..................................................................... 43 \n5.1 PROJETO DE ANTENAS USANDO FDTD ..................................................................... 44 \n5.2 MEDIDAS DE PROT\u00d3TIPOS.......................................................................................... 47 \n\n6 CONCLUS\u00d5ES E RECOMENDA\u00c7\u00d5ES .................................................................... 52 \n\nREFER\u00caNCIAS BIBLIOGR\u00c1FICAS ................................................................................. 54 \n\nANEXOS ................................................................................................................................. 59 \nANEXO1 LISTAGEM DO PROGRAMA PRINCIPAL ............................................................... 59 \nANEXO2 LISTAGEM DA ROTINA DE INDEXA\u00c7\u00c3O DOS TECIDOS ...................................... 114 \n\n vii\n\n\n\n \n\nLISTA DE FIGURAS \n\nFig. 1. Evolu\u00e7\u00e3o do uso de telefones celulares no mundo.       3 \n\nFig. 2. Evolu\u00e7\u00e3o do uso de telefones celulares no Brasil.       4 \n\nFig. 3. Espectro Eletromagn\u00e9tico.           5 \n\nFig. 4. Limites de Exposi\u00e7\u00e3o em Fun\u00e7\u00e3o da Freq\u00fc\u00eancia.      11 \n\nFig. 5. Dist\u00e2ncias para o atendimento \u00e0s normas ICNIRP e ANSI para uma ERB t\u00edpica.   14 \n\nFig. 6. Dist\u00e2ncias para o atendimento \u00e0s legisla\u00e7\u00f5es Su\u00ed\u00e7a e Italiana ERB t\u00edpica.    15 \n\nFig. 7. Dist\u00e2ncias para o atendimento \u00e0s legisla\u00e7\u00f5es Su\u00ed\u00e7a e Italiana: plano vertical   15 \n\nFig. 8. Espectro electromagn\u00e9tico observado nas proximidades de duas ERB (Bandas A e B).  16 \n\nFig. 9. Diagrama de Blaocos dos algoritmos implementados.      16 \n\nFig. 10. C\u00e9lula de Yee.          20 \n\nFig. 11. C\u00e9lula de Yee modificada.         23 \n\nFig. 12. Cortes sagitais (real e de resson\u00e2ncia magn\u00e9tica).      25 \n\nFig. 13. Imagem de cortes sagital idealizado, usado para a gera\u00e7\u00e3o do dom\u00ednio de c\u00e1lculo.  25 \n\nFig. 14. Dimens\u00f5es do modelo utilizado.        26 \n\nFig. 15. Plano da matriz gerada. Cada \u00edndice aponta a um material.     27 \n\nFig. 16. Diagramas de irradia\u00e7\u00e3o de um dipolo e de uma fonte isotr\u00f3pica.    28 \n\nFig. 17. Simula\u00e7\u00e3o de um monopolo        29 \n\nFig. 18. Campo El\u00e9trico observado (vista superior e lateral para uma simula\u00e7\u00e3o teste de um monopolo). 29 \n\nFig. 19. Pulso propagando para bordas descasada e casada.      30 \n\nFig. 20. Monitoriza\u00e7\u00e3o ao longo das itera\u00e7\u00f5es dos valores de diferentes componentes de campo el\u00e9trico. 33 \n\nFig. 21. Monitoriza\u00e7\u00e3o ao longo das itera\u00e7\u00f5es do valor de SAR calculado.    35 \n\nFig. 22. SAR num corte sagital da cabe\u00e7a do usu\u00e1rio em mW/g por V/m RMS.    36 \n\nFig. 23. SAR na cabe\u00e7a do usu\u00e1rio para um corte sagital, depois de 1ns, 2ns e 3ns de exposi\u00e7\u00e3o.  37 \n\nFig. 24. SAR na cabe\u00e7a do usu\u00e1rio para diferentes cortes e dist\u00e2ncias.     38 \n\nFig. 25. Elevados valores da SAR internos.        39 \n\n viii\n\n\n\n \n\nFig. 26. SAR normalizada para uma pot\u00eancia entregue \u00e0 antena Pdel = 600 mW.    40 \n\nFig. 27. Compara\u00e7\u00f5es de resultados simulados.       41 \n\nFig. 28. Compara\u00e7\u00f5es de resultados medidos.       42 \n\nFig. 29. Representa\u00e7\u00e3o de uma matriz contendo a antena microstrip.     45 \n\nFig. 30. Propaga\u00e7\u00e3o de campos eletromagn\u00e9ticos para a antena microstrip.    46 \n\nFig. 31. Cortes transversais da antena microstrip.       46 \n\nFig. 32. Campo el\u00e9trico propagado a partir da antena microstrip, para uma vista longitudinal.  47 \n\nFig. 33. Propaga\u00e7\u00e3o de campos eletromagn\u00e9ticos a partir da antena microstrip, para uma vista de topo. 47 \n\nFig. 34. Diagrama de irradia\u00e7\u00e3o medido de uma antena microstrip no plano horizontal   49 \n\nFig. 35. Diagrama de irradia\u00e7\u00e3o medido de uma antena microstrip no plano vertical   50 \n\nFig. 36. Taxa de onda estacion\u00e1ria medida na faixa de 837,5 a 865 MHz.    50 \n\n ix\n\n\n\n \n\nLISTA DE TABELAS \n\nTabela 1. Par\u00e2metros dos tecidos usados na simula\u00e7\u00e3o. ERRO! INDICADOR N\u00c3O DEFINIDO. \n\nTabela 2. Par\u00e2metros dos materiais usados na simula\u00e7\u00e3o. ERRO! INDICADOR N\u00c3O DEFINIDO. \n\n \n\n x \n\n\n\n \n\nLISTA DE ABREVIATURAS E S\u00cdMBOLOS \n\n t  Passo temporal (intervalo de tempo, diferen\u00e7a finita). ?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n?\n\n\u00b5\n?\n?\n?\n?\n\n?\n\n x, ?y, ?z  Intervalos das vari\u00e1veis espaciais x y z (diferen\u00e7as finitas). \n E/?t  Diferencial de campo el\u00e9trico em rela\u00e7\u00e3o ao tempo. \n H/?t  Diferencial de campo magn\u00e9tico em rela\u00e7\u00e3o ao tempo. \n m  Diferencial de massa (massa do elemento). \n V   Diferencial de volume (volume do elemento). \n W   Diferencial de energia (J) em Joules. \n   Profundidade de penetra\u00e7\u00e3o pelicular, em (mm) mil\u00edmetros. \n 0  Constante diel\u00e9trica do v\u00e1cuo, permissividade do v\u00e1cuo. \n r  Constante diel\u00e9trica relativa, permissividade relativa do meio. \n r\u00b4  Parte real da constante diel\u00e9trica. \n r\u201d  Parte imagin\u00e1ria da constante diel\u00e9trica. \n , ?m  Coordenada esf\u00e9rica (r,?, ?) ??. \n ?  Comprimento de onda, em (m) metros. \n ?  Freq\u00fc\u00eancia em (Hz, MHz, GHz) Hertz, Megahertz ou Gigahertz. \n   Permeabilidade magn\u00e9tica. \n   Pi, 3,14159267. \n   Massa espec\u00edfica, em (kg/l) kilograma por litro. \n , ?m  Coordenada esf\u00e9rica (r,?, ?) ??. \n   Condutividade, em (S/m) Siemens por metro. \n ?*  Termo dual da condutividade, para o campo magn\u00e9tico. \n   Operador nabla. \n ABC  Absorbing Boundary Condition \u2013 Condi\u00e7\u00e3o de Borda Absorvedora. \n ADI  Alternative Direction, Implicit \u2013 M\u00e9todo num\u00e9rico impl\u00edcito de dire\u00e7\u00e3o \n\nalternada. \n ANSI  American National Standards Institute \u2013 Instituto de normatiza\u00e7\u00e3o dos \n\nEstados Unidos.  \n ANATEL  Ag\u00eancia Nacional de Telecomunica\u00e7\u00f5es. \n Bandas A e B Faixas de freq\u00fc\u00eancia outorgadas \u00e1s operadoras do servi\u00e7o m\u00f3vel \n\ncelular. \n BIFA  Bent Inverted F Antennas \u2013 Antena de microlinha invertida tipo F sobre \n\numa superf\u00edcie curva. \n bf   Densidade de fluxo sang\u00fc\u00edneo, em (m3/s) metros c\u00fabicos por segundo.   \n C++  Linguagem de programa\u00e7\u00e3o. \n C95.1   Norma de exposi\u00e7\u00e3o a campos eletromagn\u00e9ticos do IEEE de 1992. \n Cb  Calor espec\u00edfico do sangue arterial, em (J/kg \u00b0C) Joules por kilograma e \n\npor grau Celsius. \n CDMA  Code Division Media Access \u2013 Multiplexa\u00e7\u00e3o por c\u00f3digo. \n CENELEC  Comit\u00e9 Europ\u00e9en de Normalisation Electrotechnique \u2013 Comit\u00ea Europeu \n\nde Normatiza\u00e7\u00e3o Eletrot\u00e9cnica. \n\n xi\n\n\n\n \n\n COST  COperation europ\u00e9enne dans le domaine de la recherche Scientifique et \nTechnique \u2013 Modelo de r\u00e1dio-propaga\u00e7\u00e3o. \n\n Cp  Calor espec\u00edfico, em (J/kg \u00b0C) Joules por kilograma e por grau Celsius. \n CPU  Unidade Central de Processamento \n CPW  Coplanar Waveguide \u2013 Estrutura planar com guias de onda coplanares. \n CRAY T94  Supercomputador modelo T94 da CRAY. \n Dm  Fun\u00e7\u00e3o de diretividade da antena. \n DNA   \u00c1cido Desoxirribonucl\u00e9ico \n dT/dt   Diferencial de temperatura no intervalo diferencial de tempo dt. \n Ex, Ey, Ez  Componentes de Campo El\u00e9trico (V/m) em Volts por metro. \n ENV50166-2 Norma de exposi\u00e7\u00e3o a campos eletromagn\u00e9ticos do ICNIRP de 1998 \n ERB  Esta\u00e7\u00e3o radiobase. \n f  Freq\u00fc\u00eancia. \n FCC  Federal Communications Commission \u2013 Ag\u00eancia governamental para a \n\nregulamenta\u00e7\u00e3o das telecomunica\u00e7\u00f5es dos Estados Unidos. \n FDTD  Finite Diferences Time-Domain \u2013 M\u00e9todo num\u00e9rico expl\u00edcito das \n\nDiferen\u00e7as Finitas no Dom\u00ednio do Tempo. \n FR-4 V0  Substrato diel\u00e9trico tipo Perstorp. \n GB  Gigabyte, unidade de armazenamento de dados. \n GFLOP  Unidade de velocidade de processamento.  \n h  Constante de Planck, 6,626 \u00d7 10-34 (J\u00d7s) Joules multiplicados por \n\nsegundos. \n hCONV  Perdas t\u00e9rmicas por convec\u00e7\u00e3o. \n hE   Perdas t\u00e9rmicas por evapora\u00e7\u00e3o. \n hm  Calor gerado pelo metabolismo. \n hRAD  Perdas t\u00e9rmicas por radia\u00e7\u00e3o. \n Hx, Hy, Hz  Componentes do Campo Magn\u00e9tico (A/m) \n HSP  Heat-Shock Proteins \u2013 Prote\u00edna de choque t\u00e9rmico. \n ICNIRP  International Commission on Non-Ionizing Radiation Protection \u2013 \n\nComiss\u00e3o Internacional de Prote\u00e7\u00e3o de Radia\u00e7\u00e3o N\u00e3o Ionizante. \n IEEE  The Institute of Electrical and Electronics Engineers \u2013 Instituto dos \n\nEngenheiros Eletro Eletr\u00f4nicos dos Estados Unidos. \n MoM   M\u00e9todo num\u00e9rico dos Momentos. \n MS 2711  Modelo de analisador de espectro marca Anritsu. \n n  \u00cdndice de itera\u00e7\u00e3o. \n Nm   N\u00famero de canais, para cada setor. \n OMS   Organiza\u00e7\u00e3o Mundial de Sa\u00fade. \n PCs  Computadores pessoais. \n PIFA  Planar Inverted F Antenna \u2013 Antena de microlinha invertida tipo F. \n Pm   Pot\u00eancia por canal efetivamente fornecida \u00e0 antena. \n PML   Perfect Matching Layer \u2013 Camada perfeitamente casada. \n R (?, ?) ??  Coordenada esf\u00e9rica de dist\u00e2ncia. \n raios-X  Radia\u00e7\u00e3o com freq\u00fc\u00eancias de aproximadamente 1020 Hz. \n RF   Radiofreq\u00fc\u00eancias. \n RGB   Red, Green &amp; Blue, componentes de cor.  \n RMS  Valor m\u00e9dio quadr\u00e1tico. \n RNA   \u00c1cido ribonucl\u00e9ico \n SAR  Specific Absorption Rate \u2013 Taxa de Absor\u00e7\u00e3o Espec\u00edfica em (mW/g) \n SCSI  Small Computer System Interface \u2013 Inteface de computadores. \n Slot-line  Tipo de estrutura planar (de fenda) \n\n xii\n\n\n\n \n\n SMA  Tipo de conetor. \n T   Temperatura em ( oC) graus Celsius.  \n Tb  Temperatura do sangue arterial. \n Umax   Densidade de pot\u00eancia, em (mW/cm2 ) miliwatts por cent\u00edmetro \n\nquadrado. \n V   Volume em (m3) metros c\u00fabicos. \n\n xiii\n\n\n\n \n\nRESUMO \n\n Neste trabalho \u00e9 apresentado o desenvolvimento de um programa para c\u00e1lculo de campos \n\neletromagn\u00e9ticos baseado no m\u00e9todo das Diferen\u00e7as Finitas no Dom\u00ednio do Tempo (FDTD). \n\nEste programa \u00e9 aplicado no c\u00e1lculo da Taxa de Absor\u00e7\u00e3o Espec\u00edfica (SAR) na cabe\u00e7a de um \n\nusu\u00e1rio de transceptores port\u00e1teis como os telefones celulares. Como introdu\u00e7\u00e3o ao problema \n\n\u00e9 realizada uma revis\u00e3o dos efeitos biol\u00f3gicos e das recomenda\u00e7\u00f5es para a exposi\u00e7\u00e3o humana \n\na radiofreq\u00fc\u00eancias e microondas. Os principais resultados obtidos com simula\u00e7\u00f5es realizadas \n\ncom o programa desenvolvido. S\u00e3o mostrados e comparados com os resultados simulados e \n\nmedidos por outros autores, assim como com as recomenda\u00e7\u00f5es nacionais e internacionais. A \n\nt\u00edtulo de recomenda\u00e7\u00e3o final e como alternativa visando minimizar os riscos que a absor\u00e7\u00e3o \n\ndo campo pode representar para a sa\u00fade dos usu\u00e1rios, \u00e9 proposta a utiliza\u00e7\u00e3o de antenas que \n\nemitem mais no sentido oposto \u00e0 cabe\u00e7a. Este conceito \u00e9 testado com o desenvolvimento de \n\numa antena simples em microstrip. \n\n xiv\n\n\n\n \n\nABSTRACT \n\n The development of a software to compute the electromagnetic fields, employing the \n\nFinite Difference Time Domain (FDTD) method is shown in this work. This software is used \n\nto estimate the Specific Absorption Rate (SAR) in the head of users of portable transmitters \n\n(such as cellular phones). A review of the biological effects of microwaves and radio \n\nfrequencies, as well as the guidelines for human exposure are included The relevant results \n\nobtained with this model, are compared with the guidelines as well as with results estimated \n\nor measured by other authors. The use of directive antennas, radiating energy away from the \n\nuser\u2019s head, is proposed as an alternative aiming to reduce health risks. In order to tests this \n\nconcept, a very simple microstrip antenna is developed. \n\n  \n\n xv \n\n\n\nIntrodu\u00e7\u00e3o 1\n\n 1 INTRODU\u00c7\u00c3O \n\n O interesse no estudo dos efeitos biol\u00f3gicos de radiofreq\u00fc\u00eancia e microondas t\u00eam \n\naumentado com a populariza\u00e7\u00e3o das comunica\u00e7\u00f5es pessoais. O estudo espec\u00edfico da \n\ndistribui\u00e7\u00e3o de campo para o caso do transmissor port\u00e1til requer o uso de uma ferramenta de \n\nc\u00e1lculo num\u00e9rico, como o M\u00e9todo das Diferen\u00e7as Finitas no Dom\u00ednio do Tempo FDTD, \n\nquando se deseja conhecer a distribui\u00e7\u00e3o de campo em campo pr\u00f3ximo. A aplica\u00e7\u00e3o desta \n\nferramenta n\u00e3o se restringe a esse problema. Os c\u00e1lculos de espalhamento com ela realizados \n\npodem servir a diferentes aplica\u00e7\u00f5es, entre as quais o projeto de antenas diretivas que possam \n\nminimizar os efeitos biol\u00f3gicos adversos sobre os usu\u00e1rios dos transceptores port\u00e1teis. \n\n1.1 MOTIVA\u00c7\u00c3O \n\n Os n\u00edveis de exposi\u00e7\u00e3o humana a campos eletromagn\u00e9ticos s\u00e3o limitados em diferentes \n\nrecomenda\u00e7\u00f5es e legisla\u00e7\u00f5es. Por\u00e9m, as dificuldades encontradas para as medi\u00e7\u00f5es e \n\nestimativas te\u00f3ricas em condi\u00e7\u00f5es de campo pr\u00f3ximo levam \u00e0 necessidade de comprova\u00e7\u00e3o \n\ndo atendimento desses limites no caso dos transmissores port\u00e1teis. \n\n Considerando estas dificuldades para a avalia\u00e7\u00e3o te\u00f3rica e para a dosimetria dos campos \n\neletromagn\u00e9ticos na proximidade dos elementos radiantes, a pequena dist\u00e2ncia entre as \n\nantenas dos telefones celulares e a cabe\u00e7a do usu\u00e1rio, o que configura esta situa\u00e7\u00e3o de \u201ccampo \n\npr\u00f3ximo\u201d, e o grande n\u00famero de usu\u00e1rios que atualmente usam este tipo de telefonia, o \n\ndesenvolvimento de um m\u00e9todo de avalia\u00e7\u00e3o te\u00f3rico para o estudo deste problema se torna \n\nrelevante.  \n\n1.2 PLANO DO TRABALHO \n\n Inicialmente, no Cap\u00edtulo 2, uma discuss\u00e3o introdut\u00f3ria dos efeitos biol\u00f3gicos das \n\nradia\u00e7\u00f5es eletromagn\u00e9ticas tentar\u00e1 colocar em contexto o problema, mostrando a abrang\u00eancia \n\nda quest\u00e3o. A seguir, no Cap\u00edtulo 3, ser\u00e1 apresentado o desenvolvimento de uma ferramenta \n\nde an\u00e1lise num\u00e9rica baseada no m\u00e9todo de diferen\u00e7as finitas no dom\u00ednio do tempo (FDTD) \n\npara determinar a distribui\u00e7\u00e3o dos campos eletromagn\u00e9ticos emitidos pela antena de um \n\n \n\n\n\nIntrodu\u00e7\u00e3o 2\n\ntelefone celular e absorvidos pela a cabe\u00e7a do usu\u00e1rio. No Cap\u00edtulo 4, os resultados obtidos \n\ncom o algoritmo desenvolvido ser\u00e3o comparados com outros resultados publicados, simulados \n\ne medidos e com alguns limites de exposi\u00e7\u00e3o recomendados. No Cap\u00edtulo 5, o projeto e teste \n\npreliminar de antenas diretivas, que minimizam os campos absorvidos na cabe\u00e7a do usu\u00e1rio, \u00e9 \n\nmostrado como solu\u00e7\u00e3o conceitual ao problema. Considerando que o algoritmo implementado \n\nfoi usado para simula\u00e7\u00f5es da antena projetada, este desenvolvimento serve tamb\u00e9m como \n\nexemplo da aplica\u00e7\u00e3o da ferramenta computacional desenvolvida.  Finalmente, outras \n\nconclus\u00f5es, recomenda\u00e7\u00f5es e uma breve resenha de poss\u00edveis desenvolvimentos futuros s\u00e3o \n\ninclu\u00eddos no Cap\u00edtulo 6. \n\n \n\n\n\nContexto do Problema 3\n\n 2 CONTEXTO DO PROBLEMA \n\n A difus\u00e3o do uso de transceptores port\u00e1teis, como os telefones celulares, tem levantado \n\nquestionamentos a respeito dos efeitos que o campo eletromagn\u00e9tico induzido na cabe\u00e7a dos \n\nusu\u00e1rios pode provocar. Para avaliar estas quest\u00f5es \u00e9 necess\u00e1rio o desenvolvimento de uma \n\nsolu\u00e7\u00e3o num\u00e9rica, implementada num software que tenha aplica\u00e7\u00e3o geral para problemas de \n\npropaga\u00e7\u00e3o e absor\u00e7\u00e3o de campo eletromagn\u00e9tico, em campo pr\u00f3ximo ou distante, e que \n\npossa ser aplicado para determinar a distribui\u00e7\u00e3o dos campos eletromagn\u00e9ticos provenientes \n\ndas antenas dos transceptores port\u00e1teis, sobre o usu\u00e1rio.  \n\n2.1 DIFUS\u00c3O DAS COMUNICA\u00c7\u00d5ES PESSOAIS VIA R\u00c1DIO \n\n Embora o uso de radiofreq\u00fc\u00eancias remonte \u00e0s experi\u00eancias de Marconi em 1895 e Landell \n\nde Moura em 1879, e o primeiro uso corporativo do r\u00e1dio em comunica\u00e7\u00f5es pessoais ocorreu \n\nem 1921 com as primeiras radiopatrulhas em Detroit - EEUU [1]. No entanto, \u00e9 apenas a \n\npartir da d\u00e9cada de 1980 com o surgimento da telefonia celular e, principalmente depois de \n\nsua difus\u00e3o nos anos 1990, como ilustram as Figuras 1 e 2, que grandes segmentos da \n\npopula\u00e7\u00e3o come\u00e7aram a usar transceptores pessoais de r\u00e1dio.  \n\n  \n\n \n\n5 10 20 30\n50\n\n90\n140\n\n200\n250\n\n380\n\n500\n\n0\n\n100\n\n200\n\n300\n\n400\n\n500\n\n1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000\n\nTelefones Celulares no Mundo\n(Fonte: ITU)\n\n \n\n Figura 1. Evolu\u00e7\u00e3o do uso de telefones celulares no mundo. \n\n \n\n\n\nContexto do Problema 4\n\n \n\n0,04 0,08 0,15 0,25 0,72 1,5\n3,2 4,5\n\n7,4\n\n14\n\n27\n\n0\n\n10\n\n20\n\n30\n\n1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000\n\nTelefones Celulares no Brasil\n(Fonte: ANATEL)\n\nMilh\u00f5es de Aparelhos\n\n \n\n Figura 2. Evolu\u00e7\u00e3o do uso de telefones celulares no Brasil. \n\n  \n\n Hoje em dia s\u00e3o mais de 30 milh\u00f5es de usu\u00e1rios apenas no Brasil e ainda h\u00e1 previs\u00f5es de \n\nque a penetra\u00e7\u00e3o acelerada desse servi\u00e7o continue atingindo parcelas ainda maiores da \n\npopula\u00e7\u00e3o. Ao lado dessa populariza\u00e7\u00e3o, tem crescido tamb\u00e9m a preocupa\u00e7\u00e3o a respeito dos \n\nposs\u00edveis riscos \u00e0 sa\u00fade causados pela exposi\u00e7\u00e3o aos campos eletromagn\u00e9ticos emitidos por \n\nesses equipamentos de comunica\u00e7\u00e3o. Note-se que nestes equipamentos, os campos emitidos \n\nn\u00e3o correspondem a um efeito desnecess\u00e1rio e indesejado, mas a parte fundamental do \n\nprocesso de comunica\u00e7\u00e3o. \n\n \n\n2.2 ONDAS ELETROMAGN\u00c9TICAS \n\n Os canais de transmiss\u00e3o dos telefones celulares port\u00e1teis usam portadoras de \n\nradiofreq\u00fc\u00eancias, por exemplo, entre 800 MHz e 900 MHz para as bandas A e B, no Brasil. \n\nDesta forma, os sinais de voz que devem ser transmitidos s\u00e3o transformados em ondas \n\neletromagn\u00e9ticas com freq\u00fc\u00eancias pr\u00f3ximas a 1 GHz (ou 109 Hz), as quais devem ser emitidas \n\ncom pot\u00eancia suficiente para serem recebidas pelas esta\u00e7\u00f5es de radiobase (ERB) do sistema \n\ncelular.  \n\n Este tipo de ondas \u00e9 classificado como sendo \u201cn\u00e3o ionizante\u201d (Figura 3) diferentemente \n\ndas radia\u00e7\u00f5es de maior freq\u00fc\u00eancia (e.g., a partir de 1015 Hz). De fato, radia\u00e7\u00e3o em \n\ncomprimentos de onda menores que o da radia\u00e7\u00e3o ultravioleta come\u00e7am a ter a capacidade de \n\n \n\n\n\nContexto do Problema 5\n\nionizar a mat\u00e9ria (e s\u00e3o, portanto, consideradas \u201cionizantes\u201d), pois possuem energia capaz de \n\narrancar el\u00e9trons dos \u00e1tomos irradiados.  \n\n  \n\n  \n \n\n Figura 3. Espectro Eletromagn\u00e9tico. \n\n \n\n A energia E da onda depende linearmente da freq\u00fc\u00eancia ? e da constante de Planck h, de \n\nacordo com a equa\u00e7\u00e3o \n\n?hE =  (1) \n O objeto de estudo deste trabalho s\u00e3o as radia\u00e7\u00f5es n\u00e3o ionizantes na faixa de \n\nradiofreq\u00fc\u00eancias (ou pr\u00f3ximas \u00e0s de microondas) usadas pelos telefones celulares para a \n\ntransmiss\u00e3o.  \n\n  \n\n2.3 EFEITOS BIOL\u00d3GICOS E RISCOS \u00c0 SA\u00daDE \n\n A intera\u00e7\u00e3o de ondas eletromagn\u00e9ticas com a mat\u00e9ria org\u00e2nica viva pode implicar em \n\nefeitos prejudiciais e tamb\u00e9m em aplica\u00e7\u00f5es m\u00e9dicas nas quais o risco deve ser controlado.  \n\n \n\n\n\nContexto do Problema 6\n\n Para o caso das radia\u00e7\u00f5es ionizantes, diversas aplica\u00e7\u00f5es e severos efeitos danosos foram \n\nidentificados, h\u00e1 j\u00e1 v\u00e1rias d\u00e9cadas. Por exemplo, a radioterapia ou as chapas de raios-X t\u00eam \n\naplica\u00e7\u00f5es ben\u00e9ficas. Por outro lado, \u00e9 conhecido que a exposi\u00e7\u00e3o prolongada a esses mesmos \n\nraios-X pode provocar alguns tipos de tumores de pele [2] e outros efeitos prejudiciais, \n\ninequivocamente identificados desde as primeiras d\u00e9cadas de pesquisa e uso dessas radia\u00e7\u00f5es.  \n\n Para o caso das radia\u00e7\u00f5es n\u00e3o ionizantes al\u00e9m de problemas de compatibilidade \n\neletromagn\u00e9tica que podem causar interfer\u00eancia, por exemplo, em equipamentos hospitalares \n\n[3, 4], alguns efeitos associados ao aquecimento provocado pela absor\u00e7\u00e3o da energia da onda, \n\nos efeitos t\u00e9rmicos, tamb\u00e9m t\u00eam sido identificados, existindo aplica\u00e7\u00f5es e recomenda\u00e7\u00f5es de \n\nlimita\u00e7\u00f5es. \n\n O conhecimento e a identifica\u00e7\u00e3o de efeitos biol\u00f3gicos provocados por radiofreq\u00fc\u00eancias \n\ncomo as dos telefones celulares traz, apesar do receio de que possam provocar danos \u00e0 sa\u00fade, \n\numa esperan\u00e7a otimista do desenvolvimento de novas aplica\u00e7\u00f5es m\u00e9dicas.  \n\n 2.3.1 Efeitos T\u00e9rmicos \n\n Tecidos biol\u00f3gicos submetidos a campos de radia\u00e7\u00f5es n\u00e3o ionizantes podem sofrer \n\naquecimento, dependendo da freq\u00fc\u00eancia e da pot\u00eancia do sinal. Em freq\u00fc\u00eancias mais baixas \n\npodem ocorrer correntes induzidas com as correspondentes perdas \u00f4hmicas.  \n\n Em freq\u00fc\u00eancias para as quais o corpo humano ou parte dele podem se comportar como \n\numa boa antena, ou seja em freq\u00fc\u00eancias com o comprimento de onda da mesma ordem de \n\ngrandeza que o corpo humano ou suas partes, como na faixa de radiofreq\u00fc\u00eancias, os efeitos \n\nt\u00e9rmicos s\u00e3o causados pelo aquecimento direto dos tecidos biol\u00f3gicos como resultado da \n\nabsor\u00e7\u00e3o da energia eletromagn\u00e9tica num meio dissipativo. Por exemplo, nos meios \n\ndiel\u00e9tricos dissipativos nas quais a permissividade (ou constante diel\u00e9trica) apresenta uma \n\nparte imagin\u00e1ria maior que ?0, a parte imagin\u00e1ria (?r\u201d) da permissividade relativa pode ser \n\nrelacionada a uma condutividade equivalente \n\n \n \n\n)/(\"2 mSf ro???? =  \n(2) \n\n \n\nem que f \u00e9 a freq\u00fc\u00eancia e ?o \u00e9 a permissividade do v\u00e1cuo. Tanto os valores das partes real    \n\n(?r\u00b4 ) e imagin\u00e1ria (?r\u201d ) da permissividade relativa (?r = ?r\u00b4 - j ?r\u201d), bem como da \n\ncondutividade equivalente ?, variam substancialmente com a freq\u00fc\u00eancia e com o tipo de \n\ntecido [5]. Ao contr\u00e1rio das radia\u00e7\u00f5es n\u00e3o ionizantes em comprimentos de onda menores (e.g., \n\n \n\n\n\nContexto do Problema 7\n\nno infravermelho, ou no vis\u00edvel), as radia\u00e7\u00f5es em microondas e em r\u00e1dio freq\u00fc\u00eancia (RF) n\u00e3o \n\ns\u00e3o absorvidas apenas pela pele, mas, dependendo da freq\u00fc\u00eancia, em camadas mais profundas \n\nde tecidos tamb\u00e9m. Calculando a profundidade de penetra\u00e7\u00e3o pelicular ?, para freq\u00fc\u00eancias de \n\nRF e microondas de acordo com \n\neqf\u00b5??? = , \n(3) \n\nobtem-se, para valores de condutividade m\u00e9dios, ?eq [6], de tecidos como pele ou osso, e para \n\numa freq\u00fc\u00eancia f de 850 MHz, por exemplo, ?pele = 22 mm, ?osso = 16 mm. Uma vez que os \n\nsensores de temperatura do corpo humano est\u00e3o localizados somente na periferia do corpo \n\n(endoderme), efeitos prejudiciais aos tecidos podem ocorrer devido a aquecimentos \n\nexcessivos em regi\u00f5es mais profundas, sem serem percebidos pelas pessoas [7]. Note-se que \n\nas radia\u00e7\u00f5es predominantes no ambiente natural, provenientes do sol, est\u00e3o nas faixas do \n\nvis\u00edvel e do infravermelho pr\u00f3ximo, (e s\u00e3o absorvidas ent\u00e3o nas camadas superficiais da pele) \n\npara as quais o organismo tem capacidade sensorial e imunidade evolutiva. \n\n Ent\u00e3o, genericamente, todos os efeitos que podem acarretar um aumento de temperatura \n\nnos tecidos s\u00e3o chamados efeitos t\u00e9rmicos. Esses efeitos t\u00e9rmicos t\u00eam sido estudados h\u00e1 \n\nmuitas d\u00e9cadas, e os resultados da absor\u00e7\u00e3o dos campos eletromagn\u00e9ticos por diferentes tipos \n\nde tecidos s\u00e3o relativamente bem conhecidos, existindo mesmo normas internacionalmente \n\naceitas que estabelecem limites de exposi\u00e7\u00e3o em fun\u00e7\u00e3o da freq\u00fc\u00eancia de opera\u00e7\u00e3o, do tempo \n\nde exposi\u00e7\u00e3o, do tipo de usu\u00e1rio, etc., [8, 9]. Os limites de exposi\u00e7\u00e3o destas recomenda\u00e7\u00f5es \n\nconsideram que aquecimentos acima de 1 oC podem provocar efeitos teratog\u00eanicos ou \n\ndegenerativos [10]. \n\n 2.3.2 Efeitos N\u00e3o-T\u00e9rmicos \n\n Al\u00e9m dos fen\u00f4menos de aquecimento, pode-se esperar que ocorra intera\u00e7\u00e3o direta dos \n\ncampos eletromagn\u00e9ticos oscilat\u00f3rios, principalmente com as mol\u00e9culas polares presentes nos \n\nfluidos e tecidos biol\u00f3gicos. Os efeitos \u201cn\u00e3o-t\u00e9rmicos\u201d s\u00e3o, por exemplo, efeitos bioqu\u00edmicos \n\nou eletrof\u00edsicos causados, diretamente, pelos campos eletromagn\u00e9ticos induzidos, e n\u00e3o por \n\num aumento localizado ou distribu\u00eddo de temperatura. Alguns efeitos \u201cn\u00e3o-t\u00e9rmicos\u201d \n\nrelatados na literatura incluem efeitos nos sistemas nervoso, cardiovascular e imunol\u00f3gico, \n\nbem como no metabolismo e em fatores heredit\u00e1rios [11-13]. Entretanto, nessas \u00e1reas os \n\nresultados ainda s\u00e3o pol\u00eamicos, n\u00e3o existindo conclus\u00f5es definitivas, o que poder\u00e1 ainda \n\ndemorar muitos anos. Alguns resultados s\u00e3o mesmo conflitantes, especialmente devido a \n\nt\u00e9cnicas experimentais n\u00e3o muito confi\u00e1veis. Por exemplo: (a) os m\u00e9todos utilizados para \n\n \n\n\n\nContexto do Problema 8\n\ncaracterizar os sintomas em estudos epidemiol\u00f3gicos; (b) dosimetria em RF e microondas, \n\nespecialmente em campo pr\u00f3ximo; e (c) a presen\u00e7a de influ\u00eancias estranhas n\u00e3o consideradas \n\nna interpreta\u00e7\u00e3o dos resultados. \n\n Alguns efeitos sobre fun\u00e7\u00f5es espec\u00edficas ou em cobaias foram claramente demonstrados, \n\nrestando ainda as d\u00favidas sobre se estes efeitos se constituem em riscos \u00e0 sa\u00fade. Entre estes \n\nefeitos se incluem a altera\u00e7\u00e3o no fluxo de \u00edons atrav\u00e9s das membranas das c\u00e9lulas (afetando \n\nparticularmente as propriedades eletro-fisiol\u00f3gicas das c\u00e9lulas nervosas), altera\u00e7\u00e3o na \n\nmobilidade dos \u00edons de c\u00e1lcio (particularmente nos tecidos do c\u00e9rebro), altera\u00e7\u00f5es na s\u00edntese \n\nde DNA e na transcri\u00e7\u00e3o de RNA e efeitos na resposta de c\u00e9lulas normais a mol\u00e9culas \n\nsinalizantes (incluindo horm\u00f4nios, neurotransmissores e fatores de crescimento) [12]. \n\nAltera\u00e7\u00f5es no fluxo de c\u00e1lcio em c\u00e9lulas, na barreira hemato-encef\u00e1lica (blood-brain barrier, \n\nque protege o c\u00e9rebro de certas toxinas) e no desenvolvimento de tumores cerebrais foram \n\ntamb\u00e9m relatados [14]. \n\n Entre outras, uma incerteza importante, que est\u00e1 para ser confirmada, \u00e9 se esses efeitos \n\nn\u00e3o t\u00e9rmicos podem ou n\u00e3o ocorrer em taxas de absor\u00e7\u00e3o espec\u00edficas bem abaixo daquelas \n\nobservadas para os efeitos t\u00e9rmicos. Em cobaias, foram constatados efeitos no sistema \n\nimunol\u00f3gico, nas c\u00e9lulas nervosas e a ocorr\u00eancia de c\u00e2ncer ou carcinomas para n\u00edveis de \n\nexposi\u00e7\u00e3o abaixo dos limiares t\u00e9rmicos [12]. Tamb\u00e9m foram relatadas altera\u00e7\u00f5es no sistema \n\nend\u00f3crino, na qu\u00edmica sang\u00fc\u00ednea e nos sistemas hematol\u00f3gicos e imunol\u00f3gicos para \n\nexposi\u00e7\u00f5es prolongadas em n\u00edveis menores que os recomendados pelas normas [14]. \n\n Recentemente, foi relatada a indu\u00e7\u00e3o de prote\u00ednas de choque t\u00e9rmico (HSP- Heat-Shock \n\nProteins) em vermes do tipo nemat\u00f3ides (Caenorhabditis Elegans) com exposi\u00e7\u00e3o prolongada \n\na campos eletromagn\u00e9ticos de baixa intensidade, (tr\u00eas ordens de grandeza abaixo dos valores \n\npara os quais ocorrem os efeitos t\u00e9rmicos) o que foi atribu\u00eddo a mecanismos n\u00e3o t\u00e9rmicos que \n\npodem tamb\u00e9m ocorrer em tecidos humanos [15, 16]. Isto sugere, ent\u00e3o, que os limites atuais \n\nde exposi\u00e7\u00e3o devem ser reconsiderados. \n\n Entre as muitas d\u00favidas que ainda est\u00e3o por ser esclarecidas \u00e9 poss\u00edvel ressaltar, por \n\nexemplo, como o campo eletromagn\u00e9tico atua em determinadas estruturas, como: (a) nos \n\ncromossomos ou nas mol\u00e9culas de DNA que constituem os genes [5], e (b) na altera\u00e7\u00e3o da \n\nmobilidade dos \u00edons (por exemplo, de c\u00e1lcio), particularmente em tecidos do c\u00e9rebro e nas \n\npropriedades eletro-fisiol\u00f3gicas das c\u00e9lulas nervosas [12]. Por outro lado, \u00e9 sabido que um \n\nest\u00e1gio inicial do desenvolvimento do c\u00e2ncer \u00e9 caracterizado por uma altera\u00e7\u00e3o no c\u00f3digo \n\ngen\u00e9tico de c\u00e9lulas do corpo, isto \u00e9, a mol\u00e9cula de DNA. \n\n \n\n\n\nContexto do Problema 9\n\n 2.3.3 Efeitos e Riscos \n\n Ensaios reprodut\u00edveis, como os observados em nemat\u00f3ides [15, 16], indicam que ondas \n\neletromagn\u00e9ticas n\u00e3o ionizantes podem interagir com seres vivos provocando respostas \n\nidentific\u00e1veis mesmo em n\u00edveis de pot\u00eancia muito inferiores aos n\u00edveis para os quais se \n\nidentificam os efeitos t\u00e9rmicos. A exist\u00eancia dos \u201cefeitos n\u00e3o t\u00e9rmicos\u201d, a rigor, pode ser \n\nprovada com a repeti\u00e7\u00e3o deste tipo de experi\u00eancias. Por\u00e9m, a identifica\u00e7\u00e3o de um efeito como \n\neste, que n\u00e3o est\u00e1 associado diretamente a um risco \u00e0 sa\u00fade, isto \u00e9, n\u00e3o \u00e9 um efeito danoso ou \n\nn\u00e3o revers\u00edvel, ainda n\u00e3o seria suficiente para rever os limites de exposi\u00e7\u00e3o recomendados. \n\n Revendo o hist\u00f3rico das recomenda\u00e7\u00f5es e legisla\u00e7\u00f5es, observa-se que, \u00e0 medida que as \n\npesquisas avan\u00e7am e novos resultados aparecem, as normas s\u00e3o atualizadas e novos limites \n\nmais restringentes s\u00e3o sugeridos [17]. A constru\u00e7\u00e3o do conhecimento cientifico requer a \n\nverifica\u00e7\u00e3o de estudos estat\u00edsticos demorados e a repeti\u00e7\u00e3o de ensaios como o dos nemat\u00f3ides, \n\ncom o teste de hip\u00f3teses alternativas para os fen\u00f4menos observados. No est\u00e1gio atual das \n\npesquisas uma maioria de publica\u00e7\u00f5es relata que n\u00e3o foram encontrados efeitos significativos \n\ndas radia\u00e7\u00f5es de radiofreq\u00fc\u00eancias em pot\u00eancias abaixo das que provocam efeitos t\u00e9rmicos, em \n\nseres humanos. Isto n\u00e3o \u00e9 ainda suficiente para poder descartar com rigor cient\u00edfico os \n\nresultados de uma quantidade j\u00e1 significativa de trabalhos que indicariam a exist\u00eancia desses \n\nefeitos n\u00e3o t\u00e9rmicos [18]. \n\n2.4 EXPOSI\u00c7\u00c3O HUMANA A CAMPOS ELETROMAGN\u00c9TICOS \n\n Diversas normas e leis definem os limites de exposi\u00e7\u00e3o a partir dos efeitos t\u00e9rmicos, no \n\ncaso das recomenda\u00e7\u00f5es mais difundidas (ANSI, ICNIRP) [8, 9], ou de proje\u00e7\u00f5es que \n\nantecipam a demonstra\u00e7\u00e3o da exist\u00eancia de efeitos n\u00e3o t\u00e9rmicos, prejudiciais, mesmo em \n\nn\u00edveis mais baixos (normas su\u00ed\u00e7a e italiana) [19, 20].  \n\n 2.4.1 Par\u00e2metros Dosim\u00e9tricos \n\n Os limites indicados nas recomenda\u00e7\u00f5es podem ser expressos em densidade de pot\u00eancia \n\nincidente (e.g., em mW/cm2), intensidade de campo el\u00e9trico (V/m) ou magn\u00e9tico (A/m), ou de \n\num par\u00e2metro dosim\u00e9trico largamente utilizado: a \u201cTaxa de Absor\u00e7\u00e3o Espec\u00edfica\u201d (ou SAR - \n\nSpecific Absorption Rate). Esta \u00faltima \u00e9 definida como sendo a derivada no tempo do \n\naumento de energia \u201c?W\u201d absorvida ou dissipada num elemento de massa \u201c?m\u201d contida num \n\nelemento de volume \u201c?V\u201d cuja massa espec\u00edfica \u00e9 \u201c?\u201d [14, 21], e que analiticamente pode ser \n\nexpressa por \n\n \n\n\n\nContexto do Problema 10\n\n \n\n)/(\n)(\n\ngmW\nV\n\nW\ntm\n\nW\nt\n\nSAR\n?\n\n?\n?\n?\n\n=\n?\n?\n\n?\n?\n\n=\n?\n\n. \n(4) \n\n \n\n\u00c9 poss\u00edvel dizer, em outras palavras, que a SAR quantifica a pot\u00eancia absorvida por unidade \n\nde massa. Utilizando o teorema do Vetor de Poynting para campos eletromagn\u00e9ticos com \n\nexcita\u00e7\u00e3o senoidal no dom\u00ednio da freq\u00fc\u00eancia, a SAR pode ser tamb\u00e9m expressa por \n \n\n)/(\n222\n\n2\n202 gmW\n\nJ\nEESAR ii\n\nr\ni ???\n\n???\n?\n?\n\n=== , \n  \n\n(5) \n\nem que Ei e Ji s\u00e3o os valores de pico do campo el\u00e9trico e da densidade de corrente no local \n\nconsiderado. Observa-se que a SAR \u00e9 diretamente proporcional ao aumento local de \n\ntemperatura, respons\u00e1vel pelos efeitos t\u00e9rmicos \n \n\n)/( sC\nC\n\nSAR\nt\nT\n\nP\n\n\u00b0=\n?\n?\n\n, \n(6) \n\n \n\nem que T \u00e9 a temperatura, e Cp \u00e9 o calor espec\u00edfico do tecido (J/kg\u00d7\u00b0C). Podem ser \n\nimplementadas aproxima\u00e7\u00f5es mais precisas (como a da Equa\u00e7\u00e3o 7), para o c\u00e1lculo do \n\naumento de temperatura dT/dt num volume V, levando em considera\u00e7\u00e3o as perdas t\u00e9rmicas \n\npor radia\u00e7\u00e3o hRAD, convec\u00e7\u00e3o hCONV e evapora\u00e7\u00e3o hE, as trocas de calor pelo fluxo sang\u00fc\u00edneo \n\nbf  (sendo Tb e Cb a temperatura e o calor especifico do sangue arterial) e o calor gerado pelo \n\nmetabolismo hm.  \n\n( ) ( )[ ] ECONVRADbbfEMm hhhVTTCbhhTkt\nT\n\nmC ???\u00d7?+++??=\n?\n?\n\n. \n(7) \n\nA Equa\u00e7\u00e3o 7 [22] n\u00e3o pode ser resolvida por m\u00e9todos expl\u00edcitos como FDTD, sendo \n\nindicado, para a solu\u00e7\u00e3o da mesma, outros m\u00e9todos num\u00e9ricos, impl\u00edcitos, como, por \n\nexemplo, ADI (alternative direction, implicit) [23]. \n\nPara exposi\u00e7\u00e3o do corpo inteiro, por exemplo, pode-se considerar a SAR m\u00e9dia, que \n\nser\u00e1 ent\u00e3o a rela\u00e7\u00e3o entre a pot\u00eancia total absorvida pelo corpo e sua massa. Entretanto, para \n\naquecimentos localizados, como os produzidos pelos telefones celulares emitindo muito \n\npr\u00f3ximo (por exemplo, a 2 cm, 1 cm ou menos) da cabe\u00e7a do usu\u00e1rio, deve ser usada a SAR \n\nlocal, que \u00e9 definida como a pot\u00eancia absorvida (e.g., em mW) por um grama de tecido [9]. \n\n \n\n\n\nContexto do Problema 11\n\n 2.4.2 Principais Normas e Recomenda\u00e7\u00f5es \n\nEm fun\u00e7\u00e3o dos bem estabelecidos efeitos t\u00e9rmicos, diferentes normas t\u00eam sido propostas \n\n[17] entre as quais se destacam a norma C95.1 de 1992 do IEEE/ANSI (The Institute of \n\nElectrical and Electronics Engineers / American National Standards Institute) [8] adotada nos \n\nEstados Unidos e a ENV50166-2, de 1996/1998 do ICNIRP / CENELEC (International \n\nCommission on Non-Ionizing Radiation Protection / Comit\u00e9 Europ\u00e9en de Normalisation \n\nElectrotechnique) [9], adotada por diferentes pa\u00edses europeus. Estas recomenda\u00e7\u00f5es servem \n\nde base para diferentes legisla\u00e7\u00f5es nacionais ou locais [19-21, 24, 25]. As express\u00f5es dos \n\nvalores limites (em forma gr\u00e1fica na Figura 4), para as faixas de radiofreq\u00fc\u00eancias e \n\nmicroondas, pr\u00f3ximas \u00e0s usadas em servi\u00e7os de comunica\u00e7\u00e3o pessoal s\u00e3o dadas pelas \n\nEqua\u00e7\u00f5es 8 e 9. \n\n150\n)(\n\n2\n\nMHzf\nm\nW\n\nPANSI =?\n?\n?\n\n?\n?\n?\n\n? , \n(8) \n\n \n\n200\n)(\n\n2\n\nMHzf\nm\nW\n\nPICNIRP =?\n?\n?\n\n?\n?\n?\n\n? . \n(9) \n\n Para as freq\u00fc\u00eancias do celular das Bandas A e B do Brasil, a recomenda\u00e7\u00e3o IEEE/ANSI \n\nimplica em limites de densidade de pot\u00eancia de 5,7 W/m2 ou para exposi\u00e7\u00e3o local, uma SAR \n\nde 1,6 mW/g enquanto que a recomenda\u00e7\u00e3o ICNIRP adotada pela ANATEL define os seus \n\nlimites de densidade de pot\u00eancia em 4,3 W/m2 e SAR = 2 mW/g. \n\n  \n\n Figura 4. Limites de Exposi\u00e7\u00e3o em Fun\u00e7\u00e3o da Freq\u00fc\u00eancia. \n\n \n\n\n\nContexto do Problema 12\n\nEmbora os limites recomendados nessas normas sejam gerais, de validade em qualquer \n\nsitua\u00e7\u00e3o de irradia\u00e7\u00e3o, devido \u00e0s dificuldades de avalia\u00e7\u00e3o em campo pr\u00f3ximo at\u00e9 pouco \n\ntempo atr\u00e1s, os organismos reguladores dos diferentes paises (FCC no caso dos Estados \n\nUnidos) n\u00e3o avaliavam o atendimento as normas para transmissores port\u00e1teis, autorizando-os \n\ndesde que n\u00e3o superassem a pot\u00eancia transmitida de 740 mW. Em fun\u00e7\u00e3o da relev\u00e2ncia da \n\nquest\u00e3o comentada, tem havido um esfor\u00e7o para definir as metodologias de medida [26-28] de \n\nSAR e desde setembro de 2000, nos Estados Unidos \u00e9 requerida uma declara\u00e7\u00e3o do fabricante \n\nindicando que os valores de SAR medidos para seus produtos atendem \u00e0 norma C.95.1 \n\nIEEE/ANSI. Entretanto, um protocolo de medidas (especificando especialmente as dist\u00e2ncias \n\nentre a antena e a cabe\u00e7a) ainda n\u00e3o foi oficialmente estabelecido. \n\n 2.4.3 Postura Precaut\u00f3ria \n\n O Princ\u00edpio de Precau\u00e7\u00e3o \u00e9 um crit\u00e9rio de abordagem de riscos aplicado em circunst\u00e2ncias \n\ncom um alto grau de incerteza cient\u00edfica, refletindo a necessidade de tomar atitudes em face \n\nde riscos potencialmente s\u00e9rios, sem esperar os resultados da pesquisa cient\u00edfica, [29]. Como \n\nainda h\u00e1 incertezas a respeito dos efeitos n\u00e3o t\u00e9rmicos, alguns pa\u00edses, como It\u00e1lia e Su\u00ed\u00e7a \n\ninvocando este princ\u00edpio, adotaram recentemente limites mais restritivos [17, 19, 20]. O \n\ncrit\u00e9rio de precau\u00e7\u00e3o tamb\u00e9m foi recomendado para a exposi\u00e7\u00e3o a radiofreq\u00fc\u00eancias e \n\nmicroondas pela Organiza\u00e7\u00e3o Mundial de Sa\u00fade \u2013 OMS [18, 29]. \n\n Baseados nesta atitude, o Decreto N\u00b0 381. italiano [20], e a norma su\u00ed\u00e7a N\u00b0 814.710 [19] \n\nlimitam os valores de densidade de campo em 0,1 W/m2 e 0,043 W/m2 respectivamente, \n\nvalores dezenas de vezes menores que aqueles da recomenda\u00e7\u00e3o ICNIRP.  \n\n2.5 CAMPO DISTANTE \n\n O campo eletromagn\u00e9tico decresce com a dist\u00e2ncia \u00e0 antena emissora como mostram as \n\nExpress\u00f5es 10, 11 e 12, derivadas das equa\u00e7\u00f5es de componentes de campo para um dipolo. \n\n  \n\n32\n11\n\njkrr\nE r +? , \n\n(10) \n\n  \n\n2\n\n11\njkrr\n\nH +?? , \n(11) \n\n  \n\n \n\n\n\nContexto do Problema 13\n\n322\n\n111\nrkjkrr\n\nE ?+?? , \n(12) \n\n  \n\n Desta forma, o aumento da dist\u00e2ncia \u00e0 antena transmissora tem como resultado uma \n\ndiminui\u00e7\u00e3o consider\u00e1vel dos campos. Ent\u00e3o a contribui\u00e7\u00e3o aos valores dos campos, devida a \n\nantenas afastadas s\u00e3o pequenos, mesmo quando a antena emite elevadas pot\u00eancias. \n\nInversamente, transmissores de baixa pot\u00eancia muito pr\u00f3ximos do ponto onde se quer avaliar \n\no campo podem ser respons\u00e1veis por valores elevados, mais se a dist\u00e2ncia for suficientemente \n\npequena para ocorrer acoplamento eletromagn\u00e9tico ou se as componentes reativas (de valores \n\nimagin\u00e1rios) das equa\u00e7\u00f5es passam a ser relevantes \n\n 2.5.1 C\u00e1lculos para uma Esta\u00e7\u00e3o de Radiocomunica\u00e7\u00e3o \n\n Para avaliar o cumprimento das normas de limita\u00e7\u00e3o de exposi\u00e7\u00e3o a campos \n\neletromagn\u00e9ticos gerados por Esta\u00e7\u00f5es de Radiocomunica\u00e7\u00e3o, dois tipos de c\u00e1lculos s\u00e3o de \n\ninteresse: a) o c\u00e1lculo das \u201csuperf\u00edcies de contorno\u201d que definem a regi\u00e3o do espa\u00e7o para a \n\nqual as normas s\u00e3o observadas e b) o c\u00e1lculo do campo nos pontos em que ser\u00e3o realizadas as \n\nmedidas. O c\u00e1lculo das superf\u00edcies de contorno de atendimento \u00e0 norma, para \u201ccampos \n\ndistantes\u201d, \u00e9 baseado na express\u00e3o de Friis [30] para propaga\u00e7\u00e3o no espa\u00e7o livre, com linha de \n\nvisada direta, resultando numa aproxima\u00e7\u00e3o v\u00e1lida, desde que se confirme que as superf\u00edcies \n\ncalculadas n\u00e3o incluem nenhum obst\u00e1culo. Em caso de realizar avalia\u00e7\u00f5es em pontos mais \n\ndistantes, podem ser utilizados outros modelos que consideram as reflex\u00f5es e difra\u00e7\u00f5es nos \n\nobst\u00e1culos presentes, como os de Lee-Picquenard, Korowajczuk, Okomura-Hata ou COST \n\n[31-36], que aproximam melhor a condi\u00e7\u00e3o real do enlace entre a esta\u00e7\u00e3o e o ponto de medida \n\npara as diferentes zonas: densamente urbanizadas, urbanizadas, semi-urbanizadas, rurais, \n\nflorestais, por exemplo. \n\n Do equacionamento derivado da express\u00e3o de Friis, aplicado a uma esta\u00e7\u00e3o radiobase \n\n(ERB) de telefonia celular setorizada, a densidade de pot\u00eancia em um ponto (r,?,?) ??, situado \n\nna regi\u00e3o distante da antena pode ser estimada por meio de \n\n2\n\n3\n\n1\n\n4\n),(\n\n),,(\nr\n\nNDP\nrU m mmmmm\n\n?\n\n????\n??\n\n? ? ??= , \n(13) \n\n \n\n\n\nContexto do Problema 14\n\nem que, Pm representa a pot\u00eancia por canal efetivamente fornecida \u00e0 antena, Dm a fun\u00e7\u00e3o \n\ndiretividade da antena utilizada e Nm o n\u00famero de canais, para cada setor. Na f\u00f3rmula, ?m e \n\n?m.indicam a orienta\u00e7\u00e3o da antena de cada setor. \n\n Desde que a densidade de pot\u00eancia \u00e9 uma fun\u00e7\u00e3o monotonicamente decrescente da \n\ndist\u00e2ncia a antena, a superf\u00edcie de contorno a partir da qual \u00e9 observado o limite m\u00e1ximo de \n\ndensidade de pot\u00eancia, Umax, pode ser definida a partir de uma dist\u00e2ncia R (?,?) ?? dada por  \n\nm\u00e1x\n\nm mmmmm\n\nU\nNDP\n\nR\n?\n\n????\n??\n\n4\n),(\n\n),(\n3\n\n1? ? ??= . \n(14) \n\n \n\n Com base neste equacionamento e tendo em vista que a faixa de transmiss\u00e3o utilizada no \n\nsentido da ERB para as esta\u00e7\u00f5es m\u00f3veis varia de 869 MHz a 894 MHz, tomando os valores de \n\nUmax para a freq\u00fc\u00eancia mais baixa, pode se calcular as superf\u00edcies de contorno onde ocorrem \n\nos valores limites de densidade de pot\u00eancia para a norma cujo cumprimento se quer verificar. \n\n As Figuras 5 e 6 mostram os valores calculados para uma ERB t\u00edpica, das dist\u00e2ncias \n\nm\u00ednimas para as quais os limites das normas ANSI e ICNIRP (Figura 5) e su\u00ed\u00e7a e italiana \n\n(Figura 6) s\u00e3o atendidos. \n\n \n\nR1 P1 ?, ?,( )\n\nR2 P2 ?, ?,( )\n\n?p\n\n0\n\n30\n\n60\n\n90\n\n120\n\n150\n\n180\n\n210\n\n240\n\n270\n\n300\n\n330\n\n5\n\n4\n\n3\n\n2\n\n1\n\n0\n\nMetros\n\n \n\n Figura 5 Dist\u00e2ncias calculadas para o atendimento \u00e0s normas ICNIRP e ANSI para uma esta\u00e7\u00e3o  \n\nradiobase t\u00edpica (aprox. 4 m) para um plano horizontal na altura das antenas. \n\n \n\n\n\nContexto do Problema 15\n\n Para este exemplo de ERB t\u00edpica, os limites das normas ANSI e ICNIRP s\u00e3o observados a \n\npartir de aproximadamente 5 m, \n\n \n\nR3 P3 ?, ?,( )\n\nR4 P4 ?, ?,( )\n\n?p\n\n0\n\n30\n\n60\n\n90\n\n120\n\n150\n\n180\n\n210\n\n240\n\n270\n\n300\n\n330\n\n50\n\n40\n\n30\n\n20\n\n10\n\nMetros\n\n \n\n Figura 6. Dist\u00e2ncias calculadas para o atendimento \u00e0s legisla\u00e7\u00f5es Su\u00ed\u00e7a e Italiana para uma esta\u00e7\u00e3o  \n\nradiobase t\u00edpica (aprox. 30 e 40 m) para um plano horizontal na altura das antenas. \n\nenquanto que os limites das normas su\u00ed\u00e7a e italiana s\u00e3o observados a partir de \n\naproximadamente 40 m. \n\n As curvas das Figuras 5 e 6 correspondem a cortes de plano horizontal de superf\u00edcies \n\nque limitam a regi\u00e3o do espa\u00e7o para a qual os valores de densidade de campo irradiado \n\nsuperam as respectivas normas. No plano vertical, dada a diretividade t\u00edpica das antenas \n\nusadas nas ERB que visa estender a cobertura, os limites s\u00e3o como na Figura 7. \n\n                 \n\n Figura 7. Dist\u00e2ncias calculadas para o atendimento \u00e0s legisla\u00e7\u00f5es Su\u00ed\u00e7a e Italiana para uma esta\u00e7\u00e3o  \n\nradiobase t\u00edpica para um plano vertical no eixo das antenas. \n\n \n\n\n\nContexto do Problema 16\n\n As superf\u00edcies de contorno das Figuras 5 a 7 se constituem num par\u00e2metro de desempenho \n\nde leitura mais universal que os par\u00e2metros dosim\u00e9tricos citados nas recomenda\u00e7\u00f5es. \n\n 2.5.2 Medidas \n\n Por serem realizadas distantes da antena emissora, as medidas podem ser feitas com \n\ninstrumentos como analisador de espectro ou medidor de campo de RF, com antenas \n\nadequadas. Instrumentos, t\u00e9cnicas de medida, e resultados comprovando os c\u00e1lculos foram \n\npublicados em [37]. \n\n  \n\n \n\n Figura 8. Espectro eletromagn\u00e9tico observado nas proximidades de duas esta\u00e7\u00f5es de radiobase \n\n(Bandas A e B). \n\n \n\n Os resultados das medidas de monitoriza\u00e7\u00e3o realizados comprovam as estimativas \n\nte\u00f3ricas, na maioria dos casos. Por\u00e9m, em alguns casos, falhas na execu\u00e7\u00e3o do projeto ou \n\nelementos que n\u00e3o s\u00e3o considerados no projeto te\u00f3rico para o atendimento \u00e0s normas (como \n\ncabos de alimenta\u00e7\u00e3o com perdas) podem ser respons\u00e1veis por n\u00edveis de radia\u00e7\u00e3o elevados, \n\nfato pelo qual n\u00e3o \u00e9 prudente descartar a necessidade de medi\u00e7\u00f5es. \n\n \n\n  \n\n \n\n\n\nSimula\u00e7\u00e3o Num\u00e9rica 17\n\n 3 SIMULA\u00c7\u00c3O NUM\u00c9RICA \n\n Prever o atendimento \u00e0s recomenda\u00e7\u00f5es existentes para o caso dos usu\u00e1rios de \n\ntransceptores port\u00e1teis \u00e9 um problema de campo pr\u00f3ximo, no qual a cabe\u00e7a do usu\u00e1rio est\u00e1 \n\nnuma dist\u00e2ncia tal que interage com a antena modificando seu diagrama de irradia\u00e7\u00e3o. \n\nDiferente do problema em campo distante, o problema em campo pr\u00f3ximo requer solu\u00e7\u00f5es \n\nnum\u00e9ricas. Os m\u00e9todos mais usados para problemas semelhantes a este, de c\u00e1lculo de \n\npropaga\u00e7\u00e3o de ondas eletromagn\u00e9ticas, s\u00e3o o M\u00e9todo dos Momentos (MoM), e o m\u00e9todo das \n\nDiferen\u00e7as Finitas no Dom\u00ednio do Tempo (FDTD). Embora este \u00faltimo exija, geralmente, \n\nmaiores recursos computacionais ele \u00e9 mais adequado quando se trata de calcular a \n\npropaga\u00e7\u00e3o da onda numa estrutura altamente n\u00e3o homog\u00eanea, como \u00e9 um modelo apurado de \n\ncorpo humano, e em particular, da cabe\u00e7a.  \n\n  \n\n Figura 9. Diagrama de Blocos dos algoritmos implementados. \n\n  \n\n \n\n\n\nSimula\u00e7\u00e3o Num\u00e9rica 18\n\n A s\u00e9rie de algoritmos desenvolvida para encontrar a distribui\u00e7\u00e3o de campos vai al\u00e9m do \n\nalgoritmo FDTD b\u00e1sico, incluindo rotinas de entrada de dados, para a defini\u00e7\u00e3o do dom\u00ednio \n\ndo problema e da antena, rotinas de verifica\u00e7\u00e3o e valida\u00e7\u00e3o baseadas no monitoramento \n\ncont\u00ednuo dos valores em pontos pr\u00e9-escolhidos do dom\u00ednio, e rotinas de sa\u00edda, como rotinas \n\nde visualiza\u00e7\u00e3o gr\u00e1fica de matrizes de grande porte. \n\n  \n\n3.1 M\u00c9TODO FDTD \n\n O m\u00e9todo FDTD foi proposto inicialmente por Yee em 1967 [38] para resolver problemas \n\nde propaga\u00e7\u00e3o e espalhamento, diretamente a partir das equa\u00e7\u00f5es de Maxwell, de validade \n\ngeral, tamb\u00e9m em campo pr\u00f3ximo, diferentemente das equa\u00e7\u00f5es de onda. Nas d\u00e9cadas \n\nseguintes \u00e0 proposta original, diferentes autores t\u00eam contribu\u00eddo com seus desenvolvimentos \n\npara aperfei\u00e7oarem o m\u00e9todo [39] o que, junto com o aumento da capacidade computacional \n\ndispon\u00edvel tem permitido a populariza\u00e7\u00e3o do m\u00e9todo nos \u00faltimos anos, existindo j\u00e1 pacotes de \n\nsoftwares comerciais baseados em FDTD [40]. \n\n Algoritmos FDTD foram utilizados em c\u00e1lculos precisos de propaga\u00e7\u00e3o da onda \n\neletromagn\u00e9tica do telefone celular port\u00e1til na cabe\u00e7a do usu\u00e1rio, visando estimar seus \n\nposs\u00edveis efeitos quanto \u00e0 absor\u00e7\u00e3o de energia pela cabe\u00e7a [41-45].  \n\n Embora os efeitos t\u00e9rmicos estejam na origem dos limites de exposi\u00e7\u00e3o, esses s\u00e3o \n\napresentados em valores de densidade de campo ou de SAR que podem ser relacionados com \n\nos valores de temperatura pela Equa\u00e7\u00e3o 6. Para compara\u00e7\u00e3o com as limita\u00e7\u00f5es basta ent\u00e3o \n\ncalcular as componentes dos campos. Nas simula\u00e7\u00f5es apresentadas se calculam apenas os \n\ncampos eletromagn\u00e9ticos sem levar em conta a troca de calor do corpo ou a varia\u00e7\u00e3o dos \n\npar\u00e2metros dos tecidos em fun\u00e7\u00e3o da varia\u00e7\u00e3o da temperatura. \n\n Partindo de uma condi\u00e7\u00e3o inicial de campo nulo na totalidade do dom\u00ednio (ou de uma \n\ndistribui\u00e7\u00e3o de campo previamente calculada ou estabelecida) \u00e9 simulado um dipolo \n\nmagn\u00e9tico, que ser\u00e1 a condi\u00e7\u00e3o de contorno do m\u00e9todo num\u00e9rico ou a fonte do campo \n\neletromagn\u00e9tico e se faz com que este assuma as caracter\u00edsticas semelhantes \u00e0 antena de um \n\naparelho celular, para a qual se tem freq\u00fc\u00eancia e pot\u00eancia pr\u00e9-estabelecidas. Essas ondas se \n\npropagam a partir da fonte e, atrav\u00e9s de um n\u00famero elevado de itera\u00e7\u00f5es, penetram na cabe\u00e7a \n\ndo usu\u00e1rio. Ap\u00f3s a converg\u00eancia num\u00e9rica, o valor de campo calculado em todas as itera\u00e7\u00f5es \n\n\u00e9 utilizado para o c\u00e1lculo da SAR em cada c\u00e9lula do dom\u00ednio. Esses dados calculados s\u00e3o \n\n \n\n\n\nSimula\u00e7\u00e3o Num\u00e9rica 19\n\narmazenados novamente em matrizes e transformados posteriormente em novas imagens, \n\natrav\u00e9s das quais \u00e9 poss\u00edvel visualizar as distribui\u00e7\u00f5es de intensidade de campo e da SAR. \n\nNessas simula\u00e7\u00f5es, por simplifica\u00e7\u00e3o, n\u00e3o foram inclu\u00eddos no modelo os seguintes elementos: \n\naparelho, m\u00e3o e tronco do usu\u00e1rio. Esses elementos dever\u00e3o ser considerados em simula\u00e7\u00f5es \n\nque queiram implementar um modelo apurado, pois a altera\u00e7\u00e3o nas caracter\u00edsticas da antena, \n\ndevido aos mesmos pode n\u00e3o ser desprez\u00edvel, por se encontrarem no campo pr\u00f3ximo, e, em \n\nparticular, porque a barreira que o aparelho e a m\u00e3o representam para as perdas de calor por \n\nconvec\u00e7\u00e3o s\u00e3o certamente significativas para o caso de implementar equa\u00e7\u00f5es de temperatura \n\ncomo a Equa\u00e7\u00e3o 7. \n \n\n 3.1.1 Calculo dos Campos El\u00e9tricos e Magn\u00e9ticos \n\n O m\u00e9todo FDTD resolve as equa\u00e7\u00f5es rotacionais de Maxwell (Equa\u00e7\u00f5es 15 e 16), em \n\nforma de diferen\u00e7as finitas, num dom\u00ednio de c\u00e1lculo previamente discretizado [46].  \n\nHE\nt\n\nH rr\nr\n\n\u00b5\n?\n\n\u00b5\n????=\n\n?\n? 1\n\n, \n(15) \n\n  \n\nEH\nt\nE rr\nr\n\n?\n?\n\n?\n????=\n\n?\n? 1\n\n. \n(16) \n\n A Equa\u00e7\u00e3o 17 \u00e9 a equa\u00e7\u00e3o diferencial para a componente Hx do campo magn\u00e9tico, num \n\nsistema de coordenadas cartesianas, derivada da equa\u00e7\u00e3o rotacional 15. \n\n??\n?\n\n?\n??\n?\n\n?\n?\n\n?\n?\n\n?\n?\n\n?\n=\n\n?\n?\n\nx\nzyx H\n\ny\nE\n\nz\nE\n\nt\nH\n\n?\n\u00b5\n1\n\n. \n(17) \n\nNa proposta original de Yee, as equa\u00e7\u00f5es de Maxwell em forma diferencial (como a              \n\nEqua\u00e7\u00e3o 17) s\u00e3o substitu\u00eddas por equa\u00e7\u00f5es de diferen\u00e7as centrais de primeira ordem, tanto no \n\ntempo quanto no espa\u00e7o. Desta forma as componentes usadas nas equa\u00e7\u00f5es de diferen\u00e7as \n\nestar\u00e3o localizadas em pontos do dom\u00ednio ou em intervalos de tempo vizinhos ao ponto que se \n\nest\u00e1 calculando. Por exemplo, a Equa\u00e7\u00e3o 17, da componente Hx \u00e9 substitu\u00edda pela       \n\nEqua\u00e7\u00e3o 18.  \n\n \n\n\n\nSimula\u00e7\u00e3o Num\u00e9rica 20\n\n??\n?\n\n?\n\n?\n\n??\n?\n\n?\n\n?\n?\n\n?\n\n?\n?\n\n?\n\n?\n=\n\n=\n?\n\n?\n\n?+?+\n\n?+\n\nkji\nn\nxkji\n\nkji\nn\nzkji\n\nn\nzkji\n\nn\nykji\n\nn\ny\n\nkji\n\nkji\nn\nxkji\n\nn\nx\n\nH\ny\n\nEE\n\nz\n\nEE\nt\nHH\n\n,,,,\n\n,2\n1,,2\n\n1,2\n1,,2\n\n1,,\n\n,,\n\n,,\n2\n\n1\n\n,,\n2\n\n1\n\n1\n?\n\n\u00b5\n\n. \n\n \n\n(18) \n\n \n\n Nesta equa\u00e7\u00e3o expl\u00edcita, o valor da componente Hx, num ponto (i, j, k) do dom\u00ednio e num \n\ninstante ou itera\u00e7\u00e3o n+\u00bd, posterior, \u00e9 calculado a partir do valor de Hx no mesmo ponto        \n\n(i, j, k) num instante anterior n-\u00bd, e das componentes Ey e Ez do rotacional avaliadas num \n\ninstante eq\u00fcidistante (n) como melhor aproxima\u00e7\u00e3o e nos pontos da vizinhan\u00e7a (i, j, k+\u00bd),  \n\npor exemplo. \n\n A solu\u00e7\u00e3o completa do campo eletromagn\u00e9tico requer a solu\u00e7\u00e3o de todas as componentes \n\nde ambos os campos el\u00e9trico e magn\u00e9tico das equa\u00e7\u00f5es de Maxwell semelhantes \u00e0            \n\nEqua\u00e7\u00e3o 18 (seis para um problema espacial sem simetrias). Em alguns problemas pode ser \n\nconveniente o c\u00e1lculo das equa\u00e7\u00f5es de Maxwell em coordenadas cil\u00edndricas para aproveitar \n\nsimetrias. \n \n \n \n \n \n \n \n \n \n \n \n\n  \n\n  \n\n F \n\n  \n\nH \n\nE \n\nx \n\ny \nz \n\n(i,j,k) \n\n  \n\n igura 10. C\u00e9lula de Yee. Componentes de campo E no ponto central da c\u00e9lula s\u00e3o calculados usando \n\ncomponentes de campo H interpoladas. \n\n \n\n Desta forma, para usar diferen\u00e7as centrais de intervalos unit\u00e1rios, como se visualiza na \n\nFigura 10, nos pontos onde \u00e9 calculado o campo el\u00e9trico n\u00e3o se calcula o campo magn\u00e9tico, e \n\nvice-versa. O dom\u00ednio se torna um par de malhas entrela\u00e7adas onde os pontos de uma malha \n\n \n\n\n\nSimula\u00e7\u00e3o Num\u00e9rica 21\n\nnos quais se calcula um dos campos, el\u00e9trico ou magn\u00e9tico, s\u00e3o os centros dos segmentos das \n\nc\u00e9lulas da outra malha onde se calcula o outro campo. O algoritmo originalmente proposto \n\nalterna entre estas duas malhas e \u00e9 descrito como leap-frog (\u201cpulo do sapo\u201d) j\u00e1 que o passo de \n\ndiscretiza\u00e7\u00e3o para um campo pula os pontos de discretiza\u00e7\u00e3o do outro, localizados em pontos \n\ncom \u00edndices \u00bd se o passo for unit\u00e1rio (Equa\u00e7\u00e3o 18). Os instantes onde um e outro campo s\u00e3o \n\navaliados tamb\u00e9m s\u00e3o alternados e desencontrados. \n\n Este tipo de algoritmo leap-frog originalmente proposto duplica o tamanho do dom\u00ednio \n\nnecess\u00e1rio. Para um problema no qual a malha representa a maior parte da mem\u00f3ria usada \n\npara executar a simula\u00e7\u00e3o, isto implica em praticamente duplicar os recursos computacionais \n\nnecess\u00e1rios. Algumas alternativas, como avaliar as diferen\u00e7as em intervalos n\u00e3o unit\u00e1rios, \n\npodem ser testadas para evitar esta duplica\u00e7\u00e3o da malha, desde que se tenha cuidado em \n\nmanter a converg\u00eancia do m\u00e9todo. O algoritmo implementado usa as Equa\u00e7\u00f5es 19 a 24, que \n\ndiferem das equa\u00e7\u00f5es originalmente propostas, pelo fato de avaliar os rotacionais em pontos \n\nde discretiza\u00e7\u00e3o de \u00edndices inteiros e n\u00e3o em pontos de interpola\u00e7\u00e3o, mantendo o intervalo \n\nunit\u00e1rio. Aproxima\u00e7\u00f5es equivalentes para problemas de duas dimens\u00f5es se encontram em \n\n[47]. Por exemplo, os valores de campo el\u00e9trico (nas Equa\u00e7\u00f5es 19 a 21) que deviam ser \n\navaliados nesses pontos intermedi\u00e1rios (como era feito na Equa\u00e7\u00e3o 18) s\u00e3o aproximados aqui \n\npor valores pertencentes \u00e0 malha do campo magn\u00e9tico, n\u00e3o mais com sub\u00edndices k+\u00bd, k-\u00bd ou \n\nj+\u00bd, j-\u00bd, mas k+1, k ou j+1, j, evitando a duplica\u00e7\u00e3o da malha. Esta solu\u00e7\u00e3o tem se mostrado \n\nsatisfat\u00f3ria do ponto de vista da converg\u00eancia e valida\u00e7\u00e3o dos resultados \n\n  \n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n+\n\n?\n\n+\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n+\n\n?\n?\n\n=\n\n++\n\n?+\n\nyz\n\nt\n\nt\n\nt\n\nt\n\nn\n\nkji\n\nn\n\nkji\n\nn\n\nkji\n\nn\n\nkji\n\nkji\n\nkji\n\nkjin\n\nkji\n\nhji\n\nkji\n\nhji\n\nkji\n\nn\n\nkji\n\n,,,1,,,1,,\n\n,,\n\n,,\n\n,,1\n\n,,\n\n,,\n\n,,\n\n,,\n\n,,\n\n1\n\n,,\n.\n\n2\n\n'\n1\n\n2\n\n'\n1\n\n2\n\n'\n1\n\nEzEzEyEy\n\nHxHx\n\n\u00b5\n\n?\n\n\u00b5\n\n\u00b5\n\n?\n\n\u00b5\n\n?\n\n. \n\n \n\n(19) \n\n \n\n \n\n \n\n\n\nSimula\u00e7\u00e3o Num\u00e9rica 22\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n+\n\n?\n\n+\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n+\n\n?\n?\n\n=\n\n++\n\n?+\n\nzx\n\nt\n\nt\n\nt\n\nt\n\nn\n\nkji\n\nn\n\nkji\n\nn\n\nkji\n\nn\n\nkji\n\nkji\n\nkji\n\nkji\nn\n\nkji\n\nhji\n\nkji\n\nhji\n\nkji\n\nn\n\nkji\n\n,,1,,,,,,1\n\n,,\n\n,,\n\n,,\n1\n\n,,\n\n,,\n\n,,\n\n,,\n\n,,\n\n1\n\n,,\n.\n\n2\n'\n\n1\n2\n'\n\n1\n\n2\n'\n\n1\n\nExExEzEz\n\nHyHy\n\n\u00b5\n\n?\n\u00b5\n\n\u00b5\n\n?\n\u00b5\n\n?\n\n. \n\n \n\n(20) \n\n \n\n \n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n+\n\n?\n\n+\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n+\n\n?\n?\n\n=\n\n++\n\n?+\n\nzx\n\nt\n\nt\n\nt\n\nt\n\nn\n\nkji\n\nn\n\nkji\n\nn\n\nkji\n\nn\n\nkji\n\nkji\n\nkji\n\nkji\nn\n\nkji\n\nhji\n\nkji\n\nhji\n\nkji\n\nn\n\nkji\n\n,,,,1,,,1,\n\n,,\n\n,,\n\n,,\n1\n\n,,\n\n,,\n\n,,\n\n,,\n\n,,\n\n1\n\n,,\n.\n\n2\n'\n\n1\n2\n'\n\n1\n\n2\n'\n\n1\n\nEyEyExEx\n\nHzHz\n\n\u00b5\n\n?\n\u00b5\n\n\u00b5\n\n?\n\u00b5\n\n?\n\n. \n\n \n\n(21) \n\n \n\n \n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n+\n\n?\n\n+\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n+\n\n?\n?\n\n=\n\n+\n\n?\n\n++\n\n?\n\n+\n\n+\n\nzy\n\nt\n\nt\n\nt\n\nt\n\nn\n\nkji\n\nn\n\nkji\n\nn\n\nkji\n\nn\n\nkji\n\nkji\n\nkji\n\nkji\nn\n\nkji\n\nhji\n\nkji\n\nhji\n\nkji\n\nn\n\nkji\n\n1\n\n1,,\n\n1\n\n,,\n\n1\n\n,1,\n\n1\n\n,,\n\n,,\n\n,,\n\n,,\n\n,,\n\n,,\n\n,,\n\n,,\n\n,,\n\n1\n\n,,\n.\n\n2\n1\n\n2\n1\n\n2\n1\n\nHyHyHzHz\n\nExEx\n\n?\n\n?\n?\n\n?\n\n?\n?\n\n?\n\n. \n\n \n\n(22) \n\n \n\n \n\n \n\n\n\nSimula\u00e7\u00e3o Num\u00e9rica 23\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n+\n\n?\n\n+\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n+\n\n?\n?\n\n=\n\n+\n\n?\n\n++\n\n?\n\n+\n\n+\n\nxz\n\nt\n\nt\n\nt\n\nt\n\nn\n\nkji\n\nn\n\nkji\n\nn\n\nkji\n\nn\n\nkji\n\nkji\n\nkji\n\nkji\nn\n\nkji\n\nhji\n\nkji\n\nhji\n\nkji\n\nn\n\nkji\n\n1\n\n,,1\n\n1\n\n,,\n\n1\n\n1,,\n\n1\n\n,,\n\n,,\n\n,,\n\n,,\n\n,,\n\n,,\n\n,,\n\n,,\n\n,,\n\n1\n\n,,\n.\n\n2\n1\n\n2\n1\n\n2\n1\n\nHzHzHxHx\n\nEyEy\n\n?\n\n?\n?\n\n?\n\n?\n?\n\n?\n\n. \n\n \n\n(23) \n\n \n\n \n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n+\n\n?\n\n+\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n+\n\n?\n?\n\n=\n\n+\n\n?\n\n++\n\n?\n\n+\n\n+\n\nyx\n\nt\n\nt\n\nt\n\nt\n\nn\n\nkji\n\nn\n\nkji\n\nn\n\nkji\n\nn\n\nkji\n\nkji\n\nkji\n\nkji\nn\n\nkji\n\nhji\n\nkji\n\nhji\n\nkji\n\nn\n\nkji\n\n1\n\n,1,\n\n1\n\n,,\n\n1\n\n,,1\n\n1\n\n,,\n\n,,\n\n,,\n\n,,\n\n,,\n\n,,\n\n,,\n\n,,\n\n,,\n\n1\n\n,,\n.\n\n2\n1\n\n2\n1\n\n2\n1\n\nHxHxHyHy\n\nEzEz\n\n?\n\n?\n?\n\n?\n\n?\n?\n\n?\n\n. \n\n \n\n(24) \n\n \n\n \n \n\n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n\n Figura 11. Componentes de campo usados na aproxima\u00e7\u00e3o dos rotacionais das Equa\u00e7\u00f5es 19 a 24 \n\n(modifica\u00e7\u00e3o da c\u00e9lula de Yee). \n\n \n\n\n\nSimula\u00e7\u00e3o Num\u00e9rica 24\n\n  \n\n O sucesso deste tipo de aproxima\u00e7\u00e3o requer que se mantenha a consist\u00eancia dos \n\nrotacionais das diferentes componentes, usando valores de uma dada componente num dado \n\nponto sempre em duas equa\u00e7\u00f5es diferentes, mas com sinais diferentes (em rotacionais \n\ncalculados para duas c\u00e9lulas vizinhas), sob risco de o algoritmo divergir rapidamente. Outras \n\naproxima\u00e7\u00f5es, i.\u00e9., outras escolhas dos pontos para avaliar as componentes dos rotacionais, \n\nt\u00eam resultado em simula\u00e7\u00f5es que divergiram rapidamente. \n\n Usando estas novas equa\u00e7\u00f5es de diferen\u00e7as (19 a 24), evita-se a duplica\u00e7\u00e3o da malha \n\nespacial. A duplica\u00e7\u00e3o no tempo \u00e9 eliminada com uma perda da simetria das equa\u00e7\u00f5es, em \n\nrela\u00e7\u00e3o ao sub\u00edndice n das itera\u00e7\u00f5es. Isto, por sua vez, \u00e9 contornado processando-se as \n\nequa\u00e7\u00f5es na ordem que foram apresentadas. Este procedimento se justifica, pois, uma vez \n\ncalculadas as componentes da itera\u00e7\u00e3o n+1 do campo magn\u00e9tico, utilizando-se as      \n\nEqua\u00e7\u00f5es 19 a 21, poder\u00e3o ent\u00e3o ser calculadas as Equa\u00e7\u00f5es 22 a 24 do campo el\u00e9trico, pois \n\nessas \u00faltimas equa\u00e7\u00f5es s\u00e3o em fun\u00e7\u00e3o dos componentes calculados nas anteriores. \n\n Com este conjunto de equa\u00e7\u00f5es ordenadas pode-se resolver o valor de campo \n\niterativamente, para qualquer instante, e depois de um tempo de transiente, obter valores de \n\ncampo m\u00e1ximo ou m\u00e9dio, que ser\u00e3o usados no c\u00e1lculo da SAR, de acordo com a Equa\u00e7\u00e3o 5. \n\n3.2 MODELO DO DOM\u00cdNIO DO PROBLEMA \n\n O dom\u00ednio do problema \u00e9 um modelo discreto de cabe\u00e7a humana. Embora algumas \n\nnormas e procedimentos recomendem o uso de modelos com morfologias padr\u00e3o ou m\u00e9dias \n\n[48], que poderiam ser usados nessas simula\u00e7\u00f5es, foi desenvolvido um modelo pr\u00f3prio de \n\ncabe\u00e7a humana, sobre uma malha ortogonal suficientemente fina para produzir um modelo \n\ndetalhado. Uma base de dados m\u00e9dicos com imagens bidimensionais de diferentes cortes reais \n\n(sagitais e transversais), de Raios-X e Resson\u00e2ncia Magn\u00e9tica (Figura 12) com uma separa\u00e7\u00e3o \n\nde 0,9 mm entre cortes sucessivos, servem de ponto de partida para determinar o dom\u00ednio \n\nnum\u00e9rico onde o campo \u00e9 calculado, utilizando o m\u00e9todo FDTD.  \n\n \n\n\n\nSimula\u00e7\u00e3o Num\u00e9rica 25\n\n         \n\n Figura 12. Cortes sagitais (real e de resson\u00e2ncia magn\u00e9tica). \n\n  \n\n A partir dessas imagens e com ajuda de ferramentas comerciais de processamento de \n\nimagens, foram geradas 208 imagens de cortes idealizados, as quais foram retocadas \n\nmanualmente. Em cada imagem foram identificados e separados os diferentes tecidos que \n\ncomp\u00f5em o corte e que ser\u00e3o considerados homog\u00eaneos e invariantes nos c\u00e1lculos: \n\npele/gordura, m\u00fasculos, ossos, c\u00e9rebro, olhos e o pr\u00f3prio ar, usando para isto cores prim\u00e1rias \n\npara maior facilidade em posterior reconhecimento destas pelo algoritmo (Figura 13). Cada \n\nimagem foi programada para ser composta de 225 \u00d7 256 pontos ou pixels, de forma que a \n\ndist\u00e2ncia entre pixels corresponda aos mesmos 0,9 mm da dist\u00e2ncia entre cortes para gerar \n\numa malha homog\u00eanea de 57.600 c\u00e9lulas por corte, totalizando, aproximadamente,               \n\n12 milh\u00f5es de pontos.  \n\n    \n\n Figura 13. Imagem de cortes sagital idealizado, usada para a gera\u00e7\u00e3o do dom\u00ednio de c\u00e1lculo. \n\n  \n\n \n\n\n\nSimula\u00e7\u00e3o Num\u00e9rica 26\n\n As dimens\u00f5es do modelo utilizado (mostradas na Figura 14) s\u00e3o compat\u00edveis com as dos \n\nmodelos recomendados [48] e com as apresentadas em trabalhos de outros autores [40-43]. \n\n                 \n      \n\n20,25  cm \n\n  \n\n  \n\n Ap\u00f3s a determina\u00e7\u00e3o d\n\nbidimensionais, o program\n\ndesta matriz estar\u00e1 relac\n\nespec\u00edfico, referente \u00e0 sua \n\n As imagens s\u00e3o conve\n\narquivos que se usa uma ro\n\no tecido correspondente. N\n\ndireto j\u00e1 que o arquivo d\n\ncabe\u00e7alho, reproduz os \u00edn\n\ntecido com um valor (n\u00e3o\n\nidentifica\u00e7\u00e3o), pode-se ex\n\nimagem de corte idealizad\n\natrav\u00e9s da soma das 208\n\ntridimensional (3D), rep\n\n11.980.800 c\u00e9lulas. \n\n \n\n16,2 cm\n Figura 14. Dimens\u00f5es do modelo uti\n\no espa\u00e7o f\u00edsico do problema, atrav\n\na deve criar uma matriz que ser\u00e1 o \n\nionada a uma localiza\u00e7\u00e3o no esp\n\nposi\u00e7\u00e3o.  \n\nrtidas em arquivos bitmap, com a d\n\ntina de reconhecimento de padr\u00f5es\n\no caso dos arquivos utilizados, este\n\ne cada imagem, convertido em t\n\ndices das componentes de cor no\n\n necessariamente igual ao valor da \n\ntrair uma matriz num\u00e9rica bidim\n\no, de modo que durante o process\n\n matrizes correspondentes aos 20\n\nresentando o dom\u00ednio do prob\n23,04 cm\nlizado. \n\n\u00e9s de um conjunto de imagens \n\ndom\u00ednio de c\u00e1lculo. Cada c\u00e9lula \n\na\u00e7o e, portanto, a um tecido \n\nimens\u00e3o apropriada, e \u00e9 nesses \n\n para identificar, em cada ponto, \n\n reconhecimento \u00e9 praticamente \n\nexto e uma vez eliminado seu \n\n padr\u00e3o RGB. Indexando cada \n\ncomponente RGB usada para a \n\nensional (Figura 15) de cada \n\namento da simula\u00e7\u00e3o, obt\u00e9m-se \n\n8 cortes sagitais, uma matriz \n\nlema com a composi\u00e7\u00e3o de              \n\n\n\nSimula\u00e7\u00e3o Num\u00e9rica 27\n\n  \n\n Figura 15. Plano da matriz gerada. Cada \u00edndice corresponde a um material. \n\n  \n\n Os diferentes meios que constituem o modelo da cabe\u00e7a foram definidos de acordo com \n\nos par\u00e2metros eletromagn\u00e9ticos m\u00e9dios dos diferentes tecidos presentes [40, 43, 49, 50]. \n\nAssim tecidos que apresentam valores semelhantes foram considerados, por simplicidade, \n\ncomo um \u00fanico meio. Desde que essas caracter\u00edsticas s\u00e3o dependentes da freq\u00fc\u00eancia da \n\nradia\u00e7\u00e3o \u00e0 qual s\u00e3o submetidos, os par\u00e2metros correspondem \u00e0 freq\u00fc\u00eancia simulada           \n\n(850 MHz). Embora haja altera\u00e7\u00e3o desses par\u00e2metros com a temperatura, para evitar c\u00e1lculos \n\nde pouca relev\u00e2ncia, os valores utilizados s\u00e3o mantidos constantes sem que haja uma corre\u00e7\u00e3o \n\nou realimenta\u00e7\u00e3o a partir do c\u00e1lculo dos valores de SAR. O objeto destas simula\u00e7\u00f5es \u00e9 o \n\nc\u00e1lculo da SAR para compara\u00e7\u00e3o com as recomenda\u00e7\u00f5es e outros resultados publicados, n\u00e3o \n\nsendo inclu\u00eddo um modelo termodin\u00e2mico para, a partir da SAR calcular a temperatura. N\u00e3o \n\nobstante, o aumento de temperatura previsto \u00e9 da ordem de d\u00e9cimos de grau [51] o que n\u00e3o \n\njustifica altera\u00e7\u00f5es significativas nos valores dos par\u00e2metros usados. A Tabela 1 expressa os \n\nprincipais par\u00e2metros utilizados nas simula\u00e7\u00f5es (permissividade relativa, condutividade e \n\nmassa espec\u00edfica). \n\n Tabela 1. Par\u00e2metros dos tecidos usados na simula\u00e7\u00e3o. \n\nTecido ?r ? [S/m] ? [kg/l] \nPele/Gordura 34.5 0.600 1.10 \nM\u00fasculo 58.5 1.210 1.04 \nOsso 8.0 1.105 1.85 \nC\u00e9rebro 55.0 1.230 1.03 \nOlho 67.9 1.680 1.02 \n\n \n\n\n\nSimula\u00e7\u00e3o Num\u00e9rica 28\n\n Analisando os valores da tabela acima se pode prever que os valores elevados para a \n\nconstante diel\u00e9trica relativa provocar\u00e3o uma concentra\u00e7\u00e3o de densidade de fluxo el\u00e9trico nos \n\ntecidos correspondentes, o que, associado aos altos valores de condutividade, ir\u00e1 resultar em \n\nSAR elevada de acordo com a Equa\u00e7\u00e3o 5. \n\n3.3 MODELO DA FONTE \n\n Muitos aparelhos celulares utilizados atualmente s\u00e3o dotados de antenas tipo monopolo, \n\ndipolo ou helicoidal, que apresentam diagramas de irradia\u00e7\u00e3o sim\u00e9tricos no plano horizontal, \n\nquando afastados de qualquer obst\u00e1culo. A Figura 16 mostra o diagrama de irradia\u00e7\u00e3o de um \n\nmonopolo vertical, comparado com uma fonte isotr\u00f3pica (bi e tri-dimensional). Quando da \n\npresen\u00e7a de um corpo no campo pr\u00f3ximo da antena, esses diagramas ficam substancialmente \n\nalterados. \n\n    \n\n Figura 16. Diagramas de irradia\u00e7\u00e3o de um dipolo e de uma fonte isotr\u00f3pica. \n\n  \n\n Existem diferentes maneiras de modelar a fonte irradiadora. Como primeira aproxima\u00e7\u00e3o, \n\numa vez definidos os pontos do espa\u00e7o onde estar\u00e1 localizada a antena, \u00e9 poss\u00edvel for\u00e7ar neles \n\no valor do campo el\u00e9trico, ou o campo magn\u00e9tico nas c\u00e9lulas da vizinhan\u00e7a de um plano \n\nnormal \u00e0 dire\u00e7\u00e3o da antena, ajustado aos valores de corrente na antena, ou ainda ambos \n\ncampos E e H simultaneamente. Neste caso, os pontos do dom\u00ednio que representam a antena \n\nformam parte de uma coluna da matriz, e aparecer\u00e3o no algoritmo como uma fonte de sinal ou \n\n\u201cporta de entrada\u201d eletromagn\u00e9tica.  \n\n Uma aproxima\u00e7\u00e3o mais precisa consiste em descrever o material da antena (metal) como \n\ncondutor com um valor de condutividade elevado ou um condutor ideal (sem perdas) \n\nassumindo a condutividade do metal tendendo ao infinito (? ? ?). Com essa aproxima\u00e7\u00e3o, as \n\n \n\n\n\nSimula\u00e7\u00e3o Num\u00e9rica 29\n\nEqua\u00e7\u00f5es 22 a 24, do c\u00e1lculo de campo el\u00e9trico, v\u00e3o sofrer simplifica\u00e7\u00f5es, agilizando o \n\nprocessamento. Uma poss\u00edvel alternativa \u00e9 manter as equa\u00e7\u00f5es gerais, utilizando um valor de \n\ncondutividade apropriado. A antena utilizada nas simula\u00e7\u00f5es \u00e9 um modelo de monopolo como \n\napresentado na Figura 17. O campo \u00e9 for\u00e7ado apenas na entrada de alimenta\u00e7\u00e3o da antena ou \n\nem um ponto mais distante conectado \u00e0 entrada da antena por c\u00e9lulas que est\u00e3o totalmente \n\ncircundadas por metal, simulando assim a alimenta\u00e7\u00e3o por cabo coaxial. Se cada c\u00e9lula tem \n\n0,9 mm e o comprimento da antena for ?/4 para aproximadamente 850 MHz, ou seja, 8,82 cm, \n\nou 98 c\u00e9lulas, observa-se que o n\u00famero de c\u00e9lulas destas figuras n\u00e3o guarda propor\u00e7\u00e3o com as \n\nutilizadas. \n\n   \n\n Figura 17. Esquema das diferentes vistas (lateral e superior) da simula\u00e7\u00e3o                                             \n\nde um monopolo com plano terra. \n\n Para a valida\u00e7\u00e3o do modelamento da fonte, foram realizadas diversas simula\u00e7\u00f5es sem o \n\nobst\u00e1culo representado pela cabe\u00e7a (i.\u00e9. com a antena num dom\u00ednio contendo somente ar). \n\nAp\u00f3s um n\u00famero de itera\u00e7\u00f5es suficiente para a converg\u00eancia dos valores de campo, observa-\n\nse, a partir dos valores na matriz de |E|, a isotropia na propaga\u00e7\u00e3o, o comprimento de onda e a \n\nvelocidade de propaga\u00e7\u00e3o, como ilustrado na Figura 18. \n\n   \n\n Figura 18. Campo El\u00e9trico observado (vista superior e lateral para uma simula\u00e7\u00e3o teste                         \n\nde um monopolo. \n\n \n\n\n\nSimula\u00e7\u00e3o Num\u00e9rica 30\n\n3.4 SIMULA\u00c7\u00c3O DO ESPA\u00c7O LIVRE \n\n Um problema que os algoritmos FDTD devem considerar \u00e9 a simula\u00e7\u00e3o do espa\u00e7o livre. O \n\ndom\u00ednio computacional \u00e9 necessariamente finito, ent\u00e3o o dom\u00ednio de simula\u00e7\u00e3o deve ser \n\ntruncado. A primeira aproxima\u00e7\u00e3o para uma condi\u00e7\u00e3o de contorno na borda do dom\u00ednio seria \n\na de supor os campos suficientemente atenuados para considerarmos o seu valor nulo. Por\u00e9m, \n\nimediatamente podem ser observadas as semelhan\u00e7as entre esta solu\u00e7\u00e3o e a modelagem de \n\numa superf\u00edcie met\u00e1lica, perfeitamente condutora e, portanto, refletora. Este tipo de \n\ntruncamento provoca ent\u00e3o, reflex\u00f5es da onda propagante nas bordas do dom\u00ednio [46]. \n\n \n\n20 40 60 80 100 \n\n20 \n\n40 \n\n60 \n\n80 \n\n100 -10 \n\n-5 \n\n0 \n\n5 \n\n10 \n\n \n\n Figura 19. Vista superior de um pulso propagando (campo el\u00e9trico) para uma condi\u00e7\u00e3o de borda \n\ndescasada (esquerda) e casada (direita). A borda absorvedora tem 18 c\u00e9lulas de largura. \n\n  \n\n Entre as diferentes solu\u00e7\u00f5es propostas para uma eficiente simula\u00e7\u00e3o do espa\u00e7o livre pode-\n\nse citar o c\u00e1lculo do valor da condi\u00e7\u00e3o de contorno usando equa\u00e7\u00f5es de campo distante e o \n\nuso de equa\u00e7\u00f5es e algoritmos espec\u00edficos para as regi\u00f5es limites do dom\u00ednio, por exemplo, \n\naproximando as equa\u00e7\u00f5es diferenciais n\u00e3o mais por diferen\u00e7as centrais e sim por diferen\u00e7as \n\nlaterais nos pontos do limite do dom\u00ednio (para que n\u00e3o seja necess\u00e1rio estimar valores em \n\npontos de \u201cfora do dom\u00ednio\u201d) [39, 46]. Entre essas foram escolhidas, ap\u00f3s alguns ensaios com \n\noutros m\u00e9todos, duas solu\u00e7\u00f5es de condi\u00e7\u00f5es de bordas absorvedoras (ABC). A primeira \n\nsolu\u00e7\u00e3o calculada a partir da proposta de Mur [46] considera aproxima\u00e7\u00f5es da dire\u00e7\u00e3o de \n\npropaga\u00e7\u00e3o nos diferentes limites do dom\u00ednio e, usando equa\u00e7\u00f5es diferenciais de segunda \n\nordem, encontra novas equa\u00e7\u00f5es para a regi\u00e3o de borda. A Equa\u00e7\u00e3o 25 exemplifica a forma de \n\nc\u00e1lculo j\u00e1 em diferen\u00e7as finitas, de acordo com o equacionamento de Mur, de uma \n\ncomponente de campo W (v\u00e1lida para todas as componentes de campo E e campo H) para o \n\nplano de x = 0 de uma malha homog\u00eanea na qual ?x = ?y = ?z = ?. \n\n \n\n\n\nSimula\u00e7\u00e3o Num\u00e9rica 31\n\n( )\n( )\n\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n?\n?\n?\n?\n?\n?\n?\n\n?\n\n?\n\n+++\n\n++?\n\n++?\n\n?+??\n?\n\n+?\n?\n\n?\n?\n?\n\n?\n+\n\n?+?\n?\n\n+?\n?\n\n?\n?\n?\n\n?\n+\n\n?+?\n???\n\n+?=\n\n?+?+\n\n?+\n\n?+\n\n?+?+\n\nn\n\nkj\n\nn\n\nkj\n\nn\n\nkj\n\nn\n\nkj\n\nn\n\nkj\n\nn\n\nkj\n\nn\n\nkj\n\nn\n\nkj\n\nn\n\nkj\n\nn\n\nkj\n\nn\n\nkj\n\nn\n\nkj\n\nn\n\nkj\n\nn\n\nkj\n\nn\n\nkj\n\nn\n\nkj\n\nWWWW\n\nWWW\n\nWWW\n\ntc\ntc\n\nWW\ntc\n\nWW\ntc\ntc\n\nWW\n\n1,,01,,11,,01,,0\n\n,1,1,,1,1,1\n\n,1,0,,0,1,0\n2\n\n,,0,,1\n\n1\n\n,,0\n\n1\n\n,,1\n\n1\n\n,,1\n\n1\n\n,,0\n\n4\n\n4\n\n2\n\n2\n\n. \n\n \n\n(25) \n\n \n\n  \n\n Diferentes algoritmos de cancelamento de erros e varia\u00e7\u00f5es da ABC foram propostos para \n\nmelhorar a absor\u00e7\u00e3o da borda [46, 52]. A segunda solu\u00e7\u00e3o utiliza um material de borda com \n\ncaracter\u00edsticas absorvedoras (\u201cABC\u201d), e com a condi\u00e7\u00e3o geradora da Perfect Matching Layer \n\n(\u201cPML\u201d) [46, 53, 54]. A PML \u00e9 uma proposta recente [53, 54] que promete minimizar as \n\nreflex\u00f5es das ondas incidentes na borda do dom\u00ednio usando materiais de borda complexos e \n\nfen\u00f4menos como condutividade magn\u00e9tica, definidos a partir do modelo matem\u00e1tico e sem \n\nequivalentes reais. O termo ?* \u00e9 o termo dual da condutividade, para o campo H, nas \n\nequa\u00e7\u00f5es de Maxwell, e \u00e9 associado a cargas ou monopolos magn\u00e9ticos n\u00e3o observados na \n\nrealidade. A identidade da Equa\u00e7\u00e3o 26 \u00e9 o ponto de partida do desenvolvimento de uma PML \n\n[46]. \n\n0\n\n*\n\n0 \u00b5\n?\n\n?\n?\n\n=\n. \n\n(26) \n\n Foi implementada, ent\u00e3o, uma camada absorvedora de uma profundidade de 30 c\u00e9lulas do \n\ndom\u00ednio com diferentes materiais com caracter\u00edsticas anisotr\u00f3picas de condutividade. Com \n\nesta solu\u00e7\u00e3o s\u00e3o obtidas atenua\u00e7\u00f5es superiores a 30 dB na reflex\u00e3o e j\u00e1 foram relatadas \n\natenua\u00e7\u00f5es de mais de 70 dB por outros autores [53, 54]. \n\n Ambos os tipos de borda s\u00e3o sens\u00edveis ao \u00e2ngulo de incid\u00eancia da onda propagante. Desta \n\nforma as bordas s\u00e3o otimizadas para diferentes dire\u00e7\u00f5es e t\u00eam melhor desempenho quando as \n\nondas incidem nelas ortogonalmente. Em problemas de geometrias mais simples \u00e9 f\u00e1cil prever \n\na dire\u00e7\u00e3o de propaga\u00e7\u00e3o para, a partir dela, ajustar a borda. J\u00e1 no caso de um corpo ou cabe\u00e7a \n\n \n\n\n\nSimula\u00e7\u00e3o Num\u00e9rica 32\n\nhumana o espalhamento da onda dificulta este ajuste e prejudica o desempenho da borda, sem \n\nque isto comprometa a validade dos resultados calculados. \n\n3.5 CONVERG\u00caNCIA DO M\u00c9TODO \n\n M\u00e9todos expl\u00edcitos como o FDTD tendem a propagar rapidamente os erros [23] e divergir \n\nap\u00f3s um n\u00famero suficiente de itera\u00e7\u00f5es, pelo que se torna particularmente importante \n\ndiminuir as componentes de erro, representadas pelo fator O(?x )2 , na equa\u00e7\u00e3o abaixo [46]. \n\n])[(\n),,,( 2,,2\n\n1\n,,\n\n2\n1\n\nxO\nt\n\nuu\n\nx\ntnzkyjxiu kji\n\nn\nkji\n\nn\n\n?+\n?\n\n?\n=\n\n?\n????? ?+\n\n. \n\n \n\n(27) \n\n \n\n Os crit\u00e9rios de converg\u00eancia do algoritmo desenvolvido s\u00e3o os mesmos de um algoritmo \n\nFDTD gen\u00e9rico [46]. Por exemplo, para o caso de uma malha de discretiza\u00e7\u00e3o homog\u00eanea \n\ncom ?x = ?y = ?z = 0,9 mm e para uma onda propagante de freq\u00fc\u00eancia igual a 850MHz, o \n\nintervalo de tempo entre itera\u00e7\u00f5es deve ser menor ou igual a ?t = 3,4665x10-12 segundos de \n\nacordo com a Inequa\u00e7\u00e3o 28. \n\n222\n111\n\n1\n\n?\n?\n?\n\n?\n?\n?\n?\n\n+??\n?\n\n?\n??\n?\n\n?\n?\n\n+?\n?\n?\n\n?\n?\n?\n?\n\n??\n\nzyx\nc\n\nt\n. \n\n \n\n(28) \n\n \n\n Diferente de outros m\u00e9todos num\u00e9ricos nos quais o erro diminui junto com o passo entre \n\nitera\u00e7\u00f5es ?t, para algoritmos FDTD em malha homog\u00eanea (?x = ?y = ?z) o m\u00e1ximo valor de \n\n?t que permite a converg\u00eancia, cancela o erro de discretiza\u00e7\u00e3o. Usando esses valores, se \n\ndemonstra que o resultado da solu\u00e7\u00e3o num\u00e9rica (nos pontos nos quais \u00e9 calculada) \u00e9 exato, \n\nid\u00eantico ao da solu\u00e7\u00e3o alg\u00e9brica, se esta existir, sendo cancelados os erros de quantiza\u00e7\u00e3o, \n\ntendo apenas o erro derivado do truncamento computacional. Por estas propriedades, este \n\nintervalo de tempo \u00e9 chamado de Magic Step [46]. \n\n Na simula\u00e7\u00e3o implementada, desde que o m\u00e9todo sofreu algumas adapta\u00e7\u00f5es e n\u00e3o se \n\npode mais garantir o cancelamento dos erros de discretiza\u00e7\u00e3o, \u00e9 calculado um valor de ?t de \n\nacordo com a Inequa\u00e7\u00e3o 25, tomando cuidado para garantir que os erros de c\u00e1lculo do \n\ntruncamento n\u00e3o fa\u00e7am com que o valor do tempo entre itera\u00e7\u00f5es supere o Magic Step o que \n\nlevaria a diverg\u00eancia da simula\u00e7\u00e3o. Observando os valores das diferentes componentes de \n\ncampo calculadas, a cada itera\u00e7\u00e3o, para um conjunto de pontos distribu\u00eddos no dom\u00ednio, pode-\n\nse observar o intervalo de converg\u00eancia do m\u00e9todo como na Figura 20. \n\n \n\n\n\nSimula\u00e7\u00e3o Num\u00e9rica 33\n\n \n\nPontos FDTD\n\n-2,00E+00\n\n-1,00E+00\n\n0,00E+00\n\n1,00E+00\n\n2,00E+00\n\n1 51 101 151 201 251 301 351 401\n\nItera\u00e7\u00e3o\n\nC\nam\n\npo\n\nex_mid_ant\ney_mid_ant\nez_mid_ant\nex_mid_50p\ney_mid_50p\nez_mid_50p\nmonitor\n\n \n\n Figura 20. Monitoriza\u00e7\u00e3o ao longo das itera\u00e7\u00f5es dos valores de diferentes componentes de campo \n\nel\u00e9trico na qual se observa o intervalo de converg\u00eancia (400 itera\u00e7\u00f5es neste caso).  \n\n  \n\n 3.6 Valida\u00e7\u00e3o do Algoritmo Implementado \n\n Parte fundamental das simula\u00e7\u00f5es num\u00e9ricas reside na confiabilidade dos resultados \n\nobtidos. Mesmo observadas as condi\u00e7\u00f5es matem\u00e1ticas de estabilidade e converg\u00eancia e \n\navaliados os erros de truncamento, \u00e9 necess\u00e1rio o teste do algoritmo com problemas para os \n\nquais se conhece a solu\u00e7\u00e3o. No caso presente, embora n\u00e3o se tenha testado o programa com \n\numa bateria completa de problemas benchmark, a sua resposta foi comprovada para a \n\npropaga\u00e7\u00e3o de pulsos e ondas senoidais em meios homog\u00eaneos, observando os fen\u00f4menos \n\nmais conhecidos de mudan\u00e7a de comprimento de onda na interface entre dois meios, reflex\u00f5es \n\ne difra\u00e7\u00e3o em fendas.  \n\n Para a simula\u00e7\u00e3o da propaga\u00e7\u00e3o de uma onda no ar foi medida uma velocidade de \n\npropaga\u00e7\u00e3o de 303.000.000 m/s. Este valor tem um erro de 1% que \u00e9 inferior ao que pode ser \n\njustificado pela discretiza\u00e7\u00e3o do dom\u00ednio. Tamb\u00e9m foram comprovados os diagramas de \n\nirradia\u00e7\u00e3o de antenas conhecidas (dipolos) em simula\u00e7\u00f5es realizadas em dom\u00ednios \n\nsuficientemente grandes para chegar a uma situa\u00e7\u00e3o de campo distante. \n\n \n\n\n\nSimula\u00e7\u00e3o Num\u00e9rica 34\n\n3.7 O ALGORITMO IMPLEMENTADO \n\n Na primeira etapa de desenvolvimento, os algoritmos utilizados para uma simula\u00e7\u00e3o em \n\nduas dimens\u00f5es foram implementados em Matlab? para aproveitar as bibliotecas dispon\u00edveis \n\ncomo, por exemplo, as rotinas gr\u00e1ficas de sa\u00edda. Logo ap\u00f3s destas primeiras simula\u00e7\u00f5es, ficou \n\nevidente que uma plataforma PC n\u00e3o seria suficiente para poder processar uma simula\u00e7\u00e3o em \n\ntr\u00eas dimens\u00f5es com o detalhamento desejado. Os algoritmos FDTD geralmente requerem \n\nmassivos recursos computacionais, e, se considerarmos que o dom\u00ednio de c\u00e1lculo, incluindo \n\nas bordas possui mais de 24 milh\u00f5es de pontos (268 \u00d7 285 \u00d7 316), nos quais s\u00e3o calculadas as \n\ndiferentes componentes dos diferentes campos, el\u00e9trico e magn\u00e9tico, n\u00e3o seria vi\u00e1vel \n\nprocessar simula\u00e7\u00f5es com essa grandeza em computadores PCs usuais. Assim, como \u00e9 \n\nnecess\u00e1ria uma grande capacidade de mem\u00f3ria (1,6 GB em algumas simula\u00e7\u00f5es) e de \n\nprocessamento, para realizar estas simula\u00e7\u00f5es, foi utilizado um computador de processamento \n\nparalelo CRAY T94 [55], com 5,2 GFLOP CPU, 2 GB RAM e unidade de disco de 9.5 GB \n\nSCSI, possibilitando assim esses trabalhos. O algoritmo foi implementado em C++, otimizado \n\npara o processamento paralelo, pois esta \u00e9 uma das linguagens de programa\u00e7\u00e3o com \n\ncompilador dispon\u00edvel no supercomputador usado. \n\n  \n\n \n\n\n\nResultados Obtidos 35\n\n 4 RESULTADOS OBTIDOS \n\n Para efeitos de compara\u00e7\u00e3o com as normas, s\u00e3o calculados os valores de SAR \n\ncorrespondentes aos valores de campo obtidos. As recomenda\u00e7\u00f5es requerem a medi\u00e7\u00e3o de \n\nSAR ao longo de per\u00edodos de alguns minutos (e.g., 6 minutos para a norma ANSI C.95.1). \n\nPor\u00e9m uma simula\u00e7\u00e3o com intervalos de tempo como este teria que realizar um elevado \n\nn\u00famero de itera\u00e7\u00f5es (da ordem de 1014 itera\u00e7\u00f5es), dado o valor correspondente de ?t, o que \n\nrepresenta um valor invi\u00e1vel. Mesmo que se dispusesse de recursos computacionais para \n\nrealizar tal quantidade de simula\u00e7\u00f5es a propaga\u00e7\u00e3o de erros inevit\u00e1veis como os de \n\ntruncamento levaria \u00e0 diverg\u00eancia dos valores calculados.  \n\n Os resultados apresentados s\u00e3o estimativas da SAR obtidas a partir da Equa\u00e7\u00e3o 5, para \n\ndiferentes dist\u00e2ncia ou posi\u00e7\u00f5es relativas entre a antena e o usu\u00e1rio e para diferentes tempos \n\nde exposi\u00e7\u00e3o. Para estas estimativas se usa uma m\u00e9dia de valores do campo E calculada com \n\num n\u00famero suficiente de itera\u00e7\u00f5es para ser representativo (com o cuidado de descartar os \n\ntransientes). A Figura 21 abaixo mostra a evolu\u00e7\u00e3o ao longo do tempo (ou seja, das itera\u00e7\u00f5es) \n\ndo valor da SAR calculado desta forma para um ponto (ou c\u00e9lula) do interior da cabe\u00e7a.  \n\n \n\n-4,00E-02\n\n-2,00E-02\n\n0,00E+00\n\n2,00E-02\n\n4,00E-02\n\n1 51 101 151 201 251 301 351 401\n\nItera\u00e7\u00e3o\n\nFigura 21. Monitoriza\u00e7\u00e3o ao longo das itera\u00e7\u00f5es do valor de campo el\u00e9trico na entrada da antena (curva \n\nfina) e do valor de SAR calculado (curva espessa). \n\n \n\n\n\nResultados Obtidos 36\n\n  \n\n No exemplo da Figura 21, o valor de SAR converge de forma oscilat\u00f3ria. Esse \n\ncomportamento oscilat\u00f3rio da SAR est\u00e1 de acordo com o modelo implementado. N\u00e3o se deve \n\na oscila\u00e7\u00f5es introduzidas pelo m\u00e9todo num\u00e9rico, mas \u00e9 esperado teoricamente. A curva (SAR \n\n\u00d7 tempo) pode ser aproximada, ent\u00e3o, por uma exponencial (com coeficientes complexos). \n\nEste tipo de aproxima\u00e7\u00e3o pode ser usado para estimar valores rapidamente sem ter que \n\nprocessar todas as itera\u00e7\u00f5es necess\u00e1rias para a converg\u00eancia. A implementa\u00e7\u00e3o deste tipo de \n\naproxima\u00e7\u00f5es pode ser muito \u00fatil em aplica\u00e7\u00f5es que exijam um elevado n\u00famero de itera\u00e7\u00f5es \n\nem compara\u00e7\u00e3o com os recursos computacionais dispon\u00edveis.  Durante as simula\u00e7\u00f5es s\u00e3o \n\nmonitorados alguns pontos ao longo de todas as itera\u00e7\u00f5es, mas o conjunto dos valores de SAR \n\ncalculado ser\u00e1 mostrado em forma gr\u00e1fica apenas para instantes determinados para \n\neconomizar o de tempo de comunica\u00e7\u00e3o e o uso da capacidade de armazenamento. Na   \n\nFigura 22, est\u00e1 representada a SAR (em mW/g) simulada na cabe\u00e7a do usu\u00e1rio, normalizada \n\npara um campo el\u00e9trico de 1 V/m RMS na antena, na qual o plano horizontal representa um \n\ncorte sagital da cabe\u00e7a e no eixo vertical est\u00e3o os valores da SAR. \n\n \n\n \n Figura 22. SAR num corte sagital da cabe\u00e7a do usu\u00e1rio em mW/g para 1 V/m RMS de excita\u00e7\u00e3o. \n\n \n\n \n\n\n\nResultados Obtidos 37\n\n Os valores obtidos nas simula\u00e7\u00f5es dependem de muitas vari\u00e1veis do modelo, mas \n\nprincipalmente do posicionamento da antena em rela\u00e7\u00e3o ao usu\u00e1rio, e ultrapassam em muitos \n\ncasos os valores sugeridos nas normas (e.g., SAR = 1,6 mW/g na norma ANSI [8] ou        \n\nSAR = 2,0 mW/g na norma ICNIRP [9]). A defini\u00e7\u00e3o da posi\u00e7\u00e3o relativa da antena em rela\u00e7\u00e3o \n\n\u00e0 cabe\u00e7a do usu\u00e1rio para efeitos de comprova\u00e7\u00e3o do atendimento \u00e0 norma ICNIRP, tanto em \n\nsimula\u00e7\u00f5es como em medidas, tem sido discutida recentemente [48]. \n\n O algoritmo FDTD fornece em cada itera\u00e7\u00e3o, solu\u00e7\u00f5es aproximadas do valor de campo e \n\nSAR, no instante correspondente a essa itera\u00e7\u00e3o. Assim \u00e9 poss\u00edvel visualizar atrav\u00e9s dele a \n\nevolu\u00e7\u00e3o espacial das ondas se propagando e o aumento da SAR desde a condi\u00e7\u00e3o inicial de \n\ncampo nulo at\u00e9 a converg\u00eancia como na Figura 23. \n \n\n \n Figura 23. Imagem obtida da SAR da cabe\u00e7a do usu\u00e1rio para um corte sagital, depois de 1 ns, 2 ns e   \n\n3 ns de exposi\u00e7\u00e3o. \n\n \n\n A escala de cor das figuras acima representa mW/g de SAR por V/m RMS de campo da \n\nfonte (i.\u00e9., num ensaio onde a fonte foi modelada como de 1 V/m RMS) em escala logar\u00edtmica \n\n(10 \u00d7 log (SAR)). As tr\u00eas figuras correspondem a 300, 600 e 900 itera\u00e7\u00f5es ou \n\naproximadamente tempos de 1 ns, 2 ns e 3 ns. \n\n Os valores obtidos na converg\u00eancia num\u00e9rica do m\u00e9todo podem ser comparados \n\ndependendo da dist\u00e2ncia e posi\u00e7\u00e3o onde a antena \u00e9 colocada, e observados para diferentes \n\ncortes (Figura 24), comprovando a profundidade de penetra\u00e7\u00e3o dos valores mais elevados da \n\nSAR (Figura 25). \n \n\n \n\n\n\nResultados Obtidos 38\n\n \n \n\n Figura 24. Imagens obtidas da SAR da cabe\u00e7a do usu\u00e1rio para dois cortes, mais distante da antena \n\n(acima) e mais pr\u00f3ximo (abaixo). Quando a antena \u00e9 colocada a 2 cm (esquerda) e 1 cm (direita). \n\n \n\n Todas as Figuras 23 a 25, correspondem a resultados obtidas ap\u00f3s 900 itera\u00e7\u00f5es, \n\nequivalentes a um tempo de exposi\u00e7\u00e3o de 3,12 ns, salvo o especificado para a Figura 23. \n\nPode-se observar que a SAR \u00e9 muito intensa nas \u00e1reas do c\u00e9rebro pr\u00f3ximas ao plano da \n\nantena e podem-se notar m\u00e1ximos locais em tecidos sens\u00edveis, por exemplo, nos olhos     \n\n(Figura 25).  \n \n\n \n\n\n\nResultados Obtidos 39\n\n \n \n\n Figura 25. Os cortes transversais, neste caso na altura dos olhos (acima) e no plano da antena (abaixo) \n\npermitem observar elevados valores no interior da cabe\u00e7a, para a antena a 2 cm e 1 cm, (esquerda e \n\ndireita respectivamente). \n\n \n\n Na Figura 26 a pot\u00eancia entregue \u00e0 antena \u00e9 Pdel = 600 mW, para reproduzir o caso de um \n\ntelefone celular operando no modo anal\u00f3gico em sua m\u00e1xima pot\u00eancia. A escala de cor \n\ncorresponde \u00e0 SAR normalizada [10 \u00d7 log(SAR)] em que 0 dB corresponde a uma                \n\nSAR = 1 mW/g, ent\u00e3o, o valor superior da cor mais escura (10 dB acima) corresponde a        \n\n10 mW/g. \n \n\n \n\n\n\nResultados Obtidos 40\n\n \n \n\n Figura 26. Imagem transversal que apresenta os resultados normalizados [10 \u00d7 log(SAR)], para uma \n\nantena a 2 cm de dist\u00e2ncia e sendo a pot\u00eancia entregue \u00e0 antena Pdel = 600 mW. \n\n4.1 COMPARA\u00c7\u00d5ES COM OUTRAS SIMULA\u00c7\u00d5ES \n\n Considerando os estudos realizados por outros autores que utilizam diferentes m\u00e9todos \n\nnum\u00e9ricos computacionais ou at\u00e9 mesmo medidas em phantoms, \u00e9 poss\u00edvel verificar uma \n\nsimilaridade muito grande nas conclus\u00f5es dos diferentes estudos [40-43, 49-51]. A presen\u00e7a \n\nde \u00e1reas de concentra\u00e7\u00e3o de campo e o c\u00e1lculo de valores elevados, acima das recomenda\u00e7\u00f5es \n\ninternacionais s\u00e3o referidos na maioria dos trabalhos que abordam estas simula\u00e7\u00f5es. Uma \n\ncompara\u00e7\u00e3o mais direta com os resultados dos diferentes trabalhos requer, por\u00e9m reproduzir \n\nexatamente os diferentes par\u00e2metros da simula\u00e7\u00e3o, como a dist\u00e2ncia, posi\u00e7\u00e3o, caracter\u00edsticas \n\nda antena entre outros. Dadas as variadas possibilidades de modelagem, e de apresenta\u00e7\u00e3o dos \n\nresultados, os diversos autores encontram pequenas diferen\u00e7as nos seus resultados, mas numa \n\nan\u00e1lise geral, pode-se concluir que as \u00e1reas mais afetadas pelo efeito do campo \n\neletromagn\u00e9tico, obtidas neste trabalho, s\u00e3o equivalentes e com valores muito aproximados \n\naos obtidos por outros autores. A Figura 27 mostra compara\u00e7\u00f5es dos valores obtidos em \n\n \n\n\n\nResultados Obtidos 41\n\ndiferentes simula\u00e7\u00f5es publicadas com os valores aqui obtidos. Os limites recomendados de \n\n1,6 mW/g e 2 mW/g, respectivamente pelas normas IEEE/ANSI e ICNIRP, s\u00e3o ultrapassados \n\nem todas as proje\u00e7\u00f5es para dist\u00e2ncias menores que aproximadamente 2 cm. \n \n\n \n\n(1) \n\n(3) (2) \n\n(4) \n\n \n Figura 27. Gr\u00e1fico da SAR simulada na cabe\u00e7a do usu\u00e1rio. A curva (1) inteira (verde) obtida neste \n\ntrabalho (para 31.6 Vpp/m) \u00e9 comparada com as curvas de v\u00e1rios autores: (2) ponto-e-tra\u00e7o (vermelha) \n\n[40], (3) pontilhada (preta) [49] e (4) tracejada (azul) [42] todas com Pdel = 1 W. \n\n  \n\n4.2 COMPARA\u00c7\u00d5ES COM MEDIDAS \n\n As medidas de SAR requerem a montagem de um sofisticado laborat\u00f3rio com phantoms \n\nou modelos espec\u00edficos que simulam o corpo humano, compostos de materiais (gel ou \n\npl\u00e1sticos) com par\u00e2metros eletromagn\u00e9ticos equivalentes \u00e0 m\u00e9dia dos tecidos. Al\u00e9m dos \n\nphantoms s\u00e3o necess\u00e1rios transdutores, em geral em microlinhas, e bra\u00e7os posicionadores \n\n(automatizados) que interfiram o menos poss\u00edvel com os campos que est\u00e3o sendo medidos. \n\nUm programa espec\u00edfico deve controlar os movimentos do conjunto para realizar medidas em \n\n \n\n\n\nResultados Obtidos 42\n\ndiferentes pontos e, dependendo dos transdutores usados, considerar a soma de componentes \n\nortogonais para simular um transdutor isotr\u00f3pico. Al\u00e9m desses equipamentos espec\u00edficos, \n\nsofisticados equipamentos gerais como gerador e amplificador de RF, analisador de redes e \n\nparedes anecoicas s\u00e3o necess\u00e1rios para a montagem de um laborat\u00f3rio de medidas de SAR.  \n\n Assim como no caso das simula\u00e7\u00f5es, as medidas podem ter valores diferentes em fun\u00e7\u00e3o \n\nda indefini\u00e7\u00e3o da dist\u00e2ncia e posi\u00e7\u00e3o da antena entre outros par\u00e2metros mais relevantes. \n\n \n\n(5) (1) \n\n(4) \n(2) \n\n(3) \n\n Figura 28. Valores obtidos nas atuais simula\u00e7\u00f5es: no olho, com antena frontal (linha (1) inteira, azul) e \n\nhotspot interior ao cr\u00e2nio com antena lateral (linha (2) inteira, verde, pontos circulares), comparados com \n\nresultados medidos para antena lateral em modelo homog\u00eaneo (linha (3) tracejada, preta) e phantom n\u00e3o \n\nhomog\u00eaneo (ponto-e-linha (4), vermelha) [50]. Pdel = 0.45 W. A curva (5) cor de rosa, inteira mostra \n\nresultados de medidas em phantoms e simula\u00e7\u00f5es apresentada em [51]  \n\n \n\n E poss\u00edvel verificar a concord\u00e2ncia entre as simula\u00e7\u00f5es realizadas e medidas publicadas. \n\nO importante aumento da SAR, com a diminui\u00e7\u00e3o da dist\u00e2ncia entre a antena e a cabe\u00e7a, \u00e9 \n\nobservado em todos os casos.  \n\n \n\n\n\nResultados Obtidos 43\n\n 5 PROJETO DE ANTENAS DIRETIVAS \n\n Os resultados das simula\u00e7\u00f5es anteriores e a revis\u00e3o da literatura indicam que devam ser \n\nestudadas alternativas visando minimizar a energia absorvida na cabe\u00e7a. Por outro lado, como \n\no diagrama de irradia\u00e7\u00e3o no plano horizontal, para as antenas mais usadas em telefones \n\ncelulares (tipo monopolo) \u00e9 aproximadamente sim\u00e9trico quando est\u00e3o afastadas de qualquer \n\nobst\u00e1culo, quando operam pr\u00f3ximas \u00e0 cabe\u00e7a t\u00eam seu diagrama de irradia\u00e7\u00e3o distorcido, \n\nsendo mais densidade de pot\u00eancia emitida na dire\u00e7\u00e3o do usu\u00e1rio. Assim o uso de antenas \n\ndiretivas representaria uma diminui\u00e7\u00e3o dos n\u00edveis de radia\u00e7\u00e3o sobre o usu\u00e1rio, sem que com \n\nisto se prejudiquem os n\u00edveis emitidos na dire\u00e7\u00e3o oposta \u00e0 cabe\u00e7a, que \u00e9 a dire\u00e7\u00e3o preferencial \n\npara a comunica\u00e7\u00e3o. \n\n Antenas planares (e.g., em \u201cMicrostrip\u201d, CPW - \u201cCoplanar Waveguide\u201d, \u201cSlot-line\u201d, etc.) \n\nt\u00eam sido descritas na literatura cient\u00edfica [47, 56-64], podendo representar substanciais \n\nmelhorias no desempenho dos telefones m\u00f3veis, tanto em termos de diagrama de irradia\u00e7\u00e3o \n\n(por exemplo, uma curva do tipo cardi\u00f3ide [68]), rela\u00e7\u00e3o frente-costas (por exemplo, da \n\nordem de 15 dB), imped\u00e2ncia de entrada, largura de banda, etc., resultando em melhoria da \n\nqualidade de comunica\u00e7\u00e3o, redu\u00e7\u00e3o de consumo da bateria e dos riscos aos usu\u00e1rios. \n\n Alguns autores desenvolveram antenas impressas para aplica\u00e7\u00f5es em telefones m\u00f3veis, \n\ndemonstrando algumas melhorias de desempenho (por exemplo, em termos de efici\u00eancia de \n\nirradia\u00e7\u00e3o, etc.) em rela\u00e7\u00e3o \u00e0 antena monopolo convencional [56-67]. Estas antenas podem ser \n\ncompactas, e com caracter\u00edsticas de produ\u00e7\u00e3o rent\u00e1veis provenientes de mat\u00e9rias primas \n\nbaratas e de f\u00e1cil fabrica\u00e7\u00e3o, al\u00e9m de serem robustas, pois sua estrutura n\u00e3o possui partes \n\nm\u00f3veis ou salientes o que as torna ideais para transceptores port\u00e1teis.  Al\u00e9m disto, devido a \n\nsua reduzida espessura, elas podem ser acomodadas em superf\u00edcies curvas ou planas como na \n\ncapa de cobertura m\u00f3vel do aparelho. Suas caracter\u00edsticas de irradia\u00e7\u00e3o podem ser adaptadas \n\npara a aplica\u00e7\u00e3o desejada, como, por exemplo, seu diagrama de irradia\u00e7\u00e3o, rela\u00e7\u00e3o frente \n\ncostas, largura de banda, imped\u00e2ncia de entrada, etc. Por exemplo, a PIFA (\u201cPlanar Inverted \n\nF Antenna\u201d) e a BIFA (\u201cBent Inverted F Antennas\u201d) mostraram estas melhorias [40, 61, 62]. \n\nTamb\u00e9m a antena espiral descrita em [66] mostrou resultados interessantes.  \n\n \n\n\n\nResultados Obtidos 44\n\n Com o objetivo de testar uma aplica\u00e7\u00e3o diferente do algoritmo FDTD desenvolvido e ao \n\nmesmo tempo verificar conceitualmente a possibilidade de aplica\u00e7\u00e3o de antenas diretivas em \n\ntransmissores port\u00e1teis, foi iniciado o estudo de antenas em microlinhas A seguir se \n\ndescrever\u00e1 sumariamente o projeto, realiza\u00e7\u00e3o e os resultados preliminares medidos para o \n\nprot\u00f3tipo experimental de uma antena tipo monopolo de um quarto de onda em microstrip. \n\n5.1 PROJETO DE ANTENAS USANDO FDTD \n\n Antenas planares mais sofisticadas e de desempenho aprimorado j\u00e1 foram apresentadas na \n\nliteratura [62, 66]. N\u00e3o se pretende aqui mostrar o desenvolvimento de uma antena de alto \n\ndesempenho, mas realizar um teste de conceito (a utilidade de antenas diretivas em \n\nmicrolinhas como alternativa para minimizar a pot\u00eancia absorvida na cabe\u00e7a do usu\u00e1rio de \n\ntransceptores port\u00e1teis) junto com uma aplica\u00e7\u00e3o do algoritmo FDTD para projeto. \n\n A antena apresentada \u00e9 constitu\u00edda de duas se\u00e7\u00f5es. A primeira delas \u00e9 uma linha de quarto \n\nde onda em aberto em sua extremidade e, portanto, apresenta semelhan\u00e7as com uma antena \n\nmonopolo, e a segunda opera como um transformador de quarto de onda, necess\u00e1rio para o \n\ncasamento de imped\u00e2ncia com o transmissor. \n\n  Foram utilizadas equa\u00e7\u00f5es bem estabelecidas [47, 56-60, 67, 68] para o dimensionamento \n\ndessas duas se\u00e7\u00f5es. O transformador de quarto de onda \u00e9 dimensionado para adaptar a baixa \n\nimped\u00e2ncia na entrada do monopolo de quarto de onda \u00e0 imped\u00e2ncia vista dos terminais do \n\ntransceptor port\u00e1til. Esta antena foi tamb\u00e9m modelada utilizando-se o m\u00e9todo FDTD [67], que \n\npermite estimativa precisa dos campos na regi\u00e3o pr\u00f3xima e distante, constituindo-se em \n\nimportante ferramenta para o projeto e otimiza\u00e7\u00e3o dessas antenas. \n\n A freq\u00fc\u00eancia central escolhida foi 840 MHz. O substrato dispon\u00edvel, \u201cPerstorp\u201d            \n\ntipo FR-4 V0 com constante diel\u00e9trica relativa 4,6, espessura 1,58 mm e 0,035 mm de \n\nmetaliza\u00e7\u00e3o, n\u00e3o \u00e9 adequado para o uso em antenas, esperando-se de antem\u00e3o que as antenas \n\ntenham baixa efici\u00eancia. A imped\u00e2ncia de entrada do monopolo de quarto de onda foi \n\nestimada em 22,5 ?, a imped\u00e2ncia caracter\u00edstica calculada do transformador de quarto de \n\nonda \u00e9 35,7 ?, apresentando ent\u00e3o em sua entrada uma imped\u00e2ncia de 50 ?. Foi utilizado um \n\nconector SMA para substituir o conector original, ent\u00e3o mantendo menores poss\u00edveis as \n\ndimens\u00f5es. \n\n Nesta simula\u00e7\u00e3o se analisa o comportamento da antena microstrip descrita acima, para a \n\nregi\u00e3o pr\u00f3xima, atrav\u00e9s de um modelo simplificado e um algoritmo FDTD. A antena foi \n\n \n\n\n\nResultados Obtidos 45\n\nimplementada dentro de um dom\u00ednio contendo ar, para que o sinal se propagasse no espa\u00e7o \n\nlivre, ou seja, nessas simula\u00e7\u00f5es n\u00e3o foi inclu\u00edda a cabe\u00e7a como nas simula\u00e7\u00f5es anteriormente \n\napresentadas. \n\n Para tanto, foram inicialmente determinadas dimens\u00f5es apropriadas para a malha (matriz), \n\nescolhidas de forma que o modelo fosse o mais fiel poss\u00edvel. Assim teremos um dom\u00ednio \n\nc\u00fabico com c\u00e9lulas com dimens\u00f5es espaciais: ?x = ?y = ?z = 0,7 mm e as dimens\u00f5es da \n\nantena s\u00e3o compostas de m\u00faltiplos inteiros desses elementos. Nesta malha, determina-se \n\natrav\u00e9s de \u00edndices, o material para cada posi\u00e7\u00e3o (c\u00e9lula). Com isso, a antena \u00e9 \u201cdesenhada\u201d \n\nnos diversos \u201ccortes\u201d da matriz (Figura 29). \n \n\n                     \n                                             (a)                               (b) \n\n Figura 29. Representa\u00e7\u00e3o de uma matriz contendo a antena microstrip, onde: (a) vista superior (b) \n\nvista em corte transversal. \n\n \n\n Na Figura 29b est\u00e1 representado um corte transversal \u00e0 antena, no qual est\u00e1 indicada a \n\nexcita\u00e7\u00e3o, aplicada apenas nas c\u00e9lulas correspondentes \u00e0 regi\u00e3o restrita do diel\u00e9trico, no plano \n\nonde inicia a microstrip. Na sua menor dimens\u00e3o, considera-se o metal como condutor \n\nperfeito, ou seja, com condutividade infinita e, nas c\u00e9lulas em que h\u00e1 metal, as equa\u00e7\u00f5es de \n\ndiferen\u00e7as finitas que o m\u00e9todo propaga s\u00e3o corrigidas de forma a eliminar as parcelas de \n\ncampo dentro do metal, podendo desta forma evitar a mudan\u00e7a de malha para representar \n\nespessuras de metal muito menores que as que poderiam ser descritas dadas as dimens\u00f5es das \n\nc\u00e9lulas. Os principais par\u00e2metros do diel\u00e9trico utilizado est\u00e3o apresentados na Tabela 2. \n\n Tabela 2. Par\u00e2metros dos materiais usados na simula\u00e7\u00e3o. \n\nMaterial ?r ? [S/m] \nAr 1 0 \nMetal /Plano Terra - ? \nDiel\u00e9trico (FR-4) 4,6 2,1742x10-3 \n\n \n\n \n\n\n\nResultados Obtidos 46\n\n Com a determina\u00e7\u00e3o do dom\u00ednio do problema, todos os campos eletromagn\u00e9ticos \n\ninicialmente s\u00e3o nulos. S\u00e3o inseridos, ent\u00e3o, nos pontos referentes \u00e0 excita\u00e7\u00e3o, campos que se \n\npropagar\u00e3o por todo o dom\u00ednio (antena/ar) ao longo das itera\u00e7\u00f5es. Ap\u00f3s a converg\u00eancia \n\nnum\u00e9rica do m\u00e9todo, s\u00e3o disponibilizadas matrizes dos campos eletromagn\u00e9ticos que ser\u00e3o \n\ntransformadas em imagens para aprecia\u00e7\u00e3o. A propaga\u00e7\u00e3o dos campos pode-se perceber \n\natrav\u00e9s de cortes transversais (Figuras 30 e 31), longitudinais (Figura 32) ou vista de topo \n\n(Figura 33). \n \n\n      \n\n                              (A)                                                               (B) \n\n Figura 30. Imagens da propaga\u00e7\u00e3o de campos eletromagn\u00e9ticos para a antena microstrip, nas quais: \n\n(a) ocorre ap\u00f3s 0,34 ns de propaga\u00e7\u00e3o e (b) ocorre ap\u00f3s 0,375 ns de propaga\u00e7\u00e3o. \n\n  \n\n \n\n                        (A)                                            (B)                                           (C) \n\n Figura 31. Imagens de cortes transversais da antena microstrip, nas quais: (a) ocorre ap\u00f3s 0,69 ns, (b) \n\nocorre ap\u00f3s 0,75 ns e (c) ocorre ap\u00f3s 0,84 ns. \n \n\n \n\n\n\nResultados Obtidos 47\n\n    \n \n\n Figura 32. Campo el\u00e9trico propagado a partir da antena microstrip, para uma vista longitudinal ap\u00f3s \n\n0,86 ns. \n\n \n\n   \n \n\n Figura 33. Propaga\u00e7\u00e3o de campos eletromagn\u00e9ticos a partir da antena microstrip, para uma vista de \n\ntopo ap\u00f3s 0,46 ns. \n\n  \n\n5.2 MEDIDAS DE PROT\u00d3TIPOS \n\n A avalia\u00e7\u00e3o das caracter\u00edsticas da antena, tanto em campo pr\u00f3ximo como em campo \n\ndistante, \u00e9 tarefa dif\u00edcil de ser realizada j\u00e1 que as condi\u00e7\u00f5es ideais para a medida normalmente \n\nn\u00e3o existem e controlar o ambiente de modo a simular o espa\u00e7o livre pode n\u00e3o ser poss\u00edvel, \n\ndesde que n\u00e3o se disp\u00f5e de uma c\u00e2mera anec\u00f3ica.  \n\n \n\n\n\nResultados Obtidos 48\n\n Por conveni\u00eancia utilizou-se uma antena monopolo no modo recep\u00e7\u00e3o acoplada a um \n\nanalisador de espectro port\u00e1til Anritsu MS 2711 (princ\u00edpio da reciprocidade) e a fonte \n\ntransmissora (transceptor de trunking com freq\u00fc\u00eancias e pot\u00eancias program\u00e1veis) fixa em \n\nlocal distante o suficiente para ser considerada no campo distante [47]. \n\n Um crit\u00e9rio adequado para definir essa dist\u00e2ncia \u00e9 considerar que a antena sob teste seja \n\niluminada por uma frente de onda praticamente plana e com diferen\u00e7as de fase entre seu \n\ncentro e sua borda maior n\u00e3o superior a ?/16 [70]. Tipicamente a dist\u00e2ncia R a partir do qual o \n\ncampo pode ser considerado distante \u00e9 dada pela inequa\u00e7\u00e3o: \n \n\n?\n\n22 d\nR ?  (29) \n\n \n\nem que d \u00e9 a maior dimens\u00e3o da antena. Para a freq\u00fc\u00eancia de medida (cerca de 850 MHz) e \n\npara a antena em teste, esta dist\u00e2ncia \u00e9 de 0,7 m. \n\n Para aproximar o teste da condi\u00e7\u00e3o de espa\u00e7o livre foi utilizada a disposi\u00e7\u00e3o de medi\u00e7\u00e3o \n\ninclinada (slant range) [47, 67] de modo que a antena teste \u00e9 colocada a uma altura maior que \n\na antena transmissora. \n\n Tal disposi\u00e7\u00e3o tende a suprimir a onda refletida de terra e evita que outras reflex\u00f5es \n\ndegradem os valores de rela\u00e7\u00e3o frente-costa existentes j\u00e1 que a onda que se dirige \u00e0 antena \n\ntamb\u00e9m se dirige ao infinito. \n\n Ajustes foram realizados em bancada (especialmente com elementos reativos e alargando \n\na fita da se\u00e7\u00e3o do transformador de quarto de onda, que passou para uma imped\u00e2ncia \n\ncaracter\u00edstica de cerca de 30 ?), visando a otimiza\u00e7\u00e3o dos principais par\u00e2metros da antena. \n\nEntre outros, a taxa de onda estacion\u00e1ria da antena foi substancialmente reduzida ao longo da \n\nfaixa desejada.  \n\n Os principais resultados preliminares obtidos ser\u00e3o mostrados a seguir. O diagrama de \n\nirradia\u00e7\u00e3o no plano horizontal est\u00e1 representado na Figura 34. \n \n\n \n\n\n\nResultados Obtidos 49\n\n-30\n\n-25\n\n-20\n\n-15\n\n-10\n\n-5\n\n0\n0\n\n10 20\n30\n\n40\n50\n\n60\n\n70\n\n80\n\n90\n\n100\n\n110\n\n120\n130\n\n140\n150\n\n160170\n180\n\n190200\n210\n\n220\n230\n\n240\n\n250\n\n260\n\n270\n\n280\n\n290\n\n300\n310\n\n320\n330\n\n340 350\n\n  \n \n\n Figura 34. Diagrama de irradia\u00e7\u00e3o da antena microstrip no plano horizontal. A parte frontal da \n\nantena corresponde ao angulo 0\u00ba e os valores de pot\u00eancia, em dB, s\u00e3o em rela\u00e7\u00e3o \u00e0 pot\u00eancia equivalente \n\nirradiada por um monopolo de ?/2. \n\n \n\n Observa-se neste diagrama uma rela\u00e7\u00e3o frente-costa da ordem de 13 dB. \n\n Na Figura 35 est\u00e1 mostrado o diagrama de irradia\u00e7\u00e3o no plano vertical medido para a \n\nparte frontal da antena (o plano da antena corresponde a 0\u00ba ).  \n \n\n \n\n\n\nResultados Obtidos 50\n\n-30\n\n-25\n\n-20\n\n-15\n\n-10\n\n-5\n\n0\n0\n\n10 20\n30\n\n40\n50\n\n60\n\n70\n\n80\n\n90\n\n100\n\n110\n\n120\n\n130\n140\n\n150\n160170\n\n180\n190200\n\n210\n220\n\n230\n\n240\n\n250\n\n260\n\n270\n\n280\n\n290\n\n300\n\n310\n320\n\n330\n340 350\n\n \n \n\n Figura 35. Diagrama de irradia\u00e7\u00e3o da antena microstrip no plano vertical. Onde 0 dB corresponde a o \n\nganho de um monopolo de ?/2 na dire\u00e7\u00e3o de m\u00e1ximo ganho. \n\n \nNa Figura 36 est\u00e1 mostrada a taxa de onda estacion\u00e1ria medida na entrada desta \n\nantena. \n\n2\n\n2,5\n\n3\n\n3,5\n\n838 840 843 845 848 850 853 855 858 860 863 865\n\n \n Figura 36. Rela\u00e7\u00e3o de onda estacion\u00e1ria medida na faixa de 837,5 a 865 MHz. \n\n \n\n \n\n\n\nResultados Obtidos 51\n\nObserva-se dessa figura que a raz\u00e3o de onda estacion\u00e1ria medida para a antena \n\nmicrostrip na faixa de 840 a 860 MHz mant\u00e9m-se menor que tr\u00eas, o que \u00e9 um resultado \n\nadequado para aplica\u00e7\u00f5es pr\u00e1ticas. \n\n De uma maneira geral, observa-se dos resultados preliminares medidos, que o diagrama \n\nde irradia\u00e7\u00e3o apresenta \u00e2ngulos de abertura entre os pontos de meia pot\u00eancia da ordem de \n\n180\u00b0 no plano horizontal e de cerca de 90\u00b0 no plano vertical, rela\u00e7\u00e3o frente-costas da ordem \n\nde 13 dB, raz\u00e3o de onda estacion\u00e1ria na entrada menor que 3, para a faixa de freq\u00fc\u00eancias entre \n\n840 e 860 MHz.  \n\n Esses resultados preliminares certamente poder\u00e3o ser melhorados. Tamb\u00e9m, com a \n\nutiliza\u00e7\u00e3o de substratos com constantes diel\u00e9tricas mais elevadas, obt\u00e9m-se uma redu\u00e7\u00e3o \n\nsubstancial nas dimens\u00f5es destas antenas permitindo uma melhor integra\u00e7\u00e3o nos aparelhos \n\nport\u00e1teis. \n \n\n  \n\n  \n\n \n\n\n\nConclus\u00f5es e Recomenda\u00e7\u00f5es 52\n\n 6 CONCLUS\u00d5ES E RECOMENDA\u00c7\u00d5ES \n\n Foram descritos sumariamente os efeitos da exposi\u00e7\u00e3o \u00e0 radiofreq\u00fc\u00eancia e microondas, \n\nem particular diferenciando os mesmos dos efeitos provocados por radia\u00e7\u00f5es ionizantes, que \n\ns\u00e3o conhecidos h\u00e1 mais tempo, e tamb\u00e9m da radia\u00e7\u00e3o solar, que \u00e9 absorvida mais \n\nsuperficialmente. Entre estes efeitos, os mais conhecidos, que s\u00e3o os efeitos t\u00e9rmicos, d\u00e3o \n\norigem a recomenda\u00e7\u00f5es e normas de exposi\u00e7\u00e3o. Algumas dessas normas tem um amplo \n\nreconhecimento internacional e indicam os limites de exposi\u00e7\u00e3o em par\u00e2metros de campos \n\nel\u00e9tricos e magn\u00e9ticos, e em SAR. Para verificar o atendimento a estas normas, basta ent\u00e3o \n\nmedir ou calcular os valores de campo ou da SAR.  \n\n Para o caso das esta\u00e7\u00f5es de radiobase, os c\u00e1lculos e medidas n\u00e3o apresentam maior \n\ndificuldade e mostram que os limites recomendados (mesmo os mais restritivos) s\u00e3o atendidos \n\npara as dist\u00e2ncias onde pode haver p\u00fablico. J\u00e1 para o caso dos transceptores port\u00e1teis, tanto o \n\nc\u00e1lculo como as medidas requerem ferramentas especiais. Para desenvolver estes c\u00e1lculos e \n\nassim poder estimar os n\u00edveis de campo e SAR sobre o usu\u00e1rio de transceptores port\u00e1teis, \n\nforam desenvolvidos um modelo de cabe\u00e7a humana (malha do m\u00e9todo num\u00e9rico) e um \n\nsoftware baseado no m\u00e9todo das Diferen\u00e7as Finitas no Dom\u00ednio do Tempo, FDTD. \n\n A converg\u00eancia do algoritmo desenvolvido foi testada, comparando diferentes solu\u00e7\u00f5es \n\npara as condi\u00e7\u00f5es iniciais e condi\u00e7\u00f5es de contorno do problema, e os resultados calculados \n\nforam validados. Estes resultados s\u00e3o convergentes com aqueles publicados por v\u00e1rios autores \n\ne indicam que a SAR cresce substancialmente quando a dist\u00e2ncia entre a antena e a cabe\u00e7a \n\ndecresce, ultrapassando 2 W/Kg para dist\u00e2ncias menores que 2 cm, por exemplo. Uma vez que \n\numa percentagem substancial de usu\u00e1rios, talvez a maioria, opera os celulares com a antena \n\nmonopolo a uma dist\u00e2ncia menor que 2 cm da cabe\u00e7a e muitas vezes por longos per\u00edodos, as \n\nnormas ICNIRP (e IEEE/ANSI) s\u00e3o ent\u00e3o substancialmente excedidas e as recomenda\u00e7\u00f5es de \n\nlimitar o tempo de uso e cuidar para manter uma dist\u00e2ncia maior que 2 cm (ou tanto quanto \n\nfor poss\u00edvel) entre o transceptor e a cabe\u00e7a s\u00e3o pertinentes. \n\n Como os atuais limites de exposi\u00e7\u00e3o s\u00e3o essencialmente baseados nos efeitos t\u00e9rmicos \n\n(p.ex., ICNIRP e IEEE/ANSI), eles podem ser objeto de revis\u00e3o, que os tornaria mais \n\n \n\n\n\nConclus\u00f5es e Recomenda\u00e7\u00f5es 53\n\nrestritivos, dependendo dos resultados das pesquisas em andamento (por exemplo, \n\ncoordenadas pela Organiza\u00e7\u00e3o Mundial da Sa\u00fade - OMS), especialmente em efeitos n\u00e3o-\n\nt\u00e9rmicos. Por outro lado, \u00e9 de se esperar press\u00f5es por parte da industria para n\u00e3o diminuir os \n\nn\u00edveis de pot\u00eancia emitidos, o que poderia prejudicar a comunica\u00e7\u00e3o e o desenvolvimento de \n\nsistemas que permitam o intercambio de maiores quantidades de informa\u00e7\u00e3o (imagem, v\u00eddeo, \n\ndados). Isto porque, para aumentar a quantidade de informa\u00e7\u00e3o enviada as alternativas s\u00e3o o \n\naumento de banda de freq\u00fc\u00eancias, a sofistica\u00e7\u00e3o das modula\u00e7\u00f5es e codifica\u00e7\u00f5es usadas      \n\n(e.g. CDMA, spread spectrum) e o aumento de pot\u00eancia. \n\n Uma alternativa conceitual para permitir o desenvolvimento de telefones celulares que \n\nirradiem o usu\u00e1rio com n\u00edveis baixos, sem diminuir a pot\u00eancia transmitida nem prejudicar a \n\ncomunica\u00e7\u00e3o, baseada em antenas planares, foi proposta e sua viabilidade mostrada com \n\nc\u00e1lculos e medidas em prot\u00f3tipos. \n\n Entre as perspectivas de desenvolvimentos futuros deste trabalho se incluem o \n\naperfei\u00e7oamento e complementa\u00e7\u00e3o do sofware desenvolvido, com (a) a constru\u00e7\u00e3o de \n\ninterfaces amig\u00e1veis para a entrada de dados e gera\u00e7\u00e3o de malha a antena, (b) a adapta\u00e7\u00e3o dos \n\nalgoritmos e da malha para outras geometrias, implementando equa\u00e7\u00f5es para outros sistemas \n\nde coordenadas, transforma\u00e7\u00f5es (rota\u00e7\u00f5es escalas) e malhas heterog\u00eaneas (com c\u00e9lulas de \n\ndiferentes tamanhos), (c) o desenvolvimento e teste de bordas absorvedoras mais eficientes, \n\n(d) implementa\u00e7\u00e3o de c\u00e1lculos para campo distante e sua valida\u00e7\u00e3o. \n\n Tamb\u00e9m a aplica\u00e7\u00e3o do software para diferentes problemas de espalhamento \n\neletromagn\u00e9tico, em particular na continua\u00e7\u00e3o do estudo e desenvolvimento de antenas \n\nplanares pode ser abordado. \n\n Para obter um entendimento mais profundo dos efeitos t\u00e9rmicos que definem os limites \n\ndas normas mais difundidas, \u00e9 poss\u00edvel implementar equa\u00e7\u00f5es de calor biol\u00f3gico (Equa\u00e7\u00e3o 7). \n\nPartindo dos valores de SAR calculados com este software FDTD, o modelo pode ser \n\ncriticado, e suas outras componentes implementadas e resolvidas por uma combina\u00e7\u00e3o de \n\nm\u00e9todos num\u00e9ricos. \n\n \n\n\n\nRefer\u00eancias Bibliogr\u00e1ficas 54\n\nREFER\u00caNCIAS BIBLIOGR\u00c1FICAS \n\n \n[1] D\u2019\u00c1VILA, C.K Programa de Treinamento para Profissonais da ANATEL, CEDET \n\nCentro de Desenvolvimento Profissonal e Tecnol\u00f3gico, UnB, 1998 \n \n[2] DOWD, S.E.; TILSON E.R. Practical Radiation Protection and Applied Radiobiology \n\nUniv. of Alabama, Birmingham. Brandon/Hill Allied Health List selection (#305) Apr \n1999 \n\n \n[3] IRNICH, W.; TOBISCH, R. Mobile Phones in Hospitals, Biomedical Instrumentation \n\nand Tecnology, pp 128 \u201334, Jan/Feb 1999. \n \n[4] IRNICH, W.; TOBISCH R. Mobilfunk im Krankenhaus: EinfluB von Mobiltelefonen auf \n\nLebensrettende und Lebenserhaltende Medizintechnik Schiele und Sch\u00f6n, Berlin 1999 \n \n[5] FISCHETTI, M. The Cellular Phone Scare. IEEE Spectrum, p. 43-47, Jun. 1993. \n \n[6] JENSEN, M. A.;RAHMAT-SAMII, Y. EM Interaction of Handset Antennas and a \n\nHuman in Personal Communications. Proc. of the IEEE, v. 83, n. 1, p. 7-17, Jan. 1995. \n \n[7] SALLES, A. A. A. DE. Efeitos Biol\u00f3gicos dos Telefones Celulares Port\u00e1teis. Revista da \n\nSociedade Brasileira de Telecomunica\u00e7\u00f5es, v. 11, n. 1,  p. 71-80, Dez. 1996. \n \n[8] ANSI \u2013 American  National Standards Institute. IEEE C95.1-1991: IEEE Standard for \n\nSafety Levels with Respect to Human Exposure to Radio Frequency \nElectromagnetic Fields, 3 kHz to 300 GHz. The Institute of Electrical and Electronics \nEngineers, Inc., 345 East 47 Street, New York, NY 10017-2394, USA. \n\n \n[9] ICNIRP GUIDELINES \u2013 Guidelines for Limiting Exposure to Time-Varying Electric, \n\nMagnetic and Electromagnetic Fields (Up to 300 GHz) \u2013 International Commission on \nNon-Ionizing Radiation Protection, Health Physics, v. 74, n. 4, p. 494-522, Apr. 1998. \n\n \n[10] SALLES, A. A. A. DE; FERN\u00c1NDEZ, C.  Riesgos a la Salud Provocados por los \n\nTel\u00e9fonos Celulares M\u00f3viles: una Discusi\u00f3n Reabierta. Los Efectos a Largo Plazo. \nRevista Infosuis,  n. 4,  p. 2-5, Out. 1999. \n\n \n[11] MOSELEY, H. Non-Ionizing Radiation. Medical Physics Handbooks 18, p. 38-61. \n \n[12] BERNHART, J. H. Non-Ionizing Radiation Safety: Radiofrequency Radiation, Electric \n\nand Magnetic Fields. Physics on Medicine and Biology, v. 37, n. 4, p. 807-844, 1992.  \n \n\n \n\nhttp://www.amazon.com/exec/obidos/search-handle-url/index=books&amp;field-author=Dowd%2C Steven B./104-5969778-1593550\nhttp://www.amazon.com/exec/obidos/search-handle-url/index=books&amp;field-author=Tilson%2C Elwin R./104-5969778-1593550\n\n\nRefer\u00eancias Bibliogr\u00e1ficas 55\n\n[13] BRONZINO, J. D. Biologic Effects of Non-ionizing Electromagnetic Fields. The \nBiomedical Engineering Handbook, CRC Press &amp; IEEE Press., p. 1388-1389 and p. \n1380-1440, 1995. \n\n \n[14] STUCHLY, M. A. Mobile Communication Systems and Biological Effects on their \n\nUsers. The Radio Science Bulletin, n. 275,  p.7-13, Dec. 1995. \n \n[15] DE POMERAI, D. Non-Thermal Heat-Shock Response to Microwaves. Nature, v. 405,  \n\np. 417- 418, May 2000. \n \n[16] DE POMERAI, D. Microwave Radiation Induces a Heat-Shock Response and Enhances \n\nGrowth in the Nematode Caenorhabditis Elegans, IEEE Trans. On MTT, v. 48, n. 11,  \np. 2076-2081, Nov. 2000. \n\n \n[17] SALLES, A. A. A DE. Biological Effects of Microwaves and RF. SBMO/IEEE MTT-S \n\nInternational Microwave and Optoelectronics Conference.  p. 611-617, 1999.  \n \n[18] WORLD HEALTH ORGANIZATION International EMF Project, \n\nhttp://www.who.int/emf/. \n \n[19] SWITZERLAND FEDERAL AGENCY FOR ENVIRONMENT, FORESTS AND \n\nLANDSCAPE Ordinance on Non-Ionizing Radiation Protection  n. 814.710, \nDecember 23, 1999, Art. 64.a., p. 14,   \n\n \n[20] MINISTERO DELL' AMBIENTE ITALIANO, DECRETO 10 settembre 1998, n. 381 \n\n- Regolamento recante norme per la determinazione dei tetti di  radiofrequenza \ncompatibili con la salute umana pubblicato sulla G.U. n. 257, 03 novembre 1998. \n\n \n[21] European Union to Adopt ICNIRP-Based Guidelines; Italy Protests that Decision Ignores \n\nLong Term Effects, Microwave News, 19_4, pp.1-3 Jul 1999. \n \n[22] GANDHI O, P, ET AL. Temperature Rise for the Human Head for Cellular Telephones \n\nand for Peak SARs Prescribed in Safety Guidelines IEEE Trans. on MTT, vol. 49, n. 9 \npp. 1607-1613 Sept. 2001. \n\n \n[23] CARNAHAN, B. Applied Numerical Methods. Krieger Publishing Co., 1990, ISBN 0-\n\n89464-486-6. \n \n[24] ANATEL,  Diretrizes para Limita\u00e7\u00e3o da Exposi\u00e7\u00e3o a Campos El\u00e9tricos, Magn\u00e1ticos \n\ne Eletromagn\u00e9ticos Vari\u00e1veis no Tempo, Ag\u00eancia Nacional de Telecomunica\u00e7\u00f5es, \nBrasilia, Brasil, Dez. 1999  \n\n \n[25] Lei n. 8463 de 19/01/2000, Prefeitura Municipal de P\u00f4rto.Alegre, RS. \n \n[26] FCC 96-326: FCC Updates its Guidelines for Evaluating the Environmental Effects of \n\nRadiofrequency Emissions: Action Implements Telecom Act provisions (ET Docket No. \n93-62), Repport DC96-76 http://www.fcc.gov/oet/headline/fcc96326.html \n\n \n [27] RADIO FREQUENCY INTERAGENCY WORK GROUP (RFIA-WG) RF Guidelines \n\nStatement,  Jun, 19th, 1999 \n\n \n\nhttp://www.who.int/emf/\n\n\nRefer\u00eancias Bibliogr\u00e1ficas 56\n\n \n[28] QISHAN YU, ET AL. An Automated SAR Measurement System for Compliance \n\nTesting of Personal Wireless Devices IEEE Trans. on Electromagnetic Compatibility, \n41, pp. 234-245 Aug 1999 \n\n \n[29] WORLD HEALTH ORGANIZATION Mobile Phones: Conclusions and \n\nRecommendations, Fact Sheet 193, Jun 2000, pg.5 www.who.int/inf-fs/en/fact193.html \n \n[30] H. T. FRIIS, A Note on a Simple Transmission Formula Proc. IRE., Vol. 34, May 1946. \n \n[31] Y.OKUMURA ET AL., Field Strength and Its Variability in VHF and UHF LandMobile \n\nRadio Service Review of the Electrical Communication Laboratories Vol. 16, Nos. 9 \nand 10, 1968, pp. 825-873. \n\n \n[32] M. HATA, Empirical Formula for Propagation Loss in Land Mobile Radio Services, \n\nIEEE Transactions on Vehicular Technology, Vol. VT 29, No 3, 1980, pp. 317-325. \n \n[33] LEE, WILLIAM C. Y., Mobile Cellular Telecommunications Systems, McGraw Hill, \n\n1989, ISBN 0070380899 pp 97-143. \n \n[34] AHLIN, L.; ZANDER, J. Principles of Wireless Communications, Studentlitteratur \n\n1998, ISBN 91-44-00762-0 \n \n[35] BLAUNSTEIN, N. Radio Propagation in Cellular Networks, Artech House, 1999, \n\nISBN: 1580530672 \n \n[36] C\u00c1TEDRA, M.; P\u00c9REZ, J. Cell Planning for Wireless Communications Artech  \n\nHouse1999, ISBN 0-89006-601-9 \n \n[37] SALLES, A.A. DE; LISB\u00d4A, J.A.; FERN\u00c1NDEZ C. E NEVES, E.S. Estimativas \n\nTe\u00f3ricas e Medidas dos Campos Irradiados por Esta\u00e7\u00f5es R\u00e1dio Base Anais do IX \nSimp\u00f3sio Brasileiro de Microondas e Optoeletr\u00f4nica, Jo\u00e3o Pessoa \u2013 PB, Agosto, 2000. \n\n \n[38] YEE, K.S. Numerical Solution of Initial Boundary Value Problems Involving Maxwell\u2019s \n\nEquations in Isotropic Media IEEE Transactions on Antennas and Propagation, vol. \nAP-14, n\u00b05, May 1966, pp.302-307 \n\n \n[39] TAFLOVE, A. Advances in Computational Electrodynamics \u2013 The Finite Difference \n\nTime Domain Method. Artech House, 1998, ISBN 0-89006-834-8.  \n \n[40] http://www.zeland.com/ \n \n[41] OKONIEWSKI, M.;STUCHLY, M. A. A Study of the Handset Antenna and Human \n\nBody Interaction. IEEE T-MTT, v. 44, n. 10, p. 1855-1864, Oct. 1996. \n \n[42] WATANABE, S. Characteristics of the SAR Distributions in a Head Exposed to \n\nElectromagnetic Fields Radiated by a Hand-Held Portable Radio. IEEE  T-MTT, v. 44,       \nn. 10, p. 1874-1883, Oct. 1996. \n\n \n\n \n\nhttp://www.zeland.com/\n\n\nRefer\u00eancias Bibliogr\u00e1ficas 57\n\n[43] DIMBYLOW, P. J.; GANDHI, O. P. Finite-Difference Time-Domain Calculations of \nSAR in a Realistic Heterogeneous Model of the Head for Plane-Wave Exposure from   \n600 MHz to 3 GHz. Phys. Med. Biol., v. 36, p. 1075-1089, Aug. 1991. \n\n \n[44] SALLES, A. A.;FERN\u00c1NDEZ, C. R.;BONADIMAN, M. Simula\u00e7\u00e3o da Taxa de \n\nAbsor\u00e7\u00e3o na Cabe\u00e7a do Usu\u00e1rio do Telefone Celular. Anais do IX Simp\u00f3sio Brasileiro \nde Microondas e Optoeletr\u00f4nica, Jo\u00e3o Pessoa \u2013 PB, Agosto, 2000. \n\n \n[45] SALLES, A. A.;FERN\u00c1NDEZ, C. R.;BONADIMAN, M. Dist\u00e2ncia da Antena e \n\nPot\u00eancia Absorvida na Cabe\u00e7a do Usu\u00e1rio de Telefone Celular. Anais do XVIII \nSimp\u00f3sio Brasileiro de Telecomunica\u00e7\u00f5es, Gramado \u2013 RS, Setembro, 2000. \n\n \n[46] TAFLOVE, A. Computational Electrodynamics \u2013 the Finite Difference Time Domain \n\nMethod. Artech House, 1995, 600p.ISBN 0-89006-792-9.  \n \n[47] BALANIS, C. Antenna Theory Analysis and Design. 2.ed., John Wiley &amp; Sons, 1997, \n\n941p. ISBN 0-471-59268-4. \n \n[48] CENELEC \u2013 Basic Standard for the Measurement of Specific Absorption Rate Related to \n\nHuman Exposure to Electromagnetic Fields from Mobile Phones (300 MHz - 3 GHz). \nRev. Final Draft, TC-211, April, 2000. \n\n \n[49] CHEN, H.,WANG, H. Current and SAR Induced in a Human Head Model by the \n\nElectromagnetic Fields Irradiated from a Cellular Phone. IEEE Trans. on Microwave \nT&amp;T, v. 42, n. 12, Dec. 1994. \n\n \n[50] HOMBACH, V. The Dependence of EM Energy Absorption Upon Human Head \n\nModeling at 900 Mhz. IEEE Trans. on Microwave T&amp;T, v. 44, n. 10, Oct. 1996. \n \n[51] SCHIAVONI, A.; BERTOTTO, P.; RICHIARDI, G.; BIELLI, P. SAR Generated by \n\nCommercial Cellular Phones \u2013 Phone Modeling, and Measurements. IEEE T-MTT,      \nv. 48, n. 11, Nov. 2000. \n\n \n[52] GEDNEY, S.D. et al. Perfect Matched Layer Media With CFS for an Uncondutionally \n\nStable ADI-FDTD Method. IEEE Trans. on Antennas &amp; Propagation, v. 49, n. 11, \nNov. 2001. \n\n \n[53] B\u00c9RENGER, J. P. Perfectly Matched Layer for the FDTD Solution of Wave-Structure \n\nInteraction Problems. IEEE Trans. on Antennas &amp; Propagation, v. 44, n. 1, Jan. 1996. \n \n[54] B\u00c9RENGER, J. P. Improved PML for the FDTD Solution of Wave-Structure Interaction \n\nProblems. IEEE T. Antennas &amp; Prop., v. 45, n. 3, Mar. 1997. \n \n[55] CENTRO NACIONAL DE SUPERCOMPUTA\u00c7\u00c3O, CESUP/RS, \n\nhttp://www.cesup.ufrgs.br \n \n[56] JAMES, J. R.; HALL, P. S.; WOOD, C. Microstrip Antenna: Theory and Design. \n\nPeter Peregrinus, 1981, ISBN: 0-906048-57-5.  \n \n\n \n\nhttp://www.cesup.ufrgs.br/\n\n\nRefer\u00eancias Bibliogr\u00e1ficas 58\n\n[57] POZAR, D. M.; SCHAUBERT, D. H. Microstrip Antennas - The Analysis and Design \nof Microstrip Antennas and Arrays. IEEE Press, 1985, ISBN 0-7803-1078-0.  \n\n \n[58] BARTHIA, P.; RAO, K. V. S.; TOMAR, R. S. Millimeter-Wave Microstrip and \n\nPrinted Circuit Antennas. Artech House, 1990. \n \n[59] VAN DER PAUW, L. J. The Radiation of Electromagnetic Power by Microstrip \n\nConfigurations. IEEE Trans. On MTT, v. 25, n. 9, p. 719-725, Sep. 1977. \n \n[60] BELOHOUBEK, E.; DENLINGER, E. Loss Considerations for Microstrip Resonators. \n\nIEEE Trans. on MTT, v. 23, p.522-526, June 1975. \n \n[61] JENSEN, M. A.; RAHMAT-SAMII, Y. The Electromagnetic Interaction Between \n\nBiological Tissue and Antennas on a Transceiver Handset. IEEE MTT-S International \nMicrowave Symposium, p. 367-370, 1994.  \n\n \n[62] RAHMAT-SAMII, Y. Novel Antennas for Personal Communications Including \n\nBiological Effects. SBMO/IEEE MTT-S IMOC\u201995  Proceedings,  p. 295-308.  \n \n[63] SANAD, M.; AMANT, N. H. An Internal Integrated Microstrip Antenna for \n\nPCS/Cellular Telephones and Other Hand-held Portable Communication Equipment. \nMicrowave Journal, p. 64-77, July 1998. \n\n \n[64] DEAL, W. R.; QIAN, Y.; ITOH, T. Planar Integrated Antenna Technology. Microwave \n\nJournal, p. 128-144, July 1999. \n \n[65] SANAD, M.; HASSAN, N. Compact Internal Multiband Microstrip Antennas for \n\nPortable GPS, PCS, Cellular and Satellite Phones. Microwave Journal, p. 90-98, Aug. \n1999.  \n\n \n[66] BEZERRA, J. M.; JUNQUEIRA, C.; RICHARDS, F. P. Antenas de Faixa-Larga de \n\nPolariza\u00e7\u00e3o Circular Impressas em Microfitas. XVIII Simp\u00f3sio Brasileiro de \nTelecomunica\u00e7\u00f5es, Gramado \u2013 RS, Setembro, 2000. \n\n \n[67] MALONEY, J. G.; SMITH, G. S.; SCOTT, W. R. Accurate Computation of the \n\nRadiation from Simple Antennas Using the Finite-Difference Time-Domain Method. \nIEEE Trans. On AP, v. 38, n. 7, p. 1059-1068, July 1990.  \n\n \n[68] SALLES, A. A.; VIEIRA, J.E.; FRANCO. P.R.; FERN\u00c1NDEZ, C.; SCH\u00c4FFER, L.A.; \n\nALVES, D.M. Simula\u00e7\u00f5es e Medidas dos Campos Irradiados pelos Telefones Celelulares \nPort\u00e1teis. Anais do VIII Simp\u00f3sio Brasileiro de Microondas e Optoeletr\u00f4nica, \nJoinville \u2013 SC, Agosto, 1998, pg 384-388. \n\n \n[69] SAINATI, R. A. CAD of Microstrip Antennas for Wireless Applications. Artech,  \n\n1996, 255p. ISBN 0-890-06-562-4. \n \n[70] JASIK, H. Antenna Engeneering Handbook. Mc.Graw-Hill, 1961. \n\n \n\n\n\nAnexos 59\n\nANEXOS \n\nANEXO1 LISTAGEM DO PROGRAMA PRINCIPAL  \n/********************************************************************* \n* \n*  UFRGS -  UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL \n*  DELET -  DEPARTAMENTO DE ENGENHARIA ELETRICA E ELETRONICA \n*  LACOM -  LABORATORIO DE COMUNICACOES ELETRO-OPTICAS \n* \n*  PROGRAMA PARA CALCULO DE CAMPO ELETROMAGNETICO E SAR \n* \n*  VERSAO:   3.0 / 2001 \n* \n*  A. A. DE SALLES \n*  CLAUDIO FERNANDEZ \n*  MATEUS BONADIMAN \n* \n**********************************************************************/ \n \n \n#include&lt;math.h> \n#include&lt;stdio.h> \n#include&lt;stdlib.h> \n#include&lt;float.h> \n#include&lt;time.h> \n#include&lt;signal.h> \n#include&lt;string.h> \n \n#define VERSAO         \"3.0\" \n \n// SETINGS \n// \n***************************************************************************\n** \n#define NUM_MAX_ITERACAO 900 \n#define INTERVALO   300   // INTERVALO PAGA GRAVACAO DE DADOS \n#define AVISO_GRAVACAO  100  // PARA CADA INTERVALO ELE MANDA UMA MENSAGEM \nPARA A TELA (ANDAMENTO) \n \n#define GRAVA_FRAME_SAR  1 // 1 PARA GRAVAR A SAR \n#define GRAVA_FRAME_E    1 // 1 PARA GRAVAR CAMPOS ELETROMAGNETICOS NA \nREGIAO DE ESTUDO \n#define GRAVA_ANTENA     1 // 1 PARA GRAVAR CAMPOS ELETROMAGNETICOS NA \nREGIAO DA ANTENA \n#define GRAVA_BORDA      0 // 1 PARA GRAVAR A SAR E |E| COM A BORDA \nABSORVEDORA \n#define GRAVA_TELA       0 // 1 PARA GRAVAR A MATRIZ CAB (PARA DEBUG) \n#define GRAVA_PTO        0 // 1 PARA GRAVAR UM DETERMINADO PONTO AO LONGO \nDO TEMPO \n#define MATHLAB          0 // 1 PARA GRAVAR NO FORMATO MATHLAB \n#define QUAL_MATERIAL    1 // 1 PARA CABECA E 0 PARA O AR \n\n \n\n\n\nAnexos 60\n\n#define GRAVA_SAG        1 // 1 PARA GRAVAR CORTES SAGITAIS \n#define GRAVA_FRO        1 // 1 PARA GRAVAR CORTES FRONTAIS \n#define GRAVA_COR        1 // 1 PARA GRAVAR CORTES CORONAIS \n#define TIPODANTENA      \"Monopolo de 1/4 de onda\" \n \n// CONSTANTES DE TAMANHO E DIST\u00c2NCIAS \n#define TAM_BORDAX  30 \n#define TAM_BORDAY  30 \n#define TAM_BORDAZ  30 \n#define TAM_AR1     128     // Ar antes da antena \n#define TAM_ANTENA  1       // Largura da antena \n#define TAM_AR2     50      // Ar entre a antena e a cabeca \n#define TAM_DA_CAB  104     // Largura da cabeca \n#define TAM_AR3     28      // Ar entre a cabeca e a borda \n \n// CONSTANTES DO ARQUIVO COM A MATRIZ DE ELEMENTOS (.FD) \n#define ny  225  // LINHAS \n#define nx  256  // COLUNAS \n#define nz  (2*TAM_BORDAZ)+TAM_AR1+TAM_ANTENA+TAM_DA_CAB+TAM_AR2+TAM_AR3 \n \n// \n*************************************************************************** \n \n// CONSTANTES USADAS EM TODO O PROGRAMA \n#define FREQUENCIA    (850e6) // FREQUENCIA DA FONTE: 850 MHz \n#define LIGHT_SPEED (299792458.0) \n#define MU_0            (1.2566370614359172953850573533118e-6) \n#define EPS_0           (8.8541878176203898505365630317164e-12) \n#define UM    (1.0) \n#define DOIS   (2.0) \n \n// CONSTANTES PARA CALCULO TERMICO \n#define HA       10.5 \n#define HB       50 \n#define TAMB     20 \n#define TSANGUE  37 \n \n// CONSTANTES PARA DEFINICAO ESPACIAL \n \n#define AR   0 \n#define PELE 1 \n#define MUSCULO 2 \n#define CEREBRO 3 \n#define OSSO 4 \n#define OLHO  5 \n#define BORDAX 6 \n#define BORDAY 7 \n#define BORDAZ 8 \n#define CANTO  9 \n \n#define METAL      10 \n#define TERRA      11 \n#define EXCITACAO  12 \n#define CAMPOX     13 \n#define CAMPOY     14 \n#define CAMPOZ     15 \n#define CAMPOSXY   16 \n#define CAMPOSXZ   17 \n#define CAMPOSYZ   18 \n#define TODCAMPOS  19 \n \n\n \n\n\n\nAnexos 61\n\n// CONSTANTES PARA A MATRIZ DE TECIDOS \n \n#define MU  0 \n#define RO  1 \n#define SIGX 2 \n#define SIGY 3 \n#define SIGZ 4 \n#define EPS  5 \n#define MAGSIGX   6 \n#define MAGSIGY   7 \n#define MAGSIGZ   8 \n#define CALORESP  9 \n#define CONDUTERM 10 \n#define SANGUE 11 \n \n// CONSTANTES PARA A BORDA ABSORVEDORA  \n \n#define IMPED_O    377 \n#define MUDIVEPS  (141925.729082) \n#define TEMP_SIG   (0.702) \n#define TEMP_SIGM  (TEMP_SIG*MUDIVEPS) \n \n// CONSTANTES PROPOSTAS ESTATISTICAMENTE POR BERENGER \n \n#define ALPHA 1.5851 \n#define BETA -1.0156 \n#define GAMA 0.18495 \n#define M_REFL    0.01  // Maxima Reflexao aceita na PLM \n \n \n// CONSTANTES PARA MEDIDAS \n \n#define MEDE_VELOC 1    // MEDE A VELOCIDADE DA ONDA \n#define DELTA_DIST 50    // PIXELS DE DIST\u00c2NCIA ENTRE OS PONTOS 1 E 2 \n#define RAIO_POT   100     // 0 NAO CALCULA -> RAIO PARA CALCULO DE POT. \nIRRADIADA \n \n \n#ifdef _CRAYC \n #pragma _CRI bounds \n#endif \n \n// MATRIZ DE TECIDOS E BORDA \n \ndouble material[20][12]= \n/*                  mu       ro      sigx      sigy      sigz             \neps     magsix    magsiy    magsiz   caloresp conduterm    sangue*/ \n \n/* AR */        {{MU_0, 0.0013,       0.0,      0.0,     0.0,          \nEPS_0,       0.0,      0.0,    0.0,       0.0,      0.0,      0.0}, \n \n/* PELE */    {MU_0, 1.1000,    0.6000,   0.6000,   0.6000,  \n34.5000*EPS_0,       0.0,      0.0,    0.0,      3500,     0.50,     \n8652}, \n \n/* MUSCULO */   {MU_0, 1.0400,    1.2100,   1.2100,   1.2100,  \n58.5000*EPS_0,       0.0,      0.0,    0.0,   3500,     0.60,     \n3488}, \n \n\n \n\n\n\nAnexos 62\n\n/* CEREBRO */   {MU_0, 1.0300,    1.2300,   1.2300,   1.2300,  \n55.0000*EPS_0,       0.0,      0.0,    0.0,   3500,     0.60,    \n37822}, \n/* OSSO */    {MU_0, 1.8500,    0.1050,   0.1050,   0.1050,   \n8.0000*EPS_0,      0.0,      0.0,    0.0,   1300,     0.30,     \n1401}, \n \n/* OLHO */    {MU_0, 1.0200,    1.6800,   1.6800,   1.6800,  \n67.9000*EPS_0,       0.0,      0.0,    0.0,   3900,     0.50,      \n0.0}, \n \n/* BORDAX */   {MU_0,    1.0,  TEMP_SIG,    0.0,    \n0.0,          EPS_0, TEMP_SIGM,      0.0,    0.0,    0.0,\n    0.0,    0.0}, \n \n/* BORDAY */   {MU_0,    1.0,       0.0, TEMP_SIG,     0.0,          \nEPS_0,   0.0,TEMP_SIGM,    0.0,    0.0,      0.0, \n  0.0}, \n \n/* BORDAZ */   {MU_0,    1.0,     0.0,    0.0, \nTEMP_SIG,          EPS_0,     0.0,      0.0,TEMP_SIGM,    \n0.0,    0.0,      0.0}, \n \n/* CANTO */    {MU_0,    1.0,  TEMP_SIG, TEMP_SIG, TEMP_SIG,          \nEPS_0, TEMP_SIGM,TEMP_SIGM,TEMP_SIGM,    0.0,      0.0,      0.0}, \n/* METAL */      {MU_0,    1.0,     5.8e7,    5.8e7,    5.8e7,          \nEPS_0,     0.0,      0.0,    0.0,    0.0,      0.0,      \n0.0}, \n \n/* TERRA */      {MU_0,    1.0,     5.8e7,    5.8e7,    5.8e7,      \n EPS_0,     0.0,      0.0,    0.0,    0.0,      0.0,      \n0.0}, \n \n/* EXCITACAO */  {MU_0, 0.0013,       0.0,      0.0,     0.0,          \nEPS_0,       0.0,      0.0,    0.0,    0.0,      0.0,      0.0}, \n \n/* CAMPOX */     {MU_0,    1.0,     5.8e7,    5.8e7,    5.8e7,          \nEPS_0,     0.0,      0.0,    0.0,    0.0,      0.0,      \n0.0}, \n \n/* CAMPOY */   {MU_0,    1.0,     5.8e7,    5.8e7,    5.8e7,          \nEPS_0,     0.0,      0.0,    0.0,    0.0,      0.0,      \n0.0}, \n \n/* CAMPOZ */   {MU_0,    1.0,     5.8e7,    5.8e7,    5.8e7,          \nEPS_0,     0.0,      0.0,    0.0,    0.0,      0.0,      \n0.0}, \n \n/* CAMPOSXY */   {MU_0,    1.0,     5.8e7,    5.8e7,    5.8e7,          \nEPS_0,     0.0,      0.0,    0.0,    0.0,      0.0,      \n0.0}, \n \n/* CAMPOSXZ */   {MU_0,    1.0,     5.8e7,    5.8e7,    5.8e7,          \nEPS_0,     0.0,      0.0,    0.0,    0.0,      0.0,      \n0.0}, \n \n/* CAMPOSYZ */   {MU_0,    1.0,     5.8e7,    5.8e7,    5.8e7,          \nEPS_0,     0.0,      0.0,    0.0,    0.0,      0.0,      \n0.0}, \n \n\n \n\n\n\nAnexos 63\n\n/* TODCAMPOS */  {MU_0,    1.0,     5.8e7,    5.8e7,    5.8e7,          \nEPS_0,     0.0,      0.0,    0.0,    0.0,      0.0,      \n0.0}}; \n \n// DECLARACAO DE FUNCOES \n \nvoid  Gera_bordaz(int k); \nvoid  Gera_matriz_ar(int k); \nvoid  Gera_antena1(int k, int); \nvoid  faz_calc_hx(double, double, double, double, double, double, double \n*atingiu_borda, double *degringolou); \nvoid  faz_calc_hy(double, double, double, double, double, double, double \n*atingiu_borda, double *degringolou); \nvoid  faz_calc_hz(double, double, double, double, double, double, double \n*atingiu_borda, double *degringolou); \nvoid  faz_calc_ex(double, double, double, double, double, double, double \n*atingiu_borda, double *degringolou); \nvoid  faz_calc_ey(double, double, double, double, double, double, double \n*atingiu_borda, double *degringolou); \nvoid  faz_calc_ez(double dx, double dy, double dz, double dt, double \n*cpopele, double *cpomusc, double *cpoosso, double *cpoolho, double \n*cpocereb, double *cpoar, double berenger_g, double sigma_zero, double, \ndouble *atingiu_borda, double *degringolou); \n \nvoid  grava_tela_cab(int k); \nvoid  grava_rel_sar(double, double, double, double, double, double, double, \ndouble, double, double, int, double, double, double, double, int, double, \ndouble, int, int, double, double); \nvoid  signal_handler_fpu(int *p); \nvoid  signal_handler_sigsev(int *p); \nvoid  erro_alocacao(void); \n \nint   calcula_memoria_req(void); \nunsigned int aloca_memoria(void); \n \nvoid  grava_sar_sag(int, int, int, int); \nvoid  grava_sar_fro(int, int, int, int, int, int); \nvoid  grava_sar_cor(int, int, int, int, int, int); \nvoid  grava_cpo_sag(int, int, int, int); \nvoid  grava_cpo_fro(int, int, int, int, int, int); \nvoid  grava_cpo_cor(int, int, int, int, int, int); \n \n// DECLARACAO DE PONTEIROS \n \ndouble ***ex, ***ey, ***ez; \ndouble ***hx, ***hy, ***hz; \ndouble ***vsar; \n \ntime_t horacom,horaini; \n \n// MATRIZ DA ANTENA (DEVE TER MENOS QUE 100 PONTOS, POIS AQUI DECLARO COM \n100) \n \nint antena[100][3]; \n \n// DECLARACAO DE MATRIZES \n \nint cab[nx+2*TAM_BORDAY][ny+2*TAM_BORDAX][nz]; \ndouble guarda_cpo[91][3]; \n \n// ********************************* \n\n \n\n\n\nAnexos 64\n\n// * INICIO DO ALGORITMO PRINCIPAL * \n// ********************************* \n \nvoid main(int argc,char *argv[]) \n{ \n int \ni,j,k,inter,bytesalocados,contant,nro_fontes,auxi,auxj,auxk,ctagrav, \n   \ngravabx,gravaby,nmax,soma_iter_av,m_int_pto1,m_int_pto2,m_aux_zer; \n \n unsigned int interacao,interacoes; \n \n double \nTempoAtualSimulado,TempoTotalSimulado,omega,dx,dy,dz,dt,diff_time,fonte, \n    \ncpopele,cpomusc,cpoosso,cpoolho,cpocereb,cpoar,log_g,berenger_g,sigma_zero, \n    \nnro_cel_borda,atingiu_borda,degringolou,nro_iterac,m_val_pto1,m_val_pto2, \n    m_ant_pto1,m_ant_pto2,m_aux_pot; \n \n char nomarq[20],nompto[20]; \n \n time_t time1,time2; \n \n FILE *arqpto,*arqpot; \n \n #ifdef __WIN32__ \n  if(signal(SIGFPE,signal_handler_fpu) == SIG_ERR) \n   printf(\"Erro Signal sigfpe\\n\"); \n  if(signal(SIGSEGV,signal_handler_sigsev) == SIG_ERR) \n   printf(\"Erro Signal sigsegv\\n\"); \n #endif \n \n interacoes = NUM_MAX_ITERACAO; \n \n omega = DOIS*M_PI*FREQUENCIA; \n \n // VARIAVEIS PARA RELATORIO \n \n cpopele=0; \n cpomusc=0; \n cpoosso=0; \n cpoolho=0; \n cpocereb=0; \n cpoar=0; \n   m_aux_zer=0; \n nro_iterac=0.0; \n degringolou=0.0; \n m_val_pto1=0.0; \n m_val_pto2=0.0; \n m_ant_pto1=0.0; \n m_ant_pto2=0.0; \n m_int_pto1=0; \n m_int_pto2=0; \n soma_iter_av=0; \n atingiu_borda=0.0; \n m_aux_pot=0.0; \n \n // VARIAVEIS PARA MAGIC-STEP \n \n dx = 9e-4; debug \n\n \n\n\n\nAnexos 65\n\n dy = 9e-4; \n dz = 9e-4; \n \n \n // dt PARA MAGIC-STEP \n dt = dx/(LIGHT_SPEED*sqrt(3)); \n \n fonte=0.0; \n \n TempoTotalSimulado = interacoes*dt; \n bytesalocados      = calcula_memoria_req(); \n bytesalocados      = aloca_memoria(); \n \n // CALCULOS PARA A BORDA DE BERENGER \n if ( nx>ny &amp;&amp; nx>(nz-(2*TAM_BORDAZ))) \n  nmax = nx; \n else if (ny>nx &amp;&amp; ny>(nz-(2*TAM_BORDAZ))) \n  nmax = ny; \n else if ((nz-(2*TAM_BORDAZ))>nx &amp;&amp; (nz-(2*TAM_BORDAZ))>ny) \n  nmax = (nz-(2*TAM_BORDAZ)); \n else \n  nmax = nx; \n \n log_g = ALPHA+BETA*log10(nmax)+GAMA*pow(log10(nmax),2.0); \n berenger_g = pow(10.0,log_g); \n \n // Tamanho da borda devera ser SEMPRE maior que nro_cel_borda \n nro_cel_borda = (1/log(berenger_g))*log(1-(sqrt(berenger_g)-\n1)*log10(M_REFL)*ny*100000/(2*M_PI)); \n \n sigma_zero = -\n((EPS_0*LIGHT_SPEED)/(2*dx))*(log(berenger_g)/(pow(berenger_g,nmax)-\n1))*log(M_REFL); \n \n // IMPRIME CABECALHO NA TELA \n \n fprintf(stdout,\"************************************************** \n\\n\"); \n fprintf(stdout,\"UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL (UFRGS)  \n\\n\"); \n fprintf(stdout,\"   DEPARTAMENTO DE ENGENHARIA ELETRICA (DELET)     \n\\n\"); \n fprintf(stdout,\"LABORATORIO DE COMUNICACOES ELETRO-OPTICAS (LACOM) \n\\n\"); \n fprintf(stdout,\"     SIMULADOR FDTD VERSAO %s - UFRGS - 2001       \n\\n\",VERSAO); \n fprintf(stdout,\"************************************************** \n\\n\\n\"); \n \n if (QUAL_MATERIAL) \n  fprintf(stdout, \"Material em Estudo...: CABE\u00c7A\\n\"); \n else \n  fprintf(stdout, \"Material em Estudo...: AR\\n\"); \n \n fprintf(stdout,    \"N\u00famero de Itera\u00e7oes..: %d\\n\",NUM_MAX_ITERACAO); \n fprintf(stdout,    \"Intervalo de Grava\u00e7\u00e4o: %d\\n\",INTERVALO); \n fprintf(stdout,    \"Memoria Necessaria...: %f MBytes\\n\", \n((bytesalocados/1000000.0)+100)); \n fprintf(stdout,    \"Antena Utilizada.....: %s\\n\",TIPODANTENA); \n fprintf(stdout,    \"Frequencia...........: %lg Hz\\n\",FREQUENCIA); \n\n \n\n\n\nAnexos 66\n\n fprintf(stdout,    \"Comprimento de Onda..: %lg \nm\\n\",LIGHT_SPEED/FREQUENCIA); \n fprintf(stdout,    \"Dist\u00e2ncia Total......: %lg m ou %lg \ncomprimento(s) de onda\\n\" \n       ,LIGHT_SPEED*dt*NUM_MAX_ITERACAO \n      \n ,((LIGHT_SPEED*dt*NUM_MAX_ITERACAO)/(LIGHT_SPEED/FREQUENCIA))); \n \n fprintf(stdout, \"%dx%dx%d celulas\\ndx=%lg metros\\ndy=%lg \nmetros\\ndz=%lg\\ \n metros \\ndt=%lg segundos\\n\",nx+2*TAM_BORDAY, ny+2*TAM_BORDAX, nz, dx, dy, \ndz,dt); \n \n if (GRAVA_FRAME_SAR) \n  fprintf(stdout, \"Grava a SAR a cada %d iteracoes, %lg \nsegundos\\n\",INTERVALO,INTERVALO*dt); \n if (GRAVA_FRAME_E) \n  fprintf(stdout, \"Grava o |E| a cada %d iteracoes, %lg \nsegundos\\n\",INTERVALO,INTERVALO*dt); \n if (GRAVA_ANTENA) \n  fprintf(stdout, \"Grava o |E| da ANTENA a cada %d iteracoes, %lg \nsegundos\\n\",INTERVALO,INTERVALO*dt); \n \n if (QUAL_MATERIAL) \n  fprintf(stdout, \"Dist\u00e2ncia da Antena a Cabeca = %lg \ncm\\n\",TAM_AR2*dx*100); \n \n \n fprintf(stdout,\"************************************************** \n\\n\\n\"); \n fflush(stdout); \n \n \n \n auxi = TAM_BORDAY+128; \n auxj = TAM_BORDAX+ny-3; \n auxk = TAM_BORDAZ+TAM_AR1; \n \n for (k = 0 ; k&lt;= 90 ; k++) \n { \n \n  i = ( auxi + (int)RAIO_POT*cos(k) ); \n  j = ( auxj - (int)RAIO_POT*sin(k) ); \n \n  fprintf(stdout, \"i=%d  j=%d  k=%d\\n\",i,j,auxk); \n } \n   fflush(stdout); \n \n \n \n \n contant= 1; \n inter  = 0; \n \n // CARREGA OS ARQUIVOS PARA AS MATRIZES \n \n printf(\"Carregando Matrizes... \\n\"); \n fflush(stdout); \n \n // CARREGA BORDA ABSORVEDORA NA DIMENCAO Z \n for( k = 0 ; k &lt;TAM_BORDAZ ; k ++ ) \n\n \n\n\n\nAnexos 67\n\n  Gera_bordaz(k); \n \n // CARREGA MATRIZ DE AR \n for( k = TAM_BORDAZ ; k &lt;TAM_BORDAZ+TAM_AR1 ; k ++ ) \n  Gera_matriz_ar(k); \n \n printf(\"Carregando Antena... \\n\"); \n fflush(stdout); \n \n // CARREGA ANTENA \n for( k = TAM_BORDAZ+TAM_AR1 ; k &lt;TAM_BORDAZ+TAM_AR1+TAM_ANTENA ; k \n++ ) \n//  Gera_antena1(k, contant++); \n  Gera_matriz_ar(k); \n \n // CARREGA MATRIZ DE AR \n for( k = TAM_BORDAZ+TAM_AR1+TAM_ANTENA ; k &lt;\nTAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2 ; k ++ ) \n  Gera_matriz_ar(k); \n \n if (QUAL_MATERIAL) \n { \n  // CARREGA MATRIZ DA CABECA \n  contant= 1; \n  for( k = TAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2 ; k &lt;\nTAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2+TAM_DA_CAB/2 ; k ++ ) \n   Gera_cabeca(k, contant++); \n  contant= TAM_DA_CAB/2; \n  for( k = TAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2+TAM_DA_CAB/2 ; k \n&lt;TAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2+TAM_DA_CAB ; k ++ ) \n   Gera_cabeca(k, contant--); \n } \n else \n { \n  // CARREGA AR \n  for( k = TAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2 ; k &lt;\nTAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2+TAM_DA_CAB ; k ++ ) \n   Gera_matriz_ar(k); \n } \n \n // CARREGA MATRIZ DE AR \n for( k = TAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2+TAM_DA_CAB ; k &lt;\nTAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2+TAM_DA_CAB+TAM_AR3 ; k ++ ) \n  Gera_matriz_ar(k); \n \n // CARREGA BORDA ABSORVEDORA NA DIMENCAO Z \n for( k = TAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2+TAM_DA_CAB+TAM_AR3 ; k \n&lt;TAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2+TAM_DA_CAB+TAM_AR3+TAM_BORDAZ ; k \n++ ) \n  Gera_bordaz(k); \n \n // CRIA UM PLANO TERRA EM TODA A EXTENSAO DO DOMINIO \n for( k = TAM_BORDAZ ; k &lt;nz-TAM_BORDAZ ; k ++ ) \n { \n  for (i = TAM_BORDAY ; i<nx+TAM_BORDAY ; i++) \n  { \n   cab[i][TAM_BORDAX+ny-2][k]=TERRA; \n  } \n } \n \n // \"DESENHA\" A ANTENA NO ESPACO \n\n \n\n\n\nAnexos 68\n\n cab[TAM_BORDAY+128][TAM_BORDAX+ny-3][TAM_BORDAZ+TAM_AR1]=EXCITACAO; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-4][TAM_BORDAZ+TAM_AR1]=TODCAMPOS; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-5][TAM_BORDAZ+TAM_AR1]=CAMPOSXZ; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-6][TAM_BORDAZ+TAM_AR1]=CAMPOSXZ; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-7][TAM_BORDAZ+TAM_AR1]=CAMPOSXZ; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-8][TAM_BORDAZ+TAM_AR1]=CAMPOSXZ; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-9][TAM_BORDAZ+TAM_AR1]=CAMPOSXZ; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-10][TAM_BORDAZ+TAM_AR1]=CAMPOSXZ; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-11][TAM_BORDAZ+TAM_AR1]=CAMPOSXZ; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-12][TAM_BORDAZ+TAM_AR1]=CAMPOSXZ; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-13][TAM_BORDAZ+TAM_AR1]=CAMPOSXZ; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-14][TAM_BORDAZ+TAM_AR1]=CAMPOSXZ; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-15][TAM_BORDAZ+TAM_AR1]=CAMPOSXZ; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-16][TAM_BORDAZ+TAM_AR1]=CAMPOSXZ; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-17][TAM_BORDAZ+TAM_AR1]=CAMPOSXZ; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-18][TAM_BORDAZ+TAM_AR1]=CAMPOSXZ; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-19][TAM_BORDAZ+TAM_AR1]=TODCAMPOS; \n \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-3][TAM_BORDAZ+TAM_AR1]=EXCITACAO; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-4][TAM_BORDAZ+TAM_AR1]=EXCITACAO; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-5][TAM_BORDAZ+TAM_AR1]=EXCITACAO; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-6][TAM_BORDAZ+TAM_AR1]=EXCITACAO; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-7][TAM_BORDAZ+TAM_AR1]=EXCITACAO; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-8][TAM_BORDAZ+TAM_AR1]=EXCITACAO; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-9][TAM_BORDAZ+TAM_AR1]=EXCITACAO; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-10][TAM_BORDAZ+TAM_AR1]=EXCITACAO; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-11][TAM_BORDAZ+TAM_AR1]=EXCITACAO; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-12][TAM_BORDAZ+TAM_AR1]=EXCITACAO; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-13][TAM_BORDAZ+TAM_AR1]=EXCITACAO; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-14][TAM_BORDAZ+TAM_AR1]=EXCITACAO; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-15][TAM_BORDAZ+TAM_AR1]=EXCITACAO; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-16][TAM_BORDAZ+TAM_AR1]=EXCITACAO; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-17][TAM_BORDAZ+TAM_AR1]=EXCITACAO; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-18][TAM_BORDAZ+TAM_AR1]=EXCITACAO; \n cab[TAM_BORDAY+128][TAM_BORDAX+ny-19][TAM_BORDAZ+TAM_AR1]=EXCITACAO; \n \n printf(\"Carga de Matrizes Finalizada... \\n\"); \n fflush(stdout); \n \n if (GRAVA_TELA) \n { \n  grava_tela_cab(TAM_BORDAZ+TAM_AR1); \n  grava_tela_cab(2); \n  for( k = 0 ; k &lt;4 ; k ++ ) \n   grava_tela_cab(k); \n } \n \n // INICIA MATRIZ COM A POSICAO PARA A FONTE (ANTENA) \n \n printf(\"Iniciando posicionamento da fonte... \\n\"); \n fflush(stdout); \n \n nro_fontes=0; \n \n for( k = TAM_BORDAZ+TAM_AR1 ; k &lt;TAM_BORDAZ+TAM_AR1+TAM_ANTENA ; k \n++ ) \n { \n  for (j = 0 ; j<2*TAM_BORDAX+ny ; j++) \n  { \n   for (i =0 ; i<2*TAM_BORDAY+nx ; i++) \n   { \n\n \n\n\n\nAnexos 69\n\n    if ( cab[i][j][k] == EXCITACAO ) \n    { \n     antena[nro_fontes][0]=i; \n     antena[nro_fontes][1]=j; \n     antena[nro_fontes][2]=k; \n     nro_fontes++; \n    } \n   } \n  } \n } \n \n // CALCULO FDTD \n \n printf(\"Iniciando Calculo FDTD... \\n\"); \n fflush(stdout); \n \n if (GRAVA_PTO) \n { \n  sprintf(nomarq,\"campo_pto.txt\"); \n  arqpto=fopen(nomarq,\"w+\"); \n } \n \n if (RAIO_POT > 0 ) \n { \n  sprintf(nompto,\"pot\u00eancia_cpo.txt\"); \n  arqpot=fopen(nompto,\"w+\"); \n } \n \n time1 = time(NULL); \n horacom = time(NULL); \n time(&amp;horaini); \n \n for(interacao = 0; interacao &lt;interacoes; interacao++) \n { \n  TempoAtualSimulado = dt*(double)interacao; \n  nro_iterac++; \n \n  if((((interacao % AVISO_GRAVACAO) == 0 ) &amp;&amp; interacao)) \n  { \n   soma_iter_av += AVISO_GRAVACAO; \n   printf(\"J\u00e1 se Passaram %d Itera\u00e7\u00f6es! \\n\",soma_iter_av); \n   fflush(stdout); \n  } \n \n  // GRAVA ARQUIVOS NAS ITERACOES DESEJADAS \n  if((((interacao % INTERVALO) == 0 ) &amp;&amp; interacao)) \n  { \n   inter++; \n   if (GRAVA_FRAME_SAR) \n    fprintf(stdout, \"Gravando a SAR com um total de %d \niteracoes.\\n\",interacao); \n   if (GRAVA_FRAME_E) \n    fprintf(stdout, \"Gravando o |E| com um total de %d \niteracoes.\\n\",interacao); \n   if (GRAVA_ANTENA) \n    fprintf(stdout, \"Gravando a ANTENA com um total de \n%d iteracoes.\\n\",interacao); \n   fflush(stdout); \n \n   if (GRAVA_ANTENA) \n   { \n\n \n\n\n\nAnexos 70\n\n    ctagrav = 0; \n \n    if (GRAVA_SAG) \n    { \n     // GRAVA TODAS AS IMAGENS SAGITAIS \n/*     for( k = TAM_BORDAZ+TAM_AR1 ; k &lt;\nTAM_BORDAZ+TAM_AR1+TAM_ANTENA ; k ++ ) \n     { \n      ctagrav++; \n      grava_cpo_sag(inter,ctagrav,k,0); \n     }*/ \n \n     // GRAVA AS IMAGENS SAGITAIS SELECIONADAS \n     grava_cpo_sag(inter,1,TAM_BORDAZ+TAM_AR1-\n100,0); \n     grava_cpo_sag(inter,2,TAM_BORDAZ+TAM_AR1-\n50,0); \n     grava_cpo_sag(inter,3,TAM_BORDAZ+TAM_AR1-\n25,0); \n     grava_cpo_sag(inter,4,TAM_BORDAZ+TAM_AR1,0); \n     grava_cpo_sag(inter,5,TAM_BORDAZ+TAM_AR1+2,0); \n    \n grava_cpo_sag(inter,6,TAM_BORDAZ+TAM_AR1+10,0); \n    \n grava_cpo_sag(inter,7,TAM_BORDAZ+TAM_AR1+35,0); \n    } \n \n    ctagrav = 0; \n    gravaby = 0; \n \n    if (GRAVA_BORDA) \n     gravaby = TAM_BORDAY; \n \n    if (GRAVA_FRO) \n    { \n     // GRAVA AS IMAGENS FRONTAIS \n     for( i = TAM_BORDAY-gravaby ; i &lt;\nnx+TAM_BORDAY+gravaby ; i++) \n     { \n      ctagrav++; \n     \n grava_cpo_fro(inter,ctagrav,i,TAM_BORDAZ+TAM_AR1,TAM_BORDAZ+TAM_AR1+T\nAM_ANTENA,0); \n     } \n    } \n \n    ctagrav = 0; \n    gravabx = 0; \n \n    if (GRAVA_BORDA) \n     gravabx = TAM_BORDAX; \n \n    if (GRAVA_COR) \n    { \n \n     // GRAVA TODAS AS IMAGENS CORONAIS \n/*     for( j = TAM_BORDAX-gravabx ; j &lt;\nny+TAM_BORDAX+gravabx ; j++) \n     { \n      ctagrav++; \n\n \n\n\n\nAnexos 71\n\n     \n grava_cpo_cor(inter,ctagrav,j,TAM_BORDAZ+TAM_AR1,TAM_BORDAZ+TAM_AR1+T\nAM_ANTENA,0); \n     }*/ \n \n     // GRAVA AS IMAGENS CORONAIS SELECIONADAS \n    \n grava_cpo_cor(inter,1,TAM_BORDAX+28,TAM_BORDAZ,nz-TAM_BORDAZ,0); \n    \n grava_cpo_cor(inter,2,TAM_BORDAX+98,TAM_BORDAZ,nz-TAM_BORDAZ,0); \n    \n grava_cpo_cor(inter,3,TAM_BORDAX+128,TAM_BORDAZ,nz-TAM_BORDAZ,0); \n    \n grava_cpo_cor(inter,4,TAM_BORDAX+128+8,TAM_BORDAZ,nz-TAM_BORDAZ,0); \n    \n grava_cpo_cor(inter,5,TAM_BORDAX+128+16,TAM_BORDAZ,nz-TAM_BORDAZ,0); \n    } \n   } \n \n   ctagrav = 0; \n \n   // GRAVA AS IMAGENS SAGITAIS \n   for( k = TAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2 ; k &lt;\nTAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2+TAM_DA_CAB ; k ++ ) \n   { \n    ctagrav++; \n    if (QUAL_MATERIAL) \n    { \n     // GRAVA A SAR DA CABECA \n     if (GRAVA_FRAME_SAR &amp;&amp; GRAVA_SAG) \n     \n grava_sar_sag(inter,ctagrav,k,interacao+1); \n    } \n    // GRAVA O MODULO DO CAMPO ELETROMAGNETICO \n    if (GRAVA_FRAME_E &amp;&amp; GRAVA_SAG) \n     grava_cpo_sag(inter,ctagrav,k,1); \n   } \n \n   ctagrav = 0; \n   gravaby = 0; \n \n   if (GRAVA_BORDA) \n    gravaby = TAM_BORDAY; \n \n   // GRAVA AS IMAGENS FRONTAIS \n   for( i = TAM_BORDAY-gravaby ; i &lt;nx+TAM_BORDAY+gravaby ; \ni++) \n   { \n    ctagrav++; \n    if (QUAL_MATERIAL) \n    { \n     // GRAVA A SAR DA CABECA \n     if (GRAVA_FRAME_SAR &amp;&amp; GRAVA_FRO) \n     \n grava_sar_fro(inter,ctagrav,interacao+1,i,TAM_BORDAZ+TAM_AR1+TAM_ANTE\nNA+TAM_AR2,TAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2+TAM_DA_CAB); \n    } \n    // GRAVA O MODULO DO CAMPO ELETROMAGNETICO \n    if (GRAVA_FRAME_E &amp;&amp; GRAVA_FRO) \n\n \n\n\n\nAnexos 72\n\n    \n grava_cpo_fro(inter,ctagrav,i,TAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2,T\nAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2+TAM_DA_CAB,1); \n   } \n \n   ctagrav = 0; \n   gravabx = 0; \n \n   if (GRAVA_BORDA) \n    gravabx = TAM_BORDAX; \n \n   // GRAVA AS IMAGENS CORONAIS \n   for( j = TAM_BORDAX-gravabx ; j &lt;ny+TAM_BORDAX+gravabx ; \nj++) \n   { \n    ctagrav++; \n    if (QUAL_MATERIAL) \n    { \n     // GRAVA A SAR DA CABECA \n     if (GRAVA_FRAME_SAR || GRAVA_COR) \n     \n grava_sar_cor(inter,ctagrav,interacao+1,j,TAM_BORDAZ+TAM_AR1+TAM_ANTE\nNA+TAM_AR2,TAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2+TAM_DA_CAB); \n    } \n    // GRAVA O MODULO DO CAMPO ELETROMAGNETICO \n    if (GRAVA_FRAME_E &amp;&amp; GRAVA_COR) \n    \n grava_cpo_cor(inter,ctagrav,j,TAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2,T\nAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2+TAM_DA_CAB,1); \n   } \n \n  } \n \n  // ATUALIZACAO DA ANTENA \n \n  fonte = sqrt(2)*sin(omega*TempoAtualSimulado); \n \n  for ( i=0 ; i<nro_fontes ; i++) \n  { \n   auxi=antena[i][0]; \n   auxj=antena[i][1]; \n   auxk=antena[i][2]; \n   ey[auxi][auxj][auxk] = fonte; \n  } \n \n  // CALCULA OS CAMPOS MAGNETICOS \n \n faz_calc_hx(dy,dz,dt,berenger_g,sigma_zero,nro_iterac,&amp;atingiu_borda,\n&amp;degringolou); \n \n faz_calc_hy(dx,dz,dt,berenger_g,sigma_zero,nro_iterac,&amp;atingiu_borda,\n&amp;degringolou); \n \n faz_calc_hz(dy,dx,dt,berenger_g,sigma_zero,nro_iterac,&amp;atingiu_borda,\n&amp;degringolou); \n \n  // CALCULA OS CAMPOS ELETRICOS \n \n faz_calc_ex(dy,dz,dt,berenger_g,sigma_zero,nro_iterac,&amp;atingiu_borda,\n&amp;degringolou); \n\n \n\n\n\nAnexos 73\n\n \n faz_calc_ey(dx,dz,dt,berenger_g,sigma_zero,nro_iterac,&amp;atingiu_borda,\n&amp;degringolou); \n \n faz_calc_ez(dx,dy,dz,dt,&amp;cpopele,&amp;cpomusc,&amp;cpoosso,&amp;cpoolho,&amp;cpocereb\n,&amp;cpoar, \n     \n berenger_g,sigma_zero,nro_iterac,&amp;atingiu_borda,&amp;degringolou); \n \n  if (MEDE_VELOC) \n  { \n   if (m_int_pto1 == 0 || interacao >= 50) \n   { \n    auxi = TAM_BORDAY+128; \n    auxj = TAM_BORDAX+ny-11; \n    auxk = TAM_BORDAZ+TAM_AR1+50; \n \n    m_val_pto1 = sqrt( \n(ex[auxi][auxj][auxk]*ex[auxi][auxj][auxk])+ \n           \n(ey[auxi][auxj][auxk]*ey[auxi][auxj][auxk])+ \n           \n(ez[auxi][auxj][auxk]*ez[auxi][auxj][auxk])); \n \n    if ( m_val_pto1 &lt;m_ant_pto1 ) \n    { \n     m_int_pto1 = interacao-1; \n     m_val_pto1 = m_ant_pto1; \n    } \n    else \n     m_ant_pto1 = m_val_pto1; \n   } \n \n   if (m_int_pto2 == 0 || interacao >= 100) \n   { \n    auxi = TAM_BORDAY+128; \n    auxj = TAM_BORDAX+ny-11; \n    auxk = TAM_BORDAZ+TAM_AR1+100; \n \n    m_val_pto2 = sqrt( \n(ex[auxi][auxj][auxk]*ex[auxi][auxj][auxk])+ \n           \n(ey[auxi][auxj][auxk]*ey[auxi][auxj][auxk])+ \n           \n(ez[auxi][auxj][auxk]*ez[auxi][auxj][auxk])); \n \n    if ( m_val_pto2 &lt;m_ant_pto2 ) \n    { \n     m_int_pto2 = interacao-1; \n     m_val_pto2 = m_ant_pto2; \n    } \n    else \n     m_ant_pto2 = m_val_pto2; \n   } \n  } \n \n  if (RAIO_POT != 0) \n  { \n   if ( interacao > 100 ) \n   { \n    // PONTOS DO CENTRO DA ESFERA \n\n \n\n\n\nAnexos 74\n\n    auxi = TAM_BORDAY+128; \n    auxj = TAM_BORDAX+ny-3; \n    auxk = TAM_BORDAZ+TAM_AR1; \n \n    for (k = 0 ; k&lt;= 90 ; k++) \n    { \n \n     i = ( auxi + (int)RAIO_POT*cos(k) ); \n     j = ( auxj - (int)RAIO_POT*sin(k) ); \n \n     m_aux_pot = sqrt( \n(ex[i][j][auxk]*ex[i][j][auxk])+(ey[i][j][auxk]*ey[i][j][auxk])+ \n          \n (ez[i][j][auxk]*ez[i][j][auxk]) ); \n \n     guarda_cpo[k][0] += m_aux_pot; \n \n     if ( guarda_cpo[k][1] &lt;m_aux_pot ) \n      guarda_cpo[k][1] = m_aux_pot; \n \n     guarda_cpo[k][2] += sqrt( \n(ex[i][j][auxk]*ex[i][j][auxk])+ \n            \n   (ey[i][j][auxk]*ey[i][j][auxk]) ); \n    } \n \n   } \n  } \n \n  if (GRAVA_PTO) \n  { \n   fprintf(arqpto,\"%d; \",interacao); \n \n   auxi = TAM_BORDAY+128; \n   auxj = TAM_BORDAX+ny-11; \n   auxk = TAM_BORDAZ+TAM_AR1+50; \n   fprintf(arqpto,\"%.4e; \n\",sqrt((ex[auxi][auxj][auxk]*ex[auxi][auxj][auxk])+ \n      \n(ey[auxi][auxj][auxk]*ey[auxi][auxj][auxk])+(ez[auxi][auxj][auxk]* \n       ez[auxi][auxj][auxk]))); \n \n   auxi = TAM_BORDAY+128; \n   auxj = TAM_BORDAX+ny-11; \n   auxk = TAM_BORDAZ+TAM_AR1+100; \n   fprintf(arqpto,\"%.4e; \n\",sqrt((ex[auxi][auxj][auxk]*ex[auxi][auxj][auxk])+ \n      \n(ey[auxi][auxj][auxk]*ey[auxi][auxj][auxk])+(ez[auxi][auxj][auxk]* \n       ez[auxi][auxj][auxk]))); \n \n   auxi = TAM_BORDAY+178; \n   auxj = TAM_BORDAX+ny-11; \n   auxk = TAM_BORDAZ+TAM_AR1; \n   fprintf(arqpto,\"%.4e; \n\",sqrt((ex[auxi][auxj][auxk]*ex[auxi][auxj][auxk])+ \n      \n(ey[auxi][auxj][auxk]*ey[auxi][auxj][auxk])+(ez[auxi][auxj][auxk]* \n       ez[auxi][auxj][auxk]))); \n \n   auxi = TAM_BORDAY+228; \n\n \n\n\n\nAnexos 75\n\n   auxj = TAM_BORDAX+ny-11; \n   auxk = TAM_BORDAZ+TAM_AR1; \n   fprintf(arqpto,\"%.4e; \n\",sqrt((ex[auxi][auxj][auxk]*ex[auxi][auxj][auxk])+ \n      \n(ey[auxi][auxj][auxk]*ey[auxi][auxj][auxk])+(ez[auxi][auxj][auxk]* \n       ez[auxi][auxj][auxk]))); \n \n   fprintf(arqpto,\"\\n\"); \n  } \n \n } \n \n // ********************************************** \n // FIM DOS CALCULOS \n // INICIO DAS GRAVA\u00c7OES FINAIS \n // ********************************************** \n \n if (GRAVA_PTO) \n { \n  fprintf(stdout, \"Salvando Arquivo com a Tabela de Campos nos \nPontos Escolhidos.\\n\"); \n  fclose(arqpto); \n } \n \n if ( RAIO_POT > 0 ) \n { \n \n  fprintf(stdout, \"Salvando Arquivo com a Tabela de Campos com \nAngulos de 0 a 90.\\n\"); \n \n  for (i = 0 ; i&lt;= 90 ; i++) \n  { \n   fprintf(arqpot,\"%d; \",i); \n \n   fprintf(arqpot,\"%.4e; \n\",guarda_cpo[i][0]/(NUM_MAX_ITERACAO-100)); \n \n   fprintf(arqpot,\"%.4e; \",guarda_cpo[i][1]); \n \n   fprintf(arqpot,\"%.4e; \n\",guarda_cpo[i][2]/(NUM_MAX_ITERACAO-100)); \n \n   fprintf(arqpot,\"\\n\"); \n  } \n  fclose(arqpot); \n } \n \n // GRAVANDO ARQUIVOS FINAIS \n \n if (GRAVA_FRAME_SAR) \n  fprintf(stdout, \"Gravando SAR FINAL com %lg segundos de \nsimulacao.\\n\",TempoAtualSimulado); \n if (GRAVA_FRAME_E) \n  fprintf(stdout, \"Gravando |E| FINAL com %lg segundos de \nsimulacao.\\n\",TempoAtualSimulado); \n if (GRAVA_ANTENA) \n  fprintf(stdout, \"Gravando ANTENA FINAL com %lg segundos de \nsimulacao.\\n\",TempoAtualSimulado); \n \n fflush(stdout); \n\n \n\n\n\nAnexos 76\n\n \n if (GRAVA_ANTENA) \n { \n  ctagrav = 0; \n \n  if (GRAVA_SAG) \n  { \n   // GRAVA TODAS AS IMAGENS SAGITAIS \n/*   for( k = TAM_BORDAZ+TAM_AR1 ; k &lt;\nTAM_BORDAZ+TAM_AR1+TAM_ANTENA ; k ++ ) \n   { \n    ctagrav++; \n    grava_cpo_sag(99,ctagrav,k,0); \n   }*/ \n \n   // GRAVA AS IMAGENS SAGITAIS SELECIONADAS \n   grava_cpo_sag(99,1,TAM_BORDAZ+TAM_AR1-100,0); \n   grava_cpo_sag(99,2,TAM_BORDAZ+TAM_AR1-50,0); \n   grava_cpo_sag(99,3,TAM_BORDAZ+TAM_AR1-25,0); \n   grava_cpo_sag(99,4,TAM_BORDAZ+TAM_AR1,0); \n   grava_cpo_sag(99,5,TAM_BORDAZ+TAM_AR1+2,0); \n   grava_cpo_sag(99,6,TAM_BORDAZ+TAM_AR1+10,0); \n   grava_cpo_sag(99,7,TAM_BORDAZ+TAM_AR1+35,0); \n  } \n \n  ctagrav = 0; \n  gravaby = 0; \n \n  if (GRAVA_BORDA) \n   gravaby = TAM_BORDAY; \n \n  if (GRAVA_FRO) \n  { \n   // GRAVA AS IMAGENS FRONTAIS \n   for( i = TAM_BORDAY-gravaby ; i &lt;nx+TAM_BORDAY+gravaby ; \ni++) \n   { \n    ctagrav++; \n   \n grava_cpo_fro(99,ctagrav,i,TAM_BORDAZ+TAM_AR1,TAM_BORDAZ+TAM_AR1+TAM_\nANTENA,0); \n   } \n  } \n \n  ctagrav = 0; \n  gravabx = 0; \n \n  if (GRAVA_BORDA) \n   gravabx = TAM_BORDAX; \n \n  if (GRAVA_COR) \n  { \n   // GRAVA TODAS AS IMAGENS CORONAIS \n/*   for( j = TAM_BORDAX-gravabx ; j &lt;ny+TAM_BORDAX+gravabx ; \nj++) \n   { \n    ctagrav++; \n   \n grava_cpo_cor(99,ctagrav,j,TAM_BORDAZ+TAM_AR1,TAM_BORDAZ+TAM_AR1+TAM_\nANTENA,0); \n   }*/ \n\n \n\n\n\nAnexos 77\n\n \n   // GRAVA AS IMAGENS CORONAIS SELECIONADAS \n   grava_cpo_cor(99,1,TAM_BORDAX+28,TAM_BORDAZ,nz-\nTAM_BORDAZ,0); \n   grava_cpo_cor(99,2,TAM_BORDAX+98,TAM_BORDAZ,nz-\nTAM_BORDAZ,0); \n   grava_cpo_cor(99,3,TAM_BORDAX+128,TAM_BORDAZ,nz-\nTAM_BORDAZ,0); \n   grava_cpo_cor(99,4,TAM_BORDAX+128+8,TAM_BORDAZ,nz-\nTAM_BORDAZ,0); \n   grava_cpo_cor(99,5,TAM_BORDAX+128+16,TAM_BORDAZ,nz-\nTAM_BORDAZ,0); \n  } \n } \n \n ctagrav = 0; \n \n // GRAVA AS IMAGENS SAGITAIS \n for( k = TAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2 ; k &lt;\nTAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2+TAM_DA_CAB ; k ++ ) \n { \n  ctagrav++; \n  if (QUAL_MATERIAL) \n  { \n   // GRAVA A SAR DA CABECA \n   if (GRAVA_FRAME_SAR &amp;&amp; GRAVA_SAG) \n    grava_sar_sag(99,ctagrav,k,NUM_MAX_ITERACAO); \n  } \n  // GRAVA O MODULO DO CAMPO ELETROMAGNETICO \n  if (GRAVA_FRAME_E &amp;&amp; GRAVA_SAG) \n   grava_cpo_sag(99,ctagrav,k,1); \n } \n \n ctagrav = 0; \n gravaby = 0; \n \n if (GRAVA_BORDA) \n  gravaby = TAM_BORDAY; \n \n // GRAVA AS IMAGENS FRONTAIS \n// for( i = TAM_BORDAY-gravaby ; i &lt;nx+TAM_BORDAY+gravaby ; i++) \n for( i = 18 ; i &lt;19 ; i++) // debug \n { \n  ctagrav++; \n  if (QUAL_MATERIAL) \n  { \n   // GRAVA A SAR DA CABECA \n   if (GRAVA_FRAME_SAR &amp;&amp; GRAVA_FRO) \n   \n grava_sar_fro(99,ctagrav,NUM_MAX_ITERACAO,i,TAM_BORDAZ+TAM_AR1+TAM_AN\nTENA+TAM_AR2,TAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2+TAM_DA_CAB); \n  } \n  // GRAVA O MODULO DO CAMPO ELETROMAGNETICO \n  if (GRAVA_FRAME_E &amp;&amp; GRAVA_FRO) \n  \n grava_cpo_fro(99,ctagrav,i,TAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2,TAM_\nBORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2+TAM_DA_CAB,1); \n } \n \n ctagrav = 0; \n gravabx = 0; \n\n \n\n\n\nAnexos 78\n\n \n if (GRAVA_BORDA) \n  gravabx = TAM_BORDAX; \n \n // GRAVA AS IMAGENS CORONAIS \n// for( j = TAM_BORDAX-gravabx ; j &lt;ny+TAM_BORDAX+gravabx ; j++) \n for( j = 13 ; j &lt;14 ; j++) // debug \n { \n  ctagrav++; \n  if (QUAL_MATERIAL) \n  { \n   // GRAVA A SAR DA CABECA \n   if (GRAVA_FRAME_SAR || GRAVA_COR) \n   \n grava_sar_cor(99,ctagrav,NUM_MAX_ITERACAO,j,TAM_BORDAZ+TAM_AR1+TAM_AN\nTENA+TAM_AR2,TAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2+TAM_DA_CAB); \n  } \n  // GRAVA O MODULO DO CAMPO ELETROMAGNETICO \n//  if (GRAVA_FRAME_E &amp;&amp; GRAVA_COR) \n//debug  \n grava_cpo_cor(99,ctagrav,j,TAM_BORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2,TAM_\nBORDAZ+TAM_AR1+TAM_ANTENA+TAM_AR2+TAM_DA_CAB,1); \n } \n \n // RELATORIOS \n \n grava_rel_sar(dx,dy,dz,dt,cpopele,cpomusc,cpoosso,cpoolho,cpocereb,cp\noar,bytesalocados, \n       \nnro_cel_borda,log_g,berenger_g,sigma_zero,nmax,atingiu_borda,degringolou, \n       \nm_int_pto1,m_int_pto2,m_val_pto1,m_val_pto2); \n \n \n // AVISOS FINAIS \n \n time2=time(NULL); \n \n fprintf(stdout, \"\\n\"); \n fprintf(stdout, \"SIMULACAO CONCLUIDA!!\\n\"); \n fprintf(stdout, \"\\n\"); \n fprintf(stdout, \"Tempo Total Simulado = %lg segundos em %d \ninteracoes\\n\",TempoTotalSimulado,interacao); \n fprintf(stdout, \"\\n\"); \n diff_time = difftime(time2,time1); \n fprintf(stdout, \"Tempo Total = %lg segundos\\n\",diff_time); \n fprintf(stdout, \"Feito com %lg interacoes por \nsegundo\\n\",(double)diff_time/(double)interacao); \n fprintf(stdout, \"\\n\"); \n fflush(stdout); \n \n} \n \n/**************************************************************************\n********************** \n**                                                                                   \n** \n** ROTINAS PARA P PROGRAMA PRINCIPAL                                                 \n** \n**                                                                                   \n** \n\n \n\n\n\nAnexos 79\n\n***************************************************************************\n*********************/ \n \n \n/************************************************************************ \n* \n*   FUNCAO:  Gera_bordaz() \n* \n*   RECEBE:  Numero do Corte \n*   RETORNA: NULL \n*   FUNCAO:  Criar uma tela de AR com borda absorvedora \n*  OBS:     Nesta funcao, i=linha e j=coluna \n* \n**************************************************************************/ \nvoid Gera_bordaz(int k) \n{ \n int i,j,contai; \n \n contai=0; \n \n // IMPLEMENTA A BORDA SUPERIOR \n for(i = 0 ; i &lt;TAM_BORDAX ; i++) \n { \n  for(j = 0 ; j &lt;nx+2*TAM_BORDAY ; j++) \n  { \n   if (j<TAM_BORDAY || j>=nx+TAM_BORDAY) \n   { \n    cab[j][contai][k] = CANTO; \n   } \n   else \n   { \n    cab[j][contai][k] = BORDAX; \n   } \n  } \n  contai++; \n } \n \n // IMPLEMENTA A BORDA Z \n for(i = 0 ; i &lt;ny ; i++) \n { \n  for(j = 0 ; j &lt;nx+2*TAM_BORDAY ; j++) \n  { \n   if (j<TAM_BORDAY || j>=nx+TAM_BORDAY) \n   { \n    cab[j][contai][k] = BORDAY; \n   } \n   else \n   { \n    cab[j][contai][k] = BORDAZ; \n   } \n  } \n  contai++; \n } \n \n // IMPLEMENTA A BORDA INFERIOR \n for(i = 0 ; i &lt;TAM_BORDAX ; i++) \n { \n  for(j = 0 ; j &lt;nx+2*TAM_BORDAY ; j++) \n  { \n   if (j<TAM_BORDAY || j>=nx+TAM_BORDAY) \n   { \n\n \n\n\n\nAnexos 80\n\n    cab[j][contai][k] = CANTO; \n   } \n   else \n   { \n    cab[j][contai][k] = BORDAX; \n   } \n  } \n  contai++; \n } \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  Gera_matriz_ar() \n* \n*   RECEBE:  Numero do Corte \n*   RETORNA: NULL \n*   FUNCAO:  Criar uma tela de AR com borda absorvedora \n*  OBS:     Nesta funcao, i=linha e j=coluna \n* \n**************************************************************************/ \nvoid Gera_matriz_ar(int k) \n{ \n int i,j,contai=0; \n \n // IMPLEMENTA A BORDA SUPERIOR \n for(i = 0 ; i &lt;TAM_BORDAX ; i++) \n { \n  for(j = 0 ; j &lt;nx+2*TAM_BORDAY ; j++) \n  { \n   if (j<TAM_BORDAY || j>=nx+TAM_BORDAY) \n   { \n    cab[j][contai][k] = CANTO; \n   } \n   else \n   { \n    cab[j][contai][k] = BORDAX; \n   } \n  } \n  contai++; \n } \n \n // IMPLEMENTA O AR \n for(i = 0 ; i &lt;ny ; i++) \n { \n  for(j = 0 ; j &lt;nx+2*TAM_BORDAY ; j++) \n  { \n   if (j<TAM_BORDAY || j>=nx+TAM_BORDAY) \n   { \n    cab[j][contai][k] = BORDAY; \n   } \n   else \n   { \n    cab[j][contai][k] = 0; \n   } \n  } \n  contai++; \n } \n \n // IMPLEMENTA A BORDA INFERIOR \n for(i = 0 ; i &lt;TAM_BORDAX ; i++) \n\n \n\n\n\nAnexos 81\n\n { \n  for(j = 0 ; j &lt;nx+2*TAM_BORDAY ; j++) \n  { \n   if (j<TAM_BORDAY || j>=nx+TAM_BORDAY) \n   { \n    cab[j][contai][k] = CANTO; \n   } \n   else \n   { \n    cab[j][contai][k] = BORDAX; \n   } \n  } \n  contai++; \n } \n \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  Gera_antena1() \n* \n*   RECEBE:  Numero do Corte \n*   RETORNA: NULL \n*   FUNCAO:  Passar a antena do arquivo .fd para uma matriz \n*  OBS:     Nesta funcao, i=linha e j=coluna \n* \n**************************************************************************/ \nvoid Gera_antena1(int k, int contant) \n{ \n \n char tmp[10], filename[15]; \n int i,j,contai,num,soma_ai; \n \n FILE *fp; \n \n sprintf(filename,\"/u/fdtdeb/teste/monop%d.fd\",contant); \n fp=fopen(filename,\"r\"); \n \n if(!fp) \n { \n   printf(\"\\nNao consigo abrir o arquivo %s\",tmp); \n   fflush(stdout); \n   exit(0); \n } \n \n fgets(tmp,10,fp); \n num = atoi(tmp); \n fgets(tmp,10,fp); \n num = atoi(tmp); \n \n contai=0; \n \n // IMPLEMENTA A BORDA SUPERIOR \n for(i = 0 ; i &lt;TAM_BORDAX ; i++) \n { \n  for(j = 0 ; j &lt;nx+2*TAM_BORDAY ; j++) \n  { \n   if (j<TAM_BORDAY || j>=nx+TAM_BORDAY) \n    cab[j][contai][k] = CANTO; \n   else \n    cab[j][contai][k] = BORDAX; \n\n \n\n\n\nAnexos 82\n\n  } \n  contai++; \n } \n \n contai=contai+ny-1; \n \n j = 0; \n \n do \n { \n \n  // IMPLEMENTA A BORDA A ESQUERDA \n  if (j == 0) \n  { \n \n   if  (contai == TAM_BORDAX-1) \n    break; \n \n   for ( j = 0 ; j<TAM_BORDAY ; j++ ) \n    cab[j][contai][k] = BORDAY; \n  } \n \n  fgets(tmp,10,fp); \n  num = atoi(tmp); \n \n  if( num == -1 ) \n  { \n \n   if  (contai == TAM_BORDAX-1) \n    break; \n \n   // IMPLEMENTA A BORDA A DIREITA \n   for ( soma_ai = 0 ; soma_ai<TAM_BORDAY ; soma_ai++ ) \n    cab[j++][contai][k] = BORDAY; \n \n   contai--; \n   j = 0; \n \n  } \n  else \n  // PEGA VALORES DO ARQUIVO \n  { \n   cab[j][contai][k] = num; \n   j++; \n  } \n \n } while(  !feof(fp) ); \n \n contai=contai+ny+1; // Soma +2 pois no fim do .FD tem um (-1) \n \n // IMPLEMENTA A BORDA INFERIOR \n for(i = 0 ; i &lt;TAM_BORDAX ; i++) \n { \n  for(j = 0 ; j &lt;nx+2*TAM_BORDAY ; j++) \n  { \n   if (j<TAM_BORDAY || j>=nx+TAM_BORDAY) \n    cab[j][contai][k] = CANTO; \n   else \n    cab[j][contai][k] = BORDAX; \n  } \n  contai++; \n\n \n\n\n\nAnexos 83\n\n } \n fclose(fp); \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  faz_calc_hx() \n* \n*   RECEBE:  Corte Inicial, Corte Final e Parametros Espaciais \n*   RETORNA: NULL \n*   FUNCAO:  Calcula e Atualiza os Campos Hx para as Telas da Antena \n*   OBS: \n* \n**************************************************************************/ \nvoid faz_calc_hx(double dy, double dz, double dt, double berenger_g, double \nsigma_zero, \n       double nro_iterac, double *atingiu_borda, \ndouble *degringolou) \n{ \n int i,j,k,aux,dist_by,dist_bz; \n \n double mu,sigy,sigz,sigmy,sigmz,Day,Daz,Dby,Dbz; \n \n // ATUALIZANDO OS CAMPOS H \n #ifdef _CRAYC \n  #pragma _CRI ivdep \n  #pragma _CRI concurrent \n #endif \n for(i=0; i<(nx+2*TAM_BORDAY); i++) \n { \n  for(j=0; j<(ny+2*TAM_BORDAX-1); j++) \n  { \n   for(k=0; k<nz-1; k++) \n   { \n    aux = cab[i][j][k]; \n \n    mu = material[aux][MU]; \n \n    if (j>=TAM_BORDAX &amp;&amp; j<ny+TAM_BORDAX &amp;&amp; \ni>=TAM_BORDAY &amp;&amp; i<nx+TAM_BORDAY &amp;&amp; \n      k>=TAM_BORDAZ &amp;&amp; k<nz+TAM_BORDAZ) \n    { \n     sigmy = material[aux][MAGSIGY]; \n     sigmz = material[aux][MAGSIGZ]; \n    } \n    else \n    { \n     // IMPLEMENTA A BORDA BERENGER \n     if (i<TAM_BORDAY) \n      dist_by = TAM_BORDAY-i; \n     else if (i>=nx+TAM_BORDAY) \n      dist_by = i-TAM_BORDAY-nx; \n \n     if (k<TAM_BORDAZ) \n      dist_bz = TAM_BORDAZ-k; \n     else if (k>=nz+TAM_BORDAZ) \n      dist_bz = k-TAM_BORDAZ-nz; \n \n     sigy = \nsigma_zero*pow(pow(berenger_g,1/TAM_BORDAY),dist_by); \n\n \n\n\n\nAnexos 84\n\n     sigz = \nsigma_zero*pow(pow(berenger_g,1/TAM_BORDAZ),dist_bz); \n \n     sigmy = sigy*MU_0/EPS_0; \n     sigmz = sigz*MU_0/EPS_0; \n    } \n \n    Day = (UM - (sigmy*dt)/(DOIS*mu))/(UM + \n(sigmy*dt)/(DOIS*mu)); \n    Dby = (dt/mu) / (UM + (sigmy*dt)/(DOIS*mu)); \n \n    Daz = (UM - (sigmz*dt)/(DOIS*mu))/(UM + \n(sigmz*dt)/(DOIS*mu)); \n    Dbz = (dt/mu) / (UM + (sigmz*dt)/(DOIS*mu)); \n \n    hx[i][j][k] = ((Daz+Day)/DOIS)*hx[i][j][k] + \n(Dbz*(ey[i][j][k+1] - ey[i][j][k])/dz \n        - Dby*(ez[i][j+1][k] - \nez[i][j][k])/dy ); \n \n    if (*atingiu_borda == 0) \n    { \n     if (cab[i][j][k] == BORDAX || cab[i][j][k] == \nBORDAY || cab[i][j][k] == BORDAZ || \n       cab[i][j][k] == CANTO) \n     { \n      if (hx[i][j][k] != 0) \n       *atingiu_borda = nro_iterac; \n     } \n    } \n \n    if (*degringolou == 0) \n     if (hx[i][j][k] > 0 || cab[i][j][k] != \nEXCITACAO) \n      *degringolou = nro_iterac; \n \n/*    if (cab[i][j][k] == TERRA) \n    { \n     hx[i][j][k] = 0.0; \n     hy[i][j][k] = 0.0; \n     hz[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOX) \n    { \n     hy[i][j][k] = 0.0; \n     hz[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOY) \n    { \n     hx[i][j][k] = 0.0; \n     hz[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOZ) \n    { \n\n \n\n\n\nAnexos 85\n\n     hx[i][j][k] = 0.0; \n     hy[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOSXZ) \n    { \n     hy[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOSXY) \n    { \n     hz[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOSYZ) \n    { \n     hx[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n    }*/ \n   } \n  } \n } \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  faz_calc_hy() \n* \n*   RECEBE:  Corte Inicial, Corte Final e Parametros Espaciais \n*   RETORNA: NULL \n*   FUNCAO:  Calcula e Atualiza os Campos Hy para as Telas da Antena \n*   OBS: \n* \n**************************************************************************/ \nvoid faz_calc_hy(double dx, double dz, double dt, double berenger_g, double \nsigma_zero, \n       double nro_iterac, double *atingiu_borda, \ndouble *degringolou) \n{ \n int i,j,k,aux,dist_bx,dist_bz; \n \n double mu,sigx,sigz,sigmx,sigmz,Dax,Daz,Dbx,Dbz; \n \n #ifdef _CRAYC \n  #pragma _CRI ivdep \n  #pragma _CRI concurrent \n #endif \n for(i=0; i<(nx+2*TAM_BORDAY-1); i++) \n { \n  for(j=0; j<(ny+2*TAM_BORDAX); j++) \n  { \n   for(k=0; k<nz-1; k++) \n   { \n    aux = cab[i][j][k]; \n \n    mu = material[aux][MU]; \n \n    if (j>=TAM_BORDAX &amp;&amp; j<ny+TAM_BORDAX &amp;&amp; \ni>=TAM_BORDAY &amp;&amp; i<nx+TAM_BORDAY &amp;&amp; \n      k>=TAM_BORDAZ &amp;&amp; k<nz+TAM_BORDAZ) \n\n \n\n\n\nAnexos 86\n\n    { \n     sigmx = material[aux][MAGSIGX]; \n     sigmz = material[aux][MAGSIGZ]; \n    } \n    else \n    { \n     // IMPLEMENTA A BORDA BERENGER \n     if (j<TAM_BORDAX) \n      dist_bx = TAM_BORDAX-j; \n     else if (j>=ny+TAM_BORDAX) \n      dist_bx = j-TAM_BORDAX-ny; \n \n     if (k<TAM_BORDAZ) \n      dist_bz = TAM_BORDAZ-k; \n     else if (k>=nz+TAM_BORDAZ) \n      dist_bz = k-TAM_BORDAZ-nz; \n \n     sigx = \nsigma_zero*pow(pow(berenger_g,1/TAM_BORDAX),dist_bx); \n     sigz = \nsigma_zero*pow(pow(berenger_g,1/TAM_BORDAZ),dist_bz); \n \n     sigmx = sigx*MU_0/EPS_0; \n     sigmz = sigz*MU_0/EPS_0; \n    } \n \n    Dax = (UM - (sigmx*dt)/(DOIS*mu))/(UM + \n(sigmx*dt)/(DOIS*mu)); \n    Dbx = (dt/mu) / (UM + (sigmx*dt)/(DOIS*mu)); \n \n    Daz = (UM - (sigmz*dt)/(DOIS*mu))/(UM + \n(sigmz*dt)/(DOIS*mu)); \n    Dbz = (dt/mu) / (UM + (sigmz*dt)/(DOIS*mu)); \n \n    hy[i][j][k] = ((Dax+Daz)/DOIS)*hy[i][j][k] + ( \nDbx*(ez[i+1][j][k]- ez[i][j][k])/dx \n        - Dbz*(ex[i][j][k+1] - \nex[i][j][k])/dz ); \n \n    if (*atingiu_borda == 0) \n    { \n     if (cab[i][j][k] == BORDAX || cab[i][j][k] == \nBORDAY || cab[i][j][k] == BORDAZ || \n       cab[i][j][k] == CANTO) \n     { \n      if (hy[i][j][k] != 0) \n       *atingiu_borda = nro_iterac; \n     } \n    } \n \n    if (*degringolou == 0) \n     if (hy[i][j][k] > 0 || cab[i][j][k] != \nEXCITACAO) \n      *degringolou = nro_iterac; \n \n/*    if (cab[i][j][k] == TERRA) \n    { \n     hx[i][j][k] = 0.0; \n     hy[i][j][k] = 0.0; \n     hz[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n\n \n\n\n\nAnexos 87\n\n     ey[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOX) \n    { \n     hy[i][j][k] = 0.0; \n     hz[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOY) \n    { \n     hx[i][j][k] = 0.0; \n     hz[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOZ) \n    { \n     hx[i][j][k] = 0.0; \n     hy[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOSXZ) \n    { \n     hy[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOSXY) \n    { \n     hz[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOSYZ) \n    { \n     hx[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n    }*/ \n   } \n  } \n } \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  faz_calc_hz() \n* \n*   RECEBE:  Corte Inicial, Corte Final e Parametros Espaciais \n*   RETORNA: NULL \n*   FUNCAO:  Calcula e Atualiza os Campos Hz para as Telas da Antena \n*   OBS: \n* \n**************************************************************************/ \nvoid faz_calc_hz(double dy, double dx, double dt, double berenger_g, double \nsigma_zero, \n       double nro_iterac, double *atingiu_borda, \ndouble *degringolou) \n{ \n int i,j,k,aux,dist_bx,dist_by; \n \n\n \n\n\n\nAnexos 88\n\n double mu,sigx,sigy,sigmx,sigmy,Dax,Day,Dbx,Dby; \n \n #ifdef _CRAYC \n  #pragma _CRI ivdep \n  #pragma _CRI concurrent \n #endif \n for(i=0; i<(nx+2*TAM_BORDAY-1); i++) \n { \n  for(j=0; j<(ny+2*TAM_BORDAX-1); j++) \n  { \n   for(k=0; k<nz; k++) \n   { \n    aux = cab[i][j][k]; \n \n    mu = material[aux][MU]; \n \n    if (j>=TAM_BORDAX &amp;&amp; j<ny+TAM_BORDAX &amp;&amp; \ni>=TAM_BORDAY &amp;&amp; i<nx+TAM_BORDAY &amp;&amp; \n      k>=TAM_BORDAZ &amp;&amp; k<nz+TAM_BORDAZ) \n    { \n     sigmx = material[aux][MAGSIGX]; \n     sigmy = material[aux][MAGSIGY]; \n    } \n    else \n    { \n     // IMPLEMENTA A BORDA BERENGER \n     if (j<TAM_BORDAX) \n      dist_bx = TAM_BORDAX-j; \n     else if (j>=ny+TAM_BORDAX) \n      dist_bx = j-TAM_BORDAX-ny; \n \n     if (i<TAM_BORDAY) \n      dist_by = TAM_BORDAY-i; \n     else if (i>=nx+TAM_BORDAY) \n      dist_by = i-TAM_BORDAY-nx; \n \n     sigx = \nsigma_zero*pow(pow(berenger_g,1/TAM_BORDAX),dist_bx); \n     sigy = \nsigma_zero*pow(pow(berenger_g,1/TAM_BORDAY),dist_by); \n \n     sigmx = sigx*MU_0/EPS_0; \n     sigmy = sigy*MU_0/EPS_0; \n    } \n \n    Dax = (UM - (sigmx*dt)/(DOIS*mu))/(UM + \n(sigmx*dt)/(DOIS*mu)); \n    Dbx = (dt/mu) / (UM + (sigmx*dt)/(DOIS*mu)); \n \n    Day = (UM - (sigmy*dt)/(DOIS*mu))/(UM + \n(sigmy*dt)/(DOIS*mu)); \n    Dby = (dt/mu) / (UM + (sigmy*dt)/(DOIS*mu)); \n \n    hz[i][j][k] = ((Dax+Day)/DOIS)*hz[i][j][k] + ( \nDby*(ex[i][j+1][k] \n          - ex[i][j][k])/dy - \nDbx*(ey[i+1][j][k] - ey[i][j][k])/dx ); \n \n    if (*atingiu_borda == 0) \n    { \n\n \n\n\n\nAnexos 89\n\n     if (cab[i][j][k] == BORDAX || cab[i][j][k] == \nBORDAY || cab[i][j][k] == BORDAZ || \n       cab[i][j][k] == CANTO) \n     { \n      if (hz[i][j][k] != 0) \n       *atingiu_borda = nro_iterac; \n     } \n    } \n \n    if (*degringolou == 0) \n     if (hz[i][j][k] > 0 || cab[i][j][k] != \nEXCITACAO) \n      *degringolou = nro_iterac; \n \n/*    if (cab[i][j][k] == TERRA) \n    { \n     hx[i][j][k] = 0.0; \n     hy[i][j][k] = 0.0; \n     hz[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOX) \n    { \n     hy[i][j][k] = 0.0; \n     hz[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOY) \n    { \n     hx[i][j][k] = 0.0; \n     hz[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOZ) \n    { \n     hx[i][j][k] = 0.0; \n     hy[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOSXZ) \n    { \n     hy[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOSXY) \n    { \n     hz[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOSYZ) \n    { \n     hx[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n    }*/ \n   } \n  } \n\n \n\n\n\nAnexos 90\n\n } \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  faz_calc_ex() \n* \n*   RECEBE:  Corte Inicial, Corte Final e Parametros Espaciais \n*   RETORNA: NULL \n*   FUNCAO:  Calcula e Atualiza os Campos Ex para as Telas da Antena \n*   OBS: \n* \n**************************************************************************/ \nvoid faz_calc_ex(double dy, double dz, double dt, double berenger_g, double \nsigma_zero, \n       double nro_iterac, double *atingiu_borda, \ndouble *degringolou) \n{ \n int i,j,k,aux,dist_by,dist_bz; \n \n double sigy,sigz,Cay,Caz,Cby,Cbz,eps; \n \n #ifdef _CRAYC \n  #pragma _CRI ivdep \n  #pragma _CRI concurrent \n #endif \n for(i=0; i<(nx+2*TAM_BORDAY); i++) \n { \n  for(j=1; j<(ny+2*TAM_BORDAX); j++) \n  { \n   for(k=1; k<nz; k++) \n   { \n    aux = cab[i][j][k]; \n \n    eps = material[aux][EPS]; \n \n    if (j>=TAM_BORDAX &amp;&amp; j<ny+TAM_BORDAX &amp;&amp; \ni>=TAM_BORDAY &amp;&amp; i<nx+TAM_BORDAY &amp;&amp; \n      k>=TAM_BORDAZ &amp;&amp; k<nz+TAM_BORDAZ) \n    { \n     sigy = material[aux][SIGY]; \n     sigz = material[aux][SIGZ]; \n    } \n    else \n    { \n     // IMPLEMENTA A BORDA BERENGER \n     if (i<TAM_BORDAY) \n      dist_by = TAM_BORDAY-i; \n     else if (i>=nx+TAM_BORDAY) \n      dist_by = i-TAM_BORDAY-nx; \n \n     if (k<TAM_BORDAZ) \n      dist_bz = TAM_BORDAZ-k; \n     else if (k>=nz+TAM_BORDAZ) \n      dist_bz = k-TAM_BORDAZ-nz; \n \n     sigy = \nsigma_zero*pow(pow(berenger_g,1/TAM_BORDAY),dist_by); \n     sigz = \nsigma_zero*pow(pow(berenger_g,1/TAM_BORDAZ),dist_bz); \n    } \n\n \n\n\n\nAnexos 91\n\n \n    Cay = (UM - (sigy*dt)/(DOIS*eps)) / (UM + \n(sigy*dt)/(DOIS*eps)); \n    Cby = (dt/eps) / (UM + (sigy*dt)/(DOIS*eps)); \n \n    Caz = (UM - (sigz*dt)/(DOIS*eps)) / (UM + \n(sigz*dt)/(DOIS*eps)); \n    Cbz = (dt/eps) / (UM + (sigz*dt)/(DOIS*eps)); \n \n    if (cab[i][j][k] == TERRA || cab[i][j][k] == \nCAMPOSXZ || cab[i][j][k] == TODCAMPOS) \n    { \n     Cay = -1; \n     Caz = -1; \n     Cby = 0; \n     Cbz = 0; \n    } \n \n    ex[i][j][k] = ((Caz + Cay)/DOIS)*ex[i][j][k] + ( \nCby*(hz[i][j][k] \n          - hz[i][j-1][k])/dy - \nCbz*(hy[i][j][k] - hy[i][j][k-1])/dz); \n \n    if (*atingiu_borda == 0) \n    { \n     if (cab[i][j][k] == BORDAX || cab[i][j][k] == \nBORDAY || cab[i][j][k] == BORDAZ || \n       cab[i][j][k] == CANTO) \n     { \n      if (ex[i][j][k] != 0) \n       *atingiu_borda = nro_iterac; \n     } \n    } \n \n    if (*degringolou == 0) \n     if (ex[i][j][k] > 0 || cab[i][j][k] != \nEXCITACAO) \n      *degringolou = nro_iterac; \n \n/*    if (cab[i][j][k] == TERRA) \n    { \n     hx[i][j][k] = 0.0; \n     hy[i][j][k] = 0.0; \n     hz[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOX) \n    { \n     hy[i][j][k] = 0.0; \n     hz[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOY) \n    { \n     hx[i][j][k] = 0.0; \n     hz[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n\n \n\n\n\nAnexos 92\n\n    } \n    else if (cab[i][j][k] == CAMPOZ) \n    { \n     hx[i][j][k] = 0.0; \n     hy[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOSXZ) \n    { \n     hy[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOSXY) \n    { \n     hz[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOSYZ) \n    { \n     hx[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n    }*/ \n   } \n  } \n } \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  faz_calc_ey() \n* \n*   RECEBE:  Corte Inicial, Corte Final e Parametros Espaciais \n*   RETORNA: NULL \n*   FUNCAO:  Calcula e Atualiza os Campos Ey para as Telas da Antena \n*   OBS: \n* \n**************************************************************************/ \nvoid faz_calc_ey(double dx, double dz, double dt, double berenger_g, double \nsigma_zero, \n       double nro_iterac, double *atingiu_borda, \ndouble *degringolou) \n{ \n int i,j,k,aux,dist_bx,dist_bz; \n \n double sigx,sigz,Cax,Caz,Cbx,Cbz,eps; \n \n #ifdef _CRAYC \n  #pragma _CRI ivdep \n  #pragma _CRI concurrent \n #endif \n for(i=1; i<(nx+2*TAM_BORDAY); i++) \n { \n  for(j=0; j<(ny+2*TAM_BORDAX); j++) \n  { \n   for(k=1; k<nz; k++) \n   { \n    aux = cab[i][j][k]; \n \n    eps = material[aux][EPS]; \n \n\n \n\n\n\nAnexos 93\n\n    if (j>=TAM_BORDAX &amp;&amp; j<ny+TAM_BORDAX &amp;&amp; \ni>=TAM_BORDAY &amp;&amp; i<nx+TAM_BORDAY &amp;&amp; \n      k>=TAM_BORDAZ &amp;&amp; k<nz+TAM_BORDAZ) \n    { \n     sigx = material[aux][SIGX]; \n     sigz = material[aux][SIGZ]; \n    } \n    else \n    { \n     // IMPLEMENTA A BORDA BERENGER \n     if (j<TAM_BORDAX) \n      dist_bx = TAM_BORDAX-j; \n     else if (j>=ny+TAM_BORDAX) \n      dist_bx = j-TAM_BORDAX-ny; \n \n     if (k<TAM_BORDAZ) \n      dist_bz = TAM_BORDAZ-k; \n     else if (k>=nz+TAM_BORDAZ) \n      dist_bz = k-TAM_BORDAZ-nz; \n \n     sigx = \nsigma_zero*pow(pow(berenger_g,1/TAM_BORDAX),dist_bx); \n     sigz = \nsigma_zero*pow(pow(berenger_g,1/TAM_BORDAZ),dist_bz); \n    } \n \n    Cax = (UM - (sigx*dt)/(DOIS*eps)) / (UM + \n(sigx*dt)/(DOIS*eps)); \n    Cbx = (dt/eps) / (UM + (sigx*dt)/(DOIS*eps)); \n \n    Caz = (UM - (sigz*dt)/(DOIS*eps)) / (UM + \n(sigz*dt)/(DOIS*eps)); \n    Cbz = (dt/eps) / (UM + (sigz*dt)/(DOIS*eps)); \n \n    if (cab[i][j][k] == TERRA || cab[i][j][k] == \nCAMPOSXZ || cab[i][j][k] == TODCAMPOS) \n    { \n     Cax = -1; \n     Caz = -1; \n     Cbx = 0; \n     Cbz = 0; \n    } \n \n    ey[i][j][k] = ((Cax + Caz)/DOIS)*ey[i][j][k] + ( \nCbz*(hx[i][j][k] \n          - hx[i][j][k-1])/dz - \nCbx*(hz[i][j][k] - hz[i-1][j][k])/dx); \n \n    if (*atingiu_borda == 0) \n    { \n     if (cab[i][j][k] == BORDAX || cab[i][j][k] == \nBORDAY || cab[i][j][k] == BORDAZ || \n       cab[i][j][k] == CANTO) \n     { \n      if (ey[i][j][k] != 0) \n       *atingiu_borda = nro_iterac; \n     } \n    } \n \n    if (*degringolou == 0) \n\n \n\n\n\nAnexos 94\n\n     if (ey[i][j][k] > 0 || cab[i][j][k] != \nEXCITACAO) \n      *degringolou = nro_iterac; \n \n/*    if (cab[i][j][k] == TERRA) \n    { \n     hx[i][j][k] = 0.0; \n     hy[i][j][k] = 0.0; \n     hz[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOX) \n    { \n     hy[i][j][k] = 0.0; \n     hz[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOY) \n    { \n     hx[i][j][k] = 0.0; \n     hz[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOZ) \n    { \n     hx[i][j][k] = 0.0; \n     hy[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOSXZ) \n    { \n     hy[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOSXY) \n    { \n     hz[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOSYZ) \n    { \n     hx[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n    }*/ \n   } \n  } \n } \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  faz_calc_ez() \n* \n*   RECEBE:  Corte Inicial, Corte Final e Parametros Espaciais \n*   RETORNA: NULL \n*   FUNCAO:  Calcula e Atualiza os Campos Ez para as Telas da Antena \n\n \n\n\n\nAnexos 95\n\n*   OBS: \n* \n**************************************************************************/ \nvoid faz_calc_ez(double dx, double dy, double dz, double dt, double \n*cpopele, double *cpomusc, \n       double *cpoosso, double *cpoolho, double \n*cpocereb, double *cpoar, \n       double berenger_g, double sigma_zero, double \nnro_iterac, double *atingiu_borda, \n       double *degringolou) \n{ \n int i,j,k,aux,dist_bx,dist_by; \n \n double sigx,sigy,Cax,Cay,Cbx,Cby,modulo_e,cl_sar,eps; \n \n #ifdef _CRAYC \n  #pragma _CRI ivdep \n  #pragma _CRI concurrent \n #endif \n for(i=1; i<(nx+2*TAM_BORDAY); i++) \n { \n  for(j=1; j<(ny+2*TAM_BORDAX); j++) \n  { \n   for(k=0; k<nz; k++) \n   { \n    aux = cab[i][j][k]; \n \n    eps = material[aux][EPS]; \n \n    if (j>=TAM_BORDAX &amp;&amp; j<ny+TAM_BORDAX &amp;&amp; \ni>=TAM_BORDAY &amp;&amp; i<nx+TAM_BORDAY &amp;&amp; \n      k>=TAM_BORDAZ &amp;&amp; k<nz+TAM_BORDAZ) \n    { \n     sigx = material[aux][SIGX]; \n     sigy = material[aux][SIGY]; \n    } \n    else \n    { \n     // IMPLEMENTA A BORDA BERENGER \n     if (j<TAM_BORDAX) \n      dist_bx = TAM_BORDAX-j; \n     else if (j>=ny+TAM_BORDAX) \n      dist_bx = j-TAM_BORDAX-ny; \n \n     if (i<TAM_BORDAY) \n      dist_by = TAM_BORDAY-i; \n     else if (i>=nx+TAM_BORDAY) \n      dist_by = i-TAM_BORDAY-nx; \n \n     sigx = \nsigma_zero*pow(pow(berenger_g,1/TAM_BORDAX),dist_bx); \n     sigy = \nsigma_zero*pow(pow(berenger_g,1/TAM_BORDAY),dist_by); \n    } \n \n    Cax = (UM - (sigx*dt)/(DOIS*eps)) / (UM + \n(sigx*dt)/(DOIS*eps)); \n    Cbx = (dt/eps) / (UM + (sigx*dt)/(DOIS*eps)); \n \n    Cay = (UM - (sigy*dt)/(DOIS*eps)) / (UM + \n(sigy*dt)/(DOIS*eps)); \n\n \n\n\n\nAnexos 96\n\n    Cby = (dt/eps) / (UM + (sigy*dt)/(DOIS*eps)); \n \n    if (cab[i][j][k] == TERRA || cab[i][j][k] == \nCAMPOSXZ || cab[i][j][k] == TODCAMPOS) \n    { \n     Cax = -1; \n     Cay = -1; \n     Cbx = 0; \n     Cby = 0; \n    } \n \n    ez[i][j][k] = ((Cax + Cay)/DOIS)*ez[i][j][k] + ( \nCbx*(hy[i][j][k] \n          - hy[i-1][j][k])/dx - \nCby*(hx[i][j][k] - hx[i][j-1][k])/dy); \n \n    if (*atingiu_borda == 0) \n    { \n     if (cab[i][j][k] == BORDAX || cab[i][j][k] == \nBORDAY || cab[i][j][k] == BORDAZ || \n       cab[i][j][k] == CANTO) \n     { \n      if (ez[i][j][k] != 0) \n       *atingiu_borda = nro_iterac; \n     } \n    } \n \n    if (*degringolou == 0) \n     if (ez[i][j][k] > 0 || cab[i][j][k] != \nEXCITACAO) \n      *degringolou = nro_iterac; \n \n/*    if (cab[i][j][k] == TERRA) \n    { \n     hx[i][j][k] = 0.0; \n     hy[i][j][k] = 0.0; \n     hz[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOX) \n    { \n     hy[i][j][k] = 0.0; \n     hz[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOY) \n    { \n     hx[i][j][k] = 0.0; \n     hz[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOZ) \n    { \n     hx[i][j][k] = 0.0; \n     hy[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n\n \n\n\n\nAnexos 97\n\n    } \n    else if (cab[i][j][k] == CAMPOSXZ) \n    { \n     hy[i][j][k] = 0.0; \n     ey[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOSXY) \n    { \n     hz[i][j][k] = 0.0; \n     ez[i][j][k] = 0.0; \n    } \n    else if (cab[i][j][k] == CAMPOSYZ) \n    { \n     hx[i][j][k] = 0.0; \n     ex[i][j][k] = 0.0; \n    }*/ \n \n    // Calcula o SAR para cada ponto e soma com o \nanterior \n    // material[aux][RO]*dx*dy*dz serve para corrigir um \nfator de volume \n    // *1000 para termos mW/g ou W/Kg por V/m RMS \n    modulo_e = sqrt(ex[i][j][k]*ex[i][j][k] + \ney[i][j][k]*ey[i][j][k] + ez[i][j][k]*ez[i][j][k]); \n    cl_sar = \n(material[aux][SIGX]/(2*material[aux][RO]*dx*dy*dz))*(modulo_e*modulo_e)*10\n00; \n    vsar[i][j][k] = vsar[i][j][k] + cl_sar; \n \n    if (cab[i][j][k] == PELE) \n     *cpopele += modulo_e; \n    else \n    if (cab[i][j][k] == MUSCULO) \n \n     *cpomusc += modulo_e; \n    else if (cab[i][j][k] == OSSO) \n     *cpoosso += modulo_e; \n    else if (cab[i][j][k] == OLHO) \n     *cpoolho += modulo_e; \n    else if (cab[i][j][k] == CEREBRO) \n     *cpocereb += modulo_e; \n    else if (cab[i][j][k] == AR) \n     *cpoar += modulo_e; \n   } \n  } \n } \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  grava_tela_cab() \n* \n*   RECEBE:  Qual tela deve gravar \n*   RETORNA: NULL \n*   FUNCAO:  Grava a tela de um Cab para DEBUG \n*   OBS: \n* \n**************************************************************************/ \nvoid grava_tela_cab(int k) \n{ \n FILE *fp; \n\n \n\n\n\nAnexos 98\n\n char mat[100]; \n int i,j; \n \n sprintf(mat,\"tela%d.txt\",k); \n \n printf(\"Gravando tela da matriz CAB: %s\\n\",mat); \n fp=fopen(mat,\"w+\"); \n \n for(i = 0 ; i &lt;2*TAM_BORDAX+ny ; i++) \n { \n  for(j = 0 ; j &lt;nx+2*TAM_BORDAY ; j++) \n  { \n   fprintf(fp,\"%d \",cab[j][i][k]); \n  } \n  fprintf(fp,\"\\n\"); \n } \n fclose(fp); \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  calcula_memoria_req() \n* \n*   RECEBE:  NULL \n*   RETORNA: Valor da memorioa que devera ser armazenada \n*   FUNCAO:  Calcula a memoria requerida para a simulacao \n*   OBS: \n* \n**************************************************************************/ \nint calcula_memoria_req(void) \n{ \n int bytesalocados = 0; \n bytesalocados += ( (nx+2*TAM_BORDAY)*(ny+2*TAM_BORDAX)*(nz) * \nsizeof(double)); \n bytesalocados += ( (nx+2*TAM_BORDAY+1)*(ny+2*TAM_BORDAX)*(nz) * \nsizeof(double)); \n bytesalocados += ( (nx+2*TAM_BORDAY+1)*(ny+2*TAM_BORDAX)*(nz) * \nsizeof(double)); \n bytesalocados += ( (nx+2*TAM_BORDAY-1)*(ny+2*TAM_BORDAX)*(nz) * \nsizeof(double)); \n bytesalocados += ( (nx+2*TAM_BORDAY)*(ny+2*TAM_BORDAX)*(nz) * \nsizeof(double)); \n bytesalocados += ( (nx+2*TAM_BORDAY)*(ny+2*TAM_BORDAX)*(nz) * \nsizeof(double)); \n bytesalocados += ( (nx+2*TAM_BORDAY)*(ny+2*TAM_BORDAX)*(nz) * \nsizeof(double)); \n return bytesalocados; \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  aloca_memoria() \n* \n*   RECEBE:  NULL \n*   RETORNA: Valor da memorioa alocada \n*   FUNCAO:  Alocar a memoria necessaria para a simulacao \n*   OBS: \n* \n**************************************************************************/ \nunsigned int aloca_memoria(void) \n{ \n\n \n\n\n\nAnexos 99\n\n int i,j,k; \n unsigned int bytesalocados = 0; \n \n ex = (double ***)malloc((nx+2*TAM_BORDAY)*sizeof(double **)); \n if( ex == NULL ) \n  erro_alocacao(); \n for(i=0; i<(nx+2*TAM_BORDAY); i++) \n  { \n   ex[i] = (double **)malloc((ny+2*TAM_BORDAX)*sizeof(double \n*)); \n   if( ex[i] == NULL ) \n    erro_alocacao(); \n \n   for(j=0; j<(ny+2*TAM_BORDAX); j++) \n    { \n     ex[i][j] = (double \n*)malloc((nz)*sizeof(double)); \n     if( ex[i][j] == NULL ) \n      erro_alocacao(); \n \n     for(k=0; k<(nz); k++) \n      { \n       ex[i][j][k] = 0.0; \n      } \n    } \n  } \n bytesalocados += ( (nx+2*TAM_BORDAY)*(ny+2*TAM_BORDAX)*(nz) * \nsizeof(double)); \n \n ey = (double ***)malloc((nx+2*TAM_BORDAY)*sizeof(double **)); \n if( ey == NULL ) \n  erro_alocacao(); \n \n for(i=0; i<(nx+2*TAM_BORDAY); i++) \n  { \n   ey[i] = (double **)malloc((ny+2*TAM_BORDAX)*sizeof(double \n*)); \n   if( ey[i] == NULL ) \n    erro_alocacao(); \n \n   for(j=0; j<(ny+2*TAM_BORDAX); j++) \n    { \n     ey[i][j] = (double \n*)malloc((nz)*sizeof(double)); \n     if( ey[i][j] == NULL ) \n      erro_alocacao(); \n \n     for(k=0; k<(nz); k++) \n      { \n       ey[i][j][k] = 0.0; \n      } \n    } \n  } \n bytesalocados += ( (nx+2*TAM_BORDAY)*(ny+2*TAM_BORDAX)*(nz) * \nsizeof(double)); \n \n ez = (double ***)malloc((nx+2*TAM_BORDAY)*sizeof(double **)); \n if( ez == NULL ) \n  erro_alocacao(); \n for(i=0; i<(nx+2*TAM_BORDAY); i++) \n  { \n\n \n\n\n\nAnexos 100\n\n   ez[i] = (double **)malloc((ny+2*TAM_BORDAX)*sizeof(double \n*)); \n   if( ez[i] == NULL ) \n    erro_alocacao(); \n   for(j=0; j<(ny+2*TAM_BORDAX); j++) \n    { \n     ez[i][j] = (double \n*)malloc((nz)*sizeof(double)); \n     if( ez[i][j] == NULL ) \n      erro_alocacao(); \n \n     for(k=0; k<(nz); k++) \n      { \n       ez[i][j][k] = 0.0; \n      } \n    } \n  } \n bytesalocados += ( (nx+2*TAM_BORDAY)*(ny+2*TAM_BORDAX)*(nz) * \nsizeof(double)); \n \n hx = (double ***)malloc((nx+2*TAM_BORDAY)*sizeof(double **)); \n if( hx == NULL ) \n  erro_alocacao(); \n \n for(i=0; i<(nx+2*TAM_BORDAY); i++) \n  { \n   hx[i] = (double **)malloc((ny+2*TAM_BORDAX)*sizeof(double \n*)); \n   if( hx[i] == NULL ) \n    erro_alocacao(); \n \n   for(j=0; j<(ny+2*TAM_BORDAX); j++) \n    { \n     hx[i][j] = (double \n*)malloc((nz)*sizeof(double)); \n     if( hx[i][j] == NULL ) \n      erro_alocacao(); \n \n     for(k=0; k<(nz); k++) \n      { \n       hx[i][j][k] = 0.0; \n      } \n    } \n  } \n bytesalocados += ( (nx+2*TAM_BORDAY)*(ny+2*TAM_BORDAX)*(nz) * \nsizeof(double)); \n \n hy = (double ***)malloc((nx+2*TAM_BORDAY)*sizeof(double **)); \n if( hy == NULL ) \n  erro_alocacao(); \n \n for(i=0; i<(nx+2*TAM_BORDAY); i++) \n  { \n   hy[i] = (double **)malloc((ny+2*TAM_BORDAX)*sizeof(double \n*)); \n   if( hy[i] == NULL ) \n    erro_alocacao(); \n \n   for(j=0; j<(ny+2*TAM_BORDAX); j++) \n    { \n\n \n\n\n\nAnexos 101\n\n     hy[i][j] = (double \n*)malloc((nz)*sizeof(double)); \n     if( hy[i][j] == NULL ) \n      erro_alocacao(); \n \n     for(k=0; k<(nz); k++) \n      { \n       hy[i][j][k] = 0.0; \n      } \n    } \n  } \n bytesalocados += ( (nx+2*TAM_BORDAY)*(ny+2*TAM_BORDAX)*(nz) * \nsizeof(double)); \n \n hz = (double ***)malloc((nx+2*TAM_BORDAY)*sizeof(double **)); \n if( hz == NULL ) \n  erro_alocacao(); \n \n for(i=0; i<(nx+2*TAM_BORDAY); i++) \n  { \n   hz[i] = (double **)malloc((ny+2*TAM_BORDAX)*sizeof(double \n*)); \n   if( hz[i] == NULL ) \n    erro_alocacao(); \n \n   for(j=0; j<(ny+2*TAM_BORDAX); j++) \n    { \n     hz[i][j] = (double \n*)malloc((nz)*sizeof(double)); \n     if( hz[i][j] == NULL ) \n      erro_alocacao(); \n \n     for(k=0; k<(nz); k++) \n      { \n       hz[i][j][k] = 0.0; \n      } \n    } \n  } \n bytesalocados += ( (nx+2*TAM_BORDAY)*(ny+2*TAM_BORDAX)*(nz) * \nsizeof(double)); \n \n vsar = (double ***)malloc((nx+2*TAM_BORDAY)*sizeof(double **)); \n if( vsar == NULL ) \n  erro_alocacao(); \n \n for(i=0; i<(nx+2*TAM_BORDAY); i++) \n  { \n   vsar[i] = (double \n**)malloc((ny+2*TAM_BORDAX)*sizeof(double *)); \n   if( vsar[i] == NULL ) \n    erro_alocacao(); \n \n   for(j=0; j<(ny+2*TAM_BORDAX); j++) \n    { \n     vsar[i][j] = (double \n*)malloc((nz)*sizeof(double)); \n     if( vsar[i][j] == NULL ) \n      erro_alocacao(); \n \n     for(k=0; k<(nz); k++) \n      { \n\n \n\n\n\nAnexos 102\n\n       vsar[i][j][k] = 0.0; \n      } \n    } \n  } \n bytesalocados += ( (nx+2*TAM_BORDAY)*(ny+2*TAM_BORDAX)*(nz) * \nsizeof(double)); \n \n return bytesalocados; \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  grava_sar_sag() \n* \n*   RECEBE:  NUMERO DO ARQUIVO, ITERACAO E NUMERO DO CORTE \n*   RETORNA: NULL \n*   FUNCAO:  Gravar em .TXT a Imagem SAGITAL da Cabeca com a SAR \n*   OBS: \n* \n**************************************************************************/ \nvoid grava_sar_sag(int n, int indgrav, int k, int nrointer) \n{ \n FILE *fp; \n char mat[100]; \n int i,j,gravbrx,gravbry; \n double sar; \n \n gravbrx = 0; \n gravbry = 0; \n \n if (indgrav<10) \n { \n  sprintf(mat,\"sar_sag%d_00%d.txt\",n,indgrav); \n } \n else if (indgrav<100) \n { \n  sprintf(mat,\"sar_sag%d_0%d.txt\",n,indgrav); \n } \n else \n { \n  sprintf(mat,\"sar_sag%d_%d.txt\",n,indgrav); \n } \n \n printf(\"Gravando SAR no arquivo %s para o corte Sagital k = %d \n\\n\",mat,k); \n \n if (GRAVA_BORDA) \n { \n  gravbrx = TAM_BORDAX; \n  gravbry = TAM_BORDAY; \n } \n \n fp=fopen(mat,\"w+\"); \n \n if (MATHLAB) \n  fprintf(fp,\"[\"); \n \n for(j = TAM_BORDAX-gravbrx ; j &lt;ny+TAM_BORDAX+gravbrx ; j++) \n { \n  for(i = TAM_BORDAY-gravbry ; i &lt;nx+TAM_BORDAY+gravbry ; i++) \n  { \n\n \n\n\n\nAnexos 103\n\n   sar = vsar[i][j][k]/nrointer; \n   fprintf(fp,\"%.2e \",sar); \n  } \n  if (MATHLAB) \n   fprintf(fp,\";\\n\"); \n  else \n   fprintf(fp,\"\\n\"); \n } \n if (MATHLAB) \n  fprintf(fp,\"]\"); \n fclose(fp); \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  grava_sar_fro() \n* \n*   RECEBE:  NRO ARQUIVO, ITERACAO, COLUNA E NRO DO CORTE INICIAL E FINAL \n*   RETORNA: NULL \n*   FUNCAO:  Gravar em .TXT a Imagem FRONTAL da Cabeca com a SAR \n*   OBS: \n* \n**************************************************************************/ \nvoid grava_sar_fro(int n, int ctagrav, int nrointer, int i ,int kinic, int \nkfinal) \n{ \n FILE *fp; \n char mat[100]; \n int j,k,gravbrx; \n double sar; \n \n gravbrx = 0; \n \n if (ctagrav<10) \n { \n  sprintf(mat,\"sar_fro%d_00%d.txt\",n,ctagrav); \n } \n else if (ctagrav<100) \n { \n  sprintf(mat,\"sar_fro%d_0%d.txt\",n,ctagrav); \n } \n else \n { \n  sprintf(mat,\"sar_fro%d_%d.txt\",n,ctagrav); \n } \n \n printf(\"Gravando SAR no arquivo %s para o corte Frontal i = %d \n\\n\",mat,i); \n \n if (GRAVA_BORDA) \n { \n  gravbrx = TAM_BORDAX; \n } \n \n fp=fopen(mat,\"w+\"); \n \n \n if (MATHLAB) \n  fprintf(fp,\"[\"); \n \n for(j = TAM_BORDAX-gravbrx ; j &lt;ny+TAM_BORDAX+gravbrx ; j++) \n\n \n\n\n\nAnexos 104\n\n { \n  for(k = kinic ; k &lt;kfinal ; k++) \n  { \n   sar = vsar[i][j][k]/nrointer; \n   fprintf(fp,\"%.2e \",sar); \n  } \n  if (MATHLAB) \n   fprintf(fp,\";\\n\"); \n \n  else \n   fprintf(fp,\"\\n\"); \n } \n if (MATHLAB) \n  fprintf(fp,\"]\"); \n fclose(fp); \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  grava_sar_cor() \n* \n*   RECEBE:  NRO ARQUIVO, ITERACAO, LINHA E NRO DO CORTE INICIAL E FINAL \n*   RETORNA: NULL \n*   FUNCAO:  Gravar em .TXT a Imagem CORONAL da Cabeca com a SAR \n*   OBS: \n* \n**************************************************************************/ \nvoid grava_sar_cor(int n, int ctagrav, int nrointer, int j ,int kinic, int \nkfinal) \n{ \n FILE *fp; \n char mat[100]; \n int i,k,gravbry; \n double sar; \n \n gravbry = 0; \n \n if (ctagrav<10) \n { \n  sprintf(mat,\"sar_cor%d_00%d.txt\",n,ctagrav); \n } \n else if (ctagrav<100) \n { \n  sprintf(mat,\"sar_cor%d_0%d.txt\",n,ctagrav); \n } \n else \n { \n  sprintf(mat,\"sar_cor%d_%d.txt\",n,ctagrav); \n } \n \n printf(\"Gravando SAR no arquivo %s para o corte Coronal j = %d \n\\n\",mat,j); \n \n if (GRAVA_BORDA) \n { \n  gravbry = TAM_BORDAY; \n } \n \n fp=fopen(mat,\"w+\"); \n \n if (MATHLAB) \n\n \n\n\n\nAnexos 105\n\n  fprintf(fp,\"[\"); \n \n \n for(i = TAM_BORDAY-gravbry ; i &lt;nx+TAM_BORDAY+gravbry ; i++) \n { \n  for(k = kinic ; k &lt;kfinal ; k++) \n  { \n   sar = vsar[i][j][k]/nrointer; \n   fprintf(fp,\"%.2e \",sar); \n  } \n  if (MATHLAB) \n   fprintf(fp,\";\\n\"); \n  else \n   fprintf(fp,\"\\n\"); \n } \n if (MATHLAB) \n  fprintf(fp,\"]\"); \n fclose(fp); \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  grava_cpo_sag() \n* \n*   RECEBE:  NRO DO ARQUIVO, ITERACAO, NRO DO CORTE E SE E ANTENA OU CAMPO \n*   RETORNA: NULL \n*   FUNCAO:  Gravar em .TXT a Imagem SAGITAL da Cabeca com a SAR \n*   OBS:     qualq = 1 -> campo \n* \n**************************************************************************/ \nvoid grava_cpo_sag(int n, int indgrav,int k, int qualg) \n{ \n FILE *fp; \n char mat[100]; \n int i,j,gravbrx,gravbry; \n \n gravbrx = 0; \n gravbry = 0; \n \n   if (indgrav<10) \n { \n  if (qualg) \n   sprintf(mat,\"s0%d00%d.txt\",n,indgrav); \n  else \n  { \n   if (n<10) \n    sprintf(mat,\"s0%d00%d.txt.txt\",n,indgrav); \n   else \n    sprintf(mat,\"s%d00%d.txt.txt\",n,indgrav); \n  } \n \n } \n else if (indgrav<100) \n { \n  if (qualg) \n   sprintf(mat,\"cam_sag%d_0%d.txt\",n,indgrav); \n  else \n  { \n   if (n<10) \n    sprintf(mat,\"s%d0%d.txt.txt\",n,indgrav); \n   else \n\n \n\n\n\nAnexos 106\n\n  } \n } \n else \n { \n  if (qualg) \n   sprintf(mat,\"cam_sag%d_%d.txt\",n,indgrav); \n  else \n   sprintf(mat,\"ant_sag%d_%d.txt\",n,indgrav); \n } \n \n if (qualg) \n  printf(\"Gravando campo no arquivo %s para o corte Sagital k = \n%d \\n\",mat,k); \n else \n  printf(\"Gravando antena no arquivo %s para o corte Sagital k = \n%d \\n\",mat,k); \n \n \n if (GRAVA_BORDA) \n { \n  gravbrx = TAM_BORDAX; \n  gravbry = TAM_BORDAY; \n } \n \n fp=fopen(mat,\"w+\"); \n \n if (MATHLAB) \n  fprintf(fp,\"[\"); \n \n// for(j = TAM_BORDAX-gravbrx ; j &lt;ny+TAM_BORDAX+gravbrx ; j++) // \noriginal so q de cab p/ baixo \n for(j = ny+TAM_BORDAX+gravbrx-1 ; j >= TAM_BORDAX-gravbrx ; j--) \n { \n  for(i = TAM_BORDAY-gravbry ; i &lt;nx+TAM_BORDAY+gravbry ; i++) \n  { \n   fprintf(fp,\"%.4e \n\",sqrt((ex[i][j][k]*ex[i][j][k])+(ey[i][j][k]*ey[i][j][k])+(ez[i][j][k]*ez[\ni][j][k]))); \n  } \n  if (MATHLAB) \n   fprintf(fp,\";\\n\"); \n  else \n   fprintf(fp,\"\\n\"); \n } \n if (MATHLAB) \n  fprintf(fp,\"]\"); \n fclose(fp); \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  grava_cpo_fro() \n* \n*   RECEBE:  NRO ARQUIVO, ITERACAO, COLUNA E NRO DO CORTE INICIAL, \n*     FINAL E SE E ANTENA OU CAMPO \n*   RETORNA: NULL \n*   FUNCAO:  Gravar em .TXT a Imagem FRONTAL do Campo Eletromagnetico \n*   OBS: \n* \n**************************************************************************/ \n\n \n\n\n\nAnexos 107\n\nvoid grava_cpo_fro(int n, int ctagrav, int i ,int kinic, int kfinal, int \nqualg) \n{ \n FILE *fp; \n char mat[100]; \n int j,k,gravbrx; \n \n gravbrx = 0; \n \n if (ctagrav<10) \n { \n  if (qualg) \n   sprintf(mat,\"cam_fro%d_00%d.txt\",n,ctagrav); \n \n  else \n   sprintf(mat,\"ant_fro%d_00%d.txt\",n,ctagrav); \n } \n else if (ctagrav<100) \n { \n  if (qualg) \n   sprintf(mat,\"cam_fro%d_0%d.txt\",n,ctagrav); \n  else \n   sprintf(mat,\"ant_fro%d_0%d.txt\",n,ctagrav); \n } \n else \n { \n  if (qualg) \n   sprintf(mat,\"cam_fro%d_%d.txt\",n,ctagrav); \n  else \n   sprintf(mat,\"ant_fro%d_%d.txt\",n,ctagrav); \n } \n \n if (qualg) \n  printf(\"Gravando campo no arquivo %s para o corte Frontal i = \n%d \\n\",mat,i); \n else \n  printf(\"Gravando antena no arquivo %s para o corte Frontal i = \n%d \\n\",mat,i); \n \n if (GRAVA_BORDA) \n { \n  gravbrx = TAM_BORDAX; \n } \n \n fp=fopen(mat,\"w+\"); \n \n if (MATHLAB) \n  fprintf(fp,\"[\"); \n \n for(j = TAM_BORDAX-gravbrx ; j &lt;ny+TAM_BORDAX+gravbrx ; j++) \n { \n  for(k = kinic ; k &lt;kfinal ; k++) \n  { \n   fprintf(fp,\"%.4e \n\",sqrt((ex[i][j][k]*ex[i][j][k])+(ey[i][j][k]*ey[i][j][k])+(ez[i][j][k]*ez[\ni][j][k]))); \n  } \n  if (MATHLAB) \n   fprintf(fp,\";\\n\"); \n  else \n   fprintf(fp,\"\\n\"); \n\n \n\n\n\nAnexos 108\n\n } \n if (MATHLAB) \n  fprintf(fp,\"]\"); \n fclose(fp); \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  grava_cpo_cor() \n* \n*   RECEBE:  NRO ARQUIVO, ITERACAO, LINHA, NRO DO CORTE INICIAL E FINAL, \n*     E SE E ANTENA OU CAMPO \n*   RETORNA: NULL \n*   FUNCAO:  Gravar em .TXT a Imagem CORONAL do Campo Eletromagnetico \n*   OBS: \n* \n**************************************************************************/ \nvoid grava_cpo_cor(int n, int ctagrav, int j ,int kinic, int kfinal, int \nqualg) \n{ \n FILE *fp; \n char mat[100]; \n int i,k,gravbry; \n \n gravbry = 0; \n \n if (ctagrav<10) \n { \n  if (qualg) \n   sprintf(mat,\"cam_cor%d_00%d.txt\",n,ctagrav); \n  else \n   sprintf(mat,\"ant_cor%d_00%d.txt\",n,ctagrav); \n } \n else if (ctagrav<100) \n { \n  if (qualg) \n   sprintf(mat,\"cam_cor%d_0%d.txt\",n,ctagrav); \n  else \n   sprintf(mat,\"ant_cor%d_0%d.txt\",n,ctagrav); \n } \n else \n { \n  if (qualg) \n   sprintf(mat,\"cam_cor%d_%d.txt\",n,ctagrav); \n  else \n   sprintf(mat,\"ant_cor%d_%d.txt\",n,ctagrav); \n } \n \n if (qualg) \n  printf(\"Gravando campo no arquivo %s para o corte Coronal j = \n%d \\n\",mat,j); \n else \n  printf(\"Gravando antena no arquivo %s para o corte Coronal j = \n%d \\n\",mat,j); \n \n \n if (GRAVA_BORDA) \n { \n  gravbry = TAM_BORDAY; \n } \n \n\n \n\n\n\nAnexos 109\n\n fp=fopen(mat,\"w+\"); \n \n if (MATHLAB) \n  fprintf(fp,\"[\"); \n \n for(i = TAM_BORDAY-gravbry ; i &lt;nx+TAM_BORDAY+gravbry ; i++) \n { \n  for(k = kinic ; k &lt;kfinal ; k++) \n  { \n   fprintf(fp,\"%.4e \n\",sqrt((ex[i][j][k]*ex[i][j][k])+(ey[i][j][k]*ey[i][j][k])+(ez[i][j][k]*ez[\ni][j][k]))); \n  } \n  if (MATHLAB) \n   fprintf(fp,\";\\n\"); \n  else \n   fprintf(fp,\"\\n\"); \n } \n if (MATHLAB) \n  fprintf(fp,\"]\"); \n fclose(fp); \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  aloca_memoria() \n* \n*   FUNCAO:  Emitir sinal de erro \n* \n**************************************************************************/ \nvoid signal_handler_fpu(int *p) \n{ \n printf(\"Erro fpe!\\n\"); \n exit(1); \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  signal_handler_sigsev() \n* \n*   FUNCAO:  Emitir sinal de erro \n* \n**************************************************************************/ \nvoid signal_handler_sigsev(int *p) \n{ \n printf(\"Erro sigsev!!\\n\"); \n exit(1); \n} \n \n/************************************************************************ \n* \n*   FUNCAO:  erro_alocacao() \n* \n*   FUNCAO:  Emitir sinal de erro \n* \n**************************************************************************/ \nvoid erro_alocacao(void) \n{ \n printf(\"Erro Alocando Matrizes!! - Provavelmente Falta de \nMemoria.\\n\"); \n exit(1); \n\n \n\n\n\nAnexos 110\n\n} \n \n/************************************************************************ \n* \n*   FUNCAO:  grava_rel_sar() \n* \n*   RECEBE:  Hora Inicial, Variaveis espaciais &amp; Temporais \n*   RETORNA: NULL \n*   FUNCAO:  Gravar em .txt um relatorio da simulacao \n*   OBS: \n \n* \n**************************************************************************/ \nvoid grava_rel_sar(double dx, double dy, double dz, double dt, double \ncpopele, double cpomusc, \n       double cpoosso, double cpoolho, double \ncpocereb, double cpoar, \n       int bytesalocados, double \nnro_cel_borda, double log_g, \n       double berenger_g, double sigma_zero, \nint nmax, double atingiu_borda, \n       double degringolou, int m_int_pto1, int \nm_int_pto2, double m_val_pto1, \n       double m_val_pto2) \n{ \n FILE *fp; \n char mat[100]; \n double diff_time,vel_onda_c; \n \n time_t horat,hora2; \n \n vel_onda_c=0.0; \n \n sprintf(mat,\"relatsar.txt\"); \n \n printf(\"Gravando Relatorio da Simulacao:\\n\"); \n fp=fopen(mat,\"w+\"); \n \n hora2 = time(NULL); \n time(&amp;horat); \n \n diff_time = difftime(hora2,horacom); \n \n fprintf(fp,\"************************************************** \\n\"); \n fprintf(fp,\"UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL (UFRGS)  \\n\"); \n fprintf(fp,\"   DEPARTAMENTO DE ENGENHARIA ELETRICA (DELET)     \\n\"); \n fprintf(fp,\"LABORATORIO DE COMUNICACOES ELETRO-OPTICAS (LACOM) \\n\"); \n fprintf(fp,\"     SIMULADOR FDTD VERSAO %s - UFRGS - 2001       \n\\n\",VERSAO); \n fprintf(fp,\"************************************************** \n\\n\\n\"); \n \n fprintf(fp,\"RELATORIO DA SIMULACAO: \\n\\n\"); \n fprintf(fp,\"INICIO DA SIMULACAO........: %s\",ctime(&amp;horaini)); \n fprintf(fp,\"DATA E HORA FINAL..........: %s\",ctime(&amp;horat)); \n fprintf(fp,\"TEMPO TOTAL DA SIMULACAO...: %lg seg ou %lg min ou %lg \nh\\n\" \n     ,diff_time,diff_time/60,diff_time/3600); \n fprintf(fp,\"MEDIA DE...................: %lg seg/int ou %lg min/int \nou %lg h/int\\n\" \n\n \n\n\n\nAnexos 111\n\n     \n,diff_time/NUM_MAX_ITERACAO,(diff_time/60)/NUM_MAX_ITERACAO, \n     (diff_time/3600)/NUM_MAX_ITERACAO); \n fprintf(fp,\"MEMORIA REQUERIDA..........: %lg \nMBytes\\n\\n\",(bytesalocados/1000000.0)+100); \n \n if (QUAL_MATERIAL) \n  fprintf(fp,\"\\nMATERIAL DE ESTUDO.........: CABECA\\n\\n\"); \n else \n  fprintf(fp,\"\\nMATERIAL DE ESTUDO.........: AR\\n\\n\"); \n \n fprintf(fp,\"NUMERO TOTAL DE ITERACOES..: %d iteracoes ou %lg \nsegundo(s)\\n\",NUM_MAX_ITERACAO,NUM_MAX_ITERACAO*dt); \n if (QUAL_MATERIAL) \n  fprintf(fp,\"CORTES DO MATERIAL ESTUDADO: %d pixel(s) ou %lg \nm\\n\",TAM_DA_CAB,TAM_DA_CAB*dx); \n fprintf(fp,\"ARESTA DO CUBO (dx=dy=dz)..: %lg m\\n\",dx); \n fprintf(fp,\"LINHAS.....................: %d pixel(s) ou %lg \nm\\n\",ny,ny*dx); \n fprintf(fp,\"COLUNAS....................: %d pixel(s) ou %lg \nm\\n\",nx,nx*dx); \n fprintf(fp,\"TAMANHO DA BORDA...........: %d pixel(s) ou %lg \nm\\n\",TAM_BORDAZ,TAM_BORDAZ*dx); \n fprintf(fp,\"VOLUME DO CUBO.............: %lg m^3\\n\",dx*dy*dz); \n fprintf(fp,\"DIFERENCIAL DO TEMPO (dt)..: %lg s\\n\\n\",dt); \n \n fprintf(fp,\"\\nDADOS DE CONVERGENCIA:\\n\\n\"); \n \n if (degringolou == 0) \n  fprintf(fp,\"HOUVE CAMPO MAIOR QUE ZERO.: NAO\\n\"); \n else \n { \n  fprintf(fp,\"CAMPO SAI DA CONVERGENCIA..: %lg \nITERACOES\\n\",degringolou); \n  fprintf(fp,\"TEMPO PARA SAIR DA CONVERG.: %lg \ns\\n\",degringolou*dt); \n  fprintf(fp,\"DIST\u00c2NCIA PERCORRIDA.......: %lg m ou %lg \ncomprimento(s) de onda\\n\" \n      ,LIGHT_SPEED*dt*degringolou \n      \n,((LIGHT_SPEED*dt*degringolou)/(LIGHT_SPEED/FREQUENCIA))); \n } \n \n if (atingiu_borda == 0) \n  fprintf(fp,\"CAMPO ATINGE A BORDA.......: NAO\\n\\n\"); \n else \n { \n  fprintf(fp,\"CAMPO ATINGE A BORDA EM....: %lg \nITERACOES\\n\",atingiu_borda); \n  fprintf(fp,\"TEMPO PARA ATINGIR A BORDA.: %lg \ns\\n\",atingiu_borda*dt); \n  fprintf(fp,\"DIST\u00c2NCIA PERCORRIDA.......: %lg m ou %lg \ncomprimento(s) de onda\\n\\n\" \n      ,LIGHT_SPEED*dt*atingiu_borda \n      \n,((LIGHT_SPEED*dt*atingiu_borda)/(LIGHT_SPEED/FREQUENCIA))); \n } \n \n fprintf(fp,\"\\nDADOS DA ANTENA:\\n\\n\"); \n \n fprintf(fp,\"ANTENA UTILIZADA...........: %s\\n\",TIPODANTENA); \n\n \n\n\n\nAnexos 112\n\n fprintf(fp,\"FREQUENCIA.................: %lg Hz\\n\",FREQUENCIA); \n fprintf(fp,\"COMPRIMENTO DE ONDA........: %lg \nm\\n\",LIGHT_SPEED/FREQUENCIA); \n fprintf(fp,\"DIST\u00c2NCIA PERCORRIDA.......: %lg m ou %lg comprimento(s) \nde onda\\n\" \n     ,LIGHT_SPEED*dt*NUM_MAX_ITERACAO \n     \n,((LIGHT_SPEED*dt*NUM_MAX_ITERACAO)/(LIGHT_SPEED/FREQUENCIA))); \n fprintf(fp,\"CORTES DE ANTENA  .........: %d corte(s) ou %lg m \n\\n\",TAM_ANTENA,(double)TAM_ANTENA*dx); \n fprintf(fp,\"DIST\u00c2NCIA (ANTENA/MATERIAL): %d corte(s) ou %lg m \n\\n\\n\",TAM_AR2,(double)TAM_AR2*dx); \n \n \n fprintf(fp,\"\\nDADOS DA BORDA:\\n\\n\"); \n \n fprintf(fp,\"TAMANHO MINIMO PARA A BORDA: %lg\\n\",nro_cel_borda); \n fprintf(fp,\"LARGURA MAXIMA DO DOMINIO..: %d\\n\",nmax); \n fprintf(fp,\"G..........................: %lg\\n\",berenger_g); \n fprintf(fp,\"LOGARITMO DE G.............: %lg\\n\",log_g); \n fprintf(fp,\"SIGMA ZERO.................: %lg\\n\\n\",sigma_zero); \n \n if (MEDE_VELOC || m_int_pto1 !=0 ) \n { \n  fprintf(fp,\"\\nVELOCIDADE DA ONDA:\\n\\n\"); \n  fprintf(fp,\"VALOR MAX DO PONTO 1.....: %lg\\n\",m_val_pto1); \n  fprintf(fp,\"OCORRIDO NA ITERACAO.....: %d\\n\",m_int_pto1); \n  fprintf(fp,\"VALOR MAX DO PONTO 2.....: %lg\\n\",m_val_pto2); \n  fprintf(fp,\"OCORRIDO NA ITERACAO.....: %d\\n\",m_int_pto2); \n  fprintf(fp,\"DIST\u00c2NCIA ENTRE OS PONTOS: %d\\n\",DELTA_DIST); \n  fprintf(fp,\"VARIACAO DE ITERACOES....: %d\\n\",m_int_pto2-\nm_int_pto1); \n  vel_onda_c=((DELTA_DIST*dx)/(m_int_pto2-m_int_pto1)*dt); \n  fprintf(fp,\"VELOCIDADE DA ONDA.......: %lg\\n\",vel_onda_c); \n  fprintf(fp,\"VELOCIDADE DA LUZ........: %lg\\n\",LIGHT_SPEED); \n  fprintf(fp,\"PERCENTUAL DE ERRO.......: \n%lg%\\n\",((vel_onda_c*100)/LIGHT_SPEED)); \n  vel_onda_c=((DELTA_DIST*dx)/(m_int_pto2-m_int_pto1-1)*dt); \n  fprintf(fp,\"PERCENTUAL DE ERRO (-1)..: \n%lg%\\n\",((vel_onda_c*100)/LIGHT_SPEED)); \n  vel_onda_c=((DELTA_DIST*dx)/(m_int_pto2-m_int_pto1+1)*dt); \n  fprintf(fp,\"PERCENTUAL DE ERRO (+1)..: \n%lg%\\n\\n\",((vel_onda_c*100)/LIGHT_SPEED)); \n } \n \n fprintf(fp,\"\\nCAMPO TOTAL NOS TECIDOS:\\n\\n\"); \n \n fprintf(fp,\"PELE.......................: %.4e\\n\",cpopele); \n fprintf(fp,\"MUSCULO....................: %.4e\\n\",cpomusc); \n fprintf(fp,\"OSSO.......................: %.4e\\n\",cpoosso); \n fprintf(fp,\"OLHO.......................: %.4e\\n\",cpoolho); \n fprintf(fp,\"CEREBRO....................: %.4e\\n\",cpocereb); \n fprintf(fp,\"AR.........................: %.4e\\n\",cpoar); \n fprintf(fp,\"TOTAL......................: \n%.4e\\n\\n\",cpopele+cpomusc+cpoosso+cpoolho+cpocereb+cpoar); \n \n if (QUAL_MATERIAL) \n { \n  fprintf(fp,\"SAR TOTAL NOS TECIDOS: \\n\\n\"); \n \n  fprintf(fp,\"PELE.......................:\\n\"); \n\n \n\n\n\nAnexos 113\n\n  fprintf(fp,\"MUSCULO....................:\\n\"); \n  fprintf(fp,\"OSSO.......................:\\n\"); \n  fprintf(fp,\"OLHO.......................:\\n\"); \n  fprintf(fp,\"CEREBRO....................:\\n\"); \n  fprintf(fp,\"TOTAL......................:\\n\"); \n } \n \n fprintf(fp,\"\\nHISTORICO DE GRAVACAO E CALCULOS:\\n\\n\"); \n \n if (MEDE_VELOC) \n  fprintf(fp,\"CALCULOU A VELOCIDADE DA ONDA\\n\"); \n \n if ( RAIO_POT > 0 ) \n  fprintf(fp,\"CALCULOU POT\u00caNCIA DA ONDA\\n\"); \n \n if (GRAVA_FRAME_SAR) \n  fprintf(fp,\"SAR\\n\"); \n \n if (GRAVA_FRAME_E) \n  fprintf(fp,\"MODULO DO CAMPO ELETROMAGNETICO\\n\"); \n \n if (GRAVA_ANTENA) \n  fprintf(fp,\"MODULO DO CAMPO ELETROMAGNETICO NA ANTENA\\n\"); \n \n if (GRAVA_SAG) \n  fprintf(fp,\"GRAVOU OS CORTES SAGITAIS\\n\"); \n \n if (GRAVA_FRO) \n  fprintf(fp,\"GRAVOU OS CORTES FRONTAIS\\n\"); \n \n if (GRAVA_PTO) \n  fprintf(fp,\"GRAVOU O CAMPO DE UM DETERMINADO PONTO\\n\"); \n \n if (GRAVA_COR) \n  fprintf(fp,\"GRAVOU OS CORTES CORONAIS\\n\"); \n \n \n if (GRAVA_FRAME_SAR || GRAVA_FRAME_E || GRAVA_ANTENA) \n { \n  fprintf(fp,\"GRAVADO A CADA %d ITERACOES\\n\",INTERVALO); \n \n  if (MATHLAB) \n   fprintf(fp,\"*TODOS NO FORMATO MATHLAB\\n\"); \n  else \n   fprintf(fp,\"*TODOS NO FORMATO LEBIT\\n\"); \n \n  if (GRAVA_BORDA) \n   fprintf(fp,\"**TODOS COM A BORDA NA FIGURA\\n\"); \n  else \n   fprintf(fp,\"**TODOS SEM A BORDA NA FIGURA\\n\"); \n } \n \n fclose(fp); \n} \n \n \n\n \n\n\n\nAnexos 114\n\nANEXO2 LISTAGEM DA ROTINA DE INDEXA\u00c7\u00c3O DOS TECIDOS \n  \n\n/************************************************************************** \n*  UFRGS - LACOM \n* \n*  Programa que le um BMP e gera um arquivo .fd para determinacao \n*   do material (tecido) para programa fdtd. \n* \n**************************************************************************/ \n/************************************************************************* \n* \n*  O arquivo .fd e definido como sendo texto, um numero por linha \n*       x     - largura da imagem em pixels \n*       y     - altura da imagem em pixels \n*       data1 \n*       ... \n*       datan \n*-1    - indica nova linha ( nao era necessario, incluido por seguranca) \n* \n*************************************************************************/ \n \n#include&lt;stdio.h> \n#include&lt;stdlib.h> \n#include&lt;string.h> \n \n#include \"cabbmp.h\" \n \n#define AR    0 \n#define PELE  1 \n#define MUSCULO 2 \n#define CEREBRO 3 \n#define OSSO  4 \n#define OLHO  5 \n#define BORDAX 5 \n#define BORDAY 6 \n#define CANTO  7 \n#define ANTENA  8 \n \n//#define NAO_REDEFINIR_CORES 1 \n#define DEBUG        1 \n \n \nvoid ident_cores(BYTE *buffer,int x,int y,unsigned char *cores,int *n); \nvoid subs_cores(BYTE *buffer,int x,int y); \n \nvoid subs_cores(BYTE *buffer,int x,int y) \n{ \n int xx; \n int i; \n int achado ; \n int nao_achados = 0; \n \n for(i = 0 ; i &lt;x*y ; i++) \n  { \n   achado = 0; \n   switch(buffer[i]) \n    { \n     case 0: // Preto \n\n \n\n\n\nAnexos 115\n\n      buffer[i] = 0; \n      achado = 1; \n      break; \n     case 53: // azul \n      buffer[i] = PELE; \n      achado = 1; \n      break; \n     case 134: // verde \n      buffer[i] = OLHO; \n      achado = 1; \n      break; \n     case 192: // vermelho \n      buffer[i] = MUSCULO; \n      achado = 1; \n      break; \n     case 143: \n      buffer[i] = CANTO; \n      achado = 1; \n      break; \n     case 183: \n      buffer[i] = BORDAY; \n      achado = 1; \n      break; \n     case 199: \n      buffer[i] = BORDAX; \n      achado = 1; \n      break; \n     case 210: \n      buffer[i] = CEREBRO; \n      achado = 1; \n      break; \n     case 215: // branco \n      buffer[i] = OSSO; \n      achado = 1; \n      break; \n     case 24: // verde \n      buffer[i] = ANTENA; \n      achado = 1; \n      break; \n     // CORES DIFERENTES PARA O AR (TONS DIFERENTES \nDE PRETO) \n     case 36: \n      buffer[i] = 0; \n      achado = 1; \n      break; \n     case 42: \n      buffer[i] = 0; \n      achado = 1; \n      break; \n     case 43: \n      buffer[i] = 0; \n      achado = 1; \n      break; \n     case 79: \n      buffer[i] = 0; \n      achado = 1; \n      break; \n     case 216: \n      buffer[i] = 0; \n      achado = 1; \n      break; \n\n \n\n\n\nAnexos 116\n\n     case 217: \n      buffer[i] = 0; \n      achado = 1; \n      break; \n     case 218: \n      buffer[i] = 0; \n      achado = 1; \n      break; \n     case 219: \n      buffer[i] = 0; \n      achado = 1; \n      break; \n     case 220: \n      buffer[i] = 0; \n      achado = 1; \n      break; \n  } \n   if( !achado ) \n    { \n     buffer[i] = buffer[i-1]; \n     nao_achados++; \n    } \n  } \n printf(\"\\n----> Nao achados = %d\\n\",nao_achados); \n} \n \n \n \n \nvoid ident_cores(BYTE *buffer,int x,int y,unsigned char *cores,int *n) \n{ \n int i; \n int j; \n int total=0; \n int contem; \n \n cores[0] = buffer[0]; \n total++; \n for(i = 0 ; i &lt;x*y ; i++) \n  { \n   contem = 0; \n   for(j = 0 ; j &lt;total ; j++) \n    if( cores[j] == buffer[i] ) \n     { \n      contem = 1; \n      break; \n     } \n   if ( !contem ) \n    { \n     cores[total] = buffer[i]; \n     total++; \n    } \n  } \n *n = total; \n} \n \n \nvoid main(int argc,char *argv[]) \n{ \n BYTE buffer[400000]; \n char *ref; \n\n \n\n\n\nAnexos 117\n\n char tmp[100];         \n unsigned char cores[256]; \n int n; \n int x,y,i,j; \n \n FILE *fp; \n \n if(argc &lt;2) \n  { \n   printf(\"Erro - Usar %s nome_do_arquivo\\n\",argv[0]); \n   exit(1); \n  } \n \n printf(\"Buffer de 200 Kbytes\\nLendo BMP...\"); \n if( le_bmp(argv[1],&amp;x,&amp;y,buffer) == -1 ) \n  { \n   perror(\"Erro abrindo arquivo:\"); \n   exit(0); \n  } \n printf(\" OK\\n\"); \n \n#ifdef DEBUG \n printf(\"x=%d y=%d \\n\",x,y); \n le_teste(argv[1]); \n#endif \n \n//#ifndef NAO_REDEFINIR_CORES \n   { \n    printf(\"Indexando cores.... \"); \n    subs_cores(buffer,x,y); \n    printf(\" OK\\n\"); \n   } \n//#endif \n ident_cores(buffer,x,y,cores,&amp;n); \n for(i = 0 ; i &lt;n ; i++) \n  printf(\"cores[%d]=%d\\n\",i,cores[i]); \n \n \n if( (ref = strchr(argv[1],'.')) == NULL ) \n  { \n   printf(\"Usar nome_do_arquivo.bmp\\n\"); \n   exit(1); \n  } \n memcpy(tmp,argv[1],ref - argv[1]); \n tmp[ref - argv[1]] = 0; \n strcat(tmp,\".fd\"); \n \n printf(\"Escrevendo %s...\",tmp ); \n if( (fp = fopen(tmp,\"w+\")) == NULL ) \n  { \n   perror(\"Erro abrindo arquivo:\"); \n   exit(1); \n  } \n printf(\" OK\\n\"); \n fprintf(fp,\"%d\\n\",x); // Numero de Colunas \n fprintf(fp,\"%d\\n\",y); // Numero de Linhas \n i = 0; \n j = 0; \n do \n  { \n   fprintf(fp,\"%d\\n\",buffer[i]); \n\n \n\n\n\nAnexos 118\n\n   i++; \n   j++; \n   if ( j == x ) \n    { \n     fprintf(fp,\"-1\\n\"); \n     j = 0; \n    } \n  } while( i != x*y ); \n fclose(fp); \n} \n\n \n\n\n\tAGRADECIMENTOS\n\tSUM\u00c1RIOLISTA DE FIGURASviiiLISTA DE TABELASxLIST?"}]}}}