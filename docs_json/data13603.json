{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.17019"}, {"@name": "filename", "#text": "23738_JacquelinedeMirandaKianCorr17.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "JACQUELINE DE MIRANDA KIAN\n\nTopology Optimization Method applied to Design\n\nChannels Considering Non-Newtonian Fluid Flow\n\nS\u00e3o Paulo\n2017\n\n\n\nJACQUELINE DE MIRANDA KIAN\n\nTopology Optimization Method applied to Design\nChannels Considering Non-Newtonian Fluid Flow\n\nSubmitted in partial fulfilment of the\nrequirements for the degree of Master of\nScience in Mechanical Engineering\n\nS\u00e3o Paulo\n2017\n\n\n\nJACQUELINE DE MIRANDA KIAN\n\nTopology Optimization Method applied to Design\nChannels Considering Non-Newtonian Fluid Flow\n\nSubmitted in partial fulfilment of the\nrequirements for the degree of Master of\nScience in Mechanical Engineering\n\nField of Study:\nControl and Mechanical Automation\nEngineering (3152)\n\nSupervised by:\nProf. Dr. Em\u00edlio Carlos Nelli Silva\n\nS\u00e3o Paulo\n2017\n\n\n\nEste exemplar foi revisado e corrigido em rela\u00e7\u00e3o \u00e0 vers\u00e3o original, sob \nresponsabilidade \u00fanica do autor e com a anu\u00eancia de seu orientador.\n\nS\u00e3o Paulo, ______ de ____________________ de __________\n\nAssinatura do autor:         ________________________ \n\nAssinatura do orientador:  ________________________ \n\nCataloga\u00e7\u00e3o-na-publica\u00e7\u00e3o\n\nKian, Jacqueline\n        Topology Optimization Method applied to Design Channels Considering\nNon-Newtonian Fluid Flow / J. Kian -- vers\u00e3o corr. -- S\u00e3o Paulo, 2017.\n        77 p. \n\n        Disserta\u00e7\u00e3o (Mestrado) - Escola Polit\u00e9cnica da Universidade de S\u00e3o\nPaulo. Departamento de Engenharia Mecatr\u00f4nica e de Sistemas Mec\u00e2nicos.\n\n        1.M\u00e9todos Topol\u00f3gicos (Otimiza\u00e7\u00e3o) 2.M\u00e9todo dos Elementos Finitos\n3.Din\u00e2mica dos Fluidos (Simula\u00e7\u00e3o) 4.Hemodin\u00e2mica I.Universidade de S\u00e3o\nPaulo. Escola Polit\u00e9cnica. Departamento de Engenharia Mecatr\u00f4nica e de\nSistemas Mec\u00e2nicos II.t.\n\n\n\nACKNOWLEDGEMENTS\n\nTo my supervisor, Prof. Emilio Carlos Nelli Silva for the attention, guidance and\npatience during the execution of this work.\n\nTo my boyfriend Lu\u00eds Fernando Nogueira de S\u00e1 for the support and love, and for\nalways giving me motivation to go on.\n\nTo my parents Vilson and Marlene and my brother Guilherme, for believing in me\nand supporting my decisions.\n\nTo my lab colleagues and to professor Juan Romero for the useful suggestions which\nwere valuable to the development of this work.\n\n\n\nRESUMO\n\nO estudo de escoamento de fluidos n\u00e3o-Newtonianos apresenta-se relevante no campo de\nbioengenharia, em especial no projeto de dispositivos para condu\u00e7\u00e3o de sangue, como bypass\narterial. Melhorias na redu\u00e7\u00e3o de dissipa\u00e7\u00e3o de energia e no dano \u00e0s c\u00e9lulas sangu\u00edneas\ncausados por fluxos artificiais podem ser obtidas atrav\u00e9s do uso de t\u00e9cnicas de simula\u00e7\u00e3o e\notimiza\u00e7\u00e3o num\u00e9ricas. Deste modo, este trabalho prop\u00f5e o estudo do projeto de canais para\nescoamentos incompress\u00edveis em regime permanente de fluidos n\u00e3o-Newtonianos atrav\u00e9s\ndo M\u00e9todo de Otimiza\u00e7\u00e3o Topol\u00f3gica baseado no m\u00e9todo de densidade. O escoamento\n\u00e9 modelado com as equa\u00e7\u00f5es de Navier-Stokes acopladas com a equa\u00e7\u00e3o constitutiva de\nCarreau-Yasuda para a viscosidade din\u00e2mica, para que sejam considerados os efeitos das\npropriedades n\u00e3o-Newtonianas do sangue. O M\u00e9todo de Otimiza\u00e7\u00e3o Topol\u00f3gica distribue\nregi\u00f5es de s\u00f3lido e fluido, dada uma restri\u00e7\u00e3o de volume, dentro de um dom\u00ednio especificado\nde modo a obter uma geometria e configura\u00e7\u00e3o que minimize a dissipa\u00e7\u00e3o de energia,\ntens\u00e3o de cisalhamento e vorticidade, utilizando a pseudo-densidade do material como\nvari\u00e1vel de projeto. Para aplicar este m\u00e9todo a sistemas fluidos, um meio poroso fict\u00edcio,\nbaseado na equa\u00e7\u00e3o de Darcy, \u00e9 introduzido. O modelo de escoamento \u00e9 implementado\nem sua forma discreta utilizando o M\u00e9todo de Elementos Finitos atrav\u00e9s da plataforma\nOpenSource FEniCS, aplicada para automatizar a solu\u00e7\u00e3o dos modelos matem\u00e1ticos\nbaseados em equa\u00e7\u00f5es diferenciais, e o problema de otimiza\u00e7\u00e3o \u00e9 resolvido utilizando a\nbiblioteca DOLFIN-adjoint e otimizador IPOpt. Topologias otimizadas de canais para\nfluxo de sangue, com foco em bypass arterial, s\u00e3o apresentadas para ilustrar o m\u00e9todo\nproposto.\n\nPalavras-chave: Otimiza\u00e7\u00e3o Topol\u00f3gica. Fluidos N\u00e3o-Newtonianos. Escoamento de\nSangue. Bypass Arterial.\n\n\n\nABSTRACT\n\nThe study of non-Newtonian flow is presents itself as relevant in bioengineering field,\nspecially for design of devices that conduct blood, as arterial bypass grafts. Improvements\nin reducing energy dissipation and blood cell damage caused by artificial flows can be\nachieved by using numerical simulation and optimization methods. Thus, the present\nwork proposes the study of design channels for steady, incompressible non-Newtonian flow,\nby using Topology Optimization Method based on the density method. The fluid flow\nis modeled with the Navier-Stokes equations coupled with Carreau-Yasuda constitutive\nequation for the dynamic viscosity to take into account the effects of the non-Newtonian\nblood properties. The Topology Optimization Method distributes regions of solid and fluid,\ngiven a volume constraint, within a specified domain in order to obtain a geometry and\nlayout that minimizes energy dissipation, shear stress and vorticity by using the material\npseudo-density as design variable. To apply this method to fluidic systems design, a fictional\nporous media based on Darcy equation is introduced. The flow model is implemented in\nits discrete form by using the Finite Element Method through the OpenSource platform\nFEniCS, applied to automate the solution of mathematical models based on differential\nequations. The optimization problem is solved by using the library DOLFIN-adjoint and\nIPOpt optimizer. Optimized topologies of channels for blood flow, focusing in arterial\nbypass grafts, are presented to illustrate the proposed method.\n\nKeywords: Topology Optimization. Non-Newtonian Fluids. Blood Flow. Arterial Bypass.\n\n\n\nLIST OF FIGURES\n\nFigure 1.1 \u2013 Influence of red blood cells in shear thinning effect . . . . . . . . . . . 13\nFigure 1.2 \u2013 Optimization approaches . . . . . . . . . . . . . . . . . . . . . . . . . 15\nFigure 2.1 \u2013 Shear rate dependent viscosity for different models (logarithmic scale) 20\nFigure 2.2 \u2013 Taylor-Hood mixed elements . . . . . . . . . . . . . . . . . . . . . . . 23\nFigure 3.1 \u2013 Topology optimization procedure for designing non-Newtonian fluid\n\nchannels . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26\nFigure 3.2 \u2013 Fixed extended design domain . . . . . . . . . . . . . . . . . . . . . . 27\nFigure 3.3 \u2013 Influence of penalty parameter . . . . . . . . . . . . . . . . . . . . . . 29\nFigure 5.1 \u2013 Topology optimization implementation flow chart . . . . . . . . . . . 43\nFigure 5.2 \u2013 Approaches of computing the adjoint problem . . . . . . . . . . . . . 46\nFigure 6.1 \u2013 Backward facing step problem . . . . . . . . . . . . . . . . . . . . . . 49\nFigure 6.2 \u2013 Velocity profile for newtonian model. (a) Umax = 0.025m/s. (b) Umax =\n\n0.8m/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49\nFigure 6.3 \u2013 Velocity profile for Carreau-Yasuda model. (a) Umax = 0.025m/s. (b)\n\nUmax = 0.8m/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49\nFigure 6.4 \u2013 Velocity profile obtained in literature: (a) Umax = 0.025m/s and (b)\n\nUmax = 0.8m/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50\nFigure 6.5 \u2013 Velocity profile at the outlet for different viscosity models obtained\n\nwith FEniCS: (a) Umax = 0.025m/s and (b) Umax = 0.8m/s . . . . . 50\nFigure 6.6 \u2013 Double channel problem . . . . . . . . . . . . . . . . . . . . . . . . . 51\nFigure 6.7 \u2013 Topologies for the double channel problem with Stokes formulation . 52\nFigure 6.8 \u2013 Double channel problem with zero stress boundary condition at the\n\noutlet . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52\nFigure 6.9 \u2013 Topology results for double channel and Navier-Stokes Newtonian model 53\nFigure 6.10 \u2013 Velocity fields for double channel and Navier-Stokes Newtonian model 53\nFigure 6.11 \u2013 Topology results for double channel and Navier-Stokes non-Newtonian\n\nmodel (Carreau-Yasuda viscosity model) . . . . . . . . . . . . . . . . 54\nFigure 6.12 \u2013 Velocity fields for double channel and Navier-Stokes non-Newtonian\n\nmodel (Carreau-Yasuda viscosity model) . . . . . . . . . . . . . . . . 54\nFigure 6.13 \u2013 Viscosity fields for double channel and Navier-Stokes non-Newtonian\n\nmodel (Carreau-Yasuda Viscosity Model) . . . . . . . . . . . . . . . . 54\nFigure 6.14 \u2013 Obstacle problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55\nFigure 6.15 \u2013 Optimized topologies for the obstacle problem . . . . . . . . . . . . . 56\nFigure 6.16 \u2013 Velocity and viscosity profiles for the Carreau-Yasuda model . . . . . 56\nFigure 6.17 \u2013 Arterial bypass domain . . . . . . . . . . . . . . . . . . . . . . . . . . 57\nFigure 6.18 \u2013 Initial guess for bypass topology optimization of fully blocked artery . 58\n\n\n\nFigure 6.19 \u2013 Velocity and viscosity fields for bypass initial guess of fully blocked\nartery . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58\n\nFigure 6.20 \u2013 Final topology for bypass optimization of fully blocked artery . . . . 59\nFigure 6.21 \u2013 Velocity and viscosity fields for bypass optimization of fully blocked\n\nartery . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59\nFigure 6.22 \u2013 Convergence curve for bypass optimization of fully blocked artery . . 60\nFigure 6.23 \u2013 Topology changes during bypass optimization of fully blocked artery . 60\nFigure 6.24 \u2013 Design domain and boundary conditions for stenosed artery bypass . 61\nFigure 6.25 \u2013 Final topology for stenosed artery optimization (Case 1) . . . . . . . 62\nFigure 6.26 \u2013 Velocity field for stenosed artery optimization (Case 1) . . . . . . . . 62\nFigure 6.27 \u2013 Viscosity field for stenosed artery optimization (Case 1) . . . . . . . . 63\nFigure 6.28 \u2013 Final topology for stenosed artery optimization (Case 2) . . . . . . . 63\nFigure 6.29 \u2013 Velocity field for stenosed artery optimization (Case 2) . . . . . . . . 64\nFigure 6.30 \u2013 Viscosity field for stenosed artery optimization (Case 2) . . . . . . . . 64\nFigure 6.31 \u2013 Final topology for stenosed artery optimization (Case 3) . . . . . . . 65\nFigure 6.32 \u2013 Velocity field for stenosed artery optimization (Case 3) . . . . . . . . 65\nFigure 6.33 \u2013 Viscosity field for stenosed artery optimization (Case 3) . . . . . . . . 65\nFigure 6.34 \u2013 Gray final topology for pure vorticity optimization . . . . . . . . . . . 66\nFigure 6.35 \u2013 Final topology for vorticity optimization . . . . . . . . . . . . . . . . 67\nFigure 6.36 \u2013 Convergence curve for bypass optimization considering vorticity functional\n\nwith added inertial part . . . . . . . . . . . . . . . . . . . . . . . . . 67\nFigure 6.37 \u2013 Final topology considering the multi-objective functional . . . . . . . 68\nFigure 6.38 \u2013 Convergence curve for optimization considering the multi-objective\n\nfunctional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68\nFigure 6.39 \u2013 Topology changes during bypass optimization considering the multi-objective\n\nfunctional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69\nFigure 6.40 \u2013 Design domain and boundary conditions for the 3D convergent diffuser 70\nFigure 6.41 \u2013 Final topology for the 3D convergent diffuser optimization . . . . . . 70\nFigure 6.42 \u2013 Velocity field for optimized 3D convergent diffuser . . . . . . . . . . . 71\nFigure 6.43 \u2013 Viscosity field for optimized 3D convergent diffuser . . . . . . . . . . 71\n\n\n\nLIST OF TABLES\n\nTable 6.1 \u2013 Carreau-Yasuda parameters for blood . . . . . . . . . . . . . . . . . . 48\nTable 6.2 \u2013 Functional values for double channel . . . . . . . . . . . . . . . . . . . 53\nTable 6.3 \u2013 Final Functional values for bypass optimization of fully blocked artery 60\nTable 6.4 \u2013 Cases division for bypass optimization of partial blocked artery . . . . 61\nTable 6.5 \u2013 Functional values for vorticity optimization . . . . . . . . . . . . . . . 66\nTable 6.6 \u2013 Functional values for optimization considering the multi-objective\n\nfunctional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68\n\n\n\nACRONYMS\n\nCFD Computational Fluid Dynamics\n\nPDE Partial Differential Equation\n\nFEM Finite Element Method\n\nLBB Ladyzhenskaya\u2013Babu\u0161ka\u2013Brezzi\n\nTOM Topology Optimisation Method\n\nIPOpt Internal Point Optimizer\n\nFFC FEniCS Form Compiler\n\nUFL Unified Form Language\n\nUFC Unified Form-Assembly Code\n\nPETSc Portable, Extensible Toolkit for Scientific Computation\n\nGMRES Generalized minimal residual\n\nBicstab Biconjugated Gradient Stabilized\n\nMUMPS MUltifrontal Massively Parallel Sparse\n\nILU Incomplete Lower Upper\n\n\n\nNOTATION\n\nu Velocity field\np Pressure field\n% Mass density\n\u00b5 Dynamic viscosity\n? Cauchy stress tensor\nf Field forces\nI Identity tensor\n? Symmetric gradient\n? Inverse permeability\n?? Shear rate\nn Power law index\n? Design domain\n? Design variable\n? Velocity interpolation function\n? Pressure interpolation function\nx,y Global coordinates\n?,? Local element coordinates\nq Penalty parameter\n? Energy dissipation function\nJss Shear stress function\nJv Vorticity function\n? Boundary condition\n?? Adjoint vector\n\n\n\nCONTENTS\n\n1 INTRODUCTION . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n\n1.1 Non-Newtonian Blood Flow . . . . . . . . . . . . . . . . . . . . . . . . 13\n1.2 Optimization Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . 14\n1.3 Motivation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16\n1.4 Objectives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16\n1.5 Document Outline . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17\n\n2 MODELING OF NON-NEWTONIAN FLOW . . . . . . . . . . . . . . . . 18\n\n2.1 Navier-Stokes Equations . . . . . . . . . . . . . . . . . . . . . . . . . . 18\n2.2 Non-Newtonian Effects . . . . . . . . . . . . . . . . . . . . . . . . . . . 19\n2.3 Finite Element Method . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n2.3.1 Problem Formulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n2.3.2 Implemented Finite Element . . . . . . . . . . . . . . . . . . . . . . . . . 23\n\n3 TOPOLOGY OPTIMIZATION . . . . . . . . . . . . . . . . . . . . . . . . 25\n\n3.1 Topology Optimization Applied to Fluid Flow . . . . . . . . . . . . . . 26\n3.2 Extended Design Domain . . . . . . . . . . . . . . . . . . . . . . . . . 27\n3.3 Material Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28\n3.4 Problem Definition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n3.4.1 Energy Dissipation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n3.4.2 Shear Stress . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31\n3.4.3 Vorticity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31\n3.4.4 Multi-Objective Function . . . . . . . . . . . . . . . . . . . . . . . . . . . 31\n3.4.5 Volume Constraint . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32\n3.5 Discrete Form . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33\n\n4 SENSITIVITIES CALCULATION . . . . . . . . . . . . . . . . . . . . . . 35\n\n4.1 Adjoint Method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35\n4.2 Energy Dissipation Sensitivity Analysis . . . . . . . . . . . . . . . . . 36\n4.2.1 Sensitivity of Viscosity . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38\n4.3 Vorticity Sensitivity Analysis . . . . . . . . . . . . . . . . . . . . . . . 39\n4.4 Shear Stress Sensitivity Analysis . . . . . . . . . . . . . . . . . . . . . 40\n4.5 Sensitivity Analysis of Multi-Objective Function . . . . . . . . . . . . 41\n\n5 NUMERICAL IMPLEMENTATION . . . . . . . . . . . . . . . . . . . . . 43\n\n5.1 Optimization Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . 43\n\n\n\nCONTENTS 12\n\n5.2 Software Environment . . . . . . . . . . . . . . . . . . . . . . . . . . . 44\n5.2.1 Finite Element Method . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44\n5.2.2 Sensitivities Computation . . . . . . . . . . . . . . . . . . . . . . . . . . 45\n5.2.3 Optimizer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46\n\n6 NUMERICAL RESULTS . . . . . . . . . . . . . . . . . . . . . . . . . . 48\n\n6.1 FEM Verification . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48\n6.2 Topology Optimization Results . . . . . . . . . . . . . . . . . . . . . . 51\n6.2.1 Double Channel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51\n6.2.2 Obstacle . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55\n6.2.3 Arterial Bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57\n6.2.4 Bypass considering Vorticity . . . . . . . . . . . . . . . . . . . . . . . . . 65\n6.2.5 Multi-objective bypass . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67\n6.2.6 3D Difuser . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69\n\n7 CONCLUSIONS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72\n\n7.1 Future Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72\n\nREFERENCES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73\n\n\n\n13\n\n1 INTRODUCTION\n\n1.1 Non-Newtonian Blood Flow\n\nFlow of non-Newtonian fluids presents features that are not described by the linearly\nviscous Newtonian models with a constant value of viscosity. An important subclass of\nnon-Newtonian fluids consists of those whose viscosity depends on the shear rate and/or\non the pressure. These fluids play an important role in various areas of application, for\ninstance, in chemical engineering, geology and also, blood rheology.\n\nBlood is a concentrated suspension of red blood cells (erythrocytes), white blood\ncells (leukocytes), platelets (thrombocytes) in an aqueous polymer solution called plasma.\nThe non-Newtonian effects of whole blood in viscometric flow are closely related to its\nmicroscopic structure (GIJSEN; VOSSE; JANSSEN, 1999), specially at low shear rates.\nThe red blood cells are the dominant components in rheological behavior of blood, mainly\ndue to a significantly higher concentration compared to the other formed cellular elements\n(ROBERTSON; SEQUEIRA; OWENS, 2009). Both shear thinning and viscoelasticity are\nrelated to aggregation, deformation and alignment of these cells, as shown in Fig 1.1.\n\nFigure 1.1 \u2013 Influence of red blood cells in shear thinning effect.\n(a) Equilibrium. (b) Shear thinning effect.\n\nThe study of blood flow plays an important role in disease research, treatment planning\nand design of medical devices. Some of the most relevant medical devices are arterial\nbypass grafts which provide solutions for diseases such as artherosclerosis by creating\nan alternative route around critically blocked arteries (FITZGIBBON et al., 1996) and\nventricular assist devices (VADs) that can be an alternative for patients that present heart\nfailure, specially as temporary solution as they await for a heart transplant (SLAUGHTER\net al., 2013).\n\nSince traditional laboratory experiments are costly and time demanding, Computational\n\n\n\nChapter 1. Introduction 14\n\nFluid Dynamics (CFD) applied to fluid systems dealing with blood flow has been an\nactive area of intensive research. Motivated by problems in biomedical engineering,\nmany studies aim to find an appropriate numerical model of non-Newtonian effects\nin blood flow in order to obtain more accurate results (BOYD; BUICK; GREEN, 2007),\n(HUNDERTMARK-ZAU\u0160KOV\u00c1; LUK\u00c1?OV\u00c1-MEDVID\u2019OV\u00c1, 2010), (EVJU, 2011).\n\nNumerical optimization procedures based on CFD present various advantages when\ncompared to the traditional trial and error method. Thus, many approaches for the design\nof non-Newtonian fluidic systems have been developed.\n\nIn the work of Abraham, Behr and Heinkenschloss (2005), shape optimization was\napplied to efficient design of arterial bypass graft, with the goal of minimizing shear\nstress, which is related to field processes such as damage of red blood cells and platelet\naggregation. In addition, the use of this optimization method for time-dependent domains\nwas studied by Soko?owski and Stebel (2014). Sousa, Castro and Ant\u00f3nio (2010) presented\nan optimization framework that is suited to perform shape optimization of complex\ngeometries in compute-intensive applications by using an genetic algorithm approach.\n\nThis work in particular will model blood as a shear-thinning non-Newtonian fluid and\napply the topology optimization method in order to design efficient channels for conducting\nblood, evaluating the model viscosity effects on the final topology.\n\n1.2 Optimization Methods\n\nAn optimization algorithm is used to find an optimized solution, which can be obtained\nnumerically to accelerate the design process. There are three basic approaches that can be\nused in numerical optimization: parametric optimization, shape optimization and topology\noptimization, as shown in Fig. 1.2. Each one of these approaches is more suitable for a\ntype of application, according to the problem design objectives and restrictions.\n\n\n\nChapter 1. Introduction 15\n\nFigure 1.2 \u2013 Optimization approaches.\n\nAdapted from Koga (2010).\n\nIn parametric optimization, also known as size optimization, the system geometry is\npreviously defined and a basic model is described through some parameters that can be\nrelated to the geometry, material, physical properties, among others. The value of this\nparameters varies until a configuration considered optimized is reached. As an example,\nthe work of Murakami and Mikic (2001) studies the optimization of multi-channel heat\nsinks for electronic devices and the channel diameter, number of channels and flow rate\nare considered as design parameters. This method presents more flexibility when it comes\nto the design variable, that is not necessarily related to the system geometry.\n\nIn shape optimization, the contour boundaries of the system are modified in the\nprocess, aiming to extremize a determined objective function. In this case, the geometry is\nfixed as defined in the initial condition, which means that no holes or connections can be\nincluded in the domain, however its shape is allowed to change. The work of Abraham,\nBehr and Heinkenschloss (2005) shows the optimization of an arterial bypass graft using\nthis method, where the main goal is to reduce the total shear stress in blood flow.\n\nIn topology optimization method (BENDSOE; SIGMUND, 2003), an amount of\nmaterial is distributed inside a domain, in a way of searching the optimal geometry of\nthe system according to a desired characteristic. The use of this technique enables more\ncomplex and non-intuitive solutions to emerge. Thus, it is appropriate for applications\nwhere more freedom to modify the domain is desired. The material distribution over the\ndomain is controlled by a design variable. The design variable of a topology optimization\nproblem is used to determine the absence or presence of material within each point. The\nfinal topology presents a domain distribution described as \"empty\" or \"filled\" with material.\nIn solid mechanics, the material model determines where the structure will be filled with\nsolid material. However, in fluid systems a porous domain is used and the final domain\nshows which portions of the domain will be filled with fluid, and which will be filled with\n\n\n\nChapter 1. Introduction 16\n\na low permeability, representing the \"solid\", indicating the absence of flow.\n\nRecently, researchers have shown interest in applying the topology optimization method\nto devices conducting blood, considering non-Newtonian effects existent in this fluid. There\nare approaches that model the fluid flow through the Navier-Stokes equations, as proposed\nby Hyun, Wang and Yang (2014), Zhang and Liu (2015) and also through the Lattice\nBoltzmann method as shown in the work of Pingen and Maute (2010).\n\nThus, this work focuses in optimizing fluid blood flow devices, taking into account\nnon-Newtonian effects in the dynamic viscosity, through the use of the numerical topology\noptimization procedure based on finite element method. The methodology is applied to\ndesign bi-dimensional channels, considering generic design domains.\n\n1.3 Motivation\n\nThe study of non-Newtonian flow is important in bioengineering, to model correctly\nthe flow of biological fluids. Among these, the most relevant are medical devices dealing\nwith blood, such as bypass grafts and pumping systems, where the main goal is to reduce\nblood cell damage caused by artificial flows.\n\nThe use of computational simulation and optimization algorithms is a valid methodology\nto improve the design process of medical devices for blood flow, reducing its development\ntime. This work studies the issues of blood constitutive behavior on the solution of the\noptimization design problem. The application of topology optimization to these systems\nmakes it possible to obtain non-intuitive designs due to the freedom of domain modifications,\nallowing new borders and fluid regions to emerge.\n\n1.4 Objectives\n\nThe present work aims to develop a methodology for designing optimized channels for\nnon-Newtonian fluid flow, with emphasis on applications in bioengineering field of devices\nconducting blood, by using computer simulation and topology optimization method. The\nchannels obtained should be efficient to conduct blood with low energy consumption and\nreduce damage to blood cells. Thus, the design problem requisites chosen aim to minimize\nenergy dissipation, vorticity and shear stress. In order to achieve more accurate results,\nfluid flow is modeled by incompressible and steady state Navier-Stokes equations, coupled\nwith a viscosity cross model, which takes into account non-Newtonian fluid effects. The\nsystem governing equations are solved numerically by using Finite Element Method (FEM).\nTopology optimization method is used to determine the path to be followed by fluid flow,\nby introducing a porosity model that allows the design variable to vary continuously from\n\n\n\nChapter 1. Introduction 17\n\nsolid to fluid. This procedure is performed by a gradient based optimizer that uses the\ninterior point method.\n\n1.5 Document Outline\n\nThis document is organized as follows. In Chapter 2, the problem governing equations\nare presented and the algebraic system used in the finite element method is shown. In\nChapter 3, the topology optimization method is described and the problem is defined in\nterms of its objective function and constraints. Furthermore, in Chapter 4, the sensitivity\nanalysis by using the adjoint method is introduced. In Chapter 5, it is explained how\nthe numerical implementation is performed, detailing the optimization procedure and the\nsoftware used at each optimization phase. In Chapter 6, the numerical results obtained\nare presented, comparing different viscosity models. Finally, in Chapter 7, some overall\nconclusions are reported and some suggestions of future work are presented.\n\n\n\n18\n\n2 MODELING OF NON-NEWTONIAN\n\nFLOW\n\n2.1 Navier-Stokes Equations\n\nIn this work, the fluid flow will be considered incompressible, laminar and in steady\nstate regime. The system dimensions are chosen to be much larger than blood cells, so that\nfluid flow model based on the continuous assumption can be employed (ROBSON, 2003).\n\nThe fluid motion is described by the Navier-Stokes equations (BORRVALL; PETERSSON,\n2003)\n\n%\n\n(\n?u\n?t\n\n+ ?u \u00b7 u\n)\n\n= ?\u00b7? + f (2.1)\n\nwhere u is the velocity field, % is the mass density and f are field forces and the Cauchy\nStress Tensor ? is defined as\n\n?(u,p) = 2\u00b5?(u) ?pI (2.2)\n\nwhere I denotes the identity tensor, p is the pressure, \u00b5 is the dynamic viscosity, and ?(u)\nis the symmetric gradient given by\n\n?(u) =\n1\n2\n\n(?u + (?u)T ) (2.3)\n\nThe mass conservation equation combined for incompressible flow ( % is constant)\nresults in the following continuity equation\n\n?\u00b7 u = 0 (2.4)\n\nAlso, since the flow is assumed to be in steady state regime, the derivative\n?u\n?t\n\nis null.\nTherefore, we have the Navier-Stokes equations for incompressible steady state flow.\n\n%(?u \u00b7 u) = ?\u00b7 2\u00b5?(u) ??p + f (2.5)\n\n?\u00b7 u = 0 (2.6)\n\nThe topology optimization method distributes regions of solid and fluid through a\ndomain, which makes it necessary to work with a model that is able to combine fluid and\n\n\n\nChapter 2. Modeling of Non-Newtonian Flow 19\n\nsolid behavior. A porous material model is used to simulate the solid regions by imposing\nlocal flow restrictions. The flow through a porous media is described by Darcy\u2019s Law\n(BORRVALL; PETERSSON, 2003):\n\n?u = ?p? f (2.7)\n\nwhere ? is the inverse permeabilty.\n\nThis parameter ? allowsto differentiate low permeability areas (? ??), where the\nflow is blocked, representing solid material, from high permeability areas (? ? 0) where\nthere is unconstrained fluid flow. This material model of flow in porous media is used in\ntopology optimization problems for both newtonian fluids (BORRVALL; PETERSSON,\n2003) and non-newtonian (PINGEN; MAUTE, 2010).\n\nBrinkman\u2019s equation is obtained by introducing a porosity term from Darcy\u2019s Law\ninto Navier-Stokes, given by (HYUN; WANG; YANG, 2014):\n\n%(u \u00b7?u) = ??p + ?\u00b7 2\u00b5?(u) + f ??u (2.8)\n\n2.2 Non-Newtonian Effects\n\nBlood is composed by cellular elements suspended in an aqueous solution called\nplasma. The cellular elements are red blood cells or erythrocytes, white blood cells or\nleukocytes and platelets or thrombocytes. Due to its microscopic structure, this fluid is\nmore accurately represented when modeled as non-Newtonian fluid, where the dynamic\nviscosity \u00b5 is dependent of the shear rate ??, given by the following equation:\n\n?? =\n?\n\n2?(u) : ?(u) (2.9)\n\nwhere the symbol : stands for the double scalar product of two tensors.\n\nWhen related to viscosity effects, non-Newtonian fluids can have two different behaviors.\nIf the viscosity increases with shear rate, the fluid is called dilatant or shear-thickening. If\nthe effective viscosity decreases with shear, then it is called pseudoplastic or shear-thinning,\nwhich is the case of blood. In this work, fluids that present viscoelastic effects will not be\nconsidered.\n\nBlood shear-thinning behavior is mainly related to following aspects of red blood\ncells: the propensity to form microstructures called rouleaux at low shear rates, their\ndeformability, and the flow field alignment at high shear rates (ROBERTSON; SEQUEIRA;\nOWENS, 2009).\n\nA very common model to describe the shear rate dependent viscosity is the Power-Law\n\n\n\nChapter 2. Modeling of Non-Newtonian Flow 20\n\nequation\n\u00b5(??) = K??n?1 (2.10)\n\nwhere K is a positive constant and n is the Power-Law index, which defines the behaviour of\nthe fluid. A Newtonian fluid presents n = 1, whereas for n > 1, the fluid is shear-thickening\nand for n &lt;1, it is shear-thinning (BOEK; CHIN; COVENEY, 2003).\n\nSince the Power-law model applied to shear-thinning fluids presents an infinite dynamic\nviscosity at very low shear rates and zero viscosity at very high shear rates, which can\nlead to numerical instabilities, another model is adopted.\n\nThe blood viscosity model implemented is the Carreau-Yasuda, which given by Equation\n2.11\n\n\u00b5(??) = \u00b5? + (\u00b50 ?\u00b5?)[1 + (???)a]\nn?1\n\na (2.11)\n\nwhere ?, a, n, \u00b5?, \u00b50 are fluid parameters.\n\nThus, for zero shear rate, the viscosity presents a maximum value of \u00b50 = 0.16Pa.s\nand for very high shear rates (approximately > 103s?1) the viscosity value converges to the\nsame as the Newtonian model \u00b5? = 0.0035Pa.s, as verified experimentally (MACOSKO,\n1994). The relation between viscosity and shear rate for blood in the models discussed are\npresented in Figure 2.1.\n\nFigure 2.1 \u2013 Shear rate dependent viscosity for different models (logarithmic scale).\n\n2.3 Finite Element Method\n\n2.3.1 Problem Formulation\n\nThe partial differential equations (PDE) presented in Section 2.1 are solved by\nusing a numerical method, since it is very difficult to solve them analytically. The\n\n\n\nChapter 2. Modeling of Non-Newtonian Flow 21\n\nfinite element method (FEM) is implemented to find the approximate solution of the\nNavier-Stokes equations. This method is especially attractive for problems dealing with\ncomplex geometries, where other numerical methods are difficult to apply.\n\nThe first step for the FEM formulation is to obtain the weak formulation. For this,\na weighted residual procedure is applied. The PDE is multiplied by a test function and\nthe resulting equation is integrated over the domain ?. The Galerkin\u2019s method is used,\nwhere the weighting functions and the unknown fields are represented by the same space\nfunctions. Thus, the stated problem weak formulation is given by (ROMERO; SILVA,\n2014) ?\n\n?\n?u \u00b7 vd? +\n\n?\n?\n%(u \u00b7?u) \u00b7 vd? +\n\n?\n?\n? : ?vd? =\n\n?\n?\n\nf \u00b7 vd? (2.12)\n\n?\n?\nq(?\u00b7 u)d? = 0 (2.13)\n\nwhere v and q are weighting test functions, with q being scalar and v a vector.\n\nThe stress tensor ? is defined by:\n\n? =\n\n?\n?????\n?p + 2\u00b5\n\n?u1\n?x1\n\n\u00b5\n\n(\n?u1\n?x2\n\n+\n?u2\n?x1\n\n)\n\n\u00b5\n\n(\n?u1\n?x2\n\n+\n?u2\n?x1\n\n)\n?p + 2\u00b5\n\n?u2\n?x2\n\n?\n????? (2.14)\n\nThe Finite Element Method is used to find an approximated solution for the weak\nformulation problem, through the discretization of the continuous model, where the\nsolution is evaluated at discrete points over the domain, called nodes. The relation between\napproximated continuous distribution of velocity and pressure and the nodal values, per\nelement, is given by:\n\nu1 ?=\nn?\nj=1\n\n?ju\n1\nj = ?\n\nT u1; u2 ?=\nn?\nj=1\n\n?ju\n2\nj = ?\n\nT u2 (2.15)\n\np ?=\nm?\nj=1\n\n?jpj = ?T p (2.16)\n\nwhere u = [u1u2]T is velocity field, p is the pressure, u1, u2, p are vectors at the nodal\npoints of the approximated solutions,? and ? are interpolation functions defined in Section\n2.3.2, n and m are the number of interpolations nodes per element for velocity and pressure,\nrespectively.\n\nBy replacing the approximation for pressure and velocity fields obtained through finite\nelement interpolation functions in the week formulation, we obtain the algebraic equations\n\n\n\nChapter 2. Modeling of Non-Newtonian Flow 22\n\nfor the finite element method. The matricial coefficients per element are given by:\n\nK? =\n?\n\n?e\n???Tdx;\n\nCj(uj) =\n?\n\n?e\n%?(?T ui)\n\n??\n?xj\n\ndx\n\nKij =\n?\n\n?e\n\u00b5\n??\n?xj\n\n??T\n\n?xi\ndx; (2.17)\n\nQi =\n?\n\n?e\n\n??\n?xi\n\n?Tdx\n\nfi =\n?\n\n?e\n?fidx, i,j = 1, 2; (2.18)\n\nThe global algebraic system, considering two-dimensional case, is defined in the matrix\nform as (ROMERO; SILVA, 2014):\n?\n????\nK? 0 0\n0 K? 0\n0 0 0\n\n?\n????\n?????\n????\n\nu1\nu2\np\n\n?????\n???? +\n\n?\n????\nC1(u1) + C2(u2) 0 0\n\n0 C1(u1) + C2(u2) 0\n0 0 0\n\n?\n????\n?????\n????\n\nu1\nu2\np\n\n?????\n???? +?\n\n????\n2K11 + K22 K12 ?Q1\n\nK21 K11 + 2K22 ?Q2\n?QT1 ?QT2 0\n\n?\n????\n?????\n????\n\nu1\nu2\np\n\n?????\n???? =\n\n?????\n????\n\nf1\nf2\n0\n\n?????\n???? (2.19)\n\nThe resulting system is non-symmetrical and non-linear due to the term C(u). Therefore,\nto solve the system a non-linear solver, based on an iterative Newton method, needs to be\napplied (GERSBORG-HANSEN; SIGMUND; HABER, 2005). The velocity and pressure\nfields are the state variables of the problem, and the residual can be defined in a compact\nform based on Equation 2.19 as\n\nR(z(?),?) = 0 (2.20)\n\nwhere z is a vector that contains all state variables z = [u1 u2 p]T , and it is shown that R\nand state variables z depend on the material model described in Section 3.3.\n\nThe viscosity dependent terms would also introduce non-linearities to the system,\nwhich would lead to an increase of complexity. Thus, the viscosity is calculated with respect\nto the computed velocity field from the previous iteration. This approach of neglecting\nthe non-linear influence of viscosity has shown to be satisfactory, and has been used by\nAbraham, Behr and Heinkenschloss (2005) where the derivative of \u00b5 with respect to u is\ndropped.\n\n\n\nChapter 2. Modeling of Non-Newtonian Flow 23\n\n2.3.2 Implemented Finite Element\n\nThe choice of the problem discretization for the incompressible Navier-Stokes equations\nmust satisfy the Ladyzhenskaya\u2013Babu\u0161ka\u2013Brezzi (LBB or inf-sup) conditions (LOGG et\nal., 2012) in order to obtain a stable configuration. The use of equal-order continuous\nLagrange finite element for both pressure and velocity leads to an unstable problem\n(ABRAHAM; BEHR; HEINKENSCHLOSS, 2005).\n\nOne of the most widely used types of element for solving Navier-Stokes equations that\nsatisfy these LBB conditions is the Taylor\u2013Hood element (TAYLOR; HOOD, 1973). It\nconsists of a continuous polynomial interpolation function of degree r ? 2 for the velocity\ncomponents and a continuous polynomial of degree r ? 1 for the pressure field.\n\nThe finite element used in this work is a triangular Taylor-Hood element, where the\nvelocity has a quadratic interpolation function with six nodes per element and the pressure\nhas a linear interpolation with three nodes. Thus, in Equations 2.15 and 2.16, the sum\nindexes values are n = 6 and m = 3. For the topology optimization process, the design\nvariable is defined to be constant within an element, as shown in the Figure 2.2\n\nFigure 2.2 \u2013 Taylor-Hood mixed elements.\n\nThe interpolation values are calculated in local normalized coordinates ? and ?\n(0 ? ? ? 1 and 0 ? ? ? 1) and then converted to the global coordinates, according to the\nfollowing coordinate transformation for a triangular element with vertices (x1,y1), (x2,y2)\nand (x3,y3)\n\nx = x1 + (x2 ?x1)? + (x3 ?x1)? (2.21)\n\ny = y1 + (y2 ?y1)? + (y3 ?y1)? (2.22)\n\nThe linear pressure interpolation is given by:\n\n?1(?,?) = 1 ? ? ??\n\n?2(?,?) = ? (2.23)\n\n?3(?,?) = ?\n\n\n\nChapter 2. Modeling of Non-Newtonian Flow 24\n\nand the quadratic velocity interpolation in the local coordinates yields:\n\n?1(?,?) = (1 ? ? ??)(1 ? 2? ? 2?)\n\n?2(?,?) = ?(2? ? 1)\n\n?3(?,?) = ?(2? ? 1) (2.24)\n\n?4(?,?) = 4?(1 ? ? ??)\n\n?5(?,?) = 4??\n\n?6(?,?) = 4?(1 ? ? ??)\n\n\n\n25\n\n3 TOPOLOGY OPTIMIZATION\n\nThe topology optimization (BENDSOE; SIGMUND, 2003) is a method that aims\nto design an optimized topology of a defined system in order to extremize a certain\ncharacteristic, which is represented by an objective function. The basic concept of this\noptimization type is that material can be distributed inside a domain, independent of the\ninitial system configuration, by defining which domain point should be filled or empty.\nThis method was originally developed for solving structural solid mechanics problems\n(BENDSOE; KIKUCHI, 1988), (SUZUKI; KIKUCHI, 1991) aiming to minimize mean\ncompliance, where this distribution indicates presence or absence of solid material. In this\nspecific work, where the fluid flow properties are evaluated, the filled parts represent fluid\nmaterial and the empty parts represent solid that defines the contours of the fluid channel\n(BORRVALL; PETERSSON, 2003).\n\nThe implementation of topology optimization arises from the combination of an\noptimization algorithm with an analysis method. The analysis is usually performed by\nusing Finite Element Method, which allows working with complex geometries.\n\nThe design variable, the parameter that will change through the optimization iterations,\nis defined by the model adopted to define the material distribution. Then, the design\ndomain is specified where it is desired to obtain an optimized topology, with its boundary\nconditions. It is also necessary to define the objective function that will be extremized\nalong with the constraints that the system must satisfy.\n\nAfter the complete description of the continuous problem, it is written in its discrete\nform in order to execute the analysis step through the Finite Element Method. The\noptimization algorithm changes the system topology until a convergence criteria is reached.\nThen, the results are post-processed to smooth the edges and it is verified if the system\nrequirements are still consistent before prototype building (S\u00e1, 2016).\n\nFigure 3.1 shows a simplified scheme of the main phases of design using topology\noptimization.\n\n\n\nChapter 3. Topology Optimization 26\n\nFigure 3.1 \u2013 Topology optimization procedure for designing non-Newtonian fluid channels.\n\nAdapted from Koga (2010).\n\n3.1 Topology Optimization Applied to Fluid Flow\n\nThe implementation of topology optimization method (TOM) to fluid systems has\nbeen first introduced by Borrvall e Peterson, where it is applied to two-dimensional flow\nchannel design aiming to minimize viscous energy dissipation (BORRVALL; PETERSSON,\n2003). Fluid flow is modeled by considering steady state Stokes flow. The adopted design\nvariable is the material pseudo-density.\n\nSince then, this theme has been quite explored in literature. Non-linear effects that occur\nfor higher Reynolds numbers and Navier-Stokes constitutive equations (GERSBORG-HANSEN;\nSIGMUND; HABER, 2005), large scale flow and three-dimensional problems (AAGE et\nal., 2008) and flows driven by body forces (DENG; LIU; WU, 2013) have been studied.\n\nIn the work of Klarbring et al. (2003), procedures from truss topology optimization\nare applied to flow networks, related to arterial tree-type networks.\n\nDifferent methods for implementing topology optimization applied to fluid problems\nhave been proposed, such as using the viscosity as design variable (EVGRAFOV, 2005)\nand also modelling the flow using the Lattice- Boltzmann method (PINGEN; EVGRAFOV;\nMAUTE, 2007).\n\nThe topology optimization method has been applied to systems with Stokes and\nDarcy flows coupled, by distributing regions of fluid and regions of porous material, which\nintroduces the need for a regularization method (WIKER; KLARBRING; BORRVALL,\n2007).\n\nRecently, researchers have shown interest in applying the topology optimization method\n\n\n\nChapter 3. Topology Optimization 27\n\nto design devices that conduct blood, by considering the non-Newtonian effects present in\nthis fluid. One of the approaches, proposed by Hyun, Wang and Yang (2014), optimizes the\nfluid flow channel through the Navier-Stokes equations, where a multi-objective function\nis defined by relating reduction of wall shear stress and viscous energy dissipation through\nthe use of different weights.\n\nAnother approach can be found in the work of Pingen and Maute (2010), who has\nimplemented the optimization of bidimensional channel design aiming to reduce the average\npressure drop between inlet and outlet, modelling the non-Newtonian fluid through the\nLattice Boltzmann method.\n\nArterial bypass configurations problems with the objective of minimizing flow shear\nstress have been studied in the work of Zhang and Liu (2015). The topology optimization\nis implemented by using a level set method. The results are compared to the results of\nAbraham, Behr and Heinkenschloss (2005), that are achieved by using shape optimization.\n\n3.2 Extended Design Domain\n\nAn important concept in topology optimization is the extended design domain, which\nconsists in a predetermined fixed region in which the final system configuration must be\ncontained. Within this fixed domain ?, the optimal solution ?f, which represents the\ndistribution of fluidic regions, must be found. Thus, the optimization algorithm works\nwith a domain that is larger than the expected optimal solution. Figure 3.2 illustrates this\nconcept.\n\nFigure 3.2 \u2013 Fixed extended design domain.\n\nThe main advantage of using a fixed domain, since its dimensions remain unchanged,\nis that the finite element mesh does not need to be readjusted during the optimization\nprocess, which makes the numerical implementation easier.\n\n\n\nChapter 3. Topology Optimization 28\n\n3.3 Material Model\n\nAnother essential concept to Topology Optimization Method is the material model\nused which relax the discrete (0-1) problem in order to achieve an optimized solution. In\nthis case, the optimization algorithm uses a density based model.\n\nGiven a domain ? with predefined boundary conditions, it is desired to find in which\nregions of ? must exist fluid and which must be solid in order to minimize (or maximize)\na certain objective function subjected to a constraint of an amount of fluid.\n\nAt the final optimization result, the domain distribution should be discrete, i.e, the\nvalue of the design variable at each point is zero (solid) or one (fluid). Since the discrete\ntopology optimization problem is bad posed, it is usual to work with intermediate values\nduring the optimization process (WIKER; KLARBRING; BORRVALL, 2007). Thus, a\nmaterial model is applied to relax the problem and allow a continuous transition between\nsolid and fluid.\n\nIn the adopted material model, the design variable is the pseudo-density ?, 0 ? ? ? 1,\nwhich represents the amount of fluid present at each point of the domain. The material\nmodel represents a porous material that allows a continuous transition between these two\nstates, through the inverse permeability term, present in Darcy\u2019s equation, as presented in\nSection 2.1.\n\nIn the final optimized topology, the design variable should achieve discrete values\nso that ? = 1 represents a pure fluid and ? = 0 indicates a fully solid material. In\norder to suppress the intermediate values of the pseudo-density ?, non-linear interpolation\nfunctions are adopted for describing the inverse permeability as functions of ? (BORRVALL;\nPETERSSON, 2003), given by\n\n?(?) = ?s + (?f ??s)\n?(1 + q)\n? + q\n\n(3.1)\n\nwhere q is the penalty parameter that controls the linearity of the interpolation function,\n?f = 0 is the inverse permeability for fluid material and ?s ?? is for solid material.\n\nThe influence of the penalty parameter is shown in Figure 3.3, where higher values\nlead to an interpolation function with linear behavior and the distribution of ? in the\ndomain tends to find extreme values (0 or 1). Due to non-convexity, as stated by Borrvall\nand Petersson (2003), when a high value of q is used there might be local optimal solution\nproblems. Thus, the optimization is first solved with a small value of q = 0.01 to obtain a\nbetter initial guess for the problem and then the penalty parameter value is increased in\norder to achieve a discrete solution.\n\n\n\nChapter 3. Topology Optimization 29\n\nFigure 3.3 \u2013 Influence of penalty parameter.\n\nSome authors suggest that the non-Newtonian effects should be reduced in areas of high\nporosity in order to avoid convergence problems. Thus, the viscosity also is interpolated\nas a function of the pseudo-density ?. Hyun, Wang and Yang (2014) proposed a model\nwhere viscosity is interpolated with the same penalty parameter q used for the inverse\npermeability, given by\n\n\u00b5(?) = \u00b5s + (\u00b5f ?\u00b5s)\n?(1 + q)\n? + q\n\n(3.2)\n\nwhere \u00b5f is the shear rate dependent viscosity \u00b5(??) and \u00b5s is equal to the Newtonian\nviscosity (\u00b5? = 0.0035Pa.s).\n\nPingen and Maute (2010) introduced a scaling term (1 ??)K, where K is a constant,\ninto the Carreau-Yasuda viscosity model defined in Equation 2.11, resulting in\n\n\u00b5(??,?) = \u00b5? + (\u00b50 ?\u00b5?)(1 ??)K[1 + (???)a]\nn?1\n\na (3.3)\n\nIn both equations presented, when ? = 1, the material is pure fluid and presents a\nfull non-Newtonian behavior and when ? = 0, the material is solid and the viscosity value\nadopted is numerically equal to the Newtonian viscosity \u00b5?, which can be found in regions\nof high shear rate. This interpolation can be justified by the fact that highly porous or\nsolid material is concentrated in the interfaces between fluid and solid, where the velocity\ngradients are higher and present a minimal value of viscosity, as shown in Section 2.2, and\nin regions where fluid flow is approximately null and can be neglected.\n\n\n\nChapter 3. Topology Optimization 30\n\n3.4 Problem Definition\n\nIn an optimization problem, it is necessary to define the objective function, which\nrepresents the value that must be extremized, the constraints that the problem should\nsatisfy and the design domain with its boundary conditions. The different objective\nfunctions studied will be presented next and the design domain and constraints will be\ndetailed for each case in Section 6.\n\nThe optimization problem in this work is defined by the following formulation\n\nMinimize : c(z(?),?)\n?\n\nsubjected to : g(z(?),?) ? 0\nr(z(?),?) = 0\n?min ? ? ? ?max\n\n(3.4)\n\nwhere c(z(?),?) is a multi-objective function that can include terms of energy dissipation,\nshear stress and vorticity and g(z(?),?) is the volume constraint, described as follows. The\nterm r(z(?),?) represents the problem governing equations defined in Section 2.1 and the\nlimits of the design variable, according with the material model presented are ?min = 0\nand ?max = 1.\n\n3.4.1 Energy Dissipation\n\nMinimizing the energy dissipation is one of the objective functions in this work. For\nthis case, there are no forces applied to the fluid and the fluid velocities are normal to the\nboundaries, thus, to minimize the potential energy dissipation is equivalent to minimize\nthe channel average pressure drop (BORRVALL; PETERSSON, 2003).\n\nThis objective function is valid in many applications, and it is specially important in\napplications where the energy available is restricted, requiring a good performance of the\nchannel in which the fluid flows.\n\nBorvall and Petersson proposed a formulation for the fluidic energy dissipation that\nconsiders the effect of material model, given by\n\n? =\n?\n\n?\n\n1\n2\n\u00b5(?u + ?uT ) : (?u + ?uT )d? +\n\n?\n?\n?(?)u2d? (3.5)\n\nThe first term in the equation corresponds to the viscous dissipation effects present in\nthe fluid flow. The second term corresponds to energy dissipation due to porous media\nmodel and it is introduced to minimize flow through porous and solid regions.\n\n\n\nChapter 3. Topology Optimization 31\n\n3.4.2 Shear Stress\n\nOne important criterion for designing devices for blood flow is to minimize blood\ndamage. Since shear stress in the flow field is related to hemolysis (damage to red blood\ncells) and it also influences processes as platelet aggregation and thrombus formation\n(PROBST et al., 2010), it can be a good indicator of quality in a biomedical application.\n\nA common criteria used in blood flow problems is wall shear stress, which is typically\ndefined on the channel wall. During the optimization process, the interface between solid\nand fluid changes continuously, which makes it difficult to evaluate this parameter.\n\nTopology optimization authors usually consider the shear rate as a representative\nmeasure of shear stress. Thus, we aim to minimize the integral of the squared shear rate\nas an objective function (ABRAHAM; BEHR; HEINKENSCHLOSS, 2005)\n\nJss =\n?\n\n?\n2?(u) : ?(u)d? (3.6)\n\nwhere ?(u) is defined in Equation 2.3.\n\nIt is important to notice that the only difference between this objective function and\nthe previously defined energy dissipation objective function is the absence of the dynamic\nviscosity term.\n\n3.4.3 Vorticity\n\nHigh vorticity is prevalent in turbulent flow and can damage particles flowing in the\ncurrent, causing a loss of material integrity, due to fluid mixing. It can be hazardous to\nsensitive fluids such as blood.\n\nA measure of vorticity can be expressed in the functional given by (QUARTERONI;\nROZZA, 2003; ABRAHAM; BEHR; HEINKENSCHLOSS, 2004):\n\nJv(u) =\n?\n\n?\n|?\u00d7 u|2d? =\n\n?\n?\n\n(\n?u2\n?x1\n?\n?u1\n?x2\n\n)2\nd? (3.7)\n\nAs it is presented in the Results Chapter 6, the energy dissipation due to porous media\nmodel term, presented in Eq.3.5, is introduced in order to achieve discrete results.\n\nJv(u) =\n?\n\n?\n|?\u00d7 u|2d? +\n\n?\n?\n?(?)u2d? =\n\n?\n?\n\n(\n?u2\n?x1\n?\n?u1\n?x2\n\n)2\nd? +\n\n?\n?\n?(?)u2d? (3.8)\n\n3.4.4 Multi-Objective Function\n\nIn the present work, we combine the previous different objective functions to define a\nmulti-objective function based on the weighting sum method, according to the following\n\n\n\nChapter 3. Topology Optimization 32\n\nequation\n? = ?e? + ?vJv + ?sJss, (3.9)\n\nwhere ? is the viscous energy dissipation term, Jv is related to vorticity and Jss represents\ntotal shear stress. ?e,?v and ?s are the weighting coefficients associated with energy\ndissipation, vorticity and total shear stress respectively. Note that the sum ?e+?v+?s = 1.0.\n\nThe functionals of the multi-objective function presented in Equation 3.9 have different\norders of magnitude. Thus, in order to smooth these differences, two coefficients can be\nintroduced (ZHU; ZHANG; FATIKOW, 2014):\n\n?k =\n?k?1\n\nJv\nk?1 , k ? 1 (3.10)\n\n?k =\n?k?1\n\nJss\nk?1 , k ? 1 (3.11)\n\nwhere ?k and ?k are weighting factors which values change at each iteration k of the\noptimization algorithm, calculated with respect the previous iteration k?1. For k = 0 the\nfunctional values for the initial domain distribution are used.\n\nThus, the multi-objective function can be rewritten as\n\n? = ?e? + ?v?kJv + ?s?kJss, (3.12)\n\nwhere energy dissipation ? is the main term of the multi-objective function.\n\nAs follows in Chapter 6, the total shear stress and vorticity objective functions do not\nconverge to a final discrete distribution when are evaluated individually. Satisfactory results\nare obtained only when the term which minimizes flow in porous media (\n\n?\n? ?(?)u2d?) is\n\nincluded. Thus, these functions must combined with the total energy dissipation function or\nwith the porous media term in order to achieve a domain distribution without intermediate\nvalues.\n\n3.4.5 Volume Constraint\n\nAs a constraint, a given fraction of the design domain V is allowed to be occupied by\nfluid and the remaining must be solid, as defined in Equation 3.13.\n\n?\n?\n?d? ? V (3.13)\n\nThis constraint is commonly used in solid mechanics field, to limit the amount of\nmaterial or weight that a system can have. In the studied case, this weight limit is not\n\n\n\nChapter 3. Topology Optimization 33\n\nrelevant, however, it is necessary to apply this constraint in order to not obtain a final\ntopology where the entire domain is filled with fluid, because the value of the function\npresented in Equation 3.5 is minimized when the values of velocity u are reduced, which\noccurs when the area occupied by fluid is augmented.\n\nIn addition, the value of the design variable must be within the range 0 ? ? ? 1, as\ndescribed before, and the Navier-Stokes constitutive equations must be satisfied.\n\n3.5 Discrete Form\n\nIn this section, it will be presented the discrete form of each objective function\npreviously described.\n\nThe discrete form of the energy dissipation objective function is defined by (ROMERO;\nSILVA, 2014):\n\n? =\n1\n2\nuT(K?d + K??)u =\n\n1\n2\nzTCz (3.14)\n\nwhere the vector z = [u1 u2 p]T and the matrix C are given by\n\nC =\n?\n?K?d + K?? 0\n\n0 0\n\n?\n? (3.15)\n\nK?d =\n?\n?2K11 + K22 K12\n\nK21 K11 + 2K22\n\n?\n? (3.16)\n\nK?? =\n?\n?K? 0\n\n0 K?\n\n?\n? (3.17)\n\nand the matrices K? and Kij are defined in Section 2.3.\n\nThe discrete form of the vorticity objective function is obtained by performing the\nnumerical integration of functional presented in Equation 3.7.\n\nJ(u) =\nne?\ne=1\n\n?\n?e\n\n(\n?u2\n?x1\n?\n?u1\n?x2\n\n)2\nd? =\n\nne?\ne=1\n\nueT Mv,eue, (3.18)\n\nwhere ne is the total number of elements, the underscript e indicates that the matrices\nare assembled per element, u = [u1u2]T u1, u2 are vectors with nodal values of velocity in\nthe x1 and x2 directions, respectively, and the local matrix Mv,e is defined as\n\nMv,e =\n?\n?M11v,e M12v,e\nM21v,e M\n\n22\nv,e\n\n?\n? , (3.19)\n\n\n\nChapter 3. Topology Optimization 34\n\nwhere\n\nM11v,e =\n?\n\n?e\n\n(\n??\n?x2\n\n??T\n\n?x2\n\n)\nd?; M12v,e = ?\n\n?\n?e\n\n(\n??\n?x2\n\n??T\n\n?x1\n\n)\nd?; (3.20)\n\nM21v,e = ?\n?\n\n?e\n\n(\n??\n?x1\n\n??T\n\n?x2\n\n)\nd?; M22v,e =\n\n?\n?e\n\n(\n??\n?x1\n\n??T\n\n?x1\n\n)\nd?; (3.21)\n\nand ? are interpolation functions for the triangular element presented in Section 2.3.2.\n\nThe discrete form of shear stress functional is expressed by:\n\nJss =\n1\n2\nuT(K?s)u (3.22)\n\nwhere the matrix K?s is defined by\n\nK?s =\n?\n?2Ks11 + Ks22 Ks12\n\nKs21 Ks11 + 2Ks22\n\n?\n? (3.23)\n\nwith the following matricial coefficients:\n\nKsij =\n?\n\n?e\n\n??\n?xj\n\n??T\n\n?xi\ndx (3.24)\n\n\n\n35\n\n4 SENSITIVITIES CALCULATION\n\nIn this work, a gradient-based optimization algorithm is used, which requires the\nderivative of the model output with respect to its input parameters, i.e, the derivative\nof the functional of interest in relation to the design variable must be calculated. The\nsensitivities calculation is computed through the adjoint method (FUNKE, 2013).\n\n4.1 Adjoint Method\n\nIn the development of this section, the following considerations are taken in to account:\nF(u,m) = 0 is the forward model defined by the PDE of the governing equations, where\nm is the design variable and u is the solution vector. J(u,m) is the defined functional of\ninterest.\n\nThus, the calculation of the total derivative dJ\ndm\n\ncan be done by applying the chain\nrule\n\ndJ\n\ndm\n=\n?J\n\n?u\n\ndu\n\ndm\n+\n?J\n\n?m\n(4.1)\n\nThe derivative of u is obtained by taking the derivative of the FEM system of equations\n(forward model), since the PDE operator F is defined in explicit form.\n\n?F\n\n?u\n\ndu\n\ndm\n+\n?F\n\n?m\n= 0 (4.2)\n\ndu\n\ndm\n= ?\n\n(\n?F\n\n?u\n\n)?1\n?F\n\n?m\n(4.3)\n\nThus, the desired derivative is given by\n\ndJ\n\ndm\n= ?\n\n?J\n\n?u\n\n(\n?F\n\n?u\n\n)?1\n?F\n\n?m\n+\n?J\n\n?m\n(4.4)\n\nThe adjoint vector ?? is defined as\n\n?? = ?\n?J\n\n?u\n\n(\n?F\n\n?u\n\n)?1\n(4.5)\n\nwhere ? represents the complex conjugate of the transpose.\n\nTo summarize, the adjoint method first solves the adjoint equation\n\n?F?\n\n?u\n? =\n\n?J?\n\n?u\n(4.6)\n\n\n\nChapter 4. Sensitivities Calculation 36\n\nand then uses the adjoint solution to compute the functional gradient.\n\ndJ\n\ndm\n= ???\n\n?F\n\n?m\n+\n?J\n\n?m\n(4.7)\n\n4.2 Energy Dissipation Sensitivity Analysis\n\nThe gradient of the objective function ? is calculated by using the adjoint method\ndescribed in Section 4.1.\n\nThe gradient of energy dissipation with respect to the design variable ?i is obtained\nby differentiating Equation 3.14. Notice that the matrix C is symmetric, thus CT = C.\n\n??\n??i\n\n=\n1\n2\n\n?\n?( ?z\n\n??i\n\n)T\nCz + zT\n\n?C\n??i\n\nz + zT C\n?z\n??i\n\n?\n? = 1\n\n2\nzT\n?C\n??i\n\nz + zT C\n?z\n??i\n\n(4.8)\n\nThe derivative\n?z\n??i\n\ncan be obtained through the FEM equilibrium equation. The\nresidual R is given by:\n\nR = KGz ? F (4.9)\n\nwhere\n\nKG =\n?\n?C(u) + K ?Q\n?QT 0\n\n?\n? (4.10)\n\nThus, by differentiating Equation 4.9 with respect to the design variable ?\n\ndR\nd?i\n\n=\n?R\n?z\n\ndz\nd?i\n\n+\n?R\n??i\n\n(4.11)\n\nwhere\n?R\n?z\n\n= J is the Jacobian matrix resulting from the application of Newton\u2019s method\nto the solution of the nonlinear system.\n\nThus,\nJ\ndz\nd?i\n\n= ?\n?R\n??i\n\n= ?\n?Kg\n??i\n\nz +\n?F\n??i\n\n= ri (4.12)\n\nFrom Equation 4.12,\ndz\nd?i\n\n= J?1ri (4.13)\n\nwhere the vector ri is calculated for each element i in the domain. Therefore, the second\nterm of Equation 4.8 becomes\n\nzT C\n?z\n??i\n\n= zT CJ?1ri = ST ri (4.14)\n\n\n\nChapter 4. Sensitivities Calculation 37\n\nST = zT CJ?1 (4.15)\n\nThe following linear system is obtained by rearranging the previous expressions\n\nJT S = Cz (4.16)\n\nThus, the vector S is calculated by solving the above linear system. This system is\nindependent of the derivative with respect to design variable ?, so it is solved once per\niteration of the optimization process by using the velocity field u computed in the previous\niteration. Then, by replacing the vector S in Equation 4.15, the unknown term\n\n?z\n??i\n\nand\nthus, the energy dissipation gradient is obtained.\n\nThe sensitivity of\n?C\n??i\n\ncan be computed as a sum of the gradients of K?? and K?d with\nrespect to the design variable.\n\n?C\n??i\n\n=\n\n?\n???\n?K?d\n??i\n\n+\n?K??\n??i\n\n0\n\n0 0\n\n?\n??? (4.17)\n\nThese gradients are calculated by\n\n?K??\n??i\n\n=\n??(?i)\n??i\n\n?\n?k?,e 0\n\n0 k?,e\n\n?\n? (4.18)\n\n?K?d\n??i\n\n=\n?\u00b5(?i)\n??i\n\n?\n?k11,e k12,e\nk21,e k22,e\n\n?\n? (4.19)\n\nwhere the matrix coefficients k? and kij, independent from the design variable ?, are\ndefined as:\n\nk?,e =\n?\n\n?\n??Tdx; (4.20)\n\nkij,e =\n?\n\n?\n\n??\n?xj\n\n??T\n\n?xi\ndx, i,j = 1, 2;\n\nFrom Equation 3.1 it is obtained:\n\n??(?)\n??i\n\n= (?f ??s)\nq(q + 1)\n(q + ?)2\n\n(4.21)\n\nThe term \u00b5(?) is also dependant of the shear-rate. Thus, it is necessary to apply the\n\n\n\nChapter 4. Sensitivities Calculation 38\n\nchain rule to obtain the viscosity derivative:\n\n?\u00b5(??)\n??i\n\n=\n?\u00b5(??)\n?u\n\n?u\n??i\n\n(4.22)\n\nWhen a viscosity interpolation is applied, its derivative should also be considered. For\nthe interpolation presented in Equations 3.2 the derivative with the respect to the design\nvariable is:\n\n?\u00b5(?)\n??i\n\n= (\u00b5f (??) ?\u00b5s)\nq(q + 1)\n(q + ?)2\n\n+\n?\u00b5f (??)\n??i\n\n?(1 + q)\n(? + q)\n\n(4.23)\n\nand for the interpolation present in Equation 3.3, we have\n\n?\u00b5(?)\n??i\n\n= (\u00b50?\u00b5?)\n{\n?K(1 ??)K?1[1 + (???a]\n\nn?1\na ] + (1 ??)K(n? 1)(???)a?1[1 + (???)a]\n\nn?1?a\na\n\n???\n\n??i\n\n}\n(4.24)\n\nwhere the derivative of the shear rate is calculated by\n\n???\n\n??i\n=\n???\n\n?u\n?u\n??i\n\n(4.25)\n\n4.2.1 Sensitivity of Viscosity\n\nAs described before, in order to obtain the gradient of the matrix C, the derivative\n?\u00b5f (??)\n?u\n\nmust be computed.\n\nConsidering the shear rate for bi-dimensional flow, Equation 2.9 becomes:\n\n?? =\n?\n?2\n(\n?u1\n?x1\n\n)2\n+ 2\n\n(\n?u2\n?x2\n\n)2\n+\n(\n?u1\n?x2\n\n+\n?u2\n?x1\n\n)2??1/2 (4.26)\nThe derivative of viscosity with respect to velocity is obtained by the chain rule:\n\n?\u00b5f (??)\n?u\n\n=\n?\u00b5f (??)\n???\n\n???\n\n?u\n(4.27)\n\nwhere the first term corresponds to the derivative of Equation 2.11\n\n?\u00b5f (??)\n???\n\n= (n? 1)?(\u00b50 ?\u00b5?)[1 + (???)a]\nn?1\n\na\n?1(???)a?1 (4.28)\n\nFrom Equation 4.26,\n\n???\n\n?u1\n= ???1\n\n[\n2\n?u1\n?x1\n\n??\n\n?x1\n+\n(\n?u1\n?x2\n\n+\n?u2\n?x1\n\n)\n??\n\n?x2\n\n]\n(4.29)\n\n\n\nChapter 4. Sensitivities Calculation 39\n\n???\n\n?u2\n= ???1\n\n[\n2\n?u2\n?x2\n\n??\n\n?x2\n+\n(\n?u1\n?x2\n\n+\n?u2\n?x1\n\n)\n??\n\n?x1\n\n]\n(4.30)\n\nwhere ? is the velocity interpolation function defined in Section 2.3.2\n\nThus, the system can be represented using the matrix form:\n\n???\n\n?u\n= ???1Mgu (4.31)\n\nwhere\n\nMg =\n\n?\n????\n\n2\n??\n?x1\n\n??T\n\n?x1\n+\n??\n?x2\n\n??T\n\n?x2\n\n??\n?x2\n\n??T\n\n?x1\n??\n?x1\n\n??T\n\n?x2\n2\n??\n?x2\n\n??T\n\n?x2\n+\n??\n?x1\n\n??T\n\n?x1\n\n?\n???? (4.32)\n\n4.3 Vorticity Sensitivity Analysis\n\nThe vorticity sensitivity is obtained by differentiating Equation 3.7 with respect to\ndesign variable ? (ROMERO; SILVA, 2014).\n\ndJv\nd?i\n\n=\nduT\n\nd?i\nMvu + uT\n\n?Mv\n??i\n\nu + uT Mv\ndu\nd?i\n\n(4.33)\n\nSince Mv is not a direct function of the design variable ?, ?Mv??i = 0, thus\n\ndJ\n\nd?i\n= uT\n\n(\nMv + MTv\n\n) du\nd?i\n\n(4.34)\n\nThe term du\nd?i\n\ncan be obtained from system FEM equations and with the use of an\nauxiliary matrix LT the velocities are isolated from the vector z\n\nu = LT z =?\ndu\n?i\n\n= LT\ndz\n?i\n, (4.35)\n\nwhere LT is defined as:\nLT = [In\u00d7n 0n\u00d7m]. (4.36)\n\nThe matrix L is composed by identity matrix I, of dimension (n\u00d7n), where n is the\nnumber of degrees of freedom of velocity, and an array of dimension (n\u00d7m) which consists\nonly of zeros, where m is the number of pressure degrees of freedom.\n\nFrom Equations 4.13 and 4.35\n\ndz\nd?i\n\n= J?1ri =?\ndu\nd?i\n\n= LT J?1ri (4.37)\n\n\n\nChapter 4. Sensitivities Calculation 40\n\nBy replacing Equation 4.34 on Equation 4.37, we obtain:\n\ndJ\n\nd?i\n= uT\n\n(\nMv + MTv\n\n)\nLT J?1ri = STv ri (4.38)\n\nwhere,\nSTv = u\n\nT\n(\nMv + MTv\n\n)\nLT J?1. (4.39)\n\nBy rearranging the previous expression, we obtain the linear system\n\nJT Sv = L\n(\nMv + MTv\n\n)\nu. (4.40)\n\nThe Sv vector is obtained by solving this linear system. This system is solved once\nper iteration of the optimization process, since it is independent of the derivative with\nrespect to the design variable. It depends on the previous velocity field u and the residual\nR is assumed to be zero. The vector ri, from Equations 4.38, given by Equation 4.12, is\ncalculated for each element i within the domain ?.\n\n4.4 Shear Stress Sensitivity Analysis\n\nThe gradients of shear stress objective function with respect to the fluid pseudo-density\n? is obtained by using the same method as described before.\n\ndJss\nd?i\n\n=\n1\n2\n\n?\n?(?u\n\n??i\n\n)T\nK?su + uT\n\n?K?s\n??i\n\nu + uT K?s\n?u\n??i\n\n?\n? (4.41)\n\nSince the matrix K?s is independent of the design variable,\n?K?s\n??i\n\n= 0 and thus\n\ndJss\nd?i\n\n= uT\n(\nK?s + K?s\n\nT\n) du\nd?i\n\n(4.42)\n\nThe derivative du\nd?i\n\ncan be obtained as described before in Equation 4.37.\n\ndJss\nd?i\n\n= uT\n(\nK?s + K?s\n\nT\n)\n\nLT J?1ri = STs ri (4.43)\n\nThe considerations for the system above and the vectors St and ri are the same as\nstated for the energy dissipation and vorticity objective functions.\n\n\n\nChapter 4. Sensitivities Calculation 41\n\n4.5 Sensitivity Analysis of Multi-Objective Function\n\nThe gradient of multi-objective function (Eq. 3.12) is given by:\n\nd?\n\nd?i\n= ?e\n\nd?\nd?i\n\n+ ?v?k\ndJv\nd?i\n\n+ ?v\n??k\n??i\n\ndJv + ?ss?k\ndJss\nd?i\n\n+ ?ss\n??k\n??i\n\ndJss (4.44)\n\nThe sensitivities of ?k and ?k are terms that arise due to the derived chain rule. Since\n?k and ?k represent constant values within each iteration, the derivative of these terms\nwith respect to design variable ? is null. Thus, (ZHU; ZHANG; FATIKOW, 2014):\n\n??k\n??i\n\n= 0 (4.45)\n\n??k\n??i\n\n= 0 (4.46)\n\nThus, we can define a simplified gradient of the multi-objective function for each\noptimization iteration as:\n\nd?\n\nd?i\n= ?e\n\nd?\nd?i\n\n+ ?v\ndJv\nd?i\n\n+ ?ss\ndJss\nd?i\n\n(4.47)\n\nThe terms d?\nd?i\n\n, dJv\nd?i\n\nand dJss\nd?i\n\n, which correspond to energy, vorticity and shear stress\nsensitivities, respectively, have been calculated previously.\n\nThe energy dissipation sensitivity is\n\n??\n??i\n\n=\n1\n2\nzT\n?C\n??i\n\nz + zT CJ?1ri (4.48)\n\nThe vorticity sensitivity term is\n\ndJ\n\nd?i\n= uT\n\n(\nMv + MTv\n\n)\nLT J?1ri (4.49)\n\nAnd the shear stress sensitivity contribution is\n\ndJ\n\nd?i\n= uT\n\n(\nK?s + K?s\n\nT\n)\n\nLT J?1ri (4.50)\n\nIn order to obtain the multi-objective sensitivity, the equations above can be calculated\nseparately and its results replaced in Eq. 4.47. However, it is also possible to combine\nthe three adjoint problems in a way that only one final adjoint equation related to the\nmulti-objective function needs to be solved. Thus, by replacing the adjoint equations above\n\n\n\nChapter 4. Sensitivities Calculation 42\n\nin Eq. 4.47:\n\nd?\nd?i\n\n= ?e\n[\n\n1\n2\nzT\n?C\n??i\n\nz + zT CJri\n]\n+?v?kuT\n\n(\nMv + MTv\n\n)\nLT J?1ri+?s?kuT\n\n(\nK?s + K?s\n\nT\n)\n\nLT J?1ri\n(4.51)\n\nBy packing the terms, it is obtained\n\nd?\nd?i\n\n= ?e\n1\n2\nzT\n?C\n??i\n\nz +\n[\n?ezT C + ?v?kuT\n\n(\nMv + MTv\n\n)\nLT + ?s?kuT\n\n(\nK?s + K?s\n\nT\n)\n\nLT\n]\nJ?1ri\n(4.52)\n\nIn a simplified notation:\n\nd?\nd?i\n\n= ?e\n1\n2\nzT\n?C\n??i\n\nz + SmJ?1ri (4.53)\n\nwhere Sm is obtained from the solution of the system:\n\nJT Sm =\n[\n?eCz + ?v?kL\n\n(\nMv + MTv\n\n)\nu + ?s?kL\n\n(\nK?s + K?s\n\nT\n)\n\nu\n]\n\n(4.54)\n\nIn Equation 4.53, the vector ri, given by Equation 4.12, is calculated for each element\ni in the domain, and J, is the Jacobian matrix resulting from the application of Newton\u2019s\nmethod to the solution of nonlinear system.\n\n\n\n43\n\n5 NUMERICAL IMPLEMENTATION\n\n5.1 Optimization Algorithm\n\nIn order to determine the distribution of fluid and solid material within a design\ndomain, finite element method and an optimization algorithm are combined in an iterative\nprocess, described bellow. In this work, a gradient based algorithm is used, where the\ngradient information with respect to the desired functional is evaluated and gives the\ndirection to update the design variables values.\n\nFirst, the initial system information (design domain, boundaries) is defined and then\nthe Navier-Stokes equations are solved by using finite element method. The value of the\nobjective function and constraints are calculated with respect to the current distribution of\n? and u. Then, adjoint equations are solved in order to calculate the functional sensitivities\nthat will be used by an optimizer to update the design variable.\n\nThis iterative process is repeated until convergence is reached, resulting in the final\nmaterial distribution. Figure 5.1 presents the simplified flow chart for the implementation\nof the topology optimization method.\n\nFigure 5.1 \u2013 Topology optimization implementation flow chart.\n\nThe stopping criteria for the iterative process described is given by\n\n? ?k ??k?1 ??? 1 \u00d7 10?3 (5.1)\n\nwhere ? is the design variable distribution and k is the iteration number.\n\n\n\nChapter 5. Numerical Implementation 44\n\n5.2 Software Environment\n\nTo implement the optimization software, the OpenSource FEniCS environment combined\nwith Dolfin-Adjoint library and IPOpt optimizer package will be used. This software\ncollection allows the automation of solving mathematical models based on partial differential\nequations by using Finite Element Method, through an interface written in high level code,\nwhere the PDE is described in the weak formulation.\n\nThus, it is possible to focus on the development and test of different formulations to\nthe proposed problem, instead of spending time coding ordinary tasks related to most\nnumerical simulation software, as assembly of FEM matrices and system equation solvers.\n\nThis section will give a more detailed description of how this packages and libraries\nare used within the topology optimization procedure.\n\n5.2.1 Finite Element Method\n\nThe finite element method is implemented by using the OpenSource FEniCS environment\n(ALN\u00e6S et al., 2015), which consists of a collection of software components for automating\nthe solution of PDEs. It has modules that receive the problem weak formulation in a\nmathematical syntax and assemble the FEM problem in a language that can be interpreted\nby the computer.\n\nIn listing 5.1, it is exemplified how the FEniCS coding (this case in Python) is similar\nto a mathematical formulation.\n\nListing 5.1 \u2013 FEM coding using FEniCS/Dolfin-Adjoint notation..\n\nI = Identity (U. c e l l ( ) . topological_dimension ( ) )\nT = ?pI + 2.0? v i s c ( rho , u )?( grad (u)+grad (u ) .T) #s t r e s s t e n s o r\n\nF = dens ? inner ( dot ( grad (u ) , u ) , v) ? dx \\\n+ alpha ( rho )? inner (u , v)?dx \\\n+ inner (T, grad (v )) ? dx \\\n? q?div (u)?dx\n\nThe FEniCS main feature relies on a form compiler for compilation of code for\nindividual forms. A Form Compiler is a type of software that can interpret equations\nwritten in a high-level language and generate a numerical routine to solve them. The\nFEniCS Form Compiler (FFC) is responsible for interpreting an input equation described in\nweak variational form through UFL (Unified Form Language) and generating an optimized\nlow level code (C++) of finite element assembly in UFC (Unified Form-Assembly Code).\nThe UFC code is combined with mesh and coefficient data, in order to assemble the FEM\ntensors.\n\n\n\nChapter 5. Numerical Implementation 45\n\nThe communication between all FEniCS modules is handled by Dolfin (LOGG et al.,\n2012), a library coded in C++/Python, which works as the main user interface of FEniCS.\nDolfin is organized as a collection of FEniCS components and external software modules,\neach one covering a certain area of functionality, such as: linear algebra, meshes, finite\nelements, functions and solvers.\n\nSome of the most important functionalities from external software are provided by\nthe linear algebra libraries PETSc, Trilinos, uBLAS and MTL4 and the mesh partitioning\nlibraries ParMETIS and SCOTCH.\n\nThe Finite Element equations lead to large sparse system which is non-linear and\nnon-symmetrical, thus, an iterative solver, a more complex method than the basic\nNewton method is needed to guarantee the solution convergence. The FEniCS system\noffers pre-installed support methods such as Generalized minimal residual (Gmres) and\nBiconjugate gradient stabilized (Bicstab), that are also commonly used on Navier-Stokes\nproblems. In this work, the Multifrontal Massively Parallel Sparse direct Solver (MUMPS)\n(MUMPS Guide, 2011) and a preconditioner that is the combination of the Incomplete\nLU factorization (ILU) and Block Jacobi iteration (Bjacobi) have been adopted.\n\n5.2.2 Sensitivities Computation\n\nSince it is used a gradient-based optimizer, it is necessary to derive the functional of\ninterest in relation to design variable ?. The sensitivities calculation is performed through\nthe adjoint method, as defined in Section 4.\n\nThe implementation of the adjoint method can be based in one of the three steps\nneeded to solve a Finite Element problem, as shown in Figure 5.2: the continuous FEM\nequations, the discrete FEM equations or the FEM implemented code. The resulting\nadjoint system will be at the same discretization stage as the model from which it is was\nderived. That is, the continuous adjoint equations are continuous PDE, the discrete adjoint\nequation are discrete PDE and the adjoint of the source code is an implementation of\nthese discrete PDE.\n\n\n\nChapter 5. Numerical Implementation 46\n\nFigure 5.2 \u2013 Approaches of computing the adjoint problem.\n\nadapted from Funke (2013).\n\nThe continuous adjoint equations are obtained by deriving the adjoint system prior\nto the discretization of the PDE. This implies that the discontinuities that arrive from\nnumerical methods can be avoided. Obtaining the continuous adjoint system requires\na complex implementation due to manual derivation which increases considerably the\ndevelopment work.\n\nIt is possible to compute the derivatives with algorithmic differentiation at the last\nstage of the FEM implementation. This approach is performed at the lower level, i.e., the\nsource code. The applicability can be limited and it also requires extensive user intervention\nand expertise.\n\nThe implemented method, illustrated as the highlighted path in Figure 5.2, consists in\nthe adjoint derivation of the discrete equations. The main advantages obtained are that\nthis derivation is performed independently of implementation details and the resulting\ngradient information is consistent with discrete finite element model.\n\nThe software library libadjoint (FUNKE, 2013) receives a high-level representation\nof the FEM equations and derives high-level representation of the adjoint model. It is\nresponsible for assembling and solving the adjoint equations. The interface with FEniCS\nsoftware platform is managed by the Dolfin-Adjoint package.\n\n5.2.3 Optimizer\n\nThe optimization algorithm used in this work is implemented through the optimizer\nIPOpt, which stands for Interior Point Optimizer (W\u00c4CHTER; BIEGLER, 2006). It is an\nopen source software package for large-scale nonlinear optimization, written in Fortran 77\nand compatible with FEniCS and Python language.\n\nThe implemented algorithm uses a primal-dual barrier method with a filter line-search\n\n\n\nChapter 5. Numerical Implementation 47\n\nmethod to solve nonlinear optimization problems which will be assumed to be stated in\nthe generic form:\n\nMinimize : f(x)\nx ? Rn\n\nsubjected to: c(x) = 0\nx ? 0\n\n(5.2)\n\nIn order to avoid the problem of identifying the active bound constraints, the problem\nconstraints are replaced by a logarithmic barrier term which is added to the objective\nfunction, resulting in the following barrier problem:\n\nMinimize : ?\u00b5(x) = f(x) ?\u00b5\nn?\ni=1\n\nln(xi)\n\nx ? Rn\n\nsubjected to: c(x) = 0\n\n(5.3)\n\nwhere ?\u00b5(x) is the barrier function, \u00b5 > 0 is the barrier parameter which determines the\ndegree of influence of the barrier term \u00b5\n\nn?\ni=1\n\nln(xi).\n\nThe global convergence of the optimization is enforced by using filter line search\napproaches, in which the basic concept is to accept trial points that improve the objective\nfunction or improve the constraint violation instead of a combination of those two measures\ndefined by a merit function. Thus, the barrier problem can be interpreted as a bi-objective\nproblem with the two goals of minimizing the objective function ?\u00b5j (x) and the constraint\nviolation ?(x) = ||c(x)||.\n\nA strategy for solving the original problem is to compute the solutions for a sequence\nof barrier problems with a decrease sequence of barrier parameters \u00b5k converging to zero,\nwhere the solution of the next barrier problem continues from the approximate solution of\nthe previous one. The algorithm ends when the error for the barrier problem \u00b5k+1 ?\u00b5k\nsatisfies a certain specified tolerance.\n\n\n\n48\n\n6 NUMERICAL RESULTS\n\nIn this chapter, numerical examples are presented to illustrate the proposed methods for\nnon-Newtonian fluid finite element modeling and topology optimization. Blood properties\nhave been adopted, where mass density is % = 1056kg/m3 and the viscosity parameters for\nthe Carreau-Yasuda model, defined in Section 2.2, are shown in Table 6.1 (ABRAHAM;\nBEHR; HEINKENSCHLOSS, 2005).\n\nTable 6.1 \u2013 Carreau-Yasuda parameters for blood.\n\nParameter Value\na 0.64\nn 0.2128\n? 8.2\n\u00b5? 0.0035Pa.s\n\u00b50 \u00b50 = 0.16Pa.s\n\nFirstly, the finite element method for non-Newtonian fluids is validated with a backward\nfacing step problem. Then, optimized topologies for bi-dimensional channels are presented\nby comparing the constant viscosity model with shear-thinning model. Then, arterial\nbypass graft results are shown, for cases where the artery is fully or partially blocked.\nFinally, the method is extended to a tri-dimensional problem, and a 3D diffuser is presented.\n\n6.1 FEM Verification\n\nThe fluid flow over a two-dimensional backward-facing step is analyzed to verify the\nnon-Newtonian fluid model implemented. The results obtained are compared with the\nwork of Siebert and Fodor (2009), in which a case study for different blood viscosity models\nin commercial software COMSOL Multiphysics is presented.\n\nThe investigated problem consists of fluid flow inside a bi-dimensional 10cm long\nchannel with a backward-facing step of 2cm length and 1mm height. The considered\nboundary conditions are presented in Figure 6.1: no-slip conditions at the top and bottom\nwalls, a parabolic velocity profile at the inlet, with maximum velocity Umax = 0.025m/s\nfor the first case and Umax = 0.8m/s for the second case, and zero pressure at the outlet.\n\n\n\nChapter 6. Numerical Results 49\n\nFigure 6.1 \u2013 Backward facing step problem.\n\nIn Siebert and Fodor (2009), the Power-law, Carreau and Newtonian viscosity models\nare studied. In this work, Newtonian and Carreau-Yasuda models are used for the\noptimization problems. Even though the literature reference uses the Carreau model, for\nthis finite element verification, the Carreau-Yasuda and Newtonian models are implemented\nand compared with this reference. The comparison is still valid since the Carreau model\npresents the same constitutive equation as the Carreau-Yasuda, however with different\nconstants and thus, having a very similar shear-thinning behavior.\n\nThe velocity profiles for the newtonian model and two different velocities are shown in\nFig. 6.2. The velocity profiles for the Carreau-Yasuda model are shown in Fig. 6.3. The\ninfluence of inlet maximum velocity can be noted in both figures. We observe that in the\nhigh velocity case a vortex arises near the backward step. Also, the maximum velocity\ndecays faster in the low velocity case, and the flow profile becomes developed very close to\nthe step.\n\nFigure 6.2 \u2013 Velocity profile for newtonian model. (a) Umax = 0.025m/s. (b) Umax = 0.8m/s.\n\nFigure 6.3 \u2013 Velocity profile for Carreau-Yasuda model. (a) Umax = 0.025m/s. (b) Umax =\n0.8m/s.\n\nThese velocity profiles for the newtonian and non-newtonian are very similar however,\n\n\n\nChapter 6. Numerical Results 50\n\nthey are consistent with previous works (SIEBERT; FODOR, 2009). Taking a closer look\nat the profiles we can observe some differences, as shown in Fig. 6.5, in which a section of\nthe velocity profile is taken at the outlet for each case.\n\nFigure 6.5 shows a comparison of the velocity profiles at the outlet, which, again,\ncorrespond to the profiles obtained by Siebert and Fodor (2009) (Fig.6.4). It can be\nobserved that for a lower inlet velocity, the non-Newtonian profiles are flatter at the\ncenter and exhibit larger velocity gradients towards the walls. Also, for higher speeds, the\nshear-thinning dynamic viscosity converges to Newtonian value, which leads to almost\nidentical outlet profiles.\n\nEven though the viscosity model adopted in this work is the Carreau-Yasuda, the\nresults are very similar to the Carreau model and presented the same shear-thinning\ncharacteristics.\n\nFigure 6.4 \u2013 Velocity profile obtained in literature: (a) Umax = 0.025m/s and (b) Umax =\n0.8m/s.\n\nAdapted from Siebert and Fodor (2009) by interpolating the points.\n\nFigure 6.5 \u2013 Velocity profile at the outlet for different viscosity models obtained with FEniCS:\n(a) Umax = 0.025m/s and (b) Umax = 0.8m/s.\n\n\n\nChapter 6. Numerical Results 51\n\n6.2 Topology Optimization Results\n\nIn this section, it will be presented the results obtained by applying the method\ndescribed in Chapter 3 to design of blood flow channels, where the fluid is modeled as\nNewtonian and Non-Newtonian with Carreau-Yasuda viscosity (Eq. 2.11).\n\n6.2.1 Double Channel\n\nThe double channel problem is the classical example of topology optimization applied\nto fluid flow. First, the results will be compared with the Stokes formulation and fictional\nproperties (% = 1), as studied by Borrvall and Petersson (2003). Then, optimization\nconsidering blood flow will be studied. The viscosity is modelled as constant Newtonian\nfluid with viscosity \u00b5 = 1. The objective function adopted aims to minimize the energy\ndissipation (Equation 3.5).\n\nAlthough in the example presented in Section 6.1 the non-Newtonian velocity profile\nobtained presents a more flattened distribution at the center, in this case, a parabolic\nvelocity profile is adopted in order to compare the results for different viscosity models\nand also confront them with the existing literature. The boundary conditions and design\ndomain for the optimization problem are presented in Figure 6.6.\n\nFigure 6.6 \u2013 Double channel problem.\n\nThe volume constraint imposed limits in the total amount of fluid to 1/3 of the domain.\nThe adopted values for inverse permeability, as defined in Equation 3.1, are: ?f = 0 and\n?s = 10000.\n\nThe height is maintained fixed while the length L is variable to observe how the\ntopology may change. Given that, the results obtained in Borrvall and Petersson (2003),\nfor L = 1.0 are two separated straight channels connecting the inlets to the outlets and\nfor L = 1.5, the channels merge into one at the center with an angle of 90? between the\ntwo inlets and the two outlets, which corresponds to the analytical results obtained in\n\n\n\nChapter 6. Numerical Results 52\n\nPironneau (1974).\n\nFigure 6.7 shows the results obtained by using the energy functional, Stokes formulation\nand the Newtonian model with arbitrary properties (density % = 1 and viscosity \u00b5 = 1).\nWe observe that the topologies are very consistent with the topologies of Borrvall and\nPetersson (2003), indicating that the optimization process is correctly implemented.\n\nFigure 6.7 \u2013 Topologies for the double channel problem with Stokes formulation.\n\nIn addition, topology optimization for a double channel problem considering two inlets\nand two outlets is studied, now considering the zero stress boundary condition (Eq.2.2\nequals to zero) at the outlet, as shown in Fig. 6.8. Also, the Navier-Stokes formulation\nof fluid flow and real blood properties are considered, as studied in Pingen and Maute\n(2010). Thus, the domain has dimensions in cm, i.e., 1cm \u00d7 1.5cm. For this case, the\nadopted objective function aims to minimize total shear stress combined with the term\n(\n?\n\n? ?(?)u2d?), necessary in order to achieve a final discrete distribution.\n\nThe optimized topologies for both Newtonian and Carreau-Yasuda (with interpolation\ndependant of pseudo-density) models of viscosity are presented for two different values of\nthe maximum value of the parabolic velocity profile at inlet.\n\nFigure 6.8 \u2013 Double channel problem with zero stress boundary condition at the outlet.\n\n\n\nChapter 6. Numerical Results 53\n\nFigure 6.9 shows the results for the Newtonian model with inlet peak velocities of 0.02\nand 0.2 cm/s, viscosity of 0.0035Pa \u00b7 s and considering the shear stress functional. We\nobserve that both topologies are very similar for this model of constant viscosity. Figure\n6.10 shows the velocity fields for this case. The objective function values are shown in\nTable 6.2.\n\nAs can be seen in Fig. 6.9, the topology for high velocity (Fig.6.9b) unite the channel\nfarther from the inlet with a small curvature, while the topology for low velocity (Fig.6.9a)\nhas a more straight path. This can be explained by the fact that the fluid at higher\nvelocities has more inertia and then a smoother transition to the united channel provides\na lower shear stress.\n\nFigure 6.9 \u2013 Topology results for double channel and Navier-Stokes Newtonian model.\n(a) Re=0.1. (b) Re=1.0.\n\nFigure 6.10 \u2013 Velocity fields for double channel and Navier-Stokes Newtonian model.\n(a) Re=0.1. (b) Re=1.0.\n\nTable 6.2 \u2013 Functional values for double channel.\n\nCase Inlet Velocity [cm/s] Area [cm2] Total Shear Stress\nNewtonian 0.02 0.5 0.002\nNewtonian 0.2 0.5 0.221\nNon Newtonian 0.02 0.5 0.220\nNon Newtonian 0.2 0.5 0.303\n\nFigure 6.11 show the results for the Non-Newtonian Carreau-Yasuda model with inlet\n\n\n\nChapter 6. Numerical Results 54\n\npeak velocities of 0.02 and 0.2 cm/s and considering the shear stress functional. In this\ncase, the results are very different, given that for low velocities (Fig.6.11a) the channels\ndo not merge, while for high velocities (Fig.6.11b) the channels unite giving a topology\nsimilar to the result from the Newtonian model (Fig.6.9b). Figure 6.12 and 6.13 show the\nvelocity and viscosity fields, respectively. The objective function values are shown in Table\n6.2.\n\nFigure 6.11 \u2013 Topology results for double channel and Navier-Stokes non-Newtonian model\n(Carreau-Yasuda viscosity model).\n\n(a) Re=0.1. (b) Re=1.0.\n\nFigure 6.12 \u2013 Velocity fields for double channel and Navier-Stokes non-Newtonian model\n(Carreau-Yasuda viscosity model).\n(a) Re=0.1. (b) Re=1.0.\n\nFigure 6.13 \u2013 Viscosity fields for double channel and Navier-Stokes non-Newtonian model\n(Carreau-Yasuda Viscosity Model).\n\n(a) Re=0.1. (b) Re=1.0.\n\nThe results obtained are similar to the results presented in the work of Pingen and\nMaute (2010), where the total shear stress in the domain is also considered as the objective\n\n\n\nChapter 6. Numerical Results 55\n\nfunction.\n\nIt is possible to observe that the topologies may differ significantly when a constant\nor variable viscosity model is adopted. For higher velocity, thus higher shear rate, both\ncases presented a similar optimized design, with a merged channel. This is consistent with\nthe Carreau-Yasuda model adopted for the shear-thinning effect, where in cases of higher\nshear rate, the behavior of blood is close to a Newtonian fluid with a value of viscosity\nthat tends to the minimum \u00b5? = 0.0035Pa.s.\n\nIn Fig.6.13 it is possible to see that the viscosity field is consistent with the velocity\nfield, given that at the center of the channels the viscosity presents a high value, indicating\nthat at this point the shear rate is low. Also, the viscosity presents a lower value near the\nchannel walls, indicating high shear rates, which is coherent with the no-slip condition\nand the boundary layer. The viscosity profile is in accordance with the interpolation used,\ndescribed in Equation 3.3, given that in solid regions the viscosity presents a lower constant\nvalue.\n\n6.2.2 Obstacle\n\nThe second implementation example is the pipe bend optimization problem with\nan obstacle, having energy dissipation as objective function. The corresponding design\ndomain is shown in Figure 6.14. The volume constraint defines the total amount of fluid\nV ? 0.08?L2. This value corresponds to a quarter of the volume of torus with inner\nradius ri = 0.07m and outer radius ro = 0.09m that fits exactly to the inlet and outlet, as\nsuggested for the simple pipe bend problem in Borrvall and Petersson (2003). Parabolic\nvelocity profiles are used at the inlet and outlet, where the velocity at the center presents\na value Umax = 0.01m/s.\n\nFigure 6.14 \u2013 Obstacle problem.\n\nAs a result, a comparison of topologies generated by considering Newtonian and\n\n\n\nChapter 6. Numerical Results 56\n\nCarreau-Yasuda viscosity model is presented in Figure 6.15, where the effect of modelling\nblood shear-thinning in the final design is visible.\n\nFigure 6.15 \u2013 Optimized topologies for the obstacle problem.\n(a) Newtonian viscosity. (b) Carreau-Yasuda.\n\nIn Figure 6.16, the velocity profile and shear-thinning viscosity distribution for the\nnon-Newtonian optimized topology are observed. The direct relation between them can\nbe observed: in regions where the velocity gradients are lower, shear-stress has also a\ndecreased value, an thus, the dynamic viscosity tends to the maximum adopted value\n\u00b50 = 0.16Pa.s.\n\nFigure 6.16 \u2013 Velocity and viscosity profiles for the Carreau-Yasuda model.\n(a) Velocity. (b) Viscosity.\n\nIn addition, the value of Newtonian constant viscosity \u00b50 = 0.0035Pa.s is displayed in\nthe areas where the domain is filled with solid, due to the interpolation function employed\n(Eq. 3.2). The results obtained are similar to the results obtained by using the interpolation\nfunction from Equation 3.3, however, when applying this pondering the convergence rate\ndecreases. In the Newtonian model, the viscosity distribution is not shown because it is\nconstant within the domain, both solid and fluid area present the same viscosity value.\n\n\n\nChapter 6. Numerical Results 57\n\n6.2.3 Arterial Bypass\n\nHaving verified the topology optimization process with the previous examples, the\nmethodology is applied to practical problems, such as the arterial bypasses. The next\nsections illustrates the application of TOM to different cases of arterial bypasses.\n\na) Fully blocked arterial bypass\n\nAn important example of application of topology optimization to blood flow is the\ndesign of an arterial bypass, studied before by Abraham, Behr and Heinkenschloss (2005)\nand Zhang and Liu (2015), which consists in an artificial channel that allows the existence\nof flow in places where an artery is blocked. The objective function used aims to minimize\nthe total shear stress of the fluid, since it is directly related with blood cell damage in\nartificial flows.\n\nA parabolic inlet profile is adopted to simplify the examples, as seen in Section 6.1.\nThis profile is adjusted by the formulation of Non-newtonian profile in the beginning of\nthe channel. Thus, the optimization domain is defined in a region distant from the inlet.\n\nThe dimensions and boundary conditions for this problem are shown in Fig. 6.17.\nThe highlighted area corresponds to the design domain, and the inferior central part\ncorresponds to the blocked artery. Also, the original artery, represented by the lower\nchannel with height h, is not modified during the process, so it is a fixed domain always\nfilled with fluid. At the inlet, velocity profile is imposed with Umax = 0.025m/s and at\nthe outlet a zero stress condition is considered. The upper region is the domain where the\nbypass topology will be formed.\n\nFigure 6.17 \u2013 Arterial bypass domain.\n\nThe adopted dimension are: h = 0.068m, d = 0.006m, L1 = 0.06m, L2 = 0.03m,\nL3 = 0.019m, L4 = d/4, and L5 = 0.02m.\n\nIn this example the Carreau-Yasuda viscosity model is used without the porous\ninterpolation on viscosity, due to the fact that without this interpolation the convergence\nis faster and the results are not influenced too much. A volume constraint of 33% of the\ntotal volume is used. Also, an initial guess similar to Abraham, Behr and Heinkenschloss\n\n\n\nChapter 6. Numerical Results 58\n\n(2005) is used, as shown in Fig.6.18.\n\nFigure 6.18 \u2013 Initial guess for bypass topology optimization of fully blocked artery.\n\nFigure 6.19 \u2013 Velocity and viscosity fields for bypass initial guess of fully blocked artery.\n(a) Velocity Field.\n\n(b) Viscosity Field.\n\nThe final topology is shown in Fig.6.20. Here, it is possible to notice that the algorithm\ntends to create the shorter path between the inlet and outlet. This result was also observed\nby Zhang and Liu (2015). This indicates that this topology, juxtaposed to the wall, creates\na lower energy dissipation value than the initial guess.\n\nFigure 6.21 shows the velocity and viscosity fields for the optimized topology. In\nFig.6.21a, we observe that the overall velocity is lower in the bypass region when compared\nwith the initial guess (Fig.6.19a). The viscosity field (Fig.6.21b) shows a higher viscosity\nwithin the channel, which signifies that the shear rate in the optimized channel is lower.\nThus, from this conclusion we can infer that the initial topology (Fig.6.19b) has a higher\nshear rate inside the channel.\n\nIt is important to notice that, as cited before, the viscosity is not interpolated with\n\n\n\nChapter 6. Numerical Results 59\n\nrespect to the design variable, thus, the solid regions on the viscosity fields present a low\nshear rate, hence, close to the upper value for viscosity (\u00b50 = 0.16Pa \u00b7s).\n\nFigure 6.20 \u2013 Final topology for bypass optimization of fully blocked artery.\n\nFigure 6.21 \u2013 Velocity and viscosity fields for bypass optimization of fully blocked artery.\n(a) Velocity Field.\n\n(b) Viscosity Field.\n\nFigure 6.22 shows the convergence curve for the optimization and Fig.6.23 shows the\ntopology evolution during the process. The functional value can be broken in two different\nparts, being the first identified as the shear stress (\n\n?\n?\n\n1\n2 (?u +?u\n\nT ) : (?u +?uT )d?) and\nthe second as the inertial velocity term (\n\n?\n? ?(?)u2d?). As can be seen, initially the shear\n\nstress value increases as the volume decreases to attend the restriction. Also, the inertial\npart is initially very low, given that the domain do not present intermediary porosity\nregions, however, as the optimization proceeds the value grows and then decreases as the\ngray regions disappear.\n\nThe final functional values can be seen in Table 6.3. The final topology presents a\nimprovement in shear stress of 42% while the inertial part increases, however the reduction\n\n\n\nChapter 6. Numerical Results 60\n\nof the shear stress is the main objective, thus the optimization is performed successfully.\n\nTable 6.3 \u2013 Final Functional values for bypass optimization of fully blocked artery.\n\nCase Area [cm2] Objective Function Shear Stress Inertial Part\nInitial guess 16.57 198.79 198.35 0.44\nOptimized 15.63 129.65 115.47 14.18\n\nFigure 6.22 \u2013 Convergence curve for bypass optimization of fully blocked artery.\n\nFigure 6.23 \u2013 Topology changes during bypass optimization of fully blocked artery.\n(a) Iteration 0. (b) Iteration 150.\n\n(c) Iteration 10. (d) Iteration 200.\n\n(e) Iteration 50. (f) Iteration 300.\n\n\n\nChapter 6. Numerical Results 61\n\nb) Partial blocked arterial bypass\n\nThe second case of an arterial bypass consists of a partial blocked artery (stenosed) in\nwhich another artery outlet is appended. Thus, in order to obtain a better design of the\njoint section between the host artery and the graft, both the host artery and graft outlets\nare set as the design objects. The objective function evaluated corresponds to minimizing\nthe domain shear stress (Eq. 3.6). This application is also studied in the work of Zhang\nand Liu (2015) and the arterial bypass domain includes two inlets which are the host\nartery inlet and the graft inlet and one outlet referring to the host artery continuation.\n\nAgain, two parabolic inlet profiles are adopted and domain extensions are added to\nallow the flow development until the Non-Newtonian profile. The viscosity model adopted\nis the Carreau-Yasuda Non-Newtonian model without the interpolation with respect to\nthe design variable. The dimensions and boundary conditions for this problem are shown\nin Fig. 6.24. The highlighted area corresponds to the design domain, which excludes the\ndomain extension cited before.\n\nThis application is divided in three sub-cases, in which the inlet velocities are changed\nto represent different situations. The three cases are described in Table 6.4.\n\nTable 6.4 \u2013 Cases division for bypass optimization of partial blocked artery.\n\nCase 1 Case 2 Case 3\nu1[cm/s] 10.5 15.75 5.25\nu2[cm/s] 10.5 5.25 15.75\n\nFigure 6.24 \u2013 Design domain and boundary conditions for stenosed artery bypass.\n\n\n\nChapter 6. Numerical Results 62\n\nCase 1 (u1 = 10.5[cm/s], u2 = 10.5[cm/s])\n\nThis case considers both artery and graft with the same flow rate, i.e., the same\nparabolic profiles with peak velocity of 10.5[cm/s], which represents a Reynolds number\nof 100. The final topology is shown in Fig. 6.25. The velocity and viscosity fields are\npresented in Fig.6.27.\n\nIn this example we can see that both channels have similar widths close to the inlet.\nObserving the velocity field (Fig.6.26) the channels unite midway in an angle close to the\ndouble channel results (Fig.6.11b).\n\nThe viscosity profile, shown in Fig. 6.27a, presents a higher value at the solid regions\nsince velocity gradients are close to zero. At the fluid channel, the viscosity value is lower\nand apparently constant, however in Fig. 6.27b the viscosity profile is plotted with a\nreduced maximum value and it is possible to observe the non-Newtonian behavior of the\nfluid. At the walls, where velocity gradient and also shear rate is higher, viscosity has a\nlower value. At the center of the fluid channel, the opposite effect is observed, velocity\ngradients are lower and, thus, the viscosity value increases sightly.\n\nFigure 6.25 \u2013 Final topology for stenosed artery optimization (Case 1).\n\nFigure 6.26 \u2013 Velocity field for stenosed artery optimization (Case 1).\n\n\n\nChapter 6. Numerical Results 63\n\nFigure 6.27 \u2013 Viscosity field for stenosed artery optimization (Case 1).\n(a) Viscosity Field. (b) Viscosity field inside the channel.\n\nCase 2 (u1 = 5.25[cm/s], u2 = 15.75[cm/s])\n\nThis case considers that the upper artery is obstructed and graft must provide the\nremaining flow to maintain the flow rate at the outlet, i.e., the parabolic profiles have\ndifferent peak values of 5.25[cm/s], in the upper inlet, and 15.75[cm/s] in the lower inlet.\nThe final topology is shown in Fig. 6.28. The velocity and viscosity fields are presented in\nFig.6.30.\n\nIn this example we can see that the high velocity channel dominates the optimization,\nin a way that the final topology is almost a straight channel with a small collaboration\nof the upper inlet in the contour, promoting a small curvature in the lower part of the\nchannel near where it unites.\n\nThe final topology seems discontinuous near the upper inlet, however, the results is\ncorrect, given that the small extensions are considered fixed as fluid and do not enter the\noptimization. If this extension is part of the optimization domain, a curve consistent with\nthe velocity profile would be created. The velocity field (Fig.6.29) is coherent with the\ntopology and the fluid only flows where the topology enables. The viscosity profile (Fig.\n6.30) is consistent with the characteristics of fluid flow at this optimized topology and\nagain, the profile is shown in two different value ranges so that the viscosity inside the\nfluid can be observed.\n\nFigure 6.28 \u2013 Final topology for stenosed artery optimization (Case 2).\n\n\n\nChapter 6. Numerical Results 64\n\nFigure 6.29 \u2013 Velocity field for stenosed artery optimization (Case 2).\n\nFigure 6.30 \u2013 Viscosity field for stenosed artery optimization (Case 2).\n(a) Viscosity Field. (b) Viscosity field inside the channel.\n\nCase 3 (u1 = 15.75[cm/s], u2 = 5.25[cm/s])\n\nThis case is the opposite of the Case 2, it considers that the lower artery is obstructed\nand graft must provide the remaining flow to maintain the flow rate at the outlet, i.e.,\nthe parabolic profiles have different peak values of 15.75[cm/s], in the upper inlet, and\n5.25[cm/s] in the lower inlet. The final topology is shown in Fig. 6.31. The velocity and\nviscosity fields are presented in Fig.6.33.\n\nThe same effect of apparently discontinuity occurs in the final topology near the inlet\n(Fig.6.31), however, as explained before, the domain extensions are always fluid and inside\nthe design domain the fluid only flows where the topology permits.\n\nEven though the example is very similar to Case 2, the velocity profile (Fig.6.32) shows\nthat the union of the channels occur farther from the inlet and promotes a union angle\nsimilar to the double channel result (Fig.6.9b). As the cases presented before, the viscosity\n(Fig. 6.33) has a higher value in the solid regions. In Fig. 6.33b, it is shown that the central\nregion of the fluid channel presents a sightly higher value then the rest of the channel,\nwhich indicates lower shear rate and a minimum value at the walls, where the velocity\ngradient is higher.\n\n\n\nChapter 6. Numerical Results 65\n\nFigure 6.31 \u2013 Final topology for stenosed artery optimization (Case 3).\n\nFigure 6.32 \u2013 Velocity field for stenosed artery optimization (Case 3).\n\nFigure 6.33 \u2013 Viscosity field for stenosed artery optimization (Case 3).\n(a) Viscosity Field. (b) Viscosity field inside the channel.\n\n6.2.4 Bypass considering Vorticity\n\nThe vorticity is an objective function of interest when designing devices that operates\nwith blood, because it has a direct relation with the blood stagnation, which causes a\nagglomeration of blood cells in regions with high re-circulation. The cell agglomeration can\ncause thrombosis, i.e., the agglutination can detach from the re-circulation zone and go\nthrough the circulatory system blocking a capillary artery causing more serious diseases.\n\nThis example considers the same design domain from Fig.6.17. Also, the initial guess\nis the same of Fig.6.18. The pure vorticity functional presents a particularity, being that\nthe optimized topology is formed by a \"gray\" domain. The intermediary porosity causes\n\n\n\nChapter 6. Numerical Results 66\n\nthe reduction in the velocity and, with this, a reduction in the vorticity value, as can be\nseen in Tab.6.5. This \"gray\" topology is shown in Fig. 6.34.\n\nTable 6.5 \u2013 Functional values for vorticity optimization.\n\nTopology Volume Vorticity Inertial Part.\nInitial Guess (Fig.6.18) 16.57 41.41 -\nGray Topology (Fig.6.34) 15.57 6.40 -\nFinal Topology (Fig.6.35) 15.60 20.96 2.32\n\nFigure 6.34 \u2013 Gray final topology for pure vorticity optimization.\n\nThis gray domain represents a material with intermediary porosity and it is not possible\nto build. Thus in order to circumvent this problem, a term is added to the functional\nrepresenting the flow within the porous media, as shown in Eq. 6.1. This added term\nimplies in the minimization of the velocity in low porosity regions, thus promoting a\ncontinuous topology.\n\nJv(u) =\n?\n\n?\n|?\u00d7 u|2d? + ?v\n\n?\n?\n?(?)u2d? (6.1)\n\nwhere ?v is a weight coefficient used to calibrate the optimization direction (adopted value\nis 0.3). The added term is the same present in the energy dissipation functional and refers\nto the inertial part.\n\nThe final topology obtained with this new objective function is shown in Fig.6.35.\nThe topology is very similar to the one obtained with the energy dissipation functional\n(Fig.6.20), which may indicate that the inertial term dominated the optimization. However,\nobserving the convergence curve from Fig. 6.36 it is possible to notice that the vorticity\npart is also minimized. From Tab. 6.5, the vorticity is reduced to approximately 49.38% of\nthe initial guess in the optimized topology.\n\n\n\nChapter 6. Numerical Results 67\n\nFigure 6.35 \u2013 Final topology for vorticity optimization.\n\nFigure 6.36 \u2013 Convergence curve for bypass optimization considering vorticity functional with\nadded inertial part.\n\n6.2.5 Multi-objective bypass\n\nThe previous sections introduced the optimization considering different objective\nfunctions, such as, energy dissipation, shear rate and vorticity. However, it is possible\nto optimize the bypass by considering a weighted union between these functionals, as\ndescribed in Section 3.4.4. Hence, this section presents the optimization considering both\nthe vorticity and the energy dissipation functionals.\n\nThis example considers the same design domain from Fig.6.17. Also, the initial guess\nis the same of Fig. 6.18. The weights of we = 0.5 and wv = 0.5 are used, i.e., the final\nfunctional has the same weight for both energy dissipation and vorticity, respectively.\nHowever, the vorticity has an additional multiplier ?k, used to normalize the difference in\nmagnitude of the two functions, as described in Section 4.5.\n\nThe final topology is shown in Fig. 6.37. Comparing this topology with the one obtained\nin the vorticity optimization (Fig. 6.35) we can see that the channel is more detached from\nthe boundary.\n\n\n\nChapter 6. Numerical Results 68\n\nFigure 6.37 \u2013 Final topology considering the multi-objective functional.\n\nThe convergence curve and the evolution of the topology during the optimization can\nbe seen in Fig.6.38 and Fig.6.39, respectively. Also, the functional values for the final\ntopology is shown in Table 6.6.\n\nComparing the vorticity value from Tab.6.6 to the one from the vorticity optimization\n(Tab.6.5) we can see that the value is 25% higher in the multi-objective case. This indicates\nthat the introduction of the viscous dissipation term in the objective function introduces a\npareto behavior, i.e., the minimization of the viscous dissipation occurs in detriment of\nthe vorticity. However, the final vorticity is still 33% lower than the initial guess, which\nindicates that the optimization succeeded and, therefore, this multi-objective optimization\nscheme is a viable option to minimize multiple functions.\n\nTable 6.6 \u2013 Functional values for optimization considering the multi-objective functional.\n\nTopology Volume Total Viscous Dissip. Inertial Part. Vorticity\nInitial Guess (Fig.6.18) 16.62 22.33 5.57 1.61 37.49\nVorticity Opt. (Fig.6.35) 15.60 - - 2.32 20.96\nMulti-obj. Opt. (Fig.6.37) 15.69 14.68 2.93 1.40 25.03\n\nFigure 6.38 \u2013 Convergence curve for optimization considering the multi-objective functional.\n\n\n\nChapter 6. Numerical Results 69\n\nFigure 6.39 \u2013 Topology changes during bypass optimization considering the multi-objective\nfunctional.\n(a) Iteration 20. (b) Iteration 120.\n\n(c) Iteration 60. (d) Iteration 140.\n\n6.2.6 3D Difuser\n\nThis example is presented to illustrate how the same methodology can be extended\nto 3D domains. It covers a 3D convergent diffuser designed by using the Navier-Stokes\nequations along with the Non-Newtonian Carreu-Yasuda model. The 3D example is rather\nsimple, however it takes a much longer time to converge than the 2D problems. For\nexample, this case took 27 hours to complete.\n\nThe objective function evaluated for this case is to minimize energy dissipation, which\ncorresponds to pressure drop at the diffuser. A parabolic velocity profile is adopted at\nthe inlet and zero stress condition at the outlet. Domain extensions are added to permit\nthe flow development until the Non-Newtonian profile. The dimensions and boundary\nconditions for this problem are shown in Fig. 6.40. The highlighted area corresponds to\nthe design domain, which excludes the domain extension cited before.\n\n\n\nChapter 6. Numerical Results 70\n\nFigure 6.40 \u2013 Design domain and boundary conditions for the 3D convergent diffuser.\n(a) Domain Dimensions. (b) Boundary Conditions.\n\nThe final topology can be seen in Fig.6.41, where blue represents solid (? = 0) and\nred represents fluid (? = 1). The velocity and viscosity fields are shown in Fig.6.42 and\nFig.6.43, respectively. It is possible to notice that the methodology can be extended to\nthe 3D cases. Also, observing the velocity field (Fig.6.42b) we can see that the velocity is\nminimized in the solid regions.\n\nFigure 6.41 \u2013 Final topology for the 3D convergent diffuser optimization.\n(a) Isometric view. (b) Slice view.\n\n\n\nChapter 6. Numerical Results 71\n\nFigure 6.42 \u2013 Velocity field for optimized 3D convergent diffuser.\n(a) Isometric view. (b) Slice view.\n\nFigure 6.43 \u2013 Viscosity field for optimized 3D convergent diffuser.\n(a) Isometric view. (b) Slice view.\n\n\n\n72\n\n7 CONCLUSIONS\n\nA methodology for design channel for non-Newtonian fluid flow based on topology\noptimization is presented. Carreau-Yasuda shear thinning model is coupled with the\nNavier-Stokes equations to represent more accurately non-Newtonian effects in blood flow.\n\nIn topology optimization for Newtonian fluids, a porous material model is used to\nallow a continuous transition between fluid and solid, where the inverse permeability ? is\ninterpolated as a function of the design variable ?. For non-Newtonian fluids, some authors\nsuggest to adapt this material model by adding an interpolation function of the dynamic\nviscosity \u00b5, which is also dependent of the pseudo-density ?. In the examples studied,\nthe convergence of the optimization algorithm was faster when only inverse permeability\ninterpolation was employed.\n\nIt is also verified that optimization considering only shear stress or vorticity functional\nresults in a \"gray\" domain, where many regions present an intermediate porosity value.\nThus, it is necessary to add a term correspondent to minimization of flow thought the\nporous media in the objective function in order to achieve a discrete domain distribution.\n\nThe results show that the numerical formulation adopted is consistent with the\nliterature, obtaining non-intuitive solutions that minimize the fluidic system dissipation of\nenergy, shear stress or vorticity and satisfy the volume constraint imposed.\n\nThe optimized topologies differ significantly according to the fluid model used, Newtonian\nor shear-thinning, specially for higher velocities. This justifies the need to model blood as\na non-Newtonian fluid and analyze a more complex system.\n\nIt is also shown that the FEniCS software library, the Dolfin-adjoint package and\nthe IPOpt optimizer make a valid tool to implement the finite element method and\noptimization algorithm in a more automated way, simplifying the coding and application\nof topology optimization to fluidic problems.\n\n7.1 Future Work\n\nAs future work, it is suggested to extend these studies to the optimization of rotary\nsystems, which can be employed in another important bio-medical device for conducting\nblood, that is the ventricular assist device pump.\n\nAlso, for applications outside Bio-engineering field, it might be useful to explore the\ninfluence of non-Newtonian shear-thickening behavior, where, opposite to what occurs\nwith blood, the dynamic viscosity value increases with higher velocity gradients.\n\n\n\n73\n\nREFERENCES\n\nAAGE, N.; POULSEN, T.; GERSBORG-HANSEN, A.; SIGMUND, O. Topology\noptimization of large scale stokes flow problems. Structural and Multidisciplinary\nOptimization, Springer-Verlag, v. 35, n. 2, p. 175\u2013180, 2008. ISSN 1615-147X. Available\nfrom Internet:&lt;http://dx.doi.org/10.1007/s00158-007-0128-0>. Cited in page 26.\n\nABRAHAM, F.; BEHR, M.; HEINKENSCHLOSS, M. The effect of stabilization\nin finite element methods for the optimal boundary control of the oseen equations.\nFinite Elements in Analysis and Design, v. 41, n. 3, p. 229 \u2013 251, 2004. ISSN\n0168-874X. Available from Internet:&lt;http://www.sciencedirect.com/science/article/pii/\nS0168874X04000861>. Cited in page 31.\n\nABRAHAM, F.; BEHR, M.; HEINKENSCHLOSS, M. Shape optimization in steady\nblood flow: A numerical study of non-newtonian effects. Computer Methods in\nBiomechanics and Biomedical Engineering, v. 8, n. 2, p. 127\u2013137, 2005. PMID:\n16154876. Available from Internet:&lt;http://dx.doi.org/10.1080/10255840500180799>.\nCited 9 times in pages 14, 15, 22, 23, 27, 31, 48, 57, and 58.\n\nALN\u00e6S, M.; BLECHTA, J.; HAKE, J.; JOHANSSON, A.; KEHLET, B.; LOGG, A.;\nRICHARDSON, C.; RING, J.; ROGNES, M.; WELLS, G. The fenics project version\n1.5. Archive of Numerical Software, v. 3, n. 100, 2015. ISSN 2197-8263. Available\nfrom Internet:&lt;http://journals.ub.uni-heidelberg.de/index.php/ans/article/view/20553>.\nCited in page 44.\n\nBENDSOE, M.; SIGMUND, O. Topology Optimization: Theory, Methods\nand Applications. Springer, 2003. ISBN 9783540429920. Available from Internet:\n<http://books.google.com.br/books?id=NGmtmMhVe2sC>. Cited 2 times in pages 15\nand 25.\n\nBENDSOE, M. P.; KIKUCHI, N. Generating optimal topologies in structural design using\na homogenization method. Comput. Methods Appl. Mech. Eng., Elsevier Sequoia S.\nA., Lausanne, Switzerland, Switzerland, v. 71, n. 2, p. 197\u2013224, nov. 1988. ISSN 0045-7825.\nAvailable from Internet:&lt;http://dx.doi.org/10.1016/0045-7825(88)90086-2>. Cited in\npage 25.\n\nBOEK, E. S.; CHIN, J.; COVENEY, P. V. LATTICE BOLTZMANN SIMULATION\nOF THE FLOW OF NON-NEWTONIAN FLUIDS IN POROUS MEDIA.\nInternational Journal of Modern Physics B, v. 17, n. 01n02, p. 99\u2013102, jan 2003.\nISSN 0217-9792. Available from Internet:&lt;http://discovery.ucl.ac.uk/29827/http:\n//www.worldscientific.com/doi/abs/10.1142/S021797920301714X>. Cited in page 20.\n\nBORRVALL, T.; PETERSSON, J. Topology optimization of fluids in Stokes flow.\nInternational Journal for Numerical Methods in Fluids, v. 41, n. 1, p. 77\u2013107,\njan. 2003. ISSN 0271-2091. Available from Internet:&lt;http://onlinelibrary.wiley.com/doi/\n10.1002/fld.426/abstracthttp://doi.wiley.com/10.1002/fld.426>. Cited 9 times in pages\n18, 19, 25, 26, 28, 30, 51, 52, and 55.\n\nhttp://dx.doi.org/10.1007/s00158-007-0128-0\nhttp://www.sciencedirect.com/science/article/pii/S0168874X04000861\nhttp://www.sciencedirect.com/science/article/pii/S0168874X04000861\nhttp://dx.doi.org/10.1080/10255840500180799\nhttp://journals.ub.uni-heidelberg.de/index.php/ans/article/view/20553\nhttp://books.google.com.br/books?id=NGmtmMhVe2sC\nhttp://dx.doi.org/10.1016/0045-7825(88)90086-2\nhttp://discovery.ucl.ac.uk/29827/ http://www.worldscientific.com/doi/abs/10.1142/S021797920301714X\nhttp://discovery.ucl.ac.uk/29827/ http://www.worldscientific.com/doi/abs/10.1142/S021797920301714X\nhttp://onlinelibrary.wiley.com/doi/10.1002/fld.426/abstract http://doi.wiley.com/10.1002/fld.426\nhttp://onlinelibrary.wiley.com/doi/10.1002/fld.426/abstract http://doi.wiley.com/10.1002/fld.426\n\n\nReferences 74\n\nBOYD, J.; BUICK, J. M.; GREEN, S. Analysis of the Casson and Carreau-Yasuda\nnon-Newtonian blood models in steady and oscillatory flows using the lattice Boltzmann\nmethod. Physics of Fluids, v. 19, n. 9, p. 093103, 2007. ISSN 10706631. Available from\nInternet:&lt;http://scitation.aip.org/content/aip/journal/pof2/19/9/10.1063/1.2772250>.\nCited in page 14.\n\nDENG, Y.; LIU, Z.; WU, Y. Topology optimization of steady and unsteady incompressible\nnavier\u2013stokes flows driven by body forces. Structural and Multidisciplinary\nOptimization, Springer-Verlag, v. 47, n. 4, p. 555\u2013570, 2013. ISSN 1615-147X. Available\nfrom Internet:&lt;http://dx.doi.org/10.1007/s00158-012-0847-8>. Cited in page 26.\n\nEVGRAFOV, A. The limits of porous materials in the topology optimization\nof stokes flows. Applied Mathematics and Optimization, Springer-Verlag,\nv. 52, n. 3, p. 263\u2013277, 2005. ISSN 0095-4616. Available from Internet:&lt;http:\n//dx.doi.org/10.1007/s00245-005-0828-z>. Cited in page 26.\n\nEVJU, \u00d8. Sensitivity Analysis of Simulated Blood Flow in Cerebral Aneurysms.\n2011. Cited in page 14.\n\nFITZGIBBON, G. M.; KAFKA, H. P.; LEACH, A. J.; KEON, W. J.; HOOPER,\nG.; BURTON, J. R. Coronary bypass graft fate and patient outcome: Angiographic\nfollow-up of 5,065 grafts related to survival and reoperation in 1,388 patients\nduring 25 years. Journal of the American College of Cardiology, v. 28,\nn. 3, p. 616 \u2013 626, 1996. ISSN 0735-1097. Available from Internet:&lt;http:\n//www.sciencedirect.com/science/article/pii/0735109796002069>. Cited in page 13.\n\nFUNKE, S. The Automation of PDE-constrained Optimisation and Its\nApplications. Department of Earth Science and Engineering, Imperial College London,\n2013. Available from Internet:&lt;https://books.google.com.br/books?id=ltLujgEACAAJ>.\nCited 2 times in pages 35 and 46.\n\nGERSBORG-HANSEN, A.; SIGMUND, O.; HABER, R. Topology optimization\nof channel flow problems. Structural and Multidisciplinary Optimization,\nSpringer-Verlag, v. 30, n. 3, p. 181\u2013192, 2005. ISSN 1615-147X. Available from Internet:\n<http://dx.doi.org/10.1007/s00158-004-0508-7>. Cited 2 times in pages 22 and 26.\n\nGIJSEN, F.; VOSSE, F. van de; JANSSEN, J. The influence of the non-Newtonian\nproperties of blood on the flow in large arteries: steady flow in a carotid bifurcation model.\nJournal of Biomechanics, v. 32, n. 6, p. 601\u2013608, jun 1999. ISSN 00219290. Available\nfrom Internet:&lt;http://linkinghub.elsevier.com/retrieve/pii/S0021929099000159>. Cited\nin page 13.\n\nHUNDERTMARK-ZAU\u0160KOV\u00c1, A.; LUK\u00c1?OV\u00c1-MEDVID\u2019OV\u00c1, M. Numerical\nstudy of shear-dependent non-Newtonian fluids in compliant vessels. Computers &amp;\nMathematics with Applications, Elsevier Ltd, v. 60, n. 3, p. 572\u2013590, aug 2010. ISSN\n08981221. Available from Internet:&lt;http://dx.doi.org/10.1016/j.camwa.2010.05.004http:\n//linkinghub.elsevier.com/retrieve/pii/S0898122110003445>. Cited in page 14.\n\nHYUN, J.; WANG, S.; YANG, S. Topology optimization of the shear thinning\nnon-newtonian fluidic systems for minimizing wall shear stress. Comput. Math. Appl.,\nPergamon Press, Inc., Tarrytown, NY, USA, v. 67, n. 5, p. 1154\u20131170, mar. 2014. ISSN\n0898-1221. Available from Internet:&lt;http://dx.doi.org/10.1016/j.camwa.2013.12.013>.\nCited 4 times in pages 16, 19, 27, and 29.\n\nhttp://scitation.aip.org/content/aip/journal/pof2/19/9/10.1063/1.2772250\nhttp://dx.doi.org/10.1007/s00158-012-0847-8\nhttp://dx.doi.org/10.1007/s00245-005-0828-z\nhttp://dx.doi.org/10.1007/s00245-005-0828-z\nhttp://www.sciencedirect.com/science/article/pii/0735109796002069\nhttp://www.sciencedirect.com/science/article/pii/0735109796002069\nhttps://books.google.com.br/books?id=ltLujgEACAAJ\nhttp://dx.doi.org/10.1007/s00158-004-0508-7\nhttp://linkinghub.elsevier.com/retrieve/pii/S0021929099000159\nhttp://dx.doi.org/10.1016/j.camwa.2010.05.004 http://linkinghub.elsevier.com/retrieve/pii/S0898122110003445\nhttp://dx.doi.org/10.1016/j.camwa.2010.05.004 http://linkinghub.elsevier.com/retrieve/pii/S0898122110003445\nhttp://dx.doi.org/10.1016/j.camwa.2013.12.013\n\n\nReferences 75\n\nKLARBRING, A.; PETERSSON, J.; TORSTENFELT, B.; KARLSSON, M. Topology\noptimization of flow networks. Computer Methods in Applied Mechanics and\nEngineering, v. 192, n. 35-36, p. 3909\u20133932, aug 2003. ISSN 00457825. Available from\nInternet:&lt;http://linkinghub.elsevier.com/retrieve/pii/S0045782503003931>. Cited in\npage 26.\n\nKOGA, A. A. Projeto de Dispositivos de Microcanais Utilizando o M\u00e9todo de\nOtimiza\u00e7\u00e3o Topol\u00f3gica. 2010. Cited 2 times in pages 15 and 26.\n\nLOGG, A.; MARDAL, K.-A.; WELLS, G. N. et al. Automated Solution of\nDifferential Equations by the Finite Element Method. [S.l.]: Springer, 2012. ISBN\n978-3-642-23098-1. Cited 2 times in pages 23 and 45.\n\nMACOSKO, C. Rheology: Principles, Measurements, and Applications. Wiley,\n1994. ISBN 9780471185758. Available from Internet:&lt;https://books.google.com.br/\nbooks?id=Kai7QgAACAAJ>. Cited in page 20.\n\nMUMPS Guide. MUltifrontal Massively Parallel Solver. 4. ed. MUMPS, 2011. 1\u201354 p.\nAvailable from Internet:&lt;http://mumps.enseeiht.fr/http://graal.ens-lyon.fr/MUMPS/>.\nCited in page 45.\n\nMURAKAMI, Y.; MIKIC, B. Parametric optimization of multichanneled heat sinks\nfor VLSI chip cooling. IEEE Transactions on Components and Packaging\nTechnologies, v. 24, n. 1, p. 2\u20139, mar 2001. ISSN 15213331. Available from Internet:\n<http://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=910795>. Cited in\npage 15.\n\nPINGEN, G.; EVGRAFOV, A.; MAUTE, K. Topology optimization of flow domains using\nthe lattice boltzmann method. Structural and Multidisciplinary Optimization,\nSpringer-Verlag, v. 34, n. 6, p. 507\u2013524, 2007. ISSN 1615-147X. Available from Internet:\n<http://dx.doi.org/10.1007/s00158-007-0105-7>. Cited in page 26.\n\nPINGEN, G.; MAUTE, K. Optimal design for non-newtonian flows using a topology\noptimization approach. Comput. Math. Appl., Pergamon Press, Inc., Tarrytown, NY,\nUSA, v. 59, n. 7, p. 2340\u20132350, abr. 2010. ISSN 0898-1221. Available from Internet:\n<http://dx.doi.org/10.1016/j.camwa.2009.08.044>. Cited 6 times in pages 16, 19, 27, 29,\n52, and 54.\n\nPIRONNEAU, O. On optimum design in fluid mechanics. Journal of Fluid Mechanics,\nv. 64, n. 1, p. 97\u2013110, 1974. Cited in page 52.\n\nPROBST, M.; L\u00fcLFESMANN, M.; NICOLAI, M.; B\u00fcCKER, H.; BEHR, M.;\nBISCHOF, C. Sensitivity of optimal shapes of artificial grafts with respect to flow\nparameters. Computer Methods in Applied Mechanics and Engineering,\nv. 199, n. 17\u201320, p. 997 \u2013 1005, 2010. ISSN 0045-7825. Available from Internet:\n<http://www.sciencedirect.com/science/article/pii/S0045782509003880>. Cited in page\n31.\n\nQUARTERONI, A.; ROZZA, G. Optimal Control and Shape Optimization of\nAorto-Coronaric Bypass Anastomoses. Mathematical Models and Methods in\nApplied Sciences, v. 13, n. 12, p. 1801\u20131823, 2003. ISSN 0218-2025. Cited in page 31.\n\nhttp://linkinghub.elsevier.com/retrieve/pii/S0045782503003931\nhttps://books.google.com.br/books?id=Kai7QgAACAAJ\nhttps://books.google.com.br/books?id=Kai7QgAACAAJ\nhttp://mumps.enseeiht.fr/ http://graal.ens-lyon.fr/MUMPS/\nhttp://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=910795\nhttp://dx.doi.org/10.1007/s00158-007-0105-7\nhttp://dx.doi.org/10.1016/j.camwa.2009.08.044\nhttp://www.sciencedirect.com/science/article/pii/S0045782509003880\n\n\nReferences 76\n\nROBERTSON, A. M.; SEQUEIRA, A.; OWENS, R. G. Rheological models for blood.\nMilano: Springer Milan, 2009. 211\u2013241 p. ISBN 978-88-470-1152-6. Cited 2 times in\npages 13 and 19.\n\nROBSON, J. A finite element approximation of non-Newtonian flow. Tese\n(Doutorado) \u2014 PhD Thesis, 2003. Cited in page 18.\n\nROMERO, J.; SILVA, E. A topology optimization approach applied to laminar flow\nmachine rotor design. Computer Methods in Applied Mechanics and Engineering,\nv. 279, p. 268\u2013300, sep 2014. ISSN 00457825. Available from Internet:&lt;www.elsevier.com/\nlocate/cmahttp://linkinghub.elsevier.com/retrieve/pii/S0045782514002151>. Cited 4\ntimes in pages 21, 22, 33, and 39.\n\nSIEBERT, M. W.; FODOR, P. S. Newtonian and Non-Newtonian Blood Flow over a\nBackward- Facing Step \u2013 A Case Study. Proceedings of the COMSOL Conference\n2009 Boston, 2009. Cited 3 times in pages 48, 49, and 50.\n\nSLAUGHTER, M.; PAGANI, F.; MCGEE, E.; BIRKS, E.; COTTS, W.; GREGORIC, I.;\nHoward Frazier, O.; ICENOGLE, T.; NAJJAR, S.; BOYCE, S.; ACKER, M.; JOHN, R.;\nHATHAWAY, D.; NAJARIAN, K.; AARONSON, K. Heartware ventricular assist system\nfor bridge to transplant: Combined results of the bridge to transplant and continued\naccess protocol trial. Journal of Heart and Lung Transplantation, Elsevier USA,\nv. 32, n. 7, p. 675\u2013683, 7 2013. ISSN 1053-2498. Cited in page 13.\n\nSOKO?OWSKI, J.; STEBEL, J. Shape optimization for non-Newtonian fluids\nin time-dependent domains. Evolution Equations and Control Theory,\nv. 3, n. 2, p. 331\u2013348, may 2014. ISSN 2163-2480. Available from Internet:\n<http://www.aimsciences.org/journals/displayArticlesnew.jsp?paperID=9922>. Cited in\npage 14.\n\nSOUSA, L. C.; CASTRO, C. F.; ANT\u00d3NIO, C. C. Shape optimization of an artificial\nbypass graft using genetic algorithms. 2nd International Conference on Engineering\nOptimization, n. 2, p. 6\u201311, 2010. Cited in page 14.\n\nSUZUKI, K.; KIKUCHI, N. A homogenization method for shape and topology\noptimization. Computer Methods in Applied Mechanics and Engineering,\nv. 93, n. 3, p. 291 \u2013 318, 1991. ISSN 0045-7825. Available from Internet:\n<http://www.sciencedirect.com/science/article/pii/0045782591902452>. Cited in page\n25.\n\nS\u00e1, L. F. N. d. Topology Optimization Method applied to Laminar Flow\nMachine Rotor Design Topology Optimization Method applied to Laminar\nFlow Machine Rotor Design. 2016. Cited in page 25.\n\nTAYLOR, C.; HOOD, P. A numerical solution of the Navier-Stokes equations using\nthe finite element technique. Computers &amp; Fluids, v. 1, n. 1, p. 73\u2013100, jan 1973.\nISSN 00457930. Available from Internet:&lt;http://linkinghub.elsevier.com/retrieve/pii/\n0045793073900273>. Cited in page 23.\n\nW\u00c4CHTER, A.; BIEGLER, L. T. On the implementation of an interior-point\nfilter line-search algorithm for large-scale nonlinear programming. Mathematical\nProgramming, v. 106, n. 1, p. 25\u201357, mar 2006. ISSN 0025-5610. Available from\n\nwww.elsevier.com/locate/cma http://linkinghub.elsevier.com/retrieve/pii/S0045782514002151\nwww.elsevier.com/locate/cma http://linkinghub.elsevier.com/retrieve/pii/S0045782514002151\nhttp://www.aimsciences.org/journals/displayArticlesnew.jsp?paperID=9922\nhttp://www.sciencedirect.com/science/article/pii/0045782591902452\nhttp://linkinghub.elsevier.com/retrieve/pii/0045793073900273\nhttp://linkinghub.elsevier.com/retrieve/pii/0045793073900273\n\n\nReferences 77\n\nInternet:&lt;http://dx.doi.org/10.1007/s10107-004-0559-yhttp://link.springer.com/10.1007/\ns10107-004-0559-y>. Cited in page 46.\n\nWIKER, N.; KLARBRING, A.; BORRVALL, T. Topology optimization of regions of\nDarcy and Stokes flow. n. July 2006, p. 1374\u20131404, 2007. Cited 2 times in pages 26\nand 28.\n\nZHANG, B.; LIU, X. Topology optimization study of arterial bypass configurations\nusing the level set method. Structural and Multidisciplinary Optimization,\nv. 51, n. 3, p. 773\u2013798, mar 2015. ISSN 1615-147X. Available from Internet:\n<http://link.springer.com/10.1007/s00158-014-1175-y>. Cited 5 times in pages 16, 27,\n57, 58, and 61.\n\nZHU, B.; ZHANG, X.; FATIKOW, S. A multi-objective method of hinge-free compliant\nmechanism optimization. Structural and Multidisciplinary Optimization,\nv. 49, n. 3, p. 431\u2013440, 2014. ISSN 1615-1488. Available from Internet:&lt;http:\n//dx.doi.org/10.1007/s00158-013-1003-9>. Cited 2 times in pages 32 and 41.\n\nhttp://dx.doi.org/10.1007/s10107-004-0559-y http://link.springer.com/10.1007/s10107-004-0559-y\nhttp://dx.doi.org/10.1007/s10107-004-0559-y http://link.springer.com/10.1007/s10107-004-0559-y\nhttp://link.springer.com/10.1007/s00158-014-1175-y\nhttp://dx.doi.org/10.1007/s00158-013-1003-9\nhttp://dx.doi.org/10.1007/s00158-013-1003-9\n\n\tTitle page\n\tResumo\n\tAbstract\n\tList of Figures\n\tList of Tables\n\tAcronyms\n\tNotation\n\tContents\n\tIntroduction\n\tNon-Newtonian Blood Flow\n\tOptimization Methods\n\tMotivation\n\tObjectives\n\tDocument Outline\n\n\tModeling of Non-Newtonian Flow\n\tNavier-Stokes Equations\n\tNon-Newtonian Effects\n\tFinite Element Method\n\tProblem Formulation\n\tImplemented Finite Element\n\n\n\tTopology Optimization\n\tTopology Optimization Applied to Fluid Flow\n\tExtended Design Domain\n\tMaterial Model\n\tProblem Definition\n\tEnergy Dissipation\n\tShear Stress\n\tVorticity\n\tMulti-Objective Function\n\tVolume Constraint\n\n\tDiscrete Form\n\n\tSensitivities Calculation\n\tAdjoint Method\n\tEnergy Dissipation Sensitivity Analysis\n\tSensitivity of Viscosity\n\n\tVorticity Sensitivity Analysis\n\tShear Stress Sensitivity Analysis\n\tSensitivity Analysis of Multi-Objective Function\n\n\tNumerical Implementation\n\tOptimization Algorithm\n\tSoftware Environment\n\tFinite Element Method\n\tSensitivities Computation\n\tOptimizer\n\n\n\tNumerical Results\n\tFEM Verification\n\tTopology Optimization Results\n\tDouble Channel\n\tObstacle\n\tArterial Bypass\n\tBypass considering Vorticity\n\tMulti-objective bypass\n\t3D Difuser\n\n\n\tConclusions\n\tFuture Work\n\n\tReferences"}]}}}