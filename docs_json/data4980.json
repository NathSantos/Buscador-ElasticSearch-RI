{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.06969"}, {"@name": "filename", "#text": "11585_001094387.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL INSTITUTO DE PESQUISAS HIDR\u00c1ULICAS PROGRAMA DE P\u00d3S-GRADUA\u00c7\u00c3O EM RECURSOS H\u00cdDRICOS E SANEAMENTO AMBIENTAL\nAugusto Hugo Farias da Cunha\nSimula\u00e7\u00e3o de escoamentos estratificados: esquemas num\u00e9ricos de alta resolu\u00e7\u00e3o em modelo acoplado de transporte e hidrodin\u00e2mico n\u00e3o-hidrost\u00e1tico\nPorto Alegre\nAugusto Hugo Farias da Cunha\nSimula\u00e7\u00e3o de escoamentos estratificados: esquemas num\u00e9ricos de alta resolu\u00e7\u00e3o em modelo acoplado de transporte e hidrodin\u00e2mico n\u00e3o-hidrost\u00e1tico\nDisserta\u00e7\u00e3o submetida ao Programa de P\u00f3s-Gradua\u00e7\u00e3o em Recursos H\u00eddricos e Saneamento Ambiental da UFRGS, como quesito parcial para obten\u00e7\u00e3o do t\u00edtulo de Mestre em Recursos H\u00eddricos.\nOrientador: David da Motta Marques Coorientador: Carlos Ruberto Fragoso Jr.\nPorto Alegre\nCIP - Cataloga\u00e7\u00e3o na Publica\u00e7\u00e3o\nCunha, Augusto Hugo Farias\nSimula\u00e7\u00e3o de escoamentos estratificados: esquemas num\u00e9ricos de alta resolu\u00e7\u00e3o em modelo acoplado de transporte e hidrodin\u00e2mico n\u00e3o-hidrost\u00e1tico / Augusto Hugo Farias Cunha. -- 2019.\n86 f.\nOrientador: David Manuel L da Motta-Marques.\nCoorientador: Carlos Ruberto Fragoso Jr.\nDisserta\u00e7\u00e3o (Mestrado) -- Universidade Federal do Rio Grande do Sul, Instituto de Pesquisas Hidr\u00e1ulicas, Programa de P\u00f3s-Gradua\u00e7\u00e3o em Recursos H\u00eddricos e Saneamento Ambiental, Porto Alegre, BR-RS, 2019.\n1. Difus\u00e3o Num\u00e9rica. 2. Limitadores de Fluxo. 3. Press\u00e3o N\u00e3o-Hidrost\u00e1tica. 4. M\u00e9todo Euleriano-Lagrangiano. 5. Interpola\u00e7\u00e3o. I. Motta-Marques, David Manuel L da, orient. II. Fragoso Jr, Carlos Ruberto, coorient. III. T\u00edtulo.\nElaborada pelo Sistema de Gera\u00e7\u00e3o Autom\u00e1tica de Ficha Catalogr\u00e1fica da UFRGS com os dados fornecidos pelo(a) autor(a).\nAugusto Hugo Farias da Cunha\nSimula\u00e7\u00e3o de escoamentos estratificados: esquemas num\u00e9ricos de alta resolu\u00e7\u00e3o em modelo acoplado de transporte e hidrodin\u00e2mico n\u00e3o-hidrost\u00e1tico\nDisserta\u00e7\u00e3o submetida ao Programa de P\u00f3s-Gradua\u00e7\u00e3o em Recursos H\u00eddricos e Saneamento Ambiental da UFRGS, como quesito parcial para obten\u00e7\u00e3o do t\u00edtulo de Mestre em Recursos H\u00eddricos.\nTrabalho aprovado. Porto Alegre, 07 de fevereiro de 2019:\nDavid da Motta Marques\nOrientador\nCarlos Ruberto Fragoso Jr.\nCo-orientador\nFernando Mainardi Fan\nExaminador (IPH-UFRGS)\nRodrigo Cauduro Dias de Paiva\nExaminador (IPH-UFRGS)\nMarie-Paule Bonnet\nEzaminadora (IRD)\nPorto Alegre\n2019\nO trabalho dentro de um grupo de pesquisa \u00e9 de fato um motivador e um acelerador de crescimento pessoal e acad\u00eamico. Neste tipo de conv\u00edvio \u00e9 quando se come\u00e7a a perceber a import\u00e2ncia de cada trabalho, n\u00e3o apenas o seu, mas tamb\u00e9m os dos colegas, dos colaboradores que vieram antes de voc\u00ea e os que ainda vir\u00e3o. A constru\u00e7\u00e3o acad\u00eamica dentro de um grupo \u00e9 um processo de longo prazo, que possibilita novos ingressantes alcan\u00e7arem sempre um degrau a mais. Fico feliz em ter participado deste processo, me sinto parte do grupo, e sinto que o trabalho desenvolvido pertence n\u00e3o s\u00f3 a mim, mas tamb\u00e9m ao grupo de pesquisa, o que vai al\u00e9m de seus colaboradores atuais. Ditos isto, o primeiro agradecimento \u00e9 ao Grupo de Pesquisa em Ecotecnologia da UFRGS. Obrigado pelo apoio e investimento.\nEm todo trabalho em grupo, h\u00e1 pessoas que marcam o desenvolvimento de sua pesquisa, sem elas o trabalho desenvolvido n\u00e3o seria o mesmo. Agrade\u00e7o o empenho e o exemplar trabalho de co-orienta\u00e7\u00e3o e tutoria que o professor Carlos Ruberto Fragoso Jr. exerceu em nosso conv\u00edvio de co-orientador e orientando. Assim como agrade\u00e7o ao empenho do professor David da Motta Marques, excelente orientador que me forneceu todo suporte necess\u00e1rio. Sua preocupa\u00e7\u00e3o com o desenvolvimento do trabalho, e de fornecer as condi\u00e7\u00f5es apropriadas para tal, foram marcantes em nosso conv\u00edvio. Agrade\u00e7o tamb\u00e9m aos colaboradores Matheus Henrrique Tavares e J. Rafael Cavalcanti. Matheus foi meu contempor\u00e2neo da p\u00f3s-gradua\u00e7\u00e3o, sua amizade e parceria foram fundamentais em meu desenvolvimento acad\u00eamico, que foi al\u00e9m do presente trabalho. Rafael, para mim, \u00e9 um dos exemplos que tenho de pesquisador. Apesar do pouco conv\u00edvio, pude rever e aprender com trabalhos no c\u00f3digo do IPH-ECO que foi desenvolvido por ele anteriormente. Agrade\u00e7o a ajuda e a colabora\u00e7\u00e3o para a constru\u00e7\u00e3o de nossos produtos.\nComo todo processo de constru\u00e7\u00e3o, o primeiro esbo\u00e7o da obra precisa ser lapidado para chegar em seu est\u00e1gio final. Neste sentido, agrade\u00e7o aos colaboradores que participar\u00e3o da revis\u00e3o do trabalho desenvolvidos, a professora Marie-Paule Bonnet e aos professores Rodrigo C. Dias de Paiva e Fernando Mainardi Fan. O processo de revis\u00e3o \u00e9 essencial, e agrade\u00e7o a experi\u00eancia, ideias e indica\u00e7\u00f5es de todos para constru\u00e7\u00e3o do produto final.\nAinda no \u00e2mbito acad\u00eamico, agrade\u00e7o a Coordena\u00e7\u00e3o de Aperfei\u00e7oamento de Pessoal de N\u00edvel Superior (CAPES: http://www.capes.gov.br) e ao Conselho Nacional de\nDesenvolvimento Cientifico e Tecnol\u00f3gico (CNPq: http://www.cnpq.br) e a bolsa concedida a mim (n\u00famero de concess\u00e3o: 149819/2017-0).\nPor fim, e n\u00e3o menos importante, agrade\u00e7o \u00e0 minha fam\u00edlia, que acredita em minha capacidade e que sempre me d\u00e1 todo o suporte para que eu continue realizando os meus sonhos. Agrade\u00e7o ao meu pai, Augusto Cunha, e minha m\u00e3e, C\u00e9lia Farias. Sem eles, ter ido \u00e0 Porto Alegre iniciar este mestrado e passar pelas dificuldades de cursar 6 meses sem aux\u00edlio financeiro, n\u00e3o seria poss\u00edvel.\nEm especial, agrade\u00e7o imensamente a minha esposa J\u00e9ssica Gon\u00e7alves. Sua compreens\u00e3o e companheirismo em seguir neste desafio comigo \u00e0 dois anos atr\u00e1s foi incr\u00edvel. Passamos o desafio \u00e0 dist\u00e2ncia, mas juntos. No meio desta jornada, casamos e seguimos a encarar ainda mais desafios juntos. Obrigado por todo suporte, revis\u00e3o de texto, e por toda paci\u00eancia. Foram fundamentais no desenvolvimento deste trabalho.\nResumo\nA disserta\u00e7\u00e3o buscou contribuir para o para o entendimento do efeito da difus\u00e3o num\u00e9rica nas solu\u00e7\u00f5es hidrodin\u00e2mica e de transporte de modelos num\u00e9ricos acoplados (hidrodin\u00e2mico e transporte), assim como a rela\u00e7\u00e3o m\u00fatua entre ambas as solu\u00e7\u00f5es buscando um m\u00e9todo eficiente e conservativo para simula\u00e7\u00e3o de escoamentos estratificados. A implementa\u00e7\u00e3o dos m\u00e9todos computacionais foram feitas no modelo IPH-ECO, uma ferramenta computacional capaz de simular processos f\u00edsicos, qu\u00edmicos e biol\u00f3gicos em tr\u00eas dimens\u00f5es. O trabalho foi dividido em duas partes principais que visam apresentar a melhoria dos m\u00e9todos num\u00e9ricos utilizados pelo modelo, assim como a verifica\u00e7\u00e3o e valida\u00e7\u00e3o dos m\u00e9todos implementados (Cap\u00edtulos 4 5).\nA simula\u00e7\u00e3o de escoamentos estratificados requer a implementa\u00e7\u00e3o de m\u00e9todos num\u00e9ricos mais robustos, como: como a aproxima\u00e7\u00e3o n\u00e3o-hidrost\u00e1tica e m\u00e9todos de alta-resolu\u00e7\u00e3o (interpola\u00e7\u00e3o quadr\u00e1tica e limitadores de fluxo) capazes de reduzir a difus\u00e3o num\u00e9rica de maneira conservativa, buscando solu\u00e7\u00f5es com melhor representa\u00e7\u00e3o f\u00edsica de processos, de forma a alcan\u00e7ar resultados satisfat\u00f3rios com menor custo computacional.\nPara solu\u00e7\u00e3o hidrodin\u00e2mica, implementamos a press\u00e3o n\u00e3o-hidrost\u00e1tica, onde propomos o uso de uma nova\u00e7\u00e3o condi\u00e7\u00e3o de contorno na superf\u00edcie livre (cap\u00edtulo 4), e ainda um interpolador quadr\u00e1tico implementado no m\u00e9todo Euleriano-Lagrangiano, utilizado na estimativa da velocidade ao fim da linha de corrente (cap\u00edtulo 5). Para a solu\u00e7\u00e3o do Transporte de Soluto, esquemas de Limitadores de Fluxo foram implementados (cap\u00edtulo 5). Utilizamos benchmarks consolidados na literatura puramente advectivos visando identificar o efeito da difus\u00e3o num\u00e9rica nas solu\u00e7\u00e3o do transporte e hidrodin\u00e2mica comparando m\u00e9todos de baixa resolu\u00e7\u00e3o (interpola\u00e7\u00e3o bilinear e esquema Upwmd) com m\u00e9todos de alta resolu\u00e7\u00e3o.\nO algor\u00edtimo foi capaz de simular adequadamente a celeridade e a dispers\u00e3o de frequ\u00eancia de ondas estacion\u00e1rias em condi\u00e7\u00e3o de \u00e1guas profundas, utilizando uma resolu\u00e7\u00e3o vertical 2 vezes menor que a condi\u00e7\u00e3o cl\u00e1ssica, consequentemente diminuindo o custo computacional m\u00e9dio de um passo de tempo da simula\u00e7\u00e3o em ca. 1.7 vezes, alcan\u00e7ando resultados similares (CBA At = 262 s e FSFS A t = 1 22 s). Este resultado permite que modelos hidrodin\u00e2micos semelhantes melhorem sua solu\u00e7\u00e3o num\u00e9rica com um menor custo de implementa\u00e7\u00e3o, aplicando um tratamento simples,melhorando a performance das simula\u00e7\u00f5es n\u00e3o-hidrost\u00e1ticas.\nOs m\u00e9todos de alta resolu\u00e7\u00e3o foram capazes de diminuir substancialmente a difus\u00e3o num\u00e9rica na solu\u00e7\u00e3o hidrodin\u00e2mica (ca. 10 vezes menor) e de transporte (Erro Relativo e RMSE ca. 3 vezes menor). Os resultados mostraram que a difus\u00e3o num\u00e9rica gerada por m\u00e9todos de baixa resolu\u00e7\u00e3o na solu\u00e7\u00e3o hidrodin\u00e2mica pode ter grande impacto na solu\u00e7\u00e3o do transporte, por tanto, para simular com maior precis\u00e3o situa\u00e7\u00f5es reais (din\u00e2mica de escoamentos estratificados em reservat\u00f3rios profundos) o uso combinado de m\u00e9todos de alta resolu\u00e7\u00e3o se mostra uma alternativa promissora, com baixo custo de implementa\u00e7\u00e3o e alta efici\u00eancia.\nOs m\u00e9todos implementados neste trabalho permitem que modelos mais difusivos, como o IPH-ECO (Fragoso Jr et al., 2009), passem a considerar a difus\u00e3o real ao inv\u00e9s da difus\u00e3o num\u00e9rica em suas modelagens, e portanto utilizar o coeficiente de difus\u00e3o como um par\u00e2metro de calibra\u00e7\u00e3o do modelo.\nPalavras-chaves: Difus\u00e3o Num\u00e9rica. Press\u00e3o N\u00e3o-Hidrost\u00e1tica. Limitadores de Fluxo. M\u00e9todo Euleriano-Lagrangiano. Interpola\u00e7\u00e3o.\nAbstract\nThe dissertation sought to contribute to the understanding of the effect of numerical diffusion in the hydrodynamic and transport solutions of coupled numerical models (hydrodynamic and transport), as well, the mutual relationship between both solutions seeking an efficient and conservative method for simulation of stratified flows. The computational methods was implemented in the IPH-ECO model, computational tool capable of simulating physical, chemical and biological processes in three dimensions. The work was divided in two main parts that aim to the improvement of the numerical methods used by the model, as well as the verification and validation of the implemented methods (Chapters4 5). The simulation of stratified flows requires the implementation of more robust numerical methods, such as: non-hydrostatic approach and high-resolution methods (quadratic interpolation and flux-limiter) capable of conservatively reducing numerical diffusion, searching for solutions that better represented physical processes, in order to achieve satisfactory results with lower computational cost.\nFor the hydrodynamic solution, we implemented the non-hydrostatic pressure, where we propose the use of a novel boundary condition to the free surface (chapter 4), and a quadratic interpolator implemented in the Eulerian-Lagrangian method, used in the estimation of the velocity at the end of the stream-line (chapter 5). For the Solute Transport solution, flux-limiter schemes have been implemented (chapter 5). We use consolidated benchmarks in purely advective problems to identify the effect of numerical diffusion on the transport and hydrodynamics solutions by comparing low-resolution methods (bilinear interpolation and Upwind scheme) with high-resolution methods.\nThe algorithm (FSFS) was able to properly simulate the celerity and the dispersion of the frequency of stationary waves in deep water conditions, using a vertical resolution 2 times smaller than the classical condition (CBA), consequently decreasing the average computational cost of a time step of the simulation in ca. 1.7 times, achieving similar results (CBA At = 2.62 s and FSFS At = 1.22 s). This result allows similar hydrodynamic models to improve their numerical solution with a lower cost of implementation, applying a simple treatment, improving the performance of the non-hydrostatic simulations.\nThe high-resolution methods were able to substantially decrease the numerical diffusion in the hydrodynamic solution (ca. 10 times lower) and transport (Relative Error and RMSE ca. 3 times lower). The results showed that the numerical diffusion generated by low-resolution methods in the hydrodynamic solution may have a substantial impact on\nthe transport solution, therefore, to simulate more accurately real situations (dynamics of stratified flows in deep reservoirs) the combined use of high resolution is a promising alternative, with low implementation cost and high efficiency.\nThe methods implemented in this work allow more diffusive models, such as IPH-ECO (Fragoso Jr et al., 2009), to consider real physics diffusion instead of the numerical diffusion in their modeling, and therefore to use the diffusion coefficient as a model calibration parameter .\nKey-words: Numerical Diffusion. Flux Limiters. Eulerian-Lagrangian Method. Interpolation\nFigura 3.1 - Rela\u00e7\u00e3o entre modelos num\u00e9ricos, representa\u00e7\u00e3o de processos e atributos implementados . Fontes: (Fragoso Jr et al., 2009; Casulli e Lang, 2004; Rosman et al., 2015; Fringer et al., 2006; Wadzuk e Hodges, 2004; Zhang e Baptista, 2008; Jankowski, 1999; Chen et al., 2011)................................ 26\nFigura 3.2 - Varia\u00e7\u00e3o da superf\u00edcie livre em x = y = 0,25 m comparando o erro de fase entre solu\u00e7\u00e3o anal\u00edtica (c\u00edrculo vermelho), solu\u00e7\u00e3o hidrost\u00e1tica com 30 camadas (linha s\u00f3lida figura superior) e solu\u00e7\u00e3o n\u00e3o-hidrost\u00e1tica (linha s\u00f3lida figura inferior). Fonte: Liu et al. (2017)............................. 28\nFigura 3.3 - Rela\u00e7\u00e3o entre escala de processos e solu\u00e7\u00e3o do termo de press\u00e3o indicada. Fonte: Marshall et al. (1997)........................................................ 28\nFigura 3.4 - Esquema bidimensional de aplica\u00e7\u00e3o do ELM apresentando o ponto de partida no tempo \u201dn +1\u201d (ponto vermelho), linha de corrente feita ao longo dos sub-intervalos de tempo (linha tracejada vermelha), ponto de parada no tempo n e pontos de interpola\u00e7\u00e3o utilizados para estimar a velocidade velocidade da part\u00edcula no tempo \u201dn\u201d (pontos amarelos). . .\t32\nFigura 3.5 - Regi\u00e3o TVD de segunda ordem (sombreado em cinza) onde alguns esquemas de limitadores de fluxo s\u00e3o definidos. Axima \u00e9 limitado pelo esquema superbee (vermelho), abaixo pelo esquema Minmod (azul). Os esquemas Muscl e Van Leer est\u00e3o plotados em azul tracejado e marro, respectivamente. A abicis\u00e7a \"r\"\u00e9 a taxa dos gradientes consecutivos de concentra\u00e7\u00e3o. Fonte: adaptado pelo autor, Sweby, 1984 ............................... 35\nFigura 3.6 - Perfil de densidade ap\u00f3s dois per\u00edodos de oscila\u00e7\u00e3o para diferentes esquemas de limitadores de fluxo. A solu\u00e7\u00e3o exata corresponde a solu\u00e7\u00e3o inicial. Fonte: Fringer et al., 2005 ................................................ 37\nFigura 3.7 - Caso de advec\u00e7\u00e3o em campo de fluxo rotativos: Perfis de concentra\u00e7\u00f5es estimado com diferentes algor\u00edtimos de rf em x = 20 m ap\u00f3s a) 1 ciclo (Fonte: Kong et al., 2013) e b) 1 ciclo ou 5 ciclos (Fonte: Ye et al., 2018). 38\nFigura 4.1 - Model representation of the grid. (Source: Casulli e Lang, 2004) ....\t43\nFigura 4.2 - The initial free-surface profile for a linear 3D standing wave oscillation in a closed basin. source: Yuan e Wu (2004) ......................................... 49\nFigura 4.3 - Free surface elevation at x = y = 0.25 m for 30 seconds of simulation comparing analytic solution (solid black line) with simulated solution for 20 to 5 layers scenario with FSFS condition (left side) and for CBA condition (right side). At the bottom, we compare methods thought the 20 layer scenario and 8 layers scenario.......................................... 50\nFigura 4.4 - Free surface elevation accumulated residuals series for FSFS approach (left) and for CBA approach (right), at x=y=0.25 m for 30 seconds of simulation, comparing different layers scenarios................................. 50\nFigura 4.5 - Free surface vertical velocity (w) at x=y=0.25 m for 30 seconds of\nsimulation comparing analytic solution (solid black line) with simulated solution for 20 to 5 layers scenario with FSFS condition (left side) and for CBA condition (right side). At the bottom, we compare methods thought the 20 layer scenario and 8 layers scenario................. 52\nFigura 4.6 - Scheme of experimental bottom geometry and location of wave level gauges. Source: Beji e Battjes (1993)........................................... 53\nFigura 4.7 - Comparisons between experimental (circles) and computed data with\n20-layers (solid black), 16-layers (dashed gray), 10-layers (solid red) and\n5-layers (dashed blue), at 6 different level gauges........................ 54\nFigura 5.1 - Model representation of the grid. (Source: Casulli e Lang, 2004) ....\t63\nFigura 5.2 - Example of the velocity points used in the bilinear interpolation for the a) vertical faces (left), example for the particle stopped in up position, and b) horizontal faces (right), with the particle stopped in the fourth-quadrant position....................................................... 68\nFigura 5.3 - Example of model node point velocities for the quadratic interpolation. This illustration shows 27 points inside a computation cell, using information from nodes (in black), edge centers (in white) and face barycenters (in gray). The subscripts (l,m) denote the position of the vertical line (black lines) to be interpolated in the first step. n denotes the bottom, middle or top of a computation cell. The orange lines represent the second interpolation step, and the blue line represents the\nfinal interpolation step to estimate velocity of the particle at time tn. .\t70\nFigura 5.4 - The initial free-surface profile for a linear 3D standing wave oscillation\nin a closed basin. source: ?................................................ 72\nFigura 5.6 - Comparisons of the mass conservation of computational domain over the simulation (top) and the cumulative mass conservation (bottom) over the simulation time for the tested methods: No Advection (red dashed line), Bilinear (blue doted line) and Quadratic (black solid line) 74\nFigura 5.7 - Scheme of experimental bottom geometry and location of wave-level gauges. Source: Modified from Beji e Battjes (1993)........................... 75\nFigura 5.8 - Comparisons between experimental (circles) and computed data with a Bilinear interpolator (dashed line) and Quadratic interpolator (solid line), at 6 different level gauges............................................ 76\nFigura 5.9 - Comparisons of densitys profiles between the exact no-diffusive solution, and the No Advection (left), Bilinear (middle) and Quadratic (right) interpolators for several flux-limiter schemes, after two wave periods. .\t78\nFigura 5.10-Comparisons between density profiles of the exact solution, and the No-Advection (top), Bilinear (middle) and Quadratic (bottom) interpolations for all flux-limiter schemes, after two wave periods, at x = 0.0 m (left) and x = 0.4 m (right)................................................ 79\nTabela 4.1 - Metrics between the analytical and simulated results from the FSFS\nmethod for each scenario for the first 10 seconds of simulation........ 51\nTabela 4.2 - Statistics metrics between the analytical and simulated results from the\nCBA method for each scenario for the first 10 seconds of simulation . .\t51\nTabela 4.3 - Computational cost, Phases Error and number of wave periods between different methods and scenarios. The model was implemented with Fortran and simulated in a machine using an Intel R Xenon R CPU-\nE5-1620 3.7 GHz computer with 32 GB of RAM memory...................... 51\nTabela 4.4 - Nemenyi posthoc test comparing the FSFS residue series of the simulation with 20 to 5 vertical layers to indentify significative statiscal difference between results.......................................................... 52\nTabela 4.5 - Statistics metrics between simulated and experimental results for the\nsix stations for each used layer scenario with FSFS method ............ 55\nTabela 5.1 - Metrics between the analytical and simulated results each method for\n30 seconds of simulation .............................................. 73\nTabela 5.2 - Metrics between simulated and experimental results for the six stations\nfor bilinear and quadratic results..................................... 77\nTabela 5.3 - Metrics between the analytical and simulated results each method for\n30 seconds of simulation............................................... 79\nTabela 5.4 - Root Means Square errors (kg/m3) for the different flux limiter schemes\nafter two wave periods, for the No advection scenario, bilinear and\nquadratic interpolators................................................ 79\nCAPES\tCoordena\u00e7\u00e3o de Aperfei\u00e7oamento de Pessoal de N\u00edvel Superior\nCBA\tClassic Boundary Approach\nELM\tm\u00e9todo Euleriano-Lagrangiano\nFSFS\tFictional Sublayer at the Free-Surface\nIPH\tInstituto de Pesquisas Hidr\u00e1ulicas\nKGE\tKling-Gupta Efficiency\nNSE\tNash-Sutcliffe Efficiency\nPNH\tPress\u00e3o n\u00e3o-hidrost\u00e1tica\nRANS\tM\u00e9dia de Reynolds Navier-Stokes\nRMSE\tRoot mean square error\nRWPT\tRandom Walk Particle Tracking\nSPH\tSmoothed Particle Hydrodynamics\nTVD\tDiminui\u00e7\u00e3o da Varia\u00e7\u00e3o Total (Total Variation Diminishing)\nUFRGS\tUniversidade Federal do Rio Grande do Sul\nVari\u00e1vel\tUnidade\tDescri\u00e7\u00e3o\nC\t-\tConcentra\u00e7\u00e3o de um escalar\nCi,k\t-\tC para o i-\u00e9simo elemento em uma camada k\nDi,k\tm3/s\tcoeficiente de fluxo de difus\u00e3o para o i-\u00e9simo elemento em uma camada k\nDj,k\tm3/s\tcoeficiente de fluxo de difus\u00e3o para j-\u00e9sima face em uma camada k\nH\tm\taltura total da coluna de \u00e1gua\nHi\tm\tH para o i-\u00e9simo elemento\nH\tm\tH para j-\u00e9sima face\nkh\tm2/s\tcoeficiente horizontal da difusividade de eddy\nkh kj,k\tm2/s\tkh for j-th side and k-th layer\nkV\tm2/s\tcoeficiente vertical da difusividade de eddy\nkv i,k+ 1\tm2/s\tkv do i-\u00e9simo elemento na interface superior ou inferior\n\t\tda camada k\nL\tm\tcomprimento da base\nM\t-\t\u00edndice para a camada na superf\u00edcie livre\nNp\t-\tn\u00famero de elementos\nNs\t-\tn\u00famero de faces\nPi\t2 m\t\u00e1ra do i-\u00e9simo elemento\nQi,k\tm3/s\tfluxo advectivo para o i-\u00e9simo elemento em uma camada k\nQ j,k\tm3/s\tfluxo advectivo para j-\u00e9sima face em uma camada k\nSi\t-\tn\u00famero de faces de um elemento i\nS+k\t-\tfaces j de sa\u00edda de fluxo de um elemento i em uma camada k\nSi,k\t-\tFaces j de fluxo de entrada de um elemento i em uma camada k\nc\tm/s\tceleridade da onda\ndi,k\tm3/s\tcoeficiente de fluxo para um i-\u00e9simo elemento em uma camada k\ndj,k\tm3/s\tcoeficiente de fluxo para uma j-\u00e9sima face em uma camada k\njk\tm/s\tVj,k interpolado no passo de tempo tn\nVa\tm/s\tvelocidade do vendo na dire\u00e7\u00e3o y\nVari\u00e1vel\tUnidade\tDescri\u00e7\u00e3o\nw\tm/s\tvelocidade na dire\u00e7\u00e3o z\nwi,k+2\tm/s\tw para um i-\u00e9simo elemento na interface superior ou inferior de uma camada k\nwi,k+ 2\tm/s\twik+ 2 ap\u00f3s o passo da press\u00e3o hidrost\u00e1tica\nWi,k+ 2\tm/s\twik+ 2 interpolado para o passo de tempo tn\nx,y,z\tm\tcoordenadas cartesianas\nZk+ 2\tm\tcoordenada z da interface superior de uma camada k\nAzk\tm\tespessura de uma camada k na dire\u00e7\u00e3o z\nAzi,k\tm\tAz para um i-\u00e9simo elemento em uma camada k\nAzj,k\tm\tAz espessura para uma j-\u00e9sima face em uma camada k\n\t-\tdun\u00e7\u00f5es de Limitador de Fluxo\ntf\t-\tFator de limitador de fluxo\n\u00f5\tm\tdist\u00e2ncia entre centro de elementos adjacentes\n\u00f5j\tm)\t\u00f5 para uma j-\u00e9sima face\nn\tm\televa\u00e7\u00e3o da superf\u00edcie livre\nn\tm\tn para um i-\u00e9simo elemento\nni\tm\tn ap\u00f3s o passo da press\u00e3o hidrost\u00e1tica\nen\t-\ttoler\u00e2ncia do m\u00e9todo interativo de solu\u00e7\u00e3o do n\nYb\tm/s\tfator de fric\u00e7\u00e3o de fundo\nYt\tm/s\tfator de frinc\u00e7\u00e3o do topo\n\\\tm\tcomprimento de uma face j\nv h\tm2/s\tviscosidade horizontal de eddy\nv v\tm2/s\tviscosidade vertical de eddy\nv v vi,k\tm2/s\tvv para um i-\u00e9simo elemento em uma camada k\nv v jk\u00b1 2\tm2/s\tvv para uma j-\u00e9sima face na interface superior ou inferior de uma camada k\np\tkg/m3\tdensidade da \u00e1gua water density\npi,k\tkg/m3\tp para um i-\u00e9simo elemento em uma camada k\npa\tkg/m3\tdensidade do ar\npo\t-\tdensidade de refer\u00eancia da \u00e1gua\ne\t-\tfator de implicita\u00e7\u00e3o da solu\u00e7\u00e3o substep (subcycle) index\nn + e\t-\t\u00edndice de sub-passo de tempo\nAh\t1/m2\tdiscretiza\u00e7\u00e3o do laplaciano horizontal\nF\t-\tOperado de diferen\u00e7a finita expl\u00edcito\n1\tINTRODU\u00c7\u00c3O .............................................16\n1.1\tQuest\u00f5es Cient\u00edficas....................................18\n2\tOBJETIVOS...............................................19\n2.1\tObjetivo Geral .........................................19\n2.2\tObjetivos Espec\u00edficos...................................19\n2.3\tOrganiza\u00e7\u00e3o do trabalho ................................19\n3\tREVIS\u00c3O BIBLIOGR\u00c1FICA...................................21\n3.1\tModelo IPH-ECO .........................................21\n3.2\tPress\u00e3o (N\u00e3o)hidrost\u00e1tica ..............................23\n3.3\tM\u00e9todo Euleriano-Lagrangiano............................28\n3.4\tTransporte de Soluto....................................31\n4\tIMPROVEMENT OF NONHYDROSTATIC HYDRODYNAMIC SO-\nLUTION USING A NOVEL FREE-SURFACE BOUNDARY CONDITION .................................................. 36\n5\tCOMBINED USE OF HIGH RESOLUTION\tNUMERICAL SCHE-\nMES TO REDUCE NUMERICAL DIFFUSION IN COUPLED HYDRODYNAMIC AND SOLUTE TRANSPORT MODELS ................ 53\nConclus\u00e3o........................................................76\n6\tCONCLUS\u00c3O ..............................................77\nRefer\u00eancias......................................................79\nIntrodu\u00e7\u00e3o\nModelos acoplados hidrodin\u00e2mico e transporte de soluto s\u00e3o ferramentas bem estabelecidas para simula\u00e7\u00e3o de escoamentos de superf\u00edcie livre em grandes ecossistemas aqu\u00e1ticos, como lagos, estu\u00e1rios, reservat\u00f3rios e zonas costeiras (e.g. Valipour et al., 2015; de Brito Jr et al., 2018; Vilas et al., 2017; Soulignac et al., 2017; Munar et al., 2018).\nA representa\u00e7\u00e3o da din\u00e2mica da estratifica\u00e7\u00e3o t\u00e9rmica em ecossistemas aqu\u00e1ticos regula muitos processos f\u00edsicos, qu\u00edmicos e biol\u00f3gicos, tais como, distribui\u00e7\u00e3o de esp\u00e9cies, taxas de rea\u00e7\u00f5es qu\u00edmicas e metab\u00f3licas, ciclagem de nutrientes e concentra\u00e7\u00e3o de gases dissolvidos (Horne e Goldman, 1994). Esta estratifica\u00e7\u00e3o depende da hidrodin\u00e2mica do corpo h\u00eddrico e das for\u00e7antes em seu sistema como, for\u00e7antes climatol\u00f3gicas (e.g. velocidade e dire\u00e7\u00e3o, temperatura do ar e radia\u00e7\u00e3o solar) e for\u00e7antes da bacia hidrogr\u00e1fica de contribui\u00e7\u00e3o (e.g. vaz\u00f5es e temperatura dos afluentes e carga de mat\u00e9ria org\u00e2nica, etc.). Para modelagem num\u00e9rica, a representa\u00e7\u00e3o acurada desta din\u00e2mica demanda solu\u00e7\u00f5es mais complexas que sejam capazes de representar acuradamente processos f\u00edsicos chave como, distribui\u00e7\u00e3o do campo de velocidades (vertical e horizontal), ondas internas promovidas por gradientes de concentra\u00e7\u00e3o, e a difus\u00e3o real.\nNeste contexto, duas principais quest\u00f5es em modelagem num\u00e9rica se destacam: (i) Utiliza\u00e7\u00e3o de solu\u00e7\u00f5es mais completas da equa\u00e7\u00e3o de Navier-Stokes; e (ii) difus\u00e3o num\u00e9rica. A primeira se refere \u00e0 representa\u00e7\u00e3o dos processos que geram escoamento. Na simula\u00e7\u00e3o hidrodin\u00e2mica, quando a raz\u00e3o das escalas de movimento vertical para horizontal n\u00e3o \u00e9 pequena (e.g., fluxos mudando abruptamente a topografia de fundo, movimentos orbitais em movimentos de ondas curtas ou circula\u00e7\u00f5es verticais intensas), um modelo tri-dimensional com aproxima\u00e7\u00e3o n\u00e3o-hidrost\u00e1tica pode ser necess\u00e1rio para simular escoamentos de superf\u00edcie livre com precis\u00e3o e baixo custo computacional (Casulli e Stelling, 1998; Casulli e Lang, 2004; Chen, 2003; Monteiro e Schettini, 2015; Liu et al., 2017). A segunda, refere-se \u00e0 difus\u00e3o artificial associada \u00e0 solu\u00e7\u00e3o num\u00e9rica empregada nos termos de advec\u00e7\u00e3o e difus\u00e3o das equa\u00e7\u00f5es RANS (Reynolds Averaged Navier Stokes) e de transporte de soluto (Chapra et al., 2010).\nTal quest\u00e3o num\u00e9rica \u00e9 agravada quando solu\u00e7\u00f5es de mais baixa ordem s\u00e3o aplicadas para solu\u00e7\u00e3o num\u00e9rica de equa\u00e7\u00f5es diferenciais parciais (e.g. Cheng et al., 1984; Laval et al., 2003a; Fringer et al., 2005; Zijlema e Stelling, 2005), levando a modelos num\u00e9ricos,\nCap\u00edtulo 1. Introdu\u00e7\u00e3o\n17\npor exemplo, considerar nulo o coeficiente de difus\u00e3o, pois assumem que a difus\u00e3o num\u00e9rica representa a difus\u00e3o real. Para aumentar a ordem da solu\u00e7\u00e3o, uma alternativa num\u00e9rica conservativa, com baixo custo de implementa\u00e7\u00e3o e computacional, \u00e9 a utiliza\u00e7\u00e3o de m\u00e9todos de alta resolu\u00e7\u00e3o na solu\u00e7\u00e3o hidrodin\u00e2mica e de transporte, como: uso de interpola\u00e7\u00f5es n\u00e3o lineares no m\u00e9todo Euleriano-Lagrangiano (ELM) e Limitadores de Fluxo aplicados \u00e0 solu\u00e7\u00e3o transporte de soluto (Cheng et al., 1984; Staniforth e C\u00f4t\u00e9, 1991; Tamamidis e Assanis, 1993; Hodges et al., 2000; Fringer et al., 2005; Cox e Runkel, 2008; Kong et al., 2013; Ye et al., 2018; Zhang et al., 2018). Esta solu\u00e7\u00e3o num\u00e9rica menos difusiva permite que o modelo num\u00e9rique utilize o coeficiente de difus\u00e3o como par\u00e2metro de calibra\u00e7\u00e3o, e assim utilizando a equa\u00e7\u00e3o RANS completa.\nPara modelos de Transporte de Soluto, normalmente \u00e9 assumido que a solu\u00e7\u00e3o num\u00e9rica hidrodin\u00e2mica \u00e9 livre de difus\u00e3o num\u00e9rica e que nenhum erro seja levado \u00e0 solu\u00e7\u00e3o de Transporte de Soluto. Assim, a avalia\u00e7\u00e3o formal por modelos n\u00e3o acoplados do efeito da difus\u00e3o num\u00e9rica hidrodin\u00e2mica na solu\u00e7\u00e3o de Transporte de Soluto pode n\u00e3o ser apropriadamente abordada (Cheng et al., 1984; Ruan e McLaughlin, 1999; Cox e Runkel, 2008). Por outro lado, trabalhos que utilizam modelos acoplados prop\u00f5em melhorias no m\u00f3dulo hidrodin\u00e2mico ou de transporte para investigar a difus\u00e3o num\u00e9rica em uma das solu\u00e7\u00f5es, separadamente, sem considerar que o uso ou n\u00e3o de m\u00e9todos de alta resolu\u00e7\u00e3o em uma solu\u00e7\u00e3o pode afetar a outra (Wadzuk e Hodges, 2004; Fringer et al., 2005; Casulli e Zanolli, 2005; Kong et al., 2013; Ye et al., 2018; Zhang et al., 2018; Chandran et al., 2019). Posto isto, mais esfor\u00e7os ainda s\u00e3o necess\u00e1rios para entender como a difus\u00e3o num\u00e9rica, produzida por esquemas de baixa resolu\u00e7\u00e3o em solu\u00e7\u00e3o hidrodin\u00e2mica, pode ser transferida para o Transporte de Solutos, e como o uso combinado de esquemas de alta resolu\u00e7\u00e3o podem reduzir o efeito da difus\u00e3o num\u00e9rica na solu\u00e7\u00e3o do Transporte de Soluto.\nPara uma an\u00e1lise coerente dos resultados, os experimentos num\u00e9ricos precisam ser aplicados utilizando um modelo hidrodin\u00e2mico n\u00e3o-hidrost\u00e1tico eficiente, pois trata-se de situa\u00e7\u00f5es as quais a premissa da press\u00e3o hidrost\u00e1tica n\u00e3o representa adequadamente os processos f\u00edsicos chave destas an\u00e1lises (Chen, 2003; Stelling e Zijlema, 2003; Zijlema e Stelling, 2005; Monteiro e Schettini, 2015; Liu et al., 2017). Para isto, identificamos ser necess\u00e1rio um modelo n\u00e3o-hidrost\u00e1tico que trate adequadamente a condi\u00e7\u00e3o de contorno da superf\u00edcie livre (Stelling e Zijlema, 2003; Yuan e Wu, 2004; Zijlema e Stelling, 2005; Lv, 2014; Lu et al., 2015; Liu et al., 2017; Escalante et al., 2018b), onde propomos um novo tratamento para condi\u00e7\u00e3o de contorno, que dentre as existentes se enquadra com uma m\u00e9dia efici\u00eancia e com baixo custo de implementa\u00e7\u00e3o.\nPara tanto, o trabalho teve como principal objetivo contribuir para o entendimento do efeito da difus\u00e3o num\u00e9rica nas solu\u00e7\u00f5es hidrodin\u00e2mica e de transporte, assim como a rela\u00e7\u00e3o m\u00fatua entre ambas as difus\u00f5es nas solu\u00e7\u00f5es num\u00e9ricas. Desta forma, visando contornar o efeito de solu\u00e7\u00f5es num\u00e9ricas simplificadas, buscou-se, verificar e validar\nsolu\u00e7oes num\u00e9ricas mais completas com m\u00e9todos de alta resolu\u00e7\u00e3o no modelo acoplado hidrodin\u00e2mico-transporte IPH-ECO.\n1.1\tQuest\u00f5es Cient\u00edficas\nCom base no contexto apresentado, algumas quest\u00f5es cientificas se destacam, as quais respondemos nas se\u00e7\u00f5es posteriores do presente trabalho:\n1.\tA implementa\u00e7\u00e3o de um tratamento exclusivamente para condi\u00e7\u00e3o de contorno da superf\u00edcie livre da press\u00e3o n\u00e3o-hidrost\u00e1tica pode melhorar de maneira significativa a efici\u00eancia de modelos n\u00e3o-hidrost\u00e1ticos?\n2.\tQual impacto a difus\u00e3o num\u00e9rica gerada por esquemas de baixa resolu\u00e7\u00e3o, aplicados \u00e0 solu\u00e7\u00e3o hidrodin\u00e2mica, pode gerar na solu\u00e7\u00e3o do transporte de soluto aplicada com m\u00e9todos de alta resolu\u00e7\u00e3o em escoamentos estratificados?\n3.\tQual impacto a difus\u00e3o num\u00e9rica gerada por esquemas de baixa resolu\u00e7\u00e3o aplicados \u00e0 solu\u00e7\u00e3o do transporte pode gerar na solu\u00e7\u00e3o hidrodin\u00e2mica de escoamentos estratificados?\n4.\tA redu\u00e7\u00e3o da difus\u00e3o num\u00e9rica pelo uso combinado de m\u00e9todos de alta resolu\u00e7\u00e3o \u00e9 eficiente para propriamente simular escoamentos estratificados?\nObjetivos\n2.1\tObjetivo Geral\nContribuir para o para o entendimento do efeito da difus\u00e3o num\u00e9rica nas solu\u00e7\u00f5es hidrodin\u00e2mica e de transporte de soluto, assim como a rela\u00e7\u00e3o m\u00fatua entre ambas as solu\u00e7\u00f5es.\nPara tal foi necess\u00e1rio o aprimoramento da ferramenta computacional utilizada neste trabalho (IPH-ECO) para utilizar solu\u00e7\u00f5es mais completas e menos difusas.\n2.2\tObjetivos Espec\u00edficos\n1.\timplementar no modelo IPH-ECO solu\u00e7\u00f5es num\u00e9ricas mais completas (press\u00e3o n\u00e3o-hidrost\u00e1tica), avaliando sua efici\u00eancia em representar escoamentos em \u00e1guas profundas, escoamentos n\u00e3o lineares e redu\u00e7\u00e3o do custo computacional de simula\u00e7\u00f5es hidrodin\u00e2micas n\u00e3o-hidrost\u00e1ticas.\n2.\tImplementar m\u00e9todos de alta resolu\u00e7\u00e3o (limitadores de fluxo e interpola\u00e7\u00e3o quadr\u00e1tica) para estabelecer uma rela\u00e7\u00e3o de difus\u00e3o num\u00e9rica entre o uso combinado ou n\u00e3o de m\u00e9todos de alta resolu\u00e7\u00e3o nas solu\u00e7\u00e3o hidrodin\u00e2mica e de transporte de soluto\n2.3\tOrganiza\u00e7\u00e3o do trabalho\nA disserta\u00e7\u00e3o foi dividido em 6 cap\u00edtulos, sendo os dois primeiros introdu\u00e7\u00e3o e revis\u00e3o bibliogr\u00e1fica, que embasam os principais temas abordados nos cap\u00edtulos subsequentes. Com inten\u00e7\u00e3o de responder as quest\u00f5es cient\u00edficas levantadas, dois estudos foram desenvolvidos, apresentados na forma de artigo, constituindo os cap\u00edtulos 4 e 5 do trabalho final.\nCap\u00edtulo 4\nImprovement of nonhydrostatic hydrodynamic solution using a novel free-surface boundary condition\nCap\u00edtulo 5\nCombined use of high resolution numerical schemes to reduce numerical diffusion in coupled hydrodynamic and solute transport models\nA pesquisa desenvolvida nesta disserta\u00e7\u00e3o teve in\u00edcio no Cap\u00edtulo 4, onde a aproxima\u00e7\u00e3o n\u00e3o-hidrost\u00e1tica com um tratamento da condi\u00e7\u00e3o de contorno da superf\u00edcie livre foi implementada no modelo IPH-ECO. O m\u00e9todo foi verificado e validado atrav\u00e9s de experimentos num\u00e9ricos. O algor\u00edtimo se mostrou capaz de simular adequadamente a celeridade e a dispers\u00e3o de frequ\u00eancia de ondas estacion\u00e1rias em um reservat\u00f3rio profundo de forma acurada utilizando menos camadas verticais que um modelo n\u00e3o-hidrost\u00e1tico cl\u00e1ssico, sem tratamento na condi\u00e7\u00e3o de contorno, consequentemente diminuindo o custo computacional de simula\u00e7\u00f5es n\u00e3o-hidrost\u00e1ticas com um baixo custo de implementa\u00e7\u00e3o.\nO cap\u00edtulo 5 apresenta experimentos num\u00e9ricos visando identificar o efeito da difus\u00e3o num\u00e9rica nas solu\u00e7\u00e3o do transporte e hidrodin\u00e2mica. Implementamos m\u00e9todos de interpola\u00e7\u00e3o de alta resolu\u00e7\u00e3o (interpola\u00e7\u00e3o quadr\u00e1tica) e baixa resolu\u00e7\u00e3o (interpola\u00e7\u00e3o bilinear) para estimar as velocidades ao final da linha de corrente (ELM passo-ii), al\u00e9m da implementa\u00e7\u00e3o de limitadores de fluxo para reduzir a difus\u00e3o num\u00e9rica na solu\u00e7\u00e3o do transporte de soluto. Anteriormente era utilizado no Modelo IPH-ECO uma interpola\u00e7\u00e3o linear simples neste passo do ELM. As implementa\u00e7\u00f5es foram verificadas e validadas em experimentos num\u00e9ricos puramente advectivos, onde identificamos que a difus\u00e3o num\u00e9rica gerada na solu\u00e7\u00e3o hidrodin\u00e2mica pode ter grande efeito na solu\u00e7\u00e3o do Transporte de Soluto.\nA press\u00e3o n\u00e3o-hidrost\u00e1tica foi implementada como proposto por Casulli e Lang (2004), adicionando um novo tratamento para condi\u00e7\u00e3o sua contorno na superf\u00edcie livre. Os m\u00e9todos de alta resolu\u00e7\u00e3o implementados na solu\u00e7\u00e3o hidrodin\u00e2mica e de transporte foram, respectivamente, a interpola\u00e7\u00e3o quadr\u00e1tica e esquemas de limitadores de fluxo. A interpola\u00e7\u00e3o quadr\u00e1tica (baseada em Hodges et al., 2000) \u00e9 aplicada no M\u00e9todo Euleriano-Lagrangiano (ELM) para estimar as velocidades no ponto ao fim da linha de corrente. Os limitadores de fluxo (Fringer et al., 2005; Waterson e Deconinck, 2007; Kong et al., 2013) s\u00e3o aplicados \u00e0 equa\u00e7\u00e3o do transporte de soluto, funcionando como um termo de corre\u00e7\u00e3o para situa\u00e7\u00f5es em que a difus\u00e3o num\u00e9rica pode ser elevada. A seguir, ser\u00e1 apresentado uma introdu\u00e7\u00e3o sobre (i) o modelo utilizado e a contribui\u00e7\u00e3o deste trabalho em seu desenvolvimento; e (ii) cada um dos principais temas desenvolvidos neste trabalho, a saber, press\u00e3o n\u00e3o hidrost\u00e1tica, M\u00e9todo Euleriano-Lagrangiano e Limitadores de Fluxo.\nRevis\u00e3o Bibliogr\u00e1fica\n3.1\tModelo IPH-ECO\nO modelo IPH-ECO Fragoso Jr et al. (2009) \u00e9 uma ferramenta computacional din\u00e2mica capaz de simular ecossistemas aqu\u00e1ticos continentais (como rios, lagos, reservat\u00f3rios e estu\u00e1rios), representando processos f\u00edsicos, qu\u00edmicos e biol\u00f3gicos. O modelo encontra-se em desenvolvimento cont\u00ednuo pelo Grupo de Pesquisa em Ecotecologia, do Instituto de Pesquisas Hidr\u00e1ulicas (IPH) da Universidade Federal do Rio Grande do Sul (UFRGS), consiste em dois m\u00f3dulos principais: o m\u00f3dulo hidrodin\u00e2mico e o m\u00f3dulo de qualidade da \u00e1gua. A parte Hidrodin\u00e2mica resolve as Equa\u00e7\u00f5es de Reynolds Navier-Stokes em tr\u00eas dimens\u00f5es usando uma t\u00e9cnica de diferen\u00e7as finitas semi-impl\u00edcitas em malhas triangulares n\u00e3o-estruturadas ou retangulares estruturadas, enquanto a parte da Qualidade da \u00c1gua \u00e9 capaz de simular os principais processos relevantes para o balan\u00e7o de nutrientes, diag\u00eanese de sedimentos e estrutura de ambientes aqu\u00e1ticos. A liga\u00e7\u00e3o entre os dois m\u00f3dulos \u00e9 realizada pela solu\u00e7\u00e3o num\u00e9rica de uma equa\u00e7\u00e3o de transporte tridimensional respons\u00e1vel por termos advectivos, difusivos e reativos usando um esquema de volume finitos em malhas (n\u00e3o) estruturadas. A integra\u00e7\u00e3o de tempo da Equa\u00e7\u00e3o de Transporte \u00e9 realizada usando um algoritmo Local Time-Stepping conservador e est\u00e1vel (Cavalcanti et al., 2016), permitindo simula\u00e7\u00f5es hidridin\u00e2mica e de qualidade de \u00e1gua r\u00e1pidas e precisas.\nA primeira vers\u00e3o do modelo, denominada IPH-TRIM2D, foi constru\u00edda por Walter Collischonn e apresentada no Congresso Brasileiro de Limnologia (Collischonn e Marques, 2003). O formato inicial considerou uma vis\u00e3o 2D (X-Y) do dom\u00ednio usando uma grade estruturada e aplicada principalmente para simular a hidrodin\u00e2mica de lagos rasos. Posteriormente foi aprimorada por C. Ruberto Fragoso Jr. (Fragoso Jr, 2005) por meio da adi\u00e7\u00e3o de um algoritmo linear de wet- e dry-ing (Cheng et al., 1993; da Paz et al., 2003) e avan\u00e7o na solu\u00e7\u00e3o num\u00e9rica de campo de velocidade e n\u00edvel de \u00e1gua na inclus\u00e3o do m\u00e9todo 0 (Casulli e Cattani, 1994), alterando a solu\u00e7\u00e3o de transporte escalar, adicionando um novo esquema num\u00e9rico conservativo para advec\u00e7\u00e3o Gross et al. (1998) e definindo um m\u00f3dulo simplificado para fitopl\u00e2ncton biomassa (Fragoso Jr et al., 2008). No entanto, houve a necessidade de se compreender processos internos mais complexos e vari\u00e1veis de qualidade da \u00e1gua, ent\u00e3o realizado por realizado por C. Ruberto Fragoso Jr., ao associar o modelo IPH-TRIM2D a um modelo ecol\u00f3gico complexo, denominado PC-Lake (Fragoso Jr et al.,\nCap\u00edtulo 3. Revis\u00e3o Bibliogr\u00e1fica\n22\n2009; Janse, 2005). De modo resultante o modelo foi renomeado para IPHTRIM3D-PCLake (Fragoso Jr et al., 2009), e mais recentemente como modelo IPH-ECO (Cavalcanti et al., 2016; de Brito Jr et al., 2018). A ultima foi capaz de descrever fluxos tridimensionais e estratifica\u00e7\u00e3o t\u00e9rmica em lagos rasos (Fragoso Jr et al., 2011).\nRecentemente, a solu\u00e7\u00e3o hidrodin\u00e2mica do modelo IPH-ECO foi aprimorada para utilizar dom\u00ednios n\u00e3o estruturados em duas e tr\u00eas dimens\u00f5es por Fabio F. Pereira (Pereira, 2010; Pereira et al., 2013) e J. Rafael Cavalcanti (Cavalcanti, 2017). Esta nova vers\u00e3o, denominada UnIPH-ECO, resolve as equa\u00e7\u00f5es diferenciais parciais usando uma malha ortogonal triangular n\u00e3o estruturada. Al\u00e9m disso, o c\u00f3digo do modelo foi aprimorado usando um novo algoritmo de secagem e inunda\u00e7\u00e3o n\u00e3o-linear e uma nova solu\u00e7\u00e3o de passo de Tempo Local para transporte escalar (Cavalcanti et al., 2015). \u00c9 importante ressaltar que, o principal c\u00f3digo do IPH-ECO est\u00e1 sendo melhorado e de forma constante atualizado pelos estudantes e pesquisadores que atuam em diferentes projetos associados ao Grupo de Pesquisa em Ecotecnologia da UFRGS. Para mais informa\u00e7\u00f5es, foi desenvolvida a plataforma digital do programa, podendo ser acessada atrav\u00e9s do endere\u00e7o http://ipheco.yooh.com.br.\nO presente trabalho colabora com o desenvolvimento do modelo nos m\u00f3dulos hidrodin\u00e2mico e qualidade de \u00e1gua, melhorando sua capacidade de modelar escoamentos em \u00e1guas profundas e estratificados em tr\u00eas dimens\u00f5es, atrav\u00e9s da implementa\u00e7\u00e3o de solu\u00e7\u00f5es mais completas das equa\u00e7\u00f5es RANS e m\u00e9todos de alta resolu\u00e7\u00e3o. De modo espec\u00edfico, as implementa\u00e7\u00f5es foram:\n\u2022\tpress\u00e3o n\u00e3o-hidrost\u00e1tica com uma nova abordagem para o tratamento da condi\u00e7\u00e3o de contorno da superf\u00edcie livre (Casulli e Lang, 2004);\n\u2022\tInterpola\u00e7\u00e3o das velocidades ortogonais \u00e0s faces, calculadas na solu\u00e7\u00e3o hidrodin\u00e2mica, em componentes de velocidades x e y nas faces, v\u00e9rtices e arestas de uma c\u00e9lula computacional.\n\u2022\tinterpola\u00e7\u00e3o bilinear aplicada ao passo-ii do ELM (Casulli e Cheng, 1992);\n\u2022\tinterpola\u00e7\u00e3o quadr\u00e1tica aplicada ao passo-ii do ELM (Hodges et al., 2000);\n\u2022\tesquemas de limitadores de fluxo baseados nos gradientes consecutivos (rf) (Fringer et al., 2005; Waterson e Deconinck, 2007);\n\u2022\timplementa\u00e7\u00e3o do c\u00e1lculo do rf baseado no proposto por Kong et al. (2013);\nO modelo foi formalmente verificado e validado atrav\u00e9s de benchmarks para as solu\u00e7\u00f5es hidrodin\u00e2mica e de transporte. Os testes foram aplicados em malhas estruturadas e posteriormente ser\u00e3o feitas an\u00e1lises para verifica\u00e7\u00e3o e valida\u00e7\u00e3o do c\u00f3digo em malhas n\u00e3o-estruturadas.\nCap\u00edtulo 3. Revis\u00e3o Bibliogr\u00e1fica\n23\nCom esta modifica\u00e7\u00f5es o modelo possui o potencial de representa\u00e7\u00e3o de processos similar \u00e0 outros modelos consagrados como o ELCOM (Wadzuk e Hodges, 2004), SUNTANS (Fringer et al., 2006) e o FVCOM (Chen et al., 2011). O esquema abaixo relaciona o potencial de representa\u00e7\u00e3o de processos do IPH-ECO \u00e0 de outros modelos, ainda mostrado a representa\u00e7\u00e3o atual (Fragoso Jr et al., 2009) e a atual.\nCircula\u00e7\u00e3o global\nEscoamentos 1 Estratificados ,\nT\n4-4\n4-4\nI\tI\tI\nOndas de 1 Escoamentos em Escoamentos em 1 Gravidade , \u00e1guas profundas \u00e1gua rasas j\ni\ti&lt;\tI\n1\t'&lt;\tI\ni\ti~\ti\n1\t4\t!\ni\ti\tr\n1\t1\t1\nI\tI\tI\n</)\n2\nLU Q\nO\n2\nPress\u00e3o hidrost\u00e1tica\nAdvec\u00e7\u00e3o de baixa resolu\u00e7\u00e3o\nTransporte de baixa resolu\u00e7\u00e3o Press\u00e3o n\u00e3o-hidrost\u00e1tica\nAdvec\u00e7\u00e3o de Alta-Resolu\u00e7\u00e3o\nTransporte de Alta-Resolu\u00e7\u00e3o\nIPH-ECO: Fragoso Jr. (2009) SELFE: Zhang and Baptista (2008) SisBaHiA: Rosman (2015) TELEMAC3D: Jankowski (1991) UnTrim: Casulli and Lang (2004) ELCOM: Wadzuk and Hodges (2004) SUNTANS: Fringer et al (2006) IPH-ECO: Trabalho Atual FVCOM: Chen et al., (2011)\n4\n4\n4\n4\ni\n*\nI\n* Advec\u00e7\u00e3o de Alta-Resolu\u00e7\u00e3o: M\u00e9todo Euleriano-Lagragiano com interpola\u00e7\u00e3o quadr\u00e1tica, m\u00e9todos de ordem similar ou superior *Transporte de Alta-Resolu\u00e7\u00e3o: M\u00e9todo com fun\u00e7\u00f5es de limitadores de fluxo, m\u00e9todos de segunda ordem ou superior\nFigura 3.1 - Rela\u00e7\u00e3o entre modelos num\u00e9ricos, representa\u00e7\u00e3o de processos e atributos implementados . Fontes: (Fragoso Jr et al., 2009; Casulli e Lang, 2004; Rosman et al., 2015; Fringer et al., 2006; Wadzuk e Hodges, 2004; Zhang e Baptista, 2008; Jankowski, 1999; Chen et al., 2011)\nA avalia\u00e7\u00e3o foi feita relacionando os m\u00e9todos num\u00e9ricos implementados nos modelos num\u00e9ricos quanto a press\u00e3o, esquema de advec\u00e7\u00e3o e esquema de transporte de soluto, especificamente, qual a robustez da implementa\u00e7\u00e3o dos termos de press\u00e3o, advec\u00e7\u00e3o e transporte de soluto. Com a implementa\u00e7\u00e3o dos novos m\u00e9todos omodelo IPH-ECO passa da representa\u00e7\u00e3o de processos em \u00e1guas rasas para \u00e1guas profundas com boa capacidade de representar ondas gravitacionais e escoamentos estratificados.\n3.2\tPress\u00e3o (N\u00e3o)hidrost\u00e1tica\nA seguir ser\u00e1 apresentado as equa\u00e7\u00f5es governantes de modelos hidrodin\u00e2micos hidrost\u00e1ticos e n\u00e3o-hidrost\u00e1ticos, discutindo sobre a vantagem em utilizar modelos n\u00e3o-hidrost\u00e1ticos, e em como melhorar sua efici\u00eancia.\nA equa\u00e7\u00e3o governante que descreve escoamentos de superf\u00edcie livre pode ser derivada da equa\u00e7\u00e3o RANS (Reynolds Avarage Navier-Stokes). Estas equa\u00e7\u00f5es expressam o princ\u00edpio f\u00edsico da conserva\u00e7\u00e3o do volume, massa e do momento (Casulli e Lang, 2004). As equa\u00e7\u00f5es do momentum para um flu\u00eddo incompress\u00edvel com a press\u00e3o decomposta na soma das\nCap\u00edtulo 3. Revis\u00e3o Bibliogr\u00e1fica\n24\npartes hidrost\u00e1tica (press\u00e3o barotr\u00f3pica e barocl\u00ednica) e n\u00e3o-hidrost\u00e1tica tem a seguinte forma:\ndu\tdu\tdu\tdu\nu + v +w - fv = dt\tdx\tdy\tdz\ndpa\tdy\td\ndx\tdx\tdx\ndq dx\n(3.1)\n+v h\nd 2u\ndx2 +\nd 2u dy2\nd_ + d~z\nV\ndu\n~dz\ndv\tdv\tdv\tdv\nu +v +w +fu = dt\tdx\tdy\tdz\ndpa dy\td\ndy dy dy\ndq dy\n(3.2)\ndw\tdw\tdw\tdw\nu + v + w = dt\tdx\tdy\tdz\nd2v\td2v\ndx2 + dy2\n\u2022 d C\u00ed\ndq h \u00edd2w\td2w\\\ndz + dx2 + dy2\nd_ + dz\n(\" \u2022 \u00ed')\n(3.3)\n+v h\nSendo u(x,y,z,t,), v(x,y,z,t) e w(x,y,z,t) s\u00e3o os componentes de velocidade nas dire\u00e7\u00f5es horizontal (x e y) e vertical (z), onde vh e vv s\u00e3o os coeficientes de viscosidade turbulenta horizontal e vertical, respectivamente; t \u00e9 o tempo; pa(x,y, z,t) \u00e9 a press\u00e3o atmosf\u00e9rica; n \u00e9 a eleva\u00e7\u00e3o de superf\u00edcie livre de uma refer\u00eancia de n\u00edvel de \u00e1gua. O\nsegundo e o terceiro termos do lado direito das equa\u00e7\u00f5es (3.1) e (3.2) representam as contribui\u00e7\u00f5es barotr\u00f3pica e barocl\u00ednica da press\u00e3o; q(x,y,z,t) refere-se ao componente de press\u00e3o n\u00e3o-hidrost\u00e1tica; f \u00e9 o par\u00e2metro de Coriolis; e g \u00e9 a acelera\u00e7\u00e3o gravitacional.\nModelos hidrodin\u00e2micos usualmente adotam simplifica\u00e7\u00f5es \u00e0s equa\u00e7\u00f5es RANS buscando obter resultados satisfat\u00f3rios com um baixo custo computacional como, a utiliza\u00e7\u00e3o de modelos bidimensionais e aproxima\u00e7\u00e3o hidrost\u00e1tica do termo de press\u00e3o. Quando a abordagem hidrost\u00e1tica \u00e9 considerada, a equa\u00e7\u00e3o (3.3) \u00e9 negligenciada e q \u00e9 definido igual a zero nas equa\u00e7\u00f5es (3.1) e (3.2). Neste caso, assume-se que a acelera\u00e7\u00e3o vertical n\u00e3o tem um efeito significativo no campo de velocidade em compara\u00e7\u00e3o com a acelera\u00e7\u00e3o horizontal, que \u00e9 a suposi\u00e7\u00e3o geralmente aplicada para a simula\u00e7\u00e3o de \u00e1guas rasas. Entretanto, h\u00e1 muitos casos onde esta suposi\u00e7\u00e3o n\u00e3o representa adequadamente alguns processos f\u00edsicos (escalas dos movimentos horizontais pelo menos 20 vezes menores do que a profundidade ou declividade superior a 1/20, Rosman et al., 2015), a figura 3.2 apresenta, por exemplo, o erro de fase gerado pela aproxima\u00e7\u00e3o hidrost\u00e1tica em simula\u00e7\u00e3o de ondas estacion\u00e1rias em situa\u00e7\u00e3o de \u00e1guas profundas. A escala e o tipo do processo f\u00edsico a ser simulado \u00e9 determinante para ado\u00e7\u00e3o ou n\u00e3o de modelos mais simplificados\nFigura 3.2 - Varia\u00e7\u00e3o da superf\u00edcie livre em x = y = 0,25 m comparando o erro de fase entre solu\u00e7\u00e3o anal\u00edtica (c\u00edrculo vermelho), solu\u00e7\u00e3o hidrost\u00e1tica com 30 camadas (linha s\u00f3lida figura superior) e solu\u00e7\u00e3o n\u00e3o-hidrost\u00e1tica (linha s\u00f3lida figura inferior). Fonte: Liu et al. (2017)\nPress\u00e3o\tEscala de dist\u00e2ncia\nFigura 3.3 - Rela\u00e7\u00e3o entre escala de processos e solu\u00e7\u00e3o do termo de press\u00e3o indicada. Fonte: Marshall et al. (1997)\nCap\u00edtulo 3. Revis\u00e3o Bibliogr\u00e1fica\n26\n(Marshall et al., 1997). A figura 3.3 apresenta a rela\u00e7\u00e3o entre escala de processos e tipo de aproxima\u00e7\u00e3o (hidrost\u00e1tica ou n\u00e3o-hidrost\u00e1tica) que melhor se ad\u00e9qua a sua representa\u00e7\u00e3o.\nExiste um trade-off entre o custo de implementa\u00e7\u00e3o e o custo computacional quando abordagens hidrost\u00e1ticas e n\u00e3o-hidrost\u00e1ticas s\u00e3o comparadas. A abordagem n\u00e3o-hidrost\u00e1tica, em geral, requer m\u00e9todos num\u00e9ricos interativos mais complexos (Stelling e Zijlema, 2003; Casulli e Lang, 2004; Lu et al., 2015), o que aumenta o custo computacional comparado \u00e0 abordagem hidrost\u00e1tica usando uma mesma grade computacional. Entretanto, a abordagem n\u00e3o-hidrost\u00e1tica melhora a representa\u00e7\u00e3o f\u00edsica do fen\u00f4meno requerendo um n\u00famero menor de camadas verticais para alcan\u00e7ar resultados fisicamente satisfat\u00f3rios em compara\u00e7\u00e3o com a abordagem hidrost\u00e1tica. Assim, para se obter resultados semelhantes \u00e0 simula\u00e7\u00e3o n\u00e3o-hidrost\u00e1tica, a abordagem hidrost\u00e1tica necessita de alta resolu\u00e7\u00e3o vertical, implicando em um maior custo computacional em rela\u00e7\u00e3o \u00e0 abordagem n\u00e3o-hidrost\u00e1tica (Liu et al., 2017).\nApesar do aprimoramento na solu\u00e7\u00e3o, simula\u00e7\u00f5es com press\u00e3o n\u00e3o-hidrost\u00e1tica podem ainda requerer, na \u00f3tica do custo computacional, uma alta resolu\u00e7\u00e3o vertical para modelar fluxos em larga escala com geometrias complexas. Desta forma, a diminui\u00e7\u00e3o do custo computacional de modelos hidrodin\u00e2micos n\u00e3o-hidrost\u00e1ticos tem sido foco de muitos trabalhos. A maioria deles se dedica a melhorar a habilidade do modelo em resolver a equa\u00e7\u00e3o de poisson para press\u00e3o, focando no tratamento da condi\u00e7\u00e3o de contorno da press\u00e3o n\u00e3o-hidrost\u00e1tica na superf\u00edcie livre e no uso de uma discretiza\u00e7\u00e3o do momento vertical menos dependente do perfil vertical das velocidades (e.g. Stelling e Zijlema, 2003; Yuan e Wu, 2004; Zijlema e Stelling, 2005; Lv, 2014; Escalante et al., 2018b).\nAl\u00e9m disto, modelos h\u00edbridos, hidrost\u00e1ticos e n\u00e3o-hidrost\u00e1ticos, tamb\u00e9m t\u00eam sido implementados para reduzir o custo computacional. Eles identificam regi\u00f5es onde a simplifica\u00e7\u00e3o pode ser aplicada, ao inv\u00e9s de aplicar a abordagem n\u00e3o-hidrost\u00e1tica para todo o dom\u00ednio computacional (e.g. Wadzuk e Hodges, 2004; Bohacek et al., 2018; Zhang et al., 2018). Outros esfor\u00e7os concentram-se em adaptar a solu\u00e7\u00e3o num\u00e9rica \u00e0 implementa\u00e7\u00e3o computacional em paralelo, que aloca os c\u00e1lculos das estruturas de repeti\u00e7\u00e3o (e.g. m\u00e9todo dos gradientes conjugados para solu\u00e7\u00e3o da press\u00e3o n\u00e3o-hidrost\u00e1tica) em diferentes processadores (e.g. Zhang et al., 2018; Escalante et al., 2018a). No entanto, a melhoria dos modelos hidrodin\u00e2micos n\u00e3o-hidrost\u00e1ticos tamb\u00e9m pode ser alcan\u00e7ada com baixo custo de implementa\u00e7\u00e3o. Neste artigo focamos em uma nova condi\u00e7\u00e3o de contorno de superf\u00edcie livre para press\u00e3o n\u00e3o-hidrost\u00e1tica, sem quaisquer altera\u00e7\u00f5es das equa\u00e7\u00f5es do momento.\nNo tocante \u00e0 condi\u00e7\u00e3o de contorno da press\u00e3o n\u00e3o-hidrost\u00e1tica na superf\u00edcie livre, um dos focos deste trabalho (ver cap\u00edtulo 4), dois tipos diferentes de condi\u00e7\u00e3o de contorno s\u00e3o aplicados: primeira, uma condi\u00e7\u00e3o de Dirichlet homog\u00eanea, a qual press\u00e3o hidrost\u00e1tica \u00e9 assumida para superf\u00edcie livre e definida como zero (e.g. Kanarska e Maderich, 2003;\nCap\u00edtulo 3. Revis\u00e3o Bibliogr\u00e1fica\n27\nStelling e Zijlema, 2003; Wang et al., 2009; Zhang et al., 2018); a segunda \u00e9 uma condi\u00e7\u00e3o de Neumann, geralmente utilizada uma rela\u00e7\u00e3o hidrost\u00e1tica para aproximar a press\u00e3o da superf\u00edcie livre \u00e0 zero (e.g. Casulli, 1999; Namin et al., 2001; Monteiro e Schettini, 2015; Bohacek et al., 2018). Bergh e Berntsen (2010) discute bem as diferen\u00e7as entre ambas as condi\u00e7\u00f5es em esquemas num\u00e9ricos que definem a press\u00e3o n\u00e3o-hidrost\u00e1tica na interface entre c\u00e9lulas computacionais (edge based), mostrando que ambas condi\u00e7\u00f5es geram bons resultados. Entretanto modelos que utilizam a condi\u00e7\u00e3o de Neumann representam ligeiramente melhor escoamento n\u00e3o lineares.\nModelos num\u00e9ricos, comumente, resolvem a equa\u00e7\u00e3o de Poisson para press\u00e3o alocando a componente no centro da c\u00e9lula computacional (e.g. Jankowski, 1999; Yuan e Wu, 2004; Casulli e Lang, 2004; Liu et al., 2017; Bohacek et al., 2018), o que pode gerar uma defini\u00e7\u00e3o incorreta da condi\u00e7\u00e3o de contorno da press\u00e3o n\u00e3o-hidrost\u00e1tica se um tratamento adequado n\u00e3o for feito. Uma vez que a condi\u00e7\u00e3o de contorno \u00e9 definida no centro da camada superior, ao inv\u00e9s de precisamente na superf\u00edcie livre, a condi\u00e7\u00e3o de contorno utilizada torna-se mais imprecisa \u00e0 medida que a dist\u00e2ncia entre o centro da camada superior e a superf\u00edcie livre aumenta, consequentemente, uma alta resolu\u00e7\u00e3o vertical (1-20 camadas) \u00e9 necess\u00e1ria para obter resultados satisfat\u00f3rios (Stelling e Zijlema, 2003; Yuan e Wu, 2004; Zijlema e Stelling, 2005; Cui et al., 2012; Lv, 2014; Liu et al., 2017).\nUtilizando uma adequada resolu\u00e7\u00e3o vertical, Yuan e Wu (2004) e Zijlema e Stelling (2005) mostraram que modelos n\u00e3o-hidrost\u00e1ticos que definem a press\u00e3o no centro da c\u00e9lula computacional podem ter um erro de fase acumulado significativo ap\u00f3s v\u00e1rios per\u00edodos, devido a erros na estimativa da celeridade da onda. Em fun\u00e7\u00e3o disso, um tratamento para a condi\u00e7\u00e3o de contorno ou a utiliza\u00e7\u00e3o de um modelo edge based de press\u00e3o se faz necess\u00e1ria.\nPoucas op\u00e7\u00f5es est\u00e3o dispon\u00edveis para definir adequadamente a condi\u00e7\u00e3o de contorno na superf\u00edcie livre: i) implementa\u00e7\u00e3o de discretiza\u00e7\u00e3o da press\u00e3o n\u00e3o-hidrost\u00e1tica definida na interface entre c\u00e9lulas computacionais (edge based) (e.g. Stelling e Zijlema, 2003; Lu et al., 2015); ii) utiliza\u00e7\u00e3o de um m\u00e9todo de integra\u00e7\u00e3o que estima a press\u00e3o n\u00e3o-hidrost\u00e1tica na superf\u00edcie livre a partir da integra\u00e7\u00e3o da press\u00e3o no centro da camada superior \u00e0 superf\u00edcie livre (e.g. Yuan e Wu, 2004; Lu et al., 2015; Lv, 2014; Liu et al., 2017); e iii) aplica\u00e7\u00e3o de um perfil linear por partes da press\u00e3o n\u00e3o hidrost\u00e1tica baseado no valor esperado para o fundo e topo que posteriormente seja ajustado o valor nas camadas (e.g. Escalante et al., 2018b).\nPara que sejam melhoradas as solu\u00e7\u00f5es dos modelos com press\u00e3o definida no centro da c\u00e9lula computacional, as op\u00e7\u00f5es dispon\u00edveis podem exigir custo de implementa\u00e7\u00e3o substancial, visto que os tratamentos da condi\u00e7\u00e3o de contorno s\u00e3o desenvolvidos com base nas diferentes discretiza\u00e7\u00f5es num\u00e9ricas utilizadas pelos autores. Portanto, a adapta\u00e7\u00e3o de\nCap\u00edtulo 3. Revis\u00e3o Bibliogr\u00e1fica\n28\nmodelos pode requerer ao menos altera\u00e7\u00e3o da discretiza\u00e7\u00e3o do momento vertical, al\u00e9m da implementa\u00e7\u00e3o do devido tratamento da condi\u00e7\u00e3o de contorno. Assim, a fim de reduzir o custo computacional de simula\u00e7\u00f5es hidrodin\u00e2micas n\u00e3o-hidrost\u00e1ticas com um m\u00e9todo de baixo custo de implementa\u00e7\u00e3o, foi proposto aqui uma condi\u00e7\u00e3o de contorno na superf\u00edcie livre que \u00e9 baseada em uma subcamada fict\u00edcia, onde a condi\u00e7\u00e3o de contorno existente (Dirichlet ou Neumann) pode ser aplicada, sem maiores altera\u00e7\u00f5es no c\u00f3digo. Este item ser\u00e1 melhor discutido no cap\u00edtulo (4).\nContudo, qualquer que seja a abordagem (hidrost\u00e1tica ou n\u00e3o-hidrost\u00e1tica), os erros de difus\u00e3o num\u00e9rica permanecem cr\u00edticos, e muitos trabalhos foram feitos para reduzi-la, adotando diversas abordagens. T\u00e9cnicas de resolu\u00e7\u00e3o mais alta (e.g. interpoladores quadr\u00e1ticos, c\u00fabicos e splines e limitadores de fluxo) provaram ser uma alternativa promissora para minimizar esses erros num\u00e9ricos (Cheng et al., 1984; Ruan e McLaughlin, 1999; Waterson e Deconinck, 2007; Kong et al., 2013; Ye et al., 2018). Embora trabalhos anteriores mostrem que esquemas de alta resolu\u00e7\u00e3o podem n\u00e3o manter algumas caracter\u00edsticas importantes de solu\u00e7\u00e3o num\u00e9rica (e.g. oscila\u00e7\u00f5es esp\u00farias de ondas internas) (e.g. Wang e Lacroix, 1997), eles podem representar melhor comportamentos n\u00e3o-lineares do campo de velocidades de esquemas de baixa resolu\u00e7\u00e3o (UpWind de primeira ordem, interpolador bilinear). Apesar da possibilidade dos esquemas lineares serem mais est\u00e1veis, monot\u00f4nicos e facilmente implementados, h\u00e1 tamb\u00e9m a possibilidade de gerar resultados insatisfat\u00f3rios devido \u00e0 maior difus\u00e3o num\u00e9rica.\nA seguir \u00e9 apresentado uma breve revis\u00e3o das vantagens de aplica\u00e7\u00e3o de algumas dessas t\u00e9cnicas de alta resolu\u00e7\u00e3o nas solu\u00e7\u00f5es hidrodin\u00e2mica e de transporte.\n3.3\tM\u00e9todo Euleriano-Lagrangiano\nUm modo de reduzir a difus\u00e3o num\u00e9rica \u00e9 a implementa\u00e7\u00e3o de esquemas de alta resolu\u00e7\u00e3o na solu\u00e7\u00e3o hidrodin\u00e2mica e de transporte. O m\u00e9todo Euleriano-Lagrangiano (ELM) \u00e9 um dos mais populares e precisos, usado para resolver numericamente os termos de advec\u00e7\u00e3o tanto na equa\u00e7\u00e3o RANS quanto nas equa\u00e7\u00f5es de transporte de solutos (Cheng et al., 1984; Ruan e McLaughlin, 1999; Cox e Runkel, 2008; Casulli e Cheng, 1992; Jankowski, 1999; Hodges et al., 2000; Wadzuk e Hodges, 2004; Walters, 2005; Fringer et al., 2005; Monteiro e Schettini, 2015). O objetivo do ELM \u00e9 combinar a simplicidade da grade computacional Euleriana fixa com uma abordagem Lagrangiana est\u00e1vel e precisa. O m\u00e9todo utiliza de t\u00e9cnicas de interpola\u00e7\u00e3o aplicados em duas principais etapas para estimar os termos advectivos (Staniforth e C\u00f4t\u00e9, 1991). A Figura 3.4 apresenta um esquema de aplica\u00e7\u00e3o do m\u00e9todo:\nO local de partida da part\u00edcula (ponto vermelho) encontra-se no baricentro de uma dada face \u201dj\u201d na camada \u201dk\u201d no tempo \u201dn + 1\u201d. (i) Ao longo dos subintervalos de tempo\nCap\u00edtulo 3. Revis\u00e3o Bibliogr\u00e1fica\n29\n\t\t\t\t\t\t\n_Q\tc\t\t)\tc\t\t! ) / \t\u00bf\tr\t'n+1\t!\n\tn &lt;\u20140\u2014-\t\t\t\t\t\n\t\t\u25a0\t\t\t\u2022\t\n\t\ta\t\t\t\t\nFigura 3.4 - Esquema bidimensional de aplica\u00e7\u00e3o do ELM apresentando o ponto de partida no tempo \u201dn + 1\u201d (ponto vermelho), linha de corrente feita ao longo dos subintervalos de tempo (linha tracejada vermelha), ponto de parada no tempo n e pontos de interpola\u00e7\u00e3o utilizados para estimar a velocidade velocidade da part\u00edcula no tempo \u201dn\u201d (pontos amarelos).\na linha de corrente \u00e9 determinada atrav\u00e9s da aplica\u00e7\u00e3o de um m\u00e9todo de rastreamento de part\u00edculas, que consiste em obter a localiza\u00e7\u00e3o ao fim do subintervalo de uma part\u00edcula fluida no passo Lagrangiano interpolando a posi\u00e7\u00e3o final em fun\u00e7\u00e3o da velocidade do local de partida e do tempo (e.g Passos Multiplos de Euler, Runge-Kutta de quinta ordem). No entanto, a posi\u00e7\u00e3o final de cada subintervalo n\u00e3o \u00e9 um ponto de grade, logo, (ii) uma interpola\u00e7\u00e3o do campo advectivo utilizando n\u00f3s da grade com velocidade conhecida (pontos amarelos) \u00e9 necess\u00e1ria para estimar as componentes de velocidade no ponto ao fim da linha de corrente. O resultado dos erros de interpola\u00e7\u00e3o, em ambas as etapas, podem introduzir: (a) uma difus\u00e3o num\u00e9rica substancial, quando usados esquemas de interpola\u00e7\u00e3o de baixa resolu\u00e7\u00e3o; ou (b) oscila\u00e7\u00e3o esp\u00faria de ondas internas, quando s\u00e3o usados esquemas de interpola\u00e7\u00e3o de alta resolu\u00e7\u00e3o (Cheng et al., 1984; Oliveira e Baptista, 1998; Wang e Lacroix, 1997; Ruan e McLaughlin, 1999).\nUma das aplica\u00e7\u00f5es do ELM \u00e9 o tratamento num\u00e9rico das equa\u00e7\u00f5es RANS, que decorre da discretiza\u00e7\u00e3o dos termos convectivos e viscosos da equa\u00e7\u00e3o convec\u00e7\u00e3o-difus\u00e3o em tr\u00eas dimens\u00f5es (equa\u00e7\u00f5es 3.1-3.3). A equa\u00e7\u00e3o advec\u00e7\u00e3o-difus\u00e3o sem o termo de Coriolis e termos de press\u00e3o, pode ser descrita como:\ndc dt\ndc\tdc\tdc\tdc\n+ U + V + w = dt\tdx\tdy\tdz\nd2c\td2c\ndx2 + dy2\nd dc\n+ dZ ,v\u00e3Z\n(3.4)\nonde C \u00e9 uma vari\u00e1vel gen\u00e9rica (e.g. componentes da velocidade u, v, w) (Casulli e Cheng, 1992). Para obter uma solu\u00e7\u00e3o simples e aprimorar a estabilidade e acur\u00e1cia de um esquema expl\u00edcito de diferen\u00e7a finita, considere a equa\u00e7\u00e3o 3.4 em sua forma Lagrangiana:\ndc\t\u00ed d2c\t\u00e22c\\\td \u00ed dc\\\ndt\tdx2 + dy2 + dz dz\nOnde a derivada substancial d indica a taxa de varia\u00e7ao no tempo, a qual \u00e9\ncalculado ao longo de uma linha de corrente definida por:\ndx\tdy\nd = u ~dt = v\ndz\n= w dt\n(3.6)\nUma discretiza\u00e7ao expl\u00edcita da equa\u00e7ao (3.5) pode ser dada por:\nn+1\n\\.Cj,k\nvk+1/2\ncn+1  cn+1\nCj,k+1 Cj,k ^zj,k+1/2\nvk-1/2\nCjn+1__cjn + 1\nCj,k\tg,k-1\n^zj,k-1/2\nAt\nAzj,k\n+ fiAhC*k\n(3.7)\nj )\nPara discretiza\u00e7ao Lagragiana ser aplicada em uma grade Euleriana, uma linha de corrente retroativa \u00e9 necess\u00e1ria para estimar a velocidade no tempo \"n\"(abordagem Lagrangiana) necess\u00e1ria para alcan\u00e7ar a posi\u00e7ao final \"j, k\"no tempo \"n + 1 \"(Abordagem Euleriana).\nA t\u00e9cnica de interpola\u00e7ao aplicada \u00e0 segunda etapa do ELM tem um grande impacto na difusao num\u00e9rica total produzida, especialmente quando os esquemas de interpola\u00e7ao de baixa resolu\u00e7ao sao utilizados, uma vez que obten\u00e7ao das velocidades \u00e9 amplamente afetada pelo processo repetitivo de interpola\u00e7ao a cada subintervalo de tempo (Staniforth e C\u00f4t\u00e9, 1991). Cheng et al. (1984) demonstrou que a utiliza\u00e7ao de esquemas nao-lineares de alta resolu\u00e7ao pode eliminar a difusao num\u00e9rica gerada pelo m\u00e9todo. Desta forma, apesar de m\u00e9todos de alta resolu\u00e7ao ter a possibilidade de nao manter algumas caracter\u00edsticas importantes de solu\u00e7ao num\u00e9rica (e.g. oscila\u00e7\u00f5es esp\u00farias de ondas internas), esquemas nao-lineares de alta resolu\u00e7ao aplicados ao ELM sao prefer\u00edveis \u00e0 esquemas lineares para simula\u00e7ao (Cheng et al., 1984; Casulli e Cheng, 1992; Wang e Lacroix, 1997; Ruan e McLaughlin, 1999).\nPropomos neste trabalho uma interpola\u00e7ao quadr\u00e1tica baseada no coeficiente de Lagrange que utiliza 27 pontos, entre velocidade calculadas e estimadas, em um \u00fanico elemento computacional (ver cap\u00edtulo 5 para detalhes). A implementa\u00e7ao foi baseada na interpola\u00e7ao quadr\u00e1tica de alta resolu\u00e7ao e nao oscilat\u00f3ria (wiggles) proposta por Hodges et al. (2000), que utiliza 27 pontos da grade computacional, precisando de ao menos 4 elementos para utilizar a interpola\u00e7ao. Apesar da t\u00e9cnica ainda nao ter sido formalmente analisada (Hodges et al., 2006), sem registro posterior da an\u00e1lise formal desta. Outros estudos modelaram com sucesso simula\u00e7\u00f5es hidrodin\u00e2micas e de transporte de solutos, indicando que a solu\u00e7ao \u00e9 satisfat\u00f3ria, demonstrando que \u00e9 promissor em simular ondas gravitacionais internas e melhorar a habilidade do modelo em resolver escoamento estratificados de superf\u00edcie livre (e.g. Hodges et al., 2000; Laval et al., 2003b, 2005; Hodges et al., 2006; Valipour et al., 2015; Vilas et al., 2017; Soulignac et al., 2017).\nCap\u00edtulo 3. Revis\u00e3o Bibliogr\u00e1fica\n31\n3.4\tTransporte de Soluto\nA equa\u00e7\u00e3o do Transporte \u00e9 obtida atrav\u00e9s da discretiza\u00e7\u00e3o da equa\u00e7\u00e3o da conserva\u00e7\u00e3o de volume, expressa pela condi\u00e7\u00e3o de incompressibilidade e a equa\u00e7\u00e3o de continuidade, dada por:\ndu dv dw dx + dy + dz\n(3.8)\nA integra\u00e7\u00e3o da equa\u00e7\u00e3o (3.8) na profundidade, utilizando a regra de integra\u00e7\u00e3o de Leibniz, em cada uma das dire\u00e7\u00f5es (x,y,z) e ainda usando a condi\u00e7\u00e3o cinem\u00e1tica na superf\u00edcie livre, resulta na equa\u00e7\u00e3o de superf\u00edcie livre:\ndy d dt + dx\nrn\td r n\nudz +\tvdz = 0\n-h\tdy -h\n(3.9)\nA conserva\u00e7\u00e3o de massa de uma vari\u00e1vel escalar conservadora pode ser expressa\npela seguinte equa\u00e7\u00e3o:\ndC d (uC) d(vC) d (wC) dt + dx + dy + dz\n(3.10)\nd(KhdC d_(Khdo d Kvdo dx (K dx) + dydy ) + dz K dz\nOnde C \u00e9 a concentra\u00e7\u00e3o de uma subst\u00e2ncia conservativa a ser transportada (e.g. salinidade); Kh e Kv s\u00e3o os coeficientes de difusividade turbulenta horizontal e vertical, respectivamente.\nA solu\u00e7\u00e3o de Transporte de Soluto pode ser resolvida por esquemas num\u00e9ricos diferentes do ELM, tais como esquema Total Variation Diminishing (TVD) de alta ordem, Random Walk Particle Tracking RWPT e Smoothed Particle Hydrodynamics (SPH), bem discutidos em Boso et al. (2013). Um esquema simples para discretizar a equa\u00e7\u00e3o de conserva\u00e7\u00e3o de massa, com baixo custo de implementa\u00e7\u00e3o, \u00e9 o UpWind de primeira ordem, no qual os limitadores de fluxo podem ser aplicados para reduzir a conhecida difus\u00e3o num\u00e9rica desta discretiza\u00e7\u00e3o (Casulli e Zanolli, 2005; Zhang et al., 2018).\nA discretiza\u00e7\u00e3o dos termos que representam o transporte convectivo \u00e9 um aspecto desafiador na simula\u00e7\u00e3o num\u00e9rica de flu\u00eddos. No contexto das discretiza\u00e7\u00f5es consideradas aqui, a introdu\u00e7\u00e3o de esquemas lineares Upwind de segunda ordem ou superior (k-scheme) a partir da d\u00e9cada de 60 marcou um grande passo \u00e0 frente, permitindo solu\u00e7\u00f5es mais precisas de fluxos predominantemente convectivos em n\u00fameros mais altos de Reynolds (Waterson e Deconinck, 2007). Tais esquemas lineares, embora mais est\u00e1veis do que esquemas de pura diferen\u00e7a centrada, ainda permanecem vulner\u00e1veis a oscila\u00e7\u00f5es espaciais sem sentido f\u00edsico (wiggles) sob algumas circunst\u00e2ncias. A solu\u00e7\u00e3o para este problema tem sido o uso de discretiza\u00e7\u00f5es n\u00e3o lineares, sendo uma forma eficiente de construir um esquema de transporte convectivo Upwind n\u00e3o-linear de segunda ordem o uso dos limitadores de fluxo (Sweby, 1984; Roe, 1986; Waterson e Deconinck, 2007).\nCap\u00edtulo 3. Revis\u00e3o Bibliogr\u00e1fica\n32\no\n0\n1\n2\n4\nFigura 3.5 - Regi\u00e3o TVD de segunda ordem (sombreado em cinza) onde alguns esquemas\nde limitadores de fluxo s\u00e3o definidos. Axima \u00e9 limitado pelo esquema superbee (vermelho), abaixo pelo esquema Minmod (azul). Os esquemas Muscl e Van Leer est\u00e3o plotados em azul tracejado e marro, respectivamente. A abicis\u00e7a \"r\"\u00e9 a taxa dos gradientes consecutivos de concentra\u00e7\u00e3o. Fonte: adaptado pelo autor, Sweby, 1984\nO esquema do limitador de fluxo provou ser uma das abordagens mais eficazes para a constru\u00e7\u00e3o de esquemas n\u00e3o lineares de alta resolu\u00e7\u00e3o (Waterson e Deconinck, 2007). S\u00e3o fun\u00e7\u00f5es simples que definem o esquema de convec\u00e7\u00e3o com base em uma rela\u00e7\u00e3o de gradientes locais no campo da solu\u00e7\u00e3o, com um limite de comportamento, a fim de manter a monotonicidade, geralmente limitado por uma condi\u00e7\u00e3o TVD para esquemas de segunda ordem (Sweby, 1984; Waterson e Deconinck, 2007) (Figura 3.5). Os Limitadores de Fluxo tem sido amplamente utilizado para obter solu\u00e7\u00f5es menos difusas e est\u00e1veis, mesmo em situa\u00e7\u00f5es cr\u00edticas, como em gradientes de concentra\u00e7\u00e3o acentuada em regi\u00f5es com pequeno n\u00famero de courant (Wadzuk e Hodges, 2004; Fringer et al., 2005; Casulli e Zanolli, 2005; Kong et al., 2013; Zhang et al., 2018; Nangia et al., 2019). Uma boa revis\u00e3o sobre constru\u00e7\u00e3o de limitadores de fluxo pode ser encontrada nos trabalhos de Tamamidis e Assanis (1993); Fringer et al. (2005); Waterson e Deconinck (2007).\nMuitas s\u00e3o as op\u00e7\u00f5es de fun\u00e7\u00f5es de limitadores de fluxo que se ajustam aos limites TVD. Os trabalhos de Waterson e Deconinck (2007); Fringer et al. (2005) mostram algumas op\u00e7\u00f5es as quais 13 foram implementadas, a saber:\n1. UpWind\n$(7) = 0\n(3.11)\n2. Lax-Wendroff\n3 .\n4.\n5\t.\n6\t.\n7.\n8 .\n9 .\n10.\n11.\n12.\n13.\nMinMod\nMUSCL\nSuperbee\nSMART\nSHARP\nVan Leer\nUltimate Quickest\n$(rf) = max[j; min(rf, 1)]\n$(rf) = max[^\u201dk; min(2rf; 0, 5 + 0, 5rf; 2)]\n$(rf) = max[^J,k; min(1; 2rf); min(2, rf)]\nf 3r f\n$(rf) = max $j,k; min \u00ed 2rf ;\t+\n$(rf >=min H\n$(rf) = max ^jk; min\nSuper-C\nHyper-C\nOSPRE\nSPL-1/3\n$(rf) =\n/ 0,5\n(rf\n\n1)\n(rf - 1)\n(rf + 1rf1) (1 + rf)\n(> rf) + > - rf )(1 -\n$(rf) = min (jf\t, 0 &lt;rf &lt;1\n$(rf) = min (rf, 1 -2|CJ ,rf > 1\n$(rf) = j\n2rf\t2\n> = mi+ C\tC|)'r> > 0\n*(f) = j\n( rf+1\nY2! \"\n$(rf) = max \u00f3?k; 3rf .\t2\t,\nV f\tf \\2rj + 2rf + 2j\n1\t2rf 2 rf\nrf) = max j min \u00ed\t3 + -f ; 3 + f;2)\n(3.13)\n(3.14)\n(3.15)\n(3.16)\n(3.17)\n(3.18)\n(3.19)\n(3.20)\n(3.21)\n(3.22)\n(3.23)\nCap\u00edtulo 3. Revis\u00e3o Bibliogr\u00e1fica\n34\nOnde \u00ed e $ s\u00e3o fun\u00e7\u00f5es que determinam o fator de corre\u00e7\u00e3o da equa\u00e7\u00e3o do Transporte de Soluto (ver cap\u00edtulo 5 para mais detalhes) e C \u00e9 o n\u00famero de Courant. A import\u00e2ncia de sua implementa\u00e7\u00e3o se resume na praticidade de sua implementa\u00e7\u00e3o e no potencial de redu\u00e7\u00e3o da difus\u00e3o num\u00e9rica de forma est\u00e1vel, mesmo em cen\u00e1rios com bruscos gradientes de concentra\u00e7\u00e3o. Fringer et al. (2005) avalia a efici\u00eancia de uma s\u00e9rie de limitadores de fluxo atrav\u00e9s de um benchmark regido por uma onda gravitacional com coeficiente de difus\u00e3o nulo, apresentando seus potenciais de redu\u00e7\u00e3o de difus\u00e3o num\u00e9rica (figura 3.6), dentre os quais o Superbee, Ultimate-Quickest, MUSCL, BPEP1 e BPEP2 apresentaram os melhores resultados.\nFigura 3.6 - Perfil de densidade ap\u00f3s dois per\u00edodos de oscila\u00e7\u00e3o para diferentes esquemas de limitadores de fluxo. A solu\u00e7\u00e3o exata corresponde a solu\u00e7\u00e3o inicial. Fonte: Fringer et al., 2005\nOs limitadores de fluxo s\u00e3o, em sua maioria, unicamente influenciados pelos gradientes consecutivos de concentra\u00e7\u00e3o (rf) sendo sua estimativa determinante para efici\u00eancia na redu\u00e7\u00e3o da difus\u00e3o num\u00e9rica de maneira est\u00e1vel. Diversas maneiras de estimar o rf foram propostas (Darwish e Moukalled, 2003; Casulli e Zanolli, 2005; Li e Huang, 2008; Kong et al., 2013; Zhang et al., 2015; Ye et al., 2018). O rf proposto por Ye et al. (2018), Zhang et al. (2015) e Kong et al. (2013) mostratam os melhores resultados dentre todos os m\u00e9todos existentes, sendo menos difusivo e oscilat\u00f3rio que seus antecessores (ver figura 3.7).\nPela estabilidade e efici\u00eancia e reduzir a difus\u00e3o num\u00e9rica e facilidade em adapta\u00e7\u00e3o da solu\u00e7\u00e3o ao tipo de malha em 3 dimens\u00f5es (estruturada ou n\u00e3o-estruturada), o rf proposto por Kong et al. (2013), se mostra uma alternativa promissora, pois se baseia apenas nas contra\u00e7\u00f5es e dist\u00e2ncias entre a c\u00e9lula computacional em an\u00e1lise e c\u00e9lulas vizinhas. Para as faces verticais (fluxo horizontal) o gradiente consecutivo \u00e9 dado por:\nn\nj,k\nnn\nCi,k\tCr(i,jo),k\nn\tn\nCr(i,j),k\tCi,k\n(3.24)\nonde jo representa a face oposta \u00e0 face j e C a concentra\u00e7\u00e3o em seus respectivos elementos de malha. Para as faces horizontais (fluxo vertical) o rf \u00e9 dado por:\nnn\nCi,k\tCi,k+1\nn\nnn\nCi,k-1\tCi,k\ni,k-1\nnn\nCi,k Ci,k-1\nn\nCi,k+1\n(3.25)\n(3.26)\nn\nj,k+1\n.. 7 -\n( vk\n----Exact\n-0- Present .one cycle\n-A- Present.five cycle\n-0-Kong ct al. (2013 (.one cycle -A- Kong \u00ab al. (2013 j,five cycle -0-Casulli and Zanolli. |2005|,onc cycle [ -A-Casulli and \u00bfanolli, (2005(Jivecycle\n\nr\nr\nr\n\nFigura 3.7 - Caso de advec\u00e7\u00e3o em campo de fluxo rotativos: Perfis de concentra\u00e7\u00f5es estimado com diferentes algor\u00edtimos de rf em x = 20 m ap\u00f3s a) 1 ciclo (Fonte: Kong et al., 2013) e b) 1 ciclo ou 5 ciclos (Fonte: Ye et al., 2018).\nImprovement of nonhydrostatic hydrodynamic solution using a novel free-surface boundary condition\nIMPROVEMENT OF NONHYDROSTATIC HYDRODYNAMIC\nSOLUTION USING ANOVEL FREE-SURFACE BOUNDARY CONDITION\nAugusto Hugo Farias da Cunha Carlos Ruberto Fragoso Jr.\nDavid da Motta Marques\nArtigo a ser submetido.\nImprovement of nonhydrostatic hydrodynamic solution using a novel free-surface boundary condition\nAugusto Hugo Farias da Cunha \u2022 Carlos Ruberto\nFragoso Junior \u2022 David da Motta-Marques\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\nAbstract Hydrodynamic models based on RANS equation are well established tools to simulate threedimensional free surface flows in large aquatic ecosystems, such as lakes, estuaries, reservoirs and coastal zones. When the ratio of vertical to horizontal motion scales is not small, a non-hydrostatic approximation is needed in order to accurately model three-dimensional free surface flows with low computational cost. Growing efforts have been made to improve the efficiency of non-hydrostatic hydrodynamic models. One such attempt improves the model ability in solving the elliptic equation to nonhydrostatic pressure, which properly address the free-surface boundary condition and uses a vertical momentum discretization less dependent on the velocity vertical profile. However, the improvements may demand a considerable implementation cost due to substantial changes, at least, in the vertical momentum discretization and in the treatment needed to properly address the nonhydrostatic pressure at the free-surface boundary condition. Thus, in order to improve the nonhydrostatic hydrodynamic solution with low cost of implementation, we proposed a novel free-surface boundary condition based on a fictional sublayer at the free-surface (FSFS). We applied the FSFS at a finite difference discretization with a fractional step framework based on Casulli and Lang (2004), which uses a Neumann type of boundary condition which applies a hydrostatic relation in the top layer. To evaluate the model performance, we compared the Classic Boundary Condition Approach (CBA) and the FSFS aproach using two numerical experiments: (a) a standing wave in a three-dimensional closed basin, and (b) a wave propagation over a submerged bar, to test the model\u2019s capability in solving wave celerity and simulate non-linear wave propagations under different vertical resolutions scenarios (20 to 5 layers). Our findings showed that the FSFS approach had phase error 2 to 5 time lower than CBA, and with little additional computational cost (ca. 7%). The FSFS approach better represented wave celerity and frequency dispersion with fewer layers (10 layers) with low mean computational cost (c.a. 1.54 s), while the CBA best results (computational cost of c.a. 2.62 s) had similar performance to the 8-layer (computational cost of c.a. 1.51 s) simulation with FSFS approach.\nKeywords Pressure \u2022 Implementations Cost \u2022 Computational Cost\n1\tIntroduction\nHydrodynamic models based on Reynolds Averaged Navier-Stokes (RANS) equation are well established tools to simulate three-dimensional free surface flows in large aquatic ecosystems, such as lakes, estuaries, reservoirs and coastal zones (Valipour et al., 2015; de Brito Jr et al., 2018; Vilas et al., 2017; Soulignac et al., 2017; Munar et al., 2018). These models usually are based on hydrostatic assumption of the pressure distribution, which is satisfactorily applied to large shallow water ecosystems with relatively low computational cost algorithm (Zhang et al., 2018). However, when the ratio of vertical to horizontal motion scales is not small, a non-hydrostatic approximation is needed in order to model accurately three-dimensional free surface flows with low computational cost (Marshall et al., 1997; Casulli and Stelling, 1998; Chen, 2003; Wadzuk and Hodges, 2004; Liu et al., 2017).\nHydraulic Research Institute;\nFederal Univerisity of Rio Grande do Sul, Porto Alegre, Rio Grande do Sul,Brazil\nTel.: +55 51-3308-6670\nE-mail: hugo.cunha@ufrgs.br\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n86\n87\n88\nAlthough a nonhydrostatic approach improves the physical representation of pressure, acceleration and velocities fields, more complex numeric methods and high vertical resolution may still be needed to model large-scale flows with complex geometries. To improve efficiency and reduce the computational cost of nonhydrostatic hydrodynamic models, a few alternatives were explored. Most of them are dedicated to improving the model's ability to solve the elliptic equation to nonhydrostatic pressure, which properly addresses the free-surface boundary condition and uses a vertical momentum discretization less dependent of the velocity vertical profile (Stelling and Zijlema, 2003; Yuan and Wu, 2004; Zijlema and Stelling, 2005; Lv, 2014; Liu et al., 2017; Escalante et al., 2018a). Hybrid hydrostatic and nonhydrostatic models have also been used to reduce computational cost. These models may identify regions where the simplification can be applied, instead of applied the nonhydrostatic approach to the entire computational domain (Wadzuk and Hodges, 2004; Bohacek et al., 2018; Zhang et al., 2018). To adapt source code to work as a parallel computational algorithm is also feasible solution applied, which allocated the loop calculations on the distributed threads (Zhang et al., 2018; Escalante et al., 2018b). However, improvement of nonhydrostatic hydrodynamic models can be also reached with a low implementation cost method, on this paper we focus in novel free-surface boundary condition to properly addresses the free-surface nonhydrostatic pressure, in order to reaching satisfactory results without changing the momentum equations.\nTwo different types of boundary conditions may be applied for nonhydrostatic pressure at the free-surface: (a) a homogenous Dirichlet condition, which pressure is set equal zero at the free-surface (e.g. Kanarska and Maderich, 2003; Stelling and Zijlema, 2003; Wang et al., 2009; Zhang et al., 2018) and (b) a Neumann condition, usually a hydrostatic relation to approximate pressure's value equal to zero at the free-surface (e.g. Casulli, 1999; Namin et al., 2001; Monteiro and Schettini, 2015; Bohacek et al., 2018), Both types of free-surface boundary condition were well discussed in Bergh and Berntsen (2009). However, many numerical models solve the Poisson's equation for pressure at the center of the computational cell (e.g. Jankowski, 1999; Yuan and Wu, 2004; Casulli and Lang, 2004; Liu et al., 2017; Bohacek et al., 2018), which may incorrectly address the nonhydrostatic boundary condition to the top layer instead at the free-surface, if a suitable treatment is not performed. This assumption becomes more inaccurate as the distance between the center of the top layer and the free surface increases, hence a high vertical resolution (1-20 layers) is needed in order to achieve accurate results for different case studies (Stelling and Zijlema, 2003; Yuan and Wu, 2004; Zijlema and Stelling, 2005; Cui et al., 2012; Lv, 2014; Liu et al., 2017).\nIn addition to using a suitable vertical discretization, Yuan and Wu (2004) and Zijlema and Stelling (2005) showed that cell-center nonhydrostatic models may have a significant accumulated phase error after several wave periods due to the wrong computation of wave celerity. Many efforts were carried out in order to properly overcome this issue, of which we can highlight: (a) an implementation of edge-based nonhydrostatic pressure (e.g. Stelling and Zijlema, 2003; Lu et al., 2015), (b) the use of an integration method to estimate the pressure at the free-surface based on pressure in the center of the top layer (e.g. Yuan and Wu, 2004; Lv, 2014; Liu et al., 2017, and and (c) the use of a piecewise linear profile of the non-hydrostatic pressure to estimate the pressure at the free-surface (e.g. Escalante et al., 2018a. For the existing cell-centered models, the previous algorithms may demand a substantial implementation cost due to substantial changes, at least, in the vertical momentum discretization and in the treatment needed to properly address the nonhydrostatic pressure at the free-surface boundary condition. Thus, in order to improve the nonhydrostatic hydrodynamic solution with low cost of implementation, we proposed a novel free-surface boundary condition based on a fictional sublayer at the free-surface (FSFS)\nWe applied the FSFS and the CBA approachs at a finite difference discretization with a fractional step framework based on Casulli and Lang (2004), which uses a Neumann type of boundary condition which apply a hydrostatic relation in the top layer. To evaluate the model performance, we used two widely applied numerical models benchmarks (Dingemans, 1994; Jankowski, 1999; Casulli and Lang, 2004; Yuan and Wu, 2004; Fringer et al., 2005; Liu et al., 2017; Yin et al., 2017), which were selected to test our algorithm in two different purposes: (a) a standing wave in a three-dimensional closed basin to test the model's capability in solving wave celerity under different vertical resolutions; and (b) a wave propagation over a submerged bar to validate the proposed boundary condition at the free-surface and evaluated the effect of vertical resolution under a non-linear wave propagation.\n89\n90\n91\n92\n93\n2 Mathematical considerations\n2.1 Governant equations\nThe RANS equations are used to describe three-dimensional free-surface flows. These equations express the physical principle of volume, mass, and momentum conservation. The momentum equations for an incompressible fluid have the following form:\ndu du du du\tdpa dn\ndt + udX + vdy + wdZ -fv = -dx - 9ax\nd\n- 9dX\ndZ\nP\ndq h i d2u d2u\\ d i v du\\ dx + V dx2 + dy2) + dz\\ dz )\n(1)\ndv dv dv dv\tdpa dv\ndt+ udX+ vdy+ wdZ- fu = - xy - 9dy\n9 dy\nP - P0\nP0\ndZ- I + vh\nd2v d2v\\\ndx2 + dy2)\nd + dZ\ndw\ndw\ndt\ndw\n+ ' + dx dy\ndw w~dZ\ndq h( d2w d2w. d dz + V ( dx2 + dy2\t' dz\n(2)\n(3)\n94\n95\n96\n97\n98\n99\n100\n101\n102\n103\n104\n105\nwhere u(x,y,z,t), v(x,y,z,t), and w(x,y,z,t) are the velocity components in the horizontal (x and y) and vertical (z) directions, respectively; where vh e vv are the horizontal and vertical turbulent eddy viscosity coefficients, respectively; t is the time; pa(x,y,z,t) is the atmospheric pressure; n is the free surface elevation from a water level reference. The second and the third terms on the right- hand side of equations (1) and (2) represent the barotropic and the baroclinic contributions to the hydrostatic pressure; q(x,y,z,t) denotes the nonhydrostatic pressure component; f is the Coriolis parameter; and 9 is the gravitational acceleration.\nWhen a simple hydrostatic approach is considered, equation (3) is neglected and q is assumed to be equal to zero in equations (1) and (2). In this case, it is assumed that vertical acceleration do not have a significant effect in the velocity field in comparison with horizontal acceleration.\nThe volume conservation is expressed by the incompressibility condition and the continuity equation, given by:\ndu dv dw\t0\ndx ' dy ' dz\n106\n(4)\nIntegrating equation (4) over depth leads to the following equation:\nn\nh\nn\nh\nZn\nh\ndu dv dw\ndz =\nZn\nh\ndu , ~z~dz + dx\ndv , ~z~dz + dy\nxrdz = 0\ndz\n(5)\ndx ' dy ' dz\n107\n108\n109\nwhere \u201ch\u201d is the bathymetry measured from theoretical undisturbed water surface (zero referential). Using the Leibniz integration rule, in each direction, in equation (5) and using a kinematic condition at the free-surface leads to the following free-surface equation:\nn\nh\nn\nh\n110\n111\n112\n113\n114\n115\ndn d dt ' dx\nj\td\nudz + \u2014 dy\nvdz = 0\n(6)\nFinally, the mass conservation of a conservative scalar variable may be expressed by the following equation:\ndC d(uC) d(vC) d(wC) dt ' dx ' dy ' dz\n= d(Khdc) + d(KhdC). d Koc\\ dx( dx ) + dy (K dy )+ dz 1 dz)\n(7)\nwhere C is the concentration of a conservative substance being transported (e.g., salinity); Kh and Kv are the horizontal and vertical turbulent eddy diffusivity coefficients, respectively.\nFor both the velocity field and scalar transport solutions, the boundary conditions are implemented under the assumption of \u201cfree-slip\u201d boundaries. The Dirichlet and Neumann conditions were assigned\n117\n118\n119\nto represent the normal and tangential velocities in the solid boundaries, respectively. For the scalar solution, a no-flux boundary condition is assumed in solid boundaries.\nThe tangential stress boundary conditions for the momentum equations (Equations 1 and 2) at the free-surface are specified by the prescribed wind stresses, which can be approximated as:\nvdu\t(\t) vdv\t(\t)\nv dz = Yt(ua - u),v \u2014 = Yt(va - v);\n(8)\n120\n121\nwhere ua and va are the horizontal wind velocity components coefficient. The bottom friction is specified by:\nand yT is a nonnegative wind stress\nvdu\tvdv\t,\nv\t= YB u,v\t= YB v; at z = -.\ndz\tdz\n(9)\n122\nwhere yb is a nonnegative bottom friction coefficient.\n123\n124\n125\n2.2 Grid and Variables Locations\nThe computational grid can be described as a generic unstructured orthogonal grid, having Np elements, each having an arbitrary number of sides Si > 3,i = 1, 2,..., Np (Figure 1).\nat z = n\n126\n127\n128\n129\n130\n131\n132\n* 7\nLet Ns be the total number of sides in the grid. The length of each side is Xj, j = 1, 2, ..., Np. The vertical faces of the i \u2014 th element are identified by an index j(i,i), l = 1, 2, ..., Si, so that 1 &lt;j(i,l) &lt;Ns. Similarly, the two polygons which share the j \u2014 th vertical face of the grid are identified by the indices i(j,i) and i(j,2), so that 1 &lt;i(j,i) &lt;Np and 1 &lt;i(j,2) &lt;Np. The nonzero distance between centers of two adjacent polygons which share the j \u2014 th side is denoted with 3j. Along the vertical direction a simple finite difference discretization, not necessarily uniform, is adopted. By denoting with Azk+1 a given top computational cell level surface, the vertical discretization step is defined by\n133\n134\n135\n136\n137\n138\n139\n140\n141\nAzk = Azk+z \u2014 Azk_1 k = l,2, ...,NS\t(10)\nThe three-dimensional spatial discretization consists of elements whose horizontal faces are the polygons of a given orthogonal grid, represented by the layers at k + 1 (upper face) or k \u2014 2 (bottom face), whose height, for each layer, is Azk. The water surface elevation (n), is located at the barycenter of the upper horizontal face for each i \u2014 th element. The velocity component normal to each horizontal face is assumed to be constant over the face of each computational cell, which is defined at the point of intersection between the face and the segment joining the centers of the two prisms which share the face; the non-hydrostatic pressure component q\u2122k and the concentrations C\" k are located at the center of the i \u2014 th computational cell, half way between Azk+1 and Azk1. Finally, the water depth hj is specified and assumed constant on each vertical face of an element.\n142\n143\n144\n145\n146\n147\n148\n149\n150\n151\n152\n153\n154\n155\n156\n157\n158\n159\n160\n161\n162\n163\n2.3\tNumerical Approximation\nWe used a semi-implicit method (0-Method Casulli, 1990) of finite volume, with an Eulerian Lagrangian Method (Casulli and Cheng, 1992) to solve the convective and viscous terms of the RANS equations, which applies a quadratic interpolation (see Hodges et al., 2000) to estimate the velocity field at the end of backtracking process (multi-step backward Euler with 10 sub-time steps). A fractional-step framework (Casulli and Lang, 2004) is used to solve pressure component by splitting in hydrostatic and nonhydrostatic parts. A complete description of numerical solution may be found in Casulli and Lang (2004). Below, we outlined the algorithm procedure:\n1.\tDefinition of initial parameters, initial conditions and boundary condition\n2.\tSolution of convective terms using the Eulerian-Lagrangian Method\n3.\tDetermination of the provisional free-surface elevation (fj) through the preconditioned conjugate gradient iterations until the residual norm is smaller than a given tolerance eq.\n4.\tNumeric solution of provisional velocity field (j and w)\n5.\tSolution of nonhydrostatic pressure (q) through the preconditioned conjugate gradient iterations until the residual norm is smaller than a given tolerance eq.\n6.\tNumeric correction of velocity field and free surface elevation\nHere we described separately the conventional nonhydrostatic pressure discretization with the given boundary condition, and how the FSFS boundary condition is applied in the conventional solution in order to improve the nonhydrostatic hydrodynamic solution.\n2.3.1 Nonhydrostatic pressure discretization\nA correction of provisional velocity field (un+1 ,wj+1) are computed after including the nonhydrostatic pressure terms, specifically:\nn+1 _ fn + 1 j, k\tUj, k\n0\u2014 (qn+1\t_ jn+1 A\nj \\qi(j,,k qi(j,i),kJ\n(11)\nn+1 j k\n_ wn+1\n0____\u2014_____(jn+1 _ qn+1 )\n0\t, [-qi,k+1\tqi,k+1)\n\u2014Zi,k +1\n(12)\nu\nw\n164\n165\n166\n167\nwhere the vertical space increment \u2014z is defined as the distance between two consecutive level surfaces, except near the bottom and near the free surface where \u2014z is the distance between a level surface and the bottom or free-surface, respectively. q denotes the nonhydrostatic pressure term, which in combination with the provisional free-surface elevation (rf), gives the pressure:\n168\n169\n170\npn+1 _ fifn+1- zk)+(13)\nwhere zk is the z-coordinate of the k \u2014 th horizontal level surface and g is the gravity acceleration. In each computational cell bellow the free-surface, the finite volume discretized incompressibility condition is taken to be:\nSt\nLL Si,L jiL)\u2014Zj(i,L),kUj(i,L),k ' Pi\nL=1\nW++ i\n-w\nn+1\ni,k-\n1\n2\n_0\n(14)\nk _ m,m + 1,.. . ,M\n171\n172\n173\nwhere Pi is the area of the i \u2014 th polygon and Si is the number of sides for the i \u2014 th element. At the free-surface, the finite difference approximation of equation (6) considering w\" m'' 1 _ 0 and using the incompressibility condition (14) is:\nst\nPinn+1 _ Pinn \u2014 0\u2014t^\ni=1\n\\Si,i^j(i,L)\u2014Zj(i,i),M Uj(t,i),M]\n+ 0\u2014tPiw\nn+1\ni,M -\n1\n2\nSi\n\u2014 (1 \u2014 0)\ni=1\nM\nsi,lji,l)\t\u2014Zj(i,i),kUj(i,i),k\nk=m\n174\n175\n176\n177\n178\n179\n180\n181\n182\n183\n184\n185\n186\n187\n188\n189\nwhere 6 is the implicitness factor, Si,i is sign function associated with the orientation of the normal velocity defined on the l side of an element i. Assuming that the pressure at the FSFS is hydrostatic, the pressure correction term (qn+d) is obtained by the following hydrostatic relation:\npnM = g bin+1 -\t= g cn+1 - zC + v\nhence, equation 13 becomes:\n(16)\nSi\np-\t= gPi n - \u00f1n+1] - gOAt v\nL=1\n^Si,L^j(i,L)Azj(i,L),M uj(t,L),M + gOAtPi\nn + 1\ni,M -\nSi\n- g (1 - O) At^\nL=1\nM\nSi,L^j(i,L)^2 AZn(i,L),kU'j'(i,L),k\nk=m\n(17)\nw\n1\n2\nA system of equations to solve nonhydrostatic pressure is now derived by substituting the expressions for the new velocities from (11-12) into (14) and (17), respectively. The following finite difference equations are obtained\ngO2 At2\nSi\n'^2si,LXj(i,l)Azn(i,i),k\n_l=1\nqn+1\t_ qn+1\nqi[j(i,l),1],k\tqi[j(i,l) ,2],k\n$j (i,l) ,k\n+ Pi\nqn+1 _ qn + 1 qi,k\tqi,k+1\nAzn i\ni,k+ 2\nAzn\ni,k\nqn+1 _ qn+1 qi,k-1\tqi,k\n1\n2\n= gOAtPi (Wn+l i\n- Wn+1 i)\nSi\n-\t\u25a0 A\tk jikk\u2022\nl=1\n(18)\nand\ngO2 At2\nSi\ny^si,L^j(i,l)Azj(i,l),M\n_l = 1\nqn + 1\t_ qqn+1\nqi[j(i,l),1],M\tqi[j(i,l),2],M\nji,l),M\n- Pi\nqn+1 _ qn + 1 qi,M-1 qi,M\nAzn\ni,\nM-\n+ P-a71*1 \u2014\n+ Piqi,M ~\nk \u2014 m,m + 1,... ,M - 1.\n1\n2\nSi\ngOAtPiWnM-1 - gOA^8i,L Xj(i,l) (Azfsfs\t- ^+1)-\nl=1\n(19)\nSi\tM\ng(1 - o)At^2[si,Lxj(i,l) 52Az?(i,l),kk \u2014 M\nl=1\tk=m\nOnce computed the nonhydrostatic pressure terms, the velocities field are corrected by equation (11), while vertical velocity can be estimated, equivalently, by equation (12) or by the incompressibility condition (14) by setting wn+1+1 = 0:\nw\nn + 1 i,k +1\n\u2014w\nn+1\ni,k-\n1\nPi\nSi\n52 Si,LXj(i,L)Azj(i,L),k Uj(i,L),k\u2022\nL=1\nk \u2014 m,m + 1,.. . ,M - 1\n(20)\n1\n2\nThis equation guarantees that the resulting velocity field is exactly discrete divergence free (Casulli and Lang, 2004), thus we use this equation to compute the vertical velocity components.\nThe final free surface elevation is obtained by the hydrostatic relation (16) as follows\nTA \u25a01\nnn+1 \u2014 \u00f1\u2122+1 + Oi,M + 1 n\t!i\tg\nFinally, the nonhydrostatic pressure component can be obtained by:\nqn+1 \u2014 7A ' ' _ On + 1 \u2022 qi,k ~ qi,k\tqi,M + 1\u2019\nk \u2014 m,m + 1 , . . . ,M,M + 1\n(22)\nmaking the non-hydrostatic pressure at free-surface equal to zero (i.e. for k = M + 1).\n190\n191\n192\n193\n194\n195\n196\n197\n198\n2.3.2 Free-surface boundary condition treatment\nTo apply the Fictional Sublayer at the Free-Surface (FSFS) into the existing computational domain is only required one additional numerical vertical layer in the top of computational domain, which does not account to the computational domain. As the height of the FSFS is assumed to be equal to zero, the hydrostatic relation can be always guaranteed at the free-surface, independent of the number of vertical layers. To use this method only is required a simple adaption in the numerical equations (18-19), considering the type of the layer:\ni)\tFor bottom and middle layers (i.e. k \u2014 m to M \u2014 1), the equation (18) is applied using its original form:\ngO2 At2 *\n\u25a0 Si\n,si .\t1\nj=i\n\u2014 AzfSFS\n~n + 1\t_ ~n+1\nqi[j(i,l),1],M\tqi[j(i,l),2],M\nji,l),M\nPi\nqn + 1 _ qn + 1 qi,M\tqi,M + 1\nAzn\nAZi,M +1\nAzn\ni,\nqn+1 \u2014 qn+1 qi,M-1 qi,M\nM-\n1\n2\n- g\u00b0Atpe.p m i\u2014sn+ei)\n(23)\n,l),M\nSi\ng\u00b0AtF Si,Lji,l) (AZj(i,l),M \u2014 AzFSFs) ji^.M; k - M l=1\n199\n200\nii)\tFor the top layer (k \u2014 M), equation 18 is adapted to take into account the influence of FSFS height (AzFSFS ) in Azn,M +1 and Azni,l),k:\n201\n202\n203\n204\nZi,M +1 \u2014 2 [(.Azi,M \u2014 AzFSFS) + AzFSFs] \u2014 2 (Azi,M)\t(24)\nAzi,M- 2 \u2014 2 \\iAzn,M \u2014 AzFSFS) + Azi,M-1]\t(25)\niii)\tFor the FSFS layer (k \u2014 M + 1), equation 19 is adapted to take into account the FSFS height and the velocity field in the layer M. Preliminary simulations showed that making Azfsfs \u2014 0 a stable solution is achieved for any vertical discretization:\ngO2 At2\nSi\n^^SiLjil (Azfsfs)\n_l=1\n;rn+1\t_ ~n+1\nqi[j(i,l),1],M + 1\tqi[j(i,l),2],M + 1\n$j(i,l),M\nqn + 1 _ qn + 1\np qi,M\tqi,M + 1\ni Azn\ni,(M + 1)-1\ni p-qn+1\t\u2014\n+ Piqi,M + 1 ~\nSi\n.'A'P 2 \u2014 g6AtY^i,Lj.i,l)(AzFSFS\t)\nl=1\nSi\tM\n\u2014 g(1 \u2014 O)At^f [si,Lji,l)F Azjn(i,l),kujn(i,l),k;\tk \u2014 M + 1\nl=1\tk=m\n(26)\n205\nwhere\nn\nAzi,(M + 1)-1\n2 [(Azi,M \u2014 AzFSFS) + AzFSFs] \u2014 2 (Azi,M)\n(27)\n206\n207\n208\n209\n210\n3\tNumerical Experiments\nThe proposed numerical approach was applied in two consolidated benchmarks usually use to verification and validation of numerical models Dingemans (1994); Jankowski (1999); Casulli and Lang (2004); Yuan and Wu (2004); Liu et al. (2017); Yin et al. (2017). Each numerical experiment has a\ndifferent purpose, as follows:\n212\n213\n214\n215\n216\n217\n218\n219\n220\n221\n222\n223\n224\n225\n226\n227\n228\n229\n230\n231\n232\n233\n234\n235\n236\n237\n238\n239\na Standing waves in a three-dimensional closed basin. This test case was widely applied in licterature, verifies the model capability of simulating 3D linear waves comparing the analytic solution with the numerical solution in regard of phase and amplitude representation (Yuan and Wu, 2004; Zijlema and Stelling, 2005; Monteiro and Schettini, 2015; Liu et al., 2017). We evaluated the model capability in calculate the wave celerity and frequency wave dispersion with the Classic Boundary Approach (hereafter named CBA) and with the proposed FSFS boundary condition under 6 different vertical resolutions comparing the free surface elevation cumulative phase error, the mean computational cost of one time-step, the number of wave periods and the relation with the free surface vertical velocity after 30 seconds of simulation in comparison with the analytical solution. We also compared the free surface elevation results with a few metrics (RMSE, BIAS, Volume Error, KGE, NSE) and statistically tested the residual series (difference between analytical and simulated results) with nonparametric Kruskal-Wallis test follow by a post-hoc Nemenyi to identify significative difference in relation to the analytically results. The mean time of one time-step simulations was computed using an Intel\u00ae Xenon(R CPU-E5-1620 3.7 GHz computer with 32 GB of RAM memory in a Fortran based numerical model.\nb The wave propagation over a submerged bar was an experimental model idealized by Beji and Battjes (1993), and was frequently used to validate numerical models (e.g. Beji and Battjes, 1994; Dingemans, 1994; Stelling and Zijlema, 2003; Yuan and Wu, 2004; Cui et al., 2012; Yin et al., 2017. The experiment was used to evaluate the accuracy to represent a non-linear wave pattern due to physical changes at the bottom, by comparing free surface elevation between the FSFS approach with a different vertical resolution between simulated and experimental results. The performance of the model was evaluated with a few metrics (RMSE, BIAS, Volume Error, KGE, NSE) and also by statistically tested the residues series with nonparametric Kruskal-Wallis test follow by a post-hoc Nemenyi test.\n3.1\t3D standing waves in a closed basin\nThe flow induced by an initial wave amplitude set to 0.1 m in a closed cubic basin with 10 m of edge was analyzed (figure 2). The spatial domain was discretized using a regular grid of 0.5 m resolution, resulting in 8.000 computational cells. The time step and the total simulation time was 0.01 s and 30 s, respectively. The analytic solution of free-surface water elevation is given by:\n240\n241\n242\n243\nFig. 2: The initial free-surface profile for a linear 3D standing wave oscillation in a closed basin. source: Yuan and Wu (2004)\nn = A cos (kXx) cos (kyy) cos 2^\u2014\t(28)\nwhere t is the time (the initial condition in the free surface may be obtained by doing t = 0), T is the wave period equal to 3.1os, with the wave number kx = ky = n/L with the total wave numberk = -y/kX + ky = 0.44-^. The analytic solution for each velocity component is described as follows:\nAgkx cosh [kx (h + z)] cosh (kxh)\nsin (kxx) cos (kyy) sin (wt)\n(29)\nu\nw\n244\n245\nAgky cosh [ky (h + 2)]\nw cosh (kyh)\ncos (kxx) sin (kyy) sin (wt)\nAgkx sinh [kx(h + 2)]\nw\tcosh(kxh)\ncos (kxx) cos (kyy) sin (wt)\n246\n247\n248\n249\n250\n251\n252\n253\n254\n255\n256\n257\nwhere w is giving by:\nw = ygK tanh (Kh)\n(30)\n(31)\n(32)\nThe case study was applied under different vertical resolution scenarios (i.e. 20, 16, 13, 10, 8 and 5 vertical layers), with both CBA and the proposed FSFS condition (called methods). We evaluated the cumulative phase error of a 3D standing wave by comparing the model outcomes (i.e. free-surface elevation and free-surface vertical velocity component) at x = y = 0.25 m with the analytical solution. The performance between boundary condition approaches was evaluated by comparing the free surface elevation residuals, and the performance between scenarios (considering different number of vertical layers) was also evaluated by statistically tested the residues with nonparametric Kruskal-Wallis test follow by a Nemenyi test, since the residues series do not follow a normal distribution (shapiro-wilk) and have unequal variance (Bartlett test). The test aiming to identify a critical vertical resolution for the FSFS method where the results are significative different from the best scenario for this benchmark (20 vertical layers).\n-----CBA-20L ---------CBA-liL - - CBA.-13L-----------CBA-10L --------Analytic\nFig. 3: Free surface elevation at x = y = 0. 25 m for 30 seconds of simulation comparing analytic solution (solid black line) with simulated solution for 20 to 5 layers scenario with FSFS condition (left side) and for CBA condition (right side). At the bottom, we compare methods thought the 20 layer scenario and 8 layers scenario.\nU =\nw\n258\n259\n260\n261\n262\n263\n264\n265\n266\nThe results showed an increase of phase error (&amp;\u00a3) with a reduction of the number of layers for both method for instance, the phase error for FSFS20-L increased from 0.3 s, with 20 layers, to 0.4, 0.6, 1, 1.5 and 2.1 seconds for 16, 13, 10, 8 and 5 layers, respectively (table 3). The results obtained considering the simulation with CBA approach shows higher phase error, which the 20-layer CBA simulation had similar results with the 8-layers FSFS simulation (figure 3). The increased phase error from the low vertical resolution results (less than ten) difficulties the direct comparison between methods due the increases of wave periods, which may appear the FSFS-5L results better than the FSFS-10L. The cumulative residual free surface elevation (figure 4) clarify the matter. In general, the error increases over time step and it becomes higher with the reduction of number of layers, however, when phase error is critical, the number of wave periods (N\u00b0T) increases, which reduced the cumulative free surface elevation error,\nFig. 4: Free surface elevation accumulated residuals series for FSFS approach (left) and for CBA approach (right), at x=y=0.25 m for 30 seconds of simulation, comparing different layers scenarios\nTable 1: Metrics between the analytical and simulated results from the FSFS method for each scenario for the first 10 seconds of simulation\nMetrics\tFSFS-20L\tFSFS-16L\tFSFS-13L\tFSFS-10L\tFSFS-8L\tFSFS-5L\nRMSE (mm)\t7.40\t11.52\t18.29\t30.53\t45.30\t89.20\nBIAS (mm)\t0.32\t0.32\t-0.77\t-2.11\t-3.54\t-7.61\nError (%)\t9.25\t14.28\t22.55\t37.79\t56.60\t114.13\nKGE\t0.93\t0.93\t0.82\t0.52\t0.18\t-0.88\nNSE\t0.99\t0.97\t0.93\t0.81\t0.57\t-0.66\nTable 2: Statistics metrics between the analytical and simulated results from the CBA method for each scenario for the first 10 seconds of simulation\nMetrics\tCBA-20L\tCBA-16L\tCBA-13L\tCBA-10L\tCBA-8L\tCBA-5L\nRMSE (mm)\t47.06\t57.68\t68.75\t83.48\t95.63\t107.80\nBIAS (mm)\t-4.35\t-5.65\t-6.88\t-7.96\t-7.57\t-1.06\nError (%)\t58.94\t72.70\t87.10\t106.42\t123.39\t145.02\nKGE\t0.004\t-0.30\t-0.61\t-0.91\t-0.93\t-0.20\nNSE\t0.54\t0.31\t0.017\t-0.45\t-0.90\t-1.42\nTable 3: Computational cost, Phases Error and number of wave periods between different methods and scenarios. The model was implemented with Fortran and simulated in a machine using an Intel R Xenon R CPU-E5-1620 3.7 GHz computer with 32 GB of RAM memory\nN L\tAt(s)\tFSFS No T\t\tAt(s)\tCBA\t\n\t\t\t\t\tNo T\t\n20-Layers\t2.8\t10\t0.3\t2.62\t10\t1.6\n16-Layers\t2.21\t10\t0.4\t2.14\t10\t2\n13-Tayers\t1.68\t10\t0.6\t1.67\t10\t2.4\n10-Layers\t1.54\t10\t1\t1.45\t11\t3.1\n8-Layers\t1.51\t10\t1.5\t1.34\t11\t3.8\n5-Layers\t1.22\t11\t2.1\t1.08\t12\t4.6\n268\n269\n270\n271\n272\n273\n274\n275\n276\n277\ntherefore, the calculated metrics (table 1 and 2) was only comparable between 0 and 10 s of simulations (figure 4). This effect can be better verified by the CBA accumulated residual series when the graphic changes the slope, which occurs sooner as the number of layers reduced (figure 4).\nAll statics metrics indicated a decreases of performance with a reduction of the number of layers. The metrics show that CBA-20L simulation had similar results as the FSFS-8L, as well CBA-10L to FSFS-5L. The CBA method also had a decreases of performance with a reduction of vertical resolution (tables 1 and 2). When CBA method is used, the phase error was 2 to 5 times higher, and with little difference in computational cost (ca. 7% smaller) (table 3) in comparison with FSFS method. We found a phase error similar with previous works using 20 \u2014 layers with CBA method (Yuan and Wu, 2004; Zijlema and Stelling, 2005).\n278\n279\n280\n281\nThe statistical test for FSFS approach showed significant differences between low (below 10 layers) and high (above 13 layers) vertical resolution, considering the free surface elevation residuals, which means, the simulation with 20 to 10 layers has similar (see table 4) and acceptable results (tables 1 and\n2).\nTable 4: Nemenyi posthoc test comparing the FSFS residue series of the simulation with 20 to 5 vertical\nlayers to indentify significative statiscal difference between results\nNo-L\tFSFS-20L\tFSFS-16L\tFSFS-13L\tFSFS-10L\tFSFS-8L\nFSFS-16L\t0.97833\t-\t-\t-\t-\nFSFS-13L\t0.24554\t0.69401\t-\t-\t-\nFSFS-10L\t&lt;0.05\t&lt;0. 05\t0.05269\t-\t-\nFSFS-8L\t&lt;0.05\t&lt;0. 05\t&lt;0. 05\t&lt;0. 05 -\t\nFSFS-5L\t&lt;0. 05\t&lt;0. 05\t&lt;0. 05\t0.70396\t0.5515\nFig. 5: Free surface vertical velocity (w) at x=y=0.25 m for 30 seconds of simulation comparing analytic solution (solid black line) with simulated solution for 20 to 5 layers scenario with FSFS condition (left side) and for CBA condition (right side). At the bottom, we compare methods thought the 20 layer scenario and 8 layers scenario.\n0\n282\n283\n284\n285\n286\n287\n288\n289\n290\n291\n292\nOur findings indicated that accuracy of vertical velocity component is affected by the vertical resolution applied, influencing directly the representation of wave phase (figure 5). For FSFS method, we have noted that the magnitude of vertical velocity components increases if one uses a vertical discretization up to 10 layers and the magnitude of vertical velocity components decreases for a vertical discretization above 10 layers (Figure 5). For CBA approach the magnitude of vertical velocity components decreases above 16, leading to a less flexible critical vertical resolution. Moreover, we also observed that the variation in horizontal resolution did not affect by wave phase representation, which seems to be more directly related with the wave damping (not analyzed in this paper).\n3.2\tWave propagation over a submerged bar\nA scheme of the experiment of the wave propagation over a submerged bar with an uneven bottom may be seen in (Fig. 6) (Beji and Battjes, 1993). At the upward slope of the bar, the shoaling wave\n293\n294\n295\n296\n297\n298\n299\n300\n301\n302\n303\n304\n305\n306\n307\n308\n309\n310\n311\n312\n313\n314\n315\n316\n317\n318\n319\n320\n321\n322\n323\n324\n325\n326\n327\n328\n329\n330\nbecomes non-linear due to the generation of bound higher harmonic. At the downward slope, the depth increases rather fast and these harmonics become free, resulting in an irregular pattern of waves (Dingemans, 1994). The numerical reproduction of this pattern has shown to be very demanding in terms of the accuracy of the computed dispersion frequency (Stelling and Zijlema, 2003).\nFig. 6: Scheme of experimental bottom geometry and location of wave level gauges. Source: Beji and Battjes (1993)\nThe computational domain has a total length of 30 m, with an initial undisturbed water level of 0.4 m, was discretized using a regular grid of 0.025 m resolution. The time step and the total simulation time was 0.005 s and 39 s, respectively. At the left boundary a sinusoidal wave condition, with period T = 2 s and amplitude A = 0.01 m, was imposed to represent the wave generator of the original experiment. At the right outflow boundary, the experimental absorbed beach was computationally represented by a 5m \u2014 sponge layer with a combination of a sponge layer technique (Park et al., 1999) and a Sommerfeld-type radiation boundary condition, applied to minimize wave reflection, given by:\n\n(.zm-A\tui\nif Xi > Xio\nif Xi &lt;0\n(33)\nwhere ei is the sponge layer coefficient, xi0 is the initial point, li the total length. This term must be added in the right side of equation (1) and (2).\nWe evaluated the capability of the model in correctly simulating the dispersion properties of the flow comparing simulated and measured free-surface elevation between 33 and 39 s of simulation under different vertical discretization scenarios using the proposed FSFS approach, since the first numerical experiment showed that the CBA method only may reach similar results to FSFS approach using a higher number of layers (figure 3). The FSFS approach was tested for 20, 16, 10, and 5 vertical layers comparing the free surface elevation at the six stations with the measurements of free-surface elevation. The performance of each scenario was evaluated by a few metrics (RMSE, BIAS, Error, KGE, NSE) and also statistically tested using a nonparametric Kruskal-Wallis test in the residues series follow by a Nemenyi test, since the residues series do not follows a normal distribution (shapiro-wilk) and have the same variance (Bartlett test).\nThe results (figure 7) indicated that the non-linearity after the upward slope (a), at the beginning and the middle of downward slope (b-c) were well represented by vertical resolutions from 20 to 10 layers, by comparing the experimental results patterns of Higher Amplitude Waves (HW) (e.g. 36.5s station b) and Low Amplitude Waves (LW) (e.g. 36s station a). For the stations (d), (e) and (f), after the deshoaling process, the simulations using 10, 16 and 20 layers were less accurate in representing the non-linearity pattern. Specifically, the LW in station (d) (e.g. 35 to 36s) and the HW in stations (e) and (f) (36s at station f). The 5-layers scenario showed the lower performance in comparison with the other scenarios, with an oscillatory behavior for the HW In stations (a) and (b), substantial phase errors (station c) and low capacity to represent LW and HW amplitudes (stations e and f).\nThe FSFS results (table 5) was capable in satisfactorily representing the phase, amplitude and wave patter for all stations using a higher vertical resolution (20 to 10 layers with FSFS method) (NSE from 0.94 to 0.5). Although, the results had high RMSE and Bias (between 13.7 and -9.9) relative to the mean maximum and minimum amplitudes for the six stations (4.1 and -6.3 mm) and had high Volume Error (between 26% and 116%), always underestimating the free-surface level, and with low performance in KGE parameter due the increased Volume Error. As we can see in figure 7, the high Volume Error\nFig. 7: Comparisons between experimental (circles) and computed data with 20-layers (solid black), 16-layers (dashed gray), 10-layers (solid red) and 5-layers (dashed blue), at 6 different level gauges.\nTable 5: Statistics metrics between simulated and experimental results for the six stations for each used layer scenario with FSFS method\nM\tStation a: x = 13.5 m\t\t\t\t20L\tStation d: x = 17.3 m\t\t5L\n\t20L\t16L\t10L\t5L\t\t16L\t10L\t\nRMSE (mm)\t2.67\t2.31\t3.40\t5.23\t4.12\t4.08\t5.57\t8.05\nBIAS (mm)\t-0.67\t-0.70\t-1.26\t-2.70\t-0.60\t-0.44\t-1.34\t-3.14\nError (%)\t26.47\t25.37\t34.07\t53.94\t59.29\t57.97\t79.03\t116.84\nKGE\t-0.95\t-1.06\t-2.69\t-6.92\t-4.57\t-3.06\t-11.30\t-27.85\nNSE\t0.92\t0.94\t0.87\t0.69\t0.76\t0.76\t0.56\t0.08\n\t\tStation b: x\t= 14.5 m\t\t\tStation e:\tx = 19.0 m\t\nRMSE (mm)\t3.68\t4.21\t4.18\t6.74\t4.30\t4.23\t5.69\t7.22\nBIAS (mm)\t-0.80\t-0.73\t-1.23\t-2.58\t-0.65\t-0.50\t-1.39\t-3.28\nError (%)\t37.73\t43.83\t44.30\t76.27\t48.15\t47.35\t62.91\t75.29\nKGE\t-0.83\t-0.68\t-1.80\t-4.88\t-54.45\t-41.24\t-117.00\t-277.78\nNSE\t0.82\t0.77\t0.77\t0.41\t0.72\t0.72\t0.50\t0.20\n\t\tStation c: x\t= 15.7 m\t\t\tStation f:\tx = 21.0 m\t\nRMSE (mm)\t3.91\t3.64\t5.45\t7.64\t4.57\t4.59\t5.61\t7.09\nBIAS (mm)\t-0.63\t-0.48\t-1.37\t-3.32\t-0.65\t-0.48\t-1.38\t-3.25\nError (%)\t44.46\t40.98\t62.63\t88.06\t56.63\t56.12\t67.62\t76.43\nKGE\t-1.13\t-0.63\t-3.58\t-10.09\t-9.80\t-7.09\t-22.02\t-53.11\nNSE\t0.79\t0.82\t0.60\t0.21\t0.69\t0.68\t0.53\t0.24\n331\n332\n333\n334\n335\n336\n337\n338\n339\nis expected. Moreover, the Kruskal-Wallis and Nemenyi statistical tests did not indicate a significant difference between the residues series, except in the station A for 5 layers scenario.\n4\tDiscussion\nThe statement that: algorithms which define nonhydrostatic pressure at the center of free-surface computational cell needs 10 to 20 vertical layers to resolve wave frequency dispersion to an acceptable accuracy, were wildly reported to justified the use or the proposal of new approaches to the free-surface boundary conditions for non-hydrostatic pressure and momentum equation discretization (Stelling and Zijlema, 2003; Yuan and Wu, 2004; Zijlema and Stelling, 2005; Cui et al., 2012; Lv, 2014; Liu et al., 2017). In general, this vertical resolution limitation is addressed to a classic finite difference discretization\n340\n341\n342\n343\n344\n345\n346\n347\n348\n349\n350\n351\n352\n353\n354\n355\n356\n357\n358\n359\n360\n361\n362\n363\n364\n365\n366\n367\n368\n369\n370\n371\n372\n373\n374\n375\n376\n377\n378\n379\n380\n381\n382\n383\n384\n385\n386\n387\n388\n389\n390\n391\n392\n393\n394\n395\nwith cell center nonhydrostatic pressure without boundary treatment at the free-surface computational cell (e.g. Casulli and Lang, 2004).\nThe improvement of nonhydrostatic hydrodynamic solution is due to the capability to set the values of dynamic pressure close to zero at the free-surface instead to the top layer, for any vertical resolutions using a FSFS condition. In a classic boundary approach, as expected the calculated nonhydrostatic pressure in the top layer increased with the reduction of the number of layers, differently when the proposed FSFS condition is used, which lead to a physically consistent numerical solution.\nThe results showed that the wave phase representation of short waves in deep water conditions (H > 0.5m) are related with the contour condition for the nonhydrostatic pressure at the free-surface, but also is influenced by vertical momentum discretization applied. Our findings showed that the proposed boundary condition for nonhydrostatic pressure at the free surface was capable to improve substantially the model capability in solving wave celerity and wave frequency dispersion in relation to the classic boundary condition approach with substantial diminishing in computation time to reach similar results (ca. 173%) and little additional computational cost (ca. 7%) to the same benchmark setup, though with a much higher performance (table 1 and 2).\nBesides the boundary condition treatment, the phase representation is also related with the used of a vertical momentum discretization less dependent of the velocity vertical profile. The number of layers may affect the vertical velocity estimative, thus affecting the nonhydrostatic pressure estimation and hence, the free-surface elevation and velocities fields.\nWe also identify that there is a vertical resolution threshold where the vertical velocity component is highly affected in deep water conditions. When number of the layer is lower than a vertical resolution threshold the wave phase error substantially increases over simulation time and it becomes higher with a reduction of the number of layers. The vertical resolution threshold is less restrictive using FSFS approach (10 layers) in comparison with CBA approach (20 layers). In shallow water conditions, the vertical resolution seems to have a nonsignificant impact on wave frequency dispersion, which the FSFS approach had satisfactory phase representation to 5 layers or more, and also had satisfactory representations of nonlinear behavior, similar to previous work (Casulli and Lang, 2004; Walters, 2005; Cui et al., 2012; Monteiro and Schettini, 2015). In summary, CBA approach may obtain similar results to the FSFS approach if used a feasible vertical resolution, for instance, the 20-layers CBA simulation has similar results to the 8-layers FSFS simulation, although with a substantial gain in computational cost.\nWhen compared with previous works solution (Stelling and Zijlema, 2003; Zijlema and Stelling, 2005; Yuan and Wu, 2004; Lv, 2014; Liu et al., 2017; Escalante et al., 2018a), the proposed approach applied at the free-surface has (i) low cost of implementation and (ii) medium performance. The FSFS approach only required a simple local boundary treatment, and it does not change the vertical moment numeric discretization, as the existing methods. Despite the numerical improvement and simple computational implementation, we observed a limitation imposed by the vertical resolution (number of layers) on the model accuracy, which makes medium performance model. As the vertical discretization influences directly the accuracy of horizontal and vertical velocities (see equations 18, 20, 23, 26) the proposed solution did not have good performance using a reduced number of layers (Less than 10).\nAll previous methods had satisfactory results with only 2 (Stelling and Zijlema, 2003; Yuan and Wu, 2004; Zijlema and Stelling, 2005; Escalante et al., 2018a) or 4 (Lv, 2014; Liu et al., 2017) layers for the same benchmark, and with similar computational cost for the same benchmark setup (10-layers simulation), 1.54 s (Intel Xenon 3.7 GHz), 1.83 s (Pentium 4 2.0 GHz Yuan and Wu, 2004) and 2.02 s (i7 2.93 GHz) (Liu et al., 2017) (works that registered the mean CPU time), although with CPU time less the 0.4 s for the best scenarios (2 or 4 layers).\nMoreover, the results analysis clarify some questions related with the vertical resolution issue for this kind of cell-centered nonhydrostatic model. When a contour treatment is used for non-hydrostatic pressure the vertical resolution threshold can be more flexible, allowing to use approximately 2 times less layer to resolve wave dispersion to an acceptable accuracy in a deep water situation. Despite this paper indicated a threshold of 10 layer with the FSFS approach, more analysis is needed to establish a local relation between number of layers and flow characteristics to properly solve the wave frequency dispersion.\n5\tConclusions\nThe treatment of non-hydrostatic pressure boundary condition at the top layer is mandatory to the numerical model reach satisfactory results compared to other models in licterature (e.g. Chen,\n396\n397\n398\n399\n400\n401\n402\n403\n404\n405\n406\n407\n408\n409\n410\n411\n412\n413\n414\n415\n416\n417\n418\n419\n420\n421\n422\n423\n424\n425\n426\n427\n428\n429\n430\n431\n432\n433\n434\n435\n436\n437\n438\n439\n440\n441\n442\n443\n444\n445\n446\n447\n448\n2003; Zijlema and Stelling, 2005; Cui et al., 2012; Liu et al., 2017). The proposed FSFS approach is a low implementation cost method to improve performance of non-hydrostatic models which can reach satisfactory results with 2 times less layers than CBA approach, hence reducing the mean computational cost of one time-step simulation in ca. 1.7 times, reaching similar results (CBA At = 2.62 s and FSFS At = 1.22 s).\nBeside the improvements, the new boundary condition treatment is still limited by the used vertical momentum discretization, leading to low performance with low vertical resolution in a deep water situation (less than 10 vertical layers). In shallow water conditions, the vertical resolution seems to have a nonsignificant impact on wave frequency dispersion. Based on the difference between deep and shallow water condition, more efforts are steel needed to establish a local relation between number of layers and flow characteristics to insure that the model properly solve the wave frequency dispersion with minimum vertical resolution.\n6\tAcknowledgments\nWe are grateful to the Coordena\u00e7\u00e3o de Aperfei\u00e7oamento de Pessoal de Nivel Superior (CAPES: http://www.capes.gov.br) and to the Conselho Nacional de Desenvolvimento Cientifico e Tecnologico (CNPq: http://www.cnpq.br) of Brazil for the MSc. scholarships awarded to Augusto Hugo Farias da Cunha (grant number: 149819/2017-0). Last but not least we are grateful to the Global Lake Ecological Observatory Network (GLEON: www.gleon.org) for providing a venue and resources for lake science discussions.\nReferences\nBeji S, Battjes J (1993) Experimental investigation of wave propagation over a bar. Coastal Engineering 19(1-2):151-162\nBeji S, Battjes J (1994) Numerical simulation of nonlinear wave propagation over a bar. Coastal Engineering 23(1-2):1-16\nBohacek J, Kharicha A, Ludwig A, Wu M, Karimi-Sibaki E, Paar A, Brandner M, Elizondo L, Trickl T (2018) A (non-) hydrostatic free-surface numerical model for two-layer flows. Applied Mathematics and Computation 319:301-317\nde Brito Jr AN, Fragoso Jr CR, Larson M (2018) Tidal exchange in a choked coastal lagoon: A study of mundau lagoon in northeastern brazil. Regional Studies in Marine Science 17:133-142\nCasulli V (1990) Semi-implicit finite difference methods for the two-dimensional shallow water equations. Journal of Computational Physics 86(1):56-74\nCasulli V (1999) A semi-implicit finite difference method for non-hydrostatic, free-surface flows. International Journal for Numerical Methods in Fluids 30(4):425-440\nCasulli V, Cheng RT (1992) Semi-implicit finite difference methods for three-dimensional shallow water flow. International Journal for numerical methods in fluids 15(6):629-648\nCasulli V, Lang G (2004) Mathematical model untrim, validation document 1.0. the federal waterways engineering and research institute (baw), hamburg, germany\nCasulli V, Stelling GS (1998) Numerical simulation of 3d quasi-hydrostatic, free-surface flows. Journal of Hydraulic Engineering 124(7):678-686\nChen X (2003) A fully hydrodynamic model for three-dimensional, free-surface flows. International Journal for Numerical Methods in Fluids 42(9):929-952\nCui H, Pietrzak J, Stelling G (2012) Improved efficiency of a non-hydrostatic, unstructured grid, finite volume model. Ocean Modelling 54:55-67\nDingemans M (1994) Comparison of computations with boussinesq-like models and laboratory measurements. memo in framework of MAST project (G8-M), Delft Hydraulics memo H1684 12\nEscalante C, Fernandez-Nieto E, de Luna TM, Castro M (2018a) An efficient two-layer non-hydrostatic approach for dispersive water waves. Journal of Scientific Computing pp 1-48\nEscalante C, de Luna TM, Castro M (2018b) Non-hydrostatic pressure shallow flows: Gpu implementation using finite volume and finite difference scheme. Applied Mathematics and Computation 338:631-659 Fringer O, Armfield S, Street R (2005) Reducing numerical diffusion in interfacial gravity wave simulations.\nInternational Journal for Numerical Methods in Fluids 49(3):301-329\nHodges BR, Imberger J, Saggio A, Winters KB (2000) Modeling basin-scale internal waves in a stratified lake. Limnology and oceanography 45(7):1603-1620\n449\n450\n451\n452\n453\n454\n455\n456\n457\n458\n459\n460\n461\n462\n463\n464\n465\n466\n467\n468\n469\n470\n471\n472\n473\n474\n475\n476\n477\n478\n479\n480\n481\n482\n483\n484\n485\n486\n487\n488\n489\n490\n491\n492\n493\n494\n495\n496\nJankowski JA (1999) A non-hydrostatic model for free surface flows. PhD thesis, Inst. f\u00fcr Stromungsmechanik und Elektronisches Rechnen im Bauwesen\nKanarska Y, Maderich V (2003) A non-hydrostatic numerical model for calculating free-surface stratified flows. Ocean Dynamics 53(3):176-185\nLiu X, Ma Dg, Zhang Qh (2017) A higher-efficient non-hydrostatic finite volume model for strong three-dimensional free surface flows and sediment transport. China Ocean Engineering 31(6):736-746\nLu X, Dong B, Mao B, Zhang X (2015) A two-dimensional depth-integrated non-hydrostatic numerical model for nearshore wave propagation. Ocean Modelling 96:187-202\nLv B (2014) A higher-efficient three-dimensional numerical model for small amplitude free surface flows. China Ocean Engineering 28(5):617-628\nMarshall J, Hill C, Perelman L, Adcroft A (1997) Hydrostatic, quasi-hydrostatic, and nonhydrostatic ocean modeling. Journal of Geophysical Research: Oceans 102(C3):5733-5752\nMonteiro LR, Schettini EBC (2015) Compara\u00e7\u00e3o entre a aproximacao hidrost\u00e1tica e a n\u00e3o-hidrostatica na simulacao num\u00e1rica de escoamentos com superf\u00e1cie livre. Revista Brasileira de Recursos H\u00e1dricos 20:1051-1062\nMunar AM, Cavalcanti JR, Bravo JM, Fan FM, da Motta-Marques D, Fragoso Jr CR (2018) Coupling large-scale hydrological and hydrodynamic modeling: Toward a better comprehension of watershedshallow lake processes. Journal of hydrology 564:424-441\nNamin M, Lin B, Falconer R (2001) An implicit numerical algorithm for solving non-hydrostatic free-surface flow problems. International Journal for Numerical Methods in Fluids 35(3):341-356\nPark JC, Kim MH, Miyata H (1999) Fully non-linear free-surface simulations by a 3d viscous numerical wave tank. International Journal for Numerical Methods in Fluids 29(6):685-703\nSoulignac F, Vincon-Leite B, Lemaire BJ, Martins JRS, Bonhomme C, Dubois P, Mezemate Y, Tchigu-irinskaia I, Schertzer D, Tassin B (2017) Performance assessment of a 3d hydrodynamic model using high temporal resolution measurements in a shallow urban lake. Environmental Modeling &amp; Assessment 22(4):309-322\nStelling G, Zijlema M (2003) An accurate and efficient finite-difference algorithm for non-hydrostatic free-surface flow with application to wave propagation. International Journal for Numerical Methods in Fluids 43(1):1-23\nValipour R, Bouffard D, Boegman L, Rao YR (2015) Near-inertial waves in lake erie. Limnology and Oceanography 60(5):1522-1535\nVilas MP, Marti CL, Adams MP, Oldham CE, Hipsey MR (2017) Invasive macrophytes control the spatial and temporal patterns of temperature and dissolved oxygen in a shallow lake: A proposed feedback mechanism of macrophyte loss. Frontiers in plant science 8:2097\nWadzuk BM, Hodges BR (2004) Hydrostatic and non-hydrostatic internal wave models. Tech. rep., Center for Research in Water Resources, University of Texas at Austin\nWalters RA (2005) A semi-implicit finite element model for non-hydrostatic (dispersive) surface waves. International Journal for Numerical Methods in Fluids 49(7):721-737\nWang K, Jin S, Liu G (2009) Numerical modelling of free-surface flows with bottom and surface-layer pressure treatment. Journal of Hydrodynamics 21(3):352-359\nYin J, Sun Jw, Wang Xg, Yu Yh, Sun Zc (2017) A hybrid finite-volume and finite difference scheme for depth-integrated non-hydrostatic model. China Ocean Engineering 31(3):261-271\nYuan H, Wu CH (2004) An implicit three-dimensional fully non-hydrostatic model for free-surface flows. International Journal for Numerical Methods in Fluids 46(7):709-733\nZhang J, Liang D, Liu H (2018) A hybrid hydrostatic and non-hydrostatic numerical model for shallow flow simulations. Estuarine, Coastal and Shelf Science 205:21-29\nZijlema M, Stelling GS (2005) Further experiences with computing non-hydrostatic free-surface flows involving water waves. International journal for numerical methods in fluids 48(2):169-197\nCombined use of high resolution numerical schemes to reduce numerical diffusion in coupled hydrodynamic and solute transport models\nCOMBINED USE OF HIGH RESOLUTION NUMERICAL SCHEMES\nTO REDUCE NUMERICAL DIFFUSION IN COUPLED\nHYDRODYNAMIC AND SOLUTE TRANSPORT MODELS\nAugusto Hugo Farias da Cunha Carlos Ruberto Fragoso Jr. Matheus Henrique Tavares J. Rafael Cavalcanti Marie-Paule Bonnet David da Motta Marques\nArtigo submetido no peri\u00f3dico \u201cEnvironmental Fluid Mechanics\", fator de impacto Qualis CAPES: Engenharias I - A2.\nCombined use of high resolution numerical schemes to reduce numerical diffusion in coupled hydrodynamic and solute transport models\nA. Hugo F. Cunha \u2022 Carlos R. Fragoso Jr.2 \u2022 Matheus\nH. Tavares* 1 \u2022 J. Rafael Cavalcanti1 \u2022 Marie-Paule Bonnet3 \u2022 David Motta-Marques1\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\nAbstract When the ratio of vertical to horizontal motion scales is not small, a non-hydrostatic approach may be necessary in order to accurately simulate three-dimensional free-surface flows in large aquatic ecosystems such as lakes, estuaries, reservoirs and coastal zones. Although the non-hydrostatic approach improves the physical representation of pressure, acceleration and velocity fields, it is not free of numerical diffusion. This numerical issue stems from the numerical solution employed in the advection and diffusion terms of the Reynolds averaged Navier-Stokes (RANS) and solute-transport equations. The combined use of high-resolution schemes in coupled hydrodynamic and solute-transport models is a promising alternative to minimize these numerical issues and determine the relationship between numerical diffusion in the two solutions. We evaluated the numerical diffusion in three numerical experiments, for different purposes. The first two experiments evaluated the potential for reducing numerical diffusion in a hydrodynamic solution, by applying a Quadratic interpolator over a Bilinear, applied in the ELM step-ii interpolation, and the capability of representing the propagation of complex waves. The third experiment evaluated the effect on numerical diffusion of using flux-limiter schemes over a first-order Upwind, combined with the interpolation methods applied in a coupled hydrodynamic and solute-transport model. The high-resolution methods were able to substantially reduce the numerical diffusion in a solute-transport problem. This exercise showed that the numerical diffusion of a hydrodynamic solution has a major influence on the ability of the model to simulate stratified internal waves, indicating that high-resolution methods must be implemented in the numerical solution to properly simulate real situations.\nKeywords Numerical Diffusion \u2022 Eulerian-Lagrangian method \u2022 Interpolation \u2022 Flux Limite\n1\tIntroduction\nWhen the ratio of vertical to horizontal motion scales is not small (e.g., flows over abruptly changing bottom topography, orbital movements in short-wave motions, or intensive vertical circulation), a nonhydrostatic approach may be necessary in order to accurately simulate three-dimensional free-surface flows in large aquatic ecosystems such as lakes, estuaries, reservoirs and coastal zones (Marshall et al., 1997; Casulli and Stelling, 1998; Chen, 2003). There is a trade-off between implementation and the computation cost when hydrostatic and non-hydrostatic approaches are compared. The non-hydrostatic approach, in general, requires more-complex interactive numeric methods (Stelling and Zijlema, 2003; Casulli and Lang, 2004), which increases the computation cost compared to the hydrostatic approach using the same computation grid. The non-hydrostatic approach also improves the physical representation of the phenomenon and requires fewer vertical layers to obtain physically satisfactory results than does the hydrostatic approach. Therefore, to obtain similar results, the hydrostatic approach requires more\nHydraulic Research Institute;\n1\tFederal Univerisity of Rio Grande do Sul, Porto Alegre, Rio Grande do Sul,Brazil\nTel.: +55 51-3308-6670\nE-mail: hugo.cunha@ufrgs.br\n2\tCentro de Tecnologia;\nUniversidade Federal de Alagoas, Macei\u00f3, Brasil\n3Laboratoire des M\u00f3canismes de Transfert en G\u00f3ologie;\n3-RD UR 154, 1400 Toulouse, France\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n86\n87\n88\n89\nvertical layers, necessitating a higher computation cost than with the non-hydrostatic approach (Liu et al., 2017).\nWhatever the approach (hydrostatic or non-hydrostatic), the numerical-diffusion issue remains critical, and many studies have attempted to reduce it by adopting diverse approaches. Higher-resolution techniques (e.g., quadratic, cubic and spline interpolators and flux limiters) have proven to be a promising alternative in order to minimize these numerical issues (Cheng et al., 1984; Ruan and McLaughlin, 1999; Waterson and Deconinck, 2007; Kong et al., 2013; Ye et al., 2018). Although previous studies showed that higher-resolution schemes might not maintain some important characteristics of a numerical solution (e.g., spurious oscillations of internal waves) (Wang and Lacroix, 1997), they may better represent the nonlinear behavior of a velocity field than low-resolution schemes (Upwind solute-transport solver, bilinear interpolation). Although linear schemes might be more stable, monotonic, and easily implemented, they still might give unsatisfactory results due to higher numerical diffusion. Generally, higher-resolution techniques are applied to reduce numerical diffusion separately in RANS-based (Reynolds averaged Navier-Stokes) or solute-transport models, without determining the relationship with the numerical diffusion caused by the solutions.\nThe Eulerian-Lagrangian Method (ELM) is one of the most popular and accurate techniques used to numerically solve the advection terms in RANS and solute-transport equations (Cheng et al., 1984; Ruan and McLaughlin, 1999; Cox and Runkel, 2008; Casulli and Cheng, 1992; Jankowski, 1999; Hodges et al., 2000; Wadzuk and Hodges, 2004; Walters, 2005; Fringer et al., 2005; Monteiro and Schettini, 2015). The purpose of ELM is to combine the simplicity of the fixed Eulerian computational grid with a stable and accurate Lagrangian approach. In summary, the ELM has two major steps (Staniforth and Cote, 1991): (i) a particle-tracking method, which consists of obtaining the location of the departure point of a fluid particle in the Lagrangian step by integrating a characteristic equation backward in time using a certain number of sub-time steps; and (ii) a repeated interpolation of the advected field in each sub-time step in order to estimate the velocity components at the departure point. As the result of the interpolation errors in the two steps, the ELM may introduce a substantial numerical diffusion when low-resolution interpolation schemes are used, or spurious oscillation when high-resolution interpolation schemes are used in the hydrodynamic and mass-transport solutions (Cheng et al., 1984; Oliveira and Baptista, 1998; Ruan and McLaughlin, 1999).\nThe interpolation technique used in the second step has a major impact on the total numerical diffusion produced in ELM, especially when low-resolution interpolation schemes are used, since both particle tracking and velocity retrieval are substantially affected by the interpolation process (Staniforth and Cote, 1991). Accordingly, Hodges et al. (2000) proposed a stable non-conciliatory quadratic Lagrange interpolation for a three-dimensional mesh, where 27 grid points are used to estimate the velocity values during the particle-tracking process. This technique has not yet been formally analyzed (Hodges et al., 2006, without any posterior record of formal analyses), although previous studies successfully modeled hydrodynamic and solute-transport simulations, strongly indicating that the solution satisfactorily represented internal gravity waves and may improve the ability of ELM to solve the free-surface motion (Hodges et al., 2000; Laval et al., 2003, 2005; Hodges et al., 2006; Valipour et al., 2015; Vilas et al., 2017; Soulignac et al., 2017).\nThe solute-transport solution can also be reached using numerical schemes other than ELM, such as high-order Total Variation Diminishing (TVD) schemes, Random Walk Particle Tracking (RWPT) and Smoothed Particle Hydrodynamics (SPH), which have been thoroughly discussed by Boso et al. (2013). One simple scheme to discretize the mass-conservation equation, with a low cost of implementation, is the first-order Upwind, to which the flux-limiter technique can be applied in order to reduce the well-known numerical diffusion of this discretization (Casulli and Zanolli, 2005; Zhang et al., 2018). The flux-limiter scheme proved to be one of the most effective approaches to constructing a nonlinear high-resolution scheme (Waterson and Deconinck, 2007). These schemes are simple functions that define a convection scheme based on a ratio of local gradients in the solution field, with a limited behavior in order to maintain the monotonicity, usually defined by a Total Variation Diminishing (TVD) condition (Sweby, 1984; Waterson and Deconinck, 2007). This method has been widely used to retrieve less diffusive and stable solutions, even in critical situations, such as in sharp concentration gradients in regions with a small Courant number (Wadzuk and Hodges, 2004; Fringer et al., 2005; Casulli and Zanolli, 2005; Kong et al., 2013; Zhang et al., 2015; Ye et al., 2018; Zhang et al., 2018; Nangia et al., 2019).\nFor solute-transport models, it is usually assumed that that the numerical solution is free of hydrodynamic numerical diffusion and that any error is leads to mass transport solution, and therefore the formal evaluation of the effect of hydrodynamic numerical diffusion on the solute-transport solution may not be properly addressed (Cheng et al., 1984; Ruan and McLaughlin, 1999; Cox and Runkel, 2008).\n90\n91\n92\n93\n94\n95\n96\n97\n98\n99\n100\n101\n102\n103\n104\n105\n106\n107\n108\n109\n110\n111\n112\n113\n114\n115\n116\n117\n118\n119\n120\n121\n122\n123\n124\n125\n126\nTherefore, coupling of hydrodynamic and solute-transport models may be useful in order to determine the relationship between numerical diffusion in the two solutions, which is still underexplored. Usually, studies using a coupled model propose improvements of the hydrodynamic or transport module to investigate numerical diffusion in one of the solutions separately, without accounting for the possibility that the use, or not, of high-resolution methods in one solution may affect the other (Wadzuk and Hodges, 2004; Fringer et al., 2005; Casulli and Zanolli, 2005; Kong et al., 2013; Ye et al., 2018; Zhang et al., 2018; Chandran et al., 2019). Thus, further effort is needed to understand how numerical diffusion, produced by low-resolution schemes in the hydrodynamic solution, may be transferred to solute-transport.\nTo explore this question, we tested a nonlinear quadratic interpolation in contrast to a linear one in ELM step-ii, combined with several flux-limiter schemes applied in the solute-transport module in order to reduce numerical diffusion, and evaluated the effect of the combined use of these methods on the solute-transport numerical diffusion. We used a coupled hydrodynamic solute-transport model with non-hydrostatic and flux-limiter Upwind approaches to evaluate the numerical diffusion in three numerical experiments, for different purposes: (a) the first two experiments evaluated the potential for reducing the numerical diffusion in the hydrodynamic solution, by applying a non-linear interpolator rather than a linear one, and the capability of representing the propagation of complex waves; (b) the third experiment evaluated the effect of using high-resolution schemes on the numerical diffusion of combined hydrodynamic and solute-transport models.\n2\tMathematical considerations\n2.1\tGoverning equations\nThe RANS equations are used to describe three-dimensional free-surface flows. These equations express the physical principle of volume, mass, and momentum conservation. The momentum equations for an incompressible fluid have the following form:\ndu\tdu\tdu\tdu\t\u201e\n\u2014 + u \u2014 + v\u2014 + w---fv =\ndt\tdx\tdy\tdz\ndpa\tdp\td\ndx\tdx\tdx\n^0 dz\nPo\ndq\ndx\n+v h\nd2u d2u\\\ndx2 + dy2 y\n+\nd dz\n(1)\ndv\tdv\tdv\tdv\n\u2014 + u \u2014 + v \u2014 + w \u2014 + f u = dt\tdx\tdy\tdz\ndpy_\tM r P - Po dz\ndy 9 dy 9 dy [jz\tp0\ndq\ndy\n+v h\nd2 v d 2v\\\ndx2 + dy2j\nd_ + dZ\n(2)\ndw\tdw\tdw\tdw\tdq\th (d2w\td2w\\\nIt+ u \u25a0 + v + w = ~dZ~z + v +\t+ di\nd. Lv\ndz\\ dz J\n(3)\nwhere u(x,y,z,t), v(x,y,z,t), and w(x,y,z,t) are the velocity components in the horizontal (x and y) and vertical (z) directions, respectively; where vh e vv are the horizontal and vertical turbulent eddy viscosity coefficients, respectively; t is the time; pa(x,y,z,t) is the atmospheric pressure; q is the free-surface elevation from a water-level reference. The second and third terms on the right-hand side of equations (1) and (2) represent the barotropic and the baroclinic contributions to the hydrostatic pressure; q(x,y,z,t) denotes the non-hydrostatic pressure component; f is the Coriolis parameter; and 9 is the gravitational acceleration.\nWhen a simple hydrostatic approach is considered, equation (3) is neglected and q is assumed to be equal to zero in equations (1) and (2). In this case, it is assumed that the vertical acceleration does not have a significant effect on the velocity field in comparison with the horizontal acceleration, which is the assumption usually applied for simulation of shallow waters (e.g. Jin and Ji, 2005; Cavalcanti et al., 2016; Tang et al., 2017; Munar et al., 2018).\nThe volume conservation is expressed by the incompressibility condition and the continuity equation,\ngiven by:\tdu\tdv dw 0 dx ' dy ' dz\n127\n128\n129\n130\n131\n132\n133\n134\n135\n136\n137\n138\n139\n140\n141\n142\n143\n144\n145\n146\n147\n148\n149\n150\n151\n152\n153\n154\n155\n156\n157\n158\n159\n160\n161\n162\n163\nIntegrating equation (4) over depth leads to the following equation:\nf\ndu\tdv\tdw\ndz =\nh\n-h\ndu .\n^~dz +\ndx\nh\n-h\nd v ,\n~z~dz + dy\nh\n-h\n^dz = 0\ndz\n(5)\ndx + dy + dz\nwhere h is the bathymetry measured from the theorical undisturbed water surface (zero referential). Using the Leibniz integration rule, in each direction, in equation (5) aand using a kinematic condition at the free surface leads to the following free-surface equation:\ndn d dt ' dx\nh\n-h\nj\t9\nudz + \u2014 dy\nh\n-h\nvdz = 0\n(6)\nFinally, the mass conservation of a conservative scalar variable may be expressed by the following equation:\ndC d(uC)\td(vC)\td(wC)\ndt + dx + dy + dz\n=&amp; (k h de)+jy *h dCd\t%)\n(7)\nwhere C is the concentration of a conservative substance being transported (e.g., salinity); and Kh and Kv aare the horizontal and vertical turbulent eddy diffusivity coefficients, respectively.\nFor both the velocity field and scalar transport solutions, the boundary conditions are implemented under the assumption of \u201cfree-slip\u201d boundaries. The Dirichlet and Neumann conditions were assigned to represent the normal and tangential velocities in the solid boundaries, respectively. For the scalar solution, a no-flux boundary condition is assumed in solid boundaries\nThe tangential stress boundary conditions for the momentum equations 1 at the free-surface are specified by the prescribed wind stresses, which can be approximated as:\ndu\tdv\nvvdz = Yt(ua - u),vvdz = Yt(va - v); at z = n\n(8)\nwhere ua and va are the horizontal wind velocity components, and yT is a non-negative wind stress coefficient. The bottom friction is specified by:\nvdu\tvdv\t,\nv \u2014 = YB u, v \u2014 = YB v; at z = -dz\tdz\n(9)\nwhere y B is a non-negative bottom friction coefficient, which is typically represented by means of a Manning or Chezy coefficient.\n2.2\tGrid and Variable Locations\n\u2022 7\nThe computation grid can be described as a generic unstructured orthogonal grid, having Np elements, each having an arbitrary number of sides Si > 3, i =1, 2, ..., Np (figure 1).\nLet Ns be the total number of sides in the grid. The length of each side is Xj, j = 1, 2, ..., Np. The vertical faces of the i-th element are identified by an index j(itl), l = 1, 2, ..., Si, so that 1 &lt;j(itl) &lt;Ns. Similarly, the two polygons that share the j \u2014 th vertical face of the grid are identified by the indices i(j,i) and i(j,2), so that 1 &lt;i(j,i) &lt;Np and 1 &lt;i(j,2) &lt;Np. The non-zero distance between centers of two adjacent polygons that share the j-th side is denoted by Sj.\nAlong the vertical direction, a simple finite difference discretization, not necessarily uniform, is adopted. By denoting a given level surface as Azk+1 the vertical discretization step is defined by:\nAzk = Azk+i - Azk-i k = l,2, ...,NS\t(10)\nThe three-dimensional space discretization consists of elements whose horizontal faces are the polygons of a given orthogonal grid, represented by the layers at k + 1 (upper face) or k - 1 (bottom face), and whose height, for each layer, is Azk. The water-surface elevation (n), is located at the barycenter of the upper horizontal face for each i-th element. The velocity component normal to each horizontal face is assumed to be constant over the face of each computation cell, which is defined at the point of intersection between the face and the segment joining the centers of the two prisms that share the face. The non-hydrostatic pressure component q\u2122k and the concentrations C\u2122k are located at the center of the i-th computation cell, halfway between Azk+1 and Azk-1. Finally, the water depth hj is specified and assumed constant on each vertical face of an element.\n164\n165\n166\n167\n168\n169\n170\n171\n172\n173\n174\n175\n176\n177\n178\n179\n180\n181\n182\n183\n184\n185\n186\n187\n188\n2.3\tNumerical Approach\n2.3.1 RANS equations\nWe used a semi-implicit method (^-Method, Casulli, 1990) in a finite-difference finite-volume model, with a Eulerian-Lagrangian Method (Casulli and Cheng, 1992) to solve the convective and viscous terms of the RANS equations, and a fractional-step framework (Casulli and Lang, 2004) solve the pressure component by splitting the pressure into hydrostatic and non-hydrostatic parts. The first step of the hydrodynamic solution is to compute the provisional water velocity and surface elevation, neglecting the implicit contribution of the non-hydrostatic pressure. In the second fractional step, the provisional velocity (iz, v and w) and provisional surface elevation (rj) are corrected by non-hydrostatic pressure terms. A complete description of the numerical solution for non-hydrostatic flows was provided by Casulli and Lang (2004), and is here named CL04. Here, we describe in detail only the Eulerian-Lagrangian method in order to clarify where the high-resolution methods were applied.\nOne difficulty in the numerical treatment of RANS equations arises from the discretization of the convective and viscous terms of the convection-diffusion equation in three dimensions (Equations 1-3). The advection-diffusion equation without Coriolis and pressure terms can be described as:\ndc\tdc dc dc dc\ndt -\t\u00e3i+ u dx\t+ v dy\t+ w a!\t- \u201c\nB2c\td2c\\\td 7 dc\\\ndx2 + dy2 + B~z V d~z\n(11)\nwhere c is a generic variable (e.g. velocity components u, v, w) (Casulli and Cheng, 1992). In order to simply solve and improve the stability and accuracy of an explicit finite-difference method, consider equation (11) in the Lagrangian form:\ndc =\t\u00cd d2c B2c\\ d 7 dc\\\ndt\tdx2 + By2 + dz V dz\n(12)\nwhere the substantial derivative d indicates that the rate of change over time, which is calculated along\nthe stream line, is defined by:\tdx\tdy\tdz \u2014 \u2014 u,\t\u2014\t\u2014\tv,\t\u2014\t\u2014 w\t(13) dt\tdt\tdt\nAn explicit discretization of equation (13) can be given by:\ncn+1  cn + 1\nCj,k + 1 Cj,k\n(jn + 1_<jn+1\nCj,k\tCj,k\u20141\nvk+1\nVu\t1\nk 2\nAt\n+ ^AhCjy\n(14)\n\nj)\nAzj, k\nwhere C* j k denotes a generic variable at the j-th side of a grid at vertical level and time step n.\nIn order to apply the Lagrangian discretization in a Eulerian grid, a backward stream line is required to estimate the departure velocity at time \u201cn\u201d ((Lagrangian approach) required to reach the final position \u201cj,k\u201d at time \u201cn + 1\u201d (Eulerian approach). (Eulerian approach). To estimate the particle departure\n189\n190\n191\n192\n193\n194\npoint, the ELM step-i interpolation is applied, which requires a particle-tracking method. A multi-step backward Euler (MSE) was applied, but other methods can be satisfactorily applied as well (e.g. fifthorder Runge-Kutta) (Oliveira and Baptista, 1998). However, the departure position is not a grid point, and an interpolation formula using known node points must be used to define Cj k (ELM step-ii).\nA consistent semi-implicit finite difference discretization is used to calculate the provisional horizontal velocity component from momentum equations (1-2) and takes the following form (CL04):\nU\".IP = Fu],k - (1 - 0)\t[5(C(jr) - 3i(j,l)) + (qi(j,r),k -\n\u00bfj *\u2022\n0a \u2014 (nn+1 - nn+1 _____________\u2014\n9 \u00bfj P9i(j,r)\tni(j,l)) + \u2014gn\n\u2014n+1\t\u2014n+1\nv\t^j,k + 1\t^j,k\nVjk+ 2\t\u2014Zn. + !\n.\tj,k+ 2\nv\nvj,k-\n\u2014n+1\t\u2014n + 1\n^j,k\t^j,k-1\n2 \u2014Zn\n(15)\njk-2\nqi(j,l) ,fc)]\nj, k\n195\n196\n197\n198\n199\n200\n201\n202\nk = mj ,mj+1,.. . ,Mj\nwhere unk denotes the horizontal velocity component normal to the j-th side of the grid at vertical level k, and time step n; nfj r) is the free-surface level at the right neighbor j-th element from the j-th side and rff/j l) from left neighbor; qij r) k denotes the non-hydrostatic pressure component; and F is an explicit finite-difference operator, which accounts for the contributions from discretization of the air pressure, Coriolis, baroclinic pressure, advection, and horizontal friction terms.\nAnalogously to equation (15), a semi-implicit finite-difference discretization for the provisional vertical-velocity component (neglecting the non-hydrostatic pressure contribution) at the top of each computation cell is derived from equation (3):\nw 1 = Fwik+2 - (1 - \u00b0)\n\u2014t\t(qn\t_ qn ) I\t\u2014t\n\u2014Zn\t'^i\u2019k+1\t\u201ci,k) ' \u2014Zn\ni,k+2\ti,k+2\nn+1\tn+1\tn+1\nv\twi,k+3 - wkk+2\tv wi,k+1\nvi,k+1----\u2014Z +1----------vi,k-------\nn+1\n- 'wi,k-2 \u2014Znk\ni,k\nk = mi,mi+1,Mn - 1\n(16)\n203\n204\n205\nwhere Fw aaccounts only for contributions from the discretization of the advection and horizontal-friction terms. The Eulerian-Lagrangian method can be applied to discretize the finite difference operator F in equations 15 and 16, given by:\n\u2014t Mi\nF\u2019uj,k = uj,k + vh \u2014t\u2014huj,k + f\u2014tvj,k - S-$\u2014\t- Pi(j,1),^ \u2014zj,e\nj P0 t=k\n206\n(17)\n207\n208\n209\n210\n211\n212\n213\n214\n215\n216\n217\n218\n219\n220\nFwZk+ 2 = Wj,k+ 2 + Vh\u2014t\u2014hWi,k+ 2\t(18)\nwhere uj k denotes the horizontal velocity component normal to the j-th side of the grid interpolated at time tn at the end of the Lagrangian trajectory; vj k denotes the horizontal velocity component orthogonal to uj k; w* k+1 denotes the vertical velocity component normal to the upper horizontal face of element \u201cj\u201d at layer \u201ck + |~-k = | and = 1, for \u00a3 = k; \u2014h is the discretization of the horizontal Laplacian. The Lagrangian trajectory is calculated by integrating the velocity backward in time from a face\u2019s (j,k) barycenter at tn+1 to its location at time tn. The second step of the interpolation technique is discussed further below.\n2.3.2 Solute-Transport Equation\nWe used a conservative finite-volume scheme with a semi-implicit approach based on CL04 with time-accurate local time stepping based on Cavalcanti et al. (2015), in order to discretize the solute-transport equation. The CL04 approach yields a conservative solution, also respecting the max-min property.\nAssume that S+ represents the set of vertical faces belonging to the computation cell (i,k) through which water is leaving the respective computation cell; and S- represents the set of vertical faces through which water is entering the same computation cell and , p(i,j) is the neighbor of the computation cell\n221\n222\n223\n224\n225\n226\n227\n228\n229\n230\n231\n232\n233\n234\n235\n236\n237\n238\n239\n240\n241\n(i,k) that shares the vertical face (ij). For each computational cell, equation (7) for scalar transport is discretized as follows:\nPiAzn+ 1Cn+1\n1\ti, k\ti,k\nElnn+6^in\t\\ A \\f-\\n+0^tn\n\\Qj,k \\Ci,k -\t/ ^\t\\Qj,k \\Cr(i,j'),k\nj-\tjeS7k\n- At[ I Qn,ke+1 \\Cnk - Qn,8-1 \\Cnk-1] + At E\tdn,+k3 * S * * [Cj - Cnk]\njeSikuS-k\n- At [dn,-1 (cEi - Cn+- dn,-. c,1 - c^)]\n- A he 2 \\ Qnk-1 \\(ch+1 - Cnk) - c-1 \\Qnk-1 icn, - Cn-1)]\n- A E\tjIQ\t(Cj - C,)\njeSikuS-k\n- F<Az~j, C-J, - At\n(19)\nwhere\ndn- i \u2014 max | 0.Dnk, 1\ni,k\u00b1 1\tI \u2019 i,k\u00b1 2\n-1 |qx\u00b1 il)\n(20)\nj- \u2014 max\t-\n1 j l)\n(21)\nwhere Qn\u2014\tXjAzn, unke\tand\tQ'.'.\t- 1 \u2014\tPiwn+\u2014 1\tare the advective-flux coefficients, and\tDn,\t\u2014\nAj.k\tj j,k j,k\t^i,k\u00b1 1\t1 j,k\u00b1 1\t\u2019\tj,k\nKh\tKv k\u00b1 1\nXjAz'Xj and Dnk\u00b1i \u2014 Pi^zn\u2014~ are the diffusive-flux coefficients. In equation (19) the first term 3 2\ti, k\u00b11\non the right side is the mass in layer k at time n; the second is the horizontal-advection term; the third is the vertical advection, followed by the horizontal and vertical-diffusion terms. The last two terms are the numerical-diffusion reduction terms , which depend on the high-resolution scheme to estimate h\nThe h represents the flux limiter itself, and is given by:\n\n\u2014 $\nj,k\nnn\nj,k\tVj,k\n(22)\nn\nwhere $ is the partial flux limiter and 0 is a function that assures the independence between the max-min property and mesh size, and is given by:\nf 1D\n' \u2014 E\u2019j\n(23)\nWhen the horizontal and vertical diffusion is set equal to zero, k \u2014 0, hence k \u2014 $nk \u2022 The Upwind scheme may be easily obtained when $ (r) \u2014 0.\n3\tHigh-resolution schemes to reduce numerical diffusion\nFor the hydrodynamic solution, two different interpolators at ELM step-ii were tested: a simple\nbilinear interpolation (Casulli and Cheng, 1992) and a quadratic interpolator (Hodges et al., 2000), both\napplied in a regular structure grid. Regarding the solute-transport solution, three different flux limiters were used: MUSCL, Superbee and Ultimate Quickest, which performed best for coupled hydrodynamic\nand transport simulations in previous studies (Hodges et al., 2000; Fringer et al., 2005; Casulli and\nZanolli, 2005; Ye et al., 2018).\n242\n243\n244\n245\n246\n247\n248\n249\n250\n251\n252\n253\n254\n255\n256\n257\n258\n259\n260\n261\n262\n263\n264\n265\n266\n267\n268\n269\n270\n271\n3.1\tFlux-Limiter\nIn order to retrieve some accuracy from the solute-transport first order upwind scheme, an additional \u201danti-diffusive\u201d term is used (equation 22), the so-called flux limiter function. The high-resolution methods applied to the solute-transport solution are described as follows:\n1.\tUpWind\n$(rf) = 0\t(24)\n2.\tMUSCL (Van Leer, 1979)\n&amp;(rf) = max[fi\u2122k; min(2rf; 0,5 + 0,5rf; 2)]\t(25)\n3.\tSuperbee (Roe, 1986)\n&amp;(rf) = max[^\",fc ;min(1;2rf );min(2,rf)]\t(26)\n4.\tUltimate Quickest (Leonard, 1991)\n1\t1\t2\t2r\n$(rf ) = max j min(j(1 + rf) + 6(1 - rf)(1 - 2|C|); 1 - |C|; ]C\\J\t(27)\nwhere Cr here is the Courant number.\nThe consecutive gradients (rfactor) play an important role in the numerical diffusion of the masstransport equation. Several ways to estimate the rfactor have been proposed (Darwish and Moukalled, 2003; Casulli and Zanolli, 2005; Li and Huang, 2008; Kong et al., 2013; Zhang et al., 2015; Ye et al., 2018). The rfactor proposed by Ye et al. (2018) and Kong et al. (2013) gave the best results among all existing methods Ye et al. (2018). For the sake of simplicity, we adopted the rfactor proposed by Kong et al. (2013), which we found to be easier to implement, since the rfactor is calculated only based on the concentration of neighbor cells.\nThe rfactor is calculated only for horizontal and vertical water-leaving faces. For vertical faces (horizontal flux) the consecutive gradient is given by:\nn\nj,k\n/~in _ /\"in\nCi,k\tCr(i,jo),k\nC n\t_ C n\nCr(i,j),k Ci,k\n(28)\nwhere jo represents the opposite face from face j. For horizontal faces (vertical flux), the rfactor is given by:\nrjn,k-\nnn\nCi,k\tCi,k + 1\nCnk , - Cnk i,k-1 i,k\ni,k-1\n(29)\nn\nj,k+\nnn\nCi,k\tCi,k-1\nC n\t_ C n\nCi,k + 1\tCi,k\ni,k-1\n(30)\nr\n1\n2\nr\n1\n2\n3.2\tBilinear Interpolator\nFor a structure rectangular grid, the bilinear interpolator Casulli and Cheng (1992) uses 8 node points within a cell. The interpolated velocity component at tn can be found by:\nci-a,j-b,k-d = (1 - d (1 - a) [(1 - b) Un + b Un] + a [(1 - b) u4 + b un] + d (1 - a) (31) [(1 - b) un + bun] + a [(1 - b) u% + bun]\nwhere a, b and d are the distances of the particle position at the end of a sub-time step (xp,yp,zp) normalized by the position of the nodes in each direction, where u1 was set as the initial position (xu1,yu1,zu1). For the following example (figure 2), the normalized distances are set as:\n\\y\tyu1\\ d  \\zp\tzu5\\\n|yu1 - yu4|\t|zu1 - zu2|\nxp\txu1 \\ b\n\\xu1\txu2 \\\nWe used two different procedures to select the 8 node points used for bilinear interpolation of Fu and Fw at the end of the Lagrangian trajectory: Regarding Fu (figure 2.a), the interpolation process follows the steps:\nFig. 2: Example of the velocity points used in the bilinear interpolation for the a) vertical faces (left), example for the particle stopped in up position, and b) horizontal faces (right), with the particle stopped in the fourth-quadrant position.\n272\n273\n274\n275\n276\n277\n278\n279\n280\n281\n282\n283\n284\n285\n286\n287\n288\n289\n290\n291\n292\n293\n294\n295\n296\n297\n298\n299\n300\n301\n302\n303\n1.\t(1) For each time step, the particle starts at the barycenter of the j-th face at layer k, where the multi-step backward Euler stream line is defined by linear interpolations to find the particle position at the end of a sub-time step (ELM step-i);\n2.\t(2) For each sub-time step, the particle position is analyzed in relation to the initial position (up right, up left, down right or down left);\n3.\t(3) Eight node points are selected in the cell, with four points in layer k (the same layer where the particle stops), and four points in layer k\u00b1 1, depending on the particle position (up or down). The used point are always 4 faces barycenter and 4 edge center, except for the top and bottom cells, which uses 2 faces barycenter, 4 edge center and 2 nodes;\n4.\t(4) The node indices are defined anticlockwise, where the first node is the initial position of the particle at time n+1;\n5.\tEquation (31) is used to calculate the velocity component in the particle position in the sub-time step;\n6.\tSteps (1-5) are repeated until the end of the Lagrangian trajectory.\nFor Fw (figure 2.b), a similar procedure is adopted:\n1.\tFor each time step, the particle starts at the horizontal-face barycenter of the j-th element at layer (k + 1), where the multi-step backward Euler stream line is defined by linear interpolations to find the particle position at the end of a sub-time step (ELM step-i)\n2.\tFor each sub-time step, the particle position is analyzed in relation to the initial position (up or down and in the direction of one of the four quadrants)\n3.\tEight node points are selected in the cell, with four points in layer (k + |) (the same layer where the particle starts), and four points in layer k \u2014 1, if the particle goes down, or k + |, if the particle goes up. The used point are always 2 horizontal faces barycenter, 4 edge center and 2 nodes;\n4.\tThe node indices are defined anticlockwise, where the first node is the initial position of the particle at time n +1.\n5.\tEquation (31) is used to calculate the velocity component in the particle position in the sub-time step.\n6.\tSteps (1-5) are repeated until the end of the Lagrangian trajectory.\n3.3\tQuadratic Interpolator\nThe Quadratic Lagrangian interpolation was adapted from Hodges et al. (2000), who extended the 8-point Upwind bilinear stencil to a 27-grid point stencil using at least 8 computation cells. We proposed to use 27-node points inside a single computation cell, using the calculated velocities at the\n304\n305\n306\n307\n308\n309\n310\n311\n312\n313\n314\n315\n316\n317\n318\n319\n320\n321\n322\n323\n324\nFig. 3: Example of model node point velocities for the quadratic interpolation. This illustration shows 27 points inside a computation cell, using information from nodes (in black), edge centers (in white) and face barycenters (in gray). The subscripts (l,m) denote the position of the vertical line (black lines) to be interpolated in the first step. n denotes the bottom, middle or top of a computation cell. The orange lines represent the second interpolation step, and the blue line represents the final interpolation step to estimate velocity of the particle at time tn.\nface barycenters and interpolated velocities at the nodes, edge centers, face barycenters and element center (figure 3).\nThe quadratic interpolation is more generic and uses the same procedure for the horizontal and vertical faces. First, for each time step the particle starts at the face barycenter, where the backward stream line is defined in 10 sub-time steps by linear interpolation to find the departure position at time n (ELM step-i). Second, for each sub-time step the interpolation follows 3 major steps, illustrated in Figure 3, in order to determine the Lagrangian polynomial coefficients (e.g., Hodges et al., 2000). The Lagrangian polynomial coefficients are given by:\nl = n\na=0 a=3\nzp \u2014 z\nz\tzn\u00b1a\nzn\u00b13\tzn\u00b1a\n(33)\nwhere each interpolation has 3 L coefficients, one for each node used in the interpolation line. zp is the particle position after the backtrack, 3 is the analyzed node position in the Upwind direction, and a is the other two points, both assuming values of 1, 2, or 3.\nIn summary, the interpolation process follows these steps:\n1. (1) First, 9 z-direction interpolations are carried out (black lines in figure 3). Each vertical interpolation generates a velocity component in the horizontal plane that passes through the z-position of the particle, given by:\nUl+Y,m+^\tLl+y,m+'3U\u2018 l+l,m+^,n + Ll+y,m+^'U l+y,m+^,n+1 + Ll+y,m+^'U l+y,m+^,n+2\n(34)\nwhere each L is multiplied by the respective velocity node and 7 and 3 are the \u201cl\u201d and \u201cm\u201d displacement, respectively, to indicate which vertical line has been interpolated.\n1. (2) 3 x-direction interpolations are carried out (orange line), using the estimated velocities found in step (1), resulting in 3 new velocity components (white diamonds in figure 3), given by:\nU m+^\tLl,m+^Ul,m+^ + Ll + 1,m+^Ul + 1,m+^ + Ll+2,m+^Ul+2,m+^\n(35)\n1. One interpolation is made to compute the ^-direction displacement and find the final velocity for the particle at time tn\n325\n326\n327\n328\n329\n330\n331\n332\n333\n334\n335\n336\n337\n338\n339\n340\n341\n342\n343\n344\n345\n346\n347\n348\n349\n350\n351\n352\n353\n354\n355\n356\n357\n358\n359\n360\n361\n362\n363\n364\n365\n366\n367\n368\n369\n370\n371\n372\nui-a,j-b,k-d\tLj + Lj+1^j+l + Lj+2^j+2\t(36)\n1.\tA new departure velocity is used to define the particle position in the next sub-time step.\n2.\tSteps (1) to (4) are repeated until the end of the Lagrangian trajectory.\n4\tNumerical Experiments\nThe proposed numerical approaches were used in three consolidated benchmarks usually use to verification and validation of numerical models Dingemans (1994); Jankowski (1999); Casulli and Lang (2004); Yuan and Wu (2004); Fringer et al. (2005); Liu et al. (2017); Yin et al. (2017). The first two experiments tested the numerical diffusion produced by the hydrodynamic solution, and the last experiment evaluated the numerical diffusion of the coupled hydrodynamic and solute-transport solution. Each numerical experiment had a different purpose, as follows:\n1.\tStanding waves in a three-dimensional closed basin. This test case verifies the capability of the model to simulate 3D linear waves, including phase and amplitude representation (Yuan and Wu, 2004; Monteiro and Schettini, 2015; Liu et al., 2017). The motion in the basin is caused only by the initial condition of the free surface. When the roughness, viscosity and diffusivity coefficients are set equal to zero, the motion of the free surface should not lose energy. However, a wave damping is caused by the numerical diffusion of the hydrodynamic solution. We evaluated the differences in the numerical diffusion between the bilinear and quadratic interpolations, applied in ELM step-ii, as well as the numerical diffusion considering the no-advection scheme. The numerical diffusion was evaluated in terms of the cumulative wave damping, comparing the waves after 30 seconds of simulation. Regarding the case of the no-advection scheme, u*, v* and w* (equations 17 and 18) are set directly equal to the horizontal and vertical face velocities. The performance between methods was evaluated with a few metrics (RMSE, BIAS, Volume Error, KGE, NSE). We also compared the mass conservation of the computation domain for each time step, the cumulative mass conservation over the course of the simulation, and the mean computation time of one time-step simulation, using an Intel\u00ae Xenon\u00ae CPU-E5-1620 3.7 GHz computer with 32 GB of RAM memory in a Fortran based numerical model.\n2.\tThe wave propagation over a submerged bar was an experimental model idealized by Beji and Battjes (1993), and has been frequently used to validate numerical models (e.g., Beji and Battjes, 1994; Dingemans, 1994; Stelling and Zijlema, 2003; Zijlema and Stelling, 2005; Yuan and Wu, 2004; Cui et al., 2012; Yin et al., 2017). The experiment was used to evaluate the accuracy of representing an irregular wave pattern caused by physical changes at the bottom, by comparing the quadratic and bilinear interpolations used in ELM step-ii. The performance between methods was evaluated with a few metrics (RMSE, BIAS, Volume Error, KGE, NSE);\n3.\tThe gravity-wave test consisted of a finite-amplitude deep-water standing wave in an inviscid fluid in a non-equilibrium situation, where the baroclinic pressure makes a major contribution to promote flow. The experiment evaluated the numerical diffusion in terms of density interface expansion, analyzing the difference between the combined uses of the interpolation techniques used in ELM step-ii and different flux-limiter schemes applied in a solute-transport solution. This test case also evaluated the individual effect of each interpolation technique used in the hydrodynamic solution on the solute-transport solution, using different flux limiters. We also compared the mean computation time of one time-step simulation.\n4.1\t3D standing waves in a closed basin\nA closed cubic basin with 10 m of edge and the wave amplitude set to 0.1 m was used (figure 4). The spatial domain was discretized using a regular grid with 0.5 m resolution, resulting in 8,000 computation cells. The time step was 0.01 s and the total simulation time was 30 s. We evaluated the numerical diffusion produced by ELM, comparing the free-surface elevation at x = y = 0.25 m with the exact solution. We also compared the mass conservation between bilinear and quadratic interpolators, neglecting the convective terms.\nThe analytical solution of the free-surface water elevation is given by:\nFig. 4: The initial free-surface profile for a linear 3D standing wave oscillation in a closed basin. source: Yuan and Wu (2004)\nFig. 5: Comparisons of the free-surface elevation at x = y = 0.25 m. The solid black line is the analytical results, the dash-dot line is the quadratic interpolator results, the solid red line is the bilinear interpolator results, and the dashed black line is the results with no advection scheme\nTable 1: Metrics between the analytical and simulated results each method for 30 seconds of simulation\nMetrics\tQuadratic\tBilinear\tNo Advection\nRMSE (mm)\t21.86\t20.80\t20.70\nBIAS (mm)\t0.18\t0.52\t0.56\nError (%)\t27.22\t25.94\t25.79\nKGE\t0.87\t0.66\t0.64\nNSE\t0.90\t0.91\t0.91\n373\n374\n375\nwhere t is the time (the initial condition of the free surface may be obtained by setting t = 0), T is the wave period equal to 3.1 s, with the wave number kx = ky = n/L and the total wave number k = \\/kX + ky = 0.44^. The analytic solution for each velocity component is described as follows:\nAgkx cosh [kx(h + z)] w\tcosh (kxh)\nsin (kxx) cos (kyy) sin (wt)\n376\n377\nAgky cosh [ky (h + z)] w\tcosh (kyh)\nAgkx sinh [kx(h + z)] w\tcosh (kxh)\ncos (kxx) sin (kyy) sin (wt)\ncos (kXx) cos (kyy) sin (wt)\n(38)\n(39)\n(40)\nu\nv\nw\n378\n379\n380\n381\n382\n383\nwhere w is giving by:\nw = y/gK tanh (Kh)\t(41)\nThe results showed that the numerical diffusion can be reduced when a higher-order interpolation is used (figure 5). The numerical diffusion of the quadratic interpolator (measured in terms of the amplitude error compared to the analytical solution) is ca. 10 times smaller than the bilinear interpolator after 30 s of simulation. The bilinear scheme did not show a substantial improvement over the simulation neglecting the convective terms (the numerical diffusion was only 10% lower). The Quadratic results show best\nFig. 6: Comparisons of the mass conservation of computational domain over the simulation (top) and the cumulative mass conservation (bottom) over the simulation time for the tested methods: No Advection (red dashed line), Bilinear (blue doted line) and Quadratic (black solid line)\n384\n385\n386\n387\n388\n389\n390\n391\n392\n393\n394\n395\n396\n397\n398\n399\n400\n401\n402\n403\n404\n405\n406\n407\n408\n409\nperformance between methods (Bias 0.18 mm and KGE 0.87, see table 1), indicating best agreement with the analytical solution, despite similar RMSE and NSE to the other methods. All analyzed metrics shows that bilinear and no advection had similar performance. The phase representation showed good agreement with the analytical solution, showing a cumulative phase error of only 0.3 s at the end of the simulation, which is similar to previous studies (Yuan and Wu, 2004; Monteiro and Schettini, 2015). As expected, the simulation neglecting the convective terms had a shorter computation time (ca. 1.65 s) than the bilinear (ca. 2.23 s) and quadratic interpolations (ca. 2.37 s). The computation cost using a quadratic interpolation was slightly higher (ca. 6%) than the bilinear interpolation.\nThe mass conservation analysis showed a more conservative behavior for the quadratic simulation (Figure 6). The simulation neglecting the convective terms showed a substantial decreasing pattern after 5 s of simulation, differently from when the bilinear was used, in which the pattern appeared after 20 s. The quadratic interpolation showed a more conservative pattern than the bilinear interpolation.\n4.2\tWave propagation over a submerged bar\nA scheme of the experiment of the wave propagation over a submerged bar with an uneven bottom is seen in (Figure 6) (Beji and Battjes, 1993). At the upward slope of the bar, the shoaling wave becomes non-linear due to the generation of a bound higher harmonic. At the downward slope, the depth increases rather fast and these harmonics become free, resulting in an irregular pattern of waves (Dingemans, 1994). The numerical reproduction of this pattern has proven to be very demanding with respect to the accuracy of the computed dispersion frequency (Stelling and Zijlema, 2003).\nThe computation domain has a total length of 30 m, with an initial undisturbed water level of 0. 4 m, and was discretized using a regular grid of 0.025 m resolution. The time step was 0.005 s and the total simulation time was 39 s. At the left boundary, a sinusoidal wave condition, with period T = 2 s and amplitude A = 0.01 m, was imposed to represent the wave generator of the original experiment. At the right outflow boundary, the experimental absorbed beach was computationally represented by a 5-m sponge layer with a combination of a sponge layer technique (Park et al., 1999) and a Sommerfeld-type radiation boundary condition, applied to minimize wave reflection, given by:\nei\nif Xi > Xio\nif Xi &lt;0\n(42)\nFig. 7: Scheme of experimental bottom geometry and location of wave-level gauges. Source: Modified from Beji and Battjes (1993)\n410\n411\n412\n413\n414\n415\n416\n417\n418\n419\n420\n421\n422\n423\n424\n425\n426\n427\n428\n429\n430\n431\n432\n433\n434\n435\n436\n437\n438\n439\nwhere ei is the sponge layer coefficient, xio is the initial point, and li the total length. This term must be added in the right side of equation (1) and (2).\nThe methods performance was compared by a few metrics (RMSE, BIAS, Volume Error, KGE, NSE), and also through graphic visualization (Figure 8) of the wave pattern among the 6 stations. We evaluated the capability of the model to correctly represent the measured free-surface water elevation at between 33 and 39 s of simulation, comparing the bilinear and quadratic interpolation solutions with the experimental results for the \u201clow-amplitude waves\u201d (LW), generated by the shoaling process, and the \u201chigher-amplitude waves\u201d (HW).\nThe results indicated that the shoaling process on the upward slope was well described by both interpolation techniques, although the bilinear interpolation poorly represented the LW at station \u201cA\u201d. At the beginning of the downward slope, at station \u201cB\u201d, the bilinear simulation showed higher free-surface elevation, poorly representing the LW minimums (B at 34.7 and 36.7 s), which is physically incoherent with the measurements and simulations by others (e.g., Stelling and Zijlema, 2003), due to an over-increased velocity in the de-shoaling process. The quadratic simulation more accurately represented the de-shoaling process, although it did not accurately represent the maximum height of HW (35 and 37 s). Moreover, the simulation without advection scheme was not able to represent the de-shoaling process and was numerically unstable due to a larger over-increase in velocity at the same point as the bilinear interpolation over-increased it.\nThe bilinear overestimation of the free-surface level was propagated to the other stations. For the other four stations, the bilinear case better represented the HW maximum amplitudes than the quadratic simulation, but poorly represented the LW phase and shape (see \u201cD\u201d and \u201cF\u201d LW over the oscillation pattern for the bilinear interpolation).\nThe quadratic interpolator had the best performance among methods table 2. The Quadratic method better represented the amplitude and the wave patter for all stations (NSE between 0.47 and 0.94, and RMSE between 2.17 and 4.29 mm). The results had high Volume Error (between 23% and 83%), overestimating the free-surface level for most cases (except for some method at stations b, c, d and f), and with low performance in KGE parameter for most cases. In summary, the quadratic solution was better in interacting with uneven bottoms to represent complex non-linear wave simulations. Similar results to the quadratic interpolation solution were reported by Dingemans (1994); Chen (2003); Walters (2005); Cui et al. (2012); Monteiro and Schettini (2015).\n440\n441\n442\n4.3 Gravity Wave\nThis benchmark setup is use to evaluate the numerical diffusion of numerical models under sharp density gradients (Fringer et al., 2005). The equation that represents the initial density condition is:\n,\t. Ap\np(x,z) = \u2014\u2014 tanh\nkz - kZ + 2\n(43)\nBibl inear\nExperimental\n\u2014 -Bilinear\n(b)x = 14.5 m\n4\nH\u2014\tn\n0.02\n0.01\nI 0\nG\"\n-0.01\n33\t34\t35\t36\nTime (s)\no Experimental\tQuadratic\n(d)x= 17.3 m\nBilinear\n(f) x = 21.0 m\no Experimental\n36 Time ($)\n\u00b0 Experimental \u25a0 Quadratic\nFig. 8: Comparisons between experimental (circles) (dashed line) and Quadratic interpolator (solid line),\n\t\to\t\too\t\nn\to\t\to\t\to\n\t\t\t\t\t\n35\t36\nTime (s)\n\u2014 Quadratic\nand computed data with a Bilinear interpolator at 6 different level gauges.\nTable 2: Metrics between simulated and experimental results for the six stations for bilinear and quadratic results\nM\tStation a: x = 13.5 m\t\tStation d: Bilinear\tx = 17.3 m Quadratic\n\tBilinear\tQuadratic\t\t\nRMSE (mm)\t3.57\t2.17\t5.18\t4.29\nBIAS (mm)\t2.01\t0.18\t0.87\t-0.56\nError (%)\t47.52\t23.65\t83.78\t60.00\nKGE\t-0.90\t0.82\t0.23\t0.46\nNSE\t0.83\t0.94\t0.56\t0.70\n\tStation b: x\t= 14.5 m\tStation e:\tx = 19.0 m\nRMSE (mm)\t4.79\t4.25\t4.97\t3.81\nBIAS (mm)\t0.14\t-0.64\t2.49\t0.76\nError (%)\t64.77\t50.22\t52.79\t45.31\nKGE\t0.39\t0.35\t-6.12\t-1.18\nNSE\t0.33\t0.47\t0.60\t0.76\n\tStation c: x\t= 15.7 m\tStation f:\tx = 21.0 m\nRMSE (mm)\t4.66\t3.51\t4.04\t3.67\nBIAS (mm)\t-0.19\t-1.25\t1.34\t-0.28\nError (%)\t56.71\t39.63\t57.48\t43.84\nKGE\t0.65\t-1.07\t-4.92\t-0.26\nNSE\t0.67\t0.81\t0.69\t0.75\n443\twhere a = 0,99, k = n is the wave number, ka represent the fluid interface inclination, kS is the non\n444\tdimensional interface thickness, and kZ is the interface initial condition, giving by (Thorpe, 1968):\nkZ(x) = ka\n(ka)2\n6 1\ncos(kx) \u2014\n(ka)2\n8\ncos(3kx)\n(44)\n445\tThe constant values follow those used by Fringer et al. (2005). ka = 0.1, kS = 0.05, the density\n446\tdifference between the layers is = 0.03, with an analytical wave period of 9.43 s. In this test the\n447\n448\n449\n450\n451\n452\n453\n454\n455\n456\n457\nFig. 9: Comparisons of densitys profiles between the exact no-diffusive solution, and the No Advection (left), Bilinear (middle) and Quadratic (right) interpolators for several flux-limiter schemes, after two wave periods.\nbottom roughness and diffusion coefficients were both equal to zero. The spatial domain was alm x 1 m, discretized using a regular grid of 0.0125 m resolution, resulting in 6,400 computation cells. The time step was 0.0236 s and the total simulation time was two wave periods.\nBecause the vertical and horizontal diffusion were set equal to zero (i.e. pure advection transport), the initial and final shape of the gravity wave must be the same. We evaluated the numerical diffusion produced, neglecting the convective terms, and using both bilinear and quadratic interpolations in ELM step-ii combined with different flux-limiter schemes. The model outcomes (i.e. water density profiles) were compared with the exact solution. In order to evaluate the effects of different schemes and interpolation techniques on the numerical diffusion, we calculated the Terror norm of the density (Table 3), and compared the simulated vertical density profiles at x = 0.0 m and at x = 0.4 m with the exact solution.\nThe Lerror was calculated using the following expression:\nL =\nEN\tNP PT - Pi,k\\6Ai<k\nNk1 \\Pi,k\\SAi,\n(45)\n458\n459\n460\n461\n462\n463\n464\n465\n466\n467\nwhere p is the density from the exact solution, and the p2T is the simulated density after two wave periods, and &amp;Ai,k is the area of grid cell (i,k), which in our case is equal for all computation cells.\nThe comparison between the simulated density profiles and the exact solution is shown in Figure 9. Our findings indicated that the numerical diffusion produced by the hydrodynamic solution had a major influence on the total numerical diffusion.\nThe Upwind scheme showed a higher numerical diffusion than the high-resolution schemes, considering the two interpolation techniques in ELM step-ii (RMSE ca. 2.8 times bigger, table 4). For the high-resolution schemes, the numerical diffusion was reduced mainly when combined with the quadratic interpolation in ELM (RMSE ca. 3 times smaller). A similar numerical diffusion pattern was found when the convective terms were neglected or when a bilinear interpolation was used in ELM step-ii, with\nLayer \"k\"\tLayer \"k\"\nFig. 11: Comparisons between density profiles of the exact solution, and the No-Advection (top), Bilinear (middle) and Quadratic (bottom) interpolations for all flux-limiter schemes, after two wave periods, at x = 0.0 m (left) and x = 0.4 m (right).\nTable 3: Relative errors (%) for the different advection schemes after two wave periods, for the bilinear and quadratic interpolators\nFlux limiters\tL NoAdvc\tL Bilinear\tL Quadratic\tFringer et. al 2005\nUpWind\t5.10\t4.98\t4.98\t3.9\nMUSCL\t1.66\t1.23\t0.48\t0.6\nUltimate-Quickest\t1.40\t0.94\t0.46\t0.4\nSuperBee\t1.36\t0.88\t0.30\t0.4\nTable 4: Root Means Square errors (kg/m3) for the different flux limiter schemes after two wave periods, for the No advection scenario, bilinear and quadratic interpolators.\nFlux limiters\tRMSENoAdvc\tRMSE Bilinear\tRM SEQuadratic\nUpwind\t2.08\t1.97\t1.97\nMUSCL\t1.16\t0.72\t0.38\nUltimate-Quickest\t1.15\t0.69\t0.28\nSuperbee\t1.16\t0.70\t0.24\n468\n469\n470\n471\n472\n473\n474\na higher diffusive behavior in the middle of the spatial domain and an anti-diffusive pattern near the boundary domain for the higher-resolution schemes, as seen in Figure 11 and 9.\nThe Upwind scheme showed a higher relative error (Lerror norm ca. 5%) for all simulations. The results showed that the high-resolution methods substantially reduced the relative errors compared to the Upwind scheme, and the Superbee performed best among the higher-resolution schemes. The quadratic and Fringer et al. (2005) had similar results to the tested high-resolution methods, however the hydrodynamic discretization and its influence in the result was not discussed in Fringer et al. (2005)\n475\n476\n477\n478\n479\n480\n481\n482\n483\n484\n485\n486\n487\n488\n489\n490\n491\n492\n493\n494\n495\n496\n497\n498\n499\n500\n501\n502\n503\n504\n505\n506\n507\n508\n509\n510\n511\n512\n513\n514\n515\n516\n517\n518\n519\n520\n521\n522\n523\n524\n525\n526\n527\n528\n529\nwork. The \u00bferror indicated that the bilinear interpolation substantially improved the representation of the density profile compared to the simulations neglecting the convective terms. Regarding the computation cost, the higher-resolution methods had similar computation times for each time step, differing only with the interpolation technique, with 1.25, 1.51 and 1.62 s for the No-advection, Bilinear and Quadratic interpolations, respectively. The Upwind scheme had a shorter computation time, with 1.01, 1.15 and 1.61 s for the no-advection, bilinear and quadratic interpolations, respectively.\n5\tDiscussion\nThe numerical experiments in the hydrodynamic solution showed that the quadratic interpolation method, using 27 node points in a single computation cell, substantially reduced the numerical diffusion in the hydrodynamic solution, which had a positive effect on the solute-transport solution. This is the first study to verify and validate the quadratic interpolation method in ELM step-ii.\nThe results of the first experiment showed a good amplitude representation of the waves, with a satisfactory phase representation only 0.3 s slower than the analytical result. This was expected, since the phase representation is more related to the non-hydrostatic pressure and vertical momentum discretization (Yuan and Wu, 2004; Zijlema and Stelling, 2005). The second experiment successfully validated the proposed interpolation, which proved to be capable of representing complex wave problems. The bilinear interpolator applied at ELM step-ii had a numerical diffusion ca. 10 times higher than the quadratic interpolation. Moreover, the bilinear interpolation did not yield a substantial improvement in terms of numerical diffusion, compared with the simulations neglecting the convective terms. The quadratic interpolation also substantially improved the mass conservation over the course of the simulation, indicating that a high-resolution method can be applied to find mass-conservative solutions in free-surface simulations in complex wave problems, including shallow or deep waters. Higher numerical diffusion was also observed when the bilinear interpolator in ELM step-ii was used with different flux-limiter schemes in the mass-transport solution (Cheng et al., 1984), indicating that high-resolution schemes can be successfully used to attenuate the numerical diffusion for coupled hydrodynamic and transport solutions. The set of numerical experiments showed that the quadratic interpolation is a powerful and promising method to reduce numerical diffusion, with a slight increase in computation cost related to a bilinear interpolator (7.3% more), and also can be applied in 1D, 2D or 3D models. Other key factors related to the numerical solution are also responsible for the numerical diffusion, such as the fractional step error (Chen, 2003), caused by splitting the pressure solution into hydrostatic and non-hydrostatic modules, which was appropriately treated here following Casulli (1999); and the interpolation method used to define the stream line trajectory in ELM step-i (Staniforth and Cote, 1991).\nIn this study, we used different flux-limiter schemes to efficiently solve the mass-transport equation, which also proved to be an accurate alternative to reduce the numerical diffusion when coupled with a quadratic interpolation in ELM. The last numerical experiment showed that the Upwind scheme has serious numerical-diffusion problems (\u00bferror norm ca. 5%), and can be considered inappropriate for modeling stratified basins. The SuperBee flux limiter showed the best results among the high-resolution methods used in this study (\u00bferror norm ca. 0.3% with quadratic interpolation). Although further investigation is still needed to indicate the best flux limiter, the SuperBee has been used as a default in some models (e.g., Hodges et al., 2000; Casulli and Zanolli, 2005; Ye et al., 2018; Zhang et al., 2018), has proven to be capable of simulating stratified basins with or without sharp gradients, and has also been mass conservative. Despite the satisfactory results, the flux limiters used here are only non-linear second-order schemes (Fringer et al., 2005; Waterson and Deconinck, 2007). Numerical diffusion can be reduced even more by a different linear or non-linear higher-order discretization, but this usually requires a complex numerical solution, which is computationally expensive and also may be vulnerable to unphysical spatial oscillations (wiggles) under some circumstances (Leonard, 1991).The flux limiter is a simple approach that is easily implemented, especially when Kong's Cfactor is applied.\nThe results indicate that high-resolution schemes are suitable for reducing numerical diffusion, but combining their use in hydrodynamic and solute-transport solutions can improve the overall result even more. When the Upwind scheme was used, the differences between interpolation techniques were overcome by the higher Upwind numerical diffusion, although when flux-limiter methods were also used, the differences were clearer. The combined use of high-resolution methods shows that the interpolation technique in the hydrodynamic solution has a substantial effect on the mass-transport solution, and that, despite the improvement over Upwind, applying linear interpolators at the ELM step-ii still yields a relative error that is 2 to 3 times larger than with a non-linear interpolator, with a similar behavior to\n530\n531\n532\n533\n534\n535\n536\n537\n538\n539\n540\n541\n542\n543\n544\n545\n546\n547\n548\n549\n550\n551\n552\n553\n554\n555\n556\n557\n558\n559\n560\n561\n562\n563\n564\n565\n566\n567\n568\n569\n570\n571\n572\n573\n574\n575\n576\n577\n578\nthe no-advection solution, which may generate unsatisfactory results for the transport solution in cases of sharp stratification.\nA higher diffusive behavior in the middle of the spatial domain of gravity wave than in the nearby boundary domain was found for all simulations, as expected. Fringer et al. (2005) showed that in regions of the flowfield where the local Courant number is reduced (the middle), the interfacial diffusion is increased, which makes a zone that is sensitive to the velocity field. The results of the gravity-wave experiment were strongly influenced by the diffusion-over-time steps, since as the interface became more diffuse, the wave period and velocity field changed; that is, the use of a more diffusive method in a hydrodynamic solution may generate cumulative errors, leading to unsatisfactory results. The quadratic interpolation proved to better reduce the numerical diffusion in these critical areas, due to the less diffusive behavior in the hydrodynamic solution, and better predicted the sharp change of the velocity field in the middle region of the wave. Moreover, the results for the quadratic interpolation indicated that it performed better than the bilinear interpolation and similarly to the results reported by Fringer et al. (2005) in the transport solution. The bilinear interpolation, although it had a smaller relative error than the no-advection solution (1.5 times less), showed the same unsatisfactory diffusive behavior in the middle region.\nThe proposed combined use of the quadratic interpolation applied at ELM step-ii and the flux-limiter technique substantially reduced the numerical diffusion in solving mass-transport problems, showing that high-resolution methods must be implemented in the numerical solution to properly simulate more complex real situations. These methods can be easily implemented, as proposed here.\n6\tConclusion\nThe combined use of high-resolution methods (quadratic interpolation and flux-limiter functions) showed to be an suitable alternative to reduced numerical diffusion, and with low cost of implementation in relation to higher order discretizations.\nThe analyses in a coupled numerical model allowed to understand how the numerical diffusion at one solution may affect the other. The numeric diffusion at hydrodynamic solution promoted by low-resolution methods (low-order interpolation at ELM) may have a substantial impact on solute transport solution, even if a high-resolution method were applied at solute transport solution (Relative error and RMSE ca. 3 times bigger).\nWhen a low-order method are used in solute transport solution (Upwind scheme) the numerical diffusion differences between methods in hydrodynamic solution were overcome by the higher Upwind numerical diffusion. Thus, in order to accurately modeling stratified flows in real situations the combined use of high-resolution methods is mandatory.\nNumerical models that use low-resolution methods usually neglected the diffusive part of the transport equation (eq. 7) (diffusivity coefficients equal to zero), assuming the numerical diffusion as the physical diffusion, which may difficult the Model\u2019s calibration. The applied high-resolution methods allowed using the diffusivity coefficients as parameters to the model calibration. Therefore, we recommended the application of the implemented methods at real situations to evaluated the Model\u2019s performance in the representation of the temperature dynamic of stratified flows in deep lakes or reservoirs.\n7\tAcknowledgments\nWe are grateful to the Coordena\u00e7\u00e3o de Aperfei\u00e7oamento de Pessoal de Nivel Superior (CAPES: http://www.capes.gov.br) and to the Conselho Nacional de Desenvolvimento Cientifico e Tecnologico (CNPq: http://www.cnpq.br) of Brazil for the MSc. scholarships awarded to Augusto Hugo Farias da Cunha (grant number: 149819/2017-0) and Matheus Henrique Tavares (grant number: 1695302). We are also grateful to the project H2020 MSCA/RISE ODYSSEA (Grant Number 691053) e o INCT no 16-2014 ODISSEIA with fundings from CNPq/CAPES/FAP-DF. Last but not least we are grateful to the Global Lake Ecological Observatory Network (GLEON: www.gleon.org) for providing a venue and resources for lake science discussions. The English version of the manuscript was revised by Dr. Janet W. Reid (Trumansburg, NY, U.S.A.).\n579\n580\n581\n582\n583\n584\n585\n586\n587\n588\n589\n590\n591\n592\n593\n594\n595\n596\n597\n598\n599\n600\n601\n602\n603\n604\n605\n606\n607\n608\n609\n610\n611\n612\n613\n614\n615\n616\n617\n618\n619\n620\n621\n622\n623\n624\n625\n626\n627\n628\n629\n630\n631\n632\n633\n634\nReferences\nBeji S, Battjes J (1993) Experimental investigation of wave propagation over a bar. Coastal Engineering 19(1-2):151-162\nBeji S, Battjes J (1994) Numerical simulation of nonlinear wave propagation over a bar. Coastal Engineering 23(1-2):1-16\nBoso F, Bellin A, Dumbser M (2013) Numerical simulations of solute transport in highly heterogeneous formations: A comparison of alternative numerical schemes. Advances in water resources 52:178-189\nCasulli V (1990) Semi-implicit finite difference methods for the two-dimensional shallow water equations. Journal of Computational Physics 86(1):56-74\nCasulli V (1999) A semi-implicit finite difference method for non-hydrostatic, free-surface flows. International Journal for Numerical Methods in Fluids 30(4):425-440\nCasulli V, Cheng RT (1992) Semi-implicit finite difference methods for three-dimensional shallow water flow. International Journal for numerical methods in fluids 15(6):629-648\nCasulli V, Lang G (2004) Mathematical model untrim, validation document 1.0. the federal waterways engineering and research institute (baw), hamburg, germany\nCasulli V, Stelling GS (1998) Numerical simulation of 3d quasi-hydrostatic, free-surface flows. Journal of Hydraulic Engineering 124(7):678-686\nCasulli V, Zanolli P (2005) High resolution methods for multidimensional advection-diffusion problems in free-surface hydrodynamics. Ocean Modelling 10(1-2):137-151\nCavalcanti JR, Dumbser M, da Motta-Marques D, Junior CRF (2015) A conservative finite volume scheme with time-accurate local time stepping for scalar transport on unstructured grids. Advances in water resources 86:217-230\nCavalcanti JR, da Motta-Marques D, Fragoso Jr CR (2016) Process-based modeling of shallow lake metabolism: Spatio-temporal variability and relative importance of individual processes. Ecological modelling 323:28-40\nChandran K, Saha AK, Mohapatra PK (2019) Simulation of free surface flows with non-hydrostatic pressure distribution. Sadhana 44(1):20\nChen X (2003) A fully hydrodynamic model for three-dimensional, free-surface flows. International Journal for Numerical Methods in Fluids 42(9):929-952\nCheng RT, Casulli V, Milford SN (1984) Eulerian-lagrangian solution of the convection-dispersion equation in natural coordinates. Water Resources Research 20(7):944-952\nCox T, Runkel R (2008) Eulerian-lagrangian numerical scheme for simulating advection, dispersion, and transient storage in streams and a comparison of numerical methods. Journal of Environmental Engineering 134(12):996-1005\nCui H, Pietrzak J, Stelling G (2012) Improved efficiency of a non-hydrostatic, unstructured grid, finite volume model. Ocean Modelling 54:55-67\nDarwish M, Moukalled F (2003) Tvd schemes for unstructured grids. International Journal of heat and mass transfer 46(4):599-611\nDingemans M (1994) Comparison of computations with boussinesq-like models and laboratory measurements. memo in framework of MAST project (G8-M), Delft Hydraulics memo H1684 12\nFringer O, Armfield S, Street R (2005) Reducing numerical diffusion in interfacial gravity wave simulations. International Journal for Numerical Methods in Fluids 49(3):301-329\nHodges BR, Imberger J, Saggio A, Winters KB (2000) Modeling basin-scale internal waves in a stratified lake. Limnology and oceanography 45(7):1603-1620\nHodges BR, Laval B, Wadzuk BM (2006) Numerical error assessment and a temporal horizon for internal waves in a hydrostatic model. Ocean modelling 13(1):44-64\nJankowski JA (1999) A non-hydrostatic model for free surface flows. PhD thesis, Inst. fur Stromungsmechanik und Elektronisches Rechnen im Bauwesen\nJin KR, Ji ZG (2005) Application and validation of three-dimensional model in a shallow lake. Journal of waterway, port, coastal, and ocean engineering 131(5):213-225\nKong J, Xin P, Shen CJ, Song ZY, Li L (2013) A high-resolution method for the depth-integrated solute transport equation based on an unstructured mesh. Environmental modelling &amp; software 40:109-127\nLaval B, Imberger J, Hodges BR, Stocker R (2003) Modeling circulation in lakes: Spatial and temporal variations. Limnology and Oceanography 48(3):983-994\nLaval BE, Imberger J, Findikakis AN (2005) Dynamics of a large tropical lake: Lake maracaibo. Aquatic sciences 67(3):337-349\n635\n636\n637\n638\n639\n640\n641\n642\n643\n644\n645\n646\n647\n648\n649\n650\n651\n652\n653\n654\n655\n656\n657\n658\n659\n660\n661\n662\n663\n664\n665\n666\n667\n668\n669\n670\n671\n672\n673\n674\n675\n676\n677\n678\n679\n680\n681\n682\n683\n684\n685\n686\n687\n688\n689\n690\n691\n692\nLeonard B (1991) The ultimate conservative difference scheme applied to unsteady one-dimensional advection. Computer methods in applied mechanics and engineering 88(1):17-74\nLi Y, Huang P (2008) A coupled lattice boltzmann model for advection and anisotropic dispersion problem in shallow water. Advances in Water Resources 31(12):1719-1730\nLiu X, Ma Dg, Zhang Qh (2017) A higher-efficient non-hydrostatic finite volume model for strong three-dimensional free surface flows and sediment transport. China Ocean Engineering 31(6):736-746 Marshall J, Hill C, Perelman L, Adcroft A (1997) Hydrostatic, quasi-hydrostatic, and nonhydrostatic ocean modeling. Journal of Geophysical Research: Oceans 102(C3):5733-5752\nMonteiro LR, Schettini EBC (2015) Compara\u00e7\u00e3o entre a aproxima\u00e7ao hidrost\u00e1tica e a nao-hidrostatica na simulacao num\u00e1rica de escoamentos com superf\u00e1cie livre. Revista Brasileira de Recursos H\u00e1dricos 20:1051-1062\nMunar AM, Cavalcanti JR, Bravo JM, Fan FM, da Motta-Marques D, Fragoso Jr CR (2018) Coupling large-scale hydrological and hydrodynamic modeling: Toward a better comprehension of watershedshallow lake processes. Journal of hydrology 564:424-441\nNangia N, Griffith BE, Patankar NA, Bhalla APS (2019) A robust incompressible navier-stokes solver for high density ratio multiphase flows. arXiv preprint arXiv:180901008\nOliveira A, Baptista AM (1998) On the role of tracking on eulerian-lagrangian solutions of the transport equation. Advances in Water Resources 21:539-554\nPark JC, Kim MH, Miyata H (1999) Fully non-linear free-surface simulations by a 3d viscous numerical wave tank. International Journal for Numerical Methods in Fluids 29(6):685-703\nRoe PL (1986) Characteristic-based schemes for the euler equations. Annual review of fluid mechanics 18(1):337-365\nRuan F, McLaughlin D (1999) An investigation of eulerian-lagrangian methods for solving heterogeneous advection-dominated transport problems. Water Resources Research 35(8):2359-2373\nSoulignac F, Vincon-Leite B, Lemaire BJ, Martins JRS, Bonhomme C, Dubois P, Mezemate Y, Tchigu-irinskaia I, Schertzer D, Tassin B (2017) Performance assessment of a 3d hydrodynamic model using high temporal resolution measurements in a shallow urban lake. Environmental Modeling &amp; Assessment 22(4):309-322\nStaniforth A, Cote J (1991) Semi-lagrangian integration schemes for atmospheric models\u2014a review. Monthly weather review 119(9):2206-2223\nStelling G, Zijlema M (2003) An accurate and efficient finite-difference algorithm for non-hydrostatic free-surface flow with application to wave propagation. International Journal for Numerical Methods in Fluids 43(1):1-23\nSweby PK (1984) High resolution schemes using flux limiters for hyperbolic conservation laws. SIAM journal on numerical analysis 21(5):995-1011\nTang X, Chao J, Gong Y, Wang Y, Wilhelm SW, Gao G (2017) Spatiotemporal dynamics of bacterial community composition in large shallow eutrophic lake taihu: High overlap between free-living and particle-attached assemblages. Limnology and Oceanography 62(4):1366-1382\nThorpe S (1968) On standing internal gravity waves of finite amplitude. Journal of Fluid Mechanics 32(3):489-528\nValipour R, Bouffard D, Boegman L, Rao YR (2015) Near-inertial waves in lake erie. Limnology and Oceanography 60(5):1522-1535\nVan Leer B (1979) Towards the ultimate conservative difference scheme. v. a second-order sequel to godunov\u2019s method. Journal of computational Physics 32(1):101-136\nVilas MP, Marti CL, Adams MP, Oldham CE, Hipsey MR (2017) Invasive macrophytes control the spatial and temporal patterns of temperature and dissolved oxygen in a shallow lake: A proposed feedback mechanism of macrophyte loss. Frontiers in plant science 8:2097\nWadzuk BM, Hodges BR (2004) Hydrostatic and non-hydrostatic internal wave models. Tech. rep., Center for Research in Water Resources, University of Texas at Austin\nWalters RA (2005) A semi-implicit finite element model for non-hydrostatic (dispersive) surface waves. International Journal for Numerical Methods in Fluids 49(7):721-737\nWang H, Lacroix M (1997) Interpolation techniques applied to the eulerian-lagrangian solution of the convection-dispersion equation in natural coordinates. Computers &amp; Geosciences 23(6):677-688\nWaterson NP, Deconinck H (2007) Design principles for bounded higher-order convection schemes-a unified approach. Journal of Computational Physics 224(1):182-207\nYe R, Zhang C, Kong J, Jin G, Zhao H, Song Z, Li L (2018) A non-negative and high-resolution finite volume method for the depth-integrated solute transport equation using an unstructured triangular mesh. Environmental Fluid Mechanics pp 1-33\n693\n694\n695\n696\n697\n698\n699\n700\n701\n702\nYin J, Sun Jw, Wang Xg, Yu Yh, Sun Zc (2017) A hybrid finite-volume and finite difference scheme for depth-integrated non-hydrostatic model. China Ocean Engineering 31(3):261-271\nYuan H, Wu CH (2004) An implicit three-dimensional fully non-hydrostatic model for free-surface flows. International Journal for Numerical Methods in Fluids 46(7):709-733\nZhang J, Liang D, Liu H (2018) A hybrid hydrostatic and non-hydrostatic numerical model for shallow flow simulations. Estuarine, Coastal and Shelf Science 205:21-29\nZhang Z, Song Zy, Kong J, Hu D (2015) A new r-ratio formulation for tvd schemes for vertex-centered fvm on an unstructured mesh. International Journal for Numerical Methods in Fluids 81(12):741-764\nZijlema M, Stelling GS (2005) Further experiences with computing non-hydrostatic free-surface flows involving water waves. International journal for numerical methods in fluids 48(2):169-197\nConclus\u00e3o\nConclus\u00e3o\nO trabalho foi desenvolvido em grandes temas, passando pela implementa\u00e7\u00e3o e tratamento adequado do termo de press\u00e3o n\u00e3o-hidrost\u00e1tica, identifica\u00e7\u00e3o das rela\u00e7\u00f5es da difus\u00e3o num\u00e9rica gerada na solu\u00e7\u00e3o hidrodin\u00e2mica e de transporte e utiliza\u00e7\u00e3o de solu\u00e7\u00f5es num\u00e9ricas mais completas de alta resolu\u00e7\u00e3o para simula\u00e7\u00e3o de escoamentos estratificados em geometrias complexas.\nO algor\u00edtimo utilizado para implementa\u00e7\u00e3o da aproxima\u00e7\u00e3o n\u00e3o hidrost\u00e1tica no modelo IPH-ECO se mostrou capaz de simular adequadamente a celeridade e a dispers\u00e3o de frequ\u00eancia de ondas estacion\u00e1rias em condi\u00e7\u00e3o de \u00e1guas profundas (H>0.5m) utilizando uma resolu\u00e7\u00e3o vertical mais flex\u00edvel (10-layers ou mais) que um modelo n\u00e3o-hidrost\u00e1tico cl\u00e1ssico, sem tratamento na condi\u00e7\u00e3o de contorno (20-layers ou mais). Apesar da melhoria, o resultado ainda \u00e9 limitado pela discretiza\u00e7\u00e3o utilizada para equa\u00e7\u00e3o do momento vertical, enquadrando o m\u00e9todo como de baixo custo de implementa\u00e7\u00e3o e efici\u00eancia m\u00e9dia.\nA discretiza\u00e7\u00e3o utilizada tem uma depend\u00eancia do perfil vertical de velocidades, que \u00e9 menos preciso a medidas que a resolu\u00e7\u00e3o vertical utilizada na simula\u00e7\u00e3o aumenta. Isto faz com que o modelo precise de uma resolu\u00e7\u00e3o vertical apropriada para obter resultados satisfat\u00f3rios. Quando comparado com a abordagem cl\u00e1ssica de implementa\u00e7\u00e3o da aproxima\u00e7\u00e3o n\u00e3o-hidrost\u00e1tica, o m\u00e9todo proposta tem um ganho substancial, gerando resultados semelhantes utilizados uma resolu\u00e7\u00e3o vertical 2 vezes menor. Este resultado permite que modelos hidrodin\u00e2micos semelhantes melhorem sua solu\u00e7\u00e3o num\u00e9rica com um baixo custo de implementa\u00e7\u00e3o, aplicando um tratamento simples na condi\u00e7\u00e3o de contorno da press\u00e3o n\u00e3o-hidrost\u00e1tica na superf\u00edcie livre, consequentemente dmelhorando a performance em simula\u00e7\u00f5es hidrodin\u00e2micas n\u00e3o-hidrost\u00e1ticas.\nAinda quanto a melhoria do m\u00f3dulo hidrodin\u00e2mico, o interpolador bilinear aplicado ao passo-ii do ELM teve difus\u00e3o num\u00e9rica ca. 10 vezes maior que a interpola\u00e7\u00e3o quadr\u00e1tica. Al\u00e9m disso, a interpola\u00e7\u00e3o bilinear n\u00e3o apresentou melhoria substancial, em termos de difus\u00e3o num\u00e9rica, em compara\u00e7\u00e3o com a simula\u00e7\u00e3o sem esquema de advec\u00e7\u00e3o (negligenciando os termos convectivos). A interpola\u00e7\u00e3o quadr\u00e1tica diminuiu substancialmente a difus\u00e3o num\u00e9rica e melhorou a conserva\u00e7\u00e3o de massa sobre a simula\u00e7\u00e3o, indicando que m\u00e9todos de alta resolu\u00e7\u00e3o podem ser utilizados para alcan\u00e7ar solu\u00e7\u00f5es conservativas em simula\u00e7\u00f5es de superf\u00edcie livre.\nA maior difus\u00e3o num\u00e9rica tamb\u00e9m foi observada quando o interpolador bilinear, aplicado ao passo-ii do ELM, foi utilizado em conjunto com diferentes esquemas de Limitadores de Fluxo na solu\u00e7\u00e3o de transporte de massa (Cheng et al., 1984), indicando que esquemas de alta resolu\u00e7\u00e3o podem ser usados com sucesso para atenuar o difus\u00e3o para solu\u00e7\u00f5es de modelos acoplados hidrodin\u00e2micos e de transporte. O conjunto de experimentos num\u00e9ricos mostrou que\na interpola\u00e7\u00e3o quadr\u00e1tica \u00e9 um m\u00e9todo poderoso e promissor para reduzir a difus\u00e3o num\u00e9rica, com um ligeiro aumento do custo computacional em rela\u00e7\u00e3o a um interpolador bilinear (7.3 % a mais) e tamb\u00e9m pode ser aplicado em modelos 1D, 2D ou 3D.\nQuanto ao Tranporte de Soluto, a an\u00e1lise da difus\u00e3o num\u00e9rica gerada mostrou que o esquema UpWind tem s\u00e9rios problemas de difus\u00e3o num\u00e9rica (Lerror ca. 5%) e pode ser considerado um modelo n\u00e3o adequado para simula\u00e7\u00e3o de escoamentos estratificados. O Limitador de Fluxo SuperBee teve os melhores resultados dentre os m\u00e9todos de alta resolu\u00e7\u00e3o testados (Lerror ca. 0,3% e RMSE ca. 0,24 kg/m3 utilizando interpola\u00e7\u00e3o quadr\u00e1tica). Apesar de maiores an\u00e1lises ainda serem necess\u00e1rias para definir o melhor limitador de fluxo, o Superbee vem sido utilizado co sucesso por alguns modelos (e.g. Hodges et al., 2000; Casulli e Zanolli, 2005; Ye et al., 2018; Zhang et al., 2018), o que prova ser capaz de simular escoamentos estratificados.\nEsquemas de alta resolu\u00e7\u00e3o s\u00e3o adequados para reduzir a difus\u00e3o num\u00e9rica, mas o uso combinado deles em solu\u00e7\u00f5es Hidrodin\u00e2mica e de Transporte de Soluto pode melhorar ainda mais o resultado geral. Quando o esquema UpWind foi usado, as diferen\u00e7as entre as t\u00e9cnicas de interpola\u00e7\u00e3o foram mascaradas pela elevada difus\u00e3o num\u00e9rica do esquema, entretanto, quando m\u00e9todos de alta resolu\u00e7\u00e3o foram utilizados na solu\u00e7\u00e3o do transporte, as diferen\u00e7as foram claras (efici\u00eancia ca. 3 vezes maior). O uso combinado de m\u00e9todos de alta resolu\u00e7\u00e3o mostra que a t\u00e9cnica de interpola\u00e7\u00e3o na solu\u00e7\u00e3o hidrodin\u00e2mica tem um efeito substancial na solu\u00e7\u00e3o de transporte de massa, e que, apesar da melhoria dos Limitadores de Fluxo em rela\u00e7\u00e3o ao Upwind, a aplica\u00e7\u00e3o de interpola\u00e7\u00f5es lineares no passo-ii do ELM mostra um Erro relativo de 2 a 3 vezes maior que quando usado um interpolador n\u00e3o-linear, se aproximando do comportamento de uma solu\u00e7\u00e3o sem termos advectivos.\nA difus\u00e3o num\u00e9rica gerada por m\u00e9todos de baixa resolu\u00e7\u00e3o na solu\u00e7\u00e3o hidrodin\u00e2mica pode ter grande impacto na solu\u00e7\u00e3o do transporte, por tanto, para simular com maior precis\u00e3o situa\u00e7\u00f5es reais (din\u00e2mica de escoamentos estratificados em reservat\u00f3rios profundos) o uso combinado de m\u00e9todos de alta resolu\u00e7\u00e3o se mostrou necess\u00e1rio, ainda sendo de baixo custo de implementa\u00e7\u00e3o, em rela\u00e7\u00e3o \u00e0 discretiza\u00e7\u00f5es de alta ordem das equa\u00e7\u00f5es governantes, e com elevada efici\u00eancia na redu\u00e7\u00e3o da difus\u00e3o num\u00e9rica. Os resultados alcan\u00e7ados neste trabalho permitem que modelos mais difusivos, como o IPH-ECO (Fragoso Jr et al., 2009), passem a considerar a difus\u00e3o f\u00edsica real ao inv\u00e9s da difus\u00e3o num\u00e9rica em suas modelagens, e portanto utilizar o coeficiente de difus\u00e3o como um par\u00e2metro de calibra\u00e7\u00e3o do modelo.\nRefer\u00eancias\nBergh, J. e Berntsen, J. (2010). The surface boundary condition in nonhydrostatic ocean models. Ocean dynamics, 60(2):301-315.\nBohacek, J., Kharicha, A., Ludwig, A., Wu, M., Karimi-Sibaki, E., Paar, A., Brandner, M., Elizondo, L., e Trickl, T. (2018). A (non-) hydrostatic free-surface numerical model for two-layer flows. Applied Mathematics and Computation, 319:301-317.\nBoso, F., Bellin, A., e Dumbser, M. (2013). Numerical simulations of solute transport in highly heterogeneous formations: A comparison of alternative numerical schemes. Advances in water resources, 52:178-189.\nCasulli, V. (1999). A semi-implicit finite difference method for non-hydrostatic, free-surface flows. International Journal for Numerical Methods in Fluids, 30(4):425-440.\nCasulli, V. e Cattani, E. (1994). Stability, accuracy and efficiency of a semi-implicit method for three-dimensional shallow water flow. Computers &amp; Mathematics with Applications, 27(4):99-112.\nCasulli, V. e Cheng, R. T. (1992). Semi-implicit finite difference methods for three-dimensional shallow water flow. International Journal for numerical methods in fluids, 15(6):629-648.\nCasulli, V. e Lang, G. (2004). Mathematical model untrim, validation document 1.0. the federal waterways engineering and research institute (baw), hamburg, germany.\nCasulli, V. e Stelling, G. S. (1998). Numerical simulation of 3d quasi-hydrostatic, free-surface flows. Journal of Hydraulic Engineering, 124(7):678-686.\nCasulli, V. e Zanolli, P. (2005). High resolution methods for multidimensional advection-diffusion problems in free-surface hydrodynamics. Ocean Modelling, 10(1-2):137-151.\nCavalcanti, J. R., da Motta-Marques, D., e Fragoso Jr, C. R. (2016). Process-based modeling of shallow lake metabolism: Spatio-temporal variability and relative importance of individual processes. Ecological modelling, 323:28-40.\nCavalcanti, J. R., Dumbser, M., da Motta-Marques, D., e Junior, C. R. F. (2015). A conservative finite volume scheme with time-accurate local time stepping for scalar transport on unstructured grids. Advances in water resources, 86:217-230.\nCavalcanti, J. R. d. A. (2017). Din\u00e2mica espacial e temporal do metabolismo aqu\u00e1tico em sistemas subtropicais. PhD thesis, Universidade Federal do Rio Grande do Sul - Instituto de Pesquisas Hidr\u00e1ulicas.\nChandran, K., Saha, A. K., e Mohapatra, P. K. (2019). Simulation of free surface flows with non-hydrostatic pressure distribution. S\u00e3dhan\u00e3, 44(1):20.\nChapra, S. C., Canale, R. P., et al. (2010). Numerical methods for engineers. Boston: McGraw-Hill Higher Education,.\nChen, C., Beardsley, e et al (2011). An unstructured grid, finite-volume coastal ocean model fvcom user manual. SMAST/UMASSD, 11.\nChen, X. (2003). A fully hydrodynamic model for three-dimensional, free-surface flows. International Journal for Numerical Methods in Fluids, 42(9):929-952.\nCheng, R. T., Casulli, V., e Gartner, J. W. (1993). Tidal, residual, intertidal mudflat (trim) model and its applications to san francisco bay, california. Estuarine, Coastal and Shelf Science, 36(3):235-280.\nCheng, R. T., Casulli, V., e Milford, S. N. (1984). Eulerian-lagrangian solution of the convectiondispersion equation in natural coordinates. Water Resources Research, 20(7):944-952.\nCollischonn, W. e Marques, D. (2003). Desenvolvimento de um modelo hidrodin\u00e2mico de transporte de sedimentos e nutrientes para lagos. Em Anais do IX Congresso Brasileiro de Limnologia.\nCox, T. e Runkel, R. (2008). Eulerian-lagrangian numerical scheme for simulating advection, dispersion, and transient storage in streams and a comparison of numerical methods. Journal of Environmental Engineering, 134(12):996-1005.\nCui, H., Pietrzak, J., e Stelling, G. (2012). Improved efficiency of a non-hydrostatic, unstructured grid, finite volume model. Ocean Modelling, 54:55-67.\nda Paz, A. R., Villanueva, A. N., e Schettini, E. B. (2003). Wetting and drying algorithm to two-dimensional hydrodynamic modelling of wetlands. Em XXV CILAMCE (Iberian Latin American Congress on Computational Methods in Engineering).\nDarwish, M. e Moukalled, F. (2003). Tvd schemes for unstructured grids. International Journal of heat and mass transfer, 46(4):599-611.\nde Brito Jr, A. N., Fragoso Jr, C. R., e Larson, M. (2018). Tidal exchange in a choked coastal lagoon: A study of munda\u00fa lagoon in northeastern brazil. Regional Studies in Marine Science, 17:133-142.\nEscalante, C., de Luna, T. M., e Castro, M. (2018a). Non-hydrostatic pressure shallow flows: Gpu implementation using finite volume and finite difference scheme. Applied Mathematics and Computation, 338:631-659.\nEscalante, C., Fern\u00e1ndez-Nieto, E., de Luna, T. M., e Castro, M. (2018b). An efficient two-layer non-hydrostatic approach for dispersive water waves. Journal of Scientific Computing, pgs. 1-48.\nFragoso Jr, C. (2005). Simula\u00e7\u00f5es da din\u00e2mica de fitopl\u00e2ncton no sistema hidrol\u00f3gico do taim.\nFragoso Jr, C. R., Marques, D. M. M., Collischonn, W., Tucci, C. E., e van Nes, E. H. (2008). Modelling spatial heterogeneity of phytoplankton in lake mangueira, a large shallow subtropical lake in south brazil. Ecological modelling, 219(1-2):125-137.\nFragoso Jr, C. R., Marques, D. M. M., Ferreira, T. F., Janse, J. H., e van Nes, E. H. (2011). Potential effects of climate change and eutrophication on a large subtropical shallow lake. Environmental Modelling &amp; Software, 26(11):1337-1348.\nFragoso Jr, C. R., van Nes, E. H., Janse, J. H., e da Motta Marques, D. (2009). Iph-trim3d-pclake: A three-dimensional complex dynamic model for subtropical aquatic ecosystems. Environmental Modelling &amp; Software, 24(11):1347-1348.\nFringer, O., Armfield, S., e Street, R. (2005). Reducing numerical diffusion in interfacial gravity wave simulations. International Journal for Numerical Methods in Fluids, 49(3):301-329.\nFringer, O., Gerritsen, M., e Street, R. (2006). An unstructured-grid, finite-volume, nonhydrostatic, parallel coastal ocean simulator. Ocean Modelling, 14(3-4):139-173.\nGross, E. S., Casulli, V., Bonaventura, L., e Koseff, J. R. (1998). A semi-implicit method for vertical transport in multidimensional models. International Journal for Numerical Methods in Fluids, 28(1):157-186.\nHodges, B. R., Imberger, J., Saggio, A., e Winters, K. B. (2000). Modeling basin-scale internal waves in a stratified lake. Limnology and oceanography, 45(7):1603-1620.\nHodges, B. R., Laval, B., e Wadzuk, B. M. (2006). Numerical error assessment and a temporal horizon for internal waves in a hydrostatic model. Ocean modelling, 13(1):44-64.\nHorne, A. J. e Goldman, C. R. (1994). Limnology. McGraw-Hill New York.\nJankowski, J. A. (1999). A non-hydrostatic model for free surface flows. PhD thesis, Inst. f\u00fcr Stromungsmechanik und Elektronisches Rechnen im Bauwesen.\nJanse, J. H. (2005). Model studies on the eutrophication of shallow lakes and ditches. Wageningen Universiteit.\nKanarska, Y. e Maderich, V. (2003). A non-hydrostatic numerical model for calculating free-surface stratified flows. Ocean Dynamics, 53(3):176-185.\nKong, J., Xin, P., Shen, C.-J., Song, Z.-Y., e Li, L. (2013). A high-resolution method for the depth-integrated solute transport equation based on an unstructured mesh. Environmental modelling &amp; software, 40:109-127.\nLaval, B., Hodges, B. R., e Imberger, J. (2003a). Reducing numerical diffusion effects with pycnocline filter. Journal of Hydraulic Engineering, 129(3):215-224.\nLaval, B., Imberger, J., Hodges, B. R., e Stocker, R. (2003b). Modeling circulation in lakes: Spatial and temporal variations. Limnology and Oceanography, 48(3):983-994.\nLaval, B. E., Imberger, J., e Findikakis, A. N. (2005). Dynamics of a large tropical lake: Lake maracaibo. Aquatic sciences, 67(3):337-349.\nLi, Y. e Huang, P. (2008). A coupled lattice boltzmann model for advection and anisotropic dispersion problem in shallow water. Advances in Water Resources, 31(12):1719-1730.\nLiu, X., Ma, D.-g., e Zhang, Q.-h. (2017). A higher-efficient non-hydrostatic finite volume model for strong three-dimensional free surface flows and sediment transport. China Ocean Engineering, 31(6):736-746.\nLu, X., Dong, B., Mao, B., e Zhang, X. (2015). A two-dimensional depth-integrated nonhydrostatic numerical model for nearshore wave propagation. Ocean Modelling, 96:187-202.\nLv, B. (2014). A higher-efficient three-dimensional numerical model for small amplitude free surface flows. China Ocean Engineering, 28(5):617-628.\nMarshall, J., Hill, C., Perelman, L., e Adcroft, A. (1997). Hydrostatic, quasi-hydrostatic, and nonhydrostatic ocean modeling. Journal of Geophysical Research: Oceans, 102(C3):5733-5752.\nMonteiro, L. R. e Schettini, E. B. C. (2015). Compara\u00e7\u00e3o entre a aproxima\u00e7\u00e3o hidrost\u00e1tica e a n\u00e3o-hidrost\u00e1tica na simula\u00e7\u00e3o num\u00e9rica de escoamentos com superf\u00edcie livre. Revista Brasileira de Recursos H\u00eddricos, 20:1051-1062.\nMunar, A. M., Cavalcanti, J. R., Bravo, J. M., Fan, F. M., da Motta-Marques, D., e Fragoso Jr, C. R. (2018). Coupling large-scale hydrological and hydrodynamic modeling: Toward a better comprehension of watershed-shallow lake processes. Journal of hydrology, 564:424-441.\nNamin, M., Lin, B., e Falconer, R. (2001). An implicit numerical algorithm for solving nonhydrostatic free-surface flow problems. International Journal for Numerical Methods in Fluids, 35(3):341-356.\nNangia, N., Griffith, B. E., Patankar, N. A., e Bhalla, A. P. S. (2019). A robust incompressible navier-stokes solver for high density ratio multiphase flows. arXiv preprint arXiv:1809.01008.\nOliveira, A. e Baptista, A. M. (1998). On the role of tracking on eulerian-lagrangian solutions of the transport equation. Advances in Water Resources, 21:539-554.\nPereira, F., Fragoso Jr, C., Uvo, C., Collischonn, W., e Motta-Marques, D. (2013). Assessment of numerical schemes for solving the advection-diffusion equation on unstructured grids: case study of the gua\u00edba river, brazil. Nonlinear Processes in Geophysics, 20(6):1113-1125.\nPereira, F. F. (2010). Modelo hidrodin\u00e2mico e de transporte bidimensional de grade n\u00e3o estruturada para lagos rasos. Master\u2019s thesis, Universidade Federal do Rio Grande do Sul.\nRoe, P. L. (1986). Characteristic-based schemes for the euler equations. Annual review of fluid mechanics, 18(1):337-365.\nRosman, P. C. C. et al. (2015). Refer\u00eancia t\u00e9cnica do sisbahia. Escola Polit\u00e9cnica e da \u00c1rea de Engenharia.\nRuan, F. e McLaughlin, D. (1999). An investigation of eulerian-lagrangian methods for solving heterogeneous advection-dominated transport problems. Water Resources Research, 35(8):2359-2373.\nSoulignac, F., Vin\u00e7on-Leite, B., Lemaire, B. J., Martins, J. R. S., Bonhomme, C., Dubois, P., Mezemate, Y., Tchiguirinskaia, I., Schertzer, D., e Tassin, B. (2017). Performance assessment of a 3d hydrodynamic model using high temporal resolution measurements in a shallow urban lake. Environmental Modeling &amp; Assessment, 22(4):309-322.\nStaniforth, A. e C\u00f4t\u00e9, J. (1991). Semi-lagrangian integration schemes for atmospheric models\u2014a review. Monthly weather review, 119(9):2206-2223.\nStelling, G. e Zijlema, M. (2003). An accurate and efficient finite-difference algorithm for nonhydrostatic free-surface flow with application to wave propagation. International Journal for Numerical Methods in Fluids, 43(1):1\u201423.\nSweby, P. K. (1984). High resolution schemes using flux limiters for hyperbolic conservation laws. SIAM journal on numerical analysis, 21(5):995-1011.\nTamamidis, P. e Assanis, D. N. (1993). Evaluation of various high-order-accuracy schemes with and without flux limiters. International Journal for Numerical Methods in Fluids, 16(10):931-948.\nValipour, R., Bouffard, D., Boegman, L., e Rao, Y. R. (2015). Near-inertial waves in lake erie. Limnology and Oceanography, 60(5):1522-1535.\nVilas, M. P., Marti, C. L., Adams, M. P., Oldham, C. E., e Hipsey, M. R. (2017). Invasive macrophytes control the spatial and temporal patterns of temperature and dissolved oxygen in a shallow lake: A proposed feedback mechanism of macrophyte loss. Frontiers in plant science, 8:2097.\nWadzuk, B. M. e Hodges, B. R. (2004). Hydrostatic and non-hydrostatic internal wave models. Technical report, Center for Research in Water Resources, University of Texas at Austin.\nWalters, R. A. (2005). A semi-implicit finite element model for non-hydrostatic (dispersive) surface waves. International Journal for Numerical Methods in Fluids, 49(7):721-737.\nWang, H. e Lacroix, M. (1997). Interpolation techniques applied to the eulerian-lagrangian solution of the convection-dispersion equation in natural coordinates. Computers &amp; Geosciences, 23(6):677-688.\nWang, K., Jin, S., e Liu, G. (2009). Numerical modelling of free-surface flows with bottom and surface-layer pressure treatment. Journal of Hydrodynamics, 21(3):352-359.\nWaterson, N. P. e Deconinck, H. (2007). Design principles for bounded higher-order convection schemes-a unified approach. Journal of Computational Physics, 224(1):182-207.\nYe, R., Zhang, C., Kong, J., Jin, G., Zhao, H., Song, Z., e Li, L. (2018). A non-negative and high-resolution finite volume method for the depth-integrated solute transport equation using an unstructured triangular mesh. Environmental Fluid Mechanics, pgs. 1-33.\nYuan, H. e Wu, C. H. (2004). An implicit three-dimensional fully non-hydrostatic model for free-surface flows. International Journal for Numerical Methods in Fluids, 46(7):709-733.\nZhang, J., Liang, D., e Liu, H. (2018). A hybrid hydrostatic and non-hydrostatic numerical model for shallow flow simulations. Estuarine, Coastal and Shelf Science, 205:21-29.\nZhang, Y. e Baptista, A. M. (2008). Selfe: a semi-implicit eulerian-lagrangian finite-element model for cross-scale ocean circulation. Ocean modelling, 21(3-4):71-96.\nZhang, Z., Song, Z.-y., Kong, J., e Hu, D. (2015). A new r-ratio formulation for tvd schemes for vertex-centered fvm on an unstructured mesh. International Journal for Numerical Methods in Fluids, 81(12):741-764.\nZijlema, M. e Stelling, G. S. (2005). Further experiences with computing non-hydrostatic free-surface flows involving water waves. International journal for numerical methods in fluids, 48(2):169-197."}]}}}