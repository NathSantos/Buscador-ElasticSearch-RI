{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.14333"}, {"@name": "filename", "#text": "2063_301871.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE FEDERAL DE SANTA CATARINA\nDEPARTAMENTO DE INFORM\u00c1TICA E ESTAT\u00cdSTICA\n\nAndr\u00e9 Ferreira Bem Silva\n\nCARACTERIZA\u00c7\u00c3O DO ESPA\u00c7O POROSO EM ROCHAS POR\nESFERAS M\u00c1XIMAS EXATAS\n\nFlorian\u00f3polis\n\n2012\n\n\n\n\n\nAndr\u00e9 Ferreira Bem Silva\n\nCARACTERIZA\u00c7\u00c3O DO ESPA\u00c7O POROSO EM ROCHAS POR\nESFERAS M\u00c1XIMAS EXATAS\n\nCaracteriza\u00e7\u00e3o do Espa\u00e7o Poroso em Ro-\nchas por Esferas M\u00e1ximas Exatas subme-\ntido ao Programa de P\u00f3s-gradua\u00e7\u00e3o em Ci-\n\u00eancia da Computa\u00e7\u00e3o para a obten\u00e7\u00e3o do\nGrau de Mestre em Ci\u00eancias da Computa-\n\u00e7\u00e3o.\nOrientador: Eros Comunello, Prof. Dr. rer.\nnat.\n\nFlorian\u00f3polis\n\n2012\n\n\n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \nCataloga\u00e7\u00e3o na fonte pela Biblioteca Universit\u00e1ria \n\nda \n\nUniversidade Federal de Santa Catarina \n\n \n\n \n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n         \n\n. \n\n \n\n \n\n         \n\n \n\n S586c  Silva, Andr\u00e9 Ferreira Bem \n\n           Caracteriza\u00e7\u00e3o do espa\u00e7o poroso em rochas por esferas \n\n        m\u00e1ximas exatas [disserta\u00e7\u00e3o] / Andr\u00e9 Ferreira Bem Silva ;  \n\n        orientador, Eros Comunello. - Florian\u00f3polis, SC, 2012.  \n\n           153 p.: il., grafs. \n\n \n\n           Disserta\u00e7\u00e3o (mestrado) - Universidade Federal de Santa \n\n        Catarina, Centro Tecnol\u00f3gico. Programa de P\u00f3s-Gradua\u00e7\u00e3o em  \n\n        Ci\u00eancia da Computa\u00e7\u00e3o. \n\n \n\n           Inclui refer\u00eancias \n\n \n\n           1. Inform\u00e1tica. 2. Ci\u00eancia da computa\u00e7\u00e3o. 3. Escoamento. \n\n        4. Rochas. 5. Porosidade. I. Comunello, Eros. II. Universidade \n\n        Federal de Santa Catarina. Programa de P\u00f3s-Gradua\u00e7\u00e3o em  \n\n        Ci\u00eancia da Computa\u00e7\u00e3o. III. T\u00edtulo.  \n\n                                                CDU 681 \n\n \n\n \n\n \n\n                          \n\n \n\n \n\n \n\n \n\n \n\n \n\n\n\n\n\n\n\nAos meus pais, Laura e Pedro. Aos meus av\u00f3s,\nOsvaldo e Ana e \u00e0 Samanta, com todo meu\namor.\n\n\n\n\n\nAGRADECIMENTOS\n\nAo Prof. Eros Comunello pela orienta\u00e7\u00e3o,\nAo Prof. Aldo von Wangenheim pelo espa\u00e7o f\u00edsico e equipamentos,\nAos meus colegas de laborat\u00f3rio. Sem exce\u00e7\u00e3o,\nAos meus familiares,\nAos meus amigos,\nA todos que contribuiram direta ou indiretamente para esse trabalho.\n\n\n\n\n\n\"Education is a system of imposed ignorance\"\n\"A educa\u00e7\u00e3o \u00e9 um sistema de ignor\u00e2ncia im-\nposta\"(tradu\u00e7\u00e3o livre)\n\nNoam Chomsky\n\n\n\n\n\nRESUMO\n\nNeste trabalho, uma modifica\u00e7\u00e3o ao algoritmo de esferas m\u00e1ximas (MB) \u00e9\nproposto. Essa abordagem recebe o nome de esferas m\u00e1ximas exatas (EMB),\npor utilizar os raios exatos ao inv\u00e9s de duas aproxima\u00e7\u00f5es. Tal mudan\u00e7a, traz\nconsequ\u00eancias para o resultado final, definindo de forma mais detalhada a es-\ntrutura interna do espa\u00e7o poroso, gerando cinquenta porcento mais poros e\ngargantas. Dessa forma, a rede gerada de modo exato \u00e9 comparada a rede ori-\nginal, em caracter\u00edsticas b\u00e1sicas e nas simula\u00e7\u00f5es de escoamento monof\u00e1sico,\nobtendo-se resultados bem correlacionados e em mesma escala de grandeza\npara ambas, apesar de diferentes. Muitas otimiza\u00e7\u00f5es para paraleliza\u00e7\u00e3o e\ndados comprimidos s\u00e3o propostas e o algoritmo exato, mesmo processando\nmais esferas, \u00e9 de duas a seis mais r\u00e1pido para todos os casos de estudo.\nPalavras-chave: volume, microtomografia, espa\u00e7o poroso, escoamento, rede\nde poros, rocha\n\n\n\n\n\nABSTRACT\n\nIn this work a maximum balls (MB) modification is presented. This novel\napproach receives the name of exact maximum balls (EMB) because it uses\none exact radius instead of two approximations. Therefore, there are conse-\nquences to the generated pore network which is found out to define the pore\nspace with at least fifty porcent more detail, that is, pores and throats. That\nway, the exact pore network is compared with the original and it is discovered\nthat there is a strict correlation between their results and that these are always\nof the same magnitude, although different. Also, a lot of optimizations to\nprocess compressed data and to allow data parallelization are shown and the\nEMB pore network extraction is, in every test case, consistently faster than\nMB. The obtained speedup was from two up to six times.\nKeywords: volumn, microtomography, pore space, transport prediction, pore\nnetwork, rock\n\n\n\n\n\nSUM\u00c1RIO\n\nLista de Tabelas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\nLista de Figuras . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\nLista de Algoritmos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25\n1 INTRODU\u00c7\u00c3O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27\n1.1 CONTEXTO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27\n1.2 OBJETIVOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n1.2.1 Objetivo geral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n1.2.2 Objetivos espec\u00edficos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n1.3 A RESPEITO DA LEITURA DESTE TRABALHO . . . . . . . . . . . . 31\n2 REVIS\u00c3O SISTEM\u00c1TICA DA LITERATURA . . . . . . . . . . . . . . . 33\n2.1 IDENTIFICA\u00c7\u00c3O DA PESQUISA E SELE\u00c7\u00c3O DOS ESTUDOS 33\n2.1.1 Crit\u00e9rios de inclus\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33\n2.1.2 Crit\u00e9rios de exclus\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34\n2.2 ESTADO DA ARTE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34\n2.2.1 M\u00e9todos do eixo m\u00e9dio . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34\n2.2.2 M\u00e9todo baseado em processos . . . . . . . . . . . . . . . . . . . . . . . . . . . 35\n2.2.3 Esferas m\u00e1ximas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37\n2.3 M\u00c9TODO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38\n3 PROCESSAMENTO E AN\u00c1LISE DE DADOS MICROTOMO-\n\nGR\u00c1FICOS DE ROCHA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41\n3.1 AQUISI\u00c7\u00c3O DE DADOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41\n3.1.1 Porosimetria por inje\u00e7\u00e3o de merc\u00fario . . . . . . . . . . . . . . . . . . . . . 41\n3.1.2 Microtomografia computadorizada . . . . . . . . . . . . . . . . . . . . . . . 42\n3.2 BINARIZA\u00c7\u00c3O DO VOLUME DE DADOS . . . . . . . . . . . . . . . . . . 43\n3.3 FILTRAGEM E TRATAMENTO . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45\n3.4 COMPRESS\u00c3O RLE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47\n3.5 VOLUMES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48\n3.6 CONCLUS\u00c3O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51\n4 EXTRA\u00c7\u00c3O DE REDE DE POROS POR ESFERAS M\u00c1XI-\n\nMAS EXATAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53\n4.1 BUSCA DE ESFERAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53\n4.1.1 Algoritmo de inflar esferas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53\n4.1.2 Mapa de dist\u00e2ncias exatas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55\n4.2 REMO\u00c7\u00c3O DE ESFERAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60\n4.3 AGLOMERA\u00c7\u00c3O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64\n4.4 GERA\u00c7\u00c3O DA RP . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67\n4.5 ESTRUTURAS COMPRIMIDAS . . . . . . . . . . . . . . . . . . . . . . . . . . . 70\n\n\n\n4.6 CONCLUS\u00c3O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71\n5 PROPRIEDADES DA REDE E C\u00c1LCULOS DE TRANSPORTE 75\n5.1 ESTUDO DE CASO S1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75\n5.1.1 N\u00famero de coordena\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78\n5.1.2 Poros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79\n5.1.3 Gargantas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81\n5.2 ESTUDO DE CASO C1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84\n5.2.1 N\u00famero de coordena\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86\n5.2.2 Poros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87\n5.2.3 Gargantas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88\n5.3 DEMAIS ARENITOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92\n5.4 ROCHA C2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97\n5.5 ESCOAMENTO MONOF\u00c1SICO E PROPRIEDADES PETRO-\n\nF\u00cdSICAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99\n5.5.1 Fator de forma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99\n5.5.2 Permeabilidade absoluta . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102\n5.5.3 Fator de forma\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104\n5.5.4 Resultados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105\n5.6 CONCLUS\u00c3O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110\n6 CONCLUS\u00c3O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115\n6.1 REFLEX\u00d5ES CONCLUSIVAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115\n6.2 TRABALHOS FUTUROS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118\n6.2.1 Otimiza\u00e7\u00f5es em cpu e gpu . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118\nAglomera\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118\nBusca de esferas vizinhas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119\nEstruturas comprimidas em gpu . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120\nBusca de esferas em gpu . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120\nUtiliza\u00e7\u00e3o de ponto fixo ao inv\u00e9s de ponto flutuante . . . . . . . . . . . . . . . . . 121\n6.2.2 Valida\u00e7\u00e3o com outras t\u00e9cnicas e estudo de vari\u00e1veis de en-\n\ntrada e sa\u00edda . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 121\n6.2.3 Tratamento de dados multiescalares e volumes grandes . . . . . 122\n6.3 RECONHECIMENTOS E AGRADECIMENTOS . . . . . . . . . . . . . . 122\nRefer\u00eancias Bibliogr\u00e1ficas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125\n7 AP\u00caNDICE A: FORMATO RBV E RESULTADOS . . . . . . . . . . . 131\n7.1 FORMATO RBV . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131\n7.2 VALORES PARA DEMAIS VOLUMES . . . . . . . . . . . . . . . . . . . . . 131\n7.2.1 N\u00fameros de coordena\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139\n7.3 ESCOAMENTO MONOF\u00c1SICO NAS REDES EMB E MB NOS\n\nEIXOS Y E Z . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 145\n7.4 PAR\u00c2METROS PARA O SIMULADOR . . . . . . . . . . . . . . . . . . . . . 145\n\n\n\nLISTA DE TABELAS\n\nTabela 2 Imagens de se\u00e7\u00f5es transversais dos volumes de entrada, com\nsuas dimens\u00f5es, porosidades e resolu\u00e7\u00f5es. A fase poro est\u00e1 em branco . . 49\nTabela 3 Caracter\u00edsticas da RP, no EMB e MB, para o volume S1 . . . . . 76\nTabela 4 Caracter\u00edsticas da RP, no EMB e MB, para o volume C1 . . . . . 85\nTabela 5 Caracter\u00edsticas da RP, no EMB e MB, para o volume S2 . . . . . 93\nTabela 6 Caracter\u00edsticas da RP, no EMB e MB, para o volume S3 . . . . . 94\nTabela 7 Caracter\u00edsticas da RP, no EMB e MB, para o volume S5 . . . . . 95\nTabela 8 Caracter\u00edsticas da RP, no EMB e MB, para o volume A1 . . . . . 96\nTabela 9 Caracter\u00edsticas da RP, no EMB e MB, para o volume C2 . . . . . 98\nTabela 10 Tabela de valores dos fatores de forma\u00e7\u00e3o e permeabilidades\npara o EMB. Fator de expans\u00e3o 0.5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107\nTabela 11 Tabela de valores dos fatores de forma\u00e7\u00e3o e permeabilidades\npara o EMB. Fator de expans\u00e3o 0.6 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107\nTabela 12 Tabela de valores dos fatores de forma\u00e7\u00e3o e permeabilidades\npara o EMB. Fator de expans\u00e3o 0.7 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108\nTabela 13 Tabela de valores dos fatores de forma\u00e7\u00e3o e permeabilidades\npara o EMB. Fator de expans\u00e3o 0.8 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108\nTabela 14 Tabela de valores dos fatores de forma\u00e7\u00e3o e permeabilidades\npara o MB . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109\nTabela 15 Tabela de valores dos fatores de forma\u00e7\u00e3o e permeabilidades\npara o MB. Valores obtidos diretamente da tese de Dong e Blunt (2007) . 109\nTabela 16 Tabela que apresenta a raz\u00e3o do resultado obtido pela simula-\n\u00e7\u00e3o na rede EMB pela rede MB para diferentes fatores de expans\u00e3o, no\neixo x . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110\nTabela 17 Tabela que apresenta a raz\u00e3o do resultado obtido pela simula-\n\u00e7\u00e3o na rede EMB em rela\u00e7\u00e3o aos resultados do trabalho de Dong e Blunt\n(2007) para diferentes fatores de expans\u00e3o, no eixo x . . . . . . . . . . . . . . . . . . 112\nTabela 18 Caracter\u00edsticas da RP, no EMB e MB, para o volume S4 . . . . . 132\nTabela 19 Caracter\u00edsticas da RP, no EMB e MB, para o volume S6 . . . . . 133\nTabela 20 Caracter\u00edsticas da RP, no EMB e MB, para o volume S7 . . . . . 134\nTabela 21 Caracter\u00edsticas da RP, no EMB e MB, para o volume S8 . . . . . 135\nTabela 22 Caracter\u00edsticas da RP, no EMB e MB, para o volume S9 . . . . . 136\nTabela 23 Caracter\u00edsticas da RP, no EMB e MB, para o volume S10 . . . . 137\nTabela 24 Caracter\u00edsticas da RP, no EMB e MB, para o volume S11 . . . . 138\n\n\n\nTabela 25 Tabela que apresenta a raz\u00e3o do resultado obtido pela simula-\n\u00e7\u00e3o na rede EMB em rela\u00e7\u00e3o aos resultados do trabalho de Dong e Blunt\n(2007) para diferentes fatores de expans\u00e3o, no eixo y . . . . . . . . . . . . . . . . . . 146\nTabela 26 Tabela que apresenta a raz\u00e3o do resultado obtido pela simula-\n\u00e7\u00e3o na rede EMB em rela\u00e7\u00e3o aos resultados do trabalho de Dong e Blunt\n(2007) para diferentes fatores de expans\u00e3o, no eixo z . . . . . . . . . . . . . . . . . . 147\n\n\n\nLISTA DE FIGURAS\n\nFigura 1 Exemplo de parte do espa\u00e7o poroso (em branco) em uma amos-\ntra microtomogr\u00e1fica de rocha carbon\u00e1tica de dimens\u00f5es 400x400x100 . . 28\nFigura 2 Rede de poros para uma amostra de rocha carbon\u00e1tica. Observa-\nse a irregularidade nos tamanhos e conex\u00f5es dos poros e gargantas resul-\ntantes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29\nFigura 3 Fun\u00e7\u00e3o de transfer\u00eancia utilizada para visualiza\u00e7\u00e3o da rede . . 30\nFigura 4 Figura que demonstra os resultados para extra\u00e7\u00e3o do eixo m\u00e9-\ndio em uma amostra de rocha. Schena e Favretto (2006) . . . . . . . . . . . . . . . 35\nFigura 5 Corte transversal de uma amostra de arenito do Mar do Norte,\ndo trabalho de Oren e Bakke (2002) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36\nFigura 6 Exemplo de configura\u00e7\u00e3o para descoberta de poros e gargan-\ntas, por Hu Dong (DONG; BLUNT, 2007) . . . . . . . . . . . . . . . . . . . . . . . . . . . 37\nFigura 7 Vis\u00e3o geral do algoritmo de esferas m\u00e1ximas . . . . . . . . . . . . . . . 38\nFigura 8 Todas as esferas, n\u00e3o contidas em nenhuma outra, que repre-\nsentam a dist\u00e2ncia at\u00e9 o voxel n\u00e3o poro mais pr\u00f3ximo. . . . . . . . . . . . . . . . . 39\nFigura 9 Configura\u00e7\u00e3o de porosimetria por inje\u00e7\u00e3o de merc\u00fario e uma\namostra real . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42\nFigura 10 Obten\u00e7\u00e3o das imagens e pipeline de processamento t\u00edpico para\namostras de rocha, por Fernandes, Appoloni e Fernandes (2009) . . . . . . . 43\nFigura 11 Amostra de arenito e os histogramas referentes . . . . . . . . . . . . . 46\nFigura 12 Imagem binarizada, onde i representa as linha e j as colunas . 47\nFigura 13 Espa\u00e7o absoluto, em MB, dos RBVs e RAWs . . . . . . . . . . . . . . . 50\nFigura 14 Espa\u00e7o , em porcentagem, dos RBVs e RAWs . . . . . . . . . . . . . . 51\nFigura 15 Configura\u00e7\u00f5es de intersec\u00e7\u00e3o com pixel rocha em cinza e raios\nem v\u00e1rias cores. O esquema de Dong e Blunt (2007) (direita) e o esquema\ncom esferas de tamanho exato (esquerda) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54\nFigura 16 Tempo total de execu\u00e7\u00e3o, em segundos, discriminando as eta-\npas do algoritmo de Dong e Blunt (2007), para v\u00e1rias entradas . . . . . . . . . 55\nFigura 17 Esferas quadr\u00e1ticas ap\u00f3s a aplica\u00e7\u00e3o da transforma\u00e7\u00e3o 1D, da\nesquerda para direita (figura esq.) e da direita para esquerda (figura dir.) 57\nFigura 18 Exemplo de transforma\u00e7\u00e3o do algoritmo de Saito, para uma\nitera\u00e7\u00e3o do algoritmo sobre o elemento destacado na coluna G, cujo re-\nsultado modifica H . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58\nFigura 19 Tempos de execu\u00e7\u00e3o para busca de esferas por mapa de dis-\n\n\n\nt\u00e2ncias, single thread (ST) e multithread (MT), em segundos, na m\u00e1quina\nM1, para os dados de entrada em vers\u00f5es comprimidas ou n\u00e3o . . . . . . . . . 59\nFigura 20 Ganho de performance do mapa de dist\u00e2ncias exatas em rela-\n\u00e7\u00e3o ao algoritmo de inflar esferas de Dong. Escala logar\u00edtmica . . . . . . . . . 60\nFigura 21 Tempos de execu\u00e7\u00e3o para a remo\u00e7\u00e3o de esferas contidas em\noutras maiores . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62\nFigura 22 Exemplo de caso de remo\u00e7\u00e3o de esferas . . . . . . . . . . . . . . . . . . . . 62\nFigura 23 Esferas encontradas na etapa de busca e o n\u00famero de esferas\nremovidas, por EMB e por MB . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63\nFigura 24 Volume de exemplo e as \u00e1rvores hier\u00e1rquicas geradas para os\ndois poros com uma garganta G1 ligando-os . . . . . . . . . . . . . . . . . . . . . . . . . 64\nFigura 25 Expans\u00e3o de gargantas, conforme proposto por Dong. Nesse\ncaso, o fator E f de expans\u00e3o \u00e9 de 70% . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66\nFigura 26 N\u00famero de poros e gargantas gerados pelo MB e pelo EMB . . 67\nFigura 27 Porcentagem de voxels inv\u00e1lidos, em rela\u00e7\u00e3o ao total de vo-\nxels, no final do processo para ambos os algoritmos de esferas m\u00e1ximas . 68\nFigura 28 N\u00famero de inlets e outlets gerados pelo MB e pelo EMB . . . . 68\nFigura 29 Defini\u00e7\u00e3o de inlets (esq.) e outlets (dir.), conforme proposto\npor Al-Kharusi e Blunt (2007) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70\nFigura 30 Tempo levado, em cada etapa do EMB, para volumes diversos.\nO Fator E f de expans\u00e3o \u00e9 50% . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72\nFigura 31 Tempo levado, em cada etapa do EMB, para volumes diversos.\nO Fator E f de expans\u00e3o \u00e9 80% . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73\nFigura 32 Rede gerada pelo EMB para o volume S1 . . . . . . . . . . . . . . . . . . 76\nFigura 33 Frequ\u00eancia do n\u00famero de coordena\u00e7\u00e3o nos algoritmos EMB e\nMB para o volume S1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78\nFigura 34 Distribui\u00e7\u00e3o de raios de poros para ambos algoritmos. Fatores\nde expans\u00e3o 50%, 60%, 70% e 80% para o EMB . . . . . . . . . . . . . . . . . . . . . 79\nFigura 35 Frequ\u00eancia dos volumes dos poros para as redes EMB e MB do\nvolume S1. A \u00faltima faixa engloba todos os valores maiores que quatro\nvezes a m\u00e9dia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80\nFigura 36 Distribui\u00e7\u00e3o de comprimentos das gargantas para ambos algo-\nritmos no S1. Fatores de expans\u00e3o 50%, 60%, 70% e 80% para o EMB . 81\nFigura 37 Distribui\u00e7\u00e3o de raio das gargantas para ambos algoritmos no\nS1. Fatores de expans\u00e3o 50%, 60%, 70% e 80% para o EMB . . . . . . . . . . 82\nFigura 38 Raz\u00e3o do comprimento da garganta pelo raio da mesma no\nvolume S1. A \u00faltima faixa s\u00e3o os valores maiores que quatro vezes a\nm\u00e9dia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83\n\n\n\nFigura 39 Frequ\u00eancia dos volumes das gargantas para o volume S1. A\n\u00faltima faixa s\u00e3o os valores maiores que quatro vezes a m\u00e9dia . . . . . . . . . . 84\nFigura 40 Rede gerada para o volume C1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85\nFigura 41 Frequ\u00eancia do n\u00famero de coordena\u00e7\u00e3o nos algoritmos EMB e\nMB para o volume C1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87\nFigura 42 Distribui\u00e7\u00e3o de raios de poros para ambos algoritmos no vo-\nlume C1. Fatores de expans\u00e3o 50%, 60%, 70% e 80% para o EMB . . . . . 88\nFigura 43 Frequ\u00eancia dos volumes dos poros para as redes EMB e MB do\nvolume C1. A \u00faltima faixa engloba todos os valores maiores que quatro\nvezes a m\u00e9dia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89\nFigura 44 Distribui\u00e7\u00e3o de comprimentos das gargantas no volume C1.\nFatores de expans\u00e3o 50%, 60%, 70% e 80% para o EMB . . . . . . . . . . . . . . 89\nFigura 45 Distribui\u00e7\u00e3o de comprimentos das gargantas para ambos algo-\nritmos. Fatores de expans\u00e3o 50%, 60%, 70% e 80% para o EMB . . . . . . . 90\nFigura 46 Raz\u00e3o do comprimento da garganta pelo raio da mesma no\nvolume C1. A \u00faltima faixa s\u00e3o os valores maiores que quatro vezes a\nm\u00e9dia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91\nFigura 47 Frequ\u00eancia dos volumes das gargantas para o volume C1. A\n\u00faltima faixa s\u00e3o os valores maiores que quatro vezes a m\u00e9dia . . . . . . . . . . 91\nFigura 48 Rede gerada para o volume S2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93\nFigura 49 Rede gerada para o volume S3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 94\nFigura 50 Rede gerada para o volume S5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95\nFigura 51 Rede gerada para o volume A1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96\nFigura 52 Rede gerada para o volume C2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98\nFigura 53 Determina\u00e7\u00e3o da geometria mais pr\u00f3xima a um determinado\nobjeto a partir do fator de forma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100\nFigura 54 Frequ\u00eancia do fator de forma para o volume S1 . . . . . . . . . . . . . 101\nFigura 55 Frequ\u00eancia do fator de forma para o volume C1 . . . . . . . . . . . . . 101\nFigura 56 Configura\u00e7\u00e3o poro-garganta-poro onde a regi\u00e3o cinza \u00e9 a re-\ngi\u00e3o de c\u00e1lculo do fluxo Qp,i j . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103\nFigura 57 Fatores de forma Fx para as redes EMB e MB . . . . . . . . . . . . . . 111\nFigura 58 Permeabilidades Kx, em mD, para as redes EMB e MB . . . . . . 112\nFigura 59 Permeabilidades Kx, em mD, para as redes EMB e o resultado\noriginal de Dong e Blunt (2007) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113\nFigura 60 Fatores de forma Fx para as redes EMB e o resultado original\nde Dong e Blunt (2007) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114\n\n\n\nFigura 61 Valores em milhares de esferas processadas por segundo, du-\nrante a execu\u00e7\u00e3o do EMB e MB no eixo x. A linha pontilhada \u00e9 a m\u00e9dia\nglobal . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116\nFigura 62 Rede gerada para o volume S4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 132\nFigura 63 Rede gerada para o volume S6 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 133\nFigura 64 Rede gerada para o volume S7 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 134\nFigura 65 Rede gerada para o volume S8 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135\nFigura 66 Rede gerada para o volume S9 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136\nFigura 67 Rede gerada para o volume S10 . . . . . . . . . . . . . . . . . . . . . . . . . . . 137\nFigura 68 Rede gerada para o volume S11 . . . . . . . . . . . . . . . . . . . . . . . . . . . 138\nFigura 69 Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume C2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139\nFigura 70 Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 140\nFigura 71 Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 140\nFigura 72 Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141\nFigura 73 Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141\nFigura 74 Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S6 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142\nFigura 75 Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S7 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142\nFigura 76 Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S8 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143\nFigura 77 Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S9 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143\nFigura 78 Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S10 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144\nFigura 79 Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144\nFigura 80 Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume A1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 145\nFigura 81 Permeabilidades Ky, em mD, para as redes EMB e o resultado\noriginal de Dong e Blunt (2007) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 146\nFigura 82 Fatores de forma Fy para as redes EMB e o resultado original\n\n\n\nde Dong e Blunt (2007) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147\nFigura 83 Permeabilidades Kz, em mD, para as redes EMB e o resultado\noriginal de Dong e Blunt (2007) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148\nFigura 84 Fatores de forma Fz para as redes EMB e o resultado original\nde Dong e Blunt (2007) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148\n\n\n\n\n\n25\n\nLISTA DE ALGORITMOS\n\n1 Obten\u00e7\u00e3o do valor de thresholding autom\u00e1tico . . . . . . . . . . . . . . 44\n2 Transforma\u00e7\u00e3o 1D no sentido frente, conforme proposta por\n\nLotufo, Falcao e Zampirolli (2000) . . . . . . . . . . . . . . . . . . . . . . . . 56\n3 Execu\u00e7\u00e3o no sentido frente do algoritmo de Saito para a coluna G 59\n4 Descobre se S0 est\u00e1 contido em S1 . . . . . . . . . . . . . . . . . . . . . . . . 61\n5 Obt\u00e9m todos os valores de uma linha do volume, iterando por\n\nsegmento . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71\n\n\n\n26\n\n\n\n27\n\n1 INTRODU\u00c7\u00c3O\n\nNesse cap\u00edtulo ficam esclarecidos os conceitos e trabalhos importan-\ntes, sobre os quais esse trabalho \u00e9 constru\u00eddo. Tamb\u00e9m, especificam-se as\nmetas almejadas e os resultados obtidos por outros trabalhos da literatura que\npartilham de objetivos m\u00fatuos com esse trabalho.\n\n1.1 CONTEXTO\n\nExiste uma grande quantidade de hidrocarbonetos os quais est\u00e3o con-\ntidos rochas carbon\u00e1ticas (JONES, 1984). O espa\u00e7o poroso de rochas car-\nbon\u00e1ticas \u00e9 altamente irregular devido a sua forma\u00e7\u00e3o complexa (ROBERT;\nCORDELL, 1992). A morfologia, a geometria e a topologia dos do espa\u00e7o\nporoso tem grande influ\u00eancia sobre as caracter\u00edsticas gerais da rocha em ques-\nt\u00e3o e o comportamento de fluidos e gases dentro dessa (LUCIA, 1999). Um\nexemplo de amostra carbon\u00e1tica, binarizada, com espa\u00e7o poroso representado\npela cor branca e a rocha em preto, pode ser visto na figura 1.\n\nA ind\u00fastria petrol\u00edfera tem evolu\u00eddo bastante no sentido de recupe-\nrar hidrocarbonetos contidos nas reservas carbon\u00e1ticas e existe uma demanda\npara t\u00e9cnicas e representa\u00e7\u00f5es computacionais as quais representem de forma\npreditiva a complexa din\u00e2mica de fluidos computacionais e gases no espa\u00e7o\nporoso. Valores como permeabilidade absoluta, permeabilidade relativa e\npress\u00e3o capilar s\u00e3o importantes de serem avaliados quanto \u00e0 extra\u00e7\u00e3o de hi-\ndrocarbonetos, principalmente com rela\u00e7\u00e3o a recupera\u00e7\u00e3o aprimorada de pe-\ntr\u00f3leo.\n\n\u00c9 poss\u00edvel extrair, dos dados microsc\u00f3picos brutos, o comportamento\nde um determinado fluido invadindo e escoando pelo espa\u00e7o poroso. Uma\nmaneira, \u00e9 utilizar-se de um m\u00e9todo computacional que represente as inte-\nra\u00e7\u00f5es de conectividade macrosc\u00f3picas e o escoamento do fluido diretamente\nno volume bruto. O m\u00e9todo de Lattice-Boltzmann (LBM) (CHEN; DOOLEN,\n1998), \u00e9 capaz de descobrir tal din\u00e2mica para um dado volume. Contudo, esse\nm\u00e9todo \u00e9 computacionalmente custoso, mesmo para simula\u00e7\u00f5es com somente\numa fase. Se levado em considera\u00e7\u00e3o simula\u00e7\u00f5es multi-fases, o m\u00e9todo torna-\nse proibitivamente lento, podendo levar semanas para obter-se um resultado,\nmesmo para volumes pequenos . Assim, faz-se necess\u00e1rio t\u00e9cnicas diferentes\npara obter-se resultados em tempo h\u00e1bil (FAN et al., 2004; BERNASCHI et\nal., 2010).\n\n\n\n28\n\nFigura 1: Exemplo de parte do espa\u00e7o poroso (em branco) em uma amostra\nmicrotomogr\u00e1fica de rocha carbon\u00e1tica de dimens\u00f5es 400x400x100\n\nNo trabalho de Fan et al. (2004), descreve-se para o LBM um tempo\npor passo de 310 milisegundos. Como o passo utilizado \u00e9 tipicamente um\nmil\u00e9simo, isso significa que para simular um segundo tem-se um tempo de\n310 segundos. Considera-se que uma simula\u00e7\u00e3o interessante necessite de ao\nmenos algumas dezenas de segundos, tem-se que o tempo para faz\u00ea-la cresce\nbastante. Assim, tem-se a necessidade de t\u00e9cnicas alternativas para previs\u00e3o\ne simula\u00e7\u00e3o de escoamento em tempo h\u00e1bil.\n\nFatt (1956) criou um modelo de representa\u00e7\u00e3o dos reticulados forma-\ndos pelas rela\u00e7\u00f5es poro-garganta-poro em duas dimens\u00f5es. Pelo fato do mo-\ndelo representar somente cortes transversais, a conectividade final era inferior\nao encontrada em amostras reais. Ainda assim, o autor era capaz de fazer c\u00e1l-\nculos de escoamento e de distribui\u00e7\u00e3o de poros e gargantas sobre a rede.\n\nChatzis e Dullien (1977) ampliaram o modelo para tr\u00eas dimensi\u00f5es.\nEles tentavam aproximar a estrutura interna do arenito com reticulados re-\ngulares. Tal abordagem foi tamb\u00e9m utilizada mais tarde para a cria\u00e7\u00e3o de\narenito por m\u00e9todos estoc\u00e1sticos para representa\u00e7\u00e3o de arenitos (BAKKE;\nOREN, 1997; LERDAHL; OREN; BAKKE, 2000).\n\nRochas homog\u00eaneas possuem estruturas conhecidamente regulares e\nportanto represent\u00e1-los por m\u00e9todos estoc\u00e1sticos tem bons resultados. O\nmesmo n\u00e3o acontece para as rochas heterog\u00eaneas, pois sua irregularidade e\nvariabilidade s\u00e3o bem maiores quando comparadas as primeiras. As rochas\n\n\n\n29\n\nFigura 2: Rede de poros para uma amostra de rocha carbon\u00e1tica. Observa-se\na irregularidade nos tamanhos e conex\u00f5es dos poros e gargantas resultantes\n\ncarbon\u00e1ticas heterog\u00eaneas, por exemplo, s\u00e3o fruto de complexos processos\ndiagen\u00e9ticos qu\u00edmicos e biol\u00f3gicos, os quais as transformam. A modelagem\ndessas \u00e9 mais complexa e m\u00e9todos recentes atuam direto sobre o volume bi-\nnarizado, na tentativa de extrarir uma rede de poros e gargantas, onde regi\u00f5es\nde ac\u00famulo de fluido s\u00e3o identificadas como sendo poro e regi\u00f5es estreitas en-\ntre dois poros s\u00e3o definidos como sendo gargantas (AL-KHARUSI; BLUNT,\n2007; DONG; BLUNT, 2007; SCHENA; FAVRETTO, 2006).\n\nExistem algoritmos os quais geram uma rede de poros a partir de um\ndado volume tomogr\u00e1fico de rocha. Entre eles est\u00e3o o m\u00e9todo baseado em\nprocessos (PB) (OREN; BAKKE, 2002), extra\u00e7\u00e3o r\u00e1pida de rede (SCHENA;\nFAVRETTO, 2006) e esferas m\u00e1ximas (MB) (DONG; BLUNT, 2007; AL-\nKHARUSI; BLUNT, 2007). A partir desses, pode-se obter uma representa-\n\u00e7\u00e3o a partir do volume inicial que represente o volume de rocha, sendo que o\nalgoritmo esferas m\u00e1ximas foi criado especificamente para representar rochas\ncarbon\u00e1ticas, de dif\u00edcil representa\u00e7\u00e3o por m\u00e9todos estoc\u00e1sticos anteriores. A\nfigura 2, demonstra a rede final gerada pelo algoritmo para uma amostra de ro-\ncha carbon\u00e1tica. A complexidade e irregularidade \u00e9 evidenciada pela grande\npopula\u00e7\u00e3o de poros e gargantas pequenos e mal conectados em contraste com\npoucos desses elementos grandes e bem conectados. Na figura 3, apresenta-\nse a fun\u00e7\u00e3o de transfer\u00eancia utilizada na visualiza\u00e7\u00e3o da rede. Apesar de n\u00e3o\ntradicional, essa fun\u00e7\u00e3o foi usada por apresentar de equivalente poros peque-\n\n\n\n30\n\nFigura 3: Fun\u00e7\u00e3o de transfer\u00eancia utilizada para visualiza\u00e7\u00e3o da rede\n\nnos e grandes. Portanto, \u00e9 poss\u00edvel ver de maneira n\u00edtida poros pequenos e\ngrandes, pelo fato de apresentarem cores bastante diferentes e constratantes.\nA fun\u00e7\u00e3o de transfer\u00eancia \u00e9 edit\u00e1vel e tal visualiza\u00e7\u00e3o pode ser facilmente\nadaptada.\n\nRecentes avan\u00e7os em microtomografia tornam as t\u00e9cnicas de extra\u00e7\u00e3o\nr\u00e1pida melhores e mais pr\u00f3ximas dos valores amostrados por t\u00e9cnicas labora-\ntoriais. A resolu\u00e7\u00e3o da imagem influencia diretamente na qualidade da rede\nextra\u00edda, e portanto na precis\u00e3o da simula\u00e7\u00e3o (DONG; BLUNT, 2007; AL-\nKHARUSI; BLUNT, 2007; SCHENA; FAVRETTO; PILLER, 2008). Tam-\nb\u00e9m, a utiliza\u00e7\u00e3o de m\u00faltiplas resolu\u00e7\u00f5es e escalas diferentes tem constitu\u00eddo\num desafio na caracteriza\u00e7\u00e3o do espa\u00e7o poroso.\n\n1.2 OBJETIVOS\n\n1.2.1 Objetivo geral\n\nO objetivo geral desse trabalho \u00e9 propor uma metodologia automati-\nzada para extrair-se a rede de poros e gargantas de uma amostra microtomo-\ngr\u00e1fica binarizada de rocha, seja ela carbon\u00e1tica ou aren\u00edtica, homog\u00eanea ou\nheterog\u00eanea. Esse m\u00e9todo deve ser paraleliz\u00e1vel e utilizar de t\u00e9cnicas para\ndiminuir o consumo de mem\u00f3ria. A rede gerada deve representar o espa\u00e7o\nporoso e portanto deve possuir uma precis\u00e3o aceit\u00e1vel com rela\u00e7\u00e3o a dados j\u00e1\nconhecidos das amostras utilizadas.\n\n1.2.2 Objetivos espec\u00edficos\n\n1. Implementar um algoritmo de extra\u00e7\u00e3o de redes de poros e gargantas\nque seja capaz de extrair uma rede de poros e gargantas a partir de uma\namostra de rocha, inclusive amostras heterog\u00eaneas.\n\n\n\n31\n\n2. Detectar pontos pass\u00edveis de otimiza\u00e7\u00e3o computacional e de mem\u00f3ria\nno algoritmo original, incluindo os gargalos para ambos. Tamb\u00e9m, de-\ntectar poss\u00edveis falhas do algoritmo original e modific\u00e1-lo conforme\nnecess\u00e1rio.\n\n3. Implementar as otimiza\u00e7\u00f5es de mem\u00f3ria e de tempo computacional cu-\njos impactos sejam maiores no resultado final. Os pontos principais\nser\u00e3o os gargalos identificados anteriormente.\n\n4. Detectar pontos paraleliz\u00e1veis nas etapas do algoritmo. Implementar as\nparaleliza\u00e7\u00f5es e verificar o ganho de performance em rela\u00e7\u00e3o a vers\u00e3o\noriginal. A etapa s\u00f3 \u00e9 considerada r\u00e1pida se t\u00e3o eficiente quanto ao\nmenos uma outra t\u00e9cnica capaz de executar o mesmo volume.\n\n5. Comparar o tempo de execu\u00e7\u00e3o e os resultados obtidos da vers\u00e3o mo-\ndificada dos algoritmos com os resultados da implementa\u00e7\u00e3o original,\ncomentando as diferen\u00e7as entre eles.\n\n6. Utilizar a rede extra\u00edda para calcular distribui\u00e7\u00f5es de raio e compri-\nmento para poros e gargantas. Tamb\u00e9m, devem ser extra\u00eddos resulta-\ndos de fator de forma\u00e7\u00e3o e permeabilidade absoluta para caracterizar-\nse o escoamento monof\u00e1sico pela rede. Por fim, devem ser verificados\nposs\u00edveis diferen\u00e7as dos resultados obtidos com rela\u00e7\u00e3o aos originais,\ntra\u00e7ando paralelos. S\u00f3 considera-se como aceit\u00e1veis os valores que es-\ntiverem na mesma escala de grandeza.\n\n1.3 A RESPEITO DA LEITURA DESTE TRABALHO\n\nNesta se\u00e7\u00e3o s\u00e3o definidas as conven\u00e7\u00f5es de nomes e de nota\u00e7\u00f5es uti-\nlizadas nesse trabalho. Por exemplo, os termos cpu e gpu s\u00e3o utilizados na\nforma min\u00fascula e sem it\u00e1lico porque visa-se facilitar a leitura do texto e di-\nminuir a aten\u00e7\u00e3o para termos t\u00e3o utilizados. Os termos cluster, grid, threshold\ne engine s\u00e3o mais utilizados que suas tradu\u00e7\u00f5es para a l\u00edngua portuguesa,\nagregado, grade, limiar e motor, respectivamente e, portanto, s\u00e3o usados em\nseu lugar. Tamb\u00e9m, os termos thread, hardware e multithread que n\u00e3o pos-\nsuem equivalentes s\u00e3o utilizados, sem \u00eanfase alguma.\n\nAlgumas abrevia\u00e7\u00f5es ser\u00e3o feitas, pois alguns termos s\u00e3o bastante re-\ncorrentes no texto:\n\n\n\n32\n\nTermo Abrevia\u00e7\u00e3o\nRede de poros e gargantas RP\n\nEsferas m\u00e1ximas MB\n\nEsferas m\u00e1ximas exatas EMB\n\nM\u00e9todo de Lattice-Boltzmann LBM\n\nM\u00e9todo baseado em processos PB\n\nExtra\u00e7\u00e3o r\u00e1pida de rede FNE\n\nSingle thread, Single threaded ST\n\nMultithread, Multithreaded MT\n\nVale observar que o para o MB, existem partes no texto em que se fala\nem Megabytes, cuja abrevia\u00e7\u00e3o \u00e9 a mesma. Essas partes s\u00e3o todas bem con-\ntextualizadas e n\u00e3o h\u00e1 confus\u00e3o de forma alguma. Tamb\u00e9m, o EMB \u00e9 o nome\ndado a adapta\u00e7\u00e3o do MB definida neste trabalho. As abrevia\u00e7\u00f5es de single\nthreaded e multithreaded s\u00e3o utilizadas nos gr\u00e1ficos de modo a diminuir o\ntamanho das legendas referentes, mantendo a aten\u00e7\u00e3o aos gr\u00e1ficos em si.\n\nAs duas workstation utilizadas em todos os testes deste trabalho, pos-\nsuem a seguintes configura\u00e7\u00f5es:\n\nIdentificador M1 M2\nCPU Intel Core i5 x4\n\n2.80Ghz\nAMD Phenom x4\n2.60Ghz\n\nGPU Geforce GT 210\n512MB\n\nGeforce GTX 560\n1024MB\n\nMEM 8GB 4GB\n\nSO Linux x86_64,\nKernel 3.0.0-15\n\nLinux x86_64,\nKernel 3.0.0.0-15\n\nGCC GCC 4.6.1 GCC 4.6.1\n\nLLVM/CLANG LLVM/Clang 2.9 LLVM/Clang 2.9\n\nEm todos os valores descritos em tabelas o descriminador decimal ser\u00e1\no ponto ao inv\u00e9s da tradicional v\u00edrgula da l\u00edngua portuguesa. Essa mudan\u00e7a\nfoi feita de modo a facilitar a integra\u00e7\u00e3o com o latex e a linguagem de pro-\ncessamento estat\u00edstico, chamada R. Acredita-se que tal mudan\u00e7a n\u00e3o fere a\nl\u00edngua referente e menos ainda o entendimento deste trabalho.\n\nO cap\u00edtulo 2 trata do estado da arte e faz uma revis\u00e3o sistem\u00e1tica da\nliteratura, terminando com a metodologia adotada para a explana\u00e7\u00e3o e de-\nmonstra\u00e7\u00e3o dos resultados obtidos. A aquisi\u00e7\u00e3o e o processamento de dados\nmicrotomogr\u00e1ficos s\u00e3o o alvo de estudo do cap\u00edtulo 3. J\u00e1 a parte de proces-\nsamento dos meta-dados \u00e9 motivo de estudo no cap\u00edtulo 4. A caracteriza\u00e7\u00e3o\ne obten\u00e7\u00e3o de dados encontra-se no cap\u00edtulo 5. Por fim tem-se o ap\u00eandice\ncom figuras, gr\u00e1ficos e tabelas que demonstram os resultados obtidos e n\u00e3o\ndescritos no decorrer do trabalho.\n\n\n\n33\n\n2 REVIS\u00c3O SISTEM\u00c1TICA DA LITERATURA\n\nEsse cap\u00edtulo segue as conven\u00e7\u00f5es de revis\u00e3o definidas no relat\u00f3rio\nt\u00e9cnico de Kitchenham (2004) e \u00e9 padr\u00e3o em todas as disserta\u00e7\u00f5es Instituto\nNacional de Converg\u00eancia Digital (INCOD).\n\nNas se\u00e7\u00e3o 2.1, as palavras-chaves e m\u00e9todos de defini\u00e7\u00e3o dos trabalhos\ncorrelacionados a esse trabalho s\u00e3o descritos exaustivamente. A se\u00e7\u00e3o 2.2\ndefine uma revis\u00e3o do estado da arte na \u00e1rea. Em seguida, na se\u00e7\u00e3o 2.3,\ntem-se uma defini\u00e7\u00e3o da metodologia que ser\u00e1 utilizado nos demais cap\u00edtulos\ndo trabalho para explorar-se e desenvolver o problema de caracteriza\u00e7\u00e3o e\nextra\u00e7\u00e3o de redes de poros e gargantas.\n\n2.1 IDENTIFICA\u00c7\u00c3O DA PESQUISA E SELE\u00c7\u00c3O DOS ESTUDOS\n\nAnalisou-se os artigos publicados em anais de congresso, artigos com-\npletos e teses publicados entre 1960 a 2011. Os mecanismos de busca, Google\nScholar, ACM Digital Library, Society of Petroleum Engineers, Springerlink\ne ScienceDirect. Para identificar-se os poss\u00edveis trabalhos relacionados, fo-\nram utilizados alguns crit\u00e9rios de inclus\u00e3o e exclus\u00e3o, os quais levaram \u00e0\nescolha dos dados a serem extra\u00eddos e por fim aos dados brutos.\n\n2.1.1 Crit\u00e9rios de inclus\u00e3o\n\nA partir dos artigos filtrados de acordo com pelo menos uma das se-\nguintes palavras, presentes nas palavras-chaves ou resumo: pore, space, pore\nspace, pore media, pore network, fluid simulation, simulation, fluid, permea-\nbility, relative permeability, absolute permeability, lattice-boltzmann method,\nnumeric, fluid, solver, extracion, network.\n\nOs artigos e teses iniciais foram filtrados de acordo com a relev\u00e2ncia,\ncrit\u00e9rio esse, definido pelo mecanismo de busca e pelos fatores j\u00e1 citados.\nSomente os quinze primeiro trabalhos de cada busca foram levados em consi-\ndera\u00e7\u00e3o, tendo em vista que os resultados acima desse valor raramente ter\u00e3o\nalgum conte\u00fado referente ao de interesse.\n\nOs trabalhos n\u00e3o analisados os quais foram encontrados como rele-\nvantes no estado da arte dos trabalhos analisados ou que foram considerados\numa refer\u00eancia mais original quanto aos conte\u00fados pesquisados foram inclu\u00ed-\ndos tamb\u00e9m.\n\n\n\n34\n\n2.1.2 Crit\u00e9rios de exclus\u00e3o\n\nForam exclu\u00eddos os trabalhos os quais eram estritamente de cunho ge-\nol\u00f3gico ou n\u00e3o possu\u00edam nenhum tipo de compara\u00e7\u00e3o a uma t\u00e9cnica compu-\ntacional. Tamb\u00e9m, os trabalhos cujas t\u00e9cnicas aplicadas n\u00e3o foram utilizadas\nem c\u00e1lculos para volumes tridimensionais e os trabalhos que eram unicamente\nexperimentais, i. e, n\u00e3o definem novas t\u00e9cnicas ou modifica\u00e7\u00f5es a t\u00e9cnicas\ncomputacionais existentes.\n\nForam removidos tamb\u00e9m aqueles que n\u00e3o eram mais originais que\nos artigos os quais referenciavam, para uma dada pesquisa, sendo portanto,\nsubstitu\u00eddos pelo mais original. Tamb\u00e9m, aqueles cuja pesquisa n\u00e3o eram\nrelacionadas ou relacion\u00e1veis \u00e0 caracteriza\u00e7\u00e3o do espa\u00e7o poros em rochas.\n\n2.2 ESTADO DA ARTE\n\nQuanto \u00e0 constru\u00e7\u00e3o de redes a partir do espa\u00e7o poroso, existem tr\u00eas\nprincipais m\u00e9todos: esferas m\u00e1ximas, m\u00e9todos do eixo m\u00e9dio e o m\u00e9todo\nbaseado em processos.\n\n2.2.1 M\u00e9todos do eixo m\u00e9dio\n\nOs m\u00e9todos do eixo m\u00e9dio, tamb\u00e9m conhecido como esqueleto, do\nespa\u00e7o poroso classificam determinadas regi\u00f5es como pertencentes \u00e0 garganta\nou ao poro por diferentes heur\u00edsticas.\n\nO m\u00e9todo de extra\u00e7\u00e3o r\u00e1pida, proposto por Schena e Favretto (2006)\n\u00e9 um dos m\u00e9todos dessa classe. Tal m\u00e9todo depende de como s\u00e3o classifi-\ncados poros e gargantas, ou seja, do crit\u00e9rio usado e \u00e9 poss\u00edvel obter valores\nde permeabilidade e de transporte utilizando-se as se\u00e7\u00f5es transversais ao eixo\nm\u00e9dio como refer\u00eancia e calcular a condut\u00e2ncia na garganta (SCHENA; FA-\nVRETTO; PILLER, 2008). Esse c\u00e1lculo \u00e9 feito, utilizando-se m\u00e9todo dos\nelementos finitos (MEF).\n\nO algoritmo centra-se na extra\u00e7\u00e3o do eixo m\u00e9dio aproximado de um\nvolume. O eixo m\u00e9dio \u00e9 obtido a partir de uma mapa de dist\u00e2ncias exatas,\ntamb\u00e9m chamado de transformada de dist\u00e2ncias exatas e a aplica\u00e7\u00e3o de al-\ngoritmos e procedimentos que refinam e extraem o esqueleto ou eixo m\u00e9dio\naproximado, conforme visto na figura 4.\n\nAp\u00f3s o c\u00e1lculo do mapa de dist\u00e2ncias exatas, faz-se a extra\u00e7\u00e3o das\nlinhas de fluxo, a partir transformada geod\u00e9sica e seu gradiente normalizado.\nEssa etapa de extra\u00e7\u00e3o \u00e9 completamente paraleliz\u00e1vel e obt\u00e9m os caminhos\n\n\n\n35\n\nFigura 4: Figura que demonstra os resultados para extra\u00e7\u00e3o do eixo m\u00e9dio\nem uma amostra de rocha. Schena e Favretto (2006)\n\nde escoamento dentro do espa\u00e7o poroso.\nBifurca\u00e7\u00f5es do caminho s\u00e3o definidas como nodos da rede. Os seg-\n\nmentos que percorrem dois nodos s\u00e3o definidos como borda da rede. Os\nnodos s\u00e3o os poros e o que \u00e1 entre eles \u00e9 definido como regi\u00e3o de garganta.\n\nA extra\u00e7\u00e3o de valores de escoamento monof\u00e1sico e valores petrof\u00edsi-\ncos pode ser feita pela obten\u00e7\u00e3o das sec\u00e7\u00f5es transversais ao eixo m\u00e9dio apro-\nximado. No trabalho de Schena, Favretto e Piller (2008), tais informa\u00e7\u00f5es\ns\u00e3o encontrados pela aplica\u00e7\u00e3o do m\u00e9todo dos elementos finitos (MEF) so-\nbre o resultado da extra\u00e7\u00e3o r\u00e1pida e s\u00e3o ditos como superiores aos resultados\nencontrados no m\u00e9todo baseado em processos (PB).\n\n2.2.2 M\u00e9todo baseado em processos\n\nO m\u00e9todo baseado em processos (PB) foi proposto por Oren e Bakke\n(2002) e tem como ponto forte a precis\u00e3o para volumes homog\u00eaneos diversos,\nprincipalmente arenitos. Esse m\u00e9todo baseia-se em reticulados regulares para\na constru\u00e7\u00e3o do volume de maneira estoc\u00e1stica (BAKKE; OREN, 1997).\n\nInicialmente, a t\u00e9cnica assume que todos os gr\u00e3os s\u00e3o esferas. A partir\ndos gr\u00e3os iniciais, aplicam-se tr\u00eas processos distintos de modelagem e modi-\nfica\u00e7\u00e3o dos gr\u00e3os: a sedimenta\u00e7\u00e3o, compacta\u00e7\u00e3o e diag\u00eanese.\n\nA sedimenta\u00e7\u00e3o \u00e9 feita por gr\u00e3o e pode ser de baixa energia ou alta\nenergia. Na de baixa energia, os gr\u00e3os s\u00e3o escolhidos de maneira aleat\u00f3ria\ne cria-se um campo gravitacional que faz com que ele caia sob a a\u00e7\u00e3o de\nseu pr\u00f3prio peso at\u00e9 atingir um m\u00ednimo local. Assim, ele para ao atingir o\nfundo da amostra ou outro gr\u00e3o. Em contrapartida, na sedimenta\u00e7\u00e3o de alta\n\n\n\n36\n\nFigura 5: Corte transversal de uma amostra de arenito do Mar do Norte, do\ntrabalho de Oren e Bakke (2002)\n\nenergia, for\u00e7as laterais como ondas e fluxos empurram lateralmente o gr\u00e3o,\ndiminuindo a influ\u00eancia da for\u00e7a gravitacional atuando sobre o gr\u00e3o. Isso \u00e9\nfeito no PB depositando-o no ponto de m\u00ednimo global, implicando em uma\nmaior aglomera\u00e7\u00e3o de gr\u00e3os e menor porosidade.\n\nA compacta\u00e7\u00e3o \u00e9 a rea\u00e7\u00e3o ao estresse vertical imposto sobre o volume\nrochoso. \u00c9 modelado no PB a partir da f\u00f3rmula:\n\nZ = Z0(1??z)\n\nOnde Z \u00e9 a nova posi\u00e7\u00e3o vertical, Z0 \u00e9 a posi\u00e7\u00e3o original e ?z \u00e9 o fator\npercentual de compacta\u00e7\u00e3o, definido entre zero e um. O resultado da compac-\nta\u00e7\u00e3o \u00e9 que alguns gr\u00e3os podem se interpenetrar. Isso \u00e9 considerado adequado\npelo modelo e o volume excedente \u00e9 considerado perdido ou transferido para\nfora do sistema.\n\nDiag\u00eanese \u00e9 o nome dado a processos qu\u00edmicos, biol\u00f3gicos ou f\u00edsicos\nque ocasionam desidrata\u00e7\u00e3o, cimenta\u00e7\u00e3o, dissolu\u00e7\u00e3o, entre outros. Somente\nos processos de supercimenta\u00e7\u00e3o do quartzo e da forma\u00e7\u00e3o autig\u00eanica de ar-\ngila na superf\u00edcie do gr\u00e3o s\u00e3o modeladas por aproxima\u00e7\u00f5es conhecidas de tais\nfen\u00f4menos.\n\nO resultado final do PB \u00e9 bem de acordo com o encontrado em areni-\n\n\n\n37\n\nFigura 6: Exemplo de configura\u00e7\u00e3o para descoberta de poros e gargantas, por\nHu Dong (DONG; BLUNT, 2007)\n\ntos do tipo Fontainebleau. Contudo, a modelagem por processos para rochas\nheterog\u00eaneas \u00e9 dificultosa, sobretudo pela origem complexa da rocha cujos\nfen\u00f4menos s\u00e3o dif\u00edceis de serem modelados. A figura 5 demonstra uma ima-\ngem obtida por back-scattered electrons (BSE), ou microsc\u00f3pio eletr\u00f4nico de\nvarredura (MEV). Observa-se na figura, em preto os poros, em cinza claro os\ngr\u00e3os e em cinza escuro a argila. O PB \u00e9 capaz de modelar redes de poros e\ngargantas a partir de imagens como essa.\n\nOs c\u00e1lculos de condut\u00e2ncia, e consequentemente de permeabilidade,\ns\u00e3o obtidos por meio de se\u00e7\u00f5es transversais extra\u00eddas do volume em amostra-\ndas em diversos \u00e2ngulos (OREN; BAKKE, 2002). Por fim, a rede pode ser\ncriada a partir de um modelo pr\u00e9vio da rede e os mesmos c\u00e1lculos serem feitos\nna rede calculada (VALVATNE et al., 2005), incluindo c\u00e1lculos multif\u00e1sicos.\n\n2.2.3 Esferas m\u00e1ximas\n\nAs esferas m\u00e1ximas, m\u00e9todo proposto por Al-Kharusi e Blunt (2007),\n\u00e9 baseado no trabalho de Silin, Jin e Patzek (2003), utilizado para calcular a\nmorfologia em amostras de rochas heterog\u00eaneas. No m\u00e9todo proposto por Al-\nKharusi, as esferas s\u00e3o classificadas em uma hierarquia. Elas s\u00e3o classificadas\nem mestras, escravas ou cluster, sendo que o \u00faltimo pode ser limitados ou\nn\u00e3o. Cada cluster pode possuir filhos, assim como as mestras e escravas.\n\n\n\n38\n\nFigura 7: Vis\u00e3o geral do algoritmo de esferas m\u00e1ximas\n\nAssim, tem-se uma hierarquia que define, segundo um conjunto de regras,\nporos e gargantas.\n\nO trabalho de Dong e Blunt (2007) seguiu a mesma ideia, por\u00e9m eles\npartem das esferas de raio maior, para as esferas de raio menor, aglomerando\nas esferas que se intersectem e gerando gargantas no encontro de duas esferas\ncom poros pais diferentes. O processo \u00e9 descrito visualmente na figura 6,\nonde h\u00e1 dois poros ligados por uma garganta. O intuito das modifica\u00e7\u00f5es foi\ndefinir modifica\u00e7\u00f5es sobre o algoritmo de Al-Kharusi de modo a ele consumir\nmenos mem\u00f3ria e processamento. Gargalos esses, identificados pelo pr\u00f3prio\nautor (AL-KHARUSI; BLUNT, 2007).\n\nOs algoritmos de extra\u00e7\u00e3o automatizada de uma rede de poros e gar-\ngantas usando o algoritmo de esferas m\u00e1ximas seguem o pipeline demons-\ntrado pela figura 7. O MB \u00e9 o \u00fanico dos algoritmos citados que possui efic\u00e1cia\nconhecida na literatura para extra\u00e7\u00e3o de rede de poros de amostras heterog\u00ea-\nneas. O m\u00e9todo foi proposto para a caracteriza\u00e7\u00e3o dessas. Por esse motivo,\nele foi o escolhido para implementar-se a modifica\u00e7\u00e3o descrita nesse traba-\nlho. Em seguida, descreve-se o m\u00e9todo que ser\u00e1 utilizado nesse trabalho para\nfazer-se as modifica\u00e7\u00f5es ao MB.\n\n2.3 M\u00c9TODO\n\nInicialmente, ser\u00e1 feita um levantamento dos volumes de interesse\npara esse trabalho, com rela\u00e7\u00e3o aos trabalhos anteriores do MB. Alguns dos\nvolumes utilizados nos trabalhos base do algoritmo encontram-se dispon\u00edveis\npara uso. Tais volumes devem ser descritos e o processo para chegar-se at\u00e9\n\n\n\n39\n\nFigura 8: Todas as esferas, n\u00e3o contidas em nenhuma outra, que representam\na dist\u00e2ncia at\u00e9 o voxel n\u00e3o poro mais pr\u00f3ximo.\n\neles, em sua forma binarizada. Ao mesmo tempo, deve-se propor uma t\u00e9cnica\npara compress\u00e3o desses volumes binarizados para que eles utilizem o menos\nde mem\u00f3ria e espa\u00e7o em disco. Assim, tem-se mais espa\u00e7o em mem\u00f3ria para\na execu\u00e7\u00e3o do algoritmo em si.\n\nPara cumprir com o objetivo de acelerar e modificar o algoritmo MB,\ndeve-se primeiro levar em considera\u00e7\u00e3o as principais etapas do algoritmo e\nos dados de entrada e sa\u00edda deles. Deve ser selecionado um conjunto de algo-\nritmos os quais sejam capazes de suprir, de forma \u00f3tima, ou seja, com maior\nefici\u00eancia, os requisitos de acelera\u00e7\u00e3o e paraleliza\u00e7\u00e3o do algoritmo em uma\ndada plataforma e test\u00e1-los. Dos algoritmos relevantes obtidos, tem-se aque-\nles os quais existem etapas seriais. Elas devem ser identificadas, caso existam,\npois elas que definir\u00e3o o m\u00e1ximo de desempenho obtido ao paralelizar-se o\nproblema.\n\nPara obter resultados mais eficientes em rela\u00e7\u00e3o ao algoritmo MB,\npretende-se utilizar implementa\u00e7\u00f5es paralelizadas, em cpu, para todos os al-\ngoritmos e estudar implementa\u00e7\u00f5es em gpu, para partes espec\u00edficas das etapas\ngerais, comparando-as com a chamada vers\u00e3o ouro, em cpu. A explora\u00e7\u00e3o de\nparalelismo no algoritmo de esferas m\u00e1ximas \u00e9 pioneira na literatura. Para\noutras t\u00e9cnicas menos recentes, como o LBM existem muitas implementa-\n\u00e7\u00f5es paralelizadas, mesmo em gpu (FAN et al., 2004; BERNASCHI et al.,\n2010).\n\n\n\n40\n\nTrazer o algoritmo de esferas m\u00e1ximas inteiramente para a gpu se-\nria uma tarefa herc\u00falea, j\u00e1 que existem etapas completamente sequenciais na\naglomera\u00e7\u00e3o original. Tamb\u00e9m, n\u00e3o se trata de um algoritmo \u00fanico, mas um\nconjunto de passos os quais individualmente s\u00e3o mais simples de compre-\nender e implementar. As esferas, ap\u00f3s a aglomera\u00e7\u00e3o, s\u00e3o todas as esferas\nexpostas na figura 8. A cor representa o tamanho do poro o qual a esfera foi\naglomerada e as esferas pertencentes a gargantas n\u00e3o est\u00e3o representadas.\n\nSer\u00e1 implementada uma vers\u00e3o sequencial, em cpu, do esferas m\u00e1xi-\nmas, exportando o resultado para o solver proposto por Valvatne et al. (2005),\no qual simula a fase \u00e1gua e fase \u00f3leo da extra\u00e7\u00e3o de flu\u00eddo a partir de uma rede\nde poros de entrada. A partir da compara\u00e7\u00e3o dos resultados de permeabili-\ndade, principalmente a absoluta, faz-se um comparativo quanto a exatid\u00e3o do\nresultado obtido em rela\u00e7\u00e3o aos resultados de outros m\u00e9todos para as mesmas\namostras.\n\nEssa implementa\u00e7\u00e3o inicial ser\u00e1 feita sobre as bibliotecas C3DE (Cy-\nclops 3D Environment) (SILVA et al., 2009), inicialmente utilizadas para vi-\nsualiza\u00e7\u00e3o e processamento de volumes m\u00e9dicos, por\u00e9m adaptada para o pro-\ncessamento de dados de microtomografia de rocha.\n\n\n\n41\n\n3 PROCESSAMENTO E AN\u00c1LISE DE DADOS\nMICROTOMOGR\u00c1FICOS DE ROCHA\n\nNesse cap\u00edtulo, define-se como ocorre a aquisi\u00e7\u00e3o de dados microto-\nmogr\u00e1ficos de rocha e qual processamento \u00e9 necess\u00e1rio sobre esse volume\nde dados brutos para obter-se uma amostra bin\u00e1ria, representando o espa\u00e7o\nporoso e a rocha. Tamb\u00e9m, ser\u00e3o apresentadas t\u00e9cnicas as quais permitem o\nprocessamento e visualiza\u00e7\u00e3o de grandes volumes de dados e os volumes de\ndados utilizados em v\u00e1rias partes desse trabalho.\n\n3.1 AQUISI\u00c7\u00c3O DE DADOS\n\nExistem v\u00e1rios m\u00e9todos utilizados pela ind\u00fastria para extrair-se dados\npetrof\u00edsicos de uma amostra de rochas qualquer, como a dolomita da figura\n9b. Dentre essas t\u00e9cnicas destacam-se duas: porosimetria por inje\u00e7\u00e3o de\nmerc\u00fario e processamento de amostras microtomogr\u00e1ficas.\n\nA porosimetria por inje\u00e7\u00e3o de merc\u00fario, proposta por Washburn (1921)\ne aplicada em laborat\u00f3rio por Henderson et al. (1940). Tal t\u00e9cnica, baseia-se\nno fato do merc\u00fario ser um fluido n\u00e3o-molhante em rela\u00e7\u00e3o a v\u00e1rias subs-\nt\u00e2ncias, incluindo os materiais rochosos, e portanto, n\u00e3o penetra em vulgos\ne fissuras de maneira espont\u00e2nea, ou seja, \u00e9 necess\u00e1rio aplicar press\u00e3o sobre\nele para que isso aconte\u00e7a.\n\nA microtomografia computadorizada de rochas obt\u00e9m fatias bidimen-\nsionais, ou seja, imagens de sec\u00e7\u00f5es transversais alinhadas. O empilhamento\ndessas imagens gera um volume microtomogr\u00e1fico. Analisando-se o volume\npor um modelo de an\u00e1lise de espa\u00e7o poroso \u00e9 poss\u00edvel obter caracter\u00edsticas do\nespa\u00e7o poroso. Uma vantagem desse m\u00e9todo \u00e9 a possibilidade de reutilizar-se\na amostra para obter novos dados microtomogr\u00e1ficos. Tamb\u00e9m, os avan\u00e7os\nna resolu\u00e7\u00e3o e qualidade desse tipo de reconstru\u00e7\u00e3o que refinam o resultado\ndos modelos aplicados sobre ele.\n\n3.1.1 Porosimetria por inje\u00e7\u00e3o de merc\u00fario\n\nO teste \u00e9 feito introduzindo a amostra em um recipiente dotado de um\ncapilar, no qual a amostra encontra-se em condi\u00e7\u00f5es de v\u00e1cuo. Assim, ao\ninjetar-se o merc\u00fario no recipiente, preenchendo tamb\u00e9m o capilar, e aplicar-\nse uma press\u00e3o para que o merc\u00fario adentre as fissuras e vulgos, tem-se a\nquantidade de l\u00edquido reduzido no capilar. \u00c9 poss\u00edvel calcular uma curva de\n\n\n\n42\n\n(a) Recipiente para c\u00e1lculo da porosimetria (b) Amostra de dolo-\nmita do per\u00edodo siluri-\nano\n\nFigura 9: Configura\u00e7\u00e3o de porosimetria por inje\u00e7\u00e3o de merc\u00fario e uma amos-\ntra real\n\npenetra\u00e7\u00e3o no volume de amostra, para cada press\u00e3o aplicada e extrair valores\nde distribui\u00e7\u00e3o de poros de maneira direta. Por um p\u00f3s-processamento apro-\nximado tamb\u00e9m obt\u00e9m-se a permeabilidade absoluta. Contudo, essa t\u00e9cnica\n\u00e9 destrutiva, arruinando a amostra para qualquer uso futuro. Uma vis\u00e3o geral\ndesse processo pode ser observada na figura 9a.\n\n3.1.2 Microtomografia computadorizada\n\nA microtomografia prov\u00ea uma maneira de analisar-se o volume da\namostra computacionalmente, possibilitando assim o reuso dessa em outras\nmicrotomografias. Assim, pode-se obter imagens distintas em resolu\u00e7\u00f5es dis-\ntintas para o mesmo volume. Isso possibilita a utiliza\u00e7\u00e3o de dados multi es-\ncalares. A microtomografia tamb\u00e9m d\u00e1 uma ideia visual da forma do espa\u00e7o\nporoso interno.\n\nA amostragem d\u00e1-se da seguinte forma: o volume \u00e9 centrado no mi-\ncrotom\u00f3grafo. Ele \u00e9 rotacionado, pelo sistema de movimenta\u00e7\u00e3o controlada\ndo tom\u00f3grafo e o perfil de proje\u00e7\u00e3o atenuado \u00e9 obtido pelas amostras em v\u00e1-\nrios \u00e2ngulos. Finalmente, os dados tridimensionais dos cortes transversais\ndo volume s\u00e3o reconstru\u00eddos no formato de imagem pelo pr\u00f3prio microto-\nm\u00f3grafo. O resultado final s\u00e3o imagens transversais em tons de cinza. O\n\n\n\n43\n\nFigura 10: Obten\u00e7\u00e3o das imagens e pipeline de processamento t\u00edpico para\namostras de rocha, por Fernandes, Appoloni e Fernandes (2009)\n\nprocesso geral \u00e9 observado na figura 10.\nA partir das imagens obtidas pode ser feito o processamento de in\u00fa-\n\nmeras propriedades petrof\u00edsicas. Entretanto, n\u00e3o \u00e9 poss\u00edvel calcular essas\npropriedades sem um pr\u00e9-processamento que defina para os algoritmos sub-\nsequentes quais partes do volume s\u00e3o espa\u00e7o poroso e quais s\u00e3o rocha. Essa\netapa exige um processamento para definir-se um valor de limiar que defina o\nespa\u00e7o poroso como sendo 0 ou 1 e o rochoso o complementar. Tal processo\ndenomina-se binariza\u00e7\u00e3o.\n\n3.2 BINARIZA\u00c7\u00c3O DO VOLUME DE DADOS\n\nA binariza\u00e7\u00e3o d\u00e1-se por uma fun\u00e7\u00e3o T de thresholding a qual defina,\npara cada pixel px,y ? I , sendo I a imagem original:\n\npx,y = T (px,y)\n\nT (x) =\n\n{\n1, x > ?\n0, x ? ?\n\n\n\n44\n\n? \u00e9 o valor do threshold em si. \u00c9 poss\u00edvel calcular esse valor de forma\nautom\u00e1tica, ou selecionar-se manualmente. Uma forma de selecionar-se auto-\nmaticamente o valor de threshold \u00e9 pela mediana ou m\u00e9dia (SEZGIN; SAN-\nKUR, 2004). Outra maneira, \u00e9 a avaliar-se o histograma da imagem e des-\ncobrir o ponto de m\u00ednimo entre duas popula\u00e7\u00f5es. O algoritmo 1, demonstra\numa maneira robusta e iterativa de obter-se o valor de threshold, na tentativa\nde achar o ponto de m\u00ednimo entre duas popula\u00e7\u00f5es.\n\nAlgoritmo 1: Obten\u00e7\u00e3o do valor de thresholding autom\u00e1tico\nentrada: Ii a imagem de entrada; t0 o \"chute\"de threshold inicial\nsa\u00edda : o valor de threshold\nt ? t0;\nwhile t 6= t0 do\n\nm0 ? c0 ? 0;\nm1 ? c1 ? 0;\nfor px,y ? Ii do\n\nif px,y ? t then\nc0 ? c0 + 1;\nm0 ? m0 + px,y;\n\nelse\nc1 ? c1 + 1;\nm1 ? m1 + px,y;\n\nt0 ? t;\nm0 ?\n\nm0\nmax(c0,1)\n\n;\nm1 ? m1max(c1,1) ;\nt ? m02 +\n\nm1\n2 ;\n\nreturn t;\n\nO resultado final da fun\u00e7\u00e3o de thresholding \u00e9 uma imagem binarizada,\ndefine-se como foreground os pixels em branco e background os pixels em\npreto, ou vice-versa. Assim, tem-se na amostra volum\u00e9trica de rocha, a defi-\nni\u00e7\u00e3o da fase porosa e rochosa.\n\nA t\u00e9cnica mais simples de binariza\u00e7\u00e3o \u00e9 delegar a escolha do valor de\nlimiar ao especialista. Essa t\u00e9cnica manual pode ser aprimorada pela escolha\nautomatizada de um valor inicial. Assim, o especialista pode avaliar se o\nresultado foi bom o suficiente ou modific\u00e1-lo como desejar.\n\nExistem muitos outros algoritmos que possam ser utilizados no con-\ntexto de amostras de rocha (SEZGIN; SANKUR, 2004), por\u00e9m, mais impor-\ntante do que a pr\u00f3pria binariza\u00e7\u00e3o \u00e9 a pr\u00e9-filtragem do volume amostrado, a\nqual influencia diretamente o resultado final da binariza\u00e7\u00e3o.\n\n\n\n45\n\n3.3 FILTRAGEM E TRATAMENTO\n\nPara que o volume binarizado possua caracter\u00edsticas mais homog\u00eaneas\ne para reduzir-se o n\u00famero de artefatos provenientes da etapa de aquisi\u00e7\u00e3o das\nimagens, tipicamente faz-se uma pr\u00e9-filtragem do volume.\n\nUm m\u00e9todo bastante robusto para a filtragem do volume \u00e9 o filtro da\nmediana. Para cada subconjunto de n por m pixels, procura-se o elemento\nmediano e define-se todos os pixels pertencentes a essa regi\u00e3o com o valor\nencontrado.\n\nA vantagem desse filtro \u00e9 a remo\u00e7\u00e3o de elementos ruidosos no es-\npa\u00e7o poroso ou na rocha e tamb\u00e9m pelo fechamento de pequenos buracos\nem ambos. Assim menos elementos pequenos, normalmente provenientes de\nproblemas na aquisi\u00e7\u00e3o far\u00e3o parte das etapas de processamento futura. Tam-\nb\u00e9m, modifica-se o histograma da imagem, aglomerando os valores de pixels\nem torno de valores mais comuns.\n\nNa figura 11, encontra-se ilustrado a imagem original e a imagem fil-\ntrada e os histogramas de cada uma. Observa-se que os valores finais s\u00e3o mais\nconcentrados em torno de pontos de m\u00e1ximo e menos em rela\u00e7\u00e3o aos pontos\nde m\u00ednimo. Isso facilita a aplica\u00e7\u00e3o de algoritmos que extraiam um valor de\nthreshold de maneira autom\u00e1tica como o descrito na se\u00e7\u00e3o 3.2.\n\nApesar da efici\u00eancia na remo\u00e7\u00e3o de elementos ruidosos do filtro da\nmediana ser inquestion\u00e1vel, outros como o gaussiano e filtros espec\u00edficos para\nremo\u00e7\u00e3o de artefatos da etapa de aquisi\u00e7\u00e3o podem ser utilizados. Como na\nbinariza\u00e7\u00e3o, a decis\u00e3o da necessidade desses pode ser delegada ao especialista\no qual aplicar\u00e1 os filtros conforme desejar.\n\nAp\u00f3s a filtragem e binariza\u00e7\u00e3o, tem-se o volume binarizado em valo-\nres branco e preto, ditos foreground e background, ou vice-versa. Segundo\nLucia (1999), a quantidade de elementos pertencentes ao espa\u00e7o poroso \u00e9 a\nporosidade ? , definida em fun\u00e7\u00e3o do n\u00famero de voxels pertencentes ao es-\npa\u00e7o poroso. Considerando-se Vp, o n\u00famero total de voxels pertencentes ao\nespa\u00e7o poroso e V , o n\u00famero total de voxels no volume, a porosidade \u00e9 dada\npor:\n\n? =\nVp\nV\n\n(1)\n\nComo somente os voxels pertencentes ao espa\u00e7o poroso s\u00e3o de inte-\nresse para a extra\u00e7\u00e3o da rede de poros e gargantas, a aplica\u00e7\u00e3o de t\u00e9cnicas\nde compress\u00e3o tem bons resultados quanto \u00e0 utiliza\u00e7\u00e3o de mem\u00f3ria total dos\nsistemas que o fazem. Pela pr\u00f3pria simplicidade do volume bin\u00e1rio, t\u00e9cnicas\nde compress\u00e3o diversas s\u00e3o eficientes. A compress\u00e3o run-lenght encoding\n(RLE) \u00e9 um exemplo.\n\n\n\n46\n\n(a) Amostra antes (esq.) e ap\u00f3s (dir.) a aplica\u00e7\u00e3o do filtro da mediana\n\n(b) Histograma antes (esq.) e ap\u00f3s (dir.) a aplica\u00e7\u00e3o do filtro da mediana\n\nFigura 11: Amostra de arenito e os histogramas referentes\n\n\n\n47\n\nFigura 12: Imagem binarizada, onde i representa as linha e j as colunas\n\n3.4 COMPRESS\u00c3O RLE\n\nConsidera-se o seguinte quadro de ocupa\u00e7\u00e3o de mem\u00f3ria em fun\u00e7\u00e3o\ndo tamanho do volume binarizado, representando com um byte por voxel:\n\nLado em pixels 64 128 256 512 1024 2048 4096\nMem\u00f3ria (MB) 0.25 2 16 128 1024 8192 65536\n\nPercebe-se o grande crescimento na ocupa\u00e7\u00e3o de mem\u00f3ria, ainda mais\nse considerado que essa ocupa\u00e7\u00e3o d\u00e1-se pelo fato da representa\u00e7\u00e3o utilizada\nser a mais simples, isso \u00e9, ela n\u00e3o leva em considera\u00e7\u00e3o a possibilidade de\nredund\u00e2ncia na representa\u00e7\u00e3o do volume e a representa\u00e7\u00e3o bin\u00e1ria. Gasta-se\num espa\u00e7o, em disco e em mem\u00f3ria, demasiadamente grande para representar\no volume dessa forma, sobretudo ao considerar-se a possibilidade de repre-\nsentar esse volume inteiramente na gpu.\n\nA fim de representar-se a imagem 12 da maneira tradicional, assumindo-\nse que a coluna \u00e9 mais variante, como uma sequ\u00eancia de pixels onde o valor\ndo pixel \u00e9 dado por W, se branco e B se preto, a representa\u00e7\u00e3o extensiva da\nimagem seria W, W, W ..., B, B, W, W, B, B, W, ..., W. Ou seja, um va-\nlor branco ou preto definido para cada pixel da imagem. Tal solu\u00e7\u00e3o \u00e9 dita\ncomo uma imagem raw, ou bruta, e n\u00e3o possui nenhum tipo de compress\u00e3o.\nPara volumes muito grandes, conforme j\u00e1 visto, a utiliza\u00e7\u00e3o de compress\u00e3o \u00e9\nprimordial.\n\nO run-length encoding (RLE) \u00e9 uma t\u00e9cnica para representa\u00e7\u00e3o com-\npacta de dados. Ao inv\u00e9s de representar-se os dados extensivamente, pode-\nse representar somente os segmentos de elementos repetidos, isso \u00e9, para a\n\n\n\n48\n\nmesma imagem, a representa\u00e7\u00e3o ficaria 9W (nove brancos seguidos), 2B (2\npretos seguidos), 2W, 2B, 2W, 2B, ..., e assim por diante. Um problema dessa\nrepresenta\u00e7\u00e3o \u00e9 que para acessar-se aleatoriamente qualquer elemento do vo-\nlume, algo amplamente utilizado em algoritmos de processamento diversos,\ntem-se uma complexidade O(logn), onde n \u00e9 o n\u00famero de pixels existentes na\nimagem. Tal t\u00e9cnica pode ser vista na se\u00e7\u00e3o 4.5.\n\nPara aumentar-se a efici\u00eancia da busca aleat\u00f3ria na imagem, faz-se\numa compress\u00e3o RLE por linha, diminuindo o fator n do n\u00famero de pixels\nda imagem para o n\u00famero de pixels por linha. Assim, tem-se um melhor de-\nsempenho numa busca aleat\u00f3ria qualquer e \u00e9 poss\u00edvel recuperar, em tempo\nlinear, qualquer linha do volume. Algoritmos inteligentes, que assumam essa\nrepresenta\u00e7\u00e3o \u00f3tima por linha, podem ser mais eficientes que algoritmos des-\npreparados para acessar a imagem dessa forma.\n\nA mesma representa\u00e7\u00e3o, exemplificada na imagem, pode ser utilizada\nem um volume. Ainda \u00e9 poss\u00edvel comprimir-se por linha e acessar-se ale-\natoriamente os dados no volume. Portanto, para aplicar esse algoritmo de\ncompress\u00e3o basta aplicar a ideia a um formato padr\u00e3o, que no caso desse\ntrabalho \u00e9 o RBV. A descri\u00e7\u00e3o encontra-se na se\u00e7\u00e3o 7.1.\n\n3.5 VOLUMES\n\nNessa se\u00e7\u00e3o, define-se os volumes utilizados, classificando-os em tr\u00eas\ntipos diferentes: Arenitos, definidos pela consoante S seguida de um n\u00famero,\ne.g., S1, S2, S3. Carbonatos, definidos por um C seguido por um n\u00famero, por\nexemplo, C1, C2, C3, e amostras sint\u00e9ticas, definidas por um A seguido por\num n\u00famero, isto \u00e9, A1, A2, A3... A tabela 2, demonstra imagens de cortes\ntransversais dos volumes utilizados, com as nomenclaturas devidas, seguidas\nde suas dimens\u00f5es, porosidades e resolu\u00e7\u00f5es.\n\nOs arenitos S1 a S9 e os carbonatos C1 e C2 s\u00e3o volumes de dados\ndisponibilizados pelo Imperial College London e s\u00e3o amostras as quais foram\nusadas no trabalho de Dong e Blunt (2007).\n\nNa figura 13, observa-se a mem\u00f3ria ocupada, em MB, dos volumes\nde entrada, para o formato RBV e para o formato RAW. Os arenitos S1 a S9\ne a A1 s\u00e3o todos volumes de dimens\u00f5es 3003, e ocupam, sem compress\u00e3o,\naproximadamente 25 MB em mem\u00f3ria cada. Na A1 a taxa de compress\u00e3o \u00e9\nmenor pois \u00e9 uma amostra com poros bastante irregulares e com porosidade\nalta. As amostras carbon\u00e1ticas s\u00e3o maiores, ocupando at\u00e9 70 MB. Para volu-\nmes grandes, com dimens\u00f5es maiores que 10243 o espa\u00e7o ocupado salta para\ncasa dos GB. Assim, tem-se a necessidade de compress\u00e3o, sobretudo para\nser poss\u00edvel processar esses volumes maiores em m\u00e1quinas n\u00e3o dedicadas a\n\n\n\n49\n\nS1 S2 S3 S4\n300x300x300 300x300x300 300x300x300 300x300x300\n\nPorosidade: 14.13% Porosidade: 24.26% Porosidade: 16.85% Porosidade: 17.12%\nResolu\u00e7\u00e3o: 8.68\u00b5 m Resolu\u00e7\u00e3o: 4.95\u00b5 m Resolu\u00e7\u00e3o: 9.1\u00b5 m Resolu\u00e7\u00e3o: 8.96\u00b5 m\n\nS5 S6 S7 S8\n300x300x300 300x300x300 300x300x300 300x300x300\n\nPorosidade: 21.13% Porosidade: 23.95% Porosidade: 25.04% Porosidade: 33.98%\nResolu\u00e7\u00e3o: 3.99\u00b5 m Resolu\u00e7\u00e3o: 5.1\u00b5 m Resolu\u00e7\u00e3o: 3.80\u00b5 m Resolu\u00e7\u00e3o: 4.89\u00b5 m\n\nS9 S10 S11 C1\n300x300x300 400x400x400 300x300x300 400x400x400\n\nPorosidade: 22.17% Porosidade: 19.80% Porosidade: 23.21% Porosidade: 23.26%\nResolu\u00e7\u00e3o: 3.38\u00b5 m Resolu\u00e7\u00e3o: 2.4\u00b5 m Resolu\u00e7\u00e3o: 3.4\u00b5 m Resolu\u00e7\u00e3o: 2.85\u00b5 m\n\nC2 C3 C4 A1\n400x400x400 416x416x400 322x322x418 300x300x300\n\nPorosidade: 16.83% Porosidade: 10.95% Porosidade: 03.19% Porosidade: 42.86%\nResolu\u00e7\u00e3o: 5.34\u00b5 m Resolu\u00e7\u00e3o: 3.6\u00b5 m Resolu\u00e7\u00e3o: 0.36\u00b5 m Resolu\u00e7\u00e3o: 3.85\u00b5 m\n\nTabela 2: Imagens de se\u00e7\u00f5es transversais dos volumes de entrada, com suas\ndimens\u00f5es, porosidades e resolu\u00e7\u00f5es. A fase poro est\u00e1 em branco\n\n\n\n50\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 C3 C4 A1\n\nRBV\n\nRAW\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\nM\ne\nm\n\n\u00f3\nr\nia\n\n (\nM\n\nB\n)\n\nVolume\n\nFigura 13: Espa\u00e7o absoluto, em MB, dos RBVs e RAWs\n\nprocessamento ou clusters.\nOs valores percentuais de compress\u00e3o variam de aproximadamente\n\n6.5% a 20% para os volumes de entrada, conforme observado no gr\u00e1fico 14.\nO fator que mais afeta a performance de compress\u00e3o n\u00e3o \u00e9 a porosidade do\nvolume em si, pois o formato RBV representa segmentos de pixels e n\u00e3o seus\nvalores diretamente. Assim, o que mais afeta a taxa de compress\u00e3o s\u00e3o infor-\nma\u00e7\u00f5es ruidosas e amostras cujo espa\u00e7o poroso e rochoso s\u00e3o irregulares.\n\nAlguns volumes se destacam na taxa de compress\u00e3o acentuada. No\ncaso do C3 e C4, o volume RBV foi bem menor porque os dados porosos\neram esparsos e sua porosidade \u00e9 baixa. No S11, o volume de poros \u00e9 de-\nmasiadamente concentrado se comparado com outras amostras carbon\u00e1ticas.\nNos arenitos S1, S5, S6, S9 a dupla baixa porosidade e amostra com poros\nregulares fazem com que a compress\u00e3o por faixas de valores seja bastante\neficaz.\n\nA filtragem na etapa de aquisi\u00e7\u00e3o e a pr\u00e9-filtragem dos volumes bina-\nrizados fazem com que o volume fique mais homog\u00eaneo e perca informa\u00e7\u00f5es\nruidosas. Portanto, contribuem significativamente para a compress\u00e3o do vo-\nlume binarizado e mesmo para a etapa de extra\u00e7\u00e3o de RP, onde esses voxels\nn\u00e3o ser\u00e3o processados e n\u00e3o ir\u00e3o gerar meta-informa\u00e7\u00f5es.\n\n\n\n51\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 C3 C4 A1\n\nRBV\n\nRAW\n\n0\n\n20\n\n40\n\n60\n\n80\n\n100\nP\n\nor\nce\n\nn\nta\n\ng\nem\n\n (\n%\n\n)\n\nVolumes\n\nFigura 14: Espa\u00e7o , em porcentagem, dos RBVs e RAWs\n\n3.6 CONCLUS\u00c3O\n\nO processo de aquisi\u00e7\u00e3o e filtragem de dados tomogr\u00e1ficas tem im-\npacto nas etapas futuras e na compress\u00e3o do volume binarizado. Nessa etapa,\no expertise do especialista \u00e9 de fundamental import\u00e2ncia, sobretudo na etapa\nde aquisi\u00e7\u00e3o e checagem da qualidade dos dados obtidos. Tamb\u00e9m, a inten-\nsidade da filtragem pode ser parametrizada. Assim, pode-se aplicar filtragens\nmais intensas sobre volumes ruidosos e menos intensas sobre outros. Isso\ntudo, pode ser delegado ao especialista porque ele possui a fonte de conhe-\ncimento do que \u00e9 um dado amostral bom ou n\u00e3o. Ainda assim, algoritmos\nautomatizados podem auxiliar e acelerar a decis\u00e3o.\n\nNota-se que a taxa de compress\u00e3o varia conforme a morfologia do\nespa\u00e7o poroso, por\u00e9m ela n\u00e3o foi maior que pouco mais de 20% para todos os\nvolumes de entrada, das figuras 13 e 14. Portanto, confirma-se a validade de\ntal t\u00e9cnica, principalmente para economia de mem\u00f3ria em volumes grandes,\nj\u00e1 que tom\u00f3grafos recentes s\u00e3o capazes de reconstruir volumes com GB de\ndados.\n\nA tabela 2 cont\u00e9m todos os volumes utilizados nesse cap\u00edtulo e nos\ncap\u00edtulos 4 e 5. O Laborat\u00f3rio de Meios Porosos e Propriedades Termof\u00edsicas\n\n\n\n52\n\n(LMPT) da Universidade Federal de Santa Catarina disponibilizou as amos-\ntras C3, C4, S10 e S11. As outras s\u00e3o id\u00eanticas aos volumes utilizados no\ntrabalho de Dong e Blunt (2007). Pela utiliza\u00e7\u00e3o de v\u00e1rios volumes id\u00eanti-\ncos, \u00e9 poss\u00edvel tra\u00e7ar v\u00e1rios paralelos entre a t\u00e9cnica MB e as esferas m\u00e1ximas\nexatas (EMB), descrita no cap\u00edtulo 4.\n\n\n\n53\n\n4 EXTRA\u00c7\u00c3O DE REDE DE POROS POR ESFERAS M\u00c1XIMAS\nEXATAS\n\nNesse cap\u00edtulo s\u00e3o vistos os resultados referentes cada etapa do esfe-\nras m\u00e1ximas (MB) com rela\u00e7\u00e3o as modifica\u00e7\u00f5es propostas. \u00c0s modifica\u00e7\u00f5es\nfeitas sobre o algoritmo MB, d\u00e1-se o nome de esferas m\u00e1ximas exatas (EMB).\n\nO algoritmo de esferas m\u00e1ximas possui quatro macro-etapas: a busca\nde esferas, a remo\u00e7\u00e3o de esferas, a aglomera\u00e7\u00e3o e por fim a gera\u00e7\u00e3o da RP. A\nfigura 7, apresenta todas as etapas que compreendem o processo automatizado\nde gera\u00e7\u00e3o de RP a partir de um volume de uma amostra de rocha, incluindo\nas quatro macro-etapas apontadas.\n\n4.1 BUSCA DE ESFERAS\n\nA etapa de busca de esferas \u00e9 vital para o processo que sucede, uma\nvez que nessa etapa s\u00e3o encontradas todas as esferas que representam a dis-\nt\u00e2ncia do voxel poro at\u00e9 o rocha mais pr\u00f3ximo. Essas esferas, s\u00e3o processa-\ndas, sendo removidas as esferas que estejam contidas em outras. Somente as\nesferas restantes desse \u00faltimo processo s\u00e3o aglomeradas e por fim geram a\nRP.\n\nExistem duas vertentes para extrair-se as esferas do volume poroso: o\nalgoritmo de inflar esferas (DONG; BLUNT, 2007; AL-KHARUSI; BLUNT,\n2007) e a extra\u00e7\u00e3o das esferas por meio de uma transformada de dist\u00e2ncias,\ndo ingl\u00eas distance transform (SCHENA; FAVRETTO, 2006).\n\n4.1.1 Algoritmo de inflar esferas\n\nAl-Kharusi e Blunt (2007) e Dong e Blunt (2007) utilizaram a aborda-\ngem de inflar as esferas, a partir de cada voxel pertencente ao espa\u00e7o poroso.\nNessa t\u00e9cnica, o produto final s\u00e3o dois raios diferentes para a esfera: um raio\nm\u00e1ximo, denotado por Rmax, definido pela esfera discreta que cont\u00e9m todos\nos voxels, incluindo o voxel rocha mais pr\u00f3ximo e um raio m\u00ednimo, denotado\npor Rmin cujo valor \u00e9 o raio da esfera que inclui todos os voxels menos o voxel\nrocha mais pr\u00f3ximo.\n\nTem\u2013se um voxel V1 que \u00e9 o valor s\u00f3lido mais pr\u00f3ximo do voxel de\ninteresse V0, pertencente ao espa\u00e7o poroso. O raio real do voxel, denotado\npor Rreal , \u00e9 algo entre Rmin e Rmax e \u00e9 definido, em espa\u00e7o euclidiano, por:\n\n\n\n54\n\nFigura 15: Configura\u00e7\u00f5es de intersec\u00e7\u00e3o com pixel rocha em cinza e raios em\nv\u00e1rias cores. O esquema de Dong e Blunt (2007) (direita) e o esquema com\nesferas de tamanho exato (esquerda)\n\nRreal = dist(V1,V0) (1)\n\nRreal =\n?\n(x1 ?x0)2 +(y1 ?y0)2 +(z1 ?z0)2 (2)\n\nPelo fato de levar-se em considera\u00e7\u00e3o a dist\u00e2ncia no espa\u00e7o tridimensi-\nonal para construir-se a esfera de raio Rmin e Rmax, \u00e9 imposs\u00edvel, sem analisar-\nse novamente o volume, obter-se o raio Rreal a partir de ambas.\n\nConforme definido por Dong e Blunt (2009) tem-se que se uma esfera\nS0, com Rmin = R0, est\u00e1 contida em outra, S1, com Rmin = R1, ent\u00e3o na figura\n15, as esferas cujo Rmin =\n\n?\n2, n\u00e3o deveriam ultrapassar a barreira imposta\n\npelos pixels que denotam o s\u00f3lido e se intersectar. Segundo a equa\u00e7\u00e3o de\nintersec\u00e7\u00e3o definida na se\u00e7\u00e3o 4.2, isso acontece. Portanto, em etapas futuras,\nao inv\u00e9s de achar dois poros conectados por uma garganta, o algoritmo achar\u00e1\nsomente um poro com uma das duas esferas que na vers\u00e3o exata definem\nporos sendo a filha direta da outra. Esse fato tornar-se-\u00e1 mais claro nas se\u00e7\u00f5es\n4.2 e 4.3.\n\nA figura 16, demonstra os tempos de execu\u00e7\u00e3o do algoritmo de Dong\npara v\u00e1rios volumes de entrada. Observa-se uma grande varia\u00e7\u00e3o, sobretudo\nna etapa de inflar as esferas, e.g., S1 e C1. Achada a evid\u00eancia do poss\u00ed-\nvel problema com a intersec\u00e7\u00e3o que pode ocorrer durante a etapa de busca\nsua complexidade n\u00e3o linear, assume-se a tarefa de achar um algoritmo cujo\nresultado final seja as esferas achadas no esquema no qual as duas esferas\nmaiores n\u00e3o se intersectam e cuja complexidade seja mais linear em fun\u00e7\u00e3o\ndo tamanho do volume de entrada. O mapa de dist\u00e2ncias exatas, tamb\u00e9m\nusada na extra\u00e7\u00e3o r\u00e1pida de rede (FNE) de Schena e Favretto (2006), \u00e9 uma\nposs\u00edvel solu\u00e7\u00e3o.\n\n\n\n55\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1\n\nGera\u00e7\u00e3o da rede\nAglomera\u00e7\u00e3o\nRemo\u00e7\u00e3o de esferas\nInflar esferas\n\n0\n\n100\n\n200\n\n300\n\n400\n\n500\n\nT\nem\n\np\no \n\n(s\n)\n\nVolumes\n\nFigura 16: Tempo total de execu\u00e7\u00e3o, em segundos, discriminando as etapas\ndo algoritmo de Dong e Blunt (2007), para v\u00e1rias entradas\n\n4.1.2 Mapa de dist\u00e2ncias exatas\n\nA transformada de dist\u00e2ncias, sobretudo a de dist\u00e2ncias exatas, \u00e9 um\npr\u00e9-processamento t\u00edpico para o processo de esqueletoniza\u00e7\u00e3o ou extra\u00e7\u00e3o do\neixo m\u00e9dio (FABBRI et al., 2008; SCHENA; FAVRETTO, 2006; SCHENA;\nFAVRETTO; PILLER, 2008). Como entrada para o mapa utiliza-se uma ima-\ngem ou volume inicial, binarizado, onde em preto encontra-se a regi\u00e3o de\nbackground, e em branco a regi\u00e3o de foreground ou vice-versa. \u00c9 poss\u00ed-\nvel extrair-se um mapa cuja m\u00e9trica de dist\u00e2ncia, dependendo do algoritmo,\npode ser qualquer uma escolhida, como a m\u00e9trica euclidiana, proveniente da\ndist\u00e2ncia euclidiana, definida na equa\u00e7\u00e3o 2. Outras m\u00e9tricas poss\u00edveis s\u00e3o\nmanhattan, city block que \u00e9 um caso especial da dist\u00e2ncia de Minkowski,\nMahalanobis, entre outras.\n\nAritm\u00e9tica em ponto flutuante, em cpu, costuma ser mais lenta que\na aritm\u00e9tica inteira. Portanto, a m\u00e9trica de dist\u00e2ncia euclidiana quadr\u00e1tica,\ncujos valores s\u00e3o n\u00fameros inteiros, \u00e9 mais atraente por possuir complexidade\ncomputacional menor. Muitos dos algoritmos s\u00e3o aplic\u00e1veis para ambas as\nm\u00e9tricas (FABBRI et al., 2008).\n\nSaito e Toriwaki (1994) propuseram um algoritmo simples, a n\u00edvel\n\n\n\n56\n\nAlgoritmo 2: Transforma\u00e7\u00e3o 1D no sentido frente, conforme pro-\nposta por Lotufo, Falcao e Zampirolli (2000)\n\nentrada: Fjk a linha de entrada; Z o conjunto de pixels do\nforeground; j a coluna selecionada; k o plano selecionado\n\nsa\u00edda : G jk A linha da coluna j e plano k transformada\nG jk ? Fjk;\nmod ? 1;\nult ? 0;\nfor x = 0 at\u00e9 length(Fi) do\n\nif fx jk ? Z then\nif fx jk > ult + mod then\n\ngx jk ? ult + mod;\nmod ? mod + 2;\n\nelse\nmod ? 1;\n\nult ? fx jk;\nelse\n\nmod ? 1;\nult ? 0;\n\nde entendimento e implementa\u00e7\u00e3o, quando comparado a muitos dos outros\nexistentes. Ele aceita qualquer m\u00e9trica escolhida e possui bom desempenho\ngeral, apesar de sua complexidade te\u00f3rica de O(n3), onde n \u00e9 o tamanho total\nda imagem de entrada (FABBRI et al., 2008). O algoritmo pode ser dividido\ntr\u00eas etapas subsequentes: as varreduras 1D, 2D e a 3D.\n\nA primeira parte do algoritmo \u00e9 o c\u00e1lculo para dist\u00e2ncias 1D. Dado\numa imagem bin\u00e1ria F = { fi jk}, a qual tem R linhas, C colunas e P planos,\ncalcula-se a m\u00e1scara 1D a partir de F , gerando a m\u00e1scara G, da seguinte\nforma:\n\nG = { fi jk} (3)\ngi jk = min{gi jk +( j?y)2; fiyk = 0,1 ? y ?C} (4)\n\nO algoritmo de varredura 1D, utilizando somente somas para calcu-\nlar as dist\u00e2ncias pode ser visto no trabalho de Lotufo, Falcao e Zampirolli\n(2000). O processo \u00e9 visto na figura 17, resultado da aplica\u00e7\u00e3o do algoritmo\n2. Varre-se da esquerda para a direita e da direita para a esquerda em duas\netapas subsequentes, para todas as linhas do volume calculando-se o pr\u00f3ximo\n\n\n\n57\n\nFigura 17: Esferas quadr\u00e1ticas ap\u00f3s a aplica\u00e7\u00e3o da transforma\u00e7\u00e3o 1D, da\nesquerda para direita (figura esq.) e da direita para esquerda (figura dir.)\n\nelemento como um somat\u00f3rio do valor acumulado do elemento anterior. O\nvalor acumulado vira o valor do elemento toda vez que ele \u00e9 menor que o va-\nlor acumulado. Lembra-se que os valores do background s\u00e3o sempre 0 para\no algoritmo. Esses valores correspondem ao espa\u00e7o da rocha, nos volumes\nmicrotomogr\u00e1ficos processados, j\u00e1 que a regi\u00e3o de interesse s\u00e3o exatamente\nos poros ou n\u00e3o rocha.\n\nA transforma\u00e7\u00e3o 2D, por Saito, \u00e9 visualizada na figura 18. Nela, o\nelemento destacado na coluna G est\u00e1 sofrendo uma itera\u00e7\u00e3o do algoritmo\nde Saito e Toriwaki (1994). No algoritmo 3, demonstra-se a aplica\u00e7\u00e3o, no\nsentido frente, do algoritmo de Saito para uma coluna G qualquer. Aplicando-\nse para cada elemento da coluna G, calcula-se uma imagem H, com dist\u00e2ncias\nm\u00ednimas em 2D por um algoritmo de dupla varredura, uma para frente e outra\npara tr\u00e1s. A aplica\u00e7\u00e3o subsequente no sentido oposto transforma G em H.\nMatematicamente:\n\nH = {gi jk} (5)\nhi jk = min{gi jk +(i?x)2; fx jk = 0,1 ? x ? R} (6)\n\nPor fim, a transforma\u00e7\u00e3o 3D \u00e9 feita sobre H, de maneira id\u00eantica a\ntransforma\u00e7\u00e3o 2D, trocando-se apenas a dire\u00e7\u00e3o da busca:\n\n\n\n58\n\nFigura 18: Exemplo de transforma\u00e7\u00e3o do algoritmo de Saito, para uma ite-\nra\u00e7\u00e3o do algoritmo sobre o elemento destacado na coluna G, cujo resultado\nmodifica H\n\nS = {hi jk} (7)\nsi jk = min{hi jk +(k?z)2; fi jz = 0,1 ? z ? P} (8)\n\nFez-se duas implementa\u00e7\u00f5es do algoritmo, uma utilizando multithrea-\nding e outra rodando em apenas uma thread. A estrat\u00e9gia da implementa\u00e7\u00e3o\nmultithread abordada \u00e9 similar a de Torelli et al. (2010), onde o volume de\ndados \u00e9 navegado por voxel, linha e plano, nas transforma\u00e7\u00f5es 1D, 2D e 3D,\nrespectivamente. O objetivo de tal padr\u00e3o de acesso a mem\u00f3ria \u00e9 manter-se\na obten\u00e7\u00e3o dos valores no volume por linha, ou seja, diminuir o overhead da\nrepresenta\u00e7\u00e3o comprimida.\n\nA figura 19 demonstra os resultados de execu\u00e7\u00e3o para v\u00e1rios dados\namostrais, com dados comprimidos ou n\u00e3o. Observa-se as diferen\u00e7as de\ntempo de execu\u00e7\u00e3o n\u00e3o \u00e9 da grandeza esperada para as vers\u00f5es com dados\ncomprimidos ou n\u00e3o. Isso deve-se ao fato da implementa\u00e7\u00e3o do filtro de Saito\nutilizar-se de maneira inteligente dos dados de entrada, acessando-os por li-\nnha para manter-se um desempenho linear, mesmo com dados comprimidos.\n\nOs dados comprimidos provocam uma perda de desempenho signifi-\ncativa, por\u00e9m mesmo para esses o desempenho, do mapa de dist\u00e2ncias exatas,\n\n\n\n59\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1\n\n?\n\n?\n\n? ?\n?\n\n? ?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n0\n\n1\n\n2\n\n3\n\n4\nT\n\nem\np\n\no \n(s\n\n)\n\nVolumes\n\n?\n\nST c/ compress\u00e3o\n\nST s/ compress\u00e3o\n\nMT c/ compress\u00e3o\n\nMT s/\ncompress\u00e3o\n\nFigura 19: Tempos de execu\u00e7\u00e3o para busca de esferas por mapa de dist\u00e2ncias,\nsingle thread (ST) e multithread (MT), em segundos, na m\u00e1quina M1, para os\ndados de entrada em vers\u00f5es comprimidas ou n\u00e3o\n\nAlgoritmo 3: Execu\u00e7\u00e3o no sentido frente do algoritmo de Saito\npara a coluna G\n\nentrada: G a coluna de entrada; R o n\u00famero de linhas no volume\nsa\u00edda : G transformada no sentido frente\nfor i = 0 at\u00e9 R do\n\nif gi jk > g(i?1) jk then\nfor n = 0 at\u00e9 R?i do\n\nif g(i?1) jk +(n + 1)2 &lt;g(i+n) jk then\nh(i+n) jk = g(i?1) jk +(n + 1)\n\n2;\nelse\n\nbreak;\n\nelse\nhi jk = gi jk;\n\n\n\n60\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1\nVolumes\n\nG\nan\n\nh\no \n\nd\ne \n\np\ner\n\nfo\nrm\n\nan\nce\n\n (\nx\n\n)\n\n0\n\n5\n\n8\n\n22\n\n480\n\n?\n\n?\n\n? ?\n\n?\n\n?\n\n?\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nST c/ compress\u00e3o\n\nST s/ compress\u00e3o\n\nMT c/ compress\u00e3o\n\nMT s/\ncompress\u00e3o\n\nFigura 20: Ganho de performance do mapa de dist\u00e2ncias exatas em rela\u00e7\u00e3o\nao algoritmo de inflar esferas de Dong. Escala logar\u00edtmica\n\nem rela\u00e7\u00e3o a inflar esferas \u00e9 de aproximadamente 2 a 455 vezes mais r\u00e1pidos\npara os volumes de entrada, conforme visto na figura 20. Isso d\u00e1-se pelo fato\nde comparar-se implementa\u00e7\u00f5es single thread e multithread e tamb\u00e9m pelo\nalgoritmo de busca de esferas de Dong ser mais sens\u00edvel ao volume de en-\ntrada e a distribui\u00e7\u00e3o do espa\u00e7o poroso, como fica claro em alguns volumes,\ne. g. S5, S6, S9, C1.\n\nO mapa de dist\u00e2ncias exatas, obtido por meio da execu\u00e7\u00e3o do algo-\nritmo de Saito, multithreaded ou n\u00e3o, demonstra-se mais robusto, obtendo\ndesempenhos similares para volumes diversos e variando mais conforme a\ndimens\u00e3o do volume de entrada, demonstrando assim uma linearidade e um\ncomportamento previs\u00edvel, para o caso de volumes de poros. Apesar disso, o\nalgoritmo gera esferas que podem estar contidas em outras e estas precisam\nse n\u00e3o removidas acarretar\u00e3o um processamento desnecess\u00e1rio nas etapas de\naglomera\u00e7\u00e3o e gera\u00e7\u00e3o da rede.\n\n4.2 REMO\u00c7\u00c3O DE ESFERAS\n\nAs esferas resultantes do processo de varredura tem de ser checadas\npor um algoritmo de intersec\u00e7\u00e3o, com poss\u00edveis esferas que estejam contidas\n\n\n\n61\n\nAlgoritmo 4: Descobre se S0 est\u00e1 contido em S1\nentrada: R0 \u00e9 o raio da esfera S0; R1 \u00e9 o raio da esfera S1; C0 \u00e9 o\n\ncentro de S0; C1 \u00e9 o centro de S1\nsa\u00edda : Verdade, se S0 est\u00e1 contido e Falso no caso contr\u00e1rio\nv ?C1 ?C0;\ndist ?\n\n?\ndot(v,v);\n\nrDi f f ? R1 ?R0;\nretorna : dist ? rDi f f ;\n\nnela. Sen\u00e3o, persistem muitas informa\u00e7\u00f5es repetidas nas pr\u00f3ximas etapas do\nalgoritmo, podendo gerar at\u00e9 resultados errados ou alterados para os c\u00e1lculos\nfeitos sobre a rede.\n\nUma maneira de checar-se se uma esfera S0 est\u00e1 contida em outra S1\n\u00e9 verificar se a dist\u00e2ncia entre elas \u00e9 menor que a diferen\u00e7a entre seus raios.\nAssim:\n\ndist(S1,S0)? R1 ?R0 (9)\n\nA partir da equa\u00e7\u00e3o 9, se utiliza-se os raios Rmin e Rmax de Hu Dong,\nconforme descritos na se\u00e7\u00e3o 4.1.1, para intersec\u00e7\u00e3o de duas esferas, observa-\nse que esferas que fisicamente n\u00e3o se intersectariam o fazem. Isso deve-se ao\nfato do valor do raio para Hu Dong ser inteiro e jamais exato.\n\nO algoritmo 4 apresenta em pseudoc\u00f3digo o proposto por Ericson\n(2005), algoritmo que testa se duas esferas est\u00e3o se intersectando segundo\na equa\u00e7\u00e3o 9. As entradas s\u00e3o os centros e os raios de duas esferas S0 e S1 e\nresultado \u00e9 se as S0 est\u00e1 contida ou n\u00e3o. A figura 22 demonstra um exemplo\nonde as esferas a serem removidas est\u00e3o destacadas em cinza escuro.\n\nObserva-se na figura 21 que ganho de desempenho, em vers\u00e3o single\nthread foram piores que o MB original e, mesmo para vers\u00f5es multithreads, o\nganho sobre o MB n\u00e3o foi da mesma grandeza da etapa de busca. Isso deve-\nse ao fato do algoritmo de remo\u00e7\u00e3o de Dong, utilizar os raios em valores\nquadr\u00e1ticos e inteiros para remover as esferas inclusas, enquanto no EMB, a\nintersec\u00e7\u00e3o \u00e9 feita de forma exata, pela convers\u00e3o do raio quadr\u00e1tico inteiro,\nobtido pelo mapa de dist\u00e2ncias quadr\u00e1ticas, para valores exatos, em ponto\nflutuante, conforme demonstrado na figura 15.\n\nA vantagem de manter-se os valores de dist\u00e2ncia quadr\u00e1ticas de forma\ninteira \u00e9 a possibilidade de evitar muitas compara\u00e7\u00f5es em ponto flutuante,\npois se uma esfera \u00e9 menor que uma esfera vizinha, ela n\u00e3o pode remov\u00ea-la.\nMesmo em arquiteturas de cpu modernas, os testes sobre valores inteiros s\u00e3o\nmais r\u00e1pidos do que a compara\u00e7\u00e3o em ponto flutuante. No gr\u00e1fico, parece\n\n\n\n62\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1\nVolumes\n\nT\nem\n\np\no \n\n(s\n)\n\n0\n\n20\n\n40\n\n60\n\n80\n\n100\n\n120\n\n?\n\n?\n\n? ?\n\n?\n\n?\n\n? ?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nST c/ compress\u00e3o\n\nST s/ compress\u00e3o\n\nMT c/ compress\u00e3o\n\nMT s/\ncompress\u00e3o\n\nHu Dong\n\nFigura 21: Tempos de execu\u00e7\u00e3o para a remo\u00e7\u00e3o de esferas contidas em outras\nmaiores\n\nFigura 22: Exemplo de caso de remo\u00e7\u00e3o de esferas\n\n\n\n63\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1\nVolumes\n\n?\n\n?\n\n? ?\n\n?\n\n? ?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n0.0e+00\n\n5.0e+06\n\n1.0e+07\n\n1.5e+07\n\nE\nsf\ner\nas\n\n?\n\nTotais\nRemovidas pelo MB\nRemovidas pelo EMB\n\nFigura 23: Esferas encontradas na etapa de busca e o n\u00famero de esferas re-\nmovidas, por EMB e por MB\n\nque a vers\u00e3o comprimida praticamente n\u00e3o tem overhead em rela\u00e7\u00e3o a raw,\ncontudo isso n\u00e3o \u00e9 verdade. A vers\u00e3o comprimida possui um tratamento es-\npecial, com um algoritmo \u00fanico capaz de mudar a complexidade da itera\u00e7\u00e3o\nsobre as esferas no volume. A modifica\u00e7\u00e3o \u00e9 descrita na se\u00e7\u00e3o 4.5.\n\nFinalmente, tamb\u00e9m \u00e9 poss\u00edvel otimizar a execu\u00e7\u00e3o do algoritmo pela\nordena\u00e7\u00e3o pr\u00e9via das esferas, tal que esferas pequenas, contidas em maiores,\ndeixam de ser processadas. Os raios formam um conjunto finito definido,\npossibilitando a utiliza\u00e7\u00e3o direta do bucket sort (CORWIN; LOGAR, 2004).\n\nDa aplica\u00e7\u00e3o da remo\u00e7\u00e3o, por meio do algoritmo 4, resultam as es-\nferas que passar\u00e3o pela etapa de aglomera\u00e7\u00e3o. Na figura 23, observa-se o\nn\u00famero de esferas totais, achadas no algoritmo MB e EMB, cujos n\u00fameros\niniciais s\u00e3o id\u00eanticos, uma vez que na etapa de busca acha-se o tantas esferas\nquantos voxels no espa\u00e7o poroso. O n\u00famero de esferas removidas pelo MB \u00e9\nbem maior porque, conforme visto na figura 15, o raio das esferas para esse \u00e9\ninteiro e maior que o exato, principalmente para poros grandes. Essa caracte-\nr\u00edstica leva o n\u00famero final de esferas ser bem menor no algoritmo original.\n\n\n\n64\n\nFigura 24: Volume de exemplo e as \u00e1rvores hier\u00e1rquicas geradas para os dois\nporos com uma garganta G1 ligando-os\n\n4.3 AGLOMERA\u00c7\u00c3O\n\nNo passo de aglomera\u00e7\u00e3o ou agrega\u00e7\u00e3o ou ainda aglutina\u00e7\u00e3o, tradu-\n\u00e7\u00f5es v\u00e1lidas de clustering, o algoritmo MB de Dong e Blunt (2007) difere\nbastante do algoritmo de Al-Kharusi e Blunt (2007). Enquanto o \u00faltimo de-\nfine, durante a aglomera\u00e7\u00e3o, uma hierarquia de conjunto de esferas, Dong\ndefine uma hierarquia direta de esferas, onde a esfera raiz \u00e9 um poro. Essa\nmodifica\u00e7\u00e3o foi imposta para reduzir-se drasticamente o uso de mem\u00f3ria que\nlimitava o uso da implementa\u00e7\u00e3o de Al-Kharusi, mesmo para volumes consi-\nderados pequenos, isto \u00e9, com pouco mais de cem voxels de lado. Segundo\nDong e Blunt (2007), a aglomera\u00e7\u00e3o pode ser descrita em cinco passos:\n\n1. Ap\u00f3s a remo\u00e7\u00e3o das esferas inclusas, sobrar\u00e3o um conjunto de esferas\nas quais definem um conjunto finito de raios diferentes. Elas podem ser\nordenadas, novamente por um bucket sort, por exemplo. O resultado \u00e9\no vetor de valores Z, ordenado em fun\u00e7\u00e3o do tamanho do raio.\n\n(a) D\u00e1-se a todas as esferas Si ? Z um rank infinito. Esse \u00e9 definido,\npara fins de implementa\u00e7\u00e3o, como o maior valor inteiro represen-\nt\u00e1vel no tamanho de palavra da cpu alvo.\n\n2. Come\u00e7ando-se pela primeira esfera S0, do maior conjunto de raios, Z0,\n\n\n\n65\n\ndefine-se o rank dela como sendo a primeira e um novo nome de fam\u00edlia\n\u00e9 gerado e dado a essa esfera. Cada esfera Si que intersecte com ela\nrecebe o rank de segunda gera\u00e7\u00e3o. Ainda assim, a esfera recebe o nome\nde fam\u00edlia de S0. Cada esfera sabe quem \u00e9 seu ancestral, mesmo que\nseja nenhum, como no caso da primeira.\n\n3. Ordena-se ent\u00e3o, novamente o conjunto de esferas de mesmo raio, com\nos ranks atualizados pela etapa anterior, do menor para o maior. Para\ncada esfera Si que ainda n\u00e3o foi visitada, verifica-se se ela j\u00e1 foi visitada\npelo seu rank. Se ela n\u00e3o foi, define-se o rank dela como sendo a\nprimeira e repete-se a etapa 2 para ela. Se ela foi visitada, ent\u00e3o ela\nverifica as esferas que intersectam com Si, definidas como o conjunto\nC j , e passa-se o nome de fam\u00edlia para elas obtido da esfera raiz (poro).\n\n(a) Se alguma esfera S j ?C j j\u00e1 possui um nome de fam\u00edlia diferente\ndo nome da Si, ent\u00e3o essa esfera S j define uma garganta e duas\ncadeias de esferas ser\u00e3o extra\u00eddas a partir dela, uma ligando at\u00e9 o\nancestral de Si e outra ligando ao ancestral j\u00e1 existente de S j .\n\n4. O mesmo processo de ordena\u00e7\u00e3o \u00e9 feito at\u00e9 que todas as esferas do con-\njunto Zi sejam processadas. Ap\u00f3s serem visitadas todas as esferas do\nconjunto Zi, come\u00e7a-se novamente o processo, visitando-se as esferas\ndo conjunto Zi+1.\n\n5. Os mesmos processos de ordena\u00e7\u00e3o e aglomera\u00e7\u00e3o s\u00e3o aplicados para\ntodos os conjuntos Zi ? Z.\n\nA expans\u00e3o das gargantas \u00e9 uma das etapas chaves do MB, uma vez que\n\u00e9 gra\u00e7as a ela que a geometria correta da rede \u00e9 extra\u00edda. Nessa etapa, ao\nencontrar-se uma esfera que pertence a garganta, efetua-se o crescimento da\nregi\u00e3o de garganta em dire\u00e7\u00e3o aos dois poros envolvidos.\n\nO fator percentual E f , define a raz\u00e3o entre o raio da maior esfera a ser\nenglobada na garganta e pode ser descrito, tal que se a raz\u00e3o r for menor que\nE f , ent\u00e3o a esfera \u00e9 garganta. Para tr\u00eas esferas, a garganta Sg, de raio Rg, a\nesfera poro Sp, de raio Rp e uma esfera Si, de raio Ri, a raz\u00e3o \u00e9 dada por:\n\nr =\nRi\n\nRP ?Rg\n(10)\n\nAssim, se r for menor que E f , ent\u00e3o a esfera Si faz parte da garganta e\nsua ancestral \u00e9 analisada, at\u00e9 que a raz\u00e3o r seja maior ou igual a E f ou que a\nesfera analisada fa\u00e7a parte de um poro. Para toda esfera Si cujo fator \u00e9 maior\nque E f na cadeia, essa esfera torna-se parte do poro.\n\n\n\n66\n\nFigura 25: Expans\u00e3o de gargantas, conforme proposto por Dong. Nesse caso,\no fator E f de expans\u00e3o \u00e9 de 70%\n\nA figura 25, demonstra a expans\u00e3o de uma garganta a partir da desco-\nberta esfera que pertence, ao mesmo tempo, a duas fam\u00edlias diferentes. Todas\nas esferas at\u00e9 o ponto de parada far\u00e3o parte da garganta e se tornar\u00e3o parte\nda regi\u00e3o definida por essa. Dong e Blunt (2007) assumiram um fator de ex-\npans\u00e3o E f igual a 70% \u00e9 o ponto de parada para o algoritmo de expans\u00e3o.\nNota-se que na figura a expans\u00e3o parou na esfera com raio sete, uma vez que\nr = 7\u00f7(14?4) = 0,7.\n\nChecou-se que o fator de expans\u00e3o de Dong foi definido analitica-\nmente em fun\u00e7\u00e3o de resultados amostrais de press\u00e3o capilar (DONG; BLUNT,\n2007, 2009). Como at\u00e9 ent\u00e3o, o EMB difere bastante do MB, sobretudo no\nvolume de esferas processadas durante a aglomera\u00e7\u00e3o, decidiu-se utilizar v\u00e1-\nrios fatores diferentes, os quais ser\u00e3o vistos no cap\u00edtulo 5 e, espera-se gerar\nresultados bastante diferentes, uma vez que o volume, a \u00e1rea e a geometria\ndos poros e gargantas influenciam diretamente no c\u00e1lculo de transporte e nas\npropriedades da rede.\n\nUma vez aplicado o algoritmo sobre as esferas, os resultados finais s\u00e3o\nesferas que definem o espa\u00e7o poroso como garganta, poro ou indefinido. A\nfigura 24 demonstra uma amostra com suas esferas j\u00e1 definidas. Os poros P1 e\nP2 s\u00e3o ligados pela garganta G1, enquanto as esferas em cinza fazem parte do\nvolume poroso de cada uma. Ambas as hierarquias relativas aos dois poros\ns\u00e3o demonstradas abaixo da amostra.\n\nO n\u00famero de esferas geradas no EMB e no MB est\u00e3o na figura 26.\nNota-se que o EMB tende a gerar mais poros e gargantas que o MB, mesmo\n\n\n\n67\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1\nVolumes\n\n?\n\n?\n\n?\n\n?\n\n?\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n0\n\n5000\n\n10000\n\n15000\n\n20000\nE\nle\nm\ne\nn\nto\ns\n\n?\n\nPoros (MB)\nGargantas (MB)\nPoros (EMB)\nGargantas (EMB)\n\nFigura 26: N\u00famero de poros e gargantas gerados pelo MB e pelo EMB\n\nque em propor\u00e7\u00f5es parecidas. Isso deve-se ao fato de mais esferas permane-\ncerem no EMB ap\u00f3s a etapa de remo\u00e7\u00e3o, gra\u00e7as ao algoritmo de intersec\u00e7\u00e3o\nser diferente no EMB. No cap\u00edtulo 5, tem-se a descri\u00e7\u00e3o extensiva dos resul-\ntados para as amostras de entrada e essa ideia \u00e9 trazida com mais informa\u00e7\u00f5es\nque formam um plano de fundo para o entendimento das diferen\u00e7as entre as\nt\u00e9cnicas.\n\nFinalmente, os poros e gargantas podem gerar a rede para ser ob-\nservada visualmente e os dados petrof\u00edsicos e estat\u00edsticos podem ser extra\u00ed-\ndos por meio dela. Contudo o n\u00famero de poros indefinidos ainda pode ser\ngrande, sem um p\u00f3s-processamento adequado sobre o espa\u00e7o poroso. Esse\np\u00f3s-processamento \u00e9 definido na etapa de gera\u00e7\u00e3o da rede de poros e gargan-\ntas.\n\n4.4 GERA\u00c7\u00c3O DA RP\n\nAp\u00f3s a aglomera\u00e7\u00e3o, tem-se quais esferas fazem parte do poro e gar-\nganta. As esferas restantes tem de ser caracterizadas como sendo poro, gar-\nganta ou voxel inv\u00e1lido. Essas etapas de p\u00f3s-processamento refinam o re-\nsultado da aglomera\u00e7\u00e3o e s\u00e3o, curiosamente, pouco discutidas nos traba-\n\n\n\n68\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1\n\nVolumes\n\n?\n\n?\n\n?\n\n?\n\n?\n\n? ?\n\n?\n\n? ?\n?\n\n?\n\n?\n\n?\n\n0.00\n\n0.02\n\n0.04\n\n0.06\n\n0.08\n\nP\nor\n\nce\nn\n\nta\ng\n\nem\n (\n\n%\n)\n\n?\n\nVoxels inv\u00e1lidos (MB)\n\nVoxels inv\u00e1lidos (EMB)\n\nFigura 27: Porcentagem de voxels inv\u00e1lidos, em rela\u00e7\u00e3o ao total de voxels,\nno final do processo para ambos os algoritmos de esferas m\u00e1ximas\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1\n\nVolumes\n\n? ?\n\n?\n\n?\n\n?\n\n?\n\n?\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n0\n\n100\n\n200\n\n300\n\n400\n\nE\nle\nm\ne\nn\nto\ns\n\n?\n\nInlets (MB)\n\nOutlets (MB)\n\nInlets (EMB)\n\nOutlets (EMB)\n\nFigura 28: N\u00famero de inlets e outlets gerados pelo MB e pelo EMB\n\n\n\n69\n\nlhos de esferas m\u00e1ximas anteriores (AL-KHARUSI; BLUNT, 2007; DONG;\nBLUNT, 2009, 2007). No fim da aglomera\u00e7\u00e3o, \u00e9 poss\u00edvel que hajam esferas\nem regi\u00f5es de garganta, que se reprocessadas fariam parte dela. Isso \u00e9, essas\nesferas foram processadas antes de uma de suas vizinhas fazerem parte da\nregi\u00e3o de garganta.\n\nA fim de eliminar grande parte das esferas indefinidas, percorre-se\nas esferas que definam gargantas, em ordem de grandeza, achando esferas\nindefinidas que essas intersectem com. Essas esferas s\u00e3o definidas como per-\ntencentes a mesma regi\u00e3o de garganta. Ap\u00f3s essa passada, tem-se uma se-\ngunda que define as esferas processadas restantes como sendo parte do poro.\nPor fim, tem-se todas as esferas v\u00e1lidas identificadas como poro ou garganta.\nIdealmente, todas as esferas encontradas contribuiriam para defini\u00e7\u00e3o da RP,\npor\u00e9m a irregularidade de alguns volumes e pequenas ilhas de poros descone-\nxas. Isso pode ser frutos de filtragens fracas ou incompletas e a consequ\u00eancia\n\u00e9 que parte dos dos voxels pertencentes ao poro sejam invalidados, ou seja,\nsuas esferas representativas s\u00e3o inv\u00e1lidas.\n\nAs esferas inv\u00e1lidas s\u00e3o todas aquelas cujos raios s\u00e3o menores que o\nraio m\u00ednimo para ser poro e n\u00e3o intersectam com nenhuma esfera que faz\nparte do conjunto de poros e/ou gargantas. O gr\u00e1fico da figura 27, demons-\ntra o n\u00famero de voxels (e esferas) inv\u00e1lidos para v\u00e1rios volumes, no MB e\nEMB. V\u00ea-se que o n\u00famero de voxels inv\u00e1lidos ao final do algoritmo EMB\n\u00e9 maior que no MB. Uma poss\u00edvel explica\u00e7\u00e3o \u00e9, novamente, o algoritmo de\nintersec\u00e7\u00e3o de esferas, uma vez que \u00e9 poss\u00edvel ele retornar esferas isoladas\nfisicamente como intersectantes, deixando menos esferas isoladas.\n\nNo trabalho de Dong e Blunt (2007), esferas cujos raios s\u00e3o menor\nque o m\u00ednimo permitido n\u00e3o sejam processadas, e portanto invalidadas se n\u00e3o\nforem intersectadas por outras. Isso faz com que trechos estreitos do espa\u00e7o\nporoso, conforme o da figura 15, possam configurar um problema. Contudo,\nos valores s\u00e3o pequenos para o EMB e MB, isso deve-se ao fato do p\u00f3s-\nprocessamento da rede gerada na aglomera\u00e7\u00e3o, comentado anteriormente, e\ntamb\u00e9m pela configura\u00e7\u00e3o citada ser pouco comum no espa\u00e7o poroso. Assim,\nmesmo que o EMB tenha uma quantidade maior de voxels inv\u00e1lidos, ambos\nvalores s\u00e3o bastante pequenos.\n\nPor \u00faltimo, define-se quais elementos fazem parte dos inlets e outlets.\nEm Al-Kharusi e Blunt (2007), os inlets e outlets s\u00e3o definidos como os poros\ncuja posi\u00e7\u00e3o no eixo de extra\u00e7\u00e3o seja inferior a 10% ou superior a 90% da\nmagnitude do eixo, para inlets e outlets, respectivamente. Isso, desde que\ncom a adi\u00e7\u00e3o desse elemento ao conjunto referente, esse n\u00e3o ultrapasse 25%\ndo n\u00famero total de poros. A figura 29 ilustra a defini\u00e7\u00e3o de inlets num eixo\nde c\u00e1lculo arbitr\u00e1rio, segundo a defini\u00e7\u00e3o de Al-Kharusi.\n\nNo trabalho de Dong e Blunt (2007), define-se que os inlets e outlets\n\n\n\n70\n\nFigura 29: Defini\u00e7\u00e3o de inlets (esq.) e outlets (dir.), conforme proposto por\nAl-Kharusi e Blunt (2007)\n\ns\u00e3o aqueles poros que possuem liga\u00e7\u00e3o direta com a borda do volume no eixo\nde interesse. Essa mesma defini\u00e7\u00e3o \u00e9 v\u00e1lida no EMB porque assim obt\u00e9m-\nse uma representa\u00e7\u00e3o mais baseada na topologia e conectividade do espa\u00e7o\nporoso real. Tamb\u00e9m, a defini\u00e7\u00e3o de Al-Kharusi era v\u00e1lida para volumes\nde tamanho pequeno e talvez n\u00e3o possua a mesma validade para volumes\nmaiores.\n\n4.5 ESTRUTURAS COMPRIMIDAS\n\nAs estruturas que armazenam o volume de esferas a partir da etapa\nde busca e remo\u00e7\u00e3o das esferas possuem um tipo de compress\u00e3o de dados\nsimilar a compress\u00e3o sobre o volume RLE, do cap\u00edtulo 3. Essas estruturas, ao\ninv\u00e9s de armazenarem um dado por valor de voxel, armazenam somente os\nvalores relativos aos voxels representativos do espa\u00e7o poroso. Isso \u00e9, utiliza-\nse o mesmo tipo de compress\u00e3o por segmentos, apresentado no RLE, por\u00e9m\naplicado a dados n\u00e3o binarizados.\n\nA efici\u00eancia final da compress\u00e3o, depende diretamente da porosidade,\ndefinida na equa\u00e7\u00e3o 1. Sendo n o n\u00famero de elementos de tamanho t, o espa\u00e7o\ntotal ocupado pela estrutura comprimida \u00e9 o tamanho total, n\u00d7t, multiplicado\n\n\n\n71\n\nAlgoritmo 5: Obt\u00e9m todos os valores de uma linha do volume,\niterando por segmento\n\nentrada: V \u00e9 o conjunto de segmentos da linha de interesse, com\nos valores dos dados; d \u00e9 o vetor de sa\u00edda com um valor\npor voxel\n\nsa\u00edda : O vetor d com os valores da linha de interesse\nfor i = 0 at\u00e9 i ? length(d) do\n\n/*Todas posi\u00e7\u00f5es s\u00e3o inicializadas com valores\n\nnulos */\n\nd[i]? ? ;\nfor v ?V do\n\nfor i = v.begin at\u00e9 i &lt;v.end do\nd[i]? v.d[i?v.begin];\n\npela pr\u00f3pria porosidade P.\nComo, em geral, os volumes apresentam porosidades menor que 50%,\n\nas taxas de compress\u00e3o s\u00e3o bastante interessantes. Contudo, ainda existe,\ncomo no RBV, o overhead da etapa de busca do valor. Isso \u00e9, a complexidade\nda busca de um pixel qualquer \u00e9 log n, para uma linha de tamanho n.\n\n\u00c9 poss\u00edvel, assim como na busca de valores por linha, trazer a perfor-\nmance mais pr\u00f3xima de dados n\u00e3o comprimidos. Para uma busca qualquer,\npode-se obter o segmento relativo a essa busca e iterar os valores vizinhos, na\nlinha, em fun\u00e7\u00e3o do segmento atual.\n\nO algoritmo 5 ilustra a itera\u00e7\u00e3o por segmentos ao inv\u00e9s de obter-se\nindividualmente cada valor de pixel. Assim, tem-se uma complexidade O(n),\npor\u00e9m, como nem sempre os algoritmos iteram sobre uma linha inteira, pode-\nse fazer obter o elemento inicial em tempo log(n) e repetir o processo de\nitera\u00e7\u00e3o de segmentos at\u00e9 o fim do intervalo desejado. Isso \u00e9, a complexidade\nfinal de uma busca, por linha, para n elementos torna-se O(log n + n) ao inv\u00e9s\nde O(n log n), que \u00e9 mais pr\u00f3ximo do O(n) original. A contrapartida dessa\nt\u00e9cnica \u00e9 a necessidade de passar um vetor do tamanho da linha do volume,\nou seja, h\u00e1 um consumo maior de mem\u00f3ria.\n\n4.6 CONCLUS\u00c3O\n\nNesse cap\u00edtulo, definiu-se as diferen\u00e7as b\u00e1sicas do MB em rela\u00e7\u00e3o a\noutros algoritmos e, ademais, do MB e EMB. Observa-se que a altera\u00e7\u00e3o\ndo m\u00e9todo de intersec\u00e7\u00e3o para esferas afeta bastante o resultado final da RP.\n\n\n\n72\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1\n\nGera\u00e7\u00e3o da rede\nAglomera\u00e7\u00e3o\nRemo\u00e7\u00e3o de esferas\nMapa de dist\u00e2ncias\n\n0\n\n20\n\n40\n\n60\n\n80\n\n100\n\n120\n\nT\nem\n\np\no \n\n(s\n)\n\nVolumes\n\nFigura 30: Tempo levado, em cada etapa do EMB, para volumes diversos. O\nFator E f de expans\u00e3o \u00e9 50%\n\nNa figura 23, tem-se o n\u00famero de esferas totais e removidas em ambos. O\nn\u00famero de esferas remanescentes no EMB \u00e9 bem maior que no MB o que\nafeta diretamente o resultado da rede, na figura 26, onde o n\u00famero de poros e\ngargantas no EMB \u00e9 constantemente maior que no MB.\n\nAo analisar-se a rede gerada pelos algoritmos, o MB apresente, em\ngeral, poros e gargantas maiores, mas o volume poroso representado por am-\nbas deve ser o mesmo. Portanto, espera-se que os resultados de c\u00e1lculo de\npermeabilidade absoluta e o fator de forma sejam diferentes para ambos, no\ncap\u00edtulo 5. O que \u00e9 observado \u00e9 uma semelhan\u00e7a, principalmente na perme-\nabilidade absoluta, por\u00e9m uma discord\u00e2ncia quanto ao fator de forma, com\ntend\u00eancias diferentes.\n\nA vari\u00e1vel E f para o MB original \u00e9 70%. Decidiu-se que esse valor\npoderia n\u00e3o ser o melhor poss\u00edvel, j\u00e1 que o EMB apresenta mais esferas e di-\nfere, mesmo em n\u00famero de poros e gargantas, em rela\u00e7\u00e3o ao MB. Os valores\nde fator de expans\u00e3o 50%, 60%, 70% e 80% s\u00e3o assumidos nesse trabalho\npara ter-se uma amostra significativa que possibilite o estudo de um melhor\nvalor poss\u00edvel para ele. As figuras 30, e 31 demonstram o tempo de execu\u00e7\u00e3o\ntotal para cada volume de entrada, e o tempo relativo, levado em cada etapa.\n\nAs etapas do algoritmo, n\u00e3o variam muito, relativamente as outras com\na mudan\u00e7a do fator de escala, somente a etapa de gera\u00e7\u00e3o da rede que torna-\n\n\n\n73\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1\n\nGera\u00e7\u00e3o da rede\nAglomera\u00e7\u00e3o\nRemo\u00e7\u00e3o de esferas\nMapa de dist\u00e2ncias\n\n0\n\n20\n\n40\n\n60\n\n80\n\n100\n\n120\nT\n\nem\np\n\no \n(s\n\n)\n\nVolumes\n\nFigura 31: Tempo levado, em cada etapa do EMB, para volumes diversos. O\nFator E f de expans\u00e3o \u00e9 80%\n\nse mais custosa porque com um fator de expans\u00e3o maior, mais esferas s\u00e3o\ngargantas e tem de ser p\u00f3s-processadas. O tempo total, cresce em fun\u00e7\u00e3o do\nfator de expans\u00e3o e tem seu \u00e1pice no carbonato C1, variando de 120 segundos,\npara E f igual a 50% e 60%, at\u00e9 aproximadamente 140, nos fatores 70% e\n80%.\n\nA varia\u00e7\u00e3o, quase que linear, do tempo levado em fun\u00e7\u00e3o da varia\u00e7\u00e3o\nde E f , caracteriza a robustez atingida com o EMB. No MB, a varia\u00e7\u00e3o, so-\nbretudo na etapa de inflar esferas, faz com que o tempo levado seja bastante\ndiferente para diversos volumes de entrada. Tamb\u00e9m, para os v\u00e1rios volu-\nmes de entrada, os tempos totais do algoritmo EMB s\u00e3o bem menores que o\nMB. Isso deve-se ao fato do conjunto de t\u00e9cnicas de acelera\u00e7\u00e3o de para dados\ncomprimidos aplicados na implementa\u00e7\u00e3o e tamb\u00e9m pelo fato de v\u00e1rios algo-\nritmos, principalmente a aglomera\u00e7\u00e3o, serem paralelos. Essa \u00faltima \u00e9 a etapa\nmais custosa do EMB e algumas estrat\u00e9gias para reduzir seu tempo total de\nexecu\u00e7\u00e3o s\u00e3o discutidas no cap\u00edtulo 6.\n\nConseguiu-se ter um desempenho superior ao MB, cujos tempos de\ngera\u00e7\u00e3o est\u00e3o na figura 16. Mesmo que as diferen\u00e7as no EMB fa\u00e7am com\nque mais esferas tenham de ser processadas, manteve-se um dos objetivos\ndeste trabalho porque o tempo total de execu\u00e7\u00e3o para o EMB foi, em todos\nos casos, menor que o MB. Resta apenas descobrir os impactos do algoritmo\n\n\n\n74\n\nsobre as propriedades e os c\u00e1lculos feitos sobre a rede.\n\n\n\n75\n\n5 PROPRIEDADES DA REDE E C\u00c1LCULOS DE TRANSPORTE\n\nNesse cap\u00edtulo, s\u00e3o abordados as propriedades da rede reconstru\u00edda\npela t\u00e9cnica EMB, relacionando-as diretamente com as propriedades da rede\nMB, de Hu Dong. Inicialmente, ser\u00e1 feita uma compara\u00e7\u00e3o lado-a-lado para\num volume amostral de arenito e o mesmo para um volume de rocha se-\ndimentar carbon\u00e1tica. Em sequ\u00eancia, ser\u00e3o descritos os valores gerais e as\npropriedades para v\u00e1rias redes diferentes.\n\nNa segunda parte, ser\u00e3o abordadas a previs\u00e3o de transporte referente\nas redes, com os valores de permeabilidade absoluta e fator de forma para as\nredes EMB e MB.\n\nTodos os valores extra\u00eddos foram a partir do resultado do simulador\ntwo phase proposto por Valvatne. O algoritmo MB, de Dong e Blunt (2007),\nn\u00e3o foi capaz de gerar todas as redes a partir dos volumes iniciais. Tamb\u00e9m,\nos resultados para as redes que foram testadas n\u00e3o foram id\u00eanticos aos da tese\nem quest\u00e3o. Assim, assume-se que o problema sejam as vari\u00e1veis de entrada.\n\nComo o two phase possui muitas combina\u00e7\u00f5es de configura\u00e7\u00e3o e mesmo\npara ele, os resultados variam de acordo com as bibliotecas matem\u00e1ticas da\nplataforma, diferentes em Windows e Linux, e causam diferen\u00e7as nos resul-\ntados. Pelo fato de os dados de entrada do two phase n\u00e3o terem sido definidos\npor Dong e Blunt (2007) foi imposs\u00edvel tentar produzir os mesmos resulta-\ndos. Mesmo assim, no final do cap\u00edtulo \u00e9 feita uma compara\u00e7\u00e3o direta com\nos resultados da tese em quest\u00e3o. Lembra-se que o valor do fator de expans\u00e3o\npara o MB \u00e9 sempre 70%, conforme descrito no cap\u00edtulo 4.\n\nAs configura\u00e7\u00f5es utilizadas para o two phase e o MB de Dong, neste\ntrabalho, encontram-se nos anexos, cap\u00edtulo 7. Entre as in\u00fameras vari\u00e1veis\ndescritas est\u00e3o a viscosidade dos fluidos envolvidos e press\u00f5es de entrada\ne sa\u00edda. Esses par\u00e2metros s\u00e3o para uma simula\u00e7\u00e3o multif\u00e1sica, mesmo que\nos valores abordados neste cap\u00edtulo sejam somente relacionados a vari\u00e1veis\nmonof\u00e1sicas.\n\n5.1 ESTUDO DE CASO S1\n\nO volume S1, visualizado na figura 32, \u00e9 interessante para estudo, uma\nvez que \u00e9 um volume pequeno, de dimens\u00e3o 3003, com tempo de gera\u00e7\u00e3o da\nrede pequeno e propriedades bem definidas. Na tese de Dong e Blunt (2007),\nvalores amostrais para esse rede s\u00e3o determinados, em compara\u00e7\u00e3o com Oren\ne Bakke (2002). Tamb\u00e9m, o algoritmo MB gerou redes, em alguns casos, que\nn\u00e3o foram poss\u00edveis de rodar na implementa\u00e7\u00e3o de Valvatne, na m\u00e1quina M1.\n\n\n\n76\n\nEMB MB\nPorosidade da rede 14.1 14.1\nN de poros 2794.0 1868.0\nN de gargantas 4371.0 3048.0\nN de inlets 117.0 85.0\nN de outlets 149.0 124.0\nN de isolados 173.0 138.0\nElementos circulares 43.0 0.0\nElementos quadrados 65.0 19.0\nElementos triangulares 7059.0 4899.0\n\nTabela 3: Caracter\u00edsticas da RP, no EMB e MB, para o volume S1\n\nFigura 32: Rede gerada pelo EMB para o volume S1\n\n\n\n77\n\nNesse trabalho, ser\u00e1 feita uma compara\u00e7\u00e3o direta de valores amostrais\npara o EMB e o MB, ao mesmo tempo introduzindo diferentes vari\u00e1veis es-\ntat\u00edsticas de compara\u00e7\u00e3o.\n\nNa tabela 3, est\u00e3o os valores absolutos para v\u00e1rias vari\u00e1veis da RP nos\ndois casos. A porosidade da rede \u00e9 a porosidade obtida pela soma dos volu-\nmes de poros e gargantas dividido pelo volume total. Pelo fato do n\u00famero de\nvoxels inv\u00e1lidos variar, a porosidade da rede tamb\u00e9m n\u00e3o \u00e9 sempre a mesma\nda real, mas nessa RP o valor foi id\u00eantico para o MB e o EMB com uma casa\nde precis\u00e3o.\n\nNa rede gerada pelo EMB o n\u00famero de poros \u00e9 2794, enquanto na\nrede gerada pelo MB \u00e9 1868, ou seja, o EMB gera 50% poros a mais. Afim\nde comparar-se as popula\u00e7\u00f5es de poros em ambos os algoritmos, utilizou-se a\nestrat\u00e9gia de normalizar as popula\u00e7\u00f5es em fun\u00e7\u00e3o do n\u00famero total de poros.\nAssim, tem-se uma compara\u00e7\u00e3o direta da distribui\u00e7\u00e3o dos raios de poros para\nambos os resultados.\n\nO n\u00famero de gargantas geradas no EMB \u00e9 4371, enquanto no MB \u00e9 de\n3048. A propor\u00e7\u00e3o de poros em rela\u00e7\u00e3o a gargantas em ambos \u00e9 por volta de\n60%, caracterizando a dissimilaridade no resultado de ambas. Ainda assim, o\nEMB gera mais de 40% de gargantas a mais, gra\u00e7as as modifica\u00e7\u00f5es descritas\nno cap\u00edtulo 4.\n\nDefine-se os inlets e outlets conforme o trabalho de Dong e Blunt\n(2007), onde a partir de poros que encostam na borda criam-se novas gar-\ngantas, conforme descrito na se\u00e7\u00e3o 4.4. Os n\u00fameros foram novamente dissi-\nmilares, 117 inlets e 149 outlets na rede do EMB e 85 inlets e 124 outlets na\nrede do MB. Nesse caso, gerou-se mais inlets e outlets no EMB, apesar de\nn\u00e3o ser sempre o observado, como nota-se na figura 28.\n\nElementos isolados, para o simulador two phase, s\u00e3o aqueles elemen-\ntos que n\u00e3o possuem, simultaneamente, liga\u00e7\u00e3o com o inlets e outlets. Na\nRP do EMB constatou-se 173 desses poros enquanto na RP do MB foram\n138, ou seja, o primeiro gerou aproximadamente 25% de elementos isolados\na mais. Ou seja, nesse caso, a rede do EMB possui mais poros e esses s\u00e3o\nmais conexos, percentualmente uma vez que, como j\u00e1 constatado, essa rede\ntem 50% de poros a mais que a do MB.\n\nNa tabela 3, define-se os valores para elementos circulares, quadrados\ne triangulares. O n\u00famero de elementos triangulares \u00e9 maior para as duas\nredes, contudo para a rede do MB, o n\u00famero de elementos circulares chega a\nzero e a propor\u00e7\u00e3o de elementos triangulares \u00e9 bem maior, chegando a mais\nde 99%. Esse fato ser\u00e1 abordado na se\u00e7\u00e3o 5.5.1.\n\n\n\n78\n\n1 2 3 4 5 6 7 8 9 10 12 14 16 18 20 22\n\nMB\n\nEMB\n\n0\n\n5\n\n10\n\n15\n\n20\n\n25\n\n30\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nN\u00famero de coordena\u00e7\u00e3o\n\nFigura 33: Frequ\u00eancia do n\u00famero de coordena\u00e7\u00e3o nos algoritmos EMB e MB\npara o volume S1\n\n5.1.1 N\u00famero de coordena\u00e7\u00e3o\n\nO n\u00famero de coordena\u00e7\u00e3o \u00e9 uma vari\u00e1vel tipicamente utilizada em\ncaracteriza\u00e7\u00e3o at\u00f4mica de materiais. \u00c9, para a rede de de poros, uma proprie-\ndade importante por denotar a conectividade interna da rede, isso \u00e9, o quanto\nos poros internos da rede encontram-se conectados. O n\u00famero de coordena-\n\u00e7\u00e3o para um poro qualquer \u00e9 o n\u00famero de gargantas que ligam ele a outro\nporo.\n\nA figura 33 apresenta as frequ\u00eancias percentuais do n\u00famero de coor-\ndena\u00e7\u00e3o no volume S1, para todos os poros da RP. O MB parece apresentar\nmaiores frequ\u00eancias em n\u00fameros de coordena\u00e7\u00e3o maiores e nos poros com\napenas uma conex\u00e3o. Nota-se uma grande concentra\u00e7\u00e3o de uma a quatro co-\nnex\u00f5es, representando em ambos os casos mais de 70% do total de poros.\n\nPelo fato de muitos poros pequenos terem sido removidos a mais na\netapa de remo\u00e7\u00e3o de esferas inclusas em outras, graficamente apresentado na\nfigura 21, sobram mais poros maiores, mais bem conectados que os poros\npequenos e desconexos remanescentes. Assim, esse resultado talvez seja pro-\nveniente das diferen\u00e7as entre nas intersec\u00e7\u00f5es esfera-esfera entre o EMB e\nMB. Tamb\u00e9m, como os valores s\u00e3o em frequ\u00eancia, os poros maiores no EMB\n\n\n\n79\n\n12 25 37 50 62 75 87 100 124 149 174 199\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\n0\n\n10\n\n20\n\n30\n\n40\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nRaio (micrometros)\n\nFigura 34: Distribui\u00e7\u00e3o de raios de poros para ambos algoritmos. Fatores de\nexpans\u00e3o 50%, 60%, 70% e 80% para o EMB\n\nficam obscurecidos pelo maior n\u00famero total de poros, quando comparado ao\nMB.\n\nApesar de interessantes, os n\u00fameros de coordena\u00e7\u00e3o do S1 n\u00e3o s\u00e3o\nsuficientes para extrair-se dados conclusivos. Faz-se necess\u00e1rio um estudo\nmais profundo, com mais dados do mesmo volume e outros, principalmente\ncom volumes maiores e de diferentes resolu\u00e7\u00f5es.\n\n5.1.2 Poros\n\nSendo Rv o raio extra\u00eddo do volume esf\u00e9rico total do poro, definido em\nfun\u00e7\u00e3o do volume Vp, em voxels do poro. O raio R do poro \u00e9 id\u00eantico a Rv, o\nqual \u00e9 definido por:\n\nRv =\n3\n\n?\nVp ?\n\n3\n4?\n\n(1)\n\nNa figura 34, tem-se as distribui\u00e7\u00f5es percentuais de faixas de raios do\nMB e do EMB, para os fatores de expans\u00e3o 50% e 80%, respectivamente.\nAs faixas 60% e 70% foram omitidas por serem demasiadamente id\u00eanticas as\n\n\n\n80\n\n198051 594152 990253 1386354 1782455 2178556 2574657 2970758\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nVolume (micrometros c\u00fabicos)\n\nFigura 35: Frequ\u00eancia dos volumes dos poros para as redes EMB e MB do\nvolume S1. A \u00faltima faixa engloba todos os valores maiores que quatro vezes\na m\u00e9dia\n\nduas apresentadas.\nObserva-se que no MB os poros est\u00e3o altamente concentrados em va-\n\nlores menores que 50 micr\u00f4metros, uma vez que mais de 70% dos poros\npossuem raios dentro desse limite. Tamb\u00e9m, raios maiores que 100 micr\u00f4-\nmetros s\u00e3o praticamente inexistentes para o MB. Em contraste, no EMB os\nvalores encontram-se menos concentrados em valores pequenos e bem mais\ndistribu\u00eddos variando bem pouco em fun\u00e7\u00e3o do fator de expans\u00e3o de gargantas\nutilizado.\n\nComo os poros apresentam uma distribui\u00e7\u00e3o mais acentuada em valo-\nres de raio alto no EMB, e uma menor popula\u00e7\u00e3o em valores baixos, acredita-\nse que a regularidade e a baixa quantidade de poros pequenos foram bem\nextra\u00eddas do volume aren\u00edtico. Ou seja, a rede EMB caracteriza os poros em\nvolumes aren\u00edticos adequadamente.\n\nPara fatores de expans\u00e3o maiores, no EMB, os valores encontram-se\nlevemente mais concentrados nas faixas menores de raio. Ainda assim, visu-\nalmente, a distribui\u00e7\u00e3o dos raios \u00e9 quase id\u00eantica. Isso deve-se ao fato de, em\ngeral, o volume do poro ser pouco afetado pela taxa de expans\u00e3o. Nas gar-\ngantas, os fatores de expans\u00e3o tem impactos bem maiores porque influenciam\ndiretamente o comprimento e a distribui\u00e7\u00e3o desses sobre a RP.\n\n\n\n81\n\n34 68 102 170 238 305 373 441 509\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nComprimento (micrometros)\n\nFigura 36: Distribui\u00e7\u00e3o de comprimentos das gargantas para ambos algorit-\nmos no S1. Fatores de expans\u00e3o 50%, 60%, 70% e 80% para o EMB\n\n5.1.3 Gargantas\n\nO comprimento de uma garganta \u00e9 definido como a dist\u00e2ncia entre as\ninterfaces de poro, isso \u00e9, para uma garganta qualquer:\n\nc = dist(S1,S0)?R1 ?R0 (2)\n\nOnde S1 e S0 s\u00e3o as esferas conectadas pela garganta e R1 e R0 seus\nrespectivos raios, definidos pela equa\u00e7\u00e3o 1. A fun\u00e7\u00e3o dist retorna a dist\u00e2ncia\nentre os centros de duas esferas.\n\nNa figura 36, demonstra-se os resultados de distribui\u00e7\u00e3o de compri-\nmento em gargantas. Nota-se um crescimento nas gargantas de maior com-\nprimento em fun\u00e7\u00e3o do fator de expans\u00e3o utilizado, conforme \u00e9 esperado.\nIsso demonstra que o fator contribuem, diretamente para o comprimento to-\ntal da garganta, ou seja, o comportamento da rede para o aumento do fator \u00e9\nadequado.\n\nEm rela\u00e7\u00e3o aos resultados do MB, o EMB apresenta, novamente, va-\nlores mais distribu\u00eddos. Mais de 90% das gargantas geradas pelo algoritmo\noriginal tem at\u00e9 100 micr\u00f4metros. Mesmo que haja uma grande concentra\u00e7\u00e3o\nnessa faixa, no EMB isso representa pouco mais de 50%. Essas diferen\u00e7as\n\n\n\n82\n\n4 8 12 16 20 24 28 32 36 40 44 48 52 56 60 64\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nRaio (micrometros)\n\nFigura 37: Distribui\u00e7\u00e3o de raio das gargantas para ambos algoritmos no S1.\nFatores de expans\u00e3o 50%, 60%, 70% e 80% para o EMB\n\ntem impacto sobre os c\u00e1lculos de previs\u00e3o de transporte, principalmente no\nfator de forma\u00e7\u00e3o e na permeabilidade absoluta.\n\nA figura 37, demonstra os raios de cilindros nas redes geradas pelo\nEMB, para o fator de expans\u00e3o variando, e MB. Observa-se que o MB tem\nresultados muito mais comportados nesse caso e isso deve-se ao fato da rede\ngerada pelo MB utilizar uma m\u00e9trica diferente da utilizada na implementa\u00e7\u00e3o\ndo EMB. No primeiro, o raio de um cilindro \u00e9 definido como no trabalho de ,\nou seja em fun\u00e7\u00e3o do raio da esfera que define a garganta e os raios dos poros\nconectados. J\u00e1 no segundo, utiliza-se o mesmo racioc\u00ednio do raio do poro,\nisso \u00e9, obt\u00eam-se o valor do raio em fun\u00e7\u00e3o do comprimento e do volume da\ngarganta. Isso \u00e9, para uma garganta Gi qualquer, pertencente ao conjunto de\ngargantas do volume, com volume Vi e comprimento Li define-se que o raio\nRi da garganta \u00e9:\n\nRi =\n\n?\nVi\n\n? Li\n(3)\n\nEssa equa\u00e7\u00e3o \u00e9 obtida diretamente da equa\u00e7\u00e3o de volume de um ci-\nlindro, V = ? R2L. Mesmo com essa diferen\u00e7a, o comportamento do EMB\npara o crescimento da garganta \u00e9 mais ou menos constante. Esse resultado\n\n\n\n83\n\n17 35 52 69 87 104 139 173 208 243 379\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\nF\n\nre\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nRaz\u00e3o do comprimento da garganta e raio do poro\n\nFigura 38: Raz\u00e3o do comprimento da garganta pelo raio da mesma no volume\nS1. A \u00faltima faixa s\u00e3o os valores maiores que quatro vezes a m\u00e9dia\n\n\u00e9 adequado porque pela equa\u00e7\u00e3o 3, o raio cresce inversamente proporcional\nao comprimento e proporcional ao volume. Ou seja, como para fatores de\nexpans\u00e3o, tanto o volume quanto o comprimento s\u00e3o maiores, o raio tende\na manter-se na mesma escala. Acredita-se que com a defini\u00e7\u00e3o do raio em\nfun\u00e7\u00e3o do comprimento da garganta, obtenha-se cilindros mais condizentes\ncom a geometria real da garganta.\n\nUma poss\u00edvel caracteriza\u00e7\u00e3o das gargantas de um volume pode ser\nobservada por meio da raz\u00e3o do comprimento das gargantas em fun\u00e7\u00e3o do ta-\nmanho de seu raio. Assim, tem-se uma ideia de qual propor\u00e7\u00e3o encontram-se\nas gargantas. Esse dado, aliado aos outros analisados, prov\u00ea uma defini\u00e7\u00e3o\ngeom\u00e9trica das gargantas em um volume. Na figura 38, tem-se a frequ\u00eancia\nde v\u00e1rias faixas de raz\u00e3o par ao volume S1. Nesse gr\u00e1fico, a \u00faltima faixa est\u00e1\nem fun\u00e7\u00e3o da m\u00e9dia at\u00e9 o maior valor de raz\u00e3o, portanto est\u00e1 visualmente\nescalado diferentemente das outras. Nota-se que os valores de raz\u00e3o crescem,\nem m\u00e9dia, para o EMB, o que est\u00e1 de acordo com o observado nos gr\u00e1ficos\ndas figuras 36 e 37, que demonstram o crescimento do comprimento da gar-\nganta e uma certa const\u00e2ncia no tamanho do raio. Assim, tem-se que a raz\u00e3o\nescala com o aumento do fator de expans\u00e3o. A raz\u00e3o m\u00e9dia na rede MB \u00e9\nde 17.35, enquanto na rede EMB \u00e9 de 13.53, 14.60, 15.32 e 16.24, para os\nfatores 50%, 60%, 70% e 80% de expans\u00e3o, respectivamente.\n\n\n\n84\n\n30089 90267 150445 210624 270802 330980 391158 451336\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nVolume da garganta\n\nFigura 39: Frequ\u00eancia dos volumes das gargantas para o volume S1. A \u00faltima\nfaixa s\u00e3o os valores maiores que quatro vezes a m\u00e9dia\n\nA frequ\u00eancia de volumes de garganta fornece a informa\u00e7\u00e3o visual de\nqu\u00e3o volumosas s\u00e3o as gargantas. Na figura 39, tem-se a frequ\u00eancia de faixas\nde volume para as gargantas onde a \u00faltima faixa \u00e9 definida em fun\u00e7\u00e3o da\nm\u00e9dia. Tem-se uma grande aglomera\u00e7\u00e3o para valores pequenos, caracter\u00edstica\nde acordo com a maior aglomera\u00e7\u00e3o de valores de raio para gargantas e poros\nem faixas de dezenas de micr\u00f4metros. Ainda assim, a escala de volume varia\nbastante, sobretudo nas gargantas com raios e comprimentos maiores cujos\nvolumes ser\u00e3o cubicamente maior que outros.\n\n5.2 ESTUDO DE CASO C1\n\nO volume C1, visualizado em forma de esferas e cilindros na figura\n40, \u00e9 uma amostra carbon\u00e1tica discutida no tamb\u00e9m no trabalho de Dong e\nBlunt (2007). Essa amostra, possui uma alta irregularidade, dada os proces-\nsos diagen\u00e9ticos os quais a originam. Ela \u00e9 interessante por apresentar uma\nforte contrapartida ao volume S1, de menor porosidade e mais regular e tam-\nb\u00e9m por apresentar, por sua morfologia, similaridade com rochas diversas de\nbacias sedimentares. Recomenda-se a leitura da se\u00e7\u00e3o 5.1 porque nela v\u00e1rias\ndefini\u00e7\u00f5es, nesta se\u00e7\u00e3o utilizadas, s\u00e3o explicadas.\n\n\n\n85\n\nEMB MB\nPorosidade da rede 24.1 24.1\nN de poros 8177.0 4576.0\nN de gargantas 13542.0 6915.0\nN de inlets 163.0 113.0\nN de outlets 166.0 107.0\nN de isolados 5454.0 3317.0\nElementos circulares 335.0 0.0\nElementos quadrados 302.0 67.0\nElementos triangulares 21084.0 11426.0\n\nTabela 4: Caracter\u00edsticas da RP, no EMB e MB, para o volume C1\n\nFigura 40: Rede gerada para o volume C1\n\n\n\n86\n\nNa tabela 4, encontram-se os valores de algumas propriedades da rede\npara as duas redes. No EMB, a rede gerada possui 8177 poros e 13542 gar-\ngantas, expressando uma propor\u00e7\u00e3o de poros em rela\u00e7\u00e3o a gargantas em torno\nde 60%. Para o MB, a rela\u00e7\u00e3o \u00e9 similar, com 4576 poros e 6915 gargantas, ou\nseja, 66%. Novamente, a rede gerada obteve mais poros e gargantas porque\na rede do EMB possui aproximadamente 78% de poros e 95% de gargantas a\nmais. Valores percentuais mais altos, quando comparados aos do S1.\n\nO n\u00famero de inlets e outlets foi de 163 e 166 para a rede das esferas\nexatas, enquanto a rede da implementa\u00e7\u00e3o de Dong apresentou 113 e 107,\nrespectivamente. Novamente, o n\u00famero de inlets e outlets foi maior na rede\ndo EMB, mas relembra-se que isso n\u00e3o ocorre para todos os casos, conforme\nvisto na figura 28.\n\nUma grande diferen\u00e7a dos resultados do C1 com rela\u00e7\u00e3o ao S1 \u00e9 o\nn\u00famero de poros isolados, totalizando 5454 na rede do EMB e 3317 no MB,\nou seja 66% e 72% do n\u00famero total de poros, respectivamente. Isso deve-se\nao fato da morfologia interna da rocha, com muitos poros pequenos desco-\nnexos e poucos poros grandes bem conectados. Assim, \u00e9 poss\u00edvel que pela\nutiliza\u00e7\u00e3o de filtragens mais fortes sobre o volume binarizado e o aumento no\ntamanho m\u00ednimo de um poro, parametriz\u00e1vel em ambos os algoritmos, tenha\num impacto sobre esse resultado.\n\nOs tipos de elementos gerados nas duas redes s\u00e3o bastante similares.\nNota-se que na rede do MB tem-se zero elementos circulares de novo. Isso,\nreafirma-se, ser\u00e1 um motivo de observa\u00e7\u00e3o na se\u00e7\u00e3o 5.5.1.\n\n5.2.1 N\u00famero de coordena\u00e7\u00e3o\n\nA plotagem da frequ\u00eancia do n\u00famero de coordena\u00e7\u00e3o \u00e9 demonstrado\nna figura 41, para a amostra C1. Nela, \u00e9 poss\u00edvel observar uma grande aglo-\nmera\u00e7\u00e3o em at\u00e9 quatro conex\u00f5es por poro. Contudo, o mais frequente \u00e9 ter\numa conex\u00e3o, diferentemente do S1, onde duas conex\u00f5es \u00e9 o mais frequente.\nIsso, se levado em considera\u00e7\u00e3o a figura 42, demonstra que o volume C1 \u00e9\ncomposto por poucos poros grandes, altamente conectados (m\u00e1ximo de 55\nconex\u00f5es) e possui mais poros menores. Ou seja, s\u00e3o evid\u00eancias da irregula-\nridade e heterogeneidade da amostra.\n\nNo esferas m\u00e1ximas exatas, o n\u00famero de conex\u00f5es \u00e9 maior que o MB\npara valores maior que um, por\u00e9m a partir de sete conex\u00f5es ele apresenta\nmaior frequ\u00eancia novamente. Novamente, o comportamento foi parecido com\no S1, onde essa invers\u00e3o ocorria para quatro conex\u00f5es ou mais.\n\nA irregularidade da amostra \u00e9 evidente quando observa-se n\u00famero de\nconex\u00f5es pr\u00f3ximos dos valores m\u00e1ximos. A baixa frequ\u00eancia que poros desse\n\n\n\n87\n\n1 4 7 10 13 16 19 22 25 28 31 34 37 40 43 46 49 52 55\n\nMB\n\nEMB\n\n0\n\n10\n\n20\n\n30\n\n40\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nN\u00famero de coordena\u00e7\u00e3o\n\nFigura 41: Frequ\u00eancia do n\u00famero de coordena\u00e7\u00e3o nos algoritmos EMB e MB\npara o volume C1\n\ntipo aliadas a grande quantidade de poros pequenos \u00e9 caracter\u00edstica desse tipo\nde volume. Ainda assim, tais caracter\u00edsticas foram capturados de maneira\nadequada pelo EMB.\n\n5.2.2 Poros\n\nA distribui\u00e7\u00e3o de raio de poros no volume S1 era quase id\u00eantica para\nv\u00e1rios fatores. Na figura 42 tem-se as distribui\u00e7\u00f5es percentuais de faixas de\nraios do MB e do EMB, para os fatores de expans\u00e3o de 50% a 80%. Nova-\nmente, o raio final dos poros, obtido pela equa\u00e7\u00e3o 1 varia pouco com o fator\nde expans\u00e3o utilizado. Entretanto, nesse volume os raios est\u00e3o muito mais\nconcentrados em valores inferiores, isso \u00e9, h\u00e1 uma quantidade maior de poros\nde tamanho pequeno, e poucos poros grandes, quando comparado ao arenito\nS1. Isso tamb\u00e9m pode caracterizar uma falha na etapa de aquisi\u00e7\u00e3o, ou seja,\nse a resolu\u00e7\u00e3o utilizada nessa etapa fosse melhor, talvez esses elementos pe-\nquenos e desconexos apresentariam-se bem conectados.\n\nEm rela\u00e7\u00e3o ao esferas m\u00e1ximas, o EMB apresenta, como no S1, uma\ndistribui\u00e7\u00e3o de raios dos poros maior. No MB, mais de 70% dos raios tem at\u00e9\n8 micr\u00f4metros, enquanto na vers\u00e3o exata, a mesma faixa representa pouco\n\n\n\n88\n\n8 17 26 34 42 51 60 68 76 85 94 102 119 136\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\n0\n\n20\n\n40\n\n60\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nRaio (micrometros)\n\nFigura 42: Distribui\u00e7\u00e3o de raios de poros para ambos algoritmos no volume\nC1. Fatores de expans\u00e3o 50%, 60%, 70% e 80% para o EMB\n\nmais de 40% dos poros. Entre 8 e 17 micr\u00f4metros est\u00e3o 20% dos poros e\nquase 40% para o MB e EMB, respectivamente. Portanto, houve um cresci-\nmento expressivo nessa faixa de raios de poro para o EMB. O mesmo acon-\ntece para raios maiores, mas os valores absolutos para as demais faixas s\u00e3o\nmenos expressivos que nas duas faixas citadas.\n\nAs faixas de volume de poros quando relacionadas a frequ\u00eancia em\nque ocorrem geram os resultados vistos na figura 47. Nela, a \u00faltima faixa de\nfrequ\u00eancia une todos os valores maiores que quatro vezes a m\u00e9dia. Observa-\nse que, assim como nas gargantas, o volume dos poros no C1 \u00e9 menor que no\nS1. Tem-se alguns poros grandes, por\u00e9m a grande quantidade de poros \u00e9 pe-\nqueno e desconexo, conforme visto pelo n\u00famero de elementos isolados na ta-\nbela 4 e pela distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o, na figura 41. Conforme\nj\u00e1 observado, isso indica a necessidade de uma aquisi\u00e7\u00e3o em uma melhor\nresolu\u00e7\u00e3o.\n\n5.2.3 Gargantas\n\nO comportamento do crescimento das gargantas, visto na figura 44, \u00e9\nmantido para as gargantas dessa RP, como no S1. Apesar disso, as gargan-\n\n\n\n89\n\n9271 27812 46353 64894 83436 101977 120518 139059\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\n0\n\n20\n\n40\n\n60\n\n80\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nVolume (micrometros c\u00fabicos)\n\nFigura 43: Frequ\u00eancia dos volumes dos poros para as redes EMB e MB do\nvolume C1. A \u00faltima faixa engloba todos os valores maiores que quatro vezes\na m\u00e9dia\n\n18 36 53 71 89 107 142 178 214 249 285\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\n0\n\n20\n\n40\n\n60\n\n80\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nComprimento (micrometros)\n\nFigura 44: Distribui\u00e7\u00e3o de comprimentos das gargantas no volume C1. Fato-\nres de expans\u00e3o 50%, 60%, 70% e 80% para o EMB\n\n\n\n90\n\n3 7 10 14 17 21 24 28 31 34 38 41 45 48 52 55\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nRaio (micrometros)\n\nFigura 45: Distribui\u00e7\u00e3o de comprimentos das gargantas para ambos algorit-\nmos. Fatores de expans\u00e3o 50%, 60%, 70% e 80% para o EMB\n\ntas s\u00e3o menos compridas e menos distribu\u00eddas, assim como os poros. Isso \u00e9,\nh\u00e1 uma alta concentra\u00e7\u00e3o de gargantas com at\u00e9 53 micr\u00f4metros no EMB e\nMB. No \u00faltimo, essa faixa representa praticamente a totalidade das gargan-\ntas, enquanto nas esferas exatas representam quase aproximadamente 90%\ndas gargantas. Essa grande concentra\u00e7\u00e3o d\u00e1-se pelo mesmo fato da alta con-\ncentra\u00e7\u00e3o de poros de raios pequenos, ou seja, \u00e9 caracter\u00edstica de um volume\nheterog\u00eaneo irregular.\n\nNa figura 45, est\u00e3o os valores percentuais para as faixas de raios de\ngarganta. Nesse caso, o MB e EMB geraram redes com raios similares o que\nimplica que para volumes com muitos poros e gargantas pequenas, a defini-\n\u00e7\u00e3o da equa\u00e7\u00e3o 3 resulte em pequenas diferen\u00e7as com a equa\u00e7\u00e3o , contudo\ntal constata\u00e7\u00e3o requer um maior estudo para mais dados amostrais. O com-\nportamento da rede do EMB, para os v\u00e1rios fatores de expans\u00e3o foi de pouca\nvaria\u00e7\u00e3o, conforme o visto no S1, sendo novamente adequado.\n\nPara o volume C1, a raz\u00e3o m\u00e9dia do comprimento das gargantas em\nfun\u00e7\u00e3o do raio \u00e9 de 14.1, 15.34, 16.22 e 16.91 na rede EMB, para os fatores\nde expans\u00e3o 50%, 60%, 70% e 80%, respectivamente, enquanto na gerada\npelo MB a raz\u00e3o m\u00e9dia \u00e9 18.88. A figura 46 demonstra as frequ\u00eancias para\nv\u00e1rias faixas de valores. Observa-se que o comportamento \u00e9 similar ao obtido\nno S1, onde o EMB gera uma rede com essa raz\u00e3o menor em m\u00e9dia.\n\n\n\n91\n\n20 40 60 79 99 119 159 199 238 278 1174\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nRaz\u00e3o do comprimento da garganta e raio do poro\n\nFigura 46: Raz\u00e3o do comprimento da garganta pelo raio da mesma no volume\nC1. A \u00faltima faixa s\u00e3o os valores maiores que quatro vezes a m\u00e9dia\n\n1769 5306 8844 12381 15919 19456 22994 26531\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\n0\n\n20\n\n40\n\n60\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nVolume da garganta\n\nFigura 47: Frequ\u00eancia dos volumes das gargantas para o volume C1. A \u00faltima\nfaixa s\u00e3o os valores maiores que quatro vezes a m\u00e9dia\n\n\n\n92\n\nOutro fator que influencia diretamente a an\u00e1lise da rede \u00e9 a distribui-\n\u00e7\u00e3o de volumes de gargantas. A figura 47 apresenta faixas de frequ\u00eancia para\nos volumes das gargantas das redes geradas pelo EMB e MB. A \u00faltima faixa,\ncomo no S1, \u00e9 definida em fun\u00e7\u00e3o da m\u00e9dia, sendo visualmente maior, por\u00e9m\nrepresentando uma faixa bem maior de valores. Nota-se que as gargantas do\nC1 s\u00e3o, em m\u00e9dia, menos volumosas que a do S1. Esse fato fica claro ao\nanalisar-se os valores de faixa para ambos, onde os valores para o S1 est\u00e3o\nquase que em outra escala de grandeza. Isso comprova que a partir desse\nvolume mais gargantas menos volumosas.\n\n5.3 DEMAIS ARENITOS\n\nPelo fato dos resultados de alguns arenitos serem visualmente repeti-\ntivos, ou seja, s\u00e3o similares e pela grande quantidade de volumes amostrais,\nparte dos resultados est\u00e3o nos anexos desse trabalho. Na se\u00e7\u00e3o 7.2 encontram-\nse os resultados para os volumes S4, S7, S8 e S9. Apesar disso, os valores de\npermeabilidade e fator de forma\u00e7\u00e3o, descritos na se\u00e7\u00e3o 5.5.4, s\u00e3o de todas as\namostras analisadas tamb\u00e9m no cap\u00edtulo 4.\n\nObserva-se que assim como nas amostras S1 e C1, as redes EMB apre-\nsentam sempre um n\u00famero de gargantas e poros maior que nas MB. Essa dis-\ntin\u00e7\u00e3o nos resultados j\u00e1 fora observada no cap\u00edtulo 4 e \u00e9 devida a diferen\u00e7a\nna defini\u00e7\u00e3o do raio e em ambos. Apesar disso, a porosidade calculada para\nambas s\u00e3o sempre similares, nunca variando mais que 0.5% nas amostras es-\ntudadas.\n\nUm fato que chama bastante aten\u00e7\u00e3o \u00e9 o fato do MB nunca gerar fa-\ntores de forma circulares para os elementos da rede e, em sua maioria, os\nelementos gerados por ele serem triangulares. Os elementos quadrados s\u00e3o\nsempre insignificativos. Existe um motivo para tal, e ele ser\u00e1 motivo de es-\ntudo na se\u00e7\u00e3o 5.5.1.\n\nAs tabelas 5, 6, 7 e 8 apresentam os valores obtidos para algumas\npropriedades b\u00e1sicas da rede, contrapostos com o resultado obtido com o MB\npara os mesmos volumes. A figura 48 demonstra o resultado visual da rede\nS2, que em contrapartida com a rede S3, da figura 49, apresenta poros maiores\ne menos numerosos. Isso pode ser observado nos n\u00fameros de ambas as redes,\napesar de ambas possu\u00edrem porosidades n\u00e3o t\u00e3o diferentes, isto \u00e9, 24.9% e\n17.1%, a rede S2 tem 3523 poros e 7400 gargantas enquanto a S3 cont\u00e9m\n13794 poros e 20903 gargantas. Essas diferen\u00e7as morfol\u00f3gicas entre as duas\nrochas, refletem diretamente na permeabilidade absoluta e o fator de forma\ndessas redes, descritos na se\u00e7\u00e3o 5.5.4.\n\nO volume S5, apresenta um n\u00famero de poros bem menor que o S2,\n\n\n\n93\n\nEMB MB\nPorosidade da rede 24.9 24.7\nN de poros 3523.0 2021.0\nN de gargantas 7400.0 4942.0\nN de inlets 164.0 112.0\nN de outlets 172.0 125.0\nN de isolados 105.0 73.0\nElementos circulares 126.0 0.0\nElementos quadrados 147.0 19.0\nElementos triangulares 10652.0 6946.0\n\nTabela 5: Caracter\u00edsticas da RP, no EMB e MB, para o volume S2\n\nFigura 48: Rede gerada para o volume S2\n\n\n\n94\n\nEMB MB\nPorosidade da rede 17.0 17.2\nN de poros 13794.0 8926.0\nN de gargantas 20903.0 15103.0\nN de inlets 347.0 288.0\nN de outlets 375.0 301.0\nN de isolados 1075.0 656.0\nElementos circulares 216.0 0.0\nElementos quadrados 381.0 130.0\nElementos triangulares 34102.0 23901.0\n\nTabela 6: Caracter\u00edsticas da RP, no EMB e MB, para o volume S3\n\nFigura 49: Rede gerada para o volume S3\n\n\n\n95\n\nEMB MB\nPorosidade da rede 20.4 20.1\nN de poros 970.0 518.0\nN de gargantas 1719.0 900.0\nN de inlets 59.0 40.0\nN de outlets 57.0 39.0\nN de isolados 83.0 66.0\nElementos circulares 40.0 0.0\nElementos quadrados 41.0 8.0\nElementos triangulares 2610.0 1412.0\n\nTabela 7: Caracter\u00edsticas da RP, no EMB e MB, para o volume S5\n\nFigura 50: Rede gerada para o volume S5\n\n\n\n96\n\nEMB MB\nPorosidade da rede 43.0 42.6\nN de poros 6067.0 3393.0\nN de gargantas 16983.0 11479.0\nN de inlets 279.0 200.0\nN de outlets 297.0 202.0\nN de isolados 111.0 23.0\nElementos circulares 454.0 0.0\nElementos quadrados 399.0 47.0\nElementos triangulares 22199.0 14827.0\n\nTabela 8: Caracter\u00edsticas da RP, no EMB e MB, para o volume A1\n\nFigura 51: Rede gerada para o volume A1\n\n\n\n97\n\n970 poros e 1719 gargantas e uma porosidade de 20.4%. \u00c9 um volume bem\nhomog\u00eaneo e possui poucos poros pequenos conforme pode ser visualizado\nna figura 50. Os demais poros s\u00e3o maiores e bem conectados. Tal organiza\u00e7\u00e3o\n\u00e9 bastante regular e esse volume deve possui uma permeabilidade bastante\ndiferente dos volumes apresentados tamb\u00e9m.\n\nO volume A1 possui uma porosidade de 43.1%, 6067 poros e 16983\ngargantas. Sua visualiza\u00e7\u00e3o \u00e9 bastante densa com poucos poros pequenos.\nIsso deve-se ao fato de ser, dentre as amostras analisadas, a \u00fanica de s\u00edlica\nsint\u00e9tica, e portanto, manufaturada. Tal origem, faz com que ela seja uma\nmuito diferente das analisadas at\u00e9 ent\u00e3o. Contudo, \u00e9 interessante exatamente\npor apresentar uma forte contrapartida com os volumes vistos at\u00e9 ent\u00e3o, so-\nbretudo na porosidade elevada.\n\n5.4 ROCHA C2\n\nComo as rochas carbon\u00e1ticas analisadas no cap\u00edtulo 4 s\u00e3o apenas qua-\ntro, todos os resultados referentes a elas se encontram descritos nessa se\u00e7\u00e3o,\ncom exce\u00e7\u00e3o da amostra C1, j\u00e1 descrita.\n\nNa tabela 9 mant\u00e9m-se as porosidades calculadas sobre a rede, de ma-\nneira similar para as RPs do MB e EMB e o n\u00famero de poros e gargantas\nsempre maior no \u00faltimo, conforme j\u00e1 foi constado na figura 26. Ou seja, as\nredes s\u00e3o, volumetricamente equivalentes para ambos, por\u00e9m fundamental-\nmente diferentes. Dessa constata\u00e7\u00e3o, espera-se que as permeabilidades ab-\nsolutas para ambas as redes sejam em mesma ordem de grandeza para um\ndeterminado fator de expans\u00e3o. Os resultados finais s\u00e3o vistos na se\u00e7\u00e3o 5.5.4\ne discutidos na se\u00e7\u00e3o 5.6.\n\nO volume C2 difere bastante com rela\u00e7\u00e3o ao do C1, tanto visualmente\ncomo em dados emp\u00edricos. Ele possui 13084 poros e 17710 gargantas e uma\nporosidade calculada de 16.1% para a RP do EMB. Apesar de apresentar uma\ncerta similaridade como volume citado, o C2 \u00e9 mais polu\u00eddo e, analisando-se\nos poros e gargantas gerados, existem menos poros grandes no \u00faltimo que no\nprimeiro. Tamb\u00e9m, as gargantas do C2 s\u00e3o em geral menores. Por fim, o ta-\nmanho amostral desses volumes \u00e9 bastante diferente o que tamb\u00e9m influencia\nos resultados para as equa\u00e7\u00f5es de transporte.\n\nEm todas as amostras, nota-se que o n\u00famero de elementos circulares \u00e9\nsempre zero no para redes do MB e o n\u00famero de elementos quadrados \u00e9 sem-\npre insignificativo perante o n\u00famero de elementos triangulares. Isso tamb\u00e9m\n\u00e9 verdade para o EMB, por\u00e9m, em geral, ele gera redes com mais elementos\nquadrados e um n\u00famero sempre n\u00e3o nulo de elementos quadrados. O mesmo\nfoi constatado nos volumes aren\u00edticos. Essa diferen\u00e7a com rela\u00e7\u00e3o ao fator\n\n\n\n98\n\nEMB MB\nPorosidade da rede 16.1 15.7\nN de poros 13084.0 8508.0\nN de gargantas 17710.0 10336.0\nN de inlets 347.0 260.0\nN de outlets 359.0 258.0\nN de isolados 7728.0 5036.0\nElementos circulares 309.0 0.0\nElementos quadrados 349.0 130.0\nElementos triangulares 30138.0 18716.0\n\nTabela 9: Caracter\u00edsticas da RP, no EMB e MB, para o volume C2\n\nFigura 52: Rede gerada para o volume C2\n\n\n\n99\n\nde forma \u00e9 proveniente de uma modifica\u00e7\u00e3o feita sobre o MB, explanada na\nse\u00e7\u00e3o 5.5.1.\n\n5.5 ESCOAMENTO MONOF\u00c1SICO E PROPRIEDADES PETROF\u00cdSICAS\n\nA simula\u00e7\u00e3o do escoamento de fluido pela RP \u00e9 importante por ser\num mecanismo a mais para comprova\u00e7\u00e3o de padr\u00f5es visuais e estoc\u00e1sticos\nobservados na rede. Dentre as vari\u00e1veis de previs\u00e3o de transporte, tem-se\naquelas obtidas para escoamento multif\u00e1sico (multiphase), simulando-se \u00f3leo\ne \u00e1gua, ou ainda \u00f3leo, \u00e1gua e g\u00e1s. Tamb\u00e9m, existe a previs\u00e3o em uma \u00fanica\nfase (single phase), tamb\u00e9m chamado de escoamento monof\u00e1sico, capaz de\nextrair o comportamento de apenas um fluido atravessando a rede de poros,\ntipicamente a \u00e1gua.\n\nEste trabalho, restringe-se a caracter\u00edsticas para fases singulares, isso\n\u00e9, apenas leva-se em considera\u00e7\u00e3o um ambiente com uma \u00fanica fase. Apesar\ndisso, o simulador utilizado \u00e9 capaz de extrair dados multif\u00e1sicos.\n\nAlgumas assun\u00e7\u00f5es s\u00e3o feitas no ambiente monof\u00e1sico de estudo: o\nfluido \u00e9 newtoniano, incompress\u00edvel, imisc\u00edvel e homog\u00eaneo; o fluido molha\ncompletamente a fase porosa e, como n\u00e3o h\u00e1 intera\u00e7\u00e3o com uma segunda\nsubst\u00e2ncia, o invade os poros sem resist\u00eancia alguma.\n\nA viscosidade do fluido \u00e9 1 cP, a press\u00e3o de entrada nos inlets \u00e9 a 1 Pa e\na de sa\u00edda \u00e9 0 Pa. Esses valores e todos os par\u00e2metros utilizados encontram-se\nno ap\u00eandice, se\u00e7\u00e3o 7.4.\n\nAs vari\u00e1veis petrof\u00edsicas que, neste trabalho, foram consideradas im-\nprescind\u00edveis foram o fator de forma, a permeabilidade absoluta e o fator\nde forma\u00e7\u00e3o. A avalia\u00e7\u00e3o das tr\u00eas vari\u00e1veis s\u00e3o vistas como suficientes para\ncomprovar a possibilidade de extrair-se dados petrof\u00edsicos a partir da rede\ngerada pelo EMB, assim como compar\u00e1-los com a mesma rede gerada pelo\nMB.\n\n5.5.1 Fator de forma\n\nO fator de forma, do ingl\u00eas shape factor, \u00e9 uma vari\u00e1vel, segundo Ma-\nson e Morrow (1991), definida em fun\u00e7\u00e3o da \u00e1rea A do elemento e o per\u00edmetro\nP, isto \u00e9:\n\nG2D =\nA2\n\nP\n(4)\n\nO fator de forma \u00e9 importante para a previs\u00e3o das propriedades da\n\n\n\n100\n\nFigura 53: Determina\u00e7\u00e3o da geometria mais pr\u00f3xima a um determinado ob-\njeto a partir do fator de forma\n\ntransporte, principalmente em um ambiente multifase porque \u00e9 a partir dessa\nvari\u00e1vel que se determina qual geometria \u00e9 mais apropriada para a repre-\nsenta\u00e7\u00e3o de um determinado elemento e o qu\u00e3o irregular \u00e9 esse elemento, e\nportanto mais prop\u00edcio a reter l\u00edquido devido a for\u00e7as capilares, alterando a\nmolhabilidade em uma intera\u00e7\u00e3o multif\u00e1sica (VALVATNE; BLUNT, 2004).\n\nUm elemento irregular da rede, representado na forma de voxels pode\npossuir o mesmo fator de forma de uma geometria regular, conforme demons-\ntrado na figura 53.\n\nOs valores das geometrias regulares s\u00e3o, se relacionados a forma irre-\ngular obtida na representa\u00e7\u00e3o voxelizada, apenas refer\u00eancias que demonstram\nde forma num\u00e9rica a irregularidade do espa\u00e7o poroso. Assim, um elemento\nque possua uma forma bastante regular ser\u00e1 representado por um c\u00edrculo ou\num quadrado, enquanto um elemento bastante irregular ser\u00e1 representado por\num tri\u00e2ngulo cujos cantos podem formar \u00e2ngulos extremamente agudos, o\nque conforme j\u00e1 observado, essa caracter\u00edstica modifica a passagem do fluido\ndurante simula\u00e7\u00f5es multif\u00e1sicas.\n\nUma vantagem de utilizar-se uma forma mais simples para calcular\npropriedades de transporte \u00e9 que, al\u00e9m de ser poss\u00edvel calcular e definir a\nquantidade de fluido retido durante nos cantos do elemento durante a simula-\n\u00e7\u00e3o, torna-se poss\u00edvel definir a press\u00e3o capilar de entrada como uma fun\u00e7\u00e3o\ndireta do fator de forma do poro (MASON; MORROW, 1991).\n\nA defini\u00e7\u00e3o do fator de forma como G2D n\u00e3o \u00e9 v\u00e1lida em um ambiente\nvolum\u00e9trico, sendo reescrita como:\n\nG3D =\nV L\nA2\n\n(5)\n\nOnde V \u00e9 o volume da garganta ou poro e A a \u00e1rea. L \u00e9 o raio para o\nporos um elemento esf\u00e9rico e o comprimento para a garganta, ou seja, para\nelementos esf\u00e9ricos e cil\u00edndricos ele \u00e9 diferente. As formas visualizadas na\n\n\n\n101\n\n0.00497375 0.019895 0.03481625 0.0497375 0.06465875 0.07958\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\n0\n\n5\n\n10\n\n15\n\n20\n\n25\n\n30\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nFator de forma\n\nFigura 54: Frequ\u00eancia do fator de forma para o volume S1\n\n0.00497375 0.019895 0.03481625 0.0497375 0.06465875 0.07958\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\n0\n\n5\n\n10\n\n15\n\n20\n\n25\n\n30\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nFator de forma\n\nFigura 55: Frequ\u00eancia do fator de forma para o volume C1\n\n\n\n102\n\nfigura 53 ainda s\u00e3o v\u00e1lidas numa simula\u00e7\u00e3o de escoamento fixa em um eixo.\nNas figuras 54 e 55, tem-se a distribui\u00e7\u00e3o dos fatores de forma para\n\nos volumes S1 e C1. Observa-se que com o aumento do fator de expans\u00e3o\ndas gargantas no EMB, os fatores de forma concentram-se mais em valores\nmais altos, enquanto para o MB s\u00e3o impossivelmente similares e tendem a\nseguir uma distribui\u00e7\u00e3o normal. A explica\u00e7\u00e3o para tal fato, pode ser encon-\ntrada no trabalho de Dong e Blunt (2007), onde a defini\u00e7\u00e3o do fator de forma\ndo elemento \u00e9 dado pelo tamanho do raio, assim os valores s\u00e3o arbitraria-\nmente distribu\u00eddos ao longo dos valores Rmin ?1 a Rmax, conforme definidos\nna se\u00e7\u00e3o 4.1.1, e o menor tamanho poss\u00edvel \u00e9 10% do tamanho real de um\nvoxel no volume (resolu\u00e7\u00e3o). O objetivo do autor foi parametrizar a curva de\npress\u00e3o capilar de modo a ela apresentar resultados mais similares ao PB. Tal\ndiferen\u00e7a, devem fazer com que os resultados de permeabilidade absoluta e\nfator de forma\u00e7\u00e3o sejam diferentes para o EMB e MB.\n\nConfirma-se o que j\u00e1 era observado nas figuras 39, 36, 35 e 34 para o\nS1 e nas figuras 47, 44, 43 e 42 para o C1. Devido ao fato do volume e o raio\ndos poros serem pouco modificados pelo fator de expans\u00e3o e o das gargantas\nser, em contrapartida, modificados significativamente, h\u00e1 uma transfer\u00eancia\nde popula\u00e7\u00e3o dos fatores de forma menores para fatores de forma mais altos.\nPor meio da defini\u00e7\u00e3o da equa\u00e7\u00e3o 5, conclui-se que o n\u00famero de elementos\naltamente irregulares diminui conforme o aumento do fator de expans\u00e3o, as-\nsim h\u00e1 uma melhor defini\u00e7\u00e3o dos elementos altamente irregulares da rede,\nisto \u00e9, as gargantas.\n\n5.5.2 Permeabilidade absoluta\n\nA permeabilidade \u00e9 a vaz\u00e3o de um determinado fluido em um meio po-\nroso e varia em fun\u00e7\u00e3o da varia\u00e7\u00e3o da press\u00e3o de entrada. A permeabilidade\nabsoluta K est\u00e1 relacionada com a capacidade do meio poroso de permitir o\nescoamento de um fluido por sua estrutura interna e \u00e9 definida por:\n\nK =\n? LQ\n\nA(pinlet ? poutlet)\n(6)\n\nEssa defini\u00e7\u00e3o \u00e9 v\u00e1lida quando a rede encontra-se em saturada na mo-\nnofase p de viscosidade corresponde a ? . O fluxo monof\u00e1sico total, denotado\npor Q, \u00e9 dado pela diferen\u00e7a de potencial p entre inlets e outlets, dada indivi-\ndualmente por:\n\np = P??pgh\n\nP \u00e9 a press\u00e3o de entrada, ?p\u00e9 a densidade da fase e g a constante de gravidade\n\n\n\n103\n\nFigura 56: Configura\u00e7\u00e3o poro-garganta-poro onde a regi\u00e3o cinza \u00e9 a regi\u00e3o\nde c\u00e1lculo do fluxo Qp,i j\n\ne h \u00e9 a altura do volume. Apesar de n\u00e3o ser objeto de estudo nesse trabalho,\na permeabilidade relativa \u00e9 dada por:\n\nKr =\nQmp\n\nQ\n\nOnde Qmp \u00e9 o fluxo da fase p no ambiente multif\u00e1sico com a mesma\npress\u00e3o de entrada e sa\u00edda. Q, O fluxo total do sistema \u00e9 encontrada solvendo-\nse a a press\u00e3o em todo poro i, impondo a conserva\u00e7\u00e3o de massa em todos eles:\n\n?\nj\n\nQi j = 0 (7)\n\nA vari\u00e1vel j percorre todas as gargantas ligadas ao poro i. O fluxo\nentre dois poros, i e j, \u00e9 definido por:\n\nQi j =\ngi j\nLi j\n\n(pi ? p j) (8)\n\nA diferen\u00e7a de potencial da fase \u00e9 o (pi? p j), enquanto a condut\u00e2ncia\n\u00e9 dada por g. A condut\u00e2ncia entre dois poros i e j, ligados por uma garganta t,\npode ser expressa como a m\u00e9dia harm\u00f4nica da condut\u00e2ncia de cada elemento\nenvolvido, isto \u00e9:\n\nLi j\ngi j\n\n=\nLi\ngi\n\n+\nLt\ngt\n\n+\nL j\ng j\n\nLi e L j s\u00e3o as dist\u00e2ncias do centro do poro a interface com a garganta\nem quest\u00e3o. Lt \u00e9 o comprimento da garganta at\u00e9 a interface poro-garganta,\n\n\n\n104\n\nconforme visto na figura 56. Nessa figura, a regi\u00e3o acinzentada \u00e9 a interface\nporo-garganta-poro em si, sobre a qual o c\u00e1lculo do fluxo \u00e9 feito. A partir\nda f\u00f3rmula de Hagen-Poiseuille, pode-se afirmar que a condut\u00e2ncia g, no\nambiente monof\u00e1sico, \u00e9 dada por:\n\ng =\nkA2G\n\n\u00b5p\nou\n\ng = A2S\n\nO kG\n\u00b5p\n\nou S \u00e9 o fator de forma (shape factor) influenciado pelo tipo de\ngeometria utilizada. A constante k foi descoberta por testes de laborat\u00f3rio\nno trabalho de Patzek e Silin (2001). A constante vale 0.5 para estruturas\ncirculares, 0.5623 para quadradas e 0.6 para equil\u00e1teras.\n\nPela equa\u00e7\u00e3o 7, extrai-se um sistema linear de equa\u00e7\u00f5es que pode\nser resolvido por um solver. A partir das press\u00f5es extra\u00eddas pelo solver,\nsubstituindo-as na equa\u00e7\u00e3o 8, tem-se o fluxo entre os conjuntos de poros co-\nnectados. A partir da\u00ed, obt\u00e9m-se a solu\u00e7\u00e3o do fluxo Q da fase p, e por sua\nsubstitui\u00e7\u00e3o na f\u00f3rmula geral, equa\u00e7\u00e3o 6, acha-se o valor de permeabilidade\nabsoluta para a RP em quest\u00e3o.\n\nDada uma rede de poros de entrada gerada pelo EMB ou MB \u00e9 pos-\ns\u00edvel obter os valores de permeabilidade absoluta por meio do simulador two\nphase. Calcula-se a permeabilidade a partir do fluxo nas dire\u00e7\u00f5es x, y e z\ne obt\u00e9m-se de forma an\u00e1loga Kx,Ky e Kz. A partir desses, tem-se a m\u00e9dia\naritm\u00e9tica:\n\nK =\nKx + KY + Kz\n\n3\n(9)\n\nSendo K a permeabilidade absoluta, conforme descrita na equa\u00e7\u00e3o 6,\nobtida pela execu\u00e7\u00e3o em cada eixo do volume.\n\n5.5.3 Fator de forma\u00e7\u00e3o\n\nO fator de forma\u00e7\u00e3o \u00e9 o resultado da analogia do fluido na RP com\num circuito el\u00e9trico. Fatt (1956), definiu a permeabilidade absoluta em uma\nRP definida no espa\u00e7o 2D por meio de um circuito el\u00e9trico an\u00e1logo a rede\nanalisada.\n\nA lei de Poiseuille \u00e9 an\u00e1loga a lei de Ohm, generalizada por Kirchhoff\ncomo J = ? E , onde J \u00e9 a densidade da corrente em um determinado local,\n\n\n\n105\n\n? \u00e9 condutividade do material e E o campo el\u00e9trico. Substituindo-se E pela\ndiferen\u00e7a de press\u00e3o, ? pela condutividade hidr\u00e1ulica e J pelo fluxo tem-se a\nanalogia entre as duas leis.\n\nA partir da analogia, existe o fator de forma\u00e7\u00e3o, obtido a partir da lei\nde Ohm. Ele caracteriza a express\u00e3o da permeabilidade absoluta sob a \u00f3tica\nda mesma. Portanto, define-se o fator como:\n\nF =\nRn\nRw\n\nRn \u00e9 a resistividade da rede quando completamente saturada e Rw \u00e9 a\nresistividade da \u00e1gua. A resistividade da rede \u00e9 obtida a partir da lei de Ohm:\n\nRn =\nA?E\nJL\n\nA \u00e9 a sec\u00e7\u00e3o transversal, ?E \u00e9 a diferen\u00e7a de tens\u00e3o, J \u00e9 o fluxo total\ne L o comprimento total da RP. A condutividade el\u00e9trica entre dois poros \u00e9\ndefinida pela \u00e1rea da sec\u00e7\u00e3o transversal quando ocupada pela \u00e1gua. Assim:\n\n? =\nAw\nRw\n\nO valor do fator de forma\u00e7\u00e3o para uma rede qualquer \u00e9, finalmente,\ndado por:\n\nF =\n1\n?\n\n(10)\n\n\u00c9 poss\u00edvel calcular esse valor em cada eixo, e a partir da m\u00e9dia harm\u00f4-\nnica dos Fi, que podem ser obtidos de maneira hom\u00f3loga a equa\u00e7\u00e3o 10, ou\nseja Fi =\n\n1\n?i\n\n(VALVATNE; BLUNT, 2004). A m\u00e9dia harm\u00f4nica \u00e9 o valor de\nF , isto \u00e9:\n\n1\nF\n\n=\n1\n3\n(\n\n1\nFx\n\n+\n1\nFy\n\n+\n1\nFz\n) (11)\n\nO simulador two phase implementa a extra\u00e7\u00e3o do fator de forma\u00e7\u00e3o a\npartir de uma rede de entrada, al\u00e9m do c\u00e1lculo da permeabilidade absoluta.\n\n5.5.4 Resultados\n\nNessa se\u00e7\u00e3o s\u00e3o apresentados os resultados dos fatores de forma e\npermeabilidades absolutas pela utiliza\u00e7\u00e3o do simulador two phase, capaz de\nextrair informa\u00e7\u00f5es monof\u00e1sicas e multif\u00e1sicas a partir de uma descri\u00e7\u00e3o de\n\n\n\n106\n\nrede. Para tanto, fez-se necess\u00e1rio a implementa\u00e7\u00e3o de um exportador da rede\npara o formato textual exigido pelo simulador como entrada. Foi poss\u00edvel\nrodar o simulador para todos os casos, a partir do exportador implementado,\ncontudo em um exemplo o simulador saiu com viola\u00e7\u00e3o de mem\u00f3ria ap\u00f3s\nrodar a simula\u00e7\u00e3o.\n\nCuriosamente, o exportador da rede gerada pela implementa\u00e7\u00e3o de\nDong e Blunt (2007) em muitos casos resultou em falhas no parsing do ar-\nquivo pelo simulador, mesmo para exemplos os quais haviam sido descorri-\ndos na disserta\u00e7\u00e3o citada. Assume-se que esses erros devem-se ao fato dos\nc\u00f3digos serem originalmente compilados em ambiente 32 bits e por possivel-\nmente alguma altera\u00e7\u00e3o feita para que eles compilassem em um ambiente 64\nbits tornou tais casos falhos. Essa \u00faltima, \u00e9 duvidosa pelo fato dos c\u00f3digos\nterem sido compilados em 32 bits como forma de teste tamb\u00e9m e n\u00e3o terem\nobtido sucesso em todos os casos.\n\nPara a maioria dos casos foi poss\u00edvel rodar o c\u00f3digo para ambos, pelo\nmenos no eixo das abcissas, conforme ser\u00e1 discorrido mais adiante. Nos\nresultados que n\u00e3o puderam ser obtidos pelo esferas m\u00e1ximas, tem-se o valor\nzero na tabela 14, referente aos resultados do mesmo.\n\nNota-se na tabela 14 que os resultados para os eixos y e z diferem\nmuito dos valores encontrados em x. O c\u00f3digo original do MB gerava redes\nsempre no eixo x, impossibilitando a escolha de outro eixo sem a altera\u00e7\u00e3o do\nc\u00f3digo. Sendo assim, modificou-se o software de modo a ser poss\u00edvel passar\npor linha de comando o eixo a ser calculado. Assim, esses resultados diferen-\ntes podem ser frutos da modifica\u00e7\u00e3o feita e portanto, ser\u00e3o ignorados para fins\nde compara\u00e7\u00e3o, ou seja, somente o eixo x ser\u00e1 considerado nas compara\u00e7\u00f5es\nEMB e MB na se\u00e7\u00e3o 5.6, pelo fato dos resultados obtidos serem duvidosos\nperante o esperado.\n\nOs resultados obtidos para as redes geradas pelo EMB est\u00e3o nas tabe-\nlas 10, 11, 12 e 13, enquanto o resultado original para a RP gerada pelo MB\nencontra-se na tabela 15. O resultado obtido na execu\u00e7\u00e3o do c\u00f3digo modi-\nficado encontra-se em 14. Nos tr\u00eas casos, as vari\u00e1veis K e F s\u00e3o definidas\nde acordo com as equa\u00e7\u00f5es 9 e 11, respectivamente. Ou seja, s\u00e3o resultados\nfrutos de execu\u00e7\u00f5es singulares para cada um dos elementos pertencentes as\ntuplas (Kx,Ky,Kz) e (Fx,Fy,Fz).\n\nDa observa\u00e7\u00e3o dos resultado tem-se que os dados emp\u00edricos diferem\nbastante para fatores de forma diversos e, de forma geral, de maneira linear,\ntanto para o fator de forma\u00e7\u00e3o como para a permeabilidade absoluta. Essas\ntend\u00eancias e suas implica\u00e7\u00f5es s\u00e3o o pr\u00f3ximo estudo de caso.\n\n\n\n107\n\nFx Fy Fz F Kx Ky Kz K\nS1 12.51 7.72 6.92 8.47 2081.17 2318.79 3694.25 2698.07\nS2 2.01 1.54 1.51 1.66 9954.72 10096.30 10274.60 10108.54\nS3 30.05 4.68 6.61 7.53 167.92 1095.84 733.31 665.69\nS4 41.23 5.78 9.47 9.90 131.23 721.37 511.27 454.62\nS5 1.76 1.68 1.40 1.60 18542.70 18380.80 20128.40 19017.30\nS6 1.53 1.41 1.74 1.55 38252.20 38257.40 29676.40 35395.33\nS7 1.25 1.13 1.06 1.14 18592.80 18381.00 18702.50 18558.77\nS8 0.75 0.71 0.68 0.71 45350.20 44135.10 44813.10 44766.13\nS9 2.16 1.94 1.96 2.02 88669.80 89761.30 85824.20 88085.10\nS10 2.75 2.31 2.32 2.44 3533.28 3590.51 3526.14 3549.98\nS11 1.70 1.46 1.63 1.59 10504.30 10760.60 10411.60 10558.83\nC1 4.90 2.37 3.55 3.30 3268.11 4108.49 3311.10 3562.57\nC2 99.51 11.53 8.65 14.13 41.67 303.00 269.77 204.81\nA1 0.67 0.50 0.53 0.56 18814.50 21782.50 21479.20 20692.07\n\nTabela 10: Tabela de valores dos fatores de forma\u00e7\u00e3o e permeabilidades para\no EMB. Fator de expans\u00e3o 0.5\n\nFx Fy Fz F Kx Ky Kz K\nS1 14.57 8.59 7.54 9.44 1741.27 1970.30 3421.12 2377.56\nS2 2.36 1.75 1.74 1.91 8300.90 8485.78 8503.80 8430.16\nS3 40.87 5.65 7.64 9.03 117.96 926.33 615.61 553.30\nS4 52.89 6.71 11.01 11.59 100.68 616.94 431.73 383.12\nS5 2.24 2.08 1.75 2.00 12965.40 13091.80 13322.90 13126.70\nS6 1.99 1.78 2.01 1.92 28338.30 28650.10 24529.50 27172.63\nS7 1.48 1.30 1.22 1.33 15000.20 14925.70 15078.90 15001.60\nS8 0.86 0.81 0.77 0.81 38801.80 37637.10 38461.50 38300.13\nS9 2.37 2.10 2.11 2.19 68894.40 70163.80 65725.50 68261.23\nS10 3.24 2.66 2.67 2.83 3115.50 3157.01 3119.52 3130.68\nS11 2.24 1.85 2.12 2.06 7659.00 8077.41 7610.67 7782.36\nC1 6.20 3.49 4.30 4.41 2699.09 2832.20 2741.53 2757.61\nC2 123.44 12.44 9.04 15.07 30.07 292.50 258.31 193.63\nA1 0.77 0.60 0.62 0.66 16127.30 17253.10 17201.50 16860.63\n\nTabela 11: Tabela de valores dos fatores de forma\u00e7\u00e3o e permeabilidades para\no EMB. Fator de expans\u00e3o 0.6\n\n\n\n108\n\nFx Fy Fz F Kx Ky Kz K\nS1 19.02 10.57 9.04 11.64 1252.98 1458.20 3078.16 1929.78\nS2 2.72 1.94 1.96 2.16 7174.60 7372.87 7387.01 7311.49\nS3 48.76 6.39 8.68 10.26 96.51 814.50 531.22 480.75\nS4 64.18 7.01 12.06 12.44 80.50 585.27 386.13 350.63\nS5 2.65 2.45 2.45 2.51 11479.90 11462.10 11462.10 11468.03\nS6 2.11 1.88 2.08 2.02 27184.70 27511.60 23889.70 26195.33\nS7 1.78 1.52 1.42 1.56 12845.90 12830.70 12950.40 12875.67\nS8 1.00 0.92 0.87 0.93 32807.30 31839.80 32632.20 32426.43\nS9 2.97 2.56 2.54 2.68 50846.60 51026.00 50420.70 50764.43\nS10 3.70 2.95 2.98 3.18 2533.63 2581.51 2542.44 2552.53\nS11 2.86 2.42 2.65 2.63 5937.19 5929.38 5888.77 5918.45\nC1 6.46 3.64 4.47 4.59 2525.86 2643.77 2564.57 2578.07\nC2 146.10 14.24 9.43 16.38 27.50 153.56 250.18 143.75\nA1 0.91 0.70 0.71 0.76 13324.70 14082.70 14451.50 13952.97\n\nTabela 12: Tabela de valores dos fatores de forma\u00e7\u00e3o e permeabilidades para\no EMB. Fator de expans\u00e3o 0.7\n\nFx Fy Fz F Kx Ky Kz K\nS1 21.87 11.55 10.04 12.94 1093.41 1298.93 2943.11 1778.48\nS2 3.12 2.16 2.19 2.42 6268.32 6490.20 6489.37 6415.96\nS3 55.28 6.84 9.65 11.20 85.51 771.77 493.65 450.31\nS4 73.42 7.53 13.58 13.64 69.44 538.03 335.45 314.31\nS5 3.07 2.81 2.81 2.89 9773.88 9761.48 9761.48 9765.61\nS6 2.35 2.07 2.29 2.23 23127.30 23416.00 20268.90 22270.73\nS7 1.87 1.58 1.47 1.63 12504.30 12483.10 12642.50 12543.30\nS8 1.12 1.02 0.96 1.03 28537.00 28126.50 28674.90 28446.13\nS9 3.36 2.89 2.84 3.02 44853.00 45328.40 44902.00 45027.80\nS10 4.44 3.41 3.48 3.72 2019.72 2060.75 2032.55 2037.67\nS11 3.16 2.61 2.87 2.86 4981.95 4999.87 4970.75 4984.19\nC1 7.31 3.87 4.83 4.98 2044.67 2209.00 2084.75 2112.81\nC2 156.28 15.20 10.13 17.55 26.75 147.41 237.33 137.16\nA1 1.02 0.76 0.80 0.85 11857.70 12730.10 12217.40 12268.40\n\nTabela 13: Tabela de valores dos fatores de forma\u00e7\u00e3o e permeabilidades para\no EMB. Fator de expans\u00e3o 0.8\n\n\n\n109\n\nFx Fy Fz F Kx Ky Kz K\nS1 23.73 4.99 5.53 7.09 1939.57 13541.90 12232.10 9237.86\nS2 5.89 1.47 1.99 2.22 4690.01 48397.10 13868.00 22318.37\nS3 36.27 3.21 7.49 6.35 302.87 18252.30 4105.03 7553.40\nS4 58.53 3.09 2.48 4.03 177.90 18985.30 37215.50 18792.90\nS5 6.10 0.00 2.20 0.00 8530.12 0.00 83881.90 0.00\nS6 5.27 1.15 1.28 1.63 19464.10 50834.70 43884.80 38061.20\nS7 4.27 2.75 0.95 1.82 9142.70 75542.00 87776.80 57487.17\nS8 2.84 3.54 1.58 2.36 16629.80 4772.53 514421.00 178607.78\nS9 6.78 2.02 2.33 2.80 29063.60 15723.80 7251.52 17346.31\nS10 11.01 1.38 1.57 2.07 1398.57 76756.00 85443.60 54532.72\nS11 7.61 4.99 0.00 0.00 3242.83 13541.90 0.00 0.00\nC1 17.73 1.47 5.53 3.27 1190.00 48397.10 12232.10 20606.40\nC2 102.99 0.00 0.00 0.00 161.49 0.00 0.00 0.00\nA1 2.17 3.21 0.00 0.00 8475.24 18252.30 0.00 0.00\n\nTabela 14: Tabela de valores dos fatores de forma\u00e7\u00e3o e permeabilidades para\no MB\n\nFx Fy Fz F Kx Ky Kz K\nS1 36.30 37.90 53.50 41.30 1969.00 1752.00 1312.00 1678.00\nS2 10.90 11.30 12.60 11.50 4318.00 3983.00 3394.00 3898.00\nS3 52.20 41.90 70.30 52.40 143.00 420.00 109.00 224.00\nS4 74.50 71.00 114.40 82.80 273.00 289.00 215.00 259.00\nS5 14.10 14.60 15.90 14.80 4638.00 4874.00 4440.00 4651.00\nS6 10.30 11.20 12.90 11.40 11289.00 10683.00 10951.00 10974.00\nS7 9.60 9.30 11.20 9.90 7268.00 7594.00 6037.00 6966.00\nS8 6.02 5.97 6.53 6.16 13063.00 13507.00 12936.00 13169.00\nS9 16.40 19.90 18.10 18.00 2735.00 2093.00 1844.00 2224.00\nC1 33.70 21.90 27.20 26.80 785.00 1469.00 1053.00 1102.00\nC2 18.00 121.00 249.00 170.00 38.00 161.00 18.00 72.00\nA1 4.47 4.57 5.73 4.86 8272.00 7977.00 5412.00 7220.00\n\nTabela 15: Tabela de valores dos fatores de forma\u00e7\u00e3o e permeabilidades para\no MB. Valores obtidos diretamente da tese de Dong e Blunt (2007)\n\n\n\n110\n\nFx 0.5 Fx 0.6 Fx 0.7 Fx 0.8 Kx 0.5 Kx 0.6 Kx 0.7 Kx 0.8\nS1 0.527 0.614 0.801 0.921 1.073 0.898 0.646 0.564\nS2 0.342 0.401 0.463 0.530 2.123 1.770 1.530 1.337\nS3 0.829 1.127 1.345 1.524 0.554 0.389 0.319 0.282\nS4 0.704 0.904 1.097 1.254 0.738 0.566 0.452 0.390\nS5 0.289 0.367 0.435 0.504 2.174 1.520 1.346 1.146\nS6 0.291 0.377 0.400 0.446 1.965 1.456 1.397 1.188\nS7 0.292 0.347 0.417 0.438 2.034 1.641 1.405 1.368\nS8 0.264 0.304 0.352 0.395 2.727 2.333 1.973 1.716\nS9 0.319 0.350 0.437 0.496 3.051 2.370 1.749 1.543\nS10 0.250 0.294 0.336 0.403 2.526 2.228 1.812 1.444\nS11 0.223 0.295 0.376 0.415 3.239 2.362 1.831 1.536\nC1 0.277 0.349 0.364 0.413 2.746 2.268 2.123 1.718\nC2 0.966 1.199 1.419 1.517 0.258 0.186 0.170 0.166\nA1 0.306 0.355 0.420 0.468 2.220 1.903 1.572 1.399\nM\u00e9dia 0.420 0.520 0.619 0.695 1.959 1.564 1.309 1.128\nVari\u00e2ncia 0.058 0.101 0.148 0.180 0.896 0.593 0.416 0.293\n\nTabela 16: Tabela que apresenta a raz\u00e3o do resultado obtido pela simula\u00e7\u00e3o\nna rede EMB pela rede MB para diferentes fatores de expans\u00e3o, no eixo x\n\n5.6 CONCLUS\u00c3O\n\nNeste cap\u00edtulo, foram estudadas diversas redes e a partir da observa\u00e7\u00e3o\nde distribui\u00e7\u00f5es de raios, comprimentos, volumes e o n\u00famero de coordena\u00e7\u00e3o\nconstatou-se uma s\u00e9rie de diferen\u00e7as e semelhan\u00e7as entre os comportamentos\nobservados para as redes geradas pelo EMB e MB. Inicialmente, notou-se\nque nos casos de estudo S1 e C1, o EMB gera redes com poros mais bem\nconexos e gargantas e com uma popula\u00e7\u00e3o maior de ambos. Apesar disso, os\nvolumes representativos das redes s\u00e3o bastante similares em todos os casos,\ncom a rede EMB tendo uma varia\u00e7\u00e3o de no m\u00e1ximo 0.5% para o c\u00e1lculo da\nporosidade sobre ela.\n\nEm ambas as redes EMB e MB observou-se que o comportamento\nda distribui\u00e7\u00e3o de comprimento de gargantas, a distribui\u00e7\u00e3o de tamanhos de\nporos e a raz\u00e3o do comprimento pelo raio dos poros conectantes. A varia\u00e7\u00e3o\ndo fator de expans\u00e3o de gargantas implicou no crescimento do comprimento\ndas gargantas e uma leve altera\u00e7\u00e3o na distribui\u00e7\u00e3o de tamanhos de poros e\nnos volumes dos mesmos. Concluiu-se que os elementos mais alterados pelo\nfator s\u00e3o as pr\u00f3prias gargantas e a contribui\u00e7\u00e3o dessa vari\u00e1vel \u00e9 vital para a\ndefini\u00e7\u00e3o delas.\n\nAp\u00f3s a an\u00e1lise dos casos de estudo S1 e C1, fez-se uma breve de-\nmonstra\u00e7\u00e3o dos resultados para os arenitos S2, S3, S5 e A1, refor\u00e7ando as\nconstata\u00e7\u00f5es j\u00e1 feitas. De maneira an\u00e1loga tem-se a rochas carbon\u00e1tica C2,\n\n\n\n111\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1\n\n?\n\n?\n\n?\n\n?\n\n? ? ? ? ?\n? ?\n\n?\n\n?\n\n?0\n\n50\n\n100\n\n150\n\n?\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\nF\nat\n\nor\n d\n\ne \nfo\n\nrm\na\u00e7\n\n\u00e3o\n\nVolume\n\nFigura 57: Fatores de forma Fx para as redes EMB e MB\n\npara qual o resultado continuou a demonstrar tend\u00eancias similares. Contudo,\no n\u00famero de elementos triangulares, circulares e quadrados nas RPs do EMB\ne MB, cuja defini\u00e7\u00e3o \u00e9 dado pelo fator de forma, foi bastante diferente. As\nfiguras 54 e 55 demonstram os fatores de forma para as redes de esferas m\u00e1-\nximas e exatas e esferas m\u00e1ximas que s\u00e3o t\u00e3o diferentes que parecem definir\nvari\u00e1veis distintas. Isso deve-se a forma como na implementa\u00e7\u00e3o do MB de\nDong e Blunt (2007) os fatores de formas s\u00e3o exportados para o simulador\ntwo phase. Na tese, define-se que o fator de forma segue uma varia\u00e7\u00e3o arbi-\ntr\u00e1ria entre os raios Rmin e Rmax a qual varia em fun\u00e7\u00e3o de uma distribui\u00e7\u00e3o\nnormal, observada nas duas figuras.\n\nA tabela 16, demonstra a raz\u00e3o dos valores obtidos no EMB, das ta-\nbelas 10, 11, 12 e 13, para os fatores de expans\u00e3o referentes em rela\u00e7\u00e3o ao\nMB, na tabela 14. H\u00e1 uma aproxima\u00e7\u00e3o de resultados do EMB e MB, para\nvalores de expans\u00e3o maiores, tanto para os fatores de forma como para as\npermeabilidades absoluta. Contudo, para o \u00faltimo caso, os resultados podem\nser considerados mais interessantes, uma vez que tanto a m\u00e9dia tende mais\na 1 como a vari\u00e2ncia diminui. J\u00e1 para o fator de forma, a vari\u00e2ncia tende a\naumentar, para os casos de teste, indicando que os resultados apesar de mais\npr\u00f3ximos, tendem a variar mais. As figuras 58 e 57, demonstram grafica-\nmente os valores das tabelas 10, 11, 12, 13 e 14 para a execu\u00e7\u00e3o no eixo das\nabcissas.\n\n\n\n112\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1\n\n?\n\n?\n\n? ?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n0e+00\n\n2e+04\n\n4e+04\n\n6e+04\n\n8e+04\n\n1e+05\n\nP\ne\nr\nm\n\ne\na\nb\nil\n\nid\na\nd\n\ne\n (\n\nm\nD\n\n)\n\nVolume\n\n?\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\nFigura 58: Permeabilidades Kx, em mD, para as redes EMB e MB\n\nFx 0.5 Fx 0.6 Fx 0.7 Fx 0.8 Kx 0.5 Kx 0.6 Kx 0.7 Kx 0.8\nS1 0.345 0.401 0.524 0.602 1.057 0.884 0.636 0.555\nS2 0.185 0.217 0.250 0.286 2.305 1.922 1.662 1.452\nS3 0.576 0.783 0.934 1.059 1.174 0.825 0.675 0.598\nS4 0.553 0.710 0.862 0.986 0.481 0.369 0.295 0.254\nS5 0.125 0.159 0.188 0.218 3.998 2.795 2.475 2.107\nS6 0.149 0.193 0.204 0.228 3.388 2.510 2.408 2.049\nS7 0.130 0.154 0.186 0.195 2.558 2.064 1.767 1.720\nS8 0.125 0.143 0.166 0.186 3.472 2.970 2.511 2.185\nS9 0.132 0.145 0.181 0.205 32.420 25.190 18.591 16.400\nC1 0.146 0.184 0.192 0.217 4.163 3.438 3.218 2.605\nC2 5.528 6.858 8.117 8.682 1.097 0.791 0.724 0.704\nA1 0.149 0.172 0.204 0.228 2.274 1.950 1.611 1.433\nM\u00e9dia 0.678 0.843 1.001 1.091 4.866 3.809 3.048 2.672\nVari\u00e2ncia 2.360 3.638 5.097 5.813 76.800 46.287 24.791 19.257\n\nTabela 17: Tabela que apresenta a raz\u00e3o do resultado obtido pela simula\u00e7\u00e3o\nna rede EMB em rela\u00e7\u00e3o aos resultados do trabalho de Dong e Blunt (2007)\npara diferentes fatores de expans\u00e3o, no eixo x\n\n\n\n113\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 C1 C2 A1\n\n?\n\n?\n\n? ?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n0e+00\n\n2e+04\n\n4e+04\n\n6e+04\n\n8e+04\n\n1e+05\n\nP\ne\nr\nm\n\ne\na\nb\nil\n\nid\na\nd\n\ne\n (\n\nm\nD\n\n)\n\nVolume\n\n?\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\nFigura 59: Permeabilidades Kx, em mD, para as redes EMB e o resultado\noriginal de Dong e Blunt (2007)\n\nA tabela 17 demonstra a raz\u00e3o dos valores obtidos no EMB, das ta-\nbelas 10, 11, 12 e 13, em rela\u00e7\u00e3o aos valores demonstrados na tese de Dong\ne Blunt (2007), cujos valores est\u00e3o na tabela 15. Assim como no c\u00f3digo ro-\ndado, h\u00e1 uma tend\u00eancia a aproxima\u00e7\u00e3o dos resultados obtidos no MB e EMB\npara o aumento do fator de expans\u00e3o. Os melhores casos nesse sentido s\u00e3o\nos volumes S3 e S4 que s\u00e3o casos onde a popula\u00e7\u00e3o de poros e gargantas \u00e9\nbastante alta a distribui\u00e7\u00e3o de comprimentos e raios tende a valores baixos. \u00c9\nposs\u00edvel que isso deva-se ao fato do MB encontrar raios maiores, diminuindo\na correla\u00e7\u00e3o entre ambos. Entretanto, tal conjectura requer um estudo mais\nprofundo das vari\u00e1veis envolvidas no fator de forma, sobretudo das etapas\nintermediarias de c\u00e1lculo, destacadas na se\u00e7\u00e3o 5.5.1.\n\nOs valores de permeabilidade absoluta est\u00e3o em acordo com o j\u00e1 ob-\nservado nas tabelas da execu\u00e7\u00e3o do MB. H\u00e1 uma proximidade, em m\u00e9dia, dos\nvalores, e uma diminui\u00e7\u00e3o da vari\u00e2ncia com o crescimento do fator de expan-\ns\u00e3o. Ainda assim, os valores do MB rodado s\u00e3o mais pr\u00f3ximos dos extra\u00eddos\ndo EMB. Conforme j\u00e1 observado no in\u00edcio desse cap\u00edtulo, o simulador two\nphase, apesar de fornecer informa\u00e7\u00f5es detalhadas da rede de entrada, resulta\nem valores distintos para execu\u00e7\u00e3o em diferentes plataformas e para diferen-\ntes compiladores. Tal fato pode ser fruto do fato da biblioteca b\u00e1sica de mate-\nm\u00e1tica ser implementada de diferentes maneiras em cada ambiente. Ou seja,\n\n\n\n114\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 C1 C2 A1\n\n?\n\n?\n\n?\n\n?\n\n? ? ? ? ?\n?\n\n?\n\n?0\n\n50\n\n100\n\n150\n\n?\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\nF\nat\n\nor\n d\n\ne \nfo\n\nrm\na\u00e7\n\n\u00e3o\n\nVolume\n\nFigura 60: Fatores de forma Fx para as redes EMB e o resultado original de\nDong e Blunt (2007)\n\nn\u00e3o h\u00e1 como reproduzir o ambiente de execu\u00e7\u00e3o utilizado em Dong e Blunt\n(2007) sem utilizar-se a mesma vers\u00e3o de compilador, sistema operacional e\nna mesma m\u00e1quina, e principalmente os par\u00e2metros originais utilizados em\ncada execu\u00e7\u00e3o.\n\nAs tabelas de resultados para os eixos y e z est\u00e3o nos anexos, se\u00e7\u00e3o\n7.3. Os resultados visuais e caracter\u00edsticas b\u00e1sicas das RPs dos arenitos S4,\nS6, S7, S8 e S9 est\u00e3o na se\u00e7\u00e3o 7.2, tamb\u00e9m nos anexos.\n\n\n\n115\n\n6 CONCLUS\u00c3O\n\nNeste cap\u00edtulo encontram-se as reflex\u00f5es finais a respeito desse traba-\nlho, fruto das conclus\u00f5es locais de cada cap\u00edtulo, nas se\u00e7\u00f5es 3.6, 4.6 e 5.6.\nAs conclus\u00f5es sobre essa trabalho s\u00e3o feitas em tr\u00eas partes, as reflex\u00f5es con-\nclusivas, os trabalhos futuros e os reconhecimentos e agradecimentos \u00e0queles\nque contribu\u00edram com esse trabalho.\n\n6.1 REFLEX\u00d5ES CONCLUSIVAS\n\nNo cap\u00edtulo 3, foi feita uma vis\u00e3o geral de como s\u00e3o adquiridos os\ndados brutos e as imagens microtomogr\u00e1ficas de rochas. Observou-se como\na partir da an\u00e1lise das imagens microtomogr\u00e1ficas, \u00e9 poss\u00edvel aprimorar os\nresultados na etapa de binariza\u00e7\u00e3o de imagem. Os algoritmos de binariza-\n\u00e7\u00e3o s\u00e3o v\u00e1rios e mesmo os automatizados diferem em muitos pontos, por\u00e9m,\nmesmo um m\u00e9todo da bissetriz, visto no algoritmo 1, \u00e9 suficiente para o aux\u00ed-\nlio ao especialista. Ainda assim, ele pode modificar esse valor manualmente\nconforme necess\u00e1rio.\n\nDefiniu-se uma t\u00e9cnica baseada em compress\u00e3o RLE para diminuir\no tamanho do volume em mem\u00f3ria, definindo segmentos de valores pretos\nou brancos. Ainda assim, foi poss\u00edvel obter desempenhos de ordem linear\nutilizando-se a ideia da se\u00e7\u00e3o 4.5. A itera\u00e7\u00e3o por segmento ao inv\u00e9s de valor\nde pixel n\u00e3o s\u00f3 permite a otimiza\u00e7\u00e3o de mem\u00f3ria mas tamb\u00e9m a de processa-\nmento, principalmente efetiva em volumes grandes. Conforme demonstrado\nna se\u00e7\u00e3o citada, a mesma ideia \u00e9 aplic\u00e1vel a v\u00e1rias estruturas de dados que\nutilizem necessite armazenar valores relacionados ao meio poroso, sendo as-\nsim uma t\u00e9cnica de compress\u00e3o extremamente interessante com rela\u00e7\u00e3o aos\nmeios porosos.\n\nTem-se assim uma t\u00e9cnica simples, a n\u00edvel de implementa\u00e7\u00e3o e com-\npreens\u00e3o, com alta taxa de compress\u00e3o, onde os pode-se dividir os valores\nem segmentos de valores homog\u00eaneos. A taxa de compress\u00e3o \u00e9 menor que\na pr\u00f3pria porosidade do volume, variando de 5% a 20% para os volumes de\nentrada para os volumes de entrada.\n\nNo cap\u00edtulo 4, foram descritas as esferas m\u00e1ximas (MB), esferas m\u00e1-\nximas exatas (EMB), extra\u00e7\u00e3o r\u00e1pida de rede (FNE) e o m\u00e9todo baseado em\nprocessos (PB) e os resultados comparativos entre o EMB e o MB, para as\ndiversas etapas observadas na figura 7. O algoritmo MB original n\u00e3o possu\u00eda\nnenhum tipo de paraleliza\u00e7\u00e3o em suas etapas. A paraleliza\u00e7\u00e3o das etapas se-\nriais do algoritmo resultaram em ganhos de performance not\u00e1veis. Tamb\u00e9m,\n\n\n\n116\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1\n\nVolumes\n\n0\n\n100\n\n200\n\n300\n\n400\n\n500\n\n600\n\n? ?\n\n?\n\n?\n\n?\n\n?\n\n? ?\n\n? ? ?\n?\n\n?\n\n?\n\nM\neg\n\nae\nsf\n\ner\nas\n\n p\nor\n\n s\neg\n\nu\nn\n\nd\no\n\n?\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\nFigura 61: Valores em milhares de esferas processadas por segundo, durante\na execu\u00e7\u00e3o do EMB e MB no eixo x. A linha pontilhada \u00e9 a m\u00e9dia global\n\na utiliza\u00e7\u00e3o do mapa de dist\u00e2ncias exatas em substitui\u00e7\u00e3o ao inflar de esfe-\nras do MB diminuiu drasticamente o tempo de busca das esferas (figura 20),\nrespons\u00e1vel por quase 50% do tempo total em alguns volumes no algoritmo\noriginal.\n\nA figura 61 mostra os valores em mega esferas (mil esferas) por se-\ngundo de execu\u00e7\u00e3o para os volumes amostrais utilizados. O n\u00famero de es-\nferas contadas s\u00e3o o total de esferas encontradas e n\u00e3o o total remanescente\nap\u00f3s a remo\u00e7\u00e3o. Isso foi feito de modo a haver um piso equalit\u00e1rio compa-\nrativo entre as duas t\u00e9cnicas. De outra forma, o desempenho do EMB seria\nainda mais destacado pelo fato dele remover menos esferas. No geral, os\nvalores flutuam de 50 a 300 mega esferas por segundo para o EMB, com ex-\nce\u00e7\u00e3o dos volumes S3 e S4. J\u00e1 no MB, ficam sempre abaixo dos valores do\nEMB, variando de aproximadamente 25 a 115 mega esferas processadas por\nsegundo.\n\nO conjunto de otimiza\u00e7\u00e3o de etapas individuais e paraleliza\u00e7\u00e3o dessas,\nfez com que, para todos os volumes de entrada, o tempo total de execu\u00e7\u00e3o\nfosse inferior no EMB, mesmo com um volume maior de esferas sendo pro-\ncessadas. As etapas de remo\u00e7\u00e3o de esferas auto-inclusas e aglomera\u00e7\u00e3o apre-\nsentaram resultados menos promissores, por\u00e9m ainda sim positivos e menores\nque os tempos apresentados pela implementa\u00e7\u00e3o original. Portanto, um dos\n\n\n\n117\n\nobjetivos principais desse trabalho foi alcan\u00e7ado, isto \u00e9, obter um tempo de\nexecu\u00e7\u00e3o total menor que o algoritmo MB original, mesmo com um volume\nmaior de dados sendo processados.\n\nA partir dos resultados obtidos pela extra\u00e7\u00e3o de redes de poros, fez-se\num exportador para o formato aceito como entrada pelo simulador two phase,\nutilizado tamb\u00e9m por Dong e Blunt (2007) e, portanto prop\u00edcio a uma com-\npara\u00e7\u00e3o direta com esse. Fez-se uma descri\u00e7\u00e3o extensiva das amostras S1 e\nC1, avaliando fatores como distribui\u00e7\u00e3o de raios e volumes de poros e com-\nprimentos, raios e volumes de gargantas. Tamb\u00e9m, observou-se o n\u00famero de\ncoordena\u00e7\u00e3o em ambas as amostras e os valores visuais e emp\u00edricos obtidos\ndiretamente da rede. Foi verificado que o fator de expans\u00e3o de gargantas \u00e9\nvital para defini\u00e7\u00e3o das distribui\u00e7\u00f5es de gargantas, principalmente no que diz\nrespeito aos comprimentos e volumes, enquanto os poros s\u00e3o pouco modifi-\ncados pelo aumento do fator.\n\nOs fatores de forma observados para as redes EMB e MB s\u00e3o bastante\ndiferentes, por\u00e9m esse fato foi explanado na se\u00e7\u00e3o 5.5.1. O exportador de\nredes do MB converte os fatores de forma para uma distribui\u00e7\u00e3o normal para\nobter um comportamento mais pr\u00f3ximo do m\u00e9todo baseado em processos\n(DONG; BLUNT, 2007). Tal distin\u00e7\u00e3o foi explorado na se\u00e7\u00e3o 5.5.1.\n\nN\u00e3o foi poss\u00edvel rodar todas as redes exportadas pela implementa\u00e7\u00e3o\ndo MB, feita pelo mesmo, contudo obteve-se \u00eaxito no eixo x. Assim, foram\nfeitas compara\u00e7\u00f5es de permeabilidade e fator de forma somente para esse\neixo. Observou-se que, principalmente para a permeabilidade, os resultados\nfinais foram de mesma escala de grandeza, uma das metas desse trabalho.\nAl\u00e9m disso, os resultados foram pr\u00f3ximos, em valores absolutos com o EMB\ngerando, em geral, valores maiores para permeabilidade absoluta e menores\npara fator de forma. Isso \u00e9 condizente com a defini\u00e7\u00e3o de ambos, uma vez\nque s\u00e3o vari\u00e1veis inversamente proporcionais.\n\nUm dos objetivos que n\u00e3o foi alcan\u00e7ado foi o de comparar os resulta-\ndos obtidos com o LBM ou dados obtidos por meio de m\u00e9todos destrutivos.\nTais testes necessitam de aparelhagem e softwares n\u00e3o estavam dispon\u00edveis\ndurante a execu\u00e7\u00e3o deste trabalho. Assim, a compara\u00e7\u00e3o com dados terceiros\n\u00e9 vista como um trabalho futuro, principalmente como valida\u00e7\u00e3o da t\u00e9cnica\nutilizada, isto \u00e9, uma compara\u00e7\u00e3o com um padr\u00e3o ouro.\n\nApesar de v\u00e1rios resultados positivos, h\u00e1 uma s\u00e9rie de trabalhos futu-\nros e trabalhos incompletos que devem ser revistos em poss\u00edveis retomadas\ndo tema. A se\u00e7\u00e3o 6.2 trata exclusivamente de ideias n\u00e3o contempladas neste\ntrabalho.\n\n\n\n118\n\n6.2 TRABALHOS FUTUROS\n\nNessa se\u00e7\u00e3o s\u00e3o exploradas tr\u00eas quatro vertentes diferentes a serem\ntrabalhadas. S\u00e3o elas: otimiza\u00e7\u00f5es em cpu e gpu, valida\u00e7\u00e3o com outras t\u00e9cni-\ncas, o estudo de vari\u00e1veis de entrada e sa\u00edda e o tratamento de dados multies-\ncalares e volumes grandes.\n\n6.2.1 Otimiza\u00e7\u00f5es em cpu e gpu\n\nEm termos de desempenho, o EMB foi melhor que o MB em todos os\ncasos de entrada, entretanto mesmo para volumes pequenos, com 300 voxels\nde lado, o algoritmo pode levar algumas dezenas de segundos.\n\nUm questionamento a ser feito \u00e9 se h\u00e1 a possibilidade de obter um\ndesempenho garantido, em tempo h\u00e1bil, para uma determinada faixa de vo-\nlume. Um exemplo: 500 voxels de lado e 5s de tempo m\u00e1ximo de execu-\n\u00e7\u00e3o. Acredita-se que a resposta seja afirmativa, pela observa\u00e7\u00e3o de algumas\ncaracter\u00edsticas e algoritmos existentes na literatura e pela possibilidade de\nmodificar-se os algoritmos existentes de modo a torn\u00e1-los mais eficientes e\nparaleliz\u00e1veis. Ainda assim, tais requisitos de desempenho s\u00e3o extremistas e\nrequerem profundo estudo e mudan\u00e7as em v\u00e1rias etapas e, no caso de gpus,\num hardware robusto e que obede\u00e7a o padr\u00e3o Khronos OpenCLTMou NVI-\nDIA CUDATM.\n\nExistem cinco pontos principais explor\u00e1veis. Cada um deles ser\u00e1 ob-\nservado de maneira individual.\n\nAGLOMERA\u00c7\u00c3O\n\nA aglomera\u00e7\u00e3o \u00e9 a etapa que consome mais tempo de processamento\ndo algoritmo de esferas m\u00e1ximas, ainda mais na vers\u00e3o exata. Neste \u00faltimo,\nfoi feita a paraleliza\u00e7\u00e3o da busca e intersec\u00e7\u00e3o de esferas de mesmo raio, e\nobteve-se uma melhora significativa de desempenho. Contudo, o esquema\nutilizado na paraleliza\u00e7\u00e3o possui uma etapa serial relativamente grande que \u00e9\na expans\u00e3o da garganta encontrada e processamento das esferas vizinhas.\n\nExistem duas vertentes poss\u00edveis de solu\u00e7\u00e3o do problema relatado. A\nprimeira \u00e9 propor um esquema produtor e consumidor, onde cada esfera pro-\ncessada em paralelo pelo produtor avisando o consumidor da necessidade de\nprocessamento da esfera. O consumidor ent\u00e3o processa a esfera e aguarda\noutra. A segunda solu\u00e7\u00e3o \u00e9 propor um algoritmo de aglomera\u00e7\u00e3o novo, con-\ntemplando a paraleliza\u00e7\u00e3o.\n\n\n\n119\n\nNo esquema produtor e consumidor, a dificuldade de implementa\u00e7\u00e3o\n\u00e9 pequena e os resultados s\u00e3o, em tese, promissores. No caso de propor um\nnovo algoritmo para a aglomera\u00e7\u00e3o, tem-se a necessidade da valida\u00e7\u00e3o do\nnovo esquema segundo o padr\u00e3o ouro, do algoritmo original. Tamb\u00e9m, al-\ngumas etapas do algoritmo s\u00e3o claramente seriais e a paraleliza\u00e7\u00e3o total ne-\ncessitaria em alguns casos de um mecanismo de rollback. Isto \u00e9, seria neces-\ns\u00e1rio checar poss\u00edveis colis\u00f5es de depend\u00eancia entre esferas de mesmo raio\nintersectantes para n\u00e3o haver uma viola\u00e7\u00e3o das etapas definidas e consequen-\ntemente um resultado incorreto.\n\nEm suma, seria l\u00f3gico a implementa\u00e7\u00e3o do esquema produtor e con-\nsumidor e, caso n\u00e3o fosse suficiente para obter o desempenho esperado, a\nmodifica\u00e7\u00e3o do algoritmo de modo a faz\u00ea-lo perder grandes partes seriais.\n\nUma poss\u00edvel implementa\u00e7\u00e3o em gpu da aglomera\u00e7\u00e3o requereria uma\nmodifica\u00e7\u00e3o total do algoritmo, at\u00e9 porque a expans\u00e3o de gargantas n\u00e3o po-\nderia ser feita da forma atual, isto \u00e9, sequencialmente. Uma alternativa menos\nradical \u00e9 modificar somente a busca de esferas vizinhas, aliada ao esquema\nde produtor e consumidor em cpu. Em tese, essa forma traria os melhores re-\nsultados. Entretanto, tais conjecturas necessitam de reflex\u00e3o e testes pontuais\npara serem feitas. Assim, s\u00e3o consideradas um trabalho futuro.\n\nBUSCA DE ESFERAS VIZINHAS\n\nA intersec\u00e7\u00e3o de esferas \u00e9 feita da maneira exata e \u00f3tima, contudo h\u00e1\na possibilidade de aumentar-se a paraleliza\u00e7\u00e3o dos algoritmos que a utilizam.\nIsto \u00e9, otimizar a busca de esferas intersect\u00e1veis e n\u00e3o a intersec\u00e7\u00e3o em si.\nA busca de esferas colid\u00edveis \u00e9 utilizada na remo\u00e7\u00e3o de esferas auto-inclusas\ne na aglomera\u00e7\u00e3o de maneira extensiva. A otimiza\u00e7\u00e3o do passos em cpu,\npor meio da paraleliza\u00e7\u00e3o dos algoritmos e da transforma\u00e7\u00e3o da busca em\numa opera\u00e7\u00e3o linear, conforme demonstrado na se\u00e7\u00e3o 4.5, obteve ganhos de\ndesempenho observado em ambas. Isto \u00e9, as etapas \u00fanicas de cada algoritmo\nn\u00e3o foram paralelizadas, mas somente a busca de esferas intersect\u00e1veis.\n\nApesar de otimizar a utiliza\u00e7\u00e3o de processamento, as otimiza\u00e7\u00f5es cita-\ndas necessitam guardar o resultado intermedi\u00e1rio para cada esfera de mesmo\nraio, ou seja, utilizam mais mem\u00f3ria, mesmo que de maneira tempor\u00e1ria. As-\nsim, acredita-se que a utiliza\u00e7\u00e3o de algum esquema de intersec\u00e7\u00e3o em massa\nentre esferas seja capaz de obter resultados interessantes, se implementado\nem gpu, por\u00e9m a utiliza\u00e7\u00e3o de mem\u00f3ria pode ser proibitiva, sobretudo em\nvolumes grandes.\n\n\n\n120\n\nESTRUTURAS COMPRIMIDAS EM GPU\n\nA representa\u00e7\u00e3o de estruturas comprimidas em gpu, assim como fo-\nram concebidas em cpu, possibilita a implementa\u00e7\u00e3o dos diversos algoritmos\nobservados no cap\u00edtulo 4 de maneira a utilizar menos mem\u00f3ria. Tais otimiza-\n\u00e7\u00f5es de mem\u00f3rias s\u00e3o imprescind\u00edveis, at\u00e9 porque a mem\u00f3ria dispon\u00edvel em\ngpu \u00e9, em geral, menor que a mem\u00f3ria principal, dispon\u00edvel para CPU. Isto\ndeve-se ao fato da arquitetura \u00fanica da gpu, denominada single instruction\nmultiple thread (SIMT).\n\nImplementando-se as estruturas comprimidas em gpu, tem-se a pos-\nsibilidade de aplicar as ideias referentes a intersec\u00e7\u00e3o de esferas e busca de\nesferas nessa arquitetura. O principal desafio seria adaptar os algoritmos re-\nferentes para utilizar a mem\u00f3ria local, um tipo de mem\u00f3ria pequena e r\u00e1pida,\ncom garantia de acesso em tempo de registrador para um acesso coalescente\n\u00e0 mem\u00f3ria.\n\nBUSCA DE ESFERAS EM GPU\n\nA busca de esferas de maneira exata, em gpu, \u00e9 poss\u00edvel. O algoritmo\nde parallel banding \u00e9 capaz de extrair um mapa de dist\u00e2ncias exatas a partir de\nimagens binarizadas. Tal algoritmo, assim como de Saito e Toriwaki (1994),\npossui tr\u00eas passos distintos de transforma\u00e7\u00e3o: 1D, 2D e 3D.\n\nA ideia \u00e9 dividir o volume em faixas (bands) distintas e resolver o\nproblema localmente. Ap\u00f3s solver o problema local, tem-se um passo de\nredu\u00e7\u00e3o global, unindo resultados vizinhos. Em sequ\u00eancia, tem-se a nova\naplica\u00e7\u00e3o do passo de solucionar as dist\u00e2ncias e a transformada \u00e9 completa.\n\nNo eixo 1D, os tr\u00eas passos descritos s\u00e3o aplicados de maneira sem\naltera\u00e7\u00e3o. Na 2D, tem-se a necessidade de uma ordena\u00e7\u00e3o de faixas a se-\nrem visitadas. Colocando-as em uma pilha de visita\u00e7\u00e3o. A parte serial \u00e9 pe-\nquena em rela\u00e7\u00e3o a paralela e os desempenhos finais obtidos com tal t\u00e9cnica\n\u00e9 melhor mesmo que em t\u00e9cnicas similares que calculam somente a dist\u00e2ncia\naproximada. No eixo 3D a ideia \u00e9 hom\u00f3loga ao 2D.\n\nA otimiza\u00e7\u00e3o da etapa de busca pode parecer desnecess\u00e1ria pelo fato\ndessa etapa ser a menos custosa entre todas as 4. Contudo, a otimiza\u00e7\u00e3o das\noutras fases pode vir a destacar essa como gargalo e solucionar esse problema\nem gpu pode ser \u00fatil em implementa\u00e7\u00f5es diversas, uma vez que o mapa de\ndist\u00e2ncias exatas possui muitas outras aplica\u00e7\u00f5es.\n\n\n\n121\n\nUTILIZA\u00c7\u00c3O DE PONTO FIXO AO INV\u00c9S DE PONTO FLUTUANTE\n\nO ponto flutuante prov\u00ea uma maneira de representar n\u00fameros decimais\nnum computador. Uma outra maneira de representar-se n\u00fameros desse tipo \u00e9\no ponto fixo. A vantagem dessa nota\u00e7\u00e3o sobre o ponto flutuante \u00e9 a de utilizar\nsomente de opera\u00e7\u00f5es inteiras para fazer opera\u00e7\u00f5es sobre a representa\u00e7\u00e3o.\nAssim, em cpu, haveriam ganhos grandes. Em contrapartida, a opera\u00e7\u00e3o de\nextra\u00e7\u00e3o da raiz quadrada, tipicamente utilizada nas f\u00f3rmulas de intersec\u00e7\u00e3o\ne obten\u00e7\u00e3o do raio das esferas seria aproximada.\n\nO resultado final tenderia a ser mais preciso que o MB, mas menos\npreciso que o EMB. Uma avalia\u00e7\u00e3o do resultado final seria necess\u00e1ria, mas\nacredita-se que o ganho de efici\u00eancia seria interessante o suficiente para jus-\ntificar o tradeoff.\n\n6.2.2 Valida\u00e7\u00e3o com outras t\u00e9cnicas e estudo de vari\u00e1veis de entrada e\nsa\u00edda\n\nA valida\u00e7\u00e3o com outras t\u00e9cnicas ser\u00e1 vital afim de comprovar a efic\u00e1-\ncia e capacidade de representa\u00e7\u00e3o da rede para as caracter\u00edsticas geom\u00e9tricas,\ntopol\u00f3gicas e petrof\u00edsicas da rede, sobretudo nas previs\u00f5es de escoamento e\nsimula\u00e7\u00f5es multif\u00e1sicas. Nos trabalhos de Al-Kharusi e Blunt (2007) e Dong\ne Blunt (2007) definiu-se uma compara\u00e7\u00e3o com o m\u00e9todo PB, com LBM e\ncom dados obtidos por an\u00e1lise em laborat\u00f3rio como a porosimetria por inje-\n\u00e7\u00e3o de merc\u00fario descrita no cap\u00edtulo 3.\n\nNeste trabalho, n\u00e3o foi poss\u00edvel fazer paralelos com outras t\u00e9cnicas\npor motivos diversos. Entre eles, indisponibilidade de equipamento e im-\npossibilidade de aquisi\u00e7\u00e3o de licen\u00e7as dos softwares capazes de extrair tais\ndados. Se solucionado os problemas descritos, existe a possibilidade de uma\nvalida\u00e7\u00e3o baseada em dados obtidos por outras t\u00e9cnicas.\n\nA partir dos dados validados, torna-se poss\u00edvel definir quais valores\nutilizar em vari\u00e1veis parametriz\u00e1veis do algoritmo, isto \u00e9 o fator de expans\u00e3o\ndas gargantas e o tamanho m\u00ednimo em voxels para uma esfera ser classificada\ncomo poro.\n\nAcredita-se que tais vari\u00e1veis n\u00e3o tenham um valor \u00f3timo para todos\nos volumes, por\u00e9m que em determinados tipos de rocha, valores \u00f3timos ob-\ntidos, por meio da an\u00e1lise da varia\u00e7\u00e3o dos par\u00e2metros, existam. Uma outra\npossibilidade, seria propor vari\u00e1veis adaptativas em ambos os casos, ou seja,\nfatores de expans\u00e3o adaptativos, dependentes dos tamanhos dos poros conec-\ntantes e da garganta em quest\u00e3o. Tamb\u00e9m, os tamanhos m\u00ednimos de poro\npoderiam ser dependentes do tamanho do volume.\n\n\n\n122\n\n6.2.3 Tratamento de dados multiescalares e volumes grandes\n\nDois pontos que n\u00e3o foram abordados durante o trabalho mas foram\ncitados direta ou indiretamente s\u00e3o a representa\u00e7\u00e3o de volumes grandes e o\ntratamento de dados multiescalares. Durante o cap\u00edtulo 3, descreveu-se uma\nt\u00e9cnica para compress\u00e3o eficiente de volumes binarizados. Ainda assim, a\nrepresenta\u00e7\u00e3o de volumes gigantescos com mais de 8000 voxels de lado \u00e9\num desafio na atualidade. Principalmente, se aliado ao tamanho do volume\ntem-se diferentes amostras com resolu\u00e7\u00f5es distintas representando os mes-\nmos dados.\n\nO tratamento de dados multiescalares, mesmo sua visualiza\u00e7\u00e3o \u00e9 um\ndesafio. Em Guthe et al. (2002), utilizou-se a compress\u00e3o por wavelets para\na visualiza\u00e7\u00e3o de dados em v\u00e1rias qualidades distintas. O objetivo do traba-\nlho era ser capaz de visualizar grandes volumes de dados em workstations\npadr\u00f5es da \u00e9poca. Ao considerar-se o panorama de visualiza\u00e7\u00e3o de m\u00faltiplos\nvolumes, o uso da gpu \u00e9 imprescind\u00edvel (BEYER, 2009; KAINZ et al., 2009).\n\nA caracteriza\u00e7\u00e3o de volumes multiescalares tamb\u00e9m constitui um de-\nsafio recorrente e tem sido abordado com maior frequ\u00eancia em tempos re-\ncentes (NORDBOTTEN, 2009; BISWAL et al., 2011). Ela \u00e9 \u00fatil na carac-\nteriza\u00e7\u00e3o de volumes heterog\u00eaneos pela representa\u00e7\u00e3o macrosc\u00f3picas e mi-\ncrosc\u00f3pica das caracter\u00edsicas da rocha. Pode-se considerar a caracteriza\u00e7\u00e3o\nmultiescalar como um problema aberto, cuja solu\u00e7\u00e3o, mesmo para casos sin-\ngulares, requer um estudo profundo.\n\n6.3 RECONHECIMENTOS E AGRADECIMENTOS\n\nEsse trabalho foi fruto de uma opera\u00e7\u00e3o conjunta entre a Petrobras,\no O Laborat\u00f3rio de Meios Porosos e Propriedades Termof\u00edsicas (LMPT) e o\nLaborat\u00f3rio de Processamento de Imagens e Computa\u00e7\u00e3o gr\u00e1fica (LAPIX),\nambos da Universidade Federal de Santa Catarina. Conforme descrito no ca-\np\u00edtulo 3, quatro das amostras (C3, C4, S10 e S11) foram disponibilizadas pelo\nLMPT e pela Petrobras. Alguns dos resultados desse trabalham intersectam\ndiretamente com o trabalho de Cunha (2012) e a leitura desse, al\u00e9m de ser\ncomplementar a esse trabalho, \u00e9 indispens\u00e1vel para compreens\u00e3o completa\nda \u00e1rea da caracteriza\u00e7\u00e3o de meios porosos.\n\nAgrade\u00e7o tamb\u00e9m aos colegas Felipe Borges Alves, Jeferson Vieira\nRamos e Renan Teston In\u00e1cio. Todos parceiros de projeto e de laborat\u00f3rio h\u00e1\nanos. Em especial ao Renan, pela descoberta das aproxima\u00e7\u00f5es feitas por Hu\nDong em seu trabalho e pela ideia de fazer uma compress\u00e3o por segmentos,\na qual foi definida e implementada nesse trabalho. Os trabalhos de Ramos\n\n\n\n123\n\n(2012) e In\u00e1cio (2012) tamb\u00e9m complementam os resultados obtidos nesse.\nO primero prop\u00f5e a valida\u00e7\u00e3o do EMB, enquanto o segundo trata da renderi-\nza\u00e7\u00e3o de m\u00faltiplas esferas.\n\nAgrade\u00e7o ao Martin Pr\u00fcsse pela ideia de utilizar o ponto fixo no lugar\nde ponto flutuante que pode trazer novos resultados para a extra\u00e7\u00e3o de redes\nde poros. Por fim, agrade\u00e7o o colega Adiel Mittmann, cuja introdu\u00e7\u00e3o \u00e0\nlinguagem R incentivou-me a us\u00e1-la.\n\n\n\n124\n\n\n\n125\n\nREFER\u00caNCIAS BIBLIOGR\u00c1FICAS\n\nAL-KHARUSI, A. S.; BLUNT, M. J. Pore Scale Characterization of\nCarbonate Rocks. Tese (Doutorado), 2007.\n\nBAKKE, S.; OREN, P.-E. 3-d pore-scale modelling of sandstones\nand flow simulations in the pore networks. SPE Journal, Society of\nPetroleum Engineers, v. 2, n. 2, p. 136\u2013149, Jun 1997. Dispon\u00edvel em:\n<http://www.onepetro.org/mslib/servlet/onepetropreview?id=00035479&amp;soc=SPE>.\n\nBERNASCHI, M. et al. A flexible high-performance lattice boltzmann GPU\ncode for the simulations of fluid flows in complex geometries. Concurrency\nComputat.: Pract. Exper., John Wiley &amp; Sons, Ltd., Istituto Applicazioni\nCalcolo, CNR, Viale Manzoni, 30-00185 Rome, Italy; Nvidia Corporation,\n2701 San Tomas Expressway, Santa Clara, CA 95050, U.S.A.; SOFT,\nIstituto Nazionale Fisica della Materia, CNR, P.le A. Moro, 2-00185 Rome,\nItaly; Department of Physics and School of Engineering and Applied\nSciences, Harvard University, Cambridge, MA 02138, U.S.A.; Initiative\nin Innovative Computing, Harvard University, Cambridge, MA 02138,\nU.S.A., v. 22, n. 1, p. 1\u201314, 2010. ISSN 1532-0634. Dispon\u00edvel em:\n<http://dx.doi.org/10.1002/cpe.1466>.\n\nBEYER, J. GPU-based Multi-Volume Rendering of Complex Data in\nNeuroscience and Neurosurgery. Tese (Doutorado) \u2014 Institute of Computer\nGraphics and Algorithms, Vienna University of Technology, Favoritenstrasse\n9-11/186, A-1040 Vienna, Austria, out. 2009. Dispon\u00edvel em:\n<http://www.cg.tuwien.ac.at/research/publications/2009/beyer-2009-gpu/>.\n\nBISWAL, B. et al. Modeling of multiscale porous media. Image Analysis\n&amp; Stereology, v. 28, n. 1, 2011. ISSN 1854-5165. Dispon\u00edvel em:\n<http://www.ias-iss.org/ojs/IAS/article/view/846>.\n\nCHATZIS, I.; DULLIEN, F. A. L. Modelling pore structure by 2-d and 3-d\nnetworks with applicationto sandstones. Journal of Canadian Petroleum\nTechnology, n. 1, Jan 1977.\n\nCHEN, S.; DOOLEN, G. D. Lattice boltzmann method for fluid flows.\nAnnu. Rev. Fluid Mech., v. 30, n. 1, p. 329\u2013364, 1998. Dispon\u00edvel em:\n<http://dx.doi.org/10.1146/annurev.fluid.30.1.329>.\n\nCORWIN, E.; LOGAR, A. Sorting in linear time - variations on the\nbucket sort. J. Comput. Small Coll., Consortium for Computing Sciences\n\n\n\n126\n\nin Colleges, USA, v. 20, p. 197\u2013202, October 2004. ISSN 1937-4771.\nDispon\u00edvel em:&lt;http://dl.acm.org/citation.cfm?id=1040231.1040257>.\n\nCUNHA, A. R. Caracteriza\u00e7\u00e3o de sistemas porosos de rochas reservat\u00f3rio\nde petr\u00f3leo a partir da extra\u00e7\u00e3o de redes poro-liga\u00e7\u00f5es. Disserta\u00e7\u00e3o\n(Mestrado) \u2014 Universidade Federal de Santa Catarina, 2012. Em elabora\u00e7\u00e3o.\n\nDONG, H.; BLUNT, M. J. Micro CT Imaging and Pore Network Extraction.\nTese (Doutorado), 2007.\n\nDONG, H.; BLUNT, M. J. Pore-network extraction from micro-\ncomputerized-tomography images. Physical Review E - Statistical,\nNonlinear and Soft Matter Physics, APS, v. 80, n. 3 Pt 2, p. 036307, 2009.\nDispon\u00edvel em:&lt;http://link.aps.org/doi/10.1103/PhysRevE.80.036307>.\n\nERICSON, C. Real-Time Collision Detection (The Morgan Kauf-\nmann Series in Interactive 3-D Technology). Morgan Kauf-\nmann, 2005. Hardcover. ISBN 1558607323. Dispon\u00edvel em:\n<http://www.amazon.com/exec/obidos/redirect?tag=citeulike07-\n20&amp;path=ASIN/1558607323>.\n\nFABBRI, R. et al. 2D euclidean distance transform algorithms: A\ncomparative survey. ACM Comput. Surv., ACM, New York, NY, USA,\nv. 40, n. 1, p. 1\u201344, fev. 2008. ISSN 0360-0300. Dispon\u00edvel em:\n<http://dx.doi.org/10.1145/1322432.1322434>.\n\nGPU Cluster for High Performance Computing. 47 p. Dispon\u00edvel em:\n<http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=1392977>.\n\nFATT. The network model of porous media iii. dynamic properties of\nnetworks with tube radius distribution. Trans Soc. Min. Eng. AIME, 1956.\n\nFERNANDES, J. S.; APPOLONI, C. R.; FERNANDES, C. P. Determinacao\nde parametros microestruturais e reconstru\u00e7\u00e3o de imagens 3-d de rochas\nreservatorio por microtomografia de raios x. RECEN - Revista Ci\u00eancias\nExatas e Naturais, Vol. 11, No 1 (2009), 2009. ISSN 2175-5620. Dispon\u00edvel\nem:&lt;http://revistas.unicentro.br/index.php/RECEN/article/view/384>.\n\nGUTHE, S. et al. Interactive rendering of large volume data sets. In:\nVisualization, 2002. VIS 2002. IEEE. [S.l.: s.n.], 2002. p. 53 \u201360.\n\nIN\u00c1CIO, R. T. Visualiza\u00e7\u00e3o de conjuntos de dados represent\u00e1veis por\nesferas. Disserta\u00e7\u00e3o (Mestrado) \u2014 Universidade Federal de Santa Catarina,\n2012. Em elabora\u00e7\u00e3o.\n\n\n\n127\n\nJONES, R. W. Comparison of carbonate and shale source rocks. AAPG\nSpecial Volumes, SG 18: Petroleum Geochemistry and Source Rock\nPotential of Carbonate Rocks, p. 163\u2013180, 1984.\n\nKAINZ, B. et al. Ray casting of multiple volumetric datasets with\npolyhedral boundaries on manycore gpus. In: ACM SIGGRAPH\nAsia 2009 papers. New York, NY, USA: ACM, 2009. (SIGGRAPH\nAsia \u201909), p. 152:1\u2013152:9. ISBN 978-1-60558-858-2. Dispon\u00edvel em:\n<http://doi.acm.org/10.1145/1661412.1618498>.\n\nKITCHENHAM, B. Procedures for performing systematic reviews. [S.l.],\n2004.\n\nLERDAHL, T. R.; OREN, P.-E.; BAKKE, S. A predic-\ntive network model for three-phase flow in porous media.\nSociety of Petroleum Engineers, 2000. Dispon\u00edvel em:\n<http://www.onepetro.org/mslib/servlet/onepetropreview?id=00059311&amp;soc=SPE>.\n\nLOTUFO, R.; FALCAO, A.; ZAMPIROLLI, F. Fast euclidean distance\ntransform using a graph-search algorithm. Graphics, Patterns and Images,\nSIBGRAPI Conference on, IEEE Computer Society, Los Alamitos, CA,\nUSA, v. 0, p. 269, 2000. ISSN 1530-1834.\n\nLUCIA, F. J. Carbonate Reservoir Characterization. New York:\nSpringer-Verlag Berlin Heidelberg, 1999. 336 p.\n\nMASON, G.; MORROW, N. R. Capillary behavior of a perfectly\nwetting liquid in irregular triangular tubes. Journal of Colloid and\nInterface Science, v. 141, n. 1, p. 262\u2013274, 1991. Dispon\u00edvel em:\n<http://linkinghub.elsevier.com/retrieve/pii/002197979190321X>.\n\nNORDBOTTEN, J. M. Multiscale methods for multiphase flow in porous\nmedia. In: Domain Decomposition Methods in Science and Engineering\nXVIII. Springer Berlin Heidelberg, 2009, (Lecture Notes in Computational\nScience and Engineering, v. 70). p. 39\u201350. ISBN 978-3-642-02677-5.\nDispon\u00edvel em:&lt;http://dx.doi.org/10.1007/978-3-642-02677-5_4>.\n\nOREN, P.-E.; BAKKE, S. Process based reconstruction of sands-\ntones and prediction of transport properties. Transport in Po-\nrous Media, Springer Netherlands, v. 46, p. 311\u2013343, 2002.\nISSN 0169-3913. 10.1023/A:1015031122338. Dispon\u00edvel em:\n<http://dx.doi.org/10.1023/A:1015031122338>.\n\nPATZEK, T.; SILIN, D. Shape factor and hydraulic conductance in noncircu-\nlar capillaries: I. one-phase creeping flow. Journal of Colloid and Interface\n\n\n\n128\n\nScience, v. 236, n. 2, p. 295 \u2013 304, 2001. ISSN 0021-9797. Dispon\u00edvel em:\n<http://www.sciencedirect.com/science/article/pii/S0021979700974137>.\n\nRAMOS, J. V.\n\nValida\u00e7\u00e3o do C\u00e1lculo de Dados Petrof\u00edsicos com Base na Caracteriza\u00e7\u00e3o de\nRochas de Reservat\u00f3rio \u2014 Universidade Federal de Santa Catarina, 2012.\nEm elabora\u00e7\u00e3o.\n\nROBERT, J.; CORDELL. Chapter 5 carbonates as hydrocarbon source rocks.\nIn: CHILINGARIAN, S. M. G.; RIEKE, H. (Ed.). carbonate reservoir\ncharacterization: a geologic\u2014engineering analysis, part I. Elsevier, 1992,\n(Developments in Petroleum Science, v. 30). p. 271 \u2013 329. Dispon\u00edvel em:\n<http://www.sciencedirect.com/science/article/pii/S0376736109701281>.\n\nSAITO, T.; TORIWAKI, J.-I. New algorithms for euclidean\ndistance transformation of an n-dimensional digitized pic-\nture with applications. Pattern Recognition, v. 27, n. 11,\np. 1551 \u2013 1565, 1994. ISSN 0031-3203. Dispon\u00edvel em:\n<http://www.sciencedirect.com/science/article/pii/0031320394901333>.\n\nSCHENA, G.; FAVRETTO, S. Pore space network characterization with\nsub-voxel definition. Transport in Porous Media, Springer Netherlands,\nv. 70, p. 181\u2013190, 2006. ISSN 0169-3913. 10.1007/s11242-006-9094-z.\nDispon\u00edvel em:&lt;http://dx.doi.org/10.1007/s11242-006-9094-z>.\n\nSCHENA, G.; FAVRETTO, S.; PILLER, M. Pore space characterisation\nand permeability prediction using fast network extraction and pore throat\nconductance calculation. Society of Petroleum Engineers, 2008. Dispon\u00edvel\nem:&lt;http://www.onepetro.org/mslib/servlet/onepetropreview?id=SPE-\n113511-MS&amp;soc=SPE>.\n\nSEZGIN, M.; SANKUR, B. Survey over image thresholding techniques\nand quantitative performance evaluation. Journal of Electronic Imaging,\nSPIE, v. 13, n. 1, p. 146\u2013168, 2004. ISSN 10179909. Dispon\u00edvel em:\n<http://dx.doi.org/10.1117/1.1631315>.\n\nSILIN, D. B.; JIN, G.; PATZEK, T. W. Robust determination of the pore\nspace morphology in sedimentary rocks. Society of Petroleum Engineers,\n2003.\n\nSILVA, A. F. B. et al. A multi-layered development framework for medical\nimaging applications. In: CBMS\u201909. [S.l.: s.n.], 2009. p. 1\u20134.\n\n\n\n129\n\nTORELLI, J. C. et al. A high performance 3D exact euclidean distance\ntransform algorithm for distributed computing. International Journal of\nPattern Recognition and Artificial Intelligence, v. 24, n. 6, p. 1\u201319, 2010.\n\nVALVATNE, P.; BLUNT, M. J. Predictive Pore-Scale Modelling of\nMultiphase Flow. Tese (Doutorado), 2004.\n\nVALVATNE, P. H. et al. Predictive pore-scale modeling of single and\nmultiphase flow. Transport in Porous Media, Springer Netherlands, v. 58, p.\n23\u201341, 2005. ISSN 0169-3913. 10.1007/s11242-004-5468-2. Dispon\u00edvel em:\n<http://dx.doi.org/10.1007/s11242-004-5468-2>.\n\nWASHBURN, E. W. The dynamics of capillary flow. Phys. Rev., v. 17, p.\n273\u2013283, 1921.\n\n\n\n130\n\n\n\n131\n\n7 AP\u00caNDICE A: FORMATO RBV E RESULTADOS\n\n7.1 FORMATO RBV\n\nO formato Run-length Encoded Binary Volume (RBV) \u00e9 composto por\nduas partes. A primeira \u00e9 o header com extens\u00e3o .rbv , cujas informa\u00e7\u00f5es s\u00e3o:\n\nCampo Descri\u00e7\u00e3o Exemplo Tipo\n\nDataDimensions Tamanho do\nvolume em voxels\n\n\u201c300 300 300\u201d Obrigat\u00f3rio\n\nSpacing Espa\u00e7amento entre\ncada voxel\n\n\u201c0.375 0.332 0.8\u201d Obrigat\u00f3rio\n\nBinaryFile Caminho absoluto\nou relativo para a\nparte bin\u00e1ria, isso\n\n\u00e9, o .rle\n\n\u201carquivoTeste.rle\u201d Obrigat\u00f3rio\n\nTitle T\u00edtulo da amostra \u201camostra teste\u201d Opcional\nPorosity Porosidade do\n\nvolume\n\u201c14.769\u201d Opcional\n\nO arquivo .rle \u00e9 definido como um conjunto de headers seguidos de\nsegmentos. Em C:\n\n# i n c l u d e &lt;s t d i n t . h >\n\ns t r u c t R L E S e g m e n t H e a d e r {\nu i n t 1 6 _ t n u m b e r O f S e g m e n t s ;\nu i n t 8 _ t f i r s t P i x e l V a l u e ;\n\n} ;\n\ns t r u c t RLESegment {\nu i n t 1 6 _ t s t a r t ;\nu i n t 1 6 _ t l e n g t h ;\n\n} ;\n\n7.2 VALORES PARA DEMAIS VOLUMES\n\nNessa se\u00e7\u00e3o s\u00e3o apresentados os resultados obtidos pela extra\u00e7\u00e3o das\nRPs nos arenitos S4, S6, S7, S8 e S9. Os resultados observados nesses valores\ns\u00e3o an\u00e1logos aos apresentados durante o cap\u00edtulo 5. Tamb\u00e9m s\u00e3o apresenta-\ndos os n\u00fameros de coordena\u00e7\u00e3o para todas as redes exceto a C1 e S1, j\u00e1 vistas\ndurante o trabalho.\n\n\n\n132\n\nEMB MB\nPorosidade da rede 17.2 17.3\nN de poros 14265.0 9556.0\nN de gargantas 18971.0 13321.0\nN de inlets 375.0 312.0\nN de outlets 395.0 317.0\nN de isolados 2039.0 1221.0\nElementos circulares 163.0 0.0\nElementos quadrados 234.0 132.0\nElementos triangulares 32841.0 22747.0\n\nTabela 18: Caracter\u00edsticas da RP, no EMB e MB, para o volume S4\n\nFigura 62: Rede gerada para o volume S4\n\n\n\n133\n\nEMB MB\nPorosidade da rede 24.5 24.5\nN de poros 1316.0 597.0\nN de gargantas 2642.0 1234.0\nN de inlets 101.0 61.0\nN de outlets 33.0 21.0\nN de isolados 66.0 44.0\nElementos circulares 101.0 0.0\nElementos quadrados 74.0 12.0\nElementos triangulares 3785.0 1821.0\n\nTabela 19: Caracter\u00edsticas da RP, no EMB e MB, para o volume S6\n\nFigura 63: Rede gerada para o volume S6\n\n\n\n134\n\nEMB MB\nPorosidade da rede 25.9 25.6\nN de poros 2041.0 1016.0\nN de gargantas 4734.0 2741.0\nN de inlets 130.0 74.0\nN de outlets 130.0 95.0\nN de isolados 28.0 26.0\nElementos circulares 122.0 0.0\nElementos quadrados 126.0 13.0\nElementos triangulares 6529.0 3746.0\n\nTabela 20: Caracter\u00edsticas da RP, no EMB e MB, para o volume S7\n\nFigura 64: Rede gerada para o volume S7\n\n\n\n135\n\nEMB MB\nPorosidade da rede 34.6 34.6\nN de poros 2506.0 1324.0\nN de gargantas 6612.0 4029.0\nN de inlets 141.0 91.0\nN de outlets 160.0 101.0\nN de isolados 74.0 56.0\nElementos circulares 176.0 0.0\nElementos quadrados 170.0 20.0\nElementos triangulares 8774.0 5335.0\n\nTabela 21: Caracter\u00edsticas da RP, no EMB e MB, para o volume S8\n\nFigura 65: Rede gerada para o volume S8\n\n\n\n136\n\nEMB MB\nPorosidade da rede 23.2 23.0\nN de poros 880.0 604.0\nN de gargantas 1454.0 1054.0\nN de inlets 62.0 48.0\nN de outlets 76.0 56.0\nN de isolados 85.0 67.0\nElementos circulares 20.0 0.0\nElementos quadrados 23.0 10.0\nElementos triangulares 2293.0 1650.0\n\nTabela 22: Caracter\u00edsticas da RP, no EMB e MB, para o volume S9\n\nFigura 66: Rede gerada para o volume S9\n\n\n\n137\n\nEMB MB\nPorosidade da rede 19.8 19.5\nN de poros 2534.0 1429.0\nN de gargantas 5047.0 2888.0\nN de inlets 114.0 86.0\nN de outlets 117.0 77.0\nN de isolados 120.0 81.0\nElementos circulares 115.0 0.0\nElementos quadrados 66.0 17.0\nElementos triangulares 7402.0 4302.0\n\nTabela 23: Caracter\u00edsticas da RP, no EMB e MB, para o volume S10\n\nFigura 67: Rede gerada para o volume S10\n\n\n\n138\n\nEMB MB\nPorosidade da rede 23.7 23.6\nN de poros 977.0 566.0\nN de gargantas 2030.0 1171.0\nN de inlets 56.0 44.0\nN de outlets 59.0 45.0\nN de isolados 32.0 22.0\nElementos circulares 59.0 0.0\nElementos quadrados 30.0 6.0\nElementos triangulares 2920.0 1733.0\n\nTabela 24: Caracter\u00edsticas da RP, no EMB e MB, para o volume S11\n\nFigura 68: Rede gerada para o volume S11\n\n\n\n139\n\n1 3 5 7 9 11 14 17 20 23 26 29 32 35 38 41\n\nMB\n\nEMB\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nN\u00famero de coordena\u00e7\u00e3o\n\nFigura 69: Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume C2\n\n7.2.1 N\u00fameros de coordena\u00e7\u00e3o\n\nNessa se\u00e7\u00e3o s\u00e3o demonstrados graficamente os n\u00fameros de coordena-\n\u00e7\u00e3o para as amostras n\u00e3o vistas durante o cap\u00edtulo 5.\n\nUma forte tend\u00eancia que pode ser observada em todas as figuras \u00e9 ade\ngerar menos poros com zero ou uma conex\u00e3o. Isso comprova que apesar de\ngerar um n\u00famero maior de voxels inv\u00e1lidos, conforme visto no cap\u00edtulo 4, o\nEMB gera menos poros desconexos.\n\nNa tese de Dong e Blunt (2007) ele teoriza em certo ponto que um n\u00fa-\nmero alto de poros desconexos pode ser devido a baixa resolu\u00e7\u00e3o da imagem\nde entrada. Apesar de tal constata\u00e7\u00e3o poder ser verdadeira, h\u00e1 espa\u00e7o para\nmelhoria na t\u00e9cnica MB nesse sentido. Ou seja, \u00e9 poss\u00edvel extrair poros mais\nbem conexos da mesma imagem de entrada do MB, conforme demonstrado\npela rede EMB gerada.\n\nTamb\u00e9m, percebe-se uma tend\u00eancia similar a do C1 e S1. Isso \u00e9, no\nC2 h\u00e1 uma alta concentra\u00e7\u00e3o em valores baixos de coordena\u00e7\u00e3o e poucos\nporos com valores alt\u00edssimos. Em contrapartida, nos arenitos observa-se uma\nmaior regularidade da distribui\u00e7\u00e3o com uma frequ\u00eancia bem maior de poros\nmedianos.\n\n\n\n140\n\n1 2 3 4 5 6 7 8 9 11 13 15 17 19 21 23\n\nMB\n\nEMB\n\n0\n\n5\n\n10\n\n15\n\n20\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nN\u00famero de coordena\u00e7\u00e3o\n\nFigura 70: Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S2\n\n1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35\n\nMB\n\nEMB\n\n0\n\n5\n\n10\n\n15\n\n20\n\n25\n\n30\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nN\u00famero de coordena\u00e7\u00e3o\n\nFigura 71: Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S3\n\n\n\n141\n\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18\n\nMB\n\nEMB\n\n0\n\n5\n\n10\n\n15\n\n20\n\n25\n\n30\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nN\u00famero de coordena\u00e7\u00e3o\n\nFigura 72: Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S4\n\n1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33\n\nMB\n\nEMB\n\n0\n\n5\n\n10\n\n15\n\n20\n\n25\n\n30\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nN\u00famero de coordena\u00e7\u00e3o\n\nFigura 73: Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S5\n\n\n\n142\n\n1 3 5 7 9 11 14 17 20 23 26 29 32 35 38\n\nMB\n\nEMB\n\n0\n\n5\n\n10\n\n15\n\n20\n\n25\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nN\u00famero de coordena\u00e7\u00e3o\n\nFigura 74: Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S6\n\n1 4 7 10 13 16 19 22 25 28 31 34 37 40 43 46 49 52\n\nMB\n\nEMB\n\n0\n\n5\n\n10\n\n15\n\n20\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nN\u00famero de coordena\u00e7\u00e3o\n\nFigura 75: Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S7\n\n\n\n143\n\n1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35 37\n\nMB\n\nEMB\n\n0\n\n5\n\n10\n\n15\nF\n\nre\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nN\u00famero de coordena\u00e7\u00e3o\n\nFigura 76: Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S8\n\n1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31\n\nMB\n\nEMB\n\n0\n\n5\n\n10\n\n15\n\n20\n\n25\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nN\u00famero de coordena\u00e7\u00e3o\n\nFigura 77: Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S9\n\n\n\n144\n\n1 2 3 4 5 6 7 8 9 10 12 14 16 18 20\n\nMB\n\nEMB\n\n0\n\n5\n\n10\n\n15\n\n20\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nN\u00famero de coordena\u00e7\u00e3o\n\nFigura 78: Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S10\n\n1 2 3 4 5 6 7 8 9 11 13 15 17 19 21 23\n\nMB\n\nEMB\n\n0\n\n5\n\n10\n\n15\n\n20\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nN\u00famero de coordena\u00e7\u00e3o\n\nFigura 79: Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume S11\n\n\n\n145\n\n1 3 5 7 9 11 14 17 20 23 26 29 32 35 38\n\nMB\n\nEMB\n\n0\n\n5\n\n10\n\n15\n\nF\nre\n\nq\nu\n\n\u00ean\nci\n\na \n(%\n\n)\n\nN\u00famero de coordena\u00e7\u00e3o\n\nFigura 80: Distribui\u00e7\u00e3o do n\u00famero de coordena\u00e7\u00e3o para o EMB e MB no\nvolume A1\n\n7.3 ESCOAMENTO MONOF\u00c1SICO NAS REDES EMB E MB NOS EI-\nXOS Y E Z\n\nOs resultados s\u00e3o refentes aos valores apresentados na tese de Dong\ne Blunt (2007). No cap\u00edtulo 5, foi feita uma compara\u00e7\u00e3o com os valores de\nescoamento no eixo x. O eixo y apresentou, assim como o x, bons resultados,\npor\u00e9m no eixo z os valores para a rede EMB e MB foram bastante discrepan-\ntes. No geral, observou-se valores esperados para as redes, por\u00e9m no caso\nC2, o resultado do EMB foi muito maior que o do MB para os fatores E f\nutilizados. Uma explica\u00e7\u00e3o seria a diferen\u00e7a entre os par\u00e2metros utilizados\nna tese referente. Ainda assim, os resultados encontrados no trabalho citado\ndiferem bastante do encontrado nos testes rodados.\n\n7.4 PAR\u00c2METROS PARA O SIMULADOR\n\nA defini\u00e7\u00e3o dos par\u00e2metros para escoamento no simulador two phase\nfoi feita usando um arquivo de descri\u00e7\u00e3o do mesmo, cuja defini\u00e7\u00e3o das va-\nri\u00e1veis encontra-se no trabalho de Valvatne e Blunt (2004). O arquivo de\n\n\n\n146\n\nFy 0.5 Fy 0.6 Fy 0.7 Fy 0.8 Ky 0.5 Ky 0.6 Ky 0.7 Ky 0.8\nS1 0.204 0.227 0.279 0.305 1.324 1.125 0.832 0.741\nS2 0.137 0.155 0.172 0.191 2.535 2.130 1.851 1.629\nS3 0.112 0.135 0.153 0.163 2.609 2.206 1.939 1.838\nS4 0.081 0.094 0.099 0.106 2.496 2.135 2.025 1.862\nS5 0.115 0.143 0.168 0.192 3.771 2.686 2.352 2.003\nS6 0.126 0.159 0.168 0.184 3.581 2.682 2.575 2.192\nS7 0.121 0.140 0.163 0.170 2.420 1.965 1.690 1.644\nS8 0.118 0.135 0.154 0.171 3.268 2.786 2.357 2.082\nS9 0.098 0.105 0.129 0.145 42.886 33.523 24.379 21.657\nC1 0.108 0.159 0.166 0.177 2.797 1.928 1.800 1.504\nC2 0.095 0.103 0.118 0.126 1.882 1.817 0.954 0.916\nA1 0.110 0.132 0.153 0.166 2.731 2.163 1.765 1.596\nM\u00e9dia 0.119 0.141 0.160 0.175 6.025 4.762 3.710 3.305\nVari\u00e2ncia 0.001 0.001 0.002 0.002 135.205 82.238 42.637 33.589\n\nTabela 25: Tabela que apresenta a raz\u00e3o do resultado obtido pela simula\u00e7\u00e3o\nna rede EMB em rela\u00e7\u00e3o aos resultados do trabalho de Dong e Blunt (2007)\npara diferentes fatores de expans\u00e3o, no eixo y\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 C1 C2 A1\n\n?\n\n?\n\n? ?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n0e+00\n\n2e+04\n\n4e+04\n\n6e+04\n\n8e+04\n\n1e+05\n\nP\ne\nr\nm\n\ne\na\nb\nil\n\nid\na\nd\n\ne\n (\n\nm\nD\n\n)\n\nVolume\n\n?\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\nFigura 81: Permeabilidades Ky, em mD, para as redes EMB e o resultado\noriginal de Dong e Blunt (2007)\n\n\n\n147\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 C1 C2 A1\n\n?\n\n?\n? ?\n\n? ? ? ? ?\n?\n\n?\n\n?0\n\n20\n\n40\n\n60\n\n80\n\n100\n\n120\n\n?\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\nF\nat\n\nor\n d\n\ne \nfo\n\nrm\na\u00e7\n\n\u00e3o\n\nVolume\n\nFigura 82: Fatores de forma Fy para as redes EMB e o resultado original de\nDong e Blunt (2007)\n\nFz 0.5 Fz 0.6 Fz 0.7 Fz 0.8 Kz 0.5 Kz 0.6 Kz 0.7 Kz 0.8\nS1 0.129 0.141 0.169 0.188 2.816 2.608 2.346 2.243\nS2 0.120 0.138 0.156 0.174 3.027 2.506 2.176 1.912\nS3 0.094 0.109 0.123 0.137 6.728 5.648 4.874 4.529\nS4 0.083 0.096 0.105 0.119 2.378 2.008 1.796 1.560\nS5 0.088 0.110 0.154 0.177 4.533 3.001 2.582 2.199\nS6 0.135 0.155 0.161 0.177 2.710 2.240 2.182 1.851\nS7 0.095 0.109 0.127 0.132 3.098 2.498 2.145 2.094\nS8 0.104 0.118 0.134 0.148 3.464 2.973 2.523 2.217\nS9 0.108 0.117 0.140 0.157 46.542 35.643 27.343 24.350\nC1 0.131 0.158 0.164 0.178 3.144 2.604 2.435 1.980\nC2 0.035 0.036 0.038 0.041 14.987 14.351 13.899 13.185\nA1 0.092 0.108 0.124 0.140 3.969 3.178 2.670 2.257\nM\u00e9dia 0.101 0.116 0.133 0.147 8.116 6.605 5.581 5.031\nVari\u00e2ncia 0.001 0.001 0.001 0.002 158.494 95.263 58.158 47.382\n\nTabela 26: Tabela que apresenta a raz\u00e3o do resultado obtido pela simula\u00e7\u00e3o\nna rede EMB em rela\u00e7\u00e3o aos resultados do trabalho de Dong e Blunt (2007)\npara diferentes fatores de expans\u00e3o, no eixo z\n\n\n\n148\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 C1 C2 A1\n\n?\n\n?\n\n? ?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n0\n\n20000\n\n40000\n\n60000\n\n80000\n\nP\ne\nr\nm\n\ne\na\nb\nil\n\nid\na\nd\n\ne\n (\n\nm\nD\n\n)\n\nVolume\n\n?\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\nFigura 83: Permeabilidades Kz, em mD, para as redes EMB e o resultado\noriginal de Dong e Blunt (2007)\n\nS1 S2 S3 S4 S5 S6 S7 S8 S9 C1 C2 A1\n\n?\n?\n\n? ?\n? ? ? ? ? ?\n\n?\n?0\n\n50\n\n100\n\n150\n\n200\n\n250\n?\n\nMB\n\nEMB 0.5\n\nEMB 0.6\n\nEMB 0.7\n\nEMB 0.8\n\nF\nat\n\nor\n d\n\ne \nfo\n\nrm\na\u00e7\n\n\u00e3o\n\nVolume\n\nFigura 84: Fatores de forma Fz para as redes EMB e o resultado original de\nDong e Blunt (2007)\n\n\n\n149\n\npar\u00e2metros base utilizado no simulador foi o seguinte:\n\nRAND_SEED\n5 6 5 4 8 7 5\n#\n\nOUTPUT\n% P r o p e r t y O u t p u t S w O u t p u t\n\nT T\n#\n\nSAT_TARGET\n%f i n a l S a t maxPc ma x D e l ta S w m a x D e l t a P c c a l c K r c a l c I\n\n0 . 0 0 1 . 0 E21 0 . 2 0 5 0 0 0 0 0 . 0 T F\n1 . 0 0 ?1.0 E21 0 . 2 0 5 0 0 0 0 0 . 0 T F\n\n#\n\nINIT_CON_ANG\n0 . 0 0 . 0 0 . 2 3 . 0\n#\n\nEQUIL_CON_ANG\n3 5 0 . 0 6 0 . 0 ?10.0 ?1.0 rMax\n#\n\n%FRAC_CON_ANG\n% f r a c t i o n v o l B a s e d min max d e l t a e t a\n% 0 . 5 T 9 0 . 0 1 4 0 . 0 ?10.0 ?1.0\n% m e t h o d C l u s t Diam O i l?i n?Wat\n% c o r r 4 F\n%#\n\nRES_FORMAT\ne x c e l\n#\n\nRELPERM_DEF\ns i n g l e F\n#\n\nTRAPPING\n% I n j e c t f l u i d f r o m a l l o w d r a i n a g e w a t e r m u l t f a c t i n\n% e n t r y e x i t o f d a n g l i n g e n d s f i l l e d c i r c e l e m\n\nT F T 0 . 0 E?30\n#\n\nSOLVER_TUNE\n% min Memory S c a l i n g S o l v e r V e r b o s e C o n d u c t a n c e\n% t o l e r a n c e F a c t o r o u t p u t S o l v e r Cut?O f f\n\n1 . 0 E?30 8 0 F 0 . 0\n#\n\nPRS_BDRS\n% c a l c k r u s i n g r e c o r d p r e s s num p r e s s\n% a v g p r e s s p r o f i l e s p r o f i l e s\n\nF F 10\n#\n\n%SOLVER_DBG\n% M a t r i c e s V e l o c i t i e s F i l e n a m e M a t l a b I n i t O n l y\n% W O Res W O Res\n% T T T F F F t e s t F F\n\n\n\n150\n\n%#\n\nPORE_FILL_ALG\no r e n 2\n#\n\nPORE_FILL_WGT\n0 0 . 5 1 . 0 5 . 0 1 0 . 0 5 0 . 0\n#\n\n%FILLING_LIST\n%T T T\n%#\n\nFLUID\n% i n t e r f a c i a l w a t e r o i l w a t e r o i l\n\nw a t e r o i l\n% t e n s i o n v i s c o s i t y v i s c o s i t y r e s i s t i v i t y r e s i s t i v i t y\n\nd e n s i t y d e n s i t y\n% (mN/m) ( c p ) ( c p ) ( Ohm . m) ( Ohm . m)\n\n( kg / m3 ) ( kg / m3 )\n3 0 . 0 1 . 0 1 . 0 1 . 2 1 0 0 0 . 0 1 0 0 0 . 0\n\n1 0 0 0 . 0\n% 1 2 . 3 0 . 9 9 1 5 . 2 3 1 . 2 1 0 0 0 . 0\n\n1 0 4 4 . 0 1 0 4 4 . 0\n#\n\nCALC_BOX\n0 . 1 0 . 9\n#\n\n%A_CLOSE_SHAVE\n%0.7\n%#\n\n%MODIFY_MOD_SIZE\n% 0 . 4 3 2 9\n%#\n\n%PRS_DIFF\n%10.0 0 . 0 T\n%#\n\n%GRAV_CONST\n%?9.81 ?9.81 0 . 0\n%#\n\n%MODIFY_RAD_DIST\n% ================= THROATS =============================\n%1 . / t h r o a t _ 1 p c _ c l a y . t x t ?2.0 ?600.0 % Read p o r e s i z e d i s t r i b u t i o n\n% ================== PORES =============================\n%2 ?1.0 ?3.0 0 . 2 3 . 0 % A s p e c t r a t i o\n%T T 15\n%#\n\n%MODIFY_G_DIST\n%?1\n%5 0 . 0 0 1 0 . 0 4 8 1 1 ?1.0 ?1.0\n%T 50\n%#\n\n\n\n151\n\n%WRITE_NET\n%T b e r e _ b i n\n%#\n\nSAT_COVERGENCE\n% m i n N u m F i l l i n g s i n i t S t e p S i z e c u t B a c k m a x I n c r s t a b l e d i s p\n\n10 0 . 1 0 . 8 2 . 0 F\n\nA defini\u00e7\u00e3o das var\u00edaveis TITLE e NETWORK foram feitas de acordo\ncom a amostra de entrada."}]}}}