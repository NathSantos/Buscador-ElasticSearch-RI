{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.18360"}, {"@name": "filename", "#text": "2527_001022979.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "Roberto Mentzingen Rolo\n\nModelagem geol\u00f3gica impl\u00edcita com fun\u00e7\u00f5es\ndist\u00e2ncia assinaladas\n\nPorto Alegre\n\n2017\n\n\n\n\n\nRoberto Mentzingen Rolo\n\nModelagem geol\u00f3gica impl\u00edcita com fun\u00e7\u00f5es dist\u00e2ncia\nassinaladas\n\nEsta disserta\u00e7\u00e3o foi analisada e julgada ade-\nquada para a obten\u00e7\u00e3o do t\u00edtulo de Mestre em\nEngenharia, \u00e1rea de concentra\u00e7\u00e3o de Tecno-\nlogia Mineral, e aprovada em sua forma final\npelo Orientador e pela Banca Examinadora\ndesignada pelo Programa de P\u00f3s-Gradua\u00e7\u00e3o\nem Engenharia de Minas, Metal\u00fargica e de\nMateriais da Universidade Federal do Rio\nGrande do Sul.\n\nUniversidade Federal do Rio Grande do Sul - UFRGS\n\nEscola de Engenharia\n\nPrograma de P\u00f3s-Gradua\u00e7\u00e3o em Enhenharia de Minas, Metal\u00fargica e de Materiais\n\nOrientador: Prof. Dr. Jo\u00e3o Felipe Coimbra Leite Costa\n\nPorto Alegre\n2017\n\n\n\nRoberto Mentzingen Rolo\nModelagem geol\u00f3gica impl\u00edcita com fun\u00e7\u00f5es dist\u00e2ncia assinaladas/ Roberto\n\nMentzingen Rolo. \u2013 Porto Alegre, 2017-\n104 p. : il. (algumas color.) ; 30 cm.\n\nOrientador: Prof. Dr. Jo\u00e3o Felipe Coimbra Leite Costa\n\nDisserta\u00e7\u00e3o (Mestrado) \u2013 Universidade Federal do Rio Grande do Sul - UFRGS\nEscola de Engenharia\nPrograma de P\u00f3s-Gradua\u00e7\u00e3o em Enhenharia de Minas, Metal\u00fargica e de Materiais,\n2017.\n1. modelagem geol\u00f3gica. 2. modelagem geol\u00f3gica impl\u00edcita. 3. fun\u00e7\u00f5es dist\u00e2ncia\n\nassinaladas I. Prof. Dr. Jo\u00e3o Felipe Coimbra Leite Costa. II. Universidade Federal\ndo Rio Grande do Sul. III. Faculdade de Engenharia. IV. Modelagem geol\u00f3gica\nimpl\u00edcita com fun\u00e7\u00f5es dist\u00e2ncia assinaladas\n\nCDU 02:141:005.7\n\n\n\nRoberto Mentzingen Rolo\n\nModelagem geol\u00f3gica impl\u00edcita com fun\u00e7\u00f5es dist\u00e2ncia\nassinaladas\n\nEsta disserta\u00e7\u00e3o foi analisada e julgada ade-\nquada para a obten\u00e7\u00e3o do t\u00edtulo de Mestre em\nEngenharia, \u00e1rea de concentra\u00e7\u00e3o de Tecno-\nlogia Mineral, e aprovada em sua forma final\npelo Orientador e pela Banca Examinadora\ndesignada pelo Programa de P\u00f3s-Gradua\u00e7\u00e3o\nem Engenharia de Minas, Metal\u00fargica e de\nMateriais da Universidade Federal do Rio\nGrande do Sul.\n\nTrabalho aprovado. Porto Alegre, 24 de fevereiro de 2017:\n\nProf. Dr. Andr\u00e9 Cezar Zingano\nPPGE3M - UFRGS\n\nProf. Dr. Diego Machado Marques\nConvidado externo ao PPGE3M\n\nDr. Marcelo Cheviche Godoy\nNewmont Mining Corporation\n\nPorto Alegre\n2017\n\n\n\n\n\nAgradecimentos\n\nAo Professor Jo\u00e3o Felipe por compartilhar um pouco do imenso conhecimento e\npela recep\u00e7\u00e3o de bra\u00e7os abertos no laborat\u00f3rio. Aos colegas do LPM que contribu\u00edram\npara o desenvolvimento desse trabalho, Ricardo Radkte, David Drummond, \u00c1ttila Le\u00e3es e\nP\u00e9ricles Machado. Aos demais colegas de laborat\u00f3rio, em especial, Ryu Okada, Marcel\nBassani, Cristina Ara\u00fajo, Augusto Torres, Anuar Bergamaschi, Lucas Roncarati, Marcelo\nBatelocchi, Ricardo Hundelshaussen, Ricardo Rodrigues, Jos\u00e9 Guilherme e George Gasper.\nAos ICs, Rafael e Bento.\n\n\u00c0 minha fam\u00edlia, em especial, Cust\u00f3dia e Marcelo pelo suporte. \u00c0 Camila pelo\ncompanheirismo e incondicional apoio.\n\nAo Conselho Nacional de Desenvolvimento Cient\u00edfico e Tecnol\u00f3gico (CNPq) pela\nbolsa concedida. \u00c0 Newmont pelo apoio e informa\u00e7\u00e3o fornecida \u00e0 essa disserta\u00e7\u00e3o.\n\n\n\n\n\n\u201cLife is made of choices\nFull of opportunities\nAll we have to do is\n\nRecognize the pieces of the game\nMake out what is substancial\n\nAnd be proud of our undying past\u201d\n(Reffer - Hidden Scars)\n\n\n\n\n\nResumo\nPreviamente \u00e0 cada estimativa ou simula\u00e7\u00e3o geoestat\u00edstica os dom\u00ednios geol\u00f3gicos do\ndep\u00f3sito devem ser modelados, o que tradicionalmente \u00e9 feito de forma manual por um\ngeomodelador, em um processo laborioso, demorado e subjetivo. Por essa raz\u00e3o novas\nt\u00e9cnicas conhecidas como m\u00e9todos impl\u00edcitos veem surgindo. Essas t\u00e9cnicas fornecem\nalgoritmos que substituem o processo de digitaliza\u00e7\u00e3o manual dos m\u00e9todos expl\u00edcitos\npor alguma forma de procedimento autom\u00e1tico. Essa disserta\u00e7\u00e3o visita alguns m\u00e9todos\nimpl\u00edcitos bem estabelecidos com aten\u00e7\u00e3o especial \u00e0 modelagem geol\u00f3gica impl\u00edcita com\nfun\u00e7\u00f5es dist\u00e2ncia assinalada. Um estudo de caso em um banco de dados real \u00e9 apresentado e\na aplicabilidade do m\u00e9todo discutida. Embora n\u00e3o substitua por completo um geomodelador\nexperiente, o m\u00e9todo provou ser capaz de gerar modelos geol\u00f3gicos semi-autom\u00e1ticos\nrealistas a partir dos dados amostrais, e se mostra \u00fatil principalmente nas fases iniciais da\npesquisa mineral.\n\nPalavras-chaves: modelagem geol\u00f3gica, modelagem geol\u00f3gica impl\u00edcita, fun\u00e7\u00f5es dist\u00e2ncia\nassinaladas.\n\n\n\n\n\nAbstract\nPrior to every geostatistical estimation or simulation study there is a need for delimiting\nthe geologic domains of the deposit, which is traditionally done manually by a geomodeler\nin a laborious, time consuming and subjective process. For this reason, novel techniques\nreferred to as implicit modelling have appeared. These techniques provide algorithms\nthat replace the manual digitization process of the traditional methods by some form of\nautomatic procedure. This dissertation covers a few well established implicit methods\ncurrently available with special attention to the signed distance function methodology. A\ncase study based on a real dataset was performed and its applicability discussed. Although\nit did not replace an experienced geomodeler, the method proved to be capable in creating\nsemi-automatic geological models from the sampling data, especially in the early stages of\nexploration.\n\nKey-words: geologic modeling, implicit geologic modeling, signed distance function,\ndomaining.\n\n\n\n\n\nLista de ilustra\u00e7\u00f5es\n\nFigura 1 \u2013 Fases da minera\u00e7\u00e3o. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19\nFigura 2 \u2013 Fluxograma ilustrando a metodologia passo a passo. . . . . . . . . . . 23\nFigura 3 \u2013 Veio de quartzo-ouro em rocha m\u00e1fica. . . . . . . . . . . . . . . . . . . 29\nFigura 4 \u2013 Linha dos reais dividia em dois subdom\u00ednios pelos pontos x = ?1 e x = 1. 31\nFigura 5 \u2013 Fun\u00e7\u00e3o impl\u00edcita definindo as regi\u00f5es ?? e ?+ bem como a fronteira ??. 31\nFigura 6 \u2013 Fun\u00e7\u00e3o dist\u00e2ncia assinalada definindo as regi\u00f5es ?? e ?+ bem como a\n\nfronteira ??. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32\nFigura 7 \u2013 Furo de sonda interceptando uma camada de carv\u00e3o, \u00e0 esquerda, e o\n\nvalor da fun\u00e7\u00e3o distancia assinalada \u00e0 direita. . . . . . . . . . . . . . . 33\nFigura 8 \u2013 Tr\u00eas amostras s1, s2 e s3 e o um ponto q a ser estimado. . . . . . . . . 34\nFigura 9 \u2013 Demonstra\u00e7\u00e3o simplificada do funcionamento das fun\u00e7\u00f5es de bases\n\nradiais em uma dimens\u00e3o. . . . . . . . . . . . . . . . . . . . . . . . . . 35\nFigura 10 \u2013 Interpolantes do Leapfrog R\u00a9. . . . . . . . . . . . . . . . . . . . . . . . . 36\nFigura 11 \u2013 Interpolante isotr\u00f3pico. . . . . . . . . . . . . . . . . . . . . . . . . . . . 37\nFigura 12 \u2013 Tend\u00eancia global aplicada ao interpolante. . . . . . . . . . . . . . . . . 37\nFigura 13 \u2013 Tend\u00eancia estrutural aplicada ao interpolante. . . . . . . . . . . . . . . 37\nFigura 14 \u2013 Princ\u00edpio do m\u00e9todo dos campos potenciais em duas dimens\u00f5es. . . . . 40\nFigura 15 \u2013 Modelo geol\u00f3gico criado a partir do m\u00e9todo dos campos potenciais, em\n\nplanta (acima). Se\u00e7\u00e3o N6 (abaixo). . . . . . . . . . . . . . . . . . . . . 43\nFigura 16 \u2013 Transforma\u00e7\u00e3o do banco de dados categ\u00f3ricos em indicadores bin\u00e1rios. 46\nFigura 17 \u2013 Fun\u00e7\u00e3o dist\u00e2ncia assinalada calculada para cada ponto amostral. . . . . 46\nFigura 18 \u2013 Fun\u00e7\u00e3o dist\u00e2ncia interpolada para todos os locais de interesse. . . . . . 48\nFigura 19 \u2013 Modelo geol\u00f3gico criado a partir do sinal da fun\u00e7\u00e3o dist\u00e2ncia interpolada. 49\nFigura 20 \u2013 Fun\u00e7\u00e3o dist\u00e2ncia interpolada para todos os locais de interesse. . . . . . 50\nFigura 21 \u2013 Mapas de probabilidades gerados com dois valores de gamma diferentes.\n\n\u00c0 esquerda ? = 80, \u00e0 direita ? = 175. . . . . . . . . . . . . . . . . . . . 51\nFigura 22 \u2013 Dist\u00e2ncias estimadas e transformadas em probabilidades para um mesmo\n\nbloco. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52\nFigura 23 \u2013 Modelos geol\u00f3gicos gerados, sem corre\u00e7\u00e3o das propor\u00e7\u00f5es \u00e0 direita e\n\ncom corre\u00e7\u00e3o, usando um fator ? = 0, 99 \u00e0 esquerda. . . . . . . . . . . 53\nFigura 24 \u2013 Vis\u00e3o do painel de algoritmos do SGeMS mostrando a op\u00e7\u00e3o DFMOD. 54\nFigura 25 \u2013 Vis\u00e3o do plugin signed distances. . . . . . . . . . . . . . . . . . . . . . 55\nFigura 26 \u2013 Vis\u00e3o da aba general do plugin interpolator. . . . . . . . . . . . . . . . 56\nFigura 27 \u2013 Vis\u00e3o da aba variogram do plugin interpolator. . . . . . . . . . . . . . . 57\nFigura 28 \u2013 Vis\u00e3o da aba options do plugin interpolator. . . . . . . . . . . . . . . . 57\n\n\n\nFigura 29 \u2013 Scatterplot entre as dist\u00e2ncias calculadas pelo plugin desenvolvido contra\ndist\u00e2ncias calculadas a partir da rotina DFMod do GSLib. . . . . . . . 59\n\nFigura 30 \u2013 Scatterplot entre os modelos criados pelo plugin desenvolvido e rotina\nDFMod do GSLib. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60\n\nFigura 31 \u2013 Histogramas do modelo baseado somente nas dist\u00e2ncias estimadas \u00e0\nesquerda, dos dados ao centro, e do modelo ap\u00f3s execu\u00e7\u00e3o do servo\nsystem \u00e0 direita. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61\n\nFigura 32 \u2013 Dados em planta \u00e0 esquerda e em perfil \u00e0 direita. . . . . . . . . . . . . 63\nFigura 33 \u2013 Histograma dos dados. . . . . . . . . . . . . . . . . . . . . . . . . . . . 64\nFigura 34 \u2013 Dist\u00e2ncias assinaladas calculadas para cada uma das litologias. . . . . . 64\nFigura 35 \u2013 Litologia 1, e respectiva propor\u00e7\u00e3o, modelada variando o range do\n\nvariograma: 150m \u00e0 esquerda, 1500m ao centro e 15000m \u00e0 direita. . . 65\nFigura 36 \u2013 Modelos calculados a partir de variogramas com diferentes propor\u00e7\u00f5es\n\nde efeito pepita. Da direita para a esquerda: 0%, 10%, 50% e 90%. . . . 66\nFigura 37 \u2013 Variograma das dist\u00e2ncias assinaladas calculadas para cada uma das\n\nlitologias. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67\nFigura 38 \u2013 Scatterplots entre modelos gerados com diferentes estrat\u00e9gias de krigagem. 69\nFigura 39 \u2013 Compara\u00e7\u00e3o entre os modelos criados: modelo expl\u00edcito \u00e0 esquerda e\n\nmodelo impl\u00edcito \u00e0 direita. . . . . . . . . . . . . . . . . . . . . . . . . . 70\nFigura 40 \u2013 Scatterplot entre os modelos expl\u00edcitos e impl\u00edcitos. . . . . . . . . . . . 71\nFigura 41 \u2013 Modelo criado utilizando a t\u00e9cnica do vizinho mais pr\u00f3ximo. . . . . . . 72\nFigura 42 \u2013 Se\u00e7\u00e3o vertical 10/70 em x. . . . . . . . . . . . . . . . . . . . . . . . . . 73\nFigura 43 \u2013 Se\u00e7\u00e3o vertical 37/70 em x. . . . . . . . . . . . . . . . . . . . . . . . . . 74\nFigura 44 \u2013 Se\u00e7\u00e3o vertical 56/70 em x. . . . . . . . . . . . . . . . . . . . . . . . . . 74\nFigura 45 \u2013 Se\u00e7\u00e3o vertical 67/70 em x. . . . . . . . . . . . . . . . . . . . . . . . . . 75\nFigura 46 \u2013 Se\u00e7\u00e3o vertical 16/60 em y. . . . . . . . . . . . . . . . . . . . . . . . . . 75\nFigura 47 \u2013 Se\u00e7\u00e3o vertical 27/60 em y. . . . . . . . . . . . . . . . . . . . . . . . . . 76\nFigura 48 \u2013 Se\u00e7\u00e3o vertical 43/60 em y. . . . . . . . . . . . . . . . . . . . . . . . . . 76\nFigura 49 \u2013 Se\u00e7\u00e3o vertical 54/60 em y. . . . . . . . . . . . . . . . . . . . . . . . . . 77\n\n\n\nLista de tabelas\n\nTabela 1 \u2013 \u00c2ngulos de rota\u00e7\u00e3o e propor\u00e7\u00f5es entre as dire\u00e7\u00f5es principais usadas no\nc\u00e1lculo da fun\u00e7\u00e3o dist\u00e2ncia anisotr\u00f3pica. . . . . . . . . . . . . . . . . . 59\n\nTabela 2 \u2013 Par\u00e2metros para o c\u00e1lculo da variograma experimental. . . . . . . . . . 66\nTabela 3 \u2013 Propriedades do grid. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68\nTabela 4 \u2013 Par\u00e2metros de krigagem ordin\u00e1ria. . . . . . . . . . . . . . . . . . . . . 68\n\n\n\n\n\nSum\u00e1rio\n\n1 INTRODU\u00c7\u00c3O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19\n1.1 Meta . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22\n1.2 Objetivos espec\u00edficos . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22\n1.3 Metodologia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22\n1.4 Estrutura da disserta\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . 23\n\n2 REVIS\u00c3O BIBLIOGR\u00c1FICA . . . . . . . . . . . . . . . . . . . . . . 25\n2.1 Estacionariedade . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25\n2.1.1 Fun\u00e7\u00f5es aleat\u00f3rias . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25\n2.1.2 Momentos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26\n2.1.2.1 Momento de primeira ordem . . . . . . . . . . . . . . . . . . . . . . . . . . 26\n2.1.2.2 Momentos de segunda ordem . . . . . . . . . . . . . . . . . . . . . . . . . . 26\n2.1.3 Hip\u00f3tese de estacionariedade . . . . . . . . . . . . . . . . . . . . . . . . . 27\n2.1.3.1 Estacionariedade estrita . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27\n2.1.3.2 Estacionariedade segunda ordem . . . . . . . . . . . . . . . . . . . . . . . . 28\n2.1.3.3 Hip\u00f3tese intr\u00ednseca . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28\n2.1.3.4 Quasi-estacionariedade . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28\n2.1.4 Decis\u00e3o de estacionariedade . . . . . . . . . . . . . . . . . . . . . . . . . 29\n2.2 Fun\u00e7\u00f5es impl\u00edcitas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n2.2.1 Fun\u00e7\u00f5es dist\u00e2ncias assinaladas . . . . . . . . . . . . . . . . . . . . . . . . 31\n2.3 M\u00e9todo implementado no software Leapfrog R\u00a9 . . . . . . . . . . . . 33\n2.3.1 Metodologia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33\n2.3.1.1 Interpola\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34\n2.3.1.2 Anisotropia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36\n2.3.1.3 Vis\u00e3o geral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38\n2.4 M\u00e9todo dos campos potenciais . . . . . . . . . . . . . . . . . . . . . . 38\n2.4.1 Metodologia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39\n2.4.2 Tipos de dados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39\n2.4.2.1 Codifica\u00e7\u00e3o dos dados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40\n2.4.2.2 Interpola\u00e7\u00e3o do campo potencial . . . . . . . . . . . . . . . . . . . . . . . . 41\n2.4.2.3 Implementa\u00e7\u00e3o do algoritmo de cokrigagem . . . . . . . . . . . . . . . . . . 41\n2.4.2.4 Vari\u00e2ncia do campo potencial . . . . . . . . . . . . . . . . . . . . . . . . . 42\n2.4.2.5 Incerteza nos modelos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42\n2.4.2.6 Vis\u00e3o geral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42\n\n\n\n3 MODELAGEM GEOL\u00d3GICA IMPL\u00cdCITA COM FUN\u00c7\u00d5ES DIS-\nT\u00c2NCIA ASSINALADAS . . . . . . . . . . . . . . . . . . . . . . . . 45\n\n3.1 Metodologia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45\n3.1.1 Caso bin\u00e1rio . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45\n3.1.2 Aplica\u00e7\u00e3o da metodologia para m\u00faltiplos dom\u00ednios geol\u00f3gicos . . . . . . . . 48\n3.2 Uma medida heur\u00edstica de incerteza (softmax transformation) . . . 50\n3.2.0.1 Transforma\u00e7\u00e3o das dist\u00e2ncias . . . . . . . . . . . . . . . . . . . . . . . . . . 51\n3.3 Corre\u00e7\u00e3o das propor\u00e7\u00f5es globais dos dom\u00ednios (servo system) . . . . 52\n3.3.1 Servo system . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52\n3.4 O Plug-in . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54\n3.4.1 Signed distances . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54\n3.4.2 Interpolator . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55\n3.5 Valida\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58\n\n4 ESTUDO DE CASO . . . . . . . . . . . . . . . . . . . . . . . . . . . 63\n4.1 Variografia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65\n4.2 Interpola\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68\n4.3 Resultados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69\n4.3.1 Compara\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72\n4.4 Discuss\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77\n\n5 CONSIDERA\u00c7\u00d5ES FINAIS . . . . . . . . . . . . . . . . . . . . . . . 81\n5.1 Recomenda\u00e7\u00f5es para trabalhos futuros . . . . . . . . . . . . . . . . . 81\n\nREFER\u00caNCIAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83\n\nAP\u00caNDICES 87\n\nAP\u00caNDICE A \u2013 ALGORITMO EM PYTHON QUE CALCULA AS\nDIST\u00c2NCIAS ANISOTR\u00d3PICAS ASSINALADAS\n(SIGNED DISTANCES) . . . . . . . . . . . . . . . 89\n\nAP\u00caNDICE B \u2013 ALGORITMO EM PYTHON QUE INTERPOLA\nAS DISTANCIAS ASSINALADAS E CRIA O MO-\nDELO GEOL\u00d3GICO (INTERPOLATOR) . . . . . 93\n\nANEXOS 101\n\nANEXO A \u2013 ARQUIVO DE PAR\u00c2METRO USADO NA VALIDA-\n\u00c7\u00c3O . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103\n\n\n\n19\n\n1 Introdu\u00e7\u00e3o\n\nHustrulid, Kuchta e Martin (2013) fragmentam a evolu\u00e7\u00e3o de uma mina em tr\u00eas\nfases distintas: (1) Planejamento, (2) Implementa\u00e7\u00e3o e (3) Produ\u00e7\u00e3o. A Figura 1 \u00e9 uma\nlinha do tempo mostrando a rela\u00e7\u00e3o entre as diferentes fases e seus est\u00e1gios. Na fase de\nplanejamento os dep\u00f3sitos minerais s\u00e3o investigados no que diz respeito \u00e0 sua atratividade\necon\u00f4mica e exequibilidade t\u00e9cnica. A fase de planejamento culmina em um relat\u00f3rio de\nviabilidade, no qual \u00e9 baseada a decis\u00e3o de investir e dar continuidade ao empreendimento\nmineiro, iniciando a fase de implementa\u00e7\u00e3o, per\u00edodo de maior fluxo de caixa, quando mina\ne usina de processamento s\u00e3o desenvolvidas. Finalmente a mina entra em opera\u00e7\u00e3o, o\nmin\u00e9rio \u00e9 explotado e processado, e o produto vendido no mercado.\n\nFigura 1 \u2013 Fases da minera\u00e7\u00e3o.\n\nModificado de Hustrulid, Kuchta e Martin (2013)\n\nA avalia\u00e7\u00e3o das reservas \u00e9 parte fundamental e alicerce do estudo de viabilidade,\nos teores e tonelagens s\u00e3o quantificados e modelos num\u00e9ricos que caracterizam a geologia\nem subsuperf\u00edcie criados com base nos dados de sondagem. A partir desses modelos,\nengenheiros e ge\u00f3logos planejam e tomam as decis\u00f5es econ\u00f4micas e t\u00e9cnicas: Escolha do\nm\u00e9todo de lavra, alternativas de processamento mineral, opera\u00e7\u00f5es auxiliares, estimativas\nde custos operacionais, capital de investimento e proje\u00e7\u00e3o do lucro. Como resultado, uma\nestrat\u00e9gia que determina quanto material ser\u00e1 removido ano a ano \u00e9 tra\u00e7ada. O projeto\ndetermina os limites econ\u00f4micos da mina e a sequ\u00eancia \u00f3tima de lavra bloco a bloco,\nbaseado no modelo geoestat\u00edstico de blocos.\n\nNa fase de planejamento \u00e9 poss\u00edvel minimizar o capital e custo operacional do\nprojeto final e ao mesmo tempo maximizar a operabilidade e lucro. A influ\u00eancia relativa nos\ncustos de cada fase \u00e9 mostrado na linha vermelha da Figura 1 (HUSTRULID; KUCHTA;\n\n\n\n20 Cap\u00edtulo 1. Introdu\u00e7\u00e3o\n\nMARTIN, 2013). A principal causa de fracasso em empreendimentos mineiros \u00e9 falta de\nconhecimento a respeito do corpo mineralizado. Isto posto, estimativas precisas e acuradas\ns\u00e3o importantes. At\u00e9 mesmo um pequeno desvio entre produ\u00e7\u00e3o planejada e real pode\ncausar s\u00e9rios preju\u00edzos financeiros.\n\nA avalia\u00e7\u00e3o dos recursos de uma mina \u00e9 composta de duas etapas (CHIL\u00e8S et\nal., 2004): (1) delimita\u00e7\u00e3o das v\u00e1rias unidades geol\u00f3gicas, correspondentes \u00e0s diferentes\nforma\u00e7\u00f5es geol\u00f3gicas ou diferentes litologias; (2) estimativas e/ou simula\u00e7\u00e3o de teores em\ncada unidade modelada.\n\nDesse modo, previamente \u00e0 toda estimativa e/ou simula\u00e7\u00e3o de teores, h\u00e1 a necessi-\ndade de delimitar as unidades geol\u00f3gicas, implicando em decis\u00e3o de estacionariedade e\nhomogeneidade mineral\u00f3gica em cada dom\u00ednio modelado. Isto \u00e9, Os teores de cada dom\u00ednio\ngeol\u00f3gico pertencem a diferentes popula\u00e7\u00f5es estat\u00edsticas e s\u00e3o caracterizados atrav\u00e9s de\nmodelos de distribui\u00e7\u00e3o e semivariogramas espec\u00edficos, resultando em estimativas e/ou\nsimula\u00e7\u00f5es distintas para cada popula\u00e7\u00e3o (MCLENNAN, 2007).\n\nModelos geol\u00f3gicos descrevem a extens\u00e3o, forma e volume das diferentes unidades\ngeol\u00f3gicas no espa\u00e7o. Gerar modelos geol\u00f3gicos corretos \u00e9 necess\u00e1rio para que estimativas\nmais precisas de volume/massa e teores sejam obtidas e problemas de dilui\u00e7\u00e3o ocasionados\npela falta de ader\u00eancia do modelo de blocos \u00e0s estruturas geol\u00f3gicas do dep\u00f3sito sejam\nreduzidos (RASERA, 2014).\n\nTradicionalmente os modelos geol\u00f3gicos s\u00e3o criados explicitamente, atrav\u00e9s de um\nprocesso de digitaliza\u00e7\u00e3o dos contatos geol\u00f3gicos. Pol\u00edgonos s\u00e3o constru\u00eddos manualmente\nem se\u00e7\u00f5es, por um geomodelador, honrando os dados amostrais, esses pol\u00edgonos s\u00e3o\nconectados por linhas-guia e ent\u00e3o interpolados por triangula\u00e7\u00e3o, gerando s\u00f3lidos que\nrepresentam as unidades geol\u00f3gicas. Esse processo apresenta alguns pontos cr\u00edticos segundo\nCowan et al. (2003):\n\n\u2022 \u00c9 demorado e requer um geomodelador experiente;\n\n\u2022 \u00c9 subjetivo, j\u00e1 que cada geomodelador interpretar\u00e1, e produzir\u00e1 um modelo diferente\na partir do mesmo banco de dados, tornando replica\u00e7\u00e3o e auditoria externa do\nmodelo tarefas \u00e1rduas;\n\n\u2022 \u00c9 inflex\u00edvel, pois atualizar o modelo \u00e0 medida que novos dados s\u00e3o adquiridos \u00e9\ndemorado e laborioso.\n\nPara muitas minas, apenas um \u00fanico modelo geol\u00f3gico \u00e9 mantido, dada a limita\u00e7\u00e3o\nde tempo imposta pelos m\u00e9todos expl\u00edcitos. Raramente h\u00e1 oportunidade de modelar inter-\npreta\u00e7\u00f5es alternativas e comparar estimativas de recursos baseadas em diferentes modelos.\nN\u00e3o havendo assim, oportunidade de avaliar as incertezas inerentes ao modelamento\ngeol\u00f3gico (COWAN et al., 2003).\n\n\n\n21\n\nAinda que softwares modernos de minera\u00e7\u00e3o forne\u00e7am ferramentas computacionais\npara visualizar os dados de sondagem e agilizar o processo de digitaliza\u00e7\u00e3o manual, os\nm\u00e9todos expl\u00edcitos ainda sofrem com as desvantagens apresentadas. Por esse motivo, novas\nt\u00e9cnicas, conhecidas como modelagem impl\u00edcita, v\u00eam surgindo. S\u00e3o algoritmos que reduzem\no n\u00edvel de subjetividade, substituindo o processo de digitaliza\u00e7\u00e3o manual por alguma forma\nde procedimento autom\u00e1tico (SILVA, 2015).\n\nAs t\u00e9cnicas de modelagem geol\u00f3gica impl\u00edcita se dividem em dois grandes grupos:\n\nO grupo das t\u00e9cnicas determin\u00edsticas. M\u00e9todos diretos e computacionalmente\nr\u00e1pidos. Alguns m\u00e9todos estabelecidos nessa categoria s\u00e3o a interpola\u00e7\u00e3o suavizada discreta\n(MALLET, 2002), o m\u00e9todo dos campos potenciais (CHIL\u00e8S et al., 2004; CALCAGNO et\nal., 2008; RENARD et al., 2013), operacionalizado no software Isatis R\u00a9, e a metodologia\nimplementada no software de modelagem geol\u00f3gica Leapfrog R\u00a9 (COWAN et al., 2002;\nCOWAN et al., 2003), amplamente utilizado pela ind\u00fastria.\n\nO outro grupo compreende as t\u00e9cnicas estoc\u00e1sticas de modelagem geol\u00f3gica. M\u00e9-\ntodos complexos que demandam grande esfor\u00e7o computacional. Entretanto, no lugar de\num \u00fanico modelo geol\u00f3gico, esses m\u00e9todos geram diversas realiza\u00e7\u00f5es equiprov\u00e1veis da\ndistribui\u00e7\u00e3o espacial das diferentes litologias, reproduzindo os atributos estat\u00edsticos das\namostras. Assim, a partir da an\u00e1lise conjunta das realiza\u00e7\u00f5es \u00e9 poss\u00edvel avaliar a incerteza\nassociada ao modelo geol\u00f3gico.\n\nS\u00e3o m\u00e9todos consolidados: A simula\u00e7\u00e3o sequencial dos indicadores (JOURNEL,\n1983), simula\u00e7\u00e3o sequencial gaussiana truncada (JOURNEL; ISAAKS, 1984), simula\u00e7\u00e3o\nplurigaussiana (GALLI et al., 1994), m\u00e9todos baseados em simula\u00e7\u00e3o objetos (object-\nbased) (BRIDGE; LEEDER, 1979), recentemente surgiram os m\u00e9todos de modelagem\nde superf\u00edcie (surface-based) (PYRCZ; CATUNEANU; DEUTSCH, 2005). Contudo, os\nalgoritmos tradicionais de simula\u00e7\u00e3o, baseados em estat\u00edsticas de dois pontos, n\u00e3o s\u00e3o\ncapazes de reproduzir estruturas geol\u00f3gicas que apresentam complexas interdepend\u00eancias,\nassim surgem os m\u00e9todos baseados em geoestat\u00edstica multiponto (MPS) (GUARDIANO;\nSRIVASTAVA, 1993).\n\nSilva e Deutsch (2012) apresentaram a modelagem geol\u00f3gica impl\u00edcita com fun\u00e7\u00f5es\ndist\u00e2ncia assinaladas para modelar m\u00faltiplos dom\u00ednios geol\u00f3gicos simultaneamente. Deutsch\ne Wilde (2013) o utilizou para modelar m\u00faltiplas camadas de carv\u00e3o, e mostrou que o\nm\u00e9todo \u00e9 uma poderosa ferramenta de modelagem. Wilde e Deutsch (2011) e Silva e\nDeutsch (2013) introduziram duas medidas heur\u00edsticas diferentes de avalia\u00e7\u00e3o de incertezas\ne Silva e Deutsch (2013) uma ferramenta para corrigir as propor\u00e7\u00f5es globais dos diferentes\ndom\u00ednios. E mostraram, novamente, a compet\u00eancia do m\u00e9todo. Silva (2015) revisitou o\nm\u00e9todo com a finalidade de construir, a partir dos dados amostrais, imagens de treinamento\n(data-driven training images) que forne\u00e7am as estat\u00edsticas de m\u00faltiplos pontos (MPS) para\na simula\u00e7\u00e3o de litologias.\n\n\n\n22 Cap\u00edtulo 1. Introdu\u00e7\u00e3o\n\nA modelagem geol\u00f3gica impl\u00edcita com fun\u00e7\u00f5es dist\u00e2ncia assinaladas \u00e9 uma t\u00e9cnica\ndetermin\u00edstica, baseada na interpola\u00e7\u00e3o de uma fun\u00e7\u00e3o dist\u00e2ncia em um grid. Fun\u00e7\u00f5es de\ndist\u00e2ncia assinaladas medem o grau de separa\u00e7\u00e3o entre as diferentes litologias, e dependem\nda orienta\u00e7\u00e3o, forma e extens\u00e3o dos corpos geol\u00f3gicos. Dist\u00e2ncias positivas indicam o\nexterior do dom\u00ednio enquanto dist\u00e2ncias negativas indicam o interior do dom\u00ednio. As\ndist\u00e2ncias assinaladas s\u00e3o calculadas para cada ponto amostral e para cada litologia,\ne interpoladas para os locais n\u00e3o amostrados. Um modelo geol\u00f3gico \u00e9 criado a partir\ndos valores estimados para as dist\u00e2ncias assinaladas. O m\u00e9todo \u00e9 computacionalmente\neficiente, direto e n\u00e3o depende de fun\u00e7\u00f5es matem\u00e1ticas complicadas. Ainda assim, consegue\nreproduzir de maneira satisfat\u00f3ria estruturas geol\u00f3gicas de grande escala nos modelos\nnum\u00e9ricos (SILVA, 2015).\n\nEssa disserta\u00e7\u00e3o \u00e9 uma extens\u00e3o do trabalho de Deutsch e Wilde (2013) e Silva\n(2015). Um plug-in implementando o m\u00e9todo no software SGeMS foi desenvolvido e\napresentado. A aplicabilidade do m\u00e9todo mais uma vez foi posta \u00e0 prova em um estudo de\ncaso conduzido em um banco de dados real. E suas principais caracter\u00edsticas, vantagens e\nlimita\u00e7\u00f5es discutidas.\n\n1.1 Meta\nEssa disserta\u00e7\u00e3o de mestrado tem como meta investigar a aplicabilidade da mode-\n\nlagem geol\u00f3gica impl\u00edcita com fun\u00e7\u00f5es dist\u00e2ncia assinaladas como substituto ou m\u00e9todo\nauxiliar \u00e0 metodologia expl\u00edcita de modelagem geol\u00f3gica, amplamente adotada pela in-\nd\u00fastria. Conhecidas as limita\u00e7\u00f5es e desvantagens da \u00faltima e simplicidade e rapidez da\nprimeira.\n\n1.2 Objetivos espec\u00edficos\nA fim de atingir a meta proposta os seguintes objetivos foram delineados:\n\n1. Operacionalizar o m\u00e9todo no software geoestat\u00edstico de c\u00f3digo aberto SGeMS,\ndesenvolvendo um plug-in funcional em python;\n\n2. Conduzir um estudo de caso em um banco de dados real e verificar a qualidade do\nmodelo gerado pela metodologia proposta, comparando-o a um modelo de refer\u00eancia.\n\n1.3 Metodologia\nA partir de um banco de dados categ\u00f3ricos o valor da fun\u00e7\u00e3o dist\u00e2ncia assinalada \u00e9\n\ncalculado para cada litologia em cada ponto amostral. As dist\u00e2ncias calculadas s\u00e3o ent\u00e3o\n\n\n\n1.4. Estrutura da disserta\u00e7\u00e3o 23\n\nvariografadas e interpoladas, por krigagem ordin\u00e1ria, para todo o grid. Assim, o valor da\nfun\u00e7\u00e3o dist\u00e2ncia assinalada \u00e9 conhecido em todos os n\u00f3s e para cada litologia. Um modelo\ngeol\u00f3gico pode ser criado diretamente a partir do valor estimado para as dist\u00e2ncias. Ou\nent\u00e3o, modelos de probabilidade podem ser criados a partir das dist\u00e2ncias. E ent\u00e3o, um\nmodelo geol\u00f3gico, que tem as propor\u00e7\u00f5es corrigidas para corresponder a uma propor\u00e7\u00e3o\nalvo, criado a partir dos modelos de probabilidade. A Figura 2 ilustra o fluxograma do\nprocesso.\n\nFigura 2 \u2013 Fluxograma ilustrando a metodologia passo a passo.\n\nO modelo criado implicitamente com a metodologia proposta foi comparado com\num modelo criado explicitamente, a partir do mesmo banco de dados. Assim, foi poss\u00edvel\nchecar se o algoritmo reproduziu satisfatoriamente as estruturas geol\u00f3gicas interpretadas\npelo geomodelador.\n\n1.4 Estrutura da disserta\u00e7\u00e3o\nO cap\u00edtulo 2 Revisa os conceitos de fun\u00e7\u00f5es impl\u00edcitas, estacionariedade e os\n\nprincipais m\u00e9todos determin\u00edsticos de modelagem impl\u00edcita baseados em fun\u00e7\u00f5es impl\u00ed-\ncitas: m\u00e9todo dos campos potenciais, implementado no software Isatis R\u00a9, e o m\u00e9todo\nimplementado no software Leapfrog R\u00a9.\n\n\n\n24 Cap\u00edtulo 1. Introdu\u00e7\u00e3o\n\nO cap\u00edtulo 3 apresenta o arcabou\u00e7o te\u00f3rico da modelagem geol\u00f3gica impl\u00edcita\ncom fun\u00e7\u00f5es dist\u00e2ncia assinaladas, o plug-in desenvolvido para o software SGeMS e os\nresultados da valida\u00e7\u00e3o do algoritmo proposto tendo como refer\u00eancia resultados an\u00e1logos\nda rotina DFMod da biblioteca de algoritmos geoestat\u00edsticos GSLib.\n\nO cap\u00edtulo 4 discute os resultados do estudo de caso conduzido em um banco\nde dados real, proveniente de um dep\u00f3sito de ouro. Avalia a aplicabilidade do m\u00e9todo\ncomo substituto ou m\u00e9todo auxiliar \u00e0 metodologia tradicional (explicita) de modelagem\ngeol\u00f3gica, comparando o modelo gerado a partir da metodologia proposta a um modelo de\nrefer\u00eancia, criado explicitamente por um geomodelador.\n\nO cap\u00edtulo 5 encerra a disserta\u00e7\u00e3o apresentando as conclus\u00f5es do trabalho e sugere\ntrabalhos futuros relacionados ao t\u00f3pico.\n\n\n\n25\n\n2 Revis\u00e3o bibliogr\u00e1fica\n\n2.1 Estacionariedade\nNesta se\u00e7\u00e3o s\u00e3o apresentadas as defini\u00e7\u00f5es de fun\u00e7\u00f5es aleat\u00f3rias e estacionariedade.\n\nFundamentais ao pleno entendimento da necessidade da modelagem dos dom\u00ednios geol\u00f3gicos\nde um dep\u00f3sito mineral sob o ponto de vista matem\u00e1tico. (MATHERON, 1965; JOURNEL;\nHUIJBREGTS, 1978; ARMSTRONG, 1998).\n\n2.1.1 Fun\u00e7\u00f5es aleat\u00f3rias\n\nUm fen\u00f4meno natural pode muitas vezes ser caracterizado pela distribui\u00e7\u00e3o espacial\nde uma ou mais vari\u00e1veis, chamadas vari\u00e1veis regionalizadas (ReV).\n\nUma vari\u00e1vel aleat\u00f3ria (RV), \u00e9 uma vari\u00e1vel que recebe um certo n\u00famero de valores\nnum\u00e9ricos de acordo com uma determinada distribui\u00e7\u00e3o de probabilidade. O resultado do\nlan\u00e7amento de um dado, por exemplo, pode ser considerado uma RV que pode receber um\nentre seis valores equiprov\u00e1veis.\n\nUm valor observado em um ponto amostral xi \u00e9 a realiza\u00e7\u00e3o, z(xi) de uma vari\u00e1vel\nregionalizada, Z(xi). A fam\u00edlia de todas as vari\u00e1veis aleat\u00f3rias auto-correlacionadas Z(x)\nquando x varia por todo o dom\u00ednio (D) de um dep\u00f3sito \u00e9 uma fun\u00e7\u00e3o aleat\u00f3ria (RF)\n{Z(x),x ? D}. Essa defini\u00e7\u00e3o de fun\u00e7\u00e3o aleat\u00f3ria expressa o aspecto aleat\u00f3rio e estruturado\ndas vari\u00e1veis regionalizadas.\n\nLocalmente, no ponto xi, Z(xi) \u00e9 uma vari\u00e1vel aleat\u00f3ria. Z(x) \u00e9 uma RF, j\u00e1 que\npara cada par de pontos xi e xi + h, as RV correspondentes, Z(xi) e Z(xi + h) n\u00e3o s\u00e3o\nindependentes, s\u00e3o relacionadas por uma correla\u00e7\u00e3o que expressa a estrutura espacial da\nvari\u00e1vel regionalizada z(x).\n\nDe acordo com Journel e Huijbregts (1978), o problema ent\u00e3o, passa a ser representar\na variabilidade da fun\u00e7\u00e3o aleat\u00f3ria no espa\u00e7o (quando x varia), essa representa\u00e7\u00e3o ser\u00e1\nusada para resolver problemas de estimativa do valor z(x0) em um ponto x0 que n\u00e3o foi\namostrado.\n\nA interpreta\u00e7\u00e3o probabil\u00edstica da Vari\u00e1vel regionalizada z(x) como sendo uma\ndeterminada realiza\u00e7\u00e3o de uma certa RF Z(x) faz sentido apenas quando \u00e9 poss\u00edvel inferir,\nmesmo que parcialmente, a lei de probabilidade que define a RF.\n\n\u00c9 virtualmente imposs\u00edvel inferir a lei de probabilidade de uma RF Z(x) a partir\nde uma \u00fanica realiza\u00e7\u00e3o z(x), que por sua vez \u00e9 limitada a um n\u00famero finito de pontos\namostrais xi. Da mesma forma, \u00e9 imposs\u00edvel determinar a lei de probabilidade que rege o\n\n\n\n26 Cap\u00edtulo 2. Revis\u00e3o bibliogr\u00e1fica\n\nlan\u00e7amento de um dado a partir do resultado de um \u00fanico lan\u00e7amento, v\u00e1rios lan\u00e7amentos\ns\u00e3o necess\u00e1rios para sua determina\u00e7\u00e3o. V\u00e1rias realiza\u00e7\u00f5es z1(x),z2(x), ...,zk(x) da RF Z(x)\nseriam necess\u00e1rias para inferir a lei de probabilidade de Z(x), na pr\u00e1tica estamos limitados\na uma \u00fanica realiza\u00e7\u00e3o {z(xi)} da RF nas posi\u00e7\u00f5es xi, ent\u00e3o, certas suposi\u00e7\u00f5es envolvendo\ngraus de homogeneidade espacial devem ser estabelecidas, a hip\u00f3tese de estacionariedade.\n\nNa pr\u00e1tica, mesmo que apenas certa regi\u00e3o do fen\u00f4meno possa ser considerada\nhomog\u00eanea, a ReV se repete no espa\u00e7o. Essa homogeneidade ou repeti\u00e7\u00e3o \u00e9 equivalente a\nv\u00e1rias realiza\u00e7\u00f5es da mesma RF Z(x) e permite certo grau de infer\u00eancia estat\u00edstica. Dois\npontos experimentais z(x0) e z(x0 + h) em dois pontos diferentes, x0 e x0 + h, podem\nent\u00e3o, ser tratados como duas realiza\u00e7\u00f5es da mesma RV Z(x0). Essa abordagem \u00e9 usada\npara inferir a lei de distribui\u00e7\u00e3o da RF Z(x) a partir do histograma dos dados {z(xi)},\nassim como o valor esperado E{Z(x)} a partir da m\u00e9dia aritm\u00e9tica dos dados.\n\n2.1.2 Momentos\n\nConsidere a RF Z(x). Para cada conjunto de k pontos no Rn (espa\u00e7o n-dimensional)\nx1,x2, ...,xk, corresponde um componente vetorial k-dimensional de vari\u00e1veis aleat\u00f3rias\n{Z(x1),Z(x2), ...,Z(xk)}.\n\nEssa RV vetorial \u00e9 caracterizada pela fun\u00e7\u00e3o de distribui\u00e7\u00e3o (ccdf), condicionada\naos k pontos amostrais Fx1,x2,...,xk(z1,z2, ...,zk) = Prob{Z(x1) &lt;z1, ...,Z(xk) &lt;zk}.\n\nO conjunto de todas as fun\u00e7\u00f5es de distribui\u00e7\u00e3o, para todos os k inteiros e positivos\ne para todas as escolhas poss\u00edveis de pontos no Rn, constitui a lei espacial da RF Z(x).\n\nEm aplica\u00e7\u00f5es na minera\u00e7\u00e3o, n\u00e3o \u00e9 necess\u00e1rio caracterizar toda a lei espacial,\napenas os dois primeiros momentos da lei s\u00e3o necess\u00e1rios para uma solu\u00e7\u00e3o aproximada\ndos problemas encontrados. Al\u00e9m disso, a quantidade de dados dispon\u00edvel \u00e9 insuficiente\npra inferir a lei espacial em sua totalidade (JOURNEL; HUIJBREGTS, 1978).\n\nSeguem as defini\u00e7\u00f5es dos momentos segundo Journel e Huijbregts (1978)\n\n2.1.2.1 Momento de primeira ordem\n\nConsidere a RV Z(x) no ponto x. Se a fun\u00e7\u00e3o de distribui\u00e7\u00e3o de Z(x) tem uma\nesperan\u00e7a matem\u00e1tica que depende do ponto x, essa \u00e9:\n\nE{Z(x)} = m(x) (2.1)\n\n2.1.2.2 Momentos de segunda ordem\n\nNa geoestat\u00edstica, os momentos de segunda ordem s\u00e3o:\n\n\n\n2.1. Estacionariedade 27\n\nA vari\u00e2ncia, ou mais precisamente, vari\u00e2ncia a priori de Z(x), \u00e9 definida como o\nmomento de segunda ordem em rela\u00e7\u00e3o a esperan\u00e7a m(x) da RV Z(x),\n\nV ar{Z(x)} = E{[Z(x) ?m(x)]2} (2.2)\n\nA covari\u00e2ncia. Pode ser demonstrado que se duas RV Z(x1) e Z(x2) t\u00eam vari\u00e2ncias\nnos pontos x1 e x2 elas tamb\u00e9m t\u00eam uma covari\u00e2ncia, que \u00e9 fun\u00e7\u00e3o das duas localidades\nx1 e x2, e pode ser escrita como:\n\nC(x1,x2) = E{[Z(x1) ?m(x1)][Z(x2) ?m(x2)]} (2.3)\n\nO variograma, que \u00e9 definido como a vari\u00e2ncia do incremento [Z(x1)?Z(x2)], pode\nser escrito como:\n\n2?(x1,x2) = V ar{Z(x1) ?Z(x2)} (2.4)\n\nA fun\u00e7\u00e3o ?(x1,x2) \u00e9 o semi-variograma.\n\n2.1.3 Hip\u00f3tese de estacionariedade\n\nPor defini\u00e7\u00e3o, fun\u00e7\u00f5es variograma e covari\u00e2ncia dependem simultaneamente de dois\npontos x1 e x2, ent\u00e3o v\u00e1rias realiza\u00e7\u00f5es do par de RV {Z(x1),Z(x2)} s\u00e3o necess\u00e1rios para\nque qualquer infer\u00eancia estat\u00edstica seja poss\u00edvel.\n\nPor outro lado, se essas fun\u00e7\u00f5es dependerem somente da dist\u00e2ncia entre dois pontos,\nisto \u00e9, do vetor h = x1 ?x2 que separa x1 e x2, a infer\u00eancia estat\u00edstica se torna poss\u00edvel.\nCada par de dados {z(xk),z(xk?)} separados pela dist\u00e2ncia (xk ?xk?), igual ao vetor h,\npode ser considerado como uma realiza\u00e7\u00e3o diferente do par de RV {Z(x1),Z(x2)}.\n\n\u00c9 intuitivo perceber que em zonas de mineraliza\u00e7\u00e3o homog\u00eaneas (dom\u00ednios geol\u00f3gi-\ncos), a correla\u00e7\u00e3o que existe entre dois pontos z(xk) e z(xk?) n\u00e3o depende das posi\u00e7\u00f5es\ndentro dessas zonas homog\u00eaneas, mas da dist\u00e2ncia que os separa.\n\nJournel e Huijbregts (1978) apresentam diferentes tipos de estacionariedade.\n\n2.1.3.1 Estacionariedade estrita\n\nUma RF \u00e9 dita estacion\u00e1ria estrita quando sua lei espacial \u00e9 invariante \u00e0 transla\u00e7\u00e3o.\nAs duas componentes vetoriais {Z(x1),Z(xk)} e {Z(x1 + h),Z(xk + h)} t\u00eam a mesma lei\nde distribui\u00e7\u00e3o, independente do vetor de transla\u00e7\u00e3o h.\n\nNa geoestat\u00edstica linear, estamos interessados apenas nos dois primeiros momentos,\nent\u00e3o ser\u00e1 necess\u00e1rio assumir a estacionariedade apenas para eles.\n\n\n\n28 Cap\u00edtulo 2. Revis\u00e3o bibliogr\u00e1fica\n\n2.1.3.2 Estacionariedade segunda ordem\n\nUma RF \u00e9 dita estacion\u00e1ria de segunda ordem quando sua esperan\u00e7a matem\u00e1tica\nexiste e n\u00e3o depende do ponto x.\n\nE{Z(x)} = m, ?x (2.5)\n\nA m\u00e9dia de Z(x) \u00e9 a m\u00e9dia do dom\u00ednio geol\u00f3gico estacion\u00e1rio.\n\nPara cada par de RV {Z(x),Z(x + h)}, a covari\u00e2ncia existe e depende da dist\u00e2ncia\nde separa\u00e7\u00e3o h.\n\nC(h) = E{Z(xh)Z(x)}?m2, ?x (2.6)\n\nh representa um vetor de coordenadas no espa\u00e7o tridimensional.\n\nSob a hip\u00f3tese de estacionariedade de segunda ordem ?(h) = C(0) ?C(h).\n\n2.1.3.3 Hip\u00f3tese intr\u00ednseca\n\nUma RF Z(x) \u00e9 dita intr\u00ednseca quando sua esperan\u00e7a matem\u00e1tica existe e n\u00e3o\ndepende do ponto x.\n\nE{Z(x)} = m, ?x (2.7)\n\nA m\u00e9dia de Z(x) \u00e9 a m\u00e9dia do dom\u00ednio geol\u00f3gico estacion\u00e1rio.\n\nPara todos os vetores h o incremento [Z(x + h) ?Z(x)] tem vari\u00e2ncia finita que\nn\u00e3o depende x\n\nV ar{Z(x + h) ?Z(x)} = E{[Z(x + h) ?Z(x)]2} = 2?(h), ?x (2.8)\n\nEnt\u00e3o, a estacionariedade de segunda ordem implica na hip\u00f3tese intr\u00ednseca, mas o\ncontr\u00e1rio n\u00e3o \u00e9 verdadeiro. A hip\u00f3tese intr\u00ednseca pode ser vista como uma limita\u00e7\u00e3o da\nestacionariedade de segunda ordem aos incrementos da RF Z(x)\n\n2.1.3.4 Quasi-estacionariedade\n\nNa pr\u00e1tica, a covari\u00e2ncia ou variograma s\u00e3o usados apenas para dist\u00e2ncias limitadas\n|h| ? b, como por exemplo, b poderia ser o di\u00e2metro da vizinhan\u00e7a de busca, em outros\ncasos b pode ser uma zona de mineraliza\u00e7\u00e3o homog\u00eanea (dom\u00ednio geol\u00f3gico) e duas vari\u00e1veis\nZ(xk) e Z(xk + h) n\u00e3o podem ser consideradas provenientes do mesmo dom\u00ednio se |h| > b.\n\n\n\n2.1. Estacionariedade 29\n\nNesses casos, devemos considerar a fun\u00e7\u00e3o C(x,x + h) ou ?(x,x + h) n\u00e3o mais do\nque localmente estacion\u00e1rias, para dist\u00e2ncias |h| menores que b. Essa limita\u00e7\u00e3o da hip\u00f3tese\nde segunda ordem \u00e9 a hip\u00f3tese de quasi-estacionariedade.\n\n2.1.4 Decis\u00e3o de estacionariedade\n\nA decis\u00e3o de estacionariedade \u00e9 uma suposi\u00e7\u00e3o, e requisito a aplica\u00e7\u00e3o das t\u00e9cnicas\ngeostat\u00edsticas de estimativa e simula\u00e7\u00e3o. Estacionariedade n\u00e3o \u00e9 uma propriedade geol\u00f3gica,\n\u00e9 uma propriedade matem\u00e1tica.\n\nUma fun\u00e7\u00e3o aleat\u00f3ria estacion\u00e1ria (SRF) \u00e9 a representa\u00e7\u00e3o probabil\u00edstica de uma\npropriedade petrof\u00edsica com esperan\u00e7a matem\u00e1tica e covari\u00e2ncia constantes independe da\nlocaliza\u00e7\u00e3o. Raramente, \u00e9 apropriado considerar a totalidade do dep\u00f3sito mineral como\num \u00fanico dom\u00ednio estacion\u00e1rio, que ser\u00e1 modelado a partir de uma SRF. Geralmente, \u00e9\nnecess\u00e1rio identificar diferentes dom\u00ednios no dep\u00f3sito, cada um com seu modelo de SRF,\nconsistentes com as suposi\u00e7\u00f5es matem\u00e1ticas de uma SRF (MCLENNAN, 2007).\n\nA Figura 3 mostra um veio mineralizado de quartzo-ouro em rocha encaixante\nm\u00e1fica, os teores de ouro se comportam de maneira diferente no veio e rocha encaixante,\nos teores s\u00e3o mais altos e mais vari\u00e1veis no veio. Assumir estacionariedade, e modelar\ncom uma \u00fanica SRF toda a regi\u00e3o n\u00e3o seria adequado. O modelo num\u00e9rico ser\u00e1 mais\nconsistente com a realidade se duas SRF forem usadas, uma para cada unidade geol\u00f3gica.\n\nFigura 3 \u2013 Veio de quartzo-ouro em rocha m\u00e1fica.\n\nFonte:&lt;http://rses.anu.edu.au/people/steve-cox>, acesso em julho de 2016\n\nSegundo McLennan (2007), para que a decis\u00e3o de estacionariedade seja razo\u00e1vel\num total de cinco fases devem ser consideradas:\n\nhttp://rses.anu.edu.au/people/steve-cox\n\n\n30 Cap\u00edtulo 2. Revis\u00e3o bibliogr\u00e1fica\n\n1. Escolher o n\u00famero e tipo dos dom\u00ednios que ter\u00e3o suas propriedades petrof\u00edsicas\nmodeladas;\n\n2. Modelar as fronteiras desses dom\u00ednios;\n\n3. Caracterizar a natureza das transi\u00e7\u00f5es entre os dom\u00ednios e model\u00e1-las;\n\n4. Modelar as tend\u00eancias (trends) dentro de cada dom\u00ednio;\n\n5. Estimar com um modelo de tend\u00eancia.\n\nA escolha dos dom\u00ednios deve ser avaliada com base em um equil\u00edbrio entre um\nmodelo geol\u00f3gica e fisicamente consistentes e o n\u00famero de amostras dispon\u00edvel para inferir\nos par\u00e2metros das SRF (MCLENNAN, 2007).\n\nAl\u00e9m da imposi\u00e7\u00e3o matem\u00e1tica, os dom\u00ednios de um dep\u00f3sito mineral devem ser\nmodelados para que estimativas mais precisas de volume/massa e teores sejam obtidas e\nproblemas de dilui\u00e7\u00e3o ocasionados pela falta de ader\u00eancia do modelo de blocos \u00e0s estruturas\ngeol\u00f3gicas do dep\u00f3sito sejam reduzidos (RASERA, 2014).\n\n2.2 Fun\u00e7\u00f5es impl\u00edcitas\nAlguns dos m\u00e9todos determin\u00edsticos de modelagem geol\u00f3gica dispon\u00edveis, e revisados\n\nnessa disserta\u00e7\u00e3o, s\u00e3o baseados em fun\u00e7\u00f5es impl\u00edcitas. O uso da modelagem impl\u00edcita foi\nintroduzido no campo da computa\u00e7\u00e3o gr\u00e1fica para cria\u00e7\u00e3o de objetos de diversas geometrias\ne complexidades por Bloomenthal e Bajaj (1997). A ideia central da t\u00e9cnica \u00e9 usar uma\nfun\u00e7\u00e3o impl\u00edcita para demarcar regi\u00f5es de diferentes formas e extens\u00f5es no espa\u00e7o (SILVA,\n2015).\n\nNa matem\u00e1tica, uma equa\u00e7\u00e3o impl\u00edcita \u00e9 uma rela\u00e7\u00e3o na forma R(x1, ...,xn) = 0.\nPor exemplo, a equa\u00e7\u00e3o impl\u00edcita de um c\u00edrculo unit\u00e1rio \u00e9 x2 + y2 ? 1 = 0.\n\nUma fun\u00e7\u00e3o impl\u00edcita \u00e9 uma fun\u00e7\u00e3o definida implicitamente por uma equa\u00e7\u00e3o\nimpl\u00edcita, associando uma das vari\u00e1veis (o valor) com as outras (os argumentos). A fun\u00e7\u00e3o\nimpl\u00edcita que define o c\u00edrculo unit\u00e1rio pode ser escrita como x2 + f(x)2 ? 1 = 0. Essa\nequa\u00e7\u00e3o impl\u00edcita define f como uma fun\u00e7\u00e3o de x apenas se ?1 ? x ? 1.\n\nOs exemplos a seguir, que ilustram a metodologia, foram propostos por Osher e\nFedkiw (2003).\n\nNa Figura 4, em uma dimens\u00e3o, a linha dos n\u00fameros reais foi dividida em tr\u00eas\npartes distintas usando os pontos x = ?1 e x = 1. Isto \u00e9, definimos (??,?1), (?1, 1)\ne (1,?). A primeira e terceira partes s\u00e3o pe\u00e7as desconexas da mesma regi\u00e3o. Assim,\ndefinimos ?? = (?1, 1) como parte interna do dom\u00ednio e ?+ = (??,?1) ? (1,?) como\nparte externa do dom\u00ednio. A fronteira entre a parte interna e externa consiste dos dois\n\n\n\n2.2. Fun\u00e7\u00f5es impl\u00edcitas 31\n\npontos ?? = {?1, 1}, e \u00e9 chamada de interface. No&lt;n, os subdom\u00ednios s\u00e3o n-dimensionais,\nenquanto a interface apresenta n? 1 dimens\u00f5es.\n\nFigura 4 \u2013 Linha dos reais dividia em dois subdom\u00ednios pelos pontos x = ?1 e x = 1.\n\nNuma representa\u00e7\u00e3o expl\u00edcita da interface, escrevemos explicitamente os pontos\nque a definem como feito anteriormente ao definir ?? = {?1, 1}. Tamb\u00e9m \u00e9 poss\u00edvel\ndefinir implicitamente a interface como o isocontorno de de alguma fun\u00e7\u00e3o. Por exemplo,\no isocontorno zero de ?(x) = x2 ? 1 \u00e9 o conjunto de pontos para os quais ?(x) = 0, isto \u00e9,\nexatamente ?? = {?1, 1}, como pode ser observado na Figura 5.\n\nFigura 5 \u2013 Fun\u00e7\u00e3o impl\u00edcita definindo as regi\u00f5es ?? e ?+ bem como a fronteira ??.\n\nModificado de Osher e Fedkiw (2003)\n\nO isocontorno zero foi escolhido. Por\u00e9m n\u00e3o h\u00e1 nada de especial nessa escolha, o\nisocontorno ?(x) = 1 da fun\u00e7\u00e3o ?(x) = x2 define a mesma interface.\n\n2.2.1 Fun\u00e7\u00f5es dist\u00e2ncias assinaladas\n\nNa se\u00e7\u00e3o 2.2, foram definidas as fun\u00e7\u00f5es impl\u00edcitas, seu valor \u00e9 ?(x) = 0 na interface,\n?(x) &lt;0 na regi\u00e3o interna e ?(x) > 0 na regi\u00e3o externa. As fun\u00e7\u00f5es dist\u00e2ncia assinaladas\ns\u00e3o um subconjunto das fun\u00e7\u00f5es impl\u00edcitas.\n\n\n\n32 Cap\u00edtulo 2. Revis\u00e3o bibliogr\u00e1fica\n\nUma fun\u00e7\u00e3o dist\u00e2ncia d(~x) \u00e9 definida como:\n\nd(~x) = min(|~x? ~xI|) ? ~xI ? ?? (2.9)\n\nOnde ~xI \u00e9 um ponto pertencente \u00e0 interface. Ou seja, para um dado ponto ~x, d(~x)\n\u00e9 a menor dist\u00e2ncia entre ~x e um ponto ~xC pertencente \u00e0 interface ??.\n\nUma fun\u00e7\u00e3o dist\u00e2ncia assinalada \u00e9 uma fun\u00e7\u00e3o impl\u00edcita ?, com |?(~x)| = d(~x) para\ntodo ~x. Ent\u00e3o, ?(~x) = d(~x) = 0 para todo ~x ? ??, ?(~x) = ?d(~x) para todo ~x ? ?? e\n?(~x) = d(~x) para todo ~x ? ?+.\n\nNa se\u00e7\u00e3o 2.2, a fun\u00e7\u00e3o ?(x) = x2 ? 1 foi usada para representar implicitamente a\ninterface ?? = {?1, 1}. Uma representa\u00e7\u00e3o baseada em fun\u00e7\u00f5es dist\u00e2ncia assinaladas da\nmesma interface \u00e9 ?(x) = |x|? 1, como visto na Figura 6\n\nFigura 6 \u2013 Fun\u00e7\u00e3o dist\u00e2ncia assinalada definindo as regi\u00f5es ?? e ?+ bem como a fronteira\n??.\n\nModificado de Osher e Fedkiw (2003)\n\nContextualizando, considere o furo de sondagem vertical interceptando uma camada\nde carv\u00e3o, \u00e0 direita na Figura 7, e o valor da fun\u00e7\u00e3o dist\u00e2ncia assinalada para essa litologia \u00e0\nesquerda. O valor da fun\u00e7\u00e3o decresce \u00e0 medida que um ponto ao longo do furo se aproxima\nda camada, e seu valor \u00e9 a menor dist\u00e2ncia desse ponto at\u00e9 um ponto pertencente \u00e0\ninterface. Vale zero na interface, e passa a ser negativo para pontos no interior da camada,\natingindo o menor valor no centro, parte mais interna da camada de carv\u00e3o.\n\nOs exemplos apresentados s\u00e3o casos simpl\u00f3rios baseados em fun\u00e7\u00f5es param\u00e9tricas e\nn\u00e3o s\u00e3o aplic\u00e1veis a caracter\u00edsticas geol\u00f3gicas, embora a ideia central seja a mesma, algumas\nadapta\u00e7\u00f5es devem ser feitas para o emprego da t\u00e9cnica sob uma perspectiva geol\u00f3gica. A\nse\u00e7\u00e3o 3.1 descreve como as fun\u00e7\u00f5es impl\u00edcitas devem ser constru\u00eddas e aplicadas.\n\n\n\n2.3. M\u00e9todo implementado no software Leapfrog R\u00a9 33\n\nFigura 7 \u2013 Furo de sonda interceptando uma camada de carv\u00e3o, \u00e0 esquerda, e o valor da\nfun\u00e7\u00e3o distancia assinalada \u00e0 direita.\n\nModificado de Deutsch e Wilde (2013)\n\n2.3 M\u00e9todo implementado no software Leapfrog R\u00a9\n\nO assunto foi introduzido no campo da geologia por Cowan et al. (2002), Cowan et\nal. (2003), baseado no trabalho de Savchenko et al. (1995) para modelar objetos atrav\u00e9s\nda interpola\u00e7\u00e3o de uma fun\u00e7\u00e3o impl\u00edcita.\n\nO Leapfrog R\u00a9 permite a constru\u00e7\u00e3o de modelos, geol\u00f3gicos e/ou de iso teores (grade\nshells), tridimensionais a partir dos dados brutos de sondagem em quest\u00e3o de minutos\nou horas, contra dias ou at\u00e9 semanas gastos com o m\u00e9todo tradicional. Desse modo,\ndiferentes cen\u00e1rios geol\u00f3gicos podem ser testados. Os modelos s\u00e3o gerados de forma semi\nautom\u00e1tica. Ademais, informa\u00e7\u00e3o geol\u00f3gica qualitativa pode ser incorporada ao modelo de\nforma pr\u00e1tica e r\u00e1pida (COWAN et al., 2002).\n\n2.3.1 Metodologia\n\nCorpos geol\u00f3gicos s\u00e3o definidos implicitamente a partir dos dados de litologia\nprovenientes da sondagem. O valor de uma fun\u00e7\u00e3o impl\u00edcita (fun\u00e7\u00e3o dist\u00e2ncia assinalada\nou fun\u00e7\u00e3o volume) \u00e9 calculado para os pontos amostrais e interpolado para todo o espa\u00e7o.\nEnt\u00e3o, o volume que representa o corpo geol\u00f3gico \u00e9 definido por uma iso superf\u00edcie\n(geralmente a iso superf\u00edcie zero) da fun\u00e7\u00e3o impl\u00edcita interpolada (COWAN et al., 2003).\nA metodologia para constru\u00e7\u00e3o da fun\u00e7\u00e3o dist\u00e2ncia assinalada \u00e9 elucidada na se\u00e7\u00e3o 3.1.\nOs corpos geol\u00f3gicos s\u00e3o modelados individualmente, em ordem geocronol\u00f3gica, do mais\nrecente para o mais antigo, evitando a sobreposi\u00e7\u00e3o de dom\u00ednios. O Leapfrog R\u00a9 trabalha\nconvertendo uma fun\u00e7\u00e3o impl\u00edcita em uma superf\u00edcie triangulada (mesh) que representa a\nunidade geol\u00f3gica.\n\n\n\n34 Cap\u00edtulo 2. Revis\u00e3o bibliogr\u00e1fica\n\n2.3.1.1 Interpola\u00e7\u00e3o\n\nO exemplo a seguir, que ilustra a metodologia de interpola\u00e7\u00e3o implementada no\nsoftware, foi apresentado por Lane (2013).\n\nFigura 8 \u2013 Tr\u00eas amostras s1, s2 e s3 e o um ponto q a ser estimado.\n\nFonte: Lane (2013)\n\nA Figura 8 ilustra o problema fundamental de estimar o valor q a partir de tr\u00eas\namostras s1, s2 e s3.\n\nA krigagem, em sua forma mais simples, estima o valor em um ponto como uma\ncombina\u00e7\u00e3o linear das amostras conhecidas, os pesos s\u00e3o determinados matematicamente\npela distribui\u00e7\u00e3o das amostras em rela\u00e7\u00e3o ao ponto a ser estimado. Considerando o exemplo\nanterior:\n\nq = w1s1 + w2s2 + w3s3 (2.10)\n\nOnde w1, w2 e w3 s\u00e3o os pesos atribu\u00eddos \u00e0s amostras.\n\nFica evidente que a krigagem pode ser usada como forma de interpola\u00e7\u00e3o, j\u00e1 que\n\u00e9 poss\u00edvel estimar um valor em qualquer posi\u00e7\u00e3o arbitr\u00e1ria onde n\u00e3o h\u00e1 dados. Todavia,\npara cada nova estimativa, \u00e9 necess\u00e1rio recalcular os pesos, um processo que toma esfor\u00e7o\ncomputacional e tempo.\n\n\u00c9 poss\u00edvel rearranjar a equa\u00e7\u00e3o de krigagem da seguinte forma:\n\nq(x) = a1?(x?x1) + a2?(x?x2) + a3?(x?x3) (2.11)\n\nEsse m\u00e9todo \u00e9 conhecido como dual kriging (GALLI; MURILLO; THOMANN,\n1984). a1?(x?x1) descreve como a amostra localizada na posi\u00e7\u00e3o x1 influencia a estimativa\nna sua vizinhan\u00e7a, ?(x) \u00e9 equivalente ao variograma (ou interpolante no casos das RBF).\nNessa abordagem, as influ\u00eancias ponderadas de cada amostra s\u00e3o somadas para produzir\numa equa\u00e7\u00e3o que possa ser usada para estimar um valor em qualquer local x. Uma\n\n\n\n2.3. M\u00e9todo implementado no software Leapfrog R\u00a9 35\n\nestimativa feita dessa maneira produz o mesmo resultado do que o m\u00e9todo tradicional de\nkrigagem.\n\nA Figura 9 ilustra um exemplo unidimensional do m\u00e9todo\n\nFigura 9 \u2013 Demonstra\u00e7\u00e3o simplificada do funcionamento das fun\u00e7\u00f5es de bases radiais em\numa dimens\u00e3o.\n\nModificada de Lane (2013)\n\nUtilizando a metodologia tradicional de krigagem, para cada nova estimativa em\num local diferente \u00e9 preciso recalcular os pesos, j\u00e1 com a dual kriging, onde a influ\u00eancia\ndas amostras \u00e9 somada, os pesos s\u00f3 precisam ser calculados uma \u00fanica vez. Acelerando o\nprocesso.\n\nO Leapfrog R\u00a9 usa fun\u00e7\u00f5es de bases radias (RBF) para interpolar a fun\u00e7\u00e3o dist\u00e2ncia\nassinalada retendo todas as amostras dispon\u00edveis (estimador global) em todas as estimativas.\nMais especificamente FastRBF TM, cuja diferen\u00e7a principal em rela\u00e7\u00e3o \u00e0 RBF tradicional, \u00e9\na capacidade de trabalhar com bancos de dados volumosos (mais de 1.000.000 de amostras)\nem um hardware convencional de forma relativamente r\u00e1pida (LEAPFROG3D, 2015).\n\nRBF s\u00e3o uma forma de implementar a dual kriging (LANE, 2013). Enquanto a\nkrigagem usa uma fun\u00e7\u00e3o covari\u00e2ncia obtida atrav\u00e9s dos dados para determinar os pesos\ndados \u00e0s amostras, as RBF usam fun\u00e7\u00f5es b\u00e1sicas (interpolant functions) pr\u00e9-definidas\npara determin\u00e1-la.\n\nDuas fun\u00e7\u00f5es s\u00e3o usadas para derivar os pesos dados \u00e0 cada amostra no Leapfrog R\u00a9,\no interpolante linear (Figura 10 \u00e0 esquerda) e o interpolante esferoidal (Figura 10 \u00e0\n\n\n\n36 Cap\u00edtulo 2. Revis\u00e3o bibliogr\u00e1fica\n\ndireita). Equivalentes aos modelos de variograma pot\u00eancia e esf\u00e9rico, respectivamente\nSpragg (2013b).\n\nO interpolante linear \u00e9 multi escala, o que o torna bastante flex\u00edvel e de uso geral.\nParticularmente recomendado para casos em que h\u00e1 um grande n\u00famero de dados de\nlitologia concentrados em bols\u00f5es localizados. N\u00e3o \u00e9 recomendado para teores, j\u00e1 que\nextrapola violentamente para al\u00e9m do limite dos dados. O interpolante esferoidal contorna\no problema de extrapola\u00e7\u00e3o, muitas vezes n\u00e3o realista, do modelo linear (MCLENNAN,\n2013).Os par\u00e2metros do modelo como patamar, alcance e efeito pepita podem ser ajustados.\n\nFigura 10 \u2013 Interpolantes do Leapfrog R\u00a9.\n\nModificada de Spragg (2013b)\n\n2.3.1.2 Anisotropia\n\nO Leapfrog R\u00a9 conta com ferramentas que d\u00e3o ao usu\u00e1rio controle sobre a continui-\ndade dos corpos geol\u00f3gicos em determinadas dire\u00e7\u00f5es com possibilidade de incorporar \u00e0\ninterpola\u00e7\u00e3o uma tend\u00eancia global e/ou uma tend\u00eancia estrutural.\n\nA tend\u00eancia global controla o comportamento do modelo interpolante, e deve ser\nutilizado em situa\u00e7\u00f5es onde a geologia sugere continuidade do corpo numa dire\u00e7\u00e3o planar\nsobre uma grande \u00e1rea, se a geologia sugerir que a dire\u00e7\u00e3o dos corpos varia no espa\u00e7o, a\ntend\u00eancia estrutural \u00e9 mais indicada (SPRAGG, 2013a).\n\nA tend\u00eancia global \u00e9 inserida ao modelo a partir de um elipsoide de anisotropia, de\nforma an\u00e1loga aos variogramas anisotr\u00f3picos da geoestat\u00edstica.\n\nA tend\u00eancia estrutural \u00e9 uma generaliza\u00e7\u00e3o da tend\u00eancia global que permite alterar\na dire\u00e7\u00e3o de continuidade ao longo de uma superf\u00edcie definida pelo usu\u00e1rio, ao inv\u00e9s de\nser baseada em um plano, como a tend\u00eancia global, definida a partir de um elipsoide de\nanisotropia. A tend\u00eancia estrutural \u00e9 baseada em uma superf\u00edcie que pode apresentar\nqualquer forma e orienta\u00e7\u00e3o, e \u00e9 condicionada, geralmente, por restri\u00e7\u00f5es geol\u00f3gicas, como\nfalhas, dobras, folia\u00e7\u00f5es... Para cada ponto da superf\u00edcie (mesh) definida, a tend\u00eancia local\n\u00e9 determinada, produzindo uma anisotropia que varia por todo o espa\u00e7o definido (JOYNT,\n2014).\n\n\n\n2.3. M\u00e9todo implementado no software Leapfrog R\u00a9 37\n\nA tend\u00eancia estrutural n\u00e3o determina a forma final da unidade geol\u00f3gica, ela \u00e9\ndeterminada pelo interpolante e pelas amostras retidas na interpola\u00e7\u00e3o. A Figura 11 mostra\numa superf\u00edcie interpolada usando um interpolante isotr\u00f3pico, a Figura 12 um interpolante\ncom tend\u00eancia global e a Figura 13 um interpolante com tend\u00eancia estrutural. Todos os\ns\u00f3lidos derivam da mesma base de dados.\n\nFigura 11 \u2013 Interpolante isotr\u00f3pico.\n\nFonte: Joynt (2014)\n\nFigura 12 \u2013 Tend\u00eancia global aplicada ao interpolante.\n\nFonte: Joynt (2014)\n\nFigura 13 \u2013 Tend\u00eancia estrutural aplicada ao interpolante.\n\nFonte: Joynt (2014)\n\nO Leapfrog R\u00a9 disponibiliza tr\u00eas tipos de tend\u00eancia estrutural (non-decaying trends,\nblended trends e strongest along meshes), que compartilham os mesmos par\u00e2metros for\u00e7a\n\n\n\n38 Cap\u00edtulo 2. Revis\u00e3o bibliogr\u00e1fica\n\n(strength) e alcance (range). A for\u00e7a \u00e9 semelhante \u00e0 raz\u00e3o do elipsoide e dita quanta\nelonga\u00e7\u00e3o existir\u00e1 em uma determinada dire\u00e7\u00e3o. Enquanto o alcance dita at\u00e9 que dist\u00e2ncia\nda superf\u00edcie definida (mesh) a tend\u00eancia ainda tem efeito (JOYNT, 2014).\n\n2.3.1.3 Vis\u00e3o geral\n\nA metodologia do Leapfrog R\u00a9 compreende cinco passos (COWAN et al., 2002):\n\n1. Valida\u00e7\u00e3o dos dados e compositagem: Esse passo pode ser executado na maior parte\ndos software de minera\u00e7\u00e3o dispon\u00edveis;\n\n2. Interpola\u00e7\u00e3o e meshing: Extrair iso superf\u00edcies de uma fun\u00e7\u00e3o dist\u00e2ncia assinalada\ninterpolada;\n\n3. Incorporar geomorfologia: estruturas geol\u00f3gicas interpretadas pelo geomodelador s\u00e3o\ninseridas no modelo como tend\u00eancia estrutural;\n\n4. Interpola\u00e7\u00e3o da informa\u00e7\u00e3o morfol\u00f3gica: Uma fun\u00e7\u00e3o de interpola\u00e7\u00e3o \u00e9 ajustada \u00e0\ninforma\u00e7\u00e3o digitalizada no passo anterior;\n\n5. Interpola\u00e7\u00e3o condicionada \u00e0 informa\u00e7\u00e3o geomorfol\u00f3gica: A interpola\u00e7\u00e3o do segundo\npasso \u00e9 repetida, dessa vez, condicionada pela fun\u00e7\u00e3o de interpola\u00e7\u00e3o da informa-\n\u00e7\u00e3o morfol\u00f3gica gerada no quarto passo. Essa etapa gera modelos que honram os\ndados amostrais, e s\u00e3o consistentes com a informa\u00e7\u00e3o qualitativa interpretada pelo\ngeomodelador.\n\nA metodologia implementada no leapfrog R\u00a9 supera muitas das limita\u00e7\u00f5es dos m\u00e9to-\ndos expl\u00edcitos. Os dom\u00ednios s\u00e3o constru\u00eddos de forma r\u00e1pida, o m\u00e9todo \u00e9 objetivo, replic\u00e1vel\ne nova informa\u00e7\u00e3o geol\u00f3gica pode ser incorporada facilmente aos modelos. O software conta\ncom fun\u00e7\u00f5es interessantes como a possibilidade de inserir no modelo informa\u00e7\u00e3o geol\u00f3gica\nqualitativa e ferramentas espec\u00edficas para modelar estruturas geol\u00f3gicas complexas como\ndiques. No entanto, o fato da RBF ser um interpolador global pode inviabilizar o uso\ndo m\u00e9todo em bancos de dados muito grandes, o m\u00e9todo n\u00e3o trabalha com m\u00faltiplos\ndom\u00ednios de forma direta e sua licen\u00e7a \u00e9 bastante cara (MCLENNAN; DEUTSCH, 2006).\n\n2.4 M\u00e9todo dos campos potenciais\nO m\u00e9todo dos campos potenciais, implementado no software Isatis R\u00a9, foi criado para\n\nconstruir modelos geol\u00f3gicos tridimensionais a partir de dados de geologia e de explora\u00e7\u00e3o\n(CHIL\u00e8S et al., 2004). O princ\u00edpio do m\u00e9todo \u00e9 derivar a geometria dos dom\u00ednios a partir\nda interpola\u00e7\u00e3o tridimensional de um campo escalar, conhecido como campo potencial. O\n\n\n\n2.4. M\u00e9todo dos campos potenciais 39\n\ncampo potencial \u00e9 constru\u00eddo atrav\u00e9s da cokrigagem da informa\u00e7\u00e3o dos contatos geol\u00f3gicos\nprovenientes de furos de sondagem e dados estruturais (RENARD et al., 2013).\n\nA localiza\u00e7\u00e3o dos contatos estabelece a posi\u00e7\u00e3o de refer\u00eancia de iso valores do\ncampo potencial enquanto os dados de orienta\u00e7\u00e3o s\u00e3o o gradiente da fun\u00e7\u00e3o escalar (campo\npotencial). A geometria dos corpos geol\u00f3gicos \u00e9 obtida a partir da discretiza\u00e7\u00e3o de iso\nvalores de refer\u00eancia (CALCAGNO et al., 2008), semelhante a como uma unidade geol\u00f3gica\n\u00e9 definida a partir de uma iso superf\u00edcie de uma fun\u00e7\u00e3o impl\u00edcita nos m\u00e9todos apresentados\nna se\u00e7\u00e3o 2.3 e se\u00e7\u00e3o 3.1.\n\nA covari\u00e2ncia da cokrigagem e o gradiente do campo potencial estimado podem ser\ntransformados em medidas de incerteza da localiza\u00e7\u00e3o da fronteira dos dom\u00ednios ou usadas\npara mapear a probabilidade de um local n\u00e3o amostrado pertencer a um determinado\ndom\u00ednio geol\u00f3gico (RENARD et al., 2013).\n\n2.4.1 Metodologia\n\nO m\u00e9todo consiste em modelar uma interface geol\u00f3gica ou uma s\u00e9rie de interfaces\nsub paralelas lk, k = 1, 2, .... Seu princ\u00edpio \u00e9 sumarizar a geologia a partir de um campo\npotencial, isto \u00e9, uma fun\u00e7\u00e3o escalar T(p) de qualquer ponto p = (x,y,z) no espa\u00e7o\ntridimensional, a interface lk corresponde a uma superf\u00edcie iso potencial, ou seja, o conjunto\nde pontos p que satisfazem T (p) = tk para algum valor desconhecido tk do campo potencial.\nDe forma an\u00e1loga, a forma\u00e7\u00e3o geol\u00f3gica entre duas interfaces sucessivas lk e lk? \u00e9 definida\npor todos os pontos p os quais o campo potencial pertence ao intervalo definido por tk e\ntk? (CHIL\u00e8S et al., 2004).\n\nA Figura 14 ilustra o princ\u00edpio em duas dimens\u00f5es. \u00c0 esquerda, uma forma\u00e7\u00e3o\ngeol\u00f3gica foi mapeada pela posi\u00e7\u00e3o de suas interfaces com outras duas forma\u00e7\u00f5es (pontos\nvermelhos e azuis) e medidas do mergulho (setas). \u00c0 direita, a forma\u00e7\u00e3o geol\u00f3gica foi\nmodelada pelo m\u00e9todo dos campos potenciais, curvas vermelhas e azuis representam iso\nvalores de refer\u00eancia dos contatos modelados. Curvas brancas s\u00e3o iso valores selecionados\ndo campo potencial, e representam tend\u00eancias geol\u00f3gicas ou trajet\u00f3rias de folia\u00e7\u00f5es. As\ninterfaces honram tanto os pontos pertencentes aos contatos quanto os vetores de orienta\u00e7\u00e3o\n(CALCAGNO et al., 2008).\n\n2.4.2 Tipos de dados\n\nT(p) \u00e9 modelada com dois tipos diferentes de dados (CHIL\u00e8S et al., 2004):\n\n1. Coordenadas tridimensionais de pontos que pertencem \u00e0s interfaces l1, l2, ... (contatos\ngeol\u00f3gicos);\n\n\n\n40 Cap\u00edtulo 2. Revis\u00e3o bibliogr\u00e1fica\n\nFigura 14 \u2013 Princ\u00edpio do m\u00e9todo dos campos potenciais em duas dimens\u00f5es.\n\nFonte: Calcagno et al. (2008)\n\n2. Vetores unit\u00e1rios tridimensionais que pertencem ao campo de orienta\u00e7\u00e3o das interfa-\nces.\n\nNa modelagem tridimensional de interfaces sedimentares, a informa\u00e7\u00e3o estrutural\nconsiste em vetores unit\u00e1rios ortogonais ao principal plano de anisotropia (acamamento,\nxistosidade, folia\u00e7\u00e3o) e apontando no sentido das forma\u00e7\u00f5es mais jovens. Na modelagem\nde um dom\u00ednio mineralizado, os vetores unit\u00e1rios apontam do interior para o exterior dos\ndom\u00ednios (RENARD et al., 2013).\n\n2.4.2.1 Codifica\u00e7\u00e3o dos dados\n\nPara interpolar o campo potencial, os dados devem ser codificados da seguinte\nforma (CHIL\u00e8S et al., 2004; CALCAGNO et al., 2008; RENARD et al., 2013):\n\n1. Pontos da interface: O valor potencial c associado com a interface n\u00e3o \u00e9 conhecido,\nmas a diferen\u00e7a potencial entre dois pontos de uma interface \u00e9 igual a zero (j\u00e1 que\nas superf\u00edcies s\u00e3o equipotenciais). Os m + 1 pontos p0,p1, ...,pm da interface s\u00e3o\ntransladados em m incrementos T(p?) ?T(p??) = 0, ? = 1, ...,m. p?? pode ser tanto\no ponto p0 ou o ponto p??1 (a escolha n\u00e3o tem impacto no resultado);\n\n2. Dados de orienta\u00e7\u00e3o: Os vetores unit\u00e1rios normais a cada plano estrutural, s\u00e3o\nconsiderados como gradiente do campo potencial, equivalentes ao valor da derivada\nparcial ?T (p)\n\n?u\nno ponto medido p? em qualquer dire\u00e7\u00e3o u. O dado estrutural em p?\n\npode ser escrito como tr\u00eas derivadas parciais da forma ?T (p?)\n?u?\n\n, u?, representando\nos eixos de coordenadas x,y,z (um outro conjunto de derivadas parciais em tr\u00eas\n\n\n\n2.4. M\u00e9todo dos campos potenciais 41\n\ndire\u00e7\u00f5es ortogonais tamb\u00e9m pode ser considerado. Por exemplo, o vetor unit\u00e1rio\npode ser expressado por uma derivada parcial igual a um na dire\u00e7\u00e3o do vetor, e duas\nderivadas parciais iguais a zero nas dire\u00e7\u00f5es que definem o plano estrutural).\n\n2.4.2.2 Interpola\u00e7\u00e3o do campo potencial\n\nA fun\u00e7\u00e3o potencial T(.) \u00e9 definida at\u00e9 uma constante arbitr\u00e1ria que \u00e9 o potencial\nem um ponto de refer\u00eancia arbitr\u00e1rio p0. Em cada ponto p o incremento do campo potencial\nT(p) ?T(p0) \u00e9 krigado. O estimador de cokrigagem \u00e9 escrito como:\n\nT?(p) ?T?(p0) =\nM?\n?=1\n\n\u00b5?(T(p?) ?T(p??)) +\nN?\n?=1\n\n??\n?T (p?)\n?u?\n\n(2.12)\n\nOnde os pesos \u00b5? e ??, determinados pelo sistema de cokrigaem, s\u00e3o fun\u00e7\u00e3o de p (e\np0). Embora a contribui\u00e7\u00e3o dos incrementos potenciais seja zero, os pesos ?? s\u00e3o diferentes\ndos pesos baseados apenas nos dados de gradiente.\n\nA cokrigagem \u00e9 estabelecida sob o modelo de fun\u00e7\u00e3o aleat\u00f3ria (subse\u00e7\u00e3o 2.1.1).\nT(.) \u00e9 assumido como uma fun\u00e7\u00e3o aleat\u00f3ria com deriva (drift) polinomial m(p):\n\nm(p) =\nL?\nl=0\n\nblf\nl(p) (2.13)\n\nE uma vari\u00e2ncia estacion\u00e1ria K(h) (CALCAGNO et al., 2008; RENARD et al.,\n2013). Uma vez que as fun\u00e7\u00f5es b\u00e1sicas f l(p) da deriva e a covari\u00e2ncia K(h) de T (.) sejam\nconhecidas, a cokrigagem, na presen\u00e7a de dados do gradiente, pode ser calculada. J\u00e1 que a\nderivada de ?T (p)\n\n?u\nvale ?m(p)\n\n?u\n, isto \u00e9, uma combina\u00e7\u00e3o linear das derivadas parciais ?f\n\nl(p)\n?u\n\ncom\nos mesmos coeficientes desconhecidos bl de m(p). As covari\u00e2ncias das derivadas parciais\ns\u00e3o derivadas parciais de segunda ordem de K(.), e as covari\u00e2ncias cruzadas entre campo\npotencial e as derivadas parciais s\u00e3o derivadas parciais de K(.) (CHIL\u00e8S et al., 2004).\n\n2.4.2.3 Implementa\u00e7\u00e3o do algoritmo de cokrigagem\n\nO incremento dos dados potenciais n\u00e3o contribuem com as estimativas finais. O\nestimador pode ser visto como integra\u00e7\u00e3o dos dados de gradiente (CHIL\u00e8S et al., 2004). Para\ngarantir a continuidade espacial do estimador, \u00e9 usada apenas uma vizinhan\u00e7a incluindo\ntodos os dados. Quando n\u00e3o h\u00e1 interesse na vari\u00e2ncia, a cokrigagem \u00e9 implementada em\nsua forma dual (dual kriging), assim, o sistema de krigagem \u00e9 resolvido uma \u00fanica vez.\n\nT?(p) ?T?(p0) pode ser obtido em qualquer ponto. Seu sinal indica onde p est\u00e1\nlocalizado, negativo para forma\u00e7\u00f5es mais antigas, positivo para forma\u00e7\u00f5es mais recentes e\nzero para a interface. Essa propriedade permite a visualiza\u00e7\u00e3o em tr\u00eas dimens\u00f5es do modelo\n\n\n\n42 Cap\u00edtulo 2. Revis\u00e3o bibliogr\u00e1fica\n\ngeol\u00f3gico a partir de um algoritmo de cubos marchantes (marching cubes) (LORENSEN;\nCLINE, 1987), que rastreia a iso superf\u00edcie do campo potencial (CALCAGNO et al., 2008).\n\n2.4.2.4 Vari\u00e2ncia do campo potencial\n\nNa geoestat\u00edstica, a covari\u00e2ncia ou variograma de uma vari\u00e1vel s\u00e3o modeladas a\npartir dos dados. Por\u00e9m, n\u00e3o h\u00e1 medidas do potencial T(x), e os incrementos potenciais\nusados na interpola\u00e7\u00e3o n\u00e3o podem ser usados na infer\u00eancia de K, j\u00e1 que todos valem zero.\n\nNa sua primeira implementa\u00e7\u00e3o, o algoritmo era baseado em um modelo de covari-\n\u00e2ncia arbitrariamente escolhido pelo usu\u00e1rio (CHIL\u00e8S et al., 2004).\n\nQuando existem muitos dados estruturais dispon\u00edveis, o variograma das derivadas\nparciais pode ser calculado. Os variogramas das derivadas parciais s\u00e3o derivadas de segunda\nordem do variograma do campo potencial. Renard et al. (2013) recomenda que uma soma\nde modelos anisotr\u00f3picos c\u00fabicos de covari\u00e2ncia sejam adotados para modelar a covari\u00e2ncia.\n\n2.4.2.5 Incerteza nos modelos\n\nUma forma\u00e7\u00e3o geol\u00f3gica definida pelo conjunto de pontos p tais que T(p) ?T(p0)\nest\u00e1 compreendido entre os dois valores t e t?. Sob a suposi\u00e7\u00e3o de que o campo potencial\n\u00e9 uma fun\u00e7\u00e3o aleat\u00f3ria gaussiana, a probabilidade de um dado ponto p pertencer \u00e0 essa\nforma\u00e7\u00e3o \u00e9:\n\nP{t ? T(p) ?T(p0) &lt;t?} =\n\nG\n\n(\nt? ? (T?(p) ?T?(p0))\n\n?CK(p)\n\n)\n?G\n\n(\nt? (T?(p) ?T?(p0))\n\n?CK(p)\n\n) (2.14)\nOnde G \u00e9 a fun\u00e7\u00e3o de distribui\u00e7\u00e3o acumulada normal.\n\nDe forma an\u00e1loga, para a interface que passa por p0\n\nR(p) = T(p) ?T(p0) =\nT?(p) ?T?(p0)\n\n?CK\n(2.15)\n\nMede a probabilidade de p pertencer \u00e0 interface.\n\n2.4.2.6 Vis\u00e3o geral\n\nA metodologia compreende cinco passos (MCLENNAN; DEUTSCH, 2006):\n\n1. Coletar dados de interse\u00e7\u00e3o e dados de orienta\u00e7\u00e3o em superf\u00edcie;\n\n2. Determinar a forma da deriva (drift) localmente vari\u00e1vel;\n\n3. Inferir a fun\u00e7\u00e3o covari\u00e2ncia do campo potencial;\n\n\n\n2.4. M\u00e9todo dos campos potenciais 43\n\n4. Interpolar o campo potencial com cokrigagem;\n\n5. Visualizar a incerteza na localiza\u00e7\u00e3o das fronteiras estimadas.\n\nO m\u00e9todo ainda permite a incorpora\u00e7\u00e3o de falhas e informa\u00e7\u00e3o geof\u00edsica. \u00c9 um\nm\u00e9todo flex\u00edvel, que incorpora uma gama de dados diferentes na modelagem dos dom\u00ednios\ngeol\u00f3gicos. \u00c9 r\u00e1pido, em compara\u00e7\u00e3o com os m\u00e9todos expl\u00edcitos, \u00e9 objetivo e replic\u00e1vel.\nCapaz de produzir modelos bastante complexos como o da Figura 15. Por\u00e9m, o proce-\ndimento n\u00e3o \u00e9 simples. \u00c9 dif\u00edcil inferir a covari\u00e2ncia dos campos potenciais j\u00e1 que n\u00e3o\nexistem dados amostrais do campo. As medi\u00e7\u00f5es de orienta\u00e7\u00f5es nem sempre existem ou\ns\u00e3o de f\u00e1cil obten\u00e7\u00e3o. O m\u00e9todo et\u00e1 implementado apenas em software pago.\n\nFigura 15 \u2013 Modelo geol\u00f3gico criado a partir do m\u00e9todo dos campos potenciais, em planta\n(acima). Se\u00e7\u00e3o N6 (abaixo).\n\nFonte: Chil\u00e8s et al. (2004)\n\n\n\n\n\n45\n\n3 Modelagem geol\u00f3gica impl\u00edcita com fun-\n\u00e7\u00f5es dist\u00e2ncia assinaladas\n\nO m\u00e9todo \u00e9 baseado na interpola\u00e7\u00e3o de uma fun\u00e7\u00e3o impl\u00edcita calculada para cada\namostra e posterior defini\u00e7\u00e3o de uma superf\u00edcie de iso valores da fun\u00e7\u00e3o interpolada. A\ncada amostra \u00e9 atribu\u00edda a dist\u00e2ncia euclideana anisotr\u00f3pica entre ela mesma e a amostra\nmais pr\u00f3xima que pertence a um outro dom\u00ednio geol\u00f3gico. O sinal da dist\u00e2ncia calculada\nrevela se a amostra se encontra no interior (sinal negativo) ou exterior (sinal positivo) do\ndom\u00ednio a ser modelado. A interpola\u00e7\u00e3o dessas medidas de dist\u00e2ncia permite a constru\u00e7\u00e3o\nde um modelo bin\u00e1rio de dom\u00ednio geol\u00f3gico aplicando uma regra de corte (valor zero) na\nfun\u00e7\u00e3o impl\u00edcita interpolada (SILVA; DEUTSCH, 2012).\n\nAo contr\u00e1rio dos m\u00e9todos visitados nas se\u00e7\u00e3o 2.3 e se\u00e7\u00e3o 2.4, que permitiam a\nmodelagem de um dom\u00ednio por vez, esse m\u00e9todo permite modelar m\u00faltiplos dom\u00ednios\nsimultaneamente. Sendo assim, a categoria correspondente a menor dist\u00e2ncia estimada\ndeve ser retida.\n\n3.1 Metodologia\n\n3.1.1 Caso bin\u00e1rio\n\nPrimeiramente, o conjunto de dados z(u?),? = 1, ...,n \u00e9 codificado em indicadores\nbin\u00e1rios de acordo com a Equa\u00e7\u00e3o 3.1, especificando se a amostra pertence ou n\u00e3o ao\ndom\u00ednio.\n\ni(u?) =\n\n???\n??\n\n1, se z(u?) se pertence ao dom\u00ednio\n\n0, se z(u?) caso contr\u00e1rio\n(3.1)\n\nSilva (2015) apresentou um exemplo simples em duas dimens\u00f5es para ilustrar o\nm\u00e9todo. Na Figura 16 os pontos amostrais foram codificados em indicadores.\n\nEnt\u00e3o, as dist\u00e2ncias assinaladas s\u00e3o calculadas para cada amostra de acordo com\na Equa\u00e7\u00e3o 3.2. Se a amostra pertence ao dom\u00ednio modelado a dist\u00e2ncia \u00e9 negativa, caso\ncontr\u00e1rio positiva.\n\nd(u?) =\n\n???\n??\n?? u? ?u? ?, se i(u?) = 1\n\n+ ? u? ?u? ?, se i(u?) = 0\n(3.2)\n\n\n\n46 Cap\u00edtulo 3. Modelagem geol\u00f3gica impl\u00edcita com fun\u00e7\u00f5es dist\u00e2ncia assinaladas\n\nFigura 16 \u2013 Transforma\u00e7\u00e3o do banco de dados categ\u00f3ricos em indicadores bin\u00e1rios.\n\nFonte: Modificado de Silva (2015)\n\nO local u? corresponde \u00e0 amostra mais pr\u00f3xima que perten\u00e7a a um dom\u00ednio diferente\nde u?. A regra euclideana \u00e9 usada no c\u00e1lculo.\n\nA Figura 17 mostra as dist\u00e2ncias assinaladas calculadas para cada ponto amostral.\n\nFigura 17 \u2013 Fun\u00e7\u00e3o dist\u00e2ncia assinalada calculada para cada ponto amostral.\n\nFonte: Modificado de Silva (2015)\n\nNos casos em que h\u00e1 o conhecimento de que o corpo geol\u00f3gico se estende mais em\numa dire\u00e7\u00e3o do que nas outras (como os corpos tabulares, por exemplo) as dist\u00e2ncias\ncalculadas podem ser anisotr\u00f3picas. Assim sendo, as coordenadas originais x, y e z dos\ndados devem ser rotacionadas e/ou contra\u00eddas/dilatadas, a partir da transforma\u00e7\u00e3o da\nEqua\u00e7\u00e3o 3.3. Ent\u00e3o, as dist\u00e2ncias euclideanas (Equa\u00e7\u00e3o 3.2) s\u00e3o calculadas normalmente\n\n\n\n3.1. Metodologia 47\n\npara as novas coordenadas x??, y??, z??.\n\n?\n????\nx??\n\ny??\n\nz??\n\n?\n???? =\n\n?\n????\n\n1\namax\n\n0 0\n0 1\n\namin\n0\n\n0 0 1\navert\n\n?\n????\n\n?\n????\n\ncos ? cos ?? sin ? sin ? sin ? ?sin ? cos ?? cos ? sin ? sin ? cos ? sin ?\nsin ? cos ? cos ? cos ? sin ?\n\n?cos ? sin ?? sin ? sin ? cos ? sin ? sin ?? cos ? sin ? cos ? cos ? cos ?\n\n?\n????\n?\n????\nx\n\ny\n\nz\n\n?\n????\n\n(3.3)\n\nOnde amax, amin e avert s\u00e3o as dimens\u00f5es dos eixos m\u00e1ximo, m\u00e9dio e m\u00ednimo de\nanisotropia, e ?, ? e ?, os \u00e2ngulos de azimute, mergulho e rake, respectivamente.\n\nA constru\u00e7\u00e3o da fun\u00e7\u00e3o impl\u00edcita em cada ponto amostral \u00e9 a mesma para o m\u00e9todo\nvisitado na se\u00e7\u00e3o 2.3.\n\nA fun\u00e7\u00e3o dist\u00e2ncia calculada para cada amostra \u00e9 ent\u00e3o interpolada para todos os\npontos de interesse, a partir da Equa\u00e7\u00e3o 3.4. Qualquer t\u00e9cnica de interpola\u00e7\u00e3o pode ser\nutilizada. Inverso da dist\u00e2ncia e krigagem produzem limites real\u00edsticos para os dom\u00ednios.\nPor\u00e9m, a krigagem permite levar em considera\u00e7\u00e3o a anisotropia e continuidade espacial\ndas dist\u00e2ncias calculadas (SILVA; DEUTSCH, 2012).\n\nSilva e Deutsch (2012), Deutsch e Wilde (2013), Silva (2015) recomendam que a\nkrigagem global (NEUFELD; WILDE, 2005), um interpolador suave que ret\u00e9m todas\nas amostras nas estimativas (n\u00e3o h\u00e1 estrat\u00e9gia de busca), seja utilizada. Desse modo,\nevita-se o surgimento de artefatos nos mapas gerados. Todavia, reter todas as amostras na\ninterpola\u00e7\u00e3o pode aumentar consideravelmente o tempo de execu\u00e7\u00e3o do algoritmo. Testes\nrealizados no Cap\u00edtulo 4 mostraram que o uso da krigagem ordin\u00e1ria com uma vizinhan\u00e7a\nde busca e n\u00famero de amostras retidas suficientemente grandes, produzem um resultado\nmuito semelhante \u00e0 krigagem global.\n\nd?(u) =\nn?\n\n?=1\n?OK? (u)d(u?) (3.4)\n\nOnde d?(u) \u00e9 a dist\u00e2ncia estimada para cada local n\u00e3o amostrado u, ?OK? (u) os\npesos de krigagem ordin\u00e1ria e d(u?) o valor da fun\u00e7\u00e3o dist\u00e2ncia assinalada calculado para\ncada amostra.\n\nA Figura 18 mostra a fun\u00e7\u00e3o dist\u00e2ncia interpolada por krigagem ordin\u00e1ria em\ntodos os pontos de interesse.\n\nPor fim, cada local de interesse \u00e9 classificado com base no sinal da fun\u00e7\u00e3o dist\u00e2ncia\ninterpolada, de acordo com a Equa\u00e7\u00e3o 3.5. Blocos em que a fun\u00e7\u00e3o tem valor negativo, s\u00e3o\n\n\n\n48 Cap\u00edtulo 3. Modelagem geol\u00f3gica impl\u00edcita com fun\u00e7\u00f5es dist\u00e2ncia assinaladas\n\nFigura 18 \u2013 Fun\u00e7\u00e3o dist\u00e2ncia interpolada para todos os locais de interesse.\n\nFonte: Modificado de Silva (2015)\n\nclassificados como pertencentes ao dom\u00ednio. Blocos em que a fun\u00e7\u00e3o tem valor positivo,\nclassificados como n\u00e3o pertencentes ao dom\u00ednio.\n\nComo as fun\u00e7\u00f5es dist\u00e2ncia s\u00e3o negativas no interior do dom\u00ednio e positivas no\nexterior, um bom palpite inicial para a interface que separa os dom\u00ednios no espa\u00e7o, seria a\nlinha (em duas dimens\u00f5es) ou superf\u00edcie (em tr\u00eas dimens\u00f5es) que corresponda ao valor\nzero da fun\u00e7\u00e3o dist\u00e2ncia assinalada (WILDE; DEUTSCH, 2011).\n\ni?(u) =\n\n???\n??\n\n1, se d?(u) ? 0\n\n0, caso contr\u00e1rio\n(3.5)\n\nA Figura 19 mostra o modelo geol\u00f3gico criado para o dom\u00ednio a partir do sinal da\nfun\u00e7\u00e3o dist\u00e2ncia interpolada (Figura 18).\n\n3.1.2 Aplica\u00e7\u00e3o da metodologia para m\u00faltiplos dom\u00ednios geol\u00f3gicos\n\nA metodologia apresentada na subse\u00e7\u00e3o 3.1.1 \u00e9 adequada apenas para casos bin\u00e1rios,\nna presen\u00e7a de m\u00faltiplas categorias Silva e Deutsch (2012) propuseram, tamb\u00e9m, uma\nmetodologia. O objetivo \u00e9 modelar os diversos dom\u00ednios geol\u00f3gicos simultaneamente de\nforma similar ao caso bin\u00e1rio.\n\nSe existirem K m\u00faltiplos dom\u00ednios no dep\u00f3sito mineral, para cada ponto amostral\nz(u?),? = 1, ...,n, um vetor de indicadores de K elementos \u00e9 codificado de acordo com a\n\n\n\n3.1. Metodologia 49\n\nFigura 19 \u2013 Modelo geol\u00f3gico criado a partir do sinal da fun\u00e7\u00e3o dist\u00e2ncia interpolada.\n\nFonte: Modificado de Silva (2015)\n\nEqua\u00e7\u00e3o 3.6.\n\nik(u?) =\n\n???\n??\n\n1, se z(u?) = k\n\n0, se z(u?) caso contr\u00e1rio\nk = 1, ...,K (3.6)\n\nAs amostras s\u00e3o codificadas K vezes, uma vez para cada dom\u00ednio.\n\nDa mesma forma que na Equa\u00e7\u00e3o 3.2, a fun\u00e7\u00e3o dist\u00e2ncia \u00e9 calculada, individual-\nmente para cada elemento k do vetor, de acordo com a Equa\u00e7\u00e3o 3.7.\n\ndk(u?) =\n\n???\n??\n?? u? ?u? ?, se ik(u?) = 1\n\n+ ? u? ?u? ?, se ik(u?) = 0\nk = 1, ...,K (3.7)\n\nDiferentes anisotropias podem ser incorporadas para cada categoria, a correla\u00e7\u00e3o\nentre as dist\u00e2ncias calculadas n\u00e3o \u00e9 considerada.\n\nAs dist\u00e2ncias calculadas s\u00e3o ent\u00e3o interpoladas, individualmente, para cada cate-\ngoria, de acordo com a Equa\u00e7\u00e3o 3.8.\n\nd?k(u) =\nn?\n\n?=1\n?OK? (u)dk(u?) k = 1, ...,K (3.8)\n\nQuando os m\u00faltiplos variogramas s\u00e3o similares, um \u00fanico modelo pode se conside-\nrado.\n\nPor fim, cada bloco \u00e9 classificado pela Equa\u00e7\u00e3o 3.9\n\ni?(u) = k? de modo que d?k? = min{d\n?\nk(u)}\n\nK\nk=1 (3.9)\n\n\n\n50 Cap\u00edtulo 3. Modelagem geol\u00f3gica impl\u00edcita com fun\u00e7\u00f5es dist\u00e2ncia assinaladas\n\nAs dist\u00e2ncias estimadas fornecem uma medida de proximidade ao dom\u00ednio oposto\nmais pr\u00f3ximo. Sendo assim, a m\u00ednima dist\u00e2ncia assinalada estimada \u00e9 tida como o dom\u00ednio\nmais prov\u00e1vel de ser encontrado numa regi\u00e3o n\u00e3o amostrada. A Equa\u00e7\u00e3o 3.9 sumariza essa\nideia (SILVA, 2015). A categoria associada com a menor dist\u00e2ncia estimada \u00e9 carimbada\nem cada bloco.\n\nA Figura 20 mostra um exemplo de um modelo geol\u00f3gico criado a partir da m\u00ednima\ndist\u00e2ncia assinalada estimada. A esquerda, a figura mostra a proje\u00e7\u00e3o das dist\u00e2ncias\nassinaladas para cada uma das quatro categorias, e \u00e0 direita a classifica\u00e7\u00e3o final.\n\nFigura 20 \u2013 Fun\u00e7\u00e3o dist\u00e2ncia interpolada para todos os locais de interesse.\n\nFonte: Modificado de Silva (2015)\n\n3.2 Uma medida heur\u00edstica de incerteza (softmax transformation)\nA metodologia proposta por Silva e Deutsch (2012) n\u00e3o caracteriza a incerteza\n\nassociada ao modelo geol\u00f3gico. Silva (2015) apresentou uma forma heur\u00edstica para deter-\nmina\u00e7\u00e3o da incerteza, essa metodologia n\u00e3o \u00e9 baseada em m\u00faltiplas realiza\u00e7\u00f5es de uma\nfun\u00e7\u00e3o aleat\u00f3ria, \u00e9 um p\u00f3s processamento derivado de uma transforma\u00e7\u00e3o.\n\nV\u00e1rias formas de determinar a incerteza para m\u00e9todos determin\u00edsticos de modelagem\ngeol\u00f3gica impl\u00edcita foram desenvolvidos. McLennan e Deutsch (2006) propuseram uma\nmetodologia para quantificar a incerteza de volumes geol\u00f3gicos criados a partir de fun\u00e7\u00f5es\nvolume (muito similares \u00e0s fun\u00e7\u00f5es dist\u00e2ncia assinaladas) a partir da t\u00e9cnica de bootstrap\nsampling. Munroe (2012) prop\u00f4s calibrar uma banda de incerteza ao longo dos contatos\nentre os dom\u00ednios, uma ideia similar foi implementada por Wilde e Deutsch (2011),\nonde a incerteza \u00e9 considerada diretamente na krigagem, adicionando uma constante \u00e0s\nestimativas.\n\nAs dist\u00e2ncias estimadas em cada bloco para cada categoria carregam consigo\n\n\n\n3.2. Uma medida heur\u00edstica de incerteza (softmax transformation) 51\n\ninforma\u00e7\u00e3o adicional. Como j\u00e1 discutido, as dist\u00e2ncias estimadas fornecem uma medida\nde proximidade \u00e0 interface mais pr\u00f3xima. Ent\u00e3o, as dist\u00e2ncias podem ser estandardizadas\nentre zero e um, fornecendo uma medida de incerteza (SILVA, 2015).\n\n3.2.0.1 Transforma\u00e7\u00e3o das dist\u00e2ncias\n\nSoftmax transformation \u00e9 uma t\u00e9cnica amplamente usada em m\u00e9todos de classifi-\nca\u00e7\u00e3o para m\u00faltiplas classes (MCCULLAGH; NELDER, 1989). A ideia \u00e9 transformar as\ndist\u00e2ncias estimadas em probabilidades a partir da Equa\u00e7\u00e3o 3.10. Os valores transformados\nencontram-se entre zero e um e sua soma deve ser igual a um, para cada bloco estimado.\n\nP(i(u) = k) =\ne\n?d?\nk\n\n(u)\n?\n\n?K\nk?=1 e\n\n?d?\nk\n\n(u)\n?\n\n(3.10)\n\nP(i(u) = k) representa a probabilidade de um local u pertencer \u00e0 categoria k,\nd?k(u) \u00e9 a dist\u00e2ncia estimada para a categoria k e ? \u00e9 um par\u00e2metro que regula a inter-\nrela\u00e7\u00e3o entre as probabilidades das K diferentes categorias. Quanto maior ?, maior as\ndiferen\u00e7as entre as probabilidades (maior a banda de incerteza), como pode ser observado\nna Figura 21.\n\nFigura 21 \u2013 Mapas de probabilidades gerados com dois valores de gamma diferentes. \u00c0\nesquerda ? = 80, \u00e0 direita ? = 175.\n\nPara exemplificar a transforma\u00e7\u00e3o, a Figura 22, mostra \u00e0 esquerda as dist\u00e2ncias\nestimadas para cada uma de cinco categorias em um mesmo bloco em particular. \u00c0 direita\nas dist\u00e2ncias transformadas pela Equa\u00e7\u00e3o 3.10 em probabilidades daquele bloco pertencer\na cada uma das cinco categorias. Observe que dist\u00e2ncias menores (mais negativas) geram\nprobabilidades maiores, e vice-versa.\n\n\n\n52 Cap\u00edtulo 3. Modelagem geol\u00f3gica impl\u00edcita com fun\u00e7\u00f5es dist\u00e2ncia assinaladas\n\nFigura 22 \u2013 Dist\u00e2ncias estimadas e transformadas em probabilidades para um mesmo\nbloco.\n\n3.3 Corre\u00e7\u00e3o das propor\u00e7\u00f5es globais dos dom\u00ednios (servo system)\nUma das preocupa\u00e7\u00f5es durante a modelagem geol\u00f3gica impl\u00edcita de dom\u00ednios\n\ngeol\u00f3gicos \u00e9 quanto \u00e0 inser\u00e7\u00e3o de vi\u00e9s nos modelos. O vi\u00e9s pode ser proveniente da\nintera\u00e7\u00e3o entre os par\u00e2metros e o algoritmo, da variabilidade geol\u00f3gica ou da configura\u00e7\u00e3o\nda malha de amostragem.\n\nTipicamente, as campanhas de sondagem t\u00eam como foco \u00e1reas de altos teores.\nComo se espera obter lucro ainda nos primeiros anos de opera\u00e7\u00e3o, mais informa\u00e7\u00e3o das\n\u00e1reas mais ricas do dep\u00f3sito \u00e9 fundamental. Essa pr\u00e1tica \u00e9 conhecida como amostragem\npreferencial e pode levar ao c\u00e1lculo enviesado das propor\u00e7\u00f5es de cada dom\u00ednio, caso n\u00e3o\nreceba o tratamento devido. Existem diversas t\u00e9cnicas de desagrupamento dispon\u00edveis,\ndentre as mais utilizadas, o m\u00e9todo dos pol\u00edgonos e m\u00e9todo das c\u00e9lulas (SILVA, 2015).\n\nSilva (2015) prop\u00f4s, como uma extens\u00e3o do algoritmo, gerar modelos que corres-\npondem \u00e0s estat\u00edsticas representativas (desagrupadas) dos dom\u00ednios do dep\u00f3sito. Essas\npropor\u00e7\u00f5es s\u00e3o calculadas a partir das probabilidades obtidas atrav\u00e9s da softmax tranfor-\nmation.\n\n3.3.1 Servo system\n\nA corre\u00e7\u00e3o com servo system foi introduzida por Str\u00e9belle e Journel (2000) e\nobjetiva ajustar a probabilidade marginal ao longo do processo iterativo de simula\u00e7\u00e3o por\nMPS em cada n\u00f3.\n\nA t\u00e9cnica possibilita reproduzir um conjunto de propor\u00e7\u00f5es pr\u00e9-definido, as pro-\npor\u00e7\u00f5es observadas nos dados desagrupados, por exemplo. A ideia central do algoritmo \u00e9\natualizar as probabilidades para cada dom\u00ednio, em cada n\u00f3, baseado na diferen\u00e7a entre\na propor\u00e7\u00e3o alvo e a propor\u00e7\u00e3o marginal corrente (propor\u00e7\u00e3o encontradas nos blocos\nvisitados at\u00e9 ent\u00e3o) (Equa\u00e7\u00e3o 3.11), a intensidade da corre\u00e7\u00e3o \u00e9 proporcional \u00e0 magnitude\nda diferen\u00e7a.\n\nP(i(u) = k)update = P(i(u) = k) + \u00b5(p(k) ?Pck (u)) (3.11)\n\n\n\n3.3. Corre\u00e7\u00e3o das propor\u00e7\u00f5es globais dos dom\u00ednios (servo system) 53\n\nP(i(u) = k)update \u00e9 a probabilidade atualizada em cada bloco u, P(i(u) = k) \u00e9 a\nprobabilidade para o bloco u calculada a partir da softmax transformation, \u00b5 \u00e9 o par\u00e2metro\nque controla a intensidade da corre\u00e7\u00e3o, e vale \u00b5 = ?1??, quanto mais pr\u00f3ximo de um ?\nfor, mais corre\u00e7\u00e3o nas propor\u00e7\u00f5es. p(k) e Pck (u) s\u00e3o respectivamente, a propor\u00e7\u00e3o alvo e a\npropor\u00e7\u00e3o marginal corrente para a litologia k. O algoritmo deve visitar os blocos em um\ncaminho aleat\u00f3rio para evitar o surgimento de artefatos nos modelos gerados.\n\nAp\u00f3s as probabilidades de cada bloco pertencer a cada litologia serem atualizadas\ncom a Equa\u00e7\u00e3o 3.11, um novo modelo geol\u00f3gico deve ser gerado a partir da Equa\u00e7\u00e3o 3.12.\n\ni?(u) = argmaxP(i(u) = k)updated (3.12)\n\nCada bloco \u00e9 reclassificado, n\u00e3o mais pela menor dist\u00e2ncia estimada, mas pela\nmaior probabilidade atualizada.\n\nMuitas vezes, a escolha do par\u00e2metro \u00b5 (muito alta), gera modelos com apar\u00eancia\ngranulada ou salt and pepper (Figura 23 \u00e0 esquerda), que n\u00e3o fazem sentido f\u00edsico. Uma\nfase de p\u00f3s processamento para suavizar o modelo est\u00e1 embutida no algoritmo do servo\nsystem (duas novas propriedades s\u00e3o criadas, uma n\u00e3o corrigida e uma corrigida). Cada\nn\u00f3 do grid \u00e9 visitado seguindo um caminho aleat\u00f3rio, novamente para evitar o surgimento\nde artefatos nos modelos. Um cubo de dimens\u00f5es 3x3x3 blocos c\u00fabicos \u00e9 centrado no\nbloco visitado e a propor\u00e7\u00e3o de cada litologia \u00e9 calculada, considerando apenas os blocos\nabrangidos pelo cubo. A litologia que apresenta a maior propor\u00e7\u00e3o \u00e9 carimbada no bloco\nvisitado, metodologia semelhante \u00e9 utilizada em classifica\u00e7\u00e3o de recursos minerais.\n\nA Figura 23 mostra um modelo gerado com um par\u00e2metro ? = 0.99 \u00e0 esquerda\ne um modelo gerado com ? = 0, ou seja, um modelo sem corre\u00e7\u00e3o baseado na menor\ndist\u00e2ncia estimada.\n\nFigura 23 \u2013 Modelos geol\u00f3gicos gerados, sem corre\u00e7\u00e3o das propor\u00e7\u00f5es \u00e0 direita e com\ncorre\u00e7\u00e3o, usando um fator ? = 0, 99 \u00e0 esquerda.\n\nAlguns modelos podem apresentar efeito de borda, quando a influ\u00eancia de amostras\nlocalizadas nas bordas da malha de sondagem \u00e9 extrapolada com exagero pelo algoritmo,\n\n\n\n54 Cap\u00edtulo 3. Modelagem geol\u00f3gica impl\u00edcita com fun\u00e7\u00f5es dist\u00e2ncia assinaladas\n\ncriando estruturas inveross\u00edmeis. A aplica\u00e7\u00e3o do servo system tamb\u00e9m controla a extens\u00e3o\ndesse tipo de estrutura, reduzindo o efeito de borda.\n\n3.4 O Plug-in\n\nO m\u00e9todo foi operacionalizado no software geoestat\u00edstico de c\u00f3digo aberto SGeMS,\ncom a cria\u00e7\u00e3o de dois plug-ins em linguagem python. Os c\u00f3digos podem ser encontrados\nno Ap\u00eandice A e Ap\u00eandice B, bem como no reposit\u00f3rio online&lt;https://github.com/\nLPM-UFRGS/dfmod>\n\nNo painel de algoritmos, h\u00e1 a op\u00e7\u00e3o DFMod (Figura 24), que traz dois plugins:\nsigned distances e interpolator. O primeiro calcula o valor da fun\u00e7\u00e3o dist\u00e2ncia assinalada\npara cada amostra e para cada litologia. O segundo interpola a fun\u00e7\u00e3o dist\u00e2ncia, usando\nkrigagem ordin\u00e1ria, para todo o grid, al\u00e9m de apresentar op\u00e7\u00f5es de calcular a incerteza com\nsoftmax transformation (se\u00e7\u00e3o 3.2) e corrigir as propor\u00e7\u00f5es com servo system (se\u00e7\u00e3o 3.3).\n\nFigura 24 \u2013 Vis\u00e3o do painel de algoritmos do SGeMS mostrando a op\u00e7\u00e3o DFMOD.\n\n3.4.1 Signed distances\n\nO plugin signed distances (Figura 25) calcula, para uma propriedade categ\u00f3rica, o\nvalor da fun\u00e7\u00e3o dist\u00e2ncia anisotr\u00f3pica (ou isotr\u00f3pica), para cada amostra e cada litologia.\nO SGeMS aceita apenas litologias codificadas em caracteres num\u00e9ricos.\n\nhttps://github.com/LPM-UFRGS/dfmod\nhttps://github.com/LPM-UFRGS/dfmod\n\n\n3.4. O Plug-in 55\n\nFigura 25 \u2013 Vis\u00e3o do plugin signed distances.\n\nEm (i), usu\u00e1rio deve imputar a propriedade que informa a litologia (rock type) de\ncada amostra. Em (ii), o usu\u00e1rio imputa os \u00e2ngulos de rota\u00e7\u00e3o e raz\u00f5es de anisotropia,\npara o c\u00e1lculo das dist\u00e2ncias anisotr\u00f3picas, o valor padr\u00e3o calcula dist\u00e2ncias isotr\u00f3picas.\n\nComo output, o plugin gera uma propriedade signed distances RTX para cada\nlitologia, onde X \u00e9 o algarismo que representa aquela litologia.\n\nO quadro Algoritmo 1 abaixo, mostra o funcionamento do algoritmo.\n\nAlgoritmo 1: Signed distances\nInput: Banco de dados categ\u00f3rico, \u00e2ngulos de rota\u00e7\u00e3o e raz\u00f5es de anisotropia\nOutput: Propriedades signed distances RTX\n\n1 Cria a matriz de rota\u00e7\u00e3o - dilata\u00e7\u00e3o/compress\u00e3o;\n2 Transforma os dados originais x,y,z em x??,y??,z?? com a matriz criada;\n3 Codifica as amostras, para cada dom\u00ednio k, em ik(u?);\n4 for litologias do\n5 for amostras do\n6 Calcula a dist\u00e2ncia entre cada amostra e todas as demais que pertencem a\n\num dom\u00ednio oposto;\n7 Ret\u00e9m a dist\u00e2ncia m\u00ednima para cada amostra em uma lista;\n8 Assinala de acordo com o indicador\n9 end\n\n10 Cria uma uma propriedade para cada litologia, referente a lista de menores\ndist\u00e2ncias criada em cada amostra (signed distances RTX)\n\n11 end\n\n3.4.2 Interpolator\n\nO plugin interpolator apresenta tr\u00eas abas: general, variogram e options. Na primeira\naba (Figura 26), o usu\u00e1rio deve imputar em (i) a propriedade categ\u00f3rica, nesse caso, para\nque os blocos que coincidem com amostras sejam carimbados com a respectiva litologia. Em\n\n\n\n56 Cap\u00edtulo 3. Modelagem geol\u00f3gica impl\u00edcita com fun\u00e7\u00f5es dist\u00e2ncia assinaladas\n\n(ii), o grid no qual as dist\u00e2ncias ser\u00e3o interpoladas. Em (iii), o usu\u00e1rio deve imputar todas\nas dist\u00e2ncia signed distances RTX calculadas com o plugin signed distances (subse\u00e7\u00e3o 3.4.1).\nEm (iv), a estrat\u00e9gia de busca da krigagem origin\u00e1ria deve ser informada, n\u00famero m\u00e1ximo\ne m\u00ednimo de dados condicionantes e elipsoide de busca.\n\nFigura 26 \u2013 Vis\u00e3o da aba general do plugin interpolator.\n\nNa segunda aba (Figura 27), os modelos variogr\u00e1ficos referentes a cada uma das\npropriedades signed distances RTX, devem ser informados, na mesma ordem em que foram\nescolhidos na aba anterior (Figura 26 - (iii)).\n\n\n\n3.4. O Plug-in 57\n\nFigura 27 \u2013 Vis\u00e3o da aba variogram do plugin interpolator.\n\nNa terceira e \u00faltima aba (Figura 28), o usu\u00e1rio escolhe se o modelo ser\u00e1 p\u00f3s\nprocessado. Em (vi), a op\u00e7\u00e3o softmax transformation deve ser marcada, assim como o\npar\u00e2metro ? informado, em (vii), a op\u00e7\u00e3o servo system deve ser marcada, o par\u00e2metro ?\ninformado e a propriedade para a qual se deseja reproduzir as propor\u00e7\u00f5es imputada. A\nsele\u00e7\u00e3o do servo system est\u00e1 condicionada \u00e0 sele\u00e7\u00e3o da softmax transformation.\n\nFigura 28 \u2013 Vis\u00e3o da aba options do plugin interpolator.\n\nComo output, o plugin gera, caso nenhuma op\u00e7\u00e3o da aba options tenha sido\nselecionada, uma propriedade com o nome geo_model. Esse \u00e9 o modelo geol\u00f3gico baseado\nna menor dist\u00e2ncia estimada para cada bloco. Ao marcar a op\u00e7\u00e3o softmax transformation,\numa propriedade Probability RTX \u00e9 criada, para cada litologia, onde X \u00e9 o algarismo que\nrepresenta aquela litologia. Caso a op\u00e7\u00e3o servo system seja selecionada, as propriedades\nGeologic_Model_Servo_System e Geologic_Model_Corrected s\u00e3o criadas. A primeira\n\n\n\n58 Cap\u00edtulo 3. Modelagem geol\u00f3gica impl\u00edcita com fun\u00e7\u00f5es dist\u00e2ncia assinaladas\n\nrepresenta o modelo criado a partir das probabilidades atualizadas e a segunda representa\nesse modelo suavizado (a corre\u00e7\u00e3o \u00e9 aplicada aqui uma \u00fanica vez).\n\nO quadro Algoritmo 2 abaixo mostra o funcionamento do algoritmo.\n\nAlgoritmo 2: Interpolator\nInput: Banco de dados categ\u00f3rico, propriedades signed distances RTX, estrat\u00e9gia de\n\nkrigagem, modelos variogr\u00e1ficos, propor\u00e7\u00e3o alvo e par\u00e2metros\nOutput: Propriedades geo_model, Probability RTX,\n\nGeologic_Model_Servo_System e Geologic_Model_Corrected\n1 for cada propriedade signed distances RTX do\n2 Chama a krigagem ordin\u00e1ria no SGeMS com os par\u00e2metros imputados pelo\n\nusu\u00e1rio e interpola as dist\u00e2ncias calculadas para cada n\u00f3 do grid informado;\n3 end\n4 for cada n\u00f3 do grid do\n5 Carimba no n\u00f3 a categoria referente \u00e0 menor dist\u00e2ncia estimada\n6 end\n7 Cria a propriedade geo_model, baseada na menor dist\u00e2ncia interpolada;\n8 if op\u00e7\u00e3o softmax transformation marcada then\n9 for cada propriedade interpolada do\n\n10 for cada n\u00f3 do grid do\n11 Tranforma cada dist\u00e2ncia interpolada em probabilidade daquele n\u00f3\n\npertencer a uma das litologias\n12 end\n13 Cria uma propriedade Probability RTX para cada litologia\n14 end\n15 end\n16 if op\u00e7\u00e3o servo system marcada then\n17 Gera caminho aleat\u00f3rio;\n18 for n\u00f3 do grid em caminho aleat\u00f3rio do\n19 Atualiza a propor\u00e7\u00e3o corrente marginal de cada categoria;\n20 for cada propriedade Probability RTX do\n21 Atualiza as probabilidades de cada n\u00f3 pertencer a cada uma das litologias\n\nde acordo com a diferen\u00e7a entre a propor\u00e7\u00e3o alvo e a propor\u00e7\u00e3o corrente\nmarginal\n\n22 end\n23 end\n24 Cria a propriedade Geologic_Model_Servo_System;\n25 Suaviza o modelo e cria a propriedade Geologic_Model_Corrected\n26 end\n27 Carimba nos blocos a categoria correspondente ao dado colocado\n\n3.5 Valida\u00e7\u00e3o\nOs plugins desenvolvidos foram validados tendo como refer\u00eancia resultados an\u00e1logos\n\nda rotina DFMod da biblioteca de algoritmos geoestat\u00edsticos GSLib. Foi utilizado um\n\n\n\n3.5. Valida\u00e7\u00e3o 59\n\nbanco de dados em tr\u00eas dimens\u00f5es que possui 3276 amostras de 5 categorias diferentes\npara a valida\u00e7\u00e3o do c\u00e1lculo da fun\u00e7\u00e3o dist\u00e2ncia e modelo gerado a partir das dist\u00e2ncias\nestimadas. Ainda foi utilizado o jura data set (GOOVAERTS, 1997) para valida\u00e7\u00e3o da\nsoftmax transformation e servo system.\n\nDist\u00e2ncias anisotr\u00f3picas foram calculadas com os par\u00e2metros da Tabela 1, escolhidos\nde forma arbitr\u00e1ria. E os resultados comparados.\n\nTabela 1 \u2013 \u00c2ngulos de rota\u00e7\u00e3o e propor\u00e7\u00f5es entre as dire\u00e7\u00f5es principais usadas no c\u00e1lculo\nda fun\u00e7\u00e3o dist\u00e2ncia anisotr\u00f3pica.\n\nRota\u00e7\u00f5es 30o 45o 60o\nPropor\u00e7\u00f5es 2 5 9\n\nA Figura 29 mostra os scatterplots entre as dist\u00e2ncias calculadas com o plugin\ndesenvolvido, no eixo y, contra as calculadas a partir da rotina DFMod do GSLib no eixo\nx, para todas as cinco categorias do banco de dados. A correla\u00e7\u00e3o \u00e9 perfeita (100%) para\ntodos os gr\u00e1ficos.\n\nFigura 29 \u2013 Scatterplot entre as dist\u00e2ncias calculadas pelo plugin desenvolvido contra\ndist\u00e2ncias calculadas a partir da rotina DFMod do GSLib.\n\nDois modelos foram gerados a partir dos par\u00e2metros do Ap\u00eandice A. E foram\n\n\n\n60 Cap\u00edtulo 3. Modelagem geol\u00f3gica impl\u00edcita com fun\u00e7\u00f5es dist\u00e2ncia assinaladas\n\ncomparados, novamente, em um scaterrplot categ\u00f3rico (Figura 30). O modelo gerado pelo\nplugin desenvolvido aparece no eixo y, e no eixo x, o modelo criado a partir da rotina\nDFMod do GSLib. 99,998% dos blocos s\u00e3o concordantes em ambos os modelos, blocos\nconcordantes caem sobre a linha x=y e blocos discordantes fora dela, existem apenas tr\u00eas\nblocos discordantes entre os modelos gerados. 100% de blocos concordantes n\u00e3o p\u00f4de ser\natingido devido a diferen\u00e7a entre os c\u00f3digos e linguagens de programa\u00e7\u00e3o, as rotinas do\nGSLib s\u00e3o escritas em fortran 90 enquanto o SGeMS e seus plugins, em C++ e python,\nrespectivamente.\n\nFigura 30 \u2013 Scatterplot entre os modelos criados pelo plugin desenvolvido e rotina DFMod\ndo GSLib.\n\nEm nenhuma das vers\u00f5es do DFMod encontradas nos rep\u00f3sit\u00f3rios do GSLib h\u00e1\nvers\u00f5es funcionais, tanto da softmax transformation quanto do servo system. Ent\u00e3o, como\nalternativa para valida\u00e7\u00e3o, a corre\u00e7\u00e3o servo system foi executada no banco de dados jura,\ncom um par\u00e2metro ? = 0, 99. Dessa forma, \u00e9 esperado que se, tanto o algoritmo da softmax\ntransformation quanto o algoritmo do servo system (que depende do \u00faltimo), estejam\ncorretos a propor\u00e7\u00e3o alvo seja reproduzida, ou pelo menos que um resultado bastante\npr\u00f3ximo seja obtido, j\u00e1 que n\u00e3o \u00e9 poss\u00edvel usar um fator ? = 1 (divis\u00e3o por zero), que\nacarretaria na m\u00e1xima corre\u00e7\u00e3o poss\u00edvel, isto \u00e9, histogramas id\u00eanticos.\n\nA Figura 31 mostra os histogramas do modelo baseado somente nas dist\u00e2ncias\n\n\n\n3.5. Valida\u00e7\u00e3o 61\n\nestimadas \u00e0 esquerda, dos dados ao centro (este foi utilizado como alvo para o servo\nsystem), e do modelo ap\u00f3s execu\u00e7\u00e3o do servo system \u00e0 direita. As propor\u00e7\u00f5es alvo foram\nquase reproduzidas com perfei\u00e7\u00e3o, a diferen\u00e7a entre as m\u00e9dias dos histogramas \u00e9 menor\nque 0,01.\n\nFigura 31 \u2013 Histogramas do modelo baseado somente nas dist\u00e2ncias estimadas \u00e0 esquerda,\ndos dados ao centro, e do modelo ap\u00f3s execu\u00e7\u00e3o do servo system \u00e0 direita.\n\n\n\n\n\n63\n\n4 Estudo de caso\n\nA metodologia desenvolvida no decorrer desse trabalho foi aplicada a um banco de\ndados real, proveniente de uma grande mineradora de ouro. Para verificar a compet\u00eancia\ndo m\u00e9todo, o modelo criado implicitamente pelo algoritmo proposto foi comparado com\num modelo criado por um geomodelador, atrav\u00e9s da digitaliza\u00e7\u00e3o manual de pol\u00edgonos\nem se\u00e7\u00f5es, e posterior constru\u00e7\u00e3o dos s\u00f3lidos que representam as unidades litol\u00f3gicas.\nAssim, foi poss\u00edvel avaliar se as estruturas geol\u00f3gicas interpretadas foram satisfatoriamente\nreproduzidas pelo algoritmo.\n\nO banco de dados categ\u00f3ricos fornecido abrange 9140 amostras, distribu\u00eddas entre\ncinco diferentes litologias. O dep\u00f3sito cobre uma \u00e1rea de aproximadamente 10km2 com\n1300m de profundidade. Maiores detalhes em rela\u00e7\u00e3o \u00e0 geologia e localiza\u00e7\u00e3o do dep\u00f3sito\nser\u00e3o omitidos por quest\u00f5es de confidencialidade.\n\nA Figura 32 evidencia as amostras em planta, \u00e0 esquerda, e em perfil, \u00e0 direita.\nEnquanto a Figura 33, mostra o histograma dos dados, que expressa as propor\u00e7\u00f5es de\ncada litologia nos dados amostrais.\n\nFigura 32 \u2013 Dados em planta \u00e0 esquerda e em perfil \u00e0 direita.\n\nA partir das amostras, o valor da fun\u00e7\u00e3o dist\u00e2ncia assinalada foi calculado para\ncada litologia, em cada ponto amostral. O dep\u00f3sito n\u00e3o apresenta morfologia que justifique\no c\u00e1lculo de dist\u00e2ncias anisotr\u00f3picas, ent\u00e3o, o caso isotr\u00f3pico foi escolhido.\n\nA Figura 34 mostra as dist\u00e2ncias assinaladas calculadas para cada uma das cinco\nlitologias, a transi\u00e7\u00e3o suave entre as cores denota o comportamento extremamente cont\u00ednuo\ndas dist\u00e2ncias assinaladas.\n\n\n\n64 Cap\u00edtulo 4. Estudo de caso\n\nFigura 33 \u2013 Histograma dos dados.\n\nFigura 34 \u2013 Dist\u00e2ncias assinaladas calculadas para cada uma das litologias.\n\n\n\n4.1. Variografia 65\n\n4.1 Variografia\nAs dist\u00e2ncias assinaladas apresentam, al\u00e9m do comportamento extremamente con-\n\nt\u00ednuo observado na Figura 34, um comportamento n\u00e3o estacion\u00e1rio. Isto \u00e9, seu variograma\nexperimental n\u00e3o se estabiliza em um patamar. Essa caracter\u00edstica torna a infer\u00eancia do\nalcance arbitr\u00e1ria, como observado na Figura 37.\n\nO alcance do variograma, juntamente com a anisotropia, controlam a extens\u00e3o e\nforma dos dom\u00ednios modelados. Na Figura 35, a litologia 1 foi modelada a partir de tr\u00eas\nvalores diferentes de alcance de um variograma isotr\u00f3pico, mantido o mesmo patamar:\n150m \u00e0 esquerda, 1500m no centro, e 15000m \u00e0 direita. O variograma das demais litologias\nn\u00e3o foi alterado.\n\nAo aumentar o alcance do variograma de um dos dom\u00ednios modelados, a estrutura\nassociada \u00e0 esse dom\u00ednio ganha um corpo mais volumoso, crescendo na dire\u00e7\u00e3o de maior\ncontinuidade do variograma, e consequentemente sua propor\u00e7\u00e3o no dep\u00f3sito aumenta,\ncomo observado na an\u00e1lise da litologia 1 da Figura 35. A diferen\u00e7a entre as propor\u00e7\u00f5es\nn\u00e3o \u00e9 muito pronunciada j\u00e1 que a densidade amostral do banco de dados \u00e9 muito alta. Em\nan\u00e1lise semelhante, Silva (2015) obteve resultados an\u00e1logos.\n\nA infer\u00eancia do alcance dos variogramas pode se tornar arbitr\u00e1ria devido ao\ncomportamento n\u00e3o estacion\u00e1rio das dist\u00e2ncias assinaladas. Uma alternativa consiste em\nfixar a vari\u00e2ncia dos variogramas na vari\u00e2ncia a priori dos dados, e ajustar um modelo ao\nvariograma experimental dessa forma. Uma outra alternativa \u00e9 inferir o alcance a partir\ndas dimens\u00f5es das estruturas observadas nos dados amostrais.\n\nFigura 35 \u2013 Litologia 1, e respectiva propor\u00e7\u00e3o, modelada variando o range do variograma:\n150m \u00e0 esquerda, 1500m ao centro e 15000m \u00e0 direita.\n\nOs variogramas experimentais das dist\u00e2ncias assinaladas nunca exibem efeito\npepita. Por\u00e9m, este pode ser adicionado arbitrariamente pelo usu\u00e1rio para controlar a\ninterconectividade dos dom\u00ednios. A Figura 36 mostra quatro modelos gerados a partir de\nvariogramas isotr\u00f3picos com o mesmo alcance para todas as litologias e seus respectivos\nhistogramas. Apenas a propor\u00e7\u00e3o entre a contribui\u00e7\u00e3o do efeito pepita e a contribui\u00e7\u00e3o\n\n\n\n66 Cap\u00edtulo 4. Estudo de caso\n\ntotal do variograma foi alterada, da mesma maneira, para todas as litologias.\n\nNa Figura 36, da esquerda para a direita, n\u00e3o h\u00e1 efeito pepita algum na primeira\nimagem, 10% de efeito pepita na segunda imagem, 50% e 90% de efeito pepita nas imagens\nseguintes.\n\nFigura 36 \u2013 Modelos calculados a partir de variogramas com diferentes propor\u00e7\u00f5es de\nefeito pepita. Da direita para a esquerda: 0%, 10%, 50% e 90%.\n\nO efeito do aumento da contribui\u00e7\u00e3o do efeito pepita para a vari\u00e2ncia total \u00e9 mais\npronunciado na litologia 1, \u00e9 poss\u00edvel observar que a medida que a contribui\u00e7\u00e3o aumenta o\ndom\u00ednio representado pela litologia 1 se torna mais desconexo. Na \u00faltima imagem (90%\nde efeito pepita), pode-se observar dois \"bra\u00e7os\"que s\u00e3o interligados quando o modelo \u00e9\ngerado com propor\u00e7\u00f5es menores de efeito pepita nos variogramas. Os histogramas pouco\nse alteram, novamente, devido \u00e0 alta densidade amostral do banco de dados.\n\nPosto isso, os variogramas experimentais das dist\u00e2ncias assinaladas referentes\n\u00e0s cinco litologias do dep\u00f3sito foram calculados, a partir dos par\u00e2metros da Tabela 2, e\nmodelados. Os variogramas n\u00e3o apresentaram nenhuma dire\u00e7\u00e3o preferencial de continuidade.\nA Figura 37 mostra os variogramas experimentais isotr\u00f3picos para todas as cinco dist\u00e2ncias\nassinaladas e seu respectivo modelo ajustado (Equa\u00e7\u00e3o 4.1 a Equa\u00e7\u00e3o 4.5).\n\nTabela 2 \u2013 Par\u00e2metros para o c\u00e1lculo da variograma experimental.\nno de lags sep. lag (m) tol. lag (m) larg. de banda (m)\n\n20 100 50 50\n\nO comportamento cont\u00ednuo das dist\u00e2ncias faz com que o modelo gaussiano seja\no que melhor se ajusta aos pontos do variograma experimental, geralmente, apenas uma\nestrutura \u00e9 suficiente para um bom ajuste. O efeito pepita foi adicionado arbitrariamente\npara controlar a interconex\u00e3o entre as litologias.\n\n\n\n4.1. Variografia 67\n\nFigura 37 \u2013 Variograma das dist\u00e2ncias assinaladas calculadas para cada uma das litologias.\n\n?SD1(h) = 9000 + 80000gauss\n(\n\nh\n\n1500m\n\n)\n(4.1)\n\n?SD2(h) = 12000 + 108000gauss\n(\n\nh\n\n1500m\n\n)\n(4.2)\n\n?SD3(h) = 10000 + 90000gauss\n(\n\nh\n\n1500m\n\n)\n(4.3)\n\n?SD4(h) = 8000 + 72000gauss\n(\n\nh\n\n1500m\n\n)\n(4.4)\n\n\n\n68 Cap\u00edtulo 4. Estudo de caso\n\n?SD5(h) = 6800 + 61200gauss\n(\n\nh\n\n1500m\n\n)\n(4.5)\n\nO valor absoluto da vari\u00e2ncia dos variogramas n\u00e3o tem influ\u00eancia alguma no\nresultado da krigagem ordin\u00e1ria, somente na vari\u00e2ncia de krigagem, que n\u00e3o \u00e9 usada para\ncriar os modelos gerados implicitamente pelo m\u00e9todo das dist\u00e2ncias assinaladas. Apenas\na propor\u00e7\u00e3o das contribui\u00e7\u00f5es das estruturas para a vari\u00e2ncia total modifica o resultado\nda krigagem. Como os modelos ajustados aos variogramas experimentais da Figura 37\napresentam, todos eles, propor\u00e7\u00e3o de 10% efeito pepita e 90% de contribui\u00e7\u00e3o da estrutura\ngaussiana, al\u00e9m do mesmo range, foi poss\u00edvel o uso do mesmo modelo variogr\u00e1fico da\nEqua\u00e7\u00e3o 4.6 para todas as litologias.\n\n?SD(h) = 0, 1 + 0, 9gauss\n(\n\nh\n\n1500m\n\n)\n(4.6)\n\n4.2 Interpola\u00e7\u00e3o\nAs dist\u00e2ncias calculadas e posteriormente variografadas, foram interpoladas no\n\nmesmo grid do modelo de refer\u00eancia fornecido. As propriedades do grid s\u00e3o mostradas na\nTabela 3. Uma m\u00e1scara (region) correspondente \u00e0 topografia foi aplicada \u00e0 esse grid.\n\nTabela 3 \u2013 Propriedades do grid.\nN\u00famero de blocos Dimens\u00e3o dos blocos (m)\n\nNum. X Num. Y Num. Z Dim. X Dim. Y Dim. Z\n70 60 57 50 50 25\n\nAs dist\u00e2ncias foram interpoladas por krigagem ordin\u00e1ria em todos os n\u00f3s do grid,\ncom a estrat\u00e9gia de krigagem da Tabela 4.\n\nTabela 4 \u2013 Par\u00e2metros de krigagem ordin\u00e1ria.\nVizinhan\u00e7a de busca (m) N\u00famero de amostras\n\nRaio (X) Raio (Y) Raio (Z) Min. amostras Max. amostras\nLitologias (1-5) 3000 3000 3000 4 40\n\nA Figura 38 mostra, \u00e0 esquerda, um scatterplot categ\u00f3rico entre um modelo criado\nutilizando no m\u00e1ximo 40 amostras por estimativa, no eixo x, e no eixo y, um modelo\ncriado usando no m\u00e1ximo 100 amostras por estimativa. E \u00e0 direita, um outro scatterplot,\no mesmo modelo criado utilizando no m\u00e1ximo 40 amostras, no eixo x, e no eixo y, um\nmodelo criado usando no m\u00e1ximo 200 amostras por estimativa. Todas as estrat\u00e9gias de\nkrigagem utilizadas apresentam alcance de busca suficientemente grande para abranger o\nn\u00famero m\u00e1ximo de amostras.\n\n\n\n4.3. Resultados 69\n\nFigura 38 \u2013 Scatterplots entre modelos gerados com diferentes estrat\u00e9gias de krigagem.\n\nO modelo criado com 40 amostras e o modelo criado com 100 amostras apresentam\n98,4% dos blocos concordantes e o modelo criado com 40 amostras e 200 amostras 97,9%\ndos blocos concordantes. No primeiro caso, a semelhan\u00e7a entre os modelos \u00e9 suficientemente\nalta para justificar o uso de no m\u00e1ximo 40 amostras, tendo em vista que o tempo de\nexecu\u00e7\u00e3o do algoritmo passa de poucos minutos para algumas horas. No segundo caso, a\ndiferen\u00e7a no n\u00famero de blocos concordantes, para o primeiro caso, \u00e9 extremamente baixa,\ne a diferen\u00e7a no tempo de execu\u00e7\u00e3o significativa. O uso de mais do que 200 amostras por\nestimativa torna a aplica\u00e7\u00e3o do m\u00e9todo, utilizando os plug-ins em python desenvolvidos,\ninvi\u00e1vel. Isso se deve \u00e0 uma limita\u00e7\u00e3o da pr\u00f3pria linguagem de programa\u00e7\u00e3o que trabalha\napenas com um n\u00facleo do processador por vez.\n\n4.3 Resultados\n\nUm modelo baseado na menor dist\u00e2ncia interpolada em cada bloco foi gerado\npelo plug-in, e \u00e9 mostrado, em perspectiva, lado a lado com o modelo criado por um\ngeomodelador na Figura 39. O modelo criado implicitamente pelo algoritmo \u00e0 direita e o\nmodelo criado, explicitamente, pelo geomodelador \u00e0 esquerda. Cada litologia modelada foi\ncolocada lado a lado separadamente para fins de compara\u00e7\u00e3o.\n\n\n\n70 Cap\u00edtulo 4. Estudo de caso\n\nFigura 39 \u2013 Compara\u00e7\u00e3o entre os modelos criados: modelo expl\u00edcito \u00e0 esquerda e modelo\nimpl\u00edcito \u00e0 direita.\n\n\n\n4.3. Resultados 71\n\nA Figura 40 mostra o scatterplot categ\u00f3rico entre os dois modelos criados: impl\u00edcito\nno eixo y, e expl\u00edcito no eixo x. Ao lado de cada ponto h\u00e1 o n\u00famero de blocos comparados.\nPontos que caem sobre a linha 45o s\u00e3o blocos concordantes em ambos os modelos, e pontos\nque caem fora dessa linha, blocos discordantes.\n\n95% dos blocos s\u00e3o concordantes em ambos os modelos. Todavia, apenas uma alta\npropor\u00e7\u00e3o de blocos concordantes n\u00e3o \u00e9 indicativo de um bom modelo. M\u00e9todos menos\nsofisticados atingem alta propor\u00e7\u00e3o, 93% no caso do vizinho mais pr\u00f3ximo.\n\nFigura 40 \u2013 Scatterplot entre os modelos expl\u00edcitos e impl\u00edcitos.\n\nPor\u00e9m, geram modelos que n\u00e3o fazem sentido f\u00edsico do ponto de vista geol\u00f3gico,\ncomo observado na Figura 41, um modelo gerado pela t\u00e9cnica do vizinho mais pr\u00f3ximo a\npartir do mesmo banco de dados, s\u00e3o not\u00e1veis estruturas em forma de escada com mudan\u00e7a\nabrupta de angula\u00e7\u00e3o, diferentemente das formas suaves criadas pelo algoritmo proposto\nvistos na Figura 39.\n\n\n\n72 Cap\u00edtulo 4. Estudo de caso\n\nFigura 41 \u2013 Modelo criado utilizando a t\u00e9cnica do vizinho mais pr\u00f3ximo.\n\nA incerteza tamb\u00e9m foi calculada como a probabilidade de cada de cada bloco\npertencer a cada uma das categorias pela softmax transformation. O par\u00e2metro ? = 175,\nvalor padr\u00e3o do plug-in, foi escolhido. O resultado \u00e9 mostrado nas se\u00e7\u00f5es verticais da\nsubse\u00e7\u00e3o 4.3.1.\n\n4.3.1 Compara\u00e7\u00e3o\n\nUma compara\u00e7\u00e3o inicial pode ser feita observando os modelos, impl\u00edcito e expl\u00edcito,\nlado a lado na Figura 39. A litologia 5 aparece como blocos isolados e dispersos no modelo\nimpl\u00edcito, enquanto que no modelo expl\u00edcito apresenta forma mais estruturada e cont\u00ednua.\nExaminando a Figura 32, percebe-se algumas amostras de litologia 5 espalhadas, em meio\n\u00e0 abundantes amostras de outras litologias. O m\u00e9todo das dist\u00e2ncias assinaladas n\u00e3o\natribuir\u00e1 aos blocos ao redor de amostras dispersas, sua litologia, j\u00e1 que a menor dist\u00e2ncia\nestimada para esses blocos ser\u00e1 referente \u00e0 categoria das amostras abundantes e agrupadas.\n\nOs blocos isolados pertencentes \u00e0 litologia 5 que aparecem no modelo impl\u00edcito s\u00e3o\nblocos carimbados, ap\u00f3s a gera\u00e7\u00e3o do modelo baseado nas dist\u00e2ncias, com a litologia da\namostra colocada, como visto no quadro Algoritmo 2 da subse\u00e7\u00e3o 3.4.2. O geomodelador\naumentou a influ\u00eancia das amostras de litologia 5 no modelo expl\u00edcito arbitrariamente ou\nmunido de informa\u00e7\u00e3o adicional, que n\u00e3o pode ser imputada no algoritmo proposto.\n\nPara checar se o algoritmo reproduziu satisfatoriamente as estruturas interpretadas\npelo geomodelador, se\u00e7\u00f5es verticais ao longo das dire\u00e7\u00f5es x e y foram comparadas. Quatro\nse\u00e7\u00f5es espalhadas por toda extens\u00e3o do modelo foram escolhidas em cada dire\u00e7\u00e3o.\n\n\n\n4.3. Resultados 73\n\nEm x, o modelo apresenta 70 se\u00e7\u00f5es, a Figura 42 mostra a se\u00e7\u00e3o 10/70. \u00c0 esquerda\no modelo criado pelo geomodelador, ao centro o modelo criado pelo algoritmo proposto,\n\u00e0 direita blocos discordantes e concordantes e abaixo as probabilidades de cada bloco\npertencer a cada uma das cinco categorias. Todas as se\u00e7\u00f5es analisadas seguem a mesma\ndiagrama\u00e7\u00e3o.\n\nEstruturas geol\u00f3gicas que foram reproduzidas satisfatoriamente pelo algoritmo\nforam destacadas por elipses verdes, enquanto estruturas que n\u00e3o foram bem reproduzidas,\ndestacadas por elipses vermelhas.\n\nNa regi\u00e3o destacada pela elipse vermelha da Figura 42, n\u00e3o h\u00e1 amostras da litologia\n1. Provavelmente, o geomodelador munido de sua experi\u00eancia e/ou informa\u00e7\u00e3o adicional\natribuiu a litologia 1 aos blocos dessa regi\u00e3o. Note que alguns blocos na superf\u00edcie do\nmodelo impl\u00edcito n\u00e3o foram carimbados com a litologia 5 como no modelo expl\u00edcito. Por\u00e9m,\nao analisar a probabilidade RT5, existe uma chance consider\u00e1vel desses blocos pertencerem\n\u00e0 litologia 5. mesmo que n\u00e3o tenham sido atribu\u00eddos \u00e0queles blocos.\n\nFigura 42 \u2013 Se\u00e7\u00e3o vertical 10/70 em x.\n\nNa se\u00e7\u00e3o da Figura 43, a regi\u00e3o destacada pela elipse vermelha mostra uma estrutura\ndesenhada pelo geomodelador no modelo expl\u00edcito, com formas suaves e intricadas, de dif\u00edcil\nreprodu\u00e7\u00e3o pelos m\u00e9todos matem\u00e1ticos, a n\u00e3o ser em casos de alta densidade amostral.\n\n\n\n74 Cap\u00edtulo 4. Estudo de caso\n\nFigura 43 \u2013 Se\u00e7\u00e3o vertical 37/70 em x.\n\nAs estruturas presentes na se\u00e7\u00e3o 56 (Figura 44), s\u00e3o estruturas pouco complexas, e\nforam bem reproduzidas pelo algoritmo.\n\nFigura 44 \u2013 Se\u00e7\u00e3o vertical 56/70 em x.\n\nA se\u00e7\u00e3o da Figura 45, mostra destacado pela elipse vermelha, uma estrutura que\nn\u00e3o foi bem reproduzida, o algoritmo deu mais volume \u00e0 litogia 1 e menos \u00e0 litologia 2 em\nrela\u00e7\u00e3o ao modelo criado explicitamente.\n\n\n\n4.3. Resultados 75\n\nFigura 45 \u2013 Se\u00e7\u00e3o vertical 67/70 em x.\n\nNa dire\u00e7\u00e3o y, o modelo apresenta 60 se\u00e7\u00f5es. A se\u00e7\u00e3o 16 (Figura 46) exibe poucos\nblocos discordantes, o algoritmo reproduziu satisfatoriamente as estruturas interpretadas\npelo geomodelador.\n\nFigura 46 \u2013 Se\u00e7\u00e3o vertical 16/60 em y.\n\nEmbora as estruturas interpretadas exibidas na Figura 47 sejam bastante complexas,\no algoritmo as reproduziu de forma razo\u00e1vel.\n\n\n\n76 Cap\u00edtulo 4. Estudo de caso\n\nFigura 47 \u2013 Se\u00e7\u00e3o vertical 27/60 em y.\n\nNovamente, o m\u00e9todo impl\u00edcito reproduziu de forma satisfat\u00f3ria as estruturas\ninterpretadas na Figura 48.\n\nFigura 48 \u2013 Se\u00e7\u00e3o vertical 43/60 em y.\n\nA se\u00e7\u00e3o da Figura 49 mostra, na zona destacada em vermelho, blocos atribu\u00eddos\ncom a litologia 1 pelo geomodelador enquanto no modelo impl\u00edcito esses blocos s\u00e3o\natribu\u00eddos com a litologia 3. Novamente, essa \u00e9 uma regi\u00e3o sem amostras de litologia 1, o\n\n\n\n4.4. Discuss\u00e3o 77\n\ngeomodelador, provavelmente, contou com sua experi\u00eancia ou informa\u00e7\u00e3o adicional para\ninferir a litologia desses blocos.\n\nFigura 49 \u2013 Se\u00e7\u00e3o vertical 54/60 em y.\n\nNesse estudo de caso, a aplica\u00e7\u00e3o do servo system torna o modelo mais discordante\nem rela\u00e7\u00e3o ao modelo de refer\u00eancia fornecido para compara\u00e7\u00e3o. Embora, as propor\u00e7\u00f5es\ndos dados ou dados desagrupados possam ser reproduzidas.\n\n4.4 Discuss\u00e3o\nA informa\u00e7\u00e3o geol\u00f3gica \u00e9 incorporada ao modelo atrav\u00e9s, n\u00e3o s\u00f3 do c\u00e1lculo das\n\ndist\u00e2ncias assinaladas anisotr\u00f3picas, como tamb\u00e9m pelas dire\u00e7\u00f5es de continuidade e efeito\npepita dos variogramas. Limites suaves entre as litologias s\u00e3o garantidos pelo emprego da\nkrigagem ordin\u00e1ria. Embora a complexidade geol\u00f3gica de pequena escala n\u00e3o seja bem\nreproduzida, devido ao efeito de suaviza\u00e7\u00e3o da krigagem, as grandes estruturas s\u00e3o bem\nrepresentadas pelo algoritmo. A aplica\u00e7\u00e3o de um elipsoide de busca grande o suficiente\ne dados condicionantes em grandes quantidades aproximam os resultados da krigagem\nordin\u00e1ria \u00e0 krigagem global, evitando o surgimento de artefatos nos modelados gerados. O\nm\u00e9todo implementado para m\u00faltiplos dom\u00ednios geol\u00f3gicos evita sobreposi\u00e7\u00e3o de litologias\nou a necessidade de estabelecer qualquer tipo de ordem de prioridade para sua modelagem.\n\n\u00c0 primeira vista a modelagem dos variogramas para todas as categorias parece uma\ntarefa laboriosa e tediosa. Todavia, O comportamento cont\u00ednuo das dist\u00e2ncias assinaladas\nos torna f\u00e1ceis de modelar, e em muitos casos s\u00e3o semelhantes entre si, permitindo o uso\nde um mesmo modelo para todas as litologias.\n\n\n\n78 Cap\u00edtulo 4. Estudo de caso\n\nAlgoritmos de modelagem geol\u00f3gica impl\u00edcita devem satisfazer seis crit\u00e9rios estabe-\nlecidos por McLennan (2007): simplicidade, velocidade, objetividade, integra\u00e7\u00e3o de dados,\navalia\u00e7\u00e3o de incertezas e realismo geol\u00f3gico. O m\u00e9todo proposto foi avaliado \u00e0 luz desses\ncrit\u00e9rios, a partir de observa\u00e7\u00f5es feitas ao longo desse trabalho e do trabalho de Silva\n(2015). Pontos positivos e negativos s\u00e3o aqui apresentados.\n\n\u2022 Simplicidade: O algoritmo \u00e9 de simples implementa\u00e7\u00e3o e n\u00e3o envolve nenhuma\nequa\u00e7\u00e3o matem\u00e1tica complicada. A ideia de uma dist\u00e2ncia assinalada para cada\ndom\u00ednio \u00e9 de f\u00e1cil compreens\u00e3o;\n\n\u2022 Velocidade: O algoritmo \u00e9 baseado em krigagem, que s\u00e3o m\u00e9todos notadamente\nr\u00e1pidos. A limita\u00e7\u00e3o \u00e9 quanto ao n\u00famero m\u00e1ximo de dados condicionantes usados\nna vizinhan\u00e7a de busca ao estimar cada bloco (acima de 200 tornam a execu\u00e7\u00e3o\nbastante demorada);\n\n\u2022 Objetividade: A abordagem impl\u00edcita surgiu para eliminar a subjetividade dos\nm\u00e9todos expl\u00edcitos de modelagem. \u00c9 esperado que modelos sejam reproduzidos com\nexatid\u00e3o quando os par\u00e2metros envolvidos nos c\u00e1lculos sejam os mesmos. Os modelos\nn\u00e3o est\u00e3o sujeitos \u00e0 influ\u00eancia individual de cada geomodelador;\n\n\u2022 Integra\u00e7\u00e3o de dados: O algoritmo \u00e9 flex\u00edvel quanto \u00e0 incorpora\u00e7\u00e3o de novos dados\ndo mesmo tipo. Entretanto, informa\u00e7\u00e3o secund\u00e1ria (de outro tipo) n\u00e3o pode ser\nadicionada;\n\n\u2022 Avalia\u00e7\u00e3o de incerteza: O algoritmo n\u00e3o avalia incerteza baseado em m\u00faltiplas\nrealiza\u00e7\u00f5es equiprov\u00e1veis de modelos geol\u00f3gicos. Contudo, uma forma alternativa de\nmedi\u00e7\u00e3o heur\u00edstica da incerteza, baseada na transforma\u00e7\u00e3o das dist\u00e2ncias estimadas\nem probabilidades, \u00e9 implementada no m\u00e9todo.\n\n\u2022 Realismo geol\u00f3gico: Modelos s\u00e3o considerados real\u00edsticos quando possuem concor-\nd\u00e2ncia com a interpreta\u00e7\u00e3o, e evidencias geol\u00f3gicas coletadas pelo geomodelador\n(SILVA, 2015). A compara\u00e7\u00e3o da subse\u00e7\u00e3o 4.3.1, mostra que o algoritmo reproduz\nsatisfatoriamente, dadas suas limita\u00e7\u00f5es, as estruturas interpretadas. A krigagem\nordin\u00e1ria, base do algoritmo, possui efeito de suaviza\u00e7\u00e3o. Ent\u00e3o, embora estruturas\nde larga escala sejam bem reproduzidas, a reprodu\u00e7\u00e3o da complexidade geol\u00f3gica de\npequena escala fica comprometida.\n\nUm geomodelador experiente dificilmente ser\u00e1 substitu\u00eddo por um c\u00f3digo e um\ncomputador. Por\u00e9m, o algoritmo proposto \u00e9 de grande ajuda, como m\u00e9todo complementar\n\u00e0 modelagem expl\u00edcita. Principalmente, em fases iniciais do projeto ou na cria\u00e7\u00e3o de proto\nmodelos que devem ser refinados, poupando tempo e trabalho. \u00c0 medida que a densidade\namostral aumenta, o modelo impl\u00edcito se torna mais pr\u00f3ximo do modelo expl\u00edcito.\n\n\n\n4.4. Discuss\u00e3o 79\n\nPor fim, as vantagens e desvantagens da metodologia apresentada s\u00e3o discutidas.\n\nVantagens:\n\n\u2022 Os modelos podem ser atualizados com facilidade e rapidez conforme novos dados\ns\u00e3o obtidos. N\u00e3o h\u00e1 necessidade de nova digitaliza\u00e7\u00e3o manual;\n\n\u2022 Usando os mesmos par\u00e2metros, os modelos s\u00e3o reproduzidos com exatid\u00e3o, tornando\na checagem e auditoria externa simples;\n\n\u2022 Uma variedade de an\u00e1lises de sensibilidade pode ser aplicadas ao modelo, variando\npar\u00e2metros envolvidos na interpola\u00e7\u00e3o e nos variogramas das dist\u00e2ncias assinaladas;\n\n\u2022 O processo \u00e9 r\u00e1pido, poupando tempo e trabalho de geomodeladores na tediosa\ntarefa de construir e digitalizar manualmente se\u00e7\u00f5es verticais e horizontais.\n\nDesvantagens:\n\n\u2022 A interpola\u00e7\u00e3o das dist\u00e2ncias assinaladas pode impedir que um profissional treinado\ninterprete estruturas e tend\u00eancias da geologia que possam levar a melhores resultados;\n\n\u2022 O algoritmo \u00e9 baseado em krigagem, ent\u00e3o, apenas rela\u00e7\u00f5es lineares entre dom\u00ednios\ns\u00e3o modeladas (caso n\u00e3o existam amostras suficientes). A modelagem de estruturas\ncomplexas e curvil\u00edneas depende de outros m\u00e9todos geoestat\u00edsticos. Al\u00e9m disso,\na propriedade suavizadora da krigagem compromete a modelagem da geologia de\npequena escala;\n\n\u2022 O comportamento n\u00e3o estacion\u00e1rio das dist\u00e2ncias assinaladas torna a infer\u00eancia do\nalcance dos variogramas arbitr\u00e1ria e question\u00e1vel;\n\n\u2022 N\u00e3o avalia incerteza baseado em m\u00faltiplas realiza\u00e7\u00f5es equiprov\u00e1veis do modelo;\n\n\u2022 O efeito de borda pode criar estruturas irreais nos limites do modelo.\n\n\n\n\n\n81\n\n5 Considera\u00e7\u00f5es finais\n\nEssa disserta\u00e7\u00e3o prop\u00f4s como meta investigar a aplicabilidade da modelagem\ngeol\u00f3gica impl\u00edcita com fun\u00e7\u00f5es dist\u00e2ncia assinaladas como m\u00e9todo substituto ou auxiliar\naos m\u00e9todos cl\u00e1ssicos de modelagem. Para tanto, foram apresentados dois objetivos\nespec\u00edficos:\n\n1. Operacionalizar o m\u00e9todo no software geoestat\u00edstico de c\u00f3digo aberto SGeMS,\ndesenvolvendo um plug-in funcional em python.\n\n2. Conduzir um estudo de caso em um banco de dados real e verificar a qualidade do\nmodelo gerado pela metodologia proposta, comparando-o a um modelo de refer\u00eancia.\n\nQuanto ao primeiro objetivo, um plug-in foi desenvolvido e validado. \u00c9 intuitivo\ne de f\u00e1cil utiliza\u00e7\u00e3o. Uma alternativa mais amig\u00e1vel ao usu\u00e1rio em rela\u00e7\u00e3o \u00e0 rotina do\nGSLib desenvolvida por Silva (2015).\n\nA partir do estudo de caso (Cap\u00edtulo 4) foi poss\u00edvel concluir que a modelagem\ngeol\u00f3gica impl\u00edcita com fun\u00e7\u00f5es dist\u00e2ncia assinaladas \u00e9 um m\u00e9todo simples, r\u00e1pido e de\ngrande aux\u00edlio ao geomodelador. Apesar de n\u00e3o substituir completamente os m\u00e9todos\nexpl\u00edcitos, o m\u00e9todo gerou um modelo geol\u00f3gico bastante semelhante ao modelo criado\nexplicitamente, tomado como refer\u00eancia, em poucos minutos e que pode ser facilmente\nreplicado, permitindo simples checagem e auditoria externa. Ainda \u00e9 poss\u00edvel avaliar,\nmesmo que de uma forma heur\u00edstica, a incerteza associada ao modelo geol\u00f3gico e reproduzir\npropor\u00e7\u00f5es, evitando a introdu\u00e7\u00e3o de vi\u00e9s.\n\nA modelagem geol\u00f3gica \u00e9 uma etapa fundamental da avalia\u00e7\u00e3o dep\u00f3sitos minerais\nj\u00e1 que as estimativas e simula\u00e7\u00f5es dependem de dom\u00ednios estacion\u00e1rios. Al\u00e9m disso,\num bom modelo geol\u00f3gico pode trazer maior rentabilidade ao empreendimento, ou at\u00e9\nmesmo ser crucial para a decis\u00e3o de investir ou n\u00e3o baseada nos resultados do relat\u00f3rio\nde viabilidade, uma vez que a maior causa de fracasso nos empreendimentos mineiros \u00e9 a\nfalta de conhecimento a respeito do corpo mineralizado.\n\n5.1 Recomenda\u00e7\u00f5es para trabalhos futuros\nComo recomenda\u00e7\u00e3o para trabalhos futuros:\n\n\u2022 Repetir o estudo de caso em banco de dados com menor densidade amostral e em\ndep\u00f3sitos que apresentem geologia mais complexa;\n\n\n\n82 Cap\u00edtulo 5. Considera\u00e7\u00f5es finais\n\n\u2022 Aprimorar o plug-in desenvolvido, se poss\u00edvel, reescrevendo-o em C++. Em especial\no algoritmo do servo system, que pode se tornar muito demorado em banco de dados\nvolumosos.\n\n\u2022 Investigar outras formas, al\u00e9m da softmax transformation, para medir incertezas\nnos contatos geol\u00f3gicos. McLennan e Deutsch (2006) propuseram uma metodologia\npara quantificar incertezas atrav\u00e9s da t\u00e9cnica de bootsrap, enquanto Munroe (2012),\nWilde e Deutsch (2011) propuseram calibrar uma banda de incertezas ao longo dos\ncontatos entre os dom\u00ednios;\n\n\u2022 Investigar a viabilidade de simular as dist\u00e2ncias assinaladas, avaliando assim, a\nincerteza baseada em m\u00faltiplas realiza\u00e7\u00f5es equiprov\u00e1veis do modelo geol\u00f3gico;\n\n\u2022 Estudar a possibilidade de agregar ao m\u00e9todo informa\u00e7\u00e3o secund\u00e1ria, usada pelo\ngeomodelador para construir modelos expl\u00edcitos;\n\n\u2022 Implementar o plug-in independentemente de um grid de interpola\u00e7\u00e3o, permitindo a\ncria\u00e7\u00e3o de modelos (wireframes) em qualquer resolu\u00e7\u00e3o;\n\n\u2022 Desenvolver t\u00e9cnicas h\u00edbridas de modelagem geol\u00f3gica, considerando as abordagens\nexpl\u00edcita, impl\u00edcita e estoc\u00e1stica.\n\n\n\n83\n\nRefer\u00eancias\n\nARMSTRONG, M. Basic linear geostatistics. [S.l.]: Springer Science &amp; Business Media,\n1998. Citado na p\u00e1gina 25.\n\nBLOOMENTHAL, J.; BAJAJ, C. Introduction to implicit surfaces. [S.l.]: Morgan\nKaufmann, 1997. Citado na p\u00e1gina 30.\n\nBRIDGE, J. S.; LEEDER, M. R. A simulation model of alluvial stratigraphy.\nSedimentology, Wiley Online Library, v. 26, n. 5, p. 617\u2013644, 1979. Citado na p\u00e1gina 21.\n\nCALCAGNO, P. et al. Geological modelling from field data and geological knowledge:\nPart i. modelling method coupling 3d potential-field interpolation and geological rules.\nPhysics of the Earth and Planetary Interiors, Elsevier, v. 171, n. 1, p. 147\u2013157, 2008.\nCitado 5 vezes nas p\u00e1ginas 21, 39, 40, 41 e 42.\n\nCHIL\u00e8S, J.-P. et al. Modelling the geometry of geological units and its uncertainty in\n3d from structural data: the potential-field method. In: Proceedings of International\nSymposium on Orebody Modelling and Strategic Mine Planning, Perth, Australia. [S.l.:\ns.n.], 2004. v. 22, p. 24. Citado 8 vezes nas p\u00e1ginas 20, 21, 38, 39, 40, 41, 42 e 43.\n\nCOWAN, E. et al. Rapid geological modelling. Applied Structural Geology for Mineral\nExploration and Mining, International Symposium, 2002. Citado 3 vezes nas p\u00e1ginas 21,\n33 e 38.\n\nCOWAN, E. et al. Practical implicit geological modelling. In: Fifth International Mining\nGeology Conference. [S.l.: s.n.], 2003. p. 17\u201319. Citado 3 vezes nas p\u00e1ginas 20, 21 e 33.\n\nDEUTSCH, C. V.; WILDE, B. J. Modeling multiple coal seams using signed distance\nfunctions and global kriging. International Journal of Coal Geology, n. 112, p. 87\u201393, 2013.\nCitado 4 vezes nas p\u00e1ginas 21, 22, 33 e 47.\n\nGALLI, A. et al. The pros and cons of the truncated gaussian method. In: Geostatistical\nsimulations. [S.l.]: Springer, 1994. p. 217\u2013233. Citado na p\u00e1gina 21.\n\nGALLI, A.; MURILLO, E.; THOMANN, J. Dual kriging-its properties and its uses\nin direct contouring. Geostatistics for Natural Resources Characterization, Part 2, p.\n621\u2013634, 1984. Citado na p\u00e1gina 34.\n\nGOOVAERTS, P. Geostatistics for natural resources evaluation. [S.l.]: Oxford University\nPress on Demand, 1997. Citado na p\u00e1gina 59.\n\nGUARDIANO, F. B.; SRIVASTAVA, R. M. Multivariate geostatistics: beyond bivariate\nmoments. In: Geostatistics Troia\u201992. [S.l.]: Springer, 1993. p. 133\u2013144. Citado na p\u00e1gina\n21.\n\nHUSTRULID, W. A.; KUCHTA, M.; MARTIN, R. K. Open Pit Mine Planning and\nDesign, Two Volume Set &amp; CD-ROM Pack. [S.l.]: CRC Press, 2013. Citado 2 vezes nas\np\u00e1ginas 19 e 20.\n\n\n\n84 Refer\u00eancias\n\nJOURNEL, A.; ISAAKS, E. Conditional indicator simulation: application to a\nsaskatchewan uranium deposit. Journal of the International Association for Mathematical\nGeology, Springer, v. 16, n. 7, p. 685\u2013718, 1984. Citado na p\u00e1gina 21.\n\nJOURNEL, A. G. Nonparametric estimation of spatial distributions. Journal of the\nInternational Association for Mathematical Geology, Springer, v. 15, n. 3, p. 445\u2013468,\n1983. Citado na p\u00e1gina 21.\n\nJOURNEL, A. G.; HUIJBREGTS, C. J. Mining geostatistics. [S.l.]: Academic press, 1978.\nCitado 3 vezes nas p\u00e1ginas 25, 26 e 27.\n\nJOYNT, P. Leapfrog\u2019s structural trend. 2014. Artigo publicado no blog leapfrog3d.\nDispon\u00edvel em:&lt;http://blog.leapfrog3d.com/2014/06/04/leapfrogs-structural-trend/>.\nAcesso em: 23-11-2016. Citado 3 vezes nas p\u00e1ginas 36, 37 e 38.\n\nLANE, R. Predictions at locations where there are no measurements. 2013. Artigo\npublicado no blog leapfrog3d. Dispon\u00edvel em:&lt;http://blog.leapfrog3d.com/2013/11/19/\nthe-connection-between-radial-basis-functions-rbfs-and-kriging/>. Acesso em: 23-11-2016.\nCitado 2 vezes nas p\u00e1ginas 34 e 35.\n\nLEAPFROG3D. Leapfrog\u2019s fast RBF. 2015. Artigo publicado no blog leapfrog3d.\nDispon\u00edvel em:&lt;http://blog.leapfrog3d.com/2015/07/28/leapfrogs-fast-rbf/>. Acesso em:\n23-11-2016. Citado na p\u00e1gina 35.\n\nLORENSEN, W. E.; CLINE, H. E. Marching cubes: A high resolution 3d surface\nconstruction algorithm. In: ACM. ACM siggraph computer graphics. [S.l.], 1987. v. 21,\nn. 4, p. 163\u2013169. Citado na p\u00e1gina 42.\n\nMALLET, J.-L. L. Geomodeling. [S.l.]: Oxford University Press, Inc., 2002. Citado na\np\u00e1gina 21.\n\nMATHERON, G. Les variables r\u00e9gionalis\u00e9es et leur estimation: une application de la\nth\u00e9orie des fonctions al\u00e9atoires aux sciences de la nature. [S.l.]: Masson et CIE, 1965.\nCitado na p\u00e1gina 25.\n\nMCCULLAGH, P.; NELDER, J. A. Generalized linear models. [S.l.]: Chapman and Hall,\n1989. Citado na p\u00e1gina 51.\n\nMCLENNAN, J. A. The decision of stationarity. Tese (Doutorado) \u2014 University of\nAlberta, 2007. Citado 4 vezes nas p\u00e1ginas 20, 29, 30 e 78.\n\nMCLENNAN, J. A.; DEUTSCH, C. V. Implicit boundary modeling (boundsim). CCG\nAnnual Report, 2006. Citado 4 vezes nas p\u00e1ginas 38, 42, 50 e 82.\n\nMCLENNAN, T. Interpolant function in leapfrog geo. 2013. Artigo publicado\nno blog leapfrog3d. Dispon\u00edvel em:&lt;http://blog.leapfrog3d.com/2013/07/26/\ninterpolant-functions-in-leapfrog-geo/>. Acesso em: 23-11-2016. Citado na p\u00e1gina 36.\n\nMUNROE, M. J. A methodology for calculating tonnage uncertainty in vein-type deposits.\nIn: Masters Abstracts International. [S.l.: s.n.], 2012. v. 51, n. 03. Citado 2 vezes nas\np\u00e1ginas 50 e 82.\n\nNEUFELD, C.; WILDE, B. A global kriging program for artifact-free maps. CCG Annual\nReport, v. 7, p. 403\u20131, 2005. Citado na p\u00e1gina 47.\n\nhttp://blog.leapfrog3d.com/2014/06/04/leapfrogs-structural-trend/\nhttp://blog.leapfrog3d.com/2013/11/19/the-connection-between-radial-basis-functions-rbfs-and-kriging/\nhttp://blog.leapfrog3d.com/2013/11/19/the-connection-between-radial-basis-functions-rbfs-and-kriging/\nhttp://blog.leapfrog3d.com/2015/07/28/leapfrogs-fast-rbf/\nhttp://blog.leapfrog3d.com/2013/07/26/interpolant-functions-in-leapfrog-geo/\nhttp://blog.leapfrog3d.com/2013/07/26/interpolant-functions-in-leapfrog-geo/\n\n\nRefer\u00eancias 85\n\nOSHER, S.; FEDKIW, R. Level set methods and dynamic implicit surfaces. [S.l.]:\nSpringer-Verlag New York, Inc., 2003. Citado 3 vezes nas p\u00e1ginas 30, 31 e 32.\n\nPYRCZ, M. J.; CATUNEANU, O.; DEUTSCH, C. V. Stochastic surface-based modeling\nof turbidite lobes. AAPG bulletin, American Association of Petroleum Geologists, v. 89,\nn. 2, p. 177\u2013191, 2005. Citado na p\u00e1gina 21.\n\nRASERA, L. G. Geoestat\u00edstica de m\u00faltiplos pontos aplicada \u00e0 simula\u00e7\u00e3o de modelos\ngeol\u00f3gicos em grids estratigr\u00e1ficos. Disserta\u00e7\u00e3o (Mestrado) \u2014 Universidade Federal do Rio\nGrande do Sul - PPGE3M, 2014. Citado 2 vezes nas p\u00e1ginas 20 e 30.\n\nRENARD, D. et al. Modeling the geometry of a mineral deposit domain with a potential\nfield. In: 36th APCOM. [S.l.: s.n.], 2013. p. Modeling\u2013the. Citado 5 vezes nas p\u00e1ginas 21,\n39, 40, 41 e 42.\n\nSAVCHENKO, V. V. et al. Function representation of solids reconstructed from scattered\nsurface points and contours. In: WILEY ONLINE LIBRARY. Computer Graphics Forum.\n[S.l.], 1995. v. 14, n. 4, p. 181\u2013188. Citado na p\u00e1gina 33.\n\nSILVA, D. Signed distance function modeling with multiple categories. 2015.\nArtigo publicado no site geostatisticslessons.com. Dispon\u00edvel em:&lt;http://www.\ngeostatisticslessons.com/lessons/signeddistancefunctions>. Acesso em: 28-12-2016.\nCitado na p\u00e1gina 50.\n\nSILVA, D.; DEUTSCH, C. Modeling multiple rock types with distance functions:\nmethodology and software. In: CCG Annual Report. [S.l.: s.n.], 2012. Citado 5 vezes nas\np\u00e1ginas 21, 45, 47, 48 e 50.\n\nSILVA, D.; DEUTSCH, C. Correcting distance function models to correct proportions. In:\nCCG Annual Report. [S.l.: s.n.], 2013. Citado na p\u00e1gina 21.\n\nSILVA, D. M. A. Enhanced geologic modeling with data-driven training images for\nimproved resources and recoverable reserves. Tese (Doutorado) \u2014 University of Alberta,\n2015. Citado 14 vezes nas p\u00e1ginas 21, 22, 30, 45, 46, 47, 48, 49, 50, 51, 52, 65, 78 e 81.\n\nSPRAGG, k. Interpolation and anisotropy. 2013. Artigo publicado no blog leapfrog3d.\nDispon\u00edvel em:&lt;http://blog.leapfrog3d.com/2013/10/18/interpolation-and-anisotropy/>.\nAcesso em: 23-11-2016. Citado na p\u00e1gina 36.\n\nSPRAGG, k. Leapfrog interpolation basics. 2013. Artigo publicado no blog leapfrog3d.\nDispon\u00edvel em:&lt;http://blog.leapfrog3d.com/2013/05/08/leapfrog-interpolation-basics/>.\nAcesso em: 23-11-2016. Citado na p\u00e1gina 36.\n\nSTR\u00c9BELLE, S.; JOURNEL, A. Sequential simulation drawing structures from training\nimages. Stanford University California, 2000. Citado na p\u00e1gina 52.\n\nWILDE, B.; DEUTSCH, C. A new way to calibrate distance function uncertainty. In:\nCCG Annual Report. [S.l.: s.n.], 2011. Citado 4 vezes nas p\u00e1ginas 21, 48, 50 e 82.\n\nhttp://www.geostatisticslessons.com/lessons/signeddistancefunctions\nhttp://www.geostatisticslessons.com/lessons/signeddistancefunctions\nhttp://blog.leapfrog3d.com/2013/10/18/interpolation-and-anisotropy/\nhttp://blog.leapfrog3d.com/2013/05/08/leapfrog-interpolation-basics/\n\n\n\n\nAp\u00eandices\n\n\n\n\n\n89\n\nAP\u00caNDICE A \u2013 Algoritmo em python que\ncalcula as dist\u00e2ncias anisotr\u00f3picas assinaladas\n\n(signed distances)\n\n\n\n \n\n1. #-------------------------------------------------------------------------------   \n2. #   \n3. # Signed Distance Function Calculator   \n4. # ***********************************   \n5. #   \n6. # This SGeMS plugin calculates the anisotropic signed distances for each data   \n7. # point and each rock type   \n8. #   \n9. # AUTHOR: Roberto Mentzingen Rolo   \n10. #   \n11. #-------------------------------------------------------------------------------   \n12.    \n13. #!/bin/python   \n14. import sgems   \n15. import math   \n16. import numpy as np   \n17.    \n18. #Calculates the distances   \n19. def dist(x1, y1, z1, x2, y2, z2):   \n20.     return math.sqrt((x1 - x2) ** 2 + (y1 - y2) ** 2 + (z1 - z2) ** 2)   \n21.    \n22. #Defines the rotation and dilatation matrices   \n23. def rot(range1, range2, range3, azimuth, dip, rake, vetor):   \n24.    \n25.     if azimuth >= 0 and azimuth&lt;=270:   \n26.     alpha = math.radians(90-azimuth)   \n27.     else:   \n28.     alpha = math.radians(450-azimuth)   \n29.     beta = -math.radians(dip)   \n30.     phi = math.radians(rake)   \n31.    \n32.     rot_matrix = np.zeros((3,3))   \n33.    \n34.     rot_matrix[0,0] = math.cos(beta)*math.cos(alpha)   \n35.     rot_matrix[0,1] = math.cos(beta)*math.sin(alpha)   \n36.     rot_matrix[0,2] = -math.sin(beta)   \n37.     rot_matrix[1,0] = (range1/range2)*(-\n\nmath.cos(phi)*math.sin(alpha)+math.sin(phi)*math.sin(beta)*math.cos(alpha))   \n38.     rot_matrix[1,1] = (range1/range2)*(math.cos(phi)*math.cos(alpha)+math.sin(phi)*math.si\n\nn(beta)*math.sin(alpha))   \n39.     rot_matrix[1,2] = (range1/range2)*(math.sin(phi)*math.cos(beta))   \n40.     rot_matrix[2,0] = (range1/range3)*(math.sin(phi)*math.sin(alpha)+math.cos(phi)*math.si\n\nn(beta)*math.cos(alpha))   \n41.     rot_matrix[2,1] = (range1/range3)*(-\n\nmath.sin(phi)*math.cos(alpha)+math.cos(phi)*math.sin(beta)*math.sin(alpha))   \n42.     rot_matrix[2,2] = (range1/range3)*(math.cos(phi)*math.cos(beta))   \n43.    \n44.     vetor = np.array(vetor)   \n45.    \n46.     return np.dot(rot_matrix, vetor)   \n47.    \n48. #Transform the data with the ratation/dilatation matrices   \n49. def anis_search(X, Y, Z, range1, range2, range3, azimuth, dip, rake):   \n50.    \n51.     X_linha = []   \n52.     Y_linha = []   \n53.     Z_linha = []   \n54.    \n55.     for i in range(len(X)):   \n56.     vet = [X[i],Y[i],Z[i]]   \n57.    \n58.     vet_rot = rot(range1, range2, range3, azimuth, dip, rake, vet)   \n59.    \n60.     X_linha.append(vet_rot[0])   \n61.     Y_linha.append(vet_rot[1])   \n62.     Z_linha.append(vet_rot[2])   \n\n\n\n63.    \n64.     return X_linha, Y_linha, Z_linha   \n65.    \n66. #Shows every parameter of the plugin in the command pannel   \n67. def read_params(a,j=''):   \n68.   for i in a:   \n69.     if (type(a[i])!=type({'a':1})):   \n70.       print j+\"['\"+str(i)+\"']=\"+str(a[i])   \n71.     else:   \n72.       read_params(a[i],j+\"['\"+str(i)+\"']\")   \n73.    \n74. class signed_distances:   \n75.     def __init__(self):   \n76.         pass   \n77.    \n78.     def initialize(self, params):   \n79.         self.params = params   \n80.         return True   \n81.    \n82.     def execute(self):   \n83.    \n84.         '''''#Execute the funtion read_params  \n85.         read_params(self.params)  \n86.         print self.params'''   \n87.    \n88.         #Get the grid and rock type propery   \n89.         grid = self.params['propertyselectornoregion']['grid']   \n90.         prop = self.params['propertyselectornoregion']['property']   \n91.    \n92.         #Error message   \n93.         if len(grid) == 0 or len(prop) == 0:   \n94.             print 'Select the rocktype property'   \n95.             return False   \n96.    \n97.         #Get the X, Y and Z coordinates and RT property   \n98.         X = sgems.get_property(grid, '_X_')   \n99.         Y = sgems.get_property(grid, '_Y_')   \n100.         Z = sgems.get_property(grid, '_Z_')   \n101.         RT = sgems.get_property(grid, prop)   \n102.    \n103.         elipsoide = self.params['ellipsoidinput']['value']   \n104.         elipsoide_split = elipsoide.split()   \n105.    \n106.         range1 = float(elipsoide_split[0])   \n107.         range2 = float(elipsoide_split[1])   \n108.         range3 = float(elipsoide_split[2])   \n109.    \n110.         azimuth = float(elipsoide_split[3])   \n111.         dip = float(elipsoide_split[4])   \n112.         rake = float(elipsoide_split[5])   \n113.    \n114.         X, Y, Z = anis_search(X, Y, Z, range1, range2, range3, azimuth, dip, rake) \n\n  \n115.    \n116.         #Creates a list of all rock types   \n117.         rt_list = []   \n118.         for i in RT:   \n119.             if i not in rt_list and not math.isnan(i):   \n120.                 rt_list.append(i)   \n121.    \n122.         #Sort the rock type list in crescent order   \n123.         rt_list = [int(x) for x in rt_list]   \n124.         rt_list.sort()   \n125.    \n126.         #Create a empty distance matrix   \n127.         dist_matrix = np.zeros(shape = ((len(rt_list)), (len(RT))))   \n128.    \n129.         #Calculates the signed distances, and append it in the distance matrix   \n130.         for i in range(len(rt_list)):   \n\n\n\n131.             rock = rt_list[i]   \n132.    \n133.             for j in range(len(RT)):   \n134.    \n135.                 if math.isnan(RT[j]):   \n136.                     dist_matrix[i][j] = float('nan')   \n137.    \n138.                 elif RT[j] == rock:   \n139.                     dsmin = 1.0e21   \n140.    \n141.                     for k in range(len(RT)):   \n142.    \n143.                         if RT[j] != RT[k] and not math.isnan(RT[k]):   \n144.                             if (dist(X[j], Y[j], Z[j], X[k], Y[k], Z[k])) &lt;dsmin: \n\n  \n145.                                 dsmin = (dist(X[j], Y[j], Z[j], X[k], Y[k], Z[k])) \n\n  \n146.    \n147.                         dist_matrix[i][j] = -dsmin   \n148.    \n149.                 else:   \n150.                     dsmin = 1.0e21   \n151.    \n152.                     for k in range(len(RT)):   \n153.    \n154.                         if RT[k] == rock:   \n155.                             if (dist(X[j], Y[j], Z[j], X[k], Y[k], Z[k])) &lt;dsmin: \n\n  \n156.                                 dsmin = (dist(X[j], Y[j], Z[j], X[k], Y[k], Z[k])) \n\n  \n157.    \n158.                         dist_matrix[i][j] = dsmin   \n159.    \n160.         #Creates the signed distances properties   \n161.         lst_props_grid=sgems.get_property_list(grid)   \n162.    \n163.         for k in range(len(dist_matrix)):   \n164.             prop_final_data_name = 'Signed_Distances_RT_' + str(rt_list[k])   \n165.    \n166.             if (prop_final_data_name in lst_props_grid):   \n167.                 flag=0   \n168.                 i=1   \n169.                 while (flag==0):   \n170.                     test_name=prop_final_data_name+'-'+str(i)   \n171.                     if (test_name not in lst_props_grid):   \n172.                         flag=1   \n173.                         prop_final_data_name=test_name   \n174.                     i=i+1   \n175.    \n176.             list = dist_matrix[k].tolist()   \n177.             sgems.set_property(grid, prop_final_data_name, list)   \n178.    \n179.         return True   \n180.    \n181.     def finalize(self):   \n182.         return True   \n183.    \n184.     def name(self):   \n185.         return \"signed_distances\"   \n186.    \n187. ################################################################################   \n188. def get_plugins():   \n189.     return [\"signed_distances\"]   \n\n \n\n\n\n93\n\nAP\u00caNDICE B \u2013 Algoritmo em python que\ninterpola as distancias assinaladas e cria o\n\nmodelo geol\u00f3gico (interpolator)\n\n\n\n \n\n1. #-------------------------------------------------------------------------------   \n2. #   \n3. # Signed Distances Function Interpolator   \n4. # **************************************   \n5. #   \n6. # This SGeMS plugin interpolates (OK) the signed distance function calculated   \n7. # for each data and rock type, and creates a geologic model based on the minimum   \n8. # estimated distance.   \n9. #   \n10. # AUTHOR: Roberto Mentzingen Rolo   \n11. #   \n12. #-------------------------------------------------------------------------------   \n13.    \n14. #!/bin/python   \n15. import sgems   \n16. import math   \n17. import numpy as np   \n18. import random   \n19. import copy   \n20.    \n21. #Creates a randon path given the size of the grid   \n22. def random_path(prop):   \n23.     nodes_not_nan = []   \n24.     for i in range(len(prop)):   \n25.         if not math.isnan(prop[i]):   \n26.             nodes_not_nan.append(i)   \n27.     random.shuffle(nodes_not_nan)   \n28.     return nodes_not_nan   \n29.    \n30. #Calculates the proportions of variables on a list   \n31. def proportion(var, RT):   \n32.     rock_types =[]   \n33.     target_prop = []   \n34.     for k in range(len(RT)):   \n35.         target_prop.append(0)   \n36.         rock_types.append(int(RT[k][-1]))   \n37.     rock_types.sort()   \n38.     var_not_nan = []   \n39.     for i in var:   \n40.         if not math.isnan(i):   \n41.             var_not_nan.append(i)   \n42.     for i in range(len(rock_types)):   \n43.         target_prop[i] = float(var.count(rock_types[i]))/len(var_not_nan)   \n44.     return target_prop   \n45.    \n46. #Transform i,j,k in n   \n47. def ijk_in_n(grid, i, j, k):   \n48.     dims = sgems.get_dims(grid)   \n49.     n = k*dims[0]*dims[1]+j*dims[0]+i   \n50.     return n   \n51.    \n52. #Crestes a list with indices of the neighbors valid blocks   \n53. def neighb(grid, indice):   \n54.         ijk = sgems.get_ijk(grid, indice)   \n55.         neighborhood = []   \n56.         for i in range(ijk[0]-1,ijk[0]+2):   \n57.             for j in range(ijk[1]-1,ijk[1]+2):   \n58.                 for k in range(ijk[2]-1,ijk[2]+2):   \n59.                     ijk_blk = [i,j,k]   \n60.                     neighborhood.append(ijk_blk)   \n61.         dims = sgems.get_dims(grid)   \n62.         neighborhood_cp = copy.copy(neighborhood)   \n63.         for i in neighborhood_cp:   \n64.             if dims[2] == 1:   \n65.                 if i[0] &lt;0 or i[1] &lt;0:   \n66.                     neighborhood.remove(i)   \n\n\n\n67.                 elif i[0] > (dims[0] - 1) or i[1] > (dims[1] - 1):   \n68.                     neighborhood.remove(i)   \n69.                 elif i[2] != 0:   \n70.                     neighborhood.remove(i)   \n71.                 elif i == sgems.get_ijk(grid, indice):   \n72.                     neighborhood.remove(i)   \n73.             else:   \n74.                 if i[0] &lt;0 or i[1] &lt;0 or i[2] &lt;0:   \n75.                     neighborhood.remove(i)   \n76.                 elif i[0] > (dims[0] - 1) or i[1] > (dims[1] - 1) or i[2] > (dims[2] - 1):\n\n   \n77.                     neighborhood.remove(i)   \n78.                 elif i == sgems.get_ijk(grid, indice):   \n79.                     neighborhood.remove(i)   \n80.         neighborhood_n = []   \n81.         for i in neighborhood:   \n82.             neighborhood_n.append(ijk_in_n(grid,i[0],i[1],i[2]))   \n83.         return neighborhood_n   \n84.    \n85.    \n86. # Shows every parameter of the plugin in the command pannel   \n87. def read_params(a, j=''):   \n88.     for i in a:   \n89.         if (type(a[i]) != type({'a': 1})):   \n90.             print j + \"['\" + str(i) + \"']=\" + str(a[i])   \n91.         else:   \n92.             read_params(a[i], j + \"['\" + str(i) + \"']\")   \n93.    \n94. class interpolator:   \n95.     def __init__(self):   \n96.         pass   \n97.    \n98.     def initialize(self, params):   \n99.         self.params = params   \n100.         return True   \n101.    \n102.     def execute(self):   \n103.    \n104.         '''''# Execute the funtion read_params  \n105.         read_params(self.params)  \n106.         print self.params'''   \n107.    \n108.         #Get the grid and rock type propery   \n109.         grid = self.params['propertyselectornoregion']['grid']   \n110.         prop = self.params['propertyselectornoregion']['property']   \n111.    \n112.         #Get the X, Y and Z coordinates and RT property   \n113.         X = sgems.get_property(grid, '_X_')   \n114.         Y = sgems.get_property(grid, '_Y_')   \n115.         Z = sgems.get_property(grid, '_Z_')   \n116.         RT_data = sgems.get_property(grid, prop)   \n117.    \n118.         # Getting properties   \n119.         grid_krig = self.params['gridselectorbasic_2']['value']   \n120.         grid_var = self.params['gridselectorbasic']['value']   \n121.         props = (self.params['orderedpropertyselector']['value']).split(';')   \n122.         n_var = int(self.params['indicator_regionalization_input']['number_of_indic\n\nator_group'])   \n123.         n_prop = int(self.params['orderedpropertyselector']['count'])   \n124.         min_cond = self.params['spinBox_2']['value']   \n125.         max_cond = self.params['spinBox']['value']   \n126.    \n127.         # Error messages   \n128.         if len(grid_var) == 0 or len(grid_krig) == 0:   \n129.             print 'Select the variables'   \n130.             return False   \n131.    \n132.         if n_var != n_prop:   \n\n\n\n133.             print 'Number of variables and number of variograms models are diferent\n.'   \n\n134.             return False   \n135.    \n136.         #Creating an empty list to store the interpolated distances   \n137.         SG_OK_list = []   \n138.    \n139.         # Loop in every variable   \n140.         for i in xrange(0, n_var):   \n141.    \n142.             # Getting variables   \n143.             prop_HD = props[i]   \n144.             prop_name = \"Interpolated_\" + str(prop_HD)   \n145.             prop_name_var = \"Interpolated_\" + str(prop_HD) + ' krig_var'   \n146.             var_str = ''   \n147.             indicator_group = \"Indicator_group_\" + str(i + 1)   \n148.             elipsoide = self.params['ellipsoidinput']['value']   \n149.             n_struct = int(self.params['indicator_regionalization_input'][indicator\n\n_group]['Covariance_input']['structures_count'])   \n150.    \n151.             # Error message   \n152.             if n_struct == 0:   \n153.                 print 'Variogram have no structures'   \n154.                 return False   \n155.    \n156.             # Loop in every variogram structure   \n157.             for j in xrange(0, n_struct):   \n158.                 # Getting variogram parameters   \n159.                 Structure = \"Structure_\" + str(j + 1)   \n160.    \n161.                 cov_type = self.params['indicator_regionalization_input'][indicator\n\n_group]['Covariance_input'][Structure]['Two_point_model']['type']   \n162.    \n163.                 cont = self.params['indicator_regionalization_input'][indicator_gro\n\nup]['Covariance_input'][Structure]['Two_point_model']['contribution']   \n164.    \n165.                 if cov_type == 'Nugget Covariance':   \n166.                     #Writing variogram parameters on a variable in nugget effect ca\n\nse   \n167.                     var_str = var_str + '<{} type=\"{}\"> &lt;Two_point_model  contribu\n\ntion=\"{}\"  type=\"{}\"   >   &lt;/Two_point_model>   &lt;/Structure_1> '.format(Structure, 'Cova\nriance', cont, cov_type, Structure)   \n\n168.    \n169.                 else:   \n170.                     range1 = self.params['indicator_regionalization_input'][indicat\n\nor_group]['Covariance_input'][Structure]['Two_point_model']['ranges']['range1']   \n171.                     range2 = self.params['indicator_regionalization_input'][indicat\n\nor_group]['Covariance_input'][Structure]['Two_point_model']['ranges']['range2']   \n172.                     range3 = self.params['indicator_regionalization_input'][indicat\n\nor_group]['Covariance_input'][Structure]['Two_point_model']['ranges']['range3']   \n173.    \n174.                     rake = self.params['indicator_regionalization_input'][indicator\n\n_group]['Covariance_input'][Structure]['Two_point_model']['angles']['rake']   \n175.                     dip = self.params['indicator_regionalization_input'][indicator_\n\ngroup]['Covariance_input'][Structure]['Two_point_model']['angles']['dip']   \n176.                     azimuth = self.params['indicator_regionalization_input'][indica\n\ntor_group]['Covariance_input'][Structure]['Two_point_model']['angles']['azimuth']   \n177.    \n178.                     # Writing variogram parameters on a variable in other cases   \n179.                     var_str = var_str + '<{} type=\"{}\"> &lt;Two_point_model  contribu\n\ntion=\"{}\"  type=\"{}\"   >     &lt;ranges range1=\"{}\"  range2=\"{}\"  range3=\"{}\"   />     &lt;ang\nles azimuth=\"{}\"  dip=\"{}\"  rake=\"{}\"   />   &lt;/Two_point_model>   &lt;/{}> '.format(Structu\nre, 'Covariance', cont, cov_type, range1, range2, range3, azimuth, dip, rake, Structure)   \n\n180.    \n181.             # Calling ordinary kriging for each variable, using the variograms para\n\nmeters above   \n182.             sgems.execute('RunGeostatAlgorithm  kriging::/GeostatParamUtils/XML::<p\n\narameters> &lt;algorithm name=\"kriging\" />    &lt;Variogram  structures_count=\"{}\" >    {} &lt;/\nVariogram>   &lt;ouput_kriging_variance  value=\"1\"  />    &lt;output_n_samples_  value=\"0\"  />\n\n\n\n    &lt;output_average_distance  value=\"0\"  />    &lt;output_sum_weights  value=\"0\"  />    &lt;o\nutput_sum_positive_weights  value=\"0\"  />    &lt;output_lagrangian  value=\"0\"  />    &lt;Nb_pr\nocessors  value=\"-\n2\"  />   &lt;Grid_Name value=\"{}\" region=\"\"  />    &lt;Property_Name  value=\"{}\" />    &lt;Hard_\nData  grid=\"{}\"   property=\"{}\"   region=\"\"  />    &lt;Kriging_Type  type=\"Ordinary Kriging \n(OK)\" >   &lt;parameters /> &lt;/Kriging_Type>   &lt;do_block_kriging  value=\"1\"  />    &lt;npoint\ns_x  value=\"5\" />    &lt;npoints_y  value=\"5\" />    &lt;npoints_z  value=\"5\" />    &lt;Min_Condi\ntioning_Data  value=\"{}\" />    &lt;Max_Conditioning_Data  value=\"{}\" />    &lt;Search_Ellipsoi\nd  value=\"{}\" />   &lt;AdvancedSearch  use_advanced_search=\"0\"></AdvancedSearch> &lt;/paramete\nrs>'.format(n_struct, var_str, grid_krig, prop_name, grid_var, prop_HD, min_cond, max_cond\n, elipsoide))   \n\n183.    \n184.             SG_OK_list.append(sgems.get_property(grid_krig, prop_name))   \n185.    \n186.             #Deleting kriged distances   \n187.             sgems.execute('DeleteObjectProperties  {}::{}'.format(grid_krig, prop_n\n\name))   \n188.             sgems.execute('DeleteObjectProperties  {}::{}'.format(grid_krig, prop_n\n\name_var))   \n189.    \n190.         RT = (self.params['orderedpropertyselector']['value']).split(';')   \n191.    \n192.         #Determinig geomodel based on minimum estimed signed distance function   \n193.         GeoModel = SG_OK_list[0][:]   \n194.    \n195.         t = 0   \n196.         for i in range(len(SG_OK_list[0])):   \n197.             sgmin = 10e21   \n198.             for j in range(len(SG_OK_list)):   \n199.                 if SG_OK_list[j][i] &lt;sgmin:   \n200.                     sgmin = SG_OK_list[j][i]   \n201.                     t = j   \n202.             if math.isnan(SG_OK_list[j][i]):   \n203.                 GeoModel[i] = float('nan')   \n204.             else:   \n205.                 GeoModel[i] = (int(RT[t][-1]))   \n206.    \n207.         #Creating GeoModel property   \n208.         lst_props_grid=sgems.get_property_list(grid_krig)   \n209.         prop_final_data_name = 'Geologic_Model'   \n210.    \n211.         if (prop_final_data_name in lst_props_grid):   \n212.             flag=0   \n213.             i=1   \n214.             while (flag==0):   \n215.                 test_name=prop_final_data_name+'-'+str(i)   \n216.                 if (test_name not in lst_props_grid):   \n217.                     flag=1   \n218.                     prop_final_data_name=test_name   \n219.                 i=i+1   \n220.    \n221.         #Assign conditioning data to grid node   \n222.         for i in range(len(RT_data)):   \n223.             if not math.isnan(RT_data[i]):   \n224.                 closest_node = sgems.get_closest_nodeid(grid_krig, X[i],Y[i],Z[i]) \n\n  \n225.                 GeoModel[closest_node] = RT_data[i]   \n226.    \n227.         sgems.set_property(grid_krig, prop_final_data_name, GeoModel)   \n228.    \n229.         #Operating softmax transformation   \n230.         if self.params['softmax_check']['value']=='1':   \n231.    \n232.             gamma =float( self.params['Gamma']['value'])   \n233.             Prob_list = SG_OK_list[:]   \n234.    \n235.             for i in range(len(SG_OK_list[0])):   \n236.                 soma = 0   \n237.                 for j in range(len(SG_OK_list)):   \n\n\n\n238.                     soma = soma + math.exp(-SG_OK_list[j][i]/gamma)   \n239.                 for j in range(len(SG_OK_list)):   \n240.                     Prob_list[j][i] = math.exp(-SG_OK_list[j][i]/gamma)/soma   \n241.    \n242.             #Creating probabilities propreties   \n243.             for k in range(len(Prob_list)):   \n244.                 prop_final_data_name = 'Probability_RT'+str(RT[k][-1])   \n245.    \n246.                 if (prop_final_data_name in lst_props_grid):   \n247.                     flag=0   \n248.                     i=1   \n249.                     while (flag==0):   \n250.                         test_name=prop_final_data_name+'-'+str(i)   \n251.                         if (test_name not in lst_props_grid):   \n252.                             flag=1   \n253.                             prop_final_data_name=test_name   \n254.                         i=i+1   \n255.    \n256.                 sgems.set_property(grid_krig, prop_final_data_name, Prob_list[k])   \n257.    \n258.             #Operating servo-system   \n259.             if self.params['servo_check']['value'] == '1':   \n260.                 var_rt_grid = self.params['targe_prop']['grid']   \n261.                 var_rt_st = self.params['targe_prop']['property']   \n262.                 var_rt_region = self.params['targe_prop']['region']   \n263.                 if len(var_rt_grid) == 0 or len(var_rt_st) == 0:   \n264.                     print 'Select the target proportion property'   \n265.                     return False   \n266.    \n267.                 #Getting variables   \n268.                 var_rt = sgems.get_property(var_rt_grid, var_rt_st)   \n269.    \n270.                 #Getting parameters   \n271.                 lambda1 = float(self.params['Lambda']['value'])   \n272.                 mi = lambda1/(1-lambda1)   \n273.    \n274.                 #Checking if a region exist   \n275.                 if len(var_rt_region) == 0:   \n276.                     #Variable without a region   \n277.                     var_region = var_rt   \n278.    \n279.                 else:   \n280.                     region_rt = sgems.get_region(var_rt_grid, var_rt_region)   \n281.                     #Geting the variable inside the region   \n282.                     var_region = []   \n283.                     for i in range(len(var_rt)):   \n284.                         if region_rt[i] == 1:   \n285.                             var_region.append(var_rt[i])   \n286.    \n287.                 #Getting the target proportion   \n288.                 target_prop = proportion(var_region, RT)   \n289.    \n290.                 #Getting the random path   \n291.                 ran_path = random_path(Prob_list[0])   \n292.    \n293.                 #Removing the blocks outside the region from randon path   \n294.                 if len(var_rt_region) != 0:   \n295.                     for i in range(len(region_rt)):   \n296.                         if region_rt[i] == 0:   \n297.                             ran_path.remove(i)   \n298.    \n299.                 #servo system   \n300.                 p = 0   \n301.                 GeoModel_corrected = GeoModel[:]   \n302.    \n303.                 visited_rts = []   \n304.                 for j in ran_path:   \n305.                     visited_rts.append(GeoModel[j])   \n306.                     instant_proportions = proportion(visited_rts,RT)   \n\n\n\n307.    \n308.                     sgmax = 10e-21   \n309.                     for i in range(len(Prob_list)):   \n310.                         Prob_list[i][j] = Prob_list[i][j] + (mi * (target_prop[i] -\n\n instant_proportions[i]))   \n311.                         if Prob_list[i][j] > sgmax:   \n312.                             sgmax = Prob_list[i][j]   \n313.                             p = i   \n314.    \n315.                     GeoModel_corrected[j] = int(RT[p][-1])   \n316.                     visited_rts[-1] = int(RT[p][-1])   \n317.    \n318.                 #Correcting servo servo-\n\nsystem by the biggest proportion on a neighborhood   \n319.                 GeoModel_corrected_servo_prop = GeoModel_corrected[:]   \n320.                 ran_path_servo_correction = random_path(GeoModel_corrected_servo_pr\n\nop)   \n321.                 for i in ran_path_servo_correction:   \n322.                     vizinhanca = neighb(grid_krig,i)   \n323.    \n324.                     blk_geo_model_corrected_servo = []   \n325.                     for j in vizinhanca:   \n326.                         blk_geo_model_corrected_servo.append(GeoModel_corrected_ser\n\nvo_prop[j])   \n327.    \n328.                     proportions_servo = proportion(blk_geo_model_corrected_servo, R\n\nT)   \n329.                     indice_max_prop = proportions_servo.index(max(proportions_servo\n\n))   \n330.    \n331.                     GeoModel_corrected_servo_prop[i] = int(RT[indice_max_prop][-\n\n1])   \n332.    \n333.                 #Creating Geologic_Model_Servo_System property   \n334.                 prop_final_data_name = 'Geologic_Model_Servo_System'   \n335.    \n336.                 if (prop_final_data_name in lst_props_grid):   \n337.                     flag=0   \n338.                     i=1   \n339.                     while (flag==0):   \n340.                         test_name=prop_final_data_name+'-'+str(i)   \n341.                         if (test_name not in lst_props_grid):   \n342.                             flag=1   \n343.                             prop_final_data_name=test_name   \n344.                         i=i+1   \n345.    \n346.                 #Creating Geologic_Model_Corrected property   \n347.                 prop_final_data_name1 = 'Geologic_Model_Corrected'   \n348.    \n349.                 if (prop_final_data_name1 in lst_props_grid):   \n350.                     flag=0   \n351.                     i=1   \n352.                     while (flag==0):   \n353.                         test_name1=prop_final_data_name1+'-'+str(i)   \n354.                         if (test_name1 not in lst_props_grid):   \n355.                             flag=1   \n356.                             prop_final_data_name1=test_name1   \n357.                         i=i+1   \n358.    \n359.                 #Assign conditioning data to grid node   \n360.                 for i in range(len(RT_data)):   \n361.                     if not math.isnan(RT_data[i]):   \n362.                         closest_node = sgems.get_closest_nodeid(grid_krig, X[i],Y[i\n\n],Z[i])   \n363.                         GeoModel_corrected[closest_node] = RT_data[i]   \n364.                         GeoModel_corrected_servo_prop[closest_node] = RT_data[i]   \n365.    \n366.                 #Setting properties   \n\n\n\n367.                 sgems.set_property(grid_krig, prop_final_data_name, GeoModel_correc\nted)   \n\n368.                 sgems.set_property(grid_krig, prop_final_data_name1, GeoModel_corre\ncted_servo_prop)   \n\n369.    \n370.         return True   \n371.    \n372.     def finalize(self):   \n373.    \n374.         return True   \n375.    \n376.     def name(self):   \n377.    \n378.         return \"interpolator\"   \n379.    \n380. ################################################################################   \n381. def get_plugins():   \n382.     return [\"interpolator\"]   \n\n \n\n\n\nAnexos\n\n\n\n\n\n103\n\nANEXO A \u2013 Arquivo de par\u00e2metro usado na\nvalida\u00e7\u00e3o\n\nParameters for DFMOD\n********************\n\nSTART OF PARAMETERS:\ncleaned_samples.prn - file with data\n0 1 2 3 4 - columns for DH,X,Y,Z,var\n-1.0 1.0e21 - trimming limits\n5 - number of categories\n2 3 4 5 6 - codes\ndfmod.out - file for distance function output\nrtmod_2.out - file for rock type output\n51 470170 25 - nx,xmn,xsiz\n48 6936500 25 - ny,ymn,ysiz\n89 3115 15 - nz,zmn,zsiz\n5 5 5 - x,y and z block discretization\n4 32 - min, max data for kriging\n0 - max per octant (0-> not used)\n1000 1000 1000 - maximum search radii\n0.0 0.0 0.0 - angles for search ellipsoid\n\n1 2.302 - 0=SK,1=OK\n2 100 -nst, nugget effect\n3 3000 0.0 0.0 0.0 -it,cc,ang1,ang2,ang3\n\n280 280 820.0 -a_hmax, a_hmin, a_vert\n3 40000 0.0 0.0 0.0 -it,cc,ang1,ang2,ang3\n\n9999999999 9999999999 820 -a_hmax, a_hmin, a_vert\n2 100 -nst, nugget effect\n3 7000 0.0 0.0 0.0 -it,cc,ang1,ang2,ang3\n\n400 400 820.0 -a_hmax, a_hmin, a_vert\n3 20000 0.0 0.0 0.0 -it,cc,ang1,ang2,ang3\n\n9999999999 9999999999 820 -a_hmax, a_hmin, a_vert\n2 100 -nst, nugget effect\n3 4000 0.0 0.0 0.0 -it,cc,ang1,ang2,ang3\n\n300 300 400.0 -a_hmax, a_hmin, a_vert\n\n\n\n104 ANEXO A. Arquivo de par\u00e2metro usado na valida\u00e7\u00e3o\n\n3 15000 0.0 0.0 0.0 -it,cc,ang1,ang2,ang3\n900 900 9999999999 -a_hmax, a_hmin, a_vert\n\n2 100 -nst, nugget effect\n3 4000 0.0 0.0 0.0 -it,cc,ang1,ang2,ang3\n\n250 250 500.0 -a_hmax, a_hmin, a_vert\n3 15000 0.0 0.0 0.0 -it,cc,ang1,ang2,ang3\n\n820 820 9999999999 -a_hmax, a_hmin, a_vert\n2 100 -nst, nugget effect\n3 4000 0.0 0.0 0.0 -it,cc,ang1,ang2,ang3\n\n320 320 500.0 -a_hmax, a_hmin, a_vert\n3 15000 0.0 0.0 0.0 -it,cc,ang1,ang2,ang3\n\n820 820 9999999999 -a_hmax, a_hmin, a_vert\n\n\n\tFolha de rosto\n\tFolha de aprova\u00e7\u00e3o\n\tAgradecimentos\n\tEp\u00edgrafe\n\tResumo\n\tAbstract\n\tLista de ilustra\u00e7\u00f5es\n\tLista de tabelas\n\tSum\u00e1rio\n\tIntrodu\u00e7\u00e3o\n\tMeta\n\tObjetivos espec\u00edficos\n\tMetodologia\n\tEstrutura da disserta\u00e7\u00e3o\n\n\tRevis\u00e3o bibliogr\u00e1fica\n\tEstacionariedade\n\tFun\u00e7\u00f5es aleat\u00f3rias\n\tMomentos\n\tMomento de primeira ordem\n\tMomentos de segunda ordem\n\n\tHip\u00f3tese de estacionariedade\n\tEstacionariedade estrita\n\tEstacionariedade segunda ordem\n\tHip\u00f3tese intr\u00ednseca\n\tQuasi-estacionariedade\n\n\tDecis\u00e3o de estacionariedade\n\n\tFun\u00e7\u00f5es impl\u00edcitas\n\tFun\u00e7\u00f5es dist\u00e2ncias assinaladas\n\n\tM\u00e9todo implementado no software Leapfrog\u00ae\n\tMetodologia\n\tInterpola\u00e7\u00e3o\n\tAnisotropia\n\tVis\u00e3o geral\n\n\n\tM\u00e9todo dos campos potenciais\n\tMetodologia\n\tTipos de dados\n\tCodifica\u00e7\u00e3o dos dados\n\tInterpola\u00e7\u00e3o do campo potencial\n\tImplementa\u00e7\u00e3o do algoritmo de cokrigagem\n\tVari\u00e2ncia do campo potencial\n\tIncerteza nos modelos\n\tVis\u00e3o geral\n\n\n\n\tModelagem geol\u00f3gica impl\u00edcita com fun\u00e7\u00f5es dist\u00e2ncia assinaladas\n\tMetodologia\n\tCaso bin\u00e1rio\n\tAplica\u00e7\u00e3o da metodologia para m\u00faltiplos dom\u00ednios geol\u00f3gicos\n\n\tUma medida heur\u00edstica de incerteza (softmax transformation)\n\tTransforma\u00e7\u00e3o das dist\u00e2ncias\n\n\tCorre\u00e7\u00e3o das propor\u00e7\u00f5es globais dos dom\u00ednios (servo system)\n\tServo system\n\n\tO Plug-in\n\tSigned distances\n\tInterpolator\n\n\tValida\u00e7\u00e3o\n\n\tEstudo de caso\n\tVariografia\n\tInterpola\u00e7\u00e3o\n\tResultados\n\tCompara\u00e7\u00e3o\n\n\tDiscuss\u00e3o\n\n\tConsidera\u00e7\u00f5es finais\n\tRecomenda\u00e7\u00f5es para trabalhos futuros\n\n\tRefer\u00eancias\n\tAp\u00eandices\n\tAlgoritmo em python que calcula as dist\u00e2ncias anisotr\u00f3picas assinaladas (signed distances)\n\tAlgoritmo em python que interpola as distancias assinaladas e cria o modelo geol\u00f3gico (interpolator)\n\n\tAnexos\n\tArquivo de par\u00e2metro usado na valida\u00e7\u00e3o"}]}}}