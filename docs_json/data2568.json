{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.06189"}, {"@name": "filename", "#text": "10707_MingireanovFilho_Ivan_M.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNICAMP\nIVAN MINGIREANOV FILHO\nSEGMENTA\u00c7AO DE IMAGENS DE ROCHAS E CLASSIFICA\u00c7\u00c3O DE litofAcies utilizando FLORESTA DE CAMINHOS \u00d3TIMOS\nCAMPINAS\n2013\nUNIVERSIDADE ESTADUAL DE CAMPINAS FACULDADE DE ENGENHARIA MECAnICA E INSTITUTO DE GEOCIEnCIAS\nUNICAMP\nIVAN MINGIREANOV FILHO\nsegmenta\u00e7Ao de imagens de\nrochas e classifica\u00e7ao de litofA\u00e7ies utilizando\nFLORESTA DE CAMINHOS OTIMOS\nOrientador: Prof. Dr. Alexandre Campane Vidal\nCo-Orientador: Prof. Dr. Alexandre Xavier Falcao\nDisserta\u00e7\u00e3o de Mestrado apresentada ao Programa de P\u00f3s-Gradua\u00e7\u00e3o em Ci\u00eancias e Engenharia de Petroleo da Faculdade de Engenharia Mecanica e Instituto de Geocien\u00e7ias da Universidade Estadual de Campinas para obten\u00e7ao de t\u00edtulo de Mestre em Ciencias e Engenharia de Petroleo na area de Reservat\u00f3rios e Gest\u00e3o.\nEste exemplar corresponde \u00e0 vers\u00e3o final da disserta\u00e7\u00e3o defendida pelo aluno Ivan Mingireanov Filho e orientada pelo Prof. Dr. Alexandre Campane\nFICHA CATALOGR\u00c1FICA ELABORADA PELA\nBIBLIOTECA DA \u00c1REA DE ENGENHARIA E ARQUITETURA - BAE - UNICAMP\nM663s\nMingireanov Filho, Ivan\nSegmenta\u00e7\u00e3o de imagens de rochas e classifica\u00e7\u00e3o de litof\u00e1cies utilizando floresta de caminhos \u00f3timos / Ivan Mingireanov Filho. --Campinas, SP: [s.n.], 2013.\nOrientador: Alexandre Campane Vidal Coorientador: Alexandre Xavier Falc\u00e3o.\nDisserta\u00e7\u00e3o de Mestrado - Universidade Estadual de Campinas, Faculdade de Engenharia Mec\u00e2nica e Instituto de Geoci\u00eancias.\n1.\tProcessamento de imagens. 2. Reservat\u00f3rios. 3. Reconhecimento de padr\u00f5es. 4. Segmenta\u00e7\u00e3o de imagens. 5. Petrof\u00edsica. I. Vidal, Alexandre Campane, 1969-. II. Falc\u00e3o, Alexandre Xavier, 1966-. III. Universidade Estadual de Campinas. Faculdade de Engenharia Mec\u00e2nica e Instituto de Geoci\u00eancias. IV. T\u00edtulo.\nT\u00edtulo em Ingl\u00eas: Segmentation of rock images and lithofacies classification using optimum-path forest\nPalavras-chave em Ingl\u00eas: Image segmentation, Reservoir, Pattern recognition, Image Segmentation, Petrophysics\n\u00c1rea de concentra\u00e7\u00e3o: Reservat\u00f3rios e Gest\u00e3o\nTitula\u00e7\u00e3o: Mestre em Ci\u00eancias e Engenharia de Petr\u00f3leo\nBanca examinadora: C\u00e9lio Maschio, Jo\u00e3o Paulo Papa\nData da defesa: 21-02-2013\nPrograma de P\u00f3s Gradua\u00e7\u00e3o: Ci\u00eancias e Engenharia de Petr\u00f3leo\nUNIVERSIDADE ESTADUAL DE CAMPINAS FACULDADE DE ENGENHARIA MECAnICA E INSTITUTO DE GEOCIEnCIAS\nUNICAMP\ndissertacAo de mestrado acadEmico\nSEGMENTA\u00c7AO DE IMAGENS DE ROCHAS E CLASSIFICA\u00c7\u00c3O DE litofA\u00e7ies utilizando FLORESTA DE CAMINHOS \u00d3TIMOS\nOrientador: Ivan Mingireanov Filho\nOrientador: Prof. Dr. Alexandre Campane Vidal\nCo-Orientador: Prof. Dr. Alexandre Xavier Falcao\nA banca examinadora composta pelos membros abaixo aprovou esta disserta\u00e7\u00e3o:\nDGRN/1G/UNICAMP\nDr. C\u00e9lio Maschio\nUNISIM/CEPETRO/UNICAMP\nUNESP/BAURU\nCampinas, 21 de fevereiro de 2013\nDedicatoria\nJA minha mae, Katia Riccardi, dedico.\n\"A mente que se abre a uma nova ideia jamais voltar\u00e1 ao seu tamanho original.\"\nAlbert Einstein\n\"Todas as vit\u00e1rias ocultam uma abdica\u00e7\u00e3o.\"\nSimone de Beauvoir\nAgradecimentos\nAgradeco primeiramente a Deus, pois sem Ele nada disso faria sentido.\nAgradeco aos meus pais, que me ensinaram desde pequeno a importancia da educacao e a responsabilidade do conhecimento. Dedico um agradecimento especial a minha mae Katia Riccardi, e minha irma, Tatiana Riccardi Mingireanov, que sempre estiveram ao meu lado, me apoiando e acreditando em meu potencial.\nAgradeco a minha fam\u00edlia por suas contribuicoes diretas e indiretas na minha formacao.\nA minha noiva, Marcela Mendes Salazar, pelo carinho, atencao, paciencia e ate algumas correcoes e sugest\u00f5es no trabalho.\nAos meus amigos e colegas de trabalho por todo apoio durante essa jornada. Em especial a Michelle Kuroda e Thiago Spina pelas grandes contributes que deram ao meu trabalho.\nAo meu orientador, Alexandre Vidal, e co-orientador, Alexandre Falcao pela oportunidade, apoio, sugestoes sempre construtivas, incetivo e amizade que surgiu ao longo dessajornada.\nAos funcionarios do Departamento de Engenharia de Petr\u00f3leo (DEP) e em especial a Sonia e Michelle.\nAgradeco tambem a Agencia Nacional do Petroleo pelo apoio financeiro e todo suporte.\nA Universidade Estadual de Campinas (UNICAMP) por oferecer uma estrutura de excelencia para a minha formacao.\nResumo\nA caracteriza\u00e7\u00e3o de reservat\u00f3rios \u00e9 fundamental na constru\u00e7\u00e3o do modelo geol\u00f3gico para a produ\u00e7\u00e3o do campo. O melhoramento de tecnicas matematicas, que auxiliam a interpretacao geologica, influenciam diretamente o plano de desenvolvimento e gerenciamento dos pocos. Nesse sentido, este trabalho utiliza uma aplicacao inedita na caracterizacao de reservat\u00f3rios da t\u00e9cnica de Transformada Imagem Floresta (Image Foresting Transform - IFT) em segmentacao de imagens de rocha para a analise petrof\u00edsica. A t\u00e9cnica interpreta a imagem como um grafo, onde os pixels sao os nos e os arcos sao definidos por um relacao de adjacencia entre os pixels. O custo de um caminho no grafo e determinado por uma funcao que depende das propriedades locais da imagem. As ra\u00edzes da floresta surgem de um conjunto de pixels escolhidos como sementes e a IFT atribui um caminho de custo m\u00ednimo das sementes a cada pixel da imagem para gerar uma Floresta de Caminhos (\u00d3timos (Optimum-Path Forest - OPF). Com isso, nas imagens de laminas de arenito, os graos sao segmentados em relacao ao poro e os gr\u00e2os em contato sao separados entre si. Com os resultados obtidos e poss\u00edvel o estudo da morfologia dos graos e porosidade da amostra. O metodo consiste de dois processos principais, um totalmente automatico para segmentar a imagem e outro que utiliza uma interface grafica para permitir correcoes dos erros de classificacao gerados pelo processo automatico. A acur\u00e1cia e medida comparando a imagem corrigida por interacao do usuario com a segmentada automaticamente. Outra aplicacao inedita apresentada no trabalho e a utilizacao do classificador supervisionado baseado em OPF para a classificacao de dados de perfilagem geof\u00edsica do campo de Namorado.\nPalavras-chave: segmentacao de imagens, Transformada Imagem Floresta, Floresta de Caminhos (\u00d3timos, classificacao de litofacies, classificador OPF supervisionado, morfologia de graos.\nAbstract\nThe reservoir characterization is fundamental in the construction process of geological model for field production. The improvement of mathematical techniques that assist the geological interpretation, has a directly influence in the development plan and management of the wells. Accordingly, this study uses a novel application in reservoir characterization, Image Foresting Forest (IFT) technique to image segmentation of rock for petrophysical analysis. The IFT interprets an image as a graph, whose nodes are the image pixels, the arcs are defined by an adjacency relation between pixels, and the paths are valued by a connectivity function. The roots of forest are a set of pixels selected as seeds and the IFT assigns a minimum path-cost to each image pixel generation an Optimum-Path Forest (OPF). The result is a segmentation of grains from pore in sandstone thin section images and the separation of the touching grains automatically. This allows the study of grain morphology and sample porosity. The method consists of two major processes: first, a totally automatic image segmentation and second an user interaction to correct misclassified grains. The accuracy is computed comparing the corrected image by the user with the image segmented automatically. Another novel application presented in the work is the use of supervised classification based on OPF for classification of geophysical logging data from Campo de Namorado.\nKeywords: image segmentation, Image Foresting Transform, Optimum-Path Forest, lithofacies classication, supervised OPF classificator, grain morphology\nSum\u00e1rio\n1\tIntrodu\u00e7\u00e1o\n1\n1.1\tIntrodu\u00e7\u00e3o \u00e0 IFT e OPF...................................................\n2\n2 Lithofacies classification using Optimum-Path Forest method\t7\n2.1\tIntrodu\u00e7\u00e3o.................................................................. 8\n2.2\tMetodologia................................................................ 11\n2.3\tResultados................................................................. 13\n2.4\tConclus\u00f5es\n14\n2.5 Agradecimentos......................................................\n16\n3 Segmentation of sandstone thin section images with separation of touching grains\nusing optimum-path forest operators\t18\n3.1\tIntroduction............................................................ 19\n3.2\tMethods................................................................. 21\n3.2.1\tImage Foresting Transform........................................ 21\n3.2.1.1\tGraphs from images...................................... 21\n3.2.1.2\tConnectivity Functions.................................. 22\n3.2.1.3\tOptimum-path forest .................................... 22\n3.2.1.4\tClustering by optimum-path forest....................... 24\n3.2.1.5\tEuclidean distance transform............................ 26\n3.2.1.6\tSegmentation by inverted watershed ..................... 26\n3.2.2\tAutomatic Grain Image\tSegmentation Pipeline...................... 27\n3.2.3\tInteractive Correction\t................................. 28\n3.2.4\tEvaluation parameters............................................ 29\n3.3\tResults and discussion ................................................. 31\n3.4\tConclusions ............................................................ 37\n4\tAplicabilidade do m\u00e9todo de segmenta\u00e7\u00e3o autom\u00e1tica em an\u00e1lise morfol\u00f3gica dos\ngr\u00e3os\t39\n4.1\tIntrodu\u00e7\u00e3o............................................................. 39\n4.1.1\tDetermina\u00e7\u00e3o d\u00e3 forma do gr\u00e3o................................... 40\n4.1.2\tEstimativa de porosidade da rocha............................... 41\n4.2\tResultados e discuss\u00e3o................................................. 42\n4.3\tConclus\u00f5es............................................................. 51\n5\tReferencias Bibliogr\u00e1ficas\t53\nA\tImagens dos resultados da segmentacao automatica e correcoes interativas\t57\nB\tImagens dos contornos e eixos dos gr\u00e2os\t61\nC\tResultados para analise dos eixos dos gr\u00e3os\t65\nLista de Figuras\n1.1\tIFT ............................................................................ 4\n2.1\t(a) Grafo completo ponderado nas arestas para um determinado conjunto de treinamento. (b) \u00c1rvore Geradora M\u00ednina (MST) do grafo completo. (c) Prot\u00f3tipos escolhidos como sendo os elementos adjacentes de classes diferentes na MST (nos circulados). (d) Floresta de caminhos otimos resultante para a funcao de valor de caminho fmax e dois prot\u00f3tipos. Os identificadores (x, y) acima dos nos sao, respectivamente, o custo e o rotulo dos mesmos. \u00c1 seta indica o no predecessor no caminho \u00f3timo. (e) Uma amostra de teste (triangulo) da classe 2 e suas conex\u00f5es (linhas pontilhadas) com os n\u00f3s do conjunto de treinamento. (f) O caminho otimo do prototipo mais fortemente conexo, seu rotulo 2 e o custo de classificacao 0.4 sao associados a amostra de teste. Note que, mesmo a amostra de teste estando mais proxima de um no da\nclasse 1, ela foi classificada como sendo da classe 2 (Papa et al., 2009b). ...\t10\n2.2\tPerfis dos resultados da classificacao por OPF do poco NA07...................... 15\n2.3\tMatriz de confusao dos resultados da classificacao por OPF do\tpoco NA07. .\t15\n3.1\tSequence of image operations for grain determination............................. 20\n3.2\t(a) A 4-neighborhood graph with set of seeds M = {(0, 0), (2, 2)}, considering the origin (0, 0) of pixels coordinates (x, y) in top left and the numbers as arc weights. (b) An optimum-path forest P computed to the function fmax with two roots in S. The numbers inside the nodes show the optimum connectivity\nmap V(t) by Eq. 3.5 and the arrows indicate predecessor node P(t)............. 23\n3.3\t(a) Result of automatic segmentation with misclassification. (b) One grain\nmarker and two background markers to correct with DIFT-SC. (c) Correction segment with LWOF. (d) LM correction obtaining better delineation of grain shape......................................................................... 28\n3.4\tExamples of common misclassifications and their corrections. (a) The grain is split in two. The desired label is picked by a tool in the interface and the correction region is marked. (c) The two touching grains are segmented as one. The correction is analog the other, except the creation of a new label. (b)\nand (d) are the results after running DIFT-SC................................... 30\n3.5\t(a) Sample S1 - Input image of the porous sandstone, showing irregular grains\nof varied sizes and clayey matrix. (b) Three-cluster image, including background. (c) Grain binary mask from the brighter clusters. (d) Edges detected by stronger gradient of features Cb and Cr. (e) Combination of Euclidean IFT within grains and edges image. (f) Image of labeled grains. Each grain has its label as pixel values. (g) Original image combined with the image of labeled grain........................................................................... 33\n3.6\t(a) Sample S2 - Input image of the more compact sandstone. (b) Three-cluster image, including background. (c) Grain binary mask from the brighter clusters. (d) Edges detected by stronger gradient of features Cb and Cr. (e) Combination of Euclidean IFT within grains and edges image. (f) Image of labeled grains. Each grain has its label as pixel values. (g) Original image combined\nwith image of labeled grain. ................................................ 34\n3.7\t(a) Detailed image of grain segmented from the background and others grains.\n(b)\tImage with misclassifications corrected by Live Markers.................. 35\n3.8\t(a) Details of misclassification of rock fragments by automatic segmentation.\n(b) In the correction, DIFT-SC markers had a small leaking in (i) and (ii). LM\nneeded a little more interaction but the delineation was more precise in (iii) and (iv)....................................................................... 35\n3.9\tRelationship between automatic segmentation areas and interactive corrections area of sample S1 (a) and sample S2 (b).............................................. 37\n4.1\tDiagramas triangulares (a) as 10 classes descritivas definadas por Sneed and Folk (1958) C - Compact (Compacta), P - Platy (achatada), B - Bladed (laminada), E - Elongate (Alongada) e V - Very (Muito); (b) Isolinhas de Maxima Projecao de Esfericidade (MSP); (c) Isolinhas de \u00edndice de Oblato-Prolato.\nFiguras adaptadas de Benn e Ballantyne (1993)............................... 42\n4.2\t(a) Resultado da segmenta\u00e7ao automatica da Amostra S3. (b) Resultado da\ncorre\u00e7ao interativa da Amostra S3........................................... 43\n4.3\t(a) Resultado da segmentacao automatica da Amostra S6. (b) Resultado da\ncorrecao interativa da Amostra S6.......................................... 44\n4.4\tContorno dos graos e eixos das Amostras S3 (a) e S6 (b).................... 45\n4.5\tDiagramas de Zingg (1935) das amostras S3 (a) e S6 (b)..................... 46\n4.6\tDiagrama para determinacao de classes das amostras S3 (a) e S6 (b) segundo\ncriterio de classificacao de Sneed and Folk (1958)......................... 47\n4.7\tDiagrama de frequencia de Fator de Forma das amostras S3 (a) e S6 (b); Diagrama de frequencia da esfericidade das amostras S3 (c) e S6 (d)........... 48\n4.8\tDiagrama triangular do Indice Oblato-Prolato das amostras S3 (a) e S6 (c); Diagrama de frequencia dos respectivos \u00edndices Oblato-Prolato das amostras\nS3 (b) e S6 (d)............................................................ 49\n4.9\tDiagrama triangular do Indice MSP das amostras S3 (a) e S6 (c); Diagrama de\nfrequencia dos respectivos \u00edndices MSP das amostras S3 (b) e S6 (d)........ 50\nA.1 (a) Resultado da segmentacao automatica da Amostra S4 (b) Resultado da correcao interativa da Amostra S4.......................................... 58\nA.2 (a) Resultado da segmentacao automatica da Amostra S5 (b) Resultado da correcao interativa da Amostra S5.......................................... 59\nA.\t3 (a) Resultado da segmentacao automatica da Amostra S7 (b) Resultado da\ncorrecao interativa da Amostra S7.......................................... 60\nB.\t1 Contorno dos graos e eixos das amostras: (a) S1 (b) S2.................... 62\nB.\t2 Contorno dos graos e eixos das amostras: (a) S4 (b) S5 (c) S7............. 63\nC.\t1 Amostra S1 - Resultados das aplicacoes dos metodos para analise da forma\ndos graos: (a) Diagrama de Zingg (1935) (b) Diagrama triangular de Sneed &amp; Folk (1958) (c) Fator de forma F (d) Esfericidade.......................... 66\nC.2 Amostra S1 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) Indice Oblato-Prolato (b) Distribuyo do \u00edndice Oblato-Prolato\n(c)\tIndice MPS (d) Distribuyo do \u00edndice MPS..................................... 67\nC.3 Amostra S2 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) Diagrama de Zingg (1935) (b) Diagrama triangular de Sneed &amp; Folk (1958) (d) Fator de forma F (d) Esfericidade............................... 68\nC.4 Amostra S2 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) Indice Oblato-Prolato (b) Distribuyo do \u00edndice Oblato-Prolato\n(c) Indice MPS (d) Distribuyo do \u00edndice MPS................................ 69\nC.5 Amostra S4 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) Diagrama de Zingg (1935) (b) Diagrama triangular de Sneed &amp;\nFolk (1958) (c) Fator de forma F (a) Esfericidade.......................... 70\nC.6 Amostra S4 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) \u00edndice Oblato-Prolato (b) Distribuido do \u00edndice Oblato-Prolato\n(c) \u00edndice MPS (d) Distribuido do \u00edndice MPS............................... 71\nC.7 Amostra S5 - Resultados das aplicacoes dos metodos para analise da forma\ndos graos: (a) Diagrama de Zingg (1935) (b) Diagrama triangular de Sneed &amp; Folk (1958) (c) Fator de forma F (d) Esfericidade.......................... 72\nC.8 Amostra S5 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) \u00edndice Oblato-Prolato (b) Distribuido do \u00edndice Oblato-Prolato\n(c) \u00edndice MPS (d) Distribuido do \u00edndice MPS............................... 73\nC.9 Amostra S7 - Resultados das aplicacoes dos metodos para analise da forma\ndos graos: (a) Diagrama de Zingg (1935) (b) Diagrama triangular de Sneed &amp;\nFolk (1958) (c) Fator de forma F (d) Esfericidade.......................... 74\nC.10 Amostra S7 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) \u00edndice Oblato-Prolato (b) Distribuido do \u00edndice Oblato-Prolato\n(c) \u00edndice MPS (d) Distribuido do \u00edndice MPS............................... 75\nLista de Tabelas\n2.1\tAtributos utilizados para implementa\u00e7\u00e3o do classificador baseado em OPF. . .\t11\n2.2\tDescric\u00e3o das classes para classificac\u00e3o das rochas do Campo de Namorado\npelo metodo OPF.............................................................. 12\n2.3\tDistribuic\u00e3o das classes por poco............................................ 13\n2.4\tResultados obtidos das duas baterias de classificac\u00e3o........................ 14\n3.1\tComparative results after processes.......................................... 36\n3.2\tEvaluation parameters results................................................ 36\n4.1\tDescric\u00e3o das equacoes para estimativa da forma do gr\u00e3o de acordo com os tr\u00eas eixos maior (a), intermedi\u00e3rio (b) e menor (c). S\u00e3o utilizadas as relacoes\np = b/a e q = c/b............................................................ 40\n4.2\tClasses segundo as formas dos seixos segundo Zingg (1935)................ 41\n4.3\tDescric\u00e3o das imagens das amostras....................................... 42\n4.4\tMedidas de \u00e3cur\u00e3cia do metodo de segmentac\u00e3o autom\u00e3tica e correcoes.\t...\t44\n4.5\tDistribuic\u00e3o dos gr\u00e3os segundo criterio de classificac\u00e3o de Zingg\t(1935).\t...\t46\n4.6\tDistribuic\u00e3o dos gr\u00e3os segundo criterio de classificac\u00e3o de Sneed and Folk\n(1958) para as 7 amostras................................................ 47\n4.7\tPorosidade estimada...................................................... 50\nLista de abreviacoes\nANN - Artificial Neural Networks\nBC - Bayes Classifier\nCA - Cellular Automata\nDIFT-SC - Differential IFT with seed competition\nEDT - Euclidean Distance Transform\nGIS - Geographic Information Systems\nIFT - Image Foresting Transform k-NN - k-nearest neighbor\nLM - Live Markers\nLST - Level Sets\nLWOFLive Wire On-the-Fly\nMLP - Multi-Layer Perceptrons\nOPF - Optimum-Path Foresting\nPDE - Partial Differential Equations\nPDF - Probability Density Function\nSOM - Self-Organizing Maps\nSRG - Seed Region Growing\nUSIS - User-Steered Image Segmentation\nWGSE - Weight Grain Sub-division Error\nWGSE-global - Weight Grain Sub-division Error - global\n1\tIntrodu\u00e7\u00e3o\nA caracteriza\u00e7ao de reservat\u00f3rios e fundamental para a sua explora\u00e7ao, na qual a importancia da constru\u00e7ao do modelo influencia diretamente no plano de desenvolvimento e gerenciamento de um campo de petroleo ou gas (Deutsch, 2002). Para tal, e necessaria uma caracteriza\u00e7ao realista das propriedades dos flu\u00eddos e das rochas que compoem o reservat\u00f3rio (Maschio et al., 2008) e os metodos que determinam essas propriedades estao em constante aperfei\u00e7oamento e desenvolvimento. Dentre eles, a perfilagem geof\u00edsica e a analise petrof\u00edsica atuam somente apos a abertura do po\u00e7o e escalas diferentes, permitindo assim a obten\u00e7ao de testemunhos para a analise petrof\u00edsica e o deslocamento das ferramentas pelo po\u00e7o para aquisi\u00e7ao de dados de perfilagem (Miyoshi, 2010).\nA perfilagem geof\u00edsica registra as medidas geof\u00edsicas (perfis eletricos, acr\u00edsticos, radioativos, mecanicos, termicos, etc.) realizadas por deslocamento de sensores de perfilagem em po\u00e7os (Girao, 2006). A interpreta\u00e7ao dos dados permite inferir sobre propriedades de forma\u00e7ao (Girao, 2006) e de propriedades como tipos de facies, porosidade, permeabilidade, bem como informa\u00e7ao precisa das superf\u00edcies estratigr\u00e1ficas e das falhas (Deutsch, 2002). O grande vies da classifica\u00e7ao de litofacies e o processamento dos dados obtidos, existindo diversas tecnologias de inteligencia artificial, das quais podemos citar entre as mais difundidas e utilizadas as redes neurais artificiais (Artificial Neural Network - ANN: Self-Organizing Maps - SOM) (Haykin, 2001; Kohonen et al., 2001). Nesse sentido, foi realizado um estudo preliminar da aplica\u00e7ao do classificador baseado em Floresta de Caminhos (\u00d3timos (Optimum-Path Foresting - OPF) supervisionada Papa et al. (2009a) para a classifica\u00e7ao de litofacies.\nO cap\u00edtulo 2 apresenta o estudo realizado em dados de po\u00e7os do campo de Namorado com o classificador baseado em OPF proposto por Papa et al. (2009a). A aplica\u00e7ao do classificador foi realizada durante um estudo dirigido e posteriomente publicada no 12o Congresso Internacional da Sociedade Brasileira de Geof\u00edsica, em 2011.\nMudando para uma escala menor, a petrof\u00edsica esta intrinsicamente ligada a mineralogia e geologia pois a maioria do petroleo do mundo ocorre em rochas sedimentares porosas. A precisao da analise petrof\u00edsica e imprescind\u00edvel para a previsao do comportamento dos flu\u00eddos na rocha (Tiab and Donaldson, 2004). Ela pode ser definida como o estudo das propriedades das rochas e suas intera\u00e7\u00f5es com fluidos (gases, hidrocarbonetos l\u00edquidos e solu\u00e7\u00f5es aqu-\nosas). A descri\u00e7\u00e3o das rochas sedimentares pode ser determinada por caracter\u00edsticas do gr\u00e3o, como forma, esfericidade, textura, tamanho, distribuicao, orientacao e grau de compactacao. A combinacao destas variaveis podem induzir informacoes sobre os processos diageneticos e mecanismos de transporte, deposicao, compactacao e deformacao. E em alguns casos ainda e poss\u00edvel fornecer informacoes sobre a permeabilidade e porosidade (Tiab and Donaldson, 2004).\nDesse modo, a principal motivacao deste trabalho e adaptar a Transformada Imagem Floresta (Image Foresting Transform - IFT) descrita em Falcao et al. (2004), uma tecnica eficiente de segmentacao de imagens, para automatizar e melhorar a qualidade da analise petrof\u00edsica. O estudo desse metodo aplicado a rochas de arenito e apresentado na forma de artigo submetido a revista Computer &amp; Geosciences em outubro de 2012, no cap\u00edtulo 3. Na sequencia, o cap\u00edtulo 4 apresenta poss\u00edveis aplicacoes dos resultados em diversas tecnicas de analise da forma do grao.\n1.1\tIntrodu\u00e7\u00e3o \u00e0 IFT e OPF\nA segmentacao de imagens consiste em separar a informacao de interesse de uma imagem para torna-la compreens\u00edvel e permitir a analise. As tecnicas basicamente procuram por objetos e bordas, agrupando e rotulando os pixels definidos a partir de certas caracter\u00edsticas. Diversas tecnicas tem sido desenvolvidas nessa area nas ultimas decadas em diversas areas da ciencia. O maior desafio e obter metodos totalmente automaticos de segmentacao de imagens naturais, pois a maioria deles requer a intervencao do usuario em alguma etapa do processamento, por menor que seja. A limitacao e devido aos humanos serem muito superiores na tarefa de reconhecimento de objetos e os computadores muito superiores no delineamento. Uma maneira de contornar essa limitacao e o conhecimento pr\u00e9vio do objeto a ser segmentado, porem isso nem sempre e poss\u00edvel, pois os objetos nem sempre tem o mesmo padr\u00e2o de cor, formato ou de aquisicao da imagem (Falcao et al., 1998).\nAs tecnicas de segmentacao de graos em imagens de rochas mostram avancos significativos. Podemos citar as tecnicas desenvolvida por Van de Berg et al. (2002), Seed Region Growing - (SRG) (Choudhury et al., 2006), Level Sets - (LST) (Lu et al., 2009), Partial Differential Equations - (PDE) (Lu and Ning, 2010), Geographic Information Systems - (GIS) (Choudhury et al., 2006; Li et al., 2008; Gorsevski et al., 2012), e Cellular Automata (CA) (Gorsevski et al., 2012).\nA aplica\u00e7\u00e3o de novas t\u00e9cnicas desenvolvidas em outras \u00e1reas da ci\u00eancia visa reduzir as incertezas e riscos gerados pelos metodos na construcao dos modelos. A tecnica de segmentacao de imagens IFT tem se mostrado bastante eficiente, com aplicacoes em diversas areas, como medicina (Suzuki et al., 2012; Yu et al., 2012), reconhecimento facial (Chiachia et al., 2011), metalografia (Papa et al., 2012), e outras.\nA IFT e uma ferramenta geral para projetar, implementar e avaliar operadores de imagens baseados em conectividade dos pixels adjacentes. O algoritmo utilizado para o calculo da IFT e basicamente uma generalizacao do algoritmo de Dijkstra (Dijkstra, 1959) para caminhos mais curtos, levemente adaptado para fontes multiplas e funcoes de custo de caminhos suaves. A imagem e interpretada como um grafo, onde os pixels sao os nos e os arcos dos grafos sao definidos por uma relacao de adjacencia entre os pixels. Grafos podem ser definidos como uma estrutura matematica utilizada para modelar relacoes entre objetos de um certo conjunto. O custo de um caminho no grafo e determinado por uma funcao que depende das propriedades locais da imagem ao longo do caminho, como cor, gradiente e posicao do pixel.\nO algoritmo inicia com caminhos triviais (somente um unico pixel ligado a ele mesmo) propagando-se a partir das ra\u00edzes, gerando uma competicao para conquistar os pixels remanescentes. A conquista e feita quando o custo do caminho e menor (ou maior) do pixel a ra\u00edz, ficando o pixel atribu\u00eddo a essa ra\u00edz. A Figura 1.1-a e uma representacao de um grafo, onde o pixel t esta ligado pelo caminho P(t) a ra\u00edz P0(t). O processo exemplificado na Figura 1.1-b representa uma imagem 2D em escala de cinza, onde os valores sao os pixels (nos) da imagem e os tr\u00eas c\u00edrculos maiores sao as ra\u00edzes.\nFigura 1.1: (a) Os elementos principais da floresta geradora. (b) Um grafo de imagem 2D com adjac\u00eancia 4-conexos, onde os inteiros sao os valores I(t) da imagem. (c) Uma floresta de caminhos otimos para a funcao de custo m\u00ednimo, restritos aos tres pixels sementes representados pelos pontos maiores (Falcao et al., 2004).\nAs ra\u00edzes da floresta surgem a partir de um conjunto de pixels escolhidos como sementes e estao representadas com c\u00edrculos maiores na Figura 1.1-b. Inicialmente, a IFT atribui um caminho de custo m\u00ednimo das sementes a cada pixel da imagem para determinar as funcoes de custo m\u00ednimo, de modo que a uniao destes caminhos e uma floresta orientada se propagando pela imagem toda, ou seja, a IFT define uma floresta de caminhos de custos m\u00ednimos em um grafo. O resultado apresentado na Figura 1.1-c e denominado OPF.\nO algoritmo determina como resultado tr\u00eas atributos a cada pixel: o pixel predecessor no caminho otimo, o custo deste caminho e a sua ra\u00edz correspondente (ou algum rotulo associado ao pixel). Uma grande variedade de operadores de imagens pode ser implementada atraves de um simples processamento local destes atributos.\nA tecnica de classificacao supervisionada baseada em OPF modela as amostras como sendo um grafo completo. Os elementos mais representativos de cada classe sao denominados prot\u00f3tipos, e sao escolhidos nas regioes de sobreposicao e de fronteiras entre as classes, pois estas regioes sao muito mais propensas a erros de classificacao. Durante o processo de treinamento, os prot\u00f3tipos competem pelas amostras oferecendo o caminho de menor custo e seus respectivos rotulos, gerando uma OPF. Os benef\u00edcios dessa abordagem em relacao a outros metodos de classificacao supervisionada sao a independencia de par\u00e2metros, permissao de tratamento nativo de problemas multiclasses e a nao dependencia da forma ou separabilidade entre as classes Papa et al. (2009a).\nO objetivo da segmentacao de imagens e separar objetos da imagem para permitir sua analise. A separacao pode ser realizada utilizando a IFT para particionar a imagem em zonas de influencia, onde a zona de cada semente consiste no conjunto de pixels mais fortemente ligados a esta semente do que a qualquer outra. Estas zonas de influencia sao simplesmente as arvores da floresta definida pela IFT (Falcao et al., 2004). Um processo utilizado para este fim e denominado agrupamento - identificacao de grupos naturais de amostras de um conjunto de dados - e pode ser realizado pelo classificador OPF nao-supervisionado (Rocha et al., 2009) em amostras de pixels da imagem com seus correspondentes vetores de atributos. O problema consiste em identificar as altas concentracoes de amostras, as quais podem caracterizar os grupos relevantes para a aplicacao. Desse modo, os grupos naturais podem ser detectados e separados, pois sao caracterizados pelas altas concentracoes de amostras no espaco de atributos, formando domos da funcao de densidade de probabilidade (probability density function -PDF) (Rocha et al., 2009). A deteccao dos grupos naturais e realizada por uma busca exaustiva, calculando a pdf para uma relacao de adjacencia dos k-vizinhos proximos (k-nearest neighbor - k-nn) a partir de um kmin ate um kmax, procurando o k que otimiza a PDF, isto e, onde os pixels similares forem mais proximos, a pdf e maxima. A determinacao do melhor valor do\n1. INTRODU\u00c7\u00c3O k considera o corte m\u00ednimo no grafo, provida pelos resultados do processo de agrupamento, considerando os pesos dos arcos entre os agrupamento e os demais.\nO metodo proposto para segmentar os gr\u00e2os na imagem consiste de dois processos principais, baseados em IFT: segmentacao automatica de imagem com graos em contato e correcoes interativas dos erros de classificacao.\nO processo de segmentacao automatica tem como princ\u00edpio separar os graos do fundo primeiramente e entao a separacao dos graos em contato entre eles mesmos. Para isso, o processo utiliza o algoritmo da IFT em tr\u00eas passos: no primeiro passo e feito o agrupamento baseado na similaridade de cor, o que permite gerar uma mascara de graos binaria da imagem original, ja que os graos estao nos grupos com os pixels mais claros. A mascara e utilizada para a deteccao das bordas dos graos. O segundo passo consiste em calcular a Transformada de Distancia Euclidiana (Euclidean Distance Transform - EDT) propagando para dentro do graos a partir das bordas dos graos. Isso gera uma imagem de domos cujos picos sao utilizados no terceiro passo para separar os graos com uma transformada watershed invertida.\nO metodo watershed pode ser simplificado por um fechamento de bacias com volume abaixo de um threshold, e no caso watershed invertida, pode ser controlada pela abertura dos domos acima de um threshold. A separacao dos graos e feita ao permitir a competicao entre as sementes em cada domo, entendendo como distintos os grafos das sementes quando encontram o grafo de outra semente, atribuindo diferentes rotulos para cada semente, que no caso, os graos ficam rotulados e distintos. Como resultado, tem-se uma imagem de rotulos dos graos, onde o valor do pixel corresponde ao rotulo do gr\u00e2o.\nApesar do processo anterior ter como objetivo a segmentacao completamente automatica, eventuais erros de classificacao ocorrem e podem ser corrigidos por uma interface grafica adaptada para este problema. A segmentacao de imagens guiada pelo usuario (user-steered image segmentation - USIS) permite as correcoes dos erros de classificacao que ocorrem em fragmentos de rocha, vazamentos de segmentacao de graos em contato com matriz, e divisao de graos maiores em outros menores ou graos pequenos serem interpretados como um gr\u00e2o unico. A interface utiliza a ferramenta Live Markers baseada em IFT que trabalha apenas na regiao em que foram usados marcadores, trocando as posicoes das sementes originais do processo automatico de acordo com a decisao do especialista, gerando uma competicao apenas entre essas sementes, sendo computacionalmente muito r\u00e2pido, gerando uma visualizacao do resultado quase em tempo real. Porem, a correcao de uma imagem com cerca de 500 graos demanda tempo do operador para verificar quais graos necessitam de correcoes e corrig\u00ed-las. Essa opcao da interface de correcao oferece a possibilidade de obter uma imagem tao precisa quanto seja desejado ou necessario. Outro prop\u00f3sito da interface e gerar uma imagem\npadr\u00e3o para servir de refer\u00eancia para medidas de acur\u00e1cia do processo autom\u00e1tico. Como dito anteriormente, o estudo realizado apresenta-se no cap\u00edtulo 3.\n2\tLithofacies classification using Optimum-Path Forest method\nAuthors: Ivan Mingireanov Filho, Alexandre Campane Vidal\nAbstract\nPattern classification aims to find the label of each sample using a feature vector in dataset samples. As traditional methods usually do, the learning process distributes samples into different labels using a training subset and determines rules to decide the classification of each subset. The pattern recognition algorithm, based in Optimum-Path Forest (OPF) used here, models the problem like a graph. In this graph the nodes are the samples and the arcs are defined by some adjacency relation, the most relevant samples are called prototypes. A competition process among samples starts offering optimum-path costs to the remaining dataset samples. Using the complete graph in adjacency relation the competition becomes global, not based only in local geometry as traditional methods. The search is done finding the prototypes samples that belongs to overlap regions and boundaries between the labels in the training set. These regions are very susceptible to misclassification. The prototypes samples offer optimum-path cost computed as the maximum path arc-weight between these prototypes and the other dataset samples. These arc-weights are computed by the distance between their features vectors. The goal of this work is validate the OPF method classifying non-cored wells information set, from Campo de Namorado, in Bacia de Campos, RJ, freely available by National Petroleum Agency (ANP). The dataset is composed by 5 attributes for each depth, totaling 4732 samples, which 1950 are core samples. The results show the time spent on both, training and classification process. They were very short always less than 1 second. In crossvalidation, 87,1% of the core samples maintained their label. The average accuracy computed to each well was 64,8%, and using all core samples in training process the accuracy was 76,8%. These results suggest a new approach suitable to process a large volume dataset in a short time, being an alternative for non-cored wells classification.\n2.1\tIntroducao\nO metodo de classificac\u00e3o por Floresta de Caminhos (\u00d3timos (OPF) e baseado na Transforma Imagem Floresta (IFT), uma ferramenta geral para modelar, implementar e avaliar operadores baseados em conexidade Falc\u00e3o et al. (2004), reduzindo o problema de classificac\u00e3o ao c\u00e3lculo de uma floresta de caminhos otimos em um grafo derivado do conjunto de dados das amostras. O valor de um caminho e normalmente calculado por uma func\u00e3o dependente dos atributos e da posic\u00e3o do atributo ao longo do caminho do grafo (Papa et al., 2009b).\nPara utilizac\u00e3o do classificador baseado em OPF com aprendizado supervisionado, o mod-elamento do problema de reconhecimento de padroes e considerado como um problema de OPF em um grafo definido no espaco de atributos, onde os nos s\u00e3o as amostras, as quais s\u00e3o representadas pelos seus respectivos vetores de atributos, e os arcos s\u00e3o definidos de acordo com uma relac\u00e3o de adjacencia pr\u00e9-estabelecida. Tanto os nos quanto os arcos podem ser ponderados por alguma metrica de dist\u00e3ncia aplicada a seus vetores de atributos, diferente dos metodos tradicionais por n\u00e3o utilizar apenas a ideia de geometria do espaco de atributos, permitindo melhores resultados em bases com outliers e sobreposic\u00e3o de classes. Diversas funcoes de custo podem ser empregadas para particionar o grafo em \u00e3rvores de caminhos otimos, as quais s\u00e3o enraizadas pelos seus respectivos prot\u00f3tipos (sementes) na fase de treinamento. O rotulo de uma amostra a ser classificada e o mesmo do prototipo mais fortemente conexo a ela. A abordagem adotada utiliza o grafo completo como relac\u00e3o de adjacencia. Durante a fase de treinamento, assume os elementos que pertencem \u00e3 intersecc\u00e3o entre as classes no conjunto de treinamento como os elementos mais representativos de cada classe (Papa et al., 2009b).\nOs prototipos participam de um processo de competic\u00e3o disputando as outras amostras oferecendo-lhes caminhos de menor custo e seus respectivos rotulos. Ao final deste processo, obtem-se um conjunto de treinamento particionado em \u00e3rvores de caminhos otimos, sendo que a uni\u00e3o das mesmas nos remete a uma floresta de caminhos otimos. Esta abordagem apresenta v\u00e3rios benef\u00edcios com relac\u00e3o a outros metodos de classificac\u00e3o de padroes supervisionados: (i) e livre de par\u00e3metros, (ii) possui tratamento nativo de problemas multiclasses e (iii) n\u00e3o faz alus\u00e3o sobre forma e/ou separabilidade das classes (Papa et al., 2009b).\nO algoritmo OPF com grafo completo tem sido amplamente utilizado em diversas aplicacoes, tais como avaliac\u00e3o de descritores de textura, diagnostico autom\u00e3tico de patologias na laringe e classificac\u00e3o de impressoes digitais (Papa et al., 2009b). Essas aplicacoes fundamentam a aplicac\u00e3o em dados de pocos para classificac\u00e3o da litologia.\nA fase de treinamento do classificador baseado em OPF usando o grafo completo consiste em encontrar o conjunto S de prot\u00f3tipos, ou seja, os elementos mais representativos de cada classe. Essa escolha pode ser de varias maneiras heur\u00edsticas, inclusive, por uma escolha aleatoria de prototipos. Entretanto, tal escolha pode prejudicar o desempenho do classificador, tornando-o instavel e com um alto grau de sensibilidade com relacao aos prot\u00f3tipos escolhidos. Deseja-se estimar os prototipos nas regioes de sobreposicao de amostras e nas fronteiras entre as classes, visto que sao regi\u00f5es muito suscept\u00edveis a erros de classificacao. Outra tecnica que pode ser abordada e a utilizacao do grafo k-vizinhos mais proximos (k-NN), onde estima estes prototipos nos pontos de alta concentracao de amostras (Papa et al., 2009b).\nCalculando uma arvore m\u00ednima geradora (MST) no grafo completo (Z1, A) (Figura 2.1a), obtemos um grafo conexo ac\u00edclico cujos nos sao todas as amostras em Z1, e os arcos sao nao direcionados e ponderados, Figura 2.1(b). Seus pesos sao dados pela distancia d entre os vetores de atributos de amostras adjacentes. Esta arvore de espalhamento e otima no sentido em que a soma dos pesos de seus arcos e m\u00ednima se comparada a outras arvores de espalhamento no grafo completo. Os prototipos a serem escolhidos sao os elementos conectados na MST com diferentes rotulos em Z1, ou seja, elementos mais proximos de classes diferentes, Figura 2.1(c). Removendo-se os arcos entre classes diferentes, tais amostras adjacentes tornam-se prototipos em S e pode-se computar uma floresta de caminhos otimos em Z1, Figura 2.1(d). Nota-se que uma dada classe pode ser representada por multiplos prototipos e deve existir pelo menos um prototipo por classe. A ideia consiste em ponderar os arcos entre amostras de diferentes classes com um valor muito alto, impossibilitando assim que os prototipos de uma classe conquistem elementos de outras classes (Papa et al., 2009b).\nPara a classificacao, todos os arcos sao considerados conectando a amostra teste com as amostras do grafo original, onde na Figura 2.1(d) esta representado pelo triangulo. Considerando todos esses poss\u00edveis caminhos, desejamos encontrar o caminho otimo com a classe de seu prototipo mais fortemente conexo. Assim, a classificacao simplesmente associa a amostra a classe que satisfaz essas condicoes, Figura 2.1(e). Vale ressaltar que, embora a amostra a ser classificada esteja mais proxima de um elemento de classe bola, Figura 2.1(c), a mesma e\u00ed classificada como sendo da classe quadrado, o que demonstra que os classificadores baseados em OPF utilizam a forca de conexidade entre as amostras para a classificacao dos dados, ou seja, nao sao algoritmos baseados em conexidade local apenas como, por exemplo, os classificadores de redes neurais artificiais (ANN) (Hecht-Nielsen, 1990; Bishop, 1994) e k-vizinhos proximos (k-NN) (Papa et al., 2009b).\n(c)\n(d)\t(e)\n(f)\nFigura 2.1: (a) Grafo completo ponderado nas arestas para um determinado conjunto de treinamento. (b) Arvore Geradora M\u00ednina (MST) do grafo completo. (c) Prot\u00f3tipos escolhidos como sendo os elementos adjacentes de classes diferentes na MST (nos circulados). (d) Floresta de caminhos \u00f3timos resultante para a funcao de valor de caminho fmax e dois prototipos. Os identificadores (x, y) acima dos nos sao, respectivamente, o custo e o rotulo dos mesmos. A seta indica o no predecessor no caminho otimo. (e) Uma amostra de teste (triangulo) da classe 2 e suas conex\u00f5es (linhas pontilhadas) com os nos do conjunto de treinamento. (f) O caminho otimo do prototipo mais fortemente conexo, seu rotulo 2 e o custo de classificacao 0.4 sao associados a amostra de teste. Note que, mesmo a amostra de teste estando mais proxima de um no da classe 1, ela foi classificada como sendo da classe 2 (Papa et al., 2009b).\nO classificador baseado em OPF com grafo completo assemelha-se ao algoritmo vizinho mais proximo (k-NN) somente no caso onde todos os elementos do conjunto de treinamento sao considerados prototipos, sendo este um caso at\u00edpico onde, certamente, o conjunto de atributos escolhido nao foi o mais adequado para a representacao do conjunto de dados. Outra diferenca a ser considerada e que os classificadores ANN e k-vizinhos mais proximos (k-NN) tomam uma decisao local para a classificacao dos dados, ao contrario dos classificadores baseados em OPF, os quais possibilitam uma solucao em ambito global, criando uma floresta\nde caminhos \u00f3timos que mapeia, para cada amostra do conjunto de dados, o caminho otimo entre ela e o seu prototipo mais fortemente conexo (Papa et al., 2009b).\nO objetivo do presente trabalho foi classificar um conjunto de informacoes de pocos nao-testemunhados utilizando o metodo de classificacao supervisionada de padroes por floresta de caminhos \u00f3timos, com validacao cruzada.\n2.2\tMetodologia\nFoi utilizado um conjunto de informacoes de diferentes atributos referentes ao Campo de Namorado, da Bacia de Campos, RJ, disponibilizado livremente pela Agencia Nacional de Petroleo (ANP). Dentre todas as informacoes fornecidas, foram utilizados 5 atributos, de acordo com a tabela 2.1.\nTabela 2.1: Atributos utilizados para implementacao do classificador baseado em OPF.\nAtributos Avaliados\tSigla\tAplicacao\nDensidade\tRHOB\tDeteccao de raios gamas defletidos pelos eletrons pro uma fonte situada dentro de um poco\nPorosidade\tNPHI\tMedida de quantidade de neutrons da rocha\nNeutr\u00f4nica\t\tapos o bombardeio\nSonico\tDT\tMedida da diferenca dos tempos de transito de uma onda mecanica atraves das rochas\nInducao\tILD\tLeitura aproximada da resistividade\nRaio Gama\tGR\tDeteccao da radioatividade total da formacao geologica\nO conjunto de dados contem informacoes medidas dos atributos de 7 pocos, em funcao da profundidade, no total de 4732 amostras, das quais 1950 possuem testemunho, ou seja 41,2% do total. \u00c9 um conjunto privilegiado pela quantidade de testemunhos dos pocos, pois normalmente esse numero e bem menor, nao ultrapassando os 20% do total, devido ao alto custo e dificuldade de gerar os testemunhos. Para a classificacao, de acordo com o interesse do trabalho proposto, as facies foram agrupadas em quatro classes, de acordo com a tabela 2.2. Sao essas rochas sem testemunho o objetivo de classificacao pelo o metodo OPF, totalizando de 2782 amostras.\nTabela 2.2: Descri\u00e7\u00e3o das classes para classifica\u00e7\u00e3o das rochas do Campo de Namorado pelo m\u00e9todo OPF.\nClasses\tDescricao\n1 2 3\tRochas Reservat\u00f3rios Rochas Poss\u00edvel Reservat\u00f3rio Rochas Nao Reservat\u00f3rio Rochas Sem Testemunho\nAs informa\u00e7\u00f5es foram separadas para cada um dos 7 po\u00e7os, de acordo com a tabela 2.3, e foram realizadas duas baterias de classifica\u00e7ao apos o treinamento do algoritmo, utilizando o algoritmo 3 - Classificador Supervisionado baseado em Floresta de Caminhos (\u00d3timos usando grafo completo, disponibilizado em linguagem C para utilizacao em plataforma Linux em www.ic.unicamp.br/~afalcao/LibOPF (Papa et al., 2009b).\nTabela 2.3: Distribuyo das classes por poco.\nPoco\tClasse\tClasse\tClasse\tSem\tTotal de\n\t1\t2\t3\tTestemunho\tAmostras\nNA1A\t4,76%\t3,13%\t1,75%\t90,36%\t799\nNA02\t9,26%\t0,93%\t6,17%\t83,64%\t648\nNA04\t25,65%\t5,34%\t24,61%\t44,41%\t581\nNA07\t10,59%\t6,98%\t29,07%\t53,36%\t774\nNA11A\t6,49%\t1,40%\t90,53%\t1,58%\t570\nRJS234\t1,47%\t0,00%\t51,54%\t46,99%\t747\nRJS42\t16,31%\t2,77%\t1,47%\t79,45%\t613\nA primeira bateria foi feita apenas com as informacoes de cada poco, individualmente, utilizando metade dos dados de rochas com testemunhos do poco para treinar o classificador. Na sequencia, foram classificados os dados sem testemunhos juntos com a outra metade de dados com testemunhos, para validacao cruzada.\nA segunda bateria agrupou todos os 1950 dados de rochas com testemunhos para treinamento, e classificou os dados sem testemunhos e metade dos dados com testemunhos, individualmente para cada um dos 7 pocos. Ou seja, a diferenca entre as duas baterias de classificacao foi na fase de treinamento, onde a segunda utiliza todo o conjunto de informacoes dos testemunhos, com o intuito de melhorar esta fase pela quantidade de informacoes maior, mantendo o conjunto de classificacao e de validacao cruzada.\n2.3\tResultados\nOs resultados obtidos foram bastante satisfat\u00f3rios em ambas as baterias. Na bateria 1, a classifica\u00e7ao das amostras sem testemunhos foi feita apos treinamento do algoritmo com metade das amostras com testemunhos e a outra metade com as classes agrupada com as amostras sem testemunhos. Por essa validacao cruzada, algumas dessas amostras com testemunhos foram reclassificadas, alterando a classe original, e outras se mantiveram. Os numeros absolutos e percentuais das amostras que mantiveram a classe e das amostras que foram alteradas de classe estao apresentados a seguir na 2.4.\nAinda nessa bateria, sao apresentadas as medidas de acuracia, que o proprio algoritmo determina. A acuracia utiliza em sua funcao um erro calculado quando a amostra a ser rotulada nao recebe o rotulo determinado corretamente no treinamento. Quanto menor for este erro, maior sera a acuracia.\nTabela 2.4: Resultados obtidos das duas baterias de classifica\u00e7\u00e3o.\n\tMantiveram\t\tBateria 1\t\t\tBateria 2 Acuraria\n\t\t\tAlteraram\t\tAcuracia\t\nNA1A\t23\t60,5%\t15\t29,5%\t59,0%\t75,1%\nNA02\t49\t92,4%\t4\t7,6%\t69,7%\t75,7%\nNA04\t138\t85,7%\t23\t14,3%\t71,9%\t78,4%\nNA07\t145\t80,5%\t35\t19,5%\t66,5%\t77,3%\nNA11A\t262\t93,6%\t18%\t6,4%\t67,6%\t85,3%\nRJS234\t192\t96,9%\t6\t3,1%\t53,6%\t75,9%\nRJS42\t53\t84,1%\t10\t15,9%\t65,6%\t68,6%\nJa na bateria 2, foram utilizadas todas as 1950 amostras com testemunhos de todos os pocos na fase de treinamento, para realizar um treino com um banco de dados maior. A classificacao foi realizada como na bateria 1, isto e, os dados a serem classificados eram as amostras sem testemunhos agrupados com a outra metade das amostras com testemunhos. Por isso, ao analisar a validacao cruzada, nao foi detectada nenhuma alteracao nas amostras com testemunhos, pois estas amostras ja estavam contidas no conjunto de treinamento. Mas, como esperado, ao utilizar um conjunto maior de treinamento, a tendencia do elemento mais representativo da classe ser escolhido durante a competicao e maior, diminuindo o erro, aumentando significativamente a acuracia. O perfil de classificacao deste poco pode ser observado na Figura 2.2. A matriz de confusao do poco NA07 e apresentada na Figura 2.3, onde 89,75% dos rotulos foram mantidos.\nFigura 2.2: Perfis dos resultados da classifica\u00e7\u00e3o por OPF do po\u00e7o NA07.\nTreinamento\n\t1\t2\t3\t\n1\t73 20.22%\t1 0.28%\t6 1.66%\t91.3% 8.75*\n2\t2 0.55%\t40 11.08%\t11 3.05%\t75.5% 24.53%\n3\t7 1.94%\t10 2.77%\t211 58.45%\t92.5% 7.46%\n\t89.02% 10.98*\t78.43% 21.57*\t92.54% 7.48*\t39.75%\nFigura 2.3: Matriz de confusao dos resultados da classifica\u00e7ao por OPF do po\u00e7o NA07.\n2.4\tConclus\u00f5es\nO metodo de classificacao supervisionada de padroes baseada em Floresta de Caminhos (\u00d3timos (Papa et al., 2009b) utilizado nesse trabalho para classificacao de dados de pocos, mostrou-se ser um metodo simples, r\u00e1pido e eficiente.\nForam feitas duas baterias de treinamento e classificacao: a bateria 1 resultou em acur\u00e1cia media de cerca de 64,8% e apresentou a manutencao de 87,1% das classes originais na validacao cruzada utilizando metade das amostras de treinamento. Na bateria 2 foi utilizado todo o conjunto de amostras com testemunhos para treinamento e a acur\u00e1cia media aumentou para cerca de 76,8%.\nO metodo apresenta tambem algumas qualidades interessantes, como nao necessitar de que o numero de classes das amostras seja igual. Isso pode ser confirmado ja que alguns pocos apresentavam um n\u00famero muito pequeno de amostras de certa classe e em alguns casos nao possu\u00edam nenhuma amostra.\n2.5\tAgradecimentos\nGostar\u00edamos de agradecer a Agencia Nacional de Petroleo (ANP) pela disponibilizacao dos dados para estudos e pelo apoio financeiro.\n3\tSegmentation of sandstone thin section images with separation of touching grains using optimum-path forest operators\nAuthors: Ivan Mingireanov Filho, Alexandre Campane Vidal,\nAlexandre Xavier Falcao, Thiago Vallin Spina\nAbstract\nThe segmentation of detrical sedimentary rock images is still a challenge for characterization of grain morphology in sedimentary petrography. We propose a fast and effective approach that first segments the grains from pore in sandstone thin section images and separates the touching grains automatically, and second lets the user to correct the misclassified grains with minimum interaction. The method is mostly based on the image foresting transform (IFT) \u2014 a tool for the design of image operators using optimum connectivity. The IFT interprets an image as a graph, whose nodes are the image pixels, the arcs are defined by an adjacency relation between pixels, and the paths are valued by a connectivity function. The IFT algorithm transforms the image graph into an optimum-path forest and distinct image operators are designed by suitable choice of the IFT parameters and attributes of that forest. The solution involves a sequence of three IFT-based image operators for automatic segmentation and the interactive segmentation combines region- and boundary-based object delineation using two IFT operators. Tests with thin section images of two different sandstone samples have shown very satisfactory results, yielding r2 and accuracy parameters of 0.8712 and 94.8% on average, respectively. Biases were the presence of the matrix and rock fragments.\n3.1\tIntroduction\nThe morphology of grains is important to the textural characterization of detritical sedimentary rocks. Grain properties such as roundness and sphericity, for instance, allow us to\n3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION\nOF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS\ninfer information about provenance and transport. However, touching grains and the high variability of grain shapes in a single rock make the problem very challenging for automatic image analysis (Ehrlich and Chin, 1980).\nMany techniques have been proposed to automate the characterization of grain morphology in sandstone thin section images. However, the accuracy of the automatic image segmentation methods (Van de Berg et al., 2002; Choudhury et al., 2006; Lu et al., 2009; Gorsevski et al., 2012) has been severely compromised by the presence of touching grains, despite the large number of distinct strategies based on: Partial Differential Equations (PDE) (Lu and Ning, 2010), Level Sets (LST) (Lu et al., 2009), Seed Region Growing (SRG) (Choudhury et al., 2006), Geographic Information Systems (GIS) using arcGIS ModelBuilder to combine images (Choudhury et al., 2006; Li et al., 2008; Gorsevski et al., 2012), and cellular automata (CA) (Gorsevski et al., 2012).\nIndeed, automatic segmentation remains a challenge in most image processing applications. The absence of previous knowledge about the object under segmentation very often makes user intervention a necessity (Dengiz et al., 2005; Choudhury et al., 2006; Lu et al., 2009). We may divide the image segmentation process into two tightly coupled tasks: object recognition (location and verification) and delineation. While humans are superior than computers in recognition, computers are able to do precise delineation even when inaccurate. Therefore, the aim of semi-automatic image segmentation methods is usually to minimize the time spent by the user and amount of interaction required for delineation, while maximizing the accuracy and precision of segmentation (Falcao et al., 1998; Spina et al., 2011a).\nWe propose a grain image segmentation method consisting of two major components: automatic image segmentation of touching grains and interactive correction of the misclassifications using Live Markers (LM) (Spina et al., 2011b). Both parts of our method are based on the Image Foresting Transform (IFT) (Falcao et al., 2004) \u2014 a tool for the design of image operators using optimum connectivity. The IFT interprets an image as a graph, whose nodes are the image pixels, the arcs are defined by an adjacency relation between pixels, and the paths are valued by a connectivity function. The IFT algorithm transforms the image graph into an optimum-path forest and distinct image operators are designed by suitable choice of the IFT parameters and attributes of that forest.\nOur strategy is first to segment the grains from the darker background and separate touching grains automatically (Figure 3.1). Our automatic grain segmentation method can be divided into three steps, each using a distinct IFT-based image operator. First, we use clustering based on color similarity to output a binary segmentation mask from the grain image, by considering the clusters with brighter pixels as representative of the grains. Then, we compute\n3.\tSEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION\nOF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS\nImage input\nFigure 3.1: Sequence of image operations for grain determination.\nan Euclidean distance transform (EDT) constrained to propagate inwards from the connected grains\u2019 boundaries. The resulting image has domes with peaks inside each grain, which are used to split the grains through a controlled inverted watershed transform (i.e., this IFT outputs an image that assigns a unique grain label to every pixel).\nLive Markers is an IFT-based method for effective user-steered image segmentation (Spina et al., 2011b). LM allows fine corrections of our automatic approach result by giving the user tight control over the selection of where to do the adjustments. We also use LM to generate ground-truth images to be compared with the automatically segmented image (Choudhury et al., 2006; Falcao et al., 1998; Spina et al., 2011a). We measure the effectiveness of our method by considering our results\u2019 accuracy with respect to the ground-truths (Papa et al., 2009b) and the amount of the user\u2019s effort required for correction (Spina et al., 2011a).\nThis paper is organized as follows. We detail our method in Section 3.2. Section 3.3 presents our results and Section 3.4 states conclusion remarks.\n3.2\tMethods\nIn the folowing sections, we first describe the IFT and the image processing operators we use in our automatic grain segmentation method. Then, we describe the automatic segmentation pipeline and how to use Live Markers for interactive correction. Since we allow interactive intervention, we measure the method\u2019s accuracy according to the measures proposed in (Spina et al., 2011a) and (Papa et al., 2009b), respectively.\n3.\tSEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION\nOF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS\n3.2.1\tImage Foresting Transform\nThe Image Foresting Transform (IFT) is a generalization of Dijkstra\u2019s algorithm (Dijkstra, 1959) which handles multiple sources and more general connectivity functions Falcao et al. (2004). The IFT algorithm works by computing an optimal partition of the graph into sets of nodes (forest), where each set is a tree of optimum paths whose nodes are most strongly connected to the root of their tree (minima/maxima of the optimum connectivity map) than to any other.\nThe IFT algorithm starts with trivial paths for all the nodes, and propagates optimum paths from the roots by forcing them to compete for the remaining nodes of the graph. The process follows a non-decreasing order of the optimum cost (non-increasing order of connectivity values). The IFT outputs several attributes, organized as mapping functions/images, for each node in the graph that are used differently depending on the image processing operator being designed (Falcao et al., 2004) (e.g., the node\u2019s root label, optimum-path cost, and predecessor node in the optimum-path).\n3.2.1.1\tGraphs from images\nFormally, an image I can be defined as a pair (Dj, I), where Dj C Z2 corresponds to the image domain and I(t) determines a color vector (I^t), I2(t), I3(t)) in the RGB color space. The extraction of attributes transforms an image I = (Dj, I) into a pair F = (Dj, F), where F(t) = (F^t), F2(t),..., Fm(t)) is a vector of attributes assigned to t. In our case, we seek some lightness invariance by defining F using simply the Cb and Cr channels after converting I to the YCbCr colorspace (i.e., m = 2).\nIn our approach, a graph (N, A) may be created by taking a setNQ Dj of pixels as nodes and defining an adjacency relation A between the nodes of N as arcs. The notation t E A(s) or (s,t) E A indicates that a node t E N is adjacent to node s E N. The adjacency relations we use in our method are:\nt e Ai(s)\nif \\\\t \u2014 s||&lt;42, Vs,t E Dj,\n(3.1)\nt E A2(s)\nif t E N is a k-nearest neighbor\n(3.2)\nof s E N in the feature space.\nThe adjacency relation Ai is\nused in the EDT and inverted watershed transform with\nN = Dj, making adjacent every 8-neighbor pixel on the image domain. The other adja-\n3.\tSEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION\nOF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS\ncency relation A2 is used by the clustering algorithm and will be detailed in section 3.2.I.4. The weights w(s, t) for all arcs (s, t) e A are computed in different ways for each IFT-based operator, sometimes using the feature vectors F and selected markers (user-drawn strokes, when the user\u2019s correction is necessary).\n3.2.1.2\tConnectivity Functions\nA path nt = (t1, t2,...,t) in a graph is a sequence of adjacent nodes ending at node t. The extension of a path ns by an arc (s, t) is expressed by nt = ns \u2022 (s,t), with nt = (t) denoting the trivial path. A connectivity function f assigns a value f (nt) to any path nt in a graph, which represents how strongly connected node t is to the path\u2019s root. For example, functions fmax and fmin propagate the maximum and minimum arc weight values along the path, respectively\nfmax((t))\t= H (t)\nfmax(ns \u2022 (s,t)) = max{fmax(ns),w(s,t)},\t(3.3)\nfmin((t))\t= H (t)\nfmin(ns \u2022 (s,t)) = min{fmin(ns), w(s,t)},\t(3.4)\nwhere H(t) is a handicap value specific to each IFT-based operator (Falcao et al., 2004; Spina et al., 2011a).\n3.2.1.3\tOptimum-path forest\nA path nt is optimum when f (nt) &lt;f (t/) for any other path Tt in (N, A). An optimum connectivity map V(t) is created by considering every possible path ending at each node t e N using the function\nV(t) =\tmin {for\t(3.5)\nVnt in (N ,A)\nV (t) =\tmax , ,{f (nt)}.\t(3.6)\nAn optimum path forest is computed using the IFT algorithm 1 to solve the above minimization (or maximization) problem. An OPF is an acyclic function P that assigns to every node t e N its predecessor P(t) e N in an optimum-path or a distinctive marker P(t) = nil e N, when (t) is optimum (i.e., t is said a root of the forest). Figure 3.2 rep-\n3.\tSEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION\nOF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS\nresents an OPF computed by forcing the roots to be in the seed set M using fmax({t}) with H(t) = 0 if t E M, or H(t) = x otherwise.\nFigure 3.2: (a) A 4-neighborhood graph with set of seeds M = {(0,0), (2, 2)}, considering the origin (0, 0) of pixels coordinates (x,y) in top left and the numbers as arc weights. (b) An optimum-path forest P computed to the function fmax with two roots in S. The numbers inside the nodes show the optimum connectivity map V(t) by Eq. 3.5 and the arrows indicate predecessor node P(t).\nThe general IFT algorithm solves the minimization (maximization) problem of Eq. 3.5 (Eq. 3.6), for a connectivity function f that satisfies certain conditions required for only optimum paths (Falcao et al., 2004). The root R(t) of each pixel t can be obtained by following its optimum path backwards in P (Figure 3.2b). However, it is more efficient to propagate R(t) on-the-fly, creating a root map.\nAlgorithm 1 - IFT Algorithm for fmax\nInput:\tGraph (N, A) and connectivity function f.\nOutput:\tOptimum-path forest P, its connectivity value map V and its root map R.\nAuxiliary:\tPriority queue Q and variable tmp.\n1. For each t eN, do\n2\n3\nP(t)\tnil, R(t)\tt and V(t)\tf ({t}).\n- If V (t) = +x, then insert t in Q.\n4\nWhile Q = do\n5.\n6.\n7.\n8.\n9.\n10.\n11.\nRemove s from Q such that V(s) is minimum.\nFor each t e A(s), such that V(t) > V(s), do Compute tmp\tf (ns \u2022 {s, t}).\nIf tmp &lt;V (t), then\nIf V (t) = +x, then remove t from Q.\nSet P(t)\ts, R(t)\tR(s), V(t)\ttmp.\n- L Insert t in Q.\n3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION\nOF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS\nLines 1-3 initialize maps for trivial paths. The minima of the initial map V compete with each other and some of them become roots of the forest. They are pixels with optimum trivial-path values, which are inserted in queue Q. The main loop computes an optimum path from the roots to every node s in a non-decreasing order of path value (Lines 4-11). At each iteration, a path of minimum value V(s) is obtained in P when we remove its last pixel s from Q (Line 5). Ties are broken in Q using first-in-first-out policy. The remaining lines evaluate if the path that reaches an adjacent pixel t through s is cheaper than the current path with terminus t and update Q, V(t), R(t) and P(t) accordingly.\n3.2.1.4\tClustering by optimum-path forest\nLet N = Sc Dj be a set of pixels randomly sampled from the image, such that |S| \u00ab 200. The clustering process takes a set of sample pixels from I, along with their corresponding feature vectors from F, and feeds them to an OPF unsupervised classifier (Rocha et al., 2009). High concentration of samples indicates data clusters which are represented by prototypes (key nodes) of the OPF classifier. Each prototype becomes the root of an optimum-path tree (cluster), thus partitioning S into an optimum-path forest (clustering of S). The Euclidean distance d(s,t) = \\\\F(s) \u2014 F(t)|| between the feature vectors F(s) and F(t), of samples s, t G S, determines the arc-weights w(s, t) of the graph (S, A2). We compute graph (S, A2) according to those arc weights by considering the k nearest samples t of s when defining the arcs (s,t) G A2.\nAnother parameter used to weigh the nodes of the graph is the probability density function (pdf) computed according to Eq. 3.7. If a region contains a high concentration of samples, the distances between the k nearest neighbors will be smaller, thus resulting in a pdf maximum. Considering that the lowest density along a path in the graph represents its value, and that the optimum path from a pdf maximum to a sample is the one with maximum value, the pdf maxima will compete for samples s G S and each maximum will define an influence zone (optimum-path tree or cluster) composed of the samples most strongly connected to it than to any other maximum.\nP(s)\n1\n/2na2 |A.2(s)|\nexP\nt\u20acA2(s)\n^\u2014d2(s,t)^\n(3.7)\nwhere a = maxv(Sii)eA2\nFor such purpose, fmin is used with H(t) = p(t), if t G R c S, where R is the root\n(prototype) set of the forest with one sample per pdf maximum, or H(t) = p(t) \u2014 S, with\n3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION\nOF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS\n6 = min(S;t)\u20acA2|p(t)=p(s) |p(t) \u2014 p(s)|, if otherwise. The maximization of fmin using the IFT algorithm automatically defines the prototypes s e R, which are identified as samples s removed from Q in Line 5 of Algorithm 1 with P(s) = nil. This requires to initialize V(t) p(t) \u2014 6 for all pixels t e S in Line 2, verify between Lines 5 and 6 if P(s) = nil, and then to set V(s)\tp(s), C(s)\tc, c c +1 (where c = 1, 2,..., |R| is a variable that assigns a\nunique label c to each cluster), and finally to propagate the cluster labels in Line 11 by adding C(t) C(s).\nThe unsupervised learning of the OPF classifier consists of finding a suitable value for k in the adjacency relation A2 and computing an optimum-path forest in the feature space. If a pdf maximum is located on a plateau, it is necessary to make sure that only one prototype conquers the remaining samples of this maximum. This cannot be solely assured by the initialization of fmin, because A2 is not a symmetric adjacency relation. Therefore, A2 must be extended to guarantee that plateau samples are interconnected. This is accomplished by defining A3 such that if t e A(s), s / A2(t), and p(s) = p(t) then\nA3(t)\tA2(t) U {s}.\t(3.8)\nThe choice of the most suitable k is done by computing the result of the algorithm on the graph (S, A3), for k = kmin, kmin + 1,..., kmax, and selecting the k*-adjacent graph (and forest) that minimizes the normalized cut (Shi and Malik, 2000).\nA sample t e D/\\S is classified in one of the clusters by identifying which root would offer it an optimum path. By considering the adjacent samples s e A3(t) C S, we compute p(t) using Eq. 3.7, evaluate the paths ns \u2022 (s,tj, and select the one that satisfies\nV(t) = max {min{V(s),p(t)}}.\t(3.9)\nv(s,t)eAs\nLet s* e S be the node that satisfies Eq. 3.9. The classification simply assigns C(s*) as the cluster of t.\n3.2.1.5\tEuclidean distance transform\nIn the Euclidean IFT, the path-cost function is such that the cost of a path from a seed s to a pixel t in the forest is the Euclidean distance between s and t in the image domain. The algorithm considers an 8-neighbor image-graph (Dp, Ax), derived from a binary image B, and assigns three attributes to each object pixel p: the squared Euclidean distance V(t) between t and its closest point s in the contour (forming an optimum path-value map), its closest seed\n3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION\nOF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS\nR(t) = s (forming a root map), and the label L(t) = L(s) of the segment that contains s (forming a root label map). The corresponding connectivity function is simply given by\nfeucl ((0)\t= H (t)\nfeuci(ns \u2022 (s,t)) = (xs - xR(t))2 + (ys - yR(t))2\t(3.10)\nwhere s = (xs, ys) represents the (x, y) coordinates for a pixel s in the image, and H(t) = 0 for all samples t in a set B defined by the pixels belonging to the desired contour.\n3.2.1.6\tSegmentation by inverted watershed\nA classical watershed transform can oversegment the image into all catchment basins of a given grayscale image I(t). The segmentation can be simplified by closing basins of I(t) with volume below a threshold (Salembier et al., 1998) (i.e., a morphological volume closing). Similarly, the inverted watershed segmentation can be controlled by opening the domes of I(t) above a certain threshold value and using the result as grayscale markers for IFT (Lotufo et al., 2002). The accomplishment of such operation via IFT requires the following parameters for segmenting a few regions within the grains. For the image graph (Dj, A1), the weight of edge (s, t) G A1 is defined as w(s, t) = I(t). We use function fmin from Eq. 3.4 with\nH (t)\nI(t)\tif t G R,\nmax{VO(t) \u2014 1,0} otherwise,\n(3.11)\nwhere R is the root set of the forest (maxima of VO(t) \u2014 1) and VO(t) is the resulting function from morphological volume opening of I(t). Given that VO(t) &lt;I(t), VO(t) \u2014 1 is used to guarantee the roots in R will conquer all pixels in their domes. However, this requires a variant in Algorithm 1. Initially, all pixels start with H(t) = max{VO(t) \u2014 1, 0}. When a pixel s is removed from Q in line 5 and P(s) = nil, this implies that s G R is a maximum of VO(t) \u2014 1 and a new label l = 1,2,..., |R| must be created for s (i.e., we have the same situation during OPF clustering). By reducing H(s) to I(s) for all maxima s, the image is partitioned into an optimum-path forest with roots in R, whose result is a controlled segmentation of the image outputting a label map L(t). Note how clustering in the feature-space and watershed transformation in the image domain are closely related by the IFT algorithm.\n3.\tSEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION\nOF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS\n3.2.2\tAutomatic Grain Image Segmentation Pipeline\nLet C(t) be the cluster image resulting from unsupervised classification using OPF, after merging overlapping clusters (Figures 3.5-b, 3.6-b). Since the grains are brighter than the pores and the background, their cluster is selected to create a binary mask M(t) containing only the grains (Figures 3.5-c, 3.6-c).\nWe compute the Euclidean IFT using as roots the set of pixels B from the boundary of grains in M (t). The distance transform is further constrained to propagate inwards with respect to the boundary of the grains in the binary mask (i.e., the optimum-path forest only considers pixels t where M(t) > 0). Hence, the final cost map V(t) possesses domes of bright values with maxima located near the center of the corresponding grains. Concurrently, we extract image edges by computing the gradient of the feature image F using an 8-neighbor adjacency relation, considering the stronger edge of the Cb and Cr features (Figures 3.5-d, 3.6-d). Afterwards, we combine the distance map V(t) with the edge detection result to better divide the connected domes/grains (Figures 3.5-e, 3.6-e).\nThe domes are automatically divided using the IFT-based inverted watershed from grayscale markers previously described, also constrained to the binary segmentation mask M(t). The final result of the inverted watershed transform is an image L(t) that assigns a label l = 0,1,..., n to every pixel representing either the background, l = 0, or a unique grain, l > 0 (Figures 3.5-f, 3.6-f). Label image L(t) is ready to be used in any other program to compute petrophysical parameters as desired. Examples of automatic grain image segmentation can be seen in Figures 3.5-g, 3.6-g, 3.7-a.\n3.2.3\tInteractive Correction\nEven though our automatic grain image segmentation method is quite effective, such task remains a great challenge. Therefore, the misclassified grains can be corrected interactively by an specialist using Live Markers (Spina et al., 2011b). LM is a hybrid tool that combines two powerful IFT-based methods, the differential IFT with seed competition (DIFT-SC) (Falcao and Bergo, 2004) and live-wire-on-the-fly (LWOF) (Falcao et al., 2000), benefiting from their best qualities. We use interactive segmentation by LM to both correct misclassifcation from our automatic approach and to generate ground-truth data.\nIn DIFT-SC, object delineation relies on the competition between object and background markers (seeds) selected by the user during the object recognition task. The seeds compete to conquer regions of the images using the IFT algorithm with function fmax (Falcao et al., 2004),\n3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION\nOF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS\nin a graph (Dj, Ax) with arc weights defined by the image edges. The object is defined by the union of optimum-path trees rooted at the object marker pixels (Figure 3.3b). The user can add or remove markers and the segmentation is recomputed differentially only for the region influenced by the altered seed.\n(a)\n(b)\n(c)\nFigure 3.3: (a) Result of automatic segmentation with misclassification. (b) One grain marker and two background markers to correct with DIFT-SC. (c) Correction segment with LWOF.\n(d)\tLM correction obtaining better delineation of grain shape.\nA different interactive approach is used by LWOF (Falcao et al., 2000), in which delineation aims to have the user roughly guide the computer in selecting the object\u2019s boundary. The object boundary segments are computed with constraints imposed by the user on the frontier between object and background (anchor points). Each segment is an optimum-path computed by the IFT between two adjacents anchor points, and the user guides the segmentation process while watching the optimum-path being generated on-the-fly, from the last point until the current mouse cursor position. Upon the selection of a new anchor point with a mouse click, the optimum-path segment snaps onto the boundary and is fixed throughout the delineation process.\nBoth of the aforementioned segmentation paradigms have complementary strengths and weaknesses, which can be exploited to reduce the user\u2019s involvement. DIFT-SC is more effective with complex object shapes but inefficent due to leakings in regions with weak boundary information. LWOF allows to segment weak borders being able to block the leaking of DIFT-SC, despite requiring more user interaction and time. LM combines DIFT-SC and LWOF by transforming each boundary segment computed between two anchor points by LWOF into internal and external markers that block DIFT-SC leaking (Figure 3.3c).\nLM\u2019s hybrid approach allows the segmentation of the image with linear time in the first iteration and sublinear time in subsequent corrections, further reducing the required amount of the user\u2019s time. Nevertheless, the segmentation quality strongly depends on a good estimation\n3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION\nOF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS\nof the arc weights for the IFT graphs (Miranda et al., 2010). The pattern classifiers based on IFT (Papa et al., 2009b; Rocha et al., 2009) are used to automatically choose the marked pixels that best help distinguish the object from the background (3.3b) (Spina et al., 2011a). The best pixels are used to compute a rich image gradient and estimate the arc weights for the DIFT-SC and LWOF graphs. This activity is naturally integrated with LM further simplifying the method\u2019s interface, because the approach of (Spina et al., 2011a) also automatically determines where and when the arc weights can be recomputed to maintain the delineation\u2019s accuracy.\n3.2.4\tEvaluation parameters\nAccuracy is a parameter usually computed to validate classification processes and the proposition in Papa et al. (2009b) was adapted to evaluate the misclassification. The ground truth image is generated by user\u2019s interactive corrections in automatic segmentation result. The accuracy parameter considers changes in the labels occurred during the segmentation correction process, generating a remapped image from the root map and the ground-truth image, identifying which grain pixels kept their labels and which were altered. The different sizes of labels after the corrections are considered. Typical and expected missclassification are shown in Figures 3.3-a, 3.4.\nLet n be the number of pixels of the segmented image, and nelement(i) the number of pixels of each label i and nlabel the number of labels after corrections:\nFP(i)\nei,i =-------, (i) 4 and\t(3.12)\nn \u2014 nelement(i)\nei,2 =\nFN) nelement(i)\n, i = 1,.\nnlabel\n(3.13)\n\nwhere FP(i) is false positive and FN(i) is false negative. FP(i) is the number of samples from the other label that were classified as being from the label i in n and FN(i) is the number of samples from the class i incorrectly classified from other classes in n. The accuracy parameter is determined by Eq.3.14.\nAcc = i \u2014 s\u2018=\u00b0(e;\\+\n2(nlabel)\n(3.14)\n3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION\nOF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS\n(a)\t(b)\n(c)\t(d)\nFigure 3.4: Examples of common misclassifications and their corrections. (a) The grain is split in two. The desired label is picked by a tool in the interface and the correction region is marked. (c) The two touching grains are segmented as one. The correction is analog the other, except the creation of a new label. (b) and (d) are the results after running DIFT-SC.\nOther parameters are used to quantify the corrections. Weighted Grain Subdivision Error (WGSE) is the sum of the differences between the grain area from automatic segmentation and ground-truth, weighted by the sum of the area of only the corrected grains. For example, if a grain was segmented in four grains in the automatic process, WGSE weighs each area of theses subdivisions so that the misclassification in the larger grains become more relevant. To understand the relevance of changes as a whole, Weighted Grain Subdivision Error Global (WGSE - Global) has a slight modification, being weighted by the sum of all grains area of ground-truth image. Similarly, Percentage of Grain Area (PGA) parameter gives another global view computing the area of altered grains weighted by all grains area.\n3.3\tResults and discussion\nThe tests were applied to 151 images of sandstone thin sections images, in which porosity is delineated by injection of blue-stained epoxy. In general, all grains were well segmented from the pores and almost all grains in touch were separated properly. They took ca. 35 seconds for each 8 megapixel to be processed by a computer with 2.80 GHz CPU frequency, 4GB\n3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION\nOF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS\nRAM and using Ubuntu OS. However, there were three groups of missclassification: 79.5% of images need a little user interaction to correct them, 11.9% need more user interaction and effort, and as expected, these misclassifications occurred during separation of touching grains and they were influenced by matrix with quartz grains and rock fragments. In the 8.6% of images, the procedure failed in the segmentation due low pore contrast, high presence of matrix between grains and higher magnification of microscope.\nTwo more representative samples were chosen to correct and measure the accuracy parameters. Sample S1 (Figure 3.5-a) is a weakly sorted sub-arkose, showing clayey matrix in some portions of the thin section and grain fabric resulting from low compaction and dissolution. The difficulty in segmentation is due the presence of different grain sizes and clay minerals in the fractures and cleavages of the grains. Sample S2 (Figure 3.6-a) is a less porous and better-sorted sub-lithic sandstone. Contacts between grains are more common. Despite the predominance of quartz grains, rock fragment are also present. The rock fragments and the contact between grains interfere in the automatic image segmentation.\nThe misclassification was characterized by two situation during separation of touching grains. The first situation occurred when the edge was not strong enough between two grains, creating just one label. The other was dark pixels in the grain fabric, creating false edges and extra domes in EDT, consequently creating different grains (Figure 3.7-a). Correction of the first situation was easy by using DIFT-SC makers to add a new label. The second situation was corrected by just using the tool to copy the label from one grain to the other (Figure 3.7-b).\nOther misclassification occurred with quartz grains in the matrix that have pixels more similar to the clastic grains, smoothing the edges between them (Figure 3.7-a). The corrections were made by DIFT-SC markers, except when the matrix was darker. In this case, the LM tool was used since the similarity to pore was increased (Figure 3.7-b).\nRock fragments are texturally more heterogeneous, resulting in bright and dark pixels. The algorithm identifies the bright pixels as small grains and the dark pixels as more similar to the pores, and consequently these fragments are not interpreted as only one grain (Figure 3.8-a). To illustrate the differences between corrections of this misclassification, the corrections made in grains (i) and (ii) in Figure 3.8-b using the DIFT-SC tool required more markers than usual, whereas the corrections made in grains (iii) and (iv) in Figure 3.8-b using the LM tool required less markers and effort to obtain a precise segmentation.\n3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION\nOF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS\nc)\td)\ng)\nFigure 3.5: (a) Sample S1 - Input image of the porous sandstone, showing irregular grains of varied sizes and clayey matrix. (b) Three-cluster image, including background. (c) Grain binary mask from the brighter clusters. (d) Edges detected by stronger gradient of features Cb and Cr. (e) Combination of Euclidean IFT within grains and edges image. (f) Image of labeled grains. Each grain has its label as pixel values. (g) Original image combined with the image of labeled grain.\n3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION\nOF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS\nc)\td)\ng)\nFigure 3.6: (a) Sample S2 - Input image of the more compact sandstone. (b) Three-cluster image, including background. (c) Grain binary mask from the brighter clusters. (d) Edges detected by stronger gradient of features Cb and Cr. (e) Combination of Euclidean IFT within grains and edges image. (f) Image of labeled grains. Each grain has its label as pixel values. (g) Original image combined with image of labeled grain.\n3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION\nOF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS\n(b)\n(a)\nFigure 3.7: (a) Detailed image of grain segmented from the background and others grains. (b) Image with misclassifications corrected by Live Markers.\nFigure 3.8: (a) Details of misclassification of rock fragments by automatic segmentation. (b) In the correction, DIFT-SC markers had a small leaking in (i) and (ii). LM needed a little more interaction but the delineation was more precise in (iii) and (iv).\nA time-consuming process would be deleting tiny grains manually. Thus, a filter was used to delete grains with areas smaller than 10% of average grain area, which corresponded to 254 pixels in sample S1 and 333 pixels in sample S2. Almost 40% of the grains were filtered, corresponding to approximately 1% of the total grain area.\n3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION\nOF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS\nThe light of compound microscope has created a circular border effect decreasing the pixel brightness from the illuminated to shaded region, making the segmentation of the grains in the shaded region very difficult. These grains were deleted and a considerable area was excluded in the interactive correction.\nThe final number of grains after the interactive corrections and the ratios between the total grain areas from the ground-truth and the automatic segmentation images are shown in Table\n3.1.\tThe corrections of rock fragments in sample S2 led to an increase in the grain-area ratio.\nTable 3.1: Comparative results after processes\n\tNumber of grains\t\tGrains area ratio (%)\t\n\tS1\tS2\tS1\tS2\nAutomatic\t825\t803\t-\t-\nSegmentation\t\t\t\t\nInteractive\t409\t556\t96.2\t102.7\ncorrections\t\t\t\t\nThe evaluation parameters that compare label changes in the ground-truth image with the automatic segmentation results are highly satisfactory (Table 3.2). The results show the difference between the two samples, given that sample 2 has more matrix and rock fragmentes, demanding more user interaction. Accuracy was higher than 90% and WGSE global lower than 10%, indicating that label changes were few.\nTable 3.2: Evaluation parameters results\n\tS1 (%)\tS2 (%)\nAccuracy\t97.9\t91.7\nWGSE - Global\t6.49\t9.47\nWGSE\t29.1\t39.1\nPGA\t22.3\t24.2\nFigure 3.9 presents comparison between the total grain areas obtained by automatic segmentation and the respective interactive corrections. If the automatic segmentation were perfect, the points would be aligned in the red line. However, the areas of 9.8% of grains in sample S1 had to be altered and 53.9% of erased grains. For sample S2, the areas of 17.3% of the grains were modified and 40.6% of grains erased. The trend line is represented in blue and R-squared computed for samples S1 and S2 were respectively 0.9365 and 0.8059.\n3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION\nOF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS\nFigure 3.9: Relationship between automatic segmentation areas and interactive corrections area of sample S1 (a) and sample S2 (b).\n3.4\tConclusions\nA new application of the IFT algorithm in petrophysical image analysis is shown in this work. It proved to be a very quick and precise tool in image segmentation with the advantage of being adaptable to any kind of grain, regardless of its shape or size. An excellent distinction of grains from background and pores is obtained, generating a good binary mask.\nThe separation of touching grains was relatively good, but with unavoidable misclassification. The option of interactive correction was very easy to use and the effort depends on how precise the specialist wants or needs the segmentation to be. The values of the evaluation parameters comparing the automatic segmentation image with the ground-truth image were very high, proving it to be a reliable automatic process. In other words, the automatic process is an adequate option for a fast result with no need of user interaction.\n3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION\nOF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS\n4\tAplicabilidade do metodo de segmenta\u00e7\u00e3o automatica em analise morfol\u00f3gica dos gr\u00e3os\n4.1\tIntrodu\u00e7ao\nO principal objetivo deste cap\u00edtulo \u00e9 apresentar poss\u00edveis aplica\u00e7\u00f5es do m\u00e9todo desenvolvido no cap\u00edtulo 3.\nA analise morfol\u00f3gica de part\u00edculas sedimentares permite inferir sobre as informacoes de origem, transporte e ambientes deposicionais de sedimentos. A morfologia do gr\u00e2o pode ser determinada pela combinacao de tr\u00eas propriedades independentes: forma - dimensoes do grao; arredondamento - suavidade do contorno do grao; e textura - rugosidade da superf\u00edcie. A fim de demonstrar as poss\u00edveis aplicacoes que podem ser desenvolvidas a partir do metodo de segmentacao automatica, descrito no cap\u00edtulo 3, neste cap\u00edtulo utilizamos tecnicas para determinar a forma dos gr\u00e2os, na secao 4.1.1. As tecnicas utilizadas na secao foram baseadas nos estudos realizados por Aschenbrenner (1956), Barrett (1980) e Benn and Ballantyne (1993).\nA porosidade da rocha na analise petrof\u00edsica e uma par\u00e2metro de muito interesse para o planejamento da producao dos pocos de exploracao. Na secao 4.1.2 e realizada uma estimativa da porosidade da rocha baseada na segmentacao realizada na imagem.\n4.1.1\tDetermina\u00e7\u00e3o da forma do grao\nA forma do grao e definida pela determinacao de par\u00e2metros como esfericidade (Wadell, 1932; Aschenbrenner, 1956; Sneed and Folk, 1958), fator de forma F (Aschenbrenner, 1956), Projecao de Esfericidade Maxima (MSP) (Sneed and Folk, 1958) e \u00edndice Oblato-Prolato (Dobkins and Folk, 1970).\nTodos esses par\u00e2metros de forma do grao podem ser determinados a partir da medida dos eixos (a) maior, (b) intermediario e (c) menor. \u00edsso torna-se poss\u00edvel a partir do momento em que o metodo de segmentacao automatica proposto no cap\u00edtulo 3 permite gerar uma imagem\n4.\tAPLICABILIDADE DO METODO DE SEGMENTA\u00c7\u00c3O AUTOM\u00c1TICA EM\nan\u00e1lise morfol\u00f3gica dos graos\nde r\u00f3tulos distintos dos gr\u00e3os. Uma rotina computacional analisa cada gr\u00e3o individualmente, detectando as bordas do grao e por sistema de coordenadas polares. Com isso sao determinados os eixos utilizando os pixels da borda. Os trabalhos de Zingg (1935), Aschenbrenner (1956), Sneed and Folk (1958) e Dobkins and Folk (1970) propoem as relacoes da Tabela 4.1 para modelar e representar a forma dos graos.\nTabela 4.1: Descricao das equacoes para estimativa da forma do grao de acordo com os tr\u00eas eixos maior (a), intermediario (b) e menor (c). Sao utilizadas as relacoes p = b/a e q = c/b.\nDescric\u00e3o\tEquacao\tAutor(es)\nRazoes dos eixos\tp = a; q = c\tZingg (1935)\nWorking Sphericity\ti2.^/p2q\tAschenbrenner(1956)\n\t1+p(1+q)+6^1+p2(1+q2)\t\nEsfericidade de\t3 rc2 y ac\tSneed and Folk (1958)\nprojecao maxima (MSP)\t\tAschenbrenner(1956)\nFator de forma F\tac b2\tAschenbrenner(1956)\nIndice Oblato-prolato\t10(( a\u2014 )-o.5)\tDobkins and Folk (1970)\n\tc a\t\nIndice disco-haste\ta-b a- c\tSneed and Folk (1958)\nZingg (1935) prop\u00f5e um diagrama cartesiano para relacionar as formas dos gr\u00e3os, sendo que a relacao p = b/a e atribu\u00edda ao eixo das ordenadas e q = c/b ao eixo das abscissas. As regioes das classes sao delimitadas pelos valores p = 0.67 e q = 0.67, sendo as formas dos seixos classificadas de acordo com a Tabela 4.2.\nTabela 4.2: Classes segundo as formas dos seixos segundo Zingg (1935).\nClasse\tForma dos seixos\nI\tTabular, oblato ou discoidal\nII\tEquidimensional ou Esf\u00e9rico\nIII\tLaminar ou triaxial\nIV\tProlato ou bastonado\nO \u00edndice de esfericidade primeiramente proposta por Wadell (1932) utiliza as medidas do volume do grao e o volume da maior esfera circunscrita no grao. Krumbein propoe uma aproximacao que utilize apenas os eixos propostos por Zingg (1935). Posteriormente, Aschenbrenner (1956) propoe uma aproximacao baseada na figura do Tetradecaedro, denominada\n4. APLICABILIDADE DO METODO DE SEGMENTA\u00c7\u00c3O AUTOMATICA EM\nANALISE MORFOL\u00d3GICA DOS GRAOS\n'Working Sphericity', tamb\u00e9m baseada nos eixos principais e que mostra-se ser mais pr\u00f3xima \u00e0 forma dos detritos dos clastos.\nSneed and Folk (1958) propoem um \u00edndice de esfericidade de projecao maxima (MSP), sugerindo que a esfericidade deve ser expressa para seu comportamento em um fluido, representando o arrasto e a forca gravitacional que agem em uma part\u00edcula imersa em um fluido, sendo um importante \u00edndice de comportamento de part\u00edculas transportadas ou sedimentadas em agua. \u00c9 considerado um \u00edndice util no contexto hidr\u00e1ulico, porem nao pode ser generalizado. O diagrama de Zingg (1935) representa b/a vs c/b e permite Aschenbrenner (1956) expressar a forma dos graos em termos da 'Working Sphericity' e do Fator deforma F.\nOutra proposta realizada por Sneed and Folk (1958) e um diagrama triangular para representar achatamento, alongamento e compactacao dos graos, nos vertices do triangulo. Deste modo, consegue relacionar e dividir as classes em achatado, laminado e alongado, devido a razao c/b e (a \u2014 b)/(a \u2014 c). O diagrama destaca a caracter\u00edstica fundamental das formas e a maneira que convergem no tipo compacta (Figura 4.1-a).\nFigura 4.1: Diagramas triangulares (a) as 10 classes descritivas definadas por Sneed and Folk (1958) C - Compact (Compacta), P - Platy (achatada), B - Bladed (laminada), E - Elongate (Alongada) e V - Very (Muito); (b) Isolinhas de M\u00e1xima Projecao de Esfericidade (MSP); (c) Isolinhas de Indice de Oblato-Prolato. Figuras adaptadas de Benn e Ballantyne (1993)\nOs \u00edndices MPS e Oblato-Prolato permitem gerar diagramas triangulares em fun\u00e7\u00e3o de c/b (Figura 4.1-b e 4.1-c). Apesar de todos os gr\u00e1ficos serem gerados do mesmo conjunto de dados, i.e. a partir das dimens\u00f5es dos eixos principais, uma tendencia em um diagrama pode nao necessariamente ser legitimada por outro.\n4.\tAPLICABILIDADE DO METODO DE SEGMENTA\u00c7\u00c3O AUTOM\u00c1TICA EM\nan\u00e1lise morfol\u00f3gica dos graos\n4.1.2\tEstimativa de porosidade da rocha\nOs graos de rocha nunca se encaixam perfeitamente devido a irregularidade nas formas dos graos. O espaco vazio entre os graos e denominado poro e e ocupado por flu\u00eddos. A porosidade pode ser definida por: A = Vporo , onde A e a porosidade, Vporo e o Volume do poro e Vrocha e o Volume da rocha em analise (Tiab and Donaldson, 2004). Uma estimativa da porosidade da rocha pode ser determinada analisando o n\u00famero de pixels que compoe a area dos poros e a area total da imagem, levando a A = A010, onde Aporo corresponde ao numero de pixels do poro e Atota\u00ed ao n\u00famero de pixels total da imagem.\n4.2\tResultados e discussao\nPara analise morfologica dos graos foram utilizadas, alem das amostras S1 e S2 (apresentados no cap\u00edtulo 3), mais 5 amostras de arenito para a segmentacao automatica e correcoes, denominadas de Amostra S3 a Amostra S7, respectivamente (Tabela 4.3).\nTabela 4.3: Descricao das imagens das amostras\nNome da amostras\tResolucao (megapixel)\tBreve descricao\nS1\t14\tMenos ampliada, vignetting\nS2\t14\tMenos ampliada, vignetting\nS3\t14\tMenos ampliada, vignetting\nS4\t14\tMais ampliada, graos maiores\nS5\t3.4\tMais ampliada, graos maiores\nS6\t3.4\tMais ampliada, graos maiores\nS7\t3.4\tMais ampliada, graos maiores\nAs novas amostras sao semelhantes as Amostras S1 e S2, com diferencas que S5 a S7 tem resolucao menor e S4 a S7 estao mais ampliadas, apresentando graos maiores preenchendo toda a imagem. As imagens S1 a S3 apresentam o efeito de vignetting (reducao do brilho na periferia da imagem comparado com o centro da imagem), causado pela lente na situacao de baixa ampliacao do microscopio.\nAs imagens das amostras S3 a S7 foram segmentadas automaticamente e corrigidas pelo metodo descrito no cap\u00edtulo 3. Neste cap\u00edtulo sao apresentadas os resultados apenas das imagens das amostras S3 e S6, os resultados das demais imagens sao apresentadas no Anexo A.\nAs Figuras 4.2-a e 4.3-a sao os resultados da segmentacao autom\u00e1tica e as Figuras 4.2-b e 4.3-b sao as respectivas corre\u00e7\u00f5es.\n(a)\t(b)\nFigura 4.2: (a) Resultado da segmentacao automatica da Amostra S3. (b) Resultado da correcao interativa da Amostra S3.\n(a)\t(b)\nFigura 4.3: (a) Resultado da segmentacao automatica da Amostra S6. (b) Resultado da correcao interativa da Amostra S6.\nAs medidas de acuracias realizadas de acordo com a secao 3.2.4 e estao apresentadas na Tabela 4.4. Os resultados foram bastante satisfat\u00f3rios, sendo que as m\u00e9dias das acuracias, WGSE - Global e WGSE foram, repectivamente, 82.4%, 10.4% e 22.7%.\n4.\tAPLICABILIDADE DO METODO DE SEGMENTA\u00c7AO AUTOM\u00c1TICA EM AN\u00c1LISE MORFOL\u00d3GICA DOS GRAOS\nTabela 4.4: Medidas de acuracia do metodo de segmentacao automatica e correcoes.\nNome da amostras\tAcuracia (%)\tWGSE - Global (%)\tWGSE (%)\nS1\t97.9\t6.49\t29.1\nS2\t91.7\t9.47\t39.1\nS3\t90.7\t9.59\t19.3\nS4\t67.3\t14.67\t18.3\nS5\t79.9\t15.13\t21.3\nS6\t82.5\t14.12\t19.9\nS7\t79.4\t3.40\t11.7\nMe\u00eddia\t82.4\t10.41\t22.7\nOs resultados refletem a influencia da presenca fragmentos de rocha e matriz nas amostras, levando o algoritmo de segmentacao automatica a interpretar os fragmentos de rocha como pequenos graos. A presenca da matriz faz com que seja necessaria a interpretacao do especialista para marcar os limites de alguns graos.\nComo o principal objetivo deste cap\u00edtulo e o estudo da morfologia dos graos, durante a correcao interativa foram descartados os graos muito diferentes da maioria com coloracao muito escura, e mantidos os graos mais semelhantes ou que conseguiam ser facilmente distingu\u00edveis. Estes graos representam minerais diageneticos de (\u00f3xido de ferro, formados depois da deposicao, por isso nao podem ser considerados para uma analise morfologica relacionadas a processos deposicionais. Os graos utilizados na analise representam os graos de quartzo, que sao muitos semelhantes entre si e facilmente distingu\u00edveis. Por consequencia, a area total dos graos corrigidos em relacao a area total dos graos obtidos pela segmentacao automatica variou de 2%.\nOutra observacao e a independencia da necessidade do fundo escuro, presente nas Amostras S1, S2eS3. O algoritmo de segmentacao automatica foi aperfeicoado de modo a conseguir realizar o agrupamento tanto para recortes de imagens quanto imagens obtidas com maior ampliacao e para diferentes resolucoes.\nPara o estudo da forma dos graos, a rotina determina os eixos maior, intermediario e menor dos graos, gerando uma imagem para verificacao dos contornos dos gr\u00e2o e os eixos escolhidos. As Figuras 4.4-a e 4.4-b apresentam os resultados. Observa-se nas imagens que os graos da regiao de corte das imagens foram influenciados.\n(a)\t(b)\nFigura 4.4: Contorno dos gr\u00e3os e eixos das Amostras S3 (a) e S6 (b).\nCom a determina\u00e7ao dos eixos dos graos, e poss\u00edvel gerar os diagramas 4.5-a e 4.5-b e classificar os graos segundo o crit\u00e9rio de Zingg (1935). A distribui\u00e7ao das classes dos graos das 7 amostras esta apresentada na Tabela 4.5. A distribuicao das classes e uniforme entre as classes em todas as amostras.\n(a)\n(b)\nIII\t<\u2666 \u2666\u2666\n\t+\n\t\u2666\u2666\nFigura 4.5: Diagramas de Zingg (1935) das amostras S3 (a) e S6 (b).\nO diagrama triangular de Sneed and Folk (1958) permite vizualizar a distribuicao dos graos pelas classes. As Figuras 4.6a e 4.6b apresentam os diagramas das amostras S3 e S6, respec-\n4.\tAPLICABILIDADE DO METODO DE SEGMENTA\u00c7\u00c3O AUTOM\u00c1TICA EM\nan\u00e1lise morfol\u00f3gica dos graos\ntivamente. O percentual da distribui\u00e7\u00e3o das classes est\u00e1 detalhado na tabela 4.6. Pode-se observar que a distribui\u00e7ao das classes e uniforme entre as classes em todas as amostras.\nTabela 4.5: Distribuicao dos gr\u00e2os segundo criterio de classificacao de Zingg (1935).\n\tI\tII\tIII\tIV\nNome da\tTabular\tEquidimensional\tLaminar\tProlato\namostras\t(%)\t(%)\t(%)\t(%)\nS1\t9.0\t64.2\t12.7\t14.1\nS2\t7.1\t58.9\t14.1\t19.9\nS3\t4.0\t67.5\t2.0\t26.5\nS4\t5.3\t57.2\t6.6\t30.9\nS5\t11.1\t54.7\t16.7\t17.5\nS6\t9.1\t58.3\t11.2\t21.4\nS7\t6.2\t60.8\t11.5\t21.5\nMedia\t7.4\t60.2\t10.7\t21.7\nDesvio Padrao\t2.5\t4.4\t4.9\t5.6\nFigura 4.6: Diagrama para determinacao de classes das amostras S3 (a) e S6 (b) segundo criterio de classificacao de Sneed and Folk (1958).\nOs diagramas apresentam a distribui\u00e7\u00e3o da frequ\u00eancia de Fator de Forma F e do par\u00e1metro de esfericidade, obtidos para amostras S3 (Figuras 4.7a e 4.7c) e S6 (Figuras 4.7b e 4.7d), respectivamente. Apesar das imagens possuirem resolu\u00e7\u00f5es e amplia\u00e7\u00f5es diferentes, nao apresentaram diferen\u00e7as significativas nas distribuicoes, pois sao do mesmo tipo de amostra.\n4.\tAPLICABILIDADE DO METODO DE SEGMENTA\u00c7AO AUTOM\u00c1TICA EM AN\u00c1LISE MORFOL\u00d3GICA DOS GRAOS\nTabela 4.6: Distribui\u00e7\u00e3o dos gr\u00e3os segundo crit\u00e9rio de classifica\u00e7\u00e3o de Sneed and Folk (1958) para as 7 amostras.\nNome da\tC\tCP\tCB\tCE\tP\tB\tE\tVP\tVB\tVE\namostras\t(%)\t(%)\t(%)\t(%)\t(%)\t(%)\t(%)\t(%)\t(%)\t(%)\nS1\t15.8\t0.0\t39.7\t8.5\t0.0\t24.8\t3.4\t0.0\t7.1\t0.7\nS2\t16.3\t0.0\t36.2\t7.4\t0.0\t27.0\t3.9\t0.0\t8.9\t0.4\nS3\t19.3\t0.0\t49.8\t2.8\t0.4\t26.1\t1.6\t0.0\t0.0\t0.0\nS4\t14.5\t0.0\t45.4\t4.6\t0.7\t23.7\t3.9\t0.0\t5.9\t1.3\nS5\t12.7\t0.0\t42.9\t6.3\t0.8\t19.0\t7.9\t0.8\t6.3\t3.2\nS6\t17.6\t0.5\t35.8\t5.3\t0.0\t25.7\t7.0\t0.0\t8.0\t0.0\nS7\t16.9\t0.0\t41.5\t4.6\t0.0\t21.5\t5.4\t0.0\t9.2\t0.8\nMedia\t16.2\t0.1\t41.6\t5.7\t0.3\t24.0\t4.7\t0.1\t6.5\t0.9\nDesvio Padrao\t2.1\t0.2\t5.0\t1.9\t0.3\t2.8\t2.2\t0.3\t3.1\t1.1\n(a)\n(b)\n(c)\nAmostra S6\n0,2\t0,3\t0,4\t0,5\t0,6\t0,7\t0,8\t0,9\t1\nEsfericidade ip'\n\u201cW\nFigura 4.7: Diagrama de frequ\u00eancia de Fator de Forma das amostras S3 (a) e S6 (b); Diagrama de frequencia da esfericidade das amostras S3 (c) e S6 (d).\n4. APLICABILIDADE DO METODO DE SEGMENTA\u00c7AO AUTOM\u00c1TICA EM AN\u00c1LISE MORFOL\u00d3GICA DOS GRAOS\nOs diagramas triangulares na Figura 4.8 mostram a distribuyo do \u00edndice Oblato-Prolato dos graos e as respectivas isolinhas. Ao lado, encontram-se os respectivos diagramas de distribuigao de frequencia de ocorrencia dos valores para quantificacao e analise. Os resultados nas Figuras 4.8a e 4.8b sao da amostra S3 e Figuras 4.8c e 4.8d sao da amostra S6.\n(a - b) / (a - c)\n\u00edndice Oblato-Prolato\n(a)\n(a - b) / (a - c)\n(c)\n(b)\n(d)\nFigura 4.8: Diagrama triangular do \u00edndice Oblato-Prolato das amostras S3 (a) e S6 (c); Diagrama de frequencia dos respectivos \u00edndices Oblato-Prolato das amostras S3 (b) e S6 (d).\n4. APLICABILIDADE DO METODO DE SEGMENTA\u00c7AO AUTOM\u00c1TICA EM AN\u00c1LISE MORFOL\u00d3GICA DOS GRAOS\nAnalogamente, a Figura 4.9 apresenta os diagramas triangulares da distribuicao do \u00edndice MSP e as isolinhas, juntamente com os diagramas de distribuicao de frequencia, das amostras S3 nas Figuras 4.9a e 4.9b, e S6 em 4.9c e 4.9d. Novamente podemos observar que nao houve discrepancia entre as amostras.\n(a -1>) / (a - c)\n40.0\n35.0\n30.0\n.CS\nJ 20.0\ns O\" e\n15.0\n10.0\n5.0\n0.0\nAmostra S3\n0.2\t0.3\t0.4\t0.5\t0.6\t0.7\t0.S\t0.9\t1\nMSP\n(b)\n(a)\n(a -1>) / (a - c)\n(c)\nAmostra S6\n0.2\t0.3\t0.4\t0.5\t0.6\t0.7\t0.8\t0.9\t1\nMSP\n(d)\nFigura 4.9: Diagrama triangular do \u00edndice MSP das amostras S3 (a) e S6 (c); Diagrama de frequ\u00eancia dos respectivos \u00edndices MSP das amostras S3 (b) e S6 (d).\nOs resultados obtidos quanto a forma comprovam a semelhanca entre as amostras, entretanto, a analise possibilita um estudo mais robusto conforme o grande numero de medidas realizadas. Assim, novos par\u00e2metros podem ser obtidos, o que ocasionara a melhor describo da rocha.\n4. APLICABILIDADE DO METODO DE SEGMENTA\u00c7AO AUTOM\u00c1TICA EM AN\u00c1LISE MORFOL\u00d3GICA DOS GRAOS\nA porosidade da rocha foi estimada para as amostras S4 a S7, pois nao possuem o efeito de vignetting, ja que a regiao mais escura do fundo acabaria sendo considerada como poro. Os resultados apresentam-se na Tabela 4.7.\nTabela 4.7: Porosidade estimada.\nNome da amostra\tA (%)\nS4\t41.8\nS5\t39.9\nS6\t43.8\nS7\t43.7\nOs resultados de porosidade apontam as boas condicoes de reservat\u00f3rios para essas amostras. As amostras sao provenientes da Formacao Botucatu, um importante aquifero da Bacia do Parana.\n4.3\tConclus\u00f5es\nOs resultados deste cap\u00edtulo demonstram algumas aplicacoes para o metodo de segmentacao automatica. Foram utilizadas mais 5 imagens de amostras semelhantes as utilizadas no cap\u00edtulo 3, de laminas delgadas de rocha semelhantes. Os resultados apresentam altas medias de acuracia do metodo, refor\u00e7ando aplicacao do metodo para esse fim. A presenca de fragmentos de rocha e matriz nas amostras influenciaram nos resultados, sendo a te\u00edcnica melhor aplicada para amostras com pouca matriz e mais homogenea em relacao a composicao mineralogica.\nA morfologia do grao pode ser determinada por tr\u00eas propriedades: forma, arredondamento e textura. Neste estudo foi apresentado a utilizacao dos resultados do metodo de segmentacao automatica com o objetivo de definir a forma dos graos, uma vez que o problema de contato entre graos esta solucionado pelo metodo de segmentacao. Alem disso, o fato da t\u00e9cnica ser supervisionada por um especialista, permite o ajuste da imagem para realizacao das medidas dos eixos e a analise dos graos. A aplicacao mostrou-se bastante satisfat\u00f3ria, pois os diagramas apresentados tiveram alta coer\u00eancia com a interpretacao realizada nas amostras. Houve pequena influencia da presenca de fragmentos de rocha e matriz nas amostras.\nPara trabalhos futuros, a sugestao e que os graos que estejam na borda das imagens sejam eliminados para melhorar o estudo morfologico. Os graos nao foram eliminados visando manter um padr\u00e2o nas correcoes para uma uniformidade no calculo das acur\u00e2cias.\n4.\tAPLICABILIDADE DO METODO DE SEGMENTA\u00c7AO AUTOM\u00c1TICA EM AN\u00c1LISE MORFOL\u00d3GICA DOS GR\u00c3OS\nOutras sugestoes sao o aperfeicoamento da estimativa da porosidade da rocha e o estudo das possibilidades de determinacao da permeabilidade a partir da porosidade, descrita em (Tiab and Donaldson, 2004), bem como a tortuosidade e conectividade dos poros.\n4. APLICABILIDADE DO METODO DE SEGMENTA\u00c7AO AUTOM\u00c1TICA EM AN\u00c1LISE MORFOL\u00d3GICA DOS GR\u00c3OS\n5\tReferencias Bibliogr\u00e1ficas\nReferencias Bibliogr\u00e1ficas\nAschenbrenner, B.C., 1956. A New Method of Expressing Particle Shericity. Journal of Sedimentary Petrology Vol. 26, 15-31.\nBarrett, P.J., 1980. The shape of rock particles, a critical review. Sedimentology 27, 291-303.\nBenn, D.I., Ballantyne, C.K., 1993. The description and representation of particle shape. Earth Surface Processes and Landforms 18, 665-672.\nBishop, C.M., 1994. Neural networks and their applications. Review of Scientific Instruments 65, 1803 -1832.\nChiachia, G., Falcao, A., Rocha, A., 2011. Person-specific face representation for recognition, in: Biometrics (IJCB), 2011 International Joint Conference on, IEEE. pp. 1-8.\nChoudhury, K.R., Meere, P.A., Mulchrone, K.F., 2006. Automated grain boundary detection by casrg. Journal of Structural Geology 28, 363-375.\nDengiz, O., Smith, A.E., Nettleship, I., 2005. Grain boundary detection in microstructure images using computational intelligence. Comput. Ind. 56, 854-866.\nDeutsch, C.V., 2002. Geostatistical Reservoir Modeling. Oxford University Press, Inc., New York, New York.\nDijkstra, E.W., 1959. A note on two problems in connexion with graphs. Numerische Mathe-matik 1, 269-271.\nDobkins, J., Folk, R., 1970. Shape development on tahiti-nui. Journal of Sedimentary Petrology 4, 1167-1203.\nEhrlich, R., Chin, M., 1980. Fourier grain-shape analysis: A new tool for sourcing and tracking abyssal silts. Marine Geology 38, 219-231.\nFalcao, A., Udupa, J., Miyazawa, F., 2000. An ultra-fast user-steered image segmentation paradigm: Live-wire-on-the-fly. IEEE Transactions on Medical Imaging 19, 55-62.\nFalcao, A.X., Bergo, F.P.G., 2004. Interactive volume segmentation with differential image foresting transforms. IEEE Transactions on Medical Imaging 23, 1100-1108.\nFalcao, A.X., Stolfi, J., Lotufo, R.A., 2004. The image foresting transform: Theory, algorithms, and applications. IEEE Transactions on Pattern Analysis and Machine Intelligence 26, 19-29.\nFalcao, A.X., Udupa, J.K., Samarasekera, S., Sharma, S., Hirsch, B.E., Lotufo, R.A., 1998. User-steered image segmentation paradigms: Live-wire and live-lane. Graphical Models and Image Processing 60, 233-260.\nGirao, G., 2006. Site da hydrolog, servicos de perfilagem ltda. http://geraldogirao. com/apostilas.htm/.\nGorsevski, P.V., Onasch, C.M., Farver, J.R., Ye, X., 2012. Detecting grain boundaries in deformed rocks using a cellular automata approach. Computers &amp; Geosciences 42, 136142.\nHaykin, S., 2001. Redes Neurais - Principios e Pratica. Bookman Companhia Ed.\nHecht-Nielsen, R., 1990. Neurocomputing. Addison-Wesley Publishing Company, Redwood City.\nKohonen, T., Schroeder, M.R., Huang, T.S. (Eds.), 2001. Self-Organizing Maps. SpringerVerlag New York, Inc., Secaucus, NJ, USA. 3rd edition.\nKrumbein, W., . Measurement and geological significance of shape and roundness of sedimentary particles. Journal of Sedimentary Petrology 11, 64-72.\nLi, Y., Onasch, C.M., Guo, Y., 2008. Gis-based detection of grain boundaries. Journal of Structural Geology 30, 431-443.\nLotufo, R., Falcao, A., Zampirolli, F., 2002. IFT-Watershed from gray-scale marker, in: Proceedings of XV Brazilian Symp. on Computer Graphics and Image Processing, IEEE. pp. 146-152.\nLu, B., Cui, M., liu liu liu liu, Q., Wang, Y., 2009. Automated grain boundary detection using the level set method. Computers &amp; Geosciences 35, 267-275.\nLu, B., Ning, C., 2010. Pde-based grain boundary detection, in: IITA-GRS 2010 volume 2 content, pp. 170-173.\nMaschio, C., Vidal, A.C., Schiozer, D.J., 2008. A framework to integrate history matching and geostatistical modeling using genetic algorithm and direct search methods. Journal of Petroleum Science and Engineering 63, 34-42.\nMiranda, P.A.V., Falcao, A.X., Udupa, J.K., 2010. Synergistic Arc-Weight Estimation for Interactive Image Segmentation using Graphs. Computer Vision and Image Understanding 114, 85-99.\nMiyoshi, S.d.C., 2010. Modelo Kernel PCA-Genetico para Ajuste de Historico. Master\u2019s thesis. Pontificia Universidade Catolica do Rio de Janeiro.\nPapa, J., Falcao, A., Suzuki, C., 2009a. Supervised pattern classification based on optimumpath forest. International Journal of Imaging Systems and Technology 19, 120-131.\nPapa, J., Nakamura, R., de Albuquerque, V., Falcao, A., Tavares, J., 2012. Computer techniques towards the automatic characterization of graphite particles in metallographic images of industrial materials. Expert Systems With Applications .\nPapa, J.P., Falcao, A.X., Suzuki, C.T.N., 2009b. Supervised pattern classification based on optimum-path forest. International Journal of Imaging Systems Technology 19, 120-131.\nRocha, L.M., Cappabianco, F.A.M., Falcao, A.X., 2009. Data clustering as an optimumpath forest problem with applications in image analysis. International Journal of Imaging Systems and Technology 19, 50-68.\nSalembier, P., Oliveras, A., Guarrido, L., 1998. Antiextensive connected operators for image and sequence processing. IEEE Transactions on Image Processing 7, 555-570.\nShi, J., Malik, J., 2000. Normalized cuts and image segmentation. IEEE Transactions on Pattern Analysis and Machine Intelligence 22, 888-905.\nSneed, E.D., Folk, R.L., 1958. Pebbles in the Lower Colorado River, Texas a Study in Particle Morphogenesis. Journal of Geology 66, 114-150.\nSpina, T.V., Falcao, A.X., Miranda, P.A.V., 2011a. Intelligent understanding of user interaction in image segmentation. International Journal of Pattern Recognition and Artificial Intelligence To appear.\nSpina, T.V., Falcao, A.X., Miranda, P.A.V., 2011b. User-steered image segmentation using live markers, in: International Conference on Computer Analysis of Images and Patterns (CAIP), Springer-Verlag, Seville, Spain. To appear.\nSuzuki, C., Gomes, J., Falcao, A., Papa, J., Hoshino-Shimizu, S., 2012. Automatic segmentation and classification of human intestinal parasites from microscopy images .\nTiab, D., Donaldson, E., 2004. Petrophysics: Theory and Practice of Measuring Reservoir Rock and Fluid Transport Properties.\nVan de Berg, E., Meesters, A., Kenter, J., Schlager, W., 2002. Automated separation of touching grains in digital images of thin sections. Computers &amp; Geosciences, 179-190.\nWadell, H., 1932. Volume, Shape, and Roundness of Rock Particles. Journal of Geology 40, 443-451.\nYu, C., Ruppert, G., Nguyen, D., Falcao, A., Liu, Y., 2012. Statistical asymmetry-based brain tumor segmentation from 3d mr images. Proc. of the Intl. Conf. on Bio-inspired Systems and Signal Processing (BIOSIGNALS), 527-533.\nZingg, T., 1935. Beitrag zur Schotteranalyse. Schweizerische Mineralogische und Petro-graphische Mitteilungen 15, 38-140.\nA\nImagens dos resultados da segmentac\u00e3o autom\u00e1tica e correcoes interativas\n(b)\n(a)\n(b)\n(a)\nB\nImagens dos contornos e eixos dos graos\n(a)\n(b)\nFigura B.1: Contorno dos graos e eixos das amostras: (a) S1 (b) S2.\n(c)\n(a)\n(b)\nFigura B.2: Contorno dos gr\u00e3os e eixos das amostras: (a) S4 (b) S5 (c) S7.\nC\nResultados para an\u00e1lise dos eixos dos gr\u00e3os\n(a)\t(b)\nAmostra SI\nFator de Forma F\n(c)\nAmostra SI\nEsferiddade y'\n(d)\n(a -1>) / (a - c)\n(b)\n(a)\n(a -1>) / (a - c)\n(c)\n(d)\nFigura C.2: Amostra S1 - Resultados das aplica\u00e7\u00f5es dos m\u00e9todos para analise da forma dos gr\u00e3os: (a) Indice Oblato-Prolato (b) Distribui\u00e7ao do Indice Oblato-Prolato (c) Indice MPS (d) Distribui\u00e7ao do Indice MPS.\n(a)\t(b)\nAmostra S2\nFator de Forma F\n(c)\n(a)\t(b)\n(c)\nAmostra S2\n0.2\t0.3\t0.4\t05\t0.6\t0.7\t0.S\t0.9\t1\nMSP\n(d)\nFigura C.4: Amostra S2 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) Indice Oblato-Prolato (b) Distribuyo do Indice Oblato-Prolato (c) Indice MPS (d) Distribuyo do \u00edndice MPS.\n(a)\t(b)\nAmostra S4\nFator de Forma F\n(c)\n(a)\t(b)\n(a -1>) / (a - c)\n(c)\n0.2\t0.3\t0.4\t05\t0.6\t0.7\t0.3\t0.9\t1\nMSP\n(d)\nFigura C.6: Amostra S4 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) Indice Oblato-Prolato (b) Distribuyo do Indice Oblato-Prolato (c) Indice MPS (d) Distribuyo do \u00edndice MPS.\n(a)\t(b)\nAmostra S5\nFator de Forma F\n(c)\n(a)\t(b)\n(c)\n40.0\n35.0\n30.0 \u201425.0\n\u00a3 .3\nI200\n9\nCT \u00a3\n\u201c\u25a015.0\n10.0\n5.0\n0.0\nAmostra S5\n0.2\t0.3\t0.4\t05\t0.6\t0.7\t0.3\t0.9\t1\nMSP\n(d)\nFigura C.8: Amostra S5 - Resultados das aplica\u00e7\u00f5es dos m\u00e9todos para analise da forma dos gr\u00e3os: (a) Indice Oblato-Prolato (b) Distribui\u00e7ao do Indice Oblato-Prolato (c) Indice MPS (d) Distribui\u00e7ao do \u00edndice MPS.\n(a)\nAmostra S7\t# \u2666 \u2666 \u2666 \u2666\n1\t+ +\nIII\t*:** \u2666\n\t*+ + **\u2666*\n(c)\n(d)\n(a)\n(b)\n(c)\n(d)\nFigura C.10: Amostra S7 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) Indice Oblato-Prolato (b) Distribuicao do Indice Oblato-Prolato (c) Indice MPS (d) Distribuicao do \u00edndice MPS."}]}}}