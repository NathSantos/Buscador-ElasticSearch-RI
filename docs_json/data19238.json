{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.23811"}, {"@name": "filename", "#text": "8060_Dissertacao_Rafael_Cabral_de_Moura.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "Universidade Federal de Pernambuco\n\nCentro de Tecnologia e Geocie?ncias\n\nPo?s-graduac?a?o em Engenharia Meca?nica\n\nDissertac?a?o de Mestrado\n\nSimulac?a?o de Reservato?rios de Petro?leo\nno Ambiente OpenFOAM\n\nRafael Cabral de Moura\n\nOrientador: Ramiro Brito Willmersdorf, Ph. D.\nCo-Orientador: Paulo Roberto Maciel Lyra, Ph. D.\n\nRecife\nFevereiro de 2012\n\n\n\nUniversidade Federal de Pernambuco\n\nCentro de Tecnologia e Geocie?ncias\n\nPo?s-graduac?a?o em Engenharia Meca?nica\n\nDissertac?a?o de Mestrado\n\nSimulac?a?o de Reservato?rios de Petro?leo\nno Ambiente OpenFOAM\n\nRafael Cabral de Moura\n\nTrabalho apresentado ao Programa de Po?s-Graduac?a?o\nem Meca?nica Computacional do Departamento de En-\ngenharia Meca?nica da Universidade Federal de Pernam-\nbuco como requisito parcial para obtenc?a?o do grau de\nMestre em Engenharia Meca?nica.\n\nOrientador: Ramiro Brito Willmersdorf, Ph. D.\nCo-Orientador: Paulo Roberto Maciel Lyra, Ph. D.\n\nRecife\nFevereiro de 2012\n\n\n\n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n\nCataloga\u00e7\u00e3o na fonte \nBibliotec\u00e1ria Margareth Malta, CRB-4 / 1198 \n\n \n\nM929s Moura, Rafael Cabral de. \nSimula\u00e7\u00e3o de reservat\u00f3rios de petr\u00f3leo no ambiente OpenFOAM / \n\nRafael Cabral de Moura. - Recife: O Autor, 2012. \nvii, 71 folhas, il., gr\u00e1fs., tabs. \n \nOrientador: Prof. Dr. Ramiro Brito Willmersdorf. \nCo-Orientador: Prof. Dr. Paulo Roberto Maciel Lyra. \nDisserta\u00e7\u00e3o (Mestrado) \u2013 Universidade Federal de Pernambuco. CTG. \n\nPrograma de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia Mec\u00e2nica, 2012. \nInclui Refer\u00eancias Bibliogr\u00e1ficas. \n \n1. Engenharia Mec\u00e2nica. 2. Meios porosos. 3. Escoamento multif\u00e1sico. \n\n4. IMPES. 5. OpenFOAM. 6. Volumes finitos. 7. Programa\u00e7\u00e3o paralela.  I. \nWillmersdorf, Ramiro Brito. (Orientador).  II. Lyra, Paulo Roberto Maciel. \n(Co-Orientador). III. T\u00edtulo. \n\n      \n                        UFPE \n \n621 CDD (22. ed.)          BCTG/2012-169 \n\n \n\n\n\nSimulac?a?o de Reservato?rios de Petro?leo no Ambiente\nOpenFOAM\n\nRafael Cabral de Moura\n\nTrabalho apresentado ao Programa de Po?s-Graduac?a?o em Meca?nica Com-\nputacional do Departamento de Engenharia Meca?nica da Universidade Fede-\nral de Pernambuco como requisito parcial para obtenc?a?o do grau de Mestre\nem Engenharia Meca?nica.\n\nAprovada por:\n\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nRamiro Brito Willmersdorf Ph. D.\n\n(Orientador)\n\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nPaulo Roberto Maciel Lyra Ph. D.\n\n(Co-Orientador)\n\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nDarlan K. E. de Carvalho Dr.\n\n(Examinador Interno)\n\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nRoge?rio Soares da Silva Dr.\n\n(Examinador Externo: CAA-UFPE)\n\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nBernardo Horowitz Ph. D.\n\n(Examinador Externo: DECIV-UFPE)\n\nRecife\nFevereiro de 2012\n\n\n\nA? Andelson Cabral de Moura.\n\n\n\n\u201cA simplicidade e? o u?ltimo degrau da sabedoria.\u201d\n\nKhalil Gibran\n\n\n\nii\n\nAgradecimentos\n\nAgradec?o primeiramente a Deus, que me deu a oportunidade de estar en-\ntre grandes pessoas e realizar muitos de meus sonhos. Agradec?o ao professor\nRamiro, por ter pacie?ncia comigo e sempre me mostrar, com muita calma, o\ncaminho certo a seguir. A minha esposa por me ajudar muito e me dar apoio\nnos momentos mais decisivos de minha vida. Aos amigos do LabCom, que\nsempre juntos discutem e resolvem a maioria dos problemas impostos, contri-\nbuindo tambe?m com cr??ticas ao trabalho. Agradec?o ao meu amigo Bruno de\nJesus que muito me ajudou durante os meus trabalhos. Por u?ltimo, agradec?o\na? minha fam??lia que acreditou em mim e sempre me encorajou a continuar\ncom meus estudos.\n\n\n\niii\n\nResumo\n\nNeste trabalho foi implementado um programa para simulac?a?o compu-\ntacional de reservato?rios de petro?leo, baseado no ambiente OpenFOAM R\u00a9,\nque e? um sistema de desenvolvimento para programac?a?o cient??fica orientado\na objetos, paralelo, de alto n??vel e com alto desempenho. Esse ambiente\nde desenvolvimento oferece grande flexibilidade quanto a? escolha dos me?-\ntodos de dicretizac?a?o, interpolac?a?o e soluc?a?o dos sistemas resultantes. O\nOpenFOAM R\u00a9 e? uma biblioteca da linguagem C++ que, atrave?s de suas\nva?rias ferramentas, pode ser usada para a soluc?a?o de problemas envolvendo\nequac?o?es diferenciais parciais. Para a soluc?a?o o ambiente emprega o me?todo\ndos volumes finitos, usando malhas estruturadas ou na?o estruturadas. Neste\ntrabalho foram usadas apenas malhas estruturadas. O simulador desenvol-\nvido trata problemas descritos pelo modelo de escoamento bifa?sico imisc??vel\na?gua-o?leo que e? descrito por um sistema de equac?o?es diferenciais parciais\naltamente na?o-lineares, obtidas atrave?s da conservac?a?o da massa para cada\nfase, e do uso da Lei de Darcy para relacionar fluxos de massa com gradientes\nde potencial fluido. Para a integrac?a?o temporal das equac?o?es e? empregado o\nme?todo IMPES, no qual o sistema composto pela equac?a?o de conservac?a?o de\nmassa e pela Lei de Darcy e? reescrito em termos de uma equac?a?o para a pres-\nsa?o de o?leo, que e? resolvida implicitamente, e uma equac?a?o para a saturac?a?o\nde a?gua, que e? resolvida explicitamente.\n\nPalavras-chave: Meios Porosos, Escoamento Multifa?sico, IMPES, Open-\nFOAM, Volumes Finitos, Programac?a?o Paralela.\n\n\n\niv\n\nAbstract\n\nIn this work a program for computer simulation of oil reservoirs was im-\nplemented. The program was based on OpenFOAM R\u00a9 framework, which\nis a development system for scientific object-oriented programming, paral-\nlel, high-level and high performance computation. This development fra-\nmework provides great flexibility in the choice of dicretization and interpo-\nlation methods and for solving the resulting systems. The OpenFOAM R\u00a9 is\na library of C++ language which, through its various tools, can be used to\nsolve problems involving partial differential equations. The OpenFOAM R\u00a9\nframework employs the finite volume method, using structured or unstructu-\nred meshes. In this work only structured meshes were used. The simulator\nwas developed for problems described by the model of imiscible two-phase\nflow of water and oil is which described by a system of highly nonlinear partial\ndifferential equations, obtained by considering conservation of mass of each\nphase, and the use of Darcy\u2019s Law to relate mass flows with gradients of fluid\npotential. For the temporal integration of the equations the IMPES method\nis employed. The system composed of the mass conservation equation and\nDarcy\u2019s Law is rewritten in terms of an equation for the oil pressure, which\nis solved implicitly, and an equation for water saturation, which is solved\nexplicitly.\n\nKeywords: Porous Medium, Multiphasic Flow, IMPES, OpenFOAM, Fi-\nnite Volume, Parallel Programing.\n\n\n\nSuma?rio\n\n1 Introduc?a?o 3\n1.1 Motivac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4\n1.2 Objetivos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5\n1.3 Organizac?a?o da dissertac?a?o . . . . . . . . . . . . . . . . . . . . 6\n\n2 OpenFOAM 7\n2.1 Programac?a?o no OpenFOAM . . . . . . . . . . . . . . . . . . 8\n2.2 Estrutura do OpenFOAM . . . . . . . . . . . . . . . . . . . . 9\n2.3 Aplicac?o?es . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10\n\n2.3.1 Difusa?o de calor . . . . . . . . . . . . . . . . . . . . . . 12\n2.3.2 Advecc?a?o linear . . . . . . . . . . . . . . . . . . . . . . 13\n\n2.4 Casos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15\n\n3 Equac?o?es Governantes 20\n3.1 Propriedades da rocha e dos fluidos . . . . . . . . . . . . . . . 21\n3.2 Lei de Darcy . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24\n3.3 Lei da conservac?a?o de massa . . . . . . . . . . . . . . . . . . . 25\n3.4 Escoamento monofa?sico . . . . . . . . . . . . . . . . . . . . . . 27\n3.5 Escoamento bifa?sico . . . . . . . . . . . . . . . . . . . . . . . . 28\n\n4 Modelagem Computacional 36\n4.1 Discretizac?a?o do dom??nio . . . . . . . . . . . . . . . . . . . . . 36\n4.2 Discretizac?a?o das equac?o?es . . . . . . . . . . . . . . . . . . . . 37\n\n4.2.1 Discretizac?a?o dos operadores de difusa?o . . . . . . . . . 38\n4.2.2 Discretizac?a?o dos operadores de advecc?a?o . . . . . . . . 39\n4.2.3 Discretizac?a?o temporal . . . . . . . . . . . . . . . . . . 41\n\n4.3 Me?todo IMPES . . . . . . . . . . . . . . . . . . . . . . . . . . 42\n4.3.1 Tratamento das na?o linearidades . . . . . . . . . . . . 43\n\n5 Aplicac?a?o IMPES 45\n5.1 Criac?a?o da aplicac?a?o . . . . . . . . . . . . . . . . . . . . . . . 46\n\nv\n\n\n\nSUMA?RIO vi\n\n5.2 Criac?a?o do caso . . . . . . . . . . . . . . . . . . . . . . . . . . 50\n\n6 Resultados 53\n6.1 Resultados da aplicac?a?o de escoamento monofa?sico . . . . . . 53\n6.2 Verificac?a?o da aplicac?a?o IMPES . . . . . . . . . . . . . . . . . 54\n\n6.2.1 Escoamento unidimensional . . . . . . . . . . . . . . . 55\n6.2.2 Escoamento bidimensional . . . . . . . . . . . . . . . . 57\n6.2.3 Escoamento tridimensional . . . . . . . . . . . . . . . . 60\n6.2.4 Caso heteroge?neo bidimensional . . . . . . . . . . . . . 63\n6.2.5 Caso heteroge?neo tridimensional . . . . . . . . . . . . . 65\n\n7 Concluso?es e Trabalhos Futuros 66\n7.1 Concluso?es . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66\n7.2 Trabalhos futuros . . . . . . . . . . . . . . . . . . . . . . . . . 66\n\nBibliografia 68\n\n\n\nLista de Figuras\n\n2.1 Estrutura do ambiente OpenFOAM [4]. . . . . . . . . . . . . . 9\n2.2 Esquema do caso de difusa?o. . . . . . . . . . . . . . . . . . . . 15\n2.3 Estrutura do direto?rio de um caso. . . . . . . . . . . . . . . . 16\n2.4 Malha da discretizac?a?o do problema de calor. . . . . . . . . . 19\n2.5 Soluc?a?o do caso com o problema de calor. . . . . . . . . . . . 19\n\n3.1 Aplicac?a?o dos modelos de fluxo. Modificado de [20] apud [29]. 21\n3.2 Comportamento do fator volume de formac?a?o. . . . . . . . . . 23\n3.3 Comportamento da viscosidade. . . . . . . . . . . . . . . . . . 24\n3.4 Esquema de fluxo. . . . . . . . . . . . . . . . . . . . . . . . . . 26\n3.5 Curvas de permeabilidade relativa. . . . . . . . . . . . . . . . 30\n3.6 Curvas de pressa?o capilar [29]. . . . . . . . . . . . . . . . . . . 31\n3.7 Saturac?a?o na zona de transic?a?o [29]. . . . . . . . . . . . . . . . 32\n\n4.1 Volume de controle. . . . . . . . . . . . . . . . . . . . . . . . . 37\n4.2 Tipos de volume de controle do OpenFOAM. . . . . . . . . . . 38\n4.3 Vetores ~S e ~d para uma malha na?o ortogonal [25]. . . . . . . . 39\n4.4 Interpolac?a?o linear [25]. . . . . . . . . . . . . . . . . . . . . . . 40\n4.5 Representac?a?o de duas ce?lulas vizinhas. . . . . . . . . . . . . . 44\n\n5.1 Caso que utiliza a aplicac?a?o IMPES. . . . . . . . . . . . . . . 50\n5.2 Esquema five-spot. . . . . . . . . . . . . . . . . . . . . . . . . 51\n5.3 Ajuste da traje?toria de um poc?o direcional. . . . . . . . . . . . 52\n\n6.1 Soluc?a?o de pressa?o do caso monofa?sico. . . . . . . . . . . . . . 54\n6.2 Malha usada no problema unidimensional. . . . . . . . . . . . 56\n6.3 Comparac?a?o do perfil de pressa?o 1D. . . . . . . . . . . . . . . 56\n6.4 Comparac?a?o do perfil de saturac?a?o 1D. . . . . . . . . . . . . . 57\n6.5 Malha usada no problema bidimensional. . . . . . . . . . . . . 58\n6.6 Soluc?a?o da pressa?o no problema bidimensional. . . . . . . . . . 58\n6.7 Comparac?a?o das soluc?o?es de pressa?o 2D na direc?a?o diagonal. . 59\n6.8 Soluc?a?o da saturac?a?o do problema bidimensional. . . . . . . . 59\n\nvii\n\n\n\nLISTA DE FIGURAS 1\n\n6.9 Comparac?a?o das soluc?o?es de saturac?a?o 2D na direc?a?o diagonal. 60\n6.10 Malha usada no problema tridimensional. . . . . . . . . . . . . 60\n6.11 Soluc?a?o da saturac?a?o do problema tridimensional. . . . . . . . 61\n6.12 Comparac?a?o das soluc?o?es de saturac?a?o 3D na direc?a?o diagonal. 61\n6.13 Soluc?a?o da pressa?o do problema tridimensional no IMEX. . . . 62\n6.14 Soluc?a?o da pressa?o do problema tridimensional no OpenFOAM. 62\n6.15 Comparac?a?o das soluc?o?es de pressa?o 3D na direc?a?o diagonal. . 63\n6.16 Mapa de permeabilidades do caso bidimensional. . . . . . . . . 63\n6.17 Soluc?a?o do caso heteroge?neo bidimensional. . . . . . . . . . . . 64\n6.18 Permeabilidades do caso tridimensional. . . . . . . . . . . . . 65\n6.19 Permeabilidades do caso tridimensional. . . . . . . . . . . . . 65\n\n\n\nLista de Tabelas\n\n2.1 Padra?o de unidades no OpenFOAM. . . . . . . . . . . . . . . 13\n\n3.1 Fatores de conversa?o de unidades. . . . . . . . . . . . . . . . . 25\n\n5.1 Listagem dos campos criados na aplicac?a?o. . . . . . . . . . . . 47\n\n6.1 Propriedades do fluido (Caso monofa?sico). . . . . . . . . . . . 53\n6.2 Propriedades da rocha (Caso monofa?sico). . . . . . . . . . . . 54\n6.3 Propriedades da rocha (Caso bifa?sico). . . . . . . . . . . . . . 55\n6.4 Propriedades dos fluidos (Caso bifa?sico). . . . . . . . . . . . . 55\n6.5 Curvas de permeabilidade relativa e pressa?o capilar. . . . . . . 55\n\n2\n\n\n\nCap??tulo 1\n\nIntroduc?a?o\n\nA modelagem computacional do escoamento multifa?sico em meios poro-\nsos e? uma das principais ferramentas no gerenciamento de reservato?rios de\npetro?leo. Atrave?s do modelo de fluxo de um reservato?rio o engenheiro que\no gerencia e? capaz de prever o comportamento das presso?es e fazer uma es-\ntimativa da produc?a?o futura de o?leo. Com a previsa?o do comportamento\nda vaza?o de o?leo ao longo do tempo e com uma estimativa do prec?o futuro\ndo barril de o?leo e? feita uma ana?lise econo?mica que determina por quanto\ntempo o reservato?rio continuara? a produzir e a viabilidade, ou na?o, da im-\nplantac?a?o de projetos no campo. Assim como a modelagem computacional,\ntambe?m podem ser empregados outros me?todos, como o balanc?o de materiais\nabordado em [17], [16], [24] e a ana?lise por curvas de decl??nio de produc?a?o\nproposta inicialmente em [8] e posteriormente abordada por [31], [22] e [21].\nAtrave?s das estimativas de produc?a?o feitas pelos engenheiros de reservato?rios\ne das datas de abandono de cada campo tem-se o valor das reservas de uma\nempresa de petro?leo. Atrave?s de simuladores de fluxo pode-se estimar o ga-\nnho que obte?m-se com me?todos de recuperac?a?o secunda?ria de petro?leo, como\ninjec?a?o de a?gua [18] [15], vapor [23], pol??meros [11] [32], bacte?rias [10], sur-\nfactantes [37] e me?todos de combusta?o in-situ. O posicionamento dos poc?os\ne os volumes de a?gua e vapor a serem injetados sa?o alguns dos para?metros\noperacionais buscados ao se fazer uma simulac?a?o de um reservato?rio de pe-\ntro?leo. Para cada me?todo de recuperac?a?o te?m-se uma modelagem associada\ne atrave?s de simuladores desenvolvidos para cada me?todo e? poss??vel construir\numa previsa?o do comportamento dos reservato?rios.\n\nNeste trabalho foi desenvolvido um simulador de escoamento bifa?sico em\nmeios porosos no ambiente OpenFOAM. O simulador usa como base o am-\nbiente OpenFOAM (Open Field Operator and Manipulator) que e? uma bi-\nblioteca escrita em C++ com ferramentas para a soluc?a?o de problemas de\nvolumes finitos e elementos finitos. O desenvolvimento de um programa para\n\n3\n\n\n\nCAPI?TULO 1. INTRODUC?A?O 4\n\na simulac?a?o de um determinado feno?meno f??sico nesse sistema se da? por meio\nde aplicac?o?es que usam as classes existentes no ambiente. O ambiente possui\naplicac?o?es prontas para a maioria dos feno?menos de dina?mica dos fluidos, in-\nclusive para alguns casos envolvendo meios porosos. Antes da implementac?a?o\ndo simulador foram feitas aplicac?o?es no sistema para a soluc?a?o de problemas\nmais simples com o objetivo de facilitar o aprendizado. Uma das dificuldades\nno uso desse ambiente e? a pouca documentac?a?o dispon??vel para estudo, desta\nforma, a reconstruc?a?o de programas para a soluc?a?o de problemas simples\nfacilitou o aprendizado.\n\nInicialmente, foram feitas aplicac?o?es para a soluc?a?o de problemas envol-\nvendo equac?o?es parabo?licas, hiperbo?licas e el??pticas. A partir destes progra-\nmas que envolvem os tipos ba?sicos de equac?o?es, pode-se desenvolver progra-\nmas para solucionar casos que envolvam uma combinac?a?o desses feno?menos.\nNesse ambiente OpenFOAM, uma vez desenvolvida uma aplicac?a?o tem-se um\nsolver gene?rico, cujos esquemas de discretizac?a?o, interpolac?a?o e me?todos para\na soluc?a?o do sistema de equac?o?es resultante sera?o especificados em um dire-\nto?rio com as caracter??sticas do caso a ser simulado. Os direto?rios contendo\nos casos que usam as aplicac?o?es devem ser organizados segundo o padra?o do\nsistema. As aplicac?o?es desenvolvidas usando as classes do OpenFOAM mo-\ndelam problemas tridimensionais mas podem ser usadas para resolver casos\nunidimensionais e bidimensionais. Desta forma, uma aplicac?a?o e? escrita de\numa forma gene?rica, podendo-se mudar o nu?mero de dimenso?es de acordo\ncom o caso estudado. Em cada caso que use uma aplicac?a?o, pode-se mudar\no nu?mero de dimenso?es do problema, a geometria, as condic?o?es de contorno\ne os me?todos de discretizac?a?o. Assim cada aplicac?a?o pode ser utilizada de\ndiferentes modos o que facilita a verificac?a?o de qual combinac?a?o de esquemas\nresolve melhor um determinado problema. As primeiras apliac?o?es que foram\nresolvidas tratam de problemas de conduc?a?o de calor em regime permanente,\nem regime transiente e problemas de advecc?a?o. Como etapa inicial no de-\nsenvolvimento do simulador de reservato?rios foi feita uma aplicac?a?o para a\nsoluc?a?o do caso de escoamento monofa?sico em meios porosos. Neste problema\ne? resolvida apenas a equac?a?o de difusa?o que e? similar a equac?a?o de pressa?o\nque e? resolvida no simulador bifa?sico. A soluc?a?o deste tipo de problema foi\nimportante na verificac?a?o das te?cnicas empregadas no simulador bifa?sico.\n\n1.1 Motivac?a?o\n\nO OpenFOAM e? uma biblioteca escrita na linguagem C++ que conte?m\nferramentas para a soluc?a?o de problemas da meca?nica do cont??nuo, para mo-\ndelagem de reac?o?es qu??micas, matema?tica financeira e qualquer problema que\n\n\n\nCAPI?TULO 1. INTRODUC?A?O 5\n\npossa ser descrito atrave?s de equac?o?es diferenciais parciais e ordina?rias. Com\nalguma experie?ncia no sistema pode-se desenvolver aplicac?o?es com rapidez e\nflexibilidade. O OpenFOAM e? um sistema naturalmente paralelo e a imple-\nmentac?a?o de suas aplicac?o?es e? feita atrave?s de me?todos e objetos de alto n??vel\ncriados com classes que sa?o escritas em paralelo, o que e? mais uma grande\nvantagem no uso desse sistema, visto que, a implementac?a?o de programas\nparalelos e? complexa e requer muito tempo dependendo do problema a ser\nresolvido. O modelo bifa?sico e? bastante utilizado na modelagem problemas\nde injec?a?o a fim de se determinar a eficie?ncia de diferentes configurac?o?es de\ndisposic?a?o dos poc?os injetores e produtores. A implementac?a?o de um simula-\ndor de reservato?rios nesse ambiente possibilita a investigac?a?o da aplicac?a?o das\ndiversas ferramentas nume?ricas do sistema na soluc?a?o deste tipo de problema.\n\n1.2 Objetivos\n\nEste trabalho teve como objetivo geral a implementac?a?o de um programa\npara a simulac?a?o computacional de reservato?rios de petro?leo, baseado em\num ambiente de desenvolvimento para programac?a?o cient??fica orientado a\nobjetos, paralelo, de alto n??vel e com alto desempenho. O simulador trata\nde problemas descritos pelo modelo de escoamento bifa?sico e imisc??vel o?leo-\na?gua. Para alcanc?ar o objetivo geral, as seguintes metas instermedia?rias\nforam definidas:\n\n\u2022 Estudo da formulac?a?o matema?tica envolvida;\n\n\u2022 Investigac?a?o e escolha do me?todo nume?rico e das linearizac?o?es a serem\nusadas no problema;\n\n\u2022 Estudo do funcionamento do ambiente OpenFOAM;\n\n\u2022 Desenvolvimento de aplicac?o?es no ambiente para a soluc?a?o de proble-\nmas modelo de advecc?a?o e difusa?o;\n\n\u2022 Desenvolvimento de uma aplicac?a?o para soluc?a?o do problema de esco-\namento monofa?sico em meios porosos;\n\n\u2022 Desenvolvimento da aplicac?a?o para a soluc?a?o do problema de escoa-\nmento bifa?sico em meios porosos.\n\n\n\nCAPI?TULO 1. INTRODUC?A?O 6\n\n1.3 Organizac?a?o da dissertac?a?o\n\nEste trabalho esta? dividido em sete cap??tulos e uma bibliografia incluindo-\nse a introduc?a?o. Os cap??tulos esta?o dispostos segundo a seque?ncia de trabalho\nrealizada para atingir o objetivo geral do trabalho. Os cap??tulos abordam os\nseguintes temas:\n\n\u2022 Cap??tulo 1: Introduc?a?o. No presente cap??tulo e? feita uma breve in-\ntroduc?a?o ao objetivo de se usar um simulador de reservato?rios seguida\nde um resumo da metodologia empregada na construc?a?o do simulador\nfeito neste trabalho. Sa?o apresendadas as caracter??sticas do sistema\nque motivaram a sua escolha e os objetivos que se esperavam atingir\nao te?rmino do trabalho.\n\n\u2022 Cap??tulo 2: OpenFOAM. Sa?o apresentadas algumas das caracter??sticas\ndo ambiente de desenvolvimento utilizado bem como alguns exemplos\nde programas desenvolvidos no sistema e algumas soluc?o?es encontradas.\n\n\u2022 Cap??tulo 3: Equac?o?es Governantes. No terceiro cap??tulo se encontram\nas equac?o?es matema?ticas dos modelos que regem o escoamento multi-\nfa?sico em reservato?rios de petro?leo e uma breve descric?a?o das proprie-\ndades da rocha e dos fluidos presentes.\n\n\u2022 Cap??tulo 4: Modelagem Computacional. Mostra a forma como o Open-\nFOAM faz a discretizac?a?o dos principais operadores diferenciais abor-\ndando, de maneira simplificada, como o sistema faz a interpolac?a?o das\npropriedades atrave?s dos elementos da malha gerada.\n\n\u2022 Cap??tulo 5: Aplicac?a?o IMPES. Apresenta a aplicac?a?o desenvolvida no\nsistema, com trechos do co?digo explicando o seu funcionamento.\n\n\u2022 Cap??tulo 6: Resultados. Sa?o descritos alguns resultados e e? feita uma\ncomparac?a?o entre o simulador desenvolvido e um programa comercial.\n\n\u2022 Cap??tulo 7: Concluso?es e Trabalhos Futuros. Traz uma breve conclusa?o\ndo trabalho e algumas propostas para poss??veis trabalhos futuros.\n\n\n\nCap??tulo 2\n\nOpenFOAM\n\nO OpenFOAM [26] [5] e? uma uma biblioteca de co?digo aberto escrita em\nC++ desenvolvida para utilizac?a?o no sistema Linux mas que pode ser uti-\nlizada em outros sistemas operacionais. Essa biblioteca conte?m namespaces\ncom classes que possuem me?todos para a manipulac?a?o de campos escala-\nres, vetoriais e tensoriais e para a discretizac?a?o de operadores diferenciais\ncomo gradiente, divergente e laplaciano. Estas classes definem objetos como\nmatrizes, malhas, arquivos de controle de simulac?a?o, campos dimensionais\ne adimensionais associados a malha ou na?o e muitos outros objetos relacio-\nnados com as operac?o?es envolvidas na programac?a?o cient??fica. A criac?a?o de\nprogramas usando essa biblioteca e? de alto n??vel visto que a maioria dos ope-\nradores aritme?ticos esta?o sobrecarregados para operac?o?es com os objetos que\nrepresentam os campos, pode-se enta?o cria?-los com pouco uso da linguagem\nC++ devido ao uso das sobrecargas. Os objetos que representam os campos\ne operadores sobrecarregados esta?o todos escritos de forma paralela, desse\nmodo, e? poss??vel criar programas paralelos programando-se serialmente.\n\nNa implementac?a?o de programas para a soluc?a?o nume?rica de equac?o?es\ndiferenciais parciais e? comum que se adote, antes, uma se?rie de esquemas\ne te?cnicas para a soluc?a?o do problema proposto. No final da implementa-\nc?a?o tem-se uma aplicac?a?o que resulta da combinac?a?o formada pelos me?todos\ne te?cnicas nume?ricas escolhidas, qualquer variac?a?o dessa combinac?a?o de es-\nquemas requer uma reprogramac?a?o no co?digo fonte. A orientac?a?o a objetos\ntem como objetivo o encapsulamento dos dados, a modularizac?a?o e o rea-\nproveitamento do co?digo. Os programas trabalham com a criac?a?o de objetos\nque pertencem a classes com caracter??sticas distintas. Pode-se pensar em\num programa de soluc?a?o nume?rica de equac?o?es diferenciais parciais (EDP\u2019s)\ncomo uma classe, na qual seus objetos derivados sa?o combinac?o?es dos me?-\ntodos nume?ricos escolhidos e com essas formas gene?ricas pode-se construir\no aplicativo. Um programa de soluc?a?o nume?rica de EDP\u2019s, que usa dife-\n\n7\n\n\n\nCAPI?TULO 2. OPENFOAM 8\n\nrenc?as finitas, por exemplo, necessita de um me?todo de discretizac?a?o, uma\nformulac?a?o a ser usada e um esquema de discretizac?a?o. Como me?todo de\ndiscretizac?a?o pode-se ter diferenc?as finitas, volumes finitos ou elementos fini-\ntos e a formulac?a?o pode ser impl??cita ou expl??cita ou ainda uma combinac?a?o\nentre ambas. O esquema de discretizac?a?o pode ser, no caso das diferenc?as\nfinitas uma combinac?a?o de derivadas para frente, para tra?s e centradas. A\nsoluc?a?o nume?rica do sistema de equac?o?es resultante, pode ser feita atrave?s\nde diferentes me?todos como: gradientes conjugados, gradiente bi-conjugado\nprecondicionado (Bi-CGStab) ou uma soluc?a?o usando multigrid [3].\n\nO OpenFOAM, oferece a possibilidade de criar, atrave?s de classes espec??fi-\ncas, programas que possuem uma forma gene?rica nos quais pode-se facilmente\nmudar a combinac?a?o de me?todos nume?ricos desejada, isso da? ao sistema uma\ngrande flexibilidade para a implementac?a?o de programas de soluc?a?o nume?rica\nde EDP\u2019s. Arquivos de entrada controlam quais me?todos sera?o usados em\ncada parte da aplicac?a?o, sem a necessidade de reescrever o co?digo fonte. O\nacoplamento de diferentes mo?dulos aos programas, de forma independente do\nco?digo ja? implementado, pode ser feito de maneira simples e ra?pida. O pro?-\nprio ambiente oferece muitas ferramentas para serem incorporadas a aplicac?a?o\ndesenvolvida. Ferramentas de gerac?a?o adaptativa de malhas, movimentac?a?o\nde malhas e mo?dulos de soluc?a?o dos sistemas resultantes com o uso de GPU\u2019s\n[6] encontram-se dispon??veis para o ambiente atualmente e alguns trabalhos\nja? foram publicados com o uso dessa ferramenta [30]. A biblioteca possui\nmuitos outros simuladores implementados que esta?o dispon??veis para uso.\n\n2.1 Programac?a?o no OpenFOAM\n\nExistem tre?s n??veis de utilizac?a?o do OpenFOAM [2]. A biblioteca conte?m\nprogramas com diferentes aplicac?o?es dos me?todos, que implementam pro-\ngramas para a soluc?a?o de problemas de dina?mica dos fluidos computacional,\nqu??mica, deformac?a?o dos so?lidos e economia. Pode-se utilizar esses programas\nprontos ou desenvolver programas aplicando os objetos e classes da biblioteca\ne ainda pode-se escrever outras classes. Os programas que acompanham o\nsistema sa?o chamados de aplicac?o?es do OpenFOAM, OpenFOAM applicati-\nons [4], ou solvers, e os programas desenvolvidos pelo usua?rio sa?o chamados\nde aplicac?o?es do usua?rio.\n\nAs aplicac?o?es sa?o utilizadas para resolver problemas f??sicos que, segundo a\nnomenclatura do sistema, sa?o chamados de casos. Por exemplo, na biblioteca\ntemos um simulador de fluxo de calor, o qual e? chamado de aplicac?a?o para\nproblemas de calor, um problema de fluxo de calor ao longo de uma barra\nretangular constitui um caso que sera? resolvido com essa aplicac?a?o. Neste tra-\n\n\n\nCAPI?TULO 2. OPENFOAM 9\n\nbalho foi desenvolvida uma aplicac?a?o para problemas de escoamento bifa?sico\nimisc??vel o?leo-a?gua em meios porosos, os casos simulados sa?o reservato?rios\nsujeitos a? injec?a?o de a?gua. Nas aplicac?o?es sa?o resolvidas as equac?o?es que\nmodelam o feno?meno f??sico relacionado, nos casos sa?o descritas as condic?o?es\niniciais e de contorno e e? definida a geometria do problema estudado. Ainda\nnos casos esta?o contidos os arquivos que controlara?o o comportamento das\nclasses das aplicac?o?es modificando o funcionamento das mesmas. Esse fluxo\nde trabalho do sistema permite que com uma mesma aplicac?a?o seja poss??vel\nresolver va?rios problemas com diferentes geometrias, para?metros de simula-\nc?a?o e esquemas nume?ricos atrave?s da mesma aplicac?a?o sem ser necessa?ria a\nimplementac?a?o de um programa diferente para cada caso.\n\n2.2 Estrutura do OpenFOAM\n\nO ambiente OpenFOAM esta? estruturado segundo o esquema apresen-\ntado na Figura 2.1, na qual as aplicac?o?es padra?o representam os simuladores\nescritos no ambiente OpenFOAM e que acompanham o sistema. Cada apli-\ncac?a?o pode fazer uso das utilidades do sistema que sa?o rotinas escritas para\na manipulac?a?o de dados, como por exemplo, leitura e escrita de arquivos,\ncriac?a?o de gra?ficos e estat??sticas de execuc?a?o do programa.\n\nFigura 2.1: Estrutura do ambiente OpenFOAM [4].\n\nNo sistema existe um gerador de malhas chamado blockmesh restrito ape-\nnas a gerac?a?o de malhas por blocos, no entanto, a gerac?a?o de malhas pode\nser feita em outro sistema, como o GMESH, e importada para o formato\nnativo atrave?s de utilidades desenvolvidas para a conversa?o entre os diver-\nsos formatos existentes. As utilidades em conjunto com as ferramentas de\nmanipulac?a?o de malha compo?em o mo?dulo de pre?-processamanto do sistema.\n\n\n\nCAPI?TULO 2. OPENFOAM 10\n\nAtrave?s das classes podem ser implementadas novas aplicac?o?es, as quais\nenquadram-se como aplicac?o?es do usua?rio, que podem fazer uso das utilidades\ndo sistema assim como as aplicac?o?es padra?o. No sistema existem aplicac?o?es\npadra?o para a soluc?a?o de problemas de difusa?o de calor, escoamento mul-\ntifa?sicos, escoamento sujeito a? reac?o?es qu??micas e escoamento superso?nico,\ndentre outros. Os programas implementados pelo usua?rio e as aplicac?o?es\npadra?o formam o mo?dulo de soluc?a?o do ambiente.\n\nA visualizac?a?o dos dados de simulac?a?o no sistema e? obtida atrave?s do\npacote de po?s processamento, que basicamente e? composto pelo programa\nParaView que e? distribuido junto a? biblioteca. Outros visualizadores podem\nser utilizados ja? que o OpenFOAM oferece ferramentas para exportar do\nformato nativo para a maioria dos formatos atualmente utilizados. Por ter\nco?digo aberto, facilmente pode ser implementada uma rotina para converter\nos dados de simulac?a?o para um formato que o sistema na?o reconhec?a. Uma\ndas maiores vantagens e? a possibilidade de criar utilidades e aplicac?o?es no\nambiente.\n\n2.3 Aplicac?o?es\n\nAplicac?o?es sa?o programas escritos em C++ que utilizam as classes de-\nfinidas no OpenFOAM. Nelas sa?o representadas as equac?o?es que modelam\no feno?meno f??sico estudado. Essas equac?o?es geram uma matriz de volumes\nfinitos que resulta da discretizac?a?o de cada termo representado. Um ope-\nrador diferencial no OpenFOAM e? descrito por meio de um me?todo, por\nexemplo para representar o operador de diverge?ncia usamos o me?todo div().\nCada uma das equac?o?es tem seus operadores diferenciais discretizados de\nacordo com um esquema. Desta forma, na aplicac?a?o na?o se descreve como\ncada operador sera? discretizado. No OpenFOAM os volumes de controle sa?o\ncentrados nas ce?lulas e alguns dos operadores de discretizac?a?o realizam ope-\nrac?o?es com os valores dos campos definidos nas faces dos elementos, desta\nforma e? necessa?rio interpolar os valores do centro das ce?lulas para as faces.\nEssa interpolac?a?o e? feita na aplicac?a?o sem especificar o me?todo de interpola-\nc?a?o usado, apenas pela chamada de um me?todo que converte um campo dos\ncentros para as faces. Uma vez desenvolvida uma aplicac?a?o tem-se um solver\ngene?rico, cujos esquemas de discretizac?a?o, interpolac?a?o e me?todos para a so-\nluc?a?o do sistema de equac?o?es resultante sera?o especificados em um direto?rio\ncom as caracter??sticas do caso a ser simulado. Apo?s a especificac?a?o dos es-\nquemas de discretizac?a?o te?m-se enta?o a formulac?a?o desejada para a soluc?a?o\nda equac?a?o. Adiante, sera?o mostradas as representac?o?es de equac?o?es e como\nfunciona a escolha dos me?todos de discretizac?a?o e interpolac?a?o.\n\n\n\nCAPI?TULO 2. OPENFOAM 11\n\nO OpenFOAM e? um ambiente de programac?a?o de alto n??vel orientado a?\nobejtos, os operadores matema?ticos esta?o todos sobrecarregados no sistema,\nde modo que se pode realizar operac?o?es sobre estruturas de dados paralelas\ncomo se estivesse fazendo uma simples operac?a?o aritme?tica. As classes imple-\nmentadas no sistema permitem que, em suas aplicac?o?es, sejam representadas\nde forma tensorial, as equac?o?es do feno?meno fisico que se deseja modelar,\ncomo na Equac?a?o (2.1).\n\n? (?)\n\n?t\n+ ?\u00b7 (U?) ??\u00b7 (????) = S? (2.1)\n\nA equac?a?o (2.1) e? t??pica de um problema de convecc?a?o-difusa?o que pode\nser representada em uma aplicac?a?o do OpenFOAM da seguinte maneira:\n\n1 fvScalarMatrix PhiEqn\n2 (\n3 fvm::ddt(phi)\n4 + fvc::div(U,phi)\n5 - fvc:: laplacian(Gamma ,phi)\n6 ==\n7 S\n8 )\n\nA representac?a?o da?-se atrave?s da chamada das classes como fvScalarMa-\ntrix que ira? criar o objeto phiEqn que representa a equac?a?o. Ao definir cada\ntermo da equac?a?o, atrave?s dos operadores diferenciais representados pelas\nclasses, o sistema cria uma matriz de coeficientes da discretizac?a?o resultante\nda ac?a?o de cada operador. Cada operador ira? agir segundo o especificado\npelo caso, ou seja, o me?todo de discretizac?a?o e interpolac?a?o das propriedades\nde cada um dos operadores pode mudar de acordo com o que for escolhido\nno caso. No caso dos operadores no namespace fvm sera?o feitas discretiza-\nc?o?es impl??citas, caso sejam usados os operadores diferenciais do namespace\nfvc a discretizac?a?o sera? feita de forma expl??cita. A possibilidade de mu-\ndar o esquema de discretizac?a?o sem ser necessa?ria a implementac?a?o de uma\nnova rotina, da? aos programas implementados nesse ambiente uma enorme\nflexibilidade, dessa forma e? poss??vel variar o me?todo nume?rico facilmente e a\ninvestigac?a?o de diferentes alternativas torna-se uma tarefa simples. A soluc?a?o\ndo sistema de equac?o?es resultante e? feita atrave?s da chamada de uma rotina\nde soluc?a?o, que assim como os operadores diferenciais mudam o esquema de\nsoluc?a?o de acordo com o especificado no caso. A combinac?a?o de esquemas\nnume?ricos a serem utilizados sera? escolhida no caso a ser estudado, sendo a\naplicac?a?o apenas uma matriz de alto n??vel, que forma o programa implemen-\ntado ao ser utilizada pelo caso. A aplicac?a?o gene?rica sendo chamada pelo\ncaso, segundo os me?todos escolhidos, ira? dar forma ao simulador desejado.\n\n\n\nCAPI?TULO 2. OPENFOAM 12\n\nPara o aprendizado do sistema, foram implementadas aplicac?o?es com o\nOpenFOAM para problemas envolvendo separadamente as tre?s equac?o?es di-\nferenciais parciais ba?sicas que esta?o presentes na maioria dos feno?menos es-\ntudados. A soluc?a?o dessas equac?o?es separadamente ajuda a resolver os pro-\nblemas de implementac?a?o do simulador a ser desenvolvido, que usa duas das\nequac?o?es presentes nesses modelos ba?sicos. Os problemas estudados foram os\nfeno?menos de difusa?o de calor em regime permanente, transiente e o problema\nde transporte advectivo. Como parte inicial do simulador foi desenvolvida\numa aplicac?a?o para a soluc?a?o do escoamento monofa?sico em meios porosos,\nque consiste na soluc?a?o de uma equac?a?o el??ptica, equac?a?o de pressa?o, mode-\nlando o feno?meno em regime permanente. Posteriormente foi implementado\no modelo bifa?sico, que usa a equac?a?o de advecc?a?o para a saturac?a?o e uma\nequac?a?o el??ptica para a soluc?a?o da equac?a?o de pressa?o.\n\n2.3.1 Difusa?o de calor\n\nPara a soluc?a?o da equac?a?o parabo?lica, que foi empregada na soluc?a?o da\nequac?a?o de pressa?o do simulador monofa?sico, foram feitas duas aplicac?o?es\nno OpenFOAM para a soluc?a?o do problema de difusa?o de calor em regime\npermanente e transiente. O feno?meno de difusa?o transiente e? descrito pela\nequac?a?o (2.2),\n\n?2T + q =\n1\n\n?\n\n?T\n\n?t\n, (2.2)\n\nonde T representa a temperatura, q representa um termo de gerac?a?o pontual\nde calor e ? a difusividade te?rmica do material. No OpenFoam o co?digo em\nC++ referente a discretizac?a?o e? escrito da seguinte forma:\n\n1 fvScalarMatrix Teqn\n2 (\n3 fvc:: laplacian(T)\n4 + q\n5 ==\n6 (1/ alpha )*fvm::ddt(T)\n7 )\n\nPara a soluc?a?o dos problemas em regime permanente e? usada a equac?a?o\n2.2 eliminando-se a derivada temporal. Pode-se facilmente mudar o me?todo\nde discretizac?a?o de uma formulac?a?o expl??cita para uma formulac?a?o impl??cita\napenas mudando o termo fvc::laplacian(T) para fvm::laplacian(T).\n\nDeve-se tomar cuidado ao implementar uma aplicac?a?o que utiliza equa-\nc?o?es adimensionalizadas nesse sistema, ja? que as varia?veis, quando criadas,\nrecebem uma unidade associada. A Tabela 2.1 mostra o padra?o para repre-\nsentar as unidades no sistema.\n\n\n\nCAPI?TULO 2. OPENFOAM 13\n\nTabela 2.1: Padra?o de unidades no OpenFOAM.\n\nPosic?a?o Propriedade Unidade\n1 Massa Kilograma (kg)\n2 Comprimento metro (m)\n3 Tempo segundo (s)\n4 Temperatura Kelvin (K)\n5 Quantidade kilograma-mol (kg-mol)\n6 Corrente Ampere (A)\n7 Intesidade luminosa candela (cd)\n\nA associac?a?o de cada campo a uma unidade no sistema e? feita para evitar\nque sejam feitas operac?o?es que na?o estejam dimensionalmente corretas. Cada\noperador diferencial carrega consigo uma operac?a?o dimensional, por exemplo\no resultado do operador fvc::div resulta em uma divisa?o pela unidade de\ncomprimento.\n\nPor convenie?ncia o sistema de unidades adotado na aplicac?a?o desenvolvida\ne? o sistema internacional de unidades, SI, e na mudanc?a de unidades e? feito\no uso de constantes em alguns termos das equac?o?es. Conforme mostrado\nna Tabela 2.1 ao criar-se um campo de presso?es em Pa = (kg m?1 s?2)\nas unidades da varia?vel devem ser informadas ao me?todo que cria o campo\natrave?s de um vetor contendo nu?meros que representam as pote?ncias as quais\nsera?o elevadas cada unidade. Seguindo a ordem apresentada anteriomente na\ntabela 2.1 o vetor [1 -1 -2 0 0 0 0] representara? a unidade da varia?vel de pressa?o\nno sistema.\n\n2.3.2 Advecc?a?o linear\n\nPara a soluc?a?o da equac?a?o hiperbo?lica, que sera? empregada na soluc?a?o da\nequac?a?o de saturac?a?o do simulador, foi feita uma aplicac?a?o no OpenFOAM\npara a soluc?a?o do problema de advecc?a?o. O feno?meno e? descrito pela equac?a?o\n(2.3).\n\n?f\n\n?t\n+ ?\u00b7 (~uf) = 0 (2.3)\n\nonde f representa a grandeza que se esta? sendo transportada e ~u o campo ve-\ntorial de velocidades responsa?vel pelo transporte advectivo de f. A aplicac?a?o\nusada para a soluc?a?o dessa equac?a?o faz parte das aplicac?o?es que vem com a\nbiblioteca, no entanto se optou por implementar uma aplicac?a?o similar para\nmelhor aprendizado do funcionamento do sistema. No OpenFOAM o co?digo\n\n\n\nCAPI?TULO 2. OPENFOAM 14\n\nem C++ referente a aplicac?a?o e? escrito da seguinte forma:\n\n1 #include \"fvCFD.H\"\n2\n3 int main(int argc , char *argv [])\n4 {\n5 # include \"setRootCase.H\"\n6 # include \"createTime.H\"\n7 # include \"createMesh.H\"\n8 # include \"createFields.H\"\n9\n\n10 surfaceScalarField phi=(fvc:: interpolate(U) &amp; mesh.Sf());\n11\n12 for (runTime ++; !runTime.end(); runTime ++)\n13 {\n14 f.storePrevIter ();\n15\n16 solve(fvm::ddt(f) == - fvm::div(phi , f));\n17 phi = (fvc:: interpolate(U) &amp; mesh.Sf());\n18\n19 runTime.write ();\n20 }\n21 return 0;\n22 }\n\nA primeira inclusa?o descrita no co?digo anterior torna acess??vel o names-\npace FOAM, que e? o escopo onde esta?o os namespaces como fvc e fvm que\npor sua vez abrigam os templates para as classes como div, grad e laplacian.\nA inclusa?o setRootCase.H ira? verificar uma lista de argumentos de entrada\nnecessa?rios a? execuc?a?o do programa. Em createTime.H sa?o criados os para?-\nmetros de controle da simulac?a?o, como instante inicial, final e incremento de\ntempo. A inclusa?o createMesh.H ira? gerar os dados de malha necessa?rios\nna discretizac?a?o. A u?ltima inclusa?o createFields.H tem conteu?do definido\npelo usua?rio que cria a aplicac?a?o. Neste arquivo sa?o criados os campos que\nsera?o usados na aplicac?a?o, seus valores e condic?o?es de contorno que sera?o\nlidos do direto?rio do caso. Na representac?a?o descrita no co?digo anterior o\ntermo de diverge?ncia usa o campo vetorial das velocidades interpolado dos\nve?rtices para as faces. Para realizar a interpolac?a?o usa-se a seguinte linha de\nco?digo em C++:\n\n1 u_f = fvc:: interpolate(u);\n\nCom os valores do campo de velocidades interpolado para as faces e? cal-\nculado o fluxo atrave?s de cada face, representado pelo campo escalar phi. A\nescolha do me?todo de interpolac?a?o a ser usado e? feita no direto?rio contendo\no caso, desta forma pode-se usar diferentes me?todos de interpolac?a?o sem fa-\nzer mudanc?as na implementac?a?o da aplicac?a?o desenvolvida. Assim como nos\n\n\n\nCAPI?TULO 2. OPENFOAM 15\n\nproblemas de calor descritos anteriormente pode-se mudar a formulac?a?o de\nexpl??cita para impl??cita, desta forma para se implementar a te?cnica upwind\nimpl??cita escolhemos o me?todo de interpolac?a?o linear no caso a ser simulado\ne usamos o seguinte co?digo na aplicac?a?o:\n\n1 fvScalarMatrix Feqn(\n2 fvm::div(phi ,f)\n3 + fvm::ddt(f)\n4 == 0\n5 )\n6 Feqn.solve ();\n\nPara usar uma formulac?a?o expl??cita basta apenas usar o template de dis-\ncretizac?a?o de divergentes do namespace fvc, fvc::div.\n\n2.4 Casos\n\nCaso, ou case, e? o nome dado ao direto?rio contendo os arquivos que ser-\nvira?o de entrada para a aplicac?a?o utilizada. Esses direto?rios sa?o organizados\nsegundo o padra?o do OpenFOAM. As aplicac?o?es desenvolvidas usando as\nclasses desse sistema modelam problemas tridimensionais podendo ser usa-\ndas para resolver problemas unidimensionais e bidimensionais.\n\nComo exemplo de um caso com geometria tridimensional, e? mostrada a\nFigura 2.2 com o modelo de uma barra com difusividade te?rmica constante\ne uniforme ao longo de toda geometria da barra, submetida a um gradiente\nde temperatura imposto, aplicado a?s duas extremidades da barra.\n\nFigura 2.2: Esquema do caso de difusa?o.\n\nE? imposto um fluxo de calor nulo nas faces que circundam a barra. Essas\ncondic?o?es de contorno com temperatura prescrita em duas extremidades e\nfluxo nulo em redor da barra fornecem uma soluc?a?o conhecida, que representa\numa distribuic?a?o linear de temperatura, possibilitando assim a verificac?a?o dos\nresultados. A Figura 2.3 mostra um exemplo da organizac?a?o padra?o de um\n\n\n\nCAPI?TULO 2. OPENFOAM 16\n\ndireto?rio com a estrutura de arquivos que forma um caso que usa a aplicac?a?o\ndesenvolvida para o problema de difusa?o descrito anteriormente.\n\nFigura 2.3: Estrutura do direto?rio de um caso.\n\nOlhando-se para os arquivos no direto?rio do caso temos um direto?rio cha-\nmado de 0, que conte?m os arquivos que definem as condic?o?es iniciais dos\ncampos e os valores das varia?veis que dependem do tempo. No OpenFOAM\nexistem campos escalares, vetoriais e tensoriais que, por definic?a?o, ja? sa?o em\ntre?s dimenso?es, para resolver um problema unidimensional deve-se criar uma\nfila de blocos e para um problema bidimensional um plano de blocos. No caso\ndo problema de difusa?o aqui descrito o campo sera? tridimensional, escalar e\nuniforme com os valores iniciais de temperatura contidos no arquivo nome-\nado como T. Nesse arquivo, tambe?m encontra-se a definic?a?o das condic?o?es\nde contorno que sa?o impostas segundo palavras chave e que sa?o associadas\na partes da geometria com nomes definidos no arquivo com a geometria do\nproblema. No OpenFOAM sa?o poss??veis diferentes tipos de condic?o?es de\ncontorno que podem ser impostas, como exemplo, pode-se citar as condic?o?es\nfixedV alue, cyclic, zeroGradient e symmetryPlane.\n\nO arquivo com a geometria do problema com o qual sera? gerada a malha\nencontra-se no direto?rio polyMesh, que neste caso esta? no direto?rio constant,\nse aqui estivesse sendo usada a ferramenta de gerac?a?o adaptativa de malhas\ncomo a malha mudaria com o tempo este direto?rio deveria estar dentro da\npasta 0 como o arquivo de temperatura. O trecho de co?digo a seguir mostra\na criac?a?o da geometria e a discretizac?a?o deste problema com o blockMesh.\n\n1 FoamFile\n2 {\n3 version 2.0;\n4 format ascii;\n5 class dictionary;\n\n\n\nCAPI?TULO 2. OPENFOAM 17\n\n6 object blockMeshDict;\n7 }\n8\n9 convertToMeters 1;\n\n10\n11 vertices\n12 (\n13 (0 0 0) (1 0 0)\n14 (1 5 0) (0 5 0)\n15 (0 0 1) (1 0 1)\n16 (1 5 1) (0 5 1)\n17 );\n18\n19 blocks\n20 (\n21 hex (0 1 2 3 4 5 6 7) (5 25 5) simpleGrading (1 1 1)\n22 );\n23\n24 edges ();\n25\n26 patches\n27 (\n28 patch down ( (1 5 4 0) )\n29 patch up ( (3 7 6 2) )\n30 patch left ( (0 4 7 3) )\n31 patch right( (2 6 5 1) )\n32 patch front( (4 5 6 7) )\n33 patch back ( (0 3 2 1) )\n34 );\n35\n36 mergePatchPairs ();\n\nNo arquivo com a geometria sa?o definidos os patches que, neste caso, sa?o\nos planos que formam o contorno da barra. Atrave?s do nome associado a\ncada patch sa?o definidas as condic?o?es de contorno de cada varia?vel criada no\nproblema. O trecho de co?digo a seguir mostra o arquivo nomeado como T\nque cria o campo de temperaturas do problema descrito.\n\n1 FoamFile\n2 {\n3 version 2.0;\n4 format ascii;\n5 class volScalarField;\n6 location \"constant\";\n7 object T;\n8 }\n9\n\n10 dimensions [1 -1 -2 0 0 0 0];\n11\n\n\n\nCAPI?TULO 2. OPENFOAM 18\n\n12 internalField uniform 0;\n13\n14 boundaryField\n15 {\n16 down { type fixedValue; value uniform 0; }\n17 up { type fixedValue; value uniform 10;}\n18 left { type zeroGradient; }\n19 right { type zeroGradient; }\n20 front { type zeroGradient; }\n21 back { type zeroGradient; }\n22 }\n\nAinda no direto?rio constant encontram-se os campos K, tensorial, e\nalpha, escalar. Outro arquivo pode ser adicionado a esse direto?rio a fim\nde definir varia?veis com valor constante no problema. No direto?rio system\nencontram-se os arquivos com os para?metros que ira?o controlar a aplica-\nc?a?o. No arquivo controlDict esta?o para?metros como tempo inicial e final\nde simulac?a?o, incremento de tempo e outras varia?veis de controle como o\nnu?mero de Courant para problemas com advecc?a?o, podendo ainda o usua?-\nrio utilizar como passo de tempo inicial o u?ltimo passo de tempo simulado.\nNo arquivo fvSchemes e? especificado o me?todo de discretizac?a?o aplicado a\ncada operador diferencial e os esquemas de interpolac?a?o utilizados para cada\nvaria?vel. No arquivo fvSolution sa?o definidos os solvers utilizados para a\nsoluc?a?o do sistema de equac?o?es resultante da discretizac?a?o de cada equac?a?o.\nOutros arquivos de controle da simulac?a?o podem ser adicionados como mos-\ntrado na Figura 2.3 no arquivo ?Dict como por exemplo quando resolvemos\no problema usando a aplicac?a?o em paralelo que e? necessa?rio criar o arquivo\ndecomposeParDict que especifica em quantos subdom??nios sera? dividido o\ndom??nio do problema, qual o me?todo de divisa?o utilizado e quantos subdo-\nm??nios ira?o ficar com cada processador.\n\nApo?s a implementac?a?o da aplicac?a?o, a mesma e? compilada usando pa-\nra?metros de compilac?a?o definidos no arquivo de configurac?a?o da biblioteca\nOpenFOAM. Para compilar a aplicac?a?o basta digitar o comando wmake no\ndireto?rio da aplicac?a?o. Apo?s a compilac?a?o da aplicac?a?o no direto?rio do caso,\nsa?o escolhidos os esquemas e as condic?o?es iniciais e de contorno do problema.\n\nPara gerar a malha e? executado o comando blockMesh no direto?rio do\ncaso. Caso seja usado um gerador de malhas externo basta converter a malha\npara o formato nativo e copiar o arquivo para o direto?rio polyMesh dentro do\ndireto?rio constant. A seguir e? apresentado o resultado da gerac?a?o da malha\npara o problema de difusa?o de calor mostrado anteriormente. A geometria do\nproblema e? uma barra com dimenso?es 1x5x1 discretizada atrave?s da malha\nmostrada na Figura 2.4, onde as dimenso?es em x, y e z foram discretizadas\ncom 5, 25 e 5 blocos em cada direc?a?o respectivamente exposta a um diferencial\n\n\n\nCAPI?TULO 2. OPENFOAM 19\n\nde temperatura de 10K para 0K.\n\nFigura 2.4: Malha da discretizac?a?o do problema de calor.\n\nApo?s a gerac?a?o da malha com o blockMesh e? executada a aplicac?a?o no\ndireto?rio do caso digitando-se o comando com o nome referente a aplicac?a?o.\nA Figura 2.5 mostra a soluc?a?o do problema descrito anteriormente no caso\nde difusa?o de calor.\n\nFigura 2.5: Soluc?a?o do caso com o problema de calor.\n\nA soluc?a?o apresentada mostra o resultado quando o fluxo de calor na\nbarra encontra-se em regime permanente.\n\n\n\nCap??tulo 3\n\nEquac?o?es Governantes\n\nA modelagem de reservato?rios de petro?leo consiste na simulac?a?o do esco-\namento dos fluidos tipicamente encontrados na rocha reservato?rio atrave?s de\numa matriz permoporosa. O comportamento dos hidrocarbonetos nas condi-\nc?o?es de reservato?rio pode ser retratado atrave?s de modelos como o black-oil,\nAPI-tracking, composicional [14] [13] e pseudo composicional [28]. As diferen-\nc?as ba?sicas entre cada um desses modelos sa?o o tratamento dado a? interac?a?o\nentre os fluidos, o nu?mero de componentes e seu comportamento devido a?s\nvariac?o?es de pressa?o, temperatura e composic?a?o. Cada modelo aplica-se me-\nlhor a um tipo de sistema petrol??fero, onde para cada condic?a?o de pressa?o\ne temperatura do reservato?rio estudado tem-se um comportamento diferente\ndos fluidos contidos na rocha reservato?rio. As propriedades reolo?gicas e ter-\nmodina?micas comportam-se de maneira diferente favorecendo, em cada caso,\num modelo de fluxo em particular.\n\nAtrave?s do diagrama de fases de uma determinada mistura de hidrocar-\nbonetos pode-se, dependendo das condic?o?es de pressa?o e temperatura do\nreservato?rio, determinar as caracter??sticas dos fluidos que sera?o encontrados\nem seu interior. A Figura 3.1 mostra a aplicac?a?o comumente utilizada dos\ntipos de modelos mais usados na indu?stria do pretro?leo. O modelo utilizado\nneste trabalho considera que os fluidos que deslocam-se no reservato?rio sa?o\nimisc??veis e incompress??veis, este modelo bifa?sico o?leo a?gua representa uma\nsimplificac?a?o do modelo black oil. O modelo aqui apresentado considera que\no escoamento desenvolve-se numa rocha com compressibilidade nula. A tem-\nperatura do escoamento e? assumida constante e as propriedades dos fluidos\nna?o variam com o tempo.\n\n20\n\n\n\nCAPI?TULO 3. EQUAC?O?ES GOVERNANTES 21\n\nFigura 3.1: Aplicac?a?o dos modelos de fluxo. Modificado de [20] apud [29].\n\n3.1 Propriedades da rocha e dos fluidos\n\nA definic?a?o das propriedades da rocha reservato?rio e dos fluidos que nela\nescoam sa?o o ponto de partida para a caracterizac?a?o do problema abordado\nneste tipo de simulador. O simulador monofa?sico desenvolvido como etapa\ninicial considera fluido e rocha compress??veis. Desta forma, para a formulac?a?o\ndo modelo monofa?sico, sera?o apresentadas as equac?o?es para as propriedades\nde fluido e rocha compress??veis. As equac?o?es do modelo bifa?sico sera?o apre-\nsentadas com os termos compress??veis e posteriormente sera?o simplificadas\npara o modelo bifa?sico incompress??vel. As propriedades da rocha usadas nos\nproblemas de fluxo em reservato?rios de petro?leo sa?o a porosidade, ? , e a\npermeabilidade absoluta, K, que, para o caso de um reservato?rio heteroge?-\nneo, possuem diferentes valores em cada ce?lula do dom??nio. A porosidade, ou\nporosidade efetiva, em uma determinada porc?a?o da rocha, e? definida como a\nraza?o entre o volume de vazios interconectados existentes e o volume total,\npodendo variar de acordo com a pressa?o do fluido confinado nos poros. A\nporosidade numa ce?lula informa o quanto da ce?lula esta? ocupada pelo fluido\ne sua variac?a?o com a pressa?o pode ser obtida pela seguinte expressa?o linea-\nrizada [20]:\n\n?(p) = ?ref [1 + cr(p?pref )] , (3.1)\n\n\n\nCAPI?TULO 3. EQUAC?O?ES GOVERNANTES 22\n\nonde ?ref e? a porosidade obtida em relac?a?o a uma pressa?o de refere?ncia pref\ne cr e? a compressibilidade da rocha.\n\nA permeabilidade absoluta e? uma medida que representa a facilidade que\no fluido tem de escoar pelos poros interconectados da rocha, essa varia?vel\naparece nos modelos matema?ticos representada pelo tensor de segunda ordem\nde permeabilidades absolutas segundo as direc?o?es x , y e z , como mostrado\nna Equac?a?o (3.2):\n\nK =\n\n?\n?? kxx kxy kxzkyx kyy kyz\nkzx kzy kzz\n\n?\n?? . (3.2)\n\nNo equacionamento usado na simulac?a?o de reservato?rios o tensor e? fre-\nquentemente representado na forma diagonal, obtido quando as direc?o?es pre-\nferenciais de fluxo coincidem com as direc?o?es principais do tensor de permea-\nbilidades absolutas. O tensor na forma diagonalizada e? mostrado na Equac?a?o\n(3.3):\n\nK =\n\n?\n?? kxx 0 00 kyy 0\n\n0 0 kzz\n\n?\n?? . (3.3)\n\nAlgumas propriedades dos fluidos sa?o importantes para a modelagem\ncomputacional do fluxo em meios porosos nas condic?o?es espec??ficas dos reser-\nvato?rios. Dentre elas temos: compressibilidade, fator volume de formac?a?o,\nmasssa espec??fica e viscosidade.\n\nA compressibilidade de um fluido, cl, pode ser entendida como uma me-\ndida da variac?a?o do volume do fluido quando o mesmo sofre uma variac?a?o\nde pressa?o. Admitindo-se que a temperatura ao longo de todo reservato?rio\npermanece constante podemos escrever as seguintes relac?o?es:\n\ncl = ?\n1\n\nV\n\n?V\n\n?p\n, (3.4)\n\nou ainda:\n\ncl =\n1\n\n?\n\n??\n\n?p\n. (3.5)\n\nonde V e ? sa?o o volume e a massa espec??fica do fluido respectivamente, e sa?o\nmedidos segundo as condic?o?es de reservato?rio. Uma outra propriedade bas-\ntante usada na simulac?a?o de reservato?rios e? o fator volume de formac?a?o, que\nrepresenta uma relac?a?o entre o volume do fluido nas condic?o?es de reservato?-\nrio, V , e em condic?o?es padra?o Vsc. As condic?o?es padra?o, standard conditions,\nadotadas sa?o referentes a uma temperatura de 60?F e a uma pressa?o de 14,7\npsi. A Equac?a?o (3.6) mostra a relac?a?o:\n\nB =\nV\n\nVsc\n, (3.6)\n\n\n\nCAPI?TULO 3. EQUAC?O?ES GOVERNANTES 23\n\nou:\nB =\n\n?sc\n?\n. (3.7)\n\nEm escoamentos com fluidos levemente compress??veis podemos escre-\nver uma relac?a?o entre a variac?a?o do fator volume de formac?a?o e a pres-\nsa?o. Integrando-se a Equac?a?o (3.4) admitindo-se temperaturas constantes ao\nlongo do reservato?rio pode-se escrever:\n\nB(p) =\nBref\n\n[1 + cl (p?pref )]\n, (3.8)\n\nonde Bref e? o fator volume de formac?a?o em relac?a?o a pressa?o de refere?ncia que\nnormalmente e? a pressa?o de bolha, Pb, mas como a relac?a?o e? linear pode-se\nutilizar qualquer valor maior que Pb. A Figura 3.2 mostra o comportamento\ndo fator volume de formac?a?o para o o?leo.\n\nFigura 3.2: Comportamento do fator volume de formac?a?o.\n\nSabe-se que um o?leo com uma maior quantidade de frac?o?es leves tem um\nBo maior que um o?leo pesado a uma dada pressa?o. Com a diminuic?a?o da\npressa?o o valor de Bo aumenta ate? chegar no valor de pressa?o em que a frac?a?o\nmais leve do o?leo sai de soluc?a?o, a partir deste ponto o valor de Bo comec?a\na cair novamente. A Equac?a?o (3.8) pode ser utilizada considerando-se que\no reservato?rio encontra-se a uma profudidade tal que a pressa?o esta?tica seja\nmaior que a pressa?o de bolha, valendo assim a linearizac?a?o feita segundo uma\npressa?o de refere?ncia de modo que tenha-se pref ? Pb.\n\nSob as condic?o?es de reservato?rio mencionadas, pode-se, a partir das Equa-\nc?o?es (3.7) e (3.8), escrever uma relac?a?o para a variac?a?o da massa espec??fica\nem func?a?o da pressa?o para valores de pressa?o acima da pressa?o de bolha:\n\n?(p) = ?ref [1 + cl (p?pref )] , (3.9)\n\n\n\nCAPI?TULO 3. EQUAC?O?ES GOVERNANTES 24\n\nA u?ltima propriedade a ser definida e? a viscosidade do fluido, que varia\nem func?a?o da pressa?o assim como a porosidade e o fator volume de formac?a?o.\nA relac?a?o pode ser escrita como:\n\n\u00b5(p) =\n\u00b5ref\n\n[1 ? c\u00b5 (p?pref )]\n, (3.10)\n\nonde \u00b5ref e? o valor da viscosidade em relac?a?o a? pressa?o de refere?ncia igual\na pref . A constante c\u00b5 e? a mudanc?a fracional da viscosidade por unidade\nde variac?a?o de pressa?o. Em sistemas trifa?sicos essa mudanc?a fracional e? em\ngrande parte uma func?a?o da frac?a?o de ga?s dissolvido no o?leo. A Figura 3.3\nmostra a variac?a?o da viscosidade em func?a?o da pressa?o que assim como o\nfator volume da formac?a?o tem um comportamento linear para valores de\npressa?o maiores que a presa?o de bolha.\n\nFigura 3.3: Comportamento da viscosidade.\n\nAbaixo da pressa?o de bolha a medida que as frac?o?es mais leves saem de\nsoluc?a?o do o?leo, com a queda de pressa?o, a viscosidade aumenta. Acima da\npressa?o de bolha um aumento na pressa?o resulta em um respectivo aumento\nda viscosidade. Sob as mesmas condic?o?es de reservato?rio com pressa?o esta?tica\nmaior que a pressa?o de bolha e? razoa?vel a linearizac?a?o.\n\n3.2 Lei de Darcy\n\nA lei de Darcy [20] e? uma lei emp??rica que relaciona a vaza?o de um fluido\nque escoa em um meio poroso com o gradiente potencial aplicado ao mesmo.\nO potencial e? definido pela Equac?a?o (3.11):\n\n? = p + ?Z, (3.11)\n\n\n\nCAPI?TULO 3. EQUAC?O?ES GOVERNANTES 25\n\nonde p e? a pressa?o do l??quido a uma profundidade Z, calculada em relac?a?o a\num referencial orientado para baixo, e ? e? o peso espec??fico do fluido definido\ncomo ? = ?c?g, onde ? e g sa?o a masssa espec??fica do fluido e a gravidade\nlocal respectivamente.\n\nOs termos ?c, ?c e ?c que aparecem ao longo do texto sa?o constantes\nusadas para compatibilizar as unidades usadas do sistema usual adotado\nna simulac?a?o de escoamento de petro?leo [20] e o sistema internacional de\nunidades. A tabela 3.2 mostra o valor dos fatores para o sistema internacional\nde unidades (SI) e para o sistema de unidades usual utilizado na indu?stria do\npetro?leo. Esses termos sa?o introduzidos para facilitar a mudanc?a de sistema\nde unidades, que no OpenFOAM e? feita durante a criac?a?o das varia?veis como\nfoi discutido no Cap??tulo 2.\n\nTabela 3.1: Fatores de conversa?o de unidades.\nFator SI Usual\n?c 1.0 5.614583\n?c 8.64 10\n\n?5 1.127\n?c 1.0 10\n\n?3 2.1584 10?4\n\nAssumindo-se um fluxo monofa?sico unidimensional, a velocidade superfi-\ncial, ou velocidade de Darcy pode ser escrita segundo a expressa?o:\n\nux = ??c\nkxx\n\u00b5\n\n??\n\n?x\n(3.12)\n\nNa Equac?a?o (3.12) o termo kxx representa a permeabilidade absoluta do\nmeio poroso na direc?a?o x e \u00b5 a viscosidade do fluido. Pode-se ainda escrever\na lei de Darcy para o caso multidimensional cuja equac?a?o de velocidades pode\nser escrita da seguinte forma:\n\n~u = ??c\nK\n\n\u00b5\n??, (3.13)\n\nonde ~u e? o vetor de velocidades de Darcy e K e? um tensor de permeabilidades\nabsolutas do meio poroso.\n\n3.3 Lei da conservac?a?o de massa\n\nA lei da conservac?a?o de massa, tambe?m chamada de equac?a?o da continui-\ndade, e? uma expressa?o matema?tica que representa um balanc?o entre fluxos\nde massa. Pode-se obter a lei de conservac?a?o de massa considerando-se o\n\n\n\nCAPI?TULO 3. EQUAC?O?ES GOVERNANTES 26\n\nfluxo atrave?s de um volume de controle como mostrado na FIgura 3.4. A\nvariac?a?o temporal da massa que passa atrave?s de um volume de controle V\npode ser expressa pela relac?a?o [20]:\n\n(me ?ms) + mg = mac, (3.14)\n\nonde me e? a massa que entra no volume de controle, ms a massa que sai do\nvolume de controle, mg a massa gerada no volume de controle durante um\nintervalo de tempo ?t, devido a termos de fonte, e mac e? a massa acumulada\nno volume de controle durante o mesmo intervalo de tempo.\n\nFigura 3.4: Esquema de fluxo.\n\nSe considerarmos um volume de controle hexae?drico como o mostrado na\nFigura 3.1, podemos escrever:\n\nme =\n[\n(m?xAx)x?4x/2 + (m?yAy)y?4y/2 + (m?zAz)z?4z/2\n\n]\n4t (3.15)\n\ne\nms =\n\n[\n(m?xAx)x+4x/2 + (m?yAy)y+4y/2 + (m?zAz)z+4z/2\n\n]\n4t, (3.16)\n\nonde x, y e z sa?o as coordenadas do centro do volume de controle, Ax, Ay e\nAz sa?o as a?reas das faces segundo as direc?o?es x, y e z respectivamente e m?\ne? o fluxo de massa por unidade de a?rea que passa pelas faces do volume de\ncontrole, que, para a direc?a?o x, pode ser definido como:\n\nm?x = ?c?ux. (3.17)\n\nDefinindo mg como a massa gerada no interior do volume de controle\ndurante um intervalo de tempo 4t devido a uma vaza?o q podemos escrever:\n\nmg = qm4t = ?q4t. (3.18)\n\n\n\nCAPI?TULO 3. EQUAC?O?ES GOVERNANTES 27\n\nO termo de acumulac?a?o representa a quantidade de massa acumulada\ndurante um intervalo de tempo e pode ser escrito como:\n\nmac = m\nt+4t\nV ?m\n\nt\nV , (3.19)\n\nonde mtV e? quantidade total de massa contida no volume de controle no ins-\ntante de tempo t. Como trabalharemos com malhas estruturadas hexae?dricas\nessa quantidade pode ser escrita em func?a?o do volume do bloco, Vb, e da po-\nrosidade do me?dia no bloco, ?. Dessa forma podemos reescrever a Equac?a?o\n(3.19) como:\n\nmac = (??4x4y4z)\nt+4t ? (??4x4y4z)t , (3.20)\n\nsubstituindo as equac?o?es (3.15), (3.16), (3.18) e (3.20) na Equac?a?o (3.14) e\ndividindo-se a equac?a?o resultante pelo volume do bloco hexae?drico e por ?t\ntemos: [\n\nm?x+?x/2 ? m?x??x/2\n?x\n\n]\n?\n[\nm?y+?y/2 ? m?y??y/2\n\n?y\n\n]\n\n?\n[\nm?z+?z/2 ? m?z??z/2\n\n?z\n\n]\n+\n\nqm\n?cVb\n\n=\n??t+?t ???t\n\n?t\n. (3.21)\n\nEscrevendo-se a Equac?a?o (3.17) para demais direc?o?es cartesianas, pode-se\navaliar a mesma no limite em que os valores de ?x, ?y, ?z e ?t tendem a\nzero, encontrando:\n\n?\n?\n\n?x\n(?ux) ?\n\n?\n\n?y\n(?uy) ?\n\n?\n\n?z\n(?uz) +\n\nqm\n?cVb\n\n=\n1\n\n?c\n\n?\n\n?t\n(??) , (3.22)\n\nou ainda:\n?\n\n?t\n(??) + ?c?\u00b7 (?~u) =\n\nqm\nVb\n. (3.23)\n\nA Equac?a?o (3.23) representa a forma final da equac?a?o da lei de conserva-\nc?a?o de massa, ou equac?a?o da continuidade.\n\n3.4 Escoamento monofa?sico\n\nNo modelo monofa?sico em que admite-se que a temperatura e? constante\nresta apenas a equac?a?o de pressa?o a ser resolvida e com os valores de pres-\nsa?o todas as outras propriedades do fluido sa?o determinadas. A equac?a?o de\npressa?o e? obtida atrave?s das duas leis expostas anteriormente, da equac?a?o de\n\n\n\nCAPI?TULO 3. EQUAC?O?ES GOVERNANTES 28\n\nconservac?a?o de massa e da lei de Darcy. Substituindo a equac?a?o (3.12) na\nequac?a?o (3.23) encontramos:\n\n?\n\n?t\n(??) ??c?c?\u00b7\n\n(\n?\nK\n\n\u00b5\n??\n\n)\n=\nqm\nVb\n. (3.24)\n\nintroduzindo-se (3.11):\n\n?\u00b7\n[\n?c?\n\nK\n\n\u00b5\n(?p + ??Z)\n\n]\n+\n\nqm\n?cVb\n\n=\n1\n\n?c\n\n? (??)\n\n?t\n(3.25)\n\ndividindo por ?sc, usando-se (3.7) e sabendo que qm = ?cqsc?sc obte?m-se:\n\n?\u00b7\n[\n?c\nK\n\nB\u00b5\n(?p + ??Z)\n\n]\n+\nqsc\nVb\n\n=\n1\n\n?c\n\n?\n\n?t\n\n(\n?\n\nB\n\n)\n(3.26)\n\nO modelo implementado na aplicac?a?o para o escoamento monofa?sico as-\nsume que o fluido e? levemente compress??vel, como a?gua e o?leo pesado, e que\na porosidade da rocha varia segundo a Equac?a?o (3.1). As equac?o?es para\na modelagem de um fluido levemente compress??vel sa?o as Equac?o?es (3.8)\ne (3.10), substituindo essas equac?o?es na Equac?a?o (3.26) atrave?s de alguma\nmanipulac?a?o pode-se obter:\n\n?\u00b7\n[\n?c\nK\n\nB\u00b5\n(?p + ??Z)\n\n]\n+\nqsc\n\nVb\n=\n\n1\n\n?c\n\n(\n?\ncl\nBref\n\n+ ?ref\ncr\nB\n\n)\n?p\n\n?t\n(3.27)\n\nA Equac?a?o (3.27), que descreve o escoamento monofa?sico em meios poro-\nsos para fluidos levemente compress??veis. Como os valores das propriedades\ndos fluidos e da rocha dependem da pressa?o, a Equac?a?o (3.27) e? na?o linear.\nPara lineariza?-la e? usada uma formulac?a?o iterativa direta na qual os valores\ndas propriedades do fluido e da rocha sa?o calculados e a equac?a?o e? resolvida\nimplicitamente para a pressa?o, os valores das propriedades sa?o recalculados\ne a equac?a?o e? resolvida novamente, o processo continua ate? que os valores da\npressa?o convirjam para a soluc?a?o a cada passo de tempo.\n\n3.5 Escoamento bifa?sico\n\nO modelo aplicado para a modelagem do escoamento em reservato?rios no\nsimulador desenvolvido foi o de escoamento bifa?sico imisc??vel e incompress??-\nvel em meios porosos. O modelo e? baseado nos mesmos conceitos aplicados a?\nobtenc?a?o das equac?o?es do escoamento monofa?sico. A partir da lei de conser-\nvac?a?o de massa para cada componente do escoamento e? encontrada a equac?a?o\n\n\n\nCAPI?TULO 3. EQUAC?O?ES GOVERNANTES 29\n\nde saturac?a?o. Uma combinac?a?o das equac?o?es de saturac?a?o e? feita para a ob-\ntenc?a?o da equac?a?o que calculara? a distribuic?a?o de presso?es no reservato?rio.\nA deduc?a?o das equac?o?es de pressa?o e saturac?a?o separadamente e? necessa?ria\ndevido ao me?todo empregado para a soluc?a?o do problema. O me?todo IMPES\nque sera? descrito no pro?ximo cap??tulo calcula primeiro o campo de presso?es\ne posteriormente e? encontrada a distribuic?a?o de saturac?o?es no reservato?rio.\n\nEquac?a?o de Saturac?a?o\n\nA saturac?a?o de uma fase, em uma determinada porc?a?o de rocha, repre-\nsenta o quociente entre o volume da fase presente nos poros e o volume poroso,\nexpressando uma medida percentual de cada fase presente. Para o modelo\nde escoamento bifa?sico totalmente saturado aqui estudado pode-se escrever:\n\nsw + so = 1 (3.28)\n\nonde so e sw sa?o as medidas em valores que variam entre 0 e 1 das saturac?o?es\nde o?leo e a?gua, respectivamente. No modelo de reservato?rios de petro?leo exis-\ntem ainda duas varia?veis, sro e srw , que representam as saturac?o?es residuais\nde o?leo e a?gua. As saturac?o?es residuais esta?o presentes no meio poroso e re-\npresentam quantidades de fluido que na?o podem ser retiradas, permanecendo\nna matriz porosa durante o escoamento. A equac?a?o de saturac?a?o para cada\nfase e? obtida atrave?s da Equac?a?o (3.23), escrita para cada uma das fases,\ndonde encontramos:\n\n1\n\n?c\n\n? (?so?o)\n\n?t\n+ ?\u00b7 (?o ~uo) =\n\n?oscqosc\nVb\n\n(3.29)\n\npara a fase o?leo e:\n\n1\n\n?c\n\n? (?sw?w)\n\n?t\n+ ?\u00b7 (?w ~uw) =\n\n?wscqwsc\nVb\n\n(3.30)\n\npara a fase a?gua. Os termos qo e qw correspondem a?s vazo?es de o?leo e a?gua\nrespectivamente, os vetores ~uo e ~uw representam as velocidades das fases e\nsa?o calculados de acordo com a lei de Darcy e ponderada entre as fases de\nacordo com a permeabilidade relativa da mesma. A permeabilidade repre-\nsenta a medida da facilidade que o fluido tem de escoar no meio poroso. Um\nfluido confinado em um meio poroso possui como valor ma?ximo de permeabi-\nlidade a permeabilidade absoluta. Em presenc?a de outros fluidos a facilidade\nde escoamento no meio e? reduzida a um valor menor que a permeabilidade\nabsoluta. A permeabilidade de uma fase em um meio poroso na direc?a?o x\npode ser descrita como:\n\nkl = kx\n\n(\nkl\nkx\n\n)\n= kxkrl (3.31)\n\n\n\nCAPI?TULO 3. EQUAC?O?ES GOVERNANTES 30\n\nA permeabilidade da fase l, com l = o ou l = w, e? dada pelo produto\nentre a permeabilidade absoluta na direc?a?o x e a permeabilidade relativa. A\npermeabilidade relativa e? uma grandeza que varia de acordo com a quanti-\ndade de fluido no poro, ou seja, em func?a?o da saturac?a?o do fluido. Existem\nmodelos, obtidos atrave?s de experimentos, que relacionam os valores das per-\nmeabilidades relativas com as saturac?o?es [36]. Dependendo do meio poroso\nestudado, esses modelos podem mudar. Experimentalmente pode ser ob-\ntidas duas curvas de permeabilidade relativa, uma relativa ao processo de\ndrenagem e outra ao processo de embebic?a?o. Nos simuladores de escoamento\nem meios porosos e? comumente utilizada a curva de permeabilidade relativa\nreferente ao processo que esta? ocorrendo. Em simulac?a?o de reservato?rios o\nperfil das curvas de permeabilidade relativa e? um dos para?metros que sa?o\ncontrolados para melhor representar o histo?rico de produc?a?o do reservato?rio\nvariando-se o perfil das curvas de permeabilidade relativa e? poss??vel ajustar a\nresposta fornecida pelo simulador ao histo?rico de presso?es do reservato?rio. A\nFigura 3.5 mostra um exemplo com curvas de permeabilidade relativa para\num sistema bifa?sico. onde swi representa a saturac?a?o de a?gua irredut??vel e\n\nFigura 3.5: Curvas de permeabilidade relativa.\n\nsor a saturac?a?o de o?leo residual. A saturac?a?o de a?gua irredut??vel representa\na frac?a?o de a?gua que fica aprisionada nos poros devido ao efeito Jamim [36]\nenquanto a saturac?a?o de o?leo residual representa a frac?a?o de o?leo que na?o\npode ser extra??da do reservato?rio.\n\nA lei de Darcy descrita pela Equac?a?o (3.13) foi originalmente obtida para\num escoamento monofa?sico, podendo ser modificada introduzindo-se o con-\nceito de permeabilidade relativa. Desta forma podemos reescrever a equac?a?o\n\n\n\nCAPI?TULO 3. EQUAC?O?ES GOVERNANTES 31\n\npara a fase l como:\n\n~ul = ??c\nKkrl\n\u00b5l\n\n(?pl + ?l?Z) , (3.32)\n\nsubstituindo as velocidades na equac?a?o de conservac?a?o de massa para cada\nfase obtemos:\n\n1\n\n?c\n\n? (?sl?l)\n\n?t\n+ ?\u00b7\n\n{\n?l\n\n[\n??c\n\nKkrl\n\u00b5l\n\n(?pl + ?l?Z)\n]}\n\n=\n?lscqlsc\nVb\n\n. (3.33)\n\nDividindo-se as equac?o?es resultantes pelas masssas espec??ficas de cada\nfase nas condic?o?es padra?o obtemos:\n\n1\n\n?c\n\n?\n\n?t\n\n(\n?sl\nBl\n\n)\n??\u00b7\n\n{[\n?c\nKkrl\nBl\u00b5l\n\n(?pl + ?l?Z)\n]}\n\n=\nqlsc\nVb\n\n(3.34)\n\nO modelo de escoamento aqui estudado supo?e que os fluidos sa?o incom-\npress??veis e que o meio poroso e? r??gido. Essas duas condic?o?es implicam em um\ncampo escalar de porosidades que na?o varia em func?a?o do tempo, um fator\nvolume de formac?a?o igual a? unidade para cada fase e valores de viscosidades\nconstantes para cada fase.\n\nEm cada poro, devido a diferenc?a de molhabilidade preferencial da rocha,\na um dos fluidos, tem-se um encurvamento da superf??cie de contato entre o\no?leo e a a?gua, a esse feno?meno da?-se o nome de capilaridade. A Figura 3.6\nmostra um exemplo dos diferentes tipos de curvas de pressa?o capilar.\n\nFigura 3.6: Curvas de pressa?o capilar [29].\n\nA obtenc?a?o em laborato?rio das curvas de capilaridade e? feita segundo\nos processos de drenagem e embebic?a?o [33], assim como na permeabilidade\n\n\n\nCAPI?TULO 3. EQUAC?O?ES GOVERNANTES 32\n\nrelativa. Dependendo da molhabilidade da rocha tem-se diferentes tipos de\ncurvas de pressa?o capilar para o processo de embebic?a?o.\n\nPara a soluc?a?o das equac?o?es a curva que deve ser usada e? a curva referente\nao processo de embebic?a?o enquanto que para se calcular as condic?o?es iniciais\nde saturac?a?o de a?gua utiliza-se a curva de drenagem. A capilaridade afeta\ndiretamente os valores das presso?es de cada fase no contato e pode ser escrita\ncomo uma relac?a?o entre as presso?es de cada fase como mostra a Equac?a?o\n(3.35):\n\npc(sw) = po ?pw (3.35)\n\nCom os campos de pressa?o dos componentes o?leo e a?gua sa?o obtidos os\nvalores de pressa?o capilar de cada ponto, e com a curva de pressa?o capilar\nreferente ao processo de embebic?a?o sa?o calculados os valores de saturac?a?o\natrave?s da func?a?o inversa da curva de pressa?o capilar. Esses valores de sa-\nturac?a?o calculados sa?o importantes para definir os valores de saturac?a?o na\nregia?o de transic?a?o do componente o?leo para o componente a?gua como mos-\ntrado na Figura 3.7.\n\nFigura 3.7: Saturac?a?o na zona de transic?a?o [29].\n\nUma aproximac?a?o va?lida que e? comumente empregada e? a de assumir que\na formac?a?o rochosa possui poros largos e distribuic?a?o de porosidade uniforme,\nneste caso a regia?o de transic?a?o seria muito pequena e pode ser desprezada\ndevido a?s dimenso?es do problema.\n\nUsando a Equac?a?o (3.35) pode-se reescrever as equac?o?es de saturac?a?o de\ncada fase em func?a?o apenas da pressa?o da fase o?leo. Essa operac?a?o faz-se\nnecessa?ria para a obtenc?a?o posterior da equac?a?o de pressa?o que, de acordo\ncom o me?todo IMPES, deve ficar em func?a?o da pressa?o de apenas uma das\n\n\n\nCAPI?TULO 3. EQUAC?O?ES GOVERNANTES 33\n\nfases como mostrado nas Equac?o?es 3.36 e 3.37:\n\n?\n\n?c\n\n?so\n?t\n\n= ?\u00b7\n{[\n?c\nKkro\n\u00b5o\n\n(?po + ?o?Z)\n]}\n\n+\nqosc\nVb\n\n(3.36)\n\npara a fase o?leo e:\n\n?\n\n?c\n\n?sw\n?t\n\n= ?\u00b7\n{[\n?c\nKkrw(sw)\n\n\u00b5w\n(?po ??pc(sw) + ?w?Z)\n\n]}\n+\nqwsc\nVb\n\n(3.37)\n\npara a fase a?gua.\n\nEquac?a?o de Pressa?o\n\nA equac?a?o de pressa?o pode ser obtida somando-se as Equac?o?es 3.36 e\n3.37. De acordo com a Equac?a?o (3.28) o termo da derivada temporal anula-\nse, dessa forma obte?m-se:\n\n?\u00b7\n{\n?cK\n\n[(\nkro\n\u00b5o\n\n+\nkrw\n\u00b5w\n\n)\n?po ?\n\nkrw\n\u00b5w\n?pc +\n\n(\nkro\n\u00b5o\n?o +\n\nkrw\n\u00b5w\n\n?w\n\n)\n?Z\n\n]}\n= ?Q\n\n(3.38)\nou:\n\n?\u00b7 (Tpo?po) = ?\u00b7 (Tpc?pc) ??\u00b7 (Tz?Z) ?Q (3.39)\nonde:\n\nQ =\nqwsc\nVb\n\n+\nqosc\nVb\n\n(3.40)\n\nTpo = ?cK\n\n(\nkro\n\u00b5o\n\n+\nkrw\n\u00b5w\n\n)\n(3.41)\n\nTpc = ?cK\n\n(\nkrw\n\u00b5w\n\n)\n(3.42)\n\nTz = ?cK\n\n(\nkro\n\u00b5o\n?o +\n\nkrw\n\u00b5w\n\n?w\n\n)\n(3.43)\n\nessa representac?a?o atrave?s da separac?a?o de cada operador diferencial aplicado\naos campos e? feita para ilustrar a forma como sa?o escritas as equac?o?es no\nOpenFOAM que sera?o mostradas no cap??tulo 5.\n\nAs equac?o?es do modelo de escoamento multifa?sico em meios porosos po-\ndem ser expressas atrave?s da formulac?a?o parabo?lica ou hiperbo?ica [9] [12].\nAs equac?o?es apresentadas neste cap??tulo sa?o referentes a? formulac?a?o para-\nbo?lica. Nesta formulac?a?o o termo de difusa?o da saturac?a?o e? representado\npela derivada segunda da pressa?o capilar que e? func?a?o da saturac?a?o. A for-\nmulac?a?o dita parabo?lica apresenta cara?ter parabo?lico e hiperbo?lico quando\n\n\n\nCAPI?TULO 3. EQUAC?O?ES GOVERNANTES 34\n\nconsideram-se os efeitos da pressa?o capilar e hiperbo?lico quando e? desprezado\no termo de pressa?o capilar. Na formulac?a?o hiperbo?lica o equacionamento e?\nfeito atrave?s da velocidade das fases e de uma varia?vel de velocidade total,\ntornando a equac?a?o de saturac?a?o uma equac?a?o hiperbo?lica.\n\nTermos de fonte\n\nPara o ca?lculo dos termos de fonte do problema faz-se necessa?rio o uso\nde uma relac?a?o para o acoplamento das presso?es no fundo do poc?o com as\npresso?es do reservato?rio, o modelo adotado foi o modelo de Peaceman mos-\ntrado em [34] e [35]. Para poc?os produtores e injetores o tratamento faz-se\nde maneira distinta. Em poc?os injetores os valores de vaza?o ou pressa?o de\nfundo sa?o espec??ficados, em poc?os produtores, devido ao modelo incompres-\ns??vel aqui adotado, a vaza?o volume?trica total dos fluidos deve ser a mesma\nvaza?o volume?trica injetada sendo a pressa?o de fundo calculada a partir dos\noutros para?metros. Para o acoplamento e? utilizada a relac?a?o descrita pela\nEquac?a?o (3.44).\n\nql = IPl (pe ?pwf ) (3.44)\n\nonde IP representa o ??ndice de produtividade, pwf a pressa?o no fundo do poc?o\nna profundidade em que o poc?o encontra-se aberto para fluxo e pe representa\na pressa?o esta?tica do reservato?rio na mesma profundidade. Para o caso aqui\nestudado sera? desprezada a capilaridade, sendo neste caso, a pressa?o esta?tica\nigual a? pressa?o das fases. No caso de um poc?o injetor a varia?vel IP e? chamada\nde II (?Indice de Injetividade). Para o caso de um poc?o vertical o IP para a\nfase l e? calculado segundo a Equac?a?o (3.45):\n\nIPl =\n?2??ckr lkhh\n\n\u00b5lBl[ln(re/rw) + s]\n(3.45)\n\nonde h e? a espessura do intervalo aberto para fluxo no poc?o de raio rw e\nkh representa a permeabilidade areal calculada como uma me?dia geome?trica\ndas permeabilidades nas direc?o?es x e y. O escalar s representa um valor\nque e? ajustado para representar um dano causado a parte porosa aberta do\nintervalo em produc?a?o. O valor de re, raio de drenagem, e? calculado em\nfunc?a?o da discretizac?a?o atrave?s da seguinte expressa?o:\n\nre = 0.28\n\n{[\n(ky/kx)\n\n1/2?x2\n]\n\n+\n[\n(kx/ky)\n\n1/2?y2\n]}1/2\n\n((ky/kx)1/4 + (kx/ky)1/4\n(3.46)\n\nA vaza?o de cada fase no poc?o produtor e? calculada a partir da func?a?o\nde fluxo fracional fl [9], calculada em func?a?o da velocidade das fases [36],\n\n\n\nCAPI?TULO 3. EQUAC?O?ES GOVERNANTES 35\n\nque desprezando-se a capilaridade e os efeitos gravitacionais pode ser escrito\nsegundo a Equac?a?o (3.47):\n\nfl =\n?l\n\n?o + ?w\n(3.47)\n\nou\n\nfl =\nIPl\n\nIPw + IPo\n=\nIPl\nIP\n\n(3.48)\n\nonde ?l representa a mobilidade da fase l e e? calculado segundo a Equac?a?o\n(3.49) e IP representa o ??ndice de produtividade total do poc?o.\n\n?l =\nkkrl\n\u00b5lBl\n\n(3.49)\n\nPara mostrar como e? feito o acoplamento pode-se, como exemplo, con-\nsiderar a situac?a?o com apenas um poc?o produtor e um injetor, escrevendo\npara o poc?o injetor a seguinte relac?a?o:\n\nqinj = II (pe ?pwf ) (3.50)\n\nessa relac?a?o considera que toda a mobilidade da fase a?gua e? igual a mobilidade\ntotal dos fluidos na a?rea injetada. Assumindo que a permeabilidade areal do\npoc?o injetor e? igual a do poc?o produtor, ambos com fator de skin nulo. Pode-\nse reescrever a Equac?a?o 3.50 como:\n\nqinj = IP (pe ?pwf ) (3.51)\n\nPara um poc?o produtor pode-se escrever a vaza?o volume?trica da seguinte\nforma:\n\nqp = qw + qo = IPw (pe ?pwf ) + IPo (pe ?pwf ) (3.52)\n\nmultiplicando e dividindo a Equac?a?o (3.52) pelo IP total do poc?o e substi-\ntuindo 3.51 na expressa?o resultante temos:\n\nqp = IPw\nIP\n\nIP\n(pe ?pwf ) + IPo\n\nIP\n\nIP\n(pe ?pwf ) = fwqinj + foqinj (3.53)\n\nAssim pode-se calcular a vaza?o de cada fase no poc?o produtor como uma\nfrac?a?o da vaza?o de injec?a?o. Dado o valor da pressa?o de fundo do poc?o pro-\ndutor, com o valor da vaza?o da fase o?leo pode-se, atrave?s da Equac?a?o 3.44,\nencontrar a pressa?o esta?tica pe. Esta pressa?o sera? usada como pressa?o de\nrefere?ncia para a soluc?a?o da equac?a?o de pressa?o 3.39. A restric?a?o no valor da\npressa?o de fundo do poc?o produtor deve-se a condic?a?o pressa?o de separac?a?o\nideal dos fluidos nas instalac?o?es de superf??cie.\n\n\n\nCap??tulo 4\n\nModelagem Computacional\n\nO OpenFOAM usa o me?todo dos volumes finitos para discretizar os o-\nperadores diferenciais. O me?todo dos volumes finitos e? um me?todo para\nrepresentar e avaliar equac?o?es diferenciais parcias na forma de equac?o?es al-\nge?bricas [27] [38]. Sa?o feitas integrais de volume nos termos de diverge?ncia\ne, atrave?s do teorema da diverge?ncia, esses termos sa?o convertidos para in-\ntegrais de superf??cie. Neste me?todo o valor da diferenc?a entre vaza?o ma?ssica\nque entra em um volume de controle e a vaza?o ma?ssica que deixa o mesmo e?\nide?ntico ao valor acumulado no volume, garantindo assim a conservac?a?o nu-\nme?rica do me?todo. Esta propriedade e? importante em um me?todo nume?rico\npois garante que nenhuma quantidade de fluxo integral surja ou desparec?a\ndo dom??nio devido ao me?todo. Para a soluc?a?o das equac?o?es estudadas foi\nempregado o me?todo dos volumes finitos usando malhas estruturadas, que e?\nequivalente ao me?todo das diferenc?as finitas baseadas em volumes de controle\nque foi o me?todo proposto para este trabalho. Para uma melhor compreensa?o\ndos me?todos utilizados neste ambiente sa?o abordadas resumidamente a seguir\na forma como sa?o discretizados o dom??nio e as equac?o?es resolvidas usando o\nOpenFOAM. Para uma descric?a?o mais detalhada e? recomendado a leitura do\ntrabalho feito por Hrvoje Jasak [25] que foi o criador do sistema.\n\n4.1 Discretizac?a?o do dom??nio\n\nNo OpenFOAM os volumes de controle podem assumir diferentes geome-\ntrias, de modo que ao escrever uma aplicac?a?o no OpenFOAM pode-se usar\ndiferentes geometrias para a discretizac?a?o do dom??nio sem que seja neces-\nsa?rio mudar a aplicac?a?o. Uma mesma aplicac?a?o pode simular um caso que\nusa uma malha estruturada ou uma malha na?o estruturada. O processo de\ndiscretizac?a?o pode ser dividido em dois passos: a discretizac?a?o do dom??nio\n\n36\n\n\n\nCAPI?TULO 4. MODELAGEM COMPUTACIONAL 37\n\nda soluc?a?o e a discretizac?a?o da equac?a?o. A discretizac?a?o do dom??nio produz\numa relac?a?o entre a geometria do cont??nuo que se quer estudar e os pontos\nonde a equac?a?o discretizada sera? resolvida. No OpenFOAM para cada face\nsa?o armazenadas as coordenadas dos ve?rtices e do centroide, o volume e os\nvetores que orientam a direc?a?o normal de cada face. A Figura 4.1 mostra um\nexemplo de volume de controle.\n\nFigura 4.1: Volume de controle.\n\nO ponto P encontra-se no centroide do volume de controle de modo que:?\nV\n\n(x?xp) dV = 0 (4.1)\n\nO vetor ~S, normal a face destacada, encontra-se no centroide da mesma\ne e? constru??do em cada face do volume de controle de modo que sua norma\neuclidiana equivale a a?rea da face que o conte?m. O ponto N representa o\ncentroide de um volume de controle de uma ce?lula vizinha. A discretizac?a?o\ndo dom??nio no OpenFOAM pode ser feita usando-se diferentes tipos de ce?-\nlulas, sem que precise tratar explicitamente os tipos ce?lulas nas aplicac?o?es\ndesenvolvidas. Ha? ainda a possibilidade da definic?a?o de um novo tipo de\nce?lula que pode ser especificada pelo usua?rio, fornecendo-se a sua geometria.\nA Figura 4.2 mostra a geometria dos diferentes tipos de ce?lulas que podem\nser usados para discretizar o dom??nio no OpenFOAM. Ale?m dos tipos de\nelementos mostrados e? poss??vel ainda que o usua?rio crie um elemento dife-\nrente e informe as coordenadas dos ve?rtices em um arquivo de configurac?a?o\ndo sistema.\n\n4.2 Discretizac?a?o das equac?o?es\n\nNo OpenFOAM a discretizac?a?o dos termos de uma dada equac?a?o e? feita\nseparadamente, podendo-se escolher que tipo de esquema sera? aplicado a cada\n\n\n\nCAPI?TULO 4. MODELAGEM COMPUTACIONAL 38\n\nFigura 4.2: Tipos de volume de controle do OpenFOAM.\n\noperador [2]. Uma das vantagens de utilizar este ambiente e? a praticidade\nobtida ao tratar isoladamente a discretizac?a?o de cada termo de uma dada\nequac?a?o. Por exemplo, para a discretizac?a?o da Equac?a?o (4.2):\n\n??\n\n?t\n+ ?\u00b7 (U?) ??\u00b7 (????) = S?(?) (4.2)\n\npodemos usar a seguinte representac?a?o escrita em C++ usando o Open-\nFOAM:\n\n1 fvScalarMatrix PhiEqn\n2 (\n3 fvm::ddt(phi)\n4 + fvc::div(U,phi)\n5 - fvc:: laplacian(Gamma ,phi)\n6 ==\n7 S\n8 )\n\nNo trecho de co?digo acima cada operador diferencial e? discretizado sepa-\nradamente e a ac?a?o conjunta destes operadores discretos, compo?em a matriz\nde discretizac?a?o da equac?a?o a ser solucionada. Em cada um dos operadores\npode-se usar uma formulac?a?o expl??cita ou impl??cita, usando-se os me?todos\ndas classes fvc (finite volume calculus) e fvm (finite volume method) res-\npectivamente.\n\n4.2.1 Discretizac?a?o dos operadores de difusa?o\n\nOs operadores de difusa?o sa?o relacionados aos termos de derivada segunda\nno espac?o, como o operador mostrado na Equac?a?o (4.3) que atua sobre a\n\n\n\nCAPI?TULO 4. MODELAGEM COMPUTACIONAL 39\n\ngrandeza primitiva ? ,\n?\u00b7 (????) (4.3)\n\nonde ?? e? um campo tensorial com tensores de segunda ordem, associados\naos centros dos volumes de controle cujo efeito de sua interpolac?a?o para as\nfaces sera? discutida adiante. A discretizac?a?o usando o me?todo dos volumes\nfinitos e? feita integrando-se a Equac?a?o (4.3) e assumindo-se um volume de\ncontrole com geometria polie?drica, desta forma temos que a integral sobre o\nvolume de controle pode ser escrita, fazendo uso do teorema da diverge?ncia,\ncomo: ?\n\nV\n?\u00b7 (????) dV =\n\n?\nf\n\n~S \u00b7 (????)f =\n?\nf\n\n(??)f\n~S \u00b7 (??)f (4.4)\n\nA malha utilizada no simulador desenvolvido e? estruturada composta de\nvolumes de controle com geometria hexae?drica, neste caso, se a malha for\nortogonal, os vetores ~S e ~d mostrados na Figura 4.3 sa?o paralelos, enta?o\npodemos escrever:\n\n~S \u00b7 (??)f = |~S|\n?N ??P\n|~d|\n\n(4.5)\n\nFigura 4.3: Vetores ~S e ~d para uma malha na?o ortogonal [25].\n\nNo caso de malhas na?o ortogonais, o OpenFOAM dispo?e de func?o?es para\na correc?a?o dos gradientes. A aplicac?a?o implementada atualmente funciona\ncom malhas estruturadas mas, com a inclusa?o dos corretores na?o ortogonais\ndo sistema, podem ser usados diferentes tipos de ce?lulas.\n\n4.2.2 Discretizac?a?o dos operadores de advecc?a?o\n\nOs operadores de advecc?a?o sa?o relacionados aos termos de derivada pri-\nmeira no espac?o, como o operador mostrado na Equac?a?o (4.6) que atua sobre\na grandeza primitiva ? ,\n\n?\u00b7 (U?) , (4.6)\nonde ? e? um campo escalar definido no centro dos volumes de controle e U e?\num campo vetorial. A discretizac?a?o e? feita integrando-se a Equac?a?o (4.6) e\n\n\n\nCAPI?TULO 4. MODELAGEM COMPUTACIONAL 40\n\nassumindo-se um volume de controle com geometria polie?drica, assim atrave?s\ndo teorema da diverge?ncia podemos escrever:?\n\nV\n?\u00b7 (U?) dV =\n\n?\nf\n\n~S \u00b7 (U?)f =\n?\nf\n\n(\n~S \u00b7 (U)f\n\n)\n?f =\n\n?\nf\n\nF?f (4.7)\n\nonde F na Equac?a?o (4.7) representa o fluxo atrave?s de cada face do volume\nde controle e seus valores sa?o interpolados para cada face. O modo como\ninterpola-se os valores de ?f em cada face ira? definir o esquema de convecc?a?o\nusado. A Figura 4.4 mostra um exemplo de interpolac?a?o linear, que pode ser\ndescrita como:\n\n(?f )DC = ??P + (1 ??)?N (4.8)\nUsando-se a interpolac?a?o linear temos que o fator de interpolac?a?o ? e?\n\ndador por:\n\n? =\nfN\n\n|~d|\n(4.9)\n\nque representa o esquema de diferenc?as centradas de segunda ordem, o valor\n\nFigura 4.4: Interpolac?a?o linear [25].\n\nde ?f pode tambe?m ser avaliado nas faces de acordo com a direc?a?o do fluxo\nque passa pela face, F , segundo a relac?a?o:\n\n(?f )UP =\n\n{\n?P , F ? 0\n?N, F &lt;0.\n\n(4.10)\n\nque representa o esquema de diferenc?as Upwind de primeira ordem. Ha? ainda\num terceiro caso onde podemos combinar os dois esquemas anteriores e obter\num novo esquema chamado de Blended Diferencing, que pode ser obtido pela\nrelac?a?o:\n\n?f = ? (?f )UP + (1 ??) (?f )DC (4.11)\nO fator ?, 0 ? ? ? 1, na Equac?a?o (4.11) determina a quantidade de\n\ndifusa?o nume?rica que sera? introduzida no me?todo. Ale?m dos esquemas de\ninterpolac?a?o mostrados o OpenFOAM disponibiliza 70 esquemas de interpo-\nlac?a?o na versa?o 2.0.0 que podem ser usados pela aplicac?a?o desenvolvida.\n\n\n\nCAPI?TULO 4. MODELAGEM COMPUTACIONAL 41\n\n4.2.3 Discretizac?a?o temporal\n\nOs operadores de derivada temporal, em problemas transientes, sa?o dis-\ncretizados no OpenFOAM segundo diferentes te?cnicas, que, incorporadas a\nformulac?a?o escolhida na discretizac?a?o dos termos de derivadas espaciais, for-\nmara?o o me?todo de discretizac?a?o da equac?a?o. Dependendo do me?todo de\ndiscretizac?a?o do operador de derivada temporal escolhido sera?o armazenados\nos valores dos campos em diferentes instantes de tempo. A discretizac?a?o\npode ser feita de duas formas:\n\nMe?todo Euler Implicito, que armazena os valores dos campos no novo\npasso de tempo, n+ 1 , e no passo anterior n . A discretizac?a?o e? feita segundo\na Equac?a?o (4.12):\n\n?\n\n?t\n\n?\nV\n??dV =\n\n(?P?P )\nn+1 ? (?P?P )\n\nn\n\n?t\n(4.12)\n\nMe?todo de Diferenciac?a?o para Tra?s, que armazena os valores do novo\npasso de tempo, n+ 1, e nos dois passos anteriores n e n?1 . A discretizac?a?o\ne? feita segundo a Equac?a?o (4.13):\n\n?\n\n?t\n\n?\nV\n??dV =\n\n3 (?P?P )\nn+1 ? 4 (?P?P )\n\nn\n+ (?P?P )\n\nn?1\n\n2?t\n(4.13)\n\nSeja A a matriz que representa a ac?a?o conjunta dos operadores diferenciais\ncomo difusa?o e advecc?a?o. Aplicando o me?todo dos volumes finitos tem-se:\n\n? t+?t\nt\n\n[\n?\n\n?t\n\n?\nV\n\n(??) dV +\n?\nV\n\n(A?) dV\n\n]\ndt = 0 (4.14)\n\nUsando-se o me?todo Euler implicito, Equac?a?o (4.12), para discretizar o\ntermo da derivada temporal tem-se:\n\n? t+?t\nt\n\n[\n?\n\n?t\n\n?\nV\n\n(??) dV\n\n]\ndt =\n\n? t+?t\nt\n\n(?P?P )\nn+1 ? (?P?P )\n\nn\n\n?t\ndt\n\n? t+?t\nt\n\n[\n?\n\n?t\n\n?\nV\n\n(??) dV\n\n]\ndt = (?P?P )\n\nn+1 ? (?P?P )\nn\n\n(4.15)\n\nO segundo termo da Equac?a?o (4.14) pode ser escrito como:? t+?t\nt\n\n[?\nV\n\n(A?) dV\n]\ndt =\n\n? t+?t\nt\n\nAd?dt (4.16)\n\nonde Ad representa o operador diferencial discreto resultante da discretizac?a?o\ndo operador A feita usando o me?todo dos volumes finitos. As diferentes for-\nmas de avaliar a integral na Equac?a?o (4.16) em combinac?a?o com os me?todos\n\n\n\nCAPI?TULO 4. MODELAGEM COMPUTACIONAL 42\n\nde discretizac?a?o da derivada temporal forma as diferentes formulac?o?es para\na discretizac?a?o da equac?a?o diferencial. Na formulac?a?o expl??cita o operador\ndiscreto e? aplicado aos valores da func?a?o no passo de tempo atual, este me?-\ntodo de discretizac?a?o e? feito usando-se a classe fvc e e? descrito pela Equac?a?o\n(4.17). ? t+?t\n\nt\n\n[?\nV\n\n(A?) dV\n]\ndt = Ad?n?t (4.17)\n\nNa formulac?a?o impl??cita o operador discreto e? aplicado aos valores da\nfunc?a?o no passo de tempo posterior, este me?todo de discretizac?a?o e? feito\nusando-se a classe fvm e e? descrito pela Equac?a?o (4.18).\n\n? t+?t\nt\n\n[?\nV\n\n(A?) dV\n]\ndt = Ad?n+1?t (4.18)\n\nHa? ainda uma terceira formulac?a?o, Crank Nicholson, que pode ser obtida\nusando-se os dois esquemas anteriores descrito pela Equac?a?o 4.19.\n\n? t+?t\nt\n\n[?\nV\n\n(A?) dV\n]\ndt = Ad\n\n(\n?n+1 + ?n\n\n2\n\n)\n?t (4.19)\n\nNa seque?ncia temos a representac?a?o em C++ para a soluc?a?o da equac?a?o\nde difusa?o de calor 2.2 usando-se o me?todo Crank Nicholson com o Open-\nFOAM.\n\n1 fvScalarMatrix Teqn\n2 (\n3 0.5* fvc:: laplacian(T)\n4 + 0.5* fvm:: laplacian(T)\n5 + q\n6 ==\n7 (1/ alpha)*fvm::ddt(T)\n8 )\n\nO me?todo de discretizac?a?o do termo da derivada temporal e? escolhido no\ncaso a ser simulado. Pode-se ainda obter diferentes te?cnicas combinando os\noperadores descritos anteriormente.\n\n4.3 Me?todo IMPES\n\nO me?todo IMPES (Implicit Pressure Explicit Saturation) e? uma te?cnica\nempregada na soluc?a?o nume?rica do problema de escoamento multifa?sico. No\nesquema IMPES e? feito um desacoplamento na equac?a?o de conservac?a?o de\nmassa entre a pressa?o e a saturac?a?o, obtendo-se uma equac?a?o para cada\nvaria?vel. E? obtida uma equac?a?o de pressa?o que pode ser em func?a?o da pressa?o\n\n\n\nCAPI?TULO 4. MODELAGEM COMPUTACIONAL 43\n\nde uma das fases ou em func?a?o da pressa?o me?dia entre as fases. A equac?a?o de\npressa?o e? resolvida impl??citamente seguida da soluc?a?o expl??cita da equac?a?o\nde saturac?a?o. Para obter a equac?a?o de pressa?o sa?o somadas as equac?o?es de\nconservac?a?o de massa para cada fase e atrave?s da pressa?o capilar a equac?a?o\ne? escrita em func?a?o de apenas da pressa?o de uma das fases. Para a soluc?a?o\nda equac?a?o de pressa?o obtida sa?o necessa?rios os valores das varia?veis da\nequac?a?o no passo de tempo n+1, como esses valores ainda na?o sa?o conhecidos\neles sa?o calculados no passo de tempo n e a equac?a?o de pressa?o e? resolvida\nimpl??citamente. Apo?s a soluc?a?o da equac?a?o de pressa?o, e? resolvida a equac?a?o\nde saturac?a?o para uma das fases usando o campo de presso?es obtido.\n\n4.3.1 Tratamento das na?o linearidades\n\nA equac?a?o de pressa?o possui termos de permeabilidade relativa e pressa?o\ncapilar que dependem do valor da saturac?a?o no novo passo de tempo e termos\nque variam com a pressa?o. Para um escoamento incompress??vel os termos\nque variam com a pressa?o permanecem constantes ao longo do tempo, mas\nos valores que dependem da saturac?a?o precisam ser obtidos para o ca?lculo da\ndistribuic?a?o de presso?es. No me?todo IMPES a equac?a?o de pressa?o (3.39) e?\nlinearizada explicitamente como mostra a Equac?a?o (4.20):\n\n?\u00b7\n(\nTnpo?p\n\nn+1\no\n\n)\n= ?\u00b7\n\n(\nTnpc?p\n\nn\nc\n\n)\n??\u00b7 (TnZ?Z) ?Q\n\nn (4.20)\n\nApo?s a soluc?a?o da equac?a?o de pressa?o obtemos a saturac?a?o, Equac?a?o\n(3.37), a partir da Equac?a?o (4.21):\n\n?\n\n?c\n\n?sw\n?t\n\n= ?\u00b7\n{[\n?c\nKkrw(s\n\nn\nw)\n\n\u00b5w\n\n(\n?pn+1o ??pc(s\n\nn\nw) + ?w?Z\n\n)]}\n+\nqnwsc\nVb\n\n(4.21)\n\nque e? resolvida explicitamente e pode ser reescrita como:\n\n?\n\n?c\n\n?sw\n?t\n\n= ?\u00b7\n(\nTnpc?p\n\nn+1\no\n\n)\n??\u00b7\n\n(\nTnpc?p\n\nn\nc\n\n)\n+ ?\u00b7 (Tnzw?Z) +\n\nqnwsc\nVb\n\n(4.22)\n\nonde Tpc e? dado pela Equac?a?o (3.42).\nPara a soluc?a?o das equac?o?es e? utilizado o me?todo dos volumes finitos, que\n\npara discretizar os operadores necessita dos valores das transmissibilidades\nnas faces dos volumes de controle como mostrado na Equac?a?o (4.23). O\ncampo de permeabilidades absolutas e? interpolado para as faces usando-se\numa me?dia harmo?nica entre os valores dos centros das ce?lulas vizinhas como\nmostrado na malha estruturada composta por hexaedros da a Figura 4.5.\n\nNa Figura 4.5 kf representa a permeabilidade me?dia na face entre os\npontos N e P . Essa me?dia pode ser: aritme?tica, geome?trica ou harmo?nica.\n\n\n\nCAPI?TULO 4. MODELAGEM COMPUTACIONAL 44\n\nFigura 4.5: Representac?a?o de duas ce?lulas vizinhas.\n\nA interpolac?a?o mais utilizada e? a me?dia harmo?nica que pode ser calculada\nsegundo a expressa?o:\n\n1\n\nkf\n=\n\n1\n\n2\n\n(\n1\n\nkP\n+\n\n1\n\nkN\n\n)\n(4.23)\n\nO OpenFOAM dispo?e de muitas te?cnicas de interpolac?a?o, para decidir\nqual a melhor te?cnica a ser empregada posteriormente sera?o avaliadas as di-\nferentes propostas de interpolac?a?o, e o efeito de cada uma delas na soluc?a?o\ndos feno?menos de escoamento em meios porosos. No cap??tulo 5 sera? discu-\ntido como foi feita a interpolac?a?o do campo de permeabilidades absolutas ja?\nque na versa?o atual do OpenFOAM na?o existe um esquema de interpolac?a?o\nharmo?nica implementado. No caso do campo de permeabilidades relativas a\ninterpolac?a?o e? feita de acordo com o esquema escolhido no direto?rio do caso.\nPara todos os problemas resolvidos na verificac?a?o do simulador foi uitlizado\no esquema upwind. A verificac?a?o e a comparac?a?o entre diferentes esquemas\nde interpolac?a?o para a permeabilidade relativa na?o sera?o feitas neste texto\nmas estara?o presentes em trabalhos futuros.\n\n\n\nCap??tulo 5\n\nAplicac?a?o IMPES\n\nConforme mencionado anteriormente, para a implementac?a?o da aplica-\nc?a?o foi escolhido o me?todo IMPES, que e? um me?todo nume?rico de soluc?a?o\naplicado ao modelo Black-oil. Na modelagem do escoamento em meios po-\nrosos existem dois modelos de fluxo que sa?o mais usados, o modelo Beta e o\nComposicional. No modelo Beta adimite-se que o fluido e? composto de dois\npseudocomponentes, l??quido e vapor, o balanc?o de massa e? aplicado para\ncada pseudocomponente e assume-se que as propriedades das fases sa?o fun-\nc?o?es da pressa?o e da temperatura. O modelo chamado Beta e? comumente\nchamado de modelo Black-oil em que o ga?s pode estar presente em ambas as\nfases enquanto o componente o?leo fica restrito a? fase liquida, neste modelo\nsa?o assumidos tre?s componentes: a?gua, o?leo e ga?s [9]. Os componentes a?gua\ne o?leo sa?o assumidos ser imisc??veis e o ga?s e? considerado ser solu?vel no o?leo.\nO comportamento PVT do sistema formado pelos componentes a?gua, o?leo\ne ga?s e? definido pelas varia?veis Bo, Bw e Bg sendo a transfere?ncia de massa\nentre o?leo e ga?s descrita pela raza?o de solubilidade Rs. O programa imple-\nmentado neste trabalho utiliza o me?todo IMPES para resolver um problema\nque representa uma simplificac?a?o do modelo Black-oil onde apenas a fase\nliquida esta? presente. A escolha de um modelo simplificado na?o restringe a\nexpansa?o do simulador a um modelo mais complexo, ja? que a incorporac?a?o\nde outras f??sicas no programa e? facilitada devido a orientac?a?o a objetos que\ne? caracter??stica do ambiente.\n\nApo?s a implementac?a?o do modelo monofa?sico, mencionado no Cap??tulo\n2, foi desenvolvida a aplicac?a?o que simula o escoamento bifa?sico em meios\nporosos. Basicamente o modelo monofa?sico consiste na soluc?a?o de uma equa-\nc?a?o el??ptica, a equac?a?o de pressa?o, equivalente a resolvida nos problemas de\ndifusa?o de calor. A implementac?a?o do simulador bifa?sico usa como base o\nmodelo monofa?sico, pois a equac?a?o de pressa?o resolvida no modelo bifa?sico e?\nsimilar a do modelo monofa?sico. De maneira simplificada, neste modelo sera?\n\n45\n\n\n\nCAPI?TULO 5. APLICAC?A?O IMPES 46\n\nresolvida apenas uma equac?a?o adicional com relac?a?o ao modelo monofa?sico,\na equac?a?o de saturac?a?o, que e? uma equac?a?o de advecc?a?o-difusa?o.\n\nNeste cap??tulo sera? apresentada a aplicac?a?o desenvolvida no OpenFOAM.\nCada trecho de co?digo apresentado no cap??tulo foi retirado da aplicac?a?o com\no objetivo de explicar o funcionamento do sistema de forma pra?tica. A apre-\nsentac?a?o da aplicac?a?o e? feita segundo a ordem de execuc?a?o do programa,\npara um melhor entendimento de como e? feito um programa no ambiente.\nA fim de se ressaltar melhores pra?ticas de programac?a?o com o ambiente sa?o\napresentadas algumas caracter??sticas do sistema que geraram dificuldades na\nimplementac?a?o e o modo como essas dificuldades foram contornadas.\n\n5.1 Criac?a?o da aplicac?a?o\n\nA implementac?a?o de aplicac?o?es no OpenFoam, como ja? foi exposto an-\nteriormente, se da? atrave?s do uso da representac?a?o tensorial das equac?o?es\natrave?s das classes que representam os operadores diferenciais. O IMPES foi\na te?cnica escolhida para a soluc?a?o das equac?o?es resultantes do problema de\nescoamento bifa?sico. A discretizac?a?o e os me?todos de interpolac?a?o escolhidos\nseguem o esquema apresentado no principal livro que orientou este trabalho\n[20]. Como a maioria dos artif??cios nume?ricos utilizados para a linearizac?a?o\ndas equac?o?es e os esquemas de interpolac?a?o usados e? feita na forma discre-\ntizada das equac?o?es, e? necessa?ria uma construc?a?o de equac?o?es diferenciais\nna forma tensorial com esquemas de interpolac?a?o para cada termo, de cada\noperador diferencial, que seja equivalente a apresentada apo?s a aplicac?a?o dos\nme?todos de linearizac?a?o aplicados nas equac?o?es discretizadas.\n\nA criac?a?o dos campos de varia?veis envolvidas nas equac?o?es presentes no\nmodelo implementado e? feita atrave?s de classes espec??ficas do ambiente. As\nvaria?veis sa?o definidas na aplicac?a?o e arquivos contendo suas condic?o?es de\ncontorno, seus valores iniciais e as unidades sa?o criadas no direto?rio do caso.\n\nO trecho de co?digo a seguir mostra a definic?a?o de um campo tensorial na\naplicac?a?o. A classe volTensorField cria um campo tensorial tridimensional\nque associa um tensor a cada volume de controle da malha criada. A criac?a?o e?\nfeita com a estrutura IOobject na qual sa?o especificados o nome da varia?vel,\nem qual direto?rio sera? armazenado ou lido o campo, a malha que estara?\nassociada ao campo de tensores e dois para?metros de leitura e escrita.\n\n1 volTensorField K\n2 (\n3 IOobject\n4 (\n5 \"K\",\n6 runTime.constant(),\n\n\n\nCAPI?TULO 5. APLICAC?A?O IMPES 47\n\n7 mesh ,\n8 IOobject ::MUST_READ ,\n9 IOobject :: NO_WRITE\n\n10 ),\n11 mesh\n12 );\n\nPara a criac?a?o de uma varia?vel dependente do tempo deve ser especifi-\ncado o direto?rio como runTime.timeName(), que representa o direto?rio com\no nome do passo de tempo atual no caso e os para?metros de escrita devem\nser mudados a fim de que sejam gravados os valores a cada iterac?a?o. Na\nbiblioteca existem ainda outras varia?veis pre?-definidas como constantes ma-\ntema?ticas e f??sicas. A tabela 5.1 mostra os campos criados na aplicac?a?o.\n\nTabela 5.1: Listagem dos campos criados na aplicac?a?o.\n\nVaria?vel Tipo de campo\nK volTensorField\n\nac, so, sw, kro, krw, po, pw e pc volScalarField\nKf, Tpc, Tpo, Tz e Tzw surfaceTensorField\n\nkrof, krwf surfaceScalarField\n\nNo OpenFOAM um campo do tipo volField e? um campo definido no cen-\ntro das ce?lulas resultantes da discretizac?a?o do dom??nio e um do tipo surface-\nField e? um campo definido nas faces das ce?lulas. Devido a? grande quantidade\nde dados gerados pela criac?a?o de cada campo e? importante que seja criado o\nmenor nu?mero de campos poss??vel, a fim de reduzir a memo?ria necessa?ria a?\nexecuc?a?o do programa.\n\nA criac?a?o dos para?metros escalares constantes da aplicac?a?o e? feita atrave?s\nda classe IOdictionary. A classe utiliza a mesma estrututra para varia?veis\nde entrada e sa??da do sistema e assim como no exemplo anterior, o direto?rio\ndo arquivo contendo os para?metros e? especificado na estrutura. No co?digo a\nseguir encontra-se a criac?a?o do objeto que conte?m os para?metros.\n\n1 IOdictionary params\n2 (\n3 IOobject\n4 (\n5 \"params\",\n6 runTime.constant(),\n7 mesh ,\n8 IOobject ::MUST_READ ,\n\n\n\nCAPI?TULO 5. APLICAC?A?O IMPES 48\n\n9 IOobject :: NO_WRITE\n10 )\n11 );\n\nQuando a aplicac?a?o e? executada no direto?rio do caso o programa ira?\nreconhecer a estrutura de arquivos caracter??stica do mesmo e ira? atribuir a\nestrutura runTime, os caminhos de cada direto?rio no caso. Apo?s a definic?a?o\nda varia?vel que aponta para o arquivo com os para?metros, a criac?a?o de um\nescalar e? feita como mostrado a seguir:\n\n1 dimensionedScalar ALPHA_C (params.lookup(\"ALPHA_C\"));\n\npara que a varia?vel possa ser criada e? necessa?rio que ela esteja no arquivo\nparams criado no direto?rio do caso.\n\nPara a obtenc?a?o dos valores das permeabilidades relativas no programa\ndesenvolvido e? usada uma interpolac?a?o feita a partir de valores fornecidos\nem uma tabela de pontos com os valores experimentais de permeabilidade\nrelativa para cada saturac?a?o dada. Atrave?s desses pontos e? obtida uma curva\ninterpolada com splines, a qual e? usada para o ca?lculo do campo de permeabi-\nlidades. Assim como a permeabilidade relativa, a capilaridade e? uma func?a?o\nda saturac?a?o e na implementac?a?o do simulador foi obtida tambe?m atrave?s de\numa interpolac?a?o com uso de splines entre valores experimentais fornecidos\nao programa.\n\nApo?s a definic?a?o das varia?veis sa?o lidos dois arquivos no direto?rio do caso,\no arquivo de permeabilidades relativas e o arquivo de presso?es capilares. Estes\narquivos conte?m os pontos que sera?o interpolados usando splines que ira?o\ngerar as curvas utilizadas pela aplicac?a?o. Como foi comentado no cap??tulo\n3, a curva fornecida para a permeabilidade relativa deve ser a referente ao\nprocesso de embebic?a?o. Para o ca?lculo das condic?o?es iniciais sera? assumido\nque os poros da formac?a?o sa?o largos e que o campo de porosidades e? uniforme,\npodendo-se, assim, desprezar a zona de transic?a?o de saturac?o?es. A curva de\npressa?o capilar utilizada para a soluc?a?o das equac?o?es sera? a referente ao\nprocesso de embebic?a?o.\n\nPara o ca?lculo dos termos de fluxo, os valores de permeabilidade absoluta\ndevem ser calculados nas faces, ja? que o campo primeiramente criado esta?\nassociado apenas ao centro dos volumes de controle. Como foi mostrado no\ncap??tulo 4 o ca?lculo dos valores nas faces deve ser feito atrave?s de uma me?dia\nharmo?nica dos valores das ce?lulas que compartilham a face. O OpenFOAM\noferece 41 diferentes esquemas de interpolac?a?o para os valores das faces na\nversa?o 2.0.0, incluido um esquema para me?dia harmo?nica. Entretanto esse\nesquema na?o se aplica a campos tensoriais. Dessa forma, foi necessa?ria a\nimplementac?a?o do esquema de interpolac?a?o na aplicac?a?o. Para na?o se perder\no paralelismo caracter??stico do sistema existe uma sintaxe pro?pria do Open-\n\n\n\nCAPI?TULO 5. APLICAC?A?O IMPES 49\n\nFOAM para lac?os que sejam executados em paralelo utilizando as estruturas\ne varia?veis do sistema. O trecho de co?digo a seguir mostra um lac?o feito para\ncalcular o valor das permeabilidades absolutas nas faces.\n\n1 const unallocLabelList&amp; own = mesh.owner ();\n2 const unallocLabelList&amp; nei = mesh.neighbour ();\n3\n4 forAll(Kf,i)\n5 {\n6 Kf[i].xx() = 2*K[own[i]].xx()*K[nei[i]].xx()/\n7 (K[own[i]].xx()+K[nei[i]].xx());\n8 Kf[i].yy() = 2*K[own[i]].yy()*K[nei[i]].yy()/\n9 (K[own[i]].yy()+K[nei[i]].yy());\n\n10 Kf[i].zz() = 2*K[own[i]].zz()*K[nei[i]].zz()/\n11 (K[own[i]].zz()+K[nei[i]].zz());\n12 }\n\nAtrave?s dos me?todos do objeto mesh, mesh.owner() e mesh.neighbour(),\nsa?o obtidos os labels das ce?lulas que compartilham cada face, com esses va-\nlores sa?o calculadas as me?dias das permeabilidades nas faces. Para utilizar\na sintaxe forAll e? necessa?rio que seja especificado o campo no qual sera? re-\nalizado o loop, como o desejado e? calcular os valores nas faces como me?dia\nharmo?nica dos centros, foi feito um lac?o para cada campo. O melhor modo\nseria utilizar fvc::interpolate(K,\u201charmonic\u201d), que na?o esta? dispon??vel para\num campo volTensorField. Os campos resultantes descritos pelas equac?o?es\n(3.40), (3.41), (3.42) e (3.43) sa?o calculados e em seguida e? feita a soluc?a?o das\nequac?o?es de fluxo. A representac?a?o das equac?o?es de fluxo do me?todo IMPES\ndescrito no cap??tulo 4, 4.20 e 4.22, em C++ e? feita da seguite forma:\n\n1 fvScalarMatrix poEqn\n2 (\n3 fvm:: laplacian(Tpo ,po)\n4 ==\n5 fvc:: laplacian(Tz,Z)\n6 + fvc:: laplacian(Tpc ,pc)\n7 - Q\n8 );\n9 poEqn.solve ();\n\n1 fvScalarMatrix swEqn\n2 (\n3 ac*fvm::ddt(sw) ==\n4 fvc:: laplacian(Tpc ,po)\n5 - fvc:: laplacian(Tpc ,pc)\n6 - fvc:: laplacian(Tzw ,Z)\n7 + Qw\n8 );\n9 swEqn.solve ();\n\n\n\nCAPI?TULO 5. APLICAC?A?O IMPES 50\n\napo?s a soluc?a?o dessas equac?o?es todas as propriedades que variam com o tempo\nsa?o recalculadas e um novo passo de tempo se inicia. Deve-se destacar que\no sinal do termo referente ao efeito gravitacional esta? com o sinal diferente\ndas Equac?o?es 4.20 e 4.22. Essa mudanc?a de sinal se deve a? orientac?a?o de\neixos adotada na deduc?a?o das equac?o?es, com o eixo z apontando para baixo.\nComo o operador do OpenFOAM utiliza o eixo para cima e? necessa?rio trocar\no sinal na equac?a?o.\n\n5.2 Criac?a?o do caso\n\nComo em qualquer caso que usa uma aplicac?a?o desenvolvida no Open-\nFOAM, deve-se seguir a estrutura de um direto?rio padra?o de caso do sistema.\nA Figura 5.1 mostra a estrutura de arquivos criada. No direto?rio 0 sa?o ar-\nmazenadas as varia?veis que tem seu valor alterado a cada passo de tempo,\npropriedades como porosidade e permeabilidade absoluta neste problema na?o\nvariam com o tempo sendo necessa?ria a sua definic?a?o no direto?rio constant.\nAinda no direto?rio constant fica armazenado o arquivo params.\n\nFigura 5.1: Caso que utiliza a aplicac?a?o IMPES.\n\nO direto?rio 0.org foi criado pois cada vez que executa-se o programa, os\narquivos no direto?rio 0 sa?o alterados e para executar novamente o programa\ne? necessa?rio que os arquivos estejam com as mesmas condic?o?es dos arquivos\n0.org, deste modo para facilitar a execuc?a?o, os arquivos sa?o copiados do\ndireto?rio 0.org para o direto?rio 0. Na?o e? necessa?ria a criac?a?o do campo so\nno direto?rio 0 pois o mesmo pode ser calculado como 1 ? sw, o campo foi\ncolocado no direto?rio de varia?veis de tempo por convenie?ncia.\n\n\n\nCAPI?TULO 5. APLICAC?A?O IMPES 51\n\nA geometria do problema de benchmark mais usado neste tipo de simu-\nlador e? a do modelo de malha de injec?a?o five-spot. Devido a simetria do\nproblema e? apenas resolvido um quarto de um elemento da malha de inje-\nc?a?o. A Figura 5.2 ilustra o modelo. Para a criac?a?o da geometria e gerac?a?o\nda malha foi utilizado o gerador de malhas de blocos, o blockMesh, nativo\ndo sistema. Devido ao fato do OpenFOAM na?o possuir me?dias harmo?nicas,\npara campos tensoriais, a alternativa implementada apenas poder ser usada\npara malhas estruturadas e com espac?amento constante.\n\nFigura 5.2: Esquema five-spot.\n\nPara possibilitar a soluc?a?o de problemas em que poc?os direcionais sa?o\nusados foi implementada uma rotina para calcular a trajeto?ria dos poc?os.\nEsse modelo apesar de ainda na?o estar sendo usado de fato na aplicac?a?o foi\nimplementado com o intuito de poder calcular o perfil de presso?es ao longo da\ncoluna de um poc?o direcional. O ca?lculo das perdas de carga nos poc?os ainda\nna?o foi implementado, mas podera? ser feito em trabalhos futuros. Apartir\nde pontos definidos em um arquivo no caso sa?o interpoladas duas curvas,\nutilizando splines, uma com a projec?a?o xz da curva e outra com a projec?a?o\nyz. Com as curvas pode-se determinar quais blocos da malha sa?o cortados\npela trajeto?ria do poc?o e varia?veis booleanas determinam em que intervalos o\npoc?o estara? aberto para o fluxo. Dependendo do modelo geolo?gico e? possivel\na utilizac?a?o desse modelo de trajeto?rias para colocar termos de fonte que\nrepresentam um poc?o com completac?a?o dupla, ou seja, que injeta em um\nintervalo e produz de outro. Muitas configurac?o?es sa?o poss??veis com este\ntipo de modelo e a ocorre?ncia de poc?os de petro?leo com essa configurac?a?o e?\nbastante comum em campos de terra. A Figura 5.3 mostra um esquema do\najuste feito na trajeto?ria de um poc?o injetor aberto ao fluxo em duas zonas.\n\nNa construc?a?o do modelo de poc?o inclinado e? necessa?rio o acoplamento\n\n\n\nCAPI?TULO 5. APLICAC?A?O IMPES 52\n\nFigura 5.3: Ajuste da traje?toria de um poc?o direcional.\n\ndas presso?es especificadas no fundo do poc?o, com as presso?es do reservato?rio.\nPara o acoplamento e? utilizado o modelo de Peaceman [35] no qual a Equac?a?o\n(3.44) e? reescrita para o bloco (i,j,k) que conte?m o poc?o como:\n\nqi,j,k l = IPl (pi,j,k ?pwf ) (5.1)\n\nPara poc?os verticais IP pode ser calculado pela Equac?a?o (3.45), no entanto,\npara poc?os inclinados essa equac?a?o so? e? va?lida no caso em que o campo de\npermeabilidades absolutas e? isotro?pico. Existem modelos na literatura que\ndescrevem me?todos diferentes para o ca?lculo do IP para o caso de poc?os in-\nclinados [7] [39] [19]. A implementac?a?o desse tipo de modelo de acoplamento\nsera? abordada em trabalhos futuros.\n\n\n\nCap??tulo 6\n\nResultados\n\nPara a verificac?a?o do simulador implementado foram resolvidos problemas\nno simulador comercial IMEX [1]. Para a comparac?a?o foi usado o modelo\noilwater do IMEX com modelo similar ao implementado na aplicac?a?o. Foram\nespecificados valores nulos de compressibilidades dos fluidos e da rocha com\nponto de bolha fixo e as mesmas condic?o?es iniciais e de contorno. Foram\nresolvidos exemplos de escoamento unidimensional, com geometria plana e\ncom geometria tridimensional. Para demonstrac?a?o foi resolvido um exemplo\nque usa a aplicac?a?o feita com o modelo monofa?sico levemente compress??vel.\n\n6.1 Resultados da aplicac?a?o de escoamento\n\nmonofa?sico\n\nAs Tabelas 6.1 e 6.2 mostram as propriedades da rocha e do fluido utilizas\nna soluc?a?o do caso monofa?sico. A aplicac?a?o na?o foi verificada com o IMEX\ncomo a aplicac?a?o bifa?sica. Os resultados aqui apresentados apenas ilustram\num exemplo de um caso resolvido com esta aplicac?a?o.\n\nTabela 6.1: Propriedades do fluido (Caso monofa?sico).\n\nPropriedade Simbolo Valor\nFator volume de formac?a?o a? Pref Bref 1\nMassa espec??fica a? Pref ?ref 30 kg/m\n\n3\n\nViscosidade a? Pref \u00b5ref 8 cp\nCompressibilidade do fluido cf 1.0 \u00d7 10?5 psi?1\n\n53\n\n\n\nCAPI?TULO 6. RESULTADOS 54\n\nTabela 6.2: Propriedades da rocha (Caso monofa?sico).\n\nPropriedade Simbolo Valor\nPorosidade ? 0.2\nCompressibilidade da rocha cr 1.0 \u00d7 10?5 psi?1\nPermeabilidade absoluta k 200 mD\n\nPara a soluc?a?o foi utilizada uma geometria hexae?drica medindo 1000 ft\nnas direc?o?es x e y com 100ft na direc?a?o z. A geometria foi discretizada com\nblocos cu?bicos com aresta medindo 20ft e foi colocado um sumidouro nas\nce?lulas de um dos ve?rtices da geometria com vaza?o total das ce?lulas de 16\nbbl/d. Foi usado um passo de tempo de 1 dia, a Figura 6.1 mostra a soluc?a?o\nde pressa?o apo?s 100 dias.\n\nFigura 6.1: Soluc?a?o de pressa?o do caso monofa?sico.\n\n6.2 Verificac?a?o da aplicac?a?o IMPES\n\nAs propriedades da rocha utilizada em todos os exemplos a seguir esta?o\nlistadas na Tabela 6.3. Os valores de compressibilidade foram atribuidos\nnulos apenas no IMEX ja? que a aplicac?a?o feita no OpenFOAM ja? utiliza\nas equac?o?es do modelo incompress??vel. O campo de permeabilidades relati-\nvas utilizado e? homoge?neo e isotro?pico com o valor dado na tabela 6.3. As\npropriedades dos fluidos esta?o descritas na Tabela 6.4, assim como a com-\npressibilidade da rocha a compressibilidade do fluido foi atribu??da apenas no\nIMEX. As curvas de permeabilidade relativa e pressa?o capilar utlizadas nos\nexemplos esta?o descritas na tabela 6.5. Foram resolvidos problemas com e\nsem pressa?o capilar. Os valores na tabela de permeabilidades e presso?es ca-\npilares foram utilizados pela aplicac?a?o do OpenFOAM para a contruc?a?o de\n\n\n\nCAPI?TULO 6. RESULTADOS 55\n\nTabela 6.3: Propriedades da rocha (Caso bifa?sico).\n\nPropriedade Simbolo Valor\nPorosidade ? 0.2\nCompressibilidade cr 0.0 psi\n\n?1\n\nPermeabilidade absoluta k 200 mD\n\nTabela 6.4: Propriedades dos fluidos (Caso bifa?sico).\n\nPropriedade Simbolo Valor\nDensidade do o?leo ?osc 46.2 kg/m\n\n3\n\nDensidade da a?gua ?wsc 62.2 kg/m\n3\n\nViscosidade do o?leo \u00b5o 0.90 cp\nViscosidade da a?gua \u00b5w 0.30 cp\nCompressibilidade do o?leo co 0.00\nCompressibilidade da a?gua cw 0.00\n\nTabela 6.5: Curvas de permeabilidade relativa e pressa?o capilar.\n\nsw kro krw pc\n0.0 1.0000 0.0000 10.00\n0.2 0.5625 0.0000 1.949\n0.4 0.2500 0.0625 0.280\n0.6 0.0625 0.2500 0.059\n0.8 0.0000 0.5625 0.026\n1.0 0.0000 1.0000 0.000\n\nsplines, sendo os valores calculados durante a simulac?a?o obtidos da interpo-\nlac?a?o desses dados. Como na?o houve diferenc?a significativa entre as soluc?o?es\ncom e sem pressa?o capilar, os exemplos a seguir mostrara?o apenas as soluc?o?es\nsem pressa?o capilar.\n\n6.2.1 Escoamento unidimensional\n\nPara a comparac?a?o dos resultados obtidos no caso unidimensional foi uti-\nlizada a geometria mostrada na Figura 6.2 na qual foram usados 40 elementos\n\n\n\nCAPI?TULO 6. RESULTADOS 56\n\ncu?bicos com aresta de 500 m cada, totalizando um comprimento de 20000\nm. Foram colocados dois poc?os, um injetor no centro do primeiro bloco e um\nprodutor no centro do u?ltimo bloco. A pressa?o no poc?o produtor foi fixada\nem 1000 psi e a vaza?o em ambos os poc?os em 2000 bbl/d. Tanto no IMEX\ncomo na aplicac?a?o foi usado um incremento de tempo de 10 dias. A Figura\n6.3 mostra o perfil do campo de presso?es para o instante de tempo 28105d\nque equivale a 77 anos.\n\nFigura 6.2: Malha usada no problema unidimensional.\n\nPode-se observar na Figura 6.3 que o perfil da curva obtida com o Open-\nFOAM e? similar ao obtido no IMEX a na?o ser pela pressa?o no poc?o injetor\nque na?o foi honrada, com uma diferenc?a de pouco menos de 0.99%.\n\nFigura 6.3: Comparac?a?o do perfil de pressa?o 1D.\n\nO modelo de acoplamento de poc?o utilizado fixa a pressa?o apenas no\npoc?o produtor deixando a ce?lula do poc?o injetor apenas com o termo de\nfonte correspondete a? vaza?o local. Esse problema esta? sendo analisado e\n\n\n\nCAPI?TULO 6. RESULTADOS 57\n\nalgumas alternativas esta?o sendo estudadas afim de melhor representar as\ncondic?o?es de injec?a?o. A Figura 6.4 mostra o perfil do campo de saturac?o?es\npara o instante de tempo de 77 anos. Apesar da soluc?a?o da equac?a?o de\n\nFigura 6.4: Comparac?a?o do perfil de saturac?a?o 1D.\n\nsaturac?a?o no OpenFOAM representar de maneira similar a soluc?a?o obtida\ncom o IMEX observa-se a grande difusa?o nume?rica. Esta grande difusa?o se\ndeve ao esquema upwind, adotado na aplicac?a?o do OpenFOAM. Alternativas\nao esquema de interpolac?a?o que e? usado na advecc?a?o da saturac?a?o esta?o\nsendo investigadas e a implementac?a?o de outra formulac?a?o para a equac?a?o\nde saturac?a?o sera? tratada em trabalhos futuros.\n\n6.2.2 Escoamento bidimensional\n\nPara a comparac?a?o dos resultados em duas dimenso?es foi resolvido um\nproblema equivalente ao unidimensional, com o mesmo passo de tempo,\nmudando-se apenas a geometria do problema para uma caso bidimensional\ne aumentando-se a vaza?o de cada poc?o para 20000 bbl/d. Nos problemas de\nduas ou mais dimenso?es usados para a comparac?a?o com o IMEX foi utilizada\na condic?a?o de contorno de simetria do OpenFOAM, symetryPlane, devido\na caracteristica sime?trica dos problemas resolvidos. O sistema de equac?o?es\nresultante da discretizac?a?o da equac?a?o de pressa?o resulta em um problema\nmal posto. Neste tipo de problema e? necessa?rio que se especifique um valor\nde pressa?o de refere?ncia para se resolver o sistema de equac?o?es. A pressa?o\nde refere?ncia que foi utilizada e? a pressa?o obtida atrave?s do modelo de Pe-\naceman, que foi apresentado no Cap??tulo 3. A Figura 6.5 mostra a malha\n\n\n\nCAPI?TULO 6. RESULTADOS 58\n\nFigura 6.5: Malha usada no problema bidimensional.\n\nutilizada na soluc?a?o do problema e o posicionamento dos poc?os. A figura 6.6\nmostra a soluc?a?o da pressa?o no instante de tempo igual a 91250d que equivale\na? 250 anos.\n\nFigura 6.6: Soluc?a?o da pressa?o no problema bidimensional.\n\nPara uma melhor visualizac?a?o da diferenc?a entre os dois simuladores foi\nfeita uma secc?a?o na diagonal que liga os poc?os. A figura 6.7 mostra as\ncurvas de pressa?o na diagonal mensionada. Novamente pode-se observar que\na soluc?a?o com a aplicac?a?o desenvolvida e? similar a? obtida no IMEX.\n\nA figura 6.8 mostra a soluc?a?o da saturac?a?o para o mesmo instante de\ntempo. Assim como na soluc?a?o de pressa?o uma comparac?a?o entre as duas\n\n\n\nCAPI?TULO 6. RESULTADOS 59\n\nFigura 6.7: Comparac?a?o das soluc?o?es de pressa?o 2D na direc?a?o diagonal.\n\nsoluc?o?es foi feita ao longo da diagonal que liga os poc?os. A figura 6.9 mostra\na comparac?a?o entre as soluc?o?es de saturac?a?o na diagonal. A soluc?a?o das\nequac?o?es para o caso bidimensional retrata bem a soluc?a?o obitida com o\nIMEX.\n\nFigura 6.8: Soluc?a?o da saturac?a?o do problema bidimensional.\n\n\n\nCAPI?TULO 6. RESULTADOS 60\n\nFigura 6.9: Comparac?a?o das soluc?o?es de saturac?a?o 2D na direc?a?o diagonal.\n\n6.2.3 Escoamento tridimensional\n\nPara a comparac?a?o no caso tridimensional foi criada uma geometria he-\nxae?drica com 40 blocos na direc?a?o x, 40 na direc?a?o y e 5 blocos na direc?a?o z.\nO mesmo incremento de tempo dos casos anteirores foi utilizado em ambos os\nsimuladores. A vaza?o dos poc?os foi fixada em 200000 bbl/d. Os poc?os injetor\ne produtor se encontram na primeira e na u?ltima ce?lula do plano superior,\ncomo mostrado na figura 6.10.\n\nFigura 6.10: Malha usada no problema tridimensional.\n\nA figura 6.11 mostra a soluc?a?o da equac?a?o de saturac?a?o, nos dois simula-\ndores, no instante de tempo igual a 28105d que equivale a? 77 anos.\n\n\n\nCAPI?TULO 6. RESULTADOS 61\n\nFigura 6.11: Soluc?a?o da saturac?a?o do problema tridimensional.\n\nUma secc?a?o foi feita na diagonal do plano superior para uma melhor\nvisualizac?a?o dos resultados. A comparac?a?o entre as soluc?o?es na diagonal e?\nmostrada na figura 6.13\n\nFigura 6.12: Comparac?a?o das soluc?o?es de saturac?a?o 3D na direc?a?o diagonal.\n\nA comparac?a?o entre as soluc?o?es na diagonal mostra claramente uma\ngrande difusa?o presente na aplicac?a?o implementada. Ainda que a soluc?a?o\ndo esquema upwind seja bastante difusiva a quantidade de difusa?o apresen-\n\n\n\nCAPI?TULO 6. RESULTADOS 62\n\ntada mostra que ha? um problema na soluc?a?o para o caso 3D. A figura 6.14\nmostra a soluc?a?o da equac?a?o de pressa?o no IMEX para o mesmo problema\nno mesmo instante de tempo.\n\nFigura 6.13: Soluc?a?o da pressa?o do problema tridimensional no IMEX.\n\nA figura 6.14 mostra a soluc?a?o encontrada com a aplicac?a?o desenvolvida\nno OpenFOAM.\n\nFigura 6.14: Soluc?a?o da pressa?o do problema tridimensional no OpenFOAM.\n\nUma mesma comparac?a?o foi feita para as soluc?o?es de pressa?o na direc?a?o\nda diagonal do plano superior. A figura 6.15 mostra a comparac?a?o. Assim\ncomo na soluc?a?o de saturac?a?o uma grande diferenc?a foi encontrada entre as\nsoluc?o?es de pressa?o. O maior n??vel de pressa?o e? apresentado na soluc?a?o da\n\n\n\nCAPI?TULO 6. RESULTADOS 63\n\naplicac?a?o desenvolvida. O motivo da do erro na soluc?a?o da aplicac?a?o no caso\ntridimensional ainda esta? sendo investigado.\n\nFigura 6.15: Comparac?a?o das soluc?o?es de pressa?o 3D na direc?a?o diagonal.\n\n6.2.4 Caso heteroge?neo bidimensional\n\nComo exemplo de soluc?a?o de um problema heteroge?neo foi montado um\nmapa de permeabilidades atrave?s da intesidade de cor do logotipo da univer-\nsidade. A figura 6.16 mostra o mapa de permeabilidades montado.\n\nFigura 6.16: Mapa de permeabilidades do caso bidimensional.\n\n\n\nCAPI?TULO 6. RESULTADOS 64\n\nA intensidade de cor foi normalizada e transformada em um fator que foi\nmultiplicado por 200 mD, deste modo a menor permeabilidade do mapa e?\nde 2 mD. Como mostrado na figura 6.16 foram colocados um poc?o injetor\nno primeiro bloco e um poc?o produtor no u?ltimo bloco. O mapa de perme-\nabilidades foi usado em uma geometria plana com 150 blocos na direc?a?o x e\n100 blocos na direc?a?o y. Cada bloco cu?bico possui 100 m de aresta e as mes-\nmas propriedades utilizadas nos problemas de comparac?a?o foram utilizadas.\nA figura 6.17 mostra as soluc?o?es da equac?a?o de saturac?a?o com isolinhas de\npressa?o para os instantes de tempo 33, 77, 110 e 176 anos.\n\nFigura 6.17: Soluc?a?o do caso heteroge?neo bidimensional.\n\n\n\nCAPI?TULO 6. RESULTADOS 65\n\n6.2.5 Caso heteroge?neo tridimensional\n\nO segundo exemplo de problema heteroge?neo apresentado utiliza a mesma\nconfigurac?a?o do problema tridimensional five-spot. Uma barreira de perme-\nabilidades com o valor de 0.002 mD foi criada como mostra a figura 6.18.\n\nFigura 6.18: Permeabilidades do caso tridimensional.\n\nA figura 6.19 mostra a soluc?a?o com isosuperf??cies de pressa?o e saturac?a?o\npara os instantes de tempo 22, 55, 66 e 88 anos.\n\nFigura 6.19: Permeabilidades do caso tridimensional.\n\n\n\nCap??tulo 7\n\nConcluso?es e Trabalhos Futuros\n\n7.1 Concluso?es\n\nNo OpenFOAM e? poss??vel se desenvolver aplicac?o?es para a soluc?a?o de\nproblemas complexos em um curto intervalo de tempo. O sistema dispo?e de\nmuitas ferramentas que possibilitam o reuso de co?digo. Apo?s a instalac?a?o do\nsistema em um cluster a execuc?a?o das aplicac?o?es em paralelo e? aparentemente\nsimples e nenhuma modificac?a?o e? necessa?ria na aplicac?a?o, apenas alguns ar-\nquivos de controle adicionais sa?o criados no caso. E? poss??vel a criac?a?o de\nclasses template nos namespaces fvm e fvc, podendo o usua?rio escrever seu\npro?prio esquema de gradiente ou divergente, isso tambe?m e? poss??vel para\nos esquemas de interpolac?a?o e qualquer ferramenta adicional que se queira\nimplementar.\n\nA pouca documentac?a?o dispon??vel do sistema foi a maior dificuldade en-\ncontrada. Para se aprender como sa?o feitas as aplicac?o?es e? necessa?rio que se\nestudar com o co?digo fonte das aplicac?o?es nativas do sistema. Ler o co?digo\nfonte das aplicac?o?es nativas serve como orientac?a?o para adotar as melhores\npra?ticas de programac?a?o no sistema.\n\n7.2 Trabalhos futuros\n\nAs soluc?o?es dos problemas expostos para a verificac?a?o do simulador im-\nplementado mostraram-se razoa?veis quando comparadas com o simulador\nIMEX. O simulador desenvolvido neste trabalho e? de escopo acade?mico, que\nadota uma modelagem bastante simplificada quando comparado com simula-\ndores comercias como o IMEX. Como propostas de ferramentas que podera?o\nser incorporadas a? aplicac?a?o implentada em trabalhos futuros tem-se:\n\n66\n\n\n\nCAPI?TULO 7. CONCLUSO?ES E TRABALHOS FUTUROS 67\n\n\u2022 Ca?culo do ??ndice de produtividade para poc?os inclinados com malhas\nna?o estruturadas;\n\n\u2022 Implementac?a?o de um modelo de escoamento nos poc?os;\n\n\u2022 Investigac?a?o de alternativas a? soluc?a?o da equac?a?o de saturac?a?o na forma\nhiperbo?lica;\n\n\u2022 Incorporac?a?o da ferramenta de gerac?a?o adaptativa de malhas presente\nno sistema;\n\n\u2022 Implementac?a?o do modelo black-oil.\n\n\u2022 Implementac?a?o do me?todo sequencial impl??cito e totalmente impl??cito.\n\n\u2022 Implementac?a?o do me?todo IMPES adaptativo.\n\n\u2022 Verifcac?a?o de desempenho na soluc?a?o de problemas em paralelo.\n\n\n\nRefere?ncias Bibliogra?ficas\n\n[1] Cmg web site, http://www.cmgl.ca/software/imex.htm.\n\n[2] Openfoam programers guide, http://foam.sourceforge.net/docs/\nGuides-a4/ProgrammersGuide.pdf.\n\n[3] Openfoam solvers, http://www.tfd.chalmers.se/~hani/kurser/OS_\nCFD_2008/TimBehrens/tibeh-report-fin.pdf.\n\n[4] Openfoam user\u2019s guide, http://foam.sourceforge.net/docs/\nGuides-a4/UserGuide.pdf.\n\n[5] Openfoam web site, http://www.openfoam.com/.\n\n[6] Speedit web site, http://speedit.vratis.com/.\n\n[7] I. Aavatsmark and RA Klausen, Well index in reservoir simulation for\nslanted and slightly curved wells in 3d grids, SPE Journal 8 (2003), no. 1,\n41\u201348.\n\n[8] JJ Arps, Analysis of decline curves, Transactions of the American Ins-\ntitute of Mining, Metallurgical and Petroleum Engineers 160 (1945),\n228.\n\n[9] K. Aziz and A. Settari, Petroleum reservoir simulation, vol. 476, Applied\nScience Publishers London, 1979.\n\n[10] L.R. Brown, Microbial enhanced oil recovery (meor), Current Opinion\nin Microbiology 13 (2010), no. 3, 316\u2013320.\n\n[11] H. L. Chang, Polymer flooding technology - yesterday, today, and tomor-\nrow, Journal of Petroleum Technology (1978), 1113\u20131128.\n\n[12] Z. Chen, G. Huan, and Y. Ma, Computational methods for multiphase\nflows in porous media, vol. 2, Society for Industrial Mathematics, 2006.\n\n68\n\n\n\nREFERE?NCIAS BIBLIOGRA?FICAS 69\n\n[13] Z. Chen, G. Huan, and H. Wang, Simulation of a compositional model\nfor multiphase flow in porous media, Numerical Methods for Partial\nDifferential Equations 21 (2005), no. 4, 726\u2013741.\n\n[14] Z. Chen, G. Qin, and R.E. Ewing, Analysis of a compositional model\nfor fluid flow in porous media, SIAM Journal on Applied Mathematics\n(2000), 747\u2013777.\n\n[15] R.S. da Silva, Simulac?a?o de escoamento bifa?sico ole?o-a?gua em reservato?-\nrios de petro?leo usando computadores paralelos de memo?ria distribu??da,\n2008.\n\n[16] L.P. Dake, Fundamentals of reservoir engineering, vol. 8, Elsevier Sci-\nence, 1978.\n\n[17] , The practice of reservoir engineering, vol. 36, Elsevier Science,\n2001.\n\n[18] D.K.E. de Carvalho, Uma formulac?a?o do me?todo dos volumes finitos\ncom estrutura de dados por aresta para a simulac?a?o de escoamentos em\nmeios porosos, 2005.\n\n[19] Y. Ding, A generalized 3d well model for reservoir simulation, SPE Jour-\nnal 1 (1996), no. 4, 437\u2013450.\n\n[20] T. Ertekin, J.H. Abou-Kassem, and G.R. King, Basic applied reservoir\nsimulation, Society of Petroleum Engineers, 2001.\n\n[21] J.R. Fanchi, Principles of applied reservoir simulation, Gulf Professional\nPublishing, 2005.\n\n[22] MJ Fetkovich, Decline curve analysis using type curves, Journal of Pe-\ntroleum Technology 32 (1980), no. 6, 1065\u20131077.\n\n[23] B. Hascakir and A. Kovscek, Reservoir simulation of cyclic steam injec-\ntion including the effects of temperature induced wettability alteration,\nSPE Western Regional Meeting, 2010.\n\n[24] D. Havlena and AS Odeh, The material balance as an equation of a\nstraight line, Journal of Petroleum Technology 15 (1963), no. 8, 896\u2013\n900.\n\n[25] H. Jasak, Error analysis and estimation for the finite volume method\nwith applications to fluid flows, Direct 1000 (1996), no. June.\n\n\n\nREFERE?NCIAS BIBLIOGRA?FICAS 70\n\n[26] H. Jasak, A. Jemcov, and Z. Tukovic, Openfoam: A c++ library for com-\nplex physics simulations, International Workshop on Coupled Methods\nin Numerical Dynamics, IUC, Dubrovnik, Croatia, 2007.\n\n[27] R.J. LeVeque, Finite volume methods for hyperbolic problems, vol. 31,\nCambridge Univ Pr, 2002.\n\n[28] Y.K. Li, L. Nghiem, and A. Siu, Phase behaviour computations for re-\nservoir fluids: Effect of pseudo-components on phase diagrams and si-\nmulation results, Journal of Canadian Petroleum Technology 24 (1985),\nno. 6.\n\n[29] M.V.B. Machado, Modelagem e simulac?a?o nume?rica de reservato?rios\nde petro?leo: principais aspectos envolvidos., Petrobras: Salvador, 2010.\nLivro em preparac?a?o.\n\n[30] Z. Malecha,  L. Miros law, T. Tomczak, Z. Koza, M. Matyka, W. Tar-\nnawski, and D. Szczerba, Gpu-based simulation of 3d blood flow in ab-\ndominal aorta using openfoam, Archives of Mechanics 63 (2011), no. 2,\n137\u2013161.\n\n[31] R. Mannon, Oil production forecasting by decline curve analysis, Fall\nMeeting of the Society of Petroleum Engineers of AIME, 1965.\n\n[32] P. Morelato, L. Rodrigues, and O. Romero, Effect of polymer injection\non the mobility ratio and oil recovery, SPE Heavy Oil Conference and\nExhibition, 2011.\n\n[33] N. Morrow, Capillary pressure correlations for uniformly wetted porous\nmedia, Journal of Canadian Petroleum Technology 15 (1976), no. 4.\n\n[34] D.W. Peaceman, Fundamentals of numerical reservoir simulation, vol. 6,\nElsevier, 1977.\n\n[35] , Interpretation of well-block pressures in numerical reservoir si-\nmulation (includes associated paper 6988), Old SPE Journal 18 (1978),\nno. 3, 183\u2013194.\n\n[36] A.J. Rosa, R. de Souza Carvalho, and J.A.D. Xavier, Engenharia de\nreservato?rios de petro?leo, Intercie?ncia, 2006.\n\n[37] VC Santanna, FDS Curbelo, TN Castro Dantas, AA Dantas Neto,\nHS Albuquerque, and AIC Garnica, Microemulsion flooding for enhanced\noil recovery, Journal of Petroleum Science and Engineering 66 (2009),\nno. 3-4, 117\u2013120.\n\n\n\nREFERE?NCIAS BIBLIOGRA?FICAS 71\n\n[38] E.F. Toro, Riemann solvers and numerical methods for fluid dynamics.\n1999, Springer, Berlin.\n\n[39] C. Wolfsteiner, L.J. Durlofsky, and K. Aziz, Calculation of well index for\nnonconventional wells on arbitrary grids, Computational Geosciences 7\n(2003), no. 1, 61\u201382."}]}}}