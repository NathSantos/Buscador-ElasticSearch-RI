{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.09048"}, {"@name": "filename", "#text": "13994_Andr%c3%a9%20Luis%20Reys%20de%20Mattos.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE FEDERAL FLUMINENSE CENTRO T\u00c9CNOL\u00d3GICO\nESCOLA DE ENGENHARIA DEPARTAMENTO DE ENGENHARIA QUIMICA E DE PETROLEO\nAndr\u00e9 Luis Reys de Mattos\nAplica\u00e7\u00e3o de programa\u00e7\u00e3o matem\u00e1tica na estrutura\u00e7\u00e3o e constru\u00e7\u00e3o de simulador de reservat\u00f3rios.\nAndr\u00e9 Luis Reys de Mattos\nAplica\u00e7\u00e3o de programa\u00e7\u00e3o matem\u00e1tica na estrutura\u00e7\u00e3o e constru\u00e7\u00e3o de simulador de reservat\u00f3rios.\nTrabalho de Conclus\u00e3o de Curso apresentado ao Curso de Gradua\u00e7\u00e3o em Engenharia de Petr\u00f3leo da Escola de Engenharia da Universidade Federal Fluminense, como requisito parcial para obten\u00e7\u00e3o do Grau de Bacharel em Engenharia de Petr\u00f3leo.\nOrientadores:\tArturo Rodrigo Ferreira Pardo Jo\u00e3o Felipe Mitre de Araujo\nM444 Mattos, Andr\u00e9 Luis Reys de\nAplica\u00e7\u00e3o de programa\u00e7\u00e3o matem\u00e1tica na estrutura\u00e7\u00e3o e constru\u00e7\u00e3o de simulador de reservat\u00f3rios / Andr\u00e9 Luis Reys de Mattos. - Niter\u00f3i, RJ : [s.n.], 2017.\n70 f.\nProjeto Final (Bacharelado em Engenharia de Petr\u00f3leo) -Universidade Federal Fluminense, 2017.\nOrientadores: Arturo Rodrigo Ferreira Pardo, Jo\u00e3o Felipe Mitre de Araujo.\n1. Engenharia de reservat\u00f3rio. 2. Fortran (Linguagem de programa\u00e7\u00e3o). 3. Programa\u00e7\u00e3o matem\u00e1tica. I. T\u00edtulo.\nCDD 622.3382\nAndr\u00e9 Luis Reys de Mattos\nAplica\u00e7\u00e3o de programa\u00e7\u00e3o matem\u00e1tica na estrutura\u00e7\u00e3o e constru\u00e7\u00e3o de simulador de reservat\u00f3rios.\nTrabalho de Conclus\u00e3o de Curso apresentado ao Curso de Gradua\u00e7\u00e3o em Engenharia de Petr\u00f3leo da Escola de Engenharia da Universidade Federal Fluminense, como requisito parcial para obten\u00e7\u00e3o do Grau de Bacharel em Engenharia de Petr\u00f3leo\nAprovado em Niter\u00f3i - RJ, Brasil, 13 de julho de 2017:\nArturo Rodrigo Ferreira Pardo, D. SC.\nOrientador\nJo\u00e3o Felipe Mitre de Araujo, D. SC.\nOrientador\nElson Antonio do Nascimento, D. SC.\nJo\u00e3o Cris\u00f3sthomo de Queiroz Neto, D. SC.\nNiter\u00f3i - RJ, Brasil\n2017\nA Jo\u00e3o Pedro, Cl\u00e1udia e S\u00e9rgio Mattos, a melhor fam\u00edlia que qualquer filho poderia desejar\nAgradecimentos\nOs agradecimentos principais s\u00e3o direcionados a minha fam\u00edlia, que sempre esteve ao meu lado nos momentos mais dif\u00edceis, me encorajando e n\u00e3o me deixando ser levado por pensamentos ruins, a Julia Rocha, por todos os momentos de desespero nos quais me acolheu e me trouxe uma luz e a todos os meus amigos companheiros de jornada, dentre os quais se destacam Melissa, Mayara, Allicia, Pedro e Arnaldo.\nAgradecimentos especiais s\u00e3o direcionados a todo o Departamento de Engenharia de Petr\u00f3leo da Universidade Federal Fluminense, assim como o Petroleum Engineering Department da Montana Tech of The University of Montana, cuja maior contribui\u00e7\u00e3o foi o conhecimento e inspira\u00e7\u00e3o necess\u00e1rios para a realiza\u00e7\u00e3o deste.\nAgrade\u00e7o ainda a meus orientadores, Dr. Arturo Rodrigo Ferreira Pardo e Dr., por todo o suporte e orienta\u00e7\u00e3o sem os quais o presente trabalho n\u00e3o passariam de notas perdidas em um caderno.\n\"Trabalhe at\u00e9 que n\u00e3o precise mais se apresentar.\" Autor Desconhecido\nResumo\nEste trabalho visa o desenvolvimento e constru\u00e7\u00e3o de um simulador de reservat\u00f3rios Black-Oil, totalmente a partir de c\u00f3digos abertos ao p\u00fablico e de livre utiliza\u00e7\u00e3o. Primeiro faz-se um breve resumo de Engenharia de Reservat\u00f3rios, passando pelos t\u00f3picos mais relevantes. Uma vez conclu\u00eddo, segue para desenvolvimento da equa\u00e7\u00e3o da continuidade, adaptando-a a meios porosos e discretizando-a entre coordenadas espaciais e temporais. Ao final, \u00e9 realizada a constru\u00e7\u00e3o de uma subrotina em FORTRAN, capaz de executar estes c\u00e1lculos em repeti\u00e7\u00e3o e chegar a um resultado efetivo.\nPalavras-chaves: Simula\u00e7\u00e3o de Reservat\u00f3rios. FORTRAN. Continuidade. Engenharia de Reservat\u00f3rios.\nAbstract\nThis study aims to deduce and develop a Black Oil Reservoir Simulator, directly from opensource codes. It begins with a short recapitulation of Reservoir Engineering, from the main definitions to the most relevant topics. Once concluded, the next step is the development of the continuity equation, discretizing it between spacial end time coordinates. Finnaly, a FORTRAN subroutine capable of apply the model in loops and achieve an effective result is written .\nKey-words: Reservoir Simulation. FORTRAN. Continuity Equation. Reservoir Engineering.\nLista de ilustra\u00e7\u00f5es\nFigura 2.6 - Fluxo m\u00e1ssico entre um bloco e seu entorno......................... 26\nFigura 3.7 - Organiza\u00e7\u00e3o dos blocos no modelo estudado.......................... 31\nFigura 4.8 - Modelo de output contendo informa\u00e7\u00f5es de cada bloco\tdo reservat\u00f3rio\t...\t39\nFigura 4.9 - Modelo de output contendo informa\u00e7\u00f5es do reservat\u00f3rio\tcomo um todo\t...\t39\nFigura 4.10-Interpreta\u00e7\u00e3o das informa\u00e7\u00f5es extra\u00eddas do programa. Press\u00e3o de \u00f3leo. ...\t40\nFigura 4.11-Interpreta\u00e7\u00e3o das informa\u00e7\u00f5es extra\u00eddas do programa. Satura\u00e7\u00e3o de \u00f3leo. . .\t41\nFigura 4.12-Interpreta\u00e7\u00e3o das informa\u00e7\u00f5es extra\u00eddas do programa. Press\u00e3o de \u00f3leo. Reservat\u00f3rio convencional................................................................. 42\nFigura 4.13-Interpreta\u00e7\u00e3o das informa\u00e7\u00f5es extra\u00eddas do programa. Satura\u00e7\u00e3o de \u00f3leo. Reservat\u00f3rio convencional............................................................ 43\nFigura 4.14-Interpreta\u00e7\u00e3o das informa\u00e7\u00f5es extra\u00eddas do programa. Press\u00e3o de \u00f3leo. Reservat\u00f3rio com aus\u00eancia de capa de g\u00e1s.................................................. 44\nFigura 4.15-Interpreta\u00e7\u00e3o das informa\u00e7\u00f5es extra\u00eddas do programa. Satura\u00e7\u00e3o de \u00f3leo. Reservat\u00f3rio com aus\u00eancia de capa de g\u00e1s............................................. 45\nFigura 4.16-Interpreta\u00e7\u00e3o das informa\u00e7\u00f5es extra\u00eddas do programa. Press\u00e3o de \u00f3leo. Reservat\u00f3rio com quantidade reduzida de \u00e1gua de forma\u00e7\u00e3o.................................. 46\nFigura 4.17-Interpreta\u00e7\u00e3o das informa\u00e7\u00f5es extra\u00eddas do programa. Satura\u00e7\u00e3o de \u00f3leo.\nReservat\u00f3rio com quantidade reduzida de \u00e1gua de forma\u00e7\u00e3o. ............... 47\nSum\u00e1rio\n1\tINTRODU\u00c7\u00c3O ........................................... 11\nIntrodu\u00e7\u00e3o..................................................... 11\n1.1\tObjetivo.............................................. 11\n2\tCONCEITOS B\u00c1SICOS DE ENGENHARIA DE RESERVAT\u00d3RIOS .\t12\n2.1\tPropriedades da Rocha Reservat\u00f3rio ................... 12\n2.2\tPropriedades dos Fluidos de Reservat\u00f3rio.............. 13\n2.3\tIntera\u00e7\u00f5es Fluido-Rocha e Fluido-Fluido .............. 20\n2.4\tComportamento dos Fluidos no Reservat\u00f3rio............. 23\n3\tDESENVOLVIMENTO TE\u00d3RICO............................... 28\n3.1\tEqua\u00e7\u00f5es de Fluxo..................................... 28\n3.2\tInflu\u00eancia da Press\u00e3o Capilar......................... 29\n3.3\tDiscretizando as Equa\u00e7\u00f5es............................. 31\n3.4\tRepresenta\u00e7\u00e3o dos Po\u00e7os............................... 34\n4\tFUNCIONAMENTO DO SIMULADOR............................ 36\n4.1\tA Linguagem FORTRAN................................... 36\n4.2\tMecanismo de Resolu\u00e7\u00e3o................................ 37\n4.3\tFuncionamento B\u00e1sico do Programa...................... 37\n4.4\tEstudos de Caso....................................... 42\n4.4.1\tCaso 1 - Reservat\u00f3rio convencional.................... 42\n4.4.2\tCaso 2 - Reservat\u00f3rio com aus\u00eancia de capa de g\u00e1s..... 44\n4.4.3\tCaso 3 - Reservat\u00f3rio com quantidade reduzida de \u00e1gua de forma\u00e7\u00e3o 44\n5\tCONCLUS\u00c3O E SUGEST\u00d5ES PARA TRABALHOS FUTUROS ...\t48\nREFER\u00caNCIAS........................................... 49\nAP\u00caNDICES\t50\nAP\u00caNDICE A - C\u00d3DIGO DESENVOLVIDO...................... 51\nAP\u00caNDICE B - INPUT UTILIZADO\tNOS ESTUDOS DE CASO . .\t69\n1\tIntrodu\u00e7\u00e3o\nCom o advento da revolu\u00e7\u00e3o digital, a simula\u00e7\u00e3o de reservat\u00f3rio vem continuamente ganhando espa\u00e7o no mercado de \u00f3leo e g\u00e1s. Simular n\u00e3o \u00e9 mais uma quest\u00e3o de previs\u00e3o, mas cada vez mais uma quest\u00e3o de estrat\u00e9gia. Novas descobertas de reservat\u00f3rios podem envolver condi\u00e7\u00f5es cada vez pior de escoabilidade, com permeabilidades baixas, grandes falhamentos, produ\u00e7\u00f5es exageradas de \u00e1gua, entre outros. Um m\u00e9todo de simula\u00e7\u00e3o corretamente efetuado pode (e geralmente consegue) propiciar estrat\u00e9gias de desenvolvimento respeitando cada vez mais limites econ\u00f4micos e ambientais.\nGra\u00e7as a essa import\u00e2ncia, empresas v\u00eam desenvolvendo dia a dia softwares cada vez mais potentes e eficientes, chegando em quest\u00e3o de minutos a resultados que, sem o uso da tecnologia, nunca seriam alcan\u00e7ados. Por quest\u00f5es comerciais, entretanto, esses softwares s\u00e3o inviol\u00e1veis, atuando como caixas obscuras de processamento, onde entram os dados, saem os resultados.\n1.1\tObjetivo\nEste estudo tem o intuito de retornar \u00e0s origens e deduzir, a partir das defini\u00e7\u00f5es mais b\u00e1sicas, equa\u00e7\u00f5es funcionais para o desenho de um simulador de reservat\u00f3rios eficiente e de c\u00f3digo aberto. O programa desenvolvido ter\u00e1 uma estrutura modular, permitindo sua f\u00e1cil adapta\u00e7\u00e3o \u00e0s mais diversas situa\u00e7\u00f5es e assim criando um ambiente um pouco mais amig\u00e1vel para aqueles que queiram entender o funcionamento de suas vers\u00f5es comerciais.\nAntes do desenvolvimento, entretanto, \u00e9 necess\u00e1rio uma breve revis\u00e3o de conceitos b\u00e1sicos da engenharia de reservat\u00f3rios, como propriedades das rochas, propriedades dos fluidos, intera\u00e7\u00f5es entre o fluido e a rocha e seu comportamento em um reservat\u00f3rio. Ap\u00f3s, ser\u00e1 realizado um desenvolvimento intensivo de equa\u00e7\u00f5es de fluxo, levando em conta aspectos como posicionamento espacial e temporal, condi\u00e7\u00f5es de contorno e assun\u00e7\u00f5es.\n2\tConceitos B\u00e1sicos de Engenharia de Reservat\u00f3rios\nComo o pr\u00f3prio nome prop\u00f5e, a Simula\u00e7\u00e3o de Reservat\u00f3rios \u00e9 um estudo da como se comporta um reservat\u00f3rio sujeito \u00e0s varias altera\u00e7\u00f5es que podem ser feitas pelo homem ou pela natureza ao longo de sua vida. Uma vez que este trabalho se dedica principalmente a simula\u00e7\u00f5es onde n\u00e3o h\u00e1 rea\u00e7\u00e3o qu\u00edmica, n\u00e3o h\u00e1 troca de energia entre as diferentes fases e todas as propriedades s\u00e3o cont\u00ednuas e descrit\u00edveis, o estudo se restringir\u00e1 apenas aos conceitos essenciais para o desenvolvimento de uma solu\u00e7\u00e3o.\n2.1\tPropriedades da Rocha Reservat\u00f3rio\nPorosidade\nPrincipalmente utilizada na medi\u00e7\u00e3o do volume de fluido no reservat\u00f3rio, a porosidade \u00e9 uma das mais importantes propriedades a serem estudadas. Segundo Rosa (2006), a porosidade \u00e9 definida como sendo a rela\u00e7\u00e3o entre o volume de vazios de uma rocha e o volume total da mesma, ou seja:\n(2.1)\nOnde:\nrepresenta a porosidade\nVv representa o volume de vazios\nV representa o volume total\nPermeabilidade\nEnquanto a porosidade mede a capacidade de armazenamento da rocha, outra informa\u00e7\u00e3o de vital import\u00e2ncia \u00e9 a Permeabilidade. An\u00e1loga ao inverso da resist\u00eancia de um circuito el\u00e9trico, Rosa (2006) define permeabilidade como uma medida da capacidade de um meio poroso de se deixar atravessar por fluidos. Os estudos mais conclusivos sobre permeabilidade foram feitos por Henry Darcy em 1856 e ser\u00e3o abordados na se\u00e7\u00e3o 2.4.\n2.2\tPropriedades dos Fluidos de Reservat\u00f3rio\nTipos de fluidos\nFluidos em geral podem ser considerados como incompress\u00edveis, compress\u00edveis e levemente compress\u00edveis, a depender em como se comportam com o variar da press\u00e3o. Um fluido incompress\u00edvel, como sugerido pelo nome, n\u00e3o sofre altera\u00e7\u00f5es com o variar da press\u00e3o, mantendo sempre o mesmo volume. Fluidos compress\u00edveis, por sua vez, sofrem altas varia\u00e7\u00f5es de volume, como demonstrado na Figura (2.1) (ERTEKIN, 2001).\nGeralmente, a \u00e1gua \u00e9 considerada como incompress\u00edvel, o g\u00e1s como compress\u00edvel e o \u00f3leo negro1 como levemente compress\u00edvel. Existe ainda o \u00f3leo com g\u00e1s em solu\u00e7\u00e3o (\u00f3leo cru ou \u00f3leo vivo), cujo comportamento \u00e9 distinto devido a solubiliza\u00e7\u00e3o do g\u00e1s com o aumentar da press\u00e3o.\nPress\u00e3o de bolha\nSegundo Ahmed (2010), a press\u00e3o de bolha de um sistema de hidrocarbonetos \u00e9 definida como a mais alta press\u00e3o na qual uma bolha de g\u00e1s \u00e9 liberada do \u00f3leo. Essa importante propriedade pode ser medida experimentalmente atrav\u00e9s de um teste PVT flash ou estimada com o uso de correla\u00e7\u00f5es. Neste trabalho ser\u00e1 considerada como um valor conhecido do sistema.\nCompressibilidade isot\u00e9rmica\nDe acordo com Ertekin (2001), a compressibilidade isot\u00e9rmica de um fluido \u00e9 definida como a mudan\u00e7a volum\u00e9trica relativa de uma determinada massa sujeita a uma altera\u00e7\u00e3o de press\u00e3o em condi\u00e7\u00f5es de temperatura constante. A compressibilidade pode, matematicamente, ser definida como:\nCi =\n1 dVi V dp\n(2.2)\nEm termos de massa espec\u00edfica, sabendo que p = m, a express\u00e3o resultante ent\u00e3o \u00e9:\nCi =\n1 dp pdp T\n(2.3)\nFator z de compressibilidade do g\u00e1s\nG\u00e1s ideal\nSegundo Rosa (2006), um g\u00e1s ideal \u00e9 um fluido hipot\u00e9tico que obedece a 3 condi\u00e7\u00f5es espec\u00edficas:\n-\tO volume ocupado pelas mol\u00e9culas \u00e9 insignificante se comparado ao volume total do fluido.\n-\tN\u00e3o existem quaisquer for\u00e7as intermoleculares atrativas ou repulsivas, seja com o pr\u00f3prio fluido, seja com as paredes do recipiente.\n-\tAs colis\u00f5es entre as mol\u00e9culas s\u00e3o perfeitamente el\u00e1sticas.\nUma vez seguidas essas condi\u00e7\u00f5es, o g\u00e1s pode ser considerado ideal e seu comportamento pode ser previsto, em unidades absolutas, pela Equa\u00e7\u00e3o (2.4), tamb\u00e9m conhecida como Equa\u00e7\u00e3o de Estado ou Lei dos Gases Ideais.\nG\u00e1s real\nAinda que a grande maioria dos gases n\u00e3o siga as condi\u00e7\u00f5es espec\u00edficas dos gases ideais, quando em baixa temperatura e baixa press\u00e3o s\u00e3o fi\u00e9is a essa rela\u00e7\u00e3o. Para os que n\u00e3o seguem esse modelo, existe um fator de corre\u00e7\u00e3o chamado fator z de compressibilidade do g\u00e1s ou, em ingl\u00eas, z-factor. A equa\u00e7\u00e3o (2.5) mostra a inser\u00e7\u00e3o deste fator.\nPV = znRT\n(2.5)\nDependente de vari\u00e1veis como temperatura e press\u00e3o, associadas a propriedades da subst\u00e2ncia, como temperatura e press\u00e3o cr\u00edticas, esse fator tem comportamento an\u00f4malo. Apesar da exist\u00eancia de correla\u00e7\u00f5es bem precisas, como Peng-Robinson, at\u00e9 hoje, o m\u00e9todo do Gr\u00e1fico de Standing-Katz (Figura 2.2) \u00e9 ainda muito utilizado.\nRaz\u00e3o g\u00e1s-\u00f3leo\nTamb\u00e9m conhecida como Raz\u00e3o de Solubilidade do G\u00e1s, a Raz\u00e3o g\u00e1s-\u00f3leo (Rs) ou Gas-Oil Ratio (GOR) representa a quantidade de g\u00e1s que se desprende do \u00f3leo no caminho do mesmo entre o reservat\u00f3rio e a superf\u00edcie (MCCAIN, 1990). Essa raz\u00e3o ent\u00e3o \u00e9 definida em termos das quantidades de g\u00e1s e \u00f3leo que surgem durante a produ\u00e7\u00e3o.\nRs\nvolume de g\u00e1s produzido sob condi\u00e7\u00f5es padr\u00e3o volume de \u00f3leo produzido sob condi\u00e7\u00f5es padr\u00e3o\n(2.6)\nNa aus\u00eancia de dados de laborat\u00f3rio, Terry e Rogers (2014) sugerem a utiliza\u00e7\u00e3o de correla\u00e7\u00f5es. Standing, em seus estudos, concluiu que poderia estimar a Raz\u00e3o g\u00e1s-\u00f3leo a partir da temperatura e da press\u00e3o do reservat\u00f3rio, juntamente a gravidade espec\u00edfica do g\u00e1s e da gradua\u00e7\u00e3o API do \u00f3leo. Beggs apresenta a correla\u00e7\u00e3o de Standing em formato de equa\u00e7\u00e3o e v\u00e1lida para press\u00f5es abaixo da press\u00e3o de bolha como (BRADLEY, 1987):\np\t1.204\ns 18 * 10 )\n(2.7)\nOnde:\nya = 0.00091T - 0.125pAPi\nFator volume-forma\u00e7\u00e3o\nCompressibility factor\nCompressibility foctor\nFigura 2.2 - Gr\u00e1fico de Standing-Katz\nFonte: Katz (1959)\nocupa em condi\u00e7\u00f5es padr\u00e3o. Portanto, para uma fase gen\u00e9rica n pode-se escrever a equa\u00e7\u00e3o (2.8)\nBn\nVn\nV0.n\n(2.8)\nFator volume-forma\u00e7\u00e3o de g\u00e1s\nSubstituindo a equa\u00e7\u00e3o (2.5) na equa\u00e7\u00e3o (2.8) e assumindo que, para condi\u00e7\u00f5es padr\u00e3o, z = 1 pode-se ent\u00e3o escrever a equa\u00e7\u00e3o (2.9).\nBg\nPoZT\nT0P\n(2.9)\nFator volume-forma\u00e7\u00e3o de \u00f3leo\nComo visto na se\u00e7\u00e3o Raz\u00e3o g\u00e1s-\u00f3leo, at\u00e9 atingir o ponto de bolha, o g\u00e1s se dissolve no \u00f3leo. Essa dissolu\u00e7\u00e3o faz com que o \u00f3leo, entre a press\u00e3o padr\u00e3o e o ponto de bolha, aumente de volume com o aumentar da press\u00e3o. Acima da press\u00e3o de bolha, o aumento da press\u00e3o faz com que o \u00f3leo e o g\u00e1s nele dissolvido se comprimam, uma vez que n\u00e3o h\u00e1 mais dissolu\u00e7\u00e3o. Como podemos notar na figura (2.3), entre a press\u00e3o de bolha e a press\u00e3o inicial, o Bo possui comportamento linear.\nFigura 2.3 - Fator Volume-Forma\u00e7\u00e3o vs Press\u00e3o\nFonte: Rosa (2006)\nViscosidade\nSegundo Ertekin (2001), viscosidade de um fluido \u00e9 a medida da facilidade de um fluido de escoar como resultado de um gradiente de press\u00e3o aplicado. Para fluidos com g\u00e1s dilu\u00eddo, as mol\u00e9culas se encontram afastadas e n\u00e3o oferecem muita resist\u00eancia. Em contraste, um fluido mais denso oferece uma alta resist\u00eancia ao escoamento. A viscosidade \u00e9 geralmente estimada em fun\u00e7\u00e3o de temperatura e press\u00e3o. Neste estudo por\u00e9m, ser\u00e3o desconsideradas quaisquer influ\u00eancias de varia\u00e7\u00e3o de temperatura, visto que o modelo utilizado somente \u00e9 v\u00e1lido para processos isot\u00e9rmicos.\nViscosidade de um \u00f3leo\nEm casos onde n\u00e3o \u00e9 poss\u00edvel a an\u00e1lise laboratorial, existem in\u00fameras maneiras para estimar a viscosidade de um \u00f3leo. Um dos m\u00e9todos mais utilizados \u00e9 :\nPasso 1 - Estimar a viscosidade do \u00f3leo morto atrav\u00e9s da correla\u00e7\u00e3o de Beggs-Robinson.\n^od = I0A /\t|6\u00b0'\t- 1.0\t(2.10)\nOnde:\nA = 103.0324-0.202023API\nPasso 2 - Estimar a viscosidade para press\u00f5es menores que a press\u00e3o de bolha atrav\u00e9s da correla\u00e7\u00e3o de Beggs-Robinson.\n^ob\ta(^od)\t(2.11)\nOnde:\na = 10.715(Rs + 100)-0.515\nb = 5.44(Rs + 150)-0.338\nPasso 3 - Corrigir a viscosidade do \u00f3leo para press\u00f5es maiores que a press\u00e3o de bolha atrav\u00e9s da correla\u00e7\u00e3o de Khan.\n^o = ^ob exp [9.6 x 10-6(P - Pb)]\t(2.12)\nTemos ent\u00e3o, para o \u00f3leo, comportamento an\u00e1logo ao representado na Figura 2.4\nFigura 2.4 - Viscosidade e Raz\u00e3o G\u00e1s-\u00f3leo vs Press\u00e3o\nFonte: Rosa (2006)\nViscosidade de um g\u00e1s\nAssim como para estimar a viscosidade do \u00f3leo, existem in\u00fameras maneiras de se estimar a viscosidade de um g\u00e1s. Um dos m\u00e9todos mais utilizados, gra\u00e7as a sua simplicidade, \u00e9 o m\u00e9todo de Lee-Gonzales-Eakin.\nEm seus estudos, Lee et al. apresentou uma rela\u00e7\u00e3o semi-emp\u00edrica para a viscosidade de gases naturais, propondo a seguinte equa\u00e7\u00e3o (AHMED, 2016):\n= 10 4K exp\nX\n(2.13)\nOnde:\n(9.4+0.02Ma)T 1-B\n209+19Ma+T\nX = 3.5 +\t+ 0.01M\nY = 2A- X\n2.3\tIntera\u00e7\u00f5es Fluido-Rocha e Fluido-Fluido\nAl\u00e9m dos fen\u00f4menos comportamentais intr\u00ednsecos dos fluidos e das rochas, devemos tamb\u00e9m estudar como estes se relacionam entre si. Fatores como satura\u00e7\u00e3o, press\u00e3o capilar, permeabilidade relativa entre outros, podem n\u00e3o aparentar, mas possuem um papel decisivo na precis\u00e3o de uma simula\u00e7\u00e3o.\nSatura\u00e7\u00e3o\nUm dos fatores determinantes do comportamento de um certo fluido na presen\u00e7a de outras fazes \u00e9 a satura\u00e7\u00e3o. De acordo com Ertekin (2001), satura\u00e7\u00e3o de um determinado fluido representa a fra\u00e7\u00e3o do poro ocupada pelo mesmo. Por representar uma fra\u00e7\u00e3o do fluido, geralmente a satura\u00e7\u00e3o \u00e9 representada como um valor entre 0 e 1, onde 0 representa a aus\u00eancia do fluido em quest\u00e3o e 1 a total ocupa\u00e7\u00e3o do poro pelo mesmo. Tamb\u00e9m pode se considerar que em um sistema, a soma da satura\u00e7\u00e3o de todas as fases se igualar\u00e1 a 1. Tem-se ent\u00e3o, para n fases:\nn\nSi = 1\t(2.14)\ni=1\nConclui-se ent\u00e3o que, para um sistema g\u00e1s-\u00f3leo:\nSg + So =1\t(2.15)\nPara um sistema \u00e1gua \u00f3leo:\nSo + Sw = 1\t(2.16)\nFinalmente, para um sistema trif\u00e1sico:\nSo + Sg + Sw = 1\t(2.17)\nPress\u00e3o Capilar\nQuando duas ou mais fases imisc\u00edveis s\u00e3o colocadas em um recipiente, em estado est\u00e1tico, as fases mais pesadas tendem a se concentrar no fundo da mistura, assim como as mais leves no topo, se formando assim uma superf\u00edcie de separa\u00e7\u00e3o entre as fases. Segundo Rosa (2006), em meios porosos, por\u00e9m, n\u00e3o ocorre a forma\u00e7\u00e3o desta superf\u00edcie, mas sim de uma zona de transi\u00e7\u00e3o devido aos fen\u00f4menos capilares.\ndos fen\u00f4menos capilares ou, principalmente, a tens\u00e3o superficial, gerando um diferencial de press\u00e3o entre fases submetidas \u00e0s mesmas condi\u00e7\u00f5es externas. Numericamente pode ser definida como a diferen\u00e7a de press\u00e3o entre a fase n\u00e3o-molhante e a fase molhante, como demonstrado nas equa\u00e7\u00f5es 2.18 e 2.19. A figura 2.5 exemplifica o comportamento da press\u00e3o capilar com o variar das satura\u00e7\u00f5es de \u00f3leo e \u00e1gua.\nP\ncow\n(2.18)\nPara rocha preferencialmente molh\u00e1vel pela \u00e1gua, e\ncgo\n(2.19)\nPara sistema \u00f3leo-g\u00e1s.\nFigura 2.5 - Press\u00e3o Capilar vs Satura\u00e7\u00e3o\nFonte: Ertekin (2001)\nPermeabilidade Relativa\nOriginalmente a lei de Darcy foi derivada para fluxo monof\u00e1sico, onde a permeabilidade do meio poroso representa a permeabilidade absoluta do meio. Quando dois ou mais fluidos fluem simultaneamente, a lei de Darcy pode ser modificada atrav\u00e9s da inser\u00e7\u00e3o do termo de permeabilidade relativa. Definido como a raz\u00e3o entre permeabilidade do sistema a um determinado fluido pela permeabilidade absoluta do meio, a permeabilidade relativa possui dimens\u00e3o nula e \u00e9 fun\u00e7\u00e3o do meio e dos fluidos envolvidos e suas respectivas satura\u00e7\u00f5es (ERTEKIN, 2001).\nk\nrx\nkx ~k\n(2.20)\nModelo de Corey\nO modelo bif\u00e1sico de Corey \u00e9 um modelo v\u00e1lido principalmente para o processo de drenagem em rochas consolidadas. O modelo baseia-se principalmente numa normaliza\u00e7\u00e3o da satura\u00e7\u00e3o da fase molhante.\nS\nwn\nSw \u2014 Siw\n1 \u2014 Sw\n(2.21)\nA permeabilidade relativa da fase molhante \u00e9, ent\u00e3o:\nk\nrw\nS4\nSwn\n(2.22)\nE, para a fase n\u00e3o-molhante:\nk \u2014\nrnw\n(1 \u2014 Swn)2(1 \u2014 Swn)\n(2.23)\nModelo trif\u00e1sico de Naar, Henderson e Wygal\nJ\u00e1 no modelo trif\u00e1sico de Naar, Henderson e Wygal, as permeabilidades relativas de cada fase individual do reservat\u00f3rio s\u00e3o expressas por:\nk\nrw\nSw \u2014 Siw\n1 \u2014 Siw\n(2.24)\nk\nro\nSo3(1 \u2014 Sg + 2Sw \u2014 3Siw) (1 \u2014 Siw)4\n(2.25)\nk\nrg\nSg3(2 \u2014 Sg \u2014 2Siw) (1 \u2014 Siw)4\n(1 \u2014 Siw)4\n(2.26)\nEste modelo, por\u00e9m, n\u00e3o incorpora Sor e Sgc e, para que o modelo funcione adequadamente, devem ser impostas duas condi\u00e7\u00f5es para as previs\u00f5es do modelo:\nkro = 0\t(2.27)\nPara So\tSor, e\nkrg = 0\t(2.28)\nPara Sg\tSgc.\n2.4\tComportamento dos Fluidos no Reservat\u00f3rio\nPotencial de fluido\nUma informa\u00e7\u00e3o frequentemente obtida em estudos de mec\u00e2nica dos fluidos \u00e9 a carga. Quando em unidades usuais de engenharia, essa carga frequentemente se apresenta em m.c.a (metros de coluna de \u00e1gua), podendo ser interpretada como a coluna de \u00e1gua necess\u00e1ria para atingir o mesmo n\u00edvel de potencial de um certo ponto em estudo. Para fluidos incompress\u00edveis, pode ser matematicamente representada por:\nhf = - + z\t(2.29)\nf Y\nOnde:\n-\tz representa a altura em rela\u00e7\u00e3o a uma origem determinada arbitrariamente.\n-\tp representa a press\u00e3o no ponto em estudo\n-\tY = Ycpg sendo yc um fator de convers\u00e3o de gravidade, p a massa espec\u00edfica do fluido\nem estudo e g a constante de gravidade local.\nMultiplicando-se os dois lados da equa\u00e7\u00e3o (2.29) por y, \u00e9 poss\u00edvel obter:\nYhf = p + pz\t(2.30)\nNota-se, por an\u00e1lise dimensional, que o termo Yhf possui ent\u00e3o dimens\u00e3o semelhante a press\u00e3o e pode ser representado pela letra grega $, tendo ent\u00e3o:\n$ = p + pz\t(2.31)\nD relativo a Profundidade Vertical Real - TVD. Colocando-se como referencial comum o Kelly Bushing (KB) e levando-se em conta a diferen\u00e7a de sentido, assume-se:\nD = -z\t(2.32)\nE, portanto, a a equa\u00e7\u00e3o (2.31) torna-se:\n$ = p - yD\t(2.33)\nLei de Darcy\nEngenheiro respons\u00e1vel pelo sistema de distribui\u00e7\u00e3o de \u00e1guas de Dijon, na Fran\u00e7a, Henry Darcy designou uma das equa\u00e7\u00f5es mais utilizadas para o estudo do fluxo de fluidos em meios porosos. Em 1856, ao estudar problemas de tratamento de \u00e1gua atrav\u00e9s de filtros de areia, Darcy concluiu que \"a vaz\u00e3o atrav\u00e9s de um meio poroso \u00e9 proporcional \u00e0 \u00e1rea aberta ao fluxo e ao diferencial de press\u00e3o, e inversamente proporcional ao comprimento e \u00e0 viscosidade.\"A fim de adequar e generalizar a equa\u00e7\u00e3o, Darcy inseriu uma constante de proporcionalidade k que, ap\u00f3s v\u00e1rios experimentos, concluiu ser fun\u00e7\u00e3o apenas do meio poroso e batizou esta constante como permeabilidade absoluta do meio. A equa\u00e7\u00e3o obtida pr Darcy foi:\nP, - P2\nq = kA 1 - 2\t(2.34)\npL\nA equa\u00e7\u00e3o de Darcy, em seu formato original, foi formulada sobre algumas condi\u00e7\u00f5es como:\n\u2022\tEstado estacion\u00e1rio,\n\u2022\tFluxo isot\u00e9rmico,\n\u2022\tPropriedades constantes do fluido e do meio em todo o trecho em estudo,\n\u2022\tN\u00e3o h\u00e1 intera\u00e7\u00e3o entre o fluido e o meio e\n\u2022\tFluxo laminar.\nEssas condi\u00e7\u00f5es, por\u00e9m, podem ser facilmente sobrepostas com a integra\u00e7\u00e3o de outras fun\u00e7\u00f5es ou equa\u00e7\u00f5es.\nEstado estacion\u00e1rio e transiente\ne at\u00e9 dias para que esta onda seja sentida pelas \u00e1reas lim\u00edtrofes do reservat\u00f3rio. Este fen\u00f4meno ocorre gra\u00e7as a compressibilidade existente nos componentes do reservat\u00f3rio\nDe acordo com Ertekin (2001), para um fluido incompress\u00edvel, a resposta \u00e0 perturba\u00e7\u00e3o seria imediatamente sentida na borda, supondo que a rocha reservat\u00f3rio \u00e9 tamb\u00e9m incompress\u00edvel ou, matematicamente:\nP = f (P)\n(2.35)\nPara Cf = 0 ou p constante, e\nE, consequentemente,\nEm termos de velocidade:\nProblemas de fluxo envolvendo fluidos incompress\u00edveis e meios porosos possuem solu\u00e7\u00f5es independentes do tempo, uma vez que todos os derivativos em rela\u00e7\u00e3o ao tempo s\u00e3o nulos, dependendo apenas da posi\u00e7\u00e3o s. Tal comportamento \u00e9 chamado de estado estacion\u00e1rio.\nPara fluidos levemente compress\u00edveis e compress\u00edveis, a perturba\u00e7\u00e3o \u00e9 amortecida inicialmente pela compressibilidade do fluido, at\u00e9 que o fluido n\u00e3o consiga mais armazenar esta energia. A energia remanescente \u00e9 ent\u00e3o transferida para o pr\u00f3ximo ponto no espa\u00e7o e assim por diante. A energia armazenada ser\u00e1 posteriormente transferida de um ponto para o outro. Ap\u00f3s um certo tempo, a perturba\u00e7\u00e3o ser\u00e1 transferida at\u00e9 as regi\u00f5es lim\u00edtrofes e ser\u00e1 ent\u00e3o percebida em qualquer ponto de observa\u00e7\u00e3o. Pode-se ent\u00e3o dizer que h\u00e1 no meio poroso um comportamento em fun\u00e7\u00e3o do tempo, ou estado transiente. Para este caso ter\u00edamos:\nP = f (P)\nPara Cf > 0 e\nta-\n(2.39)\n(2.40)\nE, consequentemente,\n(\u00ed). =0\n(2.41)\nEm termos de velocidade:\ndu\nd)\n(2.42)\n= 0\nEqua\u00e7\u00e3o da continuidade\nSegundo Welty et al. (2007), a equa\u00e7\u00e3o da continuidade \u00e9 uma forma diferencial da lei da conserva\u00e7\u00e3o de massa. Por se tratar de uma forma diferencial, deve-se ent\u00e3o partir da considera\u00e7\u00e3o de um volume de controle de dimens\u00f5es Ax, Ay e Az. Considerar ent\u00e3o a todo o fluxo m\u00e1ssico presente entre este bloco e seu entorno, como mostrado na figura 2.6.\nFigura 2.6 - Fluxo m\u00e1ssico entre um bloco e seu entorno.\nFonte: Welty et al. (2007)\nA express\u00e3o para a conserva\u00e7\u00e3o de massa do volume de controle \u00e9 ent\u00e3o:\nd\np (v n) dA + \u2014\npdV = 0\n(2.43)\nQue pode ser interpretado como:\nFluxo de massa para | \u00ed Taxa de acumula\u00e7\u00e3o |\ndentro ou para fora > + &lt;de massa no interior > = 0 do volume de controle\tdo volume de controle\n(2.44)\nO fluxo m\u00e1ssico p (v- n) em cada face do volume de controle est\u00e1 representado na figura 2.6. A massa contida dentro do volume de controle pode ser representada por pAxAyAz e, portanto, a mudan\u00e7a de massa dentro do volume de controle \u00e9\nd\n(rhoAxAyAz)\n(2.45)\nA densidade, por\u00e9m, pode variar ponto a ponto, ou seja, p = p(x, y, z, t). Sendo assim, o fluxo m\u00e1ssico pelas faces do volume de controle pode ser representado, respectivamente para as dire\u00e7\u00f5es x, y e z por:\n(pvx |x+Ax\tpvx |x) dz/A'-\n(2.46)\n(pvy |y+Ay pvy |y) AxAz\t(2.47)\n(pvz |z+Az - pvz ) AxAy\t(2.48)\nSubstituindo as equa\u00e7\u00f5es 2.45 at\u00e9 2.48 na equa\u00e7\u00e3o 2.43, temos:\n(pvx|x+Ax - pvx|x) AyAz + (pvy |y+Ay - pVy |y) AxAz\nd\n+ (pVz|z+Az - pVz) AxAy + \u2014 (rhoAxAyAz) = 0 (2.49)\nUma vez que, nos estudos em geral, o volume n\u00e3o se altera como tempo, torna-se poss\u00edvel dividir a equa\u00e7\u00e3o por AxAyAz. No limite, com Ax,Ay e Az tendendo a um valor infinitesimal, obt\u00e9m-se a forma extensa da equa\u00e7\u00e3o da continuidade:\nd\td\td dp\ndxpvx + dypvy + \u00f5~zpvz + dt\n= 0\n(2.50)\nAplicando a fun\u00e7\u00e3o matem\u00e1tica divergente, \u00e9 poss\u00edvel obter a forma compacta da equa\u00e7\u00e3o da continuidade:\n_\tdp\nV p\u201e + -d = 0\n(2.51)\n3\tDesenvolvimento Te\u00f3rico\n3.1\tEqua\u00e7\u00f5es de Fluxo\nSeguindo o m\u00e9todo proposto por Koederitz (2005), \u00e9 poss\u00edvel, baseando-se na equa\u00e7\u00e3o da continuidade, escrever uma express\u00e3o geral para o balan\u00e7o de massa de um problema de fluxo como\n{fluxo de entrada} \u2014 {fluxo de sa\u00edda} \u2014 {produ\u00e7\u00e3o} = {ac\u00famulo}.\t(3.1)\nOnde:\n{fluxo de entrada} = Qx + Qy + Qz\n{fluxo de sa\u00edda} = {fluxo de entrada} + Ax\ndQx dx\n+ Ay\ndQy\n9y\n+ Az\ndQz dz\n(3.2)\n(3.3)\nComo citado na se\u00e7\u00e3o 2.4, a equa\u00e7\u00e3o proposta por Darcy pode ser facilmente adaptada para se adequar \u00e0s condi\u00e7\u00f5es do problema. Aplicando-se, por exemplo, as propriedades de fator volume-forma\u00e7\u00e3o sobre a equa\u00e7\u00e3o 2.34, \u00e9 poss\u00edvel obter\nkA(P\u00ed - P2)\n^BL\n(3.4)\nPara que a equa\u00e7\u00e3o seja valida n\u00e3o s\u00f3 para fluxo horizontal, mas tamb\u00e9m para vertical, \u00e9 interessante substituir os termos de press\u00e3o por termos de potencial de fluido. Da mesma maneira, a equa\u00e7\u00e3o pode ser convertida para suportar fluxo multif\u00e1sico atrav\u00e9s da inser\u00e7\u00e3o do termo de permeabilidade relativa, obtendo:\nkkrA($1 - $2) p,BL\n(3.5)\nDefinindo um fluxo na dire\u00e7\u00e3o x, assumindo dimens\u00f5es infinitesimais e considerando\nAx = AyAz:\nkkr Ay Az d $\np,B\tdx\n(3.6)\nSubstituindo a equa\u00e7\u00e3o 3.6 na equa\u00e7\u00e3o 3.3 e rearranjando os termos:\nq =\nq =\n{fluxo de entrada} \u2014 {fluxo de sa\u00edda} =\nAxAyAz\n\"A\ndx\nkkr d$\\ yB dx\nd kkr\n+ dy yB dy\nd kkr\n+ dz yB dz\n(3.7)\nConsiderando um volume total Vb = AxAyAz,que o volume dispon\u00edvel para o fluido \u00e9 V = 0V>, que a por\u00e7\u00e3o desse volume ocupada por este seja igual a sua satura\u00e7\u00e3o e que o termo de ac\u00famulo representa a mudan\u00e7a de massa armazenada em uma c\u00e9lula no tempo,\n{ac\u00famulo} = d (jVt) .\t(3.8)\nSubstituindo as equa\u00e7\u00f5es 3.7 e 3.8 na equa\u00e7\u00e3o 3.1, adequando todos os termos para fase \u00f3leo e considerando uma produ\u00e7\u00e3o de \u00f3leo igual a qo,\n_d\tkkro d $\td\tkkro dtA\ndx yoBo dx\tdy yBo dy\nd kkro d $ + dz yoBo dz\n\u2014 Qo\nd\tSoVb^\ndt Bo\n(3.9)\nDe forma an\u00e1loga, para a \u00e1gua,\nVb\n\"A\ndx\nkkrw d $ yw Bw dx\nd\tkkrw\ndy yw Bw dy\nd kkrw dz yw Bw dz\n\u2014 Qw\nd\tSw Vb0\ndt\tBw\n(3.10)\nVisto a exist\u00eancia do g\u00e1s em solu\u00e7\u00e3o, o g\u00e1s n\u00e3o pode ser modelado da mesma maneira que a \u00e1gua. Uma modelagem adequada para o g\u00e1s seria primeiramente modelar o g\u00e1s livre e somar com o g\u00e1s em solu\u00e7\u00e3o. Assim obtendo:\nkkroRs\td $ d\tkkroRs d $ d\tkkroRs d $\ndx yoBo\tdx\t+ dy\tyoBo dy\t+ dz\tk yoBo dzj\nd \u00ed kkrg d$ \\\td \u00ed kkrg d $ \\\td \u00ed kkrg d $ \\\ndx yg Bg dx + dy yg Bg dy + dz yg Bg dz\n= - ( dt\tBo\n\u2014 (Qg + QoRs)\nSoRsVZ , SgVb<A (311)\n+\tBg\nvd A\n3.2\tInflu\u00eancia da Press\u00e3o Capilar\nPara o \u00f3leo temos ent\u00e3o:\n\u00ed = Po - YoD\t(3.12)\nDe forma an\u00e1loga, temos para a \u00e1gua:\n\u00edw = Pw - Ywd\t(3.13)\nAplicando-se a equa\u00e7\u00e3o 2.18, temos portanto:\n\u00edw = Po - Pcow - YwD\t(3.14)\nUtilizando-se dos mesmos princ\u00edpios, temos para o g\u00e1s:\n= Po + Pcgo - YwD\t(3.15)\nSubstituindo as equa\u00e7\u00f5es 3.12,3.14 e 3.15 nas equa\u00e7\u00f5es 3.9, 3.10 e 3.11, respectivamente, obtemos\nd\tkkro d (Po - YoD) + d\tkkro d (Po - YoD)\ndx\\yoBo\tdx ) 8y\\^opo\tdy\nd\tkkro d (Po - YoD)\ndz yoBo\tdz\n- qo\nd\tSoVbi\ndt Bo\n(3.16)\nPara o \u00f3leo,\nVb\n\"A\ndx\nkkrw 8 (Pw\tYwD^\nyw Bw\tdx\nd dy\nkkrw d (Pw YwD^ yw Bw\tdy\nd\tkkrw d (Pw - YwD)\ndz \\ywBw\tdz\n- Qw =\nd\tSw Vb0\ndt\tBw\n(3.17)\nPara a \u00e1gua, e\nkkroRs d (Po\t-\tYoD)\t+ d\tkkroRs\td (Po - YoD)\t,\tkkroRs d\t(Po\t-\tYoD)\nyoBo\tdx ) dy \\ yoBo\tdy )\tdz )\nd / kkrg d (Po + Pcgo - YwD) \\ dx yg Bg\tdx\nd / kkrg d (Po + Pcgo - YwD) \\\ndz yg Bg\tdz\ndy\tdz \\ yoBo\n/ kkrg d (Po + Pcgo - YwD) \\ + yg Bg\tdy\nSoRsVb^ , SgVb^\t(3 18)\nyoBo\nd_\n9y\\yg Bg\nd \u00ed\n- (qg + qoRS) = dt\nBo\n+\tB\u201e\ndz\nvj 4-\nPara o g\u00e1s.\n3.3\tDiscretizando as Equa\u00e7\u00f5es\nO modelo encontrado, entretanto, assume condi\u00e7\u00f5es continuas dentro do reservat\u00f3rio e, consequentemente, existem infinitas solu\u00e7\u00f5es, para infinitos pontos diferentes no reservat\u00f3rio. Desta maneira, o sistema de equa\u00e7\u00f5es seria complexo demais para ser calculado atrav\u00e9s de qualquer m\u00e9todo. Faz-se, portanto, necess\u00e1rio a discretiza\u00e7\u00e3o e a consequente adapta\u00e7\u00e3o para um sistema representado por blocos homog\u00eaneos, usualmente referidos como \"gridblocks\".\nDurante o processo de simula\u00e7\u00e3o, o usu\u00e1rio assume que o reservat\u00f3rio pode ser dividido em um n\u00famero n de blocos. Estes n\u00e3o necessariamente necessitam ter o mesmo formato ou dimens\u00f5es, por\u00e9m devem ser pequenos o suficiente para que sejam verdadeiras considera\u00e7\u00f5es como propriedades constantes dentro de cada bloco e, ao mesmo tempo, grandes o suficiente para reduzir o n\u00famero de c\u00e1lculos. \u00c9 v\u00e1lido lembrar que, para cada bloco, em um sistema trif\u00e1sico, s\u00e3o atribu\u00eddas 3 equa\u00e7\u00f5es, uma para cada fase, al\u00e9m das equa\u00e7\u00f5es respectivas \u00e0s satura\u00e7\u00f5es, que equilibram o sistema. Um sistema possui, ent\u00e3o, para n gridblocks, um total de 6n equa\u00e7\u00f5es.\nPara os fins deste estudo, a sssun\u00e7\u00e3o de que cada bloco possui formato de paralelep\u00edpedo, com dimens\u00f5es semelhantes Ax, Ay e Az e posicionam-se como apresentado na Figura 3.7. Este modelo, por\u00e9m, assume a individualidade de cada bloco que, apesar de compartilhar suas dimens\u00f5es com seus blocos irm\u00e3os, possuem propriedades diferentes e, portanto, comportamentos diferentes no decorrer do estudo.\nFigura 3.7 - Organiza\u00e7\u00e3o dos blocos no modelo estudado\nFonte: Koederitz (2005)\nPara simplificar os c\u00e1lculos, pode-se definir um termo M, chamado de Mobilidade e definido por:\nM =\nk.kr\np,.B\nE, utilizando-se da aproxima\u00e7\u00e3o da diferencial parcial como diferen\u00e7a finita\ndA\tA2 - A1\n\t \t dx-----x2 \u2014 x1\nobtendo ent\u00e3o, para o \u00f3leo:\n(3.19)\n(3.20)\nVb\nd(Po-Yo D)\nx\nd(Po-yoD)\nx\nAx\nd(Po-yoD) dz\nd(Po-yoD) dy\ni,j+1 ,k\nd(Po-yoD) dy\ni,j-1 ,k\nAz\nAy\n) i,j,k+1\nd(Po\u2014yoD) dz\n- qo\nd \u00cdSoV4\\\ndt\\Bo)\n(3.21)\n1\n+\nUtilizando-se da mesma aproxima\u00e7\u00e3o para o tempo:\nVb\nd(Po-yo D) dx\nd(Po-yoD) dx\nAx\nd(Po-yoD) dy\ni,j+1 ,k\nd(Po-YoD) dy\ni,j-1 ,k\nAy\nd(Po-yoD) dz\ni,j,k+1\nd(Po-yoD) dz\ni,j,k-1\n1\n1\nAz\n- qo\nk SoVbA\t_ kSoVb<A\n\\ Bo ) t+At\t\\ Bo / t\nAt\n(3.22)\nDiscretizando ainda os termos de diferencial de potencial, chega-se a:\nAx\nMoi+1 jk\nAy\nVb_\nAz\nPoi+1jk\tYoDi+1,j,k)\t(Poi.j.k\tYoDi,j,k\nAX\nPoi.j.k \u2014 YoDi,j,k^ \u2014 (Poi-ijk \u2014 YoDi\u20141,j,k\nAx\nM\tPoi.j+1.k \u2014 YoDi,j+1,k) \u2014 (Poijk \u2014 YoDi,j,k\noij+1 k\tAy\nPoi,j,k \u2014 YoDi,j,k^ \u2014 {Poi,j-i,k \u2014 Y\u00edo Di,j\u20141,k\nV\tAy\t)\n,\t, Oijk\tYoPi,j,k)\nAy\nM\toi,j,k\t!o~i,J,k)\toi,j-1,k\tYo Di,j\u20141,k\noi . j-1. k\tAy\nM\tPoi,j,k+1 \u2014 YoDi,j,k+1) \u2014 (Poijk \u2014 YoDi,j,k)\noijk+iy\tAz\nPoi.j.k \u2014 Yo Di,j,k} \u2014 (Poi.j.k-1 \u2014 YoDi,j,k\u20141 y\tAZ\n)\u25a0\n1-\nSoVb\u00f3\tS \\b,\nq _\t(3 23)\nqo _\tAt\t(3.23)\nMoi-1 jk\n' j k-1\n+\n+\nRetornando o volume total \u00e0s suas condi\u00e7\u00f5es originais Vb = AxAyAz e simplificando os termos em que os mesmos est\u00e3o presentes, obt\u00e9m-se:\nAyAz\nAx\nM\t.j.k (^Poi+1,j,k\tYoPi+1,j,^\tU\u2019,...:\tYoDi,j,^}\t\t\t\t+\nMoi i-\t1 ,j,\u00c1 (Poi,j,k\tY\u00b0Di,j,k)\t\u00c7Poi 1,j,k\tYoDi\u20141,j,k) }\t\nAxAz\tMoi,j+1 .k ( {Poi,j+1,k\t'\tDi,j+1,k)\t{Poi.j.k \u2014 Yo Di\tj,kS} \u2014\nAy\t\t\t\t\nMo, i,j\t-1 .k ( ^Poi,j,k \u2014 YoDi,j,k)\t1.k\tYoDi,j\u20141,k)')\t+\nAxAy\tMoi,j,k+1^ (Poi,j\u2019k+1 \u2014\t!\tDi,j,k+1^\t\u00c7Poi.j.k \u2014 YoDi,\tj,kS} \u2014\nAz\t\t\t\t\nMoi.j.k- 1 ( {Poi,j,k\tYoDi,j,k)\t\tPoi.j.k-1\tYoDi,j,k\u20141)')\t\u2014\nSoVb\u00f3\n_ V Bo Jt+At qo _\tAt\nSoVb\u00bf\n\u2014\t- (3.24)\nDe forma an\u00e1loga, as mesmas opera\u00e7\u00f5es podem ser realizadas nas equa\u00e7\u00f5es 3.17 e 3.18, que modelam a \u00e1gua e o g\u00e1s, respectivamente.\nO termo Mo 1 . , entretanto, assume uma permeabilidade m\u00e9dia entre os centros dos\ni+ 1 ,j,k\nm\u00e9dia harm\u00f4nica ponderada, ou seja,\n, AxiAxi+1\nkavg = Axi , Axi+1\t(3.25)\nki\tki+1\n3.4\tRepresenta\u00e7\u00e3o dos Po\u00e7os\nAinda que o modelo contemple a movimenta\u00e7\u00e3o dos fluidos em um reservat\u00f3rio de maneira completa, principal objetivo de uma simula\u00e7\u00e3o \u00e9 \"imitar\"os efeitos gerados pelas diversas perturba\u00e7\u00f5es em um reservat\u00f3rio. Estas, por sua vez, s\u00e3o geradas atrav\u00e9s de po\u00e7os, sejam eles de inje\u00e7\u00e3o ou de produ\u00e7\u00e3o. Modelar os po\u00e7os, portanto, se mostra uma tarefa essencial para o desenvolvimento de um modelo eficiente.\nUm dos modelos mais simples, por\u00e9m mais eficientes, \u00e9 o modelo de Peaceman. Este modelo parte da equa\u00e7\u00e3o de Darcy e considera o fluido saindo da rocha como um todo, n\u00e3o levando em conta, por exemplo, mudan\u00e7as de estado f\u00edsico decorrente da altera\u00e7\u00e3o brusca de press\u00e3o entre a rocha-reservat\u00f3rio e o po\u00e7o. Propriedades essenciais ao modelo, como o fluxo simult\u00e2neo de v\u00e1rias fases com propriedades diferentes e adapta\u00e7\u00e3o ao modelo de grid-blocks s\u00e3o facilmente adapt\u00e1veis, uma vez que a equa\u00e7\u00e3o de Darcy pode ser facilmente manipulada.\nO modelo inicialmente proposto por Peaceman (1978) \u00e9 a proposi\u00e7\u00e3o de Schwabe e Brand:\nq=\n2nkh Pe \u2014 Pwf p in rw + s\n(3.26)\nOnde Pe representa a press\u00e3o m\u00e9dia volum\u00e9trica n\u00e3o s\u00f3 do bloco em estudo, mas tamb\u00e9m dos blocos ao entorno deste e s representa o fator de skin do po\u00e7o, isto \u00e9, representa o dano (ou melhoramento) decorrente dos processos de perfura\u00e7\u00e3o e completa\u00e7\u00e3o.\nPeaceman (1978) ent\u00e3o assume que as dimens\u00f5es do bloco s\u00e3o muito superiores ao raio do po\u00e7o (re >>> rw), obtendo:\n(3.27)\nErtekin (2001) continua estes estudos e encontra, para fluxo em estado estacion\u00e1rio, \u00e0 seguinte equa\u00e7\u00e3o:\n2nkh (Pi,j,k\tPwf )\nqSc\nPB [ln (\u00a3) \u2014 0.5 + s\n(3.28)\nPara condi\u00e7\u00f5es anisotr\u00f3picas, Peaceman (1978) ainda define:\nre ~ req = 0, 28 \u2022\nfe (Ax)2 +\nfc (Ay)2\n(3.29)\nE, consequentemente, para condi\u00e7\u00f5es isotr\u00f3picas:\nre ~ req = 0,14^(Ax)2 + (Ay)2\t(3.30)\nA adequa\u00e7\u00e3o para modelo multif\u00e1sico \u00e9 feita pela simples inser\u00e7\u00e3o do termo de permeabilidade relativa, multiplicando o numerador do lado esquerdo da equa\u00e7\u00e3o, resultando em, para o \u00f3leo:\nqo\n2nkrokh (A, ...\tPwf')\nPoBo ln (- 0-5 + s\n(3.31)\n4\tFuncionamento do Simulador\nUma vez deduzidos todos os modelos necess\u00e1rios, foi iniciada a montagem do simulador. Este, baseado em FORTRAN 90, utiliza em seu c\u00f3digo apenas componentes de uso livre, n\u00e3o necessitando de licen\u00e7as adicionais nem cita\u00e7\u00f5es. A pr\u00f3pria linguagem FORTRAN possui licen\u00e7a de uso livre e, sendo um dos c\u00f3digos mais eficientes para c\u00e1lculos matem\u00e1ticos simples, aliado com um c\u00f3digo de f\u00e1cil aprendizado devido a sua sem\u00e2ntica simples, foi escolhida como linguagem de uso neste trabalho.\n4.1 A Linguagem FORTRAN\nDefinida como uma linguagem de n\u00edvel alto, FORTRAN tem seu nome gra\u00e7as a contra\u00e7\u00e3o de \"FORmula TRANslated\"(ingl\u00eas para f\u00f3rmula traduzida). Muito utilizada para processos extensivos de c\u00e1lculo, essa linguagem teve inicio nos anos 1950 e se dedicava principalmente a cientistas e engenheiros.\nEm suas primeiras vers\u00f5es, era inserida atrav\u00e9s de cart\u00f5es perfurados, Hoje em dia, por\u00e9m, por ser uma linguagem vers\u00e1til e bem adequada para opera\u00e7\u00f5es matem\u00e1ticas, existem v\u00e1rios compiladores e infinitas IDE\u2019s. Por esta mesma raz\u00e3o, esta linguagem foi, por muito tempo, a preferida pelas universidades para pesquisadores e engenheiros.\nHoje em dia no Brasil, a maioria das institui\u00e7\u00f5es federais ainda utiliza o FORTRAN para os cursos de engenharias Qu\u00edmica e de Petr\u00f3leo. Outros cursos, entretanto, substituem essa linguagem por C, Pascal, Java e, recentemente, Phyton.\nSem\u00e2ntica B\u00e1sica da Linguagem\nA linguagem FORTRAN 90, vers\u00e3o utilizada neste estudo, surgiu como uma tentativa de modernizar a antiga vers\u00e3o 77, que, apesar de j\u00e1 incluir v\u00e1rias estruturas l\u00f3gicas, apresentava-se obsoleta em rela\u00e7\u00e3o \u00e0s outras linguagens. A moderniza\u00e7\u00e3o foi bem aceita, uma vez que ambas utilizavam de um modelo de sintaxe parecido, por\u00e9m com grandes diferen\u00e7as quanto ao desempenho. Dentre a sem\u00e2ntica b\u00e1sica desta linguagem, pode-se destacar:\n1\tO FORTRAN 90, ao contr\u00e1rio do 77, n\u00e3o possui uma regra explicita quanto as colunas (alguns compiladores mais arcaicos, no entanto, necessitam de flags para que esta regra seja quebrada).\n2\tO ponto de exclama\u00e7\u00e3o (!) define o in\u00edcio e um coment\u00e1rio e instrui o compilador a ignorar todo o conte\u00fado desta linha ap\u00f3s o mesmo.\n3\tAinda que a linguagem seja compat\u00edvel com comandos em letras min\u00fasculas, a boa pr\u00e1tica e a praticidade na leitura sugerem que todos os comandos estejam na capitaliza\u00e7\u00e3o mai\u00fascula. O mesmo ocorre com a identa\u00e7\u00e3o, por\u00e9m devido a incompatibilidade de alguns compiladores mais antigos, a boa pr\u00e1tica recomenda tamb\u00e9m s\u00f3 utilizar os 8 primeiros caracteres de cada linha para os comandos, sendo utilizados na maioria das vezes apenas para refer\u00eancias.\n4.2 Mecanismo de Resolu\u00e7\u00e3o\nAs equa\u00e7\u00f5es desenvolvidas durante os cap\u00edtulos 2 e 3 podem ser reunidas, formando um sistema de, para n gridblock, 6 x n equa\u00e7\u00f5es. Uma maneira de solucionar esse tipo de sistema, \u00e9 encar\u00e1-lo como uma multiplica\u00e7\u00e3o de matrizes, no formato A x x \u2014 b = 0, onde A \u00e9 uma matriz quadrada de ordem 6n, que recebe os termos quem multiplicam as press\u00f5es e satura\u00e7\u00f5es nas equa\u00e7\u00f5es, x \u00e9 o vetor cujo valor ser\u00e1 manipulado durante a solu\u00e7\u00e3o, contendo os valores das vari\u00e1veis e b \u00e9 um vetor coluna que recebe todas as informa\u00e7\u00f5es independentes das vari\u00e1veis representadas em x.\nUma vez que sistemas como esse podem alcan\u00e7ar n\u00fameros incrivelmente altos de equa\u00e7\u00f5es e solu\u00e7\u00f5es diretas iriam exigir muito c\u00e1lculo computacional, com o incidente risco de n\u00e3o convergir, a solu\u00e7\u00e3o adotada, gra\u00e7a a sua simplicidade e efici\u00eancia, \u00e9 o M\u00e9todo de Newton-Raphson. Esse m\u00e9todo iterativo baseia-se na utiliza\u00e7\u00e3o da itera\u00e7\u00e3o anterior, somado o resqu\u00edcio (ou diferen\u00e7a) dividido pela derivada das equa\u00e7\u00f5es que comp\u00f5e o sistema.\nO M\u00e9todo de Newton-Raphson \u00e9, ent\u00e3o, representado por:\nxn+1 \u2014 xn\nf (xn) f (xn)\n(4.1)\n4.3\tFuncionamento B\u00e1sico do Programa\nO programa encontra-se no formato de sub-rotina, a fim de melhor se adequar a uma estrutura modular, de f\u00e1cil adapta\u00e7\u00e3o para diferentes situa\u00e7\u00f5es. Esta, com o nome de \"Newton Solver\"utiliza como entrada informa\u00e7\u00f5es como estado anterior do reservat\u00f3rio(Representado pela matriz R), informa\u00e7\u00f5es relativas aos po\u00e7os (WELLS), informa\u00e7\u00f5es relativas ao passo de tempo (tstep), dimens\u00f5es dos blocos (GB), n\u00famero total de blocos em cada dire\u00e7\u00e3o (x,y e z), n\u00famero total de equa\u00e7\u00f5es do sistema (n), informa\u00e7\u00f5es sobre o comportamento das bordas do reservat\u00f3rio (BOUNDARY), informa\u00e7\u00f5es sobre a rocha-reservat\u00f3rio (ROCK), informa\u00e7\u00f5es sobre o fluido a ser estudado pr\u00e9 processadas de acordo com as condi\u00e7\u00f5es anteriores (PVT), Informa\u00e7\u00f5es sobre o fluido est\u00e1ticas ao tempo (SPVT) e configura\u00e7\u00f5es relativas \u00e0 precis\u00e3o e ao limite de itera\u00e7\u00f5es (SETUP). Suas informa\u00e7\u00f5es de sa\u00edda constituem no novo estado do reservat\u00f3rio (sobrescrito sobre a matriz R) e informa\u00e7\u00f5es quantitativas como \u00f3leo, \u00e1gua e g\u00e1s \"in-place\".\nPara construir as matrizes utilizadas para a resolu\u00e7\u00e3o, o programa segue um algoritmo espec\u00edfico, onde ele trata cada fase por sua vez, compondo as matrizes linha por linha de acordo com as equa\u00e7\u00f5es. As equa\u00e7\u00f5es s\u00e3o inseridas no modelo na seguinte ordem:\n1o - Equa\u00e7\u00f5es relativas ao fluxo do \u00f3leo na fase l\u00edquida\n2o - Equa\u00e7\u00f5es relativas ao fluxo de \u00e1gua\n3o - Equa\u00e7\u00f5es relativas ao fluxo de g\u00e1s livre e g\u00e1s em solu\u00e7\u00e3o\n4o - Equa\u00e7\u00f5es relativas ao correto somat\u00f3rio das satura\u00e7\u00f5es, certificando-se que as mesmas atinjam o todo da c\u00e9lula\n5o - Equa\u00e7\u00f5es relativas \u00e0 press\u00e3o capilar \u00f3leo-\u00e1gua\n6o - Equa\u00e7\u00f5es relativas \u00e0 press\u00e3o capilar g\u00e1s-\u00f3leo\nO algoritmo utilizado segue um padr\u00e3o onde, atrav\u00e9s de uma sequ\u00eancia de caracteres, reconhece o tipo de equa\u00e7\u00e3o a ser tratado. Uma vez reconhecido, ele segue preenchendo as linhas com as informa\u00e7\u00f5es tridimensionais das c\u00e9lulas, mantendo sempre a ordem de preenchimento seguindo primeiramente o eixo x, ap\u00f3s oye, finalmente o z. Uma vez atingido o final de um eixo, o programa da um passo no eixo seguinte e reinicia o anterior, fazendo assim com que todas as c\u00e9lulas sejam cobertas. Ap\u00f3s o t\u00e9rmino de todos os eixos, o programa se encarrega de trocar a vari\u00e1vel que armazena a sess\u00e3o a ser trabalhada.\nDevido a esta organiza\u00e7\u00e3o, \u00e9 poss\u00edvel garantir que a matriz A gerada n\u00e3o possuir\u00e1 determinante nulo e, portanto, o sistema possui uma solu\u00e7\u00e3o \u00fanica, al\u00e9m de transformar com excel\u00eancia uma informa\u00e7\u00e3o tridimensional em uma informa\u00e7\u00e3o bidimensional facilmente mape\u00e1vel com garantias de que nenhum dado ser\u00e1 perdido no processo.\nUma vez montada a matriz A e o vetor b, o programa calcula a fun\u00e7\u00e3o derivada e, atrav\u00e9s do M\u00e9todo de Newton-Raphson, entra em loop at\u00e9 que o crit\u00e9rio de parada seja atingido. O crit\u00e9rio de parada geralmente \u00e9 representado por um fator aceit\u00e1vel de diferen\u00e7a entre duas itera\u00e7\u00f5es consecutivas ou um n\u00famero limite de itera\u00e7\u00f5es que evita uma eventual sobrecarga do sistema.\nAtingido esse crit\u00e9rio de parada, o programa interpreta as informa\u00e7\u00f5es e as gera no formado de sa\u00edda necess\u00e1rio, gerando um vetor de resultado com 4 dimens\u00f5es, sendo a primeira a informa\u00e7\u00e3o armazenada, e as outras tr\u00eas as coordenadas a que se referem. O programa calcula tamb\u00e9m, ao final de todos os c\u00e1lculos deste espa\u00e7o de tempo, as informa\u00e7\u00f5es qualitativas e as exporta em seu respectivo vetor.\nAo final so c\u00e1lculo, a subrotina se encerra e retorna ao programa principal criado pelo usu\u00e1rio, que pode armazenar as informa\u00e7\u00f5es e iniciar um novo passo de tempo ou encerrar os c\u00e1lculos e iniciar sua interpreta\u00e7\u00e3o.\nc\u00e1lculo. O programa ainda exibe como sa\u00edda um segundo arquivo, representando, em sequ\u00eancia, as condi\u00e7\u00f5es m\u00e9dias de press\u00e3o do reservat\u00f3rio, a quantidade de \u00f3leo e g\u00e1s ainda armazenados e a vaz\u00e3o total dos po\u00e7os, como representado na nas figuras 4.8 e 4.9.\niTirr\testepl ,c Editar\tw- Bloco de Formatar\tExibir Ajuda\t\t\t\t\t\t\t- \u25a1\tX\nTimestep 1\t\t\t\t\t\t\t\t\t\t\t\nx\t\ty\t>\t\tPoil\tPwat\tPgas\tSoil\tSwat\tSgas\t,\t\t\n1\t\ti\t,\t1 ,\t2424.100665\t2433.797068\t2421.191744\t0.455828978\t0.273497387\t0.270673635\t,\t\t\n2\t\t1 ,\t1 ,\t2202.396267\t2211.205852\t2199.753391\t0.401566416\t0.240939849\t0.357493735\t,\t\t\n3\t\ti\t,\t1 ,\t2110.3022\t2118.743408\t2107.769837\t0.384774758\t0.230864855\t0.384360387\t,\t\t\n4\t\t1 ,\t1 ,\t2046.233986\t2054.418922\t2043.778506\t0.373093099\t0.223855859\t0.403051042\t,\t\t\n5\t\ti\t,\t1 ,\t2022.975285\t2031.067186\t2020.547715\t0.368852303\t0.221311382\t0.409836316\t,\t\t\n6\t\t1 ,\t1 ,\t2046.233986\t2054.418922\t2043.778506\t0.373093099\t0.223855859\t0.403051042\t,\t\t\n7\t\ti\t,\t1 ,\t2110.3022\t2118.743408\t2107.769837\t0.384774758\t0.230864855\t0.384360387\t,\t\t\n8\t\t1 ,\t1 ,\t2202.396267\t2211.205852\t2199.753391\t0.401566416\t0.240939849\t0.357493735\t,\t\t\n9\t\ti\t,\t1 ,\t2309.955325\t2319.195146\t2307.183379\t0.42117783\t0.252706698\t0.326115472\t,\t\t\n10\t\t1 ,\t1 ,\t2424.100665\t2433.797068\t2421.191744\t0.441990131\t0.265194079\t0.29281579\t,\t\t\n1\t\t2 ,\t1 ,\t2202.396267\t2211.205852\t2199.753391\t0.401566416\t0.240939849\t0.357493735\t,\t\t\n2\t\t2 ,\t1 ,\t2068.48089\t2076.754813\t2065.998712\t0.377149412\t0.226289647\t0.396560941\t,\t\t\n3\t\t2 ,\t1 ,\t1945.926354\t1953.710059\t1943.591242\t0.354803848\t0.212882309\t0.432313843\t,\t\t\n4\t\t2 ,\t1 ,\t1854.297145\t1861.714334\t1852.071989\t0.338096949\t0.202858169\t0.459044882\t,\t\t\n5\t\t2 ,\t1 ,\t1819.285226\t1826.562367\t1817.102083\t0.33171317\t0.199027902\t0.469258928\t,\t\t\n6\t\t2 ,\t1 ,\t1854.297145\t1861.714334\t1852.071989\t0.338096949\t0.202858169\t0.459044882\t,\t\t\n7\t\t2 ,\t1 ,\t1945.926354\t1953.710059\t1943.591242\t0.354803848\t0.212882309\t0.432313843\t,\t\t\n8\t\t2 ,\t1 ,\t2068.48089\t2076.754813\t2065.998712\t0.377149412\t0.226289647\t0.396560941\t,\t\t\n9\t\t2 ,\t1 ,\t2202.396267\t2211.205852\t2199.753391\t0.401566416\t0.240939849\t0.357493735\t,\t\t\n10\t\t2 ,\t1 ,\t2337.29969\t2346.648889\t2334.494931\t0.426163571\t0.255698143\t0.318138286\t,\t\t\n1\t\t3\t,\t1 ,\t2110.3022\t2118.743408\t2107.769837\t0.384774758\t0.230864855\t0.384360387\t,\t\t\n2\t\t3\t,\t1 ,\t1945.926354\t1953.710059\t1943.591242\t0.354803848\t0.212882309\t0.432313843\t,\t\t\n3\t\t3\t,\t1 ,\t1781.350149\t1788.47555\t1779.212529\t0.324796407\t0.194877844\t0.480325749\t,\t\t\n4\t\t3\t,\t1 ,\t1642.597066\t1649.167454\t1640.625949\t0.299497337\t0.179698402\t0.520804261\t,\t\t\n5\t\t3\t,\t1 ,\t1583.779778\t1590.114897\t1581.879242\t0.288773087\t0.173263852\t0.537963061\t,\t\t\n6\t\t3\t,\t1 ,\t1642.597066\t1649.167454\t1640.625949\t0.299497337\t0.179698402\t0.520804261\t,\t\t\n7\t\t3\t,\t1 ,\t1781.350149\t1788.47555\t1779.212529\t0.324796407\t0.194877844\t0.480325749\t,\t\t\n8\t\t3\t,\t1 ,\t1945.926354\t1953.710059\t1943.591242\t0.354803848\t0.212882309\t0.432313843\t,\t\t\n9\t\t3\t,\t1 ,\t2110.3022\t2118.743408\t2107.769837\t0.384774758\t0.230864855\t0.384360387\t,\t\t\n10\t\t3\t,\t1 ,\t2266.339894\t2275.405253\t2263.620286\t0.413225359\t0.247935215\t0.338839426\t,\t\t\n1\t\t4\t,\t1 ,\t2046.233986\t2054.418922\t2043.778506\t0.373093099\t0.223855859\t0.403051042\t,\t\t\n2\t\t4\t,\t1 ,\t1854.297145\t1861.714334\t1852.071989\t0.338096949\t0.202858169\t0.459044882\t,\t\t\n3\t\t4\t,\t1 ,\t1642.597066\t1649.167454\t1640.625949\t0.299497337\t0.179698402\t0.520804261\t,\t\t\n4\t\t4\t,\t1 ,\t1429.963801\t1435.683656\t1428.247844\t0.260727575\t0.156436545\t0.58283588\t,\t\t\n5\t\t4\t,\t1 ,\t1318.580934\t1323.855258\t1316.998637\t0.24041896\t0.144251376\t0.615329664\t,\t\tv\nFigura 4.8 - Modelo de output contendo informa\u00e7\u00f5es de cada bloco do reservat\u00f3rio\nFigura 4.9 - Modelo de output contendo informa\u00e7\u00f5es do reservat\u00f3rio como um todo\nEixo x\nce\n-\nW\n2520.0823\n2245.6446\n2108,4254\n13T1.2063\n1833,3871\n1636.T680\n1553.5488\n1422.3237\n1285.1105\n1147.8314\nFigura 4.10 - Interpreta\u00e7\u00e3o das informa\u00e7\u00f5es extra\u00eddas do programa. Press\u00e3o de \u00f3leo.\nEixo x\n\t\t\t\t\t\t\t\t\t\n\u25a0\t\t\t\t\t\t\t\t\t\n0.4558\t0.4016\t0.3848\t0.3731\t0.3683\t0.3731\t0.3848\t0.4016\t0.4212\t0.4420\n0,4016\t0,3771\t0,3548\t0.3381\t0.3317\t0,3381\t0.3548\t0.3771\t0,4016\t0.4262\n0.3848\t0.3548\t0,3248\t0.2335\t0,2888\t0.2335\t0.3248\t0,3548\t0.3848\t0.4132\n0.3731\t0.3381\t0.2335\t0.2607\t0.2404\t0.2607\t0.2335\t0.3381\t0.3731\t0.4046\n0.3683\t0.3317\t0,2888\t0.2404\t0,2033\t0.2404\t0.2888\t0.3317\t0.3683\t0.4016\n0.3731\t0.3381\t0.2335\t0.2607\t0.2404\t0.2607\t0.2335\t0.3381\t0.3731\t0.4046\n0.3848\t0.3548\t0,3248\t0.2335\t0,2888\t0.2335\t0.3248\t0,3548\t0.3848\t0.4132\n0,4016\t0,3771\t0,3548\t0.3381\t0.3317\t0,3381\t0.3548\t0.3771\t0,4016\t0.4262\n0.4212\t0.4016\t0.3848\t0.3731\t0.3683\t0.3731\t0.3848\t0.4016\t0.4212\t0.4420\n0.4420\t0.4262\t0.4132\t0.4046\t0.4016\t0.4046\t0.4132\t0,4262\t0.4420\t0.4535\nFigura 4.11 - Interpreta\u00e7\u00e3o das informa\u00e7\u00f5es extra\u00eddas do programa. Satura\u00e7\u00e3o de \u00f3leo.\nMais detalhes podem ser encontrados no Ap\u00eandice A, que apresenta o c\u00f3digo em FORTRAN utilizado na confec\u00e7\u00e3o do programa.\n4.4\tEstudos de Caso\nA fins de teste da capacidade e das limita\u00e7\u00f5es do programa, foram executados estudos de caso sobre situa\u00e7\u00f5es de potencial uso do programa, incluindo:\n4.4.1\tCaso 1 - Reservat\u00f3rio convencional\nUtilizando-se os inputs presentes no ap\u00eandice B, chegou-se ao resultado apresentado nas figuras 4.12 e 4.13, mostrando que o simulador resolveu o problema com propriedade. A queda de press\u00e3o no entorno do bloco de posi\u00e7\u00e3o 5, 5 \u00e9 devida a presen\u00e7a de po\u00e7o produtor na regi\u00e3o.\n\t\t\t\t\t\t\t\t\t\t\t\n\t\u25a0\t\u25a0\t\t\t\t\t\t\t\t\t\n\t\u25a0\t2424.1007\t2202.3363\t2110.3022\t2046.2340\t2022.3753\t2046.2340\t2110.3022\t2202.3363\t2303.3553\t2424.1007\n\t\t2202.3363\t2068,4803\t1345,3264\t1854.2371\t1813.2852\t1854.2371\t1345.3264\t2068.4803\t2202.3363\t2337,2337\n\t\t2110.3022\t1345.3264\t1781.3501\t1642.5371\t1583.7738\t1642.5571\t1781.3501\t1345,3264\t2110.3022\t2266,3333\n\t\t2046.2340\t1854.2371\t1642.5371\t1423.3638\t1318.5803\t1423.3638\t1642.5371\t1854.2371\t2046.2340\t2213.0830\n\t\t2022.3753\t1813.2852\t1583.7738\t1318.5803\t1147.8314\t1318.5803\t1583.7738\t1813,2852\t2022.3753\t2202,3363\n\t\t2046.2340\t1854.2371\t1642.5371\t1423.3638\t1318.5803\t1423.3638\t1642.5371\t1854.2371\t2046.2340\t2213.0830\n\t\t2110.3022\t1345.3264\t1781.3501\t1642.5371\t1583.7738\t1642.5371\t1781.3501\t1345,3264\t2110.3022\t2266,3333\n\t\t2202.3363\t2068,4803\t1345,3264\t1854.2371\t1813.2852\t1854.2371\t1345.3264\t2068.4803\t2202.3363\t2337,2337\n\t\t2303.3553\t2202.3363\t2110.3022\t2046.2340\t2022.3753\t2046.2340\t2110.3022\t2202.3363\t2303.3553\t2424.1007\n\t\t2424.1007\t2337,2337\t2266.3333\t2213,0830\t2202,3363\t2213,0830\t2266,3333\t2337.2337\t2424.1007\t2520.0823\n2520.0823\n2245.6446\n2108,4254\n1371.2063\n1833,3871\nlS\n-\nW\n1636.T680\n1553.5488\n1422.3237\n1285.1105\n1147.8314\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n0.3248\n0.3546\n0.4132\n0.3543\n0.3381\n0.3317\n0.3381\n0.3548\n0.3771\n0,4016\n0.4262\n0.3848\n0.3731\n0.3731\n0.3848\n0.4016\n0.4212\n0.4420\n0.4132\n0.4046\n0.4016\n0.4046\n0.4132\n0,4262\n0.4420\n0.4535\n0.2033\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n4.4.2\tCaso 2 - Reservat\u00f3rio com aus\u00eancia de capa de g\u00e1s\nO caso 2, em contrapartida, apresentou resultados inconclusivos. Acredita-se que a principal raz\u00e3o seja a r\u00e1pida varia\u00e7\u00e3o de press\u00e3o causada pela aus\u00eancia do g\u00e1s. Uma vez que o m\u00e9todo utilizado \u00e9 o m\u00e9todo impl\u00edcito de c\u00e1lculo, o coeficiente de expans\u00e3o do \u00f3leo n\u00e3o se mostra suficiente, gerando dist\u00farbios e assim resultados irreais, como pode ser conferido nas figuras 4.14 e 4.15.\nFigura 4.14 - Interpreta\u00e7\u00e3o das informa\u00e7\u00f5es extra\u00eddas do programa. Press\u00e3o de \u00f3leo. Reservat\u00f3rio com aus\u00eancia de capa de g\u00e1s.\n4.4.3\tCaso 3 - Reservat\u00f3rio com quantidade reduzida de \u00e1gua de forma\u00e7\u00e3o\nFigura 4.15 - Interpreta\u00e7\u00e3o das informa\u00e7\u00f5es extra\u00eddas do programa. Satura\u00e7\u00e3o de \u00f3leo. Reservat\u00f3rio com aus\u00eancia de capa de g\u00e1s.\ngeram, no m\u00e9todo impl\u00edcito, situa\u00e7\u00f5es onde erros de arredondamento, problema comum ao se tratar de m\u00e9todos num\u00e9ricos, se tornem relevantes e prejudiquem o c\u00e1lculo do resultado. Os resultados encontram-se nas figuras 4.16 e 4.17.\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\u25a0\t\t\t\t\t\t\t\t\t\t\u25a0\t\t\n\t\t48825\t48676\t51581\t54237\t56232\t58462\t60577\t62472\t63773\t63332\t\u25a0\t\t63332\n\t\t48032\t45455\t50361\t54234\t56522\t58396\t60504\t62137\t63366\t63460\t1\t\t60237\n\t\t48618\t43624\t52145\t54634\t56867\t58478\t53376\t61643\t62378\t62673\t1\t\t58383\n\t\t51024\t51345\t52940\t55096\t56535\t58089\t53476\t60478\t61209\t61237\t1\t\t56541\n\t\t51587\t52145\t53296\t54627\t56122\t57462\t58319\t59113\t59823\t60129\t\t\t54694\n\t\t\t\t\t\t\t\t\t\t\t\t\u25a0\t\t\n\t\t51625\t52134\t53037\t54275\t55463\t56312\t57021\t57617\t58200\t58863\t\u25a0\t\t52846\n\t\t51028\t51842\t52845\t53890\t54788\t55715\t55623\t55078\t56833\t57562\t\t\t50998\n\t\t50775\t51235\t52488\t53832\t54801\t55063\t54023\t50139\t54886\t56639\t\t\t49151\n\t\t50055\t50332\t52224\t53835\t54T55\t55050\t54814\t54160\t55706\t56543\t\t\t47303\n\t\t50038\t50721\t52158\t53643\t54793\t55266\t55104\t55548\t56322\t56697\t1\t\t45455\nFigura 4.16 - Interpreta\u00e7\u00e3o das informa\u00e7\u00f5es extra\u00eddas do programa. Press\u00e3o de \u00f3leo. Reservat\u00f3rio com quantidade reduzida de \u00e1gua de forma\u00e7\u00e3o.\n-0,6828\n-0,6835\n-0,6835\n-0.682*\n-0.6828\n-0.6830\n-0,6823\n-0.6823\n\n\n\n\n\n\n\n\n\nEixo x\n\n\n\n\n\n\n\n\n\n\n\n-0.6833\n5\tConclus\u00e3o e Sugest\u00f5es para Trabalhos Futuros\nA simula\u00e7\u00e3o de reservat\u00f3rios \u00e9 uma t\u00e9cnica em constante desenvolvimento que, a cada dia, se torna mais importante seu conhecimento. A revolu\u00e7\u00e3o digital faz com que computadores consigam executar modelos cada vez mais complexos e confi\u00e1veis em tempo economicamente vi\u00e1veis. Em contrapartida, essa disponibilidade de softwares, juntamente ao patenteamento de metodologias utilizado por v\u00e1rias empresas, fazem com que estes m\u00e9todos caiam no esquecimento.\nCom o intuito de reunir estas informa\u00e7\u00f5es em um formato consolidado e did\u00e1tico, este trabalho apresentou o estudo e o desenvolvimento de uma metodologia de previs\u00e3o de comportamento de um reservat\u00f3rio trif\u00e1sico atrav\u00e9s da modelagem Black Oil, utilizando apenas linguagens e c\u00f3digos abertos ao p\u00fablico. Dentre todas as caracter\u00edsticas do c\u00f3digo implementado, pode-se destacar sua facilidade em ser transformado. Uma vez que todas suas entradas s\u00e3o manipul\u00e1veis e suscet\u00edveis a implanta\u00e7\u00e3o de modelos diferentes. Sua resolu\u00e7\u00e3o pelo m\u00e9todo de Newton-Raphson, apesar de demorada, apresenta converg\u00eancia em condi\u00e7\u00f5es mais amenas.\nA metodologia adotada para a reorganiza\u00e7\u00e3o das informa\u00e7\u00f5es provou-se efetiva e capaz de lidar com o desafio proposto pelo programa. Posteriores revis\u00f5es das dedu\u00e7\u00f5es e discretiza\u00e7\u00f5es confirmaram a efici\u00eancia destas equa\u00e7\u00f5es na representa\u00e7\u00e3o da realidade quando atendidas condi\u00e7\u00f5es amenas de reservat\u00f3rio, estando limitadas a resolu\u00e7\u00e3o do estudo, que n\u00e3o pode ser alta demais a fim de comprometer a performance, nem baixa demais a ponto de comprometer a efici\u00eancia e a presen\u00e7a de todas as fases modeladas.\nResta ainda, por\u00e9m, estudos de como melhor lidar com gerenciamento de mem\u00f3ria durante a cria\u00e7\u00e3o das matrizes solu\u00e7\u00e3o, assim como a pesquisa por m\u00e9todos de solu\u00e7\u00e3o mais eficientes, como m\u00e9todo de gradiente conjugado, ORTHOMIN, entre outros. Sugere-se tamb\u00e9m estudos comparativos entre resultados obtidos atrav\u00e9s deste programa e simuladores comerciais, a fim de se realizar ajustes, assim como a cria\u00e7\u00e3o de m\u00f3dulos adicionais para o programa, adicionando novas metodologias para o c\u00e1lculo de propriedades.\nRefer\u00eancias\nAHMED, T. Reservoir engineering handbook. Amsterdam Boston: Gulf Professional Pub, 2010. ISBN 978-1-85617-803-7. Citado na p\u00e1gina 14.\nAHMED, T. Equations of State and PVT Analysis, Second Edition: Applications for Improved Reservoir Modeling. Estados Unidos da Am\u00e9rica: Gulf Professional Publishing, 2016. ISBN 978-0-12801-570-5. Citado na p\u00e1gina 19.\nBRADLEY, H. B. Petroleum Engineering Handbook. Estados Unidos da Am\u00e9rica: Society of Petroleum, 1987. ISBN 978-1-55563-010-3. Citado na p\u00e1gina 15.\nERTEKIN, T. Basic Applied Reservoir Simulation. Estados Unidos da Am\u00e9rica: Society of Petroleum Engineers, 2001. ISBN 978-1-55563-089-8. Citado 8 vezes nas p\u00e1ginas 13, 14, 18, 20, 21, 22, 25 e 34.\nKATZ, D. L. V. Handbook of natural gas engineering. New York: McGraw-Hill, 1959. ISBN 978-0-07033-384-0. Citado na p\u00e1gina 16.\nKOEDERITZ, L. F. Lecture Notes On Applied Reservoir Simulation. University of Missouri - Rolla, Estados Unidos da Am\u00e9rica: World Scientific Publishing Company, 2005. ISBN 978-9-81256-198-6. Citado 3 vezes nas p\u00e1ginas 28, 29 e 31.\nMCCAIN, W. D. The properties of petroleum fluids. Tulsa - OK, Estados Unidos da Am\u00e9rica: PennWell Books, 1990. ISBN 978-0-87814-335-1. Citado na p\u00e1gina 15.\nPEACEMAN, D. Interpretation of well-block pressures in numerical reservoir simula-tion(includes associated paper 6988 ). Society of Petroleum Engineers Journal, Society of Petroleum Engineers (SPE), v. 18, n. 03, p. 183-194, jun 1978. Dispon\u00edvel em:&lt;https://doi.org/10.2118/6893-pa>. Citado 2 vezes nas p\u00e1ginas 34 e 35.\nROSA, A. J. Engenharia de Reservat\u00f3rio de Petr\u00f3leo. Rio de Janeiro: Interci\u00eancia, 2006. ISBN 978-8-57193-135-6. Citado 7 vezes nas p\u00e1ginas 12, 14, 15, 17, 19, 20 e 33.\nTERRY, R. E.; ROGERS, J. B. Applied Petroleum Reservoir Engineering. Estados Unidos da Am\u00e9rica: Prentice Hall, 2014. ISBN 978-0-13315-558-7. Citado na p\u00e1gina 15.\nWELTY, J. et al. Fundamentals of Momentum, Heat and Mass Transfer. Hoboken - NJ, Estados Unidos da Am\u00e9rica: Wiley, 2007. ISBN 978-0-47012-868-8. Citado na p\u00e1gina 26.\nAp\u00eandices\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\nAP\u00caNDICE A - C\u00f3digo Desenvolvido\nNas p\u00e1ginas a seguir, encontra-se todo o c\u00f3digo desenvolvido durante o estudo deste trabalho. Existe no in\u00edcio uma se\u00e7\u00e3o de coment\u00e1rios em ingl\u00eas que explicam o conte\u00fado de cada vari\u00e1vel, fazendo, assim, um mapeamento detalhado da localiza\u00e7\u00e3o de cada informa\u00e7\u00e3o.\nSUBROUTINE Newton_Solver(R,WELLS,tstep,GB,x,y,z,n,BOUNDARY,ROCK ,PVT,SPVT,WRES,RRES,SETUP)\nINTEGER x, y, z, i, j, k, l, m, n, counter,ipvt(n),info REAL R(6,x,y,z),GUESS(n),GUESSold(n), WELLS(x,y,z,7), tstep, GB(3),\nROCK(3,x,y,z), PVT(10,x,y,z), SPVT(4), WRES(3,x,y,z), RRES(4), B(n ), Pi, A(n,n), BOUNDARY(6), SETUP(2),work(n), det(2), RT(n), dA(n, n)\nCHARACTER(3) var ! This subroutine organize and solve the system for a determined timestep.\n#########################################################################\n!\t# ATTENTION:\n#\n!\t# FOR THIS SUBROUTINE BE ABLE TO RUN, YOU NEED TO ADD THE\n#\n!\t# -ffixed-line-length-0 AND -ffree-line-length-0 FLAGS TO THE\nCOMPILLER #\n!\t#\t( GFORTRAN &amp; GCC )\n#\n!\t# STILL NEED SOME TESTING, BUT I THINK INTEL FORTRAN DOESN'T\nNEED FLAGS #\n!\t#\tTO COMPILE THIS SUBROUTINE IF IT'S ON F90 FILE FORMAT\n#\n#########################################################################\n19\t!\t*R is a 4 dimensional matrix that stores data from previous\nruns, like pressures and saturations. This variable will store the new data. It has the following structure: R(data,X_position,\nY_position,Z_position). The data is organized in: 1 - Oil Pressure ; 2 - Water Pressure; 3 - Gas Pressure; 4 - Oil Saturation; 5 -Water Saturation; 6 - Gas Saturation\n20\t!\t*WELLS is a 4 dimensional that stores the data from producing\nand injecting wells. It has the following structure: WELLS( X_position,Y_position,Z_position,stored_data) Stored data is organized in: 1 - Number of the Well(0 for no well); 2 - Type of well (0 for productor, 1 for water injector, 2 for gas injector);\n3 - Type of Constraint (0 for Fluid Rate, 1 for Pressure); 4 -Constraint as determined on 3; 5 - Pwf, 6 - Well diameter; 7 -Skin Effect\n21\t!\t*tstep defines the size of the timestep to be calculated. The\ndistance in time between the information that will be stored.\n22\t!\t*GB stores information about the dimensions of each gridblock\nof the model. It's organized as a single vector with the following structure: GB(1) stores the X dimension of the gridblocks; GB(2) stores the Y dimension of the gridblocks; GB(3)stores the Z dimension of the gridblocks.\n23\t!\t*BOUNDARY is a size 6 vector that stores the boundary\nconditions for each of the reservoir boundaries. (0 for no flow, otherwise it stores the flow pressure)\n24\t!\t*ROCK is a 4 dimensional matrix that stores information about\nPorosity and Permeability. It has the following structure: ROCK( data,X_position,Y_position,Z_position). The data is organized in: 1 - Vertical Permeability; 2 - Horizontal Permeability; 3 -Porosity\n25\t!\t*PVT stores data that relates to the fluid. It has the\nfollowing structure: PVT(data,X_position,Y_position,Z_position).\nThe data is organized in: 1 -Oil Viscosity; 2 -Oil FVF; 3 - Kro; 4 - Pcow; 5 - Pcog; 6 - Rso; 7 - Gas FVF; 8 - Gas Viscosity; 9 -Krw; 10 - Krg\n26\t!\t*SPVT stores PVT data that doesn't change with time or position\n. It's a one dimension vector with the following structure: 1 -Water Brine density; 2 - Gas specific gravity; 3 - Oil Sp.Gr.; 4 -Reservoir Temperature.\n27\t!\t*WRES store the output data, like the production or the\npressure on each well.\n28\t!\t*RRES store the output data of the reservoir, like the average\npressure, the FOIP, the FGIP and the FWIP\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n!\t*SETUP stores the parameters for the Newton solver: 1 - Maximum\nnumber of iterations before break the timestep; 2 - Decimal order of precision for the Newton solver.\ni=1\nj = 1\nk=1\nPi =\t3.1415265358979323846264338327950288419716939937510\nA=0\nB=0\nvar='OIL'\nDO l=1,n,1 !this section creates the A matrix\nIF (var.eq.'OIL') THEN !Generates the section of the matrix that relates with oil equations.\nIF (i.eq.1) THEN\nA(l,l + 1) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i+1,j,k)))*GB(2)*GB (3) *PVT(3,i,j,k)/(GB(1) *PVT(2,i,j,k) *PVT(1,i,j,k))\nIF (BOUNDARY(1).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(2,i,j,k)*GB(2)*GB(3)*PVT(3,i,j,k)/(GB(1)\n*PVT(2,i,j,k) *PVT(1,i,j,k)) *BOUNDARY(1)\nA(l,l) = A(l,l)-0.006328*ROCK(2,i,j,k) *GB(2) *GB(3) *PVT(3,i,j,k)/(GB\n(1)\t*PVT(2,i,j,k) *PVT(1,i,j,k))\nEND IF\nA(l,l) = A(l,l)-A(l,l + 1)\nELSE IF (i.eq.x) THEN\nA(l,l-1) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i-1,j,k)))*GB(2)*GB (3) *PVT(3,i,j,k)/(GB(1) *PVT(2,i,j,k) *PVT(1,i,j,k))\nIF (BOUNDARY(2).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(2,i,j,k)*GB(2)*GB(3)*PVT(3,i,j,k)/(GB(1)\n*PVT(2,i,j,k) *PVT(1,i,j,k)) *BOUNDARY(2)\nA(l,l) =A(l,l)-0.00 6328*ROCK(2,i,j,k) *GB(2) *GB(3) *PVT(3,i,j,k)/(GB\n(1)\t*PVT(2,i,j,k) *PVT(1,i,j,k))\nEND IF\nA(l,l) = A(l,l)-A(l,l-1)\nELSE\nEND IF\nIF (j.eq.1) THEN\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n86\n87\nA(l,l+x) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i,j+1,k)))*GB(1)*GB\n(3) *PVT(3,i,j,k)/(GB(2) *PVT(2,i,j,k) *PVT(1,i,j,k))\nIF (BOUNDARY(3).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(2,i,j,k)*GB(1)*GB(3)*PVT(3,i,j,k)/(GB(2)\n*PVT(2,i,j,k) *PVT(1,i,j,k)) *BOUNDARY(3)\nA(l,l) = A(l,l)-0.006328*ROCK(2,i,j,k) *GB(1) *GB(3) *PVT(3,i,j,k)/(GB\n(2)\t*PVT(2,i,j,k) *PVT(1,i,j,k))\nEND IF\nA(l,l) = A(l,l)-A(l,l+x)\nELSE IF (j.eq.y) THEN\nA(l,l-x) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i,j-1,k)))*GB(1)*GB\n(3)\t*PVT(3,i,j,k)/(GB(2) *PVT(2,i,j,k) *PVT(1,i,j,k))\nIF (BOUNDARY(4).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(2,i,j,k)*GB(1)*GB(3)*PVT(3,i,j,k)/(GB(2)\n*PVT(2,i,j,k) *PVT(1,i,j,k)) *BOUNDARY(4)\nA(l,l) = A(l,l)-0.006328*ROCK(2,i,j,k) *GB(1) *GB(3) *PVT(3,i,j,k)/(GB\n(2)\t*PVT(2,i,j,k) *PVT(1,i,j,k))\nEND IF\nA(l,l) = A(l,l)-A(l,l-x)\nELSE\nA(l,l+x) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i,j+1,k)))*GB(1)*GB\n(3)\t*PVT(3,i,j,k)/(GB(2) *PVT(2,i,j,k) *PVT(1,i,j,k))\nA(l,l-x) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i,j-1,k)))*GB(1)*GB\n(3) *PVT(3,i,j,k)/(GB(2) *PVT(2,i,j,k) *PVT(1,i,j,k))\nA(l,l) = A(l,l)-A(l,l-x)-A(l,l+x)\nEND IF\nIF (k.eq.1) THEN\nA(l,l+x*y) = 0.00 6328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k+1))) *GB(2) *\nGB(1) *PVT(3,i,j,k)/(GB(3) *PVT(2,i,j,k) *PVT(1,i,j,k))\nB(l) = B(l) + 0.006328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k + 1)))*GB(2)*\nGB(1) *PVT(3,i,j,k) *SPVT(3) *GB(3)/(GB(3) *PVT(2,i,j,k) *PVT(1,i,j,k)) IF (BOUNDARY(5).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(1,i,j,k)*GB(2)*GB(1)*PVT(3,i,j,k)/(GB(3)\n*PVT(2,i,j,k) *PVT(1,i,j,k)) *BOUNDARY(5)\nA(l,l) = A(l,l)-0.006328*ROCK(1,i,j,k) *GB(2) *GB(1) *PVT(3,i,j,k)/(GB\n(3) *PVT(2,i,j,k) *PVT(1,i,j,k))\nEND IF\nA(l,l) = A(l,l)-A(l,l+x*y)\n88\n89\n90\n91\n92\n93\n94\n95\n96\n97\n98\n99\n100\n101\n102\n103\n104\n105\n106\n107\n108\n109\n110\n111\n112\n113\n114\n115\n116\nB(l) = B(l) - 0.006328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k-1)))*GB(2)*\nGB(1) *PVT(3,i,j,k) *SPVT(3) *GB(3)/(GB(3) *PVT(2,i,j,k) *PVT(1,i,j,k))\nIF (BOUNDARY(6).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(1,i,j,k)*GB(2)*GB(3)*PVT(3,i,j,k)/(GB(1)\n*PVT(2,i,j,k)*PVT(1,i,j,k))*BOUNDARY(6)\nA(l,l) = A(l,l)-0.006328*ROCK(1,i,j,k)*GB(2)*GB(3)*PVT(3,i,j,k)/(GB\n(1)*PVT(2,i,j,k)*PVT(1,i,j,k))\nEND IF\nA(l,l) = A(l,l)-A(l,l-x*y)\nELSE\nA(l,l+x*y) = 0.00 6328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k+1))) *GB(2) * GB(1) *PVT(3,i,j,k)/(GB(3) *PVT(2,i,j,k) *PVT(1,i,j,k))\nA(l,l-x*y) = 0.00 6328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k-1))) *GB(2) * GB(1) *PVT(3,i,j,k)/(GB(3) *PVT(2,i,j,k) *PVT(1,i,j,k))\nB(l) = B(l) + 0.006328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k + 1)))*GB(2)* GB(1)*PVT(3,i,j,k)*SPVT(3)*GB(3)/(GB(3)*PVT(2,i,j,k)*PVT(1,i,j,k))\n- 0.006328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k-1)))*GB(2)*GB(1)* PVT(3,i,j,k) *SPVT(3) *GB(3)/(GB(3) *PVT(2,i,j,k) *PVT(1,i,j,k))\nA(l,l) = A(l,l)-A(l,l-x*y)-A(l,l+x*y)\nEND IF\nIF (WELLS(i,j,k,1).ne.0) THEN\nIF (WELLS(i,j,k,2).eq.0) THEN\nB(l) = B(l)+0.00708*ROCK(2,i,j,k) *PVT(3,i,j,k) *GB(3) *(R(1,i,j,k)/2-WELLS(i,j,k,5))/(PVT(2,i,j,k) *PVT(1,i,j,k)* (LOG(SQRT (GB(1) *GB(2)/ Pi)/WELLS(i,j,k,6))-0.75+WELLS(i,j,k,7)))\nA(l,l) = A(l,l)-0.00708*ROCK(2,i,j,k) *PVT(3,i,j,k) *GB(3)/(PVT(2,i,j,k ) *PVT(1,i,j,k)* (LOG(SQRT (GB(1) *GB(2)/Pi)/WELLS(i,j,k,6))-0.75 + WELLS(i,j,k,7)))\nEND IF\nEND IF\nA(l,l+3*x*y*z) = GB(1) *GB(2) *GB(3)/tstep*ROCK(3,i,j,k)/PVT(2,i,j,k)\nB(l) = B(l) + GB(1)*GB(2)*GB(3)/tstep*ROCK(3,i,j,k)/PVT(2,i,j,k)*R(4, i,j,k)\ni=i+1\nIF (i.gt.x) THEN\ni=1\nj=j+1\nEND IF\nIF (j.gt.y) THEN\nj=1\nk=k+1\n117\n118\n119\n120\n121\n122\n123\n124\n125\n126\n127\n128\n129\n130\n131\n132\n133\n134\n135\n136\n137\n138\n139\n140\n141\n142\n143\n144\n145\n146\nIF (k.gt.z) THEN\nk=1\nvar='WAT'\nEND IF\nELSE IF (var.eq.'WAT') THEN !Generates the section of the matrix that relates with water equations.\nIF (i.eq.1) THEN\nA(l,l + 1) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i+1,j,k)))*GB(2)*GB (3) *PVT(9,i,j,k)/(GB(1))\nIF (BOUNDARY(1).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(2,i,j,k)*GB(2)*GB(3)*PVT(9,i,j,k)/(GB(1)\n)*BOUNDARY(1)\nA(l,l) = A(l,l)-0.006328*ROCK(2,i,j,k) *GB(2) *GB(3) *PVT(9,i,j,k)/(GB\n(1))\nEND IF\nA(l,l) = A(l,l)-A(l,l + 1)\nELSE IF (i.eq.x) THEN\nA(l,l-1) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i-1,j,k)))*GB(2)*GB (3) *PVT(9,i,j,k)/(GB(1))\nIF (BOUNDARY(2).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(2,i,j,k)*GB(2)*GB(3)*PVT(9,i,j,k)/(GB(1)\n)*BOUNDARY(2)\nA(l,l) =A(l,l)-0.00 6328*ROCK(2,i,j,k) *GB(2) *GB(3) *PVT(9,i,j,k)/(GB\n(1))\nEND IF\nA(l,l) = A(l,l)-A(l,l-1)\nELSE\nA(l,l+1) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i+1,j,k)))*GB(2)*GB (3) *PVT(9,i,j,k)/(GB(1))\nA(l,l-1) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i-1,j,k)))*GB(2)*GB (3) *PVT(9,i,j,k)/(GB(1))\nA(l,l) = A(l,l)-A(l,l-1)-A(l,l + 1)\nEND IF\nIF (j.eq.1) THEN\nA(l,l+x) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i,j+1,k)))*GB(1)*GB (3) *PVT(9,i,j,k)/(GB(2))\nIF (BOUNDARY(3).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(2,i,j,k)*GB(1)*GB(3)*PVT(9,i,j,k)/(GB(2)\n)*BOUNDARY(3)\nA(l,l) =A(l,l)-0.00 6328*ROCK(2,i,j,k) *GB(1) *GB(3) *PVT(9,i,j,k)/(GB\n(2))\n147\n148\n149\n150\n151\n152\n153\n154\n155\n156\n157\n158\n159\n160\n161\n162\n163\n164\n165\n166\n167\n168\n169\n170\n171\n172\n173\n174\n175\nA(l,l) = A(l,l)-A(l,l+x)\nELSE IF (j.eq.y) THEN\nA(l,l-x) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i,j-1,k)))*GB(1)*GB\n(3)\t*PVT(9,i,j,k)/(GB(2))\nIF (BOUNDARY(4).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(2,i,j,k)*GB(1)*GB(3)*PVT(9,i,j,k)/(GB(2)\n)*BOUNDARY(4)\nA(l,l) =A(l,l)-0.00 6328*ROCK(2,i,j,k) *GB(1) *GB(3) *PVT(9,i,j,k)/(GB\n(1))\nEND IF\nA(l,l) = A(l,l)-A(l,l-x)\nELSE\nA(l,l+x) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i,j+1,k)))*GB(1)*GB\n(3) *PVT(9,i,j,k)/(GB(2))\nA(l,l-x) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i,j-1,k)))*GB(1)*GB\n(3) *PVT(9,i,j,k)/(GB(2))\nA(l,l) = A(l,l)-A(l,l-x)-A(l,l+x)\nEND IF\nIF (k.eq.1) THEN\nA(l,l+x*y) = 0.006328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k + 1))) *GB(2) * GB(1)*PVT(9,i,j,k)/(GB(3))\nB(l) = B(l) + 0.006328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k+1)))*GB(2)*\nGB(1) *PVT(9,i,j,k) *SPVT(1) *GB(3)/(GB(3))\nIF (BOUNDARY(5).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(1,i,j,k)*GB(2)*GB(3)*PVT(9,i,j,k)/(GB(1)\n)*BOUNDARY(5)\nA(l,l) =A(l,l)-0.00 6328*ROCK(1,i,j,k) *GB(2) *GB(3) *PVT(9,i,j,k)/(GB\n(1))\nEND IF\nA(l,l) = A(l,l)-A(l,l+x*y)\nELSE IF (k.eq.z) THEN\nA(l,l-x*y) = 0.00632 8*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k-1))) *GB(2) * GB(1)*PVT(9,i,j,k)/(GB(3))\nB(l) = B(l) - 0.006328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k-1)))*GB(2)*\nGB(1) *PVT(9,i,j,k) *SPVT(1) *GB(3)/(GB(3))\nIF (BOUNDARY(6).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(1,i,j,k)*GB(2)*GB(1)*PVT(9,i,j,k)/(GB(3)\n)*BOUNDARY(6)\nA(l,l) =A(l,l)-0.00 6328*ROCK(1,i,j,k) *GB(2) *GB(1) *PVT(9,i,j,k)/(GB\n(3))\nEND IF\nA(l,l) = A(l,l)-A(l,l-x*y)\n176\n177\n178\n179\n180\n181\n182\n183\n184\n185\n186\n187\n188\n189\n190\n191\n192\n193\n194\n195\n196\n197\n198\n199\n200\n201\n202\n203\n204\n205\nELSE\nA(l,l+x*y) = 0.00 6328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k+1))) *GB(2) * GB(1)*PVT(9,i,j,k)/(GB(3))\nA(l,l-x*y) = 0.00 6328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k-1))) *GB(2) * GB(1)*PVT(9,i,j,k)/(GB(3))\nB(l) = B(l) + 0.006328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k + 1)))*GB(2)* GB(1) *PVT(9,i,j,k) *SPVT(1) *GB(3)/(GB(3)) - 0.006328*(2/(1/ROCK(1,i ,j,k)+1/ROCK(1,i,j,k-1))) *GB(2) *GB(1) *PVT(9,i,j,k) *SPVT(1) *GB(3)/( GB(3))\nA(l,l) = A(l,l)-A(l,l-x*y)-A(l,l+x*y)\nEND IF\nIF (WELLS(i,j,k,1).ne.0) THEN\nIF (WELLS(i,j,k,2).eq.0) THEN\nB(l) = B(l)+0.00708*ROCK(2,i,j,k) *PVT(9,i,j,k) *GB(3) *(R(2,i,j,k)/2-WELLS(i,j,k,5))/((LOG(SQRT (GB(1) *GB(2)/Pi)/WELLS(i,j,k,6))-0.75 + WELLS(i,j,k,7)))\nA(l,l) = A(l,l)-0.00708*ROCK(2,i,j,k) *PVT(9,i,j,k) *GB(3)/((LOG(SQRT (\nGB(1) *GB(2)/Pi)/WELLS(i,j,k,6))-0.7 5+WELLS(i,j,k,7)))\nELSE IF (WELLS(i,j,k,2).eq.1) THEN\nB(l) = B(l)-0.00708*ROCK(2,i,j,k) *PVT(9,i,j,k) *GB(3) *(R(2,i,j,k)/2-WELLS(i,j,k,5))/(PVT(2,i,j,k) *PVT(1,i,j,k)* (LOG(SQRT (GB(1) *GB(2)/ Pi)/WELLS(i,j,k,6))-0.75+WELLS(i,j,k,7)))\nA(l,l) = A(l,l)+0.00708*ROCK(2,i,j,k) *PVT(9,i,j,k) *GB(3)/(PVT(2,i,j,k ) *PVT(1,i,j,k)* (LOG(SQRT (GB(1) *GB(2)/Pi)/WELLS(i,j,k,6))-0.75 + WELLS(i,j,k,7)))\nEND IF\nEND IF\nA(l,l + 3*x*y*z) = GB(1)*GB(2)*GB(3)/tstep*ROCK(3,i,j,k)\nB(l) = B(l) + GB(1)*GB(2)*GB(3)/tstep*ROCK(3,i,j,k)*R(5,i,j,k)\ni=i+1\nIF (i.gt.x) THEN\ni=1\nj=j+1\nEND IF\nIF (j.gt.y) THEN j=1\nk=k+1\nEND IF\nIF (k.gt.z) THEN\nk=1\nvar='GAS'\n206\n207\n208\n209\n210\n211\n212\n213\n214\n215\n216\n217\n218\n219\n220\n221\n222\n223\n224\n225\n226\n227\n228\n229\n230\n231\n232\n233\n234\nELSE IF (var.eq.'GAS') THEN !Generates the section of the matrix that relates with gas equations.\n! Here starts the gas equations. Those equations doesn't consider the Dissolved Gas.\nIF (i.eq.1) THEN\nA(l,l + 1) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i+1,j,k)))*GB(2)*GB (3) *PVT(10,i,j,k)/(GB(1) *PVT(7,i,j,k) *PVT(8,i,j,k))\nIF (BOUNDARY(1).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(2,i,j,k)*GB(2)*GB(3)*PVT(10,i,j,k)/(GB\n(1) *PVT(7,i,j,k) *PVT(8,i,j,k)) *BOUNDARY(1)\nA(l,l) =A(l,l)-0.00 6328*ROCK(2,i,j,k) *GB(2) *GB(3) *PVT(10,i,j,k)/(GB (1) *PVT(7,i,j,k) *PVT(8,i,j,k))\nEND IF\nA(l,l) = A(l,l)-A(l,l + 1)\nELSE IF (i.eq.x) THEN\nA(l,l-1) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i-1,j,k)))*GB(2)*GB (3) *PVT(10,i,j,k)/(GB(1) *PVT(7,i,j,k) *PVT(8,i,j,k))\nIF (BOUNDARY(2).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(2,i,j,k)*GB(2)*GB(3)*PVT(10,i,j,k)/(GB\n(1) *PVT(7,i,j,k) *PVT(8,i,j,k)) *BOUNDARY(2)\nA(l,l) =A(l,l)-0.00 6328*ROCK(2,i,j,k) *GB(2) *GB(3) *PVT(10,i,j,k)/(GB\n(1)\t*PVT(7,i,j,k) *PVT(8,i,j,k))\nEND IF\nA(l,l) = A(l,l)-A(l,l-1)\nELSE\nA(l,l+1) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i+1,j,k)))*GB(2)*GB (3) *PVT(10,i,j,k)/(GB(1) *PVT(7,i,j,k) *PVT(8,i,j,k))\nA(l,l-1) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i-1,j,k)))*GB(2)*GB\n(3) *PVT(10,i,j,k)/(GB(1) *PVT(7,i,j,k) *PVT(8,i,j,k))\nA(l,l) = A(l,l)-A(l,l-1)-A(l,l + 1)\nEND IF\nIF (j.eq.1) THEN\nA(l,l+x) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i,j+1,k)))*GB(1)*GB (3) *PVT(10,i,j,k)/(GB(2) *PVT(7,i,j,k) *PVT(8,i,j,k))\nIF (BOUNDARY(3).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(2,i,j,k)*GB(1)*GB(3)*PVT(10,i,j,k)/(GB\n(2)\t*PVT(7,i,j,k) *PVT(8,i,j,k)) *BOUNDARY(3)\nA(l,l) =A(l,l)-0.00 6328*ROCK(2,i,j,k) *GB(1) *GB(3) *PVT(10,i,j,k)/(GB\n(2)\t*PVT(7,i,j,k) *PVT(8,i,j,k))\nEND IF\nA(l,l) = A(l,l)-A(l,l+x)\nELSE IF (j.eq.y) THEN\n235\n236\n237\n238\n239\n240\n241\n242\n243\n244\n245\n246\n247\n248\n249\n250\n251\n252\n253\n254\n255\n256\n257\n258\n259\n260\n261\nA(l,l-x) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i,j-1,k)))*GB(1)*GB\n(3)\t*PVT(10,i,j,k)/(GB(2) *PVT(7,i,j,k) *PVT(8,i,j,k))\nIF (BOUNDARY(4).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(2,i,j,k)*GB(1)*GB(3)*PVT(10,i,j,k)/(GB\n(2)\t*PVT(7,i,j,k) *PVT(8,i,j,k)) *BOUNDARY(4)\nA(l,l) = A(l,l)-0.006328*ROCK(2,i,j,k) *GB(1) *GB(3) *PVT(10,i,j,k)/(GB\n(2)\t*PVT(7,i,j,k) *PVT(8,i,j,k))\nEND IF\nA(l,l) = A(l,l)-A(l,l-x)\nELSE\nA(l,l+x) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i,j+1,k)))*GB(1)*GB\n(3)\t*PVT(10,i,j,k)/(GB(2) *PVT(7,i,j,k) *PVT(8,i,j,k))\nA(l,l-x) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i,j-1,k)))*GB(1)*GB\n(3)\t*PVT(10,i,j,k)/(GB(2) *PVT(7,i,j,k) *PVT(8,i,j,k))\nA(l,l) = A(l,l)-A(l,l-x)-A(l,l+x)\nEND IF\nIF (k.eq.1) THEN\nA(l,l+x*y) = 0.00 6328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k+1))) *GB(2) *\nGB(1) *PVT(10,i,j,k)/(GB(3) *PVT(7,i,j,k) *PVT(8,i,j,k))\nB(l) = B(l) + 0.006328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k + 1)))*GB(2)* GB(1) *PVT(10,i,j,k) *SPVT(2) *GB(3)/(GB(3) *PVT(7,i,j,k) *PVT(8,i,j,k) )\nIF (BOUNDARY(5).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(1,i,j,k)*GB(2)*GB(1)*PVT(10,i,j,k)/(GB\n(3)\t*PVT(7,i,j,k) *PVT(8,i,j,k)) *BOUNDARY(5)\nA(l,l) =A(l,l)-0.00 6328*ROCK(1,i,j,k) *GB(2) *GB(1) *PVT(10,i,j,k)/(GB\n(3) *PVT(7,i,j,k) *PVT(8,i,j,k))\nEND IF\nA(l,l) = A(l,l)-A(l,l+x*y)\nELSE IF (k.eq.z) THEN\nA(l,l-x*y) = 0.00 6328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k-1))) *GB(2) *\nGB(1) *PVT(10,i,j,k)/(GB(3) *PVT(7,i,j,k) *PVT(8,i,j,k))\nB(l) = B(l) - 0.006328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k-1)))*GB(2)*\nGB(1) *PVT(10,i,j,k) *SPVT(2) *GB(3)/(GB(3) *PVT(7,i,j,k) *PVT(8,i,j,k) )\nIF (BOUNDARY(6).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(1,i,j,k)*GB(2)*GB(3)*PVT(10,i,j,k)/(GB\n(1) *PVT(7,i,j,k) *PVT(8,i,j,k)) *BOUNDARY(6)\nA(l,l) = A(l,l)-0.006328*ROCK(1,i,j,k) *GB(2) *GB(3) *PVT(10,i,j,k)/(GB (1) *PVT(7,i,j,k) *PVT(8,i,j,k))\nEND IF\nA(l,l) = A(l,l)-A(l,l-x*y)\n262\n263\n264\n265\n266\n267\n268\n269\n270\n271\n272\n273\n274\n275\n276\n277\n278\n279\n280\n281\n282\n283\n284\n285\n286\nELSE\nA(l,l+x*y) = 0.006328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k + 1))) *GB(2) *\nGB(1) *PVT(10,i,j,k)/(GB(3) *PVT(7,i,j,k) *PVT(8,i,j,k))\nA(l,l-x*y) = 0.00632 8*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k-1))) *GB(2) *\nGB(1) *PVT(10,i,j,k)/(GB(3) *PVT(7,i,j,k) *PVT(8,i,j,k))\nB(l) = B(l) + 0.006328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k+1)))*GB(2)*\nGB(1) *PVT(10,i,j,k) *SPVT(2) *GB(3)/(GB(3) *PVT(7,i,j,k) *PVT(8,i,j,k) ) - 0.006328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k-1))) *GB(2) *GB(1) * PVT(10,i,j,k) *SPVT(2) *GB(3)/(GB(3) *PVT(7,i,j,k) *PVT(8,i,j,k))\nA(l,l) = A(l,l)-A(l,l-x*y)-A(l,l+x*y)\nEND IF\n! Here starts the Dissolved Gas equations.\nIF (i.eq.1) THEN\nA(l,-2*x*y*z+l+1) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i+1,j,k)))*\nGB(2) *GB(3) *PVT(3,i,j,k)/(GB(1) *PVT(2,i,j,k) *PVT(1,i,j,k))* (PVT(6, i,j,k)+PVT(6,i + 1,j,k))/2\nIF (BOUNDARY(1).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(2,i,j,k)*GB(2)*GB(3)*PVT(3,i,j,k)/(GB(1)\n*PVT(2,i,j,k)*PVT(1,i,j,k))*BOUNDARY(1)*(PVT(6,i,j,k))\nA(l,-2*x*y*z+l) = A(l,-2*x*y*z+l)-0.006328 *ROCK(2,i,j,k)*GB(2)*GB(3)*\nPVT(3,i,j,k)/(GB(1) *PVT(2,i,j,k) *PVT(1,i,j,k)) *(PVT(6,i,j,k))\nEND IF\nA(l,-2*x*y*z+l) = A(l,-2*x*y*z+l)-A(l,-2*x*y*z+l+1)\nELSE IF (i.eq.x) THEN\nA(l,-2*x*y*z+l-1) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i-1,j,k)))*\nGB(2) *GB(3) *PVT(3,i,j,k)/(GB(1) *PVT(2,i,j,k) *PVT(1,i,j,k))* (PVT(6, i,j,k)+PVT(6,i-1,j,k))/2\nIF (BOUNDARY(2).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(2,i,j,k)*GB(2)*GB(3)*PVT(3,i,j,k)/(GB(1)\n*PVT(2,i,j,k)*PVT(1,i,j,k))*BOUNDARY(2)*(PVT(6,i,j,k))\nA(l,-2*x*y*z+l) = A(l,-2*x*y*z+l)-0.006328 *ROCK(2,i,j,k)*GB(2)*GB(3)*\nPVT(3,i,j,k)/(GB(1) *PVT(2,i,j,k) *PVT(1,i,j,k)) *(PVT(6,i,j,k))\nEND IF\nA(l,-2*x*y*z+l) = A(l,-2*x*y*z+l)-A(l,-2*x*y*z+l-1)\nELSE\n287\n288\n289\n290\n291\n292\n293\n294\n295\n296\n297\n298\n299\n300\n301\n302\n303\n304\n305\n306\n307\n308\n309\n310\n311\nEND IF\nIF (j.eq.1) THEN\nA(l,-2 *x*y*z+l+x) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i,j+1,k))) * GB(1) *GB(3) *PVT(3,i,j,k)/(GB(2) *PVT(2,i,j,k) *PVT(1,i,j,k))* (PVT(6, i,j,k)+PVT(6,i,j + 1,k))/2\nIF (BOUNDARY(3).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(2,i,j,k)*GB(1)*GB(3)*PVT(3,i,j,k)/(GB(2)\n*PVT(2,i,j,k) *PVT(1,i,j,k)) *BOUNDARY(3) * (PVT(6,i,j,k))\nA(l,-2*x*y*z+l) = A(l,-2*x*y*z+l)-0.006328 *ROCK(2,i,j,k)*GB(1)*GB(3)* PVT(3,i,j,k)/(GB(2) *PVT(2,i,j,k) *PVT(1,i,j,k)) *(PVT(6,i,j,k))\nEND IF\nA(l,-2*x*y*z+l) = A(l,-2*x*y*z+l)-A(l,-2*x*y*z+l+x)\nELSE IF (j.eq.y) THEN\nA(l,-2 *x*y*z+l-x) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i,j-1,k))) * GB(1) *GB(3) *PVT(3,i,j,k)/(GB(2) *PVT(2,i,j,k) *PVT(1,i,j,k))* (PVT(6, i,j,k)+PVT(6,i,j-1,k))/2\nIF (BOUNDARY(4).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(2,i,j,k)*GB(1)*GB(3)*PVT(3,i,j,k)/(GB(2)\n*PVT(2,i,j,k) *PVT(1,i,j,k)) *BOUNDARY(4) * (PVT(6,i,j,k))\nA(l,-2*x*y*z+l) = A(l,-2*x*y*z+l)-0.006328 *ROCK(2,i,j,k)*GB(1)*GB(3)* PVT(3,i,j,k)/(GB(2) *PVT(2,i,j,k) *PVT(1,i,j,k)) *(PVT(6,i,j,k))\nEND IF\nA(l,-2*x*y*z+l) = A(l,-2*x*y*z+l)-A(l,-2*x*y*z+l-x)\nELSE\nA(l,-2 *x*y*z+l+x) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i,j+1,k))) * GB(1) *GB(3) *PVT(3,i,j,k)/(GB(2) *PVT(2,i,j,k) *PVT(1,i,j,k))* (PVT(6, i,j,k)+PVT(6,i,j + 1,k))/2\nA(l,-2 *x*y*z+l-x) = 0.006328*(2/(1/ROCK(2,i,j,k)+1/ROCK(2,i,j-1,k))) * GB(1) *GB(3) *PVT(3,i,j,k)/(GB(2) *PVT(2,i,j,k) *PVT(1,i,j,k))* (PVT(6, i,j,k)+PVT(6,i,j-1,k))/2\nA(l,-2*x*y*z+l) = A(l,-2*x*y*z+l)-A(l,-2*x*y*z+l-x)-A(l,-2*x*y*z+l+x) END IF\nIF (k.eq.1) THEN\nA(l,-2 *x*y*z+l+x*y) = 0.006328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k+1)) ) *GB(2) *GB(1) *PVT(3,i,j,k)/(GB(3) *PVT(2,i,j,k) *PVT(1,i,j,k))* (PVT (6,i,j,k)+PVT(6,i,j,k + 1))/2\n312\n313\n314\n315\n316\n317\n318\n319\n320\n321\n322\n323\n324\n325\n326\n327\n328\n329\n330\n331\n332\nA(l,-2*x*y*z+l) = A(l,-2*x*y*z+l)-0.006328*ROCK(1,i,j,k)*GB(2)*GB(1)*\nPVT(3,i,j,k)/(GB(3) *PVT(2,i,j,k) *PVT(1,i,j,k)) *(PVT(6,i,j,k))\nEND IF\nA(l,-2*x*y*z+l) = A(l,-2*x*y*z+l)-A(l,-2*x*y*z+l+x*y)\nELSE IF (k.eq.z) THEN\nA(l,-2*x*y*z+l-x*y) = 0.006328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k-1)) ) *GB(2) *GB(1) *PVT(3,i,j,k)/(GB(3) *PVT(2,i,j,k) *PVT(1,i,j,k))* (PVT (6,i,j,k)+PVT(6,i,j,k-1))/2\nB(l) = B(l) - 0.006328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k-1)))*GB(2)* GB(1)*PVT(3,i,j,k)*SPVT(3)*GB(3)/(GB(3)*PVT(2,i,j,k)*PVT(1,i,j,k)) * (PVT(6,i,j,k)+PVT(6,i,j,k-1))/2\nIF (BOUNDARY(6).ne.0) THEN\nB(l) = B(l) -\t0.006328*ROCK(1,i,j,k)*GB(2)*GB(3)*PVT(3,i,j,k)/(GB(1)\n*PVT(2,i,j,k)*PVT(1,i,j,k))*BOUNDARY(6)*(PVT(6,i,j,k))\nA(l,-2*x*y*z+l) = A(l,-2*x*y*z+l)-0.006328*ROCK(1,i,j,k)*GB(2)*GB(3)*\nPVT(3,i,j,k)/(GB(1)*PVT(2,i,j,k)*PVT(1,i,j,k))*(PVT(6,i,j,k))\nEND IF\nA(l,-2*x*y*z+l) = A(l,-2*x*y*z+l)-A(l,-2*x*y*z+l-x*y)\nELSE\nA(l,-2*x*y*z+l+x*y) = 0.006328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k+1)) )*GB(2)*GB(1)*PVT(3,i,j,k)/(GB(3)*PVT(2,i,j,k)*PVT(1,i,j,k))*(PVT (6,i,j,k)+PVT(6,i,j,k+1))/2\nA(l,-2*x*y*z+l-x*y) = 0.006328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k-1)) )*GB(2)*GB(1)*PVT(3,i,j,k)/(GB(3)*PVT(2,i,j,k)*PVT(1,i,j,k))*(PVT (6,i,j,k)+PVT(6,i,j,k-1))/2\nB(l) = B(l) + 0.006328*(2/(1/ROCK(1,i,j,k)+1/ROCK(1,i,j,k+1)))*GB(2)* GB(1)*PVT(3,i,j,k)*SPVT(3)*GB(3)/(GB(3)*PVT(2,i,j,k)*PVT(1,i,j,k)) *(PVT(6,i,j,k)+PVT(6,i,j,k+1))/2 - 0.006328*(2/(1/ROCK(1,i,j,k)+1/ ROCK(1,i,j,k-1)))*GB(2)*GB(1)*PVT(3,i,j,k)*SPVT(3)*GB(3)/(GB(3)* PVT(2,i,j,k)*PVT(1,i,j,k))*(PVT(6,i,j,k)+PVT(6,i,j,k-1))/2\nA(l,-2*x*y*z+l) = A(l,-2*x*y*z+l)-A(l,-2*x*y*z+l-x*y)-A(l,-2*x*y*z+l+ x*y)\nEND IF\nIF (WELLS(i,j,k,1).ne.0) THEN\n333\n334\n335\n336\n337\n338\n339\n340\n341\n342\n343\n344\n345\n346\n347\n348\n349\n350\n351\n352\n353\n354\n355\n356\n357\n358\n359\n360\n361\n362\n363\n364\nB(l) = B(l)+0.00708*ROCK(2,i,j,k) *PVT(3,i,j,k) *GB(3) *(R(1,i,j,k)/2-\nWELLS(i,j,k,5))/(PVT(2,i,j,k) *PVT(1,i,j,k)* (LOG(SQRT (GB(1) *GB(2)/ Pi)/WELLS(i,j,k,6))-0.75+WELLS(i,j,k,7)))* (PVT(6,i,j,k))\nA(l,-2*x*y*z+l) = A(l,-2*x*y*z+l)-0.00708 *ROCK(2,i,j,k)*PVT(3,i,j,k)* GB(3)/(PVT(2,i,j,k) *PVT(1,i,j,k) * (LOG(SQRT (GB(1) *GB(2)/Pi)/WELLS(i ,j,k,6))-0.7 5+WELLS(i,j,k,7)))* (PVT(6,i,j,k))\nELSE IF (WELLS(i,j,k,2).eq.1) THEN\nB(l) = B(l)-0.00708*ROCK(2,i,j,k) *PVT(10,i,j,k) *GB(3) *(R(2,i,j,k)/2-WELLS(i,j,k,5))/(PVT(7,i,j,k) *PVT(8,i,j,k)* (LOG(SQRT (GB(1) *GB(2)/ Pi)/WELLS(i,j,k,6))-0.75+WELLS(i,j,k,7)))\nA(l,l) = A(l,l)+0.00708*ROCK(2,i,j,k) *PVT(10,i,j,k) *GB(3)/(PVT(7,i,j, k) *PVT(8,i,j,k) * (LOG(SQRT (GB(1) *GB(2)/Pi)/WELLS(i,j,k,6))-0.75 + WELLS(i,j,k,7)))\nEND IF\nEND IF\nA(l,l+3*x*y*z) = GB(1)*GB(2)*GB(3)/tstep*ROCK(3,i,j,k)\nB(l) = B(l) + GB(1)*GB(2)*GB(3)/tstep*ROCK(3,i,j,k)*R(5,i,j,k)\nA(l,l+x*y*z) = GB(1) *GB(2) *GB(3)/tstep*ROCK(3,i,j,k)/PVT(2,i,j,k)*( PVT(6,i,j,k))\nB(l) = B(l) + GB(1)*GB(2)*GB(3)/tstep*ROCK(3,i,j,k)/PVT(2,i,j,k)*R(4, i,j,k)* (PVT(6,i,j,k))\ni=i + 1\nIF (i.gt.x) THEN\ni=1\nj = j + 1\nEND IF\nIF (j.gt.y) THEN\nj=1\nk=k + 1\nEND IF\nIF (k.gt.z) THEN\nk=1\nvar='SAT'\nEND IF\nELSE IF (var.eq.'SAT') THEN\nA(l,l) =\t1\nA(l,x*y*z+l) = 1\nA(l,2*x*y*z+l) = 1\nB(l) = 1\ni=i + 1\nIF (i.gt.x) THEN\ni=1\n365\n366\n367\n368\n369\n370\n371\n372\n373\n374\n375\n376\n377\n378\n379\n380\n381\n382\n383\n384\n385\n386\n387\n388\n389\n390\n391\n392\n393\n394\n395\n396\n397\n398\n399\n400\n401\n402\n403\n404\n405\n406\nj = j + 1\nEND IF\nIF (j.gt.y) THEN j = 1\nk=k + 1\nEND IF\nIF (k.gt.z) THEN\nk=1\nvar='COW'\nEND IF\nELSE IF (var.eq.'COW')\nA(l,l-4*x*y*z) = 1\nA(l,l-3*x*y*z) = -1\nB(l) = PVT(4,i,j,k) i=i + 1\nIF (i.gt.x) THEN\ni=1\nj = j + 1\nEND IF\nIF (j.gt.y) THEN j=1\nk=k + 1\nEND IF\nIF (k.gt.z) THEN\nk=1\nvar='COG'\nEND IF\nELSE IF (var.eq.'COG')\nA(l,l-5*x*y*z) = 1\nA(l,l-3*x*y*z) = -1\nB(l) = PVT(5,i,j,k) i=i + 1\nIF (i.gt.x) THEN\ni=1\nj = j + 1\nEND IF\nIF (j.gt.y) THEN j=1\nk=k + 1\nEND IF\nIF (k.gt.z) THEN\nk=1\nTHEN\nTHEN\n407\n408\n409\n410\n411\n412\n413\n414\n415\n416\n417\n418\n419\n420\n421\n422\n423\n424\n425\n426\n427\n428\n429\n430\n431\n432\n433\n434\n435\n436\n437\n438\n439\n440\n441\n442\n443\n444\n445\n446\n447\n448\nvar='END'\nEND IF\nEND IF\nEND DO\ni=1\nj = 1\nk=1\ncounter=1\nDO l=1,n,1 !this section creates the initial guess\nGUESS(l) = R(counter,i,j,k)\ni=i + 1\nIF (i.gt.x) THEN\ni=1\nj = j + 1\nEND IF\nIF (j.gt.y) THEN\nj=1\nk=k + 1\nEND IF\nIF (k.gt.z) THEN\nk=1\ncounter = counter + 1\nEND IF\nEND DO\ndA = A\ncall sgefa(dA,n,n,ipvt,info)\ncall sgedi(dA,n,n,ipvt,det,work,01)\nGUESSold = GUESS\ncounter = 1\nDO WHILE (test.eq.0)\ncounter = counter + 1\nRT = (MATMUL(A,GUESS)-B)\nGUESS = GUESS + MATMUL(dA,RT)\nDO l=1,n,1\ndiff = diff + abs(GUESS(l)-GUESSold(l))\nEND DO\nIF (diff.le.SETUP(2)) THEN\ntest=1\nEND if\nIF (counter.gt.setup(1)) then\ntest=2\nPRINT*\nThe process didn't converge after\ncounter\niterations\n449\n450\n451\n452\n453\n454\n455\n456\n457\n458\n459\n460\n461\n462\n463\n464\n465\n466\n467\n468\n469\n470\n471\n472\n473\n474\n475\n476\n477\n478\n479\n480\n481\n482\n483\n484\n485\n486\n487\nPRINT*, \"In order to proceed, it will be used the call system ('pause')\nEND IF\nEND DO\nCALL exportar(x, y, z, n,GUESS, RRES, R, GB, ROCK,\nEND SUBROUTINE\nSUBROUTINE exportar(x, y, z, n,GUESS, RRES, R, GB, INTEGER i, j, k, l, m, n, x, y, z\nREAL GUESS(n), RRES(6), R(6,x,y,z), GB(3), ROCK(3, z)\ni = 1\nj = 1\nk = 1\nm = 1\nRRES = 0\nDO l=1,n,1\nR(m,i,j,k) = GUESS(l)\ni=i + 1\nIF (i .gt. x) THEN\ni=1\nj = j + 1\nEND IF\nIF (j .gt. y) THEN\nj=1\nk=k + 1\nEND IF\nIF (k .gt. z) THEN\nk=1\nm=m+1\nEND IF\nEND DO\nDO i=1,x,1\nDO j=1,y,1\nDO k=1,z,1\nRRES(1) = RREES(1) + GB(1)*GB(2)*GB(3)*ROCK(3,i,j,\n(2,x,y,z)\nRRES(2) = RREES(2) + GB(1)*GB(2)*GB(3)*ROCK(3,i,j,\nlast guess\"\nPVT)\nROCK, PVT)\nx,y,z), PVT(10,x,y,\nk) *R(4,i,j,k)/PVT\nk) *R(5,i,j,k)\n488 RRES(3) = RREES(3) + GB(1)*GB(2)*GB(3)*ROCK(3,i,j,k)*R(4,i,j,k)*PVT (6,i,j,k)/PVT(2,x,y,z) + GB(1) *GB(2) *GB(3) *ROCK(3,i,j,k)*R(6,i,j,k )/PVT(7,x,y,z)\n489\tEND\tDO\n490\tEND\tDO\n491\tEND\tDO\n492\tEND\tSUBROUTINE\nAP\u00caNDICE B - Input utilizado nos estudos de caso\nTabela 1 - Caso 1 - Reservat\u00f3rio convencional\nPropriedade\nPress\u00e3o inicial no Datum Vaz\u00e3o do po\u00e7o\nPermeabilidade\nPorosidade\nSatura\u00e7\u00e3o de \u00f3leo\nSatura\u00e7\u00e3o de \u00e1gua\nSatura\u00e7\u00e3o de g\u00e1s\nN\u00famero de blocos\nDimens\u00f5es\nAx\nAy\nAz\nP\n1 cow\nP\n1 cog\nValor utilizado 2500 psi\nRestrito a 1500 BBL/dia\n70 mD\n20%\n50%\n30%\n20%\n500 10x10x5 blocos\n100 ft\n100 ft\n10 ft\n0.9 psi\n0.3 psi\nTabela 2 - Caso 2 - Reservat\u00f3rio com aus\u00eancia de capa de g\u00e1s\nPropriedade\nPress\u00e3o inicial no Datum Vaz\u00e3o do po\u00e7o\nPermeabilidade\nPorosidade\nSatura\u00e7\u00e3o de \u00f3leo\nSatura\u00e7\u00e3o de \u00e1gua\nSatura\u00e7\u00e3o de g\u00e1s\nN\u00famero de blocos\nDimens\u00f5es\nAx\nAy\nAz\nP\n1 cow\nP\nPcog\nValor utilizado 2500 psi\nRestrito a 1500 BBL/dia\n70 mD\n20%\n65%\n35%\n00%\n500 10x10x5 blocos\n100 ft\n100 ft\n10 ft\n0.7 psi\n0.3 psi\nTabela 3 - Reservat\u00f3rio quantidade reduzida de \u00e1gua de forma\u00e7\u00e3o\nPropriedade\nPress\u00e3o inicial no Datum Vaz\u00e3o do po\u00e7o Permeabilidade\nPorosidade\nSatura\u00e7\u00e3o de \u00f3leo\nSatura\u00e7\u00e3o de \u00e1gua\nSatura\u00e7\u00e3o de g\u00e1s\nN\u00famero de blocos\nDimens\u00f5es\nAx\nAy\nAz\nP\n1 cow\nP\n1 cog\nValor utilizado 2500 psi\nRestrito a 1500 BBL/dia\n70 mD\n20%\n75%\n05%\n20%\n500 10x10x5 blocos\n100 ft\n100 ft\n10 ft\n2.3\tpsi\n0.3 psi"}]}}}