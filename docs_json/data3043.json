{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.08155"}, {"@name": "filename", "#text": "12949_001091705.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UFRGS\nUNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL\nUNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL\nESCOLA DE ENGENHARIA\nDEPARTAMENTO DE ENGENHARIA QU\u00cdMICA\nENG07053 - TRABALHO DE DIPLOMA\u00c7\u00c3O EM ENGENHARIA QU\u00cdMICA\nA\ndEQui\nDEPARTAMENTO DE ENGENHARIA QU\u00cdMICA\nAn\u00e1lise de S\u00e9ries Temporais: Compara\u00e7\u00e3o entre modelos preditivos em estudo de caso\nAutor: Thomaz Ochoa Favarini\nOrientador: Jorge O. Trierweiler\nPorto Alegre, dezembro de 18\nAgradecimentos\nRegistro meus agradecimentos aos meus pais, Paulo Eduardo Reus Favarini e Mariza Ochoa Favarini por terem me transmitido seus valores e me concedido as oportunidades necess\u00e1rias para a conclus\u00e3o do curso de Engenharia Qu\u00edmica na Universidade Federal do Rio Grande do Sul\nAgrade\u00e7o \u00e0 UFRGS, que me acolheu e abriu as portas para que eu pudesse ter uma educa\u00e7\u00e3o de excel\u00eancia.\nRegistro meu reconhecimento ao orientador Prof. Dr. Jorge O. Trierweiler pelo aux\u00edlio na busca de meus objetivos e por me guiar durante a elabora\u00e7\u00e3o deste trabalho.\n\u00c0 Alina da Cunha El Jundi por seu companheirismo e compreens\u00e3o ao longo da jornada acad\u00eamica e profissional.\nPor fim, agrade\u00e7o \u00e0s minhas av\u00f3s Claire e Jacira, por todos os exemplos fornecidos ao longo dos anos e pela confian\u00e7a em mim depositada.\nResumo\nA grande disponibilidade de dados dispon\u00edveis permite aos mais diversos setores da economia obter maior volume de informa\u00e7\u00e3o sobre os seus processos. Dentro deste contexto, a an\u00e1lise de s\u00e9ries temporais possibilita aos mesmos uma maneira de aproveitar esta disponibilidade de informa\u00e7\u00e3o de maneira mais eficiente, criando modelos que permitem maximizar o entendimento em rela\u00e7\u00e3o \u00e0s s\u00e9ries temporais e ainda estabelecer rela\u00e7\u00f5es que permitam inferir o comportamento futuro acerca de determinado conjunto de dados. Este trabalho, abordou metodologias que utilizam somente vari\u00e1veis end\u00f3genas para representar as caracter\u00edsticas determin\u00edsticas de uma s\u00e9rie temporal e desta forma obter melhor conhecimento acerca do comportamento dos dados e realizar simula\u00e7\u00f5es preditivas. Para tanto foram utilizadas as metodologias SARIMA, Decomposi\u00e7\u00e3o da s\u00e9rie temporal, e Suaviza\u00e7\u00e3o exponencial. Estas t\u00e9cnicas foram aplicadas a tr\u00eas s\u00e9ries temporais: Evolu\u00e7\u00e3o da concentra\u00e7\u00e3o de CO2 na atmosfera; Evolu\u00e7\u00e3o da varia\u00e7\u00e3o de press\u00e3o em um adsorvedor de umidade de po\u00e7o de petr\u00f3leo offshore; Evolu\u00e7\u00e3o da cota\u00e7\u00e3o da a\u00e7\u00e3o BRKM3. Atrav\u00e9s de compara\u00e7\u00e3o entre as previs\u00f5es realizadas por cada um dos modelos pode-se verificar que a natureza dos processos geradores do conjunto de dados tem grande influ\u00eancia na capacidade preditiva dos modelos, sendo a s\u00e9rie da evolu\u00e7\u00e3o da concentra\u00e7\u00e3o de CO2 na atmosfera a que obteve melhor predi\u00e7\u00e3o do comportamento dos dados originais, apresentando R2 = 0,98. Quanto \u00e0s metodologias de previs\u00e3o, aquela que possuiu melhor desempenho para representar os comportamentos das tr\u00eas s\u00e9ries temporais estudas foram os modelos SARIMA.\nPalavras-chave: S\u00e9ries temporais. SARIMA. Suaviza\u00e7\u00e3o exponencial.\nLista de Ilustra\u00e7\u00f5es\nFigura 1 - Metodologia utilizada para elaborar as previs\u00f5es das s\u00e9ries temporais .......................................................................12\nFigura 2 - M\u00e9todo B, aplicado na realiza\u00e7\u00e3o de forecast via decomposi\u00e7\u00e3o das s\u00e9ries temporais.......................................................13\nFigura 3- M\u00e9todo A, aplicado na realiza\u00e7\u00e3o de forecast via decomposi\u00e7\u00e3o das s\u00e9ries temporais.......................................................13\nFigura 4 - Evolu\u00e7\u00e3o da concentra\u00e7\u00e3o de CO2 em ppm de 1974 a 1985... 21\nFigura 5 - Autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial da evolu\u00e7\u00e3o da concentra\u00e7\u00e3o de CO2.................................................................21\nFigura 6 - Compara\u00e7\u00e3o da concentra\u00e7\u00e3o de CO2 Medida (linha azul) com a concentra\u00e7\u00e3o prevista com o modelo obtido atrav\u00e9s da metodologia A (linha laranja)...............................................................22\nFigura 7 - Autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial dos res\u00edduos gerados pelo m\u00e9todo A...............................................................23\nFigura 8 - Compara\u00e7\u00e3o da concentra\u00e7\u00e3o de CO2 Medida em ppm (linha azul) com a concentra\u00e7\u00e3o prevista com o modelo SARIMA(2,1,0)(0,1,1,12) (linha laranja). .......................................................................24\nFigura 9 - Autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial dos res\u00edduos do modelo gerado pelo modelo SARIMA(2,1,0)(0,1,1,12).............................24\nFigura 10 - Compara\u00e7\u00e3o da concentra\u00e7\u00e3o em ppm de CO2 Medida (linha azul) com a concentra\u00e7\u00e3o prevista pelo modelo de suaviza\u00e7\u00e3o exponencial (linha laranja)...............................................................25\nFigura 11 - Autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial dos res\u00edduos do modelo gerado pelo modelo de suaviza\u00e7\u00e3o exponencial tripla....................26\nFigura 12 - Evolu\u00e7\u00e3o da diferen\u00e7a de press\u00e3o em adsorvedor com amostras de intervalo de 10 minutos................................................27\nFigura 13 - Autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial do delta P at\u00e9 o lag 50.. 28\nFigura 14 - Comportamento sazonal da s\u00e9rie temporal identificado pela Transformada R\u00e1pida de Fourier utilizando 10 harm\u00f4nicas..................29\nFigura 15 - Compara\u00e7\u00e3o da diferen\u00e7a de press\u00e3o medida (linha azul) do conjunto de teste com a diferen\u00e7a de press\u00e3o prevista pela utiliza\u00e7\u00e3o do m\u00e9todo B de decomposi\u00e7\u00e3o (linha laranja)......................................... 29\nFigura 16 - Autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial do delta P dos res\u00edduos at\u00e9 o lag 50.29\nFigura 17 - Histograma dos res\u00edduos indicando que estes n\u00e3o seguem distribui\u00e7\u00e3o normal em torno de 0........................................30\nFigura 18 - Compara\u00e7\u00e3o da diferen\u00e7a de press\u00e3o medida (linha azul) do conjunto de teste com a diferen\u00e7a de press\u00e3o prevista pela utiliza\u00e7\u00e3o do modelo SARIMA (2,0,1)(0,1,0,25) (linha laranja).................................31\nFigura 19 - Autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial dos res\u00edduos gerado pelo modelo de SARIMA (2,0,1)(0,1,0,25) na base de treino.....................31\nFigura 20 - Figura evidenciando a varia\u00e7\u00e3o dos coeficientes AR1, AR2 e MA1 nas 60 simula\u00e7\u00f5es realizadas.............................................32\nFigura 21 - Evolu\u00e7\u00e3o da cota\u00e7\u00e3o da BRKM3 em intervalo di\u00e1rio minutos, conjunto de treino.......................................................33\nFigura 22 -Autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial do pre\u00e7o da a\u00e7\u00e3o at\u00e9 o lag 50.......................................................................33\nFigura 23 - Compara\u00e7\u00e3o da cota\u00e7\u00e3o medida (linha azul) do conjunto de treino com a cota\u00e7\u00e3o prevista pelo modelo ARIMA (2,1,3) (linha laranja).........35\nFigura 24 - Compara\u00e7\u00e3o da cota\u00e7\u00e3o medida (linha azul) do conjunto de treino com a cota\u00e7\u00e3o prevista pelo modelo ARIMA (29,1,9) (linha laranja)........35\nFigura 25 - Autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial dos res\u00edduos do modelo at\u00e9 o lag 50.................................................................36\nFigura 26 - Compara\u00e7\u00e3o de 7 dias da cota\u00e7\u00e3o medida do conjunto de teste (linha azul) com a cota\u00e7\u00e3o prevista pelo modelo ARIMA (29,1,9) (linha laranja) . 37\nFigura 27 - Compara\u00e7\u00e3o entre a primeira derivada do modelo preditivo ARIMA(29,1,9) e a primeira derivada da a\u00e7\u00e3o do conjunto de teste.........37\nFigura 28 - Compara\u00e7\u00e3o de 53 dias da cota\u00e7\u00e3o medida do conjunto de teste (linha azul) com a cota\u00e7\u00e3o prevista pelo modelo ARIMA (29,1,9) (linha laranja). 38\nFigura 29 - Compara\u00e7\u00e3o da cota\u00e7\u00e3o do conjunto de teste (linha azul) com a cota\u00e7\u00e3o prevista pelo modelo de suaviza\u00e7\u00e3o exponencial dupla (linha laranja). . 39\nLista de Tabelas\nTabela 1: Valores m\u00e9dios determinados para cada unidade de tempo do ciclo de 12 meses.........................................................22\nTabela 2\t- Valores determinados dos coeficientes do modelo\nSARIMA(2,1,0)(0,1,1,12).............................................23\nTabela 3 - Coeficientes determinados para o m\u00e9todo da exponencia\u00e7\u00e3o tripla\n....................................................................25\nTabela 4 - Representa\u00e7\u00e3o do range utilizado na otimiza\u00e7\u00e3o do AIC....30\nTabela 5\t- Valores determinados das constantes do modelo\nSARIMA(2,0,1)(0,1,0,25)................................................31\nTabela 6 - Representa\u00e7\u00e3o do range utilizado na otimiza\u00e7\u00e3o do AIC....34\nTabela 7 - Valores determinados dos coeficientes do modelo ARIMA (29,1,9).\n.....................................................................36\nTabela 8 - Coeficientes determinados pelo m\u00e9todo da exponencia\u00e7\u00e3o dupla.38\nLista de S\u00edmbolos\nLista de S\u00edmbolos s\u00e9ries temporais\nxt : Valor observado na s\u00e9rie temporal no instante t\nTt : Estimador da tend\u00eancia da s\u00e9rie temporal no instante t\nSt : Estimador da sazonalidade da s\u00e9rie temporal no instante t\nCt : Estimador do componente c\u00edclico da s\u00e9rie temporal no instante t\nEt : Estimador dos res\u00edduos da s\u00e9rie temporal no instante t\nBm : Par\u00e2metro do ajuste polinomial de ordem m\nEstimador m\u00e9dio de tend\u00eancia de ordem g no instante t\nXt-k: Valor observado na s\u00e9rie temporal no instante t - k\nWt-k: Par\u00e2metro ponderador do instante t - k\nxtj : Valor observado na s\u00e9rie temporal no ciclo \u00ed e posi\u00e7\u00e3o j\nTij : Estimador de tend\u00eancia da s\u00e9rie temporal no ciclo \u00ed e posi\u00e7\u00e3o j\nStj : Estimador de sazonalidade da s\u00e9rie temporal no ciclo \u00ed e posi\u00e7\u00e3o j\nEtj : Estimador dos res\u00edduos da s\u00e9rie temporal no ciclo \u00ed e posi\u00e7\u00e3o j\nm : \u00c9 o total de observa\u00e7\u00f5es em um ciclo completo, \u00e9 o per\u00edodo da sazonalidade aj : \u00c9 o par\u00e2metro obtido pelo m\u00e9todo de regress\u00e3o para a posi\u00e7\u00e3o j dtj : Conjunto de vari\u00e1veis peri\u00f3dicas (Seno, cosseno)\nk : Frequ\u00eancia do sinal peri\u00f3dico, onde: 0 &lt;k &lt;N - 1\nN: Total de observa\u00e7\u00f5es na amostra\nLista de s\u00edmbolos Processos Estacion\u00e1rios\nh : n\u00famero de defasagens da s\u00e9rie temporal\nph: Autocorrela\u00e7\u00e3o defasada em h instantes, onde: -1 &lt;ph &lt;1\ng : M\u00e9dia da amostra\nah: autocorrela\u00e7\u00e3o parcial defasada h instantes, onde:-1&lt;ah<1\na2 : Vari\u00e2ncia caracter\u00edstica de um ru\u00eddo branco\nx( : Primeira diferencia\u00e7\u00e3o da s\u00e9rie temporal\nR2: Coeficiente de determina\u00e7\u00e3o\nxt_m: Vari\u00e1vel x no instante t - m\nLista de S\u00edmbolos Decomposi\u00e7\u00e3o de s\u00e9ries temporais\nI: Total de ciclos que uma posi\u00e7\u00e3o j participou\nLista de S\u00edmbolos Suaviza\u00e7\u00e3o exponencial\na: Fator de suaviza\u00e7\u00e3o\nFt: Previs\u00e3o da s\u00e9rie temporal para o instante t\nXt+1: Previs\u00e3o da s\u00e9rie temporal para o instante t + 1\nft: Fator de suaviza\u00e7\u00e3o da tend\u00eancia\ny: Fator de suaviza\u00e7\u00e3o da sazonalidade\nLista de S\u00edmbolos Modelos ARIMA e SARIMA\n0p: Coeficiente autoregressivo de ordem p\n0q: Coeficiente de m\u00e9dias m\u00f3veis de ordem q\nXt: Previs\u00e3o da s\u00e9rie temporal para o instante t\nk: Intercep\u00e7\u00e3o m\u00e9dia\nAdx: S\u00e9rie temporal diferenciada d vezes\n&amp;SD :S\u00e9rie temporal diferenciada D vezes sazonalmente \u00d4q : Coeficiente de m\u00e9dias m\u00f3veis sazonal de ordem P 0P: Coeficiente autorregressivo sazonal de ordem Q cf2: Vari\u00e2ncia residual\nyt: Dados originais\nyt: Valor m\u00e9dio do conjunto de dados originais\nyt: Valores gerados pelo modelo\nk: N\u00famero total de par\u00e2metros a serem estimados\nT: N\u00famero total de par\u00e2metros a serem estimados\nLista de Abreviaturas e Siglas\nADF -Augmented Dickey-Fuller\nAIC - Akaike's Information Criterion\nAR - Autoregressive\nARIMA - Autoregressive Integrated Moving Average\nARMA - Autoregressive Moving Average\nCorr - Correla\u00e7\u00e3o\nDFT - Discrete Fourier Transform\nFFT - Fast Fourier Transform\nI\t- Integrated\nLSE - Least Squares Estimation\nMA - Moving Average\nMIN - Minimize function\nSARIMA - Seasonal Autoregressive Integrated Moving Average\nSSE - Sum Squared Error\nSum\u00e1rio\nAgradecimentos\tii\nResumo\tiii\nLista de Ilustra\u00e7\u00f5es\tiv\nLista de Tabelas\tvii\nLista de S\u00edmbolos\tviii\nLista de Abreviaturas e Siglas\txi\nSum\u00e1rio\txii\n1\tIntrodu\u00e7\u00e3o\t1\n2\tRevis\u00e3o Bibliogr\u00e1fica\t3\n2.1\tTend\u00eancia\t3\n2.1.1\tTend\u00eancia polinomial\t4\n2.1.2\tSuaviza\u00e7\u00e3o\t4\n2.1.2.1\tM\u00e9dia m\u00f3vel (MA)\t4\n2.1.2.2\tM\u00e9dia m\u00f3vel ponderada (WMA).\t5\n2.2\tSazonalidade\t6\n2.2.1\tM\u00e9todo de regress\u00e3o\t6\n2.2.2\tTransformada r\u00e1pida de Fourier\t7\n2.3\tProcessos estacion\u00e1rios\t7\n2.3.1\tOutros m\u00e9todos de estacionariza\u00e7\u00e3o\t9\n2.3.1.1\tDiferencia\u00e7\u00e3o\t9\n2.3.1.2\tDiferencia\u00e7\u00e3o sazonal\t9\n3\tMetodologia\t11\n3.1\tPr\u00e9-tratamento das s\u00e9ries temporais\t11\n3.2\tVisualizar as s\u00e9ries temporais\t12\n3.3\tDefinir e aplicar modelos de previs\u00e3o\t12\n3.3.1\tDecomposi\u00e7\u00e3o de s\u00e9ries temporais\t12\n3.3.1.1\tM\u00e9todo A\t13\n3.3.1.2\tM\u00e9todo B\t14\n3.3.2\tSuaviza\u00e7\u00e3o exponencial\t14\n3.3.2.1\tSuaviza\u00e7\u00e3o exponencial simples.\t15\n3.3.2.2\tSuaviza\u00e7\u00e3o exponencial de Holt\t15\n3.3.2.3\tSuaviza\u00e7\u00e3o exponencial tripla\t16\n3.3.3\tModelos ARIMA e SARIMA\t16\n3.3.3.1\tModelos autoregressivos\t16\n3.3.3.2\tModelos de m\u00e9dia m\u00f3vel\t17\n3.3.3.3\tModelos autoregressivos e de m\u00e9dia m\u00f3vel ARMA17\n3.3.3.4\tModelos ARIMA\t17\n3.3.3.5\tModelos SARIMA\t18\n3.4\tCrit\u00e9rios de avalia\u00e7\u00e3o dos resultados obtidos\t18\n4\tEstudo de Caso\t20\n4.1\tEvolu\u00e7\u00e3o da concentra\u00e7\u00e3o de CO2\t20\n4.1.1\tPr\u00e9-tratamento da s\u00e9rie temporal\t20\n4.1.2\tVisualizar a s\u00e9rie temporal\t21\n4.1.3\tDefinir e aplicar modelos de previs\u00e3o\t21\n4.1.3.1\tDecomposi\u00e7\u00e3o da s\u00e9rie temporal, M\u00e9todo A\t22\n4.1.3.2\tSARIMA\t23\n4.1.3.3\tSuaviza\u00e7\u00e3o exponencial tripla\t25\n4.1.4\tAvaliar resultados obtidos\t26\n4.1.5\tPrevis\u00f5es de longo prazo\t26\n4.2\tDiferen\u00e7a de press\u00e3o em um adsorvedor\t27\n4.2.1\tPr\u00e9-tratamento da s\u00e9rie temporal\t27\n4.2.2\tVisualizar a s\u00e9rie temporal\t27\n4.2.3\tDefinir e aplicar modelos de previs\u00e3o\t28\n4.2.3.1\tDecomposi\u00e7\u00e3o da s\u00e9rie temporal, M\u00e9todo B\t28\n4.2.3.2\tSARIMA\t30\n4.2.4\tAvaliar resultados obtidos\t32\n4.2.5\tAvalia\u00e7\u00e3o da din\u00e2mica da s\u00e9rie temporal\t32\n4.3\tEvolu\u00e7\u00e3o\tda\tcota\u00e7\u00e3o\tda a\u00e7\u00e3o\tBRKM3\t32\n4.3.1\tPr\u00e9-tratamento da s\u00e9rie temporal\t32\n4.3.2\tVisualizar a s\u00e9rie temporal\t33\n4.3.3\tDefinir e aplicar modelos de previs\u00e3o\t34\n4.3.3.1\tSARIMA\t34\n4.3.3.2\tSuaviza\u00e7\u00e3o exponencial dupla\t38\n4.3.4\tAvaliar resultados obtidos\t39\n5\tConclus\u00f5es\te Sugest\u00f5es para Trabalhos Futuros\t40\nRefer\u00eancias\t42\nAp\u00eandice A\t44\n1\tIntrodu\u00e7\u00e3o\nUma s\u00e9rie temporal pode ser definida como a sequ\u00eancia de observa\u00e7\u00f5es sucessivas tomadas ao longo do tempo (BOX; JENKINS; REINSEL, 2008) estas s\u00e9ries s\u00e3o encontradas nas mais variadas \u00e1reas como na engenharia, medicina, neg\u00f3cios, economia e ci\u00eancias sociais, alguns exemplos de observa\u00e7\u00f5es no tempo s\u00e3o: medi\u00e7\u00e3o da press\u00e3o encontrada em po\u00e7os de petr\u00f3leo offshore tomada de hora em hora, apura\u00e7\u00f5es mensais das temperaturas m\u00e9dias de Porto Alegre, vendas mensais de petr\u00f3leo, \u00edndices di\u00e1rios da bolsa de valores e assim sucessivamente.\nA an\u00e1lise das s\u00e9ries temporais, por sua vez, tamb\u00e9m possui importantes aplica\u00e7\u00f5es que se estendem em todos os setores onde h\u00e1 a ocorr\u00eancia das s\u00e9ries temporais. Alguns dos objetivos destas an\u00e1lises podem ser: Investigar o mecanismo gerador da s\u00e9rie temporal; obter melhor entendimento sobre o comportamento da s\u00e9rie; estimar fun\u00e7\u00f5es de transfer\u00eancia (relacionando entradas e sa\u00eddas), analisar os efeitos de eventos n\u00e3o usuais em um sistema; controle de processos; e realizar previs\u00f5es dos valores futuros das s\u00e9ries temporais (BOX; JENKINS; REINSEL, 2008), que \u00e9 o foco do presente trabalho.\nEm um cen\u00e1rio altamente competitivo a busca pelo aumento de efici\u00eancia e produtividade \u00e9 fundamental para a sobreviv\u00eancia das organiza\u00e7\u00f5es. Um dos meios para atuar neste quesito \u00e9 entender de maneira mais clara quais ser\u00e3o os eventos futuros aos quais a empresa ou os setores estar\u00e3o submetidos e, de posse deste conhecimento, agir de maneira antecipava para obter o melhor aproveitamento. Isto \u00e9 valido para in\u00fameras situa\u00e7\u00f5es, por exemplo: decidir o melhor per\u00edodo para realizar a substitui\u00e7\u00e3o/otimiza\u00e7\u00e3o de um equipamento; aumentar ou diminuir a utiliza\u00e7\u00e3o da capacidade produtiva fabril; otimizar estoques; decidir qual o melhor momento para adquirir ou vender um ativo; obter melhor entendimento dos fen\u00f4menos, interpretando situa\u00e7\u00f5es que diferem da prevista; entre outras.\nA realiza\u00e7\u00e3o de previs\u00f5es em rela\u00e7\u00e3o a eventos futuros das s\u00e9ries temporais utiliza a caracter\u00edstica de depend\u00eancia entre as sucessivas observa\u00e7\u00f5es ao longo do tempo (BOX; JENKINS; REINSEL, 2008). Deste modo, o conhecimento da estrutura internas das s\u00e9ries temporais e o estabelecimento de t\u00e9cnicas para capturar e entender esta depend\u00eancia s\u00e3o fundamentais.\nEste trabalho tem como objetivo comparar tr\u00eas m\u00e9todos de previs\u00e3o de s\u00e9ries temporais, utilizando somente vari\u00e1veis end\u00f3genas, em tr\u00eas conjuntos de dados distintos. A avalia\u00e7\u00e3o da qualidade do modelo ser\u00e1 feita visualmente pela compara\u00e7\u00e3o gr\u00e1fica dos valores previstos pelos realizados, quantitativamente atrav\u00e9s do indicador do coeficiente de determina\u00e7\u00e3o e realizando avalia\u00e7\u00e3o dos res\u00edduos, por meio da utiliza\u00e7\u00e3o do teste Aumented Dickey Fuler e das fun\u00e7\u00f5es de autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial para verificar se os res\u00edduos seguem modelo estacion\u00e1rio.\nA estrutura do texto \u00e9 dividida em seis cap\u00edtulos: o Cap\u00edtulo 1 \u00e9 a introdu\u00e7\u00e3o, que apresenta a defini\u00e7\u00e3o de s\u00e9rie temporal, as motiva\u00e7\u00f5es e os objetivos do trabalho; O Cap\u00edtulos 2 aborda revis\u00e3o bibliogr\u00e1fica, o tema central \u00e9 a representa\u00e7\u00e3o e identifica\u00e7\u00e3o dos componentes de uma s\u00e9rie temporal; o Cap\u00edtulo 3 aborda as metodologias utilizadas para realizar a previs\u00e3o de s\u00e9ries temporais; no Cap\u00edtulo 4 s\u00e3o apresentadas e analisadas as s\u00e9ries temporais e o resultado dos modelos \u00e9 avaliado. No Cap\u00edtulo 5 s\u00e3o sintetizadas as principais conclus\u00f5es do trabalho e s\u00e3o feitas recomenda\u00e7\u00f5es para a realiza\u00e7\u00e3o de trabalhos futuros.\n2\tRevis\u00e3o Bibliogr\u00e1fica\nUma s\u00e9rie temporal \u00e9 composta por uma ou mais das seguintes estruturas internas:\n= Tt + St + Ct + Et\n\u2022\tTend\u00eancia (Tt): \u00e9 o movimento de aumento ou diminui\u00e7\u00e3o da vari\u00e1vel observada ao longo do tempo.\n\u2022\tSazonalidade (St): s\u00e3o movimentos peri\u00f3dicos e repetitivos presentes em uma s\u00e9rie temporal.\n\u2022\tComponente c\u00edclico (Ct): s\u00e3o movimentos peri\u00f3dicos menos frequentes que a sazonalidade e podem n\u00e3o apresentar um per\u00edodo de varia\u00e7\u00e3o fixo (PAL; PRAKASH, 2017).\n\u2022\tRes\u00edduos (Et): Este componente n\u00e3o \u00e9 dependente do tempo e representa a por\u00e7\u00e3o irredut\u00edvel da fun\u00e7\u00e3o que o modelo n\u00e3o consegue contabilizar (PAL; PRAKASH, 2017) segundo BROCKWELL e DAVIS (1996), este res\u00edduo deve se comportar conforme um ru\u00eddo branco.\nOnde xt representa a vari\u00e1vel x no instante de tempo t.\n2.1\tTend\u00eancia\nTend\u00eancia \u00e9 o movimento de incremento ou decr\u00e9scimo do valor da fun\u00e7\u00e3o ao longo do tempo. Esta caracter\u00edstica das s\u00e9ries temporais pode ser percebida analisando visualmente os dados atrav\u00e9s de um gr\u00e1fico da vari\u00e1vel observada em fun\u00e7\u00e3o do tempo (PAL; PRAKASH, 2017). Como uma defini\u00e7\u00e3o quantitativa, pode-se definir a tend\u00eancia como sendo a mudan\u00e7a de longo prazo na m\u00e9dia da fun\u00e7\u00e3o temporal (CHATFIELD, 2000).\nH\u00e1 v\u00e1rios m\u00e9todos para realizar a estima\u00e7\u00e3o da fun\u00e7\u00e3o de tend\u00eancia Tt (MORETTIN; TOLOI, 2006) e estes se dividem em dois grupos principais:\n\u2022\tRegress\u00e3o param\u00e9trica: Ajustar uma s\u00e9rie temporal utilizando uma fun\u00e7\u00e3o descrita utilizando par\u00e2metros finitos. Como uma fun\u00e7\u00e3o polinomial, exponencial modelos ARMA, ARIMA e SARIMA.\n\u2022\tRegress\u00e3o n\u00e3o param\u00e9trica: Neste tipo de regress\u00e3o n\u00e3o \u00e9 necess\u00e1rio realizar estimativa de par\u00e2metros para realizar a regress\u00e3o. S\u00e3o exemplos dessa classe a m\u00e9dia m\u00f3vel, Regress\u00e3o kernel, regress\u00e3o polinomial local, regress\u00e3o splines, wavelet, entre outras.\nNeste trabalho a tend\u00eancia ser\u00e1 estimada utilizando os seguintes m\u00e9todos:\n\u2022\nPolinomial;\n\u2022 M\u00e9dia m\u00f3vel;\n\u2022 M\u00e9dia m\u00f3vel ponderada.\n2.1.1\tTend\u00eancia polinomial\nAo realizar uma estima\u00e7\u00e3o por tend\u00eancia polinomial, o objetivo \u00e9 modelar a s\u00e9rie temporal utilizando um polin\u00f3mio que ter\u00e1 seus coeficientes determinados atrav\u00e9s do ajuste por m\u00ednimos quadrados (LSE). Desta forma, \u00e9 identificado o polin\u00f3mio que melhor se adequa aos dados que est\u00e3o sendo utilizados (BROCKWELL; DAVIS, 1996).\nLSE = MIN\nn\n- W\nt=1\n2\nTt = Bo+ Bit + \u2014F Bmtm\nOnde Bm \u00e9 o par\u00e2metro de ordem m determinado por LSE.\n2.1.2\tSuaviza\u00e7\u00e3o\nAo representar a tend\u00eancia por um polin\u00f3mio s\u00e3o utilizadas todas as observa\u00e7\u00f5es para elaborar a fun\u00e7\u00e3o que representar\u00e1 a tend\u00eancia durante todo o intervalo de tempo. Uma outra alternativa consiste na utiliza\u00e7\u00e3o apenas de um conjunto de dados pr\u00f3ximos, dentro de uma janela menor de dados. A ideia \u00e9 que em um instante t a tend\u00eancia ser\u00e1 estimada usando-se as observa\u00e7\u00f5es Zs ao redor de t (MORETTIN; TOLOI, 2006). Enquadram-se nessa categoria os m\u00e9todos de M\u00e9dia M\u00f3vel (\u201cmoving average\u201d, MA) e M\u00e9dia M\u00f3vel Ponderada (\u201cweighted moving average\u201d, WMA), os quais ser\u00e3o apresentados nas pr\u00f3ximas subse\u00e7\u00f5es.\n2.1.2.1\tM\u00e9dia m\u00f3vel (MA)\nA realiza\u00e7\u00e3o da m\u00e9dia m\u00f3vel tem como efeito suavizar a s\u00e9rie temporal, reduzindo o seu ru\u00eddo.\nT(g)t =\tXt-k + Xt-k+1 1\t+Xt + Xt+k-1 + Xt+k 2k+ 1\nOnde a tend\u00eancia m\u00e9dia \u00e9 representada por T(g)t, o intervalo considerado \u00e9 t \u00b1 k e k equivale ao alcance da m\u00e9dia. A ordem da m\u00e9dia m\u00f3vel \u00e9 calculada como g = 2k + 1.\nA ordem da m\u00e9dia m\u00f3vel pode ser \u00edmpar (sim\u00e9trica) ou par (assim\u00e9trica), para tornar a s\u00e9rie sim\u00e9trica \u00e9 necess\u00e1rio realizar a m\u00e9dia duas vezes.\nr(2)t =\t_xt-1 + xt \u2019 2\n, V f(2) -\t_ 1\t+ 2Xt + Xt+1\n' 2 2( 2\n\u00c9 importante apontar que a repeti\u00e7\u00e3o da m\u00e9dia m\u00f3vel causa uma pondera\u00e7\u00e3o, aumentando o peso dos valores mais recentes (Xt)(PAL; PRAKASH, 2017). Em s\u00e9ries onde a sazonalidade \u00e9 presente para elimin\u00e1-la basta considerar o per\u00edodo da sazonalidade na ordem e repeti\u00e7\u00e3o da m\u00e9dia m\u00f3vel, ou seja, para dados com sazonalidade anual a remo\u00e7\u00e3o da sazonalidade \u00e9 feita realizando a seguinte m\u00e9dia m\u00f3vel 2%Tt\t, em dados com sazonalidade semanal a remo\u00e7\u00e3o dessa sazonalidade\n(7)\n\u00e9 realizada com a m\u00e9dia Tt .\n2.1.2.2\tM\u00e9dia m\u00f3vel ponderada (WMA).\nSegundo PAL e PRAKASH (2017) pode-se optar por utilizar a m\u00e9dia m\u00f3vel ponderada uma vez que esta suaviza a s\u00e9rie temporal considerando maior peso para os dados mais pr\u00f3ximos do valor calculado.\nRepresenta\u00e7\u00e3o matem\u00e1tica da m\u00e9dia m\u00f3vel ponderada:\nT = Xt-kWt-k + Xt-k+1Wt-k+1 +---+XtWt + Xt+k-iWt+K-1 + Xt+kWt+K\nOnde:\nWt-fc + Wf-fc+1 +-+\t+ ^t+K-1 + Wf+K = 1\nApesar da m\u00e9dia m\u00f3vel e a m\u00e9dia m\u00f3vel ponderada serem boas ferramentas para visualizar e identificar a tend\u00eancia de maneira mais clara, segundo BROCKWELL e\nDAVIS (1996) elas n\u00e3o s\u00e3o \u00fateis para elabora\u00e7\u00e3o de modelos preditivos uma vez que elas levam em considera\u00e7\u00e3o tantos valores passados quanto futuros.\n2.2\tSazonalidade\nSazonalidade refere-se a movimentos peri\u00f3dicos repetitivos presentes em s\u00e9ries temporais e que podem ser modelados como a soma de ondas senoidais de per\u00edodo conhecido. Uma caracter\u00edstica das s\u00e9ries sazonais \u00e9 a alta autocorrela\u00e7\u00e3o que estas apresentam em lags sazonais, isto \u00e9, em lags m\u00faltiplos do per\u00edodo m. Um bom procedimento de captura da sazonalidade deve ser capaz de remover grande parte desta correla\u00e7\u00e3o (MORETTIN; TOLOI, 2006).\nUma s\u00e9rie temporal pode ser representada da seguinte forma:\nxij = T[j + Sij + Eij\nOnde os \u00edndices \u00ed e j representam a quantidade de ciclos e a posi\u00e7\u00e3o dentro de um ciclo respectivamente. Se o padr\u00e3o sazonal n\u00e3o variar muito ao longo dos anos, a equa\u00e7\u00e3o \u00e9 simplificada para:\nDentre os m\u00e9todos utilizados para estimar a sazonalidade, deve-se citar o m\u00e9todo de regress\u00e3o, o m\u00e9todo das m\u00e9dias m\u00f3veis e o da transformada r\u00e1pida de Fourier.\nNeste trabalho ser\u00e1 abordado o m\u00e9todo de regress\u00e3o e o da transformada r\u00e1pida de Fourier.\n2.2.1\tM\u00e9todo de regress\u00e3o\nEstes modelos s\u00e3o utilizados quando a periodicidade da sazonalidade \u00e9 conhecida, ou seja, nas s\u00e9ries \u00e0s quais devido ao seu comportamento constante da sazonalidade, permitem prever a sazonalidade com base nos meses anteriores (MORETTIN; TOLOI, 2006).\nConsiderando que a s\u00e9rie n\u00e3o apresente componente de tend\u00eancia:\nm\njdjt\nj=1\nOnde djt s\u00e3o as vari\u00e1veis peri\u00f3dicas (senos, cossenos ou vari\u00e1veis sazonais).\nComo foi considerada sazonalidade constante, aj independe de t. Desta maneira,\ntemos que, para t correspondente a uma posi\u00e7\u00e3o espec\u00edfica j dentro do ciclo, djt \u00e9 igual a 1 e 0 caso contr\u00e1rio.\nDessa maneira, utilizando o m\u00e9todo dos m\u00ednimos quadrados \u00e9 poss\u00edvel determinar o vetor dos m valores de a (MORETTIN; TOLOI, 2006), onde m representa o total de observa\u00e7\u00f5es dentro de um ciclo completo.\n2.2.2\tTransformada r\u00e1pida de Fourier\nEsta metodologia \u00e9 baseada na possibilidade do componente sazonal poder ser representado como um sinal peri\u00f3dico em um tempo discreto e com a utiliza\u00e7\u00e3o de uma s\u00e9rie de Fourier converter em uma combina\u00e7\u00e3o linear de harm\u00f4nicos de uma dada frequ\u00eancia fundamental (MARTELOTTE, 2014).\nPara calcular a transformada discreta de Fourier \u00e9 utilizada a seguinte equa\u00e7\u00e3o:\nN\nOnde k representa a frequ\u00eancia de 0 a N - 1, n \u00e9 o \u00edndice de tempo,N representa o n\u00famero de observa\u00e7\u00f5es na amostra DFT(x) \u00e9 a transformada discreta de Fourier (DOWNEY, 2016).\nNeste trabalho, a transformada de Fourier ser\u00e1 calculada atrav\u00e9s do algoritmo da Transformada R\u00e1pida de Fourier, o qual reduz significativa o tempo para computar convers\u00f5es do dom\u00ednio do tempo para da frequ\u00eancia (STREMLER, 1990, apud LEWIS; HERBERT; BELL, 2003).\n2.3\tProcessos estacion\u00e1rios\nSe uma s\u00e9rie temporal pode ser prevista exatamente pelos valores passados, esta \u00e9 classificada como determin\u00edstica. No entanto, na maioria dos casos, a maior parte das s\u00e9ries temporais apresentam uma parcela significativa com caracter\u00edsticas estoc\u00e1sticas, e nestas somente parte do futuro \u00e9 determinado pelos valores passados (CHATFIELD, 2000).\nAo representar uma s\u00e9rie temporal pela adi\u00e7\u00e3o das parcelas determin\u00edsticas, atrav\u00e9s das fun\u00e7\u00f5es dos componentes internos (tend\u00eancia, sazonalidade, componente c\u00edclico), e subtrair estes componentes das observa\u00e7\u00f5es medidas, \u00e9 obtido res\u00edduo n\u00e3o nulo devido \u00e0s caracter\u00edsticas estoc\u00e1sticas da s\u00e9rie temporal.\nDeste modo, um bom modelo de previs\u00e3o deve ser capaz de gerar um res\u00edduo que se comporte como uma sequ\u00eancia de vari\u00e1veis aleat\u00f3rias n\u00e3o correlacionadas, com m\u00e9dia zero e vari\u00e2ncia a2. Este tipo de sequ\u00eancia temporal \u00e9 conhecido como ru\u00eddo branco (BROCKWELL; DAVIS, 1996), veremos no pr\u00f3ximo par\u00e1grafo que o ru\u00eddo branco devido \u00e0 sua m\u00e9dia e vari\u00e2ncia \u00e9 tamb\u00e9m classificado como estacion\u00e1rio (BROCKWELL; DAVIS, 1996), caracter\u00edstica importante que indica boa modelagem da parte determin\u00edstica da s\u00e9rie temporal.\nNeste trabalho, foi considerada estacion\u00e1ria toda fun\u00e7\u00e3o que possui m\u00e9dia e vari\u00e2ncia constantes e finitas (GUIDOLIN; PEDIO, 2018).\nDevido \u00e0 dificuldade de identificar se estas vari\u00e1veis s\u00e3o constantes ao longo da s\u00e9rie temporal, s\u00e3o utilizadas outras ferramentas para analisar se o conjunto de dados \u00e9 ou n\u00e3o estacion\u00e1rio. Tr\u00eas ferramentas comumente utilizadas s\u00e3o as fun\u00e7\u00f5es de autocorrela\u00e7\u00e3o, autocorrela\u00e7\u00e3o parcial e o teste Augmented Dickey-Fuller- ADF (MACKINNON, 2010).\nA fun\u00e7\u00e3o autocorrela\u00e7\u00e3o reflete o grau de depend\u00eancia linear de uma s\u00e9rie temporal em diferentes tempos, ou ainda, indica a correla\u00e7\u00e3o da s\u00e9rie temporal com ela mesma defasada em h instantes de tempo. Dada uma amostra de N observa\u00e7\u00f5es da vari\u00e1vel x a autocorrela\u00e7\u00e3o (ph) pode ser calculada utilizando a seguinte equa\u00e7\u00e3o (GUIDOLIN; PEDIO, 2018):\nEtN=h+i(xt - Q)(xt_h - u)\nStN=h+i(Xt - u)2\nNa qual a m\u00e9dia, u , da amostra \u00e9 representada por:\nN\nu=N-y\nt=i\nA fun\u00e7\u00e3o autocorrela\u00e7\u00e3o parcial entre um instante xt ext_h \u00e9 a autocorrela\u00e7\u00e3o entre estas vari\u00e1veis condicionado \u00e0s intera\u00e7\u00f5es xt-1,xt_2, ...,xt_h+1, isto \u00e9, a autocorrela\u00e7\u00e3o depois de removida a rela\u00e7\u00e3o entre a variabilidade j\u00e1 explicada entre os instantes xt-1e xt_h+1. Formalmente a autocorrela\u00e7\u00e3o parcial \u00e9 descrita pela seguinte equa\u00e7\u00e3o (GUIDOLIN; PEDIO, 2018):\nah = Corr(xt,xt_h|xt_1,^,xt_h+i)\nDe acordo com teste ADF na presen\u00e7a de autocorrela\u00e7\u00e3o, a diferencia\u00e7\u00e3o de primeira ordem de uma s\u00e9rie temporal xt pode ser representada como uma regress\u00e3o linear de instantes de tempo anteriores e dos diferenciais de primeira ordem at\u00e9 um atraso (lag) de \u00edndice m. A regress\u00e3o pode ser descrita pela seguinte equa\u00e7\u00e3o (PAL; PRAKASH, 2017):\nxt = yxt-i + Pixt-i + - + Phx\u00ed-h + Et\nh\nY = (-l +\t0 )\ni=1\nSe a s\u00e9rie for n\u00e3o estacion\u00e1ria ela apresentar\u00e1 raiz unit\u00e1ria (y = (-1 + ^\u00ed=1 0\u00ed ) = 0) e a hip\u00f3tese nula ser\u00e1 aceita. Caso contr\u00e1rio a s\u00e9rie \u00e9 dita estacion\u00e1ria e a hip\u00f3tese nula \u00e9 rejeitada (PAL; PRAKASH, 2017).\nComo ser\u00e1 exemplificado no decorrer do trabalho na se\u00e7\u00e3o 3.3.1,0 s\u00e3o os coeficientes de regress\u00e3o do modelo.\n2.3.1\tOutros m\u00e9todos de estacionariza\u00e7\u00e3o\nQuando a remo\u00e7\u00e3o de tend\u00eancia e da sazonalidade n\u00e3o s\u00e3o suficientes para transformar a s\u00e9rie temporal em estacion\u00e1ria dois m\u00e9todos s\u00e3o comumente aplicados:\n2.3.1.1\tDiferencia\u00e7\u00e3o\nA ideia fundamental da diferencia\u00e7\u00e3o \u00e9 realizar a diferen\u00e7a entre dois pontos sucessivos de uma s\u00e9rie temporal de maneira que a diferen\u00e7a tenha m\u00e9dia e vari\u00e2ncia constantes e, desta forma, a s\u00e9rie temporal poder ser tratada como estacion\u00e1ria.\nx( = xt \u2014 xt-1 = c + Et\nNos casos em que a primeira diferencia\u00e7\u00e3o n\u00e3o tornar a s\u00e9rie estacion\u00e1ria, podem ser realizadas sucessivas diferencia\u00e7\u00f5es (PAL; PRAKASH, 2017).\n2.3.1.2\tDiferencia\u00e7\u00e3o sazonal\nA diferencia\u00e7\u00e3o sazonal \u00e9 utilizada quando a s\u00e9rie temporal apresenta car\u00e1ter sazonal e o per\u00edodo, m, da sazonalidade \u00e9 conhecido. Desta forma o conjunto de observa\u00e7\u00f5es pode ser convertido em estacion\u00e1rio realizando a diferencia\u00e7\u00e3o entre xt e xt-m.\nx\nrm t\n= Xt\nxt-m = Et\nOnde Et representa o erro e x'tm, a diferencia\u00e7\u00e3o sazonal, que deve comportar-se como um ru\u00eddo branco (PAL; PRAKASH, 2017).\n3\tMetodologia\nA metodologia utilizada na elabora\u00e7\u00e3o do trabalho est\u00e1 ilustrada na Figura 1. As simula\u00e7\u00f5es foram realizadas utilizando os pacotes Pandas, Numpy e Statsmodels da programa\u00e7\u00e3o em Python.\n3.1\tPr\u00e9-tratamento das s\u00e9ries temporais\nEm um primeiro momento, \u00e9 preciso obter as bases de dados que ser\u00e3o analisadas. Como na maioria dos casos s\u00e3o utilizados dados que foram gerados com outros objetivos, cinco etapas se tornam necess\u00e1rias:\n\u2022\tDefinir tamanho da amostra: Nas an\u00e1lises de s\u00e9ries temporais deste trabalho s\u00e3o feitos estudos sobre intervalos discretos. Portanto, a correta amostragem \u00e9 fundamental para que possa ser realizada uma boa simula\u00e7\u00e3o dos dados. Quando a base de dados obtida possui tamanho superior ao desejado, comumente se agrupa a s\u00e9rie temporal em valores m\u00e9dios de um conjunto de observa\u00e7\u00f5es (visando a remo\u00e7\u00e3o de oscila\u00e7\u00f5es que influenciariam como ru\u00eddos) ou se remove uma quantidade de pontos da amostra em intervalos de tempo constante, ou seja, se efetua uma re-amostragem.\n\u2022\tRemover vazios: A remo\u00e7\u00e3o dos dados nulos (ou not-a-number) tamb\u00e9m \u00e9 fundamental, uma vez que grande parte dos modelos n\u00e3o simulam de maneira adequada quando estes est\u00e3o presentes.\n\u2022\tRemover outliers: Para que a visualiza\u00e7\u00e3o e as previs\u00f5es n\u00e3o sejam prejudicadas \u00e9 importante realizar a remo\u00e7\u00e3o de outlier. Para tanto, podem ser utilizados diferentes m\u00e9todos como filtros por frequ\u00eancia das observa\u00e7\u00f5es ou por filtros em percentil elevado. Devido ao escopo estes m\u00e9todos n\u00e3o ser\u00e3o focados ao longo deste trabalho.\n\u2022\tDefinir coluna de tempo: Para realizar as simula\u00e7\u00f5es \u00e9 importante que a coluna dos dados cronol\u00f3gicos que s\u00e3o utilizados no eixo das abscissas seja de f\u00e1cil entendimento sendo frequentemente necess\u00e1rio converter ao formato desejado.\n\u2022\tSegmentar os dados em conjuntos de treino e teste: Para construir o modelo \u00e9 importante separar a base que ser\u00e1 usada para a elabora\u00e7\u00e3o do modelo (base de treino) e a que ser\u00e1 utilizada para verificar se a predi\u00e7\u00e3o obteve bons resultados (base de teste).\nFigura 1- Metodologia utilizada para elaborar as previs\u00f5es das s\u00e9ries temporais\n3.2\tVisualizar as s\u00e9ries temporais\nNesta etapa os componentes internos (tend\u00eancia, sazonalidade, componente c\u00edclico) das s\u00e9ries temporais s\u00e3o identificados e tamb\u00e9m s\u00e3o obtidos os valores das fun\u00e7\u00f5es de autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial. Este procedimento \u00e9 fundamental para defini\u00e7\u00e3o dos modelos de previs\u00e3o que ser\u00e3o utilizados.\n3.3\tDefinir e aplicar modelos de previs\u00e3o\nNeste trabalho foram abordados os seguintes modelos visando a estima\u00e7\u00e3o de valores futuros para as s\u00e9ries temporais:\n\u2022\tDecomposi\u00e7\u00e3o das s\u00e9ries temporais;\n\u2022\tSuaviza\u00e7\u00e3o exponencial;\n\u2022\tModelos ARIMA e SARIMA.\n3.3.1\tDecomposi\u00e7\u00e3o de s\u00e9ries temporais\nEstes modelos t\u00eam como principal caracter\u00edstica decompor as s\u00e9ries temporais em seus principais componentes: tend\u00eancia, sazonalidade e erro e a partir das fun\u00e7\u00f5es determinadas construir um modelo de previs\u00e3o.\nNeste trabalho foram constru\u00eddos modelos de previs\u00e3o por decomposi\u00e7\u00e3o das s\u00e9ries temporais realizando os seguintes procedimentos em dois m\u00e9todos distintos, conforme ilustrado na Figura 2 e na Figura 3.\nFigura 3- M\u00e9todo A, aplicado na realiza\u00e7\u00e3o de forecast via decomposi\u00e7\u00e3o das s\u00e9ries temporais\nFigura 2 - M\u00e9todo B, aplicado na realiza\u00e7\u00e3o de forecast via decomposi\u00e7\u00e3o das s\u00e9ries temporais\n3.3.1.1\tM\u00e9todo A\nConsiderando que na s\u00e9rie temporal n\u00e3o haja componente c\u00edclica, a sua equa\u00e7\u00e3o pode ser representada por:\n\u2014 Tt + St + Et\nA tend\u00eancia Tt \u00e9 determinada utilizando um dos procedimentos apresentados no cap\u00edtulo 2.1.\nEm seguida, \u00e9 realizada a remo\u00e7\u00e3o da tend\u00eancia conhecida da s\u00e9rie original.\nxt\t\u2014 St + Et\nOs res\u00edduos (sazonalidade e erro) s\u00e3o agrupados com base no per\u00edodo m da sazonalidade. Desta maneira ter\u00e1 um valor caracter\u00edstico para cada uma das observa\u00e7\u00f5es dependendo com a posi\u00e7\u00e3o dele referente \u00e0 curva de sazonalidade.\nAo utilizar este m\u00e9todo, assume-se que a sazonalidade \u00e9 constante e n\u00e3o tem sua amplitude alterada ao longo dos anos.\nDeste modo a sazonalidade caracter\u00edstica de cada um dos instantes dentro do per\u00edodo m \u00e9 representada pela seguinte equa\u00e7\u00e3o:\ni\ni=i\nOnde j = 1,2, ...,m em que m representa o per\u00edodo da sazonalidade,/ representa o total de ciclos em que um determinado j participou e \u00ed representa um ciclo completo.\nPor fim o modelo \u00e9 ent\u00e3o definido como:\n3.3.1.2\tM\u00e9todo B\nConsiderando que na s\u00e9rie temporal n\u00e3o exista componente c\u00edclica, a sua equa\u00e7\u00e3o pode ser representada por:\n\u2014 Tt + St + Et\nA tend\u00eancia Tt e a sazonalidade St s\u00e3o determinadas utilizando um dos procedimentos apresentados no Cap\u00edtulo 2.1 e 2.2 respectivamente.\nPor fim ambos as equa\u00e7\u00f5es s\u00e3o adicionadas e a previs\u00e3o \u00e9 realizada utilizando a seguinte equa\u00e7\u00e3o:\nxt \u2014 Tt+ St\n3.3.2\tSuaviza\u00e7\u00e3o exponencial\nNestes modelos os dados passados de uma s\u00e9rie temporal s\u00e3o utilizados de maneira ponderada a fim da realiza\u00e7\u00e3o de previs\u00f5es. Segundo MORETTIN E TOLOI (2006), t\u00e9cnicas espec\u00edficas deste tipo assumem que os valores extremos da s\u00e9rie representam aleatoriedade e que atrav\u00e9s de suaviza\u00e7\u00f5es desses extremos \u00e9 poss\u00edvel identificar um padr\u00e3o b\u00e1sico.\n3.3.2.1\tSuaviza\u00e7\u00e3o exponencial simples.\nO modelo atua de maneira similar \u00e0 m\u00e9dia m\u00f3vel ponderada, por\u00e9m a pondera\u00e7\u00e3o \u00e9 feita de maneira exponencial e somente os dados do passado s\u00e3o utilizados, permitindo a elabora\u00e7\u00e3o de modelos preditivos (BROCKWELL; DAVIS, 1996):\nxt+1 = axt + a(1 \u2014 a)xt-i + a(1 \u2014 a)2xt_2 + \u2014\nOnde a \u00e9 o fator de suaviza\u00e7\u00e3o e varia de 0 a 1. Para a realiza\u00e7\u00e3o da previs\u00e3o \u00e9 utilizada a seguinte equa\u00e7\u00e3o.\nFi = xi\nF2 = axi + (1 \u2014 a)Fi\nFt+i = axt + (1 \u2014 a)Ft_i\nNesta equa\u00e7\u00e3o, Ft representa o valor da previs\u00e3o. Quando a = 1 Ft+i = xt e quando a = 0, Ft+i = Ft-i. Ou seja, quanto maior alfa menor \u00e9 o peso para os dados mais antigos e maior \u00e9 para os mais recentes (PAL; PRAKASH, 2017).\n3.3.2.2\tSuaviza\u00e7\u00e3o exponencial de Holt\nQuando a s\u00e9rie temporal apresenta tend\u00eancia, a suaviza\u00e7\u00e3o exponencial simples n\u00e3o representar\u00e1 a s\u00e9rie de maneira adequada. Para contornar este problema, \u00e9 utilizada a suaviza\u00e7\u00e3o de Holt na qual \u00e9 adicionada uma segunda constante que tem como funcionalidade representar a tend\u00eancia da s\u00e9rie temporal (MORETTIN; TOLOI, 2006).\nNeste modelo a previs\u00e3o da s\u00e9rie temporal \u00e9 representada como a soma do n\u00edvel e da tend\u00eancia (PAL; PRAKASH, 2017).\nxt+i = Ft + Tt\nOnde Ft representa o n\u00edvel e Tt a tend\u00eancia:\nFt = axt + (1 \u2014 a)(Ft-i + Tt_i)\nTt=P(Ft \u2014 Ft_i) + (1\u2014p)(Tt_i)\nNesta equa\u00e7\u00e3o ft representa o fator de suaviza\u00e7\u00e3o da tend\u00eancia.\n3.3.2.3\tSua viza\u00e7\u00e3o exponencial tripla\nA suaviza\u00e7\u00e3o exponencial tripla permite \u00e0 simula\u00e7\u00e3o incorporar o n\u00edvel, a tend\u00eancia e a sazonalidade (PAL; PRAKASH, 2017), para tanto, a seguinte equa\u00e7\u00e3o \u00e9 utilizada:\nFt = a(xt - St-L) + (1 - a)(Ft_i + Tt_i)\nSt representa a sazonalidade e \u00e9 calculada utilizando a seguinte equa\u00e7\u00e3o (HYNDMAN; ATHANASOPOULOS, 2018):\nSt = Y(xt - Ft) + (1 - Y)(St_m)\nOnde y representa o fator de suaviza\u00e7\u00e3o da sazonalidade.\n3.3.3\tModelos ARIMA e SARIMA\nEm ess\u00eancia, estes modelos utilizam de regress\u00f5es entre as observa\u00e7\u00f5es passadas das s\u00e9ries temporais para elaborar modelos preditivos (PAL; PRAKASH, 2017).\n3.3.3.1\tModelos autoregressivos\nSegundo Chatfield (2000), se uma s\u00e9rie temporal \u00e9 dita autoregressiva de ordem p ent\u00e3o ela \u00e9 uma soma linear ponderada dos p valores passados adicionados a um termo de caracter\u00edstica aleat\u00f3ria.\nNestes modelos a regress\u00e3o da s\u00e9rie \u00e9 realizada com o lag da s\u00e9rie temporal. Este modelo autoregressivo \u00e9 definido como AR(p) onde o p refere-se \u00e0 ordem do componente AR (PAL; PRAKASH, 2017).\nUm modelo AR(1) \u00e9 descrito pela seguinte fun\u00e7\u00e3o(HYNDMAN; ATHANASOPOULOS, 2018):\nXt = K + 0xt_i + Et\nUm modelo de ordem p AR(p) \u00e9 descrito pela seguinte fun\u00e7\u00e3o:\nXt = K + 0iXt_i + 02Xt_2 + \u2022\u2022\u2022 + 0pXt_p + Et\nNeste modelo Et representa o termo de caracter\u00edstica aleat\u00f3ria, que se a modelagem for perfeita, dever\u00e1 ser equivalente a um ru\u00eddo branco, em um instante t, e 0 \u00e9 o coeficiente de regress\u00e3o do modelo.\n3.3.3.2\tModelos de m\u00e9dia m\u00f3vel\nOs modelos com m\u00e9dia m\u00f3vel utilizam a depend\u00eancia temporal entre os erros residuais para prever valores futuros. Este modelo auxilia no ajuste de s\u00e9ries onde ocorreram eventos inesperados como a ruptura de um equipamento.\nUm modelo MA(1) \u00e9 descrito pela seguinte fun\u00e7\u00e3o:\nXt = K + 0Et-i + Et\nUm modelo de ordem q AR(q) \u00e9 descrito pela seguinte fun\u00e7\u00e3o(HYNDMAN; ATHANASOPOULOS, 2018):\nXt = K + 0iEt-i + 02Et-2 +---1 0qEt-q + Et\nNetas equa\u00e7\u00f5es q representa a ordem do modelo e k representa a intercep\u00e7\u00e3o m\u00e9dia.\n3.3.3.3\tModelos autoregressivos e de m\u00e9dia m\u00f3vel ARMA\nEstes modelos capturam a caracter\u00edstica de regress\u00e3o da pr\u00f3pria s\u00e9rie temporal dos modelos AR e, tamb\u00e9m, incorporam o modelo de m\u00e9dia m\u00f3vel dos erros dos modelos MA (PAL; PRAKASH, 2017).\nUm modelo ARMA(1,1) \u00e9 descrito pela seguinte fun\u00e7\u00e3o:\nXt = K + 0iEt-i + 0iXt-i + Et\nUm modelo ARMA(p,q) de ordem p,q \u00e9 descrito pela seguinte fun\u00e7\u00e3o (DURBIN; KOOPMAN, 2001):\nXt = K + 0iEt-i + 0iXt-i +---1 0qEt-q + 0pXt-p + Et\n3.3.3.4\tModelos ARIMA\n\u00c9 uma generaliza\u00e7\u00e3o dos modelos ARMA incluindo um componente de integra\u00e7\u00e3o que tem como fun\u00e7\u00e3o converter a s\u00e9rie em estacion\u00e1ria. O componente de integra\u00e7\u00e3o \u00e9 respons\u00e1vel por diferenciar a s\u00e9rie uma ou mais vezes, diminu\u00eddo car\u00e1ter n\u00e3o estacion\u00e1rio da mesma (HYNDMAN; ATHANASOPOULOS, 2018).\nPara diferentes valores de integra\u00e7\u00e3o (d) a resposta muda da seguinte forma:\nd = 0 : xt = xt\nd = 1 : xt = xt \u2014 xt-i\nd = 2 : xt = (xt \u2014 xt-i) \u2014 (xt-i \u2014 xt-2) = xt \u2014 2xt-i + xt-2\nDesta maneira um modelo de ordem autoregressiva p, de integra\u00e7\u00e3o d e de m\u00e9dia m\u00f3vel q, ARIMA(p,d,q) pode ser representado da seguinte maneira:\n^dxt \u2014 K +0p^dxt-p + 01^dxt-1 + \"\u2019 + \u00ae1Et-1 + \u00aeqEt-q + Et\n3.3.3.5\tModelos SARIMA\nEstes modelos consideram um componente sazonal para a autorregress\u00e3o, para a m\u00e9dia m\u00f3vel e para a diferencia\u00e7\u00e3o (HYNDMAN; ATHANASOPOULOS, 2018), com o objetivo de realizar previs\u00e3o mais acertada quando a s\u00e9rie temporal apresentar sazonalidade caracter\u00edstica.\nUm modelo SARIMA(p,d,q) (P,D,Q,s) pode ser representado pela seguinte equa\u00e7\u00e3o, onde as vari\u00e1veis P,D,Q e s representam a ordem da autoregress\u00e3o sazonal, da diferencia\u00e7\u00e3o sazonal, da m\u00e9dia m\u00f3vel sazonal e do tamanho do ciclo, respectivamente (SEABOLD; PERKTOLD, 2010).\nK +0P0pA^A^Xf-p + 0101AdADXt-1 + \u2022\u2022\u2022 + 0101\u00a3'f-1 + S\u00e7^q-\u00c9f-q + \u00a3f\n3.4 Crit\u00e9rios de avalia\u00e7\u00e3o dos resultados obtidos\nO primeiro ponto avaliado ao verificar a qualidade de uma previs\u00e3o de s\u00e9rie temporal \u00e9 justamente a capacidade do modelo em representar o comportamento dos dados de maneira visual.\nAl\u00e9m disso, neste trabalho, o crit\u00e9rio de AIC (Akaike\u2019s Information Criterion) \u00e9 utilizado para auxiliar na escolha do melhor modelo SARIMA, o crit\u00e9rio de Akaike \u00e9 calculado utilizando a seguinte equa\u00e7\u00e3o:\n4ZC = ln(<72) + \u2014\nOnde T \u00e9 o tamanho da amostra,&lt;7 \u00e9 a vari\u00e2ncia residual do modelo e k \u00e9 o n\u00famero total de par\u00e2metros a serem estimados (GUIDOLIN; PEDIO, 2018).\nPara a compara\u00e7\u00e3o de diferentes metodologias de estima\u00e7\u00e3o foram utilizados os indicadores que tamb\u00e9m auxiliam no ajuste dos dados e que s\u00e3o usados para determinar a qualidade de um modelo (FACCHIN, 2005, apud MOTKE, 2018, p. 16).O principal destes \u00e9 o da soma quadr\u00e1tica do erro (SSE), que mede os desvios dos dados previstos pelo modelo e os dados originais da s\u00e9rie temporal, aliado a vari\u00e2ncia dos dados (Syy), obt\u00e9m-se a express\u00e3o final do c\u00e1lculo do coeficiente de determina\u00e7\u00e3o, R2. As equa\u00e7\u00f5es abaixo demonstram o c\u00e1lculo destes \u00edndices:\nN\nSSE = ^(yi - yi)2\ni=i\nN\n^yy =\t\u2014 yi)2\ni=i\nR2 = 1 \u2014\nSSE\nS \u00b0yy\nOnde yi s\u00e3o os valores gerados pelo modelo, yi os dados originais utilizados para elabora\u00e7\u00e3o do modelo e y o valor m\u00e9dio do conjunto de dados originais.\nAinda, foram realizados testes para verificar se os modelos implementados tornaram os res\u00edduos em estacion\u00e1rios. Para esta an\u00e1lise, foram utilizadas as fun\u00e7\u00f5es autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial e o teste Augmented Dickey-Fuller (ADF).\nNeste trabalho os gr\u00e1ficos de autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial foram plotados com intervalo de confian\u00e7a de 95%. Se uma fun\u00e7\u00e3o for estacion\u00e1ria, ent\u00e3o, 95 % da amostra da autocorrela\u00e7\u00e3o deveria estar dentro do intervalo de confian\u00e7a (BROCKWELL; DAVIS, 1996).\n4\tEstudo de Caso\nNeste trabalho s\u00e3o abordadas tr\u00eas s\u00e9ries temporais distintas de maneira a possibilitar a an\u00e1lise de quais modelos possuem melhor desempenho em cada uma das aplica\u00e7\u00f5es. Para tanto, foram selecionados os seguintes dados:\n\u2022\tMedida de concentra\u00e7\u00e3o em partes por milh\u00e3o (ppm) mensal de CO2 no ar de 1974 a 1987.\n\u2022\tEvolu\u00e7\u00e3o da cota\u00e7\u00e3o di\u00e1ria da a\u00e7\u00e3o da Braskem, BRKM3, de fevereiro de 2017 a 2018.\n\u2022\tMedida a cada minuto da diferen\u00e7a de press\u00e3o de um leito de adsor\u00e7\u00e3o de umidade de uma unidade desumidificadora em uma plataforma de extra\u00e7\u00e3o de petr\u00f3leo durante 30 mil minutos.\nA escolha das s\u00e9ries temporais reside na natureza de cada uma das mesmas. A concentra\u00e7\u00e3o de C02 apesar de apresentar tend\u00eancia possui oscila\u00e7\u00f5es mais demoradas e padronizadas, desta forma, deve apresentar maior facilidade de predi\u00e7\u00e3o.\nA s\u00e9rie da cota\u00e7\u00e3o da Braskem \u00e9 bastante vol\u00e1til devido \u00e0 natureza \u201cnervosa\u201d do mercado de a\u00e7\u00f5es. Espera-se que previsibilidade para este conjunto de dados seja inferior aos demais.\nOs dados da unidade de adsor\u00e7\u00e3o s\u00e3o industriais pertencendo a um sistema mais fechado que os demais, no entanto, as varia\u00e7\u00f5es abruptas de diferen\u00e7a de press\u00e3o e o car\u00e1ter de vari\u00e2ncia n\u00e3o estacion\u00e1ria devem aumentar a dificuldade na predi\u00e7\u00e3o dessas s\u00e9ries.\n4.1\tEvolu\u00e7\u00e3o da concentra\u00e7\u00e3o de CO2\nOs dados dispon\u00edveis s\u00e3o m\u00e9dias mensais da concentra\u00e7\u00e3o de CO2 na atmosfera em ppm (TANS; KEELING, 2018) entre o per\u00edodo de maio de 1974 a setembro de 1987.\n4.1.1\tPr\u00e9-tratamento da s\u00e9rie temporal\nPara a elabora\u00e7\u00e3o das previs\u00f5es foram utilizados os dados at\u00e9 fevereiro de 1985 (conjunto de treino) e a partir da\u00ed se realizou a previs\u00e3o comparando com o restante dos dados dispon\u00edveis (conjunto de teste).\n4.1.2\tVisualizar a s\u00e9rie temporal\nSeguindo a metodologia, \u00e9 plotada a s\u00e9rie temporal, as fun\u00e7\u00f5es de autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial, para obter melhor entendimento acerca dos dados e identificar a presen\u00e7a e as caracter\u00edsticas dos componentes internos dos dados, conforme indicado na Figura 4.\nFigura 4 - Evolu\u00e7\u00e3o da concentra\u00e7\u00e3o de CO2 em ppm de 1974 a 1985\nFigura 5 - Autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial da evolu\u00e7\u00e3o da concentra\u00e7\u00e3o de CO2.\nFonte: Elaborado pelo autor.\nDesta maneira \u00e9 percept\u00edvel a presen\u00e7a de tend\u00eancia e, a partir da an\u00e1lise dos picos do gr\u00e1fico de autocorrela\u00e7\u00e3o, se permite estimar a sazonalidade em 12 meses.\nNota-se a exist\u00eancia de forte autocorrela\u00e7\u00e3o entre os dados da s\u00e9rie temporal e elevada autocorrela\u00e7\u00e3o parcial at\u00e9 o lag 2.\n4.1.3\tDefinir e aplicar modelos de previs\u00e3o\nDevido \u00e0 presen\u00e7a de tend\u00eancia e sazonalidade bem definidas e constantes ser\u00e3o utilizados os seguintes modelos:\n\nDecomposi\u00e7\u00e3o da s\u00e9rie temporal, M\u00e9todo A;\n\u2022\tSuaviza\u00e7\u00e3o exponencial tripla;\n\u2022\tSARIMA.\n4.1.3.1\tDecomposi\u00e7\u00e3o da s\u00e9rie temporal, M\u00e9todo A\nA partir da regress\u00e3o linear realizada, foi identificada a seguinte equa\u00e7\u00e3o para a tend\u00eancia:\nyt = 329,419 + 0,122xt\nFoi removida a tend\u00eancia da s\u00e9rie original a fim de determinar a sazonalidade. O valor determinado para as varia\u00e7\u00f5es sazonais s\u00e3o os seguintes:\nTabela 1: Valores m\u00e9dios determinados para cada unidade de tempo do ciclo de\n12 meses.\nM\u00eas\tjan\tfev\tmar\tabr\tmai\tjun\tjul\tago\tset\tout\tnov\tdez\nM\u00e9dia\t-0.07\t0,58\t1,54\t2,69\t3,07\t2,48\t0,87\t-1,27\t-3,17\t-3,29\t-2,15\t-0,90\nFonte: Elaborado pelo autor.\nO modelo desenvolvido foi extrapolado para o restante de 1985, para os anos de 1986 e 1987 e comparado com os valores medidos no mesmo per\u00edodo.\nFigura 6 - Compara\u00e7\u00e3o da concentra\u00e7\u00e3o de CO2 Medida (linha azul) com a concentra\u00e7\u00e3o prevista com o modelo obtido atrav\u00e9s da metodologia A (linha laranja).\nAs fun\u00e7\u00f5es de autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial foram aplicadas aos res\u00edduos para verificar se ainda h\u00e1 correla\u00e7\u00e3o entre os dados remanescentes. Conforme indicado pela Figura 7, verifica-se que apesar da autocorrela\u00e7\u00e3o para lags\nmaiores terem reduzido, ainda h\u00e1 correla\u00e7\u00e3o significativa entre os instantes mais pr\u00f3ximos, indicando depend\u00eancia entre os res\u00edduos.\n10\n0.5\n0.0\nLOO\n0.75\n0.50\n0.25\n0.00\n-0.25\nFigura 7 - Autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial dos res\u00edduos gerados pelo m\u00e9todo A. ACF\n1\n\n* * * 1 *\t1\u20141\t*\u20141\t*\u20141 1 1 1 1 [\nPACF\n\t\t\t\n\t\t1#\u2022\u2022#1 I-#\u25a0f f\t\n-111\t1\t[\t\u00ed\t\t\tS\t\u2022\t\u2019\n\t\t\t\n\u00d2\t5\t1\u00d2\t15\t20\t25\t\t\t\nFonte: Elaborado pelo autor.\nApesar disto o valor de R2 obtido foi de 0,969 e o teste Augmented Dickey-Fuller (ADF) apresentou valor de 0,0236, indicando um bom modelo de previs\u00e3o e que os res\u00edduos s\u00e3o estacion\u00e1rios.\n4.1.3.2\tSARIMA\nPara identificar a ordem do modelo, aliado aos gr\u00e1ficos de PACF e ACF e an\u00e1lise visual, foram realizadas otimiza\u00e7\u00e3o simulando todas as constantes (p,d,q,P,D,Q) de 0 a 3 de modo a reduzir o valor de AIC. Este valor foi obtido para um modelo SARIMA (2,1,0) (0,1,1,12).\nAs constantes obtidas com o modelo s\u00e3o apresentadas na Tabela 2. 01 \u00e9 a constante autorregressiva no lag 1, 02 \u00e9 a constante autorregressiva no lag 2, ()1 \u00e9 a constante de m\u00e9dia m\u00f3vel sazonal no lag 12 (um ciclo completo).\nTabela 2 - Valores determinados dos coeficientes do modelo SARIMA(2,1,0)(0,1,1,12).\nCoeficiente\tValor\n01\t-0.4513\n02\t-0.0982\n01\t-0.6065\nFonte: Elaborado pelo autor.\nA Figura 8 representa a compara\u00e7\u00e3o da concentra\u00e7\u00e3o de CO2 medido contra os dados previstos pelo modelo SARIMA.\nFigura 8 - Compara\u00e7\u00e3o da concentra\u00e7\u00e3o de CO2 Medida em ppm (linha azul) com a concentra\u00e7\u00e3o prevista com o modelo SARIMA(2,1,0)(0,1,1,12) (linha laranja).\nFonte: Elaborado pelo autor.\nAs fun\u00e7\u00f5es de autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial foram aplicadas aos res\u00edduos para verificar se ainda h\u00e1 correla\u00e7\u00e3o entre os dados remanescentes. Conforme indicado pela Figura 9, verifica-se que a autocorrela\u00e7\u00e3o foi bem capturada pelo modelo, indicando baixa depend\u00eancia temporal entre os res\u00edduos.\nFigura 9 - Autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial dos res\u00edduos do modelo gerado pelo modelo SARIMA(2,1,0)(0,1,1,12).\nFonte: Elaborado pelo autor.\nOs valores de R2 e do teste ADF s\u00e3o respectivamente 0,980 e 0,000, indicando um bom modelo e confirmando que os res\u00edduos s\u00e3o estacion\u00e1rios.\n4.1.3.3\tSua viza\u00e7\u00e3o exponencial tripla\nDevido \u00e0 presen\u00e7a de tend\u00eancia a de sazonalidade foi realizada exponencia\u00e7\u00e3o sazonal tripla. Os par\u00e2metros foram obtidos de modo a minimizar o erro da predi\u00e7\u00e3o e est\u00e3o representados na Tabela 3.\nTabela 3 - Coeficientes determinados para o m\u00e9todo da exponencia\u00e7\u00e3o tripla.\nCoeficiente\tValor\na\t0,56\np\t1,54. 10 8\nY\t0,31\nFonte: Elaborado pelo autor.\nA figura 10 representa a compara\u00e7\u00e3o da concentra\u00e7\u00e3o de CO2 medido contra os dados previstos pelo modelo de exponencia\u00e7\u00e3o tripla.\nFigura 10 - Compara\u00e7\u00e3o da concentra\u00e7\u00e3o em ppm de CO2 Medida (linha azul) com a\nconcentra\u00e7\u00e3o prevista pelo modelo de suaviza\u00e7\u00e3o exponencial (linha laranja).\nFonte: Elaborado pelo autor.\nAs fun\u00e7\u00f5es de autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial foram aplicadas aos res\u00edduos para verificar se ainda h\u00e1 correla\u00e7\u00e3o entre os dados remanescentes. Conforme indicado pela Figura 11, verifica-se que a autocorrela\u00e7\u00e3o foi bem capturada pelo modelo, indicando baixa depend\u00eancia temporal entre os res\u00edduos.\nFigura 11 - Autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial dos res\u00edduos do modelo gerado pelo modelo de suaviza\u00e7\u00e3o exponencial tripla.\nFonte: Elaborado pelo autor.\nOs valores de R2 e do teste ADF s\u00e3o respectivamente 0,978 e 0,000, indicando um\nbom modelo e confirmando que os res\u00edduos s\u00e3o estacion\u00e1rios.\n4.1.4 Avaliar resultados obtidos\nOs modelos que apresentaram melhores resultados, devido \u00e0s caracter\u00edsticas estacion\u00e1rias dos res\u00edduos, ao coeficiente de determina\u00e7\u00e3o e \u00e0 capacidade de representar visualmente a s\u00e9rie temporal original, foram os de suaviza\u00e7\u00e3o exponencial tripla e o modelo SARIMA(2,1,0)(0,1,1,12).\n4.1.5\tPrevis\u00f5es de longo prazo\nOs dois modelos que apresentaram os maiores R2 foram estendidos para localizar em qual per\u00edodo a concentra\u00e7\u00e3o m\u00e9dia mensal alcan\u00e7aria 400 ppm pela primeira vez, est\u00e1 \u00e9 uma importante posi\u00e7\u00e3o visto que o incremento de CO2 na atmosfera gera diversos impactos na flora e fauna.\nSegundo o modelo SARIMA e o de Suaviza\u00e7\u00e3o exponencial tripla esta marca seria atingida somente em abril de 2023, no entanto, em abril de 2014 foi registrada m\u00e9dia mensal de 401 ppm, demonstrando que a caracter\u00edstica de tend\u00eancia da s\u00e9rie temporal, no decorrer do tempo, incrementou seu car\u00e1cter exponencial (TANS; KEELING,2018).\n4.2\tDiferen\u00e7a de press\u00e3o em um adsorvedor\nOs dados utilizados foram medidos em intervalo de um minuto totalizando 32.700 minutos de opera\u00e7\u00e3o de um adsorvedor operando com intuito de reduzir a umidade de \u00e1gua a 1 ppm em uma corrente de g\u00e1s de uma plataforma de petr\u00f3leo.\n4.2.1\tPr\u00e9-tratamento da s\u00e9rie temporal\nDevido ao elevado n\u00famero de pontos, optou-se por se utilizar uma amostragem de 10 minutos, ou seja se pegou 1 ponta de cada 10 amostragens operacionais, tendo-se o cuidado de se pegar o in\u00edcio do ciclo para evitar defasagens decorrentes do processo de re-amostragem.\nPara o conjunto de treino, foi utilizada a amostra do intervalo de 0 a 26.100 minutos de opera\u00e7\u00e3o. O conjunto de teste foi realizado comparando a previs\u00e3o desenvolvida com as amostras dos minutos 26.100 ao 32.700.\n4.2.2\tVisualizar a s\u00e9rie temporal\nPara obter melhor entendimento acerca dos dados e identificar a presen\u00e7a e as caracter\u00edsticas dos componentes internos da s\u00e9rie temporal, foi plotado o conjunto de treino, Figura 12, e calculadas as fun\u00e7\u00f5es de autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial, Figura 13.\nFigura 12 - Evolu\u00e7\u00e3o da diferen\u00e7a de press\u00e3o em adsorvedor com amostras de intervalo de 10\nFonte: Dados de adsorvedor de umidade em planta plataforma de extra\u00e7\u00e3o de petr\u00f3leo.\nFigura 13 - Autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial do delta P at\u00e9 o lag 50.\nACF\n1\tllr,\t. u I \u00ed'\t\u00a1\u00cdTt\t r r T1 \u00ed 1\n\t\t\t* H1111! I! U \u2018\nPACF\n\t\tL t 1 t t r r t t T\t\t\t\t  .\t. . .\t-\n1 i i 1 1 1 1\t1 1 1 1 1 L\t\t\n0\t10\t20\t30\t40\t50\nFonte: Elaborado pelo autor.\nNota-se a presen\u00e7a de tend\u00eancia, a partir da an\u00e1lise dos picos do gr\u00e1fico de autocorrela\u00e7\u00e3o permite-se estimar a sazonalidade em 25 amostras ou 250 minutos. Ainda, destaca-se forte autocorrela\u00e7\u00e3o entre os dados e elevada autocorrela\u00e7\u00e3o parcial at\u00e9 o lag 2.\n4.2.3\tDefinir e aplicar modelos de previs\u00e3o\nDevido \u00e0s caracter\u00edsticas observadas na etapa de visualiza\u00e7\u00e3o da s\u00e9rie temporal, foram utilizados os seguintes modelos:\n\u2022\tDecomposi\u00e7\u00e3o da s\u00e9rie temporal, M\u00e9todo B;\n\u2022\tSARIMA.\n4.2.3.1\tDecomposi\u00e7\u00e3o da s\u00e9rie temporal, M\u00e9todo B\nA tend\u00eancia foi capturada realizando regress\u00e3o polinomial, a equa\u00e7\u00e3o identificada est\u00e1 representada abaixo.\nyt = 0,163 + 3,27 x\u00a1\nFoi ent\u00e3o removida a tend\u00eancia da s\u00e9rie original a fim de determinar a sazonalidade atrav\u00e9s da utiliza\u00e7\u00e3o do m\u00e9todo da FFT. Para tanto, foi selecionado um ciclo de adsor\u00e7\u00e3o que foi considerado representativo, sem ocorr\u00eancias operacionais esp\u00farias, e o resultado (Figura14) identificado foi replicado aos demais per\u00edodos.\nFigura 14 - Comportamento sazonal da s\u00e9rie temporal identificado pela Transformada R\u00e1pida de Fourier utilizando 10 harm\u00f4nicas.\nFonte: Elaborado pelo autor.\nOs componentes sazonais e de tend\u00eancia foram adicionados e o modelo foi extrapolado para realizar a compara\u00e7\u00e3o com o conjunto de teste:\nFigura 15 - Compara\u00e7\u00e3o da diferen\u00e7a de press\u00e3o medida (linha azul) do conjunto de teste com a diferen\u00e7a de press\u00e3o prevista pela utiliza\u00e7\u00e3o do m\u00e9todo B de decomposi\u00e7\u00e3o (linha laranja).\nFonte: Elaborado pelo autor.\nOs valores de R2 e do teste ADF s\u00e3o respectivamente 0,782 e 0,000, indicando modelo razo\u00e1vel e que os res\u00edduos s\u00e3o estacion\u00e1rios. No entanto, as fun\u00e7\u00f5es de ACF, PACF e a distribui\u00e7\u00e3o dos res\u00edduos apontam que h\u00e1 comportamentos determin\u00edsticos que n\u00e3o foram capturados pelo modelo.\nFigura 16 - Autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial do delta P dos res\u00edduos at\u00e9 o lag 50.\nFonte: Elaborado pelo autor.\nFigura 17 - Histograma dos res\u00edduos indicando que estes n\u00e3o seguem distribui\u00e7\u00e3o normal em torno de 0.\nFonte: Elaborado pelo autor.\n4.2.3.2\tSARIMA\nPara identificar a ordem do modelo foram realizadas otimiza\u00e7\u00e3o simulando as constantes (p,d,q,P,D,Q) conforme indicado na Tabela 4 de modo a identificar quais modelos obt\u00eam menor AIC.\nTabela 4 - Representa\u00e7\u00e3o do range utilizado na otimiza\u00e7\u00e3o do AIC\n\tP\td\tq\tP\tD\tQ\nIn\u00edcio\t0\t0\t0\t0\t0\t0\nFim\t13\t1\t5\t3\t2\t3\nFonte: Elaborado pelo autor.\nUma vez identificados os coeficientes que minimizam o valor de AIC, eles foram utilizados na realiza\u00e7\u00e3o de simula\u00e7\u00f5es e foram avaliadas visualmente a qualidade das previs\u00f5es produzidas por estes modelos. O modelo escolhido foi o SARIMA (2,0,1)(0,1,0,25)\nAs constantes obtidas com o modelo s\u00e3o apresentadas na Tabela 5. 0X \u00e9 a constante autorregressiva no lag 1, 02 \u00e9 a constante autorregressiva no lag 2, 0X \u00e9 a constante de m\u00e9dia m\u00f3vel sazonal no lag 1 e a \u00e9 a intercep\u00e7\u00e3o m\u00e9dia no eixo das ordenadas.\nTabela 5 - Valores determinados das constantes do modelo SARIMA(2,0,1)(0,1,0,25).\n\t01\t01\t61\t\nValor\t0,4308\t0,1376\t0,1295\t0,0003\nFonte: Elaborado pelo autor.\nA Figura 18 representa a compara\u00e7\u00e3o da diferen\u00e7a de press\u00e3o medida no conjunto de teste contra os dados previstos pelo modelo de SARIMA(2,0,1)(0,1,0,25).\nFigura 18 - Compara\u00e7\u00e3o da diferen\u00e7a de press\u00e3o medida (linha azul) do conjunto de teste com a diferen\u00e7a de press\u00e3o prevista pela utiliza\u00e7\u00e3o do modelo SARIMA (2,0,1)(0,1,0,25) (linha laranja).\nEvolu\u00e7\u00e3o DeltaP em Adsorvedor\nTempo de opera\u00e7\u00e3o (min)\nFonte: Elaborado pelo autor.\nAs fun\u00e7\u00f5es de autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial foram aplicadas aos res\u00edduos para verificar se ainda h\u00e1 correla\u00e7\u00e3o entre os dados remanescentes. Conforme indicado pela Figura 19, verifica-se que a autocorrela\u00e7\u00e3o foi bem capturada pelo modelo, indicando baixa depend\u00eancia temporal entre os res\u00edduos.\nFigura 19 - Autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial dos res\u00edduos gerado pelo modelo de\nSARIMA (2,0,1)(0,1,0,25) na base de treino.\nFonte: Elaborado pelo autor.\nOs valores de R2 e do teste ADF s\u00e3o respectivamente 0,762 e 0,000, indicando modelagem razo\u00e1vel e confirmando que os res\u00edduos s\u00e3o estacion\u00e1rios.\n4.2.4\tAvaliar resultados obtidos\nO modelo que apresentou melhor resultado, devido \u00e0s caracter\u00edsticas estacion\u00e1rias dos res\u00edduos, ao coeficiente de determina\u00e7\u00e3o e \u00e0 capacidade de representar visualmente a s\u00e9rie temporal original, foi o SARIMA (2,0,1)(0,1,0,25).\n4.2.5\tAvalia\u00e7\u00e3o da din\u00e2mica da s\u00e9rie temporal\nPara obter melhor entendimento em rela\u00e7\u00e3o \u00e0 din\u00e2mica da opera\u00e7\u00e3o do adsorvedor, foram realizadas 60 simula\u00e7\u00f5es do modelo SARIMA(2,0,1)(0,1,0,25) com intervalos constantes de 75 observa\u00e7\u00f5es, por\u00e9m, variando o in\u00edcio de 0 a 2585 com passo de 25 observa\u00e7\u00f5es e o fim do intervalo de 75 a 2610, tamb\u00e9m com passo de 25.\nUma vez formada a matriz dos intervalos com os coeficientes p1,p2 e q1 foi avaliada a exist\u00eancia de algum padr\u00e3o ou tend\u00eancia para os resultados determinados. No entanto, as simula\u00e7\u00f5es se mostraram inconclusivas devido \u00e0 caracter\u00edstica aleat\u00f3ria dos coeficientes conforme indica a Figura 20.\nFigura 20 - Figura evidenciando a varia\u00e7\u00e3o dos coeficientes AR1, AR2 e MA1 nas 60 simula\u00e7\u00f5es\n4.3 Evolu\u00e7\u00e3o da cota\u00e7\u00e3o da a\u00e7\u00e3o BRKM3\nOs dados dispon\u00edveis s\u00e3o de fevereiro de 2017 a novembro de 2018 e representam a cota\u00e7\u00e3o di\u00e1ria das a\u00e7\u00f5es da Braskem, BRKM3, na bolsa de valores do Brasil.\n4.3.1\tPr\u00e9-tratamento da s\u00e9rie temporal\nPara a elabora\u00e7\u00e3o e avalia\u00e7\u00e3o dos modelos as bases foram divididas em dois per\u00edodos. Para o conjunto de treino foram empregados os dados de fevereiro de 2017 a 13 de agosto de 2018. Com a base treino foram definidos os modelos que melhor\ndesempenham na previs\u00e3o da s\u00e9rie temporal, al\u00e9m de realizar a avalia\u00e7\u00e3o dos res\u00edduos.\nA base teste, necess\u00e1ria para realizar a compara\u00e7\u00e3o com os dados de previs\u00e3o gerados pelo modelo, inicia no dia 14 de agosto e termina em 01 de novembro.\n4.3.2\tVisualizar a s\u00e9rie temporal\nFoi plotada a s\u00e9rie temporal para obter melhor entendimento acerca dos dados e identificar a presen\u00e7a e as caracter\u00edsticas dos componentes internos da s\u00e9rie temporal.\nFigura 21 - Evolu\u00e7\u00e3o da cota\u00e7\u00e3o da BRKM3 em intervalo di\u00e1rio minutos, conjunto de treino.\nFonte: Bolsa de valores do Brasil (B3, 2018), dados do fechamento da a\u00e7\u00e3o BRKM3.\nFigura 22 -Autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial do pre\u00e7o da a\u00e7\u00e3o at\u00e9 o lag 50.\nACF\n\tII\tllinill\u00edlll\u00edniiiiinnnni\tr\n\t\t\nPACF\n\t\t\n* \u2022 w\ti i\tw 1\t1\t\u2022 \u2022 * 4\tw\t1 w\t*\t\t\n0\t10\t20\t30\t40\t50\nFonte: Elaborado pelo autor.\nA visualiza\u00e7\u00e3o da s\u00e9rie temporal e das fun\u00e7\u00f5es de ACF e PACF indicam que apesar da grande volatilidade dos dados, h\u00e1 presen\u00e7a de tend\u00eancia para a cota\u00e7\u00e3o da Braskem apesar da aus\u00eancia de sazonalidade.\nAinda, Nota-se elevada de autocorrela\u00e7\u00e3o parcial at\u00e9 o lag 2, e elevada autocorrela\u00e7\u00e3o parcial at\u00e9 o lag 27.\ncaso\n4.3.3\tDefinir e aplicar modelos de previs\u00e3o\nDevido \u00e0 presen\u00e7a de tend\u00eancia, \u00e0 tend\u00eancia irregular, \u00e0 inexist\u00eancia de sazonalidade e \u00e0 elevada autocorrela\u00e7\u00e3o ser\u00e3o utilizados os seguintes modelos:\n\u2022\tARIMA;\n\u2022\tSuaviza\u00e7\u00e3o exponencial dupla.\n4.3.3.1\tSARIMA\nPara identificar a ordem do modelo foram realizadas otimiza\u00e7\u00e3o simulando as constantes (p,d,q) conforme indicado na Tabela 6, de modo a identificar quais modelos obt\u00eam menor AIC.\nTabela 6 - Representa\u00e7\u00e3o do range utilizado na otimiza\u00e7\u00e3o do AIC.\n\tP\td\tq\nIn\u00edcio\t0\t1\t0\nFim\t29\t2\t10\nFonte: Elaborado pelo autor.\nOs valores que minimizavam o AIC foram utilizados na realiza\u00e7\u00e3o de simula\u00e7\u00f5es e estas foram avaliadas visualmente em rela\u00e7\u00e3o \u00e0 qualidade das previs\u00f5es produzidas. Apesar dos modelos de ordem mais baixa produzirem resultados de AIC similares aos de elevada ordem, a simula\u00e7\u00e3o gr\u00e1fica indica melhor capacidade de representar o comportamento da s\u00e9rie temporal para os coeficientes de maior ordem. Esta avalia\u00e7\u00e3o gr\u00e1fica \u00e9 representada nas Figuras 23 e 24.\nO melhor valor de AIC obtido na otimiza\u00e7\u00e3o foi de 1.024 para o modelo ARIMA (2,1,3), a compara\u00e7\u00e3o ser\u00e1 feita com o modelo ARIMA (29,1,9) que demonstrou melhor ader\u00eancia aos dados originais mesmo tendo apresentado AIC de 1.042.\nFigura 23 - Compara\u00e7\u00e3o da cota\u00e7\u00e3o medida (linha azul) do conjunto de treino com a cota\u00e7\u00e3o prevista pelo modelo ARIMA (2,1,3) (linha laranja).\nFonte: Elaborado pelo autor.\nFigura 24 - Compara\u00e7\u00e3o da cota\u00e7\u00e3o medida (linha azul) do conjunto de treino com a cota\u00e7\u00e3o prevista pelo modelo ARIMA (29,1,9) (linha laranja).\nFonte: Elaborado pelo autor.\nOs coeficientes obtidos para o modelo ARIMA (29,1,9) est\u00e3o representados na\nTabela 7.\nTabela 7 - Valores determinados dos coeficientes do modelo ARIMA (29,1,9).\n\t01\t02\t03\t04\t05\t06\t07\t08\t09\t01O\t011\t012\n\t0,\t-\t0,\t-\t-\t0,\t0,\t-\t0,\t0,\t0,\t-\nValor\t2711\t0,3961\t0888\t0,1163\t0,0886\t0493\t2520\t0,3384\t7471\t0292\t1621\t0,0936\n\t013\t014\t015\t016\t017\t018\t019\t02O\t021\t022\t023\t024\n\t-\t0,\t-\t0,\t-\t0,\t-\t-\t-\t0,\t-\t0,\nValor\t0,1411\t2561\t0,0271\t0480\t0,0896\t0545\t0,0207\t0,0391\t0,1349\t1535\t0,1054\t0872\n\t025\t026\t027\t028\t029\t01\t02\t03\t04\t05\t06\t07\n\t-\t0,\t0,\t0,\t-\t-\t0,\t-\t0,\t-\t0,\t-\nValor\t0,1145\t1165\t0220\t0409\t0,0758\t0,4122\t3464\t0,0164\t0872\t0,0227\t0889\t0,3829\n\t08\t69\tK\t\t\t\t\t\t\t\t\t\n\t0,\t-\t0,\t\t\t\t\t\t\t\t\t\nValor\t4327\t0,8796\t0318\t\t\t\t\t\t\t\t\t\nFonte: Elaborado pelo autor.\nA avalia\u00e7\u00e3o dos res\u00edduos \u00e9 realizada atrav\u00e9s das fun\u00e7\u00f5es de autocorrela\u00e7\u00e3o\nparcial, autocorrela\u00e7\u00e3o, Figura 25, e do teste ADF.\nFigura 25 - Autocorrela\u00e7\u00e3o e autocorrela\u00e7\u00e3o parcial dos res\u00edduos do modelo at\u00e9 o lag 50.\nO valor apresentado para o teste ADF foi 0, isto alinhado \u00e0s fun\u00e7\u00f5es ACF e PACF indicam que os res\u00edduos s\u00e3o estacion\u00e1rios.\nA Figura 26 representa a compara\u00e7\u00e3o da cota\u00e7\u00e3o da BRKM3 do conjunto de teste contra os dados previstos pelo modelo ARIMA(29,1,9).\nFigura 26 - Compara\u00e7\u00e3o de 7 dias da cota\u00e7\u00e3o medida do conjunto de teste (linha azul) com a cota\u00e7\u00e3o prevista pelo modelo ARIMA (29,1,9) (linha laranja).\nFonte: Elaborado pelo autor.\nPode-se inferir que apesar dos valores previstos n\u00e3o corresponderem aos da cota\u00e7\u00e3o realizada o modelo conseguiu capturar parcialmente o comportamento da s\u00e9rie temporal em um intervalo de tempo n\u00e3o muito distante. Capturando a tend\u00eancia de alta e baixa das a\u00e7\u00f5es, conforme representado na Figura 27.\nFigura 27 - Compara\u00e7\u00e3o entre a primeira derivada do modelo preditivo ARIMA(29,1,9) e a\nprimeira derivada da a\u00e7\u00e3o do conjunto de teste.\nFonte: Elaborado pelo autor.\nFigura 28 - Compara\u00e7\u00e3o de 53 dias da cota\u00e7\u00e3o medida do conjunto de teste (linha azul) com a\ncota\u00e7\u00e3o prevista pelo modelo ARIMA (29,1,9) (linha laranja).\nFonte: Elaborado pelo autor.\nA Figura 28 mostra que conforme se estende o per\u00edodo da previs\u00e3o, a qualidade da representa\u00e7\u00e3o do comportamento da s\u00e9rie temporal pelo modelo decai significativamente.\nEm virtude do distanciamento entre o valor previsto e o valor realizado, o coeficiente de determina\u00e7\u00e3o n\u00e3o foi quantificado como um dos m\u00e9todos de avalia\u00e7\u00e3o da qualidade do modelo para esta s\u00e9rie temporal.\n4.3.3.2\tSua viza\u00e7\u00e3o exponencial dupla\nDevido \u00e0 presen\u00e7a de tend\u00eancia foi realizada exponencia\u00e7\u00e3o sazonal dupla. Os par\u00e2metros foram obtidos de modo a minimizar o erro da predi\u00e7\u00e3o e est\u00e3o representados na Tabela 8.\nTabela 8 - Coeficientes determinados pelo m\u00e9todo da exponencia\u00e7\u00e3o dupla.\n\ta\t\nValor\t0,79\t0\nFonte: Elaborado pelo autor.\nA Figura 29 representa a compara\u00e7\u00e3o da cota\u00e7\u00e3o do conjunto teste contra os dados previstos pelo modelo de suaviza\u00e7\u00e3o exponencial dupla.\nFigura 29 - Compara\u00e7\u00e3o da cota\u00e7\u00e3o do conjunto de teste (linha azul) com a cota\u00e7\u00e3o prevista pelo modelo de suaviza\u00e7\u00e3o exponencial dupla (linha laranja).\nFonte: Elaborado pelo autor.\nDevido \u00e0 caracter\u00edstica \u201cnervosa\u201d da s\u00e9rie temporal e tend\u00eancia vari\u00e1vel, o modelo de suaviza\u00e7\u00e3o exponencial, que utiliza par\u00e2metros para ponderar os valores passados da s\u00e9rie, n\u00e3o consegue representar a previs\u00e3o da cota\u00e7\u00e3o da a\u00e7\u00e3o de maneira adequada.\n4.3.4\tAvaliar resultados obtidos\nO modelo que melhor conseguiu representar os dados da cota\u00e7\u00e3o da Braskem, BRKM3, foi o ARIMA (29,1,9). Apesar de n\u00e3o ser exato na previs\u00e3o, este modelo auxiliou na identifica\u00e7\u00e3o do comportamento dos valores futuros desta s\u00e9rie temporal conforme representado na Figura 26 e na Figura 27.\nO aumento do per\u00edodo da previs\u00e3o piora significativamente a previs\u00e3o devido \u00e0 caracter\u00edstica \u201cnervosa\u201d dos dados, conforme ilustrado na Figura 28.\n40 An\u00e1lise de S\u00e9ries Temporais: Compara\u00e7\u00e3o entre modelos preditivos em estudo de caso\n5\tConclus\u00f5es e Sugest\u00f5es para Trabalhos Futuros\nNeste trabalho, os comportamentos de tr\u00eas conjuntos de dados temporais de natureza diferente foram analisados e atrav\u00e9s de modelos preditivos foram realizadas previs\u00f5es para os pr\u00f3ximos pontos destas s\u00e9ries temporais. Para tanto, foram abordados tr\u00eas conjuntos de t\u00e9cnicas de previs\u00e3o: As de decomposi\u00e7\u00e3o dos componentes internos, as de suaviza\u00e7\u00e3o exponencial e as t\u00e9cnicas do grupo SARIMA.\nA decis\u00e3o de quais modelos seriam aplicados em cada uma das s\u00e9ries temporais ocorreu ap\u00f3s a an\u00e1lise e entendimento do comportamento dos conjuntos de dados e de modo a aplicar modelos que conseguiriam representar da maneira mais adequada cada uma das tr\u00eas s\u00e9ries temporais.\nDesta forma, observou-se que para os dados de CO2 os tr\u00eas modelos testados conseguiram simular de maneira satisfat\u00f3ria o comportamento da s\u00e9rie com destaque ao SARIMA (2,1,0) (0,1,1,12) e ao de Suaviza\u00e7\u00e3o exponencial tripla. Verificou-se tamb\u00e9m que a tend\u00eancia de aumento do CO2 na atmosfera foi intensificada ap\u00f3s o per\u00edodo estudado neste trabalho.\nPara representar o comportamento da unidade adsorvedora de umidade nos ciclos de adsor\u00e7\u00e3o e dessor\u00e7\u00e3o optou-se pela utiliza\u00e7\u00e3o dos modelos SARIMA e de regress\u00e3o linear com a utiliza\u00e7\u00e3o de s\u00e9ries de Fourier para representar a sazonalidade. A representa\u00e7\u00e3o gr\u00e1fica dos valores futuros e os res\u00edduos indicaram que o modelo SARIMA (2,0,1) (0,1,0,25) capturou a parte determin\u00edstica de maneira superior ao m\u00e9todo de decomposi\u00e7\u00e3o. Ainda, foram realizadas simula\u00e7\u00f5es dos coeficientes do modelo SARIMA em intervalos variados da s\u00e9rie temporal para tentar identificar algum padr\u00e3o ou altera\u00e7\u00e3o na s\u00e9rie temporal, por\u00e9m, este estudo foi inconclusivo.\nO modelo que melhor conseguiu representar os dados da cota\u00e7\u00e3o da Braskem, BRKM3, foi o ARIMA (29,1,9). Apesar de n\u00e3o ser exato na previs\u00e3o, este modelo auxiliou na identifica\u00e7\u00e3o do comportamento dos valores futuros desta s\u00e9rie temporal. Tamb\u00e9m foi avaliada a dificuldade de se ter um valor preciso para os dados da BRKM3 conforme o aumento da dist\u00e2ncia da previs\u00e3o, devido \u00e0 caracter\u00edstica \u201cnervosa\u201d dos dados.\nPor fim, respondendo ao segundo questionamento, o modelo que melhor conseguiu representar o comportamento futuro das s\u00e9ries temporais em geral foi o\nSARIMA. Este fato explica-se pela capacidade dos modelos SARIMA de inserir em suas equa\u00e7\u00f5es padr\u00f5es de comportamento passados e utiliz\u00e1-los para realizar as previs\u00f5es.\nPara futuros trabalhos, afim de melhorar o entendimento acerca do comportamento do adsorvedor, sugere-se que a avalia\u00e7\u00e3o do mesmo seja realizada utilizando a raz\u00e3o entre a raiz quadrada da diferen\u00e7a de press\u00e3o e a vaz\u00e3o de entrada no equipamento. Ainda, recomenda-se que as simula\u00e7\u00f5es dos coeficientes do modelo SARIMA em intervalos variados da s\u00e9rie temporal sejam realizados utilizando n\u00e3o valores de periodicidade constantes, de in\u00edcio e t\u00e9rmino das simula\u00e7\u00f5es, mas com a utiliza\u00e7\u00e3o de fun\u00e7\u00f5es que indiquem a posi\u00e7\u00e3o de in\u00edcio e t\u00e9rmino exato de cada ciclo.\nEm rela\u00e7\u00e3o \u00e0s metodologias de previs\u00e3o, poderiam ser adotados modelos que levem em considera\u00e7\u00e3o n\u00e3o somente vari\u00e1veis end\u00f3genas, mas tamb\u00e9m as ex\u00f3genas como os modelos SARIMAX, permitindo utilizar maior volume de informa\u00e7\u00e3o sobre o fen\u00f4meno que se deseja realizar previs\u00e3o.\nRefer\u00eancias\nBOX, George E. P.; JENKINS, Gwilym M.; REINSEL, Gregory C. Time Series Analysis. Forecasting Control. 4. ed. Hoboken: John Wiley &amp; Sons, 2008.\nBROCKWELL, Peter J.; DAVIS, Richard A. Introduction to Time Series and Forecasting. 3. ed. New York: Springer, 1996.\nCHATFIELD, Christopher. Time-series forecasting. Boca Raton: CRC Press, 2000. ISBN 1-58488-063-5.\nDOWNEY, Allen B. Think DSP: Digital Signal Processing in Python. 1. ed. Sebastopol (CA): O'Reilly Media, 2016.\nDURBIN, J.; KOOPMAN, S. J. Time series analysis by state space methods. New York: Oxford University Press, 2001.\nGUIDOLIN, Massimo; PEDIO, Manuela. Essentials of time series for financial applications. Academic Press/Elsevier, 2018.\nHYNDMAN, Rob J.; ATHANASOPOULOS, George. Forecasting: Principles and Practice. 2. ed. OTexts, 2018. Dispon\u00edvel em:&lt;https://otexts.org/fpp2/>. Acesso em: 18 nov. 2018\nLEWIS, Bruce G.; HERBERT, Ric D.; BELL, Rod D. The Application of Fourier Analysis to Forecasting the Inbound Call Time Series of a Call Centre. Proceedings of the International Congress on Modeling and Simulation MODSIM03, Townsville, pp. 1281-1286, 2003. Dispon\u00edvel em:&lt;https://www.mssanz.org.au/MODSIM03/Volume_03/B10/06_Lewis.pdf>.\nAcessoem: 22 ago. 2018.\nMACKINNON, James G. Critical values for cointegration tests. Queen's Economics Department Working Paper, n. 1227, 2010. Dispon\u00edvel em:&lt;https://www.econstor.eu/bitstream/10419/67744/1 /616664753.pdf>. Acesso em: 20 set. 2018\nMARTELOTTE, Marcela Cohen. Projeto de filtros para ajuste sazonal robustos a varia\u00e7\u00f5es na sazonalidade. 2014. 298 f. Tese (Doutorado em Engenharia El\u00e9trica). Pontif\u00edcia Universidade Cat\u00f3lica do Rio de Janeiro. Departamento de Engenharia\tEl\u00e9trica.\t2014.\tDispon\u00edvel\tem:\n<http://www02.smt.ufrj.br/~eduardo/teses/marcela-cohen-doutorado.pdf>. Acesso em: 03 nov. 2018\nMORETTIN, Pedro A.; TOLOI, Cl\u00e9lia M. C. An\u00e1lise de s\u00e9ries temporais. 2. ed. S\u00e3o Paulo: EgargBlucher, 2006.\nMOTKE, Mateus Berno. Predi\u00e7\u00e3o de press\u00e3o de fundo em po\u00e7os de petr\u00f3leo via redes neurais. 2018. 32 f. Trabalho de conclus\u00e3o (Gradua\u00e7\u00e3o). Universidade Federal do Rio Grande do Sul. Escola de Engenharia. Curso de Engenharia Qu\u00edmica,\tPorto Alegre, BR-RS, 2018. Dispon\u00edvel em:\n<http://www.bibliotecadigital.ufrgs.br/da.php?nrb=001074436&amp;loc=2018&amp;l=d2f335 d2100a49ec>. Acesso em: 17 nov. 2018\nPAL, Avishek; PRAKASH, PKS. Practical Time Series Analysis: Master Time Series Data Processing, Visualization, and Modeling using Python. Birmingham: Packt Publishing, 2017.\nSEABOLD, Skipper; PERKTOLD, Josef. Statsmodels: Econometric and Statistical Modeling with Python. Proceedings of the 9th Python in Science Conference, Austin, v. 57. pp 57-61, 2010.\nTANS, Pieter; KEELING, Ralph. Scripps Institution of Oceanography - Trends in Atmospheric Carbon\tDioxide.\tDispon\u00edvel\tem:\n<https://www.esrl.noaa.gov/gmd/ccgg/trends/data.html>Acesso em: 12 nov. 2018.\nB3,\t2018 Dispon\u00edvel em:&lt;http://www.b3.com.br/pt_br/market-data-e-\nindices/servicos-de-dados/market-data/cotacoes/> Acesso em: 20 nov. 2018\nAp\u00eandice A\nSimula\u00e7\u00e3o da s\u00e9rie temporal da a\u00e7\u00e3o BRKM3\nIn [1]: inport os inport pandas as pd *matplotlib inline frcm matplotlib import pyplot as pin from statsmodels. graphics. tsaplots i^x>rt plot_acf, plot_pacf from future_____________iaport print_function\nimport nunpy as np inport seaborn as sns from statsmodels. tsa. arma_nodel inport ARZHA inport statsmodels. api as sn iiqaort statsmodels.tsa.api as sntsa from statsnodels. tsa inport stattools from statsmodels. tsa. holtvlnters inport ExpcnentialSmoothing\nIn [2]: ##Inportando os dados\ndata - pd.read_excel(\u2022C:/Users/Tb.caaa2/Docu\u00bbent3/ENQ/2018_02/TCC/Dados/Bovespa Historical Data4_trai n.xlsx', sheet_name-\u2022p2\u2018)\nIn [3]! # 5OMENTE PARA AJUSTAR A BD\nIn [4]: data.tail(12)\nOut[41: ________________________________________\n\tData\tBov\tBRKM3\tano mes\n321\t2018-07-26\t79405 34\t50.60\t2018707\n322\t2018-07-27\t79866.10\t51 43\t2018/07\n323\t2018-07-30\t80275.59\t51.49\t2018/07\n324\t2018-07-31\t79220.43\t52 98\t2018/07\n325\t2018-08-01\t79301.65\t51.60\t2018/08\n326\t2018-08-02\t79636.69\t51 10\t2018/08\n327\t2018-08-03\t81434 98\t53 20\t2018/08\n328\t2018-08-06\t81050 76\t53 20\t2018/08\n329\t2018-08-07\t80346 52\t53 99\t2018/08\n330\t2018-08-08\t79151 70\t53 50\t2018/08\n331\t2018-08-09\t78767 99\t52 30\t2018438\n332\t2018-08-13\t77496 45\t52 00\t2018/08\nIn [5]: data.index - data.Data\nIn [6]: data.headf)\nOut[6]: ______________________\n\tData\tBov\tBRKM3\tanomes\nData\t\t\t\t\n2017-02-17\t2017-02-17\t67748 42\t31 00\t2017/02\n2017-02-20\t2017-02-20\t6853286\t31 48\t2017/02\n2017-02-21\t2017-02-21\t69052 03\t31 40\t2017/02\n2017-02-22\t2017-02-22\t68589 54\t31 00\t2017/02\n2017-02-23\t2017-02-23\t67461 39\t31 00\t2017/02\nVISUALIZAR A S\u00c9RIE\nIn [9]: #Plotar grafico.pode ser necess\u00e1rio alterar os eixos.\nplt.figure(figsize=(13.5, 3.5))\ndata [' BR?M3' ].pior(color='b')\nplt.title('Evolu\u00e7\u00e3o diaria do pre\u00e7o de fechamento da a\u00e7\u00e3o BRKM3') plr. xlabel('Ter\u00e7o') plt.ylabel('RS') pit .xticlcs (rotation=50)\n0ut[9]: (array([736361., 736420., 736481., 736542., 736603., 736664., 736726., 736785., 736846., 736907.]),&lt;a list of 10 Text xtlcklabel objects\u00bb\nIn [10]: fig, axarr = pit.subplots(2, sbarex=True)\nfig.set_size_inches(13.5, 3.5)\nplot_pacf(data['BRJW3'], ax=axarr[1], lags=5j) axarr[1].set_title('PACT')\nplot_acf(data['BRKM3'], ax=axarr[0],lags=50) axarr[0).set_title('ACF')\nOutflO]: Text(0.5,1,'ACE')\n10\nos oo -o,\n10\nos\n00\nArr\nARIMA\nMantenho como texto devido \u00e0 demora para realizar a otimiza\u00e7\u00e3o.\na\u00bbc\\aia(] for d m rangei 1for mi in range<0.29) for mai r range\u00edO. 10): try anma.obj = sm tsa SARfMAXrdatartrt'] to\u00e1stt).\norderaian.d maj) dynamc=Tme) arima_ofs_frt-anma_obf fitf) aciol ap\u00e7eod'[ari d. ma|. anma_ob(_W ac]( ercept iatieError pa\u00bb\nIn {13}: ffaicVal\nIn 114}: data.info()\n\u2022class \"pandas.core.fzaae.DataFraae\u2019e\nDatetiseIndex: 333 entries. 2017-02-17 to 2019-08-13\nSata colusns (total 4 coltms):\nData\t333\tncn-null\tdateti\u00bbe44[ns]\nBov\t333\tnon-null\tfloat<4\nS\u00bb3U\t333\tnon-null\tfloat\u20ac4\nantees\t333\tnon-null\tobject\ndtypes: datetine\u20ac4tns](I), float\u00ab4(2). tbject(l) nemcry usaje: 13.0\u00bb KB\nIn 115]: model - sB.tsa.SARIJax\u00abJataI\"Ba\u00bbn\"],or<\u00eder-(:9,l,9),trend-\"c\")\nresults \u25a0 model.fit()\nprint (results. strssary ())\n-------------------------------------------------------O--------------------------------------------------------\n\nSimuta\u00e7jc din\u00e1mica\nin \u00cd17j:\nOut[17]:\nText (J,0,5. \"Cttacao Ri\")\nX X x\nr>L* i\ndata [\"Forecast Wifft\"] - results -predict (start - 30?, end- 332, aynamic-T\u00e7ue :\ndata ([1 BR?X 51,\" Forecast \u00c0\u00c02FH' ] ] [300: 3 32 ] -plot (f igsue- (13.5,3. St, title-' Evolo\u00e7\u00e1o da eota\u00e7ld E\u00edffll \u2019) pit. xlabelf\"Dias')\npit./label(\"Cotacao Hi\")\nIn [21]: fig, axarr \u2022 pit.subplots(2, sharex-True) fig.set_sire_inches(13.5, 3.5)\nplot_pacf(results.resid, ax-axarr[1],lags\u00bb50) axarr[ 1].set_title('PACF*)\nplot_acf (results.resid, ax-axarr[0],lags-50) axarr[ 0 J.set_titie('ACF')\nOut[21]: Text(0.5,1,'ACF')\nACF\nIn [22]: #Run ADF test on the irregular variations adt_result - stattools.adfuller(results.resid, autolag-\u2019AIC') print)'p-val of the ADF test on irregular variations in employment data:', adf_result[l])\np-val of the ADF test on irregular variations in er.p 1: \u2022,r.er.t data: 0.0\nteste = pd.read_excel(*C:/Users/Thanas/Documents/EllQ/2018_02/TCC/Dado3/brk2_teste.xlsx']\nIn [29]: \u00bfVerificar qualidade do modelo\nteste['Forecast ARIMA\u2019] * results.predict(start \u00ab332, end= 385, dynamic=True)\nteste[[\u2019Cota\u00e7\u00e3o Real\u2019,'Forecast ARIMA\u2019]][332:305].plot(figsize=(13.5,3.5), title*'Evolu\u00e7\u00e3o da cota\u00e7\u00e3 o BRK3')\npit. xlabelC Dias')\nplt.ylabel('Cotacao W)\nC:\\U3er8\\Thoma2\\Anaconda3\\llb\\9ite-paclCBges\\stat3models\\t3a\\base\\tsajnodel.py:531: Valuewarning: No supported index is available. Prediction results will be given with an integer index beginnin g at \"start*.\nValueWarning)\nOut[29]: Text(0,0.5,'Cotacao R;')\nEvolu\u00e7\u00e3o da cotac\u00e2o BRIG\n370\nIn [45]: dif_Forecast_ARIMA -np.diff (teste ['Forecast ARIMA\u2019]) dlf_Cota\u00e7\u00e3o_Real -np.diff(teste['Cota\u00e7\u00e3o Real\u2019))\n350\nIn [70): ax - pit. subplot (111)\npit.plot(dif_Cota\u00e7\u00e3o_Real,label-*dif_Cota\u00e7\u00e3o_Real') pit. plot (dif_Forecast_ARIMA, labeldif_Fo rec as t_ARIMA') pit.xlim(332?350) plt.ylim(-l.5,3)\npit.ylabel('Diferencial de pre\u00e7o')\npit.xlabel('tempo')\nax.legend()\n-i o\nOut[70]\n:&lt;matplotlib.legend.Legend at 0x273a\u20ac29fdd8>\n--- C\u00edX^\u00edoRmi\nForec\u00f3\u2019t AHJVA\n3&amp;3\nDiat\n-0.5\na\u00ed_cocd\u00e7ao_3eai df -x\u00abcast ZRIMA\n1 5 J-\n332\nSUAVIZACAO EXPONENCIAL\nIn [103]: ## Criar modelo utiiizando a base de treino\nmodem - smtsa.ExponentialSB>oothlng(data['BRKM3'] ,trend-'mul') .fit () pred = modelH.predict(start-320, end=332)\nC:\\Users\\Thcinaz\\Anaccnda3\\lib\\site-package3\\statsmodels\\tsa\\base\\t3a_model.py:225: ValueWarning: A date index has been provided, but it has no associated frequency information and so will be ig noted when e.g. forecasting.\n' ignored when e.g. forecasting.', ValueWarning)\nIn [104]: pit.plot(pred.index, pred, label-* Holt-Winters')\npit.plot(pred.index, data('BRKM3'][320:333], label-'Medldo') pit.legend(loc-'best')\nOut[104): -matplotllb.legend.Legend at 0xlb740ela960>\nIn [105]: \u00bb\u00bb Exibir pa rime tros\nmode1H.params\nOut[105]: ('damping slope': nan,\n\u2022 imtlalZlevel': 31.04375457544968,\n'imtlal_seasons': array([), dtype-float64l, 'lnitlal_slope': 1.0012824161866694,\n'lands': None,\n'remove_bias': false,\n'smoothing_level': 0.7885396833992049,\n' smoothing_seasc-nal': nan,\n' 3moothing_s lope': 0.0,\n'use_boxcox': False]\nSimula\u00e7\u00e3o da s\u00e9rie temporal do adsorvedor\npit.figure(figsize=(15.5, 3.5)) plt.plot(df2[\u2019df\u2019]) plt.xlabel(\u2019Time\u2019)\npit.ylabel(\u2019DeltaP\u2019)\npit.title(\u2019Evolucao DeltaP no Adsorvedor\u2019) plt.show()\nfigj axarr = pit.subplots(2, fig.set_size_inches(19J 5.5)\nplot_pacf(df[\u2019df'], ax=axarr[1],lags=5Q) axarr[1].set_title('PACF') plot_acf(df['df'], ax=ax\u00ab axarr[01.set title('ACF\u2019)\n\tlllt\t,rl\tI\t\u00a1I\tI H r\u25a0 r H I\tII\n\t\t\t\t\t\n\t\tr\t\tr r r\tr r T T T T\t.\t\t\nTTT\t\t1 1\t1 1 1\till\t\t\t\nMODELO SARIMA\nRealizar otimiza\u00e7\u00e3o do AIC\naicVal=|] for d in range{0,1): for ar\u00ed in range{0, 13): for ma] in range(0,5): for ARI in range (0,3): for D in range (0,2): for MAJ in range (0,3): try: arimaobj smlsa.SARIMAX(dfdr|.tolist(), order=(ari,d,maj),seasonal_order=(ARI,D,MAJ125)) arima_obj_fit=arirna_obj.fit() aicVal.append([ari, d, maj, ARI, D, MAJ, arima_obj_fit.aic]) except ValueError: pass\n# ModeLar a fun\u00e7\u00e3o\nmodel = sm.tsa.SARIMAX(df['df']Jorder=(2,0Jl)Jseasonal_order=(0JlJ0J25)Jtrend= 'c', dynamic=True)\nresults = model.fit()\nprint(results.summary())\nresults.resid.plot()\n<matplotlib.axes.-Subplots.AxesSubplot at 0xl2cdb5d2a20>\nresults.resid.plot(kind='kde')\nCmatplotlib.axes._subplots.AxesSubplot at 0xl2cdbd5el60>\nfig, axarr = plt.subplots(2, sharex=True) fig.set_size_inches(13.5, 3.5)\nplotpacf(results.resid, ax=axarr[l],lags=50) axarr[l].set_title('PACF')\nplotacf(results.resid, ax=axarr[0],lags=50) axarr[0].set_title(\u2019ACF')\nText(0.5,l,'ACF')\nACF\nfrom statsmodels.tsa import stattools\n#Run ADF test on the irregutar variations\nadf_result = stattools.adfuller(results.resid, autolag='AIC') print(\u2019p-val of the ADF test on irregular variations in employment data:', adf_result[l])\np-val of the ADF test on irregular variations in employment data: 3.1828347674678043e-24\nLer Arquivos gerados\nteste = pd .read_excel('C:/Users/Thomaz/Documents/ENQ/2018_02/TCC/Dados/book.xlsx')\nDelta P Medido Forecast\n#Verificar quaLidade do modeLo\nteste['Forecast\u2018] = results.predict(start =2611, end= 3271, dynamic=True)\nteste[[ Delta P Medido','Forecast']][2611:3271].plot(figsize=(13.5,3.5),title='Evolu\u00e7\u00e3o DeltaP em Adsorvedor') pit.xlabelf1 Tempo de opera\u00e7\u00e3o (10 x min)')\npit.ylabel('DeltaP')\nC:\\Users\\Thomaz\\Anaconda3\\lib\\site-packages\\statsmodels\\tsa\\base\\tsa_model.py:531: ValueWarning: No supported index is availabl e. Prediction results will be given with an integer index beginning at 'start'.\nValueWarning)\nText(\u00a9,0.5,'DeltaP')\nEvolu\u00e7\u00e3o DeltaP em Adsorvedor\n2900\t3000\nTempo de opera\u00e7\u00e3o (10 x min)\n040\n035\n030\no. 0.25\n\u25a1 0.20\n0.15\n010\n0.05\nAplicando o M\u00e9todo B\nRegress\u00e3o Linear - capturar tend\u00eancia T|\nfrom sklearn.linearjnodel import LinearRegression\ntrendmodel = LinearRegression(normalize=True, fit_intercept=True)\ntrend_model.fit(np.arange(df.shape[0]).reshape((-l,l)),df['df'])\nLinearRegression(copy_X=True, fit_intercept=True, n_jobs=l, normalize=True) print('Trend model coefficient^} and intercept={}'.format(trend_model.coef_[0],\ntrendmodel.intercept-) ) \u2019\nTrend model coefficient=3.2658430951974774e-05 and intercept=0.16345646911062195\ndef fourierExtrapolation(x, npredict):\nn = x.size\nn_harm =10\nt = np.arange(0, n)\np = np.polyfit(t, x, 1)\nx_notrend = x\nxfreqdom \u2022 fft.fft(xnotrend)\nf = fft.fftfreq(n)\nindexes.sort(key = lambda i: np.absolute(f[i]))\nt = np.arange(0, n + n_predict)\nrestoredsig = np.zeros(t.size)\nfor i in indexes[:l +\u25a0 n_harm * 2]:\nampli = np.absolute(x_freqdom[i]) / n\npha se \u2022 np.angle(x_freqdom[i])\nrestoredsig += ampli * np.cos(2 * np.pi \u2022 f[i] * t + phase) return restored_sig\nx = np.array(df['dt'][195:220].values)\nn_predict \u2022 3246\nextrapolation = fourierExtrapolation(x, npredict)\nfig, axarr = plt.subplots(l, sharex=True)\nfig.set_size_inches(15.5, 5.5)\nplt.plot(np.arange(0, 105), df['dt'][195:300], 'b\u2018, label - 'x', linewidth - 3) plt.plot(np.arange(0, extrapolation.size), extrapolation, 'r', label = 'extrapolation') plt.legend()\ntestef[\u2019Delta P MedidoForecast Decomposi\u00e7\u00e3o']][0:220].plot(figsize=(13.5,3.5),title=\u2019Evolu\u00e7\u00e3o DeltaP em Adsorvedor\u2019) plt.xlabel(\u2019Tempo de opera\u00e7\u00e3o (min)\u2019)\npit.ylabel('DeltaP')\nText(0,0.5,\u2019DeltaP\u2019)\nEvolu\u00e7\u00e3o DeltaP em Adsorvedor\n-0 05\n0\t50\t100\t150\t200\nTempo de opera\u00e7\u00e3o (min)\nteste.to_excel(\u2019C:/Users/Thomaz/Documents/ENQ/2018_02/TCC/Dados/fourier.xlsx\u2019)\nfft = pd.read_excel('C:/Users/Thomaz/Documents/ENQ/2018_02/TCC/Dados/fourier_cc.xlsx')\nfft[['Delta P Medido't 'Forecast Decomposi\u00e7\u00e3o']][2611:3271].plot(figsize=(13.5,3.5),title='Evolu\u00e7\u00e3o DeltaP em Adsorvedor') pit.xlabel('Tempo de opera\u00e7\u00e3o (10 x min)\u2019)\npit.ylabel('DeltaP')\nText(0,0.5,'DeltaP')\nEvolu\u00e7\u00e3o DeltaP em Adsorvedor\nTempo de opera\u00e7\u00e3o (10 x mini\nSimula\u00e7\u00e3o da s\u00e9rie temporal do CO2\n##Importando os dados\ndatac = pd.read_excel(,C:/Users/Thomaz/Documents/ENQ/2018_02/TCC/Dados/Monthly_CO2_Concentrations.xlsx')\ndatac.\u00edndex = datac.Date\nCRIAR BASE PARA DESENVOLVER O MODELO\n## Base para treinar o modeLo\ndata = datac[:130]\n## Base para testar o modeLo\nteste = datac[130:]\nfig, axarr = pit.subplots(2, sharex=True) fig.set_size_inches(12.5, 3.5)\nplotpacf(data[\u2019C02'], ax=axarr[l],lags=24) axarr[1].set_title('PACF')\nplotacf(data[' C02'], ax=axarr[0],lags=24) axarr[0].set title('ACF')\nText(0.5,l,'ACF')\nACF\nPRIMEIRO MODELO - REGRESS\u00c3O LINEAR\nfrom sklearn.linear_model import LinearRegression\ntrend_model = LinearRegression(normalize=True, fit_intercept=True)\ntrend_model.fit(np.arange(data.shape[0]).reshape((-1,1))data['C02'])\nLinearRegression(copy_X=True, fit_intercept=Truej n_jobs=l, normalize=True)\nprint('Trend model coefficient={} and intercept={}'.format(trend_model.coef_[0],\ntrendmodel.intercept)\n)\nTrend model coefficient=0.12158633874557882 and intercept=329.4191426893717\nresiduals = np.array(data['C02']) - trend_model.predict(np.arange(data.shape[0]).reshape((-l,l)))\ntm = trend_model.predict(np.arange(data.shapefO]).reshape(-ljl))\ntm = trend_model.predict(np.arange(data.shape[0]).reshape(-ljl))\ndata['tmT ] = tm\nresiduals = data['CO2'J - tm\ndata['Residuals'] = residuals\nmonthwise_avg = data.groupby(by=['Month'])['Residuals'].aggregate(['mean'])\ndata['media'] = data.Month.map(monthwise_avg['mean'])\nirrvar = data['CO2'J - dataf'tm'] - data['media']\nfrom statsmodels.tsa import stattools\ndata['F_RL'] = dataf'media']+ data['tm']\nadf_result = stattools.adfuller(data['iv'], autolag='AIC')\nprint('p-val of the ADF test:', adf_result[l]) tfUnidade do indicador\np-val of the ADF test: 0.023578883820030202\nMODELO SARIMA\naicVal=[]\nfor d in range(1,2):\nfor ari in range(0, 3):\nfor maj in range(0,3):\nfor ARI in range (0,3):\nfor D in range (0,2):\nfor MAJ in range (0,3):\ntry:\narima_obj = sm.tsa.SARIMAX(data['C02'].tolist(), order=(ari,d,maj),seasonal_order=(ARI,D,MAJ,12)) arima_obj_fit=arima_obj.fit()\naicVal.append([ari, d, maj, ARI, D, MAJ, arima_obj_fit.aic])\nexcept ValueError:\npass\nmodel = sm.tsa.SARIMAX(data[ 'C02' ],order=(2,l,0),seasonal_order=(0,l,l,12)) results = model.fit()\nprint(results.summary())\ndata['forecast'] = results.predict(start = 50, end= 134) data[['C02\u2018,\u2019forecast\u2019]].plot(figsize=(13.5,3.5))\nresults.resid.plot(kind=\u2019kder, xlim=(-50,50))\n#Run ADF test on the irreguLar variations\nadf_result = stattools.adfuller(results.resid, autolag= 'AIC1)\nprint('p-val of the ADF test on irregular variations in employment data:', adf_result[l])\np-val of the ADF test on irregular variations in employment data: 0.0\nCOMPARAR SARIMA vs BASE ORIGINAL\nfrom pandas.tseries.offsets import DateOffset\nfuture_dates = [data.index[-1] + DateOffset(months=x) for x in range(0,620)]\nfuture_dates_df = pd.DataFrame(index=future_dates[l:],columns=data.columns)\nfuture_df = pd.concat([data,future_dates_df])\nX = np.array(datac['C02']) future_df['C02Medido'] = X\nF = future_df['C02'],dropna()\nfuture_df['forecast'] = results.predict(start = 130, end = 900, dynamic= True)\nHOLT WINTERS MODEL\n## Criar modeio utilizando a base de treino\nmodelH = smtsa.ExponentialSmoothing(data['C02']J seasonal=\u2019addT, trend=\u2019add\u2019J seasonal_periods=12).fit() pred = modelH.predict(start=data['C02\u2019].index[0], end=data['C02'].index[-1])\npit.plot(pred.index, pred, label=\u2019Holt-Winters')\npit.plot(pred.index, data['CO2'J, label='Medido')\npit.legend(loc=\u2018best')\n## Exibir par\u00e2metros modelH.params\nfuture_df['HW-Forecast1]= modelH.predict(start=130, end=900)\n# PACF e ACF dos res\u00edduos\nfig, axarr = plt.subplots(2, sharex=True) \u25a0fig.set_size_inches(15.5, 5.5)\nplotpacf(modelH.resid, ax=axarr[l],lags=50) axarr[l].set_title('PACF')\nplot_acf(modelH.resid, ax=axarr[0],lags=50) axarr[0].set_title('ACF')"}]}}}