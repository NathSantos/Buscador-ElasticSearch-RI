{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.21247"}, {"@name": "filename", "#text": "4965_Davolio_Alessandra_D.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "i \n\nALESSANDRA DAV\u00d3LIO GOMES \n\n \n \n \n \n\nUSING RESERVOIR SIMULATION TO \nCONSTRAIN THE ESTIMATION OF DYNAMIC \n\nPROPERTIES FROM 4D SEISMIC \n \n \n \n\nUSO DA SIMULA\u00c7\u00c3O DE RESERVAT\u00d3RIOS PARA \nRESTRINGIR A ESTIMATIVA DE PROPRIEDADES \n\nDIN\u00c2MICAS A PARTIR DA S\u00cdSMICA 4D \n \n \n \n \n \n \n \n \n\nCAMPINAS \n \n\n2013 \n\n\n\n \n\n \n\n \n\nii \n\n  \n\n\n\n \n\n \n\n \n\niii \n\nUNIVERSIDADE ESTADUAL DE CAMPINAS \n\nFACULDADE DE ENGENHARIA MEC\u00c2NICA \n\nE INSTITUTO DE GEOCI\u00caNCIAS \n\nALESSANDRA DAV\u00d3LIO GOMES \n\nUSING RESERVOIR SIMULATION TO CONSTRAIN THE \nESTIMATION OF DYNAMIC PROPERTIES FROM 4D SEISMIC \n\n \n\nUSO DA SIMULA\u00c7\u00c3O DE RESERVAT\u00d3RIOS PARA RESTRINGIR \nA ESTIMATIVA DE PROPRIEDADES DIN\u00c2MICAS A PARTIR DA \n\nS\u00cdSMICA 4D \nThesis presented to the Mechanical Engineering \nFaculty and Geosciences Institute of the University \nof Campinas in partial fulfillment of the requirements \nfor the degree of Doctor in Petroleum Sciences and \nEngineering in the area of Reservoirs and \nManagement. \n\nTese apresentada \u00e0 Faculdade de Engenharia \nMec\u00e2nica e Instituto de Geoci\u00eancias da \nUniversidade Estadual de Campinas como parte dos \nrequisitos exigidos para a obten\u00e7\u00e3o do t\u00edtulo de \nDoutora em Ci\u00eancias e Engenharia de Petr\u00f3leo na \n\u00e1rea de Reservat\u00f3rios e Gest\u00e3o. \n\n \nOrientador: Prof. Dr. Denis Jos\u00e9 Schiozer \nCo-orientador: Dr. C\u00e9lio Maschio \n\n \n \n\nCAMPINAS \n2013 \n\n\n\nFicha catalogr\u00e1fica\nUniversidade Estadual de Campinas\n\nBiblioteca da \u00c1rea de Engenharia e Arquitetura\nRose Meire da Silva - CRB 8/5974\n\n    \n  Dav\u00f3lio, Alessandra, 1980-  \n D311u DavUsing reservoir simulation to constrain the estimation of dynamic properties\n\nfrom 4D seismic / Alessandra Dav\u00f3lio Gomes. \u2013 Campinas, SP : [s.n.], 2013.\n \n\n   \n  DavOrientador: Denis Jos\u00e9 Schiozer.\n  DavCoorientador: C\u00e9lio Maschio.\n  DavTese (doutorado) \u2013 Universidade Estadual de Campinas, Faculdade de\n\nEngenharia Mec\u00e2nica e Instituto de Geoci\u00eancias.\n \n\n    \n  Dav1. Reservat\u00f3rio de petr\u00f3leo. 2. Engenharia de petr\u00f3leo. 3. Engenharia de\n\npetr\u00f3leo - Metodos de simula\u00e7\u00e3o. 4. Geof\u00edsica. 5. Prospec\u00e7\u00e3o s\u00edsmica. I. Schiozer,\nDenis Jos\u00e9,1963-. II. Maschio, C\u00e9lio. III. Universidade Estadual de Campinas.\nFaculdade de Engenharia Mec\u00e2nica. IV. T\u00edtulo.\n\n \n\nInforma\u00e7\u00f5es para Biblioteca Digital\n\nT\u00edtulo em outro idioma: Uso da simula\u00e7\u00e3o de reservat\u00f3rios para restringir a estimativa de\npropriedades din\u00e2micas a partir da s\u00edsmica 4D\nPalavras-chave em ingl\u00eas:\nReservoir simulation\nPetroleum engineering\nPetroleum engineering - Simulation method\nGeophysics\nSeismic prospecting\n\u00c1rea de concentra\u00e7\u00e3o: Reservat\u00f3rios e Gest\u00e3o\nTitula\u00e7\u00e3o: Doutora em Ci\u00eancias e Engenharia de Petr\u00f3leo\nBanca examinadora:\nDenis Jos\u00e9 Schiozer [Orientador]\nOsvair Vidal Trevisan\nAlexandre Anoz\u00e9 Emerick\n\u00c1lvaro Favinha Martini\nThierry Jean-Louis Marie Coleou\nData de defesa: 24-10-2013\nPrograma de P\u00f3s-Gradua\u00e7\u00e3o: Ci\u00eancias e Engenharia de Petr\u00f3leo\n\nPowered by TCPDF (www.tcpdf.org)\n\niv\n\nhttp://www.tcpdf.org\n\n\n \n\n \n\n \n\nv \n\n \n\nUNIVERSIDADE ESTADUAL DE CAMPINAS \n\nFACULDADE DE ENGENHARIA MEC\u00c2NICA \n\nE INSTITUTO DE GEOCI\u00caNCIAS \n\nTESE DE DOUTORADO \n\nUSING RESERVOIR SIMULATION TO CONSTRAIN THE \nESTIMATION OF DYNAMIC PROPERTIES FROM 4D SEISMIC \n\nAuthor: Alessandra Dav\u00f3lio Gomes \nAdvisor: Prof. Dr. Denis Jos\u00e9 Schiozer \nCo-advisor: Dr. C\u00e9lio Maschio \n\n \n\nCampinas, 24 de outubro de 2013 \n  \n\n\n\n \n\n \n\n \n\nvi \n\n \n\n \n\n  \n\n\n\n \n\n \n\n \n\nvii \n\n \n\nDEDICATION \n\nThis work is dedicated to a great (and patient) partner: Ricardo. \n\n \n\n \n\n  \n\n\n\n \n\n \n\n \n\nviii \n\n \n\n  \n\n\n\n \n\n \n\n \n\nix \n\nACKNOWLEDGMENTS \n\n(AGRADECIMENTOS) \n\nI believe that talking about feelings is better done in our mother language so, for the \nfollowing, pardon my Portuguese. \n\nAo meu orientador, Prof. Denis Schiozer, pelas valiosas (e diversas) discuss\u00f5es e ideias. \nInclusive, e talvez principalmente, por aquelas em que n\u00e3o concordamos de in\u00edcio! \nTamb\u00e9m pelo seu entusiasmo para novas possibilidades, o que me incentivou a aceitar \nnovos desafios. \n\nAo C\u00e9lio Maschio, pela prontid\u00e3o para discutir resultados e ideias. Pelas in\u00fameras dicas \nde programa\u00e7\u00e3o, formata\u00e7\u00e3o de texto, manipula\u00e7\u00e3o de softwares e afins! Agrade\u00e7o \ntamb\u00e9m por me convencer a submeter o primeiro artigo deste trabalho, que acabou se \ntornando o ponto de partida para a estrutura\u00e7\u00e3o da tese! \n\nAos meus pais, Ignez e Neudeci, pelo imensur\u00e1vel apoio em todos os meus passos. \n\nAo meu esposo, Ricardo, grande incentivador deste trabalho! Al\u00e9m de contribuir \ndiretamente com instala\u00e7\u00f5es de softwares e corre\u00e7\u00e3o de textos, reconhe\u00e7o que o bem que \nsua companhia me faz tem uma parcela consider\u00e1vel em todas as minhas realiza\u00e7\u00f5es. \nObrigada pelo companheirismo e pelo colorido que traz \u00e0 minha vida! \n\n\u00c0 toda minha fam\u00edlia, em especial \u00e0queles que est\u00e3o mais pr\u00f3ximos: Adriana, Fabiano e \nminhas grandes paix\u00f5es, Isabela e Felipe, que me ensinaram que pular corda \u00e9 um \u00f3timo \nexerc\u00edcio para esquecer (momentaneamente) uma tese pendente... \n\n\u00c0 minha fam\u00edlia baiana a quem, apesar de inclu\u00edda no par\u00e1grafo acima, gostaria de \nagradecer, de forma especial, todo o carinho e incentivo recebidos.  \n\nA todos os meus amigos, simplesmente por existirem em minha vida! Em especial, a duas \nfiguras bastante presentes durante o desenvolvimento deste trabalho: Perin, pela arte e \npelas dicas de Matlab e Marcos Sebasti\u00e3o, por sempre me ajudar em meus devaneios \ngeof\u00edsicos e me confortar durante as tais crises do \u201ct\u00e1 tudo errado!\u201d. Agrade\u00e7o tamb\u00e9m ao \nJean-Luc, que al\u00e9m da conviv\u00eancia, me proporcionou importantes aprendizados sobre \ngeof\u00edsica. Al\u00e9m de ter me ajudado a montar a banca avaliadora! Merci! \n\nAo Henning Hoeber, por gentilmente disponibilizar uma das ferramentas mais \u00fateis que \nconhe\u00e7o para gerar apresenta\u00e7\u00f5es! (Thanks, Henning!) \n\n\n\n \n\n \n\n \n\nx \n\nAos meus colegas do UNISIM, CEPETRO e DEP, por todo tipo de ajuda.  \n\n\u00c0 PETROBRAS e \u00e0 BG, pelo apoio financeiro. \n \n\n \n \n\n  \n\n\n\n \n\n \n\n  \n\nxi \n \n\n\u201cThe mind that opens to a new idea never returns \n\nto its original size.\u201d \n\nAlbert Einstein (supposedly) \n\n \n\n  \n\n\n\n \n\n \n\n  \n\nxii \n \n\n \n\n  \n\n\n\n \n\n \n\n  \n\nxiii \n \n\nABSTRACT \n\nThe focus of this work is to use reservoir engineering data from numerical flow simulation \n\nto improve the quantitative interpretation of 4D seismic signals. The idea is to use engineering \n\nknowledge to minimize possible incorrect information provided by 4D seismic before using it to \n\nupdate reservoir simulation models in a history matching procedure. In this work the integration \n\nbetween the two dataset is done in the pressure and saturation domain. So, the first part of the \n\nwork presents a methodology to estimate pressure and saturation changes from 4D seismic \n\nthrough a petro-elastic inversion procedure. This procedure can be seen as a tool to apply the \n\nintegration methodology of the second part which is one of the main contributions of this work. \n\nThe integration methodology uses multiple simulation models to constrain the estimation of \n\npressure and saturation from 4D seismic. As a result, less noisy maps were obtained, allowing a \n\nbetter interpretation of the reservoir changes. Following the traditional sequence, the estimated \n\nsaturation map is then used as input to the history matching process presented in the third part of \n\nthe work. It was shown that the history matching procedure provides better results if the input \n\ndata, in this case the saturation map, respects the expected mass balance, which was not the case \n\nfor the dataset considered. Thus, a methodology to calibrate the volume of injected water \n\nassociated to the saturation map provided by 4D seismic is presented in the last part of the work, \n\nwhich is another important contribution to be highlighted. To better control the results of all the \n\nmethodologies here presented, a synthetic dataset was used in the entire work. Although \n\nsatisfactory results were observed for this dataset, it is important to highlight that the main \n\ncontributions of this work are not only the results, but the methodologies proposed, that present \n\nan innovative perspective for 4D seismic and reservoir engineering data integration. \n\nKeywords: 4D seismic; reservoir simulation; history matching; time-lapse seismic \n\nintegration.  \n\n\n\n \n\n \n\n  \n\nxiv \n \n\n\n\n \n\n \n\n  \n\nxv \n \n\nRESUMO \n\nO foco deste trabalho \u00e9 usar dados de engenharia de reservat\u00f3rios gerados atrav\u00e9s da \n\nsimula\u00e7\u00e3o de fluxos para melhorar a interpreta\u00e7\u00e3o quantitativa da s\u00edsmica 4D. A ideia \u00e9 usar os \n\nconhecimentos de engenharia para minimizar poss\u00edveis informa\u00e7\u00f5es incorretas geradas pela \n\ns\u00edsmica 4D, antes de us\u00e1-la para atualizar modelos de simula\u00e7\u00e3o de reservat\u00f3rios em um \n\nprocedimento de ajuste de hist\u00f3rico. Neste trabalho a integra\u00e7\u00e3o entre estes dois conjuntos de \n\ndados \u00e9 feita no dom\u00ednio da press\u00e3o e satura\u00e7\u00e3o. Dessa forma, a primeira parte do trabalho \n\napresenta uma metodologia para estimar varia\u00e7\u00f5es de press\u00e3o e satura\u00e7\u00e3o a partir da s\u00edsmica 4D \n\natrav\u00e9s de um procedimento de invers\u00e3o petro-el\u00e1stica. Este procedimento pode ser visto como \n\numa ferramenta para aplicar a metodologia de integra\u00e7\u00e3o da segunda parte, que \u00e9 uma das \n\nprincipais contribui\u00e7\u00f5es deste trabalho. A metodologia de integra\u00e7\u00e3o usa m\u00faltiplos modelos de \n\nsimula\u00e7\u00e3o para restringir a estimativa de press\u00e3o e satura\u00e7\u00e3o a partir da s\u00edsmica 4D. Como \n\nresultado, observaram-se mapas menos ruidosos que permitem, portanto, uma melhor \n\ninterpreta\u00e7\u00e3o das varia\u00e7\u00f5es ocorridas no reservat\u00f3rio. Seguindo a sequencia tradicional de \n\ntrabalho, o mapa de satura\u00e7\u00e3o estimado foi ent\u00e3o usado como dado de entrada em um processo de \n\najuste de hist\u00f3rico apresentado na terceira parte da tese. Foi mostrado que o procedimento de \n\najuste gera melhores resultados quando o dado de entrada, neste caso mapa de satura\u00e7\u00e3o, respeita \n\no balan\u00e7o de massa, o que n\u00e3o acontecia para os dados considerados. Assim, uma metodologia \n\npara calibrar o volume de \u00e1gua injetada associado ao mapa de satura\u00e7\u00e3o gerado pela s\u00edsmica 4D \u00e9 \n\napresentada na \u00faltima parte do trabalho, que \u00e9 outra contribui\u00e7\u00e3o importante a se destacar. Para \n\nmelhor controlar os resultados de todas as metodologias aqui apresentadas foram usados dados \n\nsint\u00e9ticos em todo o trabalho. Embora resultados satisfat\u00f3rios tenham sido observados para este \n\nconjunto de dados, \u00e9 importante destacar que as principais contribui\u00e7\u00f5es deste trabalho n\u00e3o s\u00e3o \n\napenas os resultados observados, mas as metodologias propostas, que apresentam uma \n\nperspectiva inovadora para integra\u00e7\u00e3o entre dados de s\u00edsmica 4D e engenharia de reservat\u00f3rios. \n\nPalavras-Chave: s\u00edsmica 4D; simula\u00e7\u00e3o de reservat\u00f3rios; ajuste de hist\u00f3rico; integra\u00e7\u00e3o \n\nentre simuladores de fluxo e s\u00edsmica 4D. \n\n \n\n \n\n\n\n \n\n \n\n  \n\nxvi \n \n\n  \n\n\n\n \n\n \n \n\n  \n\nxvii \n\nTABLE OF CONTENTS \n\n1. INTRODUCTION....................................................................................................................1 \n1.1. Motivation...........................................................................................................................3 \n\n1.2. Objective..............................................................................................................................4 \n\n1.3. Premises...............................................................................................................................4 \n\n1.4. Description of the work.......................................................................................................5 \n\n1.4.1. Paper 1: \u201cPressure and saturation estimation from P and S impedances: a \n\ntheoretical study\u201d \u2026\u2026................................................................................................5 \n\n1.4.2. Paper 2: \u201cA methodology to constrain pressure and saturation estimation from \n\n4D seismic using multiple simulation models and observed data\u201d .............................6 \n\n1.4.3. Paper 3: \u201cLocal history matching using 4D seismic data and multiple models \n\ncombination\u201d ...............................................................................................................7 \n\n1.4.4. Paper 4: \u201cA methodology to calibrate water saturation estimated from 4D \n\nseismic\u201d .......................................................................................................................8 \n\n2. PAPER 1: Pressure and saturation estimation from P and S impedances: a theoretical \nstudy\u2026\u2026\u2026...\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026.9 \n\n3. PAPER 2: A methodology to constrain pressure and saturation estimation from 4D seismic \nusing multiple simulation models and observed data\u2026\u2026...\u2026\u2026\u2026\u2026\u2026\u2026\u2026..\u2026\u2026\u2026\u2026\u202625 \n\n4. PAPER 3: Local history matching using 4D seismic data and multiple models \ncombination\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026..39 \n\n5. PAPER 4: A methodology to calibrate water saturation estimated from 4D \nseismic\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026...\u2026\u2026...53 \n\n6. CONCLUSIONS\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026...\u2026\u2026..73 \n7. FUTURE WORKS\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026..77 \nREFERENCES\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026.79 \n\nAPPENDIX A : Complementary results of the paper \u201cPressure and saturation estimation \n\nfrom P and S impedances: a theoretical study\u201d \u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026....87 \n\n \n\n\n\n \n\n \n \n\n  \n\nxviii \n\nAPPENDIX B : Complementary results of the paper \u201cLocal history matching using 4D \n\nseismic data and multiple models combination\u201d\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026..\u2026....109 \n\nAPPENDIX C : Complementary results of the paper \u201cA methodology to calibrate water \n\nsaturation estimated from 4D seismic\u201d\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026.................113 \n\n \n \n\n \n\n\n\n1. INTRODUCTION \n\nReservoir simulation is one of the main tools used for dynamic reservoir characterization \n\nand management. Thus, one of the principal tasks of geoscientists and reservoir engineers is to \n\nbuild reliable models, which is not an easy task due to the complexity present in this kind of \n\nproblem. The complexity comes mainly from the lack of geological information required to build \n\nsuch models. The confidence in the simulation models can be improved by incorporating \n\ndynamic data in a history matching procedure.  \n\nTraditional history matching procedures use well information such as pressure, oil, water \n\nand gas rates, to update the static model properties such as permeability, porosity, faults \n\ntransmissibility and so on. The use of well data is generally insufficient to give confidence to \n\nsimulation models because the process is an inverse and ill-posed problem.    \n\nThe use of time-lapse seismic (also called 4D seismic) in history matching procedures is \n\nrelatively new, but has become increasingly common in the recent years. The main contribution \n\nthat this data brings is the areal information regarding the dynamic properties variations (such as \n\npressure and saturation changes) observed due to production. Thus, instead of having only \n\nproduction profiles at very few points in the reservoir (well locations), spatial variations of \n\ndynamic properties also become accessible. This type of information can be used to update \n\nreservoir models in several ways, from qualitative interpretation, which helps to better map the \n\nuncertainties, to quantitative incorporation of seismic information inside the objective function \n\n(that measures the quality of the matching) of a history matching procedure. Another issue to be \n\nconsidered when 4D seismic is used to update reservoir models, is which seismic attribute should \n\nbe used. In general, there are three possibilities (Figure 1): (1) time-lapse seismic can be \n\nincorporated into the history matching in its original domain, i.e., in the form of seismic \n\namplitudes; (2) it can be inverted to seismic impedances; and (3) it can be converted to pressure \n\nand saturation data. Although there are several works in the literature proposing different \n\nmethodologies to integrate 4D seismic in the history matching, there is not a standard procedure \n\nto follow concerning the optimization algorithm to use, or the choice of the integration domain. \n\n     1\n\n\n\nUsually the procedure for integrating 4D seismic data and reservoir information can be \n\nsplit into two independent steps: the first is related to the efforts of geophysicists to manipulate \n\n4D seismic data and interpret the changes of reservoir properties and the second is the engineer \n\ndriven process of including this new information in the reservoir simulation model (by running a \n\nhistory matching procedure, for instance).   \n\nThis work is based on the idea that the integration between 4D seismic and simulation \n\ndata should be done not only by following the traditional sequence, where 4D seismic is an input \n\nfor a history matching. The idea is to use engineering knowledge to minimize possible incorrect \n\ninformation provided by 4D seismic before adding it to the matching procedure. Thus, this work \n\nproposes two methodologies that use simulation results to condition the estimation of dynamic \n\nproperties from 4D, which are later used in a history matching procedure.   \n\nAll of this work was developed to perform the integration between the two datasets in the \n\npressure and saturation domain (Figure 1). The reason for working in this domain is determined \n\nby the fact that the values of these physical quantities can be controlled better than the elastic \n\nproperties of rock (such as impedance); i.e., it is easier to establish feasible limits of pressure and \n\nsaturation for a given production scenario than it is to determine corresponding limits of \n\nimpedances. Thus, working in this domain allows a clear view of the methodologies presented \n\nhere.  \n\nThereby, this thesis is structured in four papers (figure 2), the first of which describes the \n\n4D inversion procedure proposed to estimate pressure and saturation from time-lapse seismic. \n\nThe second paper proposes the first methodology of integration that uses reservoir simulation \n\nresults to constrain the estimation of pressure and saturation maps to flow conditions. The third \n\npaper then proposes a history matching procedure that uses the previously estimated saturation \n\nmap to perform a local history matching. Due to noise in seismic data and errors in the \n\ncharacterization of static properties, the estimated saturation map shown in paper 2 presented a \n\nvolume of injected water larger than the expected. Thus, in the fourth and last paper, its effects on \n\nthe history matching results of paper 3 are discussed and a methodology to calibrate the volume \n\nof water is proposed.  \n\n \n\n     2\n\n\n\n \nFigure 1: Possible domains of integration between 4D seismic and simulation data. As illustrated \n\nby the green boxes, in this work P and S impedances (named IP and IS, respectively) are \n\nconverted to pressure (P) and saturation (S) values. \n\n \n\n \nFigure 2: Structure of the thesis according to the main area of concentration of each paper. \n\n1.1. Motivation \n\nThe motivation of this work is to generate more reliable reservoir models by improving \n\nthe integration between reservoir simulation and 4D seismic. Since reservoir simulation models \n\n     3\n\n\n\ncan be seen as one of the main tools for reservoir management, the accuracy of these models is \n\ndirectly related to more efficient field operations and better financial return. \n\n1.2. Objective \n\nThe objective of this work is to develop a methodology that uses reservoir behavior \n\nprediction from a flow simulator to improve the quantitative interpretation of 4D seismic data. \n\nThus, the work proposes a quantitative integration that allows the estimation of dynamic \n\nproperties from 4D signals, in agreement with information available from engineering data such \n\nas simulation results and volume of injected water. The goal is to generate a more reliable \n\nquantitative interpretation of 4D seismic, to be used as input to update reservoir simulation \n\nmodels, achieving a safer model updating when performing a history matching. \n\n1.3. Premises \n\n\u2022 In order to verify the efficiency and accuracy of the proposed methodologies, all the \n\nwork was developed using synthetic data. Two simulation models were considered, \n\ncalled base and reference models. The base model represents the available knowledge \n\nof the reservoir, so it has a lack of information on the static properties (uncertainties). \n\nThe reference model represents the true earth model, namely the answer that all the \n\nprocesses aim to reach. \n\n\u2022 The synthetic seismic data considered in this work are P and S impedances, which are \n\ngenerated by running a petro-elastic model with the reference model properties and \n\nscale. Some noise was added to the impedances in order to mimic real problems (more \n\ndetails in paper 2). No seismic amplitudes were generated so no kind of elastic \n\ninversion was run. \n\n\u2022 All data are at the same scale. All the simulation models considered in this work and \n\nseismic data were created at the same grid (110 x 90 x 5 blocks).  \n\n\u2022 As the seismic data (P and S impedances) are at the reservoir scale, they have 5 layers. \n\nSo, when the term \u201cmap information\u201d is used, it can be interpreted as volume, or five \n\nmaps information (one for each layer). \n\n     4\n\n\n\n\u2022 The base survey of the 4D seismic is considered to be acquired before production starts, \n\nso the dynamic properties of the reservoir (pressure and saturation) are considered to be \n\nknown at the initial time (it has no uncertainties). \n\n\u2022 No presence of gas (waterflood example above bubble pressure). \n\n\u2022 Case studied: sandstone reservoir. \n\n\u2022 The dynamic properties considered in this work are pressure and water saturation. \n\n1.4. Description of the work  \n\nThis thesis is structured in four scientific papers. This section presents a summary of each \n\npaper, highlighting the main contributions and how they are connected in the building of the \n\nwhole thesis. The thesis also comprises three appendixes with complementary analyses and \n\nresults of the papers; the relations between the papers and the appendixes are described in this \n\nsection as well.  \n\nThe papers in full extension are presented in the following chapters. \n\n1.4.1. Paper 1: \u201cPressure and saturation estimation from P and S impedances: a \ntheoretical study\u201d \n\nAlessandra Davolio, C\u00e9lio Maschio, Denis Jos\u00e9 Schiozer \nJournal of Geophysics and Engineering, August 2012, v.9, p.447-460 \n\n \nThe first paper of this work presents a theoretical study of the proposed petro-elastic \n\ninversion process, which estimates pressure and saturation from time-lapse seismic. The \n\nestimation is achieved by an optimization procedure solved by a gradient-type method. As stated \n\nin the premises, this work considers synthetic data so, this paper presents a discussion that starts \n\nwith an ideal dataset (free of error or noise) to explain the necessity of using two seismic \n\nattributes (P and S impedances). Then, some uncertainties in the static properties and errors in the \n\nseismic data were gradually considered and the inversion behavior was analyzed. When \n\nerrors/uncertainties were considered, it was possible to verify the importance of using a 4D \n\napproach in the inversion scheme instead of a 3D inversion. The main goal of this paper is to \n\nbetter understand the inversion itself and the robustness and confidence of the optimization \n\nalgorithm used; hence, it presents discussions on the objective function behavior, initial guess and \n\n     5\n\n\n\nuniqueness of solution. To be able to visualize these issues, all the results presented are related to \n\nsingle reservoir blocks. This is possible because the inversion is run independently for each grid \n\nblock.  \n\nThe main contribution of this paper to the thesis is the implementation of a 4D inversion \n\nalgorithm to obtain pressure and saturation from time-lapse seismic and the understanding of its \n\nadvantages and limitations.   \n\nAppendix A presents some complementary results from paper 1. The same issues \n\ndiscussed in paper 1 for a single reservoir location are presented in Appendix A for an entire \n\nreservoir model so that the inversion results can be analyzed for different combinations of static \n\nand dynamic properties (namely different reservoir locations). The results presented in Appendix \n\nA were extracted from the work of Davolio et al (2011), which is attached at the end of the same \n\nappendix.  \n\n1.4.2. Paper 2: \u201cA methodology to constrain pressure and saturation estimation from \n4D seismic using multiple simulation models and observed data\u201d \n\nAlessandra Davolio, C\u00e9lio Maschio, Denis Jos\u00e9 Schiozer \nJournal of Petroleum Science and Engineering, April 2013, v. 105, p. 51-61 \nPresented at SEG/SPE/AAPG Workshop \u201cNew advances in integrated reservoir \nsurveillance\u201d, California, 24-29 June 2012  \n \n\nThis paper proposes a methodology to constrain the inversion process presented in paper 1 \n\nto flow conditions. It is well known that seismic data carry errors due to a number of causes, from \n\nthe acquisition methods to specific data processing procedures that can yield wrong reservoir data \n\nestimation. The central idea of the proposed methodology is that before using 4D seismic data in \n\na history matching process, especially quantitatively, this data can be conditioned to some known \n\nengineering information. As in any optimization process, the solution space of the proposed \n\ninversion procedure can be constrained by known limits. For instance, in our case, they could be \n\nconsidered as general constraints of water saturation, connate water and one minus the residual \n\noil saturation. But, instead of using these general values, the methodology proposes to extract \n\nminimum and maximum values for saturation and pressure from the simulation of multiple \n\nreservoir models. The multiple models are generated through the combination of the most \n\nimportant reservoir attributes, mapped as uncertainties. So, the limits imposed to the 4D seismic \n\n     6\n\n\n\nare derived from the knowledge available at the current stage of the characterization process. The \n\nresults presented show that the dynamic properties estimated through these constraints are less \n\nnoisy and have more confidence to be further applied qualitatively or quantitatively in a history \n\nmatching procedure. The main contribution of this work is the proposed methodology that allows \n\nchecking the information extracted from 4D seismic to verify that it is in agreement with the \n\nuncertainties mapped in the characterization process. \n\n1.4.3. Paper 3: \u201cLocal history matching using 4D seismic data and multiple models \ncombination\u201d \n\nAlessandra Davolio, C\u00e9lio Maschio, Denis Jos\u00e9 Schiozer \nPresented at the EAGE/SPE Europec Annual Conference &amp; Exhibition, London, United \nKingdom, 10\u201313 June 2013 \n \nThe third paper proposes a history matching methodology that uses the water saturation \n\ndistribution obtained from 4D seismic data (resulting from paper 2) to update local properties. \n\nThe idea behind the process is the use of saturation changes estimated from 4D seismic as local \n\ninformation for each injector well. The procedure proposed uses several model realizations as \n\ninput, which are the same as those used in paper 2. The updating step is then made by a \u201ccopy \n\nand paste\u201d procedure of the grid properties, such as porosity and permeability that are represented \n\nby geostatistical images. Then, the methodology replaces the base model properties with those \n\nextracted from the best model chosen for each region. The results showed that the updated model \n\nyielded a saturation map that is closer to the one observed from seismic. Thus, the main \n\ncontribution of this paper is an easy-to- implement procedure that generates an updated model \n\nthat reproduces the changes observed in 4D seismic and presents updated properties with \n\ngeological aspects. So, it can be seen as an alternative to the sophisticated algorithms that \n\nincorporate geostatistical images in the history matching process. \n\nThe results of paper 2 are maps of saturation and pressure, so, for the dataset considered \n\nin this work, both maps would be available to perform the history matching. However, as \n\npresented in Appendix B, a satisfactory pressure map was achieved after a calibration of the \n\nglobal reservoir properties, which justifies the use of only the saturation map in the history \n\nmatching presented in paper 3. See Appendix B for more details on pressure behavior.  \n\n     7\n\n\n\n1.4.4. Paper 4: \u201cA methodology to calibrate water saturation estimated from 4D \nseismic\u201d \n\nAlessandra Davolio, C\u00e9lio Maschio, Denis Jos\u00e9 Schiozer \nTo be submitted to a journal \n \n\nAlthough the local history matching proposed in paper 3 yielded an updated model that \n\nbetter follows the map provided by 4D seismic, this model presents more injected water than it \n\nshould. The increase in the amount of injected water in the updated model was caused by the \n\nsaturation map used as input in the matching procedure, since the volume of injected water \n\nassociated to this saturation map was larger than the known injected volume (due to errors during \n\nthe inversion caused by noise in seismic data and errors in the static properties). Thus, the \n\nupdating process (local history matching procedure) is working properly, but the input parameter \n\nfor this process needs to be calibrated so that the matching process yields a more reliable updated \n\nmodel. In this sense, this last paper presents a methodology to calibrate the volume of injected \n\nwater presented in the estimated saturation map. This methodology can be seen as an extension of \n\nthe methodology proposed in paper 2.  \n\nPaper 4 presents a discussion concerning the improvement in the estimated saturation \n\nmap, followed by a comparison of the history matching results when different saturation maps are \n\nused as input (with and without the calibration).  \n\nThe main contribution of this paper is to show the importance of having a better \n\nestimation of saturation changes from 4D seismic to update reservoir models. \n\nThere are some complementary results regarding this paper in Appendix C, which include \n\nan analysis of how the methodologies of papers 2 and 4 improve the optimization response and \n\nthe well curves after applying the history matching.  \n\n \n\n     8\n\n\n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n2. PAPER 1: Pressure and saturation estimation from P and S \n\nimpedances: a theoretical study \n\nAlessandra Davolio, C\u00e9lio Maschio, Denis Jos\u00e9 Schiozer \n\nJournal of Geophysics and Engineering, August 2012, v.9, p.447-460 \n\n \n\n \n\n     9\n\n\n\n     10\n\n\n\nIOP PUBLISHING JOURNAL OF GEOPHYSICS AND ENGINEERING\n\nJ. Geophys. Eng. 9 (2012) 447\u2013460 doi:10.1088/1742-2132/9/5/447\n\nPressure and saturation estimation from\nP and S impedances: a theoretical study\n\nAlessandra Davolio, Ce?lio Maschio and Denis Jose? Schiozer\n\nDepartment of Petroleum Engineering, FEM, UNICAMP/CEPETRO, Sa?o Paulo, Brazil\n\nE-mail: davolio@dep.fem.unicamp.br, celio@dep.fem.unicamp.br and denis@dep.fem.unicamp.br\n\nReceived 14 October 2011\n\nAccepted for publication 8 June 2012\n\nPublished 16 August 2012\n\nOnline at stacks.iop.org/JGE/9/447\n\nAbstract\n\nThis work represents the first step of a study to integrate time lapse seismic and reservoir\n\nengineering data where a petro-elastic inversion from seismic data to pressure and saturation is\n\npresented. This inversion is made through an optimization procedure. In order to better\n\nunderstand and validate the initial step of the methodology, synthetic data (initially free of\n\nnoise and errors) have been used. Through this ideal set of data, it was possible to show that\n\npressure and saturation can be extracted from P and S impedances using only one seismic\n\nsurvey (3D inversion). It is also shown that this 3D approach is not robust when errors are\n\nassumed in reservoir data and it fails when, for instance, uncertainty in porosity data occurs.\n\nThus, an improvement is made and the algorithm is rewritten based on 4D differences that\n\ndiminish the wrong reservoir data effect. For both algorithms (3D and 4D), we have presented\n\na discussion of the objective function behaviour concerning the use of P and S impedances\n\nsimultaneously, the initial guess and the solution space. A sensitivity analysis discussing the\n\ninfluence of porosity and the dynamic properties on P and S impedances for 3D and 4D\n\napproaches is also presented. After understanding the inversion process behaviour for an ideal\n\ndata set, an analysis of its results assuming different combinations of pressure and saturation\n\nvariations and including some errors in the data set used is presented in the last subsections.\n\nKeywords: 4D seismic, estimation of pressure and saturation, petro-elastic inversion\n\n(Some figures may appear in colour only in the online journal)\n\nNomenclature\n\nIP P impedance.\n\nIS S impedance.\n\nKdry Effective bulk modulus of dry rock.\n\nKsat Effective bulk modulus of the rock with pore fluid.\n\nKmin Bulk modulus of mineral material making up rock.\n\nKfl Bulk modulus of the pore fluid.\n\nOF Objective function.\n\nPeff Effective pressure.\n\nPre Pore pressure.\n\nSw Water saturation.\n\nSo Oil saturation.\n\nVp P-wave velocity.\n\nVs S-wave velocity.\n\n? Porosity.\n\n? Coefficient of internal deformation.\n\n? Bulk density.\n\n?min Density of mineral material making up rock.\n\n?fl Fluid density.\n\n\u00b5dry Effective shear modulus of dry rock.\n\n\u00b5sat Effective shear modulus of the rock with pore fluid.\n\nSubscript\n\nseis Attribute derived from seismic.\n\nsim Attribute computed from reservoir simulation results.\n\n1742-2132/12/050447+14$33.00 \u00a9 2012 Sinopec Geophysical Research Institute Printed in the UK 447\n\n     11\n\n\n\nA Davolio et al\n\n1. Introduction\n\nThe use of time lapse seismic data to improve reservoir\n\nsimulation models is becoming more frequent. The spatially\n\ndense information that comes from 4D seismic data\n\ncomplements well production data, helping in the reservoir\n\nmodel calibration. Tuttle et al (2009) and Castro et al (2009)\n\nhave shown successful integration of these two sets of data.\n\nTherearedifferentdomainswherethis integrationcanbedone.\n\nIn the amplitude (or impedance) domain, for instance, the\n\nreservoir simulation data are converted to seismic attributes\n\nthrough forward modelling and these synthetic seismic data\n\nare matched with the acquired seismic data (Dadashpour et al\n\n2009, Fahimuddin et al 2010). Another way to perform the\n\nintegration is by converting 4D seismic data into pressure and\n\nsaturation and matching them with simulated values (Souza\n\net al 2011). The last is a more complex procedure and there\n\nis no standard process to extract pressure and saturation from\n\nseismic data.\n\nThe selection of the inversion process and the seismic\n\nattributes to be used to obtain pressure and saturation\n\ninformation are not well established in the literature.\n\nDadashpour et al (2008) presented a nonlinear inversion\n\nscheme that estimates pressure and saturation from synthetic\n\nzero offset seismic data. The work presented by Souza\n\net al (2010) has shown the difficulty of obtaining this\n\ndynamic information fromonesetof seismicdata (anacoustic\n\nimpedancevolume),mainlybecauseoftheproblemofmultiple\n\nanswers present in this inversion problem. One way to handle\n\nthis is to add another seismic attribute into the process that\n\nhas a different response to the dynamic property changes.\n\nSeveralworkscombinedifferentsetsofseismicdata torecover\n\npressure and saturation information. Tura and Lumley (1999)\n\nshowed that it is possible to estimate changes in pressure\n\nand saturation through IP and IS (P and S seismic-derived\n\nimpedances). Landro (2001) defined a methodology based on\n\ntime lapse difference of intercept and gradient to differentiate\n\npressureandsaturationeffects from4Dseismicdata.MacBeth\n\net al (2006)alsoproposedamethodology to identifypressure\n\nand saturation changes using time lapse seismic data; their\n\nmethodology is able to use any kind of seismic attributes (two\n\nor more) since they have a different response to pressure and\n\nsaturation changes.\n\nIn the work of Tura and Lumley (1999), the estimation\n\nof the dynamic properties from 4D seismic data is done\n\nthrough a crossplot of the attributes. The procedure consists\n\nof first identifying regions (through forward modelling) in the\n\ncrossplot of IP and IS that correspond to three production\n\nscenarios: (1) only saturation changes, (2) only pressure\n\nchanges and (3) saturation and pressure changes. Then the\n\nseismic impedance values are mapped according to these\n\nregions and consequently classified as one of the three\n\nscenariosmentioned.Themethodologyproposed in thiswork,\n\nwhichwillbebetterdetailedinthefollowingsections,alsouses\n\nIP and IS to estimate the dynamic property variation but the\n\nestimation is done through an optimization process, aiming to\n\nquantify the results obtained.\n\nThis work represents the first steps of a theoretical study\n\nthat aims to convert seismic data into pressure and saturation\n\nvaluestobeincorporatedinahistorymatchingprocessthrough\n\na feedback loop in a future work. It is known that this\n\nconversion isnotasimpleproceduresince it is subject tomany\n\nsources of errors like different scale data, noise, uncertainty\n\nin the static properties, etc. So, here we are proposing an\n\ninitial study that starts from an ideal set of data, free of any\n\nkind of error, in order to validate and verify the limitations\n\nof the inversion procedure. Thus, a discussion is presented\n\nconcerning the simultaneoususeof P and S impedances in the\n\nobjective function, the possibility of using only one seismic\n\nvintage and the necessity of using time lapse seismic data to\n\nestimatepressureandsaturation.Then,afterunderstandingthe\n\ninversion behaviour, some results are presented concerning\n\ndifferent scenarios of production, i.e. different time lapse\n\nvariation of pressure and saturation and also when a non-ideal\n\ndataset isassumedbyincludingsomeuncertaintiesanderrors.\n\n2. Synthetic seismic data\n\n2.1. Petro-elastic modelling (PEM)\n\nTheinversionalgorithmisbasedonanoptimizationprocedure\n\nwhere the differences between the seismic attributes and\n\nthe simulation-derived seismic attributes are minimized. To\n\ngenerate seismic attributes from simulation data, a PEM,\n\nwhich is a set of relationships that relate fluid/rock and elastic\n\nproperties, is required. The seismic attributes that are used\n\nin the inversion are compressional and shear impedances,\n\ncalled here IP and IS, respectively. Considering ?, Vp and\n\nVs as the density, compressional and shear wave velocities of\n\nthe medium, the impedances can be written as\n\nIP = Vp?, (1)\n\nIS = Vs?. (2)\n\nSeismic velocities depend on rock-saturated bulk (Ksat) and\n\nshear (\u00b5sat) moduli according to the equations\n\nVp =\n\n?\n\nKsat +\n4\n3\n\u00b5sat\n\n?\n, (3)\n\nVs =\n\n?\n\n\u00b5sat\n\n?\n. (4)\n\nThe medium density can be written as\n\n? = (1 ? ?)?min + ??fl, (5)\n\nwhere ? is the porosity, ?min is the mineral density and ?fl is\n\nthe fluid density which is defined according to the equation\n\n?fl = ?oSo + ?wSw (6)\n\nwhere S is the saturation and the subscripts stand for oil and\n\nwater.\n\nThe most used approach to determine the rock-saturated\n\nbulk and shear moduli are the Gassmann equations that are\n\ndescribed as follows (Avseth et al 2005):\n\nKsat = Kdry +\n\n(\n\n1 ?\nKdry\n\nKmin\n\n)2\n\n?\n\nKfl\n+\n\n1??\nKmin\n\n?\nKdry\n\nKmin\n2\n\n, (7)\n\n448\n\n     12\n\n\n\nPressure and saturation estimation from P and S impedances: a theoretical study\n\n\u00b5sat = \u00b5dry, (8)\n\nwhere Kdry, Kmin and Kfl are the bulk moduli of the rock\n\nframe, the mineral and the fluid mixture. \u00b5dry and \u00b5sat are\n\nthe shear moduli of the dry rock and the rock with pore fluid,\n\nrespectively.\n\nTo compute the dry bulk and shear moduli, the known\n\nfriable,oruncemented, sandmodel (Mavko et al 2003) isused\n\nin this work. This model makes use of the Hertz\u2013Mindlin\n\ncontact theory and a heuristic modified Hashin\u2013Strikman\n\nlower bound, according to the equations:\n\nKdry =\n\n[\n\n?/?c\n\nKHM + 4\u00b5HM/3\n+\n\n1 ? ?/?c\n\nK + 4\u00b5HM/3\n\n]\n\n?1\n\n?\n4\n3\n\u00b5HM, (9)\n\n\u00b5dry =\n\n[\n\n?/?c\n\n\u00b5HM + z\n+\n1 ? ?/?c\n\n\u00b5 + z\n\n]\n\n?1\n\n? z, (10)\n\nwhere\n\nz =\n\u00b5HM\n\n6\n\n(\n\n9KHM + 8\u00b5HM\n\nKHM + 2\u00b5HM\n\n)\n\n, (11)\n\nwhere KHM and \u00b5HM are the bulk and shear moduli at critical\n\nporosity ?c given by the contact Hertz\u2013Mindlin theory\n\nKHM =\n\n[\n\nn2(1 ? ?c )\n2\u00b5min\n\n2\n\n18?2(1 ? ?)2\nPeff\n\n]\n1\n3\n\n, (12)\n\n\u00b5HM =\n5 ? 4?\n\n5(2 ? ?)\n\n[\n\n3n2(1 ? ?c )\n2\u00b5min\n\n2\n\n2?2(1 ? ?)2\nPeff\n\n]\n1\n3\n\n, (13)\n\nwhere Peff is the effective pressure; \u00b5min and ? are the\n\nmineral shear bulk modulus and Poisson ratio and n is the\n\ncoordination number. Effective pressure follows the relation\n\nPeff = Pover ? ?Pre, where Pover is the overburden pressure,\n\nPre is the pore pressure and the parameter ? is the coefficient\n\nof internal deformation which is assumed to be equal to 1 in\n\nthis work.\n\nThebulkmodulusof theporefluid isestimatedbyWood\u2019s\n\nlaw given as\n\nKfl =\n\n[\n\nSw\n\nKw\n+\n\nSo\n\nKo\n\n]\n\n?1\n\n, (14)\n\nwhere Kw and Ko denote oil and water bulk moduli,\n\nrespectively. The fluid bulk moduli (Kw and Ko) are computed\n\nfromthefluidbulkdensitiesandfluidacousticvelocitythrough\n\nthe equations of Batzle and Wang (1992). The bulk densities\n\n?o and ?w can also be exported from the flux simulation and\n\nused as an input to compute bulk fluid modulus. A summary\n\ncan be found in Mavko et al (2003). Note that in this work, it\n\nis assumed no gas is present.\n\n2.2. Forward modelling\n\nIn order to validate the inversion scheme, synthetic seismic\n\ndata are being considered in this work. As will be detailed\n\nlater, the seismic attributes considered here are IP and IS. To\n\nbuild the synthetic impedance volumes, the PEM is run over\n\na reference simulation model that represents the true earth\n\nmodelling. This forward modelling uses as input pressure and\n\nsaturation values, generated by the simulation, and computes\n\nacoustic and shear impedances through the PEM for each\n\nsimulation grid block. Apart from the dynamic property pair\n\n(Pre, Sw), the reservoir properties such as porosity, mineral\n\ncompressibility, fluid properties and temperature are also\n\nneeded.\n\nAnothersimulationmodel isusedintheinversionscheme,\n\nwhich refers to the engineering simulation model, here called\n\nthe base model, built based on the reservoir characterization\n\nprocess and, therefore, assuming a lack of information that\n\nmakes it different from the reference model. This lack of\n\ninformation can be, for instance, a missing channel, a wrong\n\npermeability field or a wrong facies modelling. These two\n\nmodels are generated according to the necessity of each\n\nstudy; in this case, they were different enough to produce\n\nconsiderable time lapse differences.\n\nInitially, this work considers an ideal set of data, i.e.\n\n(i) Seismic impedance is generated at simulation scale\n\n(reference and base models have the same scale).\n\n(ii) Noise-free seismic data.\n\n(iii) Elastic inversion errors are not considered.\n\n(iv) No errors or uncertainties are assumed for the PEM and\n\nits input parameters. The same PEM is first used for the\n\nforward modelling to generate the synthetic impedance\n\nand then for the inversion process.\n\n(v) Water flooding example (no presence of gas).\n\nIn section 4, a discussion is presented for some cases\n\nwhere these ideal conditions are not totally assumed.\n\n3. Preliminary studies\n\nBefore starting the discussion of the petro-elastic inversion\n\nitself, some verifications were made in order to check the\n\nimportance of having more than one kind of seismic data\n\n(P and S impedances, in this case) when it is wanted to\n\nestimate pressure and saturation. Moreover, the influence of\n\npressure, saturationandporosity in IPand ISwasalsoverified\n\nfor3Dand4Ddata.Understandingtheseissueshelpstocontrol\n\nthe inversion behaviour.\n\n3.1. P and S impedances\n\nAn initial test based only on forward modelling was run\n\nto check and illustrate that the combination of P and S\n\nimpedances would lead to a single pair (Pre, Sw), assuming\n\nthe ideal set of data presented above. To achieve this,\n\nvalues of P and S impedances were computed through\n\nthe PEM, varying pressure and water saturation within\n\na known range. All other parameters (porosity, rock and\n\nfluid compressibility, temperature, etc) remained constant.\n\nThese computed impedance values generated the solid red\n\nsurfaces seen in figure 1. If a pressure and saturation pair\n\nis selected randomly, for instance, 24 MPa and 0.3, then\n\nthe corresponding IP and IS values are 6367 \u00d7 103 and\n\n3731 \u00d7 103 kg s?1 m2, respectively. In the same figure, the\n\nred-dashed planes represent these constant impedances.\n\nOnthebottomofthese images, thepressureandsaturation\n\npairs that correspond to the surface and plane intersection are\n\n449\n\n     13\n\n\n\nA Davolio et al\n\nFigure 1. P and S impedance values computed through a\npetro-elastic model for all the pressure and saturation pairs in a\nrange (20\u201330 MPa) and (0.1\u201310), respectively (red surface).\nConstant IP and IS planes computed from a randomly selected\npressure and saturation pair (red-dashed). Light blue points on the\nbottom represent the intersection between the IP surface and the IP\nconstant plane; the yellow points represent the same for IS.\n\nhighlighted.Thesepoints, in light blue, represent all pairs that\n\nwould give IP = 6367 \u00d7 103 kg s?1 m2 and, in yellow, all\n\npairs thatwouldgiveIS = 3731 \u00d7 103kg s?1m2. Infigure 1,\n\nit can be noted that the use of only IP to obtain pressure and\n\nsaturation yields a multiple answer inversion problem. But, if\n\nboth impedances are considered simultaneously, the solution\n\nsetisnowreducedtotheintersectionofthesetwosetsofpoints,\n\nwhich, for this case, reduces to the single pair (24 MPa, 0.3).\n\nSo, it was shown that if the measured seismic attributes\n\n(impedances, in this case) and the PEM were perfect, without\n\nany noise, or error, the inversion procedure of converting\n\nIP and IS into pressure and saturation should convert to the\n\nright answer since therewouldbeonlyaglobalminimum. It is\n\nalso important to highlight that this simple illustration is valid\n\nTable 1. Range of variation for the properties considered in the\nsensitivity analysis.\n\nMin Ref. value Max\n\n? 0.1 0.2 0.3\n?min (g cm\n\n?3) 2.51 2.65 2.78\nKmin (GPa) 34.77 36.6 38.43\n\u00b5min (GPa) 42.75 45 47.25\n? 0.9 1 1.1\n\nfor all pressure and water saturation pairs that belong to the\n\nrange considered and depend on the PEM used.\n\n3.2. Sensitivity analysis\n\nThe relationships between rock and fluid properties described\n\nthrough thePEMarenotvery simpleand the influenceofeach\n\nunknown on the computed values of IP and IS is not easy\n\nto identify, especially due to the inter-dependence of them.\n\nSo, a simplified uncertainty analysis is presented here, since\n\nit is not the scope of this work to deeply study this issue, in\n\norder to verify the influence of the independent rock and fluid\n\nproperties used as input to the PEM described previously. To\n\ncalculate these influences, one property was varied at a time\n\nand the respective percentage variations of IP and IS were\n\nsaved. Each curve displayed in figure 2 corresponds to the\n\nvariation of one property in the range described in table 1;\n\ntheotherproperties remainedconstant (including thedynamic\n\nproperties). Note that these ranges were defined within a\n\nfeasible set of values, according to the sand reservoir model\n\nassumed.\n\nFrom figure 2, it can be verified that porosity is the\n\nparameter that most influences impedance calculation. It is\n\nnecessary toobserve that the rangeofvariation considered for\n\nporositywaswide,whichconsequentlyproducesbigvariations\n\nin IP and IS, but even if a smaller range is considered, such as\n\n20% for instance, the variation in impedances is still relevant\n\nand bigger than the ones observed for the other parameters.\n\nFigure 2. Sensitivity analysis of the PEM. Rock properties influence on IP and IS (property variation limits based on uncertainties\nassociated with the reservoir characterization process).\n\n450\n\n     14\n\n\n\nPressure and saturation estimation from P and S impedances: a theoretical study\n\n(a) (b)\n\n(c) (d)\n\nFigure 3. 3D data corresponding to the second vintage (after eight years of production) where each colour corresponds to different porosity.\nCrossplots of (a) IP \u00d7 Pres; (b) IP \u00d7 Sw; (c) IS \u00d7 Pre and (d) IS \u00d7 Sw. Different porosity values yield different impedance ranges.\n\nThe same kind of sensitivity was done for temperature and\n\nfluid properties (oAPI, salinity, oil and water densities) and\n\neven assuming a wide range of variation for these properties\n\n(?50% +50%), the impedance variation observed was not\n\nbigger than 2%. As these results were not significant, they are\n\nnot shown here.\n\nThefocusofthisworkistodiscusstheinversionprocedure\n\nto obtain dynamic properties from 4D seismic data, first\n\nconsidering an ideal set of data and after assuming some\n\nerrors/noise. Thus, the discussion presented in the following\n\nsections aims to consider one source of error, which is the\n\nuncertainty on reservoir properties. As shown in this section,\n\nporosity is a very important property when calculating P and\n\nS impedances, so this property will be used to discuss the\n\npotentials and limitations of the inversion proposed.\n\n3.3. Porosity influence on P and S impedances assuming\n\ndynamic property variation\n\nThis section proposes a sensitivity analysis to check the\n\nporosity influenceonIPandISfor3Dand4Ddatafordifferent\n\nvalues of pressure and saturation. The procedure consists of\n\ncomputingboth impedances throughPEM,usingpressureand\n\nsaturationvalues generated froma reservoir simulationmodel\n\nat two production times (considering two seismic surveys)\n\nassuming different porosity values; the intention of using\n\ndifferent values of porosity is to analyse the influence of\n\nporosity on the results. The use of reservoir engineering\n\nsimulated values was chosen in order to have a consistent\n\ntime lapse difference for these unknowns. It is necessary to\n\nhighlight that the model details of the static properties are\n\nnot important for the analysis proposed here, because we just\n\nwant toevaluate impedancevariabilityforagivenpressureand\n\nsaturationpairassumingdifferentporosities.So, thesimulated\n\nblock values are used as single points on the crossplots shown\n\nbelow.\n\nThe reservoir model used has an average initial pressure\n\nof 32 MPa and 15% of connate water saturation. After eight\n\nyears of production, simulated values for different blocks\n\nbelong to the pressure range (24\u201329 MPa) and the water\n\nsaturation range (0.15\u20130.85). Figure 3 shows the impedances\n\nversus pressure and saturation crossplots for these data. The\n\ncolours represent different porosities used to compute IP and\n\nIS.Foronecolour, eachpoint representsa reservoir simulation\n\ngrid block. This image shows the strong influence of porosity\n\non both impedances, since there is a considerable distance\n\nbetween each colour point cloud.\n\nThe details of one of these cases can be seen in figure 4,\n\nwhere only the point cloud corresponding to ? = 0.15 is\n\ndisplayed. This kind of display allows us to check some\n\nrelationsbetweenbothimpedancesandthedynamicunknowns\n\n(pressure and saturation) that were not clear in figure 3\n\nbecause of the y-scale. Looking at figure 4(a), the vertical\n\npoint dispersion of the cloud is due to different saturation\n\n451\n\n     15\n\n\n\nA Davolio et al\n\n(a) (b)\n\n(c) (d)\n\nFigure 4. 3D data corresponding to the second vintage (after eight years of production); only the case where ? = 0.15. Crossplots of\n(a) IP \u00d7 Pres; (b) IP \u00d7 Sw; (c) IS \u00d7 Pre and (d) IS \u00d7 Sw.\n\nvalues assumed, ranging from (0.15\u20130.85). This means that\n\nsaturation has a strong influence on IP, because, for a fixed\n\npressure, the range of possible values that IP can assume is\n\nwide.Doing the sameanalysis forpressure, it canbeobserved\n\nin figure 4(b) that the IP range is much smaller for a constant\n\nSw than the one observed in figure 4(a). Therefore, saturation\n\nis more influential than pressure for these data. It is important\n\nto emphasize that the pressure range for this reservoir model\n\nis not as wide as the saturation range, in agreement with the\n\nexpected behaviour of a predefined production strategy with\n\ncontrolled pressure drop (water flooding, for instance).\n\nMaking an equivalent analysis for shear impedance, in\n\nfigures 4(c) and (d) the strong influence of pressure on IS\n\ncan be seen in contrast to the weak influence of saturation\n\n(as expected), highlighted by the constant IS behaviour of\n\nthe point cloud in figure 4(d). These different responses, or\n\nsensitivity, of IP and IS to pressure and saturation variations\n\nare good indicators that these two data should be used\n\nsimultaneously in the inversion, as will be discussed in the\n\nfollowing sections.\n\nWhen time lapse differences are considered, the distance\n\nbetween each colour cloud observed in figure 3 becomes\n\nless significant, as shown in figure 5, where the colours\n\nrepresent the same porosity values considered previously.\n\nNow, these clouds are practically superimposed and have\n\na much smaller deviation among themselves than the ones\n\nobserved in figure 3, which means that even if the porosity\n\nmodel is wrong, the 4D differences of IP and IS are going to\n\nbe close to the true one, i.e. porosity errors will be minimized\n\nby the subtraction of the vintages.\n\nStill in figure 5, the red point cloud is not really\n\nsuperimposed over the others, especially for figures 5(a) and\n\n(b), but this is not an important issue because, in this case, the\n\nporosity is too low, i.e. it can be considered a non-reservoir\n\nrock. In other words, if the porosity model is not able to\n\nidentify reservoir and non-reservoir rocks, then not even the\n\n4Ddifferences shouldbeable togiveuseful informationabout\n\npressure and saturation variations.\n\nLooking at any one of the four different porosity cases,\n\nsome features can be observed in figure 5. One of them\n\nis the cloud dispersion of 1IP \u00d7 1Pre that occurs due\n\nto the variations of 1Sw, which covers quite a wide range\n\n(0\u20130.7), showing that for the same 1Pre the P-impedance 4D\n\nvariation can assume very different values. Therefore, 1Sw is\n\nmore influential than pressure on 1IP. This is confirmed by\n\nthe crossplot of 1IP \u00d7 1Sw where the point clouds are much\n\nlessdispersed, showingabetter correlationbetween these two\n\nproperties.\n\nClearly, the same cannot be observed for the graph of\n\n1IS \u00d7 1Pre, as expected, since shear impedance is not\n\n452\n\n     16\n\n\n\nPressure and saturation estimation from P and S impedances: a theoretical study\n\n(a) (b)\n\n(c) (d)\n\nFigure 5. 4D data corresponding to monitor minus base (being the monitor after eight years of production). Crossplots of:\n(a) 1IP \u00d7 1Pres; (b) 1IP \u00d7 1Sw; (c) 1IS \u00d7 1Pre and (d) 1IS \u00d7 1Sw. For time lapse differences, porosity does not have such a great\ninfluence on impedances as it has on 3D.\n\nsensitive to saturationchanges.For the same reason, thegraph\n\n1IS \u00d7 1Sw displays constant 1IS behaviour when 1Sw\nvaries. On the other hand, the dispersion of any of the point\n\nclouds on this graph shows the influence of 1Pre on 1IS,\n\nwhich is also confirmed by the good correlation presented in\n\nthe crossplot of 1IS \u00d7 1Pre.\n\nThe main points to highlight are (1) regarding 3D data,\n\nIP and IS modelling is very sensitive to porosity; (2) when\n\ntime lapse data are considered, the porosity influence on\n\n1IP and 1IS is much weaker compared to that observed for\n\n3D data; (3) the variations observed on 1IP and 1IS due\n\nto dynamic property changes are more evident than those\n\nobserved for porosity variation; (4) the strong correlations\n\nbetween 1IP \u00d7 1Sw and 1IS \u00d7 1Pre are a good indication\n\nthat 1IP and 1IS can be used simultaneously to obtain 1Sw\nand 1Pre.\n\n4. Petro-elastic inversion\n\n4.1. 3D inversion\n\nThe 3D inversion algorithm proposed here follows the\n\nidea presented in Souza et al (2010) and adds the shear\n\nimpedance into theprocess inorder tocouplewith themultiple\n\nanswer issue. The basic idea of the process is to minimize\n\nthe difference between seismic impedance and synthetic\n\nimpedance computed from a reservoir simulation model\n\n(figure 6). This minimization is done through an optimization\n\nprocessthatusessimulatedpressureandsaturationvaluesfrom\n\nthe base model as an initial guess.\n\nThis work uses synthetic seismic data, so it is necessary\n\nto run a previous step to generate the synthetic impedance\n\nrepresented by the green box in figure 6.\n\nThe objective function of the optimization process is\n\ndefined as\n\nOF =\n\n?\n\n?\n\n?\n\n?\n\nIPseis ? IPsim\nISseis ? ISsim\n\n?\n\n?\n\n?\n\n?\n\n, (15)\n\nwhere IPseis and ISseis are the P and S impedances computed\n\nfrom seismic amplitudes, or in this case, it is the synthetic\n\nimpedance computed considering the reference model and\n\nIPsim and ISsim are the P and S synthetic impedancescomputed\n\nwith the base model simulation results.\n\nAswill bepresented later, some testswere runcomparing\n\nthe inversion process when the objective function is defined\n\nby equation (15) and also when this equation is modified\n\nby removing the shear impedance from it. It is important to\n\nhighlight that theproceduresshowninfigure6areall runat the\n\nreservoir simulationscaleand the inversion is runoneachgrid\n\n453\n\n     17\n\n\n\nA Davolio et al\n\nFigure 6. 3D inversion algorithm to obtain pressure and saturation from seismic impedance. The green box highlights the necessity of\nrunning a PEM to generate the synthetic seimic data used in this work.\n\nTable 2. Inverting pressure and saturation values.\n\nReference model Base model Inverted values Inverted values\n(answer) (initial guess) OF = f(IP) OF = f(IP, IS)\n\nPre (MPa) 32 25 23.2559 32.00\nSw 0.55 0.8 0.10 0.55\nPorosity 0.1474 0.1474 \u2013 \u2013\n\nblock independently. Also, the optimization algorithm used is\n\nan internalMatlabfunctioncalled fmincon whichisagradient-\n\nbased method for constrained problems. It is important to\n\nhighlight that the convergence criteria are based not only on\n\nthe minimization of the objective function but also on the size\n\nof the step between each answer found; if this size is smaller\n\nthan a tolerance, then the algorithm ends.\n\nIn order to illustrate the objective function behaviour, we\n\nwill consider singlepressure and saturationpairs thatwewant\n\nto obtain from synthetic seismic data (as the inversion is run\n\nfor each block separately, there is no problem to look at the\n\ninversion for only one block). As cited before, there are two\n\ndifferent simulation models: the reference model (true earth\n\nmodel) and the base model (reservoir engineering model).\n\nAssuming that the simulation of these models gave the values\n\nlisted in table 2 and that the inversion is constrained by the\n\nranges 0.1 &lt;Sw &lt;1 and 5 &lt;Pre &lt;50 (MPa), then all\n\npossible values that the OF can assume, combining saturation\n\nand pressure with a step of 0.01 and 0.35, respectively, are\n\ndefined by a surface that can be visualized in a 3D plot (OF,\n\nPre, Sw).\n\nFigures 7(a) and (b) show these corresponding surfaces\n\nforthecasewhereOF= f(IP)andOF= f(IP,IS), respectively.\n\nThe multiple response issue can be visualized on the bottom\n\nof these surfaces, where the contour plot is drawn. Note that\n\nfigure 7(b) clearly shows a global minimum in opposition\n\nto several local minima seen in figure 7(a). Another way of\n\nshowing this is illustrated infigures7(c)and(d).These images\n\nshow two things: the first one is the set of coloured points\n\ncorresponding to the lower objective function\u2019s values (hot\n\ncolours stand for higher values) and the second is the three\n\npoints given by the initial guess (cyan), the inversion solution\n\n(green)andthetrueanswer(magenta).Onecouldsaythat there\n\nis no doubt now that, if only IP was used, the optimization\n\nalgorithm could be stuck in a local minimum as happened in\n\ntheexampleshowninfigure7(c).Furthermore, thepresenceof\n\nshear impedanceyields anoptimizationproblemwithaglobal\n\nminimum easily found by the optimization algorithm.\n\nDavolio et al (2011) showed an application of this\n\nmethodology in a synthetic reservoir model. In that paper,\n\nthe case where only IP was considered is referenced by\n\n\u2018Algorithm 1\u2019 and when both impedances are used in the\n\nobjective function, it is referenced by \u2018Algorithm 2\u2019. The\n\napplicationof thisalgorithminanoise-freedata set shows that\n\nit is possible to obtain pressure and saturation if the second\n\nalgorithm is used. The paper also shows that, if a simple\n\nperturbation is assumed in the porosity field (multiplying it\n\nbyaconstant), the3D inversionalgorithmfails and, therefore,\n\na 4D approach should be used.\n\n454\n\n     18\n\n\n\nPressure and saturation estimation from P and S impedances: a theoretical study\n\n(a) (b)\n\n(c) (d)\n\nFigure 7. Top: objective function surfaces defined by all possible pressure and saturation pairs: (a) assuming OF = f(IP); (b) assuming\nOF = f(IP, IS). Bottom: lower values of the objective function, where hot colours stand for higher values; initial guess in cyan, inversion\nsolution in green and the true answer in magenta; (c) assuming OF = f(IP); (d) assuming OF = f(IP, IS).\n\n(a) (b)\n\nFigure 8. 3D inversion. (a) Assuming that the porosity is known: base = reference = 0.1956. For this case, the inversion was able to recover\nthe true answer exactly. (b) Assuming a wrong porosity for the base model: reference = 0.1956 and base = 0.2590. For this last case, the\ninverted water saturation and pressure pair is far from the true answer.\n\n4.2. 4D inversion\n\nNow, convinced of the fact that both IP and IS should be used\n\nin the objective function in order to guarantee the existence\n\nof a global minimum and also that the optimization algorithm\nis able to find it in an ideal set of data, the next step of our\nstudyis tostartconsideringsomeerrors,oruncertainties, in the\nmodelling.Thefirstuncertaintyassumedconcernstheporosity\n\n455\n\n     19\n\n\n\nA Davolio et al\n\nFigure 9. 4D inversion algorithm to obtain pressure and saturation from seismic impedances. The green box highlights the necessity of\nrunning a PEM to generate the synthetic seismic data used in this work.\n\nTable 3. Base and reference model values used in the 4D inversion\nalgorithm. The last column has the inverted values obtained though\nthis new algorithm approach.\n\nTime 0 Time 1\n\nReference Base Reference model Base model\nmodel model (answer) (initial guess)\n\nPre (MPa) 32.1016 32.1016 27.3938 25.8431\nSw 0.1500 0.1500 0.2556 0.1538\n\nfield, sonowthebaseand referencemodelswill havedifferent\n\nporosity values.\n\nAs shown in a previous section, porosity has a strong\n\ninfluence on shear and acoustic impedances, indicating that\n\nif this parameter is wrong, the inversion procedure may fail.\n\nThe images of figure 8 show a comparison of the inversion\n\nprocedureusing the3Dalgorithmpresentedbefore forasingle\n\npair (Sw,Pre) for twocases: infigure8(a) theporosityvalue is\n\nknown and in figure 8(b) it is not. The base and reference\n\nmodel values are listed in table 3 under the \u2018Time 1\u2019 column.\n\nFor the second case, the reference model porosity is 0.1956\n\nand thebasemodelporosity is0.2590.Fromfigure8(b), it can\n\nbe shown that the inversiondoesnotwork for suchcases since\n\nthe answer (magenta) is far from the global minimum.\n\nThe idea of 4D studies using seismic data is always\n\nrelated to 4D differences because it is expected that errors\n\nfrom static properties (like porosity) will be diminished when\n\nthe data are subtracted, thus highlighting dynamic effects, as\n\ndiscussed in section 3.3. So, the natural improvement of the\n\nalgorithm proposed was to incorporate this approach in order\n\ntomitigatewrongporosityeffects.The4Dinversionalgorithm\n\nclosely follows the same idea as the 3D, aiming to minimize\n\nthe differences between seismic impedances and synthetic\n\nimpedances computed from simulation data. As illustrated in\n\nthe workflow of figure 9, the main difference now is that the\n\nalgorithm deals with two seismic surveys (base = time 0 and\n\nmonitor = time 1) and the objective function is written as\n\nOF =\n\n?\n\n?\n\n?\n\n?\n\n14DIPseis ? 14DIPsim\n14DISseis ? 14DISsim\n\n?\n\n?\n\n?\n\n?\n\n, (16)\n\nwhere the indexseisstandsfor theseismic impedances,which,\n\nin this case, is a synthetic impedance computed through the\n\nreference model, and the index sim stands for the synthetic\n\nimpedances computed using the base simulation model. Note\n\nthat now the 4D difference is minimized, so the operator\n\n14D stands for the time lapsedifference: monitor ? base. One\n\nimportantassumption that isbeingused is thefact that thebase\n\n4Dtimecorresponds to the reservoir initial time,whichmeans\n\nthatpressureandsaturationareknownat time0.Anotherpoint\n\nto highlight is that as in the 3D approach, the 4D inversion is\n\nalso run for each block independently.\n\nThe same data used to generate the images of figure 8\n\nare now used to run the 4D inversion algorithm. The base and\n\nreference model values are listed in table 3 for the two 4D\n\n456\n\n     20\n\n\n\nPressure and saturation estimation from P and S impedances: a theoretical study\n\n(a) (b)\n\nFigure 10. 4D inversion: (a) assuming that the porosity is known: base = reference = 0.1956. For this case, the inversion was able to\nrecover exactly the true answer; (b) assuming a wrong porosity for the base model: reference = 0.1956 and base = 0.2590.\n\nFigure 11. Depletion (left) and injection (right) scenarios. For each scenario, yellow circles are the answer the 4D inversion aims to reach\nand the inversion results assuming the porosity is known and has the values 0.1 (blue square), 0.2 (green circle) and 0.3 (red star).\n\ntimes considered. Note that it is considered that the base 4D\n\ntime corresponds to the reservoir initial time, which means\n\nthat pressure and saturation are known at this time, yielding\n\nequal values for both reservoir models at time 0.\n\nFigure 10 presents the results of the 4D inversion. For\n\nthe case where the porosity is known (figure 10(a)), the\n\n4D inversion algorithm yielded results very close to the\n\ntrue answer (the errors obtained correspond to the numerical\n\nerrors of the optimization), as happened in the 3D inversion\n\nalgorithm(figure8(a)).However,when theporosityvaluesare\n\nassumed to be wrong, the 4D approach makes the difference,\n\nyielding a pressure and saturation pair (figure 10(b)) much\n\ncloser, although not exact, to the answer than the one seen in\n\nfigure 8(b).\n\nIn order to check the algorithm, different initial guesses\n\nwere tested but, since this optimization problem has a well-\n\nbehaved objective function with a global minimum, this input\n\ndoes not make much difference.\n\nTable 4. Production scenarios considered.\n\nDepletion scenario Injection scenario\n\n14DSw 14DPre (MPa) 14DSw 14DPre (MPa)\n\n0 ?15 0 +2\n0.5 ?5 0.5 +5\n0.75 ?2 0.75 +15\n\n4.3. 4D inversion on different production scenarios\n\nIn order to have a more robust study, in this section, the\n\n4D inversion results are presented for different production\n\nscenarios, i.e. different saturation and pressure pairs are\n\nevaluated.\n\nThe possible production scenarios are summarized in\n\nthis work in six cases, as described in table 4.These six cases\n\nshouldcover theexpectedbehaviourof thedynamicproperties\n\nconsidering blocks located between production and injection\n\n457\n\n     21\n\n\n\nA Davolio et al\n\nFigure 12. 4D inversion results for the same scenarios as figure 11, now assuming wrong porosities where ?T is the true porosity and ?E is\nthe estimated porosity (the value assumed in the inversion).\n\nFigure 13. 4D inversion results assuming error on seismic impedances. The porosity is assumed to be known and the results show three\ncases: ? = 0.1, ? = 0.2 and ? = 0.3. At the top are the depletion scenarios for each porosity and at the bottom are the injection scenarios\nalso for each porosity. Each colour corresponds to a different perturbation applied on 14DIP and 14DIS.\n\nwells (close and far to the well locations). All these scenarios\n\nare illustratedby theyellowcirclesoffigure11.Note that fora\n\nbettervisualizationofthedifferentscenarios, theimagesinthis\n\nsubsection (and the following ones) show the 4D difference\n\nof thedynamicproperties, insteadof the second surveyvalues\n\nas used before. Still in figure 11, the 4D inversion results for\n\neach scenario are plotted considering that porosity is known\n\nand assuming three different values: ? = 0.1, ? = 0.2 and\n\n? = 0.3. This image shows that no matter what the saturation,\n\npressure and porosity values are, the 4D inversion provides\n\ncorrect values (just having the numerical error of the process)\n\nwhen the ideal data set, with no errors or uncertainties, is\n\nconsidered.\n\nFigure 12 presents the results for the same scenarios\n\nbut now assuming that the porosity is not known (?T is the\n\ntrue porosity and ?E is the estimated porosity); it shows\n\nthe results for each scenario assuming that the estimated\n\nporosity was not totally correct. An important issue that can\n\nbe observed in figure 12 is that looking at the inversion\n\nresults for the same porosity case (red points, for instance),\n\nthe quality of the estimated pressure and saturation variations\n\ndepends on the scenario considered. One explanation for this\n\n458\n\n     22\n\n\n\nPressure and saturation estimation from P and S impedances: a theoretical study\n\nFigure 14. 4D inversion results assuming uncertainty in the reservoir initial conditions. The porosity is assumed to be known and the results\nshow three cases: ? = 0.1, ? = 0.2 and ? = 0.3. At the top are the depletion scenarios for each porosity and at the bottom the injection\nscenarios also for each porosity. Each colour corresponds to a different assumption regarding the reservoir initial conditions, as detailed in\ntable 5.\n\nmay be that the error induced by the wrong porosity in the\n\nsynthetic impedances (IPsim and ISsim) calculation overrides\n\ntheeffects that thedynamicproperty4Dvariationhasonthem.\n\nNevertheless, ingeneral, theerrorsobtainedareacceptableand\n\nit can be said that the 4D inversion works well in all scenarios\n\nand porosities.\n\n4.4. 4D inversion assuming noise in seismic data\n\nAnother important source of error in the inversion process\n\nstudied is the noise presented in seismic data. For the type of\n\nanalysis that is being presented in this work, which looks at\n\neach point of the reservoir separately, the presence of noise\n\nin seismic data can be represented simply by a percentage\n\nperturbation on 14DIP and 14DIS. So, these wrong values\n\nthat the impedances assumecan represent seismicnoise, scale\n\nissues and even wrong modelling. Note that, when looking to\n\nthe whole reservoir behaviour, these sources of errors need to\n\nbe modelled more properly, since the spatial effects must be\n\naccounted for. Again, in this work, these effects just provide\n\nwrong point values of impedances since the algorithm is run\n\nfor each reservoir simulation block.\n\nIn this sense, figure 13 shows the results of the\n\n4D inversion assuming different perturbations on seismic\n\nimpedances, also the porosity is considered known and the\n\nresults are shown for three porosity cases (0.1, 0.2 and 0.3)\n\nfor the depletion and injection scenarios described in table 4.\n\nDifferent colours stand for different perturbation applied to\n\nthe time lapsedifferenceof IPand IS, according to the legend.\n\nAgain, it is observed that the quality of the inversion depends\n\non the scenario assumed, which is expected since the success\n\nof theinversionwilldependonthesensitivityof theimpedance\n\nTable 5. Five cases where the initial conditions are assumed to be\nwrong.\n\nSw (time 0) Pre (time 0) (MPa)\n\nCase 1 0.1 30\nCase 2 0.13 31\nCase 3 0.2 33\nCase 4 0.3 34\nTrue value 0.15 32\n\nvariationsforacertainvariationofpressureandsaturation. It is\n\nimportant to highlight that the solution set of the optimization\n\nwas constrained by the limits of the scenarios considered\n\n(14DSw = [0\u20130.75] and 14DPre = [?15\u201315 MPa]); this fact\n\njustifies some results falling in theboundary. Ingeneral, it can\n\nbe said that the results are acceptable for impedance errors up\n\nto15%.Forerrorsbigger than that, the results can still capture\n\nthe trend expected (pressure or saturation decrease/increase),\n\nbut the quantification of these values can be compromised; so\n\nadditional research is necessary to verify how noisy data can\n\nbe inverted with more confidence.\n\n4.5. 4D inversion assuming uncertainty in the reservoir\n\ninitial conditions\n\nThe last analysis shown in this work concerns the fact that the\n\ninitial conditions of the reservoir are not known. Four cases\n\nwere tested where the initial pressure and saturations used in\n\nthe 4D inversion are the ones detailed in table 5, instead of\n\nassuming the correct values: Sw = 0.15 and Pre = 32 MPa.\n\nOne thing to highlight is that at the initial time, pressure can\n\nbe considered known, since the 4D acquisition occurs after\n\nsome years of production and usually the reservoir pressure\n\nin the past is known, so the uncertainty is small. The connate\n\n459\n\n     23\n\n\n\nA Davolio et al\n\nwater value can be uncertain since the reservoir can have\n\ndifferent facies that cannot be correctly located. This explains\n\nthe small variation for pressure considered in table 5 around\n\nthe true values and the chosen values for the initial saturation.\n\nFigure 14 shows the results for these cases. The errors\n\nobserved are acceptable, showing that even if these properties\n\nhave some uncertainty, it should not interfere too much with\n\nthe results (not as much as for noisy seismic data as shown in\n\nthe previous section).\n\n5. Conclusions\n\nA theoretical study of a petro-elastic inversion to obtain\n\npressure and saturation from seismic attributes was presented.\n\nUsing an ideal set of data, free of any kind of noise or\n\nerror in order to observe only the influence of the technical\n\nparameters, itwaspossibletoshowthatpressureandsaturation\n\ncould be recovered from seismic data using only one seismic\n\nsurvey through the 3D inversion algorithm proposed, where\n\nP and S impedances were considered simultaneously. The\n\nnecessity of a time lapse approach arises when errors start\n\nto be considered in the ideal set of data, assuming that the\n\nreservoir properties (initially represented only by porosity in\n\nthis work to simplify the process) are unknown (which is the\n\nmost common case).\n\nThe importance of the reservoir properties (represented\n\nin this work by porosity) to the petro-elastic modelling used\n\nwas illustrated by a simple sensitivity analysis, from which it\n\ncouldbeconcluded that, for thePEMused,porosityhasahigh\n\ninfluence on 3D impedances and that this influence decreases\n\nwhen 4D differences are considered. Some tests of the 3D\n\nand 4D inversion algorithms proposed were presented and,\n\nin agreement with the sensitivity analysis, the 3D inversion\n\nfailed when errors in porosity were considered and, as long as\n\nminimumknowledgeabout theporosityvalue is available, the\n\n4D inversion yielded satisfactory results.\n\nDifferentproductionscenarioswereconsideredtovalidate\n\nthe 4D inversion proposed. It was verified that for the ideal\n\ndata set, the inversion results were practically exact for all\n\nscenarios analysed. If anot totally ideal data set is considered,\n\nassuming errors or uncertainties, it was observed that the\n\nquality of the inversion depends on the current scenario.\n\nAlthough, when uncertainties are considered in the porosity\n\nvalues and under the initial reservoir conditions, the inversion\n\nerrors are still acceptable. When the time lapse difference of\n\nseismic impedances was disturbed up to 15%, the results of\n\nall scenarios were acceptable; if impedance differences are\n\ndisturbed more than that, the results can still capture the\n\ntrend expected (pressure or saturation decrease/increase), but\n\nthe quantification of these values can be compromised, and\n\nadditionalwork isnecessary toproperly estimatepressureand\n\nsaturation.\n\nReferences\n\nAvseth P, Mukerji T and Mavko G 2005 Quantitative Seismic\nInterpretation: Applying Rock Physics Tools to Reduce\nInterpretations Risk (Cambridge: Cambridge University Press)\n\nBatzle M and Wang Z 1992 Seismic properties of pore fluids\nGeophysics 57 1396\u20131408\n\nCastro S A, Caers J, Otterlei C M, Meisingset H, Hoye T, Gomel P\nand Zachariassen E 2009 Incorporating 4D seismic data into\nreservoir models while honoring production and geologic data:\na case study Leading Edge 28 1498\u20131506\n\nDadashpour M, Echeverr??a-Ciaurri D, Kleppe J and Landr\u00f8 M 2009\nPorosity and permeability estimation by integration of\nproduction and time-lapse near and far offset seismic data\nJ. Geophys. Eng. 6 325\u201344\n\nDadashpour M, Landr\u00f8 M and Kleppe J 2008 Nonlinear inversion\nfor estimating reservoir parameters from time-lapse seismic\ndata J. Geophys. Eng. 5 54\u201366\n\nDavolio A, Maschio C and Schiozer D 2011 Incorporating 4D\nseismic attributes into history matching process through an\ninversion scheme SPE142946 SPE EUROPEC/ EAGE Ann.\nConf. and Exhibition (Vienna, Austria, 23\u201326 May)\n\nFahimuddin A, Aanonsen S and Skjervheim J A 2010 Ensemble\nbased 4D seismic history matching: integration of different\nlevels and types of seismic data SPE131453SPE EUROPEC/\nEAGE Ann. Conf. and Exhibition (Barcelona, Spain, 14\u201317\nJune)\n\nLandro M 2001 Discrimination between pressure and fluid\nsaturation changes from time-lapse seismic data Geophysics\n66 836\u201344\n\nMacBeth C, Floricich M and Soldo J 2006 Going quantitative with\n4D seismic analysis Geophys. Prospect. 54 303\u201317\n\nMavko G, Mukerji T and Dvorkin J 2003 The Rock Physics\nHandbook: Tools for Seismic Analysis in Porous Media\n(Cambridge: Cambridge University Press)\n\nSouza R M, Machado A F, Muneratto F P and Schiozer D J 2010\nIterative history matching technique for estimation reservoir\nparameters from seismic data SPE131617SPE EUROPEC/\nEAGE Ann. Conf. and Exhibition (Barcelona, Spain, 14\u201317\nJune)\n\nSouza R M, Muneratto F P and Schiozer D J 2011 Quantitative\nintegration of time-lapse derived information in a history\nmatching procedure SPE143009 SPE EUROPEC/ EAGE Ann.\nConf. and Exhibition (Vienna, Austria, 23\u201326 May)\n\nTura A and Lumley D E 1999 Estimating pressure and saturation\nchanges from time-lapse AVO data SEG Expanded Abstracts\n\nTuttle C, Pelissier M, Barnes M, Tribe J and Persad K 2009 A\nseismically constrained reservoir modeling workflow: case\nstudy Leading Edge 28 1492\u20137\n\n460\n\n     24\n\n\n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n3. PAPER 2: A methodology to constrain pressure and \n\nsaturation estimation from 4D seismic using multiple \n\nsimulation models and observed data \n\nAlessandra Davolio, C\u00e9lio Maschio, Denis Jos\u00e9 Schiozer \n\nJournal of Petroleum Science and Engineering, April 2013, v. 105, p. 51-61 \n\n \n\nPresented at SEG/SPE/AAPG workshop \u201cNew advances in integrated reservoir \n\nsurveillance\u201d, California, 24-29 June 2012. \n\n \n\n     25\n\n\n\n     26\n\n\n\nA methodology to constrain pressure and saturation estimation from 4D\nseismic using multiple simulation models and observed data\n\nAlessandra Davolio n, C\u00e9lio Maschio, Denis Jos\u00e9 Schiozer\n\nDepartamento de Engenharia de Petr\u00f3leo, Faculdade de Engenharia Mec\u00e2nica\u2014UNICAMP, Caixa Postal 6052, 13.083-970 Campinas, S\u00e3o Paulo, Brazil\n\na r t i c l e i n f o\n\nArticle history:\n\nReceived 9 January 2012\n\nAccepted 19 March 2013\nAvailable online 2 April 2013\n\nKeywords:\n\nseismic and reservoir simulation integration\n\n4D seismic\n\npressure and saturation estimation\n\nreservoir simulation\n\na b s t r a c t\n\nThe use of time-lapse seismic data to improve reservoir characterization is becoming a common practice in\n\nthe oil industry. Nevertheless, the integration of datasets with different characteristics, such as flow simulation\n\nand seismic data, is still a challenge. One of the possible ways to perform the integration is the use of extracted\n\npressure and saturation from 4D seismic in the history matching process. However, the quantitative use of\n\npressure and saturation difference maps in the objective function needs more accurate estimation of these\n\ndynamic properties. Thus, this work proposes a methodology to use multiple simulation model realizations,\n\ngenerated through the combination of uncertain reservoir attributes, to guide an inversion process that\n\nevaluates pressure and saturation from 4D seismic, in order to provide estimations that are more reliable. The\n\napplication of the methodology in a synthetic dataset showed promising results. The main contribution of this\n\nwork is to show that it is possible to use available knowledge from flow simulation and reservoir\n\ncharacterization to constrain time-lapse data and extract from it more reliable information.\n\n&amp; 2013 Elsevier B.V. All rights reserved.\n\nContents\n\n1. Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51\n\n2. Methodology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53\n\n2.1. Petro-elastic inversion. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53\n\n2.2. Multiple flow simulation models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54\n\n2.3. Using observed production data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54\n\n3. Application. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55\n\n3.1. Reservoir model description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55\n\n3.2. Model uncertainties. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55\n\n3.3. Reference and base model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55\n\n3.4. Petro-elastic modeling. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56\n\n3.5. Synthetic seismic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58\n\n3.6. Multiple models: limits extraction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58\n\n4. Results and discussion. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59\n\n4.1. Case 1: inversion results using generic constraints . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59\n\n4.2. Case 2: inversion results using multiple models simulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59\n\n4.3. Case 3: inversion results using multiple model simulation and well dynamic data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60\n\n4.4. Comments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60\n\n5. Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60\n\nAcknowledgments. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61\n\nReferences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61\n\n1. Introduction\n\nNowadays, the use of time-lapse seismic data is a common\n\npractice for reservoir monitoring, since it may provide information\n\nContents lists available at SciVerse ScienceDirect\n\njournal homepage: www.elsevier.com/locate/petrol\n\nJournal of Petroleum Science and Engineering\n\n0920-4105/$ - see front matter &amp; 2013 Elsevier B.V. All rights reserved.\n\nhttp://dx.doi.org/10.1016/j.petrol.2013.03.017\n\nn Corresponding author. Tel.: +55 19 92070940.\n\nE-mail address: davolio@dep.fem.unicamp.br (A. Davolio).\n\nJournal of Petroleum Science and Engineering 105 (2013) 51\u201361\n\n     27\n\n\n\nthat yields a better understanding of the reservoir and conse-\n\nquently, more efficient field operations and better financial return.\n\nThere are several works in the literature describing successful\n\napplications of this technology (Castro et al., 2009; Helgerud et al.,\n\n2011; Tuttle et al., 2009).\n\nTime-lapse seismic can provide not only information about\n\ndynamic properties (pressure and saturation changes) but it can\n\nalso help to map static properties such as fault transmissibility or\n\nfacies modeling. The work of Castro et al. (2009) is an example of\n\nthe application of 4D seismic in both situations.\n\nAnother aspect to highlight, concerning the application of this\n\nkind of data, is how to integrate it with reservoir flow simulation.\n\nThe information provided by 4D seismic can be used in a\n\nqualitative or quantitative way. The works of Helgerud et al.\n\n(2011) and Tuttle et al. (2009) are examples of qualitative\n\napplication, where 4D seismic was used to determine barriers\n\nand baffles. The quantitative integration of time-lapse seismic and\n\nreservoir simulation data is usually made via history matching, by\n\ndefining a procedure to match not only the well production and\n\npressure data but also 4D seismic attributes.\n\nConcerning seismic attributes, the matching is done between\n\nthe observed seismic and the synthetic seismic derived from the\n\nsimulation results. In this sense, the procedure can match seismic\n\namplitudes, impedances or any other seismic-derived attribute.\n\nSeveral works, regarding this kind of application, can be found in\n\nthe literature. Dadashpour et al.'s (2009) work is an example\n\nwhere a quantitative integration between production and seismic\n\ndata is presented, given that the seismic is used in the form of zero\n\noffset amplitudes and gradients. Fahimuddin et al. (2010) compare\n\nthe use of different seismic data when performing history match-\n\ning in the ensemble Kalman filter framework. The authors con-\n\nclude that, in the realistic case considered, the use of impedances\n\nyields better results than the ones obtained by using amplitudes.\n\nAnother work that presents the quantitative use of 4D seismic in\n\nthe impedance domain is that of Kazemi et al. (2010). In this case,\n\nthe authors discuss techniques to normalize seismic derived\n\nimpedances, to make the order of magnitude of these values\n\ncomparable to the synthetic impedances computed from flow\n\nsimulation.\n\nIt is also possible to extract information about pressure and\n\nsaturation variations from time-lapse data and quantitatively\n\nmatch these estimated parameters with flow simulator results.\n\nGervais and Roggero's (2010) work is an example, in which the\n\nauthors propose a local parameterization technique and incorpo-\n\nrate saturation information provided by the seismic data in an\n\nassisted history matching process. Jin et al. (2011) present another\n\nexample of the use of saturation patterns extracted from 4D\n\nseismic, in which the authors show a comparison of stochastic\n\noptimization methods to integrate quantitatively seismic and\n\nproduction data.\n\nAn effective estimation of saturation and pressure values from\n\n4D seismic data is a more complicated task than extracting\n\nsaturation patterns. Tura and Lumley (1999) showed that it is\n\npossible to estimate changes in pressure and saturation through P\n\nand S seismic impedances. Landro (2001) proposed a methodology\n\nbased on mathematical expressions that combines 4D AVO attri-\n\nbutes to extract pressure and saturation changes. In the same\n\nwork, he demonstrates a successful application of his technique on\n\nthe Gullfaks field. These results were also included in the discus-\n\nsion presented by Landro et al. (2001), which focuses on reservoir\n\nmanagement, showing that time-lapse seismic improved the\n\ndrainage understanding of the Gullfaks field. MacBeth et al.\n\n(2006) also proposed a methodology to identify pressure and\n\nsaturation changes using time-lapse seismic data. Their metho-\n\ndology is able to use any kind of seismic attributes (two or more)\n\nsince these attributes have a different response to pressure and\n\nsaturation changes. The work of Dadashpour et al. (2008) present a\n\npetro-elastic inversion methodology that uses zero offset 4D\n\nseismic amplitudes to recover pressure and saturation changes.\n\nDavolio et al. (2012) also present a methodology to estimate\n\ndynamic properties from 4D seismic through the P and S seismic\n\nimpedances. Different from Tura and Lumley (1999), the metho-\n\ndology of this work is based on an optimization process aimed at\n\nquantifying the results obtained.\n\nThere are many challenges to overcome when converting\n\nseismic data into pressure and saturation values. The main issues\n\nare noise/errors presented in acquired seismic data, together with\n\nerrors/uncertainties in reservoir properties and modeling (petro-\n\nelastic modeling). Davolio et al. (2012) present a discussion about\n\nhow some of these issues influence the estimation of dynamic\n\nproperties from time-lapse seismic.\n\nThe methodology we are proposing in this work attempts to\n\nmitigate these influences by using known information (from\n\nengineering data) to guide the estimation of pressure and satura-\n\ntion changes from time-lapse data, avoiding unfeasible results\n\n(considering flow conditions) that can occur due to the problems\n\nmentioned. The methodology uses the combination of uncertain\n\nreservoir attributes to generate multiple reservoir models, from\n\nwhich limits are established for the unknown pressure and\n\nsaturation. Then, these limits are used in a petro-elastic inversion\n\nalgorithm to estimate pressure and saturation from 4D seismic.\n\nMore specifically, these limits will constrain the solution space of\n\nthe optimization procedure used to invert 4D data to pressure and\n\nsaturation.\n\nNomenclature\n\nIP P-impedance\n\nIS S-impedance\n\nkdry effective bulk modulus of dry rock\n\nksat effective bulk modulus of the rock with pore fluid\n\nkmin bulk modulus of mineral material making up rock\n\nkfl bulk modulus of the pore fluid\n\nOF objective function\n\nPeff effective pressure\n\nPEM petro-elastic model\n\nPre pore pressure\n\nSw water saturation\n\nSo oil saturation\n\nVp P wave velocity\n\nVs S wave velocity\n\n? porosity\n\n? coefficient of internal deformation\n\n? bulk density\n\n?min density of mineral material making up rock\n\n?fl fluid density\n\n?dry effective shear modulus of dry rock\n\n?sat effective shear modulus of the rock with pore fluid\n\nSubscript\n\nseis attribute derived from seismic\n\nsim attribute computed from reservoir simulation results\n\nA. Davolio et al. / Journal of Petroleum Science and Engineering 105 (2013) 51\u20136152\n\n     28\n\n\n\nObserved well pressure and production data are also incorpo-\n\nrated into the methodology, reducing the initial range of the\n\nreservoir response. The effects of this reduction are reflected on\n\nthe estimated pressure and saturation values, since stricter limits\n\nare used in the inversion process.\n\nIf reservoir characterization and uncertain attributes selection\n\nare done properly, the limits extracted from multiple simulations\n\ncan, for instance, restrict areas where the saturation front should\n\nreach, although that could be estimated from 4D seismic with\n\nsome errors or noise. This kind of result is shown in the applica-\n\ntion presented in a synthetic dataset.\n\nThe focus of the proposed methodology is then to calibrate 4D\n\nseismic response using the knowledge available from reservoir\n\nsimulation data as support for the inversion process. The main\n\ncontribution of the work is to show how reservoir engineering\n\ndata can be used to guide the inversion process by means of a\n\nrobust and simple implementation method.\n\n2. Methodology\n\nThe methodology proposed here has the objective of guiding\n\nthe inversion process to estimate pressure and saturation from\n\ntime-lapse seismic data, in order to obtain results that are more\n\nconsistent with flow conditions (considering uncertainties). As\n\nillustrated in Fig. 1, the procedure consists of extracting limits for\n\npressure and saturation from the simulation of multiple models\n\n(generated by flow simulation of scenarios that represent the\n\ncombination of uncertain attributes). Then, these limits are used to\n\nconstrain the solution space of the optimization process that\n\nestimates the dynamic parameters.\n\nWell history data is also used to improve the methodology by\n\nselecting the models that provide production curves closer to the\n\nobserved data. The reduced number of models consequently\n\nreduces the computed limit range that is used to constrain the\n\nestimation of pressure and saturation.\n\nThis section is divided into two parts: the first one describes\n\nthe inversion process used to estimate pressure and saturation\n\nvariations from 4D seismic data and the second one explains how\n\nthe multiple models generated from the uncertainty analysis are\n\nused to constrain the inversion.\n\n2.1. Petro-elastic inversion\n\nThe inversion procedure (Davolio et al. (2012) for more details)\n\nis based on an optimization process that minimizes the differences\n\nbetween seismic impedances and synthetic impedances computed\n\nfrom flow simulation data in order to obtain pressure and satura-\n\ntion variations. To generate seismic attributes from reservoir\n\nsimulation data, a petro-elastic model (PEM), which is a set of\n\nrelationships that relates fluid/rock and elastic properties, is\n\nrequired.\n\nThe inversion is run at the flow simulation scale and is\n\nperformed for every grid block independently (therefore, an\n\nupscaling/downscaling procedure is required to convert data from\n\nseismic scale to flow simulation scale). The input data are the 4D\n\nseismic, represented by two 3D surveys at time 0 (base) and time 1\n\n(monitor), and the flow simulated pressure and saturation for both\n\ntimes. The procedure is run according to the following steps (see\n\nFig. 2):\n\n1. Go to the first grid block location.\n\n2. At the current grid block, the initial guess (Pre, Sw) is taken\n\nfrom the simulated reservoir model at time 1.\n\nFig. 2. 4D inversion algorithm to obtain pressure and saturation from seismic\n\nimpedances.\n\nFig. 1. General workflow of the proposed methodology. The simulation of multiple models (generated from the combination of uncertain attributes) together with\n\nproduction data defines limits (minimum and maximum) to be used in the inversion process, constraining the unknowns that will be estimated (pressure and saturation).\n\nA. Davolio et al. / Journal of Petroleum Science and Engineering 105 (2013) 51\u201361 53\n\n     29\n\n\n\n3. At the current grid block, compute IP and IS via PEM with the\n\ncurrent values of (Pre, Sw).\n\n4. Compute the objective function described in Eq. (1) for the\n\ncurrent grid block. If the objective function value is smaller\n\nthan a tolerance, go to step 5; if it is not, go to step 6.\n\n5. The optimization finishes and the solution for the current block\n\nat time 1 is assumed to be the current pair (Pre, Sw). If it is not\n\nthe last grid block location, go to the next block and return to\n\nstep 2.\n\n6. A gradient search algorithm updates the parameters (Pre, Sw)\n\ninside the constrained solution space and return to step 3.\n\nThe objective function depends on the difference of the time-\n\nlapse differences according to the equation:\n\nOF \u00bc\n?4DIPseis??4DIPsim\n\n?4DISseis??4DISsim\n\n!\n\n!\n\n!\n\n!\n\n!\n\n!\n\n!\n\n!\n\n!\n\n!\n\n\u00f01\u00de\n\nwhere the index seis stands for seismic impedances, the index sim\n\nstands for synthetic impedances computed from flow simulation\n\nresults and the operator ?4D stands for time-lapse difference:\n\nmonitor-base.\n\nThe constraints used in step 6 to limit the solution space are the\n\nkey points of the proposed methodology. As described in the next\n\nsection, this work proposes to define these constraints based on\n\nmultiple reservoir simulation models.\n\nThe optimization algorithm used is a gradient-based method\n\nfor constrained problems. Note that the way the problem was set,\n\nit is a simple and fast optimization problem with only two\n\nunknowns for each grid block. Therefore, a gradient method is\n\nbeing used, since there is no need for more sophisticated methods.\n\nOne important assumption that it is being used is based on the\n\nfact that the base 4D time corresponds to the reservoir at\n\nequilibrium conditions (initial time), which means that pressure\n\nand saturation are assumed to be known (or estimated with good\n\naccuracy) at time 0. Therefore, the final answer of the process is an\n\nestimation of pressure and saturation for the second survey\n\n(time 1).\n\nNote that this procedure does not update any static reservoir\n\nproperty. The goal here is to extract pressure and saturation values\n\nfrom 4D seismic. These results should be further used in a history\n\nmatching process, which will then update reservoir properties.\n\nSince history matching is not the focus of this work, this kind of\n\napplication will not be shown here.\n\n2.2. Multiple flow simulation models\n\nOne common approach for uncertainty analysis is the combination\n\nof different uncertain parameters such as porosity, permeability, faults\n\ntransmissibility etc., and the generation of multiple simulation models.\n\nThe proposed methodology aims to use the simulation results of all\n\nthese models, in order to constrain the solution space of the inversion\n\ndescribed in the previous section. The procedure consists of defining\n\nlimits (minimum and maximum) for the unknown pressure and\n\nsaturation at each reservoir block, and using them to constrain the\n\nsolution space of the optimization process defined in Section 2.1.\n\nThese limits are used more specifically in step 6.\n\nFig. 3 presents a scheme showing how these limits are extracted.\n\nThe left side of the image illustrates an uncertainty analysis\n\nprocedure assuming there are \u201cn\u201d uncertain attributes (which could\n\nbe porosity, permeability, relative permeability etc.). After the\n\ncombination of these attributes, \u201cm\u201d reservoir simulation models\n\nare built. After simulating all the models, \u201cm\u201d scenarios of pressure\n\nand saturation are generated. Thus, every single reservoir block\n\nlocation has \u201cm\u201d possible values of pressure and saturation. So, for\n\nevery single location, the minimum and maximum values along all\n\nthe possible \u201cm\u201d values are extracted.\n\nThe idea behind this methodology is to guide the inversion by\n\nusing reservoir simulation results, avoiding pressure and satura-\n\ntion estimated values that are not compatible with the limits\n\nobtained from flow simulation considering the mapped reservoir\n\nuncertainties. Consequently, the methodology aims to avoid\n\nincorrect estimated values that can be generated due to noise/\n\nerrors presented in seismic data and/or petro-elastic modeling and\n\nparameters, by constraining the solution space of the optimization\n\nprocess through the limits extracted.\n\nIf uncertainties are underestimated, as can be observed in several\n\npractical cases (generally described by unknown unknowns), flow\n\nsimulation conditions can impose incorrect limits to the inversion\n\nprocess. In these instances, other iterations can be used to gradually\n\nimprove the process.\n\n2.3. Using observed production data\n\nIn addition to the use of the multiple models, it is possible to\n\nmake an improvement in the methodology by using observed\n\nproduction data. The idea is to reduce the models dispersion by\n\nselecting only the ones that produce values close to the history data.\n\nIf the models range is reduced, then tighter limits for pressure and\n\nFig. 3. General procedure used to define limits (minimum and maximum) of pressure and saturation for each reservoir block. \u2018Attribute 1\u2019, \u2018Attribute 2\u2019 and \u2018Attribute n\u2019 are\n\ngeneric representations of the reservoir uncertainty and \u2018Model 1\u2019, \u2018Model 2\u2019 and \u2018Model m\u2019 are generic reservoir models generated from the combination of the reservoir\n\nuncertainties.\n\nA. Davolio et al. / Journal of Petroleum Science and Engineering 105 (2013) 51\u20136154\n\n     30\n\n\n\nsaturation are expected, constraining the solution space of the\n\ninversion even more.\n\nIn this case, an additional step in the scheme presented in Fig. 3\n\nis required in order to estimate the limits for the dynamic\n\nproperties. It is necessary to do a selection of these models based\n\non the distance between their simulation results and the history\n\ndata. So, instead of using the \u201cm\u201d models generated, only certain\n\nselected models are used to determine minimum and maximum\n\nvalues for pressure and saturation.\n\nThe criterion used to exclude a model is based on the misfit (M)\n\nbetween observed (dobs) and simulated data (dsim), according to\n\nthe equation below:\n\nM \u00bc ?\nN\n\ni \u00bc 1\n\n\u00f0d\nobs\ni ?d\n\nsim\ni \u00de\n\n2\n\u00f02\u00de\n\nwhere N is the number of observed data. In this work, the only\n\navailable data is bottom-hole pressure. Models with misfit smaller\n\nthan a given percentage, in relation to the model with the\n\nmaximum misfit, are used to define the new limits of pressure\n\nand saturation.\n\n3. Application\n\nThis section describes the dataset used to generate the results. In a\n\nreal problem, the data needed to apply the proposed methodology is\n\n4D seismic data (P and S impedances), the reservoir simulation model\n\nand the multiple model realizations resulting from an uncertainty\n\nanalysis. This work uses a synthetic dataset, so, apart from the\n\nsimulation model (called here base model) and the multiple realiza-\n\ntions, there is another model (called here reference model) that is\n\nused to generate the synthetic seismic. Thus, the reference model\n\nrepresents the true earth model, and the base model represents the\n\nmodel available to the engineer. These models differ from each other\n\nby the uncertainty properties described in Section 3.2. Everything else\n\n(like grid definition, fault location etc.) is the same for both models.\n\nAs mentioned in the previous section regarding the inversion\n\nprocess (step 3), a petro-elastic modeling is used to generate the\n\nseismic attributes. The petro-elastic model described in Section 3.4\n\nis used for two purposes: the first one is the forward modeling\n\ninside the inversion (step 3) and the second is the generation of\n\nthe synthetic seismic dataset considered in this work, which is\n\nbetter detailed in Section 3.5.\n\n3.1. Reservoir model description\n\nThe reservoir model considered in this work was discretized in\n\na corner-point grid with 90 $ 110 $ 5 blocks, 60 m in size in the x\n\nand y directions (5400 $ 6600 m2) and 15 m (on the average) in the\n\nz direction. There are three facies characterized according to three\n\npermeability ranges. The reservoir also comprises four faults, as can\n\nbe seen in Fig. 4. The reservoir is drained by eight vertical producer\n\nwells, which are supported by seven water injector wells (Fig. 4).\n\n3.2. Model uncertainties\n\nThe uncertain attributes considered in this work, defined by\n\nmultipliers are as follows:\n\n(1) Four faults transmissibility: three discrete values (0, 0.1 and 1).\n\n(2) Relative permeability curves (Corey exponents for the water\n\nphase) for each of the three facies.\n\n(3) Permeability ratio (vertical/horizontal).\n\nUniform distributions were used to start the procedure for each\n\nof these eight attributes.\n\nThe other two uncertain parameters are the porosity and\n\nhorizontal permeability, both of which were generated by geosta-\n\ntistical techniques. Using the sequential Gaussian simulation tech-\n\nnique (SGS), 200 realizations of porosity were generated, with the\n\nseismic P-impedance volume at time 0 (base survey) as a secondary\n\nvariable. Each of these porosity fields was used later as a second\n\nvariable for the SGS to generate 200 realizations of permeability.\n\nUsing the slice sampling technique (Neal, 2003), 400 simula-\n\ntion models were generated from the combination of the 10\n\nuncertain attributes, which were sampled from uniform distribu-\n\ntions. As uniform distribution was assumed, in principle, any other\n\nappropriate sampling technique could have been employed, such\n\nas Latin Hypercube for example, as presented by Maschio et al.\n\n(2010).\n\n3.3. Reference and base model\n\nAs detailed in Section 3.5, a synthetic seismic is being used. To\n\ngenerate the seismic attributes, it is being considered a reference\n\nsimulation model, which represents the true earth model.\n\nFig. 4. Reservoir simulation model: 3D view (on the left) and 2D view of the third layer (on the right). The color represents the horizontal permeability field of the reference\n\nmodel. The reservoir has four main faults and the production is carried by eight vertical producer wells, supported by seven water injector wells. (For interpretation of the\n\nreferences to color in this figure legend, the reader is referred to the web version of this article.)\n\nTable 1\n\nReference and base model properties.\n\nFault 1 Fault 2 Fault 3 Fault 4 Kz/Kx Corey exp.\n\nFacies\n\nReference 0.4 0.001 0.03 0.8 0.10 4.6 3.1 1.3\n\nBase 0.1 0.1 0.1 0.1 0.26 1.8 2.8 1.4\n\nA. Davolio et al. / Journal of Petroleum Science and Engineering 105 (2013) 51\u201361 55\n\n     31\n\n\n\nA second simulation model (the base model) is also used in the\n\nprocess, representing the reservoir model available to the engi-\n\nneer. This model represents the available knowledge about the\n\nreservoir. Hence, its reservoir properties (like porosity) are used as\n\ninput in the inversion process, as well as its simulated pressure\n\nand saturation, which are used as the initial guess for the\n\noptimization process, as indicated in Fig. 2.\n\nThe base model was selected as one of the 400 model realiza-\n\ntions generated after combining all the uncertainties. Thus, the\n\ndifferences between the two models concern the 10 uncertain\n\nparameters described previously. The values of the parameters\n\ndefined as multipliers are presented in Table 1. The other two\n\nuncertain parameters are the permeability and porosity fields\n\nshown in Fig. 5 for the third reservoir layer. The porosity field of\n\nthe base case was calibrated to the 3D seismic data, which allowed\n\nthe capture of the general features of the true porosity field,\n\nalthough with little resolution.\n\nAs this work is focused on the process of extracting pressure\n\nand saturation variations from time-lapse seismic data, the most\n\nimportant question regarding the differences between the two\n\nmodels is the differences observed in the simulation results. In this\n\nsense, Fig. 6 displays pressure and saturation maps for the third\n\nlayer of the reservoir for both models after six years of production.\n\nOne of the most influential differences between the models is the\n\nsealing fault located in the middle of the reservoir (Fault 2), which\n\nis presented only in the reference model. This can be clearly\n\nvisualized by comparing Fig. 6c and d, where the reference\n\npressure map has two well defined regions (more and less\n\npressurized) in opposition to the homogenous behavior of the\n\npressure map of the base model.\n\nIn relation to the petro-elastic inversion, Fig. 6b and d repre-\n\nsents the initial guess while the answer that the algorithm aims to\n\nreach is displayed in Fig. 6a and c.\n\n3.4. Petro-elastic modeling\n\nA petro-elastic modeling is required to generate seismic attri-\n\nbutes from simulation data. The seismic attributes used in the\n\ninversion described in Section 2.1 are compressional and shear\n\nimpedances, called here IP and IS, respectively. Considering ?, Vp\nand VS the density, compressional and shear wave velocities of the\n\nmedium, respectively, the impedances can be written as:\n\nIP \u00bc Vp?; \u00f03\u00de\n\nIS \u00bc VS?: \u00f04\u00de\n\nSeismic velocities depend on rock-saturated bulk (ksat) and\n\nshear (?sat) modulus according to the equations:\n\nVp \u00bc\n\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n\nksat \u00fe \u00f04=3\u00de?sat\n?\n\ns\n\n; \u00f05\u00de\n\nVS \u00bc\n\nffiffiffiffiffiffiffiffi\n\n?sat\n\n?\n\nr\n\n: \u00f06\u00de\n\nThe medium density can be written as,\n\n? \u00bc \u00f01??\u00de?min \u00fe ??f l; \u00f07\u00de\n\nwhere ? is the porosity, ?min is the mineral density and ?fl is the\n\nfluid density which is defined according to the equation:\n\n?f l \u00bc ?oSo \u00fe ?wSw \u00f08\u00de\n\nwith S being the saturation and the subscripts standing for oil\n\nand water.\n\nThe most commonly used approach to determine the rock\n\nsaturated bulk and shear modulus are the Gassmann equations\n\nFig. 5. Reference and base models properties for the third reservoir layer. Top: reference model porosity (a) and horizontal permeability (b). Bottom: base model porosity (c)\n\nand horizontal permeability (d).\n\nA. Davolio et al. / Journal of Petroleum Science and Engineering 105 (2013) 51\u20136156\n\n     32\n\n\n\nthat are described as follows (Avseth et al., 2005):\n\nksat \u00bc kdry \u00fe\n\u00f01?\u00f0kdry=kmin\u00de\u00de\n\n2\n\n\u00f0?=kf l\u00de \u00fe \u00f0\u00f01??\u00de=kmin\u00de?\u00f0kdry=kmin\n2\n\u00de\n; \u00f09\u00de\n\n?sat \u00bc ?dry; \u00f010\u00de\n\nwhere kdry, kmin and kfl are the bulk moduli of the rock frame, the\n\nmineral and the fluid mixture. ?dry And ?sat are the shear moduli of\n\nthe dry rock and the rock with pore fluid, respectively.\n\nTo compute the dry bulk and shear modulus, the known friable\n\nor uncemented sand model (Mavko et al., 2003) is used in this\n\nwork. This model makes use of the Hertz\u2013Mindlin contact theory\n\nand a heuristic modified Hashin\u2013Strikman lower bound, according\n\nto the equations:\n\nkdry \u00bc\n?=?c\n\nkHM \u00fe 4?HM=3\n\u00fe\n\n1??=?c\nkmin \u00fe 4?HM=3\n\n% &amp;?1\n\n?\n4\n\n3\n?HM; \u00f011\u00de\n\n?dry \u00bc\n?=?c\n\n?HM \u00fe z\n\u00fe\n\n1??=?c\n?min \u00fe z\n\n% &amp;?1\n\n?z \u00f012\u00de\n\nwhere\n\nz \u00bc\n?HM\n\n6\n\n9kHM \u00fe 8?HM\nkHM \u00fe 2?HM\n\n' (\n\n; \u00f013\u00de\n\nwhere kHM and mHM are the bulk and shear moduli, respectively, at\n\ncritical porosity ?c given by the contact Hertz\u2013Mindlin theory,\n\nkHM \u00bc\nn2\u00f01??c\u00de\n\n2\n?min\n\n2\n\n18?2\u00f01??\u00de2\nPef f\n\n\" #\u00f01=3\u00de\n\n; \u00f014\u00de\n\n?HM \u00bc\n5?4?\n\n5\u00f02??\u00de\n\n3n2\u00f01??c\u00de\n2\n?min\n\n2\n\n2?2\u00f01??\u00de2\nPef f\n\n\" #\u00f01=3\u00de\n\n; \u00f015\u00de\n\nwhere Peff is the effective pressure; ?min and ? are the mineral\n\nshear bulk modulus and Poisson ratio and n is the coordination\n\nnumber. Effective pressure follows the relation Peff\u00bcPover?? $ Pre,\n\nwhere Pover is the overburden pressure, Pre is the pore pressure\n\nand the parameter ? is the coefficient of internal deformation,\n\nwhich is assumed to be equal to one in this work.\n\nThe bulk modulus of the pore fluid is estimated by Wood's law\n\ngiven as:\n\nkf l \u00bc\nSw\nkw\n\n\u00fe\nSo\nko\n\n% &amp;?1\n\n\u00f016\u00de\n\nwhere kw and ko denote the oil and water bulk moduli, respec-\n\ntively. The fluids bulk moduli (kw and ko) are computed from the\n\nfluid bulk densities and fluid acoustic velocity through the Batzle\n\nFig. 7. Time-lapse difference of the synthetic seismic attributes without adding\n\nnoise. (a) P-impedance. (b) S-impedance.\nFig. 8. Time-lapse difference of the synthetic seismic attributes after noise addition\n\nand filtering. (a) P-impedance. (b) S-impedance.\n\nFig. 6. Results of reference and base model simulation after six years of production for the third reservoir layer.\n\nA. Davolio et al. / Journal of Petroleum Science and Engineering 105 (2013) 51\u201361 57\n\n     33\n\n\n\nand Wang (1992) equations. The bulk densities ?o and ?w can also\n\nbe exported from the flow simulation and used as an input to\n\ncompute bulk fluid modulus. A summary can be found in Mavko\n\net al. (2003). Note that in this work it is assumed that there is no\n\npresence of gas.\n\n3.5. Synthetic seismic\n\nThe input unknowns for the petro-elastic modeling can be\n\nsingle constants, or grid properties. The single constants can be\n\ntemperature, overburden pressure, mineral properties (bulk and\n\nshear moduli, mineral density etc.) and fluid properties (salinity,\n\ndensity etc.). For the dataset considered in this work, the only grid\n\nproperties used as input for the PEM are the porosity field, facies\n\nlocation and the dynamic properties (pressure and saturation). In\n\nother cases, it can have other parameters, such as, for instance,\n\nnet pay.\n\nTo build the synthetic P and S impedances, the petro-elastic\n\nmodeling is run using the reference model parameters. The same\n\nforward modeling that is done within the inversion process (with\n\nthe base model properties) is previously applied to convert\n\nsimulated pressure and saturation (from the reference model)\n\ninto IP and IS for each simulation grid block. As the same PEM is\n\nused in both situations, this work assumes that errors are not\n\nbeing accounted for in the petro-elastic equations.\n\nFrom the point of view of the inversion process, the most\n\nimportant error/uncertainty assumed in the considered dataset\n\nconcerns the porosity field (Fig. 5), since this property has a high\n\ninfluence when computing seismic attributes. A more detailed\n\ndiscussion about the influence of noise/errors in the inversion\n\nprocess is presented in Davolio et al. (2012). In this work, the\n\nauthors show that, for the PEM considered (the same one\n\nconsidered here), porosity is the most influential attribute to\n\ncompute seismic impedances, but even if this property is not\n\ntotally known, it is still possible to estimate pressure and satura-\n\ntion information from seismic data (provided that 4D data is used,\n\nnot 3D).\n\nTwo production times are considered in this work; the initial\n\ntime (before production starts) and after six years of production,\n\nyielding a total of four impedance volumes representing the\n\nseismic data (P and S impedances for each survey).\n\nWith the purpose of having the synthetic data closer to real\n\ncases, an independent random noise of 1% of the average was\n\nadded to each P and S impedance volume. To avoid the high\n\nfrequency content that appears when computing time-lapse\n\ndifferences from these noisy attributes, a 2D median filter was\n\napplied to the noisy impedance volumes. Figs. 7 and 8 show the\n\ntime-lapse difference for the synthetic attributes generated before\n\nand after disturbing them. Because of the median filter application,\n\nthe perturbation observed in the impedances present different\n\nmagnitudes for each reservoir location ranging from 1% to 50%, as\n\nshown in Fig. 9.\n\nThe dataset used in this work does not take into account scale\n\ndifferences between seismic and simulator data, which means that\n\nreference and base models are at the same scale. Another\n\nsimplification made concerns the presence of gas, i.e., the dataset\n\ncorresponds to a water-flooding example (no presence of gas).\n\n3.6. Multiple models: limits extraction\n\nAfter combining all the uncertainties described in Section 3.2,\n\n400 simulation models were generated. Each model was run using\n\na Black-Oil reservoir simulator and, for each model, pressure and\n\nsaturation values of each reservoir grid block were recorded. Then,\n\nfor each block, a vector with 400 values of saturation and pressure\n\nwas obtained, from which the minimum and maximum values\n\nwere extracted along all the 400 possibilities, as shown in Fig. 3.\n\nThus, these are the new limits used to constrain the solution space\nFig. 9. Percentage of noise added in the synthetic impedances. (a) Noise percentage\n\nin ?4DIP and (b) noise percentage in ?4DIS.\n\nFig. 10. Simulation results for well bottom-hole pressure for four injectors: green curves represent models kept after the exclusion criterion. (For interpretation of the\n\nreferences to color in this figure legend, the reader is referred to the web version of this article.)\n\nA. Davolio et al. / Journal of Petroleum Science and Engineering 105 (2013) 51\u20136158\n\n     34\n\n\n\nof the inversion process; the results of this application are shown\n\nin Section 4.2.\n\nThe well bottom-hole pressure curves (for four injector wells)\n\nfor the 400 simulated models are presented in Fig. 10, in red. They\n\nrepresent the initial dispersion of the models. The green curves\n\nrepresent the models closer to the history, after the application of\n\nthe exclusion criteria. In this case, a cut-off value of 20% was used.\n\nThis means that models with misfit greater than 20% with respect\n\nto the more misadjusted model are discarded. The number of\n\nmodels was then reduced to 64. The procedure of extracting\n\nminimum and maximum values was repeated for this reduced\n\nset of models and the results of using these limits in the inversion\n\nare presented in Section 4.3.\n\n4. Results and discussion\n\nThe inversion procedure was run for three different cases; for\n\neach of them the optimization assumed different constraints for\n\nthe variables of pressure and saturation. In case 1, generic, or\n\nusual, constraints were used. For the second case, new limits\n\nextracted from the 400 models were used to constrain the solution\n\nspace; the same was done in case 3, considering only the 64\n\nmodels that were selected according to the applied cut-off.\n\n4.1. Case 1: inversion results using generic constraints\n\nThe constraints applied to pressure and saturation for the first\n\ncase were established according to known reservoir simulation\n\nassumptions. For Sw the limits were the connate water saturation\n\n(lower limit) and one minus residual oil saturation (upper limit).\n\nFor pressure, the injection pressure was used as the upper limit\n\nand the minimum well bottom-hole as the lower limit. The\n\nestimated pressure and saturation maps for the third layer can\n\nbe seen at the top of Fig. 11. The errors are displayed at the bottom\n\nof the same image, computed through the difference: reference\n\n?estimated.\n\nKnowing that the true answer is displayed in Fig. 6a and c, it\n\ncould be said that the inversion did a good job, since the main\n\nfeatures were captured, especially for the pressure map, where a\n\nnice improvement can be seen when compared to the initial guess\n\n(Fig. 6d).\n\nClearly, the estimated maps present a noisy aspect due to the\n\nerrors presented in the synthetic seismic data, showing the\n\nnecessity for the proposed methodology to use engineering data\n\nin order to minimize the noise influence on the estimated proper-\n\nties. These results are presented in the next section.\n\n4.2. Case 2: inversion results using multiple models simulation\n\nAs mentioned previously, the combination of the uncertainties\n\nproduced 400 models. From the simulation results of all these\n\nmodels, minimum and maximum values were extracted for\n\npressure and saturation for each reservoir block. Therefore, the\n\nsolution space of the optimization process is now constrained by\n\nthese limits. Following the same layout as Fig. 11, the improvement\n\nof the estimated properties can be observed in Fig. 12 when these\n\nnew constraints are applied. Comparing the error maps in Figs. 11c\n\nand 12c, a less noisy behavior of the new estimated saturation can\n\nbe noted. Observe that, especially for regions where the water was\n\nFig. 11. Inversion results of case 1 for the second survey; layer 3. (a) Estimated\n\nwater saturation. (b) Estimated pressure (MPa). (c) Sw error: estimated?reference.\n\n(d) Pressure error: estimated?reference.\n\nFig. 12. Inversion results of case 2 for the second survey; layer 3. (a) Estimated\n\nwater saturation. (b) Estimated pressure (MPa). (c) Sw error: estimated?reference.\n\n(d) Pressure error: estimated?reference.\n\nFig. 13. Inversion results of case 3 for the second survey; layer 3. (a) Estimated\n\nwater saturation. (b) Estimated pressure (MPa). (c) Sw error: estimated?reference.\n\n(d) Pressure error: estimated?reference.\n\nA. Davolio et al. / Journal of Petroleum Science and Engineering 105 (2013) 51\u201361 59\n\n     35\n\n\n\nnot supposed to reach, the new estimated saturation map pre-\n\nsented more corrected values.\n\nAlthough not as pronounced as the saturation maps, the new\n\nestimation of pressure has shown an improvement that can be\n\nbetter observed by comparing Fig. 11d and Fig. 12d.\n\n4.3. Case 3: inversion results using multiple model simulation\n\nand well dynamic data\n\nReducing the number of simulation models by selecting only\n\nthe ones closest to the history data automatically produces stricter\n\nlimits to be used in the inversion process. As a result, it can be\n\nobserved in Fig. 13 that these new limits, computed from the 64\n\nselected models, allowed a reduction in the observed errors for\n\nboth parameters (pressure and saturation).\n\nAnother way to compare the three results presented is by\n\nlooking at the images displayed in Fig. 14, that show the histo-\n\ngrams of water saturation and pressure errors for the three\n\ninversion results (built using the data of Figs. 11c, d, 12c, d and\n\n13c, d).\n\nFig. 14a clearly shows the largest concentration of values close\n\nto zero for case 3 when compared to the other two cases,\n\nindicating that the inversion constrained by the new limits\n\n(obtained from 64 simulations) yielded the best results for\n\nsaturation. Another interesting feature observed is the gradual\n\nimprovement from case 1 to case 2 and then to case 3.\n\nAlthough less pronounced, the same improvement can be\n\nobserved for the pressure errors in Fig. 14b. Again, case 3 presented\n\nthe largest concentration of points close to zero, indicating that\n\nthis is the best estimation of pressure.\n\n4.4. Comments\n\nThe focus of the proposed methodology is to use flow simula-\n\ntion information to guide the estimation of pressure and satura-\n\ntion from 4D seismic. Its relevance remains in the calibration of\n\ncomputed dynamic properties with flow conditions. This is an\n\ninnovative aspect, since the works presented in the literature\n\nusually do not use engineering data (such as production profiles,\n\nuncertainty analysis etc.) for quantitative interpretation of time-\n\nlapse seismic anomalies.\n\nIt is important to emphasize that this work does not concern\n\nreservoir uncertainties mitigation. Nor is it proposing a new\n\ninversion technique to estimate the dynamic properties. Both\n\ntechniques (uncertainties analysis and inversion) are used as tools\n\nto apply the proposed methodology.\n\nThe proposed methodology has the benefit of better exploring\n\n4D seismic signals, since this helps in the quantification of the\n\nsaturation and pressure values by imposing limits that come from\n\nflow simulation (considering uncertainties). The limits imposed by\n\nthe multiple models can, for instance, clean some areas in the\n\nestimated water saturation map where, according to the simula-\n\ntions, water should not have reached. This kind of result was\n\nobserved in the synthetic example presented.\n\nAlthough the application of the proposed methodology was\n\nsuccessful for a synthetic model, there are some additional\n\nchallenges to be addressed in real data. In cases where the\n\nuncertainty analysis is not done properly (e.g., having not taken\n\ninto account an unknown unknown), for instance, the methodol-\n\nogy might force the inversion limits to the boundaries. Therefore,\n\nthe next step of the proposed methodology would be to verify the\n\nlocations where this kind of behavior is observed and to evaluate\n\nwhether the time-lapse seismic or the uncertainty analysis has\n\nsome problems. This kind of integration will be useful, at least, to\n\nverify if the uncertain attributes are being correctly represented,\n\nand if the flow behavior, taking into account these uncertainties, is\n\nin agreement with the time-lapse signals, which can be indicative\n\nof the quality of the reservoir characterization.\n\n5. Conclusions\n\nA methodology to integrate time-lapse seismic data and\n\nreservoir simulation has been proposed. The process uses multiple\n\nsimulation models, generated through the combination of uncer-\n\ntain reservoir attributes, to derive limits for pressure and satura-\n\ntion. These limits are later used to constrain an inversion scheme\n\nfor estimating the dynamic properties from 4D seismic, avoiding\n\nvalues that are incompatible with flow conditions constrained by\n\nthe characterization process.\n\nThe methodology was applied to a synthetic dataset, yielding a\n\nbetter estimation of the dynamic properties, especially for the\n\nwater saturation front. The use of well dynamic data to reduce the\n\nmodels dispersion complemented the methodology, improving\n\nthe results even more. The important contribution of this work\n\nremains in the quantitative use of available knowledge from\n\nreservoir characterization and flow simulation, tying them to\n\nobserved changes in 4D seismic, and thus extracting, in a more\n\nreliable way, changes due to production (pressure and saturation\n\nchanges).\n\nThe proposed methodology presented promising results, show-\n\ning that the integration between seismic and simulation data can\n\nimprove the reservoir dynamic properties characterization. It has\n\nan innovative aspect in the sense that the works in the literature\n\nconcerning quantitative integration between the two different\n\ndatasets usually incorporate seismic attributes into the history\n\nFig. 14. (a) Histogram of the errors displayed in Figs. 11c, 12c and 13c. (b) Histogram of the errors displayed in Figs. 11d, 12d and 13d.\n\nA. Davolio et al. / Journal of Petroleum Science and Engineering 105 (2013) 51\u20136160\n\n     36\n\n\n\nmatching. Here, the proposal is to calibrate the 4D signals\n\nresponse before running a history matching, in order to avoid\n\nincorporating too much incorrect information into the matching.\n\nAlthough an application of the estimated maps in a history\n\nmatching process was not presented here (which is the next step\n\nin this type of methodology), what has been shown is that the\n\nproposed methodology can yield more robust pressure and satura-\n\ntion maps with less uncertainty, which can then be incorporated\n\nquantitatively into the history matching process.\n\nThe application of this methodology was successful for a\n\nsynthetic model; however, there are some additional challenges\n\nfor real data. Future work should attempt to extend the methodol-\n\nogy to a statistical approach, in order to deal with more complex\n\ncases. In this case, instead of extracting minimum and maximum\n\nvalues, probability density functions (pdf) will be generated for\n\neach reservoir block from both engineering and 4D seismic data.\n\nThe main idea is that by matching these pdfs, it will be possible to\n\nmore effectively integrate 4D seismic and reservoir simulation in\n\ncases of greater complexity.\n\nAcknowledgments\n\nThe authors wish to thank UNISIM, PETROBRAS, CEPETRO and\n\nDepartment of Petroleum Engineering for their support to this\n\nwork. We also thank CMGL and Schlumberger for the software\n\nlicenses.\n\nReferences\n\nAvseth, P., Mukerji, T., Mavko, G., 2005. Quantitative Seismic Interpretation:\nApplying Rock Physics Tools to Reduce Interpretations Risk. Cambridge Uni-\nversity Press, Cambridge.\n\nBatzle, M., Wang, Z., 1992. Seismic properties of pore fluids. Geophysics 57 (11),\n1396\u20131408.\n\nCastro, S.A., Caers, J., Otterlei, C.M., Meisingset, H., Hoye, T., Gomel, P., Zachariassen,\nE., 2009. Incorporating 4D seismic data into reservoir models while honoring\nproduction and geologic data: a case study. Leading Edge 28 (12), 1498\u20131506.\n\nDadashpour, M., Landr\u00f8, M., Kleppe, J., 2008. Nonlinear inversion for estimating\nreservoir parameters from time-lapse seismic data. J. Geophys. Eng. 5, 54\u201366.\n\nDadashpour, M., Echeverr\u00eda-Ciaurri, D., Kleppe, J., Landr\u00f8, M., 2009. Porosity and\npermeability estimation by integration of production and time-lapse near and\nfar offset seismic data. J. Geophys. Eng 6, 325\u2013344.\n\nDavolio, A., Maschio, C., Schiozer, D., 2012. Pressure and saturation estimation from\nP and S impedance: a theoretical study. J. Geophys. Eng. 9, 447\u2013460.\n\nFahimuddin, A., Aanonsen, S., Skjervheim, J.A., 2010. Ensemble based 4D seismic\nhistory matching: integration of different levels and types of seismic data.\nSPE131453. In: Proceedings of the Annual Conference Exhibition of SPE\nEUROPEC/EAGE. 14\u201317 June, Barcelona, Spain.\n\nGervais, V., Roggero, F., 2010. Integration of saturation data in a history matching\nprocess based on adaptive local parametrizaion. J. Pet. Sci. Eng 73, 86\u201398.\n\nHelgerud, M.B., Miller, A.C., Johnston, D.H., Udoh, M.S., Jardine, B.G., Harris, C.,\nAubuchon, N., 2011. 4D in the deepwater Gulf of Mexico: Hoover, Madison and\nMarshall fields. Leading Edge 30 (9), 1008\u20131018.\n\nJin, L., Alpak, F.O., Hoek, P.V., Pirmez, C., Fehintola, T., Tendo, F., Olaniyan, E., 2011. A\ncomparison of stochastic data-integration algorithms for the joint history\nmatching of production and time-lapse seismic data. In: Proceedings of the\nAnnual Technical Conference Exhibition of SPE146418. 30 October\u20132 Novem-\nber, Denver, Colorado, USA.\n\nKazemi, A., Stephen, K.D., Shams, A., 2010. Seismic history matching of Nelson using\ntime-lapse seismic data: an investigation of 4D signature normalization.\nSPE131538. In: Proceedings of the Annual Conference Exhibition of SPE\nEUROPEC/EAGE. 14\u201317 June, Barcelona, Spain.\n\nLandro, M., 2001. Discrimination between pressure and fluid saturation changes\nfrom time-lapse seismic data. Geophysics 66, 836\u2013844.\n\nLandro, M., Stronen, L.K., Slheim, O.A., Hilde, E., 2001. Time-lapse seismic as a\ncomplementary tool for in-fill drilling. J. Pet. Sci. Eng. 31, 81\u201392.\n\nMacBeth, C., Floricich, M., Soldo, J., 2006. Going quantitative with 4D seismic\nanalysis. Geophys. Prospect. 54, 303\u2013317.\n\nMaschio, C., Carvalho, C.P.V., Schiozer, D.J., 2010. A new methodology to reduce\nuncertainties in reservoir simulation models using observed data and sampling\ntechniques. J. Pet. Sci. Eng. 72, 110\u2013119.\n\nMavko, G., Mukerji, T., Dvorkin, J., 2003. The Rock Physics Handbook: Tools for\nSeismic Analysis in Porous Media. Cambridge University Press, Cambridge.\n\nNeal, R.M., 2003. Slice sampling. Ann. Stat. 31 (3), 705\u2013767.\nTura, A. and Lumey, D., 1999. Estimating pressure and saturation changes time?\n\nlapse AVO data. SEG Technical Program Expanded Abstr. pp. 1655\u20131658.\nTuttle, C., Pelissier, M., Barnes, M., Tribe, J., Persad, K., 2009. A seismically\n\nconstrained reservoir modeling workflow: case study. Leading Edge 28 (12),\n1492\u20131497.\n\nA. Davolio et al. / Journal of Petroleum Science and Engineering 105 (2013) 51\u201361 61\n\n     37\n\n\n\n     38\n\n\n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n4. PAPER 3: Local history matching using 4D seismic data \n\nand multiple models combination \n\nAlessandra Davolio, C\u00e9lio Maschio, Denis Jos\u00e9 Schiozer \n\nPresented at the EAGE/SPE Europec Annual Conference &amp; Exhibition, London, \n\nUnited Kingdom, 10\u201313 June 2013. \n\n \n\n     39\n\n\n\n     40\n\n\n\n \n\nSPE 164883-MS \n\nLocal History Matching Using 4D Seismic Data and Multiple Models \nCombination \nAlessandra Davolio, C\u00e9lio Maschio, Denis Jos\u00e9 Schiozer, UNICAMP \n\nCopyright 2013, Society of Petroleum Engineers \n \nThis paper was prepared for presentation at the EAGE Annual Conference &amp; Exhibition incor porating SPE Europec held in London, United Kingdom, 10\u201313 June 2013. \n \nThis paper was selected for presentation by an SPE program committee following review of information contained in an abstract  submitted by the author(s). Contents of the paper have not been reviewed \nby the Society of Petroleum Engineers and are subject to correction by the author(s). The material does not necessarily refle ct any position of the Society of Petroleum Engineers, its officers, or \nmembers. Electronic reproduction, distribution, or storage of any part of this paper without the written consent of the Society of Petroleum Engineers is prohibited. Perm ission to reproduce in print is \nrestricted to an abstract of not more than 300 words; illustrations may not be copied. The abstract  must contain conspicuous acknowledgment of SPE copyright. \n\n \n\n \nAbstract \nNowadays there are several methodologies to incorporate quantitatively 4D seismic data in the history matching of reservoir \n\nsimulation models. Most of them add a map attribute derived from 4D seismic, which can be impedance maps, saturations etc., in \n\nthe objective function of the optimization process. In these cases, the goal is to match the dynamic information provided by 4D \n\nseismic with simulation response in the whole reservoir area, or the whole area covered by seismic data. In this work, it is \n\nproposed a history matching methodology that uses 4D seismic information locally for each injector (and the associated produc ers) \n\nindividually, trying to match the water front movement related to each injector with the observed dynamic changes.  \n\nIn order to guarantee consistency with geology, the matching is done by combining static properties that comes from different  \n\nsimulation models. These models are generated through a combination of the most important uncertain parameters in an \n\nuncertainty analysis procedure, geologically consistent, that should be run previously. Then, the matching procedure is based  on \n\nthe computation of the water saturation errors at some sub-regions defined around the injector  for multiple scenarios; the error is \n\ncomputed between water saturation derived from 4D seismic and each model simulation result. The models which presented the \n\nsmallest error for each sub-region are selected and a new simulation model is built by combining the static properties extracted \n\nfrom the selected models at each sub-region. Before calculating the saturation errors the volume of water computed from 4D \n\nseismic is calibrated to the volume of injected water providing a more robust calibration. The methodology was applied to a \n\nsynthetic case where porosity and permeability were the main uncertainties updated by the methodology proposed. Since these \n\nproperties were generated through geostatistic realizations, the adjusted model kept the geological features. The promising results \n\nobserved in the synthetic case showed that the methodology can be a good alternative for history matching, since it is an eas y to \n\nimplement procedure and it does not require sophisticated optimization algorithms to incorporate 4D seismic into the process.  \n\n \n\nIntroduction \nReservoir simulation is one of the main tools used for reservoir management. Thus, one of the main tasks of geologists and \n\nreservoir engineers is to build reliable models, which is not an easy task, due to the complexity present in this kind of problem. The \n\ncomplexity comes mainly from the lack of geological information needed to build such models. This issue can be minimized by \n\nmatching dynamic data (well production, 4D seismic, etc) in a history matching procedure, which is an ill poised inversion process \n\nwith several possible solutions. As it is a difficult and important task, several works can be found in the literature approaching the \n\nproblem with different optimization algorithms, discussing how to use the dynamic data available to be matched and so on. There \n\ntwo relevant issues that has been subject of active research in the last ten years. One is the quantitative incorporation of 4D seismic \n\ndata in the history matching procedure and the other is the development of history matching methodologies that generates models \n\ngeologically consistent.  \n\nThe works of Caers (2003) and Hoffman and Caers (2005) are good examples of history matching methodologies geologically \n\nconsistent. In Caers (2003) it is proposed the multiple-point geostatistics method where geological information is jointly integrate \n\nwith well production data through a geological training image. An extension of this approach is presented in Hoffman and Caers \n\n(2005) where the authors propose a methodology to use the same kind of probability perturbation method (using the training \n\n     41\n\n\n\n2  SPE 164883-MS \n\nimages) but now performing regional perturbations. Consequently, the reservoir can be split into regions and the method allows \n\ndifferent amount of properties change for different parts of the model, being that no discontinuities are formed along the borders. \n\nThe two methodologies mentioned above originally consider only well data to perform the matching, however an application of \n\nthe probability perturbation method proposed by Caers (2003) that also includes 4D seismic data quantitatively can be seen in \n\nCastro et al (2009), for the Oseberg field, and Tolstukhin et al (2012) for the Ekofisk field.  \n\nLanda and Kumar (2011) and Stephen et al (2005) are other examples of history matching process that consider well \n\nproduction and 4D seismic data jointly to perturb the model properties; their methodologies also keep the integration with \n\ngeological information. Both of them perform the history matching with a probabilistic approach but with different algorithms. \n\nLanda and Kumar (2011) uses a Monte Carlo type sampling algorithm and Stephen et al (2005) uses the Neighbourhood \n\nAlgorithm (NA). \n\nThis work proposes a new methodology to run a local history matching using 4D seismic data quantitatively. Multiple models \n\nare used to perform the local matching in a simple process of comparing the errors between 4D seismic data and the reservoir \n\nmodel realizations. Differently of the methods usually find in the literature, as the one mentioned before, in the methodology \n\nproposed here no optimization process is performed. Another point is that it assumes that an uncertainty analysis was run \n\npreviously so that it generated several model realizations. These realizations are used to update the reservoir properties, hence the \n\nmodel obtained after the matching will keep some geological consistence. In order to validate the methodology an application in a \n\nsynthetic dataset is presented. The main contribution of this work remains in the simple approach proposed which can be an \n\nalternative to the sophisticated algorithms mentioned before.  \n\n \n\nMethodology \n\nIt is common nowadays to run statistical analysis to better understand the effect of uncertainties on reservoir behavior; as a \n\nresult of this kind of procedure, several model realizations are generated by combining the most important uncertainties. The goal \n\nof the methodology proposed in this work is to harness these models together with 4D seismic to run a local history matching \n\nprocedure that updates the reservoir properties without losing their geological aspect. The proposed approach aims to use the data \n\nprovided by 4D seismic locally, by performing a local matching, considering each injector region, trying to adjust the movement of \n\nthe water front.  \n\nThe 4D seismic data considered in this work consist of water saturation difference map (?4DSwseis), generated by an inversion \n\nprocess such as the one described in Davolio et al (2012a). Thus, the local matching is done by dividing the reservoir into regions \n\naccording to the location of the injector wells and its correspondent water saturation error map observed. Then, local properties \n\nsuch as porosity, permeability etc., are modified in order to minimize water saturation errors between the data provided by 4D \n\nseismic and the simulation model. The local modification of the static properties is done by using several model realizations. A \n\nmore detailed description of the whole matching process is presented below. Note that the operator ?4D stands for the time lapse \n\ndifference:  property at time 1 \u2013 property at time 0 (time 0 and 1correspond to two seismic surveys). \n\n1- Simulate the n models generated by an uncertainty analysis procedure run previously and calculate the water saturation \n\ntime lapse difference for each model (?4DSwsim_i, for i=1:n); \n\n2- Simulate the base model and calculate the water saturation time lapse difference (?4DSwbase); \n3- Compute water saturation error map of the base model:  \n\n                             ;      (1) \n4- Select an injector well and define regions around it according to the error map computed in step 3; \n5- For each region and each of the n model realization calculate the quadratic error: \n\n   ?           \n   \n\n         \n   \n\n      ,     (2) \n\nbeing that i,j,k are the block coordinates inside the region. \n\n6- For each region select the model which presents the smallest quadratic error computed in step 5; \n7- For the models selected in step 6, cut the local properties inside each region; \n8- Replace the base model properties inside each region for the properties extracted in step 7; \n9- Simulate the new base model and analyze the error map (equation 1), if the errors are acceptable select another injector \n\nand go to step 2, if not, redefine de regions and go back to step 5. \n\nIn order to use water saturation maps provided by 4D seismic data quantitatively, as described above, it is important to \n\ncalibrate this information with engineering data. In this sense, an additional procedure is run before the step 3 defined above. It \n\nconsists of computing the amount of injected water according to the water saturation map provided by 4D seismic and dividing this \n\nvalue by the known volume of injected water. The result is a correction factor that should be applied to the 4D seismic data by \n\ndividing the water saturation map by this number. \n\nAnother important fact to highlight is that the methodology described above should be used for local properties, so if there are \n\nglobal properties, such as relative permeability, that plays an important role in the reservoir response, then a global matching \n\nshould be applied before starting the local matching. \n\n     42\n\n\n\nSPE 164883-MS  3 \n\nSince it is not the focus of this work to perform a complex global match, a simple manual matching procedure based only in \n\nwell data is proposed. The procedure treats each set of global property at a time and it consists of building hundreds of models \n\nthrough the derivative tree technique (Schiozer et al, 2004), where all the levels of one set of parameters are combined. Then, the \n\nquadratic error between each well production curve of each model and history data is computed according to the equation: \n\n       ?            \n  \n\n   ,       (3) \n\nwhere m is the number of production data and obs is the history. After that, for each model is calculated an average of the \n\nquadratic error of all wells, then the 20 models (which correspond to 10% of the amount of models used in this work) that \n\nproduced the smallest average are selected. Finally a histogram showing the frequency of occurrence of each level for the 20 \n\nselected models is built and the analysis of the histograms indicates the value (defined by the levels) that should give the best \n\nmatch. Once a parameter is adjusted the model keeps this value and the procedure is repeated for the next global parameter to be \n\nmatched. \n\nOne more thing to comment about the methodology proposed concerns the different scales of simulation and seismic data. In \n\nthe data considered in this work, this is not an issue because the synthetic 4D seismic was generated at the simulation scale. \n\nHowever, in more realistic cases, this issue needs to be addressed; the simplest way would be to convert seismic data to the \n\nsimulation scale. The efficiency of the methodology will depend on how much information is left after the scale transfer. \n\n \n\nApplication \n\nThe data required to apply the proposed methodology are 4D seismic data (converted to water saturation maps), the reservoir \n\nsimulation model (base model) and the multiple model realizations resulted from an uncertainty analysis. This work uses a \n\nsynthetic dataset, so, apart from the base model and the multiple realizations, there is also the reference model that represents the \n\ntrue earth model used to check the accuracy of the history matching proposed. This model was also used to generate the synthetic \n\n4D seismic, which was disturbed by adding some noise. Follow bellow the description of all the data used. \n\nReservoir model description \n\nThe reservoir model considered in this work was discretized in a corner-point grid with 90?110?5 blocks, 60m in size in x and \n\ny direction (5400 ? 6600m) and 15m (on the average) in z direction. There are three facies characterized according to three \n\npermeability ranges. The reservoir also comprises four faults, as can be seen in figure 1. The reservoir is drained by eight vertical \n\nproducer wells, supported by seven water injector wells. \n\n \n \n \n \n\nTable 1: Base and reference model global properties. \n\n Fault 1 Fault 2 Fault 3 Fault 4 Kz/Kx \nCorey exp. \n\nFacies \n\nReference 0.4 0.001 0.03 0.8 0.100 4.6 3.1 1.3 \n\nBase 0 0.1 0 1 0.096 4.4 4.2 1.0 \n\n \n\n \n\n \n\n \n\n \nFigure 1: Reservoir model. \n\n \n\nModel uncertainties \n\nThere are a total of ten uncertain parameters considered in this work, being that eight of them are defined as multipliers as \n\nfollow: \n\n? Four faults transmissibility; \n\n? Relative permeability curves (Corey exponents for the water phase) for each of the three facies; \n\n? Permeability ratio (vertical/horizontal). \nThe other two uncertain parameters are porosity and permeability; both were generated by geostatistical techniques. Using the \n\nsequential Gaussian simulation technique (SGS), 200 realizations of porosity were generated having the seismic P-impedance \n\nvolume at time 0 (base survey) as a secondary variable. Each of these porosity fields was used later as a second variable for  the \n\nSGS to generate 200 realizations of permeability. \n\nBase and reference model \n\nThe differences of the base and reference models are the 10 uncertainties described above. The base model was built by a \n\nrandom combination of the ten uncertainties described above. The values of the parameters, for both models, defined as multipliers \n\n     43\n\n\n\n4  SPE 164883-MS \n\nare presented in table 1. The other two uncertainties are the porosity and permeability fields that can be seen on figure 2. The \n\nreference model properties were not built by the same geostatistic procedure mentioned before, i.e., they do not belong to the set of \n\n200 realizations. Thus it can be observed relevant differences in the images especially for permeability.  \n\n \nFigure 2: Reference and base models properties for the third reservoir layer. Reference model porosity (a) and horizontal permeability (b). \nBase model porosity (c) and horizontal permeability (d). \n\n \n\nSaturation from 4D seismic data \n\nThe 4D seismic data used in the history matching is the estimated volume (it is not a map because in this synthetic dataset the \n\nseismic data has the same scale of the simulation model, i.e., 5 layers) of the time lapse difference of water saturation. The base \n\nsurvey (time 0) corresponds to the initial reservoir state, before production start and the second seismic survey corresponds to the \n\nreservoir after 6 years of production. The estimation of water saturation differences was made by an inversion process conditioned \n\nto flow conditions according to the methodology described in Davolio et al (2012b) and it is shown in figure 3b. Due to the noise \n\nadded to the synthetic seismic data the estimated water saturation front presents some errors (figure 3c) when compared to the true \n\nanswer given by the reference model (figure 3a).  \n\n \nFigure 3: (a) Water saturation difference of the reference model (?4DSwref). (b) Estimated water saturation difference from 4D seismic \n\n(?4DSwseis). (c) Error of the estimated water saturation difference: (?4DSwseis-?4DSwref). All images correspond to the third layer. \n\n \n\nGlobal matching \n\nThe case considered in this work has two important global properties: relative permeability (kr) and faults transmissibility. As \n\nmentioned before, in the global matching these two parameters are treated individually. In this work the procedure starts with the \n\nfaults transmissibility. Four levels are considered for the four faults: level 0= 0, level 1= 0.001, level 2= 0.01 and level 3= 1. Thus, \n\n256 models are created by combining all the possibilities through the derivative tree technique. Then, the quadratic error (equation \n\n3) of the Bottom Hole Pressure (BHP) curves of each model for each well is computed. Although fault transmissibility is a global \n\nparameter, its influence is limited to some wells. The consequences of changing the transmissibility of fault 1, for instance, will not \n\ninterfere considerably the production of PROD5. So, for each fault only the closer wells are considered to compute the average of \n\nthe quadratic error. The well selected for each fault are: \n\n? Fault 1: INJ1,INJ2,INJ3,INJ7,PROD1,PROD2,PROD3; \n\n? Fault 2: INJ3,INJ6,PROD3,PROD4,PROD6,PROD8; \n\n? Fault 3: INJ4, INJ5, PROD6; \n\n? Fault 4: INJ4, PROD5 \nHence, taking fault 1 as an example, the average of the quadratic error of only the 7 wells defined above is computed for each \n\nof the 256 models. Then, the 20 models that gave the smallest quadratic error are selected to do the histogram analysis. The same \n\nprocedure is valid for the other three faults. \n\nPor\nKx (mD)Kx (mD) Por\n\n(a) (b) (c) (d)\n\n     44\n\n\n\nSPE 164883-MS  5 \n\nOnce the faults transmissibility of the base model are updated, the next step is to repeat the same procedure for relative \n\npermeability. In this case five levels for the Corey exponent was considered, the values are: level 0= 1, level 1= 2, level 2= 3, level \n\n3= 4 and level 4= 5. As there are three facies, after combining all the uncertainties levels through the derivative tree technique, 125 \n\nmodels are created. In this case the quadratic error is computed using the water rate curves (Qw). After that, it is calculated an \n\naverage of the quadratic error of all the 8 producer wells for each of the 125 models. And, again the 20 models that gave the \n\nsmallest quadratic error are selected to do the histogram analysis. Note that, although some trend can be observed for the facies \n\nlogs at the well location, it is not coherent to select the wells according to that for each facies (as it was done with the faults), \n\nbecause the flow depends on the facies in a neighborhood of the well not only at its position (the flow in a given facies influences \n\nwells located in other facies). This explains why all the 8 wells are considered simultaneously in this analysis. \n\n \n\nResults \n\nGlobal matching \n\nThe histograms shown in figure 4 were built using the 20 models selected by the average of the quadratic error of the BHP \n\ncurves of the corresponding selection for each fault. Analyzing the results it can be said that for the faults 1, 3 and 4 the level 3 \n\nshould be used, which correspond to a transmissibility multiplier value of 1 and that for fault 2 the most frequent level is 1, \n\ndenoting that the transmissibility multiplier value for this fault should be 0.001. \n\n \n\n \nFigure 4: Frequency of occurrence of each level of transmissibility for the four faults: (a) fault 1, (b) fault 2, (c) fault 3 and (d) fault 4. \n\n \n\nFollowing the analysis of the best 20 models, but in this case for Qw curves, the second global match (for Kr) done produces \n\nthe histogram displayed in figure 5. From the histograms it can be said that for facie 1 there is nothing to conclude since the \n\nfrequency of occurrence of the 5 levels of the Corey exponent are similar, so the value of the base model is kept. For facies 2, the \n\nresults indicate level 2, so the Corey exponent is set as 3. For facies 3 the Corey exponent is 1, corresponding to level 0. \n\n \n\n \nFigure 5: Frequency of occurrence of each level of the Corey exponent for the three facies: (a) facie 1, (b) facie 2 and (c) facie 3. \n\n \n\nTable 2 Table 2summarizes the results of the global matching applied that updated the faults transmissibility and relative \n\npermeability curves. \n\n \nTable 2: Base model after global matching properties \n\n Fault 1 Fault 2 Fault 3 Fault 4 \nCorey exp. \n\nFacies \n\nUpdated base model 1 0.001 1 1 4.4 3 1 \n\n \n\n \n\n \n\n     45\n\n\n\n6  SPE 164883-MS \n\nLocal matching \n\nNow that the global properties are updated the proposed methodology for the local matching can be applied. One of the input \n\ndata for the local matching is the set of model realizations that come from the uncertainty analysis. Let\u2019s consider that the global \n\nmatching done previously reduced the uncertainties, so the faults transmissibility and the relative permeability curves are fixed \n\nnow and. Since the ratio kz/kx is not such an important parameter for this model, the remaining uncertainties are porosity and \n\nabsolute permeability. Thus, the number of model realizations is 200, being that the only difference between them are the \n\ncorrelated porosity and permeability fields. To start the local matching the first procedure is to analyze the error map of the time \n\nlapse difference of the water saturation provided by 4D seismic and the one computed from the base model (with the global \n\nproperties updated). \n\n \nFigure 6: Error map between the data provided by 4D seismic and the base model after the global matching: ?4DSwseis-?4DSwbase_global. (a) \nLayer 3. (b) Layer 4. (c) Layer 5. \n\n \n\nIn the dataset used in this work seismic data is at the simulation scale, so this information is available at all the five layers of \n\nthe model. Figure 6 shows the error map for the last three layers, which are the ones containing more water. From figure 6 it can be \n\nverified that the main water saturation error observed are related to the injectors: INJ3, INJ4, INJ5 and INJ1. Thus, these wells \n\nwere selected to perform the local matching in order to update the porosity and permeability fields of the base model. Since the \n\nwell INJ3 has a central location, its water front could reach several wells, so this injector was the first one used to define the \n\nregions where the properties should be modified. Four regions were defined around it, see in figure 7 regions R1a, R1b, R1c and \n\nR1d; being that each of them includes one producer: PROD1, PROD3, PROD6 and PROD8, respectively. Then, the other 3 \n\nregions seen in figure 7 (R2, R3 and R4) were also defined by including the corresponding producer of each injector as well as \n\nanalyzing the error observed in the maps. Note that the regions should not overlap. The next step of the methodology is to compute \n\nthe quadratic error (equation 2) within each region for the 200 models and then to update porosity and permeability inside each \n\nregion by replacing these properties of the base model by the ones presented in the models that yielded the smallest quadratic error. \n\nBefore computing the quadratic error of the time lapse difference of water saturation maps, the data provided by 4D seismic s hould \n\nbe calibrated with the volume of injected water. Although this is an important step of the methodology the tests for this case did \n\nnot present good results and some improvements need to be done to better evaluate volume differences. \n \n\nFigure 7: Regions where the local matching is performed. \n \n\nThe definition of the regions depends on the error map observed which depends on the resolution of the 4D seismic data. In \n\nthis work the 4D data has the same vertical scale of the simulation model, so the regions can also be defined vertically. After some \n\n     46\n\n\n\nSPE 164883-MS  7 \n\ntests it was verified that for some of the regions a much better matching was reached when each of these regions was split into \n\nfive, i.e, each layer is considered as another region. This kind of sub-division was made in the regions R3 and R4. Thus, for these \n\ntwo regions the quadratic error was computed for each layer separately which means that the properties (porosity and permeability) \n\nupdate for different layers can come from different models. For the regions around INJ3 (R1a, R1b, R1c, R1d) and around INJ1 \n\n(R2) the quadratic error was computed considering all the five layers together, so if, for instance, the model 37 was the one which \n\npresented the smallest error for the region R2 then the porosity and permeability values of the base model was replaced (just inside \n\nthe region) by the ones from model 37 in all layers. \n\n \n\n \nFigure 8: Permeability of the base model (a), the reference model (b) and the base model after the local matching (c). Porosity of the base \nmodel (d), the reference model (e) and the base model after the local matching (f). All the images correspond to the fourth model layer. \n\nFigures 8c and 8f show the results of the local matching for permeability and porosity, respectively. In the same figure it is \n\npossible to check how the properties were modified by comparing with the base model images (figures 8a and 8d) and also to \n\ncheck if the results are closer to the reference model (figures 8b and 8e). It is important to note that the reference model properties \n\nwere not generated through the same geostatistics procedure, more than that, all the 200 realizations of porosity and permeability \n\nare not very close to the reference model ones, especially for permeability, this explain the big difference between these properties \n\nand the ones of the base model. Another point to highlight is that the procedure tries to match the water saturation information that \n\ncomes from 4D seismic which has some noise included, so the match cannot be perfect. Apart from these issues it is still possible \n\nto identify some similarities between the reference model properties and the ones updated after the local matching. An example is \n\nthe zone of high permeability observed in the region R1c (figure 8c) that is better defined than the one of the base model. Another \n\nexample is the low porosity zone between INJ1 and PROD2 that is also improved after the local matching.  \n\nEven not having a perfect agreement between the properties of the reference model and the model after the history matching, a \n\nsubstantial improvement can be verified in the error maps of water saturation. The images of figure 9 show the initial error maps, \n\ni.e., the error between the data provided by 4D seismic and the initial base model. Note that the white areas observed inside the \n\nreservoir correspond to points where the error is outside the range of the color scale [-0.35, 0.35], so these areas present the biggest \n\nerrors. Following the same layout of figure 9, figures 10 and 11 display the results of the global matching  and  the final history \n\nmatching performed (global+local), respectively. After the global matching (figure 10) some improvement can be observed in the \n\nerror maps, but the error decrease of water saturation is actually relevant after the application of the local matching (figure 11). \n\nAlthough some errors can still be observed in the maps of figure 11, the local matching performed presented satisfactory results \n\ncorrecting the water front movement of the injectors selected. Note that the level of error reduction was similar for all the regions \n\ndefined, this shows that the regions delimitation can be coarser like region R2 (defined as a regular region), or it can be more \n\nrefined as it was done for regions R3 and R4 where the vertical subdivision was applied turning them into 5 sub-regions each. The \n\nchoice of how to define the regions is then made according to the error observed and the resolution of the data available.  \n\n     47\n\n\n\n8  SPE 164883-MS \n\n \nFigure 9: Error map between the data provided by 4D seismic and the base model:?4DSwseis-?4DSwbase. From left to right are the maps of \nlayers 1 to 5. \n\n \nFigure 10: Error map between the data provided by 4D seismic and the base model after the global match:?4DSwseis-?4DSwglobal. From left to \nright are the maps of layers 1 to 5. \n\n \n\nFigure 11: Error map between the data provided by 4D seismic and the base model after global and local matching:?4DSwseis-?4DSwfinal_base. \nFrom left to right are the maps of layers 1 to 5. \n\n \n\n \nFigure 12: Histogram of the Sw errors map observed in figure 9 (blue), figure 10 (black) and figure 11 (green) that correspond to the Sw \nerror of the initial base model,  the model after the global matching and the model after global+local matching. \n\n     48\n\n\n\nSPE 164883-MS  9 \n\n \nFigure 13: Bottom hole pressure curves [kgf/cm2] of four injectors. History data is in red circle, base model in solid blue, the model after \nglobal match in black diamond and the model after the global+local matching is in dashed green. The vertical magenta line divides the \nperiod in history and forecast. \n \n\n \n\n \nFigure 14: Water rate curves [m3/day] of four producers. History data is in red circle, base model in solid blue, the model after global \nmatch in black diamond and the model after the global+local matching is in dashed green. The vertical magenta line divides the period in \nhistory and forecast. \n\n \n\nFigure 12 shows the histogram of the water saturation errors presented in figures 9, 10 and 11. This is just another way (a \n\nquantitative measure) to verify the improvement already observed in the error maps. The bigger concentration of values around \n\nzero together with the smaller concentration of higher errors, are confirming the improvement obtained after applying the local \n\nhistory matching. \n\nFigures 13 and 14 show the pressure and production curves for some wells, including the forecast period (marked by the \n\nmagenta line), remembering that the history matching was performed in 1996. In both figures it is possible to verify that the global \n\nmatching presented better curves then the initial model. As the global match did a good job, few improvements were obtained in \n\nthe curves after the application of the local matching.  In this sense, the BHP curves presented in figures 13 show a pretty similar \n\nbehavior between the global and global+local matching. For the water rate curves (figure 14) there are slightly differences between \n\nthe two adjusted models like, for instance, well PROD2 had its breakthrough corrected and PROD8  presented a better forecast \n\nbehavior after the local matching. \n\nThe improvement in the water rate curves is mainly in the forecast period since the water had not reached the majority of the \n\nwells during the history (1990-1996); this behavior is also observed for the producers not shown here due to the limited space. It is \n\nimportant to highlight that even if a not so relevant improvement is observed in the production curves during the history period, the \n\nlocal matching, that diminish the errors observed in the maps, is still very important especially when new wells need to be planned \n\nsince the necessity of reliable map information becomes more latent.   \n\nFinal comments \n\nThe methodology proposed is a simple way to perform a history matching using quantitatively the information provided by 4D \n\nseismic. A good feature to highlight is that the procedure aims to harness the results of an uncertainty analysis run previously by a \n\nsimple procedure of comparing water saturation errors of the several model realizations available, followed by a \u201ccut and paste\u201d \n\nproperty update. As a result, geological inconsistencies can be avoided. Thus, it is a simple way to incorporate geological \n\nuncertainties without running sophisticated algorithms like the ones proposed by Caers (2003), Caers and Hoffman (2005) and \n\nStephen et al (2005). A pitfall of the methodology is that it does not ensure continuity in the boundaries of the regions and in some \n\ncases the geostatistic properties can be missed. One way to minimize this issue would be to delineate the regions according to \n\n     49\n\n\n\n10  SPE 164883-MS \n\ngeological structures, instead of doing it based only on well location and error map. But, even though, the method will not \n\nguarantee total geostatistic coherence as the one proposed by Caers and Hoffman (2005), for instance, so it can be improved in \n\nfuture work. \n\nAnother feature of the methodology is that although this work considers 4D seismic data in the form of water saturation maps \n\nthe methodology could be applied with another seismic attribute like acoustic impedance, for instance. Clearly, it would require an \n\nextra work which includes the conversion of simulation data to impedance and a previous study to match time lapse differences of \n\nimpedance with water movement. In a way, the second issue is already addressed here when water saturation information is \n\nextracted from 4D seismic through an inversion process. So, the main point to add is the creation of impedances for all the \n\nsimulation models used. \n\nThe synthetic dataset used in this work does not presented too much challenges with respect to the uncertainties of the model, \n\nin a sense that they were all known uncertainties (even porosity and permeability had their geostatisc parameters not very far from \n\nthe true) and just their values needed to be calibrated. However in more complex cases the uncertainties can be more difficult to \n\ndefine. Thus, 4D seismic could be first used in a qualitative way to better map these unknowns, after that a more consistent \n\nuncertainty analysis can be run yielding in better defined model realizations to be used in the local matching proposed in this work, \n\nwhen 4D seismic is quantitatively used. Another drawback of the lack of challenges regarding the uncertainties is that no much \n\nimprovement could be seen in the production curves between the global and local matching applied. Again, in more realistic cases \n\na good well history matching (and forecast) can be not so easy to reach and the local matching can be as important as it is for the \n\nerror map reduction. \n\nIn general, the application of the methodology produced promising results, having as a main point the reduction of the water \n\nsaturation errors by a simple procedure that yields model properties with some geological consistence.  \n\n  \n\nConclusion \nA methodology that uses 4D seismic information to perform a local history matching was proposed. The main point to highlight is \n\nthe simple way to incorporate uncertainties without running sophisticated algorithms. Moreover, after the match, geological \n\nfeatures of the updated reservoir properties can be kept. In the application shown the history matching was done in two steps, \n\nfirstly a calibration of the global properties of initial model was made by using well production curves. After that the local \n\nmatching was performed incorporating 4D seismic information quantitatively. The results obtained with a synthetic dataset showed \n\npromising results with a significant improvement of the map information. There are two improvements that can be done in future \n\nworks, one concerns the water volume calibration between seismic and simulation data and the other would be to investigate \n\npossible ways of guarantee geostatistic consistence in the borders of the regions. \n\n \nNomenclature \nBHP  = Bottom-hole pressure   \n\nQE  = quadratic error computed for grid properties (equation 2) \n\nQEwell = quadratic error computed for well production curves (equation 3) \n\nQw = Water rate \n\n?4D = Time lapse difference operator: property at time 1 minus property at time 0 \n\nSwseis = Water saturation estimated from 4D seismic \n\nSwsim = Water saturation generated through the simulation of a reservoir model \n\nSwbase = Water saturation generated through the simulation of the base model  \n\nSwglobal = Water saturation generated through the simulation of the model after the global matching \n\nSwbase_final= Water saturation generated through the simulation of the model after the global+local matching \n\n \n\n \nAcknowledgments \nThe authors would like to thank UNISIM, PETROBRAS, CEPETRO and Department of Petroleum Engineering for supporting \n\nthis work. \n\n \n\nReferences \nCaers, J., 2003. History matching under training-image based geological model constraints. SPE J. 7, 218-226. \n\nCastro, S. A., Caers, J., Otterlei, C. M., Meisingset, H., Hoye, T., Gomel, P., and Zachariassen, E., 2009. Incorporating 4D \n\nseismic data into reservoir models while honoring production and geologic data: A case study. The Leading Edge. 28 (12), 1498 -\n\n1506. \n\nDavolio, A., Maschio, C. and Schiozer, D., 2012a. Pressure and saturation estimation from P and S impedance: a theoretical \n\nstudy. J. Geophys. Eng. 9, 447-460. \n\n     50\n\n\n\nSPE 164883-MS  11 \n\nDavolio, A., Maschio, C. and Schiozer, D., 2012b. Pressure and saturation estimation from 4D seismic constrained by reservoir \n\nflow simulation. Joint SEG/SPE/AAPG summer research workshop: new advances in integrated reservoir surveillance. La Jolla, \n\nCA, 24-29 June. \n\nHoffman, B. T., and Caers, J. 2005. Regional probability perturbations for history matching. J. Petrol. Sci. Eng. 46, 53 -71. \n\nLanda, J., L. and Kumar, D. 2011. Joint inversion of 4D seismic and production data. SPE146771. SPE Tech. Conf.  Exibition, \n\nDenver, CO, 30 October \u2013 2 November. \n\nSchiozer, D.J., Ligero, E.L., Suslick, S.B., Costa, A.P.A., Santos, J.A.M., 2004. Use of representative models in the integra tion \n\nof risk analysis and production strategy definition. J. Petrol. Sci. Eng. vol. 44 (1\u20132), 131\u2013141 \n\nStephen, K., D., Soldo, J., MacBeth, C. and Christie, M. 2005. Multiple model seismic and production history matching: a case  \n\nstudy. SPE 94173. SPE EUROPEC/EAGE. Ann. Conf. Exhibition, Madrid, Spain, 13-16 June. \n\nTolstukhin, E., Lyngnes, B. and Sudan H., H. 2012. Ekofisk 4D seismic \u2013 seismic history matching workflow. SPE 154347. \n\nSPE EUROPEC/EAGE. Ann. Conf. Exhibition, Copenhagen, Denmark, 4-7 June. \n\n \n\n     51\n\n\n\n     52\n\n\n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n5. PAPER 4: A methodology to calibrate water saturation \n\nestimated from 4D seismic  \n\nAlessandra Davolio, Celio Maschio, Denis Jos\u00e9 Schiozer \n\nTo be submitted to a journal. \n\n \n\n  \n\n     53\n\n\n\n     54\n\n\n\n \n\n \n\nA methodology to calibrate water saturation estimated from \n\n4D seismic  \n\nAlessandra Davolio, C\u00e9lio Maschio and Denis Jos\u00e9 Schiozer \n\nDepartment of Petroleum Engineering, FEM, UNICAMP/CEPETRO, S\u00e3o Paulo, Brazil \n\nE-mail: davolio@dep.fem.unicamp.br, celio@dep.fem.unicamp.br and denis@dep.fem.unicamp.br \n\nAbstract \n\nTime-lapse seismic data can be used to estimate saturation changes within a reservoir. This \n\nis valuable information for reservoir management, as it can play an important role in \n\nreservoir simulation models updating. The process of updating reservoir properties, so-\n\ncalled history matching, can incorporate estimated saturation changes qualitatively or \n\nquantitatively. Especially for quantitative approaches, it is important to have reliable \n\ninformation from 4D seismic. Thus, in this work, a methodology to calibrate the volume of \n\nwater present in the estimated saturation maps is proposed, as saturation maps can be \n\nwrongly estimated due to problems related to seismic signals (such as noise, errors \n\nassociated to data processing and resolution issues). The idea is to condition the 4D seismic \n\ndata to known information provided by engineering, in this case the known amount of \n\ninjected water in the field. The application of the proposed methodology in an inversion \n\nprocess (previously published) that estimates saturation from 4D is presented, followed by a \n\ndiscussion concerning the use of such data in a history matching process. To validate the \n\nresults, the methodology is applied to a synthetic dataset. The main results are: (1) a better \n\nestimation of saturation, namely reduction of noise and errors effects, yielding more reliable \n\ndata to be used quantitatively or qualitatively and (2) an improvement in the properties \n\nupdate after using this data in a history matching procedure. \n\nKeywords: time-lapse seismic, saturation estimation, volume calibration, history matching \n\n \n\nNomenclature \n\nIP  P-impedance \n\nIS  S-impedance \n\nSw  water saturation \n\nSwc  connate water saturation \n\nSor    residual oil saturation \n\nPre  pore pressure \n\nPreProdMin  minimum pressure (producer wells) \n\nPreInjMax  maximum pressure (injector wells) \n\n?4D  time-lapse difference operator \n\nVinj  volume of injected water (standard conditions) \n\nVprod  volume of produced water (standard conditions) \n\nVcurrent current volume of water present in the reservoir (standard conditions) \n\n     55\n\nmailto:davolio@dep.fem.unicamp.br\nmailto:celio@dep.fem.unicamp.br\nmailto:denis@dep.fem.unicamp.br\n\n\n \n\n \n\n \n\n?  porosity \n\nVb   volume of a grid block \n\nnb  number of grid blocks \n\nCF  volume correction factor \n\nBw  water formation volume factor \n\n \n\nSubscript \n\nseis  parameter derived from 4D seismic \n\nsim  parameter computed from reservoir simulation results \n\nbase  parameter computed from the simulation results of the base model \n\nseis_cali  parameter derived from 4D seismic with the volume calibrated \n\nt0  parameter corresponding to the base survey \n\n \n\n \n\n1. Introduction \n\nTime-lapse seismic is becoming an important tool for reservoir monitoring as it provides a \n\nbetter understanding of the dynamic properties variations due to production within the reservoir. \n\nThis is valuable information because it can be used to update reservoir models, which are an \n\nimportant tool for reservoir management (optimization strategy, planning infill drillings among \n\nothers). There are several works in the literature showing successful use of 4D seismic (Johann et \n\nal, 2009, Tolstukhin et al, 2012, Castro et al, 2009).  \n\nThe integration between 4D seismic and reservoir simulation is still a topic of intense \n\nresearch. There are several approaches that can be used, from qualitative interpretation of 4D \n\nseismic anomalies (Johann et al, 2009) that are further incorporated into reservoir simulation \n\nmodels, to quantitative use of 4D seismic data in an objective function of a history matching \n\nprocedure (Brito et al, 2010, Landa and Kumar, 2011). Another branch of possibilities is the domain \n\nof integration of the two data, which can be generalized into three options: amplitude, impedance, \n\nsaturation and pressure domains.  \n\nTo perform the integration in the saturation and pressure domain, which is the focus of this \n\nwork, it is necessary to estimate these properties from seismic amplitudes or impedances. Different \n\nmethodologies can be applied to estimate saturation and pressure from 4D seismic attributes \n\n(Landro 2001, Lumley et al 2003, MacBeth et al 2006, Davolio et al 2012). Their differences \n\nconcern the type of seismic attribute used to estimate the dynamic changes and how the data is \n\nmanipulated to obtain these estimations.  \n\nAlthough these methodologies could be applied to any field that holds enough seismic data \n\n(usually pre-stack data is needed for base and monitor surveys), there are still some challenges to \n\novercome concerning seismic signal related problems (such as noise, tuning and uncertainties in \n\nrock properties).  \n\nThus, in order to be able to extract more reliable information from time-lapse seismic \n\nsignals, another source of information can be used, for instance, engineering data (well production \n\nprofiles, reservoir simulation data). Engineering data, such as reservoir simulation results, are \n\nnormally used in forward modeling for feasibility studies, or to help in the understanding of \n\nobserved 4D seismic anomalies. However, there are few works that effectively use this type of \n\n     56\n\n\n\n \n\n \n\ninformation to constrain the estimation of dynamic properties from 4D seismic. The work of Huang \n\net al (2011) is an example of such application; in this work the authors demonstrated that well \n\nproduction data (predominantly used for history matching) can be used to constrain the observed 4D \n\nseismic data and as a result, more robust information is extracted from seismic signals. Toinet et al \n\n(2011) can be cited as another example; in this case, the authors presented a workflow to perform a \n\n4D pre-stack inversion that is constrained by a range of elastic properties variations computed from \n\nreservoir simulation results. In addition, reservoir model information was also included as a \n\nconstraint to better locate water-bearing sands. Davolio et al (2013a) also presented a methodology \n\nthat uses reservoir simulation results to constrain dynamic estimation from 4D seismic. But, \n\ndifferent from Toinet et al (2011), in the work of Davolio et al (2013a), the constraints are used in a \n\npetro-elastic inversion that estimates saturation and pressure from seismic impedances.  \n\nThe current work inclines toward the idea of using engineering information to constrain the \n\nestimation of dynamic properties from 4D seismic. More specifically, this work proposes a \n\nmethodology to correct the volume of water present in estimated saturation maps from 4D seismic, \n\nbased on the known volume of injected water in the field. This type of calibration is important, \n\nespecially when employing a quantitative use of the estimated properties in a history matching \n\nprocedure, since poor estimates used as input can lead to incorrect model updating. The volume \n\ncalibration proposed here can be applied to saturation maps estimated from 4D seismic through one \n\nof the techniques mentioned previously. In this work, the saturation maps are estimated by the 4D \n\npetro-elastic inversion constrained to flow conditions proposed by Davolio et al (2013a). After \n\nanalyzing the results of the calibration, a discussion about the importance of this type of information \n\nas input to a history matching procedure is also presented. To validate and demonstrate the benefits \n\nof the proposed methodology, the results are shown with synthetic data.  \n\n \n\n2. Methodology \n\nThe methodology presented here aims to calibrate the volume of injected water present in the \n\nwater saturation (Sw) maps provided by 4D seismic with the known volume of injected water. The \n\ncalibration is performed by applying a multiplicative correction factor in the Sw map provided by \n\n4D seismic. The calibrated Sw values should belong to a feasible range, which is defined by the \n\nmethodology proposed by Davolio et al (2013a). So, prior to running the volume calibration, it is \n\nnecessary to estimate this range. \n\nAs displayed in figure 1, the methodology used to compute the feasible range starts by \n\ncombining all the \u201cn\u201d uncertainties, or the most important \u201cn\u201d uncertainties of the reservoir model. \n\nThus, \u201cm\u201d model realizations are created and simulated. Then, for each reservoir block, the range \n\nof possible values is defined by extracting the minimum and maximum Sw value along all the \u201cm\u201d \n\npossibilities. Therefore, the range [Swmin Swmax] is defined according to the flow conditions and is \n\nconsistent with the current characterization stage. This range is defined to the production time \n\ncorresponding to the monitor seismic survey. Note that, according to figure 1, the same procedure \n\nwas applied for pressure. However, the current work only uses the limits for Sw. \n\nAfter estimating the range [Swmin Swmax] for every grid block of the model, the volume \n\ncalibration can be performed. Bellow, a detailed workflow of the volume calibration procedure is \n\nproposed: \n\n1. Compute the amount of injected water (in reservoir conditions) present in 4D seismic data \n\naccording to equation 1: \n\n     57\n\n\n\n \n\n \n\n?\n?\n\n??\nnb\n\ni\n\niseisDiiseis\nSwVbVinj\n\n1\n\n4\n)(? ,    (1) \n\nwhere nb is the number of blocks of the model, ? is the porosity, Vb is the block volume, \n\n?4DSwseis is the time-lapse difference of water saturation estimated from 4D seismic.  \n\n2. Compute the correction factor (CF) according to equation 2: \n\nVcurrentVinjCF seis /? ,       (2) \n\nbeing that Vcurrent is the current volume of water: \n\nwBVprodVinjVcurrent )( ?? ,       (3) \n\nwhere Vinj  is the known volume of injected water, Vprod is the known volume of produced \n\nwater and Bw is the water formation volume factor. \n\n3. Set i=1; \n\n4. While i<=nb calculates the calibrated water saturation value for the i\nth\n block by applying \n\nthe correction factor: \n\nCFSwSw\niseisDicaliseisD\n/)()(\n\n4_4\n??? .   (4) \n\n5. Compute the calibrated Sw for the monitor survey: \n\niticaliseisDicaliseis\nSwSwSw )()()(\n\n0_4_\n??? ;   (5) \n\nwhere \n0t\n\nSw is the water saturation value at the initial time (base survey). \n\n6. Verify if the calibrated Sw belongs to the feasible range: \n\niicaliseisi\nSwSwSw )()()(\n\nmax_min\n?? .   (6) \n\n7. If inequality 6 holds, then the value of the current reservoir block (ith block) is set by \n\nequation 5, set i=i+1 and return to step 4; else go to step 8. \n\n8. If \nicaliseisi\n\nSwSw )()(\n_min\n\n?\n \nthen\n\niicaliseis\nSwSw )()(\n\nmin_\n? , set i=i+1 and return to step 4, \n\nelse go to step 9. \n\n9. If \nicaliseisi\n\nSwSw )()(\n_max\n\n? then\niicaliseis\n\nSwSw )()(\nmax_\n\n? , set i=i+1 and return to step 4. \n\nThe steps 2 to 9 can be repeated until a satisfactory volume calibration is reached, namely until \n\nCF-1 &lt;tolerance. Another point to highlight is that the steps 1 to 9 can be applied to the whole \n\nreservoir or to different reservoir zones, independently. \n\nThere are some assumptions to be considered when applying the methodology proposed above: \n\n? 4D seismic data are at the same scale of the reservoir simulation model. Therefore, for real \n\ndata, an upscaling/downscaling procedure is required to convert data from seismic scale to \n\nflow simulation scale. \n\n? 4D base survey was acquired in the pre-production period, so that the time-lapse difference \n\nof saturation provides information about the volume of injected water. \n\n? No presence of an aquifer. \n\n \n\n3. Application \n\nTo evaluate the results of the proposed methodology, all data used in this work are synthetic, as \n\ndescribed in the following sections.  \n\nThe application of the proposed volume calibration procedure is divided into two parts. The \n\nfirst part presents a discussion of the volume calibration on the estimated Sw map from 4D seismic. \n\n     58\n\n\n\n \n\n \n\nThen, the second part shows the importance of using a calibrated Sw map in a history matching \n\nprocedure.  \n\n \n\n \nFigure 1: General procedure used to define limits (minimum and maximum) of pressure and \n\nsaturation for each reservoir block. \u201eAttribute 1?, \u201eAttribute 2? and \u201eAttribute n? are generic \n\nrepresentations of the reservoir uncertainty and \u201eModel 1?, \u201eModel 2? and \u201eModel m? are generic \n\nreservoir models, generated from the combination of the reservoir uncertainties (extracted from \n\nDavolio et al, 2013a). \n\n \n\n3.1. Synthetic dataset construction \n\nThis section presents a brief description of the synthetic dataset used in this work, which is the \n\nsame as that used in Davolio et al (2013a, b); see these references for more details. Some \n\nsimplifications of these dataset are: \n\n? All data (seismic and reservoir simulation) are at the same scale, which corresponds to \n\na grid with 90x110x5 blocks. Thus, all simulation models used in this work have this \n\ngrid. \n\n? Initial Sw is considered known (with good estimation of water-oil contact and capillary \n\npressure). \n\n? The seismic data considered here are composed of P and S impedances for two surveys \n\n(base and monitor). These impedances were generated by a forward modeling through a \n\npetro-elastic model that uses reservoir simulation results and static properties, such as \n\nporosity, from the reference simulation model (described below). \n\n \n\n3.1.1. Reference simulation model and seismic data \n\nThis model represents the true earth model. The static and dynamic model properties \n\nrepresent the answer that the methodologies should reach. Thus, for instance, the closer the \n\nestimated Sw map (from 4D seismic) is to the simulation results of the reference model, the better it \n\nis. In the same way, when history matching is applied, it is desired that the updated static properties \n\nget closer to those of the reference model. Besides validating the results, the reference model is also \n\nused to generate the seismic. The seismic dataset is composed of four volumes of impedances, P \n\n     59\n\n\n\n \n\n \n\nand S impedances for two production times (pre-production and 6 years of production). A random \n\nnoise was added to the impedances, which can be observed in figure 4. The impedances were \n\ngenerated through a petro-elastic model considering the unconsolidated sand model (Mavko et al, \n\n2003) that is described in Davolio et al (2013a). Note that the seismic data considered here are not \n\noriginated from a pre-stack inversion, as no amplitudes were generated.  \n\n \n\n3.1.2. Reservoir uncertainties  \n\nReservoir static properties can be divided into two categories: global and local. The former \n\nhave a global influence on the reservoir, meaning that changes in these properties affect the flow \n\nbehavior of the whole reservoir (or of a large area of it). The latter have a local effect, i.e., regional \n\nchanges affect regional flow (around a well, for instance). \n\nThe global uncertainties of the dataset used here are fault transmissibility, relative \n\npermeability (represented by the Corey exponent) and permeability ratio (vertical/horizontal). The \n\nlocal uncertainties are porosity and horizontal permeability. \n\nThe focus of this work is the use of a Sw map to update the reservoir model?s properties. \n\nHere we propose to use this type of information to update static properties locally, following the \n\nhistory matching methodology presented by Davolio et al (2013b). Before running a local matching, \n\nthe global uncertainties need to be calibrated. Thus, this work assumes that this calibration has \n\nalready been performed, as described by Davolio et al (2013b); table 1 shows the true values  and \n\nthe results obtained. Therefore, only local properties (porosity and horizontal permeability) are \n\nbeing assumed as uncertainties in this work. Using the Sequential Gaussian Simulation technique \n\n(SGS), 200 realizations of porosity were generated, having the seismic P-impedance volume (base \n\nsurvey) as a secondary variable. Each of these porosity fields was later used as a second variable for \n\nthe SGS to generate 200 realizations of permeability (figure 2). Each pair of porosity and \n\npermeability images was used to generate 200 simulation models. Although the characterization \n\nprocess was not perfect, as it can be seen in table 1 and by comparing figure 2 with figure 5c, the \n\nmapping of the uncertainties yielded a satisfactory dispersion in the well production curves. On the \n\ntop of figure 3, the field average pressure and water rate are displayed for all the 200 models and the \n\nhistory; on the bottom of the same figure the bottom hole pressure (BHP) curves are displayed for \n\ntwo wells.  \n\nOne important aspect to consider when using several simulation models to constrain 4D \n\nseismic information is to ensure that production curves dispersion comprise the history data like the \n\nones shown in figure 3. If a poor uncertainty characterization is performed, generating models that \n\ndo not comprise the history data (e.g. all models bellow the history curve), the constraints applied to \n\nthe 4D seismic lead to biased estimations. In the case studied, the proper uncertainties mapping \n\nperformed was important to improve the estimation of saturation and pressure, as discussed in the \n\nfollowing sections. \n\n \n\nTable 1: Global parameters before and after the matching applied. \n\n Fault 1 Fault 2 Fault 3 Fault 4 Kz/Kx \nCorey exp. \n\nFacies \n\nReference 0.4 0.001 0.03 0.8 0.100 4.6 3.1 1.3 \n\nAfter updating 1 0.001 1 1 0.096 4.4 3 1.0 \n\n \n\n     60\n\n\n\n \n\n \n\n \nFigure 2: Examples of three realizations of permeability. \n\n \nFigure 3: Top: field average pressure and field water rate. Bottom: examples of bottom hole \n\npressure curves for two wells INJ7 (left) and PROD5 (right). \n\n \n\n3.1.3.  Base simulation model  \n\nThis model represents the knowledge available regarding the reservoir and needs to be \n\nhistory-matched. The base model was built by a random combination of the uncertainties described \n\nabove, differencing it from the reference model. The global uncertainties of these models are \n\nalready calibrated with well production data (Davolio et al, 2013b) as displayed in table 1. Figure 5 \n\nshows the porosity and permeability images for the reference and base model; these properties are \n\ncalibrated with 4D seismic data, as described in the results. \n\n \n\n3.2. Estimating Sw from 4D seismic \n\nThe water saturation map used in this work was estimated by a 4D petro-elastic inversion \n\nprocedure described in Davolio et al (2013a). The inversion is carried out by an optimization \n\nprocess and is performed for each simulation block, independently. As discussed in Davolio et al \n\n(2012), this is an optimization problem with only two unknowns (pressure and saturation for each \n\n     61\n\n\n\n \n\n \n\nblock) with a well-behaved objective function. So, a gradient-type algorithm is used to search for \n\nthe solution within the defined solution space.   \n\n The input data for the inversion are the time-lapse differences of the noisy synthetic P and S \n\nimpedances (figures 4c, d). Another important input of the petro-elastic inversion is the porosity \n\nfield which, in this work, was extracted from the base model (figure 5b). Thus, there are three \n\nimportant sources of errors in the estimation of Sw: the wrong estimative of porosity and \n\noverburden pressure and the presence of noise in seismic impedances. The same petro-elastic \n\nmodeling used to generate the synthetic impedances was used in the inversion process, so no errors \n\nare being assumed in this modeling. \n\n \n\n \nFigure 4: Time-lapse difference of the synthetic seismic attributes without adding noise: (a) P-\n\nimpedance. (b) S-impedance. Time-lapse difference of the synthetic seismic attributes after noise \n\naddition: (c) P-impedance. (d) S-impedance. Layer 3. \n\n \n\nFigure 5: Porosity: reference model (a) and base model (b). Horizontal permeability (mD): \n\nreference model (c) and base model (d). Layer 3. \n\nThree inversions were performed (case 1, 2 and 3) in order to highlight different steps of the \n\ncalibration of 4D seismic information with reservoir simulation results. The calibrations performed \n\nare related to the delimitation of the solution space of the petro-elastic inversion process. Thus, the \n\ndifferences among the three cases are: \n\nCase 1: the inversion procedure is performed with \u201cgeneral constraints\u201d, meaning that the \n\nsolution space is defined by the limits: Swc<Sw<1-Sor and PreProdMin&lt;Pre<PreInjMax.  \n\nCase 2: the solution space is defined by the minimum and maximum values [Swmin Swmax] and \n\n[Premin Premax] estimated by the methodology proposed in Davolio et al (2013a) that is schematically \n\npresented in figure 1. By applying this methodology, the estimated dynamic properties are \n\nconditioned to the flow conditions according to the reservoir uncertainties characterization stage.  \n\n     62\n\n\n\n \n\n \n\nCase 3: in this case, the calibration of the volume of water proposed in this work is applied. \n\nNote that the methodology proposed in this work is using the constraints applied in case 2 ([Swmin \n\nSwmax]). Indeed, this work can be seen as an improvement of the methodology proposed in Davolio \n\net al (2013a). \n\n \n\n3.3. History matching \n\nThe importance of having calibrated water saturation maps estimated from 4D seismic is the \n\nincorporation of such data in a history matching procedure, especially in a quantitative way.  The \n\nhistory matching procedure applied in this work was proposed by Davolio et al (2013b). The \n\nmethodology uses 4D seismic information to perform a local matching. The water saturation map \n\nestimated from 4D seismic is used as an input to update local properties, such as porosity and \n\npermeability, within regions defined around the injector wells. Several model realizations constitute \n\nother input data, which, in this work, are the same \u201cm\u201d models mentioned before (figure 1). \n\nThe local matching starts by dividing the reservoir into regions according to the location of the \n\ninjector wells and their observed corresponding water saturation error anomaly (figure 6). Then, a \n\nsimple process of comparing the errors between 4D seismic data and the reservoir model \n\nrealizations is performed within each region. The models that present the smallest error for each \n\nregion are selected and a new simulation model is built by a procedure of \u201ccopy and paste\u201d of the \n\nstatic properties (porosity and permeability) extracted from the selected models at each region, a \n\nprocess similar to building a patchwork. \n\n \n\n \n\nFigure 6: Workflow of the local history matching methodology. \n\nIt is important to highlight that before performing this local history matching, the global \n\nuncertainties of the reservoir need to be calibrated. As mentioned before, the dataset considered \n\nhere has its global parameters already matched. The results can be seen in Davolio et al (2013b), \n\n     63\n\n\n\n \n\n \n\nwhere a methodology that uses well production data was proposed and applied. A satisfactory \n\nmatch for the global uncertainties was reached, although the process was not able to recover the \n\nreference model values perfectly. Even so, the global uncertainties were set with the updated values \n\nand only local uncertainties needs to be matched. Therefore, the \u201cm\u201d model realizations are only \n\naccounting for the local properties (porosity and permeability), yielding a total of 200 models \n\n(m=200). \n\nThis local history matching procedure was applied to three cases, the only difference among \n\nthem being the input Sw map: \n\nLHM1 = local history matching using as input the estimated Sw map from case 1;  \n\nLHM2 = local history matching using as input the estimated Sw map from case 2; \n\nLHM3 = local history matching using as input the estimated Sw map from case 3.  \n\nFor cases 2 and 3, the limits [Swmin Swmax] were extracted from the 200 simulation results. \n\n \n\n4. Results \n\nThe volume calibration methodology was applied to the whole reservoir, meaning that all the \n\ncorrection factor calculations considered the volume of water present in the whole reservoir.  \n\n \n\n4.1. Estimating Sw from 4D seismic \n\nAs mentioned in section 2, steps 2 to 9 of the volume calibration proposed can be repeated until \n\na satisfactory calibration is reached. In this work, 15 iterations were enough to reach a good \n\ncalibration. Figure 7 shows the performance of the volume calibration. The iterations correspond to \n\nthe execution of steps 2 to 9. The first correction factor computed was: CF = \n\n(4.24x10\n7\n)m\n\n3\n/(3.03x10\n\n7\n)m\n\n3\n ? 1.4. Thus, after the first iteration, the calibrated volume was \n\n?3.32x10\n7\n m\n\n3\n. This new volume yielded a CF?1.09. After applying this second CF, the new volume \n\nwas ?3.18x10\n7\n m\n\n3\n and so on until the 15\n\nth\n iteration that yielded CF-1=10\n\n-4\n. Therefore, after 15 \n\niterations, a satisfactory volume calibration was reached for this case.  \n\n \nFigure 7:  15 iterations of the proposed volume calibration procedure (steps 2 to 9 in section 2). \n\nLeft: the correction factor computed per iteration. Right: the calibrated volume of water per \n\niteration.  \n\n     64\n\n\n\n \n\n \n\n \n\nFigure 8 shows the estimated water saturation map for the three inversions performed and the \n\nwater saturation map yielded from the simulation of the reference model, which represents the \n\nanswer that the inversions aim to reach. The same figure also shows the respective error map of the \n\nthree inversion results. Due to the noise added to seismic impedances and the wrong porosity used \n\nas inputs for the petro-elastic inversion, the results of case 1 presented a noisier aspect that is clearly \n\nseen in the error map. Note that there is a zone with high errors, indicated by a red arrow; the white \n\nregion in the error map means that the error is out of scale (bigger than 0.2). The main causes of this \n\nerror are the low porosity region that was wrongly characterized (compare figures 5a and 5b) \n\ntogether with wrong pressure values; remember that the petro-elastic inversion estimates saturation \n\nand pressure, simultaneously. Figure 9 follows the same layout of figure 8 but showing the \n\nestimations of pressure for cases 1 and 2; the same noisy behavior of case 1 previously mentioned is \n\nobserved for pressure as well. In the same way, the region with the highest errors marked in the Sw \n\nmap presents a high error for pressure too.  \n\n \nFigure 8: Water saturation maps for the second production time (monitor survey). Top: from left to \n\nright, the reference model (answer), the estimated Sw map for cases 1 to 3. Bottom: from left to \n\nright, the error (reference \u2013 estimated) for the three estimations. Layer 3. \n\nWhen the estimation of Sw is constrained to flow conditions by imposing the computed limits \n\nof case 2, an error reduction is clearly observed in figure 8. Note that the application of these \n\nconstraints cleaned some areas that were being wrongly estimated due to the seismic noise. Also, \n\nthe region with high errors observed in case 1 now presents a better response. This happened \n\nbecause the constraints applied to the solution space \u201cforced\u201d the dynamic properties estimations \n\n(saturation and pressure) to values more physically consistent, diminishing the effects of wrong \n\nstatic properties characterization. This improvement in the estimation of Sw can also be seen as a \n\nconsequence of the relevant error reduction observed in the estimation of pressure for case 2 (figure \n\n     65\n\n\n\n \n\n \n\n9). The good estimation of pressure was ensured by the proper uncertainties mapping performed, \n\nthat was verified with the pressure curves presented in figure 3. \n\n \n\n \n\nFigure 9: Pore pressure maps for the second production time (monitor survey). Top: from left to \n\nright, the reference model (answer), the estimations of cases 1 and 2. Bottom: from left to right, the \n\nerror (reference \u2013 estimated) for the two estimations. Layer 3. \n\nAlthough the result of case 2 presented a water saturation map closer to the reference, it can be \n\nobserved that the error anomalies are predominantly negative. This means that the estimated water \n\nsaturation presents more water than the reference model, showing the necessity of calibrating the \n\nvolume of water. As in practice, these errors are not available information, this could be checked by \n\na simple computation of the volume of water (equation 1) and comparison with the known volume \n\nof injected water.  \n\nAfter applying the volume calibration proposed in this work (case 3), it can be observed that the \n\ninjection anomalies are better defined. Also, the observed error is indicating that the mass balance is \n\nbeing respected, as it presents positive and negative anomalies, meaning that the error is now more \n\nrelated to an incorrect water front displacement and not with the amount of water. \n\nFigure 10 shows the histogram of the errors observed in figure 8. Aside from the gradual error \n\nreduction observed from case 1 to cases 2 and 3, another interesting aspect to highlight is the error \n\ndistribution of the third case. In case 3, the errors are centralized at zero, with some positive and \n\nnegative values, indicating again that the amount of water present in the estimated map is better \n\nbalanced than in the other two cases. \n\n     66\n\n\n\n \n\n \n\n \nFigure 10: Histogram of the error (reference \u2013 estimated) in the estimations of water saturation. \n\n4.2. History matching \n\nThe first step in performing the local history matching is to define regions based on the Sw \n\nerror observed and the location of injector wells. The definition of the regions in this work is \n\nillustrated in figure 11. The injector wells that presented the highest errors (for all layers) were \n\nselected to perform the local match: INJ1, INJ3, INJ4 and INJ5. See Davolio et al (2013b) for more \n\ndetails about the regions? definition.  \n\nThe estimated Sw of case 2 (figure 8) was used to compute the error map shown in figure 11, \n\nwhich is exactly the same input used to define the regions in Davolio et al (2013b). As previously \n\nmentioned, the local matching procedure described in section 3.3 was performed for three cases \n\n(LHM1, LHM2 and LHM3), the difference among them being the Sw map used as input. Although \n\nthe region definition is dependent on the input data, in this work, the same regions shown below \n\nwere used for the three history matchings performed with the goal of comparing the results. \n\n \n\nFigure 11: Water saturation error map (\nseisDbaseD\n\nSwSw\n44\n\n??? ) with the regions defined to \n\nperform the local matching. \n\nFigure 12a shows the Sw error map (compared to the true answer) of the base model before the \n\nlocal matching. Figures 12b, 12c and 12d show the error maps for the three updated models. The \n\nfirst thing to note is that the updated models LHM1 and LHM2 present more water than they \n\nshould; observe the predominance of negative anomalies. These results are explained by the fact \n\nthat the matching procedure is updating the static properties in order to match the Sw maps of case \n\n     67\n\n\n\n \n\n \n\n1 and 2, displayed in figure 8. Figure 13 shows the saturation error (compared to the Sw map \n\nestimated from 4D seismic) for each case, i.e., the differences in the base model before and after \n\napplying each of the three history matchings. Thus, figure 13 is showing that the local matching \n\nprocedure is working for LHM1 and LHM2, i.e., the updated models are providing Sw maps that \n\nbetter follow the behavior observed in 4D seismic data. However, these results are not satisfactory, \n\nsince the matching process is increasing the saturation errors when compared to the true answer as \n\ndisplayed in figures 12b and 12c.  \n\n \n\n \nFigure 12: Water saturation error map (reference - simulated) of the base model before (a) and after \n\nthe local matching LHM1 (b), LHM2 (c) and LHM3 (d). Layer 3. \n\n \n\nFigure 13: Observed water saturation error map (estimated from 4D seismic \u2013 simulated). Top: \n\ndifference between the estimated saturation for case 1(a), case 2 (b) and case 3(c) and the saturation \n\nof the base model before the matching. Bottom: difference between the estimated saturation for case \n\n1(d), case 2 (e) and case 3(f) and the saturation of the base model after the respective history \n\nmatching (LHM1, LHM2 and LHM3). \n\nThe quantitative use of estimated Sw from 4D seismic was successful in the third history \n\nmatching (LHM3). Figure 12d shows a decrease in the Sw error when compared to LHM1 and \n\nLHM2. Some errors are still observed for this case for two reasons: (1) although better calibrated, \n\nthe Sw map of case 3 still carries some errors and (2) the characterization process is not assumed to \n\n     68\n\n\n\n \n\n \n\nbe perfect, i.e., the image realizations of porosity and permeability are not able to reproduce the \n\nreference properties. The graph bar displayed in figure 14 corresponds to the sum of the Sw errors \n\nat every reservoir location. This graph shows that LHM3 presents a much better balance of errors \n\n(positive and negative values). \n\nOne can say that the base model (figure 12a) presents the same amount of errors as LHM3 \n\n(figure 12d). Indeed, there is a slight error reduction in the Sw map after the local matching LHM3. \n\nThis could be improved, for instance, by re-defining the regions according to the observed error \n\nanomalies specific for this case. But, it is important to highlight that the focus of this work is not to \n\nguarantee the best history matching result but to analyze the importance of having better input \n\ninformation when performing such a process. In this sense, the results of figures 12 and 14 \n\ndemonstrated that the use of the calibrated water saturation map (LHM3) is the safest option. \n\nLooking at the updated properties, especially for the porosity field, the model updated after the \n\nmatching process LHM3 (figure 15) showed an improvement in the base model and better results \n\nthan the other matches. The regions marked in figure 15d are examples of a good agreement with \n\nthe reference porosity field displayed in figure 5a. Concerning the permeability field update, a less \n\npronounced improvement is observed (figure 16). From figure 16, it can also be seen that the \n\ncharacterization process of permeability needs to be improved, since the image realizations do not \n\npresent the expected features seen in figure 5c. Even so, a better definition of a high permeability \n\nzone can be observed, as highlighted in figure 16d. \n\n \nFigure 14: Bar graph indicating the sum of the errors of the water saturation error map (reference - \n\nsimulated) for the three history matchings applied. \n\n \n\nFigure 15: Porosity field of the base model before (a) and after the local matching LHM1 (b), \n\nLHM2 (c) and LHM3 (d). Layer 3. \n\n     69\n\n\n\n \n\n \n\nFigure 16: Horizontal permeability field of the base model before (a) and after the local matching \n\nLHM1 (b), LHM2 (c) and LHM3 (d). Layer 3. \n\n5 Final remarks \n\nThe results presented here showed that it is possible to use reservoir simulation data to better \n\nextract dynamic changes from 4D seismic data. The addition of engineering information helps to \n\ndiminish the effects of poor static properties characterization and problems related to seismic \n\nsignals. Concerning the history matching process, the results demonstrated that the calibrated \n\nestimation of water saturation maps is important to update reservoir models, namely LHM3, which \n\nprovided the best result when compared to the other two history matchings performed. One point \n\nworthy of comment is that, for this dataset, the comparison of the Sw errors in the model before and \n\nafter the history matching (LHM3) did not show very relevant differences. As already mentioned, \n\nthis result could be improved by re-defining the regions, for instance. But, again, the result to be \n\nhighlighted in this work is the comparison among the three history matchings performed, as the \n\nfocus was not to achieve the best history matching possible. \n\nThe methodology proposed to calibrate the volume of water was applied to a synthetic dataset. \n\nIn this dataset, the Sw map provided by 4D seismic presented more water than it should for the \n\nentire reservoir. But, it is important to emphasize that the volume calibration and the history \n\nmatchings were built to be performed locally. Thus, for more complex cases, it can happen that \n\nsome regions of the reservoir present a volume bigger or smaller than expected. Then, the \n\ncorrection factor that was computed here and applied to the entire reservoir, in such cases, can be \n\ncomputed/applied individually for each region of interest. In this case, there would be an additional \n\nstep, which is to identify the water anomalies associated to each injector well in order to compute \n\nindividual volumes related to each injector.  \n\n \n\n6 Conclusions \n\nA methodology to calibrate the volume of water present in water saturation maps provided \n\nby 4D seismic was proposed. The volume calibration is performed based on reservoir flow \n\nconditions imposed by the simulation of several models. As these models account for the \n\nuncertainties mapped, the calibrated water saturation map is consistent with flow conditions \n\nresulting from the current stage of characterization. \n\nThe advantages of applying the proposed methodology were shown in two forms: (1) by \n\ncomparing the water saturation maps resulted from a petro-elastic inversion process, with and \n\nwithout the volume calibration, and (2) by comparing the results of a history matching that uses the \n\nestimated water saturation maps to update static properties locally. Synthetic data was used in both \n\ncases and it was important to validate the methodology. \n\n     70\n\n\n\n \n\n \n\nAs for the main results, it can be highlighted that: (1) the calibrated water saturation map \n\nprovided more reliable information to be used for interpretation purposes (qualitatively or \n\nquantitatively), since it is more physically consistent (respecting the mass balance); (2) the \n\nquantitative use of a calibrated water saturation map in a history matching is very important to \n\nensure a proper static properties updating.  \n\n \n\nAcknowledgments \n\nThe authors would like to thank UNISIM, BG, PETROBRAS, CEPETRO and the Department of \n\nPetroleum Engineering for supporting this work. We also thank CMG and Schlumberger for \n\nsoftware licenses. \n\n \n\nReferences \n\nCastro S A, Caers J, Otterlei C M, Meisingset H, Hoye T, Gomel P and Zachariassen E 2009 \n\nIncorporating 4D seismic data into reservoir models while honoring production and geologic \n\ndata: a case study The Leading Edge 28 (12) 1498-1506. \n\nBrito D, Moraes R and Emerick A, 2010 The Marlim field: incorporating time-lapse seismic in the \n\nassisted history matching, SPE137763 SPE Latin American &amp; Caribbean Petroleum \n\nEngineering Conf.(Lima, Peru, 1-3 December). \n\nDavolio A, Maschio C and Schiozer D 2012 Pressure and saturation estimation from P and S \n\nimpedance: a theoretical study Journal of Geophysics and Engineering 9 447-460. \n\nDavolio A, Maschio C and Schiozer D 2013a A methodology to constrain pressure and saturation \n\nestimation from4D seismic using multiple simulation models and observed data Journal of \n\nPetroleum Science and Engineering 105 51-61. \n\nDavolio A, Maschio C and Schiozer D 2013b  Local history matching using 4D seismic data and \n\nmultiple models combination, SPE164883 SPE EUROPEC/EAGE Ann. Conf. Exhibition \n\n(London, United Kingdom, 10-13 June). \n\nHuang Y, MacBeth C, Barvked O, Gestel J P V and Dybvik O P 2011 Enhanced dynamic \n\ninterpretation from correlating well activity to frequently acquired 4D seismic signatures The \n\nLeading Edge 30 (9) 1042-1050. \n\nJohann P,  Sansonowski R, Oliveira R and Bampi D 2009 4D seismic in a heavy-oil turbidite \n\nreservoir offshore Brazil The Leading Edge 28 (6) 718-729. \n\nLanda J L and Kumar D 2011 Joint inversion of 4D seismic and production data SPE Tech. Conf.  \n\nExibition (Denver, Colorado, 30 October \u2013 2 November). \n\nLandro M 2001 Discrimination between pressure and fluid saturation changes from time-lapse \n\nseismic data Geophysics66836-844. \n\n     71\n\n\n\n \n\n \n\nLumley D, Adams D, Meadows M, Cole S and Ergas R 2003 4D seismic pressure-saturation \n\ninversion at Gullfaks field, Norway First Break 21 (9) 49-58. \n\nMacBeth C,Floricich M and Soldo J 2006 Going quantitative with 4D seismic analysis Geophysical \n\nProspecting54 303-317. \n\nMavko G, Mukerji T and Dvorkin J 2003 The Rock Physics Handbook: Tools for seismic analysis \n\nin porous media (Cambridge: Cambridge University Press). \n\nTolstukhin E, Lyngnes B and Sudan H H 2012 Ekofisk 4D seismic \u2013 seismic history macthing \n\nworkflow SPE154347 EUROPEC/EAGE Ann. Conf. Exhibition (Copenhagen, Denmark, 4-7 \n\nJune). \n \n\nToinet S, Maultzsch S, Souvannavong V and Volnard O 2011 4D pre-stack inversion workflow \n\nintegrating reservoir model control and lithology supervised classification Fisrt Break 29 (8) 59-\n\n66. \n\n     72\n\n\n\n \n\n \n\n  \n\n \n\n6. CONCLUSIONS \n\nThe current work proposed four methodologies: (1) an inversion scheme to estimate \n\npressure and saturation from 4D seismic, (2) a procedure that uses simulation data to better \n\nextract variations of dynamic properties from 4D seismic data, (3) a history matching process that \n\nuses water saturation maps, generated in the previous papers, in a local matching procedure and \n\n(4) a procedure to calibrate the volume of injected water associated to the saturation map \n\nestimated from 4D seismic. In addition to the methodologies, which can be seen as the main \n\nresults of this work, especially the second and the fourth, there are some important results \n\nspecific to each of the four of them, which should be highlighted. \n\nFrom the inversion process (paper 1), it could be concluded that: \n\n? The use of only one seismic attribute (P impedance, for instance) is not enough to \n\nestimate pressure and saturation variations, since it yields a multiple answer problem. \n\nA second attribute with a different response to the changes in dynamic properties \n\nshould be considered, such as S impedance. \n\n? If an ideal dataset is considered (without any errors/noise and known static properties), \n\na 3D seismic survey would be enough to estimate dynamic properties. However, for \n\nmore realistic cases, which consider errors in the static properties and noise in seismic \n\ndata, the time-lapse difference becomes absolutely necessary. \n\n? The inversion was implemented to estimate pressure and saturation for each single \n\nblock individually. Thus, the optimization procedure is simple, with only two \n\nunknowns to be estimated. The objective function considering the 4D approach and P \n\nand S impedances simultaneously presented a good behavior with a well-defined \n\nglobal minimum. Thus, the initial guess did not influence the results for the cases \n\nstudied. \n\n? When noise in seismic data and errors in the static properties are considered, the \n\nobjective function still presents a global minimum. However, the global minimum is \n\ndisplaced from the expected correct position and does not coincide with the true \n\nanswer, yielding errors in the estimated pressure and saturation values.  \n\n     73\n\n\n\n \n\n \n\n  \n\n \n\nThe methodology presented in paper 2 is a relevant result as it proposes an innovative \n\nprocedure to integrate 4D seismic and simulation models. Some of the results to be highlighted \n\nare: \n\n? The proposed procedure applies constraints in the solution space that are derived from \n\nthe combination of the mapped reservoir uncertainties. Thus, it is a quantitative way of \n\nincorporating the knowledge available from the reservoir characterization and \n\nsimulation processes with 4D seismic signals. \n\n? In the case study presented, the application of the methodology allowed the reduction \n\nof errors in some regions of the estimated water saturation map, where, according to \n\nthe simulations, water should not have reached. Before applying the methodology, \n\nthese areas had been wrongly estimated from 4D seismic due to the presence of noise \n\nin the region. As mentioned before, in these cases, the minimum of the objective \n\nfunction is displaced and does not coincide with the true answer. Thus, the constraints \n\ndetermined by the methodology cut the solution space and now the minimum inside \n\nthe new space is closer to the true answer. \n\n? The methodology allows checking the flow behavior, taking into account the reservoir \n\nuncertainties, to verify that it is in agreement with the time-lapse signals. Thus, it can \n\nbe useful to identify possible problems with 4D seismic data or with the mapping of \n\nuncertainties. Better results are achieved when the most important uncertainties are \n\nproperly mapped. However, in the cases where this is not achieved as, for instance, in \n\nthe presence of an \"unknown unknown\", the methodology might force the inversion \n\nlimits to the boundaries and this could be used as an indication that the \n\ncharacterization process needs to be improved. This type of situation was not \n\nconsidered in this work but must be considered in future works. \n\nThe results obtained from the history matching methodology proposed in paper 3 are: \n\n? A history matching process that uses 4D seismic information locally (regions around \n\ninjector wells) and that provides updated reservoir properties with geological features. \n\n? It is an easy-to-implement procedure, which can be a good alternative when more \n\nsophisticated methods may be unfeasible due to the complexity of implementation or \n\nto high computational demand. \n\n     74\n\n\n\n \n\n \n\n  \n\n \n\n? The results obtained in the synthetic case studied showed a considerable error \n\nreduction in the water saturation map. This kind of information can play an important \n\nrole in the decision making process of developing and managing a petroleum field. \n\nSome points to highlight concerning the volume calibration procedure of the fourth and \n\nlast paper of this work are: \n\n? The proposed methodology allowed the estimation of a saturation map from 4D \n\nseismic that respected the expected mass balance. This was verified by observing \n\nthe saturation errors after the calibration, which presented positive and negative \n\nvalues. \n\n? The history matching results showed that the methodology was able to update \n\nreservoir properties and, thus, produce a simulation model that better follows the 4D \n\nseismic data. When a poor estimation of the saturation changes was used as input \n\nfor the history matching, an improper update of the reservoir properties was \n\nobserved. Thus, the results highlighted the importance of estimating a calibrated \n\nmap, in order to use it in a quantitative history matching procedure. \n\n? The volume calibration procedure provides a more reliable saturation map and it is \n\nimportant to avoid bias in the amount of water in the updated model after \n\nperforming a history matching, concentrating the matching procedure in the \n\nlocalization of the water front. \n\nThe last aspect to highlight in the current work is that the integration methodologies (papers \n\n2 and 4) could be used in different contexts. For instance, the methodology of paper 2 could be \n\nextended to be performed in the impedance domain, instead of the pressure and saturation \n\ndomain. In the same way, the volume calibration proposed in paper 4 could be applied to \n\nsaturation maps estimated by other published methodologies (Landro 2001, Lumley et al 2003, \n\nand MacBeth et al 2006). Thus, the main contribution of this work is related to the ideas of \n\nintegration methodologies and not only to the results presented here. \n\n \n\n  \n\n     75\n\n\n\n     76\n\n\n\n \n\n \n\n  \n\n \n\n7. FUTURE WORKS \n\nSome points to be addressed to extend the study presented in this work are described \n\nbelow: \n\n? Application of the methodologies in a more challenging dataset, considering, for \n\ninstance, data with different scales, the presence of gas, the presence of unknown \n\nunknowns and uncertainties in the petro-elastic modeling.  \n\n? In more complex cases if the spatial correlation of the estimated properties is not \n\nrespected the petro-elastic inversion must be improved by adding a continuity factor, \n\nor by performing the inversion for all the blocks simultaneously. For the latter a more \n\nsophisticated optimization algorithm might be necessary. \n\n? Performance of volume calibration locally, around the injector wells, creating an \n\nadditional step to identify the volume of water corresponding to each selected well. \n\n? Improvement of the proposed local history matching procedure to guarantee \n\ncontinuity in the borders of the regions, generating models more consistent with \n\ngeologic models. \n\n? Performance of the integration between reservoir simulation models and 4D seismic \n\ndata in a feedback loop. In this case, the sequence would be: (1) estimation of the \n\ndynamic changes from 4D seismic, (2) conditioning/calibration of the estimation with \n\nthe methodologies presented here, (3) performance of a history matching, (4) use of \n\nthe new updated static properties to go back to step 1 and repeat all the cycle until a \n\nsatisfactory matching is reached. \n\n?  Extension of the integration methodology (paper 2) to a probabilistic approach. \n\nInstead of using only minimum and maximum values, a probabilistic distribution \n\nfunction could be used to condition the estimation of dynamic properties.  \n\n? Application of the proposed methodologies to a real dataset.  \n\n \n\n \n\n     77\n\n\n\n     78\n\n\n\n \n\n \n\n  \n\n \n\nREFERENCES \n\nAvseth, P., Mukerji, T., Mavko, G., 2005. Quantitative seismic interpretation: applying rock \n\nphysics tools to reduce interpretations risk. Cambridge University Press, Cambridge. \n\n \n\nBatzle, M. and Wang, Z., 1992. Seismic properties of pore fluids. Geophysics. 57 (11), 1396-\n\n1408.  \n\n \n\nBrito, D., Moraes, R. and Emerick, A., 2010 The Marlim field: incorporating time-lapse seismic \n\nin the assisted history matching. SPE137763. In: Proceedings of the SPE Latin American &amp; \n\nCaribbean Petroleum Engineering Conference 1-3 December, Lima, Peru. \n\n \n\nCaers, J., 2003. History matching under training-image based geological model constraints. SPE \n\nJ. (7), 218-226. \n\n \n\nCastro, S. A., Caers, J., Otterlei, C. M., Meisingset, H., Hoye, T., Gomel, P., Zachariassen, E., \n\n2009. Incorporating 4D seismic data into reservoir models while honoring production and \n\ngeologic data: a case study. The Leading Edge. 28 (12), 1498-1506. \n\n \n\nDadashpour, M., Landr\u00f8, M., Kleppe, J., 2008. Nonlinear inversion for estimating reservoir \n\nparameters from time-lapse seismic data. J. Geophys. Eng. 5, 54-66.  \n\n \n\n     79\n\n\n\n \n\n \n\n  \n\n \n\nDadashpour, M., Echeverr\u00eda-Ciaurri, D., Kleppe, J., Landr\u00f8, M., 2009. Porosity and permeability \n\nestimation by integration of production and time-lapse near and far offset seismic data. J. \n\nGeophys. Eng. 6, 325-344. \n\n \n\nDavolio, A., Maschio, C., Schiozer, D., 2011. Incorporating 4D seismic attributes into history \n\nmatching process through an inversion scheme. SPE142946. In: Proceedings of the Annual \n\nConference Exhibition of SPE EUROPEC/EAGE. 23-26 May, Vienna, Austria. \n\n \n\nDavolio, A., Maschio, C., Schiozer, D., 2012. Pressure and saturation estimation from P and S \n\nimpedance: a theoretical study. J. Geophys. Eng. 9, 447-460. \n\n \n\nDavolio, A., Maschio, C., Schiozer, D., 2013a. A methodology to constrain pressure and \n\nsaturation estimation from 4D seismic using multiple simulation models and observed data. J. \n\nPetrol. Sci. Eng. 105, 51-61. \n\n \n\nDavolio, A., Maschio, C., Schiozer, D., 2013b. Local history matching using 4D seismic data and \n\nmultiple models combination. In: Proceedings of the Annual Conference Exhibition of SPE \n\nEUROPEC/EAGE. 10-13 June, London, United Kingdom. \n\n \n\nFahimuddin, A., Aanonsen, S., Skjervheim, J. A., 2010. Ensemble based 4D seismic history \n\nmatching: integration of different levels and types of seismic data. SPE131453. In: Proceedings \n\nof the Annual Conference Exhibition of SPE EUROPEC/EAGE. 14\u201317 June, Barcelona, Spain. \n\n \n\n     80\n\n\n\n \n\n \n\n  \n\n \n\nGervais, V., Roggero, F., 2010. Integration of saturation data in a history matching process based \n\non adaptive local parametrizaion. J. Petrol. Sci. Eng. 73, 86-98. \n\n \n\nGosselin, O., Berg, S. V. D., Cominelli, A. 2001. Integrated History-Matching of Production and \n\n4D Seismic Data. SPE71599. In: Proceedings of the Annual Technical Conference and \n\nExhibition. 30 September- 3 October, New Orleans, Louisiana, USA. \n\n \n\nGosselin, O., Aanonsen , S. I, Aavatsmark, I., Cominelli, A., Gonard, R., Kolasinski, M., \n\nFerdinandi, F., Kovacic, L. Neylon, K. 2003. History Matching Using Time-lapse Seismic \n\n(HUTS). SPE 84464. In: Proceedings of the Annual Technical Conference and Exhibition, 5-8 \n\nOctober 2003, Denver, Colorado. \n\n \n\nHelgerud, M. B., Miller, A. C., Johnston, D. H., Udoh, M. S., Jardine, B. G., Harris, C., \n\nAubuchon, N., 2011. 4D in the deepwater Gulf of Mexico: Hoover, Madison and Marshall fields. \n\nThe Leading Edge. 30 (9) , 1008-1018. \n\n \n\nHuang, Y., MacBeth, C., Barvked, O., Gestel, J. P. V., Dybvik, O. P., 2011 Enhanced dynamic \n\ninterpretation from correlating well activity to frequently acquired 4D seismic signatures. The \n\nLeading Edge, 30 (9), 1042-1050. \n\n \n\nHoffman, B. T., Caers, J. 2005. Regional probability perturbations for history matching. J. Petrol. \n\nSci. Eng. (46), 53-71. \n\n \n\n     81\n\n\n\n \n\n \n\n  \n\n \n\nIda, M. 2009. Incorporation of Quantitative 4D Seismic Data in the History Macthing Process. \n\nMaster thesis. University of Campinas - UNICAMP.  \n\n \n\nJin, L., Alpak, F. O., Hoek, P. V., Pirmez, C., Fehintola, T., Tendo, F., Olaniyan, E., 2011. A \n\ncomparison of stochastic data-integration algorithms for the joint history matching of production \n\nand time-lapse seismic data. SPE146418. In: Proceedings of the Annual Technical Conference \n\nExhibition. 30 October \u2013 2 November, Denver, Colorado, USA. \n\n \n\nJohann, P.,  Sansonowski, R., Oliveira, R., Bampi, D., 2009. 4D seismic in a heavy-oil turbidite \n\nreservoir offshore Brazil. The Leading Edge, 28 (6) 718-729. \n\n \n\nKjelstadli, R.M., Lane, H.S., Johnson, D.T, Barkeved, O. I., Buer, K., Kristiansen, T. G. 2005. \n\nQuantitative History Match of 4D Seismic Response and Production Data in the Valhall Field. \n\nSPE 96317. In: Proceedings of the Offshore Europe. 6-9 September, Aberdeen, United Kingdom. \n\n \n\nKazemi, A., Stephen, K. D., Shams, A., 2010.  Seismic history matching of Nelson using time-\n\nlapse seismic data: an investigation of 4D signature normalization.. SPE131538. In: Proceedings \n\nof the Annual Conference Exhibition of SPE EUROPEC/EAGE. 14\u201317 June, Barcelona, Spain. \n\n \n\nLanda, J. L., Kumar, D., 2011. Joint inversion of 4D seismic and production data. SPE146771. \n\nIn: Proceedings of the Annual Technical Conference Exhibition. 30 October \u2013 2 November, \n\nDenver, Colorado, USA. \n\n \n\n     82\n\n\n\n \n\n \n\n  \n\n \n\nLandro, M., 2001. Discrimination between pressure and fluid saturation changes from time-lapse \n\nseismic data. Geophysics 66, 836-844. \n\n \n\nLandro, M., Stronen, L. K., Slheim, O. A., Hilde, E., 2001. Time-lapse seismic as a \n\ncomplementary tool for in-fill drilling. J. Petrol. Sci. Eng. 31, 81-92. \n\n \n\nLumley, D., Adams, D., Meadows, M., Cole, S., Ergas, R., 2003. 4D seismic pressure-saturation \n\ninversion at Gullfaks field, Norway. First Break, 21 (9), 49-58. \n\n \n\nMacBeth, C., Floricich, M., Soldo, J., 2006. Going quantitative with 4D seismic analysis. \n\nGeophysical Prospecting, 54, 303-317. \n\n \n\nMaschio, C., Carvalho, C. P. V., Schiozer, D. J., 2010. A new methodology to reduce \n\nuncertainties in reservoir simulation models using observed data and sampling techniques. J. \n\nPetrol. Sci. Eng. 72, 110-119. \n\n \n\nMavko, G., Mukerji, T., Dvorkin, J., 2003. The Rock Physics Handbook: Tools for seismic \n\nanalysis in porous media. Cambridge University Press, Cambridge. \n\n \n\nNeal, R. M., 2003. Slice Sampling. The Annals of Statistics, 31(3), 705-767. \n\n \n\nNunes, J.P., Santos, M. S., Maciel, N., Davolio, A., Formento, J. L., 2009. Separation of pressure \n\nand saturation effects using AVO 4D in Marlim Field. In: Proceedings of the 11th International \n\nCongress of the Brazilian Geophysical Society, 24-28 August, Salvador, Brazil. \n\n     83\n\n\n\n \n\n \n\n  \n\n \n\n \n\nSedighi, F., Stephen, K.D., 2009., Faster Convergence in Seismic History Matching by Efficient \n\nParameter Searching. SPE121210. In: Proceedings of the Annual Conference Exhibition of SPE \n\nEUROPEC/EAGE, 8-11 June 2009, Amsterdam, The Netherlands. \n\n \n\nSchiozer, D.J., Ligero, E.L., Suslick, S.B., Costa, A.P.A., Santos, J.A.M., 2004. Use of \n\nrepresentative models in the integration of risk analysis and production strategy definition. J. \n\nPetrol. Sci. Eng. vol. 44 (1\u20132), 131\u2013141. \n\n \n\nStephen, K., D., Soldo, J., MacBeth, C., Christie, M., 2005. Multiple model seismic and \n\nproduction history matching: a case study. SPE 94173. SPE EUROPEC/EAGE. In: Proceedings \n\nof the Annual Conference Exhibition of SPE EUROPEC/EAGE, 13-16 June, Madrid, Spain. \n\n \n\nSouza, R. M., Machado, A. F., Muneratto, F. P., Schiozer, D. J., 2010. Iterative history matching \n\ntechnique for estimation reservoir parameters from seismic data. SPE131617. In: Proceedings of \n\nthe Annual Conference Exhibition of SPE EUROPEC/EAGE. 14\u201317 June, Barcelona, Spain. \n\n \n\nSouza, R. M., Muneratto, F. P., D. J. Schiozer, 2011. Quantitative integration of time-lapse \n\nderived information in a history matching procedure. SPE143009. In: Proceedings of the Annual \n\nConference Exhibition of SPE EUROPEC/EAGE. 23-26 May, Vienna, Austria. \n\n \n\nTolstukhin, E., Lyngnes, B., Sudan H. H., 2012. Ekofisk 4D seismic \u2013 seismic history matching \n\nworkflow. SPE154347. In: Proceedings of the Annual Conference Exhibition of SPE \n\nEUROPEC/EAGE, 4-7 June, Copenhagen, Denmark. \n\n     84\n\n\n\n \n\n \n\n  \n\n \n\nToinet, S., Maultzsch, S., Souvannavong, V., Volnard, O., 2011, 4D pre-stack inversion \n\nworkflow integrating reservoir model control and lithology supervised classification. Fisrt Break \n\n29 (8), 59-66. \n\n \n\nTura, A. and Lumey, D., 1999. Estimating pressure and saturation changes time-lapse AVO data. \n\nSEG Technical Program Expanded Abstr. pp. 1655\u20131658. \n\n \n\nTuttle, C., Pelissier, M., Barnes, M., Tribe, J., Persad, K., 2009. A seismically constrained \n\nreservoir modeling workflow: case study. The Leading Edge, 28 (12), 1492-1497. \n\n     85\n\n\n\n     86\n\n\n\nAPPENDIX A  \nComplementary results of the paper \u201cPressure and saturation estimation \nfrom P and S impedances: a theoretical study\u201d \n\nPaper 1 presents some discussions concerning the objective function behavior of the \n\npetro-elastic inversion proposed. To visualize the optimization aspects of the inversion, all \n\ndiscussions were presented assuming one single reservoir location (one grid block). The \n\nresults presented here complement those discussions by showing the inversion results in an \n\nentire reservoir model. These new results allow verification of the reflection of the \n\noptimization issues in an entire reservoir model, evaluating different combinations of static \n\nand dynamic variables.  \n\nThese results were extracted from the published paper Davolio et al (2011), which is \n\nattached at the end of this appendix. The goal of this appendix is to highlight the \n\nrelationship between the studies presented for one single block in paper 1 and the results for \n\nthe entire reservoir, presented in Davolio et al (2011). For more details, see the respective \n\nreferences. \n\nThe relationship between the results of the two works is shown in the figures below \n\nthat follow the layout: the results in a single reservoir location are displayed on the top \n\n(some images were extracted from paper 1) and the results of the same inversion process \n\nare displayed at the bottom, under the same optimization conditions, for an entire reservoir \n\n(images extracted from Davolio et al, 2011). In order to check the accuracy of the results, \n\nFigure A-1 presents the true answer to the problem for the entire reservoir. \n\n1. 3D approach: the non-uniqueness issue \nThe first result of the petro-elastic inversion presented in paper 1 highlights the non-\n\nuniqueness problem when changes in pressure and saturation are estimated from P \n\nimpedance. These results are displayed at the top of Figure A-2. At the bottom of the same \n\nfigure, the manner in which this problem affects different locations of a reservoir is \n\npresented.  \n\nGiven that the expected solution (true answer) is displayed in Figure A-1, FigureA-2 \n\nshows that the dynamic properties are being poorly estimated. The saturation anomalies are \n\nnot being recovered and the pressure map is influenced by these water anomalies, \n\n     87\n\n\n\nindicating that this process could not differentiate the effects of the two dynamic properties \n\nfrom seismic data (IP). \n\n \nFigure A-1:  Expected inversion response for saturation and pressure (MPa). \n\n \n\n \n\nFigure A-2: 3D inversion results, assuming only the P impedance in the objective function: \nOF=f(IP). Top: considering one single reservoir location (extracted from Davolio et al, \n2012). Bottom: estimated pressure (MPa) and saturation considering the entire reservoir \n(extracted from Davolio et al, 2011). \n\n     88\n\n\n\n\u00a0\n\nFor an ideal dataset (no errors/noise), the non-uniqueness problem can be solved by \n\nconsidering, simultaneously, P and S impedances in the objective function. This is \n\nillustrated in Figure A-3. The exact solution found by the 3D algorithm, which is observed \n\nfor the single block location, is explained by the very well-behaved objective function that \n\nholds a well-defined global minimum. This situation is observed for the entire reservoir. As \n\nillustrated in Figure A-3, the estimation of pressure and saturation for the entire reservoir \n\nwas very precise. \n\n \n\n \nFigure A-3: 3D inversion results, assuming P and S impedance in the objective function: \nOF=f(IP,IS). Top: considering one single reservoir location (extracted from Davolio et al, \n2012). Bottom: estimated pressure (MPa) and saturation  considering the entire reservoir \n(extracted from Davolio et al, 2011). \n\n\u00a0\n\n\u00a0\n\n     89\n\n\n\n2. 3D approach: assuming an incorrect porosity \n\nWhen a non-ideal dataset is assumed, the 3D inversion starts to fail. The non-ideal \n\ndataset was represented in paper 1 by assuming an inaccurate value of porosity, which is an \n\nimportant input for petro-elastic inversion. For the inversion performed in the entire \n\nreservoir, this inaccuracy was added by multiplying the true porosity image by a constant \n\n(1.15). \n\nFor this case, the global minimum of the objective function does not coincide with \n\nthe expected answer, as illustrated in Figure A-4. The results of the inversion in the entire \n\nreservoir also reflect this poor estimation. \n\n \n\n \n\nFigure A-4: 3D inversion results assuming P and S impedance in the objective function, \nOF=f(IP,IS),  and an incorrect porosity as input. Top: considering one single reservoir \nlocation (extracted from Davolio et al, 2012). Bottom: estimated pressure (MPa) and \nsaturation  considering the entire reservoir (extracted from Davolio et al, 2011). \n\n     90\n\n\n\n3. 4D approach \n\nThe problem of imperfect static properties to be used as input for the petro-elastic \n\ninversion can be mitigated by using the 4D approach. The objective function for this case \n\npresents a well-defined global minimum again (Figure A-5). As a consequence, the results \n\nof the entire reservoir also present acceptable errors. Indeed, these errors are smaller than \n\n6%, as illustrated in Davolio et al, 2011 \u2013 Figure 7. \n\n \n\nFigure A-5: 4D inversion results, assuming wrong porosity as input. Top: considering one \nsingle reservoir location (extracted from Davolio et al, 2012). Bottom: estimated pressure \n(MPa) and saturation considering the entire reservoir (extracted from Davolio et al, 2011). \n \n\n4. 4D approach: assuming uncertainties in the initial reservoir \nconditions \n\nThe last result presented here concerns the assumption of knowledge regarding the \n\ninitial reservoir conditions. The images below were not extracted from Davolio et al (2011) \n\n     91\n\n\n\nbut were generated with the same dataset presented in that paper. One of the premises of \n\nthis thesis is that the first seismic survey was acquired in the pre-production period and that \n\npressure and saturation are known at that time, given the equilibrium conditions. In this part \n\nof the appendix, an example is presented, where this condition is not satisfied. To illustrate \n\nthis example, an incorrect facies characterization was considered, which yielded the \n\nincorrect initial water saturation (connate water) displayed in Figure A-6b. The initial \n\npressure is not totally correct either, as it is assuming the constant value of 32MPa (Figure \n\nA-6d). \n\n\u00a0\n\nFigure A-6: Water saturation and pressure at the initial time (first survey). (a) and (c) \nrepresent the true properties. (b) and (d) represent the available knowledge.  \n\nTo illustrate the effect of these uncertainties in the inversion process, the other input \n\nproperties of the inversion were considered correct and no noise was added to seismic data. \n\nThe inversion results are shown in Figure A-7. Looking at the error at the bottom of the \n\nimage, it is possible to see that the main problem regarding the saturation map is related to \n\nthe initial water saturation (compare with Figure A-6). Note that the injection anomalies \n\nwere properly recovered and that the relevant errors are concentrated at the locations where \n\n     92\n\n\n\nthe initial saturation was wrong (Figures A-7c). The pressure is also presenting some \n\ninfluence on the error considered at time 0; observe the differences between the expected \n\nimage (Figure A-1) with the estimated one (Figure A-7b).  \n\n \n\nFigure A-7: Estimated saturation (a) and pressure (b) maps for the second seismic survey \ntime. Saturation (c) and pressure (d) errors (estimated \u2013 reference). \n\u00a0\n\n\u00a0 To visualize the objective function behavior for this case, one point in the reservoir \n\nwas selected (indicated by the arrow in Figure A-7c) and the same type of analysis shown \n\nbefore was repeated. Figure A-8 shows that, when this type of uncertainty is assumed, the \n\nminimum of the objective function does not coincide with the expected answer. This \n\nbehavior was also observed, in a less pronounced form, in Figure A-5 (where porosity was \n\nnot totally correct). More generally, it can be said that any source of error considered in the \n\ninversion (uncertainties in the static properties, inaccuracy in the seismic impedances etc.) \n\nwill cause a displacement in the minimum of the objective function, and more problematic \n\ncases can yield very wrong estimates of the dynamic properties. Appendix C presents an \n\n     93\n\n\n\nexample of this kind of situation and how the methodologies of papers 2 and 4 help to \n\nimprove the estimations.  \n\n\u00a0\n\nFigure A-8: Objective function behavior for one grid block (indicated in Figure A-7c). \n\nThe dynamic properties of the base model (pressure and saturation) are used as \n\ninput for the inversion. These properties at the initial time (corresponding to the first \n\nsurvey) are kept constant during the optimization process and those corresponding to the \n\nsecond time (second survey) are modified in order to minimize the objective function. \n\nThus, if the dynamic properties at the initial time carry some errors, these errors are \n\nreflected in the response of the optimization process, i.e., the estimated pressure and \n\nsaturation for the second time (remember that the objective function minimizes the time \n\nlapse difference). This explains the errors observed in Figure A-7.  \n\nHowever, these errors are substantially diminished when the time lapse difference \n\nof the estimated dynamic properties is analyzed, as shown in Figures A-9 and A-10. The \n\ntrue change in saturation and pressure are shown in Figures A-9a and A-10a, respectively. \n\nThe second column of these images displays the changes observed according to the \n\navailable information (represented in this work by the so-called Base model) and the third \n\ncolumn displays the estimated changes. The errors displayed in Figures A-9e are totally \n\nacceptable for saturation and the same can be said for pressure, which yielded error values \n\nsmaller than 1MPa (Figure A-10e). Thus, Figures A-9 and A-10 show that, even if the \n\nproperties at the initial time are inaccurate, the pressure and saturation changes are being \n\nproperly recovered, which is, indeed, the information needed for reservoir monitoring. \n\n     94\n\n\n\n\u00a0\n\nFigure A-9: Time lapse difference of water saturation maps: (a) true answer, (b) base \nmodel used as input for the inversion and (c) estimated. Map error: (d) = (b) \u2013 (a) and (e) = \n(c) \u2013 (a). \n\nFigure A-10: Time lapse difference of pressure maps: (a) true answer, (b) base model used \nas input for the inversion and (c) estimated. Map error: (d) = (b) \u2013 (a) and (e) = (c) \u2013 (a). \n\n     95\n\n\n\n  \n\nSPE 142946 \n\nIncorporating 4D Seismic Attributes Into History Matching Process Through \nAn Inversion Scheme \nA. Davolio, C. Maschio, D. J. Schiozer, UNISIM - UNICAMP \n\nCopyright 2011, Society of Petroleum Engineers \n \nThis paper was prepared for presentation at the SPE EUROPEC/EAGE Annual Conference and Exhibition held in Vienna, Austria, 23\u201326 May 2011. \n \nThis paper was selected for presentation by an SPE program committee following review of information contained in an abstract submitted by the author(s). Contents of the paper have not been \nreviewed by the Society of Petroleum Engineers and are subject to correction by the author(s). The material does not necessarily reflect any position of the Society of Petroleum Engineers, its \nofficers, or members. Electronic reproduction, distribution, or storage of any part of this paper without the written consent of the Society of Petroleum Engineers is prohibited. Permission to \nreproduce in print is restricted to an abstract of not more than 300 words; illustrations may not be copied. The abstract must contain conspicuous acknowledgment of SPE copyright. \n \n\n \nAbstract \nTime-Lapse seismic attributes has been showed as a promising tool to be used in the history matching process. The most \n\ncommon seismic attribute used to integrate these data is P-impedance. The procedure usually made is a minimization of the \n\ndifferences between the seismic P-impedance and the synthetic P-impedance computed from the flow simulation data through \n\na forward modeling. On this paper, we propose a methodology that goes in the opposite way. We invert the seismic data to \n\npressure and saturation and then incorporate these results in the history match procedure in order to integrate the inversion \n\nprocess with the flow simulator, using the results of the reservoir simulation to guide the process. Another feature is that \n\ninstead of using only the P-impedance in our inversion procedure we are also taking into account a second seismic attribute the \n\nS-impedance, which is more sensitive to pressure than saturation variations. A discussion is presented regarding the results \n\nobtained using a model with characteristics similar to the Brazilian offshore fields and synthetic seismic data. The main \n\ncontribution of this work is the integration of the seismic attributes inversion and reservoir simulation processes. We also show \n\nthe advantages of the inversion procedure to obtain pressure and saturation considering prediction of petroleum production and \n\nthe details used in the methodology to avoid multiple combinations of saturation and pressure in the inversion process. \n\n \n\n \nIntroduction \n \n\n Traditional history matching uses production and pressure data measured in the wells, such as oil, water and gas rate, \n\nflowing and static pressures etc, for conditioning of reservoir simulation model in order to reproduce the observed data. The \n\nutilization of survey seismic derived data, such as pressure and saturations maps, in the history matching is relative new. \n\nAlthough this practice is relative new it has become increasingly common due to the improvement generally observed when it \n\nis compared to the traditional workflow using only production data. Gosselin et al (2001) and Gosselin et al (2003) presented a \n\nmethodology in which the fluid flow simulator was coupled with a petro-elastic model to convert the simulated \n\nsaturation/pressure and static rock properties into simulated elastic properties and run the history matching on the elastic \n\ndomain. Kjelstadli (2005) showed the use of seismic surveys acquired through permanent ocean-bottom seismic cables. \n\nSedighi and Stephen (2009) worked on a fast method based on neighbourhood algorithm using time-lapse seismic to \n\neffectively condition saturation and pressure changes in history matching. Dadashpour (2009) proposed a computer aided \n\nhistory matching methodology for porosity and permeability estimation integrating production and time-lapse seismic data in \n\nthe form of zero offset amplitudes and amplitude versus offset (AVO) gradients. Another work that concerns integration of 4D \n\nseismic data into the history matching process by a forward modeling is Ida (2009), where the author proposes a methodology \n\nthat matches the data in the elastic domain, adjusting impedance maps. Thus, there are several ways to integrate these two set \n\nof data, Fahimuddin et al (2010) addressed this question presenting a discussion regarding which kind of seismic data and at \n\nwhich level of history matching process these data should be integrated. The authors compare the integration of seismic data in \n\nthe elastic and amplitude domains and conclude that the elastic domain performs better than the other one.  \n\nMost of the works found in the literature utilize the acoustic impedance or seismic amplitudes in the history matching \n\nprocess trough a forward petro elastic modeling and the matching is done in the seismic domain (elastic or amplitudes). The \n\nidea of using pressure and saturation maps, the purpose of second part of this work, has as main motivation on the use of \n\nreservoir parameters as input of the process, which it seems to be a more natural way from the point of view of reservoir \n\nbehavior understanding. The point is that extracting pressure and saturation information from seismic data is not a trivial task. \n\nIt can be found in the literature several works aiming to recovery dynamic properties from 4D seismic data. Tuna and Lumley \n\n     96\n\n\n\n2  SPE 142946 \n\n(1999) showed that it is possible to estimate changes on pressure and saturation through P-wave and S-wave impedances \n\nseismic derived. On Landro (2001) the author derived mathematical expressions that can be used to extract pressure and \n\nsaturation changes using 4D AVO data, he also shows that the application of his technique to real 4D seismic data was made \n\nsuccessfully. Later on the work of Nunes et al (2009) shows an application of Landro\u2019s (2001) method in a real Brazilian field, \n\nwith good results. MacBeth et al (2006) also proposed a methodology to identify pressure and saturations changes using time \n\nlapse seismic amplitudes. The work of Dadashpour et al (2008) presented a petro-elastic inversion methodology that uses zero \n\noffset 4D seismic amplitudes to recovery pressure and saturation changes. Following this line, this work presents a \n\nmethodology that estimates pressure and saturation from P ans S impedances through a petro-elastic inversion. Then on the \n\nsecond part, these estimated dynamic properties are coupled into history matching process. \n\n \n\nPetro-elastic modeling \nThe methodology proposed in this work is divided in two parts, the first one attempt to generate saturation and \n\npressures maps inverting seismic attributes and the second one attempt to use these data in the history matching process. \n\nThe inversion algorithm is made through an optimization procedure where the differences between the seismic \n\nattributes and the simulation derived seismic attributes are minimized. To generate seismic attributes from simulation data, a \n\npetro elastic modeling (PEM), which is a set of relationships that relates fluid/rock and elastic properties, is required. Follows \n\nbelow the relationship that composes the PEM considered in this work. \n\nThe seismic attributes that are used in the inversion are compressional and shear impedances, also called P-impedance \n\n(IP) and S-impedance (IS), respectively. Considering ?, VP and VS the density, compressional and shear wave velocities of the \n\nmedium the impedances can be written as:  \n\n ?? ? ???,        (1) \n?? ? ??? .       (2) \n\nSeismic velocities depend on rock saturated bulk (Ksat) and shear (\u00b5 sat) modulus according to the equations: \n\n \n\n?? ? \t\n??\n?????????\n? ?      (3) \n \n\n?? ? ????\n? ?       (4) \n \n\nThe most used theoretical approach to determine the rock saturated bulk and shear modulus are the Gassmann \n\nequations that can be described as follows (Avseth et al. 2005): \n\n???? ?????? ? ? !\n\"#$%\"&amp;'()*+\",-??? ./+?\"012?!?\n\n\"345\"012*\n?         (5) \n\n 6789 ? 6????          (6) \n \n\nwhere Kdry, Kmin and Kfl are the bulk modulus of the rock frame, the mineral and the fluid mixture. \u00b5  is the shear modulus and + is the porosity. Note that Gassmann equations predict that the rock bulk modulus change if the fluids change, but the rock \nshear modulus do not. \n\nTo compute the dry bulk and shear modulus the known friable, or uncemented, sand model (Mavko et al. 2003) is \n\nused in this work. This model makes use of the Hertz-Mindlin contact theory and a heuristic modified Hashin \u2013 Strikman \n\nlower bound, according to the equations: \n\n \n\n?:;&lt;? = >?>@\nAB?C?AB?D ?  !>?>@\n?C?AB?DE\n! F CD GHI?        (7) \n\n \n\n \n\nG:;&lt;? = >?>@?AB?J ?  !>?>@??J E\n! F K?         (8) \n\n \n\nwhere \n\n     97\n\n\n\nSPE 142946  3 \n\nL ? ?ABM NO\nAB?P?AB\nAB?Q?AB R,                      (9) \n \n\nbeing that KHM and \u00b5 HM are the bulk and shear modulus at critical porosity ST given by the contact Hertz-Mindlin theory,  \n \n\n?HI ? =U*? !>@)*?* PV*? !W)* ?XYYE\n.??          (10) \n\n \n\nGHI ? Z!CWZ?Q!W) =DU*? !>@)*?*QV*? !W)* ?XYYE\n.??                    (11) \n\n \n\nwhere Peff is the effective pressure; \u00b5  and ? are the mineral shear bulk modulus and Poisson ratio and n is the coordination \n\nnumber. \n\n \n\nProposed Petro-elastic inversion \n \n\n The link between simulation and seismic data is done through the equations presented above, i.e., given  \n\nsaturation/pressure pairs provided by simulation and rock and fluids properties the elastic parameter such as P and S \n\nimpedances can be computed through forward modeling. So, in the opposite direction the inversion is done when the elastic \n\nparameters are provided and the dynamics properties are estimated. \n\nThe minimization of the objective function is carried out through an optimization algorithm based on numerical \n\ngradients computation and sequential quadratic programming, available in MatLab software (fmincon). In this work three \n\ndifferent approaches of the objective function is presented. The main objectives are to verify the improvement when more than \n\none seismic attribute is used into the objective function and also how to handle time lapse data set into that.  \n\nFor the first two algorithms proposed the objective function can be generally described as: \n\n [\\ ? ]?^_`? F ?^T?a]      (12) \n \n\nwhere obs and cal stands for observed and calculated, respectively; SA means seismic attribute, which can be SA =IP  or the \n\nvector SA = [IP  IS].  \n\n The objective function of the third algorithm is given in terms of dSA instead of SA which means time lapse \n\ndifference of the seismic attributes so,  \n\n [\\ ? ]b?^_`? F b?^T?a]      (13) \n \n\nwhere again d is the 4D difference between two vintages and the vector dSA is defined as dSA =[dIP dIS]. \n\nIn order to better control the inversion scheme synthetic seismic data is used, so the petro elastic modeling will be \n\nalso used to generate the synthetic seismic attributes. To do so two simulation models have to be considered, the one used to \n\ncreate the synthetic seismic, called reference model and the second one called base model that represents the model we want to \n\nadjust. \n\nPressure and saturations derived from the base model simulation are used as initial guess to all inversion algorithms \n\nand the inversion is run for each reservoir model cell independently.  \n\n \n\nAlgorithm 1: inversion algorithm using IP \n\n \n\nThe first algorithm built follows the ideas presented in (Souza et. al, 2010). The main input data for this algorithm are \n\nthe observed seismic P-impedance (in equation 12,  SA=IP) and the initial guess. Before running the inversion the base model \n\n(the one that will be adjusted) is simulated and the pressure and saturations values estimated are used as initial. Then, using the \n\npetro elastic modeling the optimization algorithm finds the saturation and pressures values that best match the two P-\n\nimpedances, the one coming from seismic and the one computed from the simulation data.  \n\nAssuming that the initial reservoir conditions are known the inversion aims to work only with the second production \n\ntime, so the algorithm uses only one time production data.  \n\n \n\nAlgorithm 2: inversion algorithm using IP and IS \n\n  \n\nAs stated in (Souza et. al, 2010) estimating pressure and saturation from P-impedance end up in a no uniqueness \n\nproblem. In order to better handle this issue the second algorithm we propose incorporate more seismic information into the \n\ninversion process. The use of two different kind of seismic data simultaneously (P and S impedances), instead of only using \n\nthe well known P-impedance, helps to differentiate between pressure and saturation effects since these attributes have different \n\nanswers when the dynamic properties change (Tuna et al, 1999). One reason for this difference is that S-impedance is not as \n\n     98\n\n\n\n4  SPE 142946 \n\nsensitive to fluids change as P-impedance,  remembering that shear modulus does not depends on pore fluids contents as \n\nmentioned before. So, the 4D changes observed on shear impedance data should be more related to pressure than saturation \n\nand that makes the difference compared to the P-impedance, which is sensitive to both effects. Figure 1 shows this behavior, \n\nwhere it can be seen that big changes for saturation yields very small changes in IS, the opposite is observed for IP. The values \n\nof IP and IS shown on figure 1 were calculated through the petro elastic modeling previously presented, so it represents the \n\nsensitivity of the elastic properties to pressure and saturation changes considering those relationships. \n\nFollowing the same scheme defined in algorithm 1, the difference now is that SA in the objective function (equation \n\n12) is the vector SA=[IP IS]. The same assumption about the date considered in the previous algorithm is used here and the \n\nwhole procedure is done with only one seismic survey. \n\n \n\nAlgorithm 3: inversion algorithm using IP and IS and a 4D approach \n\n  \n\nOne of the best arguments to work with time lapse seismic data is that making the difference between two vintages \n\nallows mitigating de effect of noise, or uncertainty in the reservoir properties when synthetic seismic needs to modeled. \n\nFollowing our study, if we start to consider uncertainties in the reservoir model the two algorithms presented before may fail. \n\nTo try to overcome these issues the third algorithm proposes to minimize the 4D impedances differences. This code, as the one \n\ndefined before, keeps the use of both impedances (IP and IS) into the objective function and a diffent aspect compared to the \n\nprevious methodology is that now the evaluation of 4D differences requires two seismic surveys as input data. Here the \n\nobjective function is defined by equation 13. \n\n \n\n \nFigure 1- P and S impedances sensitivity to saturation and pressure changes, considering three values of porosity (0.2, 0.25 \n\nand 0.3). Note that S-impedance is almost insensitive to saturation effects. \n\nConstraints \n  All the inversion procedures are limited by known boundaries that come from engineering data. The water saturation \n\nvalues are constrained by connate water saturation and one minus irreducible oil saturation: \n\n \n\nSwc ? Sw ? 1-Sor.       (14) \n\n \n\n The water saturation boundaries vary according to the facies reservoir distribution. \n\n As no gas will be considered another constraint applied to Sw is that the sum of the oil and water saturations is equal \n\nto one, \n\nSo + Sw = 1.                 (15) \n\n \n\n For the pressure range we are assuming the pressure bubble point and the overburden pressure, \n\n \n\nPbub ?  P ? Pover.       (16) \n\n \n\n As this work concerns only synthetic seismic data we are not dealing with scaling issues.  \n\nIncreasing \n\npressure \n\nIncreasing sw \n\n     99\n\n\n\nSPE 142946  5 \n\nModel description \n \n\n The reservoir was discretized in a corner-point grid with 90\u00d7110\u00d75 blocks, 60 meters in size in x and y direction \n\n(5400 m \u00d7 6600 m) and 15 meters (in average) in z direction. The model was generated through geostatistical techniques. \n\nThere are three facies characterized according to three permeability ranges. The reservoir also comprises four faults, as can be \n\nseen in Figure 2. The transmissibility of each fault was included as uncertain attribute in the study. The reservoir is drained by \n\neight vertical producer wells supported by seven water injector wells. A reference reservoir model (chosen from the possible \n\ncombinations of the 16 uncertain attributes) was simulated to generate a history of 3600 days. The description of the 16 \n\nattributes considered is shown in Table 1. For the generation of Base model, multiplier values for the parameters 1 to 9 was set \n\nto 1. For the four faults (parameters 10 to 13), multipliers equals to 0.5 were used. For relative permeability (parameters 14 to \n\n16), exponent of water phase (Corey Model) was set to 3. Oil rate of the production wells and water rate of the injection wells \n\n(obtained from the reference model - history) are imposed to the Base model. \n\n \n\n    \n\nFigure 2 - Horizontal permeability (mD) of model studied \n\n Concerning time-lapse seismic data,  it will be considered as the base data the synthetic seismic generated from the \n\nreference simulation model at the initial production time (year 1990), when no fluids neither pressure changes has occurred. \n\nThe monitor surveys will be assumed after 4 and 8 years of production, represented by the years 1994 and 1998 of the same \n\nsimulation model. All the inversion schemes proposed aim to find pressure and saturation values for the monitor surveys.  \n\n  \n\nApplication: Petro-elastic Inversion \n \n\n Remembering that the static reservoir properties used as input to run the petro elastic model, such as porosity, fluid \n\nproperties, compressibility, etc, were the same for both models (base and reference), when we apply the inversion procedures \n\nproposed we are evaluating the possibility of recovery pressure and saturation information from seismic attributes assuming \n\nwe know these static reservoir parameters.  Figure 3 shows the saturation and pressure maps for the reference model for the \n\nthird layer after four years of production, these data were used to generate the seismic impedances and they represent the \n\nanswer we want to reach.  \n \n\n \nFigure 3 \u2013 Water saturation and pressure (kgf/cm2) maps of layer 3 of the reference model after four years of production. \n\nTable 1 - Description of the model parameters \n\nAttribute \n\nnumber\nDescription Type Min Max\n\n1 to 3 Porosity Multiplier 0.85 1.15\n\n4 to 6\nHorizontal \n\nPermeability (Kx)\n\nLog \n\nMultiplier\n0.75 1.1\n\n7 to 9\nVertical \n\nPermeability (Kz)\n\nPercent of \n\nKx (%)\n4 25\n\n10 to 13\nFault \n\ntransmissibility\nMultiplier 0 1\n\n14 to 16\nRelative \n\npermeability\n\nExponent of \n\nwater phase \n\n(Corey \n\nModel)\n\n1 5\n\n     100\n\n\n\n6  SPE 142946 \n\nAlgorithm 1 \n\n Application of Algorithm 1 intends to show how much information about pressure and saturation effects it is possible \n\nto recovery when only P-impedance data is available. Figure 4 shows the results for the third layer of the model. Comparing \n\nqualitatively these maps with the ones shown on Figure 3 it can be noticed that the inversion algorithm was not able to capture \n\nthe water saturation anomalies. Also, the pressure map presented some influence of the saturation behavior showing that the \n\neffects of both dynamic properties could not be properly differentiated from P-impedance data. Although some information \n\nespecially about the pressure field could be recovered the results were not very satisfactory.  \n\n \n\n \nFigure 4 - Inverted water saturation and pressure (kgf/cm2) maps of the third reservoir layer at year 1994. Results obtained by \n\nthe application algorithm 1. \n\nAlgorithm 2 \n\n This second case aims to evaluate the contribution of shear impedance for the inversion when it is included into the \n\nobjective function. Incorporation of this new seismic attribute is the only difference between the results provided by running \n\nalgorithm 2 and the ones obtained through algorithm 1. Observing Figure 5 we clearly see the improvement of the inversion \n\nresults when IS is considered together with IP in the objective function, showing that now the inversion was able to \n\ndiscriminate pressure and saturation effects. Further, the error maps shown in the same figure reveals that the results were very \n\nclose to the answer we wish to reach, giving a percentage error &lt;1%. This means that the problem of non-uniqueness was \n\nreduced by incorporating IS into the process.  \n\n \n\n \nFigure 5 - On top: inverted water saturation and pressure (kgf/cm2) maps of the third reservoir layer at year 1994. On bottom: \n\npercentual error maps. Results obtained by the application algorithm 2. \n\n     101\n\n\n\nSPE 142946  7 \n\nAlgorithm 2 \u2013 applied in a modified porosity model \n\n Knowing that the use of both impedances improves the inversion algorithm response being quantitatively close to the \n\nsolution, we start to consider uncertainties in the reservoir base model. The generation of seismic attributes was done exactly \n\nas before, using the reference model. However the base simulation model is now composed by a modified porosity field, \n\nwhere a constant multiplier was applied to it. So, the inversion algorithm uses this modified porosity field as input and the \n\nsimulated pressure and saturations values used as initial guess were generated incorporating this change. This case would be \n\ncloser to a field case, where the reservoir simulation model does not accurately represent the real porosity values. Saturation \n\nand pressure maps resulted from this case can be seen on Figure 6. \n\nWe do not even need to look at the error maps to realize that this small change in one reservoir property messed up \n\nthe inversion process, yielding results very far from the expected. This result shows the instability of the process when \n\nrecovering saturation and pressure information by a petro elastic inversion. A good sign is that the general trend was kind of \n\nrecovered, what means that some improvements could be done in the process to guide the inversion and produce better results.  \n \n\n \nFigure 6 - Inverted water saturation and pressure (kgf/cm2) maps of the third reservoir layer at year 1994. Results obtained by \n\nthe application algorithm 2 considering a modified porosity field in the base model. \n\nAlgorithm 3 \u2013 applied in a modified porosity model  \n\nIn the previous application it was noted the instability of the inversion when the porosity field is disturbed. This third \n\nalgorithm we are proposing deals with this issue by defining the objective function concerning time lapse differences. As \n\nmentioned before this methodology is based on a minimization between the 4D differences of the seismic and simulation \n\nderived impedances, where the main objective is to mitigate the error in the porosity field by subtracting the seismic attributes. \n \n\n \n\n \nFigure 7 - On top: inverted water saturation and pressure (kgf/cm2) maps of the third reservoir layer at year 1994. On bottom: \n\npercentual error maps. Results obtained by the application algorithm 3 considering a modified porosity field in the base model. \n\n     102\n\n\n\n8  SPE 142946 \n\n \n\nThe application of this methodology requires a minimum of two seismic vintages. Remember that in this work the \n\nbase survey corresponds to the initial state of the field, i.e., the production has not started. The results for this case are \n\nillustrated on Figure 7 and as it can be seen the 4D approach really improves the inverted saturation and pressure maps, \n\nmitigating the effect of inaccuracy in the porosity field. The errors are now acceptable (see the bottom of the same figure) \n\npresenting values less than 6%.  \n\nComparing the results shown so far one can say that the use of S and P impedance together allows to quantitavely \n\nrecovery pressure and saturations information. If uncertainties in the reservoir static properties are considered, the 4D \n\ndifference of seismic attributes helps to minimize this error on the inversion results. On the second part of this work the results \n\nprovided by the application of algorithm 3 are used in the history matching process as described below. \n\n \n\nHistory matching \n\n \n\nSaturation and pressure maps obtained from the application of Algorithm 3 are used in the history matching process. \n\nThe minimization of the objective function is carried out through an optimization algorithm based on numerical gradients \n\ncomputation and sequential quadratic programming, available in MatLab software (fmincon). The objective function is \n\nmathematically represented by the Equation 17: \n\n \n\n( )[ ] ( ) ( )[ ]BBm\ns\n\nj\nBppp\n\nPmsPmsEmsEmswDD\ns\n\nwOF ++= ?\n=1\n\n1\n                                                                                               (17) \n\nin which  \n\n( )\n\n2\n\n1\n\n?\n=\n\n?=\n\nn\n\ni\n\niip simobsD , ( )\n\n2\n\n1\n\n?\n=\n\n?=\n\nb\n\nk\n\nkk SsimSobsEms  and ( )\n\n2\n\n1\n\n?\n=\n\n?=\n\nb\n\nk\n\nkk PsimPobsEmp  \n\n \n\n In Equation 17, obsi and simi represent observed and simulated production data, respectively, n is the number of \n\nproduction data and s is the number of data series (well water rate, for example) and wp is a weight factor for production data. \n\nSobs and Ssim are observed and simulated saturation maps and Pobs and Psim are observed and simulated pressure maps, wm \n\nis a weight factor for pressure and saturation data and b is the number of grid blocks. Dp, Ems and Emp are differences related \n\nto production data, saturation and pressure maps, respectively. Remembering that observed pressure and saturation maps \n\nconsidered here is those ones obtained from the inverse procedure (Algorithm 3). \n\nThe subscript \u201cB\u201d in previous equations represents quantities (differences) computed for Base model. Therefore, the \n\ndivision by Base model quantity represents normalization in order to combine data with different magnitude (production rates, \n\npressure and saturation maps) in the objective function. This signifies that if a given modified model has a OF value greater \n\nthan 1, it has a match worse than the Base case. Conversely, if OF is lower than 1, the model has a match better than the Base \n\ncase. \n\nEight situations considered in the history matching process are shown in Table 2. The processes are classified \n\naccording to the following three aspects: (1) the amount of data considered in the history period (2940 and 3600 days); (2) the \n\ncomposition of the objective function (with and without the use of the pressure and saturation maps and (3) the number of \n\nparameters considered in the history matching. In the third one, the objective is to show, in a simplified way, how pressure \n\nmaps can be used to identify reservoir compartmentalization, in this case, the pressure error maps (Figure 8) reveals clearly the \n\npresence of the two sealing faults (transmissibility multipliers near from zero in the reference model). Therefore, the history \n\nmatching processes with 16 parameters consider the presence of these two faults and the processes with 14 parameters do not \n\nconsider. The objective function was composed by water rate of the eight producer wells plus four maps: pressure and \n\nsaturation for 1470 and 2940 days. \n\n \n\nTable 2 - Description of the history matching processes \n\nHistory matching process History (days) Objective function Parameters \n\nHM16P_2940 2940 \nProduction \n\n16 \nHM16P_3600 3600 \n\nHM16PM_2940 2940 \nProduction + pressure and saturation maps \n\nHM16PM_3600 3600 \n\nHM14P_2940 2940 \nProduction \n\n14 \nHM14P_3600 3600 \n\nHM14PM_2940 2940 \nProduction + pressure and saturation maps \n\nHM14PM_3600 3600 \n\n     103\n\n\n\nSPE 142946  9 \n\n \n \n\nFigure 8 - Difference in pressure map (1470 days) related to the Base model (Observed-Base) \n\nThe water rate of 4 wells of the best model resulted from the Processes \u201cHM16PM_2940\u201d and \u201cHM16P_2940\u201d (with \n\nand without the use of pressure and saturation maps in the objective function, respectively) is shown in Figure 9. The \n\ndifference in saturation maps related to the best model is shown in Figure 10. Both analysis show that the use of pressure and \n\nsaturation maps in the objective function produced better results. Regarding the convergence of the minimization process, it \n\ncan been observed in Figure 11-a that HM16PM_2940 used more simulation, however, the reduction of the objective function \n\nwas much higher. \n\n  \n\n   \n\n   \nFigure 9 - Wells water rate: comparison of history matching processes with (HM16PM_2940) and without (HM16P_2940) \n\npressure and saturation maps in the objective function  \n\nPROD 3\n\n0\n\n200\n\n400\n\n600\n\n800\n\n1000\n\n1200\n\n0 600 1200 1800 2400 3000\n\nTime (days)\n\nW\na\nte\n\nr \nra\n\nte\n (\n\nm\n3\n/d\n\n)\n\nHistory\n\nInitial model\n\nHM16P_2940\n\nHM16PM_2940\n\nPROD 4\n\n0\n\n100\n\n200\n\n300\n\n400\n\n1200 1650 2100 2550 3000\n\nTime (days)\n\nW\na\nte\n\nr \nra\n\nte\n (\n\nm\n3\n/d\n\n)\n\nHistory\n\nInitial model\n\nHM16P_2940\n\nHM16PM_2940\n\nPROD 7\n\n0\n\n25\n\n50\n\n75\n\n100\n\n2000 2200 2400 2600 2800 3000\n\nTime (days)\n\nW\na\nte\n\nr \nra\n\nte\n (\n\nm\n3\n/d\n\n)\n\nHistory\n\nInitial model\n\nHM16P_2940\n\nHM16PM_2940\n\nPROD 8\n\n0\n\n50\n\n100\n\n150\n\n0 600 1200 1800 2400 3000\n\nTime (days)\n\nW\na\nte\n\nr \nra\n\nte\n (\n\nm\n3\n/d\n\n)\n\nHistory\n\nInitial model\n\nHM16P_2940\n\nHM16PM_2940\n\n     104\n\n\n\n10  SPE 142946 \n\n \n\n    \nFigure 10 - Difference in saturation maps related to the best solution: comparison of history matching process with \n\n(HM16PM_2940) and without (HM16P_2940) pressure and saturation maps in the objective function \n\nIn Figure 12 is presented results from the history matching process considering 3600 days of production. In this case, \n\nthe increase in amount of production data improves the results for well PROD7 obtained from the process using only \n\nproduction data in the objective function. However, the number of simulation was greater as can be seen in the convergence \n\nbehavior (Figure 11-b) and the reduction of the objective function was smaller. It can also be seen from Figure 11 that the use \n\nof pressure and saturation maps in the objective function stabilizes the optimization process, considering the similar number of \n\nsimulations and similar (and expressive) reduction of the objective function in both cases (2940 and 3600 days). A \n\nsummarized quantitative analysis of the best solution of each history matching process is shown in Table 3. As would be \n\nexpected, the assumption of 14 parameters (without the two sealing faults) gives a worse result, mainly for the wells PROD4 \n\nand PROD7, near the region comprising the sealing main fault. \n\n \n\n \n          (a)                     (b) \n\nFigure 11 - Comparison of the convergence behavior of four minimization processes \n\n \n\n0.00\n\n0.20\n\n0.40\n\n0.60\n\n0.80\n\n1.00\n\n1.20\n\n1.40\n\n0 100 200 300 400\n\nSimulations\n\nO\nF\n\nHM16PM_2940\n\nHM16P_2940\n\n0.00\n\n0.20\n\n0.40\n\n0.60\n\n0.80\n\n1.00\n\n1.20\n\n1.40\n\n0 100 200 300 400 500\n\nSimulations\n\nO\nF\n\nHM16PM_3600\n\nHM16P_3600\n\nHM16PM_2940 HM16P_2940 \n\n     105\n\n\n\nSPE 142946  11 \n\n   \nFigure 12 - Wells water rate: comparison of history matching processes with (HM16PM_3600) and without (HM16P_3600) \n\npressure and saturation maps in the objective function \n\n \n\n \n\nTable 3 - Summarized quantitative analysis of the best solution of each history matching process  \n\nProcess \n\nDifference (%) in production data ((1-Dp/DpB)x100) for the \n\nproducers wells \n\nDifference (%) in saturation and pressure \n\nmaps (100x(1-Ems/EmsB) and  \n\n100x(1-Emp/EmpB)) \n\nP1 P2 P3 P4 P5 P6 P7 P8 Sw1470 Sw2940 P1470 P2940 \n\nHM16P_2940 74.6 97.1 -2.8 0.0 96.1 64.9 -51.6 99.5 -5.4 3.0 -16.4 33.4 \n\nHM16P_3600 95.4 93.8 77.0 4.9 96.2 -1007.0 97.3 98.4 59.5 58.7 62.9 86.6 \n\nHM16PM_2940 85.9 95.5 96.5 97.9 99.4 78.1 97.7 94.4 90.8 89.5 92.0 88.7 \n\nHM16PM_3600 97.4 99.3 93.1 96.2 76.8 10.4 98.0 92.8 68.4 45.4 73.4 73.5 \n\nHM14P_2940 67.4 96.1 32.8 0.0 97.3 -60.0 -51.6 96.4 9.3 -13.2 -3.5 47.3 \n\nHM14P_3600 8.9 23.5 2.9 0.0 96.8 -157.5 98.1 67.0 -6.3 11.5 -13.1 33.8 \n\nHM14PM_2940 89.0 93.7 61.6 0.1 99.5 -83.7 -51.6 97.8 55.2 26.9 33.9 52.6 \n\nHM14PM_3600 55.6 10.4 19.7 0.0 98.7 -11.6 94.5 87.0 23.4 -6.0 9.5 25.5 \n\n \n\nConclusions \nRegarding the inversion the main result observed is the big contribution that shear impedance brings to the petro \n\nelastic inversion when it is simultaneously considered with P-impedance into the objective function. Another relevant point is \n\nthat the time-lapse difference should be considered in order to minimize the error caused by uncertainties in the reservoir \n\nmodel. It has to be highlighted as well that the methodology makes the assumption that the base survey corresponding to the \n\ninitial reservoir state when time lapse differences is computed. This supposition takes advantage of using a data with less \n\nuncertainty once there is no fluid movement or pressure changes at this time.  \n\nConcerning the initial guess some tests were run comparing constant values and model base simulated values of \n\npressure and saturation and it was noted that the results did not presented big differences. This happen because of the \n\nconstraints applied during the inversion, so these restrictions plays an important role guiding properly the inversion; even more \n\nthan the initial guess. Another point to highlight is that this process is not time consuming as the inversion is run independently \n\nfor each reservoir grid cell. \n\nFor the cases studied in this work, the use of pressure and saturation maps in the objective function improves the \n\nhistory matching process, mainly when less production data is available. Differences between observed and simulated pressure \n\nmaps can be useful to identify reservoir compartmentalization, aiming the reservoir parameterization for posterior history \n\nmatching. \n\nThis work is a preliminary study of a seismic/simulation integration study that is being developed. We are currently \n\nworking on adding more uncertainty at model properties aiming to build a more robust set of constraints through the definition \n\nof regions where some knowledge is proved by field measured data. \n\n \n\nReferences \n \nAvseth, P.; Mukerji, T. and Mavko, G. 2005. \u201cQuantitative seismic interpretation: applying rock physics tools to reduce \n\ninterpretations risk\u201d. Cambridge University Press, Cambridge, U.K. \n\nPROD 4\n\n0\n\n100\n\n200\n\n300\n\n400\n\n500\n\n600\n\n700\n\n1200 1600 2000 2400 2800 3200 3600\n\nTime (days)\n\nW\na\nte\n\nr \nra\n\nte\n (\n\nm\n3\n/d\n\n)\nHistory\n\nInitial model\n\nHM16P_3600\n\nHM16PM_3600\n\nPROD 7\n\n0\n\n100\n\n200\n\n300\n\n400\n\n500\n\n2000 2400 2800 3200 3600\n\nTime (days)\n\nW\na\nte\n\nr \nra\n\nte\n (\n\nm\n3\n/d\n\n)\n\nHistory\n\nInitial model\n\nHM16P_3600\n\nHM16PM_3600\n\n     106\n\n\n\n12  SPE 142946 \n\nDadashpour, M.; Landr\u00f8, M.; Kleppe, J. 2008. \u201cNonlinear inversion for estimating reservoir parameters from time-lapse \n\nseismic data\u201d, Journal of Geophysics and Engineering, vol 5; pp. 54-66.  \n\nDadashpour, M.; Echeverr\u00eda-Ciaurri, D.; Kleppe, J.; Landr\u00f8, M. 2009. \u201cPorosity and permeability estimation by integration of \n\nproduction and time-lapse near and far offset seismic data\u201d, Journal of Geophysics and Engineering, vol 6; pp. 325-344.  \n\nFahimuddin A.; Aanonsen S.; Skjervheim J. A. 2010. \u201cEnsemble Based 4D Seismic History Matching: Integration of Different \n\nLevels and Types of Seismic Data\u201d. (SPE131453), Annual Conference and Exhibition, 14-17 June 2010, Barcelona, Spain. \n\nGosselin, O.; van den Berg, S.; Cominelli, A. 2001. \u201cIntegrated History-Matching of Production and 4D Seismic Data\u201d (SPE \n\n71599), Annual Technical Conference and Exhibition, 30 September-3 October 2001, New Orleans, Louisiana. \n\nGosselin, O.; Aanonsen , S.I; Cominelli; A. et al. 2003. \u201cHistory Matching Using Time-lapse Seismic (HUTS)\u201d (SPE 84464), \n\nAnnual Technical Conference and Exhibition, 5-8 October 2003, Denver, Colorado. \n\nIda, M. (2009). \u201cIncorporation of Quantitative 4D Seismic Data in the History Macthing Process\u201d.Master thesis. State \n\nUniversity of Campinas - UNICAMP. (in Portuguese). \n\nKjelstadli, R.M.; Lane, H.S. Johnson, D.T et al.; 2005. \u201cQuantitative History Match of 4D Seismic Response and Production \n\nData in the Valhall Field\u201d (SPE 96317), Offshore Europe, 6-9 September 2005, Aberdeen, United Kingdom. \n\nLandro M. 2001. \u201cDiscrimination between pressure and fluid saturation changes from time-lapse seismic data\u201d. Geophysics. \n\nvol 66; pp 836-844. \n\nMacBeth, C.; Floricich, M. and Soldo, J. 2006. \u201cGoing quantitative with 4D seismic analysis\u201d. Geophysical Prospecting. vol \n\n54, pp 303-317. \n\nMavko, G., Mukerji, T. and Dvorkin, J.2003. \u201cThe Rock Physics Handbook: Tools for seismic analysis in porous media\u201d. \n\nCambridge University Press. \n\nNunes, J.P.; Santos,M.S.; Maciel, N.; Davolio, A.;Formento, J. L. 2009. \u201cSeparation of pressure and saturation effects using \n\nAVO 4D in Marlim Field\u201d, 11\nth\n\n International Congress of the Brazilian Geophysical Society, Salvador, Brazil, 24-28 \n\nAugust 2009. \n\nSedighi, F.; Stephen, K.D. 2009. \u201cFaster Convergence in Seismic History Matching by Efficient Parameter Searching\u201d (SPE \n\n121210), EUROPEC/EAGE Conference and Exhibition, 8-11 June 2009, Amsterdam, The Netherlands. \n\nSouza, R. M., A. F. Machado, F. P. Muneratto, D. J. Schiozer. 2010. \u201cIterative History Matching Technique for Estimation \n\nReservoir Parameters from Seismic Data\u201d (SPE131617), Annual Conference and Exhibition, 14-17 June 2010, Barcelona, \n\nSpain. \n\nTuna, A. and Lumley, D. E. 1999. \u201cEstimating pressure and saturation changes from time-lapse AVO data\u201d, SEG Expanded \n\nAbstracts. \n\n \n\n     107\n\n\n\n     108\n\n\n\n  APPENDIX B\nComplementary results of the paper \u201cLocal history matching using 4D \n\nseismic data and multiple models combination\u201d \n\nPressure matching \n\nThe local history matching methodology proposed in paper 3 uses Sw maps to \n\nestimate static reservoir properties, such as porosity and permeability. The Sw map is \n\nprovided by 4D seismic and, for the dataset used in this work, it was also possible to \n\nestimate pressure maps from 4D seismic (according to the results presented in papers 1 and \n\n2). Thus, pressure maps could also be considered an input parameter for the history \n\nmatching. The choice of not using this information came from the results obtained after the \n\napplication of the global matching procedure. For the dataset of this work, the global \n\nmatching procedure, which uses only well production data (BHP and water rate), provided \n\nan updated model with a satisfactory pressure matching. Thus, there was no need to extend \n\nthe methodology to incorporate pressure map information. This appendix shows the results \n\nthat led to this conclusion.  It is important to point out that, in cases where a satisfactory \n\npressure matching is not achieve using only well data, a procedure similar to the one \n\npresented in paper 3 could be applied for estimated pressure maps as well.   \n\nFrom Figure B-1, it can be observed that the average reservoir pressure of the model \n\nafter global matching (black diamond) is considerably better than the one from the base \n\nmodel (solid blue). The average pressure curve of this updated model closely follows the \n\nexpected behavior of the history data (red circles). \n\n \n\nFigure B-1: Average reservoir pressure. The magenta vertical line indicates the two \n\nperiods: history and forecast. \n\n     109\n\n\n\nThe pressure map of the model after the global matching (Figure B-2d) also shows an \n\nimprovement when compared to that of the base model (Figure B-2c). Although differences \n\ncan be observed around some wells such as INJ1, INJ2, INJ3, the pressure distribution \n\nalong the reservoir grid is following the expected trend from 4D seismic (Figure B-2b). \n\nFigure B-2a shows the true pressure map from which it can be verified that the estimation \n\nfrom 4D seismic was reliable. \n\nFigure B-3 shows the percentage errors of the pressure maps for the base model and \n\nthis same model after the global matching, compared to the map estimated from 4D \n\nseismic. After global matching, the majority of errors observed are smaller than 10%. Thus, \n\nthe pressure maps are already close to the one estimated from 4D seismic and, again, it is \n\nclear that there is no need to include this information in the history matching. \n\n \n\nFigure B-2: Pressure maps (layer 3) of the reference model (a), the estimation from 4D \n\nseismic (b), the base model (c) and the model after global matching (c).  \n\n \n\nFigure B-3: Pressure percentage error maps (layer 3) of the base model (a) and the model \n\nafter global matching (b). The error is computed among the pressure map estimated from \n\n4D seismic (Figure A2-b) and the simulation models. \n\n     110\n\n\n\nThe BHP curves for the individual wells (Figure B-4) also confirm the same results. \n\nThis information is complementary to the results discussed in the paper. Based on these \n\nresults, the local matching methodology was proposed to incorporate only water saturation \n\nmaps. Indeed, this assumption is also in agreement with the difficulty to extract pressure \n\nmaps from 4D seismic in real cases and with the fact that, usually, engineering data is \n\nenough to calibrate the pressure behavior. \n\n     111\n\n\n\n  \n\nFigure B-4: Bottom-hole pressure for injectors and producers. The magenta vertical line \n\nindicates the two periods: history and forecast. \n\n     112\n\n\n\nAPPENDIX C  \nComplementary results of the paper \u201cA methodology to calibrate water \n\nsaturation estimated from 4D seismic\u201d \n\nThis appendix presents some complementary results and discussions that comprise \n\nthe two parts of paper 4: the first one is related to the estimation (and calibration) of a \n\nsaturation map and the second is focused on the use of the estimated map in a history \n\nmatching process. \n\n1. Estimation of saturation from 4D seismic \n\nThe first part of this appendix presents a discussion on the 4D petro-elastic \n\ninversion defined in paper 1, which is used as a tool to estimate saturation and pressure \n\nmaps in all the subsequent papers. Here, the discussion is focused on how the constraints \n\napplied to the solution space of the optimization process help to improve the solutions. \n\nThese constraints are the base of the most important results of this thesis, which are the \n\nmethodologies, presented in papers 2 and 4.  \n\nPaper 1 presents a discussion concerning the objective function behavior of the 4D \n\npetro-elastic inversion proposed, considering one single grid block (Figures 10a and 10b in \n\nthe paper). These images show that, if an ideal dataset is used (without any error/noise), the \n\nobjective function is very well-behaved, with a global minimum that can be easily found by \n\nany optimization process (Figure 10a). However, when an imperfect scenario is assumed by \n\nadding some errors in one of the input parameters of the inversion (porosity), the objective \n\nfunction still presents a global minimum, though this point does not coincide with the \n\nexpected answer (Figure 10b). Actually, the inversion result presented in Figure 10b is very \n\naccurate, although not exactly correct. However, when greater inaccuracy or another source \n\nof errors (noise in seismic data, for instance) is assumed, the location of the global \n\nminimum of the objective function can be very different from the true answer of the \n\nproblem. In this type of situation, the use of the constraints proposed in paper 2 plays an \n\nimportant role to improve the estimation of pressure and saturation.  \n\nThis appendix shows an analysis similar to the one presented in paper 1, concerning \n\nthe details of the optimization, but highlighting the role of the constraints to improve the \n\n     113\n\n\n\nsolutions. To do this, one point of the model grid was selected, based on the inversion \n\nresults shown in Figure 6 of paper 4. In this sense, Figure C-1 displays a zoom in the region \n\nhighlighted with the red arrow in Figure 6 in paper 4; the error maps presented here are \n\nexactly the same; only the color scale has been modified. The point marked with a yellow \n\nstar was selected to perform the analysis of the objective function behavior, in order to \n\nunderstand the improvement seen, especially from Case 1 to Case 2. As stated in paper 4, \n\nthe sources of error for the inversion are: the wrong estimate of porosity and overburden \n\npressure and the presence of noise on seismic impedances. These errors are described in \n\nTable C-1 for this selected grid location. \n\nRemember that the only difference among these inversions is the definition of the \n\nsolution space due to new constraints. These differences are described in Table C-2, where \n\nthe constraints applied to the selected grid location for each of the inversions are displayed. \n\nNote that Cases 2 and 3 have the same values, because Case 3 corresponds to the estimated \n\nsaturation of Case 2 with the volume calibration. \n\n \nFigure C-1: Zoom in the water saturation errors presented in Figure 6 of paper 4. The point \n\nmarked with the yellow star was selected to analyze the objective function behavior of the \n\nthree inversions performed (Cases 1, 2 and 3). \n\nTable C-1: Data related to the point marked in Figure C-1. \n\n ??DIP \n\n(Kg/s x m\n2\n) \n\n??D IS \n\n(Kg/s x m\n2\n) \n\n?? P_over \n\n(MPa) \n\nInput for inversion  \n\n(with noise) \n212.98 x10\n\n3\n 285.71 x10\n\n3\n 0.0266 60 \n\nTrue value \n\n(without noise) \n232.30 x10\n\n3\n 242.94 x10\n\n3\n  0.0480 70 \n\nPercentage error (%) -9.07 14.97 -80.45 16.6 \n\n \n\n     114\n\n\n\nTable C-2: Definition of the solution space for the inversions analyzed here for the single \n\nlocation marked in Figure C-1. \n\n Sw Pre (MPa) \n\n Min Max Min Max \n\nCase 1 0.35 0.8 17.65 44.13 \n\nCase 2 0.36 0.57 21.24 23.97 \n\nCase 3 0.36 0.57 21.24 23.97 \n\nCase ApC 0 1 1 50 \n\n \n\nBesides the inversions shown in Figure C-1, another test was run as an illustrative \n\nexample, where the solution space is defined according to more general values: 0 ? Sw ? 1 \n\nand 1 ? Pre ? 50 (MPa). Here, this test is called ApC (appendix C). The results of this case \n\nare shown in Figure C-2. Following the same layout of the images of paper 1, Figure C-2a \n\nshows the objective function behavior and Figure C-2b the location inside the solution \n\nspace of the estimated values, the initial guess and true answer. This example clearly \n\ndemonstrates the fact that when errors are considered, such as those in Table C-1, the \n\nglobal minimum is displaced and it does not coincide with the true answer. \n\n \n\n \nFigure C-2: Inversion results for one grid block location (yellow star marked in Figure \n\nC-1) for Case ApC (Table C-1). (a) Possible values of the objective function. (b) Lower \n\nvalues of the objective function, where hot colors stand for higher values; initial guess \n\n(black cross), estimated (green circle) and true answer (magenta asterisk). \n\nIn the second inversion, the solution space is constrained with the values presented \n\nin paper 4 (Case 1 in Table C-2) that are defined by: Swc<Sw<1-Sor and PreProdMin \n\n<Pre<PreInjMax. The inversion behavior of this case is shown in Figure C-3. Note that, by \n\n     115\n\n\n\ncutting the solution space, the feasible values of pressure are closer to the expected value, \n\nwhich caused a better response of the optimization (compare the pressure values of Cases \n\nApC and 1 in Table C-3). \n\n \n\nFigure C-3: Inversion results for one grid block location (yellow star marked in Figure \n\nC-1); Case 1 in Figure C-1. The solution space is defined as Swc<Sw<1-Sor and PreProdMin \n\n<Pre<PreInjMax. (a) Possible values of the objective function. (b) Lower values of the \n\nobjective function, where hot colors stand for higher values; initial guess (black cross), \n\nestimated (green circle) and true answer (magenta asterisk). \n\nThe third inversion performed for the selected single location considered the \n\nsolution space of Case 2 in Table C-2. This means that the range for saturation and pressure \n\nare estimated by the methodology proposed in paper 2. Figure C-4 shows the results for this \n\ncase. Again, it can be observed that, as the solution space is stricter now, a better estimation \n\nis reached. \n\nTable C-3 summarizes all the inversion results discussed here. Note that the last row \n\ncorresponds to the third inversion performed with the volume calibration presented in paper \n\n4 (Case 3 in Table C-2). The last column corresponds to the norm of the error of the \n\nsolution found:  \n\nestimatedtrue\n\nestimatedtrue\n\nee\n\nSwSw\n\nPrPr\n\n)(100\n\n?\n\n?\n .    (B1) \n\n \n\n     116\n\n\n\nThe norm values indicate a gradual improvement obtained from the first inversion \n\n(assuming a general solution space) to the last case that considers a stricter and more \n\nconsistent range, together with the water volume calibration applied to Sw. \n\n \nFigure C-4: Inversion results for one grid block location (yellow star marked in Figure \n\nC-1); Case 2 in Figure C-1. The solution space is defined as Swc<Sw<1-Sor and \n\nPreProdMin&lt;Pre<PreInjMax. (a) Possible values of the objective function. (b) Lower \n\nvalues of the objective function, where hot colors stand for higher values; initial guess \n\n(black cross), estimated (green circle) and true answer (magenta asterisk). \n\nTable C-3: Summary of the inversion tests presented for the selected single block location. \n\n \nSw Pre (MPa) Norm \n\nTrue 0.3645 22.88 - \n\nCase ApC 0 1.47 42.27 \n\nCase 1 0.7630 17.70 40.18 \n\nCase 2 0.5690 21.20 20.52 \n\nCase 3  0.4310 21.20 6.86 \n\n \n\n2. History matching results: well curves \n\nThe discussions presented in paper 4, concerning the history matching process \n\napplied to the data, were focused on the improvement of the saturation map yielded from \n\nthe updated simulation model. To complement those results, this appendix displays the well \n\ncurves of the simulation model before and after the history matching. To tie these results \n\nwith paper 3 as well, the images below follow the same pattern of curves (color and style) \n\npresented in paper 3: \n\n     117\n\n\n\n1. History (red circles) \n\n2. Base model  (blue solid line): represents the initial model without any matching; \n\n3. Base + GL (black diamond):  base model after the global matching presented in \n\npaper 3. This model was used as input to perform the (local) history matching of \n\npaper 4.  \n\n4. LHM2 (dashed green): base model + GL after the local matching presented in paper \n\n3 that was called LHM2 in paper 4. \n\n5. LHM3 (yellow solid circles): base model + GL after the local matching that uses the \n\ncalibrated saturation map as input for the local history matching (paper 4). \n\nAs already mentioned in paper 4, after applying the local history matching (LHM3) \n\nslight changes were observed in the simulation results, before and after this matching. One \n\npoint to be highlighted is that the goal of the last paper was not to achieve the best history \n\nmatching, but to show that LHM3 was the best option among the three local history \n\nmatching presented there. In general, the well curves presented below show a relevant \n\nimprovement from the initial base model and the model after global matching. Then, small \n\nchanges are observed among the model after the global matching and the two models \n\nLHM2 and LHM3.  \n\nFigure C-5 shows the field water rate and average pressure. Observing the water \n\nrate curves, it can be said that the best model is LHM3, as it presents an excellent \n\nproduction forecast. For the average field pressure, in the history period, LHM3 also \n\nprovided the best match; in the forecast period, LHM2 and LHM3 have a similar \n\nperformance. \n\nThe curves for the individual wells are shown in Figures C-6 and C-7. As already \n\nmentioned, generally there are not significant differences among the models after the \n\nmatching. Some wells can be pointed out, where LHM3 performed better than LHM2 as, \n\nfor instance, the wells PROD5 and PROD6 of Figure C-6. \n\n     118\n\n\n\n \n\n \n\n \nFigure C-5: Top: field water rate (m3/day). Bottom: average reservoir pressure (Kgf/cm2). \n\n     119\n\n\n\n \n\n \nFigure C-6: Water rate (m3/day) for all producer wells. \n\n     120\n\n\n\n     121\n\n\n\n \nFigure C-7: Bottom-hole pressure (kgf/cm2) for all wells (injectors and producers). \n\n \n\n \n\n     122\n\n\n\tA01_Intro_part1\n\tA01_Intro_part2_FichaCatalog\n\tA01_Intro_part3_assinaturas\n\tA01_Intro_part4\n\tINTRODUCTION\n\t1.1. Motivation\n\t1.2. Objective\n\t1.3. Premises\n\t1.4. Description of the work \n\n\n\tB01_Paper1Merged\n\tB02_Paper2Merged\n\tB03_Paper3Merged\n\tB04_Paper4\n\tC02_Conclusion\n\tD1_APPENDIX_A_final\n\tD2_APPENDIX_B_final\n\tD3_APPENDIX_C_final\n\tBlank Page\n\tBlank Page\n\tBlank Page\n\tBlank Page\n\tBlank Page\n\tBlank Page\n\tBlank Page\n\tBlank Page\n\tBlank Page\n\tBlank Page\n\tBlank Page\n\tBlank Page\n\tBlank Page"}]}}}