{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.22710"}, {"@name": "filename", "#text": "6732_Ferraz_PaolaCunha_M.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "Paola Cunha Ferraz\n\nImplementa\u00e7\u00e3o de um algoritmo multi-escala para\n\nsistemas de equa\u00e7\u00f5es lineares de grande porte\n\nmal condicionados provenientes da discretiza\u00e7\u00e3o\n\nde problemas el\u00edpticos em din\u00e2mica de fluidos\n\nem meios porosos\n\nCAMPINAS\n2015\n\ni\n\n\n\nii\n\n\n\n\n\nFicha catalogr\u00e1fica\nUniversidade Estadual de Campinas\n\nBiblioteca do Instituto de Matem\u00e1tica, Estat\u00edstica e Computa\u00e7\u00e3o Cient\u00edfica\nMaria Fabiana Bezerra Muller - CRB 8/6162\n\n    \n  Ferraz, Paola Cunha, 1988-  \n F413i FerImplementa\u00e7\u00e3o de um algoritmo multi-escala para sistemas de equa\u00e7\u00f5es\n\nlineares de grande porte mal condicionados provenientes da discretiza\u00e7\u00e3o de\nproblemas el\u00edpticos em din\u00e2mica de fluidos em meios porosos / Paola Cunha\nFerraz. \u2013 Campinas, SP : [s.n.], 2015.\n\n \n\n   \n  FerOrientador: Eduardo Cardoso de Abreu.\n  FerDisserta\u00e7\u00e3o (mestrado) \u2013 Universidade Estadual de Campinas, Instituto de\n\nMatem\u00e1tica, Estat\u00edstica e Computa\u00e7\u00e3o Cient\u00edfica.\n \n\n    \n  Fer1. Meios porosos. 2. M\u00e9todos multigrid (An\u00e1lise num\u00e9rica). 3. Abordagem\n\nmultiescala. 4. Equa\u00e7\u00f5es diferenciais el\u00edpticas. 5. M\u00e9todos do gradiente\nconjugado. 6. M\u00e9todo dos elementos finitos. I. Abreu, Eduardo Cardoso de,1974-.\nII. Universidade Estadual de Campinas. Instituto de Matem\u00e1tica, Estat\u00edstica e\nComputa\u00e7\u00e3o Cient\u00edfica. III. T\u00edtulo.\n\n \n\nInforma\u00e7\u00f5es para Biblioteca Digital\n\nT\u00edtulo em outro idioma: Implementation of a multiscale algorithm for the solution of ill-\nconditioned large linear systems obtained by the discretization of elliptic problems in fluid\ndynamics\nPalavras-chave em ingl\u00eas:\nPorous media\nMultigrid methods (Numerical analysis)\nMultiscale approach\nElliptic differencial equations\nConjugate gradient methods\nFinite element method\n\u00c1rea de concentra\u00e7\u00e3o: Matem\u00e1tica Aplicada\nTitula\u00e7\u00e3o: Mestra em Matem\u00e1tica Aplicada\nBanca examinadora:\nEduardo Cardoso de Abreu [Orientador]\nSamuel Rocha de Oliveira\nF\u00e1bio Antonio Dorini\nData de defesa: 23-02-2015\nPrograma de P\u00f3s-Gradua\u00e7\u00e3o: Matem\u00e1tica Aplicada\n\nPowered by TCPDF (www.tcpdf.org)\n\niv\n\n\n\n\n\nvi\n\n\n\nAbstract\n\nThe focus of this work is the numerical approximation of differential problems involving partial\ndifferential equations (PDE\u2019s) of elliptic nature, in the context of modelling and simulation in\nfluid dynamics in porous media. The dissertation aims to contribute with an implementation\nof a multiscale multigrid algorithm, recently introduced in the literature, designed for solving\nill-conditioned large linear systems of equations derived from those classes of PDE\u2019s, typically\nassociated with Poisson problems of pressure-velocity with boundary conditions typical of flow\nin porous media. The Poisson problem discussed here is identified from the coupled convection-\ndiffusion transport system counterpart of PDE\u2019s, with dominated convection, and by a linearization\nby means the use of an operator splitting approach based on the physics of the underlying model.\nThe methodology used for the discretization of the Poisson elliptic problem is mixed hybrid finite\nelements. The numerical solution of the resulting linear system will be addressed by a multiscale\nmultigrid preconditioned conjugate gradient (PCG) method. We combine both methodologies\nin order to capture the distinct wavelengths associated with the different wavelengths from the\nassosiated self-adjoint Poisson operator, strongly influenced by the heterogeneity of the geological\nproperties of the porous media, in particular to the absolute permeability, which in turn might\nexhibit very large fluctuations of orders of magnitude. Numerical experiments in applications of\nfluid dynamics problems in porous media are presented and discussed for a verification of the\nresults obtained by direct numerical simulations with the multiscale multigrid algorithm under\nconsideration.\n\nKeywords: Multigrid Multiscale Method, Fluid Dynamics in Porous Media, Darcy\u2019s Flow,\nElliptic PDE, Mixed Hybrid Finite Element Method, Ill-conditioned Linear Systems, Precondioned\nConjugate Gradient Method.\n\nResumo\n\nO foco deste trabalho \u00e9 aproxima\u00e7\u00e3o num\u00e9rica de problemas envolvendo equa\u00e7\u00f5es diferenciais\nparciais (EDPs), de natureza el\u00edptica, no contexto de aplica\u00e7\u00f5es em din\u00e2mica de fluidos em meios\nporosos. Especificamente, a disserta\u00e7\u00e3o pretende contribuir com uma implementa\u00e7\u00e3o de um algo-\nritmo multiescala e multigrid, recentemente introduzido na literatura, para resolu\u00e7\u00e3o aproximada\nde sistemas de equa\u00e7\u00f5es lineares de grande porte e mal condicionados, proveniente dessa classe de\nEDPs, tipicamente associada a problemas de Poisson de press\u00e3o-velocidade com condi\u00e7\u00f5es de con-\ntornos t\u00edpicas de fluxo em meios porosos. O problema concreto de Poisson discutido neste trabalho\n\nvii\n\n\n\nser\u00e1 desacoplado do sistema de transporte de EDPs de convec\u00e7\u00e3o-difus\u00e3o, com convec\u00e7\u00e3o domi-\nnante, e linearizado por meio do emprego de uma t\u00e9cnica de decomposi\u00e7\u00e3o de operadores baseado\nna f\u00edsica do modelo subjacente. A metodologia para a discretiza\u00e7\u00e3o do problema el\u00edptico de Poisson\n\u00e9 elementos finitos mistos h\u00edbridos. A resolu\u00e7\u00e3o num\u00e9rica do sistema linear resultante deste proce-\ndimento ser\u00e1 realizado via um m\u00e9todo do tipo Gradientes Conjugados com Pr\u00e9-condicionamento\n(PCG) multiescala e multigrid. Combinamos as metodologias multiescala e multigrid de modo\na capturar os distintos comprimentos de onda associados aos diferentes comprimentos de onda\ndo operador diferencial auto-adjunto de Poisson, fortemente influenciado pela heterogeneidade das\npropriedades geol\u00f3gicas do meio poroso, em particular da permeabilidade absoluta, que pode exibir\nflutua\u00e7\u00f5es em v\u00e1rias ordens de grandeza. Experimentos computacionais em aplica\u00e7\u00f5es de proble-\nmas de din\u00e2mica de fluidos em meios porosos s\u00e3o apresentados e discutidos para verifica\u00e7\u00e3o dos\nresultados obtidos.\n\nPalavras-chave: M\u00e9todo multigrid multiescala, Din\u00e2mica de fluidos em meios porosos, Fluxo\nde Darcy, EDP el\u00edptica, M\u00e9todo de elementos finitos mistos h\u00edbridos, Sistemas lineares mal condi-\ncionados, Gradientes conjugados com pr\u00e9-condicionamento.\n\nviii\n\n\n\nSum\u00e1rio\n\nAgradecimentos xi\n\n1 Introdu\u00e7\u00e3o 1\n1.1 Motiva\u00e7\u00e3o da pesquisa . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1\n1.2 Objetivos espec\u00edficos e proposta de trabalho . . . . . . . . . . . . . . . . . . . . . . 3\n1.3 Temas desenvolvidos e resultados obtidos . . . . . . . . . . . . . . . . . . . . . . . . 4\n1.4 Organiza\u00e7\u00e3o da disserta\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11\n\n2 Modelagem matem\u00e1tica de fluxos multif\u00e1sicos em meios porosos heterog\u00eaneos 13\n2.1 Equa\u00e7\u00f5es fundamentais de escoamento com duas e tr\u00eas fases . . . . . . . . . . . . . 14\n\n2.1.1 Modelo de escoamento de tr\u00eas fases com gravidade . . . . . . . . . . . . . . 16\n2.1.2 Modelo de escoamento de duas fases com gravidade . . . . . . . . . . . . . . 18\n2.1.3 Modelo de escoamento de duas fases com gravidade e histerese . . . . . . . . 19\n\n2.2 O modelo do tra\u00e7ador passivo e da press\u00e3o global . . . . . . . . . . . . . . . . . . . 21\n2.2.1 Tra\u00e7ador passivo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21\n2.2.2 A formula\u00e7\u00e3o da press\u00e3o global . . . . . . . . . . . . . . . . . . . . . . . . . 21\n\n3 Modelagem computacional das equa\u00e7\u00f5es governantes em fen\u00f4menos de trans-\nporte em meios porosos heterog\u00eaneos 25\n3.1 Decomposi\u00e7\u00e3o de operadores . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26\n\n4 Aproxima\u00e7\u00e3o num\u00e9rica das equa\u00e7\u00f5es diferenciais parciais governantes 29\n4.1 Discretiza\u00e7\u00e3o do sistema parab\u00f3lico e hiperb\u00f3lico de EDPs associado ao problema\n\nde transporte de convec\u00e7\u00e3o-difus\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n4.2 Discretiza\u00e7\u00e3o por elementos finitos mistos da EDP el\u00edptica associada ao problema\n\nde press\u00e3o e velocidade . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31\n4.2.1 Elementos Finitos Mistos H\u00edbridos . . . . . . . . . . . . . . . . . . . . . . . 33\n4.2.2 Equa\u00e7\u00f5es discretas e elimina\u00e7\u00e3o do multiplicadores de Lagrange e fluxos. . . 35\n\n5 Resolu\u00e7\u00e3o do sistema linear associado ao problema el\u00edptico 39\n5.1 Gradientes Conjugados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40\n\n5.1.1 Precondicionadores . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41\n5.2 O M\u00e9todo Multigrid . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42\n\n5.2.1 M\u00e9todos de relaxa\u00e7\u00e3o e a propriedade de smoothing . . . . . . . . . . . . . . 43\n\nix\n\n\n\n5.2.2 A estrutura do M\u00e9todo Multigrid . . . . . . . . . . . . . . . . . . . . . . . . 46\n5.2.3 O Multigrid como Pr\u00e9-condicionador . . . . . . . . . . . . . . . . . . . . . . 48\n5.2.4 Outra maneira de derivar o pr\u00e9-condicionador multigrid . . . . . . . . . . . . 49\n\n5.3 Gradientes conjugados com pr\u00e9-condicionador multiescala recursivo . . . . . . . . . 50\n5.4 Implementa\u00e7\u00e3o do m\u00e9todo dos gradientes conjugados com pr\u00e9-condicionador multi-\n\nescala recursivo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51\n5.4.1 Aproxima\u00e7\u00e3o da permeabilidade na malha . . . . . . . . . . . . . . . . . . . 53\n5.4.2 Smoother . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53\n5.4.3 Operadores de Restri\u00e7\u00e3o e Prolonga\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . 54\n5.4.4 Crit\u00e9rio de Parada . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56\n\n6 Experimentos num\u00e9ricos para problemas el\u00edpticos de Poisson em geometrias de\naplica\u00e7\u00f5es 59\n6.1 Press\u00e3o-fluxo slab Dirichlet-Dirichlet . . . . . . . . . . . . . . . . . . . . . . . . . . 61\n6.2 Fluxo slab Neumann-Dirichlet . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67\n6.3 Geometria 1/4 de five-spot . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71\n\n7 Conclus\u00f5es e Perspectivas 77\n7.1 Conclus\u00f5es . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77\n7.2 Perspectivas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78\n7.3 Considera\u00e7\u00f5es finais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79\n\nRefer\u00eancias 81\n\nA Elimina\u00e7\u00e3o dos multiplicadores de Lagrange 93\n\nB A computational multiscale approach for incompressible two-phase flow in he-\nterogeneous porous media including relative permeability hysteresis 95\nB.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95\nB.2 Computational Modeling with Hysteresis . . . . . . . . . . . . . . . . . . . . . . . . 97\nB.3 Continuous-time mixed finite element approximations to the Ellipitc and Parabolic\n\nproblems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99\nB.3.1 Discretization of the Poisson-elliptic problem . . . . . . . . . . . . . . . . . . 99\nB.3.2 A multigrid multiscale preconditioner method for the discretized coupled\n\nnonlinear Poisson-elliptic problem . . . . . . . . . . . . . . . . . . . . . . . . 100\nB.3.3 A combined domain decomposition with mixed fiment method formulation\n\nfor diffusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102\nB.4 Two-dimensional numerical experiments . . . . . . . . . . . . . . . . . . . . . . . . 103\n\nB.4.1 Numerical experiments with hysteresis and slab geometry . . . . . . . . . . . 103\nB.4.2 Purelly Poisson pressure-velocity numerical experiments . . . . . . . . . . . . 106\n\nB.5 Concluding remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107\n\nx\n\n\n\nAgradecimentos\n\nPrimeiramente gostaria de agradecer a toda minha fam\u00edlia por sempre me apoiarem em to-\ndos esses anos de estudo, principalmente a Paloma C. Ferraz pela companhia e ajuda durante a\nelabora\u00e7\u00e3o desse trabalho.\n\nAgrade\u00e7o especialmente meu orientador, Eduardo Cardoso de Abreu, por sempre acreditar em\nmim, me motivar e me desafiar a ser uma pesquisadora e pessoa melhor.\n\nAgrade\u00e7o os meus irm\u00e3os de orienta\u00e7\u00e3o pela ajuda, pelo entendimento e por compartilharem\ncomigo todo o sofrimento e alegria de ser um p\u00f3s-graduando.\n\nAgrade\u00e7o demais a todos os meus amigos desses anos de unicamp, que me apoiram, riram\ncomigo, choraram comigo, e que estar\u00e3o sempre no meu cora\u00e7\u00e3o.\n\nAgrade\u00e7o tamb\u00e9m aos professores Samuel Oliveira e Fabio Dorini pela leitura e criticas cons-\ntrutivas que levaram a aprimora\u00e7\u00e3o da vers\u00e3o final do texto.\n\nEu, Paola Ferraz, tamb\u00e9m agrade\u00e7o o apoio da Coordena\u00e7\u00e3o de Aperfei\u00e7oamento de Pessoal\nde N\u00edvel Superior (CAPES), juntamente com o Programa de P\u00f3s-Gradua\u00e7\u00e3o em Matem\u00e1tica Apli-\ncada e Computacional do IMECC/UNICAMP, pelo apoio via uma bolsa institucional CAPES de\nMestrado, no per\u00edodo de 03/2013 at\u00e9 02/2015.\n\nAgrade\u00e7o tamb\u00e9m o apoio da Funda\u00e7\u00e3o de Amparo a Pesquisa do Estado de S\u00e3o Paulo - FA-\nPESP - pelo suporte aos projetos No. 2014/03204-9, No. 2011/11897-6, No. 2012/19874-8 e\nNo. 2011/23628-0, a UNICAMP/FAEPEX (Fundo de Apoio ao Ensino, \u00e0 Pesquisa e Extens\u00e3o)\npelo suporte ao projeto 519.292-785/11, e ao Conselho Nacional de Desenvolvimento Cient\u00edfico\ne Tecnol\u00f3gico (CNPq) pelo suporte ao projeto 445758/2014-7, todos de responsabilidade de meu\nOrientador Professor Eduardo Cardoso de Abreu. Estes projetos viabilizaram a compra de equi-\npamentos computacionais com os quais foi poss\u00edvel realizar um grande conjunto de simula\u00e7\u00f5es\nnum\u00e9ricas, bem como sua an\u00e1lise, e que fazem parte integrante da presente disserta\u00e7\u00e3o de mes-\ntrado.\n\nxi\n\n\n\nxii\n\n\n\nCap\u00edtulo 1\n\nIntrodu\u00e7\u00e3o\n\nO tema cient\u00edfico deste trabalho de mestrado consiste na implementa\u00e7\u00e3o computacional de um\nalgoritmo multiescala recursivo para resolu\u00e7\u00e3o de sistemas de equa\u00e7\u00f5es lineares de grande porte\nmal condicionados provenientes da discretiza\u00e7\u00e3o de problemas el\u00edpticos em din\u00e2mica de fluidos\nem meios porosos. Neste trabalho a discuss\u00e3o da decomposi\u00e7\u00e3o de operadores \u00e9 motivada para\nidentificar o problema de Poisson a ser resolvido, que \u00e9 o foco principal desta disserta\u00e7\u00e3o. Es-\npecificamente, no presente trabalho ser\u00e1 adotado uma abordagem de discretiza\u00e7\u00e3o via Elementos\nFinitos Mistos H\u00edbridos do problema de Poisson, em espa\u00e7os ?(???) de Raviart-Thomas, resul-\ntando em um problema de \u00e1lgebra linear cuja matriz associada \u00e9 sim\u00e9trica definida positiva e,\nportanto, naturalmente consistente com o problema diferencial el\u00edptico auto-adjunto. Tal abor-\ndagem \u00e9 justificada pelo bom desempenho na aproxima\u00e7\u00e3o num\u00e9rica e simula\u00e7\u00e3o de escoamentos\nbif\u00e1sicos \u00e1gua-\u00f3leo e problemas trif\u00e1sicos [65, 83, 69, 84, 138, 2, 6, 14, 8, 5, 4, 11, 7, 13, 10,\n9]. Desta maneira, ser\u00e1 explorado uma formula\u00e7\u00e3o iterativa do m\u00e9todo dos gradientes conjugados\ncom pr\u00e9-condicionador para a resolu\u00e7\u00e3o num\u00e9rica do sistema linear proveniente da discretiza\u00e7\u00e3o do\nproblema de Poisson. Em linhas gerais, o escopo deste trabalho de mestrado abrange modelagem\nmatem\u00e1tica, an\u00e1lise num\u00e9rica e simula\u00e7\u00e3o computacional para a resolu\u00e7\u00e3o num\u00e9rica de modelos\nde EDPs n\u00e3o lineares, exibindo coeficientes descont\u00ednuos com r\u00e1pida varia\u00e7\u00e3o, para auxiliar no\nentendimento f\u00edsico/matem\u00e1tico da din\u00e2mica n\u00e3o linear do fluxo de fluidos em reservat\u00f3rios e\naqu\u00edferos.\n\n1.1 Motiva\u00e7\u00e3o da pesquisa\nProblemas de transporte de fluidos em meios porosos s\u00e3o modelados por equa\u00e7\u00f5es diferenciais\n\ne derivadas parciais (EDPs) n\u00e3o lineares. Desta forma o desenvolvimento e a an\u00e1lise num\u00e9rica\nde algoritmos precisos e eficientes constituem uma alternativa ao entendimento matem\u00e1tico da\ndin\u00e2mica n\u00e3o linear destas EDPs. Do ponto de visto matem\u00e1tico o desafio fundamental consiste\nno entendimento do mapeamento n\u00e3o linear que leva a micro-f\u00edsica, posta na escala de cent\u00edmetros,\nat\u00e9 a macro-f\u00edsica, posta na escala real de campo de dezenas de metros, que \u00e9 mais adequada\npara uma descri\u00e7\u00e3o destes problemas em din\u00e2mica de fluidos em meios porosos heterog\u00eaneos e de\nnatureza multiescala. Do ponto de vista de aplica\u00e7\u00f5es pr\u00e1ticas podemos citar recursos energ\u00e9ticos\n\n1\n\n\n\ne h\u00eddricos no meio ambiente. Por exemplo, o tema exibe certo potencial no contexto de captura\nde CO2, diretamente de fontes emissoras, como termo-el\u00e9tricas, e sua inje\u00e7\u00e3o (em estado super-\ncr\u00edtico, com elevada compress\u00e3o) em reservat\u00f3rios ultraprofundos e com elevada concentra\u00e7\u00e3o de\nsais minerais, tipicamente de alto custo de tratamento para o consumo humano. Al\u00e9m disso,\nexiste uma potencial aplica\u00e7\u00e3o em territ\u00f3rio brasileiro, no contexto do aumento da produ\u00e7\u00e3o de\npetr\u00f3leo, como aqueles na camada pr\u00e9-sal ao longo da costa brasileira (e.g., bacia de Santos).\nA ideia b\u00e1sica aqui \u00e9 a reinje\u00e7\u00e3o de hidrocarbonetos leves (g\u00e1s) in-situ. Devido a sua afinidade\ncom o hidrocarboneto pesado (petr\u00f3leo), espera-se um aumento na mobilidade das fases fluidas\npara uma maior recupera\u00e7\u00e3o de petr\u00f3leo, ou seja, aumento da produ\u00e7\u00e3o. Em uma percep\u00e7\u00e3o\nextremamente muito otimista, o armazenamento de CO2 pode ser visto como um mecanismo\nvi\u00e1vel para a mitiga\u00e7\u00e3o parcial, e controlada, das emiss\u00f5es de gases poluentes ao meio ambiente,\npromovendo nesse contexto um efeito ben\u00e9fico de conten\u00e7\u00e3o \u00e0s mudan\u00e7as clim\u00e1ticas.\n\nEm mais detalhes, ainda no contexto de motiva\u00e7\u00e3o em matem\u00e1tica aplicada e computa\u00e7\u00e3o ci-\nent\u00edfica, este projeto abrange modelagem matem\u00e1tica, an\u00e1lise num\u00e9rica e simula\u00e7\u00e3o computacional\npara a resolu\u00e7\u00e3o num\u00e9rica de modelos de EDPs n\u00e3o lineares, exibindo coeficientes descont\u00ednuos\ncom r\u00e1pida varia\u00e7\u00e3o, para auxiliar no entendimento fisico/matem\u00e1tico da din\u00e2mica n\u00e3o linear do\nfluxo de fluidos em reservat\u00f3rios e aqu\u00edferos. A compreens\u00e3o matem\u00e1tica da din\u00e2mica do escoa-\nmento de v\u00e1rias fases fluidas em meios porosos em fen\u00f4menos de transporte \u00e9 muito importante\nem diversos contextos, tanto no aspecto matem\u00e1tico puro das EDPs (exist\u00eancia, unicidade e regu-\nlaridade de solu\u00e7\u00f5es) como em an\u00e1lise num\u00e9rica [6, 5, 14, 77, 104, 56, 115, 110, 113, 143, 103] e\naplica\u00e7\u00f5es [60, 59, 4, 2, 6], como recursos energ\u00e9ticos e meio ambiente (e.g., reservat\u00f3rios de petr\u00f3-\nleo [13, 76] monitoramento de aqu\u00edferos [101] e solos contaminados [59]). Existem muitos desafios\ne dificuldades para a modelagem matem\u00e1tica e an\u00e1lise num\u00e9rica de EDPs que governam escoa-\nmentos multif\u00e1sicos complexos em meios porosos (veja, e.g., [103, 60, 13, 59, 101]). Uma grande\ndificuldade adv\u00e9m do seu inerente car\u00e1ter multiescala devido as heterogeneidades de propriedades\ngeol\u00f3gicas da rocha que comp\u00f5e o reservat\u00f3rio (e.g., \u201cpermeabilidade ?(x)\u201d e \u201cporosidade ?(x)\u201d)\nque s\u00e3o modelados no sistema governante de EDPs como coeficientes descont\u00ednuos com r\u00e1pida va-\nria\u00e7\u00e3o [76, 59]. Al\u00e9m disso, solu\u00e7\u00f5es anal\u00edticas s\u00e3o muito dif\u00edceis (e.g., [60, 76, 89, 104, 56, 77, 121,\n110]), sen\u00e3o imposs\u00edveis, de serem obtidas com as t\u00e9cnicas tradicionais devido tamb\u00e9m \u00e0 natureza\nmatem\u00e1tica n\u00e3o linear destas EDPs, como por exemplo, modelos de EDPs de tipo misto el\u00edptico,\nhiperb\u00f3lico e parab\u00f3lico. Assim, a an\u00e1lise num\u00e9rica de algoritmos \u00e9 uma alternativa (adicional)\nao entendimento matem\u00e1tico desses modelos de EDPs. Do ponto de vista cient\u00edfico, os t\u00f3picos\nde modelagem matem\u00e1tica e an\u00e1lise num\u00e9rica abordados neste projeto s\u00e3o convergentes para uma\ninvestiga\u00e7\u00e3o em base matem\u00e1tica s\u00f3lida do problema de mapeamento (transfer\u00eancia de escalas) de\nEDPs n\u00e3o-lineares em meios porosos (e.g., [89, 59]).\n\nDo ponto de vista tecnol\u00f3gico, os resultados esperados s\u00e3o de potencial relev\u00e2ncia para o\ndesenvolvimento de t\u00e9cnicas para o aumento de produ\u00e7\u00e3o de petr\u00f3leo, \u00e1rea estrat\u00e9gica para a\neconomia do Brasil, e para o estado de S\u00e3o Paulo (e.g., \u00e1rea do pr\u00e9-sal na bacia de Santos) e para a\npreserva\u00e7\u00e3o do meio ambiente, permitindo o monitoramento do transporte de poluentes no subsolo\ne em aqu\u00edferos. De fato, os campos interligados de matem\u00e1tica aplicada e computacional abrangem\nmodelagem, desenvolvimento e an\u00e1lise de algoritmos num\u00e9ricos e simula\u00e7\u00e3o para problemas que\nsurgem na ci\u00eancia pura e na ind\u00fastria, como por exemplo, o entendimento refinado de propriedades\nn\u00e3o lineares de modelos matem\u00e1ticos como os discutidos neste projeto e que ocorrem de forma\n\n2\n\n\n\nsimilar na f\u00edsica, qu\u00edmica, biologia, geologia, astronomia, ci\u00eancia de materiais, mec\u00e2nica dos fluidos,\ne em um bom n\u00famero de outras disciplinas (e.g., [60, 86, 101, 121, 115, 104, 103, 76, 59, 13]).\nEste Trabalho abrange modelagem e solu\u00e7\u00e3o num\u00e9rica de EDPs n\u00e3o lineares com o potencial de\naplica\u00e7\u00e3o em problemas cient\u00edficos e tecnol\u00f3gicos no meio ambiente e em recursos energ\u00e9ticos, ou\nseja,\n\n\u2022 mudan\u00e7a clim\u00e1tica e conten\u00e7\u00e3o do aquecimento global via captura e sequestramento de CO2\nem reservat\u00f3rios petrol\u00edferos e em aqu\u00edferos com elevada concentra\u00e7\u00e3o de sal (\u00e1gua n\u00e3o po-\nt\u00e1vel) [58, 43, 45, 81, 16, 90, 111, 93];\n\n\u2022 remedia\u00e7\u00e3o em subsolos contaminados por fases l\u00edquidas n\u00e3o aquosas [43, 45, 81, 16, 90, 111,\n93];\n\n\u2022 recupera\u00e7\u00e3o avan\u00e7ada de hidrocarbonetos em reservat\u00f3rios petrol\u00edferos, incluindo aqueles na\ncamada pr\u00e9-sal [58, 81, 16, 90, 111, 44, 29, 2, 4, 11, 13, 76];\n\n\u2022 o problema de transfer\u00eancia de escalas \u00e9 um tema de car\u00e1ter cient\u00edfico b\u00e1sico, que est\u00e1 em-\nbutido naturalmente nos tr\u00eas t\u00f3picos anteriores, ver, e.g., [123, 81, 76, 89, 95, 97, 94].\n\n1.2 Objetivos espec\u00edficos e proposta de trabalho\nO presente trabalho destina-se a implementa\u00e7\u00e3o de um algoritmo multiescala, recentemente\n\nintroduzido na literatura, para resolu\u00e7\u00e3o de sistemas de equa\u00e7\u00f5es lineares de grande porte mal\ncondicionados provenientes da discretiza\u00e7\u00e3o de problemas el\u00edpticos em din\u00e2mica de fluidos em\nmeios porosos.\n\nOs objetivos deste trabalho s\u00e3o:\n\n\u2022 Apresentar um novo m\u00e9todo multiescala recursivo para a resolu\u00e7\u00e3o de problemas de naturesza\nel\u00edptica no contexto de escoamento de fluidos em meios porosos heterog\u00eaneos. Esse m\u00e9todo foi\nprimeiramente introduzido no trabalho de Klaus Lackner e Ralph Menikoff [115], \u201cMultiscale\nLinear Solvers for Very Large Systems Derived from PDES\u201d, publicado em SIAM Journal\non Scientific Computing (2000), e faz uso das propriedades multiescala do meio poroso. O\nm\u00e9todo multiescala recursivo baseia-se na decomposi\u00e7\u00e3o espectral e combina gradientes con-\njugados, m\u00e9todos multigrid e m\u00e9todos iterativos em um \u00fanico algortimo. Essencialmente\ncombinamos o m\u00e9todo dos gradientes conjugados com um pr\u00e9-condicionador dado por uma\nitera\u00e7\u00e3o do m\u00e9todo multigrid combinado novamente com gradientes conjugados. M\u00e9todos\nmultigrid tipicamente tiram vantagens de aspectos multiescala do modelo, usando diferentes\nmalhas para aproximar a solu\u00e7\u00e3o do sistema linear e, dessa forma, levam em conta a varia-\nbilidade associada a geologia do meio poroso, como a permeabilidade e porosidade. A nova\nmetodologia combina t\u00e9cnicas que se mostraram apropriadas para a aproxima\u00e7\u00e3o num\u00e9rica\nde problemas de Poisson, e em conjunto com uma estrat\u00e9gia de decomposi\u00e7\u00e3o de operado-\nres, esta metodologia pode ser empregada em problemas de escoamento de fluidos em meios\nporosos heterog\u00eaneos, tanto bif\u00e1sicos quanto trif\u00e1sicos.\n\n3\n\n\n\n\u2022 Enfatizamos diversas situa\u00e7\u00f5es relevantes em aplica\u00e7\u00f5es de din\u00e2mica de fluidos em meios\nporosos onde \u00e9 natural identificar o problema modelo diferencial de Poisson associado ao\nc\u00e1lculo do problema de press\u00e3o-velocidade. Para melhor exemplificar uma ampla classe de\nproblemas em escoamento de fluidos em meios porosos que envolvem, em sua modelagem, um\nproblema de natureza el\u00edptica, consideramos sistemas governantes de modelos incompress\u00edveis\ne imisc\u00edceis, trif\u00e1sico e bif\u00e1sico, expressos na formula\u00e7\u00e3o de fase. Essa formula\u00e7\u00e3o \u00e9 mais geral\ncom rela\u00e7\u00e3o a forma das equa\u00e7\u00f5es englobando, entre outros, problemas bif\u00e1sicos, trif\u00e1sicos,\ne problemas bif\u00e1sicos com a introdu\u00e7\u00e3o do par\u00e2metro de histerese, em uma, duas e tr\u00eas\ndimens\u00f5es espaciais.\n\n\u2022 Apresentamos um estudo e aplica\u00e7\u00e3o de uma estrat\u00e9gia para identificar e discretizar o pro-\nblema de Poisson associado a um modelo de din\u00e2mica de fluidos em meios porosos heterog\u00ea-\nneos bidimensionais e que levam em conta efeitos de histerese. Combinamos uma t\u00e9cnica de\ndecomposi\u00e7\u00e3o de operadores, baseada na f\u00edsica, com Elementos Finitos Mistos H\u00edbridos para\ndiscretizar a EDP el\u00edptica, representada pelo problema de press\u00e3o-velocidade, e obter um\nsistema linear com boas propriedades. Tal abordagem \u00e9 justificada pelo bom desempenho na\naproxima\u00e7\u00e3o num\u00e9rica e simula\u00e7\u00e3o de escoamentos bif\u00e1sicos \u00e1gua-\u00f3leo e problemas trif\u00e1sicos,\ndentro da tradi\u00e7\u00e3o estabelecida por Jim Douglas Jr., Richard Ewing, Thomas F. Russell e\nMary F. [65, 83, 69, 84, 138]. Por fim, o m\u00e9todo multiescala recursivo \u00e9 usado para obter a\nsolu\u00e7\u00e3o num\u00e9rica do sistema linear proveniente da discretiza\u00e7\u00e3o.\n\n\u2022 Implementa\u00e7\u00e3o do m\u00e9todo apresentado. O m\u00e9todo multiescala recursivo foi implementado\nna linguagem C pura e mostrou-se acurado. Obtivemos solu\u00e7\u00f5es para problemas de Poisson\nem duas dimens\u00f5es e o algoritmo se comportou como indicado na literatura [115].\n\n1.3 Temas desenvolvidos e resultados obtidos\nT\u00e9cnicas de decomposi\u00e7\u00e3o de operadores visando a aproxima\u00e7\u00e3o de operadores diferenciais\n\n(sistemas de equa\u00e7\u00f5es diferenciais parciais), concomitantemente com a componente de efici\u00eancia\ncomputacional, tem sido frequentemente empregadas em problemas de simula\u00e7\u00e3o de escoamentos\nde fluidos em problemas de din\u00e2mica de fluidos em meios porosos, como em aqu\u00edferos naturais e em\nreservat\u00f3rios petrol\u00edferos, particularmente em problemas de escoamentos monof\u00e1sicos e bif\u00e1sicos;\nveja alguns trabalhos relevantes na \u00e1rea de din\u00e2mica de fluidos bem como as refer\u00eancias l\u00e1 citadas\n[80, 104, 86, 123, 76, 89, 17, 73, 61, 111, 65]. Em linhas gerais, ao inv\u00e9s de se resolver o sistema\noriginal de equa\u00e7\u00f5es diferenciais na forma que resulta diretamente das leis b\u00e1sicas de conserva\u00e7\u00e3o,\nsuplementada por rela\u00e7\u00f5es constitutivas (que tipicamente s\u00e3o obtidas por experimentos de labo-\nrat\u00f3rio), o sistema de equa\u00e7\u00f5es \u00e9 reescrito para exibir claramente a sua natureza matem\u00e1tica, ou\nseja, na forma de modelos hiperb\u00f3lico, parab\u00f3lico, el\u00edptico ou misto no contexto de classifica\u00e7\u00e3o\n(local) de EDPs. Desta maneira, t\u00e9cnicas num\u00e9ricas distintas e apropriadas podem ser emprega-\ndas, dentro da formula\u00e7\u00e3o de decomposi\u00e7\u00e3o de operadores, para fornecer procedimentos num\u00e9ricos\neficientes projetados para resolver equa\u00e7\u00f5es diferenciais parciais que desenvolvem em suas solu\u00e7\u00f5es\nchoques e gradientes abruptos e tamb\u00e9m para capturar as complexas din\u00e2micas do escoamento\n\n4\n\n\n\nque evoluem nas mais diferentes taxas que tipicamente ocorrem em problemas de fluxo multif\u00e1sico\nem reservat\u00f3rios heterog\u00eaneos.\n\nNeste trabalho a discuss\u00e3o da decomposi\u00e7\u00e3o de operadores \u00e9 motivada para identificar o pro-\nblema de Poisson a ser resolvido, que \u00e9 o foco principal desta disserta\u00e7\u00e3o. T\u00e9cnicas de decomposi\u00e7\u00e3o\nde operadores constituem uma das principais pontes entre an\u00e1lise num\u00e9rica e an\u00e1lise funcional.\nEm an\u00e1lise num\u00e9rica, as t\u00e9cnicas de decomposi\u00e7\u00e3o de operadores representam algoritmos num\u00e9-\nricos eficientes com o objetivo de aproximar de maneira precisa equa\u00e7\u00f5es e sistemas de equa\u00e7\u00f5es\ndiferenciais de evolu\u00e7\u00e3o temporal de uma forma computacionalmente conveniente para incorporar\nefeitos f\u00edsicos distintos. Em an\u00e1lise funcional, essas t\u00e9cnicas s\u00e3o usadas para a demonstra\u00e7\u00e3o de\nestimativas de erro, exist\u00eancia de solu\u00e7\u00e3o e teoremas de representa\u00e7\u00e3o. Os artigos [80, 57, 144]\ndiscutem os usos da t\u00e9cnica de decomposi\u00e7\u00e3o de operadores e indicam uma grande variedade de\nrefer\u00eancias na literatura. Veja tamb\u00e9m os trabalhos [109, 63, 107, 108, 86, 110, 104, 56, 4, 5, 8,\n2] para desenvolvimentos recentes na an\u00e1lise dos erros presentes na decomposi\u00e7\u00e3o de operadores\n(time-splitting errors) para problemas unidimensionais n\u00e3o lineares de convec\u00e7\u00e3o-difus\u00e3o.\n\nCumpre mencionar, ainda, que para a introdu\u00e7\u00e3o da decomposi\u00e7\u00e3o de operadores, considera-\nse o sistema governante de modelos incompess\u00edveis e imisc\u00edveis (bif\u00e1sico e trif\u00e1sico) expresso na\nformula\u00e7\u00e3o de fase, na qual as equa\u00e7\u00f5es diferenciais governantes s\u00e3o escritas em termos de uma\npress\u00e3o de refer\u00eancia com respeito a uma das fases presentes no escoamento de duas equa\u00e7\u00f5es\npara o transporte das satura\u00e7\u00f5es das fases [2]. Essencialmente, tal formula\u00e7\u00e3o \u00e9 mais geral para o\nprop\u00f3sito de desenvolvimento de ferramentas de aproxima\u00e7\u00e3o e simula\u00e7\u00e3o de transporte de fluidos\nem meios porosos heterog\u00eaneos em m\u00faltiplas escalas. Para um maior aprofundamento sobre esse\naspecto espec\u00edfico no contexto de escoamentos trif\u00e1sicos indica-se ao leitor interessado as refer\u00eancias\n[2, 31, 33, 106, 15, 49, 54].\n\nA t\u00e9cnica de decomposi\u00e7\u00e3o de operadores discutida aqui permite que o passo de tempo para\na atualiza\u00e7\u00e3o do campo de velocidades no c\u00e1lculo do problema de press\u00e3o-velocidade seja maior\ndo que aquele para o c\u00e1lculo do problema de difus\u00e3o, que, por sua vez, pode ser maior do que o\npasso de tempo usado no c\u00e1lculo que incorpora os efeitos de convec\u00e7\u00e3o dos fluidos. Primeiramente,\ndecomp\u00f5e-se o c\u00e1lculo do problema de press\u00e3o-velocidade (sub-problema el\u00edptico) do c\u00e1lculo do\nproblema de transporte das satura\u00e7\u00f5es (1? n\u00edvel) e, ent\u00e3o, decomp\u00f5e-se o c\u00e1lculo das satura\u00e7\u00f5es\nem transporte convectivo e transporte difusivo (2? n\u00edvel). Desta maneira, tr\u00eas passos de tempo s\u00e3o\nnaturalmente introduzidos na decomposi\u00e7\u00e3o de operadores: ??? para a solu\u00e7\u00e3o do problema hiper-\nb\u00f3lico associado ao transporte convectivo dos fluidos, ??? para o c\u00e1lculo dos efeitos difusivos e ???\npara o c\u00e1lculo do problema de press\u00e3o-velocidade. Desta maneira, em uma aplica\u00e7\u00e3o \u201cm\u00e1xima\u201d\nda t\u00e9cnica de decomposi\u00e7\u00e3o, temos especificamente tr\u00eas sub-problemas que devem ser resolvi-\ndos sequencialmente: o sub-problema el\u00edptico de Poisson de press\u00e3o-velocidade, o sub-problema\nhiperb\u00f3lico de convec\u00e7\u00e3o e o sub-problema parab\u00f3lico de difus\u00e3o. Os problemas hiperb\u00f3lico e\nparab\u00f3lico n\u00e3o ser\u00e3o tratados nesse trabalho. Para os leitores interessados na aproxima\u00e7\u00e3o desses\nsub-problemas no contexto de din\u00e2mica de fluidos aqui discutidos indica-se os trabalhos [2, 6, 14,\n8, 5, 4, 11, 7, 13, 89, 22, 21, 73, 72, 71, 24, 18].\n\nExistem v\u00e1rias metodologias na literatura para aproxima\u00e7\u00e3o de EDPs. Fundamentalmente,\nessa escolha deve ser guiada pela natureza matem\u00e1tica do modelo diferencial sob investiga\u00e7\u00e3o\ntendo em vista que se espera obter, ou melhor, recuperar no n\u00edvel discreto, as mesmas propri-\nedades f\u00edsica e matem\u00e1tica do modelo original posto no cont\u00ednuo. Isso \u00e9 igualmente v\u00e1lido, em\n\n5\n\n\n\nparticular, para problemas el\u00edpticos de segunda ordem de Poisson associados a problemas de valor\nde contorno, mesmo que resultantes de um procedimento de decomposi\u00e7\u00e3o de operadores, como\nmencionado anteriormente. Neste contexto, pode-se citar v\u00e1rias t\u00e9cnicas para discretiza\u00e7\u00e3o de\nproblemas el\u00edpticos, como por exemplo, Diferen\u00e7as Finitas [147, 140], Volumes Finitos [74, 153],\nDiferen\u00e7as finitas mim\u00e9ticas (ou Mimetic finite differences) [119, 28, 40, 140], Elementos Finitos\n(cl\u00e1ssico) [39], Elementos Finitos da classe Galerkin Descont\u00ednuo [67, 23, 134], Elementos Finitos\nMistos H\u00edbridos em espa\u00e7os ?(???) [136, 137, 41] entre outros, como elementos finitos generaliza-\ndos [26]. No presente trabalho adota-se a abordagem de discretiza\u00e7\u00e3o Elementos Finitos Mistos\nH\u00edbridos em espa\u00e7os ?(???) de Raviart-Thomas [136, 137, 41], motivado fundamentalmente pela\nsua bem sucedida aplica\u00e7\u00e3o em problemas trif\u00e1sicos [2, 6, 14, 8, 5, 4, 11, 7, 13, 10, 9] e previamente\npelo bom desempenho na aproxima\u00e7\u00e3o num\u00e9rica e simula\u00e7\u00e3o de escoamentos bif\u00e1sicos \u00e1gua-\u00f3leo,\ndentro da tradi\u00e7\u00e3o estabelecida por Jim Douglas Jr., Richard Ewing, Thomas F. Russell e Mary F.\nWheeler nos trabalhos conjuntos [65, 83, 69, 84, 138] e mais recentemente nos trabalhos [7, 9, 18,\n73, 72, 71] e nas refer\u00eancias l\u00e1 citadas. Nesta s\u00e9rie de trabalhos, elementos finitos mistos h\u00edbridos\nforam identificados como muito apropriados para o c\u00e1lculo de campos de velocidade precisos na\npresen\u00e7a de heterogeneidades geol\u00f3gicas abruptas dos campos de porosidade e permeabilidade.\nAl\u00e9m disso, \u00e9 v\u00e1lido sempre mencionar que a formula\u00e7\u00e3o de elementos finitos mistos h\u00edbridos pos-\nsui uma rigorosa fundamenta\u00e7\u00e3o matem\u00e1tica e em conex\u00e3o refinada com distintas abordagens em\nan\u00e1lise num\u00e9rica para problemas el\u00edpticos [136, 137, 41, 39, 23, 153, 28].\n\nA ideia b\u00e1sica de m\u00e9todos mistos no contexto de escoamento de fluidos em meios porosos \u00e9\nde aproximar a press\u00e3o e o campo de velocidades simultaneamente. Para garantir a exist\u00eancia de\nsolu\u00e7\u00e3o do problema misto, \u00e9 import\u00e2nte que o problema satisfa\u00e7a a coercividade e a condi\u00e7\u00e3o\ninf-sup [41, 46, 137]. No entanto, mesmo que a condi\u00e7\u00e3o inf-sup \u00e9 satisfeita no cont\u00ednuo, no n\u00edvel\ndiscreto deve-se ter cuidado na escolha dos espa\u00e7os de aproxima\u00e7\u00e3o \u2013 eles devem \u201crecuperar\u201d a\ncondi\u00e7\u00e3o inf-sup dos espa\u00e7os originais de modo a garantir a estabilidade do m\u00e9todo. M\u00e9todos de\nelementos finitos mistos n\u00e3o s\u00e3o est\u00e1veis para todos os casos, alguns desses problemas mostram\noscila\u00e7\u00f5es esp\u00farias se os espa\u00e7os de aproxima\u00e7\u00e3o n\u00e3o forem adequadamente escolhidos [41, 48].\nPara problemas el\u00edpticos, foram constru\u00eddos diversas fam\u00edlias de espa\u00e7os de elementos finitos que\natendem a condi\u00e7\u00e3o inf-sup e portanto s\u00e3o est\u00e1veis, como os espa\u00e7os de Raviart-Thomas usado\nneste trabalho [136]. Al\u00e9m disso, hibridizar a formula\u00e7\u00e3o de elementos finitos mistos n\u00e3o altera a\nestabilidade.\n\nNo contexto deste trabalho, ap\u00f3s a aplica\u00e7\u00e3o da decomposi\u00e7\u00e3o de operadores, o problema el\u00edp-\ntico \u00e9 ent\u00e3o totalmente identificado, ap\u00f3s uma convenientemente lineariza\u00e7\u00e3o do coeficiente do\nfluxo de velocidade, ou lei de Darcy [136, 137, 41, 39]. A ideia b\u00e1sica \u00e9 obter ap\u00f3s a discretiza\u00e7\u00e3o,\ne demais aproxima\u00e7\u00f5es associados inerente \u00e0s distintas formula\u00e7\u00f5es, um sistema linear com boas\npropriedades matem\u00e1ticas, como ser \u201cbem condicionada\u201d e ter uma natureza localmente conser-\nvativa no n\u00edvel discreto, tal qual seu correspondente operador diferencial no cont\u00ednuo. Apesar\nde ser bem conhecido que a formula\u00e7\u00e3o de elementos finitos mistos conduz a um sistema linear\nesparso, que \u00e9 sim\u00e9trico e definido positivo [136, 137, 41, 39], tal sistema \u00e9 mal condicionado de-\nvido \u00e0 natureza multiescala da permeabilidade da rocha reservat\u00f3rio que pode variar em ordens\nde magnitude, de 10?2 milidarcy at\u00e9 10+9 (1 darcy = 1.0 \u00d7 10?12 m2 = a permeabilidade que d\u00e1 o\nescoamento de 1 cm s?1 para um fluido com viscosidade de 1 centipoise (1 g m?1s?1) sob o gradi-\nente de press\u00e3o de 1 atm cm?1). Isso significa que \u00e9 necess\u00e1rio ainda o emprego de alguma t\u00e9cnica\n\n6\n\n\n\nde pr\u00e9-condicionamento para a resolu\u00e7\u00e3o num\u00e9rica do problema de \u00e1lgebra linear proveniente da\ndiscretiza\u00e7\u00e3o do problema de valor de contorno de Poisson de press\u00e3o-velocidade. Devido \u00e0 natu-\nreza do sistema linear A? = ?, \u00e9 importante agora discutir sobre qual t\u00e9cnica de resolu\u00e7\u00e3o deve\nser empregada para o problema de Poisson, ou seja, se \u00e9 mais adequado adotar um m\u00e9todo direto\nou um m\u00e9todo iterativo para sua resolu\u00e7\u00e3o num\u00e9rica de forma precisa com robustez e efici\u00eancia\ncomputacional. Ser\u00e1 explorado uma formula\u00e7\u00e3o iterativa do m\u00e9todo dos gradientes conjugados\ncom pr\u00e9-condicionador 1 (PCG) para a resolu\u00e7\u00e3o do problema A? = ?, como ser\u00e1 argumento a\nseguir.\n\nA resolu\u00e7\u00e3o de grandes sistemas esparsos de equa\u00e7\u00f5es lineares da forma A? = ?, onde A = [??? ]\n\u00e9 uma matriz ? \u00d7 ? (no contexto de EDPs tipicamente n\u00e3o singulares, pelo fato do problema\ndiferencial ser bem posto), e ? um vetor ? \u00d7 1 dado, \u00e9 fundamental para muitas simula\u00e7\u00f5es nu-\nm\u00e9ricas em ci\u00eancia pura e em problemas de engenharia e \u00e9 muitas vezes a parte mais demorada\nde um c\u00e1lculo para a compreens\u00e3o global de um determinado cen\u00e1rio real em nosso cotidiano em\nsociedade. Embora uma principal fonte de grandes sistemas A? = ? seja a discretiza\u00e7\u00e3o (e lineari-\nza\u00e7\u00e3o) das EDPs do tipo el\u00edptica (e tamb\u00e9m parab\u00f3licas; problemas de fluidos compress\u00edveis, por\nexemplo, s\u00e3o governados por modelos de EDPs de press\u00e3o-velocidade de natureza parab\u00f3lica) \u00e9\nv\u00e1lido mencionar que, sistemas lineares de grande porte e esparsos tamb\u00e9m surgem em aplica\u00e7\u00f5es\nque n\u00e3o sejam provenientes de discretiza\u00e7\u00e3o de EDPs [142, 132, 124, 75, 139].\n\nTipicamente, os m\u00e9todos diretos, com base na fatora\u00e7\u00e3o da matriz de coeficientes A em produto\nde matrizes que s\u00e3o relativamente simples de inverter, s\u00e3o amplamente utilizados e s\u00e3o o \u201cm\u00e9todo\nde escolha\u201d em muitos c\u00f3digos industriais, especialmente onde a confiabilidade da exatid\u00e3o dos\nc\u00e1lculos \u00e9 a principal preocupa\u00e7\u00e3o. De fato, m\u00e9todos diretos s\u00e3o muito robustos em geral. Al\u00e9m\ndisso, tais m\u00e9todos exibem uma vantagem de permitir uma quantidade previs\u00edvel de recursos em\ntermos de tempo computacional e armazenamento em mem\u00f3ria (RAM, L2, R\u00edgida, etc...); ver,\ne.g., [75, 92]. Em problemas estacion\u00e1rios de EDPs, ou outros de natureza distinta [19, 139, 142],\n\u00e9 poss\u00edvel resolver de forma eficiente uma quantidade razo\u00e1vel de sistemas de equa\u00e7\u00f5es lineares em\num tempo relativamente aceit\u00e1vel, subjacente a um problema em particular [19, 139, 142], mesmo\nem duas dimens\u00f5es espaciais. Isso j\u00e1 n\u00e3o \u00e9 t\u00e3o simples quando temos uma problema de evolu\u00e7\u00e3o\ntemporal como ocorre com frequ\u00eancia em din\u00e2mica de fluidos em meios porosos [65, 40, 23, 58, 15,\n31, 72, 21, 2, 89, 76, 86]. Infelizmente, os m\u00e9todos diretos n\u00e3o exibem um bom escalonamento com\no tamanho do problema em termos de contagem do n\u00famero de opera\u00e7\u00f5es envolvidas e os requisitos\nde mem\u00f3ria. Isso \u00e9 notadamente vis\u00edvel em problemas decorrentes da discretiza\u00e7\u00e3o de EDPs em\nduas e tr\u00eas dimens\u00f5es espaciais de evolu\u00e7\u00e3o temporal.\n\nSimula\u00e7\u00f5es multif\u00edsica detalhadas, em problemas bidimensionais e tridimensionais (dentro do\nescopo deste trabalho como estamos interessados) levam a sistemas lineares que podem atingir\nfacilmente a ordem de centenas de milh\u00f5es (2D) ou at\u00e9 bilh\u00f5es (3D) de equa\u00e7\u00f5es com as corres-\npondentes inc\u00f3gnitas. Mesmo em problemas bidimensionais, face \u00e0 natureza heterog\u00eanea do meio\nporoso, \u00e9 natural incorporar uma no\u00e7\u00e3o de incerteza, o que conduzir\u00e1 a EDPs estoc\u00e1sticas [95,\n97, 94, 24, 89, 123, 2] e uma abordagem do tipo Monte Carlo \u00e9 uma alternativa vi\u00e1vel. Essencial-\n\n1Introduzido por E. Stiefel e M. R. Hestenes [102], o m\u00e9todo dos gradientes conjugados \u00e9 um m\u00e9todo direto. No\nentanto, na d\u00e9cada de 70 descobriu-se o potencial desse algoritmo como um m\u00e9todo iterativo [149, 128, 150]. Para\numa hist\u00f3ria mais completa sobre a pesquisa e desenvolvimento do m\u00e9todo dos gradientes conjugados indicamos ao\nleitor a refer\u00eancia [99] e as refer\u00eancias l\u00e1 citadas.\n\n7\n\n\n\nmente, isso significa o c\u00e1lculo de momentos estat\u00edsticos [95, 97, 94, 89] provenientes de um conjunto\nde experimentos determin\u00edsticos em ordens de centenas ou milhares (desej\u00e1vel) de experimentos\ncomputacionais. Assim, facilmente temos um contexto bidimensional com um n\u00famero elevado de\nopera\u00e7\u00f5es associadas a aproxima\u00e7\u00e3o de problemas de Poisson que pode envolver at\u00e9 85% de todos\nos c\u00e1lculos para cada uma dessas milhares de simula\u00e7\u00f5es [8, 4, 7]. Para modelos dessa natureza,\nlevando em conta o conhecimento atual, m\u00e9todos iterativos s\u00e3o a \u00fanica op\u00e7\u00e3o dispon\u00edvel no me-\nlhor entendimento do autor no contexto deste trabalho. Enquanto os m\u00e9todos iterativos requerem\nmenos armazenamento de mem\u00f3ria, e um n\u00famero ainda muitas vezes menor de opera\u00e7\u00f5es do que\nos m\u00e9todos diretos \u2013 especialmente quando uma solu\u00e7\u00e3o aproximada de relativa baixa precis\u00e3o \u00e9\nexigida \u2013 tais m\u00e9todos diretos n\u00e3o t\u00eam a \u201cconfiabilidade\u201d dos m\u00e9todos diretos, que podem fornecer\numa solu\u00e7\u00e3o \u201cexata\u201d, a menos de erros de aritm\u00e9tica de ponto flutuante. Em algumas aplica\u00e7\u00f5es,\nm\u00e9todos iterativos tipicamente falham e o pr\u00e9-condicionamento \u00e9 indispens\u00e1vel, embora nem sem-\npre tal \u201crem\u00e9dio\u201d seja suficiente para torn\u00e1-lo competitivo a ponto de atingir a converg\u00eancia em\numa quantidade razo\u00e1vel de tempo dentro de uma toler\u00e2ncia estabelecida a priori. Isto \u00e9 devido\ntamb\u00e9m em grande parte ao aumento da complexidade e tamanho da \u201cnova gera\u00e7\u00e3o de sistemas li-\nneares e n\u00e3o lineares\u201d, que surgem a partir de atuais aplica\u00e7\u00f5es t\u00edpicas em fen\u00f4menos de transporte\nde problemas em din\u00e2mica de fluidos.\n\nPor outro lado, ao mesmo tempo, a computa\u00e7\u00e3o paralela tem penetrado as mesmas \u00e1reas\nde aplica\u00e7\u00e3o como um novo ingrediente. Como o computador tornou-se amplamente dispon\u00edvel\nem termos de custos e com a unifica\u00e7\u00e3o de linguagens de comunica\u00e7\u00e3o padr\u00e3o, como o MPI\n(Message Passing Interface), criou-se um novo incentivo para utilizar m\u00e9todos iterativos face que\nproblemas sob investiga\u00e7\u00e3o s\u00e3o tipicamente em duas e tr\u00eas dimens\u00f5es espaciais, e n\u00e3o estacion\u00e1rios,\nao inv\u00e9s dos m\u00e9todos diretos os quais muitas vezes s\u00e3o ineficazes em termos do elevado tempo\ncomputacional. Outro incentivo \u00e9 que os m\u00e9todos iterativos s\u00e3o muito mais f\u00e1ceis de implementar\nem computadores paralelos, embora m\u00e9todos iterativos para sistemas lineares t\u00eam ainda obtido\num amadurecimento significativo e ainda h\u00e1 muitas quest\u00f5es em aberto [100, 124, 42, 132, 151,\n145, 127, 142].\n\nDe um modo geral, ainda n\u00e3o pode ser afirmado que um sistema de equa\u00e7\u00f5es lineares esparso\narbitr\u00e1rio pode ser resolvido de forma iterativa de uma forma eficiente. Por exemplo, se a infor-\nma\u00e7\u00e3o f\u00edsica sobre o problema em quest\u00e3o pode ser explorada, os m\u00e9todos mais eficazes e robustos\npodem ser ainda mais adaptados para obten\u00e7\u00e3o dessas solu\u00e7\u00f5es. De fato, esta estrat\u00e9gia \u00e9 explo-\nrada pelos m\u00e9todos multigrid, que tipicamente tiram vantagens de aspectos multiescala do modelo.\nAl\u00e9m disso, m\u00e1quinas paralelas podem exigir diferentes arquiteturas de tal forma que os algoritmos\nrequerem distintos paradigmas de programa\u00e7\u00e3o e radicalmente diferentes dos m\u00e9todos cl\u00e1ssicos e\nconsolidados na literatura. A t\u00edtulo de revis\u00e3o bibliogr\u00e1fica, observa-se que existem diversos textos\nsobre o tema multigrid e multiescala, como por exemplo [100, 124, 42, 132]. Apesar de v\u00e1rios\noutros pacotes computacionais prontos e dispon\u00edveis para uso \u201cimediato\u201d, como por exemplo [151,\n145, 127, 66, 142, 42, 100, 124, 132, 142], muito desses n\u00e3o s\u00e3o, de fato, t\u00e3o amig\u00e1veis para um\nusu\u00e1rio n\u00e3o especialista (i.e., um usu\u00e1rio final com experi\u00eancia em compiladores, programa\u00e7\u00e3o de\nbaixo n\u00edvel, etc...). Al\u00e9m disso, muitos desses c\u00f3digos s\u00e3o genuinamente paralelos e assim n\u00e3o s\u00e3o\nsimples de execut\u00e1-los em ambiente serial (uma boa exce\u00e7\u00e3o \u00e9 o \u201cSuperLU for sequential machi-\nnes\u201d [145], dispon\u00edvel desde 2011). Mesmo assim, um c\u00f3digo aberto de alta qualidade exige uma\ndemanda de tempo consider\u00e1vel para um bom aprendizado. Outro ponto fundamental \u00e9 que o\n\n8\n\n\n\nusu\u00e1rio ficar\u00e1 dependente de atualiza\u00e7\u00f5es e sem um controle absoluto do c\u00f3digo e, portanto, do\nponto de vista de amadurecimento acad\u00eamico, isso pode ser um aspecto negativo, em particular no\ncampo cient\u00edfico como um ambiente de uma p\u00f3s-gradua\u00e7\u00e3o. Claramente esses pacotes devem ser\nusados sempre que um dado objetivo est\u00e1 bem definido e quando h\u00e1 a disponibilidade de usu\u00e1rios\nbem treinados.\n\nPelo exposto acima, \u00e9 preciso escolher um m\u00e9todo iterativo com pr\u00e9-condicionamento que re\u00fane\nrigorosa fundamenta\u00e7\u00e3o matem\u00e1tica, robustez, efici\u00eancia computacional, certa simplicidade de\nimplementa\u00e7\u00e3o, e que ao mesmo tempo tenha uma forte motiva\u00e7\u00e3o f\u00edsica face ao problema el\u00edptico\nde Poisson, e que leve ainda em conta as inerentes propriedades multiescala associadas \u00e0 geologia do\nmeio poroso (porosidade e permeabilidade). Cumpre ainda reiterar que o problema de Poisson de\ninteresse neste trabalho est\u00e1 diretamente, e naturalmente, associado a uma equa\u00e7\u00e3o de transporte,\ngovernado por uma EDP de evolu\u00e7\u00e3o temporal. Isso significa que toda a discuss\u00e3o precedente deve\nser vista em uma perspectiva de que o problema de Poisson ser\u00e1, de fato, resolvido a cada passo\nde tempo em uma simula\u00e7\u00e3o computacional. Desta maneira, no contexto de resolu\u00e7\u00e3o de sistemas\nlineares esparsos e da natureza do presente trabalho de din\u00e2mica de fluidos em meios porosos,\nentendemos que o trabalho de Klaus Lackner e Ralph Menikoff [115], \u201cMultiscale Linear Solvers\nfor Very Large Systems Derived from PDES\u201d, publicado em SIAM Journal on Scientific Computing\n(2000) engloba todos esses pr\u00e9-requisitos de uma maneira natural em sua constru\u00e7\u00e3o. Esse trabalho\naborda exatamente a situa\u00e7\u00e3o f\u00edsica em escala de campo (quil\u00f4metros) que estamos interessados;\noutros m\u00e9todos exibem tamb\u00e9m um excelente rigor matem\u00e1tico, por\u00e9m ainda no campo mais\nte\u00f3rico em problemas \u201ctestes\u201d ou em aplica\u00e7\u00f5es distintas daquelas que estamos interessados em\ninvestigar nesse trabalho. Um ponto importante no problema de press\u00e3o-velocidade de Poisson, \u00e9\nquando temos press\u00f5es capilares descont\u00ednuas e a situa\u00e7\u00e3o muda drasticamente, pois \u00e9 necess\u00e1rio\nidentificar condi\u00e7\u00f5es de acoplamento corretas, localmente conservativas, no n\u00edvel discreto [125, 126,\n78]. Neste contexto, t\u00e9cnicas multiescala, como a discutida aqui, precisam ser revisitadas quando\nassociadas a problemas de natureza el\u00edptica. No caso do problema de press\u00e3o-velocidade com\npress\u00f5es capilares descont\u00ednuas, outras t\u00e9cnicas podem ser adotadas, como Galerkin descont\u00ednuo\nno contexto de elementos finitos [78, 126], decomposi\u00e7\u00e3o de dom\u00ednio combinado com m\u00e9todos de\nelementos finitos mistos em espa\u00e7o ?(???) com condi\u00e7\u00f5es de transmissibilidade de Robin [1, 2]\nentre outras como um esquema de aproxima\u00e7\u00e3o de fluxo multi-pontos de volumes finitos [82].\n\nO m\u00e9todo discutido nesse trabalho, o qual foi introduzido em [115], faz uso da formula\u00e7\u00e3o\niterativa do m\u00e9todo dos gradientes conjugados em conjunto a um pr\u00e9-condicionador escolhido\nespecialmente de modo a considerar a heterogeneidade do meio poroso. Isso \u00e9 feito combinando o\nm\u00e9todo multigrid e o m\u00e9todo dos gradientes conjugados criando um pr\u00e9-condicionador multiescala\nrecursivo. Como mencionado anteriormente, a natureza multiescala da permeabilidade da rocha\nque comp\u00f5e o meio poroso conduz a um sistema linear mal condicionado, assim a escolha desse\npr\u00e9-condicionador multiescala recursivo \u00e9 interessante pois a forma com que ele \u00e9 construido leva\nem considera\u00e7\u00e3o ambos os extremos do espectro da matriz do sistema linear, atrav\u00e9s do m\u00e9todo\nmultigrid, de maneira que a matriz do sistema pr\u00e9-condicionado tenha um n\u00famero de condi\u00e7\u00e3o\npequeno, e consequentemente apenas um pequeno n\u00famero de itera\u00e7\u00f5es \u00e9 preciso para a converg\u00eancia\ndo m\u00e9todo dos gradientes conjugados.\n\nModifica\u00e7\u00f5es foram introduzidas no algoritmo do m\u00e9todo multiescala, especificamente nas es-\ncolhas das componentes do m\u00e9todo multigrid. O m\u00e9todo multiescala foi construido em [115] para\n\n9\n\n\n\nresolver num\u00e9ricamente um problema de Poisson a partir de uma discretiza\u00e7\u00e3o por diferen\u00e7as fi-\nnitas centradas. No presente trabalho, por motivos j\u00e1 discutidos anteriormente, optamos por uma\ndiscretiza\u00e7\u00e3o por elementos finitos mistos e dessa forma alguns par\u00e2metros indicados no artigo\noriginal [115] n\u00e3o forneceram um bom resultado, em termos de n\u00famero de itera\u00e7\u00f5es e tempo com-\nputacional. Isso nos levou a pensar em diferentes abordagens na escolha das componentes que\nformam o pr\u00e9-condicionar multiescala recursivo. Assim, uma novidade do nosso trabalho est\u00e1 na\ndiferente escolha de m\u00e9todos de relaxa\u00e7\u00e3o \u2013 smoother \u2013 e um diferente tratamento das condi\u00e7\u00f5es\nde contorno. Esse assunto ser\u00e1 abordado no cap\u00edtulo 5. As modifica\u00e7\u00f5es s\u00e3o feitas com o intuito de\nmelhorar a converg\u00eancia e tempo computacional do algoritmo multiescala. Computacionalmente,\nnosso objetivo \u00e9 que esse algoritmo possa ser usado em computadores pessoais. Dessa forma, n\u00e3o\nnos preocupamos ainda em programacao paralela, por\u00e9m \u00e9 algo a ser explorado futuramente. Por\nfim, os resultados obtidos com o nosso algoritmo multiescala recursivo foram coerentes com os\nresultados obtidos no artigo de Lackner e Menikoff [115], mantendo a mesma tend\u00eancia do n\u00famero\nde itera\u00e7\u00f5es e esfor\u00e7o computacional em cada n\u00edvel.\n\nPara maiores detalhes sobre m\u00e9todos iterativos com precondicionamento multiescala e mul-\ntigrid, com diferentes abordagens e uma ampla diversidade de aplica\u00e7\u00f5es, ver [66, 142, 42, 100,\n124, 132]. A refer\u00eancia [142] \u00e9 composta por 5 (cinco) volumes e re\u00fane um amplo espectro sobre\n\u00e1lgebra linear num\u00e9rica, de m\u00e9todos diretos a iterativos, como diferentes abordagens sobre pr\u00e9-\ncondicionamento em distintas aplica\u00e7\u00f5es em sua perspectiva de apresenta\u00e7\u00e3o dos m\u00e9todos. Para\ninforma\u00e7\u00f5es sobre m\u00e9todos diretos para a resolu\u00e7\u00e3o de sistemas lineares de grande porte, sugere-se\nas seguintes fontes [151, 145, 127].\n\nO trabalho produzido nessa disserta\u00e7\u00e3o gerou um trabalho [3], o qual foi aceito no congresso\nInternational Conference on Approximation Methods and Numerical Modelling in Environment\nand Natural Resources MAMERN VI, em Pau na Fran\u00e7a. Nesse trabalho, nos concentramos na\naproxima\u00e7\u00e3o num\u00e9rica de problemas em transporte de fluidos que apresentam histerese em meios\nporosos heterogeneos bidimensionais. A histerese tenta quantificar as diferen\u00e7as no comportamento\ndos fluidos durante o escoamento, devido as mudan\u00e7as na satura\u00e7\u00e3o dos fluidos no tempo e espa\u00e7o.\nNo cap\u00edtulo 2 ser\u00e1 explicado com detalhes como o par\u00e2metro de histerese \u00e9 incluido na formula\u00e7\u00e3o\nde fase do escoamento bif\u00e1sico.\n\nPara aproximar a solu\u00e7\u00e3o desse problema, usamos a t\u00e9cnica de decomposi\u00e7\u00e3o de operadores,\ncomo veremos no cap\u00edtulo 3, e uma discretiza\u00e7\u00e3o por elementos finitos mistos h\u00edbridos combinado\ncom o m\u00e9todo multiescala apresentado no cap\u00edtulo 4 e 5 dessa disserta\u00e7\u00e3o para a aproxima\u00e7\u00e3o do\nproblema de press\u00e3o-velocidade. E usaremos uma estrat\u00e9gia de decomposi\u00e7\u00e3o de dom\u00ednio para a\nsolu\u00e7\u00e3o num\u00e9rica do problema parab\u00f3lico associado com transporte difusivo das fases fluidas.\n\nUsamos um esquema de alta resolu\u00e7\u00e3o de diferen\u00e7as finitas centrado, n\u00e3o oscilat\u00f3rio, conser-\nvativo e de segunda ordem para a aproxima\u00e7\u00e3o do sistema de leis de conserva\u00e7\u00e3o hiperb\u00f3lico n\u00e3o\nlinear, que modela o transporte convectivo das fases fluidas [2, 123, 34]. Para a solu\u00e7\u00e3o num\u00e9rica\ndo sistema de transporte difusivo, aplicamos elementos finitos mistos para a discretiza\u00e7\u00e3o espacial\ncombinado com uma estrat\u00e9gia impl\u00edcita, usando Euler regressivo, para a discretiza\u00e7\u00e3o temporal.\n\nUm manuscrito do trabalho enviado ao congresso pode ser encontrado no Ap\u00eandice B desta\ndisserta\u00e7\u00e3o.\n\n10\n\n\n\n1.4 Organiza\u00e7\u00e3o da disserta\u00e7\u00e3o\nNo Cap\u00edtulo 2 revisitamos a modelagem matem\u00e1tica b\u00e1sica de fluxos multif\u00e1sicos em meios\n\nporosos heterog\u00eaneos. No Cap\u00edtulo 3 \u00e9 feita uma discuss\u00e3o sobre modelagem computacional das\nequa\u00e7\u00f5es governantes em fen\u00f4menos de transporte em meios porosos heterog\u00eaneos na formula\u00e7\u00e3o de\nfase para \u201cisolar\u201d o problema de Poisson para sua discretiza\u00e7\u00e3o num\u00e9rica. O Cap\u00edtulo 4 \u00e9 dedicado\na aproxima\u00e7\u00e3o num\u00e9rica do problema de press\u00e3o-velocidade \u201cisolado\u201d, que \u00e9 o foco deste trabalho,\nvia elementos finitos mistos h\u00edbridos e a identifica\u00e7\u00e3o do problema de \u00e1lgebra linear resultante\ndeste procedimento. No Cap\u00edtulo 5 discute-se, em detalhes, um m\u00e9todo da classe dos gradientes\nconjugados com pr\u00e9-condicionador multigrid multiescala recursivo para a resolu\u00e7\u00e3o do sistema\nlinear associado ao problema de Poisson el\u00edptico, bem como sua implementa\u00e7\u00e3o. No Cap\u00edtulo 6\napresentam-se os experimentos num\u00e9ricos de um problema el\u00edptico de press\u00e3o-velocidade modelo,\ncom permeabilidade vari\u00e1vel, e uma discuss\u00e3o dos resultados obtidos. No Cap\u00edtulo 7 temos uma\nconclus\u00e3o sobre os experimentos e perspectivas futuras.\n\n11\n\n\n\n12\n\n\n\nCap\u00edtulo 2\n\nModelagem matem\u00e1tica de fluxos\nmultif\u00e1sicos em meios porosos\nheterog\u00eaneos\n\nO estudo de transporte de fluidos em meios porosos heterog\u00eaneos \u00e9 de grande import\u00e2ncia\nem diversas \u00e1reas cient\u00edficas e tecnol\u00f3gicas com aplica\u00e7\u00f5es em sequestro de carbono [58, 43, 45],\ntransporte de contaminantes no subsolo [59], monitoramento de aqu\u00edferos [101], recupera\u00e7\u00e3o de\npetr\u00f3leo em reservat\u00f3rios de hidrocarbonetos [13, 76], entre outros. Existem muitos desafios e\ndificuldades para a modelagem matem\u00e1tica e an\u00e1lise num\u00e9rica das EDPs n\u00e3o lineares que governam\nescoamentos multif\u00e1sicos complexos em meios porosos. Uma grande dificuldade adv\u00e9m do seu\ninerente car\u00e1ter multiescala devido as heterogeneidades de propriedades geol\u00f3gicas da rocha que\nforma o reservat\u00f3rio, como a permeabilidade ?(x) e a porosidade ?(x), que s\u00e3o modelados no\nsistema governante de EDPs como coeficientes descont\u00ednuos com r\u00e1pida varia\u00e7\u00e3o [76, 59].\n\nNeste trabalho estamos interessados na aplica\u00e7\u00e3o do escoamento multif\u00e1sico no contexto de\nrecupera\u00e7\u00e3o de petr\u00f3leo em reservat\u00f3rios heterog\u00eaneos, para o caso em que as fases s\u00e3o incom-\npress\u00edveis e imisc\u00edveis. Tipicamente, um reservat\u00f3rio de petr\u00f3leo \u00e9 um corpo de rocha sedimentar\nsubterr\u00e2nea profunda, formada por dep\u00f3sitos n\u00e3o uniformes que variam abruptamento no espa\u00e7o,\ne que cont\u00e9m uma mistura de fluidos nos espa\u00e7os intersticiais entre os gr\u00e3os (em torno de 10-100\n?m) [76]. O volume de espa\u00e7o dispon\u00edvel, denominado porosidade, geralmente varia dentro da\nescala 0.1-0.3 [m3/m3] e cont\u00e9m \u00e1gua e pelo menos um hidrocarboneto (g\u00e1s ou \u00f3leo) na fase l\u00ed-\nquida ou gasosa. Eros\u00e3o, falhas naturais e fraturas complicam ainda mais o conhecimento preciso\nda heterogeneidade presente no meio poroso. A permeabilidade da rocha pode variar por ordens\nde magnitude, de 10?2 milidarcy at\u00e9 10+9 (1 darcy = 1.0 \u00d7 10?12 m2 = a permeabilidade que\nd\u00e1 o escoamento de 1 cm s?1 para um fluido com viscosidade de 1 centipoise (1 g m?1s?1) sob o\ngradiente de press\u00e3o de 1 atm cm?1) [76]. Estas heterogeneidades ocorrem em m\u00faltiplas escalas,\ndesde a escala microsc\u00f3pica do poros at\u00e9 a escala de campo, que pode se extender por quil\u00f4metros\nimpossibilitando o conhecimento preciso e detalhado das varia\u00e7\u00f5es das propriedades das rochas\nque influenciam fortemente o transporte de fluidos no meio poroso.\n\n13\n\n\n\nFigura 2.1: Ilustra\u00e7\u00e3o da propriedade multiescala do meio poroso na micro-escala (a) e macro-\nescala (b). Retiradas da refer\u00eancia [76].\n\nNeste cap\u00edtulo falaremos sobre a modelagem, via formula\u00e7\u00e3o de fase, de problemas de transporte\nde fluidos em meios porosos heterog\u00eaneos, espec\u00edficamente com duas e tr\u00eas fases. Na formula\u00e7\u00e3o\nde fase as equa\u00e7\u00f5es diferenciais governantes s\u00e3o reescritas em fun\u00e7\u00e3o de uma press\u00e3o de refer\u00eancia,\nneste trabalho escolhida como a press\u00e3o da fase oleosa, em conjunto com equa\u00e7\u00f5es de transporte\ndas satura\u00e7\u00f5es referentes as outras fases presentes durante o escoamento [2]. A motiva\u00e7\u00e3o para a\nescolha dessa formula\u00e7\u00e3o para descrever o processo de transporte de fluidos vem do fato dela ser\nmais geral [54]. As equa\u00e7\u00f5es governantes provenientes dessa formula\u00e7\u00e3o mant\u00e9m a mesma forma\npara escoamentos de tr\u00eas e duas fases. Outra motiva\u00e7\u00e3o para o uso da formula\u00e7\u00e3o de fase \u00e9 que ela\nmant\u00e9m uma forma geral para as fun\u00e7\u00f5es de permeabilidade relativa e modelos de press\u00e3o capilar\n[54, 51, 49], o que facilita a modelagem da histerese no sistema governante. Por causa desses fatos,\nsua aplica\u00e7\u00e3o \u00e9 vantajosa para o prop\u00f3sito de desenvolvimento de ferramentas de aproxima\u00e7\u00e3o\ne simula\u00e7\u00e3o em problemas de transporte de fluidos em meios porosos heterog\u00eaneos em m\u00faltiplas\nescalas.\n\nEm conjunto com a formula\u00e7\u00e3o de fase, discutiremos tamb\u00e9m sobre a inclus\u00e3o da histerese no\nproblema de escoamento bif\u00e1sico de modo a ilustrar a diversidade da aplica\u00e7\u00e3o dessa formula\u00e7\u00e3o.\nEm seguida, apresentaremos brevemente outras formula\u00e7\u00f5es usadas na modelagem de problemas\nem din\u00e2mica de fluidos em meios porosos.\n\nNosso principal objetivo \u00e9 mostrar que h\u00e1 uma ampla classe de problemas de escoamento em\nmeios porosos que envolvem, em sua modelagem, um problema de natureza el\u00edptica. Dessa forma,\nm\u00e9todos eficientes e robustos para a resolu\u00e7\u00e3o de EDPs el\u00edpticas s\u00e3o de extrema import\u00e2ncia.\n\n2.1 Equa\u00e7\u00f5es fundamentais de escoamento com duas e tr\u00eas\nfases\n\nAs equa\u00e7\u00f5es que governam o escoamento e transporte das fases fluidas em meios porosos hete-\nrog\u00eaneos s\u00e3o dadas pelas equa\u00e7\u00f5es de conserva\u00e7\u00e3o de massa e pela extens\u00e3o multif\u00e1sica da equa\u00e7\u00e3o\nde Darcy [76, 133]. A equa\u00e7\u00e3o de Darcy foi formulada como uma lei emp\u00edrica pelo engenheiro\n\n14\n\n\n\nfranc\u00eas Henri Darcy em 1856 e estabelece uma rela\u00e7\u00e3o entre a velocidade macrosc\u00f3pica do fluido\ne o gradiente de press\u00e3o no caso monof\u00e1sico [76, 133].\n\nNeste trabalho consideramos o modelo matem\u00e1tico multif\u00e1sico da lei de Darcy, com at\u00e9 tr\u00eas\nfases, levando em conta for\u00e7as capilares, express\u00f5es gerais para as fun\u00e7\u00f5es de permeabilidade, po-\nrosidade e campos de permeabilidade vari\u00e1veis, e efeitos da gravidade. Na discuss\u00e3o da equa\u00e7\u00f5es\ngovernantes consideramos um fluxo bidimensonal de fases incompress\u00edveis e imiss\u00edveis num meio\nporoso heterog\u00eaneo. Consideramos que n\u00e3o h\u00e1 fontes ou sorvedouros internos e que n\u00e3o h\u00e1 trans-\nfer\u00eancia de massa entre as fases e os efeitos t\u00e9rmicos s\u00e3o desprezados. Observamos que existem\nmodelos mais gerais que levam em conta a transfer\u00eancia de massa entre as fases, como o modelo\ncomposicional e o modelo Black-oil [133], por\u00e9m esse n\u00e3o \u00e9 o foco desse trabalho.\n\nAs fases g\u00e1s, \u00f3leo e \u00e1gua ser\u00e3o indicadas pelas as letras g, o e w, respectivamente. Al\u00e9m\ndisso supomos que as fases saturam completamente os poros. Dessa forma, denotando a satura\u00e7\u00e3o\n(fra\u00e7\u00e3o de volume local) da fase ? por ?? [m3/m3], com 0 ? ?? ? 1, temos que,??\n\n?\n\n?? = 1, ? = ?, ?, ?. (2.1.1)\n\nAs equa\u00e7\u00f5es da conserva\u00e7\u00e3o de massa do \u00f3leo, g\u00e1s e \u00e1gua s\u00e3o [133],\n\n?\n\n??\n(?(x)????) + ? \u00b7 (??v?) = 0, ? = ?, ?, ?, x ? R2, ? ? 0, (2.1.2)\n\nonde ?(x) [m3/m3] denota a porosidade do meio poroso. Para a fase ?, ?? [Kg/m3] denota sua massa\nespec\u00edfica, e v? [m3/m2 ?] \u00e9 o seu fluxo volum\u00e9trico (ou velocidade de Darcy). O fluxo volum\u00e9trico\n\u00e9 obtido atrav\u00e9s da extens\u00e3o multi-fase da lei de Darcy, (ver, [76], [133]),\n\nv? = ??(x)\n??\n??\n\n(??? ? ?? g ??), ? = ?, ?, ?, x ? R2, ? ? 0, (2.1.3)\n\nonde ?(x) [m2] denota o tensor de permeabilidade absoluta do meio poroso. No caso geral (meio\nporoso anisotr\u00f3pico) ?(x) \u00e9 uma matriz sim\u00e9trica definida positiva, por\u00e9m em casos relativamente\nmais simples (meio poroso isotr\u00f3pico) ?(x) \u00e9 um escalar positivo [133, 76, 50]. Neste trabalho\nutiliza-se essa modelagem. Para cada fase ?, ?? [Pa] \u00e9 a press\u00e3o, ?? [? ? ?] \u00e9 a viscosidade, e ??\n[m3/m3] \u00e9 a permeabilidade relativa. Cada permeabilidade relativa ?? \u00e9 uma fun\u00e7\u00e3o adimensional\nda satura\u00e7\u00e3o e \u00e9 medida em laborat\u00f3rio. Experimentalmente, ?? (0 ? ?? ? 1) aumenta quando\n?? aumenta, e as permeabilidades relativas nunca desaparecem simult\u00e2neamente [133, 76, 50]; g\n[m/s2] \u00e9 a gravidade e ? [m] \u00e9 a profundidade.\n\nAs equa\u00e7\u00f5es de Darcy (2.1.3) permitem que diferentes fluidos exer\u00e7am diferentes press\u00f5es.\nAssim, definiremos a press\u00e3o capilar entre as fases ? e ?, ? ?= ?, por\n\n??? = ?? ? ?? , (2.1.4)\n\ne note que somente duas das seis poss\u00edveis press\u00f5es capilares s\u00e3o independentes uma vez que\n\n??? = ????, ??? = ??? + ???. (2.1.5)\n\n15\n\n\n\nUm par independente deve ser medido experimentalmente como uma fun\u00e7\u00e3o do vetor de satura\u00e7\u00e3o\n[133, 76, 50]. Se os efeitos t\u00e9rmicos e a compressibilidade forem ignorados, ?? e ?? ser\u00e3o constantes,\ne (2.1.2) pode ser reescrita como:\n\n?\n\n??\n(?(x)??) + ? \u00b7 v? = 0, ? = ?, ?, ?. (2.1.6)\n\nEste sistema deve ser complementado por condi\u00e7\u00f5es de contorno e condi\u00e7\u00f5es iniciais.\nPara entender melhor as importantes caracter\u00edsticas presentes na solu\u00e7\u00e3o de escoamentos trif\u00e1si-\n\ncos o sistema governante (2.1.3)-(2.1.6), posto originalmente pelas equa\u00e7\u00f5es b\u00e1sicas de conserva\u00e7\u00e3o,\n\u00e9 reescrito em fun\u00e7\u00e3o de uma press\u00e3o de refer\u00eancia, aqui escolhida como a press\u00e3o do \u00f3leo pois\nestamos no contexto de recupera\u00e7\u00e3o de petr\u00f3leo, em conjunto a duas equa\u00e7\u00f5es de transporte das\nsatura\u00e7\u00f5es das fases \u00e1gua e g\u00e1s. Essa formula\u00e7\u00e3o se chama formula\u00e7\u00e3o de fase [54]. No contexto\ndesse trabalho, a escolha dessa formula\u00e7\u00e3o \u00e9 justificada pelo fato dela ser mais geral, englobando\nescoamentos de duas e tr\u00eas fases com e sem gravidade e histerese. Assim, a motiva\u00e7\u00e3o de estudar\na resolu\u00e7\u00e3o num\u00e9rica de EDPs el\u00edpticas \u00e9 mais forte pois se estende para diferentes modelos em\ndin\u00e2mica de fluidos em meios porosos.\n\nNas pr\u00f3ximas se\u00e7\u00f5es, vamos descrever em detalhes a formula\u00e7\u00e3o de fase para o problema trif\u00e1-\nsico, bif\u00e1sico e bif\u00e1sico com histerese.\n\n2.1.1 Modelo de escoamento de tr\u00eas fases com gravidade\nPrimeiramente, iremos definir a mobilidade relativa ??(??, ??) [m3/(m3 ? ? ?)], a mobilidade\n\ntotal ?(??, ??), e o fluxo fracion\u00e1rio ??(??, ??) [m3/m3], respectivamente, por\n\n??(??, ??) =\n??\n??\n\n, ?(??, ??) =\n??\n\n?\n\n??, ??(??, ??) = ??/?, ? = ?, ?, ?, (2.1.7)\n\ne note que\n??\n\n? ?? = 1. Em seguida, definimos a velocidade total (ou fluxo volumetrico total) por\nv =\n\n??\n? v? . Usando essas equa\u00e7\u00f5es, podemos reescrever a equa\u00e7\u00e3o (2.1.3) como [2],\n\nv? = v?? + ?(x)??\n??\n? ?=?\n\n?? (???? + ??? g ??), (2.1.8)\n\nonde ??? ? ?? ? ?? . Portanto, por (2.1.6) e (2.1.8), o sistema de equa\u00e7\u00f5es que governam o fluxo\npara cada fase ? = ?, ?, ?, \u00e9:\n\n?\n\n??\n(?(x) ??) + ? \u00b7 (v??) = ? \u00b7 {?(x)??\n\n??\n? ?=?\n\n?? (???? ? ??? g ??)}. (2.1.9)\n\nAs equa\u00e7\u00f5es diferenciais acima est\u00e3o acompanhas de condi\u00e7\u00f5es de contorno e iniciais t\u00edpicas de\nproblemas em escoamento de fluidos em meios porosos. Abrindo as equa\u00e7\u00f5es (2.1.9) temos,\n\n?\n\n??\n(?(x) ??) + ? \u00b7 (v??) =? \u00b7 {?(x)?? [??(???? ? ??? g ??) + ??(???? ? ??? g ??)]}, (2.1.10)\n\n?\n\n??\n(?(x) ??) + ? \u00b7 (v??) =? \u00b7 {?(x)?? [??(???? ? ??? g ??) + ??(???? ? ??? g ??)]}, (2.1.11)\n\n?\n\n??\n(?(x) ??) + ? \u00b7 (v??) =? \u00b7 {?(x)?? [??(???? ? ??? g ??) + ??(???? ? ??? g ??)]}. (2.1.12)\n\n16\n\n\n\nNote que uma das equa\u00e7\u00f5es acima \u00e9 redundante pois\n??\n\n? ?? = 1.\nEscolhemos ??, ?? e ?? como as tr\u00eas vari\u00e1veis independentes do problema [7]-[13]. O sistema\n\n(2.1.10)-(2.1.12) pode ser reescrito para as equa\u00e7\u00f5es de satura\u00e7\u00e3o ?? e ?? usando a rela\u00e7\u00e3o (2.1.1)\ncomo,\n\n?\n\n??\n(?(x)??) + ? \u00b7 (v?? + G?) = ? \u00b7 w?,\n\n?\n\n??\n(?(x)??) + ? \u00b7 (v?? + G?) = ? \u00b7 w?, (2.1.13)\n\nonde os termos do fluxo difusivo para as fases \u00e1gua, w?, e g\u00e1s ,w?, em (2.1.13) s\u00e3o dados por\n\nw? = ?(x) [??(1 ? ??)???? ? ????????] , (2.1.14)\nw? = ?(x) [??(1 ? ??)???? ? ????????] . (2.1.15)\n\nOs termos envolvendo a gravidade, G? = G?(??, ??, ?(x)), ? = ?, ?, que aparecem em (2.1.13)\ns\u00e3o dados, respectivamente, por\n\nG? = ?(x)[??(1 ? ??)??? ? ???????] g??, G? = ?(x)[??(1 ? ??)??? ? ???????] g??. (2.1.16)\n\nAs equa\u00e7\u00f5es (2.1.13)-(2.1.16) levam a um sistema parab\u00f3lico degenerado. De forma a resolv\u00ea-\nlo para o campo de press\u00f5es ??, independentemente das satura\u00e7\u00f5es, as tr\u00eas equa\u00e7\u00f5es (2.1.9) s\u00e3o\nsomadas de modo a obter o seguinte problema el\u00edptico de Poisson de press\u00e3o-velocidade associado\nao sistema de fluxo trif\u00e1sico para as press\u00f5es capilares ??? e ???,\n\n? \u00b7 v = 0, v = ??(x)?(??, ??)??? + v?? + v?? + v?, (2.1.17)\n\nonde v?? e v?? s\u00e3o as velocidades de corre\u00e7\u00e3o, definidas por v?? = ??(x)??(??, ??)???? , e v? \u00e9 a\nvelocidade de corre\u00e7\u00e3o devido a gravidade dada por v?(??, ??) = ?(x)?? g ??, onde ??(??, ??) ?\n???? + ???? + ????.\n\nCondi\u00e7\u00f5es de contorno e iniciais para (2.1.13)-(2.1.17) devem ser impostas de modo a completar\na defini\u00e7\u00e3o do modelo matem\u00e1tico; em particular, ?? e ?? devem ser especificados num tempo\ninicial ? = ?0 (e.g., ? = 0).\n\nAs equa\u00e7\u00f5es (2.1.13)-(2.1.17) podem ser adimensionalizadas identificando os valores caracter\u00eds-\nticos de cada vari\u00e1vel [2, 13]:\n\n?* = ? ??/?, ?* = ? ?, v* = v/??, ?*?? = ???/??,\n?*?? = ???/??, ?\n\n*\n?? = ???/???? , ?\n\n*\n?? = ???/???? , ?\n\n*(x) = ?(x)/??,\n? * = ?/?, ? *(x)?*? = ?(x)??/(??/??), ?\n\n*(x)?*? = ?(x)??/(??/??).\n\nAs equa\u00e7\u00f5es adimensionalizadas tem a mesma forma que as (2.1.13)-(2.1.17) e dois importantes\ngrupos adimensionais aparecem,\n\n?? =\n?? ??? g\n\n?? ??\n, ?? =\n\n?? ??\n?? ?? ?\n\n. (2.1.18)\n\nO primeiro grupo, ??, quantifica a raz\u00e3o entre os efeitos gravitacionais e os efeitos convectivos\n[2]. ?? \u00e9 a permeabilidade caracter\u00edstica (o valor m\u00e9dio de ?(x) na malha computacional) e ?? \u00e9 a\n\n17\n\n\n\nvelocidade total caracter\u00edstica (em magnitude). O segundo grupo adimensional, ?? , representa a\nraz\u00e3o entre os efeitos convectivos e difusivos [2]; ele controla a importancia relativa entre as for\u00e7as\ndifusivas e convectivas. ? \u00e9 o tamanho caracter\u00edstico do sistema e ?? \u00e9 o valor caracter\u00edstico da\npress\u00e3o capilar.\n\nAp\u00f3s adimensionalizar o sistema trif\u00e1sico (2.1.13)-(2.1.17) notamos que para cada fase ? =\n?, ? os grupos adimensionais ?? e ?? est\u00e3o, respectivamente, presentes junto aos termos difusivo\nw?(??, ??, ?(x)), gravidade-convec\u00e7\u00e3o G?(??, ??, ?(x)) e de velocidade v:\n\n?\n\n??\n(?(x)??) + ? \u00b7 (v?? + ??G?) = ? \u00b7 (?? w?),\n\n?\n\n??\n(?(x)??) + ? \u00b7 (v?? + ??G?) = ? \u00b7 (?? w?),\n\n? \u00b7 v = 0, v = ??(x)???? + ?? (v?? + v??) + ??v?.\n\n(2.1.19)\n\nO sistema de equa\u00e7\u00f5es governantes (2.1.19) s\u00e3o tamb\u00e9m sujeitas \u00e0s condi\u00e7\u00f5es de contorno e con-\ndi\u00e7\u00f5es iniciais de (2.1.13)-(2.1.17).\n\n2.1.2 Modelo de escoamento de duas fases com gravidade\nUma das vantagens da formula\u00e7\u00e3o de fase [54, 55, 49] para o problema trif\u00e1sico \u00e9 que pode-\n\nmos facilmente recair na formula\u00e7\u00e3o de fase para o problema bif\u00e1sico com as mesmas suposi\u00e7\u00f5es\ncolocando ?? = 0 (ou ?? = 0). Assim, as equa\u00e7\u00f5es governantes s\u00e3o dadas [55] por,\n\n?\n\n??\n(? (x) ??) + ? \u00b7 (v?? + G?) = ? \u00b7 w?, (2.1.20)\n\nonde os termos de gravidade G?(??, x) e do fluxo difusivo w?(??, x), s\u00e3o dados respectivamente\npor,\n\nG? = ?(x)[??(1 ? ??)???]g??, e w? (??, x) = ?? (x) [?? (??) (1 ? ??)] ????. (2.1.21)\nO sistema de press\u00e3o-velocidade \u00e9 dado por,\n\n? \u00b7 v = 0, v = ?? (x) ? (??) ??? + vwo + v?, (2.1.22)\nonde v?? = ?? (x) ?? (??) ???? \u00e9 a velocidade de corre\u00e7\u00e3o de fase e v?(??) = ?(x)?? g ?? \u00e9 a\nvelocidade de corre\u00e7\u00e3o devido a gravidade; e ??(??) ? ???? + ????.\n\nAs equa\u00e7\u00f5es (2.1.20)-(2.1.22) podem ser adimensionalizadas identificando seus valores caracte-\nr\u00edsticos, que s\u00e3o os mesmos que aparecem no caso trif\u00e1sico. As equa\u00e7\u00f5es resultantes s\u00e3o da mesma\nforma que (2.1.20)-(2.1.22) e dois importantes grupos adimensionais aparecem:\n\n?? =\n?? ??? g\n\n?? ??\n, e ?? =\n\n?? ??\n?? ?? ?\n\n. (2.1.23)\n\nEsses grupos adimensionais tem a mesma interpreta\u00e7\u00e3o dos grupos que aparecem na formula\u00e7\u00e3o\ntrif\u00e1sica, e ap\u00f3s a adimensionaliza\u00e7\u00e3o o sistema bif\u00e1sico na formula\u00e7\u00e3o de fase fica,\n\n?\n\n??\n(?(x)??) + ? \u00b7 (v?? + ??G?) = ? \u00b7 (?? w?),\n\n? \u00b7 v = 0, v = ??(x)???? + ?? v?? + ??vG.\n\n18\n\n\n\nOutra vantagem da formula\u00e7\u00e3o de fase \u00e9 que facilita a inclus\u00e3o da histerese, sem que a forma\ndas equa\u00e7\u00f5es mudem.\n\n2.1.3 Modelo de escoamento de duas fases com gravidade e histerese\nAs propriedades de escoamento de misturas de \u00e1gua e \u00f3leo em meios porosos s\u00e3o frequentemente\n\nmodeladas como se dependessem somente da satura\u00e7\u00e3o da \u00e1gua. A permeabilidade relativa, uma\ndas fun\u00e7\u00f5es mais import\u00e2ntes em escoamento de fluidos, \u00e9 tradicionalmente tomada como fun\u00e7\u00e3o\nfixa das satura\u00e7\u00f5es dos fluidos. No entanto, estudos te\u00f3ricos e experimentais revelam que isso\nn\u00e3o \u00e9 totalmente verdade: as permeabilidades relativas dependem das propriedades molhantes dos\nfluidos, dos processos de embebi\u00e7\u00e3o e drenagem, e da hist\u00f3ria do escoamento dos fluidos [120]. Ou\nseja, o fluido apresenta histerese (ou mem\u00f3ria) durante o escoamento. Uma explica\u00e7\u00e3o para esse\ncomportamento \u00e9 que a distribui\u00e7\u00e3o da \u00e1gua e do \u00f3leo em poros de diferentes tamanhos tem um\npapel importante em determinar as propriedades locais de escoamento, e essa distribui\u00e7\u00e3o pode\nmudar numa escala de tempo diferente da escala de tempo das ondas hidrodin\u00e2micas durante o\nescoamento [27, 120]. Em escoamento imisc\u00edvel de duas fases, \u00e1gua-\u00f3leo, a fase molhante (\u00e1gua) age\ncomo um filme cobrindo as paredes dos poros e tamb\u00e9m preenchendo completamente alguns dos\nporos menores. Quando ambas as fases s\u00e3o transportadas juntas no meio poroso, cada uma caminha\npor um filamento de poro diferente. Tens\u00f5es superficiais fazem com que a fase molhante preencha\npreferencialmente os poros menores e a fase n\u00e3o molhante (\u00f3leo) preencha preferencialmente os\nporos maiores, os quais est\u00e3o cobertos por uma fina camada da fase molhante (\u00e1gua). Isso leva\na diferen\u00e7as no comportamento do escoamento baseado na dire\u00e7\u00e3o das mudan\u00e7as da satura\u00e7\u00e3o\nno tempo e espa\u00e7o. Isto \u00e9, o escoamento exibe histerese. Essencialmente, histerese depende da\nevolu\u00e7\u00e3o da satura\u00e7\u00e3o, i.e., sua hist\u00f3ria de redistribui\u00e7\u00e3o nos poros.\n\n0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n1\n\nWATER SATURATION  ( S\nw\n )\n\nP\nE\n\nR\nM\n\nE\nA\n\nB\nIL\n\nIT\nY\n\n F\nU\n\nN\nC\n\nT\nIO\n\nN\nS\n\n  \n( \n\nk\nw\n, \n\nk\nI , \n\nk\nD\n )\n\nDrainage ( k\nD\no\n )\n\nImbibition ( k\nI\no\n )\n\n(a) Embebi\u00e7\u00e3o ??? (??, ?), drena-\ngem ??? (??, ?) da permeabilidade\ndo \u00f3leo, e permeabilidade ??(??)\nda \u00e1gua.\n\n0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n1\n\nWATER SATURATION  ( S\nw\n )\n\nP\nE\n\nR\nM\n\nE\nA\n\nB\nIL\n\nIT\nY\n\n F\nU\n\nN\nC\n\nT\nIO\n\nN\nS\n\n P\nL\n\nA\nN\n\nE\n\nDrainage ( k\nD\no\n )\n\nScanning ( ? )\n\nImbibition ( k\nI\no\n )\n\n(b) Scanning curves para as curvas\nde permeabilidade da fase \u00f3leo de\nconstante ?.\n\nFigura 2.2: A permeabilidade do \u00f3leo n\u00e3o depende somente da satura\u00e7\u00e3o do fluido, mas tamb\u00e9m\ndo par\u00e2metro de histerese e nas tend\u00eancias da satura\u00e7\u00e3o (processos de embebi\u00e7\u00e3o e drenagem).\n\n19\n\n\n\nMatematicamente [27, 152], os efeitos de histerese s\u00e3o modelados supondo que (i) existem duas\ncurvas extremas de permeabilidade para o \u00f3leo e para a embebi\u00e7\u00e3o e drenagem que descrevem o\nescoamento quando a satura\u00e7\u00e3o do \u00f3leo est\u00e1 decrescendo e crescendo, respectivamente, de maneira\nirrevers\u00edvel, ver Figura 2.2.(a); e (ii) existe uma fam\u00edlia de curvas de permeabilidade cont\u00ednuas,\nchamada de scanning curves, ver Figura 2.2.(b), que est\u00e3o entre as curvas de absor\u00e7\u00e3o e drenagem\ne descreve o escoamento quando da permeabilidade do \u00f3leo muda irreversivelmente. Absor\u00e7\u00e3o\nocorre quando a satura\u00e7\u00e3o da fase molhante aumenta, e a drenagem acontece quando a satura\u00e7\u00e3o\nda fase n\u00e3o molhante aumenta [152, 116].\n\nPara escoamento de duas fases, o primeiro modelo matem\u00e1tico levando em conta os efeitos de\nhisterese foi formulado em [120]. Neste artigo, apenas as curvas de absor\u00e7\u00e3o e drenagem foram\nmodeladas. Um modelo mais completo para a histerese, que incorpora as scanning curves de\npermeabilidade, chamado de Scanning Hysteresis Model (SHM) foi introduzido em [88] e sup\u00f5e\nque o equil\u00edbrio \u00e9 sempre mantido e descreve a fenomenologia da histerese da permeabilidade\nrelativa ao introduzir um par\u00e2metro de histerese para parametrizar as scanning curves.\n\nNa presente modelagem de escoamento bif\u00e1sico com histerese em meios porosos heterog\u00eaneos\nusamos um modelo chamado de Scanning Hysteresis Model with Relaxation (SHMR) [27]. Esse\nmodelo estende o SHM ao, (a) permitir o scanning flow se estender al\u00e9m das curvas de absor\u00e7\u00e3o e\ndrenagem, e; (b) tratando as curvas somente como atratores de estados fora da regi\u00e3o de scanning.\nA atra\u00e7\u00e3o, ou relaxa\u00e7\u00e3o, ocorre numa escala de tempo que corresponde a redistribui\u00e7\u00e3o de fases\nnos poros conduzida pelas for\u00e7as capilares [27].\n\nNeste modelo uma vari\u00e1vel de estado, o par\u00e2metro de histerese ? = ?(x, ?), \u00e9 introduzida\npara contabilizar a depend\u00eancia da permeabilidade do \u00f3leo, ??(??, ?), da hist\u00f3ria do fluxo [27]. A\nseguinte equa\u00e7\u00e3o diferencial parcial, em sua forma adimensional,\n\n??\n\n??\n= ? (??, ?) =\n\n???\n??\n\n(?? (??) ? ?)/?, if ? &lt;?? (??) ,\n(?? (??) ? ?)/?, if ? > ?? (??) ,\n0, caso contr\u00e1rio,\n\n\u00e9 usada para modelar os processos de absor\u00e7\u00e3o e drenagem de modo a incorporar a histerese\ndurante o mecanismo de inje\u00e7\u00e3o de \u00e1gua [27].\n\nA permeabilidade da \u00e1gua n\u00e3o possui histerese, dessa forma ?? = ??(??). ?? e ?? est\u00e3o rela-\ncionados aos processos de embebi\u00e7\u00e3o e drenagem, respectivamente, via do mecanismo de histerese.\nA constante ? define uma escala de tempo que corresponde a redistribui\u00e7\u00e3o de fase dentro do meio\nporoso.\n\nA exten\u00e7\u00e3o das equa\u00e7\u00f5es (2.1.13)-(2.1.17) para incorporar a histerese \u00e9 direta, e as equa\u00e7\u00f5es\ngovernantes s\u00e3o dadas por:\n\n?\n\n??\n(? (x) ??) + ? \u00b7 (v?? (??, ?) + G? (??, x, ?)) = ? \u00b7 w? (??, x, ?) , (2.1.25)\n\n? \u00b7 v (??, x, ?) = 0, (2.1.26)\n\nv (??, x, ?) = ?? (x) ? (??, ?) ??? + v?? (??, x, ?) + v? (??, x, ?) , (2.1.27)\n\n20\n\n\n\n??\n\n??\n= ? (??, ?) =\n\n???\n??\n\n(?? (??) ? ?)/?, if ? &lt;?? (??) ,\n(?? (??) ? ?)/?, if ? > ?? (??) ,\n0, caso contr\u00e1rio.\n\n(2.1.28)\n\nCondi\u00e7\u00f5es iniciais e de contorno devem ser impostas para completar o modelo.\n\n2.2 O modelo do tra\u00e7ador passivo e da press\u00e3o global\nNessa se\u00e7\u00e3o, iremos apresentar outros modelos f\u00edsicos, no contexto de escoamento em meios\n\nporosos, onde um problema el\u00edptico naturalmente aparece.\n\n2.2.1 Tra\u00e7ador passivo\nA formula\u00e7\u00e3o do tra\u00e7ador passivo apresentada em [34] modela o escoamento de um fluido que\n\ncarrega um soluto passivo pelo meio poroso. Essa modelagem ignora os efeitos de gravidade,\ncompresss\u00e3o (do g\u00e1s) e dispers\u00e3o na escala do poro. A porosidade do meio \u00e9 fixada como uma\nconstante. Assim, o modelo \u00e9 dado por\n\n??\n\n??\n+ v \u00b7 ?? = 0, (2.2.1)\n\nv = ?\n??\n?\n\n??, ? \u00b7 v = 0 (2.2.2)\n\nonde ? corresponde a satura\u00e7\u00e3o do fluido marcado, v \u00e9 a velocidade do fluido dado pela lei de\nDarcy, ?? a permeabilidade, ? a viscosidade, e ? a press\u00e3o. Condi\u00e7\u00f5es de contorno e condi\u00e7\u00f5es\niniciais s\u00e3o necess\u00e1rias para completar o modelo (2.2.1)-(2.2.2). Note que nessa formula\u00e7\u00e3o aparece\num problema de press\u00e3o-velocidade de natureza el\u00edptica, dada pela equa\u00e7\u00e3o (2.2.2), acoplado ao\nproblema de transporte de satura\u00e7\u00e3o.\n\n2.2.2 A formula\u00e7\u00e3o da press\u00e3o global\nApresentamos a formula\u00e7\u00e3o global para fluxo de duas fases, \u00e1gua (w) e \u00f3leo (o), para fluidos\n\nincompress\u00edveis e imiss\u00edveis, em que n\u00e3o h\u00e1 transfer\u00eancia de massa entre as fases e sem influ\u00eancia\nda gravidade [70]. As equa\u00e7\u00f5es de balan\u00e7o de massa e velocidade de Darcy s\u00e3o as dadas por (2.1.2)\ne (2.1.3), respectivamente.\n\nTemos que ?? + ?? = 1 e as mobilidades e fluxos fracion\u00e1rios s\u00e3o dados como em (2.1.7).\nDefinimos a press\u00e3o capilar como ?? = ?? ? ??.\n\nAssim, definimos a press\u00e3o global como [70]\n\n? =\n1\n2\n\n[?\n?? + ?? +\n\n?? ??\n0\n\n(?\n?0?\n\n?1\n? (?) ? ???\n\n?1\n? (?)\n\n)?\n??\n]?\n\n. (2.2.3)\n\n21\n\n\n\nA equa\u00e7\u00e3o de satura\u00e7\u00e3o \u00e9 dada, supondo que apenas \u00e1gua \u00e9 injetada no reservat\u00f3rio e que a\nprodu\u00e7\u00e3o de \u00e1gua \u00e9 proporcional a sua mobilidade local, por:\n\n?\n??\n\n??\n+ ??v \u00b7 ?? + ? \u00b7 (?(x)?????????) =\n\n??\n?(1 ? ??)?, se ? > 0,0, se ? &lt;0, (2.2.4)\n\nonde ? \u00e9 o fluxo volum\u00e9trico externo total, definido por ? = ?? + ??. A equa\u00e7\u00e3o de press\u00e3o-\nvelocidade \u00e9 dada por,\n\n? \u00b7 v = ?(?, ?), v = ??(?)?(?)??. (2.2.5)\nCondi\u00e7\u00f5es de contorno e condi\u00e7\u00f5es iniciais s\u00e3o necess\u00e1rias para completar o modelo (2.2.3)-(2.2.5).\nNote que novamente temos uma formula\u00e7\u00e3o de um problema em escoamento de fluidos em meios\nporosos em que um problema de natureza el\u00edptica: o problema de press\u00e3o-velocidade (2.2.5).\nNessa formula\u00e7\u00e3o para o problema bif\u00e1sico, o acoplamento entre as equa\u00e7\u00f5es de press\u00e3o-velocidade\ne satura\u00e7\u00e3o \u00e9 menor que na formula\u00e7\u00e3o de fase. No entanto, isso n\u00e3o acontece para a formula\u00e7\u00e3o\ncom press\u00e3o global para o problema trif\u00e1sico. \u00c9 bem entendido que para o problema trif\u00e1sico essa\nformula\u00e7\u00e3o nem sempre existe [54]; ver tamb\u00e9m [49].\n\nConsiderando os modelos matem\u00e1ticos discutidos aqui, formula\u00e7\u00e3o de fase, formula\u00e7\u00e3o global\ne tra\u00e7ador passivo, podemos ver que para todas essas formula\u00e7\u00f5es temos uma EDP de natureza\nel\u00edptica, dada por um problema de press\u00e3o-velocidade acoplado a um problema de transporte de sa-\ntura\u00e7\u00e3o. Dessa forma, mostramos que problemas el\u00edpticos frequentemente aparecem na modelagem\nde problemas de transporte de fluidos em meios porosos. Como esses modelos envolvem grandes\nsistemas acoplados de equa\u00e7\u00f5es diferenciais parciais n\u00e3o-lineares, uma grande preocupa\u00e7\u00e3o em si-\nmula\u00e7\u00e3o num\u00e9rica \u00e9 desenvolver t\u00e9cnicas est\u00e1veis, robustas e eficientes para sua aproxima\u00e7\u00e3o. H\u00e1\ndiversas estrat\u00e9gias para a aproxima\u00e7\u00e3o da solu\u00e7\u00e3o de problemas em escoamento multif\u00e1sicos como\no IMPES (implicit in pressure and explicit in saturation), SS (simultaneous solution), sequential\nmethods, adaptative implicit methods, entre outros [53, 55, 133]. Estrat\u00e9gia IMPES se comporta\nbem em problemas com dificuldade e n\u00e3o-linearidades intermedi\u00e1rias, como o escoamento bif\u00e1sico\nincompress\u00edvel e \u00e9 muito usada na ind\u00fastria do petr\u00f3leo [53, 55]. Por\u00e9m, ela n\u00e3o \u00e9 eficiente para\nproblemas com fortes n\u00e3o-linearidades e problemas com mais de duas fases. A t\u00e9cnica SS \u00e9 inte-\nresante para formula\u00e7\u00f5es que envolvem poucas componentes, como o Black-oil e modelos termais\n[55], enquanto que os esquemas sequenciais (sequential methods) s\u00e3o adequados para problemas\ncom muitas componentes, como o modelo composicional [55, 53]. Adaptative implicit methods pro-\ncuram um meio termo entre IMPES (ou SS) e sequential methods [55]. Os esquemas acima foram\ndesenvolvidos pensando nas dificuldades encontradas na aproxima\u00e7\u00e3o de sistemas n\u00e3o-lineares de\nEDPs. Dessa forma, considerando que o foco deste trabalho est\u00e1 na resolu\u00e7\u00e3o de problemas el\u00edpti-\ncos, optamos por uma t\u00e9cnica de decomposi\u00e7\u00e3o de operadores para aproximar a solu\u00e7\u00e3o do sistema\ngovernante de equa\u00e7\u00f5es diferenciais de escoamentos multif\u00e1sicos. Essa t\u00e9cnica \u00e9 interessante pois \u00e9\ncapaz de separar a resolu\u00e7\u00e3o num\u00e9rica dos problemas de press\u00e3o-velocidade e satura\u00e7\u00e3o, de modo a\n\u201cisolar\u201d a EDP el\u00edptica [7, 8, 9, 2]. Podemos ent\u00e3o, escolher m\u00e9todos espec\u00edficos e robustos para re-\nsolver o problema el\u00edptico isoladamente. Outro motivo para a escolha dessa t\u00e9cnica \u00e9 que ela pode\nser empregada em uma grande variedade de problemas de transporte de fluidos. Como veremos no\npr\u00f3ximo cap\u00edtulo, ela engloba, em conjunto a formula\u00e7\u00e3o de fase, problemas com tr\u00eas e duas fases,\ne tamb\u00e9m pode ser empregada em problemas onde h\u00e1 histerese, apresentado na Se\u00e7\u00e3o 2.1.3. A\n\n22\n\n\n\npossibilidade de aplica\u00e7\u00e3o dessa t\u00e9cnica em uma grande variedade de problemas torna a t\u00e9cnica de\ndecomposi\u00e7\u00e3o de operadores interessante de um ponto de vista de implementa\u00e7\u00e3o computacional\npara a simula\u00e7\u00e3o de problemas em din\u00e2mica de fluidos em meios porosos heterog\u00eaneos. Assim,\npodemos nos concentrar somente na aproxima\u00e7\u00e3o do problema de contorno de Poisson associado\nao problema de press\u00e3o-velocidade.\n\nNo pr\u00f3ximo cap\u00edtulo, para ilustrar melhor a t\u00e9cnica de decomposi\u00e7\u00e3o de operadores usada\nvamos nos concentrar na aproxima\u00e7\u00e3o num\u00e9rica das equa\u00e7\u00f5es governantes do problema trif\u00e1sico\n(2.1.19).\n\n23\n\n\n\n24\n\n\n\nCap\u00edtulo 3\n\nModelagem computacional das equa\u00e7\u00f5es\ngovernantes em fen\u00f4menos de transporte\nem meios porosos heterog\u00eaneos\n\nNo Cap\u00edtulo 2 deduzimos por meio da formula\u00e7\u00e3o de fase as equa\u00e7\u00f5es diferenciais governantes\nque modelam o problema de transporte de fluidos em meios porosos heterog\u00eaneos para tr\u00eas e\nduas fases, onde as equa\u00e7\u00f5es s\u00e3o escritas em termos de uma press\u00e3o de refer\u00eancia com respeito\n\u00e0s satura\u00e7\u00f5es das fases presentes no escoamento [7, 8, 9, 2, 55, 54]. Vemos que para esse tipo\nde formula\u00e7\u00e3o, e para outras formula\u00e7\u00f5es, temos uma EDP el\u00edptica associada a um problema de\npress\u00e3o-velocidade, acoplado as equa\u00e7\u00f5es de transporte das satura\u00e7\u00f5es.\n\nH\u00e1 diversas estrat\u00e9gias (citadas brevemente no Cap\u00edtulo 5) para aproximar as equa\u00e7\u00f5es go-\nvernantes resultante das leis b\u00e1sicas de conserva\u00e7\u00e3o, suplementada por rela\u00e7\u00f5es contitutivas que\ntipicamente s\u00e3o obtidas por experimentos de laborat\u00f3rio [7, 8, 9, 2, 55, 54].\n\nComo estamos interessados na resolu\u00e7\u00e3o num\u00e9rica do problema de Poisson, \u00e9 de interesse usar\numa t\u00e9cnica de decomposi\u00e7\u00e3o de operadores para aproximar a solu\u00e7\u00e3o do sistema de equa\u00e7\u00f5es\ngovernantes, de modo a \u201cisolar\u201d a EDP el\u00edptica.\n\nT\u00e9cnicas de decomposi\u00e7\u00e3o de operadores, em conjunto a m\u00e9todos num\u00e9ricos, s\u00e3o usadas com\no intuito de decompor um sistema acoplado de equa\u00e7\u00f5es diferenciais em modelos individuais mais\nsimples, respeitando seu comportamento fisico e matem\u00e1tico, podendo ent\u00e3o aproximar cada um\ndesses modelos atrav\u00e9s de m\u00e9todos num\u00e9ricos apropriados, visando uma maior efici\u00eancia compu-\ntacional [91]. A decomposi\u00e7\u00e3o de operadores \u00e9 regularmente aplicada em diversas \u00e1reas como\ntransporte reativo para combust\u00e3o [135, 86], qu\u00edmica da atmosfera [117, 86, 35, 32], e tamb\u00e9m tem\nsido frequentemente empregada em simula\u00e7\u00e3o de problemas de escoamento em din\u00e2mica de fluidos\nem meios porosos [86, 2, 7, 8, 64].\n\nNeste trabalho usamos uma t\u00e9cnica de decomposi\u00e7\u00e3o de operadores baseada na f\u00edsica onde\no sistema original de equa\u00e7\u00f5es \u00e9 reescrito de modo a exibir claramente a sua natureza f\u00edsica e\nmatem\u00e1tica, ou seja, na forma de modelos hiperb\u00f3lico, parab\u00f3lico, el\u00edptico ou misto no contexto de\nclassifica\u00e7\u00e3o (local) de EDPs que representam os processos fisicos presentes durante o escoamento\nde fluidos em meios porosos.\n\nAo reescrever o sistema original de equa\u00e7\u00f5es, t\u00e9cnicas num\u00e9ricas distintas e apropriadas podem\n\n25\n\n\n\nser empregadas, dentro da formula\u00e7\u00e3o de decomposi\u00e7\u00e3o de operadores, para resolver apropriada-\nmente e eficentemente cada subproblema.\n\nT\u00e9cnicas de decomposi\u00e7\u00e3o de operadores constituem uma das principais pontes entre an\u00e1lise\nnum\u00e9rica e an\u00e1lise funcional. Em an\u00e1lise num\u00e9rica, as t\u00e9cnicas de decomposi\u00e7\u00e3o de operado-\nres representam algoritmos num\u00e9ricos eficientes com o objetivo de aproximar de maneira precisa\nequa\u00e7\u00f5es e sistemas de equa\u00e7\u00f5es diferenciais de evolu\u00e7\u00e3o temporal de forma computacionalmente\nconveniente para incorporar efeitos f\u00edsicos distintos. Em an\u00e1lise funcional, essas t\u00e9cnicas s\u00e3o usadas\npara a demonstra\u00e7\u00e3o de estimativas de erro, exist\u00eancia de solu\u00e7\u00e3o e teoremas de representa\u00e7\u00e3o.\nOs artigos [80, 57, 144] discutem os usos da t\u00e9cnica de decomposi\u00e7\u00e3o de operadores e indicam\numa grande variedade de refer\u00eancias na literatura. Veja tamb\u00e9m os trabalhos [109, 63, 107, 108,\n86, 110, 104, 56, 4, 5, 8, 2] para desenvolvimentos recentes na an\u00e1lise dos erros presentes na de-\ncomposi\u00e7\u00e3o de operadores (time-splitting errors) para problemas unidimensionais n\u00e3o lineares de\nconvec\u00e7\u00e3o-difus\u00e3o.\n\nNeste cap\u00edtulo iremos aplicar uma t\u00e9cnica de decomposi\u00e7\u00e3o de operadores no sistema de equa-\n\u00e7\u00f5es governantes (2.1.19) do modelo trif\u00e1sico com gravidade, com a inten\u00e7\u00e3o de \u201cisolar\u201d o problema\nde Poisson para aproxima\u00e7\u00e3o num\u00e9rica.\n\n3.1 Decomposi\u00e7\u00e3o de operadores\nPara ilustar melhor a t\u00e9cnica de decomposi\u00e7\u00e3o de operadores usada vamos nos concentrar na\n\naproxima\u00e7\u00e3o num\u00e9rica das equa\u00e7\u00f5es governantes do problema trif\u00e1sico (2.1.19).\nA t\u00e9cnica usada \u00e9 um procedimento baseado na decomposi\u00e7\u00e3o de operadores de dois n\u00edveis,\n\nde maneira a desacoplar as equa\u00e7\u00f5es (2.1.19), [86, 110, 64, 2, 7]. No primeiro n\u00edvel, separamos o\nc\u00e1lculo do problema de press\u00e3o-velocidade (2.1.17), de natureza el\u00edptica, do c\u00e1lculo do problema\nde transporte das satura\u00e7\u00f5es (2.1.13). No segundo n\u00edvel, separamos o c\u00e1lculo das satura\u00e7\u00f5es em\nc\u00e1lculo de subproblemas de transporte difusivo, de natureza parab\u00f3lica, e de transporte convec-\ntivo, de natureza hiperb\u00f3lica. Essa estrat\u00e9gia reflete as diferentes naturezas matem\u00e1ticas e f\u00edsicas\npresentes na formula\u00e7\u00e3o do problema de transporte de fluidos em meios porosos heterog\u00eaneos [7]-\n[13]. Assim, podemos usar diferentes estrat\u00e9gias de aproxima\u00e7\u00e3o para cada subproblema, ou seja,\npodemos escolher o m\u00e9todo num\u00e9rico mais apropriado para a resolu\u00e7\u00e3o de cada subproblema se\nadaptando as suas caracter\u00edsticas fisicas inerentes.\n\nBasicamente, essa t\u00e9cnica de decomposi\u00e7\u00e3o de operadores aproxima sequencialmente os proble-\nmas de press\u00e3o-velocidade, transporte difusivo e transporte convectivo, com m\u00e9todos num\u00e9ricos\nespec\u00edficos a cada um deles, de maneira iterativa. A solu\u00e7\u00e3o aproximada de cada problema \u00e9 usada\nna resolu\u00e7\u00e3o num\u00e9rica do problema seguinte, e assim por diante at\u00e9 o fim da simula\u00e7\u00e3o. Isso per-\nmite que o passo de tempo para a atualiza\u00e7\u00e3o do campo de velocidades para o c\u00e1lculo do problema\nde press\u00e3o-velocidade seja maior do que o usado para o problema de difus\u00e3o, que por sua vez pode\nser maior do que o passo do c\u00e1lculo que incorpora os efeitos de convec\u00e7\u00e3o [7, 2]. Desta maneira,\ntr\u00eas passos de tempo s\u00e3o naturalmente introduzidos na decomposi\u00e7\u00e3o de operadores: ??? para a\nsolu\u00e7\u00e3o do problema hiperb\u00f3lico associado ao transporte convectivo de fluidos, ??? para o c\u00e1lculo\ndos efeitos difusivos, e ??? para a solu\u00e7\u00e3o do problema de press\u00e3o-velocidade, de modo que\n\n??? ? ??? ? ???. (3.1.1)\n\n26\n\n\n\nOs problemas hiperb\u00f3lico e parab\u00f3lico n\u00e3o ser\u00e3o tratados nesse trabalho.\nA velocidade v \u00e9 uma fun\u00e7\u00e3o suave no tempo [11] como uma fun\u00e7\u00e3o das satura\u00e7\u00f5es (??, ??). Por\n\nesse motivo resolvemos primeiramente as equa\u00e7\u00f5es de press\u00e3o-velocidade. Consideramos tamb\u00e9m\nas satura\u00e7\u00f5es no tempo presente de modo a linearizar seus coeficientes n\u00e3o-lineares. Ap\u00f3s encontrar\no campo de velocidades ele \u00e9 usado para calcular as satura\u00e7\u00f5es no no tempo seguinte via a equa\u00e7\u00e3o\n(2.1.13) [2, 7].\n\nEm resumo, o procedimento de resolu\u00e7\u00e3o temporal, por decomposi\u00e7\u00e3o de operadores, \u00e9:\n\n?? = ????, ?? = ????, e ??,? = ?? + ????, 0 ? ? ? ?2, (3.1.2)\n\nde forma que ??,?2 = ??+1. A press\u00e3o do \u00f3leo e a velocidade de Darcy ser\u00e3o aproximadas nos\ntempos ??, ? = 0, 1, 2, . . . . As satura\u00e7\u00f5es ??, e ?? ser\u00e3o aproximadas nos tempos ??, ? = 1, 2, . . . ,\nlembrando que elas devem ser dadas no tempo ? = 0. Al\u00e9m disso, temos valores de satura\u00e7\u00e3o\ncomputados em tempos intermedi\u00e1rios ??,?, para ?? &lt;??,? ? ??+1, onde resolvemos o subproblema\nhiperb\u00f3lico levando em conta o transporte convectivo da \u00e1gua e/ou g\u00e1s, mas n\u00e3o os efeitos difusivos.\nO algoritmo para a resolu\u00e7\u00e3o \u00e9 detalhado abaixo.\n\nPrimeiro n\u00edvel:\n\n1. Dados ??? (x) e ??? (x), ? ? 0, determine o par (??? , v?) atrav\u00e9s das equa\u00e7\u00f5es do problema\nde press\u00e3o-velocidade (2.1.17), sujeito as condi\u00e7\u00f5es de contorno dadas.\n\n2. Para ?? &lt;? ? ??+1, resolva o sistema de difus\u00e3o-convec\u00e7\u00e3o (2.1.13) com condi\u00e7\u00f5es iniciais\n??(x, ??) = ??? (x) e ??(x, ??) = ??? (x); ??? (x) e ??? (x) s\u00e3o dados como os valores finais\ncalculados em [???1, ??] para ? > 0 ou como a satura\u00e7\u00e3o inicial para ? = 0.\n\nSegundo n\u00edvel:\n\n1. Seja ??1 = ?? e assuma que (??, v, ??, ??) s\u00e3o conhecidos em ? ? ??1.\n\n2. Para ? = ?1, . . . , ?2 = ?1 + (?1 ? 1):\nPrimeiro, para ? = 0, . . . , (?2 ? 1) e ? ? [??,?, ??,?+1], resolva o sistema convectivo dado por\n(??,?? \u00e9 substituido por ??? abaixo)\n\n?\n\n??\n(?(x) ???)+?\u00b7[E(??,?, v) ?\n\n?\n? +G\n\n?\n?] = 0,\n\n?\n\n??\n(?(x) ??? )+?\u00b7[E(??,?, v) ?\n\n?\n? +G\n\n?\n? ] = 0, (3.1.3)\n\n??,? &lt;? &lt;??,?+1, com condi\u00e7\u00f5es iniciais,\n\n??? (x, ??,?) =\n{?\n\n??(x, ??), ? = 0,\n???1? (x, ??,?), ? = 1, . . . , ?2 ? 1,\n\n(3.1.4)\n\ne condi\u00e7e?s de contorno,\n\n[E(??,?, v) ? ?? + G\n?\n?] \u00b7 ? = ? ??(?\n\n?\n? , ?\n\n?\n? ), [E(??,?, v) ?\n\n?\n? + G\n\n?\n? ] \u00b7 ? = ? ??(?\n\n?\n? , ?\n\n?\n? ), (3.1.5)\n\npara (?, ?) ? {0} \u00d7 [0, ? ], e ? = ?, ?, onde ??? , ??? s\u00e3o as satura\u00e7\u00f5es da \u00e1gua e do g\u00e1s\ninjetada na mistura e ? denota a raz\u00e3o de inje\u00e7\u00e3o volum\u00e9trica dos fluidos de inje\u00e7\u00e3o; o\noperador E(??,?, v) extrapola linearmente o campo de velocidades v??1 e v? no tempo\n??,? ? (??, ??+1).\n\n27\n\n\n\n3. Tome ??(x, ??) = ??2?1? (x, ??,?2 ), ? = ?, ?.\nResolvemos o subproblema difusivo nos tempos ?? = ????, ? = 1, 2, . . . ; lembrando que eles\nprecisam ser especificados em ? = 0,\n\n?\n\n??\n(?(x) ??) ? ? \u00b7 w? = 0,\n\n?\n\n??\n(?(x) ??) ? ? \u00b7 w? = 0, (3.1.6)\n\n?? &lt;? &lt;??+1, com condi\u00e7\u00f5es iniciais e de contorno,\n\nw? \u00b7 ? = 0, ? = ?, ?, x ? ??, ??(x, ??) = ???1,?2?1? (x, ??), ? = ?, ?, (3.1.7)\n\nonde ??,?? \u00e9 definido em (3.1.3)-(3.1.4).\n\nEste algoritmo deve ser repetido at\u00e9 o fim estipulado do tempo de simula\u00e7\u00e3o [7, 8, 9].\n\nCom a decomposi\u00e7\u00e3o de operadores \u201cisolamos\u201d o problema de press\u00e3o-velocidade, o qual est\u00e1\nassociado a um problema de natureza el\u00edptica. Dessa forma, podemos nos concentrar em t\u00e9cnicas\nde discretiza\u00e7\u00e3o e m\u00e9todos num\u00e9ricos que melhor se aplicam para a aproxima\u00e7\u00e3o do problema de\nPoisson levando em conta sua origem.\n\nNo cap\u00edtulo seguinte aplicaremos o m\u00e9todo de elementos finitos mistos para discretizar o pro-\nblema de press\u00e3o-velocidade.\n\n28\n\n\n\nCap\u00edtulo 4\n\nAproxima\u00e7\u00e3o num\u00e9rica das equa\u00e7\u00f5es\ndiferenciais parciais governantes\n\nAp\u00f3s a aplica\u00e7\u00e3o da decomposi\u00e7\u00e3o de operadores no cap\u00edtulo anterior, o problema el\u00edptico \u00e9\ntotalmente identificado ap\u00f3s uma conveniente lineariza\u00e7\u00e3o do coeficiente do fluxo de velocidade,\nou lei de Darcy [136, 137, 41, 39]. Agora, precisamos nos concentrar em escolher uma metodologia\npara aproximar o problema el\u00edptico. Fundamentalmente, essa escolha deve ser guiada pela natureza\nmatem\u00e1tica do modelo diferencial sob investiga\u00e7\u00e3o tendo em vista que se espera recuperar no n\u00edvel\ndiscreto, as mesmas propriedades f\u00edsicas (e matem\u00e1ticas) do modelo original posto no cont\u00ednuo.\nNeste contexto, pode-se citar v\u00e1rias t\u00e9cnicas para discretiza\u00e7\u00e3o de problemas el\u00edpticos, como por\nexemplo, Diferen\u00e7as Finitas [147, 140], Volumes Finitos [74, 153], Diferen\u00e7as finitas mim\u00e9ticas (ou\nMimetic finite differences) [119, 28, 40, 140], Elementos Finitos (cl\u00e1ssico) [39], Elementos Finitos\nda classe Galerkin Descont\u00ednuo [67, 23, 134], Elementos Finitos Mistos H\u00edbridos em espa\u00e7os ?(???)\n[136, 137, 41] entre outros, como elementos finitos generalizados [26].\n\nNeste trabalho adotamos a abordagem de discretiza\u00e7\u00e3o por Elementos Finitos Mistos H\u00edbridos\nem espa\u00e7os ?(???) de Raviart-Thomas de menor \u00edndice [136, 137, 41]. A escolha dessa abordagem\n\u00e9 motivada fundamentalmente pela sua bem sucedida aplica\u00e7\u00e3o em problemas trif\u00e1sicos [2, 6,\n14, 8, 5, 4, 11, 7, 13, 10, 9] e previamente pelo bom desempenho na aproxima\u00e7\u00e3o num\u00e9rica e\nsimula\u00e7\u00e3o de escoamentos bif\u00e1sicos \u00e1gua-\u00f3leo, dentro da tradi\u00e7\u00e3o estabelecida por Jim Douglas\nJr., Richard Ewing, Thomas F. Russell e Mary F. Wheeler nos trabalhos conjuntos [65, 83, 69,\n84, 138] e mais recentemente nos trabalhos [7, 9, 18, 73, 72, 71] e nas refer\u00eancias l\u00e1 citadas. Nesta\ns\u00e9rie de trabalhos, elementos finitos mistos h\u00edbridos foram identificados como muito apropriados\npara calcular, de forma precisa, campos de velocidade na presen\u00e7a de heterogeneidades geol\u00f3gicas\ndo meio poroso. Isto \u00e9, ele trata de forma eficiente a alta variabilidade dos valores dos campos\nde permeabilidade e porosidade. Al\u00e9m disso, \u00e9 v\u00e1lido mencionar que a formula\u00e7\u00e3o de elementos\nfinitos mistos h\u00edbridos possui um rigorosa fundamenta\u00e7\u00e3o matem\u00e1tica e tem conex\u00e3o refinada com\ndistintas abordagens em an\u00e1lise num\u00e9rica para problemas el\u00edpticos [136, 137, 41, 39, 23, 153, 28].\n\nNeste cap\u00edtulo discutiremos em detalhes discretiza\u00e7\u00e3o por elementos finitos mistos h\u00edbridos\ndo subproblema el\u00edptico associado ao problema de press\u00e3o-velocidade (2.1.17) do modelo trif\u00e1sico\ncom gravidade. Para o modelo bif\u00e1sico, a discretiza\u00e7\u00e3o \u00e9 an\u00e1loga [41, 39, 52]. A ideia b\u00e1sica\n\u00e9 obter, ap\u00f3s a discretiza\u00e7\u00e3o, um sistema linear com boas propriedades matem\u00e1ticas, como ser\n\n29\n\n\n\n\u201cbem condicionada\u201d e ter uma natureza localmente conservativa no n\u00edvel discreto, tal qual seu\ncorresponde operador diferencial no cont\u00ednuo.\n\nIremos tamb\u00e9m citar, brevemente, t\u00e9cnicas localmente conservativas para a aproxima\u00e7\u00e3o dos\nsubproblemas hiberb\u00f3lico e parab\u00f3lico obtidos ap\u00f3s a aplica\u00e7\u00e3o da t\u00e9cnica de decomposi\u00e7\u00e3o de\noperadores. No entanto, a aproxima\u00e7\u00e3o desses problemas n\u00e3o ser\u00e1 o foco nesse trabalho.\n\n4.1 Discretiza\u00e7\u00e3o do sistema parab\u00f3lico e hiperb\u00f3lico de\nEDPs associado ao problema de transporte de convec\u00e7\u00e3o-\ndifus\u00e3o\n\nA t\u00e9cnica de decomposi\u00e7\u00e3o de operadores empregada no cap\u00edtulo anterior nos permite separar\nos processos fis\u00edcos que atuam no modelo de escoamento trif\u00e1sico em meios porosos heterog\u00eaneos.\nNosso interesse principal neste trabalho \u00e9 na resolu\u00e7\u00e3o do subproblema el\u00edptico associado ao pro-\nblema de press\u00e3o-velocidade. Por\u00e9m n\u00e3o podemos esquecer que esse problema est\u00e1 associado a\num sistema de transporte de satura\u00e7\u00f5es, e como vimos no cap\u00edtulo anterior, a EDP el\u00edptica \u00e9\nresolvida em conjunto (e em sequ\u00eancia) aos subproblemas de difus\u00e3o (parab\u00f3lico) e convecc\u00e7\u00e3o\n(hiperb\u00f3lico), pela t\u00e9cnica de decomposi\u00e7\u00e3o de operadores de modo a aproximar numericamente a\nsolu\u00e7\u00e3o do problema trif\u00e1sico de transporte de fluidos em meios porosos heterog\u00eaneos. A resolu\u00e7\u00e3o\ndos subproblemas parab\u00f3lico e hiperb\u00f3lico n\u00e3o ser\u00e1 discutido neste trabalho, no entando existe\ndiversas t\u00e9cnicas usadas para a aproxima\u00e7\u00e3o desses problemas [7]-[13].\n\nDas t\u00e9cnicas existentes para aproximar problemas parab\u00f3licos temos, por exemplo, Diferen\u00e7as\nFinitas, Volumes Finitos [133, 55, 53]. Temos tamb\u00e9m o m\u00e9todo de elementos finitos mistos\nhibridos em conjunto a uma estrat\u00e9gia impl\u00edcita para discretizar o operador temporal [2, 9, 10].\n\nPara o subproblema hiperb\u00f3lico temos os esquemas conservativos centrais de diferen\u00e7as fi-\nnitas como o Nessyahu-Tadmor (NT) [129] e Kurganov-Tadmor (KT) [114]. H\u00e1 tamb\u00e9m os m\u00e9-\ntodos Euleriano-Lagrangeanos como o Modified Method of Characteristics (MMOC) [61], Eulerian-\nLagrangian Localized Adjoint Methods (ELLAM) [62, 47], e Locally Conservative Eulerian-Lagrangian\nMethod (LCELM) [18, 73], por\u00e9m a extens\u00e3o dessa \u00faltima classe de m\u00e9todos para sistemas de leis\nde conserva\u00e7\u00e3o ainda n\u00e3o \u00e9 bem entendido. Logo essas metodologias ainda n\u00e3o podem ser aplica-\ndas a problemas trif\u00e1sicos e bif\u00e1sicos. Outro m\u00e9todo importante para problemas hiperb\u00f3licos \u00e9 o\nm\u00e9todo de Godunov [98]. Ele \u00e9 bastante usado em problemas que apresentam descontinuidade na\nsolu\u00e7\u00e3o. Para uma maior discuss\u00e3o da aproxima\u00e7\u00e3o desses sub-problemas no contexto de din\u00e2mica\nde fluidos indica-se os trabalhos [2, 6, 14, 8, 5, 4, 11, 7, 13, 89, 22, 21, 73, 72, 71, 24, 18].\n\nNas pr\u00f3ximas se\u00e7\u00f5es apresentamos o m\u00e9todo de elementos finitos mistos para a discretiza\u00e7\u00e3o\ndo problema de press\u00e3o-velocidade.\n\n30\n\n\n\n4.2 Discretiza\u00e7\u00e3o por elementos finitos mistos da EDP el\u00edp-\ntica associada ao problema de press\u00e3o e velocidade\n\nTendo separado a equa\u00e7\u00e3o de press\u00e3o-velocidade (2.1.17) no Cap\u00edtulo 3 vamos aproximar o\npar (?, ??) atrav\u00e9s do m\u00e9todo de elementos finitos mistos h\u00edbridos. Efetivamente, as simula\u00e7\u00f5es\nnum\u00e9ricas para a previs\u00f5es de cen\u00e1rios e tomada de decis\u00f5es do problema de escoamento em meios\nporosos heterog\u00eaneo requerem uma aproxima\u00e7\u00e3o muito boa do campo de velocidades dos fluidos\nem movimento. Por esta raz\u00e3o m\u00e9todos mistos s\u00e3o adequados para a aproxima\u00e7\u00e3o simult\u00e2nea das\nequa\u00e7\u00f5es de press\u00e3o e velocidade [55, 53, 7, 9, 73, 72, 71].\n\nDurante todo esse trabalho iremos trabalhar com um dom\u00ednio bidimensional, por\u00e9m as ideias\ndescritas em detalhes aqui podem ser facilmente extendidas para dom\u00ednios tridimensionais sem\ndificuldades, dado que ?? seja aproximado por constantes em cada elemento. Elementos de ordem\nmaior precisariam de algumas modifica\u00e7\u00f5es n\u00e3o triviais no m\u00e9todo [2]. Para dom\u00ednios unidimen-\nsionais as ideias tamb\u00e9m se aplicam, mas precisam de certos cuidados.\n\nConsidere um reservat\u00f3rio horizontal, sem influ\u00eancia da gravidade no escoamento do fluido.\nConsidere tamb\u00e9m um dom\u00ednio computacional retangular particionado em quadrados uniformes\nusando o espa\u00e7o de Raviart-Thomas retangular mais simples [136] nessa parti\u00e7\u00e3o, i.e., ? ? ?? = ??.\nSem perda de generalidade, seja ? = [0, ?] \u00d7 [0, ? ] ? R2 um dom\u00ednio ret\u00e2ngular limitado com\numa fronteira Lipschitz ??. Seja {?? , ? = 1, . . . , ? } uma parti\u00e7\u00e3o de ?:\n\n?? = ???=1??? ; ?? ? ?? = ?, ? ?= ?. (4.2.1)\n\nSuponha que ??? , ? = 1, . . . , ? , tamb\u00e9m \u00e9 Lipschitz e ?? = ?? \u00d7 ?? = ? \u00d7 ?. Defina ? = ??, e\n\n?? = ? ? ??? , ??? = ??? = ??? ? ???. (4.2.2)\n\nVamos reescrever o problema de press\u00e3o-velocidade (2.1.17) em uma forma mais conveniente,\nfacilitando os c\u00e1lculos. Definindo u = (v ? v?? ? v??) podemos reescrever essa equa\u00e7\u00e3o na forma,\n\n? \u00b7 u = ?? , u = ??(x)?(??, ??)??, x ? ? ? R2, (4.2.3)\n\nonde ?? = ?? \u00b7 (v?? + v??) e ? ? ??, sujeito as seguintes condi\u00e7\u00f5es de contorno,\n\nu \u00b7 n =\n{?\n\n??, para ? = {0}, ? ? [0, ? ],\n0, para ? = {0, ? }, ? ? [0, ?], (4.2.4)\n\nonde n \u00e9 o vetor unit\u00e1rio normal externo \u00e0 fronteira ?? e ? \u00e9 a taxa de inje\u00e7\u00e3o do fluido. Tamb\u00e9m\nmantemos uma press\u00e3o de refer\u00eancia ???? em ? = {?} e ? ? [0, ? ], como visto na Figura 4.1.\n\nInicialmente iremos tratar do caso em que {?? } \u00e9 uma parti\u00e7\u00e3o do dom\u00ednio ? em elementos\nindividuais e vamos discutir a forma fraca da equa\u00e7\u00e3o de press\u00e3o-velocidade (4.2.3).\n\nIntroduzimos os seguintes espa\u00e7os globais:\n\n?2(?) = {? |\n??\n\n?|?(?)|2 ?? &lt;?}, ?(div; ?) = {u ? (?2(?))2 | div u ? ?2(?)},\n? (?) = {? ? ?2(?) |\n\n??\n? ?(?) ?? = 0}, ??(?) = {u ? ?(div; ?) | u \u00b7 n = ? em ??}.\n\n31\n\n\n\nFigura 4.1: Dom\u00ednio retangular do problema de press\u00e3o-velocidade (4.2.3)-(B.2.2).\n\nA forma fraca global da equa\u00e7\u00e3o de press\u00e3o-velocidade (4.2.3) \u00e9 dada [41] por: encontrar {?, u} ?\n? \u00d7 ?? tal que,\n\n(??1? ?1u, u?) + (??, u?) = 0, u? ? ?0, (4.2.5)\n(? \u00b7 u, ?) = (?? , ?), ? ? ?2(?). (4.2.6)\n\nAgora, vamos definir a forma fraca localmente nos elementos {?? }. Isto \u00e9, considere os problemas\nnas parti\u00e7\u00f5es {?? }, ? = 1, . . . , ? , e defina os espa\u00e7os,\n\n??,? = {u ? u(?? )) | u \u00b7 n? = ? em ?? }, ?? = {? |?? | ? ? ? (?)},\n\ne queremos que {u? , ?? } (definindo ?? = ?|?? , etc.) seja solu\u00e7\u00e3o de (4.2.5)-(4.2.6) para x ? ?? ,\n? = 1, . . . , ? , dessa forma \u00e9 necess\u00e1rio impor condi\u00e7\u00f5es de consist\u00eancia [2, 85, 10],\n\n?? = ??, ? ? ???, (4.2.7)\nu? \u00b7 n? + u? \u00b7 n? = 0, ? ? ???, (4.2.8)\n\nonde n? \u00e9 o vetor normal externo ao elemento ?? ? ?.\nA formula\u00e7\u00e3o fraca local do sistema de press\u00e3o-velocidade (4.2.5)-(4.2.6) correspondente a de-\n\ncomposi\u00e7\u00e3o de dom\u00ednios acima \u00e9 dada ao procurar solu\u00e7\u00f5es aproximadas ? ? ? e u ? ?? tal que,\n{?? , u? } ? ?? \u00d7 ??,? e que, ap\u00f3s aplicar o teorema da diverg\u00eancia no termo (??, u?) [41] fica,\n\n(? \u00b7 u, ?)?? ? (?? , ?)?? = 0, ? ? ?? , (4.2.9)\n(? ?1??1u, u?)?? ? (?, ? \u00b7 u?)?? +\n\n??\n? ?=?\n\n??, u? \u00b7 n? ???? = 0, u? ? ??,? , (4.2.10)\n\nQuando o sistema (4.2.9)-(4.2.10) \u00e9 aproximado no espa\u00e7o de Raviart-Thomas obtemos um\nsistema linear por blocos do tipo, [30],(?\n\nA ?B?\nB 0\n\n)?(?\nu\np\n\n)?\n=\n(?\n\nRu\nRp\n\n)?\n(4.2.11)\n\nonde a matriz A \u00e9 sim\u00e9trica definida positiva, a matriz (?B?) representa uma aproxima\u00e7\u00e3o do\noperador divergente e B uma discretiza\u00e7\u00e3o do operador gradiente [30, 41]. Esse \u00e9 um problema\nindefinido, chamado de problema de ponto de sela.\n\n32\n\n\n\nH\u00e1 v\u00e1rias possibilidades de resolver o sistema (4.2.11). Uma dessas possibilidades \u00e9 reformul\u00e1-\nlo como um problema do tipo complemento de Shur, por meio de elimina\u00e7\u00e3o de Gauss por blocos\n[30, 41]. Outros m\u00e9todos num\u00e9ricos que resolvem (4.2.11) s\u00e3o os m\u00e9todos iterativos do tipo ponto\nfixo. Entre esses m\u00e9todos est\u00e1 o m\u00e9todo de Uzawa e o m\u00e9todo de Arrow-Hurwicz [30, 41, 52].\n\nOutra forma de resolver o problema de ponto de sela, e que iremos descrever neste trabalho, \u00e9\nreescrever convenientemente o problema via multiplicadores de Lagrange [41, 52], de modo que o\nsistema linear equivalente tenha uma matriz que seja sim\u00e9trica e definida positiva.\n\nA seguir, introduzimos os multiplicadores de Lagrange, definidos como a press\u00e3o nas fronteiras\ndos elementos, de modo a transformar o problema de ponto de sela em um problema sim\u00e9trico e\ndefinido positivo.\n\n4.2.1 Elementos Finitos Mistos H\u00edbridos\nSeja ? ?? \u00d7 ? ?? o espa\u00e7o de elementos finitos mistos sobre {?? }. Cada um desses espa\u00e7os \u00e9\n\ndefinido atrav\u00e9s de espa\u00e7os locais ? ?? \u00d7 ? ?? = ? ?(?? ) \u00d7 ? ?(?? ), [2, 41, 9].\nEm cada espa\u00e7o de elementos mistos, as fun\u00e7\u00f5es genericas ? ? ? ?? e u ? ? ?? podem ser\n\ndescont\u00ednuas em ???. Como consequ\u00eancia, tentar impor as condi\u00e7\u00f5es de consist\u00eancia (4.2.7) e\n(4.2.8) for\u00e7aria a continuidade da press\u00e3o ?, ou seja, as condi\u00e7\u00f5es de consist\u00eancia (4.2.7) e (4.2.8)\nn\u00e3o seriam satisfeitas a n\u00e3o ser que a solu\u00e7\u00e3o aproximada da press\u00e3o fosse constante em todo\no dom\u00ednio [71]. Esse caso n\u00e3o \u00e9 interessante no contexto desse trabalho. Estamos interessados\nem meios heterog\u00eaneos, onde a grande variabilidade das propriedades do meio causa gradientes\nabruptos de press\u00e3o, i.e., a press\u00e3o n\u00e3o \u00e9 constante.\n\nDessa forma, introduzimos os multiplicadores de Lagrange ??? nas arestas {???}, [2, 10]. Os\nmultiplicadores de Lagrange podem ser fisicamente definidos como press\u00e3o nas fronteiras, e seu\nprincipal prop\u00f3sito \u00e9 introduzir um novo par\u00e2metro de modo a relaxar as condi\u00e7\u00f5es de consist\u00eancia.\nDessa forma o m\u00e9todo permite uma maior flexibilidade no tratamento de press\u00f5es descont\u00ednuas, o\nque \u00e9 de extremo interesse nesse trabalho. Caracter\u00edsticas multiescala do meio poroso heterog\u00eaneo\nsignificam grande variabilidade das propriedades geol\u00f3gicas das rochas, como permeabilidade e\nporosidade, e elas influenciam fortemente o transporte de fluidos no meio. Ent\u00e3o \u00e9 razo\u00e1vel esperar\na forma\u00e7\u00e3o de gradientes abruptos de press\u00e3o durante todo o escoamento do fluido, de modo\nque formula\u00e7\u00f5es num\u00e9ricas para a aproxima\u00e7\u00e3o das equa\u00e7\u00f5es governantes devem tratar bem o\naparecimento de press\u00f5es descont\u00ednuas.\n\nSuponha que, quando u?? = u?|?? , u? ? ? ?, sua componente normal u?? \u00b7 n? em ??? \u00e9 um\npolin\u00f4mio de grau fixo ? = grau(u?? \u00b7 n? ), por simplicidade supomos que ? \u00e9 independente de ???.\nSeja, ???? ? ??(?? ) definido pela proje\u00e7\u00e3o,\n\n?? ? ???? , u? \u00b7 n? ??? = 0, u? \u00b7 n? ? ??(?? ), ?? ?= ?. (4.2.12)\nE seja,\n\n? ? = {u ? ?(div; ?) | u? ? ? ?? e u? \u00b7 n? |?? = ???? }, ? ? = {? ? ?2(?? ) | ?? ? ? ?? },\n?? = {? : ?|??? ? ??(???) = ???, ??? ?= ?}.\n\nNote que h\u00e1 duas c\u00f3pias de ?? associadas ao conjunto ???: ??? e ??? .\n\n33\n\n\n\nO m\u00e9todo de elementos finitos h\u00edbridos \u00e9 dado [52] por: Procurar {?? , u? , ???} ? ? ?? \u00d7 ? ?? \u00d7 ???,\n? = 1, . . . , ? , tal que para todo u? ? ? ?, ? ? ? ? e ?? ? ??:\n\n(? \u00b7 u? , ?)?? ? (?? , ?)?? = 0, (4.2.13)\n\n(? ?1??1u? , u?) ? (?? , ?\u00b7u?)?? +\n??\n? ?=?\n\n????, u? \u00b7 n? ???? = 0, (4.2.14)\n\n???\n?=1\n\n(??, u? \u00b7 n? )?? = 0. (4.2.15)\n\nA inclus\u00e3o dos multiplicadores de Lagrange transforma o problema de ponto de sela (4.2.11)\nem um novo problema dado por [52, 41]:\n\n?\n?? A B CB? 0 0\n\nC? 0 0\n\n?\n??\n?\n??up\n\n?\n\n?\n?? =\n\n?\n??fg\n\n0\n\n?\n?? , (4.2.16)\n\nonde A \u00e9 uma matriz diagonal por blocos, e cada bloco corresponde a um elemento ?? [52]. O\nsistema linear (4.2.16) representa as equa\u00e7\u00f5es (4.2.13)-(4.2.15) ap\u00f3s a introdu\u00e7\u00e3o das fun\u00e7\u00f5es de\nbase para os espa\u00e7os ? ?, ? ? e ??.\n\nA matriz A do sistema linear (4.2.16) \u00e9 facilmente invers\u00edvel a n\u00edvel de elemento. Dessa forma,\npodemos escrever a primeira equa\u00e7\u00e3o de (4.2.16) como,\n\nu = A?1(f ? Bp ? C?). (4.2.17)\n\nSubstituindo (4.2.17) nas outras equa\u00e7\u00f5es de (4.2.16) temos que,\n\nB?A?1Bp + B?A?1C? = g ? B?A?1f (4.2.18)\nC?A?1Bp + C?A?1C? = ?C?A?1f (4.2.19)\n\nSabemos que C?A?1C \u00e9 sim\u00e9trica definida positiva [154]. Assim, podemos reescrever a equa\u00e7\u00e3o\n(4.2.19),\n\n? = (C?A?1C)?1\n[?\n?C?A?1Bp ? C?A?1f\n\n]?\n(4.2.20)\n\nE substituindo a equa\u00e7\u00e3o acima em (4.2.18) temos um sistema linear Hp = R,\n\nH = B?A?1B ? (B?A?1C)(C?A?1C)?1(C?A?1B) (4.2.21)\n= B?A?1\n\n[?\nI ? C(C?A?1C)?1C?A?1\n\n]?\nB. (4.2.22)\n\nA identidade em colchetes \u00e9 uma proje\u00e7\u00e3o ortogonal, assim a matriz H \u00e9 n\u00e3o-negativa e si-\nm\u00e9trica. Como a solu\u00e7\u00e3o do m\u00e9todo misto hibrido \u00e9 \u00fanica [46, 52, 41], temos que H \u00e9 sim\u00e9trica\ndefinida positiva. Assim, podemos reescrever o problema (4.2.13)-(4.2.15) para a vari\u00e1vel ? por\nmeio de um sistema linear onde a matriz \u00e9 sim\u00e9trica definida positiva.\n\n34\n\n\n\n4.2.2 Equa\u00e7\u00f5es discretas e elimina\u00e7\u00e3o do multiplicadores de Lagrange\ne fluxos.\n\nConsidere um elemento ?? . Escolhemos o espa\u00e7o de elementos finitos mistos ? ?? \u00d7 ? ?? como\nsendo o espa\u00e7o de Raviart-Thomas de menor \u00edndice sobre um quadrado de lado ?. Denominamos\nas fronteiras ??? do elemento ?? como ???, ? = ?, ?, ?, ?, indicando as arestas \u00e0 direita (Right), \u00e0\nesquerda (Left), acima (Up), e abaixo (Down) respectivamente. Dessa maneira, sobre um elemento\nfinito ?? existem nove graus de liberdade, ver Figura 4.2: um para a press\u00e3o ?? no centro do\nelemento ?? e quatro valores constantes para os multiplicadores de Lagrange ??? e para os fluxos\nnas fronteiras ??? = u? \u00b7 n??, um por aresta.\n\nVamos usar como fun\u00e7\u00f5es de base para o espa\u00e7o ? ?? as fun\u00e7\u00f5es [41, 52, 136],\n\ne? =\n(?\n\n?\n\n?\n, 0\n)?\n\n, e? =\n(?\n\n?\n\n?\n? 1, 0\n\n)?\n, (4.2.23)\n\ne? =\n(?\n\n0,\n?\n\n?\n\n)?\n, e? =\n\n(?\n0,\n\n?\n\n?\n? 1\n\n)?\n, (4.2.24)\n\n(4.2.25)\n\nde modo a escrever u? = ???e? + ???e? + ??? e? + ???e?. Agora, a partir das fun\u00e7\u00f5es de base\nvamos obter a forma discreta das equa\u00e7\u00f5es (4.2.13)-(4.2.14). Fazendo uso da regra do trap\u00e9zio para\na integra\u00e7\u00e3o dos termos obtemos (omitindo o \u00edndice ? por motivos de simplifica\u00e7\u00e3o) as seguintes\nequa\u00e7\u00f5es discretas para o elemento ?? ,\n\n?? + ?? + ?? + ?? = ?? ?, (4.2.26)\n\n?? ?\n2? ?\n\n?\n(? ? ??) = 0, ? = ?, ?, ?, ?, (4.2.27)\n\n? e ? est\u00e3o definidos nos centros dos elementos.\nNote que em (B.3.3)-(B.3.4) temos cinco equa\u00e7\u00f5es e nove vari\u00e1veis. Ent\u00e3o precisamos incluir\n\nmais quatro equa\u00e7\u00f5es ou eliminar quatro vari\u00e1veis de modo a obter um sistema linear consistente.\nEscolhemos eliminar quatro vari\u00e1veis, os multiplicadores de Lagrange, pois como vimos anterior-\nmente obtemos um sistema com uma matriz definida positiva, a qual possui boas propriedades.\n\nAs condi\u00e7\u00f5es de consist\u00eancia para a press\u00e3o de refer\u00eancia (?) e velocidade de Darcy (u), ex-\npressas nas fronteiras dos elementos por (4.2.7)-(4.2.8), requer que,\n\n?? = ???? , ?? + ????? = 0, ? = ?, ?, ?, ?, e ?? = ?, ?, ?, ?, (4.2.28)\n\no subescrito ?? indica o multiplicador de Lagrange (na fronteira ??) do elemento adjacente a ?? que\ncompartilha a mesma aresta ? com o elemento ?? , como podemos ver na Figura 4.2. Introduzimos\no superescrito ?? para denotar as vari\u00e1veis dos elementos adjacentes a ?? . Assim, combinando as\nequa\u00e7\u00f5es (B.3.3)-(4.2.28) temos,\n\n?? ?\n2? ?\n\n?\n(? ? ??) = 0, ????? ?\n\n2???? ????\n?\n\n(?? ? ???? ) = 0, (4.2.29)\n\n?? = ???? =\n?? ? ???? ???? ??\n\n? ? + ???? ????\n, ? = ?, ?, ?, ?, e ?? = ?, ?, ?, ?. (4.2.30)\n\n35\n\n\n\np\n\n?j\n\np?U\n\np?R\n\np?D\n\np?L\n\nuU, `U\n\nuL, `L\n\nuD, `D\n\nuR, `R\n\nu???, \u02dc???\n\n~n\n\n~n\n\n~n ~n\n\nFigura 4.2: Espa\u00e7o de Raviart-Thomas de menor \u00edndice sobre o elemento ?? e seus elementos\nadjacentes. As press\u00f5es est\u00e3o definidas no centro dos elementos. Os fluxos e multiplicadores de\nLagrange est\u00e3o definidos nas arestas.\n\n36\n\n\n\nNas equa\u00e7\u00f5es acima ???? e ???? indicam, respectivamente, ? e ? definidos nos elementos adjacentes\na aresta ? de ?? ; ?? indica a press\u00e3o de refer\u00eancia no centro do elemento adjacente a aresta ?.\n\nManipulando as equa\u00e7\u00f5es (4.2.29)-(4.2.30) de modo a eliminar os multiplicadoresde Lagrange\ntemos que o fluxo em cada interface \u00e9 dado por\n\n?? =\n(? ?)eff?\n\n?\n(? ? ??), (4.2.31)\n\nonde\n(??)eff? = (??????)eff?? =\n\n2 ? ? ???? ????\n? ? + ???? ????\n\n, (4.2.32)\n\nque \u00e9 definida como sendo a permeabilidade efetiva entre os elementos ?? e seu adjacente ??? .\nNote que no caso que estamos trabalhando a permeabilidade \u00e9 uma fun\u00e7\u00e3o escalar do espa\u00e7o.\nPodemos extender facilmente para o caso em que a permeabilidade \u00e9 um tensor diagonal. Os\nc\u00e1lculos necess\u00e1rios para encontrar (B.3.7) podem ser encontrados no Ap\u00eandice A.\n\nPor fim, combinando as equa\u00e7\u00f5es (B.3.3) e (B.3.7) escrevemos a a equa\u00e7\u00e3o para a press\u00e3o em\ncada elemento ?? (retornando com o \u00edndice ?)\n\n??\n?=?,?,?,?\n\n(?? ?? )eff?\n?2\n\n(?? ? ??,?) = ??? , ? = 1, 2, . . . , ?. (4.2.33)\n\nO sistema linear para a press\u00e3o (B.3.5) obtido por meio da discretiza\u00e7\u00e3o por elementos finitos\nmistos \u00e9 equivalente a formula\u00e7\u00e3o de diferen\u00e7as finitas centrada [133, 148, 140].\n\nA equa\u00e7\u00e3o (B.3.5), escrita na sua forma matricial, \u00e9 dada por:\n\nA? = ?? , (4.2.34)\n\nonde a matriz A \u00e9 definida positiva [137, 41], e seus coeficientes s\u00e3o dados por m\u00e9dias das fun\u00e7\u00f5es\nde permeabilidade absoluta e mobilidade, como na equa\u00e7\u00e3o (B.3.6). Ap\u00f3s encontrar as press\u00f5es\nresolvendo o sistema linear utilizando um m\u00e9todo num\u00e9rico, podemos reconstruir o campo de\nvelocidades atrav\u00e9s da equa\u00e7\u00e3o (B.3.7).\n\nPor fim, tendo obtido o sistema linear por meio da discretiza\u00e7\u00e3o por elementos finitos mis-\ntos hibridos do problema de Poisson de press\u00e3o-velocidade, podemos nos concentrar na escolha\ndo m\u00e9todo num\u00e9rico para resolu\u00e7\u00e3o do sistema linear discreto (B.3.5). Apesar da discretiza\u00e7\u00e3o\nconduzir a um sistema linear esparso e definido positivo [136, 137, 41, 39], tal sistema \u00e9 mal condi-\ncionado devido \u00e0 natureza multiescala da permeabilidade da rocha do reservat\u00f3rio. Os coeficientes\nda matriz A s\u00e3o formados por valores de permeabilidade, como podemos ver em (B.3.5). Logo,\nem um meio poroso muito heterog\u00eaneo esses valores apresentam grande variabilidade tornando a\nmatriz do sistema mal-condicionada. Isso significa que \u00e9 necess\u00e1rio o emprego de alguma t\u00e9cnica\nde pr\u00e9-condicionamento para a resolu\u00e7\u00e3o num\u00e9rica do problema de \u00e1lgebra linear proveniente da\ndiscretiza\u00e7\u00e3o do problema de valor de contorno de Poisson.\n\nDevido \u00e0 natureza do sistema linear A? = ?? , \u00e9 importante agora escolher qual t\u00e9cnica de\nresolu\u00e7\u00e3o deve ser empregada, ou seja, se \u00e9 mais adequado adotar um m\u00e9todo direto ou um m\u00e9todo\niterativo que resolva o sistema linear de forma precisa, com robustez e efici\u00eancia computacional.\n\n37\n\n\n\nM\u00e9todos diretos, com base na fatora\u00e7\u00e3o da matriz A em um produto de matrizes que usualmente\ns\u00e3o simples de inverter, s\u00e3o amplamente utilizados e s\u00e3o o tipo de m\u00e9todo escolhido em diversos\nc\u00f3digos industriais, especialmente onde a confiabilidade da exatid\u00e3o dos c\u00e1lculos \u00e9 a principal\npreocupa\u00e7\u00e3o. Esses m\u00e9todos exibem uma vantagem de permitir uma quantidade previs\u00edvel de\nrecursos em termos de tempo computacional e armazenamento de mem\u00f3ria (RAM, L2, R\u00edgida,\netc...); ver, [75, 92]. Em problemas estacion\u00e1rios [19, 139, 142] \u00e9 poss\u00edvel resolver de forma eficiente\numa quantidade razo\u00e1vel de sistema de equa\u00e7\u00f5es lineares em um tempo relativamente aceit\u00e1vel.\nIsso j\u00e1 n\u00e3o \u00e9 t\u00e3o simples quando temos um problema de evolu\u00e7\u00e3o temporal como ocorre com\nfrequ\u00eancia em din\u00e2mica de fluidos em meios porosos [65, 40, 23, 58, 15, 31, 72, 21, 2, 89, 76, 86],\ncomo \u00e9 o nosso caso. Infelizmente, os m\u00e9todos diretos n\u00e3o exibem um bom escalonamento com o\ntamanho do problema em termos do n\u00famero de opera\u00e7\u00f5es e requisitos de mem\u00f3ria. Dessa forma,\nadotamos um m\u00e9todo iterativo para a resolu\u00e7\u00e3o do sistema linear (B.3.5).\n\nNeste trabalho utilizaremos o m\u00e9todo iterativo introduzido no trabalho de Klaus Lackner e\nRalph Menikoff [115], \u201cMultiscale Linear Solvers for Very Large Systems Derived from PDES\u201d,\npublicado em SIAM Journal on Scientific Computing (2000), que combina o m\u00e9todo dos Gradientes\nconjugados com um pr\u00e9-condicionador multiescala dado por uma itera\u00e7\u00e3o do m\u00e9todo Multigrid. No\npr\u00f3ximo cap\u00edtulo discutiremos em detalhes esse m\u00e9todo bem como a motiva\u00e7\u00e3o para sua escolha.\n\n38\n\n\n\nCap\u00edtulo 5\n\nResolu\u00e7\u00e3o do sistema linear associado ao\nproblema el\u00edptico\n\nNeste cap\u00edtulo iremos nos concentrar na solu\u00e7\u00e3o num\u00e9rica do sistema linear (B.3.5) obtido da\ndiscretiza\u00e7\u00e3o por elementos finitos mistos h\u00edbridos do problema de press\u00e3o-velocidade (4.2.3) de\nnatureza el\u00edptica. Esse sistema \u00e9 definido positivo e esparso, assim podemos procurar m\u00e9todos\nnum\u00e9ricos que fa\u00e7am proveito da estrutura especial da matriz.\n\nA resolu\u00e7\u00e3o de grandes sistemas esparsos de equa\u00e7\u00f5es lineares \u00e9 fundamental para muitas si-\nmula\u00e7\u00f5es num\u00e9ricas em ci\u00eancia pura e em problemas de engenharia e \u00e9 muitas vezes a parte\nmais demorada do c\u00e1lculo de uma simula\u00e7\u00e3o realizada para a compreens\u00e3o de um cen\u00e1rio real.\nSimula\u00e7\u00f5es multif\u00edsica detalhadas, em problemas bidimensionais e tridimensionais como estamos\ninteressados levam a sistemas lineares que podem atingir facilmente a ordem de centenas de milh\u00f5es\nou at\u00e9 bilh\u00f5es de equa\u00e7\u00f5es com as correspondentes inc\u00f3gnitas. Mesmo em problemas bidimensio-\nnais, face \u00e0 natureza heterog\u00eanea do meio poroso, \u00e9 natural incorporar uma no\u00e7\u00e3o de incerteza o\nque conduzir\u00e1 a EDPs estoc\u00e1sticas [95, 97, 94, 24, 89, 123, 2], e uma abordagem do tipo Monte\nCarlo \u00e9 necess\u00e1ria. Essencialmente, isso significa o c\u00e1lculo de momentos estat\u00edsticos [95, 97, 94, 89]\nprovenientes de um conjunto de experimentos determin\u00edsticos da ordem de centenas ou milhares\n(desej\u00e1vel) de experimentos computacionais. Assim, facilmente temos um contexto bidimensional\ncom um n\u00famero elevado de opera\u00e7\u00f5es associadas a aproxima\u00e7\u00e3o de problemas de Poisson que\npode envolver at\u00e9 85% de todos os c\u00e1lculos para cada uma dessas milhares de simula\u00e7\u00f5es [8, 4,\n7]. Para modelos dessa natureza, levando em conta o conhecimento atual, m\u00e9todos iterativos s\u00e3o\na \u00fanica op\u00e7\u00e3o dispon\u00edvel, e o m\u00e9todo dos gradientes conjugados \u00e9 uma escolha frequente para a\nresolu\u00e7\u00e3o desses problemas [2]. O m\u00e9todo dos gradientes conjugados \u00e9 um m\u00e9todo robusto com\numa rigorosa fundamenta\u00e7\u00e3o matem\u00e1tica, e \u00e9 extremamente simples de implementar. Como seu\nalgoritmo envolve apenas multiplica\u00e7\u00e3o de matriz por vetor ele consome pouca mem\u00f3ria sendo um\n\u00f3timo candidato para a resolu\u00e7\u00e3o do sistema linear [154, 139].\n\nPor\u00e9m, em algumas aplica\u00e7\u00f5es, m\u00e9todos iterativos tipicamente falham e o pr\u00e9-condicionamento\n\u00e9 indispens\u00e1vel, embora nem sempre tal \u201crem\u00e9dio\u201d seja suficiente para torn\u00e1-lo competitivo a ponto\nde atingir a converg\u00eancia em uma quantidade razo\u00e1vel de tempo dentro de uma toler\u00e2ncia estabe-\nlecida a priori. Isto \u00e9 devido tamb\u00e9m em grande parte ao aumento da complexidade e tamanho da\nnova gera\u00e7\u00e3o de sistemas lineares e n\u00e3o lineares, que surgem a partir de atuais aplica\u00e7\u00f5es t\u00edpicas\n\n39\n\n\n\nem fen\u00f4menos de transporte em problemas de din\u00e2mica de fluidos. Dessa maneira, escolher um\npr\u00e9-condicionador eficiente \u00e9 de extrema import\u00e2ncia para garantir a converg\u00eancia do m\u00e9todo dos\ngradientes conjugados.\n\nAo mesmo tempo, a computa\u00e7\u00e3o paralela tem penetrado as mesmas \u00e1reas de aplica\u00e7\u00e3o como\num novo ingrediente. Como o computador tornou-se amplamente dispon\u00edvel em termos de custos e\ncom a unifica\u00e7\u00e3o de linguagens de comunica\u00e7\u00e3o padr\u00e3o, como o MPI (Message Passing Interface),\ncriou-se um novo incentivo para utilizar m\u00e9todos iterativos tendo em mente que problemas sob\ninvestiga\u00e7\u00e3o s\u00e3o tipicamente em duas e tr\u00eas dimens\u00f5es espaciais, e n\u00e3o estacion\u00e1rios. Outro incen-\ntivo \u00e9 que os m\u00e9todos iterativos s\u00e3o muito mais f\u00e1ceis de implementar em computadores paralelos.\nDe um modo geral, ainda n\u00e3o pode ser afirmado que um sistema de equa\u00e7\u00f5es lineares esparso\narbitr\u00e1rio pode ser resolvido de forma iterativa eficientemente. Por exemplo, se a informa\u00e7\u00e3o f\u00ed-\nsica sobre o problema em quest\u00e3o pode ser explorado, os m\u00e9todos mais eficazes e robustos podem\nser melhor adaptados para obten\u00e7\u00e3o dessas solu\u00e7\u00f5es. De fato, esta estrat\u00e9gia \u00e9 explorada pelos\nm\u00e9todos multigrid, que tipicamente tiram vantagens de aspectos multiescala do modelo.\n\nM\u00e9todos multigrid usam informa\u00e7\u00f5es de diferentes malhas para aproximar a solu\u00e7\u00e3o do sistema\nlinear e dessa forma levam em conta a variabilidade associada \u00e0 geologia do meio poroso (porosidade\ne permeabilidade). Al\u00e9m disso, esse tipo de m\u00e9todo foi usado como pr\u00e9-condicionador em conjunto\nao m\u00e9todo dos gradientes conjugados mostrando-se competitivo comparado a outros tipos de pr\u00e9-\ncondicionadores [146, 115, 25]. Pelo exposto acima, a combina\u00e7\u00e3o dos gradientes conjugados com\npr\u00e9-condicionador multigrid parece vantajosa visto que essa escolha tem uma forte motiva\u00e7\u00e3o\nf\u00edsica. Dessa forma, escolhemos para a resolu\u00e7\u00e3o de sistemas lineares um m\u00e9todo que se baseia na\ndecomposi\u00e7\u00e3o espectral e combina gradientes conjugados, m\u00e9todos multigrid, e m\u00e9todos iterativos\nem um \u00fanico algoritmo. Essencialmente, ele usa o m\u00e9todo dos gradientes conjugados com um\npr\u00e9-condicionador dado por uma itera\u00e7\u00e3o do m\u00e9todo multigrid em combina\u00e7\u00e3o com o m\u00e9todo\ndos gradientes conjugados novamente, o qual chamamos de m\u00e9todo dos gradientes conjugados\nmultiescala recursivo. Esse m\u00e9todo foi introduzido no trabalho de Klaus Lackner e Ralph Menikoff\n[115], \u201cMultiscale Linear Solvers for Very Large Systems Derived from PDES\u201d, publicado em\nSIAM Journal on Scientific Computing, 2000, e engloba todos os pr\u00e9-requisitos que queremos de\numa maneira natural em sua constru\u00e7\u00e3o. Esse trabalho aborda exatamente a situa\u00e7\u00e3o f\u00edsica em\nescala de campo (quil\u00f4metros) que estamos interessados; os demais m\u00e9todos exibem tamb\u00e9m um\nexcelente rigor matem\u00e1tico, por\u00e9m ainda no campo mais te\u00f3rico em problemas \u201ctestes\u201d ou em\ndiferentes aplica\u00e7\u00f5es daquelas que estamos interessados em investigar nesse trabalho.\n\nNeste cap\u00edtulo discutiremos o m\u00e9todo dos gradientes conjugados, e em seguida discutiremos\nem detalhes o m\u00e9todo multigrid de modo a justificar a escolha do m\u00e9todo usado nesse trabalho.\nNas se\u00e7\u00f5es seguintes detalhamos o m\u00e9todo dos gradientes conjugados multiescala recursivo e sua\nimplementa\u00e7\u00e3o.\n\n5.1 Gradientes Conjugados\nO m\u00e9todo dos Gradientes Conjugados \u00e9 um m\u00e9todo de proje\u00e7\u00e3o ortogonal da classe de m\u00e9todos\n\nde subspa\u00e7os de Krylov [139, 141] para resolu\u00e7\u00e3o de sistemas lineares do tipo A? = ? , onde a\nmatriz do sistema \u00e9 sim\u00e9trica definida positiva. Esse m\u00e9todo foi introduzido por E. Stiefel e M. R.\n\n40\n\n\n\nHestenes [102] e \u00e9 similar ao m\u00e9todo de m\u00e1xima descida [139, 154, 141]. No entanto, nos gradientes\nconjugados as dire\u00e7\u00f5es de descida s\u00e3o A-ortogonais, tamb\u00e9m chamadas de A-conjugadas. Esse\nm\u00e9todo \u00e9 um m\u00e9todo direto, produzindo uma solu\u00e7\u00e3o exata no m\u00e1ximo ap\u00f3s ? \u201citera\u00e7\u00f5es\u201d ou\nproje\u00e7\u00f5es, sendo ? a dimens\u00e3o da matriz do sistema linear. Por\u00e9m, erros de truncamento e erros\nde aproxima\u00e7\u00e3o e de lineariza\u00e7\u00e3o introduzidos na discretiza\u00e7\u00e3o s\u00e3o suficientes para a gradual perda\nda A-ortogonalidade das dire\u00e7\u00f5es de descida, e os erros acumulados fazem com que o m\u00e9todo\nn\u00e3o encontre a solu\u00e7\u00e3o do sistema com poucas proje\u00e7\u00f5es. Felizmente, o m\u00e9todo dos gradientes\nconjugados pode ser usado como um \u201cm\u00e9todo iterativo\u201d pois ele melhora, a cada itera\u00e7\u00e3o, as\naproxima\u00e7\u00f5es para a solu\u00e7\u00e3o exata dada uma certa toler\u00e2ncia a prori. Sua converg\u00eancia depende\ndo n\u00famero de condi\u00e7\u00e3o de A [139, 154, 141]. A opera\u00e7\u00e3o mais custosa em cada itera\u00e7\u00e3o \u00e9 a\nmultiplica\u00e7\u00e3o de matriz por vetor, portanto o n\u00famero de opera\u00e7\u00f5es \u00e9 da ordem de ?(???), onde\n??? \u00e9 o n\u00famero de entradas n\u00e3o nulas de A [141]. Desse modo, esse \u00e9 um m\u00e9todo barato para\nimplementar.\n\nTemos interesse em resolver sistemas lineares de grande porte da ordem de milh\u00f5es (2D) e\nbilh\u00f5es (3D) de equa\u00e7\u00f5es, os quais possuem coeficientes com alta variabilidade devido a caracte-\nr\u00edstica multiescala do meio poroso. Logo, essas matrizes s\u00e3o frequentemente mal-condicionadas\nnecessitando de um pr\u00e9-condicionamento em conjunto ao m\u00e9todo dos Gradientes Conjugados.\n\nA seguir discutiremos alguns pr\u00e9-condicionadores e apresentaremos o pr\u00e9-condicionador a ser\nusado nesse trabalho.\n\n5.1.1 Precondicionadores\nQuando a matriz de um sistema linear A? = ? \u00e9 mal condicionada o m\u00e9todo dos gradientes\n\nconjugados, entre outros, passa a ter uma converg\u00eancia lenta. Para melhorar esse problema trans-\nformamos o sistema linear num outro equivalente A???? = ???, onde A? seja mais bem condicionada\nque A. Esse procedimento \u00e9 chamado de pr\u00e9-condicionamento [154].\n\nAssim, seja M uma matriz n\u00e3o singular que aproxima A. Podemos obter um sistema linear\nequivalente,\n\nM?1A? = M?1?. (5.1.1)\n\nA matriz M \u00e9 chamada de pr\u00e9-condionador.\nCaso M seja uma boa aproxima\u00e7\u00e3o para A a matriz M?1A ter\u00e1 um n\u00famero de condi\u00e7\u00e3o\n\nmenor, dando melhor estabilidade e taxa de converg\u00eancia para o m\u00e9todo dos gradientes conjugados.\nUm dos cuidados que temos que ter ao usar um pr\u00e9-condicionador com o m\u00e9todo dos gradientes\nconjugados \u00e9 que para garantir a converg\u00eancia do m\u00e9todo precisamos que a matriz M?1A seja\nsim\u00e9trica positiva definida. Portanto, M?1 tem que ser definida positiva.\n\nCom efeito, fazendo a decomposi\u00e7\u00e3o Cholesky de M = G?G temos o seguinte sistema linear\nequivalente\n\nA???? = ? , (5.1.2)\n\nonde A? = G??AG?1, ??? = G? e ? = G??? .\nComo A? \u00e9 sim\u00e9trica positiva definida, podemos aplicar o m\u00e9todo dos gradientes conjugados na\n\nequa\u00e7\u00e3o (5.1.2).\n\n41\n\n\n\nH\u00e1 v\u00e1rios tipos de pr\u00e9-condicionadores como, por exemplo, o SSOR (symmetric sucessive over-\nrelaxation) [154, 139] onde o pr\u00e9-condicionador \u00e9 dado pela matriz,\n\nM???? = (D + ?L)D?1(D + ?L?).\n\nSeparamos a matriz A = D + L + L?, D \u00e9 matriz diagonal e L \u00e9 estritamente triangular inferior;\n0 &lt;? &lt;2 \u00e9 um par\u00e2metro de relaxa\u00e7\u00e3o.\n\nNo m\u00e9todo que vamos apresentar neste trabalho, o pr\u00e9-condicionador \u00e9 escolhido de forma a\nrespresentar o m\u00e9todo multigrid de dois n\u00edveis, [115], dado por\n\nM?1 = (P?1Q)??A?1? ?(QP\n?1)? +\n\n2??1??\n?=0\n\nH?P?1. (5.1.3)\n\nAs matrizes ? e ? representam os operadores de prolonga\u00e7\u00e3o e restri\u00e7\u00e3o; P e Q vem da decom-\nposi\u00e7\u00e3o da matriz A, A = P ? Q. A? \u00e9 a matriz de discretiza\u00e7\u00e3o numa malha mais grossa.\n\nO m\u00e9todo multigrid \u00e9 uma t\u00e9cnica num\u00e9rica de resolu\u00e7\u00e3o de sistemas lineares, associados a\ndiscretiza\u00e7\u00f5es de equa\u00e7\u00f5es diferenciais, que combina diferentes malhas com o intuito de acelerar a\ntaxa de converg\u00eancia de m\u00e9todos iterativos [139, 122, 42].\n\nNas se\u00e7\u00f5es seguintes, vamos discutir em detalhes o m\u00e9todo multigrid de modo a esclarecer a\nescolha desse m\u00e9todo como pr\u00e9-condicionador.\n\n5.2 O M\u00e9todo Multigrid\nOs m\u00e9todos num\u00e9ricos existentes para a solu\u00e7\u00e3o de sistemas lineares recaem em duas categorias:\n\nm\u00e9todos diretos e m\u00e9todos iterativos (ou de relaxa\u00e7\u00e3o).\nM\u00e9todos diretos determinam a solu\u00e7\u00e3o exata (na precis\u00e3o da m\u00e1quina) em um n\u00famero finito de\n\nopera\u00e7\u00f5es. Esses m\u00e9todos n\u00e3o s\u00e3o de interese neste trabalho pois, como visto no final do Cap\u00edtulo\n4, eles tem um custo computacional muito grande levando em considera\u00e7\u00e3o a origem do sistema\nlinear aqui discutido.\n\nOs m\u00e9todos iterativos, como os m\u00e9todos de Jacobi e Gauss-Seidel, come\u00e7am com uma apro-\nxima\u00e7\u00e3o inicial para a solu\u00e7\u00e3o e tem como objetivo melhorar a aproxima\u00e7\u00e3o por meio de uma\nsucess\u00e3o de passos simples que atualizam a solu\u00e7\u00e3o. A sequ\u00eancia de passos gerada (idealmente)\nconverge para a solu\u00e7\u00e3o do sistema. M\u00e9todos de relaxa\u00e7\u00e3o cl\u00e1ssicos s\u00e3o mais f\u00e1ceis de implementar\ne podem ser aplicados com sucesso em sistemas lineares mais gerais que m\u00e9todos diretos [42, 139].\n\nUma dificuldade na aplica\u00e7\u00e3o de esquemas de relaxa\u00e7\u00e3o \u00e9 que, quando h\u00e1 converg\u00eancia, ela\npode ser muito lenta para certos problemas. Dessa forma, o m\u00e9todo necessita de muitos passos\npara obter uma aproxima\u00e7\u00e3o razo\u00e1vel. Dessa forma, os m\u00e9todos multigrid foram desenvolvidos\npor meio de tentativas de superar essa limita\u00e7\u00e3o [122, 42, 155, 132]. A ideia b\u00e1sica do m\u00e9todo\nMultigrid \u00e9 resolver um sistema linear A? = ? , frequentemente associado a discretiza\u00e7\u00e3o de uma\nequa\u00e7\u00e3o diferencial, explorando diferentes malhas com a inten\u00e7\u00e3o de melhorar a taxa de conver-\ng\u00eancia de t\u00e9cnicas de relaxa\u00e7\u00e3o [139, 122, 42, 155]. Esses m\u00e9todos foram bem sucedidos: m\u00e9todos\nde relaxa\u00e7\u00e3o, usados no contexto de multigrid, s\u00e3o competitivos com os m\u00e9todos diretos mais\nr\u00e1pidos em problemas modelo e eles s\u00e3o mais gerais tendo uma aplica\u00e7\u00e3o mais ampla [42, 132].\n\n42\n\n\n\nAs ideias do multigrid tamb\u00e9m foram estendidas para problemas puramente alg\u00e9bricos levando ao\ndesenvolvimento do m\u00e9todo multigrid alg\u00e9brico [42, 122, 155, 132].\n\nOs m\u00e9todos multigrid foram aplicados em diversas \u00e1reas, desde problemas de din\u00e2mica de\nfluidos, problemas em processamento de imagens, otimiza\u00e7\u00e3o combinat\u00f3ria, mec\u00e2nica estat\u00edstica,\ne eletrodin\u00e2mica qu\u00e2ntica [42, 155, 132].\n\nNas pr\u00f3ximas se\u00e7\u00f5es falaremos sobre o m\u00e9todo multigrid e como ele se conecta com m\u00e9todos\niterativos. Para uma discuss\u00e3o mais aprofundada do m\u00e9todo, e suas aplica\u00e7\u00f5es, recomendamos ao\nleitor as seguintes refer\u00eancias: [42, 155, 132, 122, 148, 146, 37, 139].\n\n5.2.1 M\u00e9todos de relaxa\u00e7\u00e3o e a propriedade de smoothing\nUma parte extremamente importante dos M\u00e9todos Multigrid \u00e9 como ele se aproveita de cer-\n\ntas propriedades de m\u00e9todos de relaxa\u00e7\u00e3o para acelerar a converg\u00eancia dos mesmos. A principal\npropriedade aproveitada \u00e9 a propriedade de smoothing. M\u00e9todos com essa propriedade aplicados\na sistemas lineares acomodam rapidamente as componentes mais oscilat\u00f3rias do erro da apro-\nxima\u00e7\u00e3o (relacionadas a expans\u00e3o espectral e an\u00e1lise de Fourier) [42, 37, 155], usualmente nas\nprimeiras itera\u00e7\u00f5es, em componentes menos oscilat\u00f3rias. H\u00e1 tamb\u00e9m redu\u00e7\u00e3o das componentes\nmenos oscilat\u00f3rias nas itera\u00e7\u00f5es seguintes, por\u00e9m com menos efici\u00eancia [139, 42].\n\nNessa se\u00e7\u00e3o iremos analisar sem muitos detalhes essa propriedade. Para uma discuss\u00e3o mais\naprofundada sobre smoothing recomendamos as seguinte refer\u00eancias: [42, 155, 132, 122, 37].\n\nDado um sistema linear A??? = ?? proveniente de uma discretiza\u00e7\u00e3o, onde ? corresponde ao\nespa\u00e7amento da malha, a ?-\u00e9sima itera\u00e7\u00e3o de um m\u00e9todo iterativo qualquer \u00e9 escrita da forma\n[42, 139],\n\n?\n(?)\n? = H\n\n??\n(0)\n? + R?. (5.2.1)\n\nH = P?1Q \u00e9 chamada de matriz de itera\u00e7\u00e3o. As matrizes R =\n????1\n\n?=0 H\n?P?1 e P e Q vem da\n\ndecomposi\u00e7\u00e3o da matriz A? = P ? Q; ?(0) \u00e9 uma aproxima\u00e7\u00e3o inicial. Al\u00e9m disso, sabemos que o\nerro da ?-\u00e9sima itera\u00e7\u00e3o \u00e9\n\n?\n(?)\n? = H\n\n??\n(0)\n? . (5.2.2)\n\nDessa maneira, se o raio espectral ?H?2&lt;1 ent\u00e3o o erro vai a zero conforme as itera\u00e7\u00f5es aumentam.\nLogo, o m\u00e9todo iterativo associado a matriz de itera\u00e7\u00e3o H converge para qualquer valor inicial se,\ne somente se, ?(H) &lt;1 [42, 139, 122]. Assim, considere o exemplo onde aplicamos a itera\u00e7\u00e3o de\nJacobi com peso ? no problema discreto,\n\n????1 + 2?? ? ??+1 = 0, 1 ? ? ? ? ? 1, (5.2.3)\n?0 = ?? = 0. (5.2.4)\n\nA matriz de itera\u00e7\u00e3o do problema \u00e9 dada [42, 139] por\n\nH? = I ?\n?\n\n2\nA? (5.2.5)\n\ne seus autovalores ?? e seus autovetores ?? s\u00e3o dados por\n\n??(H?) = 1 ? 2? sin2\n(?\n\n??\n\n2?\n\n)?\n, ??,? = sin\n\n(?\n???\n\n?\n\n)?\n, 1 ? ? ? ? ? 1, 0 ? ? ? ?, (5.2.6)\n\n43\n\n\n\nonde ??,? \u00e9 a ?-\u00e9sima componente de ??. Para esse caso os autovetores correspondem aos modos de\nFourier encontrados atrav\u00e9s da an\u00e1lise de Fourier [105, 130, 131, 36, 42]. Note que nesse exemplo\nse 0 &lt;? ? 1 temos que |??(H?)|&lt;1 e a itera\u00e7\u00e3o de Jacobi converge.\n\nAgora seja ?(0)? o erro do valor inicial usado no m\u00e9todo de Jacobi. Ent\u00e3o \u00e9 poss\u00edvel represent\u00e1-lo\npela seguinte expans\u00e3o:\n\n?\n(0)\n? =\n\n??1??\n?=1\n\n????, ?? ? R, (5.2.7)\n\ncom os coeficientes ?? representando a \u201cquantidade\u201d de cada modo no erro. Usando a equa\u00e7\u00e3o\n(5.2.2) podemos representar o erro da ?-\u00e9sima itera\u00e7\u00e3o por,\n\n?\n(?)\n? = H\n\n?\n? ?\n\n(0)\n? =\n\n??1??\n?=1\n\n??H?? ?? =\n??1??\n?=1\n\n???\n?\n? (H?)??. (5.2.8)\n\nPara cada modo de Fourier [105, 130, 131] e cada esquema de relaxa\u00e7\u00e3o proposto podemos definir\nvia an\u00e1lise de Fourier um fator de amplitude ? que mede a amplitude que cada componente do\nerro \u00e9 multiplicada na ?-\u00e9sima relaxa\u00e7\u00e3o [37]. No nosso exemplo, o fator de amplitude \u00e9 dado por\n?? = ????? (H?) e ele nos mostra o quanto um modo \u00e9 reduzido em cada itera\u00e7\u00e3o.\n\nNo nosso exemplo, vamos chamar as componentes ?? da metade para baixo do espectro, 1 ?\n? ? ?/2, de low frequency modes ou smooth modes, e as componentes da metade ?? para cima,\n?/2 ? ? &lt;? ? 1, de high frequency modes ou oscillatory modes. Dessa forma, o fator de smoothing\n\u00e9 dado por [37],\n\n? = max{|??|, ?/2 ? ? &lt;? ? 1}, (5.2.9)\ne \u00e9 o maior fator, no pior caso, no qual os high frequency modes s\u00e3o reduzidos a cada itera\u00e7\u00e3o do\nm\u00e9todo. Essa propriedade de rapidamente reduzir os high frequency modes \u00e9 chamada de smoothing\ne o fator de smoothing quantifica essa propriedade.\n\nNo nosso exemplo (5.2.3) usando o m\u00e9todo de Jacobi com peso ?, podemos mostrar que o fator\nde smoothing \u00f3timo \u00e9 dado por ? = 2/3 com ? = 1/3.\n\nPara ilustrar a a\u00e7\u00e3o do m\u00e9todo de Jacobi com peso ? = 2/3 sobre as componentes do erro\nconsidere a Figura 5.1. Na Figura 5.1(a) \u00e9 dada uma aproxima\u00e7\u00e3o inicial para o erro ?(0)? = ?3,\nque \u00e9 um modo associado aos smooth modes. Ap\u00f3s 10 itera\u00e7\u00f5es n\u00e3o houve mudan\u00e7as qualitativas\nna aproxima\u00e7\u00e3o. Na Figura 5.1(b) n\u00f3s temos uma componente dos high frequency modes como\naproxima\u00e7\u00e3o inicial. Podemos ver que a amplitude das oscila\u00e7\u00f5es foram extremamente reduzidas\nem 10 itera\u00e7\u00f5es. A Figura 5.1(b) mostra, como aproxima\u00e7\u00e3o inicial, uma combina\u00e7\u00e3o de high e low\nfrequency modes. Em apenas 10 itera\u00e7\u00f5es a componente oscilat\u00f3ria foi reduzida, por\u00e9m o mesmo\nn\u00e3o aconteceu com a componente menos oscilat\u00f3ria.\n\nO m\u00e9todo de Jacobi, no entanto, n\u00e3o \u00e9 muito eficiente em reduzir os high frequency modes\n[42, 115]. Outros m\u00e9todos, como o m\u00e9todo de Gauss-Seidel s\u00e3o mais efici\u00eantes. A propriedade\nde smoothing desse \u00faltimo esquema \u00e9 analisada usando local mode analysis (LMA) [105, 130, 131,\n36] introduzida por Brandt [36]. No LMA a defini\u00e7\u00e3o de low- e high-frequency modes \u00e9 dada com\nrela\u00e7\u00e3o a uma malha fina G? e uma malha grossa G2?. Assim, uma componente do erro em G? \u00e9\ndita como high-frequency mode se sua proje\u00e7\u00e3o (restri\u00e7\u00e3o) na malha G2? n\u00e3o \u00e9 vis\u00edvel nessa malha.\n\nEsquemas de relaxa\u00e7\u00e3o com a propriedade de smoothing funcionam bem nas primeiras itera\u00e7\u00f5es,\nreduzindo rapidamente os modos mais oscilat\u00f3rios, por\u00e9m nas itera\u00e7\u00f5es seguintes a converg\u00eancia\n\n44\n\n\n\nFigura 5.1: O m\u00e9todo de Jacobi com peso ? = 2/3 aplicado ao problema teste (5.2.3) com ? = 64\npontos e com uma aproxima\u00e7\u00e3o inicial dada por (a) ?3, (b) ?16, e (c) (?2 + ?16)/2. As ilustra\u00e7\u00f5es\nmostram a aproxima\u00e7\u00e3o da solu\u00e7\u00e3o ap\u00f3s uma itera\u00e7\u00e3o (lado esquerdo) e ap\u00f3s 10 itera\u00e7\u00f5es (lado\ndireito), podendo ver a acomoda\u00e7\u00e3o \u201cqualitativa\u201d dos high modes. Retirada da refer\u00eancia [42].\n\nse torna extremamente lenta. O m\u00e9todo necessita de uma quantidade grande de itera\u00e7\u00f5es para\nreduzir os low modes satisfat\u00f3riamente e isso \u00e9 uma grande limita\u00e7\u00e3o para aplica\u00e7\u00f5es desse tipo de\nm\u00e9todos. \u00c9 nessa hora que o m\u00e9todo Multigrid usa diferentes malhas (mais grossas) para reduzir\nde forma conviniente os low modes acelerando a converg\u00eancia do m\u00e9todo iterativo. Para uma\ndiscuss\u00e3o mais aprofundada sobre a an\u00e1lise dos high modes e low modes no contexto de smoothing\nno m\u00e9todo multigrid recomendamos as refer\u00eancias: [105, 155, 132, 112, 130, 131, 36].\n\n45\n\n\n\n5.2.2 A estrutura do M\u00e9todo Multigrid\nA ideia b\u00e1sica do m\u00e9todo Multigrid \u00e9 resolver um sistema linear, frequentemente associado a\n\ndiscretiza\u00e7\u00e3o de uma equa\u00e7\u00e3o diferencial, explorando diferentes malhas com a inten\u00e7\u00e3o de melhorar\na taxa de converg\u00eancia de t\u00e9cnicas de relaxa\u00e7\u00e3o, [139, 122, 42]. Ele \u00e9 composto por tr\u00eas etapas:\npre-smoothing, correction step e post-smoothing.\n\nNa etapa de pre-smoothing, usamos um smoother com a inten\u00e7\u00e3o de acomodar os oscillatory\nmodes em low modes. O smoother \u00e9 geralmente ? itera\u00e7\u00f5es de algum m\u00e9todo iterativo com a\npropriedade de smoothing, como visto na se\u00e7\u00e3o anterior e na equa\u00e7\u00e3o (5.2.1). Algum dos m\u00e9todos\nque possuem essa propriedade s\u00e3o: Jacobi com peso 1/2, Gauss-Seidel, red-black Gauss-Seidel,\nentre outros [115, 122, 42].\n\nNa etapa correction step nos concentramos em reduzir os low frequency modes, de modo a ace-\nlerar a converg\u00eancia do m\u00e9todo de relaxa\u00e7\u00e3o usado. Para isso, usamos o fato de que alguns smooth\nmodes na malha fina \u201cparecem\u201d oscillatory modes numa malha mais grossa [155, 42, 122], como\nna Figura 5.2. Assim, quando a relaxa\u00e7\u00e3o come\u00e7a a estagnar (significando uma predomin\u00e2ncia de\n\nFigura 5.2: Aqui \u00e9 ilustrado como uma solu\u00e7\u00e3o suave na malha fina (acima) pode parecer mais\noscilat\u00f3ria na malha mais grossa (abaixo). Baseado na ilustra\u00e7\u00e3o da refer\u00eancia [42].\n\nsmooth modes no erro) \u00e9 aconselhavel ir para uma malha mais grossa onde podemos tratar esses\nsmooth modes como oscillatory modes. Ent\u00e3o, relaxamos novamente o sistema na malha grossa\nreduzindo esses aparentes high-frequency modes. Em seguida retornamos a solu\u00e7\u00e3o aproximada\npara a malha fina com a inten\u00e7\u00e3o de obter uma melhor aproxima\u00e7\u00e3o.\n\nPor\u00e9m, ao inv\u00e9s de trabalhar com o sistema linear diretamente iremos usar algo equivalente\n[42, 122]: relaxar a equa\u00e7\u00e3o original A? = ? com uma aproxima\u00e7\u00e3o inicial arbitr\u00e1ria \u00e9 equivalente\na relaxar a equa\u00e7\u00e3o residual A? = ? com aproxima\u00e7\u00e3o inicial dada por ?0 = 0. Ou seja, usamos a\nequa\u00e7\u00e3o residual\n\nA? = ?, ou ? ? A? = ?, (5.2.10)\n\n46\n\n\n\npara, em vez de relaxar a solu\u00e7\u00e3o, relaxar o erro na malha grossa e obter uma aproxima\u00e7\u00e3o para\no erro na malha fina. Isso \u00e9 feito transferindo o res\u00edduo para uma malha grossa e encontrando o\nerro a partir do sistema (5.2.10). Em seguida tranferimos o erro para a malha fina e atualizamos\na aproxima\u00e7\u00e3o. Essa opera\u00e7\u00e3o \u00e9 feita por meio de dois operadores: o operador de restri\u00e7\u00e3o, ?,\nque transfere um vetor de uma malha fina para um vetor numa malha mais grossa, e o operador\nde prolonga\u00e7\u00e3o, ?, que transfere um vetor de uma malha grossa para um vetor numa malha mais\nfina.\n\nNa etapa post-smoothing \u00e9 feita uma relaxa\u00e7\u00e3o para eliminar poss\u00edveis oscila\u00e7\u00f5es provenientes\na transfer\u00eancia de malhas.\n\nA forma mais simples do m\u00e9todo Multigrid \u00e9 considerando 2 malhas regulares, uma fina ?? e\noutra grossa ?? de modo que\n\n?? = {? ? ? : ? = ??? , ? = 1, 2, . . . , ?? ? 1, ?? =\n1\n\n??\n},\n\n?? = {? ? ? : ? = ???, ? = 1, 2, . . . , ?? ? 1, ?? =\n1\n\n??\n},\n\nonde ?? = ?? /2.\nUma itera\u00e7\u00e3o de m\u00e9todo de dois n\u00edveis consiste em ? itera\u00e7\u00f5es do pre-smoother, o correction\n\nstep, e ? itera\u00e7\u00f5es do post-smoothing. Os par\u00e2metros ? e ? s\u00e3o dados e dependem do problema a\nser resolvido. Eles podem ser escolhidos a priori, an\u00e1lisando o problema, ou escolhidos experimen-\ntalmente [42, 122].\n\nAlgoritmo 5.1 : Algoritmo para o m\u00e9todo multigrid de dois n\u00edveis [146, 122].\nwhile not convergent do\n\n? = H?1 ? + R1? ; {pre-smoothing}\n? = ?(A? ? ? ? ); {correction step}\nResolver o sistema A?? = ? por algum m\u00e9todo num\u00e9rico;\n? = ? ? ??;\n? = H?2 ? + R2? ; {post-smoothing}\n\nend while\n\nO Algoritmo 5.1 mostra como o multigrid de dois n\u00edveis funciona. As matrizes A? e A?\nrepresentam os operadores discretos na malha fina (? ) e na malha grossa (?); ? e ? s\u00e3o os\noperadores de restri\u00e7\u00e3o e prolonga\u00e7\u00e3o, e H?, R?, ? = 1, 2 s\u00e3o os pr\u00e9 e p\u00f3s smoothers.\n\nCondi\u00e7\u00f5es de Contorno\n\nUm cuidado especial deve ser tomado em cada passo do m\u00e9todo Multigrid ao incluir as con-\ndi\u00e7\u00f5es de contorno pois elas usualmente afetam a escalabilidade do problema [37]. Isso afeta a\nconverge?ncia do smoother usado. H\u00e1 algumas maneiras de contornar esse problema. Podemos\nusar operadores de prolonga\u00e7\u00e3o e restri\u00e7\u00e3o melhores, de modo a transferir os valores da fronteira\ncom mais precis\u00e3o. Outra forma \u00e9 aumentar o n\u00famero de itera\u00e7\u00f5es do smoother nos elementos da\n\n47\n\n\n\nfronteira [42, 37]. O primeiro n\u00e3o \u00e9 muito usado devido a dificuldade de implementa\u00e7\u00e3o. Esses\noperadores podem ficar muito complexos e especializados.\n\nOutros cuidados que devemos ter com as condi\u00e7\u00f5es de contorno \u00e9 que os operadores de restri\u00e7\u00e3o\ne prolonga\u00e7\u00e3o devem ser alterados no elementos de fronteiras de modo a considerar as condi\u00e7\u00f5es\nde contorno [42, 37, 155, 132]. No melhor entendimento do autor n\u00e3o h\u00e1 uma teoria matem\u00e1tica\nrigorosa para o tratamento das condi\u00e7\u00f5es de contorno. As estrat\u00e9gias s\u00e3o, em sua maioria, base-\nadas em problemas espec\u00edficos e/ou na experi\u00eancia dos usu\u00e1rios em problemas espec\u00edficos como o\nproblema de Poisson.\n\n5.2.3 O Multigrid como Pr\u00e9-condicionador\nO pr\u00e9-condicionador proposto por K. Lackner e R. Menikoff [115] \u00e9 composto pelo m\u00e9todo\n\nMultigrid de dois n\u00edveis. Iremos construir a matriz pr\u00e9-condicionadora M a partir do Algoritmo\n5.1.\n\nSeja H1 = P?11 Q1 e H2 = P?12 Q2 respectivamente as matrizes de itera\u00e7\u00e3o do pre e p\u00f3s smo-\nothers. Ent\u00e3o [146],\n\nM?1 = H?2 {(I ? ?A\n?1\n? ?A? )R1 + ?A\n\n?1\n? ?} + R2\n\n= H?2 R1 + R2 + H\n?\n2 ?A\n\n?1\n? ?(I ? AR1). (5.2.11)\n\nComo R1 =\n????1\n\n?=0 (P\n?1\n1 Q1)?P?11 pela equa\u00e7\u00e3o (5.2.1), temos que\n\nI ? A? R1 = (Q1P?11 )\n? . (5.2.12)\n\nPodemos reescrever a equa\u00e7\u00e3o (5.2.11) como\n\nM?1 = H?2 R1 + R2 + H\n?\n2 ?A\n\n?1\n? ?(Q1P\n\n?1\n1 )\n\n? . (5.2.13)\n\nPara podermos usar o m\u00e9todo multigrid de dois n\u00edveis como pr\u00e9-condicionador precisamos que\na matriz M seja sim\u00e9trica e definida positiva, como visto na se\u00e7\u00e3o 5.1.1. Os seguintes teoremas\ngarantem a simetria e positividade dessa matriz.\nTeorema 1. Seja A?1? sim\u00e9trica e definida positiva e ? = ? *. Se P1 = P2 = P?1, ?(H1) &lt;1 e\n? = ?, ent\u00e3o M \u00e9 sim\u00e9trica definida positiva. (Teorema 6.1.3, [146])\nTeorema 2. Seja A?1? sim\u00e9trica e definida positiva e ? = ? *. Se P1 = P?2, ?(H1) &lt;1 e ? = ?,\nent\u00e3o M \u00e9 sim\u00e9trica definida positiva. (Teorema 6.1.5, [146])\n\nA partir do Teorema 1, seja P = P1 = P2 e H = H1 = H2. Como QP?1 = H? ent\u00e3o,\n\nM?1 = H? R + R + H? ?A?1? ?(H\n?)? . (5.2.14)\n\nTemos tamb\u00e9m que R =\n????1\n\n?=0 H\n?P?1, como visto na equa\u00e7\u00e3o (5.2.1), ent\u00e3o\n\nH? R + R = H?\n??1??\n?=0\n\nH?P?1 +\n??1??\n?=0\n\nH?P?1\n\n=\n2??1??\n?=0\n\nH?P?1. (5.2.15)\n\n48\n\n\n\nDesde que P seja sim\u00e9trica e definida positiva, ?(H) &lt;1 e P + Q seja definida positiva podemos\nmostrar que H? R + R \u00e9 definida positiva. Podemos tamb\u00e9m mostrar que essa matriz \u00e9 sim\u00e9trica\n[146]. A?1? \u00e9 definida positiva e portanto H? ?A?1? ?(H?)? \u00e9 semi-definida positiva 1. Assim, M?1\n\u00e9 sim\u00e9trica definida positiva. E obtemos a matriz precondicionadora obtida em [115],\n\nM?1 = (P?1Q)? W(QP?1)? +\n2??1??\n?=0\n\nH?P?1, (5.2.16)\n\nonde W = ?A?1? ?.\n\n5.2.4 Outra maneira de derivar o pr\u00e9-condicionador multigrid\nNesta se\u00e7\u00e3o, apresentaremos uma outra maneira de deriva\u00e7\u00e3o do pr\u00e9-condicionador multigrid,\n\nfeita no artigo do R. Menikoff e K. Lakner [115].\nConsiderando o sistema linear A? = ? obtido pela discretiza\u00e7\u00e3o discutida neste trabalho,\n\npodemos decompor o operador A como A = P?Q. Essa decomposi\u00e7\u00e3o \u00e9 respons\u00e1vel pelo processo\nde smoothing visto na se\u00e7\u00e3o anterior, atrav\u00e9s da equa\u00e7\u00e3o (5.2.1). Assim, dada a decomposi\u00e7\u00e3o de\nA e supondo que P \u00e9 sim\u00e9trica definida positiva, podemos escrever a inversa de A da seguinte\nmaneira [115, 139, 154],\n\nA?1 =\n???\n\n?=0\n(P?1Q)?P?1. (5.2.17)\n\nEssa s\u00e9rie \u00e9 convergente para ?P?1Q?&lt;1, na norma matricial ?2.\nAgora queremos escrever um precondicionador M?1 que seja uma boa aproxima\u00e7\u00e3o para A?1.\n\nIsso ser\u00e1 feito usando a identidade,\n\nA?1 = (P?1Q)?A?1(QP?1)? +\n2??1??\n?=0\n\n(P?1Q)?P?1. (5.2.18)\n\nAnalisando a identidade (5.2.18) podemos interpreta-la como combina\u00e7\u00e3o de outras duas aproxi-\nma\u00e7\u00f5es para A?1. De fato, o segundo termo do lado direito de (5.2.18) \u00e9 nada mais que o somat\u00f3rio\ntruncado da identidade (5.2.17) que aproxima a inversa de A. Podemos tamb\u00e9m substituir A?1\nno primeiro termo do lado direito de (5.2.18) por uma outra aproxima\u00e7\u00e3o para a inversa de A,\ndigamos W. Dessa forma, obtemos uma nova aproxima\u00e7\u00e3o para A?1,\n\nM?1 = (P?1Q)?W(QP?1)? +\n2??1??\n?=0\n\n(P?1Q)?P?1. (5.2.19)\n\nA equa\u00e7\u00e3o acima nos d\u00e1 a forma do pr\u00e9-condicionador M, agora nos resta encontrar a aproxima-\n\u00e7\u00e3o W. Levando em considera\u00e7\u00e3o a natureza multiescala do meio poroso, uma escolha interessante\nseria escolher um passo do m\u00e9todo Multigrid, ou seja, escolher W de modo que o pr\u00e9-condcionador\nM seja um passo do mutigrid. Dessa forma temos W = ?A?1? ?.\n\n1Uma matriz A ? ??(?) se ??A? ? 0, ?? ? ?? [154].\n\n49\n\n\n\n5.3 Gradientes conjugados com pr\u00e9-condicionador multi-\nescala recursivo\n\nRelembrando o prop\u00f3sito deste trabalho, queremos aproximar a solu\u00e7\u00e3o de um problema de\npress\u00e3o-velocidade de natureza el\u00edptica no contexto de din\u00e2mica de fluidos em meios porosos. Pri-\nmeiramente, usamos uma t\u00e9cnica de decomposi\u00e7\u00e3o de operadores para isolar a resolu\u00e7\u00e3o num\u00e9rica\ndo problema el\u00edptico, e em seguida aplicamos uma discretiza\u00e7\u00e3o por elementos finitos mistos h\u00ed-\nbridos para obter um sistema linear A? = ? que ser\u00e1 resolvido a partir de um m\u00e9todo num\u00e9rico\nintroduzido no artigo de R. Menikoff e K. Lackner [115].\n\nAgora, com o sistema linear em m\u00e3os e ap\u00f3s discutir sobre todos os elementos que comp\u00f5e\neste m\u00e9todo iremos apresentar o m\u00e9todo dos gradientes conjugados com pr\u00e9-condicionador mul-\ntiescala recursivo recentemente introduzido no artigo de Klaus Lackner e Ralph Menikoff [115],\n\u201cMultiscale Linear Solvers for Very Large Systems Derived from PDES\u201d, publicado em SIAM\nJournal on Scientific Computing em 2000. Esse m\u00e9todo combina gradientes conjugados com um\npr\u00e9-condicionamento multiescala e recursivo, tendo como base o m\u00e9todo multigrid de dois n\u00edveis.\nBasicamente, definimos o pr\u00e9-condicionador como o m\u00e9todo multigrid de dois n\u00edveis,\n\nM?1 = (P?1Q)?(?A?1? ?)(QP\n?1)? + P?1\n\n2??1??\n?=0\n\n(P?1Q)? , (5.3.1)\n\nno entanto, a multiplica\u00e7\u00e3o de A?1? por um vetor \u00e9 feita aplicando recursivamente o m\u00e9todo dos\ngradientes conjugados com esse pr\u00e9-condicionador. Isto \u00e9, a resolu\u00e7\u00e3o do sistema residual A?? = ?,\ncomo no Algoritmo 5.1, \u00e9 obtida aplicando novamente o m\u00e9todo dos gradientes conjugados com\npr\u00e9-condicionador multiescala recursivo nesse sistema. A recurs\u00e3o acaba quando o problema \u00e9\nresolvido exatamente na malha mais grossa.\n\nUma propriedade importante desse pr\u00e9-condicionador \u00e9 que ele acopla as componentes asso-\nciadas aos high frequency modes e low frequency modes em cada n\u00edvel atrav\u00e9s de um m\u00e9todo de\ngradientes conjugados antes de seguir para o pr\u00f3ximo n\u00edvel. Isso evita acumulo dos erros de trun-\ncamento provenientes da restri\u00e7\u00e3o do operador discreto na malha grossa [115]. Em particular,\nse o operador na malha grossa n\u00e3o reduzir muito bem algumas componentes, o que tipicamente\nacontece quando os coeficientes da EDP s\u00e3o discont\u00ednuos, ent\u00e3o essas componentes ser\u00e3o corrigidas\npelo m\u00e9todo dos gradientes conjugados com apenas uma pequena penalidade [115].\n\nA forma com que o pr\u00e9-condicionador \u00e9 construido leva em considera\u00e7\u00e3o ambos os extremos\ndo espectro da matriz A, atrav\u00e9s do m\u00e9todo multigrid, de maneira que a matriz do sistema\npr\u00e9-condicionado M?1A tenha um n\u00famero de condi\u00e7\u00e3o pequeno, e consequentemente apenas um\npequeno n\u00famero de itera\u00e7\u00f5es \u00e9 preciso para a converg\u00eancia do m\u00e9todo dos gradientes conjugados\nem cada n\u00edvel. \u00c9 esperado que a alta qualidade do pr\u00e9-condicionador resulte na redu\u00e7\u00e3o do n\u00famero\nde itera\u00e7\u00f5es [115].\n\n50\n\n\n\n5.4 Implementa\u00e7\u00e3o do m\u00e9todo dos gradientes conjugados\ncom pr\u00e9-condicionador multiescala recursivo\n\nNessa se\u00e7\u00e3o iremos mostrar a implementa\u00e7\u00e3o do m\u00e9todo dos gradientes conjugados com pr\u00e9-\ncondicionador multiescala recursivo para resolver um sistema linear provenienteda discretiza\u00e7\u00e3o de\num problema de Poisson associado ao problema de press\u00e3o-velocidade com condi\u00e7\u00f5es de contorno\nt\u00edpicas de fluxos em meios porosos. Iremos tamb\u00e9m definir quem ser\u00e3o os operadores de restri\u00e7\u00e3o\ne prolonga\u00e7\u00e3o, os smoothers, as matrizes do sistema linear discretizado na malha grossa e como\niremos tratar as condi\u00e7\u00f5es de contorno.\n\nO algoritmo para o m\u00e9todo dos Gradientes Conjugados com Pr\u00e9-condicionador multiescala\nRecusivo (GCMR) \u00e9 dado abaixo.\n\nAlgoritmo 5.2 : Algoritmo para o M\u00e9todo GCMR.\nGCMR(A?, ?, ?0, ?, ????):\nLet ?0 = ? ? A??0;\n?0 = ?0 = PMR(A?, ?0, ?, ?);\nfor ? = 0, 1, . . . , ???? ou at\u00e9 converg\u00eancia do\n\n?? =\n??\n\n?\n??\n\n??\n?\nA? ??\n\n;\n??+1 = ?? + ????;\n??+1 = ? ? A???+1;\n??+1 = PMG(A?, ??+1, ?, ?);\n\n??+1 =\n??\n\n?+1??+1\n??\n\n?\nA? ??\n\n;\n\n??+1 = ??+1 + ??+1??;\nend for\n\nAlgoritmo 5.3 : Pr\u00e9-condicionador multiescala recursivo (PMR)\nPMR(A?, ?, ?, ?):\n? = ?????????(A?, ?, ?, ?);\n? = ????????(? ? A??);\nif (? = 0) then\n\nSolve A?? = ? ;\nelse\n\n? = GCMR(A??1, ?, ?0, ?, ????);\nend if\n? = ? + ? ?????????(?);\n? = ??????????(A?, ?, ?, ?);\n\n51\n\n\n\nCom base nos Algoritmos 5.2 e 5.3, pode-se ver que o m\u00e9todo dos gradientes conjugados\nmultiescala recursivo possui uma \u201cdupla\u201d recurs\u00e3o. A recurs\u00e3o termina quando chegamos na\nmalha mais grossa, onde esperamos que a dimens\u00e3o da matriz A? nesse n\u00edvel seja pequena o\nsuficiente para que possamos aplicar um m\u00e9todo direto para resolver o sistema A?? = ?.\n\nA implementa\u00e7\u00e3o do algoritmo multiescala Recursivo foi feita de acordo com a implementa\u00e7\u00e3o\nsugerida no artigo de R. Menikoff e K. Lackner . No entanto, algumas modifica\u00e7\u00f5es tiveram que\nser feitas, e ser\u00e3o discutidas a seguir.\n\nPrimeiramente, no artigo [115] os autores usaram um m\u00e9todo de diferen\u00e7as finitas centrado\npara discretizar o problema el\u00edptico usando uma malha cell-centered. No entanto, neste trabalho\nusamos discretiza\u00e7\u00e3o por elementos finitos mistos, como visto no Cap\u00edtulo 4. A nossa escolha\npor elementos finitos \u00e9 motivada pelo contexto de din\u00e2mica de fluidos em meios porosos, onde o\nproblema el\u00edptico \u00e9 resolvido em conjunto a equa\u00e7\u00f5es de natureza parab\u00f3lica e hiperb\u00f3lica pela\nt\u00e9cnica de decomposi\u00e7\u00e3o de operadores. Assim, o principal prop\u00f3sito em resolver o problema\nde press\u00e3o-velocidade \u00e9 obter uma boa aproxima\u00e7\u00e3o para o campo de velocidades, o qual ser\u00e1\nusado para aproximar as equa\u00e7\u00f5es de transporte, como mostrado nos Cap\u00edtulos 2 e 3. Nesse\ncontexto, a formula\u00e7\u00e3o por elementos finitos mistos se mostra mais vantajosa. Como j\u00e1 dito no\nCap\u00edtulo 2, elementos finitos mistos s\u00e3o considerados muito apropriados para c\u00e1lculo de campos de\nvelocidade precisos na presen\u00e7a de heterogeneidades geol\u00f3gicas abruptas dos campos de porosidade\ne permeabilidade [136, 137, 41, 39, 23, 153, 28]. Outra vantagem \u00e9 que o valor das permeabilidades\nnas fronteiras dos elementos s\u00e3o naturalmente obtidas [136, 137]. Em diferen\u00e7as finitas \u00e9 necess\u00e1rio\ntomar uma m\u00e9dia ad-hoc [115, 118]; ver tamb\u00e9m [40].\n\nDe modo a evitar as dificuldades introduzidas pelas condi\u00e7\u00f5es de contorno, R. Menikoff e K.\nLackner escolheram, em seu artigo, anular as condi\u00e7\u00f5es de contorno. Isso \u00e9, os autores geraram um\ncampo ??? de press\u00e3o de tal forma a anular as condi\u00e7\u00f5es de contorno. O problema ent\u00e3o \u00e9 resolvido\npara ? = ? ? ??? com fronteira nula e um termo adicional no termo de fonte [115]. Neste trabalho\nresolvemos n\u00e3o fazer isso. Na discretiza\u00e7\u00e3o por elementos finitos mistos as condi\u00e7\u00f5es de contorno\ns\u00e3o explicitamente incluidas nas equa\u00e7\u00f5es discretas, diferentemente da formula\u00e7\u00e3o por diferen\u00e7as\nfinitas. Ent\u00e3o \u00e9 razo\u00e1vel matermos esses valores pois eles carregam as principais informa\u00e7\u00f5es do\nescoamento dos fluidos em considera\u00e7\u00e3o.\n\nNo entanto, o uso de condi\u00e7\u00f5es de contorno n\u00e3o homog\u00eaneas trazem alguns problemas. Como\nvisto na se\u00e7\u00e3o 5.2.2 essas condi\u00e7\u00f5es n\u00e3o tem uma boa escalabilidade, fazendo com que a relaxa\u00e7\u00e3o\ndo smoother nos elementos da fronteira seja menos eficiente do que nos elementos internos. Dessa\nforma, seguindo as estrat\u00e9gias descritas na se\u00e7\u00e3o 5.2.2 optamos por usar um smoother mais eficiente\ne um maior n\u00famero de itera\u00e7\u00f5es, ?. Nesse caso, modificar os operadores de restri\u00e7\u00e3o e prolonga\u00e7\u00e3o\nn\u00e3o \u00e9 interessante devido a maior dificuldade de implementa\u00e7\u00e3o.\n\nAssim, para o smoother, escolhemos usar uma estrat\u00e9gia red-black em conjunto ao m\u00e9todo\niterativo Gauss-Seidel sim\u00e9trico, o qual \u00e9 originalmente usado em [115], para acelerar a converg\u00eancia\ndesse m\u00e9todo. Em seu artigo, R. Menikoff e K. Lackner usaram ? igual ao fator de escala do\nproblema, isto \u00e9 igual a escala de discretiza\u00e7\u00e3o do problema na malha mais fina [115], por\u00e9m\nnossos experimentos n\u00e3o tiveram sucesso usando esse ?, mesmo considerando a acelera\u00e7\u00e3o do\nsmoother. Nesses experimentos, o m\u00e9todo dos gradientes conjugados n\u00e3o convergia (no sentido de\nque atingia o n\u00famero m\u00e1ximo de itera\u00e7\u00f5es estabelecido, dado pelo n\u00famero total de elementos) em\nn\u00edveis mais grossos. Ap\u00f3s v\u00e1rios experimentos encontramos que ? = 3?/2, onde ? \u00e9 o fator de\n\n52\n\n\n\nescala de discretiza\u00e7\u00e3o do problema na malha mais fina, era o melhor valor para a maior parte dos\nproblemas, considerando tempo computacional e n\u00famero de itera\u00e7\u00f5es do gradientes conjugados.\n\nNas pr\u00f3ximas se\u00e7\u00f5es vamos definir os operadores de restri\u00e7\u00e3o e prolonga\u00e7\u00e3o e o m\u00e9todo iterativo\nusado como smoother. Precisamos tamb\u00e9m dar uma aten\u00e7\u00e3o especial para a escolha da matriz do\nsistema linear discreto na malha grossa A?, e isso ser\u00e1 visto logo a seguir.\n\n5.4.1 Aproxima\u00e7\u00e3o da permeabilidade na malha\nNeste momento precisamos definir como ser\u00e1 a matriz do sistema linear discreto na malha\n\ngrossa, A?. H\u00e1 duas maneiras de definir essa matriz: primeiro, usamos os operadores de restri\u00e7\u00e3o\ne prolonga\u00e7\u00e3o de modo que A? = ?A?, [122, 146, 132]. Escrevendo a matriz dessa forma na malha\ngrossa, obtemos uma maneira de gerar A? automaticamente, no entanto perdemos a estrutura de\nesparsidade de A. Outra forma de escrever A? seria rediscretizando o problema em uma malha\ngrossa. Assim, mantemos a mesma estrutura da matriz na malha fina [146]. Essa \u00e9 a forma que\nescolhemos para definir A?.\n\nAp\u00f3s escolher A? precisamos nos preocupar em definir a permeabilidade na malha grossa.\nComo podemos ver pela equa\u00e7\u00e3o (B.3.5), a matriz do sistema linear resultante da discretiza\u00e7\u00e3o por\nelementos finitos mistos, tanto na malha fina quanto na grossa, tem seus coeficientes dependente\ndas permebilidades. Em um problema real, os \u00fanicos dados de permeabilidades que temos s\u00e3o as\npermeabilidades na malha fina, portanto precisamos usar esses dados para aproximar de alguma\nforma as permeabilidades na malha grossa. Isso ser\u00e1 feito atrav\u00e9s das transmissividades [115],\ndefinidas para um tensor diagonal de permeabilidade, ?(x) = diag [???(x) ???(x)], ? ? R2 como:\n\n??? =\n??\n??\n\n???, na dire\u00e7\u00e3o ?,\n\n??? =\n??\n??\n\n???, na dire\u00e7\u00e3o ?,\n\nonde ?? e ?? denota o comprimento e altura de um elemento, respectivamente. A transmissividade\nnuma malha mais grossa, ? ?, \u00e9 tomada como,\n\n1\n? ???(x)\n\n=\n??\n\n?\n\n1??\n? ???(?, ?)\n\n;\n1\n\n? ???(x)\n=\n??\n\n?\n\n1??\n? ???(?, ?)\n\n;\n\nonde essa soma \u00e9 sobre os elementos da malha fina contidos num elemento da malha mais grossa;\n? e ? s\u00e3o os \u00edndices correspondentes as dire\u00e7\u00f5es ? e ? respectivamente.\n\nEssa forma de definir as permeabilidades na malha grossa \u00e9 vantajosa pois [115]: (a) Mesmo\nque ?(x) seja escalar na malha fina, tipicamente ele n\u00e3o ser\u00e1 escalar na malha grossa; (b) Os\nefeitos das condi\u00e7\u00f5es de contorno em ? s\u00e3o apropriadamente contabilizadas; e (c) A forma do\noperador discreto na malha grossa \u00e9 preservado.\n\n5.4.2 Smoother\nEm [115], R. Menikoff e K. Lackner escolheram como smothers os m\u00e9todos de Jacobi com peso\n\n1/2 e o m\u00e9todo de Gauss-Seidel sim\u00e9trico. No entanto, como j\u00e1 dito anteriormente, encontramos\n\n53\n\n\n\ndificuldades em relaxar os elementos da fronteira devido as condi\u00e7\u00f5es de contorno n\u00e3o nulas. Dessa\nforma, aproveitamos o m\u00e9todo Gauss-Seidel sim\u00e9trico e o combinamos com uma estrat\u00e9gia red-\nblack para usar como smoother, melhorando sua taxa de converg\u00eancia.\n\nA estrat\u00e9gia red-black percorre e atualiza os elementos de modo n\u00e3o sequencial. Primeiro \u00e9\natualizado os elementos \u00edmpares (ou pares) e em seguida usa-se os elementos atualizados para\ncalcular os elementos pares (ou \u00edmpares), como em um tabuleiro de xadrez, ver Figura 5.3.\n\nFigura 5.3: Estrat\u00e9gia red-black. Atualiza os elementos primeiro os elementos \u00edmpares, em seguida\natualiza os elementos pares. Note que cada elemento \u00edmpar tem todos os seus vizinhos como pares,\ne vice-versa.\n\nO smoother red-black Gauss-Seidel sim\u00e9trico \u00e9 escrito da seguinte forma: a matriz do sistema\nlinear \u00e9 decomposta como A = P ? Q,\n\nP = (D + L)D?1(D + L?), Q = LD?1L?,\n\nonde as matrizes D e L vem da decomposi\u00e7\u00e3o A = D + L + L?, e L \u00e9 a parte estritamente inferior\ne D \u00e9 a diagonal.\n\n5.4.3 Operadores de Restri\u00e7\u00e3o e Prolonga\u00e7\u00e3o\nPara o operador de prolonga\u00e7\u00e3o usamos o produto tensorial de duas interpola\u00e7\u00f5es lineares em\n\n1-D, os mesmos utilizados por R. Menikoff e K. Lackner [115]. O operador de restri\u00e7\u00e3o \u00e9 dado pelo\nadjunto do operador de prolonga\u00e7\u00e3o. Os operadores de prolonga\u00e7\u00e3o e restri\u00e7\u00e3o para o caso onde a\ndiscretiza\u00e7\u00e3o \u00e9 cell-centered s\u00e3o representados pelos stencils [132],\n\n? =\n1\n16\n\n?\n????\n1 3 3 1\n3 9 9 3\n3 9 9 3\n1 3 3 1\n\n?\n???? , ? = 164\n\n?\n????\n1 3 3 1\n3 9 9 3\n3 9 9 3\n1 3 3 1\n\n?\n???? . (5.4.1)\n\nA partir do stencil de prolonga\u00e7\u00e3o, construimos os valores nos centros dos elementos da seguinte\nforma:\n\n?? =\n1\n16\n\n(9?? + 3?? + 3?? + ??) , (5.4.2)\n\n54\n\n\n\nonde ?? \u00e9 um elemento da malha fina como ilustrado na Figura 5.4.\nOs valores nos centros dos elementos grossos s\u00e3o construidos a partir das seguintes equa\u00e7\u00f5es,\n\nobtidas pelo stencil de restri\u00e7\u00e3o,\n\n?? =\n1\n64\n\n(9?? + 3?? + 3?? + ??) , (5.4.3)\n\n?? =\n1\n64\n\n(9?? + 3?? + 3?? + ??) , (5.4.4)\n\n?? =\n1\n64\n\n(9?? + 3?? + 3?? + ??) , (5.4.5)\n\n?? =\n1\n64\n\n(9?? + 3?? + 3?? + ??) , (5.4.6)\n\nonde ??, ?? , ?? e ?? s\u00e3o os centros dos elementos na malha mais grossa como mostrado na Figura\n5.4.\n\nFigura 5.4: Prolonga\u00e7\u00e3o e restri\u00e7\u00e3o em um peda\u00e7o da malha. As letras em mai\u00fasculo represen-\ntam os centros dos elementos da malha grossa. As letras min\u00fasculas representam os centros dos\nelementos da malha fina .\n\nOs operadores (5.4.1) s\u00e3o validos para todos os elementos internos, no entanto um maior cuidado\n\u00e9 necess\u00e1rio para restringir e prolongar os elementos de fronteira. Esses elementos tem vizinhos em\napenas um dos lados, como mostrado na Figura 5.5. Dessa forma n\u00e3o podemos aplicar o operador\nacima. Iremos usar para os elementos de fronteira uma interpola\u00e7\u00e3o com derivada normal nula na\nfronteira, como feito pelos autores em [115].\n\nPor exemplo, o stencil de prolonga\u00e7\u00e3o para o elemento ? da fronteira \u00e0 esquerda, sem estar no\ncanto, como mostra a Figura 5.5 \u00e9 dado por,\n\n? =\n1\n16\n\n?\n????\n0 4 3 1\n0 12 9 3\n0 12 9 3\n0 4 3 1\n\n?\n???? , (5.4.7)\n\n55\n\n\n\nE para o elemento ? do extremo canto inferior \u00e0 esquerda, Figura 5.5, temos o stencil\n\n? =\n1\n16\n\n?\n????\n0 4 3 1\n0 12 9 3\n0 16 9 3\n0 0 3 1\n\n?\n???? . (5.4.8)\n\nA restri\u00e7\u00e3o dos elementos de fronteira \u00e9 feito de uma maneira similar, atrav\u00e9s dos mesmos stencils\npor\u00e9m com um fator multiplicante de 1/64, como em (5.4.1).\n\nFigura 5.5: Prolonga\u00e7\u00e3o e restri\u00e7\u00e3o dos elementos de fronteira. A letra em mai\u00fasculo representa\no centro do elemento da malha grossa. As letras min\u00fasculas representam os centros dos elementos\nda malha fina .\n\n5.4.4 Crit\u00e9rio de Parada\nComo crit\u00e9rio de parada escolhemos o mesmo crit\u00e9rio de usado no artigo de R. Menikoff e K.\n\nLackner [115]. Ele \u00e9 dado atrav\u00e9s da norma do res\u00edduo normalizada,\n\n???2?\n??\n\n&lt;??, ?? = ?\n?\n\n??, (5.4.9)\n\nonde ?? \u00e9 o n\u00famero de elementos na malha, ? \u00e9 uma toler\u00e2ncia dada e ? \u00e9 um par\u00e2metro ajust\u00e1vel\nque controla o erro em cada n\u00edvel ?. De acordo com o artigo de R. Menikoff e K. Lackner, [115],\no algoritmo parece ser bastante sens\u00edvel a escolha de ?. Assim, conforme ? aumenta o n\u00famero de\nitera\u00e7\u00f5es no n\u00edvel da malha mais fina tamb\u00e9m aumenta, e se ? for muito pequeno ent\u00e3o temos\nitera\u00e7\u00f5es desnecess\u00e1rias nos n\u00edveis mais grossos [115]. Nesse trabalho, os autores encontraram\nexperimentalmente que o valor ? = 0.1 tem um funcionamento razoavelmente bom, dessa forma\nfixamos esse valor para os nossos experimentos.\n\nPor fim, ap\u00f3s definir todos os ingredientes necess\u00e1rios para o algoritmo do m\u00e9todo dos gradientes\nconjugados multiescala recursivo, n\u00f3s o implementamos em linguagem C pura e em um laptop\nb\u00e1sico. A implementa\u00e7\u00e3o foi simples, serial e intensionalmente n\u00e3o procuramos uma implementa\u00e7\u00e3o\neficiente. Dessa forma podemos testar o efeito do pr\u00e9-condicionador multiescala na redu\u00e7\u00e3o do\nn\u00famero de itera\u00e7\u00f5es do m\u00e9todo dos gradientes conjugados.\n\n56\n\n\n\nNo pr\u00f3ximo cap\u00edtulo apresentaremos experimentos num\u00e9ricos onde aplicamos o m\u00e9todo mul-\ntiescala recursivo em problemas representativos de press\u00e3o-velocidade, variando o campo de per-\nmeabilidades, de maneira a validar o m\u00e9todo e reproduzir as mesmas tend\u00eancias do algoritmo\napresentadas no artigo de K. Lackner e R. Menikoff [115].\n\n57\n\n\n\n58\n\n\n\nCap\u00edtulo 6\n\nExperimentos num\u00e9ricos para problemas\nel\u00edpticos de Poisson em geometrias de\naplica\u00e7\u00f5es\n\nNo cap\u00edtulo anterior, discutimos sobre a deriva\u00e7\u00e3o e a implementa\u00e7\u00e3o do m\u00e9todo dos gradien-\ntes conjugados multiescala recursivo, introduzido por Klaus Lackner e Ralph Menikoff no artigo\n\u201cMultiscale Linear Solvers for Very Large Systems Derived from PDES\u201d, publicado em SIAM\nJournal on Scientific Computing, 2000 [115], para a resolu\u00e7\u00e3o de um sistema linear proveniente da\ndiscretiza\u00e7\u00e3o de sistemas de equa\u00e7\u00f5es diferenciais parciais el\u00edpticas.\n\nNeste trabalho estamos interessados na aplica\u00e7\u00e3o do m\u00e9todo multiescala para a aproxima\u00e7\u00e3o\nnum\u00e9rica de problemas de Poisson no contexto de escoamento de fluidos em meios porosos.\n\nNo cap\u00edtulo 2 apresentamos modelagens de diversos problemas em din\u00e2mica de fluidos. En-\ntre elas, formula\u00e7\u00f5es para o problema de escoamento incompress\u00edvel com tr\u00eas fases (2.1.19), com\nduas fases (2.1.20)-(2.1.22) e com duas fases e histerese (2.1.25)-(2.1.27). Apresentamos tamb\u00e9m,\nmodelos como o do tra\u00e7ador passivo (2.2.1) e press\u00e3o global (2.2.4)-(2.2.5). Todas essas formula-\n\u00e7\u00f5es possuem em comum um problema de press\u00e3o-velocidade de natureza el\u00edptica associado a um\nsistema de transporte, que pode ser escrito de forma geral como:\n\n? \u00b7 u = ?(x), u = ??(x)??(x), x ? ?. (6.0.1)\n\nonde ?(x) \u00e9 um termo de fonte e ?(x) \u00e9 uma fun\u00e7\u00e3o que acompanha a press\u00e3o e representa\ncaracter\u00edsticas do meio. Por exemplo, no caso trif\u00e1sico ?(x) = ?(x)?(??, ??), as fun\u00e7\u00f5es de per-\nmeabilidade e mobilidade do meio poroso. Assim, mostramos que problemas de Poisson aparecem\nnaturalmente na modelagem matem\u00e1tica de diversos problemas concretos em escoamento de flui-\ndos em meios porosos, e devido a sua abrang\u00eancia, o estudo de problemas el\u00edpticos nesse contexto\n\u00e9 de extrema import\u00e2ncia.\n\nN\u00e3o podemos esquecer que neste momento o problema de press\u00e3o-velocidade est\u00e1 acoplado\nas equa\u00e7\u00f5es de transporte. Tendo em vista o foco deste trabalho, aplicamos uma t\u00e9cnica de\ndecomposi\u00e7\u00e3o de operadores para desacoplar o problema de Poisson do sistema de transporte,\ncomo descrito no cap\u00edtulo 3. Assim, uma simula\u00e7\u00e3o completa de um problema em escoamento de\nfluidos em meios porosos envolveria resolver em sequ\u00eancia, o problema de press\u00e3o-velocidade e o\n\n59\n\n\n\nsistema de transporte, aplicando t\u00e9cnicas num\u00e9ricas espec\u00edficas para cada problema. No entanto\nnos concentraremos apenas na resolu\u00e7\u00e3o num\u00e9rica do problema de Poisson.\n\nAo \u201cisolar\u201d a resolu\u00e7\u00e3o do problema de Poisson, discretizamos o problema atrav\u00e9s da formula\u00e7\u00e3o\nde elementos finitos mistos (ver, Cap. 4). Esse m\u00e9todo \u00e9 considerado muito apropriado para o\nc\u00e1lculo de campos de velocidade na presen\u00e7a de heterogeneidades, o qual \u00e9 justamente o nosso\ncaso. O c\u00e1lculo preciso do campo de velocidades \u00e9 necess\u00e1rio para a aproxima\u00e7\u00e3o do subsequente\nproblema de transporte, considerando uma simula\u00e7\u00e3o completa de um problema em escoamento\nem meios porosos (ver, Cap. 3). Por fim, obtemos um sistema linear sim\u00e9trico definido positivo\npara a press\u00e3o e aplicamos o m\u00e9todo dos gradientes conjugados multiescala recursivo para sua\nresolu\u00e7\u00e3o.\n\nComo dito no cap\u00edtulo anterior, o m\u00e9todo multiescala foi desenvolvido para melhor capturar\nos distintos comprimentos de onda associados aos diferentes comprimentos de onda do operador\nauto-adjunto de Poisson, os quais s\u00e3o fortemente influ\u00eanciados pela heterogeneidade do meio. E\nisso \u00e9 feito combinando o m\u00e9todo dos gradientes conjugados com um pr\u00e9-condicionador multiescala\nobtido atrav\u00e9s do m\u00e9todo multigrid.\n\nFigura 6.1: Representa\u00e7\u00e3o de um aqu\u00edfero subterr\u00e2neo .\n\nPara nossos experimentos num\u00e9ricos consideramos alguns problemas de Poisson simplificados.\nN\u00e3o estamos interessados em uma geometria complexa. Queremos estudar um problema prot\u00f3tipo\nde modo a validar nosso algoritmo. Diversos problemas matem\u00e1ticos podem ser entendidos por\nmeio de geometrias mais simples [2, 21, 24, 31, 34, 61, 62, 68, 71, 76]. Por exemplo, considere\na Figura 6.1 que ilustra um aqu\u00edfero. Agora, veja a Figura 6.2.(a) que representa o dom\u00edno\ncomplexo do aqu\u00edfero. A Figura 6.2.(b) ilustra uma malha geom\u00e9trica que aproxima o dom\u00ednio\ncomplexo do reservat\u00f3rio. E na Figura 6.2.(c) mostra um dom\u00ednio retangular contido no aqu\u00edfero.\nDessa forma, \u00e9 razo\u00e1vel esperar que geometrias retangulares forne\u00e7am uma boa aproxima\u00e7\u00e3o para\n\n60\n\n\n\ndiversos reservat\u00f3rios. O uso de um dom\u00ednio retangular facilita a transfer\u00eancia de valores entre\n\nFigura 6.2: Representa\u00e7\u00e3o da geometria complexa de um dom\u00ednio, com uma simplifica\u00e7\u00e3o dada\npor uma geometria retangular. Baseada na refer\u00eancia [20] .\n\nmalhas, n\u00e3o precisando nos preocupar com poss\u00edveis modifica\u00e7\u00f5es aos operadores de restri\u00e7\u00e3o e\nprolonga\u00e7\u00e3o (ver, Se\u00e7\u00e3o 5.4.3) devido a maior complexidade da malha. O c\u00e1lculo dos valores das\npermeabilidades nas malhas mais grosseiras (ver, Se\u00e7\u00e3o 5.4.1) se torna mais simples, facilitando a\nimplementa\u00e7\u00e3o. Dessa forma temos mais controle sobre cada passo do algoritmo.\n\nA seguir vamos listar os problemas escolhidos para os experimentos num\u00e9ricos deste cap\u00edtulo,\nbem como os resultados obtidos em cada caso. Todos os experimentos a seguir foram feitos em\num laptop b\u00e1sico com sistema operacional UBUNTU 14.04 LTS, processador i3 2.53 GHz e 4 MB\nde mem\u00f3ria RAM.\n\n6.1 Press\u00e3o-fluxo slab Dirichlet-Dirichlet\n\nPara este experimento consideramos um problema de Poisson bidimensional simplificado de\npress\u00e3o-velocidade em um dom\u00ednio retangular, que modela o escoamento de um fluido em um meio\n\n61\n\n\n\nporoso, dado por:\n\n? \u00b7 u = 0, u = ??(x)??(x), x ? ? = [0, ??] \u00d7 [0, ??] ? R2,\n?(0, ?) = 1, ?(??, ?) = 0, ?? ? [0, ??],\nu(?, 0) = 0, u(?, ??) = 0, ?? ? [0, ??],\n\n(6.1.1)\n\nFigura 6.3: Dom\u00ednio retangular do problema (6.1.1) ilustrando as condi\u00e7\u00f5es de contorno.\n\n?(x) \u00e9 o tensor de permeabilidade absoluta do meio poroso definido no cap\u00edtulo 2 (ver, Sec. 2.1).\n\nO problema (6.1.1) \u00e9 bem posto pois \u00e9 unicamente determinado pelas condi\u00e7\u00f5es impostas\nna fronteira. As fronteiras acima e abaixo do dom\u00ednio retangular possuem fluxo nulo, n\u00e3o h\u00e1\ntransfer\u00eancia de fluidos. Na fronteira a esquerda temos imposta uma press\u00e3o ? = 1, e na fronteira\na direita temos press\u00e3o nula. Dessa forma temos uma diferen\u00e7a de press\u00e3o que causa o aparecimento\nde um gradiente de press\u00e3o da esquerda para a direita, movendo o fluido nessa dire\u00e7\u00e3o.\n\nPara os testes num\u00e9ricos consideramos tr\u00eas tipos de fun\u00e7\u00f5es de permeabilidade absoluta: ho-\nmog\u00eanea, com barreira e heterog\u00eanea. A permeabilidade homog\u00eanea \u00e9 dada como uma constante\nem todo o dom\u00ednio, com um valor de 10?06. A permeabilidade do tipo barreira \u00e9 mostrada na\nFigura 6.4. Temos uma permeabilidade constante de 10+06 em quase todo o dom\u00ednio, por\u00e9m h\u00e1\nduas colunas em aproximadamente cada 1/3 do dom\u00ednio com uma permeabilidade de 10?06, de\nmodo a diminuir drasticamente o escoamento do fluido nesses locais.\n\n62\n\n\n\nFigura 6.4: Ilustra\u00e7\u00e3o da fun\u00e7\u00e3o de permeabilidade do tipo barreira usada nos experimentos deste\ntrabalho. A permeabilidade \u00e9 de 10+06 em quase todo o dom\u00ednio, por\u00e9m h\u00e1 2 colunas com uma\npermeabilidade de 10?06.\n\nPor \u00faltimo, a permeabilidade heterog\u00eanea \u00e9 definida em todo o dom\u00ednio usando o mesmo\nmecanismo descrito em [96]. Para modelar a permeabilidade absoluta de uma estrutura rochosa\nheterogenea consideramos um campo de permeabilidade log-normal ?(x), de modo que ?(x) =\nlog ?(x) \u00e9 uma Gaussiana e sua distribui\u00e7\u00e3o \u00e9 determinada por suas fun\u00e7\u00f5es de m\u00e9dia e covari\u00e2ncia.\nA permeabilidade absoluta \u00e9 dada por [34, 71]:\n\n?(x) = ?0???(x), (6.1.2)\n\n?0 \u00e9 um valor de truncamento, e 0 &lt;? ? 1 \u00e9 um fator de escala. Para os nossos experimentos\nfixamos o valor de truncamento para ?0 = 1 e o fator de escala em ? = 2. Podemos tamb\u00e9m gerar\nf\u00e1cilmente uma matriz de permeabilidade homog\u00eanea usando a equa\u00e7\u00e3o (6.1.2) colocando ? = 0 e\nfixando ?0 = 10?06. Em todos os casos considerados, a permeabilidade \u00e9 determin\u00edstica. No caso\nda permeabilidade heterog\u00eanea, trabalhamos com apenas uma realiza\u00e7\u00e3o da gaussiana ?(x).\n\nAplicamos nosso algoritmo multiescala no problema (6.1.1) com os tr\u00eas tipos de permeabilidade\npara ? = 512, 1024, 2048, onde ? \u00e9 a escala de discretiza\u00e7\u00e3o do problema na malha mais fina.\nAssim, temos 5122 = 262144, 10242 = 1048576 e 20482 = 4194304 elementos e podemos analisar o\ncomportamento do algoritmo na presen\u00e7a de sistemas lineares da ordem de centenas de milhares\nde equa\u00e7\u00f5es.\n\nEscolhemos o tamanho do dom\u00ednio como ?? = ?? = 512m, para que cada elemento tenha\ninicialmente tamanho 1m \u00d7 1m. Usamos o m\u00e9todo red-black Gauss-Seidel sim\u00e9trico (ver, Sec.\n5.4.2) como smoother e fixamos seu n\u00famero de itera\u00e7\u00f5es como ? = 3?/2, considerando tempo\ncomputacional e n\u00famero de itera\u00e7\u00f5es do gradientes conjugados (ver, Cap. 5.3). No entanto,\ntivemos que aumentar esse valor no caso do problema com permeabilidade tipo barreiras. O fator\nde escala entre malhas foi fixado em 4 e a toler\u00e2ncia fixada em ? = 10?07. Fixamos tamb\u00e9m a\nquantidade de n\u00edveis de malha em 4.\n\n63\n\n\n\nNa Figura 6.5 temos os gr\u00e1ficos da press\u00e3o e do fluxo do problema (6.1.1) com permeabilidade\nhomog\u00eanea, com barreiras e heterog\u00eanea com ? = 2. Nelas podemos ver a dire\u00e7\u00e3o de escoamento\ndo fluido, que percorre o dom\u00ednio da esquerda para a direita. No caso homog\u00eaneao o meio poroso \u00e9\ncaracterizado pela permeabilidade, e devido ela ser uma constante, qualquer ponto do meio poroso\ncompartilha a mesma caracter\u00edstica. Por isso a velocidade e a intensidade do fluido \u00e9 a mesma\nem todo o dom\u00ednio. N\u00e3o h\u00e1 transfer\u00eancia de fluidos nas fronteiras superior e inferior, como se \u00e9\nesperado.\n\nPermeabilidade homog\u00eanea:\n512 1024 2048\n\nN\u00edvel Dim Itera\u00e7\u00f5es Dim Itera\u00e7\u00f5es Dim Itera\u00e7\u00f5es\n1 8 \u00d7 8 8 16 \u00d7 16 8 32 \u00d7 32 8\n2 32 \u00d7 32 4 64 \u00d7 64 4 128 \u00d7 128 4\n3 128 \u00d7 128 2 256 \u00d7 256 2 512 \u00d7 512 2\n4 512 \u00d7 512 1 1024 \u00d7 1024 1 2048 \u00d7 2048 1\n\nPermeabilidade com barreiras:\n512 1024\n\nN\u00edvel Dim Itera\u00e7\u00f5es Dim Itera\u00e7\u00f5es\n1 8 \u00d7 8 78 16 \u00d7 16 95\n2 32 \u00d7 32 40 64 \u00d7 64 53\n3 128 \u00d7 128 29 256 \u00d7 256 34\n4 512 \u00d7 512 8 1024 \u00d7 1024 7\n\nPermeabilidade heterog\u00eanea com ? = 2:\n512 1024 2048\n\nN\u00edvel Dim Itera\u00e7\u00f5es Dim Itera\u00e7\u00f5es Dim Itera\u00e7\u00f5es\n1 8 \u00d7 8 40 16 \u00d7 16 50 32 \u00d7 32 39\n2 32 \u00d7 32 20 64 \u00d7 64 25 128 \u00d7 128 22\n3 128 \u00d7 128 12 256 \u00d7 256 18 512 \u00d7 512 12\n4 512 \u00d7 512 7 1024 \u00d7 1024 6 2048 \u00d7 2048 4\n\nTabela 6.1: Itera\u00e7\u00f5es acumuladas por n\u00edvel para o problema (6.1.1) com permeabilidade homog\u00eanea,\ncom barreiras e heterog\u00eanea com ? = 2. A tabela mostra o n\u00famero de itera\u00e7\u00f5es por n\u00edvel do\nproblema com dimens\u00f5es 512 \u00d7 512, 1024 \u00d7 1024 e 2048 \u00d7 2048.\n\nPara o problema com permeabilidade do tipo barreira, temos duas colunas com um valor de\npermeabilidade diferente do resto do dom\u00ednio. A diferen\u00e7a entre os valores \u00e9 da ordem de 1012,\nassim \u00e9 esperado que no momento que o fluido se aproxima dessas colunas temos um gradiente\nabrupto de press\u00e3o na fronteira dessas colunas e o fluido muda rapidamente de dire\u00e7\u00e3o. A maior\nparte do fluido contorna essas colunas com permeabilidade diferente, caminhando para o outro\nextremo do dom\u00ednio. Dentro das colunas tamb\u00e9m h\u00e1 passagem de fluido, pois as colunas n\u00e3o s\u00e3o\ncompletamente imperme\u00e1veis, por\u00e9m o fluido passa com uma velocidade bem menor do que no\nresto do meio poroso. Aqui podemos perceber a vantagem do uso dos multiplicadores de Lagrange\nna discretiza\u00e7\u00e3o por elementos finitos mistos h\u00edbridos (ver, Cap. 4) do problema de Poisson.\n\n64\n\n\n\nQuando usamos os multiplicadores relaxamos a condi\u00e7\u00e3o de que a press\u00e3o na fronteira de um\nelemento seja igual a de seu vizinho. Com os multiplicadores apenas pedimos que o tra\u00e7o da\npress\u00e3o nas fronteiras dos elementos sejam iguais, permitindo assim o c\u00e1lculo de problemas com\npress\u00f5es descont\u00ednuas.\n\nNo experimento com permeabilidade heterog\u00eanea, geramos uma matriz de permeabilidade ab-\nsoluta com os seguintes par\u00e2metros: ? = 2 e ?0 = 1. A fun\u00e7\u00e3o ?(x) foi constru\u00edda de forma a ter\num coeficiente de varia\u00e7\u00e3o ?? = 2, obtida em cima de uma malha geol\u00f3gica de 512 \u00d7 512. Por\nmeio do gr\u00e1fico de press\u00e3o e fluxo na Figura 6.5 podemos ver o comportamento do fluido. Devido\na variabilidade da fun\u00e7\u00e3o de permeabilidade absoluta do meio temos gradientes abruptos durante\ntodo o escoamento, isto \u00e9, a velocidade do fluido muda de dire\u00e7\u00e3o constantemente devido a influ\u00ean-\ncia da permeabilidade. Ainda assim, podemos ver nos gr\u00e1ficos da Figura 6.5 que a dire\u00e7\u00e3o do fluxo\nocorre da esquerda para a direita, em concord\u00e2ncia com o caso com permeabilidade homog\u00eanea.\nA Tabela 6.1 mostra o n\u00famero de itera\u00e7\u00f5es acumuladas do m\u00e9todo dos gradientes conjugados em\ncada n\u00edvel. Podemos ver que para o problema com permeabilidade homog\u00eanea, em todas as di-\nmens\u00f5es foram necess\u00e1rios apenas 1 itera\u00e7\u00e3o na malha mais fina para a converg\u00eancia do algoritmo\nmultiescala. E em apenas 1 itera\u00e7\u00e3o reduzimos a norma-2 do res\u00edduo normalizado, ?r?2/\n\n?\n??, em\n\n10?12, como podemos ver na Tabela 6.2. O tempo computacional aumentou consideravelmente em\ncada dimens\u00e3o. Foi de 1 minuto para a dimens\u00e3o 512 \u00d7 512 para quase 2 horas para o problema\ncom dimens\u00e3o 2048 \u00d7 2048.\n\nPermeabilidade homog\u00eanea:\nDim ? Tempo (min) ?r?2 ?r?? ?r?2/\n\n?\n??\n\n512 1.00 1.21 4.7512e-10 2.03795e-11 2.9345e-12\n1024 0.50 9.66 9.86644e-10 3.00549e-11 3.04692e-12\n2048 0.25 111.13 2.02647e-09 4.37593e-11 3.12903e-12\n\nPermeabilidade com barreiras:\nDim ? Tempo (min) ?r?2 ?r?? ?r?2/\n\n?\n??\n\n512 1.0 8.35 3.46806e-07 1.18744e-08 2.14199e-09\n1024 0.5 46.59 1.00591e-05 1.64844e-07 3.10641e-08\n\nPermeabilidade heterog\u00eanea com ? = 2:\nDim ? Tempo (min) ?r?2 ?r?? ?r?2/\n\n?\n??\n\n512 1.00 5.22 1.22889e-05 4.34704e-06 7.59001e-08\n1024 0.50 40.36 2.22662e-05 7.30542e-06 6.87618e-08\n2048 0.25 228.75 1.492e-05 8.48055e-07 2.30377e-08\n\nTabela 6.2: Informa\u00e7\u00f5es gerais para o problema (6.1.1) e permeabilidade homog\u00eanea, com barrei-\nras e heterog\u00eanea com ? = 2. A tabela mostra a norma do res\u00edduo da aproxima\u00e7\u00e3o e tempos\ncomputacionais. ?? \u00e9 o n\u00famero total de elementos.\n\nNo problema com barreiras, o m\u00e9todo convergiu em 8 e 7 itera\u00e7\u00f5es na malha mais fina. A\nnorma-2 do res\u00edduo normalizado foi reduzida em 10?09 para o problema de dimens\u00e3o 512 \u00d7 512 e\n10?08 para o problema de dimens\u00e3o 1024 \u00d7 1024. Nesse problema foi necess\u00e1rio aumentar o ? para\n5?/2 de modo a obter converg\u00eancia dos gradientes conjugados em todos os n\u00edveis. Falaremos sobre\n\n65\n\n\n\n 0\n\n 0.125\n\n 0.25\n\n 0.375\n\n 0.5\n\n 0.625\n\n 0.75\n\n 0.875\n\n 1\n\n 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1\n\ny\n\nx\n\n 0\n\n 0.125\n\n 0.25\n\n 0.375\n\n 0.5\n\n 0.625\n\n 0.75\n\n 0.875\n\n 1\n\n 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1\n\ny\n\nx\n\n 0\n\n 0.125\n\n 0.25\n\n 0.375\n\n 0.5\n\n 0.625\n\n 0.75\n\n 0.875\n\n 1\n\n 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1\n\ny\n\nx\n\nFigura 6.5: Gr\u00e1ficos da press\u00e3o e do campo de velocidades para o problema (6.1.1), com permea-\nbilidade homog\u00eanea, com barreiras e heterog\u00eanea com ? = 2.\n\nisso mais adiante. Novamente, o tempo computacional aumentou drasticamente de uma dimens\u00e3o\npara outra, levando 9 minutos e 45 minutos respectivamente.\n\nAgora, para o problema com permeabilidade heterog\u00eanea e ? = 2 foi necess\u00e1rio 7 e 6 itera\u00e7\u00f5es\ndo m\u00e9todo para convergir. Neste caso reduzimos a norma-2 do res\u00edduo normalizado em 10?08 e o\n\n66\n\n\n\ntempo computacional do algoritmo foi parecido com os anteriores, levando 5 minutos, 40 minutos\nequase 4 horas respectivamente.\n\nO grande tempo computacional apresentado pelo algoritmo multiescala \u00e9 um empecilho para\nque ele se torne competitivo nesse momento. Outros testes feitos para permeabilidade heterog\u00eanea\ncom ? = 4 levaram mais de 9 horas para terminar, considerando um problema com dimens\u00e3o\n2048 \u00d7 2048. Mesmo assim o algoritmo mant\u00e9m o n\u00famero baixo de itera\u00e7\u00f5es por n\u00edvel e isso \u00e9\numa indica\u00e7\u00e3o de que o tempo computacional n\u00e3o est\u00e1 conectado com a acur\u00e1cia do algoritmo.\nAnalisando o algoritmo e fazendo mais alguns testes foi poss\u00edvel perceber que a parte que mais\nnecessita esfor\u00e7o computacional \u00e9 o smoother, mais especificamente o smoother aplicado nas malhas\nmais finas. Mesmo considerando que o n\u00famero de itera\u00e7\u00f5es do smoother escolhido \u00e9 menos de\n0.2% da quantidade total de elementos da malha mais fina, ele ainda consome a maior parte do\ntempo de computa\u00e7\u00e3o. N\u00e3o podemos diminuir ? pois a converg\u00eancia depende dele (ver, Sec. 5.3).\nImaginamos que smoothers mais eficientes, que necessitem de menos opera\u00e7\u00f5es ou implementa\u00e7\u00f5es\nmais efici\u00eantes diminuam consideravelmente o tempo computacional desse m\u00e9todo.\n\n6.2 Fluxo slab Neumann-Dirichlet\nPara este experimento consideramos um problema de Poison bidimensional simplificado de\n\npress\u00e3o-velocidade em um dom\u00ednio retangular, que modela o escoamento de um fluido em um meio\nporoso, dado por:\n\n? \u00b7 u = 0, u = ??(x)??(x), x ? ? = [0, ??] \u00d7 [0, ??] ? R2,\nu = 1, ?(??, ?) = 0, ?? ? [0, ??],\nu(?, 0) = 0, u(?, ??) = 0, ?? ? [0, ??],\n\n(6.2.1)\n\nFigura 6.6: Dom\u00ednio retangular do problema (6.2.1) demonstrando as condi\u00e7\u00f5es de contorno.\n\n?(x) \u00e9 o tensor de permeabilidade absoluta do meio poroso. Mostramos o dom\u00ednio de (6.2.1) na\nFigura 6.6.\n\n67\n\n\n\nO problema (6.2.1) \u00e9 completamente determinado pelas condi\u00e7\u00f5es impostas na fronteira. As\nfronteiras acima e abaixo do dom\u00ednio retangular possuem fluxo nulo e na fronteira a esquerda\ntemos um fluxo de u = 1 entrando no meio. Na fronteira a direita temos imposta uma press\u00e3o\n? = 0. Esperamos que o fluido entre pela a fronteira \u00e0 esquerda, devido ao sentido do fluxo, e\ncaminhe em dire\u00e7\u00e3o a fronteira \u00e0 direita, como mostra a Figura 6.7.\n\nFigura 6.7: Dire\u00e7\u00e3o de escoamento do fluido do problema (6.2.1).\n\nPara os testes num\u00e9ricos usamos os mesmos tr\u00eas tipos de fun\u00e7\u00f5es de permeabilidade absoluta\ndefinidas na se\u00e7\u00e3o anterior: homog\u00eanea, tipo barreiras e aleat\u00f3ria, com os mesmos valores.\n\nConsideramos como escala de discretiza\u00e7\u00e3o os valores ? = 512, 1024 e 2048. O tamanho do\ndom\u00ednio foi definido como ?? = ?? = 512m. Continuamos com o m\u00e9todo red-black Gauss-Seidel\nsim\u00e9trico (ver, Se\u00e7\u00e3o 5.4.2) como smoother com ? = 3?/2, considerando tempo computacional\ne n\u00famero de itera\u00e7\u00f5es. Novamente, tivemos que aumentar esse valor no caso do problema com\npermeabilidade tipo barreiras. O fator de escala entre malhas foi fixado em 4, a toler\u00e2ncia em\n? = 10?07, e fixamos a quantidade de n\u00edveis em 4.\n\nNa Figura 6.8 temos os gr\u00e1ficos da press\u00e3o e do campo de velocidades do problema (6.2.1)\ncom permeabilidade homog\u00eanea, com barreiras e heterog\u00eanea com ? = 2. O escoamento do fluido\nocorre da esquerda para a direita em todos os casos, como esperado, e n\u00e3o h\u00e1 passagem de fluido\nnas fronteiras acima e abaixo. Como nos experimentos anteriores, no problema com permeabilidade\ndo tipo barreiras o fluido percorre o meio desviando das colunas com permeabilidade diferente.\nPouco fluido passa nas colunas, e quando passa possui uma velocidade bem menor do que no resto\ndo dom\u00ednio. Podemos tamb\u00e9m ver que na fronteira \u00e0 esquerda o fluido entra no meio poroso com\numa certa inclina\u00e7\u00e3o. Isso se deve ao fato de termos, nessa fronteira, uma condi\u00e7\u00e3o imposta pelo\nfluxo. Para o problema com permeabilidade heterog\u00eanea, usamos uma matriz de permeabilidade\nabsoluta gerada com os par\u00e2metros ? = 2 e ?0 = 1, com a mesma fun\u00e7\u00e3o ?(x) gerada para os\nexperimentos anteriores. A dire\u00e7\u00e3o do fluido nesse caso varia constantemente por causa da varia\u00e7\u00e3o\nda permeabilidade do meio poroso. Globalmente, podemos ver no gr\u00e1fico que o fluxo percorre o\ncaminho da esquerda para a direita, em concord\u00e2ncia com o caso com permeabilidade homog\u00eanea.\n\nAnalisando a Tabela 6.3 e a Tabela 6.3 vemos que no n\u00edvel mais fino foi necess\u00e1rio 3 itera\u00e7\u00f5es\npara o m\u00e9todo multiescala convergir no caso homog\u00eaneo, 5 para o caso com barreiras e 10, 7 e 5 para\nas dimens\u00f5es 512, 1024 e 2048, respectivamente para o caso heterog\u00eaneo. E o res\u00edduo normalizado\n\n68\n\n\n\nPermeabilidade homog\u00eanea:\n512 1024 2048\n\nN\u00edvel Dim Itera\u00e7\u00f5es Dim Itera\u00e7\u00f5es Dim Itera\u00e7\u00f5es\n1 8 \u00d7 8 21 16 \u00d7 16 19 32 \u00d7 32 19\n2 32 \u00d7 32 11 64 \u00d7 64 10 128 \u00d7 128 10\n3 128 \u00d7 128 6 256 \u00d7 256 5 512 \u00d7 512 5\n4 512 \u00d7 512 3 1024 \u00d7 1024 3 2048 \u00d7 2048 3\n\nPermeabilidade com barreiras:\n512 1024\n\nN\u00edvel Dim Itera\u00e7\u00f5es Dim Itera\u00e7\u00f5es\n1 8 \u00d7 8 39 16 \u00d7 16 1871\n2 32 \u00d7 32 21 64 \u00d7 64 22\n3 128 \u00d7 128 12 256 \u00d7 256 13\n4 512 \u00d7 512 5 1024 \u00d7 1024 5\n\nPermeabilidade heterog\u00eanea com ? = 2:\n512 1024 2048\n\nN\u00edvel Dim Itera\u00e7\u00f5es Dim Itera\u00e7\u00f5es Dim Itera\u00e7\u00f5es\n1 8 \u00d7 8 71 16 \u00d7 16 77 32 \u00d7 32 66\n2 32 \u00d7 32 37 64 \u00d7 64 42 128 \u00d7 128 41\n3 128 \u00d7 128 23 256 \u00d7 256 27 512 \u00d7 512 19\n4 512 \u00d7 512 10 1024 \u00d7 1024 7 2048 \u00d7 2048 5\n\nTabela 6.3: Itera\u00e7\u00f5es acumuladas por n\u00edvel para o problema (6.2.1) com permeabilidade homog\u00eanea,\ncom barreiras e heterog\u00eanea com ? = 2. A tabela mostra o n\u00famero de itera\u00e7\u00f5es por n\u00edvel do\nproblema com dimens\u00f5es 512 \u00d7 512, 1024 \u00d7 1024 e 2048 \u00d7 2048 .\n\nfoi reduzido em pelo menos 10?08 em todos os problemas com diferentes permeabilidades.\nNo caso com permeabilidadedo tipo barreiras, novamente tivemos que aumentar o valor de ?\n\npara obter converg\u00eancia, no sentido de que n\u00e3o atingisse o n\u00famero m\u00e1ximo de itera\u00e7\u00f5es estabele-\ncido, dado pelo n\u00famero total de elementos. Portanto usamos novamente ? = 5?/2. No entando,\nn\u00e3o conseguimos converg\u00eancia no sentido descrito acima para o problema de dimens\u00e3o 1024. Au-\nmentamos ? para 4? e ainda assim n\u00e3o conseguimos converg\u00eancia. Podemos ver na Tabela 6.4\nque no n\u00edvel mais grosso tivemos 1871 itera\u00e7\u00f5es, mil vezes mais que o n\u00famero de itera\u00e7\u00f5es dos\nn\u00edveis anteriores, e do mesmo n\u00edvel do problema de dimens\u00e3o 512 \u00d7 512. Isso mostra que algumas\ndas passagens do gradientes conjugados naquele n\u00edvel alcan\u00e7aram o n\u00famero m\u00e1ximo de itera\u00e7\u00f5es.\nMais precisamente, 10 das passagens do gradientes conjugados n\u00e3o convergiram nesse n\u00edvel para\n? = 4? . Uma maneira de corrigir esse problema seria aumentar ? ainda mais. Por\u00e9m, devido ao\ngrande tempo computacional n\u00e3o testamos esse problema para ? > 4? .\n\nO tempo computacional aumentou consideravelmente em cada dimens\u00e3o. Foi de menos de\n10 minutos para os problemas com dimens\u00e3o 512, sendo o mais r\u00e1pido o caso homog\u00eaneo com 3\nminutos, para at\u00e9 quse 5 horas para os problemas com dimens\u00e3o 2048, sendo o mais demorado o\ncaso onde temos permeabilidade heterog\u00eanea.\n\n69\n\n\n\n 0\n\n 0.125\n\n 0.25\n\n 0.375\n\n 0.5\n\n 0.625\n\n 0.75\n\n 0.875\n\n 1\n\n 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1\n\ny\n\nx\n\n 0\n\n 0.125\n\n 0.25\n\n 0.375\n\n 0.5\n\n 0.625\n\n 0.75\n\n 0.875\n\n 1\n\n 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1\n\ny\n\nx\n\n 0\n\n 0.125\n\n 0.25\n\n 0.375\n\n 0.5\n\n 0.625\n\n 0.75\n\n 0.875\n\n 1\n\n 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1\n\ny\n\nx\n\nFigura 6.8: Gr\u00e1ficos da press\u00e3o e do campo de velocidades para o problema (6.2.1) com permeabi-\nlidade homog\u00eanea, com barreiras e heterog\u00eanea com ? = 2. .\n\n70\n\n\n\nPermeabilidade homog\u00eanea:\nDim ? Tempo (min) ?r?2 ?r?? ?r?2/\n\n?\n??\n\n512 1.00 2.50 1.77109e-06 7.32431e-08 1.09388e-08\n1024 0.50 21.03 1.56631e-06 4.57239e-08 4.83701e-09\n2048 0.25 227.30 1.18678e-06 2.44318e-08 1.83249e-09\n\nPermeabilidade com barreiras:\nDim ? Tempo (min) ?r?2 ?r?? ?r?2/\n\n?\n??\n\n512 1.0 7.64 2.75814e-06 5.93989e-08 1.70352e-08\n1024 0.5 92.33 7.83335e-07 2.33695e-08 2.41906e-09\n\nPermeabilidade heterog\u00eanea com ? = 2:\nDim ? Tempo (min) ?r?2 ?r?? ?r?2/\n\n?\n??\n\n512 1.00 7.10 5.14147e-06 7.9038e-07 3.17554e-08\n1024 0.50 47.53 2.28301e-05 5.34859e-06 7.05031e-08\n2048 0.25 281.90 5.65836e-05 1.0347e-06 8.73697e-08\n\nTabela 6.4: Informa\u00e7\u00f5es gerais para o problema (6.2.1) com permeabilidade homog\u00eanea, com bar-\nreiras e heterog\u00eanea com ? = 2. A tabela mostra a norma do res\u00edduo da aproxima\u00e7\u00e3o e tempos\ncomputacionais. ?? \u00e9 o n\u00famero total de elementos.\n\n6.3 Geometria 1/4 de five-spot\nO problema de Poison bidimensional escolhido para este experimento \u00e9 dado por:\n\n? \u00b7 u = ? (x), u = ??(x)??(x), x ? ? = [0, ??] \u00d7 [0, ??] ? R2,??\n? (x)?? = 0,\n\nu(0, ?) = 0, u(??, ?) = 0, ?? ? [0, ??],\nu(?, 0) = 0, u(?, ??) = 0, ?? ? [0, ??].\n\n(6.3.1)\n\nO problema \u00e9 definido em um dom\u00ednio retangular e n\u00e3o h\u00e1 fluxo em nenhuma das fronteiras.\nA fun\u00e7\u00e3o de fonte ? (x) \u00e9 definida como\n\n? (x) =\n\n???\n??\n\n10?07, no canto inferior esquerdo,\n?10?07, no canto superior direito,\n\n0, caso contr\u00e1rio,\n\nde modo que a condi\u00e7\u00e3o de compatibilidade\n??\n\n? ? (x)?? = 0 seja satisfeita. As condi\u00e7\u00f5es do\nproblema est\u00e3o melhor ilustradas na Figura 6.9.\n\nO problema (6.3.1), em conjunto a condi\u00e7\u00e3o de compatibilidade, \u00e9 unicamente determinado\n(bem posto). Esperamos que o fluido entre pela extremidade inferior e caminhe em dire\u00e7\u00e3o ao\nponto de produ\u00e7\u00e3o no canto superior.\n\nPara os testes num\u00e9ricos consideramos as mesmas fun\u00e7\u00f5es de permeabilidade absoluta usadas\nnos problemas anteriores. Aplicamos nosso algoritmo multiescala no problema (6.3.1) para ? =\n\n71\n\n\n\nFigura 6.9: Dom\u00ednio retangular do problema (6.3.1) demonstrando as condi\u00e7\u00f5es de contorno.\n\nFigura 6.10: Dire\u00e7\u00e3o de escoamento do fluido do problema (6.3.1).\n\n512, 1024, 2048, com ?? = ?? = 512m. Usamos o mesmo smoother dos experimentos anteriores\ncom ? = 3?/2. O fator de escala entre malhas foi fixado em 4, a toler\u00e2ncia em ? = 10?07, e 4\nn\u00edveis de malha.\n\nA Figura 6.11 mostra lado a lado os gr\u00e1ficos de press\u00e3o e do campo de velocidades obtidos\npelo m\u00e9todo multiescala para o problema (6.3.1) com permeabilidades homog\u00eanea, com barreiras e\nheterog\u00eanea. Nos gr\u00e1ficos de fluxo podemos ver a dire\u00e7\u00e3o de escoamento do fluido, que \u201ccaminha\u201d\nem dire\u00e7\u00e3o o ponto de produ\u00e7\u00e3o no canto superior. No caso heterog\u00eaneo, o fluido sofre diversos\ndesvios devido a variabilidade da permeabilidade do meio, como nos experimentos anteriores. Os\npar\u00e2metros para construir a permeabilidade heterog\u00eanea foram novamente ? = 2, ?0 = 1, com a\nmesma fun\u00e7\u00e3o ?(x) dos experimentos anteriores.\n\n72\n\n\n\nPermeabilidade homog\u00eanea:\n512 1024 2048\n\nN\u00edvel Dim Itera\u00e7\u00f5es Dim Itera\u00e7\u00f5es Dim Itera\u00e7\u00f5es\n1 8 \u00d7 8 8 16 \u00d7 16 8 32 \u00d7 32 8\n2 32 \u00d7 32 4 64 \u00d7 64 4 128 \u00d7 128 4\n3 128 \u00d7 128 2 256 \u00d7 256 2 512 \u00d7 512 2\n4 512 \u00d7 512 1 1024 \u00d7 1024 1 2048 \u00d7 2048 1\n\nPermeabilidade heterog\u00eanea com ? = 2:\n512 1024 2048\n\nN\u00edvel Dim Itera\u00e7\u00f5es Dim Itera\u00e7\u00f5es Dim Itera\u00e7\u00f5es\n1 8 \u00d7 8 43 16 \u00d7 16 41 32 \u00d7 32 41\n2 32 \u00d7 32 4 64 \u00d7 64 4 128 \u00d7 128 4\n3 128 \u00d7 128 2 256 \u00d7 256 2 512 \u00d7 512 2\n4 512 \u00d7 512 1 1024 \u00d7 1024 1 2048 \u00d7 2048 1\n\nTabela 6.5: Itera\u00e7\u00f5es acumuladas por n\u00edvel para o problema (6.3.1) com permeabilidade homog\u00eanea\ne heterog\u00eanea com ? = 2. A tabela mostra o n\u00famero de itera\u00e7\u00f5es por n\u00edvel do problema com\ndimens\u00f5es 512 \u00d7 512, 1024 \u00d7 1024 e 2048 \u00d7 2048 .\n\nNa Tabela 6.5 temos o n\u00famero acumulado de itera\u00e7\u00e3o por n\u00edvel. Podemos ver que foi neces-\ns\u00e1rio somente 1 itera\u00e7\u00e3o no n\u00edvel mais fino para o algoritmo convergir para todas as dimens\u00f5es\nconsideradas no caso homog\u00eaneo e no caso heterog\u00eaneo.\n\nA norma do res\u00edduo normalizado foi reduzida em pelo menos 10?12 no problema com permeabi-\nlidade homog\u00eanea, e pelo menos 10?10 no caso heterog\u00eaneo. O tempo computacional neste caso foi\nbem menor do que nos outros experimentos com permeabilidade heterog\u00eanea. O tempo se apro-\nximou do tempo obtido nos casos em que a permeabilidade \u00e9 constante. Uma poss\u00edvel explica\u00e7\u00e3o\npara o menor tempo pode ser encontrada no fato de que para esse problema consideramos condi\u00e7\u00f5es\nde contorno homog\u00eaneas. Como visto no Cap\u00edtulo 5, problemas com condi\u00e7\u00f5es de contorno n\u00e3o\nhomog\u00eaneas precisam de um maior esfor\u00e7o do smoother para acomodar os high frequency modes.\nMas com condi\u00e7\u00f5es de contorno nulas esse problema \u00e9 resolvido e o m\u00e9todo converge em menos\nitera\u00e7\u00f5es, e portanto diminuindo o tempo computacional. Podemos ver tamb\u00e9m que o tempo n\u00e3o\n\u00e9 afetado pelo fato de que no n\u00edvel mais grosso foi necess\u00e1rio aproximadamente 41 itera\u00e7\u00f5es no\ncaso heterog\u00eaneo, muito mais que nos n\u00edveis mais finos. Isso ocorre pois o sistema linear resolvido\nnaquele n\u00edvel tem uma dimens\u00e3o muito menor comparado com o sistema do n\u00edvel mais fino. O\nmaior sistema linear resolvido no n\u00edvel mais grosso \u00e9 32 \u00d7 32, ou seja, 1024 elementos. Isso \u00e9 0.02%\nda quantidade de elementos do n\u00edvel mais fino. Dessa forma, o custo computacional de resolver o\nsistema linear no n\u00edvel mais grosso \u00e9 quase que negligenci\u00e1vel. Esse resultado mostra que o maior\nesfor\u00e7o computacional do m\u00e9todo multiescala est\u00e1 concentrado no n\u00edvel mais fino.\n\n73\n\n\n\n 0\n\n 0.125\n\n 0.25\n\n 0.375\n\n 0.5\n\n 0.625\n\n 0.75\n\n 0.875\n\n 1\n\n 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1\n\ny\n\nx\n\n 0\n\n 0.125\n\n 0.25\n\n 0.375\n\n 0.5\n\n 0.625\n\n 0.75\n\n 0.875\n\n 1\n\n 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1\n\ny\n\nx\n\nFigura 6.11: Gr\u00e1ficos da press\u00e3o e do campo de velocidades para o problema (6.3.1) com permea-\nbilidade homog\u00eanea e heterog\u00eanea com ? = 2. .\n\nPermeabilidade homog\u00eanea:\nDim ? Tempo (min) ?r?2 ?r?? ?r?2/\n\n?\n??\n\n512 1.00 1.24 4.18866e-10 2.95716e-10 2.58705e-12\n1024 0.50 10.29 3.08826e-10 2.18227e-10 9.53706e-13\n2048 0.25 85.49 2.26141e-10 1.59861e-10 3.4918e-13\n\nPermeabilidade heterog\u00eanea com ? = 2:\nDim ? Tempo (min) ?r?2 ?r?? ?r?2/\n\n?\n??\n\n512 1.00 1.22 2.15329e-08 1.49262e-08 1.32994e-10\n1024 0.50 9.74 6.89399e-09 3.78218e-09 2.12898e-11\n2048 0.25 80.78 2.71593e-09 1.83088e-09 4.19361e-12\n\nTabela 6.6: Informa\u00e7\u00f5es gerais para o problema (6.3.1) com permeabilidade homog\u00eanea, com bar-\nreiras e heterog\u00eanea com ? = 2. A tabela mostra a norma do res\u00edduo da aproxima\u00e7\u00e3o e tempos\ncomputacionais. ?? \u00e9 o n\u00famero total de elementos.\n\nAnalisando todos os experimentos realizados vemos que o m\u00e9todo multiescala necessitou, em\n\n74\n\n\n\ntodos os problemas, de muito poucas itera\u00e7\u00f5es para convergir em cada n\u00edvel, comparado com o\nn\u00famero de elementos da malha. O n\u00edvel referente a malha mais fina foi o que precisou de menos\nitera\u00e7\u00f5es. Esse resultado est\u00e1 de acordo com o que foi encontrado por K. Lackner e R. Menikoff\n[115]. Os n\u00edveis subsequentes precisaram de mais itera\u00e7\u00f5es, no entanto o esfor\u00e7o computacional \u00e9\nmenor devido a redu\u00e7\u00e3o da dimens\u00e3o do problema nesses n\u00edveis.\n\nOs experimentos com melhores resultados de itera\u00e7\u00f5es e tempo foram os problemas com geome-\ntria slab e condi\u00e7\u00f5es de contorno de Dirichlet-Direchlet, e problemas com geometria 1/4 five-spot.\nNo artigo de K. Lackner e R. Menikoff [115], os autores se concentraram em problemas de com\ncondi\u00e7\u00f5es de contorno de Dirichlet-Direchlet, tipo slab. Dessa forma, os nossos experimentos est\u00e3o\nde acordo com os resultados encontrados em [115]. Os experimentos com 1/4 five-spot tamb\u00e9m\ntiveram bons resultados, sen\u00e3o melhores que o slab, devido ao uso de condi\u00e7\u00f5es de contorno ho-\nmog\u00eaneas.\n\nO tempo computacional foi um grande limitante para um maior aprofundamento da an\u00e1lise\ncomputacional do algoritmo multiescala. Experimentos com problemas de dimens\u00f5es maiores que\n2048 foram invi\u00e1veis nesse momento devido ao alto tempo de simula\u00e7\u00e3o na m\u00e1quina utilizada. Um\nmaior estudo \u00e9 necess\u00e1rio para avaliar o comportamento do algoritmo com rela\u00e7\u00e3o aos par\u00e2metros\nde toler\u00e2ncia, n\u00edveis de malha e itera\u00e7\u00f5es do smoother.\n\nUm desafio foi rodar todos os experimentos em um laptop b\u00e1sico, j\u00e1 que uma motiva\u00e7\u00e3o desse\ntrabalho \u00e9 o aumento da efici\u00eancia computacional, a partir de uma melhor compreens\u00e3o matem\u00e1tica\ndo m\u00e9todo e n\u00e3o apenas com o uso de uma m\u00e1quina computadora especializada.\n\n75\n\n\n\n76\n\n\n\nCap\u00edtulo 7\n\nConclus\u00f5es e Perspectivas\n\n7.1 Conclus\u00f5es\nFoi realizada a implementa\u00e7\u00e3o computacional de um m\u00e9todo num\u00e9rico, recentemente introdu-\n\nzido na literatura, para a aproxima\u00e7\u00e3o de EDPs el\u00edpticas no contexto de din\u00e2mica de fluidos em\nmeios porosos heterog\u00eaneos. Esperamos, neste trabalho, ter justificado a escolha do m\u00e9todo dos\ngradientes conjugados multiescala recursivo [115] para a resolu\u00e7\u00e3o do sistema linear proveniente\nda discretiza\u00e7\u00e3o por elementos finitos mistos h\u00edbridos do problema de valor de contorno de Poisson\nassociado ao sistema de press\u00e3o-velocidade. Para isso, fizemos uma breve revis\u00e3o da literatura\nsobre as diversas aplica\u00e7\u00f5es do sistema de EDPs que governam o transporte de fluidos em meios\nporosos e procuramos motivar e indicar a import\u00e2ncia do tratamento de equa\u00e7\u00f5es el\u00edpticas mos-\ntrando sua frequente presen\u00e7a na modelagem matem\u00e1tica e computacional de diversos problemas\nde transporte de fluidos em meios porosos. Nesse contexto, a resolu\u00e7\u00e3o de problemas de Poisson\nenvolve a maior parte de todos os c\u00e1lculos envolvidos na aproxima\u00e7\u00e3o desses problemas [8, 4, 7].\nAssim, h\u00e1 a necessidade de m\u00e9todos robustos e computacionalmente eficientes para a resolu\u00e7\u00e3o\nnum\u00e9rica de problemas de natureza el\u00edptica.\n\nVale ressaltar que problemas de Poisson surgem naturalmente na modelagem de problemas de\nescoamento com tr\u00eas e duas fases, onde suas equa\u00e7\u00f5es governantes s\u00e3o compostas por um sistema\nde transporte de satura\u00e7\u00f5es, acoplado a um problema de press\u00e3o-velocidade de natureza el\u00edptica\n(ver, Cap. 2). Em seguida, usamos uma t\u00e9cnica de decomposi\u00e7\u00e3o de operadores de modo a separar\na resolu\u00e7\u00e3o das equa\u00e7\u00f5es de press\u00e3o-velocidade das equa\u00e7\u00f5es de transporte de fluidos. Por fim,\nconseguimos \u201cisolar\u201d a aproxima\u00e7\u00e3o da EDP el\u00edptica (ver, Cap 3). Usamos ent\u00e3o, um m\u00e9todo de\nelementos finitos mistos h\u00edbridos para discretizar as equa\u00e7\u00f5es de press\u00e3o-velocidade recaindo em\num sistema linear sim\u00e9trico definido positivo e esparso (ver, Cap 4).\n\nAnalisando todo o contexto em que se insere esse sistema linear, como a heteregeneidade do\nmeio poroso e o fato de que esse sistema ser\u00e1 resolvido em conjunto a um problema de evolu\u00e7\u00e3o no\ntempo, escolhemos um m\u00e9todo recentemente introduzido por Klaus Lackner e Ralph Menikoff no\nartigo \u201cMultiscale Linear Solvers for Very Large Systems Derived from PDES\u201d, publicado em SIAM\nJournal on Scientific Computing, 2000 [115]. Esse m\u00e9todo combina gradientes conjugados com um\npr\u00e9-condicionador multiescala que satisfaz todos os nossos pr\u00e9-requisitos, levando em considera\u00e7\u00e3o\na natureza f\u00edsica do problema a ser resolvido. Dessa forma, esperamos que esse m\u00e9todo resolva\n\n77\n\n\n\neficientemente o sistema linear em um n\u00famero pequeno de itera\u00e7\u00f5es no contexto de problemas de\ntransporte de fluidos.\n\nApresentamos no Cap\u00edtulo 6 diversos experimentos para o problema de press\u00e3o-velocidade com\npermeabilidade heterog\u00eanea, de forma a reproduzir o car\u00e1ter multiescala do meio poroso. O m\u00e9todo\nmultiescala obteve boas solu\u00e7\u00f5es num\u00e9ricas para distintos problemas de Poisson em din\u00e2mica de\nfluidos com meios homog\u00eaneos e heterog\u00eaneos em duas dimens\u00f5es, mostrando a viabilidade do\nm\u00e9todo proposto. Foi poss\u00edvel ver que o m\u00e9todo necessitou de poucas itera\u00e7\u00f5es em todos os casos.\nForam menos de 0.02% do total de elementos do problema na malha mais fina. E esse n\u00famero se\nmanteve mesmo mudando as condi\u00e7\u00f5es de contorno. Tal resultado \u00e9 compat\u00edvel com os encontrados\npor K. Lackner e R. Menikoff em [115].\n\nNas malhas mais grossas, o n\u00famero acumulado de itera\u00e7\u00f5es \u00e9 maior que na malha fina, por\u00e9m a\nraz\u00e3o das itera\u00e7\u00f5es entre malhas diminui conforme engrossamos e refinamos a malha (diminuimos\no espa\u00e7amento). O esfor\u00e7o computacional em cada n\u00edvel \u00e9 proporcional ao n\u00famero de itera\u00e7\u00f5es\ndesse n\u00edvel vezes a dimens\u00e3o do n\u00edvel. Assim, mesmo com o maior n\u00famero de itera\u00e7\u00f5es nos n\u00edveis\ngrossos, o esfor\u00e7o computacional total \u00e9 dominado pelo n\u00edvel mais fino.\n\nO tempo de computa\u00e7\u00e3o foi maior que o esperado. Isso se deve ao n\u00famero grande de itera\u00e7\u00f5es do\nsmoother, causado pela dif\u00edcil escalabilidade das condi\u00e7\u00f5es de contorno (ver, Cap. 5). Esperamos\nque o uso de smoothers e implementa\u00e7\u00f5es mais eficientes resolva esse problema.\n\n7.2 Perspectivas\nO pr\u00f3ximo passo no estudo desse algoritmo \u00e9 reduzir o tempo computacional. Para termos uma\n\nideia de como o tempo do algoritmo se comporta, resolvemos apenas um problema de geometria\nSlab com permeabilidade heterog\u00eanea (? = 2) e dimens\u00e3o 1024 \u00d7 1024 em uma m\u00e1quina com-\nputadora mais potente. Esse tipo de problema levou cerca de 50 minutos para ser resolvido pela\nm\u00e1quina utilizada para os experimentos deste trabalho. Na m\u00e1quina mais potente, esse tempo caiu\npara 18 minutos com o uso do compilador gcc. O tempo computacional foi reduzido ainda mais,\npara cerca de 12 minutos ao usarmos um compilador intel. Foi um ganho de aproximadamente\n76% do tempo computacional de uma m\u00e1quina para outra, e aproximadamente 33% de ganho em\numa mesma m\u00e1quina mas com compiladores diferentes.\n\nUma poss\u00edvel modifica\u00e7\u00e3o da implementa\u00e7\u00e3o do pr\u00e9-condicionador multiescala recursivo est\u00e1\nem andamento e esperamos implement\u00e1-la futuramente. Em colobora\u00e7\u00e3o com o Professor Doutor\nTomihiro Sogabe 1, conseguimos obter uma forma mais eficiente de calcular o smoother, reduzindo\no n\u00famero de opera\u00e7\u00f5es. Basicamente, fazemos uma mudan\u00e7a no c\u00e1lculo do pr\u00e9 e p\u00f3s smoothers.\n\nConsidere o precondicionador multiescala multigrid (5.2.16) apresentado no Cap\u00edtulo 5, dado\npela equa\u00e7\u00e3o\n\nM?1 = (P?1Q)? ?A?1? ?(QP\n?1)? +\n\n2??1??\n?=0\n\nH?P?1. (7.2.1)\n\n1Professor associado em Graduate School of Information Science &amp; Technology Aichi Prefectural University,\nJapan.\n\n78\n\n\n\nA modifica\u00e7\u00e3o \u00e9 dada da seguinte maneira: considere o sistema linear discreto A? = ? obtido\nda discretiza\u00e7\u00e3o por elementos finitos mistos do problema de press\u00e3o-velocidade, como feito no\nCap\u00edtulo 4. A aplica\u00e7\u00e3o do pr\u00e9-condicionador (7.2.1) em um vetor ? = M?1? ser\u00e1 feita em uma\nordem diferente, dada pelo seguinte algoritmo:\n\nAlgoritmo 7.1 : Implementa\u00e7\u00e3o modificada do pr\u00e9-condicionador multiescala.\nSeja ? = M?1?.\nResolva P? = ?;\nfor ? = 0, 1, . . . , ? ? 1 do\n\n? = P?1Q? + ?;\nend for\n? = (P?1Q)? [? + ?A??(? ? A?)] + ?;\n\nNo nosso algoritmo atual, o n\u00famero de opera\u00e7\u00f5es da multiplica\u00e7\u00e3o (P?1Q)-vetor \u00e9 da ordem\nde 4?. Com a modifica\u00e7\u00e3o, esse n\u00famero reduz para 2?. O Algoritmo 7.1 obtem esse resultado\ncalculando os termos referentes ao smoother de uma maneira diferente. Esperamos que essa imple-\nmenta\u00e7\u00e3o resulte na redu\u00e7\u00e3o do tempo computacional devido \u00e0 diminui\u00e7\u00e3o do n\u00famero de opera\u00e7\u00f5es.\n\nEsperamos futuramente tamb\u00e9m explorar programa\u00e7\u00e3o em paralelo para reduzir o tempo. Pre-\ntendemos usar a estrat\u00e9gia OpenMP [4], em conjunto ao algoritmo apresentado neste trabalho e\ntamb\u00e9m \u00e0 poss\u00edvel modifica\u00e7\u00e3o vista nos par\u00e1grafos anteriores. Nossa inten\u00e7\u00e3o \u00e9 continuar rodando\no algoritmo em um laptop b\u00e1sico.\n\nUma outra estrat\u00e9gia para a redu\u00e7\u00e3o do tempo computacional seria aplicar diferentes opera-\ndores de restri\u00e7\u00e3o e de prolonga\u00e7\u00e3o. Vimos, com base nos experimentos num\u00e9ricos, que o pr\u00e9-\ncondicionamento multiescala recursivo \u00e9 fortemente baseado nas estrat\u00e9gias de defini\u00e7\u00e3o dos ope-\nradores de restri\u00e7\u00e3o e prolonga\u00e7\u00e3o. Tais operadores de aproxima\u00e7\u00e3o est\u00e3o naturalmente associadas\nao procedimento de discretiza\u00e7\u00e3o subjacente. Neste trabalho, escolhemos empregar os operadores\nde restri\u00e7\u00e3o e de prolonga\u00e7\u00e3o especificamente com respeito \u00e0 vari\u00e1vel press\u00e3o, de acordo com o que\nfoi feito no trabalho do Lackner &amp; Menikoff por meio da discretiza\u00e7\u00e3o por diferen\u00e7as finitas. No\nentanto, adotamos neste trabalho uma metodologia de aproxima\u00e7\u00e3o por elementos finitos mistos\nem espa\u00e7os ?(???), onde a press\u00e3o e a velocidade s\u00e3o aproximados simultaneamente. Portanto,\n\u00e9 tamb\u00e9m natural considerar operadores de restri\u00e7\u00e3o e de prolonga\u00e7\u00e3o no contexto de espa\u00e7os\nmistos, de tal forma que a boa propriedade de conserva\u00e7\u00e3o local seja efetiva em conduzir uma boa\naproxima\u00e7\u00e3o e tamb\u00e9m preservando a conserva\u00e7\u00e3o local. Isso tamb\u00e9m constitui uma perspectiva\npara trabalho futuro.\n\n7.3 Considera\u00e7\u00f5es finais\nApresentamos um m\u00e9todo multiescala para a aproxima\u00e7\u00e3o de problemas el\u00edpticos, com foco em\n\nproblemas de press\u00e3o-velocidade que frequentemente aparecem em problemas de escoamentos em\nmeios porosos. A escolha de um algoritmo multiescala \u00e9 motivada pela heterogeneidade intrinsica\ndo meio poroso, demonstrado pela grande variabilidade das propriedades de permeabilidade e\nporosidade das rochas que comp\u00f5e o meio poroso.\n\n79\n\n\n\nAplica\u00e7\u00f5es futuras do m\u00e9todo multiescala recursivo envolvem o acoplamento deste algoritmo\ncom outros m\u00e9todos num\u00e9ricos para resolver os problemas de convec\u00e7\u00e3o e difus\u00e3o, de modo a\nresolver problemas completos de escoamento de fluidos em meios porosos. Nosso pr\u00f3ximo passo \u00e9\naplicar esse m\u00e9todo em problemas bif\u00e1sicos com histerese, como visto no cap\u00edtulo 2.\n\n80\n\n\n\nRefer\u00eancias\n\n[1] E. Abreu. \u201cNumerical simulation of three-phase flow in heterogeneous media with spatially\nvarying nonlinear hyperbolic-parabolic flux functions\u201d. Em: AIMS on Applied Mathematics\nVol.8 Hyperbolic Problems: Theory, Numerics, Applications (2012), pp. 233\u2013240.\n\n[2] E. Abreu. \u201cNumerical modelling of three-phase immiscible flow in heterogeneous porous\nmedia with gravitational effects\u201d. Em: Mathematics and Computers in Simulation 97 (2014),\npp. 234\u2013259.\n\n[3] E. Abreu, A. Alvarez, P. Ferraz e W. Lambert. \u201cA computational multiscale approach for\nincompressible two-phase flow in heterogeneous porous media including relative permeabi-\nlity hysteresis\u201d. Em: International Conference on Approximation Methods and Numerical\nModelling in Environment and Natural Resources MAMERN VI (2015).\n\n[4] E. Abreu e R. Beauclair. \u201cExploiting OpenMP Efficiency for Multiphase Flow Simula-\ntion in Heterogeneous Porous Media\u201d. Em: 30? Iberian-Latin-American Congress on Comp.\nMethods in Engineering (2012), p. 18.\n\n[5] E. Abreu e D. Concei\u00e7\u00e3o. \u201cNumerical Coupling of Multiphysics Flows in Porous Media\u201d.\nEm: 3rd International Conference on Approximation Methods and Numerical Modelling in\nEnvironment and Natural Resources, Pau (France), June 8-11 1 (2009), pp. 19\u201324.\n\n[6] E. Abreu e D. Concei\u00e7\u00e3o. \u201cNumerical Modeling of Degenerate Equations in Porous Media\nFlow\u201d. Em: Journal of Scientific Computing 55.3 (2013), pp. 688\u2013717.\n\n[7] E. Abreu, J. Douglas, F. Furtado e F. Pereira. \u201cOperator splitting based on physics for\nflow in porous media\u201d. Em: International Journal of Computational Science 2.3 (2008),\npp. 315\u2013335.\n\n[8] E. Abreu, J. Douglas, F. Furtado e F. Pereira. \u201cOperator splitting for three-phase flow in\nheterogeneous porous media\u201d. Em: Communications in Computational Physics 6.1 (2009),\np. 72.\n\n[9] E. Abreu, J. Douglas Jr, F. Furtado, D. Marchesin e F. Pereira. \u201cThree-phase immiscible\ndisplacement in heterogeneous petroleum reservoirs\u201d. Em: Mathematics and computers in\nsimulation 73.1 (2006), pp. 2\u201320.\n\n[10] E. Abreu, F. Furtado e F. Pereira. \u201cOn The Numerical Simulation of Three-phase Flows\nin Heterogeneous Porous Media\u201d. Em: Lecture Notes in Computer Science 4395 (2007),\npp. 504\u2013517.\n\n81\n\n\n\n[11] E. Abreu, F. Furtado, F. Pereira e G. Souza. \u201cNumerical Modeling of Two-phase Flow\nWith Hysteresis in Heterogeneous Porous Media\u201d. Em: Rio Oil &amp; Gas Conference, IBP1685\n(2008), pp. 8\u201315.\n\n[12] E. Abreu e W. Lambert. \u201cComputational modeling technique for numerical simulation of\nimmiscible two-phase flow problems involving flow and transport phenomena in porous\nmedia with hysteresis\u201d. Em: American Institute of Physics 1453 (2012), pp. 141\u2013146.\n\n[13] E. Abreu e F. Pereira. \u201cDesenvolvimento de Novas estrat\u00e9gias Para a Recupera\u00e7\u00e3o Avan\u00e7ada\nde Hidrocarbonetos em Reservat\u00f3rios de Petr\u00f3leo\u201d. Em: Boletim T\u00e9cnico da Produ\u00e7\u00e3o de\nPetr\u00f3leo (PETROBRAS-CENPES) 2 (2007), pp. 83\u2013106.\n\n[14] E. Abreu, F. Pereira e S. Ribeiro. \u201cCentral schemes for porous media flows\u201d. Em: Compu-\ntational &amp; Applied Mathematics 28.1 (2009), pp. 87\u2013110.\n\n[15] P. Ackerer, G. Chavent, M. Quintard, R. di C. Roupert e G. Sch\u00e4fer. \u201cConstruction of\nthree-phase data to model multiphase flow in porous media: Comparing an optimization\napproach to the finite element approach\u201d. Em: Comptes Rendus Geoscience 342 (2010),\npp. 855\u2013863.\n\n[16] M. Ahmadi. \u201cDevelopment of a higher-order finite volume method for simulation of thermal\noil recovery process using moving mesh strategy\u201d. Em: Society of Petroleum Engineers\n(2008), pp. 37\u201357.\n\n[17] C. Almeida, J. Douglas Jr e F. Pereira. \u201cA new characteristics-based numerical method\nfor miscible displacement in heterogeneous formations\u201d. Em: Computational and Applied\nMathematics 21 (2002), pp. 573\u2013605.\n\n[18] C. Almeida, J. Douglas Jr, F. Pereira, L. C. Roman e L. M. Yeh. \u201cAlgorithmic Aspects of\na Locally Conservative Eulerian-Lagrangian Method for Transport-Dominated Fluid Flow\nand Transport in Porous Media\u201d. Em: Mathematical and Numerical Treatment: Proceedings\nof an AMS-IMS-SIAM Joint Summer Research Conference on Fluid Flow and Transport in\nPorous Media, Mathematical and Numerical Treatment, June 17-21, 2001, Mount Holyoke\nCollege, South Hadley, Massachusetts. Vol. 295. American Mathematical Soc. 2002, p. 37.\n\n[19] P.R. Amestoy, I.S. Duff, J. Koster e J-Y. L\u2019Excellent. \u201cA fully asynchronous multifrontal\nsolver using distributed dynamic scheduling\u201d. Em: SIAM Journal on Matrix Analysis and\nApplications 23.1 (2001), pp. 15\u201341.\n\n[20] M.P. Anderson e H. Wang. Introduction to Groundwater Modeling: Finite Difference and\nFinite Element Methods. Academic Press, 1982.\n\n[21] J. Aquino, H. P. Amaral Souto, A. S. Francisco, T. Jordem Pereira e F. Pereira. \u201cA La-\ngrangian strategy for the numerical simulation of radionuclide transport problems\u201d. Em:\nProgress in Nuclear Energy 52.3 (2010), pp. 282\u2013291.\n\n[22] J. Aquino, H. P. Amaral Souto, A. S. Francisco e F. Pereira. \u201cOn the stric hypebolicity of\nthe Buckley-Leverett equations for three-phase flow in a porous medium\u201d. Em: An overview\nof Euleriane-Lagrangian schemes applied to radionuclide transport in unsaturated porous\nmedia 50 (2008), pp. 774\u2013787.\n\n82\n\n\n\n[23] D.N. Arnold, F. Brezzi, B. Cockburn e L. D. Marini. \u201cUnified analysis of discontinuous\nGalerkin methods for elliptic problems\u201d. Em: SIAM journal on numerical analysis 39.5\n(2002), pp. 1749\u20131779.\n\n[24] V. Artus, F. Furtado, B. Noetinger e F. Pereira. \u201cStochastic analysis of two-phase immis-\ncible flow in stratified porous media\u201d. Em: Computational and Applied Mathematics 23.2-3\n(2004), pp. 153\u2013172.\n\n[25] S.F. Ashby e R.D. Falgout. \u201cA parallel multigrid preconditioned conjugate gradient algo-\nrithm for groundwater flow simulations\u201d. Em: Nuclear science and engineering 124.1 (1996),\npp. 145\u2013159.\n\n[26] I. Babuvska, U. Banerjee e J.E. Osborn. \u201cGeneralized finite element methods\u2014main ideas,\nresults and perspective\u201d. Em: International Journal of Computational Methods 1.01 (2004),\npp. 64\u2013103.\n\n[27] P. Bedrikovetsky, P. Krause, D. Marchesin e B. Plohr. \u201cModeling hysteresis in porous media\nflow via relaxation\u201d. Em: Computational Geosciences 5.3 (2001), pp. 225\u2013256.\n\n[28] N. Bellomo, F. Brezzi e G. Manzini. \u201cRecent techniques for PDE discretizations on polyhe-\ndral meshes\u201d. Em: Mathematical Models and Methods in Applied Sciences 24.8 (2014),\npp. 1453\u20131455.\n\n[29] S. M. Benson, S. Krevor e R. Pini. \u201cCapillary pressure and heterogeneity for the CO2 water\nsystem in sandstone rocks at reservoir conditions\u201d. Em: Advances in Water Resources 38\n(2012), pp. 48\u201359.\n\n[30] M. Benzi, G.H. Golub e J. Liesen. \u201cNumerical solution of saddle point problems\u201d. Em: Acta\nnumerica 14 (2005), pp. 1\u2013137.\n\n[31] I. Berre, H.K. Dahle, K.H. Karlsen e H.F. Nordhaug. \u201cA streamline front tracking method\nfor two-and three-phase flow including capillary forces\u201d. Em: Contemporary Mathematics\n295 (2002), pp. 49\u201362.\n\n[32] J. G. Blom e J. G. Verwer. \u201cA comparison of integration methods for atmospheric transport-\nchemistry problems\u201d. Em: Journal of computational and Applied Mathematics 126.1 (2000),\npp. 381\u2013396.\n\n[33] M.J. Blunt e M.D. Jackson. \u201cElliptic regions and stable solutions for three-phase flow in\nporous media\u201d. Em: Transport in porous media 48.3 (2002), pp. 249\u2013269.\n\n[34] M.R. Borges, F. Furtado, F. Pereira e H.P.A. Souto. \u201cScaling analysis for the tracer flow pro-\nblem in self-similar permeability fields\u201d. Em: Multiscale Modeling &amp; Simulation 7.3 (2008),\npp. 1130\u20131147.\n\n[35] M. A. Botchev e J. G. Verwer. \u201cA new approximate matrix factorization for implicit time\nintegration in air pollution modeling\u201d. Em: Journal of computational and applied mathe-\nmatics 157.2 (2003), pp. 309\u2013327.\n\n[36] A. Brandt. \u201cMulti-level adaptive solutions to boundary-value problems\u201d. Em: Mathematics\nof computation 31.138 (1977), pp. 333\u2013390.\n\n83\n\n\n\n[37] A. Brandt e O. E. Livne. Multigrid Techniques: 1984 Guide with Applications to Fluid Dy-\nnamics, Revised Edition. Classics in Applied Mathematics. Society for Industrial e Applied\nMathematics, 2011. isbn: 9781611970746. url: http://books.google.com.br/books?\nid=EvClMX03MyAC.\n\n[38] S. C. Brenner, H. Li e L. Y. Sung. \u201cMultigrid methods for saddle point problems: Stokes\nand Lam\u00e9 systems\u201d. Em: Numerische Mathematik 128.2 (2014), pp. 193\u2013216.\n\n[39] S.C. Brenner e R. Scott. The mathematical theory of finite element methods. Vol. 15. Sprin-\nger, 2008.\n\n[40] F. Brezzi, A. Buffa e K. Lipnikov. \u201cMimetic finite differences for elliptic problems\u201d. Em:\nESAIM: Mathematical Modelling and Numerical Analysis 43.02 (2009), pp. 277\u2013295.\n\n[41] F. Brezzi e M. Fortin. Mixed and hybrid finite element methods. Springer, 1991.\n[42] W. L. Briggs e S. F. McCormick. A multigrid tutorial. Vol. 72. Siam, 2000.\n[43] H. Bruining, R. Farajzadeh e B. Meulenbroek. \u201cThe effect of interface movement and vis-\n\ncosity variation on the stability of a diffusive interface between aqueous and gaseous CO2\u201d.\nEm: Physics of Fluids (1994-present) 25.7 (2013), p. 074103.\n\n[44] J. Bruining e W. J. Plug. \u201cCapillary pressure for the sand-CO2-water system under various\npressure conditions. Application to CO2 sequestration\u201d. Em: Advances in Water Resources\n30 (2007), 2339\u20132353.\n\n[45] J. Bruining, H. Salimi e K. H. Wolf. \u201cThe influence of capillary pressure on the phase\nequilibrium of the CO2-water system: Application to carbon sequestration combined with\ngeothermal energy\u201d. Em: International Journal of Greenhouse Gas Control 11S (2012),\nS47\u2013S66.\n\n[46] L.C. Campos. \u201cModelagem do escoamento de fluidos em meios porosos utilizando a es-\ntrutura de dados Autonomous Leaves Graph\u201d. Diss. de mestrado. Universidade Federal de\nMinas Gerais, UFMG, 2013.\n\n[47] M. A. Celia, R. E. Ewing, I. Herrera e T. F. Russell. \u201cAn Eulerian-Lagrangian localized\nadjoint method for the advection-diffusion equation\u201d. Em: Advances in Water Resources\n13.4 (1990), pp. 187\u2013206.\n\n[48] D. Chapelle e K. J. Bathe. \u201cThe inf-sup test\u201d. Em: Computers &amp; structures 47.4 (1993),\npp. 537\u2013545.\n\n[49] G. Chavent, R. di Chiara Roupert e G. Sch\u00e4fer. \u201cThree-phase compressible flow in porous\nmedia: Total Differential Compatible interpolation of relative permeabilities\u201d. Em: Journal\nof Computational Physics 229.12 (2010), pp. 4762\u20134780.\n\n[50] G. Chavent e J. Jaffr\u00e9. Mathematical Models and Finite Elements for Reservoir Simula-\ntion: Single Phase, Multiphase and Multicomponent Flows through Porous Media. Studies\nin Mathematics and its Applications. Elsevier Science, 1986.\n\n[51] Z. Chen. \u201cFormulations and numerical methods of the black oil model in porous media\u201d.\nEm: SIAM Journal on Numerical Analysis 38.2 (2000), pp. 489\u2013514.\n\n84\n\nhttp://books.google.com.br/books?id=EvClMX03MyAC\nhttp://books.google.com.br/books?id=EvClMX03MyAC\n\n\n[52] Z. Chen. Finite element methods and their applications. Vol. 5. Springer, 2005.\n[53] Z. Chen. Reservoir simulation: mathematical techniques in oil recovery. Vol. 77. Siam, 2007.\n[54] Z. Chen e R.E. Ewing. \u201cComparison of various formulations of three-phase flow in porous\n\nmedia\u201d. Em: Journal of Computational Physics 132.2 (1997), pp. 362\u2013373.\n[55] Z. Chen, G. Huan e Y. Ma. Computational methods for multiphase flows in porous media.\n\nVol. 2. Siam, 2006.\n[56] A. Chertock, C. R. Doering, E. Kashdan e A. Kurganov. \u201cA fast explicit operator splitting\n\nmethod for passive scalar advection\u201d. Em: Journal of Scientific Computing 45.1-3 (2010),\npp. 200\u2013214.\n\n[57] A.J. Chorin, T.J.R. Hughes, M.F. McCraken e J.E. Marsden. \u201cProduct Formulas and Nu-\nmerical Algorithms\u201d. Em: Comm. Pure Appl. Math. 31 (1978), pp. 205\u2013256.\n\n[58] H. de Coninck e E. Rubin. \u201cIPCC special report on carbon dioxide capture and storage\u201d.\nEm: Prepared by working group III of the intergovernmental panel on climate change Inter-\ngovernmental Panel on Climate Change. Cambridge, UK (2005).\n\n[59] J. H. Cushman. Dynamics of fluids in hierarchical porous media. Academic Press Inc.(London)\nLtd., 1990.\n\n[60] C. M. Dafermos. Hyperbolic conservation laws in continuum physics, 2nd edition. Springer-\nVerlag, Berlin, 2005.\n\n[61] H. K. Dahle, M. S. Espedal, R. E. Ewing e O. Saevereid. \u201cCharacteristic adaptive subdo-\nmain methods for reservoir flow problems\u201d. Em: Numerical Methods for Partial Differential\nEquations 6.4 (1990), pp. 279\u2013309.\n\n[62] H. K. Dahle, R. E. Ewing e T. F. Russell. \u201cEulerian-Lagrangian localized adjoint methods\nfor a nonlinear advection-diffusion equation\u201d. Em: Computer methods in applied mechanics\nand engineering 122.3 (1995), pp. 223\u2013250.\n\n[63] H. K. Dahle, K. H. Karlsen, K. A. Lie, J. R. Natvig e H. F. Nordhaug. \u201cOperator splitting\nmethods for systems of convection-diffusion equations: nonlinear error mechanisms and\ncorrection strategies\u201d. Em: J. of Computational Physics 173.2 (2001), pp. 636\u2013663.\n\n[64] H.K. Dahle, K.H. Karlsen, K.A. Lie, J.R. Natvig e H.F. Nordhaug. \u201cOperator splitting\nmethods for systems of convection-diffusion equations: nonlinear error mechanisms and\ncorrection strategies\u201d. Em: Journal of Computational Physics 173.2 (2001), pp. 636\u2013663.\n\n[65] C.N. Dawson e M.F. Wheeler. \u201cAn operator-splitting method for advection-diffusion-reaction\nproblems\u201d. Em: The Mathematics of Finite Elements and Applications VI (1988), pp. 463\u2013\n482.\n\n[66] dealII14. \u00daltimo acesso em Maio de 2014. url: http://www.dealii.org/.\n[67] D.A. Di Pietro e A. Ern. Mathematical aspects of discontinuous Galerkin methods. Springer,\n\n2012, p. 410.\n\n85\n\nhttp://www.dealii.org/\n\n\n[68] C. Douglas, F. Furtado, V. Ginting, M. Mendes, F. Pereira e M. Piri. \u201cOn the development\nof a high-performance tool for the simulation of CO2 injection into deep saline aquifers\u201d.\nEm: Rocky Mountain Geology 45.2 (2010), pp. 151\u2013161.\n\n[69] J. Douglas Jr. \u201cNumerical methods for the flow of miscible fluids in porous media\u201d. Em:\nNumerical methods in coupled systems (1984), pp. 405\u2013439.\n\n[70] J. Douglas Jr, F. Furtado e F. Pereira. \u201cOn the numerical simulation of waterflooding of\nheterogeneous petroleum reservoirs\u201d. Em: Computational Geosciences 1.2 (1997), pp. 155\u2013\n190.\n\n[71] J. Douglas Jr, F. Furtado, F. Pereira e L. M. Yeh. \u201cOn the numerical simulation of waterflo-\noding of heterogeneous petroleum reservoirs\u201d. Em: Computational Geosciences 1.2 (1997),\npp. 155\u2013190.\n\n[72] J. Douglas Jr, F. Pereira e L. M. Yeh. \u201cA locally conservative Eulerian-Lagrangian method\nfor flow in a porous medium of a mixture of two components having different densities\u201d.\nEm: Numerical Treatment of Multiphase Flows in Porous Media (2000), pp. 138\u2013155.\n\n[73] J. Douglas Jr, F. Pereira e L. M. Yeh. \u201cA locally conservative Eulerian-Lagrangian numerical\nmethod and its application to nonlinear transport in porous media\u201d. Em: Computational\nGeosciences 4.1 (2000), pp. 1\u201340.\n\n[74] J. Droniou. \u201cFinite volume schemes for diffusion equations: Introduction to and review of\nmodern methods Math\u201d. Em: Models Methods Appl. Sci. 24 (2014), pp. 1575\u20131619.\n\n[75] I.S. Duff, A.M. Erisman e J.K. Reid. Direct methods for sparse matrices. Clarendon Press\nOxford, 1986.\n\n[76] L.J. Durlofsky e M.G. Gerritsen. \u201cModeling fluid flow in oil reservoirs\u201d. Em: Annu. Rev.\nFluid Mech. 37 (2006), pp. 211\u2013238.\n\n[77] C. Erath. \u201cCoupling of the finite volume element method and the boundary element method:\nAn a priori convergence result\u201d. Em: SIAM Journal on Numerical Analysis 50.2 (2012),\npp. 574\u2013594.\n\n[78] A. Ern, I. Mozolevski e L. Schuh. \u201cDiscontinuous Galerkin approximation of two-phase\nflows in heterogeneous porous media with discontinuous capillary pressures\u201d. Em: Computer\nMethods in Applied Mechanics and Engineering 199.23 (2010), pp. 1491\u20131501.\n\n[79] O. G. Ernst e M. J. Gander. \u201cWhy it is difficult to solve Helmholtz problems with clas-\nsical iterative method\u201d. Em: Numerical Analysis of Multiscale Problems. Lecture Notes in\nComputational Science and Engineering 83 (2012), pp. 325\u2013363.\n\n[80] M.S. Espedal e K. H. Karlsen. \u201cNumerical solution of reservoir flow models based on large\ntime step operator splitting algorithms\u201d. Em: Filtration in Porous Media and Industrial\nApplication. Springer, 2000, pp. 9\u201377.\n\n[81] S. Evje, I. Fjelde, T. Kaarstad, H. Kleppe, S. M. Skjaeveland e L. Yu. \u201cModelling of wet-\ntability alteration processes in carbonate oil reservoirs\u201d. Em: Networks and Heterogeneous\nMedia 3.1 (2008), p. 149.\n\n86\n\n\n\n[82] S. Evje e H. Friis. \u201cNumerical treatment of two-phase flow in capillary heterogeneous porous\nmedia by finite-volume approximations\u201d. Em: Int. J. Numer. Anal. Mod. 9 (2012), pp. 505\u2013\n528.\n\n[83] R.E. Ewing, T.F. Russell e M.F. Wheeler. \u201cConvergence analysis of an approximation of\nmiscible displacement in porous media by mixed finite elements and a modified method of\ncharacteristics\u201d. Em: Computer Methods in Applied Mechanics and Engineering 47.1 (1984),\npp. 73\u201392.\n\n[84] R.E. Ewing e M.F. Wheeler. \u201cThe approximation of the pressure by a mixed method in the\nsimulation of miscible displacement\u201d. Em: ESAIM: Mathematical Modelling and Numerical\nAnalysis-Mod\u00e9lisation Math\u00e9matique et Analyse Num\u00e9rique 17.1 (1983), pp. 17\u201333.\n\n[85] R.E. Ewing e M.F. Wheeler. \u201cThe approximation of the pressure by a mixed method in the\nsimulation of miscible displacement\u201d. Em: RAIRO Anal. Num\u00e9r. 17.1 (1983), pp. 17\u201333.\n\n[86] M.W. Farthing, S.E. Gasda, C.E. Kees e C.T. Miller. \u201cAdaptive split-operator methods\nfor modeling transport phenomena in porous medium systems\u201d. Em: Advances in Water\nResources 34.10 (2011), pp. 1268\u20131282.\n\n[87] A. Francisco, V. Ginting, F. Pereira e Rigelo J. \u201cDesign and implementation of a mul-\ntiscale mixed method based on a nonoverlapping domain decomposition procedure\u201d. Em:\nMathematics and Computers in Simulation 99 (2014), pp. 125\u2013138.\n\n[88] K.M. Furati. \u201cEffects of relative permeability history dependence on two-phase flow in\nporous media\u201d. Em: Transport in Porous Media 28.2 (1997), pp. 181\u2013203.\n\n[89] F. Furtado e F. Pereira. \u201cCrossover from nonlinearity controlled to heterogeneity control-\nled mixing in two-phase porous media flows\u201d. Em: Computational Geosciences 7.2 (2003),\npp. 115\u2013135.\n\n[90] S. Geiger, R. Holm e M.I.J. van Dijke. \u201cThree-phase flow modelling using pore-scale capillary\npressures and relative permeabilities for mixed-wet media at the continuum-scale\u201d. Em:\nTransport in porous media 81.3 (2010), pp. 423\u2013442.\n\n[91] J. Geiser. Decomposition methods for differential equations: theory and applications. CRC\nPress, 2009.\n\n[92] A. George e J.W. Liu. Computer Solution of Large Sparse Positive Definite Systems. Prentice-\nHall, Englewood Cliffs, NJ, 1981.\n\n[93] M. G. Gerritsen, J. E. Kozdon e B. T. Mallison. \u201cMultidimensional upstream weighting\nfor multiphase transport in porous media\u201d. Em: Computational Geosciences 15.3 (2011),\npp. 399\u2013419.\n\n[94] J. Glimm, S. Hou, Y. Lee, D. Sharp e K. Ye. \u201cPrediction of oil production with confidence\nintervals\u201d. Em: SPE Reservoir Simulation Symposium. Society of Petroleum Engineers.\n2001.\n\n[95] J. Glimm e D. Sharp. \u201cStochastic methods for the prediction of complex multiscale pheno-\nmena\u201d. Em: Quarterly of applied mathematics 56.4 (1998), pp. 741\u2013766.\n\n87\n\n\n\n[96] J. Glimm e D. H. Sharp. \u201cA random field model for anomalous diffusion in heterogeneous\nporous media\u201d. Em: Journal of statistical Physics 62.1-2 (1991), pp. 415\u2013424.\n\n[97] J. Glimm e D. H. Sharp. \u201cPrediction and the quantification of uncertainty\u201d. Em: Physica\nD (1999), pp. 152\u2013170.\n\n[98] S. K. Godunov. \u201cA finite difference method for numerical calculation of discontinuous so-\nlutions of the equations of fluid dynamics\u201d. Em: Mat. Sb. (in russian) 47 (1959), pp. 271\u2013\n290.\n\n[99] G. H. Golub e D. P. O\u2019Leary. \u201cSome history of the conjugate gradient and Lanczos algo-\nrithms: 1948-1976\u201d. Em: SIAM review 31.1 (1989), pp. 50\u2013102.\n\n[100] A. Greenbaum. Iterative methods for solving linear systems. Vol. 17. Siam, 1997.\n[101] P. E. Hardisty, S. A. Mathias, M. R. Trudell e R. W. Zimmerman. \u201cApproximate solutions\n\nfor pressure buildup during CO2 injection in brine aquifers\u201d. Em: Transport in Porous\nMedia 79.2 (2009), pp. 265\u2013284.\n\n[102] M. R. Hestenes e E. Stiefel. \u201cMethods of Conjugate Gradients for Solving Linear Systems1\u201d.\nEm: Journal cf Research of the National Bureau of Standards Vol 49 (1952), pp. 409\u2013436.\n\n[103] H. Holden e L. Holden. \u201cOn the stric hypebolicity of the Buckley-Leverett equations for\nthree-phase flow in a porous medium\u201d. Em: J. Applied Math. 50.3 (1990), pp. 667\u2013682.\n\n[104] H. Holden, K.H. Karlsen, K. A. Lie e N. H. Risebro. \u201cOperator Splitting for Nonlinear\nPartial Differential Equations with Rough Solutions Analysis and Matlab Programs\u201d. Em:\nEMS Series of Lectures in Mathematics (2010), 226 pages.\n\n[105] W. Joppich e R. Wienands. Practical Fourier Analysis for Multigrid Methods. Numerical\nInsights. CRC Press, 2004. isbn: 9781420034998.\n\n[106] R. Juanes e T.W. Patzek. \u201cRelative permeabilities for strictly hyperbolic models of three-\nphase flow in porous media\u201d. Em: Transport in porous media 57.2 (2004), pp. 125\u2013152.\n\n[107] K. H. Karlsen e N. H. Risebro. \u201cAn operator splitting method for nonlinear convection-\ndiffusion equations\u201d. Em: Numer. Math. 77.3 (1997), pp. 365\u2013382.\n\n[108] K. H. Karlsen e N. H. Risebro. \u201cViscous splitting approximation of mixed hyperbolic-\nparabolic convection-diffusion equations\u201d. Em: Numer. Math. 83.1 (1999), pp. 107\u2013137.\n\n[109] K. H Karlsen e N. H. Risebro. \u201cCorrected operator splitting for nonlinear parabolic\u201d. Em:\nJ. on Numerical Analysis 37.3 (2000), 980\u20131003.\n\n[110] K. H. Karlsen e N. H. Risebro. \u201cCorrected Operator Splitting Method For Nonlinear Para-\nbolic Equations\u201d. Em: J. Numer. Anal. 37.3 (2000), pp. 980\u20131003.\n\n[111] J. Kou e S. Sun. \u201cA new treatment of capillarity to improve the stability of IMPES two-\nphase flow formulation\u201d. Em: Computers and Fluids 39.10 (2010), pp. 1923\u20131931.\n\n[112] J. C. C. Kuo e B. C. Levy. \u201cTwo-Color Fourier Analysis of the Multigrid Method with Red-\nBlack Gauss-Seidel Smoothing\u201d. Em: Applied Mathematics and Computation 29 (1989),\npp. 69\u201387.\n\n88\n\n\n\n[113] A. Kurganov, G. Petrova e B. Popov. \u201cAdaptive semidiscrete central-upwind schemes for\nnonconvex hyperbolic conservation laws\u201d. Em: SIAM Journal on Scientific Computing 29.6\n(2007), pp. 2381\u20132401.\n\n[114] A. Kurganov e E. Tadmor. \u201cNew high-resolution central schemes for nonlinear conserva-\ntion laws and convection-diffusion equations\u201d. Em: Journal of Computational Physics 160.1\n(2000), pp. 241\u2013282.\n\n[115] K. Lackner e R. Menikoff. \u201cMultiscale Linear Solvers for Very Large Systems Derived\nfrom PDES\u201d. Em: SIAM Journal on Scientific Computing 21.5 (2000), pp. 1950\u20131968.\nissn: 1064-8275 (print), 1095-7197 (electronic). doi: http : / / dx . doi . org / 10 . 1137 /\nS1064827598339785.\n\n[116] C.S. Land. \u201cCalculation of imbibition relative permeability for two-and three-phase flow\nfrom rock properties\u201d. Em: Society of Petroleum Engineers Journal 8.02 (1968), pp. 149\u2013\n156.\n\n[117] D. Lanser e J. G. Verwer. \u201cAnalysis of operator splitting for advection-diffusion-reaction\nproblems from air pollution modelling\u201d. Em: Journal of computational and applied mathe-\nmatics 111.1 (1999), pp. 201\u2013216.\n\n[118] R.J. LeVeque. Finite Difference Methods for Ordinary and Partial Differential Equations:\nSteady-State and Time-Dependent Problems. SIAM e-books. SIAM, 2007. url: http : / /\nbooks.google.com.br/books?id=lZysESfSWwgC.\n\n[119] K. Lipnikov, G. Manzini e L. B. Veiga. \u201cThe Mimetic Finite Difference Method for Elliptic\nProblems\u201d. Em: MS&amp;A XVI (2014), 394 pages.\n\n[120] D. Marchesin, H.B. Medeiros e P.J. Paes-Leme. \u201cA model for two-phase flow with hystere-\nsis\u201d. Em: Contemporary Mathematics 60 (1987), pp. 89\u2013107.\n\n[121] D. Marchesin e B. J. Plohr. \u201cWave structure in WAG recovery\u201d. Em: Society of Petroleum\nEngineering Journal 71314 6.2 (2001), pp. 209\u2013219.\n\n[122] S.F. McCormick. Multigrid Methods. Frontiers in Applied mathematics. Society for Indus-\ntrial e Applied Mathematics, 1987. isbn: 9780898712148. url: http : / / books . google .\ncom.br/books?id=594AN97YHtwC.\n\n[123] M. A. Mendes, M. A. Murad e F. Pereira. \u201cA new computational strategy for solving\ntwo-phase flow in strongly heterogeneous poroelastic media of evolving scales\u201d. Em: In-\nternational Journal for Numerical and Analytical Methods in Geomechanics 36.15 (2012),\npp. 1683\u20131716.\n\n[124] G. Meurant. Computer solution of large linear systems. Vol. 28. Studies in Mathematics e\nits Applications, North-Holland, Amsterdam, 1999.\n\n[125] A. Miranda. \u201cModelagem num\u00e9rica do comportamento din\u00e2mico entre frentes de ondas e\nmeios porosos descont\u00ednuos em problemas evolutivos de transporte de convec\u00e7\u00e3o-difus\u00e3o\u201d.\nTese de Doutorado em matem\u00e1tica aplicada em andamento, orientador: prof. Dr. Eduardo\nAbreu.\n\n89\n\nhttp://dx.doi.org/http://dx.doi.org/10.1137/S1064827598339785\nhttp://dx.doi.org/http://dx.doi.org/10.1137/S1064827598339785\nhttp://books.google.com.br/books?id=lZysESfSWwgC\nhttp://books.google.com.br/books?id=lZysESfSWwgC\nhttp://books.google.com.br/books?id=594AN97YHtwC\nhttp://books.google.com.br/books?id=594AN97YHtwC\n\n\n[126] I. Mozolevski e L. Schuh. \u201cNumerical simulation of two-phase immiscible incompressible\nflows in heterogeneous porous media with capillary barriers\u201d. Em: Journal of Computational\nand Applied Mathematics 242 (2013), pp. 12\u201327.\n\n[127] MUMPS: a parallel sparse direct solver. \u00daltimo acesso em Maio de 2014. url: http://\nmumps.enseeiht.fr/.\n\n[128] L. Neal e G. Poole. \u201cA Geometric Analysis of Gaussian Elimination\u201d. Em: Linear Algebra\nand its Applications 149 (1991), pp. 249\u2013272.\n\n[129] H. Nessyahu e E. Tadmor. \u201cNon-oscillatory central differencing for hyperbolic conservation\nlaws\u201d. Em: Journal of computational physics 87.2 (1990), pp. 408\u2013463.\n\n[130] C. W. Oosterlee, T. Washio e R. Wienands. \u201cFourier analysis of GMRES(m) preconditioned\nby multigrid\u201d. Em: SIAM Journal on Scientific Computing 22.2 (2000), pp. 582\u2013603.\n\n[131] C. W. Oosterlee e R. Wienands. \u201cOn three-grid Fourier analysis for multigrid\u201d. Em: SIAM\nJournal on Scientific Computing 23.2 (2001), pp. 651\u2013671.\n\n[132] C. O. Osterlee, U. Trottenberg e A. Schuller. Multigrid. Academic, Press, New York, 2001.\n[133] D.W. Peaceman. Fundamentals of Numerical Reservoir Simulation. Developments in Petro-\n\nleum Science. Elsevier Science, 2000. isbn: 9780080868608. url: http://books.google.\ncom.br/books?id=-DujQRDF4kwC.\n\n[134] J. Peraire e P-O. Persson. \u201cThe compact discontinuous Galerkin (CDG) method for elliptic\nproblems\u201d. Em: SIAM Journal on Scientific Computing 30.4 (2008), pp. 1806\u20131824.\n\n[135] S. B. Pope e Z. Ren. \u201cSecond-order splitting schemes for a class of reactive systems\u201d. Em:\nJournal of Computational Physics 227.17 (2008), pp. 8165\u20138176.\n\n[136] P. Raviart e J. Thomas. \u201cA mixed finite element method for second order elliptic problems\u201d.\nEm: In: Lecture Notes in Mathematics (1977), pp. 292\u2013315.\n\n[137] J.E. Roberts e J-M. Thomas. \u201cMixed and hybrid methods\u201d. Em: Handbook of numerical\nanalysis 2.Part 1 (1991), pp. 523\u2013633.\n\n[138] T. F. Russell. \u201cTime stepping along characteristics with incomplete iteration for a galerkin\napproximation of miscible displacement in porous media\u201d. Em: J. Numer. Anal. 22 (1985),\npp. 970\u20131013.\n\n[139] Y. Saad. Iterative Methods for Sparse Linear Systems: Second Edition. Society for Industrial\ne Applied Mathematics, 2003. isbn: 9780898715347. url: http://books.google.com.br/\nbooks?id=ZdLeBlqYeF8C.\n\n[140] M. Shashkov e S. Steinberg. \u201cSupport-operator finite-difference algorithms for general el-\nliptic problems\u201d. Em: Journal of Computational Physics 118.1 (1995), pp. 131\u2013151.\n\n[141] J. R. Shewchuk. An introduction to the conjugate gradient method without the agonizing\npain. 1994.\n\n[142] G. W. Stewart. Matrix Algorithms. Vol. 1-5. Siam, 2002.\n[143] G. Strang. \u201cOn the construction and comparison of difference schemes\u201d. Em: SIAM Journal\n\non Numerical Analysis 5.3 (1968), pp. 506\u2013517.\n\n90\n\nhttp://mumps.enseeiht.fr/\nhttp://mumps.enseeiht.fr/\nhttp://books.google.com.br/books?id=-DujQRDF4kwC\nhttp://books.google.com.br/books?id=-DujQRDF4kwC\nhttp://books.google.com.br/books?id=ZdLeBlqYeF8C\nhttp://books.google.com.br/books?id=ZdLeBlqYeF8C\n\n\n[144] G. Strang. \u201cOn the construction and comparison of difference schemes\u201d. Em: J. on Nume-\nrical Analysis 5.3 (1968), pp. 506\u2013517.\n\n[145] SuperLU: is a general purpose library for the direct solution of large, sparse, nonsymmetric\nsystems of linear equations on high-end computers. \u00daltimo acesso em Maio de 2014. url:\nhttp://www.cs.berkeley.edu/~demmel/SuperLU.html, ouhttp://crd- legacy.lbl.\ngov/~xiaoye/SuperLU/.\n\n[146] O. Tatebe. \u201cMGCG Method: A Robust And Highly Parallel Iterative Method\u201d. Tese de\ndoutorado. University of Tokio, 1996.\n\n[147] J. W. Thomas. Numerical partial differential equations: conservation laws and elliptic equa-\ntions. Vol. 2. N.Y. Springer, 1999.\n\n[148] J. W. Thomas. Numerical partial differential equations: conservation laws and elliptic equa-\ntions. Vol. 3. Springer Berlin, 1999.\n\n[149] A. Townsend e L. N. Trefethen. \u201cGaussian Elimination as an Iterative Algorithm\u201d. Em:\nSIAM News 46.2 (2013).\n\n[150] L. N. Trefethen. \u201cThree Mysteries of Gaussian Elimination\u201d. Em: ACM SIGNUM Newsletter\n20 (1985), pp. 2\u20135.\n\n[151] UMFPACK: unsymmetric multifrontal sparse LU factorization package. \u00daltimo acesso em\nMaio de 2014. url: http://www.cise.ufl.edu/research/sparse/umfpack/.\n\n[152] F.M. Van Kats e C.J. Van Duijn. \u201cA mathematical model for hysteretic two-phase flow in\nporous media\u201d. Em: Transport in Porous Media 43.2 (2001), pp. 239\u2013263.\n\n[153] M. Vohral\u00eck. \u201cEquivalence between lowest-order mixed finite element and multi-point finite\nvolume methods on simplicial meshes\u201d. Em: ESAIM: Mathematical Modelling and Nume-\nrical Analysis 40.2 (2006), pp. 367\u2013391.\n\n[154] D.S. Watkins. Fundamentals of Matrix Computations. Wiley International Editions. Wi-\nley, 1991. isbn: 9780471614142. url: http : / / books . google . com . br / books ? id = 8 -\ngZAQAAIAAJ.\n\n[155] P. Wesseling. An Introduction to Multigrid Methods. Pure and applied mathematics. Wiley,\n1992.\n\n91\n\nhttp://www.cs.berkeley.edu/~demmel/SuperLU.html, ou http://crd-legacy.lbl.gov/~xiaoye/SuperLU/\nhttp://www.cs.berkeley.edu/~demmel/SuperLU.html, ou http://crd-legacy.lbl.gov/~xiaoye/SuperLU/\nhttp://www.cise.ufl.edu/research/sparse/umfpack/\nhttp://books.google.com.br/books?id=8-gZAQAAIAAJ\nhttp://books.google.com.br/books?id=8-gZAQAAIAAJ\n\n\n92\n\n\n\nAp\u00eandice A\n\nElimina\u00e7\u00e3o dos multiplicadores de\nLagrange\n\nIremos apresentar os c\u00e1lculos para a elimina\u00e7\u00e3o das vari\u00e1veis multiplicadores de Lagrange da\nSe\u00e7\u00e3o 4.2.3 do Cap\u00edtulo 4.\n\nConsidere as equa\u00e7\u00f5es discretas (B.3.3) e (B.3.4) para um elemento ? qualquer,\n\n?? + ?? + ?? + ?? = ?? ?, (A.0.1)\n\n?? =\n2? ?\n\n?\n(? ? ??), ? = ?, ?, ?, ?, (A.0.2)\n\nmais as equa\u00e7\u00f5es de consist\u00eancia (4.2.28)\n\n?? = ???? , ?? + ????? = 0, ? = ?, ?, ?, ?, e ?? = ?, ?, ?, ?. (A.0.3)\n\nAgora, vamos fixar ? = ?. Das equa\u00e7\u00f5es de consist\u00eancia (A.0.3) temos que,\n\n?\n(1)\n? = ??\n\n(2)\n? , ?\n\n(1)\n? = ?\n\n(2)\n? , (A.0.4)\n\nonde os superscritos (1) e (2) s\u00e3o usados para denotar elementos adjacentes. Dessa forma,\n\n?\n(1)\n? =\n\n2? (1) ?(1)\n?\n\n(?(1) ? ?(1)? ) = ?\n2? (2) ?(2)\n\n?\n(?(2) ? ?(2)? ) = ??\n\n(2)\n? , (A.0.5)\n\n=? ? (1) ?(1)(?(1) ? ?(1)? ) = ??\n(2) ?(2)(?(2) ? ?(2)? ), (A.0.6)\n\n=? ? (1) ?(1)(?(1) ? ?(1)? ) = ??\n(2) ?(2)(?(2) ? ?(1)? ), (A.0.7)\n\n=? ? (1) ?(1)?(1) ? ? (1) ?(1)?(1)? = ??\n(2) ?(2)?(2) + ? (2) ?(2)?(1)? , (A.0.8)\n\n=? ?(1)? =\n? (1) ?(1)?(1) + ? (2) ?(2)?(2)\n\n? (1) ?(1) + ? (2) ?(2)\n. (A.0.9)\n\n93\n\n\n\nSubstituindo ?(1)? em (A.0.5) temos:\n\n?\n(1)\n? =\n\n2? (1) ?(1)\n?\n\n[?\n?(1) ?\n\n? (1) ?(1)?(1) + ? (2) ?(2)?(2)\n? (1) ?(1) + ? (2) ?(2)\n\n]?\n(A.0.10)\n\n=\n2(? (1) ?(1))2?(1) + 2? (1) ?(1)? (2) ?(2)(?(1) ? ?(2)) ? 2(? (1) ?(1))2?(1)\n\n?(? (1) ?(1) + ? (2) ?(2))\n(A.0.11)\n\n=\n2? (1) ?(1)? (2) ?(2)(?(1) ? ?(2))\n\n?(? (1) ?(1) + ? (2) ?(2))\n. (A.0.12)\n\nOs c\u00e1lculos para ? = ?, ?, ? s\u00e3o an\u00e1logos, assim temos a seguinte equa\u00e7\u00e3o para cada ?,\n\n?? =\n2? ? ???? ????(? ? ??)\n\n?(? ? + ???? ????)\n, ? = ?, ?, ?, ?. (A.0.13)\n\nDefinimos ent\u00e3o,\n\n(??)eff? =\n2 ? ? ???? ????\n? ? + ???? ????\n\n. (A.0.14)\n\nPor fim, juntando as equa\u00e7\u00f5es (A.0.1) e (A.0.13) obtemos a seguinte equa\u00e7\u00e3o para cada elemento,\n\n??\n?=?,?,?,?\n\n(? ?)eff?\n?2\n\n(? ? ??) = ?? , (A.0.15)\n\nque corresponde a equa\u00e7\u00e3o (B.3.5) que comp\u00f5e o sistema linear para a press\u00e3o.\n\n94\n\n\n\nAp\u00eandice B\n\nA computational multiscale approach for\nincompressible two-phase flow in\nheterogeneous porous media including\nrelative permeability hysteresis\n\nAqui apresentamos o texto completo do trabalho aceito no congresso International Conference\non Approximation Methods and Numerical Modelling in Environment and Natural Resources MA-\nMERN VI, em Pau na Fran\u00e7a [3].\n\nAbstract: The focus of this work is the numerical approximation of incompressible two-phase\ntransport problems with hysteresis in porous media coupled to a Poisson problem to the pressure-\nvelocity problem. Modeling hysteresis in porous media flow is relevant for instance in the numerical\nsimulation framework for modeling CO2 sequestration operations in large-scale heterogeneous for-\nmations, such as deep saline aquifers and depleted oil and gas reservoirs. A combined mixed\ndiscretization of locally conservative finite volume and mixed finite techniques will be applied\nvia an operator splitting formulation to address the flow equations. In particular, the numerical\nsolution of the resulting linearized system associated to the Poisson problem will be addressed\nby a multiscale multigrid preconditioned conjugate gradient (PCG) method. Accurate numeri-\ncal solutions in two-space dimensions to the hysteresis differential model at hand are provided to\ndemonstrate the viability of the proposed formulation.\n\nB.1 Introduction\nIn this work we are concerned with an accurate numerical approximation of a related wate-\n\nflooding transport flow problems with hysteresis phenomena in a two-dimensional heterogeneous\nporous media. In particular, we describe a numerical method based on the preconditioned con-\njugate gradient method (PCG), with a multigrid multiscale preconditioner, recently introduced\nin the literature \u201cMultiscale Linear Solvers for Very Large Systems Derived from PDES\u201d, SIAM\n\n95\n\n\n\nJournal on Scientific Computing, 2000, by Klaus Lackner and Ralph Menikoff [115] \u2013 see also [38,\n30, 79] and references therein \u2013 for the numerical solution of the pressure-velocity system linked to\nthe underlying hysteresis two-phase flow problem. This scheme is combined with locally conserva-\ntive hybrid mixed finite elements (HMFEM) along with a domain decomposition iteration for the\nnumerical solution of the parabolic problem associated with the diffusive transport of fluid phases.\nHybridized mixed finite elements is locally conservative by construction and it is quite adequate\nfor accurate computation of fluxes and velocity fields in the case of heterogeneous porous media\ntransport problems [7, 2, 70, 136]. In our numerical procedure a high resolution, nonoscillatory,\nsecond order, conservative central difference scheme is used for the approximation of the nonlinear\nsystem of hyperbolic conservation laws modelling the convective transport of the fluid phases [2,\n123, 34].\n\nHysteresis may be the most important phenomenon in multiphase porous media flow that is\nlacking rigorous mathematical analysis (see, e.g., [27, 12] and references therein). Hysteresis has\nbeen identified for instance in physical phenomenas as such pseudo-elasticity, plasticity, supercon-\nductivity, ferromagnetism, biology, thin-film transistors, ferroelectricity, phase transitions, porous\nmedia filtration, and in several other physical phenomena. Typically, hysteresis is often associated\nwith an irreversible mode of thermodynamic change. Mathematically, this means that we must\nbe able to deal with approximate or exact solutions of differential equations (i.e., parabolic, and\nhyperbolic) with a flux function which is discontinuous with respect a state variable, e.g., satura-\ntion. Essentialy, nonequilibrium effects associated with the state variable in interfaces in porous\nmedia naturally leads to discontinuities in the hysteresis relation, which in turn is also associated\nto the occurrence of free boundaries and (local) internal layers in the physical domain. This means\nthat hysteresis might be expressed by means of initial boundary value problems in the form of a\nprototype nonlinear parabolic convection-diffusion problem. Its effects are modeled by assuming\nthat exists two extreme permeability curves, imbibition and drainage, describing the flow for the\noil saturation, in an irreversible fashion; and exists a continuous family of permeability curves,\ncalled scanning curves, between the imbibition and drainage, describing the flow when the oil\npermeability changes reversible.\n\nThe two-phase flow model with hysteresis considered herein takes into account capillary forces,\ngeneral expressions for the relative permeability functions, variable porosity and permeability fields.\nFor concreteness, we consider horizontal reservoirs with no gravity influence in the fluid flow. The\nfluid phases are water and oil, indicated by the subscripts w and o, respectively, and they occupy\nthe whole pore space (i.e., ?? + ?? = 1). An additional state variable, the hysteresis parameter\n? = ?(x, ?) is introduced to account for the dependence of the oil permeability ??(??, ?) on the\nflow history [27, 12]. Then, we write the governing system of equations of two-phase flow with\nhysteresis and no gravity, in the so-called phase formulation [50]; see also [2, 7]:\n\n?\n\n??\n(? (x) ??) + ? \u00b7 (u??) = ? \u00b7 w?, (B.1.1)\n\n? \u00b7 u = 0, u = ?????? + u??, (B.1.2)\n\nwhere (u??) (??, ?), w? and u are functions of ??, x and ?. Also, the diffusive term w? is defined\nby,\n\nw? (??, x) = ?? (x) [?? (??) (1 ? ??)] ???. (B.1.3)\n\n96\n\n\n\nThe term u?? is a correction velocity and is are given by,\n\nu?? = ?? (x) ?? (??) ???, (B.1.4)\n\nwith ??(??) = ??(??)/??, ? = ?, ?, (phase mobilities), ? = ?? + ?? (total mobility), ?? = ?/?? and\n?? is the capillary pressure. The following PDE,\n\n??\n\n??\n= ? (??, ?) =\n\n???\n??\n\n(?? (??) ? ?)/?, if ? &lt;?? (??) ,\n(?? (??) ? ?)/?, if ? > ?? (??) ,\n0, otherwise,\n\n(B.1.5)\n\nis used to modeling the hysteresis in ?? with relaxation, where ?? and ?? relate to the imbibition\nand drainage processes, respectively, and ? is the relaxation time. We consider the Scanning\nHysteresis Model with Relaxation (SHMR) [27] represented by equation (B.1.5). It allows the\nscanning flow to extend beyond the drainage and imbibition curves treating those as attractors\nof states outside the scanning region. The attraction occurs on a time scale corresponding to the\nredistribution of phases within the pores, driven by capillary forces.\n\nThe outline of the remaining of the paper is as follows. In Section B.2 the key issues of compu-\ntational modeling of the coupled two-phase flow system with hysteresis is discussed to the Poisson\npressure-velocity problem and to the diffusive problem by means of an operator splitting based\non physics for flow in porous media. We mention that for both fixed, the velocity and the water\nsaturation with hysteresis into the operator splitting approach, we then solve the purely convective\ntransport subproblem, associated to Eqs. (B.1.1) -(B.1.2) with the aid of a modified central scheme\nto take into account variable porosity in the temporal operator as well as discontinuous hyperbolic\nflux functions; for more details to the hyperbolic step see [2, 7]. The continuous-time mixed finite\nelement approximations to the ellipitc and parabolic problems are depicted in Section B.3 and\nthe numerical experiments are presented and analyzed in Section B.4, along with our concluding\nremarks in Section B.5.\n\nB.2 Computational Modeling with Hysteresis\nIn this stage, an operator splitting technique [2, 96, 12, 123, 34] is used to separate the un-\n\nderlying physical process presented in the governing system. At first, we separate the calculation\nof pressure-velocity problem from the saturation transport equation. Then we decompose the sa-\nturation calculation into convective and diffusive followed by a relaxation step by solving (B.1.5).\nThus, we introduce three time steps: ??? for the hyperbolic problem related to the convective\ntransport of the fluids, ??? for the parabolic problem related to the diffusive transport, and ???,\nfor the pressure-velocity field. The algorithm for approximation of Eqs.(B.1.1)-(B.1.5) is described\nas follows (only one single time step will be described ??? = ??? = ???, under the assumption\nof all time steps are subject to stability conditions [2, 7, 70, 12]): 1) Given boundary and initial\nconditions, we solve the pressure-velocity problem (B.1.2) using mixed finite elements [136] for\nthe computation of the pair (??, u); 2) use the latter solution of the saturation equation, which\nincorporates convection and diffusion effects, as an initial condition. Then solve the stiff nonlinear\n\n97\n\n\n\nPDE (B.1.5) to incorporate the hysteresis effects on the flow; 3) fixing the velocity and the water\nsaturation with hysteresis, we solve the purely convective subproblem, associated to Eq.(B.1.1); see\n[2, 70] for details. After each hyperbolic step we also solve Eq.(B.1.5) [12]; 4) take the convective\nsolution as initial condition and solve the purely diffusive subproblem associated to Eq.(B.1.1),\nby a hybridized mixed finite element method [136] with an implicit backward Euler strategy in\ntime [7, 2]; 5) finally, use the latter solution of the saturation (as an initial condition), we update\nEq.(B.1.5) to solve the hysteresis effects on the flow. This sequence must be repeated until the\nend of the simulation. Below we describe in more details this numerical approach.\n\nFirst, assume {??} and {ww} are known. Than calculate the correction velocity uC. Let\nu = v + uC and define a problem for (??, v) equivalent to Eq.(B.1.2) by,\n\nv = ?? (x) ? (??, ?) ???,\n? \u00b7 v = ?? \u00b7 uC (??, x, ?) ? ?? ,\n\n(B.2.1)\n\nsubject to the boundary condition,\n\nv \u00b7 n =\n{?\n\n??, for ? = {0}, ? ? [0, ? ],\n0, for ? = {0, ? }, ? ? [0, ?], (B.2.2)\n\nwhere n is the unit outer normal vector to ?? and ? is the rate of water injection. In order to\ncapture viscous fingering effects [70, 2] we keep a constant reference pressure ?? at ? = {?} and\n? ? [0, ? ]. Now:\n\n1) Given ??? (x), ? ? 0, determine {??? , v?} at ?? = ????, ? = 0, 1, 2, ..., by solving the\nEq.(B.2.1). The initial data of ?? and hysteresis are given by right state (??, ?)? and left state\n(??, ?)?, at ? = 0 [12].\n\n2) Due to the stiff time scale [12], first use the following analytical solution for Eq.(B.1.5) to\naccount for the hysteresis equilibrium state from the initial data ?0? (x) = 1 ? ?0?(x) for ??? , in\nparticular for initial data out side the non-equilibrium region,\n\n?? =\n\n????\n???\n\n?? (?0? ) +\n(?\n?0 ? ?? (?0? )\n\n)?\n?????/? , if ?0 &lt;?? (?0? ) ,\n\n?? (?0? ) +\n(?\n?0 ? ?? (?0? )\n\n)?\n?????/? , if ?0 > ?? (?0? ) ,\n\n?0, otherwise.\n(B.2.3)\n\n3) ??? (x) is calculated in [???1, ??] for ? > 0. For ?? &lt;? &lt;??+1 solve, sequentially, Eq.(B.1.1)\nwith initial condition, ??(x, ??) = ??? (x), and Eq.(B.1.5) for the relaxation parameter with initial\ncondition, ?(x, ??) = ??(x); and ??(x) is defined by solution of Eq.(B.2.3). Use the following\nanalytical solution for Eq.(B.1.5) to incorporate hysteresis for ???,\n\n??+1 =\n\n????\n???\n\n?? (??? ) +\n(?\n?? ? ?? (??? )\n\n)?\n?????/? , if ?? &lt;?? (??? ) ,\n\n?? (??? ) +\n(?\n?? ? ?? (??? )\n\n)?\n?????/? , if ?? > ?? (??? ) ,\n\n??, otherwise.\n(B.2.4)\n\nThe initial condition for the analytical calculation of the hysteresis step is defined by ??? (x) =\n1 ? ??? (x). The expression for ?? , is obtained by setting ??? (??) = ??? (??, ?); after algebraic\n\n98\n\n\n\nmanipulations it is possible to obtain a functional form for ?? , such that 0 ? ?? ? 1 and 0 ? ?? ?\n1. A similar procedure is adopted for ??, by setting ??? (??) = ??? (??, ?), [12].\n\nWe now turn our attention to the continuous-time mixed finite element approximations to the\nelliptic (B.2.1) and to the parabolic problems. We focus on the approximation of the Poisson\nequation by means of a multiscale algorithm for the solution of ill-conditioned large linear systems\nobtained by the discretization of elliptic problems in fluid dynamics.\n\nB.3 Continuous-time mixed finite element approximations\nto the Ellipitc and Parabolic problems\n\nAfter having identified the pressure-velocity problem (B.2.1)-(B.2.2) in Section B.2 we wish to\napproximate the pair (v, ?) by mixed hybrid finite elements in order to obtain a symmetric positive\ndefinite linear system, and then apply the multiscale method as introduced in [115].\n\nB.3.1 Discretization of the Poisson-elliptic problem\nIt is well know that the mixed finite element formulation leads to a sparse symmetric positive\n\ndefinite linear system [136, 2, 70, 7], but due to the multiscale nature of the reservoir permeability\nthis system is ill-conditioned. So a preconditioning technique is necessary to address this problem.\n\nNow let ? = [0, ?] \u00d7 [0, ? ] ? R2 be a bounded domain with a Lipschitz boundary ?? and\nlet {?? , ? = 1, . . . , ? } be a partition of disjoint elements of ?. Assume that the edges of each\npartition are also Lipschitz and that ?? is star-shaped and ?? = ?? \u00d7 ??. Let ? = ??, ?? =\n? ? ??? , ??? = ??? ? ???. Defining the spaces ? ? ?2(?) and ? ? ?(???; ?), the hybridized\nmixed finite element method is given [2, 136, 70, 7] by seeking, {?? , v? , ???} ? ? ?? \u00d7 ? ?? \u00d7 ???,\n{?? , ? = 1, . . . , ? }, such that:\n\n(? \u00b7 v? , ?)?? ? (?? , ?)?? = 0, (B.3.1)\n(??1??1v? , v?)?? ? (?? , ?\u00b7v?)?? +\n\n??\n? ?=?\n\n????, v? \u00b7 n? ???? = 0, (B.3.2)\n\nfor all test functions v?, ? ? (?? ) and ?, ? ? (?? ); n? is the unit outer normal to each element.\nThe Lagrange multipliers, ???, defined on ?? are introduced as a way to relax the consistency\nconditions, ?? = ?? and v? \u00b7 n? + v? \u00b7 n? = 0 in ???, so we can permit discontinuous pressures across\neach edge of ?? . The space ? ?? \u00d7 ? ?? are the mixed finite element space chosen to be the lowest\nindex Raviart-Thomas space [136] over rectangles. The natural degrees of freedom on the element\n?? , are the constant value ?? of the pressure at the center of ?? , and the four constant values\n???, ? = ?, ?, ?, ? , of the outward normal component of the total fluxes across the edges of the\nelement for Darcy velocity [2, 70]. The Lagrange multipliers ??? and ??? on ??? are also constants\n[2, 70, 136]. We also assume the absolute permeability to be constant on each element, and the\nrelative permeability functions to be independent of position.\n\nFor simplicity suppress the subscript ? and define ? ? ?? = ??. Now, consider the test function\nas a basis function for vectors on the standard reference square [0, ?] and apply a trapezoidal rule\n\n99\n\n\n\n[2, 70] to the Eqs.(B.3.1)-(B.3.2), since it will allow us to write the resulting algebraic problem in a\nparticularly simple form. After the calculation with the four basis functions (?/?, 0), (1 ? ?/?, 0),\n(?/?, 0) and (1 ? ?/?, 0) [2, 70], collect the five equations for the reference (oil) pressure in the\nphase formulation:\n\n?? + ?? + ?? + ?? = ?? ?, (B.3.3)\n\n?? ?\n2??\n\n?\n(? ? ??) = 0, ? = ?, ?, ?, ?. (B.3.4)\n\nNote that we have five equations and nine variables. We chose to eliminate the Lagrange multipliers\nsince the resultant linear system is symmetric positive definite [2] and we can apply our numerical\nmethod based on the conjugate gradient method. Combining the consistency conditions with the\nEqs.(B.3.3) and (B.3.4) we obtain the following discrete equation for the (oil) pressure and velocity:\n\n??\n?=?,?,?,?\n\n(? ?)eff?\n?2\n\n(? ? ??) = ?? , (B.3.5)\n\nwhere, (??)eff? is defined as the effective permeability across the ?-interface,\n\n(??)eff? =\n2 ? ? ???? ????\n? ? + ???? ????\n\n. (B.3.6)\n\nIn the above, ??, ????(??, ?) and ???? indicate the values of ? (reference oil pressure), ?(??, ?) and ?\nin the element across the ?-interface, respectively. Indeed, ?? and ? are well defined at the element\ncells. Notice that ? in (??)eff? depends on the relative permeability, which can be discontinuous;\n(see Section B.4.1). The velocity in each interface is given by\n\n?? =\n(? ?)eff?\n\n?\n(? ? ??). (B.3.7)\n\nNow we have a linear system A? = ?? for the oil pressure given by Eq. (B.3.5), which can be\nsolved by any efficient algebraic linear solver.\n\nWe now turn our attention to the discussion of the multiscale multigrid approach for solving\nthe algebraic linear problem A? = ?? , obtained from the above discretized Poisson problem by\nthe locally conservative mixed method.\n\nB.3.2 A multigrid multiscale preconditioner method for the discreti-\nzed coupled nonlinear Poisson-elliptic problem\n\nThe matrix A of the linear system (B.3.5) is ill-conditioned due to the rapid variation of the\npermeability field caused by the geological properties of the reservoir, so the use of a preconditioner\nis necessary [70, 2, 7, 96, 115]. This means we need a precondioning matrix M?1 that is a\ngood approximation for A?1. Since the pressure-velocity problem is coupled with a transport of\nsaturation equation over time \u2013 see Section B.2 \u2013 this means that we need to solve a Poisson\nproblem (B.3.5) for each time step during the simulation time. Thus, we need a robust and\n\n100\n\n\n\nfast solver to tackle this issue. To this end, we use the multiscale recursive conjugate gradient\nmethod, introduced by K. Lackner and R. Menikoff in [115]; see also [38, 30, 79] and references\ntherein. It combines both a multigrid method and the precondioned conjugate gradient method\nin order to capture the distinct wavelengths associated with the different wavelengths from the\nassociated self-adjoint Poisson operator, strongly influenced by the heterogeneity of the porous\nmedia, in particular to the absolute permeability tensor. This method uses the following multigrid\nmultiscale preconditioner [115]:\n\nM?1 = (P?1Q)?(?A?1? ?)(QP\n?1)? + P?1\n\n2??1??\n?=0\n\n(P?1Q)? , (B.3.8)\n\nwhere A?1? is inverse of the coarsened operator A?. The coarse operator is obtained by a redis-\ncretization of the Eq.(B.2.1) on a coarser grid. The Eq.(B.3.8) is a special case of a multigrid\nscheme, with only two levels [115]. In our method, the evaluation of A?1? on a vector is computed\nby applying the same algorithm to the coarse grained operator A?. This continue on the next\ncoarse levels, until we can solve the problem exactly on the coarsest level [115]. An important\nfeature of this preconditioner is that long and short wavelengths are coupled at each level by a\nconjugate gradient solver before proceeding to the next level, preventing truncation errors from\nthe coarsening of the operator at each level from accumulating [115]. In particular, if A? does\npoorly on a few modes, which typically occurs when the coefficients of the underlying PDE are\ndiscontinuous, then these modes will be corrected by the conjugate gradient solver with only a\nsmall penalty [115].\n\nThe matrices P and Q are obtained by the decomposition A = P ? Q, where P = P?.\nIt represents the smoother: a relaxation method that smooths the short wavelengths. Here we\nchose the Red-Black symmetric Gauss-Seidel (RB-SGS). The parameter ? on Eq.(B.3.8) is fixed,\ndefined as the number of iterations of the smoother. In this work we use ? = 3?/2, where ? is\nthe discretization scale on the finest level. The value of ? was defined based on both, on the work\nof K. Lackner and R. Menikoff [115] and based on our own numerical experiments.\n\nOn the other hand, the matrices ? and ? are the prolongation and restriction operators [115,\n38, 30, 79], responsible for the transference of vectors from coarser grids to finer grids and from\nfiner to coarser grids, respectively. The prolongation operator is defined as the tensor product\nof cell-centered linear interpolations, and the restriction operator is taken as the adjoint of the\nprolongation operator. The coarse grained permeability tensor necessary to construct A? is based\non the transmissivitie defined in [115], as ??? = ???? ??? in the ?-direction, where ?? and ?? are\nthe width and height of a grid cell. The ? ??? component is taken as,\n\n1\n? ???\n\n=\n??\n\n?\n\n1??\n? ???(?, ?)\n\n,\n\nwhere the sum is over fine cells contained within a coarse cell, and ? and ? are the indices corres-\nponding to the ?- and ?-directions, respectively. ? ??? is constructed in the same way, but with the\nsums over ? and ? interchanged.\n\n101\n\n\n\nB.3.3 A combined domain decomposition with mixed fiment method\nformulation for diffusion\n\nThe numerical solution of the diffusive transport system (B.1.3), can also be obtained by\napplying a mixed hybrid finite element method for the spatial discretization combined with a\nimplicit backward Euler strategy. Here we will describe the key features of the implementation.\nIndeed, some variations of this approach were discussion in [70, 7, 2, 87], but here we have a\nnovelty related fo the discontinuous fractional flow function induced by the modelling hysteresis\nin the flow.\n\nFirst, we redefine Eq.(B.1.3) by setting w? = ?(??, x, ?)???, where the term ?(??, x, ?) =\n?? (x) [?? (??) (1 ? ??)] ?????? . Then, the diffusive-stage equation is given on the ?\n\n??-element by,\n\n??\n??+1?,? ? ??,?\n\n???\n?\n\n1\n?\n\n[?\n??+1?? + ?\n\n?+1\n??\n\n+ ??+1?? + ?\n?+1\n??\n\n]?\n= 0, (B.3.9)\n\n(1 + ??? ???) ??+1?? + ??? ?\n?+1\n?,? = ??? ??? ????? + ??? ????? , (B.3.10)\n\nwhere ??? ,???? = 2???(???, ?)/?, ???(???, ?) ? ?? eff ?,?? as will described bellow. The superscript?? and the subscript ?? denote variables on adjacent elements and, for simplicity of notation, the\ntime index ? + 1 is suppressed on ??? and on the right-hand side of Eq.(B.3.10). If the capillary\npressure function ??(??) on the diffusive term w? is independent of ?, similar consistency relations\nused in the pressure-velocity discretization lead to the relations:\n\n?? = ???? , ?? + ????? = 0, ? = ?, ?, ?, ?. (B.3.11)\n\nMoreover, ?? ? ? ?? , and w ? ? ?? are allowed to be discontinuous across each ??? [12]. As a\nconsequence, it is needed to define an interface transmission condition to the diffusive fluxe w?.\nThus, it follows from bellow equations,\n\n?? =\n2\n?\n\n???(??, ?, ?)(?? ? ???), ????? =\n2\n?\n\n???? (??, ???, ???)(?? ? ? ????? ),\n\nthat\n?\n\n? eff ?,?? =\n2 ??? ????\n??? + ????\n\n, ? = ?, ?, ?, ?. (B.3.12)\n\nBecause the domain decomposition into individuals elements ?? of the finite element method\nlocalizes the computations it is then natural as well as advantageous to let them be difined on each\ninterface in terms of local properties of the medium (?(x), ?(x)), saturation ?? and hysteresis\nparameter ?. A dimension analysis of the diffusive Robin transmission condition at the interfaces\nof each element leads to the choice:\n\n??? =\n?\n\n?\n? eff ?,??\n\n. (B.3.13)\n\nFinally, we also use an ordinary checkboard ordening \u2013 as used in [2, 7, 70] \u2013 to separate the\nsubdomains into \u201cred\u201d and \u201cblack\u201d subsets in order the achieve a faster convergence.\n\n102\n\n\n\nB.4 Two-dimensional numerical experiments\nOur main concern is to justify the new numerical approach. To this end, we consider the\n\nclassical slab and 1/4 of five-spot geometries as test cases. For the experiments we also consider a\nslab geometry with barriers. The algorithm was implemented in pure C language programing and\nall its experiments were made in a basic laptop with a intel processor i3 2.53 GHz and 4 MB of\nRAM.\n\nFor the numerical experiments presented in this work we consider scalar, log-normal permeabi-\nlity fields ?(x) as a model for multiscale rock heterogeneity, so that ?(x) = log ?(x) is Gaussian\nand its distribution is determined by its mean and covariance function, where the absolute perme-\nability is given by ?(x) = ?0???(x), and ?0 is a constant, and 0 &lt;? ? 1 is a scaling factor [96,\n2].\n\nB.4.1 Numerical experiments with hysteresis and slab geometry\nWe are setting up to calculate the complete two-phase flow problem with hysteresis, as described\n\nin Section B.2, along with,\n\n??(??) = ?2?, ?\n?\n? (??) = (1 ? ??)\n\n3 and ??? (??) = (1 ? ??)\n2. (B.4.1)\n\nEach scanning permeability curve is a straight line in the (??, ?)-plane through the point (1/?, 0),\nand is given by [27],\n\n???? (??, ?) =\n(1 ? ?)2\n\n(1 ? ? ?)\n(1 ? ???) . (B.4.2)\n\nFollowing [27], we take ? = 0.5 and ? = 0.00015 in the numerical experiments. The water fractional\nflow function ? (??, ?) is expressed by (B.4.1)-(B.4.2),\n\n? (??, ?) =\n?? (??) /??\n\n?? (??) /?? + ???? (??, ?) /??\n, (B.4.3)\n\nand the capillary pressure function is given by ?? = 5? ? (2 ? ??) (1 ? ??), where ? ? is a characte-\nristic pressure which we take to be 1.18215\u00d7105 Pa, so that the corresponding dimensionless value\n1/Peclet, is of order 10?3 for two-phase flow. We take ?? = 1.0 cP and ?? = 0.5 cP. The initial\ncondition corresponds to the Riemann problem with initial discontinuity at ? = 0.3 \u00d7 ? ? [0, ? ]\nseparating the states (??? , ??) = (0.7, 0.8) and (??? , ??) = (0.3, 0.4), which both lie inside the\nscanning region. The two-dimensional simulation results for the SHMR with the maximally split\nversion of the operator splitting algorithm (see Section B.2) are in a very good accordance with the\none-dimensional solutions [12] and are shown in the bottom frames in Figure B.1. Notice the 1D\nwave structure of lateral projections obtained from 2D numerical simulations agree very well with\npreliminary 1D analytical solutions (solid lines) [27, 12]. For the two-dimensional experiments, in\nFigure B.1) we have used the following CFL condition [12]:\n\n???&lt;\n1\n\n2?\n\n[?\nmax\n\n?? ?[0,1]\n\n{?\n? ?(??, ?) ??\n\n??\n,\n\n? ?(??, ?) ??\n??\n\n}?]??1\n, (B.4.4)\n\n103\n\n\n\nwhere the variables ?? and ?? (i.e., v = (??, ??)) are related to the two-dimensional pressure-\nvelocity problem (B.2.1) presented in Section B.2; we remark that the subscripts ? and ? do not\ndenote derivatives.\n\nWe use the same multiscale field ?(x) to construct a variable porosity field ?(x) ?(x) = ? +\n??(x), ? > 0, where ? = 0.2 and the normalizing factor ? is chosen so that 0.05 ? ?(x) ? 0.35.\nThen, we have both synthetic models of permeability and porosity that resemble to the same\ngeological properties [7, 2] of the porous medium for our numerical experiments.\n\n0 0,1 0,2 0,3 0,4 0,5 0,6 0,7 0,8 0,9 1\n\nPOSITION   ( FIXED TIME )\n\n0\n\n0,1\n\n0,2\n\n0,3\n\n0,4\n\n0,5\n\n0,6\n\n0,7\n\n0,8\n\nW\nA\n\nT\nE\n\nR\n S\n\nA\nT\n\nU\nR\n\nA\nT\n\nIO\nN\n\n    1 m\n  32 m\n  64 m\n  96 m\n128 m\n 1D\n\n0,56\n\n0,0\n\n0,7\n\n0,773\n\nFigura B.1: Water saturation pictures are shown as function of distance in a grid refinement study\n256 \u00d7 128 (top) and 1024 \u00d7 512 cells, for a horizontal two-dimensional reservoir with aspect\nratio ?/? = 4. Bottom frame show ??direction longitudinal sections for water saturartion with\nhysteresis. Note that the interplay between nonlinearity and heterogeneity from porosity and\npermeability seems not to modify the wave pattern (or wave sequence) in comparison with case of\none-dimensional space. Similar results were observed for the oil saturation since ?? + ?? = 1.\n\n104\n\n\n\n 0\n\n 0.125\n\n 0.25\n\n 0.375\n\n 0.5\n\n 0.625\n\n 0.75\n\n 0.875\n\n 1\n\n 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1\n\ny-\nd\n\nir\ne\n\nct\nio\n\nn\n\nx-direction\n\n 0\n\n 0.125\n\n 0.25\n\n 0.375\n\n 0.5\n\n 0.625\n\n 0.75\n\n 0.875\n\n 1\n\n 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1\n\ny-\nd\n\nir\ne\n\nct\nio\n\nn\n\nx-direction\n\n 0\n\n 0.125\n\n 0.25\n\n 0.375\n\n 0.5\n\n 0.625\n\n 0.75\n\n 0.875\n\n 1\n\n 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1\n\ny-\nd\n\nir\ne\n\nct\nio\n\nn\n\nx-direction\n\n 0\n\n 0.125\n\n 0.25\n\n 0.375\n\n 0.5\n\n 0.625\n\n 0.75\n\n 0.875\n\n 1\n\n 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1\n\ny-\nd\n\nir\ne\n\nct\nio\n\nn\n\nx-direction\n\n 0\n\n 0.125\n\n 0.25\n\n 0.375\n\n 0.5\n\n 0.625\n\n 0.75\n\n 0.875\n\n 1\n\n 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1\n\ny\n\nx\n\nFigura B.2: On the left (resp. right) column is shown the pressure (resp. velocity) field for several\ngeometries. We take ? = 2 for heterogeneous reservoir simulation problems.\n\n105\n\n\n\nB.4.2 Purelly Poisson pressure-velocity numerical experiments\n\nHere we are interesting to the application of the multigrid multiscale preconditioner method\ndiscussed in Section B.3.2 for the discretized purely Poisson-elliptic problem (B.2.1). For simplicity\nwe take ?? = 0 and ? = 1 to the Poisson pressure-velocity equation (B.2.1) as discussed in\n[115], which in turn we consider two-dimensional flows in a rectangular domain [0, ?] \u00d7 [0, ? ],\nheterogeneous horizontal reservoir with no gravity effects fo the flow. Simulations were performed\nfor both homogeneous and heterogeneous reservoirs; see pictures in Figure B.2. The spatially\nvariable permeability field is defined on a 1024 \u00d7 1024 grid with the value of the coefficient of\nvariation ?? = 2. We use 5 grid levels for the multiscale algorithm and a scale factor of 4 between\ncoarsenings. We set the root mean squared residual as the criterion for convergence of the PCG\nand set the tolerance as 10?07.\n\nFive-spot geometry\n\nWe first simulate the pressure-velocity problem on a 1/4 of five-spot; see first (homogeneuous)\nand third (heterogeneous) rows in Figure B.2. Assume the reservoir to have dimensions 1024m\n\u00d7 1024m, and blocks with size of 1m \u00d7 1m. A fluid is injected into the reservoir at the lower\nleft corner at a uniform rate of 10?07 and production takes place at the top right corner fluid\nat rate ?10?7; no flow is allowed along all the boundaries of the reservoir. We set ? = 2 and\n?0 = 1 for heterogeneous reservoirs (third row in Figure B.2) and ? = 0 and ?0 = 10?06 for the\nhomogeneous case (first row in Figure B.2). The pressure (left column) and velocity fields (right\ncolumn) are presented in Figure B.2. In addition, we can see in Table B.1 and Table B.2 that\nit was necessary only 1 iteration of the conjugate gradient method in the finest level. The root\nmean squared residual norm was reduced to less then 10?10. All three experiments took about 10\nminutes to converge.\n\nSlab geometry\n\nFor the slab geometry, the boundary condition the Poison pressure-velocity like-problem (B.2.1)\nare as follows: no flow is allowed along the boundaries at the top and bottom of the reservoir;\na reference pressure ? = 0 (at the infinity [70] to better account to viscous fingering effects) is\nspecified along the boundary on the right. We set a flow of value ? = 1 at the left boundary\nfor the homogeneous (second row of Figure B.2) and heterogeneous (fourth row of Figure B.2)\nreservoir. The parameters used for the reservoir are the same as the 1/4 of 5-spot experiments.\nOn the bottom of Figure B.2 is displayed the slab simulations along with barriers. Notice that\nwe were able capture with good accuracy the main pattern of the flow through the barriers with\nlow permeability values of 10?06 and 10+06 otherwise. Again, the Figure B.2 shows the pressure\n(left column) and velocity fields (right column). It was necessary 3 iterations on the finest level\nfor the convergence of the homogeneous case with computational time around 10 minutes. In the\nheterogeneous slab problem and the slab problem with barriers took 9 and 8 iterations, respectively,\nand about 50 minutes to reach convergence in each test problem. The root mean squared residual\nwas reduced to 10?08 in all cases. See also Table B.1 and Table B.2.\n\n106\n\n\n\nQuarter of five-spot problem:\nLevel Dim. ? = 0 ? = 2\n\n1 4 \u00d7 4 16 16\n2 16 \u00d7 16 8 8\n3 64 \u00d7 64 4 4\n4 256 \u00d7 256 2 2\n5 1024 \u00d7 1024 1 1\n\nSlab problem:\nLevel Dim. ? = 0 ? = 2 barr.\n\n1 4 \u00d7 4 38 134 192\n2 16 \u00d7 16 19 67 96\n3 64 \u00d7 64 10 36 53\n4 256 \u00d7 256 5 21 34\n5 1024 \u00d7 1024 3 9 8\n\nTabela B.1: The top table shows the accumulated iterations of the multiscale algorithm for the 1/4\nof five-spot with homogeneous permeability and heterogeneous permeability field, with ? = 2. The\nbottom table shows the accumulated iterations of the multiscale algorithm for the slab problem with\nhomogeneous permeability, along with ? = 2 for the heterogeneous permeability field.\n\n5-spot: ?r?2 ?r?? ?r?2/\n?\n\n??\n? = 0 3.0882e-10 2.1823e-10 9.5369e-13\n? = 2 1.5481e-08 1.0773e-08 4.7808e-11\n\nSlab: ?r?2 ?r?? ?r?2/\n?\n\n??\n? = 0 7.8315e-07 2.2862e-08 2.4185e-09\n? = 2 1.4170e-05 2.7802e-06 4.3758e-08\nbarr. 7.1256e-06 1.1176e-07 2.2005e-08\n\nTabela B.2: The top table shows the residual norms for the 1/4 of five-spot problems; we take\n? = 2 for the heterogeneous simulation problem. The bottom table shows the residual norms. ??\nis the number of elements.\n\nB.5 Concluding remarks\nIn this paper we discussed a computational method for modeling hysteresis in porous media\n\nflow via relaxation by means of an operator splitting numerical strategy. For concreteness we\nconsidered a hysteresis incompressible two-phase flow relaxation system in porous media, a rele-\nvant problem very common in waterflooding of reservoirs. To address this problem we describe a\nnumerical method based on an operator splitting technique for the numerical solution of the gover-\nning system of PDEs modeling two-phase, immiscible two-phase flow problems in two-dimensional\nheterogeneous porous media with hysteresis. A combined mixed discretization of locally conserva-\ntive finite volume and mixed finite techniques was applied to tackle the Poisson problem (B.2.1).\nIn particular, both the multiscale multigrid method with a conjugate gradient method (to solve\nthe Poisson problem) as well as the red-black iterative domain decomposition method with mixed\nfinite element (to solve the diffusion problem) were able to give very good numerical solutions\nfor distinct transport problems in fluid dynamics in homegeneuous and heterogeneous two-space\ndimensions in order demonstrate the viability of the proposed formulation. Modelling hysteresis\nin porous media flow is relevant for instance in the numerical simulation framework for modeling\nCO2 sequestration operations in large-scale heterogeneous formations, such as deep saline aquifers\nand depleted oil and gas reservoirs.\n\n107\n\n\n\n108\n\n\n\tAgradecimentos\n\tIntrodu\u00e7\u00e3o\n\tMotiva\u00e7\u00e3o da pesquisa\n\tObjetivos espec\u00edficos e proposta de trabalho\n\tTemas desenvolvidos e resultados obtidos\n\tOrganiza\u00e7\u00e3o da disserta\u00e7\u00e3o\n\n\tModelagem matem\u00e1tica de fluxos multif\u00e1sicos em meios porosos heterog\u00eaneos\n\tEqua\u00e7\u00f5es fundamentais de escoamento com duas e tr\u00eas fases\n\tModelo de escoamento de tr\u00eas fases com gravidade\n\tModelo de escoamento de duas fases com gravidade\n\tModelo de escoamento de duas fases com gravidade e histerese\n\n\tO modelo do tra\u00e7ador passivo e da press\u00e3o global\n\tTra\u00e7ador passivo\n\tA formula\u00e7\u00e3o da press\u00e3o global\n\n\n\tModelagem computacional das equa\u00e7\u00f5es governantes em fen\u00f4menos de transporte em meios porosos heterog\u00eaneos\n\tDecomposi\u00e7\u00e3o de operadores\n\n\tAproxima\u00e7\u00e3o num\u00e9rica das equa\u00e7\u00f5es diferenciais parciais governantes\n\tDiscretiza\u00e7\u00e3o do sistema parab\u00f3lico e hiperb\u00f3lico de EDPs associado ao problema de transporte de convec\u00e7\u00e3o-difus\u00e3o\n\tDiscretiza\u00e7\u00e3o por elementos finitos mistos da EDP el\u00edptica associada ao problema de press\u00e3o e velocidade\n\tElementos Finitos Mistos H\u00edbridos\n\tEqua\u00e7\u00f5es discretas e elimina\u00e7\u00e3o do multiplicadores de Lagrange e fluxos.\n\n\n\tResolu\u00e7\u00e3o do sistema linear associado ao problema el\u00edptico\n\tGradientes Conjugados\n\tPrecondicionadores\n\n\tO M\u00e9todo Multigrid\n\tM\u00e9todos de relaxa\u00e7\u00e3o e a propriedade de smoothing\n\tA estrutura do M\u00e9todo Multigrid\n\tO Multigrid como Pr\u00e9-condicionador\n\tOutra maneira de derivar o pr\u00e9-condicionador multigrid\n\n\tGradientes conjugados com pr\u00e9-condicionador multiescala recursivo\n\tImplementa\u00e7\u00e3o do m\u00e9todo dos gradientes conjugados com pr\u00e9-condicionador multiescala recursivo\n\tAproxima\u00e7\u00e3o da permeabilidade na malha\n\tSmoother\n\tOperadores de Restri\u00e7\u00e3o e Prolonga\u00e7\u00e3o\n\tCrit\u00e9rio de Parada\n\n\n\tExperimentos num\u00e9ricos para problemas el\u00edpticos de Poisson em geometrias de aplica\u00e7\u00f5es\n\tPress\u00e3o-fluxo slab Dirichlet-Dirichlet\n\tFluxo slab Neumann-Dirichlet\n\tGeometria 1/4 de five-spot\n\n\tConclus\u00f5es e Perspectivas\n\tConclus\u00f5es\n\tPerspectivas\n\tConsidera\u00e7\u00f5es finais\n\n\tRefer\u00eancias\n\tElimina\u00e7\u00e3o dos multiplicadores de Lagrange\n\tA computational multiscale approach for incompressible two-phase flow in heterogeneous porous media including relative permeability hysteresis\n\tIntroduction\n\tComputational Modeling with Hysteresis\n\tContinuous-time mixed finite element approximations to the Ellipitc and Parabolic problems\n\tDiscretization of the Poisson-elliptic problem\n\tA multigrid multiscale preconditioner method for the discretized coupled nonlinear Poisson-elliptic problem\n\tA combined domain decomposition with mixed fiment method formulation for diffusion\n\n\tTwo-dimensional numerical experiments\n\tNumerical experiments with hysteresis and slab geometry\n\tPurelly Poisson pressure-velocity numerical experiments\n\n\tConcluding remarks"}]}}}