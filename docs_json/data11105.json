{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.14877"}, {"@name": "filename", "#text": "21263_Perles_LuisAugusto_M.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "Universidade Estadual de Campinas\n\nInstituto de F\u00edsica \"Gleb Wataghin\"\n\nC\u00e1lculo da Dose de Radia\u00e7\u00e3o Atrav\u00e9s de Convolu\u00e7\u00f5es em\n\nMeios Heterog\u00eaneos para Aplica\u00e7\u00f5es em Radioterapia\n\nLu\u00eds Augusto Perles\n\nOrientadora: Profa. Dra. Carola Dobrigkeit Chinellato\n\nMaio de 2001\n\n\n\n\n\nAgradecimentos\n\nAgrade\u00e7o ao S\u00e9rgio e a Ros\u00e2ngela da f\u00edsica m\u00e9dica do CEB por todo o apoio recebido. Ao\n\npessoal da radioterapia do CAISM pela recep\u00e7\u00e3o e valorosas discuss\u00f5es: M\u00e1rcio, N\u00faria,\n\nJos\u00e9 Garcia, Fernanda, Andr\u00e9, etc. Ao Fred, por ter escaneado e enviado (por e-mail!) um\n\nvalios\u00edssimo artigo. \u00c0 Patr\u00edcia (USP - Ribeir\u00e3o Preto) por possuir e emprestar o tal artigo.\n\nAgrade\u00e7o ao Wilson e ao M\u00e1rio da Inform\u00e1tica do CEB e do CCJDR do IFGW, respec-\n\ntivamente, pela valiosa ajuda.\n\nAgrade\u00e7o tamb\u00e9m ao professor L\u00facio (DMA - IMECC) pela importante ajuda com as\n\nFFT's.\n\nE, em especial, desejo expressar minha enorme gratid\u00e3o aos meus dois orientadores: \u00e0\n\nprofessora Carola (DRCC - IFGW) e ao Jos\u00e9 Renato O. Rocha da radioterapia do CAISM\n\npela dedica\u00e7\u00e3o e apoio dispensados.\n\niv\n\n\n\nResumo\n\nNesta disserta\u00e7\u00e3o de mestrado apresentamos o estudo sobre uma t\u00e9cnica de convolu\u00e7\u00e3o\n\npara o c\u00e1lculo da distribui\u00e7\u00e3o da dose de radia\u00e7\u00e3o usada em teleterapia. Este m\u00e9todo\n\ndecomp\u00f5e em tr\u00eas parcelas a distribui\u00e7\u00e3o da energia absorvida pelo meio: uma devida\n\n\u00e0 dose do espalhamento prim\u00e1rio, uma devida \u00e0 dose do espalhamento secund\u00e1rio e uma\n\nterceira, devida aos espalhamentos de ordens superiores. Mostramos todo o desenvolvimento\n\nte\u00f3rico do m\u00e9todo de c\u00e1lculo da dose de radia\u00e7\u00e3o por convolu\u00e7\u00f5es para meios homog\u00eaneos e\n\nheterog\u00eaneos, onde os tecidos moles s\u00e3o tratados todos como tendo a mesma se\u00e7\u00e3o de choque\n\nque a \u00e1gua. As heterogeneidades s\u00e3o tratadas como de densidades diferentes da \u00e1gua, por\u00e9m\n\ncom a mesma se\u00e7\u00e3o de choque da \u00e1gua. As fun\u00e7\u00f5es de transporte de el\u00e9trons e f\u00f3tons foram\n\nsimuladas no EGS4.\n\nFizemos os c\u00e1lculos para a energia do 60Co e os resultados apresentaram uma boa con-\n\ncord\u00e2ncia quando comparados a resultados experimentais e simulados para campos de at\u00e9\n\n10 ? 10 cm2 a uma profundidade de 26 cm. Com o aumento das dimens\u00f5es do campo, a\nprofundidade em que h\u00e1 con?abilidade reduz-se. Este fato se deve ao espa\u00e7o limitado em\n\nque o programa EGS4 realiza as simula\u00e7\u00f5es dos transportes de f\u00f3tons de altas ordens de\n\nespalhamento.\n\nO programa desenvolvido para o c\u00e1lculo da distribui\u00e7\u00e3o de dose de radia\u00e7\u00e3o nesta tese\n\ntem por objetivo servir de base para outros estudos e pesquisas relativas \u00e0 aplica\u00e7\u00e3o deste\n\nm\u00e9todo e tamb\u00e9m poder\u00e1 ser usado no dia-a-dia da radioterapia ap\u00f3s os devidos testes de\n\ncon?abilidade.\n\nv\n\n\n\nvi\n\n\n\nAbstract\n\nIn this thesis we have applied the convolution techniques to calculate the three dimensional\n\n(3D) dose distribution to be used in teletherapy. The convolution method spans the total\n\ndose in three parts: one due to the energy released by charged particles produced at the ?rst\n\ncollisions, one due to the energy released by the ?rst scattered photons, and the last one due\n\nto photons of higher order scattering. We have shown up the theoretical development for\n\nhomogeneous and inhomogeneous media. Cross sections of tissues have been approximated\n\nto water like. Heterogeneities are supposed to have the same cross sections as water and\n\ntheir densities have been treated as weight for the dose computations. Electron and photon\n\nfunctions were simulated in a previous step using EGS4.\n\nWe have done the calculations for 60Co energy and the results have shown good agree-\n\nment with experimental data sets for ?elds less than 10?10 cm2 at 26 cm depth. For larger\n?elds the depth of agreement was reduced. We have associated this fact to the limitation of\n\nsimulation steps, during transport of photons of higher order scattering.\n\nThe aim of the software developed to calculate the radiation dose distribution in this the-\n\nsis is to be the basis for other studies and researches related. The appliance in radiotherapy\n\nroutine will be evaluated after con?ability tests.\n\nvii\n\n\n\nviii\n\n\n\nSum\u00e1rio\n\nAgradecimentos iv\n\nResumo v\n\nAbstract vii\n\n1 Introdu\u00e7\u00e3o 1\n\n2 A teoria do c\u00e1lculo da dose por convolu\u00e7\u00e3o para meios homog\u00eaneos e\n\nheterog\u00eaneos 5\n\n2.1 A distribui\u00e7\u00e3o espacial da dose . . . . . . . . . . . . . . . . . . . . . . . . . . 5\n\n2.2 O modelo te\u00f3rico . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7\n\n2.3 A ?u\u00eancia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9\n\n2.4 O c\u00e1lculo da dose para meios homog\u00eaneos . . . . . . . . . . . . . . . . . . . . 10\n\n2.4.1 A dose prim\u00e1ria . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10\n\n2.4.2 A dose secund\u00e1ria . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n\n2.4.3 A dose de m\u00faltiplo espalhamento . . . . . . . . . . . . . . . . . . . . . 15\n\n2.4.4 A dose total . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n\n2.5 O c\u00e1lculo da dose para meios heterog\u00eaneos . . . . . . . . . . . . . . . . . . . . 21\n\n2.5.1 A dose prim\u00e1ria . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22\n\n2.5.2 A dose secund\u00e1ria . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22\n\n2.5.3 A dose de m\u00faltiplo espalhamento . . . . . . . . . . . . . . . . . . . . . 27\n\n2.5.4 A dose total . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n\n3 Simula\u00e7\u00e3o por Monte Carlo 33\n\n3.1 O programa de simula\u00e7\u00e3o EGS4 . . . . . . . . . . . . . . . . . . . . . . . . . . 33\n\n3.2 O processo de simula\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34\n\n3.2.1 A simula\u00e7\u00e3o dos processos f\u00edsicos . . . . . . . . . . . . . . . . . . . . . 37\n\nix\n\n\n\n3.3 Simulando os n\u00facleos de deposi\u00e7\u00e3o de energia . . . . . . . . . . . . . . . . . . 39\n\n3.3.1 O M\u00e9todo usado nas simula\u00e7\u00f5es . . . . . . . . . . . . . . . . . . . . . . 40\n\n3.3.1.1 A geometria e as t\u00e9cnicas utilizadas . . . . . . . . . . . . . . 40\n\n3.3.1.2 Os par\u00e2metros da simula\u00e7\u00e3o . . . . . . . . . . . . . . . . . . 42\n\n3.3.1.3 A contabiliza\u00e7\u00e3o da energia depositada . . . . . . . . . . . . 43\n\n3.3.1.4 N\u00facleo prim\u00e1rio . . . . . . . . . . . . . . . . . . . . . . . . . 43\n\n3.3.1.5 N\u00facleo secund\u00e1rio . . . . . . . . . . . . . . . . . . . . . . . . 43\n\n3.3.1.6 N\u00facleo de m\u00faltiplo espalhamento . . . . . . . . . . . . . . . . 45\n\n4 O M\u00e9todo Num\u00e9rico 47\n\n4.1 O c\u00e1lculo computacional da dose . . . . . . . . . . . . . . . . . . . . . . . . . 47\n\n4.2 A matriz da ?u\u00eancia prim\u00e1ria . . . . . . . . . . . . . . . . . . . . . . . . . . . 48\n\n4.2.1 A implementa\u00e7\u00e3o computacional . . . . . . . . . . . . . . . . . . . . . 49\n\n4.3 Convolu\u00e7\u00e3o via FFT . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50\n\n4.3.1 A Transformada de Fourier R\u00e1pida . . . . . . . . . . . . . . . . . . . . 51\n\n4.3.1.1 Os Teoremas da Amostragem . . . . . . . . . . . . . . . . . . 52\n\n4.3.2 Convolu\u00e7\u00e3o de duas fun\u00e7\u00f5es ?nitas . . . . . . . . . . . . . . . . . . . . 53\n\n4.3.2.1 O deslocamento dos dados . . . . . . . . . . . . . . . . . . . 53\n\n5 Resultados e Discuss\u00f5es 55\n\n5.1 Os n\u00facleos de deposi\u00e7\u00e3o de energia . . . . . . . . . . . . . . . . . . . . . . . . 55\n\n5.1.1 O n\u00facleo de deposi\u00e7\u00e3o de energia prim\u00e1ria . . . . . . . . . . . . . . . . 55\n\n5.1.1.1 Os limites de resolu\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . 56\n\n5.1.2 O n\u00facleo de deposi\u00e7\u00e3o de energia secund\u00e1ria . . . . . . . . . . . . . . . 58\n\n5.1.3 O n\u00facleo de deposi\u00e7\u00e3o de energia devido ao m\u00faltiplo espalhamento\n\ndos f\u00f3tons . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61\n\n5.2 Os c\u00e1lculos da dose de radia\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . 61\n\n5.2.1 Os testes em meios homog\u00eaneos . . . . . . . . . . . . . . . . . . . . . . 64\n\n5.2.1.1 Compara\u00e7\u00e3o com as medidas feitas no CAISM . . . . . . . . 64\n\n5.2.1.2 Compara\u00e7\u00e3o com o programa PLATO . . . . . . . . . . . . . 79\n\n5.2.2 Os testes em meios heterog\u00eaneos . . . . . . . . . . . . . . . . . . . . . 79\n\n5.2.2.1 Compara\u00e7\u00e3o com a simula\u00e7\u00e3o no EGS4 . . . . . . . . . . . . 79\n\n5.2.2.2 Compara\u00e7\u00e3o com o programa PLATO . . . . . . . . . . . . . 81\n\n6 Conclus\u00f5es 85\n\nx\n\n\n\nA Algumas de?ni\u00e7\u00f5es usadas nesta tese 87\n\nA.1 As de?ni\u00e7\u00f5es dadas pelo ICRU . . . . . . . . . . . . . . . . . . . . . . . . . . 87\n\nA.1.1 Radiometria . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87\n\nA.1.2 Coe?cientes de intera\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . 87\n\nA.1.3 Dosimetria . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89\n\nA.2 Erro relativo e absoluto . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90\n\nB Tabela de probabilidades de intera\u00e7\u00f5es do f\u00f3ton na \u00e1gua 91\n\nC Os testes e o c\u00f3digo fonte do programa que realiza os c\u00e1lculos 3D da dose 93\n\nC.1 A estrutura do programa de convolu\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . 93\n\nC.1.1 O c\u00f3digo fonte . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 94\n\nC.2 Os Testes da Fun\u00e7\u00e3o de Convolu\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . 108\n\nC.2.1 Teste 1D . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109\n\nC.2.2 Teste 2D . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109\n\nC.2.3 Teste 3D . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110\n\nD Altera\u00e7\u00f5es no programa XYZP para a gera\u00e7\u00e3o dos n\u00facleos de convolu\u00e7\u00e3o117\n\nD.1 ?For\u00e7ando? a primeira intera\u00e7\u00e3o do feixe . . . . . . . . . . . . . . . . . . . . . 117\n\nD.1.1 Os n\u00facleos de deposi\u00e7\u00e3o de energia . . . . . . . . . . . . . . . . . . . . 119\n\nE O PEGS 121\n\nF O Formato Padr\u00e3o dos Arquivos de Entrada e Sa\u00edda 123\n\nG As m\u00e1quinas usadas nas simula\u00e7\u00f5es e c\u00e1lculos num\u00e9ricos 125\n\nxi\n\n\n\nxii\n\n\n\nCap\u00edtulo 1\n\nIntrodu\u00e7\u00e3o\n\nA radioterapia tem fun\u00e7\u00e3o importante no tratamento contra o c\u00e2ncer. O f\u00edsico participa deste\n\ntratamento fazendo o planejamento da aplica\u00e7\u00e3o da radia\u00e7\u00e3o ionizante. O planejamento\n\nconsiste em ajustar o tamanho do campo de radia\u00e7\u00e3o, a posi\u00e7\u00e3o, dire\u00e7\u00e3o e quantidade de\n\nfeixes a serem usados. Para tomar estas decis\u00f5es, o f\u00edsico normalmente usa programas que\n\ncalculam a distribui\u00e7\u00e3o tridimensional (3D) da dose de radia\u00e7\u00e3o dentro do corpo do paciente\n\na ?m de concentrar o m\u00e1ximo da dose no alvo (tumor) e o m\u00ednimo poss\u00edvel nos tecidos sadios.\n\nEstes procedimentos exigem um bom programa de c\u00e1lculo da dose, por\u00e9m nos deparamos\n\ncom programas caros e que podem apresentar falhas. Este fato nos motivou a estudar os\n\nalgoritmos usados para os c\u00e1lculos 3D da dose e suas limita\u00e7\u00f5es. Nesta tese vamos apresentar\n\num algoritmo e sua respectiva implementa\u00e7\u00e3o computacional.\n\nO que torna o c\u00e1lculo da distribui\u00e7\u00e3o 3D da dose uma tarefa complicada \u00e9 que n\u00e3o\n\nconseguimos equacionar o transporte de energia analiticamente. Para facilitar a compreens\u00e3o\n\nda tese, vamos apresentar uma interpreta\u00e7\u00e3o para a de?ni\u00e7\u00e3o formal, dada no ap\u00eandice A,\n\nde dose de radia\u00e7\u00e3o e de uma outra grandeza tamb\u00e9m muito importante, o kerma1.\n\nQuando um f\u00f3ton atravessa um meio material, ele interage com os \u00e1tomos que formam\n\neste meio e lan\u00e7a part\u00edculas carregadas. O kerma \u00e9 a quantidade de energia cin\u00e9tica por\n\nunidade de massa que a part\u00edcula carregada (el\u00e9tron ou p\u00f3sitron) recebe no instante da\n\nintera\u00e7\u00e3o do f\u00f3ton com a mat\u00e9ria. Basicamente, uma parte desta energia cin\u00e9tica ser\u00e1 usada\n\npara a ioniza\u00e7\u00e3o dos \u00e1tomos e mol\u00e9culas do meio e a outra ser\u00e1 irradiada por bremsstrahlung\n\nou aniquila\u00e7\u00e3o de pares. A parcela do kerma que ioniza o meio chama-se kerma de colis\u00e3o\n\ne a que irradia, de kerma de radia\u00e7\u00e3o.\n\nEstas part\u00edculas carregadas que receberam um kerma de colis\u00e3o ir\u00e3o ionizar a mat\u00e9ria\n\n1Kerma vem do ingl\u00eas e signi?ca Kinetic Energy Released in the Medium; o a foi adicionado apenas por\nquest\u00f5es fon\u00e9ticas.\n\n1\n\n\n\nao longo de sua trajet\u00f3ria. Suponha, ent\u00e3o, um elemento de volume ?nito 4V sendo atra-\nvessado por estas part\u00edculas carregadas. A dose de radia\u00e7\u00e3o \u00e9 a parte do kerma de colis\u00e3o\n\nde todas as part\u00edculas que atravessam 4V e que \u00e9 convertida em ioniza\u00e7\u00e3o do meio nes-\nte elemento de volume. \u00c9 interessante notar que este 4V pode estar sendo atravessado\npor part\u00edculas carregadas que foram geradas nele pr\u00f3prio e por outras part\u00edculas que foram\n\ngeradas em elementos de volume vizinhos. A di?culdade em se determinar exatamente a\n\ndose est\u00e1 em descrever estes transportes das part\u00edculas carregadas (el\u00e9trons, p\u00f3sitrons, etc)\n\ne tamb\u00e9m das neutras (f\u00f3tons, n\u00eautrons, etc.) [1, 2]. Sobre este tema discutiremos mais no\n\ncap\u00edtulo seguinte.\n\nNa pr\u00e1tica, existem v\u00e1rias formas de se obter a distribui\u00e7\u00e3o aproximada da dose de ra-\n\ndia\u00e7\u00e3o. A mais simples \u00e9 a que se baseia no per?l de isodose medido na \u00e1gua e pode at\u00e9\n\nser feita gra?camente, sem o aux\u00edlio de computadores [1]. Este \u00e9 um m\u00e9todo aproximativo\n\nantigo, por\u00e9m ainda usado em determinados casos. Outra t\u00e9cnica \u00e9 a simula\u00e7\u00e3o por Monte\n\nCarlo do transporte e das intera\u00e7\u00f5es das part\u00edculas. Esta forma apresenta excelentes resul-\n\ntados, todavia o tempo computacional ainda \u00e9 extremamente elevado. O m\u00e9todo que ser\u00e1\n\ndescrito e aplicado nesta tese \u00e9 o de convolu\u00e7\u00e3o da ?u\u00eancia do feixe de f\u00f3tons que incide no\n\nmeio absorvedor com n\u00facleos de deposi\u00e7\u00e3o de energia. A fun\u00e7\u00e3o destes n\u00facleos \u00e9 de espalhar\n\no kerma de colis\u00e3o lan\u00e7ado pela ?u\u00eancia [3, 4].\n\nO objetivo desta tese \u00e9 iniciar o projeto de desenvolvimento de um programa para o\n\nc\u00e1lculo da dose de radia\u00e7\u00e3o atrav\u00e9s de convolu\u00e7\u00f5es para uso em teleterapia (radioterapia com\n\nfonte externa ao paciente). Inicialmente, o programa ser\u00e1 aplicado em pesquisa, podendo\n\nser adotado no planejamento dos tratamentos ap\u00f3s os testes necess\u00e1rios.\n\nA organiza\u00e7\u00e3o desta disserta\u00e7\u00e3o\n\nNo cap\u00edtulo 2 detalhamos dois modelos te\u00f3ricos para o c\u00e1lculo da distribui\u00e7\u00e3o da dose de\n\nradia\u00e7\u00e3o, sendo um para meios homog\u00eaneos e outro para heterog\u00eaneos. Neste cap\u00edtulo s\u00e3o\n\napresentados os modelamentos dos n\u00facleos de deposi\u00e7\u00e3o de energia.\n\nTais n\u00facleos ser\u00e3o simulados e as t\u00e9cnicas aplicadas s\u00e3o descritas no cap\u00edtulo 3.\n\nDescrevemos o m\u00e9todo num\u00e9rico usado para fazer a convolu\u00e7\u00e3o no cap\u00edtulo 4, onde\n\naplicamos as t\u00e9cnicas de transformada de Fourier r\u00e1pida.\n\nOs resultados s\u00e3o apresentados no cap\u00edtulo 5 onde comparamos o m\u00e9todo de convolu\u00e7\u00e3o\n\ncom simula\u00e7\u00f5es e com um programa comercial usado no planejamento de radioterapia pelo\n\nCAISM (Centro de Assist\u00eancia Integral a Sa\u00fade da Mulher, Unicamp), o Plato, da Nucletron\n\n[5].\n\nPor ?m, as conclus\u00f5es encontram-se no cap\u00edtulo 6, onde discutimos os caminhos do\n\n2\n\n\n\nprojeto do programa iniciado nesta disserta\u00e7\u00e3o.\n\nNo ap\u00eandice A est\u00e3o algumas das de?ni\u00e7\u00f5es da ICRU (International Commission on\n\nRadiation Units and Measurements). Nos ap\u00eandices seguintes encontramos informa\u00e7\u00f5es\n\nt\u00e9cnicas a respeito da programa\u00e7\u00e3o e caracter\u00edsticas dos equipamentos usados no desenvol-\n\nvimento desta disserta\u00e7\u00e3o.\n\n3\n\n\n\n4\n\n\n\nCap\u00edtulo 2\n\nA teoria do c\u00e1lculo da dose por\n\nconvolu\u00e7\u00e3o para meios homog\u00eaneos e\n\nheterog\u00eaneos\n\nEstamos interessados em obter um modelo matem\u00e1tico para o c\u00e1lculo da dose de radia\u00e7\u00e3o em\n\nmeios heterog\u00eaneos que possa ser usado no planejamento de um procedimento de teleterapia\n\npor cobalto 60\n?\n60Co\n\n?\n. Descreveremos neste cap\u00edtulo dois modelos te\u00f3ricos para o c\u00e1lculo\n\nda dose usando um m\u00e9todo que nos permite chegar a algumas integrais de convolu\u00e7\u00e3o [3, 4].\n\nNo primeiro modelo tratamos apenas da aplica\u00e7\u00e3o da radia\u00e7\u00e3o a meios homog\u00eaneos,\n\nj\u00e1 o segundo modelo \u00e9 uma extens\u00e3o do primeiro para meios heterog\u00eaneos. Ambos os\n\nmodelos s\u00e3o para radia\u00e7\u00e3o monoenerg\u00e9tica, mas podem ser facilmente estendidos para raios-\n\nX, discretizando-se o espectro em faixas de energias e realizando os c\u00e1lculos para cada faixa\n\nde energia em separado, e depois somando os resultados considerando o devido peso [6].\n\n2.1 A distribui\u00e7\u00e3o espacial da dose\n\nVamos prosseguir com o estudo da composi\u00e7\u00e3o da dose de radia\u00e7\u00e3o iniciado na introdu\u00e7\u00e3o\n\ndesta tese. Considere um elemento de volume discreto ?V pertencente a um meio material,\n\ncomo mostrado na ?gura 2.1. Nesta ?gura vemos v\u00e1rios processos de intera\u00e7\u00e3o da radia\u00e7\u00e3o\n\ncom a mat\u00e9ria ocorrendo. Os f\u00f3tons \n e \n00 interagem pelo processo Compton, \n0 por efeito\n\nfotoel\u00e9trico e \n000 por produ\u00e7\u00e3o de pares. Suponha que \n, \n00e \n000 sejam os f\u00f3tons provenientes\n\nde uma fonte de radia\u00e7\u00e3o monoenerg\u00e9tica externa ao meio. A dose absorvida em ?V ser\u00e1\n\ndada pela soma dos kermas de colis\u00e3o das part\u00edculas carregadas, como esquematizadas na\n\n5\n\n\n\n??\n\n??\u2019\u2019\n??\u2019 \u2019\n\n??\u2019 \u2019 \u2019\n\n??VV\n\nf\u00f3ton\nel\u00e9tron\n\np\u00f3sitron\n\nFigura 2.1: Um esquema ilustrando a composi\u00e7\u00e3o da dose de radia\u00e7\u00e3o.\n\n?gura 2.1, convertidos em ioniza\u00e7\u00e3o dentro do elemento de volume ?V . Vemos que a dose\n\nabsorvida neste elemento de volume \u00e9 devida a part\u00edculas carregadas que se originam no\n\npr\u00f3prio elemento de volume e tamb\u00e9m por part\u00edculas oriundas das c\u00e9lulas vizinhas. Este\n\nfato sugere que o transporte eletr\u00f4nico do kerma de colis\u00e3o possa ser modelado por meio\n\nde uma integral de convolu\u00e7\u00e3o. Observe, tamb\u00e9m, que como o f\u00f3ton \n0 foi gerado em\n\num elemento de volume relativamente distante de ?V , este fato sugere uma integral de\n\nconvolu\u00e7\u00e3o para o transporte fot\u00f4nico da dose.\n\nEstes processos que contribuem para a forma\u00e7\u00e3o da dose absorvida s\u00e3o de natureza\n\nestoc\u00e1stica e ocorrem em enorme quantidade, o que di?culta um modelamento mais preciso\n\ndo problema. Por este motivo a simula\u00e7\u00e3o computacional freq\u00fcentemente \u00e9 sugerida para\n\nresolver este problema, por\u00e9m o tempo utilizado por estas simula\u00e7\u00f5es ainda \u00e9 muito grande,\n\ninviabilizando o seu uso no planejamento das se\u00e7\u00f5es de radioterapia (este tema ser\u00e1 abordado\n\nno cap\u00edtulo 3). Como citamos anteriormente, a depend\u00eancia da dose absorvida em ?V de\n\noutros elementos de volume sugere a exist\u00eancia de integrais de convolu\u00e7\u00e3o para transportar\n\nel\u00e9trons e f\u00f3tons.\n\n6\n\n\n\n2.2 O modelo te\u00f3rico\n\nOs modelos te\u00f3ricos que vamos estudar aplicam-se principalmente a raios-\n com energia\n\nem torno de 1 MeV, em que o principal processo de intera\u00e7\u00e3o da radia\u00e7\u00e3o com a \u00e1gua \u00e9\n\no Compton (a tabela das probabilidades dos v\u00e1rios processos de intera\u00e7\u00e3o de f\u00f3tons com a\n\n\u00e1gua est\u00e1 no ap\u00eandice B).\n\n??\n\n??\u2019\u2019\n\n??\u2019 \u2019\nee??\u2019\u2019\n\nee??\n\nFigura 2.2: Esquema ilustrativo de uma seq\u00fc\u00eancia de espalhamentos Compton.\n\nSuponha uma hist\u00f3ria de um f\u00f3ton \n de energia inicial E0 que interage por processo\n\nCompton em um determinado meio absorvedor. O estado ?nal deste sistema ser\u00e1 composto\n\npor um f\u00f3ton \n0 de energia E0 e um el\u00e9tron e? de energia K, como mostrado na ?gura 2.2.\n\nEste el\u00e9tron ir\u00e1 depositar a sua energia cin\u00e9tica ao longo de sua trajet\u00f3ria e, eventualmente,\n\nemitir um ou mais f\u00f3tons por bremsstrahlung (n\u00e3o esquematizado).\n\nContinuemos a seguir o f\u00f3ton \n0 gerado no primeiro processo Compton. Este f\u00f3ton\n\npoderia, novamente, sofrer uma intera\u00e7\u00e3o Compton. Assim, o estado ?nal deste segundo\n\nsistema ?ca sendo um f\u00f3ton \n00 de energia E00 e um el\u00e9tron e?\n0\n\nde energia K0. Este el\u00e9tron ir\u00e1\n\ndepositar a sua energia cin\u00e9tica em forma de ioniza\u00e7\u00e3o ao longo da sua trajet\u00f3ria e tamb\u00e9m\n\npoderia gerar algum f\u00f3ton por bremsstrahlung.\n\nO f\u00f3ton \n00 termina sua hist\u00f3ria em mais alguns espalhamentos que podem, dependendo\n\nda sua energia, ser uma combina\u00e7\u00e3o dos efeitos Compton, produ\u00e7\u00e3o de pares e fotoel\u00e9trico,\n\npodendo at\u00e9 mesmo sair do meio absorvedor em quest\u00e3o. N\u00e3o estamos levando em conta o\n\nefeito Rayleigh por este n\u00e3o contribuir para a dose absorvida.\n\nEsta hist\u00f3ria \u00e9 a base do modelo proposto em [3, 4], que sup\u00f5e que todas as intera\u00e7\u00f5es\n\ndos f\u00f3tons sejam Compton, como mostrado na ?gura 2.3.\n\n7\n\n\n\nee??\n\nContribuem para a fonte do \nm\u00faltiplo espalhamento, s\n\nmm\n..\n\n??\npp??\n\nss\n\nFigura 2.3: Este \u00e9 o modelo te\u00f3rico proposto pelo esquema da ?gura 2.2, agora com uma\n?u\u00eancia associada aos f\u00f3tons. Por simplicidade, n\u00e3o representamos os el\u00e9trons a partir da\nsegunda intera\u00e7\u00e3o.\n\nA ?u\u00eancia de f\u00f3tons \u00e9 a raz\u00e3o entre o n\u00famero de part\u00edculas e a \u00e1rea, como de?nido\n\npela ICRU e apresentado no ap\u00eandice A. A ?u\u00eancia prim\u00e1ria ?p \u00e9 constitu\u00edda pelos f\u00f3tons\n\nque penetraram o meio absorvedor, s\u00e3o provenientes de uma fonte externa, e que ainda n\u00e3o\n\ninteragiram.\n\nO modelo a ser tratado nesta disserta\u00e7\u00e3o considera que os f\u00f3tons da ?u\u00eancia prim\u00e1ria\n\ninterajam somente por efeito Compton. Ap\u00f3s a primeira intera\u00e7\u00e3o, a dire\u00e7\u00e3o e a energia dos\n\nf\u00f3tons s\u00e3o dadas pela se\u00e7\u00e3o de choque Compton. Neste passo n\u00e3o temos mais uma ?u\u00eancia\n\nunidirecional e monoenerg\u00e9tica, o que pode di?cultar um pouco a sua descri\u00e7\u00e3o matem\u00e1tica.\n\nEsta ?u\u00eancia secund\u00e1ria ?s de f\u00f3tons est\u00e1 indicada na ?gura 2.3.\n\nConsideramos novamente que os f\u00f3tons que constituem a ?u\u00eancia secund\u00e1ria interajam\n\npor efeito Compton. Por\u00e9m descrever a ?u\u00eancia ap\u00f3s esta terceira colis\u00e3o seria muito com-\n\nplicado e desprezar estes f\u00f3tons signi?caria subestimar a dose total. Note que estes f\u00f3tons,\n\nap\u00f3s mais algumas colis\u00f5es, poderiam ser considerados como sendo provenientes de todo\n\no meio e tendo dire\u00e7\u00f5es aleat\u00f3rias. Assim, a solu\u00e7\u00e3o encontrada foi tratar os f\u00f3tons que\n\nconstituem a ?u\u00eancia ap\u00f3s a terceira colis\u00e3o como uma fonte a ser usada nos modelos de\n\ndifus\u00e3o, normalmente empregada para gases [3]. Desta forma, os f\u00f3tons provenientes da\n\nterceira colis\u00e3o ser\u00e3o tratados como a fonte sm na equa\u00e7\u00e3o da difus\u00e3o de Helmholtz [7, 8].\n\n8\n\n\n\nEstes s\u00e3o os conceitos do modelo te\u00f3rico que ser\u00e3o desenvolvidos e equacionados nas\n\nse\u00e7\u00f5es seguintes deste cap\u00edtulo.\n\n2.3 A ?u\u00eancia\n\nPara sabermos a dose em uma determinada regi\u00e3o no meio absorvedor precisaremos saber\n\nqual a quantidade e as caracter\u00edsticas dos el\u00e9trons que est\u00e3o atravessando esta regi\u00e3o. Estes\n\nel\u00e9trons foram postos em movimento por f\u00f3tons na regi\u00e3o em quest\u00e3o e nas suas proximida-\n\ndes.\n\nConsidere um esquema onde encontramos um tanque semi-in?nito contendo \u00e1gua como\n\nmeio absorvedor e um feixe monoenerg\u00e9tico de energia E0 cuja ?u\u00eancia na superf\u00edcie deste\n\nmeio \u00e9 denotada por ?0, como esquematizado na ?gura 2.4. Seja ?p a ?u\u00eancia de f\u00f3tons\n\nque atravessam o meio absorvedor, descrita como fun\u00e7\u00e3o da ?u\u00eancia da fonte na superf\u00edcie\n\n?0 como [6]:\n\n?p (\n?!r ) = ?0 (?!r0) ?\n\nj?!r0j2\nj?!r j2\n\n? exp\n?\n?\nZ r\nr0\n?\n??!\nl\n?\n? d?!l\n\n?\n(2.1)\n\nonde ?!r0 \u00e9 a dist\u00e2ncia da fonte \u00e0 superf\u00edcie do meio, tamb\u00e9m conhecida como SSD (source\nto surface distance), ?!r \u00e9 a dist\u00e2ncia da fonte ao ponto em que estamos interessados em\ncalcular a dose e ?\n\n??!\nl\n?\n\u00e9 o coe?ciente de atenua\u00e7\u00e3o linear do meio no ponto\n\n?!\nl . Note\n\nque nesta express\u00e3o para a ?u\u00eancia prim\u00e1ria o coe?ciente de atenua\u00e7\u00e3o linear ? depende da\n\nposi\u00e7\u00e3o, portanto esta express\u00e3o de ?p aplica-se tamb\u00e9m a meios heterog\u00eaneos.\n\nSe este feixe de f\u00f3tons atravessa um meio de coe?ciente de atenua\u00e7\u00e3o linear constante\n\n?, ent\u00e3o podemos simpli?car a express\u00e3o anterior para ser usada nos c\u00e1lculos para meios\n\nhomog\u00eaneos, equa\u00e7\u00e3o 2.2.\n\n?p = ?0 (\n?!r0) ?\n\nj?!r0j2\nj?!r j2\n\n? e???\n???!r ??!r0 0?? (2.2)\n\nPara efeito de modelamento te\u00f3rico da dose, n\u00e3o estamos considerando a diverg\u00eancia\n\ngeom\u00e9trica do feixe, pois em teleterapia esta diverg\u00eancia \u00e9 tipicamente desprez\u00edvel do ponto\n\nde vista da contribui\u00e7\u00e3o para a dose total. Voltaremos a discutir este assunto no cap\u00edtulo 4.\n\n9\n\n\n\nFigura 2.4: Esquema da geometria utilizada para descrever a ?u\u00eancia prim\u00e1ria ?p em um\nponto como fun\u00e7\u00e3o da ?u\u00eancia da fonte ?0.\n\n2.4 O c\u00e1lculo da dose para meios homog\u00eaneos\n\n2.4.1 A dose prim\u00e1ria\n\nA ?u\u00eancia prim\u00e1ria apresentada na equa\u00e7\u00e3o 2.2 transfere um kerma de colis\u00e3o1, chamado\n\nde kerma prim\u00e1rio Kp, descrito por [1]:\n\nKp (\n?!r0) = ?p (?!r ) ?\n\n?en (E0)\n\n?\n? E0 ? C (2.3)\n\nonde ?en \u00e9 o coe?ciente de absor\u00e7\u00e3o de energia at\u00f4mico e ? a densidade do material. ?en \u00e9\n\nderivado do coe?ciente linear como visto na equa\u00e7\u00e3o 2.4, dado em cm2=g [1, 2]. A ?u\u00eancia\n\nest\u00e1 em f?otons=cm2 e o kerma Kp est\u00e1 em gray (Gy). O fator C \u00e9 usado para converter o\n\nkerma para gray, sendo C = 1; 602 ? 10?10\nh\n\nGy\nMeV=g\n\ni\n.\n\nTemos ainda que\n\n?en (E0) = ? (E0)\nEtr\nE0\n\n(2.4)\n\nonde Etr \u00e9 a energia m\u00e9dia transferida para o meio em forma de ioniza\u00e7\u00e3o.\n\nOs el\u00e9trons resultantes da primeira colis\u00e3o s\u00e3o chamados prim\u00e1rios, assim a dose as-\n\nsociada ao kerma da equa\u00e7\u00e3o 2.3 ser\u00e1 chamada de dose prim\u00e1ria. Como apresentamos\n1A partir deste ponto vamos nos referir ao kerma de colis\u00e3o apenas como kerma, exceto quando haja\n\nmen\u00e7\u00e3o contr\u00e1ria.\n\n10\n\n\n\nanteriormente, um el\u00e9tron prim\u00e1rio ir\u00e1 depositar o seu kerma ao longo da sua trajet\u00f3ria,\n\nionizando o meio. Durante o seu trajeto, o el\u00e9tron sofre in\u00fameras colis\u00f5es onde ocorrem\n\ntrocas de energia e mudan\u00e7as de dire\u00e7\u00e3o aleat\u00f3rias. Este fato di?culta o modelamento te\u00f3-\n\nrico da convers\u00e3o do kerma em dose, mas sabemos que todo este kerma ser\u00e1 convertido\n\nem dose absorvida em algum ponto, e para tanto vamos supor uma fun\u00e7\u00e3o f (?!r ) que fa\u00e7a\nesta distribui\u00e7\u00e3o. Do fato de que todos os el\u00e9trons que receberam um kerma prim\u00e1rio ser\u00e3o\n\ntermalizados em algum ponto do meio, escrevemos que :Z Z Z\nV\nf\n??!r 0?dV 0 = 1 (2.5)\n\nAssim a express\u00e3o para a dose prim\u00e1ria ser\u00e1 dada por[3]:\n\nDp (\n?!r ) =\n\nZ Z Z\nV\n?p\n\n??!r 0? ? ?en\n?\n\n(E0) ? E0 ? c ? f\n??!r ? ?!r 0?dV 0 (2.6)\n\nInterpretamos a fun\u00e7\u00e3o f\n??!r ? ?!r 0? como a fra\u00e7\u00e3o do kerma lan\u00e7ado em ?!r 0 que \u00e9 trans-\n\nportado e transforma-se em dose no ponto ?!r . Vamos simpli?car a equa\u00e7\u00e3o anterior, para\n\nDp (\n?!r ) =\n\nZ Z Z\nV\n?p\n\n??!r 0? ? kp ??!r ? ?!r 0?dV 0 (2.7)\nA equa\u00e7\u00e3o 2.7 representa a dose prim\u00e1ria distribu\u00edda em todo o meio semi-in?nito de\n\n\u00e1gua, onde ?p (?!r ) \u00e9 a ?u\u00eancia prim\u00e1ria calculada em ?!r e kp\n??!r ? ?!r 0? \u00e9 o n\u00facleo de depo-\n\nsi\u00e7\u00e3o de energia prim\u00e1ria. Se estas duas fun\u00e7\u00f5es envolvidas nesta integral forem invariantes\n\npor deslocamento, a equa\u00e7\u00e3o 2.7 ser\u00e1 uma integral de convolu\u00e7\u00e3o.\n\nA fun\u00e7\u00e3o f (?!r ) pode ser conseguida por meio da simula\u00e7\u00e3o de Monte Carlo em um\nmeio homog\u00eaneo [3]. Desta forma f (?!r ) ser\u00e1, assim como ?p, invariante por deslocamento,\ntornando a equa\u00e7\u00e3o 2.7 uma convolu\u00e7\u00e3o.\n\nEmbora um dos pontos tratados nesta tese seja a simula\u00e7\u00e3o por Monte Carlo dos n\u00facleos\n\nde deposi\u00e7\u00e3o de energia, por hora desejamos obter uma vis\u00e3o mais f\u00edsica do problema da\n\nconvers\u00e3o do kerma em dose. Por isso vamos buscar uma outra aproxima\u00e7\u00e3o para a dose\n\nprim\u00e1ria.\n\nPara conseguirmos um n\u00facleo de deposi\u00e7\u00e3o de energia anal\u00edtico, ainda que aproximado,\n\nvamos introduzir mais uma grandeza radiol\u00f3gica: o stopping power. Esta quantidade nos\n\nmostra a taxa em que as part\u00edculas carregadas perdem sua energia cin\u00e9tica dE para a\n\nioniza\u00e7\u00e3o do meio ao longo de sua trajet\u00f3ria dx, e pode ser escrita assim: dE\ndx\n. Dividindo\n\nesta express\u00e3o pela densidade ? obtemos dE\n?dx\n\n, chamado de mass stopping power, que \u00e9\n\n11\n\n\n\naproximadamente independente da densidade do meio2. O stopping power depende da se\u00e7\u00e3o\n\nde choque total do meio material e da energia cin\u00e9tica da part\u00edcula carregada em quest\u00e3o.\n\nNas refer\u00eancias [1, 2] encontramos express\u00f5es anal\u00edticas para o stopping power.\n\nConsidere, ent\u00e3o, um elemento de volume dV 0 com ?e el\u00e9trons por unidade de volume,\n\nonde as part\u00edculas carregadas s\u00e3o lan\u00e7adas pelas intera\u00e7\u00f5es Compton de um feixe de f\u00f3tons\n\nmonoenerg\u00e9ticos. Desejamos saber a dose absorvida por um determinado elemento de vo-\n\nlume dV . Este elemento de volume centrado em ?!r est\u00e1 compreendido efetivamente em um\n\u00e2ngulo s\u00f3lido inversamente proporcional a\n\n???!r ? ?!r 0??2. Considere tamb\u00e9m a se\u00e7\u00e3o de choque\nCompton que forne\u00e7a o \u00e2ngulo m\u00e9dio de sa\u00edda do el\u00e9tron, dada na equa\u00e7\u00e3o 2.9. Podemos\n\ndescrever o n\u00facleo de deposi\u00e7\u00e3o de energia prim\u00e1ria, aproximadamente, por [4]:\n\nkp\n??!r ? ?!r 0? = ?e ? d?0\n\nd\n0\n??!r ? ?!r 0? ? dE\n\n?dx\n\n??!r ? ?!r 0? ? 1???!r ? ?!r 0??2 (2.8)\nsendo d?0=d\n0 a se\u00e7\u00e3o de choque Compton para os el\u00e9trons e dE\n\n?dx\no stopping power para\n\nos el\u00e9trons na \u00e1gua. O vetor ?!r ? ?!r 0 \u00e9 a dire\u00e7\u00e3o m\u00e9dia de sa\u00edda dos el\u00e9trons da intera\u00e7\u00e3o\nCompton. Note que a se\u00e7\u00e3o de choque Compton e o stopping power apenas necessitam do\n\n\u00e2ngulo ?0 de sa\u00edda do el\u00e9tron. A seguir temos a express\u00e3o para a se\u00e7\u00e3o de choque Compton\n\ncomo fun\u00e7\u00e3o do \u00e2ngulo m\u00e9dio de sa\u00edda dos el\u00e9trons [9]:\n\nd?0\n\nd\n0\n?\n?0\n?\n\n=\nd?\n\nd\n\n(?) ?\n\n?\n1\n\n1 + ?\n\n(1 + cos ?)sin?\n\nsin3 ?0\n\n?\n(2.9)\n\n?0 = cot?1\n?\n(1 + ?) tan\n\n?\n?\n\n2\n\n??\n(2.10)\n\n? =\nE0\nm0c2\n\n(2.11)\n\nonde ?0 \u00e9 o \u00e2ngulo do el\u00e9tron que foi lan\u00e7ado pela intera\u00e7\u00e3o Compton, e que se relaciona ao\n\n\u00e2ngulo ? de sa\u00edda do f\u00f3ton pela equa\u00e7\u00e3o 2.10, m0 \u00e9 a massa de repouso do el\u00e9tron e c \u00e9 a\n\nvelocidade da luz no v\u00e1cuo.\n\nO que apresentamos aqui \u00e9 uma aproxima\u00e7\u00e3o anal\u00edtica para o n\u00facleo de deposi\u00e7\u00e3o de\n\nenergia prim\u00e1ria considerando que todas as primeiras colis\u00f5es s\u00e3o do tipo Compton e assu-\n\nmindo que, na m\u00e9dia, a convers\u00e3o do kerma em ioniza\u00e7\u00e3o ocorre de acordo como a express\u00e3o\n\npara o stopping power. \u00c9 esperada uma boa concord\u00e2ncia em determinadas energias como\n\na do 60Co, por\u00e9m este modelo come\u00e7a a falhar em energias mais altas.\n\n2N\u00e3o estamos considerando o ?efeito densidade? [2].\n\n12\n\n\n\n2.4.2 A dose secund\u00e1ria\n\nQuando estamos em um meio cujo n\u00famero at\u00f4mico efetivo \u00e9 aproximadamente igual ao da\n\n\u00e1gua (ZH2O = 7; 51), o alcance pr\u00e1tico de um el\u00e9tron gerado por um f\u00f3ton de 1MeV \u00e9 de\n\n0,329 cm [1]. Na introdu\u00e7\u00e3o dissemos que a resolu\u00e7\u00e3o espacial em que estamos trabalhando \u00e9\n\nde 0,5 cm, portanto maior que o alcance da maioria dos el\u00e9trons energ\u00e9ticos. Mesmo assim,\n\n?zemos o modelamento do transporte dos el\u00e9trons prim\u00e1rios porque temos a inten\u00e7\u00e3o de\n\nque este modelo tenha boa concord\u00e2ncia em energias maiores.\n\nPor\u00e9m \u00e9 um pouco mais dif\u00edcil fazer esta mesma estimativa para o caso dos f\u00f3tons se-\n\ncund\u00e1rios, pois temos um espectro de energia de f\u00f3tons ap\u00f3s a primeira intera\u00e7\u00e3o. Sabemos\n\ntamb\u00e9m que estes f\u00f3tons secund\u00e1rios, possuem uma energia menor que os prim\u00e1rios, e, por-\n\ntanto, os el\u00e9trons gerados por estes f\u00f3tons secund\u00e1rios tamb\u00e9m ter\u00e3o um alcance pr\u00e1tico\n\nmenor que os prim\u00e1rios. Este fato sugere que podemos desconsiderar o transporte dos el\u00e9-\n\ntrons secund\u00e1rios e apenas considerar que eles depositam toda sua energia na mesma c\u00e9lula\n\nem que interagiram. O modelamento te\u00f3rico do n\u00facleo de deposi\u00e7\u00e3o de energia secund\u00e1-\n\nria ?ca ent\u00e3o resumido ao transporte dos f\u00f3tons atrav\u00e9s do meio absorvedor [3], o que nos\n\nremete novamente a uma convolu\u00e7\u00e3o.\n\nNo esquema apresentado na ?gura 2.3 temos um espalhamento da ?u\u00eancia prim\u00e1ria ?p\npor um processo Compton e observamos a gera\u00e7\u00e3o da ?u\u00eancia secund\u00e1ria ?s. Seja um meio\n\nabsorvedor cuja se\u00e7\u00e3o de choque Compton para f\u00f3tons seja d?=d\n. Neste meio considere um\n\nelemento de volume dV 0 onde haja ?e el\u00e9trons por unidade de volume. Ent\u00e3o o n\u00famero de\n\nf\u00f3tons espalhados em um \u00e2ngulo s\u00f3lido d\n \u00e9 ?p ??e ?d? ?dV 0. O n\u00famero de f\u00f3tons espalhados\ndN 0s provenientes de dV\n\n0como fun\u00e7\u00e3o do \u00e2ngulo s\u00f3lido d\n ?ca\n\ndN 0s = ?p ? ?e ? dV 0 ?\nd?\n\nd\n\n? d\n (2.12)\n\nComo estamos em um meio absorvedor e desejamos saber a ?u\u00eancia ?s que alcan\u00e7a um\n\ndeterminado elemento de volume dV em ?!r , devemos ent\u00e3o fazer a atenua\u00e7\u00e3o exponencial\nda express\u00e3o anterior. Assim\n\ndN 0s = ?p ? ?e ? dV 0 ?\nd?\n\nd\n\n? dA???!r ? ?!r 0??2 ? e??\n\n???!r ??!r 0?? (2.13)\nonde trocamos o d\n do numerador por dA???!r ??!r 0??2 , e ? \u00e9 o coe?ciente de atenua\u00e7\u00e3o linear do\nmeio, que estamos considerando homog\u00eaneo.\n\n13\n\n\n\nPodemos ent\u00e3o escrever uma ?u\u00eancia ?0s dependente do elemento de volume dV\n0 como:\n\ndN 0s\ndA\n\n= ?p ? ?e ? dV 0 ?\nd?\n\nd\n\n? e\n\n??\n???!r ??!r 0?????!r ? ?!r 0??2 (2.14)\n\n?0s =\ndN 0s\ndA\n\n(2.15)\n\nPortanto ?0s \u00e9 uma ?u\u00eancia secund\u00e1ria diferencial e vamos escrev\u00ea-la assim: d?s = ?\n0\ns.\n\nEstamos interessados em saber a ?u\u00eancia total no elemento de volume dV apontado por\n?!r , e portanto devemos integrar a ?u\u00eancia secund\u00e1ria diferencial em todo o espa\u00e7o, conforme\na equa\u00e7\u00e3o 2.17.\n\n?s =\n\nZ Z Z\nV\nd?0s (2.16)\n\n?s (\n?!r ) =\n\nZ Z Z\nV\n?p\n\n??!r 0? ? ?e ? dV 0???!r ? ?!r 0??2 ?\nd?\n\nd\n\n\n??!r ? ?!r 0? ? e?????!r ??!r 0?? (2.17)\nSimpli?cando a equa\u00e7\u00e3o anterior, identi?camos claramente o n\u00facleo k0s da convolu\u00e7\u00e3o:\n\n?s (\n?!r ) =\n\nZ Z Z\nV\n?p\n\n??!r 0? ? k0s ??!r ? ?!r 0? ? dV 0 (2.18)\nk0s\n??!r ? ?!r 0? = ?e ? dV 0???!r ? ?!r 0??2 ?\n\nd?\n\nd\n\n? e??\n\n???!r ??!r 0?? (2.19)\nO kerma secund\u00e1rio Ks (?!r ) \u00e9 escrito como fun\u00e7\u00e3o da ?u\u00eancia secund\u00e1ria desta forma:\n\nKs (\n?!r ) = ?s (?!r ) ?\n\n?0en\n?\n? Es ? C (2.20)\n\nonde ?\n0\n\nen\n\n?\ntem o mesmo signi?cado que ?en\n\n?\npor\u00e9m o sinal 0 indica que deve ser calculado na\n\nenergia Es, sendo esta a energia m\u00e9dia dos f\u00f3tons que s\u00e3o espalhados no processo Compton\n\n[3].\n\nEnt\u00e3o, escrevendo o kerma secund\u00e1rio em termos da ?u\u00eancia prim\u00e1ria, chegamos a:\n\nKs (\n?!r ) =\n\nZ Z Z\nV\n?p\n\n??!r 0? ? ks ??!r ? ?!r 0? ? dV 0 (2.21)\nks\n??!r ? ?!r 0? = k0s ??!r ? ?!r 0? ? ?0en? ? Es ? C (2.22)\n\nComo estamos considerando que os el\u00e9trons lan\u00e7ados por esta intera\u00e7\u00e3o secund\u00e1ria est\u00e3o\n\n14\n\n\n\ndepositando toda a sua energia dentro da c\u00e9lula onde s\u00e3o gerados, a dose secund\u00e1ria em ?!r\nser\u00e1 igual ao kerma calculado neste mesmo ponto, e assim\n\nDs (\n?!r ) =\n\nZ Z Z\nV\n?p\n\n??!r 0? ? ks ??!r ? ?!r 0? ? dV 0 (2.23)\n2.4.3 A dose de m\u00faltiplo espalhamento\n\nConsideramos novamente que os f\u00f3tons secund\u00e1rios ir\u00e3o interagir por efeito Compton e que\n\nesta segunda intera\u00e7\u00e3o produzir\u00e1 os f\u00f3tons de terceira ordem. Como j\u00e1 citamos, n\u00e3o \u00e9 muito\n\ninteressante seguir cada uma das intera\u00e7\u00f5es dos f\u00f3tons, pois assim ser\u00edamos obrigados a\n\ntruncar a s\u00e9rie que comp\u00f5e a dose total, incorrendo em um certo erro e sempre subestimando\n\na dose total. Vamos considerar que os f\u00f3tons de terceira ordem j\u00e1 n\u00e3o t\u00eam mais uma dire\u00e7\u00e3o\n\npreferencial, e assim poderemos transport\u00e1-los de acordo com a teoria da difus\u00e3o.\n\nQuando inserimos uma mol\u00e9cula de g\u00e1s com uma velocidade e dire\u00e7\u00e3o conhecidas em\n\num volume fechado contendo um certo g\u00e1s, ap\u00f3s algumas colis\u00f5es n\u00e3o teremos mais como\n\nrecuperar as condi\u00e7\u00f5es iniciais desta part\u00edcula, isto \u00e9, n\u00e3o conseguiremos mais saber quais\n\neram sua velocidade e dire\u00e7\u00e3o iniciais. A equa\u00e7\u00e3o que descreve este problema \u00e9 a equa\u00e7\u00e3o\n\nde Helmholtz [8]. Este problema \u00e9 an\u00e1logo ao transporte dos f\u00f3tons de terceira ordem e\n\nsuperiores. Como o nosso problema n\u00e3o envolve o tempo, usaremos a equa\u00e7\u00e3o est\u00e1tica de\n\nHelmholtz:\n\nDr2 e?m (?!r ) ? ?00ene?m (?!r ) + sm (?!r ) = 0 (2.24)\nonde D \u00e9 o coe?ciente de difus\u00e3o, ?00en \u00e9 o coe?ciente de absor\u00e7\u00e3o em massa para a energia\n\nm\u00e9dia dos f\u00f3tons para o m\u00faltiplo espalhamento3 Eavg, sm (?!r ) \u00e9 a fun\u00e7\u00e3o que descreve a\nfonte de f\u00f3tons a serem transportados e e?m (?!r ) \u00e9 a ?u\u00eancia do m\u00faltiplo espalhamento que\ndesejamos saber [3].\n\nVamos reescrever a equa\u00e7\u00e3o da difus\u00e3o para conseguirmos algumas quantidades de inte-\n\nresse f\u00edsico, e assim temos\n\nr2 e?m (?!r ) ? 1\nL2\n\ne?m (?!r ) = ? 1\nD\nsm (\n\n?!r ) (2.25)\n\nonde L \u00e9 conhecido como o comprimento de difus\u00e3o e \u00e9 dado por L =\nq\n\nD\n?00en\n\n.\n\nO coe?ciente de difus\u00e3o D pode ser escrito em termos do coe?ciente de absor\u00e7\u00e3o linear,\n\n3\nEavg \u00e9 obtida atrav\u00e9s da conserva\u00e7\u00e3o da energia do f\u00f3ton de entrada E0 e dos f\u00f3tons espalhados na\n\nprimeira intera\u00e7\u00e3o Es\n\n15\n\n\n\nequa\u00e7\u00e3o 2.26:\n\nD =\n?00s\n3?002\n\n(2.26)\n\nsendo ?00s o coe?ciente de espalhamento dado por: ?\n00\ns = ?\n\n00 ? ?00en, em que ?00 \u00e9 o coe?ciente\nde atenua\u00e7\u00e3o linear, e todos s\u00e3o para a energia Eavg.\n\nPara resolvermos a equa\u00e7\u00e3o de Helmholtz e encontrarmos a ?u\u00eancia de m\u00faltiplo espa-\n\nlhamento e?m (?!r ), precisaremos primeiro conhecer a fun\u00e7\u00e3o sm (?!r ) que descreve o compor-\ntamento da fonte para o m\u00faltiplo espalhamento.\n\nOs f\u00f3tons que ir\u00e3o compor a fun\u00e7\u00e3o sm (?!r ) ser\u00e3o aqueles que forem desviados da dire\u00e7\u00e3o\nda ?u\u00eancia secund\u00e1ria ?s (?!r ), isto \u00e9, ser\u00e3o os f\u00f3tons que sofrerem uma terceira intera\u00e7\u00e3o\nao longo de sua trajet\u00f3ria ?!r ? ?!r 0, veja ?gura 2.5.\n\nO n\u00famero de f\u00f3tons desviados da dire\u00e7\u00e3o ?!r ? ?!r 0 pode ser escrito na forma:\n\n4N` = ?0 ? N` ? 4` (2.27)\n\nsendo 4` =\n???!r ? ?!r 0?? a dist\u00e2ncia percorrida pelo f\u00f3ton, N` o n\u00famero de f\u00f3tons originados\n\nem ?!r 0que seguem na dire\u00e7\u00e3o apontada por ?!r ??!r 0 e ?0 \u00e9 o coe?ciente de atenua\u00e7\u00e3o linear\nna energia Es. Em seguida j\u00e1 escrevemos a sua forma diferencial,\n\ndN` = ?\n0 ? N` ? d` (2.28)\n\nSabendo que na dire\u00e7\u00e3o ?!r ? ?!r 0 temos a ?u\u00eancia secund\u00e1ria ?s e que ela \u00e9 dada pela\nraz\u00e3o entre o n\u00famero de f\u00f3tons N` que seguem nesta trajet\u00f3ria pela \u00e1rea A`, neste caso a\n\n\u00e1rea \u00e9 a base do cone formado pelo \u00e2ngulo s\u00f3lido diferencial d\n em torno da dire\u00e7\u00e3o ?!r ??!r 0.\nEnt\u00e3o escrevemos a equa\u00e7\u00e3o 2.28 em fun\u00e7\u00e3o da ?u\u00eancia secund\u00e1ria, conforme a equa\u00e7\u00e3o 2.29:\n\ndN` = ?\n0 ? ?s ? A` ? d` (2.29)\n\nN` = ?s ? A` (2.30)\n\nAgora a multiplica\u00e7\u00e3o da \u00e1rea A` pela diferencial de comprimento do cone d` ser\u00e1 subs-\n\ntitu\u00edda pelo elemento de volume diferencial dV` e a equa\u00e7\u00e3o 2.29 ser\u00e1 escrita da seguinte\n\nmaneira:\n\ndN` = ?\n0 ? ?s ? dV` (2.31)\n\ndV` = A` ? d` (2.32)\n\n16\n\n\n\nFigura 2.5: A trajet\u00f3ria dos f\u00f3tons secund\u00e1rios e a ilustra\u00e7\u00e3o dos f\u00f3tons que foram desviados\npela terceira colis\u00e3o neste trajeto.\n\n17\n\n\n\nReescrevendo a express\u00e3o 2.31 chegamos \u00e0 fonte para o m\u00faltiplo espalhamento, conforme\n\na equa\u00e7\u00e3o 2.34:\n\nsm (\n?!r ) = dN`\n\ndV`\n(?!r ) (2.33)\n\nsm (\n?!r ) = ?0 ? ?s (?!r ) (2.34)\n\nNote que a fonte para o m\u00faltiplo espalhamento tem dimens\u00e3o de n\u00famero de f\u00f3tons por\n\nunidade de volume. Observe tamb\u00e9m que a equa\u00e7\u00e3o 2.36 que descreve a fonte do m\u00faltiplo\n\nespalhamento \u00e9 uma integral de convolu\u00e7\u00e3o devido \u00e0 ?u\u00eancia secund\u00e1ria.\n\nsm (\n?!r ) =\n\nZ Z Z\nV\n?p\n\n??!r 0? ? ?0s ? ks ??!r ? ?!r 0? ? dV 0 (2.35)\nsm (\n\n?!r ) =\nZ Z Z\n\nV\n?p\n\n??!r 0? ? eks ??!r ? ?!r 0? ? dV 0 (2.36)\nonde fks ??!r ? ?!r 0? ?ca sendo o n\u00facleo de convolu\u00e7\u00e3o que comp\u00f5e a fonte sm.\n\nTendo a fonte para o m\u00faltiplo espalhamento de f\u00f3tons a serem transportados, usamos a\n\nsolu\u00e7\u00e3o apresentada na refer\u00eancia [7] para a equa\u00e7\u00e3o de Helmholtz,\n\ne?m (?!r ) = sm (?!r ) ? e?r=L\n4?Dr\n\n(2.37)\n\nVeja que a ?u\u00eancia de m\u00faltiplo espalhamento e?m (?!r ) depende dos f\u00f3tons da fonte sm (?!r )\nlocalizada em ?!r . Como no nosso caso as fontes de f\u00f3tons est\u00e3o distribu\u00eddas em todo o meio\nmaterial, devemos escrever e?m (?!r ) = d?m (?!r ), onde d?m (?!r ), equa\u00e7\u00e3o 2.38, \u00e9 a diferencial\nda ?u\u00eancia de m\u00faltiplo espalhamento desejado. Assim a ?u\u00eancia de m\u00faltiplo espalhamento\n\ntotal ?m ?ca sendo\n\nd?m (\n?!r ) = sm\n\n??!r 0? ? e????!r ??!r 0??=LdV 0\n4?D\n\n???!r ? ?!r 0?? (2.38)\n?m (\n\n?!r ) =\nZ Z Z\n\nV\n\nsm\n??!r 0? ? e????!r ??!r 0??=LdV 0\n\n4?D\n???!r ? ?!r 0?? (2.39)\n\nDevemos ressaltar que a equa\u00e7\u00e3o diferencial de Helmholtz que rege o processo de difus\u00e3o\n\nvem da equa\u00e7\u00e3o da lei de Fick, onde assumimos que o espalhamento de f\u00f3tons \u00e9 isotr\u00f3pico.\n\nEsta n\u00e3o \u00e9 uma boa aproxima\u00e7\u00e3o para o caso do espalhamento Compton. Podemos contornar\n\neste problema usando um coe?ciente de difus\u00e3o D aproximado para este tipo de anisotropia\n\n18\n\n\n\n[7], conforme a express\u00e3o 2.40:\n\nD ?= 1\n3?00s ? (1 ? ?)\n\n(2.40)\n\ncom ? sendo o cosseno m\u00e9dio do espalhamento dado por:\n\n? =\n1\n\n?00s\n\nZ\n4?\n\nd?00s\nd\n\n\n(?) ? cos ? ? d\n (2.41)\n\nonde d?00s=d\n \u00e9 a se\u00e7\u00e3o de choque diferencial Compton na energia Eavg.\n\nDe maneira an\u00e1loga ao kerma secund\u00e1rio, teremos o kerma de m\u00faltiplo espalhamento,\n\ndado pela equa\u00e7\u00e3o 2.44:\n\nKm (\n?!r ) = ?m\n\n??!r 0? ?en (Eavg)\n?\n\n? Eavg ? C (2.42)\n\nKm (\n?!r ) =\n\nZ Z Z\nV\nsm\n\n??!r 0? ? e?\n???!r ??!r 0??=L(Eavg)\n\n4? ? D (Eavg) ?\n???!r ? ?!r 0?? ? ?en (Eavg)? ? Eavg ? C (2.43)\n\nKm (\n?!r ) =\n\nZ Z Z\nV\nsm\n\n??!r 0? ? km ??!r ? ?!r 0? ? dV 0 (2.44)\nTamb\u00e9m como no caso da dose secund\u00e1ria, podemos considerar que os el\u00e9trons gerados\n\npelas intera\u00e7\u00f5es destes f\u00f3tons difundidos ser\u00e3o absorvidos localmente, na mesma c\u00e9lula em\n\nque foram lan\u00e7ados. Portanto a dose de m\u00faltiplo espalhamento ser\u00e1 igual ao respectivo\n\nkerma, Dm (?!r ) = Km (?!r ).\nNo entanto a equa\u00e7\u00e3o para a dose de m\u00faltiplo espalhamento destoa das demais por n\u00e3o\n\ndepender diretamente da ?u\u00eancia prim\u00e1ria. Desejamos escrever esta \u00faltima parcela da dose\n\ntotal tamb\u00e9m como fun\u00e7\u00e3o da ?u\u00eancia prim\u00e1ria pois isto facilita os c\u00e1lculos computacionais.\n\nVemos na equa\u00e7\u00e3o 2.36 que a fonte sm (?!r ) depende da ?u\u00eancia prim\u00e1ria, e substituindo-a\nna express\u00e3o para a dose de m\u00faltiplo espalhamento temos:\n\nDm (\n?!r ) =\n\nZ Z Z\nV\n\n?Z Z Z\nV\n?p\n\n??!r 00? ? eks ??!r 0 ? ?!r 00? ? dV 00? ? km ??!r ? ?!r 0? ? dV 0 (2.45)\nPropomos a seguinte substitui\u00e7\u00e3o de vari\u00e1veis:\n\n( ?!r 0 ? ?!r 00 = ?!r 000\n?!r ? ?!r 0 = ??!r ? ?!r 00? ? ?!r 000 (2.46)\n\ne as respectivas mudan\u00e7as nos diferenciais de volume:\n\n19\n\n\n\n(\ndV 00 ! ?dV 000\ndV 0 ! ?dV 00\n\n(2.47)\n\nAssim a dose de m\u00faltiplo espalhamento ?ca:\n\nDm (\n?!r ) =\n\nZ Z Z\nV\n?\n??!r 00? ? ?Z Z Z\n\nV\n\nfks ??!r 000? ? km ???!r ? ?!r 00? ? ?!r 000? ? dV 000?dV 00\n(2.48)\n\nks;m\n??!r ? ?!r 00? = Z Z Z\n\nV\n\neks ??!r 000? ? km ???!r ? ?!r 00? ? ?!r 000? ? dV 000 (2.49)\nIdenti?camos o n\u00facleo de deposi\u00e7\u00e3o de energia ks;m\n\n??!r ? ?!r 00? como composto por dois\noutros n\u00facleos de deposi\u00e7\u00e3o de energia, conforme equa\u00e7\u00e3o 2.49. A express\u00e3o ?nal para a\n\ndose de m\u00faltiplo espalhamento ?ca sendo\n\nDm (\n?!r ) =\n\nZ Z Z\nV\n?p\n\n??!r 0? ? ks;m ??!r ? ?!r 0? ? dV 0 (2.50)\n\n2.4.4 A dose total\n\nA dose total \u00e9 composta pela soma das doses prim\u00e1ria (eq. 2.7), secund\u00e1ria (eq. 2.23) e de\n\nm\u00faltiplo espalhamento (eq. 2.50):\n\nD (?!r ) = Dp (?!r ) + Ds (?!r ) + Dm (?!r ) (2.51)\n\nNotamos que todas as doses parciais s\u00e3o integrais de convolu\u00e7\u00e3o da ?u\u00eancia prim\u00e1ria com\n\num n\u00facleo de deposi\u00e7\u00e3o de energia diferente para cada uma delas. Este fato nos permite\n\ndeterminar um n\u00facleo de deposi\u00e7\u00e3o de energia total kt que ser\u00e1 formado pela soma dos\n\nn\u00facleos prim\u00e1rio, secund\u00e1rio e de m\u00faltiplo espalhamento:\n\nkt (\n?!r ) = kp (?!r ) + ks (?!r ) + ks;m (?!r ) (2.52)\n\nInterpretamos kt como a fun\u00e7\u00e3o que realiza o transporte e deposi\u00e7\u00e3o da energia que\n\ncomp\u00f5e a dose. Esta fun\u00e7\u00e3o tamb\u00e9m \u00e9 chamada de fun\u00e7\u00e3o de espalhamento de ponto (Point\n\nSpread Function - PSF).\n\nAssim precisaremos realizar somente uma integral de convolu\u00e7\u00e3o para saber a dose total,\n\n20\n\n\n\nconforme equa\u00e7\u00e3o 2.53:\n\nD (?!r ) =\nZ Z Z\n\nV\n?p\n\n??!r 0? ? kt ??!r ? ?!r 0? ? dV 0 (2.53)\n2.5 O c\u00e1lculo da dose para meios heterog\u00eaneos\n\nQuando trabalhamos em radioterapia, e em especial na teleterapia, tratamos constantemente\n\nde meios heterog\u00eaneos. Podemos aproximar alguns tecidos do corpo humano do ponto de\n\nvista radiol\u00f3gico como sendo apenas \u00e1gua, pois o importante em radioterapia \u00e9 justamente\n\na forma como a radia\u00e7\u00e3o penetra, interage e \u00e9 absorvida por este meio. A se\u00e7\u00e3o de choque\n\ndesses tecidos, atrav\u00e9s do n\u00famero at\u00f4mico efetivo Z, e sua densidade, s\u00e3o os fatores que\n\nin?uenciam nestes processos. Por isso consideramos tecidos como o muscular e o adiposo\n\naproximadamente iguais \u00e0 \u00e1gua.\n\nmateriais/tecidos Z ?\n?\nkg=m3\n\n?\nAr (CNTP) 7; 78 1; 205\n\n\u00c1gua 7; 51 1000\nMuscular 7; 64 1040\nAdiposo 6; 46 916\n\nPoliestireno (C8H8) 5; 74 1044\nLucite (C5H8O2) 6; 56 1180\n\nBaquelite (C43H38O7) 6; 27 1400\n\u00d3sseo 12; 31 1650\n\nAlum\u00ednio 13 2699\n\nTabela 2.1: A densidade e o n\u00famero at\u00f4mico efetivo de alguns materiais e tecidos [1].\n\nNa tabela 2.1 apresentamos as densidades e Z de alguns tecidos e materiais de uso comum\n\nna radioterapia [1]. Embora as densidades do ar, \u00e1gua, dos tecidos muscular e adiposo sejam\n\ndiferentes entre si, os n\u00fameros at\u00f4micos m\u00e9dios s\u00e3o aproximadamente iguais. Note tamb\u00e9m\n\nque o n\u00famero at\u00f4mico efetivo do alum\u00ednio e do osso s\u00e3o bem pr\u00f3ximos, mas bem maiores\n\nque o da \u00e1gua. Na pr\u00e1tica, o alum\u00ednio \u00e9 usado para fazer o papel do tecido \u00f3sseo em medidas\n\ndosim\u00e9tricas e at\u00e9 em alguns c\u00e1lculos de dose.\n\nNesta se\u00e7\u00e3o vamos apresentar um modelo te\u00f3rico para o c\u00e1lculo da dose em meios he-\n\nterog\u00eaneos atrav\u00e9s de convolu\u00e7\u00f5es, aplicando uma corre\u00e7\u00e3o de densidade entre os elementos\n\nde volume. Este modelo \u00e9 totalmente baseado na teoria desenvolvida na se\u00e7\u00e3o anterior. A\n\ndose total ser\u00e1 formada pela soma das doses prim\u00e1ria, secund\u00e1ria e de m\u00faltiplo espalhamen-\n\nto. Ser\u00e1 considerado tamb\u00e9m que os f\u00f3tons interajam por efeito Compton a cada passo [4],\n\n21\n\n\n\nassim como no modelo sugerido na se\u00e7\u00e3o 2.2. Observando a tabela apresentada no ap\u00eandice\n\nB constatamos que este modelo te\u00f3rico deve apresentar bons resultados na faixa de energia\n\nde 10MeV a 50keV.\n\n2.5.1 A dose prim\u00e1ria\n\nO modelo para o c\u00e1lculo da dose por convolu\u00e7\u00e3o em meios heterog\u00eaneos faz uso da distri-\n\nbui\u00e7\u00e3o de densidades obtidas, por exemplo, atrav\u00e9s de tomogra?a computadorizada.\n\nO teorema de Fano nos mostra que os tipos de processos envolvidos na intera\u00e7\u00e3o da\n\nradia\u00e7\u00e3o com a mat\u00e9ria s\u00e3o independentes da densidade do meio, dependendo exclusivamente\n\nda sua composi\u00e7\u00e3o [2]. Tendo em vista este teorema, uma express\u00e3o para a dose prim\u00e1ria\n\n[4, 10, 11] ?ca:\n\nDp (\n?!r ) =\n\nZ Z Z\nV\n?p\n\n??!r 0? ? e???!r 0? ? kp ??!r ? ?!r 0? ? dV 0 (2.54)\ne???!r 0? = ???!r 0?\n\n?H2O\n(2.55)\n\nsendo e???!r 0? a densidade relativa entre a densidade do meio ???!r 0? e a densidade da \u00e1gua\n?H2O. A ?u\u00eancia prim\u00e1ria, de?nida na equa\u00e7\u00e3o 2.1, contabiliza a atenua\u00e7\u00e3o exponencial de\n\ncada elemento de volume com sua respectiva densidade. O n\u00facleo de deposi\u00e7\u00e3o de energia\n\nest\u00e1 de?nido na equa\u00e7\u00e3o 2.8 e \u00e9 o mesmo usado para o c\u00e1lculo da dose prim\u00e1ria em meios\n\nhomog\u00eaneos. Veri?camos que esta express\u00e3o para a dose prim\u00e1ria reduz-se \u00e0 equa\u00e7\u00e3o 2.7\n\npara meios homog\u00eaneos quando a densidade relativa \u00e9 unit\u00e1ria.\n\nEsta corre\u00e7\u00e3o de densidade tem o efeito de atenuar (e? &lt;1) ou intensi?car (e? > 1) a\ndose depositada naquele elemento de volume, atuando como um fator de corre\u00e7\u00e3o para a\n\ndose prim\u00e1ria. Esta corre\u00e7\u00e3o depende da mesma vari\u00e1vel que a ?u\u00eancia prim\u00e1ria, e assim\n\nconsideraremos a ?u\u00eancia prim\u00e1ria e a densidade relativa como uma fun\u00e7\u00e3o e o n\u00facleo de\n\ndeposi\u00e7\u00e3o de energia como a outra fun\u00e7\u00e3o da convolu\u00e7\u00e3o. No entanto, por quest\u00e3o de clareza,\n\nas express\u00f5es para a dose de qualquer esp\u00e9cie ser\u00e3o escritas no mesmo formato que a equa\u00e7\u00e3o\n\n2.54.\n\n2.5.2 A dose secund\u00e1ria\n\nAnalogamente, para o desenvolvimento do modelo para a dose secund\u00e1ria em meios hete-\n\nrog\u00eaneos vamos nos basear no desenvolvimento da dose secund\u00e1ria para meios homog\u00eaneos,\n\nse\u00e7\u00e3o 2.4.2. A ?u\u00eancia secund\u00e1ria ser\u00e1 escrita ent\u00e3o da seguinte maneira:\n\n22\n\n\n\n?s (\n?!r ) =\n\nZ Z Z\nV\n?p\n\n??!r 0? e???!r 0? ? ?e ? 1???!r ? ?!r 0??2 ?\nd?\n\nd\n\n\n??!r ? ?!r 0?\n?exp\n\n\"\n?\nZ ???!r ??!r 0??\n`=0\n\n?0\n??!??\n\nd\n?!?\n#\ndV 0 (2.56)\n\nNesta ?u\u00eancia inclu\u00edmos uma corre\u00e7\u00e3o de e???!r 0?, e a atenua\u00e7\u00e3o exponencial, que na\nequa\u00e7\u00e3o 2.17 dependia apenas da dist\u00e2ncia percorrida pelos f\u00f3tons multiplicada pelo coe?-\n\nciente de atenua\u00e7\u00e3o linear ?0, agora depende de uma integral sobre os coe?cientes ?0\n??!??\n\n,\n\nonde\n?!?\n\nrepresenta o vetor dist\u00e2ncia percorrido pelo f\u00f3ton. O ?0\n??!??\n\nusado \u00e9 aquele para a\n\nenergia Es, que \u00e9 a energia m\u00e9dia dos f\u00f3tons produzidos no espalhamento Compton [4].\n\nO caminho para chegarmos a esta ?u\u00eancia \u00e9 o mesmo que o apresentado na se\u00e7\u00e3o 2.4.2\n\napenas inserindo a fun\u00e7\u00e3o da densidade relativa e considerando que a queda exponencial\n\ndepende de uma integral sobre os coe?ciente lineares ?0\n??!??\n\n.\n\nFacilmente veri?camos que a equa\u00e7\u00e3o 2.56 se reduz \u00e0 equa\u00e7\u00e3o 2.17 quando estamos num\n\nmeio de densidade relativa unit\u00e1ria e de coe?ciente de absor\u00e7\u00e3o linear constante em todos\n\nos pontos do meio absorvedor.\n\nA integral de convolu\u00e7\u00e3o exige que as duas fun\u00e7\u00f5es sejam invariantes por deslocamento\n\nespacial. Esta ?u\u00eancia secund\u00e1ria, tal como est\u00e1 na express\u00e3o 2.56, n\u00e3o pode ser escrita\n\ncomo uma convolu\u00e7\u00e3o, pois a atenua\u00e7\u00e3o exponencial depende da posi\u00e7\u00e3o. Como desejamos\n\nexpressar esta fun\u00e7\u00e3o como uma convolu\u00e7\u00e3o, faremos algumas aproxima\u00e7\u00f5es.\n\nConsidere a diferen\u00e7a 4?0\n??!??\n\nentre o coe?ciente ?0 (`) e o coe?ciente de atenua\u00e7\u00e3o ?0,\n\nonde a aus\u00eancia da indica\u00e7\u00e3o de posi\u00e7\u00e3o dever\u00e1 ser subentendida como sendo o coe?ciente\n\nna \u00e1gua.\n\n4?0\n??!??\n\n= ?0\n??!?? ? ?0 (2.57)\n\nUsando a equa\u00e7\u00e3o 2.57, podemos escrever a express\u00e3o para a atenua\u00e7\u00e3o exponencial da\n\nseguinte maneira:\n\nexp\n\n\"\n?\nZ ???!r ??!r 0??\n`=0\n\n?0\n??!??\n\nd\n?!?\n#\n\n= exp\n???0 ???!r ? ?!r 0???\n\n?exp\n\"\n?\nZ ???!r ??!r 0??\n`=0\n\n4?0\n??!??\n\nd\n?!?\n#\n\n(2.58)\n\n23\n\n\n\nVamos de?nir \t\n??!r ? ?!r 0? como:\n\t\n??!r ? ?!r 0? = exp\n\n\"\n?\nZ ???!r ??!r 0??\n`=0\n\n4?0\n??!??\n\nd\n?!?\n#\n\n(2.59)\n\nN\u00f3s agora podemos expandir \t em s\u00e9rie Taylor como fun\u00e7\u00e3o de 4r =\n???!r ? ?!r 0??,\n\n\t (4r) = \t (0) + @\t\n@ (4r) j4rj +\n\n1\n\n2\n\n@2\t\n\n@ (4r)2\nj4rj2 + ? ? ? (2.60)\n\nNote que estamos usando a dist\u00e2ncia que o f\u00f3ton viaja como vari\u00e1vel da fun\u00e7\u00e3o \t e\n\nquando fazemos 4r ! 0, estamos dizendo que ?!r ! ?!r 0, de modo que o coe?ciente de\natenua\u00e7\u00e3o acaba por ser calculado em ?!r 0. Assim teremos\n\n\t (0) = 1 (2.61)\n@\t (4r)\n@ (4r)\n\n????\n4r=0\n\n= ?4?0 ??!r 0? (2.62)\nO resultado mostrado em 2.61 \u00e9 conhecido como aproxima\u00e7\u00e3o de ordem zero e em 2.62\n\ncomo aproxima\u00e7\u00e3o de primeira ordem. Portanto, a express\u00e3o de \t aproximada at\u00e9 primeira\n\nordem ?ca sendo\n\n\t\n??!r ? ?!r 0? ?= 1 ? 4?0 ??!r 0? ? ???!r ? ?!r 0?? (2.63)\n\nSubstituindo a rela\u00e7\u00e3o dada em 2.57 obtemos\n\n\t\n??!r ? ?!r 0? ?= 1 ? ??0 ??!r 0? ? ?0? ? ???!r ? ?!r 0?? (2.64)\n\nEstamos considerando que o meio absorvedor tenha sempre a mesma se\u00e7\u00e3o de choque,\n\nmudando apenas a densidade. Desta forma usamos o escalonamento do livre caminho m\u00e9dio\n\ndo f\u00f3ton, baseado no teorema de Fano, para conseguirmos escrever a seguinte express\u00e3o para\n\no coe?ciente de atenua\u00e7\u00e3o linear\n\n?0\n??!r 0? = ?0 ? e???!r 0? (2.65)\n\nEnt\u00e3o a equa\u00e7\u00e3o 2.64 passa a ser\n\n\t\n??!r ? ?!r 0? ?= 1 ? ?0 ?e???!r 0? ? 1? ? ???!r ? ?!r 0?? (2.66)\n\n24\n\n\n\ne substituindo \t na equa\u00e7\u00e3o 2.56 teremos a seguinte express\u00e3o para a ?u\u00eancia secund\u00e1ria:\n\n?s (\n?!r ) =\n\nZ Z Z\nV\n?p\n\n??!r 0? e? (?!r ) ?e d?\nd\n\n\n??!r ? ?!r 0? e??0\n???!r ??!r 0?????!r ? ?!r 0??2 dV 0\n\n+\n\nZ Z Z\nV\n?p\n\n??!r 0? e? (?!r ) ?1 ? e???!r 0??(?!r ) ?e d?\nd\n\n\n??!r ? ?!r 0?\n?e\n\n??0\n???!r ??!r 0?????!r ? ?!r 0?? ?0 ??!r ? ?!r 0?dV 0 (2.67)\n\nEsta ?u\u00eancia secund\u00e1ria pode ser melhor compreendida se considerarmos cada integral\n\nque a comp\u00f5e como uma fun\u00e7\u00e3o independente, assim\n\n?0s (\n?!r ) =\n\nZ Z Z\nV\n?p\n\n??!r 0? e? (?!r ) k0s ??!r ? ?!r 0?dV 0 (2.68)\nk0s\n??!r ? ?!r 0? = ?e d?\n\nd\n\n\n??!r ? ?!r 0? e??0\n???!r ??!r 0?????!r ? ?!r 0??2 (2.69)\n\n?1s (\n?!r ) =\n\nZ Z Z\nV\n?p\n\n??!r 0? e? (?!r ) ?1 ? e???!r 0??k1s ??!r ? ?!r 0?dV 0 (2.70)\nk1s\n??!r ? ?!r 0? = ?e d?\n\nd\n\n\n??!r ? ?!r 0? ? e??0\n???!r ??!r 0?????!r ? ?!r 0?? ?0 ??!r ? ?!r 0?\n\n(2.71)\n\nConseq\u00fcentemente, a ?u\u00eancia secund\u00e1ria total ?ca\n\n?s (\n?!r ) ?= ?0s (?!r ) + ?1s (?!r ) (2.72)\n\nonde o termo de ordem zero ?0s considera parcialmente as heterogeneidades do meio por\n\nconta da presen\u00e7a da ?u\u00eancia ?p e da densidade relativa e? em sua express\u00e3o, enquanto que\no termo de primeira ordem ?1s compensa parcialmente o erro do termo de ordem zero nas\n\nheterogeneidades do meio absorvedor.\n\nPara entender melhor o comportamento destes dois termos da ?u\u00eancia secund\u00e1ria imagi-\n\nnemos a equa\u00e7\u00e3o 2.67 sendo avaliada atrav\u00e9s de uma interface entre dois meios. O primeiro\n\ntem densidade igual \u00e0 da \u00e1gua e o segundo possui uma densidade relativa menor. Neste caso\n\n?1s ser\u00e1 positivo, porque 1? e???!r 0? > 0, acrescendo seu valor ao de ?0s para compor ?s, que\nsempre ser\u00e1 positivo. Em uma outra situa\u00e7\u00e3o, f\u00f3tons passando da \u00e1gua para um meio de den-\n\nsidade relativa maior, a corre\u00e7\u00e3o dada por ?1s ser\u00e1 negativa, pois 1 ? e???!r 0? &lt;0, corrigindo\n25\n\n\n\no valor da ?u\u00eancia secund\u00e1ria superestimada por ?0s dentro do meio onde e???!r 0? > 1.\nUm racioc\u00ednio an\u00e1logo pode ser feito em diversos pontos do meio, por\u00e9m quando estiver-\n\nmos calculando a ?u\u00eancia secund\u00e1ria em elementos de volume cuja densidade \u00e9 a da \u00e1gua,\n\n?1s ser\u00e1 sempre nulo, e a ?u\u00eancia secund\u00e1ria para o meio heterog\u00eaneo reduz-se \u00e0 respec-\n\ntiva ?u\u00eancia para o meio homog\u00eaneo. Portanto a corre\u00e7\u00e3o ?1s somente ser\u00e1 n\u00e3o nula nos\n\nelementos de volume onde e???!r 0? 6= 1.\nObservamos que as equa\u00e7\u00f5es 2.68 e 2.70 que comp\u00f5em a ?u\u00eancia secund\u00e1ria s\u00e3o tamb\u00e9m\n\nescritas em forma de convolu\u00e7\u00e3o.\n\nA dose secund\u00e1ria \u00e9 escrita da mesma forma que a apresentada na se\u00e7\u00e3o 2.4.2 para meios\n\nhomog\u00eaneos. O princ\u00edpio de que a dose secund\u00e1ria \u00e9 igual ao kerma secund\u00e1rio permanece\n\nv\u00e1lido sob o mesmo argumento: os el\u00e9trons n\u00e3o t\u00eam energia su?ciente para deixarem o ele-\n\nmento de volume onde foram lan\u00e7ados. Da equa\u00e7\u00e3o 2.20 para o kerma secund\u00e1rio escrevemos\n\na express\u00e3o apropriada para a dose secund\u00e1ria em meios heterog\u00eaneos:\n\nDs (\n?!r ) = D0s (?!r ) + D1s (?!r ) (2.73)\n\nsendo a dose secund\u00e1ria de ordem zero dada por:\n\nD0s (\n?!r ) =\n\nZ Z Z\nV\n?\n??!r 0? e???!r 0?k0s ??!r ? ?!r 0?dV 0 (2.74)\n\nk0s\n??!r ? ?!r 0? = ?e d?\n\nd\n\n\n??!r ? ?!r 0? e??0\n???!r ??!r 0?????!r ? ?!r 0??2\n\n?Es\n??!r ? ?!r 0? ?0en\n\n?\n\n??!r ? ?!r 0? (2.75)\ne a parcela de corre\u00e7\u00e3o de primeira ordem da dose secund\u00e1ria dada por:\n\nD1s (\n?!r ) =\n\nZ Z Z\nV\n?\n??!r 0? e???!r 0??1 ? e???!r 0??k1s ??!r ? ?!r 0?dV 0 (2.76)\n\nk1s\n??!r ? ?!r 0? = ?e d?\n\nd\n\n\n??!r ? ?!r 0? e??0\n???!r ??!r 0?????!r ? ?!r 0?? Es ??!r ? ?!r 0?\n\n??\n0\nen\n\n?\n\n??!r ? ?!r 0??0 ??!r ? ?!r 0? (2.77)\nA interpreta\u00e7\u00e3o para os termos de ordem zero e primeira ordem que comp\u00f5em a dose\n\nsecund\u00e1ria \u00e9 dada pela ?u\u00eancia secund\u00e1ria. Mas note que, por se tratar de uma expans\u00e3o\n\nem s\u00e9rie, o termo de primeira ordem \u00e9 menos signi?cativo que o de ordem zero.\n\nDesta forma, temos uma express\u00e3o para a dose secund\u00e1ria escrita na forma de convolu\u00e7\u00e3o\n\n26\n\n\n\nque considera, ainda que aproximadamente, as corre\u00e7\u00f5es devido \u00e0s varia\u00e7\u00f5es de densidade\n\ndo meio.\n\n2.5.3 A dose de m\u00faltiplo espalhamento\n\nUm modelo para o c\u00e1lculo da dose por convolu\u00e7\u00e3o em meios heterog\u00eaneos, em princ\u00edpio,\n\ndeve ser o mais abrangente poss\u00edvel, contemplando as mais variadas formas e dimens\u00f5es das\n\nestruturas do corpo humano. Portanto, n\u00e3o \u00e9 interessante criar modelos para a distribui\u00e7\u00e3o\n\nda dose onde as heterogeneidades sejam tratadas atrav\u00e9s de geometrias simples tais como\n\nesferas, cilindros, ou qualquer outra que facilite o modelamento te\u00f3rico. Necessitamos de\n\num modelo abrangente que apresente uma precis\u00e3o boa e previamente conhecida.\n\nResolver a equa\u00e7\u00e3o da difus\u00e3o apresentada na se\u00e7\u00e3o 2.4.3 considerando as heterogeneida-\n\ndes do meio signi?ca impor condi\u00e7\u00f5es de contorno \u00e0 equa\u00e7\u00e3o diferencial de Helmholtz. Como\n\n\u00e9 extremamente dif\u00edcil prever a geometria dessas estruturas, vamos aproximar a solu\u00e7\u00e3o de-\n\nsejada para a de meios homog\u00eaneos [4], equa\u00e7\u00e3o 2.37. Este fato nos remete diretamente\n\n\u00e0 ?u\u00eancia de m\u00faltiplo espalhamento para meios homog\u00eaneos, equa\u00e7\u00e3o 2.39, que ent\u00e3o ser\u00e1\n\nadotada para os meios heterog\u00eaneos.\n\nNotamos que esta ?u\u00eancia ?m depende diretamente da fonte sm para o m\u00faltiplo espa-\n\nlhamento, e esta fonte depende da ?u\u00eancia secund\u00e1ria ?s, onde, nesta se\u00e7\u00e3o, usaremos a\n\nrespectiva ?u\u00eancia para meios heterog\u00eaneos, conforme a equa\u00e7\u00e3o 2.56.\n\nPor\u00e9m, analisando cuidadosamente a dedu\u00e7\u00e3o da express\u00e3o para a fonte sm, percebemos\n\nque podemos fazer algumas corre\u00e7\u00f5es de densidade. O coe?ciente de atenua\u00e7\u00e3o linear ?0\n\nusado na equa\u00e7\u00e3o 2.27 e admitido constante agora depende do trajeto percorrido pelos\n\nf\u00f3tons secund\u00e1rios, e pode variar de acordo com a densidade. Partindo deste princ\u00edpio e\n\nrefazendo os c\u00e1lculos da se\u00e7\u00e3o 2.4.3 chegaremos \u00e0 seguinte express\u00e3o para a fonte de m\u00faltiplo\n\nespalhamento para meios heterog\u00eaneos:\n\nsm (\n?!r ) = e? (?!r ) Z Z Z\n\nV\n?p\n\n??!r 0? e???!r 0? ek ??!r ? ?!r 0?dV 0 (2.78)\nek ??!r ? ?!r 0? = ?e d?\n\nd\n\n\n??!r ? ?!r 0? exp\n\"\n?R???!r ??!r 0??`=0 ?0 ??!??d?!?\n\n#\n???!r ? ?!r 0??2 ?0s\n\n??!r ? ?!r 0? (2.79)\nA fonte para o m\u00faltiplo espalhamento, equa\u00e7\u00e3o 2.78, \u00e9 escrita como uma integral se-\n\nmelhante \u00e0 da fonte para meios homog\u00eaneos, equa\u00e7\u00e3o 2.36. Notamos a dupla utiliza\u00e7\u00e3o da\n\ndensidade relativa e?. A que est\u00e1 dentro da integral modi?ca a fonte de f\u00f3tons espalhados\natuando diretamente onde eles s\u00e3o gerados, isto \u00e9, agindo sobre o coe?ciente de espalhamen-\n\n27\n\n\n\nto Compton ?0s. A densidade relativa que est\u00e1 fora da integral modi?ca a fonte, portanto, se\n\na densidade relativa em ?!r \u00e9 menor que a unidade, a probabilidade de haver uma intera\u00e7\u00e3o\ndestes f\u00f3tons da fonte tamb\u00e9m ser\u00e1 reduzida. No n\u00facleo de convolu\u00e7\u00e3o mostrado na equa-\n\n\u00e7\u00e3o 2.79 usamos o coe?ciente de espalhamento Compton [4], e n\u00e3o o de atenua\u00e7\u00e3o linear,\n\ncomo usado na se\u00e7\u00e3o 2.4.3, por ser mais preciso, contabilizando apenas os f\u00f3tons que s\u00e3o\n\nespalhados na dire\u00e7\u00e3o ?!r ? ?!r 0.\nContudo a equa\u00e7\u00e3o 2.78 n\u00e3o \u00e9 uma integral de convolu\u00e7\u00e3o pois o seu n\u00facleo, equa\u00e7\u00e3o 2.79,\n\nn\u00e3o \u00e9 invariante por deslocamento. Contornamos este problema ao expandir a exponencial\n\nem s\u00e9rie de Taylor e aproximamos o resultado a apenas os dois primeiros termos, como\n\nfeito na se\u00e7\u00e3o 2.5.2 para a ?u\u00eancia secund\u00e1ria. Assim, a fonte sm ser\u00e1 composta por duas\n\nparcelas:\n\nsm (\n?!r ) ?= s0m (?!r ) + s1m (?!r ) (2.80)\n\nonde s0m ser\u00e1 dado por\n\ns0m (\n?!r ) = e? (?!r ) Z Z Z\n\nV\n?p\n\n??!r 0? e???!r 0? ? ek0s ??!r ? ?!r 0? ? dV 0 (2.81)\nek0s ??!r ? ?!r 0? = ?e d?d\n ??!r ? ?!r 0? e\n\n??0\n???!r ??!r 0?????!r ? ?!r 0??2 ?0s\n\n??!r ? ?!r 0? (2.82)\ne s1m por\n\ns1m (\n?!r ) = e? (?!r )Z Z Z\n\nV\n?p\n\n??!r 0? e???!r 0?\n??1 ? e???!r 0?? 0ek1s ??!r ? ?!r 0? ? dV 0 (2.83)\n\nek1s ??!r ? ?!r 0? = ?e d?d\n ??!r ? ?!r 0? e\n??0\n\n???!r ??!r 0?????!r ? ?!r 0??\n??0 ??!r ? ?!r 0??0s ??!r ? ?!r 0? (2.84)\n\nDevido \u00e0s corre\u00e7\u00f5es de densidade, a fonte para o m\u00faltiplo espalhamento n\u00e3o pode mais\n\nser escrita em fun\u00e7\u00e3o da ?u\u00eancia secund\u00e1ria, como ocorreu no caso homog\u00eaneo.\n\nO kerma associado ao m\u00faltiplo espalhamento \u00e9 dado pela equa\u00e7\u00e3o 2.44 e a respectiva\n\ndose ser\u00e1 aproximadamente igual ao kerma pelo mesmo motivo apresentado na se\u00e7\u00e3o 2.4.3.\n\nA fun\u00e7\u00e3o da fonte sm \u00e9 aproximada pela soma dos dois primeiros termos de uma expans\u00e3o\n\nem s\u00e9rie, conforme equa\u00e7\u00e3o 2.80. Portanto, a dose de m\u00faltiplo espalhamento ser\u00e1 escrita\n\n28\n\n\n\ncomo uma soma de dois termos:\n\nDm (\n?!r ) = D0m (?!r ) + D1m (?!r ) (2.85)\n\nonde o termo de ordem zero \u00e9 dado por\n\nD0m (\n?!r ) =\n\nZ Z Z\nV\ns0m\n\n??!r 0?k0m ??!r ? ?!r 0?dV 0 (2.86)\ne o de primeira ordem por\n\nD1m (\n?!r ) =\n\nZ Z Z\nV\ns1m\n\n??!r 0?k1m ??!r ? ?!r 0?dV 0 (2.87)\nO n\u00facleo de convolu\u00e7\u00e3o k0m\n\n??!r ? ?!r 0? \u00e9 o mesmo dado pela multiplica\u00e7\u00e3o sugerida na\nexpress\u00e3o 2.44. Os coe?cientes ?0, ?0en e ?\n\n0\ns s\u00e3o calculados na mesma energia Es que para\n\nos meios homog\u00eaneos.\n\nOs dois termos que comp\u00f5em a dose Dm n\u00e3o podem ser escritos na forma:Z Z Z\nV\n?p\n\n??!r 0? e???!r 0?k ??!r ? ?!r 0?dV 0 (2.88)\nA depend\u00eancia da fonte sm, equa\u00e7\u00e3o 2.78, com o primeiro e? impede tal fato. Em conseq\u00fc\u00ean-\ncia, n\u00e3o poderemos escrever a dose total como uma \u00fanica convolu\u00e7\u00e3o (veja a se\u00e7\u00e3o 2.5.4).\n\nEste resultado \u00e9 o obtido por Boyer em [4].\n\nPara uso nesta tese desejamos que a dose total seja uma convolu\u00e7\u00e3o da ?u\u00eancia prim\u00e1ria\n\ne da densidade relativa com um n\u00facleo de deposi\u00e7\u00e3o de energia, e assim sugerimos a seguinte\n\naproxima\u00e7\u00e3o para a fun\u00e7\u00e3o da fonte sm:\n\ns0m (\n?!r ) =\n\nZ Z Z\nV\n?p\n\n??!r 0? e???!r 0? ? ek0s ??!r ? ?!r 0? ? dV 0 (2.89)\ns1m (\n\n?!r ) =\nZ Z Z\n\nV\n?p\n\n??!r 0? e???!r 0?\n??1 ? e???!r 0?? ek1s ??!r ? ?!r 0? ? dV 0 (2.90)\n\nonde desconsideramos a corre\u00e7\u00e3o da densidade relativa agindo sobre a fonte sm.\n\nAssim a dose de m\u00faltiplo espalhamento pode ser escrita da mesma forma que as outras\n\ncomponentes da dose:\n\nD0m (\n?!r ) =\n\nZ Z Z\nV\n?p\n\n??!r 0? e???!r 0?k0s;m ??!r ? ?!r 0?dV 0 (2.91)\n29\n\n\n\nD1m (\n?!r ) =\n\nZ Z Z\nV\n?p\n\n??!r 0? e???!r 0??1 ? e???!r 0??k1s;m ??!r ? ?!r 0?dV 0 (2.92)\nsendo k0s;m e k\n\n1\ns;m calculados da mesma maneira sugerida pela equa\u00e7\u00e3o 2.49.\n\nEsta \u00e9 uma aproxima\u00e7\u00e3o v\u00e1lida porque sabemos que a dose de m\u00faltiplo espalhamento\n\n\u00e9 uma fra\u00e7\u00e3o pequena da dose total, e que corre\u00e7\u00f5es deste tipo podem ser desprezadas [3].\n\nNotamos tamb\u00e9m que a dose de m\u00faltiplo espalhamento para meios heterog\u00eaneos se reduz \u00e0\n\nrespectiva express\u00e3o para meios homog\u00eaneos quando a densidade relativa for unit\u00e1ria.\n\n2.5.4 A dose total\n\nA dose total ser\u00e1 formada pela soma das doses parciais Dp, Ds e Dm. Devido \u00e0s corre\u00e7\u00f5es da\n\ndose em primeira ordem n\u00e3o poderemos calcular a dose total realizando apenas uma integral\n\nde convolu\u00e7\u00e3o como foi feito na equa\u00e7\u00e3o 2.53. Neste caso vamos necessitar do c\u00e1lculo de\n\nduas integrais de convolu\u00e7\u00e3o para conseguirmos a dose total D (?!r ):\n\nD (?!r ) = D0 (?!r ) + D1 (?!r ) (2.93)\n\nsendo D0 uma convolu\u00e7\u00e3o onde temos como n\u00facleo a soma da dose prim\u00e1ria com a aproxi-\n\nma\u00e7\u00e3o em primeira ordem da dose secund\u00e1ria e de m\u00faltiplo espalhamento:\n\nD0 (?!r ) =\nZ\nV\n?p\n\n??!r 0? ? e???!r 0? ? k0 ??!r ? ?!r 0? ? dV 0 (2.94)\nk0\n??!r ? ?!r 0? = kp ??!r ? ?!r 0? + k0s ??!r ? ?!r 0? + k0s;m ??!r ? ?!r 0? (2.95)\n\nD1 ser\u00e1 composta pela soma da aproxima\u00e7\u00e3o de primeira ordem da dose secund\u00e1ria com\n\na respectiva aproxima\u00e7\u00e3o da dose de m\u00faltiplo espalhamento:\n\nD1 (?!r ) =\nZ\nV\n?p\n\n??!r 0? ? e???!r 0??1 ? e???!r 0?? ? k1 ??!r ? ?!r 0? ? dV 0 (2.96)\nk1\n??!r ? ?!r 0? = k1s ??!r ? ?!r 0? + k1s;m ??!r ? ?!r 0? (2.97)\n\nConclu\u00edmos, portanto, chegando a um modelo te\u00f3rico para o c\u00e1lculo da dose de radia\u00e7\u00e3o\n\nem que fazemos as corre\u00e7\u00f5es de densidade de estruturas heterog\u00eaneas. Este modelo apresenta\n\numa boa concord\u00e2ncia com dados experimentais [4] em que as estruturas heterog\u00eaneas t\u00eam\n\naproximadamente o mesmo n\u00famero at\u00f4mico efetivo que o da \u00e1gua, diferindo apenas em sua\n\ndensidade. Por\u00e9m n\u00e3o \u00e9 esperado que ele apresente um bom resultado quando aplicado a\n\nmeios onde as estruturas heterog\u00eaneas tenham um n\u00famero at\u00f4mico efetivo muito diferente\n\n30\n\n\n\ndo da \u00e1gua, pois este fato implicaria em um modelo onde k0 e k1 dependessem da posi\u00e7\u00e3o\n\nonde a integral D0 ou D1 fossem calculadas, impedindo que as express\u00f5es para a dose fossem\n\nescritas na forma de convolu\u00e7\u00e3o.\n\n31\n\n\n\n32\n\n\n\nCap\u00edtulo 3\n\nSimula\u00e7\u00e3o por Monte Carlo\n\nComo mostramos no cap\u00edtulo anterior, a dose absorvida pelo meio em um determinado ponto\n\ndepende de el\u00e9trons e f\u00f3tons lan\u00e7ados em outro local. O equacionamento do transporte de\n\nf\u00f3tons ap\u00f3s algumas colis\u00f5es se torna complexo e o de el\u00e9trons quase imposs\u00edvel devido\n\n\u00e0 grande variedade de processos e a enorme quantidade de colis\u00f5es aleat\u00f3rias. Por este\n\nmotivo n\u00e3o conseguimos determinar a dose atrav\u00e9s de m\u00e9todos anal\u00edticos sem fazer certas\n\naproxima\u00e7\u00f5es. Uma outra forma de obtermos estas informa\u00e7\u00f5es, e tamb\u00e9m a mais precisa,\n\n\u00e9 por meio de simula\u00e7\u00e3o de Monte Carlo.\n\nT\u00e9cnicas de simula\u00e7\u00f5es s\u00e3o amplamente usadas em pesquisas f\u00edsicas onde desejamos ter\n\nacesso a certas grandezas que n\u00e3o podem ser medidas e nem analiticamente equacionadas. A\n\nsimula\u00e7\u00e3o das intera\u00e7\u00f5es eletromagn\u00e9ticas consiste no uso das distribui\u00e7\u00f5es de probabilidades\n\nde colis\u00e3o individual de el\u00e9trons, p\u00f3sitrons e f\u00f3tons com a mat\u00e9ria para encontrar o trajeto\n\na ser percorrido por cada part\u00edcula e as energias das part\u00edculas produzidas. Nestes processos\n\narmazenamos as quantidades f\u00edsicas de interesse em nossos estudos.\n\nDiscutiremos neste cap\u00edtulo o programa adotado de simula\u00e7\u00e3o EGS4 (Electron Gam-\n\nma Shower)[12] e o m\u00e9todo que o mesmo usa para simular as intera\u00e7\u00f5es eletromagn\u00e9ticas.\n\nApresentaremos tamb\u00e9m o tratamento aplicado \u00e0s simula\u00e7\u00f5es dos n\u00facleos de deposi\u00e7\u00e3o de\n\nenergia estudados teoricamente.\n\n3.1 O programa de simula\u00e7\u00e3o EGS4\n\nO sistema EGS \u00e9 um pacote de rotinas de simula\u00e7\u00e3o de intera\u00e7\u00f5es eletromagn\u00e9ticas desen-\n\nvolvido pelos pesquisadores do SLAC (Stanford Linear Accelerator Center) em 1978 com o\n\nobjetivo de estudar as intera\u00e7\u00f5es eletromagn\u00e9ticas em aceleradores. As primeiras distribui-\n\n\u00e7\u00f5es tinham como limite inferior de energia para o transporte de f\u00f3tons a energia de 100 keV\n\n33\n\n\n\ne 1 MeV para el\u00e9trons. Por\u00e9m a popularidade deste programa cresceu principalmente quan-\n\ndo estes limites inferiores ca\u00edram para 1 keV (f\u00f3tons) e 10 keV (el\u00e9trons), mostrando que o\n\nprograma foi muito bem recebido pelos pesquisadores que trabalhavam a baixas energias. A\n\nvers\u00e3o EGS4 foi lan\u00e7ada em 1985, consolidando estes desenvolvimentos.\n\nOutro fato que nos auxiliou na ado\u00e7\u00e3o do EGS4 foi a facilidade na obten\u00e7\u00e3o do programa\n\nvia rede mundial de computadores.\n\nAs rotinas s\u00e3o escritas em Mortran3, uma linguagem de programa\u00e7\u00e3o que permite ao\n\nusu\u00e1rio tanto chamar as rotinas do EGS4, como processar os dados que est\u00e3o sendo simula-\n\ndos.\n\n3.2 O processo de simula\u00e7\u00e3o\n\nQuando transportamos um f\u00f3ton atrav\u00e9s de um meio material in?nito, em algum ponto\n\nocorrer\u00e1 uma intera\u00e7\u00e3o (colis\u00e3o) deste f\u00f3ton com o meio. O ponto onde ocorre esta intera\u00e7\u00e3o\n\n\u00e9 de natureza aleat\u00f3ria, por\u00e9m a fun\u00e7\u00e3o que determina esta probabilidade \u00e9 bem conhecida.\n\nEnt\u00e3o podemos simular no computador o que acontece na pr\u00e1tica, sorteando a partir da\n\ndistribui\u00e7\u00e3o de probabilidades o ponto onde o f\u00f3ton colide.\n\nO estado do sistema ap\u00f3s esta primeira intera\u00e7\u00e3o tamb\u00e9m pode ser sorteado, bastando\n\nsaber as distribui\u00e7\u00e3o de probabilidades dos poss\u00edveis processos e da dire\u00e7\u00e3o ?nal das part\u00ed-\n\nculas envolvidas. Este m\u00e9todo pode ser aplicado sucessivamente at\u00e9 que todas as part\u00edculas\n\n?lhas sejam freadas pelo meio material.\n\nVamos denotar uma vari\u00e1vel aleat\u00f3ria por bx e a probabilidade desta vari\u00e1vel estar contida\nno intervalo (a;b) por Pr fa &lt;bx &lt;bg. Podemos de?nir uma fun\u00e7\u00e3o de distribui\u00e7\u00e3o (ou\nfun\u00e7\u00e3o de distribui\u00e7\u00e3o cumulativa) como\n\nF (x) = Pr fbx &lt;xg (3.1)\nSe F (x) for diferenci\u00e1vel, ent\u00e3o a primeira derivada desta fun\u00e7\u00e3o de distribui\u00e7\u00e3o, f (x) =\n\ndF (x) =dx, \u00e9 chamada de fun\u00e7\u00e3o densidade de probabilidade, e vale a rela\u00e7\u00e3o:\n\nPr fa &lt;bx &lt;bg = Z b\na\nf (x) ? dx (3.2)\n\nNa pr\u00e1tica quase todos os m\u00e9todos de sorteio baseiam-se na possibilidade de gerar em\n\ncomputadores seq\u00fc\u00eancias de n\u00fameros aleat\u00f3rios distribu\u00eddos segundo uma f (x), a partir\n\nde uma seq\u00fc\u00eancia de n\u00fameros aleat\u00f3rios uniformemente distribu\u00eddos entre 0 e 1. Se b? for\numa vari\u00e1vel rand\u00f4mica uniformemente distribu\u00edda e seu valor sorteado for ?, ent\u00e3o pode-se\n\n34\n\n\n\nsortear um valor da vari\u00e1vel bx, a partir do valor de ?, pelo chamado m\u00e9todo da invers\u00e3o:\nF (x) = ? (3.3)\n\ne resolvendo para x:\n\nx = F?1 (?) (3.4)\n\nPara tal \u00e9 importante atentar para que a F (x) esteja normalizada no intervalo da vari\u00e1velbx, (a;b).\nExiste um outro procedimento que \u00e9 muito usado em casos onde a fun\u00e7\u00e3o a ser simulada\n\n\u00e9 bastante complexa, que chamamos de composi\u00e7\u00e3o e rejei\u00e7\u00e3o. Como o pr\u00f3prio nome sugere,\n\neste m\u00e9todo \u00e9 uma combina\u00e7\u00e3o das t\u00e9cnicas de composi\u00e7\u00e3o e rejei\u00e7\u00e3o, baseado nos conceitos\n\nelementares de probabilidade. Assim, se uma fun\u00e7\u00e3o de densidade de probabilidade h (x)\n\npuder ser decomposta da seguinte forma:\n\nh (x) =\nnX\ni=1\n\n?ifi (x) gi (x) (3.5)\n\nsendo ?i um n\u00famero real positivo que corresponde ao peso atribu\u00eddo \u00e0 parcela fi (x). A\n\nfun\u00e7\u00e3o h (x), assim como cada fi (x) devem estar normalizadas no intervalo de de?ni\u00e7\u00e3o\n\nda vari\u00e1vel x. O somat\u00f3rio\nPn\n\ni=1 ?ifi (x) \u00e9 conhecido como fun\u00e7\u00e3o de composi\u00e7\u00e3o, dada\n\npela de?ni\u00e7\u00e3o elementar de probabilidade, onde diferentes processos podem acontecer com\n\ndiferentes pesos (?i). gi (x) \u00e9 uma fun\u00e7\u00e3o de rejei\u00e7\u00e3o e deve estar contida em [0; 1].\n\nDesta maneira o processo de simula\u00e7\u00e3o da express\u00e3o 3.5 ?ca:\n\n1. Escolhemos a parcela i dos n elementos do somat\u00f3rio de acordo com a express\u00e3o\n\nPi?1\nj=1 ?jPn\nj=1 ?j i\n\n&lt;?1 ?\nPi\n\nj=1 ?jPn\nj=1 ?j\n\n(3.6)\n\nonde ?1 \u00e9 um n\u00famero aleat\u00f3rio entre [0; 1]. Digamos que seja encontrado i = 4.\n\n2. Sorteamos outro n\u00famero aleat\u00f3rio ?2 e encontramos x de f4 (x) resolvendo a integralR x\na f4 (x\n\n0) dx0 = ?2, como mostramos na ?gura 3.1. Em outras palavras usa-se o m\u00e9todo\n\nda invers\u00e3o para a fun\u00e7\u00e3o f4 (x).\n\n3. Com ?3 terminamos por aceitar ou n\u00e3o o valor sorteado de x se ?3 ? g4 (x) ou\nrejeitando-o, caso ?3 > g4 (x); a ?gura 3.2 nos mostra este processo gra?camente.\n\n35\n\n\n\nf (x\u2019 )\n\nx\u2019\n\n44\n\n??22\n\nxxaa bb\n\nFigura 3.1: A fun\u00e7\u00e3o de composi\u00e7\u00e3o\n\nFigura 3.2: A fun\u00e7\u00e3o de composi\u00e7\u00e3o.\n\n36\n\n\n\n4. Repete-se este processo retornando ao passo 1 at\u00e9 ser atingido o n\u00famero de hist\u00f3rias\n\ndesejadas.\n\nAs vari\u00e1veis at\u00e9 ent\u00e3o chamadas de aleat\u00f3rias s\u00e3o na realidade pseudo-aleat\u00f3rias, pois s\u00e3o\n\ngeradas por algoritmos espec\u00ed?cos. Tais algoritmos necessitam de, pelo menos, um n\u00famero\n\npara iniciar a seq\u00fc\u00eancia de n\u00famero aleat\u00f3rios. Este n\u00famero \u00e9 conhecido como semente para o\n\nn\u00famero pseudo-aleat\u00f3rio. Ent\u00e3o, ao repetirmos a semente em um programa de simula\u00e7\u00e3o no\n\nmesmo equipamento, a seq\u00fc\u00eancia de n\u00fameros pseudo-aleat\u00f3rios gerados ser\u00e1 rigorosamente\n\na mesma. Este fato ser\u00e1 explorado na se\u00e7\u00e3o 3.3.\n\n3.2.1 A simula\u00e7\u00e3o dos processos f\u00edsicos\n\nO livre caminho m\u00e9dio ? de uma part\u00edcula \u00e9 dado por\n\n? =\n1\n\n?t\n=\n\nM\n\n? ? Na ? ?t\n(3.7)\n\nsendo ? a densidade do material, Na o n\u00famero de Avogadro, M o peso molecular e ?t a se\u00e7\u00e3o\n\nde choque total por mol\u00e9cula. ?t \u00e9 a se\u00e7\u00e3o de choque total macrosc\u00f3pica. Sendo a fun\u00e7\u00e3o de\n\ndensidade de probabilidade e?r\n0=?dr0=?, o ponto onde ir\u00e1 ocorrer a primeira intera\u00e7\u00e3o ser\u00e1\n\ndado por:\n\nZ ?\n0\nd?0 =\n\nZ r\n0\ne?r\n\n0=? dr\n0\n\n?\n(3.8)\n\n1 ? ? = e?r=? (3.9)\n\nonde ? \u00e9 um valor da vari\u00e1vel aleat\u00f3ria distribu\u00edda uniformemente em [0; 1], r \u00e9 a dist\u00e2ncia\n\nat\u00e9 o ponto de intera\u00e7\u00e3o. Se b? \u00e9 uma vari\u00e1vel aleat\u00f3ria distribu\u00edda uniformemente entre o\nintervalo [0,1], 1 ? b? = b? tamb\u00e9m o \u00e9. Assim podemos relacionar o ponto de intera\u00e7\u00e3o r\ndiretamente com o n\u00famero aleat\u00f3rio por\n\nr = ?? ln? (3.10)\n\nTipicamente o livre caminho m\u00e9dio depende da posi\u00e7\u00e3o, de mudan\u00e7as de material ou,\n\nno caso de part\u00edculas carregadas, da energia, devido a perdas de energia para a ioniza\u00e7\u00e3o do\n\nmeio [12]. Para sortear r atrav\u00e9s da equa\u00e7\u00e3o 3.10 considera-se ? constante.\n\nAp\u00f3s sabermos onde a part\u00edcula ir\u00e1 interagir, devemos sortear um dos processos f\u00edsicos\n\nposs\u00edveis, cuja probabilidade \u00e9 proporcional \u00e0s se\u00e7\u00f5es de choque individuais.\n\n37\n\n\n\nO EGS4 faz a simula\u00e7\u00e3o do transporte e deposi\u00e7\u00e3o de energia de f\u00f3tons, el\u00e9trons, p\u00f3si-\n\ntrons, part\u00edcula por part\u00edcula. Os seguintes processos de intera\u00e7\u00e3o dos f\u00f3tons com a mat\u00e9ria\n\ns\u00e3o considerados no EGS4:\n\n? efeito fotoel\u00e9trico;\n\n? efeito Compton;\n\n? produ\u00e7\u00e3o de pares;\n\n? espalhamento Rayleigh.\n\nPara as part\u00edculas carregadas os processos s\u00e3o:\n\n? espalhamento M\u00f6ller;\n\n? espalhamento Bhabha;\n\n? aniquila\u00e7\u00e3o de par el\u00e9tron-p\u00f3sitron;\n\n? bremsstrahlung;\n\n? m\u00faltiplo espalhamento coulombiano;\n\n? perda cont\u00ednua de energia.\n\nEste \u00faltimo item \u00e9 o respons\u00e1vel pela deposi\u00e7\u00e3o da dose de radia\u00e7\u00e3o ao longo da trajet\u00f3ria\n\nda part\u00edcula carregada.\n\nAs equa\u00e7\u00f5es para as se\u00e7\u00f5es de choque e a forma como foram computacionalmente im-\n\nplementadas est\u00e3o no manual do EGS4 [12].\n\nO procedimento de transporte das part\u00edculas carregadas em um meio material \u00e9 mais\n\ncomplicado que o de f\u00f3tons porque as part\u00edculas como el\u00e9trons e p\u00f3sitrons possuem um livre\n\ncaminho m\u00e9dio tipicamente muito menor que o do f\u00f3ton, tornando o processo de simula\u00e7\u00e3o\n\nde el\u00e9trons e p\u00f3sitrons extremamente complicado. Quando um el\u00e9tron, por exemplo, recebe\n\numa quantidade de energia cin\u00e9tica ele, ao se deslocar pelo meio, sofre uma enorme quantida-\n\nde de colis\u00f5es el\u00e1sticas, al\u00e9m de outros processos. Para resolver este problema os programas\n\nde simula\u00e7\u00e3o recorrem aos modelos que tratam o m\u00faltiplo espalhamento coulombiano. O\n\ntratamento que o EGS4 usa para este processo \u00e9 o estudo de Moli\u00e8re que posteriormente foi\n\nsimpli?cado por Bethe.\n\nEste tratamento tende a ser um dos pontos mais cr\u00edticos deste tipo de simulador, porque\n\numa colis\u00e3o onde haja uma troca de energia acima de certo valor m\u00ednimo pr\u00e9-estabelecido\n\n38\n\n\n\ndeve ser tratada como um evento onde as part\u00edculas secund\u00e1rias geradas por esta colis\u00e3o\n\nsejam transportadas individualmente, caso contr\u00e1rio a colis\u00e3o n\u00e3o ser\u00e1 discreta. Geralmente\n\nos simuladores de intera\u00e7\u00f5es eletromagn\u00e9ticas s\u00e3o divididos em duas classes: os de classe\n\nI, que usam o modelo CSDA (Continuous Slowing Down Approximation) onde part\u00edculas\n\nsecund\u00e1rias n\u00e3o s\u00e3o criadas [13], simpli?cando este processo; e os de classe II, que fazem\n\ntodo o tratamento de cria\u00e7\u00e3o e transporte de part\u00edculas secund\u00e1rias.\n\nNo EGS4 existem vari\u00e1veis espec\u00ed?cas destinadas \u00e0 distin\u00e7\u00e3o entre os processos de espa-\n\nlhamento m\u00faltiplo e discreto durante o transporte. A vari\u00e1vel AE de?ne a energia m\u00ednima\n\nem que uma colis\u00e3o de uma part\u00edcula carregada com a mat\u00e9ria ser\u00e1 tratada como discreta,\n\ne a AP de?ne a energia m\u00ednima para que um f\u00f3ton seja produzido por bremsstrahlung.\n\n3.3 Simulando os n\u00facleos de deposi\u00e7\u00e3o de energia\n\nOs n\u00facleos de convolu\u00e7\u00e3o s\u00e3o interpretados como a fun\u00e7\u00e3o que deposita a energia transpor-\n\ntada pelo feixe de part\u00edculas, sejam elas f\u00f3tons, el\u00e9trons, etc.\n\nAs formas existentes para obtermos este n\u00facleo s\u00e3o:\n\n? deconvolu\u00e7\u00e3o da dose medida em \u00e1gua;\n\n? c\u00e1lculo anal\u00edtico;\n\n? simula\u00e7\u00e3o de Monte Carlo.\n\nO primeiro envolve a medida da deposi\u00e7\u00e3o de dose de feixes estreitos em um tanque de\n\n\u00e1gua, e sua posterior deconvolu\u00e7\u00e3o[14]. Esse m\u00e9todo gera apenas um n\u00facleo de convolu\u00e7\u00e3o\n\nrelacionado \u00e0 deposi\u00e7\u00e3o total da dose e est\u00e1 limitado \u00e0 precis\u00e3o em que foram feitas as\n\nmedidas.\n\nO c\u00e1lculo anal\u00edtico nos permite entender por meio de quais processos a dose \u00e9 distribu\u00edda,\n\nisto \u00e9, permite-nos compreender a f\u00edsica do problema. Por\u00e9m n\u00e3o apresenta bons resultados\n\npara as deposi\u00e7\u00f5es de energia devido aos m\u00faltiplos espalhamentos de f\u00f3tons. Estes espalha-\n\nmentos s\u00e3o dif\u00edceis de serem modelados analiticamente, sendo usual a sua aproxima\u00e7\u00e3o pela\n\nteoria da difus\u00e3o [3, 4].\n\nEm contrapartida, a simula\u00e7\u00e3o de Monte Carlo nos permite obter bons resultados em uma\n\nampla faixa de energias porque n\u00e3o exige que todas as intera\u00e7\u00f5es sejam por efeito Compton\n\ne tamb\u00e9m porque transporta igualmente bem ordens baixas e altas de espalhamentos de\n\nf\u00f3tons.\n\n39\n\n\n\nSendo assim usamos os conceitos estudados no cap\u00edtulo 2 para simular os n\u00facleos de\n\ndeposi\u00e7\u00e3o de energia, com a diferen\u00e7a de que nesta disserta\u00e7\u00e3o n\u00e3o restringimos os processos\n\nsomente ao efeito Compton, como o modelo te\u00f3rico aproxima.\n\n3.3.1 O M\u00e9todo usado nas simula\u00e7\u00f5es\n\nA simula\u00e7\u00e3o dos n\u00facleos consiste em fazer incidir um feixe estreito de f\u00f3tons (\u00e1rea zero) sobre\n\num meio material e for\u00e7\u00e1-lo a ter sua primeira intera\u00e7\u00e3o em um ponto conhecido dentro do\n\nmeio material. Ap\u00f3s esta intera\u00e7\u00e3o, come\u00e7amos a transportar normalmente as part\u00edculas\n\ne a contabilizar separadamente as energias relacionadas a cada ordem de espalhamento.\n\nAssim como na teoria, teremos um grupo de deposi\u00e7\u00e3o para a energia prim\u00e1ria, um para\n\na secund\u00e1ria e outro para os espalhamentos de terceira ordem e superiores. Para tanto\n\nadaptamos um programa chamado XYZP1 que aplica as rotinas do EGS4 na simula\u00e7\u00e3o das\n\nintera\u00e7\u00f5es de um feixe de part\u00edculas com a mat\u00e9ria e obt\u00e9m a energia absorvida por este\n\nmeio. As part\u00edculas incidentes s\u00e3o for\u00e7adas a terem a sua primeira intera\u00e7\u00e3o em um ponto\n\n?xo porque estamos buscando a fun\u00e7\u00e3o de espalhamento de ponto (PSF).\n\nA simula\u00e7\u00e3o \u00e9 feita em tr\u00eas dimens\u00f5es onde o meio \u00e9 subdividido em c\u00e9lulas c\u00fabicas\n\ne indexadas em um sistema cartesiano de eixos coordenados. Originalmente o programa\n\nXYZP faz a simula\u00e7\u00e3o de feixes paralelos de part\u00edculas incidentes em um meio material e\n\ncontabiliza a dose absorvida por este meio.\n\n3.3.1.1 A geometria e as t\u00e9cnicas utilizadas\n\nO meio usado foi um cubo de \u00e1gua subdividido em c\u00e9lulas c\u00fabicas, cercado por v\u00e1cuo,\n\nconforme mostrado ?gura 3.3. Nessas c\u00e9lulas s\u00e3o contabilizadas as energias transferidas dos\n\nel\u00e9trons e p\u00f3sitrons para o meio material. Este tanque de \u00e1gua recebe um feixe de f\u00f3tons\n\nque incide perpendicularmente na dire\u00e7\u00e3o convencionada como o eixo z, na ?gura 3.4.\n\nTodo este trabalho \u00e9 baseado na refer\u00eancia [15]. Neste artigo o autor ataca o proble-\n\nma em coordenadas esf\u00e9ricas atrav\u00e9s de um programa criado por eles mesmos, o SCASPH.\n\nEmbora este sistema de coordenadas seja a melhor alternativa para a gera\u00e7\u00e3o de n\u00facleos de\n\nconvolu\u00e7\u00e3o, as coordenadas esf\u00e9ricas n\u00e3o s\u00e3o t\u00e3o pr\u00e1ticas, porque elas precisam ser conver-\n\ntidas em cartesianas respeitando-se a periodicidade amostral usada na ?u\u00eancia, a qual deve\n\nser constante2. Temos tamb\u00e9m o interesse, neste trabalho, de instalar, testar e interagir\n\ncom as rotinas do EGS4 atrav\u00e9s da modi?ca\u00e7\u00e3o de programas j\u00e1 existentes, introduzindo\n\no uso do mesmo no nosso grupo de F\u00edsica M\u00e9dica pertencente ao Centro de Engenharia\n1Este programa pertence ao pacote do EGS4.\n2Condi\u00e7\u00e3o necess\u00e1ria para os algoritmos de transformada de Fourier r\u00e1pida, discutida no cap\u00edtulo seguinte.\n\n40\n\n\n\n(0,0,0) (0,M,0)(0,1,0)\n\n(L,0,0) (L,1,0)\n\n(0,0,N)\n\n(0,M,N)\n\nFigura 3.3: A subdivis\u00e3o do meio usado nas simula\u00e7\u00f5es.\n\nZZ YY\n\nXX\n\n??\n\nFigura 3.4: Geometria simulada e os eixos coordenados\n\n41\n\n\n\nBiom\u00e9dica da Unicamp (CEB - Unicamp). Estes s\u00e3o os principais motivos para adotarmos\n\nas coordenadas cartesianas.\n\nUsamos a unidade gray para contabilizar a dose absorvida em cada c\u00e9lula. Esta dose \u00e9\n\ndividida pelo n\u00famero de f\u00f3tons incidentes, assim teremos um resultado que \u00e9 independente\n\ndo n\u00famero de hist\u00f3rias.\n\n3.3.1.2 Os par\u00e2metros da simula\u00e7\u00e3o\n\nEscolhemos a energia de 1,25 MeV para o feixe prim\u00e1rio de f\u00f3tons pois representa a m\u00e9dia\n\ndas duas linhas de emiss\u00e3o de \n do 60Co3. O meio absorvedor usado \u00e9 a \u00e1gua, de densidade\n\n1g=cm3.\n\nOs dados sobre a se\u00e7\u00e3o de choque foram gerados pelo PEGS conforme apresentado no\n\nap\u00eandice E.\n\nOs principais par\u00e2metros usados no EGS4, bem como na execu\u00e7\u00e3o do PEGS, est\u00e3o na\n\ntabela 3.1. Destes, apenas o AE e AP s\u00e3o ajustados durante a execu\u00e7\u00e3o do PEGS. Os valores\n\nNome do par\u00e2metro Descri\u00e7\u00e3o Valores usados\n\nEI Energia do f\u00f3ton incidente 1,25 MeV\nNCASE N\u00famero de hist\u00f3rias 107\n\nESTEPE M\u00e1xima fra\u00e7\u00e3o da energia perdida em cada passo\npelo processo de perda cont\u00ednua de energia\n\n0,02\n\nECUT Energia cin\u00e9tica m\u00ednima das part\u00edculas carregadas\n(cut-o? )\n\n50 keV\n\nAE Energia m\u00ednima para a produ\u00e7\u00e3o de el\u00e9trons se-\ncund\u00e1rios\n\n50 keV\n\nPCUT Energia m\u00ednima dos f\u00f3tons (cuto? ) 50 keV\nAP Energia m\u00ednima para a produ\u00e7\u00e3o de f\u00f3tons secun-\n\nd\u00e1rios\n50 keV\n\nTabela 3.1: Par\u00e2metros usados nas simula\u00e7\u00f5es\n\nde ECUT, PCUT, AP e AE usados s\u00e3o baseados em [15].\n\nESTEPE \u00e9 a m\u00e1xima fra\u00e7\u00e3o da energia cin\u00e9tica do el\u00e9tron (p\u00f3sitron) transferida para o\n\nmeio pelo processo de perda cont\u00ednua de energia. Esta vari\u00e1vel limita diretamente o espa\u00e7o\n\npercorrido pelo el\u00e9tron a cada transporte. O valor para esta vari\u00e1vel, mostrado na tabela\n\n3.1, \u00e9 o sugerido por [15] e fundamentado pelos estudos de [13, 17].\n\nValores menores que os apresentados na tabela 3.1 n\u00e3o alteram substancialmente o re-\n\nsultado mas aumentam o tempo de simula\u00e7\u00e3o.\n3As linhas s\u00e3o: 1,127MeV e 1,33 MeV[16]\n\n42\n\n\n\n3.3.1.3 A contabiliza\u00e7\u00e3o da energia depositada\n\nO feixe de f\u00f3tons que incide perpendicularmente \u00e0 superf\u00edcie xy do cubo de \u00e1gua possui\n\n\u00e1rea zero4, isto \u00e9, ele \u00e9 ideal. ?For\u00e7amos? todos os f\u00f3tons a terem sua primeira intera\u00e7\u00e3o a\n\numa profundidade conhecida, exatamente no centro de uma c\u00e9lula. A profundidade pode\n\nser escolhida de tal maneira que todo o m\u00e1ximo de energia seja depositada dentro do meio.\n\nA maneira como alteramos o programa XYZP para que ele simulasse os n\u00facleos de\n\nconvolu\u00e7\u00e3o \u00e9 descrita no ap\u00eandice D.\n\nPor conven\u00e7\u00e3o, a face xy por onde entra a part\u00edcula tem como coordenada espacial de\n\nprofundidade z = 0, e este valor aumenta com o aumento da profundidade, da mesma forma\n\nos \u00edndices das c\u00e9lulas tamb\u00e9m aumentam na mesma dire\u00e7\u00e3o dos eixos. Todo este tanque de\n\n\u00e1gua \u00e9 cercado por v\u00e1cuo, por isso cada part\u00edcula que ultrapassar as fronteiras deste tanque\n\nter\u00e1 sua hist\u00f3ria terminada.\n\nNa ?gura 3.5 temos esquematizado o processo completo de simula\u00e7\u00e3o dos n\u00facleos de\n\nconvolu\u00e7\u00e3o que ser\u00e1 descrito em mais detalhes a seguir. Para cada esp\u00e9cie de n\u00facleo simulado\n\n?zemos um programa espec\u00ed?co. Deste modo, cada n\u00facleo foi simulado separadamente.\n\n3.3.1.4 N\u00facleo prim\u00e1rio\n\nPara o n\u00facleo prim\u00e1rio desejamos saber como \u00e9 a deposi\u00e7\u00e3o da dose devido aos el\u00e9trons e\n\np\u00f3sitrons gerados na primeira intera\u00e7\u00e3o, conforme mostrado na ?gura 3.5. Assim na simula-\n\n\u00e7\u00e3o do n\u00facleo prim\u00e1rio o f\u00f3ton incidente interage no ponto desejado e s\u00e3o transportadas as\n\npart\u00edculas carregadas criadas e sua energia \u00e9 transferida para o meio. O primeiro processo\n\n\u00e9 aleat\u00f3rio e pode ser qualquer uma dos apresentados anteriormente5. Qualquer f\u00f3ton que\n\nvenha a ser gerado nesta primeira intera\u00e7\u00e3o ou nas posteriores n\u00e3o ser\u00e1 transportado.\n\n3.3.1.5 N\u00facleo secund\u00e1rio\n\nO n\u00facleo secund\u00e1rio de deposi\u00e7\u00e3o de energia contabiliza somente as part\u00edculas carregadas\n\nlan\u00e7adas pelo f\u00f3ton secund\u00e1rio. Este f\u00f3ton existe somente se a primeira intera\u00e7\u00e3o for por\n\nefeito Compton, caso contr\u00e1rio a hist\u00f3ria \u00e9 imediatamente terminada. Ent\u00e3o, saindo da\n\nprimeira intera\u00e7\u00e3o, o f\u00f3ton secund\u00e1rio ser\u00e1 simulado sem nenhuma outra interven\u00e7\u00e3o. Na\n\nsegunda intera\u00e7\u00e3o as part\u00edculas carregadas ser\u00e3o transportadas sem restri\u00e7\u00f5es. O processo\n\npelo qual ocorre a segunda intera\u00e7\u00e3o do f\u00f3ton tamb\u00e9m \u00e9 livre. Quaisquer f\u00f3tons gerados\n\nap\u00f3s a segunda colis\u00e3o ser\u00e3o descartados.\n4Tamb\u00e9m conhecido como pencil beam.\n5Exceto Rayleigh porque o XYZP n\u00e3o usa este processo. Tal processo tamb\u00e9m n\u00e3o transfere energia e,\n\ncomo um todo, n\u00e3o \u00e9 muito prov\u00e1vel de acontecer. A n\u00e3o ativa\u00e7\u00e3o desta op\u00e7\u00e3o reduz o tempo de simula\u00e7\u00e3o.\n\n43\n\n\n\nEnergia \ndos f\u00f3tons\nprim\u00e1rios\n\nEnergia\ncin\u00e9tica da\npart\u00edcula\ncarregada\nprim\u00e1ria\n\nEnergia \nprim\u00e1ria\ndepositada\n\nOs f\u00f3tons de \nbremsstrahlung e \naniquila\u00e7\u00e3o de pares \ns\u00e3o descartados\n\nEnergia dos \nf\u00f3tons \nsecund\u00e1rios\n\nEnergia cin\u00e9tica das \npart\u00edculas carregadas \nsecund\u00e1rias\n\nEnergia \nsecund\u00e1ria \ndepositada\n\nEnergia dos f\u00f3tons \nde terceira ordem \ne superiores\n\nEnergia cin\u00e9tica das \npart\u00edculas carregadas \nde terceira ordem e \nsuperiores depositada\n\nTransporte e deposi\u00e7\u00e3o \nda energia dos f\u00f3tons \nde bremsstrahlung e \naniquila\u00e7\u00e3o de pares\n\nEnergia cin\u00e9tica \ndepositada\n\nF\nigu\n\nra\n3.5:\n\nO\norgan\n\nogram\na\nd\no\np\nro\ncesso\n\nd\ne\nsim\n\nu\nla\u00e7\u00e3o\n\nd\nos\n\nn\n\u00fa\ncleos\n\nd\ne\ncon\n\nvolu\n\u00e7\u00e3o\n\n44\n\n\n\n3.3.1.6 N\u00facleo de m\u00faltiplo espalhamento\n\nNeste n\u00facleo os primeiros processos de intera\u00e7\u00e3o dos f\u00f3tons ocorrem da mesma forma como\n\nno secund\u00e1rio, por\u00e9m a energia das part\u00edculas secund\u00e1rias n\u00e3o s\u00e3o contabilizadas. Mas agora\n\nn\u00e3o vamos descartar nenhuma outra part\u00edcula ap\u00f3s a terceira intera\u00e7\u00e3o do f\u00f3ton e todas as\n\npart\u00edculas carregadas ser\u00e3o transportadas e contabilizadas normalmente. O processo pelo\n\nqual ocorrem a terceira intera\u00e7\u00e3o e as posteriores tamb\u00e9m n\u00e3o sofre nenhuma restri\u00e7\u00e3o.\n\nNeste n\u00facleo tamb\u00e9m transportaremos e contabilizaremos todos os f\u00f3tons gerados por\n\nbremsstrahlung e aniquila\u00e7\u00e3o de pares (caso haja). Embora no artigo [15] os f\u00f3tons gera-\n\ndos pelo processo de bremsstrahlung e aniquila\u00e7\u00e3o de pares sejam sempre contabilizados\n\nseparadamente, eles possuem uma a?nidade maior com o grupo de m\u00faltiplo espalhamento\n\nde f\u00f3tons. Mas \u00e9 importante lembrar que somente os f\u00f3tons gerados pelas part\u00edculas car-\n\nregadas de terceira ordem ou ordens superiores ser\u00e3o contabilizados no grupo de m\u00faltiplo\n\nespalhamento de f\u00f3tons.\n\n45\n\n\n\n46\n\n\n\nCap\u00edtulo 4\n\nO M\u00e9todo Num\u00e9rico\n\nNeste cap\u00edtulo discutiremos os m\u00e9todos num\u00e9ricos usados para calcular as integrais de con-\n\nvolu\u00e7\u00e3o do cap\u00edtulo 2 usando os n\u00facleos de deposi\u00e7\u00e3o de energia simulados no cap\u00edtulo 3.\n\nPrimeiro veremos como modi?car as express\u00f5es integrais te\u00f3ricas da dose para que pos-\n\nsamos usar os n\u00facleos de deposi\u00e7\u00e3o de energia simulados. A seguir mostraremos como a\n\n?u\u00eancia deve ser discretizada.\n\nPor ?m, discutiremos a t\u00e9cnica de transformada de Fourier r\u00e1pida (em ingl\u00eas Fast Fourier\n\nTransform - FFT) para fazer as convolu\u00e7\u00f5es numericamente.\n\nImplementamos somente o modelo para as doses parciais de ordem zero porque \u00e9 poss\u00edvel\n\nsimular o n\u00facleo desta ordem. Os n\u00facleos de primeira ordem n\u00e3o s\u00e3o facilmente simulados\n\nno EGS4 e este foi o motivo pelo qual n\u00e3o o implementamos.\n\n4.1 O c\u00e1lculo computacional da dose\n\nOs artigos mais antigos apresentam c\u00e1lculos de dose em duas dimens\u00f5es (2D) [3, 4], tendo\n\nintegrado previamente os dados em uma das dire\u00e7\u00f5es perpendiculares ao campo. Optamos\n\npor trabalhar em 3D porque atualmente dispomos de equipamentos capazes de indexar\n\nmatrizes grandes e ao mesmo tempo manter uma boa precis\u00e3o nos resultados.\n\nUsaremos uma matriz de dimens\u00f5es L ? M ? N representando as c\u00e9lulas no meio em\ncoordenadas cartesianas, onde cada c\u00e9lula \u00e9 indexada respectivamente pelos \u00edndices i;j;k\n\ne cont\u00e9m o valor da densidade relativa naquele ponto. O formato dos arquivos de dados\n\ndesta matriz 3D est\u00e1 descrito no ap\u00eandice F. Por quest\u00f5es de economia de mem\u00f3ria so-\n\nmente descreveremos o meio absorvedor nesta matriz, excluindo o ar entre a fonte e o meio\n\n47\n\n\n\nabsorvedor1.\n\nPara efetuarmos os c\u00e1lculos num\u00e9ricos devemos primeiro discretizar as fun\u00e7\u00f5es envolvidas\n\nnas express\u00f5es das convolu\u00e7\u00f5es para as doses parciais, nas equa\u00e7\u00f5es 2.54, 2.73 e 2.85.\n\nA simula\u00e7\u00e3o nos fornece os n\u00facleos de deposi\u00e7\u00e3o de energia discretizados em c\u00e9lulas de\n\n0; 5 ? 0; 5 ? 0; 5 cm3, por isso a ?u\u00eancia tamb\u00e9m ser\u00e1 discretizada em c\u00e9lulas de mesmo\ntamanho. Este \u00e9 o menor elemento de volume a que teremos associado um valor de dose,\n\npor isso o tamanho destas c\u00e9lulas designa a resolu\u00e7\u00e3o espacial.\n\nOs n\u00facleos de deposi\u00e7\u00e3o de energia simulados t\u00eam dimens\u00e3o de gray=f?oton e os apre-\n\nsentados no cap\u00edtulo te\u00f3rico de gray=cm, portanto deveremos modi?car as express\u00f5es das\n\nfun\u00e7\u00f5es envolvidas nos c\u00e1lculos te\u00f3ricos para que possamos usar os n\u00facleos de convolu\u00e7\u00e3o\n\nsimulados.\n\nComo na simula\u00e7\u00e3o dos n\u00facleos consideramos apenas um feixe in?nitesimal (\u00e1rea zero)\n\nde f\u00f3tons, esperamos que a outra fun\u00e7\u00e3o que substituir\u00e1 a ?u\u00eancia na integral de convolu\u00e7\u00e3o\n\nseja apenas o n\u00famero de f\u00f3tons na posi\u00e7\u00e3o ?!r . Assim\n\nD (?!r ) =\nZ Z Z\n\nV\nN\n??!r 0? ? k ??!r ? ?!r 0? ? dV 0 (4.1)\n\nsendo N\n??!r 0? o n\u00famero de f\u00f3tons e k ??!r ? ?!r 0? o n\u00facleo de deposi\u00e7\u00e3o de energia dado\n\nem gray=\n?\nf?otons ? cm3?. Portanto os n\u00facleos de deposi\u00e7\u00e3o de energia simulados devem\n\nser divididos pelo volume das c\u00e9lulas [10]. Assim, quando integrado em todo o espa\u00e7o V ,\n\nteremos a dose ?total? em ?!r daquele tipo de processo descrito pelo n\u00facleo de deposi\u00e7\u00e3o de\nenergia k\n\n??!r ? ?!r 0? e pelo n\u00famero de f\u00f3tons N ??!r 0?.\nEmbora N seja o n\u00famero de f\u00f3tons, continuaremos a trat\u00e1-lo como ?u\u00eancia prim\u00e1ria por\n\nmotivos que ser\u00e3o esclarecidos logo mais.\n\n4.2 A matriz da ?u\u00eancia prim\u00e1ria\n\nOs modelos te\u00f3ricos estudados no cap\u00edtulo 2 se baseiam em uma express\u00e3o para a ?u\u00eancia\n\nonde n\u00e3o consta a diverg\u00eancia geom\u00e9trica. Esta diverg\u00eancia existe e suas caracter\u00edsticas\n\ns\u00e3o inerentes ao equipamento. A m\u00e1quina do CEB de teleterapia \u00e9 composta por uma\n\nfonte em forma de um disco de 2 cm de di\u00e2metro, e por um conjunto de colimadores. A\n\ndist\u00e2ncia da fonte aos colimadores zc \u00e9 de 45 cm [18]. Com esta geometria, um campo de\n\n10?10 cm2 em uma superf\u00edcie plana distante 80 cm da fonte se tornaria de 13; 75?13; 75 cm2\na uma profundidade de 30 cm da superf\u00edcie. Note que estamos tratando a diverg\u00eancia como\n\n1Desprezamos o espalhamento dos f\u00f3tons pelo ar.\n\n48\n\n\n\ngeom\u00e9trica apenas, porque a queda com o inverso do quadrado da dist\u00e2ncia foi preservada\n\ndurante os estudos te\u00f3ricos.\n\nFonte\n\nzz\n\nzz\n\nzz\n00\n\ncc\n\n?? 00\n22\n\n??\n22\n\ncolimadores\n\nsuperf\u00edcie\n\nFigura 4.1: A diverg\u00eancia geom\u00e9trica da fonte\n\nNa ?gura 4.1 esquematizamos um equipamento de teleterapia onde a dist\u00e2ncia SSD \u00e9 da-\n\nda por z0, o campo na superf\u00edcie por ?0, e ? \u00e9 o campo na profundidade z. Matematicamente\n\no campo em z \u00e9 descrito por\n\n? (z) = z ?\n?\n?0\nz0\n\n?\n(4.2)\n\nSe descrev\u00eassemos esta diverg\u00eancia na fun\u00e7\u00e3o da ?u\u00eancia prim\u00e1ria, n\u00e3o conseguir\u00edamos\n\nconstruir os modelos te\u00f3ricos do cap\u00edtulo 2 com a mesma facilidade.\n\nPor\u00e9m, os mesmos argumentos que usamos anteriormente para desprezar a diverg\u00eancia\n\nagora legitimam a sua implementa\u00e7\u00e3o computacional.\n\n4.2.1 A implementa\u00e7\u00e3o computacional\n\nComo j\u00e1 discutimos anteriormente, devemos alterar as dimens\u00f5es da ?u\u00eancia usada na con-\n\nvolu\u00e7\u00e3o para que tenhamos como resultado a dose em gray. Partimos ent\u00e3o da equa\u00e7\u00e3o\n\n2.1, e sendo a \u00e1rea do campo uma constante, chegaremos a uma equa\u00e7\u00e3o para o n\u00famero de\n\n49\n\n\n\nf\u00f3tons Np em fun\u00e7\u00e3o do vetor posi\u00e7\u00e3o ?!r , dado por\n\nNp (\n?!r ) = N0 (?!r0) ?\n\n?????!r0?!r\n????2 ? exp\n\n?\n?\nZ r\nr0\n?\n??!\nl\n?\n? d?!l\n\n?\n(4.3)\n\nonde N0 \u00e9 o n\u00famero de f\u00f3tons na superf\u00edcie do meio absorvedor e as outras vari\u00e1veis s\u00e3o as\n\nmesmas da equa\u00e7\u00e3o 2.1.\n\nAssim, chegamos facilmente a uma express\u00e3o discretizada para o n\u00famero de f\u00f3tons,\n\nNp (i;j;k) = N0 (i;j;k) ?\n???? Z0k ? 4` + Z0\n\n????2 ? ZY\nk=0\n\nexp\n\n?\n? ?\n?H2O\n\n? ? (i;j;k) ? 4`\n?\n\n(4.4)\n\nsendo Z0 a dist\u00e2ncia da fonte \u00e0 superf\u00edcie, 4` \u00e9 a lateral da c\u00e9lula c\u00fabica em cent\u00edmetros,\ni;j;k s\u00e3o os \u00edndices das c\u00e9lulas, ?\n\n?H2O\n\u00e9 o coe?ciente de atenua\u00e7\u00e3o linear em massa da \u00e1gua\n\ndado em cm2=g e ? (i;j;k) \u00e9 a densidade da c\u00e9lula em g=cm3. Note que estamos somando\n\nZ0 a k ? 4` porque estamos calculando a ?u\u00eancia somente dentro do meio espalhador, e o\n\u00edndice k = 0 corresponde \u00e0 primeira camada de c\u00e9lulas.\n\nA fun\u00e7\u00e3o N0 (i;j;k) descreve a extens\u00e3o do campo em qualquer ponto do meio absorve-\n\ndor. Assim, para um campo quadrado teremos:\n\nN0 (i;j;k) =\n\n(\n1 se ? ?k\n\n2\n&lt;i0 &lt;?k\n\n2\ne ? ?k\n\n2\n&lt;j0 &lt;?k\n\n2\n\n0 se ? ?k\n2\n> i0 > ?k\n\n2\ne ? ?k\n\n2\n> j0 > ?k\n\n2\n\n(4.5)\n\nonde i0 e j0 s\u00e3o os respectivos centros da matriz do meio absorvedor dados por: i0 = i ? L\n2\n\ne j0 = j ? M\n2\n. Nesta tese usaremos dois tipos de campo quadrado: um com e outro sem\n\ndiverg\u00eancia geom\u00e9trica. Ent\u00e3o ?k = 1 para campo sem diverg\u00eancia em qualquer k, e ?k =\n\n(k ? 4` + z0) ? ?0z0 para campo com diverg\u00eancia com k = 0; 1; 2 : : : N.\nNormalmente N0 tem seu valor atribu\u00eddo ao n\u00famero de f\u00f3tons em um determinado\n\nponto, mas, como veremos no cap\u00edtulo 5, estamos interessados apenas nos valores relativos\n\ndas curvas de isodose quando o pico \u00e9 normalizado a 100%. Por este motivo, todas as\n\nconstantes que multiplicam tanto a ?u\u00eancia quanto o n\u00facleo de deposi\u00e7\u00e3o de energia ser\u00e3o\n\nenglobadas em uma \u00fanica constante de normaliza\u00e7\u00e3o.\n\n4.3 Convolu\u00e7\u00e3o via FFT\n\nO problema a ser discutido agora \u00e9 como fazer da maneira mais e?ciente poss\u00edvel as inte-\n\ngrais de convolu\u00e7\u00e3o apresentadas no cap\u00edtulo 2. Estas integrais ser\u00e3o feitas numericamente,\n\n50\n\n\n\nportanto devemos primeiro discretiz\u00e1-las.\n\nDiscretizamos uma integral simples da seguinte forma:\n\nZ\nf (?) d? ?!\n\nX\nn\n\nf (nT) (4.6)\n\nonde n \u00e9 o \u00edndice da soma e T \u00e9 o intervalo entre os pontos.\n\nEnt\u00e3o podemos escrever uma integral de convolu\u00e7\u00e3o na sua forma discreta assim\n\nh (t) =\n\nZ `\n0\nf (?) ? g (t ? ?) d? ?! bh (tk) = NX\n\nn=0\n\nf (nT) ? g (tk ? nT) (4.7)\n\nonde o intervalo ` foi subdivido em N partes de comprimento T, e k = 0; 1; 2 : : : N. bh (tk)\nrepresenta a fun\u00e7\u00e3o h (t) amostrada no ponto tk.\n\nTemos N pontos para serem amostrados e cada um deles \u00e9 o resultado da soma sobre os\n\nN termos, portanto o tempo computacional para este c\u00e1lculo de convolu\u00e7\u00e3o \u00e9 proporcional a\n\nN 2. Mas esta \u00e9 uma opera\u00e7\u00e3o custosa em termos de tempo de processamento, especialmente\n\nquando temos grandes conjuntos de dados. Como mostraremos a seguir, a alternativa en-\n\ncontrada para reduzir o tempo de c\u00e1lculo foi usar os algoritmos de transformada de Fourier\n\nr\u00e1pida (FFT) [19, 20].\n\n4.3.1 A Transformada de Fourier R\u00e1pida\n\nEm 1965 Cooley e Tukey publicaram um algoritmo matem\u00e1tico que reduzia o n\u00famero de\n\nopera\u00e7\u00f5es nos procedimentos de transformadas de Fourier, tornando-se o primeiro algoritmo\n\nde FFT. A redu\u00e7\u00e3o no tempo de computa\u00e7\u00e3o \u00e9 consider\u00e1vel, indo de N2 para N log2 N para\n\ncada transformada de Fourier [20].\n\nAs express\u00f5es para uma transformada de Fourier (eq. 4.8) e sua inversa (eq. 4.9) s\u00e3o:\n\nH (f) =\n\nZ\n1\n\n?1\n\nh (t) e?i2?ftdt (4.8)\n\nh (t) =\n\nZ\n1\n\n?1\n\nH (f) ei2?ftdf (4.9)\n\nonde i =\np\n?1, e t e f s\u00e3o par\u00e2metros das suas respectivas fun\u00e7\u00f5es.\n\nAssumimos tamb\u00e9m a equival\u00eancia entre as transformadas cont\u00ednuas e as discretas[20].\n\nEsta a?rma\u00e7\u00e3o \u00e9 v\u00e1lida quando observadas as restri\u00e7\u00f5es apresentadas na se\u00e7\u00e3o 4.3.1.1.\n\nA transformada de Fourier de uma fun\u00e7\u00e3o h (t) ser\u00e1 denotada por =fh (t)g = H (f) e a\n\n51\n\n\n\ntransformada inversa por =?1 fH (f)g = h (t).\nUma convolu\u00e7\u00e3o de p com q pode ser indicada por h = p ? q. \u00c9 uma propriedade da\n\ntransformada de Fourier a seguinte rela\u00e7\u00e3o [20, 21]:\n\n=fhg = =fpg ? =fqg (4.10)\n\nEste fato \u00e9 o que torna a aplica\u00e7\u00e3o do c\u00e1lculo de convolu\u00e7\u00e3o realmente interessante. \u00c9\n\npor este motivo que, no cap\u00edtulo 2, sempre buscamos a integral de convolu\u00e7\u00e3o.\n\n4.3.1.1 Os Teoremas da Amostragem\n\nSeja uma fun\u00e7\u00e3o unidimensional cont\u00ednua e suave p (t) de?nida em um intervalo ?1 &lt;t&lt;\n1. Esta fun\u00e7\u00e3o deve possuir varia\u00e7\u00f5es tais que a m\u00e1xima freq\u00fc\u00eancia relacionada seja fc, isto\n\u00e9, a fun\u00e7\u00e3o tenha a sua banda de freq\u00fc\u00eancias limitada a, no m\u00e1ximo, fc. Este \u00e9 o primeiro\n\nteorema da amostragem.\n\nO segundo teorema enuncia que o intervalo entre as amostragens T para realizar uma\n\nopera\u00e7\u00e3o de FFT deve obedecer a seguinte express\u00e3o:\n\nT&lt;\n1\n\n2fc\n(4.11)\n\nUma opera\u00e7\u00e3o como a mostrada na equa\u00e7\u00e3o 4.12 dever\u00e1 ser corretamente transformada se\n\na express\u00e3o acima for obedecida. Caso tenhamos T > 1\n2fc\n\n, esta mesma opera\u00e7\u00e3o apresentar\u00e1\n\nondula\u00e7\u00f5es resultantes do batimento entre a freq\u00fc\u00eancia de amostragem e as freq\u00fc\u00eancias mais\n\naltas presentes na fun\u00e7\u00e3o p (t). Este fen\u00f4meno \u00e9 conhecido como aliasing.\n\n=fpg = P ?! =?1 fPg = p (4.12)\n\nA condi\u00e7\u00e3o 1\nT\n\n= 2fc indica a menor freq\u00fc\u00eancia de amostragem para obtermos =fpg\ncorretamente. Esta freq\u00fc\u00eancia \u00e9 tamb\u00e9m conhecida como freq\u00fc\u00eancia de Nyquist.\n\nA discuss\u00e3o apresentada at\u00e9 o momento \u00e9 para fun\u00e7\u00f5es unidimensionais peri\u00f3dicas, mas\n\npode facilmente ser estendida para n dimens\u00f5es.\n\nO nosso problema envolve uma convolu\u00e7\u00e3o entre duas fun\u00e7\u00f5es distintas. A primeira \u00e9 a\n\n?u\u00eancia prim\u00e1ria que \u00e9 uma express\u00e3o monot\u00f4nica decrescente e suave, portanto n\u00e3o teremos\n\nproblemas com o teoremas da amostragem. A fun\u00e7\u00e3o de densidade relativa e? tamb\u00e9m faz\nparte de primeira fun\u00e7\u00e3o da convolu\u00e7\u00e3o e devemos obedecer o teorema da amostragem na\n\nmontagem desta matriz, o que ser\u00e1 feita manualmente.\n\nConseguimos o n\u00facleo de deposi\u00e7\u00e3o de energia, que \u00e9 a segunda fun\u00e7\u00e3o, atrav\u00e9s de uma\n\n52\n\n\n\nsimula\u00e7\u00e3o onde os dados s\u00e3o gerados discretizados. Se quisermos reduzir a resolu\u00e7\u00e3o deste\n\nn\u00facleo devemos estudar o seu espectro de freq\u00fc\u00eancias e, se necess\u00e1rio, ?ltr\u00e1-lo para satisfazer\n\na condi\u00e7\u00e3o 4.11, mas este tratamento est\u00e1 al\u00e9m do objetivo desta tese e, portanto, n\u00e3o ser\u00e1\n\nfeito.\n\n4.3.2 Convolu\u00e7\u00e3o de duas fun\u00e7\u00f5es ?nitas\n\nCom a propriedade apresentada na equa\u00e7\u00e3o 4.10 podemos fazer uma convolu\u00e7\u00e3o usando\n\napenas tr\u00eas transformadas de Fourier e uma opera\u00e7\u00e3o de multiplica\u00e7\u00e3o, independentemente\n\nda dimens\u00e3o das fun\u00e7\u00f5es, podendo ser de 1D, 2D, 3D, etc.\n\nEm 3D com um conjunto amostral de L ? M ? N, onde L; M; N s\u00e3o os n\u00fameros de\npontos da fun\u00e7\u00e3o em cada dire\u00e7\u00e3o ortogonal, dados respectivamente pelos \u00edndices i;j;k,\n\no c\u00e1lculo convencional de uma transformada de Fourier exigiria um tempo proporcional a\n\n(L ? M ? N)2 e via FFT teremos apenas (L ? M ? N) log2 (L ? M ? N)[20, 19].\nNenhuma das duas fun\u00e7\u00f5es utilizadas nos c\u00e1lculos por convolu\u00e7\u00e3o deste trabalho apre-\n\nsenta periodicidade, propriedade exigida na convolu\u00e7\u00e3o via FFT. Sem a periodicidade, pode\n\nhaver sobreposi\u00e7\u00e3o das fun\u00e7\u00f5es ap\u00f3s a convolu\u00e7\u00e3o (conhecido como ?efeito de borda?). \u00c9\n\nimportante ressaltar que o n\u00famero de pontos e o intervalo das duas fun\u00e7\u00f5es usadas na\n\nconvolu\u00e7\u00e3o tamb\u00e9m podem ser diferentes.\n\nSuponha que temos duas fun\u00e7\u00f5es 1D, f (xi) com P pontos e g (xi) com Q pontos. Para\n\nevitar o efeito de sobreposi\u00e7\u00e3o devemos estender ambas as fun\u00e7\u00f5es para um tamanho N >\n\nP + Q ? 1 e preencher estes espa\u00e7os com zeros. Desta forma teremos:\n\nf (xi) =\nh\nx0 x1 : : : xP 0 0 : : : 0 0\n\ni\n1?N\n\n(4.13)\n\ng (xi) =\nh\nx0 x1 : : : xQ 0 : : : 0 0\n\ni\n1?N\n\n(4.14)\n\nAgora temos as duas fun\u00e7\u00f5es com o mesmo n\u00famero de pontos e com zeros su?cientes\n\npara evitar a sobreposi\u00e7\u00e3o. A este procedimento damos o nome de Zero Padding [20, 22].\n\nPara 3D devemos estender da mesma maneira cada uma das tr\u00eas dire\u00e7\u00f5es com termos\n\nnulos.\n\n4.3.2.1 O deslocamento dos dados\n\nQuando fazemos uma convolu\u00e7\u00e3o de dados n\u00e3o peri\u00f3dicos, o espa\u00e7o de amostragem de sa\u00edda\n\ntem o tamanho do espa\u00e7o de entrada mais a extens\u00e3o do padding de zeros. O n\u00famero de\n\nc\u00e9lulas equivalente a este padding deve ser extra\u00eddo do resultado ?nal.\n\n53\n\n\n\nNo nosso caso os dados corretos est\u00e3o transladados pela matriz estendida ap\u00f3s a con-\n\nvolu\u00e7\u00e3o, e a transla\u00e7\u00e3o corresponde exatamente \u00e0 dist\u00e2ncia do valor m\u00e1ximo presente no\n\nconjunto de dados do n\u00facleo de convolu\u00e7\u00e3o \u00e0 sua origem. Para corrigir este problema temos\n\nduas alternativas [20]:\n\n? transladar previamente o pico do n\u00facleo de convolu\u00e7\u00e3o para a origem;\n\n? transladar posteriormente os dados ap\u00f3s os c\u00e1lculos.\n\nA primeira alternativa \u00e9 a melhor, pois torna poss\u00edvel a otimiza\u00e7\u00e3o dos c\u00e1lculos durante\n\na convolu\u00e7\u00e3o e tamb\u00e9m \u00e9 a t\u00e9cnica mais elegante [20, 22]. No entanto, como estamos\n\ntrabalhando em 3D, ela di?culta a visualiza\u00e7\u00e3o e a manipula\u00e7\u00e3o dos dados contidos no\n\nn\u00facleo de convolu\u00e7\u00e3o. Por isso nesta tese ser\u00e1 usada a transla\u00e7\u00e3o posterior por ser mais\n\npr\u00e1tica e simples. A forma mais elegante dever\u00e1 ser implementada ao longo do trabalho de\n\notimiza\u00e7\u00e3o do c\u00f3digo, posterior \u00e0 disserta\u00e7\u00e3o.\n\n54\n\n\n\nCap\u00edtulo 5\n\nResultados e Discuss\u00f5es\n\nNeste cap\u00edtulo apresentamos e discutimos os resultados das simula\u00e7\u00f5es para a obten\u00e7\u00e3o dos\n\nn\u00facleos de deposi\u00e7\u00e3o de energia e os resultados obtidos pelo algoritmo de c\u00e1lculo da dose\n\npor convolu\u00e7\u00e3o utilizando estes n\u00facleos simulados.\n\n5.1 Os n\u00facleos de deposi\u00e7\u00e3o de energia\n\nAs simula\u00e7\u00f5es foram feitas considerando tanques de \u00e1gua1 de forma c\u00fabica discretizados em\n\nc\u00e9lulas tamb\u00e9m c\u00fabicas de 0; 5?0; 5?0; 5 cm3. As dimens\u00f5es adotadas para os tanques s\u00e3o\ndiferentes para cada n\u00facleo.\n\nTodos os n\u00facleos de deposi\u00e7\u00e3o de energia usados nesta tese foram simulados na m\u00e1quina\n\nThor2 com 107 hist\u00f3rias, mas ?zemos simula\u00e7\u00f5es nas m\u00e1quinas Araguaia e HAL9000 e\n\nos resultados apresentaram varia\u00e7\u00f5es da ordem de 10% nos valores de pico dos n\u00facleos. As\n\nmaiores diferen\u00e7as est\u00e3o nos n\u00facleos secund\u00e1rio e de m\u00faltiplo espalhamento. Este fato sugere\n\numa ?utua\u00e7\u00e3o estat\u00edstica e a solu\u00e7\u00e3o proposta seria aumentar o n\u00famero de hist\u00f3rias. Por\u00e9m\n\neste aumento signi?caria um aumento consider\u00e1vel no tempo de simula\u00e7\u00e3o. O aumento\n\nde uma ordem de grandeza no n\u00famero de hist\u00f3rias levaria a simula\u00e7\u00e3o a tomar algumas\n\ncentenas de horas de CPU.\n\n5.1.1 O n\u00facleo de deposi\u00e7\u00e3o de energia prim\u00e1ria\n\nSimulamos o n\u00facleo de deposi\u00e7\u00e3o prim\u00e1ria de energia para um tanque de 5 ? 5 ? 5 cm3. As\n?guras 5.1 e 5.2 mostram o resultado obtido para esta simula\u00e7\u00e3o.\n\n1Tamb\u00e9m conhecidos por fantom na literatura t\u00e9cnica.\n2Veja as con?gura\u00e7\u00f5es dos computadores no ap\u00eandice G.\n\n55\n\n\n\n0 1 1.6\n0.0\u00d7100\n\n1.0\u00d710?9\n\n1.6\u00d710?9\n\nProfundidade, Eixo Z (cm)\n\nIn\nte\n\nn\nsi\n\nd\nad\n\ne \nem\n\n G\ny/\n\np\nar\n\nt.\n\nFigura 5.1: Per?l do n\u00facleo prim\u00e1rio de convolu\u00e7\u00e3o.\n\nNa ?gura 5.1 temos o per?l de dose depositada na profundidade z pelas part\u00edculas pri-\n\nm\u00e1rias. Neste gr\u00e1?co observamos o pico de deposi\u00e7\u00e3o de energia de todo meio, 1; 477 ?\n10?9gray/part\u00edcula. Os dados at\u00e9 10?13 gray/part\u00edcula t\u00eam no m\u00e1ximo 1% de incerteza. O\n\ntempo de CPU3 tomado por todas as hist\u00f3rias desta simula\u00e7\u00e3o foi de aproximadamente 0,7\n\nhoras.\n\nDeste mesmo conjunto de dados extra\u00edmos um gr\u00e1?co em isolinhas, que nos permite ter\n\numa id\u00e9ia da distribui\u00e7\u00e3o da dose em um corte no plano do pico da dose, como na ?gura\n\n5.2.\n\nAs posi\u00e7\u00f5es em cent\u00edmetro anotadas nos eixos destes gr\u00e1?cos e dos posteriores n\u00e3o cor-\n\nrespondem \u00e0 posi\u00e7\u00e3o absoluta no tanque de \u00e1gua. N\u00e3o h\u00e1 a necessidade dessa coincid\u00eancia\n\ne nem mesmo de saber a posi\u00e7\u00e3o real em que ocorreu a primeira intera\u00e7\u00e3o do f\u00f3ton com o\n\nmeio, pois para a convolu\u00e7\u00e3o apenas importa a posi\u00e7\u00e3o dos dados em rela\u00e7\u00e3o ao pico, como\n\ndiscutido no cap\u00edtulo 4.\n\n5.1.1.1 Os limites de resolu\u00e7\u00e3o\n\nO modelo adotado pela subrotina de m\u00faltiplo espalhamento coulombiano do EGS4 \u00e9 v\u00e1lido\n\nsomente quando, durante o transporte, a part\u00edcula carregada sofre pelo menos 20 colis\u00f5es\n\n3Tempo de CPU signi?ca o tempo que a m\u00e1quina dedicou exclusivamente para este processo.\n\n56\n\n\n\n1 2 2.5\n0\n\n1\n\n2\n\nEixo Z (cm)\n\nE\nix\n\no \nY\n\n (\ncm\n\n)\n\n1e?11\n\n1e\n?1\n\n1\n\n1e?11\n1e\n\n?1\n1\n\n1e?10 1e\n?1\n\n0\n\n1e?101e\n?1\n\n0\n\n5e?10\n\n5e?10\n\nFigura 5.2: Gr\u00e1?co em isolinhas do n\u00facleo de convolu\u00e7\u00e3o prim\u00e1rio obtido por meio de\nsimula\u00e7\u00e3o de Monte Carlo. Os n\u00fameros nas isolinhas indicam a intensidade em Gy/part.\n\n57\n\n\n\nel\u00e1sticas. Caso o n\u00famero seja menor, o modelo de Bethe n\u00e3o \u00e9 mais v\u00e1lido, a subrotina \u00e9\n\ndesligada e nenhuma outra corre\u00e7\u00e3o \u00e9 feita. Este fato implica em n\u00e3o corrigir a trajet\u00f3ria\n\nda part\u00edcula carregada. Quando reduzimos as dimens\u00f5es das c\u00e9lulas, a probabilidade da\n\ntrajet\u00f3ria de um el\u00e9tron ultrapassar uma interface entre c\u00e9lulas aumenta, e a cada vez\n\nque um el\u00e9tron alcan\u00e7a uma interface, o seu transporte \u00e9 interrompido antes que ocorra o\n\nn\u00famero m\u00ednimo de colis\u00f5es para a devida corre\u00e7\u00e3o pelo m\u00faltiplo espalhamento. Assim os\n\ndados resultantes da simula\u00e7\u00e3o n\u00e3o seriam muito con?\u00e1veis.\n\nPara testar esta condi\u00e7\u00e3o, o EGS4 disp\u00f5e de uma vari\u00e1vel chamada de NOSCAT, que\n\nmostra o n\u00famero total de vezes em que a subrotina de m\u00faltiplo espalhamento foi desligada.\n\nO teste de resolu\u00e7\u00e3o consistiu em simular o n\u00facleo de convolu\u00e7\u00e3o prim\u00e1rio em diversos\n\ntamanhos de c\u00e9lulas. A extens\u00e3o do meio foi a mesma da se\u00e7\u00e3o anterior e o n\u00famero de\n\nhist\u00f3rias foi reduzido a 105 por uma quest\u00e3o de tempo de CPU. Os resultados est\u00e3o na\n\ntabela 5.1.\n\nDimens\u00f5es das c\u00e9lulas NOSCAT\n\n0; 5 ? 0; 5 ? 0; 5 cm3 44.478\n0; 2 ? 0; 2 ? 0; 2 cm3 53.136\n0; 1 ? 0; 1 ? 0; 1 cm3 164.936\n\nTabela 5.1: Os testes para os limites de resolu\u00e7\u00e3o.\n\nNotamos um brusco aumento no n\u00famero de vezes em que essa rotina \u00e9 desligada quando\n\npassamos de 0,2 cm de lado para 0,1 cm. Conclu\u00edmos que a melhor resolu\u00e7\u00e3o poss\u00edvel para\n\nc\u00e9lulas c\u00fabicas \u00e9 de 0,2 cm de lado.\n\nNo entanto n\u00e3o aproveitaremos, nesta tese, os dados das c\u00e9lulas c\u00fabicas de 0,2 cm de lado\n\npois tal procedimento gera uma quantidade muito grande de pontos durante a convolu\u00e7\u00e3o,\n\nnecessitando de (2; 5)3vezes mais mem\u00f3ria RAM que as c\u00e9lulas c\u00fabicas de 0,5 cm!\n\n5.1.2 O n\u00facleo de deposi\u00e7\u00e3o de energia secund\u00e1ria\n\nPara esta simula\u00e7\u00e3o as dimens\u00f5es do tanque s\u00e3o 30?30?30 cm3 e as c\u00e9lulas t\u00eam 0; 5?0; 5?\n0; 5 cm3, tamb\u00e9m. O tempo de CPU dedicado a esta simula\u00e7\u00e3o foi de aproximadamente 4,6\n\nhoras. A seguir apresentamos os resultados da simula\u00e7\u00e3o do n\u00facleo de convolu\u00e7\u00e3o secund\u00e1rio.\n\nNa ?gura 5.3 vemos o per?l da deposi\u00e7\u00e3o da dose ao longo do eixo z atravessando o\n\npico de todo o conjunto de dados, 5; 266 ? 10?11 gray/part\u00edcula. O gr\u00e1?co tem seu eixo de\nintensidades em escala logar\u00edtmica para conseguirmos ver toda a extens\u00e3o em que a energia \u00e9\n\nespalhada. Na seq\u00fc\u00eancia temos um corte em representa\u00e7\u00e3o de isolinhas, mostrado na ?gura\n\n5.4.\n\n58\n\n\n\n0 10 20\n1.0\u00d710?14\n\n1.0\u00d710?13\n\n1.0\u00d710?12\n\n1.0\u00d710?11\n\n1.0\u00d710?10\n\nProfundidade, Eixo Z (cm)\n\nIn\nte\n\nn\nsi\n\nd\nad\n\ne \nem\n\n G\ny/\n\nP\nar\n\nt.\n\nFigura 5.3: Per?l no eixo central da dose depositada pelos el\u00e9trons secund\u00e1rios.\n\n59\n\n\n\n0 10 20\n7\n\n10\n\n20\n\n23\n\nEixo Z (cm)\n\nE\nix\n\no \nY\n\n (\ncm\n\n)\n\n1e?14\n\n1e\n?\n\n14 1e?14\n\n1e?14\n\n1e\n?\n\n14\n\n1e?\n14\n\n1e?\n14\n\n1e\n?1\n\n4\n\n1e?\n14\n\n1e?14\n\n1e?14\n1e?1\n\n4\n\n1e?13\n\n1e?13\n\n1e?\n12\n\n1e\n?1\n\n1\n\nF\nigu\n\nra\n5.4:\n\nG\nr\u00e1?\n\nco\nem\n\nisolin\nh\nas\n\nd\ne\nu\nm\n\ncorte\nd\no\nn\n\u00fa\ncleo\n\nsecu\nn\nd\n\u00e1rio.\n\nO\ns\nn\n\u00fa\nm\neros\n\nn\nas\n\nisolin\nh\nas\n\nin\nd\nicam\n\na\nin\nten\n\nsid\nad\ne\nem\n\nG\ny\n/p\nart.\n\n60\n\n\n\nNestes dois gr\u00e1?cos observamos algum ru\u00eddo que aumenta com a dist\u00e2ncia ao pico da\n\ndistribui\u00e7\u00e3o. A incerteza m\u00e1xima nesta simula\u00e7\u00e3o ?cou em torno de 11% para os dados\n\nperif\u00e9ricos, e em 10?13 gray/part\u00edcula a incerteza ?cou em aproximadamente 0,6%.\n\n5.1.3 O n\u00facleo de deposi\u00e7\u00e3o de energia devido ao m\u00faltiplo espalhamento\n\ndos f\u00f3tons\n\nA extens\u00e3o do meio usado nesta simula\u00e7\u00e3o foi a mesma que para o n\u00facleo secund\u00e1rio. O\n\ntempo de CPU para esta simula\u00e7\u00e3o foi de 6 horas. Nas ?guras 5.5 e 5.6 apresentamos os\n\nresultados desta simula\u00e7\u00e3o.\n\nNa ?gura 5.5 observamos o pico de todo o conjunto de dados, 2; 3?10?10 gray/part\u00edcula.\nNotamos tamb\u00e9m que este pico \u00e9 maior que o do secund\u00e1rio devido, principalmente, ao maior\n\nn\u00famero de f\u00f3tons que contribu\u00edram para a sua forma\u00e7\u00e3o. A incerteza m\u00e1xima ?cou em torno\n\nde 11% nas c\u00e9lulas mais externas e foi de aproximadamente de 0,6% em 10?13 gray/part\u00edcula.\n\nNo gr\u00e1?co do per?l a incerteza observada \u00e9 claramente maior que 11% porque as c\u00e9lulas\n\nvizinhas tamb\u00e9m possuem uma incerteza pr\u00f3xima a esta, o que sugere oscila\u00e7\u00f5es maiores\n\nque a incerteza individual. O mesmo racioc\u00ednio vale para o n\u00facleo secund\u00e1rio.\n\nNa ?gura 5.6 vemos que a energia no n\u00facleo de m\u00faltiplo espalhamento estende-se por\n\numa regi\u00e3o ainda maior que no n\u00facleo secund\u00e1rio. Esta extens\u00e3o da energia absorvida no\n\nn\u00facleo de m\u00faltiplo espalhamento \u00e9 maior porque contabilizamos ordens superiores a tr\u00eas\n\nespalhamentos de f\u00f3tons.\n\n5.2 Os c\u00e1lculos da dose de radia\u00e7\u00e3o\n\nImplementamos o algoritmo de c\u00e1lculo da dose de radia\u00e7\u00e3o por convolu\u00e7\u00e3o apresentado no\n\ncap\u00edtulo 4 e a listagem deste programa se encontra no ap\u00eandice C. Fizemos o teste do\n\nalgoritmo em v\u00e1rias situa\u00e7\u00f5es em meios homog\u00eaneos e heterog\u00eaneos. Em todas as situa\u00e7\u00f5es\n\ncalculadas pelo m\u00e9todo de convolu\u00e7\u00e3o o meio foi discretizado em c\u00e9lulas c\u00fabicas de 0,5 cm\n\nde lado em uma matriz 3D ?xada em 64 ? 64 ? 64 c\u00e9lulas4. Portanto o meio descrito \u00e9 um\ncubo de 32 ? 32 ? 32 cm3.\n\nUsamos a \u00e1gua como meio homog\u00eaneo em todos os c\u00e1lculos, e nas montagens heterog\u00ea-\n\nneas a \u00e1gua tamb\u00e9m foi muito usada.\n\n4Usamos 26 c\u00e9lulas em cada dire\u00e7\u00e3o apenas porque a FFT apresenta o melhor desempenho.\n\n61\n\n\n\n0 10 20\n1.0\u00d710?15\n\n1.0\u00d710?14\n\n1.0\u00d710?13\n\n1.0\u00d710?12\n\n1.0\u00d710?11\n\n1.0\u00d710?10\n\n1.0\u00d710?9\n\nProfundidade, Eixo Z (cm)\n\nIn\nte\n\nn\nsi\n\nd\nad\n\ne \nem\n\n G\ny/\n\np\nar\n\nt.\n\nFigura 5.5: Per?l do n\u00facleo de m\u00faltiplo espalhamento.\n\n62\n\n\n\n0 10 13\n10\n\n20\n\nEixo Z (cm)\n\nE\nix\n\no \nY\n\n (\ncm\n\n)\n\n1e?14\n\n1e?14\n\n1e\n?\n\n14\n\n1e?\n14\n\n1e?14\n\n1e?\n13\n\n1e\n?1\n\n2\n\n1e\n?1\n\n1\n\nF\nigu\n\nra\n5.6:\n\nC\nu\nrvas\n\nem\nisolin\n\nh\nas\n\nd\ne\nu\nm\n\ncorte\nd\no\nn\n\u00fa\ncleo\n\nd\ne\nm\n\u00fa\nltip\n\nlo\nesp\n\nalh\nam\n\nen\nto.\n\nO\ns\n\nn\n\u00fa\nm\neros\n\nn\nas\n\nisolin\nh\nas\n\nin\nd\nicam\n\na\nin\nten\n\nsid\nad\ne\nem\n\nG\ny\n/p\nart.\n\n63\n\n\n\n5.2.1 Os testes em meios homog\u00eaneos\n\nDividimos em duas partes os testes propostos para meios homog\u00eaneos. Na primeira parte\n\ncomparamos o algoritmo apresentado nesta disserta\u00e7\u00e3o com medidas feitas no CAISM, e na\n\nsegunda comparamos com os resultados calculados pelo programa PLATO da Nucletron.\n\nEste programa usa os per?s transversais5 de dose medidos na \u00e1gua quando irradiados pela\n\nm\u00e1quina de 60Co 6.\n\n5.2.1.1 Compara\u00e7\u00e3o com as medidas feitas no CAISM\n\nO primeiro teste proposto \u00e9 bastante simples: as medidas foram feitas aplicando um campo\n\nquadrado de 10 ? 10 cm2 na superf\u00edcie do tanque de \u00e1gua dado por uma fonte a 80 cm de\ndist\u00e2ncia da superf\u00edcie.\n\nMostramos a curva da ?u\u00eancia em perspectiva onde no eixo z est\u00e1 a intensidade nor-\n\nmalizada a 100%. Note que n\u00e3o h\u00e1 diverg\u00eancia geom\u00e9trica do feixe neste c\u00e1lculo, mas\n\nconsideramos normalmente a queda com o inverso do quadrado da dist\u00e2ncia. Esta normali-\n\nza\u00e7\u00e3o do m\u00e1ximo das curvas a 100% ser\u00e1 um procedimento muito usado a partir deste ponto\n\ne, por isso, vamos citar somente os casos em contr\u00e1rio.\n\nA distribui\u00e7\u00e3o da dose calculada para esta fatia de ?u\u00eancia est\u00e1 na ?gura 5.8.\n\nAs imagens em 3D mostradas aqui ter\u00e3o sempre a intensidade no eixo das ordenadas.\n\nEste tipo de imagem nos permite ter uma id\u00e9ia do comportamento da intensidade sobre\n\num plano, mas imagens em isolinhas s\u00e3o mais quantitativas. Como exemplo, veja a mesma\n\nimagem mostrada na ?gura 5.8 agora em curvas de isodose: As respectivas curvas de isodose\n\npara as doses parciais prim\u00e1ria, secund\u00e1ria e de m\u00faltiplo espalhamento est\u00e3o nas ?guras 5.10,\n\n5.11 e 5.12, onde todas as parcelas est\u00e3o normalizadas com rela\u00e7\u00e3o ao seu pr\u00f3prio pico.\n\nA dose prim\u00e1ria assemelha-se \u00e0 ?u\u00eancia prim\u00e1ria porque a extens\u00e3o do transporte ele-\n\ntr\u00f4nico da dose \u00e9 pequena, e a maioria do el\u00e9trons prim\u00e1rios tem alcance de 0,5 cm, como\n\npodemos ver no gr\u00e1?co da ?gura 5.1.\n\nO transporte das doses secund\u00e1rias e de m\u00faltiplo espalhamento \u00e9 feito principalmente\n\npelos f\u00f3tons, por isso a extens\u00e3o destas doses parciais \u00e9 maior que a da dose prim\u00e1ria, como\n\nconferimos nas ?guras 5.11 e 5.12.\n\nVamos fazer uma compara\u00e7\u00e3o quantitativa do per?l da dose no eixo central do campo\n\ncom dados experimentais.\n\n5O per?l transversal \u00e9 o per?l da dose, medido na dire\u00e7\u00e3o perpendicular ao feixe de f\u00f3tons.\n6Na realidade n\u00e3o sabemos ao certo o m\u00e9todo pelo qual este programa calcula as isodoses, porque o\n\nPLATO \u00e9 um programa comercial fechado e o manual t\u00e9cnico pouco fala a este respeito.\n\n64\n\n\n\n0\n\n15\n\n30\n\n45\n\n60\n\n75\n\n90\n\nIn\nte\n\nn\nsi\n\nd\nad\n\ne\n\n0\n\n100\n\nEixo Z\n\n0\n10\n\n20\n30\n\nE\nix\n\no \nY\n\n0\n\n10\n\n20\n\n30\n\nFigura 5.7: Vista em perspectiva da ?u\u00eancia prim\u00e1ria dada pelo corte no plano x no centro\ndo campo. O pico de intensidade foi normalizado a 100%.\n\n65\n\n\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\n80\n\n90\n\n95\n\nIn\nte\n\nn\nsi\n\nd\nad\n\ne\n\n100\n\nEixo Z (cm)\n\n0\n\n10\n\n20\n\n30\nEi\n\nxo\n Y\n\n (c\nm\n\n)\n\n0\n\n10\n\n20\n\n30\n\nFigura 5.8: A dose total vista em perspectiva.\n\n66\n\n\n\n0 10 20 30\n\n10\n\n20\n\n23\n\nEixo Z (cm)\n\nE\nix\n\no \nY\n\n (\ncm\n\n)\n\n10 10\n10\n\n10 10 10\n\n20 2\n0\n\n20\n20\n\n30\n\n30\n\n3030\n\n40\n\n40\n\n40\n\n50\n\n50\n\n0\n\n60\n\n60\n\n70\n\n70\n\n80\n\n90\n\nFigura 5.9: Curvas de isodose na \u00e1gua.\n\n0 10 20 30\n\n10\n\n20\n\n23\n\nEixo Z (cm)\n\nE\nix\n\no \nY\n\n (\ncm\n\n)\n\n10 10\n\n10\n\n1010\n\n20 20\n\n20\n\n20\n\n30\n\n30\n\n30\n\n40\n\n40\n\n40\n\n50\n\n50\n\n60\n\n60\n\n70\n\n70\n\n80\n\n90\n\nFigura 5.10: Curvas em isodose da dose prim\u00e1ria.\n\n67\n\n\n\n0 10 20 30\n4\n\n10\n\n20\n\n28\n\nEixo Z (cm)\n\nE\nix\n\no \nY\n\n (\ncm\n\n)\n\n10\n10\n\n10\n\n10\n\n10\n\n10\n\n20\n20\n\n20\n\n20 20\n\n20\n\n30 30\n\n30\n\n30\n30\n\n40\n40\n\n40\n40\n\n50 50\n\n50\n\n50\n\n50\n\n60\n\n60\n60\n\n60\n\n70\n\n70\n\n70\n\n80\n\n808\n0\n\n90\n\n90\n\nFigura 5.11: Curvas em isodose da dose secund\u00e1ria.\n\n68\n\n\n\n0 10 20 30\n7\n\n10\n\n20\n\n25\n\nEixo Z (cm)\n\nE\nix\n\no \nY\n\n (\ncm\n\n)\n\n10 10\n10\n\n10 10\n10\n\n20 20\n\n20\n\n20\n\n30\n\n30\n\n3030\n\n40\n\n40\n\n40\n\n50\n\n50\n0\n\n60\n\n60\n\n70\n\n70\n\n80\n\n90\n\nFigura 5.12: Curvas em isodose da dose de m\u00faltiplo espalhamento.\n\n69\n\n\n\n0 10 20 30\n0\n\n100\n\n110\n\nConvolu\u00e7\u00e3o X Medidas\n\nEixo Z (cm)\n\nIn\nte\n\nn\nsi\n\nd\nad\n\ne\n\nPerfil central ? campo 5x5cm\u00b2\n\nCAISM\n\nConvolu\u00e7\u00e3o\n\nFigura 5.13: Compara\u00e7\u00e3o do per?l da dose em profundidade para campo 5 ? 5 cm2 com\ndados experimentais do CAISM.\n\n70\n\n\n\n0 10 20 30\n0\n\n100\n\n110\n\nConvolu\u00e7\u00e3o X Medidas\n\nEixo Z (cm)\n\nIn\nte\n\nn\nsi\n\nd\nad\n\ne\n\nPerfil central ? campo 8x8cm\u00b2\n\nCAISM\n\nConvolu\u00e7\u00e3o\n\nFigura 5.14: Compara\u00e7\u00e3o do per?l da dose em profundidade para campo 8 ? 8 cm2 com\ndados experimentais do CAISM.\n\n71\n\n\n\n0 10 20 30\n0\n\n100\n\n110\n\nConvolu\u00e7\u00e3o X Medidas\n\nEixo Z (cm)\n\nIn\nte\n\nn\nsi\n\nd\nad\n\ne\n\nPerfil central ? campo 10x10cm\u00b2\n\nCAISM\n\nConvolu\u00e7\u00e3o\n\nFigura 5.15: Compara\u00e7\u00e3o do per?l da dose em profundidade para campo 10 ? 10 cm2 com\ndados experimentais do CAISM.\n\n72\n\n\n\n0 10 20 30\n0\n\n100\n\n110\n\nConvolu\u00e7\u00e3o X Medidas\n\nEixo Z (cm)\n\nIn\nte\n\nn\nsi\n\nd\nad\n\ne\n\nPerfil central ? campo 15x15cm\u00b2\n\nCAISM\n\nConvolu\u00e7\u00e3o\n\nFigura 5.16: Compara\u00e7\u00e3o do per?l da dose em profundidade para campo 15 ? 15 cm2 com\ndados experimentais do CAISM.\n\n73\n\n\n\nAs medidas usadas nestes gr\u00e1?cos foram feitas na m\u00e1quina de teleterapia ALCYON-II\n\npara uso do CAISM. O erro experimental est\u00e1 estimado em menos de 1%. Consideramos a\n\ndiverg\u00eancia geom\u00e9trica nos c\u00e1lculos por convolu\u00e7\u00e3o. A dist\u00e2ncia da fonte \u00e0 superf\u00edcie (SSD)\n\ndesta m\u00e1quina \u00e9 de 80 cm, e este foi o valor usado nas simula\u00e7\u00f5es.\n\nObservamos uma excelente concord\u00e2ncia dos resultados calculados para campos menores\n\nque 10 ?10 cm2 com os valores experimentais. O erro relativo est\u00e1 pr\u00f3ximo ao das medidas\nat\u00e9 a profundidade de 24 cm para o campo de 5?5 cm2, de 17 cm para o campo de 8?8 cm2.\n\nO erro relativo entre o c\u00e1lculo e os dados experimentais do campo 5 ? 5 cm2 a 28 cm\nde profundidade foi de 3% e do campo 8 ? 8 cm2 na mesma profundidade foi de 7,7%. O\nerro relativo \u00e9 de?nido no ap\u00eandice A. Normalmente os artigos sobre o c\u00e1lculo da dose por\n\nconvolu\u00e7\u00e3o comparam seus modelos com simula\u00e7\u00f5es ou valores experimentais e mencionam\n\no erro absoluto, tamb\u00e9m de?nido neste mesmo ap\u00eandice. Tal m\u00e9todo apresenta um valor\n\npara o erro muito menor e inadequado cienti?camente7.\n\nEscolhemos esta profundidade para fazer as compara\u00e7\u00f5es porque devemos sempre des-\n\nconsiderar os dados que est\u00e3o nos \u00faltimos 3 cm j\u00e1 que esta \u00e9 a dist\u00e2ncia do pico ao in\u00edcio\n\ndo conjunto de dados do n\u00facleo secund\u00e1rio e tamb\u00e9m do de m\u00faltiplo espalhamento. Este\n\ncuidado \u00e9 necess\u00e1rio para minimizar a in?u\u00eancia dos pontos que est\u00e3o al\u00e9m da borda infe-\n\nrior do tanque de \u00e1gua, e que n\u00e3o espalham radia\u00e7\u00e3o. Como o nosso meio tem 32 cm de\n\nprofundidade, 28 cm \u00e9 uma dist\u00e2ncia segura.\n\nAs doses calculadas e medidas para o campo de 10 ? 10 cm2 apresentam uma boa con-\ncord\u00e2ncia para profundidades de at\u00e9 15 cm. Em 28 cm a dose apresenta um erro relativo de\n\n9,8%8, e observamos tamb\u00e9m uma tend\u00eancia mais acentuada em subestimar o valor medido.\n\nCom um campo de 15 ? 15 cm2 o erro relativo subiu para 15,4% a 28 cm, e chegou a 20%\npara um de 20 ? 20 cm2 (n\u00e3o mostrado)!\n\nA raz\u00e3o pela qual o per?l da dose calculada no eixo central do campo discorda tanto\n\ndos resultados experimentais \u00e9 encontrada quando analisamos a extens\u00e3o do meio onde\n\nforam simulados os n\u00facleos secund\u00e1rio e de m\u00faltiplo espalhamento. Esta extens\u00e3o n\u00e3o \u00e9\n\ngrande o su?ciente para que todos os f\u00f3tons sejam absorvidos dentro do meio em que foram\n\nfeitas as simula\u00e7\u00f5es. A ?gura 5.17 mostra porque campos maiores precisam de n\u00facleos de\n\nconvolu\u00e7\u00f5es mais extensos. O artigo [15] sugere que o meio em que simulamos tenha uma\n\nextens\u00e3o f\u00edsica de pelo menos 60 cm de raio. Por limita\u00e7\u00f5es t\u00e9cnicas dos computadores e do\n\nEGS4 n\u00f3s ?zemos esta simula\u00e7\u00e3o em um cubo de 30 cm de lado, portanto a dist\u00e2ncia do\n\nfeixe a qualquer lateral do cubo tem apenas 15 cm! O mesmo coment\u00e1rio vale para o n\u00facleo\n\n7Por exemplo, este erro relativo de 7,7% signi?ca apenas 1,1% como absoluto.\n8Este valor corresponde a 2,1% de erro absoluto.\n\n74\n\n\n\nsecund\u00e1rio porque o livre caminho m\u00e9dio destes f\u00f3tons \u00e9 maior que as dimens\u00f5es do meio.\n\nInterfer\u00eancia de feixes laterais \nno perfil central da dose\n\ncurvas de \nisodose\n\nInterfer\u00eancia de feixes em outras \nprofundidades  no perfil central da dosezz\n\nx,y\n\nF\nei\nx\ne \nd\ne \n\nf\u00f3\nto\nn\ns\n\nFigura 5.17: A composi\u00e7\u00e3o da dose no eixo central pelos feixes de f\u00f3tons vizinhos.\n\nNos gr\u00e1?cos mostrados nas ?guras 5.18 e 5.19 temos uma compara\u00e7\u00e3o entre os per?s\n\nda dose absorvida transversal ao campo calculado e os dados da m\u00e1quina ALCYON II.\n\nNesta compara\u00e7\u00e3o ambos os resultados foram normalizados a 100%. Portanto, neste gr\u00e1?co\n\nmostramos somente a concord\u00e2ncia lateral da dose. O per?l transversal \u00e9 dado pela dose\n\nperpendicular ao campo. Usamos um campo de 10 ? 10 cm2 e as profundidades mostradas\ns\u00e3o 0,5 cm e 20 cm, respectivamente. Nos c\u00e1lculos num\u00e9ricos consideramos a diverg\u00eancia\n\ngeom\u00e9trica do campo. Em ambos os gr\u00e1?cos observamos uma boa concord\u00e2ncia. O modelo\n\npara a ?u\u00eancia ainda pode ser melhorado considerando a zona de penumbra, mas o ideal\n\nseria mapear o ?uxo ou a ?u\u00eancia de f\u00f3tons na superf\u00edcie do meio em cada m\u00e1quina e us\u00e1-lo\n\nnos c\u00e1lculos, pois somente assim conseguir\u00edamos corrigir as regi\u00f5es afetadas pelo sistema de\n\ncolima\u00e7\u00e3o [1]. Estas regi\u00f5es aparecem claramente nas bordas inferiores e superiores do per?l\n\ndo campo na ?gura 5.18.\n\nNeste gr\u00e1?co comparamos os per?s de dose total, prim\u00e1ria, secund\u00e1ria e de m\u00faltiplo\n\nespalhamento no eixo central do campo 20 ? 20 cm2. Na refer\u00eancia [3] o autor faz a mesma\ncompara\u00e7\u00e3o onde, pelos c\u00e1lculos te\u00f3ricos para o modelo homog\u00eaneo, o per?l do m\u00faltiplo\n\nespalhamento deveria ter o mesmo valor num\u00e9rico que o per?l secund\u00e1rio a partir de 20 cm\n\nde profundidade. Esta compara\u00e7\u00e3o \u00e9 mais um ind\u00edcio de que estamos subestimando a dose\n\ntotal por perder energia, principalmente, no n\u00facleo de m\u00faltiplo espalhamento.\n\n75\n\n\n\n0 10 20 30\n0\n\n100\n\nConvolu\u00e7\u00e3o X Medidas\n\nEixo X (cm)\n\nIn\nte\n\nn\nsi\n\nd\nad\n\ne\n\nPerfil da dose no eixo X, com Z=0,5cm\n\nALCYON II\n\nConvolu\u00e7\u00e3o\n\nFigura 5.18: Compara\u00e7\u00e3o do per?l transversal da dose para o campo de 10?10 cm2 a 0; 5 cm\nde profundidade entre o modelo apresentado nesta tese e os dados obtidos da m\u00e1quina\nALCYON II.\n\n76\n\n\n\n0 10 20 30\n0\n\n100\n\nConvolu\u00e7\u00e3o X Medidas\n\nEixo X (cm)\n\nIn\nte\n\nn\nsi\n\nd\nad\n\ne\n\nPerfil da dose no eixo X, com Z=20cm\n\nALCYON II\n\nConvolu\u00e7\u00e3o\n\nFigura 5.19: Compara\u00e7\u00e3o do per?l transversal da dose para o campo de 10?10 cm2 a 20 cm\nde profundidade entre o m\u00e9todo de convolu\u00e7\u00e3o e os dados obtidos da m\u00e1quina ALCYON II.\n\n77\n\n\n\n0 10 20 30\n0\n\n100\n\n110\n\nPerfil central no eixo Z\n\nEixo Z (cm)\n\nIn\nte\n\nn\nsi\n\nd\nad\n\ne\n\nCampo 20x20cm\u00b2\n\nDose Total\n\nDose Prim\u00e1ria\n\nDose Secund\u00e1ria\n\nDose M\u00faltiplo Espalhamento\n\nFigura 5.20: Os per?s das doses total e parciais.\n\n78\n\n\n\n5.2.1.2 Compara\u00e7\u00e3o com o programa PLATO\n\nVamos comparar o per?l de dose no centro do campo 10?10 cm2 calculado com o programa\nPLATO com o m\u00e9todo de convolu\u00e7\u00e3o descrito nesta tese. Excepcionalmente normalizamos\n\no pico em 124,579% porque o programa PLATO tem problemas para normalizar o pico a\n\n100%. Veri?camos pelo gr\u00e1?co 5.21 que a concord\u00e2ncia est\u00e1 muito boa.\n\n5.2.2 Os testes em meios heterog\u00eaneos\n\nComo j\u00e1 citamos, \u00e9 esperado que este algoritmo calcule bem apenas os elementos heterog\u00ea-\n\nneos que tenham a mesma se\u00e7\u00e3o de choque que a \u00e1gua, mas densidades diferentes. Vamos\n\nent\u00e3o usar a situa\u00e7\u00e3o mostrada na ?gura 5.22 para as compara\u00e7\u00f5es, onde uma fatia do tan-\n\nque de \u00e1gua \u00e9 substitu\u00edda por um outro meio de densidade relativa ? = 0; 25g=cm3, mas de\n\nmesma se\u00e7\u00e3o de choque que a \u00e1gua. Esta fatia de menor densidade pode ser considerada\n\nequivalente ao pulm\u00e3o.\n\n5.2.2.1 Compara\u00e7\u00e3o com a simula\u00e7\u00e3o no EGS4\n\nAplicamos um campo de 1 ? 1 cm2 perpendicular \u00e0 superf\u00edcie do meio e obtivemos a curva\nde isodose no plano central apresentada na ?gura 5.23.\n\nUsamos novamente o programa XYZP do EGS4, mas desta vez sem nenhuma modi?ca-\n\n\u00e7\u00e3o, para compararmos o resultado calculado pela convolu\u00e7\u00e3o com o simulado. A qualidade\n\nda simula\u00e7\u00e3o depende diretamente do n\u00famero de hist\u00f3rias. Usamos um feixe estreito de\n\n1 ? 1 cm2 para conseguir uma boa precis\u00e3o, concentrando as part\u00edculas em uma \u00e1rea pe-\nquena. Desta forma a incerteza no per?l central do feixe foi menor que 1%. Para reduzir\n\no tempo de simula\u00e7\u00e3o a valores aceit\u00e1veis (da ordem de algumas dezenas de horas) usamos\n\nc\u00e9lulas de 1 ? 1 ? 1 cm3. \u00c9 importante lembrar que o programa XYZP simula feixes de\nf\u00f3tons paralelos, assim os c\u00e1lculos por convolu\u00e7\u00e3o foram feitos sem a queda com o inverso\n\ndo quadrado da dist\u00e2ncia (SSD = in?nito).\n\nNotamos a excelente concord\u00e2ncia com os resultados da simula\u00e7\u00e3o, sendo o desvio na\n\nprofundidade de 24 cm menor que 1%. Nas interfaces com material de menor densidade o erro\n\nchegou a 2,7%. Esperamos que a discord\u00e2ncia neste ponto seja realmente um pouco maior\n\nporque nesta regi\u00e3o n\u00e3o h\u00e1 equil\u00edbrio eletr\u00f4nico. Este fen\u00f4meno ocorre porque a produ\u00e7\u00e3o de\n\nel\u00e9trons livres depende diretamente da densidade do meio, assim o meio de menor densidade\n\ngera menos el\u00e9trons que o de maior. Portanto esperamos que a dose calculada dentro deste\n\nmeio seja um pouco menor que a simulada em 5 cm (antes da segunda interface), e superior\n\nque a simulada em 6 cm. Esta previs\u00e3o se con?rma em 5 cm mas n\u00e3o em 6 cm porque as\n\n79\n\n\n\n0 10 20 30 32\n0\n\n100\n\n137\n\nConvolu\u00e7\u00e3o X PLATO\n\nEixo Z (cm)\n\nIn\nte\n\nn\nsi\n\nd\nad\n\ne\n\nPerfil central no eixo Z (SSD=80cm)\n\nCalculado por convolu\u00e7\u00e3o\n\nCalculado pelo PLATO\n\nF\nigu\n\nra\n5.21:\n\nC\nom\n\np\nara\u00e7\u00e3o\n\nen\ntre\n\nos\nresu\n\nltad\nos\n\nd\no\nP\nL\nA\nT\nO\n\ne\ncon\n\nvolu\n\u00e7\u00e3o.\n\n80\n\n\n\n2 cm\n\n4 cm\n\n26 cm\n\n??=0,25 g/cm\n\n??=1,0 g/cm\n\n??=1,0 g/cm 33\n\n33\n\n33\nzz\n\nx,y\n\n32 cm\n\nFigura 5.22: Situa\u00e7\u00e3o proposta para simular o tecido do pulm\u00e3o entre tecidos musculares.\n\nc\u00e9lulas onde est\u00e3o calculadas as doses s\u00e3o menores que as da simula\u00e7\u00e3o, e este fato interferiu\n\nna precis\u00e3o. No entanto, os resultados apresentam-se muito bons.\n\n5.2.2.2 Compara\u00e7\u00e3o com o programa PLATO\n\nPara este teste o campo usado foi de 10?10 cm2, SSD de 80 cm e consideramos a diverg\u00eancia\ngeom\u00e9trica. A normaliza\u00e7\u00e3o excepcionalmente foi feita em 104,67%. Apresentamos na ?gura\n\n5.25 a compara\u00e7\u00e3o dos per?s de dose no centro do campo entre o calculado pelo algoritmo\n\napresentado nesta tese e o calculado pelo PLATO.\n\nNo gr\u00e1?co 5.25 comparamos os resultados do programa de convolu\u00e7\u00e3o com o do PLATO.\n\nPelo PLATO calculamos duas situa\u00e7\u00f5es: a primeira segue exatamente a ?gura 5.22 e a\n\nsegunda substitui a densidade do pulm\u00e3o pela da \u00e1gua, ou seja, temos um meio homog\u00eaneo.\n\nEste gr\u00e1?co nos mostra claramente que o PLATO corrige a atenua\u00e7\u00e3o exponencial, por-\n\nque os pontos ap\u00f3s a regi\u00e3o de ? = 0; 25 g=cm3 coincidem com o resultado da convolu\u00e7\u00e3o,\n\nmas n\u00e3o corrige a dose nessa mesma regi\u00e3o! Temos a certeza de que o PLATO realiza a\n\ncorre\u00e7\u00e3o exponencial quando comparamos o per?l de dose no meio homog\u00eaneo, por ele cal-\n\nculado, com o heterog\u00eaneo e vemos que o primeiro possui uma queda mais acentuada, como\n\ndeveria ser.\n\n81\n\n\n\n0 10 20 25\n14.5\n\n15\n\n16\n\n17\n\n17.5\n\nEixo Z (cm)\n\nE\nix\n\no \nY\n\n (\ncm\n\n)\n\n10 10\n10\n\n10\n\n10 10\n10\n\n10\n\n20 20\n20\n\n20\n\n20\n\n20\n\n202\n0\n\n30 30\n\n30\n\n30\n\n30\n\n30\n\n3030\n\n40\n40\n\n40\n\n40\n\n40\n\n40\n\n50\n50\n\n50\n\n50\n50\n\n60\n60\n\n60\n\n60\n\n70\n\n70\n\n70\n\n80\n\n80\n\n80\n\n80\n\n90\n\nF\nigu\n\nra\n5.23:\n\nC\nu\nrvas\n\nd\ne\niso\n\nd\nose\n\np\nara\n\no\nm\neio\n\ncom\np\nosto\n\nd\na\n?\ngu\nra\n\n5.22\ncom\n\ncam\np\no\nd\ne\n1?\n\n1\ncm\n\n2.\n\n82\n\n\n\n0 10 20 30 32\n0\n\n100\n\n110\n\nConvolu\u00e7\u00e3o X EGS\n\nProfundidade, Eixo Z (cm)\n\nIn\nte\n\nn\nsi\n\nd\nad\n\ne\n\nPerfil central no eixo Z (SSD=inf.)\n\nCalculado por convolu\u00e7\u00e3o\n\nSimulado no EGS4\n\nF\nigu\n\nra\n5.24:\n\nC\nom\n\np\nara\u00e7\u00e3o\n\nd\no\np\ner?\n\nl\ncen\n\ntral\nd\na\nd\nose\n\ncalcu\nlad\n\na\np\nor\n\ncon\nvolu\n\n\u00e7\u00e3o\ncon\n\ntra\nos\n\nre-\nsu\nltad\n\nos\nd\na\nsim\n\nu\nla\u00e7\u00e3o.\n\n83\n\n\n\n0 10 20 30 32\n0\n\n100\n\n115.1\n\nConvolu\u00e7\u00e3o X Programa atual\n\nEixo Z (cm)\n\nIn\nte\n\nn\nsi\n\nd\nad\n\ne\n\nCampo 10x10 cm\u00b2\n\nPlato (homog\u00eaneo)\n\nPlato (heterog\u00eaneo)\n\nConvolu\u00e7\u00e3o\n\nF\nigu\n\nra\n5.25:\n\nC\nom\n\np\nara\u00e7\u00e3o\n\nen\ntre\n\na\ncon\n\nvolu\n\u00e7\u00e3o\n\ne\no\nresu\n\nltad\no\nd\no\np\nrogram\n\na\nP\nL\nA\nT\nO\n.\n\n84\n\n\n\nCap\u00edtulo 6\n\nConclus\u00f5es\n\nNesta tese implementamos um algoritmo para c\u00e1lculo da dose em meios heterog\u00eaneos usando\n\nconvolu\u00e7\u00f5es [6]. Aplicamos a t\u00e9cnica de transformada de Fourier r\u00e1pida (FFT) na imple-\n\nmenta\u00e7\u00e3o computacional deste algoritmo. Os n\u00facleos de transporte e deposi\u00e7\u00e3o de energia\n\nforam simulados usando um programa modi?cado por n\u00f3s, o XYZP dispon\u00edvel no pacote do\n\nEGS4.\n\nA implementa\u00e7\u00e3o deste algoritmo apresentou excelentes resultados quando comparados\n\ncom os dados experimentais medidos no CAISM e resultados de simula\u00e7\u00f5es no EGS4. A\n\ndiscord\u00e2ncia do per?l da dose no eixo central do campo em profundidades maiores que 20 cm\n\npara grandes campos se deve, principalmente, ao pouco espa\u00e7o reservado para o meio ma-\n\nterial onde foram simulados os n\u00facleos secund\u00e1rio e de m\u00faltiplo espalhamento. Este espa\u00e7o\n\ndeveria conter pelo menos uma esfera de meio material de raio igual a 60 cm [15], mas\n\no n\u00famero de c\u00e9lulas da matriz que discretiza este meio era limitado pelo m\u00e9todo usado\n\nna simula\u00e7\u00e3o e pela quantidade de mem\u00f3ria dispon\u00edvel. Este fato impediu que os n\u00facleos\n\nalcan\u00e7assem uma qualidade melhor. O programa XYZP adaptado para esta ?nalidade pra-\n\nticamente chegou ao seu limite, portanto no aprimoramento desta pesquisa deveremos usar\n\nalgum programa que contorne este problema usando, por exemplo, coordenadas cil\u00edndricas\n\nou esf\u00e9ricas, aproveitando as simetrias do problema [15].\n\nO cerne matem\u00e1tico do programa de c\u00e1lculo da dose de radia\u00e7\u00e3o tem um desempenho\n\ncompar\u00e1vel aos comerciais, tanto na precis\u00e3o dos c\u00e1lculos, quanto no tempo de c\u00e1lculo. Para\n\nse calcular a matriz 3D da distribui\u00e7\u00e3o da dose para todo um meio material de 32?32?32 cm3\no tempo gasto \u00e9 de aproximadamente 3 minutos em um equipamento do tipo PC de 400MHz.\n\nNo entanto, ainda h\u00e1 muito a ser otimizado no programa respons\u00e1vel pela convolu\u00e7\u00e3o, o que\n\npode aumentar ainda mais a sua e?ci\u00eancia.\n\n85\n\n\n\nNa parte computacional, o pr\u00f3ximo passo ser\u00e1 a constru\u00e7\u00e3o, por pro?ssionais da \u00e1rea\n\nda inform\u00e1tica, de uma interface gr\u00e1?ca e um m\u00f3dulo que permita ler arquivos de dados\n\nprovenientes de sistemas de tomogra?as computadorizadas e resson\u00e2ncia magn\u00e9tica, que s\u00e3o\n\nas fontes de informa\u00e7\u00e3o 3D da geometria do paciente e do tumor.\n\nConclu\u00edmos portanto, que o m\u00e9todo descrito nesta tese para a obten\u00e7\u00e3o da distribui\u00e7\u00e3o\n\nespacial da dose absorvida usando convolu\u00e7\u00f5es \u00e9 bastante preciso e vi\u00e1vel de ser implantado\n\nno planejamento de procedimentos de teleterapia.\n\n86\n\n\n\nAp\u00eandice A\n\nAlgumas de?ni\u00e7\u00f5es usadas nesta tese\n\nApresentamos aqui as de?ni\u00e7\u00f5es formais das grandezas f\u00edsicas usadas nesta tese dadas pela\n\nICRU (International Commission on Radiation Units and Measurements) [23]. As unidades\n\ndestas grandezas s\u00e3o expressas de acordo com o Sistema Internacional de unidades (SI).\n\nNa segunda se\u00e7\u00e3o deste ap\u00eandice de?nimos a maneira pela qual avaliamos o erro entre\n\nos valores calculados e aqueles usados como refer\u00eancia.\n\nA.1 As de?ni\u00e7\u00f5es dadas pelo ICRU\n\nA.1.1 Radiometria\n\nA ?u\u00eancia de part\u00edculas, ?, \u00e9 o quociente de dN por da, onde dN \u00e9 o n\u00famero de\n\npart\u00edculas incidente em uma esfera de \u00e1rea da.\n\n? =\ndN\n\nda\n:\n\nUnidade: m?2.\n\nA.1.2 Coe?cientes de intera\u00e7\u00e3o\n\nA se\u00e7\u00e3o de choque, ?, de um alvo para uma intera\u00e7\u00e3o produzida por uma part\u00edcula\n\ncarregada ou n\u00e3o, \u00e9 o quociente de P por ?, onde P \u00e9 a probabilidade de intera\u00e7\u00e3o por\n\npart\u00edcula alvo quando sujeita a uma ?u\u00eancia de part\u00edculas ?.\n\n? =\nP\n\n?\n: (A.1)\n\n87\n\n\n\nUnidade: m2.\n\nCoe?ciente de atenua\u00e7\u00e3o em massa, ?=?, de um material para part\u00edculas ionizantes\n\nsem carga el\u00e9trica \u00e9 o quociente de dN=N por ?d`, onde dN=N \u00e9 a fra\u00e7\u00e3o de part\u00edculas que\n\ninteragem ap\u00f3s atravessarem uma dist\u00e2ncia d` em um material de densidade ?.\n\n?\n\n?\n=\n\n1\n\n?N\n\ndN\n\nd`\n: (A.2)\n\nUnidade: m2 kg?1\n\nNota: ?, de?nido implicitamente, \u00e9 o coe?ciente de atenua\u00e7\u00e3o linear total.\n\nCoe?ciente de transfer\u00eancia de energia em massa, ?tr=?, de um material para par-\n\nt\u00edculas ionizantes sem carga el\u00e9trica \u00e9 dado pelo quociente de dEtr=EN por ?d`, onde E \u00e9 a\n\nenergia de cada part\u00edcula (excluindo a sua energia de repouso), N \u00e9 o n\u00famero de part\u00edculas,\n\ne dEtr=EN \u00e9 a fra\u00e7\u00e3o da energia da part\u00edcula inicidente que \u00e9 transferida para a energia\n\ncin\u00e9tica de part\u00edculas carregadas pelas intera\u00e7\u00f5es ao ser atravessada uma dist\u00e2ncia d` em\n\num material de densidade ?.\n?tr\n?\n\n=\n1\n\n?EN\n\ndEtr\nd`\n\n: (A.3)\n\nUnidade: m2 kg?1.\n\nCoe?ciente de absor\u00e7\u00e3o de energia em massa, ?en=?, de um material para part\u00edculas\n\nionizantes sem carga el\u00e9trica \u00e9 o produto do coe?ciente de transfer\u00eancia de energia em massa,\n\n?tr=?, por (1 ? g), onde g \u00e9 a fra\u00e7\u00e3o da energia das part\u00edculas carregadas secund\u00e1rias que \u00e9\nperdida por bremsstrahlung no material.\n\n?en\n?\n\n=\n?tr\n?\n\n(1 ? g) : (A.4)\n\nUnidade: m2 kg?1.\n\nStopping power total em massa, S=?, de um material para part\u00edculas carregadas \u00e9\n\no quociente de dE por ?d`, onde dE \u00e9 a energia perdida por uma part\u00edcula carregada ao\n\natravessar uma dist\u00e2ncia d` em um material de densidade ?.\n\nS\n\n?\n=\n\n1\n\n?\n\ndE\n\nd`\n: (A.5)\n\n88\n\n\n\nUnidade: J m2 kg?1.\n\nNota: De?nido implicitamente est\u00e1 o stopping power linear total, S.\n\nA.1.3 Dosimetria\n\nEnergia cedida, ?, pela radia\u00e7\u00e3o ionizante para a mat\u00e9ria em um volume \u00e9:\n\n? = Rin ? Rout +\nX\n\nQ (A.6)\n\nonde\n\n? Rin \u00e9 a energia radiante incidente no volume, isto \u00e9, a soma das energias cin\u00e9ticas de\ntodas as part\u00edculas ionizantes carregadas e neutras que entram no volume.\n\n? Rout \u00e9 a energia radiante que sai do volume, isto \u00e9, a soma das energias cin\u00e9ticas de\ntodas as part\u00edculas ionizantes carregadas e neutras que deixam o volume.\n\n? PQ \u00e9 a soma de todas as mudan\u00e7as na energia de repouso dos n\u00facleos e part\u00edculas\nelementares em qualquer transforma\u00e7\u00e3o nuclear que ocorra no volume.\n\nUnidade: J.\n\nNota: ? \u00e9 uma quantidade estoc\u00e1stica, mas seu valor esperado, designado energia m\u00e9dia\n\ncedida, ?, \u00e9 uma quantidade n\u00e3o-estoc\u00e1stica.\n\nA dose absorvida, D, \u00e9 o quociente de d? por dm, onde d? \u00e9 a energia m\u00e9dia cedida pela\n\nradia\u00e7\u00e3o ionizante para uma quantidade de mat\u00e9ria de massa dm.\n\nD =\nd?\n\ndm\n: (A.7)\n\nUnidade: J kg?1.\n\nNota: O nome especial para a unidade de dose absorvida \u00e9 o gray (Gy), equivalente a\n\num joule por kilograma.\n\n89\n\n\n\nO kerma, K, \u00e9 o quociente de dEtr por dm, onde dEtr \u00e9 a soma das energias cin\u00e9ticas\n\niniciais de todas as part\u00edculas ionizantes carregadas liberadas pelas part\u00edculas ionizantes\n\nneutras em um material de massa dm.\n\nk =\ndEtr\ndm\n\n: (A.8)\n\nUnidade: J kg?1.\n\nNota: O gray (Gy) tamb\u00e9m \u00e9 usado como unidade para o kerma da mesma forma que\n\npara a dose.\n\nA.2 Erro relativo e absoluto\n\nDurante os estudos dos artigos sobre os algoritmos de c\u00e1lculo da dose de radia\u00e7\u00e3o notamos\n\no emprego freq\u00fcente de um tipo de avalia\u00e7\u00e3o de erro entre os dados do modelo apresentado\n\ncom os valores medidos ou simulados, que servem de refer\u00eancia. No entanto este tipo de\n\navalia\u00e7\u00e3o de erro \u00e9 pouco pr\u00e1tico para o f\u00edsico m\u00e9dico no seu dia-a-dia. Nesta tese utilizamos\n\num outro tipo de avalia\u00e7\u00e3o do erro, o erro relativo. Em contrapartida, chamaremos de erro\n\nabsoluto a forma de avalia\u00e7\u00e3o do erro comumente usada nos artigos cient\u00ed?cos.\n\nDe?nimos o erro relativo, \"r, no ponto ?!ri como sendo o quociente entre o m\u00f3dulo da\ndiferen\u00e7a entre o valor de refer\u00eancia, Dm, e o calculado, Dc, pelo valor de refer\u00eancia, todos\n\ndados no mesmo ponto de interesse, ?!ri .\n\n\"r (\n?!ri ) =\n\njDc (?!ri ) ? Dm (?!ri )j\nDm (\n\n?!ri )\n? 100% (A.9)\n\nDe?nimos o erro absoluto, \"a, no ponto ?!ri como o quociente entre m\u00f3dulo da diferen\u00e7a\nentre os valores refer\u00eancia e calculado, e o valor de pico do conjunto de dados de refer\u00eancia,\n\nDpico.\n\n\"a (\n?!ri ) =\n\njDc (?!ri ) ? Dm (?!ri )j\nDpico\n\n? 100% (A.10)\n\nO valor de refer\u00eancia pode ser o resultado experimental ou o simulado.\n\nNote que o erro absoluto \u00e9 proporcional \u00e0 diferen\u00e7a entre o valor de refer\u00eancia e o\n\ncalculado, j\u00e1 o erro relativo depende da raz\u00e3o entre esta diferen\u00e7a e o valor de refer\u00eancia.\n\nTipicamente o erro relativo \u00e9 maior que o erro absoluto como mostrado no cap\u00edtulo 5. Desta\n\nforma, o erro em um determinado ponto \u00e9 interpretado como a toler\u00e2ncia percentual entre\n\no valor real e o calculado naquele ponto.\n\n90\n\n\n\nAp\u00eandice B\n\nTabela de probabilidades de\n\nintera\u00e7\u00f5es do f\u00f3ton na \u00e1gua\n\nEncontramos na tabela a seguir a propor\u00e7\u00e3o entre os tipos de intera\u00e7\u00f5es na \u00e1gua para\n\nv\u00e1rias energias de f\u00f3tons e as respectivas propor\u00e7\u00f5es para a transfer\u00eancia de energia em cada\n\nprocesso. Os valores que apresentamos prov\u00eam da refer\u00eancia [1].\n\n91\n\n\n\n% de intera\u00e7\u00f5es por cada processo % de energia transferida\n\npor cada processo\n\n% da energia\n\nperdida por\n\nbremsstrahlung\n\nh?\n\n(keV)\n\nRayl. Comp. Foto. Pares Comp. Foto. Pares\n\n10,0 4,5 3,1 92,4 0,0 0,1 99,9 0,0 0,0\n\n15,0 8,5 10,8 80,7 0,0 0,4 99,6 0,0 0,0\n\n20,0 11,6 23,3 65,1 0,0 1,3 98,7 0,0 0,0\n\n30,0 13,0 50,7 36,3 0,0 6,8 93,2 0,0 0,0\n\n40,0 11,0 69,6 19,4 0,0 19,3 80,7 0,0 0,0\n\n50,0 8,6 80,4 11,0 0,0 37,2 62,8 0,0 0,0\n\n60,0 6,8 86,6 6,6 0,0 55,0 45,0 0,0 0,0\n\n80,0 4,5 92,6 2,9 0,0 78,8 21,2 0,0 0,0\n\n100,0 3,1 95,3 1,5 0,0 89,6 10,4 0,0 0,0\n\n150,0 1,6 97,9 0,5 0,0 97,4 2,6 0,0 0,0\n\n200,0 1,0 98,8 0,2 0,0 99,0 1,0 0,0 0,0\n\n300,0 0,5 99,4 0,1 0,0 99,7 0,3 0,0 0,1\n\n400,0 0,4 99,6 0,0 0,0 99,9 0,1 0,0 0,1\n\n500,0 0,3 99,7 0,0 0,0 99,9 0,1 0,0 0,1\n\n600,0 0,2 99,8 0,0 0,0 100,0 0,0 0,0 0,1\n\n800,0 0,1 99,9 0,0 0,0 100,0 0,0 0,0 0,2\n\n(MeV)\n\n1,0 0,1 99,9 0,0 0,0 100,0 0,0 0,0 0,2\n\n1,5 0,0 99,8 0,0 0,2 99,9 0,0 0,1 0,4\n\n2,0 0,0 99,2 0,0 0,8 99,3 0,0 0.7 0,5\n\n3,0 0,0 97,1 0,0 2,9 96,7 0,0 3,3 0,8\n\n4,0 0,0 94,5 0,0 5,5 93,3 0,0 6,7 1,1\n\n5,0 0,0 91,6 0,0 8,4 89,6 0,0 10,4 1,4\n\n6,0 0,0 88,9 0,0 11,1 86,2 0,0 13,8 1,6\n\n8,0 0,0 83,1 0,0 16,9 79,0 0,0 21,0 2,3\n\n10,0 0,0 77,0 0,0 23,0 71,9 0,0 28,1 2,9\n\n15,0 0,0 65,6 0,0 34,4 59,3 0,0 40,7 4,6\n\n20,0 0,0 56,0 0,0 44,0 49,3 0,0 50,7 6,5\n\n30,0 0,0 43,2 0,0 56,8 37,1 0,0 62,9 10,0\n\n40,0 0,0 35,1 0,0 64,9 29,7 0,0 70,3 13,6\n\n50,0 0,0 29,3 0,0 70,7 24,6 0,0 75,4 16,8\n\n60,0 0,0 25,3 0,0 74,7 21,1 0,0 78,9 19,8\n\n80,0 0,0 19,7 0,0 80,3 16,4 0,0 83,6 25,3\n\n100,0 0,0 16,0 0,0 84,0 13,3 0,0 86,7 30,1\n\n92\n\n\n\nAp\u00eandice C\n\nOs testes e o c\u00f3digo fonte do\n\nprograma que realiza os c\u00e1lculos 3D\n\nda dose\n\nNeste ap\u00eandice apresentamos os testes e a implementa\u00e7\u00e3o computacional da fun\u00e7\u00e3o de con-\n\nvolu\u00e7\u00e3o 3D dada pela equa\u00e7\u00e3o 4.1, aplicando as t\u00e9cnicas discutidas no cap\u00edtulo 4. Apresen-\n\ntamos tamb\u00e9m o c\u00f3digo fonte dos programas usados nos c\u00e1lculos da distribui\u00e7\u00e3o 3D da dose\n\nmostrados no cap\u00edtulo 5.\n\nC.1 A estrutura do programa de convolu\u00e7\u00e3o\n\nOs m\u00f3dulos do programa de c\u00e1lculo tridimensional da dose est\u00e3o organizados conforme o\n\nesquema mostrado na ?gura C.1.\n\nO usu\u00e1rio do programa deve fornecer como informa\u00e7\u00e3o de entrada a matriz de densidades\n\n[?] e um n\u00facleo de deposi\u00e7\u00e3o de energia [ki] (o \u00edndice i signi?ca prim\u00e1rio, secund\u00e1rio ou\n\nm\u00faltiplo espalhamento). Um programa chamado flu\u00eancia calcula a matriz da ?u\u00eancia\n\nprim\u00e1ria [?p] a partir da matriz de densidades, conforme discutido na se\u00e7\u00e3o 4.2. O programa\n\ndose calcula a matriz de dose parcial [Di] por meio da convolu\u00e7\u00e3o via FFT como apresentado\n\nnas se\u00e7\u00f5es 4.2 e 4.3.2.\n\nEste procedimento \u00e9 feito para cada n\u00facleo de deposi\u00e7\u00e3o de energia a ?m de obter as\n\ndoses parciais. Por ?m, um programa bastante simples, n\u00e3o mostrado no esquema C.1, \u00e9\n\nusado para somar estas doses parciais e fornecer a dose total, o programa soma.\n\nTodos os programas foram escritos em linguagem C++ da GNU. Escolhemos esta lin-\n\n93\n\n\n\n[[??]]\n\n[[??\npp\n]] [[kk\n\nii\n]]\n\ndose\n\n[[DD\nii\n]]\n\nflu\u00eancia\n\nEntrada \nde dados\n\nSa\u00edda de \ndados\n\nFigura C.1: Esquema da organiza\u00e7\u00e3o do programa de c\u00e1lculo tridimensional da dose. O\nsinal [ ] signi?ca matriz de dados no formato apresentado no ap\u00eandice F.\n\nguagem por ela possuir todas as caracter\u00edsticas de programa\u00e7\u00e3o estruturada do ANSI C [24]\n\ne ao mesmo tempo dispor de comandos orientados a objeto, que facilita muito a programa-\n\n\u00e7\u00e3o. O C++ da GNU \u00e9 muito conhecido pois seu compilador e as bibliotecas associadas s\u00e3o\n\ntodas gratuitas e de dom\u00ednio p\u00fablico. Este fato torna os compiladores da GNU dispon\u00edveis\n\npara qualquer sistema operacional existente no mercado.\n\nC.1.1 O c\u00f3digo fonte\n\nComo apresentado na se\u00e7\u00e3o anterior, o programa de c\u00e1lculo da dose \u00e9 composto basicamente\n\npor tr\u00eas blocos que tratam da ?u\u00eancia, convolu\u00e7\u00e3o e soma das doses parciais. Este tr\u00eas blocos\n\ns\u00e3o unidos em um shell-script [25] para a TCshella. Por quest\u00e3o de espa\u00e7o n\u00e3o discutiremos\n\nos detalhes do c\u00f3digo fonte e comentaremos apenas os termos gerais.\n\nImplementamos a ?u\u00eancia prim\u00e1ria dada pela equa\u00e7\u00e3o 4.4 multiplicada pela matriz den-\n\nsidade no programa flu\u00eancia. Este programa \u00e9 executado com o arquivo de densidades em\n\nsua linha de comando e pede ao usu\u00e1rio as seguintes informa\u00e7\u00f5es: a dist\u00e2ncia da fonte \u00e0\n\nsuperf\u00edcie (SSD), o tamanho do campo na superf\u00edcie do meio e se desejamos o campo com\n\nou sem diverg\u00eancia geom\u00e9trica.\n\naTCshell \u00e9 um tipo de terminal Linux/Unix que pode ser programado facilmente.\n\n94\n\n\n\nCom o arquivo de dados de ?u\u00eancia e os n\u00facleos de deposi\u00e7\u00e3o de energia armazenados em\n\narquivos no formato padr\u00e3o, executamos o programa dose para cada uma das doses parciais\n\na serem calculadas. Este programa faz a convolu\u00e7\u00e3o entre os dois conjuntos de dados que\n\ns\u00e3o informados na sua linha de comando. Como j\u00e1 comentamos, a convolu\u00e7\u00e3o \u00e9 obtida por\n\nmeio de FFT, que \u00e9 feita por uma biblioteca espec\u00ed?ca de alto desempenho chamada FFTW\n\n[26].\n\nA biblioteca FFTW possui v\u00e1rios tipos de algoritmos de FFT implementados em seu\n\nc\u00f3digo [26]. Ela seleciona o mais adequado a cada situa\u00e7\u00e3o, permitindo ao usu\u00e1rio trabalhar\n\ncom qualquer n\u00famero de amostragem, n\u00e3o necessariamente do tipo N = 2\n com \n sendo um\n\nn\u00famero inteiro positivob e mantendo a mesma precis\u00e3o, embora o tempo de c\u00e1lculo possa\n\nser um pouco maior.\n\nCom as doses parciais calculadas executamos o programa doset para som\u00e1-las e obtermos\n\na dose total.\n\nO programa flu\u00eancia\n\nLinha de compila\u00e7\u00e3o\n\ng++ -o fluencia fluencia3.C fluencia.C -O4\n\nOs arquivos fonte\n\nfluencia3.C\n\n#include&lt;iostream.h>\n\n#include&lt;fstream.h>\n\n#include \"fluencia.H\"\n\n#define NMaxCell 64\n\n#define ZMaxCell 64\n\nvoid main (int argc, char *argv[])\n\n{\n\nbComo o exigido pelo algoritmo original de Cooley-Tukey [20].\n\n95\n\n\n\nint i,j,k, nx,ny,nz, campo_x,campo_y;\n\ndouble phi, escalap, escalas, r0;\n\nchar diverg;\n\ndouble Ro[NMaxCell][NMaxCell][ZMaxCell],\n\nPhi[NMaxCell][NMaxCell][ZMaxCell];\n\nif (argc &lt;5) {\n\ncout&lt;&lt;\"Uso: \" ;\n\ncout&lt;&lt;argv[0] ;\n\ncout&lt;&lt;\" densidade_p.dat densidade_s.dat fluencia_p.dat\";\n\ncout&lt;&lt;\" fluencia_s.dat [fluencia_c.dat]\";\n\ncout&lt;&lt;endl;\n\nreturn 0;\n\n}\n\ncout&lt;&lt;\"Tamanho do campo (em # de c\u00e9lulas) na dire\u00e7c\u00e3o X= \" ;\n\ncin >> campo_x;\n\ncout&lt;&lt;\"Tamanho do campo (em # de c\u00e9lulas) na dire\u00e7c\u00e3o Y= \" ;\n\ncin >> campo_y;\n\ncout&lt;&lt;\"Deseja campo divergente (d) ou paralelo (p)? \";\n\ncin >> diverg;\n\ncout&lt;&lt;\"Qual a dist\u00e2ncia da fonte a superficie (SSD)? \";\n\ncin >> r0;\n\ncout&lt;&lt;\"A escala da fluencia prim\u00e1ria para cada voxel c\u00fabico (cm):\" ;\n\ncin >> escalap;\n\ncout&lt;&lt;\"A escala da fluencia secund\u00e1ria para cada voxel c\u00fabico (cm):\" ;\n\ncin >> escalas;\n\ncout&lt;&lt;\"As dimens\u00f5es m\u00e1xima da matriz atual \u00e9 de \";\n\ncout&lt;&lt;NMaxCell&lt;&lt;\" X \"&lt;&lt;NMaxCell&lt;&lt;\" X \"&lt;&lt;ZMaxCell&lt;&lt;endl;\n\n// Ler o arquivo passado como primeiro par\u00e2metro\n\nifstream leitura (argv[1]);\n\nleitura >> nx >> ny >> nz;\n\nfor (i=0; i<nx; i++)\n\nfor (j=0; j<ny; j++)\n\n96\n\n\n\nfor(k=0; k<nz; k++)\n\nleitura >> Ro[i][j][k];\n\nleitura.close();\n\n// A fluencia prim\u00e1ria\n\nFluencia (nx,ny,nz, campo_x,campo_y, escalap, r0, diverg, Ro, Phi);\n\nofstream saidap (argv[3]);\n\nsaidap&lt;&lt;nx&lt;&lt;\" \"&lt;&lt;ny&lt;&lt;\" \"&lt;&lt;nz&lt;&lt;endl&lt;&lt;endl;\n\nfor (i=0; i<nx; i++){\n\nfor (j=0; j<ny; j++){\n\nfor (k=0; k<nz; k++)\n\nsaidap&lt;&lt;Phi[i][j][k]&lt;&lt;\" \";\n\nsaidap&lt;&lt;endl;\n\n}\n\nsaidap&lt;&lt;endl;\n\n}\n\nsaidap.close ();\n\n// Ler o arquivo passado como segundo par\u00e2metro\n\nifstream leitura2 (argv[2]);\n\nleitura2 >> nx >> ny >> nz;\n\nfor (i=0; i<nx; i++)\n\nfor (j=0; j<ny; j++)\n\nfor(k=0; k<nz; k++)\n\nleitura2 >> Ro[i][j][k];\n\nleitura2.close();\n\n// A fluencia secund\u00e1ria e de m\u00faltiplo espalhamento\n\nFluencia (nx,ny,nz, campo_x,campo_y, escalas, r0, diverg, Ro, Phi);\n\nofstream saidas (argv[4]);\n\nsaidas&lt;&lt;nx&lt;&lt;\" \"&lt;&lt;ny&lt;&lt;\" \"&lt;&lt;nz&lt;&lt;endl&lt;&lt;endl;\n\nfor (i=0; i<nx; i++){\n\nfor (j=0; j<ny; j++){\n\nfor (k=0; k<nz; k++)\n\nsaidas&lt;&lt;(Phi[i][j][k]*Ro[i][j][k])&lt;&lt;\" \";\n\n97\n\n\n\nsaidas&lt;&lt;endl;\n\n}\n\nsaidas&lt;&lt;endl;\n\n}\n\nsaidas.close ();\n\n// A fluencia para os n\u00facleos de corre\u00e7\u00e3o\n\nif (argc>4){\n\nofstream saidac (argv[5]);\n\nsaidac&lt;&lt;nx&lt;&lt;\" \"&lt;&lt;ny&lt;&lt;\" \"&lt;&lt;nz&lt;&lt;endl&lt;&lt;endl;\n\nfor (i=0; i<nx; i++){\n\nfor (j=0; j<ny; j++){\n\nfor (k=0; k<nz; k++)\n\nsaidac&lt;&lt;(Phi[i][j][k]*Ro[i][j][k]*(1-Ro[i][j][k]))&lt;&lt;\" \";\n\nsaidac&lt;&lt;endl;\n\n}\n\nsaidac&lt;&lt;endl;\n\n}\n\nsaidac.close ();\n\n}\n\n}\n\nfluencia.H\n\n#include&lt;iostream.h>\n\n#include&lt;math.h>\n\n#define NMaxCell 64\n\n#define ZMaxCell 64\n\n#ifndef FLUENCIA_H\n\n#define FLUENCIA_H\n\nvoid Fluencia (int ,int ,int ,int ,int ,double , double , char ,\n\ndouble [][NMaxCell][ZMaxCell], double [][NMaxCell][ZMaxCell]);\n\n#endif\n\n98\n\n\n\nfluencia.C\n\n#include&lt;iostream.h>\n\n#include&lt;math.h>\n\n#define NMaxCell 64\n\n#define ZMaxCell 64\n\n#define phi0 1\n\n#define mi_ro 0.0632\n\ninline double Prod_exp (int ,int ,int ,double ,double [][NMaxCell][ZMaxCell]);\n\ninline double Campo (int , int , char ,double , double );\n\nvoid Fluencia (int nx, int ny, int nz, int campo_x, int campo_y,\n\ndouble escala,double r0, char Div,\n\ndouble ro [][NMaxCell][ZMaxCell],\n\ndouble phi [][NMaxCell][ZMaxCell]){\n\nint i,j,k;\n\ndouble r, x,y,z, campox, campoy;\n\nx = i*escala;\n\ny = j*escala;\n\nz = k*escala;\n\nr = sqrt(x*x + y*y + z*z);\n\nfor (i=0; i<nx; i++)\n\nfor (j=0; j<ny; j++)\n\nfor (k=0; k<nz; k++){\n\nif(i>=((nx-Campo(k,campo_x, Div, escala, r0))/2) &amp;\n\ni<=((nx+Campo(k,campo_x, Div, escala, r0))/2) &amp;\n\nj>=((ny-Campo(k,campo_y, Div, escala, r0))/2) &amp;\n\n99\n\n\n\nj<=((ny+Campo(k,campo_y, Div, escala, r0))/2)){\n\nphi[i][j][k] = phi0*(r0*r0 / ((k*escala+r0)*(k*escala+r0)))\n\n*Prod_exp(i,j,k, escala, ro);\n\n}\n\nelse {phi[i][j][k] = 0.0;}\n\n}\n\n}\n\ninline double Prod_exp (int i,int j,int k, double escala,\n\ndouble ro[][NMaxCell][ZMaxCell]){\n\nint z;\n\ndouble produtorio;\n\nprodutorio = 1.0;\n\nfor (z=0; z<=k; z++)\n\nprodutorio *= exp (-ro[i][j][z] * mi_ro * escala);\n\nreturn produtorio;\n\n}\n\ninline double Campo (int k, int campo, char divergencia,\n\ndouble escala, double ssd){\n\ndouble ext_campo;\n\nswitch (divergencia){\n\ncase 'd':\n\next_campo = (k*escala +ssd) * (campo/ssd);\n\nbreak;\n\ncase 'p':\n\next_campo = campo;\n\nbreak;\n\n}\n\nreturn ext_campo;\n\n100\n\n\n\n}\n\nO programa dose\n\nLinha de compila\u00e7\u00e3o\n\ng++ -o dose dose_c.C convolucao_c.C -O4\n\nOs arquivos fonte\n\ndose_c.C\n\n#include&lt;iostream.h>\n\n#include&lt;fstream.h>\n\n#include&lt;fftw.h>\n\n#include \"convolucao_c.H\"\n\n#include \"../acessorios/deslocar.H\"\n\n#define NMaxCell 128\n\n#define ZMaxCell 128\n\nvoid main (int argc, char *argv[])\n\n{\n\nfftw_complex Phi[NMaxCell][NMaxCell][ZMaxCell],\n\nKernel[NMaxCell][NMaxCell][ZMaxCell];\n\nfftw_complex dosep[NMaxCell][NMaxCell][ZMaxCell];\n\nint i,j,k, nx,ny,nz, nxc,nyc,nzc;\n\nunsigned foi;\n\ndouble Dose;\n\nif (argc &lt;4)\n\n{\n\ncout&lt;&lt;\"Uso: \"&lt;&lt;argv[0]&lt;&lt;\" fluencia.dat kernel.kernel\";\n\ncout&lt;&lt;\" saida.dat kernel.id\"&lt;&lt;endl;\n\nreturn 0;\n\n101\n\n\n\n}\n\n// Limpando a \u00e1rea de matrizes\n\nfor (i=0; i<NMaxCell; i++)\n\nfor (j=0; j<NMaxCell; j++)\n\nfor (k=0; k<ZMaxCell; k++){\n\nPhi [i][j][k].im=0;\n\nPhi [i][j][k].re=0;\n\nKernel [i][j][k].im=0;\n\nKernel [i][j][k].re=0;\n\n}\n\n// Ler o arquivo passado como primeiro par\u00e2metro\n\nifstream leitura (argv[1]);\n\nleitura >> nx >> ny >> nz;\n\nfor (i=0; i<nx; i++)\n\nfor (j=0; j<ny; j++)\n\nfor(k=0; k<nz; k++)\n\nleitura >> Phi[i][j][k].re;\n\nleitura.close();\n\n// Lendo arquivo passado como segundo par\u00e2metro\n\nifstream leitura2 (argv[2]);\n\nleitura2 >> nxc >> nyc >> nzc;\n\nfor (i=0; i<nxc; i++)\n\nfor (j=0; j<nyc; j++)\n\nfor (k=0; k<nzc; k++)\n\nleitura2 >> Kernel[i][j][k].re;\n\nleitura2.close();\n\n// Chamando a fun\u00e7\u00e3o de convolu\u00e7\u00e3o\n\nfoi = convolucao (nx,ny,nz, Phi, Kernel, dosep);\n\nif (foi)\n\n{\n\ncout&lt;&lt;\"Modulo de convolucao acessado.\"&lt;&lt;endl;\n\n102\n\n\n\n}\n\n// gravando o arquivo com a dose\n\nDeslocar (dosep, argv[4], argv[3]);\n\n}\n\nconvolucao_c.H\n\n#include&lt;iostream.h>\n\n#include&lt;fstream.h>\n\n#include&lt;fftw.h>\n\n#include \"convolucao_c.H\"\n\n#include \"../acessorios/deslocar.H\"\n\n#define NMaxCell 128\n\n#define ZMaxCell 128\n\nvoid main (int argc, char *argv[])\n\n{\n\nfftw_complex Phi[NMaxCell][NMaxCell][ZMaxCell],\n\nKernel[NMaxCell][NMaxCell][ZMaxCell];\n\nfftw_complex dosep[NMaxCell][NMaxCell][ZMaxCell];\n\nint i,j,k, nx,ny,nz, nxc,nyc,nzc;\n\nunsigned foi;\n\ndouble Dose;\n\nif (argc &lt;4)\n\n{\n\ncout&lt;&lt;\"Uso: \"&lt;&lt;argv[0]&lt;&lt;\" fluencia.dat kernel.kernel\";\n\ncout&lt;&lt;\" saida.dat kernel.id\"&lt;&lt;endl;\n\nreturn 0;\n\n}\n\n103\n\n\n\n// Limpando a \u00e1rea de matrizes\n\nfor (i=0; i<NMaxCell; i++)\n\nfor (j=0; j<NMaxCell; j++)\n\nfor (k=0; k<ZMaxCell; k++){\n\nPhi [i][j][k].im=0;\n\nPhi [i][j][k].re=0;\n\nKernel [i][j][k].im=0;\n\nKernel [i][j][k].re=0;\n\n}\n\n// Ler o arquivo passado como primeiro par\u00e2metro\n\nifstream leitura (argv[1]);\n\nleitura >> nx >> ny >> nz;\n\nfor (i=0; i<nx; i++)\n\nfor (j=0; j<ny; j++)\n\nfor(k=0; k<nz; k++)\n\nleitura >> Phi[i][j][k].re;\n\nleitura.close();\n\n// Lendo arquivo passado como segundo par\u00e2metro\n\nifstream leitura2 (argv[2]);\n\nleitura2 >> nxc >> nyc >> nzc;\n\nfor (i=0; i<nxc; i++)\n\nfor (j=0; j<nyc; j++)\n\nfor (k=0; k<nzc; k++)\n\nleitura2 >> Kernel[i][j][k].re;\n\nleitura2.close();\n\n// Chamando a fun\u00e7\u00e3o de convolu\u00e7\u00e3o\n\nfoi = convolucao (nx,ny,nz, Phi, Kernel, dosep);\n\nif (foi)\n\n{\n\ncout&lt;&lt;\"Modulo de convolucao acessado.\"&lt;&lt;endl;\n\n}\n\n104\n\n\n\n// gravando o arquivo com a dose\n\nDeslocar (dosep, argv[4], argv[3]);\n\n}\n\nconvolucao_c.C\n\n#include&lt;iostream.h>\n\n#include&lt;fftw.h>\n\n#define NMaxCell 128\n\n#define ZMaxCell 128\n\n#include&lt;fstream.h>\n\nunsigned convolucao(int x, int y, int z,\n\nfftw_complex phi_p[][NMaxCell][ZMaxCell],\n\nfftw_complex k_p[][NMaxCell][ZMaxCell],\n\nfftw_complex dose[][NMaxCell][ZMaxCell])\n\n{\n\n// Variaveis da biblioteca FFTW\n\nfftw_complex *PHI, *K, DOSE[NMaxCell][NMaxCell][ZMaxCell];\n\nfftwnd_plan p, pinv;\n\ndouble scale = 1.0 / (NMaxCell * NMaxCell * ZMaxCell);\n\n// Variaveis internas do modulo de convolucao\n\nint i,j,k;\n\n// planos para ambas as transformadas\n\np = fftw3d_create_plan (NMaxCell,NMaxCell,ZMaxCell,\n\nFFTW_FORWARD, FFTW_ESTIMATE | FFTW_IN_PLACE);\n\npinv = fftw3d_create_plan (NMaxCell,NMaxCell,ZMaxCell,\n\nFFTW_BACKWARD, FFTW_ESTIMATE);\n\n// computando as FFT's\n\n105\n\n\n\nfftwnd_one(p, &amp;phi_p[0][0][0], NULL);\n\nfftwnd_one(p, &amp;k_p[0][0][0], NULL);\n\nfor (i=0; i<NMaxCell; ++i)\n\nfor (j=0; j<NMaxCell; ++j)\n\nfor (k=0; k<NMaxCell; ++k)\n\n{\n\nDOSE[i][j][k].re=(phi_p[i][j][k].re*k_p[i][j][k].re\n\n- phi_p[i][j][k].im*k_p[i][j][k].im)*scale;\n\nDOSE[i][j][k].im=(phi_p[i][j][k].re*k_p[i][j][k].im\n\n+ phi_p[i][j][k].im*k_p[i][j][k].re)*scale;\n\n}\n\n// transformada inversa para encontrar 'dose'\n\n// que e' a convolucao de 'phi' com 'k'\n\nfftwnd_one (pinv, &amp;DOSE[0][0][0], &amp;dose[0][0][0]);\n\n// destruindo os planejamentos das transformadas\n\nfftwnd_destroy_plan(p);\n\nfftwnd_destroy_plan(pinv);\n\nreturn 1;\n\n}\n\nO programa soma\n\nLinha de compila\u00e7\u00e3o\n\ng++ -o doset doset.C -O4\n\nO arquivo fonte\n\ndoset.C\n\n#include&lt;iostream.h>\n\n#include&lt;fstream.h>\n\n106\n\n\n\nvoid main (int argc, char *argv[])\n\n{\n\nint i,j,k, x, nx,ny,nz;\n\ndouble dosep, doses, dosem, doses_c, dosem_c, doset;\n\nif (argc &lt;4) {\n\ncout&lt;&lt;\"Uso:\"&lt;&lt;endl;\n\ncout&lt;&lt;argv[0];\n\ncout&lt;&lt;\" dose_primaria.dose dose_sec.dose \";\n\ncout&lt;&lt;\"dose_mul.dose [doses_c.dose dosem_c.dose]\"&lt;&lt;endl;\n\nreturn 0;}\n\nifstream entrada1 (argv[1]);\n\nentrada1 >> nx >> ny >> nz;\n\nifstream entrada2 (argv[2]);\n\nentrada2 >> nx >> ny >> nz;\n\nifstream entrada3 (argv[3]);\n\nentrada3 >> nx >> ny >> nz;\n\nifstream entrada4 (argv[4]);\n\nentrada4 >> nx >> ny >> nz;\n\nifstream entrada5 (argv[5]);\n\nentrada5 >> nx >> ny >> nz;\n\nofstream saida (\"doset.dose\");\n\nsaida&lt;&lt;nx&lt;&lt;\" \"&lt;&lt;ny&lt;&lt;\" \"&lt;&lt;nz&lt;&lt;endl&lt;&lt;endl;\n\ndosep=0.0; doses=0.0; dosem=0.0;\n\ndoses_c=0.0; dosem_c=0.0; doset=0.0;\n\nfor (i=0; i<nx; i++){\n\n107\n\n\n\nfor (j=0; j<ny; j++){\n\nfor(k=0; k<nz; k++){\n\nentrada1 >> dosep;\n\nentrada2 >> doses;\n\nentrada3 >> dosem;\n\nif (argc > 4){entrada4 >> doses_c;}\n\nif (argc > 5){entrada5 >> dosem_c;}\n\ndoset = dosep + doses + dosem + doses_c +dosem_c;\n\nsaida&lt;&lt;doset&lt;&lt;\" \";\n\n}\n\nsaida&lt;&lt;endl;\n\n}\n\nsaida&lt;&lt;endl&lt;&lt;endl;\n\n}\n\nentrada1.close();\n\nentrada2.close();\n\nentrada3.close();\n\nsaida.close();\n\nif (argc > 4){entrada4.close();}\n\nif (argc > 5){entrada5.close();}\n\n}\n\nC.2 Os Testes da Fun\u00e7\u00e3o de Convolu\u00e7\u00e3o\n\nFizemos os testes para averiguar se o programa de convolu\u00e7\u00e3o 3D estava funcionando cor-\n\nretamente. Usamos fun\u00e7\u00f5es unidimensionais e bidimensionais de [20] e comparamos com as\n\nrespectivas convolu\u00e7\u00f5es apresentadas nesta mesma refer\u00eancia. Criamos uma fun\u00e7\u00e3o tridi-\n\nmensional tamb\u00e9m para esta ?nalidade, e o resultado desta convolu\u00e7\u00e3o via FFT foi confron-\n\ntado com o resultado de um programa que fazia uma convolu\u00e7\u00e3o discreta, sem usar nenhum\n\nalgoritmo de FFT, apenas convertendo as integrais em somat\u00f3rios.\n\nTodos os arquivos de dados usados nos testes seguem a conven\u00e7\u00e3o apresentada no ap\u00ean-\n\ndice F.\n\n108\n\n\n\nC.2.1 Teste 1D\n\nO teste 1D consistiu na convolu\u00e7\u00e3o de uma fun\u00e7\u00e3o pulso unidimensional com ele pr\u00f3prio,\n\nh = f ? f. Este pulso \u00e9 de?nido pela express\u00e3o dada a seguir:\n\nf (0; 0;zi) =\n\n(\n2 se 0 ? zi &lt;7\n0 sezi ? 7\n\n(C.1)\n\nf (xi;yi;zi) = 0 sexi > 0 ouyi > 0 (C.2)\n\nUma fatia da matriz montada para o c\u00e1lculo \u00e9 dada abaixo:\n\nf (0;yi;zi) =\n\n2\n666664\n\n2 2 2 : : : 2 0 0 : : : : : : 0\n\n0 0 : : : : : : 0\n...\n\n...\n\n0 0 0 : : : : : : 0\n\n3\n777775\n16?16\n\n(C.3)\n\nAs outras fatias s\u00e3o nulas.\n\nNa ?gura C.2 temos o gr\u00e1?co encontrado para h (0; 0;zi), onde veri?camos que o resul-\n\ntado est\u00e1 correto.\n\nForam feitos testes com este pulso sobre os tr\u00eas eixos das coordenadas e sobre as dia-\n\ngonais de tr\u00eas faces do cubo. Os resultados foram exatamente os mesmos. Para manter a\n\nuniformidade em todos os testes 1D, as matrizes usadas foram de 16 ? 16 ? 16 c\u00e9lulas.\n\nC.2.2 Teste 2D\n\nOs dados usados neste teste s\u00e3o apresentados a seguir e tamb\u00e9m sa\u00edram da refer\u00eancia [20].\n\nf (0;yi;zi) =\n\n2\n666664\n\n2 1 0 0 0 0 0 0\n\n3 1 0 0 0 0 0 0\n\n0 0 0 0 0 0 0 0\n\n0 0 0 0 0 0 0 0\n\n3\n777775\n4?8\n\n(C.4)\n\ng (0;yi;zi) =\n\n2\n666664\n\n1 0 0 1 0 0 0 0\n\n2 1 3 2 0 0 0 0\n\n0 0 0 0 0 0 0 0\n\n0 0 0 0 0 0 0 0\n\n3\n777775\n4?8\n\n(C.5)\n\n109\n\n\n\n0\n10\n\n16\n0 10 20 30\n\n35.2\n\nE\nixo Z\n\nIntensidade\n\nF\nigu\n\nra\nC\n.2:\n\nC\non\nvolu\n\n\u00e7\u00e3o\nd\na\nfu\nn\n\u00e7\u00e3o\n\nap\nresen\n\ntad\na\nan\nteriorm\n\nen\nte\n\ncom\nela\n\np\nr\u00f3p\n\nria.\n\nf\n(x\n\ni ;y\ni ;z\n\ni )\n=\ng\n(x\n\ni ;y\ni ;z\n\ni )\n=\n\n0\ns\ne\nx\ni\n>\n\n0\n(C\n\n.6)\n\nA\ns\nm\natrizes\n\n3D\nu\nsad\n\nas\ntin\n\nh\nam\n\nd\nim\n\nen\ns\u00e3o\n\nd\ne\n4?\n\n4?\n8.\n\nO\nresu\n\nltad\no\nob\ntid\n\no\n\u00e9\nm\nostrad\n\no\na\nsegu\n\nir:\n\nh\n(0\n;y\n\ni ;z\ni )\n= 2666664\n\n2\n1\n\n0\n2\n\n1\n0\n\n0\n0\n\n7\n5\n\n7\n1\n0\n\n3\n0\n\n0\n0\n\n6\n5\n\n1\n0\n\n9\n2\n\n0\n0\n\n0\n\n0\n0\n\n0\n0\n\n0\n0\n\n0\n0 3777775\n\n4\n?\n8\n\n(C\n.7)\n\nA\ns\nou\ntras\n\nfatias\ncom\n\nx\ni\n>\n\n0\ns\u00e3o\n\nto\nd\nas\n\nn\nu\nlas.\n\nE\nste\n\nresu\nltad\n\no,\nd\ne\nacord\n\no\ncom\n\na\nrefer\u00ean\n\ncia\n\ncitad\na\nacim\n\na\ne\ncom\n\no\np\nrogram\n\na\nd\ne\ncon\n\nvolu\n\u00e7\u00e3o\n\ncon\nven\n\ncion\nal,\n\nest\u00e1\ncorreto.\n\nE\nstes\n\nd\nad\nos\n\ntam\nb\n\u00e9m\n\nforam\nin\nserid\n\nos\nem\n\nou\ntras\n\norien\nta\u00e7\u00f5\n\nes\ne\nto\nd\nos\n\nc\u00e1lcu\nlos\n\nm\nostraram\n\n-se\n\ncorretos.\n\nC\n.2\n.3\n\nT\ne\ns\nt\ne\n3\nD\n\nA\nq\nu\ni\nu\nsam\n\nos\nu\nm\na\ncu\nrva\n\ngau\nssian\n\na\ntrid\n\nim\nen\nsion\n\nal\np\nara\n\ntestar\na\ncap\n\nacid\nad\ne\nd\na\nrotin\n\na\nd\ne\n\ncon\nvolu\n\n\u00e7\u00e3o.\nA\nex\np\nress\u00e3o\n\nu\nsad\n\na\n\u00e9\na\nsegu\n\nin\nte:110\n\n\n\nf (x;y;z) = e?\n(x?4)2+(y?4)2+(z?4)2\n\n10 (C.8)\n\nEsta fun\u00e7\u00e3o foi discretizada para um espa\u00e7o c\u00fabico de 8 ? 8 ? 8 c\u00e9lulas e organizada na\nforma padr\u00e3o dos dados de entrada.\n\nFizemos a convolu\u00e7\u00e3o de f (x;y;z) com ela pr\u00f3pria, isto \u00e9, h = f ? f. O espa\u00e7o usado\n\nfoi de 16 ? 16 ? 16, j\u00e1 considerando o devido padding de zeros.\nA convolu\u00e7\u00e3o feita via FFT apresentou praticamente os mesmos resultados que a convo-\n\nlu\u00e7\u00e3o num\u00e9rica feita atrav\u00e9s de somat\u00f3rios, isto \u00e9, sem usar FFT. Veja as ?guras C.3 e C.4\n\nonde apresentamos as curvas de n\u00edvel de uma fatia do espa\u00e7o 3D.\n\nAqui foi ?xado o plano xi = 7 e as curvas de n\u00edvel representam o valor de h (7;yi;zi).\n\nO pico da curva gaussiana nos dois casos foi igual a 57; 8133. As ?guras C.5 e C.6 nos\n\nd\u00e3o uma vis\u00e3o tridimensional dos mesmos dados apresentados nas ?guras C.3 e C.4. Aqui o\n\neixo das intensidades tem o mesmo signi?cado das curvas de n\u00edvel nos gr\u00e1?cos anteriores.\n\n111\n\n\n\n0 10 15\n0\n\n10\n\n15\n\nEixo Z\n\nE\nix\n\no \nY\n\n5.58\n\n5.58\n\n5.\n58\n\n5.58\n\n5.58\n\n5.\n58\n\n11.2\n\n11.2\n\n11\n.2\n\n11.2\n\n11\n.2\n\n16.7\n\n16\n.7\n\n16.7\n\n16\n.7\n\n22.3\n\n22\n.3\n\n22.3\n\n22\n.3\n\n27.9\n\n27\n.9\n\n27.9\n\n27.9\n\n33.5\n\n33.5\n\n33\n.5\n\n39.1\n\n39.1\n\n39.1\n\n44.\n6\n\n44\n.6\n\n50\n.2\n\nFigura C.3: Curvas de n\u00edvel da convolu\u00e7\u00e3o via FFT de uma gaussiana com ela pr\u00f3pria.\n\n112\n\n\n\n0 10 15\n0\n\n10\n\n15\n\nEixo Z (cm)\n\nE\nix\n\no \nY\n\n (\ncm\n\n)\n\n5.58\n\n5.58\n5.\n\n58\n\n5.58\n\n5.58\n\n5.\n58\n\n11.2\n\n11.2\n11\n\n.2\n\n11.2\n11\n\n.2\n\n16.7\n\n16\n.7\n\n16.7\n16\n\n.7\n\n22.3\n\n22\n.3\n\n22.3\n22\n\n.3\n\n27.9\n27\n\n.9\n\n27.9\n\n27.9\n\n33.5\n\n33.5\n\n33\n.5\n\n39.1\n\n39.1\n\n39.1\n\n44.\n6\n\n44\n.6\n\n50\n.2\n\nFigura C.4: A mesma opera\u00e7\u00e3o \u00e9 mostrada neste gr\u00e1?co, por\u00e9m via somat\u00f3rios.\n\n113\n\n\n\n?1.02e?17\n\n8.37\n\n16.7\n\n25.1\n\n33.5\n\n41.8\n\n50.2\n\nIn\nte\n\nn\nsi\n\nd\nad\n\ne\n\n?1.0\u00d710?17\n\n1.0\u00d7101\n\n2.0\u00d7101\n\n3.0\u00d7101\n\n4.0\u00d7101\n\n5.0\u00d7101\n\n5.6\u00d7101\n\nEixo Y\n\n0\n\n10\n\n15 Eixo\n Z\n\n0\n\n10\n\n15\n\nFigura C.5: Apresenta\u00e7\u00e3o 3D da convolu\u00e7\u00e3o via FFT.\n\n114\n\n\n\n0\n\n8.37\n\n16.7\n\n25.1\n\n33.5\n\n41.8\n\n50.2\n\nIn\nte\n\nn\nsi\n\nd\nad\n\ne\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n55.8\n\nEixo Y\n\n0\n\n10\n\n15\n\nEixo Z\n\n0\n\n10\n15\n\nFigura C.6: Convolu\u00e7\u00e3o convencional de duas gaussianas.\n\n115\n\n\n\n116\n\n\n\nAp\u00eandice D\n\nAltera\u00e7\u00f5es no programa XYZP para\n\na gera\u00e7\u00e3o dos n\u00facleos de convolu\u00e7\u00e3o\n\nCada n\u00facleo de convolu\u00e7\u00e3o foi gerado por um programa diferente. Baseamos-nos em um\n\nprograma contido no pacote do EGS4 chamado XYZP.\n\nO programa XYZP, escrito em Mortran, utiliza as rotinas do EGS4 para simular a in-\n\ntera\u00e7\u00e3o de um feixe de part\u00edculas em um meio material em coordenadas cartesianas [12].\n\nAlteramos este programa com a ?nalidade de ?for\u00e7ar? a posi\u00e7\u00e3o onde deve ocorrer a pri-\n\nmeira intera\u00e7\u00e3o dos f\u00f3tons do feixe prim\u00e1rio e contabilizar corretamente as part\u00edculas que\n\ndepositar\u00e3o as energias para os n\u00facleos de convolu\u00e7\u00e3o.\n\nPrimeiro vamos apresentar como ?zemos com que o f\u00f3ton incidente interagisse sempre\n\nno mesmo ponto. Na seq\u00fc\u00eancia, apresentaremos a forma como controlamos o transporte das\n\npart\u00edculas nos n\u00facleos prim\u00e1rio, secund\u00e1rio e de m\u00faltiplo espalhamento.\n\nD.1 ?For\u00e7ando? a primeira intera\u00e7\u00e3o do feixe\n\nDesejamos interferir na simula\u00e7\u00e3o de maneira tal que todos os f\u00f3tons do feixe tenham a sua\n\nprimeira intera\u00e7\u00e3o num ponto conhecido. A partir deste ponto, a cascata eletromagn\u00e9tica\n\nsegue o seu caminho normal.\n\nUma das maneiras de for\u00e7ar a intera\u00e7\u00e3o de uma part\u00edcula \u00e9 ?viciar? o gerador de n\u00fameros\n\naleat\u00f3rios. Analisando o ?uxograma do EGS4 descobrimos que a fun\u00e7\u00e3o SHOWER, que\n\nlan\u00e7a um f\u00f3ton por vez contra o alvo, chama a subrotina PHOTON para determinar as\n\nintera\u00e7\u00f5es e posi\u00e7\u00f5es onde estas part\u00edculas ir\u00e3o interagir. Nesta subrotina o primeiro n\u00famero\n\nsorteado \u00e9 o ponto onde o f\u00f3ton prim\u00e1rio ir\u00e1 interagir, portanto basta chamar a rotina\n\n117\n\n\n\nSHOWER usando sempre a mesma semente para o gerador de n\u00fameros aleat\u00f3rios. Por\u00e9m\n\ndeveremos restaurar a semente original antes que o gerador seja utilizado novamente, a ?m\n\nde prevenir resultados viciados.\n\nAnalisando cuidadosamente o ?uxograma da subrotina PHOTON descobrimos um desvio\n\ncondicional para a rotina HOWFAR [12]. Esta rotina \u00e9 escrita pelo usu\u00e1rio e ser\u00e1 usada\n\npara retornar a semente original para a simula\u00e7\u00e3o. A condi\u00e7\u00e3o para que haja o desvio da\n\nsubrotina PHOTON para a HOWFAR \u00e9 que entre a posi\u00e7\u00e3o atual do f\u00f3ton e a ?nal deva\n\nhaver pelo menos uma interface, quer seja entre c\u00e9lulas ou entre materiais diferentes.\n\nAssim a altera\u00e7\u00e3o feita no programa ocorreu logo antes da chamada da rotina SHOWER:\n\n...\n\nISEG=0; \"Flag para dizer que houve uma interacao\"\n\nISEM=IXX; \"Guardando a semente em ISEM\"\n\nICOND=1; \"Flag para dizer que a semente IXX foi alterada\"\n\nIXX=13; \"Nova semente. De resultado previamente conhecido\"\n\nIAUSFL(18)=1; \"Flag para acionar o ausgab qdo ocorrer Compton\"\n\nIAUSFL(16)=1; \"Flag para acionar o ausgab qdo ocorrer Prod. Pares\"\n\nIAUSFL(20)=1; \"Flag para acionar o ausgab qdo ocorrer Int. Fotoel.\"\n\nCALL SHOWER (IQIN,ETOTIN,XIN,YIN,ZIN,UIN,VIN,WIN,IRIN,WTIN);\n\n...\n\nCriamos as vari\u00e1veis ISEG, ISEM e ICOND para controlar a gera\u00e7\u00e3o dos n\u00facleos. ISEM\n\narmazena o valor da semente original e ICOND indica para a rotina HOWFAR que a semente\n\natual \u00e9 a ?viciada?. IXX \u00e9 a vari\u00e1vel da semente do gerador de n\u00fameros aleat\u00f3rios do EGS4.\n\nAs outras vari\u00e1veis ser\u00e3o apresentadas na se\u00e7\u00e3o seguinte pois tratam do controle das ordens\n\nde intera\u00e7\u00e3o dos f\u00f3tons. Na \u00faltima linha \u00e9 chamada a rotina SHOWER normalmente.\n\nA rotina HOWFAR recebeu apenas um comando condicional para recuperar a semente\n\noriginal:\n\n...\n\n;IF(ICOND=1)[IXX=ISEM;\n\nICOND=0;\n\n\"OUTPUT IXX; ('IXXnew = ', I12);\" \"Depura\u00e7\u00e3o\"\n\n] \"Se a semente nao e' original, entao recupere-a\"\n\n...\n\n118\n\n\n\nDesta forma conseguimos fazer com que os f\u00f3tons prim\u00e1rios tenham a sua primeira\n\nintera\u00e7\u00e3o controlada, bastando apenas modi?car o ponto inicial do feixe para alterar a\n\nlocaliza\u00e7\u00e3o da primeira intera\u00e7\u00e3o.\n\nD.1.1 Os n\u00facleos de deposi\u00e7\u00e3o de energia\n\nO n\u00facleo prim\u00e1rio deve ser composto pela energia depositada pelas part\u00edculas carregadas\n\nlan\u00e7adas pela primeira intera\u00e7\u00e3o dos f\u00f3tons do feixe com a mat\u00e9ria. Para isso basta des-\n\ncartar os f\u00f3tons ap\u00f3s uma colis\u00e3o Compton e os f\u00f3tons gerados pelas part\u00edculas carregadas\n\n(bremsstrahlung e aniquila\u00e7\u00e3o de pares).\n\nEste controle \u00e9 feito pela vari\u00e1vel ISEG e pelo vetor de sinaliza\u00e7\u00e3o IAUSFL ( ) que\n\naparecem na primeira listagem do c\u00f3digo apresentada neste ap\u00eandice. ISEG indica que\n\nhouve uma intera\u00e7\u00e3o com o feixe de f\u00f3tons. IAUSFL ( ) \u00e9 um conjunto de sinalizadores\n\ninternos ao EGS4 que exige a chamada da rotina AUSGABa quando os eventos indicados\n\nentre par\u00eanteses por este sinalizador ocorrerem.\n\nA rotina AUSGAB (IARG) \u00e9 escrita pelo usu\u00e1rio e nela a energia depositada quando do\n\ntransporte das part\u00edculas carregadas \u00e9 armazenada em matrizes com esta ?nalidade. Usamos\n\nesta rotina para selecionar o armazenamento da energia somente das part\u00edculas carregadas\n\nprim\u00e1rias atrav\u00e9s de seu argumento IARG, que indica o processo pelo qual a rotina AUSGAB\n\nfoi requisitada. Apenas foi necess\u00e1ria a inclus\u00e3o de uma linha de comando nesta rotina:\n\nIF (IARG=15 | IARG=17 | IARG=19) [ISEG=1;]\n\nEsta condi\u00e7\u00e3o muda o valor da vari\u00e1vel ISEG de zero para um quando os argumentos da\n\nrotina AUSGAB indicarem produ\u00e7\u00e3o de pares, Compton ou fotoel\u00e9trico, respectivamente.\n\nISEG indicar\u00e1 \u00e0 rotina HOWFAR, no instante em que for requisitada, que j\u00e1 ocorreu a\n\nprimeira intera\u00e7\u00e3o e que os f\u00f3tons seguintes dever\u00e3o ser descartados. Para tanto adicionamos\n\na seguinte linha de comando na rotina HOWFAR:\n\nIF(ISEG~=0 &amp; IQ(NP)=0) [IDISC=1;RETURN;]\n\nEsta condi\u00e7\u00e3o nos diz que a part\u00edcula indicada pelo \u00edndice NP \u00e9 descartada (IDISC=1) se\n\nela for f\u00f3ton, IQ(NP)=0, e se ISEG for diferente de zero.\n\nOs programas para a gera\u00e7\u00e3o dos n\u00facleos secund\u00e1rio e de m\u00faltiplo espalhamento seguem\n\nna mesma linha de trabalho por\u00e9m necessitam de altera\u00e7\u00f5es mais elaboradas. Tais mudan\u00e7as\n\ncome\u00e7am a depender muito de toda a estrutura complexa do programa XYZP e passam a\n\nn\u00e3o fazer sentido quando apresentadas em partes, por isso n\u00e3o as mostraremos nesta tese.\naDo alem\u00e3o Ausgabe, que signi?ca sa\u00edda; no nosso caso, refere-se \u00e0 sa\u00edda de dados da simula\u00e7\u00e3o.\n\n119\n\n\n\nPara gera\u00e7\u00e3o do n\u00facleo de deposi\u00e7\u00e3o de energia secund\u00e1rio os el\u00e9trons prim\u00e1rios n\u00e3o\n\nforam contabilizados, os f\u00f3tons terci\u00e1rios n\u00e3o foram transportados, nem os f\u00f3tons criados por\n\nbremsstrahlung e aniquila\u00e7\u00e3o de pares. Somente os el\u00e9trons secund\u00e1rios foram devidamente\n\ntransportados e contabilizados.\n\nNa gera\u00e7\u00e3o do n\u00facleo de m\u00faltiplo espalhamento os el\u00e9trons prim\u00e1rios e secund\u00e1rios n\u00e3o\n\nforam computados e as intera\u00e7\u00f5es dos f\u00f3tons e el\u00e9trons que se sucederam \u00e0 terceira colis\u00e3o\n\ndo f\u00f3ton com a mat\u00e9ria seguiram sem nenhuma interfer\u00eancia, inclusive os f\u00f3tons criados por\n\nbremsstrahlung.\n\n120\n\n\n\nAp\u00eandice E\n\nO PEGS\n\nO PEGS \u00e9 o pr\u00e9-processador do EGS4 e dentre as suas v\u00e1rias atribui\u00e7\u00f5es, gera uma arquivo\n\ncom as se\u00e7\u00f5es de choque a serem utilizadas nas simula\u00e7\u00f5es [12].\n\nExecutamos o PEGS apenas uma \u00fanica vez para ajustar os limites inferiores para o\n\ntransporte de part\u00edculas carregadas e f\u00f3tons, respectivamente AE e AP, discutidos na se\u00e7\u00e3o\n\n3.3.1.2. Os valores usados est\u00e3o na tabela 3.1. Este ajuste permite um melhor desempenho\n\ndo EGS4 nas simula\u00e7\u00f5es.\n\nO PEGS tamb\u00e9m permite selecionar o material a ser usado nas simula\u00e7\u00f5es, que no nosso\n\ncaso foi H2O, com densidade de 1g=cm\n3.\n\nA entrada de dados para a execu\u00e7\u00e3o do PEGS \u00e9 mostrada a seguir:\n\nCOMP\n\n&amp;INP NE=2,RHO=1.0,PZ=2,1 &amp;END\n\nH2O\n\nH O\n\nENER\n\n&amp;INP AE=0.561,UE=30.511,AP=0.05,UP=30. &amp;END\n\nPWLF\n\n&amp;INP &amp;END\n\nDECK\n\n&amp;INP &amp;END\n\nCOMP signi?ca que estamos selecionando o composto. Na segunda linha temos o n\u00famero\n\nde elementos NE, a densidade do composto RHO e o n\u00famero relativo PZ dos respectivos\n\nelementos mostrados na quarta linha. Na terceira linha est\u00e1 o nome do composto.\n\nAbaixo da linha ENER est\u00e3o as especi?ca\u00e7\u00f5es de energias cin\u00e9ticas das part\u00edculas dadas\n\nem MeV, onde UE \u00e9 o limite superior de energia das part\u00edculas carregadas e analogamente\n\n121\n\n\n\nUP \u00e9 o dos f\u00f3tons.\n\nPWLF diz para o PEGS usar a interpola\u00e7\u00e3o linear por partes (piecewise linear ?t) para\n\nobter as se\u00e7\u00f5es de choque para a faixa de energia selecionada. N\u00e3o requer mais informa\u00e7\u00f5es\n\nde entrada.\n\nDECK amostra os dados que ser\u00e3o armazenados no arquivo de sa\u00edda. Tamb\u00e9m n\u00e3o\n\nrequer maiores informa\u00e7\u00f5es de entrada.\n\n122\n\n\n\nAp\u00eandice F\n\nO Formato Padr\u00e3o dos Arquivos de\n\nEntrada e Sa\u00edda\n\nOs dados de entrada e sa\u00edda foram gravados em arquivos texto. Este formato \u00e9 muito\n\nimportante pois podemos editar os arquivos de entrada com mais facilidade para criar ou\n\nmodi?car as heterogeneidades manualmente conforme as nossas necessidades. Os dados de\n\nsa\u00edda seguem este mesmo padr\u00e3o, permitindo tamb\u00e9m a f\u00e1cil gera\u00e7\u00e3o de gr\u00e1?cos.\n\nOs arquivos de dados nos lembram uma matriz fatiada, como no exemplo na tabela F.1.\n\nNa primeira linha est\u00e3o as dimens\u00f5es da matriz na forma (L;M;N). L \u00e9 o n\u00famero de\n\nconjuntos separados por uma linha em branco, M \u00e9 o n\u00famero de linhas de cada conjunto e N\n\n\u00e9 o n\u00famero de colunas que cada conjunto possui. Em cada linha, os n\u00fameros s\u00e3o separados\n\nentre si por um espa\u00e7o em branco e possuem no m\u00e1ximo oito d\u00edgitos de informa\u00e7\u00e3oa. Assim\n\nos tipos de dados poss\u00edveis s\u00e3o:\n\n? inteiro com 8 d\u00edgitos: XXXXXXXX\n\n? real com 8 casas decimais: 0.XXXXXXXX\n\n? real com 6 casas decimais e dois d\u00edgitos de expoente: 0.XXXXXXeXX\n\nFisicamente, as dimens\u00f5es dos dados lidos se relacionam com a matriz espacial por (L;M;N) !\n(bx; by; bz), isto \u00e9, as coordenadas (L1;M1;N1) s\u00e3o multiplicadas por uma fator de convers\u00e3o,\nque no nosso caso corresponde a um lado das c\u00e9lulas em que o meio estudado foi discreti-\n\nzado. Assim, a posi\u00e7\u00e3o do dado no arquivo e o respectivo \u00edndice da matriz na mem\u00f3ria do\n\ncomputador identi?cam a sua posi\u00e7\u00e3o f\u00edsica.\naPadr\u00e3o de escrita da linguagem ANSI C/C++\n\n123\n\n\n\n2 8 3\n\n0.00822975 0.0165727 0.0273237\n0.0165727 0.0333733 0.0550232\n0.0273237 0.0550232 0.090718\n0.0368832 0.0742736 0.122456\n0.0407622 0.082085 0.135335\n0.0368832 0.0742736 0.122456\n0.0273237 0.0550232 0.090718\n0.0165727 0.0333733 0.0550232\n\n0.0165727 0.0333733 0.0550232\n0.0333733 0.0672055 0.110803\n0.0550232 0.110803 0.182684\n0.0742736 0.149569 0.246597\n0.082085 0.165299 0.272532\n0.0742736 0.149569 0.246597\n0.0550232 0.110803 0.182684\n0.0333733 0.0672055 0.110803\n\nTabela F.1: Um exemplo de arquivo de dados.\n\nOs espa\u00e7os em branco entre os conjuntos e as quebras de linhas n\u00e3o s\u00e3o obrigat\u00f3rias,\n\nmas tal artif\u00edcio torna a leitura humana dos dados mais f\u00e1cil.\n\nN\u00e3o h\u00e1 limites quanto \u00e0 extens\u00e3o da linha ou tamanho total do arquivo.\n\n124\n\n\n\nAp\u00eandice G\n\nAs m\u00e1quinas usadas nas simula\u00e7\u00f5es e\n\nc\u00e1lculos num\u00e9ricos\n\nAs caracter\u00edsticas mais relevantes das m\u00e1quinas usadas nesta tese est\u00e3o na tabela abaixo.\n\nNome Modelo/Freq. RAM Sistema Operacio-\n\nnal\n\nHD Interface\n\nHAL9000 AMD k6-2/400MHz 88MB GNU/Linux kernel\n\n2.2.13-7mdk\n\nIDE - UDMA 2\n\nThor Alpha 4000/300MHz 1GB OSF1 SCSI\n\nAraguaia Ultra Sparc 5/270MHz 128MB SunOS 5.7 SCSI\n\n125\n\n\n\n126\n\n\n\nRefer\u00eancias Bibliogr\u00e1?cas\n\n[1] John Robert Cunningham and Harold Elfort Johns. The Physics of Radiology. Charles\n\nC. Thomas, 4th edition, 1984.\n\n[2] Frank H. Attix. Introduction to Radiological Physics and Radiation Dosimetry. John\n\nWiley and Sons, 1986.\n\n[3] Arthur Boyer and Ed Mok. A photon dose distribution model employing convolution\n\ncalculations. Medical Physics, 12(2):169?177, Mar/Apr 1985.\n\n[4] Arthur L. Boyer and Edward C. Mok. Calculation of photon dose distributions in an\n\ninhomogeneous medium using convolutions. Medical Physics, 13(4):503?509, Jul/Aug\n\n1986.\n\n[5] Nucletron International B.V. PLATO - Radiotherapy Planning System, 1995.\n\n[6] Yunping Zhu and Arthur Boyer. X-ray dose computations in heterogeneous media using\n\n3-dimensional FFT convolution. Physics in Medicine and Biology, 35(3):351?368, 1990.\n\n[7] J. R. Lamarsh. Introduction to Nuclear Reactor Theory. Addison-Wesley, 1975.\n\n[8] V. Kafarov. Fundamentals of Mass Transfer. Mir Publishers, 1975.\n\n[9] R. D. Evans. X-ray and gamma ray interactions. In E. Tochilin F. H. Attix, W.\n\nC. Roesch, editor, Radiation dosimetry - Fundamentals, volume I, chapter 3. Academic\n\nPress, 2nd edition, 1968.\n\n[10] T. R. Mackie. Applications of the Monte Carlo methods in radiotherapy. In The\n\nDosimetry of Ionizing Radiation, volume III. K. R. Kase, B. E. Bjarngard, F. H. Attix,\n\n1990.\n\n[11] J. W. Scrimger T. R. Mackie and J. J. Battista. A convolution method of calculating\n\ndose for 15-MV x rays. Med. Phys., 12(2):188?196, Mar/Apr 1985.\n\n127\n\n\n\n[12] Hideo Hirayama, Walter R. Nelson and David W. O. Rogers. The EGS4 Code System.\n\nStanford Linear Accelerator Center, Stanford University, Stanford, California 94305,\n\nDecember 1985. SLAC-265.\n\n[13] D. W. O. Rogers and A. F. Bielajew. Techniques of electron and photon transport,\n\nvolume III, chapter 5. K. R. Kase, B. E. Bjarngard, F. H. Attix, 1990.\n\n[14] Proc. 8th Int. Conf. on Computers in Radiotherapy (Toronto), 1984.\n\n[15] T. R. Mackie and A. F. Bielajew. Generation of photon energy deposition kernels using\n\nEGS Monte Carlo code. Physics in Medicine and Biology, 33(1):1?20, 1988.\n\n[16] CRC - Handbook of Chemistry and Physics, 1989-1990.\n\n[17] D. W. O. Rogers A. F. Bielajew and A. E. Nahum. The Monte Carlo simulation of ion\n\nchamber response to cobalt - resolution of anomalies associated with interfaces. Physics\n\nin Medicine and Biology, (30):419?27, 1985.\n\n[18] CGR/GE Medical Systems. Manual ALCYON IIi, 1984.\n\n[19] Arthur L. Boyer. Shortening the calculation time of photon dose distributions in an\n\ninhomogeneous medium. Medical Physics, 11(4):552?554, Jul/Aug 1984.\n\n[20] E. Oran Brigham. The Fast Fourier Transform and its Applications. Signal Processing\n\nSeries. Prentice Hall, 1988.\n\n[21] Eugene Butkov. Fisica Matematica. Guanabara Koogan, 1988.\n\n[22] Numerical Recipes in Fortran 77: The art of scienti?c computing. Cambridge University\n\nPress, 1992.\n\n[23] Radiation Quantities and Units. Technical Report 33, International Commision on\n\nRadiation Units and Measurement - ICRU, April 1980.\n\n[24] P. J. Plauger. A biblioteca Standard C. Campus, 1994.\n\n[25] Mark G. Sobell. A Practical Guide to Linux. Addison-Wesley, 1997.\n\n[26] M. Frigo and S. G. Johnson. FFTW - Fastest Fourier Transform in the West (User's\n\nManual). http://www.?tw.org.\n\n128"}]}}}