{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.10920"}, {"@name": "filename", "#text": "16123_346007.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE FEDERAL DE SANTA CATARINA\nDEPARTAMENTO DE AUTOMAC?A?O E SISTEMAS\n\nBryant Bruce Picon Yang\n\nCONTRIBUIC?O?ES AOS ALGORITMOS PNMPC E DMC\nCOM PASSO DE ESTABILIDADE\n\nFloriano?polis\n\n2016\n\n\n\nBryant Bruce Picon Yang\n\nCONTRIBUIC?O?ES AOS ALGORITMOS PNMPC E DMC\nCOM PASSO DE ESTABILIDADE\n\nDissertac?a?o de mestrado submetida ao\nPrograma de Po?s-Graduac?a?o em En-\ngenharia de Automac?a?o e Sistemas para\na obtenc?a?o do Grau de Mestre em en-\ngenharia de Automac?a?o e Sistemas.\nPGEAS-UFSC: Prof. Dr. Agustinho\nPlucenio\n\nFloriano?polis\n\n2016\n\n\n\nFicha de identifica\u00e7\u00e3o da obra elaborada pelo autor, \natrav\u00e9s do Programa de Gera\u00e7\u00e3o Autom\u00e1tica da Biblioteca Universit\u00e1ria da UFSC. \n\nYang, Bryant Bruce \nCONTRIBUI\u00c7\u00d5ES AOS ALGORITMOS PNMPC E DMC COM PASSO DE \n\nESTABILIDADE / Bryant Bruce Yang ; orientador, Agustinho \nPlucenio - Florian\u00f3polis, se, 2016. \n\n146 p. \n\nDisserta\u00e7\u00e3o {mestrado) - Universidade Federal de Santa \nCatarina, Centro Tecnol\u00f3gico. Programa de P\u00f3s-Gradua\u00e7\u00e3o em \nEngenharia de Automa\u00e7\u00e3o e Sistemas. \n\nInclui refer\u00eancias \n\n1. Engenharia de Automa\u00e7\u00e3o e Sistemas. 2. Controle \nPreditivo. 3. Controle N\u00e3o Linear. 4. PNMPC. 5. MPC com \nPasso de Estabilidade. I. Plucenio, Agustinho. II. \nUniversidade Federal de Santa Catarina. Programa de P\u00f3s \nGradua\u00e7\u00e3o em Engenharia de Automa\u00e7\u00e3o e Sistemas. III. T\u00edtulo. \n\n\n\nBryant Bruce Picon Yang \n\nCONTRIBUI\u00c7\u00d5ES AOS ALGORITMOS PNMPC E DMC COM PASSO \nDE ESTABILIDADE \n\nEsta Disserta\u00e7\u00e3o foi julgada adequada para a obten\u00e7\u00e3o do T\u00edtulo de \n\"mestre em Engenharia de Automa\u00e7\u00e3o e Sistemas\", e aprovada em \nsua forma final pelo Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de \nAutoma\u00e7\u00e3o e Sistemas .. \n\nBanca \n\nProf. Daniel Ferreira Coutinho, Dr. \nCoordenador do Curso ozsc ~ \n\nProf. Dr. Hector Bessa Silveira \nDAS-UFSC \n\n\n\nEste trabalho e? dedicado a? minha fam??lia\ne a meus queridos pais e em especial a\nMimi.\n\n\n\n\n\nAGRADECIMENTOS\n\nPrimeiramente, a Deus por ter me dado sau?de e forc?a para su-\nperar as dificuldades.\n\nAos membros da banca, pelas valiosas contribuic?o?es a este tra-\nbalho.\n\nAo meu orientador, Prof. Agustinho Plucenio que considero um\nexcelente professor e orientador e, acima de tudo, um grande amigo,\nsempre auxiliando de uma forma bastante criativa nas inconta?veis du?vidas\nque surgiram durante a realizac?a?o deste trabalho.\n\nAgradec?o tambe?m ao Prof. Julio Normey pelos seus ensinamen-\ntos e por me dar a oportunidade e abrir as portas ao programa PRH-34\nno curso de mestrado.\n\nAgradec?o, de corac?a?o, a? toda minha fam??lia. Em especial, aos\nmeus pais Ricardo e Shao Hwa, e meus irma?os Hans e Estiffany, pelo\namor, incentivo e apoio incondicional.\n\nA?s meus amigos Josue, Patty, Alita e Irma, Henrique Farina,\nMo?nica Dias, Mirna, Pablo, Eleonor e Andrew que sempre me incenti-\nvaram e me deram carinho para continuar seguindo em frente na cons-\ntante busca pelo conhecimento.\n\nA? Carolina Vettorazo, pelas dicas e pela forc?a nesses momentos\nde tensa?o.\n\nUm agradecimento especial ao meu amigo Fabr??cio Saggin, que\nsempre esta? disposto a ajudar em tudo momento, pela revisa?o e con-\ntribuic?o?es aos cap??tulos deste trabalho.\n\nA meu amigo que considero quase um irma?o Leandro Morita e\nEduarda, muito grato pelo apoio e pela amizade ao longo deste tempo.\n\nA meus parces da Colo?mbia, Sergio, Deinis, Dayron, Andrea e\nCamilo, obrigado pela amizade.\n\nA? Miriam, minha amada, presente sempre no meu lado. Agradec?o\npelas palavras de forc?a e pelos bons momentos que sempre passamos\njuntos.\n\nFinalmente, gostaria de agradecer a? UFSC-DAS pelo ensino de\nqualidade, ao PRH-34, ANP, sem os quais essa dissertac?a?o dificilmente\npoderia ter sido realizada. E a todos mais que eu na?o tenha citado\nnesta lista de agradecimentos, mas que de uma forma ou de outra con-\ntribu??ram na?o apenas para a minha dissertac?a?o, mas tambe?m para eu\nser quem eu sou.\n\n\n\n\n\nEu tentei 99 vezes e falhei, mas na cente?sima\ntentativa eu consegui, nunca desista de\nseus objetivos mesmo que esses parec?am\nimposs??veis, a pro?xima tentativa pode ser\na vitoriosa.\n\n(Albert Einstein)\n\n\n\n\n\nRESUMO\n\nNeste trabalho sa?o abordados estudos de controle preditivo linear e na?o\nlinear. Grande parte dos processos existentes na indu?strias de petro?leo\ne ga?s utilizam controladores preditivos. A crescente utilizac?a?o dessas\nestrate?gias pode ser atribu??da ao fato de elas facilitarem a declarac?a?o\nde problemas de controle relativamente complexos, como os casos de\ncontrole de processos multivaria?veis, processos integradores, processos\ninsta?veis, processos na?o lineares e processos com atraso de transporte.\nA abordagem destes estudos e? muito interessante para aplicac?o?es indus-\ntriais em geral, onde a maioria dos processos dina?micos exibem relac?o?es\nna?o lineares entre varia?veis controladas e manipuladas. Dependendo\nda aplicac?a?o, o algoritmo MPC e? muitas vezes escolhido entre um tipo\nlinear ou na?o linear. Entre as fam??lias dos MPC lineares e na?o line-\nares escolhidos neste trabalho se tem o algoritmo DMC-Recursivo, e\no MPC Pra?tico para sistemas na?o lineares PNMPC, que tem apresen-\ntando bons resultados tanto no entorno acade?mico quanto no entorno\nindustrial. O presente trabalho encontra-se dividido em duas partes.\nNa primeira parte sa?o apresentadas diversos me?todos de implementac?a?o\npara o algoritmo PNMPC, com o objetivo principal de medir o tempo\nde execuc?a?o dos algoritmos implementados para um estudo de caso.\nEsta ana?lise mostra que o algoritmo PNMPC pode ser adequadamente\naplicado para tratar as na?o-linearidades em diferentes n??veis. O desem-\npenho e o custo computacional de seis implementac?o?es diferentes para\neste controlador sa?o exibidos. Os ensaios de simulac?a?o da estrate?gia\nde controle em malha fechada de cada um dos controladores sa?o com-\nparados e analisados pela resposta do sistema, o tempo de execuc?a?o\ndo algoritmo e pelo ??ndice de desempenho obtido pelos mesmos, sob\nperturbac?o?es externas e incertezas parame?tricas. Na segunda parte,i\napresenta-se uma abordagem que e? orientada ao controle de plantas\nmonovaria?veis e multivaria?veis, com mu?ltiplas incertezas no modelo\nincluindo: no ganho, nas constantes de tempo e nos atrasos de trans-\nporte, que representam todos os casos poss??veis presentes nos processos\nindustriais. Neste caso, e? implementado o algoritmo MPC com passo\nde estabilidade, no qual a ac?a?o de controle e? calculada em duas etapas,\ngarantindo a estabilidade da planta devido a? robustez do controlador,\nprovocando uma melhoria na velocidade da rejeic?a?o das perturbac?o?es\nna?o modeladas. Os ensaios de simulac?a?o sa?o comparados com o con-\ntrolador DMC-Recursivo aplicando a filtragem no erro de predic?a?o.\n\n\n\nPalavras-chave: Controle preditivo; Controle na?o-linear; PNMPC;\nCusto computacional; MPC com passo de estabilidade; Tanque co?nico;\nReator qu??mico.\n\n\n\nABSTRACT\n\nTechniques of linear and non-linear predictive control are approached\nin this document. Much of the existing processes in the oil and gas\nindustries use predictive controllers. The increasing use of these stra-\ntegies can be attributed to the fact that they facilitate the declaration\nof relatively complex control problems, such as cases like multivariable\nprocesses control, integrative processes, unstable processes, non -linear\nprocesses and processes with time delays. The approaches of these\ntechniques are very interesting for industrial applications in general\nbecause the process in the industry has a non-linear dynamic between\nthe controlled and the manipulated variables. Depending on the appli-\ncation, the MPC algorithm is often chosen from a linear or non-linear\ntype. Among linear and non-linear MPC families chosen in this docu-\nment has the Recursive DMC algorithm and Practical Non-linear MPC\n(PNMPC), which has shown good results in the academic and in the\nindustrial environment. This document is divided into two parts. In\nthe first part, several PNMPC algorithm implementation methods are\npresented, with the main objective of measuring the execution time\nof each algorithm implemented in a case study. This review shows\nthat the PNMPC algorithm can be applied to treat different levels of\nnonlinearities. The performance and computational cost of six diffe-\nrent implementations for this controller are shown. Simulation tests\nin the closed-loop control strategy with each controller are compared\nand analyzed by the system response, the execution time of the algo-\nrithm and by the performance index obtained by them under external\ndisturbances and parametric uncertainties. The second part presents\nan approach that is oriented to the control of mono variables and mul-\ntivariables plants with multiple uncertainties in the model, including:\ngains, time constants and time delays, which represent all possible cases\nin industrial processes. The implemented MPC algorithm with stability\nstep, in which the control action is calculated in two steps guaranteeing\nthe stability of the plant due to the robustness of the controller indu-\ncing an improvement in the speed of the rejection of the disturbances\nnot modeled. Simulation tests are compared with the Recursive DMC\ncontroller applying the filtering in the prediction error.\n\nKeywords: Predictive control. Non-linear control. PNMPC. Com-\nputational cost. MPC with stability step. Conical tank. Chemical\nreactor.\n\n\n\n\n\nLISTA DE FIGURAS\n\nFigura 1 Estrutura do MPC.. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36\n\nFigura 2 Resposta livre e resposta forc?ada. . . . . . . . . . . . . . . . . . . . . . 37\n\nFigura 3 Trajeto?ria da refere?ncia. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39\n\nFigura 4 Resposta au degrau. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42\n\nFigura 5 Diagrama de Blocos para o Tratamento do Erro de\nPredic?a?o PNMPC. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56\n\nFigura 6 Interpretac?a?o gra?fica GP NMP C calculada em dois pas-\nsos. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61\n\nFigura 7 Fluxograma do algoritmo PNMPC da primeira versa?o. 62\n\nFigura 8 Interpretac?a?o gra?fica GP NMP C calculada em um u?nico\npasso. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63\n\nFigura 9 Fluxograma do algoritmo PNMPC da segunda versa?o. 64\n\nFigura 10 Faixa de erro de predic?a?o admiss??vel. . . . . . . . . . . . . . . . . . 69\n\nFigura 11 Tanque co?nico. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70\n\nFigura 12 Simulac?a?o da primeira versa?o do PNMPC. . . . . . . . . . . . . 75\n\nFigura 13 Simulac?a?o da segunda versa?o do PNMPC. . . . . . . . . . . . . 77\n\nFigura 14 Matriz GP NMP C da iterac?a?o 25. . . . . . . . . . . . . . . . . . . . . . 79\n\nFigura 15 Matriz GP NMP C invariante no tempo. . . . . . . . . . . . . . . . 80\n\nFigura 16 Simulac?a?o da terceira versa?o do PNMPC. . . . . . . . . . . . . . 81\n\nFigura 17 Simulac?a?o da quarta versa?o do PNMPC. . . . . . . . . . . . . . 83\n\nFigura 18 Simulac?a?o da quinta versa?o do PNMPC. . . . . . . . . . . . . . . 85\n\nFigura 19 Simulac?a?o da sexta versa?o do PNMPC. . . . . . . . . . . . . . . . 87\n\nFigura 20 Comparac?o?es das verso?es do PNMPC: sa??das, ac?o?es de\ncontrole, perturbac?o?es e sinais dos erros. . . . . . . . . . . . . . . . . . . . . . . . . 89\n\nFigura 21 Preditor de Smith Filtrado. . . . . . . . . . . . . . . . . . . . . . . . . . . . 94\n\nFigura 22 Formas de implementar o vetor EL. . . . . . . . . . . . . . . . . . . 98\n\nFigura 23 Esquema do tanque de aquecimento de a?gua. . . . . . . . . . 104\n\nFigura 24 Simulac?a?o do sistema sem atraso e sem incertezas no\nmodelo. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105\n\nFigura 25 Simulac?a?o do sistema com atraso e sem incertezas no\nmodelo. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105\n\nFigura 26 Sa??das preditas com o atraso e sem o atraso. . . . . . . . . . . 106\n\nFigura 27 Diferenc?a entre as sa??das predita com o atraso e sem o\n\n\n\natraso. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106\n\nFigura 28 DMC-Recursivo com filtro no erro de predic?a?o apli-\ncando uma incerteza de 6 min (dn =30).. . . . . . . . . . . . . . . . . . . . . . . . . 107\n\nFigura 29 DMC-Recursivo com passo de estabilidade aplicando\numa incerteza de 6 min (dn =30). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108\n\nFigura 30 Fatores de correc?a?o do DMC-Recursivo com passo de\nestabilidade, DMC-Recursivo com filtro no erro de predic?a?o e dif.109\n\nFigura 31 Esquema do Reator de tanque agitado. . . . . . . . . . . . . . . . 111\n\nFigura 32 Resposta ao degrau das func?o?es de transfere?ncia. . . . . . 113\n\nFigura 33 Incertezas inceridas no atraso de transporte e no ganho.114\n\nFigura 34 Resultados de simulac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115\n\nFigura 35 Comparac?a?o dos erros Ef frente a EL . . . . . . . . . . . . . . . . 116\n\nFigura 36 Resultados de simulac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117\n\nFigura 37 Resultados de simulac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117\n\nFigura 38 Resultados de simulac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117\n\nFigura 39 Resultados de simulac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118\n\n\n\nLISTA DE TABELAS\n\nTabela 1 Para?metros do tanque co?nico. . . . . . . . . . . . . . . . . . . . . . . . . 71\n\nTabela 2 Para?metros de sintonia do controlador PNMPC . . . . . . 73\n\nTabela 3 Tempo de execuc?a?o do algoritmo para a primeira versa?o\ndo PNMPC. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76\n\nTabela 4 Tempo de execuc?a?o do algoritmo para a segunda versa?o\ndo PNMPC. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78\n\nTabela 5 Tempo de execuc?a?o do algoritmo para a terceira versa?o\ndo PNMPC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82\n\nTabela 6 Tempo de execuc?a?o do algoritmo para a quarta versa?o\ndo PNMPC. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84\n\nTabela 7 Tempo de execuc?a?o do algoritmo para a quinta versa?o\ndo PNMPC. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86\n\nTabela 8 Tempo de execuc?a?o do algoritmo para a sexta versa?o\ndo PNMPC. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88\n\nTabela 9 Tabela comparativa dos tempos de execuc?a?o para re-\nfere?ncias superiores a 1 m. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90\n\nTabela 10 Tabela comparativa dos tempos de execuc?a?o para re-\nfere?ncias inferiores a 1 m. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90\n\nTabela 11 I?ndices de desempenho do controlador das seis verso?es\ndo PNMPC para refere?ncias superiores a 1 m. . . . . . . . . . . . . . . . . . . . 91\n\nTabela 12 Para?metros de sintonia do controlador DMC recursivo\ncom filtragem no erro de predic?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110\n\nTabela 13 Para?metros de sintonia do controlador DMC-Recursivo\ncom passo de estabilidade. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111\n\nTabela 14 I?ndice de desempenho do controlador. . . . . . . . . . . . . . . . . 118\n\n\n\n\n\nLISTA DE ABREVIATURAS E SIGLAS\n\nMPC Controle Preditivo Baseado em Modelo (do ingle?s, Model\nBased Predictive Control ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25\n\nDMC Matriz Dina?mica de Controle (do ingle?s, Dynamical Ma-\ntrix Control ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25\n\nGPC Controle Preditivo Generalizado (do ingle?s, Generalized\nPredictive Control ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25\n\nNMPC Modelo de Controle Preditivo Na?o Linear (do ingle?s, Non-\nlinear Model Predictive Control ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26\n\nPNMPC Modelo de Controle Preditivo Pra?tico para sistemas Na?o\nLineares (do ingle?s, Non-linear Model Predictive Control ) . . . 27\n\nARIMA Modelo Auto-Regressivo integrado e de Me?dia Mo?vel Inte-\ngrada (do ingle?s, Auto-Regressive and Integrated Moving Ave-\nrage) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35\n\nSISO Uma Entrada e Uma Sa??da (do ingle?s, Single-Input Single-\nOutput ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45\n\nMIMO Mu?ltiplas Entradas e Mu?ltiplas Sa??das (do ingle?s, Multiple-\nInput Multiple-Output ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45\n\nQP Programac?a?o Quadra?tica (do ingle?s, Quadratic Program-\nming ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57\n\nMSE Erro Quadra?tico Me?dio (do ingle?s, Mean Squared Error ) 90\n\nIAE Integral do Erro Absoluto (do ingle?s, Integral of the Abso-\nlute Magnitude of the Error ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90\n\n\n\n\n\nLISTA DE SI?MBOLOS\n\ngi Coeficiente da resposta ao degrau . . . . . . . . . . . . . . . . . . . . . . . 33\n\n?u Vetor da variac?a?o de controle . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33\n\np Horizonte de predic?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33\n\nA(z?1) Denominador da func?a?o de tranfere?ncia . . . . . . . . . . . . . . . . . 34\n\nB(z?1) Numerador da func?a?o de tranfere?ncia . . . . . . . . . . . . . . . . . . . . 34\n\ny(t) Sa??da do processo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34\n\nu(t) Sinal do controle . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34\n\ny?(t + k) Sa??da predida . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34\n\nJ Func?a?o custo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37\n\nd Tempo morto ou atraso de transporte . . . . . . . . . . . . . . . . . . . 37\n\nmh Horizonte de controle . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38\n\n? Ponderac?a?o no seguimento de refere?ncia . . . . . . . . . . . . . . . . . 38\n\n? Ponderac?a?o no controle . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38\n\nw(t + k) Trajeto?ria das refere?ncias futuras . . . . . . . . . . . . . . . . . . . . . . . . 38\n\n? Filtro de refere?ncia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38\n\nG Matriz dina?mica do sistema . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42\n\nf Vetor da resposta livre do sistema . . . . . . . . . . . . . . . . . . . . . . . 42\n\nN Horizonte de modelo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43\n\ne(t) Erro de predic?a?o ou erro verdadeiro . . . . . . . . . . . . . . . . . . . . . 45\n\nGP NMP CMatriz dina?mica ou matriz Jacobiana . . . . . . . . . . . . . . . . . . . 49\n\nTI Matriz Toeplitz integradora . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60\n\nQin Vaza?o de entrada . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70\n\nQo Vaza?o de sa??da . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70\n\nR raio ma?ximo do tanque co?nico . . . . . . . . . . . . . . . . . . . . . . . . . . . 70\n\nr raio interno (varia?vel) do tanque co?nico . . . . . . . . . . . . . . . . . 70\n\nH Altura ma?xima do tanque co?nico . . . . . . . . . . . . . . . . . . . . . . . . 70\n\nh Altura interna (varia?vel) do tanque co?nico . . . . . . . . . . . . . . . 70\n\nCv Coeficiente da capacidade do fluxo da va?lvula de sa??da . . 70\n\n? Variac?a?o de controle . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73\n\nEf Vetor do erro de predic?a?o filtrado . . . . . . . . . . . . . . . . . . . . . . . 95\n\nEL Vetor do erro passo de estabilidade . . . . . . . . . . . . . . . . . . . . . . 97\n\n? Filtro no erro de predic?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110\n\n\n\n\n\nSUMA?RIO\n\n1 INTRODUC?A?O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25\n\n1.1 OBJETIVOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28\n\n1.1.1 Objetivos gerais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28\n\n1.1.2 Objetivos espec??ficos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28\n\n1.2 CONTRIBUIC?A?O CIENTI?FICA . . . . . . . . . . . . . . . . . . . . . . 29\n\n1.3 ORGANIZAC?A?O DO TRABALHO . . . . . . . . . . . . . . . . . . . 29\n\n2 CONTROLE PREDITIVO BASEADO EM MO-\nDELO MPC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31\n\n2.1 CONCEITOS BA?SICOS DO MPC . . . . . . . . . . . . . . . . . . . . 32\n\n2.1.1 Resposta livre e forc?ada . . . . . . . . . . . . . . . . . . . . . . . . . . . 36\n\n2.1.2 Func?a?o objetivo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37\n\n2.1.3 Trajeto?ria das refere?ncias . . . . . . . . . . . . . . . . . . . . . . . . . 38\n\n2.1.4 Restric?o?es . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38\n\n2.1.5 Obtenc?a?o da Lei de Controle . . . . . . . . . . . . . . . . . . . . . . 39\n\n2.2 ALGORITMO MPC UTILIZADO NA INDU?STRIA . . . . 40\n\n2.2.1 Controle por Matriz Dina?mica-DMC . . . . . . . . . . . . . . 40\n\n2.2.2 DMC Original . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40\n\n2.2.3 DMC-Recursivo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43\n\n2.3 CONCLUSA?O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45\n\n3 MPC PRA?TICO PARA SISTEMAS NA?O LINE-\nARES - PNMPC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47\n\n3.1 OBTENC?A?O NUME?RICA DAS PREDIC?O?ES . . . . . . . . . . 54\n\n3.2 TRATAMENTO DO ERRO DE PREDIC?A?O E PERTUR-\nBAC?A?O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55\n\n3.3 FUNC?A?O CUSTO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57\n\n3.4 CONCLUSA?O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58\n\n4 IMPLEMENTAC?A?O DO PNMPC: ALTERNA-\nTIVAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59\n\n4.1 VERSO?ES DA TE?CNICA MPC PRA?TICO PARA SIS-\nTEMAS NA?O LINEARES (PNMPC) . . . . . . . . . . . . . . . . . . 59\n\n4.1.1 Primeira versa?o: PNMPC original completo com\ncalculo de ?uini. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60\n\n4.1.2 Segunda versa?o: PNMPC sem o ca?lculo de ?uini. 63\n\n4.1.3 Terceira versa?o: PNMPC obtendo so? a primeira\ncoluna da matriz GP NMP C. . . . . . . . . . . . . . . . . . . . . . . . 65\n\n\n\n4.1.4 Quarta versa?o: PNMPC obtendo so? a primeira\ncoluna da matriz GP NMP C recalculada de tempos\nem tempos. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66\n\n4.1.5 Quinta versa?o: PNMPC calculando a resposta li-\nvre de tempos em tempos, utilizando o DMC-\nRecursivo. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67\n\n4.1.6 Sexta versa?o: PNMPC com reavaliac?a?o da matriz\nGP NMP C e a resposta livre (DMC-Recursivo), con-\nforme o erro de predic?a?o. . . . . . . . . . . . . . . . . . . . . . . . . . 69\n\n4.2 ESTUDO DE CASO: TANQUE CO?NICO . . . . . . . . . . . . . 69\n4.3 RESULTADOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72\n4.3.1 Primeira versa?o: PNMPC original completo com\n\n?uini . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74\n4.3.2 Segunda versa?o: PNMPC sem o ca?lculo de ?uini . 76\n4.3.3 Terceira versa?o: PNMPC obtendo so? a primeira\n\ncoluna da matriz GP NMP C. . . . . . . . . . . . . . . . . . . . . . . . 78\n4.3.4 Quarta versa?o: PNMPC obtendo so? a primeira\n\ncoluna da matriz GP NMP C recalculada de tempos\nem tempos. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82\n\n4.3.5 Quinta versa?o: PNMPC calculando a resposta li-\nvre de tempos em tempos, utilizando o DMC-\nRecursivo. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84\n\n4.3.6 Sexta versa?o: PNMPC com reavaliac?a?o da matriz\nGP NMP C e a resposta livre (DMC-Recursivo), con-\nforme o erro de predic?a?o. . . . . . . . . . . . . . . . . . . . . . . . . . 86\n\n4.4 CONCLUSA?O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88\n5 CONTROLE PREDITIVO BASEADO EM MO-\n\nDELO COM PASSO DE ESTABILIDADE . . . . . . . 93\n5.1 PASSO DE ESTABILIDADE PARA COMPENSAC?A?O\n\nDE ERROS NO MODELO DE PREDIC?A?O . . . . . . . . . . . . 97\n5.2 ESTUDO DE CASO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110\n5.3 CONCLUSO?ES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118\n6 CONSIDERAC?O?ES FINAIS . . . . . . . . . . . . . . . . . . . . 121\n\nREFERE?NCIAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125\nAPE?NDICE A -- Ape?ndice . . . . . . . . . . . . . . . . . . . . . . 131\n\n\n\n25\n\nCap??tulo 1\n\nINTRODUC?A?O\n\nO Controle preditivo baseado em modelo (Model Predictive Con-\ntrol, MPC ou MBPC) e? um conjunto de me?todos de controle que foram\ndesenvolvidos considerando um modelo capaz de representar a dina?mica\ndo processo, para predizer e obter uma ac?a?o de controle futura que\nminimize uma func?a?o objetivo. No entanto, o MPC calcula a lei de\ncontrole em cada interac?a?o com ajuda de um algoritmo de otimizac?a?o\non-line, sendo o modelo o elemento mais importante dentro dos con-\ntroladores preditivos. Algumas estrate?gias de controle mais avanc?ados\npodem falhar se o modelo na?o for o adequado (CAMACHO; BORDONS,\n1995; MACIEJOWSKI, 2002).\n\nO MPC e? uma das poucas estrate?gias que permite o controle dos\nsistemas com restric?o?es com um crite?rio o?timo, garantindo a estabili-\ndade e converge?ncia para o ponto de equil??brio (MAYNE, 2001).\n\nA maioria dos processos petroqu??micos utilizam controladores\npreditivos. De fato, o MPC nasceu dentro das indu?strias petroqu??micas\nna de?cada dos 70. Atualmente sua aplicac?a?o vem sendo cada vez mais\ndifundida em outros setores (BORDONS, 2000; MORARI; LEE, 1999).\n\nAs estrate?gias mais utilizadas e conhecidas no meio acade?mico e\nno meio industrial sa?o: o DMC (Dynamical Matrix Control ), apresen-\ntado em Cutler e Remarker (1980); e o GPC (Generalized Predictive\nControl ), apresentado em Clarke e Mohtadi (1987a), aplicados ao con-\ntrole preditivo de processos lineares (CAMACHO; BORDONS, 2007). No\nentanto, como nem todos os processos sa?o lineares, na pra?tica se faz a\nlinearizac?a?o do modelo do processo em torno de pontos de operac?a?o.\nQuando os modelos lineares na?o sa?o suficientemente precisos para repre-\nsentar as na?o-linearidades do processo real, va?rias abordagens podem\nser utilizadas (FINDEISEN; ALLGOWER, 2002; MORARI; LEE, 1999).\n\n\n\n26\n\nExistem dois comportamentos comumente encontrados nos pro-\ncessos industriais: um de eles e? a na?o linearidade nos processos e a\noutra sa?o os atrasos de transporte. Os modelos na?o lineares sa?o geral-\nmente usados para descrever a dina?mica do processo quando os mode-\nlos lineares na?o geram bons resultados (CAMACHO; BORDONS, 1995).\nExistem diversas te?cnicas empregados para determinar o modelo de\npredic?a?o, como ser: modelos fenomenolo?gicos (POMAR; NORMEY; CAM-\nPONOGARA, 2005), modelos utilizando redes neurais (TANG; KEYSER,\n1994), modelos emp??ricos (NELLES, 2001) ou com lo?gica nebulosa (SKR-\nJANC; MATKO, 1994).\n\nO controle preditivo na?o linear baseado em modelo (Non-linear\nModel Predictive Control, NMPC) e? uma estrate?gia de controle relati-\nvamente nova que vem apresentando bons resultados, pelo que se torna\numa alternativa para contornar processos reais (NORMEY; LIMA; SAN-\nTOS, 2015).\n\nA aplicac?a?o de MPCs lineares nos processos que apresentam na?o\nlinearidades fortes na sua dina?mica podem na?o trazer bons resultados,\npara isso, uma opc?a?o e? a aplicac?a?o de controladores na?o lineares. A\nprincipal vantagem da aplicac?a?o do NMPC e? o fato que este considera\na dina?mica na?o linear do processo. Por outro lado, a maior desvanta-\ngem esta? na obtenc?a?o de um bom modelo na?o linear a partir de dados\nexperimentais e no custo computacional que representa o ca?lculo da\nac?a?o de controle. Num trabalho recente, Lucia, Rumschinski e Krener\n(2015) propo?e te?cnicas de MPCs na?o lineares baseada em otimizac?a?o\nmin-max, sugerindo uma forma de diminuir o custo computacional.\n\nCom o decorrer do tempo, diversas alternativas abordam pro-\nblemas para contornar e controlar sistemas na?o lineares utilizando a\nestrate?gia MPC, entre elas esta?o: os modelos lineares dina?micos e\nna?o lineares esta?ticos, modelos locais (aproximac?a?o no ponto de tra-\nbalho) e modelos combinados linear na?o-linear para predic?o?es (PLUCE-\nNIO, 2010). Evidentemente, as vantagens de uma ou outra alternativa\nesta?o diretamente relacionadas ao compromisso, desempenho e custo\ncomputacional do controlador (CANNON, 2004).\n\nEntre os modelos lineares dina?micos e na?o lineares esta?ticos sa?o\nencontrados os trabalhos (GRUBER; BORDONS, 2007; BLOEMEN; BOOM;\nVERBRUGGEN, 2000; SANTOS, 2005), que utilizam se?ries de Volterra ou\nmodelos de Hammerstein para MPCs na?o lineares.\n\nEm Bravo e Normey (2009), apresenta-se uma abordagem para\nmodelos locais (aproximac?a?o no ponto de trabalho), o que equivale a\num MPC linear adaptativo.\n\nFinalmente, para os modelos combinados que possuem parte da\n\n\n\n27\n\npredic?a?o linear e a outra parte na?o-linear, podem-se citar algumas es-\ntrate?gias encontradas na literatura, como o algoritmo NEPSAC (Non-\nlinear Extended Predictive Self Adaptive Control ), desenvolvido por\nKeyser (2007), e o algoritmo MPC Pra?tico para Sistemas Na?o Line-\nares PNMPC (Practical Non-linear Predictive Control ), desenvolvido\npor Plucenio (2010).\n\nDentre as te?cnicas de controle preditivo que tratam processos na?o\nlinear, tem-se a te?cnica PNMPC vem apresentando bom desempenho\ne vasta possibilidade de aplicac?o?es ao longo deste tempo (ANDRADE\net al., 2012; CASTILLA et al., 2014; THOME, 2013). No entanto, estas\nestrate?gias podem demandar um alto desempenho e sobretudo um ele-\nvado custo computacional, mesmo assim fornecendo grandes vantagens\nquanto comparados com as estrate?gias dos MPCs lineares.\n\nPor outro lado, como ja? foi mencionado, um outro feno?meno co-\nmum dos processos industriais, principalmente nos processos da indu?stria\nde petro?leo e ga?s, e? o atraso de transporte. Na pra?tica, tem-se muitos\nprocessos industriais onde o atraso e? causado pelo transporte de mate-\nrial, energias ou pelo acu?mulo de informac?a?o no sistema. Nesse caso,\no sistema na?o responde imediatamente. Ele leva algum tempo para\nexibir em sua sa??da os efeitos de uma entrada (NORMEY, 2001).\n\nAlguns trabalhos apresentam estrate?gias interessantes para con-\ntornar o problema do atraso de transporte e obter melhor desempenho\nnos controladores. A maioria dessas estrate?gias e? baseadas nas ideias\ndo preditor de Smith (SMITH, 1957).\n\nErros no atraso de transporte no modelo de predic?a?o podem le-\nvar o sistema de controle a? instabilidade. Em Lima, Normey e Plucenio\n(2014), a utilizac?a?o de filtros aplicados ao erro de predic?a?o e? apresen-\ntada como soluc?a?o no contexto de MPC. Esse conceito foi desenvolvido\na partir das ideias do Preditor de Smith Filtrado, apresentado em Nor-\nmey e Camacho (2007).\n\nEm geral, o filtro na?o afeta a resposta do sistema quando o mo-\ndelo e? perfeito, mas sim quando existe erro no atraso de transporte,\nno ganho e nas constantes de tempo entre a planta real e o modelo de\npredic?a?o. Ale?m disso, filtragem no sistema pode resultar numa resposta\nmais lenta a?s perturbac?o?es inseridas no sistema.\n\nEm Plucenio et al. (2014), apresenta-se uma nova abordagem\npara o tratamento de erros de predic?a?o em plantas esta?veis em malha\naberta, denominada MPC com passo de estabilidade. Nessa proposta,\nnenhum filtro e? utilizado. Em vez disso, o algoritmo MPC com passo\nde estabilidade propo?e tratar o problema em duas etapas: uma pri-\nmeira etapa onde se estabiliza o sistema utilizando o segundo me?todo\n\n\n\n28\n\nde estabilidade de Lyapunov (MONTEIRO, 2006) onde se deriva um si-\nnal que somado a? predic?a?o fornece estabilidade, bom desempenho do\ncontrolador frente a erros de modelo, principalmente erros no atraso\nde transporte, fornecendo rapidez na rejeic?a?o a?s perturbac?o?es na?o mo-\ndeladas inseridas no sistema. Na segunda etapa, calcula-se a ac?a?o de\ncontrole.\n\n1.1 OBJETIVOS\n\n1.1.1 Objetivos gerais\n\nEste trabalho visa propor diversas alternativas de implementac?a?o\nda te?cnica PNMPC, considerando diferentes aproximac?o?es para o ca?lculo\ndas predic?o?es de um dado processo na?o linear, avaliando os tempos\nde execuc?a?o e o desempenhos das diferentes implementac?o?es dos con-\ntroladores PNMPC. Tambe?m e? objetivo desse trabalho implementar\ne avaliar o algoritmo MPC com passo de estabilidade implementado\nno controlador DMC-Recursivo, considerando incertezas no modelo de\npredic?a?o.\n\n1.1.2 Objetivos espec??ficos\n\nPara conseguir alcanc?ar os objetivos gerais, os seguintes objetivos\nespec??ficos foram estabelecidos:\n\n\u2022 implementar o controlador com a te?cnica PNMPC proposta em\nPlucenio (2010) e avaliar o tempo de execuc?a?o deste;\n\n\u2022 modificar o PNMPC e implementar diversos algoritmos que per-\nmitam tratar processos com diversos graus de na?o linearidade com\na finalidade de diminuir o custo computacional;\n\n\u2022 comparar o desempenho dos controladores PNMPC implementa-\ndos;\n\n\u2022 implementar o MPC com passo de estabilidade a ser comparando\ncom a te?cnica de filtragem no erro de predic?a?o e avaliar o desem-\npenho dos controladores.\n\n\n\n29\n\n1.2 CONTRIBUIC?A?O CIENTI?FICA\n\nO presente trabalho apresenta contribuic?o?es aos algoritmos de\ncontrole preditivos.\n\nOs principais resultados desta dissertac?a?o foram condensados nos\nartigos: Practical Non-linear Model Predictive Control PNMPC: Algo-\nrithm implementations, apresentado no XXI Congresso Brasileiro de\nAutoma?tica (CBA2016), realizado de 3 a 7 de outubro de 2016, em\nVito?ria, Esp??rito Santo (PICON; PLUCENIO, 2016b); e \u201cDMC de forma\nrecursiva aplicando o passo de estabilidade\u201d apresentado no 12th IE-\nEE/IAS International Conference on Industry Applications (INDUS-\nCON 2016) realizado de 20 a 23 de novembro de 2016, em Curitiba,\nParana? (PICON; PLUCENIO, 2016a).\n\n1.3 ORGANIZAC?A?O DO TRABALHO\n\nOs pro?ximos cap??tulos desta dissertac?a?o esta?o organizados da\nseguinte maneira:\n\n\u2022 o Cap??tulo 2 traz ao leitor a fundamentac?a?o teo?rica e os conceitos\nba?sicos necessa?rios para o desenvolvimento deste trabalho. Os\nconceitos principais relacionados a?s estrate?gias de controle predi-\ntivo baseado em modelo MPC sa?o apresentados;\n\n\u2022 o Cap??tulo 3 apresenta a descric?a?o da fundamentac?a?o teo?rica da\nestrate?gia PNMPC utilizada para o desenvolvimento deste traba-\nlho;\n\n\u2022 no Cap??tulo 4 sa?o apresentadas diferentes maneiras de implemen-\ntar o algoritmo PNMPC. Mostra-se que o algoritmo PNMPC\npode ser escrito para lidar com na?o-linearidades em diferentes\nn??veis. Sa?o implementados 6 algoritmos diferentes das verso?es do\ncontrolador PNMPC, que utilizam simplificac?o?es da te?cnica origi-\nnal completa de forma a reduzir o tempo de processamento. Nesse\ncap??tulo, tambe?m e? descrita a implementac?a?o e a fundamentac?a?o\nmatema?tica com os algoritmos das alternativas das variac?o?es da\nte?cnica PNMPC para cada versa?o. Depois e? apresentado o es-\ntudo de caso, aplicando as verso?es do PNMPC e os resultados de\nsimulac?a?o, comparac?o?es dos tempos de execuc?a?o e desempenho\ndos controladores;\n\n\u2022 no Cap??tulo 5 e? apresentado o MPC com passo de estabilidade,\n\n\n\n30\n\ndescrevendo a implementac?a?o e a fundamentac?a?o matema?tica.\nDepois, apresentam-se os resultados de simulac?a?o e as comparac?o?es\ndos diferentes controladores aplicados ao estudo de caso, avali-\nando o desempenho dos controladores;\n\n\u2022 no Cap??tulo 6, sa?o realizadas as considerac?o?es finais desta dis-\nsertac?a?o e possibilidades de trabalhos futuros sa?o indicadas.\n\n\n\n31\n\nCap??tulo 2\n\nCONTROLE PREDITIVO BASEADO EM\nMODELO MPC\n\nA te?cnica de Controle Preditivo Baseado em Modelo e? uma das\nte?cnicas de controle moderno mais avanc?ada. Em sua forma mais geral,\naceita qualquer tipo de modelo, func?o?es objetivo ou restric?o?es (BOR-\nDONS, 2000).\n\nAtualmente, e? utilizada em processos industriais que requerem\ncontrolar processos multivaria?veis ou monovaria?veis relativamente com-\nplexos, processos lineares ou na?o lineares, processos que tenham carac-\nter??sticas de atraso de transporte ou ainda processos insta?veis (CAMA-\nCHO; BORDONS, 2007).\n\nAle?m da sua ampla gama de aplicac?a?o, um outro motivo do e?xito\ndesta te?cnica e? a maneira geral na qual os problemas de controle sa?o\nformulados no dom??nio do tempo, permitindo que os algoritmos sejam\nmuito mais simples de compreender.\n\nA maior aceitac?a?o dos MPCs, ocorre nas indu?strias de petro?leo,\nga?s, unidades de refino e petroqu??micas. Atualmente, tambe?m existe\numa tende?ncia de incrementar a aplicac?a?o de controle MPC nos proces-\nsos de tratamento prima?rio de produc?a?o em plataformas de produc?a?o de\npetro?leo offshore (PLUCENIO et al., 2007a). O controle preditivo consti-\ntui um amplo campo de me?todos de controle que foram desenvolvidos\ncom certas caracter??sticas comuns e que integra diversos a?mbitos como:\no controle o?timo, controle de processos com tempos mortos, controle\nmultivaria?vel, controle estoca?stico e o controle com restric?o?es (CAMA-\nCHO; BORDONS, 2007). As principais caracter??sticas em toda a fam??lia\ndos controladores preditivos sa?o: (BORDONS, 2000):\n\n\u2022 o uso expl??cito de um modelo para predizer a sa??da do processo\nem instantes de tempo futuros (horizonte);\n\n\n\n32\n\n\u2022 ca?lculos dos sinais de controle, minimizando uma determinada\nfunc?a?o objetivo;\n\n\u2022 estrate?gia de horizonte deslizante, de forma que, em cada instante\nde tempo, o horizonte vai se deslocando para o futuro ate? elimi-\nnar o resto dos valores, repetindo o ca?lculo em cada instante de\namostragem.\n\nEste tipo de controle permite manipular as varia?veis para estabe-\nlecer uma trajeto?ria desejada no futuro, como tambe?m as varia?veis que\nesta?o sendo controladas. Uma vez manipuladas as varia?veis, procede-\nse com o ca?lculo, otimizando-as com a func?a?o objetivo e seguindo os\nme?todos de horizonte mo?vel.\n\nFinalmente, pode-se ainda destacar como vantagem da estrate?gia\nMPC a possibilidade de formular controladores para sistemas comple-\nxos e com restric?o?es, tendo em considerac?a?o o custo computacional e a\nsintonia do controlador (LAWRYNCZUK, 2014).\n\n2.1 CONCEITOS BA?SICOS DO MPC\n\nAs diferenc?as entre os diversos algoritmos existentes devem-se\nbasicamente a? forma de escolher os modelos para o processo e as per-\nturbac?o?es, ao tipo de func?a?o objetivo, ao procedimento para manipular\nas restric?o?es e ao ca?lculo do sinal de controle (PLUCENIO et al., 2007a).\n\nO modelo de predic?a?o e? o elemento mais importante dentro do\nprojeto do controlador. Ele deve ser capaz de representar adequada-\nmente a dina?mica do processo para permitir o ca?lculo das predic?o?es da\nsa??da, deve ser intuitivo e ao mesmo tempo deve permitir uma ana?lise\nteo?rica do sistema.\n\nEm geral, o modelo utilizado para o projeto do controlador MPC\ne? separado em duas partes: modelo do processo propriamente dito e mo-\ndelo das perturbac?o?es, ambos necessa?rios para o ca?lculo das predic?o?es\n(PLUCENIO et al., 2007a).\n\nOs modelos dos processos mais usados sa?o:\n\n\u2022 a resposta do sinal de sa??da ao impulso ou ao degrau dos mode-\nlos dos processos em malha aberta. Ela esta? relacionada com a\nentrada pelas seguintes equac?o?es:\n\n\n\n33\n\n\u2013 para a resposta ao impulso:\n\ny(t) =\n\n??\n\ni=1\n\ngiu(t? i) (2.1)\n\n\u2013 para a resposta ao degrau:1\n\ny(t + k |t) =\n??\n\ni=1\n\ngi?u(t + k ? i |t) (2.2)\n\nSendo que os valores de gi sa?o obtidos ao submeter o processo a\num impulso no caso da resposta ao impulso ou um degrau. No\ncaso de ser uma resposta ao degrau, na qual a ac?a?o de controle e?\ndada por: ?u (t) = u(t) ? u(t? 1). A soma e? truncada ate? os\nprimeiros p elementos, sendo p o horizonte de predic?a?o, no qual\nso? podem ser representados processos esta?veis e sem integrador,\nconforme as equac?o?es (2.1) e (2.2):\n\n\u2013 para a resposta ao impulso:\n\ny(t) =\n\np?\n\ni=1\n\ngi?u(t? i) (2.3)\n\n\u2013 para a resposta ao degrau:\n\ny(t + k |t) =\np?\n\ni=1\n\ngi?u(t + k ? i |t) (2.4)\n\nAs vantagens de se utilizar a resposta impulsiva ou ao degrau e?\nque:\n\n\u2013 sa?o intuitivos e podem ser usados em processos multivaria?veis\nsem acrescentar complexidade;\n\n\u2013 quando os modelos sa?o identificados na?o e? preciso ter um\nconhecimento pre?vio do processo;\n\n\u2013 descrevem de maneira simples efeitos complexos da dina?mica\ndo processo, como atrasos e comportamentos de fase na?o\nm??nima.\n\n1A notac?a?o indica o valor da varia?vel no isntante (t + k) calculado no instante t\n.\n\n\n\n34\n\nPor outro lado apresentam alguns inconvenientes:\n\n\u2013 na?o podem ser usados com plantas insta?veis;\n\n\u2013 necessitam utilizar um grande nu?mero de para?metros para\ndescrever o modelo, sobretudo se o processo tiver um atraso\ngrande.\n\n\u2022 modelos em func?a?o de transfere?ncia.\nUtilizam o conceito de func?a?o de transfere?ncia G = B/A, repre-\nsentada da seguinte forma no dom??nio do tempo:\n\nA(z?1)y(t) = B(z?1)u(t)\n\nsendo:\n\nA(z?1) denominador da func?a?o de tranfere?ncia;\nB(z?1) numerador da func?a?o de tranfere?ncia;\ny(t) sa??da do processo;\nu(t) sinal do controle.\n\nem que a sa??da predita e?:\n\ny?(t + k |t) = B(z\n?1)\n\nA(z?1) u(t + k |t)\n\nA principal vantagem deste tipo de modelos e? que pode ser usado\npara plantas insta?veis e que precisa, em geral, de poucos para?metros\npara descrever o comportamento do sistema (o atraso, por exem-\nplo, pode ser descrito apenas com um para?metro). Pore?m, o prin-\ncipal inconveniente e? a necessidade de conhecer a priori a ordem\ndos polino?mios do numerador e denominador quando o modelo\ndeve ser identificado a partir de dados experimentais (PLUCENIO\net al., 2007a).\n\n\u2022 modelos em espac?os de estado, tem a seguinte representac?a?o:\n\nx(t) = Ax(t? 1) + Bu(t? 1)\ny(t) = Cx(t)\n\nonde x e? o estado e A,B e C sa?o as matrizes de entrada e sa??da\ndo sistema respectivamente. A sa??da predita e? calculada pela\n\n\n\n35\n\nseguinte equac?a?o:\n\ny? (t + k |t) = Cx? (t + k |t) = C\n[\nAkx (t) +\n\nk?\n\ni=1\n\nAi?1Bu (t + k ? i |t)\n]\n\n(2.5)\nA vantagem deste tipo de modelo e? que pode ser usado direta-\nmente para processos multivaria?veis lineares. Como inconvenien-\ntes, cabe mencionar que em geral os estados na?o tem significado\nf??sico e que na maioria das vezes e? necessa?rio o uso de observa-\ndores, aumentando assim a complexidade de ca?lculo do controle\n(PLUCENIO et al., 2007a).\n\nA escolha de um modelo para as perturbac?o?es e? ta?o importante quanto\na do processo.\n\nO modelo mais utilizado para a descric?a?o de perturbac?o?es de-\ntermin??sticas e estoca?sticas e? o Modelo Auto-Regressivo integrado e de\nMe?dia Mo?vel Integrada (Auto-Regressive and Integrated Moving Ave-\nrage, ARIMA) (CAMACHO; BORDONS, 2007). Neste tipo de modelo, a\ndiferenc?a entre a sa??da medida e a calculada pelo modelo e? dada pela\nequac?a?o:\n\nn(t) =\nC(z?1)e(t)\nD(z?1)\n\n(2.6)\n\nno qual o polino?mio D(z?1) inclui explicitamente ? = 1 ?z?1, e e (t)\ne? um ru??do de me?dia zero e, geralmente, o polino?mio C(z?1) e? consi-\nderado igual a um. Assim, n(t) representa a diferenc?a entre a sa??da do\nmodelo e o processo.\n\nEste modelo permite representar mudanc?as aleato?rias, \u201coff-sets \u201d\ne outros feno?menos normalmente encontrados nos meios industriais.\nEsse modelo e? usado diretamente no GPC proposto por (CLARKE;\nMOHTADI, 1987a), e tem recebido bastante atenc?a?o no meio acade?mico\ne em diversas aplicac?o?es industriais (CAMACHO; BORDONS, 1995) e\n(CLARKE; MOHTADI, 1987b).\n\nNa Figura 1 mostra-se a estrutura geral de um MPC, onde pode\nser observado o funcionamento do algoritmo. Para predizer as sa??das\nfuturas do processo, e? usado o modelo da planta, baseando-se nos sinais\nde controle futuros. Esses sinais sa?o calculados pelo otimizador tendo\nem considerac?a?o a func?a?o custo e as restric?o?es. Pelo que o modelo\ncumpre um papel importante no controlador MPC, ele deve conseguir\nrepresentar a dina?mica do processo. O otimizador e? outra parte funda-\nmental da estrutura mostrada na Figura 1, ja? que proporciona as ac?o?es\nde controle do sistema. Se a func?a?o custo e? quadra?tica, pode-se obter\n\n\n\n36\n\no m??nimo com uma func?a?o expl??cita entre as entradas, sa??das passa-\ndas e a trajeto?ria de refere?ncia. Quando existem restric?o?es a soluc?a?o e?\ncalculada por me?todos nume?ricos.\n\nFigura 1 \u2013 Estrutura do MPC.\n\nTrajet\u00f3ria da \nrefer\u00eanciaSa\u00eddas\n\n preditas\n\nSa\u00edda atualControle atual\n\nErros futuros\n\nRestri\u00e7\u00f5esFun\u00e7\u00e3o custo\n\nProcesso\n\nModelo\n\nOptimizador\n\nFonte: (CAMACHO; BORDONS, 2007).\n\n2.1.1 Resposta livre e forc?ada\n\nOs conceitos de resposta livre e resposta forc?ada, sa?o utilizados\nnos controladores MPC. A ide?ia e? representar as ac?o?es de controle como\numa soma de dois sinais, conforme equac?a?o (BORDONS, 2000):\n\nu(t) = uf (t) + uc(t) (2.7)\n\nonde uf (t) sa?o as entradas passadas (anteriores ao instante t) e uc(t)\ne? o sinal dos controles futuros. Para o ca?lculo da ac?a?o de controle,\no sinal uf (t) e? mantido constante e igual ao u?ltimo valor da varia?vel\nmanipulada; o sinal uc(t) e? considerado 0 no passado. A sa??da predita\ne? separada em duas partes, como se mostra na Figura 2.\n\nA resposta livre yf (t) corresponde a? predic?a?o da sa??da quando\na varia?vel manipulada e? uf (t). A resposta forc?ada yc(t) corresponde a?\n\n\n\n37\n\npredic?a?o da sa??da quando o sinal de controle e? uc(t).\n\nFigura 2 \u2013 Resposta livre e resposta forc?ada.\n\nu\nProcesso\n\ny\n\nt t\n\nu u y y\n\nt t t t\n\nf\ncf c\n\nFonte: (CAMACHO; BORDONS, 2007).\n\nA resposta livre e? a evoluc?a?o do processo devido a seu estado\natual, incluindo o efeito das ac?o?es passadas. A resposta forc?ada e? a\nresposta do processo a?s ac?o?es de controle futuras.\n\n2.1.2 Func?a?o objetivo\n\nCada algoritmo MPC propo?e distintas func?o?es custo para a ob-\ntenc?a?o da lei de controle. Em geral, se deseja que as sa??das futuras,\nem um horizonte definido, sigam um determinado sinal de refere?ncia,\nao mesmo tempo em que se possa penalizar o esforc?o de controle re-\nquerido. A expressa?o geral da func?a?o objetivo e? mostrada na seguinte\nequac?a?o (CAMACHO; BORDONS, 2007):\n\nJ(p1,p2,mh) =\n\np2?\n\ni=p1\n\n?(i)[y(t + i\n??t) ?w(t + i)]2 +\n\nmh?\n\ni=1\n\n?(i)[?u(t + i? 1)]2\n\n(2.8)\nEm alguns me?todos, o segundo somato?rio, que considera o es-\n\nforc?o de controle, na?o e? considerado, mas em outros aparece direta-\nmente os valores do sinal de controle. Os para?metros p1 e p2 sa?o as\nvaria?veis m??nimo e ma?ximo da predic?a?o, marcam os limites dos instan-\ntes que se deseja que a sa??da siga a refere?ncia. Se o processo apresenta\ntempo morto d, na?o tem sentido que p1 seja menor que d, ja? que a sa??da\nso? evoluira? no instante t + d e se o processo e? de fase na?o m??nima, p1\npermite eliminar da func?a?o objetivo os primeiros instantes da resposta\n\n\n\n38\n\ninversa. Por outro lado, mh e? o horizonte de controle.\nOs coeficientes ?(i) e ?(i) sa?o seque?ncias que ponderam o com-\n\nportamento futuro. Geralmente sa?o considerados valores constantes ou\nseque?ncias exponenciais, como se mostra na seguinte equac?a?o:\n\n?(i) = ?p2?i (2.9)\n\nSe ? esta? entre 0 e 1, significa que esta? se penalizando mais os\nerros que esta?o afastados do instante t que os mais pro?ximos, gerando\num controle mais suave requerendo um menor esforc?o. Por outro lado,\nse ? > 1 esta?o se penalizando mais os primeiros erros, provocando um\ncontrole mais agressivo.\n\n2.1.3 Trajeto?ria das refere?ncias\n\nUma vantagem do controle preditivo e? que as refere?ncias sa?o\nconhecidas a priori. Assim, o sistema pode comec?ar a agir antes que a\nmudanc?a seja efetivamente realizada, evitando os efeitos do retardo na\nresposta do processo.\n\nA maioria dos me?todos utiliza no crite?rio de minimizac?a?o uma\ntrajeto?ria de refere?ncia w(t + k), que geralmente e? uma aproximac?a?o\nsuave de um sistema de primeira ordem do valor atual da sa??da y(t) a?\nrefere?ncia, mostrada na equac?a?o (2.10).\n\nw(t) = y(t)\nw(t + k) = ?w(t + k ? 1) + (1 ??)\nk = 1 ....... p\n\n(2.10)\n\n? e? um para?metro entre 0 a 1 (em quanto mais perto de um mais suave\ne? a aproximac?a?o), que constitui um valor ajusta?vel que influenciara?\nna resposta dina?mica do sistema. Na Figura 3, mostra-se a forma da\ntrajeto?ria quando a refere?ncia r(t + k) e? constante.\n\nNa Figura 3, mostra-se que W1 com um valor pequeno de ? se\ntem um seguimento de refere?ncia ra?pido, mas para W2 com um valor\nmaior para ? a resposta fica mais suave.\n\n2.1.4 Restric?o?es\n\nE? importante considerar restric?o?es no sistema, ja? que todos os\nprocessos esta?o sujeitos a limitac?o?es. Pode-se citar como exemplo as\n\n\n\n39\n\nFigura 3 \u2013 Trajeto?ria da refere?ncia.\n\nW1 (t+k)\n\nr(t+k)\n\nY(t)\n\nW2(t+k)\n\nt\n\nFonte: (CAMACHO; BORDONS, 2007).\n\nrestric?o?es meca?nicas de atuadores e va?lvulas, que esta?o limitadas pela\ncapacidade meca?nica de abertura e fechamento, assim como pela ve-\nlocidade de resposta. As restric?o?es tambe?m podem ser impostas pelos\nsensores do processo. Sendo assim, faz-se necessa?ria a introduc?a?o de\nrestric?o?es na func?a?o custo para representar as limitac?o?es do sistema.\n\nGeralmente, sa?o considerados os limites na amplitude do sinal de\ncontrole, na variac?a?o do sinal de controle e limites nos sinais de sa??das,\ncomo observado nas equac?o?es:\n\numin ? u (t) ? umax ?t\n?umin ? u (t) ?u (t? 1) ? ?umax ?t\nymin ? y(t) ? ymax ?t\n\n(2.11)\n\n2.1.5 Obtenc?a?o da Lei de Controle\n\nO u?ltimo passo que compo?e a obtenc?a?o dos valores de controle\nnas estrate?gias de Controle Preditivo e? a determinac?a?o do valor de\n?u (t + k | t) com i = 0...mh ? 1. Para isso, seguem-se os seguintes\npassos:\n\n1. ca?lculo do valor de y? (t + k | t) como func?a?o dos controles futuros;\n\n2. substituic?a?o dos valores y? e w na func?a?o J;\n\n3. minimizac?a?o da func?a?o J, considerando as ponderac?o?es e as res-\ntric?o?es, se existirem.\n\nDesta forma, e? poss??vel obter uma seque?ncia de ac?o?es de con-\ntrole futuras, mas a aplicac?a?o do valor de controle segue o conceito do\n\n\n\n40\n\nhorizonte deslizante. Assim, apesar de se obter uma seque?ncia futura\nde controle, apenas a primeira ac?a?o de controle e? aplicada (BORDONS,\n2000).\n\n2.2 ALGORITMO MPC UTILIZADO NA INDU?STRIA\n\nSe apresenta a continuac?a?o um dos principais algoritmos de Con-\ntrole Preditivo, o me?todo considerado o mais representativo no en-\ntorno indu?strial, o DMC. A seguir apresentam-se suas principais carac-\nter??sticas e formulac?o?es matema?ticas.\n\n2.2.1 Controle por Matriz Dina?mica-DMC\n\nO algoritmo de controle preditivo denominado Controle por Ma-\ntriz Dina?mica (DMC) e? um dos algoritmos mais difundidos na indu?stria.\nO DMC foi desenvolvido no final dos anos setenta por (CUTLER; RE-\nMARKER, 1980) na Shell Oil, e foi muito bem aceito no meio industrial,\nprincipalmente na indu?stria petroqu??mica.\n\nPrimeiro e? apresentado o algoritmo original do DMC proposto\nem (RICHALET; RAULT; TESTUD, 1978), e depois apresenta-se o DMC-\nRecursivo, proposto em (CUTLER; REMARKER, 1980), que modifica\ncomo a resposta livre e? calculada de forma a obter um algoritmo mais\nsimples de ser implementado e com a vantagem de na?o afetar o contro-\nlador original do DMC.\n\n2.2.2 DMC Original\n\nO modelo utilizado pelo DMC, e? um modelo baseado na resposta\nao degrau do sistema, enquanto as perturbac?o?es sa?o consideradas cons-\ntantes ao longo do horizonte p.\n\nA forma de obter as predic?o?es e? mostrado a seguir. O modelo da\nresposta ao degrau pode ser expresso pela equac?a?o (2.12).\n\ny (t) =\n\n??\n\ni=1\n\ngi?u (t? i) (2.12)\n\nAs predic?o?es ao longo do horizonte p, sa?o calculadas adicionando\n\n\n\n41\n\na predic?a?o de pertubac?a?o n? (t + k | t), como mostrado:\n\ny? (t + k |t) =\n??\ni=1\n\ngi?u (t + k ? i) + n? (t + k |t)\n\ny? (t + k |t) =\nk?\n\ni=1\n\ngi?u (t + k ? i) +\n??\n\ni=k+1\n\ngi?u (t + k ? i) + n? (t + k |t)\n(2.13)\n\nOs termos da equac?a?o (2.13) dependentes do controle foram se-\nparados em duas somas: uma com os valores passados e outra com\nos valores futuros. A pertubac?a?o e? considerada constante. Da forma:\nn? (t + k |t) = n? (t |t) = ym (t) ? y? (t |t), assim pode-se reescrever:\n\ny? (t + k |t) =\n??\ni=1\n\ngi?u (t + k ? i) + ym (t) ?\n??\ni=1\n\ngi?u (t? i)\n\ny? (t + k |t) =\nk?\n\ni=1\n\ngi?u (t + k ? i) + f (t + k)\n(2.14)\n\nonde f (t + k), e? a resposta livre do sistema, dada pela equac?a?o (2.15).\n\nf (t + k) = ym (t) +\n\n??\n\ni=1\n\n(gk+1 ?gi)?u (t? 1) (2.15)\n\nSe o sistema e? esta?vel, os coeficientes gi da resposta ao degrau\ntendem a um valor constante apo?s p amostras, como e? mostrado na\nFigura 4, logo gk+1 ? gi ? 0, para i > p, com isso a resposta livre da\nequac?a?o (2.15) pode ser calculada conforme a equac?a?o (2.16).\n\nf (t + k) = ym (t) +\n\np?\n\ni=1\n\n(gk+1 ?gi)?u (t? 1) (2.16)\n\nAssim, pode-se calcular as predic?o?es ao longo do horizonte de\npredic?a?o (k = 1, ...,p), considerando mh ac?o?es de controle:\n\ny? (t + 1 |t) = g1?u (t) + f (t + 1)\ny? (t + 1 |t) = g2?u (t) + g1?u (t + 1) + f (t + 2)\n...\n\ny? (t + p |t) =\np?\n\ni=p?mh+1\ngi?u (t + p? i) + f (t + p)\n\n(2.17)\n\n\n\n42\n\nFigura 4 \u2013 Resposta au degrau.\n\n? ?y t\n\nt 1t ? 2t ? t p??\n\n1g\n\n2g\n\nig\n\npg\n\nFonte: (CAMACHO; BORDONS, 2007).\n\nAs predic?o?es do sistema de forma matricial podem ser escritas\ncomo:\n\ny? = f + G?u (2.18)\n\nonde, G e? a matriz dina?mica do sistema, ?u e? o vetor das ac?o?es de\ncontrole futuras, e f e? o vetor da resposta livre do sistema:\n\nG =\n\n?\n??????????\n\ng1 0 \u00b7 \u00b7 \u00b7 0\ng2 g1 \u00b7 \u00b7 \u00b7 0\n.\n.\n.\n\n.\n\n.\n\n.\n. . .\n\n.\n\n.\n\n.\ngmh gmh?1 \u00b7 \u00b7 \u00b7 g1\n\n.\n\n.\n\n.\n.\n.\n.\n\n. . .\n.\n.\n.\n\ngp gp?1 \u00b7 \u00b7 \u00b7 gp?mh+1\n\n?\n??????????\n, ?u =\n\n?\n????\n\n?u (k)\n?u (k + 1)\n\n.\n\n.\n\n.\n?u (k + mh)\n\n?\n???? , f =\n\n?\n???????????\n\nf (t + 1)\nf (t + 2)\n\n.\n\n.\n\n.\n\n.\n\n.\n\n.\n\n.\n\n.\n\n.\nf (t + p)\n\n?\n???????????\n\n(2.19)\n\nComo e? observado na equac?a?o (2.19), para o ca?lculo de y? seria\nnecessa?rio armazenar os valores passados do controle. Uma forma de\nsimplificar este ca?lculo consiste no uso do DMC-Recursivo, descrito na\nsec?a?o seguinte.\n\n\n\n43\n\n2.2.3 DMC-Recursivo\n\nExiste uma outra forma para implementar o algoritmo DMC,\nchamada de DMC-Recursivo, apresentada por (CUTLER; REMARKER,\n1980). As predic?o?es de malha aberta em t + k, dadas as informac?o?es\nem t e t? 1, sa?o respectivamente dados por:\n\ny0 (t + k |t) =\n??\n\ni=k+1\n\ngi?u (t + k ? i) ; (2.20)\n\ny0 (t + k |t? 1 ) =\n??\n\ni=k+2\n\ngi?u (t + k ? i) , (2.21)\n\nna qual a diferenc?a entre a predic?a?o de malha aberta em t + k dado\nt, e em t + k dado t ? 1, e? apenas a nova ac?a?o de controle que na?o e?\nconhecida em ?u(t?1). Subtraindo as equac?o?es (2.20) e (2.21) tem-se:\n\ny0 (t + k |t) ?y0 (t + k |t? 1 ) =\ngk+1?u (t? 1) +\n\n??\nj=k+2\n\ngj?u (t + k ? j) +\n\n?\n??\n\nj=k+2\n\ngj?u (t + k ? j)\n(2.22)\n\nAssim, obte?m-se:\n\ny0 (t + k |t) = gk+1?u (t? 1) + y0 (t + k |t? 1 ) (2.23)\n\nNo ca?lculo do DMC-Recursivo, a resposta livre e? calculada da\nseguinte forma:\n\nYlivre = [y0 (t |t? 1 ) , ...,y0 (t + N ? 1 |t ? 1)]T (2.24)\n\nonde N e? chamado de horizonte de modelo, mantendo em memo?ria\num vetor com N elementos2. Seus elementos sa?o as respostas livres\ndadas as ac?o?es de controle conhecidas ate? o instante t? 1. Ao iniciar\no controlador DMC no instante t0, dado que o sistema encontra-se\nem regime permanente, considera-se que as predic?o?es de malha aberta\nsejam constantes e iguais ao valor de y(t0).\n\nAo iniciar a execuc?a?o do algoritmo DMC no instante t, e? preciso\natualizar o vetor da resposta livre, pois o incremento da ac?a?o de con-\ntrole ?u (t? 1) agora e? conhecido. O vetor Ylivre da equac?a?o (4.7) e?\n\n2O valor de N deve ser significativamente maior que p.\n\n\n\n44\n\natualizado.\n\nYlivre = Ylivre +\n\n?\n????\n\ng1\ng2\n...\ngN\n\n?\n???? ?u (t? 1) (2.25)\n\nApo?s obter o novo sinal de controle u(t), e? preciso deslocar os\nvalores dentro do vetor Ylivre. Isto porque no instante posterior t +\n1, sera?o necessa?rias respostas livres de t + 1 ate? t + N baseadas nos\ndados ate? t. Enta?o, o primeiro elemento e? descartado, pois e? a predic?a?o\nrelativa ao instante t, que ja? passou. O problema e? que, ao se fazer este\ndeslocamento, o u?ltimo elemento, no caso a predic?a?o em y(t + N|t),\ne? desconhecida. Pore?m, se o sistema for esta?vel, pode-se considerar\ny0(t + N|t) ?= y0(t + N ? 1|t). Assim, o novo vetor Ylivre sera? dado\npela equac?a?o (4.8):\n\nYlivre =\n\n?\n??????\n\ny0 (t + 1 |t)\ny0 (t + 2 |t)\n\n...\ny0 (t + N ? 1 |t)\ny0 (t + N ? 1 |t)\n\n?\n??????\n\n(2.26)\n\nA condic?a?o y0(t + N|t) ?= y0(t + N ? 1|t) e? mostrada como:\n\ny0 (t + N ? 1 |t) =\n??\n\ni=N\n\ngi?u (t + N ? 1 ? i)\n\ny0 (t + N |t) =\n??\n\ni=N+1\n\ngi?u (t + N ? i) =\n??\n\ni=N\n\ngi+1?u (t + N ? 1 ? i)\n\ny0 (t + N |t)?y0 (t + N ? 1 |t) =\n??\n\ni=N\n\n(gi+1 ?gi) ?u (t + N ? 1 ? i)\nComo gi+1 ? gj ?= 0,?i > N, tem-se que y0(t + N|t) ?= y0(t +\n\nN ? 1|t), como se queria demonstrar.\nAssim, o ca?lculo da resposta livre considerada no DMC-Recursivo\n\ne? realizado atrave?s da equac?a?o:\n\nf =\n\n?\n??\ny0 (t + 1 |t)\n\n...\ny0 (t + p |t)\n\n?\n?? + 1p\u00d71e (2.27)\n\nNo algoritmo DMC, o erro entre a sa??da medida e a sa??da predita\nem malha aberta no instante k e? usado para corrigir as predic?o?es de\n\n\n\n45\n\ncada estado de todos os elementos dentro do horizonte de predic?a?o p.\nNesse caso, a equac?a?o do erro do modelo e?:\n\ne(t) = ym(t) ?y0 (t |t) (2.28)\n\nComo e? mostrado na equac?a?o (2.18), a representac?a?o das predic?o?es,\nconsiderando o ca?lculo da resposta livre com o DMC-Recursivo, e? ob-\ntida com a equac?a?o (4.11):\n\nY? = f + G?u (2.29)\n\nonde:\n\n\u2022 Y? sa??da predita p\u00d7 1 ;\n\n\u2022 f vetor da resposta livre de dimensa?o p\u00d7 1 ;\n\n\u2022 G matriz Jacobiana de Y? de dimensa?o p\u00d7mh;\n\n\u2022 ?u vetor de dimensa?o mh \u00d7 1 que conte?m os\nincrementos na ac?a?o de controle .\n\nOnde p e? o horizonte de predic?a?o e mh e? o horizonte de controle.\nUtilizando esta forma de implementac?a?o, os ca?lculos necessa?rios\n\npara obter a sa??da predita tornam-se mais simples, na?o sendo necessa?rio\no armazenamento dos incrementos de controle passados. Com este\nprocedimento, so? e? alterado o modo de calcular a resposta livre, o\nrestante do algoritmo de controle na?o e? modificado.\n\n2.3 CONCLUSA?O\n\nNeste cap??tulo fez-se uma revisa?o da teoria de Controle Predi-\ntivo, mostrando a importa?ncia de utilizar um modelo de predic?a?o para\nas sa??das futuras e a utilizac?a?o de um procedimento espec??fico de oti-\nmizac?a?o para a obtenc?a?o dos valores de controle futuro.\n\nO algoritmo mais utilizado na aplicac?a?o industrial foram descri-\ntas nesta sec?a?o. O DMC original e o DMC-Recursivo com as respectivas\nformulac?o?es matema?ticas.\n\nOs algoritmos DMC para o caso SISO (Single-Input Single-Output)\nforam apresentados na sec?a?o 2.2, e podem ser estendidos para o caso\nMIMO (Multiple-Input Multiple-Output), para um sistema com m en-\ntradas e n sa??das.\n\n\n\n46\n\nNos cap??tulos posteriores, sera? aplicado o DMC-Recursivo em\ndiversos estudos de caso. Neste cap??tulo descreveu-se a notac?a?o ma-\ntema?tica da te?cnica, para sua posterior implementac?a?o, tornando-se\nassim a base deste trabalho.\n\n\n\n47\n\nCap??tulo 3\n\nMPC PRA?TICO PARA SISTEMAS NA?O\nLINEARES - PNMPC\n\nEste cap??tulo esta? centrado em aspectos de Controle Preditivo\nNa?o Linear, especificamente na te?cnica PNMPC.\n\nAtualmente, no contexto de Controle Preditivo para processos\nlineares, as estrate?gias mais utilizadas na indu?stria, em geral, sa?o o\nDMC e GPC (CAMACHO; BORDONS, 2007).\n\nPara conseguir implementar o Controle Preditivo, e? muito im-\nportante ter um modelo do processo. Como a maioria dos processos sa?o\nefetivamente na?o lineares, na maioria das vezes recorre-se a?s te?cnicas\nde linearizac?a?o para a obtenc?a?o do modelo. Para muitos processos este\nprocedimento e? aceita?vel, seja pelo pequeno n??vel de na?o linearidade do\nprocesso ou pelo fato da planta operar sempre em uma regia?o muito\npro?xima do ponto de operac?a?o (ALLGOWER; FINDEISEN, 2004). Pore?m,\nquando os processos te?m a dina?mica na?o linear ou quando a faixa de\noperac?a?o e? varia?vel, enta?o necessariamente devera? ser utilizado o mo-\ndelo na?o linear para o projeto de controle, de forma que permita manter\no desempenho desejado para o sistema em malha fechada (BORDONS,\n2000).\n\nDo ponto de vista conceitual, o MPC na?o linear (NMPC) na?o\napresenta dificuldades. Considera a mesma func?a?o objetivo J que no\ncaso linear e na?o linear, para o ca?lculo das predic?o?es. O objetivo con-\nsiste novamente em encontrar uma ac?a?o de controle que minimize a\nfunc?a?o objetivo num algoritmo de horizonte deslizante. Pore?m, do\nponto de vista pra?tico, sa?o va?rias as dificuldades encontradas neste\ntipo de projeto (se comparado ao caso linear):\n\n1. determinac?a?o do modelo do processo quando este deve ser deter-\nminado atrave?s de uma te?cnica de identificac?a?o;\n\n\n\n48\n\n2. obtenc?a?o do sinal de controle requer, em geral, a soluc?a?o de um\nproblema de otimizac?a?o na?o convexo;\n\n3. ana?lise de estabilidade e robustez da soluc?a?o.\n\nPor estes motivos, o NMPC e? um campo aberto para pesquisas\ntanto na a?rea de determinac?a?o de modelos como nos procedimentos e\nalgoritmos de otimizac?a?o para o ca?lculo de controle (CAMACHO; BOR-\nDONS, 2007).\n\nDe acordo com va?rios autores (PRADA, 2004) e (QIN; BADGWELL,\n2003), as tende?ncias no controle avanc?ado de processos, e o desenvol-\nvimento tecnolo?gico da pro?xima gerac?a?o de MPCs esta?o associados a\ncontroladores na?o lineares baseados em modelos (NMPC).\n\nExiste uma grande quantidade de te?cnicas MPC que, direta ou\nindiretamente, tratam sistemas na?o-lineares. Estas te?cnicas se classifi-\ncam em tre?s grupos:\n\n1. te?cnicas que utilizam diretamente um modelo na?o linear gene?rico\ne um algoritmo de otimizac?a?o na?o linear de propo?sito geral;\n\n2. te?cnicas que utilizam modelos na?o lineares particulares e me?todos\nde otimizac?a?o espec??ficos para o modelo escolhido;\n\n3. te?cnicas que utilizam um ou va?rios modelos lineares para repre-\nsentar o processo e algoritmos de otimizac?a?o lineares.\n\nEvidentemente, as vantagens de uma ou outra alternativa esta?o\ndiretamente relacionadas ao compromisso desempenho-custo computa-\ncional (CAMACHO; BORDONS, 1995).\n\nGeralmente, muitos processos na?o lineares sa?o modelados atrave?s\nda utilizac?a?o de algoritmos de identificac?a?o, com excec?a?o de redes neu-\nrais, que fornecem as sa??das nominais dos processos dadas as entradas\ne os estados atuais. Com a premissa da existe?ncia de tais abordagens\nde modelagem, mais recentemente, em (PLUCENIO, 2010), foi desenvol-\nvida uma estrate?gia denominada PNMPC para o controle de muitos\ndesses processos na?o lineares.\n\nDos tre?s grupos de te?cnicas de controle preditivo na?o linear ci-\ntadas acima, o terceiro se encaixa com a te?cnica PNMPC, que vem\napresentando bom desempenho e a vasta possibilidade de aplicac?o?es em\nprocesso com dina?mica na?o linear, o que se torna interessante quando\ne? avaliada a simplicidade da sua implementac?a?o.\n\nA estrate?gia PNMPC tem como principal func?a?o a aproximac?a?o\nlinear do modelo de predic?a?o na?o linear a cada instante de amostragem\n\n\n\n49\n\ne a consecutiva otimizac?a?o quadra?tica, similar a? formulac?a?o tradicional\ndos algoritmos DMC e GPC. No entanto, o diferencial dessa te?cnica\ne? a maneira pela qual ela define a linearizac?a?o do modelo de predic?a?o\nna?o linear a cada instante de amostragem. Nela tambe?m e? utilizada\na formulac?a?o tradicional de ca?lculo da predic?a?o, dividindo a resposta\nlivre da resposta forc?ada, enquanto se mante?m maior proximidade da\nresposta real do processo ao utilizar um modelo na?o linear para deter-\nminar a resposta livre.\n\nO principal objetivo do algoritmo PNMPC, consiste em fornecer\num caminho simples e eficaz para o Controle Preditivo de sistemas na?o\nlineares. A premissa inicial e? o fato de que os algoritmos de controle,\ncomo o DMC e o GPC, utilizam uma representac?a?o para a predic?a?o\nao longo do horizonte de predic?a?o, y?, como uma func?a?o do vetor de\nincrementos futuros de controle ?u, conforme a equac?a?o (PLUCENIO,\n2010):\n\ny? = f + G?u (3.1)\n\nSabe-se tambe?m que, mesmo atrave?s de caminhos diferentes, em\nambas as estrate?gias (GPC e DMC), o princ??pio de superposic?a?o pre-\nsente em modelos lineares permite uma forma simples de calcular a\nsa??da predita y?. No entanto, para o caso na?o linear, o princ??pio da\nsuperposic?a?o na?o e? valido, e assim, busca-se descrever a evoluc?a?o dos\nestados do sistema ao longo do horizonte de predic?a?o p, utilizando uma\nrepresentac?a?o linear dos estados em relac?a?o aos incrementos de controle\nfuturo, similar a? equac?a?o (3.1).\n\nComo, independentemente da linearidade dos sistemas, as u?nicas\nvaria?veis que podem alterar o valor das predic?o?es futuras sa?o de fato os\nincrementos futuros ?u, utiliza-se uma linearizac?a?o em func?a?o dessas\nvaria?veis e na?o o conceito de ponto de equil??brio. Enta?o, assume-se\nque as predic?o?es para esse caso, y?, dependem dos controles passados\n??u , das sa??das presentes e passadas ??y e dos incrementos de controle\nfuturos ?u, como se mostra na equac?a?o (3.2).\n\ny? = f (??y ,??u , ?u) (3.2)\nAssim, com a aproximac?a?o proposta na equac?a?o (3.2), o vetor\n\nde predic?o?es pode ser reescrito por:\n\nY? = F + GP NMP C ?u (3.3)\n\nonde F = f (??y ,??u ) e GP NMP C = ?Y???u . Vale ressaltar que a repre-\n\n\n\n50\n\nsentac?a?o das predic?o?es da equac?a?o (3.3), nada mais e? do que uma line-\narizac?a?o de primeira ordem da se?rie de Taylor para ?u = 0, podendo\ntambe?m ser indicada como uma linearizac?a?o pela se?rie de Maclaurin.\n\nPara demonstrar a formulac?a?o da estrate?gia, considera-se o sis-\ntema dina?mico na?o linear cont??nuo e diferencia?vel com uma entrada e\numa sa??da, representado por:\n\ny (k) = f (y (k ?na) ,y (k ?na + 1) , ....,y (k ? 1) ,\nu (k ?nu) ,u (k ?nu, + 1) , ....,u (k ? 1)) ,\n\n(3.4)\n\nsendo na e nu os maiores atrasos de y e u, respectivamente.\nConsiderando um horizonte de controle futuro mh, devera?o apa-\n\nrecer as entradas futuras na forma representada abaixo:\n\nu (k) = u (k ? 1) + ?u (k)\nu (k + 1) = u (k) + ?u (k + 1)\nu (k + 2) = u (k ? 1) + ?u (k) + ?u (k + 1)\n...\nu (k + mh ? 1) = u (k ? 1) + ?u (k) + \u00b7 \u00b7 \u00b7 + ?u (k + mh ? 1)\n\n(3.5)\n\nO horizonte futuro e? limitado a mh, onde deve-se assumir que as\nentradas posteriores a k +mh?1 sa?o iguais a u(k +mh?1). Utilizando\na equac?a?o (3.4) para calcular as predic?o?es, tem-se:\n\ny? (k + 1) = f (y (k ?na + 1) , ...,y (k) ,u (k ?nu + 1) , ..., u (k))\ny? (k + 2) = f (y (k ?na + 2) , ...,y (k + 1) ,u (k ?nu + 2) , ..., u (k + 1))\n...\ny? (k + p) = f (y? (k ?na + p) , ...,\ny? (k + p? 1) ,u (k ?nu + 1) , ..., u (k + m? 1))\n\n(3.6)\nSubstituindo as relac?o?es apresentadas em (3.5), o conjunto de\n\nequac?o?es apresentadas em (3.6) passa a ser dado por:\n\n\n\n51\n\ny? (k + 1) = f (y (k ?na + 1) , ...,y (k) ,u (k ?nu + 1) , ..., u (k ? 1) , ?u (k))\ny? (k + 2) = f (y (k ?na + 2) , ..., y? (k + 1) ,u (k ?nu + 2) , ...,u (k ? 1) ,\n?u (k) , ?u (k + 1))\n...\ny? (k + p) = f (y? (k ?na + p) , ..., y? (k + p? 1) ,u (k ?nu + 1) , ...,\nu (k ? 1) , ?u (k) , ?u (k + 1) , ..., ?u (k + mh ? 1))\n\n(3.7)\nPara simplificar a notac?a?o, o conjunto de entradas passadas ??u\n\ne das sa??das passadas ??y , passa a ter a forma da expressa?o em (3.7) e\nse reduzem a? seguinte equac?a?o:\n\ny? (k + 1) = f (??y ,??u , ?u (k))\ny? (k + 2) = f (??y ,??u , ?u (k) , ?u (k + 1))\n...\n\ny? (k + p) = f (??y ,??u , ?u (k) , . . . , ?u (k + mh ? 1))\n\n(3.8)\n\nObservando a equac?a?o (3.8), e? poss??vel concluir que as u?nicas\nvaria?veis capazes de alterar o valor das sa??das futuras sa?o os incrementos\nfuturos da ac?a?o de controle ?u(k), ?u(k + 1), ... e ?u(k + mh ? 1).\n\nDadas as definic?o?es mostradas em (3.9), sendo l um vetor de\ndimensa?o mh \u00d71 com todos os elementos iguais a um, e D uma matriz\ntriangular inferior mh \u00d7mh com todos os elementos na?o nulos iguais a\num, e? poss??vel simplificar a notac?a?o como:\n\n??y : Conjunto de valores passados de y\n??u : Conjunto de valores passados de u\nu : u0 + ?u\nu0 : u(k ? 1)l\n?u : D?u\n\n?u : [?u(k), ?u(k + 1) ... ?u(k + mh ? 1)]T\n\n(3.9)\n\nAssim, as predic?o?es em (3.7) podem ser reescritas como segue:\n\ny? = f (??y ,??u , ?u) (3.10)\n\nUtilizando o mesmo procedimento exposto na equac?a?o (3.3), e? poss??vel\n\n\n\n52\n\nencontrar a seguinte relac?a?o:\n\ny? = f (??y ,??u ,u0) +\n?y?\n\n?u\n\n????\nu=u0\n\n?u (3.11)\n\nSubstituindo em (3.11) as equac?o?es (3.9), tem-se a equac?a?o:\n\n?y?\n\n?u\n?u =\n\n?Y?\n\n??u\n?u (3.12)\n\nFinalmente, definindo F = f (??y ,??u ,u0) e GP NMP C = ?Y???u\n???\nu=u0\n\n,\n\nsendo F o vetor de predic?o?es que seria obtido para ?u = 0 e GP NMP C\no gradiente das sa??das preditas com relac?a?o ao vetor dos incrementos de\ncontrole ?u calculado para ?u = 0, tem-se a equac?a?o (3.13), voltando\na? notac?a?o presente na equac?a?o (3.3).\n\nY? = F + GP NMP C ?u (3.13)\n\nGP NMP C e? a matriz de PNMPC, que pode ser obtida pela de-\nfinic?a?o do Jacobiano como se mostra em (3.14), que por sua vez e? a\nmatriz dina?mica generalizada e e? aplicado para sistemas lineares e na?o\nlineares.\n\nGP NMP C =\n\n?\n???????????\n\n?y?(k+1)\n??u(k)\n\n0 0 0\n\n?y?(k+2)\n??u(k)\n\n?y?(k+2)\n??u(k+1)\n\n0 0\n\n...\n...\n\n...\n...\n\n?y?(k+p)\n??u(k)\n\n?y?(k+p)\n??u(k+1)\n\n\u00b7 \u00b7 \u00b7 ?y?(k+p)\n??u(k+mh?1)\n\n?\n???????????\n\n(3.14)\n\nA forma triangular inferior da matriz GP NMP C , deve-se ao fato\ndo sistema ser causal e de se considerar que na?o ha? acoplamento direto\nentre entrada e sa??da. Em (PLUCENIO et al., 2007b) prova-se que, para\nsistemas lineares, a? matriz GP NMP C e? igual a matriz G obtida pela\nresposta ao degrau unita?rio nas te?cnicas DMC e GPC.\n\nA equac?a?o (3.13) pode ser escrita para um sistema de uma en-\ntrada e uma sa??da como se mostra na expressa?o seguinte:\n\n\n\n53\n\n?\n????\n\ny? (k + 1)\ny? (k + 2)\n\n...\ny? (k + p)\n\n?\n???? =\n\n?\n????\n\nf1(\n??y ,??u )\n\nf2(\n??y ,??u )\n\n...\nfp(\n??y ,??u )\n\n?\n???? +\n\n?\n?????\n\n?y?(k+1)\n??u(k)\n\n0 0 0\n?y?(k+2)\n??u(k)\n\n?y?(k+2)\n??u(k+1)\n\n0 0\n...\n\n...\n...\n\n...\n?y?(k+p)\n??u(k)\n\n?y?(k+p)\n??u(k+1)\n\n. . .\n?y?(k+p)\n\n??u(k+mh?1)\n\n?\n?????\n\n?u=0\n\n?\n????\n\n?u (k)\n?u (k + 1)\n\n...\n?u (k + mh ? 1)\n\n?\n????\n\n(3.15)\nNota-se em (3.15) que a forma triangular inferior da matriz Ja-\n\ncobiano deve-se a? causalidade do sistema, dado por (3.16):\n\n?y? (k + j)\n\n??u (k + i)\n= 0 para i ? j (3.16)\n\nA expressa?o (3.15) representa a equac?a?o (3.13) de forma mais\ndetalhada, onde:\n\n\u2022 Y? e? o vetor p\u00d71 contendo as predic?o?es no horizonte de predic?a?o\np.\n\n\u2022 F e? o vetor p \u00d7 1 que conte?m as sa??das preditas, supondo que\nas ac?o?es de controle no horizonte de controle mh sa?o mantidas\niguais a? ac?a?o de controle no instante k ? 1, u(k) = u(k + 1) =\n.... = u(k + mh ? 1) = u(k ? 1) .\n\n\u2022 GP NMP C e? a versa?o na?o linear da matriz dina?mica utilizada no\nControle Preditivo DMC ou a versa?o generalizada, va?lida para\nsistemas lineares ou na?o lineares (para sistemas cont??nuos e dife-\nrencia?veis). Sua dimensa?o e? p\u00d7mh.\n\n\u2022 ?u e? o vetor mh \u00d7 1 que contem os incrementos nas ac?o?es de\ncontrole no horizonte de controle mh.\n\nApesar de ser poss??vel, em alguns casos, obter-se uma expressa?o\npara a matriz GP NMP C em func?a?o da expressa?o matema?tica do modelo\nna?o-linear e procurando uma alternativa onde a montagem da matriz\nna?o dependa da estrutura matema?tica utilizada para a representac?a?o\ndo modelo, optou-se pela determinac?a?o nume?rica da matriz Jacobiana\n(PLUCENIO et al., 2007a).\n\n\n\n54\n\nDiferentemente das estrate?gias de Controle Preditivo lineares\nGPC e o DMC, nas quais a te?cnica PNMPC se baseia, o enfoque dado\npor (PLUCENIO, 2010) foi a soluc?a?o nume?rica do problema de predizer\nas sa??das futuras. Isto se deve principalmente ao fato de existir uma\ngrande quantidade de caminhos diferentes para a modelagem de proces-\nsos na?o lineares, como por exemplo: redes neurais artificiais, modelos\nNARMAX (Non-linear Auto-Regressive with Moving Average and Exo-\ngenous inputs ), etc. Assim, ao inve?s de pressupor a disponibilidade de\num modelo matema?tico do processo para se obter as predic?o?es, para\nesse propo?sito foi concebida uma estrutura compat??vel a? modelagem de\nprocessos atrave?s de algoritmos nume?ricos, aumentando a praticidade\nda te?cnica.\n\n3.1 OBTENC?A?O NUME?RICA DAS PREDIC?O?ES\n\nO algoritmo nume?rico necessa?rio para calcular as predic?o?es deve\nser capaz de fornecer as sa??das futuras Y?, quando fornecidos os valores\ndos sinais de controles e sa??das passados com o vetor de incrementos\nde controles futuros ?u. Para um sistema SISO, por exemplo, a cada\niterac?a?o executa-se o seguinte procedimento para a obtenc?a?o nume?rica\nde F e GP NMP C :\n\n1. obter o vetor p \u00d7 1, Y?0p, executando o algoritmo que modela o\nprocesso, utilizando para isso incrementos futuros nulos ?u =\n[0....0]T ;\n\n2. fazer F = Y?0p;\n\n3. obter o vetor Y?1p executando o algoritmo que modela o processo,\nutilizando para isso as entradas e sa??das passadas, com um valor ?\npequeno e na?o nulo como primeiro incremento futuro, por exem-\n\nplo,\nuk?1\n1000\n\n. Para o caso de uma entrada ?u =\n[\n? 0 . . . 0\n\n]T\n;\n\n4. fazer GP NMP C (:, 1) =\nY?1p?Y?\n\n0\np\n\n?\n, ou seja, a derivada parcial apro-\n\nximada para a sa??da e a entrada em questa?o;\n\n5. obter o vetor Y?2p executando o algoritmo que modela o processo\nutilizando para isso as entradas e sa??das passadas, com um valor\n? pequeno e na?o nulo como segundo incremento futuro, por exem-\n\nplo,\nuk?1\n1000\n\n. Para o caso de uma entrada ?u =\n[\n\n0 ? . . . 0\n]T\n\n;\n\n\n\n55\n\n6. fazer GP NMP C (:, 2) =\nY?2p?Y?\n\n0\np\n\n?\n, ou seja, a derivada parcial apro-\n\nximada para a sa??da e a entrada em questa?o;\n\n7. proceder com o mesmo ca?lculo das demais colunas da matriz\nGP NMP C ate? a u?ltima coluna onde obte?m-se o vetor Y?\n\nmh\np execu-\n\ntando o modelo com as entradas e sa??das passadas e com ?u =\n[\n0 0 ... ?\n\n]\n. GP NMP C (:,mh) =\n\nY?\nmh\np ?Y?0p\n\n?\n\nApo?s a obtenc?a?o do vetor de predic?o?es Y? da equac?a?o (3.13),\nutiliza-se o mesmo me?todo de ca?lculo nume?rico presente nos algoritmos\nGPC e DMC para a obtenc?a?o da ac?a?o de controle. E? interessante\nressaltar que no procedimento de ca?lculo de ?u, a u?nica diferenc?a do\nPNMPC perante o GPC e o DMC, e? o fato da resposta livre ser na?o\nlinear (PLUCENIO, 2010).\n\n3.2 TRATAMENTO DO ERRO DE PREDIC?A?O E PERTURBAC?A?O\n\nOs algoritmos de controle preditivo, como o DMC e o GPC,\nutilizam um mecanismo para corrigir as predic?o?es. Por exemplo, a\nte?cnica de Controle DMC corrige as predic?o?es com o erro entre o valor\nmedido da varia?vel controlada e seu valor predito com o modelo no\ninstante k (PLUCENIO, 2010). Esta te?cnica aplicada a sistemas lineares\ngarante erro nulo em regime permanente, ja? que o incremento do esforc?o\nde controle necessa?rio para a correc?a?o do erro no instante k sera? o\nmesmo nos instantes futuros, devido a? relac?a?o linear entre a entrada e\nsa??da, isto faz com o que o ganho seja constante.\n\nA aplicac?a?o deste mesmo procedimento para a te?cnica PNMPC,\naplicada a sistemas na?o lineares, na?o garante erro nulo em regime per-\nmanente, ja? que o ganho varia com o ponto de operac?a?o do sistema\n(PLUCENIO, 2010). A estrate?gia PNMPC utiliza uma versa?o expl??cita\ndo mecanismo de correc?a?o das predic?o?es utilizado pelo algoritmo GPC.\n\nPara o tratamento de erros de predic?a?o, ru??do e perturbac?o?es\nencontrado em (PLUCENIO, 2010), o algoritmo PNMPC soma a cada\npredic?a?o a integral do erro de predic?a?o filtrado. Na Figura 5, observa-\nse o diagrama de blocos para a correc?a?o das predic?o?es utilizando-se o\nalgoritmo PNMPC.\n\nO modelo de perturbac?a?o funciona como uma espe?cie de obser-\nvador, que fornece uma correc?a?o a ser adicionada a cada predic?a?o. A\nFigura 5 conte?m o diagrama de blocos desse observador utilizado no\nPNMPC, onde a cada instante de amostragem se calcula o erro entre\n\n\n\n56\n\nFigura 5 \u2013 Diagrama de Blocos para o Tratamento do Erro de Predic?a?o\nPNMPC.\n\n? ?\n1\n\nF\nD q ? ?11\n\ni\nk\n\nq\n?\n\n?\n\n? ?1scy k k ?\n\n? ?n k? ? ?1y k k? ? ? ?e k\n\n? ?y k\n\n?\n?\n\n?\n\n?\n\n1\nq\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n0\n\nFonte: (PLUCENIO, 2010).\n\na sa??da que o preditor obte?m para o instante k, y? (k |k ? 1 ) e a sa??da\nreal, y(k), conforme equac?a?o:\n\ne (k) = y (k) ? y? (k |k ? 1 ) (3.17)\nConsiderando a ana?lise para uma varia?vel controlada y(t), subs-\n\ntituindo o operador q por z e definindo DF (z) = 1 ?fdz?1, chegamos\na? func?a?o de transfere?ncia apresentada em (3.18).\n\ne(z) =\nz2 ? (1 + fd)z + fd\n\nz2 ? (1 + fd ?ki)z + fd\n(y(k) ? y?sc(k)) (3.18)\n\nonde\ny?sc(k) e? o valor da sa??da sem correc?a?o\ny(k) e? o valor real da sa??da\nSupondo que o sistema em malha fechada e? esta?vel, podemos\n\naplicar o Teorema do Valor Final para verificarmos que a presenc?a\nde (1 ? z?1) no numerador da func?a?o de transfere?ncia (3.18) garante\nerro nulo em regime permanente para uma entrada do tipo degrau de\ny(k) ? y?sc(k).\n\nO projeto de ki e fd consiste em comparar o polino?mio deno-\nminador da func?a?o de transfere?ncia (3.18) com um polino?mio desejado\npd(z) = z\n\n2 ? 2az + a2. Chegamos a igualdades que permitem escolher-\nmos o valor de a para determinar fd e ki, sendo que a escolha de a tem\nimpacto na velocidade com que o erro responde a? perturbac?a?o.\n\nfd = a\n2 (3.19)\n\n\n\n57\n\nki = 1 + a\n2 ? 2a (3.20)\n\n3.3 FUNC?A?O CUSTO\n\nUma func?a?o custo t??pica para sistemas SISO utilizada na te?cnica\nPNMPC e? apresentada na equac?a?o:\n\nJ =\n\nN1+p?1?\n\nj=N1\n\n?j(y? (k + j) ?r (k + j))2 +\nmh?1?\n\ni=0\n\n?i?u(k + i)\n2\n\n(3.21)\n\nNa equac?a?o (3.21), ?j e ?i sa?o as ponderac?o?es, respectivamente\nsobre o seguimento de refere?ncia e o esforc?o de controle. Em muitos ca-\nsos, as ponderac?o?es para o caso SISO sa?o constantes. N1 e? o nu?mero de\namostras que determina o in??cio do horizonte de predic?a?o. O problema\na ser resolvido, consiste em obter o vetor:\n\n?u = [?u (k) , ?u (k + 1) , ..., ?u (k + mh ? 1)] (3.22)\n\nque minimiza a func?a?o Custo J sujeito a restric?o?es sobre os incrementos\nde controle ?u, as ac?o?es de controle:\n\nu = [u (k) ,u (k + 1) , ...,u (k + mh ? 1)]T (3.23)\n\ne a sa??da predita:\n\ny? (k + j) = [y? (k + 1) , y? (k + 2) , ..., y? (k + p)]\nT\n\n(3.24)\n\nEm sistemas que apresentam restric?o?es na ac?a?o de controle ou\nna sa??da do sistema, a minimizac?a?o da func?a?o custo e? obtida com a\naplicac?a?o de algoritmos de programac?a?o quadra?tica (Quadratic Pro-\ngramming, QP). Para isto, manipula-se a equac?a?o (3.21) para rees-\ncreve?-la conforme equac?a?o:\n\nJ =\n1\n\n2\n?uT ??u + ?T ?u (3.25)\n\nsujeito a? A?u ? B, sendo:\n\n? = GT RG + Q\n? = GT RT (F ? r) (3.26)\n\n\n\n58\n\nna qual R e? uma matriz diagonal contendo as ponderac?o?es sobre o\nseguimento de refere?ncia ao longo do horizonte de predic?a?o, r e? o ve-\ntor contendo as trajeto?rias futuras no horizonte de predic?a?o e Q e?\numa matriz diagonal contendo as ponderac?o?es sobre o esforc?o de con-\ntrole. Tendo conhecimento das restric?o?es do sistema, basta passa?-las\npara a forma matricial e realizar a minimizac?a?o da func?a?o custo com\na utilizac?a?o de programac?a?o quadra?tica. A lei de controle resultante e?\nmostrada na equac?a?o (3.27).\n\n?u =\n(\nGT RG + Q\n\n)?1\nGT RT (F ? r) (3.27)\n\n3.4 CONCLUSA?O\n\nNeste cap??tulo apresentou-se uma discussa?o dos aspectos de im-\nplementac?a?o da te?cnica MPC Pra?tico para Sistema Na?o Lineares, o\nPNMPC, apresentado por (PLUCENIO, 2010).\n\nA te?cnica PNMPC mostra uma forma de obter uma linearizac?a?o\nque fornece uma predic?a?o com aproximac?a?o, similar a? que se obteria\ncom uma aproximac?a?o de Taylor de segunda ordem.\n\nPara a minimizac?a?o da func?a?o objetivo, pode-se continuar utili-\nzando toda a tecnologia ja? desenvolvida para sistemas lineares, como o\nja? consagrado me?todo de Programac?a?o Quadra?tica. Ale?m disso, a ob-\ntenc?a?o nume?rica da matriz GP NMP C permite a utilizac?a?o de qualquer\nestrutura de modelo. O me?todo funciona igualmente para sistemas de\numa entrada e uma sa??da como para sistemas multivaria?veis e tem a\nsua maior a?rea de aplicac?a?o em processos tipicamente na?o lineares.\n\nA semelhanc?a do me?todo com os tradicionais algoritmos de LMPC\n(Linear Model Predictive Control ) bem conhecidos no meio industrial,\ntanto no que se refere a? filosofia de projeto dos controladores quanto ao\najuste e a? sintonia do controlador, tornam o PNMPC uma ferramenta\ncom grande potencial para ser adotada na indu?stria do petro?leo e ga?s.\n\nEste trabalho baseia-se na te?cnica PNMPC. No pro?ximo cap??tulo\nsa?o apresentadas as alternativas de implementac?a?o da te?cnica PNMPC\naplicado em um estudo de caso, que foi desenvolvido ao longo deste\ntrabalho de mestrado.\n\n\n\n59\n\nCap??tulo 4\n\nIMPLEMENTAC?A?O DO PNMPC:\nALTERNATIVAS\n\nA maioria dos processos dina?micos exibe relac?o?es na?o lineares\nentre varia?veis controladas e manipuladas. Dependendo da aplicac?a?o,\no algoritmo MPC e? muitas vezes escolhido entre um tipo linear e um\ntipo na?o linear (CAMACHO; BORDONS, 2007).\n\nEste cap??tulo apresenta va?rias maneiras de implementar o al-\ngoritmo PNMPC. Mostra-se que o algoritmo PNMPC pode ser escrito\npara lidar com a na?o-linearidade em diferentes n??veis. Por uma questa?o\nde simplicidade, os algoritmos sa?o implementados para controlar o n??vel\nde um tanque co?nico. Nessa aplicac?a?o, a principal finalidade do contro-\nlador e? manipular a abertura da va?lvula de sa??da do tanque, a fim de\nseguir a refere?ncia de n??vel do tanque. O desempenho e o custo com-\nputacional de seis implementac?o?es diferentes de controlador PNMPC\nsa?o exibidos. Os resultados desses controladores sa?o comparados e ana-\nlisados pelo sistema de verificac?a?o de resposta de simulac?a?o, o tempo\nde execuc?a?o dos algoritmos do controlador PNMPC e pelos indices de\ndesempenho dos controladores.\n\n4.1 VERSO?ES DA TE?CNICA MPC PRA?TICO PARA SISTEMAS\nNA?O LINEARES (PNMPC)\n\nA teoria da te?cnica PNMPC apresentada na sec?a?o anterior pode\nser implementado de diversas formas, considerando diferentes apro-\nximac?o?es para o ca?lculo das predic?o?es de um dado processo na?o linear.\nO objetivo desta sec?a?o e? estudar o desempenho e o custo computaci-\nonal do controlador PNMPC, usando seis diferentes verso?es de imple-\n\n\n\n60\n\nmentac?a?o. Essas verso?es utilizam simplificac?o?es da te?cnica PNMPC\noriginal completa, de forma a reduzir o tempo de processamento. Vari-\nando a forma de ca?lculo das predic?o?es, o PNMPC pode ser simplificado\nate? se converter em um controlador MPC linear.\n\nPrimeiramente, e? descrito a implementac?a?o e a matema?tica com\nos algoritmos das alternativas das variac?o?es da te?cnica PNMPC para\ncada versa?o. Depois e? apresentado o estudo de caso aplicando as verso?es\ndo PNMPC, mostrando os resultados respectivamente.\n\n4.1.1 Primeira versa?o: PNMPC original completo com calculo\nde ?uini.\n\nSeguindo a teoria do PNMPC desenvolvida por Plucenio (2010)\ne descrito no Cap??tulo 3, a primeira versa?o PNMPC proposta neste tra-\nbalho considera resposta livre na?o linear e o ca?lculo da matriz GP NMP C\nem dois passos.\n\nO primeiro procedimento do algoritmo e? calcular em uma deter-\nminada iterac?a?o uma variac?a?o de controle inicial ?uini, que e? calcu-\nlada em func?a?o da matriz GP NMP C ja? existente, ou seja, da matriz\nGanterior equivalente a GP NMP C (k ? 1). Apo?s obter a variac?a?o de\ncontrole inicial, calculam-se as ac?o?es de controle futuras de acordo com\na equac?a?o:\n\nUmh\u00d71 = Hmh\u00d71u (k ? 1) + TImh\u00d7mh ?uinimh\u00d71 (4.1)\n\nonde:\n\nmh horizonte de controle;\nH vetor de uns;\nu(k ? 1) ac?a?o de controle no instante anterior;\nTI matriz Toeplitz integradora;\n?uini variac?a?o de controle inicial.\n\nCom a ac?a?o de controle U ja? calculada, obte?m-se uma sa??da predita\ninicial Y?0p.\n\nNa seque?ncia, e? realizado o ca?lculo de uma nova ac?a?o de controle,\nna qual e? aplicada um valor ?, e com esta nova ac?a?o de controle U, e?\nobtida a sa??da predita Y?. O valor ? vai-se deslocando em ?u para o\n\n\n\n61\n\nca?lculo da matriz GP NMP C , conforme descrito pela equac?a?o (4.2).\n\nGP NMP C (:,mh) =\nY?mhp ? Y?0p\n\n?\n(4.2)\n\nTendo calculada a matriz GP NMP C (k) no instante atual e a\nmatriz GP NMP C (k ? 1) calculada no instante anterior, e? poss??vel obter\na me?dia da matriz GP NMP C , que e? calculada em dois passos:\n\nGP NMP C = 0, 5[GP NMP C (k ? 1) + GP NMP C (k)] (4.3)\n\nA Figura 6 mostra a interpretac?a?o gra?fica do procedimento de\nca?lculo da matriz GP NMP C , calculada em dois passos para uma func?a?o,\nrepresentada pela linha azul tracejada. Se a posic?a?o inicial e? f (x) (re-\npresentada pelo primeiro ponto verde) para um ?uini e o ponto final\ndesejado e? f (x + ?x) (representado pelo ponto vermelho), enta?o, para\nse obter o ganho da matriz GP NMP C em f (x), e? preciso calcular a tan-\ngente neste ponto inicial, isto e? derivar f (x). Tendo a matriz GP NMP C\nja? calculada, pode-se resolver o problema de otimizac?a?o quadra?tica\npara se calcular a nova variac?a?o de controle. Com esta variac?a?o de\ncontrole, calcula-se a nova ac?a?o de controle, que e? representada pelo\nponto marrom. Nesse ponto, e? calculada a tangente da curva, a fim\nde se obter o ganho da nova matriz GP NMP C . Calculadas as matrizes\nGP NMP C (k ? 1) e GP NMP C (k), e? calculada a inclinac?a?o me?dia. A\npartir dessa inclinac?a?o me?dia, obte?m-se um novo ponto (ponto ama-\nrelo), e a tangente nesse ponto e?, enta?o, o ganho da matriz GP NMP C .\nEste novo ponto se encontra mais pro?ximo do ponto final desejado,\nficando mais pro?ximo das refere?ncias desejadas.\n\nFigura 6 \u2013 Interpretac?a?o gra?fica GP NMP C calculada em dois passos.\n\n? ?f x x??\n\n? ?f x\n\nx\n\nInclina\u00e7\u00e3o m\u00e9dia\n\n? ? ? ?PNMPC PNMPC PNMPC0, 5 k 1 k? ? ?? ?? ?G G G\n\nx x??\n\nFonte: Modificado de (PLUCENIO, 2010).\n\n\n\n62\n\nO algoritmo implementado para esta versa?o e? detalhado no flu-\nxograma da Figura 7.\n\nFigura 7 \u2013 Fluxograma do algoritmo PNMPC da primeira versa?o.\n\nD\ne\n\n 1\n a\n\nt\u00e9\n N\n\nu\nm\n\nIt\ne\n\nra\n-1\n\n- \nC\n\n\u00e1\nlc\n\nu\nlo\n\n d\na\n\n s\na\n\n\u00edd\na \n\nd\na\n\n p\nla\n\nn\nta\n\n   \n  \n\n   \n.\n\n- \nA\n\ntu\na\n\nliz\na\n\n\u00e7\u00e3\no\n\n d\na\n\ns \nre\n\nfe\nr\u00ea\n\nn\nci\n\na\ns.\n\ni=\n=\n\n1\n\n- \nO\n\nb\nt\u00e9\n\nm\n-s\n\ne\n o\n\n v\ne\n\nto\nr \n\n   \n ,\n\n e\nxe\n\ncu\nta\n\nn\nd\n\no\n o\n\na\nlg\n\no\nri\n\ntm\no\n\n q\nu\n\ne\n m\n\no\nd\n\ne\nla\n\n o\n p\n\nro\nce\n\nss\no\n\n u\nti\n\nliz\na\n\nn\nd\n\no\nin\n\ncr\ne\n\nm\ne\n\nn\nto\n\ns \nfu\n\ntu\nro\n\ns \nn\n\nu\nlo\n\ns \n   \n\n   \n  \n\n   \n  \n\n   \n   \n\n  \n.\n\n- \nC\n\n\u00e1\nlc\n\nu\nlo\n\n d\na\n\n r\ne\n\nsp\no\n\nst\na\n\n l\niv\n\nre\n s\n\ne\nm\n\n c\no\n\nrr\ne\n\n\u00e7\u00e3\no\n\n   \n   \n\n  \n  \n\n   \n .\n\n  \n\n- \nO\n\nb\nte\n\nr \no\n\n v\ne\n\nto\nr \n\nd\na\n\ns \np\n\nre\nd\n\ni\u00e7\n\u00f5\n\ne\ns,\n\n e\nxe\n\ncu\nta\n\nn\nd\n\no\n o\n\n \na\n\nlg\no\n\nri\ntm\n\no\n q\n\nu\ne\n\n m\no\n\nd\ne\n\nla\n o\n\n p\nro\n\nc\ne\n\nss\no\n\n, \nc\n\no\nm\n\n   \n  \n\ne\n  \n\n   \n \n\nco\nm\n\n u\nm\n\n v\na\n\nlo\nr \n?\n\n p\ne\n\nq\nu\n\ne\nn\n\no\n p\n\na\nra\n\n o\n c\n\n\u00e1\nlc\n\nu\nlo\n\n d\na\n\n \n\nC\n\u00e1\n\nlc\nu\n\nlo\n d\n\ne\n  \n\n  \n  c\n\no\nm\n\n o\n Q\n\nu\na\n\nd\np\n\nro\n  \n\n \n\n- \nC\n\n\u00e1\nlc\n\nu\nlo\n\n d\ne\n\n e\nrr\n\no\n:\n\n- \nC\n\n\u00e1\nlc\n\nu\nlo\n\n d\no\n\n f\na\n\nto\nr \n\nd\ne\n\n a\nju\n\nst\ne\n\n \n- \n\nC\n\u00e1\n\nlc\nu\n\nlo\n d\n\ne\n  \n\n   \n \n\n- \nC\n\n\u00e1\nlc\n\nu\nlo\n\n d\ne\n\n- \nC\n\n\u00e1\nlc\n\nu\nlo\n\n d\na\n\n r\ne\n\nsp\no\n\nst\na\n\n l\niv\n\nre\n c\n\no\nrr\n\ne\ng\n\nid\na\n\n \n\nC\n\u00e1\n\nlc\nu\n\nlo\n d\n\ne\n  \n\n  \n  \n\n   \n  \n\n e\nm\n\n f\nu\n\nn\n\u00e7\u00e3\n\no\n d\n\na\n  \n\n  \n  \n\n   \n  \n\n  \n  \n\n   \n  \n\n  \n   \n\n  \n   \n\n  \n   \n\n  \n e\n\n  \n   \n\n.\n\nC\na\n\nlc\nu\n\nla\nr\n\n- \nO\n\nb\nte\n\nr \no\n\n v\ne\n\nto\nr \n\nd\na\n\ns \np\n\nre\nd\n\ni\u00e7\n\u00f5\n\ne\ns,\n\n e\nxe\n\ncu\nta\n\nn\nd\n\no\n \n\no\n a\n\nlg\no\n\nri\ntm\n\no\n q\n\nu\ne\n\n m\no\n\nd\ne\n\nla\n o\n\n p\nro\n\nc\ne\n\nss\no\n\n, \nc\n\no\nm\n\n   \n  \n\ne\n   \n\n  \n c\n\no\nm\n\n u\nm\n\n v\na\n\nlo\nr \n?\n\n p\ne\n\nq\nu\n\ne\nn\n\no\n p\n\na\nra\n\n o\n \n\nc\u00e1\nlc\n\nu\nlo\n\n d\na\n\n \n\n- \nC\n\na\nlc\n\nu\nla\n\nr:\n\n- \nC\n\na\nlc\n\nu\nla\n\nr:\n  \n\n- \nC\n\na\nlc\n\nu\nla\n\nr \n  \n\n  \n  c\n\no\nm\n\n o\n Q\n\nu\na\n\nd\np\n\nro\n\nC\n\u00e1\n\nlc\nu\n\nlo\n d\n\na\n l\n\ne\ni \n\nd\ne\n\n c\no\n\nn\ntr\n\no\nle\n\nA\ntu\n\na\nli\n\nza\nr \n\na\ns \n\nsa\n\u00edd\n\na\ns \n\ne\n a\n\n\u00e7\n\u00f5\n\ne\ns \n\nd\ne\n\n \nco\n\nn\ntr\n\no\nle\n\n p\na\n\nss\na\n\nd\na\n\ns.\n\n i\n>\n\n1\n\nP\nN\n\nM\nP\n\nC\nG\n\nin\ni\n\n?\nu\n\n?\n?\n\nk\n1\n\n?\nG\n\nF\n\n?\n?\n\n?\n?\n\nin\ni\n\nk\nk\n\n1\n?\n\n?\n?\n?\n\nu\nu\n\nu\n\n- \nC\n\na\nlc\n\nu\nla\n\nr: ?\n?\n\nh\nm\n\n0\n\np\np\n\nP\nN\n\nM\nP\n\nC\n:\n,m\n\nh\n\n?\n?\n\n?\n\nY\nY\n\nG\n\n?\n?\n\n?\n?\n\nk\nk\n\n1\n?\n\n?\n?\n?\n\nu\nu\n\nu\n\nP\nN\n\nM\nP\n\nC\n?\n\n?\n?\n\nY\nF\n\nG\nu\n\nm\no\nd\n\nz\ny\n\ny\ne\nlo\n?\n\nSi\nm\n\nN\n\u00e3\n\no\n\nN\n\u00e3\n\no\n\nSi\nm\n\n0 p\nY\n\n0 P\n?\n\nF\nY\n\n0 p\nY\n\n0 p\n?\n\nF\nY\n\n?\n?\n\nP\nN\n\nM\nP\n\nC\n0\n,5\n\n(k\n1\n)\n\n(k\n)\n\n?\n?\n\n?\nG\n\nG\nG\n\n?\n?\n\nz\ny\n\ny\nu\n\nF\nA\n\nC\n?\n\n?\nF\n\nF\n\nF\nA\n\nC\n\ny\n\nu\n\nP\nN\n\nM\nP\n\nC\nG\n\nz\nm\n\no\nd\n\ne\nr\n\ny\ny\n\ne\nlo\n\n?\n?\n\n?\n?T\n\n0\n..\n\n..\n.0\n\n?\n?\n\nu\n\n?\nu\n\n?\n?\n\n?\n?\n\nh\nm\n\n0\n\np\np\n\nP\nN\n\nM\nP\n\nC\n:,\n\nm\nk\n\nh\n\n?\n?\n\n?\n?\n\nY\nY\n\nG\nG\n\n?\nu\n\nFonte: Pro?pria.\n\n\n\n63\n\n4.1.2 Segunda versa?o: PNMPC sem o ca?lculo de ?uini.\n\nUma das vantagens da te?cnica de controle PNMPC e? a sua flexi-\nbilidade, ja? que permite o tratamento de processos tanto lineares como\nna?o lineares. No entanto, essa flexibilidade pode acarretar em cus-\ntos computacionais desnecessa?rios. Assim, pode-se fazer uma ana?lise\npre?via de processo que se tem a fim de adequar a te?cnica PNMPC\nao tipo de processo ao qual esta? sendo aplicada. Por exemplo, se\nexiste processo com caracter??stica na?o linear muito importante, e? re-\ncomenda?vel optar pela te?cnica PNMPC original completa com ?uini\n(primeira versa?o). Por outro lado, se o processo apresenta uma na?o\nlinearidade suave, pode-se optar por reduzir o custo computacional,\neliminando o ca?lculo de ?uini.\n\nCom o objetivo de diminuir a carga computacional do algoritmo,\npropo?e-se uma versa?o de matriz GP NMP C calculada em um u?nico\npasso. Nessa versa?o, o ca?lculo do incremento da ac?a?o de controle inicial\n?uini e? eliminado. Para isto, utiliza-se o valor da variac?a?o do controle\nda iterac?a?o anterior para calcular a ac?a?o de controle requerida para\nobter Y?0p. Assim, e? calculada a matriz GP NMP C obtida no instante de\namostragem anterior, em um u?nico passo, conforme apresentado pela\nFigura 8.\n\nFigura 8 \u2013 Interpretac?a?o gra?fica GP NMP C calculada em um u?nico\npasso.\n\n? ?f x x??\n\n? ?f x\n\nx\n\n? ?PNMPC PNMPC k?G G\n\nx x??\n\nFonte: Modificado de (PLUCENIO, 2010).\n\nO fato de eliminar o ca?lculo de ?uini diminui a precisa?o com\n\n\n\n64\n\na qual o PNMPC calcula a GP NMP C , ja? que ?uini influencia direta-\nmente no ca?lculo da Y?0p, que esta? explicitamente envolvida no ca?lculo\nda matriz GP NMP C .\n\nO algoritmo desta segunda versa?o e? apresentado no fluxograma\nda Figura 9:\n\nFigura 9 \u2013 Fluxograma do algoritmo PNMPC da segunda versa?o.\n\nD\ne\n\u00a01\n\u00a0a\nt\u00e9\n\u00a0N\nu\nm\nIt\ne\nra\n?1\n\n?\u00a0\nC\n\u00e1\nlc\nu\nlo\n\u00a0d\na\n\u00a0s\na\n\u00edd\na\n\u00a0d\na\n\u00a0p\nla\nn\nta\n\u00a0\u00a0\n\u00a0\u00a0\n\u00a0\u00a0\n\u00a0\u00a0\n.\n\n?\u00a0\nA\ntu\na\nli\nza\n\u00e7\u00e3\no\n\u00a0d\na\ns\u00a0\nre\nfe\nr\u00ea\nn\nci\na\ns.\n\ni=\n=\n1\n\n?\u00a0\nO\nb\nt\u00e9\nm\n?s\ne\n\u00a0o\n\u00a0v\ne\nto\nr\u00a0\n\u00a0\u00a0\u00a0\n\u00a0,\n\u00a0e\nxe\ncu\nta\nn\nd\no\n\u00a0o\n\na\nlg\no\nri\ntm\n\no\n\u00a0q\nu\ne\n\u00a0m\n\no\nd\ne\nla\n\u00a0o\n\u00a0p\nro\nce\nss\no\n\u00a0u\nti\nli\nza\nn\nd\no\n\nin\ncr\ne\nm\ne\nn\nto\ns\u00a0\nfu\ntu\nro\ns\u00a0\nn\nu\nlo\ns\u00a0\n\u00a0\u00a0\n\u00a0\u00a0\n\u00a0\u00a0\u00a0\n\u00a0\u00a0\n\u00a0\u00a0\n\u00a0\u00a0\n\u00a0\u00a0\n\u00a0\u00a0\u00a0\n\u00a0\u00a0\n\u00a0.\n\n?\u00a0\nC\n\u00e1\nlc\nu\nlo\n\u00a0d\na\n\u00a0r\ne\nsp\no\nst\na\n\u00a0l\niv\nre\n\u00a0s\ne\nm\n\u00a0c\no\nrr\ne\n\u00e7\u00e3\no\n\n\u00a0\u00a0\n\u00a0\u00a0\n\u00a0\u00a0\u00a0\n\u00a0\u00a0\n\u00a0\u00a0\u00a0\n\u00a0\u00a0\n.\u00a0\n\u00a0\n\n?\u00a0\nO\nb\nte\nr\u00a0\no\n\u00a0v\ne\nto\nr\u00a0\nd\na\ns\u00a0\np\nre\nd\ni\u00e7\n\u00f5\ne\ns,\n\u00a0e\nxe\ncu\nta\nn\nd\no\n\u00a0o\n\u00a0\n\na\nlg\no\nri\ntm\n\no\n\u00a0q\nu\ne\n\u00a0m\n\no\nd\ne\nla\n\u00a0o\n\u00a0p\nro\nce\nss\no\n,\u00a0\nco\nm\n\u00a0\u00a0\u00a0\n\u00a0\u00a0e\n\u00a0\u00a0\n\u00a0\u00a0\u00a0\n\u00a0\n\nco\nm\n\u00a0u\nm\n\u00a0v\na\nlo\nr\u00a0\n?\n\u00a0p\ne\nq\nu\ne\nn\no\n\u00a0p\na\nra\n\u00a0o\n\u00a0c\n\u00e1\nlc\nu\nlo\n\u00a0d\na\n\u00a0\n\nC\n\u00e1\nlc\nu\nlo\n\u00a0d\ne\n\u00a0\u00a0\n\u00a0\u00a0\n\u00a0\u00a0c\no\nm\n\u00a0o\n\u00a0Q\nu\na\nd\np\nro\n\u00a0\u00a0\n\u00a0\n\n?\u00a0\nC\n\u00e1\nlc\nu\nlo\n\u00a0d\ne\n\u00a0e\nrr\no\n:\n\n?\u00a0\nC\n\u00e1\nlc\nu\nlo\n\u00a0d\no\n\u00a0f\na\nto\nr\u00a0\nd\ne\n\u00a0a\nju\nst\ne\n\u00a0\n\n?\u00a0\nC\n\u00e1\nlc\nu\nlo\n\u00a0d\ne\n\u00a0\u00a0\u00a0\n\u00a0\u00a0\u00a0\n\n?\u00a0\nC\n\u00e1\nlc\nu\nlo\n\u00a0d\ne\n\n?\u00a0\nC\n\u00e1\nlc\nu\nlo\n\u00a0d\na\n\u00a0r\ne\nsp\no\nst\na\n\u00a0l\niv\nre\n\u00a0c\no\nrr\ne\ng\nid\na\n\n\u00a0\n\n?\u00a0\nO\nb\nte\nr\u00a0\no\n\u00a0v\ne\nto\nr\u00a0\nd\na\ns\u00a0\np\nre\nd\ni\u00e7\n\u00f5\ne\ns,\n\u00a0e\nxe\ncu\nta\nn\nd\no\n\u00a0o\n\u00a0\n\na\nlg\no\nri\ntm\n\no\n\u00a0q\nu\ne\n\u00a0m\n\no\nd\ne\nla\n\u00a0o\n\u00a0p\nro\nce\nss\no\n,\u00a0\nco\nm\n\u00a0\u00a0\u00a0\n\u00a0e\n\u00a0\u00a0\u00a0\n\u00a0\u00a0\u00a0\n\nco\nm\n\u00a0u\nm\n\u00a0v\na\nlo\nr\u00a0\n?\n\u00a0p\ne\nq\nu\ne\nn\no\n\u00a0p\na\nra\n\u00a0o\n\u00a0c\n\u00e1\nlc\nu\nlo\n\u00a0d\na\n\u00a0\n\n   \n   \n\n   \n   \n\n   \n  \n\n   \n   \n\n   \n   \n\n   \n  .\n\n?\u00a0\nC\na\nlc\nu\nla\nr:\n\n?\u00a0\nC\na\nlc\nu\nla\nr\u00a0\n\u00a0\u00a0\u00a0\n\u00a0\u00a0\u00a0\nco\nm\n\u00a0o\n\u00a0Q\nu\na\nd\np\nro\n.\n\nC\n\u00e1\nlc\nu\nlo\n\u00a0d\na\n\u00a0le\ni\u00a0\nd\ne\n\u00a0c\no\nn\ntr\no\nle\n\nA\ntu\na\nli\nza\nr\u00a0\na\ns\u00a0\nsa\n\u00edd\na\ns\u00a0\ne\n\u00a0a\n\u00e7\u00f5\ne\ns\u00a0\nd\ne\n\u00a0\n\nco\nn\ntr\no\nle\n\u00a0p\na\nss\na\nd\na\ns.\n\n\u00a0i\n>\n1\n\nP\nN\nM\nP\nC\n\nG\n\n?\u00a0\nC\na\nlc\nu\nla\nr: ?\n\n?\nh\n\nm\n0\n\np\np\n\nP\nN\nM\nP\nC\n:,\nm\n\nh\n\n?\n?\n\n?\n\nY\nY\n\nG\n?\n\n?\n\n?\n?\n\n?\n?\n\nk\nk\n\n1\n?\n\n?\n?\n?\n\nu\nu\n\nu\n\nP\nN\nM\nP\nC\n\n?\n?\n\n?\nY\n\nF\nG\n\nu\n?\n\nm\no\nd\n\nz\ny\n\ny\nel\n\no\n?\n\nS\nim\n\nN\n\u00e3\no\n\nN\n\u00e3\no\n\nS\nim\n\n0 p\nY?\n\n0 P\n?\n\nF\nY?\n\n0 p\nY?\n\n0 p\n?\n\nF\nY?\n\n?\n?\n\nz\ny\n\ny?\nu?\n\nF\nA\nC\n\n?\n?\n\nF\nF\n\nF\nA\nC\n\ny?\nu?\n\nPN\nM\n\nPC\nG\n\nz\nm\no\nd\n\ner\ny\n\ny\nel\n\no\n?\n\n?\n\n?\n?T\n\n0\n..\n..\n.0\n\n?\n?\n\nu\n\n?\nu\n\n?\n?\n\nh\nm\n\n0\np\n\np\nP\nN\nM\nP\nC\n:,\nm\n\nh\n\n?\n?\n\n?\n\nY\nY\n\nG\n?\n\n?\n\n?\nu\n\nFonte: Pro?pria.\n\n\n\n65\n\n4.1.3 Terceira versa?o: PNMPC obtendo so? a primeira coluna\nda matriz GP NMP C.\n\nConforme descrito por Camacho e Bordons (2007), a matriz\nG e? a encarregada de guardar os valores da dina?mica do processo e\nGP NMP C e? a versa?o na?o linear da matriz dina?mica utilizada no MPC\npra?tico para sistemas na?o lineares PNMPC (PLUCENIO, 2010). A ma-\ntriz GP NMP C , tambe?m denominada matriz Jacobiana, como apresen-\ntado na sec?a?o 1.1.1 e 1.1.2. (primeira e segunda versa?o) respetivamente,\nsa?o calculados todos os elementos da matriz GP NMP C iterativamente,\ndando como resultado um custo computacional elevado. Como o obje-\ntivo de diminuir ainda mais o custo computacional, uma das possibi-\nlidades e? calcular somente os elementos da primeira coluna da matriz\nGP NMP C pelo procedimento normal do PNMPC e montar a matriz\nGP NMP C , considerando o sistema como invariante no tempo, o que\ne? comumente realizado em sistemas lineares (KEYSER, 1998). Desta\nforma, o problema de otimizac?a?o na?o linear pode ser transformado\nnuma seque?ncia de problemas de otimizac?a?o linear. Para realizar esse\nprocedimento, e? preciso verificar a variac?a?o dos elementos da diago-\nnal principal da matriz GP NMP C . No caso onde as variac?o?es na?o sa?o\nsignificativas, pode-se optar pela te?cnica utilizada nos sistemas linea-\nres, realizar apenas o ca?lculo da primeira coluna da matriz GP NMP C e\ndesloca?-la ate? obter uma matriz triangular inferior, conforme equac?a?o\n(4.4).\n\n?Y?\n\n??u\n= GP NMP C =\n\n?\n???????????\n\n?y?(k+1)\n??u(k)\n\n0 0 0\n\n?y?(k+2)\n??u(k)\n\n?y?(k+1)\n??u(k)\n\n\u00b7 \u00b7 \u00b7 0\n\n...\n... \u00b7 \u00b7 \u00b7 0\n\n?y?(k+p)\n??u(k)\n\n?y?(k+p?1)\n??u(k)\n\n\u00b7 \u00b7 \u00b7 ?y?(k+1)\n??u(k)\n\n?\n???????????\n\n(4.4)\n\nNo caso de um processo na?o linear, os elementos das diago-\nnais da matriz GP NMP C apresentam variac?o?es significativas. Assim,\ne? necessa?rio realizar o ca?lculo para cada um dos elementos da matriz\nGP NMP C , como e? mostrado na equac?a?o (4.5). Este procedimento de\nca?lculo e? realizado a cada iterac?a?o, o que implica num incremento no\ncusto computacional. No entanto, no caso de um processo linear ou\n\n\n\n66\n\num processo com uma na?o linearidade suave, os elementos das diago-\nnais da matriz GP NMP C na?o sofrem modificac?o?es significativas. Dessa\nforma, pode-se optar por diminuir o custo computacional, aplicando a\nterceira versa?o do PNMPC, onde a matriz GP NMP C e? calculada com\na equac?a?o (4.4). Nesta versa?o, so? os elementos da primeira coluna da\nmatriz GP NMP C sa?o calculados e esta e? deslocada mh vezes, ate? se ob-\nter uma matriz triangular inferior, onde mh e? o horizonte de controle.\nO fato de so? calcular a primeira coluna, faz com que o sistema seja tra-\ntado como um sistema onde as relac?o?es entre as predic?o?es na?o lineares\ne os controles futuros sa?o invariantes no tempo. Se o sistema verifica\nesta propriedade, o custo computacional para o ca?lculo de GP NMP C\ndiminui razoavelmente.\n\n?Y?\n\n??u\n= GP NMP C =\n\n?\n???????????\n\n?y?(k+1)\n??u(k)\n\n0 0 0\n\n?y?(k+2)\n??u(k)\n\n?y?(k+2)\n??u(k+1)\n\n\u00b7 \u00b7 \u00b7 0\n\n...\n... \u00b7 \u00b7 \u00b7 0\n\n?y?(k+p)\n??u(k)\n\n?y?(k+p)\n??u(k+1)\n\n\u00b7 \u00b7 \u00b7 ?y?(k+p)\n??u(k+mh?1)\n\n?\n???????????\n\n(4.5)\n\n4.1.4 Quarta versa?o: PNMPC obtendo so? a primeira coluna\nda matriz GP NMP C recalculada de tempos em tempos.\n\nEsta versa?o e? similar a? terceira versa?o, so? que agora a matriz\nGP NMP C e? recalculada somente de tempos em tempos e na?o assim a\ncada iterac?a?o.\n\nEsta versa?o e? uma opc?a?o muito interessante e flex??vel. Assim\ncomo na versa?o anterior, esta quarta versa?o pode ser aplicada em um\nprocesso linear ou em um processo com uma na?o linearidade suave. A\ndiferenc?a entre esta versa?o e a terceira, e? a periodicidade do ca?lculo\nda primeira coluna da matriz GP NMP C . Nesta versa?o, este ca?lculo e?\nrealizada a cada n iterac?o?es, e na?o a cada iterac?a?o.\n\nO operador, com conhecimento do processo e do grau de na?o\nlinearidade que este apresenta, pode ajustar o valor de n para cada\naplicac?a?o.\n\nA dificuldade na utilizac?a?o desta versa?o se encontra na escolha do\n\n\n\n67\n\nvalor de n. Uma escolha inadequada pode produzir perda de informac?a?o\nde parte da dina?mica do processo. Por outro lado, a vantagem desta\nversa?o e? a reduc?a?o do custo computacional, ja? que a matriz GP NMP C\ne? recalculada so? de tempos em tempos.\n\n4.1.5 Quinta versa?o: PNMPC calculando a resposta livre de\ntempos em tempos, utilizando o DMC-Recursivo.\n\nA quinta versa?o do PNMPC procura-se a resposta livre de tem-\npos em tempos, utilizando a ideia proposto por Cutler e Remarker\n(1980)(DMC-Recursivo), para outros instantes de amostragem. A res-\nposta livre e? calculado de forma recursiva a cada n iterac?o?es. Para as\noutras iterac?o?es a resposta livre e? calculado da forma como PNMPC.\n\nEsta versa?o procura diminuir o custo computacional em pro-\ncessos onde a na?o linearidade na?o e? significativa, inserindo na te?cnica\nPNMPC, o ca?lculo da resposta livre como e? feito no DMC-Recursivo.\n\nComo apresentado nas verso?es anteriores, a resposta livre no\nPNMPC utiliza o modelo na?o linear para determinar a resposta livre.\nDessa forma, obte?m-se o vetor Y?0p, de dimensa?o p \u00d7 1 executando o\nalgoritmo que modela o processo, utilizando incrementos futuros nulos,\nisto e?, ?u = [0....0]T .\n\nNa quinta versa?o, a resposta livre se torna linear e o ca?lculo da\nresposta forc?ada na?o muda. A resposta forc?ada e? calculado a cada\niterac?a?o como apresentados no Cap??tulo 3, e nas verso?es 1 e 2 deste\nCap??tulo, o que faz se tornar o controlador linear para as n iterac?o?es.\n\nConforme apresentado no Cap??tulo 2, o ca?lculo da resposta livre\nconsiderada no DMC-Recursivo e? realizado atrave?s da equac?a?o:\n\nYlivre = [y0 (t |t? 1 ) , ...,y0 (t + N ? 1 |t ? 1)]T (4.6)\n\nAo iniciar a execuc?a?o do algoritmo DMC- Recursivo no instante t, e?\npreciso atualizar o vetor da resposta livre, pois o incremento da ac?a?o\nde controle ?u (t? 1) agora e? conhecido. O vetor Ylivre da equac?a?o\n(4.7) e? atualizado.\n\nYlivre = Ylivre +\n\n?\n????\n\ng1\ng2\n...\ngN\n\n?\n???? ?u (t? 1) (4.7)\n\n\n\n68\n\nApo?s obter o novo sinal de controle u(t), e? preciso deslocar os valores\ndentro do vetor Ylivre. Isto porque no instante posterior t + 1, sera?o\nnecessa?rias respostas livres de t + 1 ate? t + N. Assim, o novo vetor\nYlivre sera? dado pela equac?a?o (4.8):\n\nYlivre =\n\n?\n??????\n\ny0 (t + 1 |t)\ny0 (t + 2 |t)\n\n...\ny0 (t + N ? 1 |t)\ny0 (t + N ? 1 |t)\n\n?\n??????\n\n(4.8)\n\nDessa forma, o ca?lculo da resposta livre f considerada no DMC-\nRecursivo e? realizado atrave?s da equac?a?o:\n\nf =\n\n?\n??\ny0 (t + 1 |t)\n\n...\ny0 (t + p |t)\n\n?\n?? + 1p\u00d71e (4.9)\n\nO erro entre a sa??da medida e a sa??da predita em malha aberta no\ninstante k e? usado para corrigir as predic?o?es de cada estado de todos\nos elementos dentro do horizonte de predic?a?o p. Nesse caso, a equac?a?o\ndo erro do modelo de predic?a?o e?:\n\ne = ym(t) ?y0 (t |t) (4.10)\n\nA representac?a?o das predic?o?es, considerando o ca?lculo da res-\nposta livre com o DMC de forma recursiva, e? obtida com a equac?a?o\n(4.11):\n\nY? = f + G?u (4.11)\n\nUtilizando esta forma de implementac?a?o, os ca?lculos necessa?rios\npara obter a resposta livre se tornam mais simples, na?o sendo necessa?rio\no armazenamento dos incrementos passados de controle. Com este\nprocedimento, so? e? alterado o modo de calcular a resposta livre, o\nrestante do algoritmo de controle na?o e? modificado.\n\n\n\n69\n\n4.1.6 Sexta versa?o: PNMPC com reavaliac?a?o da matriz GP NMP C\ne a resposta livre (DMC-Recursivo), conforme o erro de\npredic?a?o.\n\nA ideia desta versa?o, e? trabalhar com o valor do erro de modelo\nde predic?a?o. Para isso, cria-se uma faixa de trabalho aceita?vel como se\nmostra na Figura 10, ou seja, define-se um valor de erro de predic?a?o\nadmiss??vel (\u00b1e). Para isso, a cada iterac?a?o, e? calculado o valor absoluto\ndo erro de predic?a?o. Se o valor absoluto do erro de predic?a?o se encontra\ndentro da faixa admiss??vel, o ca?lculo da matriz GP NMP C e da resposta\nlivre na?o e? efetuado. Nesse caso, sa?o usados os valores da iterac?a?o\nanterior para a matriz GP NMP C e a resposta livre.\n\nFigura 10 \u2013 Faixa de erro de predic?a?o admiss??vel.\n\n+e\n\n?e\n\ny\n\nu\n\nFonte: Pro?pria.\n\n4.2 ESTUDO DE CASO: TANQUE CO?NICO\n\nPara demonstrar a aplicac?a?o das verso?es de implementac?a?o da\nte?cnica PNMPC apresentadas nas sec?o?es anteriores, e? considerado um\nprocesso com dina?mica na?o linear. A fim de simplificar a demonstrac?a?o,\no controle de n??vel do tanque co?nico (sistema SISO) e? usado.\n\nOs tanques comumente encontrados na indu?stria sa?o de tipo re-\ntangular, cil??ndrico, co?nico ou esfe?rico, podendo ser abertos ou fecha-\ndos. Nos tanques retangulares, a a?rea transversal e? constante em toda\nfaixa de variac?a?o do n??vel. Mas isso na?o acontece nos tanques de tipo\ncil??ndricos, esfe?ricos ou co?nicos, cujas sec?o?es transversais mudam com\na altura do l??quido no interior do tanque, ocasionando mudanc?as no\nganho total do processo. Esta caracter??stica e? utilizada em testes de\nsistemas de controle de processos na?o lineares (MORAES et al., 2013).\n\n\n\n70\n\nPara realizar a modelagem do sistema, considera-se o tanque\nco?nico apresentado pela Figura 11:\n\nFigura 11 \u2013 Tanque co?nico.\n\nQin\n        \n                \n\n    R\n\n r\n\nh H\n\n  Qo\n\nFonte: Pro?pria.\n\nonde:\n\nQin vaza?o de entrada;\nQo vaza?o da sa??da;\nR raio ma?ximo do tanque co?nico;\nr raio interno (varia?vel) do tanque co?nico;\nH altura ma?xima do tanque co?nico;\nh altura interna (varia?vel) do tanque co?nico.\n\nFazendo a ana?lise do balanc?o de massas, tem-se a seguinte equac?a?o:\n\nQin ?Qo = A\ndh\n\ndt\n(4.12)\n\nonde a a?rea da sec?a?o transversal do tanque A pode ser descrita por:\n\nA = ?\n\n[\nr ? (R?r)\n\n(\nh\n\nH\n\n)]2\n(4.13)\n\n\n\n71\n\nA vaza?o de sa??da, Qo pode ser expressa pela equac?a?o:\n\nQo = CvUc\n?\nh (4.14)\n\nonde:\n\nCv coeficiente da capacidade do fluxo da va?lvula de sa??da;\nUc sinal de controle da va?lvula de sa??da.\n\nSubstituindo as equac?o?es (4.13) e (4.14) em (4.12), tem-se a\nequac?a?o diferencial na?o linear que descreve o comportamento dina?mico\ndo tanque co?nico:\n\ndh\n\ndt\n=\n\nQin ?CvUc\n?\nh\n\n?\n[\nr ? (R?r)\n\n(\nh\nH\n\n)]2 (4.15)\n\nNesse modelo, a vaza?o de entrada, Qin, e? tratada como uma\nperturbac?a?o ao sistema. Por outro lado, a varia?vel manipulada e? o sinal\nde controle da va?lvula de sa??da Uc, e a varia?vel controlada a altura do\ntanque co?nico h.\n\nNo presente estudo, sera?o utilizados os dados apresentados na\nTabela 1.\n\nTabela 1 \u2013 Para?metros do tanque co?nico.\nPara?metros Valor\n\nCv 0,04\nH 5 m\nR 1 m\n\nAs simulac?o?es sera?o realizadas em duas faixas: uma para alturas\ninferiores a 1 m e a outra para alturas superiores a 1 m. Isso com a\nfinalidade de avaliar o desempenho dos controladores com dina?micas\nra?pidas e dina?micas lentas. No primeiro teste, com refere?ncias maiores\nque 1 m para o n??vel do tanque, o tanque apresenta um comportamento\nmais lento, levando a? escolha de um tempo de amostragem de 10 s. No\nsegundo teste, com refere?ncias menores que 1 m para o n??vel do tanque,\na dina?mica e? muito mais ra?pida, levando a? adoc?a?o de um per??odo de\namostragem de 1 s.\n\nA perturbac?a?o na vaza?o de entrada Qin para refere?ncias supe-\nriores a 1 m, foi calculada com o sistema em equil??brio ( dh\n\ndt\n= 0) a partir\n\nda equac?a?o (4.15), obtendo como resultado a equac?a?o (4.16)\n\n\n\n72\n\nQin = CvUc\n?\nh0 (4.16)\n\nConsiderando uma altura em equil??brio (h0) de 1 m e o Uc = 0,5 o\nQin usado para refere?ncia superiores a 1 m e? 0, 02 m\n\n3/min. Para re-\nfere?ncias inferiores a 1 m o Qin usado e? 0, 09 m\n\n3/min. Esses valores\nde perturbac?o?es de entrada sa?o aplicados nas simulac?o?es para as seis\nverso?es.\n\n4.3 RESULTADOS\n\nUm dos objetivos deste trabalho e? apresentar diversas maneiras\nde implementar o algoritmo PNMPC. Este algoritmo pode ser escrito\npara lidar com a na?o-linearidade em diferentes n??veis. Por uma questa?o\nde simplicidade, os algoritmos sa?o implementados para controlar o n??vel\nde um tanque co?nico. A principal finalidade do controlador e? manipular\na abertura da va?lvula de sa??da, a fim de seguir o n??vel de refere?ncia.\n\nNo modelo matema?tico obtido na sec?a?o anterior, sa?o avaliados\nos controladores das verso?es do PNMPC descritos nas sec?o?es 4.1.1 a?\n4.1.6.\n\nNesta sec?a?o, sa?o exibidos o desempenho e o custo computacional\ndas seis verso?es do controlador PNMPC. Os resultados dos controlado-\nres sa?o comparados e analisados pelo sistema de verificac?a?o de resposta,\no tempo de execuc?a?o do algoritmo e o desempenho do controlador.\n\nComo a finalidade de avaliar o custo computacional exigido pela\nimplementac?a?o da te?cnica PNMPC, sera?o mostrados os tempos obti-\ndos no ca?lculo do algoritmo para cada versa?o do PNMPC aplicado ao\ncontrole de n??vel para o tanque co?nico.\n\nTodas as simulac?o?es foram realizadas no Matlab, versa?o 2014,\nem um PC com a seguinte configurac?a?o: processador A8 de 4 nu?cleos,\nAMD de 1,9 GHz; 6 GB de RAM; e sistema operacional Windows 8.\n\nAinda para conseguir comparar as diferentes verso?es das estrate?gias\nPNMPC, foram comparadas todas as verso?es atrave?s dos ??ndices de de-\nsempenho do controlador, o MSE (mean squared error ) e o IAE (integral\nof the absolute magnitude of the error ).\n\nPrimeiramente, para obter uma aproximac?a?o precisa do modelo,\nfoi utilizado o me?todo de integrac?a?o atrave?s da func?a?o ode45 do pacote\ncomputacional do Matlab. Esta func?a?o e? baseada em um algoritmo do\ntipo Runge-Kutta, que foi desenvolvido a partir do me?todo de Euler.\n\nPor motivos de comparac?a?o, os para?metros do controlador PNMPC\nsa?o os mesmos para todas as verso?es. Estes valores sa?o mostrados na\n\n\n\n73\n\nTabela 2.\n\nTabela 2 \u2013 Para?metros de sintonia do controlador PNMPC\nPara?metros Definic?a?o Valor\n\np horizonte de predic?a?o 12\nmh horizonte de controle 3\nN horizonte de modelo 20\n? ponderac?a?o no controle 3\n? ponderac?a?o no seguimento da refere?ncia 1\n? filtro da refere?ncia 0,25\n? valor na variac?a?o de controle 0,01\na para?metro no fator de ajuste 0,15\n\nOs processos reais apresentam variac?o?es relacionadas a qualquer\nmodelo proposto para representa?-lo, e essas variac?o?es podem ser dadas\npor diversas fontes de incertezas. As mais comuns sa?o: ru??dos, per-\nturbac?o?es na?o mensura?veis e erros na modelagem do processo. A fim\nde simular o processo que represente a realidade, foi inserida uma incer-\nteza de 65% nos para?metros do modelo que representa o tanque co?nico.\nEssa variac?a?o pode causar problemas relacionados a? estabilidade ou\nviolac?o?es de restric?o?es, no caso de controladores preditivos.\n\nAle?m do seguimento de refere?ncia, deseja-se a rejeic?a?o de per-\nturbac?o?es do tipo constante. Isso e? poss??vel atrave?s de um modelo\nde perturbac?a?o incorporado no esquema de predic?a?o mostrado na Fi-\ngura 5. No modelo de perturbac?a?o adotado originalmente no PNMPC,\nobte?m-se uma estimativa das incertezas futuras atrave?s de um obser-\nvador particular, que realiza um tratamento do erro de predic?a?o no\ninstante anterior. Assim, percebe-se que o erro de predic?a?o do instante\nanterior e? filtrado para se obter uma correc?a?o para as predic?o?es futuras.\n\nE? importante considerar restric?o?es no sistema, ja? que todos os\nprocessos esta?o sujeitos a limitac?o?es. E? imposto a restric?a?o meca?nica\nno atuador, que esta? limitada pela capacidade meca?nica de abertura\ne fechamento, assim como pela velocidade de resposta que geralmente\nsa?o considerados nos limites na amplitude do sinal de controle como\nobservado na equac?a?o:\n\numin ? u (t) ? umax ?t (4.17)\nA seguir, se apresentam as respostas das simulac?o?es para cada\n\nversa?o das implementac?o?es do PNMPC.\nPara observar a resposta obtida com cada uma das verso?es mostra-\n\n\n\n74\n\nse o n??vel do tanque de cada simulac?a?o\n\n4.3.1 Primeira versa?o: PNMPC original completo com ?uini\n\nComo descrito na sec?a?o 4.1.1 o primeira versa?o, o ca?lculo da\nmatriz GP NMP C e? realizado em dois passos, capturando a dina?mica\ndo processo com mais precisa?o. No entanto, o fato de utilizar a res-\nposta livre na?o linear, linearizar a cada passo e obter uma me?dia dessa\nresposta faz com que o ca?lculo apresente maior complexidade e maior\ncusto computacional.\n\nNa Figura 12, mostram-se as respostas das simulac?o?es obtidas\ncom a implementac?a?o desta versa?o para refere?ncias com alturas supe-\nriores a 1 m Figuras (a), (c), (e) e (g) e para alturas inferiores a 1 m\nFiguras (b), (d), (f) e (h). Nessas figuras yr representa a refere?ncias do\nsistema, y1 e? a sa??da da planta obtida aplicando a primeira versa?o, U1\ne? a ac?a?o de controle que representa a abertura da va?lvula e por u?ltimo\nErro1 e? a diferenc?a entre a sa??da da planta (yz) e o modelo de predic?a?o\n(ymod).\n\nNas Figuras (a) e (b) mostra-se que ambas simulac?o?es conseguem\nbom seguimento de refere?ncias e? rejeic?a?o a? perturbac?a?o.\n\n\n\n75\n\nFigura 12 \u2013 Simulac?a?o da primeira versa?o do PNMPC.\n\n0 5 10 15 20 25\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\nT empo [mi n]\n\nN\niv\n\nel\n[m\n\n] yr\ny1\n\nPerturba\u00e7\u00e3o de entrada\n\nPerturba\u00e7\u00e3o de sa\u00edda\n\n(a) Sa??da para ref>1m\n\n0 0.5 1 1.5\n0\n\n0.5\n\n1\n\nTempo [min]\n\nN\niv\n\ne\nl [\n\nm\n]\n\ny\nr\n\ny\n1\n\nPerturba\u00e7\u00e3o de entrada\n\nPerturba\u00e7\u00e3o de sa\u00edda\n\n(b) Sa??da para ref<1m\n\n0 5 10 15 20 25\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nTempo [min]\n\nA\np\ner\nt.\nV\na\nlv\nu\nla\n\nU1\n\n(c) Ac?a?o de controle para ref>1m\n\n0 0.5 1 1.5\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nTempo [min]\n\nA\np\n\ne\nrt\n\n.V\na\n\nlv\nu\n\nla\n\nU\n1\n\n(d) Ac?a?o de controle para ref<1m\n\n0 5 10 15 20 25\n0\n\n0.005\n\n0.01\n\n0.015\n\n0.02\n\n0.025\n\nTempo [min]\n\nQ\nin\n[m\n\n3\n/\ns]\n\nQin\n\n(e) Perturbac?a?o para ref>1m\n\n0 0.5 1 1.5\n0\n\n0.01\n\n0.02\n\nTempo [min]\n\nQ\nin\n\n[m\n3\n/s\n\n]\n\nQ\nin\n\n(f) Perturbac?a?o para ref<1m\n\n0 5 10 15 20 25\n\n-0.1\n\n0\n\n0.1\n\n0.2\n\nTempo [min]\n\nE\nrr\no\n\nErro1 = yz ? ymod\n\n(g) Sinais de Erro para ref>1m\n\n0 0.5 1 1.5\n-0.15\n\n-0.1\n\n-0.05\n\n0\n\n0.05\n\n0.1\n\nTempo [min]\n\nE\nrr\n\no\n\nErro\n1\n\n= y\nz\n\n- y\nmod\n\n(h) Sinais de Erro para ref<1m\n\nFonte: Pro?pria.\n\n\n\n76\n\nComo um dos objetivo deste trabalho e? mostrar o tempo de\nexecuc?a?o, o algoritmo foi rodado 10 vezes. Na Tabela 3, mostra-se o\ntempo de execuc?a?o para o algoritmo da primeira versa?o. Os tempos\nesta?o em segundos e sa?o medidos para cada rodada. Na tabela sa?o\napresentados o tempo total (T.total) das 10 rodadas e o tempo me?dio\nde execuc?a?o (T. me?dio), para refere?ncias com alturas superiores a 1 m\ne alturas inferiores a 1 m.\n\nTabela 3 \u2013 Tempo de execuc?a?o do algoritmo para a primeira versa?o do\nPNMPC.\n\nExecuc?a?o\nT. execuc?a?o (s)\n\nyr > 1 m\nT. execuc?a?o (s)\n\nyr &lt;1 m\n\n1 40,22 32,39\n2 39,58 30,84\n3 38,89 30,77\n4 38,95 31,26\n5 39,18 31,12\n6 39,09 32,51\n7 39,12 31,27\n8 39,15 32,24\n9 39,19 32,02\n10 38,98 32,50\n\nT. total [s] 392,35 316,92\nT. me?dio [s] 39,23 31,69\n\n4.3.2 Segunda versa?o: PNMPC sem o ca?lculo de ?uini\n\nComo foi descrito na sec?a?o 4.1.2, nesta versa?o o ca?lculo da ma-\ntriz GP NMP C e? realizado em um u?nico passo, eliminando o ca?lculo de\n?uini. Da mesma forma que na primeira versa?o, para a segunda versa?o\nforam feitos dois testes para avaliar o desempenho do controlador e o\ntempo de execuc?a?o. A estrutura e nomenclatura das figuras desta sec?a?o\ne? similar a? sec?a?o 4.3.1 com a diferenc?a que y2 e? a sa??da da planta obtida\naplicando a segunda versa?o e U2 e? a ac?a?o de controle.\n\n\n\n77\n\nFigura 13 \u2013 Simulac?a?o da segunda versa?o do PNMPC.\n\n0 5 10 15 20 25\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\nT empo [mi n]\n\nN\niv\n\nel\n[m\n\n] yr\ny2\n\nPerturba\u00e7\u00e3o de entrada\n\nPerturba\u00e7\u00e3o de sa\u00edda\n\n(a) Sa??da para ref>1m\n\n0 0.5 1 1.5\n\nN\niv\n\ne\nl [\n\nm\n]\n\n0\n\n0.5\n\n1\n\nTempo [min]\n\ny\nr\n\ny\n2Perturba\u00e7\u00e3o de entrada\n\nPerturba\u00e7\u00e3o de sa\u00edda\n\n(b) Sa??da para ref<1m\n\n0 5 10 15 20 25\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nTempo [min]\n\nA\np\ner\nt.\nV\na\nlv\nu\nla\n\nU2\n\n(c) Ac?a?o de controle para ref>1m\n\n0 0.5 1 1.5\n\nA\np\n\ne\nrt\n\n.V\na\n\nlv\nu\n\nla\n\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nTempo [min]\n\nU\n2\n\n(d) Ac?a?o de controle para ref<1m\n\n0 5 10 15 20 25\n0\n\n0.005\n\n0.01\n\n0.015\n\n0.02\n\n0.025\n\nTempo [min]\n\nQ\nin\n[m\n\n3\n/\ns]\n\nQin\n\n(e) Perturbac?a?o para ref>1m\n\n0 0.5 1 1.5\n0\n\n0.01\n\n0.02\n\nTempo [min]\n\nQ\nin\n\n[m\n3\n/s\n\n]\n\nQ\nin\n\n(f) Perturbac?a?o para ref<1m\n\n0 5 10 15 20 25\n-0.1\n\n-0.05\n\n0\n\n0.05\n\n0.1\n\nTempo [min]\n\nE\nrr\no\n\nErro2 = yz ? ymod\n\n(g) Sinais de Erro para ref>1m\n\n0 0.5 1 1.5\n-0.15\n\n-0.1\n\n-0.05\n\n0\n\n0.05\n\n0.1\n\n0.2\n\nTempo [min]\n\nE\nrr\n\no\n\nErro\n2\n\n= y\nz\n\n- y\nmod\n\n(h) Sinais de Erro para ref<1m\n\nFonte: Pro?pria.\n\n\n\n78\n\nNas Figuras (a) e (b), mostra-se que tanto para refere?ncias su-\nperiores a 1 m quanto para refere?ncias inferiores a 1 m as simulac?o?es\napresentam bom seguimento de refere?ncias e? rejeic?a?o a? perturbac?a?o.\n\nNa Tabela 4, sa?o apresentados os tempos de execuc?a?o obtidos\npara o algoritmo desta versa?o.\n\nTabela 4 \u2013 Tempo de execuc?a?o do algoritmo para a segunda versa?o do\nPNMPC.\n\nExecuc?a?o\nT. execuc?a?o (s)\n\nyr > 1 m\nT. execuc?a?o (s)\n\nyr &lt;1 m\n\n1 38,19 31,43\n2 38,29 30,45\n3 38,43 29,44\n4 38,19 29,56\n5 38,36 29,46\n6 38,51 29,31\n7 38,64 29,76\n8 38,58 29,90\n9 38,75 29,60\n10 38,50 29,55\n\nT. Total [s] 384,44 298,46\nT. me?dio [s] 38,44 29,85\n\n4.3.3 Terceira versa?o: PNMPC obtendo so? a primeira coluna\nda matriz GP NMP C.\n\nNesta versa?o o sistema e? tratado como se fosse invariante no\ntempo, mas para isso e? preciso verificar o grau de variac?a?o que apresen-\ntam os elementos das diagonais principais da matriz GP NMP C , como\nfoi explicado na sec?a?o 4.1.3.\n\nPara verificar se e? poss??vel aplicar a terceira versa?o neste es-\ntudo de caso, o primeiro passo e? pegar va?rias matrizes GP NMP C em\niterac?o?es aleato?rias, observando o grau da na?o linearidade do sistema.\nNa Figura 14, mostram-se os elementos da matriz GP NMP C da iterac?a?o\n25, escolhida aleatoriamente. Nesta matriz, observa-se que o sistema\napresenta uma na?o linearidade suave, ja? que os elementos das diagonais\nprincipais da matriz GP NMP C na?o apresentam variac?o?es significativas,\ncaracter??stica que foi repetida em matrizes de outras iterac?o?es. Dessa\n\n\n\n79\n\nforma e? poss??vel aplicar a terceira versa?o neste estudo de caso.\n\nFigura 14 \u2013 Matriz GP NMP C da iterac?a?o 25.\n\nFonte: Pro?pria.\n\nA seguir, calcula-se a primeira coluna da matriz GP NMP C . Enta?o,\nela e? deslocada ate? se obter uma matriz triangular inferior, como se\nmostra na Figura 15. Nesta versa?o, o sistema e? tratado como se fosse\ninvariante no tempo.\n\n\n\n80\n\nFigura 15 \u2013 Matriz GP NMP C invariante no tempo.\n\nFonte: Pro?pria.\n\nOs gra?ficos das simulac?o?es desta versa?o sa?o apresentados na Fi-\ngura 16, onde pode-se observar que o desempenho do controlador na?o\nfoi comprometido, obtendo seguimento de refere?ncia e rejeic?a?o a? per-\nturbac?a?o. Na Tabela 5, sa?o apresentados os tempos de execuc?a?o desta\nversa?o.\n\n\n\n81\n\nFigura 16 \u2013 Simulac?a?o da terceira versa?o do PNMPC.\n\n0 5 10 15 20 25\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\nT empo [mi n]\n\nN\niv\n\nel\n[m\n\n] yr\ny3\n\nPerturba\u00e7\u00e3o de entrada\n\nPerturba\u00e7\u00e3o de sa\u00edda\n\n(a) Sa??da para ref>1m\n\n0 0.5 1 1.5\n0\n\n0.5\n\n1\n\nTempo [min]\n\nN\niv\n\ne\nl [\n\nm\n]\n\ny\nr\n\ny\n3\n\nPerturba\u00e7\u00e3o de entrada\n\nPerturba\u00e7\u00e3o de sa\u00edda\n\n(b) Sa??da para ref<1m\n\n0 5 10 15 20 25\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nTempo [min]\n\nA\np\ner\nt.\nV\na\nlv\nu\nla\n\nU3\n\n(c) Ac?a?o de controle para ref>1m\n\n0 0.5 1 1.5\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nTempo [min]\n\nA\np\n\ne\nrt\n\n.V\na\n\nlv\nu\n\nla\n\nU\n3\n\n(d) Ac?a?o de controle para ref<1m\n\n0 5 10 15 20 25\n0\n\n0.005\n\n0.01\n\n0.015\n\n0.02\n\n0.025\n\nTempo [min]\n\nQ\nin\n[m\n\n3\n/\ns]\n\nQin\n\n(e) Perturbac?a?o para ref>1m\n\n0 0.5 1 1.5\n0\n\n0.01\n\n0.02\n\nTempo [min]\n\nQ\nin\n\n[m\n3\n/s\n\n]\n\nQ\nin\n\n(f) Perturbac?a?o para ref<1m\n\n0 5 10 15 20 25\n-0.2\n\n-0.1\n\n0\n\n0.1\n\n0.2\n\nTempo [min]\n\nE\nrr\no\n\nErro3 = yz ? ymod\n\n(g) Sinais de Erro para ref>1m\n\n0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6\n\n-0.1\n\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\nTempo [min]\n\nE\nrr\n\no\n\nErro\n3\n\n= y\nz\n\n- y\nmod\n\n(h) Sinais de Erro para ref<1m\n\nFonte: Pro?pria.\n\n\n\n82\n\nTabela 5 \u2013 Tempo de execuc?a?o do algoritmo para a terceira versa?o do\nPNMPC\n\nExecuc?a?o\nT. execuc?a?o (s)\n\nyr > 1 m\nT. execuc?a?o (s)\n\nyr &lt;1 m\n\n1 40,22 23,62\n2 25,66 21,47\n3 25,67 20,23\n4 25,66 20,46\n5 25,88 20,23\n6 25,62 20,22\n7 25,71 20,25\n8 25,77 20,20\n9 25,69 20,40\n10 25,72 20,31\n\nT. total [s] 257,17 207,39\nT. me?dio [s] 25,72 20,74\n\n4.3.4 Quarta versa?o: PNMPC obtendo so? a primeira coluna\nda matriz GP NMP C recalculada de tempos em tempos.\n\nNesta versa?o, o ca?lculo da primeira coluna da matriz GP NMP C\ne? realizado de tempos em tempos, ou seja, a cada n iterac?o?es. Neste\nestudo de caso, considerou-se n = 25.\n\nNa Figura 17, sa?o apresentadas respostas obtidas com as si-\nmulac?o?es para esta versa?o e na Tabela 6, os tempos de execuc?a?o.\nAna?loga a? versa?o anterior, o desempenho do controlador na?o foi com-\nprometido, a diferenc?a esta? no tempo requerido para os ca?lculos da\nmatriz GP NMP C . Como esperado, os tempos de execuc?a?o sa?o menores\nque os obtidos com a terceira versa?o na?o comprometendo o seguimento\nda refere?ncia e a rejeic?a?o da perturbac?a?o. No entanto, percebe-se que\npara refere?ncias inferiores a 1 m o controlador apresenta uma maior difi-\nculdade para seguimento das refere?ncias em comparac?a?o com a terceira\nversa?o.\n\n\n\n83\n\nFigura 17 \u2013 Simulac?a?o da quarta versa?o do PNMPC.\n\n0 5 10 15 20 25\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\nT empo [mi n]\n\nN\niv\n\nel\n[m\n\n] yr\ny4\n\nPerturba\u00e7\u00e3o de entrada\n\nPerturba\u00e7\u00e3o de sa\u00edda\n\n(a) Sa??da para ref>1m\n\n0 0.5 1 1.5\n0\n\n0.5\n\n1\n\nTempo [min]\n\nN\niv\n\ne\nl [\n\nm\n]\n\ny\nr\n\ny\n4\n\nPerturba\u00e7\u00e3o de entrada\n\nPerturba\u00e7\u00e3o de sa\u00edda\n\n(b) Sa??da para ref<1m\n\n0 5 10 15 20 25\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nTempo [min]\n\nA\np\ner\nt.\nV\na\nlv\nu\nla\n\nU4\n\n(c) Ac?a?o de controle para ref>1m\n\n0 0.5 1 1.5\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nTempo [min]\n\nA\np\n\ne\nrt\n\n.V\na\n\nlv\nu\n\nla\n\nU\n4\n\n(d) Ac?a?o de controle para ref<1m\n\n0 5 10 15 20 25\n0\n\n0.005\n\n0.01\n\n0.015\n\n0.02\n\n0.025\n\nTempo [min]\n\nQ\nin\n[m\n\n3\n/\ns]\n\nQin\n\n(e) Perturbac?a?o para ref>1m\n\n0 0.5 1 1.5\n0\n\n0.01\n\n0.02\n\nTempo [min]\n\nQ\nin\n\n[m\n3\n/s\n\n]\n\nQ\nin\n\n(f) Perturbac?a?o para ref<1m\n\n0 5 10 15 20 25\n-0.1\n\n-0.05\n\n0\n\n0.05\n\n0.1\n\nTempo[min]\n\nE\nrr\no\n\nErro4 = yz ? ymod\n\n(g) Sinais de Erro para ref>1m\n\n0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6\n-0.15\n\n-0.1\n\n-0.05\n\n0\n\n0.05\n\n0.1\n\n0.15\n\n0.2\n\n0.25\n\nTempo [min]\n\nE\nrr\n\no\n\nErro\n4\n\n= y\nz\n\n- y\nmod\n\n(h) Sinais de Erro para ref<1m\n\nFonte: Pro?pria.\n\n\n\n84\n\nTabela 6 \u2013 Tempo de execuc?a?o do algoritmo para a quarta versa?o do\nPNMPC.\n\nExecuc?a?o\nT. execuc?a?o (s)\n\nyr > 1 m\nT. execuc?a?o (s)\n\nyr &lt;1 m\n\n1 19,37 16,01\n2 19,11 15,64\n3 19,18 15,60\n4 19,16 15,59\n5 19,07 15,47\n6 19,23 15,59\n7 19,21 15,81\n8 19,16 15,86\n9 19,22 15,84\n10 19,07 15,60\n\nT. total [s] 191,80 157,01\nT. me?dio [s] 19,18 15,70\n\n4.3.5 Quinta versa?o: PNMPC calculando a resposta livre de\ntempos em tempos, utilizando o DMC-Recursivo.\n\nNas simulac?o?es desta versa?o, o ca?lculo da resposta livre e? reali-\nzado a cada 35 iterac?o?es. Os resultados das simulac?o?es sa?o apresentados\nna Figura 18 e na Tabela 7.\n\nComo a resposta livre nesta versa?o torna-se linear a cada 35\niterac?o?es, nota-se que o controlador realiza maior esforc?o para reagir\na?s perturbac?o?es tanto para refere?ncias inferiores a 1 m quanto para\nrefere?ncias superiores a 1 m.\n\n\n\n85\n\nFigura 18 \u2013 Simulac?a?o da quinta versa?o do PNMPC.\n\n0 5 10 15 20 25\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\nT empo [mi n]\n\nN\niv\n\nel\n[m\n\n] yr\ny5\n\nPerturba\u00e7\u00e3o de sa\u00edda\n\nPerturba\u00e7\u00e3o de entrada\n\n(a) Sa??da para ref>1m\n\n0 0.5 1 1.5\n0\n\n0.5\n\n1\n\nTempo [min]\n\nN\niv\n\ne\nl [\n\nm\n]\n\ny\nr\n\ny\n5\n\nPerturba\u00e7\u00e3o \nde sa\u00edda\n\nPerurba\u00e7\u00e3o de entrada\n\n(b) Sa??da para ref<1m\n\n0 5 10 15 20 25\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nTempo [min]\n\nA\np\ner\nt.\nV\na\nlv\nu\nla\n\nU5\n\n(c) Ac?a?o de controle para ref>1m\n\n0 0.5 1 1.5\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nTempo [min]\n\nA\np\n\ne\nrt\n\n.V\na\n\nlv\nu\n\nla\n\nU\n5\n\n(d) Ac?a?o de controle para ref<1m\n\n0 5 10 15 20 25\n0\n\n0.005\n\n0.01\n\n0.015\n\n0.02\n\n0.025\n\nTempo [min]\n\nQ\nin\n[m\n\n3\n/\ns]\n\nQin\n\n(e) Perturbac?a?o para ref>1m\n\n0 0.5 1 1.5\n0\n\n0.01\n\n0.02\n\nTempo [min]\n\nQ\nin\n\n[m\n3\n/s\n\n]\n\nQ\nin\n\n(f) Perturbac?a?o para ref<1m\n\n0 5 10 15 20 25\n\n-0.2\n\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\nTempo[min]\n\nE\nrr\no\n\nErro5 = yz ? ymod\n\n(g) Sinais de Erro para ref>1m\n\n0 0.5 1 1.5\n\n-0.4\n\n-0.2\n\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\nTempo [min]\n\nE\nrr\n\no\n\nErro\n5\n\n= y\nz\n\n- y\nmod\n\n(h) Sinais de Erro para ref<1m\n\nFonte: Pro?pria.\n\n\n\n86\n\nTabela 7 \u2013 Tempo de execuc?a?o do algoritmo para a quinta versa?o do\nPNMPC.\n\nExecuc?a?o\nT. execuc?a?o (s)\n\nyr > 1 m\nT. execuc?a?o (s)\n\nyr &lt;1 m\n\n1 29,44 28,81\n2 29,99 28,21\n3 30,00 28,02\n4 29,23 28,26\n5 29,07 28,46\n6 29,05 28,37\n7 29,02 28,11\n8 29,05 28,90\n9 29,09 28,83\n10 29,49 28,18\n\nT. total [s] 293,43 284,15\nT. me?dio [s] 29,34 28,41\n\n4.3.6 Sexta versa?o: PNMPC com reavaliac?a?o da matriz GP NMP C\ne a resposta livre (DMC-Recursivo), conforme o erro de\npredic?a?o.\n\nA sexta versa?o trabalha com um valor de erro de predic?a?o ad-\nmiss??vel, o erro de predic?a?o e? o erro existente entre a sa??da e o modelo.\nEsta versa?o foi aplicada no estudo de caso considerando um erro ad-\nmiss??vel de 0,017, ou seja, a resposta livre de forma recursiva e a matriz\nGP NMP C sa?o calculados quando o erro se encontra fora da faixa ad-\nmiss??vel de erro. As respostas das simulac?o?es para esta versa?o sa?o apre-\nsentadas na Figura 19 e na Tabela 8. Como pode-se observar na figura,\no controlador nesta versa?o, apresenta maior dificuldade na rejeic?a?o das\nperturbac?o?es em comparac?a?o com a quinta versa?o.\n\n\n\n87\n\nFigura 19 \u2013 Simulac?a?o da sexta versa?o do PNMPC.\n\n0 5 10 15 20 25\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\nT empo [mi n]\n\nN\niv\n\nel\n[m\n\n] yr\ny6\n\nPerturba\u00e7\u00e3o\u00e1de\u00e1entrada\n\nPerturba\u00e7\u00e3o\u00e1de\u00e1s\u00e1ida\n\n(a) Sa??da para ref>1m\n\n0 0.5 1 1.5\n0\n\n0.5\n\n1\n\nTempo [min]\n\nN\niv\n\ne\nl [\n\nm\n]\n\ny\nr\n\ny\n6Perurba\u00e7\u00e3o de entrada\n\nPerturba\u00e7\u00e3o \nde sa\u00edda\n\n(b) Sa??da para ref<1m\n\n0 5 10 15 20 25\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nTempo [min]\n\nA\np\ner\nt.\nV\na\nlv\nu\nla\n\nU6\n\n(c) Ac?a?o de controle para ref>1m\n\n0 0.5 1 1.5\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nTempo [min]\n\nA\np\n\ne\nrt\n\n.V\na\n\nlv\nu\n\nla\n\nU\n6\n\n(d) Ac?a?o de controle para ref<1m\n\n0 5 10 15 20 25\n0\n\n0.005\n\n0.01\n\n0.015\n\n0.02\n\n0.025\n\nTempo [min]\n\nQ\nin\n[m\n\n3\n/\ns]\n\nQin\n\n(e) Perturbac?a?o para ref>1m\n\n0 0.5 1 1.5\n0\n\n0.01\n\n0.02\n\nTempo [min]\n\nQ\nin\n\n[m\n3\n/s\n\n]\n\nQ\nin\n\n(f) Perturbac?a?o para ref<1m\n\n0 5 10 15 20 25\n-0.2\n\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\nTempo[min]\n\nE\nrr\no\n\nErro6 = yz ? ymod\n\n(g) Sinais de Erro para ref>1m\n\n0 0.5 1 1.5\n\n-0.2\n\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\nTempo [min]\n\nE\nrr\n\no\n\nErro\n6\n\n= y\nz\n\n- y\nmod\n\n(h) Sinais de Erro para ref<1m\n\nFonte: Pro?pria.\n\n\n\n88\n\nTabela 8 \u2013 Tempo de execuc?a?o do algoritmo para a sexta versa?o do\nPNMPC.\n\nExecuc?a?o\nT. execuc?a?o (s)\n\nyr > 1 m\nT. execuc?a?o (s)\n\nyr &lt;1 m\n\n1 27,53 23,40\n2 27,70 23,19\n3 27,66 24,30\n4 27,56 23,03\n5 27,45 22,90\n6 27,66 23,02\n7 27,48 22,82\n8 27,70 23,05\n9 27,68 22,95\n10 27,79 23,00\n\nT. total [s] 276,22 231,66\nT. me?dio [s] 27,62 23,17\n\n4.4 CONCLUSA?O\n\nNeste cap??tulo, foram apresentadas seis alternativas de imple-\nmentar o algoritmo PNMPC. Para avaliar o desempenho dos controla-\ndores, estes foram aplicados em um estudo de caso.\n\nComparando os resultados obtidos na Figura 20, pode-se ob-\nservar que os seis algoritmos implementados te?m uma resposta muito\nsimilar. Apesar de que o algoritmo completo apresenta os melhores\nresultados e todos conseguirem reagir a? perturbac?a?o adequadamente, a\ndiferenc?a entre eles e? o tempo de execuc?a?o. Isto pode ser atribu??do a? que\na na?o linearidade do processo e? suave. Assim, um estudo do compor-\ntamento do processo pode levar a uma implementac?a?o com ganhos em\ntermos de tempo de processamento sem prejudicar de forma importante\no desempenho do controlador. No entanto, percebe-se que na medida\nem que o modelo representa o processo com menos qualidade a resposta\na perturbac?a?o fica pior pelo que a escolha entre tempo de execuc?a?o ou\ndesempenho do controlador depende de cada processo, pode que neste\nestudo de caso a diferenc?a possa ser aceita?vel, no entanto, em outro\nprocesso a diferenc?a poderia ser impactante.\n\n\n\n89\n\nFigura 20 \u2013 Comparac?o?es das verso?es do PNMPC: sa??das, ac?o?es de\ncontrole, perturbac?o?es e sinais dos erros.\n\n0 5 10 15 20 25\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\nTempo[min]\n\nN\niv\nel\n[m\n] yr\n\ny1\ny2\ny3\ny4\ny5\ny6\n\n(a) Sa??das para ref>1m\n\n0 0.5 1 1.5\n0\n\n0.5\n\n1\n\n1.5\n\nTempo[min]\nN\niv\nel\n[m\n]\n\nyr\ny1\ny2\ny3\ny4\ny5\ny6\n\n(b) Sa??das para ref<1m\n\n0 5 10 15 20 25\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nTempo[min]\n\nA\np\ner\nt.\nV\na\nlv\nu\nla\n\nU1\nU2\nU3\nU4\nU5\nU6\n\n(c) Ac?o?es de controle para ref>1m\n\n0 0.5 1 1.5\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nTempo[min]\n\nA\np\ner\nt.\nV\na\nlv\nu\nla\n\nU1\nU2\nU3\nU4\nU5\nU6\n\n(d) Ac?o?es de controle para ref<1m\n\n0 5 10 15 20 25\n0\n\n0.005\n\n0.01\n\n0.015\n\n0.02\n\n0.025\n\nTempo [min]\n\nQ\nin\n[m\n\n3\n/\ns]\n\nQin\n\n(e) Perturbac?a?o para ref>1m\n\n0 0.5 1 1.5\n0\n\n0.01\n\n0.02\n\nTempo [min]\n\nQ\nin\n\n[m\n3\n/s\n\n]\n\nQ\nin\n\n(f) Perturbac?a?o para ref<1m\n\nFonte: Pro?pria.\n\n\n\n90\n\nComo pode-se observar na Tabela 9 e na Tabela 10, conside-\nrando as verso?es 2, 3, 4, 5, 6 e? poss??vel obter uma reduc?a?o do custo\ncomputacional se comparado a? versa?o 1, o que era o esperado, ja? que\ncom cada uma das diferentes abordagens o nu?mero de iterac?o?es dos\nciclos de ca?lculo, ou seja, da matriz GP NMP C , do ca?lculo da variac?a?o\nde controle ou da resposta livre sa?o reduzidos em comparac?a?o com a\nprimeira versa?o.\n\nTabela 9 \u2013 Tabela comparativa dos tempos de execuc?a?o para refere?ncias\nsuperiores a 1 m.\n\nExecuc?a?o 1a versa?o 2a versa?o 3a versa?o 4a versa?o 5a versa?o 6a versa?o\n\n1 40,22 38,19 25,78 19,37 29,44 27,53\n2 39,58 38,29 25,66 19,11 29,99 27,67\n3 38,89 38,43 25,67 19,18 30,00 27,66\n4 38,95 38,19 25,66 19,16 29,23 27,56\n5 39,18 38,36 25,88 19,07 29,07 27,45\n6 39,09 38,51 25,62 19,23 29,05 27,66\n7 39,12 38,64 25,71 19,21 29,02 27,48\n8 39,15 38,58 25,77 19,16 29,05 27,70\n9 39,19 38,75 25,69 19,22 29,09 27,68\n10 38,98 38,50 25,71 19,07 29,45 27,79\n\nT. total [s] 392,35 384,44 257,17 191,80 293,43 276,22\nT. me?dio [s] 39,23 38,44 25,72 19,18 29,34 27,62\n\nTabela 10 \u2013 Tabela comparativa dos tempos de execuc?a?o para re-\nfere?ncias inferiores a 1 m.\n\nExecuc?a?o 1a versa?o 2a versa?o 3a versa?o 4a versa?o 5a versa?o 6a versa?o\n\n1 32,39 31,43 23,62 16,01 28,81 23,40\n2 30,84 30,45 21,47 15,64 28,21 23,19\n3 30,77 29,44 20,23 15,60 28,02 24,30\n4 31,26 29,56 20,46 15,59 28,26 23,03\n5 31,12 29,46 20,23 15,47 28,46 22,90\n6 32,51 29,31 20,22 15,59 28,37 23,02\n7 31,27 29,76 20,25 15,81 28,11 22,82\n8 32,24 29,90 20,20 15,86 28,90 23,05\n9 32,02 29,60 20,40 15,84 28,83 22,95\n10 32,50 29,55 20,31 15,60 28,18 23,00\n\nT. total [s] 316,92 298,46 207,39 157,01 284,15 231,66\nT. me?dio [s] 31,69 26,85 20,74 15,70 28,41 23,17\n\nPara avaliar o desempenho dos controladores, foram obtidos os\n??ndices de desempenho MSE (Mean Squared Error ) e IAE (Integral of\nthe Absolute Magnitude of the Error ) para todas as verso?es do PNMPC\npara valores de refere?ncias superiores a 1 m. Os ??ndices de desempenho\n\n\n\n91\n\nsa?o mostrados na Tabela 11. O que era esperado pode-se confirmar na\nTabela 11, a versa?o que apresentou melhor desempenho e? a primeira,\na qual possui a resposta livre na?o linear, a matriz GP NMP C calculada\nem dois passos e fazendo uma me?dia (GP NMP C ) a cada iterac?a?o, faz\ncom que o sistema seja tratado com maior precisa?o.\n\nTabela 11 \u2013 I?ndices de desempenho do controlador das seis verso?es do\nPNMPC para refere?ncias superiores a 1 m.\n\nI. desempenho 1a versa?o 2a versa?o 3a versa?o 4a versa?o 5a versa?o 6a versa?o\nMSE 0,0031 0,0040 0,0063 0,0085 0,0100 0,0096\nIAE 2,58 3,40 4,56 4,77 5,89 5,07\n\n\n\n92\n\n\n\n93\n\nCap??tulo 5\n\nCONTROLE PREDITIVO BASEADO EM\nMODELO COM PASSO DE\n\nESTABILIDADE\n\nNeste cap??tulo, apresenta-se uma outra estrate?gia para lidar com\nerros nos ganhos, as constantes de tempos e principalmente erros de\natrasos de transporte nos modelos. A retroalimentac?a?o e? capaz de li-\ndar com erros nos ganhos e nas constantes de tempo. No entanto, os\nerros no atraso de transporte podem causar oscilac?o?es nas varia?veis do\nprocesso e, em casos extremos, sa?o capazes de instabilizar a planta,\nmesmo para sistemas esta?veis em malha aberta. Uma alternativa para\no tratamento dos erros de predic?a?o e? a aplicac?a?o de filtros no erro de\npredic?a?o, com o objetivo de melhorar a estabilidade do sistema sob\ncontrole e oferecer robustez na planta frente aos erros de modelo. Esse\nconceito foi desenvolvido a partir das ideias do Preditor de Smith Fil-\ntrado, apresentado em Normey e Camacho (2007) e mostrado na Figura\n21.\n\nDa Figura 21 se obte?m a func?a?o de transfere?ncia em malha fe-\nchada entre a sa??da e a perturbac?a?o e? dada pela expressa?o:\n\nY (s)\n\nd (s)\n= P (s)\n\n(\n1 ? C (s) P (s) F (s)\n\n1 + C (s) Gn (s)\n\n)\n(5.1)\n\nonde:\nC (s) controlador;\nP (s) planta real;\nF (s) filtro;\nGn (s) modelo;\nY (s) sa??da da planta;\nd (s) perturbac?a?o.\n\n\n\n94\n\nFigura 21 \u2013 Preditor de Smith Filtrado.\n\nFonte: (NORMEY; CAMACHO, 2007).\n\nO projeto do filtro F (S) e? uma possibilidade de introduzir ro-\nbustez e rejeic?a?o a? perturbac?a?o, entretanto, na?o se pode obter robustez\ne rejeic?a?o a? perturbac?a?o simultaneamente (PLUCENIO et al., 2014).\n\nUm outro trabalho aplicando o filtro no erro de predic?a?o, e? pro-\nposto em Lima, Normey e Plucenio (2014), onde e? utilizada a estrate?gia\nDMC-Recursivo apresentada no cap??tulo 2 na sec?a?o 2.2.3. E? poss??vel\nfiltrar o erro de predic?a?o separadamente e adiciona?-lo a? predic?a?o de\nmalha aberta yo:\n\ny? (t + k | t) =\nk?\n\ni=1\n\ngi? (t + k ? i)+yo (t + k | t)+F\n(\nz?1\n)\n\n(ym (t) ?yo (t | t))\n\n(5.2)\nNo qual o erro do modelo e?:\n\ne = ym(t) ?y0 (t |t) (5.3)\n\nO efeito do filtro e? ana?logo ao me?todo utilizado no algoritmo\nDTC-GPC descrito em Normey e Camacho (2007). A ide?ia de aplicar\num filtro no erro de predic?a?o para corrigir as predic?o?es pode ser apli-\ncada a outros algoritmos MPC, como GPC, DMC e PNMPC, dentre as\nte?cnicas de controle preditivo na?o linear proposto por Plucenio (2010).\n\nControladores onde o filtro e? projetado para robustez apresentam\num comportamento lento, na?o conseguindo rejeitar as perturbac?o?es.\nUma maneira de mostrar isso e? utilizando a expressa?o para o ca?lculo\nda ac?a?o de controle nos algoritmos de controle MPCs. Utilizando uma\nexpressa?o cla?ssica do MPC para o algoritmo DMC (CAMACHO; BOR-\n\n\n\n95\n\nDONS, 2007), pode-se escrever o vetor de incremento de ac?a?o de controle\n?u como:\n\n?u = K (W ? F)\ncom\n\nK =\n(\nGT RG + Q\n\n)?1\nGT R\n\nF = Fsc + Ef\n\n(5.4)\n\nOnde\n\nW vetor das refere?ncias;\nG matriz dina?mica ou Jacobiana;\nR matriz de ponderac?a?o do seguimento da refere?ncia;\nQ matriz de ponderac?a?o no controle;\nFsc vetor da resposta livre sem correc?a?o;\nEf vetor do erro de predic?a?o filtrado.\n\nO Erro de predic?a?o filtrado pode ser escrito como:\n\nEf (k) = ?Ef (k ? 1) + (1 ??) E (k) (5.5)\nOnde escolhendo ? entre 0 e 1 (0 ? ? &lt;1), obte?m-se o filtro discreto\nprojetado para garantir estabilidade em casos de erros no modelo de\npredic?a?o para um caso SISO. O erro E (k) e? a diferenc?a entre o ve-\ntor com a varia?vel controlada medida Y (k) e o vetor com a varia?vel\ncontrolada predita Y? (k), mostrado na equac?a?o (5.6).\n\nE (k) = Y (k) ? Y? (k) (5.6)\nSubstituindo as equac?o?es (5.5) e (5.6) nas expresso?es da equac?a?o\n\n(5.4), a ac?a?o de controle pode ser escrita como:\n\n?u = K\n(\nW ? Fsc ??Ef (k ? 1) ? (1 ??)\n\n(\nY (k) ? Y? (k)\n\n))\n(5.7)\n\nConsiderando que o sistema atingiu o regime permanente, temos\nque:\n\nW = Y (k ? 1)\nY (k ? 1) = Fsc + E\nFsc = Y (k ? 1) ? E\n\n(5.8)\n\nSubstituindo as expresso?es da equac?a?o (5.8) em (5.7) se tem a\n\n\n\n96\n\nequac?a?o (5.9):\n\n?u = K\n(\n\n(1 ??) E ? (1 ??)\n(\nY (k) ? Y? (k)\n\n))\n(5.9)\n\nNormalmente, Y (k) ? Y? (k) seria igual a E no instante k em\nregime permanente, o que levaria a ?u = 0. Entretanto, supondo que\nno instante k ingresa uma perturbac?a?o na?o modelada d (k). Nesse caso\ntem-se:\n\n?u = K\n(\n\n(1 ??) E ? (1 ??)\n(\nY (k) + d (k) ? Y? (k)\n\n))\n\n?u = K ((1 ??) E ? (1 ??) (E + d (k)))\n?u = K ((1 ??) E ? (1 ??) E ? (1 ??) d (k))\n?u = ?K (1 ??) d (k)\n\n(5.10)\n\nA ac?a?o de controle para atuar na perturbac?a?o d (k) e? calculada a partir\nde (1 ??) d (k). Isto torna a resposta da rejeic?a?o a? perturbac?a?o extre-\nmamente lenta quando ? e? grande. Entretanto, isto ocorre quando\nse tem grandes erros no atraso de transporte utilizado no modelo de\npredic?a?o.\n\nA aplicac?a?o de um filtro no erro de predic?a?o e? uma alternativa\nque visa modificar o erro de predic?a?o, melhorando a robustez frente aos\nerros do modelo. Esta abordagem tem seus benef??cios, mas, um pro-\nblema inevita?vel e? que tem-se que conhecer a priori o erro aproximado\ndo atraso de transporte para obter o melhor benef??cio com a te?cnica\nde filtragem. Ale?m disso, muita filtragem (? grande) no sistema pode\nresultar numa resposta mais lenta a perturbac?o?es.\n\nCom base no resultado da ana?lise do comportamento do filtro\nfrente a perturbac?o?es, apresenta-se neste cap??tulo o me?todo proposto\npor Plucenio et al. (2014), para o tratamento de erros de predic?a?o em\nplantas esta?veis em malha aberta, utilizando o segundo me?todo de esta-\nbilidade de Lyapunov. Deriva-se um sinal que e? somado a? predic?a?o, com\no objetivo de fornecer estabilidade e bom desempenho do controlador\nfrente a erros do modelo e perturbac?o?es inseridas no sistema.\n\nNeste trabalho, apresenta-se a comparac?a?o do me?todo aplicando\no filtro no erro de predic?a?o e o me?todo proposto por Plucenio et al.\n(2014). Nesta te?cnica, nenhum filtro e? utilizado. Em vez disso, o\nalgoritmo MPC com passo de estabilidade propo?e tratar o problema\nem duas etapas:\n\n1. Etapa de estabilidade; e\n\n2. Etapa de ca?lculo da ac?a?o de controle.\n\n\n\n97\n\nNa etapa de estabilizac?a?o, um sinal e? calculado e adicionado\nao vetor do erro de predic?a?o, estabilizando a planta frente a erros de\nmodelagem e perturbac?o?es na?o modeladas inseridas no sistema. Na\netapa de ca?lculo da ac?a?o de controle, e? aplicado o erro modificado sobre\no ca?lculo do sinal de controle.\n\nEsse cap??tulo esta? organizado da seguinte forma: na sec?a?o 5.1\napresenta-se os conceitos fundamentais que sera?o necessa?rios para a\ncompreensa?o da metodologia de ca?lculo desta te?cnica. Para ilustrar\nmelhor a aplicac?a?o desta te?cnica e? mostrado um exemplo de simulac?a?o\npara um caso SISO. Na sec?a?o 5.2 sera?o apresentadas as simulac?o?es ob-\ntidas aplicando o DMC-Recursivo com a te?cnica de filtragem no erro\nde predic?a?o e com a te?cnica do passo de estabilidade, ambas aplica-\ndas num estudo de caso. O reator qu??mico com duas varia?veis mani-\npuladas e duas varia?veis controladas, comumente visto nas indu?strias\npetroqu??micas. Para demonstrar a efica?cia desta te?cnica, erros de mo-\ndelagens e perturbac?o?es na?o modeladas sera?o inseridos no sistema. Fi-\nnalmente, na sec?a?o 5.3 sera?o apresentadas as respectivas concluso?es\ndeste cap??tulo.\n\n5.1 PASSO DE ESTABILIDADE PARA COMPENSAC?A?O DE ER-\nROS NO MODELO DE PREDIC?A?O\n\nO passo de estabilidade e? uma te?cnica que procura um sinal que\nsomado, ao erro verdadeiro, proporcione robustez e estabilidade em\nplantas esta?veis em malha aberta com erros de modelo. Esta te?cnica\npropo?e uma soluc?a?o onde a correc?a?o do erro de predic?a?o EL e? somado ao\nvetor de erro verdadeiro E proporcionando melhor desempenho frente\na perturbac?o?es na?o modeladas, .\n\nUma primeira opc?a?o para obter EL e? utilizar p poss??veis diferen-\ntes elementos. No entanto, isso pode trazer um elevado custo compu-\ntacional. Assim, apresentam-se outras opc?o?es para o projeto do vetor\nEL, conforme:\n\na) aplicando um horizonte de correc?a?o de erro pL = p ? ?p e ?p\nelementos nulos, como se mostra na Figura 22 (a);\n\nb) aplicando um horizonte de correc?a?o de erro pL e repetindo o u?ltimo\nelemento do horizonte para todos os p?pL elementos seguintes,\ncomo se mostra na Figura 22 (b);\n\nc) usando o conceito de blocking, onde EL e? preenchido com nL grupo\nde diferentes valores poss??veis, como se mostra na Figura 22 (c);\n\n\n\n98\n\nd) preenchendo o vetor de tamanho p??p com um u?nico valor de EL\ne ?p elementos nulos, como se mostra na Figura 22 (d).\n\nFigura 22 \u2013 Formas de implementar o vetor EL.\n\nL\nE\n\nL\np\n\npp p??\n\n(a)\n\nL\nE\n\nL\np\n\npp p??\n\n(b)\n\nL\nE 4Lp ?\n\np p? ? p\n\n(c)\n\nL\nE 1\n\nL\np ?\n\np p? ? p\n\n(d)\n\nFonte: (PLUCENIO et al., 2014).\n\nPara evitar que o requisito de estabilidade perturbe o seguimento\nda refere?ncia quando se tem EL definido em todos os elementos p, e?\nimportante ter alguns dos u?ltimos componentes de EL nulos. Dessa\nforma, faz-se com que a correc?a?o total convirja para aquela utilizada\npelo DMC-Recursivo no final do horizonte de predic?a?o.\n\nQualquer que seja a opc?a?o escolhida dentre as mencionadas ante-\nriormente, o vetor final de estabilizac?a?o da correc?a?o do erro e? expresso\npor:\n\nEs = E + MEL (5.11)\n\nonde:\n\nEL: e? o vetor com todas correc?o?es do erro de Lyapunov das varia?veis\n\ncontroladas\n[\nE1L E\n\n2\nL . . . E\n\np\nL\n\n]T\n;\n\nE: e? o vetor com todos os erros verdadeiros das varia?veis controladas[\nE1 E2 . . . Ep\n\n]T\n;\n\nEs: e? o vetor com todos os erros modificados;\n\n\n\n99\n\nM: e? uma matriz com dimensa?o p x p. E? composto de uns e zeros, de\ntal maneira que implementa as estrate?gias mostradas na Figura\n22.\n\nPara a obtenc?a?o do vetor EL, aplica-se o segundo me?todo de\nLyapunov para estabilidade. Esse me?todo baseia-se na analogia de\numa func?a?o de Lyapunov V (x) com energia ou potencial. Se x = 0 e e?\num ponto de equil??brio, enta?o se existe um V (x) tal que:\n\nV (x) > 0 para qualquer x 6= 0 e\nV (x) = 0 so? para x = 0\n\n(5.12)\n\nEnta?o, se:\ndV (x)\n\ndt\n? 0 (5.13)\n\nx = 0 e e? um ponto de equil??brio esta?vel no sentido de Lyapunov.\n\nSe\ndV (x)\n\ndt\n? 0 e dV (x)\n\ndt\n= 0 somente quando x = 0 o sistema e? assintoti-\n\ncamente esta?vel. Este e? um resultado muito bem aceito e a base para\nmuitos estudos de estabilidade (MONTEIRO, 2006).\n\nPara plantas esta?veis em malha aberta se tem que o sistema\nesta? em equil??brio quando ?u = 0. A instabilidade pode ser causada\npela ac?a?o de controle devido a erros do modelo de predic?a?o, e? natural\nconsiderar como uma func?a?o de Lyapunov:\n\nL =\n1\n\n2\n?uT ?u (5.14)\n\nObserve que L e? uma func?a?o Lyapunov candidata, va?lida desde\nque ?u = 0 seja a condic?a?o de equil??brio:\n\nL (0) = 0 e\nL > 0 para qualquer ?u 6= 0 (5.15)\n\nConsiderando um caso irrestrito, onde:\n\n?u = K (W ? F)\n\nK =\n(\nGT RG + Q\n\n)?1\nGT R\n\nF = Fsc + E + MEL\n\n(5.16)\n\nNa equac?a?o (5.16), W representa o vetor de trajeto?rias desejadas\ndentro do horizonte de predic?a?o, F e? a resposta livre corrigida no ho-\nrizonte de predic?a?o, R e Q sa?o as matrizes de ponderac?a?o do set-point\n\n\n\n100\n\ne de supressa?o de movimento, Fsc e? a resposta livre sem correc?a?o ao\nlongo do horizonte de predic?a?o p, E e? o vetor do erro de predic?a?o no\ninstante atual, EL e? o vetor do erro de estabilidade de Lyapunov, que\ne? calculado para corrigir o erro de predic?a?o.\n\nA fim de assegurar estabilidade, deve-se cumprir ?L\n?t\n? 0. Em\n\nque ?L\n?t\n\npode ser calculado como:\n\n?L\n\n?t\n=\n\n?L\n\n??u\n\n??u\n\n?EL\n\n?EL\n?t\n\n(5.17)\n\nou\n\n?L\n\n?t\n= ?uT (?KM) ?EL\n\n?t\n(5.18)\n\nFazendo substituic?o?es:\n\n?L\n\n?t\n= ?(W ? Fsc ? E ? MEL)T KT KM\n\n?EL\n?t\n\n(5.19)\n\nO termo ?EL\n?t\n\npode ser reescrita como EkL ? E\nk?1\nL .\n\nAssim, a expressa?o final para a equac?a?o (5.19) torna-se:\n\n?L\n?t\n\n= 1\n2\nETL?LEL ? 12 ?\n\nT\nLEL +\n\n1\n2\nD\n\n?L = M\nT KT KM\n\nA = W ? Fsc ? E\n\nB = MT KT K\n\n?L = ?LE\nk?1\nL + BA\n\nD = AT BT Ek?1L\n\n(5.20)\n\nTendo a expressa?o para ?L\n?t\n\n, pode-se formular o seguinte pro-\nblema de otimizac?a?o:\n\nmin\nEL\n\nJ\n\nsujeito a :\n\nJ = 1\n2\nETL?LEL ? 12 ?\n\nT\nLEL +\n\n1\n2\nfP D (EL)\n\n(5.21)\n\nOs dois primeiros termos da equac?a?o (5.21) representam a ex-\n\n\n\n101\n\npressa?o ?L\n?t\n\n. A ide?ia e? que o valor encontrado de EL obrigue o termo\n?L\n?t\n? 0. Pore?m, isto deve ter um limite, e essa e? a raza?o da pre-\n\nsenc?a do termo fDP (EL). Uma func?a?o positiva definida sobre EL deve\nser concebida com o objetivo de se contrapor ao termo negativo de J.\nAle?m disso, a func?a?o deve incluir ponderac?o?es para ajustar uma melhor\nsintonia do controlador. A primeira func?a?o candidata e?:\n\nETLM\nT SLMEL (5.22)\n\nOs valores da diagonal da matriz de ponderac?a?o SL atuam com o obje-\ntivo de suprimir EL, a fim de evitar que o valor ?L seja negativo. No\nentanto, o papel desta func?a?o e? limitado a suprimir os valores negati-\nvos em J e na?o contribui para qualquer outro atributo do sistema sob\ncontrole.\n\nOutra func?a?o candidata definida positiva e?:\n\n(\nY? ? W\n\n)T\nSL\n\n(\nY? ? W\n\n)\n(5.23)\n\nonde\n\nY? = Fsc + E + MEL + GK (W ? (Fsc + E + MEL)) (5.24)\n\nO objetivo desta func?a?o e? suprimir os valores negativos de J, estabe-\nlecendo uma relac?a?o entre o principal objetivo, que e? evitar que ?L\n\n?t\nseja negativo, garantindo o seguimento da refere?ncia. Os elementos\npositivos da matriz diagonal SL sa?o ajustados a fim de obter EL que\nproporcione estabilidade e seguimento da refere?ncia para o sistema sob\ncontrole.\n\nFinalmente, o problema de otimizac?a?o quadra?tica para obter EL\n\n\n\n102\n\ne? formulado como:\n\nmin\nEL\n\nJ\n\nsujeito a :\n\nJ = 1\n2\nETL?LEL ? 12 ?\n\nT\nLEL\n\n?L = M\nT\n(\nKT K + ZT SLZ\n\n)\nM\n\nZ = GK ? Ip\u00d7p\n\n?TL = ?LE\nk?1\nL + BA + M\n\nT ZT SLZA\n\n(5.25)\n\nPara o caso sem restric?o?es, o valor do vetor EL que minimiza J\ne?:\n\nEL = 0, 5?\n?1\nL ?L (5.26)\n\nA matriz ?L sera? definida positiva, desde que a matriz de ponderac?a?o\ndiagonal SL seja escolhida com valores positivos.\n\nUm aspecto interessante desta metodologia e? que restric?o?es em\n?u e u podem ser atendidas na etapa de estabilidade. Introduzindo\nrestric?o?es no sistema, os seguintes termos se podem escrever como:\n\n?u ? B e? equivalente a :\n\nK (W ? Fsc ? E ? MEL) ? B\n\nou :\n\n?KMEL ? B ? K (W ? Fsc ? E)\n\n(5.27)\n\nO vetor u pode ser escrito como: u = uk?11mh\u00d71 + TI ?u, onde\nTI e? a matriz Toeplitz integradora, e 1mh\u00d71 e? um vetor com cada\ncomponente igual a 1 para um caso SISO como e? mostrado a seguir:\n\n\n\n103\n\nu ? C e? equivalente a :\n\nuk?11mh\u00d71 + TI K (W ? Fsc ? E ? MEL) ? C\n\nou :\n\nTI KMEL ? C ? uk?11mh\u00d71 ? TI KA\n\nA = W ? Fsc ? E\n\n(5.28)\n\nAo introduzir estas restric?o?es na programac?a?o quadra?tica, dada\npela equac?a?o (5.25), o valor de EL obtido pode ser usado na equac?a?o\n(5.29) para derivar ?u.\n\n?u = K (W ? F)\n\nF = Fsc + E + MEL\n\n(5.29)\n\nO vetor ?u obtido provera? estabilidade ao sistema respeitando\nas restric?o?es impostas em ?u e u.\n\nPara ilustrar a aplicac?a?o desta te?cnica e analisar o caso de er-\nros de modelagem no atraso, e? empregado um exemplo apresentado\nem Normey e Camacho (2007) e mostrado na Figura 23. No exemplo\ntem-se um sistema de aquecimento de a?gua onde w e? a resiste?ncia en-\ncarregada de aquecer a agua dentro do tanque e na sa??da do tanque\ntem-se uma tubulac?a?o com um sensor de temperatura instalado a uma\ncerta distancia distancia do tanque. Esta distancia gera um atraso de\ntransporte L medido em minutos, sendo que L = 6 min.\n\nA func?a?o de transfere?ncia do sistema de primeira ordem com\natraso e? apresentada na equac?a?o (5.30).\n\nPn (s) =\ne?Ls\n\n2s + 1\n(5.30)\n\nLevando em conta o atraso e a dina?mica do processo, considera-\nse um tempo de amostragem Ts = 0, 2 min. Dessa forma, a func?a?o de\ntransfere?ncia discreta e? mostrada na equac?a?o (5.31).\n\nPn (z) =\n0, 095z?dn\n\nz ? 0, 905 (5.31)\n\nPara controlar esse processo, parametriza-se um controlador DMC-\n\n\n\n104\n\nFigura 23 \u2013 Esquema do tanque de aquecimento de a?gua.\n\nTT\n\nF Tanque\n\nw\n\nFonte: Modificado de (NORMEY; CAMACHO, 2007).\n\nRecursivo com horizonte de predic?a?o p = 80, horizonte de controle\nmh = 10, horizonte de modelo N = 100, ponderac?a?o no seguimento da\nrefere?ncia ? = 0, 01 e ponderac?a?o no esforc?o de controle ? = 1.\n\nInicialmente implementou-se o DMC-Recursivo para controlar o\ntanque de aquecimento de a?gua considerando dn = 0 tanto na planta\nreal quanto no modelo, onde o modelo e? a sa??da predita, como se mostra\nna Figura 24.\n\nEm seguida e? implementado o DMC-Recursivo considerando dn = 30\ntanto na planta quanto no modelo, como se mostra na Figura 25.\n\nOs dados das sa??das preditas (ypred) da Figura 24 e da Figura 25\nforam armazenadas e apresentadas na Figura 26. Nessa figura percebe-\nse a diferenc?a existente entre a sa??da predita sem o atraso e a sa??da\npredita com o atraso. Com esses dados, foi calculada a diferenc?a entre\nambas sa??das (dif = ypred sem atraso?ypred com atraso) mostrada na\nFigura 26. O dif, e? o sinal com a qual pode-se corrigir a diferenc?a entre\na predic?a?o sem o atraso e a predic?a?o com o atraso, sendo que e? o sinal\ncom o qual poderia-se corrigir erros de modelagens no atraso.\n\n\n\n105\n\nFigura 24 \u2013 Simulac?a?o do sistema sem atraso e sem incertezas no mo-\ndelo.\n\nTempo[min]\n0 50 100 150 200 250\n\nT\ne\n\nm\np\n\ne\nra\n\ntu\nra\n\n1\n\n1.2\n\n1.4\n\n1.6\nDMCO-ORECURSIVO\n\nRef\n\nPlantaOreal\n\nModelo\n\nTempo[min]\n0 50 100 150 200 250\n\nC\no\n\nn\ntr\n\no\nle\n\n1\n\n1.2\n\n1.4\n\n1.6\nu\n\nControle\n\nFonte: pro?pria.\n\nFigura 25 \u2013 Simulac?a?o do sistema com atraso e sem incertezas no mo-\ndelo.\n\nTempo[min]\n0 50 100 150 200 250\n\nT\ne\n\nm\np\n\ne\nra\n\ntu\nra\n\n1\n\n1.2\n\n1.4\n\n1.6\nDMCO-ORECURSIVO\n\nRef\n\nPlantaOreal\n\nModelo\n\nTempo[min]\n0 50 100 150 200 250\n\nC\no\n\nn\ntr\n\no\nle\n\n1\n\n1.2\n\n1.4\n\n1.6\nu\n\nControle\n\nFonte: pro?pria.\n\n\n\n106\n\nFigura 26 \u2013 Sa??das preditas com o atraso e sem o atraso.\n\nTempov[min]\n0 50 100 150 200 250\n\nS\na\n\n\u00edd\na\n\ns\n\n1\n\n1.1\n\n1.2\n\n1.3\n\n1.4\n\n1.5\nSa\u00eddasvpreditasvDMCv-vRecursivo\n\ny\npred\n\ncomvatraso\n\ny\npred\n\nsemvatraso\n\nRef\n\nFonte: pro?pria.\n\nFigura 27 \u2013 Diferenc?a entre as sa??das predita com o atraso e sem o\natraso.\n\nTempot[min]\n0 50 100 150 200 250\n\n0\n\n0.05\n\n0.1\n\n0.15\n\n0.2\n\n0.25\n\n0.3\nDif.tDMCt-tRecursivo\n\ndift=ty\npred\n\nsemtatarsot-ty\npred\n\ncomtatraso\n\nFonte: pro?pria.\n\n\n\n107\n\nA seguir, sa?o aplicadas as te?cnicas DMC-Recursivo com filtro\nno erro de predic?a?o e DMC-Recursivo com passo de estabilidade. Nas\nsimulac?o?es foi considerado que a planta real na?o possui atraso e que o\nmodelo possui um atraso de 30.\n\nNa Figura 28, mostra-se a resposta obtida na simulac?a?o apli-\ncando a te?cnica DMC-Recursivo com filtro no erro de predic?a?o. Nessa\nfigura, apresenta-se a sa??da da planta, a sa??da do modelo e o sinal de\ncontrole. Os para?metros de sintonia usados nesse controlador sa?o: ho-\nrizonte de predic?a?o p = 80, horizonte de controle mh = 10, horizonte de\nmodelo N = 100, ponderac?a?o no seguimento da refere?ncia ? = 0, 001,\nponderac?a?o no esforc?o de controle ? = 50 e filtro no erro de predic?a?o\n? = 0, 95.\n\nFigura 28 \u2013 DMC-Recursivo com filtro no erro de predic?a?o aplicando\numa incerteza de 6 min (dn =30).\n\nTempo[min]\n0 50 100 150 200 250\n\nT\ne\n\nm\np\n\ne\nra\n\ntu\nra\n\n1\n\n1.5\n\n2\nDMC-RECURSIVO(ErroPPred.Pfiltrado)\n\nRef\n\nPlantaPreal\n\nModelo\n\nTempo[min]\n0 50 100 150 200 250\n\nC\no\n\nn\ntr\n\no\nle\n\n1\n\n1.5\n\n2\nu\n\nControle\n\nFonte: pro?pria.\n\nNa Figura 29, mostra-se a resposta obtida aplicando a te?cnica\nDMC-Recursivo com passo de estabilidade. Nessa figura, apresenta-se a\nsa??da da planta, a sa??da do modelo e o sinal de controle. Os para?metros\nde sintonia usados nesse controlador sa?o: horizonte de predic?a?o p = 80,\nhorizonte de controle mh = 10, horizonte de modelo N = 100, pon-\nderac?a?o no seguimento da refere?ncia ? = 0, 01, ponderac?a?o no esforc?o\nde controle ? = 40, ponderac?a?o de supressa?o para EL, PL = 3800 e\nponderac?a?o de supressa?o para EL, SL = 1.\n\n\n\n108\n\nFigura 29 \u2013 DMC-Recursivo com passo de estabilidade aplicando uma\nincerteza de 6 min (dn =30).\n\nTempo[min]\n0 50 100 150 200 250\n\nT\ne\n\nm\np\n\ne\nra\n\ntu\nra\n\n1\n\n1.2\n\n1.4\n\n1.6\nDMC-RECURSIVO COM PASSO DE ESTABILIDE\n\nRefer\u00eancia\n\nPlanta real\n\nModelo\n\nPlanta real + E\nL\n\nTempo[min]\n0 50 100 150 200 250\n\nC\no\n\nn\ntr\n\no\nle\n\n1\n\n1.2\n\n1.4\n\n1.6\nu\n\nControle\n\nFonte: pro?pria.\n\nNa Figura 28 e na Figura 29, observa-se que as duas te?cnicas\nconseguem seguimento de refere?ncia frente a incerteza inserida no mo-\ndelo. No entanto, pode-se perceber que a te?cnica do DMC-Recursivo\ncom passo de estabilidade consegue alcanc?ar o regime permanente com\nmaior rapidez comparada com a te?cnica DMC-Recursivo com filtro no\nerro de predic?a?o.\n\nPor u?ltimo, na Figura 30 sa?o comparados os fatores de correc?a?o\ndo DMC-Recursivo com filtro no erro de predic?a?o (Ef ) e do DMC-\nRecursivo com passo de estabilidade (EL) com o fator de correc?a?o ob-\ntido com o DMC-Recursivo (dif). Nessa figura pode-se observar que\na sinal que mais se assemelha ao dif e? o fator de correc?a?o obtido apli-\ncando a te?cnica passo de estabilidade.\n\nComo normalmente o erro verdadeiro e? somado a? predic?a?o, a\ncorrec?a?o e? obtida fazendo a diferenc?a entre a planta real e o modelo de\npredic?a?o apresentado na equac?a?o (5.32)\n\nE (k) = Y (k) ? Y? (k) (5.32)\nNa realidade, o que acontece ao aplicar a te?cnica com passo de\n\nestabilidade e? que ela calcula uma correc?a?o adicional EL, que somada ao\n\n\n\n109\n\nFigura 30 \u2013 Fatores de correc?a?o do DMC-Recursivo com passo de esta-\nbilidade, DMC-Recursivo com filtro no erro de predic?a?o e dif.\n\nTempod[min]\n0 50 100 150 200 250\n\n-0.3\n\n-0.2\n\n-0.1\n\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\nDif.dDMCd-dRecursivodvsdFatorddedcorre\u00e7\u00e3odE\n\nL\nedE\n\nf\n\ndifd=dy\npred\n\nsemdatarsod-dy\npred\n\ncomdatraso\n\ncor\nE\n\nf\n\nparady\npred\n\ncor\nE\n\nL\n\nparady\npred\n\nFonte: pro?pria.\n\nerro de predic?a?o verdadeiro E fornece estabilidade no sistema. Assim,\npode-se imaginar que a te?cnica passo de estabilidade \u201cmodifica\u201d a sa??da\nda planta Y? (k) como se mostra na equac?a?o (5.33).\n\nY? (k) = Y (k) + EL (k) (5.33)\n\nA resposta desta modificac?a?o e? representada com a linha verde\nna Figura 29. Se na?o houvesse EL o sistema iria oscilar, pois ao tentar\nrealizar a correc?a?o aplicando o erro verdadeiro o sistema aplicaria uma\nac?a?o de controle maior achando que na?o atingiu a refere?ncia. EL \u201den-\ngana\u201do algoritmo ao fazer com que a planta se parec?a com o modelo de\npredic?a?o sem atraso. Considerando as equac?o?es (5.32) e (5.33), tem-se:\n\nY? (k) ? Y? (k) = Y (k) + EL ? Y? (k)\nY? (k) ? Y? (k) = EL (k) + E (k)\n\nPelo que, o erro que vai ser somado a? predic?a?o na?o e? so? o erro ver-\ndadeiro, agora e? a soma do erro verdadeiro como o EL, como mostrado\nna equac?a?o (5.34).\n\n\n\n110\n\nY? (k) = Y? (k) + EL (k) + E (k) (5.34)\n\n5.2 ESTUDO DE CASO\n\nPara demonstrar a efica?cia da estrate?gia aplicando o passo de es-\ntabilidade proposto nesse trabalho, considera-se o controle de um reator\nde tanque agitado, comumente encontrado na indu?stria petroqu??mica.\n\nNesta sec?a?o, os resultados de simulac?a?o sa?o apresentados. As\ncomparac?o?es da te?cnica de filtragem e da te?cnica aplicando o passo de\nestabilidade sa?o implementadas no controlador com estrate?gia DMC-\nRecursivo. As respostas das simulac?o?es sa?o comparadas utilizando o\n??ndice de desempenho do controlador e pela verificac?a?o da resposta de\nsimulac?a?o aplicados no reator de tanque agitado.\n\nDois controladores DMCs-Recursivos sa?o configurados. O pri-\nmeiro controlador aplicando a te?cnica de filtragem no erro de predic?a?o\nmostrado na Tabela 12, e o outro controlador aplicando a te?cnica passo\nde estabilidade mostrado na Tabela 13. Ambos implementados no re-\nator de tanque agitado apresentado em Normey e Camacho (2007), e\nmostrado na Figura 31.\n\nTabela 12 \u2013 Para?metros de sintonia do controlador DMC recursivo com\nfiltragem no erro de predic?a?o\n\nPara?metros Definic?a?o Valor\n\np1 horizonte de predic?a?o para y1 (k) 50\np2 horizonte de predic?a?o para y2 (k) 40\nN1 horizonte de modelo para y1 (k) 70\nN2 horizonte de modelo para y2 (k) 70\nmh1 horizonte de controle para u1 (k) 10\nmh2 horizonte de controle para u2 (k) 10\n?1 ponderac?a?o no controle 0,2\n?2 ponderac?a?o no controle 1\n?1 ponderac?a?o no seguimento da refere?ncia 0,01\n?2 ponderac?a?o no seguimento da refere?ncia 0,1\n?1 filtro no erro de predic?a?o 0,75\n?2 filtro no erro de predic?a?o 0,75\n\nO modelo e? descrito na seguinte matriz de transfere?ncia (as cons-\ntantes de tempo sa?o expressos em minutos).\n\n\n\n111\n\nTabela 13 \u2013 Para?metros de sintonia do controlador DMC-Recursivo\ncom passo de estabilidade.\n\nPara?metros Definic?a?o Valor\n\np1 horizonte de predic?a?o para y1 (t) 50\np2 horizonte de predic?a?o para y2 (t) 40\nN1 horizonte de modelo para y1 (t) 70\nN2 horizonte de modelo para y2 (t) 70\nmh1 horizonte de controle para u1 (t) 10\nmh2 horizonte de controle para u2 (t) 10\n?1 ponderac?a?o no controle 0,01\n?2 ponderac?a?o no controle 2\n?1 ponderac?a?o no seguimento da refere?ncia 0,01\n?2 ponderac?a?o no seguimento da refere?ncia 0,1\nPL1 Ponderac?a?o de supressa?o para EL 0,1\nPL2 Ponderac?a?o de supressa?o para EL 0,1\nSL1 Ponderac?a?o de supressa?o para EL 1000\nSL2 Ponderac?a?o de supressa?o para EL 1000\n\nFigura 31 \u2013 Esquema do Reator de tanque agitado.\n\nTT\n\nReator\n\nAlimenta\u00e7\u00e3o\n\nRefrigerante\n\nEfluente\n\nFonte: (NORMEY; CAMACHO, 2007)\n\n\n\n112\n\n[\nY1 (s)\nY2 (s)\n\n]\n=\n\n?\n??\n\ne?0,24s\n\n1+0,7s\n5e?0,24s\n\n1+0,3s\n\ne?0,09s\n\n1+0,5s\n2e?0,09s\n\n1+0,4s\n\n?\n??\n[\nU1 (s)\nU2 (s)\n\n]\n(5.35)\n\nAs varia?veis manipuladas U1 (s) e U2 (s) da equac?a?o (5.35) representam\nna Figura 31 a vaza?o de alimentac?a?o e a vaza?o do fluido refrigerante\nno revestimento. As varia?veis controladas Y1 (s) e Y2 (s) sa?o a concen-\ntrac?a?o do efluente e a temperatura do reator, respectivamente. Como\nobservado na matriz (5.35), existe influe?ncia entre as varia?veis contro-\nladas e manipuladas, ja? que existe acoplamento no sistema.\n\nUtilizando um tempo de amostragem Ts = 0, 03 min, o modelo\ndiscretizado e? descrito pela expressa?o (5.36).\n\n[\ny1 (k)\ny2 (k)\n\n]\n=\n\n?\n??\n\n0,0420z?1\n\n1?0,9580z?1 z\n?8 0,4758z?1\n\n1?0,9048z?1 z\n?8\n\n0.0582z?1\n\n1?0,9418z?1 z\n?3 0,1445z?1\n\n1?0,9277z?1 z\n?3\n\n?\n??\n[\nu1 (k)\nu2 (k)\n\n]\n(5.36)\n\nOs tempos mortos neste caso sa?o causadas por efeitos de medic?a?o.\nO tempo morto na temperatura de sa??da y2 (k) e? o tempo necessa?rio\npara transportar o fluido para o sensor. O tempo morto na concen-\ntrac?a?o y1 (k) e? causada pelo efeito de transporte e o tempo requerido\npelo analisador. Os tempos mortos m??nimos sa?o: d1 = 8 (para as\nfunc?o?es de transfere?ncia da sa??da 1, FT11 e FT12) e d2 = 3 (para as\nfunc?o?es de transfere?ncia da sa??da 2, FT21 e FT22).\n\nImplementando a te?cnica do passo de estabilidade notou-se que\nconsiderando so? a matriz de ponderac?a?o SL, o valor desta tinha que\nser muito pequeno, ja? que ?L da equac?a?o (5.25) resultava em valores\nmuito pequenos. Enta?o, foi considerada a incorporac?a?o de uma outra\nmatriz de ponderac?a?o denominada PL, em ?L e B, como se mostra na\nequac?a?o (5.37):\n\nB = MT KT PLK\n?L = M\n\nT\n(\nKT PLK + Z\n\nT SLZ\n)\nM\n\n(5.37)\n\n\n\n113\n\nA Figura 32 mostra as respostas ao degrau com seus respectivos\natrasos de transporte para cada func?a?o de transfere?ncia. Onde, g11 e? a\nresposta ao degrau da func?a?o de transfere?ncia que relaciona y1 com u1,\ng12 e? a resposta ao degrau da func?a?o de transfere?ncia que relaciona y1\ncom u2, g21 e? a resposta ao degrau da func?a?o de transfere?ncia que rela-\nciona y2 com u1 e g22 e? a resposta ao degrau da func?a?o de transfere?ncia\nque relaciona y2 com u2,\n\nFigura 32 \u2013 Resposta ao degrau das func?o?es de transfere?ncia.\n\n0 50 100 150\n0\n\n0.5\n\n1\ng11\n\nResposta ao \ndegrau FT11\n\n0 50 100 150\n0\n\n2\n\n4\n\n6\ng12\n\nResposta\nao degrau FT12\n\n0 50 100 150\n0\n\n0.5\n\n1\ng21\n\nResposta\nao degrau FT21\n\n0 50 100 150\n0\n\n0.5\n\n1\n\n1.5\n\n2\ng22\n\nResposta ao \ndegrau FT22\n\nFonte: pro?pria.\n\nNa Figura 33, mostra-se as incertezas entre a planta real e o\nmodelo de predic?a?o aplicadas a cada uma das func?o?es de transfere?ncia\npara o atraso de transporte e o ganho. Na figura da esquerda sa?o\napresentados os atrasos de transporte utilizados no modelo de predic?a?o\ne os utilizados para simular a planta real, a? direita, mostram-se os\nganhos da planta real e do modelo de predic?a?o. Como observado nessa\nfigura, a dista?ncia existente entre o quadrado e o c??rculo representa a\nincerteza inserida no sistema. As incertezas no atraso de transporte\nsa?o: para FT11 0%, FT12 100%, FT21 80% e FT22 0%. A incerteza\naplicada nos ganhos para cada uma das func?o?es de transfere?ncia e? de\n\n\n\n114\n\n75%.\n\nFigura 33 \u2013 Incertezas inceridas no atraso de transporte e no ganho.\n\nFT11 FT12 FT21 FT22\n0\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\nErros nos atrasos\n\nAtr. usados predi\u00e7\u00e3o\nAtrasos reais simulados\n\nFT11 FT12 FT21 FT22\n0\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\nErros nos ganhos\n\nGanhos usados predi\u00e7\u00e3o\nGanhos reais simulados\n\nFonte: pro?pria.\n\nNa Figura 34 apresentam-se os resultados obtidos com a aplicac?a?o\nda te?cnica passo de estabilidade, com erros entre a planta real e o mo-\ndelo de predic?a?o conforme mostrados na Figura 33. Na Figura 34, uma\nperturbac?a?o na?o modelada e? introduzida no minuto 450, mantendo-se\nate? o minuto 1050. Observa-se que aplicando a te?cnica com o passo de\nestabilidade obte?m-se um melhor seguimento de refere?ncia, comparado\ncom a utilizac?a?o de filtragem no erro de predic?a?o, quando existem er-\nros de modelo tanto para o ganho como para o atraso de transporte.\nPor outro lado, a resposta na rejeic?a?o da perturbac?a?o e? mais ra?pida\naplicando o passo de estabilidade, ja? que o uso de muito filtragem no\nsistema causa lentida?o na rejeic?a?o da perturbac?a?o conforme ja? mostrado\nna introduc?a?o do presente cap??tulo.\n\n\n\n115\n\nFigura 34 \u2013 Resultados de simulac?a?o\n\nTempoy[min]\n0 200 400 600 800 1000 1200 1400 1600\n\nS\na\n\n\u00edd\na\n\ns\n\n0.2\n\n0.4\n\n0.6\n\n0.8\nVari\u00e1veisycontroladas\n\nRef\n1\n\nRef\n2\n\ny\n1\n\nUE\nL\nP\n\ny\n2\n\nUE\nL\nP\n\ny\n1\n\nUFP\n\ny\n2\n\nUFP\n\nTempoy[min]y\n0 200 400 600 800 1000 1200 1400 1600\n\nC\no\n\nn\ntr\n\no\nle\n\n0\n\n0.1\n\n0.2\nVari\u00e1veisymanipuladas\n\nU\n1\n\nUE\nL\nP\n\nU\n2\n\nUE\nL\nP\n\nU\n1\n\nUFP\n\nU\n2\n\nUFP\n\nPerturba\u00e7\u00e3oyentrando\ny\n\n2\nUE\n\nL\nP\n\ny\n1\nUFP\n\nU\n1\nUE\n\nL\nP\n\nU\n1\nUFP\n\nU\n2\nUFP\n\nU\n2\nUE\n\nL\nP\n\nPerturba\u00e7\u00e3oysaindo\n\ny\n2\nUE\n\nL\nP y\n\n2\nUFP\n\nNa Figura 35 apresenta uma comparac?a?o dos erros de predic?a?o\nobtidos com a aplicac?a?o de filtro e com a te?cnica passo de estabilidade.\nApresentam-se o erro de predic?a?o filtrado para a varia?vel y1 (k) e o pri-\nmeiro componente do vetor EL, EL (1), somado com o erro verdadeiro\nde y1 (k). O comportamento do sinal do erro aplicando o passo de es-\ntabilidade para a varia?vel controlada y1 (k), e? muito mais agressivo do\nque o sinal do erro filtrado, de modo que compensa o erro de tempo\nmorto no instante da mudanc?a da refere?ncia. Como esperado, os erros\nno sistema em regime permanente coincidem.\n\nAs Figuras 36, 37, 38 e 39 mostram em detalhes as respostas\nobtidas aplicando DMC-Recursivo com passo de estabilidade e DMC-\nRecursivo com filtro no erro de predic?a?o nos intervalos onde sa?o inseri-\ndas as perturbac?o?es. Com o objetivo de medir a velocidade de rejeic?a?o\nda perturbac?a?o, foi considerado um tempo de acomodac?a?o de 5% repre-\nsentado com as linhas tracejadas de cor preto. Na Figura 36, no minuto\n450 tem-se uma perturbac?a?o entrando, observa-se que aplicando filtro\nno erro de predic?a?o na sa??da y1(k), foi preciso de 201 min para reagir a?\nperturbac?a?o. No entanto, aplicando o passo de estabilidade foi preciso\nde 62 min, e? dizer, aplicando a te?cnica passo de estabilidade obteve-\n\n\n\n116\n\nFigura 35 \u2013 Comparac?a?o dos erros Ef frente a EL\n\nTempo [min]\n100 200 300 400\n\nE\nr.\n\n0.5\n\n0.55\n\n0.6\n\n0.65\n\n0.7\n\n0.75\n\n0.8\nErros\n\nE\nL\n(1) y\n\n1\n+E y\n\n1\n\nE\nf\ny\n\n1\n\nse uma resposta tre?s vezes mais ra?pida em comparac?a?o com a te?cnica\naplicando o filtro no erro de predic?a?o. Algo similar acontece na Figura\n37, no minuto 1050 a perturbac?a?o sai do sistema. Nessa figura pode-se\nobservar que a resposta aplicando o passo de estabilidade e? duas vezes\nmais ra?pida que a resposta obtida aplicando o filtro no erro de predic?a?o.\n\nNas Figuras 38 e 39, observa-se o efeito causado pelo acopla-\nmento existente no sistema. Nessas figuras sa?o mostradas a resposta\nda sa??da y2(k) que e? afetada pelas perturbac?o?es inseridas em y1(k).\nTambe?m observa-se que a resposta do sistema e? mais ra?pida aplicando\no passo de estabilidade em comparac?a?o com o filtro no erro de predic?a?o.\n\n\n\n117\n\nFigura 36 \u2013 Resultados de simulac?a?o\n\nTempoy[min]\n400 450 500 550 600 650 700 750 800\n\nS\na\n\n\u00edd\na\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\nVari\u00e1velycontrolada\nRef\n\n1\n\ny\n1\n\nYE\nL\n3\n\ny\n1\n\nYF3\n\nX:y651\nY:y0.63\n\nX:y512\nY:y0.63\n\nX:y450\nY:y0.5945\n\nFigura 37 \u2013 Resultados de simulac?a?o\n\nTempoR[min]\n950 1000 1050 1100 1150 1200 1250 1300 1350\n\nS\na\n\n\u00edd\na\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\nVari\u00e1velRcontrolada\nRef\n\n1\n\ny\n1\n\nXE\nL\n:\n\ny\n1\n\nXF:\n\nX:R1050\nY:R0.599 X:R1250\n\nY:R0.57\n\nX:R1150\nY:R0.5967\n\nFigura 38 \u2013 Resultados de simulac?a?o\n\nTempoy[min]\n450 500 550 600 650 700\n\nS\na\n\n\u00edd\na\n\n0.2\n\n0.25\n\n0.3\n\n0.35\nVari\u00e1velycontrolada\n\nRef\n2\n\ny\n2\n\nYE\nL\n1\n\ny\n2\n\nYF1\n\nX:y450\nY:y0.3016\n\nX:y520\nY:y0.285\n\nX:y590\nY:y0.285\n\n\n\n118\n\nFigura 39 \u2013 Resultados de simulac?a?o\n\nTempoE[min]\n1050 1100 1150 1200 1250 1300\n\nS\na\n\n\u00edd\na\n\n0.25\n\n0.3\n\n0.35\nVari\u00e1velEcontrolada\n\nRef\n2\n\ny\n2\n\n(E\nL\n)\n\ny\n2\n\n(F)\nX:E1050\nY:E0.2999\n\nX:E1130\nY:E0.315\n\nX:E1190\nY:E0.315\n\n5.3 CONCLUSO?ES\n\nNeste cap??tulo, apresentou-se outra opc?a?o para lidar com erros\nde modelagem em plantas esta?veis em malha aberta, que e? baseado no\nsegundo me?todo de Lyapunov para a estabilidade. O passo de estabi-\nlidade modifica o erro de predic?a?o futuro de forma otimizada, com o\nobjetivo de proporcionar estabilidade no sistema. Com o intuito de pro-\nver estabilidade, o algoritmo encontra a correc?a?o necessa?ria a? predic?a?o.\n\nConforme mostra a Figura 34 o tempo necessa?rio para a te?cnica\npasso de estabilidade trazer y1 (k) a? refere?ncia, e? 1/3 do tempo utili-\nzado pela te?cnica de filtragem quando uma perturbac?a?o na?o modelada\nperturba o sistema. A te?cnica passo de estabilidade apresentou um\ndesempenho superior em comparac?a?o com o me?todo de filtragem do\nerro de predic?a?o. Isso foi verificado tanto no seguimento de refere?ncia\ncomo na rejeic?a?o das perturbac?o?es na?o modeladas conforme se constata\ncom os ??ndices de desempenho dos controladores MSE apresentados na\nTabela 14.\n\nTabela 14 \u2013 I?ndice de desempenho do controlador.\nEstrate?gia MSE1 MSE2\n\nDMCF 1020, 00 284,90\nDMCEL 590,66 140,31\n\nEste e? um resultado interessante, pois em muitos processos prin-\ncipalmente nas a?reas de petro?leo e ga?s, a maioria das varia?veis afetadas\npor perturbac?o?es na?o modeladas tem um impacto econo?mico impor-\n\n\n\n119\n\ntante que afetam diretamente no desempenho do processo. Quanto\nmais tempo se encontram fora das faixas aceita?veis de operac?a?o, maior\ne? a perda econo?mica.\n\n\n\n120\n\n\n\n121\n\nCap??tulo 6\n\nCONSIDERAC?O?ES FINAIS\n\nEsse u?ltimo cap??tulo conclui a dissertac?a?o, sintetizando as con-\ntribuic?o?es desse trabalho e discutindo os resultados obtidos. A partir\ndos resultados alcanc?ados, um conjunto de trabalhos pode ser conside-\nrado. Assim, sugesto?es e direc?o?es para trabalhos futuros tambe?m sa?o\nindicadas.\n\nPara alcanc?ar os objetivos propostos nesse trabalho, foi reali-\nzado, em primeiro lugar, um levantamento das pesquisas realizadas\nsobre os algoritmos de controle preditivo linear e na?o linear. Como\nresultados das pesquisas, este trabalho foi dividido em duas partes.\nUma primeira parte envolve o estudo da te?cnica PNMPC e na segunda\nparte, foi realizado o estudo de te?cnicas usadas para sistemas que apre-\nsentam incertezas no modelo de predic?a?o, principalmente no atraso de\ntransporte, onde e? apresentado o MPC com passo de estabilidade.\n\nA te?cnica PNMPC foi escolhida como uma boa opc?a?o para o\ntratamento de sistemas na?o lineares por possuir uma boa relac?a?o de-\nsempenho, velocidade e simplicidade na implementac?a?o. Assim, foram\nintroduzidos os conceitos de controladores preditivos com enfoque de-\ndicado aos controladores PNMPC.\n\nApresentaram-se neste trabalho, as contribuic?o?es a?s estrate?gias\ndos controladores PNMPC. Foram propostas seis alternativas diferen-\ntes para a aplicac?a?o do algoritmo PNMPC. Esses algoritmos, sa?o modi-\nficac?o?es da te?cnica completa proposta por Plucenio (2010). Os algorit-\nmos propostos podem ser empregados como guia para o tratamento de\nsistemas na?o lineares. Cada um destes algoritmos permite tratar dife-\nrentes graus de na?o linearidade dos sistemas, permitindo escolher entre\ndesempenho ou tempo de execuc?a?o. Esta proposta oferece uma ampla\ngama de opc?o?es para o tratamento de sistemas na?o lineares aplicando a\n\n\n\n122\n\nestrate?gia PNMPC. Estes algoritmos, permitem tratar processos com\ndina?mica na?o linear da seguinte formas: como totalmente na?o lineares\n(resposta livre na?o linear e resposta forc?ada linearizada a cada iterac?a?o),\ncomo totalmente lineares (resposta livre linear e resposta forc?ada line-\narizada a cada n iterac?o?es), ou no caso onde a linearidade e? suave,\na resposta livre e? tratada como na?o linear e a resposta forc?ada como\nlinear.\n\nPara avaliar os seis controladores, foi escolhido um estudo de\ncaso com dina?mica na?o linear. Os seis algoritmos dos controladores\nPNMPC propostos apresentaram bom desempenho, sendo que o melhor\ndesempenho e? do controlador PNMPC completo (versa?o 1). Por outro\nlado, esta versa?o apresenta o maior custo computacional.\n\nNa segunda parte do trabalho, foram estudadas te?cnicas que tra-\ntam incertezas no modelo de predic?a?o, principalmente no atraso de\ntransporte, caracter??sticas que podem levar um processo a? instabili-\ndade.\n\nNos sistemas que apresentam incertezas no modelo de predic?a?o,\nprincipalmente no atraso de transporte, uma opc?a?o e? o uso do filtro no\nerro de predic?a?o, partindo da ide?ia do preditor de Smith filtrado. Uma\noutra alternativa foi estudada nesta dissertac?a?o, o MPC com passo de\nestabilidade, apresentada em Plucenio et al. (2014). Nesse trabalho, foi\nrealizada a comparac?a?o destas duas te?cnicas. Para isso, foi escolhido\ncomo estudo de caso um processo comumente encontrado na indu?stria\npertroqu??mica. Neste estudo de caso, foram consideradas incertezas no\nganho, e no atraso de transporte entre a planta real e o modelo de\npredic?a?o. Os ??ndices de desempenho obtidos nos resultados mostram\nque o MPC com passo de estabilidade apresenta melhor desempenho.\nO resultados obtidos nas simulac?o?es mostram que o MPC com passo\nde estabilidade apresenta maior rapidez na rejeic?a?o das perturbac?o?es\nna?o modeladas inseridas no sistema. Na implementac?a?o do MPC com\npasso de estabilidade nenhum filtro e? aplicado.\n\nAinda como resultados do trabalho foram aprovados e publicados\ntre?s artigos: dois no Congresso Brasileiro de Automa?tica (CBA2016),\nrealizado o 3 a 7 de outubro de 2016, em Vito?ria Esp??rito Santo inti-\ntulados \u201dPractical Non-linear Model Predictive Control PNMPC: Al-\ngorithm implementations \u201d(PICON; PLUCENIO, 2016b) e \u201dMODELING\nAND CONTROL OF AN OIL PLATFORM GAS COMPRESSION\nSTATION \u201d(PLUCENIO; VETTORAZO; PICON, 2016) e um no 12th IE-\nEE/IAS International Conference on Industry Applications (INDUS-\nCON 2016) realizado o 20 a 23 de novembro de 2016, em Curitiba\nintitulado \u201dDMC de forma recursiva aplicando o passo de estabili-\n\n\n\n123\n\ndade\u201d(PICON; PLUCENIO, 2016a).\nCom tudo isso, pode-se concluir que os objetivos deste trabalho\n\nforam atingidos satisfatoriamente.\nComo trabalhos futuros pode-se citar:\n\n\u2022 avaliar as verso?es do PNMPC para outros processos que apresen-\ntam na?o linearidades em sua dina?mica;\n\n\u2022 avaliar as verso?es do PNMPC para processos multivaria?veis;\n\n\u2022 estudo de robustez na implementac?a?o do me?todo passo de esta-\nbilidade;\n\n\u2022 estudo de me?todos de sintonia para o controlador MPC com passo\nde estabilidade.\n\n\n\n124\n\n\n\n125\n\nREFERE?NCIAS\n\nALLGOWER, F.; FINDEISEN, R. Nonlinear model predictive\ncontrol: From theory to application. Institute for Systems Theory\nin Engineering, 2004.\n\nANDRADE, G. et al. Controle preditivo na?o linear aplicado em\nsistemas de gerac?a?o de energia solar. CBA, p. 8, Setembro 2012.\n\nBLOEMEN, H.; BOOM, T. Van den; VERBRUGGEN, H.\nModel-based predictive control for hammerstein systems.\nProceedings of the 39th IEEE Conference on Decision and\nControl, 2000.\n\nBORDONS, C. Control Predictivo: metodolog??a, tecnolog??a y\nnuevas perspectivas. 2000.\n\nBRAVO, C.; NORMEY, J. Controle de plantas na?o lineares utilizando\ncontrol preditivo linear baseado em modelos locais. SBA: Controle\ne Automac?a?o Sociedade Brasileira de Automatica, 2009.\n\nCAMACHO, E.; BORDONS, C. Model Predictive Control in\nProcess Industry. 1995.\n\nCAMACHO, E.; BORDONS, C. Model Predictive Control.\nSecond edition. 2007.\n\nCANNON, M. Efficient nonlinear model predictive control algorithms.\nAnnual Reviews in Control, 2004.\n\nCASTILLA, M. et al. Control predictivo no lineal del confort te?rmico\ny calidad de aire. Comite? Espan?ol de Automa?tica de la IFAC,\n2014.\n\nCLARKE, D.; MOHTADI, C. Generalized predictive control. part ii:\nextension and interpretations. AUTOMATICA, 1987.\n\nCLARKE, D.; MOHTADI, C. Properties of generalized predictive\ncontrol. part i: The basic algorithm. AUTOMATICA, 1987.\n\nCUTLER, C.; REMARKER, B. Dynamic matrix control-a computer\ncontrol algorithm. In Automatic Control, Conference, San\nFrancisco, 1980.\n\n\n\n126\n\nFINDEISEN, R.; ALLGOWER, F. An introduction to nonlinear\nmodel predictive control. 21st Benelux Meeting on Systems and\nControl, 2002.\n\nGRUBER, J.; BORDONS, C. Control predictivo no lineal basado en\nmodelos de volterra. aplicacion a una planta piloto. Revista\nIberoamericana de Automatica e Informatica Industrial, 2007.\n\nKEYSER, R. D. A gentle introduction to model based predictive\ncontrol. PADI2 International Conference on Control\nEngineering and Signal Processing, 1998.\n\nKEYSER, R. D. The nepsac nonlinear predictive controller in a real\nlife experiment. 1th International Conference on Intelligent\nEngineering Systems, 2007.\n\nLAWRYNCZUK, M. Computationally Efficient Model\nPredictive Control Algorithms. 2014.\n\nLIMA, D.; NORMEY, J.; PLUCENIO, A. Improving robustness and\ndisturbance rejection performance with industrial mpc. Congresso\nBrasileiro de Automatica, 2014.\n\nLUCIA, S.; RUMSCHINSKI, P.; KRENER, A. Improved design of\nnonlinear model predictive controllers. 5th IFAC Conference on\nNonlinear Model Predictive Control NMPC - Seville, Spain,\n2015.\n\nMACIEJOWSKI, J. Predictive Control with Constraints. :\nPrentice Hall, 2002.\n\nMAYNE, D. Control of constrained dynamic systems. European\nJournal of Control, 2001.\n\nMONTEIRO, L. Sistemas Dina?micos. 2006.\n\nMORAES, A. D. et al. Controle preditivo para controle de n??vel do\ntanque de uma planta piloto industrial. Simpo?sio Brasileiro de\nAutomac?a?o Inteligente, Outubro 2013.\n\nMORARI, M.; LEE, J. Model predictive control: past, present and\nfuture. elsevier, 1999.\n\nNELLES, O. Nonlinear system identification,. Spinger, 2001.\n\n\n\n127\n\nNORMEY, J. Gpc adaptativo basado em el predictor de smith para\nprocesos con retardo variable. SBAI, 2001.\n\nNORMEY, J.; CAMACHO, E. Control of Dead time processes. :\nSpringer, 2007.\n\nNORMEY, J.; LIMA, D.; SANTOS, T. Robustness of nonlinear mpc\nfor dead-time processes. 5th IFAC Conference on Nonlinear\nModel Predictive Control NMPC - Seville, Spain, 2015.\n\nPICON, B.; PLUCENIO, A. Dmc de forma recursiva aplicando o\npasso de estabilidade. 12th IEEE/IAS International Conference\non Industry Applications INDUSCON, 2016.\n\nPICON, B.; PLUCENIO, A. Practical non-linear model predictive\ncontrol pnmpc: Algorithm implementations. Congresso Brasileiro\nde Automatica CBA, 2016.\n\nPLUCENIO, A. Desenvolvimento de Te?cnicas de Controle na?o\nlinear para Elevac?a?o de Fluidos Multifa?sicos. Dissertac?a?o\n(Dissertac?a?o de Doutorado-Engenharia de Automae Sistemas) \u2014\nCentro Tecnolo?gico, Universidade Federal de Santa Catarina,\nFloriano?polis\u201d, 2010.\n\nPLUCENIO, A. et al. Model predictive control algorithm with\nstability step. Congresso Brasileiro de Automa?tica, Setembro\n2014.\n\nPLUCENIO, A. et al. Controle preditivo na?o linear na indu?stria do\npetro?leo e ga?s. PDPETRO, Outubro 2007.\n\nPLUCENIO, A. et al. A practical approach to predictive control for\nnonlinear processes. In: IFAC. 2007.\n\nPLUCENIO, A.; VETTORAZO, C.; PICON, B. Modeling and\ncontrol of an oil platform gas compression station. Congresso\nBrasileiro de Automatica CBA, 2016.\n\nPOMAR, M.; NORMEY, J.; CAMPONOGARA, E. Non linear model\nbased predictive controller of a buck boost converter. Proc. of the\nXVI IFAC World Congress, 2005.\n\nPRADA, C. D. El futuro del control de processos. Revista\nIberoamericana de Automatica e Informatica Industrial, 2004.\n\n\n\n128\n\nQIN, S.; BADGWELL, T. A survey of industrial model predictive\ncontrol technology. Control Engineering Practice, 2003.\n\nRICHALET, J.; RAULT, A.; TESTUD, J. Model predictive heuristic\ncontrol: Aplication to industrial process. AUTOMATICA, 1978.\n\nSANTOS, J. Controle Preditivo nao Linear para Sistemas de\nHammerstein. Tese (Doutorado) \u2014 UFSC, 2005.\n\nSKRJANC, I.; MATKO, D. Advances in Model-Based\nPredictive Control, chapter Fuzzy Predictive Controller with\nAdaptive Gain. : Oxford University Press, 1994.\n\nSMITH, O. Closer control of loops with dead-time. Chem. Eng.\nProgress, 1957.\n\nTANG, Y.; KEYSER, R. D. Advances in Model-Based\nPredictive Control, chapter Neural Network Based\nPredictive Control. : 1994, 1994.\n\nTHOME, F. Controle Preditivo Rubusto de Sistemas Na?o\nLineares com Atraso. Dissertac?a?o (Mestrado) \u2014 UFSC, 2013.\n\n\n\nAPE?NDICE A -- Ape?ndice\n\n\n\n\n\nPRACTICAL NON-LINEAR MODEL PREDICTIVE CONTROL PNMPC:\nALGORITHM IMPLEMENTATIONS\n\nBryant Picon Yang?, Agustinho Plucenio\u2020\n\n?Dpto. de Automac?a?o e Sistemas\nUniversidade Federal de Santa Catarina\n\n88040-900\nFloriano?polis, SC, Brasil\n\n\u2020Firenze-Consultoria em Engenharia e Informatica\nAv. Le?dio Joa?o Martins, 201-203 - 88102-000 KOBRASOL Sa?o Jose?, SC, Brasil\n\nEmails: bryant.bruce@posgrad.ufsc.br, brplucenio@firenzeconsult.com,\n\nAbstract\u2014 Most dynamic processes exhibit nonlinear relationships between controlled and manipulated vari-\nables. Depending on the application, the MPC algorithm is often chosen between a non-linear or a linear type.\nThis paper presents different implementations of the PNMPC-Practical Non-linear Model Predictive Control\nalgorithm. It is shown that the PNMPC algorithm may be written to handle the non-linearity at different levels.\nFor the sake of simplicity, the algorithms are implemented to control the level of a conical tank. The main\npurpose of the controller is to manipulate the position of the outlet valve in order to follow the reference. The\nperformance and the computational cost of six different implementations of PNMPC controller are shown. The\nresults of the controllers are compared and analyzed by the system response verification, the algorithm runtime\nand driver performance.\n\nKeywords\u2014 Nonlinear predictive control, Computational cost, Conical tank, Level control, SISO system\n\nResumo\u2014 A maioria dos processos dina?micos exibem relac?o?es na?o lineares entre varia?veis controladas e ma-\nnipuladas. Dependendo da aplicac?a?o, o algoritmo MPC e? muitas vezes escolhido entre um tipo linear ou na?o\nlinear. Este trabalho apresenta varias maneiras de implementar o algoritmo PNMPC. Mostra-se que o algoritmo\nPNMPC pode ser escrito para lidar com a na?o-linearidade em diferentes n??veis. Por uma questa?o de simplici-\ndade, os algoritmos sa?o implementados para controlar o n??vel de um tanque co?nico. A principal finalidade do\ncontrolador e? manipular a abertura da va?lvula de sa??da, a fim de seguir a refere?ncia. O desempenho e o custo\ncomputacional de seis implementac?o?es diferentes de controlador PNMPC sa?o exibidos. Os resultados dos contro-\nladores sa?o comparados e analisados pelo sistema de verificac?a?o de resposta, o tempo de execuc?a?o do algoritmo\ne o desempenho do atuador.\n\nPalavras-chave\u2014 Controle preditivo na?o linear, Custo computacional, Tanque co?nico, Controle de n??vel,\nSistema SISO\n\n1 Introduction\n\nThe Model Predictive Control (MPC) is one of the\nmost advanced modern control techniques, being\nprobably the one that has been the most success-\nful in industrial applications especially in the oil\nindustry (Garc??a, 1989).\n\nThe history of advanced control begins in the\nearly 1960\u2019s with the work of Kalman as well as\nco-author Ricatti and others, (Qina and Badg-\nwell, 2003). But it was only after a set of papers\npresented in the late 1970\u2019s that MPC controllers\nbecame interesting for industrial applications\n\nIn 1978, Richalet described the applications\nof \u201dControl Models Predictive Heuristic\u201d in 1979\nShell Engineers Cutler and Ramaker as well as\nPratt and Gillette outlined \u201dDynamic Control Ma-\ntrix\u201d (DMC) and reported applications for a cat-\nalytic tab fluid. In both algorithms, an explicit\ndynamic model of the plant has been used to pre-\ndict the effect of future control actions on the out-\nput, hence the name \u201dModel Predictive Control\u201d.\n\nThe main causes of this success is due to the\nability of the MPC to control a wide range of pro-\ncesses, from those having a relatively simple dy-\n\nnamic to others more complex, for example: Sys-\ntems with delay, multivariables, unstable, as well\nnon-linear dynamic among others. The MPC also\nallows to obtain solutions, notwithstanding the ex-\nistence of constraints in the variables (Normey and\nCamacho, 2007).\n\nThe majority of the real systems have non-\nlinear dynamics, however, when the process oper-\national range is small, the dynamics can be sat-\nisfactorily approximated by linear models. This\napproach has motivated many MPC techniques\nusing linear models such as: Dinamix Matrix\nControl-DMC, (C.R. Cutler and B.L. Ramaker,\n1988); Model Algorithm Control-MAC,(Richalet,\nRault, Testud and Papon, 1976); Generalized Pre-\ndictive Control-GPC, (Clarke, Mothadi and Tuffs,\n1987)) (Plucenio et al., 2007).\n\nThe main advantage of linear MPC is the low\ncost to obtain linear models in the development\nof the project compared to non-linear approaches.\nOther advantages are lesser difficulties to solve\nthe associated optimization problems. On the\nother hand, when the processes have a very strong\nnon-linear dynamic or when the operation range\nis wide, then it might be necessary to consider\n\n131\n\n\n\nthe non-linear model in the control algorithm, to\nmaintain the desired performance for the closed-\nloop system.\n\nWhen choosing a predictive control algorithm,\nthe initial decision is to choose between two algo-\nrithm systems, either the linear or the non-linear\nsystems. In many cases we have good non-linear\nprocess models. Unfortunately it is common prac-\ntice to get a linear representation of the model in a\nsingle point of operation and use this representa-\ntion to obtain the dynamic matrix coefficients and\nthe free response. The original PNMPC technique\nuses a real-time linearization of the input-output\nvariables. This linearization is performed in a two\nstep process and it obtains almost a second-order\napproximation. Depending on the non-linearity\nprocess to be controlled, there are several ways to\nimplement the PNMPC algorithm. The algorithm\nchoice will depend on the available processing time\nand quality of response to be obtained. The PN-\nMPC can be implemented as a linear controller.\nDue to the way it treats the prediction error, the\nlinear version of PNMPC will be similar to a GPC.\n\nThis paper is organized as follows: section\n2 presents the description of the mathematical\nmodel of the conical tank. The theoretical prin-\nciples of non-linear control strategy are presented\nin section 3. The description of the six alternative\nversions of the implementation of the PNMPC are\nshown in section 4. And section 5 presents the re-\nsults of implementations described in section 4.\n\n2 Mathematical Model Description of\nthe Conical Tank\n\nTo demonstrate the application of the Practical\nMPC algorithm for non-linear systems (PNMPC),\na process with a non-linear dynamics was con-\nsidered. Furthermore and in order to simplify\nthe demonstration, the level control in a conical\ntank (SISO system) was also used. The process\nis shown in Figure 1, where the manipulated vari-\nable is the output valve. The input flow will act\nas a disturbance in the system. The mass balance\n\nQin\n        \n                \n\n    R\n\n r\n\nh H\n\n  Qo\n\nFigure 1: conical tank\n\ninside the tank is given by the equation:\n\nQin ?Qo = A\ndh\n\ndt\n(1)\n\nwhere:\n\nQin input flow;\nQo output flow;\nR maximum radius of the conical tank;\nr radius of the conical tank at steady state;\nH maximum height of the conical tank;\nh height of the conical tank at steady state.\n\nWhereas the cross-section area of the conical tank\nis given by:\n\nA = ?\n\n[\nr ? (R?r)\n\n(\nh\n\nH\n\n)]2\n(2)\n\nand the output flow is represented by the equa-\ntion:\n\nQo = CvUc\n?\nh (3)\n\nwhere Uc is the control action of the outlet valve\nand Cv is a constant for the valve.\n\nSubstituting equations (2) and (3) in (1),we\nhave the following model of the conical tank:\n\ndh\n\ndt\n=\n\nQin ?CvUc\n?\nh\n\n?\n[\nr ? (R?r)\n\n(\nh\nH\n\n)]2 (4)\n\n3 PNMPC control\n\nThe PNMPC technique was developed by\n(Plucenio, 2010) and is based on algorithms that\nuse the vector representation of predictions over\nthe horizon p, Y?, as a vector function with m\nchanges in the control action ?u, according to the\nequation (5). The PNMPC is a technique that of-\nfers an alternative to solve the problem of linear\noptimization using conventional optimizers as QP\nquadratic programming or linear programming so-\nlution.\n\nY? = F + G?u (5)\n\nThe PNMPC differs from other MPC techniques\nmainly because it uses linearized models of the\nsystem trajectory. It is assumed that the pre-\ndictions Y? depend only on past entries ??u , past\noutputs ??y and the future control increments ?u.\n\nY? = f (??y ,??u , ?u) (6)\n\nThe vector of predictions is rewritten as:\n\nY? = F + GP NMP C ?u (7)\n\nwhere\nF = f (??y ,??u ) (8)\n\nGP NMP C =\n?Y?\n\n??u\n(9)\n\nThe matrix GP NMP C is the Jacobian of Y? rel-\native to the control increments and is obtained\nnumerically as the vector of free response F. A\nprediction algorithm computes the vector Y? with\n\n132\n\n\n\nthe p predictions when it provides the values of\nthe past inputs and outputs, and the vector with\nthe m future input increments ?u.\n\nIf we call the set of past inputs ??u and the\ncurrent and past output ??y , predictions can be\nrewritten in the following expression.\n\ny? (k + 1) = f (??y ,??u ,?u (k))\ny? (k + 2) = f (??y ,??u ,?u (k) , ?u (k + 1))\n...\ny? (k + p) = f (??y ,??u ,?u (k) , . . . , ?u (k + m? 1))\n\n(10)\n\nThe following compact representation is ob-\ntained:\n\nY? = F + GP NMP C ?u (11)\n\nWhereas that F is the vector of predictions that\nwould be obtained for ?u = 0 and GP NMP C is\nthe Jacobian of the predicted outputs with respect\nto the vector of increments of control signal ?u.\nGP NMP C is a generalized dynamic matrix that\ncan be used for linear systems and non-linear sys-\ntems, provided they are continuous and differen-\ntiable. The expression (11) for a SISO system can\nbe re-written as:\n?\n??????\n\ny?(k + 1)\ny?(k + 2)\n\n.\n\n.\n\n.\ny?(k + p)\n\n?\n??????\n\n=\n\n?\n??????\n\nf1(\n??y ,??u )\n\nf2(\n??y ,??u )\n.\n.\n.\n\nfp(\n??y ,??u )\n\n?\n??????\n\n+ (12)\n\n?\n??????????\n\n?y?(k+1)\n??u(k)\n\n0 \u00b7 \u00b7 \u00b7 0\n?y?(k+2)\n??u(k)\n\n?y?(k+2)\n??u(k+1)\n\n\u00b7 \u00b7 \u00b7 0\n\n.\n\n.\n\n.\n\n.\n\n.\n\n.\n\n.\n\n.\n\n.\n\n.\n\n.\n\n.\n?y?(k+p)\n??u(k)\n\n?y?(k+p)\n??u(k+1)\n\n\u00b7 \u00b7 \u00b7 ?y?(k+p)\n??u(k+m?1)\n\n?\n??????????\n\n?\n??????\n\n?u(k)\n?u(k + 1)\n\n.\n\n.\n\n.\n?u(k + m ? 1)\n\n?\n??????\n\nThe lower triangular form of the Jacobian matrix is\ndue to the causality of the system and absence of di-\nrect coupling between input and output. This means\n?y?(k+j)\n??u(k+i)\n\n= 0 for i ? j. The partial derivative\n?y?k+j\n??u(k)\n\nit is defined as:\n\n?y?k+j\n??u(k)\n\n= lim\n?uk?0\n\ny?k+j (uk?1 + ?uk) ? y?k+j (uk?1)\n?uk\n\n(13)\nFor a SISO system, for example, on the first instant\nof sampling, the following procedure for obtaining the\nnumerical value of F and GP NMP C is performed:\n\n1. Get the vector Y?0p (dimension p \u00d7 1) executing\nthe prediction model with the past inputs and\noutputs and ?u = [0 0 . . . 0]T . F = Y?0p.\n\n2. Computes the first column of the matrix\nGP NMP C . Obtaining the vector Y?\n\n1\np (dimension\n\np\u00d7 1) executing the model with the past inputs\nand outputs and considering ?u = [? 0 . . . 0]T ,\nwhere ? is a very small value,\n\nuk?1\n1000\n\n, for example.\n\nGP NMP C (:, 1) =\nY?1p?Y?\n\n0\np\n\n?\n.\n\n3. Computes the second column of the matrix\nGP NMP C . Obtain the vector Y?\n\n2\np (dimension\n\np\u00d7 1) executing the model with the past inputs\nand outputs and considering ?u = [0 ?. . . 0]T .\n\nGP NMP C (:, 2) =\nY?2p?Y?\n\n0\np\n\n?\n.\n\n4. Continues with the calculation of the others\ncolumns of the matrix GP NMP C to the last col-\numn, where the vector Y?mp is obtained execut-\ning the model with the past inputs and outputs\n\n?u = [0 0 . . .?]T .GP NMP C (:,m) =\nY?mp ?Y?\n\n0\np\n\n?\n.\n\nFor the application of PNMPC technique in multivari-\nable systems it is necessary to concatenate the predic-\ntion vectors for each variable Y? and the control in-\ncrements ?u. Thus, a system with ni entries and no\noutputs have the following vectors:\n\nY? = [Y?1Y?2 . . .Y?pno]\nT\n\n?u = [?u1?u2 . . . ?umni]\nT\n\n(14)\n\nTo obtain F and GP NMP C the procedure is then\nas above. The difference is that now the matrix\nGP NMP C have ni\u00d7no computed blocks as in the SISO\ncase for each pair of input and output. Obviously, as\nin linear MPC, weak relationships output-input may\nbe disregarded to avoid noise propagation. The con-\ntrol action is obtained by minimizing the cost function\nJ. Using equation (7) as a way of expressing the pre-\ndictions, the quadratic objective function from section\n2.2.2 can be re-written as follows:\n\nmin J\n?u\n\nsubject to\n\nJ = (Y? ?W)T R(Y? ?W) + ?uT Q?u,\nY? = F + GP NMP C\n\n(15)\n\nwhere W represents the vector of future reference, R\nthe error weighting matrix and Q the control weight-\ning matrix. The minimization of the cost function\nfor the case without constraints can be obtained by\nequating to zero the gradient of the cost function and\nin the case with constraints the solutions is obtained\nby solving a QP.\n\nThus, in terms of optimization, the PNMPC has a\ncomplexity similar to the DMC or the GPC algorithm.\nThe predictive control techniques applied to linear sys-\ntems use a mechanism that consists in correct the pre-\ndictions with the error between the measured value of\nthe controlled variable and its predicted value at time\nk. This technique applied to linear systems guaran-\nteed zero error in steady stated, because the increase\nin the control effort required for error correction at the\ninstant k will be the same in future instants due to the\nlinear relationship between the input and output, so\nthe gain is constant. The application of this proce-\ndure to the PNMPC technique applied to non-linear\nsystems does not guarantee null error in steady state,\nbecause the gain varies with the operating point of the\nsystem. The procedure to correct the predictions pre-\nsented in (Plucenio, 2010), consists in adding to each\nprediction the integral of the filtered prediction error.\nFigure 2 shows how the correction factor for each con-\ntrolled variable can be obtained. A correction factor\n\n? ?\n1\n\nF\nD q ? ?11\n\ni\nk\n\nq\n?\n\n?\n\n? ?1scy k k ?\n\n? ?n k? ? ?1y k k? ? ? ?e k\n\n? ?y k\n\n?\n?\n\n?\n\n?\n\n1\nq\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nFigure 2: Block diagram of the correction factor\n\nis added to the prediction so that the error between\nthe measured and the corrected value of prediction to\n\n133\n\n\n\nzero. The correction factor is obtained filtering and in-\ntegrating the error as shown in Figure 2. Considering\nthe controlled variable y(t), if the level error has a lin-\near approximation, the transfer function that relates\nthe error and the difference between the measured and\nthe predicted values of the variable without correction\ncan be obtained as shown in (16). It must be noted\nthat the error e(z) is defined as the difference between\nthe measured value and the corrected predicted value,\nwhereas (y(k) ? y?sc(k)) corresponds to the error be-\ntween the measured variable and the predicted value\nwithout correction.\n\ne(z)\n\n(y(k) ? y?sc(k))\n=\n\nz2 ? (1 + fd)z + fd\nz2 ? (1 + fd ?ki)z + fd\n\n(16)\n\nAssuming the closed loop system is stable, we can ap-\nply the Final Value Theorem to verify that the pres-\nence of (1?z?1) in the numerator of the transfer func-\ntion (16) guarantees null error in steady state for an\ninput of type step. The values of ki and fd are chosen\nby comparing the denominator of the transfer function\n(16) with the desired polynomial pd(z) = z\n\n2?2az+a2.\nThe value of a has an impact on the speed at which\nthe error responds to disturbances. After the value of\na is determined, fd and ki can be obtained through\nequations (17) and (18).\n\nfd = a\n2\n\n(17)\n\nki = 1 + a\n2 ? 2a\n\n(18)\n\n4 Implementation of PNMPC: Alternatives\n\nThe PNMPC presented in the previous section can be\nimplemented in different ways. The goal of this paper\nis to study the performance and the computational\ncost of the PNMPC controller, by using the following:\nsix different versions of the PNMPC implementation,\nas well as simplifications of the complete original tech-\nnique to reduce the processing time. The way of calcu-\nlating the predictions can be modified to convert the\nPNMPC into a linear MPC controller. Six versions of\nthe PNMPC will be applied to the conical tank. The\ngoal is to control the level of the tank through outlet\nvalve manipulation.\n\n4.1 1st version: PNMPC complete\n\nFollowing the PNMPC theory from (Plucenio, 2010),\nthe first PNMPC proposed in this paper considers the\nnon-linear free response and calculation of the matrix\nG in two steps. The first procedure of the algorithm is\nto calculate at a given iteration the variation of initial\ncontrol (?uini), which is calculated according to the\nexisting matrix G, that is, the matrix Gprevious. Ob-\ntaining the initial control variation, the future control\nactions are calculated according to the equation:\n\nUm\u00d71 = Hm\u00d71u (k ? 1) + TIm\u00d7m?uinim\u00d71 (19)\nwhere:\n\nm control horizon;\nH vector of ones;\nu(k ? 1) previous control action;\nTI integrating Toeplitz matrix;\n?uini initial control variation.\n\nWith the control action calculated, an initial predicted\noutput Y?0p is obtained. A control increment ? is added\nto the control vector U and a new output prediction\n(Y?) is obtained. This value ? will scroll through the\n?u vector in order to calculate the matrix GP NMP C\nas described in (Plucenio, 2010) and shown in equation\n(20).\n\nGP NMP C (:,m) =\nY?mp ? Y?0p\n\n?\n(20)\n\nIn fact, the calculation of the derivative of this new\ncontrol signal U, serves to compensate the non-\nlinearity of the system. Having the matrix G(k) at\nthe current time and the matrix G(k ? 1) calculated\nin the previous instant Gprevious, it is possible calcu-\nlate in two steps the intermediate matrix GP NMP C\nby the following equation:\n\nGP NMP C = 0.5G(k ? 1) + 0.5G(k) (21)\n\nThe algorithm implemented for this version is detailed\nin the flow diagram in Figure 3:\n\nFor 1: NumItera-1\n\n- Calculate the output of the plant        .\n- Updates the references.\n\ni==1\n\n- Obtain the vector     , executing the\nalgorithm that model the process,  using\nfuture null increments ?u =        \n\nT\n.\n\n- Calculation the free response without \ncorrection             .  \n\n- Get the  predictions vector, executing the  \nalgorithm that model the process, using     and      \nwith a little value of ? but not null  for calculating \n\nCalculate  ?u with Quadpro   \n\n- Calculate the error\n-  Calculate the Adjustment factor  \n-  Calculate the      \n- Calculate the\n- C\u00e1lculation of the free corrected \nresponse\n \n\nCalculate            depending  of        \n\n                 and    .\n\nCalculate\n\n- Get the  predictions vector, executing the  \nalgorithm that model the process, using     \nand      with a little value of ? but not null  \nfor calculating      \n\n- Calculate:\n\n- Calculate  \n\n- Calculate  ?u with Quadpro   \n\nCalculate the control law\n\nUpdate of the past outputs \nand the past action control.\n\n i>1\n\nPNMPC\nG\n\nini\nu?\n\n? ?1G k? F\n\n? ? ? ?1 iniu k u k u? ? ??\n\n- Calculate:\n\n? ?\n0\n\n: ,m\n\nm\n\np p\n\nPNMPC\n\nY Y\nG\n\n?\n\n?\n?\n\n? ? ? ?1u k u k u? ? ??\n\nPNMPC\nY F G u? ? ?\n\nmod el z\ny y?\n\nYes\n\nNo\n\nNo\n\nYes\n\n0\n\np\nY\n\n0\n\nP\nF Y?\n\n0\n\np\nY\n\n0\n\np\nF Y?\n\n? ?0.5 ( 1) ( )PNMPCG G k G k? ? ?\n\n? ?zy\n\ny u\n\nF F FAC? ?\n\nFAC\n\ny\nu\n\nPNMPC\nG\n\n? ?\n0\n\n: ,m ( )\n\nm\n\np p\n\nPNMPC\n\nY Y\nG G k\n\n?\n\n?\n? ?\n\nmodz el\ner y y? ?\n\nFor\n\nFigure 3: PNMPC complete algorithm flow diagram\n\n4.2 2nd version: PNMPC without calculation ?uini\n\nFor processes with a strong non-linear characteristic\nit is recommended to choose the complete PNMPC\ntechnique (first version), but if the process presents\na smooth non-linearity it may be possible to reduce\nthe computational cost by eliminating the calculation\nof ?uini. In this version it is proposed the calcula-\ntion of the GP NMP C matrix in one step. Therefore,\nit is not necessary to calculate ?uini. In order to\ncalculate the control action needed to obtain Y?0p the\nvalue of the control variation of the previous itera-\ntion is used. This Y?0p is then calculating the matrix\nGP NMP C , as shown in section three. Once the calcu-\nlation of ?uini is eliminated, the precision with which\nthe PNMPC calculates the GP NMP C decreases, this\ncan be explained as the ?uini has a direct influence\nin the calculation of the Y?0p, as it is directly involved\nin the calculation of the matrix GP NMP C .\n\n4.3 3rd version: PNMPC getting only the first col-\numn of G\n\nAs already described in the literature, the matrix\nG the one that is responsible to save the values of\nthe dynamics process (Camacho and C., 2007) and\n\n134\n\n\n\nthe GP NMP C is the non-linear version of the dy-\nnamic matrix used in the linear predictive control\n(Plucenio, 2010). One of the possibilities to reduce the\ncomputational cost is to calculate only the first column\nof the matrix G by the normal procedure of PNMPC\nand mount the matrix GP NMP C considering the sys-\ntem time-invariant, this procedure is commonly per-\nformed in linear systems (De Keyser, 1998). Thus the\nnon-linear optimization problem can be transformed\ninto a sequence of linear optimization problems. For\nthis it is necessary to check how much the diagonal\nelements of the matrix G vary. In the case where the\nvariations are not significant, one can opt for the tech-\nnique used in linear systems; only calculate the first\ncolumn of the matrix G and displaced until a lower\ntriangular matrix is obtained, that means treat the\nnon-linear process as if it were linear. In the case of\na non-linear process, it can be seen that the diago-\nnal elements of the matrix G present significant vari-\nations between the elements of the diagonal, however,\nin the case of a linear process, the diagonals elements\nof the matrix G do not present significant variations.\nTo check the degree of the non-linearity in the study\ncase, Figure 4(a) shows the variations in the diagonals\nelements of the matrix G calculated by the Jacobian\nmatrix (GP NMP C ). As this matrix is recalculated on\n\n(a) Non-linear dynamics\nmatrix\n\n(b) Linear dynamics ma-\ntrix\n\nFigure 4: Dynamic matrix GP NMP C\n\neach iteration, the data shown in Figure 4(a) repre-\nsent only a particular step, the iteration k = 35. As\nshown, the diagonal elements of the matrix GP NMP C\npresent variations, but these variations are small, so\nthey could be disregarded. Applying the third ver-\nsion of the PNMPC algorithm proposed in this paper,\nwhere only the first column of the matrix G is cal-\nculated, so that the new matrix G for iteration k =\n35 shown in Figure 4(b). In the Figure 4(b) the first\ncolumn of the matrix G is shifted m times, to form a\nlower triangular matrix, where m is the horizon con-\ntrol. With this modification, the computational cost\nfor the calculation of G decreases reasonably.\n\n4.4 4th version: PNMPC similar to 3rd version, but\nnow the matrix G is recalculated only from time\nto time.\n\nThis version is a very interesting and flexible option.\nThe process is treated as if it were linear and only the\nfirst column of G is calculated. However, the matrix\nG is not obtained at each iteration, it is recalculated\nevery n sampling times. An operator with knowledge\n\nof the process and the non-linearity degree can adjust\nthe value of n in each application. In the case study of\nthis paper, as shown in the previous version, the non-\nlinearity degree of the process is not significant, so\nthe recalculation of the matrix G does not need to be\nperformed at each iteration. For the testes was used\na recalculation every 25 samples. The choice of this\ntime was made taking care not to lose the dynamics\nof the process.\n\n4.5 5th version: PNMPC looking for free response\ntime to time, using the Cutler idea (Recursive\nDMC) to the other instants\n\nThis version seeks to reduce the computational cost\nin processes where the non-linearity is not significant,\ninserting in the PNMPC technique the calculation of\nfree response as is done in the recursive DMC proposed\nby Cutler. To (Cutler and Ramaker 1988), as shown\nin (Plucenio et al., 2014), the open-loop predictions\nfor time t + k, having information in t and t ? 1 are\nshown in the equations (22) and (23) respectively:\n\ny0 (t + k |t) =\n??\n\ni=k+1\n\ngi?u (t + k ? i) (22)\n\ny0 (t + k |t? 1 ) =\n??\n\ni=k+2\n\ngi?u (t + k ? i) (23)\n\nThe difference between the open-loop prediction\nin t + k having t, and in t + k having t ? 1, it is\nonly the new control action which is not known in\n?u(t ? 1). Subtracting the equations (22) and (23)\nhas the equation (24):\n\ny0 (t + k |t) ?y0 (t + k |t? 1 ) = gk+1?u (t? 1) +\n??\n\ni=k+2\n\ngi?u (t + k ? i) ?\n??\n\ni=k+2\n\ngi?u (t + k ? i) (24)\n\nwhich leads to the equation (25):\n\ny0 (t + k |t) = gk+1?u (t? 1) + y0 (t + k |t? 1 ) (25)\n\nThe recursive DMC calculation is executed as fol-\nlows: Keep in memory a vector with N elements:\nYfree = [y0 (t |t? 1 ) , ...,y0 (t + N ? 1 |t ? 1)]T . It\u2019s\nelements are the free responses given the known con-\ntrol actions at the moment t? 1. When starting the\nDMC controller at the moment t0, and as the system\nis in steady state, it is considered that the open-loop\npredictions are constant and equal to a value of y(t0).\nWhen starting the DMC algorithm at the moment t,\nthe vector of the free response must be updated be-\ncause the change of control action ?u(t?1) it is now\nknown. The vector Yfree of the equation (26) is up-\ndated.\n\nYfree = Yfree +\n\n?\n????\n\ng1\ng2\n...\ngN\n\n?\n???? ?u (t? 1) (26)\n\nAfter getting the new control signal u(t), it is nec-\nessary to \u2019displace\u2019 the values within the vector Yfree.\nAt time t + 1 the free responses in t + 1 until t + N is\nobtained based on the data until t, where N is called\n\n135\n\n\n\nthe model horizon. So the first element is discarded\nbecause it is the prediction concerning to instant t that\nhas passed. The problem is that making this displace-\nment, the last element ( y(t+N|t)) is unknown. There-\nfore, in the stable case y0(t + N|t) ?= y0(t + N ? 1|t),\nthe new vector Yfree will be given by the equation\n(27):\n\nYfree =\n\n?\n??????\n\ny0 (t + 1 |t)\ny0 (t + 2 |t)\n\n...\ny0 (t + N ? 1 |t)\ny0 (t + N ? 1 |t)\n\n?\n??????\n\n(27)\n\nThe condition y0(t+N|t) ?= y0(t+N?1|t) is shown as:\n\ny0 (t + N ? 1 |t) =\n??\n\ni=N\n\ngi?u (t + N ? 1 ? i)\n\ny0 (t + N |t) =\n??\n\ni=N+1\n\ngi?u (t + N ? i) =\n??\n\ni=N\n\ngi+1?u (t + N ? 1 ? i)\ny0 (t + N |t) ? y0 (t + N ? 1 |t) =\n\n??\ni=N\n\n(gi+1 ?gi) ?u (t + N ? 1 ? i)\nAs gi+1 ? gi ?= 0,?i > N, it has y0(t + N|t) ?=\n\ny0(t + N ? 1|t), as was able to demonstrate.\nThus, the calculation of free response considered\n\nin the DMC Recursive is given by the equation:\n\nf =\n\n?\n??\ny0 (t + 1 |t)\n\n...\ny0 (t + p |t)\n\n?\n?? + 1p\u00d71 (y(t) ?y0 (t |t)) (28)\n\nWhere the equation of the model error is:\n\ne = y(t) ?y0 (t |t) (29)\n\nAs shown in (Plucenio et al., 2014), the representa-\ntion of predictions considering the calculation of the\nfree response to the DMC Recursive is shown in the\nequation (30):\n\nY? = f + G?u (30)\n\nwhere:\n\nY? predicted output with dimension p\u00d7 1;\nf free corected response with dimension p\u00d7 1;\nG Jacobian matrix of Y? with dimension p\u00d7m;\n?u vector with dimension m\u00d7 1 containing the\n\nincrements of the control action.\n\nUsing this form of implementation, the necessary cal-\nculations to obtain the free response become more\nsimple, not requiring the storage of past control in-\ncrements. This procedure only changes the way to\ncalculate the free response, the rest of the control al-\ngorithm is not modified.\n\n4.6 6th version: PNMPC reassessing the matrix G\nand free response according to the prediction er-\nror\n\nThe idea of this version is calculate the absolute value\nof the prediction error, with the objective to fix a range\ntolerable error in which it is considered that the values\nobtained are acceptable, and it is not necessary to\nrecalculate the G matrix and the free response for\neach iteration.\n\nTable 1: Tuning parameters for the PNMPC con-\ntrollers\n\nParam Definition Value\n\np prediction horizon 12\nm control horizon 3\n? control-weighting factor 3\n? reference tracking weighting factor 1\n? reference filter 0.25\n? value for variation in control 0.01\na filter parameter for prediction error 0.15\n\nTable 2: Comparative table of the execution times\nfor the PNMPC versions\n\nExecution 1st version 2nd version 3rt version 4th version 5th version 6th version\n\n1 40.2191 38.1917 25.7825 19.3745 29.4440 27.5302\n2 39.5854 38.2922 25.6580 19.1152 29.9883 27.6980\n3 38.8933 38.4277 25.6750 19.1802 29.9960 27.6653\n4 38.9484 38.1932 25.6655 19.1637 29.2337 27.5607\n5 39.1778 38.3610 25.8829 19.0723 29.0735 27.4466\n6 39.0862 38.5138 25.6190 19.2308 29.0478 27.6603\n7 39.1187 38.6370 25.7077 19.2133 29.0250 27.4830\n8 39.1515 38.5807 25.7749 19.1650 29.0478 27.7040\n9 39.1868 38.7472 25.6909 19.2164 29.0875 27.6850\n10 38.9841 38.4975 25.7159 19.0694 29.4870 27.7875\n\nTot.time[s] 392.3513 384.4420 257.1723 191.8008 293.4296 276.2206\nAveraget.[s] 39.2351 38.4442 25.7172 19.1800 29.3429 27.6220\n\n5 Results\n\nThis section presents the results obtained in the differ-\nent versions implemented with the PNMPC technique.\nAs the main objective is to evaluate the computational\ncost involved in the implementation of the PNMPC\ntechnique, it will be shown the runtime obtained in\nthe calculation of the algorithm for each version of\nthe PNMPC applied in the case study on the non-\nlinear process of the level control of the conical tank.\nAll simulations were performed in MatLab 2013, on a\nPC with A8 quad-core processor, AMD with 1.9 GHz\nand 6GB of RAM, with Windows 8. To first obtain\nan accurate approximation of the model, the differ-\nential equation describing the model was integrated\nusing Ode45 function of MatLab. The tuning param-\neters used for the PNMPC controllers are the same\nfor all versions for comparison purposes, these values\nare shown in Table 1. The sample time for all versions\nis 10 second for reference greater than 1 meter and 1\nsecond for reference less than 1 meter . Table 2 shows\nruntime the values for each version of the PNMPC\ntechnique algorithm implemented in section 4.\n\nTo estimate the execution time of each algorithm,\neach version was executed 10 times and the final time\nwas calculated as the average of 10 executions. The\ntime is measured in seconds and the results are shown\nin Table 2.\n\nFigure 5 shows the results for two cases. The first\nfor reference greater than 1 meter (Figure 5(a), 5(c)\nand 5(e)) and the second test for reference less than 1\nmeter (Figures 5(b), 5(d) and 5(f)).\n\n6 Conclusions\n\nThis paper presented six different versions of the PN-\nMPC technique. With little modifications of the com-\nplete technique, either in the calculation of the free\nresponse or in assembling the matrix GP NMP C , the\nprocessing time is reduced. With these modifications\nthe PNMPC can be simplified and be converted into\na linear MPC controller. As shown in the results in\n\n136\n\n\n\n(a) Outputs for ref>1m (b) Outputs for ref<1m\n\n(c) Signals control for\nref>1m\n\n(d) Signals control for\nref<1m\n\n(e) Disturbance for\nref>1m\n\n(f) Disturbance for\nref<1m\n\nFigure 5: Outputs references, control signals, dis-\nturbance\n\nTable 3: Performance index of the PNMPC ver-\nsions\n\nPerformance index V1 V2 V3 V4 V5 V6\nMSE 0.0031 0.0040 0.0063 0.0085 0.0100 0.0096\nIAE 2.58 3.40 4.56 4.77 5.89 5.07\n\nFigures 5, the six versions implemented can follow ref-\nerence and reject disturbances in the both tests (ref-\nerence greater than 1 meter and reference less than 1\nmeter), however, the PNMPC can also reach the ref-\nerences and reject disturbances more quickly. As it is\nshown in Table 2 the computational cost is higher due\nto the complexity of calculation the PNMPC requires.\nOn the other hand, versions 3, 4, 5 and 6 which where\nwere part of the non-linearity process are soft; these\ncontrollers do manage to follow the reference and re-\nject disturbance, however, more slowly as compared\nto the complete PNMPC, which has a lower compu-\ntational cost.\n\nFigure 6 shows that, for significant height vari-\nations, the six versions have a good reference track-\ning, where the complete PNMPC reacts faster than\nthe linear controllers remembering that the computa-\ntional cost is greater. Comparing the results, it can be\nobserved that the six implemented algorithms have a\nvery similar response, although the complete PNMPC\nalgorithm provides the best results, where all can re-\nact properly to the disturbance, and where, the main\ndifference between them being the runtime. This can\nbe attributed to the \u201dsoft\u201d non-linearity of the pro-\ncess. Thus, a study of the behavior process can lead to\nan implementation with gains in terms of processing\ntime without a significantly compromise of the perfor-\nmance. Table 3 shows the comparison of the perfor-\nmance index of MSE (mean squared error) and IAE\n(integral of the absolute magnitude of the error) for\nPNMPC versions.\n\n0 0.5 1 1.5\n0\n\n0.5\n\n1\n\n1.5\n\nTime [min]\n\nL\nev\nel\n[m\n]\n\nyr\ny1\ny2\ny3\ny4\ny5\ny6\n\n(a) Outputs for significant\nheight variation\n\n0 0.5 1 1.5\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nTime [min]\n\nV\na\nlv\n.O\np\nen\nin\ng\n\nU1\nU2\nU3\nU4\nU5\nU6\n\n(b) Signals control for signifi-\ncant height variation\n\nFigure 6: Outputs and signal control for signifi-\ncant height variation\n\nAcknowledgments\n\nThe authors wish to extend his gratitude for the fi-\nnancial support he received from PRH-34 The Agency\nNational of Petroleum (ANP), oil, Gas, and Biofuels.\n\nReferences\n\nCamacho and C., B. (2007). Model Predictive Control,\nsegunda edn.\n\nDe Keyser, R. (1998). A gentle introduction to model\nbased predictive control, PADI2 International\nConference on Control Engineering and Signal\nProcessing .\n\nGarc??a, Carlos E.; Prett, D. M. (1989). Model pre-\ndictive control: Theory and practice-a survey,\nInternational Federation of Automation Control\n25(3): 14.\n\nNormey, J. E. and Camacho, E. F. (2007). Control of\nDead time processes.\n\nPlucenio, A. (2010). Desenvolvimento de te?cnicas de\ncontrole na?o linear para elevac?a?o de fluidos multi-\nfa?sicos, Dissertac?a?o de doutorado-engenharia de\nautomac?a?o e sistemas, Centro Tecnolo?gico, Uni-\nversidade Federal de Santa Catarina, Floriano?po-\nlis\u201d.\n\nPlucenio, A., Campos, M., Vasconcellos, L. and\nDe Gomes, M. (2014). Model predictive con-\ntrol algorithm with stability step, Congresso\nBrasileiro de Automa?tica .\n\nPlucenio, A., J., N., D., P. and A., B. (2007). Controle\npreditivo na?o linear na indu?stria do petro?leo e\nga?s, PDPETRO .\n\nQina, S. J. and Badgwell, T. A. (2003). A survey\nof industrial model predictive control technology,\nControl Engineering Practice 11 11: 733\u2013764.\n\n137\n\n\n\nDMC de forma recursiva aplicando o passo de\nestabilidade\n\nBryant Bruce Picon Yang\nDto. de Automac?a?o e Sistemas\n\nUniversidade Federal de Santa Catarina\nFloriano?polis, SC - Brasil 88040-900\nEmail: bryant.bruce@posgrad.ufsc.br\n\nAgustinho Plucenio\nFirenze-Consultoria em Engenharia e informa?tica\n\nSa?o Jose?, SC - Brasil 88102-000\nEmail: plucenio@firenzeconsult.com\n\nResumo\u2014 Grande parte dos processos existentes na\nindu?stria de petro?leo e ga?s utiliza controladores pre-\nditivos. A crescente utilizac?a?o dessas estrate?gias pode\nser atribu??da ao fato de elas facilitarem a declarac?a?o\nde problemas de controle relativamente complexos,\ncomo os casos de controle de processos multivaria?veis,\nprocessos integradores, processos insta?veis, processos\nna?o lineares e processos com atraso de transporte. Este\ntrabalho apresenta uma abordagem que e? orientada\nao controle de plantas monovaria?veis e multivaria?veis,\ncom mu?ltiplas incertezas no modelo incluindo ganho,\nconstante de tempo e atraso de transporte, que repre-\nsentam os casos mais comuns na indu?stria de proce-\nssos. E? implementado o algoritmo MPC com passo de\nestabilidade, a ac?a?o de controle e? calculada em dois\npassos, garantindo estabilidade e robustez na planta,\nprovocando uma melhora na rejeic?a?o a perturbac?o?es\nna?o modeladas. Os resultados sa?o comparados com o al-\ngoritmo DMC de forma recursiva, aplicando a filtragem\ndo erro de predic?a?o.\n\nI. Introduc?a?o\n\nA te?cnica de Controle Preditivo Baseado em Modelo\n(Model Based Predictive Control, MBPC ou Model Pre-\ndictive Control, MPC), e? uma das te?cnicas de controle\nmoderno mais avanc?adas. Em sua forma mais geral, aceita\nqualquer tipo de modelo, func?o?es objetivo ou restric?o?es [1].\nUm dos motivos para o e?xito desta te?cnica e? a maneira na\nqual os problemas de controle sa?o formulados no dom??nio\ndo tempo [2], permitindo que os algoritmos sejam muito\nmais simples de compreender.\n\nAs diferenc?as entre os diversos algoritmos existentes\ndevem-se basicamente a? forma de escolher os modelos de\npredic?a?o para o processo, a forma como as perturbac?o?es e\nos erros de predic?a?o sa?o tratados, o tipo de func?a?o objetivo\ne o procedimento para o ca?lculo do sinal de controle [3]. O\nmodelo de predic?a?o e? o elemento mais importante dentro\ndo projeto do controlador. Sua importa?ncia se deve ao fato\nde que ele deve ser capaz de representar adequadamente a\ndina?mica do processo para permitir o ca?lculo das predic?o?es\nda sa??da, ser intuitivo e ao mesmo tempo permitir uma\nana?lise teo?rica do sistema.\n\nEm geral, o modelo utilizado para o projeto do con-\ntrolador MPC e? separado em duas partes: O modelo do\nprocesso propriamente dito e o modelo das perturbac?o?es;\n\nambos necessa?rios para o ca?lculo das predic?o?es, da?? o nome\nModelo de Controle Preditivo [7].\n\nO interesse pelos controladores MPC aplicados em con-\ntrole de processos industriais remete a um conjunto de\nartigos apresentados no final de 1970. A apresentac?a?o do\nModel Predictive Heuristic Control (MPHC), por [4], e a\ndo Dynamic Matrix Control (DMC), por [5] engenheiros\nda Shell Oil Co, entre outros artigos, foram marcos iniciais\nno uso de MPC na indu?stria. Posteriormente, a capacidade\ndo MPC de alcanc?ar sistemas de controle altamente efi-\ncientes, determinando uma condic?a?o favora?vel de operac?a?o\nmesmo em situac?o?es adversas, vem mostrando um ra?pido\nprogresso em pesquisas acade?micas e aplicac?o?es industriais\n[6].\n\nUm componente comum no comportamento dos proce-\nssos industriais, principalmente nos processos da indu?stria\nde petro?leo e ga?s, e? o atraso de transporte. Na pra?tica, tem-\nse muitos processos industriais onde o atraso e? causado\npelo transporte de material, energias ou pelo acu?mulo de\ninformac?a?o no sistema. Nesse caso, o sistema na?o responde\nimediatamente. Ele leva algum tempo para exibir em sua\nsa??da os efeitos de uma entrada [8].\n\nAlguns trabalhos apresentaram estrate?gias interessantes\npara contornar o problema do atraso de transporte e obter\nmelhor desempenho dos controladores. A maioria dessas\nestrate?gias sa?o baseadas nas ideias do preditor de Smith\n[9].\n\nEm [10] foi proposto um trabalho aplicando o algoritmo\nDMC que e? amplamente utilizado nas a?reas industriais, um\nfiltro e? inclu??do no modelo de predic?a?o do controlador para\nconseguir rejeic?a?o da perturbac?a?o e melhorar a robustez,\nespecialmente quando sa?o considerados mu?ltiplos atrasos\nde transporte e erros no modelo.\n\nO algoritmo DMC e? modificado para um DMC de forma\nrecursiva, implementado segundo [5], e e? aplicado um filtro\nno erro de predic?a?o partindo da ideia do preditor de Smith.\n\nSegundo [5], as predic?o?es de malha aberta em t+k, dado\nas informac?o?es em t e t + 1 sa?o mostradas nas equac?o?es\n(1) e (2) respectivamente:\n\ny0 (t + k |t) =\n??\n\nj=k+1\n\ngj?u (t + k ? j) (1)\n\n138\n\n\n\ny0 (t + k |t? 1 ) =\n??\n\nj=k+2\n\ngj?u (t + k ? j) (2)\n\nOnde a diferenc?a entre a predic?a?o de malha aberta em\nt + k dado t, e em t + k dado t? 1, e? apenas a nova ac?a?o\nde controle que na?o e? conhecida em ?u(t?1). Subtraindo\nas equac?o?es (1) e (2) tem-se a equac?a?o (3):\n\ny0 (t + k |t) ?y0 (t + k |t? 1 ) =\ngk+1?u (t? 1) +\n\n??\nj=k+2\n\ngj?u (t + k ? j) +\n\n?\n??\n\nj=k+2\n\ngj?u (t + k ? j)\n(3)\n\nenta?o tem-se a equac?a?o (4):\n\ny0 (t + k |t) = gk+1?u (t? 1) + y0 (t + k |t? 1 ) (4)\nO ca?lculo do DMC de forma recursiva e? feito da seguinte\n\nforma: Mante?m-se em memo?ria um vetor com N elemen-\ntos, Ylivre = [y0 (t |t? 1 ) , ...,y0 (t + N ? 1 |t ? 1)]T , onde\nN e? chamado de horizonte de modelo. Seus elementos sa?o\nas respostas livres dadas as ac?o?es de controle conhecidas\nate? o instante t ? 1. Ao iniciar o controlador DMC no\ninstante t0, dado que o sistema encontra-se em regime\npermanente, considera-se que as predic?o?es de malha aberta\nsejam constantes e iguais ao valor de y(t0).\n\nAo iniciar a execuc?a?o do algoritmo DMC no instante t,\ne? preciso atualizar o vetor da resposta livre, pois o incre-\nmento da ac?a?o de controle ?u (t? 1) agora e? conhecido.\nO vetor Ylivre da equac?a?o (5) e? atualizado.\n\nYlivre = Ylivre +\n\n?\n????\n\ng1\ng2\n...\ngN\n\n?\n???? ?u (t? 1) (5)\n\nApo?s obter o novo sinal de controle u(t), e? preciso\ndeslocar os valores dentro do vetor Ylivre. Isto porque\nno instante posterior t + 1, sera?o requeridas as respostas\nlivres de t + 1 ate? t + N baseadas nos dados ate? t. Enta?o o\nprimeiro elemento e? descartado, pois e? a predic?a?o relativa\nao instante t que ja? passou. O problema e? que, ao se fazer\neste deslocamento, o u?ltimo elemento, no caso a predic?a?o\nem y(t + N|t), e? desconhecida. Pore?m, se o sistema for\nesta?vel, pode-se considerar y0(t + N|t) ?= y0(t + N ? 1|t).\nAssim, o novo vetor Ylivre sera? dado pela equac?a?o (6):\n\nYlivre =\n\n?\n??????\n\ny0 (t + 1 |t)\ny0 (t + 2 |t)\n\n...\ny0 (t + N ? 1 |t)\ny0 (t + N ? 1 |t)\n\n?\n??????\n\n(6)\n\nA condic?a?o y0(t + N|t) ?= y0(t + N ? 1|t) e? mostrada\ncomo:\n\ny0 (t + N ? 1 |t) =\n??\n\nj=N\n\ngj?u (t + N ? 1 ? j)\n\ny0 (t + N |t) =\n??\n\nj=N+1\n\ngj?u (t + N ? j) =\n??\n\nj=N\n\ngj+1?u (t + N ? 1 ? j)\ny0 (t + N |t) ? y0 (t + N ? 1 |t) =\n??\n\nj=N\n\n(gj+1 ?gj) ?u (t + N ? 1 ? j)\nComo gj+1 ?gj ?= 0,?i > N, tem-se que y0(t + N|t) ?=\n\ny0(t + N ? 1|t), como se queria demonstrar.\nAssim, o ca?lculo da resposta livre considerada no DMC\n\nde forma recursiva, e? dado pela equac?a?o:\n\nf =\n\n?\n??\ny0 (t + 1 |t)\n\n...\ny0 (t + p |t)\n\n?\n?? + 1p\u00d71 (y(t) ?y0 (t |t)) (7)\n\nNo algoritmo DMC o erro entre a sa??da medida e a sa??da\npredita no instante k e? usado para corrigir as predic?o?es de\ncada estado de todos os elementos dentro do horizonte de\npredic?a?o p. Onde a equac?a?o do erro do modelo e?:\n\ne = y(t) ?y0 (t |t) (8)\nComo e? mostrado em [13], a representac?a?o das predic?o?es\n\nconsiderando o ca?lculo da resposta livre com o DMC de\nforma recursiva, e? obtida com a equac?a?o (9):\n\nY? = f + 1p\u00d71e + G?u (9)\n\nonde:\n\n\u2022 Y? sa??da predita de dimensa?o p\u00d7 1 ;\n\n\u2022 f vetor da resposta livre de dimensa?o p\u00d7 1 ;\n\n\u2022 G matriz jacobiana de Y? de dimensa?o p\u00d7m;\n\n\u2022 ?u vetor de dimensa?o m\u00d7 1 que conte?m os\nincrementos na ac?a?o de controle .\n\nOnde p e? o horizonte de predic?a?o e m e? o horizonte de\ncontrole.\n\nUtilizando esta forma de implementac?a?o, os ca?lculos\nnecessa?rios para obter a resposta livre tornam-se mais\nsimples, na?o sendo necessa?rio o armazenamento dos incre-\nmentos de controle passados. Com este procedimento, so?\ne? alterado o modo de calcular a resposta livre, o restante\ndo algoritmo de controle na?o e? modificado.\n\nComo o erro de predic?a?o e? expl??cito no DMC de forma\nrecursiva, e? poss??vel inserir um filtro de forma simples:\n\ny? (t + k | t) =\nk?\n\nj=1\n\ngj?u (t + k ? j) +\n\ny0 (t + k | t) + F\n(\nz?1\n)\n\n(y (t) ?y0 (t | t)) (10)\n\nE? poss??vel filtrar o erro de predic?a?o separadamente e\nadiciona?-lo a? predic?a?o de malha aberta yo.\n\n139\n\n\n\nO filtro discreto fica na forma:\n\nef (k) = ?ef (k ? 1) + (1 ??) e (k) . (11)\n\nCom 0 ? ? &lt;1 para o erro filtrado inserido na predic?a?o.\nA equac?a?o (9) pode ser reescrita como:\n\nY? = f + 1p\u00d71ef + G?u (12)\n\nO efeito do filtro e? ana?logo ao me?todo utilizado no\nalgoritmo DTC-GPC descrito em [11]. A ide?ia de aplicar\num filtro no erro de predic?a?o para corregir as predic?o?es,\npode ser aplicado a outros algoritmos MPC, como por\nexemplo: GPC, DMC e PNMPC dentre as te?cnicas de\ncontrole preditivo na?o linear proposto por [12], que vem\napresentando bom desempenho e vasta possibilidade de\naplicac?a?o, que se torna interessante quando avalia-se sim-\nplicidade.\n\nExistem varias pesquisas sobre algoritmos MPC para\nmodelos de predic?a?o com incerteza, nos quais se propo?em\nestrate?gias para tratar este problema e uma revisa?o na?o e?\no propo?sito neste artigo.\n\nO uso de filtragem no erro de predic?a?o e? muito inte-\nressante para o controle de plantas com erros de atraso\nde transporte no modelo. Este me?todo tambe?m lida com\noutros erros, mas os erros de tempo morto sa?o os mais\ncr??ticos, ja? que podem facilmente instabilizar processos.\n\nEm geral, o filtro na?o afeta a resposta do sistema quando\no modelo e? perfeito, mas sim quando existe erro no atraso\nde transporte, no ganho e nas constantes de tempo entre\na planta real e o modelo de predic?a?o. Ale?m disso, muita\nfiltragem no sistema pode resultar numa resposta mais\nlenta a perturbac?o?es.\n\nNeste trabalho, apresenta-se a comparac?a?o do me?todo\naplicando o filtro no erro de predic?a?o e o me?todo proposto\npor [12], que e? aplicado a plantas esta?veis em malha aberta\ncom erros no modelo de predic?a?o. No me?todo proposto em\n[12] nenhum filtro e? utilizado. Em vez disso, o algoritmo\nMPC com passo de estabilidade propo?e tratar o problema\nem dois passos:\n\n1) Passo de estabilidade\n2) Passo de ca?lculo de controle\n\nNo passo de estabilizac?a?o, um sinal sera? calculado e\nadicionado ao vetor do erro de predic?a?o, estabilizando\na planta. O passo de ca?lculo de controle usara? o erro\nmodificado sobre o ca?lculo do sinal de controle.\n\nO artigo e? organizado da seguinte forma. Na Sec?a?o\nII o algoritmo para obter o sinal de correc?a?o de erro\nsera? derivado. Na Sec?a?o III sera?o mostradas as simulac?o?es\nobtidas aplicando o DMC de forma recursiva com a te?c-\nnica de filtragem no erro de predic?a?o e com a te?cnica\ndo passo de estabilidade, ambas aplicadas num reator\nqu??mico com duas varia?veis manipuladas e duas varia?veis\ncontroladas, comumente visto nas indu?strias petroqu??mi-\ncas. Para demonstrar a efica?cia desta te?cnica, erros de\nmodelagens sera?o inseridos. Finalmente, na Sec?a?o IV sera?o\napresentadas as respectivas concluso?es do trabalho.\n\nII. DMC de forma recursiva com passo de\nestabilidade para compensac?a?o de erros no\n\nmodelo de predic?a?o\n\nUma das possibilidades de tratar os erros de predic?a?o e?\natrave?s da aplicac?a?o de filtros no erro de predic?a?o. Essa\nestrate?gia tem a finalidade de melhorar a robustez da\nplanta frente a erros de modelo.\n\nComo mencionado na sec?a?o anterior, no algoritmo DMC\nproposto em [5], a correc?a?o de erro aplicados a?s predic?o?es\nfoi assumida constante e igual ao erro actual. A te?cnica de\nfiltragem descrita na sec?a?o 1, aplica um filtro no erro de\npredic?a?o partindo da ideia do preditor de Smith.\n\nUma outra proposta e? a descrita em [13], onde se busca\num sinal que, somado ao erro verdadeiro, proporcione\nrobustez e estabilidade em plantas com erros de modelo\ne um melhor desempenho frente a perturbac?o?es. Esta\nsoluc?a?o e? a derivada do erro de correc?a?o EL que e? somado\nao vetor de erro E.\n\nUma primeira opc?a?o para obter EL e? utilizar p poss??veis\ndiferentes elementos. No entanto, isso pode trazer um\nelevado custo computacional. Assim, apresentam-se outras\nopc?o?es para o projeto do vetor EL conforme [13]:\n\na: aplicando um horizonte de correc?a?o de erro pL =\np? ?p e ?p elementos nulos;\n\nb: aplicando um horizonte de correc?a?o de erro pL\ne repetindo o u?ltimo elemento do horizonte para\ntodos os p?pL elementos seguintes;\n\nc: usando o conceito de blocking, onde EL e?\npreenchido com nL grupo de diferentes valores\nposs??veis;\n\nd: preenchendo o vetor de tamanho p??p com um\nu?nico valor de EL e ?p elementos nulos.\n\nL\nE\n\nL\np\n\npp p??\n\n(a)\n\nL\nE\n\nL\np\n\npp p??\n\n(b)\n\nL\nE 4Lp ?\n\np p? ? p\n\n(c)\n\nL\nE 1\n\nL\np ?\n\np p? ? p\n\n(d)\n\nFig. 1. Formas de implementar EL\n\nPara evitar que o requisito de estabilidade perturbe o\nseguimento da refere?ncia quando se tem EL definido em\ntodos os elementos p, e? importante ter alguns dos u?ltimos\ncomponentes de EL nulos. Isso tem o significado de dizer\nao algoritmo que a correc?a?o total deve convergir para\naquela utilizada pelo DMC de Cutler no final do horizonte\nde predic?a?o.\n\n140\n\n\n\nQualquer que seja a opc?a?o escolhida dentre as men-\ncionadas anteriormente, o vetor final de estabilizac?a?o da\ncorrec?a?o do erro e? expresso por:\n\nEs = E + M ? EL (13)\nonde:\n\nEL: e? o vetor com todas correc?o?es do erro\nde Lyapunov das varia?veis controladas[\nE1L E\n\n2\nL . . . E\n\nm\nL\n\n]T\n,\n\nE: e? o vetor com todos os erros verdadeiros das\nvaria?veis controladas\n\n[\nE1 E2 . . . Em\n\n]T\n,\n\nEs: e? o vetor com todos os erros modificados,\nM: e? uma matriz com dimensa?o\n\n?1\nm p \u00d7\n\n?1\nm p. E?\n\ncomposto de uns e zeros, de tal maneira que\nimplementa as estrate?gias mostradas na Figura\n1.\n\nUma outra opc?a?o para obter o vetor EL, e? aplicar\no segundo me?todo de Lyapunov para estabilidade. Esse\nme?todo se baseia na analogia de uma func?a?o de Lyapunov\nV (x) com energia ou potencial EL [14]. Se x e? um ponto\nque tem um equil??brio em 0, enta?o se existe um V (x) tal\nque:\n\nV (x) > 0 para qualquer x 6= 0 e\nV (x) = 0 so? para x = 0\n\n(14)\n\nEnta?o, se:\ndV (x)\n\ndt\n? 0 (15)\n\nx e? esta?vel no sentido de Lyapunov. Se\ndV (x)\n\ndt\n? 0\n\ne\ndV (x)\n\ndt\n= 0. So? em caso de de x = 0 o sistema e?\n\nassintoticamente esta?vel. Este e? um resultado muito bem\naceito e a base para muitos estudos de estabilidade [13].\n\nPara plantas esta?veis em malha aberta, onde a instabi-\nlidade e? causada pela ac?a?o de controle devido a erros do\nmodelo de predic?a?o, e? natural considerar como uma func?a?o\nde Lyapunov:\n\nL =\n1\n\n2\n?uT ?u (16)\n\nObserve que L e? uma func?a?o Lyapunov candidata,\nva?lida desde que ?u = 0 seja a condic?a?o de equil??brio\npara:\n\nL (0) = 0 e\nL > 0 para qualquer ?u 6= 0 (17)\n\nConsiderando um caso irrestrito, onde:\n\n?u = K (W ? F)\n\nK =\n(\nGT RG + Q\n\n)?1\nGT R\n\nF = Fsc + E + MEL\n\n(18)\n\nNa equac?a?o (18), W representa o vetor de trajeto?rias\ndesejadas dentro do horizonte de predic?a?o, F e? a resposta\nlivre corrigida no horizonte de predic?a?o, R e Q sa?o as\n\nmatrizes de ponderac?a?o do set-point e de supressa?o de\nmovimento, Fsc e? a resposta livre sem correc?a?o ao longo do\nhorizonte de predic?a?o p, E e? o vetor do erro de predic?a?o\nno instante atual, EL e? o vetor do erro de estabilidade\nde Layapunov, que e? calculado para corrigir o erro de\npredic?a?o.\n\nA fim de assegurar estabilidade, deve-se cumprir ?L\n?t\n? 0.\n\n?L\n?t\n\npode ser calculado como:\n\n?L\n?t\n\n= ?L\n??u\n\n??u\n?EL\n\n?EL\n?t\n,ou\n\n?L\n?t\n\n= ?uT (?KM) ?EL\n?t\n\n(19)\n\nFazendo substituic?o?es:\n\n?L\n\n?t\n= ?(W ? Fsc ? E ? MEL)T KT KM\n\n?EL\n?t\n\n(20)\n\nO termo EL\n?t\n\npode ser reescrita como EkL ? E\nk?1\nL .\n\nAssim, a expressa?o final para a equac?a?o (20) torna-se:\n\n?L\n?t\n\n= 1\n2\nETL?LEL ? 12 ?\n\nT\nLEL +\n\n1\n2\nD\n\n?L = M\nT KT KM\n\nA = W ? Fsc ? E\n\nB = MT KT K\n\n?L = ?LE\nk?1\nL + BA\n\nD = AT BT Ek?1L\n\n(21)\n\nTendo a expressa?o para ?L\n?t\n\n, pode-se formular o seguinte\nproblema de otimizac?a?o:\n\nmin\nEL\n\nJ\n\nsujeito a :\n\nJ = 1\n2\nETL?EL ? 12 ?\n\nT\nLEL +\n\n1\n2\nfP D (EL)\n\n(22)\n\nOs dois primeiros termos da equac?a?o (22) representam a\nexpressa?o ?L\n\n?t\n, exceto para o termo D na?o relacionado com\n\nEL. A ideia e? que o valor encontrado de EL obrigue o\ntermo ?L\n\n?t\n? 0 a ficar negativo. Pore?m, isto deve ter um\n\nlimite, e essa e? a raza?o da presenc?a do termo fDP (EL).\nUma func?a?o positiva definida sobre EL deve ser concebida\ncom o objetivo de se contrapor ao termo negativo de\nJ. Ale?m disso, a func?a?o deve incluir ponderac?o?es para\najustar uma melhor sintonia do controlador. A primeira\nfunc?a?o candidata e? ETLM\n\nT SLMEL. Os valores da diagonal\nda matriz de ponderac?a?o SL atuam com o objetivo de\nsuprimir EL, a fim de evitar que o valor\n\n?L\n?t\n\nseja negativo.\nNo entanto, o papel desta func?a?o e? limitado a suprimir\nos valores negativos em J e na?o contribui para qualquer\noutro atributo do sistema sob controle.\n\nOutra func?a?o candidata definida positiva e?(\nY? ? W\n\n)T\nSL\n\n(\nY? ? W\n\n)\n. Onde Y? = Fsc + E +\n\n141\n\n\n\nMEL + GK (W ? (Fsc + E + MEL)). O objetivo desta\nfunc?a?o e? suprimir os valores negativos de J, estabelecendo\numa relac?a?o entre o principal objetivo, que e? evitar ?L\n\n?t\nseja negativo, garantindo o seguimento da refere?ncia. Os\nelementos positivos da matriz diagonal SL sa?o ajustados a\nfim de obter EL que proporcione estabilidade e seguimento\nda refere?ncia para o sistema sob controle.\n\nFinalmente, o problema de otimizac?a?o quadra?tica para\nobter EL e? formulado como:\n\nmin\nEL\n\nJ\n\nsujeito a :\n\nJ = 1\n2\nETL?EL ? 12 ?\n\nT EL\n\n? = MT\n(\nKT K + ZT SLZ\n\n)\nM\n\nZ = GK ? I?n\n1\np\u00d7\n\n?\nn\n1\np\n\n?T = ?LE\nk?1\nL + BA + M\n\nT ZT SLZA\n\n(23)\n\nPara o caso sem restric?o?es, o valor do vetor EL que\nminimiza J e?:\n\nEL = 0.5?\n?1? (24)\n\nA matriz ? sera? definida positiva, desde que a matriz\nde ponderac?a?o diagonal SL seja escolhida com valores\npositivos.\n\nUm aspecto interessante desta metodologia e? que restri-\nc?o?es em ?u e u podem ser atendidas na etapa de esta-\nbilidade. Introduzindo restric?o?es no sistema, os seguintes\ntermos se podem escrever como:\n\n?u ? B e? equivalente a :\n\nK (W ? Fsc ? E ? MEL) ? B\n\nou :\n\n?KMEL ? B ? K (W ? Fsc ? E)\n\n(25)\n\nO vetor u pode ser escrito como: u = uk?11m\u00d71 +\nTI ?u, onde TI e? a matriz Toeplitz integradora, e 1m\u00d71\ne? um vetor de uns para um caso SISO pelo que se torna\nsimple de implementar como e? mostrado:\n\nu ? C e? equivalente a :\n\nuk?11m\u00d71 + TI K (W ? Fsc ? E ? MEL) ? C\n\nou :\n\nTI KMEL ? C ? uk?11m\u00d71 ? TI KA\n\nA = W ? Fsc ? E\n\n(26)\n\nAo introduzir estas restric?o?es na programac?a?o quadra?tica,\ndada pela equac?a?o (23), o valor de EL obtido pode ser\nusado na equac?a?o (27) para derivar ?u.\n\n?u = K (W ? F)\n\nF = Fsc + E + MEL\n\n(27)\n\nO vetor ?u obtido provera? estabilidade ao sistema\nrespeitando as restric?o?es impostas em ?u e u. O resultado\ne? interessante, uma vez que resolve uma dificuldade que e?\na de garantir a estabilidade com restric?o?es.\n\nIII. Simulac?o?es e resultados\n\nNesta sec?a?o, os resultados de simulac?a?o sa?o apresentados\naplicando as te?cnicas discutidas nas sec?o?es anteriores. O\nalgoritmo DMC de forma recursiva sera? implementado\nnum reator de tanque agitado, como mostrado na Figura\n2 e descrito pelo modelo com a seguinte matriz de\ntransfere?ncia (as constantes de tempo sa?o expressos em\nminutos) [11]:\n\n[\nY1 (s)\nY2 (s)\n\n]\n=\n\n?\n??\n\ne?0.24s\n\n1+0.7s\n5e?0.24s\n\n1+0.3s\n\ne?0.09s\n\n1+0.5s\n2e?0.09s\n\n1+0.4s\n\n?\n??\n[\nU1 (s)\nU2 (s)\n\n]\n\nTT\n\nReator\n\nAlimenta\u00e7\u00e3o\n\nRefrigerante\n\nEfluente\n\nFig. 2. Reator de tanque agitado\n\nAs varia?veis manipuladas U1 (s) e U2 (s) sa?o respectiva-\nmente a vaza?o de alimentac?a?o e a vaza?o do fluido refri-\ngerante no revestimento. As varia?veis controladas Y1 (s) e\nY2 (s) sa?o a concentrac?a?o do efluente e a temperatura do\nreator, respectivamente. Como se pode observar na matriz,\nexiste influe?ncia entre as varia?veis controladas, ja? que o\nsistema e? acoplado.\n\nUtilizando um tempo de amostragem de Ts = 0, 03min\no modelo discretizado e? mostrado nas seguinte matriz\ncom func?o?es de transfere?ncia discretas:\n\n[\ny1 (t)\ny2 (t)\n\n]\n=\n\n?\n??\n\n0.0420z?1\n\n1?0.9580z?1 z\n?8 0.4758z?1\n\n1?0.9048z?1 z\n?8\n\n0.0582z?1\n\n1?0.9418z?1 z\n?3 0.1445z?1\n\n1?0.9277z?1 z\n?3\n\n?\n??\n[\nu1 (t)\nu2 (t)\n\n]\n\nOs tempos mortos neste caso sa?o causadas por efeitos de\nmedic?a?o. O tempo morto na temperatura de sa??da y2 (t) e?\no tempo necessa?rio para transportar o fluido para o sensor.\n\n142\n\n\n\nO tempo morto na concentrac?a?o y1 (t) e? causada pelo efeito\nde transporte e o tempo requerido pelo analisador. Os\ntempos mortos m??nimos sa?o: d1 = 8 e d2 = 3.\n\nImplementando o DMC de forma recursiva com a te?c-\nnica de passo de estabilidade, foi percebido que con-\nsiderando so? a matriz de ponderac?a?o SL, o valor desta\ntinha que ser muito pequeno, com o que ? da equac?a?o (23),\nresultava em valores muito pequenos. Tentando melhorar\nisso, foi considerada a incorporac?a?o de uma outra matriz\nde ponderac?a?o denominada PL, em ? e B como se mostra\nna equac?a?o (28):\n\nB = MT KT PLK\n? = MT\n\n(\nKT PLK + Z\n\nT SLZ\n)\nM\n\n(28)\n\nA Figura 3 mostra as respostas ao degrau com seus\nrespectivos atrasos de transporte para cada func?a?o de\ntransfere?ncia.\n\n0 50 100 150\n0\n\n0.5\n\n1\ng11\n\nResposta ao \ndegrau FT11\n\n0 50 100 150\n0\n\n2\n\n4\n\n6\ng12\n\nResposta\nao degrau FT12\n\n0 50 100 150\n0\n\n0.5\n\n1\ng21\n\nResposta\nao degrau FT21\n\n0 50 100 150\n0\n\n0.5\n\n1\n\n1.5\n\n2\ng22\n\nResposta ao \ndegrau FT22\n\nFig. 3. Resposta ao degrau das func?o?es de transfere?ncia\n\nA Figura 4 mostra os erros no atraso de transporte e no\nganho, entre a planta real e o modelo de predic?a?o. Como\npode-se observar nesta figura, no primeiro teste, na?o foram\nconsiderados erros de modelo, no atraso de transporte nem\nno ganho. As resposta do sistema sem erros, e? mostrado na\nfigura 5. Pode-se observar que aplicando as duas te?cnicas,\nse obte?m um bom seguimento da refere?ncia e rejeic?a?o\ndas perturbac?o?es na?o modeladas. Mas se percebe que a\nutilizac?a?o do filtro no erro de predic?a?o deixa o resposta\nlenta em comparac?a?o como a resposta aplicando a ide?ia\ndo passo de estabilidade.\n\nTodas as func?o?es de transfere?ncia sa?o sistemas de\nprimeira ordem com atraso de transporte. Um outro teste\ne? mostrado na figura 5, a? esquerda os atrasos de transporte\nutilizados no modelo de predic?a?o e os utilizados para\nsimular a planta real. Na direita mostra a relac?a?o dos\nerros no ganho entre a simulac?a?o da planta real e os erros\nnos ganhos do modelo de predic?a?o. Como observado nesta\nfigura, a dista?ncia existente entre o quadrado e o c??rculo\nrepresenta a incerteza introduzida no sistema.\n\nFT11 FT12 FT21 FT22\n3\n\n3.5\n\n4\n\n4.5\n\n5\n\n5.5\n\n6\n\n6.5\n\n7\n\n7.5\n\n8\nAtrasos\n\nAtr. usados predi\u00e7\u00e3o\nAtrasos reais simulados\n\nFT11 FT12 FT21 FT22\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\n\n3\n\n3.5\n\n4\n\n4.5\n\n5\nGanhos\n\nGanhos usados predi\u00e7\u00e3o\nGanhos reais simulados\n\nFig. 4. Erros usados na simulac?a?o teste I\n\nOs horizontes de predic?a?o p1 e p2 para y1 (t) e y2 (t) sa?o\n50 e 40, respectivamente. O horizonte de controle m1 e m2\ne? de 10. O vetor EL e? implementado usando a estrutura\na) da Figura 1, com um horizonte de erro pL = 5.\n\nAs ponderac?o?es dos pesos no controle e no seguimento\nda refere?ncia, utilizando o DMC de forma recursiva e\naplicando o filtro no erro de predic?a?o sa?o: ?1 = 2, ?2 = 10\ne ?1 = 0, 01, ?2 = 0, 1 e um valor de ?1 e ?2 de 0, 75 para\no filtro no erro de predic?a?o da equac?a?o (11).\n\nTempo)[min.]\n0 200 400 600 800 1000 1200 1400 1600\n\nS\na\n\nid\na\n\ns\n\n0.2\n\n0.4\n\n0.6\n\n0.8\nVariaveis)controladas\n\ny\n1\n\n(E\nL\n)\n\ny\n2\n\n(E\nL\n)\n\ny\n1\n\n(F)\n\ny\n2\n\n(F)\n\nRef\n1\n\nRef\n2\n\nTempo)[)min.])\n0 200 400 600 800 1000 1200 1400 1600\n\nC\no\n\nn\ntr\n\no\nle\n\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\nVariaveis)manipuladas\n\nU\n1\n\n(E\nL\n)\n\nU\n2\n\n(E\nL\n)\n\nU\n1\n\n(F)\n\nU\n2\n\n(F)U\n2\n(F)\n\nU\n1\n(E\n\nL\n)U\n\n1\n(F)\n\ny\n1\n(E\n\nL\n)\n\nU\n2\n(E\n\nL\n)\n\ny\n2\n(F)y\n\n2\n(E\n\nL\n)\n\ny\n1\n(F)\n\nFig. 5. Resultado da simulac?a?o teste I\n\nFT11 FT12 FT21 FT22\n0\n\n2\n\n4\n\n6\n\n8\nAtrasos\n\nAtr. usados predi\u00e7\u00e3o\nAtrasos reais simulados\n\nFT11 FT12 FT21 FT22\n0\n\n2\n\n4\n\n6\n\n8\n\n10\nGanhos\n\nGanhos usados predi\u00e7\u00e3o\nGanhos reais simulados\n\nFig. 6. Erros usados na simulac?a?o teste II\n\nA abordagem do passo de estabilidade garante a esta-\nbilidade no sistema. As ponderac?o?es dos pesos no controle\ne no seguimento da refere?ncia no DMC de forma recursiva\n\n143\n\n\n\nTempo)[min.]\n0 200 400 600 800 1000 1200 1400 1600\n\nS\na\n\nid\na\n\ns\n\n0.2\n\n0.4\n\n0.6\n\n0.8\nVariaveis)controladas\n\ny\n1\n\nbE\nL\n\u00e7\n\ny\n2\n\nbE\nL\n\u00e7\n\ny\n1\n\nbF\u00e7\n\ny\n2\n\nbF\u00e7\n\nRef\n1\n\nRef\n2\n\nTempo)[)min.])\n0 200 400 600 800 1000 1200 1400 1600\n\nC\no\n\nn\ntr\n\no\nle\n\n0\n\n0.05\n\n0.1\n\n0.15\n\n0.2\nVariaveis)manipuladas\n\nU\n1\n\nbE\nL\n\u00e7\n\nU\n2\n\nbE\nL\n\u00e7\n\nU\n1\n\nbF\u00e7\n\nU\n2\n\nbF\u00e7\n\ny\n1\nbE\n\nL\n\u00e7y 1 bF\u00e7\n\ny\n2\nbE\n\nL\n\u00e7\n\nU\n2\nbE\n\nL\n\u00e7\n\nU\n2\nbF\u00e7\n\nU\n1\nbE\n\nL\n\u00e7\n\nperturba\u00e7\u00e3o\nde)entrada\n\nperturba\u00e7\u00e3o)\nde)sa\u00edda\n\ny\n2\nbF\u00e7\n\nU\n1\nbF\u00e7\n\nFig. 7. Resultado da simulac?a?o teste II\n\nTempo [min.]\n0 50 100 150 200 250 300 350 400\n\nE\nr\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\n0.8\nErros\n\nE\nL\ny\n\n1\n(1)+E y\n\n1\n\nE(Filtro)y\n1\n\nFig. 8. Comparac?a?o dos erros\n\naplicando o passo de estabilidade, sa?o: ?1 = 0, 01, ?2 = 2\ne ?1 = 0, 01, ?2 = 0, 1.\n\nNa Figura 7 se mostra a resposta do sistema frente\naos erros apresentados na Figura 6. Na Figura 7, uma\nperturbac?a?o na?o modelada e? introduzida no minuto 450,\nmantendo-se ate? o minuto 1050. Como pode se observar,\na te?cnica de passo de estabilidade mostra um melhor\nseguimento da refere?ncia, comparada com a utilizac?a?o\nde filtragem no erro de predic?a?o, quando existem erros\nde modelo tanto para o ganho como para o atraso de\ntransporte. Por outro lado, a resposta na rejeic?a?o da per-\nturbac?a?o e? mais ra?pida aplicando o passo de estabilidade,\nja? que o uso de muito filtragem no sistema pode causar\nlentida?o na rejeic?a?o da perturbac?a?o.\n\nA Figura 8, mostra a comparac?a?o dos erros entre as\nduas te?cnicas apresentadas, que e? o erro filtrado para a\nvaria?vel controlada y1 (t) e o primeiro componente obtido\nadicionando o erro verdadeiro de y1 (t) com o primeiro\ncomponente do erro de Lyapunov EL (1). O comporta-\nmento do erro de Lyapunov para a varia?vel controlada\n\nTABELA I. Erro quadra?tico me?dio\nEstrate?gia EQM1 EQM2\n\nDMCF 1, 02X10\n3 284,90\n\nDMCEL 590,66 140,31\n\ny1 (t), e? muito mais agressivo do que o erro filtrado, de\nmodo que compensa o erro de tempo morto no momento\nda mudanc?a da refere?ncia. Como esperado, os erros no\nsistema em estado estaciona?rio coincidem.\n\nIV. Concluso?es\n\nCom este trabalho tem-se outra opc?a?o para lidar com\nerros de modelagem em plantas esta?veis de malha aberta,\nque e? baseado no segundo me?todo de Lyapunov para a\nestabilidade.\n\nO passo de estabilidade modifica o erro de predic?a?o\nfuturo de forma otimizada, com o objetivo de propor-\ncionar estabilidade no sistema. Com o intuito de prover\nestabilidade o algoritmo encontra a correc?a?o necessa?ria a?\npredic?a?o.\n\nO tempo que leva para a te?cnica passo de estabilidade\naplicado no reator de tanque agitado para trazer y1 (t)\na? refere?ncia, e? cerca da metade do tempo que e? gasto\ncom a te?cnica de filtragem, como se mostra na Figura 7,\npelo que esta te?cnica mostrou um desempenho superior\nem comparac?a?o com o me?todo de filtragem no erro de\npredic?a?o, tanto no seguimento da refere?ncia como na\nrejeic?a?o das perturbac?o?es na?o modeladas, o que da para\nperceber na tabela I, onde se detalha o ca?lculos dos erros\nquadra?ticos me?dios para cada estrate?gia.\n\nEste e? um resultado interessante, pois em muitas plantas\nprincipalmente nas a?reas de petro?leo e ga?s, a maioria das\nvaria?veis afetadas por perturbac?o?es na?o modeladas tem\num impacto econo?mico importante e afetam diretamente\nno desempenho do processo. Quanto mais tempo se en-\ncontram fora das faixas aceita?veis de operac?a?o, maior e? a\nperda econo?mica.\n\nAgradecimentos\n\nOs autores deste trabalho agradecem pelo apoio fi-\nnanceiro recebido do programa de formac?a?o de recursos\nhumanos PHR-34 da Age?ncia Nacional do Petro?leo, Ga?s e\nBiocombust??veis.\n\nRefere?ncias\n\n[1] Camacho, E. and Bordons, C. (2007). Model Predictive Control,\nsegunda edn. Springer.\n\n[2] Bordons, C. Control Predictivo: metodolog??a, tecnolog??a y nuevas\nperspectivas, 2000.\n\n[3] Plucenio, A. et al. Controle preditivo na?o linear na indu?stria do\npetro?leo e ga?s. PDPETRO, Outubro 2007.\n\n[4] Richalet, J. and Rault, A. and Testud, J. (1978), Model Predictive\nHeuristic Control: Aplication to industrial process. AUTOMA-\nTICA.\n\n[5] Cutler, C. and Remarker, B. (1980), Dynamic Matrix Control-A\nComputer Control Algorithm. In Automatic Control, Conference,\nSan Francisco.\n\n[6] Qina, S. and Badgwell, T. (2003). A survey of industrial model\npredictive control technology, Control Engineering Practice.\n\n144\n\n\n\n[7] Garc??a, C. and Prett, D. (1989). Model predictive control: Theory\nand practice-a survey, International Federation of Automation\nControl.\n\n[8] Normey, J. (2001). GPC adaptativo basado en el predictor de\nSmith para procesos con retardo variable, Congresso Brasileiro\nde Automa?tica.\n\n[9] Smith, O. (1957). Closer Control of Loops with Dead-Time,\nChem. Eng. Progress.\n\n[10] Lima, D. and Normey, J. and Plucenio, A. et al. (2014). Im-\nproving Robustness and Disturbance Rejection Performance with\nIndustrial MPC, Congresso Brasileiro de Automa?tica.\n\n[11] Normey, J. and Camacho, E. (2007). Control of Dead time\nProcesses. Springer.\n\n[12] Plucenio, A. (2010). Desenvolvimento de te?cnicas de controle\nna?o linear para elevac?a?o de fluidos multifa?sicos, Dissertac?a?o de\nDoutorado-Engenharia de Automac?a?o e Sistemas, Centro Tec-\nnolo?gico, Universidade Federal de Santa Catarina, Floriano?polis.\n\n[13] Plucenio, A. and Campos, M. et al. (2014). Model Predictive\nControl Algorithm with Stability Step, Congresso Brasileiro de\nAutoma?tica.\n\n[14] Monteiro, L. (2006). Systemas Dina?micos. Livraria da F??sica.\n\n145"}]}}}