{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.08410"}, {"@name": "filename", "#text": "13246_BragaNeto_UlissesdeMendonca_M.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "Universidade Estadual de Campinas\nFaculdade de Engenharia El\u00e9trica\nDepartamento de Engenharia da Computa\u00e7\u00e3o e Automa\u00e7\u00e3o Industrial\nReconstru\u00e7\u00e3o Volum\u00e9trica e An\u00e1lise de Imagens\nTridimensionais por Morfologia Matem\u00e1tica\npor Ulisses de Mendon\u00e7a^Braga Neto r\norientador Prof. Dr. Roberto de Alencar \u00a1Lotufo\nDisserta\u00e7\u00e3o submetida \u00e0 Faculdade de Engenharia El\u00e9trica da U-niversidade Estadual de Campinas, para preenchimento dos pr\u00e9-requisitos parciais para obten\u00e7\u00e3o do T\u00edtulo de Mestre em Engenharia El\u00e9trica.\nDezembro 1994\nEste ox\u00earnp\u00edSr g\u00ed\ts \u25a0\trn/P ds\ndefendida por\t(X ft-ViMW-A\n\u201ca\t1\"\" ..........\nResumo\nEste trabalho apresenta um conjunto de m\u00e9todos e ferramentas que visam \u00e0 reconstru\u00e7\u00e3o volum\u00e9trica e an\u00e1lise tridimensional de um objeto do mundo real.\nUm m\u00e9todo original para o registro de se\u00e7\u00f5es seriadas (etapa da reconstru\u00e7\u00e3o volum\u00e9trica) \u00e9 proposto. S\u00e3o apresentadas tamb\u00e9m ferramentas de an\u00e1lise de imagens tridimensionais baseadas na Morfologia Matem\u00e1tica. Duas destas ferramentas, as granu-lometrias geod\u00e9sicas e o histograma de gargantas, s\u00e3o t\u00e9cnicas originais desenvolvidas ao longo deste trabalho, n\u00e3o tendo sido encontradas na literatura consultada. Durante todo o processo de desenvolvimento, foi adotado como plataforma o sistema de visualiza\u00e7\u00e3o e processamento de imagens Khoros.\n0 objeto tridimensional estudado consiste em uma amostra experimental a-trav\u00e9s da qual pretendeu-se modelar um sistema f\u00edsico poroso. 0 estudo de tais sistemas \u00e9 de grande relev\u00e2ncia em \u00e1reas economicamente importantes como petrof\u00edsica, engenharia de petr\u00f3leo, engenharia de reservat\u00f3rios, an\u00e1lise de solos e cristalograf\u00eda. Este trabalho apresenta par\u00e2metros de an\u00e1lise do meio poroso obtidos diretamente da amostra experimental tridimensional, sem nenhuma corre\u00e7\u00e3o estereom\u00e9trica envolvida.\nAbstract\nThis work presents a set of methods and tools for the volumetric reconstruction and three-dimensional analysis of a real world object.\nAn original method for the registration of serial sections (a step in volumetric reconstruction) is proposed. Also, tools based on Mathematical Morphology are presented for the analysis of three-dimensional images. Two of these tools, the geodesic granulometries and the neck histogram, have not been found in the consulted literature, being original techniques developed in the course of this work. During all the development process, it was adopted as platform the Khoros visualization and image processing system.\nThe three-dimensional object studied was an experimental sample designed for modelling a porous physical system. The study of such systems is of great value in economically important areas like petrophysics, oil engineering, reservatory engineering, soil analysis and crystalography. This work presents analysis parameters for the porous medium obtained directly from the three-dimensional experimental sample, with no estereometric correction involved.\nAgradecimentos\nAo J\u00fanior Barrera, do IME-USP, pela ajuda inestim\u00e1vel que me deu na forma de coment\u00e1rios, sugest\u00f5es e refer\u00eancias biliogr\u00e1ficas sobre a Morfologia Matem\u00e1tica.\nAo Gerald Banon, do INPE, por todo o apoio recebido e pelo \u00f3timo curso de Morfologia Matem\u00e1tica que tive oportunidade de assitir no Recife.\nAo Cl\u00e9sio Tozzi, da FEE-UNICAMP, pela cuidadosa revis\u00e3o do texto e pelos coment\u00e1rios feitos.\nAo Renato Luppi e ao Alexandre Xavier, pela amizade e por todas as dicas e coment\u00e1rios sobre o Khoros e a V3DTOOLS.\nAo Marcelo Monteiro, do Instituto de Geoci\u00eancias da UNICAMP, por ter fornecido a amostra experimental e ter colaborado no processo de aquisi\u00e7\u00e3o da mesma.\nAo Centro de Computa\u00e7\u00e3o da UNICAMP ~ CCUEC, na pessoa do analista de sistemas Rubens Queiroz, pelo suporte computacional recebido.\nA Ting e ao Jaime, pela ajuda que deram na chegada a Campinas.\nAos muitos amigos que fiz no LCA, que comigo conviveram cotidianamente e fizeram esta caminhada parecer muito mais curta e amena: Lu\u00eds Gonzaga, Daniel Moralez, Leila, Jorge, Gonzalo, Marco Ant\u00f4nio, Maur\u00edcio, Okamura, Ely, Alexandre Magalh\u00e3es, Ilka, Pinda, Elton, Olga, Berutti, Nelson, Ricardo, Luciana, M\u00e1rcio Leandro, Tetsu, Daniel Kligerman, Marcelo, Alencar, Andrea, Reginaldo.\nA minha Tia Consu\u00ealo, pela companhia, incentivo e \u201cajuda dom\u00e9stica\u201d recebida.\nAos meus pais, Jacinto e Consu\u00ealo\n\u201c \u2018I always thought they were fabulous monsters!\u2019 said the Unicorn. \u2018Is it alive?\u2019\n\u2018It can talk,\u2019 said Haigha solemnly.\nThe Unicorn looked dreamily at Alice, and said: \u2018Talk, child?\nAlice could not help her lips curling up into a smile as she began: \u2018Do you know, I always thought Unicorns were fabulous monsters too? I never saw one alive before!\u2019\n\u2018Well, now that we have seen each other,\u2019 said the Unicorn, \u2018if you\u2019ll believe in me, I\u2019ll believe in you. Is that a bargain?\u2019 \u201d\nTrecho extra\u00eddo do incr\u00edvel livro \u201cinfantil\u201d \u201cThrough the looking-Glass and What Alice Found There\u201d, de Dewis Carrol\nConte\u00fado\nRESUMO\ti\nABSTRACT\tn\nAGRADECIMENTOS\tiii\nCONTE\u00daDO\tv\nLISTA DE FIGURAS\tviii\nLISTA DE TABELAS\txii\n1\tIntrodu\u00e7\u00e3o\t1\n1.1\tObjetivos ..........................................     2\n1.2\tMateriais e M\u00e9todos....................................  3\n1.3\tOrganiza\u00e7\u00e3o do trabalho................................. 3\n2\tRegistro de Se\u00e7\u00f5es Seriadas\t5\n2.1\tIntrodu\u00e7\u00e3o ...........................................   5\n2.2\tO problema do registro................................   6\n2.3\t0 m\u00e9todo de registro proposto.........................   7\n2.3.1\tObten\u00e7\u00e3o da transforma\u00e7\u00e3o de escala .............. 8\n2.3.2\tObten\u00e7\u00e3o das transforma\u00e7\u00f5es de rota\u00e7\u00e3o e transla\u00e7\u00e3o . ........... 11\n2.3.3\tObten\u00e7\u00e3o dos par\u00e2metros de registro ............................. 23\n2.4\tDois exemplos com imagens sint\u00e9ticas..................................   24\n2.4.1\tPrimeiro exemplo................................................. 24\n2.4.2\tSegundo exemplo ...........................................       26\n3\tMorfologia Matem\u00e1tica em Tr\u00eas Dimens\u00f5es\t29\n3.1\tIntrodu\u00e7\u00e3o............................................................   29\n3.2\tConceitos preliminares...............................................    30\n3.2.1\tEsquema de Representa\u00e7\u00e3o e Grid Digital . ....................... 31\n3.2.2\tVizinhan\u00e7a e Conectividade...................................     32\n3.2.3\tDist\u00e2ncia e Discos Digitais ...................................   35\n3.3\tAs transforma\u00e7\u00f5es b\u00e1sicas da Morfologia Matem\u00e1tica ..................... 37\n3.3.1\tEros\u00e3o e Dilata\u00e7\u00e3o .............................................. 38\n3.3.2\tGradiente Morfol\u00f3gico............................................ 42\n3.3.3\tAberturas e Fechamentos  ........................................ 43\n3.3.4\tEros\u00f5es e Dilata\u00e7\u00f5es Geod\u00e9sicos e Reconstru\u00e7\u00e3o...............  .\t45\n4\tFerramentas da Morfologia Matem\u00e1tica para An\u00e1lise de Imagens\t48\n4.1\tIntrodu\u00e7\u00e3o.........................  ................................... 48\n4.2\tWatersheds...........................................................    49\n4.2.1\tWatersheds e a Segmenta\u00e7\u00e3o de imagens n\u00edvel-de-cinza............. 52\n4.2.2\tSepara\u00e7\u00e3o de objetos superpostos via Watersheds.................. 55\n4.3\tGranulometria ....................................................       60\n4.3.1\tAs Distribui\u00e7\u00f5es Granulom\u00e9tricas de Tamanho.....................  63\n4.3.2\tO Espectro de Padr\u00f5es........................................     67\n4.3.3\tGranulometrias Geod\u00e9sicas......................................   69\n4.4\tHistograma de Gargantas..........................................     77\n4.5\tAspectos de implementa\u00e7\u00e3o .........................................   82\n5\tResultados Experimentais: Caracteriza\u00e7\u00e3o de Meio Poroso\t87\n5.1\tIntrodu\u00e7\u00e3o ........................................................   87\n5.2\tAmbiente\te Ferramentas Computacionais Utilizados ................... 88\n5.2.1\t0\tSistema Khoros...........................................   89\n5.2.2\tA\ttoolbox V3DT00LS .........................................  91\n5.2.3\tA\ttoolbox MMACH...........................................    92\n5.3\tReconstru\u00e7\u00e3o Volum\u00e9trica a partir de Se\u00e7\u00f5es Seriadas ................ 98\n5.3.1\tAquisi\u00e7\u00e3o das se\u00e7\u00f5es seriadas ..............................   98\n5.3.2\tRegistro das se\u00e7\u00f5es seriadas..............................     99\n5.3.3\tInterpola\u00e7\u00e3o Volum\u00e9trica...................................   103\n5.4\tAtributos de an\u00e1lise para caracteriza\u00e7\u00e3o de meio poroso.........  .\t109\n5.4.1\tMedidas de car\u00e1ter geral...................................   112\n5.4.2\tAn\u00e1lise\tGranulom\u00e9trica ....................................   114\n5.4.3\tAn\u00e1lise\tdas Gargantas......................................   119\n6\tConclus\u00e3o\t122\nBIBLIOGRAFIA\n124\nLista de Figuras\n2.1\tSe\u00e7\u00f5es mestre e corrente e respectivos pontos rotulados.....................  7\n2.2\tContornos preenchidos de duas se\u00e7\u00f5es consecutivas de um objeto tridimensional 10\n2.3\tEspecifica\u00e7\u00e3o de geometria invariante a rota\u00e7\u00e3o e transla\u00e7\u00e3o ..............\t12\n2.4\tEspecifica\u00e7\u00e3o de\tgeometria invariante apenas a transla\u00e7\u00e3o................... 13\n2.5\tRota\u00e7\u00e3o sobre\te v'2 produzindo v\" e v2 .................................   19\n2.6\tSe\u00e7\u00f5es sint\u00e9ticas\tutilizadas no primeiro exemplo..........................   24\n2.7\tSe\u00e7\u00f5es sint\u00e9ticas\tutilizadas no segundo exemplo............................. 26\n3.1\tRegi\u00e3o de interesse e subdivis\u00e3o do espa\u00e7o voxel ........................... 32\n3.2\tExemplo de espa\u00e7o voxel: empilhamento das fatias de um joelho ......\t33\n3.3\tVizinhan\u00e7a 2D: (a) 4-vizinhos ao pixel central e (b) 8-vizinhos ao pixel central 33\n3.4\tVizinhan\u00e7a 3D: (a) 6-vizinhos (b) 18-vizinhos e (c) 26-vizinhos ao voxel central 34\n3.5\tDiscos 2D de raio r = 5 correspondentes \u00e0s dist\u00e2ncias (a) quarteir\u00e3o (b)\neuclidiana e (c) m\u00e1ximo...................................................   36\n3.6\tDiscos 3D de raio r = 10 correspondentes \u00e0s dist\u00e2ncias (a) quarteir\u00e3o (b)\neuclidiana e (c) m\u00e1ximo ................................................     36\n3.7\tModelo tridimensional da fase s\u00f3lida de uma rocha .  ....................... 39\n3.8\tEros\u00e3o por discos digitais 3D de raio r = 5 segundo diversas m\u00e9tricas, (a)\ndisco do quarteir\u00e3o (b) disco euclidiano (c) disco do m\u00e1ximo ........... .\t40\n3.9\tDilata\u00e7\u00e3o por discos digitais 3D de raio r = 5 segundo diversas m\u00e9tricas, (a)\ndisco do quarteir\u00e3o (b) disco euclidiano (c) disco do m\u00e1ximo................ 41\n3.10\tAbertura por discos digitais 3D de raio r = 5 segundo diversas m\u00e9tricas, (a)\ndisco do quarteir\u00e3o (b) disco euclidiano (c) disco do m\u00e1ximo .............. 44\n3.11\tFechamento por discos digitais 3D de raio r ~ 5 segundo diversas m\u00e9tricas.\n(a)\tdisco do quarteir\u00e3o (b) disco euclidiano (c) disco do m\u00e1ximo ......... 45\n3.12\tExemplo de reconstru\u00e7\u00e3o: (a) Imagem original (b) Marcadores (c) Resultado 47\n4.1\tImagem sint\u00e9tica vista segundo (a) representa\u00e7\u00e3o usual e (b) modelo topogr\u00e1fico 50\n4.2\tLDA superposta \u00e0 imagem original: (a) representa\u00e7\u00e3o usual e (b) modelo\ntopogr\u00e1fico . ...........................................................   51\n4.3\tExemplo de super-segmenta\u00e7\u00e3o: (a) Imagem original (b) Gradiente (c) LDA\nresultante...............................................................   53\n4.4\tMarcadores utilizados na segmenta\u00e7\u00e3o da imagem do p\u00e9......................  54\n4.5\tResultado da segmenta\u00e7\u00e3o por watersheds da imagem do p\u00e9.................... 55\n4.6\tImagem bin\u00e1ria a ser segmentada.........................................    56\n4.7\tFun\u00e7\u00e3o dist\u00e2ncia associada ao objeto da fig. anterior segundo a m\u00e9trica euclidiana ..............................................................     57\n4.8\tModelo topogr\u00e1fico associado ao complemento da fun\u00e7\u00e3o dist\u00e2ncia euclidiana 57\n4.9\tSuper-segmenta\u00e7\u00e3o obtida com a determina\u00e7\u00e3o direta dos watersheds utilizando a fun\u00e7\u00e3o dist\u00e2ncia euclidiana........................................ 58\n4.10\tPerfil unidimensional da fun\u00e7\u00e3o dist\u00e2ncia mostrando os m\u00e1ximos esp\u00farios\nque s\u00e3o removidos pela abertura por reconstru\u00e7\u00e3o e os m\u00e1ximos filtrados que resultam.................................................................   59\n4.11\tMarcadores obtidos atrav\u00e9s de (a) Bissetor condicional de ordem 10 (b)\n\u00daltima eros\u00e3o (c) M\u00e1ximos filtrados (d) Sele\u00e7\u00e3o manual....................  61\n4.12\tSegmenta\u00e7\u00e3o via watersheds utilizando os marcadores da figura anterior: (a) Bissetor condicional de ordem 10 (b) \u00daltima eros\u00e3o (c) M\u00e1ximos fitrados (d)\nSele\u00e7\u00e3o manual...........................................................   62\n4.13\tImagem sint\u00e9tica a ser submetida a an\u00e1lise granulom\u00e9trica............  .\t66\n4.14\tCurvas granulom\u00e9tricas associadas \u00e0 imagem da figura anterior: (a) \u00ed(r) e\n(b)\tT(r)............................................... . ................ 66\n4.15\tEspectros de padr\u00f5es associados a alguns objetos bidimensionais .......... 68\n4.16\tImagem a ser submetida \u00e0 an\u00e1lise granulom\u00e9trica .......................  69\n4.17\tEspectro de padr\u00f5es morfol\u00f3gico associado \u00e0 imagem da fig. 4.16 ......\t70\n4.18\tResultados da abertura morfol\u00f3gica com disco euclidiano para diversos valo-\nres de T sobre a imagem da fig. 4.16 .................................... 71\n4.19\tEspectro de padr\u00f5es geod\u00e9sico associado \u00e0 imagem da fig. 4.16 .......\t73\n4.20\tResultados da abertura geod\u00e9sica 7Br,Brec com disco euclidiano para diversos\nvalores de r sobre a imagem da fig. 4.16 ...............................  74\n4.21\tSegmenta\u00e7\u00e3o dos gr\u00e3os superpostos da fig. 4.16.......................... 75\n4.22\tResultados da abertura geod\u00e9sica 7Br)Brec com disco euclidiano para diversos\nvalores de r sobre a imagem da fig. 4.21................................  76\n4.23\tEspectro de padr\u00f5es geod\u00e9sico da imagem segmentada da fig. 4.21 ........ 77\n4.24\tGarganta entre dois componentes conectados e maior disco digital inscrito .\t78\n4.25\tExemplo de restri\u00e7\u00e3o que n\u00e3o \u00e9 considerada uma garganta................  78\n4.26\tComponentes prestes a se desconectar ap\u00f3s eros\u00e3o pelo maior disco digital\ninscrito na garganta................................................      78\n4.27\tImagem bin\u00e1ria de placa de circuito impresso.....................    .\t83\n4.28\tHistogramas de gargantas associados \u00e0 imagem do PCB (a) parte condutora\n(b) parte isolante.....................................................   83\n4.29\tRepresenta\u00e7\u00e3o esquem\u00e1tica de uma fila de espera .......................  84\n5.1\tCantata e um workspace t\u00edpico ........................................... 90\n5.2\tWorkspace para gerar as visualiza\u00e7\u00f5es tridimensionais do cap\u00edtulo 3\t....\t97\n5.3\tAlgumas se\u00e7\u00f5es da amostra experimental utilizada neste trabalho ......\t100\n5.4\tVaria\u00e7\u00e3o de magnitude nos dados originais .............................  101\n5.5\tVaria\u00e7\u00e3o de magnitude ap\u00f3s a aplica\u00e7\u00e3o da transforma\u00e7\u00e3o de escala ....\t101\n5.6\tAs se\u00e7\u00f5es da fig. 5.3 ap\u00f3s aplicada a transforma\u00e7\u00e3o de registro segundo o\nm\u00e9todo proposto .......................................................  104\n5.7\tProcesso de segmenta\u00e7\u00e3o das fases s\u00f3lida e porosa, (a) Se\u00e7\u00e3o n\u00edvel-de-cinza original (b) Resultado indesej\u00e1vel obtido por limiariza\u00e7\u00e3o simples (c) Imagem limitante (d) Resultado da limiariza\u00e7\u00e3o adaptativa (e) Filtragem da imagem\ndo item d (fase s\u00f3lida) (f) Subtra\u00e7\u00e3o das imagens do itens cee (fase porosa) 107\n5.8\tVisualiza\u00e7\u00e3o da fase s\u00f3lida (a) antes da interpola\u00e7\u00e3o (b) ap\u00f3s a interpola\u00e7\u00e3o 110\n5.9\tVisualiza\u00e7\u00e3o da fase porosa (a) antes da interpola\u00e7\u00e3o (b) ap\u00f3s a interpola\u00e7\u00e3o 110\n5.10\tEspectros de padr\u00f5es morfol\u00f3gicos associados \u00e0 fase s\u00f3lida utilizando disco\ndigital segundo m\u00e9trica (a) do quarteir\u00e3o (b) euclidiana (c) do m\u00e1ximo . . .\t115\n5.11\tRotula\u00e7\u00e3o com vizinhan\u00e7a 6 da fase s\u00f3lida (a) antes e (b) ap\u00f3s a segmenta\u00e7\u00e3o\nbin\u00e1ria com o m\u00e9todo dos marcadores filtrados............................ 116\n5.12\tEspectros de padr\u00f5es geod\u00e9sicos associados \u00e0 fase s\u00f3lida utilizando disco digital segundo m\u00e9trica (a) do quarteir\u00e3o (b) euclidiana (c) do m\u00e1ximo ....\t117\n5.13\tEspectros de padr\u00f5es morfol\u00f3gicos associados \u00e0 fase porosa utilizando disco\ndigital segundo m\u00e9trica (a) do quarteir\u00e3o (b) euclidiana (c) do m\u00e1ximo . . .\t118\n5.14\tHistogramas de gargantas associados \u00e0 fase s\u00f3lida utilizando como elemento\nestruturante primitivo disco unit\u00e1rio (a) do quarteir\u00e3o (b) do m\u00e1ximo . . .\t121\n5.15\tHistogramas de gargantas associados \u00e0 fase porosa utilizando como elemento\nestruturante primitivo disco unit\u00e1rio (a) do quarteir\u00e3o (b) do m\u00e1ximo . . .\t121\nLista de Tabelas\n2.1\tResultados do primeiro exemplo para o m\u00e9todo proposto......................  25\n2.2\tResultados\tdo\tprimeiro exemplo para o m\u00e9todo de Merickel................... 26\n2.3\tResultados\tdo\tsegundo exemplo para o m\u00e9todo proposto....................  27\n2.4\tResultados do segundo exemplo para o m\u00e9todo de Merickel .........\t27\n5.1\tResultados\tdo\tregistro das se\u00e7\u00f5es do modelo 3D ~~ m\u00e9todo\tproposto......... 102\n5.2\tResultados\tdo\tregistro das se\u00e7\u00f5es do modelo 3D - m\u00e9todo\tde Merickel . . .\t103\n5.3\tRaios m\u00e9dios segundo os diversos discos digitais utilizados (valores em mm\nentre par\u00eanteses) ..................................................    .\t119\n5.4\tTamanhos m\u00e9dios segundo os dois elementos estruturantes utilizados (valores\nem mm entre par\u00eanteses) ...............................................     120\nCap\u00edtulo 1\nIntrodu\u00e7\u00e3o\nCom a disponibilidade de recursos computacionais cada vez mais poderosos que vem sendo constatada nos \u00faltimos anos, as t\u00e9cnicas de processamento e an\u00e1lise de imagens tridimensionais t\u00eam ganhado um grande impulso. Ao contr\u00e1rio das t\u00e9cnicas tradicionais, que procuram obter os par\u00e2metros de interesse a partir de se\u00e7\u00f5es bidimensionais do objeto em estudo, os m\u00e9todos tridimensionais lidam diretamente com a estrutura 3D real do objeto. Atrav\u00e9s desta tecnologia \u00e9 poss\u00edvel simplificar e otimizar o trabalho humano no que diz respeito \u00e0 quantifica\u00e7\u00e3o e avalia\u00e7\u00e3o de imagens, produzindo-se resultados precisos, confi\u00e1veis e eficientes.\nDentro deste contexto, a an\u00e1lise de imagens tridimensionais tem se tornado uma tecnologia das mais importantes nos dias de hoje, devido ao largo campo de aplica\u00e7\u00f5es em que vem sendo utilizada, abrangendo as mais diversas \u00e1reas: medicina, biologia, geologia, engenharia, metereologia, astronomia, rob\u00f3tica, f\u00edsica, qu\u00edmica e muitas outras.\nUma t\u00e9cnica n\u00e3o-linear, com s\u00f3lida fundamenta\u00e7\u00e3o te\u00f3rica, que vem alcan\u00e7ando um grande \u00eaxito em aplica\u00e7\u00f5es de processamento e an\u00e1lise de imagens \u00e9 a Morfologia Matem\u00e1tica , que teve suas bases lan\u00e7adas em 1964 por Georges Matheron e Jean Serra na Ecole Nationale Sup\u00e9rieure des Mines de Paris.\nA Morfologia Matem\u00e1tica se baseia em transforma\u00e7\u00f5es de forma, que preservam a rela\u00e7\u00e3o de inclus\u00e3o, ao contr\u00e1rio das t\u00e9cnicas tradicionais lineares que preservam a rela\u00e7\u00e3o de adi\u00e7\u00e3o. A despeito de sua import\u00e2ncia, as t\u00e9cnicas lineares n\u00e3o s\u00e3o suficientes para lidar com imagens do mundo tridimensional real, pois neste os objetos n\u00e3o se somam, mas se\nEntretanto, antes de se passar ao processamento e an\u00e1lise tridimensionais propriamente ditos, \u00e9 preciso considerar o importante problema da reconstru\u00e7\u00e3o volum\u00e9trica do objeto que se deseja estudar. A reconstru\u00e7\u00e3o volum\u00e9trica, tamb\u00e9m chamada de reconstru\u00e7\u00e3o tridimensional, consiste na forma\u00e7\u00e3o de um conjunto de dados que represente a estrutura tridimensional do objeto em estudo a partir de informa\u00e7\u00f5es bidimensionais do mesmo.\nUm caso bastante comum \u00e9 o da reconstru\u00e7\u00e3o tridimensional a partir de se\u00e7\u00f5es seriadas, que \u00e9 o processo pelo qual se obt\u00e9m um modelo tridimensional a partir de imagens 2D consecutivas que representam se\u00e7\u00f5es paralelas de um objeto do mundo real. Em muitos casos pr\u00e1ticos, \u00e9 necess\u00e1rio resolver o problema de registro entre as se\u00e7\u00f5es seriadas do objeto em estudo, o que usualmente consiste na determina\u00e7\u00e3o das transforma\u00e7\u00f5es de transla\u00e7\u00e3o, rota\u00e7\u00e3o e escala necess\u00e1rias ao casamento ou alinhamentro entre as se\u00e7\u00f5es.\n1.1\tObjetivos\nNeste trabalho, nos propomos a desenvolver um conjunto de m\u00e9todos e ferramentas que permitam a reconstru\u00e7\u00e3o volum\u00e9trica e posterior an\u00e1lise tridimensional de um objeto do mundo real. Propomos um m\u00e9todo original para o registro das se\u00e7\u00f5es seriadas do objeto, que apresentou um desempenho superior a um m\u00e9todo anterior, encontrado na literatura. Desenvolvemos tamb\u00e9m ferramentas de an\u00e1lise de imagens tridimensionais baseadas na Morfologia Matem\u00e1tica, sendo que duas delas, as granulometrias geod\u00e9sicas e o histograma de gargantas, foram desenvolvidas ao longo deste trabalho, n\u00e3o tendo sido encontradas na literatura pesquisada.\n0 objeto tridimensional estudado consiste em uma amostra experimental atrav\u00e9s da qual pretendeu-se modelar um sistema f\u00edsico poroso. 0 estudo de sistemas contendo meios porosos (rochas) \u00e9 de grande relev\u00e2ncia em diversas \u00e1reas economicamente importantes tais como a petrof\u00edsica, engenharia de petr\u00f3leo, engenharia de reservat\u00f3rios, an\u00e1lise de solos e cristalografia. A caracteriza\u00e7\u00e3o de meios porosos serve bem para demonstrar a aplica\u00e7\u00e3o das ferramentas 3D desenvolvidas, pois \u00e9 usualmente feita a partir da an\u00e1lise de\n1.2\tMateriais e M\u00e9todos\nA amostra experimental utilizada neste trabalho consiste em um objeto aproximadamente cil\u00edndrico de gesso contendo peda\u00e7os de giz de variadas formas e tamanhos. Com isto pretendeu-se modelar uma amostra real de rocha onde duas fases complementares normalmente existem: a fase s\u00f3lida, que constitui o material propriamente dito e \u00e9 representada pelos peda\u00e7os de giz, e a fase porosa, que corresponde ao espa\u00e7o que pode ser invadido por fluidos modificando as propriedades f\u00edsicas do meio, e que \u00e9 representada pelo gesso.\nDurante todo o processo de desenvolvimento, foi adotado como plataforma o sistema de visualiza\u00e7\u00e3o e processamento de imagens Khoros. Este sistema consiste em um pacote computacional aberto, desenvolvido na Universidade do Novo M\u00e9xico e baseado no Unix e no XI1, sistemas por sua vez largamente difundidos. 0 Khoros tem alcan\u00e7ado enorme popularidade em todo o mundo e vem sendo utilizado nas mais diversas \u00e1reas, tais como manipula\u00e7\u00e3o e an\u00e1lise de imagens m\u00e9dicas, sensoreamento remoto, visualiza\u00e7\u00e3o cient\u00edfica, reconhecimento de padr\u00f5es, sistema de informa\u00e7\u00f5es geogr\u00e1ficas, aplica\u00e7\u00f5es de processamento de imagem em geral e at\u00e9 mesmo aplica\u00e7\u00f5es como bancos de dados e sistemas de controle.\n1.3\tOrganiza\u00e7\u00e3o do trabalho\nEste trabalho se encontra organizado da maneira que se segue.\nNo cap\u00edtulo seguinte \u00e9 apresentado o m\u00e9todo original de registro de se\u00e7\u00f5es seriadas que ser\u00e1 utilizado para a reconstru\u00e7\u00e3o tridimensional da amostra experimental em estudo.\nNo cap\u00edtulo 3, apresentamos as transforma\u00e7\u00f5es b\u00e1sicas da Morfologia Matem\u00e1tica tridimensional, e tamb\u00e9m os conceitos preliminares que ser\u00e3o necess\u00e1rios para o desenvolvimento da teoria.\nNo cap\u00edtulo 4, s\u00e3o apresentadas as ferramentas da Morfologia Matem\u00e1tica para a an\u00e1lise de imagens tridimensionais que ser\u00e3o utilizadas mais tarde para o estudo da caracteriza\u00e7\u00e3o de meio poroso. Estas ferramentas se baseiam principalmente nas transforma\u00e7\u00f5es b\u00e1sicas apresentadas no cap\u00edtulo 4.\nNo cap\u00edtulo 5, discutiremos todas as etapas envolvidas na reconstru\u00e7\u00e3o tridimensional da amostra experimental, e em seguida utilizaremos as ferramentas de an\u00e1lise tridimensional baseadas na Morfologia Matem\u00e1tica, desenvolvidas no cap\u00edtulo 4, para a obten\u00e7\u00e3o de medidas que descrevam a estrutura morfol\u00f3gica da amostra em estudo. Antes, fazemos uma descri\u00e7\u00e3o do ambiente computacional utilizado, o Khoros, assim como das duas toolboxes utilizadas, a V3DTOOLS e a MMACH, em cujo desenvolvimento tivemos a oportunidade de participar.\nPor fim, no cap\u00edtulo 6 apresentamos algumas conclus\u00f5es obtidas e tamb\u00e9m sugest\u00f5es para continua\u00e7\u00e3o na linha de pesquisa abordada por este trabalho.\nCap\u00edtulo 2\nRegistro de Se\u00e7\u00f5es Seriadas\n2.1\tIntrodu\u00e7\u00e3o\nEm muitos casos pr\u00e1ticos de reconstru\u00e7\u00e3o volum\u00e9trica, como o que consideraremos no cap\u00edtulo 5, \u00e9 necess\u00e1rio resolver o problema de registro entre as se\u00e7\u00f5es seriadas do objeto em estudo, o que usualmente consiste na determina\u00e7\u00e3o das transforma\u00e7\u00f5es de transla\u00e7\u00e3o, rota\u00e7\u00e3o e escala necess\u00e1rias ao casamento ou alinliamentro entre as se\u00e7\u00f5es.\nNa literatura, encontramos v\u00e1rias abordagens para o problema de registro de se\u00e7\u00f5es seriadas. Cygansky e Orr [15] e Faber e Stokely [19] utilizaram a teoria de momentos tensoriais para encontrar as transforma\u00e7\u00f5es de registro. Esta teoria se aplica por\u00e9m a problemas que envolvem apenas rota\u00e7\u00e3o e escala, isto \u00e9, transforma\u00e7\u00f5es afins. Dudani et al. [18] tentaram resolver o problema utilizando os eixos principais das se\u00e7\u00f5es do objeto. Este m\u00e9todo produz bons resultados quando as se\u00e7\u00f5es s\u00e3o id\u00eanticas a menos, mais uma vez, de uma transforma\u00e7\u00e3o afim.\nAbordagens mais gerais que estas usualmente se baseiam na determina\u00e7\u00e3o das transforma\u00e7\u00f5es de registro a partir de um conjunto de pontos rotulados, utilizando geralmente um crit\u00e9rio de m\u00ednimos quadrados, como por exemplo os trabalhos de Arun et al. [2] e Merickel [30]. Este tipo de abordagem, o qual adotaremos, tem a grande vantagem de ser geral, podendo ser aplicado a qualquer tipo de imagem.\nNeste cap\u00edtulo apresentaremos um m\u00e9todo de registro original [11, 10], baseado\nno criterio de m\u00ednimos quadrados, que possui a vantagem de n\u00e3o utilizar t\u00e9cnicas com-putacionalmente caras, tais como decomposi\u00e7\u00e3o de valor singular [2] ou invers\u00e3o num\u00e9rica de matrizes [30]. Trata-se de urna t\u00e9cnica combinada de minimiza\u00e7\u00e3o associada a uma es-trat\u00e9gia de busca orientada. Os erros num\u00e9ricos introduzidos s\u00e3o desta forma reduzidos. Utilizaremos imagens sint\u00e9ticas para demonstrar a efetividade do m\u00e9todo proposto, estabelecendo inclusive uma compara\u00e7\u00e3o com um outro m\u00e9todo de registro, proposto por Merickel [30]. Deixaremos para o cap\u00edtulo 5 a apresenta\u00e7\u00e3o dos resultados obtidos em um problema de reconstru\u00e7\u00e3o tridimensional real.\nVale ressaltar ainda que utilizamos conjuntos de pontos rotulados bidimensionais, j\u00e1 que nossa principal aplica\u00e7\u00e3o \u00e9 a reconstru\u00e7\u00e3o tridimensional a partir de se\u00e7\u00f5es seriadas, mas a t\u00e9cnica apresentada \u00e9 facilmente estendida para o problema de registro tridimensional, bastando para isto fazer uma modifica\u00e7\u00e3o no processo de busca.\n2.2\tO problema do registro\nO objetivo b\u00e1sico de um m\u00e9todo de registro \u00e9 encontrar o conjunto de transforma\u00e7\u00f5es geom\u00e9tricas necess\u00e1rias para alinhar uma sec\u00e3o corrente com uma se\u00e7\u00e3o mestre, a qual \u00e9 a se\u00e7\u00e3o de refer\u00eancia (fixa). Note-se que esta atribui\u00e7\u00e3o \u00e9 din\u00e2mica, isto \u00e9, a se\u00e7\u00e3o corrente de uma passagem do algoritmo pode se tornar, ap\u00f3s ser alinhada, a se\u00e7\u00e3o mestre da passagem seguinte (alternativamente, pode se fixar uma das se\u00e7\u00f5es, por exemplo a primeira, como a se\u00e7\u00e3o mestre de todo o processo de reconstru\u00e7\u00e3o). O conjunto de transforma\u00e7\u00f5es pode ser aglutinado em uma s\u00f3 transforma\u00e7\u00e3o chamada transforma\u00e7\u00e3o de registro.\nUma vasta classe de t\u00e9cnicas utiliza pontos rotulados para se encontrar os par\u00e2metros da transforma\u00e7\u00e3o de registro. Estes pontos rotulados podem ser obtidos por m\u00e9todos autom\u00e1ticos, utilizando t\u00e9cnicas de reconhecimento de padr\u00f5es, ou de forma manual, onde um operador seleciona visualmente pontos de refer\u00eancia fixos entre as se\u00e7\u00f5es consecutivas, levando assim a uma t\u00e9cnica semi-autom\u00e1tica.\nOs pontos rotulados correspondentes \u00e0 se\u00e7\u00e3o mestre e \u00e0 se\u00e7\u00e3o corrente s\u00e3o cha-mados de pontos mestres e pontos correntes, respectivamente (ver fig. 2.1).\nAs transforma\u00e7\u00f5es geom\u00e9tricas usualmente requeridas s\u00e3o escala, rota\u00e7\u00e3o e trans-\n*\t\u00ab\t9\nPontos Mestres:\tP,, P\u201e, .... P\n1\u2019\t2\u2019\t\u2019 n\nPontos Correntes:\tP., P_,.... P\n1\u2019\t2\t\u2019 n\nFigura 2.1: Se\u00e7\u00f5es mestre e corrente e respectivos pontos rotulados\nla\u00e7\u00e3o. Portanto, o algoritmo deve, em geral, produzir quatro par\u00e2metros como sa\u00edda:\n\u2014\tEscala: s\n\u2014\tRota\u00e7\u00e3o: 8\n\u2014\tTransla\u00e7\u00e3o: tx,ty\nObserve que a ordem em que as transforma\u00e7\u00f5es acima s\u00e3o aplicadas \u00e9 relevante, pois nem a escala nem a rota\u00e7\u00e3o comutam com a transla\u00e7\u00e3o, apesar de comutarem entre si (Em nosso m\u00e9todo, a ordem assumida \u00e9 a indicada acima). Observamos ainda que a mudan\u00e7a de escala \u00e9 considerada uniforme, isto \u00e9, a varia\u00e7\u00e3o de magnifica\u00e7\u00e3o \u00e9 a mesma nas dire\u00e7\u00f5es x e y.\n2.3\tO m\u00e9todo de registro proposto\nNesta se\u00e7\u00e3o descreveremos a t\u00e9cnica desenvolvida para se determinar as transforma\u00e7\u00f5es de escala, rota\u00e7\u00e3o e transla\u00e7\u00e3o necess\u00e1rias ao registro das se\u00e7\u00f5es seriadas a partir dos pontos rotulados.\nAlguns algoritmos encontram diretamente os par\u00e2metros das transforma\u00e7\u00f5es, como \u00e9 o caso do m\u00e9todo apresentado por Merickel em [30]. A t\u00e9cnica que desenvolvemos adota uma abordagem diferente: primeiro s\u00e3o determinados os pontos solu\u00e7\u00e3o que se a-justam da melhor maneira poss\u00edvel (segundo o crit\u00e9rio de m\u00ednimos quadrados) aos pontos\nA transforma\u00e7\u00e3o de escala \u00e9 tratada \u00e0 parte. A depender da aplica\u00e7\u00e3o e do tipo de imagem, duas op\u00e7\u00f5es s\u00e3o poss\u00edveis: o par\u00e2metro de escala pode ser determinado a priori, em uma etapa de pr\u00e9-processamento, ou pode ser calculado a partir dos pontos rotulados (ver se\u00e7\u00e3o 2.3.1.2). Em ambos os casos, a transforma\u00e7\u00e3o de escala \u00e9 aplicada \u00e0s se\u00e7\u00f5es anteriormente \u00e0 obten\u00e7\u00e3o dos par\u00e2metros de rota\u00e7\u00e3o e transla\u00e7\u00e3o.\nConclu\u00edmos ent\u00e3o que o problema a ser atacado pode ser resumido como:\n-\tDeterminar a transforma\u00e7\u00e3o de escala existente entre as se\u00e7\u00f5es mestre e corrente.\n-\tEncontrar, usando o crit\u00e9rio de m\u00ednimos quadrados, os pontos solu\u00e7\u00e3o\na partir dos pontos mestres\ne dos pontos correntes\n(a:2!\n-\tEncontrar o conjunto de par\u00e2metros que definem as transforma\u00e7\u00f5es de rota\u00e7\u00e3o e transla\u00e7\u00e3o (nesta ordem) capazes de mapear os pontos correntes sobre os pontos solu\u00e7\u00e3o.\nA seguir, descreveremos cada uma das etapas acima.\n2.3.1\tObten\u00e7\u00e3o da transforma\u00e7\u00e3o de escala\nAs mudan\u00e7as de escala existentes entre as se\u00e7\u00f5es de um objeto s\u00e3o normalmente produto de um processo de aquisi\u00e7\u00e3o mal realizado, ou ainda problemas com o hardware de digitaliza\u00e7\u00e3o, como por exemplo scanners e c\u00e2meras com deriva\u00e7\u00f5es (drifts) indesej\u00e1veis em seu funcionamento.\n(2.1)\n(2.2)\n(2.3)\nPropomos duas alternativas para resolver o problema de escala. A primeira op\u00e7\u00e3o, a mais geral, utiliza os pontos rotulados enquanto que a segunda pode ser vista como uma etapa de pr\u00e9-processamento, n\u00e3o utilizando os pontos rotulados. Nas pr\u00f3ximas duas se\u00e7\u00f5es descreveremos cada uma das duas metodologias propostas.\n2.3.1.1\tObten\u00e7\u00e3o da escala a partir dos pontos rotulados\nEsta primeira t\u00e9cnica, a qual pode ser aplicada a qualquer caso, baseia-se na compara\u00e7\u00e3o entre os comprimentos m\u00e9dios dos segmentos formados pelos pontos rotulados nas se\u00e7\u00f5es mestre e corrente.\nOs comprimentos m\u00e9dios correspondentes \u00e0s se\u00e7\u00f5es corrente e mestre s\u00e3o calculados da seguinte forma:\n&lt;= E \u00ca Vw-;)2+\u00ab-^)2\n2 *=1\n\u2122 e \u00e8 y\u00ab-^)2+w-^)2\n*'=i j=\u00bb+i\nDesta forma, \u00e9 poss\u00edvel determinar o par\u00e2metro de escala como:\nm\ns = \u2014 c\n2.3.1.2\tA transforma\u00e7\u00e3o de escala como etapa de pr\u00e9-processamento\nNesta se\u00e7\u00e3o descreveremos a segunda t\u00e9cnica proposta para a obten\u00e7\u00e3o do par\u00e2metro de escala, a qual nao \u00e9 t\u00e3o geral quanto a apresentada na se\u00e7\u00e3o anterior, mas que \u00e9 \u00fatil em muitos casos.\nConsidere-se por exemplo a fig. 2.2, que apresenta os contornos preenchidos de duas se\u00e7\u00f5es consecutivas obtidas na digitaliza\u00e7\u00e3o de um objeto tridimensional, um modelo de meio poroso, como veremos no cap\u00edtulo 5 (Note as marcas fiduciais introduzidas, que s\u00e3o utilizadas em uma etapa posterior para a obten\u00e7\u00e3o dos pontos rotulados).\nFigura 2.2: Contornos preenchidos de duas se\u00e7\u00f5es consecutivas de um objeto tridimensional\nA id\u00e9ia \u00e9 obter uma correla\u00e7\u00e3o entre o par\u00e2metro de escala s e as \u00e1reas das se\u00e7\u00f5es. N\u00e3o podemos relacionar contudo o par\u00e2metro s com as \u00e1reas diretamente, pois se tratam de par\u00e2metros de dimensionalidades distintas: este \u00e9 linear, enquanto que aquelas s\u00e3o quadr\u00e1ticas. Temos que procurar portanto um atributo para as se\u00e7\u00f5es que seja linear.\nA solu\u00e7\u00e3o neste caso \u00e9 tomar os raios m\u00e9dios das se\u00e7\u00f5es, os quais podem ser definidos em fun\u00e7\u00e3o das \u00e1reas como:\nA\n(2.5)\nDesta forma, obtemos o par\u00e2metro de escala s como:\n2.3.2\tObten\u00e7\u00e3o das transforma\u00e7\u00f5es de rota\u00e7\u00e3o e transla\u00e7\u00e3o\nEsta etapa \u00e9 o ponto central do m\u00e9todo proposto, onde formulamos e derivamos a solu\u00e7\u00e3o do problema de programa\u00e7\u00e3o quadr\u00e1tica correspondente ao crit\u00e9rio de m\u00ednimos quadrados e em seguida mostramos como obter os par\u00e2metros de rota\u00e7\u00e3o e transla\u00e7\u00e3o a partir de uma estrat\u00e9gia de busca orientada.\n2.3.2.1\tSolu\u00e7\u00e3o do problema de tr\u00eas pontos\nPara facilitar o entendimento da t\u00e9cnica desenvolvida, consideraremos inicialmente o problema de se encontrar as transforma\u00e7\u00f5es de rota\u00e7\u00e3o e transla\u00e7\u00e3o para o caso em que se disp\u00f5e de tr\u00eas pontos rotulados em cada se\u00e7\u00e3o. Posteriormente, ser\u00e1 descrita a generaliza\u00e7\u00e3o para n pontos.\nProcuraremos formular o problema de m\u00ednimos quadrados no contexto da programa\u00e7\u00e3o quadr\u00e1tica. Para isso, necessita-se de uma fun\u00e7\u00e3o custo e de um conjunto de restri\u00e7\u00f5es.\nA fun\u00e7\u00e3o custo para o m\u00e9todo de m\u00ednimos quadrados \u00e9 simplesmente a soma das dist\u00e2ncias ao quadrado entre os pontos solu\u00e7\u00e3o e os pontos mestres:\n(*1 - *i)2 + (yi - vi)2 + (*2 - ^)2 + (.Vi - Vi)2 + (*3 - X3)2 + (V3 - vi)2 (2.7)\nO conjunto de restri\u00e7\u00f5es a que os pontos solu\u00e7\u00f5es devem obedecer diz respeito \u00e0 geometria dos pontos correntes, j\u00e1 que se deseja que estes possam ser mapeados exatamente sobre os pontos solu\u00e7\u00e3o. No caso de tr\u00eas pontos, o objetivo \u00e9 portanto descrever, de forma a n\u00e3o permitir ambiguidades, a geometria de um tri\u00e2ngulo.\nEm uma primeira abordagem, poder\u00edamos considerar o seguinte conjunto de restri\u00e7\u00f5es:\n(z2 - *i)2 + to - yi)2\t- 7]\n(z3-zi)2 + to-i/i)2\t~&lt;\t(2-8)\nto - *i)to - *1) + to - 2/1 )to \" yi) ~ \u00ed\nonde:\n\u25a0q = (x'2 - z'i)2 + (y2 - vj)2\n&lt;= O\u00e1 \u2014 x\u00ed )2 + (s4 \u2014 v\u00ed)2\nC = (i'2-a:'j)(a:3-x;) + (i4-l4)(l\u00e9-/i)\nEste conjunto de restri\u00e7\u00f5es corresponde a especificar o comprimento dos lados P1P2 e P{P^ ^em como 0 \u00e2ngulo entre eles (ver fig. 2.3).\nFigura 2.3: Especifica\u00e7\u00e3o de geometria invariante a rota\u00e7\u00e3o e transla\u00e7\u00e3o\nO problema de programa\u00e7\u00e3o quadr\u00e1tica formado por (2.7) e (2.8) acima \u00e9 n\u00e3o-linear devido ao conjunto de restri\u00e7\u00f5es especificado. Sua solu\u00e7\u00e3o pode ser obtida por m\u00e9todos iterativos de aproxima\u00e7\u00e3o, tal como o m\u00e9todo de Newton [25].\nUma solu\u00e7\u00e3o em forma fechada pode ser obtida desde que o conjunto de restri\u00e7\u00f5es seja linear, resultando em um sistema de equa\u00e7\u00f5es lineares ap\u00f3s a aplica\u00e7\u00e3o das condi\u00e7\u00f5es de primeira ordem, conforme ser\u00e1 visto mais adiante.\nUm tal conjunto linear de restri\u00e7\u00f5es pode ser obtido se desvincularmos a rota\u00e7\u00e3o da transla\u00e7\u00e3o. Se o problema de minimiza\u00e7\u00e3o envolve apenas transla\u00e7\u00e3o, a descri\u00e7\u00e3o da geometria dos pontos correntes n\u00e3o precisa envolver comprimentos ou \u00e2ngulos, mas apenas vetores.\nNo nosso caso, s\u00e3o especificados os vetores P\\P^ e P1P3, como pode ser visto na fig. 2.4. 0 conjunto de restri\u00e7\u00f5es resultante \u00e9 simplesmente:\nX2 - Xj = Qi\n2-3 - X! = a2\n(2-9)\ny? \u201d y-L = 0i\n\u00edfo - yi ~ ^2\nA rota\u00e7\u00e3o est\u00e1 embutida nos par\u00e2metros ai,a2\u00bb/?i e 02- O c\u00e1lculo destes termos ser\u00e1 descrito posteriormente.\nFigura 2.4: Especifica\u00e7\u00e3o de geometria invariante apenas a transla\u00e7\u00e3o\nPara fins de simplicidade na obten\u00e7\u00e3o da solu\u00e7\u00e3o do problema de programa\u00e7\u00e3o quadr\u00e1tica, \u00e9 conveniente introduzir a seguinte mudan\u00e7a de vari\u00e1veis:\n= si ~\nW\u00ed =\t%2 \u201c ^2\n=\t^3-^3\t(2.10)\n= yi-vl\n^V2 = yi-y\u00ed\n\t= V3 - y-3 0 problema de programa\u00e7\u00e3o quadr\u00e1tica pode ser reescrito ent\u00e3o da seguinte\nforma:\tmin w^i2 + wX22 + wX32 + wyl2 +\t+ wy32\nsujeito a\nWx2 ~ \u2122xl\n\n(2.11)\nW^-Wari = a2 \u201c (^3 \u201c xl)\nWpj-Wji = A - (t\u00f3 -\u2019/\u00cd)\nWy3 ~ Wyl\n= &amp;~\u00fc/3\u201d^r)\nObserve que na formula\u00e7\u00e3o (2.11) acima o vetor solu\u00e7\u00e3o fornece uma medida direta do res\u00edduo ou erro associado \u00e0 minimiza\u00e7\u00e3o, em contraste com a formula\u00e7\u00e3o anterior \u00e0 mudan\u00e7a de vari\u00e1veis.\nA formula\u00e7\u00e3o (2.11) permite tamb\u00e9m colocar o problema na forma matricial\npadr\u00e3o:\nmin |wtQW\n2\nsa AW = b\nonde:\nQ = 2I6x6\nw = [ wxi Wx2 Wx3 Wyi Wy2 Wy3\n\u201d-110\t0\t0\t0 '\n10\t1\t0\t0\t0\n0 0\t0\t-1\t1\t0\n0 0\t0\t-1\t0\t1\nA =\n(2.13)\n(2.14)\n(2.15)\n<*i + (x; - $;)\nb= ^ + (^3-^1) Pi + f\u00e2-yl)\n. ^2 + (y\u00e3 \u201d y\u00ed)\n0 problema descrito por (2.12) pode ser resolvido utilizando-se o m\u00e9todo da m\u00ednima. norma [34], ou, alternativamente, pode-se aplicar as condi\u00e7\u00f5es necess\u00e1rias de La-grange e resolver o sistema linear resultante [25]. Nosso m\u00e9todo emprega a segunda op\u00e7\u00e3o, como veremos a seguir.\nUsando as condi\u00e7\u00f5es necess\u00e1rias de Lagrange, obt\u00e9m-se o seguinte sistema linear:\n\u00ed QW + Atp =\nI AW\nonde p \u00e9 o vetor de multiplicadores de Lagrange.\nMostra-se [25] que, se Q \u00e9 uma matriz n x n positiva-definida no sub-espa\u00e7o II = {W AW = 0} e A tem posto m, sendo A uma matriz m x n, ent\u00e3o a matriz\nQ A^\nA 0\n\u00e9 n\u00e3o-singular, e consequentemente o sistema (2.17) possui solu\u00e7\u00e3o.\nNo nosso caso, Q \u00e9 uma matriz 6x6 positiva definida em todo o espa\u00e7o R6, pois \u00e9 m\u00faltipla positiva da identidade; A \u00e9 uma matriz 4x6 de posto 4 (Basta verificar que os vetores-linha de A s\u00e3o linearmente independentes). Desta forma, est\u00e1 garantido que o sistema (2.17) possui solu\u00e7\u00e3o, a qual pode ser obtida alg\u00e9bricamente como:\nfi \"~(aQ_1At) b\t(2.18)\nW = Q-1Ar(AQ-1AT)\u201c1b\t(2.19)\nUm problema que surge neste momento \u00e9 o da invers\u00e3o da matriz AQ\u201c1AT. Devido \u00e0 maneira como foi formulado o problema de programa\u00e7\u00e3o quadr\u00e1tica, a matriz A apresenta uma forma muito simples, como vemos na eq. (2.15). Isto permite se obter a\ninversa da matriz AQ\u201d1 AT alg\u00e9bricamente, de forma fechada, mesmo no caso geral de n pontos rotulados (como veremos adiante), evitando assim a invers\u00e3o num\u00e9rica de matrizes, a qual \u00e9 cara computacionalmente e introduz erro num\u00e9rico. Este \u00e9 o principal aspecto do m\u00e9todo proposto.\nDesta forma, o vetor de multiplicadores de Lagrange g e o vetor solu\u00e7\u00e3o W s\u00e3o dados simplesmente por:\n\t\t\t= Lb\t\n\t\tw\t= Mb\t\nonde:\t\t\t\t\n\t\t2\t-1 0\t0\n\t2\t-1\t2 0\t0\n\tL =\t\t\t\n\t3\t0\t0 2\t-1\n\t\t0\t0 -1\t2\n1-10 0\n2-100\n0\t0 2 -1\n0\t0-1 2 ,\nNote que a matriz M possui um formato peculiar:\nonde:\nM =\t0\t0\n\t\t\n\t-1\t-1\n1\t\t\n4? = - 3\t2\t-1\n\t-1\t2\n(2.20)\n(2.21)\n(2.22)\n(2.23)\n(2.24)\n(2.25)\nas componentes x e y dos vetores Web separadamente,\t\t\t\t\nw =\tWx . Wy\t\t\t(2.26)\nb =\tbx by\t\t\t(2.27)\nteremos:\t\t\t\t\nwx\t= #b;\t\tX\t(2.28)\nwy\t= #b;\t\tZ\t(2.29)\nAs equa\u00e7\u00f5es (2.28) e (2.29) permitem apreciar a simplicidade da abordagem adotada, possivelmente insuspeita a princ\u00edpio. Vale ressaltar ainda que, como veremos adiante, para problemas com n pontos rotulados a separabilidade da matriz M se mant\u00e9m, o que representa um fato muito vantajoso computacionalmente.\n2.3.2.1.1\tDetermina\u00e7\u00e3o do par\u00e2metro de rota\u00e7\u00e3o atrav\u00e9s da busca orientada\nOs termos ai,a2,/?i e fa, daqui por diante chamados de termos de rota\u00e7\u00e3o. desempenham um papel importante no m\u00e9todo proposto, pois representam a conex\u00e3o entre o procedimento de minimiza\u00e7\u00e3o descrito na se\u00e7\u00e3o anterior e a busca orientada que determina o par\u00e2metro de rota\u00e7\u00e3o 0.\nComo j\u00e1 foi mencionado, a id\u00e9ia central do m\u00e9todo \u00e9, na formula\u00e7\u00e3o do problema de minimiza\u00e7\u00e3o, deixar a rota\u00e7\u00e3o \u00e0 parte, resultando em uma deriva\u00e7\u00e3o simples e que exija pouco esfor\u00e7o computacional, produzindo como consequ\u00eancia um menor erro num\u00e9rico.\n0 par\u00e2metro de rota\u00e7\u00e3o 0 \u00e9 encontrado de forma iterativa, em um processo de busca orientada, onde a cada itera\u00e7\u00e3o, o problema (2.12) \u00e9 resolvido (o que como vimos requer apenas duas multiplica\u00e7\u00f5es de matrizes), o res\u00edduo ou erro m\u00e9dio quadr\u00e1tico (RMS) \u00e9 calculado diretamente a partir do vetor solu\u00e7\u00e3o W, e a busca segue em dire\u00e7\u00e3o do menor\nRMS, dado por:\nRMS = |\u00a3V^\u00ed + wJ,.\t(2.30)\n1=1\nConstatou-se na pr\u00e1tica que o criterio RMS acima apresenta um comportamento unimodal em rela\u00e7\u00e3o ao par\u00e1metro isto \u00e9, n\u00e3o possui m\u00ednimos locais, mas apenas um m\u00ednimo global. Um esquema simples para a busca pode ser obtido portanto atrav\u00e9s da subdivis\u00e3o do espa\u00e7o de interesse (o intervalo 0o - 360\u00b0) em incrementos iguais e pelo refinamento progressivo da subdivis\u00e3o em torno do RMS m\u00ednimo obtido a cada passo at\u00e9 atingir uma resolu\u00e7\u00e3o predefinida. O processo de busca pode ent\u00e3o ser implementado de forma bastante eficiente, come\u00e7ando com um incremento \u201cgrosso\u201d que val sendo sucessivamente refinado tanto quanto se queira. Ap\u00f3s a obten\u00e7\u00e3o do par\u00e2metro de rota\u00e7\u00e3o 0 a partir da busca, \u00e9 f\u00e1cil obter os par\u00e2metros de transla\u00e7\u00e3o tx e tVi como mostraremos na se\u00e7\u00e3o 2.3.3.\nOs termos de rota\u00e7\u00e3o s\u00e3o calculados para cada itera\u00e7\u00e3o da busca a partir da geometria dos pontos correntes e do \u00e1ngulo 0 corrente. O sistema de coordenadas pode ser escolhido arbitrariamente; no entanto, \u00e9 imprescind\u00edvel que a conven\u00e7\u00e3o adotada seja consistente em todos os passos da implementa\u00e7\u00e3o, desde a etapa de obten\u00e7\u00e3o dos pontos rotulados at\u00e9 o processo de reconstru\u00e7\u00e3o propriamente dito. No caso de nossa implementa\u00e7\u00e3o, o sistema de coordenadas adotado \u00e9 o sistema retangular usual cuja origem \u00e9 o centro de cada se\u00e7\u00e3o, o que simplifica a etapa de reconstru\u00e7\u00e3o, pois permite implementar a transforma\u00e7\u00e3o de rota\u00e7\u00e3o de maneira mais simples.\nExplicaremos agora como obter os termos de rota\u00e7\u00e3o a partir da geometria dos pontos correntes e do par\u00e1metro 0 corrente. Como j\u00e1 vimos, o triangulo formado pelos tr\u00eas pontos correntes da se\u00e7\u00e3o a ser alinhada pode ser descrito por dois vetores:\nv; =\t(2.31)\nv' = (xs-Zuys-y'i)\t(2.32)\nEsta descri\u00e7\u00e3o \u00e9 invariante \u00e0 transla\u00e7\u00e3o, mas n\u00e3o o \u00e9 em rela\u00e7\u00e3o \u00e0 rota\u00e7\u00e3o. Aplicando-se uma rota\u00e7\u00e3o de um \u00e2ngulo 0 no sentido anti-hor\u00e1rio, obtemos (ver fig. 2.5):\nx\" = 3?J eos 0 \u2014 sin 0 i = 1,2,3.\ny','\t\u2014 gf' gjn $ yt. cog Q \u00ed=l,2,3.\nassim, os vetores ap\u00f3s a rota\u00e7\u00e3o s\u00e3o dados por:\n(*2 \u201c A) cos e - (y2 - 3/0 sin 0 (x2 - 2:0 sin 0 4- (3/2 ~ 3/0cos0\n(x'3 - xft) cos 0 - (y3 - 3/\u00ed) sin 0 (^3 - 2:0 sin0 4* (3/3 ~ Vi)cos#\nDesta forma, tem-se:\noi(0) = (x2 - 2:0 cos0 - (3/2 - 3/0 sin0\no2(0) = (2:3 - X0COS0 - (3/3 - 3/0sin0\n&amp;(0) = (z'2~?0sm0 + (3/2-i/0cos0\n/?2(0) = (xf3 - a:0sin0 + (y3 ~ $/0cos0\n(2.33)\n(2.34)\n(2.35)\n(2.36)\n(2.37)\n(2.38)\n(2.39)\n(2.40)\n2.3.2.2\tGeneraliza\u00e7\u00e3o do m\u00e9todo para n pontos rotulados\nA extens\u00e3o da t\u00e9cnica proposta na se\u00e7\u00e3o anterior para um n\u00famero n arbitr\u00e1rio de pontos \u00e9 imediata.\nA fun\u00e7\u00e3o custo a ser utilizada continua sendo a soma das dist\u00e2ncias ao quadrado entre os pontos solu\u00e7\u00e3o e os pontos mestres:\n(*1 ~ Xj)2 + (z2\t+\t~X*n)2 + (.yi \" ^*)2 + (S/2\t+\t+\t(2A1)\nO conjunto de restri\u00e7\u00f5es especifica os vetores P^P?,, P1P3, . \u25a0 \u2022, PiPn> mantendo a id\u00e9ia anterior de uma especifica\u00e7\u00e3o de geometria invariante apenas \u00e0 transla\u00e7\u00e3o:\nX2 ~~ Xi = Oi\n3?3 \u201c\t=\t\u00ab2\n\u00cdTn Xi\t\u2014\tCt'n\u20141\nV2 - Vi\t-\t01\n313-1/1\t=\t\u00edh\nVn ~ Vl = Pn-l\nFazendo uma mudan\u00e7a de vari\u00e1veis an\u00e1loga \u00e0 anterior,\nWxi = Xi ~~\ni = 1,..., n\nwvi = Vi~ Vi \u00ed = 1,..., n\n(2.42)\n(2.44)\nobtemos a seguinte formula\u00e7\u00e3o para o problema de programa\u00e7\u00e3o quadr\u00e1tica:\nmin\n\u00c8^. + \u00c8ri.\n\u00cd=1\t1=1\nsujeito a\nwx2 \u201c wxl\nWx3 ~ WX1\n\n= \u00ab2 \u201d (\u00ae5 ~ Xj)\nwxn ~ ^xl\nWy2 - Wyl\nWy^ Wyl\n(ix\t$ \\\n\"~ xl)\n= h- te* -v\u00ed)\nVlyn-wvl =\t/3n-i - (s/j - 3/j)\nNote que o problema acima cont\u00e9m n vari\u00e1veis e 2(n - 1) restri\u00e7\u00f5es.\nA forma matricial padr\u00e3o do problema acima \u00e9 dada por: min |wrQW\n(2.45)\nonde tem-se:\nQ\n= 2l2nx2n\t\t\t(2-46)\n^n~lxn\tOn\u20141xn\t\t(2.47)\nOn-lXn\tNn_ixn\t\t\nwyl\tWy2 \u2022 \u2022 \u2022\t^yn 1\t(2.48)\ncom:\nj / 1 e i = j ~ 1 caso contr\u00e1rio\nbxi = ai +\t- xj)\n(2.49)\n(2.50)\n(2.51)\n-1 , j= 1\nN\u00ed; =\t1\ni =\t\u2014 1\nj =\n0\ni = 1,..n \u2014 1\n\u00f4y: = A\u2019 + (&amp;*+i ~~yi) \u00ed = 1,..., n - 1\nSeguindo uma argumenta\u00e7\u00e3o inteiramente an\u00e1loga \u00e0 da se\u00e7\u00e3o 2.3.2.1.1, conclu\u00edmos que:\nO\u00ed(^) = (x$+1 - z\u00ed)cos0 \u201d (yi+1 \u201c #\u00ed)sin# \u00ed = l?...,7i\u201cl\t(2.53)\n0i(0) = (z^i - zl)sin# + t\u00f3+i - *4)cos0 i = l,...,n~l\t(2.54)\nA solu\u00e7\u00e3o do problema formulado em (2.45) existe, pois os vetores-linha da matriz A s\u00e3o linearmente independentes (ver se\u00e7\u00e3o 2.3.2.1), e \u00e9 dada pela equa\u00e7\u00e3o (2.19):\nW = Q-1Ar(AQ-1Ar)'1b\t(2.55)\nComo foi discutido na se\u00e7\u00e3o 2.3.2.1, devido \u00e0 forma particular da matriz A foi poss\u00edvel determinar a inversa de maneira puramente alg\u00e9brica. Desta forma, a solu\u00e7\u00e3o assume a forma simples da equa\u00e7\u00e3o (2.21):\nW = Mb\nA matriz M permanece separ\u00e1vel para o problema com. n pontos:\n\tM2nx2{\t1 n-'>- \u00f1\t^riXn-l Onxn-1\tOnxn-1 $nXn-1\t(2.56)\t\nonde a matriz $ \u00e9 descrita por:\t\t\t\t\t\t\n\t-1,\ti = 1 ou\t1 - 1 / j\ti = 1,\t. ,.,n\t\n<\tn \u2014 1 ,\t\u00ab\" 1 = j\t\tj = 1\t,...,71-1\t(2.57)\n\t0 ,\tcaso contr\u00e1rio\t\t\t\t\nA solu\u00e7\u00e3o \u00e9 portanto dada simplesmente por:\nWx = l$bx\t(2.58)\nn\nWy = ifcby\t(2.59)\nVale ressaltar que o erro m\u00e9dio quadr\u00e1tico a ser calculado a cada itera\u00e7\u00e3o da busca \u00e9 dado por:\n+ (2.60) n i=l\n2.3.3\tObten\u00e7\u00e3o dos par\u00e2metros de registro\nPodemos resumir a obten\u00e7\u00e3o dos par\u00e2metros de registro, descritos na se\u00e7\u00e3o 2.2, da seguinte forma:\nPar\u00e2metro de escala Obtido na etapa de pr\u00e9-processamento descrita na se\u00e7\u00e3o 2.3.1\n-\tPar\u00e2metro de rota\u00e7\u00e3o 0: Obtido diretamente da busca, sendo o \u00e2ngulo que produz o menor erro m\u00e9dio quadr\u00e1tico, calculado para cada itera\u00e7\u00e3o conforme a eq. (2.60)\n-\tPar\u00e2metros de transla\u00e7\u00e3o tx e ty: S\u00e3o obtidos a partir do par\u00e2metro de rota\u00e7\u00e3o e dos pontos solu\u00e7\u00e3o e correntes. Note que os pontos solu\u00e7\u00e3o s\u00e3o dados por:\nXi \u2014 x? + wxt\t\u00ed = l,...,n\t(2.61)\nVi = y* 4- wyi\ti = 1,..., n\t(2.62)\nTendo os pontos solu\u00e7\u00e3o e os pontos correntes (e conhecendo-se o \u00e2ngulo de rota\u00e7\u00e3o), \u00e9 simples determinar a transla\u00e7\u00e3o introduzida. O problema de minimiza\u00e7\u00e3o (2.11) garante que a transla\u00e7\u00e3o \u00e9 a mesma para cada um dos pontos, portanto os par\u00e2metros tx e ty podem ser calculados tomando como base, por exemplo, o primeiro ponto:\n= xi - (\u00ed| cos 0 -y\u00ed sin 0)\t(2.63)\n2.4\tDois exemplos com imagens sint\u00e9ticas\nNesta se\u00e7\u00e3o apresentamos dois exemplos de aplica\u00e7\u00e3o do m\u00e9todo de registro proposto utilizando imagens sint\u00e9ticas.\nNestes dois exemplos o processo utilizado para a obten\u00e7\u00e3o dos pontos rotulados \u00e9 manual, e n\u00e3o consideraremos o problema de escala, isto \u00e9, assumiremos uma magnifi-ca\u00e7\u00e3o uniforme entre as se\u00e7\u00f5es. No cap\u00edtulo 5 apresentaremos os resultados obtidos em um caso de reconstru\u00e7\u00e3o tridimensional real, quando discutiremos tamb\u00e9m a determina\u00e7\u00e3o da transforma\u00e7\u00e3o de escala.\nApresentaremos uma compara\u00e7\u00e3o feita com o m\u00e9todo proposto por Merickel [30]. Como se ver\u00e1, nosso m\u00e9todo apresentou resultados superiores, devido \u00e0 simplicidade num\u00e9rica do algoritmo (N\u00e3o h\u00e1 invers\u00f5es num\u00e9ricas de matrizes), apesar de se utilizar um processo de busca, o qual \u00e9 inerentemente aproximativo.\n2.4.1\tPrimeiro exemplo\nNeste primeiro exemplo, a primeira se\u00e7\u00e3o \u00e9 uma imagem sint\u00e9tica simples, enquanto que a segunda foi obtida a partir da primeira introduzindo~se uma transforma\u00e7\u00e3o combinada de rota\u00e7\u00e3o e transla\u00e7\u00e3o com os seguintes par\u00e2metros (ver hg. 2.6):\nFigura 2.6: Se\u00e7\u00f5es sint\u00e9ticas utilizadas no primeiro exemplo\nUtilizamos os asteriscos para indicar que os par\u00e2metros acima s\u00e3o \u201cideais\u201d, no sentido de que deveriam ser os par\u00e2metros otidos em um processo de registro onde n\u00e3o houvesse a presen\u00e7a de qualquer tipo de erro (Na verdade, os par\u00e2metros a serem obtidos s\u00e3o os acima multiplicados por -1, pois o m\u00e9todo de registro encontrar\u00e1 a transforma\u00e7\u00e3o inversa. Nas tabula\u00e7\u00f5es de resultados apresentadas para o primeiro exemplo, desconsideramos o sinal negativo).\nNeste exemplo, os pontos rotulados correspondem aos \u201cv\u00e9rtices\u201d das imagens sint\u00e9ticas. Foram empregados de dois at\u00e9 seis pontos. Vale ressaltar que, ao contr\u00e1rio do que \u00e9 afirmado em [30], o m\u00e9todo de Merickel pode ser aplicado ao caso de apenas dois pontos rotulados.\nOs resultados obtidos para este exemplo pelo m\u00e9todo proposto podem ser vistos na tabela 2.1, enquanto que os resultados obtidos pelo m\u00e9todo de Merickel encontram-se na tabela 2.2.\nN\u00famero de pontos\tta:\tty\t0\tRMS\n2\t24.754\t51.739\t59.87294\t0.07173\n3\t25.024\t51.943\t59.75159\t0.35999\n4\t24.916\t51.945\t59.78497\t0.33898\n5\t24.901\t51.962\t59.77870\t0.28318\n6\t24.899\t51.935\t59.78563\t0.25959\n^^^m\u00e9dio = 0'^6269\nTabela 2.1: Resultados do primeiro exemplo para o m\u00e9todo proposto\nAs fontes de erro no caso deste exemplo s\u00e3o o erro do operador ao selecionar manualmente os pontos rotulados e o erro digital introduzido na gera\u00e7\u00e3o da segunda se\u00e7\u00e3o. Os resultados indicam que o menor erro m\u00e9dio quadr\u00e1tico foi atingido para o caso de apenas dois pontos rotulados. Isto significa que as fontes de erro mencionadas acima t\u00eam pouca influ\u00eancia neste caso, o mais simples de todos. Deve ser observado, entretanto, que um pequeno RMS indica um bom casamento entre os pontos rotulados dados, mas n\u00e3o \u00e9 uma condi\u00e7\u00e3o suficiente para um bom registro, pois o processo de sele\u00e7\u00e3o dos pontos rotulados, quer seja manual, quer seja autom\u00e1tico, \u00e9 muito sujeito a erros. Se o erro na obten\u00e7\u00e3o dos\nN\u00famero de pontos\t\t\t0\tRMS\n2\t24.738\t51.765\t59.87294\t0.07648\n3\t25.023\t51.942\t59.72631\t0.36415\n4\t24.915\t51.955\t59.77184\t0.34360\n5\t24.899\t51.968\t59.76995\t0.28605\n6\t24.893\t51.949\t59.76402\t0.26476\nRMSm\u00e9dio = 0.26701\nTabela 2.2: Resultados do primeiro exemplo para o m\u00e9todo de Merickel\npontos rotulados for entretanto garanti d amente pequeno, ent\u00e3o o RMS fornece um bom crit\u00e9rio tamb\u00e9m de casamento entre as se\u00e7\u00f5es.\nFinalmente, observamos que para este exemplo o m\u00e9todo proposto foi superior ao m\u00e9todo de Merickel em cada caso, assim como na m\u00e9dia.\n2.4.2\tSegundo exemplo\nO segundo exemplo apresentado \u00e9 similar ao primeiro. Foram geradas duas se\u00e7\u00f5es sint\u00e9ticas, onde a primeira \u00e9 um hex\u00e1gono e a segunda \u00e9 obtida a partir da primeira n\u00e3o apenas se introduzindo uma transforma\u00e7\u00e3o geom\u00e9trica, mas tamb\u00e9m deformando-se a primeira imagem (fig. 2.7). Com isso, pretendeu-se modelar uma fonte de erro t\u00edpica do\nFigura 2.7: Se\u00e7\u00f5es sint\u00e9ticas utilizadas no segundo exemplo\nA transforma\u00e7\u00e3o geom\u00e9trica introduzida na segunda se\u00e7\u00e3o foi neste caso apenas\numa rota\u00e7\u00e3o, n\u00e3o tendo sida aplicada nenhuma transla\u00e7\u00e3o:\n\n\ne* ~ 20\u00b0\nOs resultados foram obtidos mais uma vez variando-se o n\u00famero de pontos rotulados de 2 a 6, os quais correspondem aos v\u00e9rtices dos pol\u00edgonos. Como no exemplo anterior, as tabelas 2.3 e 2.4 permitem fazer a compara\u00e7\u00e3o entre os m\u00e9todos proposto e o de Merickel, respectivamente, onde ignoramos o sinal negativo do par\u00e2metro de rota\u00e7\u00e3o.\nN\u00famero de pontos\ttx\t\te\tRMS\n2\t-0.865\t-17.061\t32.91169\t1.42466\n3\t6.390\t-7.492\t26.23296\t5.02885\n4\t7.932\t-5.236\t24.90108\t5.12179\n5\t6.584\t-1.143\t22.88466\t6.91792\n6\t7.989\t0.295\t23.07049\t7.95289\nRMSm\u00e9dio ~ 5-28922\nTabela 2.3: Resultados do segundo exemplo para o m\u00e9todo proposto\nN\u00famero de pontos\t\t\te\tRMS\n2\t-2.936\t-15.382\t32.91169\t3.01608\n3\t4.458\t-8.098\t26.89112\t5.36441\n4\t7.676\t-5.256\t24.81533\t5.13932\n5\t6.219\t-1.163\t22.32030\t6.91838\n6\t8.076\t0.370\t22.73598\t7.98433\nKMSm\u00e9dio = 5.68450\nTabela 2.4: Resultados do segundo exemplo para o m\u00e9todo de Merickel\nComo era de se esperar, as taxas de erro RMS obtidas foram piores do que para o primeiro exemplo. Entretanto, \u00e9 importante notar que com o acr\u00e9scimo de pontos ambos os m\u00e9todos produziram par\u00e2metros de rota\u00e7\u00e3o cada vez mais pr\u00f3ximos do par\u00e2metro \u201cideal\u201d.\nTamb\u00e9m observamos que, mais uma vez, o m\u00e9todo proposto foi superior ao de Merickel em cada caso e tamb\u00e9m na m\u00e9dia. Destaca-se o caso de dois pontos, onde h\u00e1 uma diferen\u00e7a superior a 100% entre as duas taxas de erro RMS. Vale ressaltar tamb\u00e9m que a diferen\u00e7a percentual entre os RMS m\u00e9dios foi maior no segundo exemplo que no primeiro, indicando uma tend\u00eancia do m\u00e9todo proposto ter um desempenho t\u00e3o mais superior quanto menos exato for o casamento entre as se\u00e7\u00f5es e/ou entre os pontos rotulados.\nCap\u00edtulo 3\nMorfologia Matem\u00e1tica em Tr\u00eas Dimens\u00f5es\n3*1 Introdu\u00e7\u00e3o\nA an\u00e1lise e o processamento de imagens sofreram durante muito tempo, e ainda sofrem, de uma forte influ\u00eancia de t\u00e9cnicas do processamento de sinais cl\u00e1ssico, tal como a filtragem linear. Esta baseia-se na preserva\u00e7\u00e3o da adi\u00e7\u00e3o, e se presta muito bem \u00e0 modelagem de sistemas ac\u00fasticos, eletr\u00f4nicos, \u00f3pticos e outros. Infelizmente, tem-se constatado que, a despeito de sua import\u00e2ncia, as t\u00e9cnicas lineares n\u00e3o s\u00e3o suficientes para lidar com as imagens. 0 mundo como o enxergamos n\u00e3o \u00e9 transl\u00facido, mas apresenta objetos que se sobrep\u00f5em uns aos outros, al\u00e9m de conter um conceito importante e subjetivo, o de forma.\nA Morfologia Matem\u00e1tica, que teve suas bases lan\u00e7adas em 1964 por Georges Matheron e Jean Serra na \u00c9cole Nationale Sup\u00e9rieure des Mines de Paris, \u00e9 uma t\u00e9cnica n\u00e3o linear, com s\u00f3lida fundamenta\u00e7\u00e3o te\u00f3rica, que vem alcan\u00e7ando um enorme sucessso em aplica\u00e7\u00f5es de an\u00e1lise de imagens.\nA Morfologia Matem\u00e1tica se baseia em transforma\u00e7\u00f5es de forma que preservam a rela\u00e7\u00e3o de inclus\u00e3o, e n\u00e3o a de adi\u00e7\u00e3o. Estas transforma\u00e7\u00f5es satisfazem a um conjunto de princ\u00edpios fundamentais, escolhidos de forma a modelar fen\u00f4menos do mundo real dentro do que J. Serra denominou \u201cUniverso dos Corpos Morfol\u00f3gicos\u201d. Estes princ\u00edpios n\u00e3o vieram de um experimento espec\u00edfico, mas t\u00e3o pouco podem ser encarados como axiomas matem\u00e1ticos.\nAs transforma\u00e7\u00f5es estudadas pela Morfologia Matem\u00e1tica s\u00e3o definidas sobre reticulados completos, entidades matem\u00e1ticas com origem na teoria de conjuntos [5], Imagens bin\u00e1rias, em tom de cinza, multi-espectrais (coloridas), al\u00e9m dos intervalos, grafos, parti\u00e7\u00f5es, etc. s\u00e3o conceitos que podem ser formalizados com o uso de reticulados completos, tornando clara assim a abrang\u00eancia da teoria.\nAs opera\u00e7\u00f5es fundamentais da Morfologia Matem\u00e1tica s\u00e3o denominadas eros\u00e3o e dilata\u00e7\u00e3o. A partir de composi\u00e7\u00f5es destas opera\u00e7\u00f5es elementares \u00e9 poss\u00edvel gerar qualquer outra opera\u00e7\u00e3o definida entre reticulados completos [4]. As opera\u00e7\u00f5es entre reticulados completos se aplicam a diversos problemas recorrentes no campo da an\u00e1lise de imagens, tais como filtragem, segmenta\u00e7\u00e3o, descri\u00e7\u00e3o de forma e muitos outros.\nA id\u00e9ia b\u00e1sica das opera\u00e7\u00f5es fundamentais da Morfologia Matem\u00e1tica consiste em investigar uma imagem atrav\u00e9s de um elemento estruturante, examinando onde este elemento se \u201cencaixa\u201d. De fato, \u00e9 poss\u00edvel se demonstrar que existe uma bije\u00e7\u00e3o entre o conjunto das dilata\u00e7\u00f5es (resp. eros\u00f5es) e o conjunto dos elementos estruturantes [5], isto \u00e9, assim como cada elemento estruturante define uma opera\u00e7\u00e3o de eros\u00e3o e outra de dilata\u00e7\u00e3o, cada transforma\u00e7\u00e3o que seja uma eros\u00e3o ou dilata\u00e7\u00e3o possui um elemento estruturante associada a ela.\nNeste cap\u00edtulo, apresentaremos as transforma\u00e7\u00f5es b\u00e1sicas da Morfologia Matem\u00e1tica tridimensional. Estaremos mais interessados na Morfologia Matem\u00e1tica bin\u00e1ria ou de conjuntos [5], Daremos entretanto as principais defini\u00e7\u00f5es e conceitos referentes \u00e0 Morfologia Matem\u00e1tica n\u00edvel-de-cinza ou de fun\u00e7\u00f5es [49, 4]. Antes, apresentaremos conceitos preliminares que ser\u00e3o necess\u00e1rios para o desenvolvimento da Morfologia Matem\u00e1tica tridimensional.\n3.2\tConceitos preliminares\nNesta se\u00e7\u00e3o apresentaremos os conceitos b\u00e1sicos sobre esquema de representa\u00e7\u00e3o e topologia digital 3D que ser\u00e3o necess\u00e1rios na defini\u00e7\u00e3o das transforma\u00e7\u00f5es b\u00e1sicas da\n3.2.1\tEsquema de Representa\u00e7\u00e3o e Grid Digital\nA primeira quest\u00e3o relevante que deve ser analisada ao se propor um m\u00e9todo de an\u00e1lise de imagens tridimensionais diz respeito ao esquema de representa\u00e7\u00e3o a ser empregado e, mais particularmente, ao grid digital a ser adotado.\n0 problema consiste em escolher como distribuir pelo espa\u00e7o tridimensional os elementos digitais que comp\u00f5em as imagens. Isto determina a topologia digital do espa\u00e7o 3D, isto \u00e9, como os conceitos de vizinhan\u00e7a e conectividade, entre outros, est\u00e3o definidos.\nNo caso bidimensional, as op\u00e7\u00f5es mais utilizadas s\u00e3o os grid retangular e hexagonal [3]. No espa\u00e7o 3D o n\u00famero de alternativas cresce consideravelmente, devido \u00e0 maior complexidade. T\u00eam sido estudados, entre outros, os grids hexagonal cil\u00edndrico, c\u00fabico, c\u00fabico centrado e c\u00fabico de faces centradas [32].\nNeste trabalho utilizamos o grid c\u00fabico. Apesar de apresentar desvantagens (\u201cherdadas\u201d do grid retangular no caso 2D), tais como paradoxos de conectividade [23], este esquema possui a vantagem da simplicidade: al\u00e9m de ser perfeitamente isotr\u00f3pico, \u00e9 o esquema de representa\u00e7\u00e3o mais natural em computadores digitais. Al\u00e9m disso, como a maioria das imagens tridimensionais s\u00e3o obtidas a partir do empilhamento de se\u00e7\u00f5es bidimensionais, como no caso deste trabalho, o grid c\u00fabico representa a solu\u00e7\u00e3o mais simples e direta.\n0 esquema de representa\u00e7\u00e3o baseado no grid c\u00fabico \u00e9 tamb\u00e9m conhecido como modelo Voxel [20, 27]. O termo voxel \u00e9 um acr\u00f4nimo para volume element. Da mesma forma que o pixel \u00e9 a unidade b\u00e1sica de uma imagem 2D, o voxel \u00e9 o elemento b\u00e1sico de uma imagem tridimensional. Os voxels s\u00e3o portanto pequenos cubos de tamanho e orienta\u00e7\u00e3o uniformes, isto \u00e9, que formam uma subdivis\u00e3o regular do espa\u00e7o.\nNa cole\u00e7\u00e3o de cubos que constituem o espa\u00e7o voxel, cada pequeno cubo pode ser completamente descrito em termos das coordenadas de seu canto superior esquerdo posterior ou, alternativamente, de seu centro. Isto significa que, devido \u00e0 regularidade da\nsubdivis\u00e3o espacial, apenas um conjunto de coordenadas precisa ser armazenado para cada voxel [27]. Normalmente podemos limitar nossa aten\u00e7\u00e3o a uma regi\u00e3o de interesse, a qual \u00e9 um subconjunto de Z3, e ent\u00e3o a cole\u00e7\u00e3o pode ser eficientemente codificada como um matriz tridimensional c^, onde a posi\u00e7\u00e3o do voxel \u00e9 dada implicitamente pelos \u00edndices i,j, k (ver fig. 3.1). A este subconjunto de Z3 daremos o nome de espa\u00e7o vozel e o representaremos pela letra E. Como ilustra\u00e7\u00e3o, apresentamos na fig. 3.2 uma visualiza\u00e7\u00e3o tridimensional do espa\u00e7o voxel formado pelo empilhamento das fatias de um joelho obtidas por tomografia computadorizada de raio-x (onde a fatia situada no topo do volume pode ser vista), uma aplica\u00e7\u00e3o t\u00edpica do esquema de representa\u00e7\u00e3o Voxel.\nFigura 3.1: Regi\u00e3o de interesse e subdivis\u00e3o do espa\u00e7o voxel\n3.2.2\tVizinhan\u00e7a e Conectividade\nNesta se\u00e7\u00e3o e na seguinte, apresentaremos extens\u00f5es para o caso 3D de conceitos de topologia digital [24] que nos ser\u00e3o \u00fateis. Excelentes abordagens para o caso 2D podem ser encontradas em [43] e [22]\nNo caso do grid retangular 2D s\u00e3o bastante conhecidos os conceitos de 4- e 8-vizinhos. Dado um determinado pixel, os 4-vizinhos s\u00e3o aqueles que compartilham uma\nFigura 3.2: Exemplo de espa\u00e7o voxel: empilhamento das fatias de um joelho\naresta com este, enquanto que os 8-vizinhos compartilham pelo menos um v\u00e9rtice, como\n(a)\t(b)\nFigura 3.3: Vizinhan\u00e7a 2D: (a) 4-vizinhos ao pixel central e (b) 8-vizinhos ao pixel central\nNo caso 3D, podemos definir analogamente os conceitos de 6-, 18- e 26-vizinhan\u00e7a. Os 6-vizinhos a um dado voxel s\u00e3o aqueles que compartilham uma face com este, os 18-vizinhos compartilham pelo menos uma aresta e os 26-vizinhos compartilham pelo menos um v\u00e9rtice. Isto pode ser visto esquematicamente na hg. 3.4, onde por conveni\u00eancia os voxels s\u00e3o representados \u201cachatados\u201d.\nA partir do conceito de vizinhan\u00e7a podemos definir o de conectividade. Para isso, define-se um caminho de comprimento n como sendo uma sequ\u00eancia de voxels vq, tq,..., vn\nFigura 3.4: Vizinhan\u00e7a 3D: (a) 6-vizinhos (b) 18-vizinhos e (c) 26-vizinhos ao voxel central tal que v; \u00e9 vizinho de para i = 1,.. .,n. Dependendo da vizinhan\u00e7a utilizada, podemos ter portanto 6-, 18- ou 26-caminhos.\nSendo S um subconjunto do espa\u00e7o voxel E e u e v voxels pertencentes a 5, dizemos que u e v est\u00e3o conectados se existe um caminho come\u00e7ando no primeiro e terminando no segundo contendo apenas voxels pertencentes a 5. Obviamente, u e v podem estar 6-, 18- ou 26-conectados e, al\u00e9m disso, um voxel isolado \u00e9 sempre conectado a si pr\u00f3prio.\nPartindo das defini\u00e7\u00f5es acima podemos derivar os seguintes fatos sobre cornpo-nentes conexos, conceito que ser\u00e1 importante em cap\u00edtulos posteriores:\n-\tDado um voxel v G E, o conjunto de todos os voxels que s\u00e3o conectados segundo alguma vizinhan\u00e7a a v definem um componente conexo de S.\n-\tDois componentes conexos podem estar 6-, 18- ou 26-conectados, se for poss\u00edvel encontrar um voxel no primeiro que esteja 6-, 18- ou 26-conectado a outro voxel no segundo, ou podem n\u00e3o estar conectados.\n-No caso de 5 conter apenas um componente conexo dizemos que S \u00e9 6-, 18- ou 26- conexo, dependendo da vizinhan\u00e7a utilizada.\n3.2.3\tDist\u00e2ncia e Discos Digitais\nd(u,v) > 0\n(d(u,t?) = 0 O u = v)\n(3-1)\n(3.2)\nd(ti,v) = d(v,u)\nd(u,v) &lt;d(u,w) + d(w,v)\n(3-3)\nSejam dois voxels u e v pertencentes a E descritos respectivamente pelas coordenadas (ux,Uy,uz) e (vx,vy,vz). A dist\u00e2ncia euclidiana entre os dois voxels \u00e9 definida por:\t________________________\n<(u, v) = ^(ux - vx)2 + (uy - vy)2 + (uz - vzf\t(3.4)\nDuas outras dist\u00e2ncias que nos ser\u00e3o bastante \u00fateis s\u00e3o a dist\u00e2ncia do quarteir\u00e3o: dq(u,v) =| ux ~ vx | + | Uy \u25a0- vv | + | uz ~ vz |\t(3.5)\ne a dist\u00e2ncia do m\u00e1ximo:\ndm(u, v) - max{| ux - vx |, | uy - vy |, | uz - vz [}\t(3.6)\nPode-se mostrar que d\u20ac, dq e dm obedecem \u00e0s restri\u00e7\u00f5es (3.1) a (3.3), portanto s\u00e3o dist\u00e2ncias v\u00e1lidas. Verifica-se tamb\u00e9m que:\n\u00e1m<de&lt;dq\t(3.7)\nTendo definido a no\u00e7\u00e3o de dist\u00e2ncia, podemos passar ao importante conceito de discos digitais em E:\nDd(o,r) = {uCE\\d(o,u)<r}\t(3.8)\nonde o \u20ac E determina o centro do disco e r 6 Z+, o seu raio.\nPara se visualizar a forma assumida pelos discos digitais correspondentes \u00e0s diversas dist\u00e2ncias, \u00e9 \u00fatil reduzir o problema a duas dimens\u00f5es, impondo por exemplo\nDdq C Dd' C Ddm\n\nFigura 3.5: Discos 2D de raio r = 5 correspondentes \u00e0s dist\u00e2ncias (a) quarteir\u00e3o (b) euclidiana e (c) m\u00e1ximo\nNo caso tridimensional, \u00e9 f\u00e1cil agora concluir que, para as dist\u00e2ncias do quarteir\u00e3o, euclidiana e do m\u00e1ximo, teremos respectivamente aproxima\u00e7\u00f5es digitais de octaedros, esferas e cubos. Na fig. 3.6 podemos ver uma visualiza\u00e7\u00e3o 3D destes discos.\nFigura 3.6: Discos 3D de raio r \u2014 10 correspondentes \u00e0s dist\u00e2ncias (a) quarteir\u00e3o (b) euclidiana e (c) m\u00e1ximo\nOs elementos estruturantes com os quais lidaremos para constru\u00e7\u00e3o de gra-\nnulometrias, realiza\u00e7\u00e3o de filtros morfol\u00f3gicos, e outras opera\u00e7\u00f5es s\u00e3o os discos digitais, que possuem a vantagem de serem isotr\u00f3picos (sim\u00e9tricos) [44]. Os discos digitais 3D s\u00e3o tamb\u00e9m muito usados na Morfologia Matem\u00e1tica n\u00edvel-de-cinza, como por exemplo na implementa\u00e7\u00e3o de transforma\u00e7\u00f5es top-hat e rolling bali [49, 31].\n3.3\tAs transforma\u00e7\u00f5es b\u00e1sicas da Morfologia Matem\u00e1tica\nConsideremos o conjunto P(\u00a3) cujos elementos s\u00e3o todos os subconjuntos de E. O conjunto P(E) \u00e9 parcialmente ordenado pela rela\u00e7\u00e3o de inclus\u00e3o \u201cc\u201d. O conjunto parcialmente ordenado (P(\u00a3), C) provido das opera\u00e7\u00f5es de uni\u00e3o, interse\u00e7\u00e3o e complementa\u00e7\u00e3o constitui um reticulado completo [5].\nOs elementos de P(E) s\u00e3o na verdade nossos objetos de interesse dentro do espa\u00e7o voxel, enquanto que a rela\u00e7\u00e3o de inclus\u00e3o expressa o tipo de relacionamento entre os objetos que \u00e9 caracter\u00edstico \u00e0 Morfologia Matem\u00e1tica, conforme mencionado anteriormente. A Morfologia Matem\u00e1tica pode ser encarada como a \u201caplica\u00e7\u00e3o da teoria dos reticulados \u00e0s estruturas espaciais\u201d [45].\nNo caso das imagens 3D n\u00edvel-de-cinza, \u00e9 poss\u00edvel desenvolver um formalismo similar. Sendo K \u2014 [0, k] um intervalo fechado no conjunto dos n\u00fameros inteiros Z, mostra-se que o conjunto EK das fun\u00e7\u00f5es f : E \u2014\u25ba K, provido da rela\u00e7\u00e3o de ordem parcial&lt;, tal que para todo f,g \u20ac EK\\\nf &lt;g\t, Vu \u20ac E\t(3.10)\n\u00e9 um reticulado completo [4], onde as opera\u00e7\u00f5es de uni\u00e3o, interse\u00e7\u00e3o e complementa\u00e7\u00e3o s\u00e3o dadas respectivamente por:\n(/V^)(u) - max{/(u),^(u)} , Vu G E\t(3.11)\n(/ A g)(u) = min{/(u), g(u}} , Vu \u20ac E\n(3.12)\n(3.13)\n(~f)(u) = k~\tVuZE\n3.3.1\tEros\u00e3o e Dilata\u00e7\u00e3o\nPara definir as transforma\u00e7\u00f5es fundamentais da Morfologia Matem\u00e1tica, necessita-se antes do conceito de transla\u00e7\u00e3o e de origem de um elemento estruturante.\nPodemos obter transla\u00e7\u00f5es de um subconjunto B \u20ac P(E) da seguinte forma:\nB + u = (u+v)eE, iveB\t(3.14)\nNote que a opera\u00e7\u00e3o de soma deixa impl\u00edcito que assumimos uma origem o G E para o elemento estruturante:\nu + v = o 4- (\u00edh\u00ed + ou)\t(3.15)\nA eros\u00e3o (invariante por transla\u00e7\u00e3o) de um conjunto A \u20ac P(E) por um elemento estruturante B G P(E) pode ser definida como:\neS(A)^{ueE\\(BAu)C A}\t(3.16)\nA eros\u00e3o \u00e9 uma transforma\u00e7\u00e3o crescente, isto \u00e9, preserva a a rela\u00e7\u00e3o de inclus\u00e3o:\nAi C A2 =t> cjg(Aj) C \u20ac3(^2)\t(3.17)\nAl\u00e9m disso, se a origem est\u00e1 contida no elemento estruturante, a eros\u00e3o produz um efeito de \u201cencolhimento\u201d do conjunto original, isto \u00e9,\n0 \u20ac B => \u00a3b(A) C A\t(3.18)\ndiz-se ent\u00e3o que a eros\u00e3o por um elemento estruturante contendo a origem \u00e9 uma transforma\u00e7\u00e3o anti-extensiva.\nIntuitivamente, a defini\u00e7\u00e3o (3.16), em conjunto com a propriedade de anti-extensividade, reflete o conceito de \u201cinspe\u00e7\u00e3o\u201d atrav\u00e9s do elemento estruturante, que a-bordamos na introdu\u00e7\u00e3o deste cap\u00edtulo: a eros\u00e3o \u00e9 a transforma\u00e7\u00e3o pela qual s\u00e3o mantidos\nPara ilustrar o efeito da eros\u00e3o, consideremos o objeto tridimensional da fig. 3.7, um modelo da fase s\u00f3lida de uma rocha (0 processo de aquisi\u00e7\u00e3o e reconstru\u00e7\u00e3o tridimen-sional deste objeto ser\u00e1 descrito no cap\u00edtulo 5).\nFigura 3.7: Modelo tridimensional da fase s\u00f3lida de uma rocha\nNa fig. 3.8 podemos ver o efeito da eros\u00e3o por diversos discos digitais 3D (ver se\u00e7\u00e3o 3.2.3) do objeto tridimensional da figura anterior.\nA eros\u00e3o possui um operador dual^ chamado de dilata\u00e7\u00e3o. Para definir este operador, ser\u00e1 conveniente introduzir primeiramente o conceito de soma de Minkowski:\nA @ B = {w \u20ac E )\t\u20ac A e \u20ac B, com w \u2014 u + v}\t(3.19)\nA dilata\u00e7\u00e3o (invariante por transla\u00e7\u00e3o) de um conjunto A \u20ac P(E) por um elemento estruturante B \u20ac P(E) pode ent\u00e3o ser definida como o operador tal que:\n\u00bfs(A) = A\u00ae B\n(3.20)\nSe nos limitarmos aos elementos estruturantes sim\u00e9tricos [45], a dilata\u00e7\u00e3o pode ser vista como uma \u201ceros\u00e3o do fundo\u201d:\n(a)\n(b)\n(c)\nFigura 3.8: Eros\u00e3o por discos digitais 3D de raio r 5 segundo diversas m\u00e9tricas, (a) disco do quarteir\u00e3o (b) disco euclidiano (c) disco do m\u00e1ximo\nUma outra defini\u00e7\u00e3o equivalente em P(E), por\u00e9m mais \u00fatil para entender o efeito da dilata\u00e7\u00e3o, \u00e9 a seguinte:\n\u00bfb(4) = |J(B + u), Vu\u00a3A\t(3.22)\nisto \u00e9, a dilata\u00e7\u00e3o \u00e9 igual \u00e0 uni\u00e3o de todos as vers\u00f5es transladadas de B centradas em algum voxel de A.\nAssim como a eros\u00e3o, a dilata\u00e7\u00e3o tamb\u00e9m \u00e9 uma transforma\u00e7\u00e3o crescente (preserva a inclus\u00e3o):\nAi C A2 => \u00bfb(Ai) C \u00d3b(A2)\t(3.23)\nAl\u00e9m disso, se a origem estiver contida no elemento estruturante, o efeito produzido pela dilata\u00e7\u00e3o \u00e9 o de \u201cexpans\u00e3o\u201d do conjunto original, isto \u00e9,\n0 e B => A C \u00bfb(A)\t(3.24)\nEm outras palavras, a dilata\u00e7\u00e3o por um elemento estruturante que contenha a origem \u00e9 uma transforma\u00e7\u00e3o extensiva.\nUma outra propriedade, decorrente da defini\u00e7\u00e3o da dilata\u00e7\u00e3o em (3.22), \u00e9 a\nseguinte:\nNa fig. 3.9 vemos o efeito produzido por dilata\u00e7\u00f5es pelos v\u00e1rios discos digitais. As setas indicam posi\u00e7\u00f5es onde pode-se visualizar o disco que foi empregado em cada uma das dilata\u00e7\u00f5es, consequ\u00eancia de haver voxels isolados naquela posi\u00e7\u00e3o no objeto original da fig. 3.7.\nFigura 3.9: Dilata\u00e7\u00e3o por discos digitais 3D de raio r \u2014 5 segundo diversas m\u00e9tricas, (a) disco do quarteir\u00e3o (b) disco euclidiano (c) disco do m\u00e1ximo\nUma propriedade muito \u00fatil da eros\u00e3o e dilata\u00e7\u00e3o, que diz respeito \u00e0 composi\u00e7\u00e3o destes operadores, \u00e9 a separabilidade:\neBy\t\u20acBn = \u20acBi\n\u00bfBi &amp;B1 -^Bn =\n(3.27)\nA propriedade acima permite que eros\u00f5es ou dilata\u00e7\u00f5es por elementos estrutu-rantes muito grandes possam ser obtidas pela composi\u00e7\u00e3o de eros\u00f5es ou dilata\u00e7\u00f5es por uma s\u00e9rie de elementos estruturantes de menores dimens\u00f5es, apropriadamente escolhidos, o que \u00e9 bem mais eficiente do ponto de vista computacional [5]. Em particular, os discos digitais induzidos pelas m\u00e9tricas do quarteir\u00e3o e do m\u00e1ximo (ver se\u00e7\u00e3o 3.2.3) possuem decomposi\u00e7\u00f5es\nmuito convenientes:\nA\u00ed9(o, t) = Dd(o, 1) \u00a9 ... \u00a9\t(o, 1), r > 2\t(3.28)\nS\u2014----\u2014-----v-----------'\nT ~ 1 somas de Minkowski\nZ>l\u00edm(o,r) = Z>(im(o>l)ffi...\u00ae/?dm(o,l), r>2\t(3.29)\n...... '\nT - 1 somas de Minkowski os discos digitais D\u00bfq(o, 1) e D\u00bfm(o, 1) s\u00e3o elementos estruturantes primitivos, subconjuntos do cubo 3x3x3 centrado na origem, levando a implementa\u00e7\u00f5es bastante eficientes das eros\u00f5es e dilata\u00e7\u00f5es correspondentes. Observamos que o disco digital euclidiano infelizmente n\u00e3o disp\u00f5e, no dom\u00ednio digital, de uma decomposi\u00e7\u00e3o t\u00e3o simples quanto esta.\nNo caso da Morfologia n\u00edvel-de-cinza, podemos definir a eros\u00e3o e a dilata\u00e7\u00e3o de uma fun\u00e7\u00e3o f 6 EK por um elemento estruturante B \u20ac P(E) da seguinte forma:\n(/)(\u00ab) = max{/(v) I (B-fi u) A E} , Vu \u20ac E\t(3.30)\ncb(/)(u) = min{/(v) | v \u20ac (B + u) n E} , Vti \u20ac \u00a3\t(3.31)\nAs transforma\u00e7\u00f5es assim definidas s\u00e3o muitas vezes chamadas de eros\u00e3o e dilata\u00e7\u00e3o por um elemento estruturante planar, devido ao fato de B ser um conjunto e n\u00e3o uma fun\u00e7\u00e3o.\n3.3.2\tGradiente Morfol\u00f3gico\nUma transforma\u00e7\u00e3o derivada da eros\u00e3o e dilata\u00e7\u00e3o que nos ser\u00e1 \u00fatil \u00e9 o gradiente morfol\u00f3gico, que \u00e9 dado simplesmente pela subtra\u00e7\u00e3o entre a dilata\u00e7\u00e3o e a eros\u00e3o:\ntb = \u00bf3 A egc = \u00bf8 - (B\t(3.32)\nonde A denota a interse\u00e7\u00e3o entre operadores.\nOutras duas defini\u00e7\u00f5es utilizadas para o gradiente morfol\u00f3gico s\u00e3o:\n=\t(3.33)\nrB = I -\t(3.34)\n,em que I denota o operador identidade.\nEncontraremos ao longo deste trabalho diferentes aplica\u00e7\u00f5es para o operador gradiente, tais como segmenta\u00e7\u00e3o de imagens n\u00edvel-de-cinza e extra\u00e7\u00e3o de bordas.\n3.3.3\tAberturas e Fechamentos\n7fi =\t(3.35)\nUma defini\u00e7\u00e3o equivalente em PfE), por\u00e9m mais esclarecedora, \u00e9 a seguinte:\n7b(4) = U{(B+u)C4}\t(3.36)\nisto \u00e9, a abertura consiste da uni\u00e3o de todos as vers\u00f5es transladadas do elemento estrutu-rante que \u201cencaixam\u201d dentro da imagem.\nAssim como a eros\u00e3o (por um elemento estruturante contendo a origem), a abertura \u00e9 um operador crescente e anti-extensivo. Diferentemente da eros\u00e3o, a abertura \u00e9 um operador idempotente:\n~\u00cdB7B ~ 1B\t(3.37)\n0 operador dual da abertura chama-se fechamento:\n= [7B(AC)]C\t(3.38)\nou:\n4>b = &amp;BtB\t(3.39)\nIgualmente \u00e0 dilata\u00e7\u00e3o (por um elemento estruturante contendo a origem), o fechamento \u00e9 crescente e extensivo. Al\u00e9m disso, tamb\u00e9m \u00e9 idempotente:\n&amp;B&amp;B = d>B\t(3.40)\nDiversamente das eros\u00f5es e dilata\u00e7\u00f5es, nas abertura e nos fechamentos a posi\u00e7\u00e3o da origem em rela\u00e7\u00e3o ao elemento estruturante n\u00e3o desempenha nenhum papel, j\u00e1 que o \u201cefeito de transla\u00e7\u00e3o\u201d produzida pela eros\u00e3o (resp. dilata\u00e7\u00e3o) \u00e9 cancelado pela dilata\u00e7\u00e3o (resp. eros\u00e3o) subsequente.\nAs propriedades de crescimento e idempot\u00eancia fazem das aberturas e fechamentos parte de uma importante classe de transforma\u00e7\u00f5es, os filtros morfol\u00f3gicos [46].\nDe fato, a abertura pode ser vista como um processo de filtragem interna das bordas, quebrando pequenas liga\u00e7\u00f5es entre objetos e eliminando part\u00edculas de tamanho reduzido. Por dualidade, o fechamento possui o efeito contr\u00e1rio: introduz uma suav\u00edza\u00e7\u00e3o externa das bordas, ligando objetos pr\u00f3ximos e fechando pequenos buracos. Al\u00e9m disso, os efeitos das aberturas e fechamentos podem ser combinados atrav\u00e9s de composi\u00e7\u00f5es utilizando elementos estruturantes apropriados, dando origem aos filtros alternados sequenciais [49, 46].\n(a)\n(c)\nFigura 3.10: Abertura por discos digitais 3D de raio r = 5 segundo diversas m\u00e9tricas, (a) disco do quarteir\u00e3o (b) disco euclidiano (c) disco do m\u00e1ximo\nNas figs. 3.10 e 3.11 podemos ver algums dos efeitos mencionados acima, introduzidos por aberturas e fechamentos com os diversos discos digitais sobre o objeto tridi-mensional da fig. 3.7.\nNo caso das fun\u00e7\u00f5es, a abertura e o fechamento s\u00e3o definidos da mesma forma que nas eqs. (3.35) e (3.39). O efeito dessas transforma\u00e7\u00f5es nas imagens n\u00edvel-de-cinza \u00e9 tamb\u00e9m de filtragem, removendo pequenos detalhes claros nas aberturas ou escuros nos fechamentos [49, 22],\nFigura 3.11: Fechamento por discos digitais 3D de raio r ~ 5 segundo diversas m\u00e9tricas, (a) disco do quarteir\u00e3o (b) disco euclidiano (c) disco do m\u00e1ximo\n[29, 44]. Da mesma forma, temos fechamentos morfol\u00f3gicos e fechamentos alg\u00e9bricos. Teremos a oportunidade de encontrar uma classe de aberturas alg\u00e9bricas muito \u00fatil na pr\u00f3xima se\u00e7\u00e3o.\n3.3.4\tEros\u00f5es e Dilata\u00e7\u00f5es Geod\u00e9sicos e Reconstru\u00e7\u00e3o\nDefine-se a eros\u00e3o geod\u00e9sica ou condicional de um conjunto A por um elemento estruturante B, dado um conjunto C (A, 13,0 \u20ac P(jF)), como:\ncb,c(A) = c#(A) U 0\t(3.41)\nSua opera\u00e7\u00e3o dual, a dilata\u00e7\u00e3o geod\u00e9sica ou condicional, \u00e9 definida de forma an\u00e1loga por:\n= \u00d3b(A) n C\t(3.42)\nNotamos que a eros\u00e3o geod\u00e9sica est\u00e1 sempre \u201cenvolvendo\u201d o conjunto C\nC C\t(3.44)\no conjunto C \u00e9 portanto chamado frequentemente de m\u00e1scara da eros\u00e3o e dilata\u00e7\u00e3o geod\u00e9sicas.\nNo caso das imagens n\u00edvel-de-cinza, podemos definir analogamente os operadores acima. A eros\u00e3o geod\u00e9sica de uma fun\u00e7\u00e3o f \u20ac EK por um elemento estruturante B \u20ac P(E) dada uma fun\u00e7\u00e3o g G EK \u00e9 dada por:\n*\u00a3,//)(\u00ab) = max{\u20acB(/)(u),&lt;?(\u00ab)} , W e E\t(3.46)\nDa mesma forma, a dilata\u00e7\u00e3o geod\u00e9sica para fun\u00e7\u00f5es \u00e9 definida como:\ng(u)} , Vu \u20ac E\t(3.46)\nA mais comum aplica\u00e7\u00e3o das eros\u00f5es e dilata\u00e7\u00f5es geod\u00e9sicas \u00e9 o processo conhecido como reconstru\u00e7\u00e3o [46]. Consideremos o caso da dilata\u00e7\u00e3o: dado um conjunto A, n\u00e3o necessariamente conexo, e um conjunto M de marcadores ent\u00e3o a aplica\u00e7\u00e3o repetida da dilata\u00e7\u00e3o geod\u00e9sica\nPb,m(A) = 6b,a(\u00bfb,a(\u2018 \u2022 -(^b,a(M)) ...))\t(3.47)\nir\u00e1 fornecer como resultado os componentes conexos de A que intersectam algum marcador. Evidentemente que na pr\u00e1tica nao se faz uma composi\u00e7\u00e3o de infinitas dilata\u00e7\u00f5es geod\u00e9sicas; como lidamos com subconjuntos limitados, o processo converge ap\u00f3s um certo n\u00famero de repeti\u00e7\u00f5es, cessando de haver mudan\u00e7a ao se fazer uma nova dilata\u00e7\u00e3o. Na fig. 3.12 vemos um exemplo bidimensional de reconstru\u00e7\u00e3o. Note que os objetos bin\u00e1rios s\u00e3o representados neste trabalho pela cor preta sobre o fundo branco.\nUm resultado muito interessante [45] \u00e9 que o operador de reconstru\u00e7\u00e3o pb,m (para um conjunto de marcadores M fixo) constitui uma abertura alg\u00e9brica! Por isso mesmo esta transforma\u00e7\u00e3o tamb\u00e9m \u00e9 conhecida como abertura por reconstru\u00e7\u00e3o, ou ainda, abertura geod\u00e9sica, 0 conjunto de marcadores M pode ser obtido atrav\u00e9s de uma simples eros\u00e3o, ou pela aplica\u00e7\u00e3o de operadores como \u00faltima eros\u00e3o, bissetor condicional ou o m\u00e9todo dos\n\nI X J\nFigura 3.12: Exemplo de reconstru\u00e7\u00e3o: (a) Imagem original (b) Marcadores (c) Resultado m\u00e1ximos filtrados^ como veremos no cap\u00edtulo seguinte, ou mesmo podem ser impostos como um conjunto arbitr\u00e1rio, como no caso da fig. 3.12, onde foi utilizado um processo manual.\nNote que a abertura por reconstru\u00e7\u00e3o n\u00e3o introduz \u201cdeforma\u00e7\u00e3o\u201d no conjunto original. Diferentemente da abertura morfol\u00f3gica, a abertura por reconstru\u00e7\u00e3o representa apenas uma opera\u00e7\u00e3o de \u201climpeza\u201d, que remove alguns componentes conexos do conjunto original, deixando os restantes intactos. Este fato pode ser explorado na constru\u00e7\u00e3o de gra-nulometrias geod\u00e9sicas e de histogramas de gargantas, como veremos no cap\u00edtulo seguinte.\nUma outra importante diferen\u00e7a entre a abertura morfol\u00f3gica e a abertura por reconstru\u00e7\u00e3o \u00e9 que esta \u00faltima leva em conta a conectividade do conjunto original. Sendo assim, o resultado depende fortemente do elemento estruturante utilizado. Se este for muito grande, a dilata\u00e7\u00e3o geod\u00e9sica pode acabar \u201csaltando\u201d entre componentes n\u00e3o-conectados [17]. Al\u00e9m disso, o tipo de conectividade obtida depende do tipo de vizinhan\u00e7a expressa pelo elemento estruturante; por exemplo, no caso de se utilizar um cubo 3x3x3, obteremos componentes 26-conexos.\nEncerramos este cap\u00edtulo observando que \u00e9 poss\u00edvel definir de maneira an\u00e1loga uma transforma\u00e7\u00e3o de reconstru\u00e7\u00e3o baseada na eros\u00e3o geod\u00e9sica, isto \u00e9, um fechamento por reconstru\u00e7\u00e3o. O fechamento por reconstru\u00e7\u00e3o \u00e9 uma transforma\u00e7\u00e3o muito \u00fatil em v\u00e1rias aplica\u00e7\u00f5es, como por exemplo na mudan\u00e7a de homotopia associada \u00e0 segmenta\u00e7\u00e3o de imagens via watersheds, conforme veremos no cap\u00edtulo que se segue.\nCap\u00edtulo 4\nFerramentas da Morfologia Matem\u00e1tica para An\u00e1lise de Imagens\n4.1\tIntrodu\u00e7\u00e3o\nNeste cap\u00edtulo apresentaremos ferramentas da Morfologia Matem\u00e1tica para a an\u00e1lise de imagens. Estas ferramentas se baseiam principalmente nas transforma\u00e7\u00f5es b\u00e1sicas apresentadas no cap\u00edtulo anterior. As ferramentas apresentadas ser\u00e3o aplicadas no cap\u00edtulo seguinte em um estudo de caracteriza\u00e7\u00e3o de meio poroso.\nA primeira ferramenta apresentada \u00e9 a transforma\u00e7\u00e3o de watersheds. Tratase de uma poderosa ferramenta de segmenta\u00e7\u00e3o. Ilustraremos a aplica\u00e7\u00e3o dos watersheds na segmenta\u00e7\u00e3o de uma imagem n\u00edvel-de-cinza, um p\u00e9 humano obtido por resson\u00e2ncia magn\u00e9tica, e ent\u00e3o passaremos ao problema da segmenta\u00e7\u00e3o bin\u00e1ria de objetos superpostos, que \u00e9 o caso que mais nos ser\u00e1 \u00fatil.\nEm seguida apresentamos as granulometrias, uma ferramenta poderosa para descri\u00e7\u00e3o de tamanho e forma. Ilustraremos a utilidade das distribui\u00e7\u00f5es granulom\u00e9tricas, em particular do espectro de padr\u00f5es, para uma se\u00e7\u00e3o do modelo tridimensional estudado no cap\u00edtulo 5. Introduzimos tamb\u00e9m uma classe de granulometrias baseadas no conceito de reconstru\u00e7\u00e3o, que chamamos de granulometrias geod\u00e9sicas. Utilizando o resultado da segmenta\u00e7\u00e3o bin\u00e1ria via watersheds, estabelecemos uma compara\u00e7\u00e3o entre a granulometria morfol\u00f3gica tradicional e a granulometria geod\u00e9sica proposta. Procuramos desenvolver no\nPropomos tamb\u00e9m uma ferramenta para obten\u00e7\u00e3o do histograma de gargantas de uma imagem, baseada apenas nas transforma\u00e7\u00f5es b\u00e1sicas da Morfologia Matem\u00e1tica. Ilustramos a aplica\u00e7\u00e3o desta ferramenta em uma imagem de uma placa de circuito impresso.\nGostar\u00edamos de ressaltar que todas estas ferramentas s\u00e3o desenvolvidas para o caso tridimensional, sendo aplicadas ao problema de caracteriza\u00e7\u00e3o de meio poroso 3D, como veremos no cap\u00edtulo 5. Entretanto, para facilitar a visualiza\u00e7\u00e3o e compreens\u00e3o de muitos dos conceitos que s\u00e3o apresentados, ilustramos neste cap\u00edtulo a aplica\u00e7\u00e3o das ferramentas para imagens bidimensionais, deixando os resultados obtidos no caso tridimensional para o cap\u00edtulo seguinte.\n4.2\tWatersheds\nA transforma\u00e7\u00e3o de watersheds \u00e9 uma poderosa ferramenta de segmenta\u00e7\u00e3o oferecida pela Morfologia Matem\u00e1tica [8]. Como veremos, esta transforma\u00e7\u00e3o pode ser utilizada tanto para o caso usual da segmenta\u00e7\u00e3o de imagens n\u00edvel-de-cinza, como tamb\u00e9m para o problema da separa\u00e7\u00e3o de objetos superpostos, que \u00e9 o caso que mais nos interessar\u00e1, pois ser\u00e1 \u00fatil na constru\u00e7\u00e3o de granulometrias geod\u00e9sicas (se\u00e7\u00e3o 4.3.3).\nPara compreender o conceito dos watersheds, pensemos em uma imagem n\u00edvel-de-cinza bidimensional. Esta pode ser interpretada como um relevo, onde as \u00e1reas claras correspondem \u00e0s eleva\u00e7\u00f5es do terreno e as \u00e1reas escuras, \u00e0s depress\u00f5es. Na fig, 4.1 vemos uma imagem sint\u00e9tica, a soma de distribui\u00e7\u00f5es Gaussianas invertidas, e seu modelo de relevo, ou modelo topogr\u00e1fico, associado.\nConsideremos agora que uma gota d\u2019\u00e1gua \u00e9 abandonada em um ponto qualquer do relevo. Esta tender\u00e1, pela a\u00e7\u00e3o da gravidade, a escorrer at\u00e9 um ponto de m\u00ednimo regional. Define-se ent\u00e3o o watershed (\u201cbacia d\u2019\u00e1guas\u201d) W(M) de um m\u00ednimo M como o conjunto de todos os pontos do relevo, i.e. pixels da imagem bidimensional, onde a gota d\u2019\u00e1gua escorreria para M [46]. De maneira equivalente, podemos imaginar uma inunda\u00e7\u00e3o em que a \u00e1gua surge primeiro nos m\u00ednimos regionais e vai subindo. Nos pontos em que a \u00e1gua de duas\nFigura 4.1: Imagem sint\u00e9tica vista segundo (a) representa\u00e7\u00e3o usual e (b) modelo topogr\u00e1fico\nFigura 4.2: LDA superposta \u00e0 imagem original: (a) representa\u00e7\u00e3o usual e (b) modelo topogr\u00e1fico\nNo caso tridimensional o modelo topogr\u00e1fico deve ser substitu\u00eddo, por exemplo, por um campo el\u00e9trico, onde seriam abandonadas cargas negativas, que tenderiam a ir em dire\u00e7\u00e3o aos m\u00ednimos regionais, as cargas positivas. A id\u00e9ia dos watersheds pode ent\u00e3o ser estendida facilmente: as bacias passam a ser volumes, enquanto que n\u00e3o temos mais uma linha, e sim uma superf\u00edcie divisora, formada pela uni\u00e3o das fronteiras fechadas dos volumes.\nVale ressaltar que, a despeito da descri\u00e7\u00e3o intuitiva dada acima, a transforma\u00e7\u00e3o de watersheds pode ser definida totalmente em termos de transforma\u00e7\u00f5es mais b\u00e1sicas da Morfologia Matem\u00e1tica [46]. Ainda assim, os algoritmos mais eficientes s\u00e3o aqueles que se\nbaseiam justamente na id\u00e9ia da inunda\u00e7\u00e3o [48].\n4.2.1\tWatersheds e a Segmenta\u00e7\u00e3o de imagens n\u00edvel-de-cinza\nO problema de segmenta\u00e7\u00e3o consiste em extrair as diferentes regi\u00f5es presentes em uma imagem e obter contornos que as envolvam o mais perfeitamente poss\u00edvel.\nA transi\u00e7\u00e3o de uma regi\u00e3o \u00e3 outra em uma imagem \u00e9 caracterizada pela mudan\u00e7a abrupta de n\u00edvel de cinza. 0 operador gradiente definido na se\u00e7\u00e3o 3.3.2 possui a propriedade de detectar estas varia\u00e7\u00f5es. Ao o aplicarmos obtemos uma nova imagem n\u00edvel-de-cinza, onde as eleva\u00e7\u00f5es (segundo o modelo topogr\u00e1fico ou do campo el\u00e9trico) correspondem \u00e0s regi\u00f5es de transi\u00e7\u00e3o enquanto que as depress\u00f5es indicam regi\u00f5es homog\u00eaneas. Portanto, determinar os watersheds do gradiente resolve, em tese, o problema da segmenta\u00e7\u00e3o.\nInfelizmente, a vida n\u00e3o \u00e9 t\u00e3o simples assim. Em imagens obtidas do mundo real sempre h\u00e1 uma consider\u00e1vel quantidade de ru\u00eddo presente, o que introduz um grande n\u00famero de bacias esp\u00farias na determina\u00e7\u00e3o dos watersheds, em um efeito conhecido como super-segmenta\u00e7\u00e3o. Na fig, 4.3 vemos um exemplo de super-segmenta\u00e7\u00e3o em uma se\u00e7\u00e3o de um p\u00e9 humano, obtida por resson\u00e2ncia magn\u00e9tica. Vale ressaltar que o gradiente foi obtido ap\u00f3s uma filtragem da imagem original, o que melhora um pouco o resultado.\nUma solu\u00e7\u00e3o para resolver o problema de super-segmenta\u00e7\u00e3o \u00e9 se tentar remover os contornos irrelevantes atrav\u00e9s de um processo de crescimento de regi\u00f5es. Uma abordagem morfol\u00f3gica para este processo utilizando grafos planares \u00e9 apresentada em [52].\nN\u00e3o adotaremos o processo de crescimento de regi\u00f5es. Empregaremos uma metodologia mais universal, que utiliza a id\u00e9ia dos marcadores (ver se\u00e7\u00e3o 3.3.4 do cap\u00edtulo anterior). Os marcadores no caso da segmenta\u00e7\u00e3o representam um conhecimento adicional que se possui sobre a imagem, podendo ser obtidos de maneira autom\u00e1tica ou manual.\nUma vez de posse dos marcadores, em vez de tentar eliminar os falsos contornos ap\u00f3s a determina\u00e7\u00e3o dos watersheds, efetua-se um pr\u00e9-processamento do gradiente, em um processo conhecido como modifica\u00e7\u00e3o de homotopia. e s\u00f3 ent\u00e3o s\u00e3o computados os watersheds.\nA modifica\u00e7\u00e3o de homotopia se d\u00e1 em duas etapas:\n\u2014\tImposi\u00e7\u00e3o dos marcadores como m\u00ednimos regionais do gradiente.\n-\tSupress\u00e3o dos m\u00ednimos indesej\u00e1veis atrav\u00e9s de um fechamento por reconstru\u00e7\u00e3o n\u00edvel-de-cinza do gradiente utilizando como \u201cfun\u00e7\u00e3o marcadora\u201d o inverso dos marcadores originais.\nUma descri\u00e7\u00e3o mais detalhada da modifica\u00e7\u00e3o de homotopia pode ser encontrada em [23, 46].\nComo a cada bacia corresponde um m\u00ednimo regional na determina\u00e7\u00e3o dos wa-tersheds, \u00e9 preciso fornecer um marcador para cada regi\u00e3o a ser segmentada, inclusive o fundo da imagem. Na fig. 4.4 apresentamos os marcadores que utilizamos na segmenta\u00e7\u00e3o de uma das regi\u00f5es da fig. 4.3-a. Esses marcadores foram obtidos de forma autom\u00e1tica. 0 marcador externo foi obtido atrav\u00e9s de um processo de limiariza\u00e7\u00e3o seguido de filtragem, dilata\u00e7\u00e3o e extra\u00e7\u00e3o de borda. 0 marcador interno foi obtido de maneira similar, substituindo-se a dilata\u00e7\u00e3o por uma eros\u00e3o, sem extra\u00e7\u00e3o de borda.\nFigura 4.4: Marcadores utilizados na segmenta\u00e7\u00e3o da imagem do p\u00e9\nNa fig. 4.5 \u00e9 apresentado o resultado ap\u00f3s a determina\u00e7\u00e3o dos watersheds, onde vemos a LDA superposta \u00e0 imagem original.\n0 processo conjunto de modifica\u00e7\u00e3o de homotopia seguido da determina\u00e7\u00e3o dos watersheds \u00e9 tamb\u00e9m conhecido na literatura como watershed geod\u00e9sico [46]\nFigura 4.5: Resultado da segmenta\u00e7\u00e3o por watersheds da imagem do p\u00e9\n4.2.2\tSepara\u00e7\u00e3o de objetos superpostos via Watersheds\nVamos considerar agora o problema da segmenta\u00e7\u00e3o bin\u00e1ria, isto \u00e9, da separa\u00e7\u00e3o de objetos superpostos em uma imagem bin\u00e1ria. Este problema \u00e9 muito comum em diversas \u00e1reas de aplica\u00e7\u00e3o, tais como geologia, metalurgia, agricultura, sensoreamento remoto e outras. 0 problema da segmenta\u00e7\u00e3o bin\u00e1ria \u00e9 tamb\u00e9m frequentemente denominado de \u201cdecoalesc\u00eancia\u201d dos objetos de uma imagem.\nConsideremos por exemplo a imagem da fig. 4.6, que corresponde a uma se\u00e7\u00e3o do objeto tridimensional da fig. 3.7 no cap\u00edtulo anterior (Os resultados obtidos com o objeto tridimensional propriamente dito ser\u00e3o apresentados no cap\u00edtulo seguinte). Esta \u00e9 tipicamente uma imagem granular, isto \u00e9, constitu\u00edda de diversos componentes (gr\u00e3os). E ilustrativo comparar esta imagem, que \u00e9 uma imagem real, com a imagem sint\u00e9tica da fig. 3.12-a no cap\u00edtulo anterior. Note como em uma imagem real os gr\u00e3os tendem a se confundir uns como os outros, trazendo \u00e0 tona o problema da segmenta\u00e7\u00e3o bin\u00e1ria.\nMostraremos que os watersheds fornecem uma solu\u00e7\u00e3o para o problema de segmenta\u00e7\u00e3o bin\u00e1ria. Mas para a determina\u00e7\u00e3o dos watersheds, necessita-se de uma imagem n\u00edvel-de-cinza, com seu modelo topogr\u00e1fico associado. Necessitamos portanto de um mapeamento P(E) -+ EK, isto \u00e9, que transforme uma imagem bin\u00e1ria em uma imagem n\u00edvel-de-cinza. 0 mapeamento que nos ser\u00e1 \u00fatil \u00e9 conhecido como fun\u00e7\u00e3o dist\u00e2ncia [9, 36]. Esta\nFigura 4.6: Imagem binaria a ser segmentada transforma\u00e7\u00e3o associa a cada voxel do objeto a distancia ao voxel mais pr\u00f3ximo do fundo, isto \u00e9, dado um objeto A \u20ac P(E) temos:\n. I d(u,Ac} se u \u20ac A\tz\nfd(A)(u) = \u00bf\t'\tf , Vu e s\t(4.1)\n1\t0 caso contrario\nEvidentemente, para cada m\u00e9trica d considerada (ver se\u00e7\u00e3o 3.2.3) correponde uma fun\u00e7\u00e3o distancia distinta. Na fig. 4.7, vemos a fun\u00e7\u00e3o distancia associada \u00e0 imagem da fig. 4.6 segundo a m\u00e9trica euclidiana.\nAs fun\u00e7\u00f5es distancia associadas \u00e0s m\u00e9tricas do quarteir\u00e3o e do m\u00e1ximo produzem resultados similares, mas em geral a fun\u00e7\u00e3o euclidiana \u00e9 a que leva a melhores resultados.\nSe tomarmos agora a fun\u00e7\u00e3o complementar f\u00bf \u00e0 fun\u00e7\u00e3o distancia (ver se\u00e7\u00e3o 3.3), teremos um modelo topogr\u00e1fico associado apropriado para o problema da segmenta\u00e7\u00e3o bin\u00e1ria da imagem original via waterheds: os m\u00ednimos regionais corresponder\u00e3o aproximadamente aos centros dos gr\u00e3os, enquanto que as cristas entre as bacias s\u00e3o as fronteiras que procuramos (ver \u00fcg. 4.8). Fazendo a subtra\u00e7\u00e3o dessas fronteiras, isto \u00e9, a LDA, em rela\u00e7\u00e3o \u00e0 imagem original, conseguimos \u201cquebrar\u201d as liga\u00e7\u00f5es entre os gr\u00e3os adjacentes.\nInfelizmente, as pequenas irregularidades presentes nos contornos de imagens\nFigura 4.7: Fun\u00e7\u00e3o dist\u00e2ncia associada ao objeto da fig. anterior segundo a m\u00e9trica euclidiana\nFigura 4.8: Modelo topogr\u00e1fico associado ao complemento da fun\u00e7\u00e3o dist\u00e2ncia euclidiana\nFigura 4.9: Super-segmenta\u00e7\u00e3o obtida com a determina\u00e7\u00e3o direta dos watersheds utilizando a fun\u00e7\u00e3o dist\u00e2ncia euclidiana\nUma poss\u00edvel solu\u00e7\u00e3o para este problema \u00e9 fazer uma filtragem pr\u00e9via da fun\u00e7\u00e3o dist\u00e2ncia, utilizando por exemplo uma abertura por reconstru\u00e7\u00e3o, como em [23]. Infelizmente, este m\u00e9todo n\u00e3o surtiu efeito para a imagem da fig. 4.6, persistindo o problema da super-segmenta\u00e7\u00e3o.\n0 m\u00e9todo que adotamos \u00e9 a modifica\u00e7\u00e3o de homotopia da fun\u00e7\u00e3o dist\u00e2ncia, utilizando o mesmo procedimento discutido na se\u00e7\u00e3o anterior. Isto nos traz o problema da obten\u00e7\u00e3o dos marcadores. Para isto, foram examinadas as seguintes possibilidades:\n\u2122 Utiliza\u00e7\u00e3o do bissetor condicional de ordem 10\n-\tUtiliza\u00e7\u00e3o da \u00faltima eros\u00e3o\n-\tM\u00e1ximos regionais da fun\u00e7\u00e3o dist\u00e2ncia filtrada\n-\tSele\u00e7\u00e3o manual\nCL =\n0 bissetor condicional pode ser entendido com a analogia do \u201cincendio no gramado\u201d: se pensarmos no objeto como um gramado em que \u00e9 ateado fogo simultaneamente ao longo de toda a sua borda, o conjunto de pontos que \u00e9 atingido ao mesmo tempo pelo fogo origin\u00e1rio de diferentes pontos na borda \u00e9 conhecido como eixo m\u00e9dio do objeto. 0 bissetor condicional de ordem a \u00e9 o subconjunto do eixo m\u00e9dio onde a \u201cvelocidade\u201d do fogo entre um ponto e o outro \u00e9 maior que a. Defini\u00e7\u00f5es mais formais da \u00faltima eros\u00e3o e do bissetor condicional podem ser encontradas em [44],\nJ\u00e1 a terceira op\u00e7\u00e3o, \u00e0 qual nos referiremos por brevidade como \u201cm\u00e1ximos filtrados\u201d, \u00e9 bastante interessante e representa um melhoramento em rela\u00e7\u00e3o \u00e0 \u00faltima eros\u00e3o [53]. Como foi mencionado acima, esta corresponde aos m\u00e1ximos regionais da fun\u00e7\u00e3o dist\u00e2ncia, mas devido a irregularidades no contorno dos objetos, um mesmo gr\u00e3o pode dar origem a dois ou mais m\u00e1ximos, e o que \u00e9 pior, arbitrariamente distantes uns dos outros. Para evitar isto, \u00e9 feita uma filtragem pr\u00e9via na fun\u00e7\u00e3o dist\u00e2ncia que consiste em uma abertura por reconstru\u00e7\u00e3o da mesma utilizando como marcador a fun\u00e7\u00e3o f\u00bf - 1, o que remove os m\u00e1ximos \u201cesp\u00farios\u201d, seguida da determina\u00e7\u00e3o dos m\u00e1ximos regionais, como podemos ver ilustrado em um perfil unidimensional na fig. 4.10.\nFigura 4.10: Perfil unidimensional da fun\u00e7\u00e3o dist\u00e2ncia mostrando os m\u00e1ximos esp\u00farios que s\u00e3o removidos pela abertura por reconstru\u00e7\u00e3o e os m\u00e1ximos filtrados que resultam\nNa fig. 4.11 podemos ver, superpostos ao conjunto original, os marcadores obtidos por cada urna das alternativas descritas acima. Ressaltamos ainda que, com excess\u00e3o dos m\u00e1ximos filtrados, uma pequena dilata\u00e7\u00e3o foi introduzida sobre os maracadores, o que melhora um pouco o resultado da segmenta\u00e7\u00e3o. Note que n\u00e3o \u00e9 necess\u00e1rio fornecer um marcador para o fundo, pois n\u00e3o se est\u00e1 procurando o contorno entre os gr\u00e3os e o mesmo, mas apenas a quebra da liga\u00e7\u00e3o entre os gr\u00e3os adjacentes ap\u00f3s a subtra\u00e7\u00e3o da LDA.\nUtilizando o complemento da fun\u00e7\u00e3o distancia euclidiana, a qual como ja mencionamos representa o melhor caso, podemos ver na fig. 4.12 os resultados obtidos ap\u00f3s a determina\u00e7\u00e3o dos watersheds.\nComo vemos, o melhor resultado foi o conseguido com a sele\u00e7\u00e3o manual dos marcadores. Os m\u00e1ximos filtrados produziram um resultado pr\u00f3ximo, mas podemos perceber neste caso que alguns gr\u00e3os de dimens\u00f5es reduzidas n\u00e3o foram segmentados, devido \u00e0 aus\u00eancia de marcadores para os mesmos.\nNa verdade, o problema da escolha entre t\u00e9cnicas semi-autom\u00e1ticas e t\u00e9cnicas autom\u00e1ticas \u00e9 uma quest\u00e3o recorrente nas aplica\u00e7\u00f5es de an\u00e1lise de imagens, especialmente nos problemas de segmenta\u00e7\u00e3o. De maneira geral, poder\u00edamos dizer que os procedimentos semi-autom\u00e1ticos, como o exemplo do watershed geod\u00e9sico com marcadores manuais acima, possuem a grande vantagem de serem capazes de tirar proveito do conhecimento que o operador possui sobre a imagem. Os procedimentos autom\u00e1ticos nem sempre d\u00e3o bons resultados e alguns deles s\u00e3o tamb\u00e9m muito dependentes da aplica\u00e7\u00e3o, exigindo ajustes para cada caso (por exemplo, no caso do problema de segmenta\u00e7\u00e3o bin\u00e1ria apresentado, a escolha da ordem do bis setor condicional a ser utilizada). Mas como veremos no cap\u00edtulo 5, um procedimento autom\u00e1tico, no caso o m\u00e9todo dos m\u00e1ximos filtrados, pode se sair melhor quando a interven\u00e7\u00e3o manual \u00e9 dif\u00edcil ou complicada, como \u00e9 o caso de imagens tridimensionais (ou, pior ainda, de dimensi\u00f3n alidades maiores). Os procedimentos autom\u00e1ticos tamb\u00e9m t\u00eam uma import\u00e2ncia grande em aplica\u00e7\u00f5es industriais, que envolvem processos em s\u00e9rie.\n4.3\tGranulometria\nAs granulometrias, conceito introduzido por G. Matheron [29], constituem uma das mais poderosas ferramentas oferecidas pela Morfologia Matem\u00e1tica para a descri\u00e7\u00e3o de\nFigura 4.11: Marcadores obtidos atrav\u00e9s de (a) Bissetor condicional de ordem 10 (b) \u00daltima eros\u00e3o (c) M\u00e1ximos filtrados (d) Sele\u00e7\u00e3o manual\nFigura 4.12: Segmenta\u00e7\u00e3o via watersheds utilizando os marcadores da figura anterior: (a) Bissetor condicional de ordem 10 (b) \u00daltima eros\u00e3o (c) M\u00e1ximos fitrados (d) Sele\u00e7\u00e3o manual\ntamanho e forma em an\u00e1lise de imagens.\nA id\u00e9ia do m\u00e9todo \u00e9 realizar uma criva\u00e7\u00e3o (peneira\u00e7\u00e3o) dos objetos de uma imagem, seguida por uma medi\u00e7\u00e3o quantitativa do res\u00edduo, a fra\u00e7\u00e3o de objetos que n\u00e3o atravessam a peneira. Vari ando-se o tamanho e forma dos \u201cfuros\u201d da peneira e fazendo-se medidas consecutivas do res\u00edduo deixado por cada criva\u00e7\u00e3o, obt\u00e9m-se uma curva chamada por Matheron de distribui\u00e7\u00e3o granulom\u00e9trica de tamanho, a partir da qual \u00e9 poss\u00edvel obter um histograma de tamanho, o espectro de padr\u00f5es [28]. A combina\u00e7\u00e3o de transforma\u00e7\u00e3o seguida de medida representa o paradigma fundamental dos m\u00e9todos de quantifica\u00e7\u00e3o em Morfologia Matem\u00e1tica [44].\nA medida a ser utilizada pode ser por exemplo a \u00e1rea ou o volume do res\u00edduo, no caso respectivamente de imagens bidimensionais e tridimensionais. J\u00e1 a transforma\u00e7\u00e3o a ser empregada deve constituir um crit\u00e9rio de tamanho, obedecendo aos axiomas de Matheron, como veremos na se\u00e7\u00e3o seguinte.\n4.3.1\tAs Distribui\u00e7\u00f5es Granulom\u00e9tricas de Tamanho\nUma fam\u00edlia de transforma\u00e7\u00f5es\tparametrizadas por um par\u00e2metro A > 0\n(com ^o(A) = A) \u00e9 chamada de uma granulometria se constituir um crit\u00e9rio de tamanho, isto \u00e9, obedecer aos axiomas de tamanho de Matheron [44].\nOs dois primeiros axiomas expressam propriedades j\u00e1 mencionadas no cap\u00edtulo anterior (ver se\u00e7\u00e3o 3.3):\nI)\tV\u2019a(A) C A\t(anti-extensividade)\t(4.2)\nII)\tAcC => ^a(A) C ^a(C) (crescimento)\t(4.3)\npara todo A e C do reticulado de interesse.\nOs dois axiomas acima dizem respeito a cada transforma\u00e7\u00e3o individualmente. 0 terceiro e mais sutil axioma, que se refere \u00e0 fam\u00edlia como um todo, \u00e9 a propriedade conhecida como \u201ccomando do crivo mais forte\u201d:\nIII)\n= WV\u2019aM)] =\t. VA,n > 0\n(4-4)\nEsta \u00faltima propriedade requer que duas crivagens em sequ\u00eancia seja equivalente a uma s\u00f3 com a peneira \u201cmais grossa\u201d. Note que fazendo \u00c0 = p, reca\u00edmos no conceito familiar de idempot\u00eancia (se\u00e7\u00e3o 3.3). \u00c9 f\u00e1cil perceber que qualquer classifica\u00e7\u00e3o de tamanho, mesmo as utilizadas cotidianamente, devem obedecer aos tr\u00eas axiomas de Matheron para que fa\u00e7a sentido. Um resultado fundamental, devido a Matheron, \u00e9 que toda fam\u00edlia de transforma\u00e7\u00f5es que obede\u00e7a aos axiomas de tamanho \u00e9 constitu\u00edda necessariamente de aberturas alg\u00e9bricas [29].\nPara nossos prop\u00f3sitos, vamos considerar inicialmente as aberturas morfol\u00f3gicas 7sr, onde os elementos estrurantes BT s\u00e3o os discos digitais de raio r (ver se\u00e7\u00e3o 3.2.3).\nPartindo das decomposi\u00e7\u00f5es (3.28) e (3.29) apresentadas no cap\u00edtulo anterior, \u00e9 poss\u00edvel mostrar que os discos digitais produzidos pelas m\u00e9tricas do quarteir\u00e3o e do m\u00e1ximo formam sequ\u00eancias de abertos, significando que:\n7Br(Bs) = Bs, para s > r > 0\t(4.5)\nem vista da defini\u00e7\u00e3o de abertura na eq. (3.36) do cap\u00edtulo anterior, isto \u00e9 equivalente a afirmar que:\nB. = U\u00ed(5r + u)cB.}\t(4.6)\ne portanto\n7B.(\u00bf) \u00a3 7b.(A)\t(4.7)\npara todo A 6 P(\u00a3).\nAgora, pode ser mostrado [5, p\u00e1ginas 103-104] que se 7a e s\u00e3o aberturas, ent\u00e3o para todo A \u20ac P(E),\n7s(A) \u00c7 7r(A) O 7s[7r(A)] = 75(A) e 7rbX\u00bf)] = 7s(-\u00bf)\t(4-8)\nDas eqs. (4.7) e (4.8) acima conclu\u00edmos que a propriedade do comando do crivo mais forte \u00e9 satisfeita. Como os dois primeiros axiomas s\u00e3o automaticamente satisfeitos por aberturas, a fam\u00edlia {vr = 75,}, r > 0 utilizando os dicos digitais do quarteir\u00e3o e do m\u00e1ximo constitui de fato uma granul\u00f3me!ria. O caso do disco digital euclidiano \u00e9 mais complicado, devido ao truncamento digital que \u00e9 introduzido na m\u00e9trica euclidiana, invalidando a propriedade expressa em (4.5) (No caso cont\u00ednuo a prova seria a mesma\nSeja ent\u00e3o A 6 P(E) o objeto de interesse e V(r) o n\u00famero de voxels em 7#r(A), para r > 0 (Como Bq = o, um \u00fanico voxel na origem, temos que V(0)\u00e9o n\u00famero de voxels em A). Note que pela eq. (4.7), V(r) \u00e9 uma fun\u00e7\u00e3o mon\u00f3tona decrescente. Al\u00e9m disso, como A \u00e9 um conjunto finito, V(r) = 0 para algum r > R. A fun\u00e7\u00e3o : Z+ \u2014\u00bb\u25a0 R definida por :\n\u00edW = i-^, T > 0\t(4.9)\n\u00e9 portanto mon\u00f3tona crescente no intervalo [0,1]. Considerando uma imagem bin\u00e1ria como a realiza\u00e7\u00e3o de um random set [29], \u00e9 poss\u00edvel mostrar que $(r) \u00e9 uma fun\u00e7\u00e3o cumulativa de probabilidade. Sua fun\u00e7\u00e3o densidade de probabilidade associada \u00e9 dada pela seguinte derivada discreta:\nT(r) = \u00ed(r + 1) - $(r), r > 0\t(4.10)\nDevido \u00e0s propriedades de #(r) mencionadas acima, a fun\u00e7\u00e3o T(r) \u00e9 n\u00e3o-negativa e se anula para r suficientemente grande. Tanto &amp;(r) quanto T(r) foram chamadas por Matheron de distribui\u00e7\u00f5es granulom\u00e9tricas de tamanho. Estaremos mais interessados neste trabalho na fun\u00e7\u00e3o E(r), tamb\u00e9m chamada de espectro de padr\u00f5es, a qual pode ser interpretada, conforme veremos a seguir, como um histograma de tamanho, onde para um determinado valor de r l\u00ea-se na curva a quantidade percentual de part\u00edculas, ponderada pela \u00e1rea (ou volume, no caso 3D), cujo raio \u00e9 maior que r e menor que r + 1 (Na se\u00e7\u00e3o seguinte discutiremos detalhadamente o espectro de padr\u00f5es).\nConsideremos por exemplo a imagem bidimensional da fig. 4.13. Trata-se de u-ma imagem granular sint\u00e9tica onde diversos tipos de \u201cpart\u00edculas\u201d est\u00e3o presentes, entretanto pode-se dividi-las em tr\u00eas classes segundo o tamanho. Na fig. 4.14 temos as distribui\u00e7\u00f5es 4>(r) e T(r) obtidas utilizando-se o disco euclidiano. Note que T(r) d\u00e1 a informa\u00e7\u00e3o de quantas e quais s\u00e3o as classes de tamanho presentes. No caso, temos tr\u00eas classes correspondendo aos raios de 5, 10 e 20, sendo que o raio m\u00e9dio encontrado foi de 12,699.\nEste resultado tamb\u00e9m ilustra uma caracter\u00edstica importante das distribui\u00e7\u00f5es\nFigura 4.13: Imagem sint\u00e9tica a ser submetida a an\u00e1lise granulom\u00e9trica\nFigura 4.14: Curvas granulom\u00e9tncas associadas \u00e0 imagem da figura anterior: (a) $(r) e (b) r(r)\nEncerramos esta se\u00e7\u00e3o observando que P. Maragos prop\u00f4s uma extens\u00e3o para valores negativos de r das distribui\u00e7\u00f5es de tamanho discutidas acima [28]. Neste caso, as aberturas sao substituidas por fechamentos. Por dualidade, vemos que isto corresponde a se fazer a an\u00e1lise granulom\u00e9trica do fundo do objeto. Neste trabalho, em vez de adotar o lado negativo das distribui\u00e7\u00f5es, faremos quando necess\u00e1rio a an\u00e1lise granulom\u00e9trica do fundo do objeto diretamente, utilizando somente as aberturas.\n4,3.2\tO Espectro de Padr\u00f5es\nVariando-se n\u00e3o s\u00f3 o raio, mas tamb\u00e9m o pr\u00f3prio elemento estruturante, diferentes distribui\u00e7\u00f5es de tamanho s\u00e3o obtidas. Intu\u00edmos assim que as distribui\u00e7\u00f5es discutidas na se\u00e7\u00e3o anterior cont\u00e9m informa\u00e7\u00e3o n\u00e3o apenas de tamanho, mas tamb\u00e9m de forma.\nTendo isto em vista, P. Maragos sugeriu o termo espectro de padr\u00f5es [28] para designar a distribui\u00e7\u00e3o F(r), deixando claro que se trata de uma distribui\u00e7\u00e3o de tamanho e forma. Al\u00e9m disso, o termo espectro vem de uma analogia muito interessante com o processamento linear de sinais. \u00c9 bem sabido que a Transformada de Fourier de um sinal \u00e9 obtida transformando-o por uma multiplica\u00e7\u00e3o com a exponencial complexa\te em seguida\nmedindo a \u00e1rea, isto \u00e9, integrando o resultado da modula\u00e7\u00e3o. Variando-se a frequ\u00eancia u1, obt\u00e9m-se o espectro de frequ\u00eancia, que indica a composi\u00e7\u00e3o do sinal em termo das v\u00e1rias frequ\u00eancias (0 espectro de frequ\u00eancia da pr\u00f3pria exponencial complexa \u00e9 um impulso centrado em w). Apesar da Transformada de Fourier ser \u00fatil tamb\u00e9m ao processamento de imagens, ela n\u00e3o pode exprimir de maneira conveniente os conceitos de tamanho e forma (ver discuss\u00e3o na introdu\u00e7\u00e3o do cap\u00edtulo 3). 0 espectro de padr\u00f5es, por outro lado, exprime justamente a composi\u00e7\u00e3o de um objeto em termos do elemento estruturante utilizado e do tamanho do mesmo. A analogia fica clara se considerarmos por exemplo o espectro de padr\u00f5es de uma esfera de raio R utilizando o disco euclidiano como elemento estruturante: 0 resultado ser\u00e1 um impulso centrado em r = R, Na fig. 4.15 vemos os espectros de padr\u00f5es correspondentes a alguns objetos bidimensionais, utilizando o disco euclidiano.\nFigura 4.15: Espectros de padr\u00f5es associados a alguns objetos bidimensionais\nComo a maioria dos conceitos em Morfologia Matem\u00e1tica, o espectro de padr\u00f5es \u00e9 irrevers\u00edvel, isto \u00e9, ao contr\u00e1rio do processamento linear, n\u00e3o \u00e9 poss\u00edvel recuperar um objeto dado o seu espectro. Apesar disso, o espectro de padr\u00f5es \u00e9 muito \u00fatil na caracteriza\u00e7\u00e3o dos objetos. Como pode ser visto na fig. 4.15, irregularidades na borda do objeto resultam em componentes de baixa amplitude pr\u00f3ximo a r \u2014 0. Al\u00e9m disso, a presen\u00e7a de protuber\u00e2ncias formadas por discos de raio P se manifestam como impulsos em torno de T = P. J\u00e1 o valor r(l?) (lembrando que R \u00e9 o raio para al\u00e9m do qual P(r) se anula) indica o conte\u00fado de forma do objeto em rela\u00e7\u00e3o ao elemento estruturante. Pode ser mostrado [28] que o conte\u00fado de forma \u00e9 m\u00e1ximo para o elemento estruturante que mais se aproxima da forma \u201cglobal\u201d do objeto (Por exemplo, se o objeto for aproximadamente triangular, o conte\u00fado de forma ser\u00e1 m\u00e1ximo para um elemento estruturante triangular). Infelizmente, este par\u00e2metro s\u00f3 serve para a an\u00e1lise de imagens contendo um \u00fanico objeto, n\u00e3o sendo \u00fatil para imagens granulares, a menos que se fa\u00e7a a an\u00e1lise individual de cada gr\u00e3o.\nUm par\u00e2metro \u00fatil para an\u00e1lise de imagens granulares \u00e9 o raio m\u00e9dio dos gr\u00e3os em rela\u00e7\u00e3o ao disco digital utilizado como elemento estruturante. Lembrando que o espectro de padr\u00f5es pode ser visto como uma distribui\u00e7\u00e3o de probabilidade discreta que representa um histograma de tamanho (ver se\u00e7\u00e3o anterior), o raio m\u00e9dio r pode ser obtido como o\nvalor esperado de F(r): R\nT = V r r(r)\nr=0\n(4.11)\n4.3.3\tGranulometrias Geod\u00e9sicas\nA granulometria apresentada na se\u00e7\u00e3o 4.3.1, baseada nas aberturas morfol\u00f3gicas com os discos digitais, \u00e9 bastante \u00fatil na descri\u00e7\u00e3o de tamanho e forma, como vimos na se\u00e7\u00e3o anterior. Esta granulometria, que chamaremos de granulometria morfol\u00f3gica, n\u00e3o leva em conta a conectividade do objeto [45], o que a princ\u00edpio \u00e9 uma vantagem, pois n\u00e3o \u00e9 necess\u00e1rio tratar o problema de componetes superpostas.\nPor exemplo, consideremos a imagem da fig. 4.6, a fatia de nosso modelo tridimensional utilizada na se\u00e7\u00e3o 4.2 e repetida aqui por conveni\u00eancia.\nFigura 4.16: Imagem a ser submetida \u00e0 an\u00e1lise granulom\u00e9trica\nComo j\u00e1 mencionamos, trata-se de uma imagem granular, constitu\u00edda por diversos componentes de variadas formas e tamanhos, sendo portanto tipicamente uma imagem\nFigura 4.17: Espectro de padr\u00f5es morfol\u00f3gico associado \u00e0 imagem da fig. 4.16\nEntretanto, as aberturas morfol\u00f3gicas agem como filtros para as bordas do objeto (ver se\u00e7\u00e3o 3.3.3 do cap\u00edtulo anterior). Lembrando o conceito da criva\u00e7\u00e3o, isto significa que os objetos que n\u00e3o atravessam a peneira, isto \u00e9, o res\u00edduo que \u00e9 medido a cada passo da an\u00e1lise granulom\u00e9trica, n\u00e3o s\u00e3o os objetos originais mas vers\u00f5es filtradas dos mesmos. Para ilustrar este fato, consideremos a fig. 4.18, que ilustra o resultado da abertura morfol\u00f3gica 7j3r (correspondente \u00e0 constru\u00e7\u00e3o do espectro de padr\u00f5es da fig. 4.17), para alguns valores de r.\nNesta se\u00e7\u00e3o propomos uma granulometria utilizando uma abertura alg\u00e9brica baseada no conceito de reconstru\u00e7\u00e3o. Como j\u00e1 foi mencionado no cap\u00edtulo anterior (se\u00e7\u00e3o 3.3.4), as aberturas por reconstru\u00e7\u00e3o constituem uma opera\u00e7\u00e3o de \u201climpeza\u201d pura e simples, que remove alguns componentes conexos do conjunto original, deixando os restantes intactos. Vemos assim que a abertura por reconstru\u00e7\u00e3o introduz uma criva\u00e7\u00e3o \u201cideal\u201d, id\u00eantica \u00e0 obtida utilizando uma peneira real onde a forma e o tamanho dos furos sejam iguais ao do elemento estruturante.\nA operador baseado na reconstru\u00e7\u00e3o que consideraremos \u00e9 definido da seguinte\nr= 15\nr = 18\nFigura 4.18. Resultados da abertura morfol\u00f3gica com disco euclidiano para diversos valores de r sobre a imagem da \u00edig. 4.16\nforma:\n7Br,Brec(A) = PBrte,<Br(A)W\t(4.12)\nisto \u00e9, primeiro \u00e9 feita uma eros\u00e3o de um objeto A \u20ac P(E) com o disco de raio r, e em seguida a reconstru\u00e7\u00e3o utilizando como marcadores o resultado da eros\u00e3o (0 elemento estruturante Brec \u00e9 fixo e seu significado ser\u00e1 discutido mais adiante). Apesar de n\u00e3o termos um conjunto de marcadores fixo, pode ser mostrado [46] que o operador definido acima constitui de fato uma abertura alg\u00e9brica.\nAfirmamos que a fam\u00edlia {Vv = 7Brtj3rec}, r > 0 constitui uma granulometria, a qual chamaremos de granulometria geod\u00e9sica. Sen\u00e3o, vejamos: os axiomas de anti-extensividade e crescimento s\u00e3o trivialmente satisfeitos pois 7Br,Brec \u00ae uma abertura. J\u00e1 o axioma do comando do crivo mais forte pode ser mostrado lembrando que, pela defini\u00e7\u00e3o de dilata\u00e7\u00e3o geod\u00e9sica,\n\tM C N PBrtc,M(A) \u00e7 pBr&amp;c,N(A)\t(4.13)\nComo\t\t\n\ttB^A) Q\t5 > r > 0\t(4.14)\nConclu\u00edmos que\t\t\n\t7Br,Brec('4) \u00c7 7B\u00edtBrec(4), s > r > 0\t(4.15)\npara todo A 6 P(E). Recordando agora a propriedade das aberturas expressa pela eq. (4.8), temos que o terceiro axioma de Matheron est\u00e1 garantido. Note que a fam\u00edlia de aberturas geod\u00e9sicas considerada constitui uma granulometria inclusive para o caso dos discos digitais euclidianos, o que n\u00e3o \u00e9 em gerai verdadeiro para as granulometrias morfol\u00f3gicas. Na verdade, uma condi\u00e7\u00e3o suficiente para que uma fam\u00edlia qualquer de aberturas geod\u00e9sicas {Vn \u2014 7Bn,Br^}f n 0 seja uma granulometria \u00e9 simplesmente que a sequ\u00eancia de elementos estruturantes w utilizada seja crescente, isto \u00e9, Bn \u00c7 Bm, m > n, pois ent\u00e3o a propriedade (4.14) est\u00e1 garantida.\nEntretanto, um problema que temos que considerar \u00e9 que a abertura geod\u00e9sica 7Br,BreC5 ao contr\u00e1rio da abertura morfol\u00f3gica 7nr, \u00e9 sens\u00edvel \u00e0 conectividade do conjunto original. Note que a reconstru\u00e7\u00e3o \u00e9 feita utilizando um elemento estruturante fixo Brec, que indica justamente o tipo de conectividade a ser considerada (ver sec\u00e3o 3.2.2). Associando\nPor exemplo, ao tentarmos fazer a an\u00e1lise granulom\u00e9trica geod\u00e9sica da fig. 4.16, obtemos o espectro de padr\u00f5es geod\u00e9sico mostrado na fig, 4.19, ao qual corresponde um valor de raio m\u00e9dio de 15,180.\nFigura 4.19: Espectro de padr\u00f5es geod\u00e9sico associado \u00e0 imagem da fig. 4.16\nVemos claramente que este n\u00e3o \u00e9 um resultado satisfat\u00f3rio. Note especialmente o raio m\u00e9dio dos gr\u00e3os, que \u00e9 mais de 50% maior que o calculado com a granulometria morfol\u00f3gica! Isto ocorre devido justamente ao fato de termos um crivo ideal. Dessa maneira, dois ou mais gr\u00e3os, mesmo que individualmente passem pela peneira para um dado valor de r, podem n\u00e3o passar se estiverem conectados, pois a\u00ed deixam de \u201ccaber\u201d nos furos da peneira. Este fen\u00f4meno pode ser percebido na fig. 4.20, onde ilustramos, para alguns valores de r, o resultado da abertura geod\u00e9sica 7srjBrec sobre a imagem da fig. 4.16, utilizando o disco euclidiano.\nPara resolver este problema, temos que segmentar os gr\u00e3os superpostos, utilizando a ferramenta apresentada na se\u00e7\u00e3o 4.2.2. Na fig. 4.21 repetimos por conveni\u00eancia o resultado obtido naquela se\u00e7\u00e3o para a imagem da fig. 4.16, utilizando marcadores manuais.\nNa fig. 4.22 vemos o resultado da abertura geod\u00e9sica 7Br,Br<c sobre a imagem segmentada da fig. 4.21, onde se pode perceber claramente o efeito da criva\u00e7\u00e3o ideal. \u00c9 interessante comparar este resultado com aquele da fig. 4.18, correspondente \u00e0 abertura\nr = 3\nr = 6\nr = 9\nr = 12\nr= 15\nFigura 4.20: Resultados da abertura geod\u00e9sica 7sr,Brec com &amp;sco euclidiano para diversos valores de r sobre a imagem da fig. 4.16\nFigura 4.21: Segmenta\u00e7\u00e3o dos gr\u00e3os superpostos da fig. 4.16\nmorfol\u00f3gica.\nPor fim, vemos na fig. 4.23 o espectro de padr\u00f5es geod\u00e9sico associado \u00e0 imagem segmentada da fig. 4.21, utilizando o disco euclidiano, com um raio m\u00e9dio de 10,949. A utiliza\u00e7\u00e3o do disco euclidiano corresponde a uma peneira com os \u201cfuros\u201d circulares. Isto significa na pr\u00e1tica que se estabelece como crit\u00e9rio de tamanho o raio da circunfer\u00eancia inscrita nos objetos, um par\u00e2metro muito \u00fatil em v\u00e1rias aplica\u00e7\u00f5es.\nComparando o resultado da fig. 4.23 com o da fig. 4.17, notamos que a forma das curvas \u00e9 similar, indicando ambas a presen\u00e7a de cinco classes de tamanho. Uma maneira de apreciar a diferen\u00e7a entre os dois espectros \u00e9 observar que para v\u00e1rios valores de r o espectro de padr\u00f5es geod\u00e9sico se anula, indicando a aus\u00eancia de gr\u00e3os de tamanho correspondente \u00e0queles valores. J\u00e1 o espectro de padr\u00f5es morfol\u00f3gicos n\u00e3o se anula para estes mesmos valores, revelando a imprecis\u00e3o introduzida pelo efeito de filtragem associado \u00e0s aberturas morfol\u00f3gicas.\nr = 12\nr = 6\nr = 15\nr = 18\nFigura 4.22: Resultados da abertura geod\u00e9sica 7Br,#rec com disco euclidiano para diversos valores de r sobre a imagem da fig. 4.21\nFigura 4.23: Espectro de padr\u00f5es geod\u00e9sico da imagem segmentada da fig. 4.21\n4.4\tHistograma de Gargantas\n0 histograma de gargantas constitui uma distribui\u00e7\u00e3o estat\u00edstica que indica a frequ\u00eancia de ocorr\u00eancia de gargantas em um objeto bin\u00e1rio em fun\u00e7\u00e3o de um par\u00e2metro linear, o qual corresponde ao tamanho do maior elemento estruturante inscrito na garganta, conforme detalharemos mais adiante.\nPor garganta se entende a restri\u00e7\u00e3o que ocorre entre dois componentes conecta dos, conforme \u00e9 ilustrado na fig. 4.24, onde podemos ver tamb\u00e9m o maior elemento estruturante, no caso um disco digital euclidiano, inscrito na garganta.\nUm fato importante \u00e9 que s\u00f3 deve ser considerada como uma garganta uma restri\u00e7\u00e3o entre dois componentes cujas dimens\u00f5es s\u00e3o claramente maiores comparadas \u00e0 da garganta. Por exemplo, a restri\u00e7\u00e3o da fig. 4.25 n\u00e3o \u00e9 considerada uma garganta.\nNesta se\u00e7\u00e3o propomos um algoritmo para a obten\u00e7\u00e3o do histograma de gargantas baseado em opera\u00e7\u00f5es da Morfologia Matem\u00e1tica. A id\u00e9ia do algoritmo surge naturalmente ao se considerar a interpreta\u00e7\u00e3o da eros\u00e3o. Sendo esta o conjunto de pontos onde o elemento estruturante \u201cencaixa\u201d no conjunto original, o maior elemento estruturante inscrito na garganta \u00e9 o primeiro a produzir a separa\u00e7\u00e3o dos componentes ap\u00f3s a eros\u00e3o, desde que descartemos casos como o da fig. 4.25, onde n\u00e3o seriam produzidos os dois componentes. A fig. 4.26 ilustra a detec\u00e7\u00e3o de uma garganta atrav\u00e9s da eros\u00e3o.\nFigura 4.24: Garganta entre dois componentes conectados e maior disco digital inscrito\nFigura 4,25: Exemplo de restri\u00e7\u00e3o que n\u00e3o \u00e9 considerada uma garganta\nFigura 4.26: Componentes prestes a se desconectar ap\u00f3s eros\u00e3o pelo maior disco digital inscrito na garganta\no (origem),\ts = 0\nB,\t6 = 1\n\t6 > 2\n,6-1 somas de Minkowski\npossui tamanho 6.(0 mesmo conceito de tamanho foi utilizado por P. Maragos com objetivos diferentes, ver [28]). Utilizando a propriedade de separabilidade expressa na eq. (3.26), percebemos que a composi\u00e7\u00e3o de eros\u00f5es sucessivas com o elemento estruturante B produzir\u00e1 uma eros\u00e3o por um elemento estruturante de tamanho igual ao n\u00famero de eros\u00f5es efetuadas.\nReunindo as id\u00e9ias acima, conclu\u00edmos que para obter o histograma de gargantas devemos realizar eros\u00f5es sucessivas por um elemento estruturante primitivo dado e, a cada eros\u00e3o efetuada, contar o n\u00famero de componentes conexos resultantes, obtendo assim uma distribui\u00e7\u00e3o acumulada H(s), fun\u00e7\u00e3o do tamanho s do elemento estruturante inscrito nas gargantas, isto \u00e9, do n\u00famero de eros\u00f5es at\u00e9 aquele instante efetuadas. 0 histograma de gargantas A(s) \u00e9 dado ent\u00e3o simplesmente como a derivada discreta da distribui\u00e7\u00e3o acumulada:\nA(6) = Q(6 + 1) - \u00edl(a), 6>0\t(4.17)\n0 histograma de gargantas, \u00e0 maneira do espectro de padr\u00f5es (ver se\u00e7\u00e3o 4.3.1), produz uma curva onde para um determinado valor de s l\u00ea-se a quantidade de gargantas de tamanho maior que s e menor que s \u2022+ 1, Vale ressaltar que o par\u00e2metro de tamanho s depende do elemento estruturante primitivo utilizado, e diferentes histogramas de gargantas, contendo informa\u00e7\u00f5es muitas vezes complementares, podem ser obtidos variando-se o elemento estruturante.\nPara contar o n\u00famero de componentes conexos realizamos a rotula\u00e7\u00e2o da imagem bin\u00e1ria. A rotula\u00e7\u00e2o \u00e9 uma transforma\u00e7\u00e3o que leva uma imagem bin\u00e1ria em uma imagem mvel-de-cinza onde o valor de cada voxel \u00e9 um r\u00f3tulo correspondente ao componente conexo\n(ver se\u00e7\u00e3o 3.2.2) que o cont\u00e9m, isto \u00e9, dado um objeto A \u20ac P(E) temos:\nK \u00ed 0 se u \u20ac Ac\nrot(A)(u) =&lt;\t, Vu \u20ac S (4.18)\nI l se u \u20ac 1-\u00e9simo componente conexo\nonde l > 1 \u00e9 o r\u00f3tulo associado a cada componente conexo, Para determinar o n\u00famero total de componentes conexos bastar tomar o valor m\u00e1ximo da imagem rotulada. Note ainda que a opera\u00e7\u00e3o de rotula\u00e7\u00e3o depende evidentemente do tipo de vizinhan\u00e7a utilizada. Vale ressaltar que uma outra alternativa para a determina\u00e7\u00e3o do n\u00famero de componentes conexos seria utilizar o algoritmo associado \u00e0 rela\u00e7\u00e3o de Euler [44], Esta solu\u00e7\u00e3o, apesar de ser mais simples, possui entretanto problemas, como o de exigir que os componentes sejam simplesmente conexos (n\u00e3o possuam \u201cburacos\u201d), e por isso n\u00e3o foi adotada.\nO algoritmo das eros\u00f5es e rotula\u00e7\u00f5es sucessivas delineado acima apresenta no entanto uma falha: como na maioria das imagens h\u00e1 uma diferen\u00e7a de tamanho entre os diversos componentes, pode ocorrer que alguns deles desapare\u00e7am como consequ\u00eancia da eros\u00e3o, antes de se ter determinado todas as gargantas, influindo no processo de rotula\u00e7\u00e3o. Isto faz com que a distribui\u00e7\u00e3o acumulada H(s) deixe de ser uma fun\u00e7\u00e3o crescente, e o histograma A(s) perde obviamente o seu significado.\nA solu\u00e7\u00e3o para este problema consiste em se utilizar eros\u00f5es condicionais (ver se\u00e7\u00e3o 3.3.4 do cap\u00edtulo anterior), onde a m\u00e1scara a cada etapa \u00e9 o conjunto de componentes que desapareceria ap\u00f3s a eros\u00e3o de tamanho s. Para se determinar a m\u00e1scara utilizamos a abertura geod\u00e9sica definida na equa\u00e7\u00e3o (4.12). A diferen\u00e7a entre o conjunto original A e sua abertura geod\u00e9sica, utilizando um elemento estruturante B, constitui uma opera\u00e7\u00e3o que chamaremos de top-hat geod\u00e9sico, dado por:\n\u00cdS \u201c / \u201c 73,Bree\t(4.19)\nonde lembramos que Brec \u00e9 o elemento estruturante primitivo utilizado na reconstru\u00e7\u00e3o (e que determina a vizinhan\u00e7a utilizada), que pode ser inclusive o pr\u00f3prio B.\nE f\u00e1cil ver que o top-hat geod\u00e9sico produz justamente os componentes conexos que somem ap\u00f3s a eros\u00e3o pelo elemento estruturante B. O resultado obtido a cada passo com o top-hat geod\u00e9sico deve ser ent\u00e3o acumulado e utilizado como m\u00e1scara na eros\u00e3o condicional. Ap\u00f3s um certo n\u00famero finito de itera\u00e7\u00f5es 5 a imagem de entrada se iguala \u00e0 m\u00e1scara, n\u00e3o havendo mais modifica\u00e7\u00e3o por meio de eros\u00f5es condicionais subsequentes.\nPara sintetizar e talvez esclarecer um pouco mais as id\u00e9ias acima, apresentamos\na seguir o algoritmo de obten\u00e7\u00e3o do histograma de gargantas em uma pseudo-implmenta\u00e7\u00e3o.\n-\tDados:\n\u2022\t7,-, Imagem bin\u00e1ria de entrada\n\u2022\tIm, Imagem de trabalho (m\u00e1scara)\n\u2666\tg[ ], Array correspondente \u00e0 distribui\u00e7\u00e3o acumulada 0(s)\n\u2666\th[ ], Array correspondente ao histograma de gargantas A(s)\n~ Inicializa\u00e7\u00e3o:\nInicialize Im com zeros\n-\tDetermina\u00e7\u00e3o da distribui\u00e7\u00e3o acumulada \u00cd2(s):\nPara i +\u2014 0,1,2,...\ng[i] max {rot(Zt')}\nSe (A = 7m) saia do loop;\nCaso contr\u00e1rio, volte ao in\u00edcio do loop\n\u2014 Determina\u00e7\u00e3o do histograma de gargantas A(s):\nPara i&lt;\u2014 0,1,2,..., S - 1\nh[i] g[i+l] - g[i]\nA partir do histograma de gargantas, podemos definir ainda um par\u00e2metro bas-\ntante \u00fatil, o tamanho m\u00e9dio J das gargantas (segundo o elemento estruturante utilizado), que nada mais \u00e9 que o valor esperado do histograma de gargantas visto como uma distribui\u00e7\u00e3o de probabilidade (lembrando que uma imagem pode ser vista como uma realiza\u00e7\u00e3o\nprobabil\u00edstica de um random set):\nS\n\u00a3 \u00abA(\u00ab)\n5 = \u2014f.------ (4.20)\nDW\nJJ-0\nComo veremos no cap\u00edtulo seguinte, o histograma de gargantas constitui uma ferramenta de an\u00e1lise muito \u00fatil para a caracteriza\u00e7\u00e3o de meios porosos. Sua utilidade por\u00e9m n\u00e3o se restringe a este tipo de aplica\u00e7\u00e3o. No problema da inspe\u00e7\u00e3o autom\u00e1tica de placas de circuito impresso, por exemplo, uma quest\u00e3o importante \u00e9 a caracteriza\u00e7\u00e3o dos estreitamentos que ocorrem nas trilhas e tamb\u00e9m no material isolante, que indicam falhas no processo de manufatura da placa, O histograma de gargantas representa uma contribui\u00e7\u00e3o importante a esta \u00e1rea de aplica\u00e7\u00e3o, uma vez que fornece uma informa\u00e7\u00e3o probabil\u00edstica sobre os estreitamentos, embora n\u00e3o produza informa\u00e7\u00e3o de natureza espacial, como localiza\u00e7\u00e3o dos estreitamentos.\nConsideremos por exemplo a imagem da fig. 4.27, que representa uma imagem t\u00edpica de uma placa de circuito impresso, j\u00e1 binarizada. O objeto nesta imagem \u00e9 a parte condutora (as trilhas e as ilhas), enquanto que invertendo a mesma obtemos o material isolante. Utilizando como elemento estruturante primitivo o disco digital bidimensional de raio 1 segundo a m\u00e9trica do quarteir\u00e3o (a conhecida \u201ccruz11)? obtivemos os histogramas de garganta correspondentes aos casos do material condutor e isolante, resultado este que pode ser visto na fig. 4.28, e tamb\u00e9m os tamanhos m\u00e9dios associados, respectivamente 3,514 e 4,903.\n4.5\tAspectos de implementa\u00e7\u00e3o\nEncerrando o cap\u00edtulo, gostar\u00edamos de fazer uma discuss\u00e3o sobre algoritmos utilizados na implementa\u00e7\u00e3o das ferramentas de an\u00e1lise discutidas.\nAl\u00e9m das transforma\u00e7\u00f5es b\u00e1sicas da Morfologia Matem\u00e1tica apresentadas no cap\u00edtulo 3, as quais disp\u00f5em de implementa\u00e7\u00f5es razoavelmente simples [23], as ferramentas discutidas neste cap\u00edtulo fazem uso de algumas transforma\u00e7\u00f5es que seriam muito ineficientes\nFigura 4.27: Imagem bin\u00e1ria de placa de circuito impresso\nFigura 4.28: Histogramas de gargantas associados \u00e0 imagem do PCB (a) parte condutora (b) parte isolante\nse fossem implementadas a partir da composi\u00e7\u00e3o de transforma\u00e7\u00f5es b\u00e1sicas, principalmente no caso tridimensional, que envolve normalmente um volume muito grande de dados. Estas transforma\u00e7\u00f5es s\u00e3o a determina\u00e7\u00e3o de watersheds, a fun\u00e7\u00e3o distancia e a rotula\u00e7\u00e3o. Al\u00e9m destas, a abertura e o fechamento por reconstru\u00e7\u00e3o, apresentadas no cap\u00edtulo anterior e tamb\u00e9m utilizadas por ferramentas deste cap\u00edtulo, s\u00e3o muito ineficientes para imagens n\u00edvel-de-cinza, especialmente no caso tridimensional, exigindo tamb\u00e9m uma implementa\u00e7\u00e3o espec\u00edfica.\nA caracter\u00edstica comum a todos os algoritmos adotados para implementar estas transforma\u00e7\u00f5es \u00e9 utilizarem uma estrutura de dados chamada fila de espera. Como o pr\u00f3prio nome sugere, trata-se de uma estrutura ordenada e linear, onde os dados s\u00e3o colocados por um lado e retirados pelo outro, conforme \u00e9 ilustrado na fig. 4.29. A fila de espera \u00e9 portanto uma estrutura do tipo \u201cprimeiro-a-entrar-primeiro-a-sair\u201d (FIFO, First-In-First-Out). As filas de espera podem ser implementadas atrav\u00e9s de listas encadeadas ou arrays circulares [47, 23].\nFila de espera\nEntrada dos dados\nSa\u00edda dos dados\nFigura 4.29: Representa\u00e7\u00e3o esquem\u00e1tica de uma fila de espera\nAo contr\u00e1rio dos algoritmos ditos paralelos, onde n\u00e3o \u00e9 utilizado o conceito de varredura ordenada dos voxels, e sequenciais, onde tipicamente s\u00e3o requeridas v\u00e1rias varreduras de todos os voxels da imagem [52], os algoritmos baseados na fila de espera possibilitam implementa\u00e7\u00f5es muito eficientes onde a ordem em que os voxels s\u00e3o varridos garante que a cada instante sejam considerados os voxels realmente \u00fateis.\nUma grande vantagem dos algoritmos baseados na fila de espera \u00e9 que a extens\u00e3o para qualquer n\u00famero de dimens\u00f5es \u00e9 f\u00e1cil de ser feita, bastando alterar as vizinhan\u00e7as consideradas, isto \u00e9, as poss\u00edveis dire\u00e7\u00f5es em que os elementos da imagem s\u00e3o percorridos. A desvantagem \u00e9 a grande quantidade de mem\u00f3ria requerida, que pode chegar a ser mais de duas vezes o tamanho ocupado pela imagem original, no caso tridimensional.\nO algoritmo utilizado para a implementa\u00e7\u00e3o da determina\u00e7\u00e3o dos watersheds, proposto por P. Soille e L. Vincent [48, 54], consiste na id\u00e9ia da inunda\u00e7\u00e3o do modelo topogr\u00e1fico associado \u00e0 imagem (ver se\u00e7\u00e3o 4.2). Para tanto, \u00e9 feita uma ordena\u00e7\u00e3o dos voxels do menor para o maior n\u00edvel de cinza, de modo que sucessivos limiares crescentes da imagem (em correspond\u00eancia com a id\u00e9ia da \u00e1gua subindo em uma inunda\u00e7\u00e3o) possam ser acessados eficientemente. Ent\u00e3o s\u00e3o determinadas zonas de influ\u00eancia geod\u00e9sica com base em limiares anteriores, utilizando para isto a fila de espera. Este algoritmo \u00e9 bem mais eficiente do que o tradicional (encontrado em [44, 17]), baseado na determina\u00e7\u00e3o direta das zonas de influ\u00eancia geod\u00e9sica via SKIZ.\nA transforma\u00e7\u00e3o de rotula\u00e7\u00e3o \u00e9 tamb\u00e9m implementada muito facilmente com a fila de espera. A imagem \u00e9 varrida e a cada vez que um voxel de um componente ainda n\u00e3o visitado \u00e9 encontrado, \u00e9 feita uma reconstru\u00e7\u00e3o do componente empregando o voxel em quest\u00e3o como marcador, utilizando para isto a fila. Apesar de este ser um esquema de rotula\u00e7\u00e3o bastante conhecido [44], a etapa de reconstru\u00e7\u00e3o baseada na fila torna o algoritmo muito mais eficiente. Vale resaltar ainda que uma grande quantidade de outros algoritmos de rotula\u00e7\u00e3o pode ser encontrada na literatura, dos quais citamos como exemplo os algoritmos em [50] e [51].\nJ\u00e1 a fun\u00e7\u00e3o dist\u00e2ncia \u00e9 um tema que vem atraindo a aten\u00e7\u00e3o de pesquisadores do mundo todo h\u00e1 bastante tempo. Os algoritmos de fun\u00e7\u00e3o dist\u00e2ncia podem ser divididos naqueles que determinam a fun\u00e7\u00e3o dist\u00e2ncia euclidiana \u201cverdadeira\u201d e naqueles que calculam aproxima\u00e7\u00f5es desta, como \u00e9 o caso das dist\u00e2ncias do quarteir\u00e3o e do m\u00e1ximo. Neste \u00faltimo caso, algoritmos paralelos e sequenciais bidimensionais foram propostos por G. Borgerfors em [9], o qual se tornou um trabalho cl\u00e1ssico sobre o assunto. A abordagem que adotamos para o caso das dist\u00e2ncias do quarteir\u00e3o e do m\u00e1ximo [52] \u00e9 baseada entretanto na fila de espera: Primeiro s\u00e3o determinados os voxels que formam a superf\u00edcie do objeto e em seguida as dist\u00e2ncias s\u00e3o propagadas para o interior do mesmo utilizando a fila. Um algoritmo\nsimilar a este pode ser encontrado em [36]. J\u00e1 para o c\u00e1lculo da fun\u00e7\u00e3o dist\u00e2ncia euclidiana, um algoritmo bidimensional cl\u00e1ssico, sequencial, \u00e9 o de Danielsson [16]. A abordagem que adotamos, proposta por P. Soille [47], \u00e9 baseada na fila de espera e faz a propaga\u00e7\u00e3o dos valores de dist\u00e2ncia utilizando tr\u00eas imagens de trabalho de forma a permitir uma representa\u00e7\u00e3o vetorial (consumindo assim bastante mem\u00f3ria). Uma implementa\u00e7\u00e3o similar, por\u00e9m baseada em uma fila de espera hier\u00e1rquica, foi proposta por C. Gratin [23].\nFinalmente, a abertura e fechamento por reconstru\u00e7\u00e3o foram implementados utilizando o algoritmo proposto por L. Vincent em [53]. Este algoritmo faz inicialmente duas varreduras sequenciais da imagem dos marcadores, seguida pela propaga\u00e7\u00e3o dos m\u00e1ximos (resp. m\u00ednimos) regionais encontrados (utilizando para isto a fila de espera) para obter a abertura (resp. fechamento). Trata-se pois de um esquema h\u00edbrido entre um algoritmo sequencial e um baseado na fila de espera que consegue ser assim muito eficiente.\nCap\u00edtulo 5\nResultados Experimentais: Caracteriza\u00e7\u00e3o de Meio Poroso\n5.1\tIntrodu\u00e7\u00e3o\n0 estudo de sistemas contendo meios porosos (rochas) \u00e9 de grande import\u00e2ncia em diversas \u00e1reas economicamente importantes tais como a petrof\u00edsica, engenharia de petr\u00f3leo, engenharia de reservat\u00f3rios, an\u00e1lise de solos e cristalografia.\nNeste sentido, a caracteriza\u00e7\u00e3o dos meios porosos tem por objetivo a determina\u00e7\u00e3o de propriedades f\u00edsicas do meio \u2014 que indiquem por exemplo a possibilidade de extra\u00e7\u00e3o de petr\u00f3leo \u2014 diretamente a partir da sua estrutura morfol\u00f3gica. Esta t\u00e9cnica possui vantagens em rela\u00e7\u00e3o a m\u00e9todos considerados \u201cindiretos\u201d, como a porosimetria a merc\u00fario (onde os par\u00e2metros de interesse s\u00e3o medidos a partir da intrus\u00e3o for\u00e7ada de merc\u00fario no material), que s\u00e3o em geral imprecisos [35].\nA caracteriza\u00e7\u00e3o de meios porosos \u00e9 usualmente feita a partir da an\u00e1lise de imagens bidimensionais provenientes de cortes seccionais de amostras da rocha em estudo. A extens\u00e3o para o caso tridimensional \u00e9 feita normalmente utilizando probabilidade geom\u00e9trica ou estereologia, tamb\u00e9m chamada de corre\u00e7\u00e3o estereom\u00e9trica, que procura estimar os par\u00e2metros f\u00edsicos tridimensionais desejados a partir dos dados medidos nos cortes bidimensionais.\nNeste cap\u00edtulo, apresentaremos par\u00e2metros de an\u00e1lise de meio poroso obtidos diretamente de uma amostra experimental tridimensional, sem nenhuma corre\u00e7\u00e3o estereom\u00e9trica envolvida. A amostra tridimensional estudada consiste em um objeto aproximadamente cil\u00edndrico de gesso contendo peda\u00e7os de giz de variadas formas e tamanhos. Com isto pretendeu-se modelar uma amostra real de rocha onde duas fases complementares normalmente existem: a fase s\u00f3lida, que constitui o material propriamente dito e \u00e9 representada pelos peda\u00e7os de giz, e a fase porosa, que corresponde ao espa\u00e7o que pode ser invadido por fluidos modificando as propriedades f\u00edsicas do meio, e que \u00e9 representada pelo gesso.\nDiscutiremos todas as etapas envolvidas na reconstru\u00e7\u00e3o tridimensional da a-mostra experimental, desde o processo de aquisi\u00e7\u00e3o at\u00e9 a interpola\u00e7\u00e3o para obten\u00e7\u00e3o de volume isotr\u00f3pico, passando pela etapa de registro das se\u00e7\u00f5es seriadas, quando apresentaremos os resultados obtidos pela aplica\u00e7\u00e3o do m\u00e9todo proposto no cap\u00edtulo 2 deste trabalho.\nEm seguida, utilizaremos as ferramentas de an\u00e1lise tridimensional baseadas na Morfologia Matem\u00e1tica, desenvolvidas no cap\u00edtulo anterior, para a obten\u00e7\u00e3o de medidas que descrevam a estrutura morfol\u00f3gica da amostra em estudo. Ap\u00f3s a apresenta\u00e7\u00e3o de medidas de car\u00e1ter geral, \u00e9 feita a an\u00e1lise granulom\u00e9trica das fases s\u00f3lida e porosa, a qual produz interpreta\u00e7\u00f5es relevantes na determina\u00e7\u00e3o de processos de invas\u00e3o ou drenagem por fluidos, pois fornece informa\u00e7\u00e3o sobre aspectos morfol\u00f3gicos (tamanho e forma) dos poros e gr\u00e3os presentes no meio. Em seguida \u00e9 realizada a an\u00e1lise das gargantas, que constitui um resultado muito \u00fatil, pois as gargantas presentes na fase porosa possuem tamb\u00e9m uma influ\u00eancia importante em processos de invas\u00e3o ou drenagem, em consequ\u00eancia da oposi\u00e7\u00e3o que elas representam \u00e0 passagem de um fluido atrav\u00e9s do material.\nAntes de passar aos resultados discutidos acima, iniciamos o cap\u00edtulo com uma se\u00e7\u00e3o sobre o ambiente computacional utilizado no desenvolvimento deste trabalho, o sistema Khoros, em conjunto com as toolboxes V3DTOOLS e MMACH, discutindo tamb\u00e9m a nossa participa\u00e7\u00e3o no desenvolvimento das mesmas.\n5.2\tAmbiente e Ferramentas Computacionais Utilizados\nNesta se\u00e7\u00e3o nos propomos a descrever o ambiente e as ferramentas computacionais que foram utilizados para desenvolver as implementa\u00e7\u00f5es necess\u00e1rias e para obter os\nresultados apresentados ao longo deste trabalho.\n5.2.1\tO Sistema Khoros\nA plataforma adotada durante todo o desenvolvimento foi o sistema de visualiza\u00e7\u00e3o e processamento de imagens Khoros [37, 40]. Este sistema consiste em um pacote computacional aberto, desenvolvido na Universidade do Novo M\u00e9xico e baseado no Unix e no XI1, sistemas por sua vez largamente difundidos. O Khoros tem alcan\u00e7ado enorme popularidade em todo o mundo e vem sendo utilizado nas mais diversas \u00e1reas, tais como manipula\u00e7\u00e3o e an\u00e1lise de imagens m\u00e9dicas, sensoreamento remoto, visualiza\u00e7\u00e3o cient\u00edfica, reconhecimento de padr\u00f5es, sistemas de informa\u00e7\u00f5es geogr\u00e1ficas, aplica\u00e7\u00f5es de processamento de imagem em geral e at\u00e9 mesmo aplica\u00e7\u00f5es como bancos de dados e sistemas de controle.\nO sistema Khoros constitui-se basicamente de:\n-\tUma cole\u00e7\u00e3o de programas principais, subdivididos quanto \u00e0 utiliza\u00e7\u00e3o em subsistemas e acess\u00edveis tanto atrav\u00e9s da linha de comando como atrav\u00e9s de uma linguagem de programa\u00e7\u00e3o visual chamada cantata [38, 39].\n-\tUma biblioteca de fun\u00e7\u00f5es, que engloba a funcionalidade da maior parte dos programas principais, al\u00e9m de fornecer opera\u00e7\u00f5es b\u00e1sicas como manipula\u00e7\u00e3o de arquivos, gerenciamento de mem\u00f3ria, fun\u00e7\u00f5es matem\u00e1ticas e outras.\n\u2014 Um conjunto de ferramentas de suporte ao programador (UIDS, User Interface Deve-lopment System), incluindo geradores autom\u00e1ticos de c\u00f3digo e programas interativos para o desenvolvimento e manuten\u00e7\u00e3o do sistema.\nOs programa principais do Khoros podem ser classificados em vrotinas, que n\u00e3o pressup\u00f5em intera\u00e7\u00e3o com o usu\u00e1rio durante sua execu\u00e7\u00e3o, e zvrotinas, que s\u00e3o programas que apresentam uma interface gr\u00e1fica, permitindo ao usu\u00e1rio a utiliza\u00e7\u00e3o do mouse e do teclado para realizar a tarefa desejada. Nesta \u00faltima classe de programas se enquadra o cantata, que \u00e9 a interface que implementa a linguagem de programa\u00e7\u00e3o visual mencionada acima. Os programas do Khoros s\u00e3o representados no cantata como \u00edcones (glyphs, acess\u00edveis atrav\u00e9s de menus pull-down), e o fluxo de dados \u00e9 representado por liga\u00e7\u00f5es entre os \u00edcones.\nOs \u00edcones representam portanto operadores^ que atuam sobre os dados transformando-os. \u00edcones especiais para controle de fluxo de execu\u00e7\u00e3o tamb\u00e9m est\u00e3o dispon\u00edveis, possibilitando a implementa\u00e7\u00e3o de complexos procedimentos utilizando apenas o cantata, n\u00e3o exigindo desta forma conhecimentos nem de linguagens de programa\u00e7\u00e3o tradicionais, nem do Unix ou Xll. Os \u00edcones e suas interliga\u00e7\u00f5es s\u00e3o dipostos em uma \u00e1rea de trabalho (workspace), cujo conte\u00fado pode ser salvo e recuperado posteriormente. Na fig. 5.1 vemos o cantata e um workspace t\u00edpico.\nINPUT S&amp;RCES\tCaWHiSIONS\nOUTPUT\tARITHMETIC\n\tflaia.\tCantata Hurkwaca\t\nIMAGE PROCESSING\t\tSIGNAL PROCESSING)\nIHPGE RrtftYSlS\t\tREMOTE t GIS 1\nCRNIRTR Visual Programing Ejw\u00edrorwwit for the KHLHJS Sosten TO^~mLin\u00casj\nTOOLBOXES|\nFigura 5.1: Cantata e um workspace t\u00edpico\nPode-se dizer que o cantata \u00e9 urna das principais raz\u00f5es do sucesso obtido pelo Khoros, entretanto n\u00e3o \u00e9 seu \u00fanico ponto forte. Para usuarios mais avan\u00e7ados, que precisam implementar procedimentos mais especializados ou complexos, \u00e9 oferecida a possibilidade de adicionar programas principais e/ou fun\u00e7\u00f5es de biblioteca ao conjunto original dispon\u00edvel no Khoros, utilizando para isto a linguagem C ou ainda alguma linguagem shell interpretada do Unix. Ferramentas de gera\u00e7\u00e3o e manuten\u00e7\u00e3o de c\u00f3digo e bibliotecas de opera\u00e7\u00f5es b\u00e1sicas s\u00e3o fornecidas para facilitar e padronizar a cria\u00e7\u00e3o de novos programas.\nVale ressaltar que neste trabalho utilizamos a vers\u00e3o 1.05 do Khoros, mas j\u00e1 est\u00e1 sendo distribu\u00edda a vers\u00e3o 2.0, que incorpora novos conceitos como programa\u00e7\u00e3o orientada a objeto, ferramentas de gerenciamento de projeto e outros. A filosofia do sistema, delineada nesta se\u00e7\u00e3o, permanece por\u00e9m essencialmente a mesma.\nNas pr\u00f3ximas se\u00e7\u00f5es, descreveremos duas toolboxes que foram utilizadas neste trabalho, e em cujo desenvolvimento tivemos oportunidade de participar.\n5.2.2\tA toolbox V3DTOOLS\nA toolbox V3DTOOLS \u00e9 desenvolvida pelo grupo liderado pelo Prof. Dr. Roberto de Alencar Lotufo, orientador deste trabalho, no DCA da Faculdade de Engenharia El\u00e9trica da Unicamp. Ela surgiu inicialmente pela necessidade de adicionar ao Khoros ferramentas de visualiza\u00e7\u00e3o tridimensional aplicadas a imagens m\u00e9dicas [20].\nAtualmente, a toolbox V3DTOOLS cont\u00e9m um conjunto razoavelmente completo de programas b\u00e1sicos para a manipula\u00e7\u00e3o, an\u00e1lise e visualiza\u00e7\u00e3o de dados volum\u00e9tricos no Khoros. A \u00fanica exig\u00eancia feita \u00e9 que os dados sejam representados segundo o esquema Voxel, j\u00e1 descrito no cap\u00edtulo 3 (ver se\u00e7\u00e3o 3.2.1). Todos os programas da vers\u00e3o atual da V3DTOOLS s\u00e3o vrotinas. Uma descri\u00e7\u00e3o detalhada da toolbox V3DTOOLS pode ser encontrada em [26].\nTivemos a oportunidade de contribuir com programas de manipula\u00e7\u00e3o e processamento tridimensional \u00e0 toolbox V3DTOOLS, os quais citamos a seguir:\n-\tvinsert3d - Insere, em uma posi\u00e7\u00e3o especificada, uma sub-imagem 3D em outra imagem 3D.\n-\tvpad3d - Cria uma \u201cborda\u201d de dimens\u00f5es e valor arbitr\u00e1rios em volta de uma imagem 3D.\n-\tvfft3d - Implementa a Transformada de Fourier tridimensional\nAl\u00e9m destes, implementamos uma xvrotina chamada markimage. que permite ao usu\u00e1rio selecionar interativamente pontos em uma imagem 3D e depois armazen\u00e1-los em um arquivo para posterior uso. Em se\u00e7\u00f5es seguintes mencionaremos a aplica\u00e7\u00e3o desta ferramenta em diferentes etapas deste trabalho.\n5.2.3\tA toolbox MMACH\nA toolbox MMACH [7] cont\u00e9m as ferramentas b\u00e1sicas de processamento e an\u00e1lise de imagens por Morfologia Matem\u00e1tica que foram utilizadas neste trabalho. A MMACH \u00e9 o resultado do esfor\u00e7o conjunto de grupos pertencentes a USP (Universidade de S\u00e3o Paulo), Unicamp e INPE (Instituto Nacional de Pesquisas Espaciais), liderados respectivamente pelos Pro\u00eds. Drs. Junior Barrera, Roberto Lotufo e Gerald Banon.\nComo foi visto no cap\u00edtulo 3, os operadores da Morfologia Matem\u00e1tica possuem uma estrutura hier\u00e1rquica onde transforma\u00e7\u00f5es complexas s\u00e3o obtidas a partir da combina\u00e7\u00e3o de outras cada vez mais simples, at\u00e9 se chegar aos operadores fundamentais, as eros\u00f5es e dilata\u00e7\u00f5es.\nEsta estrutura hier\u00e1rquica dos operadores morfol\u00f3gicos permite a especifica\u00e7\u00e3o de uma linguagem morfol\u00f3gica (LM) [6], onde uma transforma\u00e7\u00e3o arbitr\u00e1ria qualquer \u00e9 expressa atrav\u00e9s de senten\u00e7as onde as palavras s\u00e3o operadores e os conectivos s\u00e3o opera\u00e7\u00f5es de composi\u00e7\u00e3o, tais como uni\u00e3o e interse\u00e7\u00e3o.\nUma m\u00e1quina morfol\u00f3gica (MMACH) consiste na implementa\u00e7\u00e3o, em hardware ou software, de uma linguagem formal equivalente \u00e0 linguagem morfol\u00f3gica [5]. Os programas de uma MMACH correspondem \u00e0s frases da LM.\nAs caracter\u00edsticas do sistema Khoros o fazem extremamente apropriado \u00e0 implementa\u00e7\u00e3o de uma m\u00e1quina morfol\u00f3gica, devido \u00e0 possibilidade de se organizar os programas em uma toolbox e permitir ao usu\u00e1rio a cria\u00e7\u00e3o de procedimentos complexos e sofisticados a partir destes programas mais b\u00e1sicos. Para isto, pode-se utilizar a linguagem de programa\u00e7\u00e3o visual Cantata, ou ainda criar um novo programa a partir de chamadas \u00e0s fun\u00e7\u00f5es\nde biblioteca da toolbox.\nA MMACH se encontra dividida em quatro n\u00edveis hier\u00e1rquicos de operadores, al\u00e9m de um n\u00edvel de ferramentas de uso geral. Damos a conhecer abaixo os programas que fazem parte da MMACH. Algumas das transforma\u00e7\u00f5es implementadas por estes programas j\u00e1 foram mencionadas em cap\u00edtulos anteriores ou ser\u00e3o ao longo deste cap\u00edtulo; as demais podem ser encontradas em [5, 7, 44].\n- Ferramentas de uso geral:\n\u2022\tvstrset - Cria\u00e7\u00e3o de elementos estruturantes primitivos 3x3\n\u2022\tviff2str - Convers\u00e3o de uma imagem do Khoros para elemento estruturante\n\u2022\tvgdisk - Cria\u00e7\u00e3o de discos digitais como elementos estruturantes\n\u2022\tvrotstr - Rota\u00e7\u00e3o de elementos estruturantes primitivos\n\u2022\tvequal - Compara\u00e7\u00e3o de igualdade entre duas imagens\n\u2022\tvwind - Desenha as bordas de uma imagem 2D\n\u2022\tvless - Compara\u00e7\u00e3o \u201cmenor ou igual que\u201d entre duas imagens\n\u2022\tvcastl - Convers\u00e3o de tipo entre imagens\n\u2014 Opera\u00e7\u00f5es b\u00e1sicas:\n\u2022\tvinf - \u00ednfimo (interse\u00e7\u00e3o) de suas imagens\n\u2022\tvsup - Supremo (uni\u00e3o) de duas imagens\n\u2022\tvxnv - Involu\u00e7\u00e3o (complementa\u00e7\u00e3o)\n\u2022\tvsubm - Subtra\u00e7\u00e3o\n\u2022\tvaddm - Adi\u00e7\u00e3o\n\u2022\tvthreshad - Limiariza\u00e7\u00e3o adaptativa\n\u2022\tvtoggle - \u201cChaveamento\u201d entre duas imagens\n\u2022\tvdil - Dilata\u00e7\u00e3o por um elemento estruturante\n\u2022\tvero - Eros\u00e3o por um elemento estruturante\n\u2022\tvdist - Fun\u00e7\u00e3o dist\u00e2ncia\n\u2022\tvlabelexp - Rotula\u00e7\u00e3o de componentes conexos\n\u00ab vwatersh - Determina\u00e7\u00e3o de watersheds\n-\tOpera\u00e7\u00f5es de primeiro n\u00edvel (utilizam apenas uma vez cada opera\u00e7\u00e3o b\u00e1sica):\n\u2022\tvadil - Anti-dilata\u00e7\u00e3o\n\u2022\tvaero - Anti-eros\u00e3o\n\u2022\tvgradm - Gradiente morfol\u00f3gico\n\u2022\tvcdil - Dilata\u00e7\u00e3o condicional\n\u2022\tvcero - Eros\u00e3o condicional\n\u2022\tvopen - Abertura morfol\u00f3gica\n\u2022\tvclose - Fechamento morfol\u00f3gico\n\u2022\tvsupgen - Sup-geradora\n\u2022\tvinfgen - Inf-geradora\n\u2022\tvthin - Afinamento\n\u2022\tvthick - Espessamento\n\u2022\tvcthin - Afinamento condicional\n\u2022\tvcthick - Espessamento condicional\n\u2022\tvminf - \u00ednfimo de m\u00faltiplas imagens\n\u2022\tvmsup - Supremo de m\u00faltiplas imagens\n-\tOpera\u00e7\u00f5es de segundo n\u00edvel (utilizam mais de uma vez cada opera\u00e7\u00e3o b\u00e1sica):\n\u2022\tvndil - Composi\u00e7\u00e3o de dilata\u00e7\u00f5es\n\u2022\tvnero - Composi\u00e7\u00e3o de eros\u00f5es\n\u2022\tvncdil - Composi\u00e7\u00e3o de dilata\u00e7\u00f5es condicionais\n\u2022\tvncero ~ Composi\u00e7\u00e3o de eros\u00f5es condicionais\n\u2022\tvnopen - Composi\u00e7\u00e3o de aberturas morfol\u00f3gicas\n\u2022\tvnclose - Composi\u00e7\u00e3o de fechamentos morfol\u00f3gicos\n\u2022\tvnocfllt - Filtro alternado sequencial (abertura-fechamento)\n\u2022\tvncofilt - Filtro alternado sequencial (fechamento*abertura)\n\u2022\tvnocofilt - Filtro alternado sequencial (abertura-fechamento-abertura)\n\u2022\tvncocfilt - Filtro alternado sequencial (fechamento-abertura-fechamento)\n\u2022\tvnthin - Composi\u00e7\u00e3o de afinamentos\n\u2022\tvnthick - Composi\u00e7\u00e3o de espessamentos\n\u2022\tvncanon - Transforma\u00e7\u00e3o can\u00f4nica\n\u2022\tvncanond - Transforma\u00e7\u00e3o can\u00f4nica dual\n\u2022\tvdilseg - Dilata\u00e7\u00e3o por um segmento\n\u2022\tveroseg - Eros\u00e3o por um segmento\n\u2022\tvopenseg - Abertura por um segmento\n\u2022\tvcloseseg - Fechamento por um segmento\n- Opera\u00e7\u00f5es de terceiro n\u00edvel (utilizam um n\u00famero indeterminado de vezes cada ope-ra\u00e7\u00e3o b\u00e1sica):\n\u2022\tvopenrec - Abertura por reconstru\u00e7\u00e3o\n\u2022\tvclosrec - Fechamento por reconstru\u00e7\u00e3o\n\u2022\tvcenter - Filtro central\n\u2022\tvskthin - Esqueleto por afinamento\n\u2022\tvskthick - Exoesquelto por espessamento\n\u2022\tvcskthin - Esqueleto condicional por afinamento\n\u2022\tvcskthick - Exoesquelto condicional por espessamento\n\u2022\tvskel - Esqueleto morfol\u00f3gico\n\u2022\tvlastero - \u00daltima eros\u00e3o\n\u2022\tvbisset - Bissetor condicional\n\u2022\tvskthinm - Esqueleto por afinamento com m\u00faltiplos elementos estruturantes\n\u2022\tvclohole - Remo\u00e7\u00e3o de \u201cburacos\u201d\n\u2022\tvedgeoff - Remo\u00e7\u00e3o de componentes que tocam a borda\n\u2022\tvhomot - Modifica\u00e7\u00e3o de homotopia\n\u2022\tvlocmin - Determina\u00e7\u00e3o dos m\u00ednimos locais\n\u2022\tvlocmax - Determina\u00e7\u00e3o dos m\u00e1ximos locais\n\u2022\tvskiz - Esqueleto por zonas de influencia\n\u2022\tvsmooth - Segmenta\u00e7\u00e3o binaria suavizante\n5.2.3.1\tExtens\u00f5es da MMACH para a Morfolog\u00eda Matem\u00e1tica 3D\nNossa participa\u00e7\u00e3o no desenvolvimento da MMACH tem se concentrado basicamente na extens\u00e3o para o caso 3D de seus programas, que originalmente s\u00f3 tratavam imagens bidimensionais. Al\u00e9m disso, por raz\u00f5es de efici\u00eancia, at\u00e9 ent\u00e3o eram permitidos apenas elementos estruturantes primitivos 3x3, isto \u00e9, subconjuntos do quadrado elementar (Vale ressaltar que qualquer eros\u00e3o ou dilata\u00e7\u00e3o bidimensional pode ser expressa respectivamente como composi\u00e7\u00e3o de eros\u00f5es ou dilata\u00e7\u00f5es por elementos estruturantes primitivos 3 x 3 [5, 55])\nA fim de permitir eros\u00f5es e dilata\u00e7\u00f5es 3D, e tamb\u00e9m possibilitar ao usu\u00e1rio utilizar elementos estruturantes de tamanho maior que 3 x 3, foi adicionado um novo algoritmo \u00e0s rotinas vero e vdil para tratar estes casos. Al\u00e9m disso, foram criados os programas viff2str e vgdisk (vide descri\u00e7\u00e3o acima), que funcionam tanto para o caso 2D como 3D. Devido \u00e0 estrutura hier\u00e1rquica dos operadores, praticamente todos os programas do n\u00edvel 1 em diante passaram a funcionar em 3D com estas modifica\u00e7\u00f5es (alguns programas, como os de determina\u00e7\u00e3o de esqueleto, ainda se encontram em processo de extens\u00e3o para 3D na USP).\nFoi feita tamb\u00e9m a extens\u00e3o dos programas vdist, vlabelexp e vwatersh para tratar imagens tridimensionais. Esta tarefa foi facilitada pelo fato da maior parte dos algoritmos utilizados no caso bidimensional serem baseados na fila de espera (ver discuss\u00e3o na se\u00e7\u00e3o 4.5 do cap\u00edtulo anterior). Quanto aos demais programas do n\u00edvel b\u00e1sico, n\u00e3o foi preciso fazer qualquer altera\u00e7\u00e3o, pois estes originalmente j\u00e1 tratavam imagens multi-bandas, que \u00e9 a mesma representa\u00e7\u00e3o utilizada para imagens 3D no Khoros.\nComo ilustra\u00e7\u00e3o das toolboxes MMACH e V3DTOOLS, vemos na fig. 5.2 um simples workspace que foi utilizado para gerar as imagens das ftgs. 3,8, 3.9, 3.10 e 3.11 do cap\u00edtulo 3. As rotinas vzbuff, visnorm e vshad, vistas na fig. 5.2, fazem parte da V3DTOOLS e foram utilizadas para gerar todas as visualiza\u00e7\u00f5es tridimensionais apresentadas neste trabalho. Note que para gerar as figuras do cap\u00edtulo 3 citadas acima, o workspace da fig. 5.2 precisa ser executado v\u00e1rias vezes, mudando-se o tipo de disco gerado pelo programa vgdisk e conectando-se em sequ\u00eancia as sa\u00eddas dos glyphs vero, vdil, vopen e vclose \u00e0 entrada do glyph vzbuff.\nFigura 5.2: Workspace para gerar as visualiza\u00e7\u00f5es tridimensionais do cap\u00edtulo 3\nA reconstru\u00e7\u00e3o volum\u00e9trica, tamb\u00e9m chamada de reconstru\u00e7\u00e3o tridimensional, consiste na forma\u00e7\u00e3o de um conjunto de dados que represente a estrutura tridimensional do objeto em estudo a partir de informa\u00e7\u00f5es bidimensionais do mesmo. A reconstru\u00e7\u00e3o 3D \u00e9 a etapa que obrigatoriamente antecede as opera\u00e7\u00f5es de visualiza\u00e7\u00e3o, manipula\u00e7\u00e3o e an\u00e1lise tridimensionais.\nDentre as v\u00e1rias t\u00e9cnicas existentes de reconstru\u00e7\u00e3o tridimensional [13, 33], u-tilizaremos aquela que \u00e9 a mais natural no contexto da representa\u00e7\u00e3o Voxel, que \u00e9 o empilhamento de se\u00e7\u00f5es consecutivas do objeto para formar uma matriz tridimensional que represente a estrutura 3D do objeto. Os principais t\u00f3picos que precisam ser levados em conta neste processo s\u00e3o basicamente tr\u00eas:\n-\tMetodologia de aquisi\u00e7\u00e3o das se\u00e7\u00f5es seriadas.\n-\tAlinhamento (registro) das se\u00e7\u00f5es seriadas.\n\u2014 Interpola\u00e7\u00e3o para obten\u00e7\u00e3o de volume isotr\u00f3pico.\nNas se\u00e7\u00f5es que se seguem abordaremos cada um dos itens acima.\n5.3.1\tAquisi\u00e7\u00e3o das se\u00e7\u00f5es seriadas\nComo j\u00e1 foi dito, utilizamos como objeto de estudo uma amostra experimental aproximadamente cil\u00edndrica de gesso contendo peda\u00e7os de giz de variadas formas e tamanhos. Com isto pretendeu-se modelar uma amostra real de rocha, onde a fase s\u00f3lida \u00e9 representada pelos peda\u00e7os de giz, e a fase porosa, pelo gesso.\nAs se\u00e7\u00f5es deste objeto foram digitalizadas da seguinte forma: envolveu-se a amostra com papel milimetrado, de forma a permitir, com o uso de uma lixa apropriada, ir se debastando o objeto na dire\u00e7\u00e3o de seu eixo principal. A intervalos de 2mm, medidos com o aux\u00edlio de um papel milimetrado afixado em volta do objeto, a amostra era colocada sobre um scanner e sua base (a se\u00e7\u00e3o corrente), digitalizada.\nAtrav\u00e9s do procedimento descrito acima, foram obtidas ao todo 32 se\u00e7\u00f5es do objeto. As imagens n\u00edvel-de-cinza resultantes, de dimens\u00f5es 256x256, apresentam resolu\u00e7\u00e3o\nComo podemos ver na figura 5.3, as se\u00e7\u00f5es se encontram desalinhadas, n\u00e3o s\u00f3 em rela\u00e7\u00e3o \u00e0 transla\u00e7\u00e3o e rota\u00e7\u00e3o mas tamb\u00e9m em rela\u00e7\u00e3o \u00e0 escala, diferentemente dos exemplos sint\u00e9ticos apresentados no cap\u00edtulo 2. Na se\u00e7\u00e3o que se segue, discutiremos a aplica\u00e7\u00e3o da t\u00e9cnica apresentada no cap\u00edtulo 2 para obter o registro das se\u00e7\u00f5es seriadas da amostra tridimensional em estudo.\n5.3.2\tRegistro das se\u00e7\u00f5es seriadas\nNesta se\u00e7\u00e3o apresentaremos os resultados obtidos com a aplica\u00e7\u00e3o do m\u00e9todo proposto no cap\u00edtulo 2 ao registro da se\u00e7\u00f5es seriadas da amostra experimental em estudo.\n0 primeiro problema a ser considerado \u00e9 o da uniformiza\u00e7\u00e3o de escala, pois devido a um indesej\u00e1vel problema de deriva no hardware de digitaliza\u00e7\u00e3o, constatou-se uma diferen\u00e7a consider\u00e1vel de magnifica\u00e7\u00e3o entre as se\u00e7\u00f5es. Um gr\u00e1fico da \u00e1rea percentual dos contornos preenchidos de cada se\u00e7\u00e3o (ver fig. 2.2 do cap\u00edtulo 2), que d\u00e1 uma id\u00e9ia da varia\u00e7\u00e3o de escala existente, pode ser visto na fig. 5.4. E interessante observar a diferen\u00e7a acentuada existente entre as se\u00e7\u00f5es 15 e 16, devido ao fato da aquisi\u00e7\u00e3o ter sido feita em dois dias diferentes, a primeira metade do modelo (se\u00e7\u00f5es 0 a 15) em um dia, a outra metade (se\u00e7\u00f5es 16 a 31), no outro.\nAplicamos a transforma\u00e7\u00e3o de escala como etapa de pr\u00e9-processamento, isto \u00e9, anteriormente \u00e0 obten\u00e7\u00e3o dos pontos rotulados, onde os par\u00e2metros de escala s\u00e3o obtidos conforme descrito na se\u00e7\u00e3o 2.3.1.2. A metodologia proposta naquela se\u00e7\u00e3o produziu uma uniformiza\u00e7\u00e3o de magnifica\u00e7\u00e3o bastante satisfat\u00f3ria, como pode ser visto no gr\u00e1fico da fig. 5.5\nAp\u00f3s ser feito o pr\u00e9-processamento para a uniformiza\u00e7\u00e3o da escala, foram selecionados os pontos rotulados sobre as se\u00e7\u00f5es e em seguida foram determinadas as transforma\u00e7\u00f5es de rota\u00e7\u00e3o e transla\u00e7\u00e3o, comparando os resultados obtidos pelo m\u00e9todo proposto no cap\u00edtulo 2 com o m\u00e9todo proposto por Merickel em [30].\nOs pontos rotulados foram obtidos manualmente, atrav\u00e9s do uso do programa\nFigura 5.3: Algumas se\u00e7\u00f5es da amostra experimental utilizada neste trabalho\nFigura 5.4: Varia\u00e7\u00e3o de magnitude nos dados originais\nFigura 5.5: Varia\u00e7\u00e3o de magnitude ap\u00f3s a aplica\u00e7\u00e3o da transforma\u00e7\u00e3o de escala\nAl\u00e9m do crit\u00e9rio do RMS, foi utilizado um crit\u00e9rio de similaridade entre as se\u00e7\u00f5es registradas, apesar de que, como a \u00fanica entrada para os m\u00e9todos de registro s\u00e3o os pontos rotulados, o RMS continua a representar o crit\u00e9rio de avalia\u00e7\u00e3o mais importante. O crit\u00e9rio de similaridade utiliza os contornos preenchidos de duas se\u00e7\u00f5es consecutivas Si e S2 (ver hg. 2.2 do cap\u00edtulo 2), e \u00e9 dado por:\nSIM = 100 x\nA(Si0S2) \\ a(S!) + a(s2);\n(5-1)\nonde A(S) denota a \u00e1rea percentual do contorno preenchido S, enquanto que 0 denota a opera\u00e7\u00e3o l\u00f3gica OU exclusivo (Note que Sj e S2 s\u00e3o imagens bin\u00e1rias). O crit\u00e9rio SIM \u00e9 portanto percentual, isto \u00e9, 0 significa uma situa\u00e7\u00e3o de registro nulo e 100 indica uma situa\u00e7\u00e3o de registro total.\nOs resultados obtidos, tanto pelo uso de nosso m\u00e9todo, proposto no cap\u00edtulo 2, quanto pelo uso do m\u00e9todo de Merickel foram avaliados utilizando o crit\u00e9rio do RMS m\u00e9dio e do SIM m\u00e9dio calculados sobre os 31 pares de se\u00e7\u00f5es consecutivas do modelo. O resultado obtido pode ser visto nas tabelas 5.1 e 5.2 abaixo.\nN\u00famero de pontos\tR-MS m\u00e9dio\t^^m\u00e9dio\n2\t0.92193\t99.1886\n3\t1.97751\t98.9232\n4\t2.73808\t98.8266\n5\t2.92715\t98.7200\nTabela 5.1: Resultados do registro das se\u00e7\u00f5es do modelo 3D ~ m\u00e9todo proposto\nAnalisando os resultados das tabelas 5.1 e 5.2, constatamos que o RMS m\u00e9dio, para ambos os m\u00e9todos, resultou em uma fun\u00e7\u00e3o crescente com o n\u00famero de pontos, enquanto que o SIM m\u00e9dio apresentou um comportamento decrescente. Lembrando que o\nN\u00famero de pontos\tm\u00e9dio\tSl^m\u00e9dio\n2\t0.92664\t99.1364\n3\t2.00743\t99.0139\n4\t2.78560\t98.8435\n5\t2.95856\t98.6778\nTabela 5.2: Resultados do registro das se\u00e7\u00f5es do modelo 3D - m\u00e9todo de Merickel\nRMS \u00e9 um crit\u00e9rio de erro (quanto menor, melhor) enquanto que o SIM representa um crit\u00e9rio de acerto (quanto maior, melhor), conclu\u00edmos que o melhor resultado em ambos os casos \u00e9 obtido com apenas dois pontos rotulados, o que pode ser explicado pelo fato de se ter introduzido apenas duas marcas ftduciais, levando assim \u00e0 obten\u00e7\u00e3o de apenas dois pontos confi\u00e1veis, isto \u00e9, menos sujeitos a erros operador na sele\u00e7\u00e3o manual dos mesmos.\nA respeito da compara\u00e7\u00e3o entre as duas metodologias, podemos constatar que segundo o RMS m\u00e9dio, o m\u00e9todo proposto foi superior ao de Merickel em todos os casos. J\u00e1 quanto ao crit\u00e9rio do SIM m\u00e9dio, h\u00e1 oscila\u00e7\u00f5es entre os dois m\u00e9todos, mas o melhor resultado global (99,1886%) \u00e9 atingido pelo m\u00e9todo proposto para o caso de dois pontos rotulados, caso que apresenta tamb\u00e9m o melhor resultado quanto ao RMS m\u00e9dio.\nBaseado na an\u00e1lise dos resultados feita acima, adotamos ent\u00e3o o resultado de registro conseguido pelo nosso m\u00e9todo utilizando dois pontos rotulados. Na fig. 5.6 vemos as mesmas se\u00e7\u00f5es apresentadas na fig. 5.3 ap\u00f3s passarem pelo processo de registro (aplica\u00e7\u00e3o das transforma\u00e7\u00f5es de escala, rota\u00e7\u00e3o e transla\u00e7\u00e3o) utilizando o m\u00e9todo proposto.\n5.3.3\tInterpola\u00e7\u00e3o Volum\u00e9trica\nPara obtermos uma representa\u00e7\u00e3o 3 D satisfat\u00f3ria do objeto em estudo, que possibilite a visualiza\u00e7\u00e3o e an\u00e1lise tridimensionais do mesmo, o passo seguinte \u00e9 a interpola\u00e7\u00e3o volum\u00e9trica das se\u00e7\u00f5es registradas.\nEste processo consiste em um processamento dos dados de forma a obter um volume is o tr\u00f3pico, isto \u00e9, que apresente idealmente a mesma resolu\u00e7\u00e3o nas tr\u00eas dimens\u00f5es. Normalmente a resolu\u00e7\u00e3o entre a se\u00e7\u00f5es \u00e9 menor que a resolu\u00e7\u00e3o dos pixels que comp\u00f5em as\nFigura 5.6: As se\u00e7\u00f5es da fig. 5.3 ap\u00f3s aplicada a transforma\u00e7\u00e3o de registro segundo o m\u00e9todo proposto\nDa discuss\u00e3o acima, conclu\u00edmos que sendo e a resolu\u00e7\u00e3o original entre as se\u00e7\u00f5es\ne d a resolu\u00e7\u00e3o dos pixels (isotr\u00f3picos) das se\u00e7\u00f5es, o n\u00famero s de se\u00e7\u00f5es intermedi\u00e1rias a\nserem estimadas \u00e9 dado por:\n(5.2)\nonde denotamos por \u201cround\u201d a fun\u00e7\u00e3o que devolve o inteiro mais pr\u00f3ximo. Sendo n, o n\u00famero original de se\u00e7\u00f5es, o n\u00famero n0 de se\u00e7\u00f5es obtidas ap\u00f3s a interpola\u00e7\u00e3o \u00e9 ent\u00e3o dado\npor:\nna = s x (ni - 1) + n-i\n(5.3)\nExistem na literatura diversos m\u00e9todos para a estima\u00e7\u00e3o das se\u00e7\u00f5es intermedi\u00e1rias. Podemos classificar estes m\u00e9todos em tr\u00eas categorias principais:\n-\tInterpola\u00e7\u00e3o n\u00edvel-de-cinza: Este \u00e9 o m\u00e9todo tradicional de interpola\u00e7\u00e3o. Consiste na estima\u00e7\u00e3o de valores n\u00edvel-de-cinza para as se\u00e7\u00f5es intermedi\u00e1rias a partir dos valores presentes em se\u00e7\u00f5es vizinhas [20]. As fun\u00e7\u00f5es de estima\u00e7\u00e3o mais comuns s\u00e3o de ordem 0 (replica\u00e7\u00e3o das se\u00e7\u00f5es), linear e c\u00fabica.\n-\tInterpola\u00e7\u00e3o n\u00edvel-de-cinza via FFT: Os m\u00e9todos tradicionais de interpola\u00e7\u00e3o n\u00edvel-de-cinza podem ser vistos como processos de convolu\u00e7\u00e3o no dom\u00ednio espacial. Os m\u00e9todos de interpola\u00e7\u00e3o via FFT obt\u00eam o mesmo resultado no dom\u00ednio da frequ\u00eancia, se valendo para isto do teorema da convolu\u00e7\u00e3o [12]. Os tipos de fun\u00e7\u00e3o de estima\u00e7\u00e3o utilizados n\u00e3o precisam se limitar aos mencionados no item anterior, resultando assim em uma metodologia bem mais geral.\n-\tInterpola\u00e7\u00e3o baseada em forma: Diferentemente das anteriores, esta t\u00e9cnica se aplica a se\u00e7\u00f5es bin\u00e1rias. O tipo de interpola\u00e7\u00e3o conseguido por\u00e9m \u00e9 mais preciso que a maioria dos m\u00e9todos de interpola\u00e7\u00e3o n\u00edvel-de-cinza [41, 20] (no momento, n\u00e3o h\u00e1 resultados quanto a compara\u00e7\u00e3o com a interpola\u00e7\u00e3o pela FFT).\nNeste trabalho, escolhemos a interpola\u00e7\u00e3o baseada em forma como m\u00e9todo de estima\u00e7\u00e3o das se\u00e7\u00f5es intermedi\u00e1rias. Como a segmenta\u00e7\u00e3o das se\u00e7\u00f5es n\u00edvel-de-cinza nas fases s\u00f3lida e porosa \u00e9 uma etapa que ter\u00e1 de ser considerada mais cedo ou mais tarde, \u00e9 bem mais eficiente realiz\u00e1-la diretamente sobre as se\u00e7\u00f5es registradas originais, anteriormente \u00e0 interpola\u00e7\u00e3o. Al\u00e9m disso, como j\u00e1 foi dito, a interpola\u00e7\u00e3o baseada em forma das se\u00e7\u00f5es j\u00e1 segmentadas produz um resultado mais preciso do aquele conseguido com a interpola\u00e7\u00e3o do volume n\u00edvel-de-cinza seguida de segmenta\u00e7\u00e3o, o que \u00e9 um aspecto muito importante para a etapa posterior de an\u00e1lise.\nNas se\u00e7\u00f5es que se seguem, descreveremos o processo de segmenta\u00e7\u00e3o utilizado e a interpola\u00e7\u00e3o baseada em forma.\n5.3.3.1\tSegmenta\u00e7\u00e3o das fases s\u00f3lida e porosa\nPara se obter a segmenta\u00e7\u00e3o das se\u00e7\u00f5es registradas n\u00edvel-de-cinza da amostra experimental, foi utilizado basicamente um processo de limiariza\u00e7\u00e3o seguido de filtragem das imagens bin\u00e1rias resultantes. Na fig. 5.7-a vemos uma das se\u00e7\u00f5es do modelo, que ser\u00e1 utilizada como exemplo para ilustrar as diversas etapas do processo de segmenta\u00e7\u00e3o descrito nesta se\u00e7\u00e3o.\nO processo de limiariza\u00e7\u00e3o n\u00e3o \u00e9 t\u00e3o simples quanto possa parecer \u00e0 primeira vista, devido \u00e0 dificuldade introduzida pelo papel milimetrado que foi colocado em volta do objeto quando da aquisi\u00e7\u00e3o (ver se\u00e7\u00e3o 5.3.1). Uma limiariza\u00e7\u00e3o simples produz um resultado indesej\u00e1vel, como pode ser visto na fig. 5.7-b.\nA solu\u00e7\u00e3o \u00e9 utilizar uma limiariza\u00e7\u00e3o adaptativa^ implementada pelo programa vthreshad (n\u00edvel b\u00e1sico da MMACH). A limiariza\u00e7\u00e3o adaptativa \u00e9 uma transforma\u00e7\u00e3o que leva de uma imagem n\u00edvel-de-cinza em uma imagem bin\u00e1ria, mas, diferentemente da limiariza\u00e7\u00e3o simples, a imagem n\u00edvel-de-cinza original f \u00e9 comparada n\u00e3o com valores constantes mas com outras imagens n\u00edvel-de-cinza fa e /2 (chamadas aqui de \u201cimagens limitantes\u201d):\nVh.hU'l =\t\u20ac E | /i(u) &lt;f(u) &lt;/s(u)}\t(5.4)\nnote que se as imagens limitantes forem constantes, a limiariza\u00e7\u00e3o adaptativa se reduz \u00e0 limiariza\u00e7\u00e3o simples.\nFigura 5.7: Processo de segmenta\u00e7\u00e3o das fases s\u00f3lida e porosa, (a) Se\u00e7\u00e3o n\u00edvel-de-cinza original (b) Resultado indesej\u00e1vel obtido por limiariza\u00e7ao simples (c) Imagem limitante (d) Resultado da limiariza\u00e7ao adaptativa (e) Filtragem da imagem do item d (fase s\u00f3lida) (f) Subtra\u00e7\u00e3o das imagens do itens cee (fase porosa)\nNo nosso caso, utilizamos um valor constante como limiar superior e uma imagem limitante como limiar inferior, a qual \u00e9 obtida atrav\u00e9s de uma limiariza\u00e7\u00e3o simples para segmentar o fundo seguida de uma pequena dilata\u00e7\u00e3o, o que produz a imagem vista na fig. 5.7-c (Note que esta \u00e9 interpretada como uma imagem n\u00edvel-de-cinza, onde o preto corresponde ao valor zero e o branco, ao valor 255). O resultado da limiariza\u00e7\u00e3o adptativa pode ser visto na fig. 5.7-d.\nProblemas de ruido, causado principalmente por um fino p\u00f3 que se depositou sobre as se\u00e7\u00f5es do objeto devido ao processo de debasta\u00e7\u00e3o (ver se\u00e7\u00e3o 5.3.1), tornam necess\u00e1rio introduzir tamb\u00e9m uma filtragem da imagem bin\u00e1ria resultante da limiariza\u00e7\u00e3o adaptativa. Esta filtragem consiste em um fechamento seguido por uma abertura com um pequeno elemento estruturante 3x3, opera\u00e7\u00e3o implementada pelo programa vnco\u00f1lt (segundo n\u00edvel da MMACH). 0 resultado conseguido, bastante satisfat\u00f3rio, \u00e9 mostrado na fig. 5.7-e. Esta imagem j\u00e1 corresponde \u00e0 se\u00e7\u00e3o da fase s\u00f3lida da amostra experimental.\nA fase porosa \u00e9 obtida fazendo a subtra\u00e7\u00e3o (programa vsubm, n\u00edvel b\u00e1sico da MMACH) da imagem dos gr\u00e3os da imagem obtida pela invers\u00e3o da imagem limitante utilizada na limiariza\u00e7\u00e3o adaptativa, o que produz o resultado da fig. 5.7-e (note que a imagem limitante passa a ser interpretada neste caso como uma imagem bin\u00e1ria).\n5.3.3.2\tInterpola\u00e7\u00e3o baseada em forma\nUma vez que o processo descrito na se\u00e7\u00e3o anterior tenha sido aplicado para cada se\u00e7\u00e3o registrada da amostra experimental, o passo seguinte \u00e9 aplicar a interpola\u00e7\u00e3o baseada em forma de maneira a obter dois volumes isotr\u00f3picos, correspondentes \u00e0s fases s\u00f3lida e porosa da amostra experimental.\nA interpola\u00e7\u00e3o baseada em forma, introduzida por S. Raya e J. Udupa [41], \u00e9 um esquema de interpola\u00e7\u00e3o que pode ser resumido da seguinte forma:\n\u2014 Encontre a transformada de dist\u00e2ncia das se\u00e7\u00f5es previamente segmentadas.\n- Aplique algum esquema de interpola\u00e7\u00e3o n\u00edvel-de-cinza (tradicional ou via FFT) no volume formado pelas se\u00e7\u00f5es do item anterior.\nA fun\u00e7\u00e3o dist\u00e2ncia utilizada \u00e9 diferente daquela definida na se\u00e7\u00e3o 4.2.2 do cap\u00edtulo anterior, pois atribui tamb\u00e9m valores de dist\u00e2ncia (negativos) ao fundo da imagem. Dado um objeto A \u20ac P(E) temos:\nMu) =&lt;\nd(w, Ac)\n-d(u, A)\nse u \u20ac A se u \u20ac Ac\n(5.5)\nVu \u20ac E\nA fun\u00e7\u00e3o dist\u00e2ncia definida acima pode entretanto ser obtida facilmente a partir da definida anteriormente:\n/d(A) = fd(A) 4- (-/d(Ac))\n(5-6)\nAp\u00f3s aplicado um esquema de interpola\u00e7\u00e3o n\u00edvel-de-cinza qualquer, obt\u00e9m-se um volume Feo volume bin\u00e1rio interpolado procurado \u00e9 dado pelo conjunto de voxels {u | F(u) > 0}.\nNo nosso caso, utilizando os dados apresentados na se\u00e7\u00e3o 5.3.1 e as equa\u00e7\u00f5es\n(5.2)\te (5.3), conclu\u00edmos que \u00e9 necess\u00e1rio estimar 6 novas se\u00e7\u00f5es entre as se\u00e7\u00f5es registradas da amostra experimental, resultando em um volume com 218 se\u00e7\u00f5es. Considerando que o espa\u00e7amento entre as se\u00e7\u00f5es era originalmente de 2mm, a resolu\u00e7\u00e3o na dire\u00e7\u00e3o z do volume interpolado passa a ser de aproximadamente 285,714//m, muito pr\u00f3xima portanto da resolu\u00e7\u00e3o nas dire\u00e7\u00f5es x e y, de 280/rm (ver se\u00e7\u00e3o 5.3.1).\nPara ilustrar o efeito da etapa de interpola\u00e7\u00e3o volum\u00e9trica, apresentamos nas figs. 5.8 e 5.9 visualiza\u00e7\u00f5es dos volumes correspondentes respectivamente \u00e0 fase s\u00f3lida (gr\u00e3os) e \u00e0 fase porosa, comparando os resultados conseguidos antes e ap\u00f3s a interpola\u00e7\u00e3o baseada em forma.\n5.4\tAtributos de an\u00e1lise para caracteriza\u00e7\u00e3o de meio poroso\nUma vez que os objetos de interesse, as fases s\u00f3lida e porosa da amostra experimental, se encontram dispon\u00edveis ap\u00f3s a etapa de reconstru\u00e7\u00e3o tridimensional, o passo\nFigura 5.8: Visualiza\u00e7\u00e3o da fase s\u00f3lida (a) antes da interpola\u00e7\u00e3o (b) ap\u00f3s a interpola\u00e7\u00e3o\nFigura 5.9: Visualiza\u00e7\u00e3o da fase porosa (a) antes da interpola\u00e7\u00e3o (b) ap\u00f3s a interpola\u00e7\u00e3o\nEnumeramos a seguir os atributos que foram considerados neste trabalho, os quais julgamos constitu\u00edrem um conjunto representativo para uma caracteriza\u00e7\u00e3o da amostra experimental em estudo.\n-\tMedidas de car\u00e1ter geral\n\u2022\tVolume da fase s\u00f3lida, Vs\n\u2022\tVolume da fase porosa, Vp\n\u2022\tFra\u00e7\u00e3o em volume dos poros (porosidade), p\n\u2022\t\u00c1rea da superf\u00edcie de interface porosa/s\u00f3lida, Sps\n\u2022\tQuantidade de gr\u00e3os na fase s\u00f3lida, ns\n\u2022\tVolume m\u00e9dio do gr\u00e3o,\n-\tAn\u00e1lise Granulom\u00e9trica\n\u2022\tEspectro de padr\u00f5es morfol\u00f3gico para a fase s\u00f3lida, T\u00e2m(r)\n\u2022\tRaio m\u00e9dio do gr\u00e3o segundo a granulometria morfol\u00f3gica,\n\u2022\tEspectro de padr\u00f5es geod\u00e9sico para a fase s\u00f3lida, F^(r)\n\u2022\tRaio m\u00e9dio do gr\u00e3o segundo a granulometria geod\u00e9sica,\n\u2022\tEspectro de padr\u00f5es morfol\u00f3gico para a fase porosa, Ppm(r)\n\u2022\tRaio m\u00e9dio do poro segundo a granulometria morfol\u00f3gica,\n-\tAn\u00e1lise das Gargantas\n\u2022\tHistograma de gargantas dos gr\u00e3os, A5(r)\n\u2022\tTamanho m\u00e9dio da garganta do gr\u00e3o,\n\u2022\tHistograma de gargantas dos poros, Ap(r)\n\u2022\tTamanho m\u00e9dio da garganta do poro,\nNas se\u00e7\u00f5es seguintes apresentaremos os resultados obtidos para os atributos listados acima.\n5.4.1\tMedidas de car\u00e1ter geral\nPara o c\u00e1lculo de volumes, n\u00e3o h\u00e1 maior problema, pois basta contar o n\u00famero n de voxels pertencentes ao objeto A e multiplicar pelo volume do voxel unit\u00e1rio Vo:\nvol(A) = n x Vo\t(5.7)\nonde Vo pode ser calculado a partir dos valores de resolu\u00e7\u00e3o nas dire\u00e7\u00f5es y e z, apresentados na se\u00e7\u00e3o 5.3:\nVo = 280pm x 280pm x 285,714pm = 0,0224mm3\nDesta forma, obtivemos para os volumes totais das fases s\u00f3lida e porosa:\nVa = 5.106.748 x Vo - 114,391cm3\nVP = 3.938.104 x Vo \u2014 88,214cm3\nDas medidas acima, obtemos diretamente a porosidade:\nV\nn =\t= o,435\nV + vp\nJ\u00e1 o c\u00e1lculo de \u00e1reas constitui um problema delicado, pois todo objeto repre-sent\u00e1vel no espa\u00e7o voxel \u00e9 necessariamente volum\u00e9trico. Uma \u201csuperf\u00edcie\u201d no espa\u00e7o voxel \u00e9 portanto apenas uma aproxima\u00e7\u00e3o de uma superf\u00edcie real, consistindo na verdade de um objeto tridimensional com espessura de poucos voxels, usualmente apenas um.\nUma poss\u00edvel solu\u00e7\u00e3o para o problema seria somar as \u00e1reas das faces dos voxels pertencentes \u00e0 \u201csuperf\u00edcie\u201d. Uma solu\u00e7\u00e3o mais objetiva [32], a qual adotamos, \u00e9 calcular o volume da \u201csuperf\u00edcie\u201d S e dividir por um par\u00e2metro linear que indique sua espessura:\n\u00e1rea(S) = ^\u00bf1\t(5.8)\nNo nosso caso, a superf\u00edcie de interface entre as fases s\u00f3lida e porosa \u00e9 obtida atrav\u00e9s de uma opera\u00e7\u00e3o de gradiente morfol\u00f3gico (ver se\u00e7\u00e3o 3.3.2). O par\u00e2metro de espessura neste caso \u00e9 dado pelo di\u00e2metro do elemento estruturante usado (observamos que\nvol(rs(S))\ne(S)\n1.487.190 x Vo\n3 x 0,280mm\n= 396,584cm2\nPara a determina\u00e7\u00e3o do n\u00famero de gr\u00e3os, \u00e9 necess\u00e1rio primeiramente fazer a segmenta\u00e7\u00e3o binaria 3D da fase s\u00f3lida, a qual se encontra quase totalmente conectada (ver fig. 5.11 na se\u00e7\u00e3o seguinte). Para obter a segmenta\u00e7\u00e3o bin\u00e1ria 3D utilizamos os watersheds, conforme apresentado no cap\u00edtulo anterior (ver se\u00e7\u00e3o 4.2.2). A fun\u00e7\u00e3o distancia euclidiana tridimensional \u00e9 computada e em seguida \u00e9 feita a mudan\u00e7a de homotopia da mesma, utilizando um conjunto de marcadores 3D.\nNa obten\u00e7\u00e3o dos marcadores consideramos duas possibilidades: o m\u00e9todo dos \u201cm\u00e1ximos filtrados\u201d e a sele\u00e7\u00e3o manual (ver se\u00e7\u00e3o 4.2.2). Da mesma forma que ocorreu com o caso bidimensional apresentado no cap\u00edtulo anterior, os m\u00e1ximos filtrados produziram um resultado subsegmentado, onde os gr\u00e3os de pequenas dimens\u00f5es n\u00e3o s\u00e3o separados de seus vizinhos devido \u00e0 n\u00e3o obten\u00e7\u00e3o de marcadores para eles. Isto n\u00e3o ocorreu na sele\u00e7\u00e3o manual, onde \u00e9 poss\u00edvel fornecer marcadores para todos os gr\u00e3os.\nEntretanto, constatou-se que as fronteiras entre os gr\u00e3os obtidas com o m\u00e9todo dos m\u00e1ximos filtrados foram bem melhor determinadas do que com a sele\u00e7\u00e3o manual dos marcadores. Isto ocorre devido \u00e0 dificuldade em selecionar manualmente pontos em uma imagem tridimensional, pois os dispositivos de intera\u00e7\u00e3o com o usu\u00e1rio dispon\u00edveis atualmente s\u00e3o bidimensionais. Utilizando a ferramenta markimage, foi necess\u00e1rio fazer uma inspe\u00e7\u00e3o 2D se\u00e7\u00e3o por se\u00e7\u00e3o do volume, o que levou a marcadores que nem sempre estavam bem posicionados tridimensionalmente dentro dos gr\u00e3os, produzindo como consequ\u00eancia fronteiras pobremente localizadas. O m\u00e9todo dos m\u00e1ximos filtrados, por outro lado, funciona da mesma forma no caso 3D que no caso 2D, ou na verdade qualquer outra dimens\u00e3o. O m\u00e9todo dos m\u00e1ximos filtrados corresponderia em uma analogia a um operador que possui um dispositivo de intera\u00e7\u00e3o n~ dimensional, podendo localizar os marcadores perfeitamente na imagem, mas que em compensa\u00e7\u00e3o \u00e9 um pouco m\u00edope e n\u00e3o enxerga os gr\u00e3os menores.\n= 342 gr\u00e3os\nCom este resultado podemos obter de imediato o \u00faltimo atributo desta se\u00e7\u00e3o, o volume m\u00e9dio do gr\u00e3o:\n= 0,334cm3\nn8\n5.4.2\tAn\u00e1lise Granulom\u00e9trica\nNesta se\u00e7\u00e3o apresentamos os espectros de padr\u00f5es associados \u00e0s fases s\u00f3lida e porosa da amostra experimental, al\u00e9m dos raios m\u00e9dios correspondentes a estas distribui\u00e7\u00f5es, utilizando as granul\u00f3me!rias morfol\u00f3gica e geod\u00e9sica desenvolvidas no cap\u00edtulo anterior (ver se\u00e7\u00e3o 4.3). Utilizaremos como elementos estruturantes os tr\u00eas tipos de discos digitais introduzidos na se\u00e7\u00e3o 3.2.3, de maneira a obter diferentes informa\u00e7\u00f5es de forma, conforme discutido na se\u00e7\u00e3o 4.3.2. Como foi mencionado na introdu\u00e7\u00e3o deste cap\u00edtulo, a an\u00e1lise granulom\u00e9trica do meio poroso produz interpreta\u00e7\u00f5es importantes na determina\u00e7\u00e3o de processos de invas\u00e3o ou drenagem por fluidos, pois fornece informa\u00e7\u00e3o sobre os aspectos morfol\u00f3gicos (tamanho e forma) dos poros e gr\u00e3os presentes no meio.\nNa flg. 5.10 vemos os espectros de padr\u00f5es morfol\u00f3gicos Tam(r), associados \u00e0 fase s\u00f3lida, utilizando cada um dos discos digitais.\nPara computar os espectros de padr\u00f5es geod\u00e9sicos, utilizamos a segmenta\u00e7\u00e3o bin\u00e1ria com o uso dos marcadores dos m\u00e1ximos filtrados, conforme vimos na se\u00e7\u00e3o anterior. Na fig. 5.11 temos uma visualiza\u00e7\u00e3o da rotula\u00e7\u00e3o da fase s\u00f3lida antes e ap\u00f3s a segmenta\u00e7\u00e3o (note como antes da segmenta\u00e7\u00e3o a fase s\u00f3lida se encontra quase totalmente conectada). Na fig. 5.12 vemos ent\u00e3o os espectros de padr\u00f5es geod\u00e9sicos P\u00e2p(r) obtidos para a fase s\u00f3lida, variando o tipo de disco digital utilizado.\n(a)\t(b)\n(c)\nFigura 5.11: Rotula\u00e7\u00e3o com vizinhan\u00e7a 6 da fase s\u00f3lida (a) antes e (b) ap\u00f3s a segmenta\u00e7\u00e3o bin\u00e1ria com o m\u00e9todo dos marcadores filtrados\nO \u00faltimo caso corresponde aos espectros de padr\u00f5es morfol\u00f3gicos Fpm(r), associados \u00e0 fase porosa, os quais podemos ver na hg. 5.13.\nLembramos que o eixo horizontal (raio do disco digital) nos gr\u00e1ficos correspondentes aos espectros de padr\u00f5es acima \u00e9 adimensional, isto \u00e9, exprime o raio como n\u00famero de voxels. J\u00e1 na determina\u00e7\u00e3o dos raios m\u00e9dios, os valores adimensionais obtidos atrav\u00e9s da eq. (4.11) do cap\u00edtulo anterior s\u00e3o apresentados na tabela 5.3 e ao lado de cada um, entre par\u00eanteses, encontra-se o valor em mm obtido pela multiplica\u00e7\u00e3o pelo lado m\u00e9dio do voxel (aproximadamente 280/2m) de modo a obter um valor com significado f\u00edsico em rela\u00e7\u00e3o \u00e0 amostra em estudo.\n\u00c9 preciso compreender que os valores expressos na tabela acima s\u00e3o fun\u00e7\u00e3o da m\u00e9trica associada a cada disco digital. Assim, os raios m\u00e9dios segundo a m\u00e9trica do m\u00e1ximo s\u00e3o subestimados em rela\u00e7\u00e3o \u00e0 m\u00e9trica euclidiana, enquanto que os raios segundo a m\u00e9trica do quarteir\u00e3o s\u00e3o super-estimados, em acord\u00e2ncia com as eqs. (3.7)e(3.9)do cap\u00edtulo 3. Na verdade, o que est\u00e1 em jogo \u00e9 o conceito de forma, pois n\u00e3o se est\u00e1 limitado ao uso dos discos digitais como elementos estruturantes; utilizando outros tipos de elementos estruturantes,\n(a)\t(b)\n(c)\n(a)\t(b)\nPar\u00e2metro\tDisco do quarteir\u00e3o\tDisco euclidiano\tDisco do m\u00e1ximo\nr99 Tpm\t10.514 (2.944) 12.795 (3.583) 7.571 (2.120)\t9.053 (2.535) 10.596 (2.967) 6.277 (1.758)\t5.794 (1.622) 7.143 (2-000) 4.122 (1-154)\nTabela 5.3: Raios m\u00e9dios segundo os diversos discos digitais utilizados (valores em mm entre par\u00eanteses)\nem associa\u00e7\u00e3o com um conceito apropriado de tamanho como aquele apresentado na eq. (4.16) do cap\u00edtulo anterior, \u00e9 poss\u00edvel obter espectros de padr\u00f5es e raios m\u00e9dios associados distintos para cada caso, o que \u00e9 uma vantagem, pois permite justamente explorar o conceito de forma, como j\u00e1 foi dito antes.\nPor fim, observamos que, como era de se esperar em um estudo de uma amostra real, os espectros de padr\u00f5es apresentaram quase todos um comportamento muito pr\u00f3ximo de uma distribui\u00e7\u00e3o normal, o que podemos comprovar n\u00e3o s\u00f3 examinando a forma das curvas, mas tamb\u00e9m comparando os valores adimensionais do raio m\u00e9dio com os valores m\u00e1ximos dos espectros correspondentes, que coincidem bem. A excess\u00e3o s\u00e3o os espectros geod\u00e9sicos correspondentes aos discos do quarteir\u00e3o e euclidiano, o que pode ser explicado por problemas de subsegmenta\u00e7\u00e3o devido \u00e0 utiliza\u00e7\u00e3o dos m\u00e1ximos filtrados como marcadores (ver discuss\u00e3o na se\u00e7\u00e3o 5.4.1 acima). E interessante comparar este comportamento \u201cnormal\u201d com o comportamento multi-modal apresentado pelos espectros de padr\u00f5es bidimensionais obtidos no cap\u00edtulo anterior. Esta diferen\u00e7a se explica pelo fato da imagem tomada como exemplo naquele cap\u00edtulo n\u00e3o representar na realidade um objeto bidimensional real, mas apenas uma se\u00e7\u00e3o de um objeto tridimensional, este sim real. Isto ilustra o tipo de dificuldade que os m\u00e9todos de corre\u00e7\u00e3o estereom\u00e9trica enfrentam na estima\u00e7\u00e3o dos atributos f\u00edsicos reais a partir de se\u00e7\u00f5es bidimensionais.\n5.4.3\tAn\u00e1lise das Gargantas\nComo dissemos na introdu\u00e7\u00e3o, a an\u00e1lise da distribui\u00e7\u00e3o de gargantas em um meio poroso constitui uma medida muito \u00fatil, pois as gargantas presentes na fase porosa possuem uma influ\u00eancia acentuada nos processos de invas\u00e3o ou drenagem, devido \u00e0 restri\u00e7\u00e3o\nque elas representam ao escoamento de um fluido.\nNas hgs. 5.14 e 5.15 vemos os histogramas correspondentes respectivamente \u00e0s fases s\u00f3lida e porosa, enquanto que na tabela 5.4 encontram-se os tamanhos m\u00e9dios associados.\nRessaltamos que, embora normalmente os tamanhos m\u00e9dios sejam par\u00e2metros adimensionais (segundo o conceito de tamanho introduzido na se\u00e7\u00e3o 4.4 do cap\u00edtulo anterior), os elementos estruturantes utilizados induzem as m\u00e9tricas do quarteir\u00e3o e do m\u00e1ximo (ver eqs. (3.28) e (3.29) do cap\u00edtulo 3), e portanto permitem uma interpreta\u00e7\u00e3o em termos de raio m\u00e9dio das gargantas, em rela\u00e7\u00e3o a estas m\u00e9tricas. Desta forma, \u00e0 maneira da tabela 5.3 na se\u00e7\u00e3o anterior, os valores na tabela 5.4 foram multiplicados pelo lado m\u00e9dio do voxel de forma a obter medidas f\u00edsicas em rela\u00e7\u00e3o \u00e0 amostra, sendo este resultado apresentado entre par\u00eanteses ao lado do valor original.\nPar\u00e2metro\tDisco unit\u00e1rio do quarteir\u00e3o\tDisco unit\u00e1rio do m\u00e1ximo\n\t8.085 (2.264)\t4.161 (1.165)\n\t5.579 (1.562)\t2.938 (0.823)\nTabela 5.4: Tamanhos m\u00e9dios segundo os dois elementos estruturantes utilizados (valores em mm entre par\u00eanteses)\nNotamos que, de maneira similar aos espectros de padr\u00f5es, os histogramas de gargantas apresentaram um comportamente nitidamente \u201cnormal\u201d, n\u00e3o s\u00f3 na forma das curvas, mas tamb\u00e9m pela proximidade dos valores de tamanho m\u00e9dio em rela\u00e7\u00e3o aos valores m\u00e1ximos das curvas.\n(a)\t(b)\nFigura 5.14: Histogramas de gargantas associados \u00e0 fase s\u00f3lida utilizando como elemento estruturante primitivo disco unit\u00e1rio (a) do quarteir\u00e3o (b) do m\u00e1ximo\nFigura 5.15: Histogramas de gargantas associados \u00e0 fase porosa utilizando como elemento estruturante primitivo disco unit\u00e1rio (a) do quarteir\u00e3o (b) do m\u00e1ximo\nCap\u00edtulo 6\nConclus\u00e3o\nOs m\u00e9todos tridimensionais para o processamento e an\u00e1lise de imagens constituem de fato uma tecnologia muito \u00fatil, pois ao lidar diretamente com a estrutura 3D real dos objetos de interesse \u00e9 capaz de simplificar e otimizar o trabalho humano em tarefas de quantifica\u00e7\u00e3o e avalia\u00e7\u00e3o de imagens, al\u00e9m de produzir resultados precisos, confi\u00e1veis e eficientes.\nProcurou-se mostrar neste trabalho o \u201cestado da arte\u201d no campo da reconstru\u00e7\u00e3o volum\u00e9trica e da an\u00e1lise tridimensional por Morfologia Matem\u00e1tica. Julgamos tamb\u00e9m que as ferramentas apresentadas, incluindo as granulometrias geod\u00e9sicas e o histograma de gargantas, contribui\u00e7\u00f5es originais deste trabalho, constituem um conjunto eficaz para a aplica\u00e7\u00e3o em problemas pr\u00e1ticos do mundo real, como o demonstrou a caracteriza\u00e7\u00e3o da amostra experimental porosa realizada.\nUma contrapartida \u00e9 a grande quantidade de mem\u00f3ria e processamento requeridos pelas ferramentas de processamento e an\u00e1lise tridimensionais. A amostra experimental utilizada neste trabalho, por exemplo, constitui-se (ap\u00f3s interpolada) de 218 se\u00e7\u00f5es n\u00edvel-de-cinza de dimens\u00f5es 256x256, como foi visto. Isto corresponde a aproximadamente 14.2 Mb de mem\u00f3ria. Algumas ferramentas, como a fun\u00e7\u00e3o dist\u00e2ncia, os waterhseds e a rotu-la\u00e7\u00e3o, exigem representa\u00e7\u00f5es do tipo short (dois bytes), duplicando o espa\u00e7o em mem\u00f3ria requerido. Al\u00e9m disso, v\u00e1rios algoritmos utilizados na implementa\u00e7\u00e3o destas ferramentas utilizam imagens internas de trabalho e, como foi comentado no cap\u00edtulo 4, as filas de espera utilizadas podem chegar a utilizar um espa\u00e7o de mem\u00f3ria duas vezes maior que o ocupado\npela imagem original. 0 resultado de tudo isto \u00e9 que o espa\u00e7o de mem\u00f3ria em RAM requerido para rodar determinados programas pode atingir facilmente a casa de centenas de Mb. Apesar disto foi poss\u00edvel obter os resultados apresentados neste trabalho, utilizando para isto urna m\u00e1quina muito poderosa, urna RISO de alto desempenho com 256 Mb de mem\u00f3ria RAM, baseada no Centro de Computa\u00e7\u00e3o da Unicamp.\nUma outra conclus\u00e3o a que chegamos \u00e9 sobre a import\u00e2ncia do processo de aquisi\u00e7\u00e3o dos objetos de interesse. E preciso ter um controle muito preciso sobre o m\u00e9todo de fatiamento da amostra, selecionando corretamente a dist\u00e2ncia entre as se\u00e7\u00f5es e garantindo tanto quanto poss\u00edvel o paralelismo entre as mesmas. Uma aquisi\u00e7\u00e3o mal realizada tende a comprometer todo o processo de reconstru\u00e7\u00e3o volum\u00e9trica, produzindo uma representa\u00e7\u00e3o tridimensional sem uma perfeita correspond\u00eancia com o objeto real original, obviamente prejudicando tamb\u00e9m os resultados obtidos na etapa de an\u00e1lise.\nV\u00e1rias sugest\u00f5es podem ser feitas para introduzir melhorias neste trabalho e para continuar a linha de pesquisa iniciada. Entre elas destacamos as seguintes:\n\u2014 Utilizar outros tipos de grids digitais al\u00e9m do c\u00fabico, como os grids hexagonal cil\u00edndrico, c\u00fabico centrado e c\u00fabico de faces centradas [32, 23]. Acreditamos que isto possa levar a melhores resultados, especialmente no caso da segmenta\u00e7\u00e3o 3D.\n-\tImplementa\u00e7\u00e3o de eros\u00f5es e dilata\u00e7\u00f5es utilizando decomposi\u00e7\u00f5es de elementos estru-turantes [1, 21, 55]. Isto tende a reduzir muitas vezes o tempo de processamento requerido para executar a maior parte das opera\u00e7\u00f5es da Morfologia Matem\u00e1tica.\n\u2014 Incorpora\u00e7\u00e3o do espectro de padr\u00f5es estat\u00edstico, uma proposta surgida muito recen-temente [42] que pode levar a resultados que coplementem os obtidos com o espectro de padr\u00f5es cl\u00e1ssico, utilizado neste trabalho.\n-\tPodem ser considerados tamb\u00e9m outros atributos de an\u00e1lise al\u00e9m daqueles que utilizamos. Destacamos por exemplo o \u201cvolume livre m\u00e9dio\u201d na fase porosa [14], obtido com o uso da fun\u00e7\u00e3o \u201cestrelada\u201d [44].\nBIBLIOGRAFIA\n[1]\tR. Adams. Radial decomposition of discs and spheres. CVGIP: Graph. Models, and Image Proces., 55(5):325-332, Sep 1993.\n[2]\tK.S. Arun, T.S. Huang and S.D. Blostein. Least-squares fitting of two 3-D point sets. IEEE Transactions on Pat. Anal. Mach. Intel., PAMI-9(5):698-700, Sep 1987.\n[3]\tD.H. Ballard and C.M. Brown. Computer Vision. Prentice-Hall, Englewood Cliffs, NJ, 1982.\n[4]\tG.J.F. Banon and J. Barrera. Decomposition of mappings between complete lattices by mathematical morphology, Part I. General lattices. Signal Processing, 30:299-327, 1993.\n[5]\tG.J.F. Banon e J. Barrera. Bases da Morfologia Matem\u00e1tica para a An\u00e1lise de Imagens Bin\u00e1rias. IX Escola de Computa\u00e7\u00e3o - Recife, PE, 1994.\n[6]\tJ. Barrera and G.J.F. Banon. Expressiveness of the morphological language. In SPIE Vol. 1769 Image Algebra and Morphological Image Processing III, pages 264-275, San Diego, USA, 1992.\n[7]\tJ. Barrera, G.J.F. Banon and R.A. Lotufo. A Mathematical Morphology toolbox for the KHOROS system. Technical Report RT-MAC-9403, Instituto de Matem\u00e1tica e Estat\u00edstica - Universidade Estadual de S\u00e3o Paulo, S\u00e3o Paulo, SP, Brasil, Jan 1994.\n[8]\tS. Bencher. Segmentation d\u2019images et morphologic math\u00e9matigue. Tese de doutorado - \u00c9cole Nationale Sup\u00e9rieure des Mines de Paris, Fran\u00e7a, 1990.\n[9]\tG. Borgefors. Distance transformations in digital images. Computer Vision, Graphics and Image Processing, 34:344-371,1986.\n[10]\tU.M. Braga Neto and R.A. Lotufo. A new efficient technique for the registration of serial sections. CVGIP: Graph. Models, and Image Proces., December 1994. submetido para publica\u00e7\u00e3o.\n[11]\tU.M. Braga Neto e R.A. Lotufo. Uma t\u00e9cnica computacionalmente eficiente para o registro de se\u00e7\u00f5es seriadas. In Anais do SIBGRAPI\u20199j ~ VII Simp\u00f3sio Brasileiro de Computa\u00e7\u00e3o Gr\u00e1fica e Processamento de Imagens, Curitiba,PR - Brasil, Nov 1994.\n[12]\tU.M. Braga Neto, A.J.B Vieira and R.A. Lotufo, 3D interpolation in the frequency domain. In Abstracts of the World Congress on Medical Physics and Biomedical Engineering, Rio de Janeiro, Brasil, Aug 1994.\n[13]\tR.M. Cesar Jr. Reconstru\u00e7\u00e3o Tridimensional por Ajuste de Superf\u00edcies Param\u00e9tricas. Disserta\u00e7\u00e3o de mestrado, FEE-UNICAMP, Campinas, 1993.\n[14]\tJ. Chermant, M. Coster, J. Jernot and J. Dupain. Morphological analysis of sintering. Journal of Microscopy, 121(1)189-98, Feb 1981.\n[15]\tD. Cyganski and J.A. Orr. Applications of tensor theory to object recognition and orientation determination. IEEE Transactions on Pat. Anal. Mach. Intel., PAMI-7(5)1662-673, Sep 1985.\n[16]\tP.E. Danielsson. Euclidean distance mapping. Computer Graphic and Image Processing, 14:227-248, 1980.\n[17]\tE.R. Dougherty. An Introduction to Morphological Image Processing. SPIE, 1992.\n[18]\tS.A. Dudani, K.J. Breeding and R.B. McGhee. Aircraft indentification by moments invariants. IEEE Transactions on Computers, C-26139-45, 1977.\n[19]\tT.L. Faber and E.M. Stokely. Orientation of 3-D structures in medical images. IEEE Transactions on Pat. Anal. Mach. Intel., 10(5)1626-633, Sep 1988.\n[20]\tA.X. Falc\u00e3o. Visualiza\u00e7\u00e3o de Volumes aplicada \u00e0 Area M\u00e9dica. Disserta\u00e7\u00e3o de mestrado, FEE-UNICAMP, Campinas, 1993.\n[21]\tP.D. Gader. Separable decompositions and approximations of grayscale morphological templates. CVGIP: Image Understanding, 53(3)1288-296,1991.\n[22]\tR.C. Gonzalez and R.E. Woods. Digital Image Processing. Addison Wesley Publishing Co., 2nd edition, 1992.\n[23]\tC. Gratin. De la representation des images au traitment morphologique d\u2019images tri-\n\u2713\ndimensionelles. Tese de doutorado - Ecole Nationale Sup\u00e9rieure des Mines de Paris, Fran\u00e7a, 1993.\n[24]\tT.Y. Kong and A. Rosenfeld. Digital topology: Introduction and survey. Computer Vision, Graphics and Image Processing, 48(3):357-393, Dec 1989.\n[25]\tD.G. Luenberger. Linear and Nonlinear Programming. Ad dison-Wesley Publising Co, 1984.\n[26]\tR. Luppi. Conjunto de Operadores B\u00e1sicos para Visualiza\u00e7\u00e3o, Manipula\u00e7\u00e3o e An\u00e1lise de dados 3D. Disserta\u00e7\u00e3o de mestrado, FEE-UNICAMP, Campinas, 1994.\n[27]\tM. Mantyla. An Introduction to Solid Modeling. Computer Science Press, 1978.\n[28]\tP. Maragos. Pattern spectrum and multiscale shape representation. IEEE Transactions on Pat. Anal. Mach. Intel., ll(7):701-716, jul 1989.\n[29]\tG. Matheron. Random sets and integral geometry. Wiley, New York, 1975.\n[30]\tM. Merickel. 3D reconstruction: The registration problem. Computer Vision, Graphics and Image Processing, 42:206-219, 1991.\n[31]\tF. Meyer. Automatic screening of cytological specimens. Computer Vision, Graphics and Image Processing, 35:356-369,1986. Edi\u00e7\u00e3o especial em morfologia matem\u00e1tica.\n[32]\tF. Meyer. Mathematical morphology: from two dimensions to three dimensions. Journal of Microscopy, 165(l):5-28, Jan 1992.\n[33]\tH. Pedrini, L.M. Almeida e Silva e C.L. Tozzi, Avalia\u00e7\u00e3o da precis\u00e3o no processo de reconstru\u00e7\u00e3o 3D a partir de se\u00e7\u00f5es seriadas. In Ann\u00fc do SJBGRAPP92 - V Simp\u00f3sio Brasileiro de Computa\u00e7\u00e3o Gr\u00e1fica e Processamento de Imagens, pages 155-161, Aguas de Lind\u00f3ia,SP - Brasil, Nov 1992.\n[34]\tA.L. Peressini, F.E. Sullivan and J.J. Uhl. The Mathematics of Nonlinear Programming. Undergraduate Texts in Mathematics - Springer Verlag, 1988, 1988.\n[35]\tR.A. Pieritz. Desenvolvimento das t\u00e9cnicas do gr\u00e1fico da linha mediana e da binari-za\u00e7\u00e3o por regi\u00f5es conexas aplicadas \u00e0 caracteriza\u00e7\u00e3o de meio poroso. Disserta\u00e7\u00e3o de mestrado, Programa de p\u00f3s-gradua\u00e7\u00e3o em engenharia mec\u00e2nica, UFSC, Florian\u00f3polis,\n[36]\tJ. Piper and E. Grantin. Computing distance transformations in convex and non-convex domains. Pattern Recognition, 20(6):599-615,1987.\n[37]\tJ. Rasure and S, Kubica. The khoros application development environment. Khoral Re searsh Inc., 1993. KHOROS Group - EECE - University of New Mexico - Albuquerque - NM - USA.\n[38]\tJ.R. Rasure, D. Argiro, T. Sauer and C.S. Williams. Visual language and software development environment for image processing. International Journal of Imaging Systems and Tecnology, 2:183-199, August 1990.\n[39]\tJ.R. Rasure and C.S. Williams. An integrated visual language and software development environment. Visual Languages and Computing, 2:217-246,1991.\n[40]\tJ.R. Rasure and M. Young. An open environment for image processing and software development. In 1992 SPIE/IS&amp;T Symposium on Eletronic Imaging Proceedings, volume 1659, Feb 1992.\n[41]\tS.P. Raya and J.K. Udupa. Shape-based interpolation of multidimensional objects. IEEE Transactions on Medical Images, 9:32-42,1989.\n[42]\tC.S. Regazzoni, G.L. Foresti and A.N. Venetsanopoulos. Statistical pattern spectrum for binary pattern recognition. In Mathematical Morphology and Its Applications to Image Processing, pages 185-192,1994. eds. J. Serra and P. Soille.\n[43]\tA. Rosenfeld and A.C. Kak, Digital picture processing. Academic Press, Inc., 2nd edition, 1982.\n[44]\tJ. Serra. Image analysis and mathematical morphology. Academic Press, Inc., 1982.\n[45]\tJ. Serra. Introduction to mathematical morphology. Computer Vision, Graphics and Image Processing, 35:283-305,1986. Edi\u00e7\u00e3o especial em morfolog\u00eda matem\u00e1tica.\n[46]\tJ. Serra and L. Vincent. Morphological filtering. In EURASIP course: \u201cMedian and Morphological Filtering in Image and Signal Processing\u201d, Tampere, Finland, Jun 1989.\n[47]\tP. Soille. Morphologie Math\u00e9matique: du relief \u00e0 la dimensionalite - algorithmes et methods. Tese de doutorado - Uni ver sit\u00e9 catholique de Louvain, B\u00e9lgica, 1992.\n[48]\tP. Soille and L. Vincent. Determining watersheds in digital pictures via flooding simulations. In SPIE Vol. 1360 Visual Communications and Image Processing, pages 240-250,1990.\n[49]\tS.R. Sternberg. Grayscale morphology. Computer Vision, Graphics and Image Processing, 35:333-355,1986. Edi\u00e7\u00e3o especial em morfolog\u00eda matem\u00e1tica.\n[50]\tL. Thurfjell, E. Bengtsson and B. Nordin. A new three-dimensional connected components labeling algorithm with simultaneous object feature extraction capability. CV-GIP: Graph. Models, and Image Proces., 54(4):357-364, jul 1992.\n[51]\tJ.K. Udupa and V.G. Ajjanagadde. Boundary and object labeling in three-dimensional images. Computer Vision, Graphics and Image Processing, 51:355-369,1990.\n[52]\tL. Vincent. Algorithmes morphologiques \u00e0 base de files d\u2019attentte et de lacets. Tese de doutorado - Ecole Nationale Sup\u00e9rieure des Mines de Paris, Fran\u00e7a, 1990.\n[53]\tL. Vincent. Morphological grayscale reconstruction in image analysis: Applications and efficients algorithms. IEEE Transactions on Image Processing, 2(2): 176-201, Apr 1993.\n[54]\tL. Vincent and P. Soille. Watersheds in digital spaces: an efficient algorithm based on immersion simulations. IEEE Transactions on Pat. Anal. Mach. Intel., 13(6):583-598, Jun 1991.\n[55]\tX. Zhuang and R.M. Haralick. Morphological structuring element decomposition. Computer Vision, Graphics and Image Processing, 35:370-382, 1986. Edi\u00e7\u00e3o especial em morfolog\u00eda matem\u00e1tica."}]}}}