{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.07539"}, {"@name": "filename", "#text": "12258_316862.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE FEDERAL DE SANTA CATARINA DEPARTAMENTO DE AUTOMA\u00c7\u00c3O E SISTEMAS P\u00d3S-GRADUA\u00c7\u00c3O EM ENGENHARIA DE AUTOMA\u00c7\u00c3O E SISTEMAS\nJo\u00e3o Ricardo Castro Melo\nCONTRIBUI\u00c7\u00d5ES AO DESENVOLVIMENTO DE UM PERFIL\u00d4METRO \u00d3PTICO A LASER PARA MEDI\u00c7\u00c3O E VISUALIZA\u00c7\u00c3O DA GEOMETRIA INTERNA DE DUTOS\nFlorian\u00f3polis\nUNIVERSIDADE FEDERAL DE SANTA CATARINA DEPARTAMENTO DE AUTOMA\u00c7\u00c3O E SISTEMAS P\u00d3S-GRADUA\u00c7\u00c3O EM ENGENHARIA DE AUTOMA\u00c7\u00c3O E SISTEMAS\nJo\u00e3o Ricardo Castro Melo\nCONTRIBUI\u00c7\u00d5ES AO DESENVOLVIMENTO DE UM PERFIL\u00d4METRO \u00d3PTICO A LASER PARA MEDI\u00c7\u00c3O E VISUALIZA\u00c7\u00c3O DA GEOMETRIA INTERNA DE DUTOS\nDisserta\u00e7\u00e3o submetida ao Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Automa\u00e7\u00e3o e Sistemas da Universidade Federal de Santa Catarina como parte dos requisitos para a obten\u00e7\u00e3o do Grau de Mestre em Engenharia de Automa\u00e7\u00e3o e Sistemas.\nOrientador: Prof. Dr. Armando Albertazzi Gon\u00e7alves J\u00fanior\nFlorian\u00f3polis\nFicha de identifica\u00e7\u00e3o da obra elaborada pelo autor, atrav\u00e9s do Programa de Gera\u00e7\u00e3o Autom\u00e1tica da Biblioteca Universit\u00e1ria da UFSC\nMelo, Jo\u00e3o Ricardo Castro contribui\u00e7\u00f5es ao desenvolvimento de um perfll\u00f4metro \u00f3ptico a laser para medi\u00e7\u00e3o e visualiza\u00e7\u00e3o da geometria interna de dutos [disserta\u00e7\u00e3o] / Jo\u00e3o Ricardo castro Melo ;\norientador. Armando Albertazzi Gon\u00e7alves J\u00fanior -Florian\u00f3polis, sc, 2012.\n143 p. ; 21CTU\nDisserta\u00e7\u00e3o \u00abmestrado) - universidade Federal de santa Catarina, centro Tecnol\u00f3gico. Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Automa\u00e7\u00e3o e Sistemas.\ninclui refer\u00eancias\n1. Engenharia de Automa\u00e7\u00e3o e Sistemas. 2. Perfllometrla interna. 3. Sistemas embarcados. 4. Realidade virtual. I. Gon\u00e7alves J\u00fanior, Armando Albertazzi. II. universidade Federal de santa catarina. Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Automa\u00e7\u00e3o e Sistemas. III. T\u00edtulo.\nJo\u00e3o Ricardo Castro Melo\nCONTRIBUI\u00c7\u00d5ES AO DESENVOLVIMENTO DE UM PERFIL\u00d4METRO \u00d3PTICO A LASER PARA MEDI\u00c7\u00c3O E VISUALIZA\u00c7\u00c3O DA GEOMETRIA INTERNA DE DUTOS\nEsta Disserta\u00e7\u00e3o foi julgada adequada para a obten\u00e7\u00e3o do T\u00edtulo de Mestre em Engenharia de Automa\u00e7\u00e3o e Sistemas, e foi aprovada em sua forma final pelo Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Automa\u00e7\u00e3o e Sistemas da Universidade Federal de Santa Catarina.\nFlorian\u00f3polis-SC, 17 de dezembro de 2012.\nProf. Armando Albertazzi Gon\u00e7alves Jr., Dr. Orientador\nProf. Jomi Fred H\u00fcbner, Dr.\nCoordenador do Curso\nBanca Examinadora:\nProf.a Fabiana Rodrigues Leta, Dr.a Universidade Federal Fluminense\nProf. Marcelo Ricardo Stemmer, Dr.\nProf. Tiago Loureiro Figaro da Costa Pinto, Dr.\n\u00c0 minha av\u00f3 Iracema (in memoriam).\nAGRADECIMENTOS\nAo professor Armando Albertazzi pela enorme paci\u00eancia comigo. Tamb\u00e9m pela oportunidade dada de trabalhar no projeto PEROLA e ser seu orientando. \u00c9 algu\u00e9m com quem aprendo muito e pretendo passar isto adiante.\nAo Eng. Pedro Buschinelli pela grande ajuda na confec\u00e7\u00e3o do texto e pela experi\u00eancia de trabalho no laborat\u00f3rio.\n\u00c0 professora Analucia Fantin pela orienta\u00e7\u00e3o passada que ecoou nesta disserta\u00e7\u00e3o.\nAos bolsistas Luan Volpato e Rafael Bergamin, cujos trabalhos contribu\u00edram com esta disserta\u00e7\u00e3o.\nAos professores do Departamento de Automa\u00e7\u00e3o e Sistemas pela instru\u00e7\u00e3o, o que tem nesta disserta\u00e7\u00e3o um de seus resultados.\nAos meus pais, Jos\u00e9 Rubens e Maria L\u00facia, pela estrutura familiar e apoio nos momentos de necessidade.\n\u00c0 minha namorada, Tallulah, quem deu bastante incentivo e for\u00e7as para a realiza\u00e7\u00e3o do mestrado.\nAos demais familiares que me incentivaram neste per\u00edodo.\nAo IBP, Capes e Petrobras pelo suporte financeiro.\nAos demais companheiros do LABMETRO e a todos os que contribu\u00edram com a realiza\u00e7\u00e3o deste trabalho ou que me deram apoio, direta ou indiretamente.\nMuito obrigado.\nRESUMO\nTubula\u00e7\u00f5es met\u00e1licas s\u00e3o comumente utilizadas na ind\u00fastria petroqu\u00edmica para o transporte de produtos, mat\u00e9rias-primas e fluidos de processo. Estas tubula\u00e7\u00f5es est\u00e3o sujeitas a avarias, inclusive decorrentes da pr\u00f3pria intera\u00e7\u00e3o com o material transportado, como ocorre no caso da corros\u00e3o interna. Devido \u00e0 alta import\u00e2ncia das tubula\u00e7\u00f5es met\u00e1licas e \u00e0 consequente demanda da monitora\u00e7\u00e3o da sua integridade, novos m\u00e9todos de inspe\u00e7\u00e3o geom\u00e9trica interna t\u00eam sido desenvolvidos. Na categoria de m\u00e9todos \u00f3pticos, foi desenvolvido um sensor por triangula\u00e7\u00e3o c\u00f4nica a laser no LABMETRO-EMC-UFSC capaz de medir o perfil geom\u00e9trico de uma sec\u00e7\u00e3o de tubo a cada aplica\u00e7\u00e3o. Esta disserta\u00e7\u00e3o tem o objetivo de fornecer subs\u00eddios para que se possa utilizar este sensor em uma completa solu\u00e7\u00e3o de perfilometria de tubos de refinarias de petr\u00f3leo e de explora\u00e7\u00e3o sujeitos \u00e0 corros\u00e3o interna, respeitadas as caracter\u00edsticas do sensor e uma estrutura mec\u00e2nica predefinida. Para possibilitar a medi\u00e7\u00e3o do perfil geom\u00e9trico de uma regi\u00e3o completa formada por sec\u00e7\u00f5es cont\u00edguas, foi desenvolvido um sistema de aquisi\u00e7\u00e3o e disponibiliza\u00e7\u00e3o de imagens, atrav\u00e9s de hardware e software embarcados no novo perfil\u00f4metro, al\u00e9m de uma biblioteca de gerenciamento da c\u00e2mera utilizada no sensor \u00f3ptico. A integra\u00e7\u00e3o destas ferramentas com o sensor e outros componentes do perfil\u00f4metro possibilitou o desenvolvimento de um prot\u00f3tipo capaz de adquirir a geometria interna de uma regi\u00e3o de um tubo na forma de uma nuvem de pontos cil\u00edndrica. Para realizar a leitura dos perfis geom\u00e9tricos inspecionados de forma inovadora e poderosa, foi desenvolvido um sistema de visualiza\u00e7\u00e3o e an\u00e1lise de nuvens de pontos utilizando t\u00e9cnicas de realidade virtual. O uso conjunto destas ferramentas permitiu a correta aplica\u00e7\u00e3o do perfil\u00f4metro baseado no sensor \u00f3ptico por triangula\u00e7\u00e3o c\u00f4nica a laser na inspe\u00e7\u00e3o de tubos de explora\u00e7\u00e3o de g\u00e1s severamente danificados por corros\u00e3o interna. Portanto, esta disserta\u00e7\u00e3o demonstra a adequabilidade da tecnologia apresentada na inspe\u00e7\u00e3o geom\u00e9trica de tubos na ind\u00fastria de petr\u00f3leo e g\u00e1s.\nPalavras-chave: Perfilometria interna. Sistemas embarcados. Realidade virtual.\nABSTRACT\nMetal pipes are commonly used in the petrochemical industry to transport goods, raw materials and process fluids. These pipes are subject to damage, including those arisen from its interaction with the transported material, as it is the case of internal corrosion. Due to the high importance of metal pipes and the consequent demand of the monitoring of their integrity, new internal geometry inspection methods have been developed. With regard to the optical category, LABMETRO-EMC-UFSC has developed an optical sensor which uses laser conical triangulation and is capable of measuring the geometric profile of one pipe section per application. The objective of this study is to provide support for the implementation of this sensor into a complete profilometry solution, given the characteristics of the sensor and a default mechanical structure. This profilometer is used to assess the geometric inspection of pipes employed at oil refineries and exploration sites, for these pipes are subject to internal corrosion. To enable the measurement of the geometric profile of a full region formed by contiguous sections, this study has developed a system that acquires images through embedded hardware and software in the new profilometer. These images are made available through a management library used for the camera of the optical sensor. The integration of these tools with the sensor and the other profilometer components has enabled the development of a prototype which is able to acquire the internal geometry of the region of a pipe in the form of a cylindrical cloud of points. In order to read the acquired geometric profiles in an innovative and powerful manner, a virtual reality system has been developed for visualization and analysis of the clouds of points. The combined use of these tools has allowed the correct application of the profilometer based on the use of laser conical triangulation sensor. Ultimately, this thesis demonstrates the capability of the laser profilometer to geometrically inspect corroded pipes in the oil and gas industry.\nKeywords: Internal profilometry. Embedded systems. Virtual reality.\nLISTA DE FIGURAS\nFigura 1 - Classifica\u00e7\u00e3o das tubula\u00e7\u00f5es.............................29\nFigura 2 - Tubo de forno de refinaria apresentando corros\u00e3o interna. .. 31 Figura 3 - Trecho de gasoduto apresentando corros\u00e3o em regi\u00e3o brevemente posterior a uma curva na tubula\u00e7\u00e3o.......................31\nFigura 4 - Uma das montagens do Pig Palito. Destaque para as hastes ao redor das pe\u00e7as mais centrais.......................................37\nFigura 5 - Outra montagem de um pig palito projetada para dutos de tamanhos vari\u00e1veis entre 100 a 180 mm (4\" a 7\").....................38\nFigura 6 - Apresenta\u00e7\u00e3o dos dados coletados pelo Pig Palito. Os pontos em vermelho representam ocorr\u00eancia de perda de material.............39\nFigura 7 - Fluxo magn\u00e9tico induzido passando (a) pelo ar, (b) quase totalmente pela chapa met\u00e1lica colocada e (c) com algumas linhas de fluxo em fuga, causada pela diminui\u00e7\u00e3o da espessura da chapa naquela regi\u00e3o..............................................................41\nFigura 8 - Um modelo de pig MFL cincunferencial da empresa Battelle, EUA. Destaque para a dire\u00e7\u00e3o do fluxo magn\u00e9tico imposto pelo dispositivo.........................................................42\nFigura 9 - Um modelo de pig MFL axial da empresa Det Norske Veritas, Noruega.............................................................43\nFigura 10 - Um modelo de pig MFL axial do CENPES - Petrobras.......43\nFigura 11 - Dados coletados pelos sensores de um pig MFL da empresa Det Norske Veritas..................................................44\nFigura 12 - Uma representa\u00e7\u00e3o dos dados obtidos por um pig MFL utilizando c\u00f3digo de cores para os valores de raio obtidos..........45\nFigura 13 - Concep\u00e7\u00e3o art\u00edstica de um pig ultrass\u00f3nico dentro de um duto. Destaque para os transdutores ultrass\u00f3nicos...................46\nFigura 14 - Um rob\u00f3 com transdutor ultrass\u00f3nico utiliz\u00e1vel na parte externa de dutos....................................................47\nFigura 15 - Uma visualiza\u00e7\u00e3o do resultado obtido por um pig ultrass\u00f3nico....................................................... 48\nFigura 16 - O resultado da medi\u00e7\u00e3o do corpo de prova apresentado na figura 14. A imagem resultante foi mapeada como textura em um cilindro virtual....................................................48\nFigura 17 - Conceito de triangula\u00e7\u00e3o \u00f3ptica.........................50\nFigura 18 - Conceito de triangula\u00e7\u00e3o \u00f3ptica c\u00f3nica a laser aplicado no sensor............................................................. 50\nFigura 19 - O algoritmo do software de medi\u00e7\u00e3o transforma uma imagem numa lista de valores de ponto-flutuante. Cada valor da lista\nposi\u00e7\u00e3o na lista...................................................52\nFigura 20 - Uma imagem capturada pelo sensor \u00f3ptico. A faixa mais\nclara \u00e9 advinda do laser projetado na superf\u00edcie interna do tubo...52\nFigura 21 - Uma das primeiras montagens do sensor \u00f3ptico a laser em bancada (Buschinelli, 2007). Na \u00e9poca era utilizado um segundo espelho c\u00f4nico disposto de frente a c\u00e2mera, o qual foi removido nas concep\u00e7\u00f5es atuais.............................................................53\nFigura 22 - Foto do sensor \u00f3ptico, em sua concep\u00e7\u00e3o atual, aplicado a um padr\u00e3o de calibra\u00e7\u00e3o anelar.....................................54\nFigura 23 - Sensor \u00f3ptico a laser, em sua concep\u00e7\u00e3o atual, aplicado a um gabarito geom\u00e9trico................................................54\nFigura 24 - Resultado de medi\u00e7\u00e3o, realizada pelo sensor \u00f3ptico, do gabarito da figura 21. \u00c9 mostrado tamb\u00e9m o valor dos raios dos pontos do gabarito obtidos por uma m\u00e1quina de medir por coordenadas.......55\nFigura 25 - Esquema geral de um sistema embarcado..................57\nFigura 26\t- Um diagrama simplificado e gen\u00e9rico de um\nmicrocontrolador...................................................58\nFigura 27 - O fluxo de dados em aplica\u00e7\u00f5es de CG, desde o software at\u00e9 a tela.............................................................64\nFigura 28 - Uma mesma cena fotografada de dois pontos levemente separados..........................................................66\nFigura 29 - O deslocamento controlado do sensor ao longo do eixo do tubo permite a aquisi\u00e7\u00e3o da geometria de sucessivas sec\u00e7\u00f5es........70\nFigura 30 - As k listas de n valores adquiridos em coordenadas polares devem ser concatenadas de modo a formar uma tabela de ordem n x k em coordenadas cil\u00edndricas.........................................70\nFigura 31 - Reconstru\u00e7\u00e3o 3D da geometria interna (vista externa) de um trecho de tubo met\u00e1lico utilizando codifica\u00e7\u00e3o de cores para valores de raio...............................................................71\nFigura 32 - Diagrama funcional b\u00e1sico IDEF0 de mais alto n\u00edvel do PEROLA-1...........................................................72\nFigura 33 - Detalhamento da fun\u00e7\u00e3o de aquisi\u00e7\u00e3o e disponibiliza\u00e7\u00e3o de imagens............................................................73\nFigura 34 - Detalhamento da fun\u00e7\u00e3o de extra\u00e7\u00e3o de nuvem de pontos cil\u00edndrica correspondente \u00e0 regi\u00e3o inspecionada....................74\nFigura 35 - Diagrama AADL de sistemas e dispositivos do PEROLA-I. Os dados e o dispositivo em cor mais fraca representam um caminho secund\u00e1rio, utilizado apenas na indisponibilidade da via principal.81\nFigura 36 - Modelo AADL simplificado do hardware do m\u00f3dulo de monitora\u00e7\u00e3o de deslocamento........................................83\nFigura 37 - A proje\u00e7\u00e3o de parte do corpo mec\u00e2nico do PEROLA-I, com destaque para a roda do hod\u00f4metro.................................85\nFigura 38 - Vista em corte do PEROLA-I, gerada por uma ferramenta CAD. Destaque para o inclin\u00f4metro, \u00e0 esquerda e destacado em vermelho, e para a placa de circuito impresso, abaixo e destacada em amarelo...........................................................86\nFigura 39 - Ilustra\u00e7\u00e3o da altera\u00e7\u00e3o do n\u00famero de pulsos por disparo para um caso exemplo de 10,25 pulsos do encoder por mil\u00edmetro percorrido. ..................................................................89 Figura 40 - Diagrama de m\u00e1quina de estados de alto n\u00edvel do software embarcado.........................................................90\nFigura 41 - Diagrama de atividades associadas ao estado \"La\u00e7o de opera\u00e7\u00e3o\".........................................................91\nFigura 42 - Diagrama de classes simplificado do m\u00f3dulo de gerenciamento da c\u00e2mera do sensor.................................96\nFigura 43 - Diagrama de atividades do la\u00e7o de aquisi\u00e7\u00e3o de imagens de MeasurementCameraHandler..........................................98\nFigura 44 - Captura de tela da interface gr\u00e1fica do m\u00f3dulo de controle da c\u00e2mera do sensor. As cores apresentadas na imagem capturada pela c\u00e2mera s\u00e3o de uma palheta artificial, pois a c\u00e2mera \u00e9 preto-e-branco. 100 Figura 45 - Usu\u00e1rio do sistema utilizando HMD e joystick, ambos em destaque. O computador possui placa de v\u00eddeo capaz de gerar imagens estereosc\u00f3picas..................................................106\nFigura 46 - Casos de uso relativos \u00e0 nuvem de pontos.............107\nFigura 47 - Casos de uso relativos \u00e0s vis\u00f5es 3D e 2D.............108\nFigura 48 - Casos de uso relativos \u00e0 navega\u00e7\u00e3o e objetos no ambiente virtual..........................................................109\nFigura 49 - Casos de uso relativos \u00e0 an\u00e1lise de dados e anota\u00e7\u00f5es de usu\u00e1rio..........................................................110\nFigura 50 - Diagrama de classe simplificado da medi\u00e7\u00e3o em coordenadas cil\u00edndricas como definida pelo padr\u00e3o XCP............112\nFigura 51 - Diagrama de classes simplificado de parte do SRV. Esta representa\u00e7\u00e3o tem o objetivo de dar foco \u00e0s funcionalidades gr\u00e1ficas e de an\u00e1lise geom\u00e9trica do sistema.................................114\nFigura 52 - Diagrama de classes do pacote de dispositivos de entrada e sua intera\u00e7\u00e3o com o resto do sistema.............................116\nFigura 53 - Diagrama de atividades simplificado do comportamento din\u00e2mico do SRV..................................................117\nFigura 54 - Uma poss\u00edvel tela de sa\u00edda do SRV, apresentando a reconstru\u00e7\u00e3o tridimensional de uma regi\u00e3o geom\u00e9trica inspecionada e objetos virtuais de leitura. A visualiza\u00e7\u00e3o apresentada \u00e9 do poto de vista\nexterno, por\u00e9m de uma geometria interna. Os valores sem unidade est\u00e3o em mil\u00edmetros......................................................120\nFigura 55 - Vis\u00e3o planificada, gerada pelo SRV, da regi\u00e3o apresentada na figura 54. Este tipo de visualiza\u00e7\u00e3o \u00e9 similar ao encontrado em outros m\u00e9todos de inspe\u00e7\u00e3o. No software apresentado, esta vis\u00e3o pode ser utilizada simultaneamente \u00e0 tridimensional.........................120\nFigura 56 - Compara\u00e7\u00e3o visual entre imagens obtidas com diferentes par\u00e2metros de visualiza\u00e7\u00e3o tridimensional para uma mesma cena. A partir de uma cena original se alterou somente um par\u00e2metro: (a) cena original, (b) escala radial dobrada, (c) par\u00e2metros de ilumina\u00e7\u00e3o alterados e (d) escala de cores alterada...........................121\nFigura 57 - Escalas de cores utilizadas na figura 56. \u00c0 esquerda, a escala utilizada nas partes (a), (b) e (c) da figura 56. \u00c0 direita, a escala utilizada na parte (d) da figura 56. Os valores est\u00e3o em mil\u00edmetros..........122\nFigura 58 - Vista interna de uma regi\u00e3o de tubo. Nesta ocasi\u00e3o, o usu\u00e1rio utiliza um apontador virtual para a leitura do valor individual de raio de um ponto. H\u00e1 ainda a presen\u00e7a de uma anota\u00e7\u00e3o......................123\nFigura 59 - Esquema de volumes de proje\u00e7\u00e3o assim\u00e9tricos utilizado na gera\u00e7\u00e0o dos pares estereosc\u00f3picos..................................125\nFigura 60 - Um par estereosc\u00f3pico gerado pelo software de realidade virtual............................................................125\nFigura 61 - Uma parte da interface de visualiza\u00e7\u00e3o planificada e an\u00e1lise, onde se pode ver uma lista de regi\u00f5es definidas, valores de leitura para a regi\u00e3o selecionada e uma \u00e1rea de visualiza\u00e7\u00e3o planificada desta regi\u00e3o. Neste caso, \u00e9 vista uma regi\u00e3o com defeitos evidenciados em vermelho.\n...................................................................126 Figura 62 - Montagem feita durante a calibra\u00e7\u00e3o do hod\u00f3metro.......130\nFigura 63 - Um dos prot\u00f3tipos do PEROLA-I com o laser ligado.......135\nFigura 64 - Esquem\u00e1tico da bancada de testes do PEROLA-1...........135\nFigura 65 - Vista interna da tampa com defeitos artificialmente produzidos.........................................................136\nFigura 66 - A reconstru\u00e7\u00e3o, feita pelo SRV, da geometria interna adquirida da regi\u00e3o da tampa com defeitos artificialmente produzidos.\n...................................................................137 Figura 67 - Vista interna do tubo da bancada, com destaque ao cord\u00e3o de solda e \u00e0 tampa de acr\u00edlico. Pode-se ver tamb\u00e9m o perfil\u00f3metro aplicado ao fundo...........................................................138\nFigura 68 - Vista reconstru\u00edda pelo SRV do cord\u00e3o de solda e da tampa de acr\u00edlico inspecionados pelo perfil\u00f3metro. O ponto de vista desta cena \u00e9 oposto ao da fotografia da figura 64.............................138\nFigura 69 - Parte da geometria da tampa remov\u00edvel correspondente ao rebaixo com degraus.............................................139\nFigura 70 - Representa\u00e7\u00e3o da geometria do rebaixo vista pelo software de visualiza\u00e7\u00e3o.................................................140\nFigura 71 - Recortes da vista planificada da regi\u00e3o do rebaixo incremental.....................................................140\nFigura 72 - Vista interna de um trecho de tubula\u00e7\u00e3o de explora\u00e7\u00e3o de g\u00e1s fortemente exposto \u00e0 corros\u00e3o...............................142\nFigura 73 - Resultado de medi\u00e7\u00e3o de trecho de tubula\u00e7\u00e3o de g\u00e1s da figura 69, inspecionada pelo PEROLA-I e visualizada pelo seu SRV. 142\nFigura 74 - Trecho de tubula\u00e7\u00e3o de explora\u00e7\u00e3o de g\u00e1s severamente danificado, apresentando inclusive uma fenda....................143\nFigura 75 - Reconstru\u00e7\u00e3o da geometria correspondente \u00e0 regi\u00e3o da figura 71.......................................................143\nLISTA DE TABELAS\nTabela 1 - L\u00f3gica de destaque dos requisitos da tabela 2...........75\nTabela 2 - Requisitos t\u00e9cnicos do PEROLA-1.........................75\nTabela 3 - Requisitos do m\u00f3dulo de aquisi\u00e7\u00e3o e disponibiliza\u00e7\u00e3o de imagens............................................................79\nTabela 4 - Estados assumpt\u00edveis pelo sinal de sa\u00edda dos encoders de codifica\u00e7\u00e3o de dois bits...........................................83\nTabela 5 - Tarefas executadas pelo\tc\u00f3digo embarcado...............92\nTabela 6 - Obten\u00e7\u00e3o de pulsos por deslocamento conhecido para calibra\u00e7\u00e3o do hod\u00f3metro (realizada com velocidade menor do que 20 mm/s).............................................................131\nTabela 7 - Resultado da calibra\u00e7\u00e3o do\thod\u00f3metro...................131\nTabela 8 - Medi\u00e7\u00e3o de outras dist\u00e2ncias com a rela\u00e7\u00e3o obtida na calibra\u00e7\u00e3o........................................................131\nTabela 9 - Testes de medi\u00e7\u00e3o de deslocamento a diferentes velocidades. ..................................................................132 Tabela 10 - Testes de aquisi\u00e7\u00e3o de imagens a diferentes velocidades e resolu\u00e7\u00f5es........................................................133\nLISTA DE ABREVIATURAS E SIGLAS\n3D\tTridimensional\nAADL\tArchitecture Analysis and Design Language\nALU\tUnidade Aritm\u00e9tica e L\u00f3gica (Arithmetic and Logic Unit)\nAPI\tInterface de Programa\u00e7\u00e3o de Aplica\u00e7\u00f5es (Application Programming Interface)\nbps\tBits por segundo\nCAD\tProjeto Assistido por Computador (Computer Aided Design)\nCCD\tCharge-coupled device\nCENPES\tCentro de Pesquisas e Desenvolvimento Leopoldo Am\u00e9rico Miguez de Mello\nCI\tCircuito Integrado\nCPU\tUnidade de Processamento Central (Central Processing Unit)\nEMC\tDepartamento de Engenharia Mec\u00e2nica\nGigE\tGigabit Ethernet\nGPU\tUnidade de Processamento Gr\u00e1fica (Graphics Processing Unit)\nHMD\tMonitor Acoplado \u00e0 Cabe\u00e7a (Head Mounted Display)\nIDE\tAmbiente Integrado de Desenvolvimento (Integrated Development Environment)\nIDEF0\tIntegration Definition for Function Modeling\nLABMETRO\tLaborat\u00f3rio de Metrologia e Automatiza\u00e7\u00e3o\nLAMEF\tLaborat\u00f3rio de Metalurgia F\u00edsica\nLCD\tMostrador de cristal l\u00edquido (Liquid Crystal Display)\nMFL\tFuga de Fluxo Magn\u00e9tico (Magnetic Flux Leakage)\nMIPS\tMilh\u00f5es de instru\u00e7\u00f5es por segundo\nMMC\tM\u00e1quina de medir por coordenadas\nNPC\tNuvem de pontos cil\u00edndrica\nOpenGL\tOpen Graphics Library\nP&amp;G\tPetr\u00f3leo e g\u00e1s\nPC\tComputador Pessoal (Personal Computer)\nPEROLA\tPerfilometria \u00d3ptica a Laser\nPNG\tImagem Port\u00e1vel de Rede (Portable Network Graphics)\nPUC\tPontif\u00edcia Universidade Cat\u00f3lica\nRS-x\tPadr\u00e3o Recomendado - x (Recommended Standard - x)\nRV\tRealidade Virtual\nSDK\tKit de Desenvolvimento de Software (Software Development Kit)\nSE\tSistema Embarcado\nSRV\tSistema de Realidade Virtual\nSTR\tSistema de Tempo Real\nSysML\tSystems Modeling Language\nUFRGS\tUniversidade Federal do Rio Grande do Sul\nUFSC\tUniversidade Federal de Santa Catarina\n\tReceptor/transmissor s\u00edncrono/ass\u00edncrono\nUSART\tuniversal (Universal Synchronous/Asynchronous Receiver/Transmitter)\nXCP\tNuvem de pontos estendida (extended cloud of points)\nXML\tLinguagem de Marca\u00e7\u00e3o Extens\u00edvel (Extensible Markup Language)\nSUM\u00c1RIO\n1\tINTRODU\u00c7\u00c3O.................................29\n1.1\tMOTIVA\u00c7\u00c3O..................................29\n1.2\tOBJETIVO GERAL DA DISSERTA\u00c7\u00c3O..............33\n1.3\tOBJETIVOS ESPEC\u00cdFICOS......................33\n1.4\tESTRUTURA..................................34\n2\tREVIS\u00c3O BIBLIOGR\u00c1FICA......................35\n2.1\tM\u00c9TODOS DE INSPE\u00c7\u00c3O ATUAIS.................35\n2.1.1\tPig Palito.................................36\n2.1.2\tPig magn\u00e9tico..............................40\n2.1.3\tPig ultrass\u00f3nico...........................45\n2.2\tO SENSOR \u00d3PTICO POR TRIANGULA\u00c7\u00c3O C\u00d4NICA A LASER\n49\n2.2.1\tDEMANDA .................................. 49\n2.2.2\tCONCEITO ................................. 49\n2.2.3\tO PROT\u00d3TIPO DESENVOLVIDO...................51\n2.3\tT\u00c9CNICAS UTILIZADAS NO TRABALHO............56\n2.3.1\tSistemas embarcados........................56\n2.3.1.1\tProjeto de sistemas embarcados.............59\n2.3.1.2\tSistemas de tempo real.....................60\n2.3.2\tComputa\u00e7\u00e3o gr\u00e1fica.........................62\n2.3.3\tRealidade virtual..........................65\n3\tCONCEP\u00c7\u00c3O DO PERFIL\u00d4METRO..................69\n3.1\tPRINC\u00cdPIO DE SOLU\u00c7\u00c3O.......................69\n3.2\tDETALHAMENTO PRELIMINAR....................71\n3.3\tDEFINI\u00c7\u00c3O DO ESCOPO DO TRABALHO............74\n3.4\tREQUISITOS T\u00c9CNICOS........................75\n4\tSISTEMA DE AQUISI\u00c7\u00c3O E DISPONIBILIZA\u00c7\u00c3O DE\nIMAGENS............................................79\n4.1\tGERA\u00c7\u00c3O DE REQUISITOS......................79\n4.2\tM\u00d3DULO DE MONITORA\u00c7\u00c3O DE DESLOCAMENTOS.....80\n4.2.1\tHardware...................................82\n4.2.2\tSoftware...................................86\n4.2.2.1\tC\u00e1lculo de deslocamento e etiquetagem......87\n4.2.2.2\tComportamento din\u00e2mico.....................89\n4.2.3\tAspectos de tempo real.................... 91\n4.3\tM\u00d3DULO DE GERENCIAMENTO DA C\u00c2MERA DO SENSOR95\n4.3.1\tModelagem................................. 95\n4.3.2\tInterface de usu\u00e1rio.......................99\n4.4\tCONCLUS\u00c3O................................ 100\n5\tSISTEMA DE REALIDADE VIRTUAL PARA\nVISUALIZA\u00c7\u00c3O E AN\u00c1LISE DE MEDI\u00c7\u00d5ES.................103\n5.1\tMOTIVA\u00c7\u00c3O E REQUISITOS................... 103\n5.2\tCONCEP\u00c7\u00c3O..................................104\n5.2.1\tCasos de uso...............................106\n5.3\tPADR\u00c3O DE ARMAZENAMENTO DE NUVENS DE PONTOS\nCIL\u00cdNDRICAS.......................................110\n5.4\tPROJETO E DESENVOLVIMENTO DO SOFTWARE......112\n5.4.1\tArquitetura................................113\n5.4.2\tFuncionalidades de visualiza\u00e7\u00e3o............118\n5.4.3\tImers\u00e3o e interatividade...................122\n5.4.4\tAn\u00e1lise geom\u00e9trica.........................125\n5.5\tCONCLUS\u00c3O..................................128\n6\tRESULTADOS E AVALIA\u00c7\u00c3O DAS FERRAMENTAS\nDESENVOLVIDAS.....................................129\n6.1\tAVALIA\u00c7\u00c3O DO SISTEMA DE AQUISI\u00c7\u00c3O E\nDISPONIBILIZA\u00c7\u00c3O DE IMAGENS.......................129\n6.2\tINSPE\u00c7\u00c3O EM BANCADA........................134\n6.3\tINSPE\u00c7\u00c3O EM CAMPO..........................141\n7\tCONSIDERA\u00c7\u00d5ES FINAIS.......................145\n7.1\tASPECTOS POSITIVOS DO SISTEMA DESENVOLVIDO..145\n7.2\tMELHORIAS EM ANDAMENTO.....................147\n7.3\tSUGEST\u00d5ES DE MELHORIAS FUTURAS.............148\nREFER\u00caNCIAS.......................................151\nAp\u00eandice A - Conceitos b\u00e1sicos\tde AADL utilizados.157\n1\tINTRODU\u00c7\u00c3O\nEste cap\u00edtulo apresenta a motiva\u00e7\u00e3o da presente disserta\u00e7\u00e3o, seus objetivos e, em seguida, a forma como o texto est\u00e1 estruturado.\n1.1\tMOTIVA\u00c7\u00c3O\nTubula\u00e7\u00f5es met\u00e1licas s\u00e3o aqui entendidas como conjuntos de tubos e acess\u00f3rios, voltados ou n\u00e3o ao processo industrial. Estas s\u00e3o amplamente utilizadas nas ind\u00fastrias qu\u00edmica, petroqu\u00edmica, aliment\u00edcia, farmac\u00eautica e em refinarias para cumprir diversas finalidades, resumidas na figura 1 (Ribeiro, 2007). Dentre o conte\u00fado transportado encontram-se principalmente gases, \u00f3leos, vapores, combust\u00edveis, lubrificantes e demais fluidos industriais. Os custos de sistemas de tubula\u00e7\u00f5es chegam a representar 25% do custo total destas instala\u00e7\u00f5es industriais ou at\u00e9 70% do custo de equipamentos (Met\u00e1lica, 1999). Dentre as aplica\u00e7\u00f5es encontradas para tubula\u00e7\u00f5es internas a plantas industriais encontram-se, entre outros, fornos e trocadores de calor.\nFigura 1 - Classifica\u00e7\u00e3o das tubula\u00e7\u00f5es.\nFonte: (Ribeiro, 2007).\nTubula\u00e7\u00f5es recebem o nome de dutos quando s\u00e3o utilizados como meio de transporte de insumos. A principal vantagem do\ntransporte dutovi\u00e1rio \u00e9 a economia decorrente dos seus custos de instala\u00e7\u00e3o e opera\u00e7\u00e3o quando comparado aos transportes rodovi\u00e1rio e ferrovi\u00e1rio (Cimino, 2004). Tamb\u00e9m garantem abastecimento constante e previs\u00edvel, ao contr\u00e1rio de m\u00e9todos de transporte intermitente, como o rodovi\u00e1rio.\nA import\u00e2ncia financeira da ind\u00fastria de tubos e acess\u00f3rios no Brasil tamb\u00e9m \u00e9 altamente relevante, tendo faturado 7,5 bilh\u00f5es de reais no ano de 2009 (Rangel, 2010). Frente a um cen\u00e1rio de crescimento econ\u00f3mico, principalmente da \u00e1rea de petr\u00f3leo e g\u00e1s, especialistas da ind\u00fastria t\u00eam apontado estimativas de aumento do uso destes elementos, sendo que houve no primeiro semestre de 2010 um aumento da comercializa\u00e7\u00e3o de tubos met\u00e1licos de 15% a 20% na compara\u00e7\u00e3o com o mesmo per\u00edodo de 2009 (Rangel, 2010).\nTanto as tubula\u00e7\u00f5es internas \u00e0s plantas industriais quanto os dutos utilizados para transportes a longas dist\u00e2ncias ou explora\u00e7\u00e3o de mat\u00e9rias-primas est\u00e3o sujeitos a avarias, as quais podem ser decorrentes inclusive da pr\u00f3pria intera\u00e7\u00e3o com o material transportado. Neste cen\u00e1rio, um tipo de dano especialmente dif\u00edcil de detectar \u00e9 o da corros\u00e3o interna, pois n\u00e3o apresenta normalmente nenhum sinal externo de ocorr\u00eancia. Quando se fala em tubos de fornos de refinarias de petr\u00f3leo, por exemplo, as altas temperaturas e varia\u00e7\u00f5es t\u00e9rmicas \u00e0s quais est\u00e3o sujeitos causam tens\u00f5es internas, as quais provocam fadiga do material e geram microfissuras que, somadas \u00e0 alta energia interna (temperatura) do material transportado, aceleram o processo corrosivo. Na figura 2 pode ser vista uma regi\u00e3o corro\u00edda de um tubo de forno de refinaria.\nA corros\u00e3o interna tamb\u00e9m est\u00e1 presente em tubos de explora\u00e7\u00e3o de petr\u00f3leo e g\u00e1s (P&amp;G). Neste caso, pode ser citada como fator impulsionador da corros\u00e3o a presen\u00e7a de impurezas transportadas juntamente com o material explorado (p. ex., vapor de \u00e1gua em suspens\u00e3o no g\u00e1s). Altera\u00e7\u00f5es do perfil de escoamento dos fluidos transportados, causadas pela configura\u00e7\u00e3o geom\u00e9trica da tubula\u00e7\u00e3o utilizada, tamb\u00e9m s\u00e3o um fator de desgaste, causando maior corros\u00e3o em \u00e1reas pr\u00f3ximas \u00e0s juntas e curvas onde h\u00e1 escoamento turbulento. A figura 3 \u00e9 de uma regi\u00e3o severamente corro\u00edda de um tubo de explora\u00e7\u00e3o de g\u00e1s em um trecho pr\u00f3ximo a uma curva na tubula\u00e7\u00e3o.\nFigura 2 - Tubo de forno de refinaria apresentando corros\u00e3o interna.\nFonte: CENPES-Petrobras.\nFigura 3 - Trecho de gasoduto apresentando corros\u00e3o em regi\u00e3o brevemente Posterior a uma curva na tubula\u00e7\u00e3o.\n----F )\t, \u00bb.,a.\npostei\nr\n- > M\t//\u2022\nFonte: CENPES-Petrobras.\nA dificuldade da inspe\u00e7\u00e3o da corros\u00e3o interna, atrelada \u00e0 import\u00e2ncia de monitorar a integridade das tubula\u00e7\u00f5es industriais, causa grande demanda para a identifica\u00e7\u00e3o deste tipo de ocorr\u00eancia, especialmente em tubos de fornos em refinarias de petr\u00f3leo. A n\u00e3o detec\u00e7\u00e3o da corros\u00e3o interna em tempo pode levar \u00e0 falha e culminar em acidentes envolvendo estas tubula\u00e7\u00f5es. Isto causa preju\u00edzos ambientais, humanos, de lucros cessantes pela interrup\u00e7\u00e3o do uso da planta p\u00f3s-acidente, al\u00e9m de multas previstas na legisla\u00e7\u00e3o ambiental. Tais epis\u00f3dios tamb\u00e9m afetam a imagem da companhia envolvida.\nTal demanda tem motivado o desenvolvimento de novas ferramentas de inspe\u00e7\u00e3o geom\u00e9trica, agregando funcionalidade aos m\u00e9todos j\u00e1 existentes. Na categoria de m\u00e9todos de inspe\u00e7\u00e3o geom\u00e9trica \u00f3ptica, (Buschinelli, 2007) apresentou um sensor por triangula\u00e7\u00e3o c\u00f4nica a laser e mostrou que o mesmo \u00e9 capaz de medir, com muito boa precis\u00e3o, a geometria interna de uma sec\u00e7\u00e3o de tubo por vez, numa montagem compacta em rela\u00e7\u00e3o a outros m\u00e9todos. Este sensor utiliza um conjunto emissor de luz, neste caso, um laser e um espelho c\u00f4nico, que ilumina de forma especial a geometria da sec\u00e7\u00e3o a ser mensurada e uma c\u00e2mera que adquire a imagem da regi\u00e3o iluminada, al\u00e9m de um software para a extra\u00e7\u00e3o de um conjunto de pontos da imagem capturada em coordenadas polares.\nPara que este sensor se torne o cerne de um completo sistema de perfilagem interna de tubos, dando continuidade ao trabalho de (Buschinelli, 2007), \u00e9 necess\u00e1rio o desenvolvimento de ferramentas de hardware e software que possibilitem a aquisi\u00e7\u00e3o sucessiva do perfil geom\u00e9trico de sec\u00e7\u00f5es cont\u00edguas utilizando o sensor \u00f3ptico e consolide o resultado em uma \u00fanica nuvem de pontos que descreva a geometria interna medida. \u00c9 necess\u00e1rio oferecer tamb\u00e9m um m\u00e9todo adequado \u00e0 visualiza\u00e7\u00e3o intuitiva e correta interpreta\u00e7\u00e3o dos dados adquiridos.\nA demanda por averiguar periodicamente a integridade geom\u00e9trica de tubula\u00e7\u00f5es de fornos de refinarias brasileiras fortemente expostas \u00e0 corros\u00e3o motivou o desenvolvimento deste perfil\u00f4metro. Para isto, foi celebrado um projeto de pesquisa e desenvolvimento entre a Petrobras e a UFSC, executado pelo Laborat\u00f3rio de Metrologia e Automatiza\u00e7\u00e3o - LABMETRO/EMC - ao qual se deu o nome de PEROLA (nome formado a partir de \u201cperfilometria \u00f3ptica a laser aplicada a dutos\u201d). Dentro deste projeto est\u00e3o previstos a cria\u00e7\u00e3o de um dispositivo de perfilometria interna de tubos baseado no sensor \u00f3ptico por triangula\u00e7\u00e3o c\u00f4nica a laser, um dispositivo de perfilometria externa de tubos e um software capaz de apresentar a geometria das regi\u00f5es\nmensuradas por esses dispositivos de forma inovadora. E \u00e9 no contexto deste projeto que esta disserta\u00e7\u00e3o se insere.\n1.2\tOBJETIVO GERAL DA DISSERTA\u00c7\u00c3O\nEm sintonia com o contexto do Projeto PEROLA, este trabalho objetiva desenvolver as ferramentas de software e hardware necess\u00e1rias para integrar o sensor \u00f3ptico em uma solu\u00e7\u00e3o completa de perfilometria interna, permitindo a aplica\u00e7\u00e3o de um prot\u00f3tipo em tubos met\u00e1licos expostos \u00e0 corros\u00e3o que adquira a geometria da regi\u00e3o inspecionada e permita a posterior visualiza\u00e7\u00e3o de forma intuitiva e registro dos dados coletados.\n1.3\tOBJETIVOS ESPEC\u00cdFICOS\nTomando por base o objetivo geral e levando-se em conta os trabalhos j\u00e1 desenvolvidos ou em desenvolvimento na \u00e9poca do estabelecimento desta disserta\u00e7\u00e3o, foram definidos os seguintes objetivos espec\u00edficos:\n\u2022\tProjetar, implementar e validar em bancada um sistema embarcado de monitora\u00e7\u00e3o de navega\u00e7\u00e3o, respons\u00e1vel pela medi\u00e7\u00e3o dos deslocamentos axial e angular do perfil\u00f4metro interno e por disparar a medi\u00e7\u00e3o pelo sensor \u00f3ptico a laser, a partir do que j\u00e1 havia sido projetado em (Melo, 2009);\n\u2022\tProjetar, implementar e validar um m\u00f3dulo de software de controle da c\u00e2mera do sensor \u00f3ptico, tamb\u00e9m a partir do conceito desenvolvido em (Melo, 2009), e definir um protocolo de armazenamento das geometrias inspecionadas;\n\u2022\tProjetar, implementar e validar um sistema de realidade virtual (RV) para a visualiza\u00e7\u00e3o e an\u00e1lise dos dados adquiridos e dispostos no m\u00e9todo de armazenamento eleito.\nDentro do desenvolvimento do perfil\u00f4metro, n\u00e3o est\u00e1 no escopo desta disserta\u00e7\u00e3o o aprimoramento do sensor \u00f3ptico e de seu software de processamento, tampouco o projeto e execu\u00e7\u00e3o de seu corpo mec\u00e2nico, ainda que algumas decis\u00f5es entre estas \u00e1reas sejam tomadas de forma interativa.\n1.4\tESTRUTURA\nAp\u00f3s esta introdu\u00e7\u00e3o, revisam-se no cap\u00edtulo 2 as solu\u00e7\u00f5es atuais para inspe\u00e7\u00e3o geom\u00e9trica interna de tubos e apresentam-se algumas das ferramentas utilizadas para o desenvolvimento deste trabalho. O cap\u00edtulo 2.2 apresenta o sensor \u00f3ptico desenvolvido por (Buschinelli, 2007), em torno do qual o perfil\u00f4metro foi concebido. Os requisitos sist\u00eamicos estabelecidos para o perfil\u00f4metro e o projeto conceitual a ser desenvolvido para o cumprimento destes s\u00e3o mostrados no cap\u00edtulo 3. No cap\u00edtulo 4 \u00e9 apresentado o desenvolvimento do hardware e software que comp\u00f5em o sistema de aquisi\u00e7\u00e3o e disponibiliza\u00e7\u00e3o de imagens. O cap\u00edtulo 5 mostra o desenvolvimento de um sistema de realidade virtual para visualiza\u00e7\u00e3o do perfil geom\u00e9trico adquirido. No cap\u00edtulo 6 s\u00e3o vistos os resultados obtidos com a implementa\u00e7\u00e3o destes sistemas por testes em bancada do prot\u00f3tipo do perfil\u00f4metro e de seu software de visualiza\u00e7\u00e3o, al\u00e9m de resultados de inspe\u00e7\u00e3o de tubos realizada em campo. O cap\u00edtulo 8 cont\u00e9m considera\u00e7\u00f5es finais sobre a disserta\u00e7\u00e3o e sugest\u00f5es para melhoria e extens\u00e3o do projeto.\n2\tREVIS\u00c3O BIBLIOGR\u00c1FICA\nNeste cap\u00edtulo s\u00e3o apresentadas algumas solu\u00e7\u00f5es atuais e bem estabelecidas no mercado para a perfilometria interna de tubos. Tamb\u00e9m se apresenta o sensor desenvolvido por (Buschinelli, 2007), o qual ser\u00e1 explorado nesta disserta\u00e7\u00e3o. S\u00e3o ainda introduzidos alguns conceitos t\u00e9cnicos utilizados na elabora\u00e7\u00e3o da disserta\u00e7\u00e3o.\n2.1 M\u00c9TODOS DE INSPE\u00c7\u00c3O ATUAIS\nDevido \u00e0 import\u00e2ncia da inspe\u00e7\u00e3o da integridade geom\u00e9trica de tubos, seja na explora\u00e7\u00e3o de mat\u00e9rias-primas ou em tubos instalados em plantas industriais qu\u00edmicas e petroqu\u00edmicas, foram desenvolvidos v\u00e1rios m\u00e9todos capazes de apresentar a um engenheiro de inspe\u00e7\u00e3o, direta ou indiretamente, a presen\u00e7a de defeitos internos em tubos.\nAlguns destes dispositivos se enquadram na categoria de \u201cpigs\u201d, termo cuja origem hist\u00f3rica remonta aos primeiros dispositivos utilizados na limpeza interna de tubula\u00e7\u00f5es. O ru\u00eddo causado pelo atrito entre esses e a tubula\u00e7\u00e3o de metal se assemelhava ao grunhido de um porco (pig, em ingl\u00eas). Ainda assim, utiliza-se por vezes o termo como se fosse uma sigla, como Pipeline inspection gauge (ou gadget), algo como \u201caparelho de inspe\u00e7\u00e3o de tubula\u00e7\u00f5es\u201d, mesmo n\u00e3o sendo os pigs utilizados apenas para inspe\u00e7\u00e3o (Nestleroth, 2011).\nUm pig \u00e9, em ess\u00eancia, um dispositivo aut\u00f3nomo que passa atrav\u00e9s de uma tubula\u00e7\u00e3o ou duto, movido por press\u00e3o diferencial ou pelo pr\u00f3prio fluido, seja para fins de limpeza, preparo, inspe\u00e7\u00e3o ou mesmo escalonamento de material transportado (Nestleroth, 2011). Alguns dispositivos que s\u00e3o aplicados no interior de dutos e se deslocam ao longo de seu eixo, mesmo n\u00e3o cumprindo a defini\u00e7\u00e3o anterior, s\u00e3o muitas vezes chamados de pigs pelo corpo t\u00e9cnico industrial apenas por quest\u00e3o de simplicidade.\nDerivado do conceito de pig, o conceito de \u201cpigabilidade\u201d \u00e9 utilizado na ind\u00fastria para denotar a capacidade de um trecho de tubula\u00e7\u00e3o ou duto de ser compat\u00edvel com a aplica\u00e7\u00e3o de pigs. Normalmente, uma baixa pigabilidade \u00e9 relacionada \u00e0 presen\u00e7a de varia\u00e7\u00f5es de di\u00e2metro interno e curvas abruptas na tubula\u00e7\u00e3o, sendo que para diferentes t\u00e9cnicas, dependendo de suas caracter\u00edsticas, uma mesma tubula\u00e7\u00e3o pode ser mais ou menos \u201cpig\u00e1vel\u201d, como se pode inferir da revis\u00e3o a seguir.\nEntre os tipos de pig, aqueles cuja finalidade \u00e9 a inspe\u00e7\u00e3o s\u00e3o comumente chamados de \u201cpigs inteligentes\u201d ou \u201cpigs instrumentados\u201d,\npor serem dotados de maior elabora\u00e7\u00e3o tecnol\u00f3gica do que pigs de limpeza ou escalonamento. Podem, por exemplo, cumprir a fun\u00e7\u00e3o de perfil\u00f3metros geom\u00e9tricos, ou seja, medem o perfil geom\u00e9trico da regi\u00e3o de duto em que s\u00e3o aplicados.\nExistem tamb\u00e9m m\u00e9todos de inspe\u00e7\u00e3o geom\u00e9trica que n\u00e3o se enquadram como pigs, ou seja, n\u00e3o s\u00e3o \u201cpassados\u201d pelo interior do duto no sentido do deslocamento do fluido transportado. Estes geralmente s\u00e3o de aplica\u00e7\u00e3o externa e localizada, provavelmente sendo seu uso requerido ap\u00f3s uma pr\u00e9-identifica\u00e7\u00e3o de um poss\u00edvel defeito interno, possivelmente resultado de uma inspe\u00e7\u00e3o pr\u00e9via com pig.\nA seguir, uma breve revis\u00e3o sobre alguns dos dispositivos citados.\n2.1.1 Pig Palito\nO Pig Palito \u00e9 um desenvolvimento do CENPES - Petrobras em conjunto com a PUC-Rio, especificamente projetado para identificar e quantificar geometricamente a corros\u00e3o interna, segundo (Franzoi et al, 2005). Seu nome vem das hastes montadas ao redor de coroas circulares componentes do dispositivo. Esta caracter\u00edstica pode ser observada na figura 4, onde se v\u00ea uma montagem para dutos de 560 mm de di\u00e2metro (22\u201d).\nAo longo dos \u00faltimos anos, prot\u00f3tipos dimensionados para tubos de diferentes di\u00e2metros (variando de 100 a 560 mm ou 4\u201d a 22\u201d) v\u00eam sendo constru\u00eddos, n\u00e3o se tratando apenas, portanto, de um \u00fanico dispositivo, mas sim de um conceito. Para cada di\u00e2metro de tubo a ser inspecionado \u00e9 utilizada uma configura\u00e7\u00e3o diferente. Na figura 5 pode ser visto um prot\u00f3tipo de um pig palito com intervalo de medi\u00e7\u00e3o mais amplo, sendo adequado para di\u00e2metros de tubos variando de 100 a 180 mm (4\u201d a 7\u201d).\nAs hastes do Pig Palito tem uma posi\u00e7\u00e3o de fim de curso que mant\u00e9m suas extremidades num ponto de maior valor radial do que o raio interno m\u00e1ximo esperado do tubo a ser aplicado, o que tamb\u00e9m pode ser verificado na figura 4. A posi\u00e7\u00e3o de fim de curso das hastes \u00e9 de um \u00e2ngulo maior do que 90\u00b0 em rela\u00e7\u00e3o ao eixo do pr\u00f3prio sistema na qual est\u00e3o montadas, a contar do vetor ao longo de cujo sentido o sistema se desloca. Portanto, ao adentrar o tubo, estas hastes s\u00e3o empurradas por uma mola contra a superf\u00edcie do tubo de modo a assumir em suas extremidades o valor radial do ponto em que tocam as paredes internas do tubo. Para que se obtenha este valor de raio, s\u00e3o utilizados sensores de efeito hall nas bases de cada haste. Medindo-se o valor do\n\u00e2ngulo de inclina\u00e7\u00e3o das hastes, dado o comprimento das mesmas, pode-se determinar o valor do raio interno do ponto tocado.\nFigura 4 - Uma das montagens do Pig Palito. Destaque para as hastes ao redor\ndas pe\u00e7as mais centrais. \u2019 III I\nFonte: CENPES-Petrobras.\nFigura 5 - Outra montagem de um pig palito projetada para dutos de tamanhos vari\u00e1veis entre 100 a 180 mm (4\" a 7\").\nFonte: PUC-RIO / CENPES-Petrobras.\nEsta caracter\u00edstica do pig palito confere-lhe a vantagem de poder ser aplicado em dutos cuja limpeza n\u00e3o removeu completamente os res\u00edduos l\u00edquidos presentes (ou s\u00f3lidos com comportamento similar ao de p\u00f3 ou detritos).\nO n\u00famero limitado de hastes contidas em cada coroa circular limita a resolu\u00e7\u00e3o angular com que \u00e9 poss\u00edvel medir a superf\u00edcie interna. A limita\u00e7\u00e3o na resolu\u00e7\u00e3o angular de cada coroa circular com hastes \u00e9 superada ao se combinar algumas delas de forma que as orienta\u00e7\u00f5es angulares estejam adequadamente deslocadas umas das outras. Por exemplo, na montagem apresentada em (Franzoi et al, 2005), dimensionada para um duto de 560 mm (22\u201d) e mostrada na figura 4, foram combinadas cinco coroas circulares de 50 hastes cada uma, deslocadas angularmente entre si de 1,44\u00b0, aumentando para 250 o n\u00famero de pontos medidos ao longo de cada sec\u00e7\u00e3o interna de tubo inspecionado. A contrapartida fica pelo aumento do comprimento total do sistema. Na figura 5 pode-se observar este aumento ao passo que se utilizam ali componentes com apenas cinco hastes.\nAinda segundo (Franzoi et al, 2005), a menor largura de defeito de perda de material inspecion\u00e1vel pelo Pig Palito \u00e9 do valor do di\u00e2metro na extremidade da haste utilizada, pois esta precisa adentrar o defeito. J\u00e1 a maior largura de defeito possivelmente n\u00e3o detect\u00e1vel \u00e9\nobtida combinando-se o n\u00famero de sensores da montagem com a circunfer\u00eancia nominal da sec\u00e7\u00e3o transversal do tubo inspecionado. Na montagem citada, este valor \u00e9 de aproximadamente 7 mm, tamb\u00e9m denominado resolu\u00e7\u00e3o circunferencial do sistema.\nPara o referenciamento do valor de raio ao longo do eixo do tubo inspecionado, o Pig Palito utiliza dois hod\u00f3metros baseados em sensores de efeito hall. O sinal senoidal obtido destes sensores \u00e9 utilizado para mapear os valores dos raios medidos pelas hastes para diferentes posi\u00e7\u00f5es angulares. A resolu\u00e7\u00e3o axial depende, segundo (Franzoi et al, 2005), da velocidade de deslocamento e da taxa de amostragem do sistema. No artigo citado, na velocidade de deslocamento de 1 m/s e 512 Hz de taxa de amostragem, a resolu\u00e7\u00e3o axial obtida foi de 2 mm.\nO resultado da medi\u00e7\u00e3o \u00e9 apresentado em um software em vis\u00e3o planificada, dispondo os valores de raio capturados pelos sensores em rela\u00e7\u00e3o ao eixo do tubo e ao \u00e2ngulo da sec\u00e7\u00e3o do duto correspondente a cada haste. A figura 6, extra\u00edda de (Franzoi et al, 2005), \u00e9 um exemplo da apresenta\u00e7\u00e3o dos dados ao usu\u00e1rio em um tubo que apresenta corros\u00e3o. O eixo das abscissas corresponde \u00e0 posi\u00e7\u00e3o axial do duto. O eixo das ordenadas, \u00e0 posi\u00e7\u00e3o angular correspondente da haste. Os valores de raio s\u00e3o representados por uma escala de cores que varia de verde (sem perda de material) a vermelho (maior perda de material detectada), calibrada de acordo com a especifica\u00e7\u00e3o da montagem.\nFigura 6 - Apresenta\u00e7\u00e3o dos dados coletados pelo Pig Palito. Os pontos em vermelho representam ocorr\u00eancia de perda de material.\nFonte: (Franzoi et al, 2005).\nA interpreta\u00e7\u00e3o por software dos dados coletados tamb\u00e9m permite a emiss\u00e3o de relat\u00f3rios, os quais podem conter dados como ocorr\u00eancias de defeitos, seu volume estimado e sua localiza\u00e7\u00e3o.\n2.1.2\tPig magn\u00e9tico\nO pig magn\u00e9tico de corros\u00e3o ou MFL (do ingl\u00eas Magnetic Flux Leakage) \u00e9, segundo (Nestleroth, 2011), o pig de inspe\u00e7\u00e3o mais comum na ind\u00fastria. As primeiras unidades come\u00e7aram a ser usadas em 1966. Desde l\u00e1 aos dias de hoje t\u00eam passado por constante desenvolvimento (Bubenik, 2011). O CENPES - Petrobras tamb\u00e9m conta com sua implementa\u00e7\u00e3o desta t\u00e9cnica (Oliveira &amp; Camerini, 2002).\nSeu funcionamento baseia-se na detec\u00e7\u00e3o de fuga de fluxo magn\u00e9tico. Esta fuga acontece quando um campo magn\u00e9tico induzido em um corpo tem suas linhas de fluxo passando por um caminho diferente daquele que seria encontrado em um corpo com geometria inalterada, isto \u00e9, passando por regi\u00f5es com anomalias geom\u00e9tricas ou na permeabilidade magn\u00e9tica.\nNo caso espec\u00edfico de detec\u00e7\u00e3o de perda de material em uma chapa ou na parede de um tubo met\u00e1lico, deve haver um sensor de fluxo magn\u00e9tico - sensor de efeito hall ou sensor magn\u00e9tico de proximidade -entre os polos norte e sul do indutor. O fluxo magn\u00e9tico tende a passar pelo caminho mais f\u00e1cil, ou seja, atrav\u00e9s do corpo de maior permeabilidade magn\u00e9tica localizado entre os polos sul e norte indutores (Halliday, 2004). \u00c0 medida que o material \u00e9 saturado pelo fluxo magn\u00e9tico, algumas linhas de fluxo come\u00e7am a se dispersar, conforme ilustrado na figura 7, adaptada de (Bubenik, 2011).\nFigura 7 - Fluxo magn\u00e9tico induzido passando (a) pelo ar, (b) quase totalmente pela chapa met\u00e1lica colocada e (c) com algumas linhas de fluxo em fuga, causada pela diminui\u00e7\u00e3o da espessura da chapa naquela regi\u00e3o.\nFonte: (Bubenik, 2011).\nA presen\u00e7a de sensores de fluxo magn\u00e9tico ao lado do corpo met\u00e1lico entre os polos norte e sul do indutor permite avaliar a intensidade da fuga, e \u00e9 esse o m\u00e9todo utilizado nos pigs MFL que contam com este tipo de sensor entre escovas indutoras. Os modelos chamados \u201ccircunferenciais\u201d t\u00eam as escovas dispostas de modo que suas linhas de fluxo magn\u00e9tico sejam tangentes \u00e0 circunfer\u00eancia da sec\u00e7\u00e3o do tubo, como na figura 8 (Nestleroth, 2011). J\u00e1 os modelos \u201caxiais\u201d\ncontam com as escovas dispostas em coroas, enquanto que os sensores de fluxo magn\u00e9tico s\u00e3o posicionados entre estas coroas, como na figura 9 (Bubenik, 2011) e na figura 10 (Oliveira &amp; Camerini, 2002).\nFigura 8 - Um modelo de pig MFL cincunferencial da empresa Battelle, EUA.\nDestaque para a dire\u00e7\u00e3o do fluxo magn\u00e9tico imposto pelo dispositivo.\nFonte: (Nestleroth, 2011).\nA principal diferen\u00e7a entre os dois modelos est\u00e1 no tipo de defeito detectado com maior facilidade. Defeitos de perda de material cujo formato pode se dispor ao longo do sentido das linhas do fluxo magn\u00e9tico s\u00e3o mais dif\u00edceis de serem verificados, pois \u201cse assemelham a rochas em um rio\u201d (Bubenik, 2011). Se a rocha se dispuser perpendicularmente ao sentido da vaz\u00e3o da \u00e1gua, haver\u00e1 maior turbul\u00eancia causada por ela, enquanto que uma rocha longa e estreita cuja maior dimens\u00e3o est\u00e1 ao longo do sentido de vaz\u00e3o da \u00e1gua pouco afetar\u00e1 o escoamento da mesma.\nFigura 9 - Um modelo de pig MFL axial da empresa Det Norske Veritas, Noruega.\nFonte: (Bubenik, 2011).\nFigura 10 - Um modelo de pig MFL axial do CENPES - Petrobras.\nFonte: (Oliveira &amp; Camerini, 2002).\nLogo, os pigs MFL cincunferencial e axial devem ser usados ao se ter conhecimento pr\u00e9vio dos tipos de defeitos mais provavelmente encontrados no tipo de duto em que ser\u00e3o utilizados ou em complemento um ao outro.\nQuanto \u00e0 detec\u00e7\u00e3o de movimento e mapeamento das medi\u00e7\u00f5es, os pigs MFL se assemelham ao pig palito do CENPES - Petrobras, no que pode ser considerado um padr\u00e3o de montagem de pigs instrumentados em geral, conforme se conclui a partir de (Nestleroth, 2011).\nMedindo o fluxo magn\u00e9tico de fuga o pig MFL \u00e9 capaz, portanto, de estimar volumes de perda ou ac\u00famulo de material nas regi\u00f5es por onde passa. N\u00e3o \u00e9 capaz, no entanto, de detectar a forma deste defeito, j\u00e1 que seus sensores detectam apenas aumento ou diminui\u00e7\u00e3o do fluxo magn\u00e9tico nas suas posi\u00e7\u00f5es. A figura 11, adaptada de (Bubenik, 2011), \u00e9 um exemplo dos dados coletados pelos sensores do pig MFL, neste caso, um pig circunferencial. Cada linha corresponde aos dados de um sensor ao longo do deslocamento em uma regi\u00e3o de um tubo. Os picos identificam perda de material. Vales identificariam ac\u00famulo, mas n\u00e3o est\u00e3o presentes nesta amostra. Evidenciados em tracejado, picos que sugerem pequenas perdas; em linhas cheias, sugest\u00f5es de grandes perdas.\nFigura 11 - Dados coletados pelos sensores de um pig MFL da empresa Det Norske Veritas.\nFonte: (Bubenik, 2011).\nNa figura 11, cada linha correspondente a um sensor est\u00e1 distanciada de 7,5\u00b0 (ou 15 minutos em escala hor\u00e1ria) uma da outra, promovendo, neste caso, uma resolu\u00e7\u00e3o angular mais grosseira que a do pig palito. No entanto, esta limita\u00e7\u00e3o \u00e9 secund\u00e1ria, dado que o pig MFL obt\u00e9m medidas proporcionais ao volume de material perdido ou\ndepositado, ainda lembrando que seu sinal \u00e9 influenciado pela forma dos defeitos encontrados.\nOs dados coletados podem ser dispostos, atrav\u00e9s de tratamento por software, tamb\u00e9m em vista planificada e com o aux\u00edlio de um mapa de cores. Na figura 12, ao inv\u00e9s de um tra\u00e7ado, as linhas correspondentes a cada sensor t\u00eam seus valores representados atrav\u00e9s de pontos coloridos. Neste mapa, a cor azul representa ac\u00famulo de material, a verde representa regi\u00e3o com espessura esperada (ou pr\u00f3xima dela) e as cores amarela e vermelha representam perda de material. A disposi\u00e7\u00e3o dos dados em abscissas e ordenadas segue o padr\u00e3o da figura 11.\nFigura 12 - Uma representa\u00e7\u00e3o dos dados obtidos por um pig MFL utilizando\nc\u00f3digo de cores para os valores de raio obtidos.\nFonte: (Bubenik, 2011).\nAs montagens dos pigs MFL s\u00e3o adequadas a dutos de grandes di\u00e2metros e oferecem pouca flexibilidade quanto a dutos multidi\u00e2metros (dutos cujos tubos componentes s\u00e3o de diferentes di\u00e2metros), dado que os sensores trabalham melhor mais pr\u00f3ximos \u00e0 parede do duto. O trabalho de (Oliveira &amp; Camerini, 2002), inclusive, cita o desenvolvimento de um pig MFL no CENPES - Petrobras para \u201cdi\u00e2metro de 10 polegadas, menor di\u00e2metro poss\u00edvel ap\u00f3s otimiza\u00e7\u00e3o [...] do hardware\u201d.\n2.1.3\tPig ultrass\u00f3nico\nO pig ultrass\u00f3nico, dispon\u00edvel a partir de 1986, segundo (Nestleroth, 2011), foi criado para tentar superar a principal limita\u00e7\u00e3o do\nMFL, que \u00e9 incapaz de detectar a forma dos defeitos encontrados ao longo de um tubo. Utiliza transdutores de ultrassom radialmente dispostos ao redor do seu eixo, seguindo o modelo dos outros pigs. Na figura 13 pode-se observar como \u00e9 esta disposi\u00e7\u00e3o, ressaltando a import\u00e2ncia de se utilizar v\u00e1rias coroas defasadas angularmente uma da outra (como no pig palito) para se atingir a resolu\u00e7\u00e3o angular desejada, tamb\u00e9m com a contrapartida do aumento do comprimento do cabe\u00e7ote.\nUma limita\u00e7\u00e3o do pig ultrass\u00f3nico \u00e9 a necessidade de se utilizar, para sua aplica\u00e7\u00e3o, um fluido acoplador, como a \u00e1gua. Vale ressaltar que, em caso de extrema necessidade, pigs de separa\u00e7\u00e3o (ou escalonamento) podem ser utilizados para isolar o pig de ultrassom numa regi\u00e3o onde fique submerso.\nOs transdutores ultrass\u00f3nicos medem a espessura da parede do duto onde s\u00e3o aplicados atrav\u00e9s do tempo de viagem das ondas ac\u00fasticas emitidas pelos pr\u00f3prios. Desta forma, o pig ultrass\u00f3nico \u00e9 capaz de identificar a perda de material tanto interna quanto externa, sem pod\u00ea-las diferenciar, no entanto.\nFigura 13 - Concep\u00e7\u00e3o art\u00edstica de um pig ultrass\u00f3nico dentro de um duto. Destaque para os transdutores ultrass\u00f3nicos.\nFonte: (Balzer, 2011).\nUma forma alternativa de se utilizar a t\u00e9cnica de ultrassom na inspe\u00e7\u00e3o geom\u00e9trica de dutos est\u00e1 sendo desenvolvida pelo LAMEF/UFGRS (Strohaecker, 2010). Trata-se de um rob\u00f3 inspetor de dutos utiliz\u00e1vel pelo lado externo, ao qual se pode acoplar um conjunto\nde transdutores de ultrassom e um ejetor de \u00e1gua para garantir o acoplamento ac\u00fastico. A montagem deste rob\u00f4 em opera\u00e7\u00e3o pode ser vista na figura 14 (LAMEF/UFRGS, 2011). As letras que podem ser percebidas na figura s\u00e3o regi\u00f5es do cilindro com menor espessura, simulando defeitos de perda de material.\nEnquanto o pig ultrass\u00f4nico \u00e9 adequado \u00e0 utiliza\u00e7\u00e3o em dutos \u201cpig\u00e1veis\u201d, assim como o pig magn\u00e9tico, o inspetor externo \u00e9 adequado para uso pr\u00f3ximo a juntas ou outras regi\u00f5es onde n\u00e3o \u00e9 vi\u00e1vel a inser\u00e7\u00e3o de um pig.\nFigura 14 - Um rob\u00f4 com transdutor ultrass\u00f4nico utiliz\u00e1vel na parte externa de dutos.\nFonte: (LAMEF/UFRGS).\nOs dados coletados pela t\u00e9cnica ultrass\u00f4nica s\u00e3o apresentados como os do pig palito, em vista planificada e utilizando um mapa de cores relativo ao valor mensurado. A figura 15 \u00e9 a apresenta\u00e7\u00e3o do mesmo trecho de duto medido em (Franzoi et al, 2005) por um pig ultrass\u00f4nico. J\u00e1 a figura 16 (LAMEF/UFRGS, 2011), \u00e9 uma tela de software apresentando uma medi\u00e7\u00e3o realizada pelo inspetor de dutos de (Strohaecker, 2010) na forma de textura mapeada em um modelo de cilindro, de forma a representar visualmente onde se encontram aquelas caracter\u00edsticas identificadas.\nFigura 15 - Uma visualiza\u00e7\u00e3o do resultado obtido por um pig ultrass\u00f3nico.\nFonte: (Franzoi et al, 2005).\nFigura 16 - O resultado da medi\u00e7\u00e3o do corpo de prova apresentado na figura 14. A imagem resultante foi mapeada como textura em um cilindro virtual.\nFonte: (LAMEF/UFRGS, 2011).\n2.2\tO SENSOR \u00d3PTICO POR TRIANGULA\u00c7\u00c3O C\u00d4NICA A LASER\nNesta se\u00e7\u00e3o \u00e9 apresentado o sensor \u00f3ptico desenvolvido por (Buschinelli, 2007) com o objetivo de se compreender melhor suas caracter\u00edsticas e as necessidades que norteiam esta disserta\u00e7\u00e3o. O perfil\u00f4metro a cujo desenvolvimento se contribui com este texto \u00e9 baseado no sensor a seguir apresentado.\n2.2.1\tDEMANDA\nA resolu\u00e7\u00e3o limitada do mapeamento geom\u00e9trico dos m\u00e9todos de inspe\u00e7\u00e3o comumente utilizados na ind\u00fastria deixa a desejar, principalmente em se tratando de defeitos de maior complexidade geom\u00e9trica, como aqueles causados por corros\u00e3o interna. Igualmente, a necessidade de inspe\u00e7\u00e3o de tubos de di\u00e2metro igual ou menor que 150 mm (pouco menos de 6\u201d), como os presentes em fornos de refinarias, n\u00e3o \u00e9 bem atendida pelos m\u00e9todos dispon\u00edveis, os quais s\u00e3o mais facilmente aplic\u00e1veis a tubos de maior di\u00e2metro interno, conforme apresentado no item 2.1. Em suas vers\u00f5es aplicadas a tubos de menor di\u00e2metro, as tecnologias descritas apresentam baixa resolu\u00e7\u00e3o angular, o que impede um mapeamento geom\u00e9trico mais detalhado.\nNos casos onde \u00e9 necess\u00e1ria a perfilagem da superf\u00edcie interna da tubula\u00e7\u00e3o com resolu\u00e7\u00e3o radial da ordem de d\u00e9cimos de mil\u00edmetro, m\u00e9todos \u00f3pticos apresentam-se como uma solu\u00e7\u00e3o atrativa, desde que a superf\u00edcie da tubula\u00e7\u00e3o esteja adequadamente limpa1.\n2.2.2\tCONCEITO\nPara superar estas dificuldades, foi explorado o conceito de triangula\u00e7\u00e3o \u00f3ptica a laser. Esta t\u00e9cnica envolve a proje\u00e7\u00e3o de um feixe de luz a uma superf\u00edcie cuja geometria se deseja mensurar. Uma c\u00e2mera deve estar obliquamente apontada para a regi\u00e3o em que a luz \u00e9 projetada no mensurando de modo que se possa relacionar a imagem adquirida pela c\u00e2mera \u00e0s caracter\u00edsticas geom\u00e9tricas desejadas do objeto atrav\u00e9s\n1 A tubula\u00e7\u00e3o deve estar suficientemente limpa de forma a evitar o dep\u00f3sito de material (como \u00f3leo ou poeira) na parte \u00f3ptica do sistema, o que pode vir a degradar o resultado de medi\u00e7\u00e3o ou impedi-la completamente. Res\u00edduos presentes tamb\u00e9m poderiam vir a ser erroneamente interpretados como parte da geometria do mensurando.\ndo processamento desta imagem, dada uma calibra\u00e7\u00e3o adequada da montagem e do algoritmo utilizado. Em um exemplo utilizando-se um plano de luz laser, a imagem capturada pela c\u00e2mera cont\u00e9m um tra\u00e7ado luminoso correspondente \u00e0 intersec\u00e7\u00e3o entre o plano da luz laser e a sec\u00e7\u00e3o correspondente do mensurando (figura 17). Sabendo-se a posi\u00e7\u00e3o e orienta\u00e7\u00e3o da c\u00e2mera, deve-se realizar uma calibra\u00e7\u00e3o do algoritmo utilizado para que seja poss\u00edvel medir a geometria do mensurando.\nNo caso espec\u00edfico do sensor \u00f3ptico desenvolvido por (Buschinelli, 2007) foi aplicada a triangula\u00e7\u00e3o c\u00f4nica a laser, onde se gera o plano de luz a partir de uma fonte laser linear apontada para a ponta de um espelho c\u00f4nico, conforme mostra a figura 18.\nFigura 18 - Conceito de triangula\u00e7\u00e3o \u00f3ptica c\u00f4nica a laser aplicado no sensor.\nTubo\t\t\t\tPlano de luz radial\t\t\n\tC\u00e2mera\t\t\t\t\t\n\t\t\u25a0y-\"\"\"\t1 b\t\t\t\n\t\tLente\t*1\t1/ Espelho\t\tLaser\t\nc\u00f4nico\nCom esta disposi\u00e7\u00e3o, utilizando-se um espelho c\u00f4nico cujo \u00e2ngulo da geratriz \u00e9 de 45\u00b0, cria-se um plano de luz perpendicular ao eixo \u00f3ptico do conjunto espelho/feixe laser. A luz neste caso se propaga radialmente, tornando o plano de luz ideal \u00e0 aplica\u00e7\u00e3o interna em pe\u00e7as cil\u00edndricas, caso em que este plano de luz intercepta o contorno interno da sec\u00e7\u00e3o a ser mensurada, formando um padr\u00e3o anelar. A c\u00e2mera deve ent\u00e3o estar posicionada ao longo do eixo do sistema de modo a adquirir a imagem resultante desta intersec\u00e7\u00e3o.\n2.2.3\tO PROT\u00d3TIPO DESENVOLVIDO\nO prot\u00f3tipo apresentado por (Buschinelli, 2007) \u00e9 disposto como na figura 18. Ele foi desenvolvido de modo a medir a geometria interna de uma sec\u00e7\u00e3o por vez de um tubo de 154 mm (6\u201d) de di\u00e2metro, conforme demanda industrial identificada.\nPara se obter quantitativamente o perfil geom\u00e9trico da sec\u00e7\u00e3o mensurada, a imagem adquirida pela c\u00e2mera do sensor \u00e9 processada2 de modo a fornecer um conjunto de pontos em coordenadas polares. Tem-se, desta forma, um algoritmo cuja entrada \u00e9 uma imagem que contem a proje\u00e7\u00e3o do laser nas paredes internas da sec\u00e7\u00e3o examinada. A sa\u00edda deste algoritmo \u00e9 uma lista de valores de ponto flutuante, conforme ilustra a figura 19. Cada valor na lista representa o raio medido para o \u00e2ngulo correspondente \u00e0 sua posi\u00e7\u00e3o na lista. Os valores s\u00e3o distribu\u00eddos igualmente ao longo de uma volta completa, fazendo que a resolu\u00e7\u00e3o angular resultante do algoritmo seja (360/n)\u00b0, onde n \u00e9 o n\u00famero de valores de raio obtidos.\n2\tUtilizando placa de v\u00eddeo (GPU) de modo a reduzir o tempo de processamento (Buschinelli, 2012).\nFigura 19 - O algoritmo do software de medi\u00e7\u00e3o transforma uma imagem numa lista de valores de ponto-flutuante. Cada valor da lista corresponde ao raio encontrado para o \u00e2ngulo representado pela \u00ed -\u00e9sima posi\u00e7\u00e3o na lista.\nFonte: Autor.\nUm exemplo de imagem capturada pelo dispositivo est\u00e1 na figura 20.\nFigura 20 - Uma imagem capturada pelo sensor \u00f3ptico. A faixa mais clara \u00e9 advinda do laser projetado na superf\u00edcie interna do tubo.\nFonte: LABMETRO-UFSC.\nPara fins de avalia\u00e7\u00e3o do sensor, diferentes configura\u00e7\u00f5es de teste foram realizadas em bancada. Uma delas utilizava um gabarito representante de uma sec\u00e7\u00e3o de um tubo com defeitos de geometria bem conhecida, como pode ser visto na figura 21 (Buschinelli, 2007). O conjunto emissor foi posicionado de modo a iluminar a superf\u00edcie interna deste gabarito, montagem esta que serviu para a realiza\u00e7\u00e3o de ensaios que validassem as caracter\u00edsticas metrol\u00f3gicas deste novo sensor.\nNa sua concep\u00e7\u00e3o mais atual, o espelho c\u00f4nico vis\u00edvel na figura 21 foi removido. Na figura 22 pode ser vista esta concep\u00e7\u00e3o atual aplicada a um padr\u00e3o de calibra\u00e7\u00e3o anelar, enquanto que na figura 23 ela pode ser vista aplicada ao mesmo gabarito da figura 21.\nFigura 21 - Uma das primeiras montagens do sensor \u00f3ptico a laser em bancada\n(Buschinelli, 2007). Na \u00e9poca era utilizado um segundo espelho c\u00f4nico disposto\nde frente a c\u00e2mera, o qual foi removido nas concep\u00e7\u00f5es atuais.\nPadr\u00e3o Escalonado\nGabarito\nMesa microm\u00e9trica (dire\u00e7\u00e3o y)\nFixa\u00e7\u00e3o do sistema\nMesa microm\u00e9trica (dire\u00e7\u00e3o z)\nMesa microm\u00e9trica (dire\u00e7\u00e3o x)\nFonte: (Buschinelli, 2007).\nFigura 22 - Foto do sensor \u00f3ptico, em sua concep\u00e7\u00e3o atual, aplicado a um padr\u00e3o de calibra\u00e7\u00e3o anelar.___________________\nFonte: LABMETRO-UFSC.\nFigura 23 - Sensor \u00f3ptico a laser, em sua concep\u00e7\u00e3o atual, aplicado a um gabarito geom\u00e9trico.\nFonte: LABMETRO-UFSC.\nNa figura 24 \u00e9 apresentado o resultado de uma medi\u00e7\u00e3o deste gabarito realizada pelo sensor \u00f3ptico a laser em coordenadas polares. Nesta figura o resultado da medi\u00e7\u00e3o do sensor \u00e9 comparado ao resultado obtido por uma m\u00e1quina de medir por coordenadas (MMC), o qual \u00e9 o valor de refer\u00eancia.\nFigura 24 - Resultado de medi\u00e7\u00e3o, realizada pelo sensor \u00f3ptico, do gabarito da figura 21. \u00c9 mostrado tamb\u00e9m o valor dos raios dos pontos do gabarito obtidos por uma m\u00e1quina de medir por coordenadas.\nA resolu\u00e7\u00e3o geom\u00e9trica obtida pelo sensor est\u00e1 intimamente relacionada ao tamanho da matriz de pixels da c\u00e2mera utilizada. As principais caracter\u00edsticas do sensor \u00f3ptico a laser em seu estado de desenvolvimento atual s\u00e3o listadas a seguir (Buschinelli et al, 2012) (Buschinelli, 2012):\n\u2022\tResolu\u00e7\u00e3o angular: 0,25\u00b0 (1440 valores de raios obtidos por sec\u00e7\u00e3o);\n\u2022\tResolu\u00e7\u00e3o circunferencial m\u00e1xima: &lt;0,5 mm;\n\u2022\tResolu\u00e7\u00e3o radial de 0,01 mm;\n\u2022\tC\u00e2mera Gigabit Ethernet (GigE), com resolu\u00e7\u00e3o de 1024 x 1024 e aquisi\u00e7\u00e3o de 60 quadros por segundo;\n\u2022\tFaixa de medi\u00e7\u00e3o radial: 64,4 a 88,4 mm;\n\u2022\tIncerteza radial: \u00b1 0,3 mm;\n\u2022\tTempo de processamento de 2,1 ms utilizando GPU3.\n3\tConforme testes realizados em um notebook com processador Intel Core i7\u00ae e placa de v\u00eddeo NVidia GTX 285M\u00ae (Buschinelli, 2012).\nCabe ressaltar que a resolu\u00e7\u00e3o circunferencial na regi\u00e3o de aplica\u00e7\u00e3o depende do raio desta regi\u00e3o, pois a resolu\u00e7\u00e3o angular \u00e9 sempre fixa. Quanto maior for o raio da regi\u00e3o mensurada, maior \u00e9 a dist\u00e2ncia circunferencial, em mil\u00edmetros, entre dois pontos mensurados. O valor de 0,5 mm citado no par\u00e1grafo anterior se refere \u00e0 resolu\u00e7\u00e3o circunferencial nos valores m\u00e1ximos da calibra\u00e7\u00e3o radial, pr\u00f3ximos a\n88,4\tmm.\nPortanto, com as caracter\u00edsticas metrol\u00f3gicas apresentadas acima, mostrou-se que este sensor era capaz de atingir um grau de detalhamento geom\u00e9trico para uma sec\u00e7\u00e3o superior \u00e0quele dos m\u00e9todos de inspe\u00e7\u00e3o avaliados. Suas caracter\u00edsticas o tornam adequado \u00e0 demanda de inspe\u00e7\u00e3o de tubos de di\u00e2metro da ordem de 150 mm, al\u00e9m de possibilitar a apresenta\u00e7\u00e3o do perfil geom\u00e9trico da sec\u00e7\u00e3o mensurada.\nConforme citado em (Buschinelli, 2007), o sensor \u00f3ptico pode ser utilizado em um sistema de medi\u00e7\u00e3o de perfil interno, n\u00e3o apenas de uma sec\u00e7\u00e3o, mas de toda a geometria interna do tubo, desde que disponha de hardware e software adequado. Estes hardware e software devem realizar a aquisi\u00e7\u00e3o do perfil automaticamente para cada sec\u00e7\u00e3o e fundir o resultado destas em um \u00fanico conjunto de dados representativo da geometria interna da regi\u00e3o de tubo medida. \u00c9 necess\u00e1ria, por fim, uma ferramenta que permita ao analista realizar a leitura da geometria adquirida e extrair dela informa\u00e7\u00f5es de interesse.\n2.3\tT\u00c9CNICAS UTILIZADAS NO TRABALHO\nO projeto estabelecido nesta disserta\u00e7\u00e3o \u00e9 apresentado no item\n1.3\te detalhado no item 3.3. Para o desenvolvimento do sistema de aquisi\u00e7\u00e3o e disponibiliza\u00e7\u00e3o de imagens, foi utilizado o conceito de sistemas embarcados. Para o desenvolvimento do software de visualiza\u00e7\u00e3o, foram utilizados os conceitos de computa\u00e7\u00e3o gr\u00e1fica e realidade virtual. Estes conceitos s\u00e3o brevemente introduzidos a seguir.\n2.3.1\tSistemas embarcados\nUm sistema embarcado (ou sistema embutido, SE) \u00e9 um sistema composto de hardware e software dedicado a uma fun\u00e7\u00e3o espec\u00edfica, geralmente parte de um sistema mais amplo - diferentemente de PCs, os quais s\u00e3o plataformas computacionais gen\u00e9ricas (Berger, 2002) (M\u00fcllerburg, 1999) (Oshana, 2006). Sistemas embarcados est\u00e3o por toda parte: no escrit\u00f3rio, em casa, no hospital, na ind\u00fastria. Exemplos se encontram em m\u00e1quinas de lavar, impressoras, inje\u00e7\u00f5es eletr\u00f4nicas de\nautom\u00f3veis e em brinquedos (Wilmshurst, 2007). Uma descri\u00e7\u00e3o visual da organiza\u00e7\u00e3o de um sistema embarcado pode ser vista na figura 25, adaptada de (Koopman, 1996).\nFigura 25 - Esquema geral de um sistema embarcado.\nJ\t\t : software:\t\tSISTEMAS\n\t\tAUXILIARES\nFPGA/ ASIC\tImem\u00f3riaI\t(ALIMENTA\u00c7\u00c3O. DISSIPA\u00c7\u00c3O.\n\t\tETC)\n....DE\n\u25a0M DIAGN\u00d3STICO\nCONVERS\u00c3O\nINTERFACE HOMEM-M\u00c1QUINA\nJk\n\u25bc\nFonte: Adaptado de (Koopman, 1996).\nAMBIENTE EXTERNO\nCONVERS\u00c3O A/D\t\t\n\tV\t\nJ SENSORES J\t\t\nSEGURAN\u00c7A E SUPORTE ELETROMEC\u00c2NICO\nS\u00e3o dispositivos com foco na intera\u00e7\u00e3o com o ambiente, os quais englobam CPU e mem\u00f3ria e disp\u00f5em, de acordo com a finalidade para a qual sejam projetados, de outros componentes como apresentado na figura 25. A intera\u00e7\u00e3o com o ambiente \u00e9 dada atrav\u00e9s de sensores e atuadores, sendo a parte de seguran\u00e7a eletromec\u00e2nica respons\u00e1vel por suportar condi\u00e7\u00f5es ambientais diversas como transporte e varia\u00e7\u00f5es de temperatura. O software executado num sistema embarcado \u00e9 altamente especializado, sendo normalmente espec\u00edfico para a configura\u00e7\u00e3o de hardware no qual est\u00e1 implantado. Tipos de aplica\u00e7\u00e3o de softwares de sistemas embarcados s\u00e3o m\u00e1quinas de estados finitos e malhas de controle, conforme aponta (Koopman, 1996).\nApesar de qualquer CPU poder ser utilizada em um SE, normalmente se utilizam circuitos integrados espec\u00edficos para esta finalidade, os quais s\u00e3o conhecidos como microcontroladores. Um microcontrolador \u00e9 um conjunto que envolve o n\u00facleo de um\nmicroprocessador, mem\u00f3ria de programa, mem\u00f3ria de dados e interfaceamento de entrada e sa\u00edda (digital e, possivelmente, anal\u00f3gica), todos em uma \u00fanica pastilha (circuito integrado), cumprindo boa parte do apresentado na figura 25. Estes recursos possibilitam o seu uso diretamente acoplado a um conjunto de sensores e/ou atuadores que, juntos, cumprir\u00e3o a fun\u00e7\u00e3o que se espera daquele sistema embarcado. Um esquema simples de um microcontrolador pode ser visto na figura 26.\nFigura 26 - Um diagrama simplificado e gen\u00e9rico de um microcontrolador.\nNa figura 26, os blocos de perif\u00e9ricos podem representar quaisquer das fun\u00e7\u00f5es apontadas na figura 25. No entanto, em vista da fun\u00e7\u00e3o para a qual um sistema embarcado \u00e9 projetado e da alta variedade de microcontroladores dispon\u00edveis no mercado, o uso das funcionalidades embutidas no microcontrolador pode ser ou n\u00e3o suficiente. Por exemplo, \u00e9 inadequado drenar corrente do microcontrolador para acionar um atuador cuja pot\u00eancia seja compar\u00e1vel \u00e0 pot\u00eancia do pr\u00f3prio microcontrolador. Em todo caso, o projeto do\nsistema deve avaliar quais perif\u00e9ricos devem ser agregados ao sistema de modo a cumprir sua fun\u00e7\u00e3o.\n2.3.1.1\tProjeto de sistemas embarcados\nDada a inerente intera\u00e7\u00e3o com o ambiente atrav\u00e9s de sensores e atuadores espec\u00edficos e a alta especializa\u00e7\u00e3o da l\u00f3gica executada, o projeto de sistemas embarcados \u00e9, essencialmente, um problema de projeto simult\u00e2neo de software e hardware. O trabalho de (Wolf, 1994) divide o projeto de um sistema embarcado em quatro grandes tarefas, sendo elas:\n\u2022\tdividir a fun\u00e7\u00e3o a ser implementada em partes funcionais menores e interativas;\n\u2022\talocar estas divis\u00f5es a microprocessadores ou outros componentes de hardware onde as partes funcionais possam ser efetuadas;\n\u2022\tescalonar os tempos de execu\u00e7\u00e3o das tarefas de modo a cumprir os requisitos estabelecidos e\n\u2022\tmapear as tarefas para implementa\u00e7\u00e3o em conjuntos espec\u00edficos de componentes, sejam na forma de hardware ou software.\nEsta estrat\u00e9gia \u00e9 t\u00edpica de projetos de alto-n\u00edvel (top-down), assim como muitas metodologias de projeto de software de prop\u00f3sito-geral, de hardware eletr\u00f4nico e de produtos, como as apresentadas em (Back et al, 2008) e (Silva, 2009). Inclusive, estas diversas metodologias s\u00e3o consideradas no trabalho de (Wolf, 1994) como base para o projeto de SEs, j\u00e1 que os mesmos executam software especializado, tem um circuito dedicado e s\u00e3o aplicados na forma de produtos. \u00c9 natural, portanto, que as mesmas ferramentas utilizadas para o projeto de software (como ferramentas de modelagem UML4) e hardware (como sistemas CAD) sirvam para o projeto de sistemas embarcados, desde que sejam aplicadas simultaneamente. Devem ser levadas em conta, no projeto de SEs, tanto quest\u00f5es de compatibilidade eletromagn\u00e9tica dentro de seu circuito como de consist\u00eancia de c\u00f3digo executado em seu processador, para citar dois exemplos.\nQuanto ao comportamento de um sistema embarcado, utiliza-se comumente t\u00e9cnicas de modelagem de sistemas a eventos discretos,\nUML (Unified Modeling Language) \u00e9 a linguagem padr\u00e3o de facto para modelagem de software.\ncomo aut\u00f4matos e redes de Petri temporais. O avan\u00e7o da ci\u00eancia de projeto de sistemas embarcados fez com que surgissem ainda novas linguagens adaptada \u00e0s suas necessidades, como a SysML (Systems Modeling Language, um dialeto de UML) e a AADL (Architecture Analysis and Design Language). Estas linguagens fornecem recursos para a modelagem din\u00e2mica e estrutural5 de componentes de hardware e software num mesmo conjunto descritivo, facilitando a modelagem e a aplica\u00e7\u00e3o de t\u00e9cnicas de verifica\u00e7\u00e3o de consist\u00eancia para sistemas embarcados. Descri\u00e7\u00f5es da SysML e da AADL podem ser encontradas em (Hause, 2006) e (Feiler, Gluch &amp; Hudak, 2006), respectivamente. J\u00e1 est\u00e3o dispon\u00edveis inclusive ambientes integrados de desenvolvimento (integrated development environments - IDEs) para desenvolvimento nestas linguagens, como o Eclipse Modeling Project (Eclipse Foundation).\n2.3.1.2\tSistemas de tempo real\nUma nuance de import\u00e2ncia cr\u00edtica no projeto de sistemas embarcados \u00e9 o projeto de sistemas de tempo real (Wolf, 1994). Um sistema de tempo real (STR) \u00e9 \u201cum sistema computacional que deve reagir a est\u00edmulos oriundos do seu ambiente em prazos espec\u00edficos\u201d (Farines, Fraga &amp; Oliveira, 2000). Sistemas embarcados que interagem com o ambiente s\u00e3o tamb\u00e9m sistemas de tempo real, dado que a caracter\u00edstica da resposta temporal destes sistemas influencia diretamente na qualidade do processo executado. Para um STR, o mais importante \u00e9 dispor de previsibilidade do tempo de resposta aos est\u00edmulos do ambiente (Farines, Fraga &amp; Oliveira, 2000).\nUm sistema de tempo real \u00e9 dito ser previs\u00edvel caso seu comportamento possa ser antecipado mesmo frente \u00e0s varia\u00e7\u00f5es de carga de trabalho (i.e. as tarefas que o processador deve executar) e da exist\u00eancia de falhas. Para se considerar esta previsibilidade, \u00e9 preciso conhecer o comportamento do sistema frente \u00e0 pior hip\u00f3tese de carga computacional ocorrendo simultaneamente \u00e0s falhas (Farines, Fraga &amp; Oliveira, 2000).\nDo ponto de vista da seguran\u00e7a, os STRs podem ser classificados em (Farines, Fraga &amp; Oliveira, 2000):\nModelagens din\u00e2mica e estrutural s\u00e3o aqui entendidas como em (Silva, 2009).\n\u2022\tBrandos, quando o malef\u00edcio trazido por uma falha temporal \u00e9 da mesma ordem de grandeza que os benef\u00edcios da opera\u00e7\u00e3o normal (p.ex. comuta\u00e7\u00e3o telef\u00f4nica) ou\n\u2022\tCr\u00edticos, quando a ordem de grandeza do malef\u00edcio causado pela falha temporal exceda em muito o benef\u00edcio da opera\u00e7\u00e3o normal (p.ex. controle de voo).\nQuanto ao tipo de garantia de resposta, ainda segundo (Farines, Fraga &amp; Oliveira, 2000), um STR pode ser de:\n\u2022\tResposta Garantida, quando sua implementa\u00e7\u00e3o \u00e9 tal que disp\u00f5e de recursos suficientes para suportar a carga de pico, ou\n\u2022\tMelhor Esfor\u00e7o, quando a aloca\u00e7\u00e3o de recursos se baseia num estudo probabil\u00edstico sobre a carga esperada e os cen\u00e1rios de falha aceit\u00e1veis.\nO \u00faltimo tipo \u00e9 o padr\u00e3o no caso de sistemas brandos, sendo inaceit\u00e1vel para sistemas cr\u00edticos, os quais devem dispor de resposta garantida.\nPara o projeto de sistemas embarcados cuja finalidade envolve a intera\u00e7\u00e3o com o ambiente (como sistemas de supervis\u00e3o, de monitora\u00e7\u00e3o ou de controle, todos estes, intrinsecamente, sistemas de tempo real), s\u00e3o aplicadas t\u00e9cnicas de projeto que levam em conta os mesmos elementos dos STR, como o tipo de garantia de resposta desejada, a classifica\u00e7\u00e3o de seguran\u00e7a e o estudo do comportamento do sistema frente \u00e0 pior hip\u00f3tese de carga. A aplica\u00e7\u00e3o destas t\u00e9cnicas de projeto \u00e9 facilitada por ferramentas computacionais de an\u00e1lise de escalonabilidade e modelagem, algumas das quais desenvolvidas com foco no projeto de sistemas embarcados, como a TIMES (Amnell et al, 2002).\nDe modo a efetuar este estudo de comportamento, se utiliza o modelo de tarefas para ambientes de tempo real proposto por (Liu &amp; Layland, 1973), o qual considera as tarefas executadas pelo processador como peri\u00f3dicas (chegam para execu\u00e7\u00e3o em intervalos constantes, o qual \u00e9 o m\u00ednimo intervalo poss\u00edvel de chegada), com prazos de execu\u00e7\u00e3o (deadline) definidos como o instante de chegada da pr\u00f3xima inst\u00e2ncia da mesma tarefa e com tempo de processamento constante (o maior tempo poss\u00edvel no qual a tarefa \u00e9 processada), de modo a simplificar a an\u00e1lise de pior caso. Quanto \u00e0 nota\u00e7\u00e3o, uma tarefa t \u00bf \u00e9 a i-\u00e9sima tarefa peri\u00f3dica de um conjunto a ser executado num processador e tem tempo entre chegadas T e tempo de execu\u00e7\u00e3o C\u00bf.\nO levantamento destas tarefas \u00e9 realizado na modelagem din\u00e2mica do sistema, conforme visto anteriormente. Seguindo a estrat\u00e9gia proposta por (Wolf, 1994), aquelas funcionalidades que foram\neleitas para implementa\u00e7\u00e3o por software deve ser escalonadas nos processadores do SE de modo a cumprir seus requisitos. Aplicando o modelo de tarefas citado no par\u00e1grafo anterior para um sistema embarcado de controle considerado como de seguran\u00e7a cr\u00edtica, pode-se considerar que o per\u00edodo de chegada das tarefas \u00e9 o pr\u00f3prio per\u00edodo de amostragem do sistema. Deste modo, para que o sistema embarcado seja considerado de resposta garantida, deve ser projetado de modo que o conjunto de tarefas de medi\u00e7\u00e3o (leitura de sensores), controle (c\u00e1lculos baseados na leitura) e atua\u00e7\u00e3o (aplica\u00e7\u00e3o de valores em dispositivos externos) de todas as malhas envolvidas, mesmo sob varia\u00e7\u00f5es de desempenho do hardware, seja executado sem que haja atrasos. Isso quer dizer que nunca uma inst\u00e2ncia de uma tarefa peri\u00f3dica t \u00bf dever\u00e1 estar sendo executada no momento da chegada de outra inst\u00e2ncia. J\u00e1 para um sistema de medi\u00e7\u00e3o que visa cumprir determinados requisitos metrol\u00f3gicos dependentes da inexist\u00eancia de atrasos sob esta \u00f3tica, sendo considerados como sistemas brandos, caso o conjunto de tarefas n\u00e3o seja fact\u00edvel (escalon\u00e1vel), um eventual requisito de desempenho (p. ex. erro, resolu\u00e7\u00e3o) n\u00e3o ser\u00e1 cumprido naquele caso.\nPara ilustrar melhor o exposto anteriormente, tome-se o exemplo de duas tarefas peri\u00f3dicas e t2 , alocadas em um mesmo processador, com tempos de execu\u00e7\u00e3o Ct e C2 e per\u00edodos de amostragem e T2, sendo que Tr &lt;T2. (Liu &amp; Layland, 1973) mostram que \u00e9 poss\u00edvel usar uma regra de escalonamento por prioridade fixa que possibilite a execu\u00e7\u00e3o destas tarefas sem atraso se for garantido que:\nHJ.Q+ C2&lt;T2 ,\t(1)\nonde [xj \u00e9 o maior n\u00famero inteiro menor ou igual a x. A regra de escalonamento a ser utilizada neste caso \u00e9 definir maior prioridade para as tarefas com menor per\u00edodo de ocorr\u00eancia (regra conhecida como Rate Monotonic).\n2.3.2\tComputa\u00e7\u00e3o gr\u00e1fica\nA computa\u00e7\u00e3o gr\u00e1fica (CG) \u00e9 uma \u00e1rea da Ci\u00eancia da Computa\u00e7\u00e3o destinada \u00e0 gera\u00e7\u00e3o de imagens (Manssour &amp; Cohen, 2006) e seu surgimento est\u00e1 intimamente relacionado ao pr\u00f3prio surgimento dos computadores (Foley, 1996). O seu uso, no entanto, esteve restrito por v\u00e1rios anos, dada a baixa disponibilidade de hardware gr\u00e1fico especializado e at\u00e9 de programadores da \u00e1rea (Foley, 1996) (Manssour &amp; Cohen, 2006). O grande avan\u00e7o experimentado pelos hardwares gr\u00e1ficos nos \u00faltimos anos impulsionou o desenvolvimento da\ncomputa\u00e7\u00e3o gr\u00e1fica como ci\u00eancia e abriu seu leque de aplica\u00e7\u00f5es, o que inclui as \u00e1reas de defesa, engenharia, ci\u00eancia pura e aplicada, arte e entretenimento, entre outras (Foley, 1996).\nO uso cada vez mais frequente de recursos gr\u00e1ficos na computa\u00e7\u00e3o demandou o surgimento de padr\u00f5es e APIs (do ingl\u00eas Application Programming Interfaces, interfaces para a programa\u00e7\u00e3o de aplica\u00e7\u00f5es) que facilitassem o desenvolvimento e o reaproveitamento de novas aplica\u00e7\u00f5es de computa\u00e7\u00e3o gr\u00e1fica. Entre os padr\u00f5es surgidos, destacaram-se e mantiveram-se no mercado o OpenGL (Shreiner, 2009) e o Direct3D (Microsoft Corporation, 2012).\nO OpenGL \u00e9 uma especifica\u00e7\u00e3o aberta de interface para GPUs (Graphics Processing Unit, unidade de processamento gr\u00e1fico) multiplatafroma, a qual consiste de um conjunto de mais de 700 comandos que possibilitam o desenvolvimento de aplica\u00e7\u00f5es de computa\u00e7\u00e3o gr\u00e1fica. H\u00e1 implementa\u00e7\u00f5es de OpenGL para os mais comuns sistemas operacionais dispon\u00edveis (p. ex. Windows, Linux, FreeBSD, iOS) e a maioria dos formatos de sistemas computacionais, como PCs, Macintoshs, smartphones, tablets e handhelds. \u00c9 especificado por um cons\u00f3rcio de quase 100 empresas denominado Khronos Group, do qual fazem parte empresas de grande import\u00e2ncia na \u00e1rea tecnol\u00f3gica, como Apple, NVidia, Intel, Silicon Graphics, Samsung e AMD, dentre outras (Khronos Group). Suas APIs s\u00e3o escritas para a linguagem de programa\u00e7\u00e3o C e podem ser acessadas de qualquer linguagem que suporte encapsuladores e/ou interopera\u00e7\u00e3o. O estilo de programa\u00e7\u00e3o em OpenGL \u00e9 o de uma m\u00e1quina de estados.\nJ\u00e1 o Direct3D \u00e9 um conjunto de APIs cuja funcionalidade est\u00e1 estreitamente ligada \u00e0 do OpenGL, por\u00e9m \u00e9 restrito \u00e0s plataformas Windows e \u00e9 especificado e suportado unicamente pela Microsoft. Sua alta abrang\u00eancia no mercado de jogos se deve \u00e0 pr\u00f3pria abrang\u00eancia de PCs rodando Windows na atualidade. A linguagem padr\u00e3o para programa\u00e7\u00e3o utilizando Direct3D \u00e9 a C++. Diferentemente de OpenGL, Direct3D oferece uma abordagem orientada a objetos na sua aplica\u00e7\u00e3o.\nA gera\u00e7\u00e3o de gr\u00e1ficos criados em ambas APIs, reflexo do pr\u00f3prio funcionamento do hardware o qual acessam, segue basicamente o fluxo apresentado na figura 27 (Leach, 2012), conhecida na literatura t\u00e9cnica como graphics pipeline.\nFigura 27 - O fluxo de dados em aplica\u00e7\u00f5es de CG, desde o software at\u00e9 a tela.\n3D Application or Game\n3D API Commands\n3D API: OpenGL or Direct3D\nCPU \u25a0 GPU Boundary\nGPU Command &amp; Data Stream\nI\nGPU Front End\nAssembled\nVertex Index Stream\nPolygons, Lines I &amp; Points\nPretransformed Vertices\nProgrammable Vertex Processor\nPixel Location Stream\nRasterization &amp; Interpolation\nRasterized Pretransformed Fragments\nPrimitive Assembly\n(Transformed Vertices\nRaster Operations\nProgrammable Fragment Processor\nPixel Updates\n1 Transformed Fragments\nFonte: (Leach, 2012).\nOs processadores gr\u00e1ficos t\u00eam passado por uma forte evolu\u00e7\u00e3o desde o in\u00edcio da primeira d\u00e9cada de 2000. Hoje os chips gr\u00e1ficos dispon\u00edveis no mercado j\u00e1 contam com centenas de n\u00facleos de\nprocessador6. As etapas de transforma\u00e7\u00e3o de geometria e rasteriza\u00e7\u00e3o7 se tornaram program\u00e1veis (blocos Programmable Vertex Processor e Programmable Fragment Processor na figura 27), em oposi\u00e7\u00e3o ao modelo fixo implementado anteriormente. Para que se pudesse ter acesso a essas novas tecnologias, surgiram linguagens espec\u00edficas para este fim, denominadas linguagens de tonaliza\u00e7\u00e3o (shading languages). O c\u00f3digo produzido nestas linguagens \u00e9 executado em paralelo nos muitos n\u00facleos gr\u00e1ficos, quando poss\u00edvel, e palavras reservadas nestas linguagens permitem a programa\u00e7\u00e3o dos modelos de transforma\u00e7\u00e3o geom\u00e9trica e de rasteriza\u00e7\u00e3o.\n2.3.3\tRealidade virtual\nAo mesmo tempo em que houve grande avan\u00e7o no hardware de gera\u00e7\u00e3o gr\u00e1fica, novos dispositivos de intera\u00e7\u00e3o (entrada do usu\u00e1rio) e de apresenta\u00e7\u00e3o mais intuitivos foram criados, permitindo a sua utiliza\u00e7\u00e3o conjuntamente a sistemas de computa\u00e7\u00e3o gr\u00e1fica com grau de imers\u00e3o visual cada vez mais alto, o que levou \u00e0 cria\u00e7\u00e3o do conceito de realidade virtual (RV). Segundo (Hancock, 1995), realidade virtual \u00e9 \u201ca forma de intera\u00e7\u00e3o homem-m\u00e1quina mais avan\u00e7ada dispon\u00edvel\u201d, baseada em imers\u00e3o e interatividade. J\u00e1 (Hills, 1999) prefere, ap\u00f3s revis\u00e3o cr\u00edtica do trabalho de v\u00e1rios autores, dizer que RV \u201c\u00e9 uma tecnologia que se apoia em imagens com as quais, e atrav\u00e9s das quais, o seu usu\u00e1rio interage\u201d, complementando com a cita\u00e7\u00e3o de que \u201c\u00e9 um objetivo que os sistemas computacionais interativos visam\u201d \u00e0 medida que evoluem, frente ao \u201cdesejo cyberpunk dos anos 80 de deixar o corpo para tr\u00e1s e flutuar como pura informa\u00e7\u00e3o num cyberespa\u00e7o\u201d. Ou seja, realidade virtual \u00e9 uma tend\u00eancia de levar o usu\u00e1rio de um sistema a sentir-se parte dele. Percebe-se, portanto, que a computa\u00e7\u00e3o gr\u00e1fica \u00e9 o cerne da RV, dado que esta \u00faltima depende da exist\u00eancia de ambientes virtuais imersivos e interativos gerados por computador.\nPara o projeto de sistemas de RV, portanto, \u00e9 necess\u00e1rio garantir imers\u00e3o e intera\u00e7\u00e3o intuitiva. A intera\u00e7\u00e3o se d\u00e1 por dispositivos de interface homem-m\u00e1quina que tentam aproximar os comandos de entrada de gestos que o usu\u00e1rio efetuaria caso estivesse interagindo com\n6Por exemplo, uma placa gr\u00e1fica AMD Radeon 6990, uma das mais r\u00e1pidas da atualidade, cont\u00e9m 3072 unidades l\u00f3gicas e aritm\u00e9ticas (ALUs) que executam a mesma instru\u00e7\u00e3o em paralelo.\n7\tGrosso modo, consiste em transformar um conjunto de dados geom\u00e9tricos em pixels, dado um ponto de vista e um volume definido.\num ambiente real. Entre os dispositivos desenvolvidos para este fim encontram-se luvas com sensores de movimentos, trackpads (dispositivos que rastreiam o movimento da cabe\u00e7a do usu\u00e1rio) e, mais recentemente, controles remotos sens\u00edveis ao movimento (como o Nintendo Wiimote) e dispositivos de captura de gestos corporais (como o Microsoft Kinect).\nDe modo a criar a sensa\u00e7\u00e3o de imers\u00e3o num ambiente virtual, \u00e9 importante o realismo da cena, explorando a fundo as capacidades gr\u00e1ficas dispon\u00edveis para criar ambientes virtuais que lembrem o mundo real. Isto inclui tamb\u00e9m o uso de ferramentas de apresenta\u00e7\u00e3o imersivas, como salas de proje\u00e7\u00e3o e dispositivos de visualiza\u00e7\u00e3o estereosc\u00f3pica.\nA estereoscopia \u00e9 o processo de visualiza\u00e7\u00e3o de uma cena por cada um dos olhos do observador a partir de dois pontos de vista levemente separados. A combina\u00e7\u00e3o de duas imagens captadas nesses pontos de vista permite a cria\u00e7\u00e3o da sensa\u00e7\u00e3o de profundidade, o que \u00e9 justamente o que ocorre no c\u00e9rebro humano quando os dois olhos captam imagens levemente deslocadas. A figura 28 \u00e9 um exemplo de par de imagens estereosc\u00f3picas.\nFigura 28 - Uma mesma cena fotografada de dois pontos levemente separados.\n'\t'\"w * \u2019 \u00c0\tl\u00ed\t\t- i\t.A\t\t '\t\n\u25a0\tx wRbn\t\tX\t.K\t\n... \u25a0\t\t\t\nFonte: Autor.\nUm dispositivo de visualiza\u00e7\u00e3o estereosc\u00f3pica, portanto, deve dispor de um meio de entregar uma imagem de uma mesma cena para cada olho, por\u00e9m com os seus pontos de vista de gera\u00e7\u00e3o levemente afastados um do outro. Diversos dispositivos de visualiza\u00e7\u00e3o estereosc\u00f3pica est\u00e3o dispon\u00edveis no mercado atualmente, como as salas de cinema 3D, as quais contam com pares projetores de luz polarizada, telas n\u00e3o-despolarizantes e \u00f3culos polaroides. Outros exemplos s\u00e3o TVs e monitores 3D. A maioria destes monitores e TVs funciona com aux\u00edlio de \u00f3culos ativos para direcionar os quadros dedicados a cada olho. Est\u00e3o\ndispon\u00edveis ainda HMDs (Head Mounted Displays), monitores duplos para uso acoplado \u00e0 cabe\u00e7a e que disponibilizam uma imagem distinta diretamente para cada olho.\nPor fim, num sistema de RV \u00e9 fundamental a sinergia entre os dispositivos de entrada, de sa\u00edda e o pr\u00f3prio comportamento din\u00e2mico do software. A apresenta\u00e7\u00e3o dos dados deve ter tempo de resposta compat\u00edvel com a intera\u00e7\u00e3o do usu\u00e1rio, caso contr\u00e1rio este pode n\u00e3o sentir-se imerso. Da mesma forma, \u00e9 importante que os m\u00e9todos de entrada sejam escolhidos de modo que estejam relacionados com o tipo de conte\u00fado com o qual o usu\u00e1rio dever\u00e1 \u201cinteragir\u201d.\nT\u00e9cnicas de realidade virtual t\u00eam sido utilizadas com sucesso principalmente nas \u00e1reas de prototipagem, marketing e entretenimento (Foley, 1996) (Soares &amp; Santos, 2008). Nos \u00faltimos anos, a ind\u00fastria de P&amp;G passou a se valer mais fortemente de ferramentas de RV, principalmente como forma de alavancar novos neg\u00f3cios, necessidade esta causada, principalmente, pela baixa valoriza\u00e7\u00e3o do petr\u00f3leo nos anos 1990 (Russo et al, 2004). Entre os exemplos de aplica\u00e7\u00f5es encontrados na ind\u00fastria de P&amp;G tem-se a visualiza\u00e7\u00e3o interativa de grandes volumes de dados de reservat\u00f3rios (Russo et al, 2004) e uma plataforma de convers\u00e3o de modelos CAD para intera\u00e7\u00e3o por RV (Soares &amp; Santos, 2008). No Centro de Pesquisas e Desenvolvimento Leopoldo A. M. de Mello - o CENPES - Petrobras - encontra-se um centro de realidade virtual, o qual \u00e9 utilizado para a simula\u00e7\u00e3o de ambientes de explora\u00e7\u00e3o, navega\u00e7\u00e3o em plantas de refinarias virtuais, visualiza\u00e7\u00e3o de dados de reservat\u00f3rios, entre outras aplica\u00e7\u00f5es.\n68\n3\tCONCEP\u00c7\u00c3O DO PERFIL\u00d4METRO\nO sensor \u00f3ptico desenvolvido por (Buschinelli, 2007) foi o ponto de partida para a cria\u00e7\u00e3o de um perfil\u00f4metro que pudesse ser aplicado a uma regi\u00e3o de um tubo, n\u00e3o somente a uma sec\u00e7\u00e3o. Para isto iniciou-se no LABMETRO-EMC-UFSC, numa parceria com a Petrobras, um projeto de pesquisa e desenvolvimento para a cria\u00e7\u00e3o de uma completa solu\u00e7\u00e3o de perfilometria geom\u00e9trica que utiliza o sensor apresentado no cap\u00edtulo 2.2. Por conta da tecnologia aplicada no sensor, batizou-se o projeto de \u201cPEROLA: perfilometria \u00f3ptica a laser aplicada a dutos\u201d.\nO projeto PEROLA como um todo prev\u00ea, al\u00e9m do dispositivo de perfilometria interna baseado no sensor apresentado no cap\u00edtulo anterior, tamb\u00e9m um dispositivo para inspe\u00e7\u00e3o externa e um sistema para visualiza\u00e7\u00e3o da geometria adquirida por ambos. O dispositivo de inspe\u00e7\u00e3o interna \u00e9 tamb\u00e9m chamado de \u201cPEROLA - Interno\u201d ou simplesmente \u201cPEROLA-I\u201d. Analogamente, o dispositivo de inspe\u00e7\u00e3o externa \u00e9 o \u201cPEROLA - Externo\u201d ou simplesmente \u201cPEROLA-E\u201d\nO desenvolvimento do prot\u00f3tipo do PEROLA-E foi apresentado primeiramente em (Haertel, 2009); vers\u00f5es mais recentes foram apresentadas em (Buschinelli et al, 2012) e (Haertel et al, 2012). As contribui\u00e7\u00f5es apresentadas aqui dizem respeito ao PEROLA-I e ao sistema de visualiza\u00e7\u00e3o, pelo que, a partir de agora, o sistema de visualiza\u00e7\u00e3o ser\u00e1 referido como parte integrante do PEROLA-I. Contudo, caracter\u00edsticas do PEROLA-E s\u00e3o levadas em conta para o projeto do sistema de visualiza\u00e7\u00e3o, conforme ser\u00e1 esclarecido adiante no item 5.1.\nEste cap\u00edtulo apresenta, primeiramente, o princ\u00edpio de solu\u00e7\u00e3o do PEROLA-I. Em seguida apresenta sua estrutura\u00e7\u00e3o em m\u00f3dulos funcionais, realizada a partir de um refinamento do princ\u00edpio de solu\u00e7\u00e3o. Em seguida s\u00e3o definidos quais destes m\u00f3dulos funcionais foram abordados no contexto desta disserta\u00e7\u00e3o. Posteriormente s\u00e3o apresentados os requisitos de projeto, levantados junto ao corpo t\u00e9cnico de refinarias de petr\u00f3leo brasileiras.\n3.1\tPRINC\u00cdPIO DE SOLU\u00c7\u00c3O\nPara desenvolver um perfil\u00f4metro interno a partir do sensor \u00f3ptico, primeiramente \u00e9 necess\u00e1rio adequ\u00e1-lo numa estrutura mec\u00e2nica que o centralize no interior de um tubo a ser mensurado, de modo que o sensor e o tubo fiquem com seus eixos alinhados. Ent\u00e3o \u00e9 necess\u00e1rio ser\nposs\u00edvel desloc\u00e1-lo de forma controlada ao longo do interior da regi\u00e3o de interesse do tubo, fazendo com que a cada incremento de deslocamento predefinido haja um disparo de medi\u00e7\u00e3o do sensor. Desta forma ser\u00e1 adquirida a geometria de v\u00e1rias sec\u00e7\u00f5es cont\u00edguas e igualmente espa\u00e7adas, conforme figura 29.\nFigura 29 - O deslocamento controlado do sensor ao longo do eixo do tubo permite a aquisi\u00e7\u00e3o da geometria de sucessivas sec\u00e7\u00f5es.\nFonte: Autor.\nOs dados resultantes de cada medi\u00e7\u00e3o de perfil circular (em coordenadas polares) devem, posteriormente, ser concatenados por software, resultando numa tabela de valores em coordenadas cil\u00edndricas, conforme figura 30. Estes dados constituem uma nuvem de pontos cil\u00edndrica (NPC) que representa a geometria da regi\u00e3o inspecionada, tendo em cada ponto da nuvem uma amostragem da superf\u00edcie interna.\nFigura 30 - As k listas de n valores adquiridos em coordenadas polares devem ser concatenadas de modo a formar uma tabela de ordem n X k em coordenadas\ncil\u00edndricas.\n1\t2\tk\t1\t2\t... k\n\u00ab1\t\t\u00ab1\n\u00ab2\t\t\u00ab2\n\u00ab3\tO\t\u00ab3\n\t\t\n\u00abn\t\t\u00abn\nFonte: Autor.\n\u00ab1,1\t\u00ab2,1\t\t\u00abk,l\n\u00ab1,2\t\u00ab2,2\t\t\u00abk,2\n\u00ab1,3\t\u00ab2,3\t\t\u00abk,3\n\t\t\t\n\u00ab1,71\t\u00ab2,J1\t\t\u00abk,n\nPara que o resultado de medi\u00e7\u00e3o possa ser percebido visualmente, \u00e9 necess\u00e1rio um software de visualiza\u00e7\u00e3o capaz de reconstruir virtualmente a regi\u00e3o inspecionada a partir da nuvem de\npontos adquirida, idealmente oferecendo capacidades de leitura e interpreta\u00e7\u00e3o melhores que aqueles associados aos pigs apresentados no item 2.1. Uma fun\u00e7\u00e3o desejada neste caso \u00e9 a reconstru\u00e7\u00e3o do perfil em tr\u00eas dimens\u00f5es, como na figura 31.\nFigura 31 - Reconstru\u00e7\u00e3o 3D da geometria interna (vista externa) de um trecho de tubo met\u00e1lico utilizando codifica\u00e7\u00e3o de cores para valores de raio.\nFonte: Autor.\n3.2\tDETALHAMENTO PRELIMINAR\nA partir de um detalhamento do princ\u00edpio de solu\u00e7\u00e3o apresentado, foi concebido um modelo em nota\u00e7\u00e3o IDEF0 (Integration Definition for Function Modeling) (National Institute of Standards and Technology, 1993) para descrever o PEROLA-I de um ponto de vista funcional8.\nO modelo conta com uma fun\u00e7\u00e3o-raiz, de mais alto n\u00edvel, cujas subfun\u00e7\u00f5es de interesse foram detalhadas em seus diagramas pr\u00f3prios, conforme padr\u00e3o proposto em (National Institute of Standards and Technology, 1993). Diagramas deste modelo est\u00e3o apresentados nas figuras 32, 33 e 34. Algumas decis\u00f5es de modelagem apresentadas nos diagramas a seguir foram tomadas de forma a melhor elucidar o escopo do trabalho, pelo que tamb\u00e9m foram omitidos alguns elementos de modelagem considerados irrelevantes.\n8\tIDEF0 foi escolhida aqui por sua simplicidade. Nesta nota\u00e7\u00e3o, cada seta deve representar um substantivo (recursos, entradas e sa\u00eddas) e cada ret\u00e2ngulo deve representar um verbo (fun\u00e7\u00f5es ou processos). Setas entrando por cima representam restri\u00e7\u00f5es e vari\u00e1veis de controle, enquanto que por baixo representam recursos utilizados.\nFigura 32 - Diagrama funcional b\u00e1sico IDEF0 de mais alto n\u00edvel do PEROLA-I.\nFonte: Autor.\nO fato do sensor \u00f3ptico j\u00e1 desenvolvido se basear numa c\u00e2mera demanda a exist\u00eancia da fun\u00e7\u00e3o A1, \u201cadquirir imagens da regi\u00e3o\u201d. Esta \u00faltima deve respeitar as limita\u00e7\u00f5es impostas pelas caracter\u00edsticas do sensor \u00f3ptico, conforme vari\u00e1vel de controle no diagrama acima. Sua entrada \u00e9 o deslocamento do perfil\u00f4metro na regi\u00e3o a ser mensurada e sua sa\u00edda \u00e9 um conjunto de imagens daquela regi\u00e3o. A partir destas imagens ser\u00e1 extra\u00edda, pela fun\u00e7\u00e3o A2, uma nuvem de pontos cil\u00edndrica descritiva da geometria da regi\u00e3o de tudo aplicada. Esta nuvem de pontos ser\u00e1 a fonte de dados de um sistema de visualiza\u00e7\u00e3o que cumpre a fun\u00e7\u00e3o A3, permitindo a um usu\u00e1rio analisar de forma satisfat\u00f3ria a geometria inspecionada, devendo utilizar para isso t\u00e9cnicas de realidade virtual.\nA fun\u00e7\u00e3o A1 \u00e9 detalhada na figura 33.\nFigura 33 - Detalhamento da fun\u00e7\u00e3o de aquisi\u00e7\u00e3o e disponibiliza\u00e7\u00e3o de imagens.\nFonte: Autor.\nPara garantir que as imagens sejam adquiridas num mesmo referencial, \u00e9 necess\u00e1ria a medi\u00e7\u00e3o de um eventual e indesejado deslocamento angular em torno do eixo do perfil\u00f4metro, al\u00e9m do deslocamento axial. Um hardware embarcado no corpo do perfil\u00f4metro deve executar a fun\u00e7\u00e3o A11 (bloco 1 do diagrama A1, figura 33), respeitando as restri\u00e7\u00f5es impostas pela estrutura mec\u00e2nica do perfil\u00f4metro. Este mesmo sistema embarcado ser\u00e1 utilizado para efetuar o disparo da aquisi\u00e7\u00e3o de imagens da c\u00e2mera do sensor e enviar os dados necess\u00e1rios de etiquetagem.\nUm m\u00f3dulo de software de controle da c\u00e2mera do sensor deve ser utilizado para o cumprimento da fun\u00e7\u00e3o A12. Atrav\u00e9s dele o usu\u00e1rio deve ser capaz de regular par\u00e2metros de aquisi\u00e7\u00e3o de imagens, como tempo de exposi\u00e7\u00e3o e sensibilidade do sensor CCD. Al\u00e9m de fornecer as imagens para processamento pelo algoritmo do sensor \u00f3ptico, este m\u00f3dulo deve disponibiliz\u00e1-las para visualiza\u00e7\u00e3o em tempo de execu\u00e7\u00e3o.\nA fun\u00e7\u00e3o A2 \u00e9 detalhada na figura 34. Nota-se neste caso a necessidade da defini\u00e7\u00e3o de um padr\u00e3o de armazenamento para garantir a compatibilidade com o sistema de visualiza\u00e7\u00e3o que desempenha a fun\u00e7\u00e3o A3.\nFigura 34 - Detalhamento da fun\u00e7\u00e3o de extra\u00e7\u00e3o de nuvem de pontos cil\u00edndrica correspondente \u00e0 regi\u00e3o inspecionada.\nFonte: Autor.\n3.3\tDEFINI\u00c7\u00c3O DO ESCOPO DO TRABALHO\nO projeto PEROLA \u00e9 desenvolvido em equipe, com atribui\u00e7\u00f5es e responsabilidades delegadas a cada integrante. O somat\u00f3rio coordenado das v\u00e1rias atribui\u00e7\u00f5es leva \u00e0 sua materializa\u00e7\u00e3o. O presente trabalho de mestrado contribuiu ao projeto nos seguintes aspectos:\n\u2022\tProjeto, implementa\u00e7\u00e3o e avalia\u00e7\u00e3o do sistema embarcado de monitora\u00e7\u00e3o de deslocamentos e do m\u00f3dulo de software de ger\u00eancia da c\u00e2mera do sensor, os quais s\u00e3o conjuntamente referidos como \u201csistema de aquisi\u00e7\u00e3o e disponibiliza\u00e7\u00e3o de imagens\u201d e cumprem a fun\u00e7\u00e3o A1;\n\u2022\tDefini\u00e7\u00e3o do protocolo de armazenamento da nuvem de pontos cil\u00edndrica e\n\u2022\tProjeto, implementa\u00e7\u00e3o e avalia\u00e7\u00e3o do sistema de realidade virtual cumpridor da fun\u00e7\u00e3o A3.\nO sistema de aquisi\u00e7\u00e3o e disponibiliza\u00e7\u00e3o de imagens \u00e9 apresentado no cap\u00edtulo 4 e teve seu desenvolvimento iniciado em (Melo, 2009). A defini\u00e7\u00e3o do protocolo de armazenamento e o desenvolvimento do sistema de RV para visualiza\u00e7\u00e3o dos resultados das medi\u00e7\u00f5es s\u00e3o apresentados no cap\u00edtulo 5.\nN\u00e3o est\u00e3o inclu\u00eddos no contexto desta disserta\u00e7\u00e3o, portanto, o projeto da estrutura mec\u00e2nica do perfil\u00f4metro (o qual \u00e9 anterior a este trabalho) nem o aperfei\u00e7oamento do software do sensor, o qual cumpre a fun\u00e7\u00e3o A2. Ambos os casos s\u00e3o, no entanto, considerados nas decis\u00f5es de projeto aqui tomadas.\n3.4\tREQUISITOS T\u00c9CNICOS\nConsiderando caracter\u00edsticas do sensor \u00f3ptico e o princ\u00edpio de solu\u00e7\u00e3o apresentado, foi estabelecido um conjunto de requisitos t\u00e9cnicos para o PEROLA-I. Estes requisitos levam em conta valores desejados de desempenho operacional e normas de seguran\u00e7a em refinarias e est\u00e3o na tabela 2. Foram destacados os itens relevantes para as fun\u00e7\u00f5es espec\u00edficas a este trabalho de acordo com a tabela 1.\nTabela 1 - L\u00f3gica de destaque dos requisitos da tabela 2.\nRelativo ao Sistema de Aquisi\u00e7\u00e3o e Disponibiliza\u00e7\u00e3o de Imagens\tUnidade\tValor\nRelativo ao Sistema de Realidade Virtual para Visualiza\u00e7\u00e3o e\tUnidade\tValor\nFonte: Autor.\nTabela 2 - Requisitos t\u00e9cnicos do PEROLA-]\nRequisito de Projeto\tUnidade\tValor-meta\n1 - Di\u00e2metro do duto a inspecionar\tPol. (mm)\t6 (152,4)\n2 - Atendimento \u00e0s normas de seguran\u00e7a em refinaria\tSim/N\u00e3o\tSim\n3 - Opera\u00e7\u00e3o em dutos limpos e secos\tSim/N\u00e3o\tSim\n4 - Confiabilidade\tFalhas / km\t1\n5 - Extra\u00e7\u00e3o de par\u00e2metros geom\u00e9tricos\tSim/N\u00e3o\tSim\n6 - Comprimento m\u00e1ximo (entre o computador e o cabe\u00e7ote)\tm\t50\n7 - Largura mais comum do defeito a ser medido\tmm\t3 a 10\n8 - Comprimento mais comum do defeito a ser medido\tmm\t2 a 10\n9 - Profundidade mais comum do defeito a ser medido\tmm\t2 a 10\n10 - Incerteza do raio\tmm\t\u00b1 0,4\n11 - Incerteza da medi\u00e7\u00e3o de deslocamento\t%\t2\n12 - Materiais limp\u00e1veis e resistentes\tSim/N\u00e3o\tSim\n13\t- Facilidade de manuten\u00e7\u00e3o / Reposi\u00e7\u00e3o de pe\u00e7as degradadas\n14\t- Velocidade de processamento\nSim/N\u00e3o\nimagens/s\nSim\n10 a 50\n16 - Durabilidade\tAnos\t> 2 anos\n17 - Resolu\u00e7\u00e3o axial\tmm\t1\n18 - Resolu\u00e7\u00e3o angular\to\t0,25\n19 - Velocidade de inspe\u00e7\u00e3o\tmm/s\t10 a 50 mm/s\n20 - Facilidade de instala\u00e7\u00e3o em campo\tNo. pessoas\t1\n21 - Visualiza\u00e7\u00e3o em 3D\tSim/N\u00e3o\tSim\n22 - Facilidade de Opera\u00e7\u00e3o\tSim/N\u00e3o\tSim\n23 - Facilidade de transportar /acondicionar\tSim/N\u00e3o\tSim\n24 - \u00c2ngulo de vis\u00e3o\tO\t>70\n25 - Interface de software amig\u00e1vel\tSim/N\u00e3o\tSim\n26 - Raio de curvatura m\u00ednimo\tm\t10 m\n27 - Tamanho\t(di\u00e2metro\tx comprimento) mm\t120 x 800\n28 - Massa\tkg\t20\n29 - Temperatura de opera\u00e7\u00e3o9\t\u00b0C\t0 a 45\n30 - Alimenta\u00e7\u00e3o pr\u00f3pria/armazenagem dados\tSim/N\u00e3o\tN\u00e3o\n31 - Tra\u00e7\u00e3o pr\u00f3pria\tSim/N\u00e3o\tN\u00e3o\nFonte: LABMETRO-UFSC.\nEsta defini\u00e7\u00e3o de requisitos foi dada atrav\u00e9s de um processo iterativo, pelo que alguns dos mesmos foram retirados das pr\u00f3prias caracter\u00edsticas logradas no desenvolvimento do sensor \u00f3ptico em (Buschinelli, 2007), como os requisitos 3, 6, 14, 15, 19 e 24. Alguns outros valores-meta j\u00e1 eram buscados no desenvolvimento do sensor e aqui foram mantidos, como os requisitos 1, 7, 8, 9, 10, 11, 17 e 18. H\u00e1\n9\tAqui foi escolhido, por simplicidade, o valor de trabalho da c\u00e2mera do sensor.\ntamb\u00e9m vari\u00e1veis simplificadoras do desenvolvimento numa primeira fase, como os requisitos 29, 30 e 31.\nOs demais requisitos da tabela 2 dizem respeito \u00e0 aplica\u00e7\u00e3o do sensor num sistema completo de perfilometria. Entres estes, foram destacados alguns como sendo relativos aos sistemas pertinentes a este trabalho, citados no item 3.3.\nNos pr\u00f3ximos dois cap\u00edtulos s\u00e3o apresentados os desenvolvimentos destes sistemas, os quais se baseiam na modelagem da solu\u00e7\u00e3o apresentada e nos requisitos do PEROLA-I relativos aos mesmos, al\u00e9m de outros requisitos incorporados posteriormente.\n78\n4\tSISTEMA DE AQUISI\u00c7\u00c3O E DISPONIBILIZA\u00c7\u00c3O DE IMAGENS\nEste cap\u00edtulo apresenta o desenvolvimento conjunto do sistema embarcado de monitora\u00e7\u00e3o de deslocamento e do m\u00f3dulo de controle da c\u00e2mera do sensor \u00f3ptico. Primeiramente s\u00e3o apresentados os seus requisitos espec\u00edficos e as solu\u00e7\u00f5es adotadas no seu cumprimento. Em seguida, \u00e9 apresentado o desenvolvimento dos sistemas que cumprem as fun\u00e7\u00f5es especificadas na modelagem realizada no item 3.2.\n4.1\tGERA\u00c7\u00c3O DE REQUISITOS\nCombinando os requisitos do PEROLA-I colocados na tabela 2 com aqueles relacionados \u00e0 fun\u00e7\u00e3o A1 do diagrama da figura 33, foram gerados os requisitos espec\u00edficos do sistema de aquisi\u00e7\u00e3o e disponibiliza\u00e7\u00e3o de imagens. Estes requisitos est\u00e3o na tabela 3. Foram tamb\u00e9m considerados requisitos impostos por restri\u00e7\u00f5es mec\u00e2nicas e crit\u00e9rios de usabilidade.\nTabela 3 - Requisitos do m\u00f3dulo de aquisi\u00e7\u00e3o e disponibiliza\u00e7\u00e3o de imagens\nRequisito de Projeto\tUnidade\tValor-meta\n1A - Atendimento \u00e0s normas de seguran\u00e7a em refinaria\tSim/N\u00e3o\tSim\n1B - Opera\u00e7\u00e3o em condi\u00e7\u00f5es adversas de limpeza\tSim/N\u00e3o\tN\u00e3o\n1C - Confiabilidade\tFalhas / km\t1,0\n1D - Comprimento m\u00ednimo entre o computador e o cabe\u00e7ote\tm\t50\n1E - Incerteza da medi\u00e7\u00e3o de deslocamento\t%\t2\n1F - Facilidade de reposi\u00e7\u00e3o\tSim/N\u00e3o\tSim\n1G - Velocidade de aquisi\u00e7\u00e3o\tImagens/s\t50\n1H - Resolu\u00e7\u00e3o axial m\u00ednima\tmm\t1,0\n1I - Resolu\u00e7\u00e3o angular\t0\t0,25\n1J - Velocidade de inspe\u00e7\u00e3o\tmm/s\t50\n1L - Largura m\u00e1xima da placa interna\tmm\t55\n1M - Comprimento m\u00e1ximo da placa interna\tmm\t65\n1N - Disponibiliza\u00e7\u00e3o das imagens adquiridas por arquivos\tSim/N\u00e3o\tSim\n1O - Disponibiliza\u00e7\u00e3o das imagens adquiridas por software integr\u00e1vel\tSim/N\u00e3o\tSim\n1P - Imagens disponibilizadas no mesmo referencial\tSim/N\u00e3o\tSim\n1Q - Vis\u00e3o da imagem corrente capturada\tSim/N\u00e3o\tSim\n1R - Configura\u00e7\u00e3o de par\u00e2metros de captura em tempo de opera\u00e7\u00e3o\tSim/N\u00e3o\tSim\n1S - Possibilidade de opera\u00e7\u00e3o com diferentes modelos de c\u00e2meras\tSim/N\u00e3o\tSim\nFonte: Adaptada de (Melo, 2009).\nPara o cumprimento destes requisitos, o projeto foi dividido, conforme apresentado na modelagem do diagrama A1 no item 3.2, em dois m\u00f3dulos funcionais:\n\u2022\tM\u00f3dulo de monitora\u00e7\u00e3o de deslocamentos, implementado atrav\u00e9s de hardware e software embutidos no perfil\u00f4metro;\n\u2022\tM\u00f3dulo de gerenciamento da c\u00e2mera do sensor, implementado como biblioteca de software a ser integrada ao software de opera\u00e7\u00e3o do perfil\u00f4metro, executado em plataforma PC.\nO PC que executa o software de opera\u00e7\u00e3o do perfil\u00f4metro ser\u00e1 referido como \u201cPC anfitri\u00e3o\u201d, enquanto que o m\u00f3dulo de monitora\u00e7\u00e3o de deslocamentos pode ser referido adiante simplesmente como \u201csistema embarcado\u201d. O desenvolvimento destes m\u00f3dulos \u00e9 apresentado nas duas pr\u00f3ximas se\u00e7\u00f5es.\n4.2\tM\u00d3DULO DE MONITORA\u00c7\u00c3O DE DESLOCAMENTOS\nEste m\u00f3dulo \u00e9 respons\u00e1vel pela medi\u00e7\u00e3o do deslocamento do perfil\u00f4metro; tanto o deslocamento linear ao longo do eixo da regi\u00e3o de tubo a ser mensurada (deslocamento axial - fun\u00e7\u00e3o hod\u00f4metro) quanto a rota\u00e7\u00e3o ao redor do seu pr\u00f3prio eixo (deslocamento angular - fun\u00e7\u00e3o inclin\u00f4metro). \u00c9 respons\u00e1vel tamb\u00e9m por disparar a aquisi\u00e7\u00e3o de imagem na c\u00e2mera do sensor \u00f3ptico, a cada incremento predefinido de deslocamento axial, e fornecer os dados de etiquetagem essenciais para a reconstru\u00e7\u00e3o da geometria inspecionada. Al\u00e9m disso, deve receber comandos do software de opera\u00e7\u00e3o do PEROLA-I para zerar as\nmedi\u00e7\u00f5es e definir a dist\u00e2ncia padr\u00e3o a ser percorrida a cada medi\u00e7\u00e3o de sec\u00e7\u00e3o.\nA fim de se ter uma no\u00e7\u00e3o geral do sistema projetado, a forma como o m\u00f3dulo de monitora\u00e7\u00e3o interage com outros componentes do PEROLA-I \u00e9 mostrada na figura 35, a qual apresenta uma modelagem simplificada de alto n\u00edvel de abstra\u00e7\u00e3o dos dispositivos e sistemas do perfil\u00f4metro. Este modelo foi criado em linguagem AADL gr\u00e1fica10. Uma explica\u00e7\u00e3o b\u00e1sica dos conceitos utilizados desta linguagem \u00e9 dada no Ap\u00eandice A.\nFigura 35 - Diagrama AADL de sistemas e dispositivos do PEROLA-I. Os dados e o dispositivo em cor mais fraca representam um caminho secund\u00e1rio, utilizado apenas na indisponibilidade da via principal.\nFonte: Autor.\nO diagrama mostra que o m\u00f3dulo de monitora\u00e7\u00e3o (sistema ModuloMonitoracao) cria o evento disparocamera, fornece os dados de etiquetagem ao software de opera\u00e7\u00e3o do perfil\u00f4metro, executado no sistema PC (portas de dados e eventos etiqcam, etiq_pc e etiquetagem), e dele recebe comandos de configura\u00e7\u00e3o (portas de dados e eventos\n10\tA linguagem AADL possui as vers\u00f5es gr\u00e1fica e textual.\ncomandosse, comcam e com_pc). Esta troca de dados pode se dar atrav\u00e9s do uso de registradores na c\u00e2mera do sensor, caso esta disponha de funcionalidade de leitura e escrita por dispositivo externo. O m\u00f3dulo embarcado realiza estas opera\u00e7\u00f5es atrav\u00e9s dos canais de dados RX (recep\u00e7\u00e3o) e TX (transmiss\u00e3o) da c\u00e2mera, enquanto que o m\u00f3dulo de gerenciamento da c\u00e2mera realiza sua comunica\u00e7\u00e3o atrav\u00e9s da conex\u00e3o da c\u00e2mera com o PC anfitri\u00e3o, a qual \u00e9 utilizada para todas as portas de dados entre o sistema PC e o dispositivo Camera no diagrama. Neste caso o software executado no PC deve realizar a leitura e escrita dos registradores de forma sincronizada com as a\u00e7\u00f5es do sistema embarcado.\nCaso a c\u00e2mera utilizada n\u00e3o disponha de recurso de escrita por dispositivo externo, pode ser utilizada uma via alternativa (destacada em cor diferente no diagrama), da\u00ed a duplicidade de algumas conex\u00f5es e dados no modelo. No caso deste projeto, foram usados dois modelos de c\u00e2mera. A utilizada nas primeiras concep\u00e7\u00f5es possui interface firewire. A c\u00e2mera utilizada na concep\u00e7\u00e3o atual tem interface gigabit ethernet (GigE). Ambas disp\u00f5em de conectores que possibilitam comunica\u00e7\u00e3o serial com dispositivos e acionamento externo, utilizando, portanto, os canais padr\u00e3o apontados no diagrama. O evento disparocamera ocorre quando o m\u00f3dulo detecta um deslocamento axial padr\u00e3o, cujo valor \u00e9 definido pelo operador do perfil\u00f4metro; ap\u00f3s a aquisi\u00e7\u00e3o da imagem, o software executado no PC anfitri\u00e3o recebe a mesma junto com seus dados de etiquetagem.\n4.2.1 Hardware\nUm modelo simplificado11 em AADL do hardware do m\u00f3dulo de monitora\u00e7\u00e3o \u00e9 apresentado na figura 36. Este diagrama \u00e9 o detalhamento do sistema ModuloMonitoracao da figura 35 e apresenta, portanto, as mesmas portas de dados e eventos presentes no referido sistema.\n11\tUma das simplifica\u00e7\u00f5es presentes no diagrama foi representar o microcontrolador utilizado como um processador, o que n\u00e3o deve, entretanto, prejudicar na compreens\u00e3o do modelo.\nFigura 36 - Modelo AADL simplificado do hardware do m\u00f3dulo de monitora\u00e7\u00e3o de deslocamento.\nMicrocontrolador\nvarhodometro\nvar incEnometro\ncomandos \u00ab\u00e1 \u00ed\nFonte: Autor.\netiquetagem fel-\nOs dispositivos Enc_hodometro e Enc_inclinometro fornecem o sinal que possibilita a medi\u00e7\u00e3o dos deslocamentos axial e angular, respectivamente. Ambos t\u00eam tipo de sinal id\u00eantico, codificado em dois bits, cujos poss\u00edveis valores de sa\u00edda s\u00e3o apresentados na tabela 4.\nTabela 4 - Estados assumpt\u00edveis pelo sinal de sa\u00edda dos encoders de codifica\u00e7\u00e3o de dois bits.\nCanais\tA\tB\nValor l\u00f3gico no \u201cestado 1\u201d\t0\t0\nValor l\u00f3gico no \u201cestado 2\u201d\t1\t0\nValor l\u00f3gico no \u201cestado 3\u201d\t1\t1\nValor l\u00f3gico no \u201cestado 4\u201d\t0\t1\nFonte: Autor.\nEstes estados s\u00e3o lidos por um microcontrolador situado numa placa de circuito impresso atrav\u00e9s das portas var hodometro e varinclinometro. Uma mudan\u00e7a de estado no valor de sa\u00edda destes dispositivos \u00e9 considerada como um \u201cpulso\u201d e pode ser tratada como evento, como ilustrado pelo uso da porta de dados e evento var_hodometro. Isto permite uma prioriza\u00e7\u00e3o da leitura do hod\u00f4metro, fun\u00e7\u00e3o principal do m\u00f3dulo de monitora\u00e7\u00e3o. A mesma estrat\u00e9gia n\u00e3o \u00e9 necess\u00e1ria para a leitura do inclin\u00f4metro.\nO microcontrolador12 \u00e9 respons\u00e1vel pelo c\u00e1lculo dos valores de interesse e gera\u00e7\u00e3o do evento de disparo, al\u00e9m do envio e recebimento de dados j\u00e1 citado. O sinal do evento de disparo \u00e9 dado por uma transi\u00e7\u00e3o de valor l\u00f3gico conectado diretamente \u00e0 c\u00e2mera. J\u00e1 o envio e recebimento de dados \u00e9 feito atrav\u00e9s de um m\u00f3dulo USART 13 dispon\u00edvel no microcontrolador.\nNa mesma placa tamb\u00e9m se encontram condicionadores de sinal para os padr\u00f5es RS-232 e RS-485 (dispositivos Cond_RS485 e Cond_RS232) utilizados em conjunto com o USART. Ambos os padr\u00f5es s\u00e3o considerados seguros para a opera\u00e7\u00e3o em ambiente petroqu\u00edmico pela relativa baixa frequ\u00eancia de transmiss\u00e3o, da ordem de at\u00e9 100 kHz.\nO primeiro padr\u00e3o \u00e9 o utilizado quando se comunica usando a c\u00e2mera como intermedi\u00e1ria e tem seus sinais enviados ao mesmo conector utilizado para o disparo de aquisi\u00e7\u00e3o. Para atender o requisito de dist\u00e2ncia entre o computador do sistema e o perfil\u00f4metro, no caso da c\u00e2mera firewire foram utilizados repetidores no cabo que a liga ao PC de opera\u00e7\u00e3o do perfil\u00f4metro. Para a c\u00e2mera GigE isto n\u00e3o foi necess\u00e1rio, dado que o seu padr\u00e3o de comunica\u00e7\u00e3o cumpre o requisito de dist\u00e2ncia sem o uso de repetidores. O padr\u00e3o RS-485 foi o escolhido para uso com a via alternativa (destacada em cor diferene nos diagramas AADL) por ter alcance acima das especifica\u00e7\u00f5es do perfil\u00f4metro, possibilitando a opera\u00e7\u00e3o transparente em caso de utilizar-se uma c\u00e2mera que n\u00e3o disponha de comunica\u00e7\u00e3o serial com dispositivo externo. Assim, para se utilizar uma c\u00e2mera no perfil\u00f4metro, portanto, basta que ela disponha de acionamento externo14. Percebe-se tamb\u00e9m que o microcontrolador n\u00e3o diferencia o envio e recebimento de dados passando pela c\u00e2mera ou pela via alternativa.\nPara a aplica\u00e7\u00e3o do encoder do hod\u00f4metro, foi dimensionada uma roda extra acoplada ao mesmo e posicionada na parte exterior do corpo mec\u00e2nico do perfil\u00f4metro, conforme figura 37. Foi projetada de modo a gerar 10 pulsos do encoder por mil\u00edmetro percorrido pela roda, ao se utilizar um encoder de 1440 pulsos por volta. Atinge-se desta forma, por projeto, a medida de deslocamento axial com resolu\u00e7\u00e3o de\n12\tNa implementa\u00e7\u00e3o realizada, foi utilizado um microcontrolador PIC\u00ae por haver um programador (gravador de c\u00f3digo) j\u00e1 dispon\u00edvel no laborat\u00f3rio.\n13\tUniversal synchronous/asynchronous receiver/transmitter, do ingl\u00eas, receptor/transmissor s\u00edncrono/ass\u00edncrono universal.\n14\tPara o uso de uma c\u00e2mera que n\u00e3o disp\u00f5e de acionamento por sinal externo, o m\u00f3dulo de gerenciamento da c\u00e2mera deve efetuar a aquisi\u00e7\u00e3o de imagem por software assim que receber os dados de etiquetagem.\n0,1 mm, suficiente para aquisi\u00e7\u00f5es de imagens interespa\u00e7adas de pelo menos 1 mm, conforme requisito 1H. Esta resolu\u00e7\u00e3o de 0,1 mm, correspondente \u00e0 medida de deslocamento axial sofrido, n\u00e3o deve ser confundida com a resolu\u00e7\u00e3o axial da aquisi\u00e7\u00e3o do perfil geom\u00e9trico, que \u00e9 a dist\u00e2ncia entre as aquisi\u00e7\u00f5es de geometria das sec\u00e7\u00f5es que comp\u00f5em a regi\u00e3o inspecionada.\nFigura 37 - A proje\u00e7\u00e3o de parte do corpo mec\u00e2nico do PEROLA-I, com destaque para a roda do hod\u00f3metro.\nFonte: (Melo, 2009).\nJ\u00e1 o encoder para a medi\u00e7\u00e3o do deslocamento angular utilizado \u00e9 um inclin\u00f3metro do tipo diferencial de 5000 pulsos por volta. Seu posicionamento dentro do corpo mec\u00e2nico do PEROLA-I pode ser visto na figura 38. Na mesma figura pode ser visto o local dimensionado para a placa de circuito impresso que abriga microcontrolador e condicionadores de sinal para comunica\u00e7\u00e3o. Deve ser observado que estes componentes (roda externa, inclin\u00f3metro e placa) obedecem \u00e0s restri\u00e7\u00f5es previamente impostas pelo projeto mec\u00e2nico do perfil\u00f3metro.\nFigura 38 - Vista em corte do PEROLA-I, gerada por uma ferramenta CAD. Destaque para o inclin\u00f4metro, \u00e0 esquerda e destacado em vermelho, e para a placa de circuito impresso, abaixo e destacada em amarelo.\nFonte: Autor.\nA rela\u00e7\u00e3o de pulsos por volta completa do inclin\u00f4metro escolhido cumpre com folga o requisito 1I, oferecendo 0,072\u00b0 de resolu\u00e7\u00e3o angular. Por raz\u00f5es de economia de espa\u00e7o, posteriormente foi concebido um inclin\u00f4metro alternativo, consistindo de um encoder acoplado a um disco de massa assimetricamente distribu\u00edda, caracter\u00edstica similar \u00e0 do inclin\u00f4metro j\u00e1 utilizado. Possui contagem de 1440 pulsos por volta, alcan\u00e7ando justamente o valor de 0,25\u00b0 de resolu\u00e7\u00e3o angular.\n4.2.2 Software\nO software executado no microcontrolador tem as seguintes funcionalidades:\n\u2022\tVerificar a exist\u00eancia de comandos vindos do PC;\no Aplicar comandos, caso existam;\n\u2022\tLer encoders do hod\u00f4metro e do inclin\u00f4metro;\no Calcular as posi\u00e7\u00f5es axial e angular do perfil\u00f4metro;\no Caso seja detectado deslocamento axial correspondente a um m\u00faltiplo inteiro do passo de aquisi\u00e7\u00e3o de\nimagens, efetuar o disparo de aquisi\u00e7\u00e3o na c\u00e2mera e enviar os dados de etiquetagem calculados.\nEntre os comandos enviados do programa de opera\u00e7\u00e3o do perfil\u00f4metro no PC para o sistema embarcado encontram-se:\n\u2022\tZerar medi\u00e7\u00e3o do deslocamento angular e/ou axial;\n\u2022\tTrocar a dist\u00e2ncia padr\u00e3o para aquisi\u00e7\u00e3o de imagens, i.e., a resolu\u00e7\u00e3o axial da medi\u00e7\u00e3o de perfil geom\u00e9trico, entre os valores 1, 2, 5 ou 10 mm;\n\u2022\tNotificar uma falha de envio de dados, demandando um reenvio;\n\u2022\tDefinir resolu\u00e7\u00e3o do inclin\u00f4metro em 1440 pulsos por revolu\u00e7\u00e3o ou 5000 pulsos por revolu\u00e7\u00e3o.\n4.2.2.1\tC\u00e1lculo de deslocamento e etiquetagem\nA leitura do novo estado do sinal do encoder e compara\u00e7\u00e3o com o estado anterior permite verificar o sentido do deslocamento da rota\u00e7\u00e3o de um encoder e, por consequ\u00eancia, o sentido do deslocamento axial ou angular do perfil\u00f4metro. Cada troca de estado gera um pulso. A partir de um dos estados apresentados na tabela 4, o encoder somente alcan\u00e7a outro diferente de apenas um bit, ou seja, com valor l\u00f3gico diferente em apenas uma das portas.\nApesar da roda do hod\u00f4metro ter sido projetada para gerar 10 pulsos do encoder por mil\u00edmetro percorrido, o valor real desta rela\u00e7\u00e3o n\u00e3o \u00e9 exato. A rela\u00e7\u00e3o mais corretamente utilizada \u00e9 obtida por calibra\u00e7\u00e3o do hod\u00f4metro, a partir da qual se obt\u00e9m um valor de dist\u00e2ncia percorrida por cada pulso recebido, valor obtido em termos de mil\u00edmetros por pulso. Invertendo-se este valor e normalizando-o para cada valor padr\u00e3o de espa\u00e7amento entre aquisi\u00e7\u00f5es, nomeadamente, 1, 2, 5 ou 10 mm, obt\u00e9m-se ent\u00e3o o n\u00famero do incremento de pulsos necess\u00e1rios para aquisi\u00e7\u00e3o de uma nova imagem. O n\u00famero inteiro mais pr\u00f3ximo deste valor obtido \u00e9 utilizado como crit\u00e9rio de aquisi\u00e7\u00e3o de imagem. Este valor \u00e9 aqui denominado pulsos por disparo.\nO valor de posi\u00e7\u00e3o axial utilizado para a etiquetagem da imagem correspondente a um determinado disparo \u00e9 o n\u00famero de pulsos do hod\u00f4metro acumulados at\u00e9 aquele instante, de modo que o software no PC possa transform\u00e1-lo num valor de posi\u00e7\u00e3o expresso em mil\u00edmetros. Similar e simultaneamente, quanto \u00e0 posi\u00e7\u00e3o angular medida pelo inclin\u00f4metro, \u00e9 enviado o n\u00famero de pulsos acumulados para que\nseja mapeado pelo software como um valor de \u00e2ngulo. Este envio de dados para etiquetagem acontece atrav\u00e9s de escrita nos registradores de envio de dados do microcontrolador logo ap\u00f3s o disparo de aquisi\u00e7\u00e3o. A mensagem utilizada tem tamanho de 9 bytes15, comportando cabe\u00e7alho, valor de posi\u00e7\u00e3o longitudinal e angular. O envio propriamente dito acontece paralelamente \u00e0 execu\u00e7\u00e3o do c\u00f3digo16 do programa, ap\u00f3s o t\u00e9rmino da escrita dos valores de etiquetagem.\nEsta estrat\u00e9gia de envio do valor correspondente ao n\u00famero de pulsos lidos evita um erro cumulativo de quantiza\u00e7\u00e3o que haveria caso se considerasse o disparo da aquisi\u00e7\u00e3o de imagem como sendo realizado exatamente ap\u00f3s se percorrer o valor de deslocamento padr\u00e3o. Como consequ\u00eancia, o n\u00famero de aquisi\u00e7\u00f5es realizadas em uma regi\u00e3o inspecionada pode diferir do esperado.\nPara exemplificar esta situa\u00e7\u00e3o, seja um hipot\u00e9tico valor de 10,25 pulsos por mil\u00edmetro percorrido, obtido ap\u00f3s calibra\u00e7\u00e3o do hod\u00f3metro. Suponha-se que o m\u00f3dulo de monitoramento est\u00e1 configurado para aquisi\u00e7\u00e3o a cada deslocamento de 1 mm. Neste caso, o primeiro disparo da aquisi\u00e7\u00e3o ocorre ao se receberem 10 pulsos do encoder do hod\u00f4metro, o que corresponde a um deslocamento de aproximadamente 0,97 mm. No entanto, as 100 primeiras imagens seriam adquiridas ao se percorrerem 97 mm, enquanto que o valor esperado seria de 100 mm.\nPara que este efeito seja mitigado, algumas das aquisi\u00e7\u00f5es s\u00e3o realizadas ap\u00f3s um n\u00famero de pulsos diferente, de modo a compensar a parte fracion\u00e1ria da rela\u00e7\u00e3o dada em pulsos por mil\u00edmetro. No exemplo do par\u00e1grafo anterior, a quarta aquisi\u00e7\u00e3o de um grupo de quatro disparos seria efetuada ap\u00f3s a leitura de 11 pulsos. Desta forma, a cada quatro imagens adquiridas, seriam necess\u00e1rios 41 pulsos do hod\u00f4metro. Com uma rela\u00e7\u00e3o de 10,25 pulsos/mm, tem-se neste caso um deslocamento percebido de 4 mm para a aquisi\u00e7\u00e3o de quatro imagens, o que corresponde ao valor esperado da opera\u00e7\u00e3o do sistema. Este cen\u00e1rio \u00e9 exemplificado na figura 39.\n15\tOs bytes neste caso s\u00e3o de 9 bits, pois cont\u00eam um bit de parada.\n16\tEntende-se aqui como c\u00f3digo a sequ\u00eancia bin\u00e1ria executada pelo microcontrolador, n\u00e3o o seu c\u00f3digo-fonte.\nFigura 39 - Ilustra\u00e7\u00e3o da altera\u00e7\u00e3o do n\u00famero de pulsos por disparo para um caso exemplo de 10,25 pulsos do encoder por mil\u00edmetro percorrido.\n\u25a0\tPulsos p/ aquisi\u00e7\u00e3o\n\u25a0\tPulsos no deslocamento\nFonte: Adaptado de (Melo, 2009).\nAo sofrer deslocamento no sentido contr\u00e1rio ao padr\u00e3o, o m\u00f3dulo de monitoramento n\u00e3o efetua disparo de aquisi\u00e7\u00e3o de imagem. Isto \u00e9 necess\u00e1rio porque, durante a opera\u00e7\u00e3o do perfil\u00f4metro, pode haver necessidade de desloc\u00e1-lo para tr\u00e1s para retirada de algum obst\u00e1culo, por exemplo. Ao se atingir novamente a posi\u00e7\u00e3o na qual teve o sentido de deslocamento invertido, o microcontrolador volta a efetuar disparos.\n4.2.2.2\tComportamento din\u00e2mico\nO algoritmo embarcado foi projetado para se comportar como ilustrado pelo diagrama de m\u00e1quina de estados da figura 40. A transi\u00e7\u00e3o de reinicializa\u00e7\u00e3o, por ser \u00f3bvia, foi retirada do diagrama para facilitar sua leitura.\nFigura 40 - Diagrama de m\u00e1quina de estados de alto n\u00edvel do software embarcado.\nFonte: Autor.\nNo estado Inicializa rotina s\u00e3o configuradas as portas do microcontrolador e declaradas as vari\u00e1veis de trabalho.\nO estado L\u00ea deslocamento axial e a transi\u00e7\u00e3o Int. do hod\u00f4metro, destacados no diagrama, s\u00f3 existem se for utilizado o recurso de interrup\u00e7\u00e3o do microcontrolador para a leitura do hod\u00f4metro. Isto corresponde a um evento na porta var_hodometro no modelo AADL. Esta estrat\u00e9gia pode ser adotada caso se note necessidade de prioriza\u00e7\u00e3o da leitura do deslocamento axial.\nA recep\u00e7\u00e3o de mensagens vindas do PC \u00e9 preemptiva (Int. USART), por\u00e9m deve ocorrer com uma frequ\u00eancia vigorosamente menor e toma menos instru\u00e7\u00f5es, al\u00e9m de que o m\u00f3dulo USART no microcontrolador utilizado opera em paralelo. O tratamento de mensagens do PC para o m\u00f3dulo embarcado funciona no modelo produtor-consumidor. Neste caso, o produtor \u00e9 representado pelo evento de chegada de mensagens, as quais v\u00e3o sendo enfileiradas em registradores pr\u00f3prios. O consumidor \u00e9 o c\u00f3digo que retira as mensagens da fila e as processa. Na figura 41, a qual cont\u00e9m o diagrama de atividades associado ao estado La\u00e7o de opera\u00e7\u00e3o, as a\u00e7\u00f5es Verifica mensagens e Aplica comandos representam o consumidor das mensagens.\nFigura 41 - Diagrama de atividades associadas ao estado \"La\u00e7o de opera\u00e7\u00e3o\".\nFonte: Autor.\nA a\u00e7\u00e3o L\u00ea deslocamento axial somente consumir\u00e1 algum tempo caso n\u00e3o seja utilizado o mecanismo de interrup\u00e7\u00e3o na leitura do deslocamento axial, conforme citado anteriormente.\nAs transi\u00e7\u00f5es correspondentes \u00e0 exist\u00eancia de mensagens est\u00e3o no singular devido \u00e0 estrat\u00e9gia de aplica\u00e7\u00e3o de uma mensagem por vez, conforme projeto.\n4.2.3\tAspectos de tempo real\nO sistema embarcado do PEROLA-I, quanto \u00e0 seguran\u00e7a, \u00e9 classificado como um sistema brando, na classifica\u00e7\u00e3o citada no item 2.3.1.2. Caso haja excesso de velocidade de disparos (mais do que a c\u00e2mera do sensor pode suportar) e/ou falhas na medi\u00e7\u00e3o, a qualidade da geometria final inspecionada perder\u00e1 resolu\u00e7\u00e3o axial na regi\u00e3o onde houver falhas, mas pode manter a qualidade em outras regi\u00f5es de aplica\u00e7\u00e3o. Igualmente, uma falha por si s\u00f3 neste caso n\u00e3o acarreta em dano irrevers\u00edvel. A resolu\u00e7\u00e3o axial do sistema \u00e9 suficiente para identificar os defeitos esperados mesmo que a medi\u00e7\u00e3o sofra algum grau de degrada\u00e7\u00e3o. Ainda, caso observado que a qualidade da inspe\u00e7\u00e3o n\u00e3o foi satisfat\u00f3ria em uma regi\u00e3o do mensurando, basta realiz\u00e1-la novamente.\nA carga de pico \u00e0 qual o m\u00f3dulo embarcado estar\u00e1 sujeito pode ser inferida analisando-se as tarefas modeladas juntamente \u00e0s especifica\u00e7\u00f5es de desempenho do sistema. Apesar do requisito de\nvelocidade de aquisi\u00e7\u00e3o ser claro, n\u00e3o \u00e9 poss\u00edvel garantir que o PEROLA-I n\u00e3o estar\u00e1 sujeito a deslocamento em velocidade acima da nominal. Portanto, o sistema \u00e9 de melhor esfor\u00e7o no que diz respeito \u00e0 garantia de resposta, tamb\u00e9m conforme citado no item 2.3.I.2.\nAs tarefas presentes na modelagem realizada s\u00e3o apresentadas na tabela 5, caracterizadas pelo n\u00famero arredondado de instru\u00e7\u00f5es geradas pelos seus c\u00f3digos e sua expectativa de ocorr\u00eancia.\nTabela 5 - Tarefas executadas pelo c\u00f3digo embarcado.\nTarefa\tDescri\u00e7\u00e3o\tN\u00b0 de instru\u00e7\u00f5es\tOcorr\u00eancia\nT0\tInicializa\u00e7\u00e3o\t50\t\u00danica\nT1\tVerifica\u00e7\u00e3o de mensagem\t30\tA cada la\u00e7o\nt2\tLeitura do hod\u00f3metro\t150\tA cada la\u00e7o\nt3\tLeitura do inclin\u00f3metro\t150\tA cada la\u00e7o\nt4\tRecep\u00e7\u00e3o de mensagem\t50\tA cada aquisi\u00e7\u00e3o\nt5\tAplica\u00e7\u00e3o de comando\t250\tA cada aquisi\u00e7\u00e3o\nT6\tVerifica\u00e7\u00e3o de necessidade de disparo\t20\tA cada la\u00e7o\nTy\tDisparo e etiquetagem\t400\tA cada aquisi\u00e7\u00e3o\nFonte: Autor.\nCada tarefa definida est\u00e1 associada a um estado do diagrama da figura 40 ou a uma a\u00e7\u00e3o da figura 41, obedecendo \u00e0 sequ\u00eancia ali apresentada. Todas s\u00e3o, portanto, tarefas controladas, exceto t4, a qual \u00e9 espor\u00e1dica, pois depende da transi\u00e7\u00e3o Int. USART que pode ocorrer a qualquer momento. Caso a leitura do hod\u00f3metro seja utilizada por interrup\u00e7\u00e3o na porta do microcontrolador, t2 tamb\u00e9m se torna espor\u00e1dica, com sua execu\u00e7\u00e3o dependendo da ocorr\u00eancia da transi\u00e7\u00e3o Int. do hod\u00f3metro.\nO tempo de execu\u00e7\u00e3o real das tarefas \u00e9 obtido atrav\u00e9s de rotinas de teste que simulam o pior caso de execu\u00e7\u00e3o. No entanto, a an\u00e1lise realizada aqui leva em conta o tempo de execu\u00e7\u00e3o como sendo proporcional ao n\u00famero de instru\u00e7\u00f5es do microcontrolador correspondentes a cada tarefa. As raz\u00f5es disto s\u00e3o a simplicidade para an\u00e1lise preliminar e que o tempo real de execu\u00e7\u00e3o depende de modelos de microcontrolador e configura\u00e7\u00f5es que podem ser ajustadas, enquanto o n\u00famero de instru\u00e7\u00f5es permanece o mesmo para o c\u00f3digo desenvolvido.\nO per\u00edodo cr\u00edtico de ocorr\u00eancia de tarefas para o m\u00f3dulo de monitora\u00e7\u00e3o \u00e9 dado pelo requisito de velocidade de inspe\u00e7\u00e3o em imagens por segundo. Utilizando-se uma c\u00e2mera com taxa de aquisi\u00e7\u00e3o m\u00e1xima de n quadros por segundo, o intervalo de an\u00e1lise para um cen\u00e1rio de carga de pico deve ser tomado como sendo de (1 0 0 0/n) milissegundos. Este deve ser o intervalo de ocorr\u00eancia da tarefa t 7, respons\u00e1vel por comandar uma aquisi\u00e7\u00e3o de imagem. Por exemplo, tomando-se o limite de taxa de aquisi\u00e7\u00e3o da c\u00e2mera GigE utilizada como 60 imagens por segundo, deve-se fazer uma estimativa de ocorr\u00eancia de um ciclo de tarefas num per\u00edodo de 16 ms para se verificar que o sistema seja capaz de cumprir os requisitos de desempenho.\nO tempo de processamento de imagem do sensor \u00e9 plenamente adequado ao per\u00edodo estabelecido, conforme citado no item 2.2.3. A taxa de aquisi\u00e7\u00e3o da c\u00e2mera GigE supera o requisito m\u00ednimo correspondente, resultando em certa folga, o que \u00e9 sempre desej\u00e1vel. Por\u00e9m, caso o per\u00edodo de chegada de t 7 seja menor, ou seja, se houver mais pedidos de aquisi\u00e7\u00e3o de imagem do que o suportado pela c\u00e2mera, as requisi\u00e7\u00f5es excedentes simplesmente n\u00e3o ser\u00e3o atendidas, resultando em degrada\u00e7\u00e3o da resposta do sistema.\nOutro fator temporal n\u00e3o relacionado com o n\u00famero de instru\u00e7\u00f5es das tarefas \u00e9 o tempo de envio dos dados de etiquetagem a partir do m\u00f3dulo USART do microcontrolador. Algumas inst\u00e2ncias da tarefa T5e todas da tarefa t7 enviam 9 bytes referentes \u00e0 etiquetagem das imagens, pelo que um ciclo de tarefas entre duas aquisi\u00e7\u00f5es deve comportar o tempo necess\u00e1rio para este envio. Este tempo depende de quantas ocorr\u00eancias de envio de etiquetagem h\u00e1 entre duas aquisi\u00e7\u00f5es na modelagem realizada para estudo de carga de pico e da lat\u00eancia escolhida para a comunica\u00e7\u00e3o serial.\nUtilizando-se a configura\u00e7\u00e3o de resolu\u00e7\u00e3o axial de 1 mm, tem-se dez trocas de estado do encoder do hod\u00f3metro entre aquisi\u00e7\u00f5es, gerando a chegada de dez tarefas t2 caso seja utilizada a prioriza\u00e7\u00e3o por interrup\u00e7\u00e3o, ou demandando a execu\u00e7\u00e3o de pelo menos 10 la\u00e7os de atividades em caso contr\u00e1rio. Se utilizada a resolu\u00e7\u00e3o axial de 10 mm, ter-se-\u00e1 pr\u00f3ximo a 100 ocorr\u00eancias da mesma tarefa entre duas aquisi\u00e7\u00f5es de imagem. Caso, com a mesma configura\u00e7\u00e3o de 10 mm de resolu\u00e7\u00e3o axial, n\u00e3o se utilize a tarefa t2 como preemptiva, deve-se ter 100 execu\u00e7\u00f5es de la\u00e7o de opera\u00e7\u00e3o entre aquisi\u00e7\u00f5es para que seja feita a leitura adequada do hod\u00f3metro.\nQuanto \u00e0s tarefas T4e t 5 , n\u00e3o \u00e9 prevista no comportamento do sistema uma alta taxa de envio de mensagens PC - SE. Estas s\u00e3o\nesperadas, em sua maioria, antes do in\u00edcio da opera\u00e7\u00e3o, para zerar as medidas e configurar as resolu\u00e7\u00f5es axial e angular. Contudo, a mensagem de notifica\u00e7\u00e3o de falha de comunica\u00e7\u00e3o, a qual \u00e9 enviada automaticamente pelo m\u00f3dulo de controle da c\u00e2mera no PC anfitri\u00e3o numa situa\u00e7\u00e3o de falha, pode ocorrer com razo\u00e1vel frequ\u00eancia, principalmente numa situa\u00e7\u00e3o de carga de pico. Mesmo que a frequ\u00eancia de ocorr\u00eancia das tarefas T4e t5 n\u00e3o venha a ser compar\u00e1vel \u00e0 taxa de aquisi\u00e7\u00e3o de imagens, \u00e9 fundamental analisar o caso onde h\u00e1 uma ocorr\u00eancia de cada uma delas entre duas aquisi\u00e7\u00f5es.\nFoi estabelecido um cen\u00e1rio para avalia\u00e7\u00e3o do sistema quando sujeito a uma carga de pico. Este cen\u00e1rio define ocorr\u00eancias de tarefas em um per\u00edodo cr\u00edtico entre duas aquisi\u00e7\u00f5es de imagens, conforme considera\u00e7\u00f5es feitas at\u00e9 aqui. Sua defini\u00e7\u00e3o \u00e9 a seguinte:\n\u2022\tNo intervalo analisado entre duas ocorr\u00eancias de t7 , h\u00e1 a chegada de duas mensagens do PC, gerando duas tarefas t4. A primeira notifica a falha no envio da etiquetagem do pen\u00faltimo disparo, demandando o seu reenvio; outra mensagem notifica a falha no envio da etiquetagem do \u00faltimo disparo, demandando mais um envio, o que acarreta duas ocorr\u00eancias de t 5. A soma destes dois pares de tarefas consome 600 instru\u00e7\u00f5es. Paralelamente, h\u00e1 o envio de 18 bytes em mensagens.\n\u2022\tPara a correta leitura do hod\u00f3metro sob a configura\u00e7\u00e3o de disparo de aquisi\u00e7\u00e3o a cada 10 mm percorridos, h\u00e1 100 ocorr\u00eancias do la\u00e7o de tarefas [t4, t2 , t3 , t6], cada uma consumindo 350 instru\u00e7\u00f5es, num total de 35 mil.\n\u2022\tNo encerramento deste ciclo h\u00e1 um disparo de aquisi\u00e7\u00e3o t7, o qual consome 400 instru\u00e7\u00f5es e acrescenta mais 9 bytes para envio pelo USART.\nQuanto \u00e0 transmiss\u00e3o de dados, para que os 27 bytes do cen\u00e1rio definido sejam transmitidos em tempo h\u00e1bil, a taxa de transmiss\u00e3o deve ser maior do que 15.187,5 bits por segundo (bps), valor necess\u00e1rio para enviar os 243 bits da mensagem em 16 ms. Portanto, a taxa de transmiss\u00e3o utilizada foi definida como 19200 bps para que se possa lidar com estas ocorr\u00eancias com seguran\u00e7a.\nConforme descri\u00e7\u00e3o do cen\u00e1rio de alta carga, o microcontrolador deve ser capaz de executar pelo menos 36 mil instru\u00e7\u00f5es entre duas aquisi\u00e7\u00f5es de imagem. Levando-se em conta os 16 ms de tempo m\u00ednimo entre aquisi\u00e7\u00f5es no caso da c\u00e2mera GigE, nota-se a necessidade de um microcontrolador que execute mais de 2,25 milh\u00f5es\nde instru\u00e7\u00f5es por segundo (MIPS) para a correta opera\u00e7\u00e3o com o c\u00f3digo desenvolvido. O microcontrolador PIC\u00ae utilizado pode operar, utilizando o seu oscilador interno, a at\u00e9 2 MIPS (Microchip, 2004). Portanto, sujeitando o m\u00f3dulo de monitora\u00e7\u00e3o \u00e0 carga de pico definida, deve haver degrada\u00e7\u00e3o da resposta em termos de erro de leitura do hod\u00f4metro e, consequentemente, de aquisi\u00e7\u00e3o de imagens na posi\u00e7\u00e3o esperada.\nTrocando-se a configura\u00e7\u00e3o da leitura do hod\u00f3metro para que seja realizada por interrup\u00e7\u00e3o, ou seja, fazendo com que a tarefa t2 seja tornada espor\u00e1dica e de mais alta prioridade, n\u00e3o s\u00e3o mais necess\u00e1rias tantas ocorr\u00eancias do la\u00e7o principal de tarefas controladas [t-l, t3, t6] entre aquisi\u00e7\u00f5es num cen\u00e1rio de carga de pico. Reduzindo-se a estimativa para 20 execu\u00e7\u00f5es deste la\u00e7o reduzido, somado a 100 ocorr\u00eancias de t2 e \u00e0s outras ocorr\u00eancias definidas, reduz-se a carga de pico a 20 mil instru\u00e7\u00f5es num novo cen\u00e1rio. Neste caso, existe a demanda de 1,25 MIPS, valor menor que a capacidade de processamento do microcontrolador utilizado.\n4.3\tM\u00d3DULO DE GERENCIAMENTO DA C\u00c2MERA DO SENSOR\nA fun\u00e7\u00e3o deste m\u00f3dulo \u00e9 oferecer ao software de opera\u00e7\u00e3o do PEROLA-I, executado no PC anfitri\u00e3o, o acesso \u00e0 c\u00e2mera do sensor e ao m\u00f3dulo embarcado de monitora\u00e7\u00e3o de deslocamento. Isto \u00e9 realizado atrav\u00e9s de uma biblioteca com as seguintes funcionalidades:\n\u2022\tVisualiza\u00e7\u00e3o da imagem corrente na c\u00e2mera;\n\u2022\tConfigura\u00e7\u00e3o dos par\u00e2metros da captura de imagem da c\u00e2mera;\n\u2022\tEnvio de comandos ao sistema embarcado;\n\u2022\tDisponibiliza\u00e7\u00e3o e indexa\u00e7\u00e3o das imagens etiquetadas recebidas ap\u00f3s disparo efetuado pelo SE.\n4.3.1 Modelagem\nA biblioteca foi projetada de modo a separar os conceitos de recurso, l\u00f3gica de aplica\u00e7\u00e3o e interface. Como recurso tem-se as imagens etiquetadas, a medi\u00e7\u00e3o e a c\u00e2mera, principalmente. Apesar da c\u00e2mera ser utilizada no PEROLA-I com a finalidade de realizar a medi\u00e7\u00e3o do perfil de sec\u00e7\u00f5es e tamb\u00e9m us\u00e1-la como canal de comunica\u00e7\u00e3o, optou-se por modelar sua entidade correspondente em software de forma desvinculada da sua forma de aplica\u00e7\u00e3o, a fim de favorecer a reusabilidade.\nO diagrama de classes da figura 42 apresenta, de forma bastante simplificada, as classes do m\u00f3dulo de gerenciamento da c\u00e2mera do sensor. Foram mantidos basicamente os atributos e m\u00e9todos essenciais para a compreens\u00e3o do projeto realizado.\nFigura 42 - Diagrama de classes simplificado do m\u00f3dulo de gerenciamento da c\u00e2mera do sensor.\nFonte: Autor.\nPara a utiliza\u00e7\u00e3o de diferentes modelos de c\u00e2mera, foi concebida uma classe abstrata Camera, a qual disp\u00f5e de atributos e\nm\u00e9todos comuns a c\u00e2meras acess\u00edveis por software, independentemente do modelo e fabricante. Seus atributos e m\u00e9todos expostos s\u00e3o coerentes com o dispositivo Camera apresentado no modelo AADL na se\u00e7\u00e3o 5.2. Permitem realizar, entre outras a\u00e7\u00f5es, a aquisi\u00e7\u00e3o de imagens, a escrita e leitura de registradores, permitindo a comunica\u00e7\u00e3o com o sistema embarcado, al\u00e9m da defini\u00e7\u00e3o do modo de acionamento como externo ou interno. Tamb\u00e9m est\u00e1 reservado um m\u00e9todo para utiliza\u00e7\u00e3o de um componente de configura\u00e7\u00e3o dos par\u00e2metros da c\u00e2mera.\nPara o funcionamento com uma c\u00e2mera em espec\u00edfico, deve-se criar uma classe que implemente esta classe abstrata e tenha acesso \u00e0 API pr\u00f3pria para o funcionamento com aquele modelo ou fam\u00edlia de c\u00e2mera. Isto pode ser feito com o aux\u00edlio de kits de desenvolvimento de software (software development kits, SDKs) espec\u00edficas de fabricantes de c\u00e2mera ou APIs com vasto suporte. O controle de configura\u00e7\u00e3o, por exemplo, pode ser fornecido pelo fabricante atrav\u00e9s do SDK ou pode ser implementado pelo desenvolvedor do PEROLA-I. Naturalmente, nem todas as funcionalidades estar\u00e3o presentes em todos os modelos de c\u00e2mera. Nestes casos, podem ser programadas mensagens de erro nos m\u00e9todos e atribui\u00e7\u00f5es ausentes.\nNo estado atual de desenvolvimento tem-se tr\u00eas implementa\u00e7\u00f5es da classe abstrata c\u00e2mera. Uma permite acesso \u00e0s c\u00e2meras firewire das concep\u00e7\u00f5es mais antigas do sensor \u00f3ptico. Outra fornece acesso ao modelo de c\u00e2mera Gigabit Ethernet utilizado na concep\u00e7\u00e3o mais atual. A \u00faltima \u00e9 uma \u201cc\u00e2mera virtual de testes\u201d, um trecho de software que emula uma c\u00e2mera ao fornecer imagens por eventos com uma cad\u00eancia definida.\nA classe CameraHandler permite o uso da c\u00e2mera num cen\u00e1rio t\u00edpico, ao disponibilizar um la\u00e7o de aquisi\u00e7\u00e3o, m\u00e9todos de conex\u00e3o e desconex\u00e3o e uma retrochamada para a recep\u00e7\u00e3o de imagens. De modo a aplicar este cen\u00e1rio ao contexto de medi\u00e7\u00e3o do PEROLA-I, foi criada uma classe MeasurementCameraHandler que herda CameraHandler e agrega objetos do tipo TaggedImage e Measurement. O objeto TaggedImage representa a \u00faltima imagem etiquetada adquirida, objeto que \u00e9 copiado pelo m\u00f3dulo de processamento logo ap\u00f3s a aquisi\u00e7\u00e3o. Os dados de etiquetagem s\u00e3o a posi\u00e7\u00e3o de aquisi\u00e7\u00e3o daquela imagem e o \u00e2ngulo com que ela foi adquirida. J\u00e1 a classe Measurement cont\u00e9m metadados da opera\u00e7\u00e3o de perfilometria para uma regi\u00e3o onde o PEROLA-I estiver sendo aplicado.\nA classe MeasurementCameraHandler \u00e9 a principal entidade do processo de medi\u00e7\u00e3o, portanto, pois permite o acesso \u00e0 c\u00e2mera do ponto de vista da sua aplica\u00e7\u00e3o como componente do sensor \u00f3ptico a laser. A\nsepara\u00e7\u00e3o de conceitos seguida permite, por exemplo, que os m\u00e9todos de comunica\u00e7\u00e3o com o sistema embarcado expostos nesta classe tenham implementa\u00e7\u00f5es diferentes caso seja aplicada uma c\u00e2mera sem o uso de interface de comunica\u00e7\u00e3o com dispositivo externo.\nDo ponto de vista din\u00e2mico, o la\u00e7o de aquisi\u00e7\u00e3o de imagens etiquetadas funciona como o diagrama de atividades da figura 43.\nFigura 43 - Diagrama de atividades do la\u00e7o de aquisi\u00e7\u00e3o de imagens de MeasurementCameraHandler.\nDisparo de aquisi\u00e7\u00e3o\nNotifica falha\nLeitura serial\nAquisi\u00e7\u00e3o de imagem\nEnvio de mensagem para o SE\n! V [N\u00e3o]\nTentativas excedidas?\nAguardo de disparo de aquisi\u00e7\u00e3o 7K\nJ-\nr\nI\n' Sucesso?\n/\" IEntrega de \\ Sim] a imagem etiquetada ao i [N\u00e3c\nEscrita serial\nFonte: Autor.\nO la\u00e7o de aquisi\u00e7\u00e3o tem como principal atividade aguardar um disparo de aquisi\u00e7\u00e3o. Este pode ser dado internamente pela c\u00e2mera, caso esteja configurada desta forma, ou pelo sinal vindo do m\u00f3dulo embarcado de monitora\u00e7\u00e3o. Ap\u00f3s a recep\u00e7\u00e3o da imagem, esta \u00e9 disponibilizada para apresenta\u00e7\u00e3o na tela. O c\u00f3digo tenta ler os registradores de comunica\u00e7\u00e3o serial da c\u00e2mera em busca dos dados de etiquetagem. Caso n\u00e3o haja dados ou estes estejam incorretos, uma falha \u00e9 notificada ao SE, o que influencia nos dados sobre a medi\u00e7\u00e3o e acarreta numa mensagem ao m\u00f3dulo embarcado. Se o SE responder adequadamente, a imagem \u00e9 normalmente etiquetada. Sen\u00e3o, considerase uma falha de aquisi\u00e7\u00e3o.\nPara cada aquisi\u00e7\u00e3o efetuada com sucesso, tem-se a imagem da sec\u00e7\u00e3o correspondente etiquetada com os dados de posi\u00e7\u00e3o longitudinal no interior do tubo e o seu \u00e2ngulo relativo de aquisi\u00e7\u00e3o. Estes dados est\u00e3o prontos para ser enviados ao m\u00f3dulo de processamento do PEROLA-I para que sejam traduzidos em geometria, conforme explicado no item 2.2.3, e posteriormente concatenados para se formar a geometria da regi\u00e3o inspecionada, conforme item 3.1.\nDurante a execu\u00e7\u00e3o do la\u00e7o de aquisi\u00e7\u00e3o, caso o operador decida enviar um comando ao m\u00f3dulo embarcado, este envio \u00e9 feito diretamente, desviando o fluxo de execu\u00e7\u00e3o para o envio da mensagem e retornando em seguida.\n4.3.2\tInterface de usu\u00e1rio\nPara a aplica\u00e7\u00e3o direta da biblioteca desenvolvida, foi criado um controle de interface gr\u00e1fica integr\u00e1vel, representado no diagrama de classes da figura 42 por CameraUI. Uma captura de tela desta interface \u00e9 mostrada na figura 44.\nIniciar medi\u00e7\u00e3o\t\tInterromper medi\u00e7\u00e3o\nCaptura e abre imagem\t\tReiniciar encoder\n\t\t\nReiniciar indin\u00f4metro\t\tReiniciar Hod+lnc\nConfigurar Hardware\n| Configurar c\u00e2mera | Dados da medi\u00e7\u00e3o O C\u00e2mera ligada [V] Mostrar imagens G3 Mostrar resultado S Trigger\nDeslocamento\t\nVelocidade\tmm/s\nVel. M\u00e9dia\tmm/s\nVel. M\u00e1xima\tmm/s\nVel. Segura\tmm/s\nPosi\u00e7\u00e3o\tmm\nInclina\u00e7\u00e3o\tgraus\nImagens\t\nTotal adquiridas\t\nTotal perdidas\t\nPerdidas agora\t\nFonte: Autor.\nFigura 44 - Captura de tela da interface gr\u00e1fica do m\u00f3dulo de controle da c\u00e2mera do sensor. As cores apresentadas na imagem capturada pela c\u00e2mera s\u00e3o\nde uma palheta artificial, pois a c\u00e2mera \u00e9 preto-e-branco.\nAquisi\u00e7\u00e3o Din\u00e2mi X ^Visualiza\u00e7\u00e3o\nOs comandos dispon\u00edveis para envio ao SE s\u00e3o todos aqueles descritos para o sistema de aquisi\u00e7\u00e3o e disponibiliza\u00e7\u00e3o de imagens. A interface tamb\u00e9m apresenta valores de monitora\u00e7\u00e3o, permitindo ao usu\u00e1rio perceber a exist\u00eancia de falhas, visualizar a velocidade instant\u00e2nea de deslocamento do perfil\u00f4metro e registrar a m\u00e1xima velocidade sem haver perda de imagens, entre outras informa\u00e7\u00f5es.\n4.4\tCONCLUS\u00c3O\nO desenvolvimento apresentado do sistema de aquisi\u00e7\u00e3o e disponibiliza\u00e7\u00e3o de imagens fornece subs\u00eddios para a aplica\u00e7\u00e3o do sensor \u00f3ptico na perfilometria de uma regi\u00e3o de tubo. Foi cumprida a fun\u00e7\u00e3o A1 do modelo IDEF0 do PEROLA-I, a qual tem como entrada o deslocamento do perfil\u00f4metro, como sa\u00edda um conjunto de imagens etiquetadas e foi desenvolvida respeitando as caracter\u00edsticas do sensor \u00f3ptico e estrutura mec\u00e2nica previamente concebida.\nAo se realizar a integra\u00e7\u00e3o deste m\u00f3dulo com o software de opera\u00e7\u00e3o e processamento de imagens, tornou-se poss\u00edvel a aquisi\u00e7\u00e3o de nuvens de pontos representantes da geometria de uma regi\u00e3o de tubo mensurada.\n102\n5\tSISTEMA DE REALIDADE VIRTUAL\tPARA\nVISUALIZA\u00c7\u00c3O E AN\u00c1LISE DE MEDI\u00c7\u00d5ES\nEste cap\u00edtulo apresenta o projeto do sistema de realidade virtual para navega\u00e7\u00e3o, visualiza\u00e7\u00e3o e an\u00e1lise de nuvens de pontos cil\u00edndricas obtidas pelos perfil\u00f4metros PEROLA-I e PEROLA-E.\nPrimeiramente se apresentam os requisitos do projeto PEROLA relativos ao sistema de visualiza\u00e7\u00e3o de nuvens de pontos e a motiva\u00e7\u00e3o que levou \u00e0 sua concep\u00e7\u00e3o como um sistema de realidade virtual. Ent\u00e3o \u00e9 mostrada a organiza\u00e7\u00e3o geral do sistema de RV e suas funcionalidades projetadas em termos de casos de uso. \u00c9 apresentado em seguida o padr\u00e3o de armazenamento de nuvens de pontos cil\u00edndricas definido para o projeto PEROLA. O projeto detalhado do sistema de realidade virtual e sua implementa\u00e7\u00e3o s\u00e3o apresentados nos itens subsequentes.\n5.1\tMOTIVA\u00c7\u00c3O E REQUISITOS\nEntre os requisitos do PEROLA-I apresentados na tabela 2 relativos \u00e0 visualiza\u00e7\u00e3o do resultado de medi\u00e7\u00e3o, define-se a necessidade de que seja capaz de exibir a geometria adquirida em 3D, seja simples e amig\u00e1vel ao usu\u00e1rio, possa ser operado em laptop e possua funcionalidade de extra\u00e7\u00e3o de par\u00e2metros geom\u00e9tricos.\nCom base nas ferramentas de leitura de resultados de perfilometria dos m\u00e9todos de inspe\u00e7\u00e3o apresentados no item 2.1, nota-se a necessidade de desenvolvimento de uma ferramenta inovadora, poderosa e intuitiva para visualiza\u00e7\u00e3o da geometria adquirida, dada a import\u00e2ncia da correta interpreta\u00e7\u00e3o de dados adquiridos por m\u00e9todos de inspe\u00e7\u00e3o geom\u00e9trica na ind\u00fastria petroqu\u00edmica. Neste sentido, o uso de t\u00e9cnicas de realidade virtual se mostra como uma alternativa interessante, pois tende a tornar mais natural a leitura de um grande volume de dados ao utilizar m\u00e9todos intuitivos e imersivos.\nIdealmente, se um usu\u00e1rio analista pudesse se sentir transportado para dentro da regi\u00e3o de tubo inspecionada, ainda tendo acesso a dados quantitativos extra\u00eddos no processo de medi\u00e7\u00e3o, seria poss\u00edvel unir caracter\u00edsticas positivas de uma inspe\u00e7\u00e3o visual com a riqueza de informa\u00e7\u00e3o quantitativa da descri\u00e7\u00e3o geom\u00e9trica em uma \u00fanica an\u00e1lise. Portanto, \u00e9 importante tamb\u00e9m que a ferramenta desenvolvida mantenha um alto grau de similaridade com m\u00e9todos de leitura comumente adotados, de forma a exigir do seu usu\u00e1rio um m\u00ednimo esfor\u00e7o de adapta\u00e7\u00e3o.\nAl\u00e9m do resultado de medi\u00e7\u00e3o do PEROLA-I, o sistema de visualiza\u00e7\u00e3o projetado aqui tamb\u00e9m deve ser capaz de realizar a leitura das nuvens de pontos cil\u00edndricas geradas como sa\u00edda do PEROLA-E. Para ambos os casos, faz-se necess\u00e1ria a defini\u00e7\u00e3o de um padr\u00e3o de armazenamento destas nuvens de pontos.\nA partir das ideias discutidas e dos requisitos de visualiza\u00e7\u00e3o do PEROLA, foram consolidados os seguintes requisitos para o sistema de visualiza\u00e7\u00e3o:\n\u2022\t2A - Representa\u00e7\u00e3o tridimensional das nuvens de pontos cil\u00edndricas, utilizando t\u00e9cnicas de realidade virtual;\n\u2022\t2B - Navega\u00e7\u00e3o intuitiva em primeira pessoa em ambiente virtual, com a presen\u00e7a da geometria 3D e de objetos de aux\u00edlio \u00e0 leitura;\n\u2022\t2C - Visualiza\u00e7\u00e3o estereosc\u00f3pica do ambiente virtual, incluindo a geometria tridimensional reconstru\u00edda;\n\u2022\t2D - Representa\u00e7\u00e3o planificada da geometria inspecionada, conforme formatos comumente adotados na ind\u00fastria;\n\u2022\t2E - Aplica\u00e7\u00e3o de escala de cores radial personaliz\u00e1vel \u00e0s representa\u00e7\u00f5es planificada e tridimensional, de modo a real\u00e7ar visualmente os valores apresentados;\n\u2022\t2F - Aplica\u00e7\u00e3o de fator de escala geom\u00e9trica radial \u00e0 representa\u00e7\u00e3o 3D, a fim de ressaltar visualmente imperfei\u00e7\u00f5es geom\u00e9tricas menos percept\u00edveis;\n\u2022\t2G - Defini\u00e7\u00e3o de limites de visualiza\u00e7\u00e3o (cortes), de modo a simplificar a leitura de determinadas regi\u00f5es de interesse escolhidas pelo usu\u00e1rio;\n\u2022\t2H - Extra\u00e7\u00e3o de caracter\u00edsticas geom\u00e9tricas al\u00e9m daquelas passadas pelo perfil\u00f4metro, o que inclui c\u00e1lculo de \u00e1rea danificada e volume de material perdido e/ou depositado numa regi\u00e3o;\n\u2022\t2J - Aplica\u00e7\u00e3o de notas de usu\u00e1rio salvas junto \u00e0 nuvem de pontos.\n5.2\tCONCEP\u00c7\u00c3O\nDe modo a cumprir os requisitos estabelecidos, foi concebido um Sistema de Realidade Virtual (SRV) composto do seguinte ecossistema:\n\u2022\tUm software de navega\u00e7\u00e3o, visualiza\u00e7\u00e3o e an\u00e1lise da nuvem de pontos;\n\u2022\tComputador com placa de v\u00eddeo capaz de executar aplica\u00e7\u00f5es OpenGL estereosc\u00f3picas;\n\u2022\tPerif\u00e9ricos de realidade virtual, consistindo de display estereosc\u00f3pico e m\u00e9todos de entrada intuitivos.\nO software de visualiza\u00e7\u00e3o, por ser o cerne do sistema, poder\u00e1 ser referido adiante como sendo o pr\u00f3prio SRV, por simplicidade de nota\u00e7\u00e3o.\nO hardware de realidade virtual escolhido para o desenvolvimento do sistema consistiu em um Head Mounted Display (HMD) estereosc\u00f3pico e um joystick de 12 bot\u00f5es e duas alavancas anal\u00f3gicas, modelo bastante comum no mercado.\nO HMD \u00e9 respons\u00e1vel por entregar, para cada olho do usu\u00e1rio, a imagem correspondente \u00e0 cena vista daquele ponto, causando a impress\u00e3o de profundidade na visualiza\u00e7\u00e3o da cena. O modelo utilizado, j\u00e1 dispon\u00edvel no laborat\u00f3rio anteriormente ao in\u00edcio do projeto, utiliza dois pequenos monitores LCD posicionados em frente a cada olho. Estes monitores atualizam a cena a 60 quadros por segundo (ou 60 Hz) cada. A informa\u00e7\u00e3o vinda da placa de v\u00eddeo do computador referente aos quadros \u00e9 direcionada a cada monitor pela sua paridade. Portanto, o computador deve fornecer atualiza\u00e7\u00e3o de imagens a 120 quadros por segundo, metade dos quais vai para o monitor esquerdo, metade para o direito.\nDe modo a permitir o desenho das cenas correspondentes a cada olho e interagir com o HMD, escolheu-se uma placa de v\u00eddeo NVIDIA\u00ae Quadro FX\u00ae, utilizada no computador de desenvolvimento do sistema. Esta placa, assim como toda a fam\u00edlia Quadro FX, por possuir quatro buffers de sa\u00edda de imagens, \u00e9 capaz de oferecer imagens duplas a 120 Hz sem perda significante de desempenho (NVIDIA Corporation, 2012). Isto se deve ao fato de que, por possuir quatro buffers, permite a renderiza\u00e7\u00e3o de duas cenas em paralelo. A fam\u00edlia Quadro FX \u00e9 tamb\u00e9m otimizada para o uso da API gr\u00e1fica OpenGL, a qual foi escolhida para o SRV por ser um padr\u00e3o em visualiza\u00e7\u00e3o muito difundido nos meios industrial e cient\u00edfico.\nMesmo com o uso de hardware estereosc\u00f3pico, \u00e9 responsabilidade do software o c\u00e1lculo dos pares de visualiza\u00e7\u00f5es da cena para causar o efeito de profundidade desejado. Apesar de demandar maior esfor\u00e7o de desenvolvimento, esta caracter\u00edstica faz com que o software desenvolvido seja compat\u00edvel com diferentes m\u00e9todos de apresenta\u00e7\u00e3o.\nO joystick utilizado \u00e9 suficiente para permitir ao usu\u00e1rio aproveitar todas as funcionalidades de visualiza\u00e7\u00e3o e navega\u00e7\u00e3o oferecidas pelo software sem a utiliza\u00e7\u00e3o de teclado ou mouse, embora a utiliza\u00e7\u00e3o destes \u00faltimos seja permitida. O software foi projetado de modo a suportar diferentes modelos de m\u00e9todos de entrada, conforme ser\u00e1 detalhado no seu projeto.\nPara ilustra\u00e7\u00e3o do ecossistema utilizado no desenvolvimento do sistema, a figura 45 apresenta um usu\u00e1rio do sistema utilizando o HMD e o joystick. Na tela do computador pode ser vista a imagem gerada pelo software do sistema. No HMD, a cena visualizada \u00e9 a mesma, por\u00e9m com a sensa\u00e7\u00e3o visual de profundidade.\nFigura 45 - Usu\u00e1rio do sistema utilizando HMD e joystick, ambos em destaque. O computador possui placa de v\u00eddeo capaz de gerar imagens estereosc\u00f3picas.\nFonte: Autor.\n5.2.1\tCasos de uso\nOs casos de uso definidos para o sistema de realidade virtual foram agrupados em sistemas para a simplifica\u00e7\u00e3o da sua apresenta\u00e7\u00e3o. Na figura 46 podem ser vistos os atores do sistema e os casos de uso relativos ao armazenamento dos dados.\nFonte: Autor.\nOs perfil\u00f4metros do projeto PEROLA geram as nuvens de pontos cil\u00edndricas que s\u00e3o lidas pelo SRV. O salvamento por parte do usu\u00e1rio diz respeito somente \u00e0s anota\u00e7\u00f5es adicionadas, sendo a geometria tratada como somente leitura. O padr\u00e3o de armazenamento de NPCs \u00e9 apresentado no item 5.3.\nO SRV tamb\u00e9m deve salvar as prefer\u00eancias do usu\u00e1rio, quando aplicadas.\nOs casos de uso relativos \u00e0s visualiza\u00e7\u00f5es planificada (2D) e tridimensional da nuvem de pontos s\u00e3o apresentadas no diagrama da figura 47.\nNota-se pelas rela\u00e7\u00f5es entre os casos de uso que os mapas de cores e limita\u00e7\u00f5es de geometria visualizada (cortes) devem ser compartilhados entre as duas representa\u00e7\u00f5es. Os par\u00e2metros de ilumina\u00e7\u00e3o devem ser manipul\u00e1veis pelo usu\u00e1rio, de modo a facilitar a leitura visual da geometria. A possibilidade de rota\u00e7\u00e3o da geometria 3D \u00e9 importante para se manter a vis\u00e3o em primeira pessoa, sendo ainda capaz de visualizar a geometria por todos os \u00e2ngulos.\nOs casos de uso relativos \u00e0 navega\u00e7\u00e3o e objetos de aux\u00edlio no ambiente virtual s\u00e3o apresentados na figura 48.\nO uso de transporte animado e \u201ccolis\u00e3o\u201d do ponto de vista do usu\u00e1rio com a geometria (impossibilidade de atravessar a geometria virtualmente reconstru\u00edda) favorece a sensa\u00e7\u00e3o de intera\u00e7\u00e3o com o ambiente. Os objetos virtuais citados nos casos de uso foram definidos com o objetivo de favorecer a leitura da geometria. No caso dos postes, seu desenho se d\u00e1 nos locais com anota\u00e7\u00f5es. Por isto ele possui uma rela\u00e7\u00e3o de inclus\u00e3o com o caso de uso \u201cobter anota\u00e7\u00f5es\u201d, apresentado na figura 49, a qual cont\u00e9m os casos de uso relativos \u00e0 an\u00e1lise dos dados da medi\u00e7\u00e3o e \u00e0s anota\u00e7\u00f5es de usu\u00e1rio.\nOs c\u00e1lculos de volume de material removido ou depositado sobre a superf\u00edcie do tubo s\u00e3o realizados nas regi\u00f5es definidas pelo usu\u00e1rio. Estes c\u00e1lculos levar\u00e3o em conta apenas valores que excederem o que o usu\u00e1rio definir como limiar de defeito.\nAs anota\u00e7\u00f5es de usu\u00e1rio s\u00e3o indexadas por posi\u00e7\u00e3o angular e axial da medi\u00e7\u00e3o apresentada.\nAs pr\u00f3ximas duas se\u00e7\u00f5es apresentam o desenvolvimento das ferramentas necess\u00e1rias para o cumprimento dos casos de uso apresentados.\n5.3\tPADR\u00c3O DE ARMAZENAMENTO DE NUVENS DE PONTOS CIL\u00cdNDRICAS\nO padr\u00e3o de armazenamento foi projetado com a finalidade de representar de forma \u00fanica as medi\u00e7\u00f5es dos perfil\u00f4metros externo e\ninterno. Suas caracter\u00edsticas foram definidas para satisfazer necessidades espec\u00edficas do projeto. Entre estas caracter\u00edsticas, pode-se citar o posicionamento de sec\u00e7\u00f5es irregularmente espa\u00e7adas para o caso do PEROLA-I. Para o caso do PEROLA-E, por sua vez, \u00e9 necess\u00e1ria a representa\u00e7\u00e3o de nuvens de pontos cil\u00edndricas limitadas angularmente, ou seja, cujas sec\u00e7\u00f5es geom\u00e9tricas n\u00e3o envolvem uma volta completa (360\u00b0) em torno do eixo do tubo inspecionado.\nA denomina\u00e7\u00e3o escolhida foi \u201cnuvem de pontos estendida\u201d ou, simplesmente, XCP (do ingl\u00eas eXtended Cloud of Points). Suas principais caracter\u00edsticas s\u00e3o:\n\u2022\tArmazenamento de valores em coordenadas cil\u00edndricas no formato bin\u00e1rio (menor espa\u00e7o ocupado e menor tempo de leitura e escrita);\n\u2022\tOp\u00e7\u00e3o de armazenar malhas de pontos cujas sec\u00e7\u00f5es s\u00e3o espa\u00e7adas de um valor fixo (como \u00e9 a medi\u00e7\u00e3o do perfil\u00f4metro externo) ou com o valor do posicionamento axial de cada sec\u00e7\u00e3o (caso do perfil\u00f4metro interno);\n\u2022\tOp\u00e7\u00e3o de armazenar malhas de pontos com alcance angular incompleto (regi\u00e3o mensurada cobrindo menos do que 360\u00b0), como acontece com as medi\u00e7\u00f5es do perfil\u00f4metro externo;\n\u2022\tArmazenamento de valores-chave da medi\u00e7\u00e3o, como posi\u00e7\u00e3o axial de in\u00edcio e fim;\n\u2022\tArmazenamento de valores de cabe\u00e7alho, como data, hora, local e operador da medi\u00e7\u00e3o;\n\u2022\tArmazenamento de anota\u00e7\u00f5es de usu\u00e1rio.\nO diagrama de classe da figura 50 apresenta os principais atributos e m\u00e9todos da entidade que representa a nuvem de pontos segundo o padr\u00e3o XCP.\nFigura 50 - Diagrama de classe simplificado da medi\u00e7\u00e3o em coordenadas cil\u00edndricas como definida pelo padr\u00e3o XCP.\nXCP\n+lnfo : string +AngularBegin : float +AngularEnd : float +AxialBegin: double +AxialEnd : double +AngularResolution : float +AxialResolution : float\n+Radii : floatQQ +UserNotes: UserNoteQ\n+Load() +Save(string)\nFonte: Autor.\nO atributo Radii armazena os valores em coordenadas cil\u00edndricas conforme figura 30, item 3.1. Cada posi\u00e7\u00e3o cont\u00e9m um valor de raio. Seus valores de \u00e2ngulo e posi\u00e7\u00e3o no eixo Z s\u00e3o inferidos atrav\u00e9s da sua posi\u00e7\u00e3o na tabela e dos valores-chave da medi\u00e7\u00e3o. Isto leva em conta, portanto, que valores vizinhos na tabela sejam tamb\u00e9m vizinhos na geometria.\nDesta maneira, o formato de arquivos projetado aqui consegue representar de forma indiferente as medi\u00e7\u00f5es internas e externas, possibilitando o uso do mesmo software de visualiza\u00e7\u00e3o para ambos os perfil\u00f4metros. A biblioteca que cumpre esta especifica\u00e7\u00e3o foi implementada e integrada nos softwares do PEROLA-E e PEROLA-I, os quais criam as medi\u00e7\u00f5es e utilizam a biblioteca para armazen\u00e1-las.\nAl\u00e9m de utilizar este protocolo pr\u00f3prio, o software desenvolvido tamb\u00e9m \u00e9 capaz de importar nuvens de pontos cil\u00edndricas armazenadas no formato \u201cCOP\u201d, utilizado por outros sistemas de medi\u00e7\u00e3o de perfil geom\u00e9trico do LABMETRO-UFSC.\n5.4\tPROJETO E DESENVOLVIMENTO DO SOFTWARE\nEsta se\u00e7\u00e3o apresenta, primeiramente, as decis\u00f5es de projeto de software tomadas para possibilitar os casos de uso definidos para o\nsistema de realidade virtual. Em seguida \u00e9 mostrado o desenvolvimento alcan\u00e7ado do software, com suas caracter\u00edsticas agrupadas de acordo com o aspecto funcional do qual fazem parte.\n5.4.1 Arquitetura\nAs modelagens estrutural e din\u00e2mica realizadas para o SRV s\u00e3o apresentadas aqui atrav\u00e9s de diagramas de classe e de atividade, respectivamente. Os diagramas apresentados foram simplificados de forma a ressaltar nuances de interesse.\nNo diagrama da figura 51 s\u00e3o apresentadas classes relacionadas \u00e0 visualiza\u00e7\u00e3o.\nFigura 51 - Diagrama de classes simplificado de parte do SRV. Esta representa\u00e7\u00e3o tem o objetivo de dar foco \u00e0s funcionalidades gr\u00e1ficas e de an\u00e1lise geom\u00e9trica do sistema.\nFonte: Autor.\nPara a apresenta\u00e7\u00e3o de sa\u00edda gr\u00e1fica OpenGL \u00e9 necess\u00e1ria uma liga\u00e7\u00e3o entre a API e a biblioteca gr\u00e1fica do sistema operacional. Isto \u00e9 realizado atrav\u00e9s da classe GLControl, a qual representa uma \u00e1rea de exibi\u00e7\u00e3o na tela capaz de responder a comandos OpenGL. A rela\u00e7\u00e3o desta \u00e1rea de exibi\u00e7\u00e3o com as chamadas da API \u00e9 dada atrav\u00e9s do ponteiro RenderingContext. Esta classe tamb\u00e9m \u00e9 respons\u00e1vel pela ativa\u00e7\u00e3o da sa\u00edda estereosc\u00f3pica, quando aplic\u00e1vel.\nForam dimensionadas estas \u00e1reas de exibi\u00e7\u00e3o para a janela principal do programa e para janelas de exibi\u00e7\u00e3o exclusiva de sa\u00edda OpenGL em tela cheia. Por ser o HMD um segundo monitor, \u00e9 necess\u00e1ria a utiliza\u00e7\u00e3o, para este \u00faltimo, de uma \u00e1rea de renderiza\u00e7\u00e3o pr\u00f3pria, no caso uma inst\u00e2ncia da classe FullScreenWindow. A mesma\nclasse pode oferecer a visualiza\u00e7\u00e3o estereosc\u00f3pica no monitor principal, caso haja suporte do hardware utilizado, ou simplesmente permitir a vis\u00e3o em tela cheia, mesmo que sem a percep\u00e7\u00e3o de profundidade.\nA classe respons\u00e1vel pelo encadeamento de chamadas OpenGL \u00e9 a Drawer. Sua \u00fanica inst\u00e2ncia deve ter acesso a cada um dos RenderingContexts dispon\u00edveis. Esta classe define o volume delimitador da visualiza\u00e7\u00e3o dentro do espa\u00e7o cartesiano utilizado pela API gr\u00e1fica. Este espa\u00e7o \u00e9 calculado com base no ponto de vista do usu\u00e1rio que \u201cnavega\u201d pelo ambiente, representado pela classe User. Os objetos17 a serem desenhados no ambiente virtual s\u00e3o implementa\u00e7\u00f5es de DrawableObject, classe abstrata modelada para simplificar a inclus\u00e3o de novos objetos virtuais na estrutura do sistema. Os atributos de cada inst\u00e2ncia ativa s\u00e3o levados em conta para a prioriza\u00e7\u00e3o de desenho.\nO principal objeto virtual desenh\u00e1vel \u00e9 a representa\u00e7\u00e3o da geometria da regi\u00e3o de tubo inspecionada, representada pela classe Pipe. Os dados de representa\u00e7\u00e3o geom\u00e9trica, extra\u00eddos de um objeto XCP aberto, s\u00e3o divididos em v\u00e1rias inst\u00e2ncias de Slice a fim de aliviar a carga computacional, conforme ser\u00e1 explicado adiante. Os atributos da classe Pipe dizem respeito \u00e0 forma como a reconstru\u00e7\u00e3o virtual do tubo \u00e9 visualizada, incluindo os planos de corte aplicados, o mapa de cores utilizado e o fator de escala radial.\nPor \u00faltimo em rela\u00e7\u00e3o ao diagrama da figura 51, o controle de visualiza\u00e7\u00e3o planificada da nuvem de pontos tem acesso \u00e0 classe Pipe para manter coerentes, entre as vistas 2D e 3D, os par\u00e2metros de visualiza\u00e7\u00e3o aplicados. A classe respons\u00e1vel pelos c\u00e1lculos de caracter\u00edsticas geom\u00e9tricas, Analyzer, tem para si a defini\u00e7\u00e3o de regi\u00f5es de interesse definidas pelo usu\u00e1rio. O acesso aos dados geom\u00e9tricos \u00e9 feito diretamente da medi\u00e7\u00e3o apresentada, pois a an\u00e1lise dos dados independe da forma como s\u00e3o mostrados.\nO diagrama da figura 52 apresenta o modelo de tratamento de dispositivos de entrada adotado.\n17 Objeto, neste caso, refere-se a uma representa\u00e7\u00e3o gr\u00e1fica de uma entidade. N\u00e3o deve ser confundido com uma inst\u00e2ncia de classe do jarg\u00e3o do paradigma de orienta\u00e7\u00e3o a objetos.\nFigura 52 - Diagrama de classes do pacote de dispositivos de entrada e sua intera\u00e7\u00e3o com o resto do sistema.\nFonte: Autor.\nSimilarmente \u00e0 estrat\u00e9gia adotada no caso de objetos virtuais, os dispositivos de entrada s\u00e3o tratados de forma \u00fanica, atrav\u00e9s da interface IlnputDev\u00edce. Isto facilita a inser\u00e7\u00e3o de novos m\u00e9todos de entrada. A classe Operat\u00edonProv\u00edder exp\u00f5e os m\u00e9todos acess\u00edveis pelos comandos de entrada de usu\u00e1rio, os quais representam opera\u00e7\u00f5es no sistema, como navega\u00e7\u00e3o ou troca de fator de escala radial, por exemplo. Usando polimorfismo e retrochamadas, a classe InputHandler define quais m\u00e9todos s\u00e3o vinculados a determinados comandos dos dispositivos utilizados.\nPara possibilitar a opera\u00e7\u00e3o fluida e consistente do software, o mesmo foi projetado para se comportar dinamicamente conforme diagrama de atividades da figura 53.\nFigura 53 - Diagrama de atividades simplificado do comportamento din\u00e2mico do SRV.\nFonte: Autor.\nAp\u00f3s o carregamento inicial do programa e seus m\u00f3dulos, o SRV, al\u00e9m de responder aos eventos de interface gr\u00e1fica t\u00edpicos de programas Desktop, mant\u00e9m um la\u00e7o de execu\u00e7\u00e3o constante. Neste la\u00e7o s\u00e3o verificados comandos de entrada, aplicados os comandos correspondentes e renderizada a cena, nesta ordem. A opera\u00e7\u00e3o de desenho da cena \u00e9 bloqueante, fazendo com que o os eventos de interface gr\u00e1fica sejam apenas tratados ao final de cada uma das suas execu\u00e7\u00f5es.\nAo se aplicar algum comando ao sistema, portanto, valores do estado interno de seus componentes s\u00e3o alterados sem resposta visual\nimediata. A a\u00e7\u00e3o de desenho da cena, ocorrida em seguida, simplesmente desenha todos os elementos baseado no seu estado corrente. Antes disto, por\u00e9m, \u00e9 verificada a exist\u00eancia de opera\u00e7\u00f5es computacionalmente dispendiosas comandadas pelo usu\u00e1rio. Estas a\u00e7\u00f5es devem ser divididas pelo programa em trechos pouco dispendiosos. Desta forma, intercalando-os com as atividades de leitura de entrada e desenho da cena, \u00e9 evitado o bloqueio do programa.\nEntre as atividades dispendiosas encontram-se, basicamente, o desenho e redesenho da nuvem de pontos cil\u00edndrica. Os objetos da classe Slice que comp\u00f5em a geometria desenhada da nuvem de pontos s\u00e3o criados um por um da forma citada. Ao se mudar os par\u00e2metros de representa\u00e7\u00e3o, como escala radial ou o mapa de cores, cada uma delas \u00e9 marcada para redesenho.\n5.4.2\tFuncionalidades de visualiza\u00e7\u00e3o\nA interface principal do software possui um menu de comandos, uma \u00e1rea de informa\u00e7\u00f5es da medi\u00e7\u00e3o aberta, um controle de visualiza\u00e7\u00e3o planificada e an\u00e1lise geom\u00e9trica e uma \u00e1rea de desenho OpenGL, onde \u00e9 exibido um ambiente virtual. Alternativamente, o sistema pode ser utilizado em tela cheia, somente com a \u00e1rea de renderiza\u00e7\u00e3o da API gr\u00e1fica.\nA nuvem de pontos representante da geometria mensurada pelo perfil\u00f4metro vem na forma cil\u00edndrica, ou seja, cada ponto possui valores de raio (R), \u00e2ngulo (0) e posi\u00e7\u00e3o longitudinal (Z). Para que sejam passados para a API gr\u00e1fica, estes pontos s\u00e3o convertidos para coordenadas cartesianas (X, Y e Z).\nCada conjunto de tr\u00eas pontos pr\u00f3ximos \u00e9 utilizado para definir um tri\u00e2ngulo. Desta forma toda a nuvem de pontos \u00e9 desenhada no ambiente virtual, atrav\u00e9s de malhas de tri\u00e2ngulos definidos entre os pontos adquiridos, formando um s\u00f3lido virtual. A cada ponto da malha, ou v\u00e9rtice, se associa uma posi\u00e7\u00e3o no espa\u00e7o cartesiano, uma cor e um vetor normal. A cor \u00e9 obtida em fun\u00e7\u00e3o do valor de raio correspondente de cada v\u00e9rtice na escala de cores utilizada. O vetor normal de um v\u00e9rtice \u00e9 definido com base nos outros v\u00e9rtices dos tri\u00e2ngulos dos quais faz parte. Sua import\u00e2ncia se d\u00e1 na aplica\u00e7\u00e3o de recursos de ilumina\u00e7\u00e3o e sombreamento.\nResumindo a sequ\u00eancia de etapas do desenho da nuvem de pontos:\n\u2022 Os pontos representantes da geometria do tubo a ser desenhado s\u00e3o obtidos a partir do arquivo XCP aberto;\n\u2022\tCada ponto, em coordenadas cil\u00edndricas, \u00e9 transformado para coordenadas cartesianas;\n\u2022\tA cada ponto se associa um valor de cor;\n\u2022\tCria-se uma malha de tri\u00e2ngulos em toda a regi\u00e3o, sendo cada tri\u00e2ngulo entre tr\u00eas pontos vizinhos da malha, em sequ\u00eancia;\n\u2022\tA cada ponto (ou v\u00e9rtice de um tri\u00e2ngulo) se associa um valor de normal, calculado com base nos vetores formados entre o ponto de interesse e dois pontos vizinhos em sequ\u00eancia.\nA figura 54 \u00e9 uma poss\u00edvel sa\u00edda da vis\u00e3o 3D do sistema de realidade virtual. Nela se apresenta uma regi\u00e3o de tubo reconstru\u00edda, vista externamente, com a aplica\u00e7\u00e3o de ilumina\u00e7\u00e3o, mapa de cores e objetos virtuais de aux\u00edlio \u00e0 leitura e navega\u00e7\u00e3o. Os objetos virtuais s\u00e3o uma r\u00e9gua, um sistema de coordenadas e um anel que delimita o m\u00e1ximo valor de raio visualizado, de acordo com a escala de cores exibida. Pode-se notar, em rela\u00e7\u00e3o \u00e0 reconstru\u00e7\u00e3o geom\u00e9trica, a aparente \u201crugosidade\u201d da regi\u00e3o apresentada, poss\u00edvel pelo uso de normais e fontes de luz em OpenGL.\nA mesma regi\u00e3o \u00e9 vista na sua representa\u00e7\u00e3o planificada na figura 55, notadamente com detalhes geom\u00e9tricos menos evidenciados. As falhas de leitura de pontos representadas por buracos na representa\u00e7\u00e3o tridimensional s\u00e3o representadas como pixels transparentes na vis\u00e3o planificada. O software oferece a possibilidade de limitar a regi\u00e3o visualizada em termos de faixas de valores axiais e angulares, o que pode ser feito simultaneamente para a vis\u00e3o planificada e tridimensional. O mapa de cores tamb\u00e9m \u00e9 compartilhado, mesmo que seja personalizado pelo usu\u00e1rio.\n\nFigura 54 - Uma poss\u00edvel tela de sa\u00edda do SRV, apresentando a reconstru\u00e7\u00e3o tridimensional de uma regi\u00e3o geom\u00e9trica inspecionada e objetos virtuais de leitura. A visualiza\u00e7\u00e3o apresentada \u00e9 do poto de vista externo, por\u00e9m de uma geometria interna. Os valores sem unidade est\u00e3o em mil\u00edmetros.\nW X\n84,94\n87,53\n\u201980,13\n77,72\njfe.\nRealce de seccao\nA: 90,00 Graus\nZ: 1044,6 mm\nR: 82,65 mm\nFonte: Autor.\nFigura 55 - Vis\u00e3o planificada, gerada pelo SRV, da regi\u00e3o apresentada na figura 54. Este tipo de visualiza\u00e7\u00e3o \u00e9 similar ao encontrado em outros m\u00e9todos de inspe\u00e7\u00e3o. No software apresentado, esta vis\u00e3o pode ser utilizada simultaneamente \u00e0 tridimensional.\nFonte: Autor.\nA fim de evidenciar as funcionalidades desenvolvidas de ilumina\u00e7\u00e3o, escala radial e mapa de cores, a figura 56 a seguir apresenta uma mesma regi\u00e3o reconstru\u00edda com diferentes par\u00e2metros de visualiza\u00e7\u00e3o. Primeiramente, \u00e9 mostrada uma cena com fator de escala unit\u00e1rio, com a aplica\u00e7\u00e3o da escala de cores padr\u00e3o e determinados par\u00e2metros de ilumina\u00e7\u00e3o. Em cada uma das outras imagens apresentadas na mesma figura, foi trocada apenas uma destas caracter\u00edsticas, mantendo, por\u00e9m o mesmo ponto de vista. As escalas de cores utilizadas na figura 56 est\u00e3o na figura 57.\nFigura 56 - Compara\u00e7\u00e3o visual entre imagens obtidas com diferentes par\u00e2metros de visualiza\u00e7\u00e3o tridimensional para uma mesma cena. A partir de uma cena original se alterou somente um par\u00e2metro: (a) cena original, (b) escala radial dobrada, (c) par\u00e2metros de ilumina\u00e7\u00e3o alterados e (d) escala de cores alterada.\nFonte: Autor.\nFigura 57 - Escalas de cores utilizadas na figura 56. \u00c0 esquerda, a escala utilizada nas partes (a), (b) e (c) da figura 56. \u00c0 direita, a escala utilizada na parte (d) da figura 56. Os valores est\u00e3o em mil\u00edmetros.\nFonte: Autor.\nEntre a parte (a) e a parte (b), pode-se notar a mudan\u00e7a de escala radial, a qual pode evidenciar melhor os defeitos medidos. Na parte (b), a escala radial \u00e9 o dobro da escala da parte (a). Entre a parte (a) e a parte (c), pode-se notar uma mudan\u00e7a de par\u00e2metros de ilumina\u00e7\u00e3o. A luz ambiente foi reduzida e a luz difusa foi incrementada. Entre a parte (a) e a parte (d), pode-se notar uma mudan\u00e7a na escala de cores. Estas compara\u00e7\u00f5es visuais servem para evidenciar as funcionalidades citadas. A sinergia entre estas funcionalidades possibilita a an\u00e1lise qualitativa da nuvem de pontos por parte do usu\u00e1rio.\n5.4.3\tImers\u00e3o e interatividade\nA navega\u00e7\u00e3o no ambiente virtual do sistema, como j\u00e1 citado, \u00e9 feita no ponto de vista de primeira pessoa, de modo a causar a imers\u00e3o do usu\u00e1rio na cena, principalmente quando se utiliza o hardware de RV\ndimensionado. Relacionada \u00e0 imers\u00e3o est\u00e1 tamb\u00e9m a possibilidade do usu\u00e1rio virtualmente \u201ccolidir\u201d com as paredes do tubo durante a navega\u00e7\u00e3o, ou seja, ser incapaz de atravess\u00e1-las. Esta funcionalidade, al\u00e9m de vir ao encontro da filosofia de RV implantada, pode servir para manter a orienta\u00e7\u00e3o do usu\u00e1rio.\nAssim como a op\u00e7\u00e3o de colis\u00e3o, os objetos de leitura apresentados na figura 54 podem ser ativados ou desativados. No caso dos objetos virtuais, podem ser posicionados no ambiente ao gosto do usu\u00e1rio. Al\u00e9m daqueles j\u00e1 apresentados, h\u00e1 ainda um apontador para leitura de valores individuais de raio, apresentado na figura 58, a qual \u00e9 uma vista interna de uma regi\u00e3o mensurada. Similarmente ao apontador, na vis\u00e3o planificada \u00e9 poss\u00edvel a leitura dos valores individuais apontando-se para a posi\u00e7\u00e3o desejada com o mouse.\nFigura 58 - Vista interna de uma regi\u00e3o de tubo. Nesta ocasi\u00e3o, o usu\u00e1rio utiliza um apontador virtual para a leitura do valor individual de raio de um ponto. H\u00e1 ainda a presen\u00e7a de uma anota\u00e7\u00e3o.______________________________________________\nAngulo: 66,76 graus\nPosicao: 1244,1 mm\nVinco artificial do gabarito\nRealce de seccao\nA: 109,25 Graus \\ Z: 1155,2 mm\nR: 80,94 mm\n.. - - -\u25a0\nFonte: Autor.\nO anel da figura indica o menor valor de raio abrangido pela escala de cores, analogamente ao anel externo visto na figura 54. Estes an\u00e9is podem ser ajustados dinamicamente para aux\u00edlio do ajuste da\nescala, indicando visualmente onde se encontram os limites radias da visualiza\u00e7\u00e3o corrente.\nNo topo da figura 58 pode ser vista uma anota\u00e7\u00e3o feita por um usu\u00e1rio. Estas anota\u00e7\u00f5es s\u00e3o salvas juntamente \u00e0 nuvem de pontos para que outros usu\u00e1rios possam conferi-las. De modo a avisar um usu\u00e1rio da presen\u00e7a de anota\u00e7\u00f5es, o ambiente virtual disp\u00f5e de \u201cpostes\u201d nos locais onde elas foram inseridas. Para realizar a leitura de uma anota\u00e7\u00e3o, basta o usu\u00e1rio navegar at\u00e9 a regi\u00e3o correspondente ou, simplesmente, utilizar o comando de \u201cnavegar at\u00e9 a pr\u00f3xima anota\u00e7\u00e3o\u201d dispon\u00edvel.\nPara causar sensa\u00e7\u00e3o visual de profundidade, quando se deseja utilizar a visualiza\u00e7\u00e3o estereosc\u00f3pica, as cenas devem ser renderizadas de dois pontos de vista levemente diferentes. Cada ponto \u00e9 correspondente a um dos olhos do usu\u00e1rio. Al\u00e9m da separa\u00e7\u00e3o dos pontos de vista, \u00e9 necess\u00e1ria a readapta\u00e7\u00e3o dos volumes de proje\u00e7\u00e3o. O tipo de volume de proje\u00e7\u00e3o utilizado na gera\u00e7\u00e3o de imagens estereosc\u00f3picas \u00e9 assim\u00e9trico, de modo a fazer coincidir o plano de proje\u00e7\u00e3o na tela para as duas visualiza\u00e7\u00f5es, conforme figura 59. Esta estrat\u00e9gia foi escolhida com o objetivo de causar maior conforto visual18. O par\u00e2metro ajust\u00e1vel pelo usu\u00e1rio para a vis\u00e3o estereosc\u00f3pica \u00e9 a separa\u00e7\u00e3o ocular. Dado um valor de separa\u00e7\u00e3o, o software calcula as proje\u00e7\u00f5es assim\u00e9tricas de modo a coincidir o plano da tela para ambas. Quanto maior ela for, mais intensa ser\u00e1 a sensa\u00e7\u00e3o de profundidade experimentada na visualiza\u00e7\u00e3o. Um valor de separa\u00e7\u00e3o demasiado alto, no entanto, pode causar desconforto visual.\n18 Esta impress\u00e3o pode variar de usu\u00e1rio para usu\u00e1rio.\nFigura 59 - Esquema de volumes de proje\u00e7\u00e3o assim\u00e9tricos utilizado na gera\u00e7\u00e0o\nA figura 60 \u00e9 um exemplo de par estereosc\u00f3pico gerado pelo software.\nFonte: Autor.\n5.4.4\tAn\u00e1lise geom\u00e9trica\nO sistema de realidade virtual desenvolvido fornece algumas funcionalidades que permitem ao seu usu\u00e1rio analisar quantitativamente a nuvem de pontos mensurada por um dos perfil\u00f4metros do projeto PEROLA, al\u00e9m da an\u00e1lise qualitativa permitida pelas funcionalidades de visualiza\u00e7\u00e3o.\nNo controle gr\u00e1fico de visualiza\u00e7\u00e3o planificada, o usu\u00e1rio pode definir regi\u00f5es de interesse atrav\u00e9s de ret\u00e2ngulos, fornecendo para isto\ndois pontos. As regi\u00f5es de interesse s\u00e3o definidas, portanto, como uma faixa de valores axiais e angulares, de forma id\u00eantica \u00e0 limita\u00e7\u00e3o de visualiza\u00e7\u00e3o planificada e tridimensional. A figura 61 apresenta uma parte desta interface.\nFigura 61 - Uma parte da interface de visualiza\u00e7\u00e3o planificada e an\u00e1lise, onde se pode ver uma lista de regi\u00f5es definidas, valores de leitura para a regi\u00e3o selecionada e uma \u00e1rea de visualiza\u00e7\u00e3o planificada desta regi\u00e3o. Neste caso, \u00e9 vista uma regi\u00e3o com defeitos evidenciados em vermelho.\nFonte: Autor.\nPara cada regi\u00e3o definida, um algoritmo calcula a sua \u00e1rea danificada, o volume de material removido e/ou depositado e a espessura m\u00ednima encontrada naquela regi\u00e3o. A confiabilidade destes c\u00e1lculos depende da alimenta\u00e7\u00e3o, por parte do usu\u00e1rio, dos valores de raio interno (sem defeitos) do tubo mensurado, do seu raio externo e do limiar a partir do que se considera uma diferen\u00e7a de valores de raio como um defeito.\nO software \u00e9 capaz de sugerir o valor de raio nominal da medi\u00e7\u00e3o, verificando a faixa de valores que representa a moda da amostra. No entanto, esta estrat\u00e9gia pode gerar resultados equivocados, caso a \u00e1rea danificada do tubo medido seja muito alta, ou o tipo de dano apresentado acarretar em altera\u00e7\u00e3o geom\u00e9trica de valor quase constante. De toda forma, os valores s\u00e3o calculados com base nos valores de entrada apresentados na interface do programa.\nNo caso do raio externo (ou espessura da parede do tubo), por serem o PEROLA-I e PEROLA-E m\u00e9todos de medi\u00e7\u00e3o \u00f3ptica, n\u00e3o \u00e9 poss\u00edvel que este valor seja medido ou inferido de alguma forma, ficando exclusivamente a cargo do usu\u00e1rio, quem deve possuir dados adicionais confi\u00e1veis.\nPara a defini\u00e7\u00e3o do limiar de defeito, o software disp\u00f5e de um aux\u00edlio visual para o usu\u00e1rio. \u00c0 medida que os valores de raio nominal e limiar de defeito s\u00e3o alterados pelo usu\u00e1rio, uma vis\u00e3o planificada secund\u00e1ria da medi\u00e7\u00e3o, similar \u00e0quela apresentada na figura 55, \u00e9 atualizada. Nesta vis\u00e3o alternativa, \u00e9 mostrada em azul a \u00e1rea considerada, baseados nos valores alimentados, como sendo de defeito por ac\u00famulo de material; em vermelho, a \u00e1rea considerada defeituosa por perda de material; em cinza, a \u00e1rea considerada como \u201csadia\u201d e, em branco, a \u00e1rea cuja geometria n\u00e3o pode ser medida. Isto funciona tanto para a vista geral/limitada da medi\u00e7\u00e3o quanto para a vista de regi\u00e3o selecionada, como na figura 61, onde s\u00e3o apresentados alguns defeitos para uma regi\u00e3o definida pelo usu\u00e1rio. Esta regi\u00e3o \u00e9 uma parte da geometria apresentada na figura 55.\nDesta forma, o usu\u00e1rio pode inspecionar visualmente uma regi\u00e3o, chegar \u00e0 conclus\u00e3o de que ali h\u00e1 um defeito e posteriormente delimitar a regi\u00e3o de interesse para os c\u00e1lculos, j\u00e1 sabendo de antem\u00e3o o formato aproximado do defeito. A fluida resposta visual \u00e0s varia\u00e7\u00f5es de par\u00e2metros definidos pelo usu\u00e1rio auxilia nesta tarefa de identifica\u00e7\u00e3o manual de defeitos.\nO algoritmo de c\u00e1lculo de volume removido e depositado funciona como um \u201cinterpolador de ordem zero\u201d, fornecendo um resultado aproximado, ao considerar a contribui\u00e7\u00e3o volum\u00e9trica da regi\u00e3o em torno de cada ponto baseada somente no valor daquele ponto, sem levar em conta a rela\u00e7\u00e3o com os pontos vizinhos.\nA contribui\u00e7\u00e3o volum\u00e9trica V de cada ponto \u00e9 dada pela seguinte equa\u00e7\u00e3o:\nV = AZ x 6 x\n(2)\n2\nOnde:\n21 Z = Dist\u00e2ncia da sec\u00e7\u00e3o atual \u00e0 pr\u00f3xima sec\u00e7\u00e3o;\n0 = \u00c2ngulo compreendido pelo ponto em quest\u00e3o;\nR = Raio do ponto em quest\u00e3o;\nRm = Raio padr\u00e3o (sem defeitos) da regi\u00e3o considerada.\nA contribui\u00e7\u00e3o de cada ponto s\u00f3 \u00e9 levada em conta se a diferen\u00e7a entre o seu valor de raio R e o raio padr\u00e3o Rm for maior que o limiar de defeito passado como entrada pelo usu\u00e1rio. Caso a diferen\u00e7a entre R e Rm seja negativa, a contribui\u00e7\u00e3o do ponto referido \u00e9 tida como ac\u00famulo de material.\n5.5\tCONCLUS\u00c3O\nO sistema de realidade virtual desenvolvido atende os requisitos estabelecidos, tanto pelo PEROLA-I como aqueles definidos localmente com o objetivo de fornecer uma forma inovadora de leitura de perfil geom\u00e9trico.\nMesmo com caracter\u00edsticas inovadoras, o SRV tamb\u00e9m oferece m\u00e9todos consagrados de leitura do perfil geom\u00e9trico, tentando explorar a complementa\u00e7\u00e3o entre ambos para tornar-se uma poderosa ferramenta de an\u00e1lise geom\u00e9trica.\nA arquitetura do sistema foi concebida de forma que este possa sofrer expans\u00e3o ou melhora sem altera\u00e7\u00f5es estruturais importantes.\n6\tRESULTADOS E AVALIA\u00c7\u00c3O DAS FERRAMENTAS DESENVOLVIDAS\nCom o desenvolvimento do sistema de aquisi\u00e7\u00e3o e disponibiliza\u00e7\u00e3o de imagens apresentado no cap\u00edtulo 5, juntamente com a sua integra\u00e7\u00e3o aos outros m\u00f3dulos constituintes do PEROLA-I, foi poss\u00edvel a constru\u00e7\u00e3o de um prot\u00f3tipo de perfil\u00f4metro capaz de adquirir a geometria interna de tubos utilizando a tecnologia do sensor \u00f3ptico por triangula\u00e7\u00e3o c\u00f4nica a laser.\nA implementa\u00e7\u00e3o do padr\u00e3o de armazenamento de nuvens de pontos cil\u00edndricas permitiu o uso do sistema de realidade virtual apresentado no cap\u00edtulo 6 para a visualiza\u00e7\u00e3o e an\u00e1lise de perfis geom\u00e9tricos obtidos pelo prot\u00f3tipo do PEROLA-I.\nPara a valida\u00e7\u00e3o destas ferramentas, primeiramente foram realizados testes em bancada do m\u00f3dulo de monitora\u00e7\u00e3o de deslocamentos, a fim de calibrar o seu hod\u00f4metro e avaliar o seu comportamento na aquisi\u00e7\u00e3o e etiquetagem de imagens.\nN\u00e3o houve necessidade de calibra\u00e7\u00e3o do inclin\u00f4metro por dois motivos. O primeiro \u00e9 que o deslocamento angular a ser sofrido pelo perfil\u00f4metro \u00e9 considerado como uma perturba\u00e7\u00e3o, n\u00e3o um deslocamento padr\u00e3o do sistema. A velocidade angular \u00e0 qual o perfil\u00f4metro est\u00e1 sujeito \u00e9 muito baixa em compara\u00e7\u00e3o com a velocidade de deslocamento axial. O segundo motivo \u00e9 que o hod\u00f4metro utilizado j\u00e1 dispunha de folas de calibra\u00e7\u00e3o e testes din\u00e2micos do pr\u00f3prio fabricante.\nPara a avalia\u00e7\u00e3o do desempenho das ferramentas desenvolvidas neste trabalho frente \u00e0 opera\u00e7\u00e3o completa do prot\u00f3tipo do PEROLA-I, primeiramente realizaram-se testes de inspe\u00e7\u00e3o em bancada para, posteriormente, o prot\u00f3tipo ser levado a campo para a inspe\u00e7\u00e3o de tubos met\u00e1licos utilizados na ind\u00fastria petroqu\u00edmica e que apresentavam danos na sua estrutura. Os resultados destas avalia\u00e7\u00f5es s\u00e3o apresentados nas se\u00e7\u00f5es a seguir.\n6.1\tAVALIA\u00c7\u00c3O DO SISTEMA DE AQUISI\u00c7\u00c3O E DISPONIBILIZA\u00c7\u00c3O DE IMAGENS\nPara as avalia\u00e7\u00f5es deste sistema foi feita uma montagem do m\u00f3dulo embarcado de monitora\u00e7\u00e3o juntamente com a c\u00e2mera do sensor, dispostos na estrutura mec\u00e2nica do perfil\u00f4metro correspondente a estes componentes. Esta estrutura mec\u00e2nica foi posicionada sobre uma r\u00e9gua met\u00e1lica com o aux\u00edlio de suportes, conforme ilustra a figura 62. Os\ntestes foram realizados com a c\u00e2mera ligada a um computador executando o m\u00f3dulo de gerenciamento da c\u00e2mera. Desta forma foi poss\u00edvel efetuar a medi\u00e7\u00e3o de deslocamento juntamente \u00e0s atividades de aquisi\u00e7\u00e3o de imagem e etiquetagem. Em todos os testes neste item, o microcontrolador foi configurado para trabalhar sob a frequ\u00eancia de 4 MHz, o que produz 1 MIPS.\nFigura 62 - Montagem feita durante a calibra\u00e7\u00e3o do hod\u00f3metro.\nFonte: LABMETRO-UFSC.\nA primeira avalia\u00e7\u00e3o teve como objetivo a calibra\u00e7\u00e3o do hod\u00f3metro. Para isto, o conjunto foi submetido a deslocamentos por trajetos limitados por elementos de fim de curso, posicionados observando-se a escala milim\u00e9trica da r\u00e9gua, cujo valor da divis\u00e3o \u00e9 de 1,0 mm. O erro de leitura combinado para os elementos posicionados no in\u00edcio e fim de curso foi estimado como sendo da ordem de \u00b11,0 mm. O valor apontado pela r\u00e9gua foi utilizado como padr\u00e3o de calibra\u00e7\u00e3o para o hod\u00f3metro, motivo pelo qual seu valor apontado \u00e9 aqui considerado como sendo verdadeiro.\nNesta avalia\u00e7\u00e3o foram considerados apenas os deslocamentos realizados e o n\u00famero obtido de pulsos do encoder do hod\u00f3metro. A tabela 6 exp\u00f5e\nas dist\u00e2ncias percorridas em cada itera\u00e7\u00e3o, assim como o n\u00famero de pulsos lidos. A m\u00e9dia da rela\u00e7\u00e3o obtida de pulsos por mil\u00edmetro foi de 10,2770, conforme dados da\ntabela 7.\nAp\u00f3s a calibra\u00e7\u00e3o do hod\u00f3metro, aplicou-se esta rela\u00e7\u00e3o no c\u00f3digo do m\u00f3dulo embarcado, conforme previsto no item 4.2.2.I. Com esta configura\u00e7\u00e3o de pulsos por mil\u00edmetro e com a leitura do hod\u00f3metro como parte do la\u00e7o principal de execu\u00e7\u00e3o do c\u00f3digo do m\u00f3dulo de monitora\u00e7\u00e3o, foram realizados testes para verificar o erro na medi\u00e7\u00e3o de deslocamento efetuada pelo SE em diferentes dist\u00e2ncias e dentro da velocidade especificada de opera\u00e7\u00e3o. Os valores obtidos est\u00e3o na tabela 8, onde se pode notar que o erro m\u00e1ximo dentro da velocidade de medi\u00e7\u00e3o especificada para o PEROLA-I (50 mm/s) foi de 0,2%. A resolu\u00e7\u00e3o axial para aquisi\u00e7\u00e3o de imagens definida foi de 1 mm.\nTabela 6 - Obten\u00e7\u00e3o de pulsos por deslocamento conhecido para calibra\u00e7\u00e3o do hod\u00f3metro (realizada com velocidade menor do que 20 mm/s).\nPulsos\tDeslocamento [mm]\tRela\u00e7\u00e3o [pulsos/mm]\n6166\t600,0 \u00b1 1,0\t10,277\n6167\t600,0 \u00b1 1,0\t10,278\n6169\t600,0 \u00b1 1,0\t10,282\n6166\t600,0 \u00b1 1,0\t10,277\n6163\t600,0 \u00b1 1,0\t10,272\nFonte: Autor.\nTabela 7 - Resultado da calibra\u00e7\u00e3o do hod\u00f3metro.\nItem\tPulsos/mm\nM\u00e9dia\t10,27700\nDesvio Padr\u00e3o\t0,00361\nFonte: Autor.\nTabela 8 - Medi\u00e7\u00e3o de outras dist\u00e2ncias com a rela\u00e7\u00e3o obtida na calibra\u00e7\u00e3o.\nPulsos\tDeslocamento [mm]\tRela\u00e7\u00e3o [pulsos/ mm]\tVelocidade [mm/s]\tDeslocamento calculado [mm]\tErro [mm]\tErro %\n4115\t400,0\t10,288\t40\t400,4\t0,4\t0,10\n4115\t400,0\t10,288\t50\t400,4\t0,4\t0,10\n5148\t500,0\t10,296\t50\t500,9\t0,9\t0,18\n10275\t1.000,0\t10,275\t50\t999,8\t-0,2\t-0,02\nFonte: Autor.\nTamb\u00e9m foram realizados testes similares sob velocidades acima dos limites de opera\u00e7\u00e3o prevista do perfil\u00f4metro. Seus resultados est\u00e3o na tabela 9, cujas linhas est\u00e3o ordenadas pelos valores de velocidade de cada teste.\nTabela 9 - Testes de medi\u00e7\u00e3o de deslocamento a diferentes velocidades.\nPulsos\tDesloca -mento [mm]\tRela\u00e7\u00e3o [pulsos/ mm]\tVelocidade [mm/s]\tDeslocamento calculado [mm]\tErro [mm]\tErro %\n6166\t600\t10,277\t60\t600\t0\t0\n4117\t400\t10,293\t80\t400,6\t0,6\t0,15\n5152\t500\t10,304\t83,3\t501,3\t1,3\t0,26\n6167\t600\t10,278\t86\t600,1\t0,1\t0,01\n10282\t1.000\t10,282\t100\t1000,5\t0,5\t0,05\n6169\t600\t10,282\t150\t600,3\t0,3\t0,05\n5151\t500\t10,302\t166,7\t501,2\t1,2\t0,24\n10279\t1.000\t10,279\t166,7\t1000,2\t0,2\t0,02\n6126\t600\t10,21\t171\t596,1\t-3,9\t-0,66\n6126\t600\t10,21\t171\t596,1\t-3,9\t-0,66\n5548\t600\t9,247\t200\t539,8\t-60,2\t-11,14\n6015\t600\t10,025\t200\t585,3\t-14,7\t-2,51\nFonte: Autor.\nNotam-se na tabela 9 valores de erro percentual fora dos limites de 0,2% para algumas entradas. Conforme estudo de carga apresentado no item 4.2.3, o maior erro nestes casos est\u00e1 associado \u00e0 sobrecarga no microcontrolador, o que pode ser percebido ao se atentar aos valores de pulsos obtidos nas entradas de maior erro. A poss\u00edvel ocorr\u00eancia de microvaria\u00e7\u00f5es de velocidade sofridas pelo dispositivo causa sobrecarga em fra\u00e7\u00f5es de segundo, levando a falhas de leitura. Isto evidencia a\nnecessidade de aumento da capacidade de processamento do microcontrolador utilizado e/ou a prioriza\u00e7\u00e3o da leitura de deslocamento atrav\u00e9s do mecanismo de interrup\u00e7\u00e3o, conforme alternativa de projeto colocada. Mesmo que a velocidade nominal de inspe\u00e7\u00e3o seja algum valor da ordem de grandeza de dezenas ou poucas centenas de mil\u00edmetros por segundo, o m\u00f3dulo de monitora\u00e7\u00e3o deve estar pronto para medir velocidades instant\u00e2neas substancialmente maiores.\nPor fim, para a avalia\u00e7\u00e3o da opera\u00e7\u00e3o geral deste sistema, foram realizados testes com o objetivo de se verificar falhas na entrega das imagens. Estes testes foram realizados com o uso da leitura do hod\u00f3metro priorizada pelo mecanismo de interrup\u00e7\u00e3o. Diferentes valores de resolu\u00e7\u00e3o axial foram utilizados. Alguns resultados obtidos est\u00e3o na tabela 10.\nTabela 10 - Testes de aquisi\u00e7\u00e3o de imagens a diferentes velocidades e\nresolu\u00e7\u00f5es.\nRes. axial [mm]\tDeslocamento [mm]\tVelocidade [mm/s]\t\tSec\u00e7\u00f5es\t\t\n\t\tNominal\tSegura\tAdqui -ridas\tPerdidas\tPerdidas (%)\n1\t1680,5\t20\t30,3\t1686\t0\t0\n1\t1668,6\t30\t37,3\t1674\t0\t0\n1\t1687,5\t30\t34,4\t1691\t2\t0,1\n1\t1667,6\t40\t44,4\t1669\t4\t0,2\n1\t1691,5\t40\t44\t1692\t5\t0,3\n1\t1626,6\t45\t47,7\t1623\t9\t0,6\n1\t1675,6\t50\t51,5\t1559\t122\t7,3\n1\t1679,6\t50\t51,2\t1591\t94\t5,6\n2\t1679,6\t40\t51,5\t843\t0\t0\n2\t1638,7\t90\t94,9\t822\t1\t0,1\n5\t1663,1\t100\t104,1\t333\t0\t0\n5\t1617,8\t150\t158,6\t324\t0\t0\n10\t1643,6\t150\t165,7\t165\t0\t0\nFonte: Autor.\nAs velocidades seguras 19 maiores do que as nominais corroboram a tese de que as falhas de medi\u00e7\u00e3o ocorrem por conta de\n19 Velocidade segura aqui representa o maior valor medido de velocidade instant\u00e2nea em que n\u00e3o h\u00e1 falhas de aquisi\u00e7\u00e3o em uma entrada da tabela. Quando n\u00e3o h\u00e1 falhas, a m\u00e1xima velocidade atingida durante aquele teste \u00e9 considerada como sendo a velocidade m\u00e1xima segura. Quando h\u00e1 falhas,\nmicrovaria\u00e7\u00f5es de velocidade. As maiores taxas de perdas de imagens, ou de aquisi\u00e7\u00e3o de sec\u00e7\u00f5es, ocorrem ao se aproximar da taxa de aquisi\u00e7\u00e3o de 50 imagens por segundo (divis\u00e3o do valor da coluna \u201cvelocidade nominal\u201d pelo valor da coluna \u201cres. axial\u201d). Em valores um pouco abaixo disto, as perdas mant\u00eam-se em valores baixos e aceit\u00e1veis. Isso pode ser causado por um poss\u00edvel atraso na execu\u00e7\u00e3o da tarefa de aquisi\u00e7\u00e3o do microcontrolador, dada a preemp\u00e7\u00e3o da leitura do hod\u00f3metro utilizada nestes testes. Apesar da degrada\u00e7\u00e3o da resposta ser relativamente baixa, nota-se a necessidade de ajuste na disponibiliza\u00e7\u00e3o de imagens, o que pode passar por otimiza\u00e7\u00e3o do c\u00f3digo embarcado, aumento da velocidade do processador ou mudan\u00e7a na estrat\u00e9gia de escalonamento de tarefas. Esta conclus\u00e3o de necessidade de melhoria vai ao encontro daquela conclu\u00edda analisando-se o teste anterior.\n6.2\tINSPE\u00c7\u00c3O EM BANCADA\nPara a avalia\u00e7\u00e3o em laborat\u00f3rio do desempenho das ferramentas desenvolvidas na opera\u00e7\u00e3o completa do perfil\u00f3metro, foram realizados ensaios de inspe\u00e7\u00e3o em bancada, a qual foi projetada com o objetivo de representar as condi\u00e7\u00f5es de opera\u00e7\u00e3o \u00e0s quais o PEROLA-I foi projetado para atender.\nA bancada utilizada possui um tubo de di\u00e2metro nominal de 152 mm (6\u201d) e comprimento de 2,6 m e permanece em posi\u00e7\u00e3o horizontal. O tubo foi projetado com o objetivo de representar tubos de fornos de refinaria fortemente expostos \u00e0 corros\u00e3o interna e com deformidades geom\u00e9tricas residuais do processo de soldagem. Acoplado ao suporte onde repousa o tubo h\u00e1 um motor el\u00e9trico, utilizado para deslocar o perfil\u00f3metro de forma controlada atrav\u00e9s de um cabo de a\u00e7o preso \u00e0s suas extremidades. Na figura 63 pode ser vista uma montagem do prot\u00f3tipo do perfil\u00f3metro. O esquem\u00e1tico da bancada pode ser visto na figura 64.\nsignifica que as mesmas ocorreram ap\u00f3s o sistema superar a velocidade apontada como sendo segura.\nFigura 63 - Um dos prot\u00f3tipos do PEROLA-I com o laser ligado.\nFonte: LABMETRO-UFSC.\nFigura 64 - Esquem\u00e1tico da bancada de testes do PEROLA-I. Tampa de acr\u00edlico transparente\nT,\t, Tampa metalica de\nPerfil\u00f4metro , ~\t.\ndefeitos artificiais\nel\u00e9trico\nFonte: LABMETRO-UFSC.\nO tubo conta com uma tampa remov\u00edvel, onde foram usinados artefatos simulando defeitos de geometria simples e conhecida, de modo a avaliar o desempenho do perfil\u00f4metro antes de utiliz\u00e1-lo numa situa\u00e7\u00e3o com corros\u00e3o real. H\u00e1 tamb\u00e9m uma tampa de acr\u00edlico utilizada para a visualiza\u00e7\u00e3o do perfil\u00f4metro no interior do tubo. Pr\u00f3ximo de uma das extremidades h\u00e1 uma junta soldada com excesso de deposi\u00e7\u00e3o de material. A figura 65 mostra a face interna da tampa remov\u00edvel. Podem-se perceber pela figura alv\u00e9olos circulares e vincos, al\u00e9m de um rebaixo incremental na forma de escada.\nFigura 65 - Vista interna da tampa com defeitos artificialmente produzidos.\nRebaixo\nAlv\u00e9olos\nVincos\nFonte: Autor.\nincremental\nForam realizadas inspe\u00e7\u00f5es do perfil geom\u00e9trico do tubo da bancada utilizando o prot\u00f3tipo do PEROLA-I. As imagens apresentadas no item 5.4 representam a reconstru\u00e7\u00e3o, pelo software de visualiza\u00e7\u00e3o, da geometria adquirida desta tampa e devem servir de compara\u00e7\u00e3o visual. J\u00e1 a figura 66 usa um mapa de cores personalizado escolhido para causar maior sensa\u00e7\u00e3o de realismo. Deve-se ressaltar que algumas das imagens citadas, como a figura 56, representam vistas externas da geometria interna adquirida. Tanto a figura 66 abaixo quanto a figura 58, no item 5.4.3, mostram a regi\u00e3o vista internamente.\nFigura 66 - A reconstru\u00e7\u00e3o, feita pelo SRV, da geometria interna adquirida da regi\u00e3o da tampa com defeitos artificialmente produzidos.\nFonte: Autor.\nNa figura 67 pode-se ver a junta soldada pr\u00f3xima \u00e0 extremidade do tubo da bancada e, na figura 68, a sua representa\u00e7\u00e3o pelo software de visualiza\u00e7\u00e3o, com o ponto de vista invertido (olhando para fora). Notase facilmente a correspond\u00eancia geom\u00e9trica entre a regi\u00e3o mensurada e sua representa\u00e7\u00e3o. Neste caso, novamente, o usu\u00e1rio personalizou o mapa de cores com objetivo de criar uma impress\u00e3o mais realista da cena.\nFigura 67 - Vista interna do tubo da bancada, com destaque ao cord\u00e3o de solda e \u00e0 tampa d\t\u201d 1\t\u2018\t\u2018\t1 p ido.\nCord\u00e3o de solda\nTampa de acr\u00edlico\nFonte: LABMETRO-UFSC.\nFigura 68 - Vista reconstru\u00edda pelo SRV do cord\u00e3o de solda e da tampa de acr\u00edlico inspecionados pelo perfil\u00f4metro. O ponto de vista desta cena \u00e9 oposto ao da fotografia da figura 67.\nFonte: Autor.\nAnalisando o detalhe do rebaixo incremental, pode-se perceber melhor o n\u00edvel de detalhes atingido. Na figura 68, retirada da especifica\u00e7\u00e3o t\u00e9cnica do tubo da bancada, o valor nominal do incremento a cada degrau do rebaixo \u00e9 de 0,5 mm. A figura 70 mostra a geometria interna do rebaixo adquirida pelo perfil\u00f4metro, com escala radial ampliada em quatro vezes e mapa de cores com amplitude normalizada para a regi\u00e3o em foco. Pelo mapa de cores aplicado, exibido na figura 70, \u00e9 poss\u00edvel notar que a diferen\u00e7a de raio a cada dois degraus \u00e9 pr\u00f3xima de 1 mm, condizente com a especifica\u00e7\u00e3o t\u00e9cnica. Assim \u00e9 poss\u00edvel notar a capacidade do sistema em exibir a geometria adquirida pelo perfil\u00f4metro com alto grau de detalhes e de forma confi\u00e1vel.\nComplementando a vis\u00e3o tridimensional da regi\u00e3o, a vis\u00e3o planificada oferece a sa\u00edda exibida na figura 71, na qual pode ser vista tamb\u00e9m a regi\u00e3o considerada como danificada a partir dos valores de entrada colocados.\nFigura 69 - Parte da geometria da tampa remov\u00edvel correspondente ao rebaixo com degraus.\nFonte: Autor.\nFigura 70 - Representa\u00e7\u00e3o da geometria do rebaixo vista pelo software de visualiza\u00e7\u00e3o.\nFonte: Autor.\nFigura 71 - Recortes da vista planificada da regi\u00e3o do rebaixo incremental.\n\t\tLimiar de defeito 11.00\tmm\tlegi\u00f5es\n\t80.24\tRa io interno\t176 30 \u201cH\tmm\t222-294:544-610\n\t\t\t\t230-240:553-593\n\t\tRaio externo\t184.50\tmm\t\n|6: 238,25\u00b0, Z = 533,52mm, R = 77,31mm|\t\u25a0 7: -7\t\t\t\n\t1\tAdiciona regi\u00e3o |\tRemove |\t\t\n\t\tMed. completa\tRecalcula\t\t\n\t\u25a0 78,69\t\t\t\n\t\tVol. depositado |0,00\tmm2\t\n1 564.5\t1 77.92\tVol. perdido\t|-310,93\tmm3\t\n\t\tEsp. minima\t\u00a142\tmm\t\n237 -557\n-593\nFonte: Autor.\n6.3\tINSPE\u00c7\u00c3O EM CAMPO\nO prot\u00f3tipo do PEROLA-I, ap\u00f3s sua valida\u00e7\u00e3o em laborat\u00f3rio, pode ser levado a campo para realiza\u00e7\u00e3o de ensaios em tubos met\u00e1licos de di\u00e2metro interno nominal de 152 mm (6\u201d). Estes tubos inspecionados foram fortemente danificados por corros\u00e3o interna durante opera\u00e7\u00e3o na explora\u00e7\u00e3o de g\u00e1s.\nPara a realiza\u00e7\u00e3o das inspe\u00e7\u00f5es, o prot\u00f3tipo foi puxado pelo mesmo sistema de tra\u00e7\u00e3o da bancada da figura 64.\nA figura 72 mostra internamente uma regi\u00e3o de sa\u00edda de um trecho de tubula\u00e7\u00e3o curvo. Uma vis\u00e3o do seu resultado de inspe\u00e7\u00e3o na figura 73 revela detalhes geom\u00e9tricos pouco percept\u00edveis a olho nu, ainda apresentando alto grau de realismo. A regi\u00e3o de tubo da figura 74 est\u00e1 presente num trecho curvo similar \u00e0quele da figura 72, por\u00e9m no lado de entrada. A representa\u00e7\u00e3o deste trecho inspecionado pelo perfil\u00f4metro \u00e9 apresentada na figura 75.\nA curva presente nestes trechos de tubula\u00e7\u00e3o faz com que o perfil de escoamento do fluido transportado se torne turbulento, acelerando o processo corrosivo. A inspe\u00e7\u00e3o destes trechos com o PEROLA-I permitiu a melhor visualiza\u00e7\u00e3o deste fen\u00f4meno pelo corpo t\u00e9cnico do CeNPES-PETROBRAS, local onde foram disponibilizados os tubos e realizadas as inspe\u00e7\u00f5es nos mesmos.\nFigura 72 - Vista interna de um trecho de tubula\u00e7\u00e3o de explora\u00e7\u00e3o de g\u00e1s fortemente exposto \u00e0 corros\u00e3o\nFonte: CENPES-PETROBRAS.\n\t\t\n\t\t\n\u2019\u2019ei* \u2019\t\u25a0\u00bb*\t\t\n1\tA '\u00ed\u00e2 ' . -\u25a0* '&lt;\t\u00a5 :*\u25a0 - \u00bf0 -j\u00e8T\t' .-41\t\nFigura 73 - Resultado de medi\u00e7\u00e3o de trecho de tubula\u00e7\u00e3o de g\u00e1s da figura 72,\ninspecionada pelo PEROLA-I e visualizada pelo seu SRV.\nFonte: Autor.\nFigura 74 - Trecho de tubula\u00e7\u00e3o de explora\u00e7\u00e3o de g\u00e1s severamente danificado, apresentando inclusive uma fenda.\nFonte: CENPES-PETROBRAS.\nFigura 75 - Reconstru\u00e7\u00e3o da geometria correspondente \u00e0 regi\u00e3o da figura 74.\nFonte: Autor.\n144\n7\tCONSIDERA\u00c7\u00d5ES FINAIS\nEste trabalho contribuiu com o desenvolvimento de uma solu\u00e7\u00e3o de perfilometria para o interior de tubos baseada no sensor \u00f3ptico a laser desenvolvido em (Buschinelli, 2007)\nOs elementos de hardware e software desenvolvidos foram capazes de aplicar com sucesso o sensor na inspe\u00e7\u00e3o da geometria interna de trechos retos de tubos met\u00e1licos sujeitos a avarias, aplica\u00e7\u00e3o para a qual o sistema foi concebido. A geometria adquirida pode ser facilmente lida, visualizada e interpretada, com alto grau de realismo, atrav\u00e9s do sistema de realidade virtual desenvolvido.\nA seguir s\u00e3o ressaltados alguns pontos positivos do trabalho desenvolvido. Posteriormente, cita-se o que j\u00e1 est\u00e1 sendo realizado para dar continuidade ao desenvolvimento da solu\u00e7\u00e3o de perfilometria. Em seguida s\u00e3o apresentadas sugest\u00f5es para a melhoria do trabalho desenvolvido.\n7.1\tASPECTOS POSITIVOS DO SISTEMA DESENVOLVIDO\nO sistema de aquisi\u00e7\u00e3o e disponibiliza\u00e7\u00e3o de imagens desenvolvido trouxe uma s\u00e9rie de contribui\u00e7\u00f5es que s\u00e3o analisadas na sequ\u00eancia:\n\u2022\tA l\u00f3gica do software embarcado permite que o perfil\u00f4metro seja deslocado no sentido inverso de opera\u00e7\u00e3o padr\u00e3o sem acionar o sensor. O perfil\u00f4metro deve retornar \u00e0 posi\u00e7\u00e3o de invers\u00e3o de movimento para voltar a realizar a aquisi\u00e7\u00e3o do perfil. Isto faz com que, mesmo sob eventuais invers\u00f5es de sentido do movimento, a mesma regi\u00e3o n\u00e3o seja adquirida duas vezes numa mesma aplica\u00e7\u00e3o do perfil\u00f4metro;\n\u2022\tO erro de quantiza\u00e7\u00e3o intr\u00ednseco aos transdutores digitais, no caso encoders \u00f3pticos, \u00e9 mitigado por um algoritmo no microcontrolador. Isto reduz a discrep\u00e2ncia que haveria entre o valor percorrido pelo perfil\u00f4metro e o n\u00famero correspondente de sec\u00e7\u00f5es adquiridas;\n\u2022\tO sistema desenvolvido apresenta boa modularidade, permitindo, por exemplo, a troca de modelos de encoders utilizados para a medi\u00e7\u00e3o de deslocamento axial e angular. Para isto deve-se apenas alterar par\u00e2metros no c\u00f3digo do sistema embarcado;\n\u2022\tOs valores de etiquetagem adquiridos pelo SE s\u00e3o tratados somente no PC, aliviando a carga no microcontrolador;\n\u2022\tTanto o sistema embarcado quanto a biblioteca de gerenciamento da c\u00e2mera foram feitos de forma a suportar v\u00e1rios modelos de c\u00e2meras dispon\u00edveis no mercado, o que permitir\u00e1 o uso de modelos com melhor resolu\u00e7\u00e3o e taxa de aquisi\u00e7\u00e3o no futuro;\n\u2022\tA biblioteca de gerenciamento da c\u00e2mera suporta o alto desempenho do m\u00f3dulo de processamento de imagens e oferece visualiza\u00e7\u00e3o ao vivo da imagem capturada.\nQuanto ao sistema de realidade virtual para visualiza\u00e7\u00e3o e an\u00e1lise de medi\u00e7\u00f5es, cabe evidenciar:\n\u2022\tO n\u00edvel de detalhes proporcionado pelo conjunto perfil\u00f4metro e sistema de visualiza\u00e7\u00e3o \u00e9 muito mais elevado do que o fornecido pelos m\u00e9todos tradicionais de inspe\u00e7\u00e3o. Por exemplo, em rela\u00e7\u00e3o ao pig palito apresentado no item 2.1.1, o PEROLA-I adquire um volume de dados mais de 50 vezes maior;\n\u2022\tOs meios de visualiza\u00e7\u00e3o e navega\u00e7\u00e3o oferecidos, baseados em t\u00e9cnicas de realidade virtual, s\u00e3o intuitivos e poderosos. Isto possibilita o uso do racioc\u00ednio visual do analista e segue a tend\u00eancia do uso de RV na ind\u00fastria de petr\u00f3leo e g\u00e1s;\n\u2022\tDiferentes m\u00e9todos de visualiza\u00e7\u00e3o estereosc\u00f3pica podem ser utilizados. S\u00e3o exemplos os monitores do tipo head-mounted display e monitores de alta frequ\u00eancia em conjunto com \u00f3culos ativos de cristal l\u00edquido.\n\u2022\tO uso de diferentes dispositivos de entrada \u00e9 suportado, em muitos casos n\u00e3o exigindo altera\u00e7\u00f5es ou novas configura\u00e7\u00f5es no SRV. S\u00e3o exemplos os diferentes tipos de gamepads, mouses 3D e smartphones.\n\u2022\tAo mesmo tempo em que inova, o sistema desenvolvido mant\u00e9m semelhan\u00e7a com m\u00e9todos disseminados na ind\u00fastria, de forma a diminuir o esfor\u00e7o de aprendizagem dos seus usu\u00e1rios;\n\u2022\tA an\u00e1lise e a interpreta\u00e7\u00e3o da nuvem de pontos adquirida pelo perfil\u00f4metro s\u00e3o potencializadas pela visualiza\u00e7\u00e3o de regi\u00f5es de interesse, tanto na representa\u00e7\u00e3o tridimensional quanto na planificada. Nestas regi\u00f5es podem ser aplicados m\u00e9todos de quantifica\u00e7\u00e3o de caracter\u00edsticas geom\u00e9tricas, como o c\u00e1lculo do\nvolume de material removido e espessura remanescente da parede do tubo;\n\u2022\tO sistema tamb\u00e9m permite monitorar a evolu\u00e7\u00e3o dos danos provocados por corros\u00e3o atrav\u00e9s da compara\u00e7\u00e3o visual do mesmo trecho medido em tempos diferentes;\n\u2022\tAs anota\u00e7\u00f5es indexadas por posi\u00e7\u00e3o permitem o registro de impress\u00f5es e posterior leitura por diferentes analistas. Combinados com a defini\u00e7\u00e3o de regi\u00f5es de interesse, o usu\u00e1rio do sistema disp\u00f5e de um bom suporte para a confec\u00e7\u00e3o de relat\u00f3rios sobre as inspe\u00e7\u00f5es geom\u00e9tricas realizadas pelo PEROLA-I ou pelo PEROLA-E.\nDesta forma obt\u00e9m-se uma valiosa ferramenta n\u00e3o s\u00f3 na inspe\u00e7\u00e3o do estado atual de integridade geom\u00e9trica dos tubos, mas tamb\u00e9m para uma an\u00e1lise fina da sua evolu\u00e7\u00e3o temporal, contribuindo com a seguran\u00e7a operacional de refinarias e outras instala\u00e7\u00f5es que envolvem tubula\u00e7\u00f5es expostas a corros\u00e3o interna.\n7.2\tMELHORIAS EM ANDAMENTO\nO desenvolvimento do PEROLA-I est\u00e1 inserido no escopo de um projeto que continua em andamento no momento da conclus\u00e3o desta disserta\u00e7\u00e3o. Ele est\u00e1 passando por atualiza\u00e7\u00f5es que incrementam sua funcionalidade. Dentre estas, est\u00e3o previstas a cria\u00e7\u00e3o de prot\u00f3tipos para aplica\u00e7\u00e3o em tubos de diferentes di\u00e2metros, para trechos com di\u00e2metro interno vari\u00e1vel, para trechos com curvas e para inspe\u00e7\u00f5es de tubos com eixo vertical. Estas novidades exigem que o sistema de aquisi\u00e7\u00e3o e disponibiliza\u00e7\u00e3o de imagens passe a realizar a medi\u00e7\u00e3o em trechos curvos e do posicionamento angular do perfil\u00f4metro em torno do seu pr\u00f3prio eixo na vertical. O hod\u00f4metro deve ser adaptado para uso em diferentes di\u00e2metros. Tamb\u00e9m est\u00e1 sendo levantada a possibilidade de uso de um hod\u00f4metro/inclin\u00f4metro \u00f3ptico.\nO formato de armazenamento das medi\u00e7\u00f5es est\u00e1 em processo de reformula\u00e7\u00e3o. A nova defini\u00e7\u00e3o utiliza padr\u00f5es como XML e PNG. Seu desenvolvimento est\u00e1 sendo realizado sob o crit\u00e9rio de extensibilidade. Assim, a defini\u00e7\u00e3o de novos valores a serem armazenados deve ser assimilada sem causar perda de compatibilidade em medi\u00e7\u00f5es antigas. Outro crit\u00e9rio de desenvolvimento \u00e9 a aplica\u00e7\u00e3o da biblioteca de armazenamento e carregamento em diferentes linguagens e plataformas,\nde modo a tornar o sistema de realidade virtual compat\u00edvel com inspe\u00e7\u00f5es realizadas por outros m\u00e9todos.\nEst\u00e1 em desenvolvimento, para o sistema de realidade virtual, um m\u00f3dulo de an\u00e1lise autom\u00e1tica de defeitos. Seus objetivos s\u00e3o encontrar, quantificar e classificar automaticamente as regi\u00f5es defeituosas presentes. Isto deve simplificar a tarefa de an\u00e1lise no caso de medi\u00e7\u00f5es muito longas, da ordem de 50 m ou mais.\nO SRV tamb\u00e9m suportar\u00e1 a abertura simult\u00e2nea de v\u00e1rios resultados de medi\u00e7\u00e3o, o que potencializa a compara\u00e7\u00e3o geom\u00e9trica entre as mesmas. Isto possibilitar\u00e1 o estudo da evolu\u00e7\u00e3o temporal da geometria dos trechos inspecionados.\nPara dar suporte \u00e0s novas funcionalidades de an\u00e1lise geom\u00e9trica, est\u00e1 em fase de estudo a constru\u00e7\u00e3o de um banco de dados que re\u00fana v\u00e1rias medi\u00e7\u00f5es de uma mesma instala\u00e7\u00e3o industrial de interesse. Este banco de dados permitir\u00e1 a minera\u00e7\u00e3o e compara\u00e7\u00e3o de dados de diferentes inspe\u00e7\u00f5es.\nEm rela\u00e7\u00e3o \u00e0s funcionalidades de visualiza\u00e7\u00e3o, est\u00e1 em fase de testes um m\u00f3dulo de reconstru\u00e7\u00e3o da geometria tridimensional utilizando a t\u00e9cnica de pixel shader, aproveitando-se das tecnologias mais recentes em hardware gr\u00e1fico para promover um grande aumento de realismo da cena e melhorar o desempenho do software.\nM\u00f3dulos de rede no paradigma cliente-servidor tamb\u00e9m est\u00e3o sendo desenvolvidos para o software de opera\u00e7\u00e3o do perfil\u00f4metro e para o sistema de visualiza\u00e7\u00e3o, com o objetivo de possibilitar a visualiza\u00e7\u00e3o do resultado inspecionado simultaneamente \u00e0 aplica\u00e7\u00e3o do perfil\u00f4metro.\nPor fim, est\u00e3o em desenvolvimento novos m\u00f3dulos que possibilitem o uso do SRV com diferentes perif\u00e9ricos de realidade virtual, como novos monitores estereosc\u00f3picos e c\u00e2meras de detec\u00e7\u00e3o de movimento.\n7.3\tSUGEST\u00d5ES DE MELHORIAS FUTURAS\nEmbora o sistema apresente diversos aspectos positivos, ainda h\u00e1 pontos que podem, e devem, ser melhorados. Dentre eles est\u00e3o:\n\u2022 O sistema de aquisi\u00e7\u00e3o e disponibiliza\u00e7\u00e3o de imagens requer um microcontrolador com maior capacidade de processamento. Al\u00e9m de reduzir o erro de medi\u00e7\u00e3o de deslocamento e falhas de aquisi\u00e7\u00e3o por picos de velocidade, isto permitiria o eventual uso de c\u00e2meras com maior taxa de aquisi\u00e7\u00e3o de imagens, melhorando a velocidade de inspe\u00e7\u00e3o do PEROLA-I.\n\n\nDeve haver otimiza\u00e7\u00e3o do software embarcado e mudan\u00e7a na estrat\u00e9gia de escalonamento de tarefas, de modo a melhorar o tratamento de erros. Isto \u00e9 necess\u00e1rio, pois, apenas a melhora do hardware n\u00e3o ser\u00e1 suficiente para eliminar falhas decorrentes do aumento da velocidade de inspe\u00e7\u00e3o.\nQuanto ao sistema de realidade virtual, as principais melhorias necess\u00e1rias est\u00e3o relacionadas \u00e0 usabilidade do sistema. Deve haver testes de ergonomia com usu\u00e1rios da ind\u00fastria e avalia\u00e7\u00f5es do sistema atrav\u00e9s de question\u00e1rios. O resultado destas avalia\u00e7\u00f5es pode influenciar na melhoria da interface e das capacidades do SRV, tornando-as mais simples ou mais elaboradas. \u00c9 importante tamb\u00e9m avaliar a impress\u00e3o causada pelas t\u00e9cnicas de realidade virtual, pois se considera que a mesma deve variar de usu\u00e1rio a usu\u00e1rio.\n150\nREFER\u00caNCIAS\nAMNELL, T. et al. Times - A Tool for Modelling and Implementation of Embedded Systems. In: Joint European Conferences on Theory and Practice of Software. Grenoble: Springer Verlag, 2002. p. 460-464.\nBACK, N. et al. Projeto Integrado de Produtos: planejamento, concep\u00e7\u00e3o e modelagem. S\u00e3o Paulo: Manole, 2008.\nBALZER, M. Institut f\u00fcr Prozessdatenverarbeitung und Elektronik IPE. 2011. Dispon\u00edvel em Karlsruher Institut f\u00fcr Technologie:&lt;http://www.ipe.kit.edu/157.php>. Acesso em 28 fev. 2012.\nBERGER, A. S. Embedded Systems Design. Lawrence, KS, EUA: CMP Books, 2002.\nBUBENIK, T. MFL Overview. In: In-Line Inspection Symposium. San Francisco, CA, EUA, 2011. p. 32-57.\nBUSCHINELLI, P. D. A GPU based real time image processing for an axis symmetrical optical laser triangulation system. In: SPIE Optics + Photonics. San Diego, CA, EUA, 2012.\nBUSCHINELLI, P. D. Desenvolvimento de um sistema \u00f3ptico por triangula\u00e7\u00e3o c\u00f4nica para inspe\u00e7\u00e3o do perfil interno de dutos. Disserta\u00e7\u00e3o (Mestrado em Metrologia Cient\u00edfica e Industrial) -Universidade Federal de Santa Catarina, Florian\u00f3polis, 2007. 153 p. [Orientador: Armando Albertazzi Gon\u00e7alves Junior].\nBUSCHINELLI, P. D. et al. Perfilometria \u00f3ptica de dutos sujeitos \u00e0 corros\u00e3o: princ\u00edpios e recentes progressos. In: INTERCORR. Salvador, 2012. p. 1-12.\nCIMINO, R. 2004. Transporte aerovi\u00e1rio, aquavi\u00e1rio e dutovi\u00e1rio. Dispon\u00edvel\tem\tEngeharia\tCompartilhada:\n<http://www.engenhariacompartilhada.com.br/Secoes.Aspx?Capitulo=3 6054>. Acesso em 1\u00b0 ar. 2012.\nECLIPSE FOUNDATION. Eclipse Modeling Project. Dispon\u00edvel em Eclipse Foundation:&lt;http://www.eclipse.org/modeling/> Acesso em 1 jul. 2011.\nFARINES, J.-M., FRAGA, J. d. &amp; OLIVEIRA, R. S. Sistemas de Tempo Real. Florian\u00f3polis: Universidade Federal de Santa Catarina,\n2000.\nFEILER, P., GLUCH, D., &amp; HUDAK, J. The Architecture Analysis &amp; Design Language AADL: An Introduction. Pittsburgh: Software Engineering Institute, Carnegie Mellon University, 2006.\nFOLEY, J. D. Computer Graphics: Principles and Practice. Nova Iorque, NY, EUA: Addison-Wesley Professional, 1996.\nFRANZOI et al, A. R. Compara\u00e7\u00e3o do resultado de 3 t\u00e9cnicas de inspe\u00e7\u00e3o com pigs instrumentados em um mesmo oleoduto da Bacia de Campos. In: Rio Pipeline 2005. Rio de Janeiro, 2005.\nHAERTEL, M. E. Perfil\u00f4metro \u00d3ptico Externo para Dutos Expostos \u00e0 Corros\u00e3o. Disserta\u00e7\u00e3o (Mestrado em Metrologia Cient\u00edfica e Industrial) - Universidade Federal de Santa Catarina, Florian\u00f3polis, 2007. 79p. [Orientador: Armando Albertazzi Gon\u00e7alves Junior].\nHAERTEL, M. E. et al. Development of an optical system for geometric inspection of external surface of pipelines. In: SPIE Optics + Photonics. San Diego, California, EUA, 2012.\nHALLIDAY. F\u00edsica 3. 5 ed. Rio de Janeiro: LTC, 2004.\nHANCOCK, D. Viewpoint: Virtual Reality in search of middle ground. In: IEEE Spectrum, vol. 32, ed. 1, jan. 1995. p. 68.\nHAUSE, M. The SysML Modelling Language. In: Fifth European Systems Engineering Conference. Cheltenham, Reino Unido: Incose, 2006.\nHILLS, K. Digital Sensations: Space, Identity, And Embodiment In Virtual Reality. Minneapolis, MN, EUA: University of Minnesota Press, 1999.\nKHRONOS GROUP. Khronos Contributing Members. Dispon\u00edvel em\tKhronos\tGroup\tWebsite:\n<http://www.khronos.org/members/contributors>. Acesso em 25 jun. 2012.\nKOOPMAN, P. Embedded Systems Design Issues: The Rest of the Story. In: Proc. Internat. Conf. Comput. Design. Austin, TX: IEEE Computer Society Press, 1996. p. 310-317.\nLAMEF/UFRGS. Sistemas autom\u00e1ticos de inspe\u00e7\u00e3o UFRGS -LAMEF. Porto Alegre, 2011. CD-ROM.\nLEACH, G. Graphics Pipeline. Dispon\u00edvel em Interactive 3D Graphics and\tAnimation:\n<http://goanna.cs.rmit.edu.au/~gl/teaching/Interactive3D/2012/lecture2. html>. Acesso em 6 jan. 2012.\nLIU, C. L., &amp; LAYLAND, J. W. Scheduling algorithms for multiprogramming in a hard real-time environment. In: Journal of the Association for Computing Machinery, vol. 20. Jan. 1973. pp. 46-61.\nMANSSOUR, I. H. &amp; COHEN, M. OpenGL: Uma abordagem pr\u00e1tica e objetiva. S\u00e3o Paulo: Novatec, 2006.\nMELO, J. R. Sistema de aquisi\u00e7\u00e3o de imagens indexadas para uso em perfil\u00f4metro \u00f3ptico. Monografia (Curso de Engenharia de Controle e Automa\u00e7\u00e3o) - Universidade Federeal de Santa Catarina. Florian\u00f3polis, SC, Brasil. 2009. 87p.\nMET\u00c1LICA. Tubula\u00e7\u00e3o Industrial. Dispon\u00edvel em Portal Met\u00e1lica:&lt;http://www.metalica.com.br/tubulacao-industrial/>. 1999. Acesso em 1 mar. 2012.\nMICROCHIP. PIC16F688 Data Sheet. EUA: Microchip Technology, 2004.\nMICROSOFT CORPORATION. DirectX Graphics and Gaming Windows. 2012. Dispon\u00edvel em Microsoft Developer Network:&lt;http://msdn.microsoft.com/en-us/library/hh769064v=vs.85>. Acesso em 16 jul 2012.\nM\u00dcLLERBURG, M. Software intensive embedded systems. In: Information and Software Technology, 5 nov. 1999. p. 979-984.\nNATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY.\nAnnouncing the Standard for Integration Definition for Function Modeling IDEF0. Springfield, Virginia, EUA: Federal Information Processing Standards Publication, 1993.\nNESTLEROTH, B. Nondestructive Pipeline Inspection Using Pigs. In: In-Line Inspection Symposium. San Francisco, CA, EUA, 2011. p. 2-31.\nNVIDIA CORPORATION. Quadro Quad Buffered Professional Stereo Technology.\t2012. Dispon\u00edvel em&lt;Nvidia:\nhttp://www.nvidia.com/obiect/quadro stereo technology.html>. Acesso em 29 set. 2012.\nOLIVEIRA, C. H., &amp; CAMERINI, C. S. Pig instrumentado da Petrobras - Resultados e perspectivas. In: Confer\u00eancia sobre tecnologia de equipamentos. Salvador, 2002. p. 1-11.\nOSHANA, R. DSP Software Development Techniques for Embedded and Real-Time Systems. Burlington, MA, EUA: Elsevier, 2006.\nPOINTGREY RESEARCH. PGR Scorpion Technical Reference Manual. EUA: PointGrey Research, 2004.\nRANGEL, F. Investimentos aos tubos. Portos e Navios, Ind\u00fastria Naval, ed. 598, nov. 2010, p. 16-21.\nRIBEIRO, A. C. Curso de tubula\u00e7\u00f5es industriais: Aula 1. Faculdade de Engenharia Qu\u00edmica de Lorena, Universidade Federal do Paran\u00e1. Dispon\u00edvel em:&lt;ftp://ftp.demec.ufpr.br/disciplinas/TM141/aula01.pdf>. Lorena - PR, 2007.\nRUSSO, E. E. et al. A Realidade Virtual na Ind\u00fastria de explora\u00e7\u00e3o e Produ\u00e7\u00e3o de Petr\u00f3leo. In: Realidade Virtual: Conceitos e Tend\u00eancias. S\u00e3o Paulo: Mania de Livro, 2004. p. 283-288.\nSHREINER, D. OpenGL programming guide: the official guide to learning OpenGL, versions 3.0 and 3.1. Boston, MA, EUA: Pearson Education, 2009.\nSILVA, R. P. Como modelar com UML 2. Florian\u00f3polis: Visual Books, 2009.\nSOARES, L. P., &amp; SANTOS, I. H. EnViron: Uma ferramenta de realidade virtual para projetos de engenharia. In: XXIX Iberian Latin American Congress on Computational Methods in Engineering. Nov. 2008.\nSTROHAECKER, T. RCA - Grupo de Rob\u00f3tica, Controle e Automa\u00e7\u00e3o. 2010. Dispon\u00edvel em Laborat\u00f3rio de Metalurgia F\u00edsica:&lt;http://www.lamef.demet.ufrgs.br/rca.html#1>. Acesso em 15 mar. 2012.\nWILMSHURST, T. An Introduction to the Design of Small-Scale Embedded Systems. Derby, Inglaterra: Palgrave, 2001.\nWILMSHURST, T. Designing embedded systems with PIC microcontrollers: principles and applications. Oxford, Inglaterra: Elsevier, 2007.\nWOLF, W. H. Hardware-Software Co-Design of Embedded Systems. In: Proceedings of the IEEE, Vol 82, N\u00b0 7, 1994. p. 967-989.\n156\nAP\u00caNDICE A - CONCEITOS B\u00c1SICOS DE AADL UTILIZADOS\nAADL \u00e9 uma linguagem para descri\u00e7\u00e3o, projeto gr\u00e1fico e an\u00e1lise de sistemas em termos de componentes e suas intera\u00e7\u00f5es. Inclui abstra\u00e7\u00f5es de software, hardware computacional e componentes para especifica\u00e7\u00e3o e an\u00e1lise de sistemas embarcados de tempo real e mapeamento de software em elementos de hardware (Feiler, Gluch, &amp; Hudak, 2006).\nEntre os elementos definidos na linguagem, a seguir s\u00e3o apresentados aqueles presentes em diagramas neste trabalho.\n\u2022\tSistema. Elemento composto de outros sistemas, hardware e software. Possui descri\u00e7\u00e3o interna.\n\u2022\tDispositivo. Elemento de hardware que representa sensores, atuadores ou componentes que interagem com o ambiente.\n\u2022\tProcessador. Utilizado para escalonar e executar programas e threads. Componentes de software devem ter um processador associado.\n\u2022\tPorta de dados. Utilizada para leitura do estado de uma informa\u00e7\u00e3o.\n\u2022\tPorta de evento. Utilizada para encaminhamento de um evento ass\u00edncrono.\n\u2022\tPorta de dados e evento. Utilizada quando a mudan\u00e7a de estado de uma informa\u00e7\u00e3o \u00e9 vista como um evento.\nOs elementos gr\u00e1ficos correspondentes aos descritos acima s\u00e3o apresentados na figura abaixo, com seus identificadores nomeados em refer\u00eancia aos seus tipos.\nSistema\tProcessador\tDispositivo\nevento&lt;/\nevento\ndados_evento\ndados\ndados\ndados_evento"}]}}}