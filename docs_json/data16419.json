{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.20211"}, {"@name": "filename", "#text": "3668_176596.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE FEDERAL DE SANTA CATARINA \n\nCURSO DE P\u00d3S-GRADUA\u00c7\u00c3O EM ENGENHARIA MEC\u00c2NICA\n\nM\u00e9todos de KryJov-Newton Aplicados \u00e0 Simula\u00e7\u00e3o Num\u00e9rica de\nReservat\u00f3rios de Petr\u00f3leo\n\nDISSERTA\u00c7\u00c3O SUBMETIDA \u00c0 UNIVERSIDADE FEDERAL DE SANTA CATARINA \n\nPARA OBTEN\u00c7\u00c3O DO GRAU DE MESTRE EM ENGENHARIA\n\nRODRIGO MACHADO LUCIANETTI\n\n'FLORIAN\u00d3POLIS, SETEMBRO DE .2000\n\n\n\nM\u00c9TODOS DE KRYLOV-NEWTON APLICADOS \u00c0 SIMULA\u00c7\u00c3O NUM\u00c9RICA DE \nRESERVAT\u00d3RIOS DE PETR\u00d3LEO\n\nRODRIGO MACHADO LUCIANETTi\n\nESTA DISSERTA\u00c7\u00c3O FOI JULGADA ADEQUADA PARA A OBTEN\u00c7\u00c3O DO T\u00cdTULO DE MESTRE \nEM ENGENHARIA ESPECIALIDADE ENGENHARIA MEC\u00c2NICA, \u00c1REA DE CONCENTRA\u00c7\u00c3O \nENGENHARIA E CI\u00caNCIAS T\u00c9RMICAS, APROVADA EM SUA FORMA FINAL PELO CURSO DE \nP\u00d3S-GRADUA\u00c7\u00c3O EM ENGENHARIA MEC\u00c2NICA.\n\n4\nProf. J\u00daLIO C\u00c9SAR PASSOS, Or. Eng. Mec. \n\nCOORDENADOR DO CURSO DE P\u00d3S-GRADUA\u00c7\u00c3O\n\nBANCA EXAMINADORA\n\nProf. ANT\u00d4NIO f \u00c1b JO CARVALHO DA SILVA, Dr. Eng. Mec.\n\nProf. J\u00c1UBER CAVALCAtSITE OLIVEIRA. Ph.D.\n\nProf. iMARI\u00d3^CESAR ZAMBALDI, Dr.\n\n\n\nAos meus pais, Vera L\u00facia e Paulino, aos meus sogros, Maria da Gl\u00f3ria e Roberto, e\n\nespecialmente a  minha esposa Francini.\n\n\\\n\n\n\nAGRADECIMENTOS\n\nAo meu orientador e amigo Prof. Clovis R. Mal\u00edska peios conhecimentos transmitidos, \n\npeia confian\u00e7a em mim depositada e, acima de tudo, pelo seu exemplo de motiva\u00e7\u00e3o e amor \n\npela ci\u00eancia, que influenciaram minha decis\u00e3o de trilhar o mesmo caminho.\n\nAo meu grande amigo Alexandre de O. Czesnat pelas valiosas discuss\u00f5es e in\u00fameras \n\ncontribui\u00e7\u00f5es ao trabalho.\n\nAo amigo Clovis Maliska Jr, pela motiva\u00e7\u00e3o e imprescind\u00edvel suporte na programa\u00e7\u00e3o \n\ndo simulador por mim utilizado neste trabalho.\n\nAo amigo Axel Dihlman pelo est\u00edmulo constante e pelo prazer de durante este trabalho \n\npoder contar com a sua companhia.\n\nAos demais colegas do SINMEC pelo excelente ambiente de trabalho proporcionado.\n\nA ESSS que, conciente da import\u00e2ncia da forma\u00e7\u00e3o acad\u00eamica, me proporcionou o \n\ntempo e os recursos necess\u00e1rios para tenninar este trabalho.\n\nAos contribuintes brasileiros que, atrav\u00e9s do CNPq, financiaram este trabalho.\n\nA todos os meus professores do curso de P\u00f3s-Gradua\u00e7\u00e3o do Depto. de Engenharia \n\nMec\u00e2nica da UFSC.\n\n\n\nSUM\u00c1RIO\n\nI  INTRODU\u00c7\u00c3O___________________________________________________________ 1\n\n1.1 PRELIMINARES 1\n1 .2  R e v i s \u00e3 o  B i b l i o g r \u00e1 f i c a  4\n1.3 O b j e t i v o s  e  C o n t r i b u i \u00e7 \u00f5 e s  9\n1.4 E s c o p o  d o  T r a b a l h o  10\n\n2  FORMULA\u00c7\u00c3O MATEM\u00c1TICA____________________________________________ 11\n\n2.1 L e i  d e  C o n s e r v a \u00e7 \u00e3 o  d a  M a s s a  11\n2.2 F o r m u l a \u00e7 \u00e3 o  e m  F r a \u00e7 \u00f5 e s  M \u00e1 s s ic a s  G l o b a is  13\n2.3 L E ID E  DARCY 14\n2.4 M o d e l o  B l a c k -Oi l  P a d r \u00e3 o  15\n2.5 C o n d i \u00e7 \u00f5 e s  d e  C o n t o r n o  e  I n i c i a i s  19\n\n3 FORMULA\u00c7\u00c3O NUM\u00c9RICA_______________________________________________21\n\n3.1 T r a n s f o r m a \u00e7 \u00e3 o  d a s  E q u a \u00e7 \u00f5 e s  G o v e r n a n t e s  p a r a  o  S i s t e m a  C o o r d e n a d o  \nC u r v i l \u00ed n e o  21\n3.2 D isc R E T iz A \u00e7 \u00c3 o  d a s  E q u a \u00e7 \u00f5 e s  G o v e r n a n t e s  23\n3.3 S i s t e m a  d e  E q u a \u00e7 \u00f5 e s  N \u00e3 o - L i n e a r e s  27\n\n4 M\u00c9TODOS DE SOLU\u00c7\u00c3O DE SISTEMAS DE EQUA\u00c7\u00d5ES N\u00c3O-LINEARES________ 29\n\n4.1 V i s \u00e3 o  G e r a l  d o  P r o b l e m a  29\n4.2 M \u00e9 t o d o s  d e  N e w t o n  31\n4.2.1 O Conceito d e Lineariza\u00e7\u00e3o 32\n4.2.2 F orma Geral d o s M \u00e9todos d e  N ewton 33\n4.2.3 M\u00e9todos de N ew ton Inexatos 33\n4.2.4 M\u00c9TODOS DE KRYLOV-NEWTON 38\n4.2.5 MONTAGEM DA Matriz Ja c o bian a 41\n\n5 M\u00c9TODOS DE KRYLOV-NEWTON APLICADOS \u00c0 SOLU\u00c7\u00c3O DAS- EQUA\u00c7\u00d5ES DO \nMODELO BLACK-OIL PADR\u00c3O_______________________________________________ 43\n\n5.1 L i n e a r i z a \u00e7 \u00e3 o  d a s  E q u a \u00e7 \u00f5 e s  D i s c r e t i z a d a s  43\n5.2 O s  m \u00e9 t o d o s  d e  K r y l o v -N e w t o n  48\n5.3 C o n t r o l e  A u t o m \u00e1 t i c o  d o  P a s s o  d e  T e m p o  51\n5.4 O u t r o s  D e t a l h e s  R e l a t i v o s  \u00e0  I m p l e m e n t a \u00e7 \u00e3 o  53\n\n6  RESULTADOS E DISCUSS\u00d5ES_____________________________________________ 55\n\n6.1 V a l i d a \u00e7 \u00e3 o  d a  I m p l e m e n t a \u00e7 \u00e3 o  55\n6.2 P a r a l e l e p \u00ed p e d o  D e f o r m a d o  59\n6.2.1 Ba c k t r a c k in g  e  f o r c in g  te rm s 63\n6.2.2 S o l v e r s f. P r e c o n d ic io n  a d o r e s  74\n\n\n\n6.2.3 Avalia\u00e7\u00e3o d o s m\u00e9todos de Kr ylov-New ton 79\n6.3 R e s e r v a t \u00f3 r i o  R e a l  8 6\n\n7 CONCLUS\u00d5ES E RECOMENDA\u00c7\u00d5ES_______________________________________ 89\n\n7.1 C o n c l u s \u00f5 e s  89\n7.2 RECOMENDA\u00c7\u00d5ES 91\n\nAP\u00caNDICE A - AVALIA\u00c7\u00c3O DAS DERIVADAS DOS POTENCIAIS__________________ 93\n\nREFER\u00caNCIAS BIBLIOGR\u00c1FICAS 95\n\n\n\nRESUMO\n\nA simula\u00e7\u00e3o do processo de extra\u00e7\u00e3o de \u00f3leo em um reservat\u00f3rio de petr\u00f3leo \u00e9 um \n\nproblema complexo que envolve o escoamento multif\u00e1sico em um meio poroso de geometria \n\narbitr\u00e1ria, podendo conter falhas geol\u00f3gicas e outras irregularidades. A modelagem num\u00e9rica \n\nimpl\u00edcita deste problema requer a solu\u00e7\u00e3o de um complexo sistema de equa\u00e7\u00f5es n\u00e3o-lineares \n\nque pode ser resolvido de diversas formas, mais ou menos eficientes. A forma mais comum de \n\nsolu\u00e7\u00e3o deste sistema emprega o m\u00e9todo de lineariza\u00e7\u00e3o de Newton ou alguma de suas \n\nvariantes.\n\nO foco deste trabalho est\u00e1 na an\u00e1lise de uma extensa classe de m\u00e9todos de Newton \n\nconhecidos como m\u00e9todos de Newton inexatos. Estes m\u00e9todos empregam um segundo m\u00e9todo \n\niterativo na solu\u00e7\u00e3o da equa\u00e7\u00e3o linearizada resolvendo-a at\u00e9 uma certa toler\u00e2ncia; da\u00ed serem \n\nchamados de inexatos. Os m\u00e9todos inexatos abordados neste trabalho concentram-se na \n\nescolha de processos iterativos baseados em m\u00e9todos de proje\u00e7\u00e3o no espa\u00e7o de Krylov, tais \n\ncomo: GMRES, BICGSTAB, TFQMR. Estes m\u00e9todos, que formam uma subclasse dos \n\nm\u00e9todos de Newton inexatos, s\u00e3o conhecidos como m\u00e9todos de Krylov-Newton. S\u00e3o \n\nabordados tamb\u00e9m m\u00e9todos quase-newtonianos baseados na aproxima\u00e7\u00e3o da matriz Jacobiana \n\nconsiderando apenas os termos ortogonais da discretiza\u00e7\u00e3o em sistemas curvil\u00edneos n\u00e3o- \n\nortogonais.\n\nV\u00e1rios problemas com diferentes graus de n\u00e3o-ortogonalidade da malha e n\u00e3o- \n\nlinearidades s\u00e3o resolvidos e comparados usando os diferentes m\u00e9todos implementados.\n\n\n\nABSTRACT\n\nThe petroleum reservoir simulation involves multiphase flows in porous media with a \n\ncomplex geometry, containing geological faults mid other irregularities. The implicit solution \n\no f the problem requires the simultaneous solution o f a large number o f complex non-linear \n\nequations. This system of non-linear equations can be solved by several methods with \n\ndifferent performances. The standard way employs some linearization method o f Newton \n\nforai.\n\nThis work concentrates in the analysis of a set o f Newton form\u2019s methods called inexact \n\nNewton methods. These methods employ a secondary linear iterative process to  find the \n\nsolution to the linearized equation. The methods are called inexact because the convergence \n\ncriterion for the solution o f the linearized equation can be fairly relaxed, while the criterion for \n\nthe convergence o f the overall scheme to find the solution to  the problem is still reasonably \n\ntight. The inexact methods used in this work apply Krylov solvers as the inner iterative \n\nprocess. These methods are usually called Krylov-Newton methods. Other two schemes based \n\non the approximation o f the Jacobian matrix are also introduced. This approximation is built \n\nconsidering only the orthogonal terms in a generalized discretization technique.\n\nSeveral cases, with different levels of non-orthogonality and non-linearity, are solved \n\nand compared using all implemented Newton-like methods.\n\n\n\nIX\n\nLISTA DE FIGURAS\n\nFigura 2.1 -  Fluxos de massa atrav\u00e9s do volume de controle_______________________________________ 11\n\nFigura 3 .1 -  Dom\u00ednio f\u00edsico e transformado____________________________________________________  21\n\nFigura 3.2 \u2014 Volume de controle elementar no espa\u00e7o transformado_________________________________ 24\n\nFigura 3.3 -  Volumes presentes no esquema num\u00e9rico _________________________________________25\n\nFigura 5.1 -  Matriz de 19 diagonais {Ex.: malha 4x4x3)___________________________________________ 44\n\nFigura 5.2 Matriz, de 7 diagonais (Ex.: malha 4x4x3)____________________________________________ 50\n\nFigura 6.1 -  Distribui\u00e7\u00e3o e configura\u00e7\u00e3o dos p o\u00e7os_________________________________________ . 56\n\nFigura 6.2 -  Malha utilizada para o caso dos 3 po\u00e7os (24x10)______________________________________  56\n\nFigura 6.3 -  Gi\u00e1fico do corte de \u00e1gua nos po\u00e7os produtores________________________________________ 58\n\nFigura 6.4 - Geometria e malha utilizadas nos testes______________________________________________ 59\n\nFigura 6.5 -  a  \u2014 45\u00b0 e n  \u2014 2,0. sem backtracking (19 diag., GMRES(25). B1L-U 0 ) ___________________ 65\n\nFigura 6.6 - a \u2014 45\u00b0 e  n  \u2014 2,0, sem backtracking (19 diag., GMRES(25), BILU 0 ) ___________________ 66\n\nFigura 6.7 -  V P I =  1,5, a  =  45\u00b0 e n  = 2,0, sem backtracking (19 diag., GMRES(25), BILU 0 ) _________ 66\n\nFigura 6.8 \u2014 V P I =  0,2, a  =  4 5 \u00b0 e n  =  2,0, sem backtracking (19 diag., GMRES(25), BILU 0 ) _________ 67\n\nFigura 6.9 -  influ\u00eancia da n\u00e3o-ortogonalidade nos m\u00e9todos de Kiylov-Newton para n  =  2.0______________  82\n\nFigura 6.10 -  Influ\u00eancia da n\u00e3o-linearidade nos m\u00e9todos de Kiylov-Newton para a  = 4 5 \u00b0 _______________ 83\n\nFigura 6.11 -  V P I \u2014 0,2 para a  =  45\u00b0 e n  =  2 ,0 ______________________________________________  84\n\nFigura6.12- V PI =  1,0para (X =  45\u00b0 e n  =  2 ,0 _____________________________________ _________ 85\n\nFigura 6.13 -  V P I =  1,5 para a  =  45\u00b0 e n  =  2 ,0 ______________________________________________  85\n\nFigura 6.14 Malha 10x10x4 (\u00a3,. 1). y ) c  disposi\u00e7\u00e3o dos po\u00e7os___________________________________  86\n\n\n\nX\n\nLISTA DE TABELAS\n\nTabela 6.1 -  Dados do problema dos 3 po\u00e7os _ _ _ _ _ _ _________________________________________ 56\n\nTateia 6.2 Permeabilidade relativa do problema dos 3 p o\u00e7os_____________________________________  57\n\nTabela 6.3 -  Dados do modelo f\u00edsico (Paralelep\u00edpedos Deformados)___________________________ ______60\n\nTabela 6.4 -  Dados do modelo num\u00e9rico (Paralelep\u00edpedos Deformados)______________________________ 62\n\nTabela 6.5 -  a  \u2014 4 5 \u00b0 . com backtracking e m\u00e9todo 1 (19 diag., GMRES(25), BILU 0 ) _________________ 63\n\nTabela 6.6 -  a  \u2014 4 5  \u00b0 , sem backtracking e m\u00e9todo 1 (19 diag., GMKES(25). BILU 0)__________________ 63\n\nTabela 6.7 \u2014 a  =  6 0 \u00b0 , sem backtracking (19 diag., GMRES(25), BILU 0 ) ___________________________ 68\n\nTabela 6.8 -  a  \u2014 4 5 \u00b0 , sem backtracking (19 diag., GMRES(25), BILU 0 ) ___________________________ 69\n\nTabela 6.9 - C l  \u2014 3 0 \u00b0 , sem backtracking (19 diag., GMRES(25), BILU 0 ) ___________________________  70\n\nTabela 6.10 \u2014 a  =  9 0 \u00b0 , sem backtracking (7 diag., GMRES(25), BILU 1 ) ___________________________  71\n\nTabela 6.11 -  a  =  4 5 \u00b0 , sem backtracking (7 diag., GMRES(25), BILU 1)___________________________ 72\n\nTabela 6.12 \u2014 a  =  3 0 \u00b0 , sem backtracking (7 diag., GMRES(25), BILU 1)___________________________ 72\n\nTabela 6.13 -  (X \u2014 6 0 \u00b0 , sem backtracking (Matrix-free, GMRES(25), BILU 2 ) _______________________ 72\n\nTabela 6.14\u2014 a  =  4 5 \u00b0 , sem backtracking (Matrix-free, GMRES(25). BILU 2 ) _______________________ 73\n\nTabela 6.15 \u2014 OC \u2014 3 0 \u00b0 , sem backtracking (Matrix-free, GMRES(25), BILU 2 ) _______________________ 74\n\nTabela 6.16 -  a  =  4 5 \u00b0 e  n  = 1,5 (19 diag.)___________________________________________________  75\n\nTabela 6.17 -  t t  =  45\u00b0 e n  \u20142,0 (19 diag.)___________________________________________________  76\n\nTabela6.18- a  -  4 5 \u00b0 e n  =  1 ,5 (7 diag.)____________________________________________________ 76\n\nTabela 6.19 - a  4 5 \u00b0 e n  =  2,0 (7 diag.)____________________________________________ ________ 77\n\nTabela 6.20 -  a  =  45\u00b0 e n  =  1,5 (Matrix-free)________________________________________________  77\n\nTabela 6.21 -  a  =  4 5 \u00b0 e  n  = 2 ,0  (Matrix-free) ________________________________________________  78\n\nTabela 6.22\u2014Mem\u00f3ria consumida pelos precondicionadorcs (em Kbytes) em fun\u00e7\u00e3o da estrutura da matriz\n\nJacobiana ______________________________________________________________ _ 78\n\nTabela 6.23 -  Distribui\u00e7\u00e3o do tempo de processamento do problema linear em % do tempo total de CPU\n\n(GMRES, a  =  4 5 \u00b0 e n  =  1,5)______________________________________________________________79\n\nTabela 6.24 -  Par\u00e2metros num\u00e9ricos usados em cada m\u00e9todo de Krylov-Newton_______________________ 80\n\nTabela 6.25 -  Compara\u00e7\u00e3o entre os m\u00e9todos de Krylov-Newton para v\u00e1rios valores de (X e n  ___________ 80\n\nTabela 6.26 -  Raz\u00e3o CPU7 / CPU19___________________________________________________________ 83\n\nTabela 6.27 -  Raz\u00e3o CPU7 /  CPU\u21221___________________________________________________________ 83\n\nTabela 6.28 -  Raz\u00e3o CPU\"1/ CPU19________ _________________________________________________ 84\n\nTabela 6.29 -  Par\u00e2metros num\u00e9ricos usados em cada m\u00e9todo de Krylov-Newton_______________________ 87\n\nTabela 6.30 -  Compara\u00e7\u00e3o entre os m\u00e9todos de Krylov-Newton na simula\u00e7\u00e3o de um reservat\u00f3rio real______ 87\n\nTabela 6.31 -R az\u00e3o entre tempos de CPU_____________________________________________________ 88\n\n\n\nSIMBOLOGIA\n/ 2\n\nA Area transversal [m ]\n\nA Matriz da equa\u00e7\u00e3o linear\n\nBp Fator volume de forma\u00e7\u00e3o da fase p [m3/m3]\n\ncp Compressibilidade da fase p [P a 1]\n\nD Profundidade [m]\n\nX)cp Coeficiente efetivo de dispers\u00e3o do componente c na fase p\n\n[m2/s]\n\nF Fun\u00e7\u00e3o res\u00edduo\n\nJ  Jacobiano da transforma\u00e7\u00e3o de coordenadas\n\nJ  Matriz Jacobiana\n\nkv  Permeabilidade relativa da fase p [adimensional]\n\nK Permeabilidade absoluta [m2]\n\nKm Subespa\u00e7o de Krylov de dimens\u00e3o m\n\nm cp Fluxo de massa do componente c na fase p [kg/s]\n\nmp Vaz\u00e3o m\u00e1ssica da fase p por unidade de volume do reservat\u00f3rio\n\n[kg/m3 .s]\n\nM k Bloco de mem\u00f3ria na itera\u00e7\u00e3o k\n\nM p Massa da fase p |kgj\n\nM cp Massa do componente c na fase p [kg]\n\nM e Matriz de precondicionamento \u00e0 esquerda\n\nM d Matriz de precondicionamento \u00e0 direita\n\nn Vetor normal\n\n\n\nPCs Press\u00e3o capilar no sistema bif\u00e1sico s [Pa]\n\nqp Vaz\u00e3o da fase p por unidade de volume fmVs.m3]\n\nrk Res\u00edduo da equa\u00e7\u00e3o linear na itera\u00e7\u00e3o k\n\nr Taxa de massa do componente c na fese p gerada por rea\u00e7\u00f5es qu\u00edmicas\n\nPp Press\u00e3o da fase p\n\nRs Raz\u00e3o de solubilidade do g\u00e1s na fase \u00f3leo [m3/m3]\n\nsk Passo do m\u00e9todo de Newton inexato\n\n3 3S p Satura\u00e7\u00e3o da fase p [m /m ]\n\nt Tempo [s]\n\nu p Velocidade da fase p [m/s]\n\nV\u201e Volume da fase p [m3]\nP 1\n\nV Volume ocupado por uma quantidade fixa de massa do componente c\n3na fase p [m ]\n\nx, y ,  z Coordenadas cartesianas [m]\n\nxk Vetor solu\u00e7\u00e3o na itera\u00e7\u00e3o k\n\nX cp Fra\u00e7\u00e3o m\u00e1ssica do componente c na fase p [kg/kg]\n\nZ c Fra\u00e7\u00e3o m\u00e1ssica global do componente c [kg/kg] \n\nGregos\n\n\u00c0 Mobilidade da fase p [m4/N .s]\n\n(j> Porosidade [m3/m3]\n\n\n\n<\u00ef>,\n\n\u00e7 , v  , r\n\n%\n\nG>v\n\nPotencial da fase p\n\nViscosidade da fase p\n\nPeso espec\u00edfico da fase p\n\nDensidade m\u00e9dia da mistura\n\nCoordenadas curvil\u00edneas\n\nForcing term na itera\u00e7\u00e3o k\n\nFator de relaxa\u00e7\u00e3o na itera\u00e7\u00e3o k\n\nSubindices e Superindices\n\nw Agua \n\n\u00d3leo \n\nG\u00e1s\n\nSistema \u00f3leo/\u00e1gua \n\nSitema \u00f3leo/g\u00e1s \n\nc Componente\n\ne , w, n, s ,  t ,  b Interfaces do volume de controle \n\nE , W , N , S , etc Volumes vizinhos ao volume P\n\n8\n\now\n\nOg\n\nk\n\nP\n\nR\n\nSTD\n\nN\u00edvel iterativo\n\nFase\n\n[N.s/m2]\n\n[Pa/m3]\n\n[kg/m3]\n\n[Pa]\n\nCondi\u00e7\u00f5es de reservat\u00f3rio\n\nCondi\u00e7\u00f5es do tanque de armazenamento na superf\u00edcie (condi\u00e7\u00f5es \n\nstandard)\n\n\n\n1 Introdu\u00e7\u00e3o\n\n1.1 Preliminares\n\nO principal objetivo em um estudo de reservat\u00f3rio de petr\u00f3leo \u00e9 a predi\u00e7\u00e3o da sua \n\nperformance futura e a procura de m\u00e9todos e meios capazes de extrair o maior volume de \u00f3leo \n\nposs\u00edvel. A simula\u00e7\u00e3o de reservat\u00f3rios vem ao longo dos anos se firmando como uma \n\nferramenta indispens\u00e1vel ao engenheiro de petr\u00f3leo na realiza\u00e7\u00e3o deste estudo; sobretudo a \n\nsimula\u00e7\u00e3o num\u00e9rica, j\u00e1 que a simula\u00e7\u00e3o completa em laborat\u00f3rio \u00e9 imposs\u00edvel de ser \n\nrealizada.\n\nApesar de sua reconhecida utilidade, a simula\u00e7\u00e3o num\u00e9rica de reservat\u00f3rios \u00e9 uma tarefa \n\ncomplexa e muitas vezes at\u00e9 frustrante para o engenheiro, que tem de lidar com uma s\u00e9rie de \n\nquest\u00f5es que v\u00e3o, desde a escolha do modelo matem\u00e1tico aplic\u00e1vel ao reservat\u00f3rio e ao fluido \n\nem estudo, at\u00e9 a an\u00e1lise dos resultados e o conseq\u00fcente ajuste de dados visando aproximar o \n\nhist\u00f3rico de recupera\u00e7\u00e3o de \u00f3leo real.\n\nEste trabalho, entretanto, concentra-se apenas em determinados aspectos num\u00e9ricos de \n\num simulador baseado no modelo Black-Oil. Este modelo \u00e9 o mais simples de todos os \n\nmodelos de reservat\u00f3rio, por\u00e9m apresenta todas as principais caracter\u00edsticas tamb\u00e9m presentes \n\nem modelos mais complexos, sendo, por isso, ideai para o estudo acad\u00eamico. Como \u00e9 \n\nmostrado ao longo do texto, as an\u00e1lises e conclus\u00f5es feitas neste trabalho tamb\u00e9m podem ser \n\nestendidas a simuladores que empregam modelos matem\u00e1ticos mais complexos.\n\nDesde a introdu\u00e7\u00e3o dos m\u00e9todos num\u00e9ricos na engenharia de petr\u00f3leo e ainda hoje, a \n\ndiscretiza\u00e7\u00e3o baseada em coordenadas cartesianas tem sido extensivamente usada devido a sua \n\nf\u00e1cil constru\u00e7\u00e3o, simplicidade das equa\u00e7\u00f5es discretizadas e r\u00e1pida implementa\u00e7\u00e3o do c\u00f3digo \n\ncomputacional. Entretanto, a discretiza\u00e7\u00e3o cartesiana apresenta consider\u00e1veis desvantagens \n\npara modelar satisfatoriamente reservat\u00f3rios com geometrias complexas, falhas geol\u00f3gicas \n\ne/ou configura\u00e7\u00f5es complexas de po\u00e7os. Visando contornar estes problemas, surgiram \n\nmodelos mais eficientes no tratamento da geometria de reservat\u00f3rios e, para isso, tanto malhas \n\nestruturadas, quanto n\u00e3o-estruturadas, t\u00eam sido exploradas.\n\n\n\nIntrodu\u00e7\u00e3o 2\n\nNo campo das malhas estruturadas cada vez mais se amplia o uso de sistemas \n\ncurvil\u00edneos n\u00e3o-ortogonais ou generalizados permitindo uma maior versatilidade na \n\ndiscretiza\u00e7\u00e3o de complexos reservat\u00f3rios. Todavia, este tipo de discretiza\u00e7\u00e3o requer um \n\nesquema num\u00e9rico envolvendo mais pontos do que somente os sete necess\u00e1rios para uma \n\ndiscretiza\u00e7\u00e3o ortogonal tridimensional, por exemplo. As implica\u00e7\u00f5es decorrentes da \n\nintrodu\u00e7\u00e3o de mais pontos no esquema num\u00e9rico pela discretiza\u00e7\u00e3o n\u00e3o-ortogonal ser\u00e3o \n\nanalisadas em detalhe ao longo deste trabalho.\n\nO modelo Black-Oil padr\u00e3o \u00e9 representado matematicamente por um conjunto de \n\nequa\u00e7\u00f5es diferenciais parciais n\u00e3o-lineares obtidas do balan\u00e7o de massa para cada componente \n\ndo escoamento multif\u00e1sico e do uso da aproxima\u00e7\u00e3o semi-emp\u00edrica de Darcy no lugar das \n\nequa\u00e7\u00f5es de conserva\u00e7\u00e3o da quantidade de movimento, tendo como inc\u00f3gnitas a press\u00e3o do \n\n\u00f3leo e as satura\u00e7\u00f5es de cada fase ou a fra\u00e7\u00e3o m\u00e1ssica de cada componente. Atualmente duas \n\nmetodologias de solu\u00e7\u00e3o destas equa\u00e7\u00f5es s\u00e3o largamente empregadas em diferentes \n\nsimuladores de petr\u00f3leo: o m\u00e9todo IMPES {Implicit Pressure - Explicit Satura\u00edion) e o \n\nm\u00e9todo Totalmente Impl\u00edcito.\n\nNo m\u00e9todo IMPES os coeficientes das equa\u00e7\u00f5es s\u00e3o avaliados no n\u00edvel de tempo \n\nanterior, de maneira que \u00e9 poss\u00edvel desacoplar a press\u00e3o da satura\u00e7\u00e3o obtendo-se uma equa\u00e7\u00e3o \n\nenvolvendo apenas a press\u00e3o. Resolvendo o campo de press\u00e3o, obt\u00e9m-se as satura\u00e7\u00f5es de \n\nforma expl\u00edcita, ou seja, resolve-se apenas um conjunto de equa\u00e7\u00f5es alg\u00e9bricas para as \n\nsatura\u00e7\u00f5es. Apesar do menor sistema linear a ser resolvido (envolve apenas a press\u00e3o) e d\u00e1 \n\natrativa facilidade de vetoriza\u00e7\u00e3o, este m\u00e9todo exige o uso de pequenos intervalos de tempo \n\npara manter a estabilidade da solu\u00e7\u00e3o, principalmente quando aplicado \u00e0 solu\u00e7\u00e3o de problemas \n\nenvolvendo regi\u00f5es de alta vaz\u00e3o e/ou elevados gradientes de satura\u00e7\u00e3o. J\u00e1, no m\u00e9todo \n\nTotalmente Impl\u00edcito, os coeficientes presentes nas equa\u00e7\u00f5es discretizadas s\u00e3o avaliados no \n\nn\u00edvel de tempo mais atual e todo o conjunto de equa\u00e7\u00f5es \u00e9 resolvido simultaneamente, \n\nresultando num maior custo computacional por passo de tempo. Em compensa\u00e7\u00e3o, este \n\nm\u00e9todo \u00e9 muito est\u00e1vel, permitindo o uso de intervalos de tempo maiores. O m\u00e9todo \n\nTotalmente Impl\u00edcito permite ainda que uma s\u00e9rie de estrat\u00e9gias num\u00e9ricas sejam empregadas \n\npara a solu\u00e7\u00e3o do conjunto de equa\u00e7\u00f5es n\u00e3o-lineares acopladas; dentre as quais destacam-se o \n\nm\u00e9todo de Newton e suas variantes.\n\nAtualmente, h\u00e1 um grupo de variantes do m\u00e9todo de Newton cl\u00e1ssico que v\u00eam \n\nrecebendo cada vez mais aten\u00e7\u00e3o da academia e da ind\u00fastria. Estes m\u00e9todos, denominados de\n\n\n\nIntrodu\u00e7\u00e3o 3\n\nm\u00e9todos de Newton inexatos, empregam um segundo processo iterativo para achar uma \n\nsolu\u00e7\u00e3o aproximada para a equa\u00e7\u00e3o linearizada; em contraste com o m\u00e9todo de Newton \n\ntradicional que resolve esta equa\u00e7\u00e3o atrav\u00e9s de um m\u00e9todo direto. Isto \u00e9 particularmente \n\natrativo para problemas derivados de processos de discretiza\u00e7\u00e3o, pois normalmente geram \n\numa matriz Jacobiana esparsa.\n\nN a verdade, a lineariza\u00e7\u00e3o de Newton gera uma equa\u00e7\u00e3o linear envolvendo a matriz \n\nJacobiana, um vetor solu\u00e7\u00e3o que representa a varia\u00e7\u00e3o do vetor inc\u00f3gnita (que deve tender a \n\nzero) e um vetor de res\u00edduos que tamb\u00e9m deve ser levado a zero quando o processo se \n\naproximar da solu\u00e7\u00e3o. E  poss\u00edvel substituir a matriz Jacobiana real por uma aproxima\u00e7\u00e3o \n\ndesde que a equa\u00e7\u00e3o resultante continue zerando os vetores res\u00edduo e varia\u00e7\u00e3o, Esta t\u00e9cnica \n\nnos remete a uma outra classe de m\u00e9todos de Newton, chamados de quase-newtonianos. A \n\nid\u00e9ia \u00e9 substituir uma itera\u00e7\u00e3o de Newton completa por uma mais simples e barata \n\ncomputacionalmente pelo pre\u00e7o de uma taxa de converg\u00eancia mais lenta, ou seja, por uma \n\nmaior quantidade de itera\u00e7\u00f5es. Mais recentemente, foram desenvolvidos m\u00e9todos que nem \n\nsequer constroem a matriz Jacobiana, trabalhando diretamente com o produto Jacobiana-vetor. \n\nS\u00e3o os chamados m\u00e9todos matrix-free.\n\nComo j\u00e1 dito anteriormente, o emprego de coordenadas generalizadas gera um esquema \n\nnum\u00e9rico que envolve um maior n\u00famero de volumes. Sendo assim, a matriz de coeficientes \n\npara o m\u00e9todo de Newton ter\u00e1 uma maior largura de banda e um maior n\u00famero de condi\u00e7\u00e3o \n\n{condit\u00edon number); o que, em tese, acarretar\u00e1 em um maior espa\u00e7o de mem\u00f3ria requerido, um \n\nmaior tempo de computa\u00e7\u00e3o e dificuldades de converg\u00eancia em malhas fortemente n\u00e3o- \n\nortogonais. Uma aproxima\u00e7\u00e3o da matriz Jacobiana utilizando apenas os termos ortogonais \n\npode ent\u00e3o ser usada, gerando um m\u00e9todo quase-newtoniano. Ou ainda, pode-se lan\u00e7ar m\u00e3o \n\nde m\u00e9todos matrix-free para se ter uma lineariza\u00e7\u00e3o aproximada que leva em conta todos os \n\ntermos e uti\u00fczar a parte ortogonal da matriz Jacobiana apenas como matriz de \n\nprecondicionamento. Os m\u00e9todo quase-newtonianos podem ainda empregar solvers iterativos \n\npara a solu\u00e7\u00e3o da equa\u00e7\u00e3o linearizada, tomando-se tamb\u00e9m inexatos.\n\nDos solvers lineares conhecidos, os mais difundidos para o uso em m\u00e9todos de Newton \n\ninexatos s\u00e3o os m\u00e9todos da fam\u00edlia de Krylov, normalmente empregados junto com \n\nprecondicionadores. Por sua vasta popularidade na solu\u00e7\u00e3o de sistema de equa\u00e7\u00f5es n\u00e3o- \n\nlineares, estes m\u00e9todos hoje s\u00e3o mais conhecidos na literatura por m\u00e9todos de Krylov- \n\nNewton.\n\n\n\nIntrodu\u00e7\u00e3o 4\n\nA seguir, \u00e9 apresentada a evolu\u00e7\u00e3o dos diferentes aspectos num\u00e9ricos abordados na \n\nconstru\u00e7\u00e3o do simulador Black-Oil adotado neste estudo.\n\n1.2 Revis\u00e3o Bibliogr\u00e1fica\n\nSegundo Aziz e Settari (1979), h\u00e1 basicamente dois importantes modelos matem\u00e1ticos \n\npara o escoamento em reservat\u00f3rios de petr\u00f3leo: o escoamento mono ou multif\u00e1sico onde mais \n\nde dois componentes hidrocarbonetos s\u00e3o considerados e o escoamento multif\u00e1sico em que a \n\ncomposi\u00e7\u00e3o de hidrocarbonetos pode ser aproximada por apenas dois componentes: um \n\ncomponente n\u00e3o vol\u00e1til (black-oil) e um componente vol\u00e1til (g\u00e1s) sol\u00favel na fase \u00f3leo. Este \n\ntrabalho aborda apenas quest\u00f5es num\u00e9ricas referentes ao segundo modelo matem\u00e1tico, \n\ntamb\u00e9m conhecido como Modelo-P ou Modelo Black-Oil.\n\nNeste modelo considera-se o escoamento simult\u00e2neo de tr\u00eas fases -  g\u00e1s, \u00f3leo e \u00e1gua -  a \n\ntr\u00eas componentes -  g\u00e1s, \u00f3leo e \u00e1gua. Normalmente a fase \u00e1gua \u00e9 a fase molhante, a fase \u00f3leo \n\ntem molhabilidade intermedi\u00e1ria e a fase g\u00e1s \u00e9 a fase n\u00e3o-molhante. Assume-se tamb\u00e9m que \n\n\u00e1gua e \u00f3leo s\u00e3o imisc\u00edveis, n\u00e3o trocam massa entre si e n\u00e3o mudam de fase. Todavia, o \n\ncomponente g\u00e1s pode estar dissolvido em \u00f3leo, mas n\u00e3o em \u00e1gua. Considera-se tamb\u00e9m que \n\nos fluidos est\u00e3o a temperatura constante e em equil\u00edbrio termodin\u00e2mico no reservat\u00f3rio. \n\nSegundo Cunha (1996), o modelo Black-Oil \u00e9 amplamente usado na ind\u00fastria de petr\u00f3leo e \n\naplica-se, especialmente, na modelagem de reservat\u00f3rios contendo \u00f3leos pesados ou de baixa \n\nvolatilidade.\n\nPara formular matematicamente o modelo Black-O\u00edl, nomialmente utiliza-se como \n\nvari\u00e1veis prim\u00e1rias a press\u00e3o do \u00f3leo e as satura\u00e7\u00f5es de cada fase. Exemplos de modelos \n\nnum\u00e9ricos que utilizam este tipo de formula\u00e7\u00e3o podem ser encontrados em Peaceman (1977), \n\nAziz e Settari (1979), Prais e Campagnolo (1991) e Cunha (1996). Todavia, este tipo de \n\nformula\u00e7\u00e3o apresenta s\u00e9rios problemas em escoamentos envolvendo uma fase gasosa. Isto \n\nocorre porque, em algumas regi\u00f5es do reservat\u00f3rio, devido \u00e0s condi\u00e7\u00f5es termodin\u00e2micas, a \n\nfase g\u00e1s pode desaparecer, pois o componente g\u00e1s encontra-se completamente dissolvido na \n\nfase \u00f3leo. Nestas condi\u00e7\u00f5es, a equa\u00e7\u00e3o da fase g\u00e1s da formula\u00e7\u00e3o baseada em satura\u00e7\u00f5es \n\ntoma-se irrelevante. Como \u00e9 mostrado nos estudos realizados por Abou-Kassem e Aziz (1985) \n\ne Forsyth e Sammon (1984), isso implica na utiliza\u00e7\u00e3o de esquemas envolvendo a substitui\u00e7\u00e3o\n\n\n\nIntrodu\u00e7\u00e3o 5\n\nde vari\u00e1vel e equa\u00e7\u00e3o ou que impe\u00e7am que a fase g\u00e1s desapare\u00e7a, for\u00e7ando a exist\u00eancia de um \n\nvalor residual especificado para a satura\u00e7\u00e3o de g\u00e1s. Visando contornar estas dificuldades, \n\ndesenvolveu-se a formula\u00e7\u00e3o que utiliza as fra\u00e7\u00f5es m\u00e1ssicas globais de cada componente em \n\nlugar das satura\u00e7\u00f5es das fases. Esta t\u00e9cnica, reportada por Prais e Campagnolo (1991) e \n\nMaliska et a i (1997), \u00e9 usada neste trabalho e, portanto, ser\u00e1 revista em detalhes mais adiante.\n\nUma vez definido o modelo matem\u00e1tico, parte-se para a modelagem num\u00e9rica do \n\nproblema, onde a principal decis\u00e3o recai sobre o m\u00e9todo de discretiza\u00e7\u00e3o das equa\u00e7\u00f5es. Este \n\ntrabalho concentra-se no m\u00e9todo dos volumes finitos em coordenadas generalizadas.\n\nO uso de coordenadas generalizadas, tamb\u00e9m conhecida como coordenadas coincidentes \n\ncom a fronteira {boundary-fitted coordinates), na solu\u00e7\u00e3o de problemas enyolvendo o \n\nescoamento de fluidos, experimentou um grande avan\u00e7o depois da metade da d\u00e9cada de 70 \n\ncom os trabalhos de Thompson et al. (1976), sendo, a princ\u00edpio, aplicadas na solu\u00e7\u00e3o de \n\nproblemas de aerodin\u00e2mica empregando diferen\u00e7as finito!. Hoje em dia, esta t\u00e9cnica \u00e9 \n\nlargamente difundida e usada para resolver diferentes problemas, entre eles a simula\u00e7\u00e3o \n\nnum\u00e9rica de reservat\u00f3rios de petr\u00f3leo.\n\nNeste campo, os primeiros trabalhos envolvendo sistemas curvil\u00edneos restringiam-se \n\napenas a sistemas ortogonais, que, se por um lado permitem um tratamento eficiente da \n\ngeometria aliado a um esquema num\u00e9rico simples, por outro reduzem drasticamente os tipos \n\nde geometrias capazes de serem discretizadas. Nesta linha, pode-se citar os trabalhos de \n\nHirasaki e O\u2019Dell (1970), Sonier e Chaumet (1974), Robertson e Woo (1978), Fleming (1984) \n\ne Sharpe e Anderson (1990; 1991). Neste \u00faltimo, os autores prop\u00f5em um interessante m\u00e9todo \n\nalternativo para a  gera\u00e7\u00e3o de malhas curvil\u00edneas ajustadas a quaisquer contornos internos e \n\nexternos. Estas malhas s\u00e3o geradas resolvendo-se um conjunto de equa\u00e7\u00f5es diferenciais \n\nparciais parab\u00f3licas quase-lineares, em contraste com a gera\u00e7\u00e3o el\u00edptica normalmente usada \n\ntia cria\u00e7\u00e3o de malhas curvil\u00edneas, podendo gerar malhas aproximadamente ortogonais mesmo \n\nem reservat\u00f3rios complexos. Entretanto, ao tentar satisfazer a condi\u00e7\u00e3o de ortogonalidade, \n\nacaba por criar grande adensamento de volumes at\u00e9 em regi\u00f5es onde n\u00e3o haveria necessidade. \n\nS\u00f3 mais recentemente, surgiram estudos da aplica\u00e7\u00e3o de sistemas n\u00e3o-ortogonais em \n\nreservat\u00f3rios, dos quais destacam-se os de Britto et al. (1991), Aavatsmark et al. (1994) e \n\nMaliska et al. (1994, 1997). Estes m\u00e9todos, apesar de trazerem complexidades adicionais ao \n\nesquema num\u00e9rico -  j\u00e1 agora as conex\u00f5es entre volumes deixam de ser ortogonais as faces \n\ndos mesmos \u2014 permitem a discretiza\u00e7\u00e3o de dom\u00ednios bem mais complexos, especialmente\n\n\n\nIntrodu\u00e7\u00e3o 6\n\nquando a geometria do problema \u00e9 tridimensional.\n\nRepetindo o que j\u00e1 foi dito nas preliminares, o modelo Black-Oil \u00e9 representado por um \n\nsistema de equa\u00e7\u00f5es diferenciais parciais. Este pode ser resolvido simultaneamente -  ou seja, \n\ntodas as equa\u00e7\u00f5es acopladas -  ou, como \u00e9 mais comum, desacoplando a press\u00e3o das \n\nsatura\u00e7\u00f5es ou fra\u00e7\u00f5es m\u00e3ssicas. Dos m\u00e9todos segregados, que desacoplam as equa\u00e7\u00f5es, sem \n\nd\u00favida nenhuma o mais famoso e empregado na ind\u00fastria \u00e9 o m\u00e9todo IMPES -  Implicit \n\nPressure / Explicit Saturation -  que teve origem nos trabalhos de Sheldon et al. (1959) e \n\nStone e Garder Jr. (1961). Este m\u00e9todo \u00e9 similar ao m\u00e9todo PRIME (Maliska,1981) \n\nempregado na modelagem das equa\u00e7\u00f5es de Navier-Stokes. Apesar de largamente utilizado, o \n\nm\u00e9todo IMPES exige um passo de tempo limitado por quest\u00f5es de estabilidade devido ao \n\ntratamento expl\u00edcito das satura\u00e7\u00f5es. Visando melhorar a estabilidade, MacDonald e Coats \n\n(1970) sugerem a utiliza\u00e7\u00e3o de um tratamento impl\u00edcito tamb\u00e9m \u00e0s satura\u00e7\u00f5es, sem, no \n\nentanto, acoplar todas as equa\u00e7\u00f5es, dando origem ao m\u00e9todo seq\u00fcencial ou SEQ, reportado \n\nmais tarde nos trabalhos de Spillete et al. (1973), Coats et a l (1974) e Coats (1976). O m\u00e9todo \n\nde solu\u00e7\u00e3o simult\u00e2nea ou SS, originou-se dos estudos de Douglas Jr. et al. (1959), sendo em \n\nseguida explorado por v\u00e1rios autores (Coats et al., 1967; Coats, 1968; Sheffield, 1969). Mais \n\nrecentemente, surgiram m\u00e9todos h\u00edbridos, mais conhecidos como m\u00e9todos Adaptativos, que \n\ntratam implicitamente apenas os volumes que violam algum crit\u00e9rio de estabilidade, gerando \n\num processo iterativo mais eficiente. Destes, pode-se citar o m\u00e9todo proposto por Thomas e \n\nThumao (1983), o m\u00e9todo AIN (Bertiger e Kelsey, 1985) \u2014 Adapta\u00fcve Inexact Newton \n\nM ethod -  e o m\u00e9todo AHV\u00cd -  Adapta\u00fcve Implicit M ethod -  proposto por Forsyth e Sammon \n\n(1986). Entretanto, como \u00e9 esclarecido por Russel (1989), apenas o \u00faltimo m\u00e9todo pode \n\nrealmente ser considerado como uma alternativa aos m\u00e9todos SS e IMPES, sendo, os dois \n\nprimeiros, m\u00e9todos simult\u00e2neos onde um algoritmo quase-newtoniano \u00e9 empregado na \n\nsolu\u00e7\u00e3o das n\u00e3o-linearidades. Isto pode ser verificado com o fato de ambos os m\u00e9todos \n\nconvergirem para a solu\u00e7\u00e3o simult\u00e2nea. Detalhes a respeito dos m\u00e9todos IMPES e SEQ s\u00e3o \n\nencontrados em Aziz e Settari (1979) e maiores informa\u00e7\u00f5es sobre os m\u00e9todos Adaptativos \n\npodem ser achadas em Marcondes (1996). O m\u00e9todo SS \u00e9 o m\u00e9todo empregado neste \n\ntrabalho.\n\nSegundo Aziz e Settari (1979), as n\u00e3o linearidadcs encontradas nas equa\u00e7\u00f5es do modelo \n\nBlack-Oil podem ser classificadas em dois tipos: fracas e fortes. As fracas est\u00e3o presentes nas \n\npropriedades do fluido e reservat\u00f3rio que s\u00e3o fun\u00e7\u00f5es da press\u00e3o e n\u00e3o requerem tratamento\n\n\n\nIntrodu\u00e7\u00e3o 7\n\nespecial. J\u00e1 as n\u00e3o-linearidades fortes encontram-se nos coeficientes que dependem da \n\nsatura\u00e7\u00e3o ou da press\u00e3o capilar. Do m\u00e9todo usado para resolv\u00ea-las, depender\u00e1 a robustez e \n\nprecis\u00e3o do simulador. As n\u00e3o-linearidades devem ser aproximadas no espa\u00e7o e no tempo. O \n\nm\u00e9todo usado para aproximar as n\u00e3o-linearidades fortes no espa\u00e7o tamb\u00e9m \u00e9 chamado de \n\nfun\u00e7\u00e3o interpola\u00e7\u00e3o e constitui, por si s\u00f3, num dos principais ramos de pesquisa em simula\u00e7\u00e3o \n\nnum\u00e9rica. In\u00fameros trabalhos foram e continuam sendo devotados ao tema e muitos avan\u00e7os \n\nt\u00eam sido obtidos na \u00e1rea. Uma discuss\u00e3o mais detalhada do tema \u00e9 encontrada no trabalho de \n\nCzesnat (1999). Neste trabalho optou-se por empregar o m\u00e9todo UDS -  Upstream \n\nDifferencing Scheme -  devido a sua robustez e por ser extensivamente usado nos simuladores \n\ncomerciais, a despeito de sua alta c\u00fcspens\u00e3o num\u00e9rica decorrente da aproxima\u00e7\u00e3o ser de \n\nprimeira ordem. Com rela\u00e7\u00e3o a solu\u00e7\u00e3o temporal das n\u00e3o-linearidades, tamb\u00e9m h\u00e1 v\u00e1rias \n\nt\u00e9cnicas que podem ser empregadas, que variam desde o tratamento expl\u00edcito das \n\ntransmissividades at\u00e9 o tratamento totalmente impl\u00edcito usando o m\u00e9todo de Newton. Uma \n\ndiscuss\u00e3o detalhada de v\u00e1rias destas t\u00e9cnicas \u00e9 encontrada no texto de Aziz e Settari (1979), \n\ndo qual \u00e9 reproduzido aqui um trecho que resume a principal caracter\u00edstica destas t\u00e9cnicas: \n\n\u201cConforme a \u2018implicitude\u2019 do m\u00e9todo aumenta, sua estabilidade melhora, por\u00e9m os erros de \n\ntruncamento t amb\u00e9m aumentam\u201d .\n\nNo \u00e2mbito da solu\u00e7\u00e3o simult\u00e2nea das equa\u00e7\u00f5es com tratamento impl\u00edcito das n\u00e3o- \n\nlinearidades, como j\u00e1 foi mencionado acima, \u00e9 comum o uso do m\u00e9todo de Newton e suas \n\nvaria\u00e7\u00f5es, das quais destacam-se os m\u00e9todos de Newton inexatos, os m\u00e9todos quase- \n\nnewtonianos e o m\u00e9todo de Newton modificado. Os m\u00e9todos de Newton inexatos \n\ndiferenciam-se do m\u00e9todo de Newton cl\u00e1ssico por utilizarem um segundo processo iterativo \n\npara resolver a equa\u00e7\u00e3o linearizada. Desta forma, a solu\u00e7\u00e3o do modelo linear resolvido a cada \n\nitera\u00e7\u00e3o newtoniana \u00e9 calculada de forma inexata, dando origem ao nome do m\u00e9todo (Dembo, \n\nEisenstat e Steihaug, 1982).\n\nDestes m\u00e9todos, h\u00e1 uma sub-classe que vem ganhando popularidade na solu\u00e7\u00e3o de \n\nsistema de equa\u00e7\u00f5es diferenciais n\u00e3o-lineares derivadas de problemas de engenharia. S\u00e3o os \n\nchamados m\u00e9todos de Krylov-Newton. Nestes m\u00e9todos, emprega-se particularmente um \n\nsolver linear baseado em um m\u00e9todo de proje\u00e7\u00e3o em espa\u00e7os de Krylov (Saad, 1996), dos \n\nquais destacam-se: o GMRES (Saad e Schultz, 1986), o TFQMR (Freund, 1993), o CGS \n\n(Sonneveld, 1989), o BICGSTAB (van der Vorst, 1992), entre outros. V\u00e1rios trabalhos de \n\ndiferentes \u00e1reas t\u00eam sido publicados tendo a aplica\u00e7\u00e3o de m\u00e9todos de Newton inexatos como\n\n\n\nIntrodu\u00e7\u00e3o 8\n\nalvo; dentre os quais podemos citar: Choquet e Erhel (1996), Johnson, McHugh e Knoll \n\n(1997), Shadid, Tuminaro e Walker (1997), Pueyo e Zingg (1997,1998) e Kim e Deo (1999). \n\nNeste \u00faltimo trabalho, os autores aplicam a um simulador Black-Oil um interessante \n\nprocedimento adaptativo para estimar o grau de converg\u00eancia necess\u00e1rio para o solver \n\niterativo em cada itera\u00e7\u00e3o newtoniana. Este m\u00e9todo \u00e9 atribu\u00eddo a Eisenstat e Walker (1996) e \n\nser\u00e1 discutido em detalhes em cap\u00edtulos posteriores.\n\nOs m\u00e9todos quase-newtonianos, por sua vez, diferenciam-se do m\u00e9todo de Newton \n\ntradicional por empregarem uma matriz Jacobiana aproximada. In\u00fameros m\u00e9todos aplicados a \n\nsoiu\u00e7\u00f5es de problemas de engenharia possuem as caracter\u00edsticas destes m\u00e9todos. No \u00e2mbito da \n\nsimula\u00e7\u00e3o de reservat\u00f3rios, Maliska et al. (1997) prop\u00f5em um m\u00e9todo quase-newtoniano, \n\naplicado \u00e0 solu\u00e7\u00e3o simult\u00e2nea totalmente impl\u00edcita utilizando coordenadas generalizadas, em \n\nque a matriz Jacobiana \u00e9 aproximada apenas pelos termos ortogonais. H\u00e1 ainda os trabalhos de \n\nNghiem (1983) e Barua e  Home (1989), que baseiam-se nos m\u00e9todos quase-newtonianos da \n\nfam\u00edlia de Broyden (1965). Estes m\u00e9todos s\u00e3o uma vers\u00e3o multidimensional do tradicional \n\nm\u00e9todo ID da secante. Nghiem introduz uma varia\u00e7\u00e3o, chamada QNSS -  Quasi-Newton \n\nSuccessive Substitution -  evitando o c\u00e1lculo da inversa da Jacobiana, sendo, portanto, ideal \n\npara sistemas esparsos. J\u00e1 Barua e Home empregam uma outra vers\u00e3o, derivada do trabalho \n\nde Mattheis e Strang (1979), na implementa\u00e7\u00e3o de um simulador paralelo. Na \u00e1rea de \n\nescoamento de fluidos, m\u00e9todos quase-newtonianos s\u00e3o muito utilizados em um procedimento \n\nsimilar ao proposto por Maliska et al., onde a matriz Jacobiana \u00e9 calculada com uma \n\naproxima\u00e7\u00e3o de primeira ordem das equa\u00e7\u00f5es de Navier-Stokes, enquanto as fiin\u00e7\u00f5es res\u00edduos \n\ns\u00e3o calculadas com uma aproxima\u00e7\u00e3o de alta ordem. Segundo Johnson, McHugh e Knoll \n\n(1997), este procedimento \u00e9 conhecido na literatura por defeet correction e \u00e9 empregado por \n\ndiversos autores (Johnson et al., 1994; Gropp e Keyes, 1992; Chin et al., 1992). Al\u00e9m disso, \n\nlembrando o que j\u00e1  foi comentado anteriormente, alguns dos m\u00e9todos adaptat\u00edvos s\u00e3o, na \n\nrealidade, m\u00e9todos quase-newtonianos.\n\nEm 1990, Brown e Saad introduziram m\u00e9todos h\u00edbridos, que combinam a aproxima\u00e7\u00e3o \n\nda matriz Jacobiana com a solu\u00e7\u00e3o inexata da equa\u00e7\u00e3o linearizada. S\u00e3o os chamados m\u00e9todos \n\nmatrix-free. Este nome deriva do fato destes m\u00e9todos n\u00e3o constru\u00edrem a matriz Jacobiana \n\ndiretamente. Ao inv\u00e9s disso, faz-se uma aproxima\u00e7\u00e3o em diferen\u00e7as finitas do produto \n\nJacobiana-vetor para ser usado nos solvers de Krylov. Johnson, McHugh e Knoll (1997) \n\nfazem uma compara\u00e7\u00e3o entre o m\u00e9todo matrix-free usando GMRES precondicionado, o\n\n\n\nIntrodu\u00e7\u00e3o 9\n\nm\u00e9todo de Newton cl\u00e1ssico e defect correction em escoamentos internos incompress\u00edveis com \n\ndiferentes n\u00fameros de Reynolds, obtendo melhores resultados com o primeiro m\u00e9todo. Pueyo \n\ne Zingg (1997, 1997, 1998) aplicam praticamente o mesmo procedimento -  matrix-free e \n\nGMRES precondicionado -  em problemas de aerodin\u00e2mica, obtendo resultados excelentes, \n\nchegando inclusive a superar alguns simuladores que empregam multigrid e s\u00e3o refer\u00eancia na \n\n\u00e1rea. Trabalhos reportando a aplica\u00e7\u00e3o de m\u00e9todos matrix-free em simula\u00e7\u00e3o de reservat\u00f3rios \n\nn\u00e3o foram encontrados na literatura dispon\u00edvel.\n\n1.3 Objetivos e Contribui\u00e7\u00f5es\n\nEste trabalho tem por objetivo a implementa\u00e7\u00e3o e an\u00e1lise de diversos m\u00e9todos de \n\nKrylov-Newton aplicados a um simulador Black-Oil, baseado na formula\u00e7\u00e3o em fra\u00e7\u00f5es \n\nm\u00e1ssicas e na discretiza\u00e7\u00e3o usando volumes finitos em coordenadas curvil\u00edneas generalizadas.\n\nEstes m\u00e9todos foram divididos em tr\u00eas grupos principais:\n\n\u2022 M\u00e9todos de Krylov-Newton baseados na proposta de Maliska et al. (1997), em que a \n\nmatriz Jacobiana \u00e9 aproximada apenas pelos termos ortogonais da discretiza\u00e7\u00e3o.\n\n\u2022  M\u00e9todos de Krylov-Newton que utilizam a matriz Jacobiana completa, com suas 19 \n\ndiagonais.\n\n\u2022  M\u00e9todos matrix-free, que utilizam a aproxima\u00e7\u00e3o da matriz Jacobiana do primeiro \n\nm\u00e9todo apenas como matriz de precondicionamento.\n\nOs m\u00e9todos pertencentes ao primeiro e ao terceiro grupo tamb\u00e9m podem ser \n\nclassificados como m\u00e9todos quase-newtonianos.\n\nEm cada grupo, os m\u00e9todos diferem apenas pela escolha do solver de Krylov, do \n\nprecondicionador e da utiliza\u00e7\u00e3o de alguns procedimentos adaptativos para a escolha da \n\ntoler\u00e2ncia usada no processo iterativo interno (tamb\u00e9m conhecida como forcing temi).\n\nUm dos principais aspectos abordados \u00e9 a influ\u00eancia da n\u00e3o-ortogonalidade da malha no \n\nprocesso iterativo destes m\u00e9todos, que passa a ter uma import\u00e2ncia decisiva devido ao tipo de \n\naproxima\u00e7\u00e3o adotada nos m\u00e9todos quase-newtonianos. Deseja-se com isso, dar uma indica\u00e7\u00e3o \n\nde quanto, maiores ou menores distor\u00e7\u00f5es da malha, podem afetar a taxa de converg\u00eancia \n\ndestes m\u00e9todos e qual deles se sai melhor em diferentes graus de n\u00e3o-ortogonalidade.\n\n\n\nIntrodu\u00e7\u00e3o 10\n\nL4 Escopo do Trabalho\n\nNo cap\u00edtulo seguinte, obt\u00e9m-se o conjunto de equa\u00e7\u00f5es diferenciais parciais que \n\ndescrevem o mod\u00e9lo Black-Oil padr\u00e3o, a partir da formula\u00e7\u00e3o matem\u00e1tica geral do fen\u00f4meno \n\nde extra\u00e7\u00e3o de hidrocarbonetos em um reservat\u00f3rio natural. Neste cap\u00edtulo tamb\u00e9m \u00e9 \n\nintroduzida a formula\u00e7\u00e3o em fra\u00e7\u00f5es m\u00e1ssicas.\n\nNo terceiro cap\u00edtulo, as equa\u00e7\u00f5es diferenciais do modelo Black-Oil s\u00e3o transformadas \n\npara o sistema de coordenadas coincidente com a fronteira e, ent\u00e3o, s\u00e3o integradas pelo \n\nm\u00e9todo dos volumes finitos, at\u00e9 a obten\u00e7\u00e3o do sistema de equa\u00e7\u00f5es discretizadas n\u00e3o-lineares.\n\nO quarto cap\u00edtulo faz um breve panorama do problema matem\u00e1tico envolvido na \n\nsolu\u00e7\u00e3o de sistemas de equa\u00e7\u00f5es n\u00e3o-lineares e apresenta alguns dos m\u00e9todos de lineariza\u00e7\u00e3o \n\nmais empregados na solu\u00e7\u00e3o de sistemas provenientes de problemas de engenharia.\n\nNo quinto cap\u00edtulo s\u00e3o apresentados em detalhes os tr\u00eas grupos de m\u00e9todos de Krylov- \n\nNewton mencionados anteriormente, baseados em caracter\u00edsticas particulares da discretiza\u00e7\u00e3o \n\nn\u00e3o-ortogonal.\n\nO sexto cap\u00edtulo \u00e9 reservado para a apresenta\u00e7\u00e3o e an\u00e1lise dos resultados num\u00e9ricos \n\nprovenientes da aplica\u00e7\u00e3o de cada um dos grupos de m\u00e9todos apresentados no quinto cap\u00edtulo. \n\nNeste cap\u00edtulo tamb\u00e9m \u00e9 feita uma valida\u00e7\u00e3o da implementa\u00e7\u00e3o correta dos m\u00e9todos, atrav\u00e9s \n\nda compara\u00e7\u00e3o com um caso descrito na literatura.\n\nPor fim, no s\u00e9timo cap\u00edtulo s\u00e3o apresentadas as conclus\u00f5es do presente trabalho, bem \n\ncomo as recomenda\u00e7\u00f5es para trabalhos futuros.\n\n\n\n2 Formula\u00e7\u00e3o Matem\u00e1tica\n\nNeste cap\u00edtulo ser\u00e1 apresentada a formula\u00e7\u00e3o matem\u00e1tica do modelo Black-Oil padr\u00e3o \n\nutilizando as fra\u00e7\u00f5es m\u00e1ssicas de cada componente e a press\u00e3o da fase \u00f3leo como vari\u00e1veis \n\nprim\u00e1rias.\n\n2.1 Lei de Conserva\u00e7\u00e3o da Massa\n\nO fen\u00f4meno da recupera\u00e7\u00e3o de hidrocarbonetos em reservat\u00f3rios naturais envolve o \n\nescoamento muitif\u00e1sico de v\u00e1rias esp\u00e9cies qu\u00edmicas em um meio poroso heterog\u00eaneo. Este \n\nprocesso f\u00edsico leva em conta trocas de calor e massa por convec\u00e7\u00e3o e difus\u00e3o e pode tamb\u00e9m \n\nenvolver rea\u00e7\u00f5es qu\u00edmicas.\n\ndm *P V ,\n\nm\n\nm\n\nm\n\nFigura 2.1 \u2014 fluxos de massa atrav\u00e9s do volume de controle\n\nConsiderando o volume de controle mostrado na Fig. 2.1, o fluxo de massa do \n\ncomponente c na fase p pode ser dado por\n\n\n\nFormula\u00e7\u00e3o Matem\u00e1tica 12\n\nonde, X cp \u00e9 a fra\u00e7\u00e3o m\u00e1ssica do componente c na f\u00e0se p;\n\np p \u00e9 a densidade da fase p;\n\nu p \u00e9 o  vetor velocidade da fase p;\n\n\u00e9 o tensor coeficiente efetivo de dispers\u00e3o do componente c na fase p;\n\nA \u00e9 a \u00e1rea transversal.\n\nO primeiro termo da Eq. (2.1) descreve o transporte convectivo de fluido atrav\u00e9s do \n\nmeio poroso e o segundo, o efeito combinado do transporte de massa por dispers\u00e3o e difus\u00e3o \n\nmolecular. O coeficiente efetivo de dispers\u00e3o \u00e9 afetado pela porosidade, tortuosidade, \n\ndistribui\u00e7\u00e3o de tamanho de poro, heterogeneidade da rocha e velocidade do fluido. O \n\ntransporte por convec\u00e7\u00e3o est\u00e1 sempre presente no processo de recupera\u00e7\u00e3o de petr\u00f3leo, j\u00e1 o \n\ntransporte por dispers\u00e3o/difus\u00e3o pode ser ignorado na maioria dos casos.\n\nAplicando o Princ\u00edpio da Conserva\u00e7\u00e3o da Massa ao volume de controle da Fig. 2.1, \n\nobt\u00e9m-se\n\ntaxa l\u00edquida de fluxo de massa \ndo componente c \nem todas as fases\n\ntaxa de produ\u00e7\u00e3o/inje\u00e7\u00e3o \nde massa do componente c \n\nem todas as fases\n\ntaxa de ac\u00famulo de massa \ndo componente c \nem todas as fases\n\ntaxa de massa do componente c \ngerada por rea\u00e7\u00e3o qu\u00edmica \n\nem todas as fases\n\n(2.2)\n\nA taxa l\u00edquida de fluxo de massa do componente c na fase p atrav\u00e9s das fronteiras do \n\nvolume de controle \u00e9 dada por\n\ndm.cpx dm\ndx\n\ndx\ndm,.\n\nZ z . #  \u2014  ^y..dz =\n\u00f5y dz\n\n\u00f5 (  dX^\ndx\\ v W * *  \u00eax\n\nd\ndy\n\n\u00d5XCB\nX c p P p U p y  +  D c p y\n\n----w + D\n\u00f4z\\ p p Pz\n\ndX\u201ecp\n\u2022v* dz\n\n(dxdy)dz\n\n(2.3)\n\nque, dividindo pelo volume, \u00e9 o divergente do fluxo de massa.\n\n\n\nFormula\u00e7\u00e3o Matem\u00e1tica 13\n\n- v . { x cpPpu p +J}cpv x J (2 .4)\n\nA taxa de ac\u00famulo de massa do componente c na fase p por unidade de volume \u00e9 \n\nexpressa por\n\n^ f \u00f3 c p P p S p ) (2 .5)\n\nonde,&lt;f> \u00e9 a porosidade;\n\nSp \u00e9 a satura\u00e7\u00e3o da fase p.\n\nOs termos fonte/sumidouro de massa do componente c na fase p s\u00e3o dados por\n\nX  c p P p Q p  +  r cP ( 2 . 6 )\n\nonde, qp \u00e9 a taxa volum\u00e9trica de produ\u00e7\u00e3o/inje\u00e7\u00e3o da fase p por unidade de volume; \n\nrcp \u00e9 a taxa de massa do componente c na fase p gerada por rea\u00e7\u00f5es qu\u00edmicas. \n\nReagrupando os termos na forma da Eq. (2.2), a equa\u00e7\u00e3o da conserva\u00e7\u00e3o da massa fica\n\npara p = l,2,--,np e c = .\n\n2.2 Formula\u00e7\u00e3o em Fra\u00e7\u00f5es M\u00e1ssicas Globais\n\nA Eq. (2.7) \u00e9 tamb\u00e9m chamada de formula\u00e7\u00e3o em satura\u00e7\u00f5es das equa\u00e7\u00f5es do petr\u00f3leo, \n\npois o termo de acumula\u00e7\u00e3o de massa est\u00e1 escrito em fun\u00e7\u00e3o da vari\u00e1vel satura\u00e7\u00e3o. Como j\u00e1 \n\nfoi comentado no cap\u00edtulo anterior, em problemas envolvendo alguma fase gasosa este tipo de \n\nformula\u00e7\u00e3o traz complexidades para o modelo computacional que tem de lidar com o \n\ndesaparecimento de fase. Visando contornar este problema, introduziu-se a formula\u00e7\u00e3o em \n\nfra\u00e7\u00f5es m\u00e1ssicas globais. Neste caso, o termo de acumula\u00e7\u00e3o fica\n\n-Z7(&amp;PmZc) (2 .8 )\n\n\n\nFormula\u00e7\u00e3o Matem\u00e1tica 14\n\nonde, p m \u00e9 a densidade m\u00e9dia da mistura, dada por\n\nPm 2 i?Pp? p (2.9)p\n\ne Zc \u00e9 a fra\u00e7\u00e3o m\u00e1ssica global do componente c.\n\nSubstituindo na Eq. (2.7), obt\u00e9m-se\n\n(2 . 10)\n\npara p  = l,2,...,np e c = l,2 ,...,\u00abc.\n\n2.3 Lei de Darcy\n\nPara descrever matematicamente o escoamento, al\u00e9m da equa\u00e7\u00e3o da continuidade \n\ndesenvolvida nas se\u00e7\u00f5es anteriores, \u00e9 necess\u00e1ria uma rela\u00e7\u00e3o entre a velocidade e o gradiente \n\nde press\u00e3o em cada fase. Esta rela\u00e7\u00e3o, que substitui a equa\u00e7\u00e3o de conserva\u00e7\u00e3o da quantidade \n\nde movimento em escala macrosc\u00f3pica para um meio poroso, foi descoberta por Darcy (1856) \n\npara o escoamento monof\u00e1sico e \u00e9 chamada de Lei de Darcy. Embora esta lei tenha sido \n\noriginalmente baseada em observa\u00e7\u00f5es experimentais, ela tamb\u00e9m pode ser obtida atrav\u00e9s de \n\nm\u00e9dias volum\u00e9tricas das equa\u00e7\u00f5es do movimento.\n\nPara um escoamento multifasico, sua forma \u00e9:\n\nonde, K \u00e9 o tensor permeabilidade absoluta; \n\nkrp \u00e9 a permeabilidade relativa da fase p;\n\n\u00df p \u00e9 a viscosidade da fase p;\n\nPp \u00e9 a press\u00e3o da fase p;\n\nyp \u00e9 o  peso espec\u00edfico da fase p;\n\nD \u00e9 a profundidade com rela\u00e7\u00e3o a algum ponto de refer\u00eancia;\n\n(2 .11)\n\n\n\nFonnula\u00e7\u00e3o Matem\u00e1tica 15\n\n\u00c0 = K \u2014  \u00e9 a mobilidade da fase p;\n\n<bp = Pp -ypD \u00e9 o potencial da fase p.\n\nO tensor permeabilidade usado na Eq. (2.11) \u00e9 definido pela pr\u00f3pria equa\u00e7\u00e3o e, portanto, \n\ndeve ser determinado experimentalmente. Na maioria dos problemas encontrados na pr\u00e1tica \u00e9 \n\nposs\u00edvel (ou necess\u00e1rio) assumir que K \u00e9 um tensor diagonal, dado por\n\nK (2.12)\n\nSe kx = ky = kz, ent\u00e3o o meio poroso \u00e9 chamado de isotr\u00f3pico, se ri\u00e3o, o meio \u00e9 anisotr\u00f3pico.\n\nDiscuss\u00f5es detalhadas a respeito das limita\u00e7\u00f5es inerentes \u00e0 Lei de Darcy s\u00e3o \n\nencontradas nos trabalhos de Hubbert (1956), Scheidegger (1974), Collins (1961) e Whitaker \n\n(1966, 1969).\n\n2.4 Modelo Black-Oil Padr\u00e3o\n\nO modelo Black-Oil padr\u00e3o \u00e9 largamente usado na pr\u00e1tica da simula\u00e7\u00e3o de \n\nreservat\u00f3rios, sendo especialmente empregado na modelagem de reservat\u00f3rios contendo \u00f3leos \n\npesados ou de baixa volatilidade. Nesta se\u00e7\u00e3o, ser\u00e1 mostrado como obter as equa\u00e7\u00e3o deste \n\nmodelo a partir do modelo gen\u00e9rico da Eq. (2.10), bem como obter as propriedades de cada \n\nfase atrav\u00e9s das rela\u00e7\u00f5es Press\u00e3o-Volume-Temperatura (PVT).\n\nO modelo Black-Oil padr\u00e3o possui as seguintes caracter\u00edsticas:\n\n\u2022 Sistema com tr\u00eas componentes (c = w,o,g) \n\nw , componente \u00e1gua\n\no , componente hidrocarboneto l\u00edquido (\u00f3leo) \n\ng , componente hidrocarboneto gasoso (g\u00e1s)\n\n\u2022 Sistema com tr\u00eas fases (c = w,o, g) \n\nw , fase \u00e1gua\n\n\n\nFormula\u00e7\u00e3o Matem\u00e1tica 16\n\no , fase \u00f3leo \n\ng , fase g\u00e1s\n\nA \u00e1gua geralmente \u00e9 a  fase molhante, o \u00f3leo tem molhabilidade intermedi\u00e1ria e o g\u00e1s \u00e9 a \n\nfase n\u00e3o-molhante.\n\n\u2022  Os componentes \u00e1gua e \u00f3leo n\u00e3o vaporizam na fase g\u00e1s ( =  X og 0)\n\n\u2022 O componente g\u00e1s pode estar dissolvido na fase \u00f3leo, mas n\u00e3o na fase \u00e1gua ( X ^  = 0  )\n\n\u2022 Escoamento isot\u00e9rmico\n\n\u2022  Os fluidos est\u00e3o em equil\u00edbrio termodin\u00e2mico no reservat\u00f3rio\n\n\u2022  Transporte convectivo dominante\n\n\u2022 N\u00e3o h\u00e1 rea\u00e7\u00f5es qu\u00edmicas ocorrendo no reservat\u00f3rio\n\nSob estas condi\u00e7\u00f5es, o comportamento PVT do sistema pode ser representado pelos \n\nfatores volume de forma\u00e7\u00e3o da seguinte maneira:\n\nNas equa\u00e7\u00f5es acima, tycp)R representa o volume ocupado por uma quantidade fixa de \n\nmassa do componente c (o, w ou g) na fase p (o, w ou g) em condi\u00e7\u00f5es do reservat\u00f3rio e\n\narmazenamento na superf\u00edcie (condi\u00e7\u00e3o standard). Os fatores volume de foima\u00e7\u00e3o s\u00e3o \n\nfun\u00e7\u00f5es da press\u00e3o de sua respectiva fase.\n\nNormalmente, esses fatores s\u00e3o fornecidos via uma tabela de pontos experimentais ou \n\ns\u00e3o definidos com base na compressibilidade da fase, dada por\n\n\u00d3leo e \u00e1gua s\u00e3o imisc\u00edveis e n\u00e3o trocam massa, ou seja, X wo = X ow = 0\n\n(213)\n\n(2.14)\n\n(2.15)\n\nK L  3, o volume ocupado pelo mesmo componente nas condi\u00e7\u00f5es do tanque de\n\n\n\nFormula\u00e7\u00e3o Matem\u00e1tica 17\n\np Vp { d P (2.16)\n\nL\u00edquidos t\u00eam fatores de forma da ordem da unidade, j\u00e1, para os gases, este fator \u00e9 muito \n\nmenor.\n\nA troca de massa entre as fases \u00f3leo e g\u00e1s \u00e9 descrita pela solubilidade do g\u00e1s na fase \n\n\u00f3leo, que \u00e9 dada pela raz\u00e3o\n\nV\u201e \\\n\n\\  OO J\n= f {p 0) (2.17)\n\nSTD\n\nEsta propriedade relaciona a quantidade de g\u00e1s dissolvido em \u00f3leo com a press\u00e3o da fase \u00f3leo.\n\nA raz\u00e3o de solubilidade g\u00e1s/\u00f3leo est\u00e1 relacionada com a respectiva fra\u00e7\u00e3o m\u00e1ssica da \n\nseguinte maneira\n\nS \u00b0  S \u00b0\n\u00edl7 li ^STD * jf\n\\ SPJsm Ps. P\u00ab gD  __  v '  STD __  * % __  P S  __  \u00a3 \u00b0  Po d  _ V \"  Po d\n\nK  ~ M i _ ~ m . p T> - P f >  *\nB . P .B .\n\ne, resolvendo para a fra\u00e7\u00e3o m\u00e1ssica do g\u00e1s na fase \u00f3leo, tem-se\n\n(2.18)\n\n= R s  \u201e ST Ds\u00b0 ~  O B (2-19)r o o\n\nAs fra\u00e7\u00f5es m\u00e1ssicas dos componentes \u00e1gua, \u00f3leo e g\u00e1s em suas respectivas fases s\u00e3o \n\nent\u00e3o facilmente derivadas das hip\u00f3teses acima, obtendo-se\n\n(2.20)\n\nIntroduzindo as defini\u00e7\u00f5es e hip\u00f3teses simplificativas do modelo Black-Oil e a Lei de \n\nDarcy na Eq. (2.10), tem-se as equa\u00e7\u00f5es de conserva\u00e7\u00e3o da massa dos componentes \u00e1gua, \u00f3leo \n\ne g\u00e1s para o modelo Black-Oil padr\u00e3o:\n\n\n\nFormula\u00e7\u00e3o Matem\u00e1tica 18\n\n+ (2.22)\n\n^ [ * \u2019- ZJ = V- [ ( l - ^ K V \u00ab >&lt;,+ A 8V&lt;I>J+(l-J!r<\u201e K  + &lt;\u201ds (2.23)\n\nonde, mp = p pqp \u00e9 fluxo m\u00e1ssico de produ\u00e7\u00e3o/inje\u00e7\u00e3o da fase p por unidade de volume, sendo \n\npositivo para inje\u00e7\u00e3o e negativo para a produ\u00e7\u00e3o, e a mobilidade da fase p foi redefinida para\n\n\u20223 !/\u2022 Ppk,p\nAP ~ ^  ^  (2.24)\n\nAs inc\u00f3gnitas do sistema formado pelas equa\u00e7\u00f5es (2.21), (2.22) e (2.23) s\u00e3o Pw, Pa, Pg ,\n\nZ w, ZQ e Zg . Logo, necessita-se de mais tr\u00eas equa\u00e7\u00f5es para o fechamento do problema. Uma\n\ndelas \u00e9 a equa\u00e7\u00e3o de restri\u00e7\u00e3o imposta \u00e0s fra\u00e7\u00f5es m\u00e1ssicas globais, que permite escrever a \n\nfra\u00e7\u00e3o m\u00e1ssica do g\u00e1s em fun\u00e7\u00e3o das fra\u00e7\u00f5es m\u00e1ssicas do \u00f3leo e da \u00e1gua como \u00e9 mostrado na \n\nequa\u00e7\u00e3o abaixo\n\n7 \u2014 ! _ 7  \u2014 7\n- 1 *** (2.25)\n\nAs duas equa\u00e7\u00f5es restantes relacionam as press\u00f5es das fases atrav\u00e9s do efeito de \n\ncapilaridade como \u00e9 mostrado abaixo\n\nPcow l>o ~  = f ( S j  (2.26)\n\n(2.27)\n\nAs press\u00f5es capilares PCow e PCog s\u00e3o fun\u00e7\u00f5es das satura\u00e7\u00f5es das fases molhantes em\n\ncada sistema (\u00e1gua/\u00f3leo e \u00f3leo/g\u00e1s) e, na maioria dos casos, s\u00e3o determinadas empiricamente. \n\nCom as Eqs. (2.25), (2.26) e (2.27) introduzidas no sistema, as vari\u00e1veis prim\u00e1rias do modelo \n\nf\u00edlack-Oil passam a ser a press\u00e3o da fase \u00f3leo, Pt>, e as fra\u00e7\u00f5es m\u00e1ssicas globais da \u00e1gua, Z w, \n\ne do \u00f3leo, Za . Al\u00e9m disso, \u00e9 comum substituir a equa\u00e7\u00e3o de conserva\u00e7\u00e3o da massa do \n\ncomponente g\u00e1s pela equa\u00e7\u00e3o de conserva\u00e7\u00e3o da massa total, formada pela soma das Eqs.\n\n(2.21), (2 .2 2 ) e (2.23). Com isso o sistema a ser resolvido toma-se\n\n\n\nFormula\u00e7\u00e3o Matem\u00e1tica 19\n\n\u00f4 t\n\n\u00f5_ \n\u00f5 t W . z , h  v R a v \u00ae . ] + X j \u00ab. (2.29)\n\nZg - 1  Zw Z\u201e (2.3 i)\n\nonde,\n\n\u00ae w = P 0 ~ fc o w +  T y P  (2.32)\n\n= P o +  Y oD  (2.33)\n\n= Fo + ? cog + 7 ^  (2 .3 4 )\n\nNo restante do texto, a press\u00e3o da fase \u00f3leo, Pa, ser\u00e1 designada, por simplicidade, por \n\napenas P .  Al\u00e9m disso, a equa\u00e7\u00e3o de conserva\u00e7\u00e3o da massa do componente \u00e1gua, ser\u00e1 \n\nchamada apenas de equa\u00e7\u00e3o da \u00e1gua; a da conserva\u00e7\u00e3o da massa do componente \u00f3leo, de \n\nequa\u00e7\u00e3o do \u00f3leo; e a  equa\u00e7\u00e3o de conserva\u00e7\u00e3o da massa total, de equa\u00e7\u00e3o da press\u00e3o. O nome \n\n\u201cequa\u00e7\u00e3o da press\u00e3o\u201d adv\u00e9m desta equa\u00e7\u00e3o ter sido originalmente moldada para o avan\u00e7o da \n\nvari\u00e1vel press\u00e3o em simuladores que utilizam a t\u00e9cnica IMPES.\n\n2.5 Condi\u00e7\u00f5es de Contorno e Iniciais\n\nA intera\u00e7\u00e3o entre o reservat\u00f3rio e sua vizinhan\u00e7a \u00e9 levada em conta na simula\u00e7\u00e3o atrav\u00e9s \n\ndas condi\u00e7\u00f5es especificadas em suas fronteiras. As condi\u00e7\u00f5es de contorno (ou de fronteira) \n\ns\u00e3o necess\u00e1rias nos po\u00e7os e nas fronteiras exteriores do reservat\u00f3rio.\n\nH\u00e1 basicamente tr\u00eas tipos de condi\u00e7\u00f5es de contorno:\n\n\u2022  Fronteira imperme\u00e1vel:\n\n\n\nFormula\u00e7\u00e3o Matem\u00e1tica 20\n\nUp\u00edi-O em F (2 .3 5 )\n\nVaz\u00e3o prescrita:\n\nu P n j (2.36)\n\nPress\u00e3o prescrita:\n\nPp( x , y , z , t )  = Pp(T) (237)\n\nA prescri\u00e7\u00e3o da vaz\u00e3o ou press\u00e3o nos po\u00e7os e nas fronteiras entre o reservat\u00f3rio e um \n\naqu\u00edfero s\u00e3o geralmente feitas atrav\u00e9s de termos fontes. Em alguns problemas, onde n\u00e3o \u00e9 \n\nposs\u00edvel utilizar as formula\u00e7\u00f5es acima para especificar as condi\u00e7\u00f5es de contorno, deve-se \n\nlan\u00e7ar m\u00e3o de modelos adicionais que n\u00e3o ser\u00e3o aqui abordados.\n\nAs distribui\u00e7\u00f5es iniciais de press\u00e3o e satura\u00e7\u00f5es s\u00e3o normalmente conhecidas e dadas \n\ncomo fun\u00e7\u00f5es das coordenadas espaciais:\n\nPp( x ,y ,z ,0 )  = P p ( x ,y ,z )\n\nS p( x , y , z f i ) = S p ( x , y , z )  (238)\n\nNa maioria dos problemas a distribui\u00e7\u00e3o inicial da press\u00e3o \u00e9 determinada assumindo o \n\nequil\u00edbrio entre os efeitos gravitacionais e os efeitos de capilaridade no reservat\u00f3rio. Isso toma \n\na press\u00e3o uma fun\u00e7\u00e3o apenas da coordenada vertical:\n\nPp{ x ,y ,z ,0 ) = P p{z) (239)\n\nAl\u00e9m disso, para a formula\u00e7\u00e3o em fra\u00e7\u00f5es m\u00e1ssicas, \u00e9 necess\u00e1rio determinar as fra\u00e7\u00f5es \n\nm\u00e1ssicas globais iniciais atrav\u00e9s dos campos de press\u00e3o e satura\u00e7\u00e3o iniciais. Isso \u00e9 feito \n\natrav\u00e9s das rotinas de \u201cflash\u201d (Cunha, 1996), assumindo o equil\u00edbrio instant\u00e2neo no \n\nreservat\u00f3rio.\n\n\n\n3 Formula\u00e7\u00e3o Num\u00e9rica\n\nNeste cap\u00edtulo, as equa\u00e7\u00f5es diferenciais do modelo Black-Oil padr\u00e3o ser\u00e3o \n\ntransformadas para o sistema de coordenadas curvil\u00edneas e discretizadas atrav\u00e9s do m\u00e9todo \n\ndos volumes finitos. Utiliza-se o m\u00e9todo UDS para a avalia\u00e7\u00e3o das mobilidades nas faces do \n\nvolume de controle.\n\n3.1 Transforma\u00e7\u00e3o das Equa\u00e7\u00f5es Governantes para o Sistema\n\nVisando obter malhas que se adaptam melhor \u00e0s fronteiras e a outras irregularidades \n\ngeom\u00e9tricas do reservat\u00f3rio, uma alternativa eficiente e que vem ganhando adeptos entre os \n\nanalistas num\u00e9ricos especializados em simula\u00e7\u00e3o de reservat\u00f3rio \u00e9 o uso de coordenadas \n\ngeneralizadas ou coincidentes com a fronteira. Neste m\u00e9todo, popularizado com os trabalhos \n\nde Thompson et al. (1976,1977), \u00e9 poss\u00edvel encontrar a transforma\u00e7\u00e3o, mesmo que num\u00e9rica, \n\nentre o sistema coordenado cartesiano original e o sistema de coordenadas generalizadas \n\ncoincidente com a geometria irregular. Isso permite que seja feito um mapeamento da \n\ngeometria complexa, escrita no sistema (x, y, z), em uma geometria regular no sistema \n\ncurvil\u00edneo ( \u00a3  tj, /), conforme \u00e9 mostrado na Fig. 3 .1.\n\nCoordenado Curvil\u00edneo\n\nE K r\n\nFigura 3.1 -  Dom\u00ednio f\u00edsico e transformado\n\n\n\nFormula\u00e7\u00e3o Num\u00e9rica 22\n\nObtida a transforma\u00e7\u00e3o -  cujos detalhes n\u00e3o ser\u00e3o aqui abordados e podem ser \n\nencontrados em Maliska (1995) -  o sistema de equa\u00e7\u00f5es governantes deve ser reescrito no \n\nsistema curvil\u00edneo. Logo, no espa\u00e7o transformado, as Eqs. (2.28), (2.29) e (2.30) assumem as \n\nseguintes formas:\n\n\u2022 Equa\u00e7\u00e3o da conserva\u00e7\u00e3o da massa total (Equa\u00e7\u00e3o da press\u00e3o)\n\nd ;\n\n\u00f4\ndn\n\u00f5_\n\n\u00f5 \u00ed\n\nA\n\u00f5 y\n\n_\u00f5_\n\n5t]\n\nD21\n\u00f5 ^\n\u00d5Z\n\n+ D 22 \"+ D23\n\n\u00d5Q> \u00f4<|)D\u00b0 \u2014 \u00b0 J-T) 0\n11 * r_ 12 - ' \u201d l3\n\n+-D32\n\nDf,21 ' + Df2\n\nm\nt? T ]\n\n0 T|\n\n-  + D33\n\n+ Df3\n\n\u00f5\u00ae\u00bb \n\u00f5 y  \n\n^> 0~ \n\u00f5 j \n\n\u00f5 y\n\n+\n\n+ -\n\nA\n\u00d5 J  \n\n\u00f4\n\n+ D a\u00ae.12 dr|\n+ D13\n\n\u00f5y\n+\n\nD31 \u2014 + D32 \u00f5iq\nt D33 \u00ab9y\n\n+\n\n+\n\n\u00f5 j\n\n\u00f5r\\\nd _ _\n\n\u00f5_\n\u00f5 j\n\noO&lt;5G> \nD* ^  + D\"2^  + D\u00b03- -\n\ndt,\n\u00d5Q>\n\nDfi\n50)\n\n* +Df2\n\ndt]\n\u00f5$>\n\n-+ d ?2\n\n\u00d5iq\n\n\u00d4G>\n\n8 + Df3\n\n5y\nd\u00ae\n\ndil\n- + D\u2018\n\ndy\nm .\n\n+\n\n0 y\n\n(3.1)\n\nEqua\u00e7\u00e3o da conserva\u00e7\u00e3o da massa do componente \u00e1gua (Equa\u00e7\u00e3o da \u00e1gua)\n\n7\nA\n\u00d5\u00ed,\n_a_\n\u00f5t\\\n_\u00f5_\n\n\u00f5 j\n\nd :\n\nD \u201d\n\nD31\n\n\u00d4E,\n\naa>w\n1 d \u00a3\n\n\u00d5Z\n\n+ D12\n\n+ D \u00cd\n\n32\n\n5\u00ae\u00bb\n<5*1\n0 0 )K'\n\n\u00d4 T )\n\n\u00f4\u20ac>yy\na?!\n\n-+d \u00bb\n\n+ D23\n\n\u2022 4- D33\n\n\u00f5 j\n\n\u00d5 J\n\na\u00ae*\n\u00f5 y\n\n+\n(3.2)\n\n\u2022 Equa\u00e7\u00e3o da conserva\u00e7\u00e3o da massa do componente \u00f3leo (Equa\u00e7\u00e3o do \u00f3leo)\n\n\n\nFormula\u00e7\u00e3o Num\u00e9rica 23\n\nK\n\nD* = y\nd x 1 \u00f5 x i dx1 d x i \u00f5xl d x 3\n\n+ -----------+ \u2022\n\u00f5 x  \u00f5x \u00f5 y \u00f5 y  \u00f5 z  \u00f5 z (3.4)\n\ne xul, com i,j = 1...3, correspondem a \u00a3 , i/ e / ,  respectivamente. \n\nExemplificando, para D5* , tem-se\n\nD 12\nJ\n\nd g  \u00f5 r j  \u00f5 \u00c7 \u00f4 t j  d g  d i j  \n\n\u00f5x \u00f5x \u00f5y \u00f5 y  \u00f5 z  \u00f5 z (3.5)\n\nE J  \u00e9 o jacobiano da transforma\u00e7\u00e3o, dado por\n\n\u00d5\u00c7_ vg_ d g\n\u00f5 x  d y  \u00f5 z\n\u00d5TJ \u00d5JJ \u00d5TJ\n\n\u00f5 x  \u00f5 y  \u00f5 z\n\u00f5 y  \u00f5 y  \u00f5 y\n\u00f5 x  \u00f5 y  \u00f5z\\\n\nJ  = (3-6)\n\nNeste ponto \u00e9 interessante notar que, para cada fase, devido as derivadas cruzadas \n\noriundas da n\u00e3o-ortogonalidade da malha, tem-se nove termos poss\u00edveis de derivada dos \n\npotenciais. Este fato tamb\u00e9m pode ser evidenciado pelo aparecimento das nove componentes \n\ndo tensor m\u00e9trico atrav\u00e9s dos D | . Fazendo um paralelo com sistemas ortogonais, neste caso \n\nter-se-ia apenas tr\u00eas termos, a saber:\n\n\u00d5JJ \u00f5 y (3.7)\n\n3.2 Discretiza\u00e7\u00e3o das Equa\u00e7\u00f5es Governantes\n\nA  transforma\u00e7\u00e3o das equa\u00e7\u00f5es para um sistema coordenado generalizado permite que o \n\nm\u00e9todo dos volumes finitos, baseado na integra\u00e7\u00e3o das equa\u00e7\u00f5es de balan\u00e7o escritas na foima \n\nconservativa, seja facilmente aplicado. A partir deste ponto, por simplicidade, apenas a \n\nequa\u00e7\u00e3o discretizada da \u00e1gua ser\u00e1 abordada em detalhes, sendo que as demais podem ser \n\ntranquilamente obtidas repetindo-se o mesmo procedimento. Sendo assim, efetuando-se a \n\nintegra\u00e7\u00e3o da equa\u00e7\u00e3o da \u00e1gua no tempo e no volume elementar do espa\u00e7o transformado da \n\nFig. 3.2, tem-se:\n\n\n\nFormula\u00e7\u00e3o Num\u00e9rica 24\n\nDu + DS ^  + D,\"&lt;?? 2L\n\n<?<!>\n\n\u00e2r\\ \u00e2 y\n\n<?<!>D?, + D\" + D,3 \n11 d% 12 ^ ti 13 \u00e2 y\n\nd<&amp; \u00e2<b \u00e2$>\nD21 \u2014 \u2014 + D\u201d2\u2014 ^ + B w\n\n\u00e2ir\\ 23 \u00e2 y\n\nn \u201e d<bK w d$>w \u00e2<S>w\nu 2l or 22 ^23\n\n<?<D_\n\n\u00e2 i \\ \u00e2y\n\n\u00e2\u00ae\u201e\nO3. ~  + V32 ?  + D3-  ~ '*'\u201d \n\nD31 ~ ^r~  + D32\n^0> W\n\n\u00cd? T J\n+ n \"  w1-  u 3 3\n\n\u00e2 y\n\nAqAyAt-\n\nAt]AyAt+\n\nA\u00c7AyAt-\n1\n\nA? AyAt+\n\nA\u00e7Ar|At-\n\nA? Ar\u00e7At\n\n(3.8)\n\nFigura 3.2 -  Volume de controle elementar no espa\u00e7o transformado\n\nA equa\u00e7\u00e3o acima foi obtida utilizando-se o m\u00e9todo totalmente impl\u00edcito, que avalia as \n\nderivadas espaciais no tempo mais atual. E  necess\u00e1rio ainda avaliar as derivadas dos \n\npotenciais nas faces do volume de controle ( e ,  w , n , s, t ,  b), bem como as mobilidades \n\npresentes nos coeficientes D,\".\n\nAs derivadas dos potenciais s\u00e3o aproximadas por diferen\u00e7as centrais; o que, devido ao \n\nsistema curvil\u00edneo n\u00e3o-ortogonal, gera um esquema num\u00e9rico envolvendo dezenove pontos \n\n(ver Fig. 3.3): o volume P, seis vizinhos diretos ( E , W , N, S, T , B) e doze diagonais (BS, \n\nBW, BE, BN, SW, SE, NW, NE, TS, TW, TN, TE). Os termos diagonais aparecem na \n\navalia\u00e7\u00e3o das derivadas cruzadas do tipo {d<S>w/\u00d4T]\\ ou ip<!>wj d y \\ .\n\nExemplificando, as derivadas do potencial da fase \u00e1gua na face leste s\u00e3o dadas por\n\n\n\nFormula\u00e7\u00e3o Num\u00e9rica 25\n\n\u00f5\n\n\u00f5 \\\nF\u201e\n\no  ! - O\n\u00bb I E  \u00bb I P\n\n(3.9)\n\nd<b? w\n\n\u00e2 x \\\n\n\u00e2 j\n\nK&lt;D 1 + F e<&amp; 1 + F  K&lt;D I + F P<D I + F pO 1 -f-F PO 1 )\n?i s e  * i s e  i E  H e  \u00abh e  \u00bb 1 \u00ab  J15 H s  q p  * #  \u00bb \u00ed n /\n\nAi]\n\n=  E\n\u00cdf e #  I + F e O I + F E O I + F P<D ! + F pO I + F P<t> I )V \u00cdBli \u201cIBE 7E wiE Tie wItE Tb \u201cIB 7P W\u00cdP TT HIt/\n\nAy\n\n(3.10)\n\n(3.11)\n\nFigura 3.3 -  Volumes presentes no esquema num\u00e9rico\n\nOs coeficientes F s\u00e3o chamados de coeficientes de falha e foram introduzidos por \n\nCunha (1996) com o objetivo de criar uma \u00fanica equa\u00e7\u00e3o para todos os volumes da malha; \n\nseja este interno, de fronteira ou vizinho a uma falha geol\u00f3gica. Na verdade, estes coeficientes \n\ns\u00e3o apenas artif\u00edcios computacionais usados para simplificar a codifica\u00e7\u00e3o. Dadas as \n\ncondi\u00e7\u00f5es de contorno e a posi\u00e7\u00e3o das falhas (se houverem), o programa gera estes \n\ncoeficientes automaticamente, que depois ser\u00e3o utilizados na montagem das equa\u00e7\u00f5es. \n\nDetalhes do c\u00e1lculo destes coeficientes s\u00e3o encontrados em Czesnat (1999) e as aproxima\u00e7\u00f5es \n\ndas demais derivadas do potencial da fase \u00e1gua encontram-se no Ap\u00eandice A.\n\nComo j\u00e1 foi visto anteriormente, as mobilidades das fases s\u00e3o iim\u00e7\u00f5es das satura\u00e7\u00f5es. \n\nEstas, por sua vez, s\u00e3o armazenadas nos centros dos volumes de controle. Logo, as\n\n\n\nFormula\u00e7\u00e3o Num\u00e9rica 26\n\nmobilidades tamb\u00e9m est\u00e3o definidas apenas nos centros e necessitam de um m\u00e9todo de \n\ninterpola\u00e7\u00e3o para determinar seus valores nas faces do volume, onde s\u00e3o requeridas pelo \n\nm\u00e9todo num\u00e9rico. Neste trabalho, optou-se pelo m\u00e9todo UDS -  Upstream Differencing \n\nScheme -  devido as suas propriedades de estabilidade e f\u00e1dl implementa\u00e7\u00e3o, al\u00e9m de ser \n\nlargamente empregado nos simuladores comerciais. No entanto, como desvantagem, este \n\nm\u00e9todo apresenta uma consider\u00e1vel difus\u00e3o num\u00e9rica. Exemplos e resultados da aplica\u00e7\u00e3o de \n\noutras fun\u00e7\u00f5es interpola\u00e7\u00e3o mais modernas e precisas s\u00e3o encontrados no trabalho de Czesnat \n\n(1999).\n\nNo esquema UDS, a mobilidade na face assume o valor da mobilidade calculada no \n\ncentro do volume de controle que est\u00e1 atr\u00e1s da face em rela\u00e7\u00e3o ao sentido do escoamento. \n\nSendo assim, supondo que o escoamento dirige-se do volume W para o volume P, a \n\nmobilidade na interface w ser\u00e1 avaliada em W e a da interface e ser\u00e1 avaliada em P . \u00c9 \n\ninteressante salientar ainda que, para o escoamento trif\u00e1sico, deve-se aplicar o esquema para \n\ncada fase, pois estas possuem movimentos independentes. Al\u00e9m disso, em problemas \n\ntridimensionais o m\u00e9todo UDS utiliza uma aproxima\u00e7\u00e3o unidimensional em cada um dos \n\neixos coordenados.\n\nDesta forma, para cada dire\u00e7\u00e3o, tem-se as seguintes aproxima\u00e7\u00f5es:\n\n\u2022 Se (so^/dn)^ &lt;0 , ent\u00e3o\n\ncaso contr\u00e1rio\n\n\u2022 Se (dOp/\u00f5njj &lt;0 , ent\u00e3o\n\nK \\  = K \\P\\e PiP\n\n\u00c2 l  =\u00c0\u201e,\n\n'Mw !p\n\n2  = 2  , l?ls I?s\n\n(3.12)\n\n(3 .13)\n\n(3.14)\n\ncaso contr\u00e1rio\n\n\n\nFormula\u00e7\u00e3o Num\u00e9rica 27\n\n(3.15)\n\n\u2022 Se (dOp/\u00f5njj&lt;0, ent\u00e3o\n\n(3.16)\n\ncaso contr\u00e1rio\n\n(3.17)\n\nNa verdade, para a equa\u00e7\u00e3o do \u00f3leo deve-se aproximar X 00\u00c10 ao inv\u00e9s de apenas \u00c00.\n\n3.3 Sistema de Equa\u00e7\u00f5es N\u00e3o-Lineares\n\nUma vez discretizadas as equa\u00e7\u00f5es, \u00e9 poss\u00edvel agrup\u00e1-las gerando um sistema de \n\nequa\u00e7\u00f5es n\u00e3o-lineares que pode ser escrito na forma\n\nonde n \u00e9 o n\u00famero de volumes na malha computacional. O vetor inc\u00f3gnita x \u00e9 composto de \n\ntodas as vari\u00e1veis dependentes ou inc\u00f3gnitas do problema:\n\nAs n\u00e3o-linearidades presentes na Eq. (3 .18) podem ser divididas em dois grupos:\n\n\u2022 Fracas. Todas as vari\u00e1veis que s\u00e3o fun\u00e7\u00f5es apenas da press\u00e3o de uma fase podem ser \n\nconsideradas n\u00e3o-linearidades fracas. Isto inclui os fatores volume de forma\u00e7\u00e3o, a \n\nraz\u00e3o de solubilidade e as viscosidades.\n\n\u2022 Fortes. Est\u00e3o presentes nas vari\u00e1veis que dependem da satura\u00e7\u00e3o, ou seja, as \n\npermeabilidades relativas e as press\u00f5es capilares.\n\n(3.18)\n\nx = [Pt ZH1 Zo1 P2 Zw2 Zo2 ... Pn Zwn Z j (3.19)\n\n\n\nFormula\u00e7\u00e3o Num\u00e9rica 28\n\nDevido ao tratamento totalmente impl\u00edcito empregado na obten\u00e7\u00e3o das equa\u00e7\u00f5es, todas \n\nas n\u00e3o-linearidades s\u00e3o avaliadas no mesmo n\u00edvel de tempo.\n\nNo pr\u00f3ximo cap\u00edtulo, ser\u00e3o abordados detalhes relativos \u00e0 solu\u00e7\u00e3o de equa\u00e7\u00f5es do tipo\n\n\n\n4 M\u00e9todos de Solu\u00e7\u00e3o de Sistemas de Equa\u00e7\u00f5es N\u00e3o- \nLineares\n\nNeste cap\u00edtulo, inicialmente ser\u00e1 apresentado um breve panorama das v\u00e1rias quest\u00f5es \n\nque podem ser levantadas a respeito da obten\u00e7\u00e3o da solu\u00e7\u00e3o computacional de um sistema de \n\nequa\u00e7\u00f5es n\u00e3o-lineares, para depois introduzir os m\u00e9todos que ser\u00e3o, no cap\u00edtulo seguinte, \n\nempregados na solu\u00e7\u00e3o espec\u00edfica da Eq. (3.18).\n\n4.1 Vis\u00e3o Geral do Problema\n\nDe maneira geral, um sistema de equa\u00e7\u00f5es n\u00e3o-lineares pode ser descrito como a \n\naplica\u00e7\u00e3o de uma transforma\u00e7\u00e3o n\u00e3o-linear, F  R n \\ - ^ R n , do espa\u00e7o linear real n-dimensional \n\nnele mesmo, de tal forma que\n\nF (x) = [/i(4 ---> /n(x)F V x ert\"  (4.1)\n\nA obten\u00e7\u00e3o das solu\u00e7\u00f5es da equa\u00e7\u00e3o acima envolve, ao menos, duas quest\u00f5es de certa \n\nforma entrela\u00e7adas: a an\u00e1lise das propriedades de resolubilidade e o desenvolvimento e estudo \n\nde m\u00e9todos num\u00e9ricos adequados. \u00c9 \u00f3bvio que os resultados de ambas as quest\u00f5es acima \n\ndepender\u00e3o sobretudo das propriedades da fun\u00e7\u00e3o F .\n\nCom rela\u00e7\u00e3o \u00e0s propriedades de resolubilidade do sistema, h\u00e1 no m\u00ednimo outras tr\u00eas \n\nquest\u00f5es que devem ser consideradas\n\na) Existe solu\u00e7\u00e3o em um subespa\u00e7o espec\u00edfico do dom\u00ednio de F ?\n\nb) Quantas solu\u00e7\u00f5es h\u00e1 neste subespa\u00e7o?\n\nc) Qual \u00e9 a estabilidade das solu\u00e7\u00f5es mediante uma pequena varia\u00e7\u00e3o nas condi\u00e7\u00f5es do \nproblema?\n\nMesmo para casos simples, unidimensionais, exemplos mostram que a Eq. (4.1) pode ter \n\nfinitas, infinitas ou nenhuma solu\u00e7\u00e3o, o que d\u00e1 uma id\u00e9ia da import\u00e2ncia de se ter respostas \u00e0s \n\nquest\u00f5es levantadas acima. No entanto, para a maioria dos casos de interesse da engenharia, \n\nobter essas respostas ainda \u00e9 uma tarefa extremamente dif\u00edcil e muitas vezes at\u00e9 imposs\u00edvel.\n\n\n\nM\u00e9todos de Solu\u00e7\u00e3o de Sistemas de Equa\u00e7\u00f5es N\u00e3o-Lineares 30\n\nNa maioria dos casos, a confian\u00e7a em se encontrar a solu\u00e7\u00e3o para um conjunto de equa\u00e7\u00f5es \n\nn\u00e3o-lineares atrav\u00e9s da aplica\u00e7\u00e3o de um determinado m\u00e9todo tem base emp\u00edrica, carecendo de \n\nalgum fundamento te\u00f3rico.\n\nUma vez sabido que (4.1) tem solu\u00e7\u00e3o (ou solu\u00e7\u00f5es), deve-se concentrar aten\u00e7\u00e3o nos \n\nm\u00e9todos para aproxim\u00e1-las. Estes podem ser classificados, quanto ao seu objetivo, em:\n\na) M\u00e9todos de localiza\u00e7\u00e3o, que constroem subespa\u00e7os que cont\u00e9m as solu\u00e7\u00f5es\n\nb) M\u00e9todos que aproximam uma solu\u00e7\u00e3o\n\nc) M\u00e9todos para achar todas as solu\u00e7\u00f5es\n\nEste trabalho se concentra num subgrupo de b). M\u00e9todos da classe c) s\u00e3o dispon\u00edveis \n\napenas para problemas de minimiza\u00e7\u00e3o e os da classe a) s\u00e3o baseados no uso de matem\u00e1tica \n\nintervalar.\n\nNormalmente, m\u00e9todos diretos n\u00e3o s\u00e3o aplic\u00e1veis na solu\u00e7\u00e3o de (4.1), restando apenas a \n\nutiliza\u00e7\u00e3o de m\u00e9todos iterativos. Segundo Rheinboldt (1998), estes m\u00e9todos podem ser, de \n\nforma geral, classificados em:\n\na) M\u00e9todos de lineariza\u00e7\u00e3o\n\nb) Redu\u00e7\u00e3o a equa\u00e7\u00f5es n\u00e3o-lineares mais simples\n\nc) Combina\u00e7\u00e3o de m\u00e9todos\n\nd) M\u00e9todos de Continua\u00e7\u00e3o\n\ne) M\u00e9todos de Minimiza\u00e7\u00e3o\n\nPara o problema espec\u00edfico abordado neste trabalho, os m\u00e9todos das classes a) e c) s\u00e3o \n\nmais apropriados e alguns ser\u00e3o vistos em detalhe mais adiante.\n\nAinda segundo Rheinboldt, ao se analisar um determinado m\u00e9todo iterativo, ao menos \n\nquatro quest\u00f5es de cunho geral devem ser observadas. S\u00e3o elas:\n\na) Sob quais condi\u00e7\u00f5es o processo iterativo est\u00e1 bem definido?\n\nb) Quando as itera\u00e7\u00f5es convergem?\n\nc) No caso de converg\u00eancia, o limite \u00e9 realmente uma solu\u00e7\u00e3o de (4.1)?\n\nd) Qu\u00e3o eficiente \u00e9 o processo?\n\n\n\nM\u00e9todos de Solu\u00e7\u00e3o de Sistemas de Equa\u00e7\u00f5es N\u00e3o-Lineares 31\n\nRheinboldt diz que, fia maioria dos casos, apenas respostas parciais s\u00e3o poss\u00edveis e, em \n\nparticular, o conjunto exato de condi\u00e7\u00f5es iniciais, para as quais um processo iterativo est\u00e1 bem \n\ndefinido ou \u00e9 convergente, \u00e9 muito raro de ser computado. Muito exemplos mostram, que \n\nmesmo existindo um limite para o processo iterativo, este pode n\u00e3o resolver o sistema.\n\nCom rela\u00e7\u00e3o a quest\u00e3o d), sobre a economia ou complexidade computacional do \n\nprocesso iterativo, pode-se ainda desenvolver outras quest\u00f5es relacionadas:\n\na) Qual o \u201ccusto\u201d de uma \u00fanica itera\u00e7\u00e3o?\n\nb) Qu\u00e3o \u201cr\u00e1pido\u201d o processo converge?\n\nc) Qual a \u201csensibilidade\u201d do processo a mudan\u00e7as na transforma\u00e7\u00e3o n\u00e3o-linear, nas \n\ncondi\u00e7\u00f5es iniciais ou na dimens\u00e3o do espa\u00e7o?\n\nQualquer uma destas quest\u00f5es requer antes de tudo uma defini\u00e7\u00e3o mais precisa para os \n\ntermos \u201ccusto\u201d, \u201cr\u00e1pido\u201d e \u201csensibilidade\u201d, o que depender\u00e1 sobretudo da defini\u00e7\u00e3o minuciosa \n\ndos par\u00e2metros usados pelos processos iterativos. Geralmente, quest\u00f5es sobre a economia dos \n\nm\u00e9todos s\u00e3o tratadas apenas de forma relativa, atrav\u00e9s da compara\u00e7\u00e3o direta entre os m\u00e9todos; \n\no que nem sempre \u00e9 t\u00e3o simples, pois cada m\u00e9todo exige uma s\u00e9rie de par\u00e2metros com efeitos \n\ndistintos na taxa de converg\u00eancia. A quest\u00e3o c) \u00e9 a que possui menor chance de ser respondida \n\nde uma forma abrangente, embora, para certos tipos de problema, v\u00e1rios algoritmos \n\ncertamente apresentar\u00e3o alta sensibilidade a mudan\u00e7as no operador ou nas condi\u00e7\u00f5es iniciais. \n\nIsso normalmente acontece devido a presen\u00e7a de singularidades; o que, por si s\u00f3, constitui-se \n\num importante campo de estudos da matem\u00e1tica.\n\n4.2 M\u00e9todos de Newton\n\nNesta se\u00e7\u00e3o ser\u00e3o introduzidos v\u00e1rios m\u00e9todos iterativos desenvolvidos a partir da \n\nlineariza\u00e7\u00e3o da Eq. (4.1), entre eles, o m\u00e9todo de Newton tradicional e v\u00e1rias de suas \n\nderiva\u00e7\u00f5es. Alguns m\u00e9todos, de acordo com a classifica\u00e7\u00e3o de Rheinboldt apresentada \n\nanteriormente, recaem no caso da combina\u00e7\u00e3o de m\u00e9todos iterativos, onde, a cada passo de \n\num primeiro processo iterativo, um segundo processo \u00e9 aplicado.\n\n\n\nM\u00e9todos de Solu\u00e7\u00e3o de Sistemas de Equa\u00e7\u00f5es N\u00e3o-Lineares 32\n\n4.2.1 O Conceito de Lineariza\u00e7\u00e3o\n\nSeja xk e Rn o vetor solu\u00e7\u00e3o na itera\u00e7\u00e3o k do processo iterativo para resolver F(x)= 0 . \n\nA id\u00e9ia do m\u00e9todo de lineariza\u00e7\u00e3o \u00e9 construir uma aproxima\u00e7\u00e3o Lk : Rn Rn tal que\n\nLk{x) = Ak{ x - x k)+F(xk), Ak ^ l {r \") (4.2)\n\nque coincida com F  em xk , e usar o resultado de \u00a3*{*) = 0 como o valor mais recente de x . \n\nConsiderando apenas o caso onde todas as matrizes Ak, k >0  em (4.2) s\u00e3o invers\u00edveis, o \n\nm\u00e9todo de lineariza\u00e7\u00e3o resulta em\n\nx*\" = x* -  Ak'F(xk), k - 0,1,... \n\nque, em termos de algoritmo, traduz-se para a seguinte sequ\u00eancia\n\n1. entra: \u00cd x \\ M j\n2. avaliar F ( x k) ;\n3. construir a matriz Ak ;\n4. resolver Aky  /' (x*) para y ;\n5. se solu\u00e7\u00e3o falha ent\u00e3o retoma: falha;\n6 . xk*l =xk - y ;\n\n(4.3)\n\n(4.4)\n\n7. retorna\n\nonde, M  representa um bloco de mem\u00f3ria contendo todo e qualquer dado necess\u00e1rio ao \n\nprocesso que n\u00e3o seja k e x .\n\nO algoritmo (4.4) representa uma \u00fanica itera\u00e7\u00e3o do m\u00e9todo de lineariza\u00e7\u00e3o e, como nos \n\nprocessos iterativos empregados na solu\u00e7\u00e3o de sistemas lineares, pode ser necess\u00e1rio \n\nintroduzir um fator de relaxa\u00e7\u00e3o (dampingfactor), ou seja, aumentar ou diminuir o passo entre \n\nduas itera\u00e7\u00f5es sucessivas, y , por um fator mk > 0 . Isto significa alterar (4.3) para\n\n= x* -  cokAk'F(xk), k = 0,1,... (4  5)\n\nou, simplesmente, alterar a sexta linha do algoritmo (4.4) para x\u201c  = x k o)ky .\n\n\n\nM\u00e9todos de Solu\u00e7\u00e3o de Sistemas de Equa\u00e7\u00f5es N\u00e3o-Lineares 33\n\n4.2.2 Forma Geral dos M\u00e9todos de Newton\n\nA defini\u00e7\u00e3o do processo de lineariza\u00e7\u00e3o dada na se\u00e7\u00e3o anterior n\u00e3o inclui nenhuma \n\ninforma\u00e7\u00e3o a respeito do mecanismo de constru\u00e7\u00e3o das matrizes Ak em (4.3). Uma forma\n\nnatural e simples de gerar estas matrizes \u00e9 avali\u00e1-las, em cada itera\u00e7\u00e3o k , atrav\u00e9s de xk , ou \n\nseja, fazendo Ak = A(xk) . Estes m\u00e9todos t\u00eam a forma\n\nx M =xk k = 0 ,1,... (4.6)\n\ntamb\u00e9m conhecida como forma de Newton e, cujo membro mais famoso, \u00e9 o M\u00e9todo de \n\nNewton cl\u00e1ssico\n\nx M  = x* k  = 0 ,1,.. (4.7)\n\nonde a aproxima\u00e7\u00e3o Lk de (4.2) \u00e9 obtida truncando-se a expans\u00e3o em s\u00e9rie de Taylor de F , \n\nao redor de xk, depois do termo linear, de maneira que a matriz ./(x*) \u00e9 a matriz Jacobiana\n\nJ ( x ) =\n\n4 ~ f \u00c2 x) \u2014 ~\u00carffe)\u00f5xl \u00f5 x n\n\n4 - f \u00c1 x) -  -jrr f\u00c1*)\u00d4C] \u00f5xn\n\n(4.8)\n\nUma forma mais simples do m\u00e9todo de Newton, conhecida como m\u00e9todo de Newton \n\nmodificado ou paralelo, pode ser obtida for\u00e7ando-se que todas as matrizes Ak sejam id\u00eanticas\n\na matriz Jacobiana obtida na primeira itera\u00e7\u00e3o, j(x\u00b0) . Em outras palavras, este m\u00e9todo possui \n\na forma\n\n= xk -  J  l(x\u00b0)f{x*), k =\u00fcX. . . (4.9)\n\nApesar do menor esfor\u00e7o computacional despendido no c\u00e1lculo das Jacobianas, o \n\nm\u00e9todo de Newton modificado possui uma taxa de converg\u00eancia muito pobre.\n\n4.2.3 M\u00e9todos de Newton Inexatos\n\nQuando o processo de lineariza\u00e7\u00e3o \u00e9 aplicado a um problema com um n\u00famero muito \n\ngrande de equa\u00e7\u00f5es, normalmente provenientes da discretiza\u00e7\u00e3o de um conjunto de equa\u00e7\u00f5es\n\n\n\nM\u00e9todos de Solu\u00e7\u00e3o de Sistemas de Equa\u00e7\u00f5es N\u00e3o-Lineares 34\n\ndiferenciais parciais, toma-se necess\u00e1rio lan\u00e7ar m\u00e3o de um segundo processo iterativo para \n\nresolver a equa\u00e7\u00e3o linear resultante em cada itera\u00e7\u00e3o de maneira eficiente. Um problema que \n\nsurge desta combina\u00e7\u00e3o de processos iterativos \u00e9 escolher como controlar a converg\u00eancia do \n\nsegundo m\u00e9todo. Pode-se especificar a priori algum crit\u00e9rio ou condi\u00e7\u00e3o fixa ou criar alguma \n\nestrat\u00e9gia adaptativa baseada na performance do algoritmo. De toda forma, o m\u00e9rito destes \n\nm\u00e9todos est\u00e1 na relaxa\u00e7\u00e3o da equa\u00e7\u00e3o de Newton cl\u00e1ssica para uma condi\u00e7\u00e3o inexata do tipo\n\n\u00ab l o )\n\nonde T)k e [o,l) e ||| \u00e9 uma norma qualquer. Da\u00ed o fato destes m\u00e9todos serem chamados de \n\nm\u00e9todos de Newton inexatos.\n\nA id\u00e9ia \u00e9 escolher algum r\\k e ent\u00e3o aplicar um solver iterativo na solu\u00e7\u00e3o da equa\u00e7\u00e3o\n\nlinear\n\n(411)\n\nat\u00e9 que a solu\u00e7\u00e3o aproximada sk satisfa\u00e7a (4.10). Neste contexto, % \u00e9 frequentemente \n\nchamado de forcing term (Eisenstat e Walker, 1996), j\u00e1 que seu papel \u00e9 for\u00e7ar que o res\u00edduo \n\nda Eq. (4.11) seja pequeno o suficiente.\n\n\u00c9 importante notar que f (x*)+j (x*)s* \u00e9 tanto o res\u00edduo da Eq. (4.11), quanto a\n\naproxima\u00e7\u00e3o linear para F(xtri) (com x k+x = x k + s k )  atrav\u00e9s da expans\u00e3o em s\u00e9rie de Taylor,\n\ntruncada no termo linear, de F  ao redor de xk. Logo, reduzindo o res\u00edduo linear para \n\nsatisfazer (4.11), se reduz tamb\u00e9m o res\u00edduo n\u00e3o-linear, desde que haja concord\u00e2ncia \n\nsuficiente entre F  e sua aproxima\u00e7\u00e3o linear local.\n\nDembo, Eisenstat e Steihaug (1982) mostram que, pr\u00f3ximo \u00e0 solu\u00e7\u00e3o do sistema de \n\nequa\u00e7\u00f5es n\u00e3o-lineares, a converg\u00eancia local dos m\u00e9todos de Newton inexatos \u00e9 controlada \n\npelos forcing terms. Mais precisamente, pr\u00f3ximo \u00e0 solu\u00e7\u00e3o n\u00e3o-linear, fazendo-se Tjk -> 0 , a \n\ntaxa de converg\u00eancia local \u00e9 q-superlinear (Kheinboldt, 1998). Como se ver\u00e1 no cap\u00edtulo de \n\nresultados, isso depender\u00e1 essencialmente do qu\u00e3o pr\u00f3ximo a matriz Jacobiana \u00e9 aproximada.\n\nAl\u00e9m da garantia de uma boa taxa de converg\u00eancia local pr\u00f3xima \u00e0 solu\u00e7\u00e3o, estes \n\nm\u00e9todos requerem ainda procedimentos que aumentem a probabilidade de converg\u00eancia \n\nquando x\u00b0 n\u00e3o est\u00e1 perto da solu\u00e7\u00e3o. Estes procedimentos s\u00e3o chamados de globaliza\u00e7\u00e3o\n\n\n\nM\u00e9todos de Solu\u00e7\u00e3o de Sistemas de Equa\u00e7\u00f5es N\u00e3o-Lineares 35\n\n(Eiscnstat e Walker, 1994), dentre os quais, o mais difundido e simples de implementar, \u00e9 o \n\nprocedimento de backtracMng, tamb\u00e9m conhecido como linesearch ou damping. Neste \n\nprocedimento, o passo do m\u00e9todo de Newton, sk, \u00e9 encurtado at\u00e9 que seja considerado \n\naceit\u00e1vel, satisfazendo uma determinada condi\u00e7\u00e3o. O algoritmo de backtracking usado neste \n\ntrabalho foi proposto por Eiscnstat e Walker (1996), sendo empregado em diversos outros \n\nsimuladores (Shadid, Tuminaro e Walker, 1997), inclusive em um pacote para solu\u00e7\u00e3o de \n\nquaisquer sistemas de equa\u00e7\u00f5es n\u00e3o-lineares, o NITSOL (Pemice e Walker, 1996). O \n\nalgoritmo, aplicado a uma itera\u00e7\u00e3o do m\u00e9todo de Newton inexato, \u00e9 mostrado abaixo.\n\nNote que, para um dado rjk inicial, existir\u00e1 um sk iniciai se a Eq. (4.11) for consistente,\n\nn\u00e3o for demasiadamente pequeno, espera-se que o algoritmo n\u00e3o falhe. Al\u00e9m disso, pode-se \n\nfacilmente notar que a condi\u00e7\u00e3o ditada pela Eq. (4.10) \u00e9 obedecida por&lt;7 e s definidos no \n\ninterior do la\u00e7o. Logo, o passo final, satisfaz tanto (4.10), quanto\n\n2. determinar S k , com Tjk e (0,7)max ),\n\n3. T}=Vk' s:=sk ; j:= 0 ;\n\nax f a ? a :\n\n5- escolher 0 \u20ac [\u00e9>min, 6>max ] ;\n6 .  \u00cd J : = ( 1 - 0 ) + O t }  ;\n\n(4.12)\nmax\n\n7. s := ;\n8 . se j  > Jmax ent\u00e3o retorna: f  alha;max\n\nparticularmente, se j(x fc) for invers\u00edvel. Se este sk inicial for satisfat\u00f3rio e o ymax escolhido\n\n(4.13)\n\nTomando-se a redu\u00e7\u00e3o final de j|Fj| promovida pelo algoritmo (4.12)\n\n(4.14)\n\ne a redu\u00e7\u00e3o prevista pela aproxima\u00e7\u00e3o linear\n\n\n\nM\u00e9todos de Solu\u00e7\u00e3o de Sistemas de Equa\u00e7\u00f5es N\u00e3o-Lineares 36\n\n(4.15)\n\ne aplicando as condi\u00e7\u00f5es (4.10) e (4.13), vem que\n\nM H *'!\n(4.16)\n\nOu seja, a redu\u00e7\u00e3o em ||f|| promovida pelo procedimento de backtracking \u00e9 ao menos uma \n\nfra\u00e7\u00e3o r  da redu\u00e7\u00e3o prevista pelo modelo linear de ||f]|. Isto agrega a propriedade de \n\nconverg\u00eancia global combinada a possivelmente r\u00e1pida converg\u00eancia local inerente aos \n\nm\u00e9todos de Newton inexatos.\n\nUm resultado importante apontado por Eisenstat e Walker (1994) \u00e9 decorrente do \n\nseguinte teorema:\n\nTeorema 4.1. Assumindo que F  \u00e9 continuamente diferenci\u00e1vel, se a  sequ\u00eancia\n\ne xk ->x*. Al\u00e9m disso, sk e tjk iniciais s\u00e3o aceitos sem modifica\u00e7\u00e3o pelo la\u00e7o para um k  \n\nsuficientemente grande.\n\nLogo, se a sequ\u00eancia de itera\u00e7\u00f5es tiver um limite em que J  \u00e9 invers\u00edvel, ent\u00e3o este \n\ndeve ser a solu\u00e7\u00e3o do sistema de equa\u00e7\u00f5es n\u00e3o-lineares e as itera\u00e7\u00f5es devem convergir para \n\nele. Al\u00e9m disso, pr\u00f3ximo \u00e0 solu\u00e7\u00e3o, o algoritmo n\u00e3o necessitar\u00e1 de backtracking, pois a \n\nconverg\u00eancia \u00e9 governada pelo ijk inicial. Ou seja, perto da solu\u00e7\u00e3o a converg\u00eancia \u00e9 \n\ngovernada pela an\u00e1lise local apresentada por Dembo, Eisenstat e Steihaug (1982) e, portanto, \n\npode ser acelerada escolhendo-se rjk t\u00e3o pequeno quanto necess\u00e1rio. A converg\u00eancia pr\u00f3xima \n\n\u00e0 solu\u00e7\u00e3o do sistema (4.1), tamb\u00e9m \u00e9 chamada de converg\u00eancia assint\u00f3tica.\n\nDe acordo com o que foi visto acima, os termos % (ou forcing terms) n\u00e3o apenas \n\ndeterminam a velocidade da converg\u00eancia assint\u00f3tica, mas tamb\u00e9m afetam a efici\u00eancia e a \n\nrobustez do algoritmo longe da solu\u00e7\u00e3o. Na verdade, longe da solu\u00e7\u00e3o, escolhendo-se % \n\nmuito pequeno e resolvendo a Eq. (4.11) at\u00e9 este n\u00edvel de toler\u00e2ncia pode resultar num passo \n\nsk t\u00e3o grande que f(x* + sk) difere em muito de sua aproxima\u00e7\u00e3o linear F(xfc)+./(x*)v* . Este \n\nproblema \u00e9 conhecido como oversolving (Eisenstat e Walker, 1996). Com isso, pouco ou\n\nproduzida pelo algoritmo (4.12), tem um limite x* em que ,/(x\u2018) \u00e9 invers\u00edvel, ent\u00e3o f(x*)= 0\n\n\n\nM\u00e9todos de Solu\u00e7\u00e3o de Sistemas de Equa\u00e7\u00f5es N\u00e3o-Lineares 37\n\nnenhum progresso na redu\u00e7\u00e3o de j|F| \u00e9 alcan\u00e7ado, o que, consequentemente, levar\u00e1 \u00e0 \n\nexecu\u00e7\u00e3o do procedimento de backtracking. Mesmo que uma redu\u00e7\u00e3o razo\u00e1vel de |F | seja \n\nalcan\u00e7ada, resolver (4.11) com tamanha acur\u00e1cia no in\u00edcio do processo iterativo pode ser \n\nrelativamente oneroso. Uma solu\u00e7\u00e3o mais pobre, al\u00e9m de ser obtida mais rapidamente, pode \n\ngerar maior redu\u00e7\u00e3o em ||/'J, al\u00e9m de usar um menor n\u00famero de itera\u00e7\u00f5es do procedimento de \n\nbacktracking.\n\nNeste trabalho, dois m\u00e9todos adaptativos para a escolha dos forcing terms foram \n\nimplementados e testados com o objetivo de minimizar o oversolving mantendo uma r\u00e1pida \n\nconverg\u00eancia assint\u00f3tica. Ambos foram propostos por Eisenstat e Walker (1996) e s\u00e3o assim \n\ndefinidos:\n\n\u2022  M\u00e9todo 1: Selecionar algum jj0 e ( 0 ,l] e escolher\n\nAl\u00e9m disso, para assegurar que r]k &lt;7 max de acordo com o algoritmo (4.12), ap\u00f3s as \n\nescolhas (4.17) e (4.18) aplica-se a prote\u00e7\u00e3o\n\nPemice e Walker (1996) mostram que, combinando resultados da an\u00e1lise da \n\nconverg\u00eancia local ao Teorema 4.1, obt\u00e9m-se, para o m\u00e9todo 1, converg\u00eancia q-superlinear e \n\n,para o m\u00e9todo 2  com /  &lt;1 , converg\u00eancia da ordem q -a  e, com 7  = 1 , da ordem q - p ,  onde \n\np e [ l,a ) .\n\nAinda de acordo com os trabalhos de Eisenstat e Walker (1996) e Pemice e Walker \n\n(1996), implementou-se as prote\u00e7\u00f5es abaixo, que s\u00e3o aplicadas respectivamente ap\u00f3s (4.17) e\n\n(4.17)\n\nM\u00e9todo 2: Dado um y e\n\n(4.18)\n\n(4.19)\n\n\n\nM\u00e9todos de Solu\u00e7\u00e3o de Sistemas de Equa\u00e7\u00f5es N\u00e3o-Lineares 38\n\n(4.18) e antes de (4.19).\n\n\u2022 Prote\u00e7\u00e3o para o m\u00e9todo 1:\n\n%&lt;- J , se 4k- f ^ 2 > 0 1  (4.20)\n\n\u2022 Prote\u00e7\u00e3o para o m\u00e9todo 2:\n\n%&lt;- maxfefc, m l-i} , se 777^  > 0 .1  (4  2 1)\n\nEstas prote\u00e7\u00f5es t\u00eam o prop\u00f3sito de prevenir que os % iniciais tornem-se muito \n\npequenos longe da solu\u00e7\u00e3o. Note que, pr\u00f3ximo \u00e0 solu\u00e7\u00e3o, rjk -\u00bb 0  por ambos os m\u00e9todos e, \n\nportanto, (4.20) e (4.21) ficam inativas n\u00e3o afetando a converg\u00eancia assint\u00f3t\u00edca.\n\n4.2.4 M\u00e9todos de Krylov-Newton\n\nOs m\u00e9todos de Newton inexatos podem, em princ\u00edpio, empregar qualquer processo \n\niterativo na solu\u00e7\u00e3o da equa\u00e7\u00e3o linear (4.11), todavia h\u00e1 uma classe de m\u00e9todos iterativos que \n\natualmente v\u00eam recebendo maior aten\u00e7\u00e3o. S\u00e3o m\u00e9todos baseados em t\u00e9cnicas de proje\u00e7\u00e3o em \n\nespa\u00e7os de Krylov, que s\u00e3o subespa\u00e7os cujos vetores de base t\u00eam a forma p{A)v, onde p  \u00e9 \n\num polin\u00f3mio ( A \u00e9 a matriz do sistema linear a ser resolvido). M\u00e9todos que se enquadram \n\nnesta categoria s\u00e3o o GMRES -  Generalized Minimum Residual -  de Saad e Schultz (1986), o \n\nTFQMR -  Transpose-Free Quasi-Minimal Residual \u2014 de Freund (1993), o BICGSTAB \u2014 \n\nBiconjugate Gradient Stabilized -  de van der Vorst (1992), entre outros.\n\nUm m\u00e9todo de proje\u00e7\u00e3o qualquer para resolver o sistema linear\n\nAx = b\n\n\u00e9 um m\u00e9todo que procura por uma solu\u00e7\u00e3o xm no subespa\u00e7o x0 + K m de dimens\u00e3o m atrav\u00e9s \n\nda imposi\u00e7\u00e3o da condi\u00e7\u00e3o de Petrov-Galerkin\n\nb - Axm 1  rm m\n\nonde rm \u00e9 outro subespa\u00e7o de dimens\u00e3o m e x0 \u00e9 uma estimativa inicial arbitr\u00e1ria. Um \n\nm\u00e9todo de Krylov \u00e9 um m\u00e9todo cujo subespa\u00e7o Km \u00e9 o subespa\u00e7o de Krylov\n\n\n\nM\u00e9todos de Solu\u00e7\u00e3o de Sistemas de Equa\u00e7\u00f5es N\u00e3o-Lineares 3 9\n\nK m(4 >ro) =  sPank ^  Aro>A l (4.24)\n\nonde r0 =b~ Ax0. A diferen\u00e7a entre os v\u00e1rios m\u00e9todos de Krylov est\u00e1 na escolha do subespa\u00e7o \n\nTm e na maneira como o sistema (4.22) \u00e9 precondicionado.\n\nEmbora todas as variantes do m\u00e9todo de Krylov estarem baseadas no mesmo tipo de \n\naproxima\u00e7\u00e3o polinomial da solu\u00e7\u00e3o, a escolha do subespa\u00e7o Tm, ou seja, a restri\u00e7\u00e3o imposta a \n\nesta aproxima\u00e7\u00e3o, ter\u00e1 um efeito decisivo no processo iterativo. Dois tipos ou classes de Fm \n\ns\u00e3o encontradas na maioria dos m\u00e9todos. A primeira \u00e9 tomar simplesmente Tm = K m ou sua \n\nvariante de m\u00ednimo res\u00edduo Tm = AKm. A segunda \u00e9 criada fazendo r m ser um subespa\u00e7o de \n\nKrylov associado a AT, r m = K m(/4r ,r0) . \u00c9 importante salientar que um \u00fanico m\u00e9todo de \n\nproje\u00e7\u00e3o pode ter uma s\u00e9rie de implementa\u00e7\u00f5es diferentes, dando origem a diferentes \n\nalgoritmos que s\u00e3o matematicamente equivalentes, por\u00e9m com caracter\u00edsticas num\u00e9ricas \n\ndistintas.\n\nEmbora a converg\u00eancia dos m\u00e9todos de Krylov seja bem fundamentada teoricamente \n\n(Saad, 1996), na pr\u00e1tica todos sofrem com uma baixa taxa de converg\u00eancia na solu\u00e7\u00e3o de \n\nsistemas oriundos de problemas de engenharia. O precondicionamento \u00e9 o mecanismo chave \n\nque permite o sucesso destes m\u00e9todos em aplica\u00e7\u00f5es deste tipo, aumentando tanto a efici\u00eancia, \n\nquanto a  robustez dos processos iterativos. O precondicionamento \u00e9 simplesmente um meio de \n\ntransformar o sistema linear original, Eq. (4.22), em um outro sistema que possui a mesma \n\nsolu\u00e7\u00e3o, por\u00e9m \u00e9 mais f\u00e1cil de resolver com um determinado solver. Para se ter uma id\u00e9ia do \n\npoder dos precondicionadores, normalmente a confiabilidade de um determinado solver est\u00e1 \n\nmuito mais ligada ao bom precondicionamento do sistema do que ao processo iterativo de \n\nKrylov usado. Geralmente o precondicionador \u00e9 uma matriz M  que aproxima de alguma \n\nforma a matriz originai A , com a importante exig\u00eancia de que a solu\u00e7\u00e3o de sistemas do tipo \n\nMv = w seja simples e barata. Isso porque os algoritmos que empregam precondicionamento \n\nt\u00eam que resolver sistemas deste tipo a cada itera\u00e7\u00e3o. Para o caso geral, o precondicionamento \n\n\u00e9 aplicado ao sistema (4.22) na forma\n\nonde M e e M  D s\u00e3o, respectivamente, as matrizes de precondicionamento \u00e0 esquerda e \u00e0\n\nM e AMd u =M~'b\n(4.25)\n\n\n\nM\u00e9todos de Solu\u00e7\u00e3o de Sistemas de Equa\u00e7\u00f5es N\u00e3o-Lineares 40\n\ndireita. Se M E = I , tem-se o precondicionamento \u00e0 direita e o res\u00edduo fica inalterado, todavia, \n\nse M d = I , tem-se o precondicionamento \u00e0 esquerda e res\u00edduo altera-se para\n\nrE  = M E h  M\u201e}Ax=ME1r (4.26)\n\nEste res\u00edduo, que tamb\u00e9m aplica-se ao caso geral da Eq. (4.25), \u00e9 chamado de res\u00edduo \n\nprecondicionado. Neste caso, geralmente controla-se a converg\u00eancia do processo iterativo \n\natrav\u00e9s da norma do res\u00edduo precondicionado, ao inv\u00e9s da norma do res\u00edduo propriamente \n\ndito, devido o c\u00e1lculo deste \u00faltimo necessitar da multiplica\u00e7\u00e3o pela matriz M E, encarecendo o \n\nalgoritmo.\n\nH\u00e1 v\u00e1rios bons precondicionadores dispon\u00edveis, cada um com propriedades e aplica\u00e7\u00f5es \n\ndistintas. Uma das formas mais simples e eficiente de montar um precondicionador \u00e9 atrav\u00e9s \n\nda fatora\u00e7\u00e3o incompleta da matriz A . Isto pode ser feito decompondo-se A na forma \n\nA - L U - R ,  onde L e U t\u00eam a mesma estrutura de n\u00e3o-zeros das partes inferior e superior, \n\nrespectivamente, de A ; R \u00e9 a matriz res\u00edduo ou erro da fatora\u00e7\u00e3o. Este tipo de fatora\u00e7\u00e3o \u00e9 \n\nconhecida como ELU(0) ou fatora\u00e7\u00e3o incompleta de n\u00edvel zero e tem como vantagens ser de \n\nconstru\u00e7\u00e3o simples e r\u00e1pida. Por outro lado, pode ser uma aproxima\u00e7\u00e3o pobre, fazendo com \n\nque o m\u00e9todo de Krylov associado necessite de v\u00e1rias itera\u00e7\u00f5es para convergir. Visando evitar \n\neste problema, v\u00e1rias alternativas de fatora\u00e7\u00e3o LU incompleta foram desenvolvidas atrav\u00e9s da \n\nintrodu\u00e7\u00e3o de mais elementos n\u00e3o-nulos \u2014 ou fill-in  \u2019s - e m  L e V . Em geral, fatora\u00e7\u00f5es mais \n\nprecisas requerem um menor n\u00famero de itera\u00e7\u00f5es do solver, por\u00e9m a montagem do \n\nprecondicionador tem um custo computacional mais elevado. Neste trabalho utilizou-se o \n\nalgoritmo denominado BILU(/), que \u00e9 uma fatora\u00e7\u00e3o adaptada a matrizes de blocos (ver \n\npr\u00f3ximo cap\u00edtulo) baseada no conceito de n\u00edvel (Saad, 1996). Para dar uma id\u00e9ia simplificada \n\ndo conceito de n\u00edvel, quanto maior o valor de /, maior \u00e9 o n\u00famero de fill-in  \u2019s em L e U e \n\nconsequentemente mais precisa ser\u00e1 a fatora\u00e7\u00e3o.\n\nTanto o precondicionador, quanto os m\u00e9todos de Krylov usados neste trabalho s\u00e3o \n\nfornecidos pela biblioteca de dom\u00ednio p\u00fablico PETSc (Balay ei a i, 1997, 2000) desenvolvida \n\ne mantida pela Divis\u00e3o de Matem\u00e1ticas e Ci\u00eancias da Computa\u00e7\u00e3o do Laborat\u00f3rio Nacional de \n\nArgonne nos E.U.A..\n\n\n\nM\u00e9todos de Solu\u00e7\u00e3o de Sistemas de Equa\u00e7\u00f5es N\u00e3o-Lineares 41\n\n4.2.5 Montagem da Matriz Jacobiana\n\nA matriz Jacobiana \u00e9 formada pelas derivadas parciais da fun\u00e7\u00e3o res\u00edduo com rela\u00e7\u00e3o \u00e0s \n\nvari\u00e1veis do problema (ver Eq. (4.8)). Sendo n a dimens\u00e3o do problema, para o caso geral, \n\ntem-se n2 derivadas a  serem avaliadas. Problemas envolvendo a discretiza\u00e7\u00e3o de equa\u00e7\u00f5es de \n\nconserva\u00e7\u00e3o, por exemplo, geralmente possuem dimens\u00e3o elevada, por\u00e9m apresentam a  matriz \n\nJacobiana esparsa; sobretudo se malhas estruturadas s\u00e3o empregadas. Nestes casos, devido \u00e0 \n\ncomplexidade das equa\u00e7\u00f5es, pode ser vantajoso aproximar a matriz Jacobiana numericamente \n\nusando diferen\u00e7as finitas. Este procedimento \u00e9 caracter\u00edstica dos m\u00e9todos denominados de \n\nm\u00e9todos de Newton discretizados ou discretos (Rhcinboldt, 1996). Casos particulares destes \n\nm\u00e9todos, muito populares atualmente, s\u00e3o os m\u00e9todos matrix-free, assim chamados por n\u00e3o \n\ncriarem a matriz Jacobiana diretamente. Ao inv\u00e9s disso, estes m\u00e9todos aproximam o produto \n\nJacobiana-vetor necess\u00e1rio aos m\u00e9todos de Krylov.\n\nUsando diferen\u00e7as finitas de primeira ordem, tem-se:\n\n/\u00cdA - H x + hv) ~ H x)J \\ X ) v - ---------- -----------  (4.27)\n\nonde h \u00e9 uma pequena perturba\u00e7\u00e3o e v \u00e9 um vetor de base qualquer do espa\u00e7o de Krylov.\n\nNeste trabalho optou-se por calcular a perturba\u00e7\u00e3o h atrav\u00e9s do m\u00e9todo proposto por \n\nPemice e Walker (1998), onde\n\nS rel (4.28)\nHl\n\ne erel \u00e9 a raiz quadrada do erro relativo presente no c\u00e1lculo da fun\u00e7\u00e3o res\u00edduo F , cujo valor \n\nutilizado neste trabalho foi 1 (T8, devido \u00e0 fun\u00e7\u00e3o ser avaliada com dupla precis\u00e3o.\n\nOs m\u00e9todos matrix-free t\u00eam a vantagem de n\u00e3o precisarem guardar a matriz Jacobiana. \n\nPor outro lado, h\u00e1 o problema da limita\u00e7\u00e3o do tipo de precondicionador que pode ser usado \n\nnestes m\u00e9todos, j\u00e1 que n\u00e3o h\u00e1 matriz a ser precondicionada. No cap\u00edtulo seguinte, ser\u00e1 \n\napresentado um m\u00e9todo matrix-free com precondicionamento da equa\u00e7\u00e3o linear com base em \n\numa aproxima\u00e7\u00e3o da matriz Jacobiana calculada apenas para esse fim.\n\nH\u00e1 v\u00e1rias outras maneiras poss\u00edveis de se aproximar a matriz Jacobiana, muitas delas \n\nenvolvendo caracter\u00edsticas espec\u00edficas do problema num\u00e9rico abordado. M\u00e9todos deste tipo \n\ns\u00e3o comumente chamados de quase-newtonianos (Pueyo e Zingg, 1997, 1998; Blanco e\n\n\n\nM\u00e9todos de Solu\u00e7\u00e3o de Sistemas de Equa\u00e7\u00f5es N\u00e3o-Lineares 42\n\nZingg, 1997). No pr\u00f3ximo cap\u00edtulo, ser\u00e1 apresentado um m\u00e9todo quase-newtoniano reportado \n\npor Maliska et al. (1997), em que a matriz Jacobiana gerada por um modelo Black~Oil padr\u00e3o, \n\ndiscretizado por volumes finitos em coordenadas generalizadas, \u00e9 aproximada apenas pelos \n\ntermos ortogonais.\n\n\n\n5 M\u00e9todos de Krylov-Newton Aplicados \u00e0 Solu\u00e7\u00e3o das- \nEqua\u00e7\u00f5es do Modelo Black-Oil Padr\u00e3o\n\nNeste cap\u00edtulo ser\u00e3o apresentadas tr\u00eas vers\u00f5es do m\u00e9todo de Krylov-Newton, que \n\nutilizam-se de determinadas caracter\u00edsticas espec\u00edficas da Eq. (3.18). Ser\u00e3o tamb\u00e9m abordados \n\nalguns aspectos de implementa\u00e7\u00e3o e outros detalhes num\u00e9ricos, tais como: obten\u00e7\u00e3o das \n\nderivadas das fun\u00e7\u00f5es residuais, controles de converg\u00eancia e detalhes relativos ao problema \n\ntransiente.\n\n5.1 Lineariza\u00e7\u00e3o das Equa\u00e7\u00f5es Discretizadas\n\nAplicando o m\u00e9todo de lineariza\u00e7\u00e3o de Newton, Eq. (4.7), ao sistema n\u00e3o-linear (3.18), \n\nformado pelas equa\u00e7\u00f5es discretizadas impl\u00edcitas do modelo Black-Oil padr\u00e3o, obt\u00e9m-se o \n\nseguinte sistema linear n x n  (n \u00e9 n\u00famero de volumes na malha)\n\nonde,\n\n. Js = \u2014F (51)\n\n\u00f5F f \u00f4Ff \u00d4F/1\n\u00d5Z0\u00b03\n\n\u00d5Fw1 dFtw \u00d4F\u201d1\naz*-,\n\n\u00d4F\u00b01 dF\u00b0 dF'\u00b0\na* \u00f5Z\u201e.\n\n(5.2)\n\n\u00ef; =\nP - P fc-i\n\nfc-1\n\nZO\u00cd Z0l\nfc-i\n\n(5-3)\n\nF; =\nPi\nF w1\nE\u00b0\n\n(5-4)\n\n\n\nM\u00e9todos de Krylov-Newton Aplicados \u00e0 Solu\u00e7\u00e3o das- Equa\u00e7\u00f5es do Modelo Black-Oil Padi\u00e3o 44\n\nOs superescritos p , w e o de F referem-se, respectivamente, \u00e0s fun\u00e7\u00f5es res\u00edduo das equa\u00e7\u00f5es \n\nda press\u00e3o, da \u00e1gua e do \u00f3leo.\n\nO sistema (5.1) tem a caracter\u00edstica de ser um sistema esparso formado por blocos de \n\nmatrizes densas 3x3. Outra caracter\u00edstica importante \u00e9 que cada equa\u00e7\u00e3o de blocos envolve \n\napenas os blocos correspondentes ao esquema num\u00e9rico de 19 volumes da malha curvil\u00ednea \n\nestruturada, gerando uma estrutura de matriz de banda com 19 diagonais (ver Fig. 5.1). \n\nAmbos solver e precondicionador podem tirar proveito destas caracter\u00edsticas visando criar \n\nalgoritmos mais eficientes. O armazenamento da matriz \u00e9 feito atrav\u00e9s do formato BCRS -  ou \n\nBlock Compressed Row Storage (Barret et a l, 1994) -  onde os Mocos n\u00e3o-zeros s\u00e3o \n\ncompactados em cada linha e agrupados em sequ\u00eancia, utilizando dois conjuntos de \u00edndices \n\nque indicam a linha e coluna do primeiro elemento de cada bloco.\n\nFigura 5.1 \u2014 Matriz de 19 diagonais (Ex.: malha 4x4x3)\n\nAnalisando mais de perto a equa\u00e7\u00e3o linearizada da \u00e1gua no ponto P , tem-se:\n\n\u00f5f:\n\u00f4R\n\nAPp + AZWP +\n\\ \u00f5Zopj\n\n\u00e0zoP +\n\nZm\n\n\\\n\n\u00e2P, \u00d4Z dZ,\nAZ.\n\n'o?NB /\n\n(5.5)\n\u2014  \u2014 J?*--ID\n\nonde NB representa todos os vizinhos considerados no esquema num\u00e9rico (W , E, N, S, B,\n\nT , SW, SE, NW, NE, BS, BW, BE, BN, TS, TW, TE, T N )e  F\" =Fpw(P,Zw, Z j  \u00e9 dada \n\npor\n\n\n\nM\u00e9todos de Krylov-Newton Aplicados \u00e0 Solu\u00e7\u00e3o das- Equa\u00e7\u00f5es do Modelo Black-Oil Padr\u00e3o 45\n\nd * I d ;, ' \u00ed<i>- \u2022 d ;,11 i Z o  -1 * O\n&lt;7 \u00c7  &lt;7 T | * ? y\n\n1?1 -IV 12 - -t-l? 13\u00cd?T| \u00e2 y\n+\n\nD \u00a3 ^ + D \u00a3 ^ + D \u00a3 -  -\n<7\u00c7 *7?]&lt;7y\n\nD ? . - ^  + D - ^  + D ' ^\nac, OT\\ o y\n\nd - ^ + k \u00a3 ^ + d -  ^\n\n(5,6)\n\n+\n\n31 32 ^  33 3\na c ,  o i \\  o y\n\nD\" ^  + D?, + D*'3 1  ^ e 1 * *  32 o  33 o<7\u00c7&lt;7t|&lt;7y\n\nObserve que na equa\u00e7\u00e3o acima assumiu-se um volume computacional com \n\n= Atj = k y  = 1; suposi\u00e7\u00e3o esta que deve ser levada em considera\u00e7\u00e3o na gera\u00e7\u00e3o da malha \n\ngeneralizada, todavia n\u00e3o representa nenhum tipo de restri\u00e7\u00e3o quanto a generalidade da \n\nmesma.\n\nVisando tomar as equa\u00e7\u00f5es das derivadas desta fun\u00e7\u00e3o mais compactas, define-se as \n\nderivadas normais dos potenciais nas interfaces do volume de controle\n\n5 0 ,\nSn\n\n5 0  \u201e\n\u00f4n 'li\n\n- +  G\n\n>13\n\n12 + G\n\n\u00f5 y\n\n\u00f5O\u201e\n13\n\n\u00f5 y\n\n(5.7)\n\n(5.8)\n\n\u00d5Q>,\n\u00f4n\n\nG21\nd%,\ndt.\n\n+ G22\nd %\n\u00f4ti\n\n- +  G\ndO,\n\n23 \u00f5y (5.9)\n\nSO,\nSn\n\nG\ndO.\n\n21 + G\n5 0 ,\n\n22 Si]\n- + G.\n\n5 0 ,\n23 Sy (5.10)\n\n5 0 ,\n<9n dt,\n\n'3 2 '3 3 Sy (5.11)\n\n\n\nM\u00e9todos de Krylov-Newton Aplicados \u00e0 Solu\u00e7\u00e3o das- Equa\u00e7\u00f5es do Modelo Black-Oil Padr\u00e3o 46\n\n5<D\n\u00f5n\n\n+ g 32\u2014\u2014 + g 33\n\u00d5T\\ \u00f5y (5.12)\n\nonde,\n\nD?\nGfi= \u2014  J \u00c3\u201e (5.13)\n\ne n \u00e9 o vetor ortogonal \u00e0 face n\u00e3o normalizado.\n\nComo exemplo de derivadas da fun\u00e7\u00e3o res\u00edduo da \u00e1gua, ser\u00e3o apresentadas aqui apenas \n\nas derivadas com rela\u00e7\u00e3o as vari\u00e1veis prim\u00e1rias P , Z w e Z0 nos pontos P , E e N E . S\u00e3o elas:\n\n\u2022 Derivadas da fan\u00e7\u00e3o res\u00edduo da \u00e1gua com rela\u00e7\u00e3o \u00e0s vari\u00e1veis prim\u00e1rias no ponto P :\n\n\u00d5FPW Z\n\n\u00d5Pp JP\n\n\u00f5 \u00ae w 'Mn\n\u00f5n n \u00d5P-p\n\nF .(- \u00bbK lle\n\nK V \u2019* 1 3\n\n*\\(P wj Fp 3,lt \u00ab\n\n- + ?\nJp \u00d5PV\n\n- + \u00f5O.\n5n\n\n\u00d4\u00c3. \u00f4\u00ae..\n\u00d5Pr, \u00f5n\n\nd\u00c3\n\u00d5PD\n\n- +\n\n50..\n\u00f5n\n\n-D *  ^ 2 2\n\n52\n\u00d5PB \u00f5n\n\n\u00d5\u00c3.\u00bb'It 50\u201e\n5i> \u00f5n\n\n52w!b\nb\n\n+\n\n+ D.32\n\nw 1\n\nr jH? p/id5 L ^ p + d \u00bb L + d \u00aeLi \u00cd i-,+\nid3.l c + d ^ l f; p + d 33\n\n(5-14)\n\n\u00f5<$>w |p\n\n\u00d5Pr,\n\n\u00d5Fl\n\u00d5Zw p Jp A\u00ed p X + Z\"V\n\ndp,tn j p\n\u00d5Z\n\n+ -\n1 dmwjp \u00d5\u00c2,\n\n50>\n\n[\n\n\u00f5n\n\nF.\nF\n\n\u00d5\u00c0.. 5\u00ae\n\u00d5Z \u00f5n\n\n\u00f5X\\\n\n\u00d5Z\n\nW P y\n\na o\n\ndZw ? \u00f5n\n\u00f5\u00ae\n\n\u00d5Zw p dn\n\u00d5\u00c1J\n\u00d5Z\n\n-+\nWp\n\nwp \u00f5n\n\u00f5A\u201e \u00f5\n\u00d5Z \u00f5n\n\nU \" | .  F ,(d\u00bb|_ + D ,'|.F \u00cd P + Dr3|_ F ' J\n\n- d =L+D4 F.pp)-F. k K +D\u00bbI.+d = K ) +\nk . | , Ft ,  + d 3\u201d |,f ' p - Ds | , ) - Fb(i>ri|bF |P + d s |1f \u00ed p +D r , |J\n\n\u00d5\u00c3,Wlb\nb  5 Z WP\n\n+\n\nm w|p\n\u00d5Zw p\n\n(5.15)\n\n\n\nM\u00e9todos de Kiylov-Newton Aplicados \u00e0 Solu\u00e7\u00e3o das- Equa\u00e7\u00f5es do Modelo Black-Oil Padr\u00e3o 47\n\naz.op JpA\u00ed \u00f4Zop Jp \u00e0ZoP\n+ -\n\ndn\n0<D\u201e\n\n\u00f4n\n\nF.\n\ndK 50..\ndZ.\n\n( D\nID*1 \\ 2\n\no p \u00f4n \u00d5Z\nao\u201e\n\no p\n\u00f5n\n\ndK\n;SZt\n\nao\u201e\n<?p \u00f5n\n\n\u00f2K\naz.\n\n-+\no p\n\n\u00f4z.op da\n\u00d5\u00c3,\n\n\u00bb I b\n\nb  \u00d4 Z 0 p\n+\n\n+  DfJ Fnp + D f3 Ff12 ijp O 7p) - F .( D ,- L + Dr2|, F ; p + Drs|wFfp),\n\n) - F. f e K +D = L +D * I X p ) +\n\nF .k L FiP+ d \u00bb|,f'p -D s j.J -n k L 'ip  +d\u00bbLf\u00cdp +D' i )\n\na o Wflp\n\u00d5Zop\n\n(5.16)\n\nDerivadas da fun\u00e7\u00e3o res\u00edduo da \u00e1gua com rela\u00e7\u00e3o \u00e0s vari\u00e1veis prim\u00e1rias no ponto E ;\n\na/<T \u00f4 o u\n\u00d4P,\n\na i\nan\n\nF- ^ \" L +D''L ,? E +D .\"L,f E)+\n\nf efe .n \u00ed,|. - F,D ',|, * \u00ab M | ,  -F bD r,|J\n\n\u00d5PX\n- +\n\na o \u00ab'lE\napc\n\n(5.17)\n\n\u00f5J\u00c7\n9ZwE\n\nf.(o ;\n\nao,.\n\u00f5n \n\n+ D\n\ndK\n\u00d5Zw\u00a3\n\nF 1+\n. 7 e /\n\n'S E (fnD21 f; d 21 +Ft Dr, -F D *fe 31 | J\n\na o ,\nazw>E\n\n<5.18)\n\nf,(d\n\nao^\n\u00f5n\n\n+ -Ds\n\n\u00f5 K\naz.\n\nII\n\nki\u00ae 2i\n\n12\n\no E\n\n,F\u00cd b + \u00b0 .'L * f e ) +\nED 21 + F.DJ ?d '.L)\n\nao (5.19)w|E\naz?oE\n\n\u2022 Derivadas da fun\u00e7\u00e3o res\u00edduo da \u00e1gua com rela\u00e7\u00e3o \u00e0s vari\u00e1veis prim\u00e1rias no ponto\n\n\n\nM\u00e9todos de Kryiov-Newton Aplicados \u00e0 Solu\u00e7\u00e3o das- Equa\u00e7\u00f5es do Modelo Black-Oil Padr\u00e3o 48\n\n(5.21)\n\n(5.22)\n\nResta ainda avaliar as derivadas de Xp, X 00X0,&lt;E>,&lt;f>pm e p m. Devido a complexidade\n\nde se obter estas derivadas analiticamente (equa\u00e7\u00f5es muito grandes), optou-se por avali\u00e1-las \n\nnumericamente atrav\u00e9s de diferen\u00e7as finitas de primeira ordem. Para tanto, utilizou-se a \n\nsugest\u00e3o de Cunha (1996), em que perturba\u00e7\u00f5es iguais a 0,00 IP e 0,0 lZp (10\u201cs, se \n\nZ&lt;0,001) s\u00e3o usadas para a aproxima\u00e7\u00e3o das derivadas com rela\u00e7\u00e3o, respectivamente, \u00e0 \n\npress\u00e3o e \u00e0s fra\u00e7\u00f5es m\u00e1ssicas.\n\n5.2 Os m\u00e9todos de Kryiov-Newton\n\nO primeiro m\u00e9todo de Kryiov-Newton proposto surge da aplica\u00e7\u00e3o direta do algoritmo \n\n(4.12) em conjunto com algum processo iterativo de Krylov (GMRES, BICGSTAB, TFQMR, \n\netc) para resolver a equa\u00e7\u00e3o linearizada (5.1). Neste m\u00e9todo a matriz Jacobiana \u00e9 montada \n\ncomo foi mostrado na se\u00e7\u00e3o 5.1. Todos os termos das equa\u00e7\u00f5es res\u00edduo s\u00e3o considerados \n\nimpl\u00edcitos (mesmo n\u00edvel iterativo), gerando uma matriz com 19 diagonais.\n\nUm segundo m\u00e9todo, proposto e testado por Maliska et al. (1997) e aplicado tamb\u00e9m \n\npor Cunha (1996) e Czesnat (1999), \u00e9 derivado de uma aproxima\u00e7\u00e3o da matriz Jacobiana em \n\nque apenas os termos ortogonais (P , W , E , S, N , B, T ) s\u00e3o considerados. Isto \u00e9 feito \n\ntomando todas as derivadas cruzadas dos potenciais em rela\u00e7\u00e3o a \u00a3 , ij e y expl\u00edcitas, ou seja, \n\navaliando-as no n\u00edvel iterativo anterior. Desta forma, derivadas do tipo\n\n(5.23)\n\nser\u00e3o consideras nulas.\n\nNeste caso, as equa\u00e7\u00f5es (5 .14) a (5 .22), ficam da seguinte forma:\n\n\n\nM\u00e9todos de Kryiov-Newton Aplicados \u00e0 Solu\u00e7\u00e3o das- Equa\u00e7\u00f5es do Modelo Black-Oil Padr\u00e3o 49\n\nDerivadas da fun\u00e7\u00e3o res\u00edduo da \u00e1gua com rela\u00e7\u00e3o \u00e1s vari\u00e1veis prim\u00e1rias no ponto P :\n\ndFpw _ Z wp V 1 dmm / p  , 1 w|p d<D\ndPp Jp A\u00ed \u00f5Pp JP \u00d5Pp \u00f5n\n\n\u00d5\u00c3\u201e d<D\u201e\n\u00d4PV> \u00f5n\n\n\u00d5\u00c3\u201e\n\u00d5Pn\n\nd<\u00ed>\ndn\n\n(peDn\n\n\u00d5PD \u00f5n\n\u00d5L\ndPD \u00f5n\n\ndJL d \u00ae\n\u00f4/p \u00f5n\n\n\u00d5\u00c2.\u00ab1b\n(5.24)\n\n+ F Dn + F D *i n  2 2 + F D \u20191' + F D 14 +? rtL\u00bb33jt + rb l\u00bb 3 3\n\\d<DM\u2019|p\n\nb/ ap\u201e\n\n\u00d5F'\n\u00d5ZWP Ip A\u00ed\n\n\u00e0pmiP 1 I 3/ww]p \u00d4<Dj \u00f4 l w|e 0<nj S K\n\u00d5Z\n\na # \u201e\ndn\n\n\u00d5\u00c1 d<\u00ed>\ndZ \u00f5n\n\ndJL\n\u00d5Z\n\nwP y \n\nd<t>\n\nJp aZwp\n\nwp \u00f4n\nd l\n\na\u00bb |e az. \n\n\u00d5\u00c2.\n\nwp an 1 az.wp\n\n\u00d5Zwp \u00f5n b\n\n(FeD d  + F wD d  + FnD \u201d +FsD .d  + F tD3W3| +FbD 3- !  }\nv l e  l w  n  Is  l t  I b '\n\n00\u00bb\n\n\u00d5Z..\nwlp\n\n(5.25)\n\n\u00d5KP \u2014 . (&amp;zw)p dPm\\\u00a5 , i a/\u00ab,\nazoP\n\nm Jp\nJp a? azop\n\n+ - \"\u00cdP\nJp dZop dn\n\n\u00d5\u00c0\u201e, dO>\n\nd<D.\ndn\n\nd l dO>.\ndZ.OP dn\n\na;.\n\ndZ.\n- + \u2022\n\ndO\u201e\n\nOP dn\nd\u00c0. dO\u201e\n\no p \u00f5n\n\nd \u00c3 j\n\u00d5Z.o p\n\ndZop dn\nd/L\n\nb 5ZoP\n(5.26)\n\nf a n l  +FwDn! +FnD d  + FSD\u201d | +FtD\u00a3| +Fb\n' Ir  I w  in lc llt\n\n1 Y\nO\n\ndO\u201e\ndZOP\n\n\u2022  Derivadas da fun\u00e7\u00e3o res\u00edduo da \u00e1gua com rela\u00e7\u00e3o \u00e0s vari\u00e1veis prim\u00e1rias no ponto E :\n\n\n\nM\u00e9todos de Kiylov-Newton Aplicados \u00e0 Solu\u00e7\u00e3o das- Equa\u00e7\u00f5es do Modelo Black-Oil Padr\u00e3o 50\n\nd i\u00e7'\nd Z o E  0 0\n\n\u00f4\u00e2J .\n\u2014 = t  + FeDrJ ----\u2014dZ r \u00ea>Z\u201e (5-29)\n\n\" ' \u00f4 E  oE\n\n\u2022 Derivadas da fun\u00e7\u00e3o res\u00edduo da \u00e1gua com rela\u00e7\u00e3o \u00e0s vari\u00e1veis prim\u00e1rias no ponto\n\nNE:\n\n\u00d41\u00c7  \u00d5\u00cd\u00c7 = \u00d51\u00c7  ()\ndPm ~ \u00f4zwm~\u00f5z0m&lt;5-30>\n\nA Fig. 5.2 mostra um esquema da estrutura hepta-diagonal da matriz Jacobiana. \u00c9 \n\nimportante ter mente que, para malhas ortogonais, a matriz Jacobiana aproximada toma-se \n\nexata.\n\nFigura 5.2 -  Matriz de 7 diagonais (Ex.: malha 4x4x3)\n\nMaliska et al. (1997) sugerem este m\u00e9todo de Newton aproximado, ou quase- \n\nnewtoniano, para malhas quase-ortogonais, indicando que, com o aumento da n\u00e3o- \n\nortogonalidade e, consequentemente, o empobrecimento da aproxima\u00e7\u00e3o, provavelmente \n\nhaveria dificuldade de converg\u00eancia. No entanto, carecia-se de um estudo mais aprofundado \n\ndo real efeito da n\u00e3o-ortogonalidade neste m\u00e9todo. Quest\u00f5es do tipo:\n\na) H\u00e1 realmente uma diferen\u00e7a significativa entre o m\u00e9todo Quase-Newtoniano de \n\nMaliska et al. e o m\u00e9todo de Newton com a  Jacobiana completa do ponto de vista da \n\nperformance para malhas razoavelmente n\u00e3o-ortogonais?\n\nb) Se h\u00e1 diferen\u00e7a, at\u00e9 que grau de n\u00e3o-ortogonalidade \u00e9 mais interessante usar um ou\n\n\n\nM\u00e9todos de Kiylov-Newton Aplicados \u00e0 Solu\u00e7\u00e3o das- Equa\u00e7\u00f5es do Modelo Black-Oil Padr\u00e3o 51\n\noutro m\u00e9todo?\n\nEste trabalho visa lan\u00e7ar alguma luz sobre estas indaga\u00e7\u00f5es e o resultado encontra-se no \n\ncap\u00edtulo seguinte.\n\nUma contribui\u00e7\u00e3o importante deste trabalho, ainda n\u00e3o mencionada, \u00e9 a introdu\u00e7\u00e3o de \n\num novo m\u00e9todo baseado na mesma proposta de Maliska et al. para uma aproxima\u00e7\u00e3o da \n\nmatriz Jacobiana. Este m\u00e9todo \u00e9 uma variante dos m\u00e9todos matrix-free, introduzidos no \n\ncap\u00edtulo 4, onde a matriz Jacobiana completa (19 diagonais) \u00e9 aproximada por diferen\u00e7as \n\nfinitas de primeira ordem (ou melhor, aproxima-se o produto Jacobiana-vetor), enquanto a \n\nmatriz aproximada (7 diagonais) \u00e9 utilizada apenas como matriz de precondicionamento. A \n\ngrande virtude deste m\u00e9todo \u00e9 combinar caracter\u00edsticas, tanto do m\u00e9todo de Newton Inexato \n\ncompleto, quanto do m\u00e9todo de Maliska et a i. Atrav\u00e9s do algoritmo matrix-free tem-se o \n\nefeito da Jacobiana completa, sem, no entanto, a necessidade de cri\u00e1-la e armazen\u00e1-la, \n\nmantendo a Jacobiana aproximada, mais simples, para se ter um bom precondicionamento. \n\nEsta t\u00e9cnica, adaptada aqui ao problema da n\u00e3o-ortogonalidade, foi desenvolvida no contexto \n\ndas fun\u00e7\u00f5es interpola\u00e7\u00f5es (Gropp e Keyes, 1992; Chin et al., 1992; Johnson, McHugh e Knoll, \n\n1992, 1996; Blanco e Zingg, 1997; Pueyo e Zingg, 1998). Neste caso, aproxima-se a matriz \n\nJacobiana por um m\u00e9todo de primeira ordem, enquanto as fun\u00e7\u00f5es res\u00edduo s\u00e3o discretizadas \n\npor m\u00e9todos de alta ordem. Esta t\u00e9cnica \u00e9 denominada defect correction.\n\n5.3 Controle Autom\u00e1tico do Passo de Tempo\n\nUm aspecto important\u00edssimo da simula\u00e7\u00e3o de reservat\u00f3rios \u00e9 que o problema \u00e9 \n\nessencialmente transiente e o hist\u00f3rico da extra\u00e7\u00e3o de \u00f3leo \u00e9 um resultado chave para o estudo \n\ndo reservat\u00f3rio. Sendo assim, a solu\u00e7\u00e3o precisa das vari\u00e1veis em cada passo de tempo \u00e9 a \n\nnorma neste tipo de problema e sua obten\u00e7\u00e3o est\u00e1 diretamente associada \u00e0 magnitude deste \n\npasso de tempo.\n\nUma boa escolha para o passo de tempo deve assegurar estabilidade e erros de \n\ntruncamento dentro do aceit\u00e1vel. Ambos os requisitos s\u00e3o, ao menos qualitativamente, \n\nrelacionados \u00e0 taxa de varia\u00e7\u00e3o da press\u00e3o e das satura\u00e7\u00f5es no reservat\u00f3rio. Quanto mais \n\nr\u00e1pidas s\u00e3o essas varia\u00e7\u00f5es, menor deve ser o passo de tempo usado. Por exemplo, o passo de \n\ntempo usado na simula\u00e7\u00e3o de um reservat\u00f3rio contendo um \u00fanico po\u00e7o pode variar de 0,01\n\n\n\nM\u00e9todos de Kiylov-Newton Aplicados \u00e0 Solu\u00e7\u00e3o das- Equa\u00e7\u00f5es do Modelo Black-Oil Padr\u00e3o 52\n\ndias logo ap\u00f3s uma mudan\u00e7a dr\u00e1stica de vaz\u00e3o at\u00e9 v\u00e1rios meses quando o reservat\u00f3rio est\u00e1 \n\npr\u00f3ximo ao esgotamento (Aziz e Settari, 1979).\n\nO problema da estabilidade \u00e9 em grande parte resolvido pela solu\u00e7\u00e3o impl\u00edcita das\n\nequa\u00e7\u00f5es, todavia a correta escolha do passo de tempo visando amenizar os erros de \n\ntruncamento \u00e9 uma tarefa dif\u00edcil de ser realizada manualmente. Neste trabalho, utilizou-se um \n\nesquema para a escolha autom\u00e1tica do passo de tempo baseado em controles emp\u00edricos como \n\nsugerido por Aziz e Settari (1979). Neste esquema, o At escolhido para a pr\u00f3xima itera\u00e7\u00e3o \n\nser\u00e1\n\ne A\u00edmax, Atmm, AS\u2019]irn e A/? ]m s\u00e3o par\u00e2metros fornecidos pelo usu\u00e1rio.\n\nColocando de outra forma, a rela\u00e7\u00e3o acima quer dizer que o m\u00ednimo passo de tempo \n\nentre os valores permitidos pela varia\u00e7\u00e3o da press\u00e3o e satura\u00e7\u00e3o, Atp e A\u00eds (respectivamente), \n\ndeve respeitar a seguinte rela\u00e7\u00e3o\n\nSe A o u  A , ao final de um time step, forem maiores do que os valores limites \n\nestipulados o passo de tempo \u00e9 rejeitado e reinicia-se a simula\u00e7\u00e3o com um novo passo de \n\ntempo menor dado pela Eq. (5.31).\n\nComo ser\u00e1 evidenciado no cap\u00edtulo seguinte, o fato da simula\u00e7\u00e3o ser transiente traz \n\ncaracter\u00edsticas novas ao problema ri\u00e3o-linear. Uma caracter\u00edstica \u00f3bvia \u00e9 que agora passam a \n\nser v\u00e1rios problemas n\u00e3o-lineares resolvidos em sequ\u00eancia e n\u00e3o apenas um. Outra \n\ncaracter\u00edstica \u00e9 que a estimativa inicial de cada m\u00e9todo de Newton \u00e9, na realidade, a  solu\u00e7\u00e3o \n\ndo passo de tempo anterior e, dependendo do controle imposto ao passo de tempo (mais ou \n\nmenos restritivo) esta estimativa pode estar razoavelmente pr\u00f3xima \u00e0 solu\u00e7\u00e3o buscada. Ou\n\nmax ,0,5Ar\\miii , A\u00edF,2Af* }}} (5.31)\n\ncom\n\nik\n(5.32)\n\n(5.33)\n\nA\u00ednun ^  A\u00ed7 2 ?  min {A\u00edp , Ats } &lt;2Atk &lt;A/max (5.34)\n\n\n\nM\u00e9todos de Kiylov-Newton Aplicados \u00e0 Solu\u00e7\u00e3o das- Equa\u00e7\u00f5es do Modelo Black-Oil Padr\u00e3o 53\n\nseja, com controles restritivos do passo de tempo, a converg\u00eancia dos m\u00e9todos de Newton \n\ninexatos est\u00e1 sempre muito pr\u00f3xima do regime assint\u00f3tico, dispensando o backtracking.\n\n5.4 Outros Detalhes Relativos \u00e0 Implementa\u00e7\u00e3o\n\nEsta se\u00e7\u00e3o trata de alguns detalhes num\u00e9ricos importantes ainda n\u00e3o abordados.\n\nO uso de dmm e&lt;9max na linha 5 do algoritmo (4.12) para determinar, respectivamente, a \n\nmenor e a maior redu\u00e7\u00e3o permitida para o passo do m\u00e9todo de Newton inexato \u00e9 uma t\u00e9cnica \n\nconhecida na \u00e1rea de otimiza\u00e7\u00e3o como safeguarded backtracking. Normalmente utiliza-se os \n\nvalores de 0,1 e 0,5 e 0 e \\dmm, 0max ] \u00e9 determinado de forma a minimizar um polin\u00f3mio de \n\nsegundo grau p (y), que satisfaz\n\nAl\u00e9m disso, utilizou-se rjmax = 0,9, que \u00e9 um valor razoavelmente grande, permitindo \n\nque os ?jk \u2019s possam tomar-se elevados, se necess\u00e1rio, evitando o oversolving. Utilizou-se \n\nainda * = 10^, permitindo que praticamente todos os passos que promovam alguma redu\u00e7\u00e3o \n\nem ||F|| sejam aceitos sem backtracking.\n\nA converg\u00eancia do m\u00e9todo newtoniano \u00e9 declarada quando\n\nO primeiro crit\u00e9rio prov\u00ea p  d\u00edgitos de acur\u00e1cia quando a magnitude da vari\u00e1vel\n\n(5.35)\n\nou seja,\n\ne -\n(5.36)\n\ne (5.37)\n\n\n\nM\u00e9todos de Kiylov-Newton Aplicados \u00e0 Solu\u00e7\u00e3o das- Equa\u00e7\u00f5es do Modelo Black-Oil Padr\u00e3o 54\n\nprim\u00e1ria \u00e9 maior do que 1 (press\u00e3o) e p  d\u00e9cimos de acur\u00e1cia quando a vari\u00e1vel \u00e9 menor do \n\nque 1 (fra\u00e7\u00e3o m\u00e1ssica) (Dennis Jr. e Schnabel, 1983), onde p \u00e9  o expoente da toler\u00e2ncia em \n\n(5.37). Foi usado um valor de 6 para p .\n\nO n\u00famero m\u00e1ximo de passos permitidos no procedimento de backtracking, j mx. , \u00e9 8.\n\n\n\n6 Resultados e Discuss\u00f5es\n\nNeste cap\u00edtulo, os diferentes m\u00e9todos de Newton-Kiylov apresentados anteriormente s\u00e3o \n\ntestados, analisados e comparados em diversos problemas com diferentes n\u00edveis de n\u00e3o- \n\nortogonalidade da malha.\n\nEstes problemas foram divididos em tr\u00eas se\u00e7\u00f5es:\n\n\u2022  Valida\u00e7\u00e3o da implementa\u00e7\u00e3o. Aborda a compara\u00e7\u00e3o entre as solu\u00e7\u00f5es obtidas com os \n\nm\u00e9todos de Kiylov-Newton implementados e a reportada em um caso encontrado na \n\nliteratura envolvendo uma malha n\u00e3o-ortogonal.\n\n\u2022 Paralelep\u00edpedo deformado. Analisa e apresenta os resultados de uma s\u00e9rie de \n\nproblemas baseados na deforma\u00e7\u00e3o tridimensional gradativa de um reservat\u00f3rio \n\ncartesiano, envolvendo o escoamento bif\u00e1sico imisc\u00edvel \u00e1gua-\u00f3leo com diferentes \n\ncurvas de permeabilidade relativa.\n\n\u2022 Reservat\u00f3rio real. Apresenta os resultados de cada m\u00e9todo de Newton inexato para \n\num escoamento semelhante ao anterior em um reservat\u00f3rio dotado de uma geometria \n\nmais real\u00edstica com uma distribui\u00e7\u00e3o heterog\u00eanea de n\u00e3o-ortogonalidade na malha \n\ngerada.\n\n6.1 Valida\u00e7\u00e3o da Implementa\u00e7\u00e3o\n\nEsta se\u00e7\u00e3o tem por objetivo apresentar a valida\u00e7\u00e3o da implementa\u00e7\u00e3o dos tr\u00eas m\u00e9todos \n\nde Kryiov-Newton introduzidos nos cap\u00edtulos anteriores com base em um caso colhido na \n\nliteratura, conhecido como problema dos 3 po\u00e7os.\n\nEste problema, originalmente proposto por Hegre et al. (1986), foi utilizado por Czesnat \n\n(1999) para estudar o efeito de orienta\u00e7\u00e3o de malha. Sua principal caracter\u00edstica consiste no \n\nposicionamento sim\u00e9trico dos po\u00e7os produtores com rela\u00e7\u00e3o ao po\u00e7o injetor como mostra a \n\nFig. 6.1, sendo que a malha utilizada cria um caminho preferencial para o avan\u00e7o da frente de \n\n\u00e1gua entre o po\u00e7o produtor 2 e o po\u00e7o injetor (ver Fig. 6.2).\n\nComo \u00e9 mostrado na Fig. 6.2, a malha utilizada neste caso possui um \u00e2ngulo constante\n\n\n\nResultados e Discuss\u00f5es 56\n\nde 4.5\u00b0 entre as linhas 2, e T], sendo, portanto, n\u00e3o-ortogonal. Devido a esta caracter\u00edstica, \n\noptou-se por adotar os resultados obtidos por Czesnat com o m\u00e9todo UDS como par\u00e2metro de \n\nvalida\u00e7\u00e3o dos m\u00e9todos de Krylov-Newton implementados.\n\nP r o d u t o r  .1\n\nI m j e t o r\n\nP r o d u t o r  2\n\nFigura 6.1 -  Distribui\u00e7\u00e3o e configura\u00e7\u00e3o dos po\u00e7os\n\n? Po\u00e7o Injetor \n\u2022  Po\u00e7o Produtor\n\n/ / / / / / / / / / / / /  /  / ? /  /  /  / /  / /  / /  /\n\nFigura 6.2 -  Malha utilizada para o caso dos 3 po\u00e7os (24x10)\n\nAs tabelas 6.1 e 6.2 mostram os dados do problema.\n\nTabela 6.1 -  Dados do problema dos 3 po\u00e7os\n\nDados Valor\n\nPress\u00e3o inicial P M = 2,725 x IO7 Pa (3952 psi)\n\nSatura\u00e7\u00e3o inicial de \u00e1gua s ' :  =o,o\n\nPorosidade &lt;S = \u00ab U l + ^ - ^ ) J\n\nPorosidade de refer\u00eancia A r  =0.W\n\nCompressibilidade da rocha C r  = 4,35 X10 10 l/Pa&lt;3 x 10^ 1/psi)\n\n\n\nResultados e Discuss\u00f5es 57\n\nPress\u00e3o de refer\u00eancia = 1,0135 xlO5 Pa (14,7 psi)\n\nDensidade da \u00e1gua p \u2122  =996,96 kg/m3\n\nDensidade do \u00f3leo = 740,76kg/m3\n\nViscosidade da \u00e1gua f i w= 5 x  1 0 4Ns/m2 (0,5cp)\n\nViscosidade do \u00f3leo ju0 = 2 x W 3 Ns/m2 (2,0cp)\n\nFator volume de forma\u00e7\u00e3o \n(FVF) B - - i +Cp( p - Pj\n\nFVF de refer\u00eancia da \u00e1gua B f =  1,0\n\nFVF de refer\u00eancia do \u00f3leo B f  =0,96\n\nCompressibilidade da \u00e1gua cw = 4,35 X I O 50 l/Pa (3 x 10^ 1/psi)\n\nCompressibilidade do \u00f3leo co = 1,45x10-9 1 / P a ( l x l 0 51/psi)\n\nPermeabilidade absoluta kx = ky = k z = 4,935 x 1 0 14 m2 (50 mD)\n\nVaz\u00e3o do injetor 3. 53xl0'3 m3/s (1920 STB/dias)\n\nVaz\u00e3o nos produtores 1.84x10'3 m3/s (1000 STB/dias)\n\nAt 129600 s (1.5 dias)\n\nTabela 6.2 -  Permeabilidade relativa do problema dos 3 po\u00e7os\n\nS\" K\"' Kro\n\n0.25 0 0.92\n\n0.3 0.02 0.705\n\n0.4 0.055 0.42\n\n0.5 0.1 0.24\n\n0.6 0.145 0.11\n\n0.7 0 0\n\nPara cada um dos tr\u00eas grupos de m\u00e9todos de Krylov-Newton, foram usados o seguintes \n\nsolvers de Krylov: GMRES(r), TFQMR e BICGSTAB. O GMRES(r) \u00e9 uma varia\u00e7\u00e3o do\n\n\n\nResultados e Discuss\u00f5es 58\n\nGMRES tradicional onde a base de Krylov constru\u00edda pela algoritmo tem dimens\u00e3o m\u00e1xima r, \n\numa vez atingida a dimens\u00e3o m\u00e1xima o processo \u00e9 reiniciado. Todos os algoritmos s\u00e3o \n\nprecondicionados com o BILU(n) e tr\u00eas valores de n foram testados: 0, 1 e 2.\n\n\u00c9 interessante observar que, como este caso \u00e9 bidimensional, a matriz Jacobiana \n\ncompleta tem na realidade 9 diagonais e a matriz aproximada apenas 5.\n\nTodos os casos apresentaram exatamente os mesmo resultados. A Fig. 6.3 mostra os \n\ngr\u00e1ficos do corte de \u00e1gua (raz\u00e3o entre a vaz\u00e3o de \u00e1gua e a vaz\u00e3o de l\u00edquido \u2014 \u00e1gua+\u00f3leo \u2014 que \n\npassa por um po\u00e7o) nos po\u00e7os produtores para os tr\u00eas tipos de m\u00e9todos de Krylov-Newton \n\ndiscutidos no cap\u00edtulo anterior e tamb\u00e9m os obtidos por Czesnat (1999). Todos os m\u00e9todos de \n\nKrylov-Newton mostrados na figura utilizam o GMKES(30) com BILU de n\u00edvel 1 como \n\nprecondicionador. Como era esperado, simplesmente n\u00e3o h\u00e1 diferen\u00e7a entre as solu\u00e7\u00f5es, \n\nmostrando que a implementa\u00e7\u00e3o dos m\u00e9todos est\u00e1 correta.\n\n1.0 r\n\nQ8 -\n\nQ6 -\n\nCO ZJ \nD )\u2022<0 \n0)TJ\n<D\u20ac\nQ\n\u00fc  Q4\n\n02\n\nao\n\nCzesnat (1999) - po\u00e7o alinhado \nCzesnat {1999} - po\u00e7o n\u00e3o-al\u00ednhado \n5 diag. - po\u00e7o alinhado \n5 diag. - po\u00e7o n\u00e3o-al\u00ednhado \n9 diag. - po\u00e7o al inhado \n9 diag. -  po\u00e7o n\u00e3o-al\u00ednhado \nmatrix-free -po\u00e7o alinhado \nmatrix-free - po\u00e7o n\u00e3o-al\u00ednhado\n\n1000 'Smn 3Q0Q 4000\n\ntempo (dias)\nSDQQ eooo\n\nFigura 6.3 - Gr\u00e1fico do corte de \u00e1gua nos po\u00e7os produtores\n\n\n\nResultados e Discuss\u00f5es 59\n\n6.2 Paralelep\u00edpedo Deformado\n\nNesta se\u00e7\u00e3o, ser\u00e3o apresentados os resultados referentes \u00e0 aplica\u00e7\u00e3o dos m\u00e9todos de \n\nKrylov-Newton, vistos no cap\u00edtulo 5, em uma s\u00e9rie de casos baseados em reservat\u00f3rios em \n\nforma de paralelep\u00edpedo deformado por um \u00e2ngulo a  como \u00e9 mostrado na Fig. 6.4. a  \u00e9 o \n\n\u00e2ngulo entre \u00a3, e rj e tamb\u00e9m entre y  e o plano \u00a3 - 77, que coincide com o plano x-y (n\u00e3o \n\nmostrado na figura). Com isso todos os Gy (Eq. (5.13)) s\u00e3o n\u00e3o-nulos para a &lt;7t/2 e \n\nconsequentemente a matriz Jacobiana completa possui 19 diagonais n\u00e3o-nulas.\n\n\u00c7\n\nFigura 6.4 - Geometria e malha utilizadas nos testes\n\nO comprimento das arestas nas dire\u00e7\u00f5es \u00a3  e r] \u00e9 de 1 km e o comprimento na dire\u00e7\u00e3o y \n\nvaria de acordo com o \u00e2ngulo a  de maneira que todos os reservat\u00f3rios simulados tenham o \n\nmesmo volume igual a 107m3 . Conforme \u00e9 ilustrado na Fig. 6.4, h\u00e1 dois po\u00e7os localizados em \n\ncantos opostos da maior diagonal do paralelep\u00edpedo: um injetor e um produtor. O po\u00e7o injetor \n\nintroduz \u00e1gua a uma vaz\u00e3o constante de 1920 barris/dia (3,53x10 3m V s ) no reservat\u00f3rio, \n\nenquanto o po\u00e7o produtor extrai a mesma vaz\u00e3o de l\u00edquido, que pode ser apenas \u00f3leo, \n\n\u00e1gua+\u00f3leo ou apenas \u00e1gua dependendo do tempo da simula\u00e7\u00e3o. Esta configura\u00e7\u00e3o caracteriza \n\na simula\u00e7\u00e3o de um m\u00e9todo de recupera\u00e7\u00e3o denominado secund\u00e1rio (Mezzomo, 1992), onde \n\n\u00e1gua (ou g\u00e1s) \u00e9 injetada no interior do reservat\u00f3rio com o objetivo de manter a press\u00e3o \n\nelevada e deslocar o petr\u00f3leo para os po\u00e7os produtores.\n\nUtilizou-se uma malha estruturada generalizada do tipo \u201ccartesiana uniforme\n\n\n\nResultados e Discuss\u00f5es 60\n\ndeformada\u201d (ver Fig. 6.4) com 15x15x5 ( \u00c7 x r j x y  ) volumes. O po\u00e7o injetor est\u00e1 localizado no \n\nvolume (1, 1, 1) e o produtor, no volume (15, 15, 5). Todas as fronteiras s\u00e3o consideradas \n\nimperme\u00e1veis e as vaz\u00f5es m\u00e1ssicas nos po\u00e7os s\u00e3o introduzidas no modelo matem\u00e1tico \n\ndiretamente atrav\u00e9s dos termos fonte/sumidouro. O escoamento \u00e9 bif\u00e3sico, envolvendo \n\nsomente \u00e1gua e \u00f3leo. Optou-se por n\u00e3o introduzir o componente g\u00e1s no modelo, j\u00e1 que isso \n\nn\u00e3o iria acrescentar muito \u00e0 an\u00e1lise feita e, por outro lado, aumentaria em muito os tempos de \n\ncomputa\u00e7\u00e3o. Os efeitos gravitacionais e de capilaridade foram negligenciados.\n\nAs curvas de permeabilidade relativa do sistema \u00e1gua-\u00f3leo s\u00e3o dadas pelas seguintes \n\nequa\u00e7\u00f5es\n\n/ \\ (  S \u2014 S\n* \u201e ( s ' h K  - -\n\nv1 S wc Sor\n\n1 - 9  -  V\nV  wc or J\n\n(6 .1)\n\n(6 .2)\n\nonde, k\u00b0m \u00e9 a permeabilidade relativa da \u00e1gua para a satura\u00e7\u00e3o de 1 - Sor;\n\nk\u00b0ro \u00e9 a permeabilidade relativa do \u00f3leo para a satura\u00e7\u00e3o de \u00e1gua irredut\u00edvel;\n\nS wc \u00e9 a satura\u00e7\u00e3o de \u00e1gua irredut\u00edvel;\n\nSor \u00e9 a satura\u00e7\u00e3o de \u00f3leo residual; \n\nnw e no s\u00e3o expoentes.\n\nEstes e outros dados relativos ao modelo f\u00edsico do problema est\u00e3o condensados na tabela\n\n6.3.\n\nTabela 6.3 -  Dados do modelo f\u00edsico (Paralelep\u00edpedos Deformados)\n\nPados Valor\n\nPress\u00e3o inicial P m = 2,725 x 107 Pa (3952 psi)\n\nSatura\u00e7\u00e3o inicial de \u00e1gua S ? =  0,0\n\nPorosidade\n\nPorosidade de refer\u00eancia ^ = 0 ,1 9\n\n\n\nResultados e Discuss\u00f5es 61\n\nCompressibilidade da rocha cr = 4,35 x I O 10 l/Pa (3 x 10^ 1/psi)\n\nPress\u00e3o de refer\u00eancia Pref = l,0135xl05Pa (14,7 psi)\n\nDensidade da \u00e1gua =996,96 kg/m3\n\nDensidade do \u00f3leo p f D = 740,76 kg/m3\n\nViscosidade da \u00e1gua jnw -  5 x 1 0 4Ns/m2 (0,5cp)\n\nViscosidade do \u00f3leo fia -  2 x 10-3 Ns/m2 (2,0cp)\n\nFator volume de forma\u00e7\u00e3o \n(FVF)\n\nB rf\nB \" 1 +cr ( r - p j\n\nFVF de refer\u00eancia da \u00e1gua B ? =  10\n\nFVF de refer\u00eancia do \u00f3leo B f  =0,96\n\nCompressibilidade da \u00e1gua cw = 4,35xlO\u201c10 l/Pa ( 3 x l 0 61/psi)\n\nCompressibilidade do \u00f3leo co = 1,45x10\u201c\u00ae l/Pa (lx lO  51/psi)\n\nPermeabilidade absoluta kx =ky = k , =  4,935 x 10 14 m2 (50 mD)\n\nAcelera\u00e7\u00e3o da gravidade g  = 0,0 m2/s\n\nPress\u00e3o capilar do sistema \n\u00e1gua-\u00f3leo PCtm= o fi\n\nSatura\u00e7\u00e3o de \u00e1gua irredut\u00edvel * w = o ,o\n\nSatura\u00e7\u00e3o de \u00f3leo residual ^  = 0,0\n\nk\u00b0 k\u00b0mv \"> ro k l = K = l , 0\n\nVaz\u00e3o de inje\u00e7\u00e3o/produ\u00e7\u00e3o q  = 3,53 x 10 3 m3/s (1920 STB/dias)\n\nA simula\u00e7\u00e3o \u00e9 encerrada ap\u00f3s atingir 2 VPI (Volume Poroso Injetado), ou seja, ap\u00f3s a \n\ninje\u00e7\u00e3o de um volume de \u00e1gua equivalente a duas vezes o volume poroso do reservat\u00f3rio. Foi \n\nusado um passo de tempo vari\u00e1vel de acordo com o m\u00e9todo descrito na se\u00e7\u00e3o 5.3 com \n\nA^cai = ld ia e  Atm  =20dias.\n\nOs principais par\u00e2metros f\u00edsicos que foram alterados de problema em problema s\u00e3o:\n\n\n\nResultados e Discuss\u00f5es 62\n\n\u2022 \u00c2ngulo de deforma\u00e7\u00e3o do reservat\u00f3rio, a  : Visa avaliar o peso das diagonais extras \n\nna matriz Jacobiana em problemas n\u00e3o-ortogonais. Quanto menor o valor de a , \n\nmaior \u00e9 a n\u00e3o-ortogonalidade da malha. Foram testados casos com valores de a  \n\niguais a 30\u00b0, 45\u00b0, 60\u00b0, 80\u00b0 e 90\u00b0. Observe que, para a  =90\u00b0, tem-se uma malha \n\ncartesiana ortogonal e, portanto, a mesma matriz Jacobiana de apenas 7 diagonais \n\nser\u00e1 usada por todos os m\u00e9todos.\n\n\u2022 Expoentes nw e no das curvas de permeabilidade relativa: Visa avaliar o peso da \n\nn\u00e3o-linearidade das equa\u00e7\u00f5es. Neste caso, foi usado apenas um \u00fanico expoente \n\nn = nw ~ no Quanto maior o valor de n , maior \u00e9 a n\u00e3o-linearidade do sistema de \n\nequa\u00e7\u00f5es. Foram testados casos com valores de n iguais a 1,5, 2,0, 2,5, 3,0, 3,5 e 4,0.\n\nOs par\u00e2metros num\u00e9ricos, que s\u00e3o fixados para todos os casos testados, est\u00e3o resumidos \n\nna tabela 6.4. As demais op\u00e7\u00f5es, tais como o solver do sistema linear, n\u00edvel de fill-in  do BELU, \n\nbacktracking e forcing terms, ser\u00e3o analisados individualmente nas pr\u00f3ximas se\u00e7\u00f5es. Observe \n\nque as condi\u00e7\u00f5es de converg\u00eancia impostas tanto ao problema n\u00e3o-linear a cada passo de \n\ntempo, quanto ao problema transiente podem ser consideradas razoavelmente restritivas.\n\nTabela 6.4 -  Dados do modelo num\u00e9rico (Paralelep\u00edpedos Deformados)\n\nDado Valor\n\nM\u00e1x. n\u00famero de itera\u00e7\u00f5es do m\u00e9todo \nde Krylov-Newton\n\n500\n\nM\u00e1x. n\u00famero de itera\u00e7\u00f5es do solver \nlinear\n\n100\n\nExpoente das toler\u00e2ncias (Eq. (5.37)) p  = 6\n\nVaria\u00e7\u00e3o limite aceit\u00e1vel para a \npress\u00e3o\n\n\u00c2 P ^ = 5,0 x 104Pa (72,52 psi)\n\nVaria\u00e7\u00e3o limite aceit\u00e1vel para a \nsatura\u00e7\u00e3o\n\n0,005\n\nPasso de tempo inicial = ld\u00eda\n\nPasso de tempo m\u00ednimo A*,n,cal = 0,01 dia\n\nPasso de tempo m\u00e1ximo Afmax = 20 dias\n\n\n\nResultados e Discuss\u00f5es 63\n\n6.2.1 Backtracking e Forcing terms\n\nNesta se\u00e7\u00e3o, procurou-se, para cada m\u00e9todo de Krylov-Newton, avaliar as vantagens, se \n\nhouverem, da introdu\u00e7\u00e3o de backtracking e dos m\u00e9todos de escolha dos forcing terms \n\nsugeridos por Eisenstat e Walker (1994,1996) e apresentados no cap\u00edtulo 4.\n\nAs tabelas 6.5 e 6.6 apresentam os resultados, respectivamente, com e sem backtracking \n\npara um reservat\u00f3rio deformado de 45\u00b0 e com v\u00e1rios valores do expoente das satura\u00e7\u00f5es. Em \n\nambas foram utilizados o m\u00e9todo de Krylov-Newton com a matriz Jacobiana completa com 19 \n\ndiagonais, GMRES com restart (base contendo no m\u00e1ximo 25 vetores), BILU de n\u00edvel 0 e o \n\nm\u00e9todo 1 para escolha dos forcing terms.\n\nComo j\u00e1 era esperado, a condi\u00e7\u00e3o necess\u00e1ria ao in\u00edcio do backtracking praticamente n\u00e3o \n\n\u00e9 atingida e, mesmo quando \u00e9, o efeito do backtracking \u00e9 t\u00eanue, podendo ser desprezado. Isso \n\npode ser explicado pelo fato do problema ser transiente. Neste tipo de problema a limita\u00e7\u00e3o \n\ndas varia\u00e7\u00f5es de press\u00e3o e satura\u00e7\u00e3o \u00e9 ditada pelo passo de tempo e a estimativa inicial do \n\nm\u00e9todo de Newton \u00e9 a pr\u00f3pria solu\u00e7\u00e3o convergida do passo de tempo anterior. Isso mant\u00e9m a \n\ntaxa de converg\u00eancia sempre pr\u00f3xima do regime assint\u00f3tico.\n\nTabela 6.5 -  a  \u2014 45\u00b0 , com backtracking c m\u00e9todo 1 \n(19 diag., GMRES(25), BILU 0)\n\nCaso Iter. Newton M\u00e9dia Iter. Solver M\u00e9dia Bkt CPU\n\n\u00ab= 1,5 3959 3 51265 44 2 33,0\n\n\u00bb = 2 ,0 6324 3 58737 33 0 55,4\n\n\u00ab = 2 ,5 9323 4 72433 31 3 90,8\n\n\u00ab = 3,0 11557 4 82788 30 3 118,5\n\n\u00bb = 3,5 13213 4 88724 29 1 143,2\n\nIIs 14657 4 91519 27 I 5 153,3\n\nTabela 6.6 -  a  = 45\u00b0 , sem backtracking e m\u00e9todo 1 \n(19 diag., GMRES(25), BILU 0)\n\nCaso Iter. Newton M\u00e9dia Iter. Solver M\u00e9dia Bkt CPU\n\n\u00bb = 1,5 3966 3 51691 44 0 33,2\n\n\u00ab = 2 ,0 6324 3 58737 33 0 55,7\n\n\n\nResultados e Discuss\u00f5es 64\n\n\u00ab = 2 ,5 9364 4 72503 31 0 92,4\n\n\u00ab = 3 ,0 11558 4 82906 30 0 120,5\n\n\u00ab = 3,5 13211 4 88718 29 0 148,1\n\n\u00ab = 4 ,0 14638 4 91424 27 0 160,6\n\nO algoritmo de backtracking tamb\u00e9m foi testado nos m\u00e9todos que utilizam a matriz \n\nJacobiana aproximada com 7 diagonais, todavia os resultados obtidos foram muito ruins. \n\nNeste caso, o problema foi de excesso de backtracking, levando a tempos de CPU proibitivos. \n\nAnalisando o processo de converg\u00eancia chegou-se a conclus\u00e3o de que o problema \u00e9 intr\u00ednseco \n\nao algoritmo proposto por Eisenstat e Walker, j\u00e1 que este \u00e9 embasado teoricamente na \n\nlineariza\u00e7\u00e3o exata promovida pela matriz Jacobiana completa.\n\nNas tabelas 6.7 a 6.15 \u00e9 feita uma compara\u00e7\u00e3o entre os m\u00e9todos de escolha dos forcing \n\nterms para v\u00e1rios casos com diferentes \u00e2ngulos a  e valores de n . Testou-se os dois m\u00e9todos \n\npropostos por Eisenstat e Walker (1996), sendo que, para o m\u00e9todo 2, empregou-se y  = 0,9 e \n\na  ~ 1,5, que prov\u00ea uma converg\u00eancia assint\u00f3tica de ordem-q igual a 1,5. Al\u00e9m disso, testou- \n\nse tamb\u00e9m duas escolhas fixas para os forcing terms: rjk = 10\u201c2, que prov\u00ea apenas uma \n\nacur\u00e1cia moderada na solu\u00e7\u00e3o da equa\u00e7\u00e3o linear em cada passo do Newton inexato e \n\nrjk = 10 4, que d\u00e1 uma solu\u00e7\u00e3o bem mais apurada para a equa\u00e7\u00e3o linear e uma r\u00e1pida \n\nconverg\u00eancia assint\u00f3tica pr\u00f3ximo \u00e0 solu\u00e7\u00e3o.\n\nAs tabelas 6.7 a 6.9 mostram os resultados obtidos para o m\u00e9todo de Krylov-Newton \n\nbaseado na matriz Jacobiana completa. Todos empregam o GMEES(25) com BILU 0 na \n\nsolu\u00e7\u00e3o da equa\u00e7\u00e3o linear. Com exce\u00e7\u00e3o dos casos onde \u00ab = 1,5, a melhor escolha para os \n\nforcing terms foi t]k = 10 2. Pela observa\u00e7\u00e3o do n\u00famero de itera\u00e7\u00f5es newtonianas e do solver \n\nlinear, fica evidente que os outros m\u00e9todos sofrem com o problema de oversolving. Note que, \n\npara r]k = 10 2, apesar do maior n\u00famero de itera\u00e7\u00f5es newtonianas, o n\u00famero de itera\u00e7\u00f5es na\n\nsolu\u00e7\u00e3o da equa\u00e7\u00e3o linear \u00e9 sensivelmente menor. A quest\u00e3o que surge \u00e9: por que, neste caso, \n\nos m\u00e9todos adaptativos, que deveriam evitar o oversolving, sofrem mais com este problema do \n\nque o m\u00e9todo fixo? A resposta a esta quest\u00e3o novamente passa pela an\u00e1lise do problema \n\ntransiente. A Fig. 6.5 mostra a distribui\u00e7\u00e3o de itera\u00e7\u00f5es no solver linear ao longo da simula\u00e7\u00e3o \n\npara o m\u00e9todo 1 e para?^ = 10 2. Inicialmente, at\u00e9 aproximadamente VPI 0,6, h\u00e1 uma\n\n\n\nResultados e Discuss\u00f5es 65\n\noscila\u00e7\u00e3o do n\u00famero de itera\u00e7\u00f5es no solver, que depois fica relativamente estabilizada. \n\nPrincipalmente nesta \u00faltima fase da simula\u00e7\u00e3o, o m\u00e9todo 1 faz mais itera\u00e7\u00f5es no solver. O \n\ngr\u00e1fico da Fig. 6.6 apresenta a evolu\u00e7\u00e3o do passo de tempo ao longo da simula\u00e7\u00e3o. Note que a \n\nregi\u00e3o de oscila\u00e7\u00e3o coincide com o per\u00edodo onde h\u00e1 uma maior restri\u00e7\u00e3o ao passo de tempo.\n\nVPI\n\nFigura 6.5 \u2014&lt;X = 45\u00b0 e n  =  2,0, sem backtrackm g \n(19 diag., GMRES(25), BILU 0)\n\nA Fig. 6.7 compara o hist\u00f3rico de converg\u00eancia em VPI 1,5 (regi\u00e3o de elevado passo de \n\ntempo) do m\u00e9todo adaptativo 1 e ijk = IO\u201c2. Optou-se por plotar o log dos res\u00edduos a cada \n\nitera\u00e7\u00e3o do GMRES, expandindo cada passo do Newton inexatos, de forma a comparar a \n\nnorma do res\u00edduo n\u00e3o-linear, \\\\F\\\\, com a do res\u00edduo linear local, Fxk + D F { x k ) s |. Note que\n\nambos os m\u00e9todos apresentam a mesma converg\u00eancia at\u00e9 33 itera\u00e7\u00f5es do GMRES. At\u00e9 a\u00ed \n\ntamb\u00e9m h\u00e1 plena concord\u00e2ncia entre a taxa de converg\u00eancia dos res\u00edduos linear e n\u00e3o-linear. \n\nA partir deste ponto, enquanto o m\u00e9todo fixo atinge a converg\u00eancia, o m\u00e9todo adaptativo \n\ncontinua convergindo o res\u00edduo linear, por\u00e9m avan\u00e7ando muito pouco o res\u00edduo n\u00e3o-linear. \n\nEsta diferen\u00e7a entre as curvas caracteriza o fen\u00f4meno do oversolving.\n\n\n\nResultados c Discuss\u00f5es 66\n\nVPI\n\nFigura 6.6 -  a  =  45\u00b0 e n  =  2,0, sem backtracking \n(19 diag., GMRES(25), BILU 0)\n\nItera\u00e7\u00f5es no GMRES\n\nFigura 6.7 \u2014 V P I =  1,5, a  =  45\u00b0 e n  =  2,0, sem backtracking \n(19 diag., GMRES(25), BILU 0)\n\n\n\nResultados e Discuss\u00f5es 67\n\nA Fig. 6.8 mostra o mesmo gr\u00e1fico para um V P I de 0,2. H\u00e1 v\u00e1rias informa\u00e7\u00f5es \n\ninteressantes neste gr\u00e1fico. Uma delas s\u00e3o os picos nas normas do res\u00edduo. Isto ocorre devido \n\na exist\u00eancia de um corte no passo de tempo em virtude de uma varia\u00e7\u00e3o de satura\u00e7\u00e3o ou \n\npress\u00e3o acima do permitido. Ao detectar varia\u00e7\u00f5es extremas, o simulador corrige o passo de \n\ntempo como mostrado na se\u00e7\u00e3o 5.3 e reinicia o m\u00e9todo de Newton inexato. Como \u00e9 ilustrado \n\nna figura, em ambos os m\u00e9todos ocorre o oversolving, sendo muito mais pronunciado no \n\nm\u00e9todo adaptativo. Em compensa\u00e7\u00e3o, ap\u00f3s o oversolving este m\u00e9todo apresenta uma taxa de \n\nconverg\u00eancia muito elevada, atingindo a toler\u00e2ncia em um menor n\u00famero de itera\u00e7\u00f5es, ou \n\nseja, neste time step o m\u00e9todo 1 foi melhor. Este fato d\u00e1 uma id\u00e9ia de que em problemas \n\ntransientes adaptativos o importante \u00e9 manter uma alta \u201cefici\u00eancia m\u00e9dia\u201d dos m\u00e9todos de \n\nNewton inexatos ao longo da simula\u00e7\u00e3o; o que, na maioria dos testes, foi atingido pelo m\u00e9todo \n\nfixo com t]k = 10 2.\n\n------- II F(^+ s) II - M\u00e9todo 1\n\nItera\u00e7\u00f5es no GMRES\n\nFigura 6.8 \u2014 VPI = 0,2, a  = 45\u00b0 e n = 2,0, sem hacktracking \n(19 diag., GMRES(25), BILU 0)\n\n\u00c9 interessante observar ainda que, para n = 1,5, o m\u00e9todo que se sobressai \u00e9 o m\u00e9todo \n\nfixo com rjk = 1 0 ^ . Isso pode ser explicado pela pequena n\u00e3o-linearidade presente nas \n\nequa\u00e7\u00f5es somado ao regime transiente que faz com que a taxa de converg\u00eancia permane\u00e7a no\n\n\n\nResultados e Discuss\u00f5es 68\n\nregime assint\u00f3tico, privilegiando baixos valores de rjk .\n\nTabela 6.7 -  a  = 60\u00b0, sem backtracking \n(19 diag., GMRES(25), BILU 0)\n\nnk\nIter.\n\nNewton\nM \u00e9dia Iter.Solver\n\nM\u00e9dia CPU\n\n\u00ab = 1,5\n\nM\u00e9todo 1 3952 3 36943 31 32,4\n\nM\u00e9todo 2 3944 3 42404 36 33,2\n\n7O**?*<II\u00a3 4233 3 32354 27 32,5\n\nVk ~ i o ^ 3469 3 38909 33 27,8\n\nn= 2,0\n\nM\u00e9todo 1 6496 3 46124 26 60,3\n\nM\u00e9todo 2 6527 3 53778 30 62,1\n\n% = i o 2 7003 3 43436 24 57,9\n\n% = i o \" 6072 3 57802 32 59,5\n\n\u00ab = 3,0\n\nM\u00e9todo 1 11396 4 58730 21 134,9\n\nM\u00e9todo 2 11392 4 67738 24 137,6\n\n= IO 2 12505 4 52951 19 120,7\n\nTJk= 10-4 10972 4 77318 28 136,6\n\n\u00ab = 4 ,0\n\nM\u00e9todo 1 14525 4 68482 20 150,6\n\nM\u00e9todo 2 14548 4 74784 22 151,6\n\n% = i o 2 15868 4 53971 16 150,4\n\n^ = 1 0 ^ 14279 4 85017 25 151,9\n\n\n\nResultados e Discuss\u00f5es 69\n\nTabela 6.8 -  a  = 45\u00b0, sem backtracking \n(19 diag., GMRES(25), BILU 0)\n\nnk\nIter.\n\nNewton M \u00e9dia\nIter.\n\nSolver\nM \u00e9dia CPU\n\n\u00ab = 1,5\n\nM\u00e9todo 1 3966 3 51691 44 33,2\n\nM\u00e9todo 2 4017 3 56539 49 34,3\n\n4377 3 45376 39 33,4\n\nrjk = MT\u00bb 3440 2 51386 44 30,4\n\n\u00ab = 2 ,0\n\nM\u00e9todo 1 6324 3 58737 33 55,7\n\nM\u00e9todo 2 6367 3 64705 36 56,8\n\n% = i o 2 7034 3 56179 31 52,6\n\nII o 6072 3 76858 43 57,5\n\n\u00ab = 3,0\n\nM\u00e9todo 1 9364 4 72503 31 92,4\n\nM\u00e9todo 2 9371 4 82107 35 93,8\n\n5? II \u00a9 10212 4 67009 29 83,8\n\n% = i o - 9004 3 94677 41 94,8\n\n\u00ab = 4 ,0\n\nM\u00e9todo 1 14638 4 91424 27 160,6\n\nM\u00e9todo 2 14819 4 101650 30 164,8\n\n% = l o 2 15996 4 71867 21 153,3\n\nII o i 14435 4 111973 33 163,3\n\n\n\nResultados e Discuss\u00f5es 70\n\nTabela 6.9 -  a  = 3 0 \u00b0 , sem backtracking \n(19 diag., GMRES(25), BILU 0)\n\n%\nIter.\n\nNewton\n, . .  Iter. \n\nMedia \u201e ,Solver M\u00e9dia CPU\n\n\u00ab = 1,5\n\nM\u00e9todo 1 3958 3 98564 86 42,9\n\nM\u00e9todo 2 4028 3 104166 90 44,2\n\n% = i o - 2 4542 3 76083 66 41,6\n\n% =  MT1 3471 3 96206 83 39,7\n\n\u00ab  = 2,0\n\nM\u00e9todo 1 6890 3 128031 72 73,0\n\nM\u00e9todo 2 7028 3 129225 73 72,9\n\n% = 10-* 8000 4 106571 60 66,4\n\n\u00a3 I! o\ni 6369 3 134941 76 71,5\n\n\u00ab = 3 ,0\n\nM\u00e9todo 1 11968 4 147659 53 141,7\n\nM\u00e9todo 2 12372 4 158490 57 142,6\n\n\u00ed? II o\nt!\u00bb 13562 4 118077 42 124,5\n\n10\" 11365 4 168858 61 147,4\n\n\u00ab  = 4,0\n\nM\u00e9todo 1 15524 4 161413 47 195,0\n\nM\u00e9todo 2 16301 4 179960 53 204,7\n\n%  = io-2 19501 5 133982 39 200,3\n\n%=io\" 15175 4 185864 54 196,7\n\nAs tabelas 6.10 a 6.15 mostram os resultados dos testes descritos acima para os m\u00e9todos \n\nde Krylov-Newton aproximados. Nestes casos, observou-se o mesmo comportamento \n\nanalisado anteriormente para o m\u00e9todo usando a matriz de 19 diagonais, prevalecendo o . \n\nm\u00e9todo fixo com rjk = 10 2. Isto ocorre inclusive para n= 1,5, com exce\u00e7\u00e3o dos casos\n\n\n\nResultados e Discuss\u00f5es 7 1\n\nortogonais { a  = 90\u00b0), onde todos os m\u00e9todos empregam a mesma matriz Jacobiana exata. Isto \n\npode ser explicado pela defici\u00eancia da aproxima\u00e7\u00e3o linear existente neste m\u00e9todos, que faz \n\ncom que uma escolha mais apertada para rjk, mesmo com um baixo grau de n\u00e3o-linearidade\n\npresente nas equa\u00e7\u00f5es, introduza muito oversolving. N\u00e3o foi testado, mas \u00e9 prov\u00e1vel que uma \n\nescolha ainda mais frouxa traga resultados melhores nestes casos.\n\nTabela 6.10 -  a  = 90\u00b0, sem backtracking \n(7 diag., GMRES(25), BILU 1)\n\n%\nIter.\n\nNewton M \u00e9dia\nIter.\n\nSolver M \u00e9dia CPU\n\nn  = 1,5\n\nM\u00e9todo 1 3974 3 29270 25 19,5\n\nM\u00e9todo 2 3973 3 31306 26 19,7\n\n\u00ed3 I! O\ntli 4118 3 21605 18 19,2\n\nV i =IO-4 3482 2 28573 24 17,5\n\n\u00ab = 2,0\n\nM\u00e9todo 1 6584 3 40275 22 34,0\n\nM\u00e9todo 2 6584 3 41482 23 34,3\n\n% = io - 2 6678 3 28622 16 32,7\n\n\u00ceoIIS* 6157 3 42062 23 32,8\n\nn = 3,0\n\nM\u00e9todo 1 11285 4 41597 15 72,7\n\nM\u00e9todo 2 11284 4 47769 17 73,8\n\nII o tb 11284 4 35944 13 69,9\n\n\u00ed5 II O\ni 10901 4 54903 20 73,6\n\ns II o\n\nM\u00e9todo 1 14174 4 45923 13 95,8\n\nM\u00e9todo 2 14172 4 51935 15 97,6\n\nli o 14241 4 36339 10 92,2\n\n14023 4 58888 17 98,0\n\n\n\nResultados e Discuss\u00f5es 72\n\nTabela 6.11 - a  \u2014 45\u00b0, sem backtracking \n(7 diag., GMRES(25), BILU 1)\n\nnk\nIter.\n\nNewton\nM \u00e9dia Iter.Solver\n\nM\u00e9dia\n?\n\nCPU\n\n#i = l,5\n\nM\u00e9todo 1 82633 71 103941 90 334,3\n\nM\u00e9todo 2 144622 125 162193 140 579,0\n\nVo1! 42452 36 199963 173 187,2\n\n% = i o \" 42496 36 481446 417 216,0\n\n\u00ab =2,0\n\nM\u00e9todo 1 110615 62 134094 76 421,2\n\nM\u00e9todo 2 197284 112 213763 121 727,3\n\n% = i o 2 63956 36 244915 139 264,5\n\n% = \u00edo-4 64561 36 610190 346 309,2\n\nTabela 6.12 -  a  =  30\u00b0, sem backtracking \n(7 diag., GMRES(2S), BILU 1)\n\n%\nIter.\n\nNewton M\u00e9dia\nIter.\n\nSolver M\u00e9dia CPU\n\n\u00ab = 1,5\n\nM\u00e9todo 1 173067 151 248132 216 696,7\n\nM\u00e9todo 2 273991 239 339162 295 1051,0\n\n\u00e18 II % 87206 76 627626 547 384,3\n\nrjk = 1 0 \" 87055 75 1353019 1180 467,0\n\nTabela 6.13 -  a  = 60\u00b0, sem backtracking \n( M atrix-free, GMRES(25), BILU 2)\n\n%\nIter.\n\nNewton M\u00e9dia\nIter.\n\nSolver M\u00e9dia CPU\n\n\u00ab = 1,5\n\nM\u00e9todo 1 15679 13 40625 1 35 1 104,7\n\n\n\nResultados e Discuss\u00f5es 73\n\nM\u00e9todo 2 15682 13 40686 35 105,1\n\n7oII\u00a3 6574 5 41035 35 69,0\n\n1oII5S\" 4794 4 49030 42 70,0\n\n\u00bb  = 2,0\n\nM\u00e9todo 1 18179 10 50692 28 123,9\n\nM\u00e9todo 2 18126 10 50958 29 125,1\n\n% = io  2 10268 5 53728 30 98,0\n\n% = 1 0 \" 7956 4 70819 40 104,7\n\n\u00bb = 3,0\n\nM\u00e9todo 1 20689 7 63451 23 187,7\n\nM\u00e9todo 2 19471 7 65239 24 183,5\n\n% = i &lt;r * 15824 5 63255 23 167,5\n\n7 fc= i o \" 12077 4 87055 32 177,5\n\nTabela 6.14 -  a  \u2014 4 5 \u00b0 ,  sem backtracking \n(M atrix-free, GMRES(2S), BILU 2)\n\nVk\nIter.\n\nNewton\nM\u00e9dia Iter.Solver M\u00e9dia CPU\n\n\u00bb  = 1,5\n\nM\u00e9todo 1 20003 17 55810 48 136,6\n\nM\u00e9todo 2 22721 19 59682 51 153,4\n\ni? II M S \n'\n\n6600 5 50624 43 80,6\n\n% = i o \" 4751 4 68934 59 94,3\n\n\u00bb  = 2,0\n\nM\u00e9todo 1 21323 12 67937 38 154,5\n\nM\u00e9todo 2 22241 12 71277 40 159,3\n\n\u00ed3 II O 10197 5 67520 38 111,2\n\ntoli 7896 4 98136 55 134,2\n\n\n\nResultados e Discuss\u00f5es 74\n\nw = 3,0\n\nM\u00e9todo 1 22524 8 82672 30 213,0\n\nM\u00e9todo 2 22832 8 85748 31 219,2\nS3 II \u00a9 16054 5 84717 31 187,7\n\nTJk = 1 0 - 12044 4 114453 41 212,5\n\nTabela 6.15 -  a  = 3 0 \u00b0 ,  sem backtracking \n{M atrix-free, GMRES(25), BILU 2)\n\n%\nIter... ^ M edia \n\nNewton\nIter.\n\nSolver M \u00e9dia CPU\n\nn = 1,5\n\nM\u00e9todo 1 23587 20 103389 90 198,7\n\nM\u00e9todo 2 28559 24 113958 99 226,7\n\n\u00e13 li i\u2014\ni o u 6808 5 94457 82 124,7\n\n0\n II >\u2014*\n \n\nO i 4699 4 147827 128 171,7\n\n\u00ab =2,0\n\nM\u00e9todo 1 25235 14 129554 73 225,7\n\nM\u00e9todo 2 27565 15 132188 74 236,7\n\n% = 10\u201c2 10950 6 124692 70 168,3\n\n% =  1 0 - 8115 4 188830 106 222,8\n\nNas pr\u00f3ximas se\u00e7\u00f5es, todos os testes utilizam o m\u00e9todo fixo com rjk = 10 2 sem \n\nbacktracking.\n\n6.2.2 Solvers e Precondicionadores\n\nNesta se\u00e7\u00e3o, \u00e9 mostrado um estudo realizado com os tr\u00eas m\u00e9todos de Krylov-Newton \n\nonde foi variado o tipo de solver de Krylov e o n\u00edvel do precondicionador BILU. Os solvers \n\nempregados foram o GMKES com restart ou GMRES(r), o TFQMR e o BICGSTAB. Em \n\ntodos os algoritmos foi utilizado precondicionamento \u00e0 direita e testou-se os n\u00edveis 0, 1 e 2\n\n\n\nResultados e Discuss\u00f5es 75\n\npara a fatoriza\u00e7\u00e3o LU incompleta. Analisou-se apenas o caso do paralelep\u00edpedo deformado \n\npor um \u00e2ngulo a  igual a 45\u00b0.\n\nNas tabelas abaixo s\u00e3o apresentados, para cada caso analisado, da esquerda para a \n\ndireita, o tempo de CPU em minutos, a porcentagem do tempo de CPU gasto, \n\nrespectivamente, no solver, na montagem da matriz Jacobiana (DF) e na montagem da fun\u00e7\u00e3o \n\nres\u00edduo (F), o n\u00famero total de itera\u00e7\u00f5es newtoniana inexatas, seu valor m\u00e9dio e m\u00e1ximo \n\ndurante a simula\u00e7\u00e3o, o n\u00famero total de itera\u00e7\u00f5es no solver linear e tamb\u00e9m seu valor m\u00e9dio e \n\nm\u00e1ximo durante a simula\u00e7\u00e3o.\n\nAs tabelas 6.16 e 6.17 mostram os resultados obtidos com o m\u00e9todo que utiliza a matriz \n\nJacobiana completa de 19 diagonais para dois valores do expoente da satura\u00e7\u00e3o: 1,5 e 2,0. \n\nObserve que, a despeito do maior n\u00famero de itera\u00e7\u00f5es realizadas, o m\u00e9todo que emprega o \n\nGMRES na solu\u00e7\u00e3o da equa\u00e7\u00e3o linear tende a ser mais eficiente, com exce\u00e7\u00e3o para n \u20141,5 \n\nusando BILU 0 onde a simula\u00e7\u00e3o foi mais r\u00e1pida com o uso do BICGSTAB. Entretanto, pode \n\nser decretado um empate t\u00e9cnico entre os m\u00e9todos, j\u00e1 que a maior diferen\u00e7a foi de \n\naproximadamente 7%. Outro ponto importante a ser observado \u00e9 a inefici\u00eancia do aumento do \n\nn\u00edvel de aproxima\u00e7\u00e3o da fatoriza\u00e7\u00e3o LU. Para ambos os valores de n testados, foram obtidos \n\nmelhores resultados com o n\u00edvel 0.\n\nTabela 6.16 \u2014 a  = 45\u00b0 e n = 1,5 (19 diag.)\n\nSolver CPU** j Solver* DF* j F*\nIter.\n\nNewton M\u00e9dia* /  M\u00e1x.\nIter.\n\nSolver M\u00e9dia*7M\u00e1x.\n\nBILU 0\nGMRES(3Q) 34,1 33 52 14 I 4312 3 / 8 46498 40 / 171\nTFQMR 33,5 39 47 13 3768 3 / 3 7 33972 2 9 / 1 1 1\nBICGSTAB 32,7 35 51 13 1 3948 3 / 3 7 26486 2 2 / 8 1\n\nBILU 1\nGMRES(30) 41,5 ! 48 40 11 4001 3 / 3 8 21871 1 8 / 8 1\nTFQMR 43,2 52 37 10 3803 3 / 3 8 17092 1 4 / 4 8\nBICGSTAB 41,9 1 50 39 10 3907 3 / 3 7 13530 1 1 / 4 2\n\nBILU 2\nGMRES(30) 81,5 73 21 6 4086 3 / 3 7 16368 1 4 / 5 7\nTFQMR 83,1 75 20 5 3880 3 / 3 7 12725 1 1 / 4 5\nBICGSTAB 83,0 75 20 5 3832 3 / 3 7 10363 8 / 3 7\n\n** tempo de CPU em min.\n* % do tempo de CPU \n+ total/n\u00b0 de time steps realizados\n\n\n\nResultados e Discuss\u00f5es 76\n\nTabela 6.17 -  a  = 45\u00b0 e n = 2,0 (19 diag.)\n\nSolver CPU\" Solver DF* F* M\u00e9dia*/M\u00e1x.Newton |\nIter.\n\nSolver M\u00e9dia*/ M\u00e1x.\n\nBILU 0\nGMRES(30) li 56,9 34 51 13 7010 3 / 3 8 61482 34 / 1 2 6\nTFQMR 57,9 40 47 12 6481 3 / 3 7 44388 2 5 / 8 3\nBICGSTAB I 57,1 38 49 12 6581 3 / 3 7 35390 2 0 / 6 3\n\nBILU 1\nGMRES(30) 78,7 54 36 9 6631 3 / 3 8 29755 1 6 / 5 7\nTFQMR 84,2 58 33 8 6512 3 / 3 8 23070 13 /  38\nBICGSTAB 80,7 56 34 9 6458 3 / 3 7 17934 1 0 / 3 7\n\nBILU 2\nGMRES(30) 170,0 79 16 4 6446 3 / 3 7 20724 1 1 / 4 2\nTFQMR 180,5 80 15 4 6609 3 / 3 7 17530 9 / 3 7\nBICGSTAB 180,5 80 15 4 6447 3 / 3 7 14100 8 / 3 7\n\n** tempo de CPU em min.\n* % do tempo de CPU \n+ total/n\u00b0 de time steps realizados\n\nAs tabelas 6.18 e 6.19 mostram os resultados para o m\u00e9todo aproximado proposto por \n\nMaliska et al. (1997), onde a matriz Jacobiana \u00e9 aproximada apenas pelas 7 diagonais \n\noriginadas dos termos ortogonais. Neste caso os resultados foram muito parecidos com os \n\nanteriores; pouca diferen\u00e7a entre o solvers, com uma leve vantagem do GMRES. Todavia, o \n\nmelhor precondicionamento foi obtido com o BILU de n\u00edvel 1.\n\nTabela 6.18 -  a  = 45\u00b0 e n = 1,5 (7 diag.)\n\nSolver CPU* Solver DF* F*\nBer.\n\nNewton M\u00e9dia*/M \u00e1x.\nIter.\n\nSolver M\u00e9dia* /M ax.\n\nBILU0\nGMRES(30) I 262,8 44 41 14 42616 36 / 1 6 3 1123566 975 /  3561\nTFQMR 258,2 42 43 14 43541 37 / 163 780456 677 / 2468\nBICGSTAB 1 249,2 40 44 14 42633 37 / 1 6 3 717284 622 /  2961\n\nBILU 1\nGMRES(30) 191,0 23 57 19 42502 3 6 / 1 6 3 335145 290 /1095\nTFQMR 204,2 28 54 17 42683 37 / 163 256759 22 2 / 8 5 2\nBICGSTAB 201,5 27 55 17 42511 3 6 / 1 6 3 231995 2 0 1 /8 9 7\n\nBILU 2\nGMRES(30) 212,7 31 51 17 42528 36/ 163 53080 2 6 3 / 9 5 7\nTFQMR 229,0 35 48 16 42626 37 /163 226022 196 /  759\nBICGSTAB 226,7 34 49 16 42496 3 6 / 1 6 3 207343 1 79/ 768\n\n** tempo de CPU em min.\n* % do tempo de CPU \n+ total/n\u00b0 de time steps realizados\n\n\n\nResultados e Discuss\u00f5es 77\n\nTabela 6.19 -  a  =  45\u00b0 e  n =  2,0 (7 diag.)\n\nSolver CPU\u201d Solver J DF* F* Iter.Newton M \u00e9dia*/M\u00e1x.\nIter.\n\nSolver M \u00e9dia*/M \u00e1x.\n\nBILU 0\nGMRES(30) 372,3 44 42 14 64680 3 6 / 1 6 3 1358956 772/ 2535\nTFQMR 360,0 40 44 15 66122 37 / 163 903275 513 / 1450\nBICGSTAB 363,2 42 43 14 64558 36 / 163 917952 521/ 2151\n\nBILU 1\nGMRES(30) 288,8 26 j 55 18 64550 36 / 162 423153 240 /  810\nTFQMR 305,3 30 52 17 64715 3 6 / 1 6 2 297969 169/ 558\nBICGSTAB 298,0 28 1 53 18 64598 3 6 / 1 6 2 276550 1 57/ 579\n\nBILU 2\nGMRES(30) 327,2 36 48 15 64539 36 / 162 373697 2 1 2 / 7 0 8\nTFQMR 348,2 39 45 15 64652 36 / 162 270354 1 5 3 / 4 8 0\nBICGSTAB 344,7 38 46 15 64575 3 6 / 1 6 2 243068 138 /  496\n\n** tempo de CPU em min.\n* % do tempo de CPU \n+ total/n\u00b0 de time steps realizados\n\nNas tabelas 6.20 e 6.21 est\u00e3o dispostos os resultados do m\u00e9todo matrix-free. Uma \n\ncaracter\u00edstica evidente \u00e9 a necessidade de um bom precondicionamento, visto que para BILU \n\n0 os resultados foram muito pobres, n\u00e3o sendo poss\u00edvel a converg\u00eancia para o TFQMR e o \n\nBICGSTAB. Para \u00ab  = 1,5, chegou-se a obter resultados melhores com n\u00edvel 3 de fatoriza\u00e7\u00e3o \n\nincompleta. Outro fator importante, \u00e9 a not\u00e1vel predomin\u00e2ncia do GMRES perante os outros \n\nsolvers, chegando a ser, para n = 1,5, 80% e 30% mais r\u00e1pido que o TFQMR e o BICGSTAB, \n\nrespectivamente. Note que os resultados utilizando o TFQMR foram muito ruins neste \n\nm\u00e9todo.\n\nTabela 6.20 \u2014 a  =  45\u00b0 e n  =  1,5 (M atrix-fre\u00e9)\n\nSolver CPU** Solver DF* F* Iter.Newton M\u00e9dia*/M\u00e1x.\nIter.\n\nSolver\nM\u00e9dia* /  M\u00e1x.\n\nBILU 0\nGMRES(30) 326,0 93 5 86 5866 5 / 4 1 314404 272 /  908\nTFQMR Falha\nBICGSTAB Falha\n\nBILU 1\nGMRES(30) ! 77,1 76 17 72 4945 4 / 3 9 59993 52 / 18 7\nTFQMR 442,0 94 4 87 6174 5 / 3 9 223442 193/ 2153\nBICGSTAB 116,3 84 11 80 4943 4 / 3 9 51707 4 4 / 2 9 3\n\nBILU 2\nGMRES(30) 74,7 75 17 67 4953 4 / 4 0 53076 4 6 / 1 6 1\nTFQMR 355,5 94 4 84 5768 5 / 3 9 170477 147/ 1138\nBICGSTAB 101,9 82 12 73 4853 4 / 3 9 40828 3 5 / 1 9 3\n\nBILU 3\nGMRES(30) ! 73,9 75 17 54 4992 4 / 4 0 40601 35 / 1 1 9\n\n** tempo de CPU em min.\n* % do tempo de CPU \n\n1 + total/n0 de time steps realizados\n\n\n\nResultados e Discuss\u00f5es 78\n\nTabela 6.21 -  a  ?- 45\u00b0 e n  = 2,0 (M atrix-free)\n\nSolver CPU* Solver* DF* F* Iter.Newton\nM\u00e9dia* /  M\u00e1x. Iter.\n\nSolver\nM\u00e9dia* /  M\u00e1x.\n\nBILUO\nGMRES(30) I 324,3 90 7 83 8803 5 / 4 1 327776 186/ 547\nTFQMR Falha\nBICGSTAB 1 Falha\n\nBILU1\nGMRES(30) 111,0 73 19 68 8295 4 / 4 0 85141 4 8 / 1 4 5\nTFQMR 384,5 92 6 84 8885 5 / 3 8 199640 113/ 945\nBICGSTAB 142,8 80 14 74 8147 4 / 3 7 62835 3 5 / 2 2 7\n\nBILU2\nGMRES(30) 111,6 73 19 60 8407 4 / 4 1 73840 41 / 1 2 0\nTFQMR 339,3 91 79 6 8759 4 / 3 8 163887 93 /  831\nBICGSTAB 132,3 78 15 67 8133 4 / 3 6 51147 2 9 / 1 1 0\n\nBILU3\nGMRES(30)|| 124,7 76 17 44 8378 56846 3 2 / 1 2 0\n\n** tempo de CPU em min.\n* %  do tempo de CPU \n+ tota!/n\u00b0 de time steps realizados\n\nEm muitos casos, principalmente quando h\u00e1 a necessidade de uma malha muito \n\nrefinada, um fator decisivo na viabilidade da simula\u00e7\u00e3o \u00e9 a mem\u00f3ria utilizada pelo c\u00f3digo \n\ncomputacional. Muitas vezes o analisador num\u00e9rico se v\u00ea obrigado a preterir um c\u00f3digo mais \n\nr\u00e1pido a outro mais lento, por\u00e9m mais econ\u00f4mico no uso da mem\u00f3ria. Neste aspecto, como \u00e9 \n\nmostrado na tabela 6.22, o aumento do n\u00edvel de fatoriza\u00e7\u00e3o do BI LU exige uma maior \n\ndisponibilidade de mem\u00f3ria livre. Este requisito toma-se ainda mais importante quando a \n\nmatriz Jacobiana \u00e9 exata, j\u00e1 que para um mesmo n\u00edvel de precondicionamento ocupa de 2,3 a \n\n3,3 vezes mais mem\u00f3ria do que o ocupado para uma matriz aproximada.\n\nTabela 6.22 -  Mem\u00f3ria consumida pelos precondicionadores (em Kbytes) \nem fun\u00e7\u00e3o da estrutura da matriz Jacobiana\n\nPrecondidonador\nMatriz Jacobiana\n\n19 diagonais 7 diagonais\n\nB1LU0 667,52 284,48\n\nBILU1 1.390,43 516,64\n\nBILU2 2.645,54 807,37\n\nBELU 3 X 1.363,07\n\nA tabela 6.23 mostra a divis\u00e3o do tempo de processamento do problema linear entre as\n\n\n\nResultados e Discuss\u00f5es 79\n\nitera\u00e7\u00f5es do solver de Krylov e a montagem do precondicionador. Devido ao maior n\u00famero de \n\nn\u00e3o-nulos da matriz de 19 diagonais, uma maior quantidade do tempo de solu\u00e7\u00e3o do problema \n\nlinear \u00e9 gasto na montagem do precondicionador. Da\u00ed a inefic\u00e1cia do aumento da fatoriza\u00e7\u00e3o \n\nLU para este m\u00e9todo. Deve-se observar ainda a relativamente elevada parcela do tempo gasta \n\nno solver para o m\u00e9todo matrix-free. Isto ocorre devido \u00e0 aproxima\u00e7\u00e3o do produto Jacobiana- \n\nvetor ter de ser calculada a cada itera\u00e7\u00e3o do solver de Krylov.\n\nTabela 6.23 -  Distribui\u00e7\u00e3o do tempo de processamento do problema linear \nem % do tempo total de CPU (GMRES, a  = 45\u00b0 e n = 1,5)\n\nPrecondicionador\n\nKrylov-Newton\n\n19 diagonais 7 diagonais Matrix-free\n\nSolver Prec. Solver Prec. Solver Prec.\n\nBILUO 23 10 42 2 93 0\n\nBJLU 1 17 31 17 6 74 2\nBILU 2 13 60 18 13 70 5\n\n6.2.3 Avalia\u00e7\u00e3o dos m\u00e9todos de Krylov-Newton\n\nEsta se\u00e7\u00e3o \u00e9 dedicada \u00e0 compara\u00e7\u00e3o direta entre os tr\u00eas m\u00e9todo de Krylov-Newton \n\napresentados anteriormente. Os par\u00e2metros variados s\u00e3o o \u00e2ngulo de deforma\u00e7\u00e3o a  e o \n\nexpoente das satura\u00e7\u00f5es n . O primeiro est\u00e1 ligado diretamente com a magnitude dos termos \n\nn\u00e3o-ortogonais das equa\u00e7\u00f5es discretizadas; quanto menor o valor de a , maior \u00e9 o peso das \n\nderivadas cruzadas e consequentemente maiores s\u00e3o os elementos das diagonais extras da \n\nmatriz Jacobiana completa. l\u00e1  o expoente n \u00e9 a principal fonte de n\u00e3o-linearidade das \n\nequa\u00e7\u00f5es; quanto maior for o valor de n , maior \u00e9 o grau de ri\u00e3o-linearidade das equa\u00e7\u00f5es \n\ndiscretizadas.\n\nNos resultados detalhados na tabela 6.25, para cada m\u00e9todo de Krylov-Newton, foram \n\nusados os melhores par\u00e2metros segundo os estudos apresentados nas se\u00e7\u00f5es anteriores. Estes \n\npar\u00e2metros est\u00e3o discriminados na tabela 6.24.\n\n\n\nResultados e Discuss\u00f5es 80\n\nTabela 6.24 -  Par\u00e2metros num\u00e9ricos usados em cada m\u00e9todo de Krylov-Newton\n\n19 diag. 7 diag. Matrix-free\n\nSolver GMRES( 25 ) GMRES( 25 ) GMKES( 25 )\n\nPrecondicionador BILU 0, \u00e0 direita BILU 1, \u00e0 direita BILU 2, \u00e0  direita\n\nBacktracking n\u00e3o n\u00e3o n\u00e3o\n\nnk fixo, 10 2 fixo, 1 0 2 fixo, 10 2\n\nMem\u00f3ria em Kbytes* 1488,19 842,44 836,51\n* estimativa que leva em conta apenas as estruturas mais representativas, tais como: matriz Jacobiana e de \nprecondicionamento, vetores F e s, etc.\n\nComo era de se esperar, o efeito da n\u00e3o-ortogonalidade sobre os m\u00e9todos de Krylov- \n\nNewton que utilizam a matriz Jacobiana aproximada (apenas 7 diagonais) \u00e9 grande. Note que \n\nmesmo para deforma\u00e7\u00f5es muito pequenas, a  = 80\u00b0, obteve-se melhores resultados com o \n\nm\u00e9todo que utiliza a matriz Jacobiana de 19 diagonais. Isto ocorre devido a este m\u00e9todo \n\npossuir um processo iterativo muito mais eficiente, evidenciado atrav\u00e9s do sens\u00edvel menor \n\nn\u00famero de itera\u00e7\u00f5es newtonianas e do solver linear.\n\n\u00c9  importante ter em mente que o custo por itera\u00e7\u00e3o, tanto da itera\u00e7\u00e3o do Newton \n\ninexato, quanto da itera\u00e7\u00e3o do sistema linear interno, \u00e9 maior para o m\u00e9todo que utiliza a \n\nmatriz Jacobiana completa comparado ao m\u00e9todo sugerido por Maliska et al. (1997), j\u00e1 que \n\nesta \u00e9 muito menos esparsa do que a matriz aproximada. No entanto, esta rela\u00e7\u00e3o se inverte \n\npara o m\u00e9todo matrix-free. Na verdade, o m\u00e9todo matrix-free possui o maior custo por \n\nitera\u00e7\u00e3o dentre todos os m\u00e9todo aqui apresentados. Isto ocorre devido \u00e0 aproxima\u00e7\u00e3o do \n\nproduto Jacobiana-vetor ser calculada a cada itera\u00e7\u00e3o do solver linear. Todavia, para \u00e2ngulos \n\nde 60\u00b0 a 30\u00b0, este m\u00e9todo chega a ser de 50% a quase 4 vezes mais r\u00e1pido do que o m\u00e9todo de \n\nMaliska et al., sendo um m\u00e9todo bastante atrativo quando a mem\u00f3ria dispon\u00edvel \u00e9 restrita.\n\nTabela 6.25 -  Compara\u00e7\u00e3o entre os m\u00e9todos de Krylov-Newton para v\u00e1rios valores de a  e n\n\na Kiylov-\nNewton CPU** Solver DF F*\n\nIter.\nNewton\n\nM\u00e9d.+ /  M\u00e1x. Iter.\nSolver\n\nM \u00e9 d . / M \u00e1 x .\n\nra =  1,5\n19 diag. 25,7 21 61 17 4032 3 / 3 5 23229 1 9 / 7 5\n7 diag. 19,2 19 56 24 4118 3 / 3 5 21605 1 8 / 7 8\n\no\nO M atrix-free 47,3 62 26 63 4846 4 / 3 5 28939 24 /  79\n\nn = 2,0\n19 diag. 45,1 23 59 16 6731 3 / 3 5 31910 1 8 / 5 7\n7 diag. 32,7 23 53 22 6678 3 / 3 4 28622 1 6 / 4 8\n\n\n\nResultados e Discuss\u00f5es SI\n\nM atrix-free \\ 63,9 57 30 57 8133 4 / 3 5 40066 2 2 / 6 9\nn  =  3,0\n\n19 diag. 97,4 33 51 15 11284 4 / 3 5 35944 1 3 / 4 0\n7 diag. 69,9 31 48 21 11284 4 / 3 5 35944 1 3 / 4 0\nM atrix-free 155,0 63 25 35 15132 5 / 3 4 46299 1 7 / 5 6\n\n\u00ab  =  1,5\n19 diag. 27,4 25 58 15 4039 3 / 3 6 22993 1 9 / 7 8\n7 diag. 40,1 18 59 22 9599 8 / 6 6 34016 2 9 / 9 3\nM atrix-free 60,4 63 26 57 6469 5 / 3 5 35951 3 0 / 9 0\n\n\u00bb  =  2,0\nO\nO 19 diag. 51,0 28 57 14 6655 3 / 3 6 29696 1 6 / 5 400 7 diag. 65,2 21 57 20 15392 8 / 6 6 45675 2 5 / 6 9\n\nM atrix-free 83,4 61 28 50 9921 5 / 3 5 44329 2 5 / 7 8\n\u00ab  =  3,0\n\n19 diag. 99,1 33 52 14 11090 4 / 3 6 37091 1 3 / 4 6\n7 diag. 124,75 26 53 20 25261 9 / 6 6 56866 2 0 / 6 8\nM atrix-free 131,4 62 26 40 13075 4 / 3 5 45887 1 6 / 7 0\n\n\u00bb = 1 , 5\n19 diag. 32,5 27 56 15 4233 3 / 3 9 32354 2 7 / 1 0 2\n7 diag. 102,1 23 57 20 23087 19 / 1 1 6 158086 136/ 475\nM atrix-free 69,0 66 24 60 6574 5 / 3 9 41035 3 5 / 1 1 3\n\n\u00ab  =  2,0\no\nO 19 diag. 57,9 32 54 13 7003 3 / 3 9 43436 2 4 / 8 1\nVO 7 diag. 152,1 24 56 19 35341 2 0 / 1 1 6 192193 109/ 324\n\nM atrix-free 98,0 63 26 54 10268 5 / 3 9 53728 3 0 / 9 6\n\u00ab  =  3,0\n\n19 diag. 120,7 37 49 13 12505 4 / 4 0 52951 1 9 / 6 7\n7 diag. 263,2 24 55 19 56060 2 0 / 1 1 6 125683 4 6 / 1 1 8\nM atrix-free 167,5 63 26 44 15824 5 / 4 0 63255 2 3 / 9 8\n\n\u00bb  =  1,5\n19 diag. 33,4 32 53 14 4377 3 / 3 9 45376 3 9 / 1 4 4\n7 diag. 187,2 17 62 20 42452 3 6 / 1 6 2 199963 173 /  567\nM atrix-free 80,6 70 21 62 6600 5 / 3 9 50624 43 / 143\n\n\u00ab = 2 , 0\no 19 diag. 52,6 32 53 14 7034 3 / 3 9 56179 3 1 / 1 1 1\nrj- 7 diag. 264,5 20 60 20 63956 36 / 162 244915 1 39/ 408\n\nM atrix-free 111,2 68 23 56 10197 5 / 3 9 67520 3 8 / 1 1 7\n\u00ab  =  3,0\n\n19 diag. 83,8 36 50 14 10212 4 / 3 9 67009 2 9 / 8 1\n7 diag. 449,2 25 55 19 96518 3 5 / 1 6 2 259803 9 5 / 2 6 1\nM atrix-free 187,7 67 23 48 16054 5 / 4 0 84717 3 1 / 1 1 9\n\n\u00ab = 1 , 5\n19 diag. 41,6 39 48 13 4542 3 / 4 2 76083 6 6 / 2 5 2\n7 diag. 384,3 22 59 19 87206 7 6 / 2 6 7 627626 547/ 1770\nM atrix-free 124,7 80 14 70 6808 5 / 4 3 94457 8 2 / 2 5 7\n\no \u00ab  =  2,0\nCO 19 diag. 66,4 39 47 13 8000 4 / 4 2 106571 6 0 / 1 9 2\n\n7 diag. 632,6 31 51 17 134354 7 5 / 2 4 6 1330197 752/ 2811\nM atrix-free 168,3 77 16 64 10950 6 / 4 2 124692 7 0 / 1 9 9\n\n\u00ab = 3 , 0\n19 diag. 124,5 39 1 47 13 13562 4 / 4 2 118077 42 /  132\n\n\n\nResultados e Discuss\u00f5es 82\n\n7 diag. 881,3 28 53 18 183697 6 6 / 2 4 6 782794 283 /  801\nM atrix-free 245,8 74 18 54 17024 6 / 4 3 140166 50 / 150\n\n** tempo de CPU em min.\n* % do tempo de CPU \n+ total/n\u00b0 de time steps realizados\n\nOutro comportamento interessante de ser observado, \u00e9 a m\u00ednima varia\u00e7\u00e3o dos valores \n\nm\u00e9dios e m\u00e1ximos das itera\u00e7\u00f5es newtonianas com rela\u00e7\u00e3o \u00e0 deforma\u00e7\u00e3o da malha para o \n\nm\u00e9todo que emprega a matriz de 19 diagonais e o m\u00e9todo matrix-free (ver Fig. 6.9). Isso \n\ndemonstra a robustez inerente a uma boa aproxima\u00e7\u00e3o da matriz Jacobiana. \u00c9 bom lembrar \n\nque, apesar da matriz Jacobiana ser \u201cdiscreta\u201d no m\u00e9todo matrix-free, sua aproxima\u00e7\u00e3o \u00e9 \n\nmuito melhor do que a realizada no m\u00e9todo de Maliska et al.. A aproxima\u00e7\u00e3o do m\u00e9todo \n\nmatrix-free, de certa forma, leva em considera\u00e7\u00e3o todas as 19 diagonais, usando a matriz com \n\nas 7 diagonais ortogonais apenas para precondicionamento.\n\nFigura 6.9 -  Influ\u00eancia da n\u00e3o-ortogonalidade nos m\u00e9todos de Krylov-Newton para n = 2 ,0\n\nCom rela\u00e7\u00e3o a ri\u00e3o-linearidade introduzida pelo expoente das satura\u00e7\u00f5es, n , \u00e9 \n\ninteressante observar que todos os m\u00e9todos apresentam uma queda de performance com o \n\naumento do valor de n e, quanto maior a aproxima\u00e7\u00e3o da matriz Jacobiana promovida pelo \n\nm\u00e9todo, maior pronunciado torna-se este efeito (ver Fig. 6.10).\n\n\n\nResultados e Discuss\u00f5es 83\n\nFigura 6.10 -  Influ\u00eancia da n\u00e3o-linearidade nos m\u00e9todos de Krylov-Newton para \u00ab  = 45\u00b0\n\nAs tabelas 6.26, 6.27 e 6.28 quantificam a efici\u00eancia relativa de cada m\u00e9todo com \n\nrela\u00e7\u00e3o ao tempo CPU ilustrando a an\u00e1lise feita acima.\n\nNestas tabelas \u00e9 ainda poss\u00edvel observar um comportamento interessante com rela\u00e7\u00e3o a \n\nn\u00e3o-linearidade. Com o aumento do valor do expoente \u00ab , h\u00e1 em geral uma pequena queda na \n\ndiferen\u00e7a entre os m\u00e9todos aproximados e o m\u00e9todo que emprega a matriz completa. Isso \n\npode ocorrer devido a um aumento mais significativo nos valores das 7 diagonais \u201cortogonais\u201d \n\ne menor nas outras 12.\n\nTabela 6.26 \u2014 \u00ed 1 / CPU19\n90\u00b0 80\u00b0 60\u00b0 45\u00b0 30\u00b0\n\nn - 1,5 0,75 1,5 3,1 5,6 9,2\n\u00ab = 2 ,0 0,73 1,3 2,6 5,0 9,5\n\u00ab  = 3,0 0,72 1,3 2,2 5,4 7,1\n\nTabela 6.27- Raz\u00e3o CPU7/ CPUmf\n\n90\u00b0 80\u00b0 60\u00b0 45\u00b0 30\u00b0\n\n\u00ab = 1,5 0,41 0,66 1,5 2,3 3,1\n\u00ab = 2,0 0,51 0,78 1,6 2,4 3,8\n\u00ab = 3,0 0,45 0,95 1,6 2,4 3,6\n\n\n\nResultados e Discuss\u00f5es 84\n\nTabela 6.28 -  Raz\u00e3o CPU\u201d1 / CPU19\n\n90\u00b0 80\u00b0 60\u00b0 45\u00b0 30\u00b0\n\u00ab  = 1,5 1,8 2,2 2,1 2,4 3,0\n\u00ab = 2 ,0 1,4 1,6 1,7 2,1 2,5\n\u00ab = 3,0 1,6 1,3 1,4 2,2 2,0\n\nOs gr\u00e1ficos das figuras abaixo apresentam, para diferentes valores do VPI, a norma da \n\nfun\u00e7\u00e3o res\u00edduo em fun\u00e7\u00e3o do tempo de CPU para o caso com a  = 45\u00b0 e \u00ab =2,0. Nestas curvas \n\npode ser vista a forte converg\u00eancia do m\u00e9todo com a matriz de 19 diagonais, seguido pelo \n\nm\u00e9todo matrix-free\\ ambos muito mais r\u00e1pidos do que m\u00e9todo que desconsidera os termos \n\nn\u00e3o-ortogonais. As oscila\u00e7\u00f5es nas curvas dos m\u00e9todos aproximados para VPI igual a 1,0 e 1,5 \n\nevidenciam a persist\u00eancia do problema de oversolving presente nos m\u00e9todos quase- \n\nnewtonianos.\n\n\u00c9 importante salientar, que os resultados aqui apresentados, foram obtidos com \n\ntoler\u00e2ncias moderadamente restritivas, aumentando ainda mais a vantagem do m\u00e9todo que \n\nutiliza a matriz Jacobiana exata.\n\ntempo de CPU (seg.)\n\nFigura 6.11 -  VPI = 0,2 para (X = 45\u00b0 e n  =2,0\n\n\n\n(II d \nII )Bo| \n\n(II d \nII )6o|\n\nResultados e Discuss\u00f5es 85\n\nFigura 6.12 -  V P I =  1,0 para (X =  45\u00b0 e n  =  2,0\n\ntempo de CPU (seg.)\n\nFigura 6.13 -  V P I =  1,5 para a  =  45\u00b0 c n  = 2,0\n\n\n\nResultados e Discuss\u00f5es 86\n\n6.3 Reservat\u00f3rio Real\n\nNos problemas da se\u00e7\u00e3o anterior, a n\u00e3o-ortogonaiidade da malha tem uma distribui\u00e7\u00e3o \n\nhomog\u00eanea, o que, na pr\u00e1tica, n\u00e3o ocorre em reservat\u00f3rios mais realistas. Nesta se\u00e7\u00e3o, ser\u00e3o \n\napresentados os resultados da aplica\u00e7\u00e3o dos tr\u00eas m\u00e9todos de Krylov-Newton na modelagem de \n\num escoamento envolvendo os mesmos tipos de fluidos dos problemas anteriores, por\u00e9m em \n\num reservat\u00f3rio com geometria mais pr\u00f3xima a um caso real.\n\nA Fig. 6.14 apresenta a malha generalizada utilizada na simula\u00e7\u00e3o. Observe que h\u00e1 uma \n\ndistribui\u00e7\u00e3o razoavelmente heterog\u00eanea da n\u00e3o-ortogonalidade, sendo um pouco mais \n\nacentuada ao longos dos eixos 4 e V- Como \u00e9 mostrado na figura, h\u00e1 dois po\u00e7os injetores de \n\n\u00e1gua e dois po\u00e7os produtores dispostos em cantos opostos do reservat\u00f3rio. As vaz\u00f5es de \n\ninje\u00e7\u00e3o e produ\u00e7\u00e3o s\u00e3o constantes e iguais a 1920 barris/dia (3,53xl0\u201c3m3/ s )  em cada po\u00e7o. \n\nO volume total do reservat\u00f3rio \u00e9 de 7,55xl0sm3 e a simula\u00e7\u00e3o \u00e9 realizada at\u00e9 2 VPI. Os \n\ndemais dados do problema f\u00edsico e num\u00e9rico s\u00e3o id\u00eanticos aos fornecidos nas tabelas 6.3 e 6.4 \n\npara o problema do paralelep\u00edpedo deformado.\n\nInje\u00e7\u00e3o\nProdu\u00e7\u00e3o ( o, o, o)\n( 1 0 . 0 , 4 )  a\n\nInje\u00e7\u00e3o\n( 10, 10, 0 )\n\nFigura 6.14 -  Malha 10x10x4 ( \u00c7, Tj, y  ) e disposi\u00e7\u00e3o dos po\u00e7os\n\nNa tabela 6.29 s\u00e3o apresentados os par\u00e2metros num\u00e9ricos utilizados em cada um dos\n\n\n\nResultados e Discuss\u00f5es 87\n\nm\u00e9todos de Newton inexatos.\n\nTabela 6.29 -  Par\u00e2metros num\u00e9ricos usados em cada \nm\u00e9todo de Krylov-Newton\n\n19 diag. 7 diag. Matrix-free\n\nSolver GMRES( 25 ) GMRES( 25 ) GMKES( 25 )\n\nPrecondicionador BILU 0, \u00e0 direita BELU 1, \u00e0 direita BILU 2, \u00e0 direita\n\nBacktracking n\u00e3o n\u00e3o n\u00e3o\n\n% fixo, IO-2 fixo, 1 0 2 fixo, 1 0 2\n\nMem\u00f3ria em Kbytes* 527,98 306,02 289,46\n* estimativa que leva em conta apenas as estruturas mais representativas, tais como: matriz Jacobiana\ne de precondicionamento, vetores F e s, etc.\n\nA tabela 6.30 mostra os resultados obtidos com tr\u00eas diferentes valores do expoente das \n\nsatura\u00e7\u00f5es. Nas tr\u00eas condi\u00e7\u00f5es, o m\u00e9todo que emprega a Jacobiana completa, com 19 \n\ndiagonais, teve a melhor performance, seguido pelo m\u00e9todo proposto por Maliska et al. \n\n(1997).\n\nTabela 6.30 -  Compara\u00e7\u00e3o entre os m\u00e9todos de Krylov-Newton \nna simula\u00e7\u00e3o de um reservat\u00f3rio real\n\nKrylov-\nNewton CPU** Solver DF* F*\n\nIter.\nNewton\n\nMc d.* /  M\u00e1x. Iter.\nSolver M \u00e9 d / / M \u00e1 x .\n\n\u00ab = 1 , 5\n19 diag. 146,5 24 60 15 72052 3 / 4 568307 2 3 / 2 6\n7 diag. 178,0 23 57 19 130621 5 / 8 939448 3 9 / 4 4\nM atrix-free 222,0 64 25 61 71743 3 / 4 513096 2 1 / 2 4\n\n\u00ab  =  2,0\n19 diag. 124,6 24 60 14 64595 2 / 6 470680 1 9 / 2 7\n7 diag. 167,7 23 57 19 134989 5 /1 0 893009 3 7 / 4 4\nM atrix-free 200,0 64 25 59 72048 3 / 6 495430 2 0 / 2 3\n\n\u00ab  =  3,0\n19 diag. 139,3 23 61 15 68605 2 / 9 446897 1 8 / 4 2\n7 diag. 163,6 19 59 20 122917 5 / 1 8 681750 2 8 / 6 0\nM atrix-free 188,7 60 28 58 67284 2 / 9 398052 1 6 / 3 9\n\n** tempo de CPU em min.\n* % do tempo de CPU \n+ total/n0 de time steps realizados\n\nA tabela 6.31 resume a an\u00e1lise aos tempos de CPU, mostrando que o m\u00e9todo com 19 \n\ndiagonais \u00e9 em m\u00e9dia 20% mais r\u00e1pido do que o m\u00e9todo com a matriz de 7 diagonais. Outro\n\n\n\nResultados e Discuss\u00f5es 88\n\nponto interessante \u00e9 a baixa performance do m\u00e9todo matrix-free, apesar do relativamente \n\nbaixo n\u00famero de itera\u00e7\u00f5es lineares e n\u00e3o-lineares realizadas. Atribui-se este fato ao custo por \n\nitera\u00e7\u00e3o mais elevado deste m\u00e9todo.\n\nTabela 6.31 -  Raz\u00e3o entre tempos de CPU\n\nCPU7/C P U 19\ncpu7 / cPLrf c p i t V\n\nCPU19\n\u00ab= 1 ,5 1,2 0,80 1,5\n\u00ab = 2,0 1,3 0,84 1,2\n\u00ab = 3,0 1,2 0,87 1,4\n\n\n\n7 Conclus\u00f5es e Recomenda\u00e7\u00f5es\n\n7.1 Conclus\u00f5es\n\nAo longo deste trabalho foram apresentados e analisados tr\u00eas classes distintas de \n\nm\u00e9todos de Krylov-Newton para a solu\u00e7\u00e3o do sistema n\u00e3o-linear, oriundo da discretiza\u00e7\u00e3o em \n\nvolumes finitos, usando coordenadas generalizadas, das equa\u00e7\u00f5es do modelo Black-Oil \n\npadr\u00e3o. A primeira dessas classes, que seria a implementa\u00e7\u00e3o padr\u00e3o, utiliza a matriz \n\nJacobiana completa com as 19 diagonais referentes \u00e0 discretiza\u00e7\u00e3o n\u00e3o-ortogonal em tr\u00eas \n\ndimens\u00f5es. J\u00e1 as outras duas classes de m\u00e9todos de Krylov-Newton baseiam-se em uma \n\naproxima\u00e7\u00e3o da matriz Jacobiana, em que apenas os termos ortogonais das equa\u00e7\u00f5es s\u00e3o \n\nutilizados na constru\u00e7\u00e3o da matriz. Em uma delas apenas desconsidera-se os termos ri\u00e3o- \n\nortogonais, dando origem a um m\u00e9todo quase-newtoniano, onde a lineariza\u00e7\u00e3o passa a ser \n\naproximada atrav\u00e9s de uma matriz com 7 diagonais. Este m\u00e9todo foi reportado no trabalho de \n\nMaliska et al. (1997). A terceira classe, introduzida neste trabalho, \u00e9 uma vers\u00e3o matrix-free, \n\nonde a matriz Jacobiana n\u00e3o \u00e9 calculada diretamente, mas atrav\u00e9s de uma aproxima\u00e7\u00e3o em \n\ndiferen\u00e7as finitas do produto matriz-vetor usado nos solvers de Kiylov. Neste caso, a \n\nlineariza\u00e7\u00e3o, apesar de ainda ser aproximada, leva em conta todas as 19 diagonais. Todavia, \n\nneste trabalho, foi proposto manter a montagem da matriz Jacobiana aproximada de 7 \n\ndiagonais para servir de matriz de precondicionamento.\n\nNeste trabalho foram ainda apresentados alguns conceitos e procedimentos importantes, \n\nintroduzidos por Eisenstat e Walker (1994, 1996) para os m\u00e9todos de Newton inexatos, tais \n\ncomo: oversolving, backtracking, forcing terms e m\u00e9todos adaptativos para a escolha dos \n\nforcing terms. \u00c9 importante ressaltar que atualmente os m\u00e9todos de Newton inexatos, \n\nsustentados pelo crescente avan\u00e7o de conhecimento, tanto te\u00f3rico, quanto no desenvolvimento \n\nde algoritmos, v\u00eam ganhando cada vez mais adeptos motivados pela sua excelente \n\nperformance na solu\u00e7\u00e3o de complexos sistemas de equa\u00e7\u00f5es n\u00e3o-iineares. Os trabalhos de \n\nZingg e seus alunos (e Pueyo, 1997, 1998; e Blanco, 1997) j\u00e1  mostram m\u00e9todos de Krylov- \n\nNewton, aplicados \u00e0 solu\u00e7\u00e3o simult\u00e2nea das equa\u00e7\u00f5es de Navier-Stokes, obtendo resultados \n\nmelhores do que alguns algoritmos consagrados que utilizam m\u00e9todos multigrid. Como se v\u00ea,\n\n\n\nConclus\u00f5es e Recomenda\u00e7\u00f5es 90\n\nesta \u00e9 uma \u00e1rea em expans\u00e3o no campo da an\u00e1lise num\u00e9rica e muita contribui\u00e7\u00e3o ainda pode \n\nser feita.\n\nAs principais conclus\u00f5es s\u00e3o listadas abaixo:\n\n\u2022 Em problemas transientes, tais como o da extra\u00e7\u00e3o de petr\u00f3leo estudado aqui, o \n\nprocedimento de backtracking \u00e9 pouco efetivo, j\u00e1 que a converg\u00eancia est\u00e1 sempre \n\npr\u00f3xima do regime assint\u00f3tico, fazendo com que a condi\u00e7\u00e3o necess\u00e1ria ao in\u00edcio do \n\nbacktracking seja raramente atendida.\n\n\u2022 Apesar de muito requisitado, o algoritmo de backtracking sugerido por Eisenstat e \n\nWalker (1994) mostrou-se ineficaz para os m\u00e9todos que utilizam a matriz Jacobiana \n\nde 7 diagonais.\n\n\u2022  Os m\u00e9todos adaptativos para a escolha dos forcing terms sugeridos por Eisenstat e \n\nWalker (1996) apresentaram resultados inexpressivos se comparados com o m\u00e9todo \n\nfixo com r]k = \u00cdCT2; que, para o m\u00e9todo que emprega a Jacobiana completa, \n\npraticamente n\u00e3o causa oversolving.\n\n\u2022 Os m\u00e9todos de Krylov-Newton que utilizam a matriz Jacobiana aproximada sofrem \n\ngraves problemas de oversolving.\n\n\u2022  Dos m\u00e9todos iterativos de Krylov testados (GMRES(r), TFQMR e BICGSTAB), o \n\nque apresentou, em geral, melhores resultados foi o GMRES com restart, \n\nprincipalmente quando empregado no m\u00e9todo matrix-free.\n\n\u2022 Com rela\u00e7\u00e3o ao precondicionamento utilizando o algoritmo baseado na fatoriza\u00e7\u00e3o \n\nLU incompleta de n\u00edvel n especializado para uma matriz de bloco, BILU(n), \n\ndiferentes n\u00edveis mostraram-se mais eficientes para cada m\u00e9todo de Newton inexato. \n\nPara o m\u00e9todo baseado na matriz Jacobiana exata, a fatoriza\u00e7\u00e3o de n\u00edvel 0 obteve \n\nmelhores resultados. J\u00e1 para o m\u00e9todo sugerido por Maliska et a l, sobressaiu-se o \n\nBILU de n\u00edvel 1. E, para o m\u00e9todo matrix-free, foi necess\u00e1rio utilizar um maior \n\nprecondicionamento, de n\u00edvel 2 a 3.\n\n\u2022 Para n\u00edveis do BILU de 0 a 2, o m\u00e9todo matrix-free ocupa de 2 a 1,4 vezes menos \n\nmem\u00f3ria do que o m\u00e9todo com a matriz de 7 diagonais e de 5 a 4,2 vezes menos do \n\nque o m\u00e9todo com a matriz de 19 diagonais.\n\n\u2022 Para os m\u00e9todos que utilizam a matriz Jacobiana aproximada, foi observada uma\n\n\n\nConclus\u00f5es e Recomenda\u00e7\u00f5es 91\n\nforte depend\u00eancia da n\u00e3o-ortogonalidade da malha. J\u00e1 o m\u00e9todo que emprega a \n\nmatriz de 19 diagonais mostrou-se muito mais robusto e pouco suscet\u00edvel \u00e0s \n\ndistor\u00e7\u00f5es da malha.\n\n\u2022 Mesmo para malhas muito pouco deformadas, como o paralelep\u00edpedo deformado \n\ntridimensionalmente por um \u00e2ngulo de 80\u00b0, o m\u00e9todo de Krylov-Newton que utiliza a \n\nmatriz de 19 diagonais obteve a melhor performance.\n\n\u2022 Para \u00e2ngulos de deforma\u00e7\u00e3o menores ou iguais a 60\u00b0, nos casos baseados no \n\nparalelep\u00edpedo deformado, o m\u00e9todo matrix-free possui uma performance maior do \n\nque o m\u00e9todo que emprega a matriz Jacobiana de 7 diagonais, tomando-se uma boa \n\nalternativa quando os recursos de mem\u00f3ria s\u00e3o escassos -  apesar de ainda muito atr\u00e1s \n\ndo m\u00e9todo com a Jacobiana de exata.\n\n\u2022 Observou-se que, em geral, h\u00e1 uma t\u00eanue queda na diferen\u00e7a de performance entre os \n\nm\u00e9todos com o aumento da n\u00e3o-linearidade das equa\u00e7\u00f5es.\n\n\u2022 Por fim, os tr\u00eas m\u00e9todos de Krylov-Newton foram comparados em um caso \n\nenvolvendo uma malha generalizada com uma distribui\u00e7\u00e3o irregular de n\u00e3o- \n\nortogonalidade. Novamente o m\u00e9todo que emprega a Jacobiana completa obteve a \n\nmelhor performance, seguido pelo m\u00e9todo de Maliska et a l..\n\n7.2 Recomenda\u00e7\u00f5es\n\nComo recomenda\u00e7\u00f5es sugere-se:\n\n\u2022 Utilizar o m\u00e9todo de Krylov-Newton que emprega a matriz Jacobiana com todas as \n\n19 diagonais derivadas da discretiza\u00e7\u00e3o em coordenadas generalizadas. Apesar da \n\n\u00e1rea livre de mem\u00f3ria necess\u00e1ria ser razoavelmente maior, este m\u00e9todo \u00e9 muito \n\nrobusto e r\u00e1pido.\n\n\u2022 N\u00e3o empregar baektracking em problemas transientes e sempre testar algumas \n\nalternativas de escolha dos forcing terms (fixas ou adaptativas), quando o problema \n\napresentar muito oversolving.\n\nPara os trabalhos futuros que porventura sejam realizados seguindo a linha de pesquisa \n\ndo presente trabalho, sugere-se:\n\n\n\nConclus\u00f5es e Recomenda\u00e7\u00f5es 92\n\n\u2022 Testar outras alternativas de escolha dos forcing terms para evitar o oversolving nos \n\nm\u00e9todos que utilizam a matriz Jacobiana completa. Uma escolha interessante e \n\nsimples seria fixar r]k em um valor relativamente alto por um n\u00famero pequeno de \n\nitera\u00e7\u00f5es iniciais e depois apertar a toler\u00e2ncia nas demais itera\u00e7\u00f5es at\u00e9 a \n\nconverg\u00eancia.\n\n\u2022 Aplicar o desenvolvimento te\u00f3rico de Eisenstat e Walker (1994, 1996) para m\u00e9todos \n\nquase-newtonianos que aproximam a matriz Jacobiana, de forma a obter algoritmos \n\nde backtracking e escolhas dos forcing terms que se ajustam melhor a estes tipos de \n\nm\u00e9todos.\n\n\u2022  Desenvolver, para as equa\u00e7\u00f5es da simula\u00e7\u00e3o de reservat\u00f3rios, aproxima\u00e7\u00f5es da \n\nmatriz Jacobiana com base nas \u00edun\u00e7\u00f5es interpola\u00e7\u00f5es, tal como \u00e9 comumente \n\nempregado na solu\u00e7\u00e3o das equa\u00e7\u00f5es de Navier-Stokes. Neste caso, a matriz Jacobiana \n\n\u00e9 aproximada apenas pelos termos de baixa ordem, aplicando-se m\u00e9todos de alta \n\nordem apenas na montagem das fun\u00e7\u00f5es res\u00edduo.\n\n\n\nAp\u00eandice A - Avalia\u00e7\u00e3o das Derivadas dos Potenciais\n\nAs equa\u00e7\u00f5es que governam o escoamento dos fluidos no reservat\u00f3rio de petr\u00f3leo, \n\nquando discretizadas, necessitam da avalia\u00e7\u00e3o das derivadas dos potenciais em todas as faces, \n\ncomo explanado no cap\u00edtulo 3. Estas derivadas ser\u00e3o aqui apresentadas.\n\nAs derivadas diretas dos potenciais s\u00e3o dadas por\n\n=  E\n0\u00bb - O\n\nH e H p\nA\u00c7 (A.1)\n\n( * * , )  F\n1 1  - w \n\nP F\n\nA\u00c7\n\n<D | -  O  1\nHn Hp\n\n1 ^  l  \" \u201c Ar)\n\n(A.2)\n\n(A.3)\n\n\u00e2  r\\ )\n\n4> - O  .\np lp Pis\n\nAt] (A-4)\n\n= F.\nj>|T p\\p \n\nAy (A. 5)\n\n<D -<PHp Hb\nAy (A.6)\n\nPor sua vez, as derivadas cruzadas s\u00e3o dadas por\n\n= F\n(f e O I + F eO j + F E O I  + F P<D I + F P<D i + F pO 1 )V \u2019JSE /\u2019IsE p\\u 1NE HnE \"\u00bbS Hs *1P Hp \u2019\u2019N /In '\n\nAti\n\n= F_\n(f e O I + F E<&amp; I + F E O 1 + F pO I +  F P<D I  +  F P<\u00cd> | )V TBE ?iBE yE PIe ?TE HtE TO 4  TP Hp TT p\\i >I T E\n\nAy\n\n(A.?)\n\n(A.8)\n\n\n\nAp\u00eandice A - Avalia\u00e7\u00e3o das Derivadas dos Potenciais 94\n\n' \u00e2 * , ( f  w  O  I + Fnw # J  +  F\u201eW &lt;&amp; J  +F_P\u00ae_|  +F_pO_| + F / 0 I )V *)sw P ls w  1W p (w  TOW PlNW J\u2019ls *1P P |p  IN  p | n /\nAt,\n\n= F\u201e,\n( f  w  O  I + F w O  I + F W  O  ! + F P 4 >  I + F p O  I  + F p O  I )\n\u201c t b w  \u00ed I b w  r w  %  r i w  \u00ed | t w  ?b ? Ib  *p p \\p n  p | t /\n\nSw Ay\n\n\u2014 F\u201e\nf c N o i  +F\u00abn o J  + F f N&lt;d I + F \u00a3p o J  + F ep<D j +  F,PFCP\u00ae J  )\n\\  ^ N W  ^ I n w  \u00a3 n  ^ I \u00ed s \u00ed  ^ n e  p \\n e  \u00a3 w  P \\w  ^ P  P \\ v  \u00c7 p  P \\ e J\n\nsn A4\n\ne\u00e2<b1 '\n\n, \u00e2 y u  \n\n( * * ,\nl &lt;?4\n\nr dQ>\n\n= F\u201e\n( f n  O  i  + F n &lt;D  I + F n  O  I +  F P &lt;\u00a3  I +  F P &lt;\u00a3  I  +  F P &lt;&amp;  I )V tbn %  ih 4  tis pItn \u00cdB ?Ib Tp p!p TT P\\t \u2019\n\n= E\nSS\n\n\u00e2 y\n\n1\nAy\n\n5\n\nk s &lt;5 1\nV ?SW -Plsw +  F . s O _ |5s /\u00bbIs +  Fi , I , , l SE +\n\nF, P O\n? W  P\n\n1 + F spO 1Iw  5p p |p +  f ep<d 1 )SE P |e  t\nA4\n\n(fys&lt;&amp;J +  F , S \u00ae J +  F\u201eS&lt;D\u201e F / O l +  F ,P \u00ae J  -f  FyP<I> ! )\n7 V ? B S  -P(BS TS Pis 7 T S  P Its p  1B T P  P | p 7T P\\t '\nS\n\nAy\n\n' \u00e2 \u00ae A  - v\n1 ^ 9 , 1  + F , I a > J  + f , L \u00ae J  + f fp.<dJ +  fZ<&amp;J + F fp<&amp;,\n\niTW P \\T  ^ T E  p \\t E  P \\w  ^ P  P \\p  P U\n\nd<* \\  \\F\u201e +F\u201e + F  \u2018 O l  +F\u201e<D I +  F&amp;1r O J  + F / &lt;D\n\"  * \u2014 '  ^TS jPIt s  ? \u00cd T  ^ TN  \u00cd^It N J*ls ^ P  ^ lp\n\nI + F P&lt;D I )\nPlp HN ^ I n '\n\nV Ari\n\nr \u00f5<b1 '  \nC * i Jh\n\n\u00e2r\\\n\nf c B + f \u00abb \u00ae J  + f , b \u00ae J  + f fp 4>J + f/ o\u00bbI  +  f, p<&amp;| )c \u201c \u00c7bw p Jb w  /Mb ? b e  p I b e  p | w  ^ p  ^ I p  5 e  p | e '\n~~ *b \" iB E\n\nA4\n\n= Ft\n\u00cdf b O  I + F b<P I  + F b&lt;&amp; I  + F pO  I + F  pO  I + F P $  I )\nV IBS p |bs *1B p Jb \u2019IBN ilB N  J\u00bbls $1P ^ ip  \u2019l \u00bb  \u00cd I n '\n\nAr\u00e7\n\nOs coeficientes F presentes nas equa\u00e7\u00f5es acima s\u00e3o chamados de coeficientes \n\nest\u00e3o reportados em detalhe em Cunha (1996).\n\n(A.9) \n\n(A. 10)\n\n( A l l )  \n\n(A. 12) \n\n(A. 13) \n\n(A.14)\n\n(A. 15)\n\n(A. 16)\n\n(A. 17)\n\n(A. 18) \n\nde falha e\n\n\n\nRefer\u00eancias Bibliogr\u00e1ficas 95\n\nRefer\u00eancias Bibliogr\u00e1ficas\n\nAAVATSMARK, I.; BARK VE, T.; B0E, 0 . and MANNSETH, T. \u201cDiscretization on non\u00ad\n\northogonal curvilinear grids fo r  multi-phase flo w \u201d Proc. 4th European Conference on the \n\nMathematics of Oil Recovery, vol. D, pp. 17, 1994.\n\nABOU-KASSEM, J.H. and AZIZ, K. \u201cHandling o f phase change in thermal simulators \n\nSPEJ, Sep. 1985.\n\nAZIZ, K. and SETTARRI, A. \u201cPetroleum reservoir s im u la tio n New York: ed. Applied \n\nScience Publishers, 1979.\n\nBARUA, J. and HORNE, R.N. \u201cImproving the performance o f parallel (and serial) reservoir \n\ns im u la to r s SPE 18408, 10th SPE Symposium on Reservoir Simulation, Houston, Feb. 6- \n\n8, 1989.\n\nBALAY, S.; GROPP, W.D.; McINNES, L.C. and SMITH, B.F. \u201cEfficient management o f \n\nparallelism in object oriented numerical software lib r a r ie s In: ARGE, E.; BRUASET, A. \n\nM. and LANGTANGEN, H. P. \u201cModern Software Tools in Scientific Computing \n\nBirkhauser Press, pp. 163-202, 1997.1\n\n_____. \u201c/PETSc} 2.0 Users Manual.\u201d Argonne National Laboratory, ANL-95/11 - Revision\n\n2.0.28, 2000.\n\nBARRETT, R.; BERRY, M.; CHAN, T.F.; DEMMEL, I ;  DONATO, June; DONGARRA, 1; \n\nEIJKHOUT, V.; POZO, R.; ROMINE, C. and van der VORST, H. \u201cTemplates fo r  the \n\nsolution o f linear systems: building blocks fo r  iterative methods\u201d SIAM, Philadelphia, \n\n1994.\n\nBERTIGER, W.I. and KELSEY, F.J. \u201cInexact adaptive Newton m e th o d s SPE 13501, SPE \n\n1985 Reservoir Simulation Symposium, Dallas, Feb. 10-13, 1985.\n\n\n\nRefer\u00eancias Bibliogr\u00e1ficas 96\n\nBLANCO, M. and ZINGG, D. W. \u201cA fa st solver fo r  the Euler equations on unstructured grids \n\nusing a Newton-GMRES method.\u201d AIAA Paper 97-0331 (A97-15398), AIAA, Aerospace \n\nSciences Meeting, 35th, Reno, NV, Jan. 6-9, 1997.\n\nBRITTO, P.R.F.; PEDROSA JR., O.A. and HORNE, R. \u201cApplication o f boundary-fitted \n\ncurvilinear grid to reservoir simulation. \u201d X\u00ed COBEM, pp. 129-132, S\u00e3o Paulo, Dez. 1991.\n\nBROWN, P.N. and SAAD, Y. \u201cHybrid Krylov methods fo r  nonlinear systems o f equations.\u201d \n\nSIAM J. Sci. Stat. Comput., vol. 11, pp. 450-481,1990.\n\nBROYDEN, C.G. \u201cA class o f methods fo r  solving nonlinear simultaneous equations.\u201d Math. \n\nComp., 19, pp. 577-593, 1965.\n\nCHIN, P.; D \u2019AZEVEDO, E.F.; FORSYTH, P.A. and TANG, W.P. \u201cPreconditioned \n\nconjugate gradient methods fo r  the incompressible Navier-Stokes equations.\u201d Int. J. \n\nNumer. Meth. Fluids, vol. 15, pp.273-295, 1992.\n\nCHOQUET, R. and ERHEL, J. \u201cNewton-GMRES algorithm applied to compressible flow s.\u201d \n\nInt. J. for Numer. Meth. Fluids, vol. 23, pp.177-190, 1996.\n\nCOATS, K.H. \u201cSimulation o f steamflooding with distillation and solution gas.\u201d SPEJ, 16, No. \n\n5, pp. 235-47, 1976.\n\n_____. \u201cElements o f Reservoir Simulation\u201d Lecture Notes, University of Texas, reprinted by\n\nIntercomp Resources Development and Engineering Inc., Houston.\n\nCOATS, K.EL; NIELSEN, R.L.; TERHUNE, M.H. and WEBER, A G . \u201cSimulation o f three- \n\ndimensional, two-phase flo w  in oil and gas reservoirs.\u201d Trans. SPE of AJME, 240, pp. \n\n377-88, 1967.\n\n\n\nRefer\u00eancias Bibliogr\u00e1ficas 97\n\nCOATS, K.H.; GEORGE, W.D. and MARCUM, B E. \u201cThree-dimensional simulation o f \n\nsteamflooding.\u201d Trans. SPE of AIME, 257, pp. 573-92, 1974.\n\nCOLLINS, R.E. \u201cFlow o f flu id s through porous m a te r ia ls Van Nostrand Reinhold, New \n\nYork, 1961.\n\nCUNHA, A.R. \u201c Uma metodologia para simula\u00e7\u00e3o num\u00e9rica tridimensional de reservat\u00f3rios \n\nde petr\u00f3leo utilizando modelo Black-Oil e formula\u00e7\u00e3o em fra\u00e7\u00f5es m\u00e1ssicas.\u201d \n\nFlorian\u00f3polis, 1996. Disserta\u00e7\u00e3o de Mestrado - Departamento de Engenharia Mec\u00e2nica, \n\nUFSC.\n\nCZESNAT, A.O. \u201cImplementa\u00e7\u00e3o de esquemas de interpola\u00e7\u00e3o para minimiza\u00e7\u00e3o da difus\u00e3o \n\nnum\u00e9rica em simula\u00e7\u00e3o de reservat\u00f3rio de petr\u00f3leo.\u2019'\u2019 Florian\u00f3polis, 1999. Disserta\u00e7\u00e3o de \n\nMestrado - Departamento de Engenharia Mec\u00e2nica, UFSC.\n\nDARCY, H. \u201cLes fontaines publiques de la Ville de Dijon\u201d, Dalmount, Paris, 1856. \n\n(republicado na integra em Hubbert, 1969)\n\nDEMBO, R.; EISENSTAT, S.C. and STEIHAUG, T. \u201cInexact Newton methods\u201d SIAM J. \n\nNumer. Anal., 19, pp. 400-408, 1982.\n\nDENNIS Jr., J.E. and SCHNABEL, K B. \u201cNumerical methods fo r  unconstrained optimization \n\nand nonlinear e q u a tio n s Series in Automatic Computation, Prentice-Hall, Englewood \n\nCliffs, NJ, 1983.\n\nDOUGLAS Jr., J.; PEACEMAN, D.W. and RACHFORD Jr., H.H. \u201cA method fo r  calculating \n\nmulti-dimensional immiscible d is p la c e m e n tTrans. SPE o f AIME, 216, pp. 297-306, \n\n1959.\n\nEISENSTAT, S.C. and WALKER, H.F. \u201cGlobally convergent inexact Newton methods \n\nSIAM J. Optimization, 4, pp.393-422, 1994.\n\n\n\nRefer\u00eancias Bibliogr\u00e1ficas 98\n\n_____. \u201cChoosing the forcing terms in an inexact Newton method \u201d SIAM J. Sei. Comput.,\n\n17, pp. 16-32, 1996.\n\nFLEMING, G.C. \u201cM odeling the performance o f fractured wells in pattern floods using \n\northogonal curvilinar grids\" SPEJ, Oct. 1984.\n\nFORSYTH, P.A. and SAMMON, P H . \u201cGas phase appearance and disappearance in fu lly  \n\nimplicit Black, Oil simulation.\u201d SPEJ, Oct. 1984.\n\n_?___ . \u201cPractical consideration fo r  adaptive implicit methods in reservoir simulation.\u201d\n\nJournal o f Computational Physics, Sep. 1986.\n\nFREUND, R.W. \u201cA Transpose-Free Quasi-Minimal Residual algorithm fo r  non-Hermitian \n\nlinear systems.'\u201d SIAM Journal on Scientific Computing, 14(2), pp. 470-482, 1993.\n\nGROPP, W.D. and KEYES, D.E. \u201cDomain decomposition methods in computational flu id  \n\nd y n a m ic s Int. J. Numer. Meth. Fluids, vol. 14, pp. 147-165, 1992.\n\nHEGRE, T.M.; DALEN, V. and HENRIQUEZ, A. \u201cGeneralized transmissibilities fo r \n\ndistorted grids in reservoir s im u la tio n SPE 15622, Proc. SPE 61th Annual Technical \n\nConference and Exhibition, New Orleans, 1986.\n\nHIRASAKI, G.J. and O\u2019DELL, P.M. \u201cRepresentation o f reservoir geometry fo r numerical \n\ns im u la tio n SPEJ, Dec. 1970.\n\nHUBBERT, M.K. \u201cD arcy\u2019s Law and the fie ld  equations o f the flo w  o f underground flu id s.\u201d \n\nTrans. SPE o f AIME, 207, pp. 222-39, 1956. (republicado com corre\u00e7\u00f5es em Hubbert, \n\n1969)\n\n__ . \u201cThe theory o f ground-water motion and related p a p ers\u201d, Hafiier Publishing, New\n\nYork, 1969\n\n\n\nRefer\u00eancias Bibliogr\u00e1ficas 99\n\nJOHNSON, R.W.; McHUGH, P.R. and KNOLL, D.A. \u201cHigh-order scheme implementation \n\nusing Newton-Krylov solution m e th o d s Numerical Heat Transfer, Part B, 31, pp. 295- \n\n312, 1997.\n\n_____. \u201cD efect correction with a  fu lly  coupled inexact Newton m ethod\u201d Numer. Heat\n\nTransfer, Part B, vol. 14, pp. 147-165, 1992.\n\nKIM, J.G. and DEO, M.D. \u201cInexact Newton-Krylov methods fo r  the solution o f implicit \n\nreservoir simulation p r o b le m s SPE 51908, 1999 SPE Reservoir Simulation Symposium, \n\nHouston, Feb. 14-17,1999.\n\nMacDONALD, R.C. and COATS, K. H. \u201cMethods fo r  numerical simulation o f  water and gas \n\nc o n i n g Trans. SPE o f AIME, 249, pp. 425-36, 1970.\n\nMALISKA C.R. \u201cA solution method fo r  three-dimensional parabolic flu id  flow  problems in \n\nnonorthogonal coordinates PhD. Thesis, University of Waterloo, Waterloo, Canada, \n\n1981.\n\n. C.R. \u201cTransfer\u00eancia de Calor e Mec\u00e2nica dos Fluidos C o m p u ta c io n a lRio de \n\nJaneiro, RJ, Brasil: ed. LTC - Livros T\u00e9cnicos e Cient\u00edficos Editora S. A., 1995.\n\nMALISKA, C.R.; CUNHA, A.R.; LIVRAMENTO, M.A. and SILVA A.F.C. \n\n\u201cTridimensional petroleum reservoir simulation using generalized curvilinear \n\ncoordinates \u201d V Encontro Nacional de Ci\u00eancias T\u00e9rmicas, pp. 363-366, S\u00e3o Paulo, Dez. \n\n1994.\n\nMALISKA C.R.; SILVA A.F.C.; CZESNAT, A.; LUCIANETTI, R.M. and MALISKA Jr., \n\nC.R., \u201cThree-dimensional multiphase flow  simulation in petroleum reservoirs using the \n\nmass fractions as dependent variables\u201d SPE 39067, Aug. 1997.\n\n\n\nRefer\u00eancias Bibliogr\u00e1ficas 100\n\nMARCONDES, F. \u201cSolu\u00e7\u00e3o num\u00e9rica usando m\u00e9todos adaptativos-impl\u00edcitos e malha de \n\nVoronoi de problemas de reservat\u00f3rios de petr\u00f3leo\u201d Florian\u00f3polis, 1996. Tese de \n\nDoutorado - Departamento de Engenharia Mec\u00e2nica, UFSC.\n\nMATTHEIS, H. and STRANG, G. \u201cThe solution o f nonlinear fin ite element equations.\u201d Int. J. \n\nNum. Meth. Eng., 14, pp.1613-1626, 1979.\n\nMEZZOMO, R.F. LL() escoamento em meios porosos na ind\u00fastria do petr\u00f3leo.\u201d B T\u00e9cn. \n\nPETROBR\u00c1S, Rio de Janeiro, 35, pp. 21-22, 1992.\n\nNGHEIM, L.X. \u201cA new approach to Quasi-Newton methods with application to \n\ncompositional m odeling\u2019 SPE 12242, 1983 SPE Reservoir Simulation Symposium, San \n\nFrancisco, Nov. 15-18, 1983.\n\nPEACEMAN, D.W. \u201cFundamentals o f numerical reservoir s im u la tio n Elsevier Science \n\nPublishing Co., New York, 1977.\n\nPERNICE, M. and WALKER, H.F. \u201cNITSOL: a Newton iterative solver fo r  nonlinear \n\nsystems.\u201d Tech. Rep. 5/96/85, Mathematics and Statistics Department, Utah State \n\nUniversity, May 1996.\n\nPRATS F. e CAMPAGNOLO, E. A  \u201cModelagem do escoamento multif\u00e1sico em simula\u00e7\u00e3o de \n\nre se rv a t\u00f3 r io XICOBEM, pp. 545-548, S\u00e3o Paulo, Dez. 1991.\n\nPUEYO, A. and ZINGG, D. W. \u201cAn efficient Newton-GMRES solver fo r  aerodynamic \n\ncomputations.\u201d AIAA Paper 97-1955 (A97-32464), AIAA, Computational Fluid Dynamics \n\nConference, 13th, Snowmass Village, CO, June 29-July 2, 1997.\n\n__ . \u201cProgress in Newton-Krylov methods fo r  aerodynamic calculations.\u201d AIAA Paper 97-\n\n0877 (A97-15875), AIAA, Aerospace Sciences Meeting, 35th, Reno, NV, Jan. 6-9, 1997.\n\n\n\nRefer\u00eancias Bibliogr\u00e1ficas 101\n\n_____. \u201cImprovements to a Newton-Krylov solver fo r  aerodynamic f l o w s AIAA Paper 98-\n\n0619 (A98-16464), AIAA, Aerospace Sciences Meeting &amp; Exhibit, 36th, and 1998 ASME \n\nWind Energy Symposium, Reno, NV, Jan. 12-15, 1998.\n\nRHEINBOLDT, W.C. \u201cMethods fo r  solving systems o f nonlinear equations.\u201d 2nd Edition, \n\nSIAM, Philadelphia, 1998.\n\nROBERTSON, G.E. and WOO, P.T. \u201cGrid orientation effects and the use o f orthogonal \n\ncurvilinear coordination in reservoir simulation.\u201d SPEJ, Feb. 1978.\n\nRUSSEL, T.F. \u201cStability analysis and switching criteria fo r  adaptive implicit methods based \n\non the CFL condition.\u201d SPEJ, Feb. 1989.\n\nSAAD, Y. \u201cIterative Methods fo r  Sparse Linear S y s t e m s PWS Publishing Co., Boston, \n\n1996.\n\nSAAD, Y and SCHULTZ, M.H. \u201cGMRES: a generalized minimal residual algorithm fo r  \n\nsolving nonsymmetric linear systems.\u201d SIAM Journal on Scientific and Statistical \n\nComputing, 7, pp. 856-869, 1986.\n\nSCHEIDEGGER, A.E. \u201cPhysics o f flow  through porous media \u201d 3rd end., University of \n\nToronto Press, Toronto, 1974.\n\nSHADID, J.N.; TUMINARO, R.S. and WALKER, H.F. \u201cAn inexact Newton method fo r  fu lly - \n\ncoupled solution o f the Navier-Stokes equations with heat and mass transport.\u201d SANDIA \n\nReport, SAND97-0132, Feb. 1997.\n\nSHARPE, H.N. and ANDERSON, D .A  \u201cA new adaptive orthogonal grid generation \n\nprocedure fo r  reservoir simulation.\u201d SPE 20744, 65* ATC&amp;E, New Orleans, Sep. 23-26,\n\n1990.\n\n\n\nRefer\u00eancias Bibliogr\u00e1ficas 102\n\n. \u201cOrthogonal curvilinear grid generation with preset internal boundaries fo r  reservoir \n\nsimulation \u201d SPE 21235, 11* Reservoir Simulation Symposium, Anaheim, Feb 17-20,\n\n1991.\n\nSHEFFIELD, M. \u201cThree phase flow  including gravitational, viscous, and capillary fo rc e s\u201d \n\nTrans. SPE of AIME, 246, pp. 255-69, 1969.\n\nSHELDON, J.W.; ZONDEK, B. and CARDWELL, W T. \u201cOne-dimensional, incompressible, \n\nnon-capillary, two-phase flu id  flow  in a porous medium.\u201d Trans. SPE of AIME, 216, pp. \n\n290-6, 1959.\n\nSONIER, F. and CHAUMET, P. \u201cA fu lly  implicit three dimensional model in curvilinear \n\ncoordinates\u201d Trans. SPE 253, pp. 361-70, 1974.\n\nSONNEVELD, P. \u201cC G S a  fa st Lanczos-type solver fo r  nonsymmetric linear system s\u201d SIAM \n\nJournal on Scientific and Statistical Computing, 10(1), pp. 36-52, 1989.\n\nSPILLETTE, A.G.; HILLESTAD, J.G. and STONE, H.L. \u201cA high-stability sequential \n\nsolution approach to reservoir simulation\u201d SPE 4542, 48th Annual Fall Meeting, Las \n\nVegas, 1973.\n\nSTONE, H.L. and GARDER Jr., A O . \u201cAnalysis o f gas-gap or dissolved-gas reservoirs\u201d \n\nTrans. SPE o f AIME, 222, pp. 92-104, 1961.\n\nTHOMAS, G.W. and THURNAU, D.H. \u201cReservoir simulation using and adaptive implicit \n\nm ethod\u201d SPEJ, Feb. 1983.\n\nTHOMPSON, J.F.; THAMES, F.C. and MASTIN, W.C. \u201cBoundary-fitted curvilinear \n\ncoordinates system fo r  solution o f partial differential equation on field s containing any \n\nnumber o f arbitrary two-dimensional bodies \u201d NASA Langley Research Centre, CR-2729, \n\nEU A  1976.\n\n\n\nRefer\u00eancias Bibliogr\u00e1ficas 103\n\n_____. \u201cTOMCAT -  A code fo r  numerical generation o f boundary-fitted curvilinear\n\ncoordinate systems on field s containing any number or arbitrary two-dimensional bodies.\u201d \n\nJournal of Computational Physics, vol. 24, pp. 274-302, 1977.\n\nvan der VORST, \u201cBi-CGSTAB: A fa s t and smoothly converging variant o f Bi-CG fo r  the \n\nsolution o f non-symmetric linear systems.\u201d SIAM Journal on Scientific and Statistical \n\nComputing, 12, pp. 631-644, 1992.\n\nWHITAKER, S. \u201cThe equations o f motion in porous media.\u201d Chem. Eng. Sci., 21, pp. 291- \n\n300, 1966.\n\n__ . \u201cAdvances in theory o f flu id  motion in porous media.\u201d Indust, and Engineering\n\nChemistry, 61, No. 12, pp. 14-28, 1969."}]}}}