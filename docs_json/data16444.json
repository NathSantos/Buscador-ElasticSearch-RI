{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.20943"}, {"@name": "filename", "#text": "4607_000882460.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "BRAULIO MANENTE DUTRA  \n \n \n \n \n \n \n \n \n \n \n \n\nNovas metodologias e m\u00e9todos de an\u00e1lise de dados de perfura\u00e7\u00e3o de po\u00e7os de petr\u00f3leo e \ng\u00e1s natural, e de implementa\u00e7\u00e3o de curvas de drill-rate test em tempo real visando \n\notimiza\u00e7\u00e3o do processo \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n\nGuaratinguet\u00e1 - SP \n2016 \n\n \n  \n\n\n\n \n \n\nBraulio Manente Dutra \n \n \n \n \n \n \n\nNovas metodologias e m\u00e9todos de an\u00e1lise de dados de perfura\u00e7\u00e3o de po\u00e7os de petr\u00f3leo e \ng\u00e1s natural, e de implementa\u00e7\u00e3o de curvas de drill-rate test em tempo real visando \n\notimiza\u00e7\u00e3o do processo \n \n \n \n \n \n \n \n \n\n \nTrabalho de Gradua\u00e7\u00e3o apresentado ao \nConselho de Curso de Gradua\u00e7\u00e3o em \nEngenharia Mec\u00e2nica da Faculdade de \nEngenharia do Campus de Guaratinguet\u00e1, \nUniversidade Estadual Paulista, como parte dos \nrequisitos para obten\u00e7\u00e3o do diploma de \nGradua\u00e7\u00e3o em Engenharia Mec\u00e2nica. \n \n \nOrientador: Prof. Dr. Andreas Nascimento \nCoorientador: Prof. Dr. Mauro Pedro Peres \n\n \n \n \n \n \n \n \n\nGuaratinguet\u00e1 - SP \n2016 \n\n  \n\n\n\n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n\n \n\nD978n \n\nDutra, Braulio Manente \n      Novas metodologias e m\u00e9todos de an\u00e1lise de dados de perfura\u00e7\u00e3o de \npo\u00e7os de petr\u00f3leo e g\u00e1s natural, e de implementa\u00e7\u00e3o de curvas de drill-rate \ntest em tempo real visando otimiza\u00e7\u00e3o do processo / Braulio Manente \nDutra \u2013 Guaratinguet\u00e1, 2017. \n      57 f : il.  \n      Bibliografia: f. 45 \n\n      \n\n      Trabalho de Gradua\u00e7\u00e3o em Engenharia Mec\u00e2nica \u2013 Universidade \n\nEstadual Paulista, Faculdade de Engenharia de Guaratinguet\u00e1, 2017. \n\n      Orientador: Prof. Dr. Andreas Nascimento \n      Co-orientador: Prof. Dr. Mauro Pedro Peres \n \n\n \n\n1. Po\u00e7os de petr\u00f3leo \u2013 perfura\u00e7\u00e3o. 2. Perfura\u00e7\u00e3o e broqueamento. \n\n3. Engenharia do petr\u00f3leo.  I. T\u00edtulo \n\n  \n\nCDU 622.323                                                                        \n\n \n\n \n\n \n\n \n\n\n\n \n \n\n \n\n\n\n \n \n\nAGRADECIMENTOS \n \n \n\nAos meus pais e irm\u00e3os, pelo apoio e incentivo durante meus anos de gradua\u00e7\u00e3o e nesse \n\nper\u00edodo de pesquisa para a realiza\u00e7\u00e3o do trabalho de conclus\u00e3o de curso. \n\nAo meu orientador Prof. Dr. Andreas Nascimento, por me apresentar o tema proposto e \n\nauxiliar na minha contextualiza\u00e7\u00e3o aos m\u00e9todos de perfura\u00e7\u00e3o e explora\u00e7\u00e3o de petr\u00f3leo. \n\n\u00c0 Ag\u00eancia Nacional do Petr\u00f3leo, G\u00e1s Natural e Biocombust\u00edveis (ANP), \u00e0 Financiadora \n\nde Estudos e Projetos (FINEP) e ao Minist\u00e9rio da Ci\u00eancia, Tecnologia e Inova\u00e7\u00e3o (MCTI) pelo \n\napoio financeiro atrav\u00e9s do Programa de Recursos Humanos da ANP para o Setor Petr\u00f3leo e \n\nG\u00e1s PRH-ANP/MCTI no 48. \n\nE \u00e0s pessoas com quem convivi ao longo da minha vida e que, de alguma forma, \n\ncolaboraram para o desenvolvimento da pessoa que sou hoje.  \n\n\n\n \n \nDUTRA, B. M. Novas metodologias e m\u00e9todos de an\u00e1lise de dados de perfura\u00e7\u00e3o de po\u00e7os \n\nde petr\u00f3leo e g\u00e1s natural, e de implementa\u00e7\u00e3o de curvas de drill-rate test em tempo real \n\nvisando otimiza\u00e7\u00e3o do processo. 2016. 57 f. Trabalho de Gradua\u00e7\u00e3o (Gradua\u00e7\u00e3o em \n\nEngenharia Mec\u00e2nica) \u2013 Faculdade de Engenharia do Campus de Guaratinguet\u00e1, Universidade \n\nEstadual Paulista, Guaratinguet\u00e1, 2016. \n\n \n\nRESUMO \n\n \n\nCom o objetivo de um desenvolvimento de metodologias e m\u00e9todos de processamento e an\u00e1lise \n\nmatem\u00e1tica dos dados de perfura\u00e7\u00e3o de po\u00e7os de petr\u00f3leo e g\u00e1s natural, foram utilizados dados \n\nde um po\u00e7o perfurado na regi\u00e3o de pr\u00e9-sal, que apresentou in\u00fameras dificuldades relacionadas \n\n\u00e0 alta dureza e heterogeneidade das rochas carbon\u00e1ticas, e aplicadas ferramentas estat\u00edsticas de \n\nfiltragem e avalia\u00e7\u00e3o das distribui\u00e7\u00f5es desses dados, como o diagrama de caixa, de modo a \n\nprepara-los para o modelamento da rela\u00e7\u00e3o entre as vari\u00e1veis envolvidas de forma an\u00e1loga ao \n\nrealizado em testes de perfura\u00e7\u00e3o peri\u00f3dicos. Foi confirmada a possibilidade de gera\u00e7\u00e3o das \n\ncurvas utilizando dados de perfura\u00e7\u00e3o de testes e de opera\u00e7\u00e3o normal, inclusive de curvas \n\nqualitativas para situa\u00e7\u00f5es com pouca informa\u00e7\u00e3o dispon\u00edvel, tornando poss\u00edvel uma futura \n\nimplementa\u00e7\u00e3o de ferramentas program\u00e1ticas de gera\u00e7\u00e3o e atualiza\u00e7\u00e3o de curvas de drill-rate \n\nem tempo real, auxiliando na escolha dos par\u00e2metros \u00f3timos de perfura\u00e7\u00e3o e otimizando o \n\nprocesso.  \n\n \n \n\nPALAVRAS-CHAVE: Perfura\u00e7\u00e3o. Pr\u00e9-sal. Drill-rate test. ROP. Otimiza\u00e7\u00e3o. Tempo real.  \n\n \n  \n\n\n\n \n \nDUTRA, B. M. New methodologies and methods of petroleum and natural gas well drilling \n\ndata analysis, and real time drill-rate test curve implementation aiming process \n\noptimization. 2016. 57 p. Graduate Work (Graduate in Mechanical Engineering) \u2013 Faculdade \n\nde Engenharia do Campus de Guaratinguet\u00e1, Universidade Estadual Paulista, Guaratinguet\u00e1, \n\n2016. \n\n \n\nABSTRACT \n\n \n\nAiming the development of a methodology and methods of processing and mathematically \n\nanalyzing oil and natural gas well drilling data, a case study was conducted using the data from \n\na well drilled in the pre-salt region, which presented countless difficulties related to the high \n\nhardness and heterogeneity of the carbonate rocks, and statistical tools for the filtration and \n\nevaluation of the distribution of these data were employed, such as the boxplot, in order to \n\nprepare them for the modelling of the relationship between the variables involved in a similar \n\nmanner to how it\u2019s done with periodic drill tests. The possibility for the generation of curves \n\nusing drilling data from tests and regular operation was confirmed, including for qualitative \n\ncurves in situations where very few information is available, making it possible for a future \n\nimplementation of programmatic tools to generate and update drill-rate curves in real time, \n\nassisting in the decision to adjust the drilling parameters optimally and improving the overall \n\ndevelopment of the operation. \n\n \n\nKEYWORDS: Drilling. Pre-salt. Drill-rate test. ROP. Optimization. Real time. \n\n\n\n \n \n\nLISTA DE FIGURAS \n\n \n\nFigura 1 - Componentes de uma sonda de perfura\u00e7\u00e3o rotativa. (1) Torre de perfura\u00e7\u00e3o, (2) \n\nMangueira de perfura\u00e7\u00e3o, (3) Standpipe, (4) Swivel, ou cabe\u00e7a de inje\u00e7\u00e3o, (5) Bell nipple, (6) \n\nBOP, (7) Dutos do BOP, (8) Coluna de perfura\u00e7\u00e3o, (9) Comandos, (10) Broca, (11) Annulus, \n\nou anular de perfura\u00e7\u00e3o, (12) Tubo de revestimento, (13) Bomba do sistema de lama ........... 15 \n\nFigura 2 - Tipos de sonda de perfura\u00e7\u00e3o para uso em alto-mar ............................................... 16 \n\nFigura 3 - Curva de drill-rate t\u00edpica encontrada ao realizar testes de perfura\u00e7\u00e3o .................... 17 \n\nFigura 4 - Curvas do primeiro drill-rate test geradas com dados do relat\u00f3rio e calculados .... 20 \n\nFigura 5 - Curvas do segundo drill-rate test geradas com dados do relat\u00f3rio e calculados ..... 21 \n\nFigura 6 - Curvas de drill-rate aproximadas para dados de rota\u00e7\u00e3o entre 100 e 140 rpm, e \n\nfluxo entre 750 e 800 gpm, evidenciando diferentes comportamentos .................................... 23 \n\nFigura 7 - Curvas de drill-rate aproximadas para dados filtrados de rota\u00e7\u00e3o 120 rpm e fluxo \n\n800 gpm, destacando mudan\u00e7a no sentido das curvas.............................................................. 24 \n\nFigura 8 - Curvas aproximadas por regress\u00e3o linear, utilizando os dados originais e os dados \n\nreduzidos \u00e0 m\u00e9dia ..................................................................................................................... 26 \n\nFigura 9 - Ferramenta de diagrama de caixa, estabelecendo um intervalo de confian\u00e7a de \n\n99,3% ........................................................................................................................................ 28 \n\nFigura 10 - Ferramenta de diagrama de caixa ajustado, estabelecendo um intervalo de \n\nconfian\u00e7a para uma distribui\u00e7\u00e3o assim\u00e9trica ............................................................................ 29 \n\nFigura 11 - Curvas aproximadas por regress\u00e3o linear, utilizando os dados originais e os dados \n\nfiltrados (com valores ponderados) .......................................................................................... 31 \n\nFigura 12 - Distribui\u00e7\u00e3o da diferen\u00e7a entre a m\u00e9dia de uma popula\u00e7\u00e3o de 32 dados e as \n\nm\u00e9dias de amostras de 5 dados coletados aleatoriamente ........................................................ 32 \n\nFigura 13 - Gr\u00e1fico de dispers\u00e3o das margens de erro m\u00e1ximas esperadas para um intervalo de \n\nconfian\u00e7a de 95%, em rela\u00e7\u00e3o ao tamanho das amostras ......................................................... 33 \n\nFigura 14 - Dados de perfura\u00e7\u00e3o do po\u00e7o Ogonga-1. Em destaque (vermelho), os valores \n\ndetectados como aberrantes pelos m\u00e9todos de filtragem inicial............................................... 38 \n\nFigura 15 - Curvas calculadas ao longo do progresso dos m\u00e9todos, para rota\u00e7\u00e3o de 110 rpm e \n\nfluxo de 600 gpm ...................................................................................................................... 39 \n\nFigura 16 - Curvas calculadas ao longo do progresso dos m\u00e9todos, para rota\u00e7\u00e3o de 140 rpm e \n\nfluxo de 650 gpm ...................................................................................................................... 40 \n\nFigura 17 - Curvas calculadas ao longo do progresso dos m\u00e9todos, para rota\u00e7\u00e3o de 160 rpm e \n\nfluxo de 700 gpm ...................................................................................................................... 40 \n\n\n\n \n \nFigura 18 - Curvas calculadas ao longo do progresso dos m\u00e9todos, para rota\u00e7\u00e3o de 120 rpm e \n\nfluxo de 600 gpm ...................................................................................................................... 42 \n\n \n\n \n\n\n\n \n \n\nLISTA DE TABELAS \n\n \n\nTabela 1 - Dados do drill-rate test realizado no sexto RIH, retirados do relat\u00f3rio de opera\u00e7\u00e3o\n\n .................................................................................................................................................. 19 \n\nTabela 2 - Dados do drill-rate test no sexto RIH, calculados a partir dos dados originais ...... 19 \n\nTabela 3 - Dados do drill-rate test realizado no s\u00e9timo RIH, retirados do relat\u00f3rio de opera\u00e7\u00e3o\n\n .................................................................................................................................................. 20 \n\nTabela 4 - Dados do drill-rate test no s\u00e9timo RIH, calculados a partir dos dados originais .... 21 \n\nTabela 5 - Tamanhos amostrais calculados para diferentes valores de margem de erro m\u00e1xima \n\npara ROP .................................................................................................................................. 33 \n\nTabela 6 - Valores de margem de erro m\u00e1xima para WOB calculados para tamanhos \n\namostrais determinados na tabela 5 .......................................................................................... 34 \n\nTabela 7 - Distribui\u00e7\u00e3o de probabilidades de curvas perfeitas com 6 pontos e valores de range \n\nentre 0,5 e 6, ao serem aplicadas varia\u00e7\u00f5es em y de at\u00e9 1,2, gerem curvas aproximadas com \n\nvalores de range entre 0,5 e 8,5 ................................................................................................ 36 \n\nTabela 8 - Probabilidades de curvas aproximadas com 6 pontos e valores de range entre 0,5 e \n\n8,5 apresentarem a coordenada horizontal de seus v\u00e9rtices deslocada do v\u00e9rtice real em at\u00e9 10 \n\na 30%, em rela\u00e7\u00e3o ao founder point ......................................................................................... 36 \n\n \n\n \n  \n\n\n\n \n \n\nLISTA DE QUADROS \n\n \n\nQuadro 1 - Classifica\u00e7\u00e3o de po\u00e7os ........................................................................................... 14 \n\nQuadro 2 - Detalhes da opera\u00e7\u00e3o de perfura\u00e7\u00e3o do po\u00e7o Ogonga-1 ........................................ 18 \n\nQuadro 3 - C\u00f3digo fonte de rotina no MATLAB para organizar e filtrar dados, e gerar curvas \n\nde drill-rate ............................................................................................................................... 46 \n\nQuadro 4 - C\u00f3digo fonte de rotina no MATLAB para determinar curva de drill-rate \u00f3tima \n\nutilizando as tabelas de confian\u00e7a ............................................................................................ 52 \n\nQuadro 5 - C\u00f3digo fonte de rotina auxiliar no MATLAB, desenvolvido como fun\u00e7\u00e3o \n\ncheckcurve, para determinar a confiabilidade das curvas de drill-rate utilizando as tabelas de \n\nconfian\u00e7a ................................................................................................................................... 56 \n\n  \n\nfile:///C:/Users/Braulio%20Dutra/Desktop/TG/Tese/TG.docx%23_Toc474078392\nfile:///C:/Users/Braulio%20Dutra/Desktop/TG/Tese/TG.docx%23_Toc474078392\n\n\n \n \n\nLISTA DE ABREVIATURAS E SIGLAS \n\n \n\nANP  Ag\u00eancia Nacional do Petr\u00f3leo, G\u00e1s Natural e Biocombust\u00edveis \n\nBDEP  Banco de Dados de Explora\u00e7\u00e3o e Produ\u00e7\u00e3o \n\nBHA  Bottom hole assembly (Conjunto de instrumentos e ferramentas de po\u00e7o) \n\nBOP  Blowout preventer \n\nFLO   Fluxo do fluido de perfura\u00e7\u00e3o \n\nPDC   Polycrystalline Diamond Compact (Broca de diamante policristalino) \n\nRIH   Run-in-hole (Descida das ferramentas no po\u00e7o) \n\nROP  Rate of penetration (Taxa de penetra\u00e7\u00e3o) \n\nRPM  Rota\u00e7\u00e3o do eixo de perfura\u00e7\u00e3o \n\nWOB   Weight on bit (Peso na broca) \n\n \n  \n\n\n\n \n \n\nSUM\u00c1RIO \n\n \n1 INTRODU\u00c7\u00c3O ....................................................................................................... 12 \n\n1.1 MOTIVA\u00c7\u00c3O .......................................................................................................... 12 \n\n1.2 OBJETIVOS ............................................................................................................. 12 \n\n1.3 ORGANIZA\u00c7\u00c3O DO TRABALHO ....................................................................... 12 \n\n2 FUNDAMENTA\u00c7\u00c3O TE\u00d3RICA .......................................................................... 14 \n\n2.1 OPERA\u00c7\u00c3O DE PERFURA\u00c7\u00c3O DE PO\u00c7OS ....................................................... 14 \n\n2.2 TESTE DE PERFURA\u00c7\u00c3O (DRILL-RATE TEST) ................................................. 16 \n\n2.3 DADOS DO PO\u00c7O PERFURADO ......................................................................... 18 \n\n3 DESENVOLVIMENTO .......................................................................................... 19 \n\n3.1 AN\u00c1LISE INICIAL ................................................................................................. 19 \n\n3.2 GERA\u00c7\u00c3O DE CURVAS DE DRILL-RATE .......................................................... 22 \n\n3.3 FILTRAGEM E AN\u00c1LISE DOS DADOS .............................................................. 24 \n\n3.3.1 Metodologia de filtragem ........................................................................................ 24 \n\n3.3.2 Ferramentas estat\u00edsticas de determina\u00e7\u00e3o de outliers .......................................... 26 \n\n3.3.2.1 Diagrama de caixa ajustado ....................................................................................... 29 \n\n3.3.3 Confiabilidade em amostras pequenas .................................................................. 30 \n\n3.3.4 Aproxima\u00e7\u00e3o de curvas de drill-rate com tabelas de confian\u00e7a........................... 37 \n\n4 RESULTADOS ........................................................................................................ 38 \n\n5 CONCLUS\u00c3O .......................................................................................................... 43 \n\nBIBLIOGRAFIA ..................................................................................................... 45 \n\nAP\u00caNDICE A \u2013 C\u00d3DIGO FONTE DE ROTINAS NO MATLAB .................... 46 \n\n \n\n \n\n\n\n12 \n \n\n \n\n1 INTRODU\u00c7\u00c3O  \n\n \n1.1 MOTIVA\u00c7\u00c3O \n\n \nO processo de perfura\u00e7\u00e3o de po\u00e7os de petr\u00f3leo vem evoluindo constantemente de modo \n\na reduzir os custos envolvidos e o tempo de opera\u00e7\u00e3o atrav\u00e9s de medidas de otimiza\u00e7\u00e3o como \n\na melhoria na geometria e composi\u00e7\u00e3o dos elementos das brocas utilizadas, an\u00e1lises litol\u00f3gicas \n\nda regi\u00e3o a ser perfurada, e testes de perfura\u00e7\u00e3o realizados periodicamente, como o drill-rate \n\ntest, que auxiliam na escolha dos par\u00e2metros de opera\u00e7\u00e3o adequados. Entretanto, po\u00e7os \n\nperfurados em rochas de composi\u00e7\u00e3o heterog\u00eanea, particularmente as encontradas nas regi\u00f5es \n\nde pr\u00e9-sal entre as costas africana e sul-americana, al\u00e9m de apresentam uma baixa taxa de \n\npenetra\u00e7\u00e3o por conta da alta dureza dos dep\u00f3sitos carbon\u00e1ticos que as comp\u00f5em, sofrem de \n\numa constante varia\u00e7\u00e3o litol\u00f3gica que torna necess\u00e1ria a realiza\u00e7\u00e3o de testes de perfura\u00e7\u00e3o com \n\nmaior frequ\u00eancia, demandando muito tempo e atrasando o avan\u00e7o do processo (HBAIEB e \n\nAZAR, 2013). Al\u00e9m disso, de modo a atualizar os par\u00e2metros utilizados durante a perfura\u00e7\u00e3o, \n\nos dados da opera\u00e7\u00e3o normalmente s\u00e3o analisados de uma forma manual e dependente da \n\nexperi\u00eancia e intui\u00e7\u00e3o dos engenheiros e operadores envolvidos (MITCHELL e MISKA, 2011), \n\no que pode resultar em um subaproveitamento dos recursos utilizados. \n\n \n1.2 OBJETIVOS \n\n \nDesenvolvimento da metodologia e m\u00e9todos para a implementa\u00e7\u00e3o de ferramentas de \n\nan\u00e1lise dos dados de perfura\u00e7\u00e3o em tempo real de modo a gerar curvas an\u00e1logas as de drill-rate \n\ntest, visando aux\u00edlio na tomada de decis\u00e3o para a escolha de par\u00e2metros de perfura\u00e7\u00e3o \u00f3timos, \n\ngarantindo um aumento da taxa de penetra\u00e7\u00e3o e efici\u00eancia do processo, e uma poss\u00edvel redu\u00e7\u00e3o \n\nda necessidade de realiza\u00e7\u00e3o de testes de perfura\u00e7\u00e3o. \n \n \n\n1.3 ORGANIZA\u00c7\u00c3O DO TRABALHO \n\n \nEste trabalho est\u00e1 estruturado em cinco cap\u00edtulos, sendo este primeiro cap\u00edtulo destinado \n\n\u00e0 introdu\u00e7\u00e3o do projeto, com uma vis\u00e3o geral dos fatos que motivaram o seu desenvolvimento, \n\nos objetivos esperados, e a estrutura\u00e7\u00e3o da tese. \n\nO segundo cap\u00edtulo se foca na fundamenta\u00e7\u00e3o te\u00f3rica do tema, apresentando os conceitos \n\nb\u00e1sicos e a terminologia utilizados como base para o desenvolvimento da tese, assim como os \n\ndados utilizados para a an\u00e1lise e generaliza\u00e7\u00e3o dos resultados obtidos. \n\n\n\n13 \n \n\n \n\nNo terceiro cap\u00edtulo inicia-se o desenvolvimento do projeto, apresentando an\u00e1lises iniciais \n\npara justificar os m\u00e9todos utilizados, a evolu\u00e7\u00e3o dos crit\u00e9rios utilizados para a filtragem dos \n\ndados, e a gera\u00e7\u00e3o das curvas e c\u00e1lculo dos par\u00e2metros de interesse para a otimiza\u00e7\u00e3o do \n\nprocesso. \n\nNo quarto cap\u00edtulo, os resultados obtidos s\u00e3o analisados criticamente e comparados com \n\nos resultados esperados, ilustrando as vantagens dos m\u00e9todos e melhorias a serem \n\nimplementadas no futuro. \n\nPor fim, o quinto cap\u00edtulo conclui a tese expondo as necessidades atuais da ind\u00fastria e \n\ncomo a gera\u00e7\u00e3o das curvas de forma automatizada oferece uma solu\u00e7\u00e3o simples e de baixo \n\ninvestimento, finalizando com as perspectivas para a continuidade do desenvolvimento da \n\npesquisa. \n\n  \n\n\n\n14 \n \n\n \n\n2 FUNDAMENTA\u00c7\u00c3O TE\u00d3RICA \n\n \n\n2.1 OPERA\u00c7\u00c3O DE PERFURA\u00c7\u00c3O DE PO\u00c7OS \n\n \nIniciada ap\u00f3s estudos s\u00edsmicos e geol\u00f3gicos da regi\u00e3o, a perfura\u00e7\u00e3o de po\u00e7os moderna \u00e9 \n\numa atividade complexa que depende de fatores como o tipo de po\u00e7o a ser perfurado, o seu \n\nprop\u00f3sito, localiza\u00e7\u00e3o e profundidade. Algumas classifica\u00e7\u00f5es de po\u00e7os foram especificadas no \n\nQuadro 1. \n\n \n\nQuadro 1 - Classifica\u00e7\u00e3o de po\u00e7os \n\nObjetivo Trajet\u00f3ria Localiza\u00e7\u00e3o \nExplora\u00e7\u00e3o (pioneiro, \n\nestratigr\u00e1fico, extens\u00e3o) \nDirecional (inclinado, \n\nhorizontal) \nTerra firme \n(Onshore) \n\nProdu\u00e7\u00e3o ou \nDesenvolvimento Vertical Mar (Offshore) \n\nInje\u00e7\u00e3o   \nEspecial   \n\nFonte: Adaptado (MITCHELL e MISKA, 2011) \n\n \n\nEntretanto, apesar de diferen\u00e7as em tamanho, fun\u00e7\u00e3o ou capacidade de perfura\u00e7\u00e3o, quase \n\ntodas as opera\u00e7\u00f5es atualmente s\u00e3o realizadas utilizando sondas de perfura\u00e7\u00e3o rotativa, em que \n\numa for\u00e7a e rota\u00e7\u00e3o s\u00e3o aplicados na broca causando a remo\u00e7\u00e3o de material da rocha (Figura \n\n1). A for\u00e7a aplicada \u00e9 resultado do peso da pr\u00f3pria coluna de perfura\u00e7\u00e3o, abreviado por WOB, \n\nque \u00e9 controlado atrav\u00e9s de um sistema de polias, enquanto a rota\u00e7\u00e3o (RPM) \u00e9 gerada na \n\nsuperf\u00edcie por motores que aplicam um torque na coluna de perfura\u00e7\u00e3o, que transmite a energia \n\npara a broca. Com o progresso da opera\u00e7\u00e3o, novos tubos s\u00e3o adicionados \u00e0 coluna. \n\nO material removido pela broca \u00e9 lavado por um fluxo de fluido de perfura\u00e7\u00e3o (FLO), \n\ntamb\u00e9m conhecido como lama, que circula atrav\u00e9s da coluna e \u00e9 ejetado por orif\u00edcios na broca, \n\nretornando \u00e0 superf\u00edcie atrav\u00e9s do po\u00e7o perfurado e do tubo anular que envolve a coluna, sendo \n\nfiltrado para reutiliza\u00e7\u00e3o da lama e descarte dos detritos. \n\nPara perfura\u00e7\u00f5es no mar o processo \u00e9 similar ao realizado em terra firme, mas \u00e9 resultado \n\nde uma log\u00edstica mais complexa, com a necessidade de estabiliza\u00e7\u00e3o da sonda por conta de \n\ncorrentes mar\u00edtimas e movimenta\u00e7\u00e3o das ondas, e de um preparo do leito do mar para a \n\ncementa\u00e7\u00e3o do revestimento anular que cont\u00e9m os fluidos de perfura\u00e7\u00e3o e o eventual fluxo de \n\nhidrocarbonetos para a superf\u00edcie. \n\n \n\n\n\n15 \n \n\n \n\nFigura 1 - Componentes de uma sonda de perfura\u00e7\u00e3o rotativa. (1) Torre de perfura\u00e7\u00e3o, (2) Mangueira \n\nde perfura\u00e7\u00e3o, (3) Standpipe, (4) Swivel, ou cabe\u00e7a de inje\u00e7\u00e3o, (5) Bell nipple, (6) BOP, (7) Dutos do \n\nBOP, (8) Coluna de perfura\u00e7\u00e3o, (9) Comandos, (10) Broca, (11) Annulus, ou anular de perfura\u00e7\u00e3o, \n\n(12) Tubo de revestimento, (13) Bomba do sistema de lama \n\n \nFonte: Adaptado (BOURGOYNE, MILLHEIM et al., 1991) \n\n \n\nAlgumas das formas de perfura\u00e7\u00e3o de po\u00e7os em alto-mar incluem o uso de plataformas \n\nfixas ou auto elev\u00e1veis, que s\u00e3o fixadas ao leito do mar e vi\u00e1veis para at\u00e9 uma profundidade \n\n300 metros, plataformas semissubmers\u00edveis, que possuem flutuadores submersos e \u00e2ncoras que \n\ngarantem estabilidade e manuten\u00e7\u00e3o do posicionamento, utilizados para profundidades de at\u00e9 \n\n2500 metros, ou navios-sonda, que s\u00e3o embarca\u00e7\u00f5es adaptadas ou constru\u00eddas para esse fim, e \n\npossuem sistemas de localiza\u00e7\u00e3o din\u00e2micos que permitem a corre\u00e7\u00e3o do posicionamento em \n\nrela\u00e7\u00e3o ao po\u00e7o sendo perfurado (Figura 2). \n\n \n\n\n\n16 \n \n\n \n\nFigura 2 - Tipos de sonda de perfura\u00e7\u00e3o para uso em alto-mar \n\n \nFonte: (Galp Energia, 2014) \n\n \n\n2.2 TESTE DE PERFURA\u00c7\u00c3O (DRILL-RATE TEST) \n\n \n\nUma das formas de avalia\u00e7\u00e3o das rochas a serem perfuradas \u00e9 atrav\u00e9s da realiza\u00e7\u00e3o de \n\ntestes de perfura\u00e7\u00e3o, onde os par\u00e2metros que influenciam a taxa de penetra\u00e7\u00e3o s\u00e3o variados e \n\naplicados, e seus efeitos s\u00e3o registrados em gr\u00e1ficos ou tabelas, que posteriormente s\u00e3o \n\nanalisados para determinar a configura\u00e7\u00e3o ideal de perfura\u00e7\u00e3o almejando uma melhor \n\nperformance, considerando os limites operacionais da sonda de perfura\u00e7\u00e3o e o trade-off \n\necon\u00f4mico dessa escolha.  \n\nAntes do in\u00edcio do processo de perfura\u00e7\u00e3o, e a cada novo bit run (descida de coluna), \n\nsobretudo quando a broca \u00e9 substitu\u00edda por um outro modelo, testes de perfura\u00e7\u00e3o devem ser \n\nrealizados, e o mais comum na ind\u00fastria petrol\u00edfera \u00e9 o drill-rate test, ou teste de taxa de \n\npenetra\u00e7\u00e3o (BERG e TVEIT, 2016). Esse teste consiste de uma escolha dos par\u00e2metros FLO e \n\nRPM, baseando-se em uma faixa de valores ideal determinada ao longo da perfura\u00e7\u00e3o ou \n\natrav\u00e9s de dados de po\u00e7os similares perfurados anteriormente, e mantendo-os constantes s\u00e3o \n\naplicadas medidas incrementais de WOB, resultando em uma distribui\u00e7\u00e3o de ROP crescente at\u00e9 \n\natingido um peso que resulta na taxa de penetra\u00e7\u00e3o m\u00e1xima poss\u00edvel para essa configura\u00e7\u00e3o, \n\ncom uma conseguinte distribui\u00e7\u00e3o decrescente para valores acima desse peso. O teste \u00e9 repetido \n\nquantas vezes necess\u00e1rio para diferentes valores de rota\u00e7\u00e3o do eixo e fluxo do fluido de \n\nperfura\u00e7\u00e3o. Ao final, os dados coletados s\u00e3o analisados e os par\u00e2metros ideais s\u00e3o \n\ndeterminados. \n\n\n\n17 \n \n\n \n\nComo um dos fatores que influencia a remo\u00e7\u00e3o de material pela broca \u00e9 a dureza das \n\nrochas, novos testes podem ser realizados quando h\u00e1 uma diminui\u00e7\u00e3o no desempenho da \n\nopera\u00e7\u00e3o antes do final de vida projetado para a broca, o que sinaliza uma varia\u00e7\u00e3o litol\u00f3gica. \n\n \n\nFigura 3 - Curva de drill-rate t\u00edpica encontrada ao realizar testes de perfura\u00e7\u00e3o \n\n \nFonte: Adaptado (DUPRIEST e KOEDERITZ, 2005) \n\n \n\nAs curvas determinadas pela fun\u00e7\u00e3o entre o peso na broca aplicado e a taxa de penetra\u00e7\u00e3o \n\nobtida exibem um comportamento padr\u00e3o, com tr\u00eas regi\u00f5es bem definidas. Na regi\u00e3o I, um \n\naumento em ROP \u00e9 resultado de um aumento desproporcional de WOB pois, para qualquer tipo \n\nde broca utilizada, a remo\u00e7\u00e3o de material \u00e9 determinada pela profundidade de indenta\u00e7\u00e3o do \n\nelemento cortante, atingindo seu valor m\u00e1ximo no in\u00edcio da regi\u00e3o II. Essa faixa \u00e9 definida por \n\numa reta crescente, de maior efici\u00eancia poss\u00edvel, onde um aumento na energia mec\u00e2nica \n\naplicada \u2013 na forma de WOB ou RPM \u2013 resulta em um aumento proporcional na taxa de \n\npenetra\u00e7\u00e3o, at\u00e9 o chamado founder point, onde iniciam-se processos que restringem a \n\ntransfer\u00eancia de energia e reduzem a efici\u00eancia do processo. Essa \u00e9 a regi\u00e3o III, que \u00e9 \n\ncaracterizada por fatores como aumento na vibra\u00e7\u00e3o, fen\u00f4menos de stick-slip, que podem \n\ndanificar o BHA, e o enceramento de broca (bit balling), um ac\u00famulo do material removido \n\nnas faces da broca que reduz a profundidade de corte. Algumas medidas podem ser tomadas \n\n\n\n18 \n \n\n \n\npara mitigar o efeito dessas inefici\u00eancias, deslocando o founder point e aumentando a faixa \n\neficiente do processo (IADC Drilling Manual, 2014). \n\nApesar dos problemas encontrados na terceira regi\u00e3o da curva de drill-rate, \u00e9 importante \n\na determina\u00e7\u00e3o do seu ponto de inflex\u00e3o de forma a estabelecer um limite operacional e projetar \n\na faixa ideal de WOB para ser aplicada, maximizando a taxa de penetra\u00e7\u00e3o e evitando um uso \n\nexcessivo de energia mec\u00e2nica.   \n\n \n\n2.3 DADOS DO PO\u00c7O PERFURADO \n\n \nDe modo a auxiliar no desenvolvimento dos m\u00e9todos propostos, um estudo de caso foi \n\nconduzido com o po\u00e7o de explora\u00e7\u00e3o Ogonga-1, perfurado pela Petrobras na Bacia de Kwanza, \n\nem Angola. O po\u00e7o, o primeiro realizado pela empresa, foi completo em agosto de 2012 ap\u00f3s \n\noito meses de opera\u00e7\u00e3o, devido \u00e0 forma\u00e7\u00e3o geol\u00f3gica extremamente dura e heterog\u00eanea abaixo \n\nda camada de sal, o que resultou em uma baixa taxa de penetra\u00e7\u00e3o e paradas frequentes para a \n\ntroca de brocas danificadas, al\u00e9m de problemas de perda de lama (ou fluido de perfura\u00e7\u00e3o) para \n\nfraturas nas rochas. \n\nOs dados de perfura\u00e7\u00e3o foram adquiridos atrav\u00e9s do Banco de Dados de Explora\u00e7\u00e3o e \n\nProdu\u00e7\u00e3o (BDEP) da Ag\u00eancia Nacional de Petr\u00f3leo, G\u00e1s Natural e Biocombust\u00edveis (ANP). \n\n \nQuadro 2 - Detalhes da opera\u00e7\u00e3o de perfura\u00e7\u00e3o do po\u00e7o Ogonga-1 \n\nPa\u00eds Angola \nOpera\u00e7\u00e3o Offshore \n\nBacia Kwanza \nBloco 26 \n\n Empresa  Petrobras \nNome do po\u00e7o Ogonga-1 \nCoordenadas 12\u00b0 46' 38.7156\" S, 12\u00b0 27' 52.1604\" L \n\nEmpresa operadora Schlumberger \nData de in\u00edcio da perfura\u00e7\u00e3o Jan/2012 \nData de fim da perfura\u00e7\u00e3o Ago/2012 \n\nProfundidade de lamina de \u00e1gua 5050 m \nProfundidade final 5840 m \n\nFonte: Banco de Dados de Explora\u00e7\u00e3o e Produ\u00e7\u00e3o (BDEP, 2016) \n\n \n\nTamb\u00e9m foram adquiridos os relat\u00f3rios de opera\u00e7\u00e3o para dois testes de perfura\u00e7\u00e3o \n\nrealizados durante as descidas de coluna 6 e 7, utilizando brocas de PDC e tric\u00f4nica, \n\nrespectivamente. \n\n\n\n19 \n \n\n \n\n3 DESENVOLVIMENTO \n\n \n\n3.1 AN\u00c1LISE INICIAL \n\n \n\nAntes de realizar a an\u00e1lise de todos os dados de perfura\u00e7\u00e3o, uma compara\u00e7\u00e3o qualitativa \n\nentre as curvas de drill-rate test descritas nos relat\u00f3rios de opera\u00e7\u00e3o e as geradas a partir da \n\nplanilha de dados foi realizada, de modo a confirmar a possibilidade do uso desses dados para \n\ndesenvolver os m\u00e9todos propostos. \n\nO primeiro teste a ser analisado ocorreu no sexto RIH, utilizando uma broca de PDC e \n\nperfurando de uma profundidade de 5294 a 5301 metros com peso na broca entre 15 e 30 klbf \n\n(kilolibra-for\u00e7a), rota\u00e7\u00e3o entre 80 e 140 rpm (rota\u00e7\u00e3o por minuto) e fluxo de fluido de \n\nperfura\u00e7\u00e3o constante de 600 gpm (gal\u00e3o por minuto). \n\n \nTabela 1 - Dados do drill-rate test realizado no sexto RIH, retirados do relat\u00f3rio de opera\u00e7\u00e3o \n\nWOB \n(klbf) \n\nRPM \n(rpm) \n\nFLO \n(gpm) Resultados \n\n15 80-120 600 Sem problemas, ROP = 1,13 m/h \n20 80-110 600 Stick-slip, ROP = 2,26 m/h \n20 120-140 600 Sem problemas, ROP = 2,50 m/h \n25 80-120 600 Stick-slip, ROP = 2,57 m/h \n25 130-140 600 Sem problemas, ROP = 3,45 m/h \n30 80-100 600 Stick-slip, ROP = 3,98 m/h \n30 100-140 600 Drill-rate test cancelado por perda de lama \n\nFonte: Adaptado de relat\u00f3rio de opera\u00e7\u00e3o (2016) \n\n \nApesar de o objetivo do teste ser perfurar at\u00e9 o fim da vida da broca, por conta de perdas \n\nde circula\u00e7\u00e3o do fluido de perfura\u00e7\u00e3o e de fen\u00f4menos de stick-slip e shock and vibration (S&amp;V) \n\nele foi finalizado antes do previsto e, portanto, uma curva t\u00edpica n\u00e3o p\u00f4de ser gerada. Entretanto, \n\nos dados apresentados na Tabela 1 ainda podem ser utilizados para realizar a compara\u00e7\u00e3o. \n\nUtilizando os dados para a faixa de rota\u00e7\u00e3o entre 80 e 120 rpm, pois garantem o maior \n\nn\u00famero de pontos, foram calculados os valores m\u00e9dios de ROP para um passo de 5 klbf, \n\ndispostos na Tabela 2. \n\n \nTabela 2 - Dados do drill-rate test no sexto RIH, calculados a partir dos dados originais \n\nWOB \n(klbf) \n\nRPM \n(rpm) \n\nFLO \n(gpm) \n\nROP \n(m/h) \n\nDiferen\u00e7a \n(%) \n\n15 100 600 1,76 56 \n20 95 600 1,97 13 \n25 85 600 2,87 12 \n30 95 600 4,16 5 \n\nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n\n\n\n20 \n \n\n \n\nTra\u00e7adas as curvas com os dados calculados e relatados, percebe-se uma razo\u00e1vel \n\nsimilaridade entre as duas, comportando-se aproximadamente da mesma forma. Apesar disso, \n\nos valores de ROP calculados diferiram consideravelmente do esperado, o que pode ser \n\nexplicado por diferen\u00e7as no m\u00e9todo de c\u00e1lculo da m\u00e9dia. \n\n \nFigura 4 - Curvas do primeiro drill-rate test geradas com dados do relat\u00f3rio e calculados \n\n \nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n\n \n\nO segundo teste a ser analisado ocorreu no s\u00e9timo RIH, utilizando uma broca tric\u00f4nica e \n\nperfurando de uma profundidade de 5326 a 5440 metros, com peso na broca entre 25 e 70 klbf, \n\nrota\u00e7\u00e3o entre 80 e 100 rpm e fluxo de fluido de perfura\u00e7\u00e3o constante de 600 gpm. \n\n \nTabela 3 - Dados do drill-rate test realizado no s\u00e9timo RIH, retirados do relat\u00f3rio de opera\u00e7\u00e3o \n\nWOB \n(klbf) \n\nRPM \n(rpm) \n\nFLO \n(gpm) Resultados \n\n25 90-100 600 Sem problemas, ROP = 1,8 m/h \n30-35 80-90 600 Sem problemas, ROP = 1,8 m/h \n\n35 100 600 S&amp;V, ROP = 1,5 m/h \n40 90-100 600 Sem problemas, ROP = ? \n45 90 600 Stick-slip e S&amp;V, ROP = ? \n50 90 600 Sem problemas, ROP = 3,78 m/h \n60 100 600 Stick-slip e S&amp;V, ROP = 3,1 m/h \n65 90-100 600 Sem problemas, ROP = 5,5 m/h \n70 80-90 600 Stick-slip, ROP = 4,6 m/h \n70 100 600 Sem problemas, ROP = 5,0 m/h \n\nFonte: Adaptado de relat\u00f3rio de perfura\u00e7\u00e3o (2016) \n\n \nDurante o teste ocorreram intermitentemente fen\u00f4menos de stick-slip e S&amp;V, mas com menos \n\nseveridade que no anterior, o que possibilitou a sua continua\u00e7\u00e3o. Houveram perdas de circula\u00e7\u00e3o \n\n0,0\n0,5\n1,0\n1,5\n2,0\n2,5\n3,0\n3,5\n4,0\n4,5\n\n15 20 25 30\n\nR\nO\n\nP \n(m\n\n/h\n)\n\nWOB (klbf)\n\nRelat\u00f3rio Calculado\n\n\n\n21 \n \n\n \n\nconstantes e por duas vezes o teste teve de ser parado pois ocorreu perda total de circula\u00e7\u00e3o. Apesar do \n\nteste ter sido conclu\u00eddo, n\u00e3o foram declaradas no relat\u00f3rio as taxas de penetra\u00e7\u00e3o m\u00e9dias para WOB de \n\n40 e 45 klbf, o que impede a gera\u00e7\u00e3o de uma curva de drill-rate completa. \n\nAnalisando os dados para essa faixa de profundidade, percebe-se na representa\u00e7\u00e3o gr\u00e1fica das \n\nvari\u00e1veis envolvidas (em rela\u00e7\u00e3o \u00e0 profundidade perfurada) que h\u00e1 picos ao longo da distribui\u00e7\u00e3o, que \n\nrepresentam erros de leitura (registrados como -999,25) ou valores aberrantes. Removendo-os, e atendo-\n\nse \u00e0s mesmas faixas de RPM declaradas no relat\u00f3rio, foram calculados os valores m\u00e9dios de ROP para \n\num passo de 5 klbf, dispostos na Tabela 4. \n \n\nTabela 4 - Dados do drill-rate test no s\u00e9timo RIH, calculados a partir dos dados originais \n\nWOB \n(klbf) \n\nRPM \n(rpm) \n\nFLO \n(gpm) \n\nROP \n(m/h) \n\nDiferen\u00e7a \n(%) \n\n25 90 600 2,60 44 \n30 90 600 2,11 17 \n35 90 600 2,29 53 \n40 90 600 2,90 - \n45 95 600 4,05 - \n50 85 600 4,90 30 \n55 95 600 7,30 135 \n60 90 600 8,37 52 \n65 90 600 8,26 65 \n\nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n\n \n\nTra\u00e7adas as curvas com os dados calculados e relatados, percebe-se imediatamente que escassez \n\nde dados do relat\u00f3rio impede uma compara\u00e7\u00e3o definitiva entre as curvas, o que ilustra a import\u00e2ncia de \n\num sistema automatizado que as construa a partir dos dados originais. Mas ainda que essa compara\u00e7\u00e3o \n\nn\u00e3o seja poss\u00edvel, destaca-se como a curva gerada a partir dos dados calculados comporta-se exatamente \n\ncomo o esperado para um drill-rate test, com o founder point e a regi\u00e3o de m\u00e1ximo ROP facilmente \n\ndeduz\u00edveis. \n\n \n\nFigura 5 - Curvas do segundo drill-rate test geradas com dados do relat\u00f3rio e calculados \n\n \nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n\n0\n\n2\n\n4\n\n6\n\n8\n\n10\n\n20 25 30 35 40 45 50 55 60 65 70 75\n\nR\nO\n\nP \n(m\n\n/h\n)\n\nWOB (klbf)\n\nRelat\u00f3rio Calculado\n\n\n\n22 \n \n\n \n\nNovamente, houveram diferen\u00e7as consider\u00e1veis entre os valores de ROP, mas que provavelmente \n\nprov\u00e9m de disparidades nos m\u00e9todos de filtragem e de c\u00e1lculo da m\u00e9dia dos dados de perfura\u00e7\u00e3o. \n\nEntretanto, os valores de WOB que garantem um ROP m\u00e1ximo em ambas as curvas coincidem, \n\nconsiderando uma margem de erro para a taxa de penetra\u00e7\u00e3o de, pelo menos, 0,1 m/h, o que \u00e9 \n\nperfeitamente razo\u00e1vel. \n\nConclui-se, ao fim dessa an\u00e1lise, que \u00e9 poss\u00edvel gerar curvas qualitativamente semelhantes \u00e0s \n\ndescritas nos relat\u00f3rios a partir dos dados originais de forma automatizada, com a vantagem de \n\ndemandarem menos tempo para serem constru\u00eddas e estarem menos sujeitas a erros de leitura. \n\n \n\n3.2 GERA\u00c7\u00c3O DE CURVAS DE DRILL-RATE \n\n \n\nUma vez estabelecida a possibilidade de gera\u00e7\u00e3o de curvas de drill-rate test em intervalos \n\nde profundidade onde foram realizados testes de perfura\u00e7\u00e3o, foi testada a viabilidade de gera\u00e7\u00e3o \n\nde curvas an\u00e1logas para intervalos de opera\u00e7\u00e3o normal. \n\nUtilizando como base para essa an\u00e1lise os dados de perfura\u00e7\u00e3o de 5198 a 5241 metros, \n\npor apresentarem uma varia\u00e7\u00e3o controlada e regular da rota\u00e7\u00e3o do eixo e do fluxo do fluido de \n\nperfura\u00e7\u00e3o, o que facilita a separa\u00e7\u00e3o dos demais par\u00e2metros. \n\nExcluindo manualmente os pontos onde h\u00e1 uma varia\u00e7\u00e3o brusca na rota\u00e7\u00e3o, foi criada \n\numa rotina no software MATLAB para separar os valores de WOB e ROP automaticamente \n\npor valores de FLO m\u00faltiplos de cinquenta (750 e 800 gpm) e valores de RPM m\u00faltiplos de dez \n\n(100, 110, 120, 130 e 140 rpm). Assumindo inicialmente que todos os dados foram coletados \n\nna regi\u00e3o III da curva de drill-rate, e que o comportamento das curvas nessa regi\u00e3o pode ser \n\naproximado pela equa\u00e7\u00e3o (1), que representa um polin\u00f4mio de segundo grau, com concavidade \n\nvoltada para baixo (a &lt;0) (NASCIMENTO, ELMGERBI et al., 2015), as curvas foram \n\ngeradas atrav\u00e9s de uma ferramenta do programa que aproxima os dados por um c\u00e1lculo de \n\nregress\u00e3o linear. \n\n \n\n?(x) = ax2 + bx + c                (1) \n\n \n\nAs duas curvas iniciais comportarem-se como o esperado, com a concavidade voltada \n\npara baixo, mas as outras quatro curvas apresentam uma concavidade voltada para cima, o que \n\nn\u00e3o condiz com o comportamento padr\u00e3o das curvas dos testes (Figura 6). Nesses casos, os \n\ndados utilizados possivelmente n\u00e3o foram coletados na regi\u00e3o III, como o assumido \n\ninicialmente, mas sim na regi\u00e3o II, que se comporta como uma reta crescente. Uma nova \n\n\n\n23 \n \n\n \n\nregress\u00e3o linear dos dados foi calculada, adicionando \u00e0 rotina do MATLAB uma cl\u00e1usula que \n\nanalisa o primeiro coeficiente polinomial da equa\u00e7\u00e3o aproximada e, caso seja um n\u00famero \n\npositivo, recalcula a equa\u00e7\u00e3o como linear. \n\n \n\nFigura 6 - Curvas de drill-rate aproximadas para dados de rota\u00e7\u00e3o entre 100 e 140 rpm, e fluxo entre \n\n750 e 800 gpm, evidenciando diferentes comportamentos \n\n \nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n\n \n\nOs dados com rota\u00e7\u00e3o do eixo de 140 rpm e fluxo de 800 gpm, ap\u00f3s uma nova regress\u00e3o \n\nlinear assumindo um polin\u00f4mio de primeiro grau, apresentou uma reta decrescente que, ao \n\ncontr\u00e1rio das outras curvas, aparenta ter dados o suficiente para garantir com uma boa confian\u00e7a \n\nde que essa curva os representa bem, assumindo que poss\u00edveis erros de leitura ou valores \n\naberrantes n\u00e3o sejam os causadores desse comportamento inesperado. Portanto, a explica\u00e7\u00e3o \n\nmais plaus\u00edvel \u00e9 a de que esses dados foram coletados na segunda metade da regi\u00e3o III, ap\u00f3s o \n\nv\u00e9rtice da par\u00e1bola, que apresentam um comportamento decrescente, aproximadamente como \n\no ilustrado nesse gr\u00e1fico. \n\nNota-se, tamb\u00e9m, que a quarta curva apresenta alguns pontos que parecem fugir da \n\ntend\u00eancia geral da dispers\u00e3o (ROP > 8 m/h), e que se removidos mudam completamente o \n\nsentido da reta aproximada, de crescente para decrescente, o que \u00e9 uma mudan\u00e7a significativa \n\n\n\n24 \n \n\n \n\ne que n\u00e3o pode ser ignorada. Portanto, na an\u00e1lise geral dos dados de perfura\u00e7\u00e3o, esses valores \n\naberrantes devem ser apropriadamente localizados e tratados. \n\n \nFigura 7 - Curvas de drill-rate aproximadas para dados filtrados de rota\u00e7\u00e3o 120 rpm e fluxo 800 gpm, \n\ndestacando mudan\u00e7a no sentido das curvas \n\n \nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n\n \n\n3.3 FILTRAGEM E AN\u00c1LISE DOS DADOS \n \n\n3.3.1 Metodologia de filtragem \n \n\nEstabelecida a possibilidade de gera\u00e7\u00e3o de curvas an\u00e1logas \u00e0s de drill-rate test com dados \n\nde opera\u00e7\u00e3o normal, e determinada a necessidade de uma filtragem desses dados de modo a \n\nexcluir valores com erros de leitura e que fujam da tend\u00eancia geral da amostra (outliers), \n\niniciou-se a an\u00e1lise dos dados de perfura\u00e7\u00e3o do po\u00e7o Ogonga-1 de todo o seu intervalo de \n\nprofundidade.  \n\nInicialmente, utilizando as ferramentas de filtragem do programa Microsoft Excel, foram \n\nremovidos os pontos que contenham valores nulos, que totalizaram 219 ocorr\u00eancias. Esses \n\nvalores ocorrem quando h\u00e1 uma vibra\u00e7\u00e3o excessiva no fundo do po\u00e7o, havendo uma perda de \n\nsinal com o BHA, o conjunto de instrumentos e ferramentas respons\u00e1veis pela perfura\u00e7\u00e3o e \n\nlimpeza do po\u00e7o (AL DUSHAISHI, 2012). \n\nDe modo a excluir os outliers mais evidentes das distribui\u00e7\u00f5es ao longo da profundidade \n\nperfurada, alguns crit\u00e9rios foram estabelecidos. Para a distribui\u00e7\u00e3o de ROP, qualquer sequ\u00eancia \n\n\n\n25 \n \n\n \n\nde at\u00e9 dois dados \u2013 pois uma par\u00e1bola \u00e9 definida por, pelo menos, tr\u00eas pontos \u2013 que difiram em \n\nmais de 10 m/h dos dados anteriores e posteriores foi marcada. Esse valor foi estabelecido como \n\no dobro da m\u00e9dia geral de ROP, aproximado para o m\u00faltiplo de cinco mais pr\u00f3ximo. \n\nSimilarmente, para as distribui\u00e7\u00f5es de RPM e FLO, qualquer sequ\u00eancia de at\u00e9 dois dados de \n\nvalores iguais foi marcada. Nessa inspe\u00e7\u00e3o, todos os valores s\u00e3o arredondados para o m\u00faltiplo \n\nde dez mais pr\u00f3ximo \u2013 no caso da rota\u00e7\u00e3o \u2013 ou para o m\u00faltiplo de cinquenta mais pr\u00f3ximo \u2013 \n\nno caso do fluxo \u2013 pois os incrementos durante o processo de perfura\u00e7\u00e3o ocorreram em passos \n\nde 10 rpm e 50 gpm. \n\nUma rotina foi desenvolvida no Excel para implementar esses crit\u00e9rios de filtragem, e \n\ntodos os dados identificados como aberrantes foram destacados na cor vermelha nos gr\u00e1ficos \n\nde distribui\u00e7\u00e3o de seus respectivos par\u00e2metros. Em seguida, todas as linhas na planilha de dados \n\nque continham um desses valores destacados foram exclu\u00eddas. \n\nAdaptando a rotina de MATLAB criada anteriormente, todos os valores de ROP e WOB \n\nforam separados por rota\u00e7\u00f5es e fluxos arredondados, de forma que se comportem \n\naproximadamente como o esperado para curvas de drill-rate. \n\nDurante a an\u00e1lise inicial, realizada anteriormente, as curvas foram examinadas de forma \n\nvisual para determinar a correla\u00e7\u00e3o com os dados que aproximam. Entretanto, de forma a \n\nfacilitar essa determina\u00e7\u00e3o nesse novo estudo, uma ferramenta estat\u00edstica para esse fim teve de \n\nser escolhida. \n\nUma medida de averigua\u00e7\u00e3o da qualidade de ajuste bastante utilizada \u00e9 o coeficiente de \n\ndetermina\u00e7\u00e3o, ou R2, que indica a propor\u00e7\u00e3o percentual da variabilidade da vari\u00e1vel dependente \n\ny que \u00e9 explicada pela vari\u00e1vel independente x, determinado pela equa\u00e7\u00e3o (2), onde yi \u00e9 o valor \n\nobservado, y?i \u00e9 o valor estimado e y? \u00e9 a m\u00e9dia das observa\u00e7\u00f5es. \n\n \n\nR2 = 1 ?\n? (y?i ? yi)\n\n2n\ni=1\n\n? (yi ? y?)\n2n\n\ni=1\n?               (2) \n\n \n\nComo todo processo mec\u00e2nico est\u00e1 sujeito a varia\u00e7\u00f5es de causas aleat\u00f3ria e especial, que \n\nocorrem de acordo com uma fun\u00e7\u00e3o densidade de probabilidade, dispersando os dados em torno \n\nde um valor m\u00e9dio (COSTA NETO, 2002), \u00e9 natural que a medida R2 de uma regress\u00e3o linear \n\ndesses dados apresente um valor baixo, como \u00e9 o caso da curva aproximada com os dados para \n\numa rota\u00e7\u00e3o de 160 rpm e fluxo de 700 gpm, ilustrado na Figura 8 (R2 = 20%). Logo, esses \n\ndados devem ser reduzidos aos seus valores m\u00e9dios para passos pr\u00e9-determinados de WOB, \n\npois assim eles se encontram mais pr\u00f3ximos \u00e0 curva aproximada, e o coeficiente de \n\n\n\n26 \n \n\n \n\ndetermina\u00e7\u00e3o cresce e pode ser utilizado como uma medida r\u00e1pida de avalia\u00e7\u00e3o da regress\u00e3o. \n\nPara as mesmas condi\u00e7\u00f5es mencionadas anteriormente, os dados foram separados em passos de \n\n3 klbf, e o R2 passou a ser 98%. Uma compara\u00e7\u00e3o visual entre as duas curvas mostra que n\u00e3o \n\nh\u00e1 uma diferen\u00e7a qualitativa significante, e estabelece uma base intuitiva para o relacionamento \n\nentre a qualidade de ajuste visual e a impl\u00edcita pela medida estat\u00edstica. \n\n \n\nFigura 8 - Curvas aproximadas por regress\u00e3o linear, utilizando os dados originais e os dados reduzidos \n\n\u00e0 m\u00e9dia \n\n \nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n\n \n\nEntretanto, apesar do bom ajuste da curva ilustrada, percebe-se que alguns dos dados \n\noriginais diferem muito dos valores m\u00e9dios calculados e, como demonstrado anteriormente, h\u00e1 \n\nsitua\u00e7\u00f5es em que esses valores aberrantes podem causar uma varia\u00e7\u00e3o significante na curva \n\naproximada. Portanto, um m\u00e9todo de determina\u00e7\u00e3o matem\u00e1tica para esses dados deve ser \n\nutilizado. \n\n \n\n3.3.2 Ferramentas estat\u00edsticas de determina\u00e7\u00e3o de outliers \n\n \n\nAs formas mais comuns de detec\u00e7\u00e3o de valores aberrantes incluem os m\u00e9todos de desvio \n\npadr\u00e3o, de desvio m\u00e9dio (ou mediano) absoluto (MAD) e de diagrama de caixa (boxplot), sendo \n\n\n\n27 \n \n\n \n\nque nos tr\u00eas casos s\u00e3o estabelecidos limites inferior e superior de um intervalo de confian\u00e7a, e \n\nos valores que se encontram al\u00e9m dos limites s\u00e3o evidenciados (LEYS, KLEIN et al., 2013). \n\nNo m\u00e9todo de desvio padr\u00e3o, \u00e9 calculado o desvio padr\u00e3o da amostra de acordo com a \n\nequa\u00e7\u00e3o (3), onde xi \u00e9 um valor da amostra, x? \u00e9 a m\u00e9dia e N \u00e9 o tamanho amostral, e um limite \n\nde 2 a 3 desvios padr\u00f5es em torno da m\u00e9dia dos dados \u00e9 estabelecido, dependendo da robustez \n\nestat\u00edstica desejada. \n\n \n\n? = ?\n1\n\nN\n? (xi ? x?)\n\n2N\ni                 (3) \n\n \n\nO m\u00e9todo de desvio m\u00e9dio (ou mediano) absoluto determina um limite de 2 a 3 vezes o \n\nvalor MAD em torno da m\u00e9dia, determinado pela equa\u00e7\u00e3o (4), ou em torno da mediana, \n\ndeterminado pela equa\u00e7\u00e3o (5), onde \u201cmed\u201d \u00e9 o operador para o c\u00e1lculo da mediana. \n\n \n\nMAD =\n1\n\nN\n? |xi ? x?|\n\nN\ni                 (4) \n\nMAD = med(? |xi ? med(x)|\nN\ni )               (5) \n\n \n\nJ\u00e1 no m\u00e9todo de diagrama de caixa, os limites s\u00e3o determinados em fun\u00e7\u00e3o da dist\u00e2ncia \n\ninterquartil IQR, entre os finais do primeiro quartil (Q1) e do terceiro quartil (Q3), e estabelece \n\num intervalo de confian\u00e7a entre Q1-1,5IQR e Q3+1,5IQR. O diferencial dessa ferramenta \u00e9 sua \n\nforma conveniente de representar graficamente esse intervalo e os valores aberrantes, como na \n\nFigura 9. \n\n \n\n\n\n28 \n \n\n \n\nFigura 9 - Ferramenta de diagrama de caixa, estabelecendo um intervalo de confian\u00e7a de 99,3% \n\n \nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n\n \n\nUm problema comum entre ferramentas desse tipo \u00e9 a depend\u00eancia do valor m\u00e9dio para \n\ndeterminar os limites, que \u00e9 fortemente influenciado pela presen\u00e7a de outliers e, portanto, pode \n\ndistorcer o intervalo de confian\u00e7a para marcar valores normais como aberrantes, ou ainda \n\naceitar valores aberrantes. Como os m\u00e9todos de desvio padr\u00e3o e MAD (m\u00e9dia) sofrem desse \n\nproblema, e alguns dos valores aberrantes localizados visualmente apresentaram um desvio \n\ndemasiadamente grande em rela\u00e7\u00e3o \u00e0 m\u00e9dia, eles n\u00e3o ser\u00e3o adequados para o uso nesse projeto. \n\nJ\u00e1 os m\u00e9todos de diagrama de caixa e MAD (mediana), por utilizarem percentis como base para \n\no c\u00e1lculo desses valores, n\u00e3o sofrem desse problema e s\u00e3o muito mais indicados para esse fim \n\n(LEYS, KLEIN et al., 2013). \n\nAmbos os m\u00e9todos se baseiam na premissa de que a fun\u00e7\u00e3o distribui\u00e7\u00e3o de probabilidade \n\nque descreve o processo se comporta como uma gaussiana (distribui\u00e7\u00e3o normal), o que ocorre \n\nquando o processo est\u00e1 sob controle estat\u00edstico, e n\u00e3o h\u00e1 influ\u00eancia de varia\u00e7\u00f5es de causa \n\nespecial. Apesar de essa ser a situa\u00e7\u00e3o ideal para qualquer opera\u00e7\u00e3o, nem sempre \u00e9 poss\u00edvel \n\nmanter esse controle, especialmente durante a perfura\u00e7\u00e3o de po\u00e7os na regi\u00e3o III das curvas de \n\ndrill-rate, onde h\u00e1 uma maior influ\u00eancia das inefici\u00eancias do processo. Sendo assim, \u00e9 \n\nnecess\u00e1rio o uso de uma ferramenta estat\u00edstica que leve em considera\u00e7\u00e3o uma poss\u00edvel \n\nassimetria da distribui\u00e7\u00e3o. \n\n\n\n29 \n \n\n \n\n3.3.2.1 Diagrama de caixa ajustado \n\n \n\nUm ajuste matem\u00e1tico do diagrama de caixa foi proposto por Hubert e Vanderviere \n\n(2004) para adequar o m\u00e9todo a assimetrias, utilizando uma medida estat\u00edstica robusta para a \n\ndetermina\u00e7\u00e3o da obliquidade da distribui\u00e7\u00e3o, chamada medcouple (MC). Os limites superior e \n\ninferior desse ajuste s\u00e3o mostrados na Figura 10, e os valores \u201ca\u201d e \u201cb\u201d s\u00e3o definidos de acordo \n\ncom a express\u00e3o (6). \n\n \n\n{\na = ?4  e  b = 3, MC ? 0\na = ?3  e  b = 4, MC &lt;0\n\n               (6) \n\n \n\nA medida medcouple \u00e9 calculada atrav\u00e9s de um algoritmo computacional complexo, que \n\nfoi implementado em conjunto da ferramenta de diagrama de caixa ajustado no software \n\nMATLAB (HUBERT e VERBOVEN, 2005). Um valor positivo indica uma distribui\u00e7\u00e3o com \n\numa \u201ccauda\u201d direita longa, e um valor negativo indica uma distribui\u00e7\u00e3o com uma \u201ccauda\u201d \n\nesquerda longa. Quando o valor \u00e9 zero, a distribui\u00e7\u00e3o \u00e9 sim\u00e9trica, e os limites do diagrama de \n\ncaixa ajustado tornam aos limites do diagrama de caixa original. \n\n \nFigura 10 - Ferramenta de diagrama de caixa ajustado, estabelecendo um intervalo de confian\u00e7a para \n\numa distribui\u00e7\u00e3o assim\u00e9trica \n\n \nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n\n \n\n\n\n30 \n \n\n \n\nCom essa ferramenta, \u00e9 poss\u00edvel determinar os valores aberrantes das distribui\u00e7\u00f5es de \n\nROP. Utilizando os dados aproximados por uma curva anteriormente, e empregando diagramas \n\nde caixa ajustados para cada passo de 3 klbf, foram detectados 30 outliers, evidenciados na cor \n\nlaranja na Figura 11.  \n\n \n\n3.3.3 Confiabilidade em amostras pequenas \n\n \n\nComo cada ponto de uma curva de drill-rate \u00e9 definido pelo valor m\u00e9dio x? da dispers\u00e3o \n\nde dados, e o espalhamento desses dados \u00e9 descrito por uma fun\u00e7\u00e3o densidade de probabilidade, \n\nquanto menor o tamanho de uma amostra, maior \u00e9 a incerteza em rela\u00e7\u00e3o a esse valor m\u00e9dio \n\ncalculado. Para uma distribui\u00e7\u00e3o normal, o c\u00e1lculo da margem de erro ME \u00e9 descrito pela \n\nequa\u00e7\u00e3o (7), onde Z?/2 \u00e9 o escore definido por tabelas estat\u00edsticas para um determinado \n\nintervalo de confian\u00e7a (1 ? ?). Ao reduzir o tamanho amostral N, aumenta-se a margem de \n\nerro da m\u00e9dia, ou diminui-se o intervalo de confian\u00e7a. \n\n \n\nx? \u00b1 ME, ME =\nZ?/2 ? ?\n\n?N\n?                (7) \n\n \n\nApesar da equa\u00e7\u00e3o n\u00e3o poder ser empregada para os intervalos de ROP, pois apresentam \n\numa distribui\u00e7\u00e3o obl\u00edqua, o mesmo princ\u00edpio se aplica, o que torna os pontos resultados de uma \n\nm\u00e9dia de poucos n\u00fameros pouco confi\u00e1veis, e uma medida de confiabilidade nova deve ser \n\ndefinida. \n\n \n\n\n\n31 \n \n\n \n\nFigura 11 - Curvas aproximadas por regress\u00e3o linear, utilizando os dados originais e os dados filtrados \n\n(com valores ponderados) \n\n \nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n\n \n\nPara situa\u00e7\u00f5es onde h\u00e1 muitos pontos com o valor de N associado relativamente alto, em \n\nrela\u00e7\u00e3o aos poucos pontos origin\u00e1rios de tamanhos de amostra baixos, a curva aproximada por \n\nregress\u00e3o linear pode ser distorcida e ter seu v\u00e9rtice deslocado. Uma forma simples de evitar \n\nisso \u00e9 realizar uma regress\u00e3o linear com dados ponderados com os valores de seus tamanhos \n\namostrais, como exemplificado na Figura 11. O \u00faltimo ponto, com WOB em torno de 37 klbf, \n\n\u00e9 resultado da m\u00e9dia de apenas 12 dados, ante os quatro pontos mais confi\u00e1veis que representam \n\nseparadamente mais de 100 dados, e aparenta estar deslocado em 0.5 m/h para cima, o que \n\ndiminui o coeficiente de determina\u00e7\u00e3o em pouco mais de 1 ponto percentual, mas garante uma \n\ncurva mais confi\u00e1vel.  \n\nEntretanto, em algumas situa\u00e7\u00f5es a maioria dos pontos s\u00e3o pouco confi\u00e1veis, e o m\u00e9todo \n\nde valores ponderados n\u00e3o assegura uma melhoria na aproxima\u00e7\u00e3o das curvas. De forma a \n\ndeterminar uma rela\u00e7\u00e3o entre o tamanho amostral e a confiabilidade nas aproxima\u00e7\u00f5es, uma \n\nrotina foi criada para simular situa\u00e7\u00f5es, para cada passo de WOB, em que amostras aleat\u00f3rias \n\nde ROP, de tamanhos incrementais, sejam selecionadas e tenham suas m\u00e9dias comparadas com \n\na m\u00e9dia total da popula\u00e7\u00e3o daquele passo. \n\n\n\n32 \n \n\n \n\nDe acordo com o teorema central do limite (TCL), a m\u00e9dia aritm\u00e9tica de valores aleat\u00f3rios \n\nde qualquer tipo de distribui\u00e7\u00e3o, ap\u00f3s um n\u00famero suficientemente grande de itera\u00e7\u00f5es, se \n\ncomporta aproximadamente como uma fun\u00e7\u00e3o de distribui\u00e7\u00e3o normal (RICE, 2007). Portanto, \n\nde modo a facilitar a an\u00e1lise posterior, o erro em rela\u00e7\u00e3o \u00e0 m\u00e9dia foi calculado em um la\u00e7o \n\nrepetido mil vezes, e os valores foram distribu\u00eddos em uma gaussiana. \n\n \n\nFigura 12 - Distribui\u00e7\u00e3o da diferen\u00e7a entre a m\u00e9dia de uma popula\u00e7\u00e3o de 32 dados e as m\u00e9dias de \n\namostras de 5 dados coletados aleatoriamente \n\n \nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n\n \n\nAp\u00f3s cada itera\u00e7\u00e3o, para todos os passos de todas as curvas de drill-rate, os valores \n\nabsolutos m\u00e1ximos de cada distribui\u00e7\u00e3o, assumindo uma regi\u00e3o de confian\u00e7a de 95%, s\u00e3o \n\nextra\u00eddos e dispostos em um gr\u00e1fico de dispers\u00e3o em fun\u00e7\u00e3o do tamanho das amostras (Figura \n\n13). Com esses dados, uma fun\u00e7\u00e3o de distribui\u00e7\u00e3o de lei de pot\u00eancia foi aproximada por \n\nregress\u00e3o linear, descrita pela equa\u00e7\u00e3o (8), onde f(x) \u00e9 a margem de erro m\u00e1xima e x \u00e9 o \n\ntamanho da amostra. \n\n \n\n?(x) = 2,555x?0,5893 ? 0,07585              (8) \n\n\n\n33 \n \n\n \n\nFigura 13 - Gr\u00e1fico de dispers\u00e3o das margens de erro m\u00e1ximas esperadas para um intervalo de \n\nconfian\u00e7a de 95%, em rela\u00e7\u00e3o ao tamanho das amostras \n\n \nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n\n \n\nPara valores de margem de erro de 0,2 a 2,0 m/h, a passos de 0,2 m/h, foram calculados \n\nos tamanhos amostrais, que foram aproximados para cima de forma a aumentar a robustez dos \n\nc\u00e1lculos, e dispostos na Tabela 5. \n\n \n\nTabela 5 - Tamanhos amostrais calculados para diferentes valores de margem de erro m\u00e1xima para \n\nROP \n\nTamanho \namostral \n\nMargem de erro m\u00e1xima \n(m/h) \n\n44 0,2 \n18 0,4 \n10 0,6 \n7 0,8 \n5 1,0 \n4 1,2 \n3 1,4 \n2 1,6 \n2 1,8 \n2 2,0 \n\nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n\n\n\n34 \n \n\n \n\nO mesmo processo iterativo foi realizado para as varia\u00e7\u00f5es de WOB para cada passo, e \n\numa fun\u00e7\u00e3o similar foi aproximada, descrita pela equa\u00e7\u00e3o (9). Utilizando os valores de tamanho \n\namostral encontrados, as margens de erro m\u00e1ximas foram calculadas e dispostas na Tabela 6. \n\n \n\n?(x) = 1,626x?0,545 ? 0,06671               (8) \n\n \n\nTabela 6 - Valores de margem de erro m\u00e1xima para WOB calculados para tamanhos amostrais \n\ndeterminados na tabela 5 \n\nTamanho \namostral \n\nMargem de erro m\u00e1xima \n(klbf) \n\n44 0,15 \n18 0,25 \n10 0,4 \n7 0,5 \n5 0,6 \n4 0,7 \n3 0,85 \n2 1,0 \n\nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n \n\nComo os valores de margem de erro encontrados s\u00e3o baixos em rela\u00e7\u00e3o \u00e0 faixa de WOB \n\nutilizada para a constru\u00e7\u00e3o de curvas de drill-rate na regi\u00e3o III, seus efeitos ser\u00e3o \n\nnegligenciados. \n\nApesar de agora se ter uma ideia dos valores de erro esper\u00e1veis para pontos pouco \n\nconfi\u00e1veis, ainda \u00e9 preciso determinar a confiabilidade estat\u00edstica nas curvas que os aproxima. \n\nPara isso, uma nova rotina foi desenvolvida para testar todas as situa\u00e7\u00f5es poss\u00edveis de margens \n\nde erro em par\u00e1bolas com 3 a 12 pontos, analisar os efeitos causados e estabelecer uma \n\nporcentagem de confian\u00e7a no valor de WOB calculado nessas curvas para um ROP m\u00e1ximo. \n\nUma medida an\u00e1loga ao conjunto imagem de uma fun\u00e7\u00e3o quadr\u00e1tica com concavidade \n\nvoltada para baixo \u2013 descrito pela express\u00e3o (9) \u2013 foi especificada para facilitar a separa\u00e7\u00e3o das \n\ncurvas geradas pela rotina, diferindo da imagem ao especificar um limite inferior ymin, que \u00e9 o \n\nmenor valor no eixo y para o intervalo conhecido no eixo x. A dist\u00e2ncia entre esses pontos foi \n\ndefinida pela vari\u00e1vel range pela equa\u00e7\u00e3o (10). \n\n \n\nIm = {y ? ?|y ? yv =\n??\n\n4a? }               (9) \n\nrng = yv ? ymin                (10) \n\n \n\n\n\n35 \n \n\n \n\nPara simplificar o c\u00e1lculo das curvas pela rotina, foi escolhida uma par\u00e1bola com o \n\ncoeficiente c = 0, para que o menor valor da curva no eixo y seja a origem, e coeficiente a =\n\n?1 para que tenha uma concavidade para baixo e ra\u00edzes {0; b}. Como o valor de range ser\u00e1 a \n\ncoordenada vertical do v\u00e9rtice (pois ymin = 0) deduz-se, enfim, que o coeficiente b = 2?rng. \n\nForam criadas curvas com valores de range entre 0,5 e 6, determinado pelos valores \n\nencontrados nas curvas de drill-rate calculadas anteriormente, definindo a posi\u00e7\u00e3o de seus \n\npontos aleatoriamente (com exce\u00e7\u00e3o do primeiro e \u00faltimo pontos, que s\u00e3o as ra\u00edzes), e aplicando \n\nmil diferentes medidas de margem de erro escolhidas aleatoriamente de distribui\u00e7\u00f5es normais \n\ncom m\u00e9dia zero e desvio padr\u00e3o determinado pela equa\u00e7\u00e3o (11), onde x \u00e9 o valor encontrado \n\nna posi\u00e7\u00e3o definida pelo escore Z, e ? \u00e9 a m\u00e9dia da distribui\u00e7\u00e3o. Para um intervalo de confian\u00e7a \n\nde 95%, Z = 1,96 e a diferen\u00e7a entre o valor x e a m\u00e9dia \u00e9 a margem de erro m\u00e1xima calculada \n\nanteriormente. Portanto, o desvio padr\u00e3o utilizado foi ? = ME 1,96? , variando os valores de \n\nME de acordo com os definidos na Tabela 5. \n\n \n\nZ =\n(x ? ?)\n\n??                (11) \n\n \n\nPara cada erro aplicado aos pontos das curvas, uma nova curva \u00e9 aproximada por \n\nregress\u00e3o linear, e o seu novo valor de range \u00e9 calculado e armazenado. Ao final de todas as \n\nitera\u00e7\u00f5es, foram criadas tabelas com a distribui\u00e7\u00e3o de propor\u00e7\u00f5es dos novos valores de range \n\npor curva original (e.g. 28% das curvas com 6 pontos de range 1,5 foram aproximadas por \n\ncurvas de range 2,0 para uma margem de erro m\u00e1xima de 1,2, como demonstrado na Tabela 7), \n\nassim como tabelas de probabilidade de uma curva aproximada ter sua coordenada horizontal \n\ndo v\u00e9rtice (WOB para ROP m\u00e1ximo) deslocada da coordenada real em at\u00e9 10 a 30%, em rela\u00e7\u00e3o \n\n\u00e0 origem (founder point), como demonstrado na Tabela 8 (e.g. 56% das curvas aproximadas \n\ncom 6 pontos e range 2,0 apresentam a coordenada horizontal de seus v\u00e9rtices deslocada em \n\nat\u00e9 10%). \n\n  \n\n\n\n36 \n \n\n \n\nTabela 7 - Distribui\u00e7\u00e3o de probabilidades de curvas perfeitas com 6 pontos e valores de range entre \n\n0,5 e 6, ao serem aplicadas varia\u00e7\u00f5es em y de at\u00e9 1,2, gerem curvas aproximadas com valores de range \n\nentre 0,5 e 8,5 \n\n  Range (curva perfeita) \n\n  0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 5.5 6 \n\nR\na\n\nn\ng\n\ne\n (\n\ncu\nrv\n\na\n a\n\np\nro\n\nx\nim\n\na\nd\n\na\n) \n\n0.5 13% 5% 1% 0% 0% 0% 0% 0% 0% 0% 0% 0% \n\n1 32% 22% 7% 2% 1% 0% 0% 0% 0% 0% 0% 0% \n\n1.5 30% 32% 23% 8% 2% 0% 0% 0% 0% 0% 0% 0% \n\n2 16% 24% 28% 21% 10% 2% 0% 0% 0% 0% 0% 0% \n\n2.5 7% 14% 26% 30% 22% 7% 2% 1% 0% 0% 0% 0% \n\n3 1% 5% 13% 25% 28% 22% 9% 2% 1% 0% 0% 0% \n\n3.5 1% 1% 3% 11% 25% 30% 21% 9% 2% 0% 0% 0% \n\n4 0% 0% 1% 3% 9% 24% 30% 21% 9% 2% 0% 0% \n\n4.5 0% 0% 0% 1% 4% 11% 23% 31% 22% 9% 2% 0% \n\n5 0% 0% 0% 0% 1% 3% 12% 24% 31% 22% 8% 2% \n\n5.5 0% 0% 0% 0% 0% 1% 3% 10% 23% 32% 21% 10% \n\n6 0% 0% 0% 0% 0% 0% 1% 3% 11% 23% 30% 21% \n\n6.5 0% 0% 0% 0% 0% 0% 0% 1% 3% 10% 25% 30% \n\n7 0% 0% 0% 0% 0% 0% 0% 0% 1% 4% 11% 23% \n\n7.5 0% 0% 0% 0% 0% 0% 0% 0% 0% 1% 3% 12% \n\n8 0% 0% 0% 0% 0% 0% 0% 0% 0% 0% 1% 3% \n\n8.5 0% 0% 0% 0% 0% 0% 0% 0% 0% 0% 0% 1% \nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n\n \n\n  M\u00e1xima varia\u00e7\u00e3o de xv \n\n &lt;10%&lt;20%&lt;30% \n\nR\na\n\nn\ng\n\ne\n (\n\ncu\nrv\n\na\n a\n\np\nro\n\nx\nim\n\na\nd\n\na\n) \n\n0.5 29% 52% 62% \n\n1 36% 58% 70% \n\n1.5 48% 70% 82% \n\n2 56% 80% 88% \n\n2.5 63% 87% 94% \n\n3 77% 95% 99% \n\n3.5 84% 98% 100% \n\n4 92% 100% 100% \n\n4.5 93% 100% 100% \n\n5 95% 100% 100% \n\n5.5 98% 100% 100% \n\n6 99% 100% 100% \n\n6.5 99% 100% 100% \n\n7 98% 100% 100% \n\n7.5 100% 100% 100% \n\n8 100% 100% 100% \n\n8.5 100% 100% 100% \n \n\n \n\nTabela 8 - Probabilidades de curvas aproximadas com 6 \n\npontos e valores de range entre 0,5 e 8,5 apresentarem a \n\ncoordenada horizontal de seus v\u00e9rtices deslocada do \n\nv\u00e9rtice real em at\u00e9 10 a 30%, em rela\u00e7\u00e3o ao founder point \n\nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n\n \n\n\n\n37 \n \n\n \n\n3.3.4 Aproxima\u00e7\u00e3o de curvas de drill-rate com tabelas de confian\u00e7a \n\n \n\nDeterminadas as medidas de avalia\u00e7\u00e3o da confiabilidade em curvas aproximadas com \n\npontos de baixo tamanho amostral, foi poss\u00edvel desenvolver um novo m\u00e9todo de gera\u00e7\u00e3o de \n\ncurvas de drill-rate, que leva em considera\u00e7\u00e3o o n\u00famero de dados originais e o valor de range \n\ncalculado. \n\nUtilizando os dados j\u00e1 filtrados por erros de leitura e valores aberrantes, determinados \n\npela ferramenta de diagrama de caixa, uma rotina de MATLAB foi desenvolvida para testar \n\ntodas as possibilidades de combina\u00e7\u00e3o dos pontos para um valor de RPM e FLO qualquer, de \n\nacordo com a equa\u00e7\u00e3o (12) de combina\u00e7\u00e3o simples, para curvas com 3 pontos at\u00e9 o n\u00famero \n\ntotal de pontos dispon\u00edvel, excluindo da an\u00e1lise pontos que representem um tamanho amostral \n\nde apenas 1 dado. Todas as poss\u00edveis combina\u00e7\u00f5es s\u00e3o utilizadas para aproximar curvas \n\npolinomiais de segundo grau, e as curvas com concavidade para baixo tem seus valores de \n\nrange calculados e utilizados, juntos das margens de erro m\u00e1ximas esperadas para os pontos de \n\nmenor confian\u00e7a, para averiguar as probabilidades do v\u00e9rtice estar deslocado em propor\u00e7\u00f5es \n\nrelativas ao founder point. \n\nEm seguida, as curvas com probabilidade de deslocamento menor que 10% acima de 90% \n\ns\u00e3o separadas e passam por uma nova an\u00e1lise. S\u00e3o selecionadas as curvas com a menor margem \n\nde erro poss\u00edvel e, entre elas, \u00e9 selecionada a que tiver mais pontos e que tenha a coordenada \n\nhorizontal do v\u00e9rtice dentro de um intervalo determinado por um diagrama de caixa aplicado \u00e0 \n\ntodos os valores das curvas (de modo a excluir curvas com coordenadas suspeitamente distantes \n\nda mediana da popula\u00e7\u00e3o). \n\nCaso n\u00e3o existam curvas com essas caracter\u00edsticas, s\u00e3o separadas aquelas com \n\nprobabilidade de deslocamento menor que 20% acima de 90%, e os mesmos crit\u00e9rios acima s\u00e3o \n\nutilizados para a escolha da curva ideal. No caso extremo em que nenhuma curva seja \n\nselecionada, s\u00e3o separadas as curvas com maior probabilidade de deslocamento menor que \n\n30%, e caso haja mais de uma com a probabilidade m\u00e1xima, os mesmos crit\u00e9rios de escolha \n\nanteriores s\u00e3o utilizados. \n\n  \n\n\n\n38 \n \n\n \n\n4 RESULTADOS \n\n \n\nFigura 14 - Dados de perfura\u00e7\u00e3o do po\u00e7o Ogonga-1. Em destaque (vermelho), os valores detectados \n\ncomo aberrantes pelos m\u00e9todos de filtragem inicial \n\n    \nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n\n \n\nNa Figura 14, foram representados os dados de perfura\u00e7\u00e3o Ogonga-1 em fun\u00e7\u00e3o da \n\nprofundidade em rela\u00e7\u00e3o ao n\u00edvel do mar. Com o m\u00e9todo de filtragem inicial, foram destacados \n\nos valores aberrantes mais evidentes da distribui\u00e7\u00e3o, que poderiam a distorcer as curvas geradas \n\nem seguida. \n\n5\n0\n5\n0\n \n\n5\n8\n4\n0\n \n\nP\nro\n\nfu\nn\nd\nid\n\na\nd\n\ne\n (\n\nm\n) \n\n\n\n39 \n \n\n \n\nA separa\u00e7\u00e3o dos dados em categorias distintas utilizando os valores da rota\u00e7\u00e3o RPM e do \n\nfluxo de fluido de perfura\u00e7\u00e3o FLO, e a utiliza\u00e7\u00e3o da ferramenta de diagrama de caixa ajustado \n\npara passos de WOB, em conjunto com o m\u00e9todo de regress\u00e3o linear com valores ponderados \n\nem rela\u00e7\u00e3o aos tamanhos amostrais de origem, resultou em curvas bem definidas e de f\u00e1cil \n\nan\u00e1lise pelos operadores da sonda de perfura\u00e7\u00e3o. As rotinas utilizadas para a realiza\u00e7\u00e3o desses \n\npassos foram detalhadas no Ap\u00eandice A. \n\nAlgumas das curvas geradas em momentos distintos do desenvolvimento do projeto, com \n\nseus respectivos par\u00e2metros de opera\u00e7\u00e3o e WOB do ponto de inflex\u00e3o da par\u00e1bola, foram \n\nrepresentadas na Figura 15. As curvas pontilhadas foram aproximadas antes da utiliza\u00e7\u00e3o do \n\ndiagrama de caixa ajustado, seguida das curvas azuis, ap\u00f3s a retirada dos outliers e, por fim, as \n\ncurvas em laranja, tra\u00e7adas ao aplicar pesos para os dados reduzidos \u00e0s suas m\u00e9dias. Apesar do \n\nmenor valor de R2 para alguns casos, elas representam as melhores aproxima\u00e7\u00f5es poss\u00edveis com \n\na quantidade de dados dispon\u00edveis. \n\n \n\nFigura 15 - Curvas calculadas ao longo do progresso dos m\u00e9todos, para rota\u00e7\u00e3o de 110 rpm e fluxo de \n\n600 gpm \n\n \nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n\n\n\n40 \n \n\n \n\nFigura 16 - Curvas calculadas ao longo do progresso dos m\u00e9todos, para rota\u00e7\u00e3o de 140 rpm e fluxo de \n\n650 gpm \n\n \nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n \n \n\nFigura 17 - Curvas calculadas ao longo do progresso dos m\u00e9todos, para rota\u00e7\u00e3o de 160 rpm e fluxo de \n\n700 gpm \n\n \nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n\n\n\n41 \n \n\n \n\nPela Figura 15, percebe-se que algumas curvas n\u00e3o necessitam de todo o processamento \n\nque passaram, pois j\u00e1 tem pontos bem definidos ainda antes da aplica\u00e7\u00e3o do diagrama de caixa. \n\nEntretanto, as Figura 16 e Figura 17 apresentam curvas que se comportaram muito diferentes \n\nda tend\u00eancia dos pontos, quando analisados visualmente.  \n\nNa primeira, o \u00faltimo ponto, apesar de ser o resultado da m\u00e9dia de apenas dois dados, \n\ninduz a aproxima\u00e7\u00e3o da curva passando por ele, apesar de n\u00e3o ser muito confi\u00e1vel. Quando \n\nutilizado o m\u00e9todo de valores ponderados, os outros pontos que t\u00eam tamanhos amostrais \n\nmaiores induzem a aproxima\u00e7\u00e3o da curva na dire\u00e7\u00e3o mais precisa, modificando o WOB do \n\nv\u00e9rtice de 63 klbf para a primeira regress\u00e3o linear, para 46 klbf, um valor mais condizente com \n\nos valores de WOB utilizados ao longo da perfura\u00e7\u00e3o do po\u00e7o.  \n\nEntretanto, apesar dos valores ponderados, o m\u00e9todo de regress\u00e3o linear n\u00e3o descarta \n\nnenhum ponto e tenta aproxim\u00e1-los todos da melhor forma poss\u00edvel, o que acaba gerando curvas \n\nincorretas. Os dois primeiros pontos da segunda Figura 16 aparentam pertencerem \u00e0 regi\u00e3o II \n\nda curva de drill-rate, e consequentemente n\u00e3o deveriam ser utilizados para tra\u00e7ar uma par\u00e1bola \n\naproximada. Isso acabou por modificando o valor calculado para WOB do v\u00e9rtice de 17 klbf \n\npara 6 klbf, o que \u00e9 demasiadamente baixo e foge da tend\u00eancia geral dos dados dispon\u00edveis. \n\nAs curvas calculadas com os m\u00e9todos anteriores nem sempre representaram bem os \n\npontos, especialmente quando h\u00e1 uma escassez de dados. Nesses casos, foi utilizado o m\u00e9todo \n\ncom as tabelas de probabilidade por valor de range, como na Figura 18. As tr\u00eas primeiras \n\ncurvas, calculadas da mesma forma que a das figuras anteriores, foram aproximadas como retas \n\ndecrescentes, o que explica o comportamento geral dos dados, mas deixa por desejar o valor do \n\nWOB do v\u00e9rtice. A curva aproximada com as tabelas utilizou os quatro pontos mais confi\u00e1veis \n\ndispon\u00edveis, evitando assim uma distor\u00e7\u00e3o muito grande de seu comportamento, e calculou a \n\nposi\u00e7\u00e3o do v\u00e9rtice com a probabilidade de 72% de estar deslocada do valor real em apenas 10%, \n\nem rela\u00e7\u00e3o ao founder point. Para intervalos de deslocamento maiores, a probabilidade \n\nultrapassa 90%, que por ser uma medida calculada utilizando valores de margem de erro \n\nm\u00e1ximos para uma distribui\u00e7\u00e3o normal (com intervalo de confian\u00e7a de 95%), \u00e9 um valor \n\nbastante confi\u00e1vel. \n\n\n\n42 \n \n\n \n\nFigura 18 - Curvas calculadas ao longo do progresso dos m\u00e9todos, para rota\u00e7\u00e3o de 120 rpm e fluxo de \n\n600 gpm \n\n \nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n \n\n\n\n43 \n \n\n \n\n5 CONCLUS\u00c3O \n\n \n \n\nPo\u00e7os perfurados em \u00e1gua ultraprofundas, sobretudo na regi\u00e3o de pr\u00e9-sal no Atl\u00e2ntico \n\nSul, apresentam maiores dificuldades que resultam em uma taxa de penetra\u00e7\u00e3o m\u00e9dia \n\nconsideravelmente baixa. Por conta da imprevisibilidade das forma\u00e7\u00f5es rochosas, as brocas \n\nutilizadas apresentam em m\u00e9dia vidas \u00fateis de 20 a 250 metros por descida para brocas PDC, \n\n100 a 250 metros por descida para brocas tric\u00f4nicas, e 400 a 500 metros por descida para brocas \n\nde coroa impregnada, resultando em custos entre US$30.000 e US$50.000 por metro, o que \u00e9 \n\num custo consideravelmente alto, sobretudo quando o valor do barril de petr\u00f3leo mundial est\u00e1 \n\nem baixa (HBAIEB e AZAR, 2013). Entretanto, a tecnologia de explora\u00e7\u00e3o desses po\u00e7os ainda \n\nest\u00e1 em desenvolvimento, e h\u00e1 espa\u00e7o para melhorias e interesse em t\u00e9cnicas de otimiza\u00e7\u00e3o de \n\nperfura\u00e7\u00e3o em tempo real (WOOD, 2015). \n\nCom os m\u00e9todos propostos para a filtragem e organiza\u00e7\u00e3o dos dados de perfura\u00e7\u00e3o, foi \n\nposs\u00edvel a aproxima\u00e7\u00e3o de curvas an\u00e1logas \u00e0s obtidas durante a realiza\u00e7\u00e3o de drill-rate tests, \n\ncomportando-se como o esperado, explicitando o valor de WOB para o ponto de inflex\u00e3o e o \n\nROP m\u00e1ximo poss\u00edvel para a configura\u00e7\u00e3o utilizada, garantindo a estipula\u00e7\u00e3o de um limite \n\noperacional para auxiliar na escolha dos novos par\u00e2metros de perfura\u00e7\u00e3o pelo operador. \n\nDestaca-se que as curvas geradas a partir desses m\u00e9todos mostraram-se mais precisas e \n\nconfi\u00e1veis que as constru\u00eddas manualmente durante os testes de perfura\u00e7\u00e3o peri\u00f3dicos, \n\nutilizando os mesmos dados dos registros ASCII coletados pelos sensores da sonda. Al\u00e9m disso, \n\nconferem uma diminui\u00e7\u00e3o no tempo de an\u00e1lise dos dados de testes, acelerando o progresso da \n\nopera\u00e7\u00e3o. \n\nEntretanto, uma quantidade alta de curvas geradas com dados de opera\u00e7\u00e3o corrente se \n\ncomportaram como retas crescentes ou decrescentes, diferentemente do comportamento \n\nesperado. Realizando uma an\u00e1lise visual dessas curvas, percebe-se que muitas est\u00e3o \n\n\u201ccontaminadas\u201d com dados das outras duas regi\u00f5es das curvas de drill-rate e, inclusive, com \n\ndados de trechos de profundidade distantes um do outro, pois a \u00fanica forma utilizada para \n\nseparar esses dados foi com os valores de RPM e FLO, que acabam sendo utilizados diversas \n\nvezes ao longo do processo. \n\nPortanto, para futuras an\u00e1lises, uma forma de separa\u00e7\u00e3o desses dados por trechos de \n\nlitologia similar e de utiliza\u00e7\u00e3o do mesmo modelo de broca deve ser desenvolvido, aprimorando \n\no m\u00e9todo aqui proposto. H\u00e1 tamb\u00e9m espa\u00e7o para a inclus\u00e3o de um m\u00e9todo de previs\u00e3o das \n\ncurvas, utilizando dados de energia espec\u00edfica hidromec\u00e2nica, possibilitando uma compara\u00e7\u00e3o \n\n\n\n44 \n \n\n \n\ngr\u00e1fica entre o comportamento previsto e o observado, explicitando inefici\u00eancias na \n\nconfigura\u00e7\u00e3o utilizada e garantindo mais um n\u00edvel de aux\u00edlio na tomada de decis\u00f5es. \n\nA partir dos m\u00e9todos desenvolvidos nesse trabalho, torna-se poss\u00edvel o desenvolvimento \n\nde um sistema computacional em conjunto com a ind\u00fastria petrol\u00edfera, de modo a atualizar as \n\ncurvas geradas em tempo real com os dados correntes de opera\u00e7\u00e3o, representando uma inova\u00e7\u00e3o \n\npara a \u00e1rea.  \n\n\n\n45 \n \n\n \n\nBIBLIOGRAFIA \n\n \n \nAL DUSHAISHI, M. F. Investigation of Drillstring Vibration Reduction Tools. Missouri \nUniversity of Science and Technology. [S.l.]. 2012. \n \nBERG, P. V.; TVEIT, \u00d8. S. Model for evaluating drilling efficiency based on the concept \nof Mechanical Specific Energy. Norwegian University of Science and Technology. \nTrondheim. 2016. \n \nBOURGOYNE, A. T. et al. Applied Drilling Engineering. [S.l.]: Society of Petroleum \nEngineers, v. SPE Textbook Series Vol. 2, 1991. \n \nCOSTA NETO, P. L. D. O. Estat\u00edstica. 2. ed. S\u00e3o Paulo: Edgard Bl\u00fccher, 2002. \n \nDUPRIEST, F. E.; KOEDERITZ, W. L. Maximizing Drill Rates with Real-Time \nSurveillance of Mechanical Specific Energy. SPE/IADC Drilling Conference. [S.l.]: Society \nof Petroleum Engineers. 2005. \n \nGALP Energia. Galp Energia, 2014. Disponivel em: \n<http://www.galpenergia.com/PT/agalpenergia/os-nossos-negocios/Exploracao-\nProducao/fundamentos-engenharia-petroleo/Paginas/Perfuracao.aspx>. Acesso em: Dezembro \n2016. \n \nHBAIEB, S.; AZAR, M. Hybrid Bit Improves Drilling Efficiency in Brazil's Pre-salt \nFormations. World Oil, p. B154-B157, Setembro 2013. \n \nHUBERT, M.; VANDERVIERE, E. An Adjusted Boxplot for Skewed Distributions. \nProceedings in Computational Statistics, p. 1933-1940, Janeiro 2004. \n \nHUBERT, M.; VERBOVEN, S. LIBRA: a MATLAB Library for Robust Analysis. \nChemometrics and Intelligent Laboratory Systems, v. 75, n. 2, p. 127-136, Fevereiro 2005. \n \nIADC Drilling Manual. 12. ed. [S.l.]: International Association of Drilling Contractors, 2014. \n \nLEYS, C. et al. Detecting Outliers: Do Not Use Standard Deviation Around The Mean, Use \nAbsolute Deviation Around The Median. Journal of Experimental Social Psychology, v. \n49, n. 4, p. 764\u2013766, Julho 2013. \n \nMITCHELL, R. F.; MISKA, S. Z. Fundamentals of Drilling Engineering. [S.l.]: Society of \nPetroleum Engineers, 2011. \n \nNASCIMENTO, A. et al. Dynamic Drill-rate Test Approach Applied to a Pre-salt Case \nStudy. SPE Latin American and Caribbean Petroleum Engineering Conference. Quito: [s.n.]. \n2015. \n \nRICE, J. A. Convergence in Distribution and the Central Limit Theorem. Mathematical \nStatistics and Data Analysis. 3. ed. [S.l.]: Duxbury Press, 2007. Cap. 5.3. \n \n  \n\n\n\n46 \n \n\n \n\nAP\u00caNDICE A \u2013 C\u00d3DIGO FONTE DE ROTINAS NO MATLAB \n\n \n\nOs quadros apresentados nesse ap\u00eandice cont\u00eam os c\u00f3digos fonte das rotinas \ndesenvolvidas no software MATLAB, com descri\u00e7\u00f5es detalhadas das linhas de c\u00f3digo mais \nimportantes na cor verde, de modo a facilitar o entendimento da l\u00f3gica program\u00e1tica das \nrotinas. \n\n(continua) \n\n \n\n%% Organiza os dados originais em campos de gpm/rpm espec\u00edficos \n \n\nload drillingdata %carrega os dados filtrados no Excel \n\n \nRPMmin = 0; GPMmin = 0; RPMmax = 0; GPMmax = 0; \nH = height(drillingdata2); %n\u00famero de linhas na tabela \ndatadr = []; %cria uma matriz vazia \nfor i = 1:H \n    rpm = round(drillingdata2{i,1}/10,0)*10; %aproxima para o m\u00faltiplo \n\nde 10 mais pr\u00f3ximo \n    gpm = round(drillingdata2{i,5}/50,0)*50; %aproxima para o m\u00faltiplo \n\nde 50 mais pr\u00f3ximo \n    f = sprintf('gpm%drpm%d',gpm,rpm); %nome do campo gpm/rpm \n    if isfield(datadr, f) == 0 %checa se o campo gpm/rpm n\u00e3o existe \n        datadr.(f) = []; %cria campo gpm/rpm \n    end    \n    datadr.(f) = [datadr.(f); drillingdata2{i,2:4}]; %adiciona linhas na \n\nmatriz existente \n    % Designa valores m\u00ednimo e m\u00e1ximo para rpm e gpm \n    if i == 1; RPMmin = rpm; GPMmin = gpm; end \n    if rpm &lt;RPMmin; RPMmin = rpm; end \n    if rpm > RPMmax; RPMmax = rpm; end \n    if gpm &lt;GPMmin; GPMmin = gpm; end \n    if gpm > GPMmax; GPMmax = gpm; end \nend \n\n \n%% Filtra e separa dados organizados em passos de WOB \n \n\ndatadr_p = []; \nfor gpm = GPMmin:50:GPMmax \n    for rpm = RPMmin:10:RPMmax \n        f = sprintf('gpm%drpm%d',gpm,rpm); %nome do campo gpm/rpm \n        if isfield(datadr, f) == 0 %checa se o campo gpm/rpm n\u00e3o existe \n            continue \n        end \n        datadr.(f) = sortrows(datadr.(f)); %organiza linhas em ordem \n\nascendente \n        H = size(datadr.(f),1); %n\u00famero de linhas no campo \n        p = 10; %n\u00famero de pontos no gr\u00e1fico \n        ss = round(range(datadr.(f)(:,1))/(p*0.5))*0.5; %tamanho do \n\npasso de WOB a partir do primeiro valor [klbf] \n        if ss &lt;1 \n            ss = 1;    \n        elseif ss > 5 \n            ss = 5; \n        end \n\nQuadro 3 - C\u00f3digo fonte de rotina no MATLAB para organizar e filtrar dados, e gerar curvas de drill-\n\nrate \n\n\n\n47 \n \n\n \n\nQuadro 3 - C\u00f3digo fonte de rotina no MATLAB para organizar e filtrar dados, e gerar curvas \nde drill-rate \n\n(continua\u00e7\u00e3o) \n\n \n\n        j = ss; \n        i = 1; wob_p = []; rop_p = []; depth_p = []; \n        while i&lt;= H \n            while (i&lt;= H) &amp;&amp; (datadr.(f)(i,1)&lt;= datadr.(f)(1,1)+j) \n                wob_p = [wob_p; datadr.(f)(i,1)]; \n                rop_p = [rop_p; datadr.(f)(i,2)]; \n                depth_p = [depth_p; datadr.(f)(i,3)]; \n                i = i + 1; \n            end \n            n = size(wob_p,1); \n            if n ~= 0 %checa se h\u00e1 valores que correspondem com o atual \n\npasso de WOB \n                if isfield(datadr_p, f) == 0 %checa se o campo gpm/rpm \n\nn\u00e3o existe \n                    datadr_p.(f) = []; \n                end \n                datadr_p.(f) = [datadr_p.(f);[mean(wob_p) mean(rop_p) n \n\nmean(depth_p)]]; %adiciona linhas na matriz existente \n                datadr.(f)((i-n):(i-1),4) = mean(wob_p); \n                datadr.(f)(1,5) = ss; \n                wob_p = []; rop_p = []; depth_p = []; \n            end \n            j = j + ss; %aumenta o tamanho do passo a partir do primeiro \n\nvalor em um passo \n        end \n    end \nend \n\n \n%% Identifica valores aberrantes e tra\u00e7a curvas de drill-rate \n \n\nfor gpm = GPMmin:50:GPMmax \n    for rpm = RPMmin:10:RPMmax \n        f = sprintf('gpm%drpm%d',gpm,rpm); %nome do campo gpm/rpm \n        if isfield(datadr_p, f) == 0 %checa se o campo gpm/rpm n\u00e3o \n\nexiste \n            continue \n        end \n        if size(datadr_p.(f),1) &lt;3 %ignora campos com menos de tr\u00eas \n\ndados \n            continue \n        end \n        figure; \n        set(gcf,'units','normalized','outerposition',[0 0 0.5 1]) \n\n%estabelece posi\u00e7\u00e3o na imagem no lado esquerdo da tela \n        clear title \n        wob = datadr_p.(f)(:,1); %[klbf] \n        rop = datadr_p.(f)(:,2); %[m/h] \n        n = datadr_p.(f)(:,3); %n\u00famero de dados reduzidos \u00e0 m\u00e9dia \n        [eq,gof,output] = fit(wob,rop,'poly2'); %aproxima\u00e7\u00e3o para uma \n\nfun\u00e7\u00e3o quadr\u00e1tica \n        % Gera os diagramas de caixa e dispers\u00e3o de dados \n            adjustedboxplot(datadr.(f)(:,2),'groupvalid', \n\ndatadr.(f)(:,4),'positions',unique(datadr.(f)(:,4)),'colors',[0.4 0.6 \n\n1],'widths',0.3,'symbol','.w'); \n\n\n\n48 \n \n\n \n\nQuadro 3 - C\u00f3digo fonte de rotina no MATLAB para organizar e filtrar dados, e gerar curvas \nde drill-rate \n\n(continua\u00e7\u00e3o) \n\n \n \n \n \n\n            % Estabelece estilo dos diagramas de caixa \n            bp_obj = findobj(gca,'Tag','Box'); \n            set(bp_obj,'LineWidth',1.5) \n            whisk = findobj(gca,'-regexp','Tag','\\w*Whisker'); \n            set(whisk,'LineStyle','-') \n            for j = 1:length(bp_obj) \n                patch(get(bp_obj(j),'XData'),get(bp_obj(j),'YData'),[0.4 \n\n0.6 1],'FaceAlpha',0.5,'LineWidth',1.5,'EdgeColor',[0.4 0.6 1]); \n            end \n            bp_median = findobj(gca,'Tag','Median'); \n            for j = 1:length(bp_median) \n                line(get(bp_median(j),'XData'), \n\nget(bp_median(j),'YData'),'Color','w','LineWidth',1.5); \n            end \n            bp_out = findobj(gca,'Tag','Outliers'); \n            set(gca,'xtickmode','auto','xticklabelmode','auto') \n            hold on \n            scatter(datadr.(f)(:,4),datadr.(f)(:,2),20,'o', \n\n'MarkerEdgeColor',[0.6 0.6 0.6],'MarkerFaceColor','w'); %dispersa dados \n\nno centro de cada passo, para facilitar a visualiza\u00e7\u00e3o gr\u00e1fica \n            for j = 1:length(bp_out) \n                scatter(get(bp_out(j),'XData'),get(bp_out(j),'YData'), \n\n20,'o','MarkerEdgeColor',[1 0.5 0]) \n            end \n        % Procura por valores aberrantes no diagrama de caixa \n            H = size(datadr_p.(f),1); \n            if isempty(bp_out) == 0 \n                out = get(bp_out(:),'YData'); %grava valores aberrantes \n\ndo diagrama de caixa \n                if iscell(out) == 0 \n                    out = num2cell(out); \n                end \n                out_log = ismember(datadr.(f)(:,2),cat(2,out{:})', \n\n'rows'); %cria matriz l\u00f3gica para indicar valores aberrantes \n            else \n                out_log = 0; \n            end \n            if sum(out_log) >= 1 %checa se h\u00e1 valores aberrantes \n                wob_out = ~out_log.*datadr.(f)(:,1); \n                rop_out = ~out_log.*datadr.(f)(:,2); \n                n_new = zeros(H,1); wob_new = zeros(H,1); rop_new = \n\nzeros(H,1); k = 1; \n                for j = 1:H %remove valores aberrantes dos dados \n                    n_new(j,1) = datadr_p.(f)(j,3)-\n\nsum(out_log(k:k+n(j,1)-1,1)); \n                    wob_new_temp = wob_out(k:k+n(j,1)-1,1); \n                    wob_new(j,1) = mean(wob_new_temp(wob_new_temp~=0)); \n                    rop_new_temp = rop_out(k:k+n(j,1)-1,1); \n                    rop_new(j,1) = mean(rop_new_temp(rop_new_temp~=0)); \n                    k = k+n(j,1); \n                end \n            end \n\n\n\n49 \n \n\n \n\nQuadro 3 - C\u00f3digo fonte de rotina no MATLAB para organizar e filtrar dados, e gerar curvas \nde drill-rate \n\n(continua\u00e7\u00e3o) \n\n \n\n            if sum(out_log) &lt;1 \n                n_new = n; \n                wob_new = wob; \n                rop_new = rop; \n                output_new = output; \n            end \n        % Gera dados ponderados  \n            wob_w = []; rop_w = []; \n            for j = 1:H \n                wob_w = [wob_w; repmat(wob_new(j,1),n_new(j,1),1)]; \n                rop_w = [rop_w; repmat(rop_new(j,1),n_new(j,1),1)]; \n            end \n        % Aproxima e gera curvas de drill-rate \n        if eq.p1 > 0 %se a par\u00e1bola tiver concavidade para cima \n            % Aproxima curva com dados originais \n                [eq,gof,output] = fit(wob,rop,'poly1'); %aproxima\u00e7\u00e3o \n\npara uma equa\u00e7\u00e3o linear \n                pl = plot(eq,':k',wob,rop,'^'); \n                set(pl,'MarkerEdgeColor','k','MarkerFaceColor','w', \n\n'DisplayName',['Curva original (R^{2} = ' num2str(gof.rsquare) ')']) \n                leg = legend(pl(2),'Location','Northwest'); \n                set(leg,'FontSize',16); \n            % Aproxima curva com dados sem valores aberrantes \n                if sum(out_log) >= 1 %checa se h\u00e1 valores aberrantes \n                    % Aproxima curva com novos dados \n                    [eq_new,gof_new,output_new] = \n\nfit(wob_new,rop_new,'poly2'); %aproxima\u00e7\u00e3o para uma equa\u00e7\u00e3o quadr\u00e1tica \n                    if eq_new.p1 > 0 %se a par\u00e1bola tiver concavidade \n\npara cima \n                        [eq_new,gof_new,output_new] = \n\nfit(wob_new,rop_new,'poly1'); %aproxima\u00e7\u00e3o para uma equa\u00e7\u00e3o linear \n                    end \n                    pl_new = plot(eq_new,'-k',wob_new,rop_new,'^'); \n                    set(pl_new,'MarkerEdgeColor','k','MarkerFaceColor', \n\n'g','DisplayName',['Curva nova (R^{2} = ' num2str(gof_new.rsquare) ')']) \n                    leg = legend([pl(2),pl_new(2)],'Location', \n\n'Northwest'); \n                    set(leg,'FontSize',16); \n                end \n            % Aproxima curva com dados ponderados \n                [eq_w,gof_w,output_w] = fit(wob_w,rop_w,'poly2'); \n\n%aproxima\u00e7\u00e3o para uma equa\u00e7\u00e3o quadr\u00e1tica \n                if eq_w.p1 > 0 %se a par\u00e1bola tiver concavidade para \n\ncima \n                    [eq_w,gof_w,output_w] = fit(wob_w,rop_w,'poly1'); \n\n%aproxima\u00e7\u00e3o para uma equa\u00e7\u00e3o linear \n                end \n                pl_w = plot(eq_w,'-r',wob_w,rop_w,'^'); \n                set(pl_w,'MarkerEdgeColor','none','MarkerFaceColor', \n\n'none','DisplayName',['Curva ponderada (R^{2} = ' num2str(gof_w.rsquare) \n\n')']) \n                if sum(out_log)&lt;= 1 \n                    leg = legend([pl(2),pl_w(2)],'Location', \n\n'Northwest'); \n\n                    set(leg,'FontSize',16); \n\n\n\n50 \n \n\n \n\nQuadro 3 - C\u00f3digo fonte de rotina no MATLAB para organizar e filtrar dados, e gerar curvas \nde drill-rate \n\n(continua\u00e7\u00e3o) \n\n \n\n                else \n                    leg = legend([pl(2),pl_new(2),pl_w(2)],'Location', \n\n'Northwest'); \n                    set(leg,'FontSize',16); \n                end \n            % Mostrar tamanho amostral no gr\u00e1fico \n                for j = 1:H \n                    text(min(get(whisk(2*H+1-\n\n2*j),'XData')),min(get(whisk(2*H+1-2*j),'YData')),{['n = ' \n\nnum2str(n_new(j))]},'FontSize',10,'HorizontalAlignment','Center','Vertic\n\nalAlignment','Top'); \n                end \n        else %se a par\u00e1bola tiver concavidade para baixo \n            % Aproxima curva com dados originais \n                wob_max = -eq.p2/(2*eq.p1); %coordenada horizontal do \n\nponto de inflex\u00e3o \n                rop_max = feval(eq,wob_max); %coordenada vertical do \n\nponto de inflex\u00e3o \n                pl = plot(eq,':k',wob,rop,'^k'); \n                set(pl,'MarkerEdgeColor','k','MarkerFaceColor','w', \n\n'DisplayName',['Curva original (R^{2} = ' num2str(gof.rsquare) ')']) \n                leg = legend(pl(2),'Location','Northwest'); \n                set(leg,'FontSize',16); \n            % Aproxima curva com dados sem valores aberrantes \n                if sum(out_log) >= 1 %checa se h\u00e1 valores aberrantes \n                    [eq_new,gof_new,output_new] = \n\nfit(wob_new,rop_new,'poly2'); %aproxima\u00e7\u00e3o para uma equa\u00e7\u00e3o quadr\u00e1tica \n                    if eq_new.p1 > 0 %se a par\u00e1bola tiver concavidade \n\npara cima \n                        [eq_new,gof_new,output_new] = \n\nfit(wob_new,rop_new,'poly1'); %aproxima\u00e7\u00e3o para uma equa\u00e7\u00e3o linear \n                    end \n                    pl_new = plot(eq_new,'-k',wob_new,rop_new,'^'); \n                    set(pl_new,'MarkerEdgeColor','k','MarkerFaceColor', \n\n'g','DisplayName',['Curva nova (R^{2} = ' num2str(gof_new.rsquare) ')']) \n                    leg = \n\nlegend([pl(2),pl_new(2)],'Location','Northwest'); \n                    set(leg,'FontSize',16); \n                end \n            % Aproxima curva com dados ponderados \n                [eq_w,gof_w,output_w] = fit(wob_w,rop_w,'poly2'); \n\n%aproxima\u00e7\u00e3o para uma equa\u00e7\u00e3o quadr\u00e1tica \n                if eq_w.p1 > 0 %se a par\u00e1bola tiver concavidade para \n\ncima \n                    [eq_w,gof_w,output_w] = fit(wob_w,rop_w,'poly1'); \n\n%aproxima\u00e7\u00e3o para uma equa\u00e7\u00e3o linear \n                end \n                pl_w = plot(eq_w,'-r',wob_w,rop_w,'^'); \n                set(pl_w,'MarkerEdgeColor','none','MarkerFaceColor', \n\n'none','DisplayName',['Curva ponderada (R^{2} = ' num2str(gof_w.rsquare) \n\n')']) \n                if sum(out_log)&lt;= 1 \n                    leg = legend([pl(2),pl_w(2)],'Location', \n\n'Northwest'); \n                    set(leg,'FontSize',16); \n\n\n\n51 \n \n\n \n\nQuadro 3 - C\u00f3digo fonte de rotina no MATLAB para organizar e filtrar dados, e gerar curvas \nde drill-rate \n\n(conclus\u00e3o) \n\n \nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n \n  \n\n                else \n\n                    leg = legend([pl(2),pl_new(2),pl_w(2)],'Location', \n\n'Northwest'); \n                    set(leg,'FontSize',16); \n                end \n            % Mostrar tamanho amostral no gr\u00e1fico \n                for j = 1:H \n                    text(min(get(whisk(2*H+1-\n\n2*j),'XData')),min(get(whisk(2*H+1-2*j),'YData')),{['n = ' \n\nnum2str(n_new(j))]},'FontSize',10,'HorizontalAlignment','Center','Vertic\n\nalAlignment','Top'); \n                end \n        end \n        % Identifica curva tra\u00e7ada \n        title(['RPM: ' num2str(rpm) ' rpm, FLO: ' num2str(gpm) ' gpm'], \n\n'FontSize', 30, 'FontWeight', 'normal') \n        xlabel('WOB (klbf)', 'FontSize', 20) \n        ylabel('ROP (m/h)', 'FontSize', 20) \n        % Espera a\u00e7\u00e3o para continuar la\u00e7o \n        w = waitforbuttonpress; \n        if w == 0 %encerra la\u00e7o ao clicar em qualquer lugar \n            return \n        else %continua la\u00e7o ao pressionar qualquer tecla \n            close all \n            continue \n        end \n    end \n\nend \n\n\n\n52 \n \n\n \n\nQuadro 4 - C\u00f3digo fonte de rotina no MATLAB para determinar curva de drill-rate \u00f3tima utilizando \n\nas tabelas de confian\u00e7a \n\n(continua) \n\n \n\n%% Analisa todas as possibilidades de curvas poss\u00edveis e tra\u00e7a as mais \n\nconfi\u00e1veis \n\n \nax = gca; %grava os eixos do gr\u00e1fico original (gerado a partir da fun\u00e7\u00e3o \n\nanterior) \nntemp = n_new(n_new~=1); %remove valores onde n = 1 \nwobtemp = wob_new(n_new~=1); \nroptemp = rop_new(n_new~=1); \nif size(ntemp,1) &lt;3 %ignora campos com menos de tr\u00eas dados  \n    return \nend \n% Gera e analisa todas as curvas poss\u00edveis \npoints = 3; %n\u00famero de pontos na curva \nsavedfunc = []; \nwhile points &lt;size(ntemp,1) \n    combinations = combnk(1:size(ntemp,1),points); %calcula todas as \n\nposs\u00edveis combina\u00e7\u00f5es dos dados agrupados em tr\u00eas ao valor m\u00e1ximo de \n\npontos \n    maxlog = zeros(size(ntemp,1),size(combinations,1)); %cria uma matriz \n\nnula para posteriormente identificar quais dados ser\u00e3o utilizados \n    for comb = 1:size(combinations,1) \n        savedfunc = cat(2,savedfunc,checkcurve(combinations(comb,:), \n\nmaxlog(:,comb),ntemp,wobtemp,roptemp)); %chama a fun\u00e7\u00e3o checkcurve para \n\ndeterminar a confian\u00e7a nas curvas utilizando as tabelas \n    end \n    points = points + 1; \nend \n% select best curve \nif isempty(savedfunc) == 0 \n    if max(savedfunc(1,:)) > 0.9 \n        savedfunctemp = savedfunc(:,savedfunc(1,:)>0.9); %seleciona \n\ncurvas com confian\u00e7a acima de 90% \n        [~,ii] = min(savedfunctemp(4,:)); %seleciona curvas com a menor \n\nmargem de erro \n        repeatedlog = ismember(savedfunctemp(4,:),savedfunctemp(4,ii)); \n\n%checa por duplicatas \n        % Calcula e seleciona curvas similares \n        if sum(repeatedlog) > 1 \n            mlogtemp = savedfunctemp(7:end,:).*repmat(repeatedlog, \n\nsize(savedfunctemp(7:end,:),1),1); %matriz maxlog para todas as curvas \n\nselecionadas \n            mlogtemp = evalmaxfunc(mlogtemp,ntemp,wobtemp,roptemp); \n\n%grava a coordenada horizontal do v\u00e9rtice \n            figure; bp = boxplot(mlogtemp); \n            out = get(findobj(bp,'Tag','Outliers'),'YData'); %grava \n\nvalores muito distantes da mediana \n            close %fecha diagrama de caixa \n            out = +~(ismember(mlogtemp,out)); \n            out(out==0) = nan();  \n            repeatedlog = mlogtemp.*out; \n        end \n        [~,i] = max(sum(savedfunctemp(7:end,:).*repmat(ntemp,1, \n\nsize(savedfunctemp,2)).*repmat(repeatedlog,size(savedfunctemp(7:end,:),1\n\n),1))); %escolhe curva com mais pontos \n\n\n\n53 \n \n\n \n\nQuadro 4 - C\u00f3digo fonte de rotina no MATLAB para determinar curva de drill-rate \u00f3tima utilizando \n\nas tabelas de confian\u00e7a \n\n(continua\u00e7\u00e3o) \n\n \n\n        savedmlogtemp = mlogtemp; \n        % Seleciona uma curva com a segunda menor margem de erro (caso a \n\ncurva anteriormente selecionada tenha apenas tr\u00eas pontos) \n        if savedfunctemp(6,i) == 3 &amp;&amp; size(ntemp,1) > 3 \n            smallest = savedfunctemp(4,ii); \n            [~,ii] = min(savedfunctemp(4,savedfunctemp(4,:)~=smallest)); \n\n%seleciona curvas com menor margem de erro \n            repeatedlog = ismember(savedfunctemp(4,:),savedfunctemp(4, \n\nii)); %checa por duplicatas \n            % Calcula e seleciona curvas similares \n            if sum(repeatedlog) > 1 \n                mlogtemp = savedfunctemp(7:end,:).*repmat(repeatedlog, \n\nsize(savedfunctemp(7:end,:),1),1); %matriz maxlog para todas as curvas \n\nselecionadas \n                mlogtemp = evalmaxfunc(mlogtemp,ntemp,wobtemp,roptemp); \n\n%grava a coordenada horizontal do v\u00e9rtice \n                figure; bp = boxplot(mlogtemp); \n                out = get(findobj(bp,'Tag','Outliers'),'YData'); %grava \n\nvalores muito distantes da mediana \n                close %fecha diagrama de caixa \n                out = +~(ismember(mlogtemp,out)); \n                out(out==0) = nan();  \n                repeatedlog = mlogtemp.*out; \n            end \n            [~,i] = max(sum(savedfunctemp(7:end,:).*repmat(ntemp,1, \n\nsize(savedfunctemp,2)).*repmat(repeatedlog,size(savedfunctemp(7:end,:),1\n\n),1))); %escolhe curva com mais pontos \n        end \n        maxlog = savedfunctemp(7:end,i); \n        curveprob = savedfunctemp(1:3,i); \n    elseif max(savedfunc(2,:)) > 0.9 \n        savedfunctemp = savedfunc(:,savedfunc(2,:)>0.9); %seleciona \n\ncurvas com confian\u00e7a acima de 90% \n        [~,ii] = min(savedfunctemp(4,:)); %seleciona curvas com menor \n\nmargem de erro \n        repeatedlog = ismember(savedfunctemp(4,:),savedfunctemp(4,ii)); \n\n%checa por duplicadas \n        % Calcula e seleciona curvas similares \n        if sum(repeatedlog) > 1 \n            mlogtemp = savedfunctemp(7:end,:).*repmat(repeatedlog, \n\nsize(savedfunctemp(7:end,:),1),1); %matriz maxlog para todas as curvas \n\nselecionadas \n            mlogtemp = evalmaxfunc(mlogtemp,ntemp,wobtemp,roptemp); \n\n%grava a coordenada horizontal do v\u00e9rtice \n            figure; bp = boxplot(mlogtemp); \n            out = get(findobj(bp,'Tag','Outliers'),'YData'); %grava \n\nvalores muito distantes da mediana \n            close %fecha diagrama de caixa \n            out = +~(ismember(mlogtemp,out)); \n            out(out==0) = nan();  \n            repeatedlog = mlogtemp.*out; \n        end \n\n        [~,i] = max(sum(savedfunctemp(7:end,:).*repmat(ntemp,1, \n\nsize(savedfunctemp,2)).*repmat(repeatedlog,size(savedfunctemp(7:end,:),1\n\n),1))); %escolhe curva com mais pontos \n\n \n\n\n\n54 \n \n\n \n\nQuadro 4 - C\u00f3digo fonte de rotina no MATLAB para determinar curva de drill-rate \u00f3tima utilizando \n\nas tabelas de confian\u00e7a \n\n(continua\u00e7\u00e3o) \n\n \n \n\n        % Seleciona uma curva com a segunda menor margem de erro (caso a \n\ncurva anteriormente selecionada tenha apenas tr\u00eas pontos) \n        if savedfunctemp(6,i) == 3 &amp;&amp; size(ntemp,1) > 3 \n            smallest = savedfunctemp(4,ii); \n            [~,ii] = min(savedfunctemp(4,savedfunctemp(4,:)~=smallest)); \n\n%seleciona curvas com menor margem de erro \n            repeatedlog = ismember(savedfunctemp(4,:), \n\nsavedfunctemp(4,ii)); %checa por duplicatas \n            % Calcula e seleciona curvas similares \n            if sum(repeatedlog) > 1 \n                mlogtemp = savedfunctemp(7:end,:).*repmat(repeatedlog, \n\nsize(savedfunctemp(7:end,:),1),1); %matriz maxlog para todas as curvas \n\nselecionadas \n                mlogtemp = evalmaxfunc(mlogtemp,ntemp,wobtemp,roptemp); \n\n%grava a coordenada horizontal do v\u00e9rtice \n                figure; bp = boxplot(mlogtemp); \n                out = get(findobj(bp,'Tag','Outliers'),'YData'); %grava \n\nvalores muito distantes da mediana \n                close %fecha diagrama de caixa \n                out = +~(ismember(mlogtemp,out)); \n                out(out==0) = nan();  \n                repeatedlog = mlogtemp.*out; \n            end \n            [~,i] = max(sum(savedfunctemp(7:end,:).*repmat(ntemp,1, \n\nsize(savedfunctemp,2)).*repmat(repeatedlog,size(savedfunctemp(7:end,:),1\n\n),1))); %escolhe curva com mais pontos \n        end \n        maxlog = savedfunctemp(7:end,i); \n        curveprob = savedfunctemp(1:3,i); \n    else \n        [~,ii] = max(savedfunc(3,:)); %seleciona curvas com a maior \n\nconfian\u00e7a \n        repeatedlog = ismember(savedfunc(3,:),savedfunc(3,ii)); %checa \n\npor duplicatas (mais de uma curva com a mesma confian\u00e7a) \n        % Calcula e seleciona curvas similares \n        if sum(repeatedlog) > 1 \n            mlogtemp = savedfunc(7:end,:).*repmat(repeatedlog, \n\nsize(savedfunc(7:end,:),1),1); %matriz maxlog para todas as curvas \n\nselecionadas \n            mlogtemp = evalmaxfunc(mlogtemp,ntemp,wobtemp,roptemp); \n\n%grava a coordenada horizontal do v\u00e9rtice \n\n            figure; bp = boxplot(mlogtemp); \n            out = get(findobj(bp,'Tag','Outliers'),'YData'); %grava \n\nvalores muito distantes da mediana \n            close %fecha diagrama de caixa \n            out = +~(ismember(mlogtemp,out)); \n            out(out==0) = nan();  \n            repeatedlog = mlogtemp.*out; \n        end \n        [~,i] = max(sum(savedfunc(7:end,:).*repmat(ntemp,1, \n\nsize(savedfunc,2)).*repmat(repeatedlog,size(savedfunc(7:end,:),1),1))); \n\n%escolhe curva com mais pontos \n\n\n\n55 \n \n\n \n\nQuadro 4 - C\u00f3digo fonte de rotina no MATLAB para determinar curva de drill-rate \u00f3tima utilizando \n\nas tabelas de confian\u00e7a \n\n(continua\u00e7\u00e3o) \n\n \n \n\n        % Seleciona uma curva com a segunda menor margem de erro (caso a \n\ncurva anteriormente selecionada tenha apenas tr\u00eas pontos) \n        if savedfunc(6,i) == 3 &amp;&amp; size(ntemp,1) > 3 \n            highest = savedfunc(3,ii); \n            [~,ii] = max(savedfunc(3,savedfunc(3,:)~=highest)); \n\n%seleciona curvas com a maior confian\u00e7a \n            repeatedlog = ismember(savedfunc(3,:),savedfunc(3,ii)); \n\n%checa por duplicatas (mais de uma curva com a mesma confian\u00e7a) \n            % Calcula e seleciona curvas similares \n            if sum(repeatedlog) > 1 \n                mlogtemp = \n\nsavedfunc(7:end,:).*repmat(repeatedlog,size(savedfunc(7:end,:),1),1); \n\n%matriz maxlog para todas as curvas selecionadas \n                mlogtemp = evalmaxfunc(mlogtemp,ntemp,wobtemp,roptemp); \n\n%grava a coordenada horizontal do v\u00e9rtice \n                figure; bp = boxplot(mlogtemp); \n                out = get(findobj(bp,'Tag','Outliers'),'YData'); %grava \n\nvalores muito distantes da mediana \n                close %fecha o diagrama de caixa \n                out = +~(ismember(mlogtemp,out)); \n                out(out==0) = nan();  \n                repeatedlog = mlogtemp.*out; \n            end \n            [~,i] = max(sum(savedfunc(7:end,:).*repmat(ntemp,1, \n\nsize(savedfunc,2)).*repmat(repeatedlog,size(savedfunc(7:end,:),1),1))); \n\n%escolhe curva com mais pontos \n        end \n        maxlog = savedfunc(7:end,i); \n        curveprob = savedfunc(1:3,i); \n    end \nelse \n    return \nend \n% Tra\u00e7a curva selecionada \nmaxlog = logical(maxlog); \nwob_weighted = []; \nrop_weighted = []; \nntemp = ntemp(maxlog); \nwobtemp = wobtemp(maxlog); \nroptemp = roptemp(maxlog); \nfor j = 1:sum(maxlog) %gera dados ponderados \n    wob_weighted = [wob_weighted; repmat(wobtemp(j),ntemp(j),1)]; \n    rop_weighted = [rop_weighted; repmat(roptemp(j),ntemp(j),1)]; \nend \n[f1,gof1] = fit(wob_weighted,rop_weighted,'poly2'); %aproxima\u00e7\u00e3o para \n\numa equa\u00e7\u00e3o quadr\u00e1tica \nfigure; \nset(gcf,'units','normalized','outerposition',[0.5 0 0.5 1]) %estabelece \n\nposi\u00e7\u00e3o na imagem no lado esquerdo da tela \nscatter(datadr.(f)(:,1),datadr.(f)(:,2),'.b') \nhold on \n\n\n\n56 \n \n\n \n\nQuadro 4 - C\u00f3digo fonte de rotina no MATLAB para determinar curva de drill-rate \u00f3tima utilizando \n\nas tabelas de confian\u00e7a \n\n(conclus\u00e3o) \n\n \nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n \n \nQuadro 5 - C\u00f3digo fonte de rotina auxiliar no MATLAB, desenvolvido como fun\u00e7\u00e3o checkcurve, para \n\ndeterminar a confiabilidade das curvas de drill-rate utilizando as tabelas de confian\u00e7a \n\n(continua) \n\n \n\nscatter(wob_new,rop_new,'^b') \nfplot(f1,[wobtemp(1)-range(wobtemp)/2 wobtemp(end)+range(wobtemp)/2],'--\n\nk') \npl1 = plot(f1,'-k',wobtemp,roptemp,'ok'); \nscatter(-f1.p2/(2*f1.p1),feval(f1,-f1.p2/(2*f1.p1)),100,'xk') \nset(pl1,'Markersize',10,'DisplayName',['Curva original (R^{2} = ' \n\nnum2str(gof1.rsquare) ')' 10 ... \n    'Probabilidade da posi\u00e7\u00e3o do WOB ideal (em rela\u00e7\u00e3o ao founder \n\npoint):' 10 ... \n    '<10%: ' num2str(curveprob(1)*100) '%,&lt;20%: ' \n\nnum2str(curveprob(2)*100) '%,&lt;30%: ' num2str(curveprob(3)*100) '%']) \nlegend(pl1(2),'Location','Northeast') \naxis([ax.XLim ax.YLim]) %define os mesmos eixos que a curva original \n\n%% Fun\u00e7\u00e3o checkcurve utilizada na rotina descrita no quadro 4 \n\n \n\nfunction sf = checkcurve(comb, mlog, n, wob, rop) \n\n  \nload tableme %carrega as tabelas de confian\u00e7a \nwob_weighted = []; \nrop_weighted = []; \nfor j=1:length(comb) \n    mlog(comb(j)) = 1; %identifica quais dados ser\u00e3o utilizados \nend \nif sum(mlog) > 12 %limita curvas com mais de 12 pontos \u00e0s tabelas de 12 \n\npontos \n    sheet = 10; \nelse \n    sheet = sum(mlog)-2; \nend \nsmallpoint = n.*mlog; %tamanho amostral de cada ponto \nsmallpoint = min(smallpoint(smallpoint~=0)); %menor tamanho amostral \n% Define a margem de erro de acordo com o menor tamanho amostral \n\nif smallpoint &lt;44 \n    if smallpoint &lt;18 \n        if smallpoint &lt;10 \n            if smallpoint &lt;7 \n                 if smallpoint &lt;5 \n                     if smallpoint &lt;4 \n                         if smallpoint &lt;3 \n                             marginerror = 2; \n                         else \n                             marginerror = 1.4; \n                         end \n                     else \n                         marginerror = 1.2; \n                     end \n                 else \n\n\n\n57 \n \n\n \n\nQuadro 5 - C\u00f3digo fonte de rotina auxiliar no MATLAB, desenvolvido como fun\u00e7\u00e3o checkcurve, para \n\ndeterminar a confiabilidade das curvas de drill-rate utilizando as tabelas de probabilidade \n\n(conclus\u00e3o) \n\n \nFonte: Produ\u00e7\u00e3o do pr\u00f3prio autor \n \n\n                     marginerror = 1; \n                 end \n            else \n                marginerror = 0.8; \n            end \n        else \n            marginerror = 0.6; \n        end \n    else \n        marginerror = 0.4; \n    end \nelse \n    marginerror = 0.2; \nend \nn = n.*mlog; \nn = n(n~=0); \nwob = wob.*mlog; \nwob = wob(wob~=0); \nrop = rop.*mlog; \nrop = rop(rop~=0); \nfor j=1:length(n) %gera dados ponderados \n    wob_weighted = [wob_weighted; repmat(wob(j),n(j),1)]; \n    rop_weighted = [rop_weighted; repmat(rop(j),n(j),1)]; \nend \nf1 = fit(wob_weighted,rop_weighted,'poly2'); %aproxima\u00e7\u00e3o para uma \n\nfun\u00e7\u00e3o quadr\u00e1tica \nx_v = -f1.p2/(2*f1.p1); %componente horizontal do v\u00e9rtice da par\u00e1bola \nif f1.p1 > 0 || x_v &lt;min(wob) || x_v > max(wob) \n    sf = []; \n    return \nend \ny_max = feval(f1,x_v); %maior valor de y descrito pela curva \ny_min = min([feval(f1,min(wob_weighted)) feval(f1,max(wob_weighted))]); \n\n%menor valor de y descrito pela curva, dentro do intervalo de WOB \nrnge = ceil((y_max - y_min)/0.5)*0.5; %range arredondado para cima, \n\nm\u00faltiplo de 0.5 \nif rnge > 0 %se a par\u00e1bola tiver concavidade para baixo \n    mytable = ['tableme' strrep(sprintf('%.1f',marginerror),'.','_')]; \n    mytable = eval(mytable); \n    prob = [mytable(mytable(:,1,sheet)==rnge,2,sheet); \n\nmytable(mytable(:,1,sheet)==rnge,3,sheet); \n\nmytable(mytable(:,1,sheet)==rnge,4,sheet)]; \n    if isempty(prob) == 1 %se range for maior que o valor m\u00e1ximo \n\ndescrito pela tabela \n        prob = [mytable(end,2,sheet); mytable(end,3,sheet); \n\nmytable(end,4,sheet)]; \n    end \n    sf = [prob; marginerror; rnge; sum(mlog); mlog]; %grava os valores \n\nde confiabilidade, varia\u00e7\u00e3o percentual de WOB, ponto de menor tamanho \n\namostral e matriz maxlog \nelse \n    sf = []; \nend"}]}}}