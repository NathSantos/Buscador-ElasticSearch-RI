{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.16450"}, {"@name": "filename", "#text": "23089_RicardoCesareRomanAmigoCorr18.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "Ricardo Cesare Roman Amigo\n\nDesign of Adsorption Systems\nby Topology Optimisation\n\nSa?o Paulo\n2018\n\n\n\nRicardo Cesare Roman Amigo\n\nDesign of Adsorption Systems\nby Topology Optimisation\n\nSubmitted to the Escola Polite?cnica of\n\nthe Universidade de Sa?o Paulo in partial\n\nfulfilment of the requirements for the degree\n\nof Doutor em Cie?ncias.\n\nA?rea de Concentrac?a?o:\n\nControl and Mechanical Automation\n\nEngineering\n\nOrientador:\n\nProf. Dr. Emilio Carlos Nelli Silva\n\nCo-orientador:\n\nDr. Robert William Hewson\n\nSa?o Paulo\n2018\n\n\n\n Autorizo a reprodu\u00e7\u00e3o e divulga\u00e7\u00e3o total ou parcial deste trabalho, por qualquer meio\nconvencional ou eletr\u00f4nico, para fins de estudo e pesquisa, desde que citada a fonte.\n\nEste exemplar foi revisado e corrigido em rela\u00e7\u00e3o \u00e0 vers\u00e3o original, sob \nresponsabilidade \u00fanica do autor e com a anu\u00eancia de seu orientador.\n\nS\u00e3o Paulo, ______ de ____________________ de __________\n\nAssinatura do autor:         ________________________ \n\nAssinatura do orientador:  ________________________ \n\nCataloga\u00e7\u00e3o-na-publica\u00e7\u00e3o\n\nAmigo, Ricardo Cesare Roman\n        Projeto de Sistemas de Adsor\u00e7\u00e3o por Otimiza\u00e7\u00e3o Topol\u00f3gica / R. C. R.\nAmigo -- vers\u00e3o corr. -- S\u00e3o Paulo, 2018.\n        118 p. \n\n        Tese (Doutorado) - Escola Polit\u00e9cnica da Universidade de S\u00e3o Paulo.\nDepartamento de Engenharia Mecatr\u00f4nica e de Sistemas Mec\u00e2nicos.\n\n        1.Topologia (Otimiza\u00e7\u00e3o) 2.M\u00e9todo dos Elementos Finitos 3.Adsor\u00e7\u00e3o\n4.Combust\u00edveis Gasosos I.Universidade de S\u00e3o Paulo. Escola Polit\u00e9cnica.\nDepartamento de Engenharia Mecatr\u00f4nica e de Sistemas Mec\u00e2nicos II.t.\n\n\n\nAo meu pai.\n\n\n\nAcknowledgments\n\nI would like to thank my supervisors Dr. Rob Hewson and Prof. Emilio Silva for their\nhelp and guidance over the past years. I would also like to thank Dr. Jose? Paiva for his\nimportant contributions to this work.\n\nIn addition, I gratefully acknowledge the support of the RCGI Research Centre for\nGas Innovation, sponsored by FAPESP (2014/50279-4) and Shell, and CNPq (National\nCouncil for Research and Development), under grants 140664/2013-0 and 200404/2014-8.\n\nI would like to thank my research friends at USP and at Imperial for their essential and\nintangible contribution to this doctorate, especially on the non-academic side. Naturally,\nI must extend my thanks to London and all the great people I have met there for some\nof the best days of my life.\n\nFinalmente, agradec?o a? minha nonna, a? minha ma?e, a?s minhas irma?s Carolina e\nCristina, e ao meu cachorra?o Kepler, pelo essencial apoio que me deram a? dista?ncia\ndurante este trabalho.\n\n\n\nResumo\n\nAdsorc?a?o e? um mecanismo de retenc?ao de mole?culas de um fluido em superf??cies\nsolidas e apresenta um vasto campo de aplicac?o?es, como em refrigerac?a?o, processos de\nseparac?a?o e armazenamento de combust??vel. Este trabalho descreve o modelo de adsorc?a?o\nde ga?s em meios porosos e define uma abordagem de otimizac?a?o de sistemas de adsorc?a?o\nbaseada no Me?todo de Otimizac?a?o Topolo?gica (MOT). Uma formulac?a?o abrangente para\nos feno?menos de adsorc?a?o e dessorc?a?o e? apresentada, detalhando a deduc?a?o de seus formas\nfracas e montagem das matrizes para a implementac?a?o do Me?todo dos Elementos Finitos\n(MEF). As sensibilidades das func?o?es-objetivo em relac?a?o a?s variaveis de projeto sa?o\nobtidas pelo me?todo adjunto, que tambe?m e? apresentado em detalhe. A implementac?a?o\nnumerica e? auxiliada pelos pacotes FEniCS e Dolfin Adjoint, originando uma ferramenta\ngene?rica para a otimizac?a?o de sistemas de adsorc?a?o. Este me?todo e? aplicado ao projeto de\ntanques de Gas Natural Adsorvido (GNA) visando transporte, armazenamento e consumo.\nTanques otimizados sa?o propostos e comparados com tanques tradicionais, apresentando\nmelhora dos objetivos de projeto.\n\nPalavras-Chave \u2013 Topologia (Otimizac?a?o), Me?todo dos Elementos Finitos, Adsorc?a?o.\n\n\n\nAbstract\n\nAdsorption is a retention mechanism of fluid molecules on solid surfaces and presents\na wide range of applications, such as refrigeration, separation processes and fuel storage.\nThis work describes the modelling of gas adsorption on porous media and presents an op-\ntimisation approach for the design of adsorption systems based on topology optimisation.\nA comprehensive formulation for the adsorption and desorption phenomena is presented,\ndetailing the derivation of their weak forms and assembling the matrices for the imple-\nmentation of the Finite Element Method (FEM). The sensitivities of objective functions\nto topology optimisation design variables are obtained by the adjoint method, which is\npresented in detail. The numerical implementation is aided by FEniCS and Dolfin Adjoint\npackages, resulting in a generic software for the optimisation of adsorption systems. The\nmethod is applied for the design of Adsorbed Natural Gas (ANG) tanks for on-demand\nconsumption. Optimised tank layouts are proposed and compared with standard tanks,\npresenting improvement of the design objectives.\n\nKeywords \u2013 Topology Optimisation, Finite Elements Method, Adsorption.\n\n\n\nList of Figures\n\n1.1 Distribution of molecules in gaseous (?) and adsorbed (\u2022) phases. . . . . . 2\n\n1.2 Adsorption cooling process. . . . . . . . . . . . . . . . . . . . . . . . . . . 3\n\n1.3 Topology optimisation procedure. . . . . . . . . . . . . . . . . . . . . . . . 10\n\n2.1 Continuum modelling of porous media based on Representative Elementary\n\nVolume (REV). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n\n2.2 Adsorption and desorption processes. . . . . . . . . . . . . . . . . . . . . . 14\n\n2.3 Adsorption energetics. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15\n\n2.4 Classes of isotherms. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16\n\n2.5 Adsorption domain. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19\n\n2.6 Inlet pressure (P?L) during (a) adsorption and (b) desorption cycles. . . . . 23\n\n3.1 Optimisation of ANG tanks through the addition of non-adsorbent materials. 29\n\n3.2 Isomassic curves given by the variation of adsorbent temperature and rel-\n\native non-adsorbent volume in adsorption cycle. . . . . . . . . . . . . . . . 30\n\n3.3 Cycle considered for the optimisation of ANG tanks applied to on-demand\n\nconsumption. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31\n\n3.4 SIMP for Steel and Carbon properties. . . . . . . . . . . . . . . . . . . . . 34\n\n3.5 Borrvall\u2019s material model for Steel and Carbon Permeability (K). . . . . . 35\n\n3.6 Hyperbolic tangent material model for Steel and Carbon properties with\n\nec = 0.5. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37\n\n3.7 Material model for properties A and B. . . . . . . . . . . . . . . . . . . . . 38\n\n4.1 Custom axisymmetric tank domain (SAHOO et al., 2011). . . . . . . . . . 47\n\n4.2 Flow rate of 1 L min?1: Comparison with the experimental results in (SA-\n\nHOO et al., 2011). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47\n\n4.3 Flow rate of 10 L min?1: Comparison with the experimental results in (SA-\n\nHOO et al., 2011). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48\n\n\n\n4.4 Flow rate of 30 L min?1: Comparison with the experimental results in (SA-\n\nHOO et al., 2011). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48\n\n4.5 Temperature distribution at the end of the adsorption cycle. . . . . . . . . 49\n\n4.6 Adsorption domain adopted for verifying the sensitivity of adsorption cycles\n\nto the smoothness factor ?. . . . . . . . . . . . . . . . . . . . . . . . . . . 50\n\n4.7 Total mass of gas along the adsorption cycle for different smoothness factors. 50\n\n4.8 Smoothness factor convergence. . . . . . . . . . . . . . . . . . . . . . . . . 51\n\n4.9 Adsorption domain constituted by Activated Carbon and Steel. . . . . . . 51\n\n4.10 Pressure distribution on Carbon-Steel domain. . . . . . . . . . . . . . . . . 52\n\n4.11 Adsorption domain adopted for verifying mesh and timestep convergence. . 53\n\n4.12 Mesh convergence. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53\n\n4.13 Timestep convergence. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54\n\n4.14 Methods for obtaining the adjoint code (FUNKE, 2012). . . . . . . . . . . 55\n\n4.15 Optimisation activity diagram. . . . . . . . . . . . . . . . . . . . . . . . . . 57\n\n4.16 Original (top) and Perturbed Pseudo-Porosity fields for (from the top)\n\nh = 1.00 \u00d7 10?3, h = 5.00 \u00d7 10?4, h = 2.50 \u00d7 10?5, h = 1.25 \u00d7 10?5,\nh = 6.25 \u00d7 10?6. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58\n\n5.1 Pseudo-porosity fields evolution (top-down) for SIMP (left), non-offset hy-\n\nperbolic tangents (centre) and offset hyperbolic tangents (right) material\n\nmodels for prismatic tank optimisation. . . . . . . . . . . . . . . . . . . . . 66\n\n5.2 Functional convergence for different material models. . . . . . . . . . . . . 67\n\n5.3 Pseudo-porosity fields evolution for homogeneous (left) and arbitrary (right)\n\ninitial guesses for prismatic tank optimisation starting with pini = 1. . . . . 69\n\n5.4 Pseudo-porosity fields evolution for homogeneous (top image on each block)\n\nand arbitrary (bottom) initial guesses for cylindrical tank optimisation\n\nstarting with pini = 20. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71\n\n5.5 Pseudo-porosity fields evolution for homogeneous (top image on each block)\n\nand arbitrary (bottom) initial guesses for cylindrical tank optimisation\n\nstarting with pini = 1. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72\n\n\n\n5.6 Optimised design for a cylindrical domain subjected to natural convection. 75\n\n5.7 Optimised design for a cylindrical domain with non-adsorbent material\n\nwith high thermal conductivity. . . . . . . . . . . . . . . . . . . . . . . . . 77\n\n5.8 Optimised design for a cylindrical domain with non-adsorbent material\n\nwith high heat capacity. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80\n\n5.9 Optimised design for a cylindrical domain with non-adsorbent material\n\nwith high heat capacity in 3600 s filling cycle. . . . . . . . . . . . . . . . . 81\n\n5.10 Optimised design for a cylindrical domain with non-adsorbent material\n\nwith high heat capacity in 1200 s filling cycle. . . . . . . . . . . . . . . . . 83\n\n5.11 Optimised design for a prismatic domain subjected to forced convection. . 85\n\n5.12 Optimised design for a custom axisymmetric domain subjected to forced\n\nconvection with h = 100 Wm?2K?1. . . . . . . . . . . . . . . . . . . . . . . 88\n\n5.13 Optimised design for a custom axisymmetric domain subjected to forced\n\nconvection with h = 700 Wm?2K?1. . . . . . . . . . . . . . . . . . . . . . . 89\n\n5.14 Optimised design for a cylindrical domain with forced convection. . . . . . 91\n\n5.15 Optimised design for a cylindrical domain with forced convection in 10 800 s\n\nfilling cycle. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93\n\n5.16 Optimised design for a cylindrical domain with forced convection in 3600 s\n\nfilling cycle. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95\n\n5.17 Optimised design for a cylindrical domain with natural convection and cold\n\nfinger. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96\n\n5.18 Optimised design for a small prismatic domain subjected to forced convection. 99\n\n5.19 Optimised design for a large prismatic domain subjected to forced convection.100\n\n5.20 Optimised design for a custom axisymmetric domain subjected to 3 MPa\n\nfilling pressure and forced convection with h = 100 Wm?2K?1. . . . . . . . 102\n\n5.21 Optimised design for a custom axisymmetric domain subjected to 5 MPa\n\nfilling pressure and forced convection with h = 100 Wm?2K?1. . . . . . . . 103\n\n\n\nList of Tables\n\n4.1 Taylor Remainder Convergence. . . . . . . . . . . . . . . . . . . . . . . . . 59\n\n5.1 Standard domain and cycle for prismatic tanks. . . . . . . . . . . . . . . . 61\n\n5.2 Standard domain and cycle for cylindrical tanks. . . . . . . . . . . . . . . . 62\n\n5.3 Standard domain and cycle for a custom axisymmetric tank. . . . . . . . . 63\n\n5.4 Optimisation definitions for a prismatic tank subjected to forced convection. 65\n\n5.5 Optimisation definitions for a prismatic tank subjected to forced convection. 68\n\n5.6 Optimisation definitions for a cylindrical domain with non-adsorbent ma-\n\nterial with high heat capacity. . . . . . . . . . . . . . . . . . . . . . . . . . 70\n\n5.7 Optimisation definitions for a cylindrical domain subjected to natural con-\n\nvection. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74\n\n5.8 Optimisation definitions for a cylindrical domain with non-adsorbent ma-\n\nterial with high thermal conductivity. . . . . . . . . . . . . . . . . . . . . . 76\n\n5.9 Optimisation definitions for a cylindrical domain with non-adsorbent ma-\n\nterial with high heat capacity. . . . . . . . . . . . . . . . . . . . . . . . . . 79\n\n5.10 Optimisation definitions for a cylindrical domain with non-adsorbent ma-\n\nterial with high heat capacity in 3600 s filling cycle. . . . . . . . . . . . . . 79\n\n5.11 Optimisation definitions for a cylindrical domain with non-adsorbent ma-\n\nterial with high heat capacity in 1200 s filling cycle. . . . . . . . . . . . . . 82\n\n5.12 Optimisation definitions for a prismatic domain subjected to forced con-\n\nvection. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84\n\n5.13 Optimisation definitions for a custom axisymmetric domain subjected to\n\nforced convection with h = 100 Wm?2K?1. . . . . . . . . . . . . . . . . . . 87\n\n5.14 Optimisation definitions for a custom axisymmetric domain subjected to\n\nforced convection with h = 700 Wm?2K?1. . . . . . . . . . . . . . . . . . . 87\n\n5.15 Optimisation definitions for a custom axisymmetric domain subjected to\n\nnatural convection and connected to a cold finger. . . . . . . . . . . . . . . 90\n\n\n\n5.16 Optimisation definitions for a cylindrical domain with forced convection in\n\n10 800 s filling cycle. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92\n\n5.17 Optimisation definitions for a cylindrical domain with forced convection in\n\n3600 s filling cycle. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 94\n\n5.18 Optimisation definitions for a cylindrical domain subjected to natural con-\n\nvection and connected to a cold finger. . . . . . . . . . . . . . . . . . . . . 94\n\n5.19 Optimisation definitions for a small prismatic domain subjected to forced\n\nconvection. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98\n\n5.20 Optimisation definitions for a small prismatic domain subjected to forced\n\nconvection. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98\n\n5.21 Optimisation definitions for a custom axisymmetric domain subjected to\n\n3.00 MPa filling pressure and forced convection with h = 100 Wm?2K?1. . . 101\n\n5.22 Optimisation definitions for a custom axisymmetric domain subjected to\n\n5.00 MPa filling pressure and forced convection with h = 100 Wm?2K?1. . . 101\n\nB.1 Methane properties (SAHOO et al., 2011; SAHOO; RAMGOPAL, 2014). . 117\n\nB.2 Activated Carbon properties (SAHOO et al., 2011). . . . . . . . . . . . . . 117\n\nB.3 Adsorption parameters for Methane on Activated Carbon (SAHOO et al.,\n\n2011; SAHOO; RAMGOPAL, 2014). . . . . . . . . . . . . . . . . . . . . . 118\n\nB.4 Steel properties. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118\n\n\n\nAcronyms\n\nANG Adsorbed Natural Gas\nCCS CO2 Capture and Storage\nCNG Compressed Natural Gas\nDA Dubinin-Astakhov\nDR Dubinin-Radushevich\nECP Element Connectivity Parametrisation\nESO Evolutionary Structural Optimisation\nETM Electro-Thermo-Mechanical Actuator\nFEM Finite Element Method\nFFC FEniCS Form Compiler\nFFD Free-Form Deformation\nFIAT FEniCS Finite Element Automatic Tabulator\nFVM Finite Volume Method\nGITT Generalised Integral Transform Technique\nGWP Global Warming Potential\nL-BFGS-B Limited Memory Broyden-Fletcher-Goldfarb-Shanno with Box Constraints\nLDF Linear Driving Force Model\nLNG Liquefied Natural Gas\nMOF Metal-Organic Framework\nODE Ordinary Differential Equation\nOHT Offset Hyperbolic Tangents Material Model\nPCM Phase Change Material\nPDE Partial Differential Equation\nPLIC Piecewise Linear Interface Calculation\nPSA Pressure Swing Adsorption\nRBF Radial Basis Function\nREV Representative Elementary Volume\nSIMP Solid Isotropic Material with Penalisation\nTSA Temperature Swing Adsorption\nUFC FEniCS Unified Form-Assembly Code\nVoF Volume of Fluid\n\n\n\nNotation\n\nA Polanyi\u2019s adsorption potential\nC Solute concentration\nCpg Specific heat capacity of gaseous phase\nCps Specific heat capacity of solid phase\nD Intra-particle diffusional time constant\nD Adsorption kinetics weak form\nD0 Diffusivity of gaseous phase\ne Pseudo-porosity\ne| Non-filtered pseudo-porosity\nE Energy balance weak form\nE0 Characteristic energy of adsorption\nEa Activation energy of adsorption\nEd Activation energy of desorption\nG Kinetic coefficient of adsorption and desorption reactions\nhW Heat convection coefficient on external walls\nitmax Maximum iterations per continuation step\n?H Isosteric heat of adsorption\nJ Functional of interest\nka Kinetic coefficient of adsorption\nkd Kinetic coefficient of desorption\nkf Thermal conductivity of phases combined\nkg Thermal conductivity of gaseous phase\nkintra Intra-particle diffusion rate constant\nks Thermal conductivity of solid phase\nKs Permeability of the solid phase\nM Continuity weak form\nm?let Mass flow\nMg Molecular mass of gaseous phase\nns Micro-pores dispersion\np Material model penalisation\nP Pressure\nP Generic material property\nPatm Atmospheric pressure\nPcr Critical pressure\nPlet Pressure at inlet/outlet regions\nPsat Saturated pressure\nq Concentration of adsorbed phase\nQ Density of adsorbed phase\nqeq Equilibrium concentration of adsorbed phase\nQeq Equilibrium density of adsorbed phase\nr Radial coordinate in axisymmetric domains\nRg Universal gas constant\nT Temperature\n\n\n\nTatm Atmospheric temperature\nTlet Temperature at inlet/outlet regions\nTboil Temperature of gaseous phase at boiling point\nTcr Critical temperature\nug Specific internal energy of gaseous phase\nuq Specific internal energy of adsorbed phase\nus Specific internal energy of solid phase\nvg Velocity of gaseous phase\nV Volume\nw State variable\nws Specific volume of micro-pores\nWs Volume ratio of micro-pores\nz Design variable filtering radius\n\u00f8s Characteristic particle diameter of the solid phase\n?e Mean value of the thermal expansion of liquefied gases\n? Affinity coefficient of adsorbent-adsorbate pair\n?D Domain regions subjected to Dirichlet boundary conditions\n?F Domain regions subjected to fixed temperature\n?L Domain regions subjected to inlet/outlet of gases\n?N Domain regions subjected to Robin boundary conditions\n?W Domain walls\n?m Micro-porosity\n?M Macro-porosity\n?t Total porosity\n? Adjoint variable\n\u00b5g Viscosity of the gaseous phase\n? Continuous shape function for adsorbed gas and pseudo-porosity fields\n? Shape function matrix for adsorbed gas and pseudo-porosity fields\n?adg Local density of adsorbed phase\n?boil Density of gaseous phase at boiling point\n?f Density of phases combined\n?g Density of gaseous phase\n?s Density of bulk solid phase\n? Smoothness factor\n? g Viscous stress tensor\n?s Pores tortuosity\n? Continuous shape function for pressure field\n? Shape function matrix for pressure field\n? Continuous shape function for temperature field\n? Shape function matrix for temperature field\n?min Optimisation tolerance\n\n\n\nContents\n\n1 Introduction 1\n\n1.1 Concept and Applications of the Adsorption Phenomenon . . . . . . . . . 1\n\n1.2 Adsorbed Natural Gas Tanks . . . . . . . . . . . . . . . . . . . . . . . . . 4\n\n1.2.1 Design Approaches . . . . . . . . . . . . . . . . . . . . . . . . . . . 5\n\n1.2.2 Numerical Modelling . . . . . . . . . . . . . . . . . . . . . . . . . . 6\n\n1.3 Optimisation Methods applied to Fluids and Heat Transfer Problems . . . 7\n\n1.4 Motivation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10\n\n1.5 Objectives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11\n\n1.6 Scientific Contributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11\n\n1.7 Thesis Outline . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11\n\n2 Modelling of Adsorption Systems 12\n\n2.1 Modelling Flow in Porous Media . . . . . . . . . . . . . . . . . . . . . . . . 12\n\n2.2 Modelling Adsorption Equilibrium and Kinetics . . . . . . . . . . . . . . . 14\n\n2.3 Governing Equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18\n\n2.3.1 Natural Material Models . . . . . . . . . . . . . . . . . . . . . . . . 20\n\n2.3.2 Adsorption and Desorption Kinetics . . . . . . . . . . . . . . . . . . 20\n\n2.3.3 Continuity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22\n\n2.3.4 Energy Balance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23\n\n2.4 Weak Formulation of Adsorption Systems . . . . . . . . . . . . . . . . . . 25\n\n3 Optimisation of ANG Tanks 28\n\n3.1 Design Concept . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28\n\n3.2 Manufacturing Considerations . . . . . . . . . . . . . . . . . . . . . . . . . 29\n\n\n\n3.3 Objective Function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31\n\n3.4 Material Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32\n\n3.4.1 Material Models with Penalisation . . . . . . . . . . . . . . . . . . 32\n\n3.4.2 Offset Hyperbolic Tangents (OHT) Material Model . . . . . . . . . 33\n\n4 Numerical Implementation and Verification 39\n\n4.1 Discrete Adsorption Problem . . . . . . . . . . . . . . . . . . . . . . . . . 39\n\n4.2 Discrete Adjoint System for the Adsorption Problem . . . . . . . . . . . . 41\n\n4.3 Adsorption Problem Implementation . . . . . . . . . . . . . . . . . . . . . 45\n\n4.3.1 System Decoupling Verification . . . . . . . . . . . . . . . . . . . . 45\n\n4.3.2 Pressure Loading Verification . . . . . . . . . . . . . . . . . . . . . 47\n\n4.3.3 Impermeability Verification . . . . . . . . . . . . . . . . . . . . . . 49\n\n4.3.4 Mesh and Timestep Convergence . . . . . . . . . . . . . . . . . . . 52\n\n4.4 Topology Optimisation Implementation . . . . . . . . . . . . . . . . . . . . 53\n\n4.4.1 Design Variables Filtering . . . . . . . . . . . . . . . . . . . . . . . 54\n\n4.4.2 Optimisation Algorithm . . . . . . . . . . . . . . . . . . . . . . . . 56\n\n4.4.3 Adjoint Sensitivites Verification . . . . . . . . . . . . . . . . . . . . 57\n\n5 Results and Discussion 60\n\n5.1 Definition of Standard Domains and Cycles for the Design of ANG Tanks . 60\n\n5.2 Evaluation of the OHT Material Model for the Design of ANG Tanks . . . 64\n\n5.2.1 OHT vs. Traditional Material Models . . . . . . . . . . . . . . . . . 64\n\n5.2.2 Dependency on the Initial Guess and Penalisation . . . . . . . . . . 68\n\n5.3 Design of ANG Tanks with Passive Thermal Management . . . . . . . . . 70\n\n5.3.1 Tanks Subjected to Natural Convection . . . . . . . . . . . . . . . . 73\n\n5.3.2 Sensitivity to Thermal Conductivity . . . . . . . . . . . . . . . . . 76\n\n5.3.3 Sensitivity to Heat Capacity . . . . . . . . . . . . . . . . . . . . . . 78\n\n5.4 Design of ANG Tanks with Active Thermal Management . . . . . . . . . . 84\n\n\n\n5.4.1 Tanks Subjected to Forced Convection . . . . . . . . . . . . . . . . 84\n\n5.4.2 Sensitivity to Forced Convection and Cold Walls . . . . . . . . . . . 86\n\n5.4.3 Sensitivity to Shape Complexity . . . . . . . . . . . . . . . . . . . . 92\n\n5.4.4 Sensitivity to Tank Dimensions . . . . . . . . . . . . . . . . . . . . 97\n\n5.4.5 Sensitivity to Filling Pressure . . . . . . . . . . . . . . . . . . . . . 97\n\n6 Conclusions 104\n\nReferences 107\n\nAppendix A \u2013 Finite Element Coefficients 113\n\nA.1 Full Adsorption Problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113\n\nA.2 Adsorption Problem after Decoupling the Adsorbed Density Field . . . . . 114\n\nA.3 Adsorption Problem after Decoupling the Pressure Field . . . . . . . . . . 115\n\nA.4 Helmholtz Filtering . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116\n\nAppendix B \u2013 Material Properties 117\n\n\n\n1\n\n1 Introduction\n\nIn this Chapter, basic concepts of the adsorption phenomenon are introduced along\n\nwith some applications, emphasizing Adsorbed Natural Gas (ANG) tanks. Thereafter,\n\na brief review on optimisation methods applied to fluids and heat transfer problems is\n\npresented. Finally, the motivation, objectives and expected scientific contributions are\n\nstated, based on the lack of previous works approaching the design of adsorption systems\n\nby topology optimisation.\n\n1.1 Concept and Applications of the Adsorption Phe-\n\nnomenon\n\nThe flow of gases or liquids in porous media are subjected to the retention and release\n\nof molecules on the solid phase. One of the retention mechanisms is the sorption phe-\n\nnomenon, which is a general term adopted for both adsorption and absorption reactions.\n\nThe former is a surface reaction in which gas molecules accumulate on the surface of solid\n\nparticles attracted by disrupted bonds (MOTA et al., 2004), while the latter is a bulk\n\nphenomenon, in which gas molecules diffuse through another phase, accumulating at the\n\ngrain boundaries and often forming a new phase (BLANCO et al., 2014).\n\nAdsorption is divided into two categories: (i) physical adsorption, based on weak van\n\nder Waals forces, which is also know as physisorption, and (ii) chemical adsorption, based\n\non covalent bondings, also know as chemisorption. While the former is easily reversible\n\nand leaves the adsorbent intact, the latter involves a chemical reaction that affect the\n\nsurfaces, as is the case of corrosion phenomenon. Figure 1.1 illustrates the mechanism of\n\nadsorption, where molecules concentrate on micro-pores walls.\n\nThe capacity of adsorption of porous media is dependent on characteristics such as the\n\ndistribution and characteristic of micro-pores on the adsorbent, the affinity of adsorbent\n\n\n\n2\n\nFigure 1.1: Distribution of molecules in gaseous (?) and adsorbed (\u2022) phases.\n\nand adsorbate, gas pressure and temperature (BILOE et al., 2002). Considering a given\n\npair adsorbent-adsorbate, the capacity of adsorption increases as pressure increases and\n\ntemperature decreases.\n\nSeveral engineering applications are based on the adsorption process. For instance,\n\nit is widely employed for fluid separation, both for removing trace contaminants, which\n\nis known as purification processes, and for recovering components from a mixture, which\n\nis known as a bulk separation processes. Examples of purification are the separation of\n\nsulphurous compounds from natural gas, solvents from air and SO2 from vent streams\n\n(CAVALCANTE, 2000). Among bulk separations, the following pairs can be encountered:\n\nN2-O2, Water-Ethanol and Fructose-Glucose (CAVALCANTE, 2000).\n\nThe operation of adsorption separation processes can be undertaken as a batch pro-\n\ncess, by percolating fluid through the adsorbent until saturation and then purging it. The\n\npurge, also known as adsorbent regeneration, is usually undertaken by varying the tem-\n\nperature, which is termed Temperature Swing Adsorption (TSA), or by controlling the\n\npressure, in a method called Pressure Swing Adsorption (PSA), or by purging the adsor-\n\nbent with an inert desorbate, which could be easily separated by later processes, such as\n\ndistillation. It is possible to have an adsorption separation in a continuous counter-current\n\napproach, by submitting adsorbents to adsorption and desorption at the same time, and\n\nalso in a chromatographic way, which is based on the moving bed concept where the fluid\n\nflows in the opposite direction to the solid phase (CHARTON; NICOUD, 1995).\n\nAdsorption can also be used for refrigeration, by using use solid adsorbents such\n\nas silica-gel and zeolite, to produce the cooling effect (WANG; VINEYARD, 2011). In\n\nthis class of refrigerators, an adsorbent is dried out by applying heat, which increases\n\nits pressure and temperature and causes the desorption of refrigerant vapour. This step\n\nis equivalent to the compression step in compressor refrigerators. The vapour is then\n\n\n\n3\n\nliquefied in the condenser, while heat is rejected to a cooling tower. When the adsorbent\n\nis sufficiently dried out, the heat intake stops and heat dissipation takes place. Next, the\n\nadsorbent connection switches from the condenser to the evaporator, where the saturated\n\nliquid boils, vapour is adsorbed and chilled water is generated, which is used for air-\n\nconditioning. Given that this cycle is intermittent, continuous cooling output is achieved\n\nby associating two adsorbents driven anti-cyclically, as illustrated by Figure 1.2.\n\nFigure 1.2: Adsorption cooling process (SOLARNEXT, 2009).\n\nAdsorption systems present low electrical energy consumption in comparison to other\n\nrefrigeration methods and can be activated by temperatures as low as 323 K, while ab-\n\nsorption systems require at least 363 K (WANG; VINEYARD, 2011). This opens up the\n\npossibility of using low-grade heat such that derived from solar energy. The refrigerants\n\nused in adsorption cycles have zero ozone depletion potential and low Global Warming Po-\n\ntential (GWP), which is an index dependent on the strength with which certain greenhouse\n\ngas absorbs infrared radiation, on the spectral location of its absorbing wavelengths and\n\non its atmospheric lifetime (ELROD, 1999). They can also operate in environments with\n\nsignificant vibrations, since the adsorbent is solid (in contrast with the liquid used in ab-\n\nsorbent refrigerators) and the systems have fewer mechanical parts. The main drawbacks\n\nof adsorbent refrigerators are their low coefficient of performance (quantity of achieved\n\ncooling effect per unit of heat delivered), intermittent operation (when not associated in\n\ntwo or more generators) and their large size and weight (WOLAK; KRASZEWSKI, 2016).\n\nAdsorption is also promising in CO2 Capture and Storage (CCS). The greenhouse\n\n\n\n4\n\neffect is drawing more and more attention from researchers worldwide. Although carbon\n\ndioxide naturally exists in the atmosphere, it is one of the greenhouse gases and its\n\nconcentrations have increased due to human actions, such as burning fuels. In fact,\n\naccording to Toledo et al. (2013), by the year 2100, CCS will be responsible for 15%\n\nto 55% of greenhouse gases reduction. One of the proposed methods for CCS consists\n\nin the capture of CO2 in installations where it can be placed for long-term storage in\n\nthe earth crust. However, the pressure rise due to CO2 injection is a major concern\n\nregarding this technology. Finding a safe and effective method that can be feasible in\n\nindustrial scale at competitive costs is the challenge regarding this topic. When it comes\n\nto CO2 capture, several solid adsorbents such as alumina, silicates, silica, silica-alumina,\n\nactivated carbon, zeolites and also MOFs (Metal-Organic Frameworks) are known to be\n\ncapable of adsorbing CO2. Aspects such as gas impurity (CO2 mixed with other gases)\n\n(WETENHALL et al., 2014) and thermal behaviour hinders the operation of such systems\n\nand must be addressed during design process. These studies show not only adsorption\n\nsystems can handle CCS but also they can be enhanced by adjusting characteristics of\n\ntheir geometry and composition. Optimizing such systems may bring more possibilities\n\nand capabilities for the CCS via adsorption.\n\nFuel storage also present a prolific area of application for adsorption. Given the low\n\ndensity of gas fuel, it is usual to store them in high-pressure or low-temperature vessels.\n\nIn the case of natural gas storage, Compressed Natural Gas (CNG) is ordinarily stored\n\nat 200 atm, offering a capacity of 245 V/V, which means a density 245 higher than at\n\natmospheric temperature and pressure. In turn, Liquefied Natural Gas (LNG) requires\n\ncryogenic temperatures to force gas condensation, which happens, for methane, at around\n\n113 K and provides a storage capacity of 600 V/V (HIRATA et al., 2009). On the other\n\nhand, Adsorbed Natural Gas (ANG) tanks consist of natural gas adsorbed in a solid matrix\n\nof coal, accumulated in its pores. Due to the relatively high density of the adsorbed phase,\n\nan overall storage capacity around 164 V/V can be achieved at room temperature with\n\npressure ranging from 35 atm to 50 atm (HIRATA et al., 2009). These characteristics\n\nplace ANG vessels as a promising method to maintain gas confinement, as it works at\n\natmospheric temperature and much lower pressure then CNG.\n\n1.2 Adsorbed Natural Gas Tanks\n\nThe ease of storing gas by the ANG method allows the expansion of the current\n\napplications of natural gas, both for just-in-time consumption and for long-term storage.\n\n\n\n5\n\nThe possibility of storing gas at lower pressure enables the adoption of wrappers made of\n\nlighter materials and with complex shapes, which would be prohibitive in high-pressure\n\ntanks due to stress concentration. The concept of box-shaped vessel for LNG storage\n\n(KAIST, 2014) can also be adopt in the ANG method, improving the efficiency in the use\n\nof space in comparison to cylindrical and spherical alternatives.\n\nSupplying natural gas to consumption sites often present challenging logistics when the\n\nconstruction of a pipeline is not economically feasible. Gas supply is then guaranteed via\n\nvirtual pipelines, which currently consist of trucks carrying CNG tanks to deliver natural\n\ngas to customers. ANG tanks demand less energy on gas compression, save transport\n\ncosts for being lighter than CNG and reduce gas flare losses (INGEVITY, 2017).\n\nSeveral companies have been designing ANG tanks for vehicular use. It is claimed\n\nthat it can reduces in 50% the costs of refuelling stations and improve safety due to its\n\ncontrolled release of gas at low pressure (ANGP, 2017).\n\n1.2.1 Design Approaches\n\nThe major drawback of ANG tanks is that their internal temperature variation pre-\n\nvents them from reaching their full capacity of gas adsorption in fast filling and emptying\n\ncycles. Since the adsorption reaction is exothermic, when a molecule of gas is adsorbed\n\nby the surface, heat is released. This behaviour is detrimental to the storage of gas by\n\nmeans of adsorption because the saturation of adsorbed gas decreases with the increase\n\nof temperature. Conversely, when filling an adsorbent bed, the probability of a molecule\n\nbeing adsorbed is increasingly lower, because of the heat generated by previous adsorp-\n\ntion reactions. In turn, the desorption reaction is endothermic, consuming heat when\n\nmolecules detaches from the surface. This behaviour is also disadvantageous, since it\n\nmakes the desorption of molecules harder due to the fall in temperature, hindering the\n\ngas recovery from the adsorbent.\n\nTherefore, effective ANG tanks can not rely on materials presenting high capacity of\n\nadsorption only. It is necessary to ensure appropriate thermal management in order to\n\nallow reasonable short filling and emptying cycles. Given the poor conductivity typically\n\npresented by adsorbent materials, thermal management is essential to the feasibility of\n\nANG tanks.\n\nShorter cycles can be achieved by varying the tank shape and boundary conditions.\n\nSahoo et al. (2011) analysed different inlet flow rates, aspect ratios and convection co-\n\n\n\n6\n\nefficients. Naturally, the achieved storage density has shown to be higher for slim tanks\n\nsubjected to high heat convection with the surroundings.\n\nCooling elements can also be added to the tank. Mota et al. (2004) relies on a cooling\n\njacket traversed by hot exhaust gases, imposing forced convection to the tank during a\n\ndesorption cycle. Subjected to exhaust gases at 80 ?C, the jacketed tank has presented a\n\nfinal average temperature 30 ?C hotter than the conventional reference tank in a 3-hour\n\ncycle, which results in an important increase of the net deliverable capacity. It is also\n\nreported that the inclusion of radially-extruded fins, arbitrary distributed throughout the\n\nadsorbed bed, has improved the deliverable capacity in 5% more. Based on such results,\n\nMota et al. (2004) recommends future optimisation of fins distribution.\n\nThe distribution of fins across the adsorbent bed is also recommended by Vasiliev et\n\nal. (2014) on the adsorption of hydrogen on Busofit activated carbon. In this case, fins are\n\nconnected to a double-pipe heat exchanger traversed by a cooling fluid at 233 K, which is\n\nbuilt in the centre of the adsorbent bed. Similar to Mota et al. (2004), fins have allowed\n\n25% more gas to be adsorbed, despite being arbitrarily distributed.\n\nIt is important to remark, however, that the models presented by Mota et al. (2004)\n\nand Vasiliev et al. (2014) are dependent on intense active cooling, based on cooling fluids\n\nat 80 ?C and ?40 ?C, respectively, flowing across the whole adsorbent bed length. The\ngains achievable with such methods are naturally high, although the energy required to\n\nrun such systems can make them less efficient per unit of gas stored. Therefore, an exergy\n\nassessment would be necessary in order to determine the feasibility of such ANG tanks.\n\nWhen active cooling is inefficient or infeasible, some alternative methods based on\n\npassive thermal management are interesting. Toledo et al. (2013) studies the adsorption\n\nand desorption of CO2 on systems containing spheres of Phase Change Materials (PCM).\n\nThese materials behave as heat sinks, due to their high latent heat, and can be distributed\n\nacross the adsorbent bed in order to control temperature variations.\n\n1.2.2 Numerical Modelling\n\nSeveral numerical methods have been applied to model adsorption systems. Hirata\n\net al. (2009) adopts an hybrid numerical-analytical method based on the Generalised\n\nIntegral Transform Technique (GITT) for modelling a simple one-dimensional problem\n\nconsidering the energy balance only, which is overly simplified for the scope of this work.\n\nIn Thacker et al. (2014) and Mota et al. (1996), the Partial Differential Equations\n\n\n\n7\n\n(PDE) are reduced to a set of Ordinary Differential Equations (ODE) by interior orthog-\n\nonal collocation, in which the non-symmetry of the collocation matrix is disadvantageous\n\n(SUN et al., 1996).\n\nThe Finite Volume Method (FVM) is adopted in Santos et al. (2009), Mota et al.\n\n(2004) and Vasiliev et al. (2014) and the Finite Element Method (FEM) in Yonge (1992)\n\nand Sahoo et al. (2011). FVM and FEM are the most popular techniques for solving\n\nproblems with coupled heat transfer and fluid flow, sharing the same fundamental idea\n\nof satisfying a weak form, differing on the choice of the weighting function (CHAO et al.,\n\n2002). Given the vast literature of latter methods, the FEM method is adopted in this\n\nwork.\n\n1.3 Optimisation Methods applied to Fluids and Heat\n\nTransfer Problems\n\nOptimisation methods are suitable to the design of devices subjected to thermofluidic\n\ninteraction, such as in adsorption systems. A key aspect when designing such systems is\n\nthe way trial geometries are represented through the design variables. According to Hall\n\net al. (2017), there are five main groups of parametrisation, based on (i) surface points, (ii)\n\ncontrol points, (iii) level sets, (iv) descriptive functions or (v) volumetric representation.\n\nMethods in the first group considers the mobility of every node on the surface mesh,\n\nsuch that their coordinates are the design variables of the optimisation problem (REUTHER\n\net al., 1999). This method requires that the gradient of the objective function must be\n\nsmoothed to avoid noisy surface shapes. It is widely adopted for aerodynamic optimi-\n\nsation, although presenting high computational cost and slow convergence rates. In the\n\nsecond group, control points are defined in order to reduce the problem size. Splines,\n\nBezier curves or B-Splines are some of the possibilities for interpolating smooth surfaces\n\nbased on fewer points. Free-Form Deformation (FFD) (SEDERBERG; PARRY, 1986)\n\nand Radial Basis Function (RBF) (MORRIS et al., 2008) are methods in which control\n\npoints are used to deform the mesh through a relationship between the position of these\n\npoints and the mesh nodes. In the third group, surface boundaries are defined by level\n\nsets of a function related to the sensitivity of each region to the objective function. The\n\nlevel set function is evolved according to a time step analogy, in which at every step a new\n\ngeometry is defined at the chosen level (usually zero) (DIJK et al., 2013). In the fourth\n\ngroup, shape functions are associated with class functions, which represent basic types of\n\nbodies. In methods belonging to this group, the design variables can scale shape func-\n\n\n\n8\n\ntions, which will define the body constrained to class functions, or be used as coefficients\n\nto multiply perturbation functions (HALL et al., 2017).\n\nIn the last group, free boundaries are represented by the concept of fractional Volume\n\nof Fluid (VoF), where the fraction of material stored in grid cells defines solid and fluid\n\nregions. The Piecewise Linear Interface Calculation (PLIC) method (ANISZEWSKI et\n\nal., 2014) uses the fluxes of the fraction function to determine a well-defined solid-fluid\n\ninterface. Other methods ignore the notion of surfaces by only controlling the extent to\n\nwhich a given point is solid, as is the case of the density approach in topology optimisation.\n\nVolume-based methods present the advantage of handling any topology change, allowing\n\nthe creation and disappearance of surfaces across the domain.\n\nTopology optimisation seeks optimised distributions of different materials inside a\n\nfixed design domain in order to maximise or minimise an objective function. Topology\n\noptimisation is usually implemented in association with FEM, considering a design vari-\n\nable in each finite element or node in the domain. The design variables are generally called\n\npseudo-densities and range from 0 to 1, in order to represent the presence of material and\n\nabsence of material (void) or two different materials. It is considered one of the most\n\ngeneric methods of optimisation as it is able to represent any material contour inside the\n\ndesign domain.\n\nIn structural problems, 0 and 1 often denotes the absence and presence of material,\n\nrespectively. In thermal problems, a common optimisation problem is to distribute mate-\n\nrials with different conductivities along the design domain, being one material represented\n\nby 0 and the other by 1. The optimisation of fluidic problems is addressed based on the\n\ngoverning equation of porous media flow to represent solid regions. Solid materials are rep-\n\nresented by pseudo-densities equal to 0 and are considered to be a porous medium with a\n\nvery low permeability, while fluid regions are denoted by 1 and governed by Navier-Stokes\n\nequations.\n\nThe implementation of topology optimisation methods to heat transfer problems was\n\nintroduced by Xie et al. (1999), which adopt an Evolutionary Structural Optimisation\n\n(ESO) approach by removing under-utilised elements from the domain mesh. In the ESO\n\nmethod, elements are removed according to a rejection criterion until reaching a steady\n\nstate. Such criterion is then iteratively updated following an evolution rate, culminating\n\nin the final topology. In Turteltaub (2001), the optimisation of transient heat conduction\n\nproblems is studied by varying the material properties inside a fixed design domain by\n\nfollowing the SIMP scheme and including a regularisation term on the objective function.\n\n\n\n9\n\nHowever, the results presented did not cover the solid-void optimisation case, which is later\n\naddressed by Sigmund (2001) by designing thermal and electro-thermal micro-actuators\n\nsubjected to top heat convection only.\n\nIn order to take the side convection into account in the design of electro-thermal actu-\n\nators, the work of Yoon &amp; Kim (2005) is based on the Element Connectivity Parametrisa-\n\ntion (ECP) method, where the design variables are the links between elements instead of\n\ntheir densities. Bruns (2007) gives special attention to convection-dominated problems,\n\nby discussing their susceptibility to numerical instabilities inherent to the density depen-\n\ndent interpolation schemes commonly used in topology optimisation. Such instabilities\n\nare dealt with by ensuring that the convection term contributions are lumped matrices.\n\nBorrvall &amp; Petersson (2003) applied topology optimisation to the design of fluid sys-\n\ntems seeking to minimise the power dissipation in fluid flow channels. A well-posed\n\noptimisation problem is introduced, presenting solution convergence to a binary function\n\nspace as the mesh is refined. It is based on a material model with a different penalisation\n\nscheme, which will be detailed further in Section 3.4.1. Gersborg-Hansen et al. (2005) ini-\n\ntially extended this approach to incompressible laminar viscous flow at moderate Reynolds\n\nnumbers, thus solving a non-linear problem. Then, Guest &amp; Prevost (2006) proposed a\n\nnew generalized method, by combining and scaling the Stokes and Darcy equations.\n\nYoon (2010) coupled heat transfer to the fluid problem, optimising heat dissipating\n\nstructures with forced convection. This multiphysics optimisation is also approached by\n\nKoga et al. (2013) and Matsumori et al. (2013) with similar purposes. Kontoleontos\n\net al. (2012) widened the set of problems tested, including three-dimensional manifolds.\n\nYoon (2012) optimised Electro-Thermo-Mechanical (ETM) actuators by considering their\n\ninteraction with the surrounding fluid.\n\nDespite the theory of topology optimisation applied to fluid mechanics being based on\n\nthe variation of porosity, where media presenting very low porosity emulate impermeable\n\nsolid regions, few works applied the method to the optimisation of actual porous media.\n\nThe concept of impermeability adopted in Guest &amp; Prevost (2006) and in Borrvall &amp;\n\nPetersson (2003) considers that a material presenting permeability K = 1.00 \u00d7 10?8 m2\n\nbehaves like a wall, while in typical ANG tanks the fluid flow permeates an activated\n\ncarbon presenting K = 3.70 \u00d7 10?10 m2 (SAHOO et al., 2011).\n\nOn structural design, Andreasen &amp; Sigmund (2013) presents an implementation of\n\ntopology optimisation for saturated poroelastic media, with respect to the macroscopic\n\nmaterial distribution based on the homogenisation theory. The method is applied to the\n\n\n\n10\n\ndesign of shock absorbers, where the energy dissipation is due to the flow resistance.\n\nThe use of topology optimisation for the design of adsorbed systems is not yet reported\n\nin literature. Figure 1.3 presents the topology optimisation procedure for designing ANG\n\ntanks. A fixed initial domain with given boundary conditions is discretised in finite ele-\n\nments. Pseudo-porosities are associated with each element and their values are optimised\n\naiming to maximise or minimise a given objective function, resulting in a final topology.\n\nA post-processing step is then necessary, in order to recover the discrete nature of the\n\nproblem and to smoothen the contours of the material distribution. Finally, the post-\n\nprocessed topology can be verified numerically through other software before proceeding\n\nto manufacturing.\n\nINITIAL DOMAIN FINAL TOPOLOGY\n\nPOST-PROCESSING VERIFICATION\n\n1 2\n\n3 4\n\nFigure 1.3: Topology optimisation procedure.\n\n1.4 Motivation\n\nAdsorption systems play an important role in a wide range of applications, with a vast\n\nrange of commercial products reliant on the process. Aiming to improve the performance\n\nof adsorption devices, past research has been limited to the improvement of adsorbent\n\ncharacteristics, such as the pores geometry and distribution (BILOE et al., 2002). The\n\n\n\n11\n\ndesign of adsorption systems by stating and solving an actual optimisation problem has\n\nnot been reported in literature. Topology optimisation is suitable to address the design\n\nof such systems and expand their current applications.\n\n1.5 Objectives\n\nThis work proposes a method for the design of adsorption systems based on topology\n\noptimisation by seeking the following objectives:\n\n\u2022 To formulate a comprehensive numerical model of gas adsorption on porous media;\n\n\u2022 To formulate topology optimisation problems regarding the maximisation of the\nmass of gas adsorbed in Adsorbed Natural Gas (ANG) tanks;\n\n\u2022 To obtain optimised ANG tank layouts able to adsorb gas more efficiently.\n\n1.6 Scientific Contributions\n\nThis research addresses some previously unexplored topics, presenting the following\n\nscientific contributions:\n\n\u2022 Statement of weak and discrete formulations of the adsorption problem and its\nadjoint system;\n\n\u2022 Development of an optimisation method for adsorption systems;\n\n\u2022 Definition of a novel material model based on offset hyperbolic tangents;\n\n\u2022 Presentation of optimised Adsorbed Natural Gas (ANG) tanks based on the distri-\nbution of cooling materials;\n\n1.7 Thesis Outline\n\nThis document is organized as follows. In Chapter 2, the governing equations of the\n\nadsorption phenomenon are presented. In Chapter 3, topology optimisation problems\n\nregarding ANG tanks are defined. Chapter 4 details the numerical implementation of the\n\nproposed model. In Chapter 5, layouts of ANG tanks obtained by topology optimisation\n\nare presented. Chapter 6 reports overall conclusions on the optimisation of adsorption\n\nsystems.\n\n\n\n12\n\n2 Modelling of Adsorption\nSystems\n\nThe adsorption problem is governed by typical fluidic and thermal equations applied\n\nto porous media coupled with equations defining the interactions between adsorbent and\n\nadsorbate. This Chapter presents the general assumptions and the governing equations\n\nconsidered when modelling the adsorption problem. The weak formulation of the govern-\n\ning equations is also derived.\n\n2.1 Modelling Flow in Porous Media\n\nThe modelling of the actual flow in porous media is very challenging, given the complex\n\nnetwork of channels presented by such materials. By regarding the porous media as a\n\ncontinuum, it is possible to approximate the macroscopic fluid motion through its channels\n\nby taking an average of the microscopic flow within a Representative Elementary Volume\n\n(REV) (WHITAKER, 1986). Figure 2.1 shows on the right the continuum interpretation\n\nof the porous medium presented on the left. The averaged velocity of the flow inside each\n\nREV is represented by the arrows.\n\nThe Darcy\u2019s law is an approximation which describes the fluid flow in porous media\n\nthat is valid for a limited range of low velocities. Deviations presented by experimental\n\nresults motivated the consideration of microscopic inertial effects, as in the Forchheimer\n\nequation (MULJADI et al., 2016), in which\n\n? ?p =\n\u00b5f\nK\n\nvg + ??g|ug|2n, (2.1)\n\nwhere ?g denotes the fluid density, ? is the non-Darcy coefficient and n is a unit vector\n\nin the direction of ?P .\n\n\n\n13\n\nREVREV\n\nFigure 2.1: Continuum modelling of porous media based on Representative Elementary\nVolume (REV).\n\nIn order to determine the cases when non-Darcy effects are meaningful, the Reynolds\n\nnumber was the first criterion to be used. It is based on the assumption that non-Darcy\n\neffects in porous media are similar to turbulence in conduits, in which Reynolds number\n\nis given by (ZENG; GRIGG, 2006)\n\nRe =\n?g\u00f8pvg\n\u00b5\n\n, (2.2)\n\nwhere the conduit diameter is considered to be in the same magnitude of the average\n\nparticle diameter \u00f8p in the porous medium.\n\nPrevious research present a wide range for the transition region between Darcy and\n\nnon-Darcy porous media flow. Different authors report discrepant transition regions, with\n\nReynolds number ranging from 0.1 to 1000 (MULJADI et al., 2016). Due to the lack of\n\na precise delimitation of this region, criteria based on Reynolds number are not widely\n\nadopted (ZENG; GRIGG, 2006).\n\nA second criterion is based on the Forchheimer number, which is given by (ZENG;\n\nGRIGG, 2006)\n\nFo =\n?gK?vg\n\n\u00b5\n, (2.3)\n\nwhere ? denotes the non-Darcy coefficient.\n\nWhile the measurement of the particle diameter \u00f8p in the Reynolds number is not\n\ntrivial, the permeability K and the coefficient ? involved in the Forchheimer number are\n\neasily obtained experimentally by measuring the pressure drop in a specimen for a range\n\nof different flow rates (ZENG; GRIGG, 2006). It has been found that a Forchheimer\n\nnumber equal to 0.11 is a good reference for the acceptance of Darcy\u2019s law approximation\n\nin porous media. The meaning of a flow presenting Fo = 0.11 is that non-Darcy effects\n\nrepresent 10% of the forces involved.\n\n\n\n14\n\nIn modelling ANG tanks, Mota et al. (2004) and Sahoo et al. (2011) consider all\n\ninertial and viscous effects negligible and adopt pure Darcy\u2019s law. Mota et al. (1996),\n\nRahman et al. (2011) and Vasiliev et al. (2014) consider additional terms for accounting\n\nthe inertial effects by following Ergun or Forchheimer equations. In general, models\n\nneglecting non-Darcy effects have presented good agreement with experimental validation,\n\nbeing preferred in order to reduce computational cost.\n\n2.2 Modelling Adsorption Equilibrium and Kinetics\n\nAdsorption is modelled as the retention of molecules from a solute with concentration\n\nC0 (relative to the fluid phase volume) on solid particles at a concentration q (relative\n\nto the solid phase mass). Such retention reduces the number of molecules on the mobile\n\nphase, resulting in a new solute concentration C. Given a fixed temperature, a relationship\n\nq = f(C) is observed, which is named the sorption isotherm. This process is expressed\n\nby (LIMOUSIN et al., 2007)\n\nq =\nV\n\nM\n\n(\n\nC0 ? C\n)\n\n+ q0, (2.4)\n\nwhere V is fluid phase volume, M is the solid phase mass and q0 is the initial concentration\n\nof adsorbed molecules on solid particles.\n\nThe desorption process is the release of solute molecules from the solid particles,\n\nincreasing the concentration of the liquid phase. It can be noted that the same equation\n\nis valid for modelling both adsorption and desorption processes, given that for adsorption\n\nC0 > C and q0 &lt;q while for desorption C0 &lt;C and q0 > q. Figure 2.2 illustrates these\n\nprocesses.\n\nFigure 2.2: Adsorption and desorption processes.\n\nAdsorption process requires an energy of activation, Ea, and is exothermic, presenting\n\nan isosteric heat of adsorption ?H. In turn, the desorption reaction is endothermic and\n\nrequires an energy of activation, Ed. Figure 2.3 the variation of energy in an exothermic\n\nreaction along the reaction pathway.\n\n\n\n15\n\nFigure 2.3: Adsorption energetics (MCBRIDE, 1994).\n\nGiles (1974) divides the isotherms into four classes according to their initial slope\n\ntermed as S, L (Langmuir), H (high affinity), and C (constant partition), which are\n\ndepicted in Figure 2.4. C-isotherm considers a simple linear function for expressing q =\n\nf(C), which means that the sorbate has infinite adsorption sites. L-isotherm assumes\n\nsteady decrease on the concentrations ratio, presenting a well defined plateau in some\n\ncases. H-isotherm is suitable when the affinity between adsorbate and adsorbent is very\n\nhigh and the available sites are occupied promptly. S-isotherm presents an inflection\n\npoint which is the result of the opposition of two mechanisms: the low rate observed\n\nfor low concentrations reproduces the difficulty that some adsorbates have to attach to\n\nthe adsorbent and after the adsorption of the first molecules the adsorption of others is\n\nfavoured through a phenomenon named cooperative adsorption.\n\nL-isotherm and H-isotherm are also know as concave isotherms and several different\n\nmodels are based on them, such as Freundlich, Langmuir, Dubinin, Polanyi, Kisarov and\n\nVacancy Solution Model (WOOD, 2002).\n\nAccording to the Freundlich models, a plateau is never reached, even for very high\n\nconcentrations. It is given by (LIMOUSIN et al., 2007)\n\nq = FCn, (2.5)\n\nwhere F and n are constants obtained experimentally, being n &lt;1.\n\nLangmuir models are based on the assumption that the adsorbate presents a limited\n\ncapacity of adsorption qmax. It is derived from the kinetics of adsorption and desorption.\n\n\n\n16\n\nQ\n\nC\n\nH\n\nL\n\nC\n\nS\n\nFigure 2.4: Classes of isotherms (GILES, 1974).\n\nGiven that the rate of adsorption is proportional to the vacant sites for adsorption, it can\n\nbe expressed as (PATIHA et al., 2016)\n\n?q\n\n?t\n= ka(qmax ? q)C, (2.6)\n\nwhere ka is the kinetic coefficient of adsorption obtained experimentally for each adsorbent-\n\nadsorbate pair.\n\nThe desorption rate is proportional to the occupied sites (PATIHA et al., 2016), which\n\nis expressed as\n?q\n\n?t\n= kdq, (2.7)\n\nwhere kd is the kinetic coefficient of desorption.\n\nAt equilibrium, the rates of adsorption and desorption are equal and q is given by\n\n(PATIHA et al., 2016)\n\nq =\nqmaxC\n\nkd\nka\n\n+ C\n\n. (2.8)\n\nThe Dubinin models are the most versatile methods of expressing adsorption equilib-\n\nrium, being expressed by means of adsorbate and adsorbent properties and temperature\n\n(WOOD, 2002). It relies on the Polanyi\u2019s adsorption potential theory, which defines a\n\npotential equal to the change in free energy from the bulk liquid to the adsorbed state,\n\ntaking the vapour saturation pressure psat as reference (WOOD, 2001). It is expressed as\n\nA = RT\n\n(\n\nPsat\nP\n\n)\n\n. (2.9)\n\n\n\n17\n\nThe Dubinin isotherm is then defined in terms of volume of micro-pores W occupied\n\nby adsorbate (WOOD, 2001), given by\n\nW = W0 exp\n\n(\n\n?\n(\n\nA\n\n?E0\n\n)n)\n\n, (2.10)\n\nwhere W0 is the total volume of micro-pores and the exponent n can assume differ-\n\nent values depending on the specific model, being equal to 2 for Dubinin-Radushkevich\n\nisotherms. E0 and ? denote, respectively, the characteristic adsorption energy for the ref-\n\nerence vapour and the affinity of the adsorbate to the adsorbent, usually taking benzene\n\nas reference (?benzene = 1).\n\nThe kinetics of adsorption consists of a sequence of three steps: (i) mass transfer of\n\nthe adsorbate from the solution to the external surface of the adsorbent, (ii) diffusion\n\nthrough the adsorbent and (iii) adsorption itself (LARGITTE; PASQUIER, 2016). When\n\nmodelling adsorption kinetics, it is usual to assume that either the diffusion or the actual\n\nadsorption is the rate limiting and dictates the rate of the process as a whole.\n\nTwo main models are reported for adsorption kinetics taking the intra-particle diffu-\n\nsion as the limiting step: Crank and Weber-Morris. Crank model considers homogeneous\n\ndiffusion across an adsorbate consisting of spheres, which is defined as (LARGITTE;\n\nPASQUIER, 2016)\n?q\n\n?t\n=\nDS\nr2\n\n?\n\n?r\n\n(\n\nr2\nq\n\nr\n\n)\n\n, (2.11)\n\nwhere DS is the surface diffusivity and r denotes the radial distance.\n\nWeber-Morris model is based on the empirical observation that the uptake varies\n\nnearly proportionally with\n?\nt (ALKAN et al., 2007). It is expressed by (QIU et al., 2009)\n\nq = kintra\n?\nt, (2.12)\n\nwhere kintra is the intra-particle diffusion rate constant.\n\nWhen the adsorption itself is the rate limiting step, Elovich or Lagergren equations\n\nare often used to model the phenomenon. Elovich models are expressed by (LARGITTE;\n\nPASQUIER, 2016)\n?q\n\n?t\n= a exp\n\n(\n\n? bq\n)\n\n, (2.13)\n\nwhere a is the initial rate of adsorption and b is a constant obtained experimentally related\n\nto the variation of the energy of adsorption.\n\nLagergren models present an asymptotic approach to the equilibrium of the adsorbed\n\n\n\n18\n\nphase qeq through a pseudo first order equation given by (LARGITTE; PASQUIER, 2016)\n\n?q\n\n?t\n= ka(qeq ? q), (2.14)\n\nwhere ka is the adsorption rate constant.\n\nSome other models are derived from the original Lagergren model. One variation\n\nconsists of the extension of the pseudo first-order form to the pseudo n-order laws given\n\nby (LARGITTE; PASQUIER, 2016)\n\n?q\n\n?t\n= ka(qeq ? q)n, (2.15)\n\nwhere n defines the pseudo order of the equation.\n\nAnother Lagergren derived model, know as Langmuir, includes the consideration of the\n\nreversibility of the adsorption reaction by adding the desorption kinetics as (LARGITTE;\n\nPASQUIER, 2016)\n?q\n\n?t\n= ka(qeq ? q) ? kdq, (2.16)\n\nwhere kd is the desorption rate constant.\n\nIn ANG tanks, the equation of Dubinin-Astakhov (DA), or its variation Dubinin-\n\nRadushevich (DR), is adopted by most authors for predict the amount of gas adsorbed at\n\nthe equilibrium and the kinetics of adsorption is approximated by the Lagergren model\n\n(RAHMAN et al., 2011; SAHOO et al., 2011; VASILIEV et al., 2014). Alternatively,\n\nMota et al. (1996) adopts a Langmuir-type prediction for the equilibrium and suggests\n\nthat the kinetics of adsorption can be neglected for the typical intraparticle diffusional\n\ntime constants of adsorbent beds. This assumption is generally valid, but also depends\n\non other factors, such as the energy of activation, and it will be studied further in this\n\nwork.\n\n2.3 Governing Equations\n\nA typical sorption domain ? is illustrated in Figure 2.5, where ?W and ?L denote sub-\n\nregions of ?? where boundary conditions of wall and inlet/outlet are imposed, respectively.\n\nIn this work, the following assumptions are made:\n\nIdeal gases: in the systems considered, gases are considered to present ideal thermo-\n\n\n\n19\n\nW\n\nG\nW\n\nG\nL\n\nFigure 2.5: Adsorption domain.\n\ndynamic behaviour (SAHOO et al., 2011), therefore, their densities are described by\n\n?g =\nMgP\n\nRgT\n, (2.17)\n\nwhere Mg is the molecular gas mass, Rg is the universal gas constant, P is the gas pressure\n\nand T is the gas temperature.\n\nDarcy\u2019s Porous Media: non-Darcy effects are neglected in the fluid flow, according to\n\nEq. (2.1) with ? = 0.\n\nLocal thermal equilibrium: the sorbent bed is locally in thermal equilibrium with the\n\ngas (MOTA et al., 2004). All intra-particle and film resistances in heat and mass transfer\n\nare neglected.\n\nNegligible viscous forces: the viscous forces are neglected due to the low gas viscosity\n\nand the relatively large bed-particle diameter ratio (MOTA et al., 2004).\n\nConstant specific heat capacity: the specific heat capacity is considered to be constant\n\nwithin the typical range of temperatures observed in sorption systems. Its variation is\n\nneglected since it usually varies around only 8% (MOTA et al., 2004) in a range of 100 K.\n\nConstant adsorption enthalpy: this work considers an approximation in which ?H\n\nassumes a constant mean value within the range of pressures and temperatures studied\n\n(SAHOO et al., 2011).\n\nLagergren adsorption model: For the studied cases, it is considered that the film\n\ndiffusion is dominant and the rate of sorption is governed by Lagergren model (VASILIEV\n\net al., 2014).\n\n\n\n20\n\n2.3.1 Natural Material Models\n\nEffective properties of porous media are determined by material models based on\n\nmacro-porosity (?M) and micro-porosity (?m). Given these two classes of porosity, the\n\ntotal porosity (?t) is defined as\n\n?t = ?M + (1 ? ?M)?m. (2.18)\n\nDensity: the density of the system is given by the sum of gaseous and solid phase\n\nweighted by the total porosity, ?t, with the addition of the density of the adsorbed phase,\n\nbased on its concentration, q, as\n\n?f(?t) = ?t?g + (1 ? ?t)?s + (1 ? ?t)?sq. (2.19)\n\nPermeability: dependent on the macro-porosity, following the Kozeny-Carman\u2019s model\n\nfor spherical particles (CARMAN, 1937), given by\n\nKs(?M) =\n\u00f82s?\n\n3\nM\n\n72?s(1 ? ?M)2\n, (2.20)\n\nwhere \u00f8s is the effective characteristic particle diameter and ?s denotes the pores tortuosity.\n\nThermal Conductivity: it can be given by both Maxwell-Eucken\u2019s or Russel\u2019s rela-\n\ntions (SMITH et al., 2013). The former considers the effect of large spherical pores with\n\nthin walls and the latter the effect of a cubic pore inclusion in the material matrix by con-\n\nsidering a parallel/series resistor. Here, the conductivity of the thin film of gas adsorbed,\n\nkq, is neglected and the Maxwell-Eucken relation is adopted to interpolate the gaseous\n\nand solid conductivities (SMITH et al., 2013), given by\n\nkf(?t) = ks\nkg + 2ks + 2?t(kg ? ks)\nkg + 2ks ? ?t(kg ? ks)\n\n, (2.21)\n\nwhere ks and kg are the thermal conductivities for the solid and gas, respectively.\n\n2.3.2 Adsorption and Desorption Kinetics\n\nThe concentration q represents the mass of adsorbed phase per mass of adsorbent.\n\nTherefore, the density of adsorbed phase in reference to the volume of the adsorbent bed,\n\nQ, is given by\n\nQ = (1 ? ?t)?sq. (2.22)\n\n\n\n21\n\nThe specific volume of micro-pores, ws, represents the volume of micro-pores per mass\n\nof adsorbent. The ratio of micro-pores volume per adsorbent bed volume, Ws, is then\n\ngiven by\n\nWs = (1 ? ?t)?sws. (2.23)\n\nFrom the equilibrium concentration of adsorbed gas, qeq, (SAHOO et al., 2011), the\n\nequilibrium density of adsorbed gas is given by\n\nQeq = ?adgWs exp\n\n(\n\n?\n(\n\nA\n\n?E0\n\n)nf\n)\n\n, (2.24)\n\nwhere ? is the affinity coefficient of the adsorbent-adsorbate pair, E0 is the characteristic\n\nenergy of adsorption and ns stands for the effective micro-pores dispersion.\n\nThe local adsorbed gas density, ?adg, is given by (SAHOO et al., 2011)\n\n?adg =\n?boil\n\nexp(?e(T ? Tboil))\n, (2.25)\n\nwhere ?boil is the gas density at boiling point temperature (Tboil) and ?e is the mean value\n\nof the thermal expansion of liquefied gases.\n\nPolanyi\u2019s adsorption potential, A, is given by\n\nA = RgT ln\n\n(\n\nPsat\nP\n\n)\n\n, (2.26)\n\nwhich saturated pressure Psat is given by\n\nPsat = Pcr\n\n(\n\nT\n\nTcr\n\n)2\n\n, (2.27)\n\nwhere Pcr and Tcr are, respectively, the critical pressure and temperature of the gas.\n\nThe rate of adsorption decreases as more gas is adsorbed, following the Linear Driving\n\nForce (LDF) model given by(MOTA et al., 1996)\n\n?Q\n\n?t\n= G(Qeq ? Q) in ? \u00d7 [0, tf]\n\nQ = Qini in ? at t = 0,\n(2.28)\n\nwhere the coefficient G, which dictates the adsorption and desorption kinetics, is given\n\nby (VASILIEV et al., 2011)\n\nG = D exp\n\n(\n\n?E[a,d]\nRgT\n\n)\n\n, (2.29)\n\nwhere the activation energy of adsorption (Ea) is considered when Q ? Qeq and the\nactivation energy of desorption (Ed) otherwise. D is the intra-particle diffusional time\n\n\n\n22\n\nconstant, given by (SAHOO et al., 2011)\n\nD = 4\nD0\n\u00f82s\n, (2.30)\n\nwhere \u00f8s is the characteristic particle diameter and D0 is the gas diffusivity.\n\n2.3.3 Continuity\n\nIn adsorption systems, the coupled continuity equation of gaseous, solid and adsorbed\n\nphases is expressed by\n\n?\n\n?t\n\n(\n\n?t?g + (1 ? ?t)?s + Q\n)\n\n+ ? \u00b7\n(\n\n?gvg\n\n)\n\n= 0 in ? \u00d7 [0, tf], (2.31)\n\nwhere ?s is the bulk adsorbent density, which is constant.\n\nThe continuity equation considering ideal gases and Darcy\u2019s laws becomes (SAHOO\n\net al., 2011)\n\n?tMg\nRg\n\n?\n\n?t\n\n(\n\nP\n\nT\n\n)\n\n+\n?Q\n\n?t\n?\n\nMg\nRg\u00b5g\n\n? \u00b7\n(\n\nKs\nP\n\nT\n?P\n\n)\n\n= 0 in ? \u00d7 [0, tf], (2.32)\n\nwhere the solid density ?s is considered constant.\n\nBy expanding the transient derivative term, continuity is given by\n\n?tMg\nRg\n\n(\n\n1\n\nT\n\n?P\n\n?t\n? P\nT2\n\n?T\n\n?t\n\n)\n\n+\n?Q\n\n?t\n? Mg\nRg\u00b5g\n\n? \u00b7\n(\n\nKs\nP\n\nT\n?P\n\n)\n\n= 0 in ? \u00d7 [0, tf],\n\nP = Pini in ? at t = 0,\n\nT = Tini in ? at t = 0,\n\nQ = Qini in ? at t = 0.\n\n(2.33)\n\nFor determining a fixed mass inflow or outflow, a Robin boundary condition is applied\n\non ?L as\n\n?MgKs\nRg\u00b5g\n\nP\n\nT\n\n?P\n\n?n\n= ?gvg \u00b7 n = m?let on ?L \u00d7 [0, tf], (2.34)\n\nwhere the mass flow is denoted by m?let\n\nDespite the imposition of a fixed mass inlet making sense for adsorption, the depletion\n\nof a fixed amount of gas during desorption cycles is not possible as the tank is emptied.\n\nTherefore, pressure inlet can be set, which represents the connection of the tank to a\n\ninfinity reservoir at fixed pressure for adsorption or the opening of the tank outlet to the\n\natmosphere for desorption. In order to model the gradual pressure transition inside the\n\ntank, a possible approach is to smoothly vary the pressure on ?L according to a sinusoidal\n\n\n\n23\n\nprofile given by\n\nP?L(t) =\n\n?\n\n?\n\n?\n\n?\n\n?\n\nPini + sin\n2\n\n(\n\n?\n\n2\n\nt\n\n?tf\n\n)\n\n(Plet ? Pini) on ?L \u00d7 [0,?tf]\n\nPlet on ?L \u00d7 [?tf, tf],\n(2.35)\n\nwhere Pini and Plet denote initial and filling/emptying pressures, tf is the final time and\n\n0 &lt;? ? 1.0 is a smoothness factor. Figure 2.6 illustrates P?L curves for adsorption and\ndesorption cycles.\n\nPini\n\nstf\n\nPlet\n\ntf\n\n(a) (b)\n\nFigure 2.6: Inlet pressure (P?L) during (a) adsorption and (b) desorption cycles.\n\n2.3.4 Energy Balance\n\nThe energy balance of the gaseous phase is given in terms of internal energy, ug, by\n\n(BIRD et al., 2007)\n\n??gug\n?t\n\n+ ? \u00b7 (?gugvg) ? ? \u00b7 (kg?T) + P? \u00b7 vg + ? g : ?vg = 0, (2.36)\n\nwhere ? g is the viscous stress tensor.\n\nSuch balance is rewritten in terms of Cpg and T as (BIRD et al., 2007)\n\n??gCpgT\n\n?t\n+?\u00b7(?gCpgTvg)??\u00b7(kg?T)+?g : ?vg?\n\n? lnV\n\n? lnT\n\n?\n\n?\n\n?\n\n?\n\nP\n\nDP\n\nDt\n??gT\n\nDCpg\nDt\n\n= 0, (2.37)\n\nwhere D denotes the Lagrangian derivative, Cpg is considered constant and\n? lnV\n\n? lnT\n= 1\n\nfor ideal gases.\n\nFollowing the assumption that viscous forces are negligible, the energy balance reduces\n\nto\n??gCpgT\n\n?t\n+ ? \u00b7 (?gCpgTvg) ? ? \u00b7 (kg?T) ?\n\n?P\n\n?t\n? vg \u00b7 ?P = 0, (2.38)\n\n\n\n24\n\nwhich is rearranged as\n\n?gCpg\n?T\n\n?t\n+ CpgT\n\n{\n\n??g\n?t\n\n+ ? \u00b7 (?gvg)\n}\n\nC\n\n+ ?gCpgvg \u00b7 ?T\n\n?? \u00b7 (kg?T) ?\n?P\n\n?t\n? vg \u00b7 ?P = 0,\n\n(2.39)\n\nwhere the continuity equation is observed in C, making these terms to vanish.\n\nBy substituting the momentum equation based on the Darcy\u2019s law, the balance be-\n\ncomes\n\n?gCpg\n?T\n\n?t\n? ?gCpg\n\nKs\n\u00b5g\n\n?P \u00b7 ?T\n\n?? \u00b7 (kg?T) ?\n?P\n\n?t\n+\n\n{\n\nKs\n\u00b5g\n\n?P \u00b7 ?P\n}\n\n?0\n\n= 0,\n\n(2.40)\n\nwhere the last term is neglected, given the very small pressure gradients observed in the\n\nrange of permeabilities of interest in this work.\n\nAnalogously, the energy balance of the solid phase is given by\n\n?sCps\n?T\n\n?t\n? ? \u00b7 (ks?T) = 0. (2.41)\n\nThe energy balance associated to the adsorbed phase includes a source term due to\n\nthe exothermic adsorption reaction, being expressed as\n\nCpqQ\n?T\n\n?t\n? ? \u00b7 (kq?T) = |?H|\n\n?Q\n\n?t\n, (2.42)\n\nwhere ?H is the isosteric heat of adsorption.\n\nThe energy balance for coupled gaseous, solid and adsorbed phases assuming local\n\nthermal equilibrium between phases and ideal gas is then given by (MOTA et al., 2004)\n\n?t\n\n(\n\nCpgMg\nRg\n\nP\n\nT\n\n?T\n\n?t\n? ?P\n\n?t\n\n)\n\n+ (1 ? ?t)\n(\n\n?sCps\n?T\n\n?t\n\n)\n\n+ CpgQ\n?T\n\n?t\n\n?CpgMg\nRg\u00b5g\n\nKs\nP\n\nT\n?P \u00b7 ?T ? ? \u00b7\n\n(\n\nkf?T\n)\n\n= |?H|?Q\n?t\n\nin ? \u00d7 [0, tf],\n\nP = Pini in ? at t = 0,\n\nT = Tini in ? at t = 0,\n\nQ = Qini in ? at t = 0,\n\n(2.43)\n\nwhere the effective thermal conductivity, kf, is given by Eq. (2.21).\n\nDue to the local thermal equilibrium assumption, the temperature on ?L can be\n\nconsidered equal to the inlet gas temperature, which is imposed by a Dirichlet boundary\n\n\n\n25\n\ncondition defined as\n\nT = Tlet on ?L \u00d7 [0, tf]. (2.44)\n\nAlternatively, an inlet heat flux can be considered on ?L, which is expressed by a\n\nRobin boundary condition (SAHOO et al., 2011) given by\n\n?kf\n?T\n\n?n\n= ??gCpgvg \u00b7 n (T ? Tlet) =\n\nMgCpgKs\nRg\u00b5g\n\nP\n\nT\n?P \u00b7 n (T ? Tlet) on ?L \u00d7 [0, tf].\n\n(2.45)\n\nAssuming that heat convection takes place on the walls, a Robin boundary condition\n\nis also defined on ?W . Such condition is imposed by\n\n?kf\n?T\n\n?n\n= hW (T ? T?) on ?W \u00d7 [0, tf]. (2.46)\n\nOn the region ? \\ (?W ? ?L), since no boundary terms are explicitly defined, the heat\nflux is null, which represents adiabatic condition.\n\n2.4 Weak Formulation of Adsorption Systems\n\nWeak formulations are used to obtain solutions for a set of PDEs by satisfying the\n\nintegral of the solution on the domain for a family of test functions. Consider the domain\n\n? ? Rn, illustrated in Figure 2.5 for n = 2. The weak formulation of L(w) is given by its\nactuation on the test function v as (KARNIADAKIS et al., 2005)\n\n?\n\nL(w),v\n\n?\n\n=\n\n?\n\n?\nL(w) v dx ?v ? H1(?), (2.47)\n\nwhere H1 denotes the Hilbert space, whose functions have their first derivatives belonging\n\nto the Lebesgue space L2.\n\nFor axisymmetric domains, it is multiplied by 2?r and given by\n\n?\n\nL(w),v\n\n?\n\n= 2?\n\n?\n\n?\nr L(w) v dx ?v ? H1(?), (2.48)\n\nwhere r is the radial coordinate.\n\nOn ?N ? ??, where Robin boundary condition applies, the weak term is given by\n(KARNIADAKIS et al., 2005)\n\n?\n\nL(w),v\n\n?\n\n?N\n\n=\n\n?\n\n?N\nL(w) \u00b7 n v ds ?v ? H1(?), (2.49)\n\n\n\n26\n\nwhere n denotes an outward unit vector normal to ?.\n\nAnalogously, for axisymmetric domains, it is given by\n\n?\n\nL(w),v\n\n?\n\n?N\n\n= 2?\n\n?\n\n?N\nr L(w) \u00b7 n v ds ?v ? H1(?). (2.50)\n\nConsidering the Dirichlet boundary condition given by\n\nw = wD on ?D, (2.51)\n\nthe unknown w belongs to the space W defined as\n\nW = {w ? H1(?) : w = wD on ?D}, (2.52)\n\nin which wD ? H1/2(?) (SA et al., 2016).\n\nThus, from Eqs. (2.33), (2.43) and (2.28) and integrating by parts the terms involving\n\na divergent operator, the weak forms for continuity, energy balance and adsorption kinetics\n\nare given by\n\nM(P,T,Q) =\n\n?\n\n?tMg\nRg\n\n1\n\nT\n\n?P\n\n?t\n,vM\n\n?\n\n?\n?\n\n?tMg\nRg\n\nP\n\nT2\n?T\n\n?t\n,vM\n\n?\n\n+\n\n?\n\n?Q\n\n?t\n,vM\n\n?\n\n+\n\n?\n\nMgKs\nRg\u00b5g\n\nP\n\nT\n?P, ?vM\n\n?\n\n?\n?\n\nMgKs\nRg\u00b5g\n\nP\n\nT\n?P,vM\n\n?\n\n?N\n\n= 0,\n\n?vM ? H1(?),\n\n(2.53)\n\nE(P,T,Q) =\n\n?\n\n?tCpgMg\nRg\n\nP\n\nT\n\n?T\n\n?t\n,vE\n\n?\n\n+\n\n?\n\nCpgQ\n?T\n\n?t\n,vE\n\n?\n\n+\n\n?\n\n(1 ? ?t)?sCps\n?T\n\n?t\n,vE\n\n?\n\n?\n?\n\n?t\n?P\n\n?t\n,vE\n\n?\n\n+\n\n?\n\nCpgMgKs\nRg\u00b5g\n\nP\n\nT\n?P \u00b7 ?T, ?vE\n\n?\n\n+\n\n?\n\nkf?T, ?vE\n?\n\n?\n?\n\n|?H|\n?Q\n\n?t\n,vE\n\n?\n\n?\n?\n\nCpgMgKs\nRg\u00b5g\n\nP\n\nT\n?P \u00b7 ?T,vE\n\n?\n\n?N\n\n?\n?\n\nkf?T,vE\n?\n\n?N\n\n= 0,\n\n?vE ? H1(?),\n\n(2.54)\n\nD(P,T,Q) =\n\n?\n\n?Q\n\n?t\n,vD\n\n?\n\n+\n\n?\n\nGQ,vD\n\n?\n\n?\n?\n\nGQeq,vD\n\n?\n\n= 0, ?vD ? H1(?). (2.55)\n\n\n\n27\n\nConsidering convective heat transfer on the walls,\n\n?\n\nkf?T,vE\n?\n\n?N\n\n= ?\n?\n\nhW (T ? T?),vE\n?\n\n?W\n\n. (2.56)\n\nConsidering mass flow imposition,\n\n?\n\nMgKs\nRg\u00b5g\n\nP\n\nT\n?P,vM\n\n?\n\n?N\n\n=\n\n?\n\nm?let,vM\n\n?\n\n?L\n\n. (2.57)\n\nIn the case that no Dirichlet condition is imposed on temperature field, another term\n\nremains from the integration by parts on the energy balance, accounting for the heat flux\n\nobserved on ?L due to the inlet/outlet of gases, given by\n\n?\n\nkf?T,vE\n?\n\n?N\n\n=\n\n?\n\nCpgTm?let,vE\n\n?\n\n?L\n\n. (2.58)\n\nGiven that vM, vE and vD are arbitrary test functions, Eqs. (2.53)-(2.55) are coupled\n\nand the problem reduces to\n\nM(P,T,Q) + E(P,T,Q) + D(P,T,Q) = 0. (2.59)\n\nThe approximated solution of such weak problem is obtained via FEM as presented\n\nin Chapter 4, where a discrete system is derived based on shape functions interpolation.\n\nBefore addressing this and other numerical matters, the next Chapter is focused on the\n\ndefinition of the theoretical concepts of the optimisation problems studied in this work.\n\n\n\n28\n\n3 Optimisation of ANG Tanks\n\nThis Chapter is focused on the design of adsorption systems via topology optimisation.\n\nThe optimisation concept is discussed, followed by the definition of the objective function\n\nfor the optimisation of ANG tanks. Finally, traditional material models are reviewed and\n\na novel Offset Hyperbolic Tangents (OHT) model is proposed.\n\n3.1 Design Concept\n\nAn ANG tank is considered empty when the equilibrium mass of adsorbed gas for\n\natmospheric pressure and temperature (Patm and Tatm) is achieved. Similarly, it is con-\n\nsidered full when reaching the adsorption equilibrium for the inlet pressure (Plet) and\n\natmospheric temperature. Those quantities are expressed by\n\nQempty =\n\n?\n\n?ads\n\nQeq(Patm,Tatm) dx, (3.1)\n\nQfull =\n\n?\n\n?ads\n\nQeq(Plet,Tatm) dx, (3.2)\n\nwhere ?ads is the adsorbent domain inside the tank.\n\nAt the end of an adsorption or desorption cycle, the actual mass of gas adsorbed inside\n\nthe tank is given by\n\nQf =\n\n?\n\n?ads\n\nQeq(Pf,Tf) dx, (3.3)\n\nwhich is well approximated by\n\nQf ?\n?\n\n?ads\n\nQeq(Pf,Tf) dx, (3.4)\n\nwhere Pf and Tf denote the average pressure and temperature within the domain ?ads at\n\nthe end of the cycle.\n\n\n\n29\n\nThe goal when designing ANG tanks, is to make the temperature Tf as near as possible\n\nto the atmospheric temperature Tatm at the end of both adsorption and desorption cycles.\n\nThis is often very time demanding due to the adsorbent poor conductivity mentioned\n\nabove. A possible approach to shorten the cycle length is not to occupy the full volume of\n\nthe tank with adsorbent, replacing it per some high conductive material in certain regions,\n\nas demonstrated in the tank depicted in Figure 3.1. The design trade-off is to not remove\n\ntoo much adsorbent when introducing non-adsorbent material to make the temperature\n\nTf nearer to the atmospheric value.\n\nFigure 3.1: Optimisation of ANG tanks through the addition of non-adsorbent materials.\n\nThe gain in gas adsorbed obtained in an optimised tank (opt) in relation to a tank\n\nconstituted purely by adsorbent material (pure) is represented by ? and denotes the\n\nincrement in the percentage of mass adsorbed. It is correlated to the variation of adsorbent\n\nvolume inside the tank by\n\n(1 + ?a) =\nQeq(Pf,opt,Tf,opt) ? Qeq(Patm,Tatm)\nQeq(Pf,pure,Tf,pure) ? Qeq(Patm,Tatm)\n\n(\n\n1 ?\nVnon\nVtank\n\n)\n\n. (3.5)\n\nFigure 3.2 illustrates the case of a tank which is presenting a final average temperature\n\nof 323 K at the end of the adsorption cycle. It is shown how much volume is possible\n\nto occupy with non-adsorbent materials according to the reduction of the temperature in\n\norder to achieved certain gain in the mass of gas adsorbed. For instance, if the replacement\n\nof 5% of the adsorbent bed with some non-adsorbent material leads to the reduction of\n\nfinal average temperature to 300 K, it would be possible to adsorb 30% more gas.\n\n3.2 Manufacturing Considerations\n\nAccording to Menon &amp; Komarneni (1998), the packing density of adsorbent particles is\n\na key factor for the overall capacity of gas storage in ANG systems. The most promising\n\n\n\n30\n\n295 300 305 310 315 320\n\nFinal Average Adsorbent Temperature (K)\n\n0\n\n5\n\n10\n\n15\n\n20\n\n25\n\n30\n\n35\n\nN\no\nn\n-A\n\nd\nso\nrb\nen\nt\nV\no\nlu\nm\ne\n(%\n\n)\n\n0% more gas adsorbed\n\n10% more gas adsorbed\n\n20% more gas adsorbed\n\n30% more gas adsorbed\n\n40% more gas adsorbed\n\nFigure 3.2: Isomassic curves given by the variation of adsorbent temperature and relative\nnon-adsorbent volume in adsorption cycle.\n\napproaches involve the fabrication of monolithic carbon based on the extrusion, cold\n\npressing or hot isostatic pressing of the activated carbon powder associated with some\n\nbinder. As a monolith, the void volume between particles is reduced and, therefore, the\n\nrelative volume of micropores with respect to the total vessel volume is increased, resulting\n\nin more gas being adsorbed (QUINN et al., 1994). The fabrication method described in\n\nBose et al. (1991) comprises mixing high surface area carbon particles with a solution\n\nof a binder in a solvent, forming a slurry. The use of binders, typically thermoplastic\n\npolymers, is important to prevent future powdering of the adsorbent bed when subjected\n\nto vibration or strong gas flow. The solvent is then removed, resulting in binder-coated\n\ncarbon particles, which are compressed to form a compacted adsorbent mass of any desired\n\ngeometric shape (BOSE et al., 1991).\n\nHence, ANG tanks can present features of any complexity without prejudice to the\n\nmanufacturing process. Non-adsorbent parts, can be manufactured through traditional\n\nmethods, such as machining or casting, and assembled at the desired position inside the\n\ntanks. The binder-coated carbon particles can then be poured into segments of the tank\n\nand compressed, occupying the whole void space left.\n\n\n\n31\n\n3.3 Objective Function\n\nThe optimisation of ANG storing systems can be addressed by focusing on several\n\ndifferent objectives. Figure 3.3 illustrates the typical variation of the adsorbed gas mass,\n\npressure and temperature of an ANG tank serving as an on-demand source of fuel, such\n\nas in gas-powered vehicles or in residences. Starting from the average density of total\n\ngas at the equilibrium, (Q + ?g)ini,a, the tank admits gas while pressure and temperature\n\nincrease during the filling cycle, reaching the final average total density of (Q + ?g)fin,a.\n\nSuch average density is conserved inside the tank until its future depletion. While the tank\n\nis kept quiescent, its temperature slowly approaches the equilibrium with the atmospheric\n\ntemperature, Tatm, causing its internal pressure to drop due to the gas phase change\n\nfrom gaseous to adsorbed. The stored gas is then delivered through a nearly isothermal\n\ndesorption, maintaining equilibrium with Tatm during the whole emptying cycle.\n\nFigure 3.3: Cycle considered for the optimisation of ANG tanks applied to on-demand\nconsumption.\n\nThe goal when designing such tanks is to maximise the total intake of gas during the\n\n\n\n32\n\nfilling cycle by mitigating the rise of the adsorbent bed temperature. The optimisation\n\nproblem consists of\n\nMaximise : Ja(e) =\n\n[?\n\n?\n(Q + ?g) dx\n\n]tfin,a\n\ntini,a\n\n,\n\nsubjected to : 0 ? e ? 1,\nM(P,T,Q) + E(P,T,Q) + D(P,T,Q) = 0.\n\n(3.6)\n\n3.4 Material Model\n\nThe design variables are defined as pseudo-porosities representing two materials: ad-\n\nsorbent and non-adsorbent. Given the poor conductivity presented by typical adsorbents,\n\nsuitable non-adsorbent materials present relatively high conductivity or heat capacity,\n\naiming to improve the heat transfer of the system.\n\nThe alternation between adsorbent (ads) and non-adsorbent (non) materials through\n\nthe domain can be expressed by a pseudo-porosity e as\n\nP(e) =\n\n?\n\n?\n\n?\n\nPnon, if e = 0,\n\nPads, if e = 1,\n(3.7)\n\nwhere the actual property P is given by Pads or Pnon depending on e value.\n\n3.4.1 Material Models with Penalisation\n\nA binary law of material defines an ill-posed problem, with multiple local minima.\n\nSuch issue can be avoided by relaxing the definition and assuming intermediate values,\n\nranging from 0 to 1. Since only 0 and 1 represent existent materials, it is desirable\n\nto recover the discrete nature of this material law. The Solid Isotropic Material with\n\nPenalisation (SIMP) (BENDS\u00d8E; SIGMUND, 1999) addresses this problem by including\n\na penalisation coefficient p, resulting in\n\nP(e) = (1 ? ep)Pnon + (ep)Pads. (3.8)\n\nFor structural cases, where Pnon ? Pvoid and Pads ? Psolid, Bends\u00f8e &amp; Sigmund (1999)\nrecalls that the interpolated material property should not exceed the Hashin-Shtrikman\n\nupper bound for any value of the design variable e. In order to meet this requirement\n\nit is sufficient that p ? 3. However, such penalisation creates multiple local minima and\n\n\n\n33\n\nmakes the final topology very dependent on the initial guess (BENDS\u00d8E; SIGMUND,\n\n1999). Thus, a continuation scheme is advisable, by which the penaliser p is slowly\n\nincreased through the computations.\n\nFigure 3.4 shows the impact of the penalisation coefficient to the property being\n\ninterpolated by SIMP. Taking the pair Steel-Carbon as an example, it can be seen that\n\nthe resulting property for intermediate values of the design variable, e, tends to Steel\n\n(k = 47.00 Wm?1K?1 and W = 0.00 cm3g?1) as p ? ? , while it tends to Activated\nCarbon (k = 0.21 Wm?1K?1 and W = 0.33 cm3g?1) as p ? 0.\n\nBorrvall &amp; Petersson (2003) introduced a scheme more suitable to deal with the\n\ninterpolation of permeabilities, which are separated by several orders of magnitude and\n\nwould require extremely high values for p. This material model is based on the inverse\n\npermeability, S, and it is given by\n\nS(e) =\n1\n\nK(e)\n= Snon + (Sads ? Snon)\n\n1 + p\n\ne + p\ne, (3.9)\n\nwhere Sads and Snon are given by\n\nS[ads,non] =\n1\n\nK[ads,non]\n. (3.10)\n\nThe adsorbent permeability (Kads) is in the order of 1.00 \u00d7 10?10 m2 (SAHOO et\nal., 2011), while the non-adsorbent (Knon) material must be an impermeable medium,\n\nin which the permeability should be as low as 1.00 \u00d7 10?22 m2. For such properties, the\nresulting permeability based on Borrvall\u2019s scheme is shown in Figure 3.5.\n\n3.4.2 Offset Hyperbolic Tangents (OHT) Material Model\n\nSIMP and Borrvall\u2019s models present some disadvantages when dealing with discrepant\n\nproperties, such as the interpolation from Kads = 1.00 \u00d7 10?10 m2 to Knon = 1.00 \u00d7 10?22 m2.\nA material model based on hyperbolic tangents is able to offer a better discrimination of\n\nmaterials, being defined as\n\nP(e) =\n\n(\n\n1 ? m(e)\n)\n\nPnon + m(e)Pads, (3.11)\n\nin which\n\nm(e) =\n\ntanh\n\n(\n\np(e ? ec)\n)\n\n+ 1\n\n2\n, (3.12)\n\nwhere the transition from one material to the other is centred on the value ec.\n\n\n\n34\n\n0.0 0.2 0.4 0.6 0.8 1.0\n\nPseudo-Porosity\n\n0\n\n10\n\n20\n\n30\n\n40\n\nT\nh\ner\nm\na\nl\nC\no\nn\nd\nu\nct\niv\nit\ny\n(\n\nW m\nK\n)\n\np = 0.1\n\np = 0.5\n\np = 1.0\n\np = 2.0\n\np = 10.0\n\n(a) Thermal Conductivity (k)\n\n0.0 0.2 0.4 0.6 0.8 1.0\n\nPseudo-Porosity\n\n0.00\n\n0.05\n\n0.10\n\n0.15\n\n0.20\n\n0.25\n\n0.30\n\nS\np\nec\nifi\nc\nM\nic\nro\n-P\no\nre\n\nV\no\nlu\nm\ne\n(\nc\nm\n\n3\n\ng\n)\n\np = 0.1\n\np = 0.5\n\np = 1.0\n\np = 2.0\n\np = 10.0\n\n(b) Specific Micro-Pore Volume (W)\n\nFigure 3.4: SIMP for Steel and Carbon properties.\n\nIn the case of Steel-Carbon pair, it can be seen that the hyperbolic tangent approach\n\nis suitable to interpolate all the material properties with its generic form, as seen in Figure\n\n3.6.\n\nWhen optimising adsorption systems, materials presenting intermediate properties\n\noften constitute the best solution from the optimiser\u2019s perspective. For instance, in the\n\ncase of seeking an optimised placement of Steel on a Carbon bed, the conductivity of\n\n\n\n35\n\n0.0 0.2 0.4 0.6 0.8 1.0\n\nPseudo-Porosity\n\n10?21\n\n10?19\n\n10?17\n\n10?15\n\n10?13\n\n10?11\n\n10?9\n\nP\ner\nm\nea\nb\nil\nit\ny\n(m\n\n2\n)\n\np = 1.0e-10\n\np = 1.0e-8\n\np = 1.0e-6\n\np = 1.0e-4\n\nFigure 3.5: Borrvall\u2019s material model for Steel and Carbon Permeability (K).\n\nthe non-adsorbent material is more than 200 times larger than adsorbent\u2019s and Steel\n\nadsorption capacity is null. Therefore, a material presenting half of Steel\u2019s conductivity\n\nand half of Carbon\u2019s adsorption would be a good choice, if feasible.\n\nIt is then necessary to adopt a material model which forces the optimiser to clearly\n\nchoose one or other material. The material model based on hyperbolic tangents presented\n\nin Eq. (3.11) is suitable for this sort of requirement. However, when choosing the material\n\nchange centred on the same ec for all the properties, the existence of hybrid materials\n\nprevails despite the penalisation imposed, as shown in Figure 3.7a. Such issue is solved\n\nby defining different values of ec for different properties. For the property A, where the\n\nfunctional of interest J(Aads) (adsorbent property in the whole domain) is higher than\n\nJ(Anon) (non-adsorbent property in the whole domain), the phase change is centred on\n\nec = 0.5 + ?. Conversely, for a property B which presents J(Bnon) higher than J(Bads),\n\nec = 0.5?? is adopted. In the absence of an offset, there would be intermediate properties\nat e = 0.5 regardless of the penalisation value. Figure 3.7 illustrates such material model\n\nfor the offset ? = 0.02. The function m(e) in the Offset Hyperbolic Tangents (OHT)\n\nmaterial model is then given by\n\nm(e) =\n\ntanh\n\n(\n\np(e + s? ? 0.5)\n)\n\n+ 1\n\n2\n, (3.13)\n\n\n\n36\n\nwhere\n\ns = sgn\n\n(\n\nJ(Pnon) ? J(Pads)\n)\n\n, (3.14)\n\nwith sgn denoting the signum function.\n\nA comparison between OHT and traditional material models is presented in Chapter\n\n5, highlighting its advantages for the problems studied in this work. In the next Chapter,\n\nthe numerical implementation of the adsorption problem and the topology optimisation\n\nalgorithm is detailed, along with the necessary verifications.\n\n\n\n37\n\n0.0 0.2 0.4 0.6 0.8 1.0\n\nPseudo-Porosity\n\n0\n\n10\n\n20\n\n30\n\n40\n\nT\nh\ner\nm\na\nl\nC\no\nn\nd\nu\nct\niv\nit\ny\n(\n\nW m\nK\n)\n\np = 2.0\n\np = 8.0\n\np = 64.0\n\n(a) Thermal Conductivity (k)\n\n0.0 0.2 0.4 0.6 0.8 1.0\n\nPseudo-Porosity\n\n0.00\n\n0.05\n\n0.10\n\n0.15\n\n0.20\n\n0.25\n\n0.30\n\nS\np\nec\nifi\nc\nM\nic\nro\n-P\no\nre\n\nV\no\nlu\nm\ne\n(\nc\nm\n\n3\n\ng\n)\n\np = 2.0\n\np = 8.0\n\np = 64.0\n\n(b) Specific Micro-Pore Volume (W)\n\n0.0 0.2 0.4 0.6 0.8 1.0\n\nPseudo-Porosity\n\n10?21\n\n10?19\n\n10?17\n\n10?15\n\n10?13\n\n10?11\n\n10?9\n\nP\ner\nm\nea\nb\nil\nit\ny\n(m\n\n2\n)\n\np = 2.0\n\np = 16.0\n\np = 64.0\n\np = 200.0\n\n(c) Permeability (K)\n\nFigure 3.6: Hyperbolic tangent material model for Steel and Carbon properties with\nec = 0.5.\n\n\n\n38\n\n0.42 0.44 0.46 0.48 0.50 0.52 0.54 0.56 0.58\n\nPseudo-Porosity\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\nA, p=20\n\nA, p=100\n\nB, p=20\n\nB, p=100\n\n(a) ec = 0.5 for A and B\n\n0.42 0.44 0.46 0.48 0.50 0.52 0.54 0.56 0.58\n\nPseudo-Porosity\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\nA, p=20\n\nA, p=100\n\nB, p=20\n\nB, p=100\n\n(b) ec = 0.52 for A and ec = 0.48 for B\n\nFigure 3.7: Material model for properties A and B.\n\n\n\n39\n\n4 Numerical Implementation and\nVerification\n\nIn this Chapter, the discretisation of the weak forms is presented in detail and an\n\nadjoint system is derived in view of the implementation of a gradient-based topology\n\noptimisation. The solution of the adsorption problem and the optimisation algorithm are\n\nthen described along with several numerical verifications.\n\n4.1 Discrete Adsorption Problem\n\nThe weak forms of the adsorption problem derived in Section 2.4 are approximated\n\nover a finite element, ?, by (REDDY; GARTLING, 2010)\n\nP(x, t) ?=\nN\n?\n\nn=1\n\n?n(x)Pn(t) = ?\nT P, (4.1)\n\nT(x, t) ?=\nM\n?\n\nm=1\n\n?m(x)Tm(t) = ?\nT T, (4.2)\n\nwhere P and T are, respectively, the vectors with the nodal values of pressure and tem-\n\nperature, N and M denotes the number of nodes used for each unknown and ? and ? are\n\nthe shape functions, which are assembled in matrices ? and ?.\n\nAnalogously, the mass of adsorbed gas per volume of adsorbent (Q) is interpolated\n\nover finite elements by the shape function ? as\n\nQ(x, t) ?=\nL\n\n?\n\nl=1\n\n?l(x)Ql(t) = ?\nT Q. (4.3)\n\n\n\n40\n\nThe interpolation of the total porosity (?) and all other material properties (?s, Cps,\n\nKs and Ks) is also done by using ?, which is given by\n\n?(x, t) ?=\nL\n\n?\n\nl=1\n\n?l(x)?l(t) = ?\nT\n?. (4.4)\n\nMaking vM = ?, vE = ? and vD = ?, results in the discrete equations given by\n\nW(T) P? + S(P, T) T? + YM Q? + Z(P, T) P = 0, (4.5)\n\nJ P? + N(P, T, Q) T? + YE Q? + L(P, T) T + K T = 0, (4.6)\n\nYD Q? + R(T)Q = V(P, T), (4.7)\n\nwhich results in the following system:\n\n?\n\n?\n\n?\n\n?\n\nW(T) S(P, T) YM\n\nJ N(P, T, Q) YE\n\n0 0 YD\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nP?\n\nT?\n\nQ?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n+\n\n?\n\n?\n\n?\n\n?\n\nZ(P, T) 0 0\n\n0 L(P, T) + K 0\n\n0 0 R(T)\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nP\n\nT\n\nQ\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n=\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n0\n\n0\n\nV(P, T)\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n,\n\n(4.8)\n\nwhose matrices are assembled based on the coefficients defined in Appendix A.1.\n\nThe system given in Eq. (4.8) is rewritten for the n-th timestep as\n\nFt(wn)w?n + Fs(wn)wn = Fr(wn), (4.9)\n\nwhere the state variable wn, constituted by pressure, temperature and adsorbed gas, is\n\ngiven by\n\nwn =\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nPn\n\nTn\n\nQn\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n. (4.10)\n\nThe discretisation of the equations in time by using backward Euler method results\n\n\n\n41\n\nin a lower-triangular system given by\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nI 0 \u00b7 \u00b7 \u00b7 0 0\nCP (w0) CC(w1) \u00b7 \u00b7 \u00b7 0 0\n\n...\n...\n\n...\n...\n\n...\n\n0 0 \u00b7 \u00b7 \u00b7 CP (wN?1) CC(wN)\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nw0\n\nw1\n...\n\nwN?1\n\nwN\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n=\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nWini\n\nFr(w1)\n...\n\nFr(wN?1)\n\nFr(wN)\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n,\n\n(4.11)\n\nwhere Wini denotes the initial state conditions and\n\nCP(wn) = ?\nFt(wn)\n\n?t\n, (4.12)\n\nCC(wn) =\nFt(wn)\n\n?t\n+ Fs(wn). (4.13)\n\n4.2 Discrete Adjoint System for the Adsorption Prob-\n\nlem\n\nIn the optimisation problem given in Eq. (3.6), the functional of interest J(w(e), e)\n\nis constrained to the PDE system F(w, e) = 0 given in Eq. (4.11). Such problem is\n\nexpressed by the following augmented Lagrangian as\n\nJ =\n\n? tfin\n\ntini\n\n(\n\n?tfin ? ?tini\n)\n\nB + ?T\n(\n\nFtw? + Fsw ? Fr\n)\n\ndt, (4.14)\n\nwhere B denotes the total gas mass, given by:\n\n?\n\n?\n\n(Q + ?g)dx, (4.15)\n\nand, for simplicity\n\n?tfin ? ?tini = ?(t ? tfin) ? ?(t ? tini), (4.16)\n\nwhere ? denotes Dirac\u2019s delta operator, making the term (?tfin ? ?tini)B to be equal to\nthe difference in the total gas mass between the beginning and the end of the adsorption\n\ncycle.\n\nThe vector of Lagrange multipliers, ?, is given by\n\n? =\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?M\n\n?E\n\n?D\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n. (4.17)\n\n\n\n42\n\nThe derivative of the reduced functional J in respect to a design variable ei is given\n\nby\n\ndJ\n\ndei\n=\n\n? tfin\n\ntini\n\n(\n\n?tfin ? ?tini\n)(\n\n?B\n\n?ei\n+\n?B\n\n?w\n\ndw\n\ndei\n\n)\n\ndt\n\n+\n\n? tfin\n\ntini\n\n?\nT\n\n((\n\n?Ft\n?ei\n\n+\n?Ft\n?w\n\ndw\n\ndei\n\n)\n\nw? + Ft\ndw?\n\ndei\n+\n\n(\n\n?Fs\n?ei\n\n+\n?Fs\n?w\n\ndw\n\ndei\n\n)\n\nw\n\n+Fs\ndw\n\ndei\n? ?Fr\n\n?ei\n? ?Fr\n?w\n\ndw\n\ndei\n\n)\n\ndt.\n\n(4.18)\n\nIntegrating the term involving dw?/dei by parts, it results in\n\ndJ\n\ndei\n= ?sen + ?b,ini + ?b,fin + ?adj, (4.19)\n\nwhere\n\n?sen =\n\n? tfin\n\ntini\n\n(\n\n?tfin ? ?tini\n)\n\n?B\n\n?ei\n+ ?T\n\n(\n\n?Ft\n?ei\n\nw? +\n?Fs\n?ei\n\nw ?\n?Fr\n?ei\n\n)\n\ndt, (4.20)\n\n?b,ini = ? ?T Ft\ndw\n\ndei\n\n?\n\n?\n\n?\n\n?\n\ntini\n\n, (4.21)\n\n?b,fin = ?\nT Ft\n\ndw\n\ndei\n\n?\n\n?\n\n?\n\n?\n\ntfin\n\n, (4.22)\n\n?adj =\n\n? tfin\n\ntini\n\ndw\n\ndei\n\n[(\n\n?tfin ? ?tini\n)\n\n?B\n\n?w\n? ?(?\n\nT Ft)\n\n?t\n+ ?T\n\n(\n\nFs +\n?Ft\n?w\n\nw? +\n?Fs\n?w\n\nw ? ?Fr\n?w\n\n)]\n\ndt.\n\n(4.23)\n\nSince the term dw/dei is unknown for t > tini, the terms ?b,fin and ?adj cannot\n\nbe evaluated explicitly. Given that ? is arbitrary, it can be chosen in order to nullify\n\nthese terms (DAHL et al., 2008). To ensure ?b,fin = 0 it is necessary to choose ? such\n\nthat ?(tfin) = 0. In adsorption systems, although Pini and Tini are imposed and do not\n\ndepend on the design variables, the initial density of gas adsorbed, Qini, is dependent on\n\nthe volume of adsorbent material inside the domain. The derivative of the state variable\n\nin respect to ei is given by\n\ndw\n\ndei\n\n?\n\n?\n\n?\n\n?\n\ntini\n\n=\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n0\n\n0\n\nQeq(Pini,Tini)\ndm(ei)\n\ndei\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n, (4.24)\n\nwhere the equilibrium adsorbed density Qeq is given in Eq. (2.24) and the material model\n\ninterpolation function m(ei) is given in Eq. (3.13).\n\nThe term ?adj is null when the expression between brackets is equal to zero, which\n\n\n\n43\n\ncan be rewritten as\n(\n\n?tfin ? ?tini\n)\n\n?B\n\n?w\n? ??\n\nT\nFt ? ?T\n\n?Ft\n?w\n\ndw\n\ndt\n+ ?T\n\n(\n\nFs +\n?Ft\n?w\n\ndw\n\ndt\n+\n?Fs\n?w\n\nw ?\n?Fr\n?w\n\n)\n\n= 0,\n\n(4.25)\n\nresulting in\n\n(\n\n?tfin ? ?tini\n)\n\n?B\n\n?w\n? ??\n\nT\nFt + ?\n\nT\n\n(\n\nFs +\n?Fs\n?w\n\nw ?\n?Fr\n?w\n\n)\n\n= 0. (4.26)\n\nThe Lagrange multiplier ? is obtained by the solution of the adjoint problem given\n\nby\n\n(\n\nFt(w)\n\n)T\n\n??(t) ?\n(\n\nFs(w) +\n?Fs(w)\n\n?w\nw ?\n\n?Fr(w)\n\n?w\n\n)T\n\n?(t) =\n\n(\n\n?tfin ? ?tini\n)\n\n?B\n\n?w\n,\n\n?(tfin) = 0.\n\n(4.27)\n\nSuch system poses a terminal value problem, which can be converted in an initial\n\nvalue problem by substituting the time variable t per ? = tfin ? t. A new system is then\ndefined in terms of ??(?) = ?(tfin ? t), given by\n\n(\n\nFt(w)\n\n)T\n???(?) +\n\n(\n\nFu(w)\n\n)T\n\n??(?) =\n\n(\n\n??fin ? ??ini\n)\n\n?B\n\n?w\n,\n\n??(?ini) = 0,\n\n(4.28)\n\nwhere, for simplicity\n\nFu(w) = Fs(w) +\n?Fs(w)\n\n?w\nw ? ?Fr(w)\n\n?w\n. (4.29)\n\nLet the Laplace transform of ??(?) to be expressed as\n\nL{??(?)} = ??(s). (4.30)\n\nThe Laplace transformation of each term in the Eq. (4.28) results in\n\nL\n{\n\n(\n\nFt(w)\n\n)T\n???(?)\n\n}\n\n=\n\n(\n\nFt(w)\n\n)T (\n\ns??(s) ? ??(?ini)\n)\n\n, (4.31)\n\nL\n{\n\n(\n\nFu(w)\n\n)T\n\n??(?)\n\n}\n\n=\n\n(\n\nFu(w)\n\n)T\n\n??(s), (4.32)\n\n\n\n44\n\nL\n{(\n\n??fin ? ??ini\n)\n\n?B\n\n?w\n\n}\n\n=\n\n?\n\n?\n\n0\n\ne?s?\n(\n\n??fin ? ??ini\n)\n\n?B\n\n?w\nd? =\n\n(\n\ne?s?fin ? e?s?ini\n)\n\nL\n{\n\n?B\n\n?w\n\n}\n\n.\n\n(4.33)\n\nFollowing, the inverse Laplace transform must be performed to go back to the reverse\n\ntime domain ?, which for the last term is given by\n\nL?1\n{(\n\ne?s?fin ? e?s?ini\n)\n\nL\n{\n\n?B(?)\n\n?w\n\n}}\n\n= H(???fin)\n?B(? ? ?fin)\n\n?w\n?H(???ini)\n\n?B(? ? ?ini)\n?w\n\n,\n\n(4.34)\n\nwhere H denotes the Heaviside step function, which is applied to the function B shifted\n\nby ?fin and ?ini.\n\nThe adjoint problem in Eq. (4.28) is then given by\n\n(\n\nFt(w)\n\n)T\n???(?) +\n\n(\n\nFu(w)\n\n)T\n\n??(?) = H?fin\n?B?fin\n?w\n\n? H?ini\n?B?ini\n?w\n\n,\n\n??(?ini) = 0,\n\n(4.35)\n\nwhere, for simplicity\n\nH?fin\n?B?fin\n?w\n\n? H?ini\n?B?ini\n?w\n\n= H(? ? ?fin)\n?B(? ? ?fin)\n\n?w\n? H(? ? ?ini)\n\n?B(? ? ?ini)\n?w\n\n. (4.36)\n\nThe discretisation of the adjoint system in time via backward Euler method results\n\nin\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nI 0 \u00b7 \u00b7 \u00b7 0 0\nAP (w0) AC(w1) \u00b7 \u00b7 \u00b7 0 0\n\n...\n...\n\n...\n...\n\n...\n\n0 0 \u00b7 \u00b7 \u00b7 AP (wN?1) AC(wN)\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n??0\n\n??1\n\n...\n\n??N?1\n\n??N\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n=\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n0\n\nAR(w1)\n\n...\n\nAR(wN?1)\n\nAR(wN)\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n,\n\n(4.37)\n\nwhere\n\nAP (wn) =\n\n(\n\n? Ft(wn)\n?t\n\n)T\n\n, (4.38)\n\nAC(wn) =\n\n(\n\nFt(wn)\n\n?t\n+ Fs(wn) +\n\n?Fs(wn)\n\n?wn\nwn ?\n\n?Fr(wn)\n\n?wn\n\n)T\n\n, (4.39)\n\nAR(wn) = H?fin\n?B?fin\n?wn\n\n? H?ini\n?B?ini\n?wn\n\n. (4.40)\n\n\n\n45\n\nThe solution of the system above, in terms of ??(?), is then reversed in time to obtain\n\n?(t). Therefore, the derivative of the functional J in respect to ei is now known and given\n\nby\ndJ\n\ndei\n= ?sen + ?b,ini. (4.41)\n\n4.3 Adsorption Problem Implementation\n\nSeveral open source software are available for computational fluid dynamics. Some\n\nexamples are OpenFOAM (WELLER et al., 1998), based on the Finite Volume Method\n\n(FVM); FEniCS (LOGG, 2007) and Fluidity (PIGGOTT et al., 2008), based on Finite\n\nElement Method (FEM); SU2 (PALACIOS et al., 2013), able to handle both FVM and\n\nFEM; PyFR (WITHERDEN et al., 2014), based on flux reconstruction. This work adopts\n\nFEniCS and its module Dolfin-Adjoint, which are described in this Section.\n\nFEniCS (LOGG, 2007) is open-source software focused on the automated solution\n\nof differential equations. Its form compiler (FFC) interprets a discrete form of the weak\n\nvariational equation, which is written in a high-level language similar to the mathematical\n\nsyntax, and generates a C++ code for finite element assembly conforming to the Unified\n\nForm-Assembly Code (UFC) (ALN\u00c6S et al., 2014). This process relies on the Finite\n\nElement Automatic Tabulator (FIAT) (KIRBY, 2004), which numerically builds the finite\n\nelement basis functions used by FFC. The process is concluded by combining the UFC code\n\nwith mesh and coefficient data, in order to assemble the FEM tensors. The tensors from\n\nthe resulting FEM system are given in SciPy format, enabling its solution by several linear\n\nalgebra packages. However, FEniCS offers native support to PETSc, Epetra, uBLAS and\n\nMTL4, allowing to easily specify the desired linear solvers and pre-conditioners. The\n\ncommunication between all FEniCS modules is handled by Dolfin library, providing a\n\nunified environment.\n\n4.3.1 System Decoupling Verification\n\nIt is reported by several authors (SAHOO et al., 2011; MOTA et al., 2004; VASILIEV\n\net al., 2014) that the gradient of pressure observed inside ANG tanks is very small.\n\nTherefore, the validity of decoupling the full system presented in Eq. (4.8) is assessed\n\nin this Section. Such decoupling is interesting with respect to the topology optimisation\n\nimplementation, in order to reduce the computational cost.\n\nWhen decoupling the full adsorption problem in sub-problems, each timestep is formed\n\n\n\n46\n\nby a sequence of variables updates. The decoupled solution starts with the solution of\n\nthe continuity equation to obtain the pressure (P) distribution in the domain by keeping\n\nthe temperature (T) and the adsorbed density (Q) fixed. Based on the new pressure\n\nfield, the adsorbed density is updated based on the adsorption kinetics, which does not\n\ninvolve spatial derivatives and is explicitly given by pressure and temperature. Finally,\n\nthe temperature field is obtained by solving the energy balance considering fixed pressure\n\nand adsorbed density from the previous step.\n\nThe solution of the adsorption problem is then given by\n\nW P? + Z P = F, (4.42)\n\nN T? + L T + K T = H, (4.43)\n\nwhose matrices are assembled based on the coefficients given in Appendix A.3.\n\nThe numerical implementation of such system is verified by reproducing the results\n\nobtained in Sahoo et al. (2011). The adsorption of Methane on Activated Carbon in an\n\naxisymmetric tank for the flow rates of 1 L min?1, 10 L min?1 and 30 L min?1 (volume\n\nof methane at 300 K and Patm) is considered. The domain depicted in Figure 4.1 has\n\nLo = 0.20 m, Li = 0.03 m, Ro = 0.05 m and Ri = 0.01 m. The convection heat transfer\n\ncoefficient on the wall ?W is considered to be h = 5 W m\n?2K?1. Due to axisymmetry\n\nassumptions, the simulations are based on two-dimensional domains meshed in 43 781\n\ntriangular finite elements. The material adopted are listed in Appendix B.\n\nThe maximum temperature at the center of the tank and the total mass of gas ad-\n\nsorbed for each flow rate case are presented in Figures 4.2-4.4. The plots of the evolution\n\nof the central temperature include the datasets of two experiments per each flow rate\n\nreported in Sahoo et al. (2011). It can be seen that the numerical implementation of the\n\nadsorption problem proposed in this Section approximates satisfactorily the experimental\n\nresults reported.\n\nNumerical simulations are also reported in Sahoo et al. (2011), which reinforce the\n\naccuracy of the results obtained here. The distributions of temperature inside the tanks\n\nafter each one the flow rates imposed are presented in Figure 4.5. Such distributions\n\npresent good agreement with the plots reported in the aforementioned work.\n\n\n\n47\n\nFigure 4.1: Custom axisymmetric tank domain (SAHOO et al., 2011).\n\n0 1000 2000 3000 4000 5000 6000 7000\n\nTime (s)\n\n300\n\n305\n\n310\n\n315\n\n320\n\n325\n\n330\n\nM\na\nx\nim\n\nu\nm\n\nT\nem\n\np\ner\na\ntu\nre\n\n(K\n)\n\nModel\n\nSahoo Dataset 01\n\nSahoo Dataset 02\n\n(a) Tank central temperature\n\n0 1000 2000 3000 4000 5000 6000 7000\n\nTime (s)\n\n20\n\n30\n\n40\n\n50\n\nA\nd\nso\nrb\ned\n\nG\na\ns\nM\na\nss\n\n(g\n)\n\n(b) Total adsorbed gas mass\n\nFigure 4.2: Flow rate of 1 L min?1: Comparison with the experimental results in (SA-\nHOO et al., 2011).\n\n4.3.2 Pressure Loading Verification\n\nThis Section verifies the sensitivity of adsorption cycles to the smoothness factor ?\n\ndefined in Eq. (2.35). Let consider the domain depicted in Figure 4.6, where Ri =\n\n0.05 m, Ro = 0.20 m, Lo = 1.00 m, subjected to a smooth pressure increase from Pini =\n\n0.10 MPa to Plet = 1.00 MPa in a 3600 s cycle. The temperature at the inlet region ?L\n\n\n\n48\n\n0 100 200 300 400 500 600\n\nTime (s)\n\n300\n\n310\n\n320\n\n330\n\n340\n\n350\n\n360\n\nM\na\nx\nim\n\nu\nm\n\nT\nem\n\np\ner\na\ntu\nre\n\n(K\n)\n\nModel\n\nSahoo Dataset 01\n\nSahoo Dataset 02\n\n(a) Tank central temperature\n\n0 100 200 300 400 500 600\n\nTime (s)\n\n15\n\n20\n\n25\n\n30\n\n35\n\n40\n\n45\n\nA\nd\nso\nrb\ned\n\nG\na\ns\nM\na\nss\n\n(g\n)\n\n(b) Total adsorbed gas mass\n\nFigure 4.3: Flow rate of 10 L min?1: Comparison with the experimental results in (SA-\nHOO et al., 2011).\n\n0 50 100 150 200\n\nTime (s)\n\n300\n\n310\n\n320\n\n330\n\n340\n\n350\n\n360\n\nM\na\nx\nim\n\nu\nm\n\nT\nem\n\np\ner\na\ntu\nre\n\n(K\n)\n\nModel\n\nSahoo Dataset 01\n\nSahoo Dataset 02\n\n(a) Tank central temperature\n\n0 50 100 150 200\n\nTime (s)\n\n15\n\n20\n\n25\n\n30\n\n35\n\n40\n\n45\n\nA\nd\nso\nrb\ned\n\nG\na\ns\nM\na\nss\n\n(g\n)\n\n(b) Total adsorbed gas mass\n\nFigure 4.4: Flow rate of 30 L min?1: Comparison with the experimental results in (SA-\nHOO et al., 2011).\n\nduring adsorption is kept constant and equal to the entering gas due to the local thermal\n\nequilibrium assumption with the gas entering the tank at 293 K.\n\nFigure 4.7 shows the evolution of the total gas mass inside the tank for three different\n\nvalues of ?. It can be seen that the curves are nearly coincidental after 500 s, demon-\n\nstrating a low sensitivity to the history of pressure increase at the inlet. As smoothness\n\nis decreased, the cycle approaches the case in which the pressure variation is imposed\n\n\n\n49\n\n(a) 1 L min?1 at t = 7200s\n\n(b) 10 L min?1 at t = 630 s\n\n(c) 30 L min?1 at t = 204 s\n\nFigure 4.5: Temperature distribution at the end of the adsorption cycle.\n\npromply. Figure 4.8 shows how the final total gas mass converges to this case as ? ? 0.\nTherefore, in the scope of this work, it is considered that any ? ? 0.1 (??1 ? 10) ensures\nnegligible impact to the functional of interest.\n\n4.3.3 Impermeability Verification\n\nWhen distributing a impermeable material, such as Steel, in an ANG tank, it is im-\n\nportant to ensure that gas will not flow across it. The impermeability can be numerically\n\nrepresented by assigning very low values to Ks, given that ideal impermeable media would\n\n\n\n50\n\nFigure 4.6: Adsorption domain adopted for verifying the sensitivity of adsorption cycles\nto the smoothness factor ?.\n\n0 500 1000 1500 2000 2500 3000 3500\n\nTime (s)\n\n1.5\n\n2.0\n\n2.5\n\n3.0\n\n3.5\n\n4.0\n\nT\no\nta\nl\nG\na\ns\n(k\ng\n)\n\n? = 0.01\n\n? = 0.05\n\n? = 0.10\n\nFigure 4.7: Total mass of gas along the adsorption cycle for different smoothness factors.\n\nhave Knon = 0. Consider the domain in Figure 4.9 representing a section of an axisymmet-\n\nric tank, constituted of impermeable non-adsorbent and permeable adsorbent phases. The\n\nregion ?L denotes the inlet region (Ri = 0.05 m) and ?W denotes walls subjected to heat\n\nconvection (Ro = 0.20 m and Lo = 1.00 m). The domain is subjected to a smooth pressure\n\nrise on ?L following Eq. (2.35) from Pini = 0.10 MPa to Plet with ? = 0.05. The perme-\n\nabilities of Kads = 3.67 \u00d7 10?10 m2 for Activated Carbon and Knon = 1.00 \u00d7 10?22 m2 for\nSteel are considered.\n\nFigure 4.10b demonstrates the inaccessibility of the squared Carbon region on the right\n\nto the gas for Plet = 1.00 MPa in a cycle lasting tf = 600 s. The pressure on the full right\n\n\n\n51\n\n0 20 40 60 80 100\n\n??1\n\n3.81\n\n3.82\n\n3.83\n\n3.84\n\n3.85\n\n3.86\n\n3.87\n\nT\no\nta\nl\nG\na\ns\n(k\ng\n)\n\nFigure 4.8: Smoothness factor convergence.\n\nFigure 4.9: Adsorption domain constituted by Activated Carbon and Steel.\n\nhalf of the domain stays approximately unchanged during the whole cycle, being equal to\n\nPini. The permeability of 1.00 \u00d7 10?22 has shown to be able to reproduce impermeability\neven for high pressures and long cycles. In Figure 4.10c a cycle with Plet = 8.00 MPa\n\nand tf = 3600s is considered, demonstrating that that the Carbon region on the right\n\nis still not accessed by the gas, although it permeated a slightly larger portion of Steel\n\ninsulation.\n\n\n\n52\n\n(a) Permeability divided by viscosity (Ks\u00b5\n?1\n\ng )\n\n(b) Plet = 1.00 MPa at tf = 600 s\n\n(c) Plet = 8.00 MPa at tf = 3600 s\n\nFigure 4.10: Pressure distribution on Carbon-Steel domain.\n\n4.3.4 Mesh and Timestep Convergence\n\nThe accuracy of the FEM model is dependent on the mesh and timestep resolutions\n\nadopted. The goal of this Section is to identify suitable refinement schemes for the adsorp-\n\ntion problems studied here. Let consider the domain depicted in Figure 4.11 subjected\n\nto an adsorption cycle following a smooth pressure variation from Pini = 0.10 MPa to\n\nPlet = 1.00 MPa in a 3600 s cycle with ? = 0.1.\n\nThis convergence study is based on the total gas mass intake observed in the adsorp-\n\ntion cycle, according to the functional defined in Eq. (3.6). Figure 4.12 presents the\n\nvariation in the value of such functional for different element sizes, where h\n?1\n\ndenotes the\n\ninverse of the average mesh cell diameter. Very small changes in the functional value are\n\nseen for resolutions higher than 50, implying that such value is sufficient for obtaining\n\n\n\n53\n\nFigure 4.11: Adsorption domain adopted for verifying mesh and timestep convergence.\n\naccurate results. It is important to remark that in topology optimisation problems, higher\n\nresolutions can be adopted depending on the desired complexity of the resulting topology.\n\n25 50 75 100 125 150 175 200\n\nh\n?1\n\n(m?1)\n\n2.6930\n\n2.6935\n\n2.6940\n\n2.6945\n\n2.6950\n\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\nFigure 4.12: Mesh convergence.\n\nSimilarly, the timestep adopted in the implicit Euler method for time discretisation\n\ncan influence the model accuracy. Figure 4.13 presents the total gas mass intake functional\n\nfor different timesteps ?t. It can be seen that satisfactory convergence is achieved for\n\n?t = 10 (?t?1 = 0.1).\n\n4.4 Topology Optimisation Implementation\n\nAn important aspect of topology optimisation implementation is the method of ob-\n\ntaining the sensitivities of the functional with respect to the design variables. In this\n\n\n\n54\n\n0.0 0.1 0.2 0.3 0.4 0.5\n\n?t?1 (s?1)\n\n2.688\n\n2.689\n\n2.690\n\n2.691\n\n2.692\n\n2.693\n\n2.694\n\n2.695\n\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\nFigure 4.13: Timestep convergence.\n\nwork, it is based on the solution of an adjoint problem, which is derived in Section 4.2.\n\nFigure 4.14 presents three different approaches for obtaining the adjoint code starting\n\nfrom the continuous forward equations, in the context of the FEniCS packages UFL and\n\nUFC. It can be derived by symbolic differentiation of the forward PDE, through packages\n\nsuch as SAGE (STEIN; JOYNER, 2005). The derivation can also be addressed at source\n\ncode level, treating the forward model as a sequence of elementary instructions by source-\n\nto-source compiler tool for algorithmic differentiation, such as Tapenade (HASCOET;\n\nDAUVERGNE, 2008). Another method consists in the derivation of the discrete forward\n\nequations, representing a middle-level approach that can be easily automated without de-\n\npending on low-level implementation details. This work adopts the latter approach aided\n\nby the libadjoint library (FUNKE, 2012).\n\n4.4.1 Design Variables Filtering\n\nTopology optimisation presents inherent issues such as checker-board instability and\n\nmesh dependency, which are usually mitigated by filtering the sensitivities as described\n\nin Sigmund &amp; Petersson (1998). Such method modifies the sensitivity of each design\n\nvariable based on the values of its neighbours. An alternative approach is to modify the\n\ndesign variables based on the solution of a modified Helmholtz-type PDE, as introduced\n\n\n\n55\n\nContinuous\nForward\nEquations\n\n\u2014 Symbolic Diff ??\nContinuous\nAdjoint\n\nEquations\n|\n\nUFL\n?\n\n|\nUFL\n?\n\nDiscrete\nForward\nEquations\n\n\u2014 Libadjoint ??\nDiscrete\nAdjoint\n\nEquations\n|\n\nFFC\n?\n\n|\nFFC\n?\n\nForward\nCode\n\n\u2014 Algorithmic Diff ?? Adjoint\nCode\n\nFigure 4.14: Methods for obtaining the adjoint code (FUNKE, 2012).\n\nin Lazarov &amp; Sigmund (2011), given by\n\n? z2?2e + e = e|, (4.44)\n\nwhere the distribution e| is smoothed to e, according to the filter length parameter z.\n\nThe weak form of the modified Helmholtz-type PDE is given by\n\nH =\n\n?\n\ne,vH\n\n?\n\n+\n\n?\n\nz2?e, ?vH\n?\n\n=\n\n?\n\ne|,vH\n?\n\n,\n\n?vH ? H1(?).\n(4.45)\n\nThe discrete filtering system is given by\n\nZe =e|, (4.46)\n\nwhere Z and e| are defined in Appendix A.4.\n\nWhen applying the Helmholtz filter, despite the functional and PDE systems being\n\nexpressed in terms of filtered pseudo-densities, ej, the optimisation problem is performed\n\non the field of non-filtered pseudo-densities, e|j, resulting in\n\nMaximise : Ja(e|) =\n[?\n\n?\n\n(\n\nQ(e) + ?g(e)\n\n)\n\ndx\n\n]tfin,a\n\ntini,a\n\n,\n\nsubjected to : 0 ? e| ? 1,\nM(P,T,Q) + E(P,T,Q) + D(P,T,Q) = 0,\n\n?z2?2e + e = e| .\n\n(4.47)\n\n\n\n56\n\nSuch variable change impacts functionals sensitivities. The implicit derivative of Eq.\n\n(4.46) with respect to e|j results in\n\ndZ\n\nde|j\ne + Z\n\nde\n\nde|j\n=\n\nde|\nde|j\n\n, (4.48)\n\nwhere the first term is null, given that Z is not dependent on pseudo-porosities, and the\n\nright-hand side is\nde|\nde|j\n\n= ?jk, (4.49)\n\nin which ?jk denotes the Kronecker\u2019s delta column vector, being null in all lines, except\n\nfor the j-th, which is equal to 1.\n\nThe sensitivity of the functional J to the non-filtered pseudo-porosity e|j is then given\nby\n\ndJ\n\nde|j\n=\n\n(\n\ndJ\n\nde\n\n)T\nde\n\nde|j\n=\n\n(\n\ndJ\n\nde\n\n)T\n\nZ?1?jk. (4.50)\n\n4.4.2 Optimisation Algorithm\n\nThe optimisation algorithm follows the flow represented in Figure 4.15. In the opti-\n\nmisation loop, the sensitivities are obtained via Dolfin-Adjoint (FUNKE, 2012) based on\n\nthe equilibrium equations solved on FEniCS. An optimiser receives the sensitivities and\n\noutput a new distribution of design variables, aiming to improve the functional of interest.\n\nThe relative functional variation is defined by considering the last two iterations by\n\n? =\nJit ?\n\nJit?1 + Jit?2\n2\n\nJit?1 + Jit?2\n2\n\n. (4.51)\n\nWhen the functional relative variation is non-negative and smaller than a tolerance\n\n?min or when the maximum number of iterations itmax is reached, the loop is broken. The\n\npenalisation p is then increased by ?p, following the continuation method, and the loop\n\nis restarted. This algorithm is performed until reaching the maximum penalisation pmax,\n\nwhen the final topology is defined.\n\nThe optimiser adopted in all the cases presented in this work is the limited memory\n\nBroyden-Fletcher-Goldfarb-Shanno optimiser with box constraints (L-BFGS-B) (BYRD\n\net al., 1995) implemented in scipy.optimize package (JONES et al., 2011). Optimisa-\n\ntion problems requiring volume constraints can be approached based on other optimisers\n\ncontained in this package, such as SLSQP and COBYLA, or via an IPOpt (WACHTER;\n\n\n\n57\n\nFigure 4.15: Optimisation activity diagram.\n\nBIEGLER, 2006) interface also available in Dolfin-Adjoint.\n\n4.4.3 Adjoint Sensitivites Verification\n\nThe topology optimisation relies on the accurate computation of the sensitivity of the\n\nobjective functions to the design variables. The gradients computed based on the adjoint\n\nproblem described in Section 4.2 can be verified through a Taylor remainder convergence\n\ntest. Given a reduced functional J?(m) subjected to an arbitrary perturbation ?m, the\n\nfirst-order Taylor remainder tends to zero at O(h) while the second-order tends at O(h2).\nThat means that by halving h the first-order error also halves while the second-order\n\nerror is divided by four. Taylor remainders expressions are given in Eq. (4.52). By\n\nevaluating the second-order remainder based on the ?J? obtained via adjoint approach,\nits correctness can be determined by observing O(h2) convergence.\n\n|J?(m + h?m) ? J?(m)| ? 0 at O(h),\n|J?(m + h?m) ? J?(m) ? h?J? \u00b7 ?m| ? 0 at O(h2).\n\n(4.52)\n\nDue to current Dolfin-Adjoint limitations, varying Dirichlet boundary conditions will\n\nproduce inaccurate gradients. Thus, the variation of the inlet pressure on ?L is done\n\n\n\n58\n\nthrough the Nitsche\u2019s method (JUNTUNEN; STENBERG, 2012) by\n\n?P\n\n?n\n=\n\n1\n\n?\n(Plet ? P) on ?L, (4.53)\n\nin which P ? Plet as ? ? 0.\n\nSuch condition is imposed to the system by enforcing\n\n?\n\nMgKs\nRg\u00b5g\n\nP\n\nT\n?P,vM\n\n?\n\n?N\n\n=\n\n?\n\nMgKs\nRg\u00b5g\n\nP\n\nT\n\n1\n\n?\n(Plet ? P),vM\n\n?\n\n?L\n\n. (4.54)\n\nLet consider the same cycle adopted in Section 4.3.2, with ? = 0.1, and the functional\n\nof total gas mass intake along such cycle, given by Eq. (3.6). From an initial homogeneous\n\ndistribution of design variables e = 0.5 the domain is subjected to a pseudo-random\n\nperturbation ?e scaled to different values of h as shown in Figure 4.16.\n\nFigure 4.16: Original (top) and Perturbed Pseudo-Porosity fields for (from the top)\nh = 1.00 \u00d7 10?3, h = 5.00 \u00d7 10?4, h = 2.50 \u00d7 10?5, h = 1.25 \u00d7 10?5, h = 6.25 \u00d7 10?6.\n\nTable 4.1 presents the errors for each perturbation following the first and second\n\nTaylor remainder expressions. It demonstrates the correctness of ?J? as the convergence\norder of second-order Taylor remainders are approximately 2.0.\n\nSuch verification of the sensitivities, associated with the afore presented verifications\n\nconcerning the adsorption problem, sustains the numerical implementation in all its as-\n\npects. In the following Chapter, optimisation problems are approached based on the\n\n\n\n59\n\nTable 4.1: Taylor Remainder Convergence.\n\nh Taylor Remainder Convergence Order\n\n1st Order 1.00 \u00d7 10?3 1.47 \u00d7 10?3\n\n1st Order 5.00 \u00d7 10?4 7.36 \u00d7 10?4 0.99929\n1st Order 2.50 \u00d7 10?5 3.68 \u00d7 10?4 0.99964\n1st Order 1.25 \u00d7 10?5 1.84 \u00d7 10?4 0.99982\n1st Order 6.25 \u00d7 10?6 9.21 \u00d7 10?5 0.99991\n2nd Order 1.00 \u00d7 10?3 1.43 \u00d7 10?6\n\n2nd Order 5.00 \u00d7 10?4 3.58 \u00d7 10?7 1.99989\n2nd Order 2.50 \u00d7 10?5 8.94 \u00d7 10?8 1.99996\n2nd Order 1.25 \u00d7 10?5 2.23 \u00d7 10?8 2.00007\n2nd Order 6.25 \u00d7 10?6 5.59 \u00d7 10?9 2.00013\n\nmethod derived here, resulting in several optimised adsorbent bed topologies.\n\n\n\n60\n\n5 Results and Discussion\n\nThis Chapter starts by comparing the OHT and traditional material models. There-\n\nafter, the topology optimisation method derived in this work is adopted for designing\n\nANG tanks for on-demand consumption of fuel.\n\n5.1 Definition of Standard Domains and Cycles for\n\nthe Design of ANG Tanks\n\nThe following Sections are focused on the design of ANG tanks for on-demand fuel\n\nconsumption based on the idea presented in Section 3.1, in which which non-adsorbent\n\nmaterials are distributed in the adsorbent bed. The objective function adopted is given by\n\nthe total mass intake of gas during adsorption cycles of pre-defined length, as presented\n\nin Section 3.3. The major drawback when designing these tanks is the exothermic nature\n\nof the adsorption reaction, which increases the adsorbent bed temperature and hinders\n\nreaching of the equilibrium density of adsorbed gas. Such behaviour poses several limita-\n\ntions to the range of applicability of ANG tanks and asks for some thermal management,\n\nwhich can be done passively or actively. A passive method is based merely on the heat\n\ntransfer with the environment, without the addition of any external work for cooling. In\n\nthe case of aiding the tank filling by the imposition of forced convection, cold walls or any\n\nother sort of cooling method which requires additional work, the thermal management is\n\nconsidered to be active. In the latter, exergy analyses must be done in order to quantify\n\nhow efficient is the system as a whole, although such analyses are beyond the scope of\n\nthis work.\n\nThe domains considered here represent tanks constituted by adsorbent beds wrapped\n\nby a thin sheet of metallic material subject to heat exchange through convection on its\n\nwalls, denoted by ?W . The contribution of such wall is assumed to be negligible (SAHOO\n\n\n\n61\n\net al., 2011) and it is not included in the model. In fact, being a thin metallic sheet, its\n\nBiot number (Bi) is very small and the heat conduction inside it is much faster than the\n\nheat convection away from the surface.\n\nThe domains studied here represent two-dimensional reductions of three-dimensional\n\ntanks. The first domain, presented in Table 5.1, consists in an approximation of a very\n\nlong prismatic tank with fixed cross-section. Since ANG tanks operate in a much lower\n\npressure than its CNG pairs, prismatic tanks can offer a good trade-off between stress\n\nconcentration and packing density or efficiency in space usage. Based on symmetry, only\n\none quarter of such section is optimised. The gas inlet is considered to be distant from\n\nsuch section, making the pressure homogeneous on the whole domain and, consequently,\n\nthe convective term in the energy balance null.\n\nDomain\nDimensions: L = 0.25 m\nMaterials: Appendix B\n\nCycle\nTemperatures: Tini,? = 293 K\n\nInitial Pressure: Pini = 0.10 MPa\nFinal Pressure: Plet = 1.00 MPa\n\nSmoothness: ? = 0.1, Eq.(2.35)\n\nFEM\nMesh Elements: 31 999(simplex)\n\nMesh Cell Diameter: 2.50 \u00d7 10?3 m\nTimestep: ?t = 10 s\n\nTable 5.1: Standard domain and cycle for prismatic tanks.\n\nThe second domain is presented in Table 5.2, consisting of an axisymmetric tank\n\nrepresented by its radial section. In this case, pressure gradient is observed across the\n\ndomain, originated by the gas inlet region denoted by ?L. In some of the optimisation\n\nstudies presented in this Chapter, low temperature is imposed on the region denoted by\n\n\n\n62\n\n?F .\n\nDomain\nDimensions: L = 1.00 m, R = 0.15 m\nMaterials: Appendix B\n\nCycle\nTemperatures: Tini,let,? = 293 K\n\nInitial Pressure: Pini = 0.10 MPa\nFinal Pressure: Plet = 1.00 MPa\n\nSmoothness: ? = 0.1, Eq.(2.35)\nTime Length: tfin,a = 3600 s, Fig. (3.3)\n\nFEM\nMesh Elements: 31 999 (simplex)\n\nMesh Cell Diameter: 2.50 \u00d7 10?3 m\nTimestep: ?t = 10 s\n\nTable 5.2: Standard domain and cycle for cylindrical tanks.\n\nThe third and last domain adopted in this work is presented in Table 5.3. It follows\n\nthe axisymmetry assumption but is focused on assessing the influence of complex shapes\n\non the optimisation of ANG tanks beds. Despite not modelling any specific scenario,\n\nsuch domain presents typical features observed in tanks fitted along other components in\n\nconstrained spaces. Similar to the previous domain, gas inlet occurs on the region ?L and\n\ncold temperature is imposed on ?F in some of the optimisation cases studied. As it will\n\nbe seen in the sequence of this Chapter, concave and convex corners play an important\n\nrole in the behaviour of ANG tanks, being, therefore, essential for the scope of this work.\n\n\n\n63\n\nDomain\nDimensions: R1 = 0.05 m, R2 = 0.10 m\n\nL = 0.20 m\n\nCycle\nTemperature: Tini,let,? = 293 K\n\nInitial Pressure: Pini = 0.10 MPa\nFinal Pressure: Plet = 1.00 MPa\n\nSmoothness: ? = 0.1, Eq.(2.35)\nTime Length: tfin,a = 3600 s, Fig. (3.3)\n\nFEM\nMesh Elements: 34 211 (simplex)\n\nMesh Cell Diameter: 1.63 \u00d7 10?3 m (min)\nTimestep: ?t = 10 s\n\nTable 5.3: Standard domain and cycle for a custom axisymmetric tank.\n\n\n\n64\n\n5.2 Evaluation of the OHT Material Model for the\n\nDesign of ANG Tanks\n\nThis Section is focused on studying the properties of the OHT material model. It is\n\ninitially compared with SIMP and then tested for the dependency on the initial guess and\n\npenalisation continuation when adopted in the design of ANG tanks.\n\n5.2.1 OHT vs. Traditional Material Models\n\nThe OHT material model proposed in Section 3.4.2 aims to mitigate the theoretical\n\nadvantage of intermediate materials arising from the relaxation of the optimisation prob-\n\nlem. This Section compares OHT with the traditional SIMP, emphasazing the relevance\n\nof the offset imposed to the model.\n\nThe optimisation of a prismatic tank, defined in Table 5.4 is chosen to test different\n\nmaterial models. Figure 5.1 shows the evolution of the distribution of the design variables\n\nfor three different material models. The first column is based on SIMP, in which the\n\npenalisation was continuated from p = 1 to p = 5, with ?p = 1. The central column\n\nshows the evolution for a material model based on hyperbolic tangents without an offset,\n\nexpressed by the Eq. (3.13) with ? = 0.0, in which the penalisation is continued from p = 1\n\nto p = 51, with ?p = 5. The right column shows the evolution of the same problem when\n\nan offset is defined by imposing ? = 0.02. It is important to note that the penalisation\n\ncoefficients in SIMP and OHT material models do not present a clear correlation, in a\n\nway that p = 51 in OHT does not represent, necessarily, a more penalised material model\n\nthan p = 5 in SIMP.\n\nIt can be seen that the adoption of SIMP causes the pseudo-porosity values to be near\n\ne = 0.92, given that such value offers a reasonable increase of the thermal conductivity for\n\nan adsorption capacity near the full-carbon phase. Even when very high penalisation is\n\nimposed to the material model, such anomaly will still occur around the phase transition\n\nregion. If such region is translated from e = 1.0 to e = 0.5 by adopting an hyperbolic\n\ntangent material model, the resulting evolution of the optimisation will be similar to the\n\ncentral column in Figure 5.1. Again, the values of the design variables are all concentrated\n\naround the phase transition region, taking advantage from the desired properties from\n\neach phase. In this optimisation problem, the offset tangents material model, presented\n\nin the third column, is the only one able to avoid unfeasible intermediate properties and\n\ndefine a clear topology. In this last case, as the penalisation increases the intermediate\n\n\n\n65\n\npseudo-porosity of e = 0.5 becomes increasingly less advantageous for the functional of\n\ninterest.\n\nFigure 5.2 complements the points aforementioned by presenting the convergence of\n\neach one of the optimisations performed. Each drop seen in the curves are due to the\n\nincrease of the penalisation, following the continuation scheme adopted. In SIMP and non-\n\noffset hyperbolic tangents material models, a theoretical maximum based on unfeasible\n\nmaterials is carried along the iterations, unaffected by the penalisation increase. In the\n\ncase of OHT, the functional value decreases along the iterations as it recovers the binary\n\nnature of the problem as the penalisation is increased.\n\nPrismatic Tank\n(Table 5.1)\n\nDomain\nHeat Convection: h?W = 100 Wm\n\n?2K?1\n\nCycle\nTime Length: tfin,a = 10 800 s, Fig. (3.3)\n\nOptimisation\nIterations per Step: itmax = 20\n\nTolerance: ?min = 1.0 \u00d7 10?6\nFilter Radius: z = 5 \u00d7 10?3 m, Eq.(4.44)\n\nTable 5.4: Optimisation definitions for a prismatic tank subjected to forced convection.\n\n\n\n66\n\nFigure 5.1: Pseudo-porosity fields evolution (top-down) for SIMP (left), non-offset hy-\nperbolic tangents (centre) and offset hyperbolic tangents (right) material models for pris-\nmatic tank optimisation.\n\n\n\n67\n\n0 20 40 60 80 100 120\n\nFunctional Evaluations\n\n1.15\n\n1.20\n\n1.25\n\n1.30\n\n1.35\n\n1.40\n\n1.45\n\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\n(a) SIMP\n\n0 50 100 150 200\n\nFunctional Evaluations\n\n1.15\n\n1.20\n\n1.25\n\n1.30\n\n1.35\n\n1.40\n\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\n(b) Non-offset hyperbolic tangents\n\n0 50 100 150 200\n\nFunctional Evaluations\n\n1.10\n\n1.15\n\n1.20\n\n1.25\n\n1.30\n\n1.35\n\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\n(c) Offset hyperbolic tangents\n\nFigure 5.2: Functional convergence for different material models.\n\n\n\n68\n\n5.2.2 Dependency on the Initial Guess and Penalisation\n\nTopology optimisation problems are non-convex and often lead to different solutions\n\ndepending on the initial guess and on the strategy adopted for the penalisation contin-\n\nuation on the OHT material model. This Section is limited to the numerical study of\n\nsuch dependency, while the subsequent Sections are focused on the actual design of ANG\n\ntanks.\n\nLet consider the optimisation of the prismatic tank defined in Table 5.5. Figure 5.3\n\ndemonstrates the independency of the final topology with respect to the initial guess. The\n\nevolution of the optimisation starting from an homogeneous pseudo-porosity distribution\n\ne = 0.5 is shown on the left column while one starting from an arbitrary initial guess is\n\nshown on the right. In both cases, the distribution of pseudo-porosities goes towards a full-\n\ncarbon domain during the first optimisation iterations, following an identical evolution\n\nafter that toward the same final layout. The optimisation of this tank is resumed in\n\nSection 5.4.1, where a thorough analysis is presented.\n\nPrismatic Tank\n(Table 5.1)\n\nDomain\nHeat Convection: h?W = 100 Wm\n\n?2K?1\n\nCycle\nTime Length: tfin,a = 10 800 s, Fig. (3.3)\n\nOptimisation\nMaterial Model: ? = 0.02, Eq. (3.13)\n\np = [1, 51], ?p = 5\nIterations per Step: itmax = 20\n\nTolerance: ?min = 1.0 \u00d7 10?6\nFilter Radius: z = 5 \u00d7 10?3 m, Eq.(4.44)\n\nTable 5.5: Optimisation definitions for a prismatic tank subjected to forced convection.\n\nThe cylindrical tank optimisation presented in Table 5.6 is ran from a material model\n\nwhich is already significantly penalised (pini = 20). In this case, different initial guesses\n\nresult in different final layouts as seen in Figure 5.4, where the distributions on the top\n\nof each block show the evolution of the homogeneous initial guess, while the bottom ones\n\nrefers to an arbitrary initial distribution of pseudo-porosity. Despite the different layouts\n\nobtained for each case, the final objective function values are very similar: 2.31 kg of total\n\n\n\n69\n\nFigure 5.3: Pseudo-porosity fields evolution for homogeneous (left) and arbitrary (right)\ninitial guesses for prismatic tank optimisation starting with pini = 1.\n\n\n\n70\n\ngas intake for the homogeneous initial guess and 2.28 kg for the arbitrary.\n\nCylindrical Tank\n(Table 5.2)\n\nDomain\nMaterials: Cpnon = 1880 J kg\n\n?1K?1\n\nHeat Convection: h(?W ??F ) = 5 W m\n?2K?1\n\nCycle\nTime Length: tfin,a = 3600 s, Fig. (3.3)\n\nOptimisation\nMaterial Model: ? = 0.02, Eq. (3.13)\n\np = [20, 100], ?p = 10\nIterations per Step: itmax = 10\n\nTolerance: ?min = 1.0 \u00d7 10?6\nFilter Radius: z = 5 \u00d7 10?3 m, Eq.(4.44)\n\nTable 5.6: Optimisation definitions for a cylindrical domain with non-adsorbent material\nwith high heat capacity.\n\nThe dependence of the final layouts on the initial guesses can be mitigated by follow-\n\ning a continuation approach starting from a material model presenting low penalisation.\n\nFigure 5.5 shows the evolution of the pseudo-porosity distribution for an optimisation\n\nstarting with penalisation pini = 1. Similar to the prismatic case, shown in Figure 5.3,\n\nthe initial optimisation steps take the pseudo-porosities to a full-carbon distribution, fol-\n\nlowing the same evolution from then on. The final layout for this case results in a total\n\ngas intake of 2.30 kg, which is very similar to the 2.31 kg observed for the case starting the\n\npenalisation from pini = 20. This particular case also highlights the non-convexity of such\n\noptimisation problem, where a particular distribution of pseudo-porosities in a moderately\n\npenalised material model complies the objective function better than a less penalised one\n\nfollowing a smooth continuation. The optimisation of this tank is approached in detail in\n\nSection 5.3.3.\n\n5.3 Design of ANG Tanks with Passive Thermal Man-\n\nagement\n\nIn this Section, tanks filled without the aid of any external work for managing the\n\ntemperature of the adsorbent bed are studied.\n\n\n\n71\n\nFigure 5.4: Pseudo-porosity fields evolution for homogeneous (top image on each block)\nand arbitrary (bottom) initial guesses for cylindrical tank optimisation starting with pini =\n20.\n\n\n\n72\n\nFigure 5.5: Pseudo-porosity fields evolution for homogeneous (top image on each block)\nand arbitrary (bottom) initial guesses for cylindrical tank optimisation starting with pini =\n1.\n\n\n\n73\n\n5.3.1 Tanks Subjected to Natural Convection\n\nThe optimisation of a cylindrical tank subjected to natural convectionis is defined in\n\n5.7. It starts from an homogeneous distribution of the design variables at e = 0.5 and the\n\npenalisation is smoothly increased from pini = 20 to pmax = 100, following the flowchart\n\nshown in Figure 4.15 with itmax = 10 and ?min = 1.0 \u00d7 10?6. The pseudo-porosity\ndistribution is subjected to Helmholtz filtering with radius z = 5 \u00d7 10?3, which is equal\nto the double of the characteristic mesh cell diameter.\n\nIn Figure 5.6, the resulting topology is shown along with its three-dimensional rev-\n\nolution. The distribution of the pseudo-porosities obtained from the optimiser is shown\n\nin Figure 5.6a, where the colour scale ranges from grey, representing Steel (e = 0.0), to\n\nblack, representing Activated Carbon (e = 1.0). Given the properties of the material\n\nmodel adopted, the interpretation of binary distribution of materials inside the domain is\n\nmade on the 0.5 threshold. Figure 5.6b shows the convergence of the objective function,\n\nwhich presents a very smooth behaviour. The total density of gas, that is, the sum of\n\ngaseous and adsorbed phase density, is shown in Figure 5.6c for a domain fully occupied\n\nby Carbon (e = 1.0) and for the optimised distribution of Steel. It can be seen that the\n\ngas inlet was reduced approximately in 3/4 in order to allow the growth of a metallic\n\nregion along the center of tank extending the zone of high density of gas adsorbed, which\n\nwas before limited to the inlet neighbourhood. It is due to the fact that the gas enter-\n\ning the domain is at room temperature (293 K) and creates a region of low temperature,\n\nwhich was extended because of the higher thermal conductivity of the Steel in relation\n\nto Activated Carbon, as shown in the temperature distribution plotted in Figure 5.6d.\n\nHowever, the increase of the gas density in this zone comes with the loss of adsorbent\n\nvolume, as detailed in Section 3.1, making the net gain in the total mass of gas admitted\n\nbeing only 1.06%.\n\n\n\n74\n\nCylindrical Tank\n(Table 5.2)\n\nDomain\nHeat Convection: h(?W ??F ) = 5 W m\n\n?2K?1\n\nCycle\nTime Length: tfin,a = 10 800 s, Fig. (3.3)\n\nOptimisation\nMaterial Model: ? = 0.02, Eq. (3.13)\n\np = [20, 100], ?p = 10\nIterations per Step: itmax = 10\n\nTolerance: ?min = 1.0 \u00d7 10?6\nFilter Radius: z = 5 \u00d7 10?3 m, Eq.(4.44)\n\nTable 5.7: Optimisation definitions for a cylindrical domain subjected to natural con-\nvection.\n\n\n\n75\n\n(a) Pseudo-porosity distribution\n\n0 20 40 60 80 100 120\n\nFunctional Evaluations\n\n2.00\n\n2.05\n\n2.10\n\n2.15\n\n2.20\n\n2.25\n\n2.30\n\n2.35\n\n2.40\n\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\n(b) Funtional convergence\n\n(c) Total gas of homogeneous and optimised\ntanks at tfin\n\n(d) Temperature of homogeneous and opti-\nmised tanks at tfin\n\nJa Homogenous Ja Optimised Improvement\n2.30 kg 2.32 kg 1.06%\n\nFigure 5.6: Optimised design for a cylindrical domain subjected to natural convection.\n\n\n\n76\n\n5.3.2 Sensitivity to Thermal Conductivity\n\nThe non-adsorbent material considered when designing ANG tanks is not restricted\n\nto Steel only. Other metals with higher thermal conductivity, such as Aluminium, may\n\nbe suitable in some cases. Aiming to verify that, a hypothetical material presenting\n\nconductivity four times higher than Steel is considered in the cycle defined in Table\n\n5.8. Figure 5.7 shows a clear increase in the complexity of the metallic region connected\n\nto the inlet. Besides advancing further along the domain, this region presents more and\n\nthinner legs when compared to the optimisation performed with standard Steel properties\n\n- Figure 5.6. A new non-adsorbent region is also created from the wall opposite to the gas\n\ninlet, which would not compensate the loss in volume in the previous case. Figure 5.7d\n\nshows a clear reduction of the overall temperature within the domain, resulting in a net\n\ngain of 2.13% in the total mass of gas admitted. Therefore, the increase of the thermal\n\nconductivity of the non-adsorbent material has a positive impact on the optimisation of\n\nthe ANG tanks considered in this work.\n\nCylindrical Tank\n(Table 5.2)\n\nDomain\nMaterials: knon = 188 Wm\n\n?2K?1\n\nHeat Convection: h(?W ??F ) = 5 W m\n?2K?1\n\nCycle\nTime Length: tfin,a = 10 800 s, Fig. (3.3)\n\nOptimisation\nMaterial Model: ? = 0.02, Eq. (3.13)\n\np = [20, 100], ?p = 10\nIterations per Step: itmax = 10\n\nTolerance: ?min = 1.0 \u00d7 10?6\nFilter Radius: z = 5 \u00d7 10?3 m, Eq.(4.44)\n\nTable 5.8: Optimisation definitions for a cylindrical domain with non-adsorbent material\nwith high thermal conductivity.\n\n\n\n77\n\n(a) Pseudo-porosity distribution\n\n0 20 40 60 80 100 120\n\nFunctional Evaluations\n\n2.00\n\n2.05\n\n2.10\n\n2.15\n\n2.20\n\n2.25\n\n2.30\n\n2.35\n\n2.40\n\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\n(b) Functional convergence\n\n(c) Total gas in homogeneous and optimised\ntanks at tfin\n\n(d) Temperature in homogeneous and opti-\nmised tanks at tfin\n\nJa Homogenous Ja Optimised Improvement\n2.30 kg 2.35 kg 2.13%\n\nFigure 5.7: Optimised design for a cylindrical domain with non-adsorbent material with\nhigh thermal conductivity.\n\n\n\n78\n\n5.3.3 Sensitivity to Heat Capacity\n\nExtending the previous Section, the impact of the increase of the heat capacity of the\n\nnon-adsorbent material is studied here. Materials presenting enough high heat capacity\n\ncan be used to roughly approximate the impact of the insertion of Phase Change Materials\n\n(PCM) regions inside the domain - see Toledo et al. (2013) for more details about PCM\n\noperation. The specific heat capacity of Steel is multiplied by four, resulting in the\n\nproblem defined in Table 5.9. Figure 5.8 shows the resulting topology for this case, where\n\nthe non-adsorbent regions are not necessarily connected to the gas inlet or to the walls.\n\nThe occurrence of this layout is due to the fact that materials with high heat capacity act\n\nas heat sinks. This approach seems more promising than using high conductive materials\n\nas it is reflected in the high gas density through the whole domain observed in Figure 5.8c.\n\nIn the comparison with the homogeneous case, the the amount of gas admitted during\n\nthe filling cycle is 6.30% higher when compared with the domain filled with Carbon only.\n\nThe relative gain is even higher for shorter cycles. Table 5.10 defines a cycle lasting\n\n3600 s, keeping all the other parameters the same. It can be seen in Figure 5.9 that more\n\nnon-adsorbent islands were formed in order to take advantage of its high heat capacity.\n\nSuch islands represent hoops as depicted in the revolved three-dimensional topology. It\n\nis important to highlight that this optimised domain admits more gas in 3600 s (2.31 kg)\n\nthan the homogeneous does in 10 800 s (2.30 kg). This fact makes the use materials with\n\nhigh heat capacity very promising in fast-filling ANG tanks. Table 5.11 defines an even\n\nshorter cycle of 1200 s. In Figure 5.10, it can be seen that the non-adsorbent islands\n\nbecomes smaller and are located nearer the axis of symmetry, in order to reduce the loss in\n\nadsorbent volume. However, the improvement is much smaller than on the previous ones:\n\n2.89%. In this case, the cooling effect is constrained by the poor thermal conductivity\n\nof the Activated Carbon, given that the cycle is very short. That is, the non-adsorbent\n\nislands posses a very small radius of influence around them, as can be clearly seen in\n\nFigure 5.10d.\n\n\n\n79\n\nCylindrical Tank\n(Table 5.2)\n\nDomain\nMaterials: Cpnon = 1880 Jkg\n\n?1K?1\n\nHeat Convection: h(?W ??F ) = 5 W m\n?2K?1\n\nCycle\nTime Length: tfin,a = 10 800 s, Fig. (3.3)\n\nOptimisation\nMaterial Model: ? = 0.02, Eq. (3.13)\n\np = [20, 100], ?p = 10\nIterations per Step: itmax = 10\n\nTolerance: ?min = 1.0 \u00d7 10?6\nFilter Radius: z = 5 \u00d7 10?3 m, Eq.(4.44)\n\nTable 5.9: Optimisation definitions for a cylindrical domain with non-adsorbent material\nwith high heat capacity.\n\nCylindrical Tank\n(Table 5.2)\n\nDomain\nMaterials: Cpnon = 1880 Jkg\n\n?1K?1\n\nHeat Convection: h(?W ??F ) = 5 W m\n?2K?1\n\nCycle\nTime Length: tfin,a = 3600 s, Fig. (3.3)\n\nOptimisation\nMaterial Model: ? = 0.02, Eq. (3.13)\n\np = [20, 100], ?p = 10\nIterations per Step: itmax = 10\n\nTolerance: ?min = 1.0 \u00d7 10?6\nFilter Radius: z = 5 \u00d7 10?3 m, Eq.(4.44)\n\nTable 5.10: Optimisation definitions for a cylindrical domain with non-adsorbent mate-\nrial with high heat capacity in 3600 s filling cycle.\n\n\n\n80\n\n(a) Pseudo-porosity distribution\n\n0 20 40 60 80 100 120\n\nFunctional Evaluations\n\n2.0\n\n2.1\n\n2.2\n\n2.3\n\n2.4\n\n2.5\n\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\n(b) Functional convergence\n\n(c) Total gas in homogeneous and optimised\ntanks at tfin\n\n(d) Temperature in homogeneous and opti-\nmised tanks at tfin\n\nJa Homogenous Ja Optimised Improvement\n2.30 kg 2.44 kg 6.30%\n\nFigure 5.8: Optimised design for a cylindrical domain with non-adsorbent material with\nhigh heat capacity.\n\n\n\n81\n\n(a) Pseudo-porosity distribution\n\n0 20 40 60 80 100 120\n\nFunctional Evaluations\n\n1.4\n\n1.6\n\n1.8\n\n2.0\n\n2.2\n\n2.4\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\n(b) Functional convergence\n\n(c) Total gas in homogeneous and optimised\ntanks at tfin\n\n(d) Temperature in homogeneous and opti-\nmised tanks at tfin\n\nJa Homogenous Ja Optimised Improvement\n2.10 kg 2.31 kg 10.20%\n\nFigure 5.9: Optimised design for a cylindrical domain with non-adsorbent material with\nhigh heat capacity in 3600 s filling cycle.\n\n\n\n82\n\nCylindrical Tank\n(Table 5.2)\n\nDomain\nMaterials: Cpnon = 1880 Jkg\n\n?1K?1\n\nHeat Convection: h(?W ??F ) = 5 W m\n?2K?1\n\nCycle\nTime Length: tfin,a = 1200 s, Fig. (3.3)\n\nOptimisation\nMaterial Model: ? = 0.02, Eq. (3.13)\n\np = [20, 100], ?p = 10\nIterations per Step: itmax = 10\n\nTolerance: ?min = 1.0 \u00d7 10?6\nFilter Radius: z = 5 \u00d7 10?3 m, Eq.(4.44)\n\nTable 5.11: Optimisation definitions for a cylindrical domain with non-adsorbent mate-\nrial with high heat capacity in 1200 s filling cycle.\n\n\n\n83\n\n(a) Pseudo-porosity distribution\n\n0 20 40 60 80 100 120\n\nFunctional Evaluations\n\n1.6\n\n1.7\n\n1.8\n\n1.9\n\n2.0\n\n2.1\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\n(b) Functional convergence\n\n(c) Total gas in homogeneous and optimised\ntanks at tfin\n\n(d) Temperature in homogeneous and opti-\nmised tanks at tfin\n\nJa Homogenous Ja Optimised Improvement\n2.01 kg 2.07 kg 2.89%\n\nFigure 5.10: Optimised design for a cylindrical domain with non-adsorbent material\nwith high heat capacity in 1200 s filling cycle.\n\n\n\n84\n\n5.4 Design of ANG Tanks with Active Thermal Man-\n\nagement\n\nThis Section considers tanks filled with the aid of some external work for the thermal\n\nmanagement, such as the imposition of forced convection or low temperature at some\n\npoint of the domain. The latter approach is adopted in Vasiliev et al. (2014), where fins\n\nlinked to a very cold wall, at 233 K, are distributed radially along an adsorbent cylinder.\n\n5.4.1 Tanks Subjected to Forced Convection\n\nThe resulting topology depicted in Figure 5.11 shows perfectly symmetric fins con-\n\nnecting the central region of the section to the walls subjected to forced convection. Such\n\nsymmetry is due to the use of a regular mesh constituted by equal elements. Figure 5.11d\n\nshows that the fins made the maximum temperature inside the domain drop from 325 K\n\nto 310 K, allowing 5.46% more gas to be admitted during the filling cycle. An instability\n\nis seen on Figure 5.11b for the convergence of the objective function due to the increase\n\nof the penaliser from pini = 20 to p = 30.\n\nPrismatic Tank\n(Table 5.1)\n\nDomain\nHeat Convection: h?W = 100 Wm\n\n?2K?1\n\nOptimisation\nMaterial Model: ? = 0.02\n\np = [1, 51], ?p = 5, Eq. (3.13)\nIterations per Step: itmax = 20\n\nTolerance: ?min = 1.0 \u00d7 10?6\nFilter Radius: z = 5 \u00d7 10?3 m, Eq.(4.44)\n\nTable 5.12: Optimisation definitions for a prismatic domain subjected to forced convec-\ntion.\n\n\n\n85\n\n(a) Pseudo-porosity distribution\n0 20 40 60 80 100 120\n\nFunctional Evaluations\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\n1.2\n\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\n(b) Functional convergence\n\n(c) Total gas in homogeneous and optimised\ntanks at tfin\n\n(d) Temperature in homogeneous and opti-\nmised tanks at tfin\n\nJa Homogenous Ja Optimised Improvement\n1.16 kg 1.22 kg 5.46%\n\nFigure 5.11: Optimised design for a prismatic domain subjected to forced convection.\n\n\n\n86\n\n5.4.2 Sensitivity to Forced Convection and Cold Walls\n\nIn order to study the impact of different thermal boundary conditions, the complex-\n\nshaped axisymmetric domain defined in 5.3 is adopted. Initially, forced convection is\n\nconsidered by imposing h = 100 Wm?1K?1, as defined in Table 5.13. The resulting\n\ntopology shown in Figure 5.12 presents the trend of growing Steel fins from concave\n\ncorners. Such behaviour is justified by the temperature distribution in the homogeneous\n\ncase observed in Figure 5.12d. These corners are the regions with steepest temperature\n\ngradient from points on the wall towards the inside of the domain. Accordingly, the curved\n\nshape acquired by the fins coincide almost perfectly with the path of maximum gradient.\n\nBased on this approach, the optimised domain is able to admit 1.23% more gas than the\n\nhomogeneous one. By increasing the convective coefficient to h = 700 Wm?1K?1, small\n\nchanges are observed. The most prominent change in the topology shown in Figure 5.12\n\nis the fork of one of the fins. However, a very reticent relative gain is obtained in relation\n\nto the first case: 1.94% in total gas mass admitted. Therefore, the energy required to\n\nincrease the convective heat transfer in the second case is reasonable. The case defined\n\nin Table 5.15 keeps the natural convection on the walls expect for the region ?F , which\n\nis kept at the fixed temperature of 273 K. As seen in Figure 5.14, the low temperature\n\nmakes the corners on ?F preferred for the creation of fins. In Figure 5.14c, it can be clearly\n\nseen that the vicinity of the fins connected to the cold wall becomes the zone presenting\n\nthe highest densities of gas, improving the total gas admission during the filling cycle in\n\n7.51% when compared to the homogeneous case.\n\n\n\n87\n\nCustom Axisymmetric Tank\n(Table 5.3)\n\nDomain\nHeat Convection: h(?W ??F ) = 100 W m\n\n?2K?1\n\nCycle\nTime Length: tfin,a = 3600 s, Fig. (3.3)\n\nOptimisation\nMaterial Model: ? = 0.02, Eq. (3.13)\n\np = [20, 100], ?p = 10\nIterations per Step: itmax = 10\n\nTolerance: ?min = 1.0 \u00d7 10?6\nFilter Radius: z = 5 \u00d7 10?3 m, Eq.(4.44)\n\nTable 5.13: Optimisation definitions for a custom axisymmetric domain subjected to\nforced convection with h = 100 Wm?2K?1.\n\nCustom Axisymmetric Tank\n(Table 5.3)\n\nDomain\nHeat Convection: h(?W ??F ) = 700 W m\n\n?2K?1\n\nCycle\nTime Length: tfin,a = 3600 s, Fig. (3.3)\n\nOptimisation\nMaterial Model: ? = 0.02, Eq. (3.13)\n\np = [20, 100], ?p = 10\nIterations per Step: itmax = 10\n\nTolerance: ?min = 1.0 \u00d7 10?6\nFilter Radius: z = 5 \u00d7 10?3 m, Eq.(4.44)\n\nTable 5.14: Optimisation definitions for a custom axisymmetric domain subjected to\nforced convection with h = 700 Wm?2K?1.\n\n\n\n88\n\n(a) Pseudo-porosity distribution\n0 20 40 60 80 100 120\n\nFunctional Evaluations\n\n0.8\n\n1.0\n\n1.2\n\n1.4\n\n1.6\n\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\n(b) Functional convergence\n\n(c) Total gas in homogeneous and optimised\ntanks at tfin\n\n(d) Temperature in homogeneous and opti-\nmised tanks at tfin\n\nJa Homogenous Ja Optimised Improvement\n1.58 kg 1.60 kg 1.23%\n\nFigure 5.12: Optimised design for a custom axisymmetric domain subjected to forced\nconvection with h = 100 Wm?2K?1.\n\n\n\n89\n\n(a) Pseudo-porosity distribution 0 20 40 60 80 100 120\nFunctional Evaluations\n\n0.8\n\n1.0\n\n1.2\n\n1.4\n\n1.6\n\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\n(b) Functional convergence\n\n(c) Total gas in homogeneous and optimised\ntanks at tfin\n\n(d) Temperature in homogeneous and opti-\nmised tanks at tfin\n\nJa Homogenous Ja Optimised Improvement\n1.59 kg 1.62 kg 1.94%\n\nFigure 5.13: Optimised design for a custom axisymmetric domain subjected to forced\nconvection with h = 700 Wm?2K?1.\n\n\n\n90\n\nCustom Axisymmetric Tank\n(Table 5.3)\n\nDomain\nHeat Convection: h?W = 5 Wm\n\n?2K?1\n\nCold Finger: T?F = 273 K\n\nCycle\nTime Length: tfin,a = 3600 s, Fig. (3.3)\n\nOptimisation\nMaterial Model: ? = 0.02, Eq. (3.13)\n\np = [20, 100], ?p = 10\nIterations per Step: itmax = 10\n\nTolerance: ?min = 1.0 \u00d7 10?6\nFilter Radius: z = 5 \u00d7 10?3 m, Eq.(4.44)\n\nTable 5.15: Optimisation definitions for a custom axisymmetric domain subjected to\nnatural convection and connected to a cold finger.\n\n\n\n91\n\n(a) Pseudo-porosity distribution 0 20 40 60 80 100 120\nFunctional Evaluations\n\n1.0\n\n1.1\n\n1.2\n\n1.3\n\n1.4\n\n1.5\n\n1.6\n\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\n(b) Functional convergence\n\n(c) Total gas in homogeneous and optimised\ntanks at tfin\n\n(d) Temperature in homogeneous and opti-\nmised tanks at tfin\n\nJa Homogenous Ja Optimised Improvement\n1.42 kg 1.52 kg 7.51%\n\nFigure 5.14: Optimised design for a cylindrical domain with forced convection.\n\n\n\n92\n\n5.4.3 Sensitivity to Shape Complexity\n\nThe cases tested in the previous Section are repeated for a cylindrical tank, in order\n\nto identify the contribution of the external shape complexity to the optimisation. Forced\n\nconvection is imposed on the cylindrical tank, as defined in Table 5.16. As seen in Figure\n\n5.15, such convection urges the appearance of metallic fins on the wall opposite to the\n\ninlet. The main reason for such fins appearing there is the adiabatic condition imposed\n\non the bottom line due to the axisymmetry. In the temperature distribution shown for\n\nthe homogeneous case in Figure 5.15d it can be seen that the axisymmetry makes the\n\ngradient along the bottom line near the walls to be the steepest.\n\nBy shortening the cycle defined in Table 5.16 to 3600 s, the volume occupied by the\n\nfins are slight smaller, although maintaining the roughly the same layout. The fins on\n\nthe middle of the vertical walls are longer because the gradient of temperature there is\n\napproximately the same of the one observed on the bottom line for a short cycle, as shown\n\nin Figure 5.16d.\n\nKeeping natural convection on the short cycle and imposing a cold region on ?F\n\nresults in the topology shown in Figure 5.17. The presence of such condition stimulate\n\nthe grow of fins from ?F and leads to a net gain in the mass of gas admitted of 2.47%.\n\nCylindrical Tank\n(Table 5.2)\n\nDomain\nHeat Convection: h(?W ??F ) = 700 W m\n\n?2K?1\n\nCycle\nTime Length: tfin,a = 10 800 s, Fig. (3.3)\n\nOptimisation\nMaterial Model: ? = 0.02, Eq. (3.13)\n\np = [20, 100], ?p = 10\nIterations per Step: itmax = 10\n\nTolerance: ?min = 1.0 \u00d7 10?6\nFilter Radius: z = 5 \u00d7 10?3 m, Eq.(4.44)\n\nTable 5.16: Optimisation definitions for a cylindrical domain with forced convection in\n10 800s filling cycle.\n\n\n\n93\n\n(a) Pseudo-porosity distribution\n\n0 20 40 60 80 100 120\n\nFunctional Evaluations\n\n1.6\n\n1.8\n\n2.0\n\n2.2\n\n2.4\n\n2.6\n\n2.8\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\n(b) Functional convergence\n\n(c) Total gas in homogeneous and optimised\ntanks at tfin\n\n(d) Temperature in homogeneous and opti-\nmised tanks at tfin\n\nJa Homogenous Ja Optimised Improvement\n2.49 kg 2.52 kg 1.32%\n\nFigure 5.15: Optimised design for a cylindrical domain with forced convection in 10 800 s\nfilling cycle.\n\n\n\n94\n\nCylindrical Tank\n(Table 5.2)\n\nDomain\nHeat Convection: h(?W ??F ) = 700 W m\n\n?2K?1\n\nCycle\nTime Length: tfin,a = 3600 s, Fig. (3.3)\n\nOptimisation\nMaterial Model: ? = 0.02, Eq. (3.13)\n\np = [20, 100], ?p = 10\nIterations per Step: itmax = 10\n\nTolerance: ?min = 1.0 \u00d7 10?6\nFilter Radius: z = 5 \u00d7 10?3 m, Eq.(4.44)\n\nTable 5.17: Optimisation definitions for a cylindrical domain with forced convection in\n3600 s filling cycle.\n\nCylindrical Tank\n(Table 5.2)\n\nDomain\nHeat Convection: h?W = 5 Wm\n\n?2K?1\n\nCold Finger: T?F = 273 K\n\nCycle\nTime Length: tfin,a = 3600 s, Fig. (3.3)\n\nOptimisation\nMaterial Model: ? = 0.02, Eq. (3.13)\n\np = [20, 100], ?p = 10\nIterations per Step: itmax = 10\n\nTolerance: ?min = 1.0 \u00d7 10?6\nFilter Radius: z = 5 \u00d7 10?3 m, Eq.(4.44)\n\nTable 5.18: Optimisation definitions for a cylindrical domain subjected to natural con-\nvection and connected to a cold finger.\n\n\n\n95\n\n(a) Pseudo-porosity distribution\n\n0 20 40 60 80 100 120\n\nFunctional Evaluations\n\n1.6\n\n1.8\n\n2.0\n\n2.2\n\n2.4\n\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\n(b) Functional convergence\n\n(c) Total gas in homogeneous and optimised\ntanks at tfin\n\n(d) Temperature in homogeneous and opti-\nmised tanks at tfin\n\nJa Homogenous Ja Optimised Improvement\n2.29 kg 2.32 kg 1.31%\n\nFigure 5.16: Optimised design for a cylindrical domain with forced convection in 3600 s\nfilling cycle.\n\n\n\n96\n\n(a) Pseudo-porosity distribution\n\n0 20 40 60 80 100 120\n\nFunctional Evaluations\n\n1.80\n\n1.85\n\n1.90\n\n1.95\n\n2.00\n\n2.05\n\n2.10\n\n2.15\n\n2.20\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\n(b) Functional convergence\n\n(c) Total gas in homogeneous and optimised\ntanks at tfin\n\n(d) Temperature in homogeneous and opti-\nmised tanks at tfin\n\nJa Homogenous Ja Optimised Improvement\n2.10 kg 2.16 kg 2.47%\n\nFigure 5.17: Optimised design for a cylindrical domain with natural convection and\ncold finger.\n\n\n\n97\n\n5.4.4 Sensitivity to Tank Dimensions\n\nPrismatic tanks with different sizes of cross section are optimised aiming to evaluate\n\nthe sensitivity of the method to tank dimensions. The optimisation of the narrow tanks\n\ndefined in Table 5.20 is performed with the proportional reduction of the Helmholtz filter\n\nradius. In the resulting topology presented in Figure 5.18, it is seen a smaller penetration\n\nof the fins towards the center of the domain. However, the distance between the tips\n\nof opposite fins are barely the same when compared to the optimised topology for the\n\nanalogous 0.25 m tank presented in Figure 5.11. This distance is determined by Activated\n\nCarbon heat conduction. Figure 5.18c shows very small gradients in the distribution of\n\ngas density when compared to the 0.25 m reference. While in the homogeneous reference\n\nthe minimal density observed is 24.74 kg, here it is 29.47 kg, making the loss of adsorbent\n\nvolume to fins less advantageous. In fact, the improvement of gas intake is much smaller\n\nin the small domain: 0.39 kg.\n\nTable 5.19 defines a large prismatic tank, with the proportional increase of the Helmholtz\n\nradius filter. The resulting topology shown in Figure 5.19 presents many more fins than\n\nin the smaller tanks. The pseudo-porosity distribution in Figure 5.19a shows the forma-\n\ntion of perfect squared region on the middle of the domain where the value of the design\n\nvariables is very near to e = 1.0. The grey margin presents a thickness of approximately\n\n0.12 m, suggesting that beyond this point the loss in volume for fins is not compensatory.\n\nIt can be seen in Figure 5.19b that many pseudo-porosity distributions were rejected by\n\nL-BFGS-B while the penalisation was weak, evolving to a smooth convergence for higher\n\npenalisation. Figure 5.19c makes clear that little improvement could be achieved in the\n\ncentral tank region. The focus of the optimisation was to adsorb more gas near the\n\nwalls, leaving the central region almost unchanged. The improvement in the mass of gas\n\nadmitted is roughly equivalent to the gain presented for the 0.25 m reference: 5.54%.\n\n5.4.5 Sensitivity to Filling Pressure\n\nThe optimisation of ANG tanks are highly dependent on its filling pressure. Aiming to\n\ndemonstrate the topology changes caused by the pressure increase, the problem described\n\nis Table 5.13 is used as reference. By increasing the filling pressure from 1.00 MPa to\n\n3.00 MPa, the topology shown in Figure 5.20 is obtained. In contrast to the resulting\n\ntopology for 1.00 MPa, it can be seen that the higher gas flow rate is enough to cool\n\ndown a large area around the inlet. Therefore, fins connected to the inlet region are less\n\ninteresting in this case, given that a large volume of cold adsorbent would be lost. Fins\n\n\n\n98\n\nPrismatic Tank\n(Table 5.1)\n\nDomain\nDimensions: L = 0.10 m\n\nHeat Convection: h?W = 100 Wm\n?2K?1\n\nCycle\nTime Length: tfin,a = 10 800 s, Fig. (3.3)\n\nOptimisation\nMaterial Model: ? = 0.02, Eq. (3.13)\n\np = [20, 100], ?p = 10\nIterations per Step: itmax = 10\n\nTolerance: ?min = 1.0 \u00d7 10?6\nFilter Radius: z = 2 \u00d7 10?3 m, Eq.(4.44)\n\nTable 5.19: Optimisation definitions for a small prismatic domain subjected to forced\nconvection.\n\nPrismatic Tank\n(Table 5.1)\n\nDomain\nDimensions: L = 0.40 m\n\nHeat Convection: h?W = 100 Wm\n?2K?1\n\nCycle\nTime Length: tfin,a = 10 800 s, Fig. (3.3)\n\nOptimisation\nMaterial Model: ? = 0.02, Eq. (3.13)\n\np = [20, 100], ?p = 10\nIterations per Step: itmax = 10\n\nTolerance: ?min = 1.0 \u00d7 10?6\nFilter Radius: z = 8 \u00d7 10?3 m, Eq.(4.44)\n\nTable 5.20: Optimisation definitions for a small prismatic domain subjected to forced\nconvection.\n\nare then place on the nearest concave corner, producing a slight temperature reduction\n\nin the region, which results in an improvement of 0.23% on the intake mass of gas. Such\n\ngain is much smaller than the one obtained for the reference case, demonstrating that the\n\naddition of fins are more suitable on the design of low pressure ANG tanks.\n\nBy increasing the filling pressure to 5.00 MPa, as defined in Table 5.22, the fins are\n\n\n\n99\n\n(a) Pseudo-porosity distribution\n0 20 40 60 80 100 120\n\nFunctional Evaluations\n\n0.15\n\n0.16\n\n0.17\n\n0.18\n\n0.19\n\n0.20\n\n0.21\n\n0.22\n\n0.23\n\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\n(b) Functional convergence\n\n(c) Total gas in homogeneous and optimised\ntanks at tfin\n\n(d) Temperature in homogeneous and opti-\nmised tanks at tfin\n\nJa Homogenous Ja Optimised Improvement\n0.21 kg 0.22 kg 0.39%\n\nFigure 5.18: Optimised design for a small prismatic domain subjected to forced convec-\ntion.\n\nplaced farther than the inlet region, as shown in Figure 5.21. This shift is explained by\n\nextending the points listed on the 3.00 MPa case. The 5.00 MPa pressure intensified the\n\ncooling effect produced near the inlet region, as seen in Figure 5.21d. Interestingly, the\n\nimprovement achieved here is slightly higher than in the 3.00 MPa case: 0.58%. Such\n\nimprovement is mainly due to the creation of a fin on the next concave corner, which was\n\nable to reduce the maximum temperature inside the optimised tank to around 320 K.\n\n\n\n100\n\n(a) Pseudo-porosity distribution 0 20 40 60 80 100 120 140\nFunctional Evaluations\n\n1.00\n\n1.25\n\n1.50\n\n1.75\n\n2.00\n\n2.25\n\n2.50\n\n2.75\n\n3.00\n\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\n(b) Functional convergence\n\n(c) Total gas in homogeneous and optimised\ntanks at tfin\n\n(d) Temperature in homogeneous and opti-\nmised tanks at tfin\n\nJa Homogenous Ja Optimised Improvement\n2.80 kg 2.95 kg 5.54%\n\nFigure 5.19: Optimised design for a large prismatic domain subjected to forced convec-\ntion.\n\n\n\n101\n\nCustom Axisymmetric Tank\n(Table 5.3)\n\nDomain\nHeat Convection: h(?W ??F ) = 100 W m\n\n?2K?1\n\nCycle\nTime Length: tfin,a = 3600 s, Fig. (3.3)\n\nFinal Pressure: Plet = 3.00 MPa\n\nOptimisation\nMaterial Model: ? = 0.02, Eq. (3.13)\n\np = [20, 100], ?p = 10\nIterations per Step: itmax = 10\n\nTolerance: ?min = 1.0 \u00d7 10?6\nFilter Radius: z = 5 \u00d7 10?3 m, Eq.(4.44)\n\nTable 5.21: Optimisation definitions for a custom axisymmetric domain subjected to\n3.00 MPa filling pressure and forced convection with h = 100 Wm?2K?1.\n\nCustom Axisymmetric Tank\n(Table 5.3)\n\nDomain\nHeat Convection: h(?W ??F ) = 100 W m\n\n?2K?1\n\nCycle\nTime Length: tfin,a = 3600 s, Fig. (3.3)\n\nFinal Pressure: Plet = 5.00 MPa\n\nOptimisation\nMaterial Model: ? = 0.02, Eq. (3.13)\n\np = [20, 100], ?p = 10\nIterations per Step: itmax = 10\n\nTolerance: ?min = 1.0 \u00d7 10?6\nFilter Radius: z = 5 \u00d7 10?3 m, Eq.(4.44)\n\nTable 5.22: Optimisation definitions for a custom axisymmetric domain subjected to\n5.00 MPa filling pressure and forced convection with h = 100 Wm?2K?1.\n\n\n\n102\n\n(a) Pseudo-porosity distribution\n0 20 40 60 80 100 120\n\nFunctional Evaluations\n\n2.800\n\n2.825\n\n2.850\n\n2.875\n\n2.900\n\n2.925\n\n2.950\n\n2.975\n\n3.000\n\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\n(b) Functional convergence\n\n(c) Total gas in homogeneous and optimised\ntanks at tfin\n\n(d) Temperature in homogeneous and opti-\nmised tanks at tfin\n\nJa Homogenous Ja Optimised Improvement\n2.95 kg 2.96 kg 0.23%\n\nFigure 5.20: Optimised design for a custom axisymmetric domain subjected to 3 MPa\nfilling pressure and forced convection with h = 100 Wm?2K?1.\n\n\n\n103\n\n(a) Pseudo-porosity distribution\n0 20 40 60 80 100 120\n\nFunctional Evaluations\n\n3.60\n\n3.65\n\n3.70\n\n3.75\n\n3.80\n\n3.85\n\n3.90\n\n3.95\n\n4.00\nF\nu\nn\nct\nio\nn\na\nl\nV\na\nlu\ne\n(k\ng\n)\n\n(b) Functional convergence\n\n(c) Total gas in homogeneous and optimised\ntanks at tfin\n\n(d) Temperature in homogeneous and opti-\nmised tanks at tfin\n\nJa Homogenous Ja Optimised Improvement\n3.89 kg 3.91 kg 0.58%\n\nFigure 5.21: Optimised design for a custom axisymmetric domain subjected to 5 MPa\nfilling pressure and forced convection with h = 100 Wm?2K?1.\n\n\n\n104\n\n6 Conclusions\n\nThe main goal of the research presented in this work was to formulate and evaluate\n\nthe use of topology optimisation for designing adsorption systems. Among the several\n\napplications of such systems, Adsorbed Natural Gas (ANG) tanks have been chosen to be\n\nthe focus of this work. Accordingly, a comprehensive model for ANG tanks is presented,\n\nincluding the kinetics of adsorption and the variation of adsorbent properties in function to\n\nthe porosities. The solution of the resulting set of PDEs governing the adsorption problem\n\nis obtained via the Finite Element Method (FEM). The procedure to assemble the FEM\n\nmatrices from the PDEs weak form is described in detail. The concept of including non-\n\nadsorbent materials inside ANG tanks aiming to improve their thermal management is\n\nthen introduced. The optimisation of the distribution of adsorbent and non-adsorbent\n\nmaterials inside the tank is approached via topology optimisation. The implementation\n\nof this method is based on the calculation of the sensitivities via the adjoint method for\n\ntransient systems, which is comprehensively presented. Resulting optimised topologies are\n\npresented for ANG tanks applied to on-demand consumption. The optimisation of tanks\n\nwith different shapes is tackled and the impact of parameters such as material properties,\n\nfilling pressure, cycle duration and tank dimensions are studied.\n\nA major scientific contribution presented in this work is the derivation of the full for-\n\nmulation of a gradient-based PDE-constrained optimisation of adsorption systems. Such\n\nderivation includes the statement of the weak and discrete formulation of the adsorption\n\nproblem for FEM implementation and the derivation of the adjoint problem from the\n\naugmented Lagrangian form of the functional of interest. Additionally, a material model\n\nbased on hyperbolic tangents (OHT) is introduced. Such model has shown to be more\n\nefficient than traditional ones for the design of biphasic structures. It is due to its novel\n\npenalisation approach combined with offsets.\n\nSeveral ANG tanks optimised according to the distribution of cooling material across\n\n\n\n105\n\nthe adsorbent bed are presented in this work. Designs include axisymmetric and prismatic\n\ntanks subjected to natural convection and active thermal boundary conditions. By the\n\nresults presented, it is concluded that small improvement is achievable by the addition of\n\nmetallic fins in tanks subjected to natural convection. For the cycles and domain sizes\n\nconsidered, tanks subjected to natural convection presented insufficient improvement in\n\norder to justify the cost of including regions constituted by non-adsorbent material across\n\nthe adsorbent bed. Similarly, small improvement is observed in high pressure tanks. The\n\nrelative improvement achievable in high pressure tanks is smaller than the ones working\n\nat low pressure. It suggests that the design concept adopted by this work is more suitable\n\nfor low pressure ANG tanks.\n\nIn contrast, the insertion of non-adsorbent regions in ANG tanks is very effective when\n\nassociated with cold regions. It is due to the fact that materials with high conductivity\n\ndepend on meaningful temperature gradients in order to aid heat transfer across the tank.\n\nSuch fact is reinforced by the resulting topologies presenting metallic regions around tanks\n\nconcave corners, where the temperature gradients are higher. Also, materials presenting\n\nhigh heat capacity constitute a suitable solution for passive thermal management. In\n\nopposition to phases presenting typical metallic properties, materials with high heat ca-\n\npacity are not dependent on the existence of cold regions in the domain. Results have\n\nshown that islands constituted by materials presenting high heat capacity act as a heat\n\nsink, creating a zone of influence in the temperature field.\n\nAltogether, adsorbent\u2019s low conductivity can represent a limiting issue. In fast ad-\n\nsorption cycles, any optimisation attempt is hindered by the extremely low conductivity of\n\nadsorbent materials. It is demonstrated by the reduction of the zone of influence of regions\n\nconstituted by high capacity materials as the cycles considered gets shorter. Therefore,\n\nthe design concept presented in this work is complementary to further development of\n\nadsorbent materials.\n\nThis thesis provides the basis for several future work. The formulation presented here\n\nis easily extended to storage and transport applications, by including the desorption cycle\n\nin the objective function. Additionally, since results have shown that complex-shaped\n\ntanks present better performance than traditional ones. Therefore, it is promising to\n\ncomplement the optimisation of the adsorbent bed with the optimisation of the external\n\nshape, by either shape or topology optimisation. Furthermore, given the promising results\n\nobtained for non-adsorbent material with high heat capacity, the use of Phase Change\n\nMaterials (PCMs) is very promising for any application. It consists of including an ad-\n\nditional governing equation in order to model the phase change kinetics, leading to new\n\n\n\n106\n\nsource terms in the energy balance.\n\nDue to the numerical focus of this work, manufacturing issues have been addressed\n\nmarginally only. Yet, the literature review in this matter indicated relative ease for con-\n\nforming adsorbent beds in any desired geometry by pouring and compacting a slurry\n\nconstituted by binder-coated carbon particles inside tank segments. Manufacturing com-\n\nplexity depend mainly on the construction of non-adsorbent parts, which can be done\n\nvia traditional methods such as machining and casting, in the case of metals. However,\n\ndespite such preliminary indications, further research on this topics is necessary.\n\nFinally, the work presented here is naturally extendible to any other adsorption appli-\n\ncation. Fluid separation, refrigeration and Carbon Capture and Storage (CCS) are some\n\nof the possible applications for adsorption systems that could be explored based on this\n\nresearch.\n\n\n\n107\n\nReferences\n\nALKAN, M.; DEMIRBAS, O.; DOGAN, M. Adsorption kinetics and thermodynamics\nof an anionic dye onto sepiolite. Microporous and Mesoporous Materials, v. 101, n. 3, p.\n388\u2013396, abr. 2007. ISSN 13871811.\n\nALN\u00c6S, M. S. et al. Unified form language. ACM Transactions on Mathematical\nSoftware, v. 40, n. 2, p. 1\u201337, nov. 2014. ISSN 00983500.\n\nANDREASEN, C. S.; SIGMUND, O. Topology optimization of fluid\u2013structure-\ninteraction problems in poroelasticity. Computer Methods in Applied Mechanics and\nEngineering, Elsevier B.V., v. 258, p. 55\u201362, maio 2013. ISSN 00457825.\n\nANGP. Low-Pressure is the Future of Natural Gas Vehicles. 2017. Dispon??vel em:\n?http://www.angpinc.com/phangv/?.\n\nANISZEWSKI, W.; MENARD, T.; MAREK, M. Volume of fluid (vof) type advection\nmethods in two-phase flow: A comparative study. Computers &amp; Fluids, Elsevier Ltd,\nv. 97, p. 52\u201373, 2014. ISSN 00457930.\n\nBENDS\u00d8E, M. P.; SIGMUND, O. Material interpolation schemes in topology\noptimization. Archive of Applied Mechanics, v. 69, n. 9-10, p. 635\u2013654, 1999. ISSN\n0939-1533.\n\nBILOE, S.; GOETZ, V.; GUILLOT, A. Optimal design of an activated carbon for an\nadsorbed natural gas storage system. Carbon, v. 40, n. 8, p. 1295\u20131308, 2002. ISSN\n00086223.\n\nBIRD, R. B.; STEWART, W. B.; LIGHTFOOT, E. N. Transport Phenomena. 2nd. ed.\n[S.l.: s.n.], 2007. ISBN 978-0470115398.\n\nBLANCO, M. V. et al. Hydrogen sorption kinetics of la-ni-sn storage alloys. International\nJournal of Hydrogen Energy, Elsevier Ltd, v. 39, n. 11, p. 5858\u20135867, 2014. ISSN\n0360-3199.\n\nBORRVALL, T.; PETERSSON, J. Topology optimization of fluids in stokes flow.\nInternational Journal for Numerical Methods in Fluids, v. 41, n. 1, p. 77\u2013107, 2003.\nISSN 02712091.\n\nBOSE, T. K.; CHAHINE, R.; ST-ARNAUD, J. M. High-density adsorbent and method\nof producing same. US Patent 4999330A, 1991.\n\nBRUNS, T. E. Topology optimization of convection-dominated, steady-state heat\ntransfer problems. International Journal of Heat and Mass Transfer, v. 50, n. 15-16, p.\n2859\u20132873, 2007. ISSN 00179310.\n\nBYRD, R. et al. A limited memory algorithm for bound constrained optimization. SIAM\nJournal on Scientific Computing, v. 16, n. 5, p. 1190\u20131208, 1995.\n\nhttp://www.angpinc.com/phangv/\n\n\n108\n\nCARMAN, P. C. Fluid flow through granular beds. Chemical Engineering Research and\nDesign, Institution of Chemical Engineers, v. 75, p. S32\u2013S48, 1937. ISSN 02638762.\n\nCAVALCANTE, C. L. Industrial adsorption separation processes: Fundamentals,\nmodeling and applications. Latin American Applied Research, v. 30, n. 4, p. 357\u2013364,\n2000. ISSN 03270793.\n\nCHAO, T. Y.; CHOW, W. K.; KONG, H. A review on the applications of finite element\nmethod to heat transfer and fluid flow. International Journal on Architectural Science,\nv. 3, n. 1, p. 1\u201319, 2002.\n\nCHARTON, F.; NICOUD, R. M. Complete design of a simulated moving bed. Journal\nof Chromatography A, v. 702, n. 1-2, p. 97\u2013112, maio 1995. ISSN 00219673.\n\nCHRISTMANN, K. Introduction to Surface Physical Chemistry. [S.l.]: Springer Berlin\nHeidelberg, 1991. ISBN 0195105893.\n\nDAHL, J.; JENSEN, J. S.; SIGMUND, O. Topology optimization for transient wave\npropagation problems in one dimension : Ddesign of filters and pulse modulators.\nStructural and Multidisciplinary Optimization, v. 36, n. 6, p. 585\u2013595, 2008. ISSN\n1615147X.\n\nDIJK, N. P. et al. Level-set methods for structural topology optimization: A review.\nStructural and Multidisciplinary Optimization, v. 48, n. 3, p. 437\u2013472, 2013. ISSN\n1615147X.\n\nELROD, M. J. Greenhouse warming potentials from the infrared spectroscopy of\natmospheric gases. Journal of Chemical Education, v. 76, n. 12, p. 1702, 1999.\n\nFUNKE, S. W. The automation of PDE-constrained optimisation and its applications.\nTese (Doutorado) \u2014 Imperial College London, 2012.\n\nGERSBORG-HANSEN, A.; SIGMUND, O.; HABER, R. B. Topology optimization of\nchannel flow problems. Structural and Multidisciplinary Optimization, v. 30, n. 3, p.\n181\u2013192, jun. 2005. ISSN 1615147X.\n\nGILES, C. H. A general treatment and classification of the solute adsorption isotherm.\nJournal of Colloid and Interface Science, v. 47, n. 3, 1974.\n\nGUEST, J. K.; PREVOST, J. H. Topology optimization of creeping fluid flows using a\ndarcy-stokes finite element. International Journal for Numerical Methods in Engineering,\nv. 66, n. 3, p. 461\u2013484, abr. 2006. ISSN 00295981.\n\nHALL, J. et al. A volumetric geometry and topology parameterisation for fluids-based\noptimisation. Computers and Fluids, Elsevier Ltd, v. 148, p. 137\u2013156, 2017. ISSN\n00457930.\n\nHASCOET, L.; DAUVERGNE, B. Adjoints of large simulation codes through automatic\ndifferentiation. European Journal of Computational . . . , p. 1\u201324, 2008. ISSN 17797179.\n\nHIRATA, S. C. et al. Modeling and hybrid simulation of slow discharge process of\nadsorbed methane tanks. International Journal of Thermal Sciences, Elsevier Masson\nSAS, v. 48, n. 6, p. 1176\u20131183, jun. 2009. ISSN 12900729.\n\n\n\n109\n\nINGEVITY. Turning complex challenges into powerful possibilities. 2017. Dispon??vel em:\n?http://www.ingevity.com/markets/adsorbed-natural-gas/?.\n\nJONES, E.; OLIPHANT, T.; PETERSON, P. SciPy: Open Source Scientific Tools for\nPython. 2011. Dispon??vel em: ?http://www.scipy.org?.\n\nJUNTUNEN, M.; STENBERG, R. General boundary conditions. v. 78, n. 267, p.\n1353\u20131374, 2012.\n\nKAIST. Box-shaped Pressure Vessel for LNG Developed by KAIST Research Team. 2014.\nDispon??vel em: ?http://www.kaist.edu?.\n\nKARNIADAKIS, G. et al. Spectral/hp Element Methods for Computational Fluid\nDynamics: Second Edition. [S.l.]: OUP Oxford, 2005. (Numerical Mathematics and\nScie). ISBN 9780198528692.\n\nKIRBY, R. C. Algorithm 839. ACM Transactions on Mathematical Software, v. 30, n. 4,\np. 502\u2013516, 2004. ISSN 00983500.\n\nKOGA, A. A. et al. Development of heat sink device by using topology optimization.\nInternational Journal of Heat and Mass Transfer, Elsevier Ltd, v. 64, p. 759\u2013772, set.\n2013. ISSN 00179310.\n\nKONTOLEONTOS, E. A. et al. Adjoint-based constrained topology optimization for\nviscous flows, including heat transfer. Engineering Optimization, v. 0273, n. December,\np. 1\u201321, ago. 2012. ISSN 0305-215X.\n\nLARGITTE, L.; PASQUIER, R. A review of the kinetics adsorption models and their\napplication to the adsorption of lead by an activated carbon. Chemical Engineering\nResearch and Design, v. 109, p. 495\u2013504, 2016. ISSN 18766102.\n\nLAZAROV, B. S.; SIGMUND, O. Filters in topology optimization based on helmholtz-\ntype differential equations. International Journal for Numerical Methods in Engineering,\nv. 86, n. 6, p. 765\u2013781, maio 2011. ISSN 00295981.\n\nLIMOUSIN, G. et al. Sorption isotherms: A review on physical bases, modeling and\nmeasurement. Applied Geochemistry, v. 22, n. 2, p. 249\u2013275, 2007. ISSN 08832927.\n\nLOGG, A. Automating the finite element method. Archives of Computational Methods\nin Engineering, v. 14, n. 2, p. 93\u2013138, dez. 2007. ISSN 11343060.\n\nMATSUMORI, T. et al. Topology optimization for fluid-thermal interaction problems\nunder constant input power. Structural and Multidisciplinary Optimization, v. 47, n. 4,\np. 571\u2013581, fev. 2013. ISSN 1615147X.\n\nMCBRIDE, M. B. Environmental Chemistry of Soils. Oxford University Press,\n1994. ISBN 9780195070118. Dispon??vel em: ?https://books.google.co.uk/books?\nid=jgZhQgAACAAJ?.\n\nMENON, V. C.; KOMARNENI, S. Porous adsorbents for vehicular natural gas storage:\na review. Journal of Porous Materials, v. 5, n. 1, p. 43\u201358, 1998. ISSN 13802224.\n\nhttp://www.ingevity.com/markets/adsorbed-natural-gas/\nhttp://www.scipy.org\nhttp://www.kaist.edu\nhttps://books.google.co.uk/books?id=jgZhQgAACAAJ\nhttps://books.google.co.uk/books?id=jgZhQgAACAAJ\n\n\n110\n\nMORRIS, A. M.; ALLEN, C. B.; RENDALL, T. C. S. Cfd-based optimization of\naerofoils using radial basis functions for domain element parameterization and mesh\ndeformation. International Journal for Numerical Methods in Fluids, v. 58, n. 8, p.\n827\u2013860, nov. 2008. ISSN 02712091.\n\nMOTA, J. P. B.; ESTEVES, I. A. A. C.; ROSTAM-ABADI, M. Dynamic modelling\nof an adsorption storage tank using a hybrid approach combining computational fluid\ndynamics and process simulation. Computers and Chemical Engineering, v. 28, n. 11, p.\n2421\u20132431, out. 2004. ISSN 00981354.\n\nMOTA, J. P. B. et al. Charge dynamics of a methane adsorption storage system:\nIntraparticle diffusional effects. Adsorption, v. 3, n. 2, p. 117\u2013125, 1996. ISSN 0929-5607.\n\nMULJADI, B. P. et al. The impact of porous media heterogeneity on non-darcy flow\nbehaviour from pore-scale simulation. Advances in Water Resources, Elsevier Ltd., v. 95,\np. 329\u2013340, 2016. ISSN 03091708.\n\nPALACIOS, F. et al. Stanford university unstructured (su2): An open-source integrated\ncomputational environment for multi-physics simulation and design. 51st AIAA\nAerospace Sciences Meeting, n. January, p. 1\u201360, 2013.\n\nPATIHA et al. The langmuir isotherm adsorption equation: The monolayer approach.\nIOP Conference Series: Materials Science and Engineering, v. 107, p. 012067, 2016.\nISSN 1757-8981.\n\nPIGGOTT, M. D. et al. A new computational framework for multi-scale ocean modelling\nbased on adapting unstructured meshes. International Journal for Numerical Methods in\nFluids, v. 56, n. 8, p. 1003\u20131015, mar. 2008. ISSN 02712091.\n\nQIU, H. et al. Critical review in adsorption kinetic models. Journal of Zhejiang\nUniversity SCIENCE A, v. 10, n. 5, p. 716\u2013724, maio 2009. ISSN 1673-565X.\n\nQUINN, D. F.; MACDONALD, J. A.; SOSIN, K. Microporous carbons as adsorbents for\nmethane storage. 207th ACS national meeting, v. 39, p. 1304, 12 1994.\n\nRAHMAN, K. A. et al. Thermal enhancement of charge and discharge cycles for\nadsorbed natural gas storage. Applied Thermal Engineering, Elsevier Ltd, v. 31, n. 10, p.\n1630\u20131639, jul. 2011. ISSN 13594311.\n\nREDDY, J. N.; GARTLING, D. K. The Finite Element Method in Heat Transfer and\nFluid Dynamics, Third Edition. Taylor &amp; Francis, 2010. (Computational Mechanics and\nApplied Analysis). ISBN 9781420085983. Dispon??vel em: ?https://books.google.co.uk/\nbooks?id=sv0VKLL5lWUC?.\n\nREUTHER, J. J. et al. Constrained multipoint aerodynamic shape optimization using\nan adjoint formulation and parallel computers, part 1. v. 36, 1999.\n\nSA, L. F. N. et al. Topological derivatives applied to fluid flow channel design\noptimization problems. Structural and Multidisciplinary Optimization, v. 54, n. 2,\np. 249\u2013264, Aug 2016. ISSN 1615-1488. Dispon??vel em: ?https://doi.org/10.1007/\ns00158-016-1399-0?.\n\nhttps://books.google.co.uk/books?id=sv0VKLL5lWUC\nhttps://books.google.co.uk/books?id=sv0VKLL5lWUC\nhttps://doi.org/10.1007/s00158-016-1399-0\nhttps://doi.org/10.1007/s00158-016-1399-0\n\n\n111\n\nSAHOO, P. K. et al. Filling characteristics for an activated carbon based adsorbed\nnatural gas storage system. Industrial and Engineering Chemistry Research, v. 50, n. 23,\np. 13000\u201313011, 2011. ISSN 08885885.\n\nSAHOO, S.; RAMGOPAL, M. A simple regression equation for predicting charge\ncharacteristics of adsorbed natural gas storage systems. Applied Thermal Engineering,\nElsevier Ltd, v. 73, n. 1, p. 1093\u20131100, 2014. ISSN 13594311.\n\nSANTOS, J. C.; MARCONDES, F.; GURGEL, J. M. Performance analysis of a new tank\nconfiguration applied to the natural gas storage systems by adsorption. Applied Thermal\nEngineering, Elsevier Ltd, v. 29, n. 11-12, p. 2365\u20132372, ago. 2009. ISSN 13594311.\n\nSEDERBERG, T. W.; PARRY, S. R. Free-form deformation of solid geometric models.\nACM SIGGRAPH Computer Graphics, v. 20, n. 4, p. 151\u2013160, 1986. ISSN 00978930.\n\nSIGMUND, O. Design of multiphysics actuators using topology optimization - part i:\nOne material structures. Computer Methods in Applied Mechanics and Engineering,\nv. 190, n. 49-50, p. 6577\u20136604, 2001. ISSN 00457825.\n\nSIGMUND, O.; PETERSSON, J. Numerical instabilities in topology optimization: A\nsurvey on procedures dealing with checkerboards, mesh-dependencies and local minima.\nStructural Optimization, v. 16, n. 1, p. 68\u201375, 1998. ISSN 0934-4373.\n\nSMITH, D. S. et al. Thermal conductivity of porous materials. Journal of Materials\nResearch, v. 28, n. 17, p. 2260\u20132272, jul. 2013. ISSN 2044-5326.\n\nSOLARNEXT. Adsorption Cooling Technology. [S.l.], 2009. 1 p.\n\nSTEIN, W.; JOYNER, D. Sage: System for algebra and geometry experimentation. . . .\nAlgebra (SIGSAM Bulletin)(July 2005), v. 39, n. 2, p. 61\u201364, 2005.\n\nSUN, W.; HUANG, W.; RUSSELL, R. D. Finite difference preconditioning for solving\northogonal collocation equations for boundary value problems. SIAM Journal on\nNumerical Analysis, v. 33, n. 6, p. 2268\u20132285, 1996. ISSN 0036-1429.\n\nTHACKER, W. E. et al. Modeling variable comparison adsorber performance :\nconcentration and influent of adsorbents. v. 56, n. 3, p. 243\u2013250, 2014.\n\nTOLEDO, M. et al. Use of phase change materials on an adsorbed carbon dioxide\nstorage system. Applied Thermal Engineering, Elsevier Ltd, v. 51, n. 1-2, p. 512\u2013519,\n2013. ISSN 13594311.\n\nTURTELTAUB, S. Optimal material properties for transient problems. Structural and\nMultidisciplinary Optimization, v. 22, n. 2, p. 157\u2013166, 2001. ISSN 1615147X.\n\nVASILIEV, L. L.; KANONCHIK, L. E.; BABENKO, V. A. Thermal management of the\nadsorption-based vessel for hydrogenous gas storage. Journal of Engineering Physics . . . ,\np. 12\u201315, 2011.\n\nVASILIEV, L. L.; KANONCHIK, L. E.; RABETSKY, M. I. Thermally regulated\ncylinder for adsorption storage of a hydrogenous gas. International Journal of Heat and\nMass Transfer, Elsevier Ltd, v. 71, n. 2014, p. 125\u2013132, 2014. ISSN 00179310.\n\n\n\n112\n\nWACHTER, A.; BIEGLER, L. T. On the implementation of an interior-point filter\nline-search algorithm for large-scale nonlinear programming. Mathematical Programming,\nv. 106, n. 1, p. 25\u201357, 2006. ISSN 00255610.\n\nWANG, B. K.; VINEYARD, E. A. Adsorption refrigeration. Ashrae, v. 1, n. September,\np. 14\u201324, 2011.\n\nWELLER, H. G. et al. A tensorial approach to computational continuum mechanics\nusing object orientated techniques. Computers in Physics, v. 12, n. 6, p. 620\u2013631, 1998.\n\nWETENHALL, B. et al. Impact of co2 impurity on co2 compression, liquefaction and\ntransportation. Energy Procedia, v. 63, p. 2764\u20132778, 2014. ISSN 18766102.\n\nWHITAKER, S. Flow in porous media i: A theoretical derivation of darcy\u2019s law.\nTransport in Porous Media, v. 1, n. 1, p. 3\u201325, 1986. ISSN 01693913.\n\nWITHERDEN, F. D.; FARRINGTON, A. M.; VINCENT, P. E. Pyfr: An open source\nframework for solving advection-diffusion type problems on streaming architectures using\nthe flux reconstruction approach. Computer Physics Communications, Elsevier B.V.,\nv. 185, n. 11, p. 3028\u20133040, 2014. ISSN 00104655.\n\nWOLAK, E.; KRASZEWSKI, S. An overview of adsorptive processes in refrigeration\nsystems refrigerating appliances. E3S Web of Conferences, v. 10, p. 1\u20136, 2016. ISSN\n22671242.\n\nWOOD, G. O. Affinity coefficients of the polanyi/dubinin adsorption isotherm equations.\na review with compilations and correlations. Carbon, v. 39, n. 3, p. 343\u2013356, 2001. ISSN\n00086223.\n\nWOOD, G. O. Review and comparisons of d/r models of equilibrium adsorption of\nbinary mixtures of organic vapors on activated carbons. Carbon, v. 40, n. 3, p. 231\u2013239,\n2002. ISSN 00086223.\n\nXIE, Y. M. et al. Shape and topology design for heat conduction by evolutionary\nstructural optimization. International Journal of Heat and Mass Transfer, v. 42, n. 1999,\np. 3361\u20133371, 1999. ISSN 0017-9310.\n\nYONGE, D. R. Finite element modelling of multisolute activated carbon adsorption.\nApplied mathematical modelling, v. 16, p. 630\u2013637, 1992.\n\nYOON, G. H. Topological design of heat dissipating structure with forced convective\nheat transfer. Journal of Mechanical Science and Technology, v. 24, n. 6, p. 1225\u20131233,\njun. 2010. ISSN 1738494X.\n\nYOON, G. H. Topological layout design of electro-fluid-thermal-compliant actuator.\nComputer Methods in Applied Mechanics and Engineering, Elsevier B.V., v. 209-212, p.\n28\u201344, fev. 2012. ISSN 00457825.\n\nYOON, G. H.; KIM, Y. Y. The element connectivity parameterization formulation for\nthe topology design optimization of multiphysics systems. International Journal for\nNumerical Methods in Engineering, v. 64, n. 12, p. 1649\u20131677, 2005. ISSN 00295981.\n\nZENG, Z.; GRIGG, R. A criterion for non-darcy flow in porous media. Transport in\nPorous Media, v. 63, n. 1, p. 57\u201369, 2006. ISSN 01693913.\n\n\n\n113\n\nAppendix A. Finite Element Coefficients\n\nThis chapter presents the integral form of the coefficients of the FEM systems given\n\nin Chapter 4.\n\nA.1 Full Adsorption Problem\n\nW(T) =\n\n?\n\n?\n\n[2?r]\nMg(?\n\nT ?t)\n\nRg(?T T)\n??Tdx. (A.1)\n\nS(P,T) =\n\n?\n\n?\n\n[2?r]\nMg(?\n\nT ?t)(?\nT P)\n\nRg(?T T)2\n??Tdx. (A.2)\n\nZ(P,T) =\n\n?\n\n?\n\n[2?r]\nMg(?\n\nT Ks)(?\nT P)\n\nRg\u00b5g(?T T)\n????Tdx\n\n?\n?\n\n?W\n\n[2?r]\nMg(?\n\nT Ks)(?\nT P)\n\nRg\u00b5g(?T T)\n???Tds.\n\n(A.3)\n\nJ =\n\n?\n\n?\n\n[2?r] (?T ?t)??\nTdx. (A.4)\n\nN(P,T,Q) =\n\n?\n\n?\n\n[2?r]\nCpgMg(?\n\nT?t)\n\nRg\n\n(?T P)\n\n(?T T)\n??Tdx\n\n+\n\n?\n\n?\n\n[2?r] Cpg(?\nT Q)??Tdx\n\n+\n\n?\n\n?\n\n[2?r] (1 ? ?T ?t)(?T Cps)(?T ?s)??Tdx.\n\n(A.5)\n\n\n\n114\n\nL(P,T) = ?\n?\n\n?\n\n[2?r]\nCpgMg(?\n\nT Ks)(?\nT P)\n\nRg\u00b5g(?T T)\n(??T P)????Tdx. (A.6)\n\nK =\n\n?\n\n?\n\n[2?r] (?T kf)????Tdx ?\n?\n\n?W\n\n[2?r] (?T kf)???Tds. (A.7)\n\nYM =\n\n?\n\n?\n\n[2?r] ??Tdx. (A.8)\n\nYE =\n\n?\n\n?\n\n?[2?r] |?H|??Tdx. (A.9)\n\nYD =\n\n?\n\n?\n\n[2?r] ??Tdx. (A.10)\n\nR(T) =\n\n?\n\n?\n\n[2?r] (?T G)??Tdx. (A.11)\n\nV (P,T) =\n\n?\n\n?\n\n[2?r] (?T G)(?T Qeq)?dx. (A.12)\n\nA.2 Adsorption Problem after Decoupling the Ad-\n\nsorbed Density Field\n\nF = ?\n?\n\n?\n\n[2?r]\n\n(\n\n?T\n?Q\n\n?t\n\n)\n\n?dx. (A.13)\n\nH =\n\n?\n\n?\n\n[2?r] |?H|\n(\n\n?T\n?Q\n\n?t\n\n)\n\n?dx. (A.14)\n\n\n\n115\n\nA.3 Adsorption Problem after Decoupling the Pres-\n\nsure Field\n\nW =\n\n?\n\n?\n\n[2?r] (?T ?t)(?\nT\n??g\n?t\n\n)??Tdx. (A.15)\n\nZ =\n\n?\n\n?\n\n[2?r]\n(?T Ks)(?\n\nT ?g)\n\n\u00b5g\n????Tdx\n\n?\n?\n\n?W\n\n[2?r]\n(?T Ks)(?\n\nT ?g)\n\n\u00b5g\n???Tds.\n\n(A.16)\n\nF = ?\n?\n\n?\n\n[2?r]\n\n(\n\n?T\n?Q\n\n?t\n\n)\n\n?dx. (A.17)\n\nN =\n\n?\n\n?\n\n[2?r] (?T ?t)Cpg(?\nT ?g)??\n\nTdx\n\n+\n\n?\n\n?\n\n[2?r]\n\n(\n\n1 ? (?T ?t)\n)\n\n(?T Cps)(?\nT ?s)??\n\nTdx\n\n+\n\n?\n\n?\n\n[2?r] Cpg(?\nT Q)??Tdx.\n\n(A.18)\n\nL = ?\n?\n\n?\n\n[2?r]\nCpgMg(?\n\nT Ks)(?\nT P)\n\nRg\u00b5g(?T T)\n(??T P)????Tdx. (A.19)\n\nK =\n\n?\n\n?\n\n[2?r] (?T kf)????Tdx\n\n?\n?\n\n?W\n\n[2?r] (?T kf)???T ds.\n(A.20)\n\nH =\n\n?\n\n?\n\n[2?r] (?T ?t)\n\n(\n\n?T\n?P\n\n?t\n\n)\n\n?dx +\n\n?\n\n?\n\n[2?r] |?H|\n(\n\n?T\n?Q\n\n?t\n\n)\n\n?dx. (A.21)\n\n\n\n116\n\nA.4 Helmholtz Filtering\n\nThe interpolation of the pseudo-porosities is done over a finite element by using the\n\nshape function ? as\n\ne(x, t) ?=\nL\n\n?\n\nl=1\n\n?l(x)e(t) = ?\nT e. (A.22)\n\nMaking vH = ?, the FEM system is assembled based on the coefficients\n\nZ =\n\n?\n\n?\n\n??Tdx +\n\n?\n\n?\n\nz2????Tdx, (A.23)\n\ne|=\n?\n\n?\n\n(?T e|)?dx. (A.24)\n\n\n\n117\n\nAppendix B. Material Properties\n\nTable B.1: Methane properties (SAHOO et al., 2011; SAHOO; RAMGOPAL, 2014).\n\nProperty Symbol Value Unit\n\nSpecific Heat Cpg 14 890 J kg\n?1K?1\n\nThermal Conductivity kg 34.30 \u00d7 10?3 W m?1K?1\n\nMolar Mass Mg 16.03 \u00d7 10?3 kg mol?1\n\nCritical Pressure Pcr 4.60 \u00d7 106 Pa\nBoiling Point Temperature Tboil 111.2 K\n\nCritical Temperature Tcr 191 K\n\nThermal Expansion of Liquefied Gases ?e 2.50 \u00d7 10?3 K?1\n\nDensity at Boiling Point ?boil 422.62 kg m\n?3\n\nViscosity \u00b5g 12.50 \u00d7 10?6 Pa s\n\nTable B.2: Activated Carbon properties (SAHOO et al., 2011).\n\nProperty Symbol Value Unit\n\nBulk Specific Heat Cps 650 J kg\n?1K?1\n\nBulk Thermal Conductivity ks 0.54 W m\n?1K?1\n\nMicro-Pores Dispersion ns 1.8\n\nSpecific Volume of Micro-Pores w 0.33 \u00d7 10?3 m3 kg?1\n\nParticle Diameter \u00f8s 1.00 \u00d7 10?3 m\nMacro-Porosity ?M 0.3\n\nMicro-Porosity ?m 0.5\n\nBulk Density ?s 1428.57 kg m\n?3\n\nMicro-Pore Tortuosity ?s 2.08\n\n\n\n118\n\nTable B.3: Adsorption parameters for Methane on Activated Carbon (SAHOO et al.,\n2011; SAHOO; RAMGOPAL, 2014).\n\nParameter Symbol Value Unit\n\nEffective Gas Diffusivity D0 8.00 \u00d7 10?7 m2 s?1\n\nCharacteristic Energy E0 25 040 J mol\n?1\n\nActivation Energy of Adsorption Ea 6000 J mol\n?1\n\nActivation Energy of Desorption 1 Ed 22 000 J mol\n?1\n\nAffinity Coefficient ? 0.35\n\nIsosteric Heat of Adsorption ?H ?16 000 \u00d7 103 J mol?1\n1 Calculated from Ea and ?H values (CHRISTMANN, 1991).\n\nTable B.4: Steel properties.\n\nParameter Symbol Value Unit\n\nSpecific Heat Cps 470 J kg\n?1K?1\n\nThermal Conductivity ks 47 W m\n?1K?1\n\nDensity ?s 7900 kg m\n?3\n\nPermeability 1 Ks 1.00 \u00d7 10?22 m2\n1 Approximation adopted for representing impermeable medium.\n\n\n\tpoli-tese\n\t'EPUSP-Catalogacao-na-Fonte.pdf'\n\tpoli-tese"}]}}}