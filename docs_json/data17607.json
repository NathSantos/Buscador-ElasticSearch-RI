{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.21217"}, {"@name": "filename", "#text": "4933_Vieira_PauloMarcosFernandes_M.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE ESTADUAL DE CAMPINAS FACULDADE DE ENGENHARIA MEC\u00c2NICA DEPARTAMENTO DE ENGENHARIA DE PETR\u00d3LEO\nDisserta\u00e7\u00e3o Apresentada \u00e0, Faculdade de Engenharia Mec\u00e2nica Como Requisito Parcial \u00e0 Obten\u00e7\u00e3o do T\u00edtulo de Mestre em Engenharia de Petr\u00f3leo\nAN\u00c1LISE AUTOMATIZADA DE TESTES DE PRESS\u00c3O\n\nAutor : Paulo Marcos Fernandes Vieira A\"1 Orientador : Adalberto Jos\u00e9 Rosa\nDezembro de 1992\nUNIVERSIDADE ESTADUAL DE CAMPINAS\nFACULDADE DE ENGENHARIA MEC\u00c2NICA\nDEPARTAMENTO DE ENGENHARIA DE PETR\u00d3LEO\nA disserta\u00e7\u00e3o \u2019\u2019An\u00e1lise Automatizada de Testes de Press\u00e3o\u2019\" elaborada por Paulo Marcos Fernandes Vieira e aprovada por todos os membros da Banca Examinadora foi aceita pela Sub-Comiss\u00e3o de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Petr\u00f3leo como requisito parcial para a obten\u00e7\u00e3o do T\u00edtulo de Mestre em Engenharia de Petr\u00f3leo.\nCampinas, 17 de dezembro de 1992.\nBanca Examinadora\nMaria Cristina de Castro Cunha, Ph.D.\n\u201d Confie no Senhor de todo o seu cora\u00e7\u00e3o, nunca pense que a sua pr\u00f3pria capacidade \u00e9 suficiente para vencer os problemas. \u201d\nProv\u00e9rbios 3:5 * A B\u00edblia Viva.\n\u00c0 minha esposa Ana Cristina, \u00e0s minhas filhas Beatriz e M\u00e1rcia e \u00e0 minha m\u00e3e Yolanda.\nAo meu orientador Adalberto Jos\u00e9 Rosa pela presteza e dedica\u00e7\u00e3o com que conduziu o presente trabalho.\nA Professora. Maria Cristina pelo apoio e sugest\u00f5es dadas durante o decorrer do desenvolvimento desta disserta\u00e7\u00e3o.\nAos colegas, funcion\u00e1rios e professores do mestrado em Engenharia de Petr\u00f3leo da UNICAMP pelo companheirismo com que compartilharam estes dois anos comigo.\nA PETROBRAS pela oportunidade de aprimorar-me tecnicamente, dando o suporte financeiro para participar do Curso de Mestrado em Engenharia de Petr\u00f3leo.\nResumo\nA an\u00e1lise automatizada de testes de press\u00e3o em po\u00e7os de petr\u00f3leo tem como objetivo obter os par\u00e2metros da forma\u00e7\u00e3o atrav\u00e9s da utiliza\u00e7\u00e3o de t\u00e9cnicas de regress\u00e3o n\u00e3o linear aplicadas aos dados de press\u00e3o de fundo versus tempo obtidos durante o per\u00edodo do teste.\nNeste trabalho foram analisadas e comparadas as performances de v\u00e1rios m\u00e9todos de regress\u00e3o n\u00e3o linear aplicados a dados de testes de press\u00e3o. Alguns dos m\u00e9todos considerados baseiam-se na minimiza\u00e7\u00e3o da norma L2, tais como: m\u00ednimos quadrados e decomposi\u00e7\u00e3o em valores singulares. Outros minimizam a norma LR como m\u00ednimos valores absolutos (MVA), m\u00ednimos valores absolutos modificado (MVAM), m\u00e9todo combinado MVAM-MVA e o m\u00e9todo de Nelder-Mead.\nUma nova fun\u00e7\u00e3o penalidade foi proposta para o caso de otimiza\u00e7\u00e3o restrita em m\u00e9todos que se baseiam na resolu\u00e7\u00e3o de sistemas de equa\u00e7\u00f5es lineares quadrados. Al\u00e9m disso, para m\u00e9todos que se baseiam na solu\u00e7\u00e3o de sistemas de equa\u00e7\u00f5es lineares sobredeterminados, para os quais n\u00e3o se aplicam as fun\u00e7\u00f5es penalidade convencionais, foram propostas mudan\u00e7as nos dom\u00ednios dos par\u00e2metros com o objetivo de restringir a minimiza\u00e7\u00e3o a regi\u00f5es f\u00edsica e matematicamente poss\u00edveis.\nConcluiu-se que o m\u00e9todo de m\u00ednimos valores absolutos modificado (MVAM) e o m\u00e9todo combinado (MVAM-MVA) tem melhor desempenho do que os demais no que se refere ao n\u00famero de itera\u00e7\u00f5es, \u00e0 converg\u00eancia a partir de estimativas iniciais pobres ou \u00e0 robustez em rela\u00e7\u00e3o a regi\u00f5es onde o problema f\u00edsico-matem\u00e1tico \u00e9 mal posto.\nDo\u00eds modelos de reservat\u00f3rio foram analisados: reservat\u00f3rio homog\u00eaneo infinito e reservat\u00f3rio de dupla porosidade infinito.\nForam comparados os resultados das regress\u00f5es efetuadas com dados de press\u00e3o, com dados da derivada logar\u00edtmica da press\u00e3o e com o conjunto desses dados. Concluiu-se que o uso do conjunto de dados de press\u00e3o e de derivada torna os m\u00e9todos mais robustos.\nDiversos exemplos utilizando dados sint\u00e9ticos ou reais foram discutidos neste trabalho.\nAbstract\nThe objective of an automated well test analysis is to obtain formation parameters by using nonlinear regression techniques applied to bottom hole pressure versus time data collected during the test period.\nIn this work several nonlinear regression methods were analysed and their performances compared. Some of the methods considered are based on the L2-norm minimization, as the least squares and the singular value decomposition. Other methods minimize the Ll-norm, such as the least absolute values (LAV), modified least absolute values (MLAV), the combination (MLAV-LAV) and the Nelder-Mead\u2019s method.\nA new form of penalty-function was proposed to constrain the optimization in methods based on the solution of squared linear systems of equations. For methods based on the solution of overdetermined linear systems of equations, for which conventional penalty-functions can not be applied, changes in the domains of the unknown parameters were proposed in order to restrict the minimization to feasible (physically and mathematically) regions.\nThe modified least absolute values (MLAV) and the combined method (MLAV-LAV) presented the best performance among all methods considered in the study, concerning number of iterations, convergence from poor initial estimates or robustness with respect to infeasible regions.\nTwo reservoir models were analysed: infinite homogeneous reservoir and infinite double-porosity reservoir.\nThe results of the nonlinear parameter estimation using either pressure data, pressure derivative or pressure and derivative data were compared. The use of both pressure and derivative as the model function yielded better performance than using only pressure or pressure derivative data.\nVarious examples with synthetic and field data were discussed.\nConte\u00fado\n1\tINTRODU\u00c7\u00c3O\t1\n2\tREVIS\u00c3O BIBLIOGR\u00c1FICA.\t3\n3\tMODELOS DE RESERVAT\u00d3RIO\tESTUDADOS.\t5\n3.1\tReservat\u00f3rio Homog\u00eaneo Infinito com Estocagem e Efeito de Pel\u00edcula. ...\t5\n3.2\tReservat\u00f3rio Homog\u00eaneo de Dupla Porosidade Infinito com Estocagem e\nEfeito de Pel\u00edcula..........................................   7\n3.2.1\tFluxo Pseudo-Permanente Matriz-Fratura................. 7\n3.2.2\tFluxo Transiente Matriz-Fratura........................ 8\n4\tM\u00c9TODOS DE REGRESS\u00c3O N\u00c3O LINEAR.\t9\n4.1\tM\u00e9todos Baseados na Norma L2..............................    9\n4.1.1\tM\u00ednimos Quadrados (MQ). ..............................  9\n4.1.2\tDecomposi\u00e7\u00e3o em Valores Singulares (DVS). ............ 11\n4.2\tM\u00e9todos Baseados na Norma LI.............................    12\n4.2.1\tM\u00e9todo dos M\u00ednimos Valores Absolutos (MVA). .......... 13\n4.2.2\tM\u00e9todo dos M\u00ednimos Valores Absolutos Modificado (MVAM). ... 15\n4.2.3\tM\u00e9todo Combinado: M\u00ednimos Valores Absolutos Modificado - M\u00ednimos\nValores Absolutos (MVAM-MVA)..........................  15\n4.2.4\tM\u00e9todo de Nelder-Mead (NM). . ......................  .\t16\n4.3\tCaracter\u00edsticas dos M\u00e9todos..............................    19\n4.3.1\tOtimiza\u00e7\u00e3o Restrita...............................     19\n4.3.2\tAn\u00e1lise Estat\u00edstica da Regress\u00e3o. .  ................. 21\n4.3.3\tDistribui\u00e7\u00f5es Probabil\u00edsimas de Gauss e de Laplace...  22\n4.3.4\tInvers\u00e3o Num\u00e9rica da Transformada de Laplace. .......... 23\n5\tCOMPARA\u00c7\u00c3O ENTRE OS M\u00c9TODOS E DISCUSS\u00c3O DOS RESULTADOS.\t24\n5.1\tAn\u00e1lise de Casos de Reservat\u00f3rios com Comportamento Homog\u00eaneo Infinito. 24\n5.2\tAn\u00e1lise de Casos de Reservat\u00f3rios com Comportamento de Dupla Porosi-\ndade Infinito. . .........................................    84\n6\tCONCLUS\u00d5ES e RECOMENDA\u00c7\u00d5ES.\t112\nA ALGORITMO DE PROCURA LINEAR.\t119\nB DERIVADAS ANAL\u00cdTICAS DA QUEDA DE PRESS\u00c3O EM RELA\u00c7\u00c3O AOS PAR\u00c2METROS DE REGRESS\u00c3O PARA RESERVAT\u00d3RIO HOMOG\u00caNEO INFINITO.\t120\nC ESQUEMA DE OBTEN\u00c7\u00c3O NUM\u00c9RICA DA DERIVADA DA QUEDA DE PRESS\u00c3O PARA RESERVAT\u00d3RIO DE DUPLA POROSIDADE EM RELA\u00c7\u00c3O AOS PAR\u00c2METROS DE REGRESS\u00c3O.\t122\nD ESQUEMA DE OBTEN\u00c7\u00c3O NUM\u00c9RICA DA DERIVADA DA QUE-\nDA DE PRESS\u00c3O EM RELA\u00c7\u00c3O AO LOGAR\u00cdTMO DO TEMPO. 123\nE LISTAGENS DE PROGRAMAS EM FORTRAN.\n124\nLista de Figuras\n4.1\n4.2\n4.3\n4.4\n4.5\n4.6\n5.1\n5.2\n5.3\n5.4\n5.5\n5.6\n5.7\n5.8\n5.9\n5.10\n5.11\n5.12\n5.13\n5.14\n5.15\nM\u00e9todo de Nelder-Mead. Reflex\u00e3o do ponto P..........................  17\nM\u00e9todo de Nelder-Mead. Extens\u00e3o da reflex\u00e3o do ponto P............... 18\nM\u00e9todo de Nelder-Mead. Contra\u00e7\u00e3o da reflex\u00e3o do ponto P...............18\nM\u00e9todo de Nelder-Mead. Encolhimento do tri\u00e2gulo original. ........... 18\nExemplifica\u00e7\u00e3o de otimiza\u00e7\u00e3o restrita com intervalo fechado...........20\nExemplifica\u00e7\u00e3o de otimiza\u00e7\u00e3o restrita com intervalo aberto........... 20\nPress\u00e3o e Derivada da Press\u00e3o versus Tempo em escala log-log, para regress\u00e3o nos dados de press\u00e3o. Caso 1...............................   32\nPress\u00e3o e Derivada da Press\u00e3o versus Tempo em escala semi-log, para regress\u00e3o nos dados de press\u00e3o, Caso 1, , ..........................    32\nPress\u00e3o e Derivada da Press\u00e3o versus Tempo em escala log-log, para regress\u00e3o nos dados da derivada. Caso 1................................ 33\nPress\u00e3o e Derivada da Press\u00e3o versus Tempo em escala semi-log, para regress\u00e3o nos dados da derivada. Caso 1. ................... . 33\nPress\u00e3o e Derivada da Press\u00e3o versus Tempo em escala log-log, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 1.........34\nPress\u00e3o e Derivada da Press\u00e3o versus Tempo em escala semi-log, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 1.\t......\t35\nComportamento da m\u00e9dia dos res\u00edduos ao quadrado ao longo das itera\u00e7\u00f5es.\nCaso 1. . ........................................................    36\nComportamento da m\u00e9dia dos valores absolutos dos res\u00edduos ao longo das itera\u00e7\u00f5es. Caso 1. ...... .......................................     37\nComportamento da permeabilidade ao longo das itera\u00e7\u00f5es. Caso 1........38\nComportamento do fator de pel\u00edcula ao longo das itera\u00e7\u00f5es. Caso 1.....39\nComportamento do coeficiente de estocagem ao longo das itera\u00e7\u00f5es. Caso 1. 40\nVaria\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es no plano k-S para os v\u00e1rios m\u00e9todos. Caso 1. ...... .......................................  .\t41\nVaria\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es no plano k-C para os v\u00e1rios\nm\u00e9todos. Caso 1. . . ...........................................    42\nVaria\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es no plano S-C para os v\u00e1rios\nm\u00e9todos. Caso 1. ...... ........................................    42\nCurvas de nivele superf\u00edcie geradas pela norma L2 para C \u2014 0.00847 bbl/psi\n, Caso 1. ........ .............................................    44\n5.16\n5.17\n5.18\n5.19\n5.20\n5.21\n5.22\n5.23\n5.24\n5.25\n5.26\n5.27\n5.28\n5.29\n5.30\n5.31\n5.32\nAmplia\u00e7\u00e3o das curvas de n\u00edvel e superf\u00edcie geradas pela norma L2 para\nC = 0.00847 bbl/psi. Caso 1.................................................45\nCurvas de n\u00edvel e superf\u00edcie geradas pela norma LI para C ~ 0.00842 bbl/psi\n. Caso 1...............................................................     46\nAmplia\u00e7\u00e3o das curvas de n\u00edvel e superf\u00edcie geradas pela norma LI para\nC = 0.00842 bbl/psi . Caso 1............................................    47\nCurvas de n\u00edvel e superf\u00edcie geradas pela norma L2 para k = 15.16 mD .\nCaso 1. ........ .......................................................... 48\nAmplia\u00e7\u00e3o das curvas de n\u00edvel e superf\u00edcie geradas pela norma L2 para k \u2014 15.16 mD . Caso 1...................................................    49\nCurvas de n\u00edvel e superf\u00edcie geradas pela norma LI para k = 13.47 mD .\nCaso 1................................................................      50\nAmplia\u00e7\u00e3o das curvas de n\u00edvel e superf\u00edcie geradas pela norma LI para k = 13.47 mD. Caso 1......................................................  51\nCurvas de n\u00edvel e superf\u00edcie geradas pela norma L2 para S - 14.38 . Caso 1. 52 Amplia\u00e7\u00e3o das curvas de n\u00edvel e superf\u00edcie geradas pela norma L2 para\nS\t= 14.38 . Caso 1. ..... ................................................ 53\nCurvas de n\u00edvel e superf\u00edcie geradas pela norma LI para 8 = 11.97 . Caso 1. 54 Amplia\u00e7\u00e3o das curvas de n\u00edvel e superf\u00edcie geradas pela norma LI para\nS\t= 11.97 . Caso 1.................................................      .\t55\nCompara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss e de Laplace. Regress\u00e3o nos dados de press\u00e3o usando o m\u00e9todo MQ. Caso 1. 57\nCompara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss e de Laplace. Regress\u00e3o nos dados de press\u00e3o usando o m\u00e9todo MVA. Caso 1. 57\nCompara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss e de Laplace. Regress\u00e3o nos dados da derivada usando o m\u00e9todo MQ. Caso 1. 58\nCompara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss e de Laplace. Regress\u00e3o nos dados da derivada usando o m\u00e9todo MVA.\nCaso 1. . ...............................................................      58\nCompara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss e de Laplace. Regress\u00e3o no conjunto de dados de press\u00e3o e da derivada usando o m\u00e9todo MQ. Caso 1.................................................    59\nCompara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss e de Laplace. Regress\u00e3o no conjunto de dados de press\u00e3o e da derivada usando o m\u00e9todo MVA. Caso 1. ...... .........................................  59\n5.33\tPr es s\u00ed\u00cdo e Derivada da Press\u00e3o versus Tempo em escala log-log, para re-\ngress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 2.\t........64\n5.34\tPress\u00e3o e Derivada da Press\u00e3o versus Tempo em escala semi-log, para re-\ngress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 2.\t........... 64\n5.35\tVaria\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es no plano k-S para os v\u00e1rios\nm\u00e9todos. Caso 3......................................................  71\n5.36\tVaria\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es no plano k-C para os v\u00e1rios\nm\u00e9todos. Caso 3. . ..............................................    .\t72\n5.37\tVaria\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es no plano S-C para os v\u00e1rios\nm\u00e9todos. Caso 3. . ...............................................     72\n5.38\tPress\u00e3o e Derivada da Press\u00e3o versus Tempo em escala log-log, para re-\ngress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 3..........73\n5.39\tPress\u00e3o e Derivada da Press\u00e3o versus Tempo em escala semi-log, para re-\ngress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 3.\t...... 74\n5.40\tCompara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss\ne de Laplace. Regress\u00e3o nos dados de press\u00e3o usando o m\u00e9todo MQ. Caso 3. 74\n5.41\tCompara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss\ne de Laplace. Regress\u00e3o nos dados de press\u00e3o usando o m\u00e9todo MVA. Caso 3. 75\n5.42\tCompara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss\ne de Laplace. Regress\u00e3o nos dados da derivada usando o m\u00e9todo MQ. Caso 3. 75\n5.43\tCompara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss\ne de Laplace. Regress\u00e3o nos dados da derivada usando o m\u00e9todo MVA. Caso 3. . . . .............................................................   76\n5.44\tCompara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss\ne de Laplace. Regress\u00e3o no conjunto de dados de press\u00e3o e da derivada usando o m\u00e9todo MQ. Caso 3..................................................  76\n5.45\tCompara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss\ne de Laplace. Regress\u00e3o no conjunto de dados de press\u00e3o e da derivada usando o m\u00e9todo MVA. Caso 3.................................................  77\n5.46\tPress\u00e3o e Derivada da Press\u00e3o versus Tempo em escala log-log, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 4.\t..... 81\n5.47\tPress\u00e3o e Derivada da Press\u00e3o versus Tempo em escala semi-log, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 4.................81\n5.48\tPress\u00e3o e Derivada de Press\u00e3o versus Tempo em escala log-log, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 5.................90\n5.49\tPress\u00e3o e Derivada de Press\u00e3o versus Tempo em escala semi-log, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 5.\t...... 91\n5.50\tComportamento da m\u00e9dia dos res\u00edduos ao quadrado ao longo das itera\u00e7\u00f5es.\nCaso 5. . . .....................................................  91\n5.51\tComportamento da m\u00e9dia dos res\u00edduos absolutos ao longo das itera\u00e7\u00f5es.\nCaso 5. ..... ..................................................   92\n5.52\tComportamento da permeabilidade ao longo das itera\u00e7\u00f5es. Caso 5.\t.... 92\n5.53\tComportamento do fator de pel\u00edcula ao longo das itera\u00e7\u00f5es. Caso 5. . . , . 93\n5.54\tComportamento do coeficiente de estocagem ao longo das itera\u00e7\u00f5es. Caso 5. 93\n5.55\tComportamento do coeficiente de fluxo interporoso A ao longo das itera\u00e7\u00f5es.\nCaso 5.......................................................      94\n5.56\tComportamento da raz\u00e3o de armazenamentou\u00bb ao longo das itera\u00e7\u00f5es. CasoS. 94\n5.57\tVaria\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es no plano k-S para os v\u00e1rios\nm\u00e9todos. Caso 5. ....... ......................................... 95\n5.58\tVaria\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es no plano k-C para os v\u00e1rios\nm\u00e9todos. Caso 5..................................................  95\n5.59\tVaria\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es no plano k-A para os v\u00e1rios\nm\u00e9todos. Caso 5. ..............................................    96\n5.60\tVaria\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es no plano k-w para os v\u00e1rios\nm\u00e9todos. Caso 5. ........ ......................................   96\n5.61\tVaria\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es no plano A-w para os v\u00e1rios\nm\u00e9todos. Caso 5. ...............................................   97\n5.62\tVaria\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es no plano S-w para os v\u00e1rios\nm\u00e9todos. Caso 5. ..............................................    97\n5.63\tPress\u00e3o e Derivada de Press\u00e3o versus Tempo em escala log-Iog, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 6.\t...... 98\n5.64\tPress\u00e3o e Derivada de Press\u00e3o versus Tempo em escala semi-log, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 6......  .\t99\n5.65\tPress\u00e3o e Derivada de Press\u00e3o versus Tempo em escala log-Iog, para regress\u00e3o no conjunto de dados de press\u00e3o. Caso 7. .................104\n5.66\tPress\u00e3o e Derivada de Press\u00e3o versus Tempo em escala semi-log, para regress\u00e3o nos dados de press\u00e3o. Caso 7. ..... ....................  107\n5.67\tPress\u00e3o e Derivada de Press\u00e3o versus Tempo em escala log-Iog, para regress\u00e3o nos dados de press\u00e3o e da derivada. Caso 7............., . , , . 107\n5.68\tPress\u00e3o e Derivada de Press\u00e3o versus Tempo em escala semi-log, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 7...  108\nLista de Tabelas\n4.1\tProposta de modifica\u00e7\u00e3o dos dom\u00ednios dos par\u00e2metros. ..........  ,\t21\n5.1\tD \u00bfidos de reservat\u00f3rio para os casos 1 e 2..................    .\t24\n5.2\tDados de press\u00e3o versus tempo para o caso 1......................  25\n5.3\tCompara\u00e7\u00e3o do desempenho de v\u00e1rios m\u00e9todos de regress\u00e3o para os dados\ndo caso 1. . ...................................................   28\n5.4\tEstimativas iniciais utilizadas para v\u00e1rios m\u00e9todos de regress\u00e3o para os\ndados do caso 1 e do caso 2. .......... .........................  30\n5.5\tResultados dos v\u00e1rios m\u00e9todos de regress\u00e3o, Caso 1, Estimativas iniciais\nda tabela 5.4..............................................        31\n5.6\tRu\u00eddos introduzidos nos dados de press\u00e3o. Caso 2. . . .............56\n5.7\tCompara\u00e7\u00e3o do Desempenho de V\u00e1rios M\u00e9todos de Regress\u00e3o para os da-\ndos do caso 2. . . . ........................................      61\n5.8\tResultados dos V\u00e1rios M\u00e9todos de Regress\u00e3o. Caso 2. Estimativas iniciais\nna tabela 5.4 .\t............................................... 63\n5.9\tDados de Teservat\u00f3rio para o caso 3............................    65\n5.10\tDados de press\u00e3o versus tempo para o caso 3. ................ 66\n5.11\tCompara\u00e7\u00e3o do Desempenho de V\u00e1rios M\u00e9todos de Regress\u00e3o para os da-\ndos do caso 3................................................      67\n5.12\tEstimativas Iniciais Utilizadas para V\u00e1rios M\u00e9todos de Regress\u00e3o para os\ndados do caso 3...............................................     69\n5.13\tResultados dos V\u00e1rios M\u00e9todos de Regress\u00e3o. Caso 3. Estimativas iniciais\nna tabela 5.12 .\t................................................. 70\n5.14\tDado3 de reservat\u00f3rio para o caso 4............................... 77\n5.15\tDados de press\u00e3o versus tempo para o caso 4......................  78\n5.16\tCompara\u00e7\u00e3o do Desempenho de V\u00e1rios M\u00e9todos de Regress\u00e3o para os da-\ndos do caso 4. . . . ............................................  80\n5.17\tEstimativas Iniciais Utilizadas para V\u00e1rios M\u00e9todos de Regress\u00e3o para os\ndados do caso 4. ............ ...................................  82\n5.18\tResultados dos V\u00e1rios M\u00e9todos de Regress\u00e3o. Caso 4. Estimativas iniciais\nna tabela 5.17 .\t................................................. 83\n5.19\tDados de reservat\u00f3rio para os casos 5 e 6. ....  ................  84\n5.20\tDados de press\u00e3o versus tempo para o caso 5.  ...................  85\n5.21\tCompara\u00e7\u00e3o do Desempenho de V\u00e1rios M\u00e9todos de Regress\u00e3o para os da-\ndos do caso 5...................................................... 86\n5.22\tCompara\u00e7\u00e3o do Desempenho de V\u00e1rios M\u00e9todos de Regress\u00e3o para os da-\ndos do caso 5. ........ . .............................. ..........\t87\n5.23\tEstimativas Iniciais Utilizadas para V\u00e1rios M\u00e9todos de Regress\u00e3o para os\ndados do caso 5 e do caso 6..............................  ........\t88\n5.24\tResultados dos V\u00e1rios M\u00e9todos de Regress\u00e3o. Caso 5. Estimativas iniciais\nna tabela 5.23. ................................................    89\n5.25\tRu\u00eddos introduzidos nos dados de press\u00e3o. Caso 6. ....... .........99\n5.26\tCompara\u00e7\u00e3o do Desempenho de V\u00e1rios M\u00e9todos de Regress\u00e3o para os da-\ndos do caso 6. . . ..............................................  100\n5.27\tCompara\u00e7\u00e3o do Desempenho de V\u00e1rios M\u00e9todos de Regress\u00e3o para os da-\ndos do caso 6....................................................  101\n5.28\tResultados dos V\u00e1rios M\u00e9todos de Regress\u00e3o. Caso 6 . Estimativas iniciais\nna tabela 5.23................ ....................................102\n5.29\tDados\tde reservat\u00f3rio para o caso 7...............................104\n5.30\tDados\tde press\u00e3o versus tempo para o caso 7. ...................  105\n5.31\tDados\tde press\u00e3o versus tempo para o caso 7. ..................  106\n5.32\tPontos de m\u00ednimos locais e m\u00ednimo absoluto para os dados do caso 7 quando\nsubmetidos \u00e0s normas L1 e L2...................................    109\n5.33\tEstimativas Iniciais Utilizadas para V\u00e1rios M\u00e9todos de Regress\u00e3o para os\ndados do caso 7. . . ............................................  110\n5.34\tResultados dos V\u00e1rios M\u00e9todos de Regress\u00e3o. Caso 7 . Estimativas iniciais\nna tabela 5.33 .\t..................................................111\n1\tINTRODU\u00c7\u00c3O\nOs m\u00e9todos automatizados de determina\u00e7\u00e3o de par\u00e2metros de reservat\u00f3rios com aux\u00edlio de computador est\u00e3o recebendo especial aten\u00e7\u00e3o atualmente. Podemos listar algumas razoes para isto:\n\u2022\tOs m\u00e9todos automatizados permitem uma an\u00e1lise estat\u00edstica da qualidade da estimativa dos par\u00e2metros, calculando-se, por exemplo, intervalos de confian\u00e7a.\n\u2022\tTestes em que certas condi\u00e7\u00f5es necess\u00e1rias para permitir o uso de m\u00e9todos convencionais n\u00e3o s\u00e3o satisfeitas (exemplo: longos per\u00edodos de teste para atingir determinado regime de fluxo) podem ser analisados atrav\u00e9s de m\u00e9todos automatizados.\n\u2022\tTestes com vaz\u00e3o vari\u00e1vel, m\u00faltiplos fluxos seguidos de crescimento de press\u00e3o ou testes de inje\u00e7\u00e3o podem ser analisados utilizando t\u00e9cnicas apropriadas de superposi\u00e7\u00e3o.\n\u2022\tOs hist\u00f3ricos completos de press\u00e3o e vaz\u00e3o do teste podem ser utilizados em programas de ajuste automatizado se necess\u00e1rio, ao inv\u00e9s de um pequeno hist\u00f3rico antes do fluxo ou crescimento como \u00e9 feito nos m\u00e9todos convencionais. Este procedimento fornece par\u00e2metros de reservat\u00f3rio mais consistentes com os dados de teste, bem como permite uma melhor avalia\u00e7\u00e3o da escolha do modelo de reservat\u00f3rio.\n\u2022\tReservat\u00f3rios com geometrias complexas podem, em princ\u00edpio, ser simulados utilizando solu\u00e7\u00f5es j\u00e1 existentes, o que, no caso dos m\u00e9todos convencionais ou daqueles baseados em curvas-tipo, exigiria a constru\u00e7\u00e3o de in\u00fameras curvas para que se pudesse efetuar o ajustamento.\n\u00ab 0 aumento do uso de computadores com alta capacidade de mem\u00f3ria e baixo custo implicam na possibilidade de se utilizarem programas mais complexos e distribu\u00ed-los para as loca\u00e7\u00f5es remotas. A grande vantagem deste procedimento \u00e9 ter uma ferramenta poderosa para a an\u00e1lise na pr\u00f3pria loca\u00e7\u00e3o explorat\u00f3ria, o que pode ajudar o engenheiro no projeto e na simula\u00e7\u00e3o de testes, no monitoramento do progresso do teste e na aquisi\u00e7\u00e3o e avalia\u00e7\u00e3o dos dados na boca do po\u00e7o.\n0 tipo de automatiza\u00e7\u00e3o discutido neste trabalho se restringe \u00e0 utiliza\u00e7\u00e3o de m\u00e9todos de regress\u00e3o n\u00e3o linear aplicados a dados de testes de press\u00e3o em po\u00e7os de petr\u00f3leo.\npodemos verificar um consider\u00e1vel aumento na pesquisa de m\u00e9todos mais robustos de regress\u00e3o n\u00e3o linear na \u00faltima d\u00e9cada.\n0 principal objetivo de tais m\u00e9todos \u00e9 estimar os par\u00e2metros do reservat\u00f3rio a partir de quaisquer que sejam as estimativas iniciais, dentro de seus respectivos dom\u00ednios, de tal forma que o processo convirja para os valores corretos.\nNeste trabalho ser\u00e3o comparados os desempenhos de v\u00e1rios m\u00e9todos de regress\u00e3o n\u00e3o linear aplicados a dois modelos de reservat\u00f3rio: radial infinito homog\u00eaneo e radial infinito de dupla porosidade.\nOs principais m\u00e9todos aqui discutidos ser\u00e3o aqueles baseados na norma L2 (m\u00ednimos quadrados atrav\u00e9s do m\u00e9todo de Gauss-Newton modificado por Levenberg-Marquardt e decomposi\u00e7\u00e3o em valores singulares) e aqueles baseados na norma L1 (m\u00ednimos valores absolutos, m\u00ednimos valores absolutos modificado e m\u00e9todo de Nelder-Mead). Ser\u00e3o tamb\u00e9m propostas modifica\u00e7\u00f5es destes m\u00e9todos com o intuito de torn\u00e1-los mais robustos e garantir o significado f\u00edsico dos par\u00e2metros estimados.\n2\tREVIS\u00c3O BIBLIOGR\u00c1FICA.\nA maior parte dos m\u00e9todos de regress\u00e3o n\u00e3o linear apresentados na literatura se baseia no m\u00e9todo de Newton, onde a fun\u00e7\u00e3o a ser minimizada, o somat\u00f3rio dos quadrados dos residuos, \u00e9 aproximada por urna s\u00e9r\u00ede de Taylor truncada no termo quadr\u00e1tico. Tais m\u00e9todos, al\u00e9m de requererem a obten\u00e7\u00e3o da segunda derivada da fun\u00e7\u00e3o em quest\u00e3o, ge.ralm.ente de dif\u00edcil c\u00e1lculo, n\u00e3o ter\u00e3o garantia de converg\u00eancia se a estimativa inicial dos par\u00e2metros estiver muito longe dos valores corretos, pois a matriz Hessiana pode n\u00e3o ser positiva definida longe do valor correto. Somente pr\u00f3ximo aos valores corretos os res\u00edduos tendem a valores bem pequenos e s\u00e3o estes residuos que multiplicam as segundas derivadas, tornando portanto estes termos desprez\u00edveis. Devido a este problema \u00e9 que cada vez mais se procura robustecer estes m\u00e9todos atrav\u00e9s de modifica\u00e7\u00f5es.\nPosteriormente ao trabalho de Newton, Gauss prop\u00f4s uma modifica\u00e7\u00e3o, atualmente conhecida com m\u00e9todo de Gauss-Newton, onde, para simplificar o c\u00e1lculo, se desprezava o termo que inclui as segundas derivadas. Uma outra vantagem do m\u00e9todo de Gauss-Newton \u00e9 que ele produz uma matriz Hessiana positiva definida. A modifica\u00e7\u00e3o de Gauss, no entanto, como era de se esperar, tomou o m\u00e9todo mais sens\u00edvel \u00e0s estimativas iniciais. A justificativa para a aproxima\u00e7\u00e3o de Gauss-Newton, como j\u00e1 mencionado acima, \u00e9 que pr\u00f3ximo aos valores corretos os res\u00edduos tendem a valores bem pequenos e como s\u00e3o eles que multiplicam as segundas derivadas, tornam estes termos desprez\u00edveis garantindo a caracter\u00edstica de positiva definida \u00e0 matriz Hessiana.\nLevenberg [1] e posteriormente Marquardt [2] propuseram que, para melhorar o condicionamento da matriz Hessiana (matriz que cont\u00e9m as derivadas da fun\u00e7\u00e3o do m\u00e9todo de Gauss-Newton em rela\u00e7\u00e3o aos par\u00e2metros de regress\u00e3o), se adicionasse uma constante positiva \u00e0 diagonal desta matriz. Com tal modifica\u00e7\u00e3o, o m\u00e9todo de Gauss-Newton modificado por Levenberg-Marquardt tornou-se mais robusto.\nA aplica\u00e7\u00e3o destes m\u00e9todos \u00e0 an\u00e1lise de testes de press\u00e3o em po\u00e7os de petr\u00f3leo j\u00e1 tem um hist\u00f3rico consider\u00e1vel, podendo ser mencionados os seguintes trabalhos:\nJahns [3] elaborou um procedimento automatizado para a descri\u00e7\u00e3o bidimensional de um reservat\u00f3rio aplicando uma combina\u00e7\u00e3o de simula\u00e7\u00e3o e an\u00e1lise de regress\u00e3o utilizando dados de testes de interfer\u00eancia.\nCoais, Dempsey e Henderson [4] apresentaram um m\u00e9todo de caracteriza\u00e7\u00e3o de reservat\u00f3rios, similar ao de Jahns, onde empregaram uma combina\u00e7\u00e3o do m\u00e9todo de m\u00ednimos quadrados e de programa\u00e7\u00e3o linear aplicados a um hist\u00f3rico de press\u00f5es.\nThomas, Hellums e Reheis [5] aplicaram os m\u00e9todos propostos por Jahns e por Coats, Dempsey e Henderson em dois reservat\u00f3rios, um de g\u00e1s e um de \u00f3leo.\nEarlougher e Kersh [6] apresentaram os resultados da regress\u00e3o n\u00e3o linear para determina\u00e7\u00e3o de par\u00e2metros de reservat\u00f3rio aplicadas a dois casos: um teste de interfer\u00eancia e um teste de ^fall-ofP,\nHern\u00e1ndez e Swift [7] aplicaram o m\u00e9todo de m\u00ednimos quadrados utilizando uma pseudo-lineariza\u00e7\u00e3o entre os dados medidos e os par\u00e2metros de reservat\u00f3rio.\nRodgers et al\u00fc [8] utilizaram a regress\u00e3o n\u00e3o linear para estimativa de par\u00e1metros de reservat\u00f3rios limitados.\nRosa e Horne [9] estudaram a aplica\u00e7\u00e3o do m\u00e9todo de Gauss-Newton. modificado por Levenberg-Marquardt, bem como o m\u00e9todo de Gauss-Newton original, a reservat\u00f3rios homog\u00eaneos infinitos e reservat\u00f3rios infinitos com m\u00faltiplas camadas sem fluxo cruzado. Urna grande contribui\u00e7\u00e3o deste trabalho foi mostrar que as derivadas da press\u00e3o em rela\u00e7\u00e3o aos par\u00e2metros de regress\u00e3o podem ser obtidas no campo de Laplace, com posterior invers\u00e3o num\u00e9rica.\nBarua, Kucuk e G\u00f3mez-Angulo [10] aplicaram o m\u00e9todo de m\u00ednimos quadrados a reservat\u00f3rios de dupla porosidade.\nBarua ei alii [11] compararam v\u00e1rios m\u00e9todos tipo Newton aplicados a dados de reservat\u00f3rios homog\u00eaneos e de dupla porosidade.\nNanba e Home [12] analisaram o m\u00e9todo de Newton, o m\u00e9todo de Gauss-Newton, a modifica\u00e7\u00e3o proposta por Levenberg-Marquardt e a fatoriza\u00e7\u00e3o de Cholesky com e sem a modifica\u00e7\u00e3o introduzida por Gill e Murray [13].\nRosa e Horne [14] apresentaram os resultados da compara\u00e7\u00e3o entre os m\u00e9todos m\u00ednimos quadrados e m\u00ednimos valores absolutos aplicados \u00e0 regress\u00e3o n\u00e3o linear em dados de reservat\u00f3rios homog\u00eaneos e de dupla porosidade.\nCoelho [15] aplicou o m\u00e9todo desenvolvido por Greeenstadt [16] a reservat\u00f3rios estratificados com e sem fluxo cruzado.\nCarvalho et alii [17] analisaram um novo procedimento para a aplica\u00e7\u00e3o do m\u00e9todo de m\u00ednimos valores absolutos que, segundo estes autores, utiliza algoritmos desenvolvidos para o m\u00e9todo de m\u00ednimos quadrados.\n3\tMODELOS DE RESERVAT\u00d3RIO ESTUDADOS.\nNeste cap\u00edtulo ser\u00e3o apresentados os modelos matem\u00e1ticos dos reservat\u00f3rios estudados neste trabalho, bem como as defini\u00e7\u00f5es dos par\u00e2metros estimados.\n3.1\tReservat\u00f3rio Homog\u00eaneo Infinito com Estocagem e Efeito de Pel\u00edcula.\n0 problema aqui analisado tem as seguintes hip\u00f3teses b\u00e1sicas:\n\u2022 reservat\u00f3rio radial, horizontal, infinito, isotr\u00f3pico, isot\u00e9rmico e homog\u00eaneo.\n\u2022 po\u00e7o com raio finito igual a rw.\n\u2022 finido de compress\u00edbilidade pequena e constante, e viscosidade constante.\n\u2022 efeito de pel\u00edcula infinitesimal.\n\u2022 estocagem constante.\nA equa\u00e7\u00e3o diferencial em vari\u00e1veis adimensionais que rege o fluxo no reservat\u00f3rio pode ser escrita como:\n_1_d f dpD\\ _ dpo\nrDdrD \\drDj 9tD\n1 &lt;rD &lt;<x)\t; tD > 0\ncom as seguintes condi\u00e7\u00f5es inicial e de contorno:\nlim pd(td,\u00edo) \u2014 0\t;\t> 0\n1 &lt;rs &lt;oo\nCd\ndtD\ntD > 0\nto > 0\n(3.1)\n(3.2)\n(3.3)\n(3.4)\n(3-5)\nPd(Hj,0) -0\nAs vari\u00e1veis adimensionais s\u00e3o definidas como;\nPo(ro, *d) =\n\u00cdW>(M = Pd(C\u00edd) s\nkh\n(3.7)\n(3.8)\n0.894(7 r^Ztct\n0.000263\u00ed\u00bf\u00bf\n(3.10)\nonde utilizamos as unidades de campo inglesas e p \u00e9 a press\u00e3o, \u00e7 \u00e9 a vaz\u00e3o medida em condi\u00e7\u00f5es de superf\u00edcie, h \u00e9 a espessura do reservat\u00f3rio, /: \u00e9 a permeabilidade, B\u00e9o fator volume de forma\u00e7\u00e3o, p \u00e9 a viscosidade de fluido, C \u00e9 o coeficiente de estocagem, r \u00e9 a dist\u00e2ncia radial, p \u00e9 a porosidade, cj \u00e9 a compressibilidade total do sistema, t \u00e9 o tempo e S \u00e9 o fator de pel\u00edcula.\nAplicando a transformada de Laplace \u00e0 equa\u00e7\u00e3o diferencial e \u00e0s condi\u00e7\u00f5es de contorno e resolvendo o problema, chegamos \u00e0 seguinte solu\u00e7\u00e3o no campo de Laplace:\n\nPwd(u) =\n1\nKi(y/ty\n(3-11)\nKi(TS)\t1\nonde Kq e K\\ s\u00e3o fun\u00e7\u00f5es de Bessel modificadas de ordem zero e ordem um respectivamente e u \u00e9 o argumento no campo de Laplace.\nO desenvolvimento de tal solu\u00e7\u00e3o pode ser encontrado na refer\u00eancia [18].\nAs derivadas da queda de press\u00e3o em rela\u00e7\u00e3o aos par\u00e2metros da regress\u00e3o foram obtidas analiticamente e sua dedu\u00e7\u00e3o est\u00e1 apresentada no ap\u00eandice B. Estas derivadas, como ser\u00e1 mostrado adiante, s\u00e3o nescess\u00e1rias na aplica\u00e7\u00e3o de alguns m\u00e9todos de regress\u00e3o n\u00e3o linear.\nOs par\u00e2metros que ser\u00e3o obtidos atrav\u00e9s da regress\u00e3o n\u00e3o linear para este tipo de reservat\u00f3rio s\u00e3o a permeabilidade (k), o fator de pel\u00edcula (S) e o coeficiente de estocagem (C). Os demais par\u00e2metros necess\u00e1rios para o c\u00e1lculo da queda de press\u00e3o s\u00e3o considerados conhecidos.\n3.2\tReservat\u00f3rio Homog\u00eaneo de Dupla Porosidade Infinito com Estocagem e Efeito de Pel\u00edcula.\n0 problema aqui analisado tem as mesmas hip\u00f3teses b\u00e1sicas do item anterior, com exce\u00e7\u00e3o do acoplamento entre a matriz e as fraturas.\nA solu\u00e7\u00e3o para a queda de press\u00e3o ad\u00edmensional no po\u00e7o para este tipo de reservat\u00f3rio, no campo de Laplace, \u00e9 dada por [19]:\n\n\nAs vari\u00e1veis ad\u00edmensionais tamb\u00e9m s\u00e3o as mesmas definidas no item anterior, sendo utilizados a permeabilidade da fratura, e\ta estocabilidade do\nsistema fratura-matriz, nas defini\u00e7\u00f5es das equa\u00e7\u00f5es 3,6, 3.7, 3.9 e 3,10.\nA fun\u00e7\u00e3o /(u) representa o tipo de acoplamento entre a matriz do reservat\u00f3rio e as fraturas. Neste trabalho examinaremos dois casos, fluxo pseudo-permanente e fluxo transiente.\nNestes casos os par\u00e2metros obtidos pela regress\u00e3o n\u00e3o linear s\u00e3o a permeabilidade da fratura (&amp;/r), o fator de pel\u00edcula (S'), o coeficiente de estocagem (C), a raz\u00e3o de armazenamento (w) e o coeficiente de fluxo interporoso (\u00c0).\n3.2.1\tFluxo Pseudo-Permanente Matriz-EYatura.\nWarren e Root [19] propuseram este tipo de formula\u00e7\u00e3o para acoplar a matriz \u00e0s fraturas do reservat\u00f3rio. Neste caso a fun\u00e7\u00e3o f(u) \u00e9 dada por:\nw(l ~w)u + \u00c0 (l-w)u + X\nonde:\n+ (d\u2019VC\u00ed)m]\n__ arlkm\nA kt\n&amp;jr\n(3.13)\n(3.14)\n(3.15)\no - fator de forma.\n3.2.2\tFluxo Transiente Matriz-Fratura.\nDe Swaan [20] prop\u00f4s um acoplamento entre a matriz e as fraturas modelando a matriz como sendo um conjunto de esferas homogeneamente distribu\u00eddas numa rede de fraturas. Atrav\u00e9s deste modelo, De Swaan chegou \u00e0 seguinte fun\u00e7\u00e3o de acoplamento:\nonde u? e A s\u00e3o os mesmos definidos anteriormente.\nEsta solu\u00e7\u00e3o \u00e9, em termos pr\u00e1ticos, equivalente \u00e0quela encontrada modelando a matriz e as fraturas como placas horizontais paralelas, cuja equa\u00e7\u00e3o pode ser escrita como:\n/\u00edu) = w +\n(3.17)\n4\tMETODOS DE REGRESS\u00c3O N\u00c3O LINEAR.\nOs m\u00e9todos de regress\u00e3o analisados neste trabalho foram basicamente dois: os que utilizam a norma Ll, ou seja, minimizam o somat\u00f3rio dos valores absolutos ou m\u00f3dulos das diferen\u00e7as entre as press\u00f5es medidas em campo e as calculadas pelos modelos e os m\u00e9todos baseados na norma L2, onde o qne \u00e9 minimizado \u00e9 o somat\u00f3rio das diferen\u00e7as ao quadrado.\nNeste cap\u00edtulo ser\u00e3o apresentadas as formula\u00e7\u00f5es matem\u00e1ticas de cada m\u00e9todo, seja ele baseado na norma LI ou L2. Tamb\u00e9m ser\u00e3o discutidas as modifica\u00e7\u00f5es efetuadas em cada m\u00e9todo para melhorar sua robustez bem como para garantir um significado f\u00edsico aos par\u00e2metros por eles determinados. Paralelamente ser\u00e1 analisada uma maneira aproximada de determinar os intervalos de confian\u00e7a dos par\u00e2metros e ser\u00e3o apresentadas as formas das distribui\u00e7\u00f5es probabil\u00edsticas de Gauss e de Laplace associadas \u00e0s normas LI e L2 respectivamente.\n4.1\tM\u00e9todos Baseados na Norma L2.\nOs m\u00e9todos de regress\u00e3o baseados na norma L2 foram os que tiveram aplica\u00e7\u00e3o mais acentuada a dados de testes de press\u00e3o. Quase todos eles baseiam-se no m\u00e9todo doa m\u00ednimos quadrados, onde se procura minimizar o somat\u00f3rio dos quadrados das diferen\u00e7as entre os valores obtidos em campo e os valores da fun\u00e7\u00e3o calculados nos pontos dados para um determinado vetor \u00e3 de par\u00e2metros estimados. Outro m\u00e9todo baseado na minimiza\u00e7\u00e3o da norma L2 \u00e9 a decomposi\u00e7\u00e3o em valores singulares.\n4.1.1\tM\u00ednimos Quadrados (MQ).\nA fun\u00e7\u00e3o-objetivo a ser minimizada no m\u00e9todo de m\u00ednimos quadrados \u00e9:\n\u00a32(5)= Efr.-\u00edXa*.)!2\t(4i)\nonde npon \u00e9 o n\u00famero de pontos dados, x \u00e9 a vari\u00e1vel independente, Fea fun\u00e7\u00e3o que representa o modelo matem\u00e1tico e y \u00e9 o valor de F medido.\nEste m\u00e9todo consiste em se minimizar a fun\u00e7\u00e3o-objetivo acima atrav\u00e9s da aproxima\u00e7\u00e3o da fun\u00e7\u00e3o por uma s\u00e9rie de Taylor. No caso do m\u00e9todo de Newton, a s\u00e9rie de Taylor \u00e9 truncada no termo quadr\u00e1tico, dando um car\u00e1ter parab\u00f3lico \u00e0 fun\u00e7\u00e3o E^i aproxima\u00e7\u00e3o de E-^ o que, em princ\u00edpio, garantir\u00eda um ponto de m\u00ednimo. Ent\u00e3o:\nnpar\nE2-(\u00e3) = E2(\u00f5y +\u00a3(\u00ab*- aj) fc=l\nonde npar \u00e9 o n\u00famero de par\u00e2metros e o0 uma estimativa inicial para o vetor a a ser estimado.\nComo queremos minimizar E^ derivamos a express\u00e3o anterior em rela\u00e7\u00e3o a (\u00fcj \u2014 Qj), que denominamos :\nW\nnpar\ni=l\nd2E2 \\\n(4-3)\nj - 1,2,...,npar\nComo desejamos um m\u00ednimo, ent\u00e3o dE^/d^j ~ 0. Da\u00ed:\nnpar\nTemos portanto um sistema de npar equa\u00e7\u00f5es com npar inc\u00f3gnitas em onde:\nnp&amp;rt\n\u201c2 52 \u201c ^(\u201c0\u2019 x*)3 \u00ed=i\n(4.5)\ndF dF dotj \u00f4etk\n+ [pi - F(a0,3q)]\n(4.6)\nPodemos ent\u00e3o escrever a equa\u00e7\u00e3o 4.4 como:\nonde H \u00e9 conhecida como matriz Hessiana e u \u00e9 o vetor que cont\u00e9m os res\u00edduos.\nUma vez resolvido o sistema acima e determinado o vetor /?, achamos os novos par\u00e2metros atrav\u00e9s de:\naj = a\u201c + pdj\n(4-8)\nonde p \u00e9 um fator de relaxa\u00e7\u00e3o.\nUma das dificuldades do m\u00e9todo de Newton \u00e9 que o valor para o qual a solu\u00e7\u00e3o converge pode n\u00e3o ser um m\u00ednimo. Isto pode ocorrer se a superf\u00edcie tiver pontos de sela ou de m\u00e1ximo, o que, infelizmente, \u00e9 muito comum nas aplica\u00e7\u00f5es em an\u00e1lise de testes. Para o valor final de E? ser um m\u00ednimo, a matriz Hessiana deve ser positiva definida. Ela sempre \u00e9 positiva definida nas vizinhan\u00e7as de um m\u00ednimo, mas pode n\u00e3o ser em pontos distantes. 0 m\u00e9todo de Newton sempre converge se a estimativa inicial estiver pr\u00f3xima de m\u00ednimo, mas pode n\u00e3o convergir caso contr\u00e1rio, geralmente divergindo quando isto ocorre.\nGauss prop\u00f4s uma modifica\u00e7\u00e3o no m\u00e9todo de Newton no qual desprezam-se os termos da matriz Hessiana representados pela segunda derivada, que geralmente s\u00e3o de dif\u00edcil c\u00e1lculo. Por\u00e9m tal procedimento tem um pre\u00e7o em termos de robustez do m\u00e9todo, tornando-o mais sens\u00edvel \u00e0s estimativas iniciais.\nPosteriormente Levenberg [1] e Marquardt [2] propuseram uma altera\u00e7\u00e3o no m\u00e9todo de Gauss-Newton na qual, para melhorar o condicionamento da matriz Hessiana, soma-se a ela uma matriz diagonal D cujos elementos s\u00e3o iguais a uma constante positiva de valor Xl-m- Ap\u00f3s o c\u00e1lculo da fun\u00e7\u00e3o res\u00edduo na etapa n +1, se esta for menor que na etapa anterior, modifica-se o valor de Xl-m para \u00c1\u00bf_,u/10, caso contr\u00e1rio para\n4.1.2\tDecomposi\u00e7\u00e3o em Valores Singulares (DVS).\nOutra maneira de formular o problema \u00e9 escrever o desenvolvimento de uma s\u00e9rie de Taylor at\u00e9 o primeiro termo em cada ponto X{ ao redor de uma estimativa ou seja:\nyi ~ F\u00eda^Xi) + (ax - a?)\n+ (a2 - a$)\ni \u2014 l,npon\n\nComo temos npon equa\u00e7\u00f5es e npar inc\u00f3gnitas ( npon >>> ripar ) , temos um sistema sobredeterminado (ou retangular) que pode ser resolvido atrav\u00e9s da decomposi\u00e7\u00e3o em valores singulares. Este m\u00e9todo resolve o problema de forma similar aos m\u00ednimos quadrados, ou seja, ele minimiza a fun\u00e7\u00e3o x2 abaixo:\nE>(3) = X2 = IA.0-\t(4.10)\nonde:\nA \u00e9 o Jacobiano da fun\u00e7\u00e3o F em rela\u00e7\u00e3o aos par\u00e2metros a em cada ponto xt, \u00e9 o vetor inc\u00f3gnita.\n\u00d2 \u00e9 composto dos res\u00edduas em cada ponto x\u00ed, ou seja,\n.12\nb = yi~ F(a0,xi).\nA demonstra\u00e7\u00e3o da afirma\u00e7\u00e3o acima pode ser encontrada na refer\u00eancia [21] .\nA decomposi\u00e7\u00e3o em valores singulares, como o pr\u00f3prio nome j\u00e1 \u00cdndica, decomp\u00f5e a matriz A em tres outras matrizes, a saber:\n/\nA\n\\ /\nU\n/ \\\nW2\n\t/\t\\\n\t\t\n\t\\\t/\n(4.11)\nonde UeV s\u00e3o matrizes ortonormais, ou seja, a multiplica\u00e7\u00e3o de U por UT e de V por V? \u00e9 igual \u00e0 matriz identidade. A matriz W \u00e9 uma matriz diagonal com elementos positivos ou de valor igual a zero.\nNa refer\u00eancia [21] \u00e9 demonstrado que se A \u00e9 uma matriz do sistema A . \u00a13 ~ b, com a sua decomposi\u00e7\u00e3o podemos obter d atrav\u00e9s de:\n\u00a3 = V [diag (1/wj)] (17Tb)\t(4.12)\nonde a matriz diag\u00edl / w-j) \u00e9 uma matriz diagonal composta pelos inversos dos valores da matriz diagonal W.\n4.2\tM\u00e9todos Baseados na Norma Ll.\nA norma Ll baseia-se na mimmiza\u00e7\u00e3o da seguinte fun\u00e7\u00e3o objetivo:\n\u00a3i(o) ~ E\t(4.13)\ni=sl\nApesar da minimiza\u00e7\u00e3o do somat\u00f3rio dos m\u00f3dulos das diferen\u00e7as entre os valores medidos em campo e os calculados analiticamente ser a primeira id\u00e9ia que ocorre na determina\u00e7\u00e3o de par\u00e2metros n\u00e3o lineares, tal procedimento n\u00e3o teve desenvolvimento imediato devido \u00e0 dificuldade de se manipular a fun\u00e7\u00e3o m\u00f3dulo analiticamente, pois tal fun\u00e7\u00e3o n\u00e3o tem uma derivada cont\u00ednua.\nSe fizermos um pequeno racioc\u00ednio sobre este m\u00e9todo, notaremos que nos casos em que os erros experimentais forem grandes em apenas alguns pontos, o que normalmente ocorre, este m\u00e9todo deve ter melhor desempenho que o de m\u00ednimos quadrados, pois este \u00faltimo tende a dar peso maior (o res\u00edduo \u00e9 elevado ao quadrado) a pontos com grande afastamento da curva, desviando a curva em dire\u00e7\u00e3o a eles.\n4.2.1\tM\u00e9todo dos M\u00ednimos Valores Absolutos (MVA).\nRosa e Horne [14] utilizaram em seu trabalho um algoritmo que minimizava a soma dos m\u00f3dulos numa regress\u00e3o linear m\u00faltipla. Para aplic\u00e1-lo numa regress\u00e3o n\u00e3o linear, estes autores propuseram a metodologia apresentada abaixo.\nDesenvolvamos em s\u00e9rie de Taylor at\u00e9 o primeiro termo um determinado ponto da fun\u00e7\u00e3o-modelo F:\nyi ~ F(aQ, Xi) + (ttj - aj)\n4\" \u25a0 \u2022 \u25a0 4* ( \u00ediripdr\ni = 1,... \u00a1npon,\n(4.14)\nRearranjando o sistema acima, temos:\nyi - F(a0, Xi) ~ (oti - a?)\n/\to J \\\n+ . , . + (Ctnpar anpar) I\tI\nK^npar/^-t = 1,... ,npon\nonde o problema agora \u00e9 de uma regress\u00e3o linear. Conforme discutido por Rosa e Horne [14], pode ser feita uma regress\u00e3o linear m\u00faltipla nas equa\u00e7\u00f5es 4.15 minimizando n\u00e3o mais o somat\u00f3rio das diferen\u00e7as ao quadrado, mas sim o somat\u00f3rio dos m\u00f3dulos das diferen\u00e7as.\nA equa\u00e7\u00f5es 4.15 podem ser reescritas da seguinte maneira:\nWi \u2014 \u00bf31\t+ $2^\u00ed,2 + ' \u2022 - + finparVi,npaT !\t2 \u2014 1,... , npon\nonde:\nWi ~yi~ F(oo, aq) ; i = l,npon\nPj =\t; j = 1, npar\ndF(\u00e3, Xi) daj\ni \u2014 1,npon ; j = 1,npar\n\u00ab0\nA cada itera\u00e7\u00e3o da regress\u00e3o linear m\u00faltipla aplicada \u00e0 equa\u00e7\u00e3o 4.16, ap\u00f3s o c\u00e1lculo de \u00bf3, obtemos os novos valores de a , ou seja:\n- a* + \u00a3\t(4.20)\nOutra maneira de se minimizar a soma dos m\u00f3dulos dos res\u00edduos foi proposta em 1979 por El-Attar, Vidyasagar e Dutta [23] e utilizada recentemente por Carvalho et alii [17], Segundo estes \u00faltimos autores, este m\u00e9todo tem a vantagem de utilizar algoritmos de regress\u00e3o n\u00e3o linear baseados na norma L2. Tal procedimento \u00e9 baseado na minimiza\u00e7\u00e3o da seguinte fun\u00e7\u00e3o:\nnpcm ........\nEi (o) = jr y/rl+E\t(4.21)\nonde Ff s\u00e3o os res\u00edduos e e \u00e9 um n\u00famero suficientemente pequeno. EI-Attar, Vidyasagar e Dutta [23] mostraram que a equa\u00e7\u00e3o 4.21 \u00e9 minimizada para valores decrescentes de \u00a3 e a solu\u00e7\u00e3o a* para a, qual a sequ\u00eancia converge quando t \u2014+ 0 \u00e9 uma solu\u00e7\u00e3o para a norma Ll. Em outras palavras, a equa\u00e7\u00e3o 4.21 pode ser reescrita em termos de uma norma L2 equivalente, ou seja:\nnpon\n\u00a31(5) = E P2i&lt;4-22) 1=1\nonde:\nP\u00ed = (^ + c)1/4\t(4.23)\nAs vantagens de tal procedimento, segundo Carvalho et alii [17], s\u00e3o: i) as derivadas parciais da equa\u00e7\u00e3o 4.22 s\u00e3o obtidas facilmente e s\u00e3o v\u00e1lidas em todo o dom\u00ednio; ii) os algoritmos de solu\u00e7\u00e3o da norma L2 s\u00e3o de dom\u00ednio p\u00fablico e podem ser aplicadas a este problema.\nEste m\u00e9todo n\u00e3o ser\u00e1 analisado no presente trabalho, por\u00e9m cabe aqui comentar que o segundo argumento a favor deste procedimento n\u00e3o \u00e9 mais v\u00e1lido pois j\u00e1 existem v\u00e1rios pacotes de rotinas matem\u00e1ticas que disp\u00f5em de algoritmos para solu\u00e7\u00e3o de regress\u00f5es baseadas na norma Ll, bem como o m\u00e9todo MVAM que tamb\u00e9m se utiliza de rotinas da norma L2 para resolver um problema baseado na norma Ll.\n4.2.2\tM\u00e9todo dos M\u00ednimos Valores Absolutos Modificado (MVAM).\nUma outra maneira de se obter o m\u00ednimo da fun\u00e7\u00e3o somat\u00f3rio dos m\u00f3dulos dos res\u00edduos \u00e9 utilizar uma modifica\u00e7\u00e3o no m\u00e9todo de m\u00ednimos quadrados acrescentando-se um peso a cada ponto. Este peso \u00e9 proporcional ao inverso do m\u00f3dulo do res\u00edduo naquele ponto na itera\u00e7\u00e3o anterior. Em outras palavras, a nova fun\u00e7\u00e3o objetivo pode ser escrita como:\n\u00e8\u00ed\nonde n representa o n\u00famero da itera\u00e7\u00e3o.\nEsta forma da fun\u00e7\u00e3o objetivo j\u00e1 foi utilizada anteriormente por Schlossmacher\n[24], aplicada a problemas lineares.\nComo podemos notar atrav\u00e9s da f\u00f3rmula acima, quanto mais nos aproximamos dos valores corretos, mais o termo do somat\u00f3rio tende ao valor de m\u00f3dulo do res\u00edduo, ou seja, estamos minimizando, no limite, a norma Ll.\nUm problema que pode ocorrer neste m\u00e9todo \u00e9 a instabilidade num\u00e9rica devida \u00e0 presen\u00e7a de res\u00edduos muito pequenos. Tal problema foi resolvido neste estudo desprezando-se os res\u00edduos menores que um certo valor m\u00ednimo. 0 valor utilizado neste trabalho foi de 10~9 quando se utilizam os valores de press\u00e3o em atm. Este valor foi determinado partindo-se do valor 10~3 e diminuindo-o at\u00e9 que n\u00e3o houvesse modifica\u00e7\u00e3o nos resultados, tanto em termos de n\u00famero de itera\u00e7\u00f5es como nos valores determinados.\nOutra pequena inconveni\u00eancia que este m\u00e9todo geralmente apresenta \u00e9 a necessidade de um grande n\u00famero de itera\u00e7\u00f5es para se alcan\u00e7ar a converg\u00eancia.\n4.2.3\tM\u00e9todo Combinado: M\u00ednimos Valores Absolutos Modificado - M\u00ednimos Valores Absolutos (MVAM-MVA).\nPara aproveitar as vantagens dos dois m\u00e9todos acima descritos, podemos combin\u00e1-los. Esta combina\u00e7\u00e3o foi proposta por llosa [22]. Naquele trabalho o autor usou o m\u00e9todo MVAM durante as cinco primeiras itera\u00e7\u00f5es, passando a seguir para o m\u00e9todo MVA, aproveitando a robustez do MVAM em rela\u00e7\u00e3o \u00e0 converg\u00eancia a partir de estimativas Iniciais distantes da solu\u00e7\u00e3o. Neste trabalho a troca de um m\u00e9todo para outro \u00e9 feita quando as varia\u00e7\u00f5es dos par\u00e2metros entre duas itera\u00e7\u00f5es consecutivas \u00e9 menor que um valor limite prefixado. Esta troca \u00e9 vantajosa pois, quando o m\u00e9todo converge, o MVA \u00e9 muito mais r\u00e1pido que o MVAM.\nNeste trabalho foi utilizado ainda outro crit\u00e9rio para troca do MVAM para o MVA, o qual se baseava na varia\u00e7\u00e3o do res\u00edduo ao inv\u00e9s das varia\u00e7\u00f5es dos par\u00e2metros. Tal procedimento n\u00e3o se mostrou o melhor devido a problemas de diverg\u00eancia em alguns\ncasos, e foi abandonado.\n4.2.4\tM\u00e9todo de Nelder-Mead (NM).\nEste m\u00e9todo, cuja descri\u00e7\u00e3o pode ser encontrada na refer\u00eancia [25], n\u00e3o \u00e9 propriamente uma norma Ll, pois atrav\u00e9s dele podemos minimizar qualquer norma pr\u00e9-estabelecida.\nNeste trabalho testaremos a aplica\u00e7\u00e3o deste m\u00e9todo \u00e0 an\u00e1lise automatizada de testes.\n0 m\u00e9todo NM utiliza o m\u00e9todo simplex para localizar um m\u00ednimo local de uma fun\u00e7\u00e3o de v\u00e1rias vari\u00e1veis. Para melhor exemplificar examinemos o caso de uma fun\u00e7\u00e3o de duas vari\u00e1veis. Neste caso o simplex \u00e9 um tri\u00e2ngulo, onde o procedimento do m\u00e9todo NM compara o valor da fun\u00e7\u00e3o em cada v\u00e9rtice do tri\u00e2ngulo (j\u00e1 neste ponto notamos uma grande diferen\u00e7a em rela\u00e7\u00e3o aos outros m\u00e9todos, pois ele necessita de um n\u00famero de estimativas iniciais igual ao n\u00famero de par\u00e2metros da regress\u00e3o mais um). 0 pior v\u00e9rtice do tri\u00e2ngulo \u00e9 rejeitado e um novo ponto \u00e9 calculado. Atrav\u00e9s deste procedimento um novo tri\u00e2ngulo \u00e9 gerado e o algoritmo de procura reinicia. Este processo gera uma sequ\u00eancia de tri\u00e2ngulos (que devem ter diferentes formas) em cujos v\u00e9rtices a fun\u00e7\u00e3o se toma cada vez menor. Finalmente o tamanho dos tri\u00e2ngulos \u00e9 diminu\u00eddo e o m\u00ednimo \u00e9 encontrado.\nPara melhor entendermos este exemplo, utilizemos uma fun\u00e7\u00e3o /(x,j/) a ser minimizada. Para come\u00e7armos o processo necessitamos de tres v\u00e9rtices para montar o tri\u00e2ngulo; H\tfe = 1,2,3. A fun\u00e7\u00e3o\t\u00e9 ent\u00e3o avaliada em cada um\ndestes tres pontos, %k =\tk = 1,2,3. Os subscritos s\u00e3o ent\u00e3o reordenados para\nque Zi &lt;z% &lt;*3 - Usemos ent\u00e3o a seguinte nota\u00e7\u00e3o:\n\u00a3 = (zi^i) ^ = (^2,^) ^=(^3,^3)\npara tornar o exemplo mnem\u00f3nico: E \u00e9 o v\u00e9rtice excelente, B \u00e9 o bom e P \u00e9 o pior.\n0 processo de constru\u00e7\u00e3o do novo tri\u00e2ngulo utiliza o ponto m\u00e9dio do segmento que une E a B. Ele \u00e9 encontrado atrav\u00e9s da m\u00e9dia das coordenadas, ou seja:\nM =\nE d- B\n2\n=(\n(4.25)\nSj +32\n2\nyi +?2\\\n2 )\nA fun\u00e7\u00e3o diminui quando nos movemos no lado do tri\u00e2ngulo inicial de P para E e tamb\u00e9m diminui quando nos movemos de P para B. Ent\u00e3o \u00e9 f\u00e1cil raciocinar que a fun\u00e7\u00e3o tamb\u00e9m diminuir\u00e1 quando caminharmos para longe de P em dire\u00e7\u00e3o ao lado oposto da linha que une E a B, Escolhemos ent\u00e3o o ponto R \u201crefletindo\" o tri\u00e2ngulo atrav\u00e9s do lado EB. Ent\u00e3o para determinarmos R, primeiro determinamos M, o ponto m\u00e9dio entre E e B, desenhamos um segmento de reta de P a M determinando seu comprimento d.\nEstendemos este \u00faltimo segmento uma dist\u00e2ncia d a partir de M para localizar o ponto\nR (ver figura 4.1). Vetorialmente o ponto R \u00e9 calculado por:\nR = M + (M - P) = 2M - P\t(4.26)\nSe o valor da fun\u00e7\u00e3o no ponto R for menor que o valor da fun\u00e7\u00e3o no ponto P estamos nos movendo na dire\u00e7\u00e3o correta para encontrarmos o m\u00ednimo, Se al\u00e9m disso o valor da fun\u00e7\u00e3o em R for menor do que em E, podemos ent\u00e3o estender o tri\u00e2ngulo EBR para o tri\u00e2ngulo EBF, onde F \u00e9 encontrado movendo-se uma dist\u00e2ncia d adicional ao longo da reta MR a partir de R (ver figura 4.2 ). Se o valor da fun\u00e7\u00e3o em F for menor que em R, achamos ent\u00e3o um v\u00e9rtice melhor. O c\u00e1lculo vetorial de F \u00e9:\n(4-27)\nFigura 4.1: M\u00e9todo de Nelder-Mead. Reflex\u00e3o do ponto P.\nSe, por outro lado, o valor da fun\u00e7\u00e3o em R for igual ou maior que em P, necessitamos encontrar outro ponto. Geralmeute o valor de M \u00e9 menor, mas n\u00e3o podemos escolhe-lo pois necessitamos de um tri\u00e2ngulo. Consideremos ent\u00e3o o ponto C que \u00e9 o ponto m\u00e9dio entre M e R. Se o valor da fun\u00e7\u00e3o em C for menor que em P, temos um novo tri\u00e2ngulo (ver figura 4,3 ).\nEm \u00faltimo caso, se o valor da fun\u00e7\u00e3o em C for maior que em P, devemos encolher o tri\u00e2ngulo original ao redor de E, trocando o ponto P pelo ponto m\u00e9dio de EP, agora chamado de S, e o ponto B por M (que \u00e9 o ponto m\u00e9dio de EB) (ver figura 4,4 ).\nEste processo continua at\u00e9 que a diferen\u00e7a entre os valores da fun\u00e7\u00e3o nos pontos P e E seja menor que uma determinada toler\u00e2ncia.\nA grande vantagem deste m\u00e9todo \u00e9 a n\u00e3o necessidade de c\u00e1lculos de derivadas (quando estas s\u00e3o poss\u00edveis, o que n\u00e3o \u00e9 o caso da fun\u00e7\u00e3o m\u00f3dulo), por\u00e9m geralmente este m\u00e9todo \u00e9 bem lento, necessitando de grande n\u00famero de itera\u00e7\u00f5es para convergir .\nFigura 4.2: M\u00e9todo de Nelder-Mead. Extens\u00e3o da reflex\u00e3o do ponto P.\nFigura 4.3: M\u00e9todo de Nelder-Mead. Contra\u00e7\u00e3o da reflex\u00e3o do ponto P.\nFigura 4.4: M\u00e9todo de Nelder-Mead. Encolhimento do t-ri\u00e1gulo original.\n4.3\tCaracter\u00edsticas dos M\u00e9todos.\nNesta se\u00e7\u00e3o ser\u00e3o analisadas algumas caracter\u00edsticas espec\u00edficas de cada m\u00e9todo, bem como modifica\u00e7\u00f5es introduzidas por este trabalho para melhorar o desempenho e a velocidade daqueles m\u00e9todos.\n4.3.1\tOtimiza\u00e7\u00e3o Restrita.\nQuando \u00e9 feita uma regress\u00e3o n\u00e3o-linear, n\u00e3o h\u00e1, a princ\u00edpio, qualquer limita\u00e7\u00e3o aos valores que os par\u00e2metros de regress\u00e3o ir\u00e3o assumir no decorrer das itera\u00e7\u00f5es, sendo que os dom\u00ednios destes par\u00e2metros, do ponto de vista da regress\u00e3o, s\u00e3o constitu\u00eddos pelo universo dos n\u00fameros reais. Mas em geral a regress\u00e3o \u00e9 feita em cima de um modelo f\u00edsico-matem\u00e1tico onde os par\u00e2metros a serem determinados tem um dom\u00ednio limitado, como por exemplo a permeabilidade que sempre deve ser maior que zero.\nNa literatura tem sido utilizado o seguinte procedimento para introdu\u00e7\u00e3o desses limites no processo de regress\u00e3o. Adiciona-se \u00e0 fun\u00e7\u00e3o objetivo uma nova fun\u00e7\u00e3o que tenda a zero dentro do dom\u00ednio do par\u00e2metros e tenda a valores muito grandes fora dele. Como estamos querendo minimizar a fun\u00e7\u00e3o objetivo, este procedimento ir\u00e1, automaticamente, tender a afastar o par\u00e2metro da regi\u00e3o n\u00e3o desejada.\nTomemos como exemplo uma fun\u00e7\u00e3o de uma vari\u00e1vel mostrada na figura 4.5. Suponhamos que o dom\u00ednio f\u00edsico do par\u00e2metro em quest\u00e3o, no caso a vari\u00e1vel a, seja que a tem que ser maior que um certo a0. Ent\u00e3o se somarmos \u00e0 fun\u00e7\u00e3o original f uma nova fun\u00e7\u00e3o pen dada por:\npen\u00edu) ~------- (4.28)\na \u2014 aQ\nonde S \u00e9 um n\u00famero pequeno, a nova fun\u00e7\u00e3o objetivo ser\u00e1:\n/\u2019(a) = /(a) 4-pen(<i)\t(4.29)\nNote na figura 4.5, que quando o valor de u tende a a$ pela direita, a fun\u00e7\u00e3o f* tende a infinito.\nUm problema com este tipo de procedimento \u00e9 que se o valor de a em determinada itera\u00e7\u00e3o estiver no lado esquerdo de \u00abo (neste exemplo), a regress\u00e3o tender\u00e1 a colocar o valor de u em &amp;\u00e3, pois este \u00e9 o ponto de m\u00ednimo da fun\u00e7\u00e3o /*, al\u00e9m de geralmente causar problemas matem\u00e1ticos.\nEste tipo de fun\u00e7\u00e3o penalidade \u00e9 de uso interessante no caso em que o par\u00e2metro em quest\u00e3o tenha um dom\u00ednio fechado do ponto de vista f\u00edsico-matem\u00e1tico, como \u00e9 o caso da permeabilidade neste trabalho, pois trabalhamos com a raiz quadrada de seu valor.\n\nFigura 4.5: Exemplifica\u00e7\u00e3o de otimiza\u00e7\u00e3o restrita com intervalo fechado.\nNeste trabalho ser\u00e1 proposta uma nova forma de fun\u00e7\u00e3o penalidade para alguns par\u00e2metros, como por exemplo o fator de pel\u00edcula. Esta forma proposta n\u00e3o tende para infinito no limite do intervalo, mas para valores muito grandes fora do dom\u00ednio do par\u00e2metro. Tal fun\u00e7\u00e3o \u00e9:\nFigura 4.6: Exemplifica\u00e7\u00e3o de otimiza\u00e7\u00e3o restrita com intervalo aberto.\nA vantagem de se utilizar tal fun\u00e7\u00e3o \u00e9 que a regress\u00e3o n\u00e3o \u00e9 interrompida se os valores dos par\u00e2metros ca\u00edrem fora do dom\u00ednio pr\u00e9-estabelecido.\nConv\u00e9m lembrar que este tipo de otimiza\u00e7\u00e3o s\u00f3 pode ser utilizado quando estamos trabalhando com problemas que minimizam um somat\u00f3rio, como \u00e9 o caso do MQ e MVAM, sendo imposs\u00edvel sua utiliza\u00e7\u00e3o nos m\u00e9todos DVS, MVA e NM.\nmudan\u00e7a de dom\u00ednio nos par\u00e2metros de regress\u00e3o. Por exemplo, no caso da permeabilidade, trocamos o seu valor pelo seu logaritmo natural. A tabela 4.1 mostra as fun\u00e7\u00f5es testadas para mudan\u00e7a de dom\u00ednio ao caso de reservat\u00f3rio homog\u00eaneo.\npar\u00e2metro\tdom\u00ednio\tpar\u00e2metro modificado\tdom\u00ednio\nk\tfc > 0\tln(\u00c2r)\t-\u201400 a 00\n0\tc > 0\tln(C)\t\u2014oc a 00\nS\t-7 &lt;S &lt;25\ttan _ |]\t\u201400 a 00\nA\t\u00c0 > 0\tln(A)\t\u2014 CO t\u00ed 00\n\u00edu\t0 &lt;w &lt;1\ttan Ijtuj \u2014\t\u2014com 00\nTabela 4.1: Proposta de modifica\u00e7\u00e3o dos dom\u00ednios dos par\u00e2metros.\nA modifica\u00e7\u00e3o de dom\u00ednio que melhores resultados gerou foi a troca da permeabilidade pelo seu logaritmo natural. A troca do coeficiente de estocagem pelo seu logaritmo natural tamb\u00e9m resultou em resultados satisfat\u00f3rios, por\u00e9m a transforma\u00e7\u00e3o no fator de pel\u00edcula n\u00e3o deu bons resultados, sendo abandonada. A troca do coeficiente de fluxo interporoso pelo seu logaritmo e a transforma\u00e7\u00e3o no par\u00e2metro de armazenamento n\u00e3o trouxeram resultados muito bons como era esperado, Para o m\u00e9todo de Nelder-Mead estas modifica\u00e7\u00f5es seriam extremamente necess\u00e1rias, por\u00e9m a \u00faltima modifica\u00e7\u00e3o proposta (no par\u00e2metro de armazenamento) se mostrou infrut\u00edfera, levando o m\u00e9todo a convergir para valores incorretos. Pode-se explicar este comportamento analisando a curva da fun\u00e7\u00e3o tangente. Quando seu argumento tende a valores pr\u00f3ximos a sr/2 ela tende a infinito rapidamente. Consequentemente, nesta regi\u00e3o grandes varia\u00e7\u00f5es no valor da fun\u00e7\u00e3o n\u00e3o correspondem a varia\u00e7\u00f5es significativas no valor do argumento, que no caso \u00e9 o nosso par\u00e2metro de regress\u00e3o. Em vista disto tal modifica\u00e7\u00e3o foi abandonada no decorrer do desenvolvimento deste trabalho.\n4.3,2\tAn\u00e1lise Estat\u00edstica da Regress\u00e3o.\nNuma regress\u00e3o n\u00e3o linear \u00e9 desej\u00e1vel que se determinem al\u00e9m dos valores dos par\u00e2metros os intervalos de confian\u00e7a destes na forma de limites superior e inferior. Estes intervalos s\u00e3o fun\u00e7\u00e3o da qualidade dos pontos experimentais e do seu n\u00famero. Se definirmos 7 como \"n\u00edvel de significancia\u201d, podemos dizer que *\u2018o valor de a (par\u00e2metro estimado) est\u00e1 dentro do intervalo calculado\u201d com probabilidade (1 - 7) de estar correto. O intervalo \u00e9 denominado como intervalo de confian\u00e7a de 100(1 \u2014 7) %.\nDe acordo com Hartley [26], \u00e9 poss\u00edvel determinar com exatid\u00e3o estes intervalos de confian\u00e7a nas regress\u00f5es n\u00e3o lineares, por\u00e9m tal procedimento via de regra \u00e9 muito dispendioso em termos de c\u00e1lculo. Como nos interessa apenas uma aproxima\u00e7\u00e3o destes intervalos, Dogru, Dixon e Edgar [27] apresentaram um m\u00e9todo simples de estim\u00e1-los.\nDefinamos o erro m\u00e9dio quadr\u00e1tico como:\nEMQ =\nSQR\nnpon \u2014 npar\n(4.31)\nonde SQR \u00e9 a soma dos quadrados dos res\u00edduos.\nO intervalo de confian\u00e7a de cada par\u00e2metro pode ent\u00e3o ser calculado como:\na* - Aa*&lt;\t&lt;o* + Aa*\t(4.32)\nonde o* \u00e9 a estimativa de otj da \u00faltima itera\u00e7\u00e3o, e:\n; npon\u2122 npar\t(4.33)\nonde hjj \u00e9 o elemento da diagonal da inversa da matriz Hessiana correspondente ao elemento oq e ty^inpon-npar \u00e9 o valor da distribui\u00e7\u00e3o t de Student para um n\u00edvel de sig-nific\u00e2ncia 7 e grau de liberdade npon \u2014 nparr Como comentado acima, um n\u00edvel de signific\u00e2ncia 7 implica em um intervalo de confian\u00e7a de 1\u00dc0 (1 \u2014 7) %. Neste trabalho utilizamos um n\u00edvel de signific\u00e2ncia de 5 %, o que significa que os par\u00e2metros estimados tem 95 % de probabilidade de estarem corretos dentro do intervalo calculado.\n4.3.3\tDistribui\u00e7\u00f5es Probabil\u00edsticas de Gauss e de Laplace.\nA an\u00e1lise destas duas distribui\u00e7\u00f5es em quest\u00e3o \u00e9 interessante pois elas est\u00e3o intimamente ligadas \u00e0s normas LI e L2. Pode ser demonstrado que se os erros ou res\u00edduos est\u00e3o distribu\u00eddos de acordo com uma Gaussiana, o melhor tipo de regress\u00e3o a utilizar \u00e9 a norma L2, Se, por outro lado, os res\u00edduos se distribuem de acordo com uma exponencial alongada, o melhor tipo de regress\u00e3o a se utilizar \u00e9 a norma Ll.\nA curva Gaussiana ou distribui\u00e7\u00e3o probabil\u00edstica de Gauss pode ser definida como:\nEXP\n2v3\n(4.34)\nonde n \u00e9 a fun\u00e7\u00e3o densidade, x \u00e9 o valor onde queremos calcular o valor da fun\u00e7\u00e3o densidade, ip \u00e9 a. m\u00e9dia dos valores amostrados e&lt;7 \u00e9 o desvio padr\u00e3o, ou seja:\n(4.35)\nEste tipo de distribui\u00e7\u00e3o \u00e9 admitido nos m\u00e9todos MQ e DVS.\nJ\u00e1 a distribui\u00e7\u00e3o probabil\u00edstica de Laplace ou exponencial alongada tem sua fun\u00e7\u00e3o densidade definida como;\nn(zw<y) = ~ EXP\n(T\n(4.36)\nEste tipo de distribui\u00e7\u00e3o \u00e9 admitido nos m\u00e9todos MVA, MVAM, MVAM-MVA\ne NM.\n4.3,4\tInvers\u00e3o Num\u00e9rica da Transformada de Laplace.\nComo foi demonstrado por Rosa e Horne [9], podemos obter as derivadas da fun\u00e7\u00e3o em quest\u00e3o no campo de Laplace e posteriormente inverte-las atrav\u00e9s do algoritmo de Stehfest [28]. Esta proposi\u00e7\u00e3o tornou tal procedimento extremamente pr\u00e1tico, pois obter a resposta de um determinado modelo no campo de Laplace \u00e9, em geral, um problema de solu\u00e7\u00e3o razoavelmente f\u00e1cil. Recentemente Burgeoues e Horne [29] propuseram que a regress\u00e3o seja feita inteiramente no campo de Laplace. No presente trabalho, no entanto, a estimativa dos par\u00e2metros foi feita no campo real ap\u00f3s a invers\u00e3o das derivadas pelo algoritmo de Stehfest.\n5\tCOMPARA\u00c7\u00c3O ENTRE OS M\u00c9TODOS E DISCUSS\u00c3O DOS RESULTADOS.\nNeste cap\u00edtulo ser\u00e3o apresentados os resultados da aplica\u00e7\u00e3o dos diversos m\u00e9todos de regress\u00e3o n\u00e3o linear aos dois modelos de reservat\u00f3rio j\u00e1 apresentados anteriormente.\n5.1\tAn\u00e1lise de Casos de Reservat\u00f3rios com Comportamento Homog\u00eaneo Infinito.\nNo caso do modelo de reservat\u00f3rio homog\u00eaneo infinito ser\u00e3o discutidos quatro casos, sendo que os dois primeiros s\u00e3o do mesmo teste, por\u00e9m no segundo foram acrescentados ru\u00eddos propositalmente.\nOs dados de reservat\u00f3rio do primeiro caso est\u00e3o mostrados na tabela 5.1 e na tabela 5.2 est\u00e3o os dados de press\u00e3o versus tempo. Estes dados foram obtidos da refer\u00eancia [14].\nNa tabela 5.3 est\u00e3o os resultados comparativos de sete m\u00e9todosfMQ, MQ mod., MVAM, MVA, MVAM-MVA, DVS e NM) aplicados aos dados de press\u00e3o, aos dados da derivada logar\u00edtmica da press\u00e3o em rela\u00e7\u00e3o ao tempo e ao conjunto destes dois dados. Tamb\u00e9m foram testadas as modifica\u00e7\u00f5es nos dom\u00ednios dos par\u00e2metros para o m\u00e9todo MQ, que neste caso foi chamado de MQ mod.\nPodemos observar que, em termos pr\u00e1ticos, os par\u00e2metros obtidos por qualquer um dos m\u00e9todos s\u00e3o equivalentes se aplicados aos dados de press\u00e3o ou ao conjunto de dados de press\u00e3o mais derivada, existindo uma discrep\u00e2ncia no valor determinado para o fator de pel\u00edcula quando foram utilizados os dados da derivada para efetuar as regress\u00f5es. \u00c9 nitida, no entanto, a diferen\u00e7a em termos de intervalos de confian\u00e7a, onde os m\u00e9todos baseados na norma LI se mostraram muito melhores.\nVaz\u00e3o de Teste\t= 252.0 STB/d\nRaio do Po\u00e7o\t= 0.23 p\u00e9s\nPorosidade\t= 0.039\nEspessura\t\u2014 69.0 p\u00e9s\nViscosidade\t= 0.90 cp\nCompressibilidade Total\t= 6.7 x 10~6 1/psi\nFator Volume de Forma\u00e7\u00e3o\t= 1.325 bbl/STB\nTabela 5.1: Dados de reservat\u00f3rio para os casos l e 2.\nTempo de Teste (horas)\tQueda de Press\u00e3o (psi)\tTempo de Teste (horas)\tQueda de Press\u00e3o (psi)\n0.0167\t26.0\t2.0000\t849.0\n0.0330\t53.0\t2.5000\t859.0\n0.0500\t78.0\t3.0000\t864.0\n0.1000\t148.0\t3.5000\t869.0\n0.1500\t210.0\t4.0000\t874.0\n0.2000\t267.0\t4.5000\t877.0\n0.3000\t369.0\t5.0000\t882.0\n0.4000\t454.0\t6.0000\t887.0\n0.5000\t519.0\t7.0000\t893.0\n0.6000\t572.0\t8.0000\t897.0\n0.8000\t654.0\t10.000\t905.0\n1.0000 1.5000\t719.0 804.0\t12.000\t911.0\nTabela 5.2: Dados de press\u00e3o versus tempo para o caso 1.\nO n\u00famero de itera\u00e7\u00f5es requerido por cada m\u00e9todo variou bastante, sendo que, como j\u00e1 comentado no cap\u00edtulo anterior, o m\u00e9todo NM necessita de um n\u00famero excessivo de itera\u00e7\u00f5es para convergir. Aparentemente este elevado n\u00famero de itera\u00e7\u00f5es tem um custo relativamente alto em termos de tempo de processamento. Tamb\u00e9m j\u00e1 era esperada urna certa lentid\u00e3o no m\u00e9todo MVAM, embora bem menor que no m\u00e9todo NM, pois Rosa [22] j\u00e1 havia comentado em seu trabalho esta caracter\u00edstica. Para a combina\u00e7\u00e3o dos m\u00e9todos MVAM e MVA, \u00e9 necess\u00e1rio se estabelecer um limite para troca de m\u00e9todo. Neste caso estabeleceu-se que quando a varia\u00e7\u00e3o dos par\u00e1metros entre duas itera\u00e7\u00f5es for menor que 10% troca-se o m\u00e9todo. Nos m\u00e9todos MQ, MVAM e MVAM-MVA foram utilizadas fun\u00e7\u00f5es-penalidade dadas pela equa\u00e7\u00e3o 4.28, sendo que para o fator de pel\u00edcula foi utilizada a fun\u00e7\u00e3o penalidade proposta por este trabalho (equa\u00e7\u00e3o 4.30), pois esta fun\u00e7\u00e3o nao interrompe o processamento quando o par\u00e2metro recebe valores fora do seu dom\u00ednio.\nOutro fato interessante \u00e9 que a regress\u00e3o efetuada no conjunto de dados de press\u00e3o mais derivada, neste caso, n\u00e3o melhorou a regress\u00e3o em termos de n\u00famero de itera\u00e7\u00f5es e somente em alguns m\u00e9todos houve alguma melhora em termos de intervalos de confian\u00e7a. Tal fato pode ser explicado neste caso devido aos ru\u00eddos introduzidos pelo m\u00e9todo de se obter a derivada logar\u00edtmica da press\u00e3o, pois os dados originais praticamente n\u00e3o continham ru\u00eddo. O procedimento utilizado para a obten\u00e7\u00e3o num\u00e9rica da derivada a partir dos dados de campo est\u00e1 descrito no ap\u00eandice D.\nPara melhor esclarecer as diferen\u00e7as entre as regress\u00f5es efetuadas nos tres conjuntos de dados, est\u00e3o definidas abaixo as tres fun\u00e7\u00f5es-objetivo analisadas.\nFun\u00e7\u00f5es baseadas nos dados de press\u00e3o:\n^i(a) = L\t(5-1)\nF2(o) = [Ap\u00ed - Ap(o,h)]2\t(5.2)\nFun\u00e7\u00f5es baseadas nos dados da derivada:\nA(<5) = \u00bf \u00cdA?\u00ed - Ap'(o, t\u00ed)|\t(5.3)\nnpon\nW)= \u00a3[Ap'- A/(a,M]2\t(5.4)\ni \u20141\nFun\u00e7\u00f5es baseadas no conjunto de dados de press\u00e3o mais derivada:\n(9*9)\nWv - ;<fvl d + J(?? Wv - ?<*V] 3 - (^)z3\nuadu\tuMu\nM\u00e9t.\tTipo Dados\tk\t\t\tS +/-%\t(1)\tC +/- %\tMQR (psi2 /ponto )\tMRA (ps\u00ed /ponto)\tIte,\n\t\t(mD)\t+/- %\t\t\t\t\t\t\t\nMQ\tP\t15.16\t15.79\t14.38\t23,26\t8,48\t1.53\t13.67\t2.72\t08\nMQ\tD\t11.08\t15.00\t9,58\t24.55\t8.61\t4.50\t59.46\t5,12\t08\nMQ\tP+D\t13.01\t17,69\t11.51\t28.11\t8.68\t2.70\t104.70\t8,07\t08\nMQ(2)\tP\t15.16\t\u2014\t14,38\t\u2014\t8.48\t\u2014\t13.67\t2.72\t23\nMQ(2)\tD\t11,08\t\u2014\t9.58\t\u2014\t8.61\t\u2014\t59.46\t5.12\t09\nMQ(2)\tP+D\t13.01\t\u2014\t11,51\t\u2014\t8.68\t\u2014\t104.70\t8.07\t09\nDVS\tP\t15.16\t\u2014\t14.38\t\u2014\t8.48\t\u2014-\t13.67\t2.72\t09\nDVS\tD\t11.08\t\u2014\t9.58\t\u2014\t8.61\t\u2014\t59,46\t5.12\t08\nDVS\tP+D\t13,30\t\t11.74\t\u2014\t8,68\t\u2014-\t129.54\t7.17\t09\nMVAM\tP\t13.47\t1.53\t11.97\t2.43\t8.42\t0.07\t16.81\t2.67\t50*\nMVAM\tD\t10,21\t0.06\t8.37\t0.54\t8,62\t0.44\t65.24\t4.65\t16\nMVAM\tP+D\t12.47\t1.01\t10.61\t1.65\t8.43\t0.51\t127.77\t6.95\t22\nMVA\tP\t13.47\t0.85\t11,97\t1.34\t8.42\t0.05\t16.83\t2,67\t09\nMVA\tD\t10,21\t0.14\t8.37\t0.25\t8,62\t0.02\t65,24\t4.65\t09\nMVA\tP+D\t12.50\t0.06\t10.65\t0.98\t8.43\t0.72\t125,86\t6,95\t15\n(3)\tP\t13.47\t1.34\t11.97\t2.11\t8.42\t0.08\t16,83\t2,67\t08\n(3)\tD\t10.21\t0.12\t8.37\t0.21\t8.62\t0.02\t65.24\t4.65\t07\n(3)\tP+D\t12.50\t0.61\t10.65\t1,03\t8.43\t0.76\t125.89\t6.95\t16\nNM\tP\t12.08\t\u2014\t10.01\t\u2014\u2022\t8.42\t\u2014\t25.57\t2.89\t90\nNM\tD\t10.21\t\u2014\t8.37\t\u2014\t8.62\t\t65.21\t4.65\t174\nNM\tP+D\t12.50\t\u2014\t10.65\t\u2014\t8,43\t\u2014\t125.64\t6.95\t252\nTipo de conjunto de dados utilizados.\nP - dados de press\u00e3o.\nD - dados da derivada,\nP+D - dados de press\u00e3o e da derivada.\n(1)\t- 10-3 bbl/pai\n(2)\t- modifica\u00e7\u00e3o no dom\u00ednio,\n(3)\t- MVAM-MVA.\nMQR - m\u00e9dia dos quadrados dos res\u00edduos. MRA - m\u00e9dia dos res\u00edduos absolutos.\nEstimativas Iniciais: k = 50.0 mD\nS = 5.0\nC = 0.01 bbl/psi\n* parada por n\u00famero m\u00e1ximo de itera\u00e7\u00f5es.\nTabela 5.3: Compara\u00e7\u00e3o do desempenho de v\u00e1rios m\u00e9todos de regress\u00e3o para os dados do caso 1.\nNa tabela 5,5 comparamos o desempenho dos varios m\u00e9todos aplicados \u00e0s diferentes estimativas iniciais apresentadas na tabela 5.4. Neste caso tamb\u00e9m foi testada a modifica\u00e7\u00e3o proposta por este trabalho nos dominios dos par\u00e2metros. \u00c9 interessante notar a similaridade de comportamento dos m\u00e9todos MVA e DVS. No caso do m\u00e9todo DVS a modifica\u00e7\u00e3o proposta n\u00e3o obteve bons resultados pois o m\u00e9todo DVS n\u00e3o funcionou com ela. N\u00e3o foi feita tal modifica\u00e7\u00e3o no m\u00e9todo MVAM-MVA pois este m\u00e9todo \u00e9 urna combina\u00e7\u00e3o dos m\u00e9todos testados anteriormente. No caso do m\u00e9todo NM. esta modifica\u00e7\u00e3o se mostrou imprescind\u00edvel, j\u00e1 que o m\u00e9todo necessita intri.nsicanien.te de dom\u00ednios sem limites, pois para o seu funcionamento normal \u00e9 necess\u00e1rio que as reflex\u00f5es efetuadas pelo m\u00e9todo tenham liberdade de movimento, o que seria imposs\u00edvel se alguns dos par\u00e2metros de regress\u00e3o tivessem dom\u00ednio restrito.\nPode-se tamb\u00e9m concluir que os m\u00e9todos MQ e MVAM-MVA mostraram-se superiores aos demais principalmente em termos de n\u00famero de itera\u00e7\u00f5es necess\u00e1rias para a converg\u00eancia. Outra conclus\u00e3o interessante \u00e9 que a modifica\u00e7\u00e3o no dom\u00ednio dos par\u00e2metros n\u00e3o surtiu o efeito desejado nos m\u00e9todos DVS e MVA, que seria de introduzir uma otimiza\u00e7\u00e3o restrita a estes m\u00e9todos, por\u00e9m como j\u00e1 comentado acima, ela \u00e9 imprescind\u00edvel ao m\u00e9todo NM.\nCom rela\u00e7\u00e3o \u00e0 melhor escolha de fun\u00e7\u00e3o-objetivo (equa\u00e7\u00f5es 5.1 a 5.6) para se efetuar a regress\u00e3o, para este caso pode-se concluir que o melhor conjunto de dados depende do tipo de m\u00e9todo. Para os m\u00e9todos MQ, MVAM, MVAM mod., MVA, MVA mod. e MVAM-MVA, o melhor conjunto de dados \u00e9 o de dados de press\u00e3o, J\u00e1 para os m\u00e9todos MQ mod., DVS e NM os melhores resultados foram obtidos com o conjunto de dados de press\u00e3o e da derivada.\nCom rela\u00e7\u00e3o aos dados da derivada \u00e9 interessante notar que houve casos em que s\u00f3 se conseguiu converg\u00eancia para este conjunto de dados. Isto poderia ser futuramente aproveitado para inicialmente se efetuar a regress\u00e3o nos dados da derivada e utilizar os par\u00e2metros assim obtidos como estimativas iniciais para uma nova regress\u00e3o aplicada a outro conjunto de dados.\nUma explica\u00e7\u00e3o para este comportamento seria o melhor car\u00e1ter que a curva da derivada tem comparada \u00e0 curva de press\u00e3o.\nNas figuras 5.1 a 5.6 est\u00e3o mostrados os dados de campo e as curvas de press\u00e3o e da derivada geradas pelos resultados das regress\u00f5es. Podemos notar que, como j\u00e1 comentado anteriormente, estes resultados s\u00e3o, em termos pr\u00e1ticos, equivalentes. Outro fato interessante \u00e9 que quando efetuamos as regress\u00f5es nos dados da derivada, os pontos finais da press\u00e3o tendem a se distanciar dos pontos de campo, por\u00e9m uma an\u00e1lise visual mostra que a \u2019\u2019qualidade\u201d da reta semi-log gerada, ou seja, sua declividade e consequentemente o valor da permeabilidade \u00e9 razoavelmente pr\u00f3xima \u00e0 declividade da reta gerada pelos dados de campo.\nEstim. Inicial\tk (mD)\ts\tC (bbl/psi)\nA\t500.\t1.\t0,010\nB\t100.\t1.\t0.010\nC\t10.\t25.\t0.010\nD\t10.\t-5.\t0.010\nE\t10.\t10.\t0.100\nF\t10.\t10.\t0.001\nG\t1.\t1.\t0.010\nH\t1000.\t25.\t0.050\nTabela 5.4: Estimativas iniciais utilizadas para v\u00e1rios m\u00e9todos de regress\u00e3o para os dados do caso 1 e do caso 2,\n(1)\tM\u00e9todo\tN.Iter e Tipo de Dados\t\t\t(O\tM\u00e9todo\tN.Iter e T\u00edpo de Dados\t\t\n\t\tP\tD\tP+D\t\t\tP\tD\tPTD\nA\tMQ\t10\t11\t12\tB\tMQ\t08\t11\t09\n\tMQ(2)\t50*\t13\t16\t\tMQ(2)\t13\t(3)\t08\n\tMVAM\t28\t33\t31\t\tMVAM\t29\t50*\t34\n\tMVAM(2)\t(3)\t22\t(3)\t\tMVAM(2)\t(3)\t24\t42\n\tMVA\t(3)\t(3)\t(3)\t\tMVA\t(3)\t08\t25\n\tMVA(2)\t(3)\t(3)\t(3)\t\tMVA(2)\t(3)\t(3)\t(3)\n\t(4)\t11\t10\t17\t\t(4)\t09\t11\t17\n\tDVS\t14\t(3)\t13\t\tDVS\t(3)\t11\t(3)\n\tNM\t300*\t191\t137\t\tNM\t86\t164\t193\nC\tMQ\t09\t10\t09\tD\tMQ\t11\t09\t11\n\tMQ(2)\t23\t(3)\t13\t\tMQ(2)\t11\t11\t09\n\tMVAM\t50*\t14\t39\t\tMVAM\t30\t15\t36\n\tMVAM(2)\t25\t50*\t40\t\tMVAM(2)\t48\t25\t50*\n\tMVA\t08\t18\t13\t\tMVA\t(3)\t09\t(3)\n\tMVA(2)\t(3)\t(3)\t(3)\t\tMVA(2)\t(3)\t10\t50*\n\t(4)\t07\t07\t16\t\t(4)\t12\t09\t18\n\tDVS\t08\t(3)\t06\t\tDVS\t10\t09\t10\n\tNM\t300*\t167\t160\t\tNM\t216\t133\t147\nE\tMQ\t08\t10\t07\tF\tMQ\t08\t09\t08\n\tMQ(2)\t17\t10\t08\t\tMQ(2)\t15\t09\t07\n\tMVAM\t28\t50*\t42\t\tMVAM\t22\t50*\t32\n\tMVAM(2)\t32\t21\t46\t\tMVAM(2)\t28\t26\t50*\n\tMVA\t(3)\t(3)\t(3)\t\tMVA\t09\t09\t50*\n\tMVA(2)\t(3)\t(3)\t(3)\t\tMVA(2)\t10\t09\t16\n\t(4)\t07\t10\t15\t\t(4)\t07\t09\t16\n\tDVS\t(3)\t(3)\t(3)\t\tDVS\t09\t09\t08\n\tNM\t143\t157\t97\t\tNM\t81\t110\t91\nG\tMQ\t10\t09\t09\tH\tMQ\t13\t11\t10\n\tMQ(2)\t09\t09\t10\t\tMQ(2)\t(3)\t(3)\t(3)\n\tMVAM\t30\t14\t48\t\tMVAM\t50*\t26\t27\n\tMVAM(2)\t45\t50*\t50*\t\tMVAM(2)\t(3)\t50*\t17\n\tMVA\t(3)\t(3)\t(3)\t\tMVA\t12\t10\t16\n\tMVA(2)\t(3)\t10\t(3)\t\tMVA(2)\t(3)\t14\t(3)\n\t\t11\t11\t11\t\t(4)\t10\t10\t16\n\tDVS\t(3)\t(3)\t(3)\t\tDVS\t14\t11\t13\n\tNM\t272\t156\t140\t\tNM\t139\t150\t174\n(1) - estimativa inicial- (2) - modifica\u00e7\u00e3o no dom\u00ednio dos par\u00e2metros.\n(3) - n\u00e3o convergiu. (*) - parada por n\u00famero m\u00e1ximo de itera\u00e7\u00f5es.\n(4)\t- MVAM-MVA\nTabela 5.5: Resultados dos v\u00e1rios m\u00e9todos de regress\u00e3o. Caso 1. Estimativas iniciais da tabela 5.4 .\nFigura 5.1: Press\u00e3o e Derivada da Press\u00e3o versus Tempo em escala log-log, para regress\u00e3o nos dados de press\u00e3o. Caso 1.\nooooo Pr essso - Dedos de Campo.\n\u2014 MO ou DVS.\n----- NH. MVA, MVAM ou oanoa&amp;ar !.socf\u00f4 - Dadcg\n-- MO ou DVS.\n-- NM. MVA, MVAM cu\n1000,00\n800.00\"\nMVAM-MVA,\n*\nMV AM- MV A. Co Con\u00e7pc ,\ntn\n60S.00-\n\u25a0400.00\n200.00\nDelta T (horas)\n\nFigura 5.2: Press\u00e3o e Derivada da Press\u00e3o versus Tempo em escala semi-log, para regress\u00e3o nos dados de press\u00e3o. Caso 1.\ne.si\t0.1\ti\tia\nDelta T (horas)\nFigura 5.3: Press\u00e3o e Derivada da Press\u00e3o versus Tempo em escala log-log, para regress\u00e3o nos dados da derivada. Caso 1.\nDelta T (horas)\nFigura 5.4: Press\u00e3o e Derivada da Press\u00e3o versus Tempo em escala semi-log, para regress\u00e3o nos dados da derivada. Caso 1.\ni...r.r i\u2014r~i'\"T\"n. i---1\t1\u2014i\u2014\u2019\u00ed '*r' i' r' \u25a0j-r\u2014**\u2014\u2014\u25a0\u2014\u00a1\u2014r-rry\n0.1 1 10\nDelta T (horas)\nFigura 5.5: Press\u00e3o e Derivada da Press\u00e3o versus Tempo em escala log-Iog, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 1.\nDelta T (horas)\nFigura 5-6: Press\u00e3o e Derivada da Press\u00e3o versus Tempo em escala semi-log, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 1.\nNa figura 5.7 est\u00e1 mostrada a evolu\u00e7\u00e3o da m\u00e9dia dos res\u00edduos ao quadrado ao longo das itera\u00e7\u00f5es. Nela podemos observar que no m\u00e9todo MVAM ap\u00f3s um determinado instante os res\u00edduos evoluem lentamente para o valor m\u00ednimo. \u00c9 interessante citar que os m\u00e9todos que seguem a norma LI tem o valor dos res\u00edduos a princ\u00edpio diminu\u00eddo, por\u00e9m no final ele cresce ligeiramente.\nComportamento semelhante \u00e9 observado na figura 5.8 onde est\u00e1 mostrada a evolu\u00e7\u00e3o da m\u00e9dia dos valores absolutos dos res\u00edduos ao longo das itera\u00e7\u00f5es. Interessante notar que o valor desta m\u00e9dia, no m\u00e9todo MVAM, praticamente n\u00e3o muda ap\u00f3s a d\u00e9cima itera\u00e7\u00e3o, mas o m\u00e9todo demora a convergir.\nNas figuras 5.9 a 5.11 pode-se analisar a evolu\u00e7\u00e3o dos valores dos par\u00e2metros de regress\u00e3o ao longo das itera\u00e7\u00f5es. Nestas regress\u00f5es foi utilizado o conjunto de dados de press\u00e3o mais derivada. Nestas figuras novamente fica clara a dificuldade que o m\u00e9todo MVAM tem para convergir e a extrema lentid\u00e3o do m\u00e9todo NM. Os gr\u00e1ficos foram truncados antes da \u00faltima itera\u00e7\u00e3o do m\u00e9todo NM para melhor visualiza\u00e7\u00e3o, pois este m\u00e9todo exigiu neste caso 172 itera\u00e7\u00f5es para convergir.\nItera\u00e7\u00f5es\n\u00ae\t\u00ae\ts>\t\u2014\n\u00ae\t\u00ae\t\u2014\nQ\t-~\n(o4uod/grsd) bdW\nFigura 5.8; Comportamento da m\u00e9dia dos valores absolutos dos res\u00edduos ao longo itera\u00e7\u00f5es. Caso 1.\nCl\ng\n\u00a1-TTTT- Q\t-TTT-7%T S>\nQ\tQ\nO\tLO\ns LO\n\nO\nCX1\ns\nO\tQ\to\tQ\tS>\nd\tO\tQ\tQ\ts>\n\\r\t01\tC\\I\t\t\n(am) JI\nO\nC\nO\nCD\n-..tuP\nUm fato muito interessante notado nas figuras 5.12 a 5.14 \u00e9 que os m\u00e9todos MQ, MVAM e NM, apesar de minimizarem normas diferentes, caminham durante as Itera\u00e7\u00f5es ao longo de curvas semelhantes nos planos k-S (permeabilidade x fator de pel\u00edcula); k C (permeabilidade x estocagem); e S C (fator de pel\u00edcula x estocagem). Igualmente os m\u00e9todos DVS e MVA tamb\u00e9m caminham nestes planos ao longo de curvas semelhantes. E bom lembrarmos que as semelhan\u00e7as entre estes m\u00e9todos tamb\u00e9m aparecem (exce\u00e7\u00e3o ao m\u00e9todo NM) na forma da matriz que eles utilizam, sendo quadrada nos m\u00e9todos MQ e MVAM e retangular nos m\u00e9todos M VA e DVS. Finalmente, tamb\u00e9m foram piolados os resultados do m\u00e9todo MQ com dom\u00ednio modificado.\nAs estimativas iniciais utilizadas para a constru\u00e7\u00e3o das figuras 5.12 a 5.14 foram as seguintes:\nk \u2014 50,\u00dc inD\nS\t= 0.0\nC \u2014 0.015 bbl/psi.\nFigura 5.12; Varia\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es no plano k-S para os v\u00e1rios m\u00e9todos. Caso 1.\n~r~l~r~r?r?757~'r'l\"l\"T \"r\"1\"\n~ - ovs. fivAn.\n*** ri va . sweee HVAH- HVA. onotto Ntl.\nI4O( 1) .\n0.0400\n0.0300-\n0.0200\n0.0000\nMudan\u00e7a d\u00ab Dnimnio\".\nVl I' 17\u20191\n50\t60\n0. 01 00 -f\nFigura 5.13: Varia\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es no plano k C para os v\u00e1rios m\u00e9todos. Caso 1.\nS\nCom os dados do caso 1 foram geradas as figuras 5.15 a 5.26, onde pode-se observar como sao as superficies das fun\u00e7\u00f5es-objetivo baseadas nos dados de press\u00e3o e analisadas fixando-se um dos par\u00e2metros de regress\u00e3o (no valor correto para cada norma). Quando analisamos as superf\u00edcies geradas pela norma L2, notamos que estas tem mais car\u00e1ter que aquelas geradas pela norma Ll. Isto explicaria a baixa velocidade de converg\u00eancia dos m\u00e9todos MVAM e NM, Outro ponto que deve ser ressaltado \u00e9 a exist\u00eancia de regi\u00f5es em que as superf\u00edcies s\u00e3o praticamente planas, o que contribuiria para a n\u00e3o converg\u00eancia do m\u00e9todo naquelas regi\u00f5es.\nPor outro lado, quando fixamos o valor da permeabilidade notamos que tanto a superf\u00edcie gerada pela norma Ll como a gerada, pela norma L2 tem dois m\u00ednimos bem. diferentes, o que explica os casos em que houve diverg\u00eancia nos m\u00e9todos, pois um dos m\u00ednimos est\u00e1 numa regi\u00e3o (valor do fator de pel\u00edcula menor que -7.0) onde n\u00e3o h\u00e1 significado f\u00edsico. Tamb\u00e9m foram geradas as amplia\u00e7\u00f5es destas superf\u00edcies em regi\u00f5es pr\u00f3ximas aos m\u00ednimos para melhor entender a baixa velocidade de converg\u00eancia do m\u00e9todo MVAM. Como pode ser visto nestas amplia\u00e7\u00f5es, as superf\u00edcies geradas pela norma Ll s\u00e3o extremamente planas em regi\u00f5es pr\u00f3ximas aos m\u00ednimos.\n/pg S&amp;jzi\u00e1 /tes/dua# (psi\n4.6\u20197 6\u2019. 06\t7.45\n\nSanta &amp;uad.\nSoma Res.Abs.(ps\u00ed)\n12.5\n12.3\n12.2\n12. t\n12.0\n? 3.9\nI\tt\nH .7\nII\t.6\n11.5\n\u2022'r\n\u00bfn\nrd\n<2\n\u00a123\nm\ni>\tO\nn\t<r\nr->\t<t\nr\u00bf\tf\u00bf\nLO\t4\nc\u00bf\tri\nT\u2018.\t\u00ae\nrr\tr\u00ed\no\ts\nri\tt\nc\u00ed\n10\u00ae.\u00a13\n90.0\n60.0\n50,0\n40.0\n\u202230.0\n20.3\n10,0\n0.0\nas\u00a9\nU>\t4D\tt\u00ed)\n\u00fc3\t\u00ed>\ni\u2014i\u2014[\u2014i\u2014i\u2014r\n100.0\n90.0\nSJ3.0\n70,0\n60,0\n50.0\n40h0\n30.0\n20,\u00ae\n10.0\n0.0\nLog Soma Quad, Res.(psi**2)\nSoma Quad. Res.(psi**2)\nSoma Ees.Abs.(ps\u00ed)\nFigura 5.22: Amplia\u00e7\u00e3o das k ~ 13.47 mD. Caso 1.\ncurvas de n\u00edvel e superf\u00edcie geradas pela norma L1 para\n\u00bfqg- Sama Quad. f\u00edfS\u00e1\\/'psd\nSoma Quad. Res.(psi**2)\nFigura 5.24: Amplia\u00e7\u00e3o das curvas de n\u00edvel e superf\u00edcie geradas pela norma L2 para S \u2014 14.38 . Caso 1.\nLog Soma Quad. Res.(psi**2)\n2.B5 3.74\n\u00abTn J726:^Amplm\u00c7aO das CUrW3 de n\u00edvel e werf\u00edcie geradas pela norma Li para \u2014* II.\u00cd7\u00cd \u201e kj\u00e1\u00a1SO 1.\nOutra an\u00e1lise efetuada com os dados deste caso foi a compara\u00e7\u00e3o entre a distribui\u00e7\u00e3o de erros real e as distribui\u00e7\u00f5es correspondentes de Gauss e de Laplace. Como podemos observar nas figuras 5.27 a 5.32, neste caso nao ficou claro, qualitativamente falando, qual das distribui\u00e7\u00f5es tem maior semelhan\u00e7a com a distribui\u00e7\u00e3o real de erros. Isto pode ser explicado pelo pequeno n\u00famero de pontos amostrado. Apesar deste problema, a exist\u00eancia de valores de erros distantes da m\u00e9dia, como pode ser observada nas referidas figuras, indica que a distribui\u00e7\u00e3o de Laplace pode ser a mais indicada.\nPara melhor avaliar o desempenho dos v\u00e1rios m\u00e9todos de regress\u00e3o, foi acrescentado aleatoriamente algum ru\u00eddo aos dados de press\u00e3o do caso 1. Estes ru\u00eddos est\u00e3o mostrados na tabela 5.6 e ser\u00e3o denominados de caso 2.\nTempo de Teste (horas)\tQueda de Press\u00e3o Real (Psi)\tQueda de Press\u00e3o Modificada (psi)\n0.0167\t26.0\t11.0\n0.0330\t53,0\t65.0\n0.0500\t78.0\t70.0\n0.1000\t148.0\t100.0\n0.4000\t454.0\t510.0\n0.5000\t519.0\t550.0\n0.6000\t572.0\t650.0\n4.5000\t877.0\t880.0\n5.0000\t882.0\t881.0\n6.0000\t887.0\t892.0\nTabela 5.6: Ru\u00eddos introduzidos nos dados de press\u00e3o. Caso 2.\nFigura 5.27: Compara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss e de Laplace. Regress\u00e3o nos dados de press\u00e3o usando o m\u00e9todo MQ. Caso 1.\nFigura 5.29: Compara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss e de Laplace. Regress\u00e3o nos dados da derivada usando o m\u00e9todo MQ. Caso L\nFigura 5,31; Compara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss e de Laplace. Regress\u00e3o no conjunto de dados de press\u00e3o e da derivada usando o m\u00e9todo MQ. Caso 1.\nNovamente foram comparados inicialmente os mesmos sete m\u00e9todos testados no caso 1 (MQ, MQ mod., MVAM, MVA, MVAM-MVA, DVS e NM). Os resultados desta compara\u00e7\u00e3o est\u00e3o na tabela 5.7. Pode-se notar que a interpreta\u00e7\u00e3o baseada somente nos dados da derivada sofreu uma mudan\u00e7a s\u00edgnifi\u00e7\u00e1tiva, o que \u00e9 facilmente explicado pela amplifica\u00e7\u00e3o de ru\u00eddo que o algoritmo de diferencia\u00e7\u00e3o utilizado neste trabalho causa nos dados. Por\u00e9m tanto na interpreta\u00e7\u00e3o dos dados de press\u00e3o como no conjunto de dados de press\u00e3o mais derivada tal diferen\u00e7a n\u00e3o foi muito grande. Outro fato interessante \u00e9 que os intervalos de confian\u00e7a do m\u00e9todo MQ na presen\u00e7a de ru\u00eddos cresceu de valores aceit\u00e1veis (de at\u00e9 28 %) para valores muito altos (de at\u00e9 84 %), enquanto que nos m\u00e9todos MVAM, MVA e MVAM-MVA o maior intervalo para os dados do caso 2 foi de 8 % (era de 2 % no caso 1).\nMet.\tTipo Dados\tk\t\ts\t\t(Q\tc +/-%\tMQR (psi2 /ponto )\tMRA (psi ! panto)\tIte.\n\t\t(mD)\t+/- %\t\t+/-%\t\t\t\t\t\nMQ\tP\t15.62\t84.20\t15.01\t122.9\t7.92\t8.35\t415.68\t13.64\t08\nMQ\tD\t8.17\t44.80\t6.18\t87.0\t6.20\t.18,93\t1031.90\t23.27\t07\nMQ\tP+D\t11.37\t4:4 >4: t\t9.15\t77.0\t7.61\t8.22\t925.01\t20.86\t09\nMQ(2)\tP\t15.65\t\u2014\t15.05\t\u2014\t7.92\t\u2014\t415.68\t13.64\t26\nMQ(2)\tD\t8.16\t\u2014\t6.17\t\u2014\t6.20\t\u2014\t1031.90\t23.28\t07\nMQ(2)\tP+D\t11.36\t\u2014\t9.14\t\u2014\t7.66\t\u2014\t925.04\t20.86\t12\nDVS\tP\t15.65\t\u2014\t15.05\t\t7.92\t\u2014\t415.68\t13.64\t08\nDVS\tD\t8.16\t\t6.17\t\u2014\t6.20\t\u2014\t1031.90\t23.28\t09\nDVS\tP+D\t11.36\t\u2014\t9.14\t\u2014.\t7.66\t\u2014\t925.04\t20.86\t07\nMVAM\tP\t15.56\t2.24\t14.96\t3.33\t8.48\t0.33\t524.32\t12.25\t50*\nMVAM\tD\t9.54\t0.17\t7.77\tL10\t6.76\t1.96\t1081.69\t22.03\t42\nMVAM\tP+D\t10.43\t0.88\t7,73\t1.62\t7.84\t0.21\t962.30\t19.79\t25\nMVA\tP\t15.56\t5.17\t14.96\t7.63\t8.48\t0.37\t524.36\t12.25\t08\nMVA\tD\t9.44\t3.40\t7.97\t6.09\t6.14\t2.79\t1067.21\t22.03\t05\nMVA\tP+D\t10.43\t0.77\t7.73\t1.42\t7.84\t0.16\t.962.30\t19.79\t08\n(3)\tP\t15.56\t5.64\t14.96\t8.33\t8.48\t0.41\t524.36\t12.25\t08\n(3)\tD\t9.44\t0.57\t7.97\t0.99\t6.14\t0.19\t1067.21\t22.03\t10\n(3)\tP+D\t10.43\t0.30\t7.73\t0.55\t7.84\t0.05\t962.30\t19.79\t08\nNM\tP\t15.56\t\u2014\t14.96\t\u2014\t8.48\t\u2014\t524.36\t12.25\t274\nNM\tD\t9.44\t\u2014\t7.97\t\u2014\t6.14\t\u2014\t1067.21\t22.03\t128\nNM\tP+D\t10.43\t\u2014\t7.73\t\u2014\t7.84\t\u2014\t962.30\t19795\t126\n(1)\t10 3 bbl/psi\t\tistimativas Iniciais:\n(2) modifica\u00e7\u00e3o no dom\u00ednio\tk = 50.0 mD\t\n(3) MVAM-MVA\tS \u2014 5.0\t\nP - dados de press\u00e3o.\tC = 0.01 bbl/psi\t\nD - dados da derivada.\t\t\nP+D * dados de press\u00e3o e da derivada.\t3\t* parada por n. max, itera\u00e7\u00f5es.\nMQR - m\u00e9dia dos quadrados do res\u00edduos.\t\t\nMRA - m\u00e9dia dos res\u00edduos absolutos.\t\t\nTabela 5.7: Compara\u00e7\u00e3o do Desempenho de V\u00e1rios M\u00e9todos de Regress\u00e3o para os dados do caso 2.\nNa tabela 5.8 s\u00e3o apresentados os comportamentos dos diversos m\u00e9todos quando submetidos \u00e0s estimativas iniciais da tabela 5.4. Quando comparamos estes resultados com os da tabela 5.5, onde est\u00e3o mostrados os resultados dos mesmos m\u00e9todos aplicados aos dados sem ru\u00eddos, foi notada uma pequena melhora em termos de n\u00famero de itera\u00e7\u00f5es necess\u00e1rias para a converg\u00eancia nos m\u00e9todos baseados na norma Ll, por\u00e9m tal melhora n\u00e3o pode ser considerada conclusiva. Analisando qual m\u00e9todo teve melhor desempenho chega-se \u00e0 conclus\u00e3o que para este caso o m\u00e9todo MVAM-MVA teve um comportamento melhor. Novamente nota-se que a modifica\u00e7\u00e3o no dom\u00ednio dos par\u00e2metros n\u00e3o surtiu o efeito desejado, sendo que quando aplicada ao m\u00e9todo MVA mostrou-se muito ruim, causando a diverg\u00eancia na maior parte das vezes.\n\tM\u00e9todo\tN.Iter e Tipo de Dados\t\t\t(1)\tM\u00e9todo\tN.Iter e Tipo de Dados\t\t\n\t\tP\tD\tP+D\t\t\tP\tD\tP+D\nA\tMQ\t13\t09\t15\tB\tr MQ\t09\t09\t08\n\tMQ(2)\t50*\t(3)\t12\t\tMQ(2)\t17\t(3)\t08\n\tMVAM\t24\t50*\t13\t\tMVAM\t50*\t50*\t38\n\tMVAM(2)\t50*\t(3)\t31\t\tMVAM(2)\t(3)\t30\t25\n\tMVA\t23\t(3)\t(3)\t\tMVA\t26\t12\t(3)\n\tMVA(2)\t(3)\t(3)\t(3)\t\tMVA(2)\t(3)\t09\t(3)\n\t(4)\t11\t16\t16\t\t(4)\t11.\t09\t09\n\tDVS\t(3)\t(3)\t(3)\t\tDVS\t(3)\t11\t(3)\n\tNM\t74\t(3)\t300*\t\tNM\t300*\t.118\t83\nC\tMQ\t11\t11\t13\tD\tMQ\t11\t09\t10\n\tMQ(2)\t24\t(3)\t12\t\tMQ(2)\t24\t09\t09\n\tMVAM\t18\t50*\t33\t\tMVAM\t31\t50*\t26\n\tMVAM(2)\t50*\t50*\t38\t\tMVAM(2)\t50*\t23\t33\n\tMVA\t08\t17\t07\t\tMVA\t15\t09\t10\n\tMVA(2)\t(3)\t(3)\t(3)\t\tMVA (2)\t(3)\t07\t(3)\n\t(4)\t07\t09\t08\t\t(4)\t11\t11\t13\n\tDVS\t08\t(3)\t06\t\tDVS\t12\t07\t12\n\tNM\t170\t247\t274\t\tNM\t300*\t155\t209\nE\tMQ\t08\t11\t07\tF\tMQ\t08\t10\t07\n\tMQ(2)\t18\t09\t08\t\tMQ(2)\t16\t07\t07\n\tMVAM\t46\t4.1.\t22\t\tMVAM\t50*\t17\t39\n\tMVAM(2)\t50*\t10\t21\t\tMVAM(2)\t50*\t16\t39\n\tMVA\t(3)\t(3)\t(3)\t\tMVA\t08\t09\t08\n\tMVA(2)\t(3)\t(3)\t(3)\t\tMVA(2)\t12\t08\t08\n\t(4)\t10\t09\t06\t\t(4)\t08\t09\t08\n\tDVS\t(3)\t(3)\t(3)\t\tDVS\t08\t08\t08\n\tNM\t300*\t129\t110\t\tNM\t88\t99\t185\nG\tMQ\t09\t09\t11\tH\tMQ\t15\t14\t15\n\tMQ(2)\t11\t09\t09\t\tMQ(2)\t(3)\t(3)\t(3)\n\tMVAM\t26\t23\t25\t\tMVAM\t24\t35\t38\n\tMVAM(2)\t-50*\t30\t27\t\tMVAM(2)\t(3)\t(3)\t(3)\n\tMVA\t(3)\t13\t(3)\t\tMVA\t12\t11\t10\n\tMVA(2)\t(3)\t12\t(3)\t\tMVA(2)\t(3)\t12\t(3)\n\t(4)\t10\t12\t10\t\t(4j\t11\t09\t10\n\tDVS\t(3)\t(3)\t(3)\t\tDVS\t12\t14\t12\n\tNM\t295\t186\t113\t\tNM\t186\t151\t300*\n(1) - estimativa inicial. (2) - modifica\u00e7\u00e3o no dom\u00ednio dos par\u00e2metros.\n(3) - n\u00e3o convergiu. (*) - parada por n\u00famero m\u00e1ximo de itera\u00e7\u00f5es.\n(4) - MVAM-MVA\nTabela 5.8: Resultados dos V\u00e1rios M\u00e9todos de Regress\u00e3o. Caso 2. Estimativas iniciais na tabela 5.4 .\nNas figuras 5,33 e 5.34 est\u00e3o mostrados os resultados das regress\u00f5es baseadas na norma LI (MVAM, MVA, MVAM-MVA e N Mi e na norma L2 (MQ, MQ mod. e DVS) aplicadas ao conjunto de dados de press\u00e3o e da derivada do caso 2.\nFigura 5,33: Press\u00e3o e Derivada da Press\u00e3o versus Tempo em escala iogdog, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 2.\n\u25a000.00^\n200.\u00a350\n10\nDelta T (horas)\n0,00 -f\u2014\n0,85\n600,00J\n\nFigura 5.34: Press\u00e3o e Derivada da Press\u00e3o versus Tempo em escala semi-log, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 2.\nOutro caso analisado, denominado de caso 3, foi obtido de um teste num po\u00e7o da Bacia de Campos. Os dados de reservat\u00f3rio e de fluidos est\u00e3o na tabela 5.9 e os de press\u00e3o versus tempo est\u00e3o na tabela 5.10. Como se trata de um per\u00edodo de est\u00e1tica optamos por analisar o teste com o tempo equivalente de Agarwal:\nAi * tp % A\u00ed + tp\n(5.8)\nTamb\u00e9m neste caso avaliamos os mesmos sete m\u00e9todos b\u00e1sicos (MQ, MQ mod., MVAM. MVA, MVAM-MVA, DVS e AM). Na tabela 5.11 pode-se analisar alguns fatos interessantes. Como ser\u00e1 visto nas figuras 5,38 e 5.39, est\u00e1 sendo analisado um teste com pequeno coeficiente de estocagem., por\u00e9m esta varia nos primeiros instantes do teste. Esta varia\u00e7\u00e3o pode ser melhor avaliada analisando os intervalos de confian\u00e7a dos par\u00e2metros de regress\u00e3o, que nos m\u00e9todos baseados na norma L2 s\u00e2o afetados por este mau condicionamento do modelo f\u00edsico-matem\u00e1tico, no que se refere ao coeficiente de estocagem. J\u00e1 para os m\u00e9todos baseados na norma Ll, este mau condicionamento s\u00f3 \u00e9 refletido no intervalo de confian\u00e7a do coeficiente de estocagem, n\u00e3o afetando os outros intervalos. Novamente, como nos casos anteriores, os resultados baseados somente nos dados da derivada s\u00e3o discrepantes dos baseados nos dados de press\u00e3o ou dos baseados no conjunto de dados de press\u00e3o mais derivada.\nTempo de Produ\u00e7\u00e3o\t= 30.70 horas\nVaz\u00e3o de Teste\t= 646.5 STB/d\nRaio do Po\u00e7o\t= 0,354 p\u00e9s\nPorosidade\t= 0.175\nEspessura\t= 50,86 p\u00e9s\nViscosidade\t- 1.08746 cp\nCompressibilidade Total\t12.0 x 10\u201c6 1/psi\nFator Volume de Forma\u00e7\u00e3o\t= 1.3266 bbl/STB\nTabela 5.9: Dados de reservat\u00f3rio para o caso 3,\nTempo de Teste (horas)\tQueda de Press\u00e3o (psi)\tTempo de Teste (horas)\tQueda de Press\u00e3o (psi)\tTempo de Teste (horas)\tQueda de Press\u00e3o (psi)\n0.0095\t91.39\t0.5092\t2096.41\t2.8425\t2288.27\n0.0175\t469.80\t0,5925\t2104,82\t3.0092\t2295.09\n0,0258\t890.81\t0.6342\t2112.58\t3.1758\t2303,01\n0.0342\t1357.97\t0.6758\t2119,86\t3.3425\t2307.82\n0.0425\t1570.91\t0.7175\t2126.74\t3.5092\t2313.65\n0,0508\t1674.90\t0.7592\t2133,14\t3.6758\t2319.40\n0.0592\t1737,40\t0.8017\t2139.36\t3.8425\t2324.68\n0,0675\t1776.94\t0.8425\t2145.13\t4.0092\t2329.85\n0.0758\t1806.15\t0.9258\t2155.89\t4.1758\t2334.74\n0.0842\t1828.81\t1.0092\t2165,82\t4.3425\t2339.37\n0.0925\t1848.93\t1,0925\t2174.98\t4.5092\t2343.93\n0.1008\t1865.86\t1.1758\t2183.54\t4.6758\t2348.28\n0.1092\t1880.21\t1.2592\t2191.49\t4.8425\t2352.49\n0.1175\t1892.84\t1.3425\t2198.90\t5.0092\t2356,50\n0.1258\t.1904,75\t1.4258\t2206.08\t5.1758\t2360.39\n0,1442\t1926.16\t1.5092\t2212.67\t5.3425\t2364.19\n0.1592\t1940.69\t1.5925\t2218.99\t5.5092\t2367.79\n0.1758\t1954.75\t1.6758\t2225,06\t5.6758\t2371.37\n0.1925\t1967.20\t1.7592\t2230.75\t5.8425\t2374.75\n0.2092\t1977.93\t1.8425\t2236.21\t6.0092\t2378.08\n0.2425\t1996.86\t1.9258\t2241.40\t6.1758\t2381,38\n0.2770\t2013,58\t2.0092\t2246.56\t6.3425\t2384.37\n0.3092\t2027.06\t2.0925\t2251.54\t6.5092\t2387.54\n0.3425\t2039.32\t2.1758\t2256.00\t6.6758\t2390.38\n0.3758\t2051.29\t2.2595\t2260.54\t6,8425\t2393.30\n0.4092\t2061.77\t2.3425\t2265,10\t7.0092\t2396.04\n0.4425\t2071.07\t2.5092\t2273.20\t\t\n0.4675\t2077.51\t2,6758\t2280.96\t\t\nTabela 5,10: Dados de press\u00e3o versus tempo para o caso 3,\nMet.\tTipo\tk\t\tS\t\tC\t\tMQR / ponto }\tMRA / ponto )\tIte.\n\t\t(mD)\t+/- %\t\t+A%\t(1)\t+/-%\t\t\t\nMQ\tP\t14.32\t16.01\t6.98\t27.11\t5.447\t10.90\t5597.\t38.64\t08\nMQ\tD\t12.26\t16.68\t10.42\t22.52\t2.652\t14.42\t5849.\t37.00\t10\nMQ\tP +D\t14.31\t14.48\t6.99\t24.30\t5.352\t9.32\t9759.\t46.84\t12\nMQ(2)\tP\t14.3.1\t\u2014-\t6.97\t\u2014\t5.745\t\u2014\t5597.\t38.61\t09**\nMQ(2)\tD\t12.25\t\u2014\t10.43\t\u2014\t2.647\t\u2014\t5849.\t36.94\t12\nMQ(2)\tP+D\t14.31\t\u2014\t6.99\t\u2014\t5.351\t\u2014\t9759.\t46.85\t12\nDVS\tP\t14.31\t\u2014\t6.98\t\u2014\t5.746\t\u2014\t5597.\t38.62\t11\nDVS\tD\t12.25\t\u2014\t10.43\t\u2014\t2.647\t\t5849.\t36.94\t.10\nDVS\tP+D\t13.56\t\u2014\t6.34\t\u2014\t5.491\t\u2014\t9865.\t44.34\t06**\nMVAM\tP\t11.65\t0.88\t4.74\t1.68\t3.733\t6.34\t10269.\t25.40\t50*\nMVAM\tD\t10.92\t0.53\t9.54\t0.41\t2.193\t1.05\t6799.\t28.60\t44\nMVAM\tP+D\t11.50\t0.77\t4.62\t1.63\t4.069\t3.89\t12568.\t32.29\t50*\nMVA\tP\t11.65\t0.61\t4.74\t1.28\t3.717\t5.94\t10356.\t25.40\t14**\nMVA\tD\t10.89\t0.42\t9.54\t2.00\t2.181\t2.44\t6829.\t28.59\t09\nMVA\tP+D\t11.50\t0.38\t4.62\t0.79\t4.044\t3.37\t12665.\t32.29\t37**\n(3)\tP\t11.65\t0.63\t4.74\t1.32\t3.717\t6.15\t10356.\t25.40\t17\n(3)\tD\t10.89\t0.19\t9.55\t1.14\t2.181\t1.31\t6829.\t28.59\t10\n(3)\tP+D\t11.50\t0.39\t4.62\t0.80\t4.044\t3.42\t12665.\t32.29\t39\nNM\tP\t11.65\t\u2014\t4.74\t\u2014\t3.717\t\u2014\t10357.\t25.40\t117\nNM\tD\t10.89\t\u2014\t9.54\t\u2014\t2.181\t\u2014\t6829.\t28.59\t144\nNM\tP+D\t11.50\t\u2014\t4.62\t\u2014\t4.047\t\u2022\u2014\t12653.\t32.29\t111\n(1)\n(2)\n(3)\nIO~4 bbl/psi modifica\u00e7\u00e3o no dom\u00ednio.\nMVAM-MVA\nP - dados de press\u00e3o.\nD - dados da derivada.\nP+D - dados de press\u00e3o e da derivada. MQR - m\u00e9dia dos quadrados dos res\u00edduos. MRA - m\u00e9dia dos res\u00edduos absolutos.\nEstimativas Iniciais: k -= 50 mD\nS = 5.0\nC = 0.01 bbl/psi\n* parada por n. max. de itera\u00e7\u00f5es.\n** parada por falha no algoritmo procura Linear,\nTabela 5.11: Compara\u00e7\u00e3o do Desempenho de V\u00e1rios M\u00e9todos de Regress\u00e3o para os dados do caso 3.\nPara melhor avaliar os desempenhos dos v\u00e1rios m\u00e9todos, estes foram submetidos \u00e0s estimativas iniciais da tabela 5.12. 0 resultado est\u00e1 mostrado na tabela 5.13.\nNotam-se alguns fatos interessantes neste caso. Com o aumento do n\u00famero de pontos observados, neste caso 82, todos os m\u00e9todos tem melhor performance, o que leva a sugerir que quando se estiver analisando determinado teste de press\u00e3o utilizando regress\u00e3o n\u00e3o linear, deve-se ler o maior n\u00famero de pontos poss\u00edvel na carta de press\u00e3o analisada. Observa-se tamb\u00e9m que a utiliza\u00e7\u00e3o do conjunto de dados de press\u00e3o mais derivada melhora a interpreta\u00e7\u00e3o se existirem ru\u00eddos nos dados e/ou o modelo matem\u00e1tico admitido n\u00e3o se adaptar inteiramente ao problema analisado, como acontece neste caso.\n0 melhor m\u00e9todo de regress\u00e3o em termos de robustez foi o MQ, por\u00e9m, quando convergiu, o DVS teve melhor desempenho em termos de menor n\u00famero de itera\u00e7\u00f5es necess\u00e1rio para a converg\u00eancia. Existiram situa\u00e7\u00f5es onde o m\u00e9todo MVAM-MVA teve desempenho pior que o m\u00e9todo MVA, como no caso do conjunto de estimativas iniciais A para dados da derivada e de press\u00e3o mais derivada, no conjunto C para dados de press\u00e3o (devido a n\u00e3o converg\u00eancia do m\u00e9todo MVAM) e no conjunto E para dados de press\u00e3o e de press\u00e3o mais derivada (devido \u00e0s dificuldades de converg\u00eancia do MVAM). 0 m\u00e9todo NM s\u00f3 divergiu em um \u00fanico conjunto de estimativas iniciais, por\u00e9m isto provavelmente poder\u00e1 ser corrigido futuramente atrav\u00e9s da modifica\u00e7\u00e3o no algoritmo de composi\u00e7\u00e3o das quatro estimativas iniciais (este m\u00e9todo requer npar 1 estimativas iniciais). Neste trabalho foi utilizado o seguinte procedimento para obten\u00e7\u00e3o das estimativas iniciais:\nLeia\tki , 5\u2019i e C;\n=logAq\nk2 = ki + 0.5\n\u00bf3 = ki + 1.0\n= kl \"r 0.5\nSe\t(Si &lt;15.0) ent\u00e3o\n52\t= 5X + 5.0\n53\t= S'1 - L0\n54\t=\t+ 5.0\nSen\u00e3o\n52\t= 5i - 5.0\n53\t- Si - 1.0\n54\t= 5i \u2014 5.0\nFim do Se\nCi=logCi\nC2 = Cl\nC3 = Ci c4 = Cl + LO\nTamb\u00e9m neste caso a modifica\u00e7\u00e3o no dom\u00ednio dos par\u00e2metros n\u00e3o surtiu o efeito desejado, pois v\u00e1rias vezes os m\u00e9todos modificados divergiram.\nEstim, Inicial\tk (niD)\ts\tC (bbl/psi)\nA\t1.\t1.\t0.0001\nB\t0.1\t1.\t0.0001\nC\t10.\t\u20195.\t0.0010\nD\t100.\t10.\t0.0010\nE\t100.\t10.\t0.0100\nF\t500.\t25.\t0.0010\nG\t10.\t10.\t0.1000\nH\t1000.\t50.\t0.0100\nTabela 5.12: Estimativas Iniciais Utilizadas para V\u00e1rios M\u00e9todos de Regress\u00e3o para os dados do caso 3.\n(1)\tM\u00e9todo\tN.Iter e Tipo de Dados\t\t\t(1)\tM\u00e9todo\tN.Iter e Tipo de Dados\t\t\n\t\tP\tD\tP1D\t\t\tP\tD\tP+D\nA\tMQ\t10\t09\t12\tB\tMQ\t14\t14\t15\n\tMQ(2)\t14\t10\t15\t\tMQ(2)\t13\t18\t19\n\tMVAM\t28\t30\t30\t\tMVAM\t46\t35\t47\n\tMVAM(2)\t50*\t23\t50*\t\tMVAM(2)\t50*\t33\t50*\n\tMVA\t50*\t08\t25\t\tMVA\t50*\t(3)\t28\n\tMVA(2)\t50*\t08\t50*\t\tMVA(2)\t50*\t13\t50*\n\t(4)\t19\t09\t42\t\t(4)\t23\t13\t30\n\tDVS\t08\t08\t09\t\tDVS\t14\t17\t17\n\tNM\t247\t139\t11.6\t\tNM\t195\t149\t172\nC\tMQ\t10\t12\t14\tD\tMQ\t11\t09\t12\n\tMQ(2)\t(3)\t14\t(3)\t\tMQ(2)\t(3)\t12\t15\n\tMVAM\t(3)\t43*\t50*\t\tMVAM\t39\t46\t50*\n\tMVAM(2)\t(3)\t32\t49\t\tMVAM(2)\t50*\t46\t50*\n\tMVA\t50*\t19\t42\t\tMVA\t50*\t(3)\t50*\n\tMVA(2)\t(3)\t(3)\t50*\t\tMVA(2)\t(3)\t(3)\t50*\n\t(4)\t(3)\t11\t4.1\t\t(4)\t50*\t10\t34\n\tDVS\t09\t(3)\t09\t\tDVS\t11\t10\t07\n\tNM\t127\t157\t113\t\tNM\t173\t143\t151\nE\tMQ\t12\t.11\t09\tF\tMQ\t14\t13\t13\n\tMQ(2)\t23\t13\t21\t\tMQ(2)\t(3)\t17\t38\n\tMVAM\t50*\t39\t50*\t\tMVAM\t50*\t34\t50*\n\tMVAM(2)\t48\t40\t50*\t\tMVAM(2)\t(3)\t(3)\t50*\n\tMVA\t17\t13\t40\t\tMVA\t50*\t50*\t40\n\tMVA\u00cd2)\t50*\t(3)\t50*\t\tMVA(2)\t(3)\t(3)\t(3)\n\t(4)\t50*\t11\t43\t\t(4)\t50*\t15\t43\n\tDVS\t10\t12\t06\t\tDVS\t11\t(3)\t08\n\tNM\t182\t260\t189\t\tNM\t191\t167\t111\nG\tMQ\t14\t17\t13\tH\tMQ\t40\t37\t40\n\tMQ(2)\t10\t(3)\t13\t\tMQ(2)\t(3)\t(3)\t(3)\n\tMVAM\t34\t50*\t50*\t\tMVAM\t50*\t50*\t50*\n\tMVAM(2)\t20\t(3)\t30\t\tMVAM(2)\t48\t50*\t37\n\tMVA\t(3)\t(3)\t(3)\t\tMVA\t19\t11\t34\n\tMVA(2)\t(3)\t(3)\t(3)\t\tMVA(2)\t(3)\t(3)\t(3)\n\t(4)\t21\t14\t43\t\t(4)\t50*\t09\t43\n\tDVS\t(3)\t(3)\t(3)\t\tDVS\t11\t12\t09\n\tNM\t111\t221\t91\t\tNM\t(3)\t(3)\t(3)\n(1) - estimativa inicial. (2) - modifica\u00e7\u00e3o no dom\u00ednio dos par\u00e2metros.\n(3)\t- n\u00e3o convergiu. (*) - parada por n\u00famero m\u00e1ximo de itera\u00e7\u00f5es.\n(4)\t- MVAM-MVA\nTabela 5.13: Resultados dos V\u00e1rios M\u00e9todos de Regress\u00e3o. Caso 3. Estimativas iniciais na tabela 5.12 .\nNas figuras 5.35 a 5.37 pode-se novameiite observar a. semelhan\u00e7a ei.it re os caminhos seguidos pelos m\u00e9todos MVA e DVS e, por outro caminho, pelos m\u00e9todos restantes. Nota-se tamb\u00e9m que o m\u00e9todo MQ modificado tem um caminho bem pr\u00f3ximo ao caminho do m\u00e9todo MQ, somente sendo diferente nas primeiras itera\u00e7\u00f5es. Outro fato que deve-se destacar \u00e9 que as maiores mudan\u00e7as ocorrem nas duas primeiras itera\u00e7\u00f5es, seja qual for o m\u00e9todo analisado, sendo as varia\u00e7\u00f5es seguintes bem menores.\nAs estimativas iniciais utilizadas para a constru\u00e7\u00e3o das figuras 5.37 a 5.39 foram as seguintes;\nk = 50.0 niD\nS - 15.0\nC 0.0050 bbl/psi.\nFigura 5.35: Varia\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es no plano k S para os v\u00e1rios m\u00e9todos. Caso 3.\nFigura 5.36; Varia\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es no plano k C para os v\u00e1rios m\u00e9todos. Caso 3.\n9. 0050-,\n'\u00ed\u00eda.ga:\u00ae-\nx>\n@928'\nCJ\n0. 09?\u00ed3;\n-----r\u00edQ mo o'. sWrWr* hVAH GseeoriVA BEeear^AM-riVA\n_A././..\\A |)VS\n\u25a0w-w-i- N\u00ed-1\n\nO. @903\t; 1 , r r\u2014T-.-r\u2014T-\u2014, \u2014r-~.   \u2014\u00fc :\u2014t! ;\n\u25a00\t:0\t39\ns\nFigura 5.37: Varia\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es nu plano SC para os v\u00e1rios m\u00e9todos. Caso 3.\nNas figuras 5.38 e 5,39 est\u00e3o apresentados os dados de campo de press\u00e3o e da derivada versus tempo em escala log-log e semi-Iog, bem como as curvas de press\u00e3o e da derivada geradas com os par\u00e2metros determinados pelos m\u00e9todos baseados nas normas LI e L2 aplicados ao conjunto de dados de press\u00e3o mais derivada, Fica bem clara a capacidade dos m\u00e9todos baseados na norma LI de atribuir menores pesos a dados com ru\u00eddos ou onde o modelo matem\u00e1tico se aplica parcialmente, como neste caso onde os pontos iniciais tem um comportamento que indica que o coeficiente de estocagem varia. Neste caso, a curva da derivada gerada com os par\u00e2metros determinados com os m\u00e9todos baseados na norma LI est\u00e1 razoavelmente distante dos pontos iniciais da curva da derivada dos dados de campo, por\u00e9m \u00e0 medida que o tempo cresce, e consequentemente o coeficiente de estocagem deixa de variar, o ajuste desta curva torna-se melhor que aquele obtido com par\u00e2metros determinados com m\u00e9todos baseados na norma L2.\n0.01\nCCCCC Pra $ s em ~ Ur d o s da Camo\u00fc.\n-----\tna. na mo d ovs.\n....\tNVA, nvAn-rwA nm.\nD\u00e2H.y ada - D\u00bb d o s \u00e1 e Cs rrp o *\n----\tMQ, MQ rtiO d o \u00edJ DVS\u00bb\n....\tMV Ari, MV A, MVAM\u2019MVA ou MM.\nT-q-r\u2014---1---!\u2014\u2014r------------------i\u2014;\ti j . , -\n0.1\t,\t1\t\u00edO\n( h )\nFigura 5.38: Press\u00e3o e Derivada da Press\u00e3o versus Tempo em escala log-log, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 3.\nNas figura 5.40 a 5.45 est\u00e3o mostrados os histogramas dos erros entre os pontos observados em campo e as curvas geradas pelos par\u00e2metros avaliados pelas normas L1 e L2 para as regress\u00f5es efetuadas nos tres conjuntos de dados, bem como as distribui\u00e7\u00f5es probabil\u00edsticas de Gauss e Laplace correspondentes \u00e0s m\u00e9dias e desvios padr\u00f5es de cada par (conjunto de dados)-(tipo de norma). Neles pode-se melhor avaliar a congru\u00eancia entre as distribui\u00e7\u00f5es reais (histogramas) e a de Laplace, Tal semelhan\u00e7a nao est\u00e1 baseada na densidade de probabilidade da m\u00e9dia, pois estas densidades s\u00e3o muito pr\u00f3ximas seja na distribui\u00e7\u00e3o de Gauss, seja na de Laplace, mas sim na exist\u00eancia de valores de erros com densidades de probabilidade relativamente altas longe dos valores das m\u00e9dias, o que n\u00e3o \u00e9 admiss\u00edvel na distruibi\u00e7\u00e3o de Gauss,\nte<! (h)\nFigura 5.39: Press\u00e3o e Derivada da Press\u00e3o versus Tempo em escala semi-log, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 3.\n\u00cdD\nTS ^,4**5-\n<ts :\n\n/\n/\n&amp; .\t3\n\u25a0\\\n\nf ;\n//\n/ / //\nJ\n\n0,0\u00bb-\nu>\nRes\u00edduo (psi)\nFigura 5.40: Compara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss e de Laplace. Regress\u00e3o nos dados de press\u00e3o usando o m\u00e9todo MQ, Caso 3.\nD ( 8 t i GoU 5 8 I\u00e2 n (5 . Dls L d \u00a9 Ls p \u00ed 13 o * * O&amp;dd\u00f4 cf\u00a9 Cwo.\n- \u00a1\u00bfe-\t-\nRes\u00edduo (psi)\ne.eet -\nFigura 5.41: Compara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss e de Laplace. Regress\u00e3o nos dados de press\u00e3o usando o m\u00e9todo UVA. Caso 3.\n0.0S0-1\n\n\u00cdm>\n\u2019d s,a\u00f4\u00e9\nA\n4\n\n\n\n8. *300\n--30&lt;2^\t100\t4\u00a3&amp; GGtf\nRes\u00edduo (psi)\nFigura 5.42: Compara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss e de Laplace. Regress\u00e3o nos dados da derivada usando o m\u00e9todo MQ. Caso 3-\nA seguir foi analisado um per\u00edodo de est\u00e1tica de um teste de press\u00e3o obtido da refer\u00eancia [30b Novamente por se tratar de um per\u00edodo de est\u00e1tica foi utilizado o tempo equivalente de Agarwall. Os dados de reservat\u00f3rio est\u00e3o na tabela 5.14 e os de press\u00e3o versus tempo na tabela 5.15.\n-t\n4\n4\n4\n-j\n\u00e7T\\\t\n\t\ni a \\\\\t\nh \\\\\t\n\t\n/ y\t\n/7 i\tl\\\n\u00ed'\t: 7\tj\t\\ \\\\\n-7 i /\t\\\n/ ::\t\n----- D i y t,\t(;$ u 5 $ l a \u00ed\u00ed \u00f4 . ---- \u00a3):s\u00e7_\tL\u00ed\u00edpiQCf\u00edr ---- Dados d 9 C\u00ed iTD o ,\n\n-200\t->2\u00ed:\t\u00bf\tt\u00bf0\t2\u00d30 d\u00d30\nResiduo (psi)\n\"\u00c9/\u00a3r\nFigura 5.43: Compara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss e de Laplace. Regress\u00e3o nos dados da derivada usando o m\u00e9todo MVA. Caso 3.\ne, ose -\u00ed\n~\u00ed\n* f\n\u00ed \u2022.\n\u00a3. -\n\nDa des\nUC5 ti S \u00eds t 3 * \u00f4\n\u00c7\u00cd4? Lap t \u00cdJ\ndis\t>\n*0 3.303\n\u00a3\n\n0,301 -\n\n\u2022;\n\n//\ni\n\nti\n\u25a0i\nV\ng \u00ae 8\nQ\t=L>\nA\t\u00edF\n\u00cdS\tS\t\u00ab3\n&amp;\ts\ts\n2 b\nRes\u00edduo (psi)\nFigura 5.44: Compara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss e de Laplace. Regress\u00e3o no conjunto de dados de press\u00e3o e da derivada usando o m\u00e9todo MQ. Caso 3.\n0.004 -\nq;\nT5 0 > 003\ni\u2019 n\n0.08?\n/\n\n/\n0.000 '4r\n\u00e0\no-\n\u00eda\n\u2022a \u00edS>\nResiduo (psi)\nFigura 5.45: Compara\u00e7\u00e3o entre a distribui\u00e7\u00e3o real dos erros e as distribui\u00e7\u00f5es de Gauss e de Laplace. Regress\u00e3o no conjunto de dados de press\u00e3o e da derivada usando o m\u00e9todo MVA. Caso 3.\nTempo de Produ\u00e7\u00e3o\t= 3912.0 horas\nVaz\u00e3o de Teste\t= 36.0 STB/d\nRaio do Po\u00e7o\t~ 0.400 p\u00e9s\nPorosidade\t= 0.170\nEspessura\t= 165.0 p\u00e9s\nViscosidade\t= 0.5058 cp\nCompressibilidade Total\t= 5.0 x I0~s 1/psi\nFator Volume de Forma\u00e7\u00e3o\t= 1.333 bbl/STB\nTabela 5.14; Dados de reservat\u00f3rio para o caso 4.\nTempo de Teste (horas)\tQueda de Press\u00e3o (psi)\tTempo de Teste (horas)\tQueda de Press\u00e3o (ps*)\n35.00\t22.85\t1157.20\t380.80\n40.00\t26.31\t1421.00\t432.72\n45.00\t28.90\t1747.00\t482.85\n50.00\t31.51\t2146.00\t532.00\n55.00\t34.09\t2634.00\t577.93\n60.00\t36.68\t3240.00\t616.86\n65.00\t39.26\t3982.00\t646.66\n70.00\t41.85\t4892.00\t674.00\n75.00\t44.42\t7387.00\t704.50\n80.00\t47.00\t7494.00\t704.17\n90.00\t52.16\t7602.00\t704.14\n100.00\t57.29\t77.12.00\t704.65\n110.00\t62.43\t7938.00\t705.74\n120.00\t67.56\t8053.00\t706.08\n130.00\t72.69\t8169.00\t706.53\n147.00\t81.38\t8408.00\t707.58\n181.00\t98.72\t8653.00\t708.50\n223,00\t119.72\t8778.00\t708.83\n274.00\t143.92\t9053.00\t708.63\n336.00\t171.29\t9166.00\t708.90\n413.00\t202.49\t9433.00\t709.48\n507.00\t234.60\t9570.00\t709.85\n624.00\t262.57\t9707.00\t710.17\n766.00 941.00\t294.61 333.42\t9849.00\t710.58\nTabela 5.15: Dados de press\u00e3o versus tempo para o caso 4.\nEstes dados quando analisados atrav\u00e9s dos mesmos sete m\u00e9todos b\u00e1sicos referidos anteriormente (MQ, MQ mod., MVAM, MVA, MVANf-MVA, DVS e NM) tem como resultados aqueles mostrados na tabela 5,16. Ao analisar esta tabela fica claro que somente os resultados das regress\u00f5es que foram efetuadas sobre o conjunto de dados de press\u00e3o mais derivada est\u00e3o corretos. Esta afirma\u00e7\u00e3o se torna ciara quando observa-se que existe uma grande separa\u00e7\u00e3o entre as curvas de press\u00e3o e da derivada (ver figuras 5.46 e 5A7), caracterizando um fator de pel\u00edcula de valor alto. Este n\u00e3o \u00e9 o resultado obtido pelas regress\u00f5es efetuadas somente nos dados de press\u00e3o, que mostram um pequeno valor negativo para o fator de pel\u00edcula. Por outro lado, como j\u00e1 comentado anteriormente, os resultados das regress\u00f5es efetuadas sobre os dados da derivada n\u00e3o tem a confiabilidade dos resultados obtidos quando se efetua a regress\u00e3o sobre os outros dois conjuntos de dados.\nVale a pena ressaltar que a utiliza\u00e7\u00e3o de m\u00e9todos convencionais neste caso se mostraria infrut\u00edfera, pois a figura 5.46 mostra que n\u00e3o houve tempo suficiente para a exist\u00eancia de uma reta semi-log, o que impossibilitaria este tipo de an\u00e1lise.\nMet.\tTipo Dado\tk\t\tS\t\tC\t\tMQR (psi2 /ponto )\tMR\u00c1 O* /ponto)\tIte.\n\t\t(mD)\t+/-%\t\t+/-%\t(1)\t+ /- %\t\t\t\nMQ\tP\t0.234\t19.51\t-0.16\t924.1\t3.496\t3.85\t42.77\t5.38\t11\nMQ\tD\t0.822\t25.44\t18.69\t36.20\t4.436\t5.57\t126.9\t8.39\t07\nMQ\tP+D\t0.517\t22.85\t9.22\t42.75\t3.980\t3.19\t130.9\t8.30\t07\nMQ(2)\tP\t0.236\t\u2014\t-0.08\t\u2014\t3.502\t\u2014\t42.80\t5.39\t50*\nMQ(2)\tD\t0.822\t\u2014\t19.45\t\u2014\t4.438\t\u2014\t126.9\t8.32\t14\nMQ(2)\tP+D\t0.513\t\t9.07\t\u2014\t3.980\t\u2014\t130.9\t8.31\t29\nDVS\tP\t0.231\t\u2014\t-0.23\t\u2014\t3.489\t\u2014\t42.77\t5.38\t11\nDVS\tD\t0.822\t\u2014\t19.45\t\t4.438\t\u2014\t126.9\t8.32\t12\nDVS\tP+D\t0.513\t\u2014\t9.07\t\u2014\t3.977\t\u2014\t130.9\t8.31\t10\nMVAM\tP\t0.217\t0.14\t-0.72\t1.18\t3.272\t0.01\t66.98\t4.80\t29\nMVAM\tD\t0.692\t4.75\t15.65\t6.70\t4.141\t1.58\t141.9\t8.14\t32\nMVAM\tP+D\t0.517\t1.11\t9.13\t2.13\t3.921\t0.41\t133.3\t8.14\t31\nMVA\tP\t0.2.17\t0.13\t-0.72\t1.22\t3.272\t0.03\t66.98\t4.80\t09\nMVA\tD\t0.815\t2.45\t19.59\t3.34\t4.347\t0.33\t129.6\t8.12\t11\nMVA\tP+D\t0.517\t0.68\t9.13\t1.29\t3.921\t0.11\t133.3\t8.14\t10\n(3)\tP\t0.217\t0.07\t-0.72\t0.64\t3.272\t0.02\t66.98\t4.80\t09\n(3)\tD\t0.815\t2.60\t19.59\t3.54\t4.347\t0.35\t.129.6\t8.12\t.14\n(3)\tP+D\t0.517\t0.09\t9.13\t0.17\t3.921\t0.02\t133.3\t8.14\t12\nNM\tP\t0.217\t\u2014\t-0.72\t\u2014\t3.272\t\u2014\t66.98\t4.80\t248\nNM\tD\t0.778\t\u2014\t18.41\t\u2014\t4.300\t\t131.1\t8.13\t136\nNM\tP+D\t0.517\t\u2014\t9.15\t\u2014\t3.922\t\u2014\t133.2\t8.14\t116\n(1) - bl\t+ /psi\t\t\t\t\tEstimativas Iniciais:\t\t\t\t\n(2)\t- modifica\u00e7\u00e3o no dom\u00ednio.\t\t\t\t\t\tk = 0.5 mD\t\t\t\t\n(3) - MVAM-MVA\t\t\t\t\t\tS = 1.0\t\t\t\t\nP -\tdados de press\u00e3o.\t\t\t\t\tC = 1.0 bbl/psi\t\t\t\t\nD -\tdados da derivada.\t\t\t\t\t\t\t\t\t\nP+D - dados de press\u00e3o e da derivada.\t\t\t\t\t\t* parada por n\t\t. max. de itera\u00e7\u00f5es.\t\t\nMQR - m\u00e9dia dos quadrados dos res\u00edduos.\t\t\t\t\t\t\t\t\t\t\nMRA * m\u00e9dia dos res\u00edduos absolutos.\t\t\t\t\t\t\t\t\t\t\nTabela 5.16: Compara\u00e7\u00e3o do Desempenho de V\u00e1rios M\u00e9todos de Regress\u00e3o para os dados do caso 4.\nFigura 5.46: Press\u00e3o e Derivada da Press\u00e3o versus Tempo em escala log-log, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 4.\nFigura 5.47: Press\u00e3o e Derivada da Press\u00e3o versus Tempo em escala semi-log, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 4.\nPara efetuar uma compara\u00e7\u00e3o do desempenho dos v\u00e1rios m\u00e9todos frente a diferentes estimativas iniciais foram elaboradas as tabelas 5.17 e 5.18. Na primeira est\u00e3o os o\u00edto conjuntos de estimativas iniciais e na segunda os resultados das regress\u00f5es quando utilizamos aquelas estimativas. Ao analisar esta \u00faltima tabela nota-se que o m\u00e9todo com maior robustez \u00e9 o NM, que s\u00f3 falhou em um caso, sendo que para o conjunto de estimativas iniciais F aplicado aos dados da derivada ele \u00e9 o \u00fanico que converge. O m\u00e9todo MVAM-MVA tamb\u00e9m demonstrou boa performance, pois s\u00f3 divergiu tres vezes e nas outras tentativas n\u00e3o teve problemas com o algoritmo de procura linear, o que ocorreu frequentemente com os m\u00e9todos MQ e MVAM mod.. Para estes dados as regress\u00f5es efetuadas no conjunto de dados de press\u00e3o mais derivada mostraram-se muito eficientes, em termos de redu\u00e7\u00e3o no n\u00famero de itera\u00e7\u00f5es, em rela\u00e7\u00e3o \u00e0s regress\u00f5es efetuadas somente sobre os dados de press\u00e3o ou somente sobre os dados da derivada.\nEstim. Inicial\tk (m.D)\ts\tC (bbl/psi)\nA\t1.\t5.\t1.00\nB\t0.1\t10.\t1.00\nC\t10.\t5.\t1.00\nD\t1.\t5.\t10.0\nE\t1.\t25.\t0.10\nF\t10.\t25.\t0.10\nG\t0.1\t-5.\t1.00\nH\t10.\t-5.\t0.01\nTabela 5.17; Estimativas Iniciais Utilizadas para V\u00e1rios M\u00e9todos de Regress\u00e3o para os dados do caso 4.\nU)\tM\u00e9todo\tN.Iter e Tipo de Dados\t\t\t(1)\tM\u00e9todo\tN.Iter e Tipo de Dados\t\t\n\t\tP\tD\tP+D\t\t\tP\tD\tP+D\nA\tMQ\t11\t07**\t06**\tB\tMQ\t12\t08**\t07**\n\tMQ(2)\t04**\t27\t19\t\tMQ(2)\t08\t12\t29\n\tMVAM\t26\t50*\t43\t\tMVAM\t50*\t50*\t34\n\tMVAM(2)\t08**\t13**\t10**\t\tMVAM(2)\t14**\t\t19**\n\tMVA\t11\t11\t10\t\tMVA\t06\t08\t08\n\tMVA(2)\t10\t12**\t12\t\tMVA(2)\t07\t06**\t07**\n\t(4)\t12\t14\t10\t\t(4)\t10\t12\t08\n\tDVS\t11\t11\t10\t\tDVS\t09\t08\t08\n\tNM\t212\t300*\t65\t\tNM\t294\t92\t181\nc\tMQ\t27\t09**\t19\tD\tMQ\t08**\t05**\t08\n\tMQ(2)\t50*\t(3)\t08\t\tMQ(2)\t(3)\t10\t09\n\tMVAM\t50*\t45**\t50*\t\tMVAM\t28\t50*\t36\n\tMVAM(2)\t20**\t36**\t\t\tMVAMi2)\t(3)\t12**\t10**\n\tMVA\t(3)\t19\t(3)\t\tMVA\t07\t10\t08\n\tMVA(2)\t(3)\t(3)\t(3)\t\tMVA(2)\t09\t08**\t05**\n\t(4)\t14\t14\t10\t\t(4)\t13\t08\t07\n\tDVS\t(3)\t(3)\t(3)\t\tDVS\t09\t08\t08\n\tNM\t98\t300*\t248\t\tNM\t263\t140\t145\nE\tMQ\t15\t(3)\t10**\tF\tMQ\t19\t(3)\t15\n\tMQ(2)\t08\t(3)\t33\t\tMQ(2)\t(3)\t(3)\t23\n\tMVAM\t37\t37\t42\t\tMVAM\t45\t(3)\t36\n\tMVAM(2)\t\t50*\t19**\t\tMVAM(2)\t(3)\t(3)\t12**\n\tMVA\t(3)\t15\t(3)\t\tMVA\t(3)\t(3)\t10\n\tMVA(2)\t(3)\t(3)\t12\t\tMVA(2)\t(3)\t(3)\t(3)\n\t(4)\t17\t18\t22\t\t(4)\t13\t(3)\t23\n\tDVS\t(3)\t15\t11\t\tDVS\t(3)\t(3)\t(3)\n\tNM\t100\t.166\t215\t\tNM\t300*\t175\t216\nG\tMQ\t08**\t07**\t08**\tH\tMQ\t\t17**\t15**\n\tMQ(2)\t11\t28\t29\t\tMQ(2)\t(3)\t(3)\t(3)\n\tMVAM\t50*\t31**\t43\t\tMVAM\t50*\t(3)\t(3)\n\tMVAM(2)\t(3)\t\t(3)\t\tMVAM(2)\t17**\t(3)\t17**\n\tMVA\t08\t11\t08\t\tMVA\t(3)\t(3)\t(3)\n\tMVA(2)\t10\t11**\t12\t\tMVA(2)\t(3)\t(3)\t(3)\n\t(4)\t10\t11\t12\t\t(4)\t15\t(3)\t(3)\n\tDVS\t10\t09\t09\t\tDVS\t(3)\t(3)\t(3)\n\tNM\t178\t180\t215\t\tNM\t300*\t173\t(3)\n(1)\t- estimativa Inicial.\t\t(2)-\tmodifica\u00e7\u00e3o\t\tno dom\u00ednio c\tos par\u00e2metros.\t\t\n(*) - parada por n\u00famero m\u00e1ximo de itera\u00e7\u00f5es. (**) - parada por falha no alg. proc. linear.\n(3)\t- n\u00e3o convergiu.\n(4)\t- MVAM-MVA\nTabela 5.18: Resultados dos V\u00e1rios M\u00e9todos de Regress\u00e3o. Caso 4. Estimativas iniciais na tabela 5.17 .\n5.2\tAn\u00e1lise de Casos de Reservat\u00f3rios com Comportamento de Dupla Porosidade Infinito.\nNesta se\u00e7\u00e3o ser\u00e3o discutidos ires casos de testes de press\u00e3o, dois elaborados a partir de dados sint\u00e9ticos e um caso de campo.\nPara o primeiro caso, denominado caso S, foi gerada uma curva de press\u00e3o versus tempo para um per\u00edodo de fluxo a partir dos seguintes par\u00e2metros: k = 163 niD, S = -2.45. C = 0.00233 bbl/psi. A = 3.47 * 10\u201c5 eu? = 0.21; os demais dados necess\u00e1rios para o c\u00e1lculo s\u00e3o aqueles mostrados n.a tabela 5.19. O resultado deste procedimento pode ser visto na tabela 5.20 onde est\u00e3o listados os dados de press\u00e3o versus tempo. O modelo de acoplamento entre a matriz e a fratura utilizado para a constru\u00e7\u00e3o da curva de press\u00e3o versus tempo foi o de Warren-Root.\nVaz\u00e3o de Teste\t= 240.0 STB/d\nRaio do Po\u00e7o\t= 0.375 p\u00e9s\nPorosidade\t= 0.150\nEspessura\t= 24.0 p\u00e9s\nViscosidade\t= 5.2000 cp\nCompressibilidade Total\t= 75.0 x 10\u201d6 1/psi\nFator Volume de Forma\u00e7\u00e3o\t= 1.478 bbl/STB\nTabela 5.19: Dados de reservat\u00f3rio para os casos 5 e 6.\nNas tabela 5.21 e 5.22 pode-se analisar o comportamento dos m\u00e9todos MQ, DVS, MVAM, MVA, MVAM-MVA e MM. Nota-se que os m\u00e9todos baseados na norma L2 (MQ e DVS) tiveram maior dificuldade de converg\u00eancia, principalmente quando analisados perante o conjunto de dados de press\u00e3o mais derivada, enquanto que os m\u00e9todos baseados na, norma LI (exce\u00e7\u00e3o ao m\u00e9todo NM) convergiram facilmente para os valores corretos, mesmo na presen\u00e7a de ru\u00eddos introduzidos pelo c\u00e1lculo da derivada. E importante frisar que os intervalos de confian\u00e7a obtidos pelos m\u00e9todos baseados na norma Ll. s\u00e3o, neste caso, muito melhores que os obtidos pelos m\u00e9todos baseados na norma L2. No caso do m\u00e9todo NM, quando se efetuou a regress\u00e3o no conjunto de dados de press\u00e3o mais derivada, utilizou-se a seguinte fun\u00e7\u00e3o para minimiza\u00e7\u00e3o:\nEi(S) = 52 {2* |l\u00b0gAp\u00ed-log Ap(a,t\u00ed)| + ]log A'pi - log\t(5.9)\n\u00ed'=i\nTempo de Teste (horas)\tQueda de Press\u00e3o (psi)\tTempo de Teste (horas)\tQueda de Press\u00e3o (.Psi)\n.000500\t2.9100\t10.0000\t275.2119\n.001000\t5.5049\t15.0000\t287.7672\n.001500\t7.9069\t30.0000\t308.0365\n.005000\t21.6002\t50.0000\t321.5469\n.010000\t35.9859\t73.0000\t330.4958\n.015000\t47.0334\t98.0000\t336.7446\n.030000\t69.9369\t147.000\t344.3399\n.050000\t89.0082\t300.000\t356.0063\n.080000\t107.1769\t500.000\t365.0756\n.170000\t135.9872\t700.000\t372.3069\n.330000\t160.3380\t1000.00\t381.3315\n.500000\t175.1263\t1500.00\t393.1086\n.750000\t189.2815\t3000.00\t415.4199\n1.00000\t199.1892\t5000.00\t432.4122\n1.30000\t208.1410\t7000.00\t443.6251\n3.00000\t236.2064\t10000.0\t455.5044\n5.50000\t256.0953\t15000.0\t469.0040\n7,00000\t263.8778\t50000.0\t509.0896\nTabela 5.20: Dados de press\u00e3o versus tempo para o caso 5.\nescolhida para melhor ponderar as diferen\u00e7as entre as curvas de press\u00e3o dos dados de campo e dos dados de press\u00e3o calculados quando comparadas \u00e0s diferen\u00e7as dos dados da derivada obtida com os dados de campo das obtidas analiticamente. Esta pondera\u00e7\u00e3o foi necess\u00e1ria pois os valores de press\u00e3o chegam a ser 17 vezes maiores que os valores da derivada, afetando consequentemente na mesma escala os valores das diferen\u00e7as. Portanto a utiliza\u00e7\u00e3o do logaritmo da press\u00e3o e do logaritmo da derivada normaliza esta diferen\u00e7a de escala.\nMet\tTipo Dado\tk\t\ts +/\u201c %\t\t(1)\tC +/- %\tA\t\n\t\t(mD)\t+/- %\t\t\t\t\t(2)\t+/-%\nMQ\tP\t147.8\t1.05\t-3.03\t1.88\t2.16\t10.35\t15.14\t4.83\nMQ\tP+D\t160.8\t0.23\t-2.52\t0.56\t2.27\t1.90\t3.92\t1.44\nDVS\tP\t163.0\t\t-2.45\t\u2014\t2.23\t\u2014\t3.47\t\u2014\nDVS\tP+D\t160.5\t\u2014\t-2.53\t\u2014\t2.28\t\u2014\t4.03\t\u2014\nMVAM\tP\t163.0\t<0,01\t-2.45\t<0,01\t2.23\t<0.01\t3.47\t<0.01\nMVAM\tP+D\t163.0\t<0.01\t-2.45\t<0.01\t2.23\t0.01\t3.47\t0.01\nMV\u00c3\tP\t163.0\t<0.01\t-2.45\t<0.01\t2.23\t<0.01\t3.47\t<0.01\nMVA\tP+D\t163.0\t0.01\t-2.45\t0.02\t2.23\t0.06\t3.47\t0.06\n(3)\tP\t163.0\t<0.01\t-2.45\t<0.01\t2.23\t<0.01\t3.47\t<0.01\n(3)\tP+D\t163.0\t<0.01\t-2.45\t<0.01\t2.23\t<0.01\t3,47\t0.01\nNM\tP\t155.1\t\u2014\t-2.47\t\u2014\t2.18\t\u2014~\t3.66\t\u2014\nNM\tP+D\t133.9\t\u2014\t-3.57\t\u2014\t2.17\t\u2014\t2.18\t. \u2014\n(1)\t- 10 3 bbl/psi\tEstimativas Iniciais;\n(2) - 10~5\tk = 100. mD\n(3) - MVAM MVA\tS = 1.0\nP - dados de press\u00e3o.\tC = 0.01 bbl/psi\nD - dados da derivada.\tA = 10~5\nP+D - dados de press\u00e3o e da derivada.\tw = 0.05\nTabela 5.21: Compara\u00e7\u00e3o do Desempenho de V\u00e1rios M\u00e9todos de Regress\u00e3o para os dados do caso 5.\nM\u00e9todo MQ MQ\tDados P P+D\t\t\tMQR (psi2 /ponto} 26.065 5.171\tMRA (psi /ponto} 3.960 1.640\tItera\u00e7\u00f5es 09 10\n\t\t0.114 0.195\t+A % 6.43 1.56\t\t\t\nDVS\tP\t0.210\t\u2014\t<0.0001\t<0.0001\t17\n:dvs\tP+D\t0.193\t\t5.165\t1.633\t30\nMVAM\tP\t0.210\t<0.01\t<0.0001\t<0.0001\t13\nMVAM\tP+D\t0.210\t0.01\t5.504\t1.381\t17\nMVA\tP\t0.210\t<0.01\t<0.0001\t<0.0001\t14\nMVA\tP+D\t0.210\t0.06\t5.504\t1.381\t16\n(1)\tP\t0.210\t<0.01\t<0.0001\t<0.0001\t11\n(1)\tP+D\t0.210\t<0.01\t5.504\t1.380\t14\nNM\tP\t0.236\t\u2014\t0.00097\t0.0250\t772\nNM\tP+D\t0.198\t\u2014\t0.00237*\t0.0082*\t237\n(1)\t- MVAM MVA\nMQR * m\u00e9dia dos quadrados dos res\u00edduos. MRA - m\u00e9dia dos res\u00edduos absolutos.\n* - fun\u00e7\u00e3o objetivo modificada.\nTabela 5.22: Compara\u00e7\u00e3o do Desempenho de V\u00e1rios M\u00e9todos de Regress\u00e3o para os dados do caso 5.\n8S\nNa tabela 5.24 est\u00e3o mostrados os resultados do desempenho dos v\u00e1rios m\u00e9todos frente \u00e0s estimativas iniciais listadas na tabela 5.23. Nesta tabela fica bem clara a supremacia do m\u00e9todo MVAM que s\u00f3 n\u00e3o convergiu para a estimativa F aplicada aos dados de press\u00e3o. Nota-se tamb\u00e9m que o m\u00e9todo MVAM-MVA \u00e9 muito bom, divergindo apenas para a estimativa inicial F aplicada aos dois conjuntos de dados. Interessante que neste \u00faltimo caso, quando o m\u00e9todo MVAM foi trocado pelo MVA (aplicado ao conjunto de dados de press\u00e3o mais derivada) o m\u00e9todo MVAM-MVA n\u00e3o convergiu apesar do MVAM convergir neste caso. Tamb\u00e9m deve-se ressaltar a dificuldade que o m\u00e9todo NM teve quando aplicado a este modelo de reservat\u00f3rio. Pode-se notar que o m\u00e9todo convergia para valores razoavelmente corretos dos par\u00e2metros k, S e C, por\u00e9m n\u00e3o teve capacidade de determinar bem os valores dos par\u00e2metros A ew.\nEstim. Inicial\tk (inD)\tS\tC (bbl/psi)\tA\tLU\nA\t10.\t-5.\t0.01\tl*10\u201c5\t0.10\nB\t1.\t1.\t0.01\tl*10\u201c5\t0.10\nC\t500.\t1.\t0.01\tU10 5\t0.25\nD\t100.\t15.\t0.01\tl*10~7\t0.50\nE\t100.\t1.\t0.10\tPIO\"5\t0.10\nF\t100.\t1.\t0.01\t5*10\u20141\t0.10\nG\t1000.\t1.\t0.001\tpiQ-7\t0.01\nH\t50.\t\u00f5.\t0.01\tl*10\"T\t0.01\nTabela 5.23: Estimativas Iniciais Utilizadas para. V\u00e1rios M\u00e9todos de Regress\u00e3o para os dados do caso 5 e do caso 6.\n(1)\tM\u00e9todo\tN.Iter e Tipo de Dados\t\t(1)\tM\u00e9todo\tN.Iter e Tipo de Dados\t\n\t\tP\tP+D\t\t\tP\tP+D\nA\tMQ\t16\t12\tB\tMQ\t19*\t18\n\tMVAM\t21\t22\t\tMVAM\t27\t28*\n\tMVA\t37\t(2)\t\tMVA\t17\t(2)\n\t(3)\t14\t16\t\t(3)\t19\t21\n\tDVS\t(2)\t(2)\t\tDVS\t26*\t(2)\n\tNM\t415\t249\t\tNM\t(2)\t(2)\nC\tMQ\t(2)\t(2)\tD\tMQ\t15*\t15*\n\tMVAM\t20\t24*\t\tMVAM\t23\t10*\n\tMVA\t(2)\t(2)\t\tMVA.\t13\t13\n\t(3)\t27\t21\t\t(3)\t15\t17\n\tDVS\t(2)\t14\t\tDVS\t19\t22\n\tNM\t(2)\t(2)\t\tNM\t(2)\t(2)\nE\tMQ\t11*\t13*\tF\tMQ\t(2)\t(2)\n\tMVAM\t20*\t21\t\tMVAM\t(2)\t39\n\tMVA\t30\t17\t\tMVA\t(2)\t(2)\n\t(3)\t10\t14\t\t(3)\t(2)\t(2)\n\tDVS\t22*\t22*\t\tDVS\t(2)\t14\n\tNM\t(2)\t373\t\tNM\t(2)\t(2)\nG\tMQ\t15\t16*\tH\tMQ\t18*\t16*\n\tMVAM\t23\t28\t\tMVAM\t21\t22\n\tMVA\t11\t11\t\tMVA\t15\t15\n\t(3)\t19\t18\t\t(3)\t15\t19\n\tDVS\t14\t20*\t\tDVS\t18\t14\n\tNM\t(2)\t(2)\t\tNM\t(2)\t(2)\n(1)\t- estimativa inicial\n(2)\t- n\u00e3o convergiu.\n(3)\t- MVAM-MVA\n(*) - falha alg. proc. linear.\nTabela 5.24: Resultados dos V\u00e1rios M\u00e9todos de Regress\u00e3o. Caso 5. Estimativas iniciais na tabela 5.23.\nNas figuras 5.48 e 5.49 est\u00e3o plotados os dados de press\u00e3o e derivada lo* gar\u00edtmica versus tempo em escalas log-log e semi-log bem como as curvas geradas pelos resultados das regress\u00f5es. Pode-se observar que os resultados obtidos por quaisquer um dos m\u00e9todos, excetuando-se o NM, s\u00e3o, visualmente falando, equivalentes. Na figura 5.50 observa-se a evolu\u00e7\u00e3o da m\u00e9dia dos res\u00edduos ao quadrado (MQR) ao longo das itera\u00e7\u00f5es, onde os valores finais s\u00e3o equivalentes (5.171 psz2 p/ a norma L2 e 5.504 psi2 p/ a norma Ll). J\u00e1 na figura 5.51 est\u00e1 plotada a evolu\u00e7\u00e3o da m\u00e9dia dos res\u00edduos absolutos versus o n\u00famero de itera\u00e7\u00f5es, onde novamente os valores finais s\u00e3o equivalentes (1.640 psi e 1.381 psi respectivamente).\nTrrtTr i TTTHT!? \u2018\u25a0'\u25a0\u2018\u25a0\u201c-'rrTTTq ^\u2019rrq-rrTn i i\ti s i ivrq p , \u00a1 i\t---\n\u00a31,001 0,1 ? 10 100 1000 10000\nDelta T (horas)\nFigura 5.48: Press\u00e3o e Derivada de Press\u00e3o versus Tempo em escala log-log, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 5.\nNas figuras 5.52 a 5.56 pode-se analisar a evolu\u00e7\u00e3o dos cinco par\u00e2metros de regress\u00e3o (k, S, C. A eu; ) com o decorrer das itera\u00e7\u00f5es. As diferen\u00e7as nos valores finais s\u00e3o mais percept\u00edveis nos casos dos par\u00e2metros X e ijj (ver figuras 5.55 e 5.56). J\u00e1 nas figuras 5.57 a 5.62 analisa-se a evolu\u00e7\u00e3o ou caminho percorrido pelos par\u00e2metros nos planos k-S, k-C, k-A, k-u;, A-u; e S-u;, A semelhan\u00e7a de comportamento observada no modelo de reservat\u00f3rio anterior entre os m\u00e9todos MQ e MVAM e entre os m\u00e9todos DVS e MVA, n\u00e3o fica t\u00e3o clara neste caso, somente aparecendo nos planos k-C, k-u; e S-u;. Todas estas figuras foram elaboradas com as regress\u00f5es efetuadas sobre os dados de press\u00e3o mais derivada.\n\u2022600.0\u00a9\nS^500.&amp;3\n\u2014 MVAM,\ncoijoo Dn&lt;j c? i\n----~ MQ cu\n.J\n/\nf\u2014i\n\u00a33 330.00\na*\nDelta T (horas)\nFigura 5.49; Press\u00e3o e Derivada de Press\u00e3o versus Tempo em escala semi-log, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 5.\nMQ\nDy$\n$0 W HVAM Mses WA a&amp;4\u00bb*A rWAM-MVA\nItera\u00e7\u00f5es\nFigura 5.51: Comportamento da m\u00e9dia dos res\u00edduos absolutos ao longo das itera\u00e7\u00f5es. Caso 5.\nFigura\n5.53: Comportamento do fator de pel\u00edcula ao longo das itera\u00e7\u00f5es. Caso 5.\nFigura 5.54: Comportamento do coeficiente de estocagem ao longo das itera\u00e7\u00f5es. Caso 5.\nFigura 5.55: Comportamento do coeficiente de fluxo interporoso \u00c0 ao longo das itera\u00e7\u00f5es. Caso 5.\nFigura 5.57: Varia\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es no plano k-S para os v\u00e1rios m\u00e9todos. Caso 5.\nFigura 5.59: Varia\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es no plano k-A para os v\u00e1rios m\u00e9todos. Caso 5.\n9, B0 \"\nVFT\n1\nno\nfl-aa a ft DVS\nMV AM\nmva jiAfra* MV AM- MV A\n0.20-J\nLambda\nFigura 5.61: Varia\u00e7\u00e3o dos par\u00e2metros ao longo das itera\u00e7\u00f5es no plano A-cv para os v\u00e1rios m\u00e9todos. Caso 5,\n0 resultado desta an\u00e1lise est\u00e1, mostrado nas tabelas 5.26 e 5.27, onde novamente fica clara a dificuldade que os m\u00e9todos baseados na norma L2 tem de lidar com dados contendo ru\u00eddo, seja sua origem intr\u00ednseca \u00e0 obten\u00e7\u00e3o dos dados, seja por posterior procedimento de c\u00e1lculo.\nPara comparar a robustez destes m\u00e9todos frente \u00e0s estimativas iniciais da tabela 5-23, foi elaborada a tabela 5.28. Nela observa-se novamente a melhor robustez do m\u00e9todo MVA.M comparado aos outros m\u00e9todos, pois ele s\u00f3 divergiu duas vezes. Nota-se tamb\u00e9m que o m\u00e9todo MVA. quando converge, n\u00e3o tem problemas com o algoritmo de procura linear, o que \u00e9 comum nos m\u00e9todos MQ, MVAM e DVS. Novamente o m\u00e9todo NM n\u00e3o teve bom desempenho, convergindo somente em seis das dezesseis tentativas.\nNas figuras 5.63 e 5.64 pode-se observar o comportamento da press\u00e3o e da derivada em fun\u00e7\u00e3o do tempo em escalas log-Log e semi-log. Nota-se que os resultados dos m\u00e9todos baseados tanto na norma LI como na norma L2 s\u00e3o equivalentes, por\u00e9m. Conforme comentado acima, no entanto, os m\u00e9todos baseados na minimiza\u00e7\u00e3o da, norma L2 convergiram com menor frequ\u00eancia do que aqueles baseados na norma LI.\nFigura 5.63: Press\u00e3o e Derivada de Press\u00e3o versus Tempo em escala Iog-fog, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 6.\nCampe\nOOOOO Ga tio s 'Snttb\u00edft-\n--------MO&lt;jy\n^500.301\na 308,003\nDelta T (horas)\n- rwt.\n\nFigura 5.64: Press\u00e3o e Derivada de Press\u00e3o versus Tempo em escala semi-Iog, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 6.\nTempo de Teste (horas)\tQueda de Press\u00e3o Real (psi)\tQueda de Press\u00e3o Modificada (psi)\n\u00dc.\u00dc1OO\t35.986\t27.000\n0.0500\t89.008\t95.000\n1.0000\t199.189\t189.000\n50,000\t321.547\t330.000\n150.00\t393.109\t382.000\nTabela 5.25: Ru\u00eddos introduzidos nos dados de press\u00e3o. Caso 6.\nMet.\tTipo Dado\tk\t\ts +/-%\t\t(1)\tC +/-%\t\u00c0 (2) +/- %\t\n\t\t(mD)\t+/- %\t\t\t\t\t\t\nMQ MQ\tP P+D\t160.9 158.6\t0.66 0.61\t-2.45 -2.64\t1.57 1.37\t2.22 2.25\t5.24 5.08\t3.72 4.60\t4.12 3.46\nDVS\tP\t162.0\t\u2014\t-2.50\t\t2.26\t\u2014\t3.20\t\u2014\nDVS\tP+D\t158.4\t\u2014\t-2.65\t\u2014\t2.19\t\u2014\t4.54\t\u2014\nMVAM\tP\t163.0\t<0.01\t-2.45\t<0.01\t2.23\t0.01\t3.47\t0.01\nMVAM\tP+D\t162.5\t0.09\t-2.47\t0.23\t2.24\t0.72\t3.64\t0.03\nMVA\tP\t163.0\t0.01\t-2.45\t0.01\t2.23\t0.06\t3.47\t0.04\nMVA\tP+D\t163.0\t0.01\t-2.45\t0.01\t2.23\t0.05\t3.47\t0.04\n(3)\tP\t163.0\t<0.01\t-2.45\t<0.01\t2.23\t0.01\t3.47\t0.01\n(3)\tP+D\t163.0\t<0.01\t-2.45\t0.01\t2.23\t0.03\t3.47\t0.03\nNM\tP\t152.1\t\u2014\t-2.86\t\u2014\t2.10\t\u2014\t9.18\t\u2014\nNM\tP+D\t151.0\t\u2014\t-2.87\t\u2014\t2.18\t\u2014\t9.06\t\u2014\n(1)\t- 10 3 bbl/psi\tEstimativas Iniciais:\n(2) - 10\u201c5\tk = 100. mD\n(3) - MVAM-MVA\tS = 1.0\nP - dados de press\u00e3o.\tC = 0.01 bbl/psi\nD - dados da derivada.\t\u00c0 = K<5\nP+D - dados de press\u00e3o e da derivada.\to? = 0.05\nM\u00e9todo\tDados\t\t\tMQR ( ps'12 /ponto)\tMRA ( psi /ponto)\tItera\u00e7\u00f5es\n\t\t\t+/- %\t\t\t\nMQ\tP\t0,189\t4.30\t10.814\t1.718\t10\nMQ\tP+D\t0.164\t3.97\t34.098\t3.765\t09\nDVS\tP\t0.210\t\u2014\t11.4041\t1.803\t11\nDVS\tP+D\t0.1.64\t\u2014\t34,024\t3.733\t19\nMVAM\tP\t0.210\t0.01\t11.537\t1.242\t13\nMVAM\tP+D\t0.210\t0.53\t35.407\t3.450\t09\nMVA\tP\t0.210\t0.04\t11.537\t1.243\t13\nMVA\tP+D\t0.210\t0.04\t35.550\t3.405\t13\n(1)\tP\t0.210\t0.01\t11.537\t1.242\t12\n(i!\tP+D\t0.210\t0.03\t35.550\t3.405\t13\nNM\tP\t0.132\t\u2014\t15.760\t2.960\t345\nNM\tP+D\t0.123\t\u2014\t14.937*\t1.837*\t255\n(1) - MVAM- MVA\nMQR - m\u00e9dia dos quadrados dos res\u00edduos. MRA - m\u00e9dia dos res\u00edduos absolutos.\n* - fun\u00e7\u00e3o objetivo modificada.\n.102\n(1)\tM\u00e9todo\tN.Iter e Tipo de Dados\t\t(1)\tM\u00e9todo\tN.Iter e Tipo de Dados\t\n\t\tP\tP+D\t\t\tP\tP+D\nA\tMQ\t12\t27\tB\tMQ\t14\t22*\n\tMVAM\t15\t17\t\tMVAM\t22\t14*\n\tMVA\t37\t16\t\tMVA\t(2)\t(2)\n\t(3)\t14\t21\t\t(3)\t18\t17*\n\tDVS\t20\t(2)\t\tDVS\t25\t(2)\n\tNM\t576\t292\t\tNM\t(2)\t155\nC\tMQ\t(2)\t(2)\tD\tMQ\t13*\t16*\n\tMVAM\t(2)\t31*\t\tMVAM\t17\t20*\n\tMV\u00c2\t(2)\t(2)\t\tMVA\t.1.1\t11\n\t(3)\t(2)\t27\t\t(3)\t12\t21\n\tDVS\t(2)\t18\t\tDVS\t(2)\t(2)\n\tNM\t528\t198\t\tNM\t(2)\t(2)\nE\tMQ\t09*\t14*\tF\tMQ\t(2)\t(2)\n\tMVAM\t11*\t15*\t\tMVAM\t(2)\t28*\n\tMVA\t15\t14\t\tMVA\t(2)\t(2)\n\t(3)\t11\t12\t\t(3)\t(2)\t26\n\tDVS\t19*\t14*\t\tDVS\t32*\t13*\n\tNM\t(2)\t356\t\tNM\t(2)\t(2) \u25a0\nG\tMQ\t12*\t16*\tH\tMQ\t16*\t14*\n\tMVAM\t31*\t20*\t\tMVAM\t15\t19*\n\tMVA\t11\t11\t\tMVA\t14\t15\n\t(3)\t17*\t22\t\t(3)\t15\t18\n\tDVS\t20*\t15*\t\tDVS\t12\t19*\n\tNM\t(2)\t(2)\t\tNM\t(2)\t(2)\n(1)\t- estimativa iniciaL\n(2)\t- n\u00e3o convergiu.\n(3)\t- MVAM-MVA\n(*) - falha alg. proc. linear.\nTabela 5.28: Resultados dos V\u00e1rios M\u00e9todos de Regress\u00e3o. Caso 6 . Estimativas iniciais na tabela 5.23.\nA seguir foi examinado o comportamento dos m\u00e9todos frente a uni caso real de dupla porosidade. Este caso foi obtido da refer\u00eancia [32], Trata-se de um per\u00edodo de est\u00e1tica ap\u00f3s um fluxo de 23.55 horas. Novamente foi utilizado o tempo equivalente de Agarwal para analisar os dados. Nas tabelas 5.29 e 5.30 est\u00e3o tabulados os dados de reservat\u00f3rio e os de press\u00e3o versus tempo, respectivamente.\nE interessante notar que neste caso existiu converg\u00eancia para mais de um m\u00ednimo, existindo dois m\u00ednimos quando foi efetuada regress\u00e3o somente nos dados de press\u00e3o, tanto para a norma LI como para a norma L2. J\u00e1 para a regress\u00e3o efetuada no conjunto de dados de press\u00e3o mais derivada, a norma LI apresentou apenas 2 m\u00ednimos e a norma L2 quatro. Os valores para os quais cada tentativa convergiu podem ser observados na tabela 5.32, A seguir testamos a robustez dos m\u00e9todos aqui analisados (MQ, MVAM, MVA, MVAM-MVA, DVS e NM) frente \u00e0s estimativas iniciais mostradas na tabela 5.33. Os resultados desta an\u00e1lise est\u00e3o mostrados na tabela 5.34. Atrav\u00e9s desta tabela, pode-se concluir que a dificuldade encontrada pela maioria dos m\u00e9todos em convergir deve-se em parte a dois fatores: um tempo de est\u00e1tica n\u00e3o longo o suficiente para se atingir o conportamento radial infinito (ou a segunda reta no semi-log) e provavelmente uma correla\u00e7\u00e3o imperfeita entre os dados e o modelo de reservat\u00f3rio admitido (Warren e Root, pois quando se optou pelo modelo transiente n\u00e3o houve converg\u00eancia). Outro fato interessante \u00e9 que existiu uma estimativa inicial (E) na qual s\u00f3 houve converg\u00eancia para o m\u00e9todo MVAM-MVA aplicado aos dados de press\u00e3o. Este fato a princ\u00edpio pode parecer estranho, pois o MVAM n\u00e3o convergiu quando aplicado aos dados de press\u00e3o e o m\u00e9todo combinado sim. No entanto, para se conseguir a converg\u00eancia, optou-se por deixar o programa trocar de m\u00e9todo (do MVAM para o MVA) mesmo que houvesse falha no algoritmo de procura linear durante o per\u00edodo em que se utilizou o MVAM, e foi o que aconteceu neste caso. Tamb\u00e9m deve-se ressaltar que o m\u00e9todo DVS s\u00f3 convergiu duas vezes e o NM s\u00f3 uma. Foram consideradas converg\u00eancias bem sucedidas somente os casos em que os m\u00e9todos convergiram para os pontos A1P, AIPD, A2P e A2PD (vide tabela 5.32),\nNas figuras 5.65 e 5.66 est\u00e3o mostrados os resultados das regress\u00f5es efetuadas sobre os dados de press\u00e3o com os m\u00e9todos baseados nas norma L1 e L2 comparados aos dados de campo, enquanto que nas figuras 5.67 e 5.68 est\u00e3o os resultados dos mesmos m\u00e9todos quando aplicados ao conjunto de dados de press\u00e3o mais derivada.\n.104\nTempo de Produ\u00e7\u00e3o\t~ 23.55 horas\nVaz\u00e3o de leste\t=: 830.0 STB/d\nRaio do Po\u00e7o\t=; 0.290 p\u00e9s\nPorosidade\t=\u25a0\u25a0 0.050\nEspessura\t7.0 p\u00e9s\nViscosidade\t== 0.3000 cp\nCoinpressibilidade 'lotai\t= 20.0 x 10_\u00edi 1/ps\u00ed\nFator Volume de Forma\u00e7\u00e3o\t- 1.500 bbl/STB\nTabela 5.29: Dados de reservat\u00f3rio para o caso 7.\nTempo\tQueda de\tTempo\tQueda de\tTempo\tQueda de\nde Teste\tPress\u00e3o\tde Teste\tPress\u00e3o\tde Teste\tPress\u00e3o\n(horas)\t(psi)\t(horas)\t(psi)\t(horas)\t(psi)\n.000621\t.970000\t.019874\t30.500000\t.069570\t5'1.420\n.001247\t2,740000\t.021115\t31.410000\t.072667\t52.130\n.001862\t4.650000\t.021741\t31.920000\t.075775\t52.920\n.002488\t6.410000\t.022356\t32.330000\t.078884\t53.330\n.003103\t7.930000\t.022982\t33.000000\t.081992\t54.010\n.003729\t9.970000\t.024223\t33.740000\t.085100\t54.530\n.004344\t11.290000\t.025464\t34.620000\t.088823\t55.080\n.004970\t12.530000\t.026705\t35.370000\t.091305\t55.490\n.005585\t13.680000\t.027946\t36.170000\t.094413\t56.010\n.006211\t14.720000\t.029198\t36.990000\t.097521\t56.550\n.006837\t15.620000\t.030439\t37.580000\t.100618\t56.850\n.007452\t16.400000\t.031680\t38.400000\t.103726\t57.340\n.008078\t17.320000\t.032921\t38.970000\t.106834\t57.740\n.008693\t18.190000\t.034162\t39.680000\t.111798\t58.480\n.009319\t18.930000\t.035403\t40.150000\t.116148\t58.890\n.009934\t19.820000\t.036644\t40.880000\t.120810\t59.520\n.010561\t20.590000\t.037885\t41.430000\t.125472\t59.840\n.011175\t21.370000\t.039126\t41.900000\t.130437\t60.450\n.011802\t22.120000\t.040378\t42.490000\t.134786\t60.900\n.012428\t22.950000\t.041619\t43.000000\t.139750\t61.260\n.013043\t23.690000\t.043475\t43,750000\t.144099\t61.650\n.013669\t24.540000\t.045342\t44.490000\t.153423\t62.380\n.014284\t25.080000\t.047210\t45.040000\t.162737\t63.080\n.014910\t25.800000\t.049066\t45.880000\t.173291\t63.870\n.015525\t26.420000\t.050933\t46.320000\t.181374\t64.460\n.016151\t26.980000\t.053415\t47.310000\t.190687\t64.930\n.016766\t27.570000\t.055897\t48.000000\t.200001\t65.360\n.017392\t28.120000\t.059005\t48.970000\t.209325\t65.780\n.018018\t28.730000\t.061487\t49.750000\t.218638\t66.200\n.018633 .019259\t29.360000 29.790000\t.063980 .066462\t50.110000 50.750000\t.227951\t66.640\nTempo\tQueda de\tTempo\tQueda de\tTempo\tQueda de\nde Teste\tPress\u00e3o\tde Teste\tPress\u00e3o\tde Teste\tPress\u00e3o\n(horas)\t(psi)\t(horas)\t(psi)\t(horas)\t(psi)\n.237276\t67.04\t.908096\t\t5.305700\t81.80\n.246589\t67.40\t.945360\t75.61\t5.585210\t81.81\n.255902\t67.71\t.982624\t75.92\t5.864710\t82.12\n.265227\t68.00\t1.019900\t75.98\t6.144220\t82.24\n.274540\t68.35\t1.057160\t75.78\t6.423730\t82.49\n.293178\t68.91\t1.113070\t76.22\t6.703240\t82.63\n.311804\t69.13\t1.168970\t76.58\t6.982750\t82.82\n.330442\t69.70\t1.224870\t76,81\t7.262260\t83.04\n.349079\t70.10\t1.280780\t76.65\t7.541770\t83.17\n.358393\t70.40\t1.336680\t76.98\t7.914410\t83.38\n.367706\t70.53\t1.392580\t77.16\t8.287160\t83.70\n.386343\t70.95\t1.485740\t77.25\t8.659800\t83.70\n.404981\t71.35\t1.578920\t77.95\t9.032440\t83.87\n.423607\t71.59\t1.672090\t77.77\t9.405190\t84.09\n.442245\t71.94\t1.765250\t78.14\t9.777830\t84.39\n.460883\t72.21\t1.858430\t78.21\t10.150500\t84.44\n.479509\t72.42\t1.951600\t78.39\t10.523200\t84.76\n.498147\t72.32\t2.137940\t78.66\t10.895900\t84.80\n.516784\t72.47\t2.324270\t78.93\t11.454900\t85.18\n.535411\t72.73\t2.510610\t79.23\t12.013900\t85.32\n.554048\t72.92\t2.696960\t79.55\t12.573000\t85.59\n.572686\t73.21\t2.883290\t79.63\t13.132000\t85.78\n.609950\t73.70\t3.069630\t79.82\t13.691000\t86.10\n.647214\t73.75\t3.349140\t80.19\t14.250000\t86.20\n.684489\t73.81\t3.628650\t80.37\t14.809000\t86.55\n.721754\t74.39\t3.908150\t80.37\t15.368000\t86.46\n.759018\t74.76\t4.187660\t80.79\t15.927100\t86.72\n.796293\t75.05\t4.467170\t81.09\t16.486100\t86.79\n.833557\t75.32\t4.746680\t81.23\t17.045100\t87.17\n.870821\t75.11\t5.026190\t81.46\t17.605900\t87.23\nFigura. 5.66: Press\u00e3o e Derivada de Press\u00e3o versus Tempo em escala semi-log, para regress\u00e3o nos dados de press\u00e3o. Caso 7.\nFigura 5.67: Press\u00e3o e Derivada de Press\u00e3o versus Tempo em escala log log, para regress\u00e3o nos dados de press\u00e3o e da derivada. Caso 7.\nFigura 5.68: Press\u00e3o e Derivada de Press\u00e3o versus \u2019Jeinpo em escala semrlog, para regress\u00e3o no conjunto de dados de press\u00e3o e da derivada. Caso 7.\nPonto\tk (mO)\tS\tc (bbl/psi)\t\u00c0 10~5\t\tMQR (psi2 / ponto)\tMRA (psz \u00a1ponto)\nA1P\t361.9\t-5.200\t0.0161\t74.06\t0.0658\t0.140\t0.283\nB1P\t837.2\t-0.127\t0.0240\t3.010\t0.0210\t2.300\t1.267\nAIPD\t403.9\t-4.848\t0.0173\t26.69\t0.0738\t0.605\t0.573\nB1PD\t795.8\t-0.555\t0.0243\t7.889\t0.0083\t3.139\t1.461\nA2P\t379.2\t-5.050\t0.0164\t49.80\t0.0711\t0.130\t0.294\nB2P\t771.0\t-0.731\t0.0231\t13.56\t0.0546\t2.118\t1.322\nA2PD\t397.7\t-4.920\t0.0171\t30.73\t0.0719\t0.592\t0.578\nB2PD\t504.0\t-3.742\t0.0197\t2.785\t0.1590\t0.941\t0.766\nC2PD\t542.7\t-3.320\t0.0205\t0.739\t0.1630\t2.452\t1.390\nD2PD\t743.3\t-0.990\t0.0235\t18.36\t0.0379\t2.938\t1.495\n\t\t\tintervalos de Confian\u00e7a\t\t\t\t\nPonto\tk (+/-\t%) S (+/- %) C (+/- 9\t\t\t\t\t(+/- %)\nA1P\t0.08\t\t0.05\t0.08\t0.16\t\t0.21\nB1P\t0.08\t\t5.49\t0.36\t25\t.32\t23.61\nAIPD\t0.1.1\t\t0.10\t0.11\t0.18\t\t0.28\nB1PD\t0.09\t\t1.32\t0.17\t8.92\t\t9.02\nA2P\t0.23\t\t0.18\t0.23\t0.36\t\t0.61\nB2P\t0.26\t\t2.66\t0.80\t61.13\t\t24.61\n\u00c02PD\t0.17\t\t0.15\t0.18\t0.33\t\t0.54\nB2PD\t0.20\t\t0.30\t0.15\t0.56\t\t0.75\nC2PD\t0.20\t\t0.30\t0.15\t0.79\t\t0.81\nD2PD\t0.16\t\t1.11\t0.29\t13.96\t\t8.96\n1\t- norma LI\n2\t- norma L2\nP - dados de press\u00e3o.\nP.D - dados de press\u00e3o e da derivada.\nTabela 5.32: Pontos de m\u00ednimos locais e m\u00ednimo absoluto para os dados do caso 7 quando submetidos \u00e0s normas Ll. e L2,\nEstim. Inicial\tk (mD)\ts\tC (bbi/ps\u00ed)\t\u00c0\tu?\nA\t100.\t1.\t0.001\tl*10\u201c6\t0.01\nB\t100.\t.15.\t0.10\ti*w~6\t0.01\nC\t100.\t1.\t0.01\trio-6\t0.01\nD\t100.\t1.\t0.01\tl*10~4\t0.01\nE\t100.\t1.\t0.01\tl*10\u201cr\t0.25\nF\t250.\t1.\t0.01\trio-3\t0.50\nG\t10.\t1.\t0.02\tl*10~6\t0.05\nH\t1.\t1.\t0.005\t5*10~6\t0.10\nI\t250.\t-5.\t0.015\ti*l(T4\t0.10\nJ\t100.\t*5.\t0.01\tpiQ-5\t0.50\nK\t100.\t1.\t0.01\trio~6\t0.01\nTabela 5.33: Estimativas Iniciais Utilizadas para V\u00e1rios M\u00e9todos de Regress\u00e3o para os dados do caso 7.\n(1)\tM\u00e9todo\tN.Iter e T\u00edpo de Dados\t\t(1)\tM\u00e9todo\tN.Iter e 'Pipo de Dados\t\n\t\tP\tP+D\t\t\tP\tP+D\nA\tMQ\t\t08\tB\tMQ\t**\t\n\tMVAM\t22\t12\t\tMVAM\t07\t\n\tMVA\t**\t**\t\tMVA\t\t**\n\t(2)\t16\t13\t\t(2)\t15\t\n\tDVS\t\t\t\tDVS\t\u2022\u00a5*\t\n\tNM\t\t**\t\tNM\t:$csj;\t\nC\tMQ\t13\t13\tD\tMQ\t\t\n\tMVAM\t12.\t17\t\tMVAM\t17\t\n\tMVA\t\t\t\tMVA\t\t\n\t(2)\t15\t15\t\t(2)\t.1.2\t\u2022\u00bfX\n\tDVS\t\t\t\tDVS\t3*; x\tX \u00a3\n\tNM\tijc^\u00ed\t?k;k\t\tNM\t\t\u00edjtX\nE\tMQ\tjfciiC\tjfc jff\tF\tMQ\t15\tX x\n\tMVAM\t\tx &amp;\t\tMVAM\t09\t\n\tMVA\t* \u00ab\t\t\tMVA\t\u00edfcji\u00e7\t\n\t(2)\t22\tjics\u00eds\t\t(2)\t\t\n\tDVS\t\tip\u00edfc\t\tDVS\t\t**\n\tx\\TM\t**\tiff^\u00ed\t\tNM\t\tA:\nG\tMQ\t\t24\tH\tMQ\t18\t\n\tMVAM\t19\t15\t\tMVAM\t\t20\n\tMVA\t**\t\t\tMVA\tJ\u00e0t\t\u00ed\u00e1\u00ed*\n\t(2)\t12\t15\t\t(2)\t19\t**\n\tDVS\t**\t\t\tDVS\t\t\n\tNM\t\t\u25a0* *\t\tNM\tjit X\t\nI\tMQ\t08\t07\tJ\tMQ\t* Ti\u00ed\t\n\tMVAM\t16\t12\t\tMVAM\t05\t07\n\tMVA\t\t**\t\tMVA\t**\t10\n\t(2)\t09\t12\t\t(2)\t05\t13\n\tDVS\t18\t\t\tDVS\t14\tX X\n\tNM\t258\ta&lt;4<\t\tNM\tX ;\u25a0<\t**\nK\tMQ\tSc\t07\t\t\t\t\n\tMVAM\t06\t16\t\t\t\t\n\tMVA\tifCJSC\t24\t\t\t\t\n\t(2)\t12\t15\t\t\t\t\n\tDVS\t\t\t\t\t\t\n\tNM\t\t\t\t\t\t\n(1)\t- estimativa inicial.\n(2)\t- MVAM-MVA (**) - n\u00e3o convergiu.\nTabela 5.34: Resultados dos V\u00e1rios M\u00e9todos de Regress\u00e3o. Caso 7 . Estimativas iniciais na tabela 5.33 .\n6\tCONCLUS\u00d5ES e RECOMENDA\u00c7\u00d5ES.\n1.\tOs m\u00e9todos de regress\u00e3o n\u00e3o linear permitem obter os par\u00e2metros da forma\u00e7\u00e3o atrav\u00e9s da an\u00e1lise de testes de press\u00e3o em po\u00e7os de petr\u00f3leo em casos onde a an\u00e1lise convencional n\u00e3o obt\u00e9m bons resultados.\n2.\tOs m\u00e9todos baseados na norma LI se mostraram capazes de definir subconjuntos de pontos onde o modelo f\u00edsico-matem\u00e1tico n\u00e3o se aplica ou se aplica parcialmente, atribuindo menor peso a estas regi\u00f5es e/ou pontos durante a estimativa dos par\u00e2metros,\n3.\tA an\u00e1lise estat\u00edstica dos resultados demonstrou que os m\u00e9todos baseados na norma Li obt\u00e9m menores intervalos de confian\u00e7a quando comparados com os resultados obtidos pelos m\u00e9todos baseados na norma L2.\n4.\tA utiliza\u00e7\u00e3o da fun\u00e7\u00e3o penalidade proposta neste trabalho, quando poss\u00edvel, evitou, para algumas estimativas iniciais, problemas com diverg\u00eancia,\n5.\tA mudan\u00e7a no dom\u00ednio dos par\u00e2metros proposta neste trabalho s\u00f3 trouxe melhores resultados no caso do m\u00e9todo de Nelder-Mead, onde se mostrou imprescind\u00edvel para os par\u00e2metros k (permeabilidade), C (coeficiente de estocagem) e A (coeficiente de fluxo interporoso), por\u00e9m para os outros dois par\u00e2metros, S (fator de pel\u00edcula) e \u00faj (raz\u00e3o de armazenamento), n\u00e3o se mostrou eficaz,\n6.\tDentre os m\u00e9todos analisados, o m\u00e9todo de m\u00ednimos valores absolutos modificado (MVAM) e o m\u00e9todo combinado (MVAM-MVA) mostraram-se mais robustos em rela\u00e7\u00e3o ao n\u00famero de itera\u00e7\u00f5es e principalmente quanto \u00e0 converg\u00eancia a partir de estimativas iniciais pobres,\n7.\t0 m\u00e9todo de decomposi\u00e7\u00e3o em valores singulares, apesar de ser recomendado na literatura para minimiza\u00e7\u00e3o da norma L2 em problemas mal condicionados, n\u00e3o se mostrou eficiente,\n8.\t0 m\u00e9todo de Nelder-Mead. devido \u00e0 sua f\u00e1cil implementa\u00e7\u00e3o, seria recomend\u00e1vel para problemas em que a fun\u00e7\u00e3o objetivo fosse complexa e/ou n\u00e3o apresentasse derivadas anal\u00edticas, por\u00e9m necessita de um estudo mais aprofundado para acelerar a sua converg\u00eancia.\n9.\tA aplica\u00e7\u00e3o da regress\u00e3o n\u00e3o linear sobre o conjunto de dados de press\u00e3o mais derivada garante maior robustez aos m\u00e9todos, principalmente quando j\u00e1 existe algum ru\u00eddo nos dados de press\u00e3o.\n10.\tO uso de somente os dados da derivada numa regress\u00e3o n\u00e3o produz bons resultados,\n11.\tO uso da curva da derivada, apesar de fornecer resultados piores que aqueles fornecidos pela curva de press\u00e3o ou pelo conjunto de press\u00e3o mais derivada, apresenta melhor performance no que diz respeito \u00e0 robustez frente a estimativas iniciais ruins,\n12.\tNo caso de modelo de reservat\u00f3rio de dupla porosidade, o problema se mostrou mal condicionado causando dificuldades de converg\u00eancia. Quando foi analisado urn caso real, foram encontrados mais de um m\u00ednimo na superf\u00edcie analisada (tanto na norma LI como na L2). Esta dificuldade de converg\u00eancia pode ser explicada pela influ\u00eancia de alguns par\u00e2metros somente na transi\u00e7\u00e3o entre as duas retas semi-log.\n13.\t0 modelo de dupla porosidade mostrou-se pouco sens\u00edvel ao par\u00e2metro de coeficiente de fluxo interporoso (A).\n14.\tSugere-se o estudo de novas fun\u00e7\u00f5es para mudan\u00e7a de dom\u00ednio, com o objetivo de restringir a otimiza\u00e7\u00e3o a regi\u00f5es onde os par\u00e2metros apresentem significado fisicomatem\u00e1tico. Estas novas fun\u00e7\u00f5es teriam aplicabilidade imediata aos m\u00e9todos de decomposi\u00e7\u00e3o em valores singulares (DVS), de m\u00ednimos valores absolutos (MVA) e de Nelder-Mead (NM).\nNOMENCLATURA\nB \u2014 fator volume de forma\u00e7\u00e3o, RB/STB (m3/m3std).\nc = compressibilidade. psi~A (PaM).\nC ~ coeficiente de estocagem, bbl/psi (m3/Pa).\nD = matriz diagonal.\nDV S = decomposi\u00e7\u00e3o em valores singulares. \u00a31 = fun\u00e7\u00e3o objetivo para a norma Ll, psi (Pa).\nE? \u201c fun\u00e7\u00e3o objetivo para a norma L2, psi2 (Pa2).\nF = solu\u00e7\u00e3o anal\u00edtica da fun\u00e7\u00e3o analisada. h \u2014 altura do reservat\u00f3rio, p\u00e9s (m).\nH ~ matriz Hessiana.\nKq \u2014 fun\u00e7\u00e3o de Bessel modificada de ordem zero.\n\u00c2'i = fun\u00e7\u00e3o de Bessel modificada de ordem um. k permeabilidade absoluta, mD (m2).\nMQ = m\u00ednimos quadrados.\nMQll = m\u00e9dia dos quadrados dos res\u00edduos, psi2/ponto (Pa2/ponto).\nMV A ----- m\u00ednimos valores absolutos.\nMV AM \u2014 m\u00ednimos valores absolutos modificado.\nA\u00ed RA ~ m\u00e9dia dos res\u00edduos abolutos, psi \u00a1ponto (Pa/ponto), n = fun\u00e7\u00e3o densidade.\nNM = Nelder Mead.\nnpar = n\u00famero de par\u00e2metros. npon = n\u00famero de pontos.\np = press\u00e3o, psi (Pa),\nq = vaz\u00e3o nas condi\u00e7\u00f5es de superf\u00edcie, ST B/d (m3/s).\nr = dist\u00e2ncia radial, p\u00e9s (m).\nS\t~ fator de pel\u00edcula, adiniensional.\nt = tempo, horas (5).\nu = vari\u00e1vel no espa\u00e7o de Laplace.\nV = volume, ft3 (m3).\nx = vari\u00e1vel gen\u00e9rica, exemplo t y \u2014 vari\u00e1vel dependente gen\u00e9rica , exemplo p\nLetras gregas\na = vetor de par\u00e2metros a serem determinados.\n= diferen\u00e7a entre os par\u00e2metros das itera\u00e7\u00f5es n e n+1.\nA = coeficiente de fiuxo interporoso, adimensional, p \u2014 viscosidade , cp (Pa.s).\np = m\u00e9dia.\nu; = par\u00e2metro de armazenamento, adimensional.\n<p \u2014 porosidade, fra\u00e7\u00e3o (fra\u00e7\u00e3o).\np \u2014 par\u00e2metro de relaxa\u00e7\u00e3o, adimensional.\n<r = desvio padr\u00e3o.\nSubscritos\nD = adimensional.\neq = equivalente.\nf ~ fluxo.\nfr = fratura.\n\u00ed = inicial.\nL-M \u2014 Levenberg-Marquardt. m = matriz.\nmod. = modificado.\np = produ\u00e7\u00e3o, t total.\nw \u2014 po\u00e7o.\n0 = inicial.\nSobreescritos\n0 = inicial.\nTransforma\u00e7\u00f5es de Unidades bbl / d\u00ed a \u2014 0.159\tm3/ di a\npsi = 1.395 * 108 Pa pe = 0.3048 m\nmD = 0.897 * 10\u201d12 m2 cp \u2014 IO\u201d3 Pa. 3 bblfpsi = 1.211 * 10\"9 m?/Pa pol = 0.0254 m\nRefer\u00eancias\n[1]\tLevenberg, K.: A Method For The Solution Of Certain Problems In Least Squares\u201d, Quart. Appl. Math., 2 (1944), pp. 164-168.\n[2]\tMarquardt, D. W.: \u201dAn Algorithm For Least-Squares Estimation Of Nonlinear Parameters\u201d, J, Soc. Indust, Appl. Math., Vol. 11, n.2, June, 1963,\n[3]\tJanhs. H. 0.: \"A Rapid Method For Obtaining A Two-Dimensional Reservoir Description From Well Pressure Response Data.\u201d . Soc. Pet. Eng. J. (December 1966), 315-327,\n[4]\tCoats, K. H., Dempsey, J. R. e Henderson, J. FL: \u201dA New Technique For Determining Reservoir Description From Field Performance Data,\u2019', Soc. Pet. Eng. J. (March\n1970)\t, 66-74.\n[5]\tThomas, L. K., Heliums. L. J. e Rebels, G. M.: \u201dA Nonlinear Automatic History Matching Technique For Reservoir Simulation Models.\u201d, Soc. Pet. Eng. J, (October\n1971)\t, 508-514.\n[6]\tEarlougher, R, C. Jr, Kersch, K. M.: \u2019\u2019 Field Examples Of Automatic Transient Test Analysis.\u201d, J. Pet. Tech. (October 1972) 1271-1277.\n[7]\tHernandez, V. M. e Swift, G. W.: \u201d A Method For Determining Reservoir Parameters From Early Drawdown Data.11, paper SPE 3982, 47iJ1 Annual Fall Meeting of the Society of Petroleum Engineers of AIME, San Antonio, Texas, October 8-11 1972.\n[8]\tRodgers, J. S., Coble, L. E., Boykin, R. S. e Mokha, J. S.: \u2019\u2019Nonlinear Well Test Analysis Reveals Reservoir Boundary Shape.\u201d, TECHNOLOGY, Oil and Gas Journal (September 14, 1981) 63-68.\n[9]\tRosa, A. J. e Horne, R, N.: \u2019\u2019Automated Type-Curve Matching In Well Test Analysis Using Laplace Space Determination Of Parameter Gradients.\u201d, paper SPE 12131, \u25a058i\u00e0 Annual Technical Conference of the Society of Petroleum Engineers of AIME, San Francisco, California, October 5-8, 1983.\n[10]\tBarua, J., Kucuk, F. e Gomez-Angulo, J.: \u2019\u2019Application Of Computers In The Analysis Of Well Tests From Fractured Reservoirs.\u201d, paper SPE 13662, California Regional Meeting. Bakerfield, California, March 27-29, 1985.\n[11]\tBarua, J.. Horne, R. N., Greenstadt, J. L. e Lopez, L.t \u2019\u2019Improved Estimation Algorithms For Automated Type-Curve Analysis Of Well Tests.\u201d, paper SPE 1.4225, Annual Technical Conference of the Society of Petroleum Engineers of AIME, Las Vegas, Nevada, September 22-25, 1985.\n[12]\tNamba, T. e Horne, R, N.: \u201dAn Improved Regression Algorithm For Automated Well Test Analysis?1, paper SPE 18161, 63iil Annual Technical Conference of the Society of Petroleum Engineers of AIME. Houston, Texas, October 2-5, 1988.\n[13]\tGill, P. E, e Murray, W,: \u201d Newton-Type Methods For Unconstrained And Linearly Constrained Optimization,\u201d, Mathematical Programming, (1974) vol.7, 311-350.\n[14]\tRosa, A. J, e Horne, R. N.: \u2019\u2019Automated Well Test Analysis Using Robust (LAV) Nonlinear Parameter Estimation?, paper SPE 22679, 66ih Annual Technical Conference of the Society of Petroleum Engineers of AIME, Dallas, Texas, October 6-9, 1991,\n[15]\tCoelho, A, C. D,: \u2019\u2019An\u00e1lise De Testes Em Reservat\u00f3rios Com Varia\u00e7\u00e3o Vertical De Permeabilidade\u201d, Tese de Mestrado - UNICAMP - Departamento de Engenharia de Petr\u00f3leo, Campinas, S\u00e3o Paulo, Novembro - 1991,\n16] Greenstadt, J, L.: \u201dOn The Relative Efficiences Of Gradient Methods?1, Mathematics Of Computation, 21, 360-367, 1967\n[17]\tCarvalho, R.S.; Redner, R.A.; Thompson, L.G, e Reynolds, A.C.: \u2019\u2019Robust Procedures For Parameter Estimation By Automated Type-Curve Matching?\u2019, paper SPE 24732, 67t\u00f3 Annual Technical Conference of the Society of Petroleum Engineers of AIME, Washington, DC, October 4-7, 1992.\n[18]\tAgarwal, R, G., Al-Hussainy e R,, Ramey, H, J. Jr.: \u201dAn Investigation Of Wellbore Storage And Shin Effect In Unsteady Liquid Flow: L Analytical Treatment?\u2019, Soc, Pet, Eng, J, (September 1970) 279-290.\n[19]\tWarren, J. E. e Root, P, J.: \u2019\u2019Behavior Of Naturally Fractured Reservoirs?\u2019, Soc, Pet, Eng. J. (September 1963) 245-255.\n[20]\tDe Swaan, A. 0.: \u2019\u2019Analytic Solutions For Determining Naturally Fractured Reservoir Properties By Well Testing?1, paper SPE 5346, 45ifl Annual California Regional Meeting of the Society of Petroleum Engineers of AIME, Ventura, California, April 2-4, 1975.\n[21]\tPress, W. H., Flannery, B, P., Teukolsky, S. A. e Vetteding, W, T.: \u2019\u2019Numerical Recipes?\u2019, Cambridge University Press, Cambridge, 1988.\n[22]\tRosa, A, J.: \u2019\u2019Automated Type Curve Matching In Well Test Analysis?\u2019, Tese de Mestrado - Stanford University, Stanford, California, Mar\u00e7o - 1983.\n[23]\tEl-Attar, R.A., Vidyasagar, M. e Dutta, S.R.K.: \u201d An Algorithm for Ll-Norm Minimization With Application To Nonlinear Ll Approximation.\u201d, SIAM J. Num, Anal, (February 1979), 16, N, 1, 70-86,\n[24]\tSchlossmacher, E. J.: \u2019\u2019An. Iterative Technique For Absolute Deviations Curve Fitting.\u201d, Journal of the American Statistical Association, December 1973, Volume 68, Number 344.\n[25]\tMathews, J.N.: \u2019\u2019Numerical Methods For Mathematics, Science And Engineering.\u201d; Prentice-Hall International, Inc.; New Jersey; 1992.\n[26]\tHartley, H.O.: \u2019\u2019Exact Confidence Regions For The Parameters In Nonlinear Regressions Laws.\u201d, Biometrica (1964), vol. 51, 347.\n[27]\tDogru, A.N., Dixon, T.N. e Edgar, T.F.; \u2019\u2019Confidence Limits On The Parameters And Predictions Of Slightly Compressible, Single-Phase Reservoirs.\u201d, Soc. Pet. Eng. J. (February 1977), 42-56.\n[28]\tStehfest, H.: \u2019\u2019Numerical Inversion Of Laplace Transforms. \u201d, Communications Of The A.CM. (January 1970), 13, N.I, Algorithm 368.\n[29]\tBourgeouis, M.J. e Horne, R.N.: \u2019\u2019Well Test Model Recognition Using Laplace Space.\u201d, paper SPE 22682, 66iA Annual Technical Conference of the Society of Petroleum Engineers of A IVIE, Dallas, Texas, October 6-9, 1991.\n[30]\tRamey Jr, H.J.: \u2019\u2019Advances In Practical Well-Test Analysis\u201d, JPT (June 1992).\n[31]\tRosa, A. J.: \u2019\u2019Reservoir Description By Well Test Analysis Using Cyclic Flow Rate Variation.\u201d, Tese de Doutorado - Stanford University, Stanford, California, September - 1991.\n[32]\tBourdet, D., Ayoub, J.A., Whitle, T.M., Pirard, Y.M. e Kniazeff, V.: \u2019\u2019Interpreting Well Tests In Fractured Reservoirs.\u201d, World Oil, Oct. 1983 (77-87).\n[33]\tBourdet, D., Ayoub, J.A. e Pirard, Y.M.: \u2019\u2019Use Of Pressure Derivative In Well Test Interpretation.\u201d, SPEFE (Jun 1989).\nA ALGORITMO DE PROCURA LINEAR.\nNeste ap\u00e9ndice ser\u00e1 apresentado o algoritmo de procura linear utilizado neste trabalho.\nAtrav\u00e9s des te algoritmo evita-se que os m\u00e9todos caminhem atrav\u00e9s de regi\u00f5es onde os par\u00e2metros de regress\u00e3o n\u00e3o tem significado f\u00edsico-matem\u00e1tico ou que os novos pontos determinados a cada itera\u00e7\u00e3o tenham res\u00edduos maiores que os dos pontos anteriores. Este algoritmo pode ser resumido como:\nm = 0\nA p = 0.5\u2122\ncq'+i = af + p * 8i (\u00ed ~ 1, npar}\nSe > limite^ ent\u00e3o (i \u2014 l,npar)\nm = m + 1\nSe m > 10 PARE\nva para A\nFim do Se\nCalcule Residuon+1\nSe Residuo\u2122'*1 > Residuo\u2122, ent\u00e3o\nm = m + 1\nSe m > 10 PARE\nva. para A\nFim do Se\nB DERIVADAS ANAL\u00cdTICAS DA QUEDA DE PRES S\u00c3O EM RELA\u00c7\u00c3O AOS PAR\u00c2METROS DE REGRESS\u00c3O PARA RESERVAT\u00d3RIO HOMOG\u00caNEO INFINITO.\nNeste ap\u00eandice est\u00e1 demonstrada a obten\u00e7\u00e3o anal\u00edtica das derivadas da queda de press\u00e3o em rela\u00e7\u00e3o aos tres par\u00e2metros de regress\u00e3o.\nA express\u00e3o para\t\u00e9 dada pela equa\u00e7\u00e3o 3.11.\nDefinindo:\nD =\t(B.I)\nc-2 = ^hjp.\t(B.2)\na =\t(8.3)\n3 = C2&amp;/27T\t(B.4)\nent\u00e3o:\n\n\nQsaVh\u00cdKifei y/u/k)\t\u00a1\n....  y\t\".r... i *\t...\nDefinindo:\nAUXV\nAUXi = KQ(c1^)+c1Syfi/kK.(c1^)\npodemos escrever:\n(B.5)\n(B.6)\n(B.7)\nApw/(\u00e3,u) ~\n(B.8)\nEnt\u00e3o a derivada em rela\u00e7\u00e3o a k \u00e9:\nonde:\ndXpwf _ qB AUX4.AUX2 ~ AUXlAUX^ dk ~ u\tAUXl,AUX3\n.aux2\nAUXz =\n(B.9)\n(B.10)\n(B.ll)\n(B.12)\nAs outras derivadas s\u00e3o:\ndXp^.f __ qBczka2 [A'i\u00edAy\u00fcj2\n~~dS~~ \" AUXs.AUXt\ndApwf qB dC \u201c A\u00ed/Xg\n(B.13)\n(B.14)\nC ESQUEMA DE OBTEN\u00c7\u00c3O NUM\u00c9RICA DA DERIVADA DA QUEDA DE PRESS\u00c3O PARA RESERVAT\u00d3RIO DE DUPLA POROSIDADE EM RELA\u00c7\u00c3O AOS PAR\u00c2METROS DE REGRESS\u00c3O.\nPara se obter as derivadas deste modelo, optou-se por um esquema num\u00e9rico devido \u00e0 complexidade da solu\u00e7\u00e3o anal\u00edtica. Este esquema pode ser descrito como:\nSe par\u00ed 0 ent\u00e3o\nSen\u00e3o\nFim do Se\nCalcule Fun(par + Aaq,! = 1,/jpar)\ndFuTi __ Fwi(par+&amp;Si\u2019)\u2014Fun(par)\nAm\n(i = 1. npar)\nD ESQUEMA DE OBTEN\u00c7\u00c3O NUM\u00c9RICA DA DERIVADA DA QUEDA DE PRESS\u00c3O EM RELA\u00c7\u00c3O AO LOGARITMO DO TEMPO.\nPara se obter a derivada logar\u00edtmica utilizou-se do procedimento apresentado na refer\u00eancia [33]. Este procedimento pode ser descrito como:\nFa\u00e7a i ~ 2 a npon ~ 1\nSe log(/i/ii) &lt;0,1 ent\u00e3o\nSen\u00e3o\nSe [Iog(tnpm/^) > 0.1] ent\u00e3o\nJ \u201c '\u00a3 4\" 1\nFa\u00e7a enqto [log(\u00edj/tj &lt;0.1]\nj \u201d j + 1\nFim do enqto\nAUX2 = ti\nAUXi = \u00c1pj -- Api\nj = i~l\nFa\u00e7a enqto [log(\u00edi/\u00edj) &lt;0.1] j = j ~ 1\nFim do enqto\nAUXx = ti-tj\nAU X3 \u2014 Api \u2014 Ap,\n\u2014\t(AUXt+AUXi)\n= ti * AUX\nSen\u00e3o\n\u00caAe. =\t* \u00e9? Ap,\n31n\u00ed 1 tnpon\u201d\u00a3i\nFim do Se\nFim do Se\nFim do fa\u00e7a\nExtrapole para i \u2014 1 e i \u2014 upon\nE LISTAGENS DE PROGRAMAS EM FORTRAN.\nC************************************ ******************** *************** C**** PROGRAMA PROGl.FOR\t*******\nC***i*i ******************************************************* **********\n\u00c7**** c**** c** **\n0**** c**** c****\nRegress\u00e3o nao linear cora minimos quadrados utilizando o ******* m\u00e9todo de Gauss para um modelo de reservat\u00f3rio radial ******* infinito\t*******\n******* *******\n*******\nc\nc\n10\n20\n100\n101\nc\nc\nc\n300\nIMPLICIT REAL*8 (A-H,O\u201cZ)\nPARAMETER (NPON-150,NPAR\u20143)\nCHARACTER*12 ARQUIVO\nDIMENSION TESP(NPON) ,TEST(NPON) , B (NPON,NPAR) , FUN(NPON) ,RES(2*NPON)\nDIMENSION A(NPAR,NPAR+1) ,DELTA(NPAR) , AS (NPAR, NPAR+1) ,PEN(NPAR) ,\n*\tDP(NPON),Bl(NPON,NPAR)\nCOMMON /STE/ V(50)\nDADOS DE RESERVAT\u00d3RIO - H(PES), VIS(CP), PHI(PURO), CT(PSI-l),\nQ(STB/D), BO(BBL/STB)\nWRITE(*,*) 'ENTRE COM O ARQUIVO DE DADOS'\nREAD(*,*) ARQUIVO\nopen(4,file-ARQUIVO,status-'unknown')\nopen(7,file='SAIMQ.DAT',status='unknown')\nopen(8,file='RESMQ,DAT',status^'unknown')\nopen(9,file='LIXO.DAT',status='unknown')\nREAD (4,10) RESH, RESVIS, RESPHI, RESCT, RESRW, RESQ, RESBO, TPROD FORMAT(T25,F10.5)\nREAD(4,20) NP\nFORMAT(T32,13)\nDO 100 1=1,NP\nREAD(4,*) TEST(I),TESP(I)\nCONTINUE\nIF(TPROD.NE.0.DO) THEN\nDO 101 I = 1,NP\nTEST(I) = TEST(I)*TPROD/(TEST(I)+TPROD)\nCONTINUE\nENDIF\nVARIAVEIS DE CONTROLE PARA O ALGORITMO DE STHEFEST COM 8 CTES\nM = 0\nN = 8\nCONSTANTE INICIAL PARA O ALGORITMO DE GAUSS-MARQUARDT\nRLAM = 0.1D0\nTRANSFORMA\u00c7\u00d5ES DE UNIDADE\nRESCT = RESCT*14.7D0\nRESQ = RESQ*RESBO*1.84D0\nRESRW = RESRW*2.54DO\nRESH = RESH*30.48D0\nDO 300 I = 1,NP\nTEST(I) = TEST(I)*3.6D3\nTESP(I) = TESP(I)/14.7D0\nCONTINUE\nWRITE(6,*) WRITE(6,*) WRITE{6,*) WRITE(6,*)\n'QUAL A FUNCAO A MINIMIZAR\n'1 - PRESS\u00c3O.'\n'2 - DERIVADA.'\n'3 - DERIVADA + PRESS\u00c3O.'\nREAD(5,*) IOPT\nCALL DPDT(TEST,TESP,NP,DP)\nWRITE(6,*)\n*\t'ENTRE COM OS VALORES INICIAIS DE K(D),\nREAD(5,*) OESTK,OESTS,OESTC\nS E C(CM3/ATM)\nf\n105\n110\n111\nWRITE(9,*)\nWRITE(9,*) 'ARQUIVO :ARQUIVO\nWRITE(9/*)\nWRITE(9/*) 'METODO DE MINIMOS QUADRADOS.'\nWRITE(9,*)\nWRITE(9,105) OESTK*1.D+3,OESTS,OESTC*4. 2784409E-7\nWRITE(8,105) OESTK*l.D+3,OESTS,OESTC*4.2784409E-7 FORMAT(3X,'ESTIMATIVAS INICIAIS'//\n*\tIX,'K\t=',F10.5/\n*\tIX,'S\t=',F10.5/\n*\tIX,'C\t=',E10.3)\nIF (OESTS,LT.0.DO) THEN\nRESRWE = RESRW*DEXP(-OESTS)\nSKIN = 0.D0\nELSE\nRESRWE = RESRW\nSKIN \u00bb OESTS\nENDIF\nSSROLD = 0.D0\nSAV = O.DO\nIF (IOPT.NE.3) THEN\nFII = 1.0D0\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tOESTK,SKIN,OESTC,TEST,N,M,NP,B,FUN,IOPT)\nDO 110 I = 1,NP\nIF (IOPT.EQ.1) THEN RES(I) = FUN(I) - TESP(I)\nELSE\nRES(I) = FUN(I) ~ DP(I)\nENDIF\nSSROLD = SSROLD + RES(I)*RES(I) AUX1 - DABS(RES(I))\nSAV - SAV + AUX1\nCONTINUE\nELSE\nFII - 2.ODO\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tOESTK,SKIN,OESTC,\n*\tTEST,N,M,NP,\n*\tB,FUN,1)\nDO 111 I \u00bb 1,NP\nRES(I) \u00ab FUN(I) - TESP(I)\nSSROLD = SSROLD + RES(I)*RES(I)\nAUX1 = DABS(RES(I))\nSAV = SAV + AUX1\nA\n\u2605\n*\nCONTINUE\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ, OESTK,SKIN,OESTC,\nTEST,N,M,NP,\nBl,FUN,2)\nDO 112 I = I,NP\nRES(I+NP) = FUN(I) - DP(I)\nSSROLD = SSROLD + RES(I+NP)*RES(I+NP)\nAUX1 = DABS(RES(I+NP))\nSAV = SAV + AUX1\n112\nCONTINUE\nENDIF\nSSROLD-- SSROLD/(FII*NP)\n410\n420\n430\n440\n500\n505\nC\nC\nC\nc\n510\n520\nC\n560\n570\n550\nITMAX = 51\nTOL = l.D-4\nTOLK = 1.D0\nTOLS = 1.D0\nTOLC = l\u00abD0\nITER - 0\nMM - 0\nDO WHILE((TOLK.GT.TOL.OR.TOLS.GT.TOL.OR.TOLC.GT.TOL).AND.ITER.LT.\n*\tITMAX.AND.MM.LT.10)\nITER = ITER + 1\nDO 420 I = 1,NPAR\nDO 410 J = 1,NPAR+1 A(I,J) \u00bb 0.D0\nCONTINUE\nCONTINUE\nDO 500 K \u00bb 1,NP\nDO 440 I = 1,NPAR\nDO 430 J = 1,NPAR\nA(I,J) = A(I,J) + B(K,I)*B(K,J)\nIF(IOPT.EQ.3) A(I,J) = A(I,J) + BI(K,I)*B1(K,J) CONTINUE\nA(I,NPAR+1) = A(I,NPAR+1) + RES(K)*B(K,I)\nIF (I0PT.EQ.3)\n*\tA(I,NPAR+1) = A(I,NPAR+1) + RES(K+NP)*B1(K,I) CONTINUE\nCONTINUE\nDO 505 I = 1,NPAR\nA(I,NPAR+1) = ~A(I,NPAR+1)\nCONTINUE\nINCLUINDO AS FUNCOES PENALIDADES\nK > 0\n-7 &lt;S &lt;20\nC > 0\nPEN(l) \u00ae 2.D-5/OESTK**3\nPEN(2) \u00bb l.D-2*( DEXP(-0ESTS-7.DO) + DEXP(-2.Dl+OESTS) )\nPEN(3) \u00ab 2. D1/OESTC**3\nDO 510 I \u00ab 1,NPAR\nPEN(I) - PEN(I)*NP*FII*SSR0LD/2.D0\nA(I,I) = A(I,I) + PEN(I)\nCONTINUE\nPEN(l) = l.D-5/OESTK**2\nPEN(2) = l.D-2*( DEXP(-OESTS\u201c7.DO) - DEXP(-2.Dl+OESTS) )\nPEN(3) = l.Dl/OESTC**2\nDO 520 I = 1,NPAR\nPEN(I) \u00ae PEN(I)*NP*FII*SSROLD/2.DO\nA(I,NPAR+1) = A(I,NPAR+1) + PEN(I)\nCONTINUE\nESCALONANDO A MATRIZ A\nDO 570 I = 1,NPAR\nDO 560 J = 1,NPAR AS(I,J) = A(I,J)/DSQRT(A(I,I)*A(J,J)) CONTINUE\n710\nDELS = DELTA(2)/DSQRT(A(2,2))\nDELC = DELTA(3)/DSQRT(A(3,3))\nMM \u00ab 0\nMMM = 0\nRO = .5D0**MM\nESTK - OESTK + RO*DELK\nESTS = OESTS + RO*DELS\nESTC = OESTC + RO*DELC\nIF (ESTK.LE.O.DO.OR.ESTC.LT.0.DO) THEN\nMM = MM t 1\nWRITE(*,*) 'SOMA POR LIMITE'\nIF (MM.GT.10) THEN\nWRITE(*,*) 'FALHA POR LIMITE'\nGO TO 402\nENDIF\n402\nGO TO 710\nENDIF\nIF (ESTS.LT.0.DO) THEN\nRESRWE = RESRW*DEXP(-ESTS)\nSKIN = 0.D0\nELSE\nRESRWE \u00ab RESRW\nSKIN \u00bb ESTS\nENDIF\nSSR = 0.D0\nSAV = 0.D0\n113\n*\n*\nA\n*\n*\n*\nIF (I0PT.NE.3) THEN\nCALL LAPLACE(RESPHI,RESVIS ,RESCT,RESRWE,RESH,RESQ, ESTK,SKIN,ESTC, TEST,N,M,NP, B,FUN,IOPT)\nDO 113 I = 1,NP\nIF (I0PT.EQ.1) THEN RES(I) = FUN(I) - TESP(I)\nT?r CJ\u2019E\u2019\nIZjLjOXj\nRES(I) = FUN(I) - DP(I)\nENDIF\nSSR = SSR + RES(I)*RES(I)\nAUX1 \u00ab DABS(RES(I))\nSAV = SAV + AUX1\nCONTINUE\nELSE\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ, ESTK,SKIN,ESTC, TEST,N,M,NP,\nB,FUN,1)\nDO 114 I = 1,NP\nRES(I) = FUN(I) - TESP(I)\nSSR = SSR + RES(I)*RES(I) AUX1 = DABS(RES(I))\nSAV = SAV + AUX1\nCONTINUE\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ, ESTK,SKIN,ESTC, TEST,N,M,NP,\nBl,FUN,2)\niyi iis; T \u20141 MP\n115\n401\n615\n620\nSAV = SAV + AUX1\nCONTINUE\nENDIF\nSSR= SSR/(FII*NP)\nSAV = SAV/(FII*NP)\nIF (SSR.GT.SSROLD) THEN\nMMM - 1\nMM = MM + 1\nWRITE(*,*) 'SOMA POR RESIDUO'\nIF (MM.GT.10) THEN\nWRITE(*,*) 'FALHA POR RESIDUO'\nGO TO 401\nENDIF\nGO TO 710\nENDIF\nWRITE(8,615) ITER,SSR*14.7*14.7,SAV*14.7,0.0,\n*\tESTK*1.D+3,ESTS,ESTC*4.2784409E\u201d7,MM+1\nFORMAT(IX,13,6(IX,Ell.5),1X,I2)\nIF (MMM.NE.0) THEN\nRLAM = REAM*10.DO\nELSE\nRLAM \u00ab RLAM/10.DO\nENDIF\nTOLK \u00ab DABS(DELK/OESTK)\nTOLS = DABS(DELS/OESTS)\nTOLC = DABS(DELC/OESTC)\nWRITE(*,600) ITER\nWRITE(*,*) SSROLD*216.09,SSR*216.09\nWRITE(*,610) DELK*1.D3,DELS,DELC*4.2784409E-7\nWRITE(*,610) ESTK*1.D3,ESTS,ESTC*4.2784409E-7 OESTK - ESTK\nOESTS = ESTS\nOESTC \u00bb ESTC\nSSROLD = SSR\nPAUSE\nENDDO\nIF (IOPT.EQ.1) THEN\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tESTK,SKIN,ESTC,\n*\tTEST,N,M,NP,\n*\tB,RES,2)\nDO 620 I = 1,NP\nWRITE(7,645) TEST(I)/3.6D3,TESP(I)*14.7DO,FUN(I)*14.7 DO,\n*\tDP(I)*14.7DO,RES(I)*14.7D0\nCONTINUE\nELSE\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tESTK,SKIN,ESTC,\n*\tTEST,N,M,NP,\n*\tB,RES,1)\nDO 635 I - 1,NP\nWRITE(7,645) TEST(I)/3.6D3,TESP(I)*14.7D0,RES(I)*14.7D0,\n*\tDP(I)*14.7D0,FUN(I)*14.7D0\nITER\nSSR*216.09,SAV*14.7\nESTK*1.D3,DELK,ESTS,DELS,\nESTC*4.2784409E-7,DELC\n600\n610\n645\n650\n660\nWRITE(*,600)\nWRITE(*,650)\nWRITE(*,660)\n*\nWRITE(9,*)\nIF(IOPT.EQ.l) THEN\nWRITE(9,*) \u2019REGRESS\u00c3O\nELSE IF(IOPT.EQ.2) THEN\nWRITE(9,*) 'REGRESS\u00c3O\nELSE\nWRITE(9,*) 'REGRESS\u00c3O\nENDIF\nWRITE(9,600) ITER\nWRITE(9,650) SSR*216.09,SAV*14.7\nWRITE(9,660) ESTK*1.D3,DELK,ESTS,DELS,ESTC*4.2784409E-7, DELC FORMAT(/,IX,'N. ITERACOES =',I4)\nFORMAT(1X,'K = ',F15.6/IX,'S = ',F15.6/IX,'C = ',E15.6) FORMAT(IX,5(E15.7)) FORMAT(IX,'SSR\n*\tIX,'SAV FORMAT(IX,'K \u00bb\n*\n*\nEND\n**********************************************************************\nNOS\tDADOS\tDE\nNOS\tDADOS\tDA\nNOS\tDADOS\tDA\nPRESS\u00c3O,'\nPRESS\u00c3O E DA DERIVADA.'\nIX,'S = IX,'C =\n=',F15.5,2x,/\n=',F15.5,2x,) ,F15.6,' ,F15.6,' ,E15.6,'\n+/~',F6.2t' %'/ +/-'tF&amp;t2,' %*/ +/-',F6.2,' %')\n> t\nSUBROUTINE LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,\n*\tESTK,ESTS,ESTC,\n*\tTEST,N,M,NP,\n*\tB,FUN,IOPT)\nIMPLICIT REAL * 8 (A-H,O-Z)\nPARAMETER (NPON=150,NPAR=3)\nDIMENSION G(50), H(25),TEST(NPON),B(NPON,NP\u00c3R),FUN(NPON) COMMON /STE/ V(50)\nDLOGTW = 0.69314718056D0\nPI = 4.DO*DATAN(1.DO)\nIF (N .EQ, M) GOTO 17\nM = N\nNH - N/2\nC\tFATORIAIS FICAM EM G\nG(l) - 1.D0 DO 1 I = 2, N\nG(I) = G(I-l) * I\n1\tCONTINUE\nH(l) = 2.DO / G(NH-l)\nDO 6 I = 2, NH\nFI = I\nIF (I-NH) 4,5,6\n4\tH(I) = FI**NH*G(2*I)/(G(NH-T)*G(I)*G(I-1)) GOTO 6\n5\tH(I) - FI**NH*G(2*1)/(G(I)*G(1-1))\n6\tCONTINUE\nSN = 2*(NH-NH/2*2)-1\nDO 7 I = 1, N\nV(I) = 0.D0\nKl - (I+1J/2\n9\n8\n12\n11\n13\n14\n10\n7\n17\n15\n500\nIF(I-K) 11,14,11\nV(I) = V(I) + H(K)/(G(I~K)*G(2*K~I))\nGOTO 10\nV(I) = V(I) + H(K)/G(I-K)\nGOTO 10\nV(I) = V(I) + H(K) / G(2*K - I)\nCONTINUE\nV(I) \u00ab SN*V(I)\nSN = -SN\nCONTINUE\nCONTINUE\nCl = DSQRT(RESPHI*RESVIS*RESCT)*RESRW\nC2 = 2.D0*PI*RESH/RESVIS\nTEMPS = DSQRT(ESTK)\nDO 500 J = 1,NP\nB(J,1) = 0.D0\nB(J,2) = 0*D0\nB(J,3) \u00ab 0.D0\nFUN(J) = 0.00\nA \u00ab DLOGTW / TEST(J)\nDO 15 I = 1, N\nARG \u00ab A*I\nIF(IOPT*EQ.1) THEN\nAL = 1.0D0\nELSE\nAL = ARG\nENDIF\nTEMPS = DSQRT(ARG)\nTEMPI = C1*TEMP5/TEMP6\nTEMP2 = BESSKO(TEMPI)\nTEMP3 = BESSK1(TEMPI)\nTEMP4 = -(TEMP3/TEMP1+TEMP2)\nAUX1 = C1*C2*TEMP5*TEMP6*TEMP3\nAUX2 \u00ae TEMP2 + ESTS*TEMP1*TEMP3\nAUX3 = (AUX1/AUX2 + ESTC*ARG)**2\nAUX4 = TEMP6*TEMP3 - C1*TEMP5*TEMP4\nAUX4 = AUX4*C1*C2*TEMP5/(2.DO*ESTK)\nAUX5 = TEMP6*TEMP3 + C1*TEMP5*TEMP4\nAUX5 - ESTS*AUX5/ESTK**2\nAUX5 = TEMP3/(ESTK*TEMP6) - AUX5\nAUX5 = Cl*TEMP5*AUX5/2.DO\nB(J,1) = B(J,1) ~ V (I) *AL* (RESQ/ARG) * (AUX4*AUX2-AUX1*AUX5) /\n*\t(AUX3*AUX2**2)\nB(J,2) = B(J,2) + V(I)*AL*RESQ*C1**2*C2*TEMP3**2/\n*\t(AUX3*AUX2**2)\nB(J,3) = B(J,3) ~ V(I)*AL*RESQ/AUX3\nFUN(J) = FUN (J) + V(I) *AL*RESQ/(ARG*(AUX1/AUX2 + ESTC*ARG) ) CONTINUE\nIF (I0PT.EQ.1) THEN\nB(J,1)\t-\tB(J,1)\t*\tA\nB(J,2)\t\u00ab\tB(J,2)\t*\tA\nENDIF\nCONTINUE\nRETURN\nEND\n**********************************************************************\nSUBROUTINE DPDT(TEST,TESP,NP,DP)\nIMPLICIT REAL * 8 (A-H,O-Z)\nDIMENSION TEST(l),TESP(I),DP(1)\n1 = 2\nAUX = DLOGIO(TEST(I)/TEST(1))\nDO WHILE (AUX.LT.0.1500)\nI = I 4- 1\nAUX = DLOGIO(TEST(IJ/TEST(1))\nENDDO\nAUX2 = TEST(I) - TEST(l)\nAUX4 = TESP(I) - TESP(l)\nDP(1) = TEST(1)*AUX4/AUX2\nDO 100 I=2,NP-1\nJ = I + 1\nAUX = DLOGIO(TEST(J)/TEST(I))\nDO WHILE (AUX.LT.O.15D0.AND.J.LT.NP)\nJ = J 4- 1\nAUX = DLOGIO(TEST(J)/TEST(I))\nENDDO\nAUX2 = TEST(J) - TEST(I)\nAUX4 = TESP(J) - TESP(I)\nJ = I - 1\nAUX = DLOGIO(TEST(I)/TEST(J))\nDO WHILE (AUX.LT.0.15D0.AND.J.GT.1)\nJ = J - 1\nAUX = DLOGIO(TEST(I)/TEST(J)) ENDDO\nAUX1 = TEST(I) - TEST(J)\nAUX3 = TESP(I) - TESP(J)\nDP(I) = ( AUX2*AUX3/AUX1 4- AUX1*AUX4/AUX2 )/(AUXl 4- AUX2) DP(I) \u201c TEST(I)*DP(I)\n100 CONTINUE\nDP(NP) = DP(NP-l)\nRETURN\nEND\nC***********************************************************************\nSUBROUTINE GAUSS(A,X,N)\nPARAMETER (NPAR=3)\nINTEGER*4 N\nREAL*8 A (NPAR, NPAR4-1) , X (NPAR)\nCALL DIAGONAL(A,N)\nCALL RESOLVE(A,X,N)\nRETURN\nEND\n**********************************************************************\nSUBROUTINE DIAGONAL(A,N)\nPARAMETER (NPAR=3)\nINTEGER*4 N,NI,NJ,IAUX,II\nREAL*8 A(NPAR,NPAR4-1) ,AUX(NPAR4-1) ,M\nDO 600 NI=1,N\nXX = A(NI,NI)\nDO 200 II = NI4-1,N\nIF (DABS(A(II,NI)).GT.DABS(A(NI,NI))) THEN\nDO 100 IAUX=NI,N4-1\nAUX(IAUX) = A(NI,IAUX)\nA(NI,IAUX) = A (II,IAUX)\nA(II,IAUX) = AUX(IAUX)\n100\tCONTINUE\nENDIF\n200\tCONTINUE\nIF (A(NI,NI).EQ.O.DO) THEN\nWRITE(6,3OO)\n300\tFORMAT(//IX,'SISTEMA SEM SOLUCAO'//)\nSTOP\nENDIF\nDO 500 IAUX \u00bb NI+1,N\nIF (A(IAUX,NI).NE.O.DO) THEN\nM = A(IAUX,NI)/A(NI,NI)\nDO 400 NJ = 1,N+1\nA(IAUX,NJ) = A(IAUX,NJ) - M*A(NI,NJ)\n400\tCONTINUE\nENDIF\n500\tCONTINUE\n600 CONTINUE\nRETURN\nEND\n**********************************************************************\nSUBROUTINE RESOLVE(A,X,N)\nPARAMETER (NPAR-3)\nINTEGER*4 N,NI,NJ\nREAL*8 A(NPAR,NPAR+1),X(NPAR),AUX\nX(N) = A(N,N+1)/A(N,N)\nDO 200 NI=N\u201c1,1,-1\nAUX - 0.D0\nDO 100 NJ=NI+1,N\nAUX = AUX + A(NI,NJ)*X(NJ)\n100\tCONTINUE\nX(NI) = ( A(NI,N+1) - AUX )/A(NI,NI)\n200 CONTINUE\nRETURN\nEND\n**********************************************************************\nSUBROUTINE MATINV (A,AINV,NN)\nPARAMETER (NPAR-3)\nREAL*8 A(NPAR,NPAR+l), Al NV (NPAR, NPAR),AUX(NPAR*NPAR,NPAR*NPAR+1)\nREAL*8 B(NPAR*NPAR),C(NPAR*NPAR)\nINTEGER*4 NN\nN = NPAR\nDO 100 1=1,N*N\nB(I) = 0.D0\n100 CONTINUE\nDO 110 I=1,NN*NN,NN+1\nB(I) = 1.D0\n110 CONTINUE\nDO 130 1=1,N*N\nDO 120 J = 1,N*N+1\nAUX(I,J) = 0.D0\n120\tCONTINUE\n130 CONTINUE\nDO 150 I = 1,NN\nDO 140 J \u00ab 1,NN\nDO 135 K = 1,NN\nAUX(I+(K-1)*NN,J+(K-1)*NN) \u00bb A(I,J)\n135\tCONTINUE\n140\tCONTINUE\n150 CONTINUE\nDO 160 I = 1,NN*NN\nAUX(I,NN*NN+1) = B(I)\n160 CONTINUE\nCALL GAUSS(AUX,C,NN*NN)\nK \u00ab 1\nDO 175 J = 1,NN\nDO 170 I - 1,NN\nAINV(I,J) = C(K)\nK \u201d K + 1\n170\tCONTINUE\n175 CONTINUE\nRETURN\nEND\n**********************************************************************\nSUBROUTINE INTERV(A,DEL,WSSR,NP)\nPARAMETER (NPAR=3,NPON-150)\nIMPLICIT REAL*8 (A-H,O-Z)\nDIMENSION A(NPAR,NPAR+1),DEL(NPAR),AINV(NPAR,NPAR)\nCALL MATINV (A,AINV,NPAR)\nTDIS = TDISTR(NP-NPAR)\nDO 100 1=1,NPAR\nDEL(I) = TDIS*DSQRT(NP*WSSR*AINV(I,I)/(NP-NPAR))\n100 CONTINUE\nRETURN\nEND\n**********************************************************************\nFUNCTION TDISTR(NDF)\nIMPLICIT REAL*8 (A-H,O-Z)\nDIMENSION TABLE(50)\nDATA TABLE / 12.706,4.303,3.182,2.776,2.571,2.447,2.365,\n*\t2.306,2.262,2.228,2.201,2.179,2.160,2.145,\n*\t2.131,2.120,2.110,2.101,2.093,2.086,2.080,\n*\t2.074,2.069,2.064,2.060,2.056,2.052,2.048,\n*\t2.045,2.042,2.040,2.037,2.035,2.032,2.030,\n*\t2.028,2.026,2.024,2.023,2.021,2.020,2.018,\n*\t2.017,2.015,2.014,2.013,2.012,2.011,2.010,\n*\t2.009/\nIF (NDF.LE.50) THEN\nTDISTR = TABLE(NDF)\nELSEIF(NDF.LE.6O) THEN\nTDISTR = 2.009\nELSEIF(NDF.LE.SO) THEN\nTDISTR = 2.000\nELSEIF(NDF.LE.120) THEN\nTDISTR \u00ab 1.990\nELSEIF(NDF.LE.240) THEN\nTDISTR = 1.980\nELSE\nTDISTR = 1.970\nENDIF\nRETURN\nEND\n**********************************************************************\nDOUBLE PRECISION FUNCTION BESSKO(X)\nIMPLICIT REAL*8 (A-H,O-2)\nDATA P1,P2,P3,P4,P5,P6,P7/-0.57721566D0,0.42278420D0,0.23069756DO,\n*\t0.3488590D-1,0.262698D-2,0.10750D-3,0.74D-5/\nDATA 01,02,03,04,05,06,07/1.2533141400,-0.78323580-1,0.21895680-1,\n*\t-0.1062446D-1,0.587872D-2,-0.2515400-2,0.53208D-3/\nBESSKO=(-DLOG(X/2.0) *BESSI0 (X) ) 4- (Pl+Y* (P2+Y* (P3 +\n*\tY*(P4+Y*(P5+Y*(P6+Y*P7))))))\nELSE\nY=(2.0/X)\nBESSK0=(DEXP(-X)/DSQRT(X))*(Ql+Y*(Q2+Y*(Q3+\n*\tY* (Q4+Y*(Q5+Y*(Q6+Y*Q7))))))\nENDIF\nRETURN\nEND\nC***********************************************************************\nDOUBLE PRECISION FUNCTION BESSKl(X)\nIMPLICIT REAL*8 (A-H,O~Z)\nDATA Pl(P2fP3,P4,P5,P6,P7/1.ODO,0.1544314400,-0.67278579D0f\n*\t-0.18156897D0,-0.19194020-1,-0.1104040-2,-0.46860-4/\nDATA QI, Q2,Q3,Q4,Q5,Q6,Q7/1.25331414D0,0.2349861900,-0.3655620D-1,\n*\t0.1504268D-1,-0.780353D-2,0.3256140-2,-0.682450-3/\nIF (X.LE.2.0) THEN\n\u00a5=X*X/4.0\nBESSK1=(DLOG(X/2.0)*BESSI1(X)) + (1.0/X)*(Pl+Y*(P2+\n*\tY* (P3+Y* (P4+Y* (P5+Y* (P6+Y*P7) ) ) ) ) )\nELSE\nY-2.0/X\nBESSK1=(DEXP(-X)/DSQRT(X))*(Ql+Y*(Q2+Y*(Q3 +\n*\tY*(Q4+Y*(Q5+Y*(Q6+Y*Q7))))))\nENDIF\nRETURN\nEND\nC***********************************************************************\nDOUBLE PRECISION FUNCTION BESSIO(X)\nIMPLICIT REAL*8 (A-H,O-Z)\nDATA Pl,P2,P3,P4,P5,P6,P7/1.ODO,3.515622900,3.089942400,1.20674920\n*0,\n*\t0.265973200,0.3607680-1,0.458130-2/\nDATA QI,Q2,Q3,Q4,Q5,Q6,Q7,Q8,Q9/0.3989422800,0.13285920-1,\n*\t0.225319D-2,-0.157565D-2,0.9162810-2,-0.2057706D-1,\n*\t0.26355370-1,-0.16476330-1,0.3923770-2/\nIF (DABS(X).LT.3.75) THEN\nY=(X/3.75)**2\nBESSIO=P1+Y*(P2+Y*(P3+Y*(P4+Y*(P5+Y*(P6+Y*P7)))))\nELSE\nAX-DABS(X)\n\u00a5=3.75/AX\nBESSIO=(DEXP(AX)/DSQRT(AX))*(Ql+Y*(Q2+Y*(Q3+Y*(Q4\n*\t+Y*(Q5+Y*(Q6+Y*(Q7+Y*(Q8+Y*Q9))))))))\nENDIF\nRETURN\nEND\nC***********************************************************************\nDOUBLE PRECISION FUNCTION BESSIl(X)\nIMPLICIT REAL*3 (A-H,O-Z)\nDATA Pl,P2,P3,P4,P5,P6,P7/0.500,0.8789059400,0.51498869D0,\n*\t0.1508493400,0.26587330-1,0.3015320-2,0.324110-3/\nDATA QI,Q2,Q3,Q4,Q5,Q6,Q7,Q8,Q9/0.3989422800,-0.39880240-1,\n*\t-0.3620180-2,0.1638010-2,-0.10315550-1,0.2282967D-1,\n*\t-0.28953120-1,0.17876540-1,-0.420059D-2/\n\u00a5=3.75/AX\nBESSI1=(DEXP(AX)/DSQRT(AX))*(Ql+Y*(Q2+Y*(Q3+Y*(Q4+ *\tY*(Q5+Y*(Q6+Y*(Q7+Y*(Q8+Y*Q9))))))))\nENDIF\nRETURN\nEND\nPROGRAMA PR0G4.F0R ******* as rotinas laplace, gauss e interv e as funcoes de Bessel******* sao as mesmas do programa PRGO1.FOR *******\nC********************\u00ed***************************ii*********i****i*ii*** c****\nC * *r * *\nc****\nC*\u00bb***********************************ik*****i*********i****************i\nIMPLICIT REAL*8 (A-H,O-Z)\nPARAMETER (NPON\u00bb150,NPAR==3)\nCHARACTER*12 ARQUIVO\nDIMENSION TESP(NPON) ,TEST(NPON) , B(NPON, NPAR) , FUN(NPON) , RES (2*NPON)\nDIMENSION A(NPAR,NPAR+1) ,DELTA(NPAR),PEN(NPAR) , PESO (2*NP0N) ,\n*\tAS(NPAR,NPAR+1) , DP(NPON) , BI (NPON, NPAR)\nCOMMON /STE/ V(50) CON1 = 1000.\nCON2 = 4.2784409E-7\nCON3 =14.7\nC0N4 = 216.09\nDADOS DE RESERVAT\u00d3RIO\nc c\nH(PES), VIS(CP), PHI(PURO), CT(PSI-l), Q(STB/D), BO(BBL/STB), RW(POL)\nARQUIVO DE DADOS.'\n10 c\n20\n20D\n201\nC\nc\nc\n300\nWRITE(*,*) 'ENTRE COM O\nREAD(*,*) ARQUIVO\nOPEN (4,FILE=ARQUIVO,STATUS\u00bb'UNKNOWN')\nOPEN(7 , FILE='SAIMLAV.DAT',STATUS\u00bb'UNKNOWN') OPEN (8,FILE\u00bb'LIXO.DAT',STATUS\u00bb'UNKNOWN') OPEN(9,FILE\u00bb'RESMLAV.DAT',STATUS\u00bb'UNKNOWN') READ (4,10) RESH, RESVIS, RESPHI, RESCT,RESRW, RESQ, RESBO, TPROD FORMAT(T25,F10.5) NUMERO DE PONTOS\nREAD(4,20) NP FORMAT(T32,13) DO 200 I = 1,NP\nREAD(4,*) TEST(I),TESP(I) CONTINUE\nIF (TPROD.NE.0.DO) THEN\nDO 201 1=1,NP\nTEST(I) = TEST(I)*TPROD/(TEST(I)+TPROD)\nCONTINUE\nENDIF VARIAVEIS DE CONTROLE PARA O ALGORITMO DE STHEFEST COM 8 CTES M = 0 N \u00bb 8 CONSTANTE INICIAL PARA 0 ALGORITMO DE GAUSS-MARQUARDT REAM = 0.1D0\nTRANSFORMACOES DE UNIDADE\nRESCT = RESCT*14.7D0 RESQ = RESQ*RESBO*1,84D0 RESRW = RESRW*2.54D0 RESH = RESH*30.48D0 DO 300 I \u00ab\nTEST(I)\nTESP(I) CONTINUE WRITE(6,*) WRITE(6,*) WRITE(6,*) WRITE(6,*)\nREAD(5,*) I OPT CALL DPDT(TEST,TESP,NP,DP) LENDO AS ESTIMATIVAS INICIAIS WRITE(6,100)\nFORMAT(IX,'ENTRE COM OS VALORES INICIAIS DE K(D) , S E C(CM3/ATM)')\n1,NP\n= TEST(I)*3.6D3 - TESP(I)/14.7D0\n'QUAL A FUNCAO A SER MINIMIZAR ?' '1 - PRESS\u00c3O.'\n'2 - DERIVADA.'\n'3 - DERIVADA+PRESS\u00c3O.'\nc\n110\n400\n410\n420\nREAD(5,*) OESTK,OESTS,OESTC\nWRITE(8,*)\nWRITE(8,*) 'ARQUIVO :',ARQUIVO\nWRITE(8,*)\nWRITE(8,*) 'METODO DE MINIMOS VALORES ABSOLUTOS MODIFICADO.' WRITE(8,*)\nWRITE(8 f110) C0N1*OESTK,OESTS,C0N2*0ESTC\nWRITE(9,110) CONI*0ESTK,OESTS,C0N2*0ESTC\nFORMAT(3X,'ESTIMATIVAS INICIAIS'//\n*\tIX,'K \u201c',F10.5/\n*\tIX,'S =*,F10.5/\n*\tIX,'C ~',E10.3)\nSAVOLD - 0.D0\nSSR = O.DO\nDO 400 I = 1,2*NP\nPESO(I) = O.DO\nCONTINUE\nIF (I0PT.NE.3) THEN\nFIX - 1.0D0\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,\n*\tOESTK,OESTS,OESTC,TEST, N,M,NP,B,FUN,IOPT)\nIF(IOPT.EQ.l) THEN\nCALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSROLD,SAVOLD,NP,0) ELSE\nCALL RESIDUO(FUN,DP,RES,PESO,SSR,WSSROLD,SAVOLD,NP,0) ENDIF\nCALL CALCPESO(RES,PESO,NP,0)\nELSE\nFII = 2\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,\n*\tOESTK,OESTS,OESTC,TEST,N,M,NP,B,FUN,1)\nCALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSROLD,SAVOLD,NP,0)\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,\n*\tOESTK,OESTS,OESTC,TEST,N,M,NP,Bl,FUN,2)\nCALL RESIDUO(FUN,DP,RES,PESO,SSR,WSSROLD,SAVOLD,NP,NP)\nCALL CALCPESO(RES,PESO,NP,0)\nCALL CALCPESO(RES,PESO,NP,NP)\nENDIF\nSSR = SSR/(FII*NP)\nSAVOLD = SAVOLD/(FII*NP)\nWSSROLD = SAVOLD\nWRITE(9,615) 0,C0N4*SSR,CON3*SAVOLD,0.0,CONI*0ESTK,OESTS,\n*\tC0N2*0ESTC,0\nITMAX = 101\nTOL = l.D-4\nITER = 1\nTOLK -l.DO\nTOLS \u00ae l.DO\nTOLC - l.DO\nTOLR = l.DO\nMM = 0\nDO WHILE((TOLK.GT.TOL.OR.TOLS.GT.TOL.OR.TOLC.GT.TOL.OR.\n*\tTOLR.GT.TOL).AND.ITER.LT.ITMAX,AND.MM.LT.10)\nDO 420 I = 1,NPAR\nDO 410 J = 1,NPAR+1\nA(I,J) \u00bb O.DO\nCONTINUE\nCONTINUE\nDO 500 K = 1,NP\nDO 440 I \u00bb 1,NPAR\n430\n440\n500\n505\nC\nC\nc c\n510\n520 C\n560\n570\n550\n710\nA(I,NPAR+1) = A(I,NPAR+1) + PESO(K)*RES(K)*B(K,I)\nIF (IOPT.EQ.3)\nA(I,NPAR+1) = A(I,NPAR+1) +\nPESO(K+NP)*RES(K+NP)*B1(K, I) CONTINUE\nCONTINUE\nDO 505 I \u00ab 1,NPAR\nA(I,NPAR+1) = -A(I,NPAR+1)\nCONTINUE\nINCLUINDO AS FUNCOES PENALIDADES\nK > 0\n-7 &lt;S &lt;20\nC > 0\nPEN(l) = 2.D-5/OESTK**3\nPEN(2) = l.D-2*( DEXP(-0ESTS-7,D0) + DEXP(OESTS ~ 2.Dl) )\nPEN(3) = 2.D1/OESTC**3\nDO 510 I = 1,NPAR\nPEN(I) = PEN(I)*NP*FII*WSSROLD/2.DO\nAfljl) = A(I,I) + PEN(I)\nCONTINUE\nPEN(l) = l.D-5/OESTK**2\nPEN(2) \u00ab l.D~2*( DEXP(-OESTS-7.DO) - DEXP(OESTS - 2.Dl) )\nPEN(3) = l.Dl/OESTC**2\nDO 520 I = 1,NPAR\nPEN(I) = PEN(I)*NP*FII*WSSROLD/2.DO\nA(I,NPAR+1) = AfljNPAR+l) + PEN(I)\nCONTINUE\nESCALONANDO A MATRIZ A\nDO 570 I=1,NPAR\nDO 560 J \u00ab 1'NPAR\nAS(IfJ) = A(I,J)/DSQRT(A(I,I)*A(J,J))\nCONTINUE\nAS(I,NPAR+1) = A(I,NPAR+1)/DSQRT(A(I,I))\nCONTINUE\nDO 550 I = 1,NPAR\nAS(I,I) = AS (I, I) +RLAM\nCONTINUE\nCALL GAUSS(AS,DELTA,NPAR)\nDELK = DELTA(l)/DSQRT (A(l,l))\nDELS = D\u00caLTA(2)/DSQRT(A(2,2))\nDELC = DELTA(3)/DSQRT(A(3,3))\nMM = 0\nRO = 0.5D0**MM\nESTK \u00bb OESTK + RO*DELK\nESTS = OESTS + RO*DELS\nESTC = OESTC + RO*DELC\nIF(ESTK.LE.0.DO.OR.ESTC.LT.0.DO) THEN\nMM = MM + 1\nWRITE(*,*) 'SOMA EM MM POR LIMITE'\nIF (MM.GT.I0) THEN\nWRITE(*,*) 'FALHA NO ALGORITMO DE PROCURA LINEAR-LIMITE' GO TO 402\nENDIF\nGO TO 710\nENDIF\n403\n605\nIF (ESTS.LT.0.DO) THEN\nRESRWE = RESRW*DEXP(-ESTS)\nSKIN = O.DO\nELSE\nRESRWE = RESRW\nSKIN = ESTS\nENDIF\nSAV = O.DO\nSSR = O.DO\nWSSR = O.DO\nIF (IOPT.NE.3) THEN\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tESTK,SKIN,ESTC,TEST,N,M,NP,B,FUN,IOPT)\nIF(IOPT.EQ.1) THEN\nCALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSR,SAV,NP,0) pr Ct?\nCALL RESIDUO(FUN,DP,RES,PESO,SSR,WSSR,SAV,NP,0)\nENDIF\nELSE\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tESTK,SKIN,ESTC,TEST,N,M,NP,B,FUN,1)\nCALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSR,SAV,NP,0)\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tESTK,SKIN,ESTC,TEST,N,M,NP,Bl,FUN, 2)\nCALL RESIDUO(FUN,DP,RES,PESO,SSR,WSSR,SAV,NP,NP)\nENDIF\nSSR \u00bb SSR/(FII*NP)\nWSSR = WSSR/(FII*NP)\nSAV = SAV/(FII*NP)\nIF (SAV.GT.SAVOLD) THEN\nMM = MM + 1\nWRITE(*,*) 'SOMA EM MM POR RESIDUO'\nIF (MM.GT.10) THEN\nWRITE(*,*) 'FALHA NO ALGORITMO DE PROCURA LINEAR-RESIDUO'\nGO TO 403\nENDIF\nGO TO 710\nENDIF\nIF(IOPT.NE.3) THEN\nCALL CALCPESO(RES,PESO,NP,0)\nELSE\nCALL CALCPESO(RES,PESO,NP,0)\nCALL CALCPESO(RES,PESO,NP,NP)\nENDIF\nIF (WSSR.GT.WSSROLD) THEN\nRLAM = RLAM*10.DO\nELSE\nRLAM = RLAM/10.DO\nENDIF\nWRITE(*,600) ITER\nWRITE(*,605) CON3*SAVOLD,CON3*SAV,CON3*WSSR,CON4*SSR\nFORMAT(T10,'SAVOLD',T24,'SAV',T38,'WSSR',T52,'SSR'/\n*\t4(2X,F12.4))\nWRITE(9,615) ITER,CON4*SSR,CON3*SAV,0.0,\n*\tCON1*ESTK,ESTS,CON2 *ESTC,MM+1\nC\nWSSROLD = WSSR\nSAVOLD = SAV\nOESTK = ESTK\nOESTS - ESTS\nOESTC = ESTC\nWRITE(*,610) CON1*ESTK,ESTS,CON2*ESTC\nPAUSE\n210\n220\n600\n610\n645\n650\n660\nITER = ITER + 1\nENDDO\nITER = ITER - 1\nIF (I0PT.EQ.1) THEN\nCALL LAPLACE (RESPHI, RESVIS, RESCT, RESRWE, RESH, RESQ,\n*\tESTK,SKIN,ESTC,\n*\tTEST,N,M,NP,\n*\tB,RES,2)\nDO 210 I = 1,NP\nWRITE(7,645) TEST(I)/3.6D3,TESP(I)*14.7D0,FUN(I)*14.7D0,\n*\tDP(I)*14.7D0,RES(I)*14.7D0\nCONTINUE\nELSE\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tESTK,SKIN,ESTC,\n*\tTEST,N,M,NP,\n*\tB,RES,1)\nDO 220 I = 1,NP\nWRITE(7,645) TEST(I)/3.6D3,TESP(I)*14.7D0,RES(I)*14.7D0,\n*\tDP(I)*14.7D0,FUN(I)*14.7D0\nCONTINUE\nENDIF\nNil =\nCALL '\nDELK \u25a0\u25a0\nDELS\nDELC ;\nWRITE(8,*)\nIF(IOPT.EQ.l) THEN\nWRITE( 8, *)\t\"REGRESSAO\nELSE IF(IOPT.EQ.2) THEN\nWRITE(8,*) \"REGRESSAO ELSE\nWRITE(8,*) \u2019REGRESSAO ENDIF\nWRITE(8,600)\nWRITE(8,650)\nWRITE(8,660)\nWRITE(*,600)\nWRITE(*,650)\nWRITE(*,660)\nFORMAT(/,IX,\"N\nFORMAT(1X,'K = \",F15.6/1X,\nFORMAT(IX,5(E15.7))\nFORMAT(IX,\"WSSR\n*\tIX,\"SSR\n*\tIX,\"SAV FORMAT(IX,\"K =\n*\n*\n= FII*NP\nINTERV (A,DELTA,WSSR,Nil) = 100.D0*DELTA(1)/ESTK = 100.D0*DELTA(2)/ESTS = 100.D0*DELTA(3)/ESTC\nNOS\tDADOS\tDE\nNOS\tDADOS\tDA\nNOS\tDADOS\tDA\nPRESSAO.'\nPRESSAO E DA DERIVADA.\"\nDERIVADA DA PRESSAO.\"\nITER\nCON3*WSSR,COM4*SSR,CON3 *SAV\nCON1*ESTK,DELK,ESTS,DELS,CON2 *ESTC,DELC ITER\nCON3 *WSSR,CON4 *SSR,CON3 *SAV\nCONI*ESTK,DELK,ESTS,DELS,C0N2*ESTC,DELC ITERACOES =\",I4)\n\",F15.6/1X,\"C = \",E15.6)\nz\nIX,\"S = \"\nIX,\"C = '\n,F15.5,2X,/\n,F15.5,2x,/ ,F15.5,2x,) ,F15.6,\"\t+/-',\n,F15.6,\"\t+/-\",\n,E15,6,\"\t+/-S\n_. i\n\"S =\n= 1\nr\nEND\n**********************************************************************\nSUBROUTINE CALCPESO(RES,PESO,NP,IN)\nIMPLICIT REAL*8 (A-H,O-Z)\nPARAMETER (NPO.N=150)\nDIMENSION RES(l),PESO(I)\nDO .100 1=1, N.P\nAUX = DABS(RES(I+IN))\nIF(AUX.LT.l.D-9) THEN\nPESO(I+IN) = 0\u00bbD0\nELSE\nPESO(I+IN) = 1.DO/AUX\nENDIF\n100 CONTINUE\nRETURN\nEND\n*****iii*'tii*il****ii**i**i***************ii*i**i****ii****i[***i*****iHt*\nSUBROUTINE RESIDUO(FUN,TESP,RES,PESO,SSR,WSSR,SAV,NP,IN) IMPLICIT REAL*8 (A-HfO~Z)\nPARAMETER (NPON=150)\nDIMENSION FUN(l),TESP(1),RES(1),PESO(1)\nDO 100 1=1,NP\nRES(I+IN) = FUN(I) - TESP(I)\nSSR = SSR + RES(I+IN)*RES(I+IN)\nWSSR = WSSR + PESO(I+IN)*RES(I+IN)*RES(I+IN)\nSAV = SAV + DABS(RES(I+IN))\n100 CONTINUE\nRETURN\nEND\n**********************************************************************\nc c\nC\n10 c\n20\n200\n201\nC\nc\nRegress\u00e3o nao linear com minimos quadrados utilizando o m\u00e9todo de Gauss para um modelo de reservat\u00f3rio radial infinito\nUtiliza a rotima RLLAV da biblioteca IMSL.\nin * it it k k * ******* ******* ******* ******* *******\nIMPLICIT REAL*8 (A~H,O~Z)\nPARAMETER (NPON=150,NPAR=3)\nDIMENSION X\u00a5 (2*NPON, NPAR+5) , BETA(NPAR) ,WK(2*NPAR+4) ,IWK(2*NPON)\nDIMENSION TESP(NPON) ,TEST(NPON) ,B(NPON,NPAR) ,FUN(NPON) ,DP(NPON) , *\tPESO(2*NPON) , A (NPAR, NPAR+1) ,RES(2*NPON) ,Bl(NPON,NPAR)\nCHARACTER*12 ARQUIVO\nCOMMON /STE/ V(50)\nCONI = 1000.\nCON2 = 4.2784409E-7\nCON3 =14.7\nCON4 = 216.09\nDADOS DE RESERVATORIO\nH(PES), VIS(CP), PHI(PURO), CT(PSI-l), Q(STB/D) , BO(BBL/STB), RW (POL) ARQUIVO DE DADOS.\u2022\nWRITEf*,*) 'ENTRE COM O\nREAD(*,*) ARQUIVO\nOPEN(4 tFILE=ARQUIVO,STATUS='UNKNOWN')\nOPEN(7 ,FILE=\u2022SAILAV.DAT',STATUS='UNKNOWN')\nOPEN(8,FILE='LIXO.DAT',STATUS='UNKNOWN')\nOPEN(9,FILE='RESLAV.DAT',STATUS^'UNKNOWN')\nPARAMETROS DE RESERVATORIO\nREAD(4,10) RESH,RESVIS,RESPHI,RESCT,RESRW,RESQ,RESBO,TPROD FORMAT(T25,FIO.5)\nNUMERO DE PONTOS\nREAD(4,20) NP\nFORMAT(T32,13)\nDO 200 I = 1, NP\nREAD(4,*) TEST(I),TESP(I)\nCONTINUE\nIF (TPROD.NE.0.DO) THEN\nDO 201 1=1,NP\nTEST(I) = TEST(I)*TPROD/(TEST(I)+TPROD)\nCONTINUE\nENDIF\nVARIAVEIS DE CONTROLE PARA 0 ALGORITMO DE STHEFEST COM 8 CTES\nM = 0\nN = 8\nTRANSFORMADOES DE UNIDADE\nRESCT\nRESQ =\nRESRW\nRESH ;\nDO 300 I =\nTEST(I)\nTESP(I)\nCONTINUE\nWRITE(6,*)\nWRITE(6,*)\nWRITE(6,*)\nWRITE(6,*)\nREAD(5,*)\n; RESCT*14.7D0\nRESQ*RESBO*1.84D0\nRESRW*2.54D0\nRESH*30.48D0\n1,NP\n= TEST(I)*3.6D3 = TESP(I)/14.7D0\nc\nWRITE(8,*) 'ARQUIVO ARQUIVO\nWRITE(8,*)\nWRITE(8,*) 'METODO DE MINIMOS VALORES ABSOLUTOS.'\nWRITE(8,*)\nWRITE(8 ,110) CON1*OESTK,OESTS,CON2*OESTC\nWRITE(9,110) CON1*OESTK,OESTS,CON3 *OESTC\n110 F0RMAT(3X,'ESTIMATIVAS INICIAIS'//\n*\tIX,'K\t=',F10.5/\n*\tIX,'S\t=',F10.5/\n*\tIX,'C\t=',E10.3)\nSAVOLD = 0.D0\nWSSROLD = 0.D0\nSSR = O.DO\nDO 400 I = 1,2*NP PESO(I) = O.DO\n400 CONTINUE\nIF(IOPT.NE.3) THEN\nFII =1.0\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,\n*\tOESTK,OESTS,OESTC,TEST,N,M,NP,B,FUN,IOPT) IF(IOPT.EQ.1) THEN\nCALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSROLD,SAVOLD,NP,0 ) ELSE\nCALL RESIDUO(FUN,DP,RES,PESO, SSR,WSSROLD,SAVOLD,NP,0 ) ENDIF\nCALL CALCPESO(RES,PESO,NP,0)\nELSE\nFII =2.0\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,\n*\tOESTK,OESTS,OESTC,TEST,N,M,NP,B,FUN,1)\nCALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSROLD,SAVOLD,NP,0) CALL CALCPESO(RES,PESO,NP,0) CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,\n*\tOESTK,OESTS,OESTC,TEST,N,M,NP,Bl,FUN,2)\nCALL RESIDUO(FUN,DP,RES,PESO,SSR,WSSROLD,SAVOLD,NP,NP) CALL CALCPESO(RES,PESO,NP,NP)\nENDIF\nSSR = SSR/(FII*NP)\nSAVOLD = SAVOLD/(FII*NP)\nWRITE(9,615) 0,CON4*SSR,CON3*SAVOLD,0.0,\n*\tCON1*OESTK,OESTS,CON2*OESTC,0\nITMAX = 101\nTOL = l.D-3\nITER = 1\nTOLK = 1.D0\nTOLS = 1.D0\nTOLC = 1.D0\nDO 130 I = 1,FII*NP DO 120 J = l,NPAR+5\nXY(I,J) - O.DO\n120\tCONTINUE\n130 CONTINUE\nMM = 0\nDO WHILEf(TOLK.GT.TOL.OR.TOLS.GT.TOL.OR.TOLC.GT.TOL).AND.ITER.LT.\n*\tITMAX.AND.MM.LT.10)\n405\n410\n411\n420\n430\n440\n500\n710\n402\nDO 410 K = 1,NP\nDO 405 I = 1,NPAR\nXY(K,I) = B(K,I)\nIF (I0PT.EQ.3) XY(K+NP,I) = B1(K,I)\nCONTINUE\nXY(K,NPAR+1) = RES(K)\nIF (IOPT.EQ.3) XV(K+NP,NPAR+1) = RES(K+NP) CONTINUE\nNII = FII*NP\nCALE RLLAV (XY,2*NPON, NI I,NPAR,1,BETA,SUMRE,11,IRANK,IWK,\n*\tWK,IER)\nDELE = BETA(l)\nDELS = BETA(2)\nDELC = BETA(3)\nDO 420 I = lfNPAR\nDO 411 J = 1,NPAR+1\nA(I,J) = 0.D0\nCONTINUE\nCONTINUE\nDO 500 K = 1,NP\nDO 440 I = 1,NPAR\nDO 430 J = 1,NPAR A(I,J) = A(I,J) + PESO(K)*B(K,I)*B(K,J) IF(IOPT,EQ.3)\n*\tA(I,J) = A(I,J) + PESO(K+NP)*B1(K,I)*B1(K,J) CONTINUE\nCONTINUE\nCONTINUE\nMM = 0\nRO = 0.5D0**MM\nESTK = OESTE + ROLDELE\nESTS = OESTS + RO*DELS\nESTC = OESTC + RO*DELC\nIF(ESTK.LE.0.DO.OR.ESTC. LT. O . DO) THEN\nMM = MM + 1\nWRITEf*,*) 'SOMA EM MM POR LIMITE'\nIF (MM.GE.10) THEN\nWRITE(*,*) 'FALHA NO ALGORITMO DE PROCURA LINEAR-LIMITE' GO TO 402\nENDIF\nGO TO 710\nENDIF\nIF (ESTS.LT.0.DO) THEN\nRESRWE = RESRW*DEXP(-ESTS)\nSKIN - 0.D0\nI?T CD\nX\u00ed>-Ljo Je*\nRESRWE = RESRW\nSKIN = ESTS\nENDIF\nSSR = 0.D0\nSAV = O.DO\nWSSR = 0.DO\nIF{IOPT.NE.3) THEN\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tESTK,SKIN,ESTC,TEST,N,M,NP,B,FUN,IOPT)\nIF(IOPT,EQ.1) THEN\nCALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSR,SAV,NP,0) ELSE\n403\n605\n615\n210\nELSE\n*\tESTK,SKIN,ESTC,TEST,N,M,NP,B,FUN,1)\nCALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSR,SAV,NP,0)\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tESTK,SKIN,ESTC,TEST,N,M,NP,Bl,FUN,2)\nCALL RESIDUO(FUN,DP,RES,PESO,SSR,WSSR,SAV,NP,NP)\nENDIF\nSSR = SSR/(FII*NP)\nWSSR \u00ab WSSR/(FII*NP)\nSAV = SAV/(FII*NP)\nIF (SAV.GT.SAVOLD) THEN\nMM = MM + 1\nWRITE(*,*) 'SOMA EM MM POR RESIDUO'\nIF (MM.GE.10) THEN\nWRITE(*,*) 'FALHA NO ALGORITMO DE PROCURA LINEAR-RESIDUO' GO TO 403\nENDIF\nGO TO 710\nENDIF\nIF(IOPT.NE.3) THEN\nCALL CALCPESO(RES,PESO,NP,0)\nELSE\nCALL CALCPESO(RES,PESO,NP,0)\nCALL CALCPESO(RES,PESO,NP,NP)\nENDIF\nWRITE(*,600) ITER\nWRITE(*,605) CON3*SAVOLD,CON3*SAV,CON4*SSR\nFORMATfTlO,'SAVOLD',T24,'SAV',T38,'SSR'/\n*\t4(2X,F12.4))\nWRITE(9,615) ITER,CON4 *SSR,CON 3 *SAV,0.0,\n*\tCON1*ESTK,ESTS,CON2 *ESTC,MM+1\nFORMATflX,13,6(IX,Ell.5),IX,12)\nSAVOLD = SAV\nTOLK = DABS(DELK/OESTK)\nTOLS = DABS(DELS/OESTS)\nTOLC = DABS(DELC/OESTC)\nOESTK = ESTK\nOESTS = ESTS\nOESTC = ESTC\nWRITE(*,610) CON1*ESTK,ESTS,CON2 *ESTC\nITER = ITER + 1\nENDDO\nITER = ITER - 1\nIF(IOPT.EQ.1) THEN\nCALL * LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tESTK,SKIN,ESTC,TEST,N,M,NP,B,RES,2)\nDO 210 I = 1,NP\nWRITE(7,645) TEST(I)/3.6D3,TESP(I)*14.7D0,FUN(I)*14.7D0,\n*\tDP(I)*14.7D0,RES(I)*14.7D0\nCONTINUE\nELSE\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tESTK,SKIN,ESTC,TEST,N,M,NP,Bl,RES,1)\nDO 230 X = 1,NP\nWRITE(7,645) TEST(I)/3.6D3,TESP(I)*14.7D0,RES(I)*14.7D0,\n*\tDP(I)*14.7D0,FUN(I)*14.7D0\n600\n610\n645\n650\n660\nDELK = 10\u00dc.D0*BETA(l)/ESTK\nDELS = 10 0. DCHBETA ( 2) / ESTS\nDELS - 100.D0*BETA(3)/ESTC\nWRITE(8,*)\nIF(IOPT.EQ.l) THEN\nWRITE(8,*) 7REGRESSAG\nELSE IF(IOPT.EQ.2) THEN\nWRITE(8,*)\t7REGRESS\u00c3O\nELSE\nWRITE(8,*) 7REGRESS\u00c3O\nENDIF\nWRITE(8/600)\nWRITE(8,650)\nWRITE(8,660)\nWRITE(9,600)\nWRITE(9,650)\nWRITE(9,660)\nWRITE(*,600)\nWRITE(*,650)\nWRITE(*,660)\nFORMAT(/,IX,7N. ITERACOES\nFORMAT(IX,7K = 7,F15.6/IX,7S\nFORMAT(IX,5(E15.7))\nFORMAT(IX,7 SSR\n*\t1X,'SAV\nFORMAT(IX, 7K =\n*\tIX,7S =\n*\tIX,7c =\nEND\nNOS\tDADOS\tDE\nNOS\tDADOS\tDA\nNOS\tDADOS\tDA\nPRESS\u00c3O.7\nPRESS\u00c3O E DA DERIVADA.7\nITER\nCOM4 *SSR,CON3 *SAV\nCON1*ESTK,DELK,ESTS,DELS,CON2 *ESTC,DELC\nITER\nCON4*SSR,CON3*SAV\nCON1*ESTK,DELK,ESTS,DELS,CON2*ESTC,DELC ITER\nCON4*SSR,CON3*SAV\nCON1*ESTK,DELK,ESTS,DELS,CON2 *ESTC,DELC ,14)\n= 7,F15.6/1X,7C = 7,E15.6)\n= 7,F15.5,2X,/ =7,F15.5,2X,)\n7,F15.6,7\n7,F15.6,7\n',E15.6,7\n+/-7,F6.2,7 V/ +/-\u00edrF6,2r' %f/ +/-7,F6.2, 7 V)\n**********************************************************************\n\u2014 /\nSUBROUTINE CALCPESO(RES,PESO,NP,IN)\nIMPLICIT REAL*8 (A-H,O~Z) DIMENSION RES(1),PESO(1) DO 100 1=1,NP\nAUX = DABS(RES(I+IN))\nIF(AUX.LT.1.D-9) THEN\nPESO(I+IN) = O.DO\nELSE\nPESO(I+IN) = 1.D0/AUX\nENDIF\n100 CONTINUE\nRETURN\nEND\n**********************************************************************\nSUBROUTINE RESIDUO(FUN,TESP,RES,PESO,SSR,WS SR,SAV,NP,IN) IMPLICIT REAL*8 (A-H,O~Z)\nDIMENSION FUN(l),TESP(1),RES(1),PESO(1)\nDO 100 1=1,NP\nRES(I+IN) = TESP(I) - FUN(I)\nSSR = SSR + RES(I+IN)*RES(I+IN)\nWSSR = WSSR + PESO(I+IN)*RES(I+IN)*RES(I+IN)\nSAV = SAV + DABS(RES(I+IN))\n100 CONTINUE\nRETURN\nEND\n**********************************************************************\nIMPLICIT REAL*8 (A-H,O-Z) PARAMETER (NPON=150,NPAR=3)\nCHARACTER*^ ARQUIVO\nLOGICAL MUD\nDIMENSION XY(2*NPON,NPAR+5) ,BETA(NPAR) ,WK(2*NPAR+4) ,IWK(2*NPON) DIMENSION TESP(NPON) jTESTCNPON) , B(NPON, NPAR) ,FUN(NPON) ,RES(2*NPON) DIMENSION A(NPAR,NPAR+1),DELTA(NPAR),PEN(NPAR),PESO(2*NPON),\n*\tAS(NPAR,NPAR+1),Bl(NPON,NPAR),DP(NPON)\nCOMMON /STE/ V(50)\nCONI = 1000.\nCON2 ~ 4.2784403E-7\nCOM3 =14.7\nCON4 = 216.09\nC DADOS DE RESERVATORIO - H(PES), VIS(CP), PHI(PURO), CT(PSI-l),\nC\tQ(STB/D), BO(BBL/STB)\nWRITE(*,*) 'ENTRE COM 0 ARQUIVO DE DADOS.'\nREAD(*,*) ARQUIVO\nOPEN(4,FILE=ARQUIVO,STATUS=\u2019UNKNOWN')\nOPEN(7 , FILE='SAIMLLAV.DAT*,STATUS=*UNKNOWN *)\nOPEN(8,FILE= * LIXO.DAT * tSTATUS= * UNKNOWN *)\nOPEN(9,FILE= * RESMLLAV.DAT*,STATUS=1 UNKNOWN *)\nREAD(4,10) RESH,RESVIS , RESPHI,RESCT,RESRW,RESQ,RES BO, TPROD\n10\tFORMAT(T25,F10.5)\nC\tNUMERO DE PONTOS\nREAD(4,20) NP\n20\tFORMAT(T32,13)\nDO 200 I = 1,NP\nREAD(4,*) TEST(I),TESP(I)\n200\tCONTINUE\nIF (TPROD.NE.0.DO) THEN\nDO 201 I = 1,NP\nTEST(I) = TEST(I)*TPROD/(TEST(I)+TPROD)\n201\tCONTINUE\nEND IF\nC\tVARIAVEIS DE CONTROLE PARA 0 ALGORITMO DE STHEFEST COM 8 CTES\nM = 0\nN = 8\nC\tCONSTANTS INICIAL PARA 0 ALGORITMO DE GAUSS-MARQUARDT\nRLAM = 0.1D0\nC\tZERANDO A MATRIZ AUXILIAR PARA O METODO LAV\nDO 130 I = 1,NP\nDO 120 J = l,NPAR+5 XY(I,J) = 0.D0\n120\tCONTINUE\n130 CONTINUE\nC VARIAVEL DE CONTROLE PARA MUDANCA DE METODO MUD = .FALSE.\nC\tTRANSFORMACOES DE UNIDADE\n'QUAD A FUNCAO A MINIMIZAR ?'\n'1 ~ PRESSAO.'\n'2 - DERIVADA.'\n'3 - PRESS\u00c3O + DERIVADA.' IOPT\nc\n100\n110\n400\nCONTINUE\nWRITE(6?\nWRITE(6,*)\nWRITE(6,*)\nWRITE(6,*)\nREAD(5,*)\nCALL DPDT(TEST,TESP,NP,DP)\nLENDO AS ESTIMATIVAS INICIAIS\nWRITE(6,100)\nFORMAT(IX,'ENTRE COM OS VALORES INICIAIS DE K(D) , S E C(CM3/ATM)') READ(5,*) OESTK,OESTS,OESTC\nWRITE(8,*)\nWRITE{8, *) 'ARQUIVO :',ARQUIVO\nWRITE(8,*)\nWRITE(8,*) 'METODO DE MIN. VAL. ABS. MODIFICADO - MIN. VAL. ABS. ' WRITE(8,*)\nWRITE(8,110) CON1*OESTK,OESTS,CON2 *OESTC\nWRITE(9,110) CON3*OESTK,OESTS,CON2*OESTC FORMAT(3X,'ESTIMATIVAS INICIAIS'//\n*\tIX,'K\t=',F10,5/\n*\tIX,'S\t=',F10.5/\n*\tIX,'C\t=',E10.3)\nSAVOLD = 0.D0\nWSSROLD = 0.D0\nSSR = 0.DO\nDO 400 I = 1,2*NP\nPESO(I) = 0.DO\nCONTINUE\nIF (IOPT.NE.3) THEN\nFIX = 1.0\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,\n*\tOESTK,OESTS,OESTC,TEST, N, M,NP, B,FUN,IOPT)\nIF (IOPT.EQ.1) THEN\nCALL RESIDUO (FUN, TESP, RES, PESO, SSR, WSSROLD, SAVOLD, NP, 0 )\nELSE\nCALL RESIDUO (FUN, DP, RES, PESO, SSR, WSSROLD, SAVOLD, NP, 0)\nENDIF\nCALL CALCPESO(RES,PESO,NP,0)\nELSE\nFXI \u2019\nCALL\n*\nCAUL)\nCALL\n*\n: 2.0\nLAPLACE (RESPHI , RESVIS, RESCT, RESRW, RESH, RESQ,\nOESTK,OESTS,OESTC ,TEST,N,M,NP,B,FUN,1)\nRESIDUO (FUN, TESP, RES, PESO, SSR, WSSROLD, S AVOLD, NP, 0) LAPLACE (RESPHI, RESVIS, RESCT, RESRW, RESH , RESQ,\nOESTK,OESTS,OESTC,TEST,N,M,NP,Bl,FUN,2)\nRESIDUO (FUN, DP, RES , PESO, SSR, WSSROLD, SAVOLD, NP, NP) CALCPESO(RES ,PESO,NP,0)\nCALCPESO(RES,PESO,NP,NP)\nCALL\nCALL\nCALL\nENDIF\nSSR = SSR/(FII*NP)\nSAVOLD = SAVOLD/(FII*NP)\nITMAX =51\nTOL = l.D-3\n410\n420\n430\n440\n500\n405\n411\n505\nC\nC c\nc\n510\n520\nC\nMM - 0\n*\tITMAX.AND.MM.LT.10)\nDO 420 I = 1,NPAR\nDO 410 J = 1/NPAR+l\nA(I,J) = 0. DO\nCONTINUE\nCONTINUE\nDO 500 K = 1,NP\nDO 440 I = 1,NPAR\nDO 430 J = 1,NPAR\nA(I,J) = A(I,J) + PESO(K)*B(K,I)*B(K,J)\nIF(IOPT.EQ.3)\n*\tA(I,J) = A(I,J) + PESO(K+NP)*B1(K,I)*B1(K,J) CONTINUE\nA(I,NPAR+1) = A(I,NPAR+1) + PESO(K)*RES(K)*B(K,I)\nIF (IOPT.EQ.3)\n*\tA(I,NPAR+1) = A(I,NPAR+1) + PESO(K+NP)*RES(K+NP)*\n*\nCONTINUE\nCONTINUE\nIF(M\u00dcD) THEN\nDO 411 K = 1,NP\nDO 406 I = 1,NPAR\nXY(K,I) = B(K,I)\nIF (IOPT.EQ.3) XY(K+NP,I) = B1(K,I)\nCONTINUE\nXY(K,NPAR+1) = -RES(K)\nIF(IOPT.EQ.3) XY(K+NP?NPAR+1) = -RES(K+NP)\nCONTINUE\nNII = FII*NP\nCALL RLLAV (XV, 2*NPON,NII,NPAR,1,BETA,SUMRE,II,IRANK,IWK,\n*\tWK,IER)\nDELK = BETA(l)\nDELS \u00ae BETA(2)\nDELC = BETA(3)\nELSE\nDO 505 I = 1,NPAR\nA(I,NPAR+1) = -A(I,NPAR+1)\nCONTINUE\nINCLUINDO AS FUNCOES PENALIDADES\nK > 0\n-7 &lt;S &lt;20\nC > 0\nPEN(l) = 2.D~5/OESTK**3\nPEN(2) = l.D-2*( DEXP(-OESTS-7.DO) + DEXP(OESTS-2.Dl) )\nPEN(3) = 2.D1/OESTC**3\nDO 510 I = 1,NPAR\nPEN(I) = PEN(I)*NP*FII*WSSROLD/2.DO\nA(I,I) = A(I,I) + PEN(I)\nCONTINUE\nPEN(l) = 1.D-5/OESTK**2\nPEN(2) = l.D-2*( DEXP ('-OESTS-7 . DO) - DEXP (OESTS-2 . Dl) )\ns60\n570\n550\n710\n402\nDO 560 J = L,NPAR AS (I , J) = A (I / J) / DSQ.RT (A (I, I) *A (J} J) ) CONTINUE\nAS(I,NPAR+1) = A(I,NPAR+1)/DSQRT(A(I, I) )\nCONTINUE\nDO 550 I ~ 1,NPAR AS(I,I) = AS(I,I)+RLAM\nCONTINUE\nCALL GAUSS(AS,DELTA,NPAR)\nDELK = DELTA(1)/DSQRT(A(1,1))\nDELS = DELTA(2)/DSQRT(A(2,2))\nDELC = DELTA(3)/DSQRT(A(3,3))\nENDIF\nMMM = 0\nMM - 0\nRO = 0.5D0**MM\nESTK \u00bb OESTK + RO*DELK\nESTS = OESTS + RO*DELS\nESTC ~ OESTC 4- RO*DELC\nIF(ESTK.LE.0.DO.OR.ESTC.LT.0.DO) THEN\nMM = MM + 1\nWRITE(*,*) 'SOMA EM MM FOR LIMITE' IF (MM.GE.10) THEN\nWRITE(*,*) 'FALHA NO ALGORITMO DE PROCURA LINEAR-LIMITE' GO TO 402\nENDIF\nGO TO 710\nENDIF\nIF (ESTS.LT.0.DO) THEN\nIF(ESTS.LT.-7,DO) ESTS = ~7 . DO\nRESRWE = RESRW*DEXP(-ESTS)\nSKIN = 0,00\nELSE\nRESRWE = RESRW\nSKIN = ESTS\nENDIF\nSAV \u00ab 0.DO\nWSSR = 0. DO\nSSR = 0.D0\nIF(IOPT.NE.3) THEN\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tESTK,SKIN,ESTC,TEST,N,M,NP,B,FUN,IOPT) IF(IOPT.EQ.1) THEN\nCALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSR,SAV,NP,0) ELSE\nCALL RESIDUO(FUN,DP,RES,PESO,SSR,WSSR,SAV,NP,0) ENDIF\nELSE\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tESTK,SKIN,ESTC,TEST,N,M,NP,B,FUN,1)\nCALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSR,SAV,NP,0) CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tESTK,SKIN,ESTC,TEST,N,M,NP,Bl,FUN,2)\nCALL RESIDUO(FUN,DP,RES,PESO,SSR,WSSR,SAV,NP,NP)\nENDIF\nSAV = SAV/(FII*NP)\nWSSR = WSSR/(FII*NP)\nSSR = SSR/(FII*NP)\nIF (SAV.GT.SAVOLD) THEN\n403\nCALCPESO(RES,PESO,NP,0)\nCALCPESO(RES , PESO,NP,0) CALCPESO(RES,PESO,NP,NP)\n605\n*\n*\n615\n*\nMM = MM + 1\nWRITE(*,*) 'SOMA EM MM FOR RESIDUO'\nIF (MM,GE.10) THEN\nGO TO 403\nENDIF\nGO TO 710\nENDIF\nIF(IOPT.NE.3) THEN\nCALL\nELSE\nCALL\nCALL\nENDIF\nIF (MMM.EQ.l) THEN\nRLAM = RLAM*10.DO\nELSE\nRLAM = RLAM/10.D0\nENDIF\nWRITE(*,600) ITER\nWRITE(*,605) CON3*SAVOLD,CON3*S AV,CON3 *WSSR,CON4*SSR FORMAT(T10,'SAVOLD',T24,'SAV',T38,'WSSR',T52,'SSR'/ 4(2X,F12.4))\nWRITE(9,615) ITER,CON4 *SSR,CON3 *SAV,0.0, CON1*ESTK,ESTS,CON2*ESTC,MM+1\nFORMAT(IX,13,6(IX,Ell.5),1X,I2)\nWSSROLD = WSSR\nSAVOLD = SAV\nTOLK = DABS(DELK/OESTK)\nTOLS = DABS(DELS/OESTS)\nTOLC = DABS(DELC/OESTC)\nIF (TOLK.LE.O.1.AND.TOLS.LE.0.1.AND.TOLC.LE.0.1.AND..NOT.MUD. AND.ITER.GT.2) THEN\nMUD\nWRITE(*,*)\nWRITE(*,*)\nWRITE(*,*)\nWRITE(*,*)\nWRITE(*, *)\nENDIF\nWRITE(*,610) CONI*ESTK,ESTS,CON2*ESTC\nOESTK = ESTK\nOESTS = ESTS\nOESTC = ESTC\nPAUSE\nITER = ITER + 1\nENDDO\nITER = ITER\nIF\n.TRUE.\n****************\t*************** >\n\u2022*************** MUDOU ***************' * ***************\t***************z\nf * * * ** it * * ** * * if* ** * * * * * * * * ** * ** * * * ***** ** *\nC\n1\n(IOPT.EQ.1) THEN\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ, ESTK,SKIN,ESTC,TEST,N tM , NP,B,RES,2)\n*\nDO\n\nCONTINUE\nENDIF\n220\n: FII*NP\nINTERV(A,DELTA,WSSR,Nil) = 100.DO*DELTA(1)/ESTK = 100.D0*DELTA(2)/ESTS = 100.D0*DELTA(3)/ESTC\n600\n610\n640\n650\n660\nNil \u25a0\u25a0\nCALL\nDELK\nDELS\nDELC\nWRITE(8,*)\nIF(IOPT.EQ.l) THEN\nWRITE(8 , *) \u2022REGRESS\u00c3O\nELSE IF(IOPT.EQ.2) THEN\nWRITE(8 , *)\t'REGRESS\u00c3O\nELSE\nWRITE(8,*) 1 REGRESS\u00c3O\nENDIF\nWRITE(8,600)\nWRITE(8,650)\nWRITE(8,660) WRITE(*,600)\nWRITE(*,650)\nWRITE(*,660)\nFORMAT(/,IX,'N. ITERACOES FORMAT(1X,'K = ',F15.6/1X FORMAT(IX,5(E15\u20227))\nFORMAT(1X,'WSSR\n*\t1X,'SSR\n*\tIX,'SAV FORMAT(1X,'K =\n*\n*\nEND\nNOS DADOS DE PRESSAO.'\nNOS DADOS DA DERIVADA DA PRESSAO.'\nNOS DADOS DA PRESSAO E DA DERIVADA.'\nITER\nCON4*SSR,CON3*SAV\nCON1*ESTK,DELK,ESTS,DELS,CON2*ESTC,DELC\nITER\nCON3 *WSSR,CON4 *SSR,CON3 *SAV\nCON 1*ESTK, DELK,ESTS, DELS, CON2*ESTC, DELC\n,14)\n,'S = ',F15.6/1X,'C = ',E15.6)\n\u2014. f\nIX,'S \u00bb \u2022 IX,'C = \u00bb\n\u2014 f\nf /\n,F15Z.6, ' ,F15.6,' ,E15.6,'\n,F15.5,2X,/\n,F15.5,2x,/\nF15.5,2x,)\n+/-',F6.2,' V/\n+/-\u2022,F6.2,\u2019 %'/\n+/-',16.2t' %')\n**********************************************************************\nSUBROUTINE CALCPESO(RES,PESO,NP,IN)\nIMPLICIT REAL*8 (A-H,O-Z)\nDIMENSION RES(l),PESO(1)\nDO 100 1=1,NP\nAUX = DABS(RES(I+IN))\nIF(AUX.LT.1.D-9) THEN\nPESO(I+IN) = 0.D0\nELSE\nPESO(I+IN) \u00ae 1.D0/AUX\nENDIF\n100 CONTINUE\nRETURN\nEND\n**********************************************************************\nSUBROUTINE RESIDUO(FUN,TESP,RES,PESO,SSR,WSSR,SAV, NP, IN) IMPLICIT REAL*8 (A-H,O-Z)\nDIMENSION FUN(1),TESP(1) ,RES(1),PESO(1)\nDO 100 1=1,NP\nRES(I+IN) = FUN(I) - TESP(I)\nSSR ~ SSR + RES(I+IN)*RES(I+IN)\nWSSR = WSSR + PESO(I+IN)*RES(I+IN)*RES(I+IN)\nSAV = SAV + DABS(RES(I+IN))\n100 CONTINUE\nRETURN\nEND\nA \u2605 ir x &amp; st\tx\nG*********************************************************************** c**** Utiliza as bilbilotecas de resolu\u00e7\u00e3o de sistemas de equa\u00e7\u00f5es c**** sobredeterminado (Decomposi\u00e7\u00e3o em valores singulares) da c**** biblioteca Numerical Recipes.\nIMPLICIT REAL*8 (A-H,O~Z) PARAMETER (NPCN=150,NPAR=3) CHARACTER*12 ARQUIVO DIMENSION TESP(NPON),TEST(NPON),B(NPON,NPAR),FUN(NPON),\n*\tDELTA(NPAR),U(2*NPON,NPAR),W(NPAR),VI(NPAR,NPAR)\n*\tDP(NPON),BI(NPON,NPAR),RES(2*NPON)\nCOMMON /STE/ V(50)\nCON1 = 1000.\nCOM2 = 4.2784409E-7\nCON3 =14.7\nCOM4 = 216.09\nDADOS DE RESERVAT\u00d3RIO - H(PES), VIS(CP), PHI(PURO), CT(PSI-l)t\nQ(STB/D) , BO(BBL/STB)\nWRITE(*,*) \"ENTRE COM O ARQUIVO DE DADOS\"\nREAD(*,*) ARQUIVO\nopen(4,fi1 e\u00bb ARQUIVO,status\u00ae\" unknown\")\nopen(7 ffile\u00ae\"SAISVD.DAT\",status\u00ae\"unknown')\nopen (8, file=\"RESSVD.DAT\", status\u00ae\"unknown\")\nREAD(4,10) RESH,RESVIS ,RES PHI,RESCT,RESRW,RESQ,RESBO,TPROD\nFORMAT(T25,F10.5)\nREAD(4,20) NP\nFORMAT(T32,13) DO 100 1=1,NP\nREAD(4,*) TEST(I),TESP(I)\nCONTINUE\nVARIAVEIS DE CONTROLE PARA 0 ALGORITMO DE STHEFEST COM 8 CTES M = 0 N = 8 TRANSFORMA\u00c7\u00d5ES DE UNIDADE\nRESCT = RESCT*14.7D0\nRESQ = RESQ*RESBO*1.84DO\nRESRW\nRESH =\nDO 300 I =\nTEST(I)\nTESP(I) CONTINUE\nWRITE(6,*)\nWRITE(6,*)\nWRITE(6, *)\nWRITE(6,*)\nREAD(5,*) IOPT\nCALL DPDT(TEST,TESP,NP,DP)\nLENDO AS ESTIMATIVAS INICIAIS\nWRITE(6,*)\n*\t\"ENTRE COM OS VALORES INICIAIS DE K(D), S E C(CM3/ATM)\" READ(5,*) OESTK,OESTS,OESTC\nWRITE(8,105) CON1*OESTK,OESTS,CON2*OESTC\nFORMAT(3X,\"ESTIMATIVAS INICIAIS\"//\n*\tIX,\"K\t=\n*\tix,\"S\n*\tIX, \" C\t=\nc c\n10\n20\n100 c\nC\n300\n\u25a0 RESRW*2.54D0\nRESH*30.48D0\n1,NP\n= TEST(I)*3.6D3 = TESP(I)/14.7DO\n\"QUAL\tA FUNCAO A\tSER\tMINIMIZADA ?\"\n\"\t1\t-\tPRESS\u00c3O.\"\n\u2022\t2\t-\tDERIVADA.\"\n\"\t3\t-\tDERIVADA +\tPRESS\u00c3O.\"\n\nc\n***** ******* *******\nrs >\n\u2014 Z\n,F10.5/\n,FIO.5/\n,E10.3)\nIF(IOPT.NE.3) THEN Nil = 1 CALL LAPLACE (RESPHI, RES VIS , RESCT , RESRW, RESH, RESQ ,\n*\tOESTK,OESTStOESTC,TEST,NtM,NP, B tFUN,IOPT) IF(IOPT.EQ.l) THEN\nDO 110 I = 1,NP RES(I) - TESP(I) - FUN(I) SSROLD = SSROLD + RES(I)*RES(X) AUX1 = DABS(RES(1)) SAV = SAV + AUX1\n110\tCONTINUE\nELSE\nDO 111 I = 1,NP RES(I) = DP(I) - FUN(I) SSROLD = SSROLD + RES(I)*RES(I) AUX1 = DABS(RES(I)) SAV = SAV + AUX1\n111\tCONTINUE\nENDIF SSROLD = SSROLD/NP SAV = SAV/NP\nELSE\nNil = 2\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,\n*\tOESTK,OESTS,OESTC,TEST,N,M,NP,B,FUN,1)\nDO 112 I = 1,NP RES(I) = TESP(I) - FUN(I) SSROLD = SSROLD + RES(I)*RES(I) AUX1 = DABS(RES(I)) SAV = SAV + AUX1\n112\tCONTINUE\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,\n*\tOESTK,OESTS,OESTC,TEST,N,M,NP,Bl,FUN,2) DO 113 I - 1,NP\nRES(I+NP) = DP(I) - FUN(I) SSROLD = SSROLD + RES(I+NP)*RES(I+NP) AUX1 = DABS(RES(I+NP))\nSAV = SAV + AUX1\n113\tCONTINUE\nSSROLD = SSROLD/NP/2.0 SAV = SAV/NP/2.0\nENDIF\nWRITE(8,615) 0,CON4 *SSROLD,CON3 *SAV,0.0,\n*\tCON1*OESTK,OESTS,CON2*OESTC,0\nITMAX = 51\nTOL = l.D-3\nTOLK = 1.D0\nTOLS = 1.D0\nTOLC = 1.D0\nITER = 0\nMM = 0\nDO WHILE((TOLK.GT.TOL<OR.TOLS.GT.TOL.OR.TOLC.GT.TOL).AND.ITER.LT.\n*\titmax.and.mm.lt.10)\n410\n420\nCONTINUE\nCONTINUE\n710\n502\n400\n401\n*\n*\nMM = 0\nRO = .5D0**MM\nESTK = OESTK + RO*DELK\nESTS = OESTS + RO*DELS\nESTC = OESTC + RO*DELC\nIF (ESTK.LE.0.DO.OR.ESTC.LT.0.DO) THEN\nMM \u00ab MM + I\nWRITE(*,*) 'SOMA POR LIMITS'\nIF (MM.GT.20) THEN\nWRITE(*,*) 'FALHA POR LIMITE'\nGO TO 502\nENDIF\nGO TO 710\nENDIF\nIF (ESTS.LT.0.DO) THEN\nRESRWE = RESRW*DEXP(-ESTS)\nSKIN = 0.DO\nELSE\nRESRWE = RESRW\nSKIN = ESTS\nENDIF\nSSR = 0 . DO\nSAV =0.00\nIF(IOPT.NE.3) THEN\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ, ESTK,SKIN,ESTC,TEST,N,M,NP,B,FUN,IOPT)\nIF(IOPT.EQ.l) THEN\nDO 400 I = 1,NP\nRES(I) = TESP(I) - FUN(I)\nAUX1 = DABS(RES(I))\nSSR = SSR + RES(I)*RES(I)\nSAV = SAV + AUX1\nCONTINUE\nELSE\nDO 401 I = 1,NP\nRES(I) = DP(I) - FUN(I)\nAUX1 = DABS(RES(I))\nSSR = SSR + RES(I)*RES(I)\nSAV = SAV + AUX1\nCONTINUE\nENDIF\nSSR = SSR/NP\nSAV = SAV/NP\nELSE\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ, ESTK,SKIN,ESTC,TEST,N,M,NP,B,FUN,1)\nDO 402 I = 1,NP\nRES(I) = TESP(I) - FUN(I)\nAUX1 = DABS(RES(I))\nSSR = SSR + RES(I)*RES(I)\nSAV = SAV + AUX1\nCONTINUE\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tESTK,SKIN,ESTC,TEST,N,M,NP,Bl,FUN,2)\nDO 403 I = 1,NP\nRES(I+NP) = DP(I) - FUN(I) AUX1 = DABS(RES(I+NP))\nSSR = SSR + RES(I+NP)*RES(I+NP)\nSAV = SAV + AUX1\n403\tCONTINUE\nSSR = SSR/NP/2.0\nSAV = SAV/NP/2.0\nENDIF\nIF (SSR,GT.SSROLD) THEN\nMM = MM + 1\nWRITE(*,*) 'SOMA POR RESIDUO'\nIF (MM.GT.10) THEN\nWRITE(*,*) 'FALHA POR RESIDUO'\nGO TO 501\nENDIF\nGO TO 710\nENDIF\n501\tWRITE(8,615) ITER,CON4*SSR,CON3*SAV,0.0,\n*\tCON1*ESTK,ESTS,CON2*ESTC,MM+1\n615\tFORMAT(1X,13,6(1X,E11.5),1X,I2)\nTOLK = DABS(DELK/OESTK)\nTOLS = DABS(DELS/OESTS)\nTOLC = DABS(DELC/OESTC)\nWRITE(*,600) ITER\nWRITE(*,*) CON4*SSROLD,COM4*SSR\nWRITE(*,610) CONI*DELK,DELS,CON2*DELC\nWRITE(*,610) CON1*ESTK,ESTS,CON2*ESTC\nOESTK = ESTK\nOESTS = ESTS\nOESTC = ESTC\nSSROLD = SSR\nENDDO\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tESTK,SKIN,ESTC,TEST,N,M,NP,Bl,RES,2) DO 620 I = 1,NP\nWRITE(7,640) TEST(I)/3.6D3,TESP(I)*14.7D0,FUN(I)*14.7D0,\n*\tDP(I)*14.7,RES(I)*14.7\n620 CONTINUE\nWRITE(*,600) ITER\nWRITE(*,*) CON4*SSR,CON3*SAV\nWRITE(*,610) CONI*ESTK,ESTS,CON4*ESTC\n600\tFORMAT(/,IX,'N. ITERACOES =',I4)\n610\tFORMAT(2(IX,F15.6/),1X,E15.6)\n640 FORMAT(1X,5(E15.7))\nEND\n*********************************************************************\nRegress\u00e3o nao linear com o m\u00e9todo de Nelder-Mead's para ******* um modelo de reservat\u00f3rio radial infinito\t*******\n*******\n\u00a3* * * * Citi * C*** * q**** Q-iklekit\nc c\n10\n20\n1G0\n101\nc\nc\n300\n*******\n*******\nIMPLICIT REAL*8 (A-H,O-Z)\nPARAMETER (NP0N=150,NPAR=3)\nCHARACTER*12 ARQUIVO\nDIMENSION RESVAR(NPAR,NPAR+1) ,SAV(NPAR+1) , RMED(NPAR) ,R(NPAR)\nDIMENSION DPl(NPON),PARKED(NPAR)\nCOMMON COMMON COMMON CONI = CON 2 = CON 3 = CON 4 =\t/STE/ V(50),M,N /DADOS/ RESH, RESVIS , RESPHI, RESCT, RESRW, RESQ, RESBO, TPROD /PRES/ TEST(NPON),TESP(NPON),FUN(NPON),DP(NPON) 1000. 4.2784409E-7 14.7 216.09\nTOL = 1.0-7\nIMIN = 10\nIMAX =300\nIT = 0\nWRITE(*,*) 'ENTRE COM 0 ARQUIVO DE DADOS'\nREAD(*,*) ARQUIVO\nopen(4,file=ARQUIVO,status='unknown')\nopen(7,file='SAINM.DAT',status='unknown')\nopen(8,file='RESNM.DAT',status='unknown')\nDADOS DE RESERVATORIO - H(PES), VIS(CP), PHI(PURO), CT(PSI-l),\nQ(STB/D), BO(BBL/STB)\nREAD (4,10) RESH, RESVIS, RESPHI, RESCT, RESRW, RESQ, RESBO, TPROD FORMAT(T25,F10.5)\nREAD(4,20) NP\nFORMAT(T32,13)\nDO 100 1=1,NP\nREAD(4,*) TEST(I),TESP(I)\nCONTINUE\nCALL DPDT(TEST,TESP,NP,DP)\nIF(TPROD,NE.0.DO) THEN\nDO 101 I = 1, NP\nTEST(I) = TEST(I)*TPROD/(TEST(I)+TPROD)\nCONTINUE\nENDIF\nVARIAVEIS DE CONTROLS PARA 0 ALGORITMO DE STHEFEST COM 8 CTES\nM = 0\nN = 8\nTRANSFORMA\u00c7\u00d5ES DE UNIDADE\nRESCT = RESCT*14.7D0\nRESQ = RESQ*RESBO*1.84DO\nRESRW = RESRW*2.54D0\nRESH = RESH*30.48D0\nDO 300 I =\nTEST(I)\nTESP(I)\nDP(I) = CONTINUE WRITE(6,*) WRITE(6, *) WRITE(6,*)\n1,NP\n= TEST(I)*3.6D3\n= TESP(I)/14.7DO\nDP(I)/14.7D0\n'QUAL A FUNCAO A MINIMIZAR ?' ' 1 - PRESS\u00c3O,'\n' 2 - DERIVADA.'\nWRITE(*,*) 'ENTRE AS ESTIMATIVAS INICIAIS DE K, S E C.1\nDERIVADA + PRESS\u00c3O.!\nREAD(*,*) A,B,C\t\t\nRESVAR(1,1) =\tDLOGIO(A)\t\nRESVAR(1,2) =\tRESVAR(1,1) +\t0.5\nRESVAR(1,3) =\tRESVAR(1,1) +\t1.0\n.RESVAR(1,4) =\tRESVAR(1,1) +\t0.5\nRESVAR(2,1) =\tB\t\nIF(RESVAR(2,1)\t.LT.15.0) THEN\t\nRESVAR(2,2)\t= RESVAR(2,1)\t+ 5.0\nRESVAR(2,3)\t= RESVAR(2,1)\t- 1.0\nRESVAR(2,4)\t= RESVAR(2,1)\t+ 5.0\nELSE\t\t\nRESVAR(2,2)\t= RESVAR(2,1)\t- 5.0\nRESVAR(2,3)\t= RESVAR(2,1)\t- 1.0\nRESVAR(2,4)\t= RESVAR(2,1)\t- 5.0\nENDIF\t\t\nRESVAR(3,1) =\tDLOGIO(C)\t\nRESVAR(3,2) =\tRESVAR(3,1)\t\nRESVAR(3,3) =\tRESVAR(3,1)\t\nRESVAR(3,4) =\tRESVAR(3,1) +\t1.0\nDO 105 J = 1,NPAR+1\t\t\nIF(RESVAR(2,J).LT.O.DO) THEN\nRESRWE = RESRW*DEXP(-RESVAR(2,J))\nSKIN = 0.D0\nELSE\nRESRWE = RESRW\nSKIN = RESVAR(2,J)\nEND IF\nIF(IOPT.NE.3) THEN\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tRESVAR(1,J),SKIN,RESVAR(3,J),TEST,NP,FUN,IOPT)\nSAV(J) = 0.D0\nDO 110 I = 1,NP\nIF(IOPT.EQ.1) THEN\nRES = FUN(I) - TESP(I)\nELSE\nRES = FUN(I) - DP(I)\nENDIF\nAUX1 = DABS(RES) SAV(J) = SAV(J)+ AUX1\n110\tCONTINUE\nSAV(J) = SAV(J)/NP ELSE\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tRESVAR(1,J),SKIN,RESVAR(3,J),TEST,NP,FUN,1)\nSAV(J) =0.00\nDO 111 I = 1,NP\nRES = FUN(I) - TESP(I)\nAUX1 = DABS(RES)\nSAV(J) = SAV(J)+ AUX1\n111\tCONTINUE\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tRESVAR(1,J),SKIN,RESVAR(3,J),TEST,NP,FUN,2)\nDO 112 I = 1,NP\nRES = FUN(I) - DP(I)\n112\n105\n302\n301\n303\n880\n890\n900\nAUX1 = DABS(RES)\nSAV(J) = SAV(J)+ AUX1 CONTINUE\nSAV(J) \u00ab- SAV(J)/(2*NP) ENDIF\nCONTINUE\nCALL ORDER(SAV,ILO,ILI,IHI, IHO)\nDO 301 I = 1,NPAR+T\nWRITE(*,302) CON1*10.DO**RESVAR(1,I),RESVAR(2,I),\n*\tCON2*10.D0**RESVAR(3,I),CON3*SAV(I) FORMAT(3(1X,E12.5),' FUN= ',E12.5)\nCONTINUE\nWRITE(*,*)\nDO WHILE( (SAV(IHI).GT.SAV(ILO)+TOL.AND.IT.LT.IMAX).OR.\n*\t(IT.LT.IMIN) )\nCALL NEWPOINTS(RESVAR,IHI,RMED,R,SAVLIN,NP,IOPT)\nCALL IMPROVE(RESVAR,SAVtRMED,RfSAVLIN,ILO,ILI,IHO,IHI,NP,IOPT) CALL ORDER(SAV,ILO,ILI,IHI,IHO)\nDO 303 I = 1,NPAR+1\nWRITE(*,302) CON1*10.D0**RESVAR(1,I),RESVAR(2,I),\n*\tCON2 *10.DO * *RESVAR(3,1),CONS *SAV(I) CONTINUE\nWRITEf*,*) WRITE(8,880) IT,CON3*SAV(ILO),CON1*10.D0**RESVAR(1,ILO),\n*\tRESVAR(2,ILO),CON2*10.D0**RESVAR(3,ILO) FORMAT(IX,13,4(E16.8))\nIT = IT 4- 1\nENDDO\nWRITE(*,302) CON1*10.DO**RESVAR(1,ILO),RESVAR(2,ILO),\n*\tCON2*10.D0**RESVAR(3,ILO),CON3 *SAV(ILO)\nIF(RESVAR(2,ILO).LT.0.DO) THEN\nRESRWE = RESRW*DEXP(-RESVAR(2,IL0))\nSKIN = 0.D0\nELSE\nRESRWE = RESRW\nSKIN = RESVAR(2,ILO)\nENDIF\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tRESVAR(1,ILO),SKIN,RESVAR(3,ILO),TEST,NP,FUN,1)\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tRESVAR(1,ILO),SKIN,RESVAR(3,ILO),TEST,NP,DPI,2) SSR \u00bb 0.D0\nIF(IOPT.EQ.l) THEN\nDO 890 I = 1,NP\nSSR \u00ab SSR + (FUN(I)-TESP(I))**2\nCONTINUE\nSSR \u00ab SSR/NP\nELSE IF(IOPT.EQ.2) THEN\nDO 900 I = 1,NP\nSSR - SSR + (DPI(I)-DP(I))**2\nCONTINUE\nSSR = SSR/NP\nELSE\nDO 920 I = 1,NP\nSSR - SSR + (FUN(I)-TESP(I))**2\nSSR = SSR + (DPI(I)~DP(I))**2\nCONTINUE\nSSR - SSR/(2*NP)\nENDIF\nWRITE(*,910) IT,CON3*SAV(ILO),CON4*SSR\n910\tFORMAT(IX,'ITER\t-',13/\n\t*\tIX,'SAV\t=',E12.6/\n\t*\tIX,'SSR\t=',E12.6)\n\tDO 400 I \u00ae 1,NP\t\n\tWRITE(7,500)\tTEST(I)/3.6D3,TESP(I)*14.7D0,FUN(I)*14.7D0,\n\t*\tDP(I)*14.7,DPI(I)*14.7\n500\tFORMAT(IX,5E15.7)\t\n400\tCONTINUE\t\n\tEND\t\n*4*4**44*44***444*4******4*4A44**4*4444************444**44**4444444444\nSUBROUTINE ORDER(Y,ILO,ILI,IHI,IHO)\nIMPLICIT REAL*8 (A-H.O-Z)\nPARAMETER (NPAR=3)\nDIMENSION Y(l)\nILO = 1\nIHI - 1\nDO 100 J = 2,NPAR+1\nIF(Y(J).LT.Y(ILO)) ILO ~ J\nIF(\u00a5(J).GT.Y(IHI)) IHI = J\n100 CONTINUE\nILI = IHI\nIHO - ILO\nDO 200 J \u00bb 2,NPAR+1\nIF(J.NE.ILO.AND.\u00a5(J).LT.Y(ILI)) ILI = J IF(J.NE.IHI.AND.Y(J).GT.Y(IHO)) IHO = J\n200 CONTINUE\nRETURN\nEND\n**********************************************************************\nSUBROUTINE NEWPOINTSfRESVAR,IHI,RMED,R, SAVLIN,NP, IOPT)\nIMPLICIT REAL*8 (A-H,O-Z)\nPARAMETER (NPON=150,NPAR=3)\nCOMMON /STE/ V(50),M,N\nCOMMON /DADOS/ RESH,RESVIS,RESPHI,RESCT,RESRW, RESQ,RESBO,TPROD\nCOMMON /PRES/ TEST(NPON) ,TESP(NPON) , FUN(NPON) , DP(NPON) DIMENSION RESVAR(NPAR,NPAR+1) ,RMED(1) ,R(1) , DELTA (NPAR)\nDO 200 K=^1,NPAR\nS - O.DO\nDO 100 J=1,NPAR+1\nS = S + RESVAR(K,J)\n100\tCONTINUE\nRMED(K) - (S - RESVAR(K,IHI))/NPAR\nDELTA(K) = RMED(K) - RESVAR(K,IHI)\n200 CONTINUE\nDO 400 I~1,NPAR\nR(I) = RMED(I) + DELTA(I)\n400 CONTINUE\nMM \u00ab 1\nDO WHILE ( (R(2) .LT.-10.0.OR.R(2) .GT.30.0) .AND.MM.LT.il ) RHO = 0.5**MM\nDO 440 I = 1,NPAR\nR(I) = RMED(I) + RHO*DELTA(I)\n440\tCONTINUE\nMM ~ MM + 1\nIF(MM.GT.IO) THEN\nIF(R(2).LT.-10.0) R(2) \u00ab -10.0\nIF(R(2).GT.30.0) R(2) - 30.0\nENDIF\nEND EX)\nIF(R(2).LT.O.DO) THEN\nRESRWE - RESRW*DEXP(-R(2))\nSKIN = O.DO\nELSE\nRESRWE = RESRW\nSKIN = R(2)\nENDIF\nIF(IOPT.NE.3) THEN\nCALL LAPLACE(RESPHI , RESVIS, RESCT, RESRWE, RESH, RESQ,\n*\tR(l),SKIN,R(3),TEST,NP,FUN,IOPT)\nSAVLIN = O.DO\nDO 110 I = 1,NP\nIF(IOPT.EQ.1) THEN\nRES = FUN(I) - TESP(I)\nELSE\nRES \u00bb FUN (I) - DP(I)\nENDIF\nAUX1 \u00ab DABS(RES)\nSAVLIN = SAVLIN+ AUX1\n110\tCONTINUE\nSAVLIN = SAVLIN/NP\nELSE\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tR(l),SKIN,R(3),TEST,NP,FUN,1)\nSAVLIN = O.DO\nDO 111 I = 1,NP\nRES = FUN(I) - TESP(I)\nAUX1 = DABS(RES)\nSAVLIN = SAVLIN+ AUX1\n111\tCONTINUE\nCALL LAPLACE (RESPHI,RESVIS, RESCT,RESRWE,RESH, RESQ,\n*\tR(l),SKIN,R(3),TEST,NP,FUN,2)\nDO 112 I = 1,NP\nRES = FUN(I) - DP(I)\nAUX1 = DABS (RES)\nSAVLIN = SAVLIN+ AUX1\n112\tCONTINUE\nSAVLIN \u00ab SAVLIN/(2*NP)\nENDIF\nRETURN\nEND\n**********************************************************************\nSUBROUTINE SHRINK(RESVAR,SAV,ILO,NP,IOPT)\nIMPLICIT REAL*8 (A-H,O-Z)\nPARAMETER (NPON-150,NPAR=3)\nDIMENSION RESVAR(NPAR,NPAR+1),SAV(1)\nCOMMON /STE/ V(50),M,N\nCOMMON /DADOS/ RESH, RESVIS, RES PHI, RESCT, RESRW, RESQ, RESBO,TPROD\nCOMMON /PRES/ TEST(NPON),TESP(NPON),FUN(NPON),DP(NPON)\nDO 200 J = 1,NPAR+1\nIF(J.NE.ILO) THEN\nDO 100 K = 1,NPAR\nRESVAR(K,J) = ( RESVAR(K,J) + RESVAR(K, ILO) )/2.D0\n100\tCONTINUE\n*\tRESVAR(1,J),SKIN,RESVAR(3,J),TEST,NP,FUN,IOPT) DO 110 I = 1,NP\nIF(IOPT.EQ.1) THEN\nRES = FUN(I) - TESP(I) ELSE\nRES - FUN (I) - DP (I) ENDIF\nSAV(J) = SAV(J) + DABS(RES)\n110\tCONTINUE\nSAV(J) = SAV(J)/NP\nELSE\nCALL LAPLACE (RESPHI,RESVIS,RESCT, RESRWE, RESH, RESQ,\n*\tRESVAR(1,J),SKIN,RESVAR(3,J),TEST,NP,FUN,1)\nDO 111 I = 1,NP\nRES = FUN(I) - TESP(I)\nSAV(J) ~ SAV(J) + DABS(RES)\n111\tCONTINUE\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tRESVAR(1,J),SKIN,RESVAR(3,J),TEST,NP,FUN,2)\nDO 112 I = 1,NP\nRES = FUN(I) - DP(I)\nSAV(J) = SAV(J) + DABS(RES)\n112\tCONTINUE\nSAV(J) = SAV(J)/(2*NP)\nENDIF\nENDIF\n200 CONTINUE\nRETURN\nEND **********************************************************************\nSUBROUTINE IMPROVE(RESVAR,SAV,RMED,R,SAVLIN,ILO,ILI,IHO,IHI,\n*\tNP,IOPT)\nIMPLICIT REAL*8 (A-H,O-Z)\nPARAMETER (NPON=150,NPAR=3)\nDIMENSION RESVAR(NPAR,NPAR+1) ,SAV(1) ,RMED(1) ,R(1) ,E(NPAR)\nCOMMON /STE/ V(50),M,N\nCOMMON /DADOS/ RESH,RESVIS,RESPHI,RESCT,RESRW,RESQ,RESBO,TPROD COMMON /PRES/ TEST(NPON),TESP(NPON),FUN(NPON),DP(NPON) IF(SAVLIN.LT.SAV(IHO)) THEN\nIF(SAV(ILI) . LT.SAVLIN) THEN\nDO 100 I = 1,NPAR\nRESVAR(I,IHI) = R(I)\n100\tCONTINUE\nSAV(IHI) = SAVLIN\nELSE\nDO 110 I=1,NPAR\nE(I) - R(I) + R(I) \u201c RMED(I)\n110\tCONTINUE\nMM ~ 1\nDO WHILE ( (E(2)-LT.-10.0.0R.E(2).GT.30.0) .AND.MM.LT.il ) RHO = 0.5**MM\nDO 440 I \u00ab 1,NPAR\nE(I) - R(I) + RHO*( R(I) - RMED(I) )\n440\tCONTINUE\nMM = MM + 1\nIF(MM.GT.10) THEN\nIF(E(2).LT.-10.0) E(2) =\n30.0\n120\n121\n122\n130\n140\nIF(E(2).GT.30.0) E(2) =\nENDIF\nIFfDABS (RESVAR(2,1) -RESVAR(2,2) ).LT.1.D5\n*\t.AND. DABS(RESVAR(2,2)-RESVAR(2,3)) .LT.1.D5\n*\t.AND. DABS(RESVAR(2,3)-RESVAR(2,4)).LT.1.D5)\n*\tRESVAR(2,1) = 0.5*RESVAR(2,l)\nENDDO\nIF(E(2).LT.O.DO) THEN\nRESRWE = RESRW*DEXP(-E(2))\nSKIN = O.DO\nELSE\nRESRWE ~ RESRW\nSKIN = E(2)\nENDIF\nIF(I0PT.NE.3) THEN\nCALL LAPLACE(RESPHI,RES VIS r RESCT tRESRWE,RESH,RESQ,\n*\tE(l),SKIN,E(3),TEST,NP,FUN,IOPT)\nSAVLI1 = O.DO\nDO 120 I = 1,NP\nIF(IOPT.EQ.l) THEN\nRES - FUN(I) - TESP(I)\nELSE\nRES = FUN(I) - DP(I)\nENDIF\nSAVLI1 = SAVLI1 + DABS(RES)\nCONTINUE\nSAVLI1 = SAVLI1/NP\nELSE\nCALL LAPLACE(RESPHI,RESVIS, RESCT,RESRWE,RESH,RESQ,\n*\tE(l),SKIN,E(3),TEST,NP,FUN,1)\nSAVLI1 \u201cO.DO\nDO 121 I = 1,NP\nRES = FUN(I) - TESP(I)\nSAVLI1 = SAVLI1 + DABS(RES)\nCONTINUE\nCALL LAPLACE (RESPHI,RESVIS, RESCT, RESRWE, RESH, RESQ,\n*\tE(l),SKIN,E(3),TEST,NP,FUN,2)\nDO 122 I = 1,NP\nRES = FUN(I) - DP(I)\nSAVLI1 = SAVLI1 + DABS(RES)\nCONTINUE\nSAVLI1 = SAVLI1/(2*NP)\nENDIF\nIF (SAVLI1.LT.SAV(ILI)) THEN\nDO 130 I = 1,NPAR\nRESVAR(I,IHI) \u00ab E(I)\nCONTINUE\nSAV(IHI) - SAVLI1\nELSE\nDO 140 I \u00ae 1,NPAR RESVAR(I,IHI) = R(I)\nCONTINUE\nSAV(IHI) = SAVLIN\nSAV(IHI) \u00ab SAVLIN\nENDIF\nDO 160 I=1,NPAR\nE(I) = (RESVAR(I, IHI) + RMED(I))/2.DO\n160\tCONTINUE\nIF(E(2).LT.O.DO) THEN\nRESRWE = RESRW*DEXP(-E(2))\nSKIN = O.DO\nELSE\nRESRWE = RESRW\nSKIN = E(2)\nENDIF\nIF(IOPT.NE.3) THEN\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tE(l),SKIN,E(3),TEST,NP,FUN,IOPT)\nSAVLI1 = O.DO\nDO 170 I = 1,NP\nIF(IOPT.EQ.1) THEN\nRES = FUN(I) - TESP(I)\nELSE\nRES = FUN(I) - DP(I)\nENDIF\nSAVLI1 = SAVLI1 + DABS(RES)\n170\tCONTINUE\nSAVLI1 - SAVLI1/NP ELSE\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tE(l),SKIN,E(3),TEST,NP,FUN,1)\nSAVLI1 \u00ab O.DO\nDO 171 I - 1,NP\nRES - FUN(I) - TESP(I)\nSAVLI1 = SAVLI1 4- DABS (RES)\n171\tCONTINUE\nCALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,\n*\tE(l),SKIN,E(3),TEST,NP,FUN,2)\nDO 172 I \u00bb 1,NP\nRES = FUN(I) - DP(I)\nSAVLI1 = SAVLI1 + DABS(RES)\n172\tCONTINUE\nSAVLI1 = SAVLI1/(2*NP)\nENDIF\nIF (SAVLI1.LT.SAV(IHI)) THEN\nDO 180 I = 1,NPAR\nRESVAR(I,IHI) \u00ab E(I)\n180\tCONTINUE\nSAV(IHI) = SAVLI1\nELSE\nCALL SHRINK(RESVAR,SAV,ILO,NP,IOPT)\nENDIF\nENDIF\nRETURN\nEND\nC***********************************************************************\nSUBROUTINE LAPLACE (RESPHI, RESVIS,RESCT,RESRW,RESH,RESQ,\n*\tESTK,ESTS,ESTC,TEST,NP,FUN,IOPT)\nIMPLICIT REAL * 8 (A~H,O-Z)\nDIMENSION G(50), H(25),TEST(1),FUN(l)\nCOMMON /STE/ V(50),M,N\nVARI = 1O.DO**ESTK\nVAR2 = ESTS\nc\n1\n4\n5\n6\n9\n8\n12\n11\n13\n14\n10\n7\n17\n15\nVAR3 \u201c 10.DO**ESTC\nDLOGTW = 0.69314718056D0\nPI = 4.DO*DATAN(1.DO)\nIF (N .EQ. M) GOTO 17\nM = N\nNH = N/2\nFATORIAIS FICAM EM G\nG(l) = 1.D0\nDO 1 I = 2, N\nG(I) * G(I-l) * I\nCONTINUE\nH(l) = 2.DO / G(NH-l)\nDO 6 I = 2, NH\nFI = I\nIF (I~NH) 4,5,6\nH(I) \u00bb FI**NH*G(2*I)/(G(NH-I)*G(I)*G(I-1)) GOTO 6\nH(I) = FI**NH*G(2*I)/(G(I)*G(I-1))\nCONTINUE\nSN = 2*(NH-NH/2*2)-1\nDO 7 I = 1, N\nV(I) = 0.D0\nKI = (I+l)/2\nK2 = I\nIF(K2-NH) 8,8,9\nK2 \u00ab NH\nDO 10 K = Kl, K2\nIF(2*K - I) 12,13,12\nIF(I-K) 11,14,11\nV(I) = V(I) + H(K)/(G(I-K)*G(2*K~I)) GOTO 10\nV(I) = V(I) + H(K)/G(I-K)\nGOTO 10\nV(I) \u00ab= V(I) + H(K) / G(2*K \u00bb I)\nCONTINUE\nV(I) = SN*V(I)\nSN \u00bb -SN\nCONTINUE\nCONTINUE\nCl = DSQRT(RESPHI*RESVIS*RESCT) *RESRW\nC2 - 2.DO*PI*RESH/RESVIS\nTEMPS = DSQRT(VARl)\nDO 500 J - 1,NP\nFUN(J) = 0.D0\nA - DLOGTW / TEST(J)\nDO 15 I = 1, N\nARG = A* I\nTEMPS \u00ab DSQRT(ARG)\nTEMPI - C1*TEMP5/TEMP6\nTEMP2 \u25a0\u00bb BESSKO (TEMPI)\nTEMPS - BESSK1(TEMPI)\nAUX1 = C1*C2*TEMP5*TEMP6*TEMP3\nAUX2 \u00ab TEMP2 + VAR2*TEMP1*TEMP3\nIF(IOPT.EQ.1) THEN\nFUN(J) \u00ab FUN(J)+V(I)*RESQ/(ARG*(AUX1/AUX2 + VAR3*ARG)) ELSE\nIF(IOPT.EQ.2) THEN\nFUN(J) = TEST(J) * FUN(J) ENDIF\nIF(FUN(J).LE.O.DO) THEN\nWRITE(*,*) 'ATENCAO, PRESSAO NEGATIVA NA INVERSAO' ENDIF\n500 CONTINUE\nRETURN\nEND\n2***********************************************************************\nSUBROUTINE DPDT(TEST,TESP,NP,DP)\nIMPLICIT REAL * 8 (A-H,O-Z)\nDIMENSION TEST(l),TESP(1) ,DP(1)\n1\t= 2\nAUX \u00ab DLOG1O(TEST(I)/TEST(1))\nDO WHILE (AUX.LT.0.15D0)\n1 = 1 + 1\nAUX = DLOGIO(TEST(I)/TEST(1))\nENDDO\nAUX2 = TEST(I) - TEST(l)\nAUX4 = TESP(I) - TESP(l)\nDP(1) = TEST(1)*AUX4/AUX2\nDO 100 I=2,NP-1\nJ = I + 1\nAUX = DLOGIO(TEST(JJ/TEST(I))\nDO WHILE (AUX.LT.0.15D0.AND.J.LT.NP)\nJ = J + 1\nAUX - DWG10 (TEST (JJ/TEST (I)) ENDDO\nAUX2 ~ TEST(J) - TEST(I)\nAUX4 = TESP(J) - TESP(I)\nJ = I - 1\nAUX = DLOGIO(TEST(I)/TEST(J))\nDO WHILE (AUX.LT.0.15D0.AND.J.GT.1)\nJ = J - 1\nAUX = DLOGIO(TEST(I)/TEST(J)) ENDDO\nAUX1 = TEST(I) - TEST(J)\nAUX3 = TESP(I) - TESP(J)\nDP(I) = ( AUX2*AUX3/AUX1 + AUX1*AUX4/AUX2 )/(AUXl + AUX2) DP(I) = TEST(I)*DP(I)\n100 CONTINUE\nDP(NP) = DP(NP-l)\nRETURN\nEND\n************************************************************************"}]}}}