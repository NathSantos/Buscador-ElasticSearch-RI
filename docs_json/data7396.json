{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.10963"}, {"@name": "filename", "#text": "16165_327322.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE FEDERAL DE SANTA CATARINA\nDEPARTAMENTO DE AUTOMAC?A?O E SISTEMAS\n\nFelipe Fernandes Thome?\n\nCONTROLE PREDITIVO ROBUSTO DE SISTEMAS\nNA?O LINEARES COM ATRASO\n\nFloriano?polis\n\n2013\n\n\n\n\n\nFelipe Fernandes Thome?\n\nCONTROLE PREDITIVO ROBUSTO DE SISTEMAS\nNA?O LINEARES COM ATRASO\n\nDissertac?a?o de mestrado submetida ao\nPrograma de Po?s-Graduac?a?o em En-\ngenharia de Automac?a?o e Sistemas para\na obtenc?a?o do Grau de Mestre em En-\ngenharia de Automac?a?o e Sistemas.\nOrientador: Prof. Dr. Julio Elias Normey-\nRico\nCoorientador: Prof. Dr. Tito Lu??s\nMaia Santos\n\nFloriano?polis\n\n2013\n\n\n\nCatalogac?a?o na fonte elaborada pela biblioteca da\nUniversidade Federal de Santa Catarina\n\nA ficha catalogra?fica e? confeccionada pela Biblioteca Central.\n\nTamanho: 7cm x 12 cm\n\nFonte: Times New Roman 9,5\n\nMaiores informac?o?es em:\n\nhttp://www.bu.ufsc.br/design/Catalogacao.html\n\n\n\nFelipe Fernandes Thome?\n\nCONTROLE PREDITIVO ROBUSTO DE SISTEMAS\nNA?O LINEARES COM ATRASO\n\nEsta Dissertac?a?o de mestrado foi julgada aprovada para a ob-\ntenc?a?o do T??tulo de \u201cMestre em Engenharia de Automac?a?o e\nSistemas\u201d, e aprovada em sua forma final pelo Programa de Po?s-\nGraduac?a?o em Engenharia de Automac?a?o e Sistemas.\n\nFloriano?polis, 20 de dezembro de 2013.\n\nProf. Dr. Jomi Fred Hu?bner\nCoordenador do Curso\n\nBanca Examinadora:\n\nProf. Dr. Julio Elias Normey-Rico\nPresidente \u2013 Orientador \u2013 DAS \u2013 UFSC\n\nProf. Dr. Henrique Simas \u2013 EMC \u2013 UFSC\n\nProf. Dr. Augustinho Plucenio \u2013 DAS \u2013 UFSC\n\nProf. Dr. Rodolfo Ce?sar Costa Flesh \u2013 DAS \u2013 UFSC\n\n\n\n\n\nAGRADECIMENTOS\n\nA? minha ma?e Alaine e ao meu pai Dorival pelo amor, pelos\nensinamentos, pelo suporte e pela confianc?a que sempre depositaram\nem mim. Aos meus irma?o pelo amor, amizade e companheirismo. Aos\nmeus grandes amigos pela companhia nos momentos de alegria e pela\nforc?a nos momentos de dificuldade. Meu muito obrigado ao professor\nJulio pelos seus ensinamentos e por sua grande amizade e tambe?m ao\nprofessor Tito pelo grande apoio durante todo esse trabalho.\n\n\n\n\n\nSe o homem soubesse as vantagens de ser\nbom, seria homem de bem so? por ego??smo.\n\nSanto Agostinho\n\n\n\n\n\nRESUMO\n\nNesse trabalho e? proposta uma estrate?gia de Controle Preditivo capaz\nde controlar de forma robusta processos modelados de forma na?o li-\nnear com atraso de transporte. Essa abordagem e? interessante quando\nconsidera-se a crescente importa?ncia dos controladores preditivos em\ncontrole de processos complexos, devido principalmente a sua grande\ninserc?a?o na indu?stria de petro?leo e ga?s. O trabalho apresenta uma re-\nvisa?o do controle preditivo na?o linear e do controle preditivo robusto\nde processos com atraso de transporte. Como resultado dessa ana?lise\nopta-se por focar os estudos no controlador PNMPC (Practical Non-\nlinear Predictive Control ) e nas estrate?gias de compensac?a?o de atraso\nbaseadas no preditor de Smith filtrado, dado que essas oferecem as me-\nlhores propriedades para a proposta do trabalho. Sa?o realizados estu-\ndos da robustez do PNMPC observando o comportamento da incerteza\nequivalente quando esse controlador esta? configurado para controlar\nprocessos com atraso de transporte. E? demonstrado que a incerteza\nequivalente traz consigo um acu?mulo de varia?veis da correc?a?o forne-\ncida pelo modelo de perturbac?a?o, sendo esse um feno?meno indesejado,\npois aumenta a norma da incerteza equivalente levando a uma menor\nrobustez do controle em malha fechada. Esse estudo traz um cami-\nnho alternativo para aumentar a robustez do PNMPC, pois evidencia\no acu?mulo das varia?veis de correc?a?o e traz a possibilidade da utilizac?a?o\nde compensadores de atraso expl??citos, elucidando um esquema de con-\ntrole com o PNMPC atuando como um controlador prima?rio que utiliza\numa predic?a?o fornecida por um preditor para o ca?lculo do controle; le-\nvando assim a uma nova configurac?a?o, o PNMPC com um modelo de\nperturbac?a?o modificado. Propo?e-se uma estrate?gia mais robusta para\no controle preditivo na?o linear de processos com atraso de transporte,\no PNMPC com compensac?a?o expl??cita do atraso via PSF (preditor de\nSmith filtrado). E e? comprovado analiticamente tanto para o caso li-\nnear quanto para o caso na?o linear o aumento da robustez no controle\nde processos com atraso de transporte das estrate?gias desenvolvidas\nnesse trabalho, o PNMPC, o PNMPC modificado e o PNMPC com\ncompensac?a?o de atraso via preditor de Smith filtrado. Para a demons-\ntrac?a?o anal??tica da robustez utiliza-se a abordagem da observac?a?o do\ncomportamento da incerteza equivalente, poss??vel quando referencia-se\no esquema de controle mais o preditor de forma equivalente e analisa-\nse a relac?a?o entre as incertezas. Ainda, durante todo o trabalho sa?o\n\n\n\napresentadas simulac?o?es de controle que evidenciam o ganho de robus-\ntez das estrate?gias desenvolvidas, simulac?o?es essas que comparam as\nrespostas dina?micas do controle em malha fechada das tre?s estrate?gias,\nPNMPC, PNMPC Modificado e PNMPC com compensac?a?o de atraso\nvia preditor de Smith filtrado tanto para o caso linear quanto para o\ncaso na?o linear considerando incertezas na estimac?a?o dos atrasos.\nPalavras-chave: PNMPC, PSF, Controle Preditivo, Robustez\n\n\n\nABSTRACT\n\nIt is proposed a predictive control strategy able do robustly control\nnonlinear processes with transport delay. This approach is interesting\nwhen it is considered the growing importance of predictive controllers\nfor controlling complex processes, mainly due to its large insertion in\nthe oil and gas industry. This work presents an overview of the nonli-\nnear predictive control and robust predictive control of processes with\ntransport delay. As a result of this analysis it is chosen to focus the stu-\ndies on the controller PNMPC (Pratical Nonlinear Predictive Control)\nand on the transport delay compensantion strategies based on filtered\nSmith predictor as they offer the best properties for the proposed work.\nIt is performed studies of the robustness of PNMPC observing the beha-\nvior of the equivalente uncertainty when the controller is configured to\ncontrol processes with transport delay. It is shown that the equivalent\nuncertainty brings with itself an accumulation of the correction variable\nprovided by the disturbance model, it is an unwanted phenomenon be-\ncause it increases the norm of the equivalent uncertainty decreasing the\nrobustness of closed loop control. This study provides an alternative\nway to increase the robustness of the PNMPC for demonstrating the\naccumulation of the correction variable and it brings the possibility of\nusing explicit delay compensators. It can clarify a control scheme with\nPNMPC acting as a primary controller that uses a prediction provided\nby a predictor for the calculation of control. It is proposed a robust non-\nlinear predictive control of processes with transport delay, the PNMPC\nwith explicit delay compensation via FSP (filtered Smith predictor.\nAnd it is analytically demonstrated for both linear and nonlinear cases\nthe increase of the robustness in control process with transport delay.\nFor the analytical demonstration of the robustness it is observed the\nbehavior of the equivalent uncertainty, that is possible when it is re-\nferenced the control scheme more the predictor, in a equivalent way,\nfor analyse the relationship between uncertainties. Also, control si-\nmulations show the robustness gain of the developed strategies, these\nsimulations compare the dynamic responses, of the closed loop control,\nof the three strategies: PNMPC, modified PNMPC and the PNMPC\nwith delay compensator via FSP, for both linear and nonlinear cases\nand considering uncertainties in the transport delay.\nKeywords: PNMPC, FSP, Predictive Control, Robustness\n\n\n\n\n\nLISTA DE FIGURAS\n\nFigura 1 Controle preditivo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n\nFigura 2 Modelo de perturbac?a?o do PNMPC . . . . . . . . . . . . . . . . . . . . 45\n\nFigura 3 Diagrama de blocos para um controle com atraso . . . . . . 50\n\nFigura 4 Preditor de Smith . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50\n\nFigura 5 Preditor de Smith filtrado . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52\n\nFigura 6 Estrutura para implementac?a?o do preditor de Smith fil-\ntrado. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53\n\nFigura 7 Controle MPC com compensac?a?o expl??cita do atraso . . . 56\n\nFigura 8 Simulac?a?o de controle PNMPC sem erros de modelagem 60\n\nFigura 9 Simulac?a?o de controle PNMPC com erros de modelagem 60\n\nFigura 10 Modelo de perturbac?a?o do PNMPC . . . . . . . . . . . . . . . . . . . . 61\n\nFigura 11 PNMPC e a predic?a?o expl??cita . . . . . . . . . . . . . . . . . . . . . . . . . 63\n\nFigura 12 Respostas temporais; d = 10 e dn = 8 . . . . . . . . . . . . . . . . . . 70\n\nFigura 13 Respostas temporais; d = 80 e dn = 64 . . . . . . . . . . . . . . . . . 71\n\nFigura 14 Respostas temporais; d = 80 e dn = 64 . . . . . . . . . . . . . . . . . 76\n\nFigura 15 Respostas temporais; d = 20 e dn = 18 . . . . . . . . . . . . . . . . . 78\n\nFigura 16 Respostas temporais; d = 100 e dn = 89 . . . . . . . . . . . . . . . 78\n\nFigura 17 Respostas temporais com Preditor Modificado; d = 100\ne dn = 89 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78\n\nFigura 18 Resposta temporal do controle do reator com o PNMPC 80\n\nFigura 19 Resposta temporal do controle do reator com o PNMPC\nModificado . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80\n\nFigura 20 PNMPC com compensac?a?o de atraso via preditor de\nSmith filtrado . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82\n\nFigura 21 Preditor de Smith filtrado; d = 100 e ? = 70 . . . . . . . . . . . 84\n\nFigura 22 Preditor modificado; d = 100 e ? = 70 . . . . . . . . . . . . . . . . . 84\n\nFigura 23 Controle Linear com Compensac?a?o de Atraso . . . . . . . . . . 87\n\nFigura 24 Esquema equivalente de Controle . . . . . . . . . . . . . . . . . . . . . . 87\n\n\n\n\n\nLISTA DE ABREVIATURAS E SIGLAS\n\nPID Proportional, Integral and Derivative - Proporcional, In-\ntegral e Derivativo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21\n\nDMC Dynamic Matrix Control - Controle por Matriz Dina?mica 22\n\nGPC Generalized Predictive Control - Controle Preditivo Ge-\nneralizado . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22\n\nLMPC Linear Model Predictive Control - Controle Preditivo\nbaseado em Modelo Linear . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22\n\nNMPC Nonlinear Model Predictive Control - Controle Preditivo\nbaseado em Modelo Na?o Linear . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22\n\nMPC Model Predictive Control - Controle Preditivo baseado\nem Modelo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22\n\nPNMPC Pratical Nonlinear Model Predictive Control - Controle\nPreditivo Pra?tico baseado em Modelo Na?o Linear . . . . . . . . . . 23\n\nSPF Smith Predictor Filtered - Preditor de Smith filtrado . . 23\n\nSQP Sequential Quadratic Programming - Programac?a?o Qua-\ndra?tica Sequencial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25\n\nEPSAC Extended Prediction Self-Adaptive Control - Controlador\nPreditivo Auto-Adaptativo Estendido . . . . . . . . . . . . . . . . . . . . . . 30\n\nMAC Model Algorithmic Control - Controle Algor??tmico base-\nado em Modelo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n\nARIMA Auto-Regressive and Integrated Moving Average - Auto-\nRegressivo e de Me?dia Mo?vel Integrada . . . . . . . . . . . . . . . . . . . . 33\n\nSISO Single-Input Single-Output - Uma Entrada e Uma Sa??da 35\n\nQP Quadratic Programming - Programac?a?o Quadra?tica . . . . 36\n\nMIMO Multiple-Input Multiple-Output - Mu?ltiplas Entradas e\nMu?ltiplas Sa??das . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37\n\nNARMAX Nonlinear Auto-regressive with Moving Average and Exo-\ngenous Inputs - Auto-Regressivo Na?o Linear com Me?dia Mo?vel\ne Entradas Exo?genas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44\n\nBIBO Bounded Input Bounded Output - Entrada Limitada Sa??da\nLimitada . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91\n\nSBAI Simpo?sio Brasileiro de Automac?a?o Inteligente . . . . . . . . . 108\n\n\n\n\n\nLISTA DE SI?MBOLOS\n\nR Conjunto dos nu?meros reais . . . . . . . . . . . . . . . . . . . . . . . . . . 30\na Vetor com dimenso?es apropriadas . . . . . . . . . . . . . . . . . . . . 30\n\na(k) Elemento k do vetor a . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n\na(k+j|k) Predic?a?o para y(k +j) dadas as informac?o?es do instante\nk . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n\nRp Conjunto dos vetores de dimensa?o p com nu?meros reais 30\na Se?rie de valores . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n\nai Elemento i da se?rie a . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n\nA Matriz com dimenso?es apropriadas . . . . . . . . . . . . . . . . . . . . 31\n\nA Func?a?o de transfere?ncia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31\n\nA(z?1) Matriz de transfere?ncia pulsada . . . . . . . . . . . . . . . . . . . . . . . 31\n\nA(s) Func?a?o de transfere?ncia cont??nua . . . . . . . . . . . . . . . . . . . . . . 31\n\nz?1 Operador atraso unita?rio . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31\n\n? Operador de incremento, ? = 1 ?z?1 . . . . . . . . . . . . . . . . 31\n?a Incremento unita?rio do vetor a . . . . . . . . . . . . . . . . . . . . . . . . 31\n\n?a(k) Incremento de a(k) em k, ?a(k) = a(k) ?a(k ? 1) . . . . 31\na? Derivada de a. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37\n?a\n?x\n\nDerivada parcial de a em relac?a?o a x . . . . . . . . . . . . . . . . . . 41\n?a\n?x\n|(a(i),x(i))Derivada parcial de a em relac?a?o a x, aplicada no ponto\n(a(i),u(i)) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41\n\nI Matriz identidade . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43\n\nA(: ,n) coluna n da matriz A . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45\n\nq?1 Operador deslocamento unita?rio . . . . . . . . . . . . . . . . . . . . . . 45\n\nA(ej?) Resposta em freque?ncia de A(z?1) . . . . . . . . . . . . . . . . . . . 56\n\nA(j?) Resposta em freque?ncia de A(s) . . . . . . . . . . . . . . . . . . . . . . 56\n\na ? b Valor do a tende a b . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63\n||A|| Norma induzida da matriz A. . . . . . . . . . . . . . . . . . . . . . . . . . 69\nA Conjunto de matrizes A. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86\n\na Seque?ncia indefinida de valores do vetor a. . . . . . . . . . . . . 95\n\na[i,j] Seque?ncia definida de valores de a, a[i,j] = {a(i), . . . ,a(j)} 95\n|a|s Norma induzida do vetor a. . . . . . . . . . . . . . . . . . . . . . . . . . . . 95\n\n\n\n\n\nSUMA?RIO\n\n1 INTRODUC?A?O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21\n1.1 OBJETIVOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24\n1.2 REVISA?O DA LITERATURA . . . . . . . . . . . . . . . . . . . . . . . . . . 24\n1.3 ORGANIZAC?A?O DO TRABALHO . . . . . . . . . . . . . . . . . . . . . . 27\n2 CONTROLE PREDITIVO . . . . . . . . . . . . . . . . . . . . . . . . . 29\n2.1 CONTROLE PREDITIVO BASEADO EM MODELO LI-\n\nNEAR . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29\n2.1.1 Modelo de Predic?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29\n2.1.2 Modelo de Perturbac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33\n2.1.3 Reposta Livre e Forc?ada . . . . . . . . . . . . . . . . . . . . . . . . . . . 34\n2.1.4 Func?a?o Objetivo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34\n2.1.5 Trajeto?ria de Refere?ncia e Restric?o?es . . . . . . . . . . . . . . 35\n2.1.6 Obtenc?a?o da Lei de Controle . . . . . . . . . . . . . . . . . . . . . . . 36\n2.2 CONTROLE PREDITIVO BASEADO EM MODELO NA?O\n\nLINEAR . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37\n2.2.1 Me?todos com Modelos de Processo Na?o Linear na\n\nFunc?a?o Objetivo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38\n2.2.2 Me?todos com Modelos de Processo Particulares . . . . 38\n2.2.3 Me?todos com Modelos Linearizados . . . . . . . . . . . . . . . . 39\n2.3 PRATICAL NONLINEAR MODEL PREDICTIVE CON-\n\nTROL . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40\n2.3.1 Obtenc?a?o Nume?rica das Predic?o?es . . . . . . . . . . . . . . . . . 44\n2.3.2 Modelo de Perturbac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45\n2.4 CONCLUSA?O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47\n3 COMPENSAC?A?O DE ATRASO . . . . . . . . . . . . . . . . . . . . 49\n3.1 PREDITOR DE SMITH . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49\n3.2 PREDITOR DE SMITH FILTRADO . . . . . . . . . . . . . . . . . . . . 51\n3.3 COMPENSAC?A?O DE ATRASO EM CONTROLADORES\n\nPREDITIVOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53\n3.4 CONCLUSA?O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56\n4 PNMPC COM COMPENSAC?A?O DE ATRASO RO-\n\nBUSTA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59\n4.1 MODIFICAC?A?O NO ESQUEMA DE CORREC?A?O DA PREDI-\n\nC?A?O NO PNMPC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61\n4.1.1 Ana?lise da Incerteza Equivalente em um PNMPC\n\nLinear . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62\n4.1.2 Preditor Modificado . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71\n\n\n\n4.1.3 Preditor Modificado em um PNMPC Na?o Linear . . 76\n4.1.4 Estudo de Caso . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78\n4.2 PNMPC COM COMPENSAC?A?O DE ATRASO VIA PRE-\n\nDITOR DE SMITH FILTRADO . . . . . . . . . . . . . . . . . . . . . . . . . 80\n4.3 CONCLUSA?O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83\n5 ANA?LISE DE ROBUSTEZ . . . . . . . . . . . . . . . . . . . . . . . . . 85\n5.1 DESCRIC?A?O DAS INCERTEZAS . . . . . . . . . . . . . . . . . . . . . . . 85\n5.2 ANA?LISE LINEAR DA ROBUSTEZ . . . . . . . . . . . . . . . . . . . . . 86\n5.2.1 Compensac?a?o de Atraso Expl??cita . . . . . . . . . . . . . . . . . . 88\n5.2.2 Compensac?a?o de Atraso Modificada . . . . . . . . . . . . . . . . 89\n5.2.3 Compensac?a?o via Preditor de Smith Filtrado . . . . . . 90\n5.3 ANA?LISE NA?O LINEAR DA ROBUSTEZ . . . . . . . . . . . . . . . . 94\n5.3.1 PNMPC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96\n5.3.2 PNMPC Modificado . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100\n5.3.3 PNMPC via Preditor de Smith Filtrado . . . . . . . . . . . 102\n5.4 CONCLUSA?O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105\n6 CONSIDERAC?O?ES FINAIS . . . . . . . . . . . . . . . . . . . . . . . 107\nREFERE?NCIAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109\n\n\n\n21\n\n1 INTRODUC?A?O\n\nGrande parte dos processos existentes na indu?stria de petro?leo e\nga?s utilizam controladores preditivos [1]. Neste cena?rio eles esta?o fre-\nquentemente configurados em uma segunda camada, para o constante\najuste dos set points de controladores PID (Proportional, Integral and\nDerivative), por sua vez configurados em uma primeira camada de con-\ntrole [2].\n\nA crescente utilizac?a?o dessas estrate?gias pode ser atribu??da ao\nfato de elas facilitarem a declarac?a?o de problemas de controle relativa-\nmente complexos, como os casos de controle de processos multivaria?veis,\nprocessos integradores, processos insta?veis, processos na?o lineares e pro-\ncessos com atraso de transporte. Outras vantagens importantes sa?o a\ndeclarac?a?o simples e direta de restric?o?es de controle e de processo e\ntambe?m a relativa praticidade de ajuste do controlador, que o viabiliza\npara pessoas com conhecimentos superficiais na teoria de controle de\nprocessos [3].\n\nA respeito da expressa?o Controle Preditivo, e? importante sali-\nentar que ela na?o se refere a uma estrate?gia de controle apenas, mas\na um grupo vasto de estrate?gias de controle que possuem as seguintes\ncaracter??sticas em comum [3]:\n\n\u2022 a utilizac?a?o de um modelo do processo para predizer a magnitude\nde suas sa??das em um horizonte de tempo futuro predeterminado;\n\n\u2022 a utilizac?a?o de um me?todo de otimizac?a?o para calcular o esforc?o\nde controle futuro, que atrave?s da otimizac?a?o de uma func?a?o custo\nbusca, dentre outros objetivos, a minimizac?a?o do erro de segui-\nmento a refere?ncia futura;\n\n\u2022 a utilizac?a?o da estrate?gia do horizonte deslizante, que significa a\ncada instante de amostragem calcular uma seque?ncia de valores\nde controle futuro necessa?rios para se otimizar uma func?a?o custo\ne aplicar apenas o primeiro valor de controle desse horizonte.\n\nAinda no contexto do controle preditivo, as estrate?gias mais utili-\nzadas na indu?stria sa?o aquelas aplicadas ao controle preditivo de proces-\nsos lineares, LMPC (Linear Model Predictive Control ), como as te?cnicas\nDMC (Dynamic Matrix Control ) e GPC (Generalized Predictive Con-\ntrol ), que desde a de?cada de 70 consolidaram-se como as principais\nestrate?gias preditivas. Como na verdade, em esse?ncia, todos processos\nsa?o na?o lineares, a pra?tica corrente e? a linearizac?a?o em torno de pontos\n\n\n\n22\n\nde operac?a?o e a utilizac?a?o das estrate?gias de controle preditivo para\nprocessos lineares [4].\n\nContudo, a evoluc?a?o da concorre?ncia industrial que acentua a\nnecessidade de maior rendimento dos processos de produc?a?o e a pre-\nsenc?a de novas restric?o?es cada vez mais severas demandadas principal-\nmente por regulamentac?o?es governamentais, como aquelas relacionadas\na? sau?de e ao meio ambiente, exigem um maior desempenho dos con-\ntroladores. E ainda, a viabilizac?a?o do controle de diferentes e novos\nprocessos com na?o linearidades mais complexas, oriundos das necessi-\ndades de novos setores industriais, so? pode ser dada com a utilizac?a?o\nde modelos na?o lineares para representar a sua dina?mica [5]. Assim,\na aplicac?a?o do controle preditivo em processos na?o lineares, NMPC\n(Nonlinear Model Predictive Control ), surge como uma boa soluc?a?o\npara essas questo?es.\n\nComo a aplicac?a?o de controle preditivo requer a utilizac?a?o de um\nmodelo do processo, essa necessidade de um maior desempenho pode\nrequerer modelos mais realistas, na?o apenas linearizac?o?es em pontos de\noperac?o?es fixos. Isso e? necessa?rio tanto porque o grau de na?o lineari-\ndade dos processos controlados pode ser alto quanto porque os pontos\nde operac?o?es podem ser varia?veis. Para suprir essa necessidade surgi-\nram com o decorrer do tempo diversas te?cnicas MPC (Model Predictive\nControl ) que apresentam maior desempenho ao controlar sistemas na?o\nlineares. Uma das va?rias classificac?o?es [1] agrupa as te?cnicas em 3 con-\njuntos:\n\n1. te?cnicas que utilizam diretamente um modelo na?o linear geral e\ntambe?m um algor??tmo de otimizac?a?o na?o linear gene?rico. Es-\nsas te?cnicas, apesar de gerais, na?o se apresentam interessantes\nquando avalia-se o seu desempenho1 [1];\n\n2. te?cnicas que utilizam modelos na?o lineares espec??ficos para cada\nsituac?a?o e um algor??tmo de otimizac?a?o particular. Essas te?cnicas,\napesar de apresentarem bom desempenho, sa?o relativamente com-\nplexas, o que diminui as possibilidades de aplicac?a?o. Ale?m de que\no processo na?o linear em questa?o deve se adequar a cada caso es-\npec??fico;\n\n3. te?cnicas que usam formas aproximadas para o ca?lculo das predic?o?es\ndo processo na?o linear de forma tal a utilizar um algor??tmo de oti-\nmizac?a?o linear.\n\n1Essas estrate?gias podem demandar um alto desempenho computacional, mesmo\nsem fornecer grandes vantagens quando comparadas com te?cnicas LMPC\n\n\n\n23\n\nDentre as te?cnicas de controle preditivo na?o linear do terceiro\ngrupo acima citado, o PNMPC (Pratical Nonlinear Model Predictive\nControl ) [1] vem apresentando bom desempenho e vasta possibilidade\nde aplicac?a?o, o que o torna interessante quando avalia-se simplicidade.\n\nOutro componente comum no comportamento dos processos,\nprincipalmente nos da indu?stria de petro?leo e ga?s, e? o atraso. Esse\nfeno?meno aparece devido ao tempo necessa?rio para o transporte de\nmate?ria, de energia e de informac?a?o, bem como quando va?rios processos\nde baixa ordem compo?em o sistema a ser controlado ou devido tambe?m\nao tempo necessa?rio para o ca?lculo do pro?ximo esforc?o de controle [6].\n\nA dificuldade de controlar em malha fechada esses tipos de pro-\ncessos e? tradicionalmente reconhecida pela literatura. Ela pode ser\nexplicada pelo fato de a ac?a?o de controle a ser aplicada no instante\natual ser calculada com base em um erro entre a sa??da e o set point\nreferente a um tempo anterior ao atraso. Esse feno?meno tambe?m pode\nser explicado no dom??nio da freque?ncia, no qual o atraso de transporte\ndiminui a margem de fase do sistema sob controle de forma acentuada\npodendo provocar a instabilidade em malha fechada [6]. Sa?o justamente\nestes fatores que fazem com que controladores baseados em estrate?gias\ncla?ssicas, como os controladores PID, somente sejam capazes de manter\na estabilidade de processos controlados de forma conservadora, ou seja,\nsubmetendo-os a dina?micas lentas [6].\n\nAlguns estudos apresentaram estrate?gias interessantes para con-\ntornar o problema do atraso de transporte e conseguir-se melhor desem-\npenho dos controladores. A maioria dessas estrate?gias sa?o baseadas nas\nideias do preditor de Smith [7], que pode alcanc?ar bom desempenho em\nmalhas locais. Como mencionado inicialmente, o controle de processos\ncom atraso e? tambe?m uma das vantagens de controladores preditivos,\nque tratam intrinsecamente esse problema, ja? que fazem uso de um mo-\ndelo do processo para predizer sa??das futuras, podendo simplesmente\nconsiderar aquelas que aparecem apo?s o efeito do atraso.\n\nNo entanto, o marco teo?rico que apresenta uma estrate?gia com\nalto desempenho robusto para controladores preditivos em plantas com\natraso so? aparece em [4], com a utilizac?a?o de um filtro de robustez\nespec??fico para lidar com problemas de incerteza e perturbac?o?es des-\nconhecidas, dando origem ao GPC com base no FSP, Filtered Smith\nPredictor.\n\nProblemas como os levantados acima, nos quais deseja-se con-\ntrolar processos com dina?micas na?o lineares complexas e variac?a?o cons-\ntante de pontos de operac?a?o ou deseja-se controlar processos com longos\natrasos de transporte, sa?o ha? algum tempo resolvidos individualmente\n\n\n\n24\n\nde forma satisfato?ria. No entanto, percebe-se certa care?ncia no que diz\nrespeito ao desenvolvimento de uma estrate?gia eficiente, que apresente\nalto desempenho robusto ao controlar processos que possuam as duas\nproblema?ticas acima citadas ao mesmo tempo e ainda que fac?a uso das\ndiversas vantagens oferecidas pelos controladores preditivos. E? nesse\ncontexto que esse projeto de pesquisa se faz presente e tem como obje-\ntivo principal o estudo e o desenvolvimento de uma estrate?gia que seja\ncapaz de lidar com todas essas questo?es de forma robusta.\n\n1.1 OBJETIVOS\n\nA partir da contextualizac?a?o inicial e? poss??vel listar os objetivos\ndesse projeto. O problema exposto ressalta a necessidade do desenvol-\nvimento de uma estrate?gia robusta para o controle preditivo de proces-\nsos na?o lineares com atraso de transporte. Assim, declara-se o objetivo\nprincipal por:\n\n\u2022 unificar a compensac?a?o robusta do atraso e o controle preditivo\npara sistemas na?o lineares utilizando a estrate?gia FSP e o al-\ngor??tmo PNMPC.\n\nPara alcanc?ar esse objetivo, dois objetivos espec??ficos foram es-\ntabelecidos, sendo eles:\n\n1. elaborar um algor??tmo para implementar um controlador predi-\ntivo MPC que integre o FSP com o PNMPC;\n\n2. analisar as propriedades de robustez da estrate?gia de controle\ndesenvolvida.\n\n1.2 REVISA?O DA LITERATURA\n\nA utilizac?a?o de controladores preditivos segue em uma crescente\nascensa?o ha? mais de 30 anos. O destaque principal se da? ao setor pe-\ntroqu??mico, ocupando sempre as atenc?o?es da maioria dos fornecedores\nque acabam investindo na modernizac?a?o dos seus controladores prediti-\nvos, transformando-os de tempos em tempos. Pesquisas que organizam\nas gerac?o?es desses equipamentos mostram que ja? se pode considerar a\npresenc?a de uma quarta gerac?a?o dessa tecnologia [8], confirmando as-\nsim sua ra?pida evoluc?a?o. Tal crescimento incentiva sempre mais e mais\n\n\n\n25\n\nas pesquisas cient??ficas relacionadas ao desenvolvimento das estrate?gias\nde controle preditivo.\n\nDemandas industriais tambe?m da?o corpo a?s pesquisas em torno\nde estrate?gias NMPC. Atualmente existem diversas estrate?gias relacio-\nnadas ao controle preditivo de sistemas na?o lineares, que podem ser\nagrupadas da seguinte maneira [1]:\n\n\u2022 as que utilizam um algor??tmo de otimizac?a?o gene?rico e tambe?m\nmodelos na?o lineares generalizados para o controle dos processos\nna?o lineares;\n\n\u2022 as que utilizam modelos na?o lineares espec??ficos e algor??tmos de\notimizac?a?o tambe?m espec??ficos para o mesmo propo?sito;\n\n\u2022 as que podem utilizar diversos modelos lineares e tambe?m oti-\nmizac?a?o linear para controlar processos na?o lineares.\n\nA respeito do primeiro grupo de estrate?gias, encontra-se na oti-\nmizac?a?o de func?o?es objetivo com a presenc?a de modelos de predic?a?o\nna?o lineares a principal soluc?a?o para o ca?lculo dos esforc?os de con-\ntrole. Essa otimizac?a?o pode ser realizada atrave?s da utilizac?a?o da Pro-\ngramac?a?o Na?o Linear ou SQP (Sequential Quadratic Programming ).\nDevido a utilizac?a?o de modelos lineares gene?ricos esses algor??tmos po-\ndem ser aplicados em diversas situac?o?es. No entanto, possuem baixo\ndesempenho [9].\n\nNo segundo grupo de estrate?gias de controle preditivo de siste-\nmas na?o lineares, a dificuldade de desempenho oriunda da utilizac?a?o\ndos me?todos de otimizac?a?o escolhidos pode ser contornada com a uti-\nlizac?a?o de modelos na?o lineares espec??ficos, como por exemplo Se?ries\nde Volterra [10], em conjunto com a utilizac?a?o de um me?todo mais\nsimples de otimizac?a?o na?o linear. No entanto, o processo real deve res-\npeitar todas as restric?o?es exigidas pela te?cnica de modelagem espec??fica\nadotada.\n\nNo terceiro grupo de estrate?gias, tem-se aquelas que fazem uso\nde diversos modelos lineares e tambe?m de otimizac?a?o linear. Esses\ntipos de estrate?gias sa?o tambe?m referidas em outros contextos, como\nMPC robusto [11\u201313], MPC adaptativo [14] e MPC escalonado [15].\nVale ressaltar o baixo desempenho desses algor??tmos e o alto custo\ncomputacional agregado as suas utilizac?o?es [1].\n\nGeralmente muitos processos na?o lineares sa?o modelados utili-\nzando algor??tmos, a exemplo de redes neurais, que fornecem as sa??das\nnominais dos processos dadas as entradas e os estados atuais. Com a\n\n\n\n26\n\npremissa da existe?ncia de tais abordagens de modelagem, mais recente-\nmente, em [1], foi desenvolvida uma estrate?gia eficiente para o controle\nde muitos desses processos na?o lineares. Essa estrate?gia, PNMPC, tem\nem seu cerne a aproximac?a?o linear do modelo de predic?a?o na?o linear\na cada instante de amostragem e a consecutiva otimizac?a?o quadra?tica,\nsimilar, portanto, a? formulac?a?o tradicional do algor??tmo GPC. No en-\ntanto, o diferencial dessa te?cnica e? a maneira pela qual ela define a\nlinearizac?a?o do modelo de predic?a?o na?o linear a cada instante de amos-\ntragem. Nela tambe?m e? utilizada a formulac?a?o tradicional de ca?lculo da\npredic?a?o dividindo a resposta livre da resposta forc?ada e e? proposta ape-\nnas a linearizac?a?o nume?rica da resposta forc?ada, enquanto mante?m-se\nmaior proximidade da resposta real do processo ao utilizar um modelo\nna?o linear para determinar a resposta livre [1]. O algor??tmo PNMPC\ntem sido implementado em va?rias situac?o?es pra?ticas, demonstrando um\nbom compromisso entre desempenho, simplicidade e velocidade [1]. Por\nisso ele sera? o algor??tmo NMPC escolhido para esse trabalho.\n\nSobre a evoluc?a?o das abordagens que tratam do controle predi-\ntivo de processos com atraso de transporte, ha? algum tempo ja? foi mos-\ntrada a possibilidade de se contornar o problema do atraso de forma\nimpl??cita, ou seja, utilizando os pro?prios para?metros do controlador\npara compensar internamente o atraso [3]. Por esse motivo, durante\nmuito tempo, acreditou-se que o atraso na?o apresentava problemas aos\nalgor??tmos MPC e isso explica, em parte, a evoluc?a?o lenta da literatura\nde Controle Preditivo para sistemas com atraso [2]. Shi, Chai e Yue\n[16] tambe?m ja? apontaram que existem poucos algor??tmos MPC vol-\ntados para tratar da questa?o do atraso de maneira expl??cita, ou seja,\nrealizar uma compensac?a?o do atraso sem envolver o controlador pre-\nditivo [16]. E ainda, os algor??tmos MPC mais utilizados na indu?stria\nusam func?o?es custo com horizonte finito [8], sendo que a literatura que\nestuda o efeito do atraso em algor??tmos MPC de horizonte finito e? ainda\nmais escassa do que aquela baseada em horizonte infinito [2].\n\nApesar dessas dificuldades, surgiram algumas abordagens que\ntratam o efeito do atraso em algor??tmos MPC de horizonte finito, como\na proposta em [17], que e? interessante por apresentar uma maneira\npara compensar o atraso de forma expl??cita. Mas por outro lado esse\ntrabalho na?o estuda o efeito de incertezas no atraso. Outro trabalho\nque aborda a questa?o do atraso em estrate?gias MPC de horizonte finito\ne? o apresentado em [18], com o atraso expresso na forma de incertezas\npolito?picas, sendo poss??vel assim estabilizar o sistema de forma robusta\nna presenc?a de restric?o?es no controle e incertezas no atraso. No entanto,\no esforc?o computacional nesse caso fica dependente do tamanho do\n\n\n\n27\n\natraso nominal, o que e? impro?prio para atrasos muito longos. Outro\ntrabalho, apresentado recentemente em [19], mostra uma estrate?gia de\ncontrole preditivo robusto para sistemas com atraso com caracter??sticas\nimportantes como controle por zonas e dom??nio de atrac?a?o aumentado,\nmas ainda o comprimento do atraso afeta o tamanho da representac?a?o,\ncomo ocorre em [18].\n\nNo contexto da linha de pesquisa apresentada em [17], uma es-\ntrutura de compensac?a?o baseada no FSP pode ser utilizada no controle\npreditivo para sistemas com atraso. Esse trabalho iniciou-se com os\ndesenvolvimentos contidos em [4], nos quais foram demonstrados para\nsistemas sem restric?o?es que o desempenho robusto de estrate?gias MPC\nconvencionais poderia ser melhorado a partir da utilizac?a?o de um fil-\ntro de robustez. Seguiu-se enta?o por diversas extenso?es e adaptac?o?es\nculminando no trabalho realizado em [2], no qual a partir de um deta-\nlhamento entre as diferenc?as entre a compensac?a?o de atraso realizada\nde forma impl??cita nos controladores MPC e a compensac?a?o de atraso\nrealizada via preditor de Smith filtrado, demonstrou-se que o preditor\nde Smith filtrado pode ser utilizado para melhorar a robustez de con-\ntroladores preditivos na presenc?a tambe?m de restric?o?es. Devido as suas\nqualidades, a estrate?gia FSP sera? utilizada nesse trabalho.\n\nComo proposta tem-se enta?o a combinac?a?o das estrate?gias FSP\ne PNMPC para o controle de uma classe de processos na?o lineares com\natraso. Trabalhos anteriores ja? propuseram te?cnicas para o controle de\nprocessos na?o lineares com atraso de transporte, como o apresentado\nem [20]. O autor utiliza um algor??tmo de linearizac?o?es sucessivas combi-\nnado com uma compensac?a?o de atraso via preditor de Smith, e mostra\num ganho nos resultados obtidos quando comparado com te?cnicas li-\nneares de controle que utilizam um modelo do processo linearizado.\nPretende-se agora estender as propriedades de robustez existentes nos\nLMPC com preditor de Smith filtrado para o caso de controladores\nPNMPC com preditor de Smith filtrado.\n\n1.3 ORGANIZAC?A?O DO TRABALHO\n\nOs pro?ximos cap??tulos apresentam o trabalho realizado no pro-\njeto, partindo das refere?ncias teo?ricas, passando pelo desenvolvimento,\nate? chegar a?s concluso?es. No cap??tulo 2 e? apresentado o embasamento\nteo?rico necessa?rio para a compreensa?o do controle preditivo, com os\nconceitos principais relacionados a?s estrate?gias de controle preditivo\nbaseado em modelo linear, uma abordagem introduto?ria ao controle\n\n\n\n28\n\npreditivo baseado em modelo na?o linear e finalizado com um detalha-\nmento especial da estrate?gia PNMPC.\n\nO cap??tulo 3 conte?m nas suas duas primeiras sec?o?es o emba-\nsamento teo?rico necessa?rio para a compreensa?o das te?cnicas de com-\npensac?a?o de atraso denominadas preditor de Smith e preditor de Smith\nfiltrado, as quais servem de base a? apresentac?a?o da terceira sec?a?o desse\nmesmo cap??tulo, na qual e? abordada a tema?tica relacionada a? com-\npensac?a?o de atraso em controladores preditivos.\n\nNo cap??tulo 4 e? detalhada parte dos desenvolvimentos relaciona-\ndos ao objetivo principal desse projeto: estudar a estrate?gia PNMPC\ncom vistas a torna?-la mais robusta. Na sua primeira sec?a?o e? apresen-\ntado o desenvolvimento de uma modificac?a?o no esquema tradicional de\ncorrec?a?o da predic?a?o no PNMPC e na sua segunda sec?a?o e? apresentada\numa nova estrate?gia de controle preditivo de processos na?o lineares com\ncompensac?a?o robusta de atraso, o PNMPC com compensac?a?o robusta\nde atraso via preditor de Smith filtrado.\n\nNo cap??tulo 5 o desenvolvimento final do objetivo desse projeto\ne? apresentado atrave?s de ana?lises de robustez para tre?s estrate?gias es-\npec??ficas, o PNMPC, o PNMPC com o esquema de correc?a?o da predic?a?o\nmodificado e o PNMPC com compensac?a?o de atraso robusta via pre-\nditor de Smith filtrado, sendo essas duas u?ltimas as estrate?gias desen-\nvolvidas nesse trabalho.\n\nPor fim, as concluso?es e os u?ltimos comenta?rios esta?o contidos\nno cap??tulo 6.\n\n\n\n29\n\n2 CONTROLE PREDITIVO\n\nO termo controle preditivo pode muitas vezes levar a? conclusa?o\nde que se esta referindo a uma estrate?gia espec??fica de controle. Na\nverdade essa designac?a?o e? utilizada para retratar uma ampla fam??lia de\ncontroladores que obte?m uma ac?a?o de controle atrave?s da minimizac?a?o\nde uma func?a?o objetivo, a qual contempla, dentre diversas varia?veis o\nerro entre a sa??da predita em um horizonte futuro e a refere?ncia [6].\n\nOs algor??tmos que fazem parte da fam??lia Controle Preditivo pos-\nsuem em comum as caracter??sticas de utilizarem um modelo expl??cito do\nprocesso sob controle para obterem uma predic?a?o, utilizada no ca?lculo\nda pro?xima ac?a?o de controle, um me?todo de obtenc?a?o da lei de con-\ntrole e tambe?m uma func?a?o objetivo a ser minimizada. Sendo que as\ndiferentes opc?o?es de modelo, func?a?o objetivo e me?todo de ca?lculo do\ncontrole geram as diversas verso?es de controladores preditivos propostos\nna literatura.\n\nNesse trabalho a intenc?a?o e? propor uma estrate?gia de Controle\nPreditivo capaz de controlar de forma robusta processos na?o lineares\ncom atraso de transporte. Com vistas a introduzir a teoria que formula\no PNMPC apresentam-se na sec?a?o 2.1 os principais conceitos acerca de\ncontroladores preditivos lineares, em seguida na sec?a?o 2.2 apresenta-se\ntambe?m uma introduc?a?o sobre o controle preditivo de processos na?o\nlineares e, por fim, na sec?a?o 2.3 apresenta-se o PNMPC.\n\n2.1 CONTROLE PREDITIVO BASEADO EM MODELO LINEAR\n\nComo citado inicialmente, um controlador preditivo e? definido\nprincipalmente pelo modelo que utiliza para predizer o estado futuro\ndo processo sob controle, pela func?a?o objetivo que utiliza para calcular\na ac?a?o de controle e por u?ltimo pelo me?todo de otimizac?a?o utilizado\npara o ca?lculo. A seguir apresenta-se um pouco sobre cada uma des-\nsas caracter??sticas de uma estrate?gia de controle preditivo baseado em\nmodelo linear.\n\n2.1.1 Modelo de Predic?a?o\n\nO modelo de predic?a?o e? provavelmente o elemento mais impor-\ntante dentro do controlador. Ele deve ser capaz de representar ade-\n\n\n\n30\n\nquadamente a dina?mica do processo sob controle, pois assim e? poss??vel\nobter as predic?o?es para a sa??da do processo que sera?o utilizadas no\nca?lculo para a pro?xima ac?a?o de controle.\n\nFigura 1 \u2013 Controle preditivo\n\nAs diferentes estrate?gias de LMPC utilizam diferentes formas\npara representar as relac?o?es entre entradas manipuladas, perturbac?o?es\ne sa??das do processo. Geralmente o modelo e? separado em duas partes:\no modelo do processo propriamente dito e o modelo das perturbac?o?es,\nambos necessa?rios para o ca?lculo das predic?o?es. Os modelos mais usados\npara representar o processo sa?o:\n\n\u2022 Resposta impulsiva: utilizado no MAC (Model Algorithmic\nControl ) e em casos especiais no GPC e no EPSAC (Extended\nPrediction Self-Adaptive Control ). A relac?a?o entrada sa??da e? dada\npela equac?a?o (2.1).\n\ny (k) =\n\n??\ni=1\n\nhiu (k ? i) (2.1)\n\nSendo1 hi as amostras da sa??da do processo correspondentes a?\naplicac?a?o de um impulso na entrada do mesmo. Como essa seque?ncia\ne? infinita, a resposta e? truncada para os primeiros N valores, ou\nseja, o modelo somente pode ser usado com plantas esta?veis, nas\nquais hi ? 0 quando i ??:\n\n1Nesse trabalho o operador atraso sera? representa por z?1, sendo z uma varia?vel\ncomplexa\n\n\n\n31\n\ny (k) =\n\nN?\ni=1\n\nhiu (k ? i) = H\n(\nz?1\n)\nu (k) . (2.2)\n\nSendo, na equac?a?o (2.2), H\n(\nz?1\n)\n\n= h1z\n?1 + h2z\n\n?2 +\u00b7 \u00b7 \u00b7+ hNz?N .\nA predic?a?o da sa??da em k + j dado o instante k \u2013 y? (k + j|k) \u2013\nusando esse modelo e? calculada conforme a equac?a?o (2.3).\n\ny? (k + j|k) =\nN?\ni=1\n\nhiu (k + j ? i|t) = H\n(\nz?1\n)\nu (k + j|k) (2.3)\n\nVale citar tambe?m algumas vantagens e desvantagens desse tipo\nde representac?a?o. Como vantagens tem-se: representac?a?o intui-\ntiva; na?o e? necessa?rio um modelo do processo; pode tambe?m ser\nutilizada sem complexidade adicional em plantas multivaria?veis; e\ndescreve de forma direta algumas complexidades da dina?mica de\nprocessos como o atraso de transporte e comportamentos de fase\nna?o m??nima. Como desvantagens podem ser citadas: e? preciso\num elevado nu?mero de para?metros para descrever o processo e\nna?o e? poss??vel utilizar essa representac?a?o em processos insta?veis.\n\n\u2022 Resposta ao degrau. Usada pelo DMC e suas variantes. E?\nsimilar ao modelo anterior, mas usa um degrau unita?rio como\nsinal de entrada. Para sistemas esta?veis a resposta truncada e? a\nda equac?a?o (2.4).\n\ny (k) = y(0) +\n\nN?\ni=1\n\ngi?u (k ? i) = y(0) + G\n(\nz?1\n)(\n\n1 ?z?1\n)\nu (k)\n\n(2.4)\n\nSendo os gi as amostras da sa??da obtida ao aplicar o degrau e\n?u = u (k) ? u (k ? 1). Considerando o sistema no ponto de\noperac?a?o y(0) = 0, a predic?a?o pode ser calculada pela equac?a?o\n(2.5).\n\n\n\n32\n\ny? (k + j|k) =\nN?\ni=1\n\ngi?u (k + j ? i|k) (2.5)\n\nE? simples obter esse modelo a partir da equac?a?o (2.3) usando\n\nhi = gi ? gi?1\n\ne tambe?m as propriedades da evoluc?a?o discreta.\n\nEsse modelo tem as mesmas vantagens e desvantagens que o an-\nterior.\n\n\u2022 Func?a?o de transfere?ncia. Esse modelo e? usado no GPC. Utiliza\no conceito de func?a?o de transfere?ncia G(z?1) = B(z?1)/A(z?1)\ncomo na equac?a?o (2.6).\n\nA\n(\nz?1\n)\ny (k) = B\n\n(\nz?1\n)\nu (k) (2.6)\n\nSendo:\n\nA\n(\nz?1\n)\n\n=1 + a1z\n?1 + a2z\n\n?2 + \u00b7 \u00b7 \u00b7 + anaz?na\n\nB\n(\nz?1\n)\n\n=1 + b1z\n?1 + b2z\n\n?2 + \u00b7 \u00b7 \u00b7 + bnbz?nb.\n\nA predic?a?o e? calculada como na equac?a?o (2.7).\n\ny? (k + j|k) =\nB\n(\nz?1\n)\n\nA (z?1)\nu (k + j|k) (2.7)\n\nA possibilidade de representar processos insta?veis e a pouca quan-\ntidade de para?metros necessa?rios para descrever o comportamento\nde um processo sa?o as grandes vantagens desse tipo de mode-\nlagem. No entanto, a necessidade do conhecimento pre?vio da\nordem para identificar o modelo do processo pode tornar a pa-\nrametrizac?a?o do controlador mais complexa do que quando sa?o\nutilizados modelos baseado em resposta impulsiva e baseado em\nresposta ao degrau.\n\n\n\n33\n\n\u2022 Espac?o de estados.Utiliza-se do conceito de estados para in-\nterpretar a dina?mica do sistema como uma transic?a?o de estados.\nRepresenta-se o sistema como na equac?a?o (2.8).\n\nx (k) =Ax (k ? 1) + Bu (k ? 1)\ny (k) =Cx (k) (2.8)\n\nSendo x o estado. A predic?a?o e? calculada como em (2.9).\n\ny? (k + j|k) = Cx? (k + j|k)\n\n= C\n\n[\nAkx (k) +\n\nk?\ni=1\n\nAi?1Bu (k + j ? i|k)\n\n]\n(2.9)\n\nSendo A, B e C matrizes de dimenso?es compat??veis.\n\nEsta forma de modelagem apresenta grande vantagem quando os\nprocessos sob controle sa?o multivaria?veis. No entanto, ha? o in-\nconveniente quando ha? a necessidade de representar estados na?o\nmensura?veis atrave?s de observadores, aumentando assim a com-\nplexidade do ca?lculo do controle; e torna-se complicado a ana?lise\ndas incertezas.\n\n2.1.2 Modelo de Perturbac?a?o\n\nUma escolha adequada para modelar as perturbac?o?es e? ta?o im-\nportante quanto a forma de modelar a predic?a?o da sa??da em relac?a?o\na? varia?vel manipulada. Os modelos mais utilizados para a descric?a?o\nde perturbac?o?es determin??sticas e estoca?sticas sa?o os modelos auto-\nregressivo integrado de me?dia mo?vel (Auto-Regressive and Integrated\nMoving Average (ARIMA)). Nesse caso, as diferenc?as entre a sa??da do\nmodelo e do processo, representadas por n(k), sa?o modeladas como na\nequac?a?o (2.10).\n\nn (k) =\nC\n(\nz?1\n)\n\nD (z?1)\ne (k) (2.10)\n\nO polino?mio D inclui um integrador ? = 1 ? z?1 e e (k) e?\n\n\n\n34\n\num ru??do branco de me?dia zero. Os demais para?metros do polino?mio\nD\n(\nz?1\n)\n\ne do polino?mio C\n(\nz?1\n)\n\nsa?o usados para descrever as carac-\nter??sticas estoca?sticas de n (k).\n\nEsse modelo permite representar mudanc?as aleato?rias, offsets e\noutros feno?menos normalmente encontrados nos meios industriais. Esse\nmodelo e? usado diretamente no GPC.\n\n2.1.3 Reposta Livre e Forc?ada\n\nNa maioria das estrate?gias de Controle Preditivo baseado em\nmodelo linear considera-se a seque?ncia de controle composta por duas\npartes, uma resposta livre, uf (k), e a uma resposta forc?ada, uc(k):\n\nu (k) = uf (k) + uc (k) .\n\nNesse esquema, uf (k) conte?m os valores passados da entrada\ne no futuro e? mantida constante e igual ao u?ltimo valor da varia?vel\nmanipulada, como a seguir:\n\nuf (k ? j) =u (k ? j) para j = 1,2, . . .\nuf (k + j) =u (k ? 1) para j = 0,1,2, . . .\n\nE uc (k) e? zero no passado e no futuro e? igual ao controle a ser\naplicado pelo controlador, como a seguir:\n\nuc (k ? j) =0 para j = 1,2, . . .\nuc (k + j) =u (k + j) ?u (k ? 1) para j = 0,1,2, . . .\n\nAssim, e? poss??vel separar a predic?a?o para a sa??da do processo em\nduas partes, a resposta livre - yf (k) - uma predic?a?o para a entrada igual\na uf (k), e a resposta forc?ada - yc (k) - uma predic?a?o para a entrada\nigual a uc (k).\n\n2.1.4 Func?a?o Objetivo\n\nAs func?o?es objetivo utilizadas nas estrate?gias de Controle Predi-\ntivo sa?o na sua maioria formuladas para, dentre outras intenc?o?es, mini-\n\n\n\n35\n\nmizar o erro entre a sa??da futura y? e a refere?ncia desejada r. Apesar de\npossu??rem esse objetivo em comum, os diversos algor??tmos de LMPC\nutilizam diferentes func?o?es objetivo para calcular a lei de controle, que\ntambe?m geralmente penalizam o incremento de controle ?u.\n\nDessa forma, uma expressa?o no caso SISO (Single-Input Single-\nOutput ) para as func?o?es objetivo e? a presente na equac?a?o (2.11).\n\nJ =\n\nN2?\nj=N1\n\n? (k) [y? (k + j|k) ?r (k + j)]2\n\n+\n\nNu?\nj=1\n\n? (k) [?u (k + j ? 1)]2 (2.11)\n\nNa equac?a?o (2.11) percebe-se os seguintes para?metros: N1, N2,\nNu, ? (k) e ? (k). N1 e N2 sa?o os horizontes de predic?a?o m??nimo e\nma?ximo. Nu e? o horizonte de controle. Os valores desses para?metros\ndefinem os instantes nos quais deseja-se que a sa??da siga a refere?ncia\ne nos quais e? importante limitar a ac?a?o de controle. Quando tem-se a\npresenc?a do atraso d, pode-se escolher N1 > d, pois na?o havera? resposta\ndo sistema a? entrada u (k) ate? o tempo t = d. Os coeficientes ? (k) e\n? (k) sa?o as seque?ncias de ponderac?a?o do erro e do esforc?o de controle.\n\n2.1.5 Trajeto?ria de Refere?ncia e Restric?o?es\n\nO LMPC permite utilizar valores futuros da refere?ncia para o\nca?lculo do sinal de controle. Isso pode possibilitar, por exemplo, que\no sistema atinja mais rapidamente o novo valor desejado. Essa carac-\nter??stica torna-se interessante tambe?m em algumas aplicac?o?es nas quais\nas refere?ncias futuras sa?o conhecidas antecipadamente.\n\nPode-se tambe?m utilizar estrate?gias para suavizar as mudanc?as\nde refere?ncia, assim como os filtros nas estruturas cla?ssicas de controle\ncom dois graus de liberdade. Uma forma para esse sinal e? a expressa\nna equac?a?o (2.12)\n\nr (k + j) = ?r (k + j ? 1) + (1 ??) r? (k + j) , (2.12)\n\nsendo ? um valor entre 0 e 1. Representa-se assim um filtro passa bai-\nxas de primeira ordem ajusta?vel para suavizar mais (? ? 1) ou menos\n\n\n\n36\n\n(? ? 0) a refere?ncia futura.\nRestric?o?es tambe?m podem ser utilizadas para limitar as ac?o?es de\n\ncontrole, o incremento de controle e os valores atingidos pela a sa??da\ndo processo. Como na realidade todos os processos esta?o sujeitos a\nrestric?o?es, e? poss??vel afirmar que essa e? uma das maiores vantagens dos\ncontroladores preditivos.\n\nPara descrever matematicamente as restric?o?es consideram-se as\nbarreiras impostas pela especificac?a?o de controle como limites na am-\nplitude dos sinais de controle, do atuador (umin,umax), limites nos in-\ncrementos dos sinais de controle do atuador (?umin,?umax) e limites\nnos sinais de sa??da (ymin,ymax). Assim:\n\numin ? Tu + u (k ? 1) ? umax\n?umin ? u ? ?umax\nymin ? y ? ymax.\n\nSendo T uma matriz com a dimensa?o adequada. Essas restric?o?es\npodem ser expressas como [3]:\n\nRu ? c\n\nDadas essas condic?o?es, o problema de otimizac?a?o de um MPC\ncomo DMC ou GPC passa a ser definido como:\n\nMin J\nsujeito a : Ru ? c\n\nEsse tipo de problema e? conhecido como problema de programa-\nc?a?o quadra?tica (Quadratic Programming , QP), pois uma func?a?o quadra?tica\ncom restric?o?es lineares deve ser otimizada. Para resolve?-lo devem-se\nutilizar me?todos nume?ricos, como me?todo de ponto interior [3].\n\n2.1.6 Obtenc?a?o da Lei de Controle\n\nO u?ltimo passo que compo?e a obtenc?a?o dos valores de controle\nnas estrate?gias de Controle Preditivo e? a determinac?a?o do valor de\n?u (k + j|k) com j = 0 ... Nu ? 1. Para isso seguem-se os seguintes\npassos:\n\n\n\n37\n\n1. ca?lculo do valor de y? (k + j|k) como func?a?o dos controles futuros;\n\n2. substituic?a?o dos valores de y? e w na func?a?o J;\n\n3. minimizac?a?o da func?a?o J considerando as ponderac?o?es e as res-\ntric?o?es, se existirem.\n\nDesta forma e? poss??vel obter uma seque?ncia de ac?o?es de controle\nfuturas. Mas a aplicac?a?o do valor de controle segue o conceito do\nhorizonte deslizante, assim, apesar de obter-se uma seque?ncia futura\nde controle, apenas a primeira ac?a?o de controle e? aplicada [3].\n\n2.2 CONTROLE PREDITIVO BASEADO EM MODELO NA?O LI-\nNEAR\n\nPara o controle preditivo de processos na?o lineares, a estrate?gia\ntradicionalmente utilizada para a obtenc?a?o de um modelo de predic?a?o,\nnecessa?rio para a tarefa de predizer as sa??das futuras, e? a linearizac?a?o.\nEsse tipo de estrate?gia e? comum, pois de fato pode-se dizer que todos\nos processos reais sa?o na?o lineares [1]. Para demonstrar essa te?cnica\nconsidera-se um modelo na?o linear MIMO (Multiple-Input Multiple-\nOutput ) de um processo como o da equac?a?o (2.13).\n\nx? = f(x,u)\ny(x) = h(x)\n\n(2.13)\n\nSendo, na equac?a?o (2.13), x um vetor com os estados do processo\ne y um vetor com as sa??das. A te?cnica de linearizac?a?o faz uso do conceito\nde pontos de equil??brio, que podem ser obtidos tomando x? = 0, ou\nf(xeq,ueq) = 0 e yeq = h(xeq), sendo respectivamente yeq, xeq e ueq as\nsa??das, os estados e as entradas nos pontos de equil??brio. Considerando\num ponto de equil??brio na origem, determina-se a equac?a?o.\n\nx? = Ax + Bu,\ny = Cx,\n\n(2.14)\n\nSendo A, B e C como segue em (2.15).\n\nA = ?f\n?x\n|xeq,ueq\n\nB = ?f\n?u\n|xeq,ueq\n\nC = ?h\n?x\n|xeq,ueq\n\n(2.15)\n\nOs autovalores da matriz A indicam a estabilidade dos pontos\nde equil??brio (xeq,ueq). Ale?m disso, o modelo apresentado na equac?a?o\n\n\n\n38\n\n(2.14) na forma de equac?o?es de estado cont??nuas pode ser convertido\nna forma de equac?o?es de estado discretas.\n\nNo entanto, quando a complexidade dos processos em questa?o\naumenta, e? necessa?rio recorrer a estrate?gias que considerem com maior\nprecisa?o as na?o linearidades impostas. Nesse a?mbito, encontram-se na\nliteratura diversas te?cnicas, que se analisam nas sec?o?es 2.2.1, 2.2.2 e\n2.2.3.\n\n2.2.1 Me?todos com Modelos de Processo Na?o Linear na Func?a?o\nObjetivo\n\nNesses casos e? poss??vel declarar o problema de otimizac?a?o im-\nposto pela estrate?gia por uma equac?a?o na forma:\n\nJ =\n\nN2?\nj=N1\n\n? (j) [y? (k + j|k) ?r (k + j)]2\n\n+\n\nNu?\nj=1\n\n? (j) [?u (k + j ? 1)]2 (2.16)\n\nSujeito a :\nx(k + 1) = f(x(k),u(k))\n\ny(k) = h(x(k)),\n\nsendo r o vetor com as refere?ncias futuras, x o vetor dos estados, y o\nvetor das sa??das, u o vetor com as entradas. Ainda, f e h sa?o func?o?es\ncont??nuas e diferencia?veis.\n\nNesses casos, a otimizac?a?o e? realizada por algor??tmos especiali-\nzados na soluc?a?o de func?o?es na?o lineares, como Sequential Quadratic\nProgramming (SQP), nos quais tambe?m sa?o utilizados o mecanismo de\nhorizonte deslizante.\n\nComo discutido em [9], esses me?todos possuem a desvantagem\nde apresentarem incerteza no tempo de resposta, devido a questo?es\niterativas de converge?ncia, m??nimos locais etc.\n\n2.2.2 Me?todos com Modelos de Processo Particulares\n\nQuando um processo em questa?o pode ser modelado por al-\nguns modelos particulares, podem-se utilizar me?todos de otimizac?a?o\n\n\n\n39\n\nespec??ficos obtendo soluc?o?es mais simples, com melhor desempenho.\nEsse e? o caso por exemplo das Se?ries de Volterra ou dos modelos de\nHammerstein [21] e [22].\n\nNo entanto, e? preciso que o caso em questa?o se enquadre na\naproximac?a?o, pois sena?o na?o e? poss??vel manter a robustez conforme\nalterem-se os pontos de operac?a?o.\n\n2.2.3 Me?todos com Modelos Linearizados\n\nEsse me?todo consiste em utilizar um LMPC que incorpore linea-\nrizac?o?es em va?rios pontos de operac?a?o e tambe?m te?cnicas de tratamento\nde erro de modelagem. Seguem alguns exemplos:\n\n\u2022 Me?todo min-max\n\nO objetivo dessa estrate?gia e? determinar uma ac?a?o de controle que\nminimize uma func?a?o objetivo auxiliar, J?. Sendo que essa func?a?o\nobjetivo auxiliar e? o valor ma?ximo da func?a?o objetivo, J, que\nengloba adicionalmente o conjunto de perturbac?o?es e incertezas\nao qual o processo esta? submetido. Ao considerar-se o conjunto\nde perturbac?a?o em w pode-se declarar esse problema como em\n(2.17).\n\nu = arg min J?(w,yp,up,u)\n\nJ? = arg max J(w,yp,up,u,w) (2.17)\n\nMesmo havendo alguns trabalhos que propoem estrate?gias para\ndiminuir o custo computacional dessa te?cnica [23], essa aborda-\ngem na?o se mostra computacionalmente atrativa em comparac?a?o\ncom outras estrate?gias NMPC.\n\n\u2022 Ponderac?a?o de mu?ltiplos modelos lineares\n\nPara alguns processos na?o lineares e? poss??vel obter diversos mo-\ndelos linearizados em va?rios pontos de equil??brio, {(xn,un)} com\nx? = f(xn,un) = 0 com n = 1 ...?. Em certas situac?o?es, o modelo\nna?o linear pode ser obtido atrave?s de combinac?o?es dos diversos\nmodelos linearizados em pontos de equil??brios diferentes.\n\nDado um modelo na?o linear, (2.18),\n\n\n\n40\n\nx? = f(x,u)\ny = h(x)\n\n(2.18)\n\ncaso existam diversos pontos de equil??brio, para o ponto (xi,ui),\ne? poss??vel obter o modelo (2.19).\n\nx? = Ai(x?xi) + Bi(u?ui)\ny = h(xi) + Ci(x?xi) (2.19)\n\nCom Ai =\n?f(x,u)\n?x\n|(xi,ui), Bi =\n\n?f(x,u)\n?u\n|(xi,ui) e Ci =\n\n?h(x,u)\n?x\n|(xi,ui).\n\nAinda, esses modelos cont??nuos podem ser discretizados, para Aid,\nBid e C\n\ni\nd. A ponderac?a?o proposta nessa estrate?gia pode ser repre-\n\nsentada por (2.20).\n\n[Ad,Bd] =\n\nN?\ni=1\n\n?i[A\ni\nd,B\n\ni\nd], onde\n\nN?\ni=1\n\n?i = 1 (2.20)\n\nEm geral, o esquema de ponderac?a?o na?o e? ta?o simples de se de-\nterminar. Esse tipo de abordagem foi estudada no contexto de\ncontrole MPC robusto [13], de MPC adaptativo [14] e de MPC\nescalonado [24].\n\n\u2022 Linearizac?o?es a cada instante de amostragem\nExistem estrate?gias que estendem o conceito de resposta livre e\nresposta forc?ada, usando um modelo na?o linear para obter a res-\nposta livre e um modelo linear para obter a resposta forc?ada.\nAssim o problema de otimizac?a?o na?o linear pode ser transfor-\nmado numa seque?ncia de problemas de otimizac?a?o linear [1]. No\nentanto, essa estrate?gia na?o garante a obtenc?a?o do o?timo nem a\nconverge?ncia do processo iterativo.\n\n2.3 PRATICAL NONLINEAR MODEL PREDICTIVE CONTROL\n\nA estrate?gia PNMPC, proposta por Plucenio [1], tem o objetivo\nde fornecer um caminho simples e eficaz para o Controle Preditivo de\nsistemas na?o lineares. A premissa inicial e? o fato de que em algor??tmos\ncomo o DMC e o GPC utiliza-se uma representac?a?o para a predic?a?o\nao longo do horizonte de predic?a?o, y?, como uma func?a?o do vetor de\nincrementos futuros de controle ?u, (2.21).\n\n\n\n41\n\ny? = f + G?u (2.21)\n\nSabe-se tambe?m que, mesmo atrave?s de caminhos diferentes, em\nambas as estrate?gias (GPC e DMC) o princ??pio de superposic?a?o pre-\nsente em modelos lineares permite uma forma simples de calcular y?.\nMas, para o caso na?o linear o princ??pio da superposic?a?o na?o e? verda-\ndeiro. Assim, busca-se descrever a evoluc?a?o dos estados do sistema\nao longo do horizonte de predic?a?o utilizando uma representac?a?o linear\ndos estados em relac?a?o aos incrementos de controle futuro, similar a?\nequac?a?o (2.21).\n\nComo, independentemente da linearidade dos sistemas, as u?nicas\nvaria?veis que podem alterar o valor das predic?o?es futuras sa?o de fato os\nincrementos futuros ?u, utiliza-se uma linearizac?a?o em func?a?o dessas\nvaria?veis e na?o o conceito de ponto de equil??brio. Enta?o, assume-se\nque as predic?o?es para esse caso, y?, dependem dos controles passados,\nup, das sa??das presentes e passadas, yp, e dos incrementos de controle\nfuturos, ?u, (2.22).\n\ny? = f(yp,up,?u) (2.22)\n\nAssim, com a aproximac?a?o proposta, o vetor de predic?o?es fica\nreescrito como em (2.23).\n\ny? = f + GPNMPC?u (2.23)\n\nSendo f = f(yp,up) e GPNMPC =\n?y?\n??u\n\no Jacobiano de y?. Vale\nressaltar que a representac?a?o das predic?o?es da equac?a?o (2.23) nada mais\ne? do que uma linearizac?a?o de primeira ordem da se?rie de Taylor para\n?u = 0, podendo tambe?m ser indicada como uma linearizac?a?o pela\nse?rie de Maclaurin.\n\nPara demonstrar a formulac?a?o da estrate?gia considera-se o sis-\ntema dina?mico na?o linear cont??nuo e diferencia?vel com uma entrada e\numa sa??da representado pela equac?a?o (2.24).\n\ny(k) = f(y(k ?na),y(k ?na + 1),...,y(k ? 1),\nu(k ?nu),u(k ?nu + 1),...,u(k ? 1)),\n\n(2.24)\n\nsendo na e nb os maiores atrasos de y e u respectivamente.\nConsiderando um horizonte de controle futuro m devera? aparecer\n\nas entradas futuras na forma representada na equac?a?o (2.25).\n\n\n\n42\n\nu(k) = u(k ? 1) + ?u(k)\nu(k + 1) = u(k) + ?u(k + 1) = u(k ? 1) + ?u(k)\n\n+?u(k + 1)\n... =\n\n...\nu(k + m? 1) = u(k ? 1) + ?u(k) + ?u(k + 1) + ...\n\n+?u(k + m? 1)\n\n(2.25)\n\nComo limita-se o horizonte futuro a m, deve-se assumir que as\nentradas posteriores a k + m? 1 sa?o iguais a u(k + m? 1). Utilizando\nenta?o a equac?a?o (2.24) para calcular as predic?o?es tem-se (2.26).\n\ny?(k + 1) = f(y(k ?na + 1),...,y(k),u(k ?nu + 1),...,u(k))\ny?(k + 2) = f(y(k ?na + 2),...,y(k + 1),u(k ?nu + 2),...,\n\nu(k + 1))\n... =\n\n...\ny?(k + p) = f(y?(k ?na + p),...,y?(k + p? 1),u(k ?nu + 1),...,\n\nu(k + m? 1))\n(2.26)\n\nSubstituindo as relac?o?es apresentadas em (2.25), o conjunto de\nequac?o?es apresentadas em (2.26) passa a ser dado por (2.27).\n\ny?(k + 1) = f(y(k ?na + 1),...,y(k),u(k ?nu + 1),...,u(k ? 1),\n?u(k))\n\ny?(k + 2) = f(y(k ?na + 2),...,y?(k + 1),u(k ?nu + 2),...,u(k ? 1),\n?u(k), ?u(k + 1))\n\n... =\n...\n\ny?(k + p) = f(y?(k ?na + p),...,y?(k + p? 1),u(k ?nu + 1),...,\nu(k ? 1),?u(k),?u(k + 1),...,?u(k + m? 1))\n\n(2.27)\nPara simplificar a notac?a?o pode-se denominar o conjunto de en-\n\ntradas passadas por up e o conjunto de sa??das passadas por yp. Dessa\nforma, as expresso?es em (2.27) se reduzem a?s expresso?es em (2.28).\n\n\n\n43\n\ny?(k + 1) = f(yp,up,?u(k))\ny?(k + 2) = f(yp,up,?u(k),?u(k + 1))\n\n... =\n...\n\ny?(k + p) = f(yp,up,?u(k), ?u(k + 1), ...,\n?u(k + m? 1))\n\n(2.28)\n\nObservando as equac?o?es presentes em (2.28) e? poss??vel concluir\nque as u?nicas varia?veis capazes de alterar o valor das sa??das futuras\nsa?o os incrementos futuros da ac?a?o de controle, ?u(k), ?u(k + 1), ... e\n?u(k + m? 1).\n\nDadas as definic?o?es em (2.29), sendo l um vetor de dimensa?o\nm x 1 com todos os elementos iguais a um e D uma matriz triangular\ninferior m x m com todos os elementos na?o nulos iguais a um, e? poss??vel\nsimplificar a notac?a?o.\n\nyp : Conjunto de valores passados e presente de y\nup : Conjunto de valores passados de u\nu : u0 + ?u\nu0 : u(k ? 1)l\n?u : D?u\n\n?u : [?u(k) ?u(k + 1) ... ?u(k + m? 1)]T\n\n(2.29)\n\nAssim, as predic?o?es em (2.27) podem ser reescritas como em\n(2.30).\n\ny? = f(yp,up,?u) (2.30)\n\nUtilizando enta?o o mesmo procedimento exposto na equac?a?o\n(2.23) e? poss??vel encontrar a equac?a?o (2.31).\n\ny = f(yp,up,u0) +\n?y?\n\n?u\n\n????\nu=u0\n\n?u (2.31)\n\nSubstituindo em (2.31) as equac?o?es (2.29) tem-se a equac?a?o (2.32).\n\n?y?\n\n?u\n?u =\n\n?y?\n\n??u\n?u (2.32)\n\nDefinindo finalmente f = f(yp,up,u0) e GPNMPC =\n?yp\n??u\n\n???\nu=u0\n\n,\n\nsendo f o vetor de predic?o?es que seria obtido para ?u = 0 e GPNMPC\no gradiente das saidas preditas com relac?a?o ao vetor dos incrementos\n\n\n\n44\n\nde controle ?u calculado para ?u = 0, retorna-se a? notac?a?o presente\nna equac?a?o (2.23):\n\ny? = f + GPNMPC?u.\n\n2.3.1 Obtenc?a?o Nume?rica das Predic?o?es\n\nDiferentemente das estrate?gias de Controle Preditivo lineares nas\nquais a te?cnica PNMPC se baseia, o GPC e o DMC, o enfoque dado\npor Plucenio em [1] foi a soluc?a?o nume?rica do problema de predizer\nas sa??das futuras. Isto se deve principalmente ao fato de existir uma\ngrande quantidade de caminhos diferentes para a modelagem de proces-\nsos na?o lineares, como por exemplo: redes neurais artificiais, modelos\nNARMAX etc. Assim, ao inve?s de pressupor a disponibilidade de um\nmodelo matema?tico do processo para se obter as predic?o?es, para esse\npropo?sito foi concebida uma estrutura compat??vel a modelagem de pro-\ncessos atrave?s de algor??tmos nume?ricos, aumentando a praticidade da\nte?cnica.\n\nEsse algor??tmo nume?rico necessa?rio para computar as predic?o?es\ndeve ser capaz de fornecer as sa??das futuras, y?, quando fornecidos os\nvalores dos controles e sa??das passados e o vetor de incrementos de con-\ntroles futuros, ?u. Assim, a cada iterac?a?o deve-se executar o seguinte\nprocedimento:\n\n1. obter o vetor p x 1, y?0, executando o algor??tmo que modela o\nprocesso, utilizando para isso incrementos futuros nulos ?u =\n[0 ... 0]T ;\n\n2. fazer f = y?0;\n\n3. obter o vetor y?1 executando o algor??tmo que modela o processo,\nutilizando para isso as entradas e sa??das passadas, com um va-\nlor ? pequeno e na?o nulo como primeiro incremento futuro, por\nexemplo\n\nuk?1\n1000\n\n. Para o caso de uma entrada: ?u = [? 0 ... 0]T ;\n\n4. fazer GPNMPC(: ,1) =\ny?1?y?0\n?\n\n, ou seja, a derivada parcial aproxi-\nmada para a sa??da e a entrada em questa?o;\n\n5. obter o vetor y?2 executando o algor??tmo que modela o processo\nutilizando para isso as entradas e sa??das passadas, com um valor ?\npequeno e na?o nulo como segundo incremento futuro, por exemplo\nuk?1\n1000\n\n. Para o caso de uma entrada: ?u = [0 ? ... 0]T ;\n\n\n\n45\n\n6. fazer GPNMPC(: ,2) =\ny?2?y?0\n?\n\n, ou seja, a derivada parcial aproxi-\nmada para a sa??da e a entrada em questa?o;\n\n7. proceder com o mesmo ca?lculo para se obter todas as colunas de\nGPNMPC.\n\nApo?s a obtenc?a?o do vetor de predic?o?es y? na forma de (2.23)\nutiliza-se o mesmo me?todo de ca?lculo nume?rico presente nos algor??tmos\nGPC e DMC para a obtenc?a?o da ac?a?o de controle. E? interessante\nressaltar que no procedimento de ca?lculo de ?u a u?nica diferenc?a do\nPNMPC perante o GPC e o DMC e? o fato da resposta livre ser na?o\nlinear.\n\n2.3.2 Modelo de Perturbac?a?o\n\nComo apresentado na sec?a?o 2.1.2 desse cap??tulo, as estrate?gias de\ncontrole preditivo contam geralmente com um modelo de perturbac?a?o\nincorporado ao mecanismo de predic?a?o. Essa estrutura torna a es-\ntrate?gia de controle capaz de rejeitar perturbac?o?es e ru??dos.\n\nA estrate?gia PNMPC utiliza uma versa?o expl??cita do mecanismo\nde correc?a?o das predic?o?es utilizado pelo algor??tmo GPC. Adiciona-se a\ncada predic?a?o a integral do erro de predic?a?o filtrado.\n\nFigura 2 \u2013 Modelo de perturbac?a?o do PNMPC\n\nO modelo de perturbac?a?o funciona como uma espe?cie de obser-\nvador, que fornece uma correc?a?o a ser adicionada a cada predic?a?o. A\nfigura 2 conte?m o diagrama de blocos desse observador utilizado no\nPNMPC. Pode-se perceber nela que a cada instante de amostragem\ncalcula-se o erro entre a sa??da que o preditor obte?m para o instante k,\ny?(k|k ? 1), e a sa??da real, y(k), equac?a?o 4.11.\n\ny(k) ? y?(k|k ? 1) = e(k) (2.33)\n\n\n\n46\n\nCom vistas a garantir a rejeic?a?o de perturbac?o?es em degrau, o\nerro de predic?a?o para o instante atual e? filtrado por um filtro passa-\nbaixas F = 1\n\nDF(z)\n, integrado e somado a? sa??da predita para o pro?ximo\n\ninstante, y?SC(k|k?1). Utilizando a representac?a?o em transformada de\nZ e assumindo ? = 1 ?z?1 tem-se (2.34).\n\nY(z) ? (z?1e(z)k1\n?\n\nF + Y?SC(z)) = E(z)\n\nY(z) ? y?SC(z) = E(z)(1 + z?1 k11?z?1 F)\nE(z) =\n\nDF(z)?\n(DF(z)?+z?1k1)\n\n(y(z) ? Y?SC(z))\n(2.34)\n\nSupondo que o sistema em malha fechada seja esta?vel, enta?o na\nvizinhanc?a de um ponto de operac?a?o e? poss??vel aplicar o teorema do\nvalor final. Considerando perturbac?o?es do tipo degrau, sendo ? a sua\nmagnitude, obte?m-se (2.35).\n\nE(z) =\nDF(z)?\n\n(DF(z)?+z?1ki)\n(y(z) ? y?SC(z))\n\ne(?) = limz?1(1 ?z?1)\nDF(z)?\n\n(DF(z)?+z?1ki)\n?\n\n1?z?1\n\ne(?) = limz?1\nDF(z)(1?z?1)\n\n(DF(z)?+z?1ki)\n? = 0\n\n(2.35)\n\nObservando a deduc?a?o (2.35) e? poss??vel concluir que e? garan-\ntido erro nulo em regime permanente (contanto que a perturbac?a?o em\nquesta?o tenha o comportamento de um sinal degrau).\n\nEm geral, deseja-se ale?m da garantia de erro nulo em regime\npermanente tambe?m que a rejeic?a?o do erro de perturbac?a?o respeite uma\ndina?mica determinada. Para isso, no modelo apresentado, a func?a?o\n\nde transfere?ncia\nE(z)\n\nY(z)?y?SC(z)\ndeve possuir polos relacionados com essa\n\nespecificac?a?o de rejeic?a?o. Assim, seja ?(k) = y(k) ? y?SC(k), pode-se\ndeterminar a func?a?o de transfere?ncia H(z) que relaciona ? a e, como\nem (2.36).\n\nH(z) =\nE(z)\n?(z)\n\nH(z) =\nDF(z)(1?z?1)\n\nDF(z)(1?z?1+z?1ki)\n(2.36)\n\nEnta?o, como esperado pelo projeto desse observador o trata-\nmento do erro de modelagem depende da parametrizac?a?o do filtro F e\ndo ganho integral ki. A equac?a?o (2.37) conte?m uma soluc?a?o direta e\nsimples para a determinac?a?o do filtro, o que torna a equac?a?o (2.36) na\nforma apresentada em (2.38).\n\n\n\n47\n\nF(z) =\n1\n\n1 ?fdz?1\n(2.37)\n\nH(z) =\nz2 ? (1 + fd)z + fd\n\nz2 ? (1 + fd ?ki)z + fd\n(2.38)\n\nO projeto do filtro pode ser resumido na determinac?a?o de uma\nfunc?a?o de transfere?ncia desejada para H(z). Caso utilize-se um po-\nlino?mio de segunda ordem para representar um filtro de dina?mica cri-\nticamente amortecida, e? poss??vel dizer que:\n\nz2 ? (1 + fd ?ki)z + fd = z2 ? 2az + a2 = (z ?a)2,\n\ne assim parametrizar fd = a\n2 e ki = 1 + a\n\n2 ? 2a.\nO ajuste de a envolve uma condic?a?o de compromisso entre a\n\nvelocidade de resposta a perturbac?a?o (para a ? 0) e a eliminac?a?o de\nru??dos, bem como a pro?pria robustez do controle em malha fechada.\n\n2.4 CONCLUSA?O\n\nNesse cap??tulo apresentaram-se os principais conceitos sobre Con-\ntrole Preditivo baseado em modelo linear, como o fato de utilizarem um\nmodelo de predic?a?o para as sa??das futuras e a utilizac?a?o de um procedi-\nmento espec??fico de otimizac?a?o para a obtenc?a?o dos valores de controle\nfuturo. A partir da apresentac?a?o dos principais conceitos de LMPC\nfoi poss??vel introduzir os controladores preditivos baseados em mode-\nlos na?o lineares. Assim, em seguida, apresentou-se uma classificac?a?o\ndas diversas te?cnicas bem como uma introduc?a?o das suas principais\ncaracter??sticas.\n\nPor fim foram apresentados os conceitos dos controladores PNM\nPC, as bases teo?ricas da sua formulac?a?o e alguns aspectos pra?ticos da\nsua implementac?a?o. Essas estrate?gias sa?o importantes por fornecerem\num caminho pra?tico e eficaz para o controle preditivo de processos\nna?o lineares. Lembrando que, conforme apresentado no cap??tulo 1,\nutilizar as vantagens proporcionadas pelo controle preditivo, como o\nuso de restric?o?es, em processos com complexas na?o linearidades e? uma\nimportante contribuic?a?o dadas as tende?ncias de maior complexidade\nnos processos encontrados nas aplicac?o?es pra?ticas.\n\nAssim, com a intenc?a?o de aumentar o espectro de aplicac?a?o do\nPNMPC e apresentar uma estrate?gia robusta para o controle preditivo\n\n\n\n48\n\nde processos na?o lineares com atraso de transporte, sera?o apresentados\nno cap??tulo 3 alguns conceitos a respeito de compensac?a?o de atraso de\ntransporte.\n\n\n\n49\n\n3 COMPENSAC?A?O DE ATRASO\n\nNo contexto do controle preditivo na?o linear em sistemas com\natraso de transporte e? importante dedicar uma atenc?a?o especial ao pro-\nblema de atraso. Para controladores cla?ssicos, por exemplo, na medida\nem que longos atrasos comec?am a aparecer nos processos a margem de\nfase do sistema comec?a a diminuir, diminuindo tambe?m a robustez do\ncontrole.\n\nCom o passar do tempo foram desenvolvidas algumas estrate?gias\npara contornar essa questa?o, como os compensadores de atraso, tambe?m\nconhecidos por preditores. Nesse cena?rio de predic?a?o, seria intuitivo\npensar que quanto melhor a predic?a?o mais qualificado seria o compen-\nsador de atraso, no entanto vale mencionar a seguinte passagem de\n[6]: \u201co melhor preditor na?o e? aquele que produz melhores predic?o?es em\nmalha aberta, mas sim o melhor desempenho em malha fechada\u201d.\n\nApesar da predic?a?o estar invariavelmente relacionada a um mo-\ndelo nominal, um preditor deve ser projetado para levar em consi-\nderac?a?o perturbac?o?es, erros de modelagem e ru??dos de controle. Isso\nporque compensadores de atraso robustos devem permitir melhores res-\npostas em malha fechada. As sec?o?es 3.1, 3.2 e 3.3 apresentam os com-\npensadores utilizados nesse trabalho.\n\n3.1 PREDITOR DE SMITH\n\nPara introduzir o problema de controle de processos com atraso\nde transporte considera-se o diagrama de blocos da figura 3, sendo r(t) o\nsinal de refere?ncia desejado para a sa??da, C(s) a func?a?o de transfere?ncia\nrepresentando o controlador, q(t) o sinal de perturbac?a?o no controle,\nG(s) a func?a?o de transfere?ncia representando o processo sem o atraso, L\no atraso de transporte e y(t) a sa??da. Por esse esquema e? poss??vel notar\na presenc?a do atraso nas equac?o?es caracter??sticas de malha fechada,\ncomo na equac?a?o (3.1).\n\nY(s)\nR(s)\n\n=\nC(s)G(s)e?sL\n\n1+C(s)G(s)e?sL\n\nY(s)\nQ(s)\n\n=\nG(s)e?sL\n\n1+C(s)G(s)e?sL\n\n(3.1)\n\nEssa presenc?a do atraso na equac?a?o caracter??stica ocasiona a\nreduc?a?o da margem de fase de malha fechada, degradando o desempe-\nnho ou ate? causando instabilidade. Isso inevitavelmente impo?e limites\n\n\n\n50\n\nFigura 3 \u2013 Diagrama de blocos para um controle com atraso\n\nao desempenho do controle em malha fechada, como detalhado em [6].\nUma soluc?a?o para esse problema e? uma estrutura de controle\n\nque permite uma predic?a?o da sa??da apo?s o atraso em adic?a?o com o erro\natual, proposta em [7].\n\nEssa estrate?gia, conhecida por preditor de Smith, esta? apresen-\ntada na figura 4, sendo Gn(s) a func?a?o de transfere?ncia que representa\no modelo nominal do processo, y?(t + Ln) a sa??da do modelo nominal\napo?s o atraso, Ln o atraso nominal, y? a sa??da do modelo nominal para\no instante atual, ep(t) o erro entre a sa??da real e a sa??da nominal para\no instante atual e yp(t) a predic?a?o para a sa??da fornecida pelo preditor\nde Smith.\n\nPara essa formulac?a?o as novas func?o?es de transfere?ncia, sem con-\nsiderar incertezas, ou seja, Gn(s) = G(s) e Ln = L, que relacionam a\nsa??da com a refere?ncia e com a perturbac?a?o sa?o as descritas na equac?a?o\n(3.2).\n\nY(s)\nR(s)\n\n=\nC(s)G(s)e?Ls\n\n1+C(s)G(s)\nY(s)\nQ(s)\n\n= G(s)e?Ls\n[\n1 ? C(s)G(s)e\n\n?Ls\n\n1+C(s)G(s)\n\n] (3.2)\n\nFigura 4 \u2013 Preditor de Smith\n\n\n\n51\n\nA estrate?gia criada por Smith foi um marco na literatura de\ncontrole de processos com atraso, principalmente por encontrar um\ncaminho para o atraso na?o interferir na equac?a?o caracter??stica de malha\nfechada, 1 + C(s)G(s), fazendo desaparecer o efeito de degradac?a?o da\nmargem de fase.\n\nOutras duas caracter??sticas muito importantes dessa estrate?gia\nsa?o o fato de permitir o projeto de um controlador para um sistema com\natraso a partir de um modelo sem atraso e tambe?m a percepc?a?o de um\nlimite de desempenho imposto pelo atraso. E? poss??vel concluir tal fato\nao considerar-se um controlador ideal, como o dado pela equac?a?o (3.3)\ne determinar a equac?a?o da resposta de controle, equac?a?o (3.4). Assim\npercebe-se que sempre existira? no m??nimo 2L de atraso na resposta a\nperturbac?a?o.\n\nC(s)\n\n1 + C(s)G(s)\n= G(s)?1 (3.3)\n\nY(s) = R(s)e?Ls + G(s)e?Ls[Q(s) ? Q(s)e?Ls]\n= R(s)e?Ls + G(s)e?Ls[1 ?e?Ls]Q(s) (3.4)\n\nApesar do grande avanc?o obtido no controle de processos com\natraso de transporte com a utilizac?a?o do preditor de Smith, um grande\nproblema e? o fato da resposta a? perturbac?a?o conter os polos de malha\naberta, como pode ser percebido na equac?a?o (3.2). Assim sendo, sa?o\nherdadas todas as desvantagens presentes em estrate?gias de controle\npor cancelamento.\n\n3.2 PREDITOR DE SMITH FILTRADO\n\nO preditor de Smith filtrado e? um compensador de atraso que\npermite a obtenc?a?o de uma melhor soluc?a?o de compromisso entre robus-\ntez e desempenho de rejeic?a?o de perturbac?a?o que o preditor de Smith.\nEssa estrate?gia foi desenvolvida por Normey-Rico e Camacho em [6]\natrave?s da inclusa?o de um filtro para eliminar os polos indesejados da\nresposta a? perturbac?a?o sem interferir na resposta ao seguimento de re-\nfere?ncia. Esse filtro, Fr(s), e? inserido na posic?a?o indicada na figura\n5.\n\nA configurac?a?o de controle apresentada no diagrama de blocos\nda figura 5 em um cena?rio sem a presenc?a de incertezas faz com que as\nrelac?o?es entre a refere?ncia e a perturbac?a?o se tornem as apresentadas\n\n\n\n52\n\nFigura 5 \u2013 Preditor de Smith filtrado\n\nnas equac?o?es (3.5). E assim Fr(s) pode ser ajustado para eliminar os\n\npolos indesejados de\nY(s)\nQ(s)\n\n.\n\nY(s)\nR(s)\n\n= C(s)G(s)e?Ls\n\nY(s)\nQ(s)\n\n= G(s)e?sLn\n[\n1 ? C(s)G(s)e\n\n?sLn Fr(s)\n1+C(s)G(s)\n\n]\n= G(s)e?sLn\n\n{\n1+[1?e?sLn Fr(s)]C(s)G(s)\n\n1+C(s)G(s)\n\n} (3.5)\nDeve-se ressaltar que para processos que na?o sa?o esta?veis na?o e?\n\nposs??vel utilizar o preditor de Smith filtrado1 da forma representada na\nfigura 5 devido a problemas com a estabilidade interna.\n\nEm uma implementac?a?o no dom??nio do tempo discreto, sendo\nTS o per??odo de amostragem, Gn(z) a discretizac?a?o com sustentador\nde ordem zero do modelo nominal do processo Gn(s), dn = Ln/TS o\natraso discreto e F(z) e C(z) discretizac?o?es de F(s) e C(s). Deve-se\nparametrizar S(z) = Gn(z)[1?Fr(z)z?dn ] em uma estrutura de blocos\ncomo a apresentada na figura 6.\n\nAssim, a pro?pria estrutura interna do controlador equivalente\nCeq(z), equac?a?o (3.6) no esquema de controle da figura 6, e? ajustada\npara eliminar os polos indesejados e acelerar a resposta a? perturbac?a?o.\n\nCeq(z) =\nC(z)Fr(z)\n\n1 + C(z)Gn(z)(1 ?zdFr(z))\n(3.6)\n\nEssa estrutura de controle evidencia a importa?ncia do filtro de\n\n1Como mencionado na sec?a?o 3.1, por ter a caracter??stica de controle por cance-\nlamento o preditor de Smith na?o pode ser utilizado para processos insta?veis\n\n\n\n53\n\nFigura 6 \u2013 Estrutura para implementac?a?o do preditor de Smith filtrado\n\nrobustez Fr(z). Em [2] detalha-se a influe?ncia do filtro na robustez\ndo processo controlado em malha fechada comparando as curvas de\nresposta em freque?ncia. Da relac?a?o em (3.7) e? poss??vel notar que dado\num modelo sem atraso Gn(z), um controlador C(z) e um limitante para\no erro de modelagem ?P?(ej?), o filtro de robustez deve ser sintonizado\nrespeitando-se uma fronteira robusta ??.\n\n|Fr(ej?)| ?\n????1 + C(ej?)Gn(ej?)C(ej?)Gn(ej?)\n\n?????P?(ej?)?1 = ??(j?) (3.7)\nMais uma vez deve-se destacar a importa?ncia do filtro por ter\n\num papel crucial na garantia da estabilidade interna quando processos\nBIBO insta?veis esta?o sendo controlados, ale?m de permitir o ajuste da\nresposta a perturbac?a?o e o acre?scimo da robustez do controle em malha\nfechada, existindo entre essas duas u?ltimas caracter??sticas um compro-\nmisso entre o aumento da velocidade ou o aumento da robustez.\n\n3.3 COMPENSAC?A?O DE ATRASO EM CONTROLADORES PRE-\nDITIVOS\n\nComo apresentado no cap??tulo 2, o esquema de predic?a?o rea-\nlizado nos controladores preditivos pode ser divido em uma resposta\nlivre e uma resposta forc?ada. Quando um processo sob controle apre-\nsenta atraso de transporte, naturalmente as predic?o?es produzidas pela\nresposta livre possuem a caracter??stica de um compensador de atraso.\nEssa caracter??stica de compensac?a?o de atraso pode ser evidenciada caso\n\n\n\n54\n\nanalise-se o esquema de predic?a?o realizado na resposta livre [2].\nE? interessante observar o comportamento da compensac?a?o de\n\natraso presente na determinac?a?o da resposta livre utilizando uma repre-\nsentac?a?o em espac?o de estados, pois observando-se o efeito das varia?veis\ndurante a recursa?o pode-se analisar tambe?m a robustez do esquema de\npredic?a?o. De fato, e? essa a abordagem utilizada nesse trabalho para\nanalisar a robustez das estrate?gias envolvidas.\n\nPara o caso em espac?o de estados, no qual um modelo como\no presente na equac?a?o (3.8) e? usado para representar o processo, as\npredic?o?es sa?o realizadas de forma recursiva, como em (3.9).\n\nx(k + 1) = Ax(k) + Bu(k ?d)\ny(k) = Cx(k)\n\n(3.8)\n\nx(k + 1|k) = Ax(k) + Bu(k ?d)\nx(k + 2|k) = Ax(k + 1|k) + Bu(k ?d + 1)\n\n= A2x(k) + ABu(k ?d) + Bu(k ?d + 1)\nx(k + 3|k) = Ax(k + 2|k) + Bu(k ?d + 2)\n\n= A3x(k) + A2Bu(k ?d) + ABu(k ?d + 1)\n+Bu(k ?d + 2)\n\n...\n\nx(k + d|k) = Adx(k) +\n?d\nj=1 A\n\nj?1Bu(k ? j)\n\n(3.9)\n\nAssim a predic?a?o para a sa??da apo?s o atraso y(k + d|k) pode ser\ndeterminada utilizando a expressa?o (3.10).\n\ny(k + d|k) = CAdx(k) + C\nd?\nj=1\n\nAj?1Bu(k ? j) (3.10)\n\nPode-se observar na equac?a?o (3.10) que a ac?a?o de controle u(k)\nsomente surtira? efeito no comportamento nominal do sistema apo?s o\ninstante k + d. Essa compensac?a?o de atraso impl??cita e? utilizada em\ncontroladores preditivos em espac?o de estados e tambe?m pode ser de-\nmonstrada sua equivale?ncia para controladores GPC [2].\n\nA compensac?a?o impl??cita existente nos controladores preditivos\ntradicionais fornece um me?todo de se tratar o problema do atraso. No\nentanto, com o tempo diversas desvantagens foram percebidas, como\no fato do aumento do esforc?o computacional necessa?rio para se tratar\nproblemas de controle em processos com grandes atrasos de transporte,\na dificuldade de se analisar a robustez e tambe?m o impedimento de se\n\n\n\n55\n\nutilizar estrate?gias eficientes para o tratamento de atraso de transporte,\ncomo o preditor de Smith filtrado [2].\n\nEm [17] propo?s-se uma te?cnica para simplificar o problema da\ncompensac?a?o de atraso nos controladores MPC, conhecida como com-\npensac?a?o de atraso expl??cita [2]. O objetivo dessa te?cnica e? separar o\nproblema de predic?a?o do atraso do problema de otimizac?a?o, simplifi-\ncando o ca?lculo de controle bem como fornecendo uma alternativa para\nse analisar separadamente a influe?ncia do mecanismo de compensac?a?o\nde atraso na robustez do controle em malha fechada.\n\nAssim, considerando um sistema como o representado na equac?a?o\n(3.8) e a seguinte func?a?o objetivo:\n\n? =\n1\n\n2\n\nN?\nk=0\n\n[x(k)TQxx(k) + u(k)\nTQuu(k)],\n\npara o caso nominal e para N > d, dado que u(k) somente surtira?\nefeito apo?s x(k + d + 1) e? poss??vel alterar as varia?veis d passos a frente,\nconsiderando o modelo da equac?a?o (3.11), sendo x?(k) = x(k + d|k).\n\nx?(k) = Ax?(k) + Bu(k)\ny(k + d) = Cx?(k)\n\n(3.11)\n\nMais uma vez, no caso nominal,\n\nx?(k) = x(k + d|k) = Adx(k) +\n?d\nj=1 A\n\nj?1Bu(k ? 1)\n\n= Adx(k) + [Ad?1B Ad?2B ... B]\n\n?\n? u(k ?d)u(k ?d? 1)\n\n. . .u(k ? 1)\n\n?\n? .\n\nEssa substituic?a?o de varia?veis permite redefinir a func?a?o objetivo\npara uma nova formulac?a?o, equac?a?o (3.12). Sendo N\n\n?\n= N ?d.\n\n?\n?\n\n=\n1\n\n2\n\nN\n??\n\nk=0\n\n[x?(k)TQxx?(k) + u(k)\nTQuu(k)] (3.12)\n\nPode-se notar que a relac?a?o (3.13) e? respeitada, ja? que ? ? ?\n?\n\ne?\num termo constante, que na?o depende das varia?veis de controle a serem\naplicadas a partir do instante atual, e portanto na?o ira? influenciar o\nresultado no procedimento de otimizac?a?o.\n\n\n\n56\n\n? = ?\n?\n+\n\n1\n\n2\n\nd?1?\nk=0\n\n[x(k)TQxx(k)] (3.13)\n\nE? interessante observar tambe?m que utilizando tal representac?a?o\no controle em malha fechada se assemelha ao que esta? apresentado no fi-\ngura 7. Assim, essa compensac?a?o expl??cita permite que um controlador\nMPC possa ser ajustado em refere?ncia a um processo sem atraso, pois\numa predic?a?o realizada pela compensac?a?o expl??cita e? utilizada para o\nca?lculo do pro?ximo valor de controle.\n\nFigura 7 \u2013 Controle MPC com compensac?a?o expl??cita do atraso\n\nNo a?mbito desse trabalho a compensac?a?o expl??cita do atraso pos-\nsibilita a ana?lise do compensador de atraso no que diz respeito a ro-\nbustez. Ale?m do mais, a partir dessa ana?lise e? poss??vel tambe?m propor\nnovos esquemas de compensac?a?o e a utilizac?a?o de esquemas mais ro-\nbustos, como e? o caso do preditor de Smith filtrado.\n\nSabe-se no entanto que tradicionalmente grande parte dos es-\nquemas de compensac?a?o de atraso, principalmente aqueles baseados no\npreditor de Smith, sa?o utilizados em uma representac?a?o entrada-sa??da.\nCom o intuito de realizar a conversa?o de modelos entrada-sa??da para\nespac?o de estados sem a necessidade de estimadores podem ser utiliza-\ndas algumas representac?o?es na?o-m??nimas, [3], [2].\n\n3.4 CONCLUSA?O\n\nNesse cap??tulo apresentaram-se os principais conceitos a respeito\nde compensac?a?o de atraso utilizados nesse trabalho. Na primeira sec?a?o\nforam apresentados os principais conceitos a respeito do preditor de\nSmith, o que permitiu um embasamento teo?rico para o conteu?do apre-\n\n\n\n57\n\nsentado na sec?a?o 3.2, preditor de Smith filtrado.\nPor u?ltimo foram apresentadas tambe?m as principais considera-\n\nc?o?es a respeito da compensac?a?o de atraso realizada em controladores\npreditivos, bem como uma alternativa de compensac?a?o de atraso, a\ncompensac?a?o expl??cita, que traz maior flexibilidade na compensac?a?o de\natraso permitindo o estudo da robustez, a proposic?a?o de modificac?o?es\npara contornar problemas de robustez, bem como a aplicac?a?o de outras\nestrate?gias de predic?a?o.\n\nDadas as introduc?o?es realizadas nos cap??tulos 2 e 3 e? poss??vel\nestudar de forma mais detalhada a robustez de controladores prediti-\nvos na?o lineares, como o PNMPC, quando configurados para controlar\nprocessos com atraso de transporte, utilizando ainda variadas formas\nde compensac?a?o de atraso. Sendo assim, no cap??tulo 4 sera? estudado o\ncomportamento das incertezas no esquema de compensac?a?o de atraso\ndo PNMPC, com a finalidade de avaliar a sua robustez, bem como sera?o\npropostas modificac?o?es e alterac?o?es nesse esquema de compensac?a?o com\na finalidade de atingir um comportamento de elevada robustez.\n\n\n\n58\n\n\n\n59\n\n4 PNMPC COM COMPENSAC?A?O DE ATRASO\nROBUSTA\n\nPara se obter uma estrate?gia de Controle Preditivo com com-\npensac?a?o de atraso robusta e? necessa?rio primeiramente explorar as\nsuas caracter??sticas relacionadas ao controle de processos com atraso\nde transporte.\n\nAssim, a partir do que esta? apresentado no cap??tulo 2, e? poss??vel\nperceber que a estrate?gia de controle PNMPC, do ponto de vista da\ncompensac?a?o de atraso de transporte, utiliza um esquema de controle\nsemelhante ao utilizado no GPC e no DMC. Isso faz com que toda\na problema?tica relacionada a? compensac?a?o impl??cita de atraso que es-\nses tipos de controladores apresentam (ja? que no procedimento de oti-\nmizac?a?o e? poss??vel apenas desconsiderar os instantes de predic?a?o nos\nquais o efeito do atraso e? aparente) tambe?m ocorra nas aplicac?o?es do\nPNMPC em processos com atraso de transporte.\n\nAle?m disso, a compensac?a?o de atraso realizada em ambos os con-\ntroladores preditivos tem o comportamento robusto afetado de maneira\nsignificativa pelo tamanho do atraso nominal, o que na?o e? interessante\ndo ponto de vista pra?tico para aplicac?a?o em sistemas com atrasos longos\n[2].\n\nPara ilustrar a baixa robustez do esquema de compensac?a?o de\natraso impl??cito no PNMPC considere o controle do processo apresen-\ntado na equac?a?o (4.1), [25], com a diferenc?a de que e? considerada aqui\na presenc?a de um atraso de transporte entre a varia?vel de controle e a\nvaria?vel medida. A inclusa?o do atraso e? interessante ja? que, como apre-\nsentado nas sec?o?es iniciais, e? comum a presenc?a desse tipo de feno?meno\nem grande parte das aplicac?o?es pra?ticas.\n\ny(k) =\n2,5y(k ? 1)y(k ? 2)\n\n1 + y(k ? 1)2 + y(k ? 2)2\n\n+ 0,3 cos(0,5(y(k ? 1) + y(k ? 2))) + 1,2u(k ? 1 ? 60)\n(4.1)\n\nPara controlar esse processo, parametriza-se um controlador PN\nMPC com horizonte de predic?a?o efetivo de 3 amostras (desconsiderando\nos 60 instantes iniciais nos quais o efeito do atraso e? percebido), N1 = 61\ne N2 = 63, o horizonte de controle em 3, Nu = 3, ponderac?o?es na\npredic?a?o de 0,001, ? = 0,001, e ponderac?o?es no controle de 1, ? = 1,\n\n\n\n60\n\n[1]. Ainda, para diminuir o efeito de ru??dos, ajusta-se o para?metro do\nfiltro que estima o erro de predic?a?o em 0,7, a = 0,7.\n\nA figura 8 apresenta esse processo controlado pelo controlador\nPNMPC configurado e sem a presenc?a de incertezas. Em seguida e?\nutilizado um modelo com 17% a menos de incerteza no atraso, figura\n9. Analisando ambas as simulac?o?es de controle e? poss??vel perceber\nque um ajuste do PNMPC capaz de obter um bom resultado, tanto\nno que diz respeito ao seguimento de refere?ncia quanto a eliminac?a?o\ndas perturbac?o?es constantes, passa a instabilizar o processo controlado\nquando e? utilizado um modelo incerto para predizer as suas sa??das. Isso\nocorre pois o esquema de compensac?a?o do atraso na?o e? robusto a essa\ncondic?a?o de incerteza.\n\n0 100 200 300 400 500 600 700\n0\n\n1\n\n2\n\n3\n\n4\n\ntempo (amostra)\n\nsa\n\u00edd\n\na\n\n \n\n \n\nsa\u00edda\nrefer\u00eancia\nperturba\u00e7\u00e3o\n\n0 100 200 300 400 500 600 700\n0\n\n1\n\n2\n\n3\n\ntempo (amostra)\n\ne\nn\n\ntr\na\n\nd\na\n\nFigura 8 \u2013 Simulac?a?o de controle PNMPC sem erros de modelagem\n\n0 100 200 300 400 500 600 700\n0\n\n2\n\n4\n\n6\n\ntempo (amostra)\n\nsa\n\u00edd\n\na\n\n \n\n \n\nsa\u00edda\nrefer\u00eancia\nperturba\u00e7\u00e3o\n\n0 100 200 300 400 500 600 700\n0\n\n1\n\n2\n\n3\n\n4\n\ntempo (amostra)\n\ne\nn\n\ntr\na\n\nd\na\n\nFigura 9 \u2013 Simulac?a?o de controle PNMPC com erros de modelagem\n\nEm vista desses problemas torna-se importante estudar o es-\nquema de compensac?a?o de atraso e o modelo de perturbac?a?o utilizados\nno PNMPC para avaliar a possibilidade de elaborar maneiras de apri-\n\n\n\n61\n\nmorar a robustez desses controladores.\n\n4.1 MODIFICAC?A?O NO ESQUEMA DE CORREC?A?O DA PREDI-\nC?A?O NO PNMPC\n\nOs controladores preditivos utilizam originalmente uma estrate?-\ngia de compensac?a?o de atraso impl??cita, na qual e? poss??vel eliminar a\ninflue?ncia do atraso na dina?mica de malha fechada dos sistemas contro-\nlados simplesmente ignorando os instantes preditos iniciais, referentes\nao atraso de transporte, no ca?lculo do pro?ximo incremento de controle.\nNo entanto, para que eles atinjam um desempenho satisfato?rio e? essen-\ncial possu??rem a capacidade de eliminar o efeito de perturbac?o?es cons-\ntantes, ja? que na maioria das aplicac?o?es elas estara?o invariavelmente\npresentes.\n\nPara alcanc?ar esse objetivo e? necessa?rio que as perturbac?o?es se-\njam rejeitadas em regime permanente, e assim a sa??da predita convirja\npara a sa??da real mesmo sob a presenc?a de perturbac?o?es constantes.\nIsso e? poss??vel atrave?s da presenc?a de um modelo de perturbac?a?o in-\ncorporado no esquema de predic?a?o.\n\nComo mencionado no cap??tulo 3, o modelo de perturbac?a?o ado-\ntado originalmente no PNMPC obte?m uma estimativa das incertezas\nfuturas atrave?s de um observador particular, que realiza um tratamento\nno erro de predic?a?o do instante anterior. Esse mecanismo esta? repre-\nsentado na figura 10, na qual y(k) representa a sa??da real no instante\nk, ysc(k|k ? 1) representa a sa??da predita para o instante k sem con-\nsiderar uma parcela adicional proveniente do modelo de perturbac?a?o,\nz?1 representa o operador atraso, ki o ganho do integrador e DF(z) o\ndenominador do filtro.\n\nFigura 10 \u2013 Modelo de perturbac?a?o do PNMPC\n\nAssim percebe-se que o erro de predic?a?o do instante anterior\ne? filtrado e integrado para se obter uma espe?cie de correc?a?o para as\npredic?o?es futuras.\n\n\n\n62\n\nPara avaliar a robustez desse esquema de compensac?a?o do atraso\ne? interessante designar separadamente o conjunto de predic?o?es referen-\ntes a? compensac?a?o do atraso do conjunto de predic?a?o apo?s o efeito do\natraso. Esse tipo de representac?a?o, como apresentado no cap??tulo 3, e?\ntambe?m conhecido como compensac?a?o de atraso expl??cita, [2].\n\n4.1.1 Ana?lise da Incerteza Equivalente em um PNMPC Linear\n\nPara analisar o efeito da correc?a?o de incertezas utilizada na es-\ntrate?gia PNMPC, inicia-se o estudo a partir do problema desenvolvido\ncom um modelo linear. Essa escolha se justifica pela simplicidade da\nferramenta de ana?lise de robustez a ser utilizada. Assim considere a\nrepresentac?a?o discreta e invariante no tempo de um processo, como em\n(4.2).\n\nx(k + 1) = Ax(k) + Bu(k ?d) + w(k)\ny(k) = Cx(k)\n\n(4.2)\n\nNa equac?a?o (4.2), d representa o atraso nominal, x(k) ? Rn e?\no vetor de estados em k, u(k) ? Rp e? o vetor de sinais de controle,\nw(k) ? Rn representa a perturbac?a?o aditiva e y(k) ? Rq o vetor de\nsa??das, uma combinac?a?o linear dos estados.\n\nAqui representam-se as incertezas e as perturbac?o?es relacionadas\nao modelo atrave?s do vetor w(k), que de forma aditiva incorpora essas\ninformac?o?es ao modelo nominal escolhido para representar um processo\nlinear em questa?o. Essa forma de representac?a?o e? interessante, pois\nale?m de ser facilmente obtida, desde que no pro?ximo instante de amos-\ntragem da sa??da real seja subtra??da a sa??da nominal, (4.3), e? capaz de\nrepresentar grande parte das incertezas e perturbac?o?es associadas a um\nmodelo.\n\nw(k) = x(k + 1) ? [Ax(k) + Bu(k ?d)] (4.3)\n\nPara a determinac?a?o das incertezas, na equac?a?o (4.3) tem-se:\nx(k + 1) representando o vetor de estados obtidos no instante k + 1 e\nAx(k) + Bu(k ?d) a predic?a?o nominal do pro?ximo instante de amos-\ntragem.\n\n\n\n63\n\nA predic?a?o expl??cita permite, como em um preditor de Smith,\ncalcular a ac?a?o de controle com base no sistema sem atraso e aplica?-la\nno sistema com atraso usando o valor predito, figura 11. Isso e? poss??vel\ndevido a? predic?a?o para a sa??da em x(k + d) no instante k, indicada por\nx?(k+d|k). Percebe-se aqui tambe?m a generalidade dessa demonstrac?a?o,\npois ao se representar a lei de controle por u(k) = ?(.), a ana?lise engloba\ndiversas estrate?gias de controle na?o lineares, como o PNMPC.\n\nFigura 11 \u2013 PNMPC e a predic?a?o expl??cita\n\nEssa predic?a?o deve possuir duas principais caracter??sticas, x?(k +\nd|k) = x(k + d) se w(k) = 0, ?k ? 0 e x(k + d|k) ? x(k + d) se\nw(k) ? wss, no qual wss e? um valor real e constante. O que e? conhecido\ncomo caracter??stica de seguimento de predic?a?o nominal e de rejeic?a?o de\nperturbac?a?o constante na predic?a?o, [26].\n\nCaso as incertezas fossem conhecidas seria poss??vel predizer os\nestados atrave?s da utilizac?a?o de um simples preditor o?timo, como na\nequac?a?o (4.4).\n\nx(k + 1) =Ax(k) + Bu(k ?d) + w(k)\nx(k + 2) =Ax(k + 1|k) + Bu(k ?d + 1) + w(k + 1)\nx(k + 2) =A[Ax(k) + Bu(k ?d) + w(k)]\n\n+ Bu(k ?d + 1) + w(k + 1)\nx(k + 2) =A2x(k) + ABu(k ?d) + Bu(k ?d + 1)\n\n+ Aw(k) + w(k + 1)\n\n... =\n...\n\n\n\n64\n\nx(k + d) =Adx(k) +\n\nd?\nj=1\n\nAj?1Bu(k ? j)\n\n+\n\nd?1?\nj=0\n\nAd?1?jw(k + j) (4.4)\n\nMas como as incertezas futuras na?o sa?o conhecidas e? preciso\nutilizar alguma espe?cie de observador para obte?-las. De fato, como\napresentado no cap??tulo 2 e como esta? representado na figura 10, a\nestrate?gia PNMPC incorpora um observador espec??fico para estimar\nas incertezas futuras. Em [1] demonstram-se as propriedades de se-\nguimento da predic?a?o nominal e tambe?m de rejeic?a?o da perturbac?a?o\nconstante nas predic?o?es do PNMPC. Ale?m do observador utilizado no\nPNMPC tambe?m e? poss??vel estimar as incertezas atrave?s de outros\nobservadores, a exemplo do utilizado em [27].\n\nUma representac?a?o semelhante para as correc?o?es aplicadas ori-\nginalmente pelo PNMPC e? indicar a utilizac?a?o de um observador para\nestimar a perturbac?a?o em regime, wss. A sa??da desse observador, que\npode ser indicada por ?(k), deve respeitar a relac?a?o\n\nlim\nk??\n\n?(k) = lim\nk??\n\nw(k) = wss,\n\nja? que o modelo de perturbac?a?o utilizado no PNMPC garante a rejeic?a?o\nde perturbac?a?o constante na predic?a?o.\n\nEssa adic?a?o da correc?a?o referente ao modelo de perturbac?a?o e?\nrazoa?vel para todos os instantes de predic?a?o do horizonte, visto que\n?(k) representa a informac?a?o mais pro?xima de wss em k e assume-se\nque w(k) ? wss. Dessa forma, o modelo de perturbac?a?o do PNMPC faz\n?(k+j) = ?(k), ?j. Essa nova considerac?a?o leva a? predic?a?o apresentada\nem (4.5), sendo x(k + t|k) a predic?a?o para x(k + t) no instante k, que\nde fato e? o que implicitamente e? realizado no controlador PNMPC.\n\nx?(k + 1|k) =Ax(k) + Bu(k ?d) + ?(k)\nx?(k + 2|k) =Ax?(k + 1|k) + Bu(k ?d + 1) + ?(k)\nx?(k + 2|k) =A[Ax(k) + Bu(k ?d) + ?(k)]\n\n+ Bu(k ?d + 1) + ?(k)\n\n\n\n65\n\nx?(k + 2|k) =A2x(k) + ABu(k ?d) + Bu(k ?d + 1)\n+ A?(k) + ?(k)\n\n... =\n...\n\nx?(k + d|k) =Adx(k) +\nd?\nj=1\n\nAj?1Bu(k ? j) +\nd?1?\nj=0\n\nAd?1?j?(k)\n\n(4.5)\n\nSob o ponto de vista da estrate?gia de controle e? interessante rela-\ncionar o processo a controlar mais o esquema de predic?a?o a um modelo\nequivalente de controle. Esse modelo equivalente pode ser representado\ncomo nas equac?o?es (4.6) e (4.7), nas quais ?(k) e? a incerteza aditiva\nequivalente e ?(k) e? o erro de predic?a?o. E? poss??vel ainda observar a\nause?ncia do atraso entre dois instantes subsequentes nesse modelo equi-\nvalente, caracter??stica essa incorporada pela compensac?a?o do atraso via\nmodelo de predic?a?o.\n\nx?(k + d + 1|k + 1) = Ax?(k + d|k) + Bu(k) + ?(k) (4.6)\nx(k + d) = x?(k + d|k) + ?(k + d) (4.7)\n\nA propagac?a?o da incerteza real nesse modelo equivalente causada\npelo modelo de predic?a?o e? refletida em ?, assim, a sua ana?lise pode\nrevelar as propriedades de robustez do esquema de controle equivalente,\nquando da presenc?a do modelo de predic?a?o. Para isso e? necessa?rio\nrelacionar ?(k) e ?(k) a w(k) e verificar o comportamento do modelo\nde perturbac?a?o sob a perspectiva do modelo de predic?a?o.\n\nA partir da equac?a?o (4.6) e? poss??vel perceber que ?(k) e? equiva-\nlente a:\n\n?(k) = x?(k + d + 1|k + 1) ? [Ax?(k + d|k) + Bu(k)],\n\ne assim atrave?s da relac?a?o entre ?(k) e w(k) obte?m-se meios para ava-\nliar a robustez do esquema de compensac?a?o de atraso do controlador\nPNMPC (quando parametrizado para controlar processos lineares).\n\nAntes de estender a relac?a?o exposta em (4.6) e? poss??vel demons-\ntrar que x?(k +d+ 1|k + 1) pode ser obtido utilizando o mesmo esquema\nde predic?a?o utilizado para se obter x?(k + d|k), como em (4.5), desde\n\n\n\n66\n\nque seja tomado x(k + 1) como o ponto de refere?ncia inicial, resultando\nna equac?a?o (4.8).\n\nx?(k + 1|k + 1) =Ax(k + 1) + Bu(k ?d + 1) + ?(k + 1)\nx?(k + 2|k + 1) =Ax?(k + 2|k + 1) + Bu(k ?d + 2) + ?(k + 1)\nx?(k + 2|k + 1) =A[Ax(k + 1) + Bu(k ?d + 1) + ?(k + 1)]\n\n+ Bu(k ?d + 2) + ?(k + 1)\nx?(k + 2|k + 1) =A2x(k + 1) + ABu(k ?d + 1) + Bu(k ?d + 2)\n\n+ A?(k + 1) + ?(k + 1)\n\n... =\n...\n\nx?(k + d|k + 1) =Adx(k + 1) +\nd?\nj=1\n\nAj?1Bu(k ? j + 1)\n\n+\n\nd?1?\nj=0\n\nAd?1?j?(k + 1) (4.8)\n\nE atrave?s das predic?o?es x?(k + d|k), equac?a?o (4.5), e x?(k + d +\n1|k + 1), equac?a?o (4.8), e? poss??vel estender a equac?a?o (4.6) na forma\napresentada em (4.9).\n\n?(k) =Adx(k + 1) +\n\nd?\nj=1\n\nAj?1Bu(k + 1 ? j) +\nd?1?\nj=0\n\nAd?1?j?(k + 1)\n\n? [A(Adx(k) +\nd?\nj=1\n\nAj?1Bu(k ? j) +\nd?1?\nj=0\n\nAd?1?j?(k)) + Bu(k)]\n\n?(k) =Adx(k + 1) + Bu(k) +\n\nd?\nj=2\n\nAj?1Bu(k + 1 ? j)\n\n+\n\nd?1?\nj=0\n\nAd?1?j?(k + 1) ? [A(Adx(k) + Ad?1Bu(k ?d)\n\n+\n\nd?1?\nj=1\n\nAj?1Bu(k ? j) +\nd?1?\nj=0\n\nAd?1?j?(k)) + Bu(k)]\n\n\n\n67\n\n?(k) =Adx(k + 1) +\n\nd?1?\nj=1\n\nAjBu(k ? j) +\nd?1?\nj=0\n\nAd?1?j?(k + 1)\n\n?AAdx(k) ?AdBu(k ?d) ?A\nd?1?\nj=1\n\nAj?1Bu(k ? j)\n\n?A\nd?1?\nj=0\n\nAd?1?j?(k) + Bu(k) ?Bu(k)\n\n?(k) =Ad[x(k + 1) ?Ax(k) ?Bu(k ?d)] +\nd?1?\nj=1\n\nAjBu(k ? j)\n\n?A\nd?1?\nj=1\n\nAj?1Bu(k ? j) +\nd?1?\nj=0\n\nAd?1?j?(k + 1)\n\n?A\nd?1?\nj=0\n\nAd?1?j?(k)\n\n?(k) =Ad[x(k + 1) ?Ax(k) ?Bu(k ?d)] +\nd?1?\nj=1\n\nAjBu(k ? j)\n\n?\nd?1?\nj=1\n\nAjBu(k ? j) +\nd?1?\nj=0\n\nAd?1?j?(k + 1) ?\nd?1?\nj=0\n\nAd?j?(k)\n\n?(k) =Ad[x(k + 1) ?Ax(k) ?Bu(k ?d)] + ?(k + 1) ?Ad?(k)\n\n+\n\nd?2?\nj=0\n\nAd?1?j?(k + 1) ?\nd?1?\nj=1\n\nAd?j?(k)\n\n?(k) =Ad[x(k + 1) ?Ax(k) ?Bu(k ?d) ??(k)] + ?(k + 1)\n\n+\n\nd?2?\nj=0\n\nAd?1?j?(k + 1) ?\nd?2?\nj=0\n\nAd?1?j?(k)\n\n=Ad[x(k + 1) ?Ax(k) ?Bu(k ?d) ??(k)] + ?(k + 1)\n\n+\n\nd?2?\nj=0\n\nAd?j?1[?(k + 1) ??(k)]\n\n(4.9)\n\nAssim, a incerteza aditiva equivalente, modificada pelo esquema\nde predic?a?o, pode ser descrita como na equac?a?o (4.10).\n\n\n\n68\n\n?(k) =Ad[w(k) ??(k)] +\nd?1?\nj=1\n\nAj[?(k + 1) ??(k)] + ?(k + 1) (4.10)\n\nEm primeiro lugar, percebe-se que as duas propriedades funda-\nmentais de seguimento de predic?a?o nominal e rejeic?a?o de perturbac?a?o\nconstante na predic?a?o continuara?o presentes, mesmo com a utilizac?a?o\nde um esquema de compensac?a?o expl??cita.\n\nIsso porque se w(k) ? wss, o modelo de perturbac?a?o utilizado\nfaz com que tanto ?(k) ? wss quanto ?(k + 1) ? wss e assim, da\nequac?a?o (4.10), e? poss??vel perceber que ?(k) ? wss. Ja? no caso de\nw(k) = 0, o modelo de perturbac?a?o do PNMPC faz com que ?(k) = 0,\n?(k + 1) = 0 e assim tambe?m ?(k) = 0. Ou seja, pelos casos citados e?\nposs??vel perceber que x(k +d+ 1|k + 1) ? x(k +d+ 1) e que respeitam-\nse as propriedades de seguimento de predic?a?o nominal e rejeic?a?o de\nperturbac?a?o constante na predic?a?o.\n\nAinda, percebe-se que caso a matriz A seja positiva definida, e\nassim o modelo nominal seja insta?vel, quanto maior o atraso nominal\nmaior sera? a norma induzida1 da matriz Ad, o que tende a aumentar a\nnorma da incerteza aditiva equivalente, ?. E assim, quando o modelo\nnominal for insta?vel, a norma de ? tendera? a crescer conforme cresc?a o\natraso nominal, o que prejudicara? o desempenho do processo controlado\nem malha fechada, ja? que a predic?a?o e? usada para o ca?lculo do pro?ximo\nincremento de controle e ? afeta diretamente a predic?a?o.\n\nO outro ponto em questa?o refere-se ao comportamento da varia?vel\nde correc?a?o, ?, aplicada a cada elemento de predic?a?o. E? interessante\nnotar que na incerteza equivalente ela se apresenta de forma acumu-\nlada. Isso acontece, pois, como a cada instante de predic?a?o e? aplicado\no mesmo valor de correc?a?o, apo?s o per??odo referente ao atraso nominal\nesses valores va?o se acumulando continuamente. E assim, de forma\nsemelhante, esse acu?mulo pode aumentar a norma de ? e tambe?m pre-\njudicar a robustez em malha fechada.\n\nEm contrapartida da ana?lise da incerteza equivalente tem-se\ntambe?m a ana?lise do erro de predic?a?o, apresentada na equac?a?o (4.11).\nE? interessante notar que ?(k) tera? seu efeito notado apenas na resposta\ntemporal da rejeic?a?o das perturbac?o?es constantes, sem afetar a robustez\ndo controle em malha fechada. Vale ressaltar que problemas relacio-\nnados a robustez sa?o origina?rios no fato de que a informac?a?o utilizada\n\n1A norma induzida de uma matriz e? definida por ||A|| , max\nw 6=0\n\n||Aw||\n||w||\n\n\n\n69\n\npara o ca?lculo do pro?ximo incremento de controle, nesse esquema de\ncompensac?a?o de atraso, e? x(k + d|k), a qual depende diretamente da\nincerteza equivalente, ?(k).\n\n?(k + d) =x(k + d) ? x?(k + d|k)\n\n=[Adx(k) +\n\nd?\nj=1\n\nAj?1Bu(k ? j) +\nd?1?\nj=0\n\nAd?1?jw(k + d? j)]\n\n? [Adx(k) +\nd?\nj=1\n\nAj?1Bu(k ? j) +\nd?1?\nj=0\n\nAd?1?j?(k)]\n\n?(k + d) =\n\nd?1?\nj=0\n\nAd?j?1[w(k + j) ??(k)],\n\ne assim,\n\n?(k) =\n\nd?1?\nj=0\n\nAd?j?1[w(k ?d + j) ??(k ?d)].\n\nAinda, utilizando algumas manipulac?o?es, e? poss??vel sintetizar\nesse resultado, obtendo:\n\n?(k) = Ad?1[w(k ?d) ??(k ?d)] + Ad?2[w(k ?d + 2) ??(k ?d)]\n+ ... + A[w(k ? 2) ??(k ?d)] + [w(k ? 1) ??(k ?d)]\n= [w(k ? 1) ??(k ?d)] + A[w(k ? 2) ??(k ?d)]\n+ ... + Ad?2[w(k ?d + 2) ??(k ?d)] + Ad?1[w(k ?d) ??(k ?d)]\n\n=\n\nd?\nj=1\n\nAj?1[w(k ? j) ??(k ?d)]. (4.11)\n\nNovamente, como esperado, e? poss??vel notar que se ?(k) ? wss,\nenta?o limk???(k) = wss e ?(k + d) ? 0. Assim, da equac?a?o (4.7)\nverifica-se a rejeic?a?o da perturbac?a?o na predic?a?o e tambe?m que x?(k +\nd|k) ? x(k + d).\n\nAs figuras 12 e 13 retratam como o desempenho em robustez\n\n\n\n70\n\ndo PNMPC ainda e? dependente do tamanho do atraso nominal, carac-\nter??stica essa na?o deseja?vel para esquemas de compensac?a?o de atraso.\nNessas figuras o processo (4.12) e? controlado utilizando o modelo (4.13).\n\ny(k + 1) = 0,92y(k) + 0,25u(k ? 1 ?d) (4.12)\n\ny(k + 1) = 0,9y(k) + 0,25(k ? 1 ?dn) (4.13)\n\nE ainda, para controla?-lo, parametriza-se um controlador PN\nMPC com horizonte de predic?a?o efetivo de 3 amostras (desconside-\nrando os d instantes iniciais nos quais o efeito do atraso e? percebido),\no horizonte de controle em 3, ponderac?o?es na predic?a?o de 0,001 e pon-\nderac?o?es no controle de 1. Ainda, ajusta-se o para?metro do filtro que\nestima o erro de predic?a?o em 0,7.\n\nPara representar a influe?ncia do atraso nominal na robustez, na\nfigura 12 representa-se a resposta temporal do processo com um atraso\nde d = 10 controlado pelo PNMPC que utiliza um modelo de predic?a?o\ncom atraso de dn = 8. E? poss??vel perceber que, como o atraso nominal\ne? curto, um erro de 25% a menos de incerteza no atraso na?o prejudica\no desempenho da dina?mica em malha fechada.\n\nNo entanto, na figura 13 representa-se a instabilizac?a?o da dina?mi-\nca em malha fechada quando o atraso e? maior, d = 80, tambe?m com\n25% a menos de incerteza no atraso, dn = 64. Assim, uma mesma\nparametrizac?a?o para o controlador PNMPC que estabiliza a dina?mica\nem malha fechada quando o atraso nominal e? curto pode instabiliza?-la\nquando o atraso nominal for maior.\n\nFigura 12 \u2013 Respostas temporais; d = 10 e dn = 8\n\n\n\n71\n\nFigura 13 \u2013 Respostas temporais; d = 80 e dn = 64\n\nEssa caracter??stica e? a mesma observada no GPC para controle\nde sistemas com atraso, como ilustrado em [2] e [6].\n\n4.1.2 Preditor Modificado\n\nA partir do que foi exposto na sec?a?o 4.1.1 tem-se que a incer-\nteza equivalente, da equac?a?o (4.6), ?(k), possui um forte impacto na\nrobustez do controle PNMPC em malha fechada, visto que ela atuara?\nna predic?a?o x?(k +d|k) que e? utilizada para calcular as varia?veis de con-\ntrole. Sendo assim, e? lo?gico pensar que conforme diminui-se o seu efeito\nnas predic?o?es, maior desempenho em robustez e? poss??vel alcanc?ar.\n\nObservando a equac?a?o (4.10) ve?-se tambe?m que, caso o acu?mulo\nde ? diminua, ou seja eliminado, a norma de ? ira? diminuir. Dimi-\nnuindo a norma de ? diminui-se tambe?m o seu impacto nas predic?o?es\ne por conseque?ncia pode-se melhorar a robustez do controle em ma-\nlha fechada. Uma forma de eliminar esse acu?mulo e? alterar o esquema\nde correc?a?o das predic?o?es, estabelecendo um novo esquema de com-\npensac?a?o de atraso, no qual a predic?a?o utilizada para calcular a pro?xima\nvaria?vel de controle e? x?(k + d|k), (4.14).\n\nx?(k + 1|k) =Ax(k) + Bu(k ?d) + ?(k ?d + 1)\nx?(k + 2|k) =Ax?(k + 1|k) + Bu(k ?d + 1) + ?(k ?d + 2)\nx?(k + 2|k) =A[Ax(k) + Bu(k ?d) + ?(k ?d + 1)]\n\n+ Bu(k ?d + 1) + ?(k ?d + 2)\n\n\n\n72\n\nx?(k + 2|k) =A2x(k) + ABu(k ?d) + Bu(k ?d + 1)\n+ A?(k ?d + 1) + ?(k ?d + 2)\n\n... =\n...\n\nx?(k + d|k) =Adx(k) +\nd?\nj=1\n\nAj?1Bu(k ? j) +\nd?1?\nj=0\n\nAj?(k ? j)\n\n(4.14)\n\nEssa alterac?a?o e? interessante visto que as incertezas desconheci-\ndas na?o sa?o garantidamente constantes em um horizonte de predic?a?o\ndo atraso, como preve? o PNMPC ao fazer ?(k ? d ? 1) = ?(k ? d) =\n... = ?(k). Ale?m disso, como os observadores utilizados para os mo-\ndelos de perturbac?a?o sa?o esta?veis e ?(k) ? wss, a mesma relac?a?o e?\nrespeitada para os instantes anteriores de ?, ou seja, ?(k ?d) ? wss,\n?(k ? d + 1) ? wss, ..., ?(k ? 1) ? wss, mantendo as propriedades\nfundamentais de um compensador de atraso.\n\nO novo modelo equivalente devido a? presenc?a desse novo esquema\nde predic?a?o pode ser representado como em (4.15) e (4.16), sendo ?(k)\na nova incerteza aditiva equivalente e ?(k) o novo erro de predic?a?o.\n\nx?(k + d + 1|k + 1) = Ax?(k + d|k) + Bu(k) + ?(k) (4.15)\nx(k + d) = x?(k + d|k) + ?(k + d) (4.16)\n\nPara visualizar as novas propriedades de robustez e? necessa?rio\nrelacionar a nova incerteza aditiva equivalente com a incerteza aditiva\nreal. Para isso descreve-se ?(k) como em (4.17).\n\n?(k) = x?(k + d + 1|k + 1) ? [Ax?(k + d|k) + Bu(k)] (4.17)\n\nAssim como e? poss??vel obter a predic?a?o x?(k + d|k) dado o valor\ndo instante x(k), pode-se tambe?m obter a predic?a?o x?(k + d + 1|k + 1)\ncaso fosse dado x(k + 1), como em (4.18).\n\nx?(k + 2|k + 1) =Ax(k + 1) + Bu(k ?d + 1) + ?(k ?d + 2)\nx?(k + 3|k + 1) =Ax?(k + 2|k + 1) + Bu(k ?d + 2) + ?(k ?d + 3)\n\n\n\n73\n\nx?(k + 3|k + 1) =A2x(k + 1) + ABu(k ?d + 1) + Bu(k ?d + 2)\n+ A?(k ?d + 2) + ?(k ?d + 3)\n\n... =\n...\n\nx?(k + d + 1|k + 1) =Adx(k + 1) +\nd?\nj=1\n\nAj?1Bu(k ? j + 1)\n\n+\n\nd?1?\nj=0\n\nAj?(k ? j + 1) (4.18)\n\nSubstituindo x?(k + d + 1|k + 1) e x?(k + d|k) em (4.17) e? poss??vel\nencontrar a relac?a?o entre ? e w, como em (4.19).\n\n?(k) =Adx(k + 1) +\n\nd?\nj=1\n\nAj?1Bu(k + 1 ? j)\n\n+\n\nd?1?\nj=0\n\nAj?(k ? j + 1 ? [A(Adx(k)\n\n+\n\nd?\nj=1\n\nAj?1Bu(k ? j) +\nd?1?\nj=0\n\nAj?(k ? j)) + Bu(k)]\n\n?(k) =Adx(k + 1) + Bu(k) +\n\nd?\nj=2\n\nAj?1Bu(k + 1 ? j)\n\n+\n\nd?1?\nj=0\n\nAj?(k ? j + 1) ? [A(Adx(k) + Ad?1Bu(k ?d)\n\n+\n\nd?1?\nj=1\n\nAj?1Bu(k ? j) +\nd?1?\nj=0\n\nAj?(k ? j)) + Bu(k)]\n\n?(k) =Adx(k + 1) +\n\nd?1?\nj=1\n\nAjBu(k ? j) +\nd?1?\nj=0\n\nAj?(k ? j + 1)\n\n?AAdx(k) ?AdBu(k ?d) ?A\nd?1?\nj=1\n\nAj?1Bu(k ? j)\n\n\n\n74\n\n?A\nd?1?\nj=0\n\nAj?(k ? j) + Bu(k) ?Bu(k)\n\n?(k) =Ad[x(k + 1) ?Ax(k) ?Bu(k ?d)] +\nd?1?\nj=1\n\nAjBu(k ? j)\n\n?A\nd?1?\nj=1\n\nAj?1Bu(k ? j) +\nd?1?\nj=0\n\nAj?(k ? j + 1)\n\n?A\nd?1?\nj=0\n\nAj?(k ? j)\n\n?(k) =Ad[x(k + 1) ?Ax(k) ?Bu(k ?d)]\n\n+\n\nd?1?\nj=1\n\nAjBu(k ? j) ?\nd?1?\nj=1\n\nAjBu(k ? j)\n\n+\n\nd?1?\nj=0\n\nAj?(k ? j + 1) ?A\nd?1?\nj=0\n\nAj?(k ? j)\n\n?(k) =Ad[x(k + 1) ?Ax(k) ?Bu(k ?d)] + ?(k) ?Ad?(k ?d)\n\n+\n\nd?1?\nj=1\n\nAj?(k ? j + 1) ?\nd?2?\nj=0\n\nAj+1?(k ? j)\n\n?(k) =Ad[x(k + 1) ?Ax(k) ?Bu(k ?d) ??(k ?d + 1)] + ?(k + 1)\n\n+\n\nd?1?\nj=1\n\nAj?(k ? j + 1) ?\nd?1?\nj=1\n\nAj?(k ? j + 1)\n\nE assim,\n\n?(k) = Ad[w(k) ??(k ?d + 1)] + ?(k + 1) (4.19)\n\nObservando a equac?a?o (4.19) e? poss??vel perceber que ?(k) mante?m\nas propriedades fundamentais de compensadores de atraso: seguimento\nde predic?a?o nominal e rejeic?a?o de perturbac?a?o constante na predic?a?o.\nIsso porque, caso w(k) = 0, pelo observador utilizado, ?(k?d) = ?(k) =\n0 e ?(k) = 0. Bem como se w(k) ? wss, pelo modelo de perturbac?a?o\nutilizado, ?(k ?d) ? wss e ?(k) ? wss, levando ?(k) ? wss. E, para\nambas as situac?o?es, a predic?a?o tende ao valor real\n\nNo entanto, diferentemente do esquema de predic?a?o original do\n\n\n\n75\n\nPNMPC, no qual ? sofre forte influe?ncia de acu?mulo das varia?veis de\ncorrec?a?o durante o per??odo equivalente ao atraso nominal, e consequen-\ntemente prejudica a robustez do controle em malha fechada, ? na?o mais\napresenta esse feno?meno indesejado.\n\nAinda, o erro de predic?a?o nesse caso e? dado pela equac?a?o (4.20).\n\n?(k + d) = x(k + d) ? x?(k + d|k)\n\n= [Adx(k) +\n\nd?\nj=1\n\nAj?1Bu(k ? j) +\nd?1?\nj=0\n\nAd?1?jw(k + d? j)]\n\n? [Adx(k) +\nd?\nj=1\n\nAj?1Bu(k ? j) +\nd?1?\nj=0\n\nAj?(k ? j)]\n\nE assim,\n\n?(k) =\n\nd?1?\nj=0\n\nAj[w(k + j + 1) ??(k ? j)]. (4.20)\n\nMais uma vez, a equac?a?o (4.20) esclarece a evide?ncia do cumpri-\nmento da propriedade de rejeic?a?o de perturbac?a?o constante na predic?a?o,\nja? que se ?(k) ? wss, enta?o limk???(k) = wss e ?(k + d) ? 0.\n\nPara ilustrar o ganho de robustez quando esse segundo esquema\nde compensac?a?o de atraso e? utilizado considera-se a mesma parame-\ntrizac?a?o do controlador PNMPC utilizada nos exemplos apresentados\nnas figuras 12 e 13, no entanto, utilizando agora o preditor modificado\npara determinar a predic?a?o para x(k + d).\n\nNa figura 14, ve?-se que a resposta temporal em malha fechada,\nnas condic?o?es nas quais o atraso real do processo (4.12) e? de 80 amostras\ne o atraso nominal do modelo (4.13) e? de 64 amostras (um erro de\n25% na estimativa do atraso), na?o apresenta mais um comportamento\ninsta?vel.\n\nE? interessante notar como esse esquema de compensac?a?o de atraso\nproposto pode ser aplicado em diversos tipos de controladores. Ele\npode ser aplicado em um controlador cla?ssico de realimentac?a?o de es-\ntados, no qual, em conjunto com um observador das incertezas, forne-\nceria predic?o?es ate? k + d|k que o controlador utilizaria para calcular o\npro?ximo valor de controle, como enunciado em [6]. Outra aplicac?a?o, se-\nguindo a linha do que foi apresentado para o PNMPC, seria a utilizac?a?o\n\n\n\n76\n\nFigura 14 \u2013 Respostas temporais; d = 80 e dn = 64\n\nde um esquema de compensac?a?o de atraso expl??cita em controladores\nMPC tornando-os mais robustos quando utilizados para o controle de\nprocessos com longo atraso de transporte.\n\n4.1.3 Preditor Modificado em um PNMPC Na?o Linear\n\nComo apresentado no cap??tulo 2 o PNMPC e? projetado para me-\nlhorar o desempenho de controladores preditivos quando configurados\npara controlar processos com na?o linearidades complexas. A intenc?a?o\ne? obter uma estrate?gia com uma relac?a?o adequada entre desempenho,\nvelocidade e simplicidade. Para isso utiliza-se uma nova abordagem de\nlinearizac?a?o na resposta forc?ada, fazendo uma aproximac?a?o linear da\nsa??da predita em relac?a?o aos incrementos de controle futuros.\n\nA sua concepc?a?o original preve? um modelo de perturbac?a?o capaz\nde garantir a rejeic?a?o de perturbac?o?es constantes, utilizando um obser-\nvador particular para obter correc?o?es que sa?o adicionadas em cada uma\ndas predic?o?es de todo o horizonte.\n\nSendo assim, em (4.2), w ? wss, mesmo quando controla-se um\nprocesso atrave?s de um modelo na?o linear e o modelo de perturbac?a?o\ne? tambe?m utilizado para, em regime, rejeitar poss??veis perturbac?o?es\nconstantes fazendo com que x(k + d|k) ? x(k + d).\n\nPor similaridade ao caso linear e? poss??vel concluir que em um\nesquema de compensac?a?o de atraso expl??cita, no qual um modelo de\nperturbac?a?o faz com que ? ? wss para que x(k + d|k) ? x(k + d),\nessas correc?o?es ?(k) aplicadas em cada instante de predic?a?o de um\nhorizonte causara?o o mesmo efeito de aumentar a norma da incerteza\nequivalente, de forma semelhante ao que ocorreu na equac?a?o (4.10).\n\n\n\n77\n\nEnta?o, a modificac?a?o proposta na sec?a?o 4.1.1 tambe?m se faz coerente\npara o caso na?o linear e esse efeito indesejado de aumento da norma da\nincerteza equivalente pode ser diminu??do com a eliminac?a?o do acu?mulo\ndas correc?o?es.\n\nPara ilustrar o aumento da robustez com PNMPC utilizado para\ncontrolar um processo modelado de forma na?o linear, realiza-se uma si-\nmulac?a?o de controle utilizando o processo da equac?a?o (4.21) com o\nmodelo da equac?a?o (4.22), no qual observa-se um erro de modelagem\nimportante nos coeficientes do modelo. Parametriza-se o PNMPC com\nhorizonte de predic?a?o efetivo de 3 amostras (desconsiderando os d ins-\ntantes iniciais nos quais o efeito do atraso e? percebido), o horizonte\nde controle em 3, ponderac?o?es na predic?a?o de 0,001 e ponderac?o?es no\ncontrole de 1. Ainda, ajusta-se o para?metro do filtro que estima o erro\nde predic?a?o em 0,9.\n\ny(k) =\n2,5y(k ? 1)y(k ? 2)\n\n1 + y(k ? 1)2 + y(k ? 2)2\n\n+ 0,3 cos(0,5(y(k ? 1) + y(k ? 2))) + 1,2u(k ? 1 ?d)\n(4.21)\n\ny(k) =\n7y(k ? 1)y(k ? 2)\n\n1 + y(k ? 1)2 + y(k ? 2)2\n\n+ 0,1 cos(0,3(y(k ? 1) + y(k ? 2))) + 1,2u(k ? 1 ?dn)\n(4.22)\n\nNa figura 15 tem-se a situac?a?o na qual o atraso real e? 20 com\num erro percentual na estimativa do atraso de 11%, ou seja, dn = 18.\nNa figura 16 observa-se o efeito de instabilidade quando aumenta-se o\ntamanho do atraso nominal para 100 instantes de amostragem, com\napenas 11% de erro percentual na estimativa do atraso. E na figura 17\nve?-se com a utilizac?a?o do preditor modificado que o controle em malha\nfechada torna-se mais robusto, mantendo a estabilidade da resposta em\nmalha fechada.\n\n\n\n78\n\nFigura 15 \u2013 Respostas temporais; d = 20 e dn = 18\n\nFigura 16 \u2013 Respostas temporais; d = 100 e dn = 89\n\nFigura 17 \u2013 Respostas temporais com Preditor Modificado; d = 100 e\ndn = 89\n\n4.1.4 Estudo de Caso\n\nPara representar o comportamento robusto de um PNMPC que\nutiliza o esquema de predic?a?o modificado proposto nesse trabalho, considera-\n\n\n\n79\n\nse o controle de concentrac?a?o em um reator insta?vel comum na indu?stria\nde petro?leo e ga?s. A dina?mica em malha aberta de alguns reatores\nqu??micos com misturas na?o ideais podem ser descritos pelo modelo de\nChoellete, como na equac?a?o diferencial na?o linear da equac?a?o (4.23),\n[26].\n\ndc\n\ndt\n=\nf(t)\n\nv\n[ci(t) ? c(t)] ?\n\nkic(t)\n\n[k2c(t) + 1]2\n, (4.23)\n\nsendo c(t) a concentrac?a?o na sa??da do reator, ci(t) a concentrac?a?o na\nentrada do reator, f(t) a vaza?o na entrada do reator, k1 = 10 l/s,\nk2 = 10 mol/s e v = 11 l o volume do reator. Para a simulac?a?o de\ncontrole considera-se a vaza?o de entrada em f = 0.033 l/s, o tempo de\namostragem T = 1 s, uma discretizac?a?o do processo como a da equac?a?o\n(4.24), e ainda um atraso de transporte entre a varia?vel de entrada e a\nsa??da de 20 instantes de amostragem.\n\nc(k) = c(k?1) +\nf(k ? 1)\n\nv\n[ci(k?1?20)?c(k?1)]?\n\nkic(k ? 1)\n[k2c(k ? 1) + 1]2\n\n(4.24)\nE? configurado enta?o um controlador PNMPC com horizontes de\n\ncontrole e de predic?a?o de 3 instantes de amostragem (desconsiderando\nos d instantes iniciais nos quais o efeito do atraso e? percebido), pon-\nderac?a?o no controle de 0,5, ponderac?a?o no erro da saida futura de 3,\nfiltro de estimativa do erro de predic?a?o de 0,8 e e? utilizado um modelo\nde predic?a?o como o da equac?a?o (4.25), com 30% de erro na estimativa\ndo atraso.\n\nc(k) = c(k?1) +\nf(k ? 1)\n\nv\n[ci(k?1?28)?c(k?1)]?\n\nkic(k ? 1)\n[k2c(k ? 1) + 1]2\n\n(4.25)\nA seguir e? utilizado um controlador PNMPC com o esquema\n\nde predic?a?o modificado, utilizando o mesmo ajuste dado na situac?a?o\nanterior. As figuras 18 e 19 conte?m as respostas temporais de ambas as\nsimulac?o?es e a partir delas e? poss??vel verificar o comportamento robusto\ndo PNMPC Modificado.\n\nNo cap??tulo 5 sera? demonstrado como a norma da incerteza equi-\nvalente se relaciona com as correc?o?es e como reduz-se esse efeito de\nacu?mulo atrave?s da utilizac?a?o do preditor modificado para o caso na?o\nlinear. Pore?m, antes de finalizar esse cap??tulo e? apresentada outra forma\nde correc?a?o das predic?o?es, baseada no FSP.\n\n\n\n80\n\nFigura 18 \u2013 Resposta temporal do controle do reator com o PNMPC\n\nFigura 19 \u2013 Resposta temporal do controle do reator com o PNMPC\nModificado\n\n4.2 PNMPC COM COMPENSAC?A?O DE ATRASO VIA PREDITOR\nDE SMITH FILTRADO\n\nComo demonstrado em [6], um esquema de compensac?a?o de\natraso adequado deve possuir duas caracter??sticas essenciais: eliminar\na influe?ncia do atraso na malha de controle e ser capaz de rejeitar per-\nturbac?o?es constantes. Essas caracter??sticas sa?o importantes porque o\natraso tende a degradar a robustez conforme aumenta.\n\nNesse contexto, os compensadores devem ser projetados para\ngarantir um bom desempenho do controle em malha fechada, e na?o\napenas fornecerem boas predic?o?es, ja? que elas estara?o inevitavelmente\natreladas a modelos nominais.\n\nNo caso dos controladores PNMPC essa afirmativa e? ainda mais\njustifica?vel, pois em situac?o?es nas quais processos com na?o linearidades\n\n\n\n81\n\ncomplexas esta?o sendo controlados, a tende?ncia em se obter predic?o?es\ndiferentes das sa??das reais e? maior, bem como a exige?ncia em torno\nda robustez. Como o principal benef??cio da compensac?a?o de atraso\nvia preditor de Smith filtrado e? melhorar a robustez sem prejudicar o\ndesempenho nominal do processo controlado, e? interessante associa?-la\nao controle PNMPC de processos com longos atrasos de transporte.\n\nNo entanto, a compensac?a?o de atraso via preditor de Smith fil-\ntrado e? uma estrate?gia utilizada tradicionalmente em esquemas de con-\ntrole entrada-sa??da, quando utilizados modelos lineares para represen-\ntar a dina?mica dos processos. Em [2] estabelece-se um caminho para se\nutilizar tal estrate?gia de compensac?a?o de atraso quando um modelo em\nespac?o de estados linear representa o processo a controlar, mas ainda\ntrata-se de uma representac?a?o linear.\n\nCom vistas a aumentar a robustez dos controladores PNMPC e\nsabendo que o objetivo das predic?o?es em um esquema de compensac?a?o\nde atraso e? melhorar o desempenho em malha fechada do controle,\npropo?e-se a compensac?a?o de atraso via preditor de Smith filtrado com\no uso do PNMPC como controlador prima?rio da seguinte forma:\n\n1. compensac?a?o de atraso expl??cita;\n\n2. predic?a?o via preditor de Smith filtrado, com filtro linear;\n\n3. controle baseado nas predic?o?es.\n\nEm relac?a?o a? compensac?a?o de atraso expl??cita e? importante res-\nsaltar que o esquema de controle e? dado como na figura 11, ou seja, ao\ninve?s de obterem-se as predic?o?es,\n\ny? = f(yp,up,?u),\n\nou na forma como sa?o realizadas no PNMPC:\n\ny? = f(yp,up) +\n?y?\n\n??u\n?u,\n\nde maneira impl??cita, nas quais y? representa o vetor de predic?o?es para\na sa??da durante o horizonte de predic?a?o, f(.) representa uma func?a?o\nna?o linear que modela o processo, yp o vetor de sa??das passadas, up\no vetor de controles passados, ?u o vetor de incrementos de controles\nfuturos e ?y?\n\n??u\numa linearizac?a?o entre o vetor de sa??das preditas e o\n\nvetor de incremento de controles futuros, obte?m-se separadamente os d\nprimeiros instantes, sendo que d representa o atraso de transporte.\n\n\n\n82\n\nPara isso, a nova predic?a?o para d, y(k + d|k), e? obtida utilizando\na relac?a?o (4.26), sendo y?(k + d|k) a predic?a?o a ser utilizada para o\nca?lculo dos incrementos de controle futuros, y?(k + d|k) uma predic?a?o\no?tima para a sa??da (obtida por exemplo, atrave?s de um modelo sem\no atraso de transporte), Fr(z\n\n?1) um filtro linear, que assim como o\ndeterminado em [4] deve ser esta?vel e possuir ganho unita?rio, y(k) a\nsa??da real e y?(k) a sa??da atual do modelo. Esse esquema de controle\nessa representado na figura 20.\n\ny?(k + d|k) = y?(k + d) + Fr(z?1)[y(k) ? y?(k)] (4.26)\n\nFigura 20 \u2013 PNMPC com compensac?a?o de atraso via preditor de Smith\nfiltrado\n\nAinda na figura 20, nota-se que nesse novo esquema de controle\no PNMPC utiliza as predic?o?es para a sa??da apo?s o atraso, dadas pelo\nmodelo equivalente de predic?a?o com o preditor de Smith filtrado, no\nca?lculo dos pro?ximos incrementos de controle. Ou seja, tanto a resposta\nlivre quanto a resposta forc?ada sera?o calculadas como se a predic?a?o fosse\na sa??da mais recente.\n\nDeve-se ressaltar que a estrate?gia de compensac?a?o indicada na\nfigura 20 so? e? aplica?vel para processos que possuem apenas pontos de\nequil??brio esta?veis. Para os outros casos deve-se acoplar o filtro em\nambos os modelos de predic?a?o, modelo do processo com o atraso e\nmodelo do processo sem o atraso, buscando a estabilidade interna do\ncontrolador.\n\nPara ilustrar o aumento de robustez proporcionado pela aplicac?a?o\nda compensac?a?o de atraso via preditor de Smith filtrado, apresenta-se\no controle do processo representado pela equac?a?o (4.21) utilizando o\nmodelo representado pela equac?a?o (4.22), mas agora com erro na esti-\n\n\n\n83\n\nmativa do atraso de 42%. Assim, tem-se d = 100 e dn = 70.\nNesse exemplo ajusta-se o controlador PNMPC com um hori-\n\nzonte de predic?a?o igual a 3 instantes de amostragem, um horizonte\nde controle igual a 3, ponderac?o?es na predic?a?o de 0,001 e o filtro de\ncorrec?a?o do erro de predic?a?o do PNMPC em 0,9. Para a compensac?a?o\nvia preditor de Smith filtrado utiliza-se um filtro linear (4.27)2.\n\nFr(z\n?1) =\n\n0,04\n\nz ? 0,96\n(4.27)\n\nNas figuras 21 e 22 e? poss??vel perceber que quando o erro esti-\nmado para o atraso de transporte aumenta, mesmo a compensac?a?o de\natraso via preditor modificado, proposta na sec?a?o 4.1.3, na?o e? capaz\nde garantir a robustez do controlador PNMPC. No entanto, a com-\npensac?a?o de atraso via preditor de Smith filtrado garante a robustez\nnessas circunsta?ncias sem prejudicar o desempenho nominal do contro-\nlador para mudanc?as de set point.\n\nE? poss??vel perceber tambe?m que em contrapartida o desempe-\nnho da resposta de rejeic?a?o da perturbac?a?o diminui para o caso no qual\no preditor de Smith filtrado e? utilizado. Essa caracter??stica e? igual a?\nobservada no caso linear, dado o compromisso entre robustez e rejeic?a?o\nde perturbac?o?es. No entanto, estrate?gias de ajustes do filtro, como as\ndesenvolvidas em [2], podem ser adaptadas para o caso linear no qual\nparte da dina?mica do processo na?o linear for modelada linearmente, a\nexemplo de modelos na?o lineares representados por modelos de Ham-\nmerstein, [22].\n\n4.3 CONCLUSA?O\n\nNesse cap??tulo apresentou-se um estudo de robustez para o es-\nquema de compensac?a?o do atraso impl??cito do PNMPC, no caso do\ncontrole de um processo representado por um modelo linear. Esse es-\ntudo possibilitou uma ana?lise mais detalhada dos principais fatores que\ninfluenciam na robustez do controlador. Assim, foi desenvolvido um\npreditor modificado utilizando a compensac?a?o expl??cita do atraso, que\nna?o considera mais o sinal de correc?a?o constante ao longo do intervalo\nde predic?a?o do atraso. Foi demonstrado enta?o, atrave?s de estudos de\n\n2Sabe-se que a freque?ncia de corte do filtro esta? relacionada com a robustez do\ncontrole em malha fechada. Te?cnicas de ajuste do filtro do preditor de Smith filtrado\nna?o sa?o o objetivo desse trabalho, mas pode-se encontrar maiores informac?o?es em\n[6] e [2].\n\n\n\n84\n\nFigura 21 \u2013 Preditor de Smith filtrado; d = 100 e ? = 70\n\nFigura 22 \u2013 Preditor modificado; d = 100 e ? = 70\n\ncaso, o melhor desempenho em relac?a?o a robustez desse novo esquema.\nPor u?ltimo apresentou-se a aplicac?a?o da compensac?a?o do atraso\n\nvia preditor de Smith filtrado em controladores PNMPC com modelos\nna?o lineares. Atrave?s de exemplos ilustrou-se o bom desempenho em\nrelac?a?o a? robustez da estrate?gia de compensac?a?o de atraso para o caso\nde controle de processos modelados na?o linearmente.\n\nEsses exemplos ilustrativos motivam a ana?lise de robustez a ser\napresentada no cap??tulo 5, no qual demonstra-se o porque? do melhor\ndesempenho das estrate?gias de compensac?a?o de atraso propostas para\no controle PNMPC em processos com longos atrasos de transporte.\n\n\n\n85\n\n5 ANA?LISE DE ROBUSTEZ\n\nComo discutido nos cap??tulos anteriores, os compensadores de\natraso sa?o geralmente sens??veis ao erro na estimac?a?o do atraso de trans-\nporte. Sendo assim a ana?lise de robustez e? importante para classificar\na robustez das diversas estrate?gias quando aplicadas em situac?o?es nas\nquais ha? incertezas em relac?a?o ao processo real a ser controlado.\n\nEm [6], pode-se observar que os compensadores de atraso de-\nvem, ale?m de cumprir o seu papel fundamental de evitar que o atraso\nde transporte influencie o desempenho em malha fechada do processo\ncontrolado, manter o comportamento robusto independentemente da\nmagnitude do atraso nominal. Assim, pode-se perceber tambe?m nos\nexemplos apresentados em [6], no cap??tulo 9, que as estrate?gias GPC\ne DMC (assim como a estrate?gia PNMPC) originalmente na?o aten-\ndem esse requisito, enquanto o uso do preditor de Smith filtrado como\nestrutura de predic?a?o do atraso faz com que elas atendam.\n\nPara verificar as caracter??sticas de robustez das estrate?gias apre-\nsentadas nesse trabalho sera? representada a propagac?a?o das incertezas\nreais perante o esquema resultante de controle, considerando o contro-\nlador prima?rio PNMPC e as respectivas estrate?gias de compensac?a?o de\natraso: compensac?a?o impl??cita do pro?prio PNMPC, compensac?a?o de\natraso modificada proposta no cap??tulo 4 e compensac?a?o de atraso via\npreditor de Smith Filtrado em unia?o com o PNMPC tambe?m proposta\nno cap??tulo 4. Ainda, sera? primeiramente analisada a propagac?a?o das\nincertezas considerando o controle de processos lineares, como em [2],\ne em seguida analisada a propagac?a?o das incertezas de forma generali-\nzada, considerando tambe?m processos na?o lineares, como em [28].\n\n5.1 DESCRIC?A?O DAS INCERTEZAS\n\nProcessos reais apresentam variac?o?es relacionadas a qualquer\nmodelo proposto para representa?-lo, variac?o?es essas oriundas de diver-\nsas fontes de incertezas, como: ru??dos, perturbac?o?es na?o mensura?veis,\nerros na modelagem do processo etc. Essas variac?o?es podem causar\nproblemas relacionados a estabilidade ou a violac?o?es de restric?o?es, no\ncaso de controladores preditivos.\n\nExistem diversas maneiras de representar essas incertezas, a exem-\nplo das incluso?es polito?picas e das incertezas aditivas. As incluso?es po-\nlito?picas, como em (5.1), sendo Ai as matrizes dina?micas representando\n\n\n\n86\n\nmodelos sujeitos a diferentes incertezas, possuem a vantagem de indi-\ncar separadamente cada uma das incertezas e assim permitir meios de\nse tratar cada uma delas individualmente. Ja? a formulac?a?o de incerte-\nzas aditivas, como em (5.2), apesar de ser mais conservadora, permite\nenglobar mais facilmente todo o tipo de incerteza, ale?m de permitir\ntambe?m a obtenc?a?o dos valores reais de incertezas experimentalmente.\n\nx(k + 1) = Ax(k) + Bu(k ?d) ; A ? A\n\nA = {A : A =\nN?\ni=1\n\n?iAi;\n\nN?\ni=1\n\n?i = 1; ?i ? 0} (5.1)\n\nx(k + 1) = Ax(k) + Bu(k ?d) + w(k)\nw(k) = x(k + 1) ?Ax(k) ?Bu(k ?d) (5.2)\n\nAinda, em esquemas de compensac?a?o de atraso sabe-se que o\natraso na?o deve afetar o desempenho nominal em malha fechada. No\nentanto, nesses esquemas, uma predic?a?o para a sa??da do processo e? uti-\nlizada para controlar o processo real. Assim, e? preciso estudar a relac?a?o\nentre as incertezas reais e as incertezas propagadas pela predic?a?o para\npoder observar qual o efeito do atraso e qual a robustez da estrate?gia\nde controle resultante.\n\n5.2 ANA?LISE LINEAR DA ROBUSTEZ\n\nNessa sec?a?o sera? apresentada a ana?lise de robustez dos esque-\nmas de compensac?a?o propostos. Sera? analisada a propagac?a?o da incer-\nteza atrave?s do compensador de atraso utilizado, isso primeiramente\nlevando em considerac?a?o modelos lineares para representar os proces-\nsos em questa?o.\n\nEssa ferramenta de ana?lise de robustez justifica-se pelo fato de\nque nos esquemas de controle via compensac?a?o do atraso um compen-\nsador produz uma predic?a?o para a sa??da do processo apo?s o efeito do\natraso e os controladores prima?rios fazem uso dessa predic?a?o para rea-\nlizarem o ca?lculo do pro?ximo valor de controle. Assim, deve-se analisar\na forma pela qual a incerteza real propaga-se no esquema de com-\npensac?a?o de atraso e tambe?m impacta a predic?a?o, que como dito, sera?\na informac?a?o utilizada para o ca?lculo do pro?ximo esforc?o de controle.\n\n\n\n87\n\nAssim, pelo ponto de vista do controle, e? poss??vel dizer que um\nesquema de controle como o apresentado na figura 23, no qual um\ncontrolador prima?rio calcula os esforc?os de controle, u(k), comparando\na predic?a?o da sa??da apo?s o efeito do atraso, y?(k) = y(k + d|k), com a\nrefere?ncia, e? equivalente ao esquema de controle da figura 24, no qual\nesta? evidenciado um modelo equivalente. Atrave?s dessa descric?a?o e?\nposs??vel relacionar as incertezas w(k) e w?(k) e verificar o impacto na\nrobustez devido a uma poss??vel modificac?a?o do comportamento dessa\ninformac?a?o.\n\nFigura 23 \u2013 Controle Linear com Compensac?a?o de Atraso\n\nFigura 24 \u2013 Esquema equivalente de Controle\n\n\n\n88\n\n5.2.1 Compensac?a?o de Atraso Expl??cita\n\nComo apresentado no cap??tulo 4, dada uma representac?a?o linear,\ndiscreta e invariante no tempo de um processo a controlar, como em\n(5.3), sendo x(k) ? Rn o vetor de estados em k, u(k) ? Rp o vetor de\nvaria?veis de controle, y(k) ? Rq o vetor com as sa??das, w(k) ? Rn o\nvetor com as incertezas aditivas, d o atraso de transporte e A, B e C\nas matrizes que modelam o processo, e? poss??vel utilizar um esquema de\ncompensac?a?o expl??cita para predizer as sa??das apo?s o efeito do atraso e\nutiliza?-las no ca?lculo do controle, como na figura 23. Como apresentado\nem [13], esse modelo de compensac?a?o e? similar a? compensac?a?o de atraso\nimpl??cita utilizada em um MPC (tambe?m utilizada no PNMPC) e ainda\npara a ana?lise de propagac?a?o da incerteza nessa sec?a?o sera? considerado\no modelo de perturbac?a?o do PNMPC.\n\nx(k + 1) = Ax(k) + Bu(k ?d) + w(k)\ny(k) = Cx(k)\n\n(5.3)\n\nA equac?a?o (5.4) apresenta a predic?a?o referente ao esquema de\ncompensac?a?o do PNMPC, no qual x?(k +d|k) representa o valor predito\npara x(k+d) no instante k. E ainda, e? possivel representar o esquema de\ncontrole de forma equivalente, sem a presenc?a do atraso, como na figura\n24. Assim, na equac?a?o (5.5), que representa esse modelo equivalente, e?\nposs??vel notar a ause?ncia do atraso de transporte.\n\nx?(k + d|k) =Adx(k) +\nd?\nj=1\n\nAj?1Bu(k ? j) +\nd?1?\nj=0\n\nAd?1?j?(k)\n\n(5.4)\n\nx?(k + d + 1|k + 1) = Ax?(k + d|k) + Bu(k) + ?(k) (5.5)\nx(k + d) = x?(k + d|k) + ?(k + d) (5.6)\n\nA ana?lise das incertezas propagadas, ?(k), torna poss??vel o es-\ntudo da robustez. Como demonstrado no cap??tulo 4, para esse caso\ntem-se a relac?a?o apresentada na equac?a?o (5.7).\n\n\n\n89\n\n?(k) =Ad[w(k) ??(k)] +\nd?1?\nj=1\n\nAj[?(k + 1) ??(k)] + ?(k + 1). (5.7)\n\nEm relac?a?o ao erro de predic?a?o, tem-se a relac?a?o apresentada na\nequac?a?o (5.8).\n\n?(k) =\n\nd?\nj=1\n\nAj?1[w(k ? j) ??(k ?d)] (5.8)\n\nNovamente, as principais concluso?es para esse caso envolvem o\ncomportamento da varia?vel de correc?a?o, ?(k), adicionada nas predic?o?es\npelo modelo de perturbac?a?o do PNMPC. Como em cada instante de\npredic?a?o e? aplicado o mesmo valor de correc?a?o, apo?s o per??odo igual\nao tempo de atraso ocorre o acu?mulo dessas correc?o?es, o que pode\naumentar a norma de ?(k) e diminuir a robustez em malha fechada,\nja? que ?(k) interfere na obtenc?a?o de x?(k + d|k), que e? a informac?a?o\nutilizada para o co?mputo do pro?ximo esforc?o de controle.\n\n5.2.2 Compensac?a?o de Atraso Modificada\n\nA modificac?a?o do modelo de perturbac?a?o do PNMPC proposta\nnesse projeto foi apresentada no cap??tulo 4, bem como a avaliac?a?o da\nsua robustez. Enta?o, para a representac?a?o em espac?o de estados linear\ne invariante no tempo de um processo a controlar, como em (5.3), a\nnova predic?a?o e? a representada na equac?a?o (5.9).\n\nx?(k + d|k) = Adx(k) +\nd?\nj=1\n\nAj?1Bu(k ? j) +\nd?1?\nj=0\n\nAj?(k ? j)\n\n(5.9)\n\nO novo modelo equivalente resultante da utilizac?a?o da predic?a?o\nmodificada, representado pela equac?a?o (5.10), modifica a relac?a?o entre\na incerteza resultante, ?(k), e a incerteza real, w(k), apresentada na\nequac?a?o (5.12).\n\n\n\n90\n\nx?(k + d + 1|k + 1) = Ax?(k + d|k) + Bu(k) + ?(k) (5.10)\nx(k + d) = x?(k + d|k) + ?(k + d) (5.11)\n\n?(k) = Ad[w(k) ??(k ?d)] + ?(k) (5.12)\n\nO novo erro de predic?a?o pode ser relacionado a? incerteza real\nconforme a equac?a?o (5.13).\n\n?(k) =\n\nd?1?\nj=0\n\nAj[w(k ? j ? 1) ??(k ?d? j)]. (5.13)\n\nPercebe-se enta?o o acre?scimo de robustez que essa modificac?a?o no\nmodelo de perturbac?a?o do PNMPC proposta promove, ja? que o acu?mulo\ndas varia?veis de correc?a?o que ocorria, equac?a?o (5.7), e? quase na sua\ntotalidade eliminado. Isso porque o termo somato?rio que representa\no acu?mulo das varia?veis de correc?a?o se propagando pela predic?a?o e?\neliminado.\n\nO reflexo desse feno?meno e? que a incerteza equivalente e? menos\ninfluenciada pelas varia?veis de correc?a?o e por conseque?ncia afeta menos\na predic?a?o, fazendo com que a robustez do controle em malha fechada\nseja maior.\n\n5.2.3 Compensac?a?o via Preditor de Smith Filtrado\n\nNo cap??tulo 4 apresentou-se tambe?m a estrate?gia de controle que\ncontempla a unificac?a?o do controle preditivo PNMPC com um esquema\nde compensac?a?o de atraso expl??cito via preditor de Smith filtrado. Em\nseguida, sera? apresentada uma ana?lise da robustez atrave?s do compor-\ntamento da incerteza.\n\nE? de conhecimento em controle de processos com atraso que o\npreditor de Smith filtrado foi concebido para controle entrada-sa??da [6]\ne [2]. Como foi escolhida a representac?a?o em espac?o de estados para\ndemonstrar as propriedades de robustez das estrate?gias em questa?o,\ne? poss??vel utilizar uma sa??da auxiliar, como em (5.14), desde que os\nestados sejam mensura?veis.\n\n\n\n91\n\nx(k + 1) = Ax(k) + Bu(k ?d) + w(k)\nya(k) = x(k) (5.14)\n\nObtendo assim uma representac?a?o em espac?o de estados, relacio-\nnando as matrizes A e B com o modelo em func?a?o de transfere?ncia\n(5.15), como em (5.16).\n\nx(k) = ya(k) = G(z\n?1)u(k ?d) + Q(z?1)w(k) (5.15)\n\nG(z?1) = (I ?Az?1)?1Bz?1\n\nQ(z?1) = (I ?Az?1)?1z?1 (5.16)\n\nEstabelece-se enta?o uma relac?a?o entre as representac?o?es e a pos-\nsibilidade de demonstrar a robustez atrave?s de uma representac?a?o em\nespac?os de estados linear.\n\nAssim, dado um modelo nominal (5.17), assim como apresentado\nno cap??tulo 4 na equac?a?o (4.26), por similaridade define-se a predic?a?o\nvia preditor de Smith filtrado em espac?o de estados como em (5.18).\n\nx?(k + 1) = Ax?(k) + Bu(k ?d)\ny?a(k) = x?(k) (5.17)\n\nx?(k) = x(k + d|k) = x?(k + d) + Fr(z?1)[x?(k) ?x(k)] (5.18)\n\nPara processos BIBO (Bounded Input Bounded Output ) esta?veis\ne? poss??vel aplicar a compensac?a?o de atraso como na figura 20, ou de\nforma equivalente em espac?o de estados como em (5.18). No entanto,\npara sistemas que na?o sa?o BIBO esta?veis essa formulac?a?o na?o e? va?lida,\nsendo necessa?rio expressar a predic?a?o como em (5.19). Sendo S uma\nmatriz de transfere?ncia BIBO esta?vel.\n\nx?(k) = S(z?1)u(k) + Fr(z\n?1)x(k) (5.19)\n\n\n\n92\n\nPara avaliar a robustez considera-se o modelo equivalente de\npredic?a?o, modelo do processo mais o preditor, como em (5.20). Dessa\nforma, a incerteza equivalente pode ser determinada pela expressa?o\n(5.21).\n\nx?(k + 1) = Ax?(k) + Bu(k) + w?(k)\n\nya(k) = x(k) = x?(k ?d) + e(k) (5.20)\n\nw?(k) = x?(k + 1) ?Ax?(k) ?Bu(k) (5.21)\n\nA fim de encontrar a relac?a?o entre a incerteza equivalente e a\nincerteza real e conseguir assim analisar a robustez desse esquema de\npredic?a?o, substitui-se a equac?a?o (5.18) na equac?a?o (5.21), obtendo as-\nsim a relac?a?o expressa em (5.22).\n\nw?(k) = x?(k + d + 1) ? Fr(z?1)x?(k + 1) + Fr(z?1)x(k + 1)\n?A[x?(k + d) ? Fr(z?1)x?(k) + Fr(z?1)x(k)] ?Bu(k)\n\n(5.22)\n\nComo para o caso nominal na?o sa?o consideradas as incertezas, e?\nposs??vel estabelecer a relac?a?o da equac?a?o (5.23).\n\nx?(k + d + 1) = Ax?(k + d) + Bu(k) (5.23)\n\nE assim, a equac?a?o (5.22) pode ser expressa como em (5.24).\n\nw?(k) = ? Fr(z?1)x?(k + 1) + Fr(z?1)x(k + 1) + AFr(z?1)x(k)\n?AFr(z?1)x(k)\n= Fr(z\n\n?1)[x(k + 1) ? x?(k + 1)] + AFr(z?1)[x(k) ? x?(k)]\n(5.24)\n\nFinalizando a ana?lise, pode-se substituir x?(k + 1) da equac?a?o\n(5.17) e x(k + 1) da equac?a?o (5.14), encontrando a relac?a?o expressa na\nequac?a?o (5.25).\n\n\n\n93\n\nw?(k) = Fr(z\n?1)[Ax(k) + Bu(k ?d) + w(k) ?Ax?(k) ?Bu(k ?d)]\n\n?AFr(z?1)[x(k) ? x?(k)]\n= Fr(z\n\n?1)w(k) + [Fr(z\n?1)A?AFr(z?1)][x(k) ? x?(k)]\n\n(5.25)\n\nA deduc?a?o anterior foi apresentada de forma similar em [2], e\npode-se mais uma vez observar que caso as perturbac?o?es sejam cons-\ntantes e Fr(1) = I, enta?o w?(k) ? w(k) para k ? ?. Ainda, vale\nmencionar que para o caso linear Fr(z\n\n?1) e? uma matriz de trans-\nfere?ncia arbitra?ria e, se adequadamente escolhida a relac?a?o Fr(z\n\n?1)A =\nAFr(z\n\n?1)1 e? verdadeira, reduzindo a equac?a?o (5.25) para a relac?a?o em\n(5.26).\n\nw?(k) = Fr(z\n?1)w(k) (5.26)\n\nA relac?a?o apresentada na equac?a?o (5.26) evidencia o comporta-\nmento da incerteza equivalente, sendo esse diferente das relac?o?es apre-\nsentadas nos esquemas do PNMPC tradicional e do PNMPC modi-\nficado. Aqui, um ajuste adequado do filtro faz com que o efeito da\nincerteza equivalente possa ser manipulado.\n\nAssim, ao passo que nos casos anteriores a relac?a?o entre a in-\ncerteza equivalente e a incerteza real era afetada apenas pelo atraso\nnominal e tambe?m por para?metros do modelo utilizado, agora essa\nrelac?a?o pode ser modificada atrave?s da utilizac?a?o do filtro de robustez\ne enta?o requisitos de controle, como: robustez e ajuste da resposta a\nperturbac?o?es, podem ser manipulados. Nos casos anteriores a robustez\ndependia apenas de para?metros do sistema.\n\nEm relac?a?o ao erro de predic?a?o, da equac?a?o (5.14) e? possivel\nestabelecer a relac?a?o em (5.27). Da predic?a?o via preditor de Smith\nfiltrado, e? poss??vel estende?-la para a relac?a?o em (5.28).\n\n1Para isso o filtro de robustez deve possuir uma forma diagonal com func?o?es de\n\ntransfere?ncias SISO ide?nticas, como Fr(z\n?1) =\n\n?\n????\n\nF(z?1) 0 ... 0\n0 F(z?1) ... 0\n.\n.\n.\n\n.\n\n.\n\n.\n. . .\n\n.\n\n.\n\n.\n0 0 ... F(z?1)\n\n?\n????.\n\nEssa restric?a?o e? simples para o caso de processos esta?veis em malha aberta, ja? que\na escolha de F(z?1) e? livre [6].\n\n\n\n94\n\ne(k) = x(k) ? x?(k ?d) (5.27)\n\ne(k) = x(k) ? x?(k) ? Fr(z?1)[x(k ?d) ? x?(k ?d)]\n= [I ?z?dFr(z?1)][x(k) ? x?(k)] (5.28)\n\nUtilizando as relac?o?es expressas em (5.15) e? poss??vel descrever a\nrelac?a?o do erro de predic?a?o com a incerteza real pela equac?a?o (5.29).\nComo apresentado em [2], essa relac?a?o permite estabelecer um limitante\npara o erro de predic?a?o, dado um limitante natural para as incertezas\nreais e, em adic?a?o a um conjunto limitante para as incertezas preditas,\ngarantir tambe?m a satisfac?a?o robusta de restric?o?es.\n\ne(k) = [I ?z?dFr(z?1)]Q(z?1)w(k) (5.29)\n\nAo se comparar os tre?s casos, dados pelas equac?o?es (5.7), (5.12)\ne (5.26), ve?-se que o PNMPC e? a estrate?gia na qual a incerteza predita\ntende a possuir a maior magnitude e assim tornar o esquema de controle\nmenos robusto. Em contrapartida, o PNMPC com compensac?a?o de\natraso via preditor de Smith filtrado e? o caso no qual o esquema de\ncontrole pode apresentar a maior robustez, visto que o filtro pode ser\najustado para aumentar a robustez, como detalhado em [6] e [2]. Deve-\nse ressaltar tambe?m a capacidade de se ajustar o filtro para melhorar\no desempenho da resposta a perturbac?o?es [6].\n\nNo entanto, e? importante lembrar tambe?m que o PNMPC Modi-\nficado apresenta uma formulac?a?o simples e pode tambe?m aumentar con-\nsideravelmente a robustez, apresentando assim uma boa relac?a?o custo-\nbenef??cio.\n\n5.3 ANA?LISE NA?O LINEAR DA ROBUSTEZ\n\nAssim como na sec?a?o 5.2, sera? apresentada uma ana?lise com-\nparativa da robustez das tre?s estrate?gias envolvidas nesse projeto: o\nPNMPC, o PNMPC com o esquema de compensac?a?o do atraso utili-\nzando um modelo de perturbac?a?o modificado e o PNMPC com com-\npensac?a?o de atraso via preditor de Smith filtrado. No entanto, sera?\ndado agora um enfoque ao caso mais geral, analisando a robustez de\n\n\n\n95\n\nprocessos modelados por sistemas na?o lineares com atraso de trans-\nporte. Mais uma vez sera? utilizada a comparac?a?o entre o comporta-\nmento das incertezas preditas.\n\nEssa linha de ana?lise destaca o diferencial da estrate?gia PNMPC,\nque e? a possibilidade de se utilizarem as vantagens dos controladores\npreditivos em processos na?o lineares em conjunto com estrate?gias efici-\nentes de controle de processos com atraso de transporte, como e? o caso\ndo preditor de Smith filtrado.\n\nPara expor a ana?lise considera-se um sinal discreto no tempo,\nx, e a sua amostra em um instante qualquer k, x(k). x e? usado\npara representar uma seque?ncia e para representar uma seque?ncia de-\nfinida entre dois instantes diferentes i e j tem-se x[i,j], sendo x[i,j] =\n{x(i), . . . ,x(j)}. Ainda, |x|s, representa a norma induzida de vetor.\n\nPara representar um processo na?o linear com atraso utiliza-se\num modelo como o apresentado na equac?a?o (5.30).\n\nx(k + 1) = f (x(k),u(k ?d)) + w(k) (5.30)\n\nAs incertezas esta?o representadas de forma aditiva, como em\n(5.31).\n\nw(k) = x(k + 1) ?f (x(k),u(k ?d)) (5.31)\n\nCom vistas a definir uma soluc?a?o temporal para o modelo repre-\nsentado em (5.30), considera-se um modelo equivalente sem a presenc?a\ndo atraso de transporte, como em (5.32). Para esse modelo equivalente\ndefine-se enta?o a func?a?o ?? (\u00b7), equac?a?o (5.33), que descreve a soluc?a?o\ndo sistema no instante k para uma condic?a?o inicial x, uma seque?ncia\nde controle u e uma seque?ncia de incertezas w aplicadas ao sistema.\n\nx?(k + 1) = f (x?(k),u(k)) + w?(k) (5.32)\n\n?? (k,x,u,w) (5.33)\n\nExpressando (5.33) para os modelos na?o lineares com atraso con-\nfirma-se o fato de sua resposta temporal sofrer a influe?ncia do atraso.\nComo apresentado em (5.34), nesses casos o estado em um instante k\n\n\n\n96\n\ne? determinado em um instante anterior k ?d e por uma seque?ncia de\ncontrole tal que o u?ltimo instante de controle que atua sobre o processo\ne? k ?d? 1.\n\nx(k) = ??(k ?d,x(d),u[0,k?d?1],w[d,k?1]) (5.34)\n\nVale ressaltar tambe?m que o instante inicial x(d), representado\nna equac?a?o (5.34), e? o estado mais recente a na?o sofrer a influe?ncia da\nseque?ncia de controle u[0,k?d?1].\n\nPara simplificar o caso no qual na?o ha? incertezas (caso nominal)\nutiliza-se a relac?a?o (5.35).\n\n?? (k,x,u,0) = ?? (k,x,u) (5.35)\n\nEssas definic?o?es sa?o importantes para a demonstrac?a?o da robus-\ntez no caso no qual o PNMPC e? utilizado em conjunto com a com-\npensac?a?o expl??cita do atraso via preditor de Smith filtrado. O estudo\nde robustez do PNMPC e do PNMPC modificado segue nas sec?o?es 5.3.1\ne 5.3.2.\n\n5.3.1 PNMPC\n\nAssim como na ana?lise linear, a robustez do PNMPC sera? aqui\nanalisada atrave?s do estudo do comportamento da incerteza predita.\nVale lembrar que nessa estrate?gia de controle e? poss??vel distinguir a\npredic?a?o realizada ate? o instante de atraso da predic?a?o realizada a par-\ntir do atraso ate? o fim do horizonte de predic?a?o. Essa distinc?a?o des-\ntaca a existe?ncia de um esquema de compensac?a?o impl??cita que realiza\numa predic?a?o dos estados do processo a ser utilizada para o ca?lculo do\npro?ximo valor de controle.\n\nTambe?m como no caso linear, um modelo de perturbac?a?o for-\nnece a cada instante de predic?a?o um sinal de correc?a?o, ?, no qual ?(k)\nrepresenta o sinal de correc?a?o baseado no erro de predic?a?o (erro entre\na sa??da predita e a sa??da real) do instante de amostragem k. E ?[i,j]\nrepresenta uma seque?ncia do sinal ? igual a ?[i,j] = {?(i), . . . ,?(j)}.\n\nComo o atraso existente no processo faz com que a ac?a?o de con-\ntrole u(k) so? afete o processo em k+d, pode-se utilizar as informac?o?es ja?\nconhecidas ate? enta?o para representar a predic?a?o, que como dito inicial-\nmente, no caso do PNMPC, e? realizada de forma impl??cita. Assim, con-\n\n\n\n97\n\nsiderando a equac?a?o (5.30) d passos a frente obte?m-se a representac?a?o\nem (5.36).\n\nx(k + d + 1) = f (x(k + d),u(k)) + w(k + d). (5.36)\n\nContudo, uma vez que x(k + d) na?o e? conhecido no instante\nk, pode-se realizar uma predic?a?o baseada nas informac?o?es dispon??veis\nnesse instante, representada por x(k + d|k). Esse tipo de predic?a?o tem\npor objetivo representar o sistema atrave?s de um modelo sem atraso,\nconforme indicado na equac?a?o (5.37).\n\nx(k + d + 1|k + 1) = f (x(k + d|k),u(k)) + w?(k) (5.37)\n\nSendo w?(k) 6= w(k + d), pois x(k + d|k) 6= x(k + d) e x(k + d +\n1|k) 6= x(k + d + 1). Por fim, como x(k + d|k) e? definido no instante k\ne x(k + d + 1|k + 1) e? definido no instante k + 1, pode-se utilizar uma\nnotac?a?o simplificada dada por x(j + d|j) = x?(j), (5.38).\n\nx?(k + 1) = f (x?(k),u(k)) + w?(k). (5.38)\n\nEssa representac?a?o e? interessante, ja? que em esquemas de con-\ntrole com compensac?a?o do atraso, o controlador principal utiliza uma\npredic?a?o para o valor dos estados e das sa??das apo?s o efeito do atraso\nno ca?lculo do pro?ximo valor de controle a ser aplicado no processo com\natraso. Assim, a representac?a?o em (5.38) e? importante, pois em con-\njunto com a representac?a?o do processo com atraso (5.30) possibilita o\nestudo do comportamento da incerteza predita, atrave?s do estudo do\npior caso de |w?(k)|s.\n\nE? importante ressaltar que estrate?gias de compensac?a?o de atraso\ndistintas induzira?o a predic?o?es diferenciadas, devido ao comportamento\nde w?(k). Enta?o, uma forma de ana?lise do comportamento robusto das\nestrate?gias de compensac?a?o de atraso e? observar o comportamento dessa\nincerteza. Esse tipo de estudo e? amplo, pois a ana?lise de robustez inde-\npende do controlador prima?rio, que e? aquele projetado para o modelo\nsem atraso.\n\nCom vistas a demonstrar analiticamente a propriedade de ro-\nbustez do PNMPC estudando o comportamento da incerteza predita,\nrestringem-se os processos sob ana?lise para aqueles descritos por func?o?es\nf(x,u) localmente Lipschitz cont??nuas em x, no dom??nio X \u00d7U, com\nf(0,0) = 0. Essa restric?a?o possibilita expressar a relac?a?o da equac?a?o\n(5.39), [28]. Sendo 0 &lt;Lf &lt;? a constante de Lipschitz.\n\n\n\n98\n\n|f (x(i),u) ?f (x(j),u) |s ? Lf|x(i) ?x(j)|s (5.39)\n\nAo se restringir os processos utilizando func?o?es localmente Lips-\nchitz para representa?-los e? poss??vel demonstrar tambe?m que as suas\nrespostas temporais, dadas por (5.33), sa?o func?o?es localmente Lipschitz\ncont??nuas em x, para todo x ? X e u ? U, para diferentes condic?o?es\niniciais sob uma mesma seque?ncia de controle. E ainda, a constante de\nLipschitz da func?a?o que modela o processo em questa?o ira? se propagar\nconforme esta? apresentado na equac?a?o (5.40).\n\n???\n(\nj,a,u[0,j?1]\n\n)\n? ??\n\n(\nj,b,u[0,j?1]\n\n)\n?s ? L\n\nj\nf?a? b?s (5.40)\n\nEssa relac?a?o surge devido a caracter??stica recursiva na obtenc?a?o\nda soluc?a?o dos estados, como demonstrado pela seque?ncia de equac?o?es\nem (5.41)\n\n???(j,a,u[0,j?1]) ? ??(j,b,u[0,j?1])?s\n\n= ?f(??(j ? 1,a,u[0,j?2]),u(j ? 1))?\nf(??(j ? 1,b,u[0,j?2]),u(j ? 1))?s\n\n? Lf???(j ? 1,a,u[0,j?2]) ? ??(j ? 1,b,u[0,j?2])?s\n\n? Lf?f(??(j ? 2,a,u[0,j?3]),u(j ? 2))?\nf(??(j ? 2,b,u[0,j?3]),u(j ? 2))?s\n\n? L2f???(j ? 2,a,u[0,j?3]) ? ??(j ? 2,b,u[0,j?3])?s\n\n?\n...\n\n? Ljf?a? b?s (5.41)\n\nA partir das constatac?o?es enunciadas e? poss??vel enta?o analisar a\n\n\n\n99\n\npropagac?a?o das incertezas pelo mecanismo de predic?a?o do PNMPC.\nConsiderando-se as equac?o?es (5.37) e (5.38), utilizando a desigual-\ndade triangular e a equac?a?o (5.39), chega-se a? desigualdade da equac?a?o\n(5.42).\n\n|w?(k)|s =|x(k + d + 1|k + 1) ?f (x(k + d|k),u(k)) |s\n=|f(x(k + d|k + 1),u(k)) + ?(k + 1) ?f (x(k + d|k),u(k)) |s\n?|f(x(k + d|k + 1),u(k)) ?f (x(k + d|k),u(k)) |s\n\n+ |?(k + 1)|s\n?Lf|x(k + d|k + 1) ?x(k + d|k)|s + |?(k + 1)|s (5.42)\n\nRealizando o mesmo procedimento a partir da equac?a?o (5.42),\nverifica-se a relac?a?o (5.43).\n\n|w?(k)|s ?Lf|f(x(k + d? 1|k + 1),u(k ? 1)) ?f(x(k + d? 1|k),\nu(k ? 1))|s + Lf|?(k + 1) ??(k)|s + |?(k + 1)|s\n?L2f|x(k + d? 1|k + 1) ?x(k + d? 1|k)|s\n\n+ Lf|?(k + 1) ??(k)|s + |?(k + 1)|s\n?L2f|f(x(k + d? 2|k + 1),u(k ? 2)) ?f(x(k + d? 2|k),\n\nu(k ? 2))|s +\n2?\nj=1\n\nL\nj\nf|?(k + 1) ??(k)|s + |?(k + 1)|s\n\n?L3f|x(k + d? 2|k + 1) ?x(k + d? 1|k)|s\n\n+\n\n2?\nj=1\n\nL\nj\nf|?(k + 1) ??(k)|s + |?(k + 1)|s (5.43)\n\nRepetindo os passos recursivamente a partir de (5.43), obte?m-se\num limitante para w?(k) dado pela equac?a?o (5.44).\n\n|w?(k)|s ?Ldf|x(k + 1|k + 1) ?x(k + 1|k)|s\n\n+\n\nd?1?\nj=1\n\nL\nj\nf|?(k + 1) ??(k)|s + |?(k + 1)|s\n\n|w?(k)|s ?Ldf|x(k + 1) ?f(x(k),u(k ?d)) ??(k)|s\n\n\n\n100\n\n+\n\nd?1?\nj=1\n\nL\nj\nf|?(k + 1) ??(k)|s + |?(k + 1)|s\n\n=Ldf|w(k) ??(k)|s +\nd?1?\nj=1\n\nL\nj\nf|?(k + 1) ??(k)|s\n\n+ |?(k + 1)|s (5.44)\n\nAs principais concluso?es para esse caso envolvem mais uma vez\no comportamento da varia?vel de correc?a?o, ?, adicionada nas predic?o?es\npelo modelo de perturbac?a?o original do PNMPC. Como e? aplicado o\nmesmo valor de correc?a?o em cada instante de predic?a?o, em um per??odo\nigual ao tempo de atraso ocorrera? sempre o acu?mulo dessas correc?o?es,\ncomo pode ser observado na equac?a?o (5.44). Efeito esse potenciali-\nzado pelo tamanho do atraso nominal. Esse comportamento aumenta\na norma de w? diminuindo assim a robustez em malha fechada, pois w?\naltera o valor de x?(k + d|k), informac?a?o utilizada para o co?mputo do\npro?ximo esforc?o de controle.\n\nAssim, a influe?ncia das correc?o?es aplicadas em cada instante de\npredic?a?o encontrada no caso linear tambe?m se faz presente no caso na?o\nlinear.\n\n5.3.2 PNMPC Modificado\n\nPara demonstrar as propriedades de robustez do PNMPC Modi-\nficado considera-se a modificac?a?o no modelo de perturbac?a?o proposta\nno cap??tulo 4. Assim, ate? o instante k+d|k de um horizonte de predic?a?o\nsera?o utilizadas as correc?o?es calculadas nos instantes de amostragem\nanteriores. Vale ressaltar novamente que na medida em que o principal\nobjetivo da utilizac?a?o de ?(k) e? a eliminac?a?o do erro de predic?a?o na pre-\nsenc?a de perturbac?a?o constante e? poss??vel utilizar tambe?m os valores\nde ?(k?d+ 1), ..., ?(k?1). Isso e? permitido, pois se ?(k) ? wss, enta?o\n?(k ? i) ? wss, i = 1,...,d ? 1. Dessa forma, o esquema de predic?a?o\nmodificado passa a ser descrito pela recursa?o em (5.45).\n\n\n\n101\n\nx(k + 1|k) = f(x(k),u(k ?d)) + ?(k ?d + 1)\nx(k + 2|k) = f(x(k + 1|k),u(k ?d + 1)) + ?(k ?d + 2)\n\n... =\n...\n\nx(k + d|k) = f(x(k + d? 1|k),u(k ? 1)) + ?(k) (5.45)\n\nComo para esse preditor modificado, a diferenc?a x(k +d|k + 1)?\nx(k + d|k) e? dada por:\n\nx(k + d|k + 1) ?x(k + d|k) =f(x(k + d? 1|k + 1),u(k ? 1)) + ?(k)\n?f(x(k + d? 1|k),u(k ? 1)) ??(k)\n\n?Lf|x(k + d? 1|k + 1) ?x(k + d? 1|k)|s,\n\npode-se repetir os passos de recursa?o a partir da equac?a?o (5.42) e obter-\nse um novo limitante para w?(k) dado pela equac?a?o (5.46).\n\n|w?(k)|s ?Lf|x(k + d|k + 1) ?x(k + d|k)|s + |?(k + 1)|s\n?L2f|x(k + d? 1|k + 1) ?x(k + d? 1|k)|s + |?(k + 1)|s\n\n?\n...\n\n?Ldf|x(k + 1|k + 1) ?x(k + 1|k)|s + |?(k + 1)|s\n?Ldf|x(k + 1) ?f(x(k),u(k ?d)) ??(k ?d + 1)|s\n\n+ |?(k + 1)|s\n?Ldf|w(k) ??(k ?d + 1)|s + |?(k + 1)|s (5.46)\n\nMais uma vez, como no caso linear, e? poss??vel perceber o acre?sci-\nmo na robustez que a modificac?a?o proposta acarreta. Isso ocorre devido\na? eliminac?a?o do acu?mulo das correc?o?es, o que diminui a norma do pior\ncaso da incerteza predita. Deve-se ressaltar tambe?m que, para o caso\nno qual Lf &lt;1 (sistemas na?o lineares apenas com pontos de equil??brio\nesta?veis), o crescimento do atraso nominal na?o altera o desempenho\nrobusto de maneira significativa na medida que Ldf assume valores me-\nnores para valores maiores de d, assim como ocorre com o preditor de\nSmith. Por outro lado, a grande vantagem dessa estrate?gia se compa-\nrada ao preditor de Smith, e? que ela pode ser aplicada de forma direta\n\n\n\n102\n\nem sistemas na?o-lineares com pontos de equil??brio insta?veis. A respeito\ndo esforc?o computacional, o preditor modificado e o preditor convencio-\nnal se equivalem, pois em ambos os casos a predic?a?o e? obtida de forma\niterativa, sendo necessa?rio o mesmo nu?mero de iterac?o?es.\n\n5.3.3 PNMPC via Preditor de Smith Filtrado\n\nNessa sec?a?o e? apresentada a ana?lise de robustez atrave?s do es-\ntudo da propagac?a?o das incertezas na predic?a?o realizada por um FSP\nque esta? associado a um controlador PNMPC, para o controle de pro-\ncessos na?o lineares com compensac?a?o de atraso robusta. Novamente, a\nrespeito da modelagem do sistema pode-se dizer que os processos sob\nana?lise sa?o bem descritos pela equac?a?o (5.30) e as incertezas descritas\nde forma aditiva, como em (5.31).\n\nAinda, para representar a soluc?a?o de um sistema na forma (5.30),\ndados um instante inicial, um estado inicial e uma seque?ncia de controle\ne de incertezas tem-se a equac?a?o (5.33).\n\nCom vistas a apresentar o esquema de predic?a?o realizado por um\ncompensador de atraso FSP define-se o modelo nominal de um processo\ncomo o apresentado pela equac?a?o (5.30), na?o considerando a presenc?a\nde incertezas, equac?a?o (5.47).\n\nx?(k + 1) = f (x?(k),u(k ?d)) (5.47)\n\nDessa forma, uma predic?a?o o?tima para o estado atual pode ser\nrealizada a partir do modelo nominal do processo definido na equac?a?o\n(5.47), resultando na expressa?o apresentada na equac?a?o (5.48).\n\nx?(k + d|k) = ?\n(\nd,x?(k),u[k?d,k?1]\n\n)\n(5.48)\n\nComo apresentado no cap??tulo 4, a predic?a?o para o estado atual\nrealizada por um compensador de atraso FSP em processos assinto-\nticamente esta?veis e? a predic?a?o o?tima apresentada na equac?a?o (5.48)\nadicionada a uma parcela referente a? diferenc?a entre a sa??da real e\na sa??da nominal atual filtrada, o que resulta na expressa?o apresen-\ntada na equac?a?o (5.49). No entanto, deve-se ressaltar novamente que\na aplicac?a?o da estrate?gia de compensac?a?o de atraso via preditor de\nSmith foi formulada para representac?o?es entrada-sa??da. Para contor-\nnar essa restric?a?o pode-se considerar uma sa??da auxiliar ya(k) = x(k).\nE ainda, sabe-se que para processos insta?veis e? necessa?rio realizar uma\nadaptac?a?o ao esquema de predic?a?o, mas que, para efeito de ana?lise, na?o\n\n\n\n103\n\nmodifica a propagac?a?o das incertezas.\n\nx?(k) = x(k + d|k) = x?(k + d|k) + Fr\n(\nz?1\n)\n\n(x(k) ? x?(k)) (5.49)\n\nMais uma vez, os processos na?o lineares aqui representados pos-\nsuem a evoluc?a?o dos estados descrita por uma func?a?o localmente Lips-\nchitz cont??nua, e assim a relac?a?o apresentada na equac?a?o (5.39) e? ver-\ndadeira. E tambe?m a func?a?o que representa a soluc?a?o dos estados e? lo-\ncalmente Lipschitz cont??nua para diferentes condic?o?es iniciais sob uma\nmesma seque?ncia de controle e pode-se afirmar tambe?m que a relac?a?o\nde (5.40) e? verdadeira.\n\nPara representar o modelo equivalente devido ao mecanismo de\npredic?a?o do PNMPC com FSP considere um modelo, como o apresen-\ntado na equac?a?o (5.37). E caso o estado x?(k + 1) seja obtido tomando\no estado x(k + 1) como condic?a?o inicial, a predic?a?o sera? da forma apre-\nsentada em (5.50).\n\nx?(k + 1) = x?(k + d + 1|k + 1) + Fr\n(\nz?1\n)\n\n(x(k + 1) ? x?(k + 1)) (5.50)\n\nSendo x?(k +d+ 1|k + 1) obtido atrave?s da expressa?o apresentada\nna equac?a?o (5.51).\n\nx?(k + d + 1|k + 1) = ?\n(\nd,x?(k + 1),u[k?d+1,k]\n\n)\n(5.51)\n\nPara a ana?lise da propagac?a?o das incertezas atenta-se inicial-\nmente para uma equac?a?o que modela o comportamento equivalente do\nprocesso mais o esquema de compensac?a?o, equac?a?o (5.37). Tomando\na incerteza predita como refere?ncia e? poss??vel estabelecer uma relac?a?o\nentre a sua norma e a norma da incerteza real partindo da relac?a?o\n(5.52).\n\n|w?(k)| = |x?(k + 1) ?f(x?(k),u(k))| (5.52)\n\nSubstituindo os valores das predic?o?es dadas pelo compensador\nde atraso FSP, (5.49) e (5.50), obte?m-se a equac?a?o (5.53).\n\n|w?(k)| =|x?(k + d + 1|k + 1) + Fr\n(\nz?1\n)\n\n(x(k + 1) ? x?(k + 1))\n?f\n\n(\nx?(k + d|k) + Fr\n\n(\nz?1\n)\n\n(x(k) ? x?(k)) ,u(k)\n)\n|\n\n(5.53)\n\n\n\n104\n\nA partir da diferenc?a triangular entre normas, e? poss??vel expres-\nsar a equac?a?o (5.53) pela equac?a?o (5.54).\n\n|w?(k)| ?|x?(k + d + 1|k + 1) ?f(x?(k + d|k) + Fr(z?1)\n(x(k) ? x?(k)),u(k))| + |Fr(z?1)(x(k + 1) ? x?(k + 1))|\n\n(5.54)\n\nUtilizando a definic?a?o de evoluc?a?o de estados, (5.33), e? poss??vel\nrelacionar a equac?a?o (5.54) na forma expressa pela equac?a?o (5.55).\n\n|w?(k)| ?|f\n(\n?\n(\nd? 1,x?(k + 1),u[k?d+1,k?1]\n\n)\n,u(k)\n\n)\n?f\n\n(\nx?(k + d|k) + Fr\n\n(\nz?1\n)\n\n(x(k) ? x?(k)) ,u(k)\n)\n|\n\n+ |Fr\n(\nz?1\n)\n\n(x(k + 1) ? x?(k + 1)) |\n(5.55)\n\nComo os processos na?o lineares sob ana?lise respeitam a relac?a?o\n(5.39), pode-se simplificar a equac?a?o (5.55), obtendo a relac?a?o expressa\nna equac?a?o (5.56).\n\n|w?(k)| ?Lf|?(d? 1,x?(k + 1),u[k?d+1,k?1]) ? x?(k + d|k) + Fr(z?1)\n(x(k) ? x?(k))| + |Fr(z?1)(x(k + 1) ? x?(k + 1))|\n\n(5.56)\n\nMais uma vez, pela desigualdade triangular entre normas e pela\ndefinic?a?o de evoluc?a?o dos estados pode-se representar a relac?a?o (5.56)\nutilizando a equac?a?o (5.57).\n\n|w?(k)| ?Lf|?\n(\nd? 1,x?(k + 1),u[k?d+1,k?1]\n\n)\n??\n\n(\nd,x?(k),u[k?d,k?1]\n\n)\n|\n\n+ Lf|Fr\n(\nz?1\n)\n\n(x(k) ? x?(k)) |\n+ |Fr\n\n(\nz?1\n)\n\n(x(k + 1) ? x?(k + 1)) | (5.57)\n\nDevido a? similaridade das soluc?o?es, e? poss??vel expressar a equac?a?o\n(5.57) como em (5.58).\n\n\n\n105\n\n|w?(k)| ?Lf|?\n(\nd? 1,x?(k + 1),u[k?d+1,k?1]\n\n)\n??\n\n(\nd? 1,f (x?(k),u(k ?d)) ,u[k?d+1,k?1]\n\n)\n|\n\n+ Lf|Fr\n(\nz?1\n)\n\n(x(k) ? x?(k)) |\n+ |Fr\n\n(\nz?1\n)\n\n(x(k + 1) ? x?(k + 1)) | (5.58)\n\nDa relac?a?o demonstrada nas equac?o?es (5.41) e? poss??vel represen-\ntar a relac?a?o em (5.58) pela equac?a?o (5.59).\n\n|w?(k)| ?Ldf|x?(k + 1) ?f (x?(k),u(k ?d)) |\n+ Lf|Fr\n\n(\nz?1\n)\n\n(x(k) ? x?(k)) |\n+ |Fr\n\n(\nz?1\n)\n\n(x(k + 1) ? x?(k + 1)) | (5.59)\n\nDevido a? igualdade proveniente da definic?a?o do modelo nominal\ndo processo, equac?a?o (5.47), e? poss??vel simplificar a equac?a?o (5.59) e\nobter a relac?a?o (5.60).\n\n|w?(k)| ?Lf|Fr\n(\nz?1\n)\n\n(x(k) ? x?(k)) |\n+ |Fr\n\n(\nz?1\n)\n\n(x(k + 1) ? x?(k + 1)) | (5.60)\n\nEssa relac?a?o apresentada na equac?a?o (5.60) deixa clara a dife-\nrenc?a entre o comportamento da incerteza equivalente, em comparac?a?o\ncom as relac?o?es apresentadas tanto no PNMPC tradicional quanto no\nPNMPC modificado. No PNMPC com o preditor de Smith filtrado o\nfiltro age diretamente sobre o erro entre o estado nominal e o estado\nreal. Assim, um ajuste adequado do filtro permite a manipulac?a?o dessa\ndiferenc?a, o que pode impactar em um aumento de robustez do controle\nem malha fechada. Ja? nos casos anteriores, PNMPC e PNMPC modi-\nficado, a incerteza equivalente e? afetada pelo atraso nominal e tambe?m\npor para?metros do modelo utilizado.\n\n5.4 CONCLUSA?O\n\nComo comentado durante essa sec?a?o, a ana?lise da robustez e?\nmuito importante, pois estrate?gias de controle que utilizam uma predi-\nc?a?o para o ca?lculo do pro?ximo valor de controle esta?o naturalmente\n\n\n\n106\n\nsujeitas ao comportamento da incerteza predita, que depende tanto do\nmodelo de perturbac?a?o quanto do esquema de compensac?a?o de atraso\nutilizado.\n\nAssim, para garantir boa robustez em um esquema de controle\nque utiliza compensadores de atraso e? importante que essa incerteza\npredita possua algumas caracter??sticas especiais, como na?o ser influ-\nenciada por para?metros do modelo, em especial o tamanho do atraso\nnominal e tambe?m pelas varia?veis do observador utilizado para estimar\nas incertezas reais.\n\nFoi demonstrado tanto para o caso linear como para o caso na?o\nlinear que no PNMPC a incerteza predita, que faz parte da predic?a?o,\nsofre influe?ncia da dina?mica do modelo, do tamanho do atraso nomi-\nnal e tambe?m de um acu?mulo de varia?veis utilizadas para corrigir as\npredic?o?es, fornecidas pelo modelo de perturbac?a?o do PNMPC, pos-\nsuindo enta?o baixa robustez ao erro de estimac?a?o do atraso.\n\nApresentou-se tambe?m que para o caso do PNMPC modificado\na robustez e? incrementada. Foi comprovado analiticamente que a in-\ncerteza predita para o caso no qual o PNMPC utiliza um compensador\nde atraso do tipo preditor de Smith filtrado: na?o sofre influe?ncia da\ndina?mica do modelo; na?o sofre influe?ncia do atraso nominal; e tambe?m\nna?o sofre influe?ncia do acu?mulo das varia?veis de correc?a?o. Possuindo\nassim maior robustez do que os esquemas anteriores. E ainda ficou\nn??tida a importa?ncia do filtro do preditor de Smith filtrado no sentido\nde poder ajustar a robustez do esquema de controle, ja? que ele atua\ndiretamente no erro de predic?a?o.\n\n\n\n107\n\n6 CONSIDERAC?O?ES FINAIS\n\nApresentou-se nesse trabalho uma alternativa para o controle\npreditivo robusto de processos na?o lineares com atraso de transporte.\nComo comentado inicialmente, estrate?gias nessa linha sa?o interessantes\nquando: e? necessa?rio utilizar as vantagens dos controladores preditivos\n(como a possibilidade de levar em considerac?a?o restric?o?es); e? necessario\nrepresentar de forma mais acurada os processos sob controle (utilizando\npara isto modelos na?o lineares); e quando e? necessa?rio tambe?m tratar\no atraso na malha de controle.\n\nFoi realizado um levantamento do histo?rico de pesquisas relacio-\nnadas ao impacto do atraso nos controladores preditivos e a? robustez.\nAle?m disso, foram estudadas tambe?m soluc?o?es para o controle predi-\ntivo na?o linear e soluc?o?es para o tratamento do atraso na malha de\ncontrole, os compensadores de atraso. Como resultado desses esforc?os,\ndeterminou-se a estrate?gia PNMPC como uma boa opc?a?o para o con-\ntrole preditivo na?o linear, por possuir uma boa relac?a?o desempenho, ve-\nlocidade e simplicidade. Ale?m disso, para tratar o atraso encontrou-se\nnos compensadores FSP uma opc?a?o adequada para garantir a robustez\nnesses casos.\n\nAssim, foram introduzidos os conceitos de controladores predi-\ntivos com um enfoque dedicado nos controladores PNMPC. Tambe?m\napresentou-se a teoria acerca dos compensadores de atraso preditor de\nSmith e preditor de Smith filtrado, para em seguida apresentar uma\nintroduc?a?o da compensac?a?o de atraso em controladores preditivos.\n\nPara alcanc?ar o primeiro objetivo do trabalho foram propostas\nduas principais estrate?gias. A primeira delas e? o pro?prio PNMPC com\numa compensac?a?o de atraso expl??cita e uma modificac?a?o no modelo\nde perturbac?a?o, que aumentou a sua robustez eliminando um acu?mulo\nde valores de correc?o?es na incerteza predita. E a segunda estrate?gia\nconsistiu na unificac?a?o do PNMPC com o FSP, utilizando tambe?m a\ncompensac?a?o de atraso expl??cita.\n\nVale ressaltar ainda a generalidade da modificac?a?o proposta, ja?\nque ela situa-se no esquema de compensac?a?o de atraso. Isso permite que\nela tambe?m seja aplicada em outras estrate?gias de controle preditivo\nutilizando compensac?a?o de atraso expl??cita, como e? o caso do GPC.\nAinda, por proporcionar maior robustez no controle de processos na?o\nlineares com pontos de equil??brio esta?veis e com atraso e por poder ser\nutilizada em processos na?o lineares com pontos de equil??brio insta?veis\napresenta grande vantagem perante outras estrate?gias de compensac?a?o\n\n\n\n108\n\nde atraso, como o preditor de Smith.\nEm seguida, foi realizada uma ana?lise para demonstrar a me-\n\nlhoria no comportamento robusto das estrate?gias propostas, principal-\nmente no caso do PNMPC com compensac?a?o de atraso via preditor de\nSmith filtrado. Nesse caso, observa-se que a incerteza predita na?o e?\ninfluenciada pela dina?mica do modelo, nem pelo atraso de transporte\ne muito menos por acu?mulo das varia?veis de correc?a?o do modelo de\nperturbac?a?o. Ressaltou-se ainda a importa?ncia do filtro do preditor\nde Smith filtrado por permitir ajustes na robustez e na dina?mica da\nresposta a perturbac?a?o.\n\nA releva?ncia desse trabalho esta? em apresentar uma ana?lise teo?ri-\nca da robustez, comprovando analiticamente os ganhos ao se utilizar\na estrate?gia de compensac?a?o de atraso preditor de Smith filtrado em\nconjunto com o PNMPC. Dessa forma, e? poss??vel resolver um problema\ncomplexo de controle, o controle preditivo na?o linear de processos com\natraso de transporte, de forma robusta. Pode-se concluir enta?o que a\nutilizac?a?o do PSF em unia?o com o PNMPC e? extremamente vantajosa\ne que e? poss??vel garantir maior robustez ao utiliza?-la quando comparada\ncom a compensac?a?o impl??cita do atraso realizada apenas pelo pro?prio\nPNMPC.\n\nAinda como resultado do trabalho foi aprovado e publicado um\nartigo, no SBAI (Simpo?sio Brasileiro de Automac?a?o Inteligente) intitu-\nlado: \u201cCompensador de atraso modificado para Sistemas na?o-lineares\ncom tempo morto\u201d [27].\n\nUm ponto importante a se destacar sobre as estrate?gias de com-\npensac?a?o de atraso desenvolvidas nesse trabalho e? o carater gene?rico\nde sua formulac?a?o. Por estar associada a um esquema de controle\no qual utiliza predic?o?es futuras fornecidas a um controlador prima?rio\npara controlar um processo com atraso, e? poss??vel utilizar os mesmos\nconceitos em outras te?cnicas que utilizam abordagens semelhantes para\na correc?a?o do erro de regime.\n\nComo perspectivas futuras desse trabalho e? interessante a rea-\nlizac?a?o de estudos a fim de se obter uma estrate?gia capaz de garantir\na satisfac?a?o robusta de restric?o?es. Esse caminho de pesquisa e? impor-\ntante, pois a possibilidade de aplicar restric?o?es e? uma das principais\nvantagens de controladores preditivos e assim a garantia da satisfac?a?o\nrobusta e? uma grande contribuic?a?o.\n\nUm caminho interessante tambe?m e? o de estudo de casos pra?ticos,\nabordando o desempenho da estrate?gia desenvolvida em aplicac?o?es re-\nais. E ainda, como trabalhos futuros pode-se destacar o estudo de\nrobustez na presenc?a de observadores de estados.\n\n\n\n109\n\nREFERE?NCIAS\n\n1 PLUCENIO, A. Desenvolvimento de Te?cnicas de Controle Na?o\nLinear para Elevac?a?o de Fluidos Multifa?sicos. 341 p. Tese (Tese de\nDoutorado) \u2014 Universidade Federal de Santa Catarina, 2010.\n\n2 SANTOS, T. L. M. Contribuic?o?es para o Controle Preditivo com\nCompensac?a?o de Atraso Robusta. 200 p. Tese (Tese de Doutorado) \u2014\nUniversidade Federal de Santa Catarina, 2011.\n\n3 CAMACHO, E.; BORDONS, C. Model Predictive Control. [S.l.]:\nSpringer-Verlag, 2004.\n\n4 NORMEY-RICO, J. E.; CAMACHO, E. F. Robustness effects of a\nprefilter in a Smith predictor-based generalised predictive controller.\nIEE Proceedings: Control Theory and Applications, v. 146, n. 2, p.\n179\u2013185, 1999. Dispon??vel em:&lt;www.scopus.com>.\n\n5 FINDEISEN, R.; ALLGo?WER, F. An introduction to nonlinear\nmodel predictive. Control, 21st Benelux Meeting on Systems and\nControl, Veidhoven.\n\n6 NORMEY-RICO, J.; CAMACHO, E. Control of Dead-time\nProcesses. London: Springer, 2007.\n\n7 SMITH, O. J. Closer control of loops with dead-time. Chem. Eng.\nProgress, 1957.\n\n8 QIN, S. J.; BADGWELL, T. A. A survey of industrial model\npredictive control technology. Control Engineering Practice, v. 11,\nn. 7, p. 733\u2013764, 2003. Cited By (since 1996): 962. Dispon??vel em:\n<www.scopus.com>.\n\n9 CANNON, M. Efficient nonlinear model predictive control\nalgorithms. Annual Reviews in Control, v. 28, n. 2, p. 229\u2013237, 2004.\n\n10 GENCELI, H.; NIKOLAU, M. Design of robust constrained model\npredictive controllers with volterra series. AIChE Jourbal, v. 41, n. 9,\np. 2098\u20132107, 1995.\n\n11 BALAKRISHNAN, V.; KOTHARE, M. V.; MORARI, M. Robust\nconstrained model predictive control using linear matrix inequalities.\nAutomatica, v. 32, n. 10, p. 1361\u20131379, 1996. ISSN 0005-1098.\n\n\n\n110\n\n12 CHOI, J. Y.; SON, W. K.; KWON, O. Robust predictive control\nof uncertain nonlinear system with constrained input. Transaction on\nControl, Automation and System Engineering, v. 4, p. 289\u2013295, 2002.\n\n13 SAKIZLIS, V.; MANTHANWAR, A.; PISTIKOPOULOS,\nE. Robust parametric predictive control design for polytopically\nuncertain systems. American Control Conference, 2005.\n\n14 LU, Y.; ARKUNL, Y. A scheduling quasi-minmax MPC for LPV\nsystems. American Control Conference, p. 2272\u20132276.\n\n15 DOUGHERTY, D.; COOPER, D. A practical multiple model\nadaptive strategy for single-loop MPC. Control Engineering Practice,\nv. 11, n. 2, p. 141\u2013159, 2003. ISSN 0967-0661.\n\n16 SHI, Y.; CHAI, T.; YUE, H. Robust one-step model predictive\ncontrol for discrete time-delay systems. In: IFAC Proceedings\nVolumes (IFAC-PapersOnline). [s.n.], 2008. v. 17. Dispon??vel em:\n<www.scopus.com>.\n\n17 RAO, C. V.; WRIGHT, S. J.; RAWLINGS, J. B. Application\nof interior-point methods to model predictive control. Journal of\nOptimization theory and applications, v. 99, n. 3, p. 723\u2013757, 1998.\n\n18 OLARU, S.; NICULESCU, S.-I. Predictive control for linear\nsystems with delayed input subject to constraints. In: Proceedings of\nthe XVII IFAC Triennial Congress. [S.l.]: IFAC, 2008.\n\n19 GONZALEZ, A. H.; ODLOAK, D. Robust model predictive\ncontrole for time delayed systems with optimizing targets and zone\ncontrol. In: . Robust Contro, Theory and Applications, Andrzej\nBartoszewicz (Ed.). [S.l.: s.n.], 2011.\n\n20 GALVEZ-CARRILLO, M.; De Keyser, R.; IONESCU, C.\nNonlinear predictive control with dead-time compensator: Application\nto a solar power plant. Solar Energy, 2009.\n\n21 BLOEMEN, H.; BOOM, T. Van de; VERBRUGGEN, H.\nModel-based predictive control for Hammerstein systems. In:\nProceedings of the 39th IEEE Conference on Decision and Control.\nSidney, Australia: IEEE.\n\n22 SANTOS, J. E. S. Controle Preditivo Na?o Linear para Sistemas\nde Hammerstein. Tese (Tese de Doutorado) \u2014 Universidade Federal\nde Santa Catarina, 2005.\n\n\n\n111\n\n23 RAMIRES, D. et al. Min-max MPC based on a computationally\nefficient upper bound worst case cost. Journal of Process Control,\n2006.\n\n24 LU, Y.; ARKUNL, Y. A praticle multiple model adaptative\nstrategy for single-loop MPC. Control Engineering Pratice, 2003.\n\n25 LAZAR, M. Nonlinear controler based on the EPSAC aproach.\nDissertac?a?o (Mestrado) \u2014 University of Ghent, 2001.\n\n26 NORMEY-RICO, J. E.; CAMACHO, E. F. Unified\napproach for robust dead-time compensator design. Journal of Pro-\ncess Control, v. 19, n. 1, p. 38\u201347, 2009. ISSN 0959-1524. Dispon??vel em:\n<http://www.sciencedirect.com/science/article/pii/S0959152408000279>.\n\n27 THOME, F.; SANTOS, T.; NORMEY, J. Compensador de atraso\nmodificado para sistemas na?o-lineares com tempo morto. Simpo?sio\nBrasileiro de Automac?a?o Inteligente, 2013.\n\n28 LIMON, D. et al. Robust design of dead time compensator\ncontrollers for constrained non-linear systems. European Control\nConference, 2011."}]}}}