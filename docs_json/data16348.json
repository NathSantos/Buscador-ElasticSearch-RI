{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.20462"}, {"@name": "filename", "#text": "4019_001059750.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL\n\nESCOLA DE ENGENHARIA\n\nTRABALHO DE CONCLUS\u00c3O EM ENGENHARIA DE\nCONTROLE E AUTOMA\u00c7\u00c3O\n\nC o n t r o l e I M C d e E s c o a m e n t o s\nM u l t i f \u00e1 s i c o s e m P l a t a f o r m a s d e\nP e t r \u00f3 l e o B a s e a d o e m u m M o d e l o\n\nS i m p l i f i c a d o\n\nAutor: Gabriel Agnischock da Silveira\n\nOrientador: Jorge Ot\u00e1vio Trierweiler\n\nPorto Alegre, 4 de janeiro de 2018\n\n\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira i\n\nSum\u00e1rio\n\nAgradecimentos iii\n\nResumo v\n\nAbstract vii\n\nLista de Figuras ix\n\nLista de Tabelas xi\n\nLista de Abreviaturas e Siglas xii\n\n1 Introdu\u00e7\u00e3o 1\n1.1 Objetivo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2\n\n2 Revis\u00e3o bibliogr\u00e1fica 3\n2.1 Sistemas de extra\u00e7\u00e3o de petr\u00f3leo offshore . . . . . . . . . . . . . . . . . . . . . . 3\n\n2.1.1 Gas-lift . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4\n2.2 Comportamento din\u00e2mico de sistemas com gas-lift: golfadas, bifurca\u00e7\u00e3o . . . . . . 5\n2.3 Controle de produ\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7\n\n2.3.1 Controle ativo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8\n2.4 Projeto de controle pelo m\u00e9todo IMC . . . . . . . . . . . . . . . . . . . . . . . . 9\n2.5 Aplica\u00e7\u00e3o de controle IMC anti-golfadas - Jahanshahi, 2013 . . . . . . . . . . . . 11\n\n3 Metodologia 15\n3.1 Modelo utilizado como planta a ser controlada - Di Meglio, 2009 . . . . . . . . . . 15\n3.2 Vis\u00e3o Geral do modelo simplificado proposto . . . . . . . . . . . . . . . . . . . . 19\n3.3 Projeto de controlador pelo m\u00e9todo IMC . . . . . . . . . . . . . . . . . . . . . . . 20\n\n3.3.1 Projeto de controle pelo m\u00e9todo IMC para o modelo linear simplificado . . 20\n3.3.2 Aplica\u00e7\u00e3o da metodologia Jahanshahi e Skogestad, 2013 para controlar o\n\nsistema de Di Meglio et al., 2009 . . . . . . . . . . . . . . . . . . . . . . 21\n\n4 Estudo de caso - Controle do modelo de Di Meglio et al., 2009 23\n4.1 Identifica\u00e7\u00e3o do ponto de bifurca\u00e7\u00e3o do sistema . . . . . . . . . . . . . . . . . . . 23\n4.2 Projeto de controle IMC com o modelo linear simplificado . . . . . . . . . . . . . 23\n4.3 Aplica\u00e7\u00e3o da metodologia de Jahanshahi e Skogestad, 2013 . . . . . . . . . . . . . 26\n\n5 Conclus\u00f5es 29\n\n\n\nii Trabalho de Conclus\u00e3o de Curso\n\n6 Refer\u00eancias 31\n\nAp\u00eandices 33\nA Procedimento para projeto de controladores IMC pela metodologia de Jahanshahi e\n\nSkogestad, 2013 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33\n\nAnexos 35\nA Identifica\u00e7\u00e3o em Python . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35\nB s-function do modelo de Di Meglio et al., 2012 . . . . . . . . . . . . . . . . . . . 38\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira iii\n\nAgradecimentos\n\nAgrade\u00e7o a todas as pessoas que fazem positivamente parte da minha vida, dentre as quais me\norgulho de citar: minha m\u00e3e e o amor da minha vida, Yasmin.\n\nObrigado aos desenvolvedores do AutomaTEX.\n\n\n\niv Trabalho de Conclus\u00e3o de Curso\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira v\n\nResumo\n\nNeste trabalho foram estudadas duas metodologias de projeto de controle IMC(Internal Model\nControl) para um sistema de extra\u00e7\u00e3o de petr\u00f3leo offshore. Foi realizado controle de press\u00e3o\nutilizando como planta o modelo do tipo caixa cinza de um sistema de extra\u00e7\u00e3o, com o objetivo\nde fazer com que o sistema operasse em regimes livres de oscila\u00e7\u00f5es caracter\u00edsticas desse tipo de\nsistema.\n\nA primeira metodologia \u00e9 baseada em um modelo linear simplificado identificado a partir de\ndados de opera\u00e7\u00e3o da planta a ser controlada. O modelo simplificado consiste em duas plantas de\nordem baixa em paralelo, uma est\u00e1vel, e outra que apresenta ciclo-limite quando opera em malha\naberta.\n\nA segunda metodologia consiste em identificar um modelo localmente inst\u00e1vel da planta, no\nentorno de um ponto de opera\u00e7\u00e3o que apresenta ciclo limite, atrav\u00e9s de um teste em malha fechada,\ne utiliz\u00e1-lo para projetar um controlador pelo m\u00e9todo IMC para sistemas inst\u00e1veis.\n\n\n\nvi Trabalho de Conclus\u00e3o de Curso\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira vii\n\nAbstract\n\nTwo IMC(Internal Model Control) control strategies for an offshore oil extraction system were\nstudied. Both methods yielded controllers, which were used to control a first principle based model\nof an oil extraction system.\n\nThe first strategy is based on a simplified linear model, which is identified from system data. The\nmodel consists of two parallel low-order plants, one that is stable, and one that presents open-loop\nlimit-cycle behaviour.\n\nThe second strategy is based on the identification of a locally unstable model of the extraction\nsystem, around an operation point which has a limit cycle. To identify this model, a closed-loop\nstabilizing controller is used. The unstable model is then used to design a controller using the\nunstable model IMC design procedure.\n\n\n\nviii Trabalho de Conclus\u00e3o de Curso\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira ix\n\nLista de Figuras\n\n1 Produ\u00e7\u00e3o mensal de petr\u00f3leo no pr\u00e9-sal e no p\u00f3s-sal . . . . . . . . . . . . . . . . 1\n2 Ilustra\u00e7\u00e3o de um sistema de extra\u00e7\u00e3o t\u00edpico . . . . . . . . . . . . . . . . . . . . . 3\n3 Diagrama de um po\u00e7o com o uso de gas-lift . . . . . . . . . . . . . . . . . . . . . 4\n4 Tipos de escoamento multif\u00e1sico. . . . . . . . . . . . . . . . . . . . . . . . . . . . 5\n5 Dados reais de press\u00e3o de um po\u00e7o no Mar do Norte. O gr\u00e1fico mostra as press\u00f5es\n\nno topo e no fundo do po\u00e7o em regime golfante. . . . . . . . . . . . . . . . . . . . 6\n6 Diagrama de bifurca\u00e7\u00e3o mostrando o impacto da golfada na taxa de produ\u00e7\u00e3o. . . . 7\n7 Ciclo de golfadas severas ocasionadas pela inflex\u00e3o do riser . . . . . . . . . . . . 8\n8 Sistema em malha aberta, no qual h\u00e1 seguimento de refer\u00eancia perfeito . . . . . . . 9\n9 Estrutura IMC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10\n10 Sistema de riser com um ponto baixo modelado por Jahanshahi e Skogestad, 2011. 11\n11 Ensaio em malha fechada com controlador P de ganho Kc0, usado para identificar o\n\nmodelo. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n12 Diagrama do riser modelado, ilustrando o princ\u00edpio da v\u00e1lvula virtual . . . . . . . 16\n13 Malha de feedback utilizada. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19\n14 Plantas G1 e G2 em paralelo. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n15 Sistema de controle de press\u00e3o de fundo pr,b controlando a abertura da v\u00e1lvula\n\nchoke de produ\u00e7\u00e3o. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21\n16 Varia\u00e7\u00e3o da press\u00e3o de fundo para diferentes valores de abertura da v\u00e1lvula choke\n\nde produ\u00e7\u00e3o. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23\n17 Identifica\u00e7\u00e3o do modelo baseado em dados do modelo de Di Meglio et al., 2012,\n\npara uma troca de abertura de v\u00e1lvula de 15% para 25%. . . . . . . . . . . . . . . 24\n18 Controle do sistema para ? = 500. . . . . . . . . . . . . . . . . . . . . . . . . . . 25\n19 Controle do sistema para ? = 500. Para estes setpoints, o sistema apresentou golfadas. 26\n20 Abertura de v\u00e1lvula m\u00e9dia no ensaio em malha fechada usado para identifica\u00e7\u00e3o do\n\nmodelo. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27\n21 Ensaio em malha fechada para identifica\u00e7\u00e3o do modelo inst\u00e1vel de segunda ordem. 27\n22 Controle do sistema para ? = 500. . . . . . . . . . . . . . . . . . . . . . . . . . . 28\n23 Controle do sistema para ? = 500. . . . . . . . . . . . . . . . . . . . . . . . . . . 28\n\n\n\nx Trabalho de Conclus\u00e3o de Curso\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira xi\n\nLista de Tabelas\n\n1 Par\u00e2metros do modelo de Di Meglio et al., 2009 . . . . . . . . . . . . . . . . . . . 18\n\n\n\nxii Trabalho de Conclus\u00e3o de Curso\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira xiii\n\nLista de Abreviaturas e Siglas\n\nANP Ag\u00eancia Nacional do Petr\u00f3leo. 1\n\nIMC Internal Model Control. 2\n\n\n\nxiv Trabalho de Conclus\u00e3o de Curso\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 1\n\n1 Introdu\u00e7\u00e3o\n\nGrande parte do interesse das companhias de \u00f3leo e g\u00e1s \u00e9 focado nas opera\u00e7\u00f5es de E&amp;P(explora\u00e7\u00e3o\ne produ\u00e7\u00e3o) de po\u00e7os de petr\u00f3leo e g\u00e1s em plataformas offshore. Segundo dados da Ag\u00eancia Nacio-\nnal do Petr\u00f3leo (ANP), no ano de 2017 a produ\u00e7\u00e3o de petr\u00f3leo no pr\u00e9-sal brasileiro ultrapassou a\nprodu\u00e7\u00e3o do p\u00f3s-sal (ANP, 2017), como pode ser visto na Figura 1. Como a produ\u00e7\u00e3o de petr\u00f3leo\nno pr\u00e9-sal tem um custo mais elevado do que no p\u00f3s-sal e no continente, esfor\u00e7os no intuito de\notimizar a produ\u00e7\u00e3o das plataformas se tornam necess\u00e1rios para justificar esses gastos.\n\nFigura 1: Produ\u00e7\u00e3o mensal de petr\u00f3leo no pr\u00e9-sal e no p\u00f3s-sal\n\nFonte: ANP, 2017\n\nUm desafio enfrentado nas opera\u00e7\u00f5es de extra\u00e7\u00e3o de petr\u00f3leo em plataformas offshore \u00e9 o de\noscila\u00e7\u00f5es das vari\u00e1veis de processo, como vaz\u00e3o e press\u00e3o, chamada de golfada. A golfada ocorre\ndevido \u00e0 intera\u00e7\u00e3o entre a disposi\u00e7\u00e3o f\u00edsica das instala\u00e7\u00f5es, como ondula\u00e7\u00f5es nos riser, po\u00e7os\nde extra\u00e7\u00e3o e v\u00e1lvulas, e o fluxo de produtos em regime multif\u00e1sico. De acordo com Pedersen\net al., 2017, em um dos padr\u00f5es de golfadas mais comuns, a fase l\u00edquida se acumula na base do\nriser, e bloqueia o fluxo de g\u00e1s vindo do po\u00e7o. \u00c0 medida que esse ac\u00famulo aumenta, a press\u00e3o\nde g\u00e1s se torna suficiente para mover o l\u00edquido acumulado, descarregando-o do riser em dire\u00e7\u00e3o \u00e0\nplataforma, e assim dando in\u00edcio novamente ao ciclo da golfada, que pode ser caracterizado como\num ciclo-limite.\n\nEm diversos sistemas din\u00e2micos h\u00e1 a ocorr\u00eancia de comportamentos c\u00edclicos, nos quais uma ou\nmais vari\u00e1veis de estado apresentam comportamento peri\u00f3dico. Um comportamento de ciclo limite\n\n\n\n2 Trabalho de Conclus\u00e3o de Curso\n\npode ser definido como uma trajet\u00f3ria fechada, n\u00e3o constante das vari\u00e1veis de estado do sistema no\nplano de fase (Khalil, 1996). De maneira geral, a an\u00e1lise de sistemas desse tipo apresenta diversas\ncomplica\u00e7\u00f5es, como por exemplo a n\u00e3o-convexidade de problemas de otimiza\u00e7\u00e3o associados \u00e0\nidentifica\u00e7\u00e3o de modelos(Apio, 2017).\n\nA ocorr\u00eancia de comportamentos que podem ser classificados como ciclos limite pode ser\nobservada em diversos sistemas que ocorrem na natureza, como por exemplo o sistema presa-\npredador descrito pelas equa\u00e7\u00f5es de Lotka-Volterra, no qual ocorrem altern\u00e2ncias entre os tamanhos\ndas popula\u00e7\u00f5es de presas e predadores em um sistema fechado.\n\nAl\u00e9m do comportamento de ciclo limite, tamb\u00e9m \u00e9 verificada a exist\u00eancia de bifurca\u00e7\u00e3o no\nprocesso de extra\u00e7\u00e3o de petr\u00f3leo, isto \u00e9, uma altera\u00e7\u00e3o de comportamento de equil\u00edbrio para um\ncomportamento c\u00edclico do sistema quando h\u00e1 varia\u00e7\u00e3o do ponto de opera\u00e7\u00e3o. Uma das vari\u00e1veis\nque podem ser manipuladas no processo \u00e9 a abertura da v\u00e1lvula choke de produ\u00e7\u00e3o. De acordo com\nGerevini et al., 2017, quando a v\u00e1lvula est\u00e1 com aberturas muito baixas, n\u00e3o ocorrem golfadas, isto\n\u00e9, o fluxo de petr\u00f3leo e g\u00e1s chegando na plataforma \u00e9 praticamente constante. No entanto, a partir\nde uma certa abertura da v\u00e1lvula choke, come\u00e7am a ocorrer oscila\u00e7\u00f5es na vaz\u00e3o, caracterizando\nassim a bifurca\u00e7\u00e3o no processo.\n\nEsses comportamentos s\u00e3o, de maneira geral, indesejados, e a aplica\u00e7\u00e3o de malhas de controle\nautom\u00e1tico pode gerar ganhos econ\u00f4micos consider\u00e1veis no processo. Para muitas aplica\u00e7\u00f5es de\ncontrole \u00e9 importante a obten\u00e7\u00e3o de modelos que descrevam o comportamento do sistema. Esses\nmodelos se dividem em tr\u00eas subtipos b\u00e1sicos: modelos fenomenol\u00f3gicos, em que o sistema \u00e9\ndescrito com seus princ\u00edpios f\u00edsicos fundamentais, chamados caixa branca; modelos com base no\nsistema estudado, mas com simplifica\u00e7\u00f5es de ordem pr\u00e1tica e par\u00e2metros desconhecidos que devem\nser obtidos interagindo com o sistema real, chamados de caixa cinza; e modelos em que as leis\ne princ\u00edpios f\u00edsicos n\u00e3o s\u00e3o levados em conta, apenas o funcionamento geral do processo, sendo\nnecess\u00e1ria uma identifica\u00e7\u00e3o completa dos par\u00e2metros do modelo, chamados assim de caixa preta.\n\n1.1 Objetivo\n\nO objetivo deste trabalho \u00e9 estudar duas metodologias de projeto de controle Internal Model\nControl (IMC), com o intuito de suprimir a ocorr\u00eancia de golfadas em sistemas de extra\u00e7\u00e3o de\npetr\u00f3leo. Para tal foi utilizado um modelo do tipo caixa cinza do processo, descrito por Di Meglio\net al., 2012, como planta a ser controlada. O intuito de estudar essas duas metodologias \u00e9 comparar\nduas abordagens distintas ao sistema com ciclo limite: usar um modelo que apresenta ciclo limite\npor constru\u00e7\u00e3o, sendo ele oscilat\u00f3rio por natureza, ou usar um modelo inst\u00e1vel no entorno de um\nponto de opera\u00e7\u00e3o que apresenta ciclo limite, mesmo que o sistema como um todo n\u00e3o seja inst\u00e1vel.\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 3\n\n2 Revis\u00e3o bibliogr\u00e1fica\n\n2.1 Sistemas de extra\u00e7\u00e3o de petr\u00f3leo offshore\n\nSistemas de extra\u00e7\u00e3o e produ\u00e7\u00e3o de petr\u00f3leo offshore, como os encontrados no pr\u00e9-sal brasileiro,\nconsistem em po\u00e7os de extra\u00e7\u00e3o perfurados no leito marinho, tubula\u00e7\u00f5es de transporte, e plataformas\nque recebem e processam os produtos extra\u00eddos do reservat\u00f3rio. De acordo com Pedersen et al.,\n2017, o sistema de extra\u00e7\u00e3o, do reservat\u00f3rio \u00e0 plataforma, pode ser separado em tr\u00eas subsistemas\nconectados, como pode-se ver na Figura 2:\n\n1. Se\u00e7\u00e3o 1: po\u00e7o de extra\u00e7\u00e3o, no qual compostos gasosos, l\u00edquidos e s\u00f3lidos s\u00e3o extra\u00eddos do\nreservat\u00f3rio abaixo do leito do mar atrav\u00e9s de um po\u00e7o vertical. O po\u00e7o de extra\u00e7\u00e3o de\nsistemas que utilizam a t\u00e9cnica de gas-lift geralmente consiste em dois tubos conc\u00eantricos,\nsendo: o tubo interior por onde fluem os produtos do reservat\u00f3rio, chamado de tubing; e o\ntubo exterior por onde se faz a inje\u00e7\u00e3o de g\u00e1s natural na base do po\u00e7o, chamado de casing.\nEm muitos po\u00e7os existe uma v\u00e1lvula de controle no topo do po\u00e7o chamada topside choke,\nque pode ser utilizada para controlar o fluxo vindo do reservat\u00f3rio.\n\n2. Se\u00e7\u00e3o 2: linha de transporte submarino, tamb\u00e9m chamado de flowline ou pipeline, que em\ngeral consiste na maior extens\u00e3o de tubula\u00e7\u00e3o entre o po\u00e7o de extra\u00e7\u00e3o e a plataforma. Como\nesta tubula\u00e7\u00e3o fica em contato com o leito do mar, que possui irregularidades em seu relevo,\nela sofre inflex\u00f5es, que podem fazer com que ocorram ac\u00famulos localizados do fluxo de\nprodutos.\n\n3. Se\u00e7\u00e3o 3: se\u00e7\u00e3o vertical de tubula\u00e7\u00e3o, chamada de riser, que leva os produtos do flowline at\u00e9 a\nplataforma.\n\nFigura 2: Ilustra\u00e7\u00e3o de um sistema de extra\u00e7\u00e3o t\u00edpico\n\nFonte: Pedersen et al., 2017\n\n\n\n4 Trabalho de Conclus\u00e3o de Curso\n\n2.1.1 Gas-lift\n\nEm po\u00e7os maduros, nos quais a press\u00e3o natural do reservat\u00f3rio n\u00e3o \u00e9 suficiente para garantir a\nprodu\u00e7\u00e3o, ou em po\u00e7os de alta profundidade, nos quais a coluna de l\u00edquido \u00e9 muito grande para ser\nvencida pela press\u00e3o do po\u00e7o, h\u00e1 a necessidade do uso de eleva\u00e7\u00e3o artificial do petr\u00f3leo. Dentre\noutras t\u00e9cnicas de eleva\u00e7\u00e3o, como bombeio hidr\u00e1ulico dos produtos, e inje\u00e7\u00e3o de \u00e1gua para aumento\nda press\u00e3o dos reservat\u00f3rios, destaca-se a t\u00e9cnica de eleva\u00e7\u00e3o chamada de gas-lift.\n\nO gas-lift \u00e9 feito injetando-se g\u00e1s natural (GN), previamente extra\u00eddo do reservat\u00f3rio e separado\nno equipamento de separa\u00e7\u00e3o da plataforma, no po\u00e7o de extra\u00e7\u00e3o. Essa inje\u00e7\u00e3o de g\u00e1s \u00e9 realizada\ncom o intuito de diminuir a densidade do l\u00edquido fluindo verticalmente, e assim facilitar a sua\neleva\u00e7\u00e3o atrav\u00e9s da diminui\u00e7\u00e3o do gradiente de press\u00e3o do ponto de inje\u00e7\u00e3o de g\u00e1s at\u00e9 a plataforma.\nO gas-lift geralmente \u00e9 feito no po\u00e7o de extra\u00e7\u00e3o, conforme a Figura 3, podendo tamb\u00e9m ser feito\nna base do riser (Pedersen et al., 2017).\n\nFigura 3: Diagrama de um po\u00e7o com o uso de gas-lift\n\nFonte: Pedersen et al., 2017\n\nG\u00e1s natural comprimido \u00e9 injetado no po\u00e7o de extra\u00e7\u00e3o atrav\u00e9s da v\u00e1lvula de controle de gas-lift.\nO g\u00e1s entra pelo casing, no qual o fluxo \u00e9 monof\u00e1sico, composto apenas de g\u00e1s. Atrav\u00e9s de uma\nv\u00e1lvula unidirecional, pr\u00f3xima do fundo da tubula\u00e7\u00e3o, o g\u00e1s presente no casing penetra o tubing,\nmisturando-se com o fluxo multif\u00e1sico proveniente do reservat\u00f3rio. Essa inje\u00e7\u00e3o de g\u00e1s tem dois\nefeitos principais:\n\n1. Press\u00e3o de expans\u00e3o do g\u00e1s impulsiona a fase l\u00edquida em dire\u00e7\u00e3o \u00e0 superf\u00edcie;\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 5\n\n2. Cria\u00e7\u00e3o de bolhas de g\u00e1s no meio do l\u00edquido diminui a densidade da mistura multif\u00e1sica,\nfazendo com que a press\u00e3o hidrost\u00e1tica da coluna de produtos acima do ponto de inje\u00e7\u00e3o\ndiminua, facilitando o escoamento.\n\nO uso de gas-lift pode gerar aumentos de produ\u00e7\u00e3o de \u00f3leo e g\u00e1s, que justificam o seu uso, mas\ntamb\u00e9m gera contrapontos operacionais, como aumento da complexidade de controle, dist\u00farbios na\nprodu\u00e7\u00e3o, e o aumento do fen\u00f4meno chamado de golfada.\n\n2.2 Comportamento din\u00e2mico de sistemas com gas-lift: golfadas, bifurca\u00e7\u00e3o\n\nO fluxo multif\u00e1sico proveniente do po\u00e7o de extra\u00e7\u00e3o pode tomar diversas formas no interior\ndas tubula\u00e7\u00f5es, dependendo das caracter\u00edsticas de temperatura, press\u00e3o, velocidade de escoamento,\ndisposi\u00e7\u00e3o f\u00edsica das tubula\u00e7\u00f5es, entre outros fatores. Taitel et al 1980 descreve diversos tipos de\nescoamento, mostrados na Figura 4.\n\nFigura 4: Tipos de escoamento multif\u00e1sico.\n\nFonte: Adaptado de Taitel et al., 1980\n\nDentre os formatos poss\u00edveis de fluxo multif\u00e1sico, destaca-se o regime de golfada, no qual\ngrandes volumes de g\u00e1s fluem de maneira isolada da fase l\u00edquida (Biltoft et al., 2013). A Figura 5\nmostra dados reais de press\u00e3o de fundo e de topo de um po\u00e7o localizado no Mar do Norte, ilustrando\no comportamento c\u00edclico das golfadas.\n\nO regime de golfadas pode causar diversos problemas operacionais, como:\n\n\u2022 altas press\u00f5es, e possivelmente excesso de l\u00edquidos nos separadores;\n\n\n\n6 Trabalho de Conclus\u00e3o de Curso\n\nFigura 5: Dados reais de press\u00e3o de um po\u00e7o no Mar do Norte. O gr\u00e1fico mostra as press\u00f5es no\ntopo e no fundo do po\u00e7o em regime golfante.\n\nFonte: Adaptado de Pedersen et al., 2017\n\n\u2022 alta press\u00e3o nos compressores;\n\n\u2022 fadiga nos equipamentos e tubula\u00e7\u00f5es, devido \u00e0s constantes oscila\u00e7\u00f5es de press\u00e3o de alta\namplitude;\n\n\u2022 diminui\u00e7\u00e3o de produ\u00e7\u00e3o, devido \u00e0s restri\u00e7\u00f5es de seguran\u00e7a impostas pelos operadores sobre\nos picos de press\u00e3o;\n\n\u2022 perda de produtos por uso de flare em caso de excesso de g\u00e1s.\n\nDentre os fatores citados, o de maior impacto \u00e9 a diminui\u00e7\u00e3o de produ\u00e7\u00e3o, que ocorre pelo valor\nm\u00e9dio da produ\u00e7\u00e3o no regime de golfadas ser menor do que em um regime est\u00e1vel correspondente.\nEste fato pode ser observado no diagrama de bifurca\u00e7\u00e3o do processo, na Figura 6. Para aberturas da\nv\u00e1lvula de produ\u00e7\u00e3o acima do ponto de bifurca\u00e7\u00e3o, o sistema apresenta comportamento oscilat\u00f3rio\n\nA diminui\u00e7\u00e3o da produ\u00e7\u00e3o tamb\u00e9m \u00e9 decorrente do fato de que muitas vezes os po\u00e7os s\u00e3o\noperados em uma faixa de abertura suficientemente baixa das v\u00e1lvulas de controle de produ\u00e7\u00e3o, que\nsuprima o regime oscilat\u00f3rio das golfadas. Esta faixa de opera\u00e7\u00e3o \u00e9 a mostrada na parte esquerda da\nFigura 6.\n\nUm poss\u00edvel mecanismo de golfada, quando esta ocorre devido \u00e0 inflex\u00e3o existente da base do\nriser, pode ser visto na Figura 7.\n\nInicialmente forma-se um bloqueio de l\u00edquido na inflex\u00e3o da tubula\u00e7\u00e3o(1), fazendo com que o\ng\u00e1s n\u00e3o avance, e comece a se acumular na base do riser, aumentando sua press\u00e3o. \u00c0 medida que a\nfase l\u00edquida avan\u00e7a pela tubula\u00e7\u00e3o, e a press\u00e3o de g\u00e1s aumenta, tamb\u00e9m aumenta a coluna de l\u00edquido\nna se\u00e7\u00e3o vertical do riser, aumentando a press\u00e3o hidrost\u00e1tica na base(2). Quando uma quantidade\nsuficiente de g\u00e1s se acumulou, de modo que a press\u00e3o de g\u00e1s seja maior do que a necess\u00e1ria para\nmover a coluna de l\u00edquido, o l\u00edquido escoa rapidamente para fora do riser(3). Com a tubula\u00e7\u00e3o livre,\no g\u00e1s pressurizado tamb\u00e9m escoa para fora do riser(4), permitindo que a fase l\u00edquida novamente se\nacumule na base, reiniciando o ciclo da golfada (Pedersen et al., 2017).\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 7\n\nFigura 6: Diagrama de bifurca\u00e7\u00e3o mostrando o impacto da golfada na taxa de produ\u00e7\u00e3o.\n\nFonte: Gerevini, 2017\n\nOutro poss\u00edvel mecanismo de golfada \u00e9 o de casing-heading, que ocorre no po\u00e7o de extra\u00e7\u00e3o.\nNesse tipo de golfada, \u00e0 medida que o g\u00e1s de eleva\u00e7\u00e3o \u00e9 injetado na coluna de produ\u00e7\u00e3o, a press\u00e3o\nna mesma diminui. Com a diminui\u00e7\u00e3o da press\u00e3o da coluna de fluido no po\u00e7o, a taxa de descarga\nde g\u00e1s do casing para a coluna de produ\u00e7\u00e3o aumenta, diminuindo assim a press\u00e3o de g\u00e1s no casing.\n\u00c0 medida que o g\u00e1s do casing \u00e9 descarregado, sua press\u00e3o baixa, diminuindo a taxa de descarga,\nculminando numa diminui\u00e7\u00e3o do fluxo de produtos saindo do po\u00e7o.\n\n2.3 Controle de produ\u00e7\u00e3o\n\nDe acordo com Pedersen et al., 2017, de modo a operar em um regime livre de golfadas, podem\nser utilizadas diversas t\u00e9cnicas, incluindo:\n\n\u2022 elimina\u00e7\u00e3o passiva: mantendo as v\u00e1lvulas de controle de produ\u00e7\u00e3o, chamadas de choke\npermanentemente em aberturas baixas, operando assim \u00e0 esquerda do ponto de bifurca\u00e7\u00e3o,\nem um regime de baixa produ\u00e7\u00e3o mas livre de golfadas;\n\n\u2022 elimina\u00e7\u00e3o passiva: com implementos nas tubula\u00e7\u00f5es, como homogeneizadores de fluxo,\ntubula\u00e7\u00f5es helicoidais, entre outros, que servem para alterar a disposi\u00e7\u00e3o f\u00edsica do fluxo\nmultif\u00e1sico no interior da tubula\u00e7\u00e3o;\n\n\u2022 elimina\u00e7\u00e3o passiva: slug catchers, s\u00e3o os dispositivos mais comuns para elimina\u00e7\u00e3o passiva\nde golfadas, funcionando como tanques buffer no processo. Localizados no topo dos po\u00e7os,\ns\u00e3o uma op\u00e7\u00e3o cara, pois requerem m\u00faltiplas tubula\u00e7\u00f5es submarinas, e sua manuten\u00e7\u00e3o \u00e9\ndif\u00edcil;\n\n\u2022 elimina\u00e7\u00e3o ativa: controlando a vaz\u00e3o de gas-lift;\n\n\n\n8 Trabalho de Conclus\u00e3o de Curso\n\nFigura 7: Ciclo de golfadas severas ocasionadas pela inflex\u00e3o do riser\n\nFonte: Biltoft et al., 2013\n\n\u2022 elimina\u00e7\u00e3o ativa: controlando a abertura de v\u00e1lvulas de controle de produ\u00e7\u00e3o.\n\nComo o objetivo principal deste trabalho \u00e9 estudar estrat\u00e9gias de controle autom\u00e1tico, somente\nestas ser\u00e3o apresentadas.\n\n2.3.1 Controle ativo\n\nDuas principais vari\u00e1veis s\u00e3o estudadas como vari\u00e1veis manipuladas do sistema de controle\nautom\u00e1tico do escoamento: a abertura de v\u00e1lvulas choke e a altera\u00e7\u00e3o da taxa de inje\u00e7\u00e3o de g\u00e1s\nde eleva\u00e7\u00e3o. Com maiores taxas de inje\u00e7\u00e3o de g\u00e1s de eleva\u00e7\u00e3o, pode-se mais facilmente alcan\u00e7ar\nregimes de escoamento livres de golfadas, ao custo de maior uso dos compressores. Assim, a op\u00e7\u00e3o\nmenos custosa \u00e9 a de controlar v\u00e1lvulas choke (Pedersen et al., 2017).\n\nStorkaas e Skogestad, 2007 estudaram a controlabilidade de sistemas pipeline-riser com rela\u00e7\u00e3o\n\u00e0s medi\u00e7\u00f5es dispon\u00edveis, e identificaram que o desempenho de controladores \u00e9 piorado com\nmedi\u00e7\u00f5es de press\u00e3o de topo \u00e0 medida que a frequ\u00eancia das golfadas aumenta, sendo assim mais\nindicado utilizar medi\u00e7\u00f5es de press\u00e3o em pontos inferiores do sistema, mais pr\u00f3ximas ao po\u00e7o.\nComo nem sempre h\u00e1 disponibilidade de sensores em pontos inferiores do sistema, por dificuldades\nde manuten\u00e7\u00e3o e custo elevado, diversos estudos, como o de Barbosa et al., 2015, desenvolveram\nestrat\u00e9gias de estima\u00e7\u00e3o da press\u00e3o da parte inferior do sistema, com o objetivo de utiliz\u00e1-la para\ncontrole.\n\nEstrat\u00e9gias de controle linear, utilizando controle PID, foram desenvolvidas e testadas para\nevitar a ocorr\u00eancia de golfadas, como Sivertsen et al., 2010, que estudaram a elimina\u00e7\u00e3o de golfadas\npor casing-heading, e Di Meglio et al., 2012 e Jahanshahi et al., 2014, que estudaram a elimina\u00e7\u00e3o\nda golfada causada pela ondula\u00e7\u00e3o do riser.\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 9\n\nComo sistemas de extra\u00e7\u00e3o de \u00f3leo e g\u00e1s apresentam comportamentos altamente n\u00e3o-lineares,\npode-se tamb\u00e9m utilizar estrat\u00e9gias de controle n\u00e3o linear. Hussein et al., 2015 propuseram uma\nestrat\u00e9gia de gain-scheduling, onde o controlador \u00e9 reparametrizado de acordo com a regi\u00e3o de\nopera\u00e7\u00e3o, em combina\u00e7\u00e3o com um teste do tipo rel\u00e9 para identificar um modelo linear do sistema.\nGerevini, 2017 estudou a utiliza\u00e7\u00e3o de controle preditivo n\u00e3o-linear para atenua\u00e7\u00e3o de golfadas,\nutilizando como modelo n\u00e3o-linear o modelo Fast Offshore Wells Model (FOWM), desenvolvido\npor Diehl et al., 2017.\n\nDe maneira mais pr\u00f3xima \u00e0 abordagem deste trabalho, em Jahanshahi et al., 2014 e Jahanshahi\net al., 2015 foram realizadas compara\u00e7\u00f5es entre o desempenho do controle baseado no projeto IMC\ncom outras t\u00e9cnicas, como o projeto de controladores PIDF-\u00f3timos, baseados na minimiza\u00e7\u00e3o de\numa fun\u00e7\u00e3o custo, controle robusto do tipo loop-shaping baseado na norma H?, controle n\u00e3o-linear\nbaseado em lineariza\u00e7\u00e3o por realimenta\u00e7\u00e3o, entre outros. O projeto IMC se destacou por apresentar\nresultados muito bons, apresentando performance t\u00e3o robusta quanto o controlador loop-shaping\nH?, com a vantagem de que o projeto \u00e9 consideravelmente mais f\u00e1cil de ser realizado.\n\n2.4 Projeto de controle pelo m\u00e9todo IMC\n\nA estrutura de controle IMC(Internal Model Control) e o projeto de controladores IMC foi\ninicialmente descrito por Garcia e Morari, 1982. Como o nome indica, \u00e9 utilizado um modelo do\nprocesso como parte integrante do controlador. Ao se utilizar a estrutura IMC, a complexidade\ndo controlador depende exclusivamente de dois fatores: a complexidade do modelo utilizado, e as\nespecifica\u00e7\u00f5es de desempenho em malha fechada (Rivera et al., 1986).\n\nO controle IMC se baseia inicialmente na ideia de que se possui um modelo perfeito do processo\na ser controlado. Se colocamos em s\u00e9rie uma planta G um controlador Gc = G?1, em malha aberta,\ncomo na Figura 8, considerando aus\u00eancia de ru\u00eddo, pode-se esperar que a sa\u00edda seja exatamente\nigual \u00e0 entrada.\n\nFigura 8: Sistema em malha aberta, no qual h\u00e1 seguimento de refer\u00eancia perfeito\n\nNo entanto, este sistema \u00e9 suscet\u00edvel a ru\u00eddos, e outros dist\u00farbios n\u00e3o medidos, e baseia-se\nfortemente no fato de que G \u00e9 um modelo perfeito do processo, o que n\u00e3o existe na realidade. Al\u00e9m\ndisso caso G seja uma fun\u00e7\u00e3o de transfer\u00eancia pr\u00f3pria, Gc n\u00e3o o ser\u00e1. O uso da estrutura IMC, que\npode ser observada na Figura 9, soluciona esses problemas.\n\nNesta estrutura utiliza-se um modelo G(s) da planta a ser controlada, que pode apresentar erros\nde modelagem.\n\n\u00c9 tamb\u00e9m necess\u00e1ria a inclus\u00e3o de um um elemento f (s) na malha, de modo a fazer com que\no controlador Gc(s) = f (s)Q(s) seja pr\u00f3prio e causal. Al\u00e9m disso, esse filtro tem como fun\u00e7\u00e3o\n\n\n\n10 Trabalho de Conclus\u00e3o de Curso\n\nFigura 9: Estrutura IMC\n\ndeterminar o equil\u00edbrio entre robustez e desempenho. O procedimento tradicional de projeto IMC,\nconforme descrito em Morari e Zafiriou, 1989 consiste em:\n\n1. Fatorizar a planta G(s) = G+(s)G?(s), no qual G+(s) cont\u00e9m todos os zeros de fase n\u00e3o\nm\u00ednima e atrasos;\n\n2. Alternativamente, fatorizar G(s) = G+(s)G?(s), onde G?(s) \u00e9 um filtro do tipo all-pass com o\nzero de fase n\u00e3o-m\u00ednima ? da planta:\n\nG+(s) =\n??s + 1\n?s + 1\n\n, (1)\n\ne em G?(s) \u00e9 adicionada a reflex\u00e3o pelo eixo imagin\u00e1rio desse zero de fase n\u00e3o-m\u00ednima;\n\n3. Nessa fatoriza\u00e7\u00e3o, garantir que G+(0) = 1, de modo a respeitar o seguimento de refer\u00eancia\ncom erro nulo;\n\n4. Fazer Q(s) = G?(s)?1;\n\n5. Projetar o filtro f (s), garantindo que f (0) = 1, do modo a a respeitar o seguimento de\nrefer\u00eancia com erro nulo.\n\nA escolha mais usual para a estrutura do filtro f (s) que faz com que Gc(s) seja pr\u00f3prio e causal\n\u00e9:\n\nf (s) =\n1\n\n(?s + 1)n\n, (2)\n\nonde ? \u00e9 a constante de tempo desejada para o sistema em malha fechada, e \u00e9 par\u00e2metro de escolha\ndo projetista. O \u00edndice n indica a ordem do filtro, e deve ser escolhido de modo a fazer com que\nGc(s) seja pr\u00f3prio, isto \u00e9, tenha o n\u00famero de zeros igual ao de polos, ou estritamente pr\u00f3prio, isto \u00e9,\no n\u00famero de zeros menor que o de polos.\n\nNormalmente escolhe-se ? da mesma ordem de grandeza da constante de tempo do sistema em\nmalha aberta. De maneira mais geral:\n\n? ? ? ? ?, (3)\nonde ? \u00e9 um poss\u00edvel atraso de transporte do sistema e ? \u00e9 a constante de tempo dominante do\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 11\n\nsistema. O valor de ? determina o balan\u00e7o entre robustez e desempenho desejados do sistema em\nmalha fechada, sendo que valores mais baixos fazem com que o desempenho seja melhor, mas a\nrobustez menor, e valores maiores aumentam a robustez, mas diminuem o desempenho(Morari e\nZafiriou, 1989).\n\nDe modo a projetar controladores PID, que s\u00e3o os mais comumente dispon\u00edveis em equipamentos\nindustriais, numa estrutura de feedback tradicional, \u00e9 poss\u00edvel converter a estrutura IMC na estrutura\ntradicional, fazendo:\n\nC(s) =\nGc(s)\n\n1 ? G(s)Gc(s)\n. (4)\n\n2.5 Aplica\u00e7\u00e3o de controle IMC anti-golfadas - Jahanshahi, 2013\n\nJahanshahi e Skogestad, 2013 estudaram o uso de uma estrutura IMC(Internal Model Control)\npara realizar o controle de golfadas, baseando-se em um modelo inst\u00e1vel linearizado a partir do\nmodelo de fenomenol\u00f3gico desenvolvido em Jahanshahi e Skogestad, 2011. O sistema modelado\npode ser observado na Figura 10.\n\nFigura 10: Sistema de riser com um ponto baixo modelado por Jahanshahi e Skogestad, 2011.\n\nFonte: Jahanshahi e Skogestad, 2011\n\nO modelo fenomenol\u00f3gico consiste em balan\u00e7os de massa das fases gasosa e l\u00edquida presentes\nno sistema pipeline-riser para modelar golfadas severas. A partir de uma lineariza\u00e7\u00e3o do sistema,\nJahanshahi e Skogestad, 2013 obtiveram um modelo linear de quarta ordem na forma\n\nG(s) =\n?1(s + ?2)(s + ?3)\n\n(s2 ? ?4 s + ?5)(s2 + ?6 s + ?7)\n, (5)\n\nrelacionando a press\u00e3o no topo do riser, Prt, com a abertura da v\u00e1lvula choke de sa\u00edda, Z. Este\nmodelo possui dois polos inst\u00e1veis, dois polos est\u00e1veis e dois zeros, totalizando sete par\u00e2metros que\n\n\n\n12 Trabalho de Conclus\u00e3o de Curso\n\ndevem ser estimados para identific\u00e1-lo.\n\nAnalisando os valores singulares de Hankel do sistema, que determinam, atrav\u00e9s de uma medida\nde energia dos estados, quais s\u00e3o as din\u00e2micas mais importantes do sistema, Jahanshahi e Skogestad,\n2013 conclu\u00edram que a din\u00e2mica dos polos est\u00e1veis \u00e9 negligenci\u00e1vel, chegando-se a um modelo\ninst\u00e1vel de segunda ordem, conforme a Equa\u00e7\u00e3o 6, com dois p\u00f3los inst\u00e1veis e um zero est\u00e1vel, que\n\u00e9 suficiente para realizar o projeto de controladores.\n\nG(s) =\nb1 s + b0\n\ns2 ? a1 s + a0\n=\n\nk(s + z)\n(s ? p1)(s ? p2)\n\n(6)\n\nCom a1 > 0 e a0 > 0. Deve-se salientar que o comportamento global do sistema n\u00e3o \u00e9 inst\u00e1vel,\nmesmo quando opera em uma condi\u00e7\u00e3o que apresenta ciclo limite, e que o modelo inst\u00e1vel obtido\n\u00e9 uma representa\u00e7\u00e3o das din\u00e2micas mais importantes no ponto de opera\u00e7\u00e3o no entorno do qual o\nmodelo \u00e9 obtido.\n\nComo este modelo \u00e9 inst\u00e1vel, de modo a realizar a identifica\u00e7\u00e3o do sistema, ele foi colocado em\nmalha fechada com um controlador P de ganho Kc0 que o estabilizasse, tornando assim a fun\u00e7\u00e3o de\ntransfer\u00eancia que relaciona o setpoint ys com a resposta do sistema y:\n\ny(s)\nys(s)\n\n=\nKc0(b1 s + b0)\n\ns2 + (?a1 + Kc0b1)s + (a0 + Kc0b0)\n. (7)\n\nRealizando um ensaio com o sistema nesta forma, identifica-se ent\u00e3o seis par\u00e2metros(?yp, ?yu,\n?ys, ?y?, tp e tu) na resposta temporal do sistema, conforme a Figura 11, e calcula-se os par\u00e2metros\ndo sistema em malha fechada na forma da Equa\u00e7\u00e3o 7.\n\nO c\u00e1lculo dos par\u00e2metros do sistema em malha fechada \u00e9 baseado no fato de que ele apresenta\ncomportamento subamortecido, e \u00e9 utilizado um equacionamento baseado na transformada de\nLaplace inversa de sistemas subamortecidos da forma da Equa\u00e7\u00e3o 7. Com os par\u00e2metros do sistema\nem malha fechada, e com o valor do ganho proporcional Kc0 utilizado, calcula-se os par\u00e2metros do\nmodelo inst\u00e1vel da Equa\u00e7\u00e3o 6.\n\nO procedimento utilizado, baseado no equacionamento descrito em Jahanshahi e Skogestad,\n2013, e implementado em um script no software MATLAB, est\u00e1 dispon\u00edvel no Ap\u00eandice A.\n\nO modelo identificado \u00e9 v\u00e1lido no entorno do ponto de opera\u00e7\u00e3o no qual foi realizado o\nexperimento. De posse do modelo, Jahanshahi e Skogestad, 2013 implementou controladores IMC\nde acordo com o procedimento descrito por Morari e Zafiriou, 1989 para plantas inst\u00e1veis. O projeto\ndo controlador IMC utilizado difere do procedimento tradicional apenas na determina\u00e7\u00e3o da ordem\ndo filtro f (s), e na sua forma. A inversa Q(s) da planta da Equa\u00e7\u00e3o 6, e o filtro projetado s\u00e3o da\nforma\n\nQ(s) =\n(s ? p1)(s ? p2)\n\nk(s + z)\n, (8)\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 13\n\nFigura 11: Ensaio em malha fechada com controlador P de ganho Kc0, usado para identificar o\nmodelo.\n\nFonte: Jahanshahi e Skogestad, 2013\n\nf (s) =\n?2 s2 + ?1 s + ?0\n\n(?s + 1)3\n, (9)\n\nna qual os par\u00e2metros ?2,?1 s e ?0 s\u00e3o determinados de modo a respeitar a condi\u00e7\u00e3o de que f (0) = 1,\nfazendo assim com que ?0 = 1, e tamb\u00e9m que f (s)|s=p1,p2 = 1 (Morari e Zafiriou, 1989).\n\nAl\u00e9m disso, \u00e9 importante ressaltar que para plantas inst\u00e1veis n\u00e3o \u00e9 poss\u00edvel utilizar a estrutura\nIMC, sendo necess\u00e1ria a convers\u00e3o do controlador IMC projetado para a estrutura de feedback\ntradicional, como na Equa\u00e7\u00e3o 4. Assim, o controlador projetado \u00e9:\n\nC(s) =\n1\n\nk?3\n(?2 s2 + ?1 s + ?0)\n\ns(s + z)\n. (10)\n\n\n\n14 Trabalho de Conclus\u00e3o de Curso\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 15\n\n3 Metodologia\n\nA metodologia utilizada neste trabalho consiste na utiliza\u00e7\u00e3o de um modelo baseado em\nprinc\u00edpios f\u00edsicos do sistema, desenvolvido por Di Meglio et al., 2009, como planta a ser controlada.\nInicialmente \u00e9 apresentado na Se\u00e7\u00e3o 3.1 o equacionamento do modelo, incluindo considera\u00e7\u00f5es\nsobre a modelagem utilizada. Este modelo \u00e9 baseado em balan\u00e7os de massa, e apresenta n\u00e3o-\nlinearidades, o que dificulta o projeto de sistemas de controle.\n\nCom o intuito de facilitar o projeto de controladores e estruturas de controle, \u00e9 apresentado um\nmodelo linear simplificado na Se\u00e7\u00e3o 3.2. Este modelo tem como objetivo ser representativo para\ndiversos tipos de golfadas, e diversas configura\u00e7\u00f5es f\u00edsicas de sistemas de extra\u00e7\u00e3o.\n\nCom o modelo simplificado identificado, foi utilizado o projeto de controladores IMC, descrito\nna Se\u00e7\u00e3o 2.4, para projetar controladores que pudessem eliminar o comportamento oscilat\u00f3rio das\ngolfadas para aberturas de v\u00e1lvula maiores do que a abertura correspondente ao ponto de bifurca\u00e7\u00e3o\ndo sistema em malha aberta.\n\nAl\u00e9m disso, foi aplicada a metodologia de projeto de controladores IMC desenvolvida por\nJahanshahi e Skogestad, 2013, e descrita na Se\u00e7\u00e3o 2.5. Nessa metodologia, \u00e9 identificado um\nmodelo localmente inst\u00e1vel do sistema em um ponto de opera\u00e7\u00e3o que apresenta ciclo limite. Esse\nmodelo \u00e9 utilizado para projetar um controlador IMC est\u00e1vel, que por sua vez \u00e9 aplicado para\ncontrolar o sistema de Di Meglio et al., 2009.\n\nOs resultados obtidos a partir das duas metodologias de projeto de controladores apresentadas,\numa baseada em um modelo est\u00e1vel, que apresenta comportamento de ciclo limite por constru\u00e7\u00e3o\ndo modelo, e outra baseada em um modelo inst\u00e1vel quando linearizado em um ponto de opera\u00e7\u00e3o\nque apresenta ciclo limite, s\u00e3o comparadas ao final do trabalho.\n\n3.1 Modelo utilizado como planta a ser controlada - Di Meglio, 2009\n\nDi Meglio et al., 2009 propuseram um modelo baseado em um balan\u00e7o de massa simplificado,\nque considera uma separa\u00e7\u00e3o do escoamento multif\u00e1sico na base do riser em tr\u00eas volumes de\ncontrole distintos, dois dos quais s\u00e3o compostos por g\u00e1s,e o outro composto por l\u00edquido. Essa\nsepara\u00e7\u00e3o tem como base a hip\u00f3tese de que h\u00e1 uma interface de l\u00edquido em algum ponto do riser, a\nqual \u00e9 modelada por uma v\u00e1lvula virtual. A forma\u00e7\u00e3o dessa interface leva a um ac\u00famulo de g\u00e1s\na montante, em uma bolha alongada, fazendo com que ocorra aumento de press\u00e3o, o que leva a\ninstabilidades no escoamento.\n\nA hip\u00f3tese da v\u00e1lvula virtual \u00e9 valida para inflex\u00f5es na tubula\u00e7\u00e3o, e quando as velocidades de\nescoamento do fluxo multif\u00e1sico s\u00e3o baixas. O diagrama do sistema modelado pode ser visto na\nFigura 12.\n\nNo modelo as vaz\u00f5es de entrada no sistema das fases l\u00edquida e gasosa, wg,in e wl,in, respectiva-\n\n\n\n16 Trabalho de Conclus\u00e3o de Curso\n\nFigura 12: Diagrama do riser modelado, ilustrando o princ\u00edpio da v\u00e1lvula virtual\n\nFonte: Adaptado de Di Meglio et al., 2009\n\nmente, s\u00e3o consideradas constantes. As equa\u00e7\u00f5es de balan\u00e7o de massa utilizadas s\u00e3o as seguintes:\n\nm?g,eb(t) = (1 ? ?)wg,in ? wg(t) (11)\nm?g,r(t) = ?wg,in + wg(t) ? wg,out(t) (12)\n\nm?l,r(t) = wl,in ? wl,out(t) (13)\n\nNesses balan\u00e7os de massa, m?g,eb(t), m?g,r(t) s\u00e3o, respectivamente, as taxas m\u00e1ssicas de ac\u00famulo\nde g\u00e1s na bolha e no riser, e m?l,r(t) \u00e9 a taxa m\u00e1ssica de ac\u00famulo de l\u00edquido no riser. \u00c9 utilizado um\npar\u00e2metro de ajuste fixo do modelo, ?, que determina a fra\u00e7\u00e3o que passa diretamente para o volume\nde controle de sa\u00edda, e a fra\u00e7\u00e3o de g\u00e1s que penetra diretamente a bolha alongada, de volume Veb. Os\nfluxos de sa\u00edda de g\u00e1s e l\u00edquido s\u00e3o dados por:\n\nwl,out ? wout (14)\n\nwg,out ?\nmg,r\nml,r\n\nwout (15)\n\n\u00c9 utilizada uma equa\u00e7\u00e3o de v\u00e1lvula linear para descrever a inje\u00e7\u00e3o de g\u00e1s da bolha para o\nvolume de controle da sa\u00edda:\n\nwg = Cg( peb ? pr,b), (16)\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 17\n\nem que peb e pr,b s\u00e3o as press\u00f5es da bolha, e da parte inferior do riser, respectivamente, e Cg \u00e9 a\nconstante da v\u00e1lvula virtual, que \u00e9 um dos par\u00e2metros de ajuste do modelo. O fluxo de sa\u00edda \u00e9 dado\npor\n\nwout = Kvz\n?\n?( pr,t ? ps), (17)\n\nonde Kv \u00e9 a constante caracter\u00edstica da v\u00e1lvula choke de sa\u00edda, z \u00e9 a abertura da v\u00e1lvula, de 0 a 1, ?\n\u00e9 a densidade do l\u00edquido, que \u00e9 considerada dominante, e portanto \u00e9 aproximada como a densidade\ndos produtos na sa\u00edda, pr,t \u00e9 a press\u00e3o no topo do riser, e ps \u00e9 a press\u00e3o do separador, ap\u00f3s os\nprodutos sa\u00edrem da v\u00e1lvula choke de sa\u00edda. Em ambas equa\u00e7\u00f5es de v\u00e1lvula, \u00e9 modelado que n\u00e3o h\u00e1\nfluxo inverso, isto \u00e9, se a press\u00e3o \u00e0 jusante \u00e9 maior que a press\u00e3o \u00e0 montante, n\u00e3o h\u00e1 fluxo atrav\u00e9s\nda v\u00e1lvula.\n\nAs press\u00f5es do sistema s\u00e3o dadas pela lei de gases ideais. O volume da bolha alongada, Veb, \u00e9\nconsiderado constante, e assim:\n\npeb =\nmg,ebRTt\nMgVeb\n\n, (18)\n\nonde R \u00e9 a constante universal dos gases, Tt \u00e9 a temperatura no riser, e Mg a massa espec\u00edfica do\ng\u00e1s. O g\u00e1s a jusante da v\u00e1lvula virtual \u00e9 considerado compress\u00edvel. O volume de g\u00e1s ap\u00f3s a v\u00e1lvula,\nVg,r, \u00e9 dado por\n\nVg,r = Vr ?\nml,r + ml,still\n\n?\n, (19)\n\nna qual ml,still \u00e9 o volume m\u00ednimo de l\u00edquido no sistema em todos os momentos, e Vr \u00e9 o volume\ndo riser,\n\nVr =\nLt?D2t\n\n4\n, (20)\n\nonde Lt \u00e9 o comprimento da tubula\u00e7\u00e3o, e Dt \u00e9 o di\u00e2metro da tubula\u00e7\u00e3o. A press\u00e3o no topo do\nriser, antes da v\u00e1lvula choke de sa\u00edda, \u00e9 dada por\n\npr,t =\nmg,rRTt\nMgVg,r\n\n. (21)\n\nA press\u00e3o na base do riser, a jusante da v\u00e1lvula virtual \u00e9 ent\u00e3o dada pela soma da press\u00e3o no\ntopo do riser com a press\u00e3o da coluna de l\u00edquido,\n\npr,b = pr,t +\nml,rgsen(?)\n\nS bh\n, (22)\n\nonde g \u00e9 a constante gravitacional, ? \u00e9 a inclina\u00e7\u00e3o m\u00e9dia do riser, e S bh \u00e9 a \u00e1rea de se\u00e7\u00e3o da\n\n\n\n18 Trabalho de Conclus\u00e3o de Curso\n\ntubula\u00e7\u00e3o.\n\nNo total, s\u00e3o utilizados quatro par\u00e2metros de ajuste do modelo, ?, Veb, Cg e mL,still de modo\na adequ\u00e1-lo \u00e0s caracter\u00edsticas do sistema de extra\u00e7\u00e3o estudado. Estes valores s\u00e3o considerados\npar\u00e2metros de ajuste pois n\u00e3o refletem diretamente valores f\u00edsicos do sistema, sendo abstra\u00e7\u00f5es de\ncomportamentos observados em opera\u00e7\u00e3o, e podem ser determinados experimentalmente, como em\nDi Meglio et al., 2010. No caso deste trabalho, foram utilizados os mesmos valores de par\u00e2metros\nf\u00edsicos e par\u00e2metros de ajuste utilizados no trabalho original de Di Meglio et al., 2010, conforme a\nTabela 1.\n\nTabela 1: Par\u00e2metros do modelo de Di Meglio et al., 2009\n\nVari\u00e1vel Descri\u00e7\u00e3o Valor Unidade\nDt Di\u00e2metro da tubula\u00e7\u00e3o 0, 78 m\n? fator de inje\u00e7\u00e3o de g\u00e1s no riser 0, 15 ?\ng gravidade 9, 81 ms?2\n\nCg contante da v\u00e1lvula virtual 0, 0001 ms\nKv contante da v\u00e1lvula choke de sa\u00edda 0,0028 m2\n\nLt comprimento da tubula\u00e7\u00e3o 5200 m\nMg massa espec\u00edfica do g\u00e1s 0, 022 kgmol?1\n\nml,still massa m\u00ednima de l\u00edquido na coluna de produ\u00e7\u00e3o 37300 kg\nPs press\u00e3o de sa\u00edda 660000 Pa\nR contante universal dos gases 8, 314 Jmol?1 K?1\n\n? densidade do l\u00edquido 900 kgm?3\n\nS bh \u00e1rea de se\u00e7\u00e3o 0, 0177 m2\n\n? angula\u00e7\u00e3o da tubula\u00e7\u00e3o ?/4 rad\nTt temperatura no riser 363 K\nVeb volume da bolha alongada 48 m3\n\nwg,in taxa de inje\u00e7\u00e3o de g\u00e1s no sistema 0, 8 kgs?1\n\nwl,in taxa de inje\u00e7\u00e3o de l\u00edquido no sistema 11, 75 kgs?1\n\nNeste trabalho foi utilizada uma implementa\u00e7\u00e3o do modelo de Di Meglio et al., 2009 realizada\npor Gerevini, 2014, baseada em uma s-function do MATLAB/Simulink, simulada atrav\u00e9s do integrador\nODE45.\n\n\u00c9 importante observar que as vaz\u00f5es de entrada do sistema no modelo s\u00e3o consideradas constan-\ntes, e portanto a sa\u00edda em regime permanente tamb\u00e9m \u00e9 constante. Assim, n\u00e3o \u00e9 poss\u00edvel observar\nna sa\u00edda aumentos de vaz\u00e3o de produtos ao aumentar a abertura da v\u00e1lvula de produ\u00e7\u00e3o. Outros\nmodelos mais complexos, como o de Diehl et al., 2017 consideram a vaz\u00e3o de entrada dependente da\npress\u00e3o, podendo assim caracterizar aumentos de produtividade mensur\u00e1veis para maiores aberturas\nda v\u00e1lvula de sa\u00edda. No entanto, de acordo com Di Meglio et al., 2009, a din\u00e2mica modelada \u00e9\nsuficiente para explicar a ocorr\u00eancia das golfadas, e se estas forem eliminadas para maiores aberturas\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 19\n\nde v\u00e1lvula, isto \u00e9, se o ponto de bifurca\u00e7\u00e3o do sistema for levado para maiores aberturas de v\u00e1lvula,\na produ\u00e7\u00e3o em um sistema real aumentaria.\n\nPara os ensaios em malha fechada utilizou-se uma estrutura de realimenta\u00e7\u00e3o como a da Figura\n13.\n\nFigura 13: Malha de feedback utilizada.\n\nFonte: Gerevini, 2014\n\n3.2 Vis\u00e3o Geral do modelo simplificado proposto\n\nCom o intuito de obter um modelo linear que represente o comportamento din\u00e2mico da golfada,\nque seja representativo para suas diversas formas, em diversas vari\u00e1veis mensuradas, e a partir do\nqual se possa estabelecer estrat\u00e9gias de controle, prop\u00f5e-se um modelo linear simplificado.\n\nO modelo \u00e9 composto por duas fun\u00e7\u00f5es de transfer\u00eancia em paralelo. Uma das fun\u00e7\u00f5es de\ntransfer\u00eancia, G1(s), tem o intuito de caracterizar o comportamento transiente ap\u00f3s uma mudan\u00e7a\nde valor da vari\u00e1vel manipulada. A segunda fun\u00e7\u00e3o de transfer\u00eancia, G2(s), \u00e9 respons\u00e1vel por\nrepresentar o comportamento de ciclo-limite, ap\u00f3s o per\u00edodo transiente, caracter\u00edstico da golfada.\n\nG1(s) =\nK1(?s + 1)\n\n(T1 s2 + 2T1?s + 1)(T2 s + 1)\n(23)\n\nG2(s) =\nA(sin (?)s + cos (?)?)s\n\n(s2 + ?2)(T3 s + 1)\n(24)\n\nA presen\u00e7a das din\u00e2micas de G1(s) e G2(s) tem o objetivo de fazer com que o modelo seja\ngen\u00e9rico o suficiente para se adequar a diversos sistemas diferentes, que podem apresentar diversos\nmecanismos de ocorr\u00eancia de golfadas. Colocando-se essas duas fun\u00e7\u00f5es de transfer\u00eancia em\nparalelo, como na Figura 14, temos que a resposta \u00e9 um somat\u00f3rio das respostas individuais de cada\nsistema, isto \u00e9:\n\ny = uG1(s) + uG2(s) = u(G1(s) + G2(s)) (25)\n\nA fun\u00e7\u00e3o de transfer\u00eancia que relaciona a entrada e sa\u00edda do sistema composto por G1 e G2 \u00e9:\n\n\n\n20 Trabalho de Conclus\u00e3o de Curso\n\nFigura 14: Plantas G1 e G2 em paralelo.\n\nG3(s) =\ny(s)\nu(s)\n\n=\nK1(?s + 1)(s2 + ?2)(T3 s + 1) + A(sin (?)s + cos (?)?)s(T1 s2 + 2T1?s + 1)(T2 s + 1)\n\n(T1 s2 + 2T1?s + 1)(T2 s + 1)(s2 + ?2)(T3 s + 1)\n(26)\n\nRealizando-se a transformada inversa de Laplace, obt\u00eam-se a resposta de G3(s) no dom\u00ednio\ntempo, que ent\u00e3o \u00e9 utilizada para realizar a identifica\u00e7\u00e3o. Foi utilizado um script em Python para\nessa identifica\u00e7\u00e3o, dispon\u00edvel no Anexo A. Este script implementa uma prospec\u00e7\u00e3o inicial dos\npar\u00e2metros do modelo atrav\u00e9s do m\u00e9todo de Evolu\u00e7\u00e3o Diferencial, e ent\u00e3o, com os par\u00e2metros\nencontrados, utiliza uma identifica\u00e7\u00e3o por m\u00ednimos quadrados para realizar um ajuste fino dos\npar\u00e2metros de G3(s).\n\n3.3 Projeto de controlador pelo m\u00e9todo IMC\n\nFoi realizado o projeto de controladores para um sistema de controle de press\u00e3o, que tem o\nintuito de eliminar o comportamento c\u00edclico da golfada para aberturas de v\u00e1lvula choke de produ\u00e7\u00e3o\nmaiores do que a do ponto de bifurca\u00e7\u00e3o do sistema em malha aberta. Para tal, s\u00e3o empregadas\nduas metodologias:\n\n\u2022 Projeto IMC tradicional, descrito na Se\u00e7\u00e3o 2.4, utilizando o modelo linear apresentado na\nSe\u00e7\u00e3o 3.2.\n\n\u2022 Aplica\u00e7\u00e3o da metodologia de Jahanshahi e Skogestad, 2013 para o modelo de Di Meglio\net al., 2009.\n\nA malha de controle utilizada em ambas metodologias pode ser observada na Figura 15.\n\n3.3.1 Projeto de controle pelo m\u00e9todo IMC para o modelo linear simplificado\n\nCom a fun\u00e7\u00e3o G3(s) da Equa\u00e7\u00e3o 26 identificada, pode ser realizado o projeto do controlador,\nbaseado no procedimento descrito na Se\u00e7\u00e3o 2.4.\n\nA partir do modelo de G3(s) identificado, projeta-se o controlador pelo m\u00e9todo IMC, e ent\u00e3o o\ncontrolador obtido \u00e9 aplicado no sistema da Figura 15.\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 21\n\nFigura 15: Sistema de controle de press\u00e3o de fundo pr,b controlando a abertura da v\u00e1lvula choke de\nprodu\u00e7\u00e3o.\n\n3.3.2 Aplica\u00e7\u00e3o da metodologia Jahanshahi e Skogestad, 2013 para controlar o\nsistema de Di Meglio et al., 2009\n\nFoi tamb\u00e9m utilizada a metodologia desenvolvida por Jahanshahi e Skogestad, 2013, descrita\nna Se\u00e7\u00e3o 2.5, para identificar um modelo localmente inst\u00e1vel, no ponto de opera\u00e7\u00e3o ensaiado,\ndo sistema de Di Meglio et al., 2009, e projetar um controlador pelo m\u00e9todo IMC para modelos\nde processo inst\u00e1veis que suprimisse o comportamento de golfadas do sistema para aberturas de\nv\u00e1lvula superiores \u00e0 do ponto de bifurca\u00e7\u00e3o. O controlador obtido foi ent\u00e3o aplicado no sistema da\nFigura 15.\n\n\n\n22 Trabalho de Conclus\u00e3o de Curso\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 23\n\n4 Estudo de caso - Controle do modelo de Di Meglio et al., 2009\n\n4.1 Identifica\u00e7\u00e3o do ponto de bifurca\u00e7\u00e3o do sistema\n\nComo a vari\u00e1vel manipulada escolhida foi a abertura da v\u00e1lvula choke de produ\u00e7\u00e3o, nos casos\nestudados a vaz\u00e3o de inje\u00e7\u00e3o de g\u00e1s, wg,in, foi mantida em 0, 8kg/s. Como estados iniciais do\nmodelo, foram considerados os valores de estado estacion\u00e1rio das vari\u00e1veis de estado do modelo\npara uma abertura de 10% da v\u00e1lvula.\n\nInicialmente realizou-se um ensaio em malha aberta com o modelo de Di Meglio et al., 2009,\nvariando a abertura da v\u00e1lvula choke, no intuito de verificar a ocorr\u00eancia de golfadas nesses pontos\nde opera\u00e7\u00e3o, e assim identificar o ponto de bifurca\u00e7\u00e3o do sistema em malha aberta. Conforme a\nFigura 16, o modelo apresenta comportamento c\u00edclico em regime permanente, caracterizando a\ngolfada, a partir de 18% de abertura da v\u00e1lvula, sendo este o ponto de bifurca\u00e7\u00e3o do sistema.\n\nFigura 16: Varia\u00e7\u00e3o da press\u00e3o de fundo para diferentes valores de abertura da v\u00e1lvula choke de\nprodu\u00e7\u00e3o.\n\n4.2 Projeto de controle IMC com o modelo linear simplificado\n\nFoi ent\u00e3o realizado um ensaio em malha aberta variando a abertura da v\u00e1lvula de 15% para 25%,\npara identificar o modelo de G3 conforme descrito na Se\u00e7\u00e3o 3.2. Como no modelo a abertura da\n\n\n\n24 Trabalho de Conclus\u00e3o de Curso\n\nv\u00e1lvula \u00e9 dada como um valor entre 0 e 1, a varia\u00e7\u00e3o de abertura de 10% corresponde a 0,1. Como\na fun\u00e7\u00e3o de transfer\u00eancia identificada se baseia na resposta ao degrau unit\u00e1rio, \u00e9 portanto necess\u00e1rio\najustar o ganho da planta encontrado pela identifica\u00e7\u00e3o por um fator de 10. Com isso, o modelo\nidentificado foi:\n\nG(s) =\n?1, 62.103(s + 1, 24.10?1)(s + 2, 00.10?3)(s + 5, 58.10?4)(s2 + 1, 87.10?4 s + 3, 18.10?6)\n\n(s + 2, 00.10?3)2(s2 + 4, 00.10?3 s + 4, 00.10?6)(s2 + 3, 35.10?6)\n(27)\n\nA compara\u00e7\u00e3o dos dados utilizados na identifica\u00e7\u00e3o com a resposta do modelo completo de G3\npode ser vista na Figura 17.\n\nFigura 17: Identifica\u00e7\u00e3o do modelo baseado em dados do modelo de Di Meglio et al., 2012, para\numa troca de abertura de v\u00e1lvula de 15% para 25%.\n\nDe posse do modelo identificado da planta, pode ent\u00e3o ser projetado o controlador IMC conforme\nmostrado na Se\u00e7\u00e3o 3.3.1.\n\nObservando a Figura 16, pode-se aproximar a constante de tempo do sistema para uma abertura\nde v\u00e1lvula z = 20% como ? ? 1000s. Escolhendo ? como um valor menor que a constante de tempo\nem malha aberta do sistema, conforme a Equa\u00e7\u00e3o 3, escolheu-se ? = 500 s. Al\u00e9m disso, o filtro\nf (s) deve ser de ordem n = 1, para que Gc(s) = f (s)Q(s) seja pr\u00f3pria. Deste modo, o filtro f (s) tem\na forma\n\nf (s) =\n1\n\n(?s + 1)n\n=\n\n1\n(500s + 1)\n\n. (28)\n\nFatorando a parte de fase m\u00ednima de G(s), e invertendo, encontra-se Q(s), e ent\u00e3o adicionado o\nfiltro f (s) que faz com que Gc(s) seja pr\u00f3prio, encontra-se o controlador na forma IMC, Gc(s):\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 25\n\nGc(s) =\n?3, 7.10?6(s + 2.10?3)2(s2 + 4.10?3 s + 4.10?6)(s2 + 1, 4.10?3 s + 1, 3.10?6)(s2 + 3, 3.10?6)\n\n(s + 1, 2.10?1)(s + 2.10?3)4(s + 5, 6.10?4)(s2 + 1, 9.10?4 s + 3, 2.10?6)\n.\n\n(29)\n\nO controlador na forma de feedback tradicional pode ser encontrado de acordo com a Equa\u00e7\u00e3o\n4:\n\nC(s) =\n?3, 7.10?6(s + 2.10?3)(s2 + 4.10?3 s + 4.10?6)(s2 + 1, 4.10?3 s + 1, 3.10?6)\n\ns(s + 1, 2.10?1)(s + 5, 6.10?4)(s2 + 1, 9.10?4 s + 3, 2.10?6)\n. (30)\n\nCom o controlador projetado, utiliza-se a estrutura de realimenta\u00e7\u00e3o da Figura 15 para controlar\no modelo de Di Meglio et al., 2009.\n\nA Figura 18(a) mostra a resposta do sistema para uma mudan\u00e7a de setpoint de press\u00e3o de\n1, 9.107 Pa para 1, 8.107 Pa. Esta troca de setpoint configura uma transi\u00e7\u00e3o de um ponto de opera\u00e7\u00e3o\nlivre de golfadas, com baixas aberturas da v\u00e1lvula choke, para um ponto em que elas ocorrem, com\nmaiores aberturas da v\u00e1lvula, como se pode observar na Figura 16. A abertura da v\u00e1lvula em regime\npermanente alcan\u00e7ada neste experimento foi de 20%, sem a ocorr\u00eancia de golfadas. O sistema\ncontinua est\u00e1vel com o degrau aplicado, sendo not\u00e1vel uma melhora na performance transiente.\n\nAlterando o setpoint agora para um degrau de 1, 8.107 Pa para 1, 75.107 Pa obtemos o resultado\nda Figura 18(b).\n\n(a) Setpoint de 1, 9.107 Pa para 1, 8.107 Pa (b) Setpoint de 1, 8.107 Pa para 1, 75.107 Pa\n\nFigura 18: Controle do sistema para ? = 500.\n\nAlterando novamente o setpoint, agora para um degrau de 1, 75.107 Pa para 1, 7.107 Pa obtemos\no resultado da Figura 19(a).\n\nPara essa altera\u00e7\u00e3o de setpoint o sistema entrou no regime de golfadas, apresentando compor-\n\n\n\n26 Trabalho de Conclus\u00e3o de Curso\n\n(a) Setpoint de 1, 75.107 Pa para 1, 7.107 Pa (b) Setpoint de 1, 75.107 Pa para 1, 68.107 Pa\n\nFigura 19: Controle do sistema para ? = 500. Para estes setpoints, o sistema apresentou golfadas.\n\ntamento c\u00edclico em regime permanente, o que \u00e9 indesej\u00e1vel. No entanto, em compara\u00e7\u00e3o com a\namplitude de oscila\u00e7\u00e3o observada em aberturas de v\u00e1lvula similares em malha aberta, ocorreu uma\ndiminui\u00e7\u00e3o das oscila\u00e7\u00f5es.\n\nUtilizando o controlador projetado atrav\u00e9s da metodologia IMC, com base na planta simplificada\nG3, foi poss\u00edvel operar o sistema em regimes livres de golfadas para aberturas de v\u00e1lvula de at\u00e9\n25%, conforme resultado mostrado na Figura 19.\n\n4.3 Aplica\u00e7\u00e3o da metodologia de Jahanshahi e Skogestad, 2013\n\nDe modo a validar o projeto de controladores descrita em Jahanshahi e Skogestad, 2013,\nfoi aplicada a metodologia descrita pelo autor, e pormenorizada na Se\u00e7\u00e3o 2.5. Para verificar a\naplicabilidade da metodologia de projeto, ao inv\u00e9s de utilizar o mesmo modelo utilizado pelo autor,\nfoi utilizado o modelo de Di Meglio et al., 2009. O procedimento de identifica\u00e7\u00e3o parte de um\nensaio em malha fechada com um controlador proporcional com ganho Kc0 que estabilize o sistema.\n\nDe modo a identificar o sistema no entorno de um ponto de opera\u00e7\u00e3o que gerasse um modelo\nque pudesse ser utilizado para controle, foi utilizado um degrau de press\u00e3o que resultasse em uma\nabertura m\u00e9dia de v\u00e1lvula de aproximadamente 25%, conforme indica a Figura 20. O degrau\nutilizado foi de 1, 7.107 Pa para 1, 75.107 Pa.\n\nUtilizando a estrutura de realimenta\u00e7\u00e3o da Figura 13, com um controlador proporcional, ajustou-\nse o ganho do controlador at\u00e9 que o mesmo estabilizasse o sistema. Com o valor de Kc0 = ?3.10?7,\ne fazendo uma altera\u00e7\u00e3o de setpoint de 1, 7.107 Pa para 1, 75.107 Pa, encontra-se a resposta em\nmalha fechada conforme a Figura 21.\n\nUtilizando o procedimento de identifica\u00e7\u00e3o da resposta do sistema estabilizado descrito por\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 27\n\nFigura 20: Abertura de v\u00e1lvula m\u00e9dia no ensaio em malha fechada usado para identifica\u00e7\u00e3o do\nmodelo.\n\nFigura 21: Ensaio em malha fechada para identifica\u00e7\u00e3o do modelo inst\u00e1vel de segunda ordem.\n\nJahanshahi e Skogestad, 2013, e implementado no script constante no Ap\u00eandice A, que usa como\nbase as medidas de ?yp, ?yu, ?ys, ?y?, tp e tu, identificadas na Figura 21, identifica-se o modelo\ninst\u00e1vel da planta, que por sua vez \u00e9 est\u00e1vel, como na Equa\u00e7\u00e3o 6:\n\nG(s) =\n?5, 16.104(s + 7, 06.10?4)\n\n(s ? 1, 02.10?2)(s ? 4, 58.10?4)\n. (31)\n\nO controlador projetado, conforme a Equa\u00e7\u00e3o 10, utilizando ? = 500 s \u00e9:\n\nC(s) =\n?3, 23.10?7(s2 ? 4, 38.10?4 + 4, 79.10?7)\n\ns(s + 7, 62.10?4)\n. (32)\n\nCom o controlador projetado, foi aplicado um degrau de press\u00e3o no sistema em malha fechada\nde 1, 9.107 Pa para 1, 8.107 Pa, conforme a Figura 22(a). Tamb\u00e9m foi aplicado um degrau de\n1, 75.107 Pa para 1, 7.107 Pa, conforme a Figura 22(b).\n\nEm ambos os casos n\u00e3o ocorreram golfadas no sistema. O m\u00e1ximo valor de abertura de v\u00e1lvula\nobtido sem que o sistema apresentasse oscila\u00e7\u00f5es foi aplicando-se um setpoint de 1, 695.107 Pa,\n\n\n\n28 Trabalho de Conclus\u00e3o de Curso\n\n(a) Setpoint de 1, 9.107 Pa para 1, 8.107 Pa (b) Setpoint de 1, 75.107 Pa para 1, 7.107 Pa\n\nFigura 22: Controle do sistema para ? = 500.\n\nno qual obteve-se uma abertura de v\u00e1lvula de 38%, como pode ser observado na Figura 23(a).\nAplicando-se um degrau de 1, 75.107 Pa para 1, 68.107 Pa, o sistema passa a apresentar oscila\u00e7\u00e3o,\ncaracterizando a ocorr\u00eancia de golfadas, como pode se observar na Figura 23(b).\n\n(a) Setpoint de 1, 75.107 Pa para 1, 695.107 Pa (b) Setpoint de 1, 75.107 Pa para 1, 68.107 Pa\n\nFigura 23: Controle do sistema para ? = 500.\n\nCom este controlador foi poss\u00edvel operar o sistema em um regime livre de golfadas para\naberturas de at\u00e9 38%, caracterizando um aumento de mais de 100% em rela\u00e7\u00e3o \u00e0 abertura do ponto\nde bifurca\u00e7\u00e3o do sistema em malha aberta.\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 29\n\n5 Conclus\u00f5es\n\nNeste trabalho foram estudadas duas metodologias de projeto de controle IMC, com o intuito\nde suprimir a ocorr\u00eancia de golfadas em sistemas de extra\u00e7\u00e3o de petr\u00f3leo. Para tal foi utilizado\num modelo do tipo caixa cinza do processo, descrito por Di Meglio et al., 2012 como planta, e\na partir dele foram identificados modelos lineares que pudessem ser utilizados para o projeto de\ncontroladores. Os controladores projetados foram testados em uma malha feedback com o modelo\ncaixa cinza, realizando-se controle de press\u00e3o.\n\nFoi poss\u00edvel estabilizar o sistema para aberturas da v\u00e1lvula choke maiores do que a abertura\ndo ponto de bifurca\u00e7\u00e3o do sistema em malha aberta, que \u00e9 de 18%. Esse aumento de abertura, no\nmodelo utilizado, n\u00e3o apresenta aumentos de vaz\u00e3o de sa\u00edda, pois as vaz\u00f5es de entrada do modelo\ns\u00e3o fixas. No entanto, de acordo com Di Meglio et al., 2009, o modelo representa corretamente o\nmecanismo de ocorr\u00eancia de golfadas de sistemas reais, e se essas forem suprimidas com sucesso\nno modelo, \u00e9 seguro afirmar que, em um sistema real, maiores aberturas de v\u00e1lvula em regimes\nlivres de oscila\u00e7\u00f5es representariam ganhos de vaz\u00e3o de produtos.\n\nA primeira metodologia empregada foi o projeto de controladores pelo m\u00e9todo IMC para plantas\nest\u00e1veis, a partir de um modelo linear simplificado. Com esta metodologia, foi poss\u00edvel atingir\naberturas de v\u00e1lvula choke de sa\u00edda de at\u00e9 25%.\n\nFoi tamb\u00e9m reproduzida a metodologia desenvolvida em Jahanshahi e Skogestad, 2013, que\nconsiste em identificar o sistema que apresenta golfadas como um modelo inst\u00e1vel no ponto de\nopera\u00e7\u00e3o utilizado, e realizar o projeto IMC para plantas inst\u00e1veis como descrito em Morari\ne Zafiriou, 1989. Considerando os resultados apresentados em Jahanshahi e Skogestad, 2013,\nJahanshahi et al., 2013 e Jahanshahi et al., 2015, o m\u00e9todo \u00e9 promissor, por apresentar \u00f3timos\nresultados, e ser de f\u00e1cil implementa\u00e7\u00e3o. Esta afirma\u00e7\u00e3o foi corroborada pelos resultados obtidos ao\naplicar a metodologia no modelo de Di Meglio et al., 2009. Foi poss\u00edvel operar o sistema em um\nregime livre de oscila\u00e7\u00f5es para aberturas de v\u00e1lvula de at\u00e9 38%.\n\nComo trabalhos futuros, considerando o fato de que o projeto pelo m\u00e9todo IMC baseia-se em\num modelo que \u00e9 valido no entorno do ponto de opera\u00e7\u00e3o no qual ele foi identificado, e que o\nsistema \u00e9 n\u00e3o-linear, sugere-se um estudo sobre o uso de alguma t\u00e9cnica de gain-scheduling em\nconjunto com a metodologia IMC, de modo a aliar a robustez que o IMC fornece \u00e0 ampla faixa de\nopera\u00e7\u00e3o que uma t\u00e9cnica de gain-scheduling adicionaria ao sistema controlado.\n\n\n\n30 Trabalho de Conclus\u00e3o de Curso\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 31\n\n6 Refer\u00eancias\n\nANP, 2017. http://www.anp.gov.br/wwwanp/noticias/anp-e-p/3912-producao-de-petroleo-no-pre-\nsal-ultrapassa-pela-primeira-vez-a-do-pos-sal. acessado em 25/10/2017 12.\n\nApio, A., 2017. Estima\u00e7\u00e3o de par\u00e2metros em modelos com ciclo limite. Disserta\u00e7\u00e3o de mestrado,\nPPGEQ-UFRGS.\n\nBarbosa, B. H., Gomes, L. P., Teixeira, A. F., Aguirre, L. A., 2015. Downhole pressure estimation\nusing committee machines and neural networks. IFAC-PapersOnLine 48 (6), 286\u2013291.\n\nBiltoft, J., Hansen, L., Pedersen, S., Yang, Z., 2013. Recreating riser slugging flow based on an\neconomic lab-sized setup. IFAC Proceedings Volumes 46 (12), 47\u201352.\n\nDi Meglio, F., Kaasa, G.-O., Petit, N., 2009. A first principle model for multiphase slugging\nflow in vertical risers. In: Decision and Control, 2009 held jointly with the 2009 28th Chinese\nControl Conference. CDC/CCC 2009. Proceedings of the 48th IEEE Conference on. IEEE, pp.\n8244\u20138251.\n\nDi Meglio, F., Kaasa, G.-O., Petit, N., Alstad, V., 2010. Reproducing slugging oscillations of a real\noil well. In: Decision and Control (CDC), 2010 49th IEEE Conference on. IEEE, pp. 4473\u20134479.\n\nDi Meglio, F., Kaasa, G.-O., Petit, N., Alstad, V., 2012. Model-based control of slugging: advances\nand challenges. IFAC Proceedings Volumes 45 (8), 109\u2013115.\n\nDiehl, F. C., K. Anzai, T., S. Almeida, C., F. Von Meien, O., S. Neto, S., R. Rosa, V., C.M.M. Cam-\npos, M., Reolon, F., Gerevini, G., Ranzan, C., Farenzena, M., Trierweiler, J., 01 2017. Fast\noffshore wells model (fowm): A practical dynamic model for multiphase oil production systems\nin deepwater and ultra-deepwater scenarios 99.\n\nGarcia, C. E., Morari, M., 1982. Internal model control. a unifying review and some new results.\nIndustrial &amp; Engineering Chemistry Process Design and Development 21 (2), 308\u2013323.\n\nGerevini, G. G., 2014. An\u00e1lise e controle da din\u00e2mica de escoamento em po\u00e7os de petr\u00f3leo por\ngas-lift. Trabalho de Conclus\u00e3o de Curso, DEQUI-UFRGS.\n\nGerevini, G. G., 2017. Atenua\u00e7\u00e3o de golfadas em sistemas de eleva\u00e7\u00e3o de petr\u00f3leo em ambiente\noffshore. Disserta\u00e7\u00e3o de mestrado, PPGEQ-UFRGS.\n\nGerevini, G. G., Apio, A., Trierweiler, J. O., Farenzena, M., Diehl, F. C., 2017. Aumento da\nprodu\u00e7\u00e3o de petr\u00f3leo em sistemas de produ\u00e7\u00e3o offshore atrav\u00e9s de controle nmpc. International\nJournal of Multiphase Flow 88, 270\u2013284.\n\nHussein, H., Al-Durra, A., Boiko, I., 2015. Design of gain scheduling control strategy for artificial\ngas lift in oil production through modified relay feedback test. Journal of the Franklin Institute\n352 (11), 5122\u20135144.\n\n\n\n32 Trabalho de Conclus\u00e3o de Curso\n\nJahanshahi, E., De Oliveira, V., Grimholt, C., Skogestad, S., 2014. A comparison between internal\nmodel control, optimal pidf and robust controllers for unstable flow in risers. IFAC Proceedings\nVolumes 47 (3), 5752\u20135759.\n\nJahanshahi, E., Skogestad, S., 2011. Simplified dynamical models for control of severe slugging in\nmultiphase risers. IFAC proceedings volumes 44 (1), 1634\u20131639.\n\nJahanshahi, E., Skogestad, S., 2013. Closed-loop model identification and pid/pi tuning for robust\nanti-slug control. IFAC Proceedings Volumes 46 (32), 233\u2013240.\n\nJahanshahi, E., Skogestad, S., Skogestad, S., 2013. Comparison between nonlinear model-based\ncontrollers and gain-scheduling internal model control based on identified model. In: Decision\nand Control (CDC), 2013 IEEE 52nd Annual Conference on. IEEE, pp. 853\u2013860.\n\nJahanshahi, E., Skogestad, S., Skogestad, S., 2015. Anti-slug control solutions based on identified\nmodel. Journal of Process Control 30, 58\u201368.\n\nKhalil, H. K., 1996. Nonlinear systems. Prentice-Hall, New Jersey 2 (5), 5\u20131.\n\nMorari, M., Zafiriou, E., 1989. Robust process control. Prentice hall Englewood Cliffs, NJ.\n\nPedersen, S., Durdevic, P., Yang, Z., 2017. Challenges in slug modeling and control for offshore oil\nand gas productions: A review study. International Journal of Multiphase Flow 88, 270\u2013284.\n\nRivera, D. E., Morari, M., Skogestad, S., 1986. Internal model control: Pid controller design.\nIndustrial &amp; engineering chemistry process design and development 25 (1), 252\u2013265.\n\nSivertsen, H., Storkaas, E., Skogestad, S., 2010. Small-scale experiments on stabilizing riser slug\nflow. Chemical engineering research and design 88 (2), 213\u2013228.\n\nStorkaas, E., Skogestad, S., 2007. Controllability analysis of two-phase pipeline-riser systems at\nriser slugging conditions. Control Engineering Practice 15 (5), 567\u2013581.\n\nTaitel, Y., Bornea, D., Dukler, A. E., 1980. Modelling flow pattern transitions for steady upward\ngas-liquid flow in vertical tubes. AIChE Journal 26 (3), 345\u2013354.\nURL http://dx.doi.org/10.1002/aic.690260304\n\nhttp://dx.doi.org/10.1002/aic.690260304\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 33\n\nAp\u00eandices\nA Procedimento para projeto de controladores IMC pela metodologia de\n\nJahanshahi e Skogestad, 2013\n\nO procedimento descrito \u00e9 um script do MATLAB, e deve ser utilizado em conjunto com um\ngr\u00e1fico de resposta temporal de um sistema realimentado com um controlador proporcional, ajustado\npara que o sistema apresente resposta subamortecida.\n\n%C\u00e1lculo da fun\u00e7\u00e3o de transfer\u00eancia inst\u00e1vel a partir de um experimento\n%malha fechada\n\n%Medidas obtidas do gr\u00e1fico\ntp=2e3\ntu=1.6e3\nyp=0.087e7\nyu=0.0686e7\nyinf=0.0701e7\nys=0.1e7\nKc0=-0.0000001\n\n%C\u00e1lculos intermedi\u00e1rios\nv=(yinf-yu)/(yp-yinf)\ncsi=-log(v)/(sqrt(pi^2+(log(v))^2))\ntau=tu*sqrt(1-csi^2)/pi\nK2=yinf/ys\nphi=atan((1-csi)/csi)-tp*sqrt(1-csi^2)/tau\nE=sqrt(1-csi^2)/tau\nD0=(yp-yinf)/yinf\nD=D0/(exp(-csi*tp/tau)*sin(E*tp+phi))\ntauz=csi*tau+sqrt(csi^2*tau^2-tau^2*(1-D^2*(1-csi^2)))\n\n%pra ver se os c\u00e1lculos deram certo\nt=[0:1:1e5]\n\ny=ys*K2.*(1+D*exp(-csi.*t/tau).*sin(E.*t+phi))\n\nplot(t,y)\n\n%Par\u00e2metros do modelo inst\u00e1vel\n\n\n\n34 Trabalho de Conclus\u00e3o de Curso\n\nK=yinf/(Kc0*abs(ys-yinf))\na0=1/(tau^2*(1+Kc0*K))\nb0=K*a0\nb1=K2*tauz/(Kc0*tau^2)\na1=-2*csi/tau+Kc0*b1\n\n%Planta inst\u00e1vel linearizada\nnum = [b1 b0]\nden = [1 -a1 a0]\nG=tf(num, den)\nstep(G)\n[z,p,k]=zpkdata(G)\nQ=zpk(p,z,1/k)\n\n%C\u00e1lculo dos par\u00e2metros do filtro f(s)\np1=p{1,1}(1)\np2=p{1,1}(2)\nlambda=6000\nalpha=linsolve([p1^2 p1 1;p2^2 p2 1;0 0 1],[(lambda*p1+1)^3;(lambda*p2+1)^3;1])\nalpha2=alpha(1)\nalpha1=alpha(2)\nalpha0=alpha(3)\nf=tf([alpha2 alpha1 alpha0],[lambda^3 3*lambda^2 3*lambda 1])\nGc=Q*f %Mas n\u00e3o d\u00e1 pra usar essa estrutura, pois G \u00e9 inst\u00e1vel\n\n%C=tf((1/(k*lambda^3))*[alpha2 alpha1 alpha0],[1 z{1,1}(1) 0])\nC=minreal(Gc/(1-Gc*G))\npid(C)\nT=feedback(C*G,1)\nstep(T)\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 35\n\nAnexos\nA Identifica\u00e7\u00e3o em Python\n\nScript desenvolvido por Jorge O. Trierweiler, Gustavo Arndt, Bruno \u00c9ttori e Marcelo Farenzena\n\u2013 GISMCOP / DEQUI / UFRGS. Utilizado para identifica\u00e7\u00e3o da fun\u00e7\u00e3o de transfer\u00eancia G3. Est\u00e1 no\nformato de um Jupyter Notebook.\n\nimport numpy as np\nimport lmfit as lf\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport pandas as pd\n\nDados = pd.read_excel(\u2019D:\\\\Desktop\\\\teste6.xlsx\u2019,\u2019DADOS\u2019)\n\nplt.subplot(211)\nplt.plot(Dados[\u2019Time\u2019], Dados[\u2019PDG\u2019])\nplt.xlabel(\u2019tempo[s]\u2019, fontsize=14)\nplt.ylabel(\u2019press\u00e3o[kPa]\u2019, fontsize=14)\nplt.subplot(212)\nplt.plot(Dados[\u2019Time\u2019],Dados[\u2019x\u2019]);\nplt.xlabel(\u2019tempo[s]\u2019, fontsize=14)\nplt.ylabel(\u2019abertura[%]\u2019, fontsize=14)\n\n## Criando as vari\u00e1veis desvios\nDados[\u2019y\u2019]=Dados[\u2019PDG\u2019]-Dados[\u2019PDG\u2019][0]\nDados[\u2019u\u2019]=Dados[\u2019x\u2019]-Dados[\u2019x\u2019][0]\nDados.head()\n\n# Selecionando os dados\ni1=425; i2=5000\nplt.subplot(211)\nplt.plot(Dados[\u2019Time\u2019][i1:i2],Dados[\u2019y\u2019][i1:i2])\nplt.grid()\nplt.subplot(212)\nplt.plot(Dados[\u2019Time\u2019][i1:i2],Dados[\u2019u\u2019][i1:i2]);\n\ndef G1 ( t, K1, B, Z, T1, T2):\nt1 = Z ** 2\nt3 = np.sqrt(-t1 + 1)\n\n\n\n36 Trabalho de Conclus\u00e3o de Curso\n\nt5 = 0.1e1 / T1\nt6 = t3 * t * t5\nt7 = np.cos(t6)\nt8 = T1 * T2\nt10 = 2 * t8 * Z\nt11 = B * T2\nt12 = T1 ** 2\nt21 = np.exp(-t/T2)\nt17 = np.exp(-t * Z/T1)\nt26 = T2 ** 2\nt28 = 0.1e1 / (-t10 + t12 + t26)\nt31 = np.sin(t6)\nreturn(K1 * (0.1e1 + (t7 * (t10 - t11 - t12) * t17 + t21 * (B - T2) * T2) * t28 + 0.1e1 / t3 * t31 * t17 * (B * T1 - Z * t11 - Z * t12 + 2 * t1 * t8 - t8) * t28))\n\n# Vers\u00e3o otimizada da fun\u00e7\u00e3o\ndef G2(t,A,omega,phi,T3):\n\nt1 = omega ** 2\nt2 = T3 ** 2\nt7 = omega * t\nt8 = np.sin(t7)\nt9 = np.cos(phi)\nt12 = np.sin(phi)\nt16 = np.exp(-t / T3)\nt17 = np.cos(t7)\nt18 = t16 - t17\nreturn((t9 * t8 + (t12 * t8 + t18 * t9) * omega * T3 - t12 * t18) / (t1 * t2 + 1) * A)\n\n# A seguir se faz um comparativo\n\ntt = np.linspace(0,1000,200)\nplt.plot(tt,G1(tt,-1,10,0.9,40,30)+G2(tt,0.2,0.1,np.pi,50))\nplt.grid()\n\n## Estima\u00e7\u00e3o de G3\n##Nessa se\u00e7\u00e3o iremos estimar os par\u00e2metros de G3 diretamente usando todos os dados.\n\n##**Aten\u00e7\u00e3o:** Por ser um problema n\u00e3o convexo a qualidade da aproxima\u00e7\u00e3o depende ##da inicializa\u00e7\u00e3o dos par\u00e2metros e fortemente do m\u00e9todo de otimiza\u00e7\u00e3o empregado ##na resolu\u00e7\u00e3o do problema de otimiza\u00e7\u00e3o.\n##Os seguintes m\u00e9todos poder\u00e3o ser testados, bastando se atribuir a par\u00e2metro ##\u2019method\u2019 na da fun\u00e7\u00e3o \u2019minimize\u2019:\n##* **\u2018leastsq\u2019**: Levenberg-Marquardt (default)\n##* **\u2018least_squares\u2019**: Least-Squares minimization, using Trust Region ##Reflective method by default\n##* **\u2018differential_evolution\u2019**: differential evolution\n##* **\u2018brute\u2019**: brute force method\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 37\n\n##* **\u2018nelder\u2018**: Nelder-Mead\n##* **\u2018lbfgsb\u2019**: L-BFGS-B\n##* **\u2018powell\u2019**: Powell\n##* **\u2018cg\u2019**: Conjugate-Gradient\n##* **\u2018newton\u2019**: Newton-Congugate-Gradient\n##* **\u2018cobyla\u2019**: Cobyla\n##* **\u2018tnc\u2019**: Truncate Newton\n##* **\u2018trust-ncg\u2019**: Trust Newton-Congugate-Gradient\n##* **\u2018dogleg\u2019**: Dogleg\u2019\u2019\n##* **\u2018slsqp\u2019**: Sequential Linear Squares Programming\n\n##Quando n\u00e3o se tem ideia dos par\u00e2metros, o m\u00e9todo **\u2018differential_evolution\u2019** \u00e9 ##uma \u00f3tima alternativa. Depois que se tiver bons par\u00e2metros, se pode retornar ao ##default para se obter uma estimativa da correla\u00e7\u00e3o entre os par\u00e2metros do modelo\n\nfrom lmfit import minimize, Minimizer, Parameters, Parameter, report_fit\n\n# create data to be fitted\ni1=425; i2=5000\nt = Dados[\u2019Time\u2019][i1:i2]-Dados[\u2019Time\u2019][i1]\nYY = Dados[\u2019y\u2019][i1:i2]\n\n# define objective function: returns the array to be minimized\ndef fcn2min(p,t,YY):\n\nreturn (G1(t,p[\u2019K1\u2019],p[\u2019B\u2019],p[\u2019Z\u2019],p[\u2019T1\u2019],p[\u2019T2\u2019])+G2(t,p[\u2019A\u2019],p[\u2019omega\u2019],p[\u2019phi\u2019],p[\u2019T3\u2019])-YY)\n\n# create a set of Parameters\np = Parameters()\np.add(\u2019K1\u2019, value= -3.5e+06, min=-2000000,max=-1000000)\np.add(\u2019T1\u2019, value= 2000.27062,min=500,max=3000)\np.add(\u2019Z\u2019, value= 0.95, min=0.0, max=0.9999)\np.add(\u2019B\u2019,value = 100,min=0,max=3000)\np.add(\u2019A\u2019,value = 300000, min = 0.0,max=300000)\np.add(\u2019omega\u2019, value= 0.1,min=0.001,max=0.15)\np.add(\u2019phi\u2019,value= 1., min=0.0, max=np.pi*2)\np.add(\u2019T2\u2019, value= 1000,min=500,max=3000)\np.add(\u2019T3\u2019, value= 1000,min=500,max=3000)\n\n# do fit, here with leastsq model\nminner = Minimizer(fcn2min, p, fcn_args=(t,YY))\nresult = minner.minimize(method=\u2019differential_evolution\u2019)\n\n\n\n38 Trabalho de Conclus\u00e3o de Curso\n\n# calculate final result\nfinal = YY + result.residual\n\n# write error report\nreport_fit(result)\n\nplt.figure(figsize=(7, 5))\nplt.plot(t, YY, \u2019k--\u2019)\nplt.plot(t, final, \u2019r\u2019)\nplt.xlabel(\u2019tempo[s]\u2019, fontsize=14)\nplt.ylabel(\u2019press\u00e3o[kPa]\u2019, fontsize=14)\nplt.show()\n\n# Agora vamos resolver o problema com os m\u00ednimos quadrados tendo como par\u00e2metros iniciais\n# os obtidos anteriormente -- assim teremos uma estimativa da confiabilidade dos par\u00e2mtros\nresult2 = minner.minimize(method=\u2019leastsq\u2019,params=result.params)\n\n# calculate final result\nfinal = YY + result2.residual\n\n# write error report\nreport_fit(result2)\n\nplt.figure(figsize=(15, 10))\nplt.plot(t, YY, \u2019k--\u2019)\nplt.plot(t, final, \u2019r\u2019)\nplt.show()\n\nB s-function do modelo de Di Meglio et al., 2012\n\nEsta implementa\u00e7\u00e3o foi realizada por Gerevini, 2014. Os par\u00e2metros do modelo s\u00e3o os mesmos\nutilizados pelo autor original.\n\nfunction [sys,x0] = sfmeglio(t,x,u,flag)\n\nRol = 900 ;\nPs = 6.6e5 ;\nR = 8.314 ;\nT = 363 ;\nM = 2.2e-2 ;\n\n\n\nEscola de Engenharia/UFRGS \u2013 Gabriel Agnischock da Silveira 39\n\ng = 9.81 ;\nteta = pi/4 ;\nA = 1.77e-2;\nmlstill= 3.73e4 ;\nCg = 1e-4 ;\nCout = 2.8e-3 ;\nVeb = 48 ;\nE = 0.78 ;\nL = 5200 ;\nD = 1.5e-1 ;\nWlin = 11.75 ; % fluxo m\u00e1ssico de l\u00edquido entrando no riser\n\nswitch flag\ncase 0\n\nsys = [3 0 5 2 0 0]\u2019;\nx0 = [5.7467 0.2518 3.3356]*1000;\n% u = [0.7 0.8];\n\ncase 1\nCk = u(1);\nWgin = u(2);\n\n%Algebrismo\nVr = L * pi * D * D/4 ;\nPeb = x(1).* R * T / ( M * Veb ) ;\nPrt = x(2).* R * T / ( M* ( Vr - ( x(3) + mlstill ) / Rol ) ) ;\nPrb = Prt + ( x(3) + mlstill ) * g * sin(teta) / A ;\nassignin(\u2019base\u2019,\u2019Prb\u2019,Prb);\nif Prt > Ps\n\nWout = Cout * Ck * sqrt( Rol * ( Prt - Ps ) ) ;\nelse\n\nWout = 0;\nend\nassignin(\u2019base\u2019,\u2019Wout\u2019,Wout) ;\nWlout= Wout;\nWgout= x(2).* Wout / x(3) ;\nWg = Cg * max( 0 , (Peb-Prb) ) ;\n\n%ODE\nsys(1) = ( 1 - E ) * Wgin - Wg ; % massa de gas na bolha\nsys(2) = E * Wgin + Wg - Wgout ; % massa gas no riser\nsys(3) = Wlin - Wlout ; % massa de l\u00edquido no riser\n\n\n\n40 Trabalho de Conclus\u00e3o de Curso\n\nsys = sys\u2019;\n\ncase 3\nsys = x;\nsys(4,1) = evalin(\u2019base\u2019,\u2019Wout\u2019);\nsys(5,1) = evalin(\u2019base\u2019,\u2019Prb\u2019);\n\notherwise\nsys = [];\n\nend\n\n\n\tAgradecimentos\n\tResumo\n\tAbstract\n\tLista de Figuras\n\tLista de Tabelas\n\tLista de Abreviaturas e Siglas\n\tIntrodu\u00e7\u00e3o\n\tObjetivo\n\n\tRevis\u00e3o bibliogr\u00e1fica\n\tSistemas de extra\u00e7\u00e3o de petr\u00f3leo offshore\n\tGas-lift\n\n\tComportamento din\u00e2mico de sistemas com gas-lift: golfadas, bifurca\u00e7\u00e3o\n\tControle de produ\u00e7\u00e3o\n\tControle ativo\n\n\tProjeto de controle pelo m\u00e9todo IMC\n\tAplica\u00e7\u00e3o de controle IMC anti-golfadas - Jahanshahi, 2013\n\n\tMetodologia\n\tModelo utilizado como planta a ser controlada - Di Meglio, 2009\n\tVis\u00e3o Geral do modelo simplificado proposto\n\tProjeto de controlador pelo m\u00e9todo IMC\n\tProjeto de controle pelo m\u00e9todo IMC para o modelo linear simplificado\n\tAplica\u00e7\u00e3o da metodologia jahanshahi2013closed para controlar o sistema de di2009first\n\n\n\tEstudo de caso - Controle do modelo de di2009first\n\tIdentifica\u00e7\u00e3o do ponto de bifurca\u00e7\u00e3o do sistema\n\tProjeto de controle IMC com o modelo linear simplificado\n\tAplica\u00e7\u00e3o da metodologia de jahanshahi2013closed\n\n\tConclus\u00f5es\n\tRefer\u00eancias\n\tAp\u00eandices\n\tProcedimento para projeto de controladores IMC pela metodologia de jahanshahi2013closed\n\tAnexos\n\tIdentifica\u00e7\u00e3o em Python\n\ts-function do modelo de di2012model"}]}}}