{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.21278"}, {"@name": "filename", "#text": "4995_244296.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "AUGUSTO MARASCA DE CONTO\n\nALOCA\u00c7\u00c3O DE G\u00c1S DE INJE\u00c7\u00c3O EM PO\u00c7OS\n\nDE PETR\u00d3LEO SOB RESTRI\u00c7\u00d5ES DE\n\nPRECED\u00caNCIA: LINEARIZA\u00c7\u00c3O POR PARTES E\nPROGRAMA\u00c7\u00c3O INTEIRA\n\nFLORIAN\u00d3POLIS\n2006\n\n\n\nUNIVERSIDADE FEDERAL DE SANTA CATARINA\n\nPROGRAMA DE P\u00d3S-GRADUA\u00c7\u00c3O\nEM ENGENHARIA EL\u00c9TRICA\n\nALOCA\u00c7\u00c3O DE G\u00c1S DE INJE\u00c7\u00c3O EM PO\u00c7OS\n\nDE PETR\u00d3LEO SOB RESTRI\u00c7\u00d5ES DE\n\nPRECED\u00caNCIA: LINEARIZA\u00c7\u00c3O POR PARTES E\nPROGRAMA\u00c7\u00c3O INTEIRA\n\nDisserta\u00e7\u00e3o submetida \u00e0 Universidade Federal de Santa Catarina\ncomo requisito parcial \u00e0 obtens\u00e3o do grau de\n\nMESTRE EM ENGENHARIA EL\u00c9TRICA\n\npor\n\nAUGUSTO MARASCA DE CONTO\n\nFlorian\u00f3polis, setembro de 2006.\n\n\n\nALOCA\u00c7\u00c3O DE G\u00c1S DE INJE\u00c7\u00c3O EM PO\u00c7OS\nDE PETR\u00d3LEO SOB RESTRI\u00c7\u00d5ES DE\n\nPRECED\u00caNCIA: LINEARIZA\u00c7\u00c3O POR PARTES E\nPROGRAMA\u00c7\u00c3O INTEIRA\n\nAugusto Marasca de Conto\n\nEsta Disserta\u00e7\u00e3o foi julgada adequada para a obten\u00e7\u00e3o do t\u00edtulo de Mestre em Engenharia\n\nna especialidade Engenharia El\u00e9trica, \u00e1rea de concentra\u00e7\u00e3o Automa\u00e7\u00e3o e Sistemas, e\n\naprovada em sua forma final pelo Programa de P\u00f3s-Gradua\u00e7\u00e3o.\nFlorian\u00f3polis, Setembro de 2006.\n\nProf. Eduardo Camponogara, Ph.D. (Orientador)\n\nProf. Nelson Sadowski, Dr.\nCoordenador do Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia El\u00e9trica\n\nda Universidade Federal de Santa Catarina\n\nBanca Examinadora:\n\nProf. Eduardo Camponogara, Ph.D. (Orientador)\n\nProf. M\u00e1rio C\u00e9sar Zambaldi, Dr.\n\nProf. Jos\u00e9 Eduardo Ribeiro Cury, Dr.\n\nProf. R\u00f4mulo Silva de Oliveira, Dr.\n\nii\n\n\n\nDedico aos meus pais, Augusto e Ivone,\n\ne \u00e0 minha irm\u00e3 Cl\u00e1udia.\n\niii\n\n\n\nResumo da disserta\u00e7\u00e3o apresentada \u00e0 UFSC como parte dos requisitos necess\u00e1rios para obten\u00e7\u00e3o do\ngrau de Mestre em Engenharia El\u00e9trica.\n\nALOCA\u00c7\u00c3O DE G\u00c1S DE INJE\u00c7\u00c3O EM PO\u00c7OS\nDE PETR\u00d3LEO SOB RESTRI\u00c7\u00d5ES DE\n\nPRECED\u00caNCIA: LINEARIZA\u00c7\u00c3O POR PARTES E\nPROGRAMA\u00c7\u00c3O INTEIRA\n\nAugusto Marasca de Conto\n\nSetembro/2006\n\nOrientador: Eduardo Camponogara\n\u00c1rea de Concentra\u00e7\u00e3o: Automa\u00e7\u00e3o e Sistemas\nPalavras-chave: Campos de petr\u00f3leo, aloca\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o, formula\u00e7\u00e3o linear por partes, pro-\ngrama\u00e7\u00e3o inteira mista, teoria poliedral, restri\u00e7\u00f5es de preced\u00eancia\nN\u00famero de P\u00e1ginas: xi + 94\n\nA aloca\u00e7\u00e3o \u00f3tima de g\u00e1s de inje\u00e7\u00e3o busca taxas de inje\u00e7\u00e3o para po\u00e7os de petr\u00f3leo ope-\nrados por gas-lift que otimize uma fun\u00e7\u00e3o objetivo, normalmente que maximize o lucro, em\num campo de petr\u00f3leo. Apesar do grande interesse nesta classe de problemas, a maioria\ndos trabalhos nesta \u00e1rea n\u00e3o os trata adequadamente, produzindo solu\u00e7\u00f5es sub-\u00f3timas e n\u00e3o\nconsiderando explicitamente decis\u00f5es discretas de ativa\u00e7\u00e3o e desativa\u00e7\u00e3o dos po\u00e7os. Neste\ntrabalho buscamos obter taxas \u00f3timas de inje\u00e7\u00e3o de g\u00e1s considerando restri\u00e7\u00f5es de capaci-\ndade m\u00e1xima de g\u00e1s dispon\u00edvel e restri\u00e7\u00f5es de preced\u00eancia de ativa\u00e7\u00e3o dos po\u00e7os. Como a\ncurva de performance do po\u00e7o, que caracteriza sua resposta, \u00e9 n\u00e3o-linear, aplicamos a ela\num procedimento de lineariza\u00e7\u00e3o por partes. Ent\u00e3o utilizamos programa\u00e7\u00e3o linear inteira\nmista, que possui um grande ferramental te\u00f3rico e algor\u00edtmico. Este problema pertence a\nclasse NP-Dif\u00edcil, ent\u00e3o apresentamos um procedimento para obten\u00e7\u00e3o de cortes que ace-\nlera a busca da resposta \u00f3tima. Experimentos computacionais mostraram que estes cortes\npodem reduzir o n\u00famero de itera\u00e7\u00f5es do algoritmo de otimiza\u00e7\u00e3o. A programa\u00e7\u00e3o inteira\nmista tamb\u00e9m nos garante que a solu\u00e7\u00e3o \u00f3tima global seja obtida, e permite uma medida\nda qualidade da solu\u00e7\u00e3o pelos limites primal-dual, caso a execu\u00e7\u00e3o do algoritmo seja inter-\nrompida. Desenvolvemos tamb\u00e9m uma interface de otimiza\u00e7\u00e3o para o usu\u00e1rio, que permite\nque ele especifique uma inst\u00e2ncia de um problema de aloca\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o e obtenha a\nsolu\u00e7\u00e3o \u00f3tima, sem que para isto ele necessite conhecer detalhes do modelo e do algoritmo\nde resolu\u00e7\u00e3o do problema.\n\niv\n\n\n\nAbstract of dissertation presented to UFSC as a partial fulfillment of the requirements for the degree\nof Master in Electrical Engineering.\n\nLIFT-GAS ALLOCATION TO OIL WELLS UNDER\nPRECEDENCE CONSTRAINTS: PIECEWISE\n\nLINEARIZATION AND INTEGER PROGRAMMING\n\nAugusto Marasca de Conto\n\nSeptember/2006\n\nAdvisor: Eduardo Camponogara\nArea of Concentration: Automation and Systems Engineering\nKey words: Oil fields, lift-gas allocation, piecewise linear formulation, mixed-integer programming,\npolyhedral theory, precedence constraints\nNumber of Pages: xi + 94\n\nOptimum lift-gas allocation searches gas injection rates for wells in gas-lifted oil fields that\n\noptimizes an objective, generally profit. Despite the long interest, most of the literature lack\n\nrigor, producing sub-optimal solutions and not treating explicitly discrete decisions and well\n\nactivation and deactivation. In this work, we present a formulation for optimum lift-gas al-\n\nlocation with maximum available gas and activation precedence constraints. We use mixed\n\ninteger linear programming with piecewise linearization of the well performance curves, be-\n\ncause of its great theoretical and algorithmic possibilities. This problem belongs to the NP-\n\nHard class, thus we propose a procedure to obtain cutting planes that accelerates the search\n\nfor the optimum allocation. Computational experiments showed that these cuts can reduce\n\nthe number of algorithmic iterations. Mixed integer programming also produces globally\n\noptimum solutions and gives a measure of the solution quality by the primal-dual bounds,\n\nin case of the algorithmic execution is interrupted. We also have developed an optimiza-\n\ntion interface that allows the user to specify an instance of the lift-gas allocation problem\n\nand obtain its solution, without necessarily knowing details of the model and the resolution\n\nalgorithm.\n\nv\n\n\n\nSum\u00e1rio\n\n1 Introdu\u00e7\u00e3o 1\n\n1.1 Problem\u00e1tica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1\n\n1.2 Objetivos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2\n\n1.3 Vis\u00e3o geral da disserta\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2\n\n2 O problema de aloca\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o 3\n\n2.1 Ciclo de vida de campos de petr\u00f3leo . . . . . . . . . . . . . . . . . . . . . . . . . . 3\n\n2.2 Eleva\u00e7\u00e3o artificial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5\n\n2.3 Aloca\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9\n\n2.4 Revis\u00e3o da literatura . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11\n\n2.5 Sum\u00e1rio . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n\n3 Fundamentos de otimiza\u00e7\u00e3o inteira 14\n\n3.1 Introdu\u00e7\u00e3o \u00e0 otimiza\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14\n\n3.2 Programa\u00e7\u00e3o inteira . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18\n\n3.2.1 Formula\u00e7\u00f5es . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18\n\n3.2.2 Introdu\u00e7\u00e3o a algoritmos . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n\n3.3 M\u00e9todos de planos de corte . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26\n\n3.3.1 Desigualdades v\u00e1lidas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26\n\n3.3.2 Coberturas para mochila . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27\n\n3.3.3 Lifting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29\n\n3.3.4 Down-lifting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n\nvi\n\n\n\n3.4 O problema da mochila com restri\u00e7\u00f5es de preced\u00eancia . . . . . . . . . . . . . . . . . 32\n\n3.4.1 Defini\u00e7\u00e3o do problema . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33\n\n3.4.2 K-coberturas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34\n\n3.4.3 Lifting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35\n\n3.5 Lineariza\u00e7\u00e3o por partes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36\n\n3.5.1 Modelo com pesos por ponto (Modelo I) . . . . . . . . . . . . . . . . . . . 36\n\n3.5.2 Modelo seq\u00fcencial de pesos (Modelo II) . . . . . . . . . . . . . . . . . . . . 38\n\n3.5.3 Modelo de Sherali (Modelo III) . . . . . . . . . . . . . . . . . . . . . . . . 40\n\n3.6 Sum\u00e1rio . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42\n\n4 Modelo linear por partes 44\n\n4.1 Formula\u00e7\u00e3o do problema . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44\n\n4.2 Desigualdades v\u00e1lidas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47\n\n4.2.1 Coberturas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47\n\n4.2.2 K-Coberturas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49\n\n4.3 Fatores de lifting para K-coberturas . . . . . . . . . . . . . . . . . . . . . . . . . . 53\n\n4.4 Fatores de pseudo-lifting para K-coberturas . . . . . . . . . . . . . . . . . . . . . . 56\n\n4.5 Resultados computacionais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62\n\n4.6 Sum\u00e1rio . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66\n\n5 Interface de otimiza\u00e7\u00e3o 67\n\n5.1 Ambiente de especifica\u00e7\u00e3o do problema . . . . . . . . . . . . . . . . . . . . . . . . 68\n\n5.1.1 Estrutura de dados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70\n\n5.1.2 Ajuste de curvas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71\n\n5.1.3 Padr\u00e3o dos arquivos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74\n\n5.2 Servidor de otimiza\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76\n\n5.2.1 Gerenciador de inst\u00e2ncias . . . . . . . . . . . . . . . . . . . . . . . . . . . 77\n\n5.2.2 Interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78\n\n5.3 Estudo de caso . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79\n\n5.4 Sum\u00e1rio . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81\n\nvii\n\n\n\n6 Conclus\u00f5es e trabalhos futuros 83\n\nA Fatores de lifting exatos para uma floresta 85\n\nB Modelo linear por partes considerando concavidade 88\n\nB.1 Exemplo ilustrativo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89\n\nviii\n\n\n\nLista de Figuras\n\n2.1 Etapas de produ\u00e7\u00e3o de um campo de petr\u00f3leo . . . . . . . . . . . . . . . . . . . . . 4\n\n2.2 Po\u00e7o operado por gas-lift . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6\n\n2.3 Curvas t\u00edpicas de gas-lift . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7\n\n2.4 Lineariza\u00e7\u00e3o por partes da curva de performance do po\u00e7o . . . . . . . . . . . . . . . 8\n\n2.5 Conjunto de po\u00e7os de petr\u00f3leo produzindo por gas-lift . . . . . . . . . . . . . . . . 8\n\n2.6 Exemplo de grafo de preced\u00eancia de ativa\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . 11\n\n3.1 Formula\u00e7\u00f5es para X . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19\n\n3.2 Exemplo ilustrativo do algoritmo de Branch and Bound . . . . . . . . . . . . . . . . 23\n\n3.3 Ilustra\u00e7\u00e3o do corte no problema da mochila com x1 = x3 = x4 = 0 e x6 = x7 = 1 . . . 25\n\n3.4 Exemplo de restri\u00e7\u00e3o de preced\u00eancia . . . . . . . . . . . . . . . . . . . . . . . . . . 33\n\n3.5 Lineariza\u00e7\u00e3o por partes para o modelo por pesos . . . . . . . . . . . . . . . . . . . . 37\n\n3.6 Lineariza\u00e7\u00e3o por partes para o modelo seq\u00fcencial . . . . . . . . . . . . . . . . . . . 39\n\n3.7 Lineariza\u00e7\u00e3o por partes para o modelo de Sherali . . . . . . . . . . . . . . . . . . . 41\n\n4.1 Lineariza\u00e7\u00e3o por partes da CPP de um po\u00e7o n. . . . . . . . . . . . . . . . . . . . . . 45\n\n4.2 Grafo de restri\u00e7\u00e3o de preced\u00eancia G = (V, E) . . . . . . . . . . . . . . . . . . . . . 48\n\n5.1 Ambiente de especifica\u00e7\u00e3o do problema . . . . . . . . . . . . . . . . . . . . . . . . 68\n\n5.2 Editor gr\u00e1fico . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69\n\n5.3 Diagrama de classes da estrutura de dados da interface . . . . . . . . . . . . . . . . 70\n\n5.4 Guia de caracteriza\u00e7\u00e3o de po\u00e7o com exemplo de ajuste de curva . . . . . . . . . . . 74\n\n5.5 Exemplo do formato de grava\u00e7\u00e3o dos dados . . . . . . . . . . . . . . . . . . . . . . 75\n\nix\n\n\n\n5.6 Exemplo de conex\u00e3o com o gerenciador de inst\u00e2ncias . . . . . . . . . . . . . . . . . 79\n\n5.7 Interface para o usu\u00e1rio do servidor de otimiza\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . 80\n\n5.8 Apresenta\u00e7\u00e3o da solu\u00e7\u00e3o de um problema . . . . . . . . . . . . . . . . . . . . . . . 81\n\nB.1 Exemplo de CPP considerando concavidade nas vari\u00e1veis de decis\u00e3o. . . . . . . . . 90\n\nx\n\n\n\nLista de Tabelas\n\n2.1 Comparativo entre alguns m\u00e9todos de eleva\u00e7\u00e3o artificial . . . . . . . . . . . . . . . . 5\n\n3.1 Exemplo de inst\u00e2ncia para o problema da mochila . . . . . . . . . . . . . . . . . . . 16\n\n3.2 Solu\u00e7\u00e3o para uma inst\u00e2ncia do problema da mochila sem restri\u00e7\u00e3o de preced\u00eancia . . 33\n\n4.1 Taxa de inje\u00e7\u00e3o para os po\u00e7os de petr\u00f3leo . . . . . . . . . . . . . . . . . . . . . . . 48\n\n4.2 Fatores de lifting para o exemplo da mochila . . . . . . . . . . . . . . . . . . . . . . 55\n\n4.3 Recursos m\u00ednimos de ativa\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60\n\n4.4 Subconjuntos para ativa\u00e7\u00e3o de H(C) . . . . . . . . . . . . . . . . . . . . . . . . . . 60\n\n4.5 Coeficientes de pseudo-lifting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61\n\n4.6 Impacto dos planos de corte por taxa de inje\u00e7\u00e3o de g\u00e1s . . . . . . . . . . . . . . . . 63\n\n4.7 Impacto dos planos de corte por densidade do grafo . . . . . . . . . . . . . . . . . . 64\n\n5.1 Descri\u00e7\u00e3o dos campos de petr\u00f3leo para o estudo de caso . . . . . . . . . . . . . . . 80\n\nxi\n\n\n\nCap\u00edtulo 1\n\nIntrodu\u00e7\u00e3o\n\n1.1 Problem\u00e1tica\n\nNos dias atuais o petr\u00f3leo ainda \u00e9 a principal fonte de energia em nosso planeta. Apesar de estarem\n\nsurgindo novas tecnologias, ainda somos bastante dependentes da queima destes hidrocarbonetos.\n\nEste recurso ainda existe em grande quantidade em nosso planeta, mas \u00e9 uma fonte de energia n\u00e3o-\n\nrenov\u00e1vel e, em um horizonte de tempo n\u00e3o muito longo, este recurso se esgotar\u00e1. Uma conseq\u00fc\u00eancia\n\nnatural \u00e9 que conforme o extra\u00edmos, sua obten\u00e7\u00e3o se torna mais dif\u00edcil e cara, pois cada vez temos\n\nque busc\u00e1-lo em regi\u00f5es mais profundas (po\u00e7os mais longos) e menos acess\u00edveis (como o fundo do\n\noceano). A necessidade de novas fontes faz com que seja considerada a produ\u00e7\u00e3o de \u00f3leos de dif\u00edcil\n\nextra\u00e7\u00e3o devido \u00e0 sua densidade e viscosidade.\n\n\u00c9 cada vez mais necess\u00e1rio t\u00e9cnicas eficientes para a extra\u00e7\u00e3o e processamento do petr\u00f3leo. A oti-\n\nmiza\u00e7\u00e3o entra neste contexto com o objetivo de auxiliar a atingir o desempenho \u00f3timo dos processos\n\nexistentes.\n\nV\u00e1rias t\u00e9cnicas de eleva\u00e7\u00e3o artificial podem ser empregadas para trazer o petr\u00f3leo de um reserva-\n\nt\u00f3rio \u00e0 superf\u00edcie. Uma t\u00e9cnica bastante utilizada no Brasil e no mundo \u00e9 chamada de gas-lift, em que\n\ng\u00e1s \u00e9 injetado na base do po\u00e7o, diminuindo a press\u00e3o da coluna de fluido que auxilia sua produ\u00e7\u00e3o\n\nnatural. O g\u00e1s utilizado geralmente \u00e9 o g\u00e1s produzido pelo po\u00e7o junto com o petr\u00f3leo, que \u00e9 compri-\n\nmido e reinjetado. O po\u00e7o possui uma taxa de produ\u00e7\u00e3o de acordo com a quantidade de g\u00e1s injetado.\n\nA rela\u00e7\u00e3o entre a quantia de g\u00e1s injetada em um po\u00e7o e sua produ\u00e7\u00e3o \u00e9 conhecida como Curva de\n\nPerformance do Po\u00e7o. Cada po\u00e7o possui uma taxa de inje\u00e7\u00e3o de g\u00e1s que o levar\u00e1 a uma produ\u00e7\u00e3o\n\nmais lucrativa, assim como existem taxas de inje\u00e7\u00e3o para cada um dos po\u00e7os que levar\u00e3o o campo de\n\npetr\u00f3leo a obter seu maior lucro. N\u00e3o necessariamente as taxas que levam o campo a sua condi\u00e7\u00e3o de\n\nmaior lucro s\u00e3o as mesmas de cada po\u00e7o separadamente.\n\nUm dos custos que envolvem a opera\u00e7\u00e3o de um campo de gas-lift \u00e9 o da compress\u00e3o do g\u00e1s. O\n\nequipamento de compress\u00e3o representa o maior custo na opera\u00e7\u00e3o do campo, portanto \u00e9 importante\n\nque o g\u00e1s de inje\u00e7\u00e3o seja utilizado da maneira mais eficiente poss\u00edvel [1]. Outra situa\u00e7\u00e3o ocorre em\n\nreservat\u00f3rios maduros, em que o petr\u00f3leo est\u00e1 terminando e o n\u00famero de po\u00e7os \u00e9 grande. Nestes\n\n\n\n1. Introdu\u00e7\u00e3o 2\n\ncampos, n\u00e3o apenas \u00e9 necess\u00e1rio determinar em que ponto de produ\u00e7\u00e3o os po\u00e7os ir\u00e3o operar, mas\n\ntamb\u00e9m deve ser decidido quais po\u00e7os ir\u00e3o operar. O operador pode desejar priorizar alguns po\u00e7os,\n\nfazendo com que outros s\u00f3 sejam ativados (entrem em opera\u00e7\u00e3o) se os de maior prioridade j\u00e1 estive-\n\nrem produzindo. A esta ordem de ativa\u00e7\u00e3o dos po\u00e7os, damos o nome de Restri\u00e7\u00e3o de Preced\u00eancia.\n\n1.2 Objetivos\n\nNesta disserta\u00e7\u00e3o apresentamos uma maneira de obter as taxas de inje\u00e7\u00e3o de g\u00e1s que levem um\n\ncampo de petr\u00f3leo com po\u00e7os operados por gas-lift ao \u00f3timo econ\u00f4mico. Consideramos que a capa-\n\ncidade de g\u00e1s \u00e9 limitada, n\u00e3o necessariamente existe g\u00e1s dispon\u00edvel para que todos os po\u00e7os operem\n\nem suas regi\u00f5es de maior lucratividade. Consideramos tamb\u00e9m as restri\u00e7\u00f5es de preced\u00eancia, limites\n\nm\u00ednimos e m\u00e1ximos de opera\u00e7\u00e3o dos po\u00e7os e que eles possam ser desativados.\n\nPara o desenvolvimento deste trabalho foi utilizada uma modelagem de otimiza\u00e7\u00e3o baseada em\n\nprograma\u00e7\u00e3o linear inteira. Existem algoritmos para modelos desta categoria que em princ\u00edpio s\u00e3o\n\ncapazes de gerar uma solu\u00e7\u00e3o \u00f3tima global. Como a curva de performance do po\u00e7o possui caracte-\n\nr\u00edstica n\u00e3o linear, foi feita uma lineariza\u00e7\u00e3o por partes, aproximando a curva por v\u00e1rios segmentos de\n\nreta.\n\nTamb\u00e9m desenvolvemos uma interface que permite que o usu\u00e1rio caracterize seu campo de petr\u00f3-\n\nleo, e invoque automaticamente algoritmos de otimiza\u00e7\u00e3o; n\u00e3o apenas o apresentado neste trabalho\n\ncomo outros. A interface tem como objetivo abstrair do usu\u00e1rio a compreens\u00e3o do funcionamento\n\ndos algoritmos, fazendo com que ele se preocupe apenas com a opera\u00e7\u00e3o de seu campo de petr\u00f3leo.\n\n1.3 Vis\u00e3o geral da disserta\u00e7\u00e3o\n\nEsta disserta\u00e7\u00e3o est\u00e1 dividida em seis cap\u00edtulos. No pr\u00f3ximo cap\u00edtulo apresentamos mais deta-\n\nlhadamente o cen\u00e1rio que pretendemos abordar, com um detalhamento da opera\u00e7\u00e3o por gas-lift, uma\n\nformula\u00e7\u00e3o geral para o problema e um resumo dos trabalhos existentes nesta \u00e1rea. No Cap\u00edtulo\n\n3 fazemos uma breve revis\u00e3o dos fundamentos de otimiza\u00e7\u00e3o inteira, ferramenta que foi utilizada\n\npara o desenvolvimento do trabalho. O emprego da teoria de otimiza\u00e7\u00e3o apresentada no problema\n\nde aloca\u00e7\u00e3o \u00f3tima de g\u00e1s de inje\u00e7\u00e3o \u00e9 mostrado no Cap\u00edtulo 4. No Cap\u00edtulo 5 apresentamos a ferra-\n\nmenta desenvolvida para auxiliar o operador a resolver problemas desta classe. Por fim, no Cap\u00edtulo\n\n6 apresentamos as conclus\u00f5es deste trabalho e perspectivas para trabalhos futuro.\n\n\n\nCap\u00edtulo 2\n\nO problema de aloca\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o\n\n2.1 Ciclo de vida de campos de petr\u00f3leo\n\nH\u00e1 v\u00e1rios s\u00e9culos o petr\u00f3leo \u00e9 conhecido e utilizado. Povos antigos, como os Babil\u00f4nios, Eg\u00edp-\n\ncios, Gregos e Romanos o utilizavam para desde a pavimenta\u00e7\u00e3o de estradas at\u00e9 fins b\u00e9licos. Na\n\nAm\u00e9rica, tamb\u00e9m era conhecido pelos povos Incas e Maias. Naquela \u00e9poca, o petr\u00f3leo era retirado\n\nde exsuda\u00e7\u00f5es naturais, n\u00e3o sendo necess\u00e1rio a escava\u00e7\u00e3o para sua obten\u00e7\u00e3o.\n\nO in\u00edcio da era moderna do petr\u00f3leo se d\u00e1 em 1859, quando o primeiro po\u00e7o foi perfurado.\n\nDescobriu-se que este era um neg\u00f3cio bastante lucrativo, pois seus derivados substitu\u00edam o \u00f3leo de\n\nbaleia, utilizados na \u00e9poca para ilumina\u00e7\u00e3o, com custos de produ\u00e7\u00e3o bastante inferiores. Em seguida\n\na gasolina e o diesel, que eram derivados at\u00e9 ent\u00e3o desprezados, passaram a alimentar motores \u00e0\n\ncombust\u00e3o, adicionando expressivos lucros \u00e0 atividade.\n\nEm 1900 o m\u00e9todo de percuss\u00e3o para perfura\u00e7\u00e3o de po\u00e7os foi substitu\u00eddo pelo rotativo. Neste\n\nm\u00e9todo uma broca rotativa \u00e9 utilizada para escavar e perfurar as rochas at\u00e9 o reservat\u00f3rio. Ele permitiu\n\na escava\u00e7\u00e3o de po\u00e7os mais profundos e longos, e \u00e9 empregado at\u00e9 hoje com algumas varia\u00e7\u00f5es,\n\npodendo chegar a mais de 10.000 metros.\n\nO petr\u00f3leo tem origem a partir de mat\u00e9ria org\u00e2nica depositada junto com sedimentos. A intera\u00e7\u00e3o\n\ndestes elementos em condi\u00e7\u00f5es apropriadas de temperatura e press\u00e3o s\u00e3o essenciais para a forma\u00e7\u00e3o\n\nde hidrocarbonetos. O tipo do hidrocarboneto gerado, \u00f3leo ou g\u00e1s, depende da constitui\u00e7\u00e3o da mat\u00e9ria\n\norg\u00e2nica original e das condi\u00e7\u00f5es termoqu\u00edmicas presentes no processo.\n\nAp\u00f3s serem gerados, os hidrocarbonetos migram de sua rocha geradora por falhas geol\u00f3gicas,\n\nat\u00e9 encontrar uma armadilha geol\u00f3gica, uma rocha selante imperme\u00e1vel. A rocha reservat\u00f3rio deve\n\npossuir espa\u00e7os vazios (porosidade) e que eles estejam conectados (permeabilidade).\n\nA descoberta de uma jazida de petr\u00f3leo envolve um longo per\u00edodo de estudo de dados geof\u00edsicos\n\ne geol\u00f3gicos. Apenas ap\u00f3s estes estudos \u00e9 proposta a perfura\u00e7\u00e3o de um po\u00e7o pioneiro, que \u00e9 a etapa\n\nque exige mais investimentos do processo de prospec\u00e7\u00e3o. N\u00e3o se pode prever a exist\u00eancia de petr\u00f3leo,\n\napenas locais mais favor\u00e1veis para sua ocorr\u00eancia.\n\n\n\n2. O problema de aloca\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o 4\n\nProdu\u00e7\u00e3o\n\nPr\u00e9-produ\u00e7\u00e3o Constru\u00e7\u00e3o Plat\u00f4 Decl\u00ednio Decomposi\u00e7\u00e3o\n\nTempo\n\nFigura 2.1: Etapas de produ\u00e7\u00e3o de um campo de petr\u00f3leo\n\nOs estudos geol\u00f3gicos s\u00e3o realizados por t\u00e9cnicas como a geologia de superf\u00edcie, que mapeia as\n\nrochas da superf\u00edcie da \u00e1rea em estudo; a aerofotometria e fotogeologia, que constr\u00f3i mapas geol\u00f3-\n\ngicos a partir de imagens do terreno; e a geologia de sub-superf\u00edcie, que consiste no estudo de dados\n\ngeol\u00f3gicos obtidos em um po\u00e7o explorat\u00f3rio. Tamb\u00e9m s\u00e3o empregados m\u00e9todos s\u00edsmicos, que con-\n\nsistem em gerar ondas s\u00edsmicas e mapear sua reflex\u00e3o no tempo e espa\u00e7o, para o levantamento da\n\nestrutura geol\u00f3gica do interior da \u00e1rea em estudo. Mais de 90% dos investimentos em prospec\u00e7\u00e3o s\u00e3o\n\naplicados \u00e0 s\u00edsmica de reflex\u00e3o [2].\n\nUma vez encontrado o petr\u00f3leo, ainda \u00e9 necess\u00e1rio estudos para se levantar o tamanho, forma e\n\nprodutividade do ac\u00famulo. Conhecendo-se o campo, \u00e9 feito um estudo de viabilidade de explora\u00e7\u00e3o\n\ndo reservat\u00f3rio. Neste estudo consideram-se a viabilidade econ\u00f4mica, op\u00e7\u00f5es de desenvolvimento do\n\ncampo, equipamentos de produ\u00e7\u00e3o e log\u00edstica de evacua\u00e7\u00e3o da produ\u00e7\u00e3o. Em seguida, \u00e9 realizado um\n\nplano de desenvolvimento que serve de base para as a\u00e7\u00f5es tomadas sobre o campo. Seu prop\u00f3sito \u00e9\n\num projeto conceitual do equipamento a ser empregado e da pol\u00edtica de opera\u00e7\u00e3o para que os objetivos\n\nde produ\u00e7\u00e3o sejam atingidos.\n\nA fase de produ\u00e7\u00e3o \u00e9 iniciada quando as primeiras quantidades comerciais de hidrocarbonetos s\u00e3o\n\nextra\u00eddas. \u00c9 o momento em que os investimentos come\u00e7am a ser recuperados. A Figura 2.1 mostra a\n\nprodu\u00e7\u00e3o em cada uma das etapas desta fase:\n\n1. Constru\u00e7\u00e3o: neste per\u00edodo os po\u00e7os rec\u00e9m perfurados s\u00e3o progressivamente colocados em seus\n\npontos de opera\u00e7\u00e3o;\n\n2. Plat\u00f4: novos po\u00e7os s\u00e3o trazidos aos seus pontos de opera\u00e7\u00e3o e os antigos come\u00e7am a declinar,\n\nmantendo a produ\u00e7\u00e3o total constante. Este per\u00edodo \u00e9 tipicamente de 2 a 5 anos para um campo\n\nde \u00f3leo e maior para campos de g\u00e1s [3];\n\n3. Decl\u00ednio: todos os produtores declinam sua produ\u00e7\u00e3o.\n\nA vida de um campo normalmente termina quando ele permanentemente gera preju\u00edzos. Ainda \u00e9\n\ntecnicamente poss\u00edvel continuar a produ\u00e7\u00e3o, mas economicamente invi\u00e1vel. Neste ponto, a redu\u00e7\u00e3o\n\ndo custo de opera\u00e7\u00e3o pode ser utilizada para aumentar o tempo de vida do campo.\n\n\n\n2. O problema de aloca\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o 5\n\nHaste Bomba El\u00e9trica Gas-Lift\nFlex\u00edvel Submers\u00edvel\n\nInstala\u00e7\u00e3o $ $$ $$$\nOpera\u00e7\u00e3o $ $$ $$\nProdu\u00e7\u00e3o (BPD1) 1 - 5.000 100 - 60.000 80 - 10.000\nFlexibilidade ++ - ++\nViscosidade + -\nS\u00f3lidos - - +\nG\u00e1s - - ++\nAlta temperatura + - +\nProfundidade -\nCurvas - +\noffshore - - + ++\n\nTabela 2.1: Comparativo entre alguns m\u00e9todos de eleva\u00e7\u00e3o artificial\n\n2.2 Eleva\u00e7\u00e3o artificial\n\nQuando um novo po\u00e7o de petr\u00f3leo \u00e9 perfurado inicialmente a press\u00e3o interna do reservat\u00f3rio \u00e9\n\nsuficiente para vencer a coluna de fluido e o \u00f3leo flui naturalmente para a superf\u00edcie, chamamos estes\n\npo\u00e7os de surgentes. Em decorr\u00eancia desta extra\u00e7\u00e3o natural, com o tempo, a press\u00e3o interna diminui e\n\nse torna necess\u00e1rio algum m\u00e9todo de eleva\u00e7\u00e3o artificial para extrair o \u00f3leo para a superf\u00edcie.\n\nA eleva\u00e7\u00e3o artificial n\u00e3o \u00e9 empregada apenas quando o po\u00e7o deixa de fluir naturalmente. Ela\n\ntamb\u00e9m pode ser usada para aumentar a produ\u00e7\u00e3o de um po\u00e7o de baixa vaz\u00e3o natural para um ponto\n\ndeterminado pelo plano de produ\u00e7\u00e3o. Podem ainda existir casos em que \u00e9 necess\u00e1rio apenas injetar\n\nenergia em uma fase inicial, para ativar o po\u00e7o, que em seguida passa a produzir naturalmente.\n\nExistem v\u00e1rios m\u00e9todos de eleva\u00e7\u00e3o artificial. A escolha do m\u00e9todo a ser empregado depende de\n\nfatores como: viscosidade, presen\u00e7a de s\u00f3lidos e composi\u00e7\u00e3o do fluido; temperatura, profundidade e\n\nforma do po\u00e7o (se possui curvas); se o po\u00e7o est\u00e1 localizado em terra (onshore) ou no mar (offshore);\n\nprodutividade, custo de instala\u00e7\u00e3o, equipamento auxiliar necess\u00e1rio e presen\u00e7a de infra-estrutura.\n\nPode-se ainda iniciar a extra\u00e7\u00e3o com um m\u00e9todo para po\u00e7os de maior produtividade e conforme a\n\nprodutividade do reservat\u00f3rio diminui, fazer a substitui\u00e7\u00e3o por outro m\u00e9todo. Alguns dos m\u00e9todos\n\ndispon\u00edveis hoje s\u00e3o mostrados a seguir. A Tabela 2.1 extra\u00edda de [3] mostra um comparativo entre\n\neles. O s\u00edmbolo \u201c$$$\u201d indica que o m\u00e9todo possui um custo maior que \u201c$$\u201d, que por sua vez \u00e9\n\nmaior que \u201c$\u201d. Os s\u00edmbolos \u201c- -\u201d \u00e0 \u201c++\u201d indicam de maneira crescente a adequa\u00e7\u00e3o do m\u00e9todo \u00e0s\n\ncaracter\u00edsticas apresentadas.\n\nHaste Flex\u00edvel: uma bomba na forma de um cilindro hidr\u00e1ulico \u00e9 posicionada no fundo do po\u00e7o.\n\nSeu \u00eambolo \u00e9 movido para cima e para baixo por uma haste, que \u00e9 acoplada a um motor el\u00e9trico\n\nlocalizado na superf\u00edcie. V\u00e1lvulas no cilindro controlam a entrada e sa\u00edda do fluido, o bombeando\n\npara a superf\u00edcie.\n\nBomba El\u00e9trica Submers\u00edvel: \u00e9 utilizada uma bomba centr\u00edfuga de v\u00e1rios est\u00e1gios, alimentada\n\n1BPD - Barrels Per Day, Barris por dia.\n\n\n\n2. O problema de aloca\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o 6\n\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n????\n\n?????\n?????\n?????\n?????\n?????\n?????\n?????\n?????\n?????\n?????\n?????\n?????\n\n?????\n?????\n?????\n?????\n?????\n?????\n?????\n?????\n?????\n?????\n?????\n?????\n\nTubo\n\nAnular\n\n\u00d3leo e G\u00e1s\nProduzidos\n\nReservat\u00f3rio\n\nG\u00e1s\n\nV\u00e1lvula\n\nFigura 2.2: Po\u00e7o operado por gas-lift\n\npor um motor el\u00e9trico. A produ\u00e7\u00e3o por este m\u00e9todo \u00e9 tamb\u00e9m determinada pelo n\u00famero de est\u00e1gios\n\nque a comp\u00f5em. Pode-se ainda instalar um variador da velocidade do motor que permite um ajuste\n\nna produ\u00e7\u00e3o do po\u00e7o, mas isto representa um custo adicional e nem sempre \u00e9 empregado.\n\nGas-Lift: um dos m\u00e9todos de eleva\u00e7\u00e3o artificial mais empregados \u00e9 o gas-lift cont\u00ednuo [4]. Neste\n\nm\u00e9todo g\u00e1s em alta press\u00e3o \u00e9 injetado continuamente no tubo de produ\u00e7\u00e3o, resultando na redu\u00e7\u00e3o da\n\ndensidade da coluna de fluido, e assim reduzindo a diferen\u00e7a de press\u00e3o entre o topo e o fundo do\n\npo\u00e7o, estimulando a produ\u00e7\u00e3o natural.\n\nA Figura 2.2 (retirada de [5]) mostra um po\u00e7o operando por gas-lift. As v\u00e1lvulas localizadas ao\n\nlongo do tubo de produ\u00e7\u00e3o s\u00e3o necess\u00e1rias apenas para o in\u00edcio da opera\u00e7\u00e3o do po\u00e7o. A descarga\n\ndo po\u00e7o consiste em retirar o fluido presente na coluna de produ\u00e7\u00e3o e/ou anular para colocar o po\u00e7o\n\nem produ\u00e7\u00e3o. Inicialmente todas as v\u00e1lvulas est\u00e3o abertas. Conforme o g\u00e1s \u00e9 injetado no anular h\u00e1\n\numa transfer\u00eancia de fluido dele para dentro do tubo de produ\u00e7\u00e3o. Quando o n\u00edvel do fluido no anular\n\nbaixar da altura da v\u00e1lvula, esta deve ser fechada para que o processo se mantenha nas outras v\u00e1lvulas\n\ne o g\u00e1s n\u00e3o entre diretamente no tubo de produ\u00e7\u00e3o. O fechamento das v\u00e1lvulas ocorre em seq\u00fc\u00eancia.\n\nQuando todo o fluido for expulso da regi\u00e3o anular apenas a \u00faltima v\u00e1lvula se mant\u00e9m aberta, iniciando\n\na produ\u00e7\u00e3o do po\u00e7o. Este procedimento deve ser realizado lentamente para n\u00e3o danificar as v\u00e1lvulas.\n\nUm po\u00e7o em opera\u00e7\u00e3o por gas-lift tem sua produ\u00e7\u00e3o controlada pela taxa de inje\u00e7\u00e3o de g\u00e1s apli-\n\ncada em sua base. A rela\u00e7\u00e3o entre a vaz\u00e3o de g\u00e1s injetado e a vaz\u00e3o de sa\u00edda de fluido qin \u00d7qout \u00e9\n\ndada pela curva de performance do po\u00e7o (CPP).\n\nA forma da curva depende da resposta do po\u00e7o ao g\u00e1s injetado. Na Figura 2.3(a), a curva A\n\nrepresenta um po\u00e7o surgente. A inje\u00e7\u00e3o de g\u00e1s em um po\u00e7o desta categoria aumenta sua produ\u00e7\u00e3o. A\n\ncurva B representa um po\u00e7o que n\u00e3o flui naturalmente, entretanto qualquer que seja a quantidade de\n\ng\u00e1s injetado j\u00e1 coloca o po\u00e7o em opera\u00e7\u00e3o. No caso da curva C, \u00e9 necess\u00e1rio um m\u00ednimo de inje\u00e7\u00e3o\n\n\n\n2. O problema de aloca\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o 7\n\nA\n\nB\n\nC\n\nD\n\nTaxa de inje\u00e7\u00e3o de g\u00e1s qin\n\nT\nax\n\na\nde\n\npr\nod\n\nu\u00e7\n\u00e3o\n\nde\n\u00f3l\n\neo\nq\n\no\nut\n\n(a)\n\nTaxa de inje\u00e7\u00e3o de g\u00e1s qin\n\nT\nax\n\na\nde\n\npr\nod\n\nu\u00e7\n\u00e3o\n\nde\n\u00f3l\n\neo\nq\n\no\nut\n\nqmaxout\n\nRegi\u00e3o\necon\u00f4mica\n\n(b)\n\nFigura 2.3: Curvas t\u00edpicas de gas-lift\n\nde g\u00e1s para iniciar a produ\u00e7\u00e3o. Por fim, a curva D \u00e9 semelhante a C, mas h\u00e1 um salto na produ\u00e7\u00e3o\n\ninicial para um valor maior que zero.\n\nDestacamos nas curvas C e D a presen\u00e7a de uma quantidade m\u00ednima de g\u00e1s injetado, que ocorre\n\ndevido a necessidade de vencer a coluna hidrost\u00e1tica que se forma no po\u00e7o, caracterizando um limite\n\ninferior na taxa de inje\u00e7\u00e3o. Tamb\u00e9m observamos que todas as curvas possuem um limite superior de\n\ng\u00e1s que pode ser injetado. Ele n\u00e3o deve ser ultrapassado pois a altas vaz\u00f5es o fluido produzido passa\n\na carregar s\u00f3lidos junto, que s\u00e3o prejudiciais aos equipamentos.\n\nAs CPPs possuem uma forma caracter\u00edstica que pode ser observada na Figura 2.3(b). A partir do\n\nponto em que existe produ\u00e7\u00e3o de fluido h\u00e1 um crescimento r\u00e1pido at\u00e9 uma vaz\u00e3o m\u00e1xima. Ap\u00f3s, a\n\ncurva cai lentamente at\u00e9 o limite superior de inje\u00e7\u00e3o. A regi\u00e3o econ\u00f4mica do gr\u00e1fico \u00e9 onde o po\u00e7o\n\nproduz com maior lucro. Considerando que n\u00e3o existe restri\u00e7\u00e3o de produ\u00e7\u00e3o, o ponto \u00f3timo \u00e9 quando\n\no lucro gerado por um incremento de produ\u00e7\u00e3o seja igual ao incremento no custo de opera\u00e7\u00e3o [6].\n\nA curva de performance do po\u00e7o pode ser obtida numericamente por simula\u00e7\u00f5es a partir de m\u00e9to-\n\ndos apropriados de c\u00e1lculo, como por exemplo a an\u00e1lise nodal [7]. Quando apenas pontos destas cur-\n\nvas s\u00e3o conhecidos ou podem ser obtidos a partir de experimentos de campo, s\u00e3o empregados m\u00e9todos\n\nde ajuste de curvas para o levantamento delas. Para problemas de otimiza\u00e7\u00e3o cl\u00e1ssica modelam-se as\n\nCPPs como polin\u00f4mios de terceira ordem. Entretanto, apesar de serem mais facilmente trat\u00e1veis, o\n\najuste em curvas deste tipo n\u00e3o apresenta uma boa correla\u00e7\u00e3o. Alarc\u00f3n et al. [8] prop\u00f5em, em seu tra-\n\nbalho de aloca\u00e7\u00e3o \u00f3tima de lift-gas utilizando programa\u00e7\u00e3o n\u00e3o-linear, que a curva seja representada\n\npor um polin\u00f4mio de segunda ordem, acrescido de um termo logar\u00edtmico:\n\nqout = c1 + c2qin + c3q\n2\nin + c4 ln(qin + 1)\n\nonde c1, c2, c3 e c4 s\u00e3o as constantes que caracterizam o po\u00e7o. Outra representa\u00e7\u00e3o desta curva foi\n\nproposta por Nakashima e Camponogara [9], utilizando a composi\u00e7\u00e3o de duas exponenciais:\n\nqout = ?1(2?e??1qin )??2e?2 qin\n\nEstas curvas apresentam melhor correla\u00e7\u00e3o que a polinomial pura, sendo que a baseada em exponen-\n\nciais se mant\u00e9m fiel tamb\u00e9m na extrapola\u00e7\u00e3o. Uma propriedade interessante da curva exponencial \u00e9\n\n\n\n2. O problema de aloca\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o 8\n\nTaxa de inje\u00e7\u00e3o de g\u00e1s qi\nT\n\nax\na\n\nde\npr\n\nod\nu\u00e7\n\n\u00e3o\nde\n\n\u00f3l\neo\n\nq\no\n\nFigura 2.4: Lineariza\u00e7\u00e3o por partes da curva de performance do po\u00e7o\n\nPo\u00e7os\nSeparador\n\nCompressores\nReservat\u00f3rio\n\nV\u00e1lvulas\n\ng\u00e1s\n\n\u00f3leo\n\u00e1gua\n\nFigura 2.5: Conjunto de po\u00e7os de petr\u00f3leo produzindo por gas-lift\n\nque d\n2 qout\ndq2in\n\n= ??1?21e\n??1qin ??2?22e\n\n??2 qin . Para que a CPP seja c\u00f4ncava, basta garantir que ?1 > 0 e\n?2 > 0.\n\nNeste trabalho utilizamos uma abordagem linear por partes. Cada par de pontos consecutivos da\n\ncurva \u00e9 interpolado por uma reta como pode ser visto na Figura 2.4. Esta t\u00e9cnica permite que sejam\n\nempregados m\u00e9todos de programa\u00e7\u00e3o linear. Em contrapartida, faz-se necess\u00e1rio o uso de vari\u00e1veis\n\nde decis\u00e3o para selecionar a regi\u00e3o da curva que est\u00e1 sendo trabalhada. Um aspecto relevante das\n\ncurvas lineares por partes \u00e9 que elas permitem utilizar os pontos de teste diretamente, sem a neces-\n\nsidade de ajustar uma curva, o que pode ser tedioso e envolver problemas de otimiza\u00e7\u00e3o n\u00e3o-linear\n\nsob restri\u00e7\u00f5es. Os testes para obten\u00e7\u00e3o destes pontos s\u00e3o realizados na fase inicial de produ\u00e7\u00e3o do\n\npo\u00e7o, antes da extra\u00e7\u00e3o das quantidades comerciais, quando est\u00e1 sendo levantado o perfil de produ-\n\n\u00e7\u00e3o do po\u00e7o e do reservat\u00f3rio. S\u00e3o medidas as quantidades de \u00f3leo, g\u00e1s e \u00e1gua produzidas para um\n\nconjunto adequado de taxas de inje\u00e7\u00e3o. Uma formula\u00e7\u00e3o mais detalhada da lineariza\u00e7\u00e3o por partes\n\npara descrever as CPPs ser\u00e1 apresentada no Cap\u00edtulo 4.\n\nNa Figura 2.5 apresentamos um esquema de um campo de petr\u00f3leo com po\u00e7os operados por gas-\n\nlift. Um banco de compressores produz g\u00e1s a alta press\u00e3o, que \u00e9 armazenado em um reservat\u00f3rio.\n\nV\u00e1lvulas controlam a quantidade de g\u00e1s injetado em cada po\u00e7o. O petr\u00f3leo produzido \u00e9 levado a um\n\nseparador que divide o fluido em \u00e1gua, \u00f3leo e g\u00e1s. A \u00e1gua extra\u00edda sofre um processo de tratamento\n\npara atender determinadas especifica\u00e7\u00f5es, regulamentadas por \u00f3rg\u00e3os de controle do meio ambiente,\n\nlimitando a quantidade de poluentes como o teor de \u00f3leo e sulfato de hidrog\u00eanio antes de ser descar-\n\ntada [2]. O \u00f3leo produzido \u00e9 armazenado e vendido. Uma parcela do g\u00e1s \u00e9 comprimida novamente\n\npara ser reinjetada nos po\u00e7os. O excedente pode ser armazenado ou escoado, ou se n\u00e3o existir maneira\n\n\n\n2. O problema de aloca\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o 9\n\nde faz\u00ea-lo, \u00e9 queimado.\n\nUma restri\u00e7\u00e3o tipicamente tratada nos problemas de aloca\u00e7\u00e3o \u00f3tima de gas-lift \u00e9 a capacidade total\n\nde inje\u00e7\u00e3o de g\u00e1s dos compressores. Nem sempre a planta possui g\u00e1s a alta press\u00e3o suficiente para\n\nque todos os po\u00e7os operem em seus pontos de maior lucratividade. Isto pode ocorrer, por exemplo,\n\nporque um compressor do conjunto est\u00e1 desligado para reparos ou manuten\u00e7\u00e3o. Outra possibilidade\n\n\u00e9 de um campo com muitos po\u00e7os, em que o petr\u00f3leo no reservat\u00f3rio est\u00e1 terminando, devendo-se\n\nescolher quais os po\u00e7os ser\u00e3o ativados.\n\nNa realidade, o c\u00e1lculo das taxas de inje\u00e7\u00e3o \u00f3timas n\u00e3o \u00e9 a \u00fanica ferramenta utilizada na deter-\n\nmina\u00e7\u00e3o dos pontos de opera\u00e7\u00e3o dos po\u00e7os. S\u00e3o considerados outros aspectos como, por exemplo, o\n\nplano de recupera\u00e7\u00e3o do reservat\u00f3rio. O comportamento do ac\u00famulo em longo prazo, sua din\u00e2mica,\n\ndeve ser considerado para que uma extra\u00e7\u00e3o inapropriada de alguns po\u00e7os n\u00e3o deixem regi\u00f5es do\n\nreservat\u00f3rio com \u00f3leo acumulado que n\u00e3o possa ser extra\u00eddo. Assim, restri\u00e7\u00f5es de preced\u00eancia de\n\nativa\u00e7\u00e3o podem ser utilizadas para representar estes aspectos subjetivos. Elas significam que um dado\n\npo\u00e7o s\u00f3 pode ser ativado se um outro, seu predecessor na restri\u00e7\u00e3o, j\u00e1 esteja produzindo pelo menos\n\nseu m\u00ednimo. \u00c9 claro que estas restri\u00e7\u00f5es s\u00f3 fazem sentido em po\u00e7os n\u00e3o surgentes.\n\n2.3 Aloca\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o\n\nA aloca\u00e7\u00e3o \u00f3tima de gas-lift busca taxas de inje\u00e7\u00e3o de g\u00e1s para cada um dos po\u00e7os de um campo\n\nque maximize ou minimize algum objetivo. Duas abordagens s\u00e3o mais comumente utilizadas: a\n\nprimeira \u00e9 baseada na performance hidrodin\u00e2mica, onde se buscam pontos de opera\u00e7\u00e3o para os po\u00e7os\n\nque maximizem a produ\u00e7\u00e3o total do campo; outra abordagem \u00e9 baseada em um crit\u00e9rio econ\u00f4mico,\n\na qual busca o maior lucro que um conjunto de po\u00e7os pode fornecer. Ainda s\u00e3o poss\u00edveis outras\n\nabordagens como, por exemplo, a minimiza\u00e7\u00e3o do custo de opera\u00e7\u00e3o sujeita a uma quota m\u00ednima\n\nprodu\u00e7\u00e3o.\n\nEmbora neste trabalho utilizamos a abordagem baseada no crit\u00e9rio econ\u00f4mico, ela pode ser adap-\n\ntada facilmente para minimizar os custos de produ\u00e7\u00e3o da quota m\u00ednima. Assim, nossa formula\u00e7\u00e3o\n\nnecessita de informa\u00e7\u00f5es como custos de produ\u00e7\u00e3o e lucros obtidos. \u00c9 importante salientar que esta-\n\nmos interessados na opera\u00e7\u00e3o do campo de petr\u00f3leo, por isso quest\u00f5es externas a ele, como situa\u00e7\u00e3o\n\ndo mercado, n\u00e3o s\u00e3o consideradas.\n\nComo foi visto na se\u00e7\u00e3o anterior, dois tipos de restri\u00e7\u00e3o podem ser considerados quando estamos\n\ntratando este problema: capacidade m\u00e1xima de inje\u00e7\u00e3o de g\u00e1s, que \u00e9 uma restri\u00e7\u00e3o decorrente das\n\ncapacidades dos compressores; e restri\u00e7\u00f5es de preced\u00eancia, que restringe a ativa\u00e7\u00e3o de um dado po\u00e7o\n\nem decorr\u00eancia de outros. Considerando nosso objetivo econ\u00f4mico e estas restri\u00e7\u00f5es do sistema,\n\n\n\n2. O problema de aloca\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o 10\n\nchegamos \u00e0 seguinte formula\u00e7\u00e3o:\n\nP(G) : Maximize f =\nN\n\n?\nn=1\n\n(po?no + pg?\nn\ng ? pw?\n\nn\nw)q\n\nn\nout ?\n\nN\n\n?\nn=1\n\npinq\nn\nin\n\nSujeito a: qnout = q?\nn\nout (q\n\nn\nin) n = 1, . . . , N\n\nN\n\n?\nn=1\n\nqnin 6 q\nmax\nin\n\nyn 6 ym ?(m, n) ? E(G)\n\nlnyn 6 q\nn\nin 6 unyn n = 1, . . . , N\n\nyn ?{0, 1} n = 1, . . . , N\n\nonde:\n\n\u2022 N \u00e9 o n\u00famero de po\u00e7os que produzem via gas-lift;\n\n\u2022 qnin \u00e9 a taxa de inje\u00e7\u00e3o de g\u00e1s alocada para o po\u00e7o n;\n\n\u2022 qnout \u00e9 a taxa de produ\u00e7\u00e3o de fluidos do po\u00e7o n, dada pela fun\u00e7\u00e3o q?\nn\nout (q\n\nn\nin);\n\n\u2022 po e pg representam o lucro (pre\u00e7o de venda menos os custos de processamento) obtido por\n\nbarril de \u00f3leo e g\u00e1s vendido, respectivamente;\n\n\u2022 pw \u00e9 o custo de tratamento do barril de \u00e1gua a ser descartada;\n\n\u2022 pin representa o custo de compress\u00e3o de g\u00e1s;\n\n\u2022 ?no, ?\nn\ng e ?\n\nn\nw s\u00e3o respectivamente as fra\u00e7\u00f5es de \u00f3leo, g\u00e1s e \u00e1gua produzidas pelo po\u00e7o n, sendo\n\nque ?no + ?\nn\ng + ?\n\nn\nw = 1;\n\n\u2022 q?nout (q\nn\nin) \u00e9 curva de performance do po\u00e7o n, que relaciona a quantidade de g\u00e1s injetado com a\n\nquantidade de fluido produzido no po\u00e7o;\n\n\u2022 qmaxin \u00e9 a capacidade total de inje\u00e7\u00e3o de g\u00e1s, sendo que a soma das taxas de inje\u00e7\u00e3o de g\u00e1s dos\n\nN po\u00e7os n\u00e3o deve ultrapassar esta taxa;\n\n\u2022 yn assume valor 1 se o po\u00e7o n est\u00e1 ativo, e 0 caso contr\u00e1rio;\n\n\u2022 G \u00e9 um grafo direcionado ac\u00edclico que representa as restri\u00e7\u00f5es de preced\u00eancia. Seus v\u00e9rtices\n\ns\u00e3o o conjunto dos N po\u00e7os do campo e suas arestas s\u00e3o dadas por E(G). A Figura 2.6 apresenta\n\num exemplo de um grafo de preced\u00eancia. Nela, os po\u00e7os 1 e 3 podem ser ativados livremente,\n\no po\u00e7o 2 requer que o de n\u00famero 1 j\u00e1 esteja ativado pelo menos em seu m\u00ednimo, e assim\n\nsucessivamente;\n\n\u2022 ln e un s\u00e3o respectivamente as taxas de inje\u00e7\u00e3o m\u00ednima e m\u00e1xima para o po\u00e7o n.\n\nProposi\u00e7\u00e3o 2.1 P(G) \u00e9 NP-Dif\u00edcil no sentido forte [9].\n\n\n\n2. O problema de aloca\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o 11\n\n1\n\n2 3\n\n4 5 6\n\nFigura 2.6: Exemplo de grafo de preced\u00eancia de ativa\u00e7\u00e3o\n\nA Proposi\u00e7\u00e3o 2.1 evidencia o grau de dificuldade do problema em considera\u00e7\u00e3o. Ou seja, existe\n\num algoritmo de tempo pseudo-polinomial se e somente se a classe P equivale a classe NP [10];\n\n2.4 Revis\u00e3o da literatura\n\nMayhill [11] analisou em seu trabalho a rela\u00e7\u00e3o entre a taxa de inje\u00e7\u00e3o de g\u00e1s e a produ\u00e7\u00e3o do\n\npo\u00e7o, chamando a curva resultante de curva de performance do po\u00e7o (CPP).\n\nDesde a d\u00e9cada de 70, problemas de inje\u00e7\u00e3o \u00f3tima de g\u00e1s v\u00eaem sendo abordados. Redden et al.\n\n[12] reconheceu a import\u00e2ncia de uma opera\u00e7\u00e3o de um campo de gas-lift de acordo com crit\u00e9rios\n\necon\u00f4micos, em que leva em considera\u00e7\u00e3o o custo de compress\u00e3o, capacidade limitada de g\u00e1s e\n\na possibilidade de compressores estarem inoperantes. Tamb\u00e9m propuseram um procedimento para\n\nencontrar a distribui\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o que resulta em um maior lucro baseado na perturba\u00e7\u00e3o\n\niterativa da distribui\u00e7\u00e3o corrente. Apesar da qualidade da proposta iterativa, o procedimento pode\n\nproduzir solu\u00e7\u00f5es sub-\u00f3timas e n\u00e3o pode ser estendido para tratar outras restri\u00e7\u00f5es, como limites\n\ninferior e superior de g\u00e1s de inje\u00e7\u00e3o.\n\nMach et al. [7] redefiniram o m\u00e9todo de [12] com uma abordagem nodal que considera perdas de\n\npress\u00e3o em toda a coluna de gas-lift. Seu procedimento nodal leva a uma curva de performance do\n\npo\u00e7o mais precisa.\n\nKanu et al. [6] compilou os m\u00e9todos e princ\u00edpios anteriores de aloca\u00e7\u00e3o de gas-lift de acordo\n\ncom crit\u00e9rios econ\u00f4micos em um m\u00e9todo chamado equal slope. O m\u00e9todo pode obter a aloca\u00e7\u00e3o de\n\ng\u00e1s que produz maior lucro para um conjunto de po\u00e7os modelados por CPPs com capacidade de g\u00e1s\n\nlimitada. Este m\u00e9todo pode ser visto como a aplica\u00e7\u00e3o da dualidade Lagrangeana para eliminar a\n\nrestri\u00e7\u00e3o de capacidade de g\u00e1s. O m\u00e9todo possui limita\u00e7\u00f5es, incluindo a incapacidade de tratar po\u00e7os\n\nque n\u00e3o respondam instantaneamente \u00e0 inje\u00e7\u00e3o de g\u00e1s (limite inferior) e a dificuldade de incorporar\n\nrestri\u00e7\u00f5es adicionais.\n\nMais tarde, Nishikiori et al. [13, 14] apresentaram uma formula\u00e7\u00e3o n\u00e3o-linear sob restri\u00e7\u00f5es\n\npara aloca\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o, com um m\u00e9todo quasi-Newton combinado com um descenso pela\n\nproje\u00e7\u00e3o do gradiente para buscar a solu\u00e7\u00e3o \u00f3tima. O m\u00e9todo de Nishikiori et al. provou ser melhor\n\nque o equal slope, obtendo aloca\u00e7\u00e3o de maior lucro em tempo menor. Apesar da proposta ter imposto\n\n\n\n2. O problema de aloca\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o 12\n\nlimites n\u00e3o-lineares \u00e0s taxas de inje\u00e7\u00e3o, o m\u00e9todo pode divergir e n\u00e3o trata de po\u00e7os que n\u00e3o produzem\n\nespontaneamente.\n\nBuitrago et al. [4] est\u00e3o entre os pioneiros em tratar de cen\u00e1rios com po\u00e7os que n\u00e3o respondem\n\ninstantaneamente \u00e0 inje\u00e7\u00e3o de g\u00e1s. A abordagem, chamada de Ex-In, combina uma busca estoc\u00e1stica\n\ne uma heur\u00edstica de c\u00e1lculo de dire\u00e7\u00e3o de descenso. Por um lado, o m\u00e9todo Ex-In utiliza um algoritmo\n\ngen\u00e9tico, no sentido que uma popula\u00e7\u00e3o de solu\u00e7\u00f5es evolui no tempo, mas por outro lado, utiliza uma\n\ndire\u00e7\u00e3o obtida de forma heur\u00edstica para produzir uma solu\u00e7\u00e3o candidata. A busca termina quando\n\na popula\u00e7\u00e3o de solu\u00e7\u00f5es n\u00e3o produz melhorias na solu\u00e7\u00e3o objetivo ou ap\u00f3s um n\u00famero m\u00e1ximo de\n\nitera\u00e7\u00f5es. Apesar da busca Ex-In ocorrer sobre o espa\u00e7o de solu\u00e7\u00f5es fact\u00edveis, ela n\u00e3o garante que o\n\n\u00f3timo global seja alcan\u00e7ado, e n\u00e3o possui um procedimento de obten\u00e7\u00e3o de um limite superior, que\n\npoderia ser utilizado para estimar a qualidade de sua solu\u00e7\u00e3o. Em um sistema com 56 po\u00e7os, uma\n\ncompara\u00e7\u00e3o computacional com o m\u00e9todo equal slope mostrou que o Ex-In obteve solu\u00e7\u00f5es melhores.\n\nAlarc\u00f3n et al. [8] introduziram curvas de performance de po\u00e7o com termos logar\u00edtmicos e po-\n\nlinomias de segunda ordem como um ajuste melhor que os polinomiais puros para representar os\n\ndados. Eles melhoraram o m\u00e9todo de Nishikiori et al. [14] substituindo o m\u00e9todo quasi-Newton\n\npelo algoritmo SQP (Sequential Quadratic Programming - Programa\u00e7\u00e3o Seq\u00fcencial Quadr\u00e1tica) para\n\ngarantir converg\u00eancia para uma solu\u00e7\u00e3o \u00f3tima local. O algoritmo SQP \u00e9 mais robusto e pode operar\n\ncom restri\u00e7\u00f5es adicionais, entretanto, a abordagem requer interven\u00e7\u00e3o dos engenheiros para tratar de\n\npo\u00e7os que n\u00e3o respondem imediatamente \u00e0 inje\u00e7\u00e3o de g\u00e1s. Assim, os autores propuseram regras ad\n\nhoc para guiar o engenheiro na decis\u00e3o de quais po\u00e7os devem ser ativados e desativados.\n\nFang e Lo [15] abandonaram os procedimentos baseados em programa\u00e7\u00e3o n\u00e3o linear e sugeriram\n\na lineariza\u00e7\u00e3o por partes das CPPs, reformulando o problema utilizando programa\u00e7\u00e3o linear. Esta\n\nvis\u00e3o trouxe uma s\u00e9rie de vantagens e abriu v\u00e1rias possibilidades. Primeiro, podemos obter solu\u00e7\u00f5es\n\n\u00f3timas globais com algoritmos poderosos de programa\u00e7\u00e3o linear, facilmente introduzir restri\u00e7\u00f5es adi-\n\ncionais e tratar de problemas muito grandes. Segundo, nos permite utilizar a teoria e algoritmos de\n\nprograma\u00e7\u00e3o linear inteira mista (MILP) para tratar de decis\u00f5es discretas. O m\u00e9todo de Fang e Lo\n\nsuperou os m\u00e9todos anteriores, mas eles n\u00e3o fizeram uso de toda a teoria para tratar problemas de\n\nprograma\u00e7\u00e3o inteira mista de maneira sistem\u00e1tica, sugerindo regras heur\u00edsticas, baseadas em arre-\n\ndondamento para tratar o problema de ativa\u00e7\u00e3o de po\u00e7os.\n\nWang et al. [16] sugeriram um modelo em programa\u00e7\u00e3o n\u00e3o linear inteira mista (MINLP) para\n\ngeneralizar a abordagem anterior. O modelo proposto incorpora as decis\u00f5es de aloca\u00e7\u00e3o de g\u00e1s de in-\n\nje\u00e7\u00e3o, decis\u00f5es sobre as taxas de produ\u00e7\u00e3o e restri\u00e7\u00f5es da planta de produ\u00e7\u00e3o. Como os problemas de\n\nprograma\u00e7\u00e3o n\u00e3o linear inteira mista s\u00e3o inerentemente dif\u00edceis de serem resolvidos, eles propuseram\n\numa combina\u00e7\u00e3o de programa\u00e7\u00e3o linear, programa\u00e7\u00e3o separ\u00e1vel e algoritmos gen\u00e9ticos. Apesar dos\n\nresultados experimentais terem sido satisfat\u00f3rios, o m\u00e9todo pode produzir solu\u00e7\u00f5es sub-\u00f3timas e n\u00e3o\n\nproduz limites superiores/inferiores que permitem avaliar a qualidade das solu\u00e7\u00f5es.\n\nNakashima e Camponogara [9, 17] desenvolveram algoritmos utilizando programa\u00e7\u00e3o din\u00e2mica\n\n(DP) para o problema de aloca\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o. Seus m\u00e9todos tratam as decis\u00f5es discretas de\n\nativa\u00e7\u00e3o dos po\u00e7os de maneira sistem\u00e1tica, e consideram incertezas nas CPPs, aceitando m\u00faltiplas\n\ncurvas e resolvendo problemas max-min, resultando em solu\u00e7\u00f5es pr\u00f3ximas \u00e0 \u00f3tima com garantias de\n\n\n\n2. O problema de aloca\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o 13\n\nperformance. Junto com o m\u00e9todo de MINLP proposto em [16], foi o primeiro a tratar rigorosamente\n\nas descontinuidades nas CPPs. O algoritmo de programa\u00e7\u00e3o din\u00e2mica pode tratar de restri\u00e7\u00f5es de\n\npreced\u00eancia de ativa\u00e7\u00e3o, com uma execu\u00e7\u00e3o em tempo pseudo-polinomial se as restri\u00e7\u00f5es possu\u00edrem a\n\nforma de uma floresta. Al\u00e9m da inexist\u00eancia de um algoritmo pseudo-polinomial para tratar de grafos\n\nde preced\u00eancia gerais, a limita\u00e7\u00e3o principal da abordagem em programa\u00e7\u00e3o din\u00e2mica \u00e9 a dificuldade\n\nde adicionar restri\u00e7\u00f5es.\n\n2.5 Sum\u00e1rio\n\nNeste cap\u00edtulo apresentamos uma vis\u00e3o geral sobre a forma\u00e7\u00e3o e opera\u00e7\u00e3o de um campo de pe-\n\ntr\u00f3leo. Apresentamos alguns dos m\u00e9todos utilizados para extrair o petr\u00f3leo para a superf\u00edcie e, em\n\nseguida, nos aprofundamos no m\u00e9todo de extra\u00e7\u00e3o por gas-lift, em que g\u00e1s \u00e9 injetado na base do po\u00e7o\n\npara diminuir a press\u00e3o da coluna e possibilitar que o petr\u00f3leo seja retirado. Em seguida apresentamos\n\no problema geral de aloca\u00e7\u00e3o \u00f3tima de g\u00e1s de inje\u00e7\u00e3o segundo crit\u00e9rios econ\u00f4micos, sob restri\u00e7\u00e3o de\n\nlimite de capacidade de inje\u00e7\u00e3o e preced\u00eancia na ativa\u00e7\u00e3o dos po\u00e7os. Por fim, apresentamos uma\n\nrevis\u00e3o bibliogr\u00e1fica, que contextualiza esta disserta\u00e7\u00e3o frente a outros trabalhos j\u00e1 publicados sobre\n\no assunto.\n\n\n\nCap\u00edtulo 3\n\nFundamentos de otimiza\u00e7\u00e3o inteira\n\n3.1 Introdu\u00e7\u00e3o \u00e0 otimiza\u00e7\u00e3o\n\nOtimiza\u00e7\u00e3o \u00e9 a \u00e1rea da matem\u00e1tica aplicada que busca obter valores para vari\u00e1veis de decis\u00e3o\n\ncom o objetivo de obter um comportamento \u00f3timo, sujeito a um conjunto de restri\u00e7\u00f5es do modelo\n\nmatem\u00e1tico. As vari\u00e1veis de decis\u00e3o s\u00e3o avaliadas a partir de algum crit\u00e9rio, que pode ser a maximi-\n\nza\u00e7\u00e3o ou minimiza\u00e7\u00e3o de uma fun\u00e7\u00e3o. Os pontos que atendem as restri\u00e7\u00f5es do problema s\u00e3o pontos\n\nfact\u00edveis, e seu conjunto \u00e9 denominado de regi\u00e3o fact\u00edvel do problema.\n\nModelos s\u00e3o estruturas que buscam representar alguma caracter\u00edstica de uma realidade. As raz\u00f5es\n\nque levam ao uso de modelos s\u00e3o as mais variadas. Dentre elas podemos citar: ajudam a compreender\n\nmelhor a natureza do objeto que est\u00e1 sendo estudado; experimentos realizados sobre o objeto em\n\nestudo possuem custos proibitivos ou at\u00e9 s\u00e3o imposs\u00edveis; podem-se realizar testes antes que o objeto\n\nem estudo seja constru\u00eddo. Modelos podem ser concretos, como uma miniatura de avi\u00e3o utilizada\n\nem testes em um t\u00fanel de vento. Modelos abstratos usualmente s\u00e3o representa\u00e7\u00f5es matem\u00e1ticas da\n\nrealidade em estudo. A modelagem de um problema n\u00e3o \u00e9 uma tarefa trivial, dependendo de fatores\n\nsubjetivos como intui\u00e7\u00e3o, experi\u00eancia, criatividade e poder de s\u00edntese [18, 19].\n\nPara modelar problemas de otimiza\u00e7\u00e3o \u00e9 utilizada uma linguagem conhecida como programa\u00e7\u00e3o\n\nmatem\u00e1tica. \u00c9 importante ressaltar que programa\u00e7\u00e3o matem\u00e1tica \u00e9 bastante diferente de programa\u00e7\u00e3o\n\nde computadores. Programa\u00e7\u00e3o matem\u00e1tica \u00e9 utilizada no sentido de \u201cplanejamento\u201d [18]. Inevitavel-\n\nmente programa\u00e7\u00e3o matem\u00e1tica envolve computa\u00e7\u00e3o, pois problemas pr\u00e1ticos normalmente possuem\n\ngrandes quantidades de dados e c\u00e1lculos que tornam necess\u00e1rio o emprego dos computadores. Os\n\nelementos que a comp\u00f5em s\u00e3o:\n\nVari\u00e1veis de decis\u00e3o: Vari\u00e1veis cujos valores definem uma solu\u00e7\u00e3o para o problema;\n\nFun\u00e7\u00e3o objetivo: Express\u00e3o que relaciona as vari\u00e1veis de decis\u00e3o com o comportamento do modelo.\n\n\u00c9 a fun\u00e7\u00e3o que se deseja maximizar ou minimizar;\n\nRestri\u00e7\u00f5es: Conjunto de fun\u00e7\u00f5es das vari\u00e1veis de decis\u00e3o que definem o espa\u00e7o de solu\u00e7\u00f5es que\n\npode ser aplicado ao problema.\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 15\n\nUm problema geral de otimiza\u00e7\u00e3o pode ser escrito em programa\u00e7\u00e3o matem\u00e1tica como:\n\nP : Maximize f (x)\n\nSujeito a: g(x) 6 0\n\nx ? Rn\n\nonde x \u00e9 o vetor de vari\u00e1veis de decis\u00e3o, f : Rn ?R \u00e9 a fun\u00e7\u00e3o objetivo e g : Rn ?Rp s\u00e3o as restri\u00e7\u00f5es\n\ndo problema que limitam o espa\u00e7o de solu\u00e7\u00f5es fact\u00edveis.\n\nAinda \u00e9 poss\u00edvel problemas sem fun\u00e7\u00e3o objetivo, onde se deseja apenas encontrar uma solu\u00e7\u00e3o\n\nque atenda as restri\u00e7\u00f5es. Por exemplo, montar a tabela de um campeonato de futebol obedecendo a\n\nrestri\u00e7\u00f5es como o limite de partidas consecutivas em um campo. E problemas com m\u00faltiplas fun\u00e7\u00f5es\n\nobjetivo. Por exemplo, em um problema de manufatura que se deseja maximizar o lucro e minimizar\n\no tempo de produ\u00e7\u00e3o.\n\nExemplo: O problema da mochila\n\nUm alpinista deseja escolher entre diversos itens quais levar para sua expedi\u00e7\u00e3o. Os objetos\n\ndevem ser escolhidos de forma que atenda ao m\u00e1ximo suas necessidades na escalada, sendo que eles\n\nn\u00e3o devem exceder a capacidade de sua mochila. Os dados do problema s\u00e3o:\n\n\u2022 N \u00e9 o n\u00famero de itens dispon\u00edveis;\n\n\u2022 cn \u00e9 um valor que representa a utilidade associada ao item n para a escalada;\n\n\u2022 b \u00e9 a capacidade total da mochila;\n\n\u2022 an \u00e9 o espa\u00e7o ocupado pelo item n;\n\nNa especifica\u00e7\u00e3o do problema, devemos definir as vari\u00e1veis de decis\u00e3o, a fun\u00e7\u00e3o objetivo e as\n\nrestri\u00e7\u00f5es:\n\nVari\u00e1veis de decis\u00e3o: xn assume valor 1 se o item n ser\u00e1 carregado na mochila, e 0 caso contr\u00e1rio;\n\nFun\u00e7\u00e3o objetivo: O valor total dos itens selecionados f (x) = ?Nn=1 cnxn deve ser maximizado.\n\nRestri\u00e7\u00f5es: O espa\u00e7o ocupado pelos itens selecionados n\u00e3o deve exceder a capacidade da mochila e\n\nas vari\u00e1veis de decis\u00e3o devem assumir valores bin\u00e1rios do conjunto B = {0, 1}.\n\nEm programa\u00e7\u00e3o matem\u00e1tica, o problema fica:\n\nPM : Maximize\nN\n\n?\nn=1\n\ncnxn\n\nSujeito a:\nN\n\n?\nn=1\n\nanxn 6 b\n\nxn ? B n = 1, . . . , N\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 16\n\nn item utilidade tamanho\n1 Fogareiro 2 5\n2 Corda 7 5\n3 Colchonete 2 4\n4 Ra\u00e7\u00e3o 4 3\n5 Primeiros Socorros 3 2\n6 Grampos 7 2\n7 Aparelho de GPS1 6 1\n\nTabela 3.1: Exemplo de inst\u00e2ncia para o problema da mochila\n\nDado o modelo, chamamos de inst\u00e2ncia o conjunto de dados que caracterizam um problema. Para\n\no exemplo da mochila uma inst\u00e2ncia \u00e9 dada na Tabela 3.1. Considerando a capacidade da mochila\n\nb = 6, obtemos a seguinte formula\u00e7\u00e3o em programa\u00e7\u00e3o matem\u00e1tica:\n\nMaximize 2x1 + 7x2 + 2x3 + 4x4 + 3x5 + 7x6 + 6x7 (3.1)\n\nSujeito a: 5x1 + 5x2 + 4x3 + 3x4 + 2x5 + 2x6 + x7 6 6\n\nx ? B7\n\nDependendo da natureza da fun\u00e7\u00e3o objetivo e das restri\u00e7\u00f5es, os problemas de otimiza\u00e7\u00e3o s\u00e3o\n\nclassificados em subdom\u00ednios.\n\nPrograma\u00e7\u00e3o Linear: \u00e9 uma classe de problemas de otimiza\u00e7\u00e3o onde tanto a fun\u00e7\u00e3o objetivo quanto\n\nas restri\u00e7\u00f5es s\u00e3o lineares. Matematicamente, esta classe de problemas \u00e9 representada por:\n\nPL : Maximize c\nT x\n\nSujeito a: Ax 6 b\n\nx ? Rn+\n\nonde b e c s\u00e3o vetores2 e A \u00e9 uma matriz. Problemas desta natureza s\u00e3o bastante empregados e\n\nbem resolvidos algoritmicamente, por meio do algoritmo Simplex e m\u00e9todos de ponto interior\n\n[20].\n\nPrograma\u00e7\u00e3o Linear Inteira: possui formula\u00e7\u00e3o semelhante \u00e0 Programa\u00e7\u00e3o Linear pois a fun\u00e7\u00e3o\n\nobjetivo e as restri\u00e7\u00f5es devem ser lineares. Entretanto, neste sub-dom\u00ednio da otimiza\u00e7\u00e3o as\n\nvari\u00e1veis de decis\u00e3o pertencem a um dom\u00ednio discreto.\n\nPI : Maximize c\nT x (3.2)\n\nSujeito a: Ax 6 b\n\nx ? Zn+\n\n1Global Positioning System, Sistema de Posicionamento Global.\n2Nesta disserta\u00e7\u00e3o utilizamos a nota\u00e7\u00e3o de matrizes coluna para os vetores.\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 17\n\nQuando as vari\u00e1veis de decis\u00e3o pertencem ao conjunto bin\u00e1rio Bn, pode-se dizer que o pro-\n\nblema \u00e9 de Programa\u00e7\u00e3o Bin\u00e1ria. \u00c9 empregada quando se deseja modelar problemas em que se\n\ndeve escolher entre uma ou outra alternativa, como no problema da mochila apresentado, tendo\n\nque decidir em carregar ou n\u00e3o o objeto; ou em problemas em que as vari\u00e1veis de decis\u00e3o de-\n\nvem ser necessariamente inteiras, n\u00e3o tendo sentido assumirem valores fracion\u00e1rios como, por\n\nexemplo, em uma montadora de ve\u00edculos que se deseja determinar a quantidade \u00f3tima a ser\n\nproduzida.\n\nPrograma\u00e7\u00e3o Linear \u00e9 NP-Dif\u00edcil, pois qualquer problema da classe NP-Completa pode ser\n\nreduzido a PI em tempo e espa\u00e7o polinomial, por exemplo, o problema de satisfatibilidade.\n\nPrograma\u00e7\u00e3o Linear Inteira Mista: esta sub-classe dos problemas \u00e9 uma uni\u00e3o das duas apresen-\n\ntadas anteriormente. Nela existem vari\u00e1veis de decis\u00e3o cont\u00ednuas e inteiras.\n\nPIM : Maximize c\nT x + hT y\n\nSujeito a: Ax + Gy 6 b\n\nx ? Rn+\n\ny ? Zm+\n\nEmprega-se a programa\u00e7\u00e3o linear inteira mista, ou apenas programa\u00e7\u00e3o inteira mista, normal-\n\nmente quando s\u00e3o utilizadas vari\u00e1veis de decis\u00e3o sobre vari\u00e1veis cont\u00ednuas. Problemas desta\n\nsubclasse s\u00e3o t\u00e3o complexos quanto os apresentados anteriormente.\n\nPrograma\u00e7\u00e3o N\u00e3o-linear com Restri\u00e7\u00f5es: \u00e9 o caso mais geral de problemas de otimiza\u00e7\u00e3o.\n\nPNL : Maximize f (x)\n\nSujeito a: g(x) 6 0\n\nx ? Rn\n\nonde f (x) e g(x) s\u00e3o n\u00e3o lineares e n\u00e3o precisam ser necessariamente cont\u00ednuas. N\u00e3o existe\n\numa forma geral para resolver problemas desta natureza, devendo-se analisar cada caso em\n\nbusca de um algoritmo eficiente, quando existir.\n\nExistem ainda dois casos particulares: na programa\u00e7\u00e3o quadr\u00e1tica a fun\u00e7\u00e3o objetivo \u00e9 uma\n\nfun\u00e7\u00e3o quadr\u00e1tica das vari\u00e1veis de decis\u00e3o f (x) = 12 x\nT Qx + cT x, sendo Q uma matriz sim\u00e9trica,\n\ne as restri\u00e7\u00f5es s\u00e3o lineares Ax 6 b. Se a matriz Q for positiva definida ou positiva semi-definida\n\nencontrar a solu\u00e7\u00e3o global \u00e9 relativamente f\u00e1cil. Mas se Q for indefinida, negativa definida ou\n\nnegativa semi-definida o problema j\u00e1 se torna dif\u00edcil.\n\nNa programa\u00e7\u00e3o n\u00e3o-linear irrestrita, todas as vari\u00e1veis de decis\u00e3o podem assumir qualquer va-\n\nlor. Caso f (x) seja cont\u00ednua, pode-se empregar o m\u00e9todo de descenso ou o m\u00e9todo de Newton.\n\nA dificuldade desta subclasse \u00e9 garantir que o problema convirja para um ponto \u00f3timo global,\n\nn\u00e3o apenas sendo \u00f3timo para uma regi\u00e3o pr\u00f3xima (\u00f3timo local).\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 18\n\n3.2 Programa\u00e7\u00e3o inteira\n\nNesta se\u00e7\u00e3o apresentamos os conceitos b\u00e1sicos para resolu\u00e7\u00e3o de problemas modelados com Pro-\n\ngrama\u00e7\u00e3o Inteira baseados no livro de Wolsey [21]. Tendo em vista que o modelo a ser desenvolvido\n\npara P(G) \u00e9 tipo inteiro misto, faz-se necess\u00e1rio um maior aprofundamento desta teoria. A teoria apli-\n\ncada \u00e0 programa\u00e7\u00e3o inteira pura tamb\u00e9m pode ser utilizada na programa\u00e7\u00e3o inteira mista, tomando\n\nalguns cuidados. Podem-se ignorar as vari\u00e1veis de decis\u00e3o reais ao aplicar m\u00e9todos que levam em\n\nconta que os n\u00fameros s\u00e3o inteiros, e tratar o problema completo quando s\u00e3o consideradas as relaxa-\n\n\u00e7\u00f5es.\n\n3.2.1 Formula\u00e7\u00f5es\n\nConsideramos agora o problema geral de programa\u00e7\u00e3o inteira dado por PI . Suponha que X ?Z\nn\n+ \u00e9\n\no conjunto das solu\u00e7\u00f5es fact\u00edveis. Tipicamente, existem muitas (possivelmente infinitas) formula\u00e7\u00f5es\n\npara X dadas por meio de poliedros. Esta equival\u00eancia entre elementos de X e os elementos da sua for-\n\nmula\u00e7\u00e3o como um poliedro P s\u00e3o fundamentais, tanto ao processo de formula\u00e7\u00e3o quanto aos procedi-\n\nmentos algor\u00edtmicos de solu\u00e7\u00e3o. Abaixo, formalizamos estas no\u00e7\u00f5es e apresentamos conceitos-chave\n\npara o desenvolvimento desta disserta\u00e7\u00e3o.\n\nDefini\u00e7\u00e3o 3.1 Um subconjunto do Rn descrito por um conjunto de restri\u00e7\u00f5es lineares P = {x ? Rn+ :\n\nAx 6 b} \u00e9 um poliedro.\n\nDefini\u00e7\u00e3o 3.2 O poliedro P ? Rn+ \u00e9 uma formula\u00e7\u00e3o para o conjunto X ? Z\nn\n+ se, e somente se,\n\nX = P?Zn+.\n\nSeja X o conjunto das solu\u00e7\u00f5es fact\u00edveis de um problema inteiro dado pelos pontos do conjunto\n\nX = {(2,2), (3,1), (3,2), (3,3), (4,1), (4,2), (4,3), (5,1), (5,2), (5,3)}. Ent\u00e3o \u00e9 f\u00e1cil verificar que os\n\npoliedros:\n\nP1 = {x ? R2+ : ?2x1 + x2 6 ?\n3\n2 , x2 6\n\n7\n2 ,\n\n3\n2 x1 + x2 6\n\n23\n2 , 2x1 ? x2 6\n\n28\n3 ,\n\n?12 x1 ? x2 6 ?\n7\n3 },\n\nP2 = {x ? R2+ : ?\n1\n2 x1 + x2 6\n\n5\n3 ,\n\n7\n2 x1 + x2 6 21,\n\n1\n4 x1 ? x2 6\n\n1\n2 , ?\n\n8\n3 x1 ? x2 6 ?7 },\n\nP3 = {x ? R2+ : ?x1 + x2 6 0, x2 6 3,\n\nx1 6 5, ?x2 6 ?1,\n\n?x1 ? x2 6 ?4 },\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 19\n\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n????????????????\n\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n?????????????????\n\n??????????????\n??????????????\n??????????????\n??????????????\n??????????????\n??????????????\n??????????????\n??????????????\n??????????????\n??????????????\n??????????????\n??????????????\n\n??????????????\n??????????????\n??????????????\n??????????????\n??????????????\n??????????????\n??????????????\n??????????????\n??????????????\n??????????????\n??????????????\n??????????????\n\n1\n\n1\n\n2\n\n2\n\n3\n\n3\n\n4\n\n4 5 6\n\nP1\n\nP2\n\nP3\n\nFigura 3.1: Formula\u00e7\u00f5es para X\n\nassim como P1 ?P2, s\u00e3o formula\u00e7\u00f5es para X , como pode ser visto na Figura 3.1.\n\nNo exemplo apresentamos tr\u00eas formula\u00e7\u00f5es para o mesmo conjunto de pontos X . Observamos\n\nque pode existir um n\u00famero infinito de formula\u00e7\u00f5es para X . Ent\u00e3o, como escolher entre duas formu-\n\nla\u00e7\u00f5es? Pode-se dizer que uma formula\u00e7\u00e3o \u00e9 melhor que outra? Chegamos ent\u00e3o a seguinte defini\u00e7\u00e3o:\n\nDefini\u00e7\u00e3o 3.3 Dado um conjunto de pontos X ?Rn, e duas formula\u00e7\u00f5es Pa e Pb para X , dizemos que\n\nPa \u00e9 melhor que Pb se Pa ? Pb.\n\nPodemos dizer ainda que uma formula\u00e7\u00e3o melhor \u00e9 mais forte ou apertada que outra. Evidente-\n\nmente, nem todas as formula\u00e7\u00f5es podem ser comparadas. Como vemos as formula\u00e7\u00f5es P1 e P2 s\u00e3o\n\nn\u00e3o compar\u00e1veis, pois P1 * P2 nem P2 * P1.\n\nA formula\u00e7\u00e3o P3 \u00e9 dita ideal porque n\u00e3o existe uma formula\u00e7\u00e3o P4 para o conjunto X tal que P4 ?\n\nP3. Tamb\u00e9m porque se resolvermos a relaxa\u00e7\u00e3o linear de P3 a solu\u00e7\u00e3o do problema est\u00e1 localizada\n\nsobre um dos v\u00e9rtices de P3. A seguir, formalizamos estes conceitos.\n\nDefini\u00e7\u00e3o 3.4 Dado um conjunto de pontos X , x \u00e9 combina\u00e7\u00e3o convexa de X se existe um conjunto\n\nfinito de pontos x j ? X e ? j ? R+, j = 1, . . . , n, com ?nj=1 ? j = 1 tal que x = ?\nn\nj=1 ? jx j .\n\nDefini\u00e7\u00e3o 3.5 Dado um conjunto de pontos X , conv(X ) = {x : x \u00e9 combina\u00e7\u00e3o convexa de X} \u00e9 o\n\nfecho convexo do conjunto X .\n\nProposi\u00e7\u00e3o 3.1 conv(X ) \u00e9 um poliedro [22, p\u00e1gina 106, Teorema 6.2].\n\nProposi\u00e7\u00e3o 3.2 Os v\u00e9rtices de conv(X ) s\u00e3o pontos de X [21, p\u00e1gina 15, Proposi\u00e7\u00e3o 1.2].\n\nComo conseq\u00fc\u00eancia temos que conv(X ) pode ser descrito por um conjunto finito de desigualda-\n\ndes lineares, e PI : {max c\nT x : x ? X} pode ser reescrito como {max cT x : x ? conv(X )}. Entretanto,\n\nencontrar todas as desigualdades que descrevem conv(X ) nem sempre \u00e9 f\u00e1cil, pois pode existir um n\u00fa-\n\nmero muito grande (exponencial) de desigualdades. No exemplo apresentado na Figura 3.1 podemos\n\nverificar que para o conjunto de pontos X , a formula\u00e7\u00e3o P3 = conv(X ).\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 20\n\n3.2.2 Introdu\u00e7\u00e3o a algoritmos\n\nFormulado o problema, o passo seguinte \u00e9 encontrar uma maneira eficiente de encontrar a solu\u00e7\u00e3o\n\n\u00f3tima. Como j\u00e1 foi citado, problemas de programa\u00e7\u00e3o linear n\u00e3o inteira possuem algoritmos eficientes\n\npara obten\u00e7\u00e3o da solu\u00e7\u00e3o \u00f3tima, como os m\u00e9todos Simplex [20] e ponto interior [23]. Por\u00e9m no caso\n\nda programa\u00e7\u00e3o inteira, por pertencerem \u00e0 classe NP-dif\u00edcil, n\u00e3o existem algoritmos gerais capazes\n\nde encontrar a solu\u00e7\u00e3o \u00f3tima global de maneira eficiente (a n\u00e3o ser que NP=P).\n\nAlgoritmos exatos s\u00e3o m\u00e9todos capazes de encontrar a solu\u00e7\u00e3o \u00f3tima global para um problema\n\nde otimiza\u00e7\u00e3o. Nem sempre o seu uso \u00e9 poss\u00edvel, geralmente devido ao elevado tempo e/ou grande\n\nquantidade de recursos computacionais demandados pelo algoritmo. Em casos onde uma solu\u00e7\u00e3o\n\nrelativamente boa \u00e9 admiss\u00edvel, podem-se empregar heur\u00edsticas e meta-heur\u00edsticas. Estes m\u00e9todos\n\nn\u00e3o garantem uma solu\u00e7\u00e3o \u00f3tima para o problema, mas s\u00e3o capazes de encontrar uma solu\u00e7\u00e3o de\n\nqualidade em um tempo adequado para aplica\u00e7\u00e3o.\n\n3.2.2.1 Otimalidade e relaxa\u00e7\u00e3o\n\nDado um problema em programa\u00e7\u00e3o linear inteira z = max{cT x : x ? X}, como provar que um\n\nponto x? \u00e9 \u00f3timo? Uma maneira \u00e9 encontrar um limite inferior \u00e0 solu\u00e7\u00e3o z 6 z e um limite superior\n\nz > z de tal forma que z = z = z. Esta abordagem prop\u00f5e um algoritmo para a solu\u00e7\u00e3o desta classe de\n\nproblemas. Deve-se buscar uma seq\u00fc\u00eancia decrescente de limites superiores:\n\nz1 > z2 > z3 > . . . > zs > z\n\ne uma sequ\u00eancia crescente de limites inferiores:\n\nz1 &lt;z2 &lt;z3 &lt;. . . &lt;zt 6 z\n\nat\u00e9 que seja atingido:\n\nzs ?zt 6 ?\n\nonde ? \u00e9 um valor positivo muito pequeno. Ent\u00e3o temos que encontrar maneiras de obter estes limites.\n\nLimite Primal: Toda solu\u00e7\u00e3o fact\u00edvel x? ? X induz um limite inferior z = cT x 6 z. Geralmente\n\nencontrar uma solu\u00e7\u00e3o fact\u00edvel para um problema n\u00e3o \u00e9 muito dif\u00edcil. O desafio \u00e9 encontrar\n\numa boa solu\u00e7\u00e3o, isto \u00e9, que seja pr\u00f3xima da solu\u00e7\u00e3o \u00f3tima.\n\nLimite Dual: O limite dual procura um limite superior para os problemas de maximiza\u00e7\u00e3o. A abor-\n\ndagem mais importante \u00e9 a relaxa\u00e7\u00e3o, que busca tornar o problema mais f\u00e1cil de ser resolvido\n\nem que a solu\u00e7\u00e3o \u00f3tima seja no m\u00ednimo t\u00e3o grande quanto z. Na relaxa\u00e7\u00e3o deve-se balancear\n\na dificuldade de obt\u00ea-la com os benef\u00edcios que ela trar\u00e1. Uma relaxa\u00e7\u00e3o muito apertada pode\n\nrequerer um esfor\u00e7o computacional grande, enquanto uma relaxa\u00e7\u00e3o mais facilmente comput\u00e1-\n\nvel pode resultar em valores muito distantes. Uma relaxa\u00e7\u00e3o bastante empregada \u00e9 a relaxa\u00e7\u00e3o\n\nlinear.\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 21\n\nDefini\u00e7\u00e3o 3.6 Para o problema em programa\u00e7\u00e3o linear inteira PI = max{cT x : x ? P?Zn}\n\ncom formula\u00e7\u00e3o P = {x ? Rn : Ax 6 b}, sua relaxa\u00e7\u00e3o linear \u00e9 PR = max{cT x : x ? P}.\n\nOu seja, a relaxa\u00e7\u00e3o linear de um problema em programa\u00e7\u00e3o linear inteira consiste em transfor-\n\nmar suas vari\u00e1veis de decis\u00e3o inteiras em reais, transformando o problema para programa\u00e7\u00e3o\n\nlinear apenas, que pode ser facilmente resolvido.\n\nNos problemas de minimiza\u00e7\u00e3o o limite primal representa um limite superior na fun\u00e7\u00e3o objetivo,\n\ne o limite dual um limite inferior. A seguir, vamos apresentar alguns algoritmos exatos para resolu\u00e7\u00e3o\n\nde problemas de otimiza\u00e7\u00e3o.\n\n3.2.2.2 Branch and Bound\n\nO algoritmo de Branch and Bound baseia-se em dividir o problema em problemas menores e mais\n\nf\u00e1ceis de serem resolvidos, e depois unir as solu\u00e7\u00f5es para formar a solu\u00e7\u00e3o do problema original.\n\nUma maneira de se representar esta divis\u00e3o seria fixar os valores de todas as vari\u00e1veis inteiras,\n\nenumerando todas as poss\u00edveis solu\u00e7\u00f5es para o problema. Em seguida obter o valor da fun\u00e7\u00e3o objetivo\n\npara cada uma das solu\u00e7\u00f5es e escolher a \u00f3tima. Esta abordagem \u00e9 chamada de enumera\u00e7\u00e3o expl\u00edcita\n\ne n\u00e3o \u00e9 uma boa maneira de se resolver o problema, pois o n\u00famero de solu\u00e7\u00f5es poss\u00edveis cresce\n\nexponencialmente com o n\u00famero de vari\u00e1veis de decis\u00e3o, a tornando impratic\u00e1vel j\u00e1 para problemas\n\nde tamanho m\u00e9dio.\n\nNo algoritmo de Branch and Bound, para cada decomposi\u00e7\u00e3o do problema \u00e9 avaliado se a \u00e1rvore\n\nde solu\u00e7\u00f5es fact\u00edveis pode ser reduzida. Esta abordagem \u00e9 chamada de enumera\u00e7\u00e3o impl\u00edcita, pois\n\ndescarta maus ramos da \u00e1rvore de solu\u00e7\u00f5es. A seguir \u00e9 apresentado o algoritmo em pseudoc\u00f3digo\n\npara um problema de maximiza\u00e7\u00e3o:\n\nBranch-And-Bound( c, P )\n\n1 L ?{P} ? lista de n\u00f3s ativos\n\n2 T ? ({P}, /0) ? \u00e1rvore inicial de Branch and Bound\n3 z ??? ? limite inferior\n4 x? ? NIL ? a solu\u00e7\u00e3o do problema\n\n5 enquanto L 6= /0\n6 fa\u00e7a escolha um Pk de L\n\n7 resolver relaxa\u00e7\u00e3o RLk ?{max c\nT x : x ? Pk}\n\n8 zk ? valorObjetivo[RLk ]\n\n9 xk ? solu\u00e7\u00e3o[RLk ]\n\n10 se zk = ?? ? Pk = /0\n11 ent\u00e3o descarte Pk por infactibilidade\n\n12 sen\u00e3o se zk 6 z\n\n13 ent\u00e3o descarte Pk por limite\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 22\n\n14 sen\u00e3o\n\n15 se xk ? Z|x\nk| e zk > z\n\n16 ent\u00e3o z ? zk ? novo limite inferior\n\n17 x? ? xk ? nova solu\u00e7\u00e3o\n\n18 sen\u00e3o ? xk /? Z|x\nk|\n\n19 escolha uma vari\u00e1vel fracion\u00e1ria xkj da solu\u00e7\u00e3o\n\n20 Pk1 ? Pk ?{x j 6 ?x\nk\nj?}\n\n21 Pk2 ? Pk ?{x j > ?x\nk\nj?}\n\n22 adicione Pk1 e Pk2 a T como folhas de Pk\n23 insira Pk1 e Pk2 em L\n\n24 descarte Pk\n\nNas primeiras quatro linhas do algoritmo \u00e9 criada uma lista de n\u00f3s ativos, uma \u00e1rvore de solu\u00e7\u00f5es,\n\num vetor para armazenar o valor das vari\u00e1veis de decis\u00e3o da melhor solu\u00e7\u00e3o encontrada e uma vari\u00e1vel\n\npara armazenar o valor da fun\u00e7\u00e3o objetivo correspondente. Na pr\u00e1tica, n\u00e3o \u00e9 necess\u00e1rio armazenar a\n\n\u00e1rvore de solu\u00e7\u00f5es, apenas a lista dos n\u00f3s ativos, mas para compreens\u00e3o do algoritmo esta informa\u00e7\u00e3o\n\n\u00e9 mantida. Em seguida, o algoritmo entra em um la\u00e7o que \u00e9 executado para cada um dos elementos\n\nda lista de n\u00f3s ativos. Na primeira itera\u00e7\u00e3o existe apenas o n\u00f3 que representa o problema completo.\n\nA escolha do n\u00f3 ativo para ser processado pode ser feita de v\u00e1rias maneiras. Heur\u00edsticas buscam\n\no n\u00f3 que seja o melhor candidato a levar \u00e0 solu\u00e7\u00e3o do problema o mais r\u00e1pido poss\u00edvel. Deseja-se o\n\nn\u00f3 que leve a um alto limite inferior, que reduza ao m\u00e1ximo a \u00e1rvore de solu\u00e7\u00f5es e por conseq\u00fc\u00eancia\n\no tempo de processamento. Outra abordagem pode ser uma busca em profundidade. Esta heur\u00edstica \u00e9\n\nmenos elaborada que as adotadas como padr\u00e3o em implementa\u00e7\u00f5es comerciais, implicando em uma\n\nexecu\u00e7\u00e3o mais lenta (maior n\u00famero de itera\u00e7\u00f5es), mas ela mant\u00e9m o n\u00famero de n\u00f3s ativos pequeno,\n\nsendo indicada quando h\u00e1 pouca mem\u00f3ria para executar o algoritmo. Uma abordagem comercial\n\nconsiste em inicialmente utilizar uma busca em profundidade, que leva rapidamente a uma solu\u00e7\u00e3o\n\ninteira (n\u00e3o necessariamente boa), e em seguida partir para uma heur\u00edstica mais elaborada. A presen\u00e7a\n\nde uma solu\u00e7\u00e3o inteira permite que n\u00f3s sejam descartados rapidamente por limite.\n\nEscolhido um n\u00f3 \u00e9 resolvida sua relaxa\u00e7\u00e3o, que como vimos geralmente \u00e9 utilizada a relaxa\u00e7\u00e3o\n\nlinear. O n\u00f3 pode ser descartado por infactibilidade se seu conjunto de solu\u00e7\u00f5es \u00e9 vazio, ou por\n\nlimite se seu limite superior apresentar valor na relaxa\u00e7\u00e3o menor que o melhor limite inferior j\u00e1\n\nobtido. Ent\u00e3o s\u00e3o verificados os valores obtidos nas vari\u00e1veis de decis\u00e3o. Se elas obtiveram valores\n\ninteiros, o limite superior do n\u00f3 tamb\u00e9m \u00e9 seu limite inferior, e uma nova melhor solu\u00e7\u00e3o pode ter\n\nsido encontrada. Caso contr\u00e1rio \u00e9 escolhida uma das vari\u00e1veis de decis\u00e3o e o problema \u00e9 dividido\n\nem dois sub-problemas (ou at\u00e9 em mais, em implementa\u00e7\u00f5es mais avan\u00e7adas), que s\u00e3o adicionados \u00e0\n\nlista de n\u00f3s ativos e \u00e0 \u00e1rvore de solu\u00e7\u00f5es.\n\nDa mesma forma, n\u00e3o existe uma melhor forma de escolher a vari\u00e1vel de decis\u00e3o que ser\u00e1 usada\n\npara dividir o problema. Geralmente \u00e9 empregada a mais fracion\u00e1ria das vari\u00e1veis, ou seja, a vari\u00e1vel\n\nque possui valor mais distante do seu inteiro mais pr\u00f3ximo. Por exemplo, considere duas vari\u00e1veis\n\nde decis\u00e3o y1 = 1, 4 e y2 = 2, 8, ent\u00e3o \u00e9 escolhida a vari\u00e1vel y1, pois 1,4 est\u00e1 mais distante de 1 (seu\n\ninteiro mais pr\u00f3ximo) que 2,8 est\u00e1 de 3.\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 23\n\nP\n\nP1 P2\n\n17, 4\n\nx2 > 1x2 6 0\n\nz = ??\nx? = NIL\n\n(a)\n\nP\n\nP1 P2\n\n17, 4\n\n13\n\nx2 > 1x2 6 0\n\nz = 13\nx? = (0, 1, 0, 0, 0, 0, 1)\n\n(b)\n\nP\n\nP1 P2\n\nP11 P12\n\n17, 4\n\n17, 33... 13\n\nx2 > 1x2 6 0\n\nx4 > 1x4 6 0\n\nz = 13\nx? = (0, 1, 0, 0, 0, 0, 1)\n\n(c)\n\nP\n\nP1 P2\n\nP11 P12\n\n17, 4\n\n17, 33...\n\n17\n\n13\n\nx2 > 1x2 6 0\n\nx4 > 1x4 6 0\n\nz = 17\nx? = (0, 0, 0, 1, 0, 1, 1)\n\n(d)\n\nP\n\nP1 P2\n\nP11 P12\n\n17, 4\n\n17, 33...\n\n1716, 5\n\n13\n\nx2 > 1x2 6 0\n\nx4 > 1x4 6 0\n\nz = 17\nx? = (0, 0, 0, 1, 0, 1, 1)\n\n(e)\n\nFigura 3.2: Exemplo ilustrativo do algoritmo de Branch and Bound\n\nDado o exemplo do problema da mochila apresentado na Equa\u00e7\u00e3o 3.1, a Figura 3.2 apresenta a\n\naplica\u00e7\u00e3o do algoritmo. Na figura, os n\u00f3s escuros j\u00e1 foram processados e os n\u00f3s claros comp\u00f5em a\n\nlista dos n\u00f3s ativos.\n\n1. Em (a) foi resolvida a relaxa\u00e7\u00e3o linear do problema original, chegando a solu\u00e7\u00e3o x = (0, 15 , 0,\n\n0, 1, 1, 1) com limite superior igual a 17,4. Como x2 apresentou valor fracion\u00e1rio, o problema\n\nfoi dividido em dois conjuntos de solu\u00e7\u00f5es sobre x2.\n\n2. Em (b) foi escolhido o n\u00f3 do conjunto de solu\u00e7\u00f5es P2, resolvida sua relaxa\u00e7\u00e3o obtendo a solu\u00e7\u00e3o\n\ninteira x2 = (0, 1, 0, 0, 0, 0, 1) com limite superior 13. Note que o limite inferior passa a ser 13,\n\ne o n\u00f3 \u00e9 fechado por otimalidade.\n\n3. A parte (c) da figura mostra a resolu\u00e7\u00e3o do n\u00f3 P1, que obteve solu\u00e7\u00e3o x\n1 = (0, 0, 0, 13 , 1, 1, 1) e\n\nvalor da relaxa\u00e7\u00e3o z1 = 17 13 . A vari\u00e1vel x\n1\n4 =\n\n1\n3 apresentou valor fracion\u00e1rio neste subproblema.\n\nEnt\u00e3o este foi dividido em torno de x4, gerando novos subconjuntos de solu\u00e7\u00e3o P11 e P12.\n\n4. (d) mostra a resolu\u00e7\u00e3o da relaxa\u00e7\u00e3o de P12, com x\n12 = (0, 0, 0, 1, 0, 1, 1) e z12 = 17. Observe\n\nque novamente a solu\u00e7\u00e3o foi inteira. Como sua solu\u00e7\u00e3o \u00e9 maior que a at\u00e9 ent\u00e3o obtida, esta\n\npassa ser a solu\u00e7\u00e3o do problema.\n\n5. Em (e) resolvemos RL11, com solu\u00e7\u00e3o x\n11 = (0, 0, 14 , 0, 1, 1, 1) e z\n\n11 = 16, 5. Como o limite\n\nsuperior \u00e9 menor que z, isto \u00e9, a solu\u00e7\u00e3o deste ramo da \u00e1rvore n\u00e3o pode ser melhor que a j\u00e1\n\nobtida, o n\u00f3 \u00e9 cortado por limite.\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 24\n\n6. Como n\u00e3o existem mais n\u00f3s ativos, a solu\u00e7\u00e3o z? = 17 e x? = (0, 0, 0, 1, 0, 1, 1) \u00e9 o \u00f3timo global\n\ndo problema.\n\n3.2.2.3 Planos de corte\n\nConsidere a restri\u00e7\u00e3o do problema da mochila em (3.1),\n\n5x1 + 5x2 + 4x3 + 3x4 + 2x5 + 2x6 + x7 6 6 (3.3)\n\nx ? B7. Podemos observar que x4, x5 e x6 n\u00e3o podem assumir valor 1 simultaneamente, pois se\n\nx4 = x5 = x6 = 1, temos que 3x4 + 2x5 + 2x6 = 7 > 6, que excede a capacidade da mochila. Mas se\n\neles forem agrupados dois a dois, a restri\u00e7\u00e3o continua v\u00e1lida. Isto sugere a restri\u00e7\u00e3o x4 + x5 + x6 6 2.\n\nNa mesma linha de racioc\u00ednio, observamos ainda que se x2 = 1, x4, x5 e x6 devem ser 0. Assim,\n\npodemos complementar a restri\u00e7\u00e3o obtendo\n\n2x2 + x4 + x5 + x6 6 2. (3.4)\n\nEsta desigualdade \u00e9 v\u00e1lida para a inst\u00e2ncia apresentada, pois ela \u00e9 verdadeira para todos os pontos\n\nque comp\u00f5em o conjunto de solu\u00e7\u00f5es X da inst\u00e2ncia.\n\nDefini\u00e7\u00e3o 3.7 Uma desigualdade ?T x 6 ?0 \u00e9 uma desigualdade v\u00e1lida para um conjunto X ? Rn se\n?T x 6 ?o para todo x ? X .\n\nEm um problema em programa\u00e7\u00e3o inteira de espa\u00e7o de solu\u00e7\u00f5es X , a inser\u00e7\u00e3o de desigualda-\n\ndes v\u00e1lidas pode gerar uma redu\u00e7\u00e3o no poliedro da formula\u00e7\u00e3o, ou seja, P?{x : ?T x 6 ?0}? P. O\nalgoritmo de planos de corte consiste em inserir cortes v\u00e1lidos ao poliedro at\u00e9 que a resolu\u00e7\u00e3o da re-\n\nlaxa\u00e7\u00e3o linear do problema seja inteira, que implica na obten\u00e7\u00e3o do \u00f3timo global. Este procedimento\n\nn\u00e3o requer a obten\u00e7\u00e3o das express\u00f5es que produzem o fecho convexo de todo o poliedro, apenas a sua\n\nredu\u00e7\u00e3o de maneira apropriada. A seguir, apresentamos o algoritmo de planos de corte.\n\nPlanos-De-Corte( c, P )\n\n1 t ? 0 ? contador\n\n2 P0 ? P ? poliedro inicial\n\n3 fa\u00e7a sempre\n\n4 resolver relaxa\u00e7\u00e3o RLt ?{max c\nT x : x ? Pt}\n\n5 xt ? solu\u00e7\u00e3o[RLt ]\n\n6 se xt ? Z|x\nt|\n\n7 ent\u00e3o retorne xt ? xt \u00e9 solu\u00e7\u00e3o \u00f3tima\n\n8 busque um corte (?t , ?t0) para x\nt\n\n9 se (?t , ?t0) corta x\nt\n\n10 ent\u00e3o Pt+1 ? Pt ?{x : (?t )T x 6 ?t0}\n11 t ? t + 1\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 25\n\n1\n\n1\n\nx2\n\nx5\n\n5x2 + 2x5 6 3\n\n2x2 + x5 6 1\n\nFigura 3.3: Ilustra\u00e7\u00e3o do corte no problema da mochila com x1 = x3 = x4 = 0 e x6 = x7 = 1\n\n12 sen\u00e3o retorne NIL ? n\u00e3o encontrou solu\u00e7\u00e3o\n\nPodemos observar que este algoritmo busca cortes para o poliedro at\u00e9 que seja encontrada uma\n\nsolu\u00e7\u00e3o inteira, que \u00e9 o \u00f3timo global. A obten\u00e7\u00e3o dos cortes (linha 8) \u00e9 a base do algoritmo. Como\n\n\u00e9 uma tarefa dif\u00edcil, nem sempre s\u00e3o encontrados cortes at\u00e9 resolver o problema, assim o algoritmo\n\npode retornar uma falha (linha 12).\n\nExistem procedimentos gerais para a obten\u00e7\u00e3o de desigualdades v\u00e1lidas para problemas inteiros,\n\ncomo o de Chav\u00e1tal-Gomory [21, 22]. Para a programa\u00e7\u00e3o inteira pura os cortes de Chav\u00e1tal-Gomory\n\nfazem que o algoritmo de planos de cortes convirja em um n\u00famero finito de itera\u00e7\u00f5es. Para problemas\n\nbin\u00e1rios com formula\u00e7\u00e3o P = {x ? Rn+ : Ax 6 b, x 6 1} e S = P ?Z\nn, o procedimento de cortes\n\ndisjuntivos pode ser utilizado para obter conv(S) ap\u00f3s n itera\u00e7\u00f5es.\n\nA obten\u00e7\u00e3o dos cortes geralmente faz uso da estrutura da formula\u00e7\u00e3o. No exemplo acima apli-\n\ncamos parcialmente um procedimento chamado de coberturas que busca cortes para o problema da\n\nmochila, e ser\u00e1 visto mais detalhadamente na pr\u00f3xima se\u00e7\u00e3o. Com a adi\u00e7\u00e3o desta nova restri\u00e7\u00e3o con-\n\nvenientemente escolhida ao problema, sua relaxa\u00e7\u00e3o linear passa a apresentar xT = (0, 0, 0, 1, 0, 1, 1)\n\nem suas vari\u00e1veis de decis\u00e3o, contra xT = (0, 15 , 0, 0, 1, 1, 1) que \u00e9 o valor obtido na formula\u00e7\u00e3o origi-\n\nnal. Uma vez que x?Z7+ na nova formula\u00e7\u00e3o, esta solu\u00e7\u00e3o \u00e9 \u00f3tima global. Note que ao introduzirmos\n\na restri\u00e7\u00e3o (3.4) a P = {x ? B7 : sujeito a (3.3) }, n\u00e3o obtemos o fecho convexo conv(S), S = P?Z7,\n\nmas uma configura\u00e7\u00e3o exata em torno da solu\u00e7\u00e3o \u00f3tima.\n\nA Figura 3.3 ilustra a inser\u00e7\u00e3o do corte no subespa\u00e7o x5 \u00d7x2, fixando x1 = x3 = x4 = 0 e x6 =\n\nx7 = 1. Neste subespa\u00e7o (3.3) fica 5x2 + 2x5 6 3 e o corte (3.4) fica 2x2 + x5 6 1. Podemos observar\n\nque a inser\u00e7\u00e3o do corte reduz o poliedro, mas que n\u00e3o gera o poliedro m\u00ednimo (x2 6 0 e x5 6 1 para\n\neste sub-espa\u00e7o). Mesmo assim, este corte leva \u00e0 solu\u00e7\u00e3o problema.\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 26\n\n3.2.2.4 Branch and Cut\n\nA inser\u00e7\u00e3o pura de cortes n\u00e3o \u00e9 a melhor maneira de se resolver um problema de otimiza\u00e7\u00e3o. A\n\nobten\u00e7\u00e3o eficiente de cortes \u00e9 uma tarefa dif\u00edcil. Uma maneira alternativa de resolver os problemas\n\nde otimiza\u00e7\u00e3o \u00e9 combinar algoritmos conhecidos. O algoritmo de Branch and Cut \u00e9 a combina\u00e7\u00e3o\n\ndos dois algoritmos vistos anteriormente. Para cada n\u00f3 da \u00e1rvore de solu\u00e7\u00f5es do Branch and Bound\n\ns\u00e3o inseridos cortes. Em cada n\u00f3 busca-se o m\u00e1ximo de cortes que podem ser inseridos em um tempo\n\nrazo\u00e1vel, reduzindo assim o limite superior do n\u00f3 e promovendo uma redu\u00e7\u00e3o no tamanho da \u00e1rvore\n\nBranch and Bound.\n\n\u00c9 necess\u00e1rio, entretanto limitar o tempo de busca por cortes em cada n\u00f3. Um excesso de empenho\n\ndo algoritmo na busca de cortes pode representar uma redu\u00e7\u00e3o pequena na relaxa\u00e7\u00e3o, de maneira que\n\neste tempo n\u00e3o seja compensado na redu\u00e7\u00e3o do n\u00famero de n\u00f3s.\n\n3.3 M\u00e9todos de planos de corte\n\nNesta se\u00e7\u00e3o formalizaremos os conceitos de aplica\u00e7\u00e3o de cortes a uma formula\u00e7\u00e3o e como gerar\n\ncortes para o problema da mochila.\n\n3.3.1 Desigualdades v\u00e1lidas\n\nVimos na Defini\u00e7\u00e3o 3.7 o que \u00e9 uma desigualdade v\u00e1lida. Um poliedro possui infinitas desigualda-\n\ndes v\u00e1lidas, surgindo a quest\u00e3o de quais desigualdades s\u00e3o relevantes e quais podem ser descartadas.\n\nDefini\u00e7\u00e3o 3.8 Dadas duas desigualdades v\u00e1lidas ?T x 6 ?0 e \u00b5T x 6 \u00b50 para um poliedro P ? Rn+,\ntamb\u00e9m notadas por (?, ?0) e (\u00b5, \u00b50), dizemos que ?T x 6 ?0 domina \u00b5T x 6 \u00b50 se existe u > 0 tal que\n? > u\u00b5 e ?0 6 u\u00b50, e (?, ?0) 6= (\u00b5, \u00b50).\n\nNote que se (?, ?0) domina (\u00b5, \u00b50), denotado por (?, ?0) ? (\u00b5, \u00b50), ent\u00e3o (\u00b5, \u00b50) \u00e9 redundante e\npode ser descartada da formula\u00e7\u00e3o.\n\nDefini\u00e7\u00e3o 3.9 Considerando um poliedro P ? Rn+, uma desigualdade v\u00e1lida ?\nT x 6 ?0 \u00e9 redundante\n\npara P se existirem desigualdades (\u00b5i)T x 6 \u00b5i0 , i = 1, . . . , k, de P e pesos ui > 0 tal que (?\nk\ni=1 ui\u00b5\n\ni)T x 6\n\n?ki=1 ui\u00b5\ni\n0 domine a desigualdade ?\n\nT x 6 ?0.\n\nDesejamos trabalhar com as desigualdades necess\u00e1rias e suficientes para defini\u00e7\u00e3o do poliedro,\n\nchamadas de desigualdades v\u00e1lidas fortes, ou apenas desigualdades fortes. S\u00e3o fortes no sentido que\n\nlevam a uma formula\u00e7\u00e3o mais apertada. Para o entendimento mais preciso de desigualdades fortes,\n\nalguns conceitos ser\u00e3o apresentados.\n\nDefini\u00e7\u00e3o 3.10 Os pontos x1, . . . , xk ? Rn s\u00e3o ditos afim independentes se a \u00fanica solu\u00e7\u00e3o ui, i =\n\n1, . . . , k, para ?ki=1 uix\ni = 0 e ?ki=1 ui = 0 for nula.\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 27\n\nDizer que pontos x1, . . . , xk ? Rn s\u00e3o afim independentes \u00e9 equivalente a dizer que os pontos\n\n(x2?x1), . . . , (xk?x1) s\u00e3o linearmente independentes. \u00c9 f\u00e1cil observar que o maior n\u00famero de pontos\n\nafim independentes em Rn \u00e9 n + 1, por exemplo, n pontos linearmente independentes e o vetor zero.\n\nDefini\u00e7\u00e3o 3.11 Se para um poliedro P o n\u00famero m\u00e1ximo de pontos afim independentes \u00e9 k, ent\u00e3o a\n\ndimens\u00e3o do poliedro P, denotada por dim(P), \u00e9 k?1.\n\nDefini\u00e7\u00e3o 3.12 Um poliedro P ? Rn \u00e9 de dimens\u00e3o cheia se, e somente se, dim(P) = n.\n\nDizer que um poliedro P ? Rn tem dimens\u00e3o cheia significa dizer que n\u00e3o existem vari\u00e1veis de\n\ndecis\u00e3o que podem ser expressas como fun\u00e7\u00e3o de outras vari\u00e1veis. N\u00e3o existem igualdades que s\u00e3o\n\nsatisfeitas por todo x ? P.\n\nDefini\u00e7\u00e3o 3.13 Uma face de um poliedro P induzida por uma desigualdade v\u00e1lida ?T x 6 ?0 \u00e9 F =\n{x ? P : ?T x = ?0}. A desigualdade ?T x 6 ?0 define ou representa a face.\n\nDefini\u00e7\u00e3o 3.14 Uma face F \u00e9 uma faceta de P se dim(F) = dim(P)?1.\n\nConsiderando o poliedro do problema da mochila em (3.1)\n\nP = {x ? R7+ : 5x1 + 5x2 + 4x3 + 3x4 + 2x5 + 2x6 + x7 6 6,\n\nx j 6 1, j = 1, . . . , 7}.\n(3.5)\n\nSeja e j ? R7+ o vetor com todas as entradas nulas a exce\u00e7\u00e3o da j-\u00e9sima entrada, cujo valor \u00e9 unit\u00e1-\n\nrio. Note que e j ? P para j = 1, . . . , 7. Logo {e j}\n7\nj=1 ?{0} constitui um conjunto de pontos afim\n\nindependentes de P e, portanto, dim(P) = 7.\n\nConsidere agora a face representada pela desigualdade da mochila F = {x ? P : 5x1 + 5x2 +\n\n4x3 + 3x4 + 2x5 + 2x6 + x7 = 6}. Tomando os pontos x\n1 = (1, 0, 0, 0, 0, 0, 1), x2 = (0, 1, 0, 0, 0, 0, 1),\n\nx3 = (0, 0, 1, 0, 1, 0, 0), x4 = (0, 0, 1, 0, 0, 1, 0), x5 = (0, 0, 0, 1, 1, 0, 1), x6 = ( 35 ,\n3\n5 , 0, 0, 0, 0, 0) e x\n\n7 =\n\n(0, 0, 34 , 1, 0, 0, 0), podemos verificar que x\nj ? F , j = 1, . . . , 7, s\u00e3o linearmente independentes e que\n\nestes pontos formam um conjunto de pontos afim independentes (independ\u00eancia linear implica em\n\nindepend\u00eancia afim, mas o contr\u00e1rio n\u00e3o \u00e9 verdade). Conclu\u00edmos que dim(F ) = 7?1 = 6 e como\n\ndim(F) = dim(P)?1 verificamos que F \u00e9 uma faceta de P, ou seja, face de dimens\u00e3o m\u00e1xima.\n\n3.3.2 Coberturas para mochila\n\nNa Se\u00e7\u00e3o 3.2.2.3 vimos informalmente a aplica\u00e7\u00e3o de coberturas para a gera\u00e7\u00e3o de cortes no\n\nproblema da mochila. Nesta se\u00e7\u00e3o e nas pr\u00f3ximas estes conceitos ser\u00e3o generalizados. Iniciamos\n\napresentando algumas defini\u00e7\u00f5es.\n\nConsidere os conjuntos X = {x ? Bn : ?nj=1 a jx j 6 b} e N = {1, . . . , n}.\n\nDefini\u00e7\u00e3o 3.15 Um conjunto C ? N \u00e9 uma cobertura se ? j?C a j > b. Uma cobertura \u00e9 m\u00ednima se\npara todo j ?C, C\\{ j} n\u00e3o \u00e9 uma cobertura.\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 28\n\nUma cobertura assinala um conjunto de elementos que excede a capacidade da mochila. Se o\n\nconjunto obtido pela remo\u00e7\u00e3o de qualquer elemento da cobertura pode ser armazenado na mochila,\n\ndizemos que a cobertura \u00e9 m\u00ednima. Para (3.3), C = {4, 5, 6} \u00e9 uma cobertura, pois a4 + a5 + a6 =\n\n3 + 2 + 2 = 7 > 6. Esta cobertura tamb\u00e9m \u00e9 m\u00ednima, pois a4 + a5 = 5 6 6, a4 + a6 = 5 6 6 e a5 + a6 =\n\n4 6 6.\n\nProposi\u00e7\u00e3o 3.3 Dado uma cobertura C ? N, a desigualdade\n\n?\nj?C\n\nx j 6 |C|?1 (3.6)\n\n\u00e9 v\u00e1lida para X .\n\nTemos ent\u00e3o para a cobertura C = {4, 5, 6} a desigualdade v\u00e1lida x4 + x5 + x6 6 2. Definimos\n\nPC = conv(XC), de XC = {x ? B|C| : ? j?C a j x j 6 b}, como o poliedro obtido a partir da proje\u00e7\u00e3o de\nconv(X ) sobre o espa\u00e7o das vari\u00e1veis da cobertura. Podemos facilmente verificar que dim(PC) = |C|,\n\nou seja, PC tem dimens\u00e3o cheia. Definimos FC = {x ? PC : ? j?C x j = |C|?1} como a face de PC\ninduzida por (3.6), podemos verificar que FC \u00e9 uma faceta, ou seja, dim(FC) = dim(PC)?1. Para\n\no exemplo dado acima, dim(PC) = 3 e {(1, 1, 0), (1, 0, 1), (0, 1, 1)} ? FC formam um conjunto afim\n\nindependente que nos leva a concluir que dim(FC) = 2.\n\nPodemos ainda estender a cobertura para outras vari\u00e1veis de decis\u00e3o, para torn\u00e1-la mais forte.\n\nDefini\u00e7\u00e3o 3.16 A cobertura estendida de uma cobertura C \u00e9 E(C) = C?{ j : a j > ai,?i ?C}.\n\nDa mesma maneira, a extens\u00e3o da cobertura implica na desigualdade tamb\u00e9m v\u00e1lida para um\n\nconjunto X ? N:\n\n?\nj?E(C)\n\nx j 6 |C|?1\n\nEm nosso exemplo E(C) = {1, 2, 3, 4, 5, 6}, pois a1, a2, a3 > max{a j : j ? C} = 3, mas 7 /? E(C)\n\nporque a7 &lt;a4. A desigualdade para a extens\u00e3o da cobertura \u00e9 ent\u00e3o\n\nx1 + x2 + x3 + x4 + x5 + x6 6 2 (3.7)\n\nConsiderando simultaneamente as desigualdades (3.3) e (3.7), observamos que se x1 = 1, n\u00e3o\n\nexiste em (3.7) nenhuma outra vari\u00e1vel de decis\u00e3o que possa assumir valor 1, pois para (3.3) apenas x7\npoderia ser selecionado sem que a capacidade da mochila seja excedida, e x7 n\u00e3o pertence \u00e0 (3.7). Mas\n\nse considerarmos apenas a desigualdade da cobertura estendida, ainda \u00e9 poss\u00edvel que outra vari\u00e1vel\n\nde decis\u00e3o seja diferente de zero. Isto sujere que a desigualdade (3.7) ainda possui folga, e que\n\nesta folga est\u00e1 nas vari\u00e1veis de decis\u00e3o adicionadas na extens\u00e3o da cobertura, pois para a cobertura\n\napenas, a desigualdade \u00e9 m\u00ednima. Em s\u00edntese, poder\u00edamos buscar valores ?1, ?2 e ?3 que tornam a\ndesigualdade\n\n?1x1 + ?2x2 + ?3x3 + x4 + x5 + x6 6 2\n\no mais apertada poss\u00edvel.\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 29\n\n3.3.3 Lifting\n\nDado uma cobertura C ? N = {1, . . . , n}, desejamos encontrar valores para ? j , j ? N\\C, de ma-\nneira que a desigualdade\n\n?\nj?C\n\nx j + ?\nj?N\\C\n\n? jx j 6 |C|?1\n\nseja v\u00e1lida para X = {x ? Bn : ?nj=1 a j x j 6 b}. A extens\u00e3o E(C) de uma cobertura C, conforme visto\nacima, nos d\u00e1 uma forma de obter valores ? j , onde ? j = 1 para j ? E(C)\\C enquanto ? j = 0 para\nj ? N\\E(C). Abaixo apresentamos um procedimento alternativo para o c\u00f4mputo dos fatores ? j . Este\nprocedimento \u00e9 conhecido por lifting e os par\u00e2metros ? j por fatores de lifting.\n\nSeja ? j1, . . . , jr? uma ordena\u00e7\u00e3o de N\\C. Fa\u00e7a para t = 1 at\u00e9 r.\n\nPara calcular o maior valor poss\u00edvel de ? jt no qual ? jt x jt + ?\nt?1\ni=1 ? ji x ji + ? j?C x j 6 |C|?1 seja\n\nv\u00e1lida, devemos resolver o problema\n\n?t = Maximize\nt?1\n\n?\ni=1\n\n? ji x ji + ?\nj?C\n\nx j\n\nSujeito a:\nt?1\n\n?\ni=1\n\na ji x ji + ?\nj?C\n\na jx j 6 b?a jt\n\nx ? B|C|+t?1\n\nassim chegamos a ? jt = |C|?1??t .\n\nSe a cobertura C for m\u00ednima, a desigualdade gerada utilizando este procedimento define uma\n\nfaceta de conv(X ) [24, Teorema 1]. De fato, a desigualdade (3.6) define uma faceta, portanto uma\n\nface m\u00e1xima, para o subconjunto das vari\u00e1veis de decis\u00e3o derivadas da cobertura. O procedimento de\n\nlifting busca obter os pesos das vari\u00e1veis de decis\u00e3o que n\u00e3o aparecem na cobertura, de maneira que\n\na restri\u00e7\u00e3o obtida no espa\u00e7o completo das vari\u00e1veis continue definindo uma faceta.\n\nPodemos observar, entretanto, que cada itera\u00e7\u00e3o deste procedimento requer que seja resolvida\n\numa inst\u00e2ncia de um problema da mochila, cuja dificuldade de resolu\u00e7\u00e3o \u00e9 compar\u00e1vel a do problema.\n\nAssim, s\u00e3o utilizadas heur\u00edsticas para a obten\u00e7\u00e3o de cortes que podem n\u00e3o ser \u00f3timos, mas s\u00e3o bons\n\no suficiente para reduzir o poliedro de maneira a auxiliar na resolu\u00e7\u00e3o do problema original com\n\nalgoritmos de planos de corte ou Branch and Cut.\n\nSabemos que C ={4, 5, 6} \u00e9 uma cobertura m\u00ednima para a restri\u00e7\u00e3o da mochila (3.3). Vamos agora\n\nilustrar o procedimento para obter os fatores de lifting das vari\u00e1veis de decis\u00e3o que n\u00e3o pertencem \u00e0\n\ncobertura. Primeiro constru\u00edmos uma ordena\u00e7\u00e3o de N\\C = ? j1, j2, j3, j4? = ?1, 2, 3, 7?, r = 4. Para\n\neste procedimento, considere impl\u00edcita a restri\u00e7\u00e3o x ? B|C|+t?1. Efetuamos ent\u00e3o o processo iterativo,\n\ncomo segue:\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 30\n\nt = 1 j1 = 1\n1) ?1 = max x4 + x5 + x6\n\ns.a. 3x4 + 2x5 + 2x6 6 6?a1 = 6?5 = 1\n2) ?1 = 0\n3) ?1 = |C|?1??1 = 2\n\nt = 2 j2 = 2\n4) ?2 = max 2x1 + x4 + x5 + x6\n\ns.a. 5x1 + 3x4 + 2x5 + 2x6 6 1\n5) ?2 = 0\n6) ?2 = |C|?1??2 = 2\n\nt = 3 j3 = 3\n7) ?3 = max 2x1 + 2x2 + x4 + x5 + x6\n\ns.a. 5x1 + 5x2 + 3x4 + 2x5 + 2x6 6 2\n8) ?3 = 1\n9) ?3 = |C|?1??3 = 1\n\nt = 4 j4 = 7\n10) ?4 = max 2x1 + 2x2 + x3 + x4 + x5 + x6\n\ns.a. 5x1 + 5x2 + 4x3 + 3x4 + 2x5 + 2x6 6 5\n11) ?4 = 2\n12) ?7 = |C|?1??4 = 0\n\nChegamos ent\u00e3o \u00e0 desigualdade:\n\n?1x1 + ?2x2 + ?3x3 + x4 + x5 + x6 + ?7x7 6 2\n2x1 + 2x2 + x3 + x4 + x5 + x6 6 2\n\nv\u00e1lida para X . Esta restri\u00e7\u00e3o nos define a face F ={x ? conv(P?Z7) : 2x1 + 2x2 + x3 + x4 + x5 + x6 =\n\n2}. Considere os pontos x1 = (1, 0, 0, 0, 0, 0, 0,), x2 = (0, 1, 0, 0, 0, 0, 0), x3 = (0, 0, 1, 0, 1, 0, 0),\n\nx4 = (0, 0, 0, 1, 1, 0, 0), x5 = (0, 0, 0, 1, 0, 1, 0), x6 = (0, 0, 0, 0, 1, 1, 0), x7 = (0, 0, 1, 0, 0, 1, 1).\n\nNotamos que x j ? F , j = 1, . . . , 7, e que estes pontos s\u00e3o afim independentes. Ent\u00e3o dim(F) = 6, e\n\ncomo dim(F ) = dim(P?)?1, P? = conv(P?Z7), F \u00e9 uma faceta do poliedro P?.\n\n3.3.4 Down-lifting\n\nLifting pode ser entendido como o procedimento onde tomamos a face induzida pela desigualdade\n\nda cobertura, ? j?C x j 6 |C|?1, do poliedro da formula\u00e7\u00e3o do problema da mochila acrescido das\nequa\u00e7\u00f5es x j = 0 para j ? N\\C. Ent\u00e3o rotacionamos a desigualdade de cobertura de forma a se obter\n\numa face de maior dimens\u00e3o para o poliedro original da mochila.\n\nUm procedimento an\u00e1logo pode ser realizado com uma face definida por equa\u00e7\u00f5es da forma x j = 1\n\n[22, 25]. Para qualquer cobertura C e qualquer subconjunto D ?C, a desigualdade:\n\n?\nj?C\\D\n\nx j 6 |C|?|D|?1\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 31\n\n\u00e9 v\u00e1lida para o poliedro restrito:\n\nconv({x ? B|C|?|D| : ?\nj?N\\D\n\na j x j 6 b? ?\nj?D\n\na j}).\n\nO lifting da se\u00e7\u00e3o anterior pode ser utilizado sobre C\\D para produzir uma desigualdade:\n\n?\nj?C\\D\n\nx j + ?\nj?N\\C\n\n? jx j 6 |C|?|D|?1.\n\ndiminuindo a capacidade da mochila para b?? j?D a j , pois x j = 1, j ? D, e considerando os somat\u00f3-\nrios sobre C\\D, assim como ? jt = |C|?|D|?1??t . O c\u00f4mputo destes fatores (N\\C) algumas vezes\n\u00e9 chamado de up-lifting, para diferenciar dos fatores das vari\u00e1veis fixadas em 1 (D).\n\nFinalmente, a desigualdade acima pode ser submetida a um processo de down-lifting dos fatores\n\nde D para se obter uma faceta da forma:\n\n?\nj?C\\D\n\nx j + ?\nj?N\\C\n\n? jx j + ?\nj?D\n\n? jx j 6 |C|?|D|?1 + ?\nj?D\n\n? j\n\nonde ? j = ? j ?(|C|?|D|)?1, e os fatores ?t , jt ?? j1, . . . , jr? \u00e9 uma ordena\u00e7\u00e3o de D, s\u00e3o obtidos\nresolvendo o problema:\n\n?t = Maximize ?\nj?C\\D\n\nx j + ?\nj?N\\C\n\n? j x j +\nt?1\n\n?\ni=1\n\n? ji x ji\n\nSujeito a: ?\ni?N\\D\n\na j x j 6 b? ?\nj?D\n\na j +\nt\n\n?\ni=1\n\na ji\n\nx ? B|N|?|D|+t?1\n\nTemos a desigualdade da cobertura correspondente a C = {4, 5, 6}, dada por x4 + x5 + x6 6 2.\n\nFazendo D ={5}, obtemos a desigualdade x4 + x6 6 1 para conv(P?{x ?B|N| : x5 = 1}). Executando\n\nlifting para x3, calculamos:\n\n?3 = max{x4 + x6 : 3x4 + 2x6 6 0} = 0\n\ne portanto, ?3 = |C|?|D|?1??3 = 1, obtendo a desigualdade x3 + x4 + x6 6 1.\n\nRealizando lifting para x7, calculamos primeiramente:\n\n?7 = max{x3 + x4 + x6 : 4x3 + 3x4 + 2x6 6 3} = 1\n\nque nos leva a deduzir que ?7 = 0. Da\u00ed resulta a desigualdade x3 + x4 + x6 6 1.\n\nExecutando down-lifting na vari\u00e1vel x5, desejamos calcular ?5 tal que:\n\n?5x5 + x3 + x4 + x6 6 1 + ?5 (3.8)\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 32\n\npermane\u00e7a v\u00e1lida quando x5 = 0. Note que, qualquer que seja o valor de ?5, (3.8) \u00e9 v\u00e1lida quando\nx5 = 1. Para isto,\n\n?5 > max{x3 + x4 + x6 : 4x3 + 3x4 + 2x6 + x7 6 6}?1 = ?5 ?1\n\nCalculando ?5, descobrimos que ?5 = 2 e portanto ?5 > 2?1 = 1 que nos permite obter a desigualdade\nx3 + x4 + x5 + x6 6 2.\n\nContinuamos agora com o lifting de x1. Devemos calcular ?1 = max{x3 + x4 + x5 + x6 : 4x3 +\n3x4 + 2x6 + x7 6 1} = 0. Conclu\u00edmos que ?1 = 2?0 = 2. Para a \u00faltima vari\u00e1vel, x2, computamos\n?2 = max{2x1 + x3 + x4 + x5 + x6 : 5x1 + 4x3 + 3x4 + 2x6 + x7 6 1}= 0, permitindo calcular que ?2 = 2\ne obter a desigualdade v\u00e1lida\n\n2x1 + 2x2 + x3 + x4 + x5 + x6 6 2.\n\nCoincidentemente chegamos \u00e0 mesma desigualdade obtida na se\u00e7\u00e3o anterior. J\u00e1 foi demonstrado que\n\nesta desigualdade induz uma faceta para o poliedro P? = conv(P?Z7).\n\nA ordem em que os fatores de lifting s\u00e3o calculados \u00e9 importante na constru\u00e7\u00e3o da faceta. \u00c9 poss\u00ed-\n\nvel obter desigualdades diferentes para uma mesma cobertura modificando apenas a ordem de c\u00e1lculo.\n\nOutro ponto a considerar na ordena\u00e7\u00e3o \u00e9 que os subproblemas gerados sejam sempre fact\u00edveis. Por\n\nisto, em nosso exemplo alternamos o c\u00f4mputo dos fatores de up-lifting com os de down-lifting.\n\n3.4 O problema da mochila com restri\u00e7\u00f5es de preced\u00eancia\n\nNa se\u00e7\u00e3o anterior vimos que para a inst\u00e2ncia apresentada do nosso problema da mochila, as va-\n\nri\u00e1veis de decis\u00e3o assumiram valor xT = (0, 0, 0, 1, 0, 1, 1) para uma solu\u00e7\u00e3o \u00f3tima. Portanto para esta\n\ninst\u00e2ncia o alpinista deveria levar a ra\u00e7\u00e3o, os grampos e o aparelho de GPS (Tabela 3.2). Entretanto,\n\nn\u00e3o faz sentido que o alpinista leve os grampos sem que ele tamb\u00e9m leve a corda, mas a corda pode\n\nser \u00fatil sem os grampos. Assim em nosso problema hipot\u00e9tico temos uma restri\u00e7\u00e3o de preced\u00eancia\n\nde que os grampos s\u00f3 podem ser levados se a corda tamb\u00e9m for. Na Figura 3.4 apresentamos uma\n\nrepresenta\u00e7\u00e3o para esta restri\u00e7\u00e3o e a estendemos aos outros elementos da mochila. Para representar as\n\nrestri\u00e7\u00f5es de preced\u00eancia utilizamos um grafo ac\u00edclico direcionado G = (V, E) em que seus v\u00e9rtices\n\nV = {1, . . . , 7} s\u00e3o os pr\u00f3prios elementos da mochila e suas arestas E = {(2, 6), (3, 6), (4, 1)} indicam\n\na preced\u00eancia.\n\nA seguir, apresentamos algumas defini\u00e7\u00f5es que ser\u00e3o necess\u00e1rias para a obten\u00e7\u00e3o de desigualda-\n\ndes v\u00e1lidas para o problema da mochila com restri\u00e7\u00f5es de preced\u00eancia.\n\nDefini\u00e7\u00e3o 3.17 Dizemos que i precede j, denotado por i ? j, se existe um caminho de i at\u00e9 j em G.\n\nEsta defini\u00e7\u00e3o significa que i deve ser carregado na mochila antes que j seja considerado.\n\nDefini\u00e7\u00e3o 3.18 Dizemos que i precede propriamente j, denotado por i ? j, se i ? j e i 6= j.\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 33\n\nn item utilidade tamanho levar\n1 Fogareiro 2 5 n\u00e3o\n2 Corda 7 5 n\u00e3o\n3 Colchonete 2 4 n\u00e3o\n4 Ra\u00e7\u00e3o 4 3 sim\n5 Primeiros Socorros 3 2 n\u00e3o\n6 Grampos 7 2 sim\n7 Aparelho de GPS 6 1 sim\n\nTabela 3.2: Solu\u00e7\u00e3o para uma inst\u00e2ncia do problema da mochila sem restri\u00e7\u00e3o de preced\u00eancia\n\n1\n\n23 4\n\n5 67\n\nCorda\n\nGrampos\n\nRa\u00e7\u00e3o\n\nFogareiro\n\nColchonete\n\nGPS\nPrimeiros\nSocorros\n\nFigura 3.4: Exemplo de restri\u00e7\u00e3o de preced\u00eancia\n\nDefini\u00e7\u00e3o 3.19 Dado um conjunto S ?V , l(S) = {i : i ? j para algum j ? S} \u00e9 o conjunto suporte de\n\nS. Para apenas um elemento, l(i) = l({i}).\n\nO conjunto suporte cont\u00e9m todos os predecessores de S. Note que S ? l(S).\n\nDefini\u00e7\u00e3o 3.20 Dado um conjunto S ?V , H(S) = {i ? S : ? j ? S|i ? j} \u00e9 o conjunto das folhas de S,\n\ne R(S) = {i ? S : ? j ? S| j ? i} \u00e9 o conjunto das ra\u00edzes de S.\n\nConsidere o grafo da Figura 3.4 e S = {1, 2, 6}. Ent\u00e3o l(S) = {1, 2, 3, 4, 6}, H(l(S)) = {1, 6} e\n\nR(l(S)) = {2, 3, 4}.\n\n3.4.1 Defini\u00e7\u00e3o do problema\n\nFormalmente, o problema da mochila com restri\u00e7\u00f5es de preced\u00eancia pode ser definido como:\n\ndado um grafo de preced\u00eancia ac\u00edclico direcionado G = (V, E) de v\u00e9rtices V = {1, . . . , n} e arestas\n\nE ?V \u00d7V , um peso ci e um volume ai, i ?V , para cada v\u00e9rtice e uma capacidade b da mochila,\n\nPMP : Maximize ?\nj?V\n\nc jx j\n\nSujeito a: x j > 0 j ? H(V )\n\nx j 6 1 j ? R(V )\n\nx j 6 xi ?(i, j) ? E\n\n?\nj?V\n\na jx j 6 b\n\nx j ? B j ?V\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 34\n\nDefini\u00e7\u00e3o 3.21 ? j = ?i?l( j) ai \u00e9 a capacidade m\u00ednima da mochila necess\u00e1ria para selecionar o ele-\nmento j e seus predecessores.\n\nProposi\u00e7\u00e3o 3.4 Se max{? j : j ? H(V )} 6 b, ent\u00e3o dim(P?) = n, onde P? = conv(P?Zn) [26].\n\n3.4.2 K-coberturas\n\nAqui vamos generalizar o conceito de cobertura ao problema da mochila com restri\u00e7\u00f5es de pre-\n\nced\u00eancia e estend\u00ea-lo com a no\u00e7\u00e3o de K-cobertura.\n\nDefini\u00e7\u00e3o 3.22 b(S) = ?i?S ai, S ?V \u00e9 o volume ocupado pelos elementos de S.\n\nDefini\u00e7\u00e3o 3.23 C ?V \u00e9 uma cobertura se:\n\ni. b(C) > b,\n\nii. l(C) = C.\n\nDefini\u00e7\u00e3o 3.24 C ?V \u00e9 uma K-cobertura se:\n\ni. C \u00e9 uma cobertura,\n\nii. Para todo conjunto S ? H(C) com |S| = K, b(l(S)) > b,\n\niii. Para todo i ? S, b(l(S)\\{i}) 6 b.\n\nA partir de agora, tomemos uma nova capacidade b = 11 para a mochila em nossos exemplos.\n\nConsidere o conjunto C = {1, 3, 4} para o exemplo do problema da mochila. C \u00e9 uma cober-\n\ntura, pois l(C) = {1, 3, 4} e b(C) = 5 + 4 + 3 = 12 > 11, que atende \u00e0 Defini\u00e7\u00e3o 3.23. Note que\n\nH(C) ={1, 3}. Se tomarmos o conjunto S ={1, 3}, S ?H(C), temos b(l(S)) = b({1, 3, 4}) = 12 > b.\n\nS tamb\u00e9m atende \u00e0 condi\u00e7\u00e3o 3 da Defini\u00e7\u00e3o 3.24, pois para cada i ? S, se i = 1, b(l(S)\\{1}) =\n\nb({3, 4}) = 7 6 11; e se i = 3, b({1, 4}) = 8 6 11. Portanto, C \u00e9 uma 2-cobertura.\n\nProposi\u00e7\u00e3o 3.5 Dado uma K-cobertura C ?V , a desigualdade\n\n?\ni?H(C)\n\nxi 6 K ?1 (3.9)\n\n\u00e9 uma faceta para PC se, e somente se,\n\n\\\n\n{S?H(C):|S|=K?1}\n\nl(S) = /0\n\nNote na 2-cobertura C = {1, 3, 4} que\nT\n\n{S?{1,3}:|S|=1} l(S) = l({1})? l({3}) = {1, 4}?{3} = /0,\nportanto a desigualdade induzida pela cobertura x1 + x3 6 2 \u00e9 uma faceta para PC.\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 35\n\n3.4.3 Lifting\n\nConsiderando a desigualdade de K-cobertura em (4.6), podemos obter atrav\u00e9s de um processo de\n\nlifting uma desigualdade mais forte que englobe as vari\u00e1veis n\u00e3o contempladas na K-cobertura, ou\n\nseja,\n\n?\ni?H(C)\n\nxi + ?\ni?V\\C\n\n?ixi 6 K ?1\n\nsendo ?i, i ? V\\C, os fatores de lifting. Da mesma forma que no problema cl\u00e1ssico da mochila, os\nfatores de lifting dependem da cobertura e a ordem na qual o procedimento \u00e9 aplicado. Em virtude\n\ndas restri\u00e7\u00f5es de preced\u00eancia, temos ainda que impor uma ordena\u00e7\u00e3o topol\u00f3gica na ordem de lifting,\n\npara garantir que o procedimento seja bem definido. Seja C? = ?i1, . . . , iT? uma ordena\u00e7\u00e3o topol\u00f3gica\n\ndos elementos de V\\C, ou seja, ik ? ih para todo 1 6 h &lt;k 6 T . Ent\u00e3o o fator de lifting ?it pode ser\ncalculado resolvendo o problema\n\n?t = Maximize ?\nj?H(C)\n\nx j +\nt?1\n\n?\nj=1\n\n?i j xi j\n\nSujeito a: x ?XUt|Wt\n\nonde XUt|Wt = {x ? X : xi = 0 para todo i ?U , enquanto xi = 1 para todo i ?W}, Ut = {it+1, . . . , iT},\n\nWt = {it} e ?i j = K ?1?? j, j = 1, . . . ,t ?1, s\u00e3o obtidos recursivamente, e ?it = K ?1??t .\n\nPara aplicarmos programa\u00e7\u00e3o inteira no c\u00f4mputo dos fatores de lifting, precisamos encontrar\n\numa formula\u00e7\u00e3o do conjunto XUt|Wt . O problema dado a seguir corresponde a uma formula\u00e7\u00e3o em\n\nprograma\u00e7\u00e3o matem\u00e1tica que pode ser utilizada para obter ?t :\n\n?t = Maximize ?\nj?H(C)\n\nx j +\nt?1\n\n?\nj=1\n\n?i j xi j\n\nSujeito a: ?\nj?Vt\n\na j x j 6 b\n\nxi > x j (i, j) ? Et\n\nxit = 1\n\nxi ? B i ?Vt\n\nonde Gt = (Vt , Et ) \u00e9 o grafo induzido de G por Vt = C?{i1, . . . , it}, ou seja, Gt = G[Vt ].\n\nConsidere a cobertura C = {1, 3, 4}, e uma ordena\u00e7\u00e3o topol\u00f3gica C? = ?2, 6, 5, 7? dos elementos\n\nque n\u00e3o pertencem \u00e0 cobertura. Para obter os fatores de lifting inicialmente temos Vt = {1, 2, 3, 4}\n\ne resolvemos ?1 = {max x1 + x3 : 5x1 + 5x2 + 4x3 + 4x4 6 11, x4 > x1, x2 = 1} = 1, com solu\u00e7\u00e3o\n(x1, . . . , x7) = (0, 1, 1, 0, 0, 0, 0). Assim obtemos ?2 = K ?1??1 = 0. Para o elemento seguinte de\nC?, ?2 = {max x1 + x3 : 5x1 + 5x2 + 4x3 + 4x4 + 2x6 6 11, x4 > x1, x3 > x6, x2 > x6, x6 = 1} = 1, com\n(x1, . . . , x7) = (0, 1, 1, 0, 0, 1, 0). Portanto ?6 = 0.\n\nO c\u00f4mputo de ?5 \u00e9 feito por ?3 = {max x1 + x3 : 5x1 + 5x2 + 4x3 + 4x4 + 2x5 + 2x6 6 11, x4 >\nx1, x3 > x6, x2 > x6, x5 = 1} = 1, obtendo (x1, . . . , x7) = (0, 0, 1, 1, 1, 0, 0) que implica em ?5 = 0.\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 36\n\nE por fim ?4 = {max x1 + x3 : 5x1 + 5x2 + 4x3 + 4x4 + 2x5 + 2x6 + x7 6 11, x4 > x1, x3 > x6, x2 >\nx6, x7 = 1}= 1, com (x1, . . . , x7) = (0, 0, 1, 1, 0, 0, 1) que resulta em ?7 = 0. Todos os fatores de lifting\nassumiram valor zero, ent\u00e3o a desigualdade\n\nx1 + x3 6 2\n\ntamb\u00e9m \u00e9 uma faceta para conv(P?Z7).\n\n3.5 Lineariza\u00e7\u00e3o por partes\n\nConsideremos o problema de otimiza\u00e7\u00e3o separ\u00e1vel:\n\nPsep : Maximize F =\nn\n\n?\nj=1\n\nf j(x j)\n\nonde x ? X ? Rn s\u00e3o as poss\u00edveis solu\u00e7\u00f5es para o problema e f j \u00e9 uma fun\u00e7\u00e3o n\u00e3o-linear qualquer. F\n\n\u00e9 dita separ\u00e1vel porque seus elementos f j s\u00e3o fun\u00e7\u00f5es apenas de uma vari\u00e1vel x j.\n\nTomaremos agora a fun\u00e7\u00e3o f j(x j) e para simplificar a nota\u00e7\u00e3o eliminaremos o \u00edndice j. A lineari-\n\nza\u00e7\u00e3o por partes consiste em selecionar k + 1 pontos P ={pi : pi = (ai, f (ai)), a0 = l, ak = u, ai?1 &lt;ai}\n\nque perten\u00e7am a uma regi\u00e3o [l, u] do dom\u00ednio de x e interpol\u00e1-los por retas, formando a fun\u00e7\u00e3o linear\n\npor partes f? (x). A Figura 3.5 ilustra a fun\u00e7\u00e3o n\u00e3o-linear f (x) e sua lineariza\u00e7\u00e3o por partes f? (x). Cada\n\npar de pontos ri = (pi?1, pi), i = 1, . . . , k, forma uma regi\u00e3o da fun\u00e7\u00e3o linear f? (x). Apresentaremos a\n\nseguir tr\u00eas modelos de aproxima\u00e7\u00e3o de f (x) em fun\u00e7\u00f5es lineares por partes utilizando programa\u00e7\u00e3o\n\nlinear inteira mista.\n\n3.5.1 Modelo com pesos por ponto (Modelo I)\n\nNesta primeira abordagem utilizamos vari\u00e1veis de decis\u00e3o reais ?i associadas ao peso de cada\nponto pi, e vari\u00e1veis de decis\u00e3o inteiras yi que selecionam a regi\u00e3o de f? (x). Temos ent\u00e3o a seguinte\n\nformula\u00e7\u00e3o:\n\nx =\nk\n\n?\ni=0\n\nai?i (3.10a)\n\nf? (x) =\nk\n\n?\ni=0\n\nf (ai)?i (3.10b)\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 37\n\na0 = 0 a1 = 1 a2 = 2 a3 = 3 a4 = 4\n\n?0\n\n?1\n\n?2\n\n?3\n\n?4\n\ny1 y2 y3 y4\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\nx\n\nf / f?\n\nf (x)\n\nf? (x)\n\nFigura 3.5: Lineariza\u00e7\u00e3o por partes para o modelo por pesos\n\ncom restri\u00e7\u00f5es:\n\n?0 6 y1 (3.11a)\n\n?i 6 yi + yi+1 i = 1, . . . , k?1 (3.11b)\n\n?k 6 yk (3.11c)\nk\n\n?\ni=0\n\n?i = 1 (3.11d)\n\nk\n\n?\ni=1\n\nyi = 1 (3.11e)\n\n?i > 0 i = 0, . . . , k (3.11f)\n\n?i ? R i = 0, . . . , k (3.11g)\n\nyi ? B i = 1, . . . , k (3.11h)\n\nTomemos como exemplo a Figura 3.5, com os valores dos pontos conforme indicado. Desejamos\n\nrepresentar de acordo com o modelo x = 2, 7. Assim, y3 = 1 e yi = 0, i 6= 3, seleciona apenas a\n\nregi\u00e3o r3 (restri\u00e7\u00f5es (3.11e) e (3.11h)). As vari\u00e1veis (?0, . . . , ?4) assumem valores (0, 0, 0,3, 0,7, 0)\n(restri\u00e7\u00f5es (3.11d), (3.11f) e (3.11g)). Para as restri\u00e7\u00f5es (3.11a) a (3.11c) temos:\n\n?0 6 y1 =? ?0 6 0 (3.11a)\n?1 6 y1 + y2 =? ?1 6 0 + 0 = 0 (3.11b)\n?2 6 y2 + y3 =? ?2 6 0 + 1 = 1\n?3 6 y3 + y4 =? ?3 6 1 + 0 = 1\n?4 6 y4 =? ?4 6 0 (3.11c)\n\nOs valores de x e f? (x) s\u00e3o calculados por (3.10a) e (3.10a) respectivamente:\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 38\n\nx = 0\u00b70 + 1\u00b70 + 2\u00b70, 3 + 3\u00b70, 7 + 4\u00b70\n\n= 0, 6 + 2, 1 = 2, 7\n\nf? (x) = 1\u00b70 + 4\u00b70 + 2\u00b70, 3 + 6\u00b70, 7 + 4\u00b70\n\n= 0, 6 + 4, 2 = 4, 8\n\nObservamos que o ponto desejado x = 2, 7 est\u00e1 entre a2 e a3. Portanto, y3 = 1 seleciona apenas\n\naquela regi\u00e3o. Observamos tamb\u00e9m que ?3 assumiu um valor maior que ?2, pois x est\u00e1 mais pr\u00f3ximo\nde a3, devendo sua vari\u00e1vel de peso ser mais expressiva.\n\n3.5.2 Modelo seq\u00fcencial de pesos (Modelo II)\n\nNeste modelo, escrevemos x como:\n\nx = a0 + ?1 + . . . + ?k\n\nonde 0 6 ?i 6 ai ?ai?1, i = 1, . . . , k.\n\nDesejamos representar um dado x que pertence a uma regi\u00e3o r da fun\u00e7\u00e3o. Ent\u00e3o ?i assume:\n\n?i =\n\n?\n\n?\n\n?\n\n?\n\n?\n\nai ?ai?1 se i &lt;r\n\nx?ai se i = r\n\n0 se i > r\n\nAssim chegamos a formula\u00e7\u00e3o:\n\nx =a0 +\nk\n\n?\ni=1\n\n?i (3.12a)\n\nf? (x) = f (a0) +\nk\n\n?\ni=1\n\nf (ai)? f (ai?1)\nai ?ai?1\n\n?i (3.12b)\n\ncom restri\u00e7\u00f5es:\n\n?1 6 a1 ?a0 (3.13a)\n\n?i 6 (ai ?ai?1)yi?1 i = 2, . . . , k (3.13b)\n\n?i > (ai ?ai?1)yi i = 1, . . . , k?1 (3.13c)\n\n?k > 0 (3.13d)\n\n?i ? R i = 1, . . . , k (3.13e)\n\nyi ? B i = 1, . . . , k?1 (3.13f)\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 39\n\na0 = 0 a1 = 1 a2 = 2 a3 = 3 a4 = 4\n\n?1\n\n?2\n\n?3\n\n?4\n\ny1 y2 y3\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\nx\n\nf / f?\n\nf (x)\n\nf? (x)\n\nFigura 3.6: Lineariza\u00e7\u00e3o por partes para o modelo seq\u00fcencial\n\nNote que em (3.13c) est\u00e1 impl\u00edcito ?i > 0, pois ?i > (ai?ai?1)yi > 0, sendo yi ?{0, 1} e ai > ai?1.\nAs vari\u00e1veis inteiras yi selecionam as regi\u00f5es anteriores a x. Assim, se considerarmos que x pertence\n\na uma regi\u00e3o r,\n\nyi =\n\n{\n\n1 se i &lt;r\n\n0 se i > r\n\nObservamos em (3.13f) que yi \u00e9 definido apenas at\u00e9 i = k?1, sendo desnecess\u00e1rio yk, pois se x\n\npertencer \u00e0 \u00faltima regi\u00e3o, yi = 1, ?i ?{1, . . . , k?1}.\n\nPara o mesmo exemplo do modelo anterior, buscamos x = 2, 7. Como a2 6 x 6 a3, r = 3 e\n\n(y1, y2, y3) = (1, 1, 0). As vari\u00e1veis reais (?1, . . . , ?4)= (1, 1, 0,7, 0). A Figura 3.6 ilustra este modelo\ne as restri\u00e7\u00f5es ficam:\n\n?1 6 a1 ?a0 =? ?1 6 1?0 = 1 (3.13a)\n?1 > (a1 ?a0)y1 =? ?1 > (1?0)1 = 1 (3.13c)\n\n? ?1 = 1\n?2 6 (a2 ?a1)y1 =? ?2 6 (2?1)1 = 1 (3.13b)\n?2 > (a2 ?a1)y2 =? ?2 > (2?1)1 = 1 (3.13c)\n\n? ?2 = 1\n?3 6 (a3 ?a2)y2 =? ?3 6 (3?2)1 = 1 (3.13b)\n?3 > (a3 ?a2)y3 =? ?3 > (3?2)0 = 0 (3.13c)\n\n? 0 6 ?3 6 1\n?4 6 (a4 ?a3)y3 =? ?4 6 (4?3)0 = 0 (3.13b)\n?4 > 0 (3.13d)\n\n? ?4 = 0\n\nOs valores de x e f? (x) s\u00e3o calculados por (3.12a) e (3.12b) respectivamente:\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 40\n\nx = a0 + ?1 + ?2 + ?3 + ?4\n= 0 + 1 + 1 + 0, 7 + 0 = 2, 7\n\nf? (x) = f (a0) +\nf (a1)? f (a0)\n\na1 ?a0\n?1 +\n\nf (a2)? f (a1)\na2 ?a1\n\n?2 +\n\n+\nf (a3)? f (a2)\n\na3 ?a2\n?3 +\n\nf (a4)? f (a3)\na4 ?a3\n\n?4\n\n= 1 + 3\u00b71 + (?2)\u00b71 + 4\u00b70, 7 + (?2)\u00b70\n\n= 4, 8\n\nPadberg apresenta em [27] uma compara\u00e7\u00e3o entre este modelo (Modelo II) e o anterior (Modelo\n\nI). Ele faz uma transforma\u00e7\u00e3o do Modelo I para o espa\u00e7o de vari\u00e1veis de decis\u00e3o do Modelo II, e\n\nmostra que o Modelo II est\u00e1 estritamente contido nesta transforma\u00e7\u00e3o do Modelo I. Mostra ainda\n\nque os v\u00e9rtices do poliedro correspondente \u00e0 relaxa\u00e7\u00e3o linear do Modelo II s\u00e3o todos inteiros com\n\nrespeito \u00e0s vari\u00e1veis y. Isto implica que a solu\u00e7\u00e3o de um problema de otimizar uma fun\u00e7\u00e3o linear por\n\npartes pode ser obtida por meio de programa\u00e7\u00e3o linear pura. Neste aspecto, o Modelo II \u00e9 considerado\n\nlocalmente muito melhor que o Modelo I. Padberg prop\u00f5e ainda que o Modelo I n\u00e3o seja utilizado,\n\npois esta formula\u00e7\u00e3o \u00e9 sempre igual ou melhor que a anterior, mesmo no pior caso e que o Modelo I\n\ndeveria ser definitivamente abandonado, apesar de sua popularidade nos livros texto.\n\nEntretanto sob o aspecto did\u00e1tico, o Modelo I \u00e9 mais intuitivo que o II, devido ao significado de\n\nsuas vari\u00e1veis de decis\u00e3o e simplicidade das restri\u00e7\u00f5es. Em um exerc\u00edcio alg\u00e9brico, Padberg pro-\n\np\u00f5e uma formula\u00e7\u00e3o que transforma o Modelo II no espa\u00e7o de vari\u00e1veis de decis\u00e3o de I, mas suas\n\nrestri\u00e7\u00f5es continuam pouco intuitivas. Ent\u00e3o Sherali prop\u00f5e em [28] uma formula\u00e7\u00e3o simples com\n\nvari\u00e1veis de decis\u00e3o semelhantes \u00e0s do Modelo I e com as caracter\u00edsticas poliedrais do Modelo II.\n\n3.5.3 Modelo de Sherali (Modelo III)\n\nSherali prop\u00f5e em [28] uma \u201cformula\u00e7\u00e3o did\u00e1tica\u201d para a lineariza\u00e7\u00e3o por partes. Nesta formu-\n\nla\u00e7\u00e3o, s\u00e3o utilizadas duas vari\u00e1veis de peso para cada regi\u00e3o da lineariza\u00e7\u00e3o: ?Li \u00e9 o peso do ponto \u00e0\nesquerda da regi\u00e3o e ?Ri \u00e9 o peso do ponto \u00e0 direita da regi\u00e3o. Tamb\u00e9m s\u00e3o empregadas vari\u00e1veis yi\ninteiras que selecionam a regi\u00e3o. Esta formula\u00e7\u00e3o \u00e9 mais geral que as anteriores, pois permite tamb\u00e9m\n\nlinearizar fun\u00e7\u00f5es descont\u00ednuas.\n\nx =\nk\n\n?\ni=1\n\n[ai?1?Li + ai?\nR\ni ] (3.14a)\n\nf? (x) =\nk\n\n?\ni=1\n\n[ f (ai?1)?Li + f (ai)?\nR\ni ] (3.14b)\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 41\n\na0 = 0 a1 = 1 a2 = 2 a3 = 3 a4 = 4\n\n?L1\n\n?R1 ?\nL\n2\n\n?R2 ?\nL\n3\n\n?R3 ?\nL\n4\n\n?R4\n\ny1 y2 y3 y4\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\nx\n\nf / f?\n\nf (x)\n\nf? (x)\n\nFigura 3.7: Lineariza\u00e7\u00e3o por partes para o modelo de Sherali\n\ncom restri\u00e7\u00f5es\n\n?Li + ?\nR\ni = yi i = 1, . . . , k (3.15a)\n\nk\n\n?\ni=1\n\nyi = 1 (3.15b)\n\n?i > 0 i = 1, . . . , k (3.15c)\n\n?i ? R i = 1, . . . , k (3.15d)\n\nyi ? B i = 1, . . . , k (3.15e)\n\nNa Figura 3.7 vemos uma ilustra\u00e7\u00e3o deste modelo. Para exemplificar, representamos x = 2, 7.\n\nPara selecionar a regi\u00e3o r3 de x, as vari\u00e1veis inteiras yi assumem valores (y1, . . . , y4) = (0, 0, 1, 0),\n\natendendo as restri\u00e7\u00f5es (3.15b) e (3.15e). Devido \u00e0s restri\u00e7\u00f5es (3.15a), (3.15c) e (3.15d), ?Li e ?\nR\ni = 0,\n\ni ?{1, 2, 4}; e ?L3 = 0, 3 e ?\nR\n3 = 0, 7.\n\nCom (3.14a) e (3.14b) calculamos x e f? (x), como apresentado a seguir. Como ?Li e ?\nR\ni s\u00e3o nulos\n\npara i ?{1, 2, 4}, estes termos ser\u00e3o omitidos.\n\nx = a2?L3 + a3?\nR\n3\n\n= 2\u00b70, 3 + 3\u00b70, 7 = 2, 7\n\nf? (x) = f (a2)?L3 + f (a3)?\nR\n3\n\n= 2\u00b70, 3 + 6\u00b70, 7 = 4, 8\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 42\n\nDo exemplo apresentado, (3.15a) e (3.15b) s\u00e3o escritas matricialmente como A?x = b?,\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n1 1 ?1 0 0 0 0 0 0 0 0 0\n\n0 0 0 1 1 ?1 0 0 0 0 0 0\n\n0 0 0 0 0 0 1 1 ?1 0 0 0\n\n0 0 0 0 0 0 0 0 0 1 1 ?1\n\n0 0 1 0 0 1 0 0 1 0 0 1\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nx =\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n0\n\n0\n\n0\n\n0\n\n1\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nxT =\n[\n\n?L1 ?\nR\n1 y1 ?\n\nL\n2 ?\n\nR\n2 y2 ?\n\nL\n3 ?\n\nR\n3 y3 ?\n\nL\n4 ?\n\nR\n4 y4\n\n]\n\nDesejamos mostrar que A? \u00e9 totalmente unimodular. As colunas das vari\u00e1veis ? possuem apenas\numa linha diferente de zero. De acordo com Newhauser [22], estas colunas podem ser desconsidera-\n\ndas. Note que a matriz resultante (colunas de y) corresponde a uma matriz de incid\u00eancia [21, p\u00e1gina\n\n40], que \u00e9 totalmente unimodular. Assim, a matriz A? tamb\u00e9m \u00e9 totalmente unimodular.\n\nAs restri\u00e7\u00f5es (3.15c) a (3.15e), na forma yi > 0 e yi 6 1 para todo i = 1, . . . , k, implicam em\n\nidentidades que s\u00e3o concatenadas \u00e0 matriz A?, e n\u00e3o afetam sua unimodularidade. Note tamb\u00e9m que\n\nas restri\u00e7\u00f5es de igualdade podem ser transformadas em desigualdades (?T x = ?0 =? ?T x > ?0 e\n?T x 6 ?0). Assim, a matriz de restri\u00e7\u00f5es para esta formula\u00e7\u00e3o \u00e9 totalmente unimodular.\n\nA conseq\u00fc\u00eancia \u00e9 que o poliedro desta formula\u00e7\u00e3o \u00e9 m\u00ednimo, ou seja, ele corresponde ao poliedro\n\ndo fecho convexo das solu\u00e7\u00f5es, e todos seus v\u00e9rtices est\u00e3o sobre pontos inteiros. Assim, apenas\n\nprograma\u00e7\u00e3o linear \u00e9 suficiente para resolver um problema de lineariza\u00e7\u00e3o por partes pura. Em [28]\n\nSherali mostra que se f (x) for cont\u00ednua, sua formula\u00e7\u00e3o \u00e9 equivalente \u00e0 do Modelo II.\n\nEm [29] apresentamos uma compara\u00e7\u00e3o entre o modelo com pesos por ponto (Modelo I) com\n\no modelo de Sherali (Modelo III). Aplicamos os modelos ao problema de aloca\u00e7\u00e3o \u00f3tima de g\u00e1s de\n\ninje\u00e7\u00e3o com restri\u00e7\u00e3o de capacidade m\u00e1xima de inje\u00e7\u00e3o, mas sem a restri\u00e7\u00e3o de preced\u00eancia de ati-\n\nva\u00e7\u00e3o. Executamos experimentos num\u00e9ricos em inst\u00e2ncias com 32 e 64 po\u00e7os de petr\u00f3leo, aplicando\n\no algoritmo de Branch and Bound puro, sem o uso de gera\u00e7\u00e3o autom\u00e1tica de cortes. Os experimen-\n\ntos mostraram que as formula\u00e7\u00f5es baseadas no modelo de Sherali apresentaram sempre um n\u00famero\n\nmenor de itera\u00e7\u00f5es do algoritmo em rela\u00e7\u00e3o \u00e0s formula\u00e7\u00f5es baseadas no Modelo I, e portanto, que o\n\nmodelo apresenta resultados melhores tamb\u00e9m quando n\u00e3o \u00e9 aplicado de maneira pura, isto \u00e9, com\n\noutras restri\u00e7\u00f5es al\u00e9m das do modelo (no caso, restri\u00e7\u00f5es de capacidade m\u00e1xima de inje\u00e7\u00e3o de g\u00e1s).\n\n3.6 Sum\u00e1rio\n\nNeste cap\u00edtulo vimos que a otimiza\u00e7\u00e3o \u00e9 a \u00e1rea da matem\u00e1tica aplicada que busca uma solu\u00e7\u00e3o\n\n\u00f3tima (m\u00ednima ou m\u00e1xima) para um problema atendendo a restri\u00e7\u00f5es. Vimos que ela \u00e9 dividida em\n\nv\u00e1rios dom\u00ednios, e nos aprofundamos no dom\u00ednio que envolve vari\u00e1veis inteiras. Estudamos o pro-\n\nblema da mochila e vimos mais detalhadamente o problema com restri\u00e7\u00f5es de preced\u00eancia, que ser\u00e1\n\naplicado ao problema de otimiza\u00e7\u00e3o de g\u00e1s de inje\u00e7\u00e3o. Mostramos como obter desigualdades fortes\n\npara esta formula\u00e7\u00e3o, que s\u00e3o importantes para agilizar o processo de resolu\u00e7\u00e3o do problema. Por fim,\n\n\n\n3. Fundamentos de otimiza\u00e7\u00e3o inteira 43\n\napresentamos tr\u00eas modelos de lineariza\u00e7\u00e3o por partes de fun\u00e7\u00f5es separ\u00e1veis utilizando programa\u00e7\u00e3o\n\nlinear inteira-mista.\n\n\n\nCap\u00edtulo 4\n\nModelo linear por partes\n\nNa Se\u00e7\u00e3o 2.3 apresentamos uma formula\u00e7\u00e3o geral para o problema de aloca\u00e7\u00e3o \u00f3tima de g\u00e1s de\n\ninje\u00e7\u00e3o sob restri\u00e7\u00f5es da capacidade m\u00e1xima de inje\u00e7\u00e3o de g\u00e1s e de preced\u00eancia de ativa\u00e7\u00e3o. Neste\n\ncap\u00edtulo a curva de performance do po\u00e7o (CPP) ser\u00e1 linearizada por partes e aplicaremos programa\u00e7\u00e3o\n\nlinear inteira-mista sobre P(G).\n\nEm seguida apresentaremos desigualdades v\u00e1lidas para o poliedro da formula\u00e7\u00e3o, derivadas a par-\n\ntir das desigualdades de cobertura para o problema da mochila sob restri\u00e7\u00f5es de preced\u00eancia, as quais\n\npodem ser empregadas na gera\u00e7\u00e3o de cortes em um algoritmo de planos de corte. Os conceitos intro-\n\nduzidos ser\u00e3o elucidados por meio de exemplos. As formula\u00e7\u00f5es e demonstra\u00e7\u00f5es apresentadas neste\n\ncap\u00edtulo foram desenvolvidas por Nakashima[19]. Camponogara e Conto apresentam sinteticamente\n\nem [30] o desenvolvimento mostrado neste cap\u00edtulo.\n\n4.1 Formula\u00e7\u00e3o do problema\n\nDesejamos uma formula\u00e7\u00e3o linear por partes para a formula\u00e7\u00e3o apresentada na Se\u00e7\u00e3o 2.3. Para\n\nisto, aplicamos o modelo de lineariza\u00e7\u00e3o proposto por Sherali [28] (Se\u00e7\u00e3o 3.5.3) devido a sua simpli-\n\ncidade e caracter\u00edsticas poliedrais.\n\nA Figura 4.1 apresenta uma aproxima\u00e7\u00e3o linear por partes de um po\u00e7o n para uma curva con-\n\nt\u00ednua. A aproxima\u00e7\u00e3o \u00e9 obtida diretamente de pontos amostrados da CPP Qn = {(qn,1in , q\nn,1\nout ), . . . ,\n\n(q\nn,?(n)\nin , q\n\nn,?(n)\nout )}, onde ?(n) \u00e9 o n\u00famero de pontos de amostra. Alternativamente, se a CPP est\u00e1 na\n\nforma de uma curva cont\u00ednua q?nout , a aproxima\u00e7\u00e3o linear por partes pode ser produzida tomando uma\n\nquantidade arbitr\u00e1ria de pontos desta curva, que refletem a qualidade da lineariza\u00e7\u00e3o. Vari\u00e1veis bi-\n\nn\u00e1rias xn,k s\u00e3o necess\u00e1rias para indicar qual segmento linear est\u00e1 representado na fun\u00e7\u00e3o objetivo:\n\nxn,1 = 1 se o po\u00e7o n est\u00e1 desativado, neste caso q\nn\nin = q\n\nn\nout = 0; note que yn = 1?xn,1. Para k > 2,\n\nxn,k = 1 se, e somente se, (q\nn\nin, q\n\nn\nout ) \u00e9 uma combina\u00e7\u00e3o convexa dos pontos extremos do k-\u00e9simo in-\n\ntervalo, isto \u00e9, (qnin, q\nn\nout ) = ?\n\nL\nn,k(q\n\nn,k?1\nin , q\n\nn,k?1\nout ) + ?Rn,k(q\n\nn,k\nin , q\n\nn,k\nout ) com ?Ln,k + ?\n\nR\nn,k = 1 e ?\n\nL\nn,k , ?\n\nR\nn,k > 0.\n\n\n\n4. Modelo linear por partes 45\n\nxn,1 xn,2 xn,3 xn,4 xn,5\n\n0 q\nn,1\nin q\n\nn,2\nin q\n\nn,3\nin q\n\nn,4\nin q\n\nn,?(n)\nin\n\nq\nn,1\nout\n\nq\nn,2\nout\n\nqnin\n\nqnout\n\n?Ln,2\n\n?Rn,2\n\n?Ln,3\n\n?Rn,3\n?Ln,4\n\n?Rn,4 ?Ln,5\n\n?Rn,5\n\nFigura 4.1: Lineariza\u00e7\u00e3o por partes da CPP de um po\u00e7o n.\n\nPara cada n ?N = {1, . . . , N}, temos as seguintes restri\u00e7\u00f5es:\n\n?(n)\n\n?\nk=1\n\nxn,k = 1 (4.1a)\n\nyn = 1?xn,1 (4.1b)\n\n?Ln,k, ?\nR\nn,k > 0, k = 2, . . . , ?(n) (4.1c)\n\n?Ln,k + ?\nR\nn,k = xn,k, k = 2, . . . , ?(n) (4.1d)\n\nqnin =\n?(n)\n\n?\nk=2\n\n(qn,k?1in ?\nL\nn,k + q\n\nn,k\nin ?\n\nR\nn,k) (4.1e)\n\nqnout =\n?(n)\n\n?\nk=2\n\n(qn,k?1out ?\nL\nn,k + q\n\nn,k\nout ?\n\nR\nn,k) (4.1f)\n\nxn,k ?{0, 1} k = 1, . . . , ?(n) (4.1g)\n\nPara o conjunto de pontos Qn, obtidos diretamente por testes no po\u00e7o ou da lineariza\u00e7\u00e3o da apro-\n\nxima\u00e7\u00e3o q?nout da CPP, assumimos algumas hip\u00f3teses que n\u00e3o implicam em perda da generalidade do\n\nproblema:\n\nHip\u00f3tese 4.1 Para cada po\u00e7o n ?N :\n\n1. 0 &lt;qn,kin &lt;q\nn,k+1\nin , para todo 1 6 k &lt;?(n), implica que as taxas de inje\u00e7\u00e3o s\u00e3o distintas e\n\nconsecutivas;\n\n2. qn,1in = ln e q\nn,?(n)\nin = un 6 q\n\nmax\nin para eliminar pontos desnecess\u00e1rios; e\n\n3. cada ponto qn,k = (qn,kin , q\nn,k\nout )?Q\n\nn, 2 &lt;k &lt;?(n), n\u00e3o \u00e9 uma combina\u00e7\u00e3o convexa de (qn,k?1in , q\nn,k?1\nout )\n\ne (q\nn,k+1\nin , q\n\nn,k+1\nout ), para descartar pontos redundantes.\n\nSeja f n,k = fn(q\nn,k\nin , q\n\nn,k\nout ) = (po?no + pg?\n\nn\ng ? pw?\n\nn\nw)q\n\nn,k\nout ? pinq\n\nn,k\nin a contribui\u00e7\u00e3o na fun\u00e7\u00e3o lucro do\n\npo\u00e7o n operando no ponto (qn,kin , q\nn,k\nout ), podemos levar a lineariza\u00e7\u00e3o por partes para a fun\u00e7\u00e3o objetivo:\n\nMaximize f =\nN\n\n?\nn=1\n\n?(n)\n\n?\nk=2\n\n(?Ln,k f\nn,k?1 + ?Rn,k f\n\nn,k) (4.2)\n\n\n\n4. Modelo linear por partes 46\n\nPortanto, a formula\u00e7\u00e3o linear inteira por partes Ppl (G) \u00e9 composta pela fun\u00e7\u00e3o objetivo (4.2), pelas\n\nrestri\u00e7\u00f5es (4.1a) a (4.1g), e pelas restri\u00e7\u00f5es de capacidade m\u00e1xima de inje\u00e7\u00e3o de g\u00e1s e preced\u00eancia. No\n\nAp\u00eandice B apresentamos uma formula\u00e7\u00e3o linear por partes para P(G) que considera a concavidade\n\nda curva de performance do po\u00e7o. Esta formula\u00e7\u00e3o utiliza uma propriedade do modelo de Sherali\n\n[28] que permite uma redu\u00e7\u00e3o no n\u00famero de vari\u00e1veis de decis\u00e3o inteiras caso a curva linear por\n\npartes possua regi\u00f5es c\u00f4ncavas. O modelo apresentado n\u00e3o implica em uma redu\u00e7\u00e3o da complexidade\n\ncomputacional da resolu\u00e7\u00e3o do problema, mas o menor n\u00famero de vari\u00e1veis inteiras pode significar\n\num n\u00famero menor de n\u00f3s na \u00e1rvore de busca de Branch and Bound, e consequentemente um menor\n\ntempo de processamento.\n\nBaseado na an\u00e1lise das restri\u00e7\u00f5es de Ppl (G), algumas vari\u00e1veis de decis\u00e3o podem ser descartadas,\n\ne as restri\u00e7\u00f5es reformuladas para uma formula\u00e7\u00e3o mais compacta. Para cada po\u00e7o n, as vari\u00e1veis que\n\npodem ser expressas como fun\u00e7\u00e3o de outras s\u00e3o:\n\n?Rn,k = xn,k ??\nL\nn,k k = 2, . . . , ?(n) (4.3a)\n\nqnin =\n?(n)\n\n?\nk=2\n\n[qn,k?1in ?\nL\nn,k + q\n\nn,k\nin ?\n\nR\nn,k]\n\n=\n?(n)\n\n?\nk=2\n\n[qn,kin xn,k ?(q\nn,k\nin ?q\n\nn,k?1\nin )?\n\nL\nn,k] (4.3b)\n\nxn,1 = 1?\n?(n)\n\n?\nk=2\n\nxn,k (4.3c)\n\nyn =\n?(n)\n\n?\nk=2\n\nxn,k (4.3d)\n\nAplicando \u00e0 Ppl (G) estas substitui\u00e7\u00f5es e algumas outras que ser\u00e3o apresentadas a seguir, obtemos a\n\nformula\u00e7\u00e3o linear por partes compacta:\n\nPcpl (G) : Maximize f =\nN\n\n?\nn=1\n\n?(n)\n\n?\nk=2\n\n[ f n,k xn,k ?( f\nn,k ? f n,k?1)?n,k] (4.4a)\n\nSujeito a:\nN\n\n?\nn=1\n\n?(n)\n\n?\nk=2\n\n[q\nn,k\nin xn,k ?(q\n\nn,k\nin ?q\n\nn,k?1\nin )?n,k] 6 q\n\nmax\nin (4.4b)\n\n?(n)\n\n?\nk=2\n\nxn,k 6\n?(m)\n\n?\nk=2\n\nxm,k ?(m, n) ? E(G) (4.4c)\n\n?(n)\n\n?\nk=2\n\nxn,k 6 1 ?n ? R(G) (4.4d)\n\n?n,k > 0, ?(n, k) ? ? (4.4e)\n\nxn,k ??n,k > 0 ?(n, k) ? ? (4.4f)\n\nxn,k ?{0, 1} ?(n, k) ? ? (4.4g)\n\nonde ?n,k = ?Ln,k , R(G) = { j ? V (G) : ?(i, j) ? E(G)} \u00e9 o conjunto das ra\u00edzes de G e ? = {(n, k) :\nn = 1, . . . , N, k = 2, . . . , ?(n)} \u00e9 o conjunto de pares po\u00e7os e n\u00edveis de ativa\u00e7\u00e3o, isto \u00e9, o conjunto de\n\u00edndices dos pontos da representa\u00e7\u00e3o linear por partes da CPP. Note que as restri\u00e7\u00f5es (4.4e) e (4.4f)\n\n\n\n4. Modelo linear por partes 47\n\ngarantem que xn,k > 0. Ainda, as restri\u00e7\u00f5es (4.4c) e (4.4d) implicam que xn,k 6 1 para qualquer\n\ncaminho ?i, j, . . .? de G com i ? R(G), assim, \u00e9 suficiente impor a restri\u00e7\u00e3o ?\n?(i)\nk=2 xi,k = yi 6 1.\n\nSejam ?n = {?n,k : k = 2, . . . , ?(n)} os fatores que induzem a combina\u00e7\u00e3o convexa dos elemen-\ntos de Qn, e ? = ?Nn=1?n. Sejam xn = {xn,k : k = 2, . . . , ?(n)} as vari\u00e1veis discretas que for\u00e7am a\ncombina\u00e7\u00e3o convexa a usar apenas dois elementos consecutivos de Qn, e x = ?Nn=1xn. Chamemos o\n\nconjunto das solu\u00e7\u00f5es fact\u00edveis do problema de aloca\u00e7\u00e3o de g\u00e1s sob restri\u00e7\u00f5es de preced\u00eancia de X .\n\nDefinimos o poliedro P = {(x, ?) ? RK?N \u00d7RK?N : (x, ?) que satisfa\u00e7a as restri\u00e7\u00f5es (4.4b) a (4.4f) },\nonde K = ?Nn=1 ?(n). Ent\u00e3o P \u00e9 uma formula\u00e7\u00e3o para X , pois X =P ?(Z\n\nK?N \u00d7RK?N ).\n\n4.2 Desigualdades v\u00e1lidas\n\nNo cap\u00edtulo anterior apresentamos de maneira geral como obter desigualdades v\u00e1lidas para o pro-\n\nblema da mochila sob restri\u00e7\u00e3o de preced\u00eancia. Podemos observar que Pcpl (G) se enquadra nesta\n\nclasse de problemas, pois (4.4b) \u00e9 uma restri\u00e7\u00e3o linear do tipo da mochila e (4.4c) \u00e9 a restri\u00e7\u00e3o de\n\npreced\u00eancia. Nesta se\u00e7\u00e3o, apresentaremos fam\u00edlias de desigualdades v\u00e1lidas de conv(X ) que ser\u00e3o\n\nadicionadas a P para torn\u00e1-lo mais forte. Com estas desigualdades v\u00e1lidas podemos utilizar o algo-\n\nritmo de Branch and Cut apresentado no cap\u00edtulo anterior.\n\nCome\u00e7amos apresentando as condi\u00e7\u00f5es para as quais conv(X ) possui dimens\u00e3o cheia. Estas\n\ncondi\u00e7\u00f5es garantem que o poliedro n\u00e3o possui vari\u00e1veis redundantes e depend\u00eancias lineares, sim-\n\nplificando as provas de maximalidade das faces induzidas pelas desigualdades. Seja An = {m ? V :\n\nm ? n}\\{n} o conjunto de predecessores do n\u00f3 n. Seja ?n = ?m?An q\nm,1\nin \u00e9 a quantia m\u00ednima de g\u00e1s\n\nnecess\u00e1ria para ativar os po\u00e7os que precedem n.\n\nProposi\u00e7\u00e3o 4.1 conv(X ) possui dimens\u00e3o cheia se max{?n + q\nn,?(n)\nin : n ?N } 6 q\n\nmax\nin .\n\nProva: Seja T = ?n1, n2, . . . , nN? uma ordena\u00e7\u00e3o topol\u00f3gica de G. Seja Z uma matriz 2(K ?N)\u00d7\n\n2(K ?N) em que as colunas correspondem as vari\u00e1veis xn1,2, ?n1,2, . . ., xn1,?(n1), ?n1,?(n1), . . ., xnN ,2,\n?nN ,2, . . ., xnN ,?(nN ), ?nN ,?(nN ) nesta ordem, da esquerda para a direita. Para i = 1, . . . , N e k = 2, . . . , ?(ni):\nseja zi,k = (xi,k , ?i,k) o vetor de incid\u00eancia obtido definindo xi,kl,2 = ?\n\ni,k\nl,2 = 1 para todo l ? Ani , e x\n\ni,k\nni,k\n\n= 1,\n\nenquanto todas as outras entradas s\u00e3o nulas. Seja z?i,k = (x?i,k, ??i,k) id\u00eantico a zi,k , exceto que ??i,kni,k = 1;\ncomo as restri\u00e7\u00f5es de preced\u00eancia s\u00e3o respeitadas e max{?n + q\n\nn,?(n)\nin : n ?N } 6 q\n\nmax\nin , z\n\ni,k e z?i,k\n\npertencem a Pcpl (G).\n\nSejam zi,k e z?i,k as linhas de Z ordenadas como foram inicializadas no procedimento acima. Ent\u00e3o\n\nZ \u00e9 uma matriz triangular inferior e sua diagonal possui apenas uns. Ainda, rank(Z) = 2(K ?N) e\n\ncomo o vetor nulo tamb\u00e9m pertence a Pcpl (G), conclu\u00edmos que dim(Pcpl (G)) = 2(K ?N). ?\n\n4.2.1 Coberturas\n\nNo cap\u00edtulo anterior apresentamos o conceito de coberturas para o problema da mochila com res-\n\ntri\u00e7\u00f5es de preced\u00eancia. Nesta se\u00e7\u00e3o apresentaremos a aplica\u00e7\u00e3o deste conceito aplicado ao problema\n\n\n\n4. Modelo linear por partes 48\n\n1\n\n2 3\n\n4 5 6 7\n\n8 9 10\n\n11 12\n\nC\n\nH(C)\n\nFigura 4.2: Grafo de restri\u00e7\u00e3o de preced\u00eancia G = (V, E)\n\nN\u00edveis de inje\u00e7\u00e3o qn,kin\nn\\k 1 2 3 4 5 6 ?(n) ?n\n1 0,5 2 3 4 5 6 6 0\n2 1 2 3 4 5 5,5 6 0,5\n3 1 2 3 4 5 6 6 0\n4 1 2 3 4 4,5 5 1,5\n5 1 2 3 3,5 4 2,5\n6 1 2 3 4 5 5 1\n7 1 2 3 4 5 6 6 0\n8 1 2 2,5 3 3,5\n9 1 2 3 3 3\n10 1 2 3 4 5 5 1\n11 1 1,5 2 4,5\n12 1 1,5 2 4,5\n\nTabela 4.1: Taxa de inje\u00e7\u00e3o para os po\u00e7os de petr\u00f3leo\n\nque estamos estudando. Iniciaremos com um exemplo ilustrativo, e em seguida o generalizaremos\n\napresentando a defini\u00e7\u00e3o formal.\n\nConsidere um cen\u00e1rio simples com 12 po\u00e7os e o grafo de preced\u00eancia descrito da Figura 4.2. Os\n\nvalores de qn,kin da CPP linear por partes s\u00e3o apresentados na Tabela 4.1. A quantia total de g\u00e1s de\n\ninje\u00e7\u00e3o dispon\u00edvel \u00e9 qmaxin = 6. Os valores q\nn,k\nout n\u00e3o s\u00e3o necess\u00e1rios para a an\u00e1lise do poliedro conv(X ),\n\ne est\u00e3o impl\u00edcitos na forma linear por partes da fun\u00e7\u00e3o objetivo.\n\nDado o conjunto ? definido na se\u00e7\u00e3o anterior, tomamos o conjunto C ??, com C ={ (1,2), (2,2),\n(3,2), (4,3), (5,3), (6,3) }. Considere:\n\ni) Seja N(S) = {n : (n, k) ? S} o conjunto de po\u00e7os com pares no subconjunto S ? ?. Como\nN(C) = {1, 2, 3, 4, 5, 6}, todos os pares em C s\u00e3o de po\u00e7os distintos.\n\nii) Dado qualquer S ? ?, seja l(S) = ?n?N(S)(An ?{n}) o conjunto de todos os predecessores\nde N(S) incluindo os elementos de N(S). Observe que l(C) = N(C) significa que o subgrafo\n\n\n\n4. Modelo linear por partes 49\n\ninduzido G[N(C)] cont\u00e9m todos os n\u00f3s que precedem n\u00f3s de N(C).\n\niii) Para S ? ?, seja H(S) = {(n, k) ? S : ?(m, j) ? S tal que n ? m} os pares de S em que os n\u00f3s\nn\u00e3o precedam nenhum outro elemento de S. Note que H(C) = { (4,3), (5,3), (6,3) } e que para\n\ntodo (n, k) ?C\\H(C) = { (1,2), (2,2), (3,2) } temos k = 2.\n\niv) Para S??, seja ?(S) = ?(n,k)?S q\nn,k?1\nin a quantidade m\u00ednima de g\u00e1s necess\u00e1rio para ativar o po\u00e7o\n\nn em um n\u00edvel k (xn,k = 1) para todo (n, k) ? S. Observe que ?(C) = 0, 5 + 1 + 1 + 2 + 2 + 2 =\n8, 5 > qmaxin .\n\nDas considera\u00e7\u00f5es (i) a (iv), conclu\u00edmos que os elementos de H(C) n\u00e3o podem ser ativados simul-\n\ntaneamente porque demandaria mais g\u00e1s de inje\u00e7\u00e3o que o dispon\u00edvel. Isto significa que C \u00e9 uma\n\ncobertura que induz a desigualdade v\u00e1lida ?(n,k)?H(C) xn,k 6 |H(C)|?1. No exemplo, a desigualdade\nda cobertura \u00e9 x4,3 + x5,3 + x6,3 6 2.\n\nDefini\u00e7\u00e3o 4.1 C ? ? \u00e9 uma cobertura se:\n\ni. C possui no m\u00e1ximo um elemento (n, k) ? ? para cada n ?N ;\n\nii. l(C) = N(C);\n\niii. k = 2 para todo (n, k) ?C\\H(C);\n\niv. ?(C) > qmaxin .\n\nDefini\u00e7\u00e3o 4.2 Uma cobertura C \u00e9 m\u00ednima se ?(C\\{n, k}) 6 qmaxin para cada (n, k) ? H(C).\n\nUma cobertura \u00e9 um conjunto de pontos de opera\u00e7\u00e3o de po\u00e7os em um campo de petr\u00f3leo que\n\nseja realiz\u00e1vel (condi\u00e7\u00e3o i) e respeite a restri\u00e7\u00e3o de preced\u00eancia (condi\u00e7\u00f5es ii e iii), e que n\u00e3o exista\n\nrecurso suficiente para que o campo opere nestes pontos de opera\u00e7\u00e3o (iv). Uma covertura \u00e9 m\u00ednima se\n\nexcluindo qualquer um dos pontos de opera\u00e7\u00e3o de C, exista recurso suficiente para operar o conjunto\n\nrestante.\n\n4.2.2 K-Coberturas\n\nDado um subconjunto de n\u00f3s U ?N , seja ?(U ) = {(n, k) ? ? : n ? U} o conjunto de pares\n\u201cpo\u00e7o/n\u00edvel de ativa\u00e7\u00e3o\u201d em que os po\u00e7os est\u00e3o em U . Para K = 2, H(C) possui tr\u00eas conjuntos\n\nde cardinalidade K: S4,5 = {(4,3), (5,3)}, S4,6 = {(4,3), (6,3)} e S5,6 = {(5,3), (6,3)}; que induzem\n\nos conjuntos de preced\u00eancia l(S4,5) = {1, 2, 3, 4, 5}, l(S4,6) = {1, 2, 3, 4, 6} e l(S5,6) = {1, 2,\n\n3, 5, 6}. Estes conjuntos de preced\u00eandia induzem subconjuntos de pares ?4,5, ?4,6 e ?5,6 dados\npor ?4,5 = ?(l(S4,5))?C = {(1,2), (2,2), (3,2), (4,3), (5,3)}, ?4,6 = ?(l(S4,6))?C = {(1,2), (2,2),\n(3,2), (4,3), (6,3)} e ?5,6 = ?(l(S5,6))?C = {(1,2), (2,2), (3,2), (5,3), (6,3)}. Observe que ?(?4,5) =\n?(?4,6) = ?(?5,6) = 6, 5 > 6 = qmaxin , implicando que ?4,5, ?4,6 e ?5,6 s\u00e3o cada um uma cobertura,\nconforme definido anteriormente. Como ?(?m,n\\{(i, j)}) = 4, 5 &lt;qmaxin para todo (m, n) ?{(4,5),\n\n\n\n4. Modelo linear por partes 50\n\n(4,6), (5,6)} e (i, j) ? Sm,n, verificamos que ?4,5, ?4,6 e ?5,6 s\u00e3o coberturas m\u00ednimas. Como qualquer\nsubconjunto de H(C) com cardinalidade K = 2 induz uma cobertura m\u00ednima, C \u00e9 chamado de K-\n\ncobertura e implica na desigualdade v\u00e1lida:\n\n?\n(n,k)?H(C)\n\nxn,k = x4,3 + x5,3 + x6,3 6 1 = K ?1, (4.5)\n\nque \u00e9 mais forte que a desigualdade anterior. O conceito K-coberturas \u00e9 formalizado a seguir. Dado\n\numa cobertura C e um subconjunto S ? ?, ?S = ?(l(S))?C denota pares de C cujos po\u00e7os aparecem\nna lista de predecessores de S.\n\nDefini\u00e7\u00e3o 4.3 Uma cobertura C \u00e9 uma K-cobertura se:\n\ni. ?(?S) > qmaxin para todo S ? H(C) com |S| = K, onde ?S = ?(l(S))?C; mas\n\nii. ?(?S\\{(n, k)}) 6 qmaxin para todo (n, k) ? S.\n\nC \u00e9 uma K-cobertura se for uma cobertura e todo subconjunto S de C que respeite as restri\u00e7\u00f5es\n\nde preced\u00eancia, e com cardinalidade K, for uma cobertura m\u00ednima de acordo com as Defini\u00e7\u00f5es 4.1 e\n\n4.2.\n\nEm seguida, trataremos de um conjunto de pares expandidos de uma K-cobertura S, definido por\n\n?(S) = {(n, i) : (n, k) ? S e 2 6 i 6 k} que adiciona a S pares cujo po\u00e7o est\u00e1 em S e cujo n\u00edvel de\nativa\u00e7\u00e3o \u00e9 menor que o de S. Para a cobertura C dada anteriormente, ?(C) = { (1,2), (2,2), (3,2),\n(4,2), (4,3), (5,2), (5,3), (6,2), (6,3) }. Note que a desigualdade (4.5) \u00e9 v\u00e1lida porque n\u00e3o existe\n\nrecurso de inje\u00e7\u00e3o suficiente para simultaneamente ativar todos os pares de qualquer subconjunto de\n\nH(C) com cardinalidade K. A proposi\u00e7\u00e3o a seguir formaliza esta desigualdade.\n\nProposi\u00e7\u00e3o 4.2 Se C \u00e9 uma K-cobertura ent\u00e3o\n\n?\n(n,k)?H(C)\n\nxn,k 6 K ?1 (4.6)\n\n\u00e9 v\u00e1lida para o poliedro conv(XC ) ondeXC ={(x, ?) ?X : xn,k = ?n,k = 0 para todo (n, k)? ?\\?(C)}\n\u00e9 o conjunto de solu\u00e7\u00f5es que podem ativar apenas pares de ?(C).\n\nEsta proposi\u00e7\u00e3o mostra que a desigualdade da K-cobertura \u00e9 v\u00e1lida para a proje\u00e7\u00e3o de conv(X )\n\nno espa\u00e7o expandido pelas vari\u00e1veis de \u00edndices ?(C), que \u00e9 o poliedro conv(XC ). Obviamente, a\ndesigualdade \u00e9 v\u00e1lida para conv(X ).\n\nContinuando o exemplo, considere ?4,5 de maneira que ?((?4,5\\{(4, 3)}) ?{(4, 2)}) = 5, 5&lt;\nqmaxin e ?((?4,5\\{(5, 3)})?{(5, 2)}) = 5, 5 &lt;q\n\nmax\nin . Isto significa que ?4,5 n\u00e3o \u00e9 mais uma cobertura se\n\nqualquer elemento (n, k) ? H(?4,5) for substitu\u00eddo por (n, k?1), ou simplesmente removido quando\nk = 2. Esta propriedade tamb\u00e9m pode ser verificada para ?4,6 e ?5,6. Uma K-cobertura \u00e9 estrita\nse esta propriedade \u00e9 satisfeita por cada cobertura induzida ?S, onde S ? H(C),|S| = K, e ?S =\n?(l(S))?C.\n\n\n\n4. Modelo linear por partes 51\n\nDefini\u00e7\u00e3o 4.4 Uma K-cobertura C \u00e9 estrita se, para todo S ? H(C), |S| = K, e todo (n, k) ? S valer:\n\ni. ?(?S\\{(n, k)}) &lt;qmaxin se k = 2; ou\n\nii. ?((?S\\{(n, k)})?{(n, k?1)}) &lt;qmaxin quando k > 2.\n\nK-coberturas estritas possuem a propriedade de serem m\u00e1ximas ou facetas de conv(XC ). Neste\n\nsentido elas s\u00e3o o mais forte poss\u00edvel, pois um poliedro \u00e9 representado unicamente por facetas. Antes\n\nde apresentarmos as condi\u00e7\u00f5es de maximalidade, definimos uma solu\u00e7\u00e3o zS = (xS, ?S) ?X induzida\npor S ? ? como: para todo (n, k) ? ?, xSn,k = 1 e ?\n\nS\nn,k = 1 se (n, k) ? S, caso contr\u00e1rio x\n\nS\nn,k = 0 e\n\n?Sn,k = 0.\n\nProposi\u00e7\u00e3o 4.3 Dado uma K-cobertura estrita C, a desigualdade (4.6) induz uma face m\u00e1ximaFC =\n\n{(x, ?) ? conv(XC ) : ?(n,k)?H(C) xn,k = K ?1} de conv(XC ) se, e somente se:\n\n\\\n\n{S?H(C):|S|=K?1}\n\n?(l(S))?C = /0 (4.7)\n\nProva: (Necessidade) Suponha que (4.7) n\u00e3o \u00e9 obedecida e seja (m, i) ?\nT\n\n{S?H(C):|S|=K?1} ?(l(S))?\nC. Para qualquer T ? C tal que z(T ) ?FC, (m, i) deve aparecer em T . Ent\u00e3o todo z = (x, ?) ?FC\ndeve satisfazer xm,i = 1. ComoFC ?F = {(x, ?) ? conv(XC ) : xm,i = 1}, conclu\u00edmos que para FC ser\nm\u00e1xima, FC =F , mas (4.6) n\u00e3o \u00e9 um m\u00faltiplo escalar de xm,i 6 1, contradizendo a suposi\u00e7\u00e3o.\n\n(Sufici\u00eancia) Para mostrar que (4.6) induz uma faceta, seja F? uma face m\u00e1xima de PC contendo\n\nFC e induzida por:\n\n?\n(n,k)??(C)\n\n?n,kxn,k + ?\n(n,k)??(C)\n\n\u00b5n,k ?Ln,k 6 ?0 (4.8a)\n\nMostraremos que (4.6) e (4.8a) diferem apenas de uma constante multiplicativa, que prova a proposi-\n\n\u00e7\u00e3o.\n\n[Parte I] Considere qualquer (n, k)?A(C) = C\\H(C). Tem que existir T ?H(C) com |T|= K?1\n\ntal que n ? l(T ). Seja ?T = ?(l(T ))?C. Claramente z?T ?FC. Seja z?\n?\nT id\u00eantico a z?T exceto que\n\n??\n?\nT\n\nn,k = 1??. Para um ? > 0 suficientemente pequeno, z\n??T ?FC pois C \u00e9 uma K-cobertura estrita.\n\nPortanto, para z?T e z?\n?\nT pertencerem a F?, z\n\n?T e z?\n?\nT devem satisfazer:\n\n?\n(n,k)??(C)\n\n?n,kxn,k + ?\n(n,k)??(C)\n\n\u00b5n,k ?n,k = ?0 (4.8b)\n\nSubtraindo (4.8b) com z?\n?\nT de (4.8b) com z?T conclu\u00edmos que \u00b5n,k = 0.\n\n[Parte II] Considere qualquer (n, k) ? H(C) e fa\u00e7a T ? H(C) de maneira que (n, k) ? T e |T| =\n\nK?1. Claramente z?T ?FC para ?T = ?(l(T ))?C. Seja z?\n?\nT id\u00eantico a z?T exceto que ??\n\n?\nT\n\nn,k = 1??.\nCom ? > 0 pequeno o suficiente, z?\n\n?\nT ? FC. Como z\n\n?T e z?\n?\nT devem satisfazer (4.8b), conclu\u00edmos\n\nque \u00b5n,k = 0. Agora considere algum k\n? &lt;k. Seja T ? H(C)\\{(n, k)} um sub-conjunto de maneira\n\nque |T| = K ?1. Claramente, z? ? FC para ? = (?(l(T )?An)?C)?{(n, k?)} porque C \u00e9 uma\n\n\n\n4. Modelo linear por partes 52\n\nK-cobertura estrita. Seja z?\n?\n\nid\u00eantico a z? exceto que ??\n?\n\nn,k = 1??. Para um ? > 0 suficientemente\npequeno, z?\n\n?\n?FC. Para z\n\n?, z?\n?\n\npertencerem a FC, z\n? e z?\n\n?\ndevem satisfazer (4.8b), que nos leva a\n\ndeduzir que \u00b5n,k? = 0. Do desenvolvimento acima, conclu\u00edmos que \u00b5n,k = 0 para todo (n, k) ? ?(C) e,\nent\u00e3o, (4.8a) se reduz a:\n\n?\n(n,k)??(C)\n\n?n,kxn,k 6 ?0 (4.8c)\n\n[Parte III] Considere qualquer (n, k) ? A(C). Como (4.7) \u00e9 v\u00e1lido, deve existir T ? H(C) com\n\n|T| = K ?1 de maneira que n 6? l(T ) e (m, j) ? H(C)\\T com n ? Am. Pela defini\u00e7\u00e3o de K-cobertura,\n\n?(?) 6 qmaxin para ? = ?(l(T )?Am)?C, e uma vez que (An ?{n}) ? Am, temos: (i) ?(?\n?) 6 qmaxin\n\npara ?? = ?(l(T )?An?{n})?C; e (ii) ?(???) 6 qmaxin para ?\n?? = ??\\{(n, k)}. Portanto, z(??) e z(???)\n\npertencem a FC, e para t\u00ea-los em F?, devem satisfazer (4.8c) na igualdade. Que nos leva a concluir\n\nque ?n,k = 0.\n\n[Parte IV ] Seja (n, k)??(C)\\(A(C)?H(C)). Como C \u00e9 uma K-cobertura estrita, deve existir T ?\nH(C) com |T| = K ?1 de maneira que: (i) n 6? N(T ); (ii) ?(??) 6 qmaxin para ?\n\n? = ?(l(T )?An)?C;\ne (iii) ?(???) 6 qmaxin para ?\n\n?? = ???{(n, k)}. Claramente, z?\n?\n\ne z?\n??\n\npertencem a FC, e assim (4.8c)\n\ndeve ser satisfeita na igualdade, implicando que ?n,k = 0. Deduzimos ent\u00e3o que (4.8c) se reduz a:\n\n?\n(n,k)?H(C)\n\n?n,kxn,k 6 ?0 (4.8d)\n\n[Parte V ] Considere qualquer par de pontos distintos (n, i), (m, j) ?H(C) e fa\u00e7a S ?H(C)\\{(n, i),\n\n(m, j)} de maneira que |S| = K ?2. Pela defini\u00e7\u00e3o da K-cobertura, ?(??) 6 qmaxin para ?\n? = ?(l(S?\n\n{(n, i)}))?C e ?(???) 6 qmaxin para ?\n?? = ?(l(S?{(m, j)}))?C. Claramente, z?\n\n?\ne z?\n\n??\npertencem\n\na FC. Uma vez que z\n?? e z?\n\n??\ndevem pertencer a F?, eles devem satisfazer (4.8d) na igualdade,\n\nque nos leva a deduzir que ?n,i = ?m, j . Assumindo, sem perda de generalidade, ?n,k = 1 para todo\n(n, k) ? H(C), temos que ?0 = K ? 1. Consequentemente, (4.6) difere de (4.8a) apenas de uma\nconstante multiplicativa, demostrando que (4.6) \u00e9 m\u00e1xima.\n\n?\n\nPara a K-cobertura estrita C do exemplo ilustrativo, note que ?{S?H(C):|S|=K?1}?(l(S))?C =\n?{S?{(4,3),(5,3),(6,3)}:|S|=1}?(l(S))?C = ?(l({(4, 3)}))??(l({(5, 3)}))??(l({(6, 3)}))?C = /0. Como\nC satisfaz a condi\u00e7\u00e3o (4.7), tempos que (4.5) induz uma faceta de conv(XC ).\n\nUma K-cobertura estrita C \u00e9 chamada de cobertura (estritamente) m\u00ednima se |H(C)| = K. \u00c9\n\nevidente da defini\u00e7\u00e3o de K-cobertura que todo S ? H(C) com |S| = K induz uma cobertura m\u00ednima\n\n?S = ?(l(S))?C. No exemplo ilustrativo, a K-cobertura C n\u00e3o \u00e9 m\u00ednima, pois H(C) = 3 > 2 = K.\nCom S = {(4, 3), (5, 3)} a cobertura ?S \u00e9 m\u00ednima, pois |H(?S)| = K.\n\nUma K-cobertura C n\u00e3o m\u00ednima \u00e9 mais forte que qualquer cobertura m\u00ednima induzida ?S no\nsentido que ?(n,k)?H(C) xn,k 6 K ?1 =? ?(n,k)?S xn,k 6 K ?1. No exemplo, qualquer desigualdade\nx4,3 + x5,3 6 1, x4,3 + x6,3 6 1 e x5,3 + x6,3 6 1, obtida de uma cobertura m\u00ednima ?S \u00e9 claramente mais\n\n\n\n4. Modelo linear por partes 53\n\nfraca que (4.5). \u00c9 necess\u00e1rio aplicar um procedimento de arredondamento (2x4,3 + 2x5,3 + 2x6,3 6\n\n3)/2 =? x4,3 + x5,3 + x6,3 6 ?3/2? =? x4,3 + x5,3 + x6,3 6 1) para obter (4.5).\n\n4.3 Fatores de lifting para K-coberturas\n\nMostramos que uma K-cobertura estrita induz uma face m\u00e1xima (faceta) de conv(XC ), que \u00e9 a\n\nproje\u00e7\u00e3o de conv(X ) no espaco de vari\u00e1veis com \u00edndices em ?(C). Esta desigualdade tamb\u00e9m \u00e9\nv\u00e1lida para conv(X ), entretanto podemos torn\u00e1-la mais forte, estendendo-a para todos os pares de ?:\n\n?\n(n,k)?H(C)\n\nxn,k + ?\n(n,k)??\\?(C)\n\n?n,k xn,k 6 K ?1 (4.9)\n\nonde ?n,k s\u00e3o os fatores de lifting, que dependem da cobertura e da ordem na qual s\u00e3o calculados.\n\nPara exemplificar, assuma o exemplo ilustrativo e a desigualdade da K-cobertura (4.5) indu-\n\nzida por C = { (1,2), (2,2), (3,2), (4,3), (5,3), (6,3) }. O par (n, k?) = (4, 4) requer ao menos\n\nmin{qn,k?1in , q\nn,k\nin } = min{q\n\n4,3\nin , q\n\n4,4\nin } = min{3, 4} = 3 unidades de g\u00e1s para ser ativado. Como esta\n\nquantia \u00e9 maior que o requerido por (n, k) = (4, 3) ? H(C), e no m\u00e1ximo um destes pares pode ser\n\nativado, a vari\u00e1vel x4,4 pode ser adicionado ao lado esquerdo da desigualdade (4.5). Neste racioc\u00ed-\n\nnio, podemos adicionar as vari\u00e1veis x4,5, x5,4 e x6,5 \u00e0 desigualdade (4.5). Continuando a an\u00e1lise, o\n\npar (n, k?) = (1, 6) requer que ao menos min{qn,k?1in , q\nn,k\nin } = min{q\n\n1,5\nin , q\n\n1,6\nin } = 5. Esta quantidade \u00e9\n\nsuficiente para ativar o po\u00e7o n no n\u00edvel k = 2, que requer 1 unidade, enquanto as 4 unidades restantes\n\npodem ativar os pares (2, 2), (3, 2) e (5, 3) que requerem 1, 1 e 2 unidades de g\u00e1s de inje\u00e7\u00e3o respecti-\n\nvamente. Portanto, a ativa\u00e7\u00e3o do par (1,6) requer tanto recurso quanto ativar (5, 3) ? H(C), e assim,\n\na vari\u00e1vel x1,6 \u00e9 adicionada ao lado esquerdo de (4.5).\n\nOs fatores de lifting s\u00e3o obtidos resolvendo uma seq\u00fc\u00eancia K = ?Kt : t = 1, . . . , T? de problemas\n\nPcpl (G) definidos de forma recursiva por:\n\nKt : ?t = Maximize ?\n(n,k)?H(C)\n\nxn,k +\nt?1\n\n?\nj=1\n\n?n j ,k j xn j ,k j\n\nSujeito a: x ?XUt|Wt\n\npara t = 1, . . . , T , onde:\n\n\u2022 XU|W = {x : (x, ?) ?X , xn,k = 0 para todo (n, k) ?U , enquanto xn,k = 1 para todo (n, k) ?W} \u00e9\no conjunto restrito de solu\u00e7\u00f5es de X ;\n\n\u2022 Ut = {(nt+1, kk+1), . . . , (nT , kT )} \u00e9 o conjunto de elementos a serem submetidos ao procedi-\n\nmento de lifting; e\n\n\u2022 Wt = {(nt , kt )} \u00e9 o conjunto com o elemento que est\u00e1 sendo executado o lifting.\n\n\n\n4. Modelo linear por partes 54\n\nOs coeficientes de lifting s\u00e3o definidos recursivamente por ?n j ,k j = K ?1??t , j = 1, . . . ,t ?1.\nPara que este procedimento seja bem definido \u00e9 necess\u00e1rio que XU|W n\u00e3o seja vazio para todo t =\n\n1, . . . , T . Para isto os fatores devem ser calculados segundo uma ordem topol\u00f3gica C? = {(n1, k1), . . . ,\n\n(nT , kT )} de ?\\?(C). Dizemos que C? est\u00e1 ordenado topologicamente se n j ? ni para todo i, j, com\n1 6 i &lt;j 6 T .\n\nSeja (C?<,C\n?\n=) uma parti\u00e7\u00e3o de C\n\n?, C?<?C\n?\n= = C\n\n? e C?<?C\n?\n= = /0, tal que (nt , kt ) ?C\n\n? pertence a C?<\nse e somente se existe xt ?XUt|Wt que resolva Kt e tal que:\n\n?\n(n,k)??\\Ut\n\nqn,k?1in x\nt\nn,k &lt;q\n\nmax\nin\n\nProposi\u00e7\u00e3o 4.4 Dado uma K-cobertura estrita e uma seq\u00fc\u00eancia de lifting topologicamente ordenada\n\nC?, a desigualdade de lifting (4.9) \u00e9 v\u00e1lida para conv(X ).\n\nProva: Por indu\u00e7\u00e3o em t. (Caso base) Para t = 0, (4.9) \u00e9 reduzida \u00e0 desigualdade da K-cobertura\n\n(4.3) que \u00e9 v\u00e1lida por defini\u00e7\u00e3o. (Passo de indu\u00e7\u00e3o) Considere t > 0 e qualquer solu\u00e7\u00e3o (x, ?) ?\nconv(X ). Se xnt ,kt = 0 ent\u00e3o (4.9) \u00e9 v\u00e1lida por indu\u00e7\u00e3o. Se xnt ,kt = 1 ent\u00e3o (4.9) \u00e9 v\u00e1lida apenas se:\n\n?\n(n,k)?H(C)\n\nxn,k +\nt?1\n\n?\nj=1\n\n?n j ,k j xn j ,k j + ?nt ,kt 6 K ?1\n\nque, por sua vez, \u00e9 v\u00e1lida apenas se:\n\n?nt ,kt 6 K ?1? ?\n(n,k)?H(C)\n\nxn,k ?\nt?1\n\n?\nj=1\n\n?n j ,k j xn j ,k j\n\n6 K ?1?max{ ?\n(n,k)?H(C)\n\nxtn,k +\nt?1\n\n?\nj=1\n\n?n j ,k j x\nt\nn j ,k j\n\n: xt ?XUt|Wt}\n\n= K ?1??t = ?nt ,kt\n\nPortanto (4.9) \u00e9 v\u00e1lida. ?\n\nCorol\u00e1rio 4.1 Se a K-cobertura C \u00e9 estrita, ent\u00e3o a desigualdade (4.9) induz uma faceFC ={(x, ?)?\nconv(X ) : (x, ?) respeita (4.9) na igualdade } de conv(X ) com dim(FC) = 2|?|?|C?=|?1.\n\nProva: Seja Z ? R(2|?|?|C\n?\n=|)\u00d72|?| uma matriz em que as colunas est\u00e3o relacionadas a xn,k e ?n,k,\n\n(n, k)??. Sejam as colunas mais \u00e0 esquerda as correspondentes \u00e0s vari\u00e1veis xn,k e ?n,k, (n, k)? ?(C),\ne as demais correspondentes a xn,k e ?n,k, (n, k) ? ?\\?(C), posicionadas da esquerda para a direita\nem uma ordem topol\u00f3gica dada por C?.\n\nSejam as 2|?(C)| linhas mais acima deZ correspondentes \u00e0s 2|?(C)| solu\u00e7\u00f5es afim independentes\npertencentes a FC de maneira que xn,k = 0 para todo (n, k) ? ?\\?(C) que existem de acordo com a\nProposi\u00e7\u00e3o 4.3. Fa\u00e7a as demais linhas do topo \u00e0 base serem obtidas como segue. Para t = 1, . . . , T , a\n\npr\u00f3xima linha deZ \u00e9 a solu\u00e7\u00e3o xt paraKt ; se (nt , kt )?C\n?\n<, ent\u00e3o adicione outra linha abaixo, id\u00eantica\n\n\n\n4. Modelo linear por partes 55\n\nFatores de lifting ?n,k\nn\\k 2 3 4 5 6\n1 0 0? 1 1\n2 0 0 1 1\n3 0 0 0? 1\n4 1 1\n5 1\n6 1 1\n7 0 0 0? 1 1\n8 0 1\n9 0 0?\n\n10 0 0? 1 1\n11 1\n12 1\n\nTabela 4.2: Fatores de lifting para o exemplo da mochila\n\n\u00e0 linha de xt , exceto que ?nt ,kt = 1?? com ? > 0 suficientemente pequeno para que a linha seja um\nelemento de FC. Note que xnt ,kt = ?nt ,kt para todo (x, ?) ?FC se (nt , kt ) ?C\n\n?\n=.\n\nClaramente, as linhas 2|?(C)|+ 1, . . . , 2|?(C)|+ T +|C?<|deZ formam uma matriz bloco-diagonal,\ncom as 2|?(C)| linhas mais acima liearmente independentes. Portanto, dim(FC) > 2|?(C)|+ T +\n|C?<|?1 = 2|?(C)|+|?\\?(C)|+|C\n\n?\n<|?1 = |?|+|?(C)|+|C\n\n?\n<|?1 = |?|+|?|?|C\n\n?\n=|?1 = 2|?|?\n\n|C?=|?1. Como xn,k = ?n,k para todo (x, ?)?FC se (n, k)?C\n?\n=, temos que dim(FC) 6 2|?|?|C\n\n?\n=|?1,\n\nque prova a proposi\u00e7\u00e3o. ?\n\nPor conveni\u00eancia, o problema de lifting Kt pode ser reescrito como um problema de programa\u00e7\u00e3o\n\ninteira tornando XUt|Wt expl\u00edcito:\n\nK ?t : ?t = Maximize ?\n(n,k)?H(C)\n\nxn,k +\nt?1\n\n?\nj=1\n\n?n j ,k j xn j ,k j (4.10a)\n\nSujeito a ?\nn?Nt\n\n?\n(n,k)?St,n\n\nq\nn,k?1\nin xn,k 6 q\n\nmax\nin (4.10b)\n\n?\n(m,i)?St,m\n\nxm,i > ?\n(n, j)?St,n\n\nxn, j ?(m, n) ? E(G[Nt ]) (4.10c)\n\n?\n(n,k)?St,n\n\nxn,k 6 1 ?n ? R(G[Nt ]) (4.10d)\n\nxnt ,kt = 1 (4.10e)\n\nxn,k ?{0, 1} ?(n, k) ??n?Nt St,n (4.10f)\n\nonde Nt = N(C)?{n1, . . . , nt} e St,n = (?(C)?{(n1, k1), . . . , (nt , kt )})??({n}).\n\nExemplo Ilustrativo: Para aplicamos o procedimento de lifting sobre a desigualdade (4.5), C?\n\n\u00e9 obtida arranjando os elementos de ?\\?(C) em ordem lexogr\u00e1fica: para todo (m, i), (n, j) ? C?,\n(m, i) ? (n, j) se m &lt;n, e caso m = n ent\u00e3o i &lt;j, induzindo uma ordem topol\u00f3gica. Os fatores de\n\nlifting obtidos s\u00e3o apresentados na Tabela 4.2. As posi\u00e7\u00f5es da tabela assinaladas com uma estrela\n\n\n\n4. Modelo linear por partes 56\n\npertencem a C?=, e os demais a C\n?\n<, portanto |C\n\n?\n=| = 5 e |C\n\n?\n<| = 27. A dimens\u00e3o da face FC definida\n\npela desigualdade (4.9), considerando os fatores da tabela, \u00e9 dim(FC) = 2\u00d741?5?1 = 76, que \u00e9\n\num pouco menor que 81, a dimens\u00e3o da face m\u00e1xima de conv(X ).\n\nPara se obter cada fator de lifting exato ?n,k , \u00e9 necess\u00e1rio resolver um problema da mochila Kt ,\nque \u00e9 NP-Dif\u00edcil. Ou seja, para o caso geral, resolver Kt \u00e9 t\u00e3o dif\u00edcil quanto resolver Pcpl (G). Entre-\n\ntanto, se o grafo de preced\u00eancia \u00e9 uma floresta, Kt pode ser resolvido em tempo pseudo-polinomial\n\nutilizando programa\u00e7\u00e3o din\u00e2mica [9]. No Ap\u00eandice A apresentamos este algoritmo de programa\u00e7\u00e3o\n\ndin\u00e2mica.\n\n4.4 Fatores de pseudo-lifting para K-coberturas\n\nA dificuldade de se encontrar fatores exatos de lifting pode ser contornada buscando fatores de lift-\n\ning aproximados ?n,k , que chamaremos de fatores de pseudo-lifting. Primeiro introduziremos alguns\nconceitos utilizando o exemplo dado na Figura 4.2 e Tabela 4.1. Seja ?(C) = ???(C) o conjunto de\n\u00edndices das vari\u00e1veis em que os fatores de pseudo-lifting ser\u00e3o obtidos. Este conjunto \u00e9 dividido em\n\ntr\u00eas subconjuntos, dependendo se os po\u00e7os pertencem a N(H(C)), N(C\\H(C)) ou N \\N(C)):\n\n\u2022 ?H (C) = {(n, j) : (n, k) ? H(C), j = k + 1, . . . , ?(n)} s\u00e3o os \u00edndices das vari\u00e1veis relativos a\nH(C); no exemplo, C = { (1,2), (2,2), (3,2), (4,3), (5,3), (6,3) } implica ?H (C) = { (4,4), (4,5),\n(5,4), (6,4), (6,5) }.\n\n\u2022 ?A(C) = {(n, j) : (n, k) ?C\\H(C), j = k + 1, . . . , ?(n)} \u00e9 o conjunto dos \u00edndices dos fatores de\npseudo-lifting correspondentes aos predecessores C\\H(C); no exemplo ilustrativo, ?A(C) = {\n(1,3), (1,4), (1,5), (1,6), (2,3), (2,4), (2,5), (2,6), (3,3), (3,4), (3,5), (3,6) }.\n\n\u2022 ?B(C) = ?(C)\\(?H (C)? ?A(C)) \u00e9 o conjunto dos \u00edndices restantes; no exemplo, ?B(C) =\n?({7, 8, 9, 10, 11, 12}).\n\nNo in\u00edcio da Se\u00e7\u00e3o 4.3, o exemplo sobre x4,4 ilustra precisamente a obten\u00e7\u00e3o do fator de pseudo-\n\nlifting ?n,k para (n, k) ? ?H (C): a quantidade m\u00ednima de g\u00e1s para ativar o po\u00e7o n no n\u00edvel k \u00e9 q\nn,k?1\nin ;\n\ncomo qn,k?1in = q\n4,3\nin = 3 > 2 = q\n\n4,2\nin = q\n\nn,k??1\nin com (n, k\n\n?) = (4, 3) ? H(C), ?4,4 = 1 e a vari\u00e1vel x4,4\npode ser adicionada \u00e0 desigualdade da K-cobertura.\n\nSimilarmente, a discuss\u00e3o sobre x1,6 mostra o c\u00f4mputo de ?n,k para (n, k) ? ?A(C): note que\na quantidade m\u00ednima de g\u00e1s para ativar o po\u00e7o 1 no n\u00edvel 6 \u00e9 qn,k?1in = q\n\n1,5\nin = 5, que \u00e9 suficiente\n\npara ativar este po\u00e7o no n\u00edvel 2 e o par de maior demanda de recursos (m, j) ? H(C) com seus\n\npredecessores, que s\u00e3o os pares (5, 3), (2, 2) e (3, 2) que requerem 4 unidades; portanto ?1,6 = 1\npermitindo que x1,6 seja adicionada a desigualdade da K-cobertura.\n\nResta ilustrar o procedimento de pseudo-lifting para os elementos de (n, k) ? ?B(C). Para este\nconjunto, o c\u00f4mputo \u00e9 mais complicado pois as restri\u00e7\u00f5es de preced\u00eancia devem ser levadas em conta\n\ndevido a uma liberdade de escolha adicional. Considere um caso simples onde (n, k) = (7, 6)??B(C).\n\n\n\n4. Modelo linear por partes 57\n\nComo o n\u00f3 7 \u00e9 uma folha de G, a desativa\u00e7\u00e3o do po\u00e7o 7 n\u00e3o viola restri\u00e7\u00f5es de preced\u00eancia. Note\n\nque qn,k?1in = q\n7,5\nin = 5, que \u00e9 suficiente para ativar o maior elemento de H(C) e seus predecessores:\n\n(5, 3) ? H(C) e (1, 2), (2, 2) e (3, 2), consumindo juntos 2 + 1 + 1 + 1 = 5 unidades de g\u00e1s de inje\u00e7\u00e3o.\n\nConsequentemente, o fator de pseudo-lifting ?7,5 = 1 e x7,5 pode ser adicionada a desigualdade da\nK-cobertura.\n\nAlgumas defini\u00e7\u00f5es ser\u00e3o introduzidas a seguir com o objetivo de formalizar as no\u00e7\u00f5es dadas.\n\n\u2022 para qualquer n ?N e (m, j) ? ?\\?({n}),\n\n?(n)m, j =\n\n?\n\n?\n\n?\n\nq\nm, j?1\nin + ?\n\nl?Am\\(An?{n})\nq\n\nl,1\nin se m ? n\n\nq\nm, j?1\nin ?q\n\nm,1\nin se m ? n\n\n\u00e9 a quantidade m\u00ednima de recursos necess\u00e1rios para ativar o po\u00e7o m em um n\u00edvel j, sendo que\n\no po\u00e7o n foi ativado;\n\n\u2022 H(C, n, k) = H(C)\\{(n, k)}, com (n, k) ? H(C);\n\n\u2022 H(C, n, k)h ? H(C, n, k) \u00e9 o conjunto onde:\n\n(i) |H(C, n, k)h| = h; e\n\n(ii) min{?(n)m, j : (m, j) ? H(C, n, k)h} > max{?(n)m, j : (m, j) ? H(C, n, k)\\H(C, n, k)h},\n\nisto \u00e9, H(C, n, k)h \u00e9 o subconjunto de H(C, n, k) com h pares que requerem a maior quantidade\n\nde recursos para ser ativado, dado que o po\u00e7o n ? N(H(C)), est\u00e1 ativo; e\n\n\u2022 H(C, n)h ? H(C) \u00e9 tal que:\n\n(i) |H(C, n)h| = h e\n\n(ii) min{?(n)m, j : (m, j) ? H(C, n)h} > max{?(n)m, j : (m, j) ? H(C)\\H(C, n)h},\n\nisto \u00e9, H(C, n)h \u00e9 o subconjunto de H(C) com os h pares que requerem a maior quantidade de\n\nrecursos para ser ativado, dado que o par (n, j) est\u00e1 ativo.\n\nPara os subconjuntos definidos acima, ?H (C), ?A(C) e ?B(C), apresentamos a seguir fatores de\npseudo-lift. Para um po\u00e7o n de uma cobertura C, seja ?(n) o n\u00edvel de ativa\u00e7\u00e3o correspondente: se\nn ? N(C) ent\u00e3o ?(n) = k onde (n, k) ?C.\n\nDefini\u00e7\u00e3o 4.5 Para (n, k) ? ?H (C), o fator de pseudo-lift \u00e9:\n\n?n,k = 1 + max{h : ?\n(m, j)?H(C,n,?(n))h\n\n?(n)m, j 6 q\nn,k?1\nin ?q\n\nn,?(n)?1\nin }\n\nonde (n, ?(n)) ? H(C).\n\n\n\n4. Modelo linear por partes 58\n\nDefini\u00e7\u00e3o 4.6 Para (n, k) ? ?A(C), o fator de pseudo-lift \u00e9:\n\n?n,k = max{h : ?\n(m, j)?H(C,n)h\n\n?(n)m, j 6 q\nn,k?1\nin ?q\n\nn,1\nin }\n\nCom respeito aos elementos de ?B(C), existe um procedimento para o c\u00f4mputo de seus fatores\naproximados. Seja ?0, ?1, . . . , ?R uma parti\u00e7\u00e3o de ?B(C) tal que para cada r = 1, 2, . . . , R temos:\n\n(i) H(?r) = {(nr , 2), . . . , (nr , ?(nr))} para algum nr ?N \\N(C);\n\n(ii) m ? nr e j = 2 para todo (m, j) ? ?r\\H(?r).\n\nDefini\u00e7\u00e3o 4.7 Dado uma parti\u00e7\u00e3o {?r}R0 de ?B(C), os fatores de pseudo-lifting ?n,k para (n, k) ? ?r\ns\u00e3o definidos como:\n\n\u2022 ?n,k = max{h : ?(m, j)?H(C,n)h ?(n)m, j 6 q\nn,k?1\nin ?q\n\nn,1\nin } se r = 0;\n\n\u2022 ?n,k = max{h : ?(m, j)?H(C,n)h ?(n)m, j 6 q\nn,k?1\nin + ?(m, j)??r\\H(?r ) q\n\nm, j?1\nin } se r > 1 e (n, k)?H(?r );\n\ne\n\n\u2022 ?n,k = 0 se r > 1 e (n, k) ? ?r\\H(?r).\n\nProposi\u00e7\u00e3o 4.5 Dado uma K-cobertura C e os fatores de pseudo-lifting ?n,k, a desigualdade de\npseudo-lifting:\n\n?\n(n,k)?H(C)\n\nxn,k + ?\n(n,k)??(C)\n\n?n,kxn,k 6 K ?1 (4.11)\n\n\u00e9 v\u00e1lida para conv(X ).\n\nProva: (Por contradi\u00e7\u00e3o) Suponha que existe um (x, ?) ? conv(X ) que viola (4.11), e seja:\n\na) H(x) = {(n, k) ? H(C) : xn,k = 1};\n\nb) H(x) = {(n, k) ? ?H (C) : xn,k = 1} e H(x)t = {(n, k) ? H(x) : ?n,k = t};\n\nc) A(x) = {(n, k) ? ?A(C) : xn,k = 1} e A(x)t = {(n, k) ? A(x) : ?n,k = t}; e\n\nd) B(x) = {(n, k) ? ?B(C) : xn,k = 1} e B(x)t = {(n, k) ? B(x) : ?n,k = t}.\n\nNote que como (x, ?) viola (4.11),\n\n|H(x)|+\nK?1\n\n?\nt=1\n\nt\n(\n\n|H(x)t|+ |A(x)t|+ |B(x)t|\n)\n\n> K ?1\n\n\n\n4. Modelo linear por partes 59\n\nSeja H0(x) = H(C)\\(H(x)?{(n, ?(n)) : (n, k) ? H(x)}). E considere (x?, ??) id\u00eantica a (x, ?), com\nexce\u00e7\u00e3o apenas do redefinido nas Partes I, II, III e IV a seguir.\n\n(Parte I) Seja ? ? H0(x) um subconjunto m\u00e1ximo com |?| 6 ?K?1t=1 (t ?1)|H(x)t|. Modifique\n(x?, ??) fazendo:\n\na) x?n,k = ??n,k = 0 e x?n,?(n) = ??n,?(n) = 1 para todo (n, k) ? H(x);\n\nb) x?n, j = ??n, j = 0 para todo (n, k) ? ?, j = 1, . . . , k?1;\n\nc) x?n,k = ??n,k = 1 para todo (n, k) ? ?; e\n\nd) x?n,k = ??n,k = 1 para todo (n, k) ?{(m, j) ?C\\H(C) : x?m,t = 0 para todo t}??(l(?)).\n\nComo qn,k?1in ?q\nn,?(n)?1\nin > ?(m, j)?H(C,n,?(n))t?1 ?(n)m, j para todo (n, k) ? H(x)t e todo t, temos que\n\n(x?, ??)?conv(X ). Note que |H(x?)|= |H(x)|+ ?K?1t=1 t|H(x)| porque, caso contr\u00e1rio, (x?, ??) 6?conv(X )?\n(x, ?) 6? conv(X ).\n\n(Parte II) Seja ? ? H0(x?) um subconjunto m\u00e1ximo onde |?| 6 ?K?1t=1 t|A(x)t|. Modifique (x?, ??)\nda seguinte maneira:\n\na) x?n,k = ??n,k = 0 e x?n,2 = ??n,2 = 1 para todo (n, k) ??K?1t=1 A(x)t ;\n\nb) x?n, j = ??n, j = 0 para todo (n, k) ? ?, j = 1, . . . , k?1;\n\nc) x?n,k = ??n,k = 1 para todo (n, k) ? ?; e\n\nd) x?n,k = ??n,k = 1 para todo (n, k) ?{(m, j) ?C\\H(C) : x?m,t = 0 para todo t}??(l(?)).\n\nComo na Parte I, (x?, ??) ? conv(X ) pois qn,k?1in ?q\nn,1\nin > ?(m, j)?H(C,n)t ?(n)m, j para todo (n, k) ? A(x)t\n\ne todo t. Ainda, ? deve ser m\u00e1ximo porque, caso contr\u00e1rio, (x?, ??) 6? conv(X ) ? (x, ?) 6? conv(X ).\nConsequentemente, |H(x?)| = |H(x)|+ ?K?1t=1 t\n\n(\n\n|H(x)t|+ |A(x)t|\n)\n\n(Parte III) Seja ? ? H0(x?) um subconjunto m\u00e1ximo com cardinalidade |?| 6 ?K?1t=1 t|B(x)t ??0|.\nModifique (x?, ??) fazendo:\n\na) x?n,k = ??n,k = 0 e x?n,2 = ??n,2 = 1 para todo (n, k) ??K?1t=1 (B(x)t ??0);\n\nb) x?n, j = ??n, j = 0 para todo (n, k) ? ?, j = 1, . . . , k?1;\n\nc) x?n,k = ??n,k = 1 para todo (n, k) ? ?; e\n\nd) x?n,k = ??n,k = 1 para todo (n, k) ?{(m, j) ?C\\H(C) : x?m,t = 0 para todo t}??(l(?)).\n\nComo qn,k?1in ?q\nn,1\nin > ?(m, j)?H(C,n)t ?(n)m, j para todo (n, k) ? B(x)t ??0 e todo t, temos que (x?, ??) ?\n\nconv(X ). Note que |H(x?)|= |H(x)|+ ?K?1t=1 t\n(\n\n|H(x)t|+ |A(x)t|+ |B(x)t ??0|\n)\n\nporque, caso contr\u00e1rio,\n\n(x?, ??) 6? conv(X ) ? (x, ?L) 6? conv(X ).\n\n(Parte IV) Seja ? ? H0(x?) um subconjunto m\u00e1ximo de cardinalidade |?| 6 ?K?1t=1 t|B(x)t ??|\nonde ? = ?Rr=1?r. Modifique (x?, ??) fazendo:\n\n\n\n4. Modelo linear por partes 60\n\nValores ?(n)m, j\nn\\(m, j) (4, 3) (5, 3) (6, 3)\n\n1 3 4 3\n2 2 3 3\n3 3.5 3.5 2\n4 3 3\n5 2 2\n6 3.5 3.5\n7 3.5 4.5 3\n8 2 1 2\n9 3.5 3.5 1\n\n10 3.5 4.5 3\n11 2 1 2\n12 2 1 2\n\nTabela 4.3: Recursos m\u00ednimos de ativa\u00e7\u00e3o\n\nH(C, n)h e H(C, n, k)h\nn : (m, j) h = 1 h = 2 h = 3\n\n1 {(5,3)} {(5,3),(4,3)} {(5,3),(4,3),(6,3)}\n2 {(6,3)} {(6,3),(5,3)} {(6,3),(5,3),(4,3)}\n3 {(4,3)} {(4,3),(5,3)} {(4,3),(5,3),(6,3)}\n\n(4, 3) {(5,3)} {(5,3),(6,3)}\n(5, 3) {(4,3)} {(4,3),(6,3)}\n(6, 3) {(4,3)} {(4,3),(5,3)}\n\n7 {(5,3)} {(5,3),(4,3)} {(5,3),(4,3),(6,3)}\n8 {(4,3)} {(4,3),(6,3)} {(4,3),(6,3),(5,3)}\n9 {(4,3)} {(4,3),(5,3)} {(4,3),(5,3),(6,3)}\n\n10 {(5,3)} {(5,3),(4,3)} {(5,3),(4,3),(6,3)}\n11 {(4,3)} {(4,3),(6,3)} {(4,3),(6,3),(5,3)}\n12 {(6,3)} {(6,3),(4,3)} {(6,3),(4,3),(5,3)}\n\nTabela 4.4: Subconjuntos para ativa\u00e7\u00e3o de H(C)\n\na) x?n,k = ??n,k = 0 para todo (n, k) ? ???(N(C));\n\nb) x?n, j = ??n, j = 0 para todo (n, k) ? ?, j = 1, . . . , k?1;\n\nc) x?n,k = ??n,k = 1 para todo (n, k) ? ?; e\n\nd) x?n,k = ??n,k = 1 para todo (n, k) ?{(m, j) ?C\\H(C) : x?m,t = 0 para todo t}??(l(?)).\n\nConsiderando que qn,k?1in + ?(m, j)??r\\H(?r) q\nm, j?1\nin > ?(m, j)?H(C,n)t ?(n)m, j para todo (n, k)??r?B(x)t ,\n\nr, e t, temos (x?, ??) ? conv(X ). Note que ?(n,k)?H(C) x?n,k = H(x?) > |H(x)|+ ?\nK?1\nt=1 t(|H(x)t|+|A(x)t|+\n\n|B(x)t|) > K pois (x, ?) viola (4.11). Isto implica que (x?, ??) 6? conv(X ) ? (x, ?) 6? conv(X ), contradi-\nzendo a hip\u00f3tese inicial. ?\n\nExemplo ilustrativo: Continuando o exemplo anterior, iniciamos calculando as quantidades m\u00edni-\n\nmas de recursos de ativa\u00e7\u00e3o ?(n)m, j que est\u00e3o na Tabela 4.3. Os conjuntos H(C, n, k)h e H(C, n) est\u00e3o\n\n\n\n4. Modelo linear por partes 61\n\nCoeficientes ?n,k para {?\n?\nr} Coeficientes ?n,k para {?\n\n??\nr}\n\nn\\k 2 3 4 5 6 2 3 4 5 6\n1 0 0 0? 1 0 0 0? 1\n2 0 0 1 1 0 0 1 1\n3 0 0 0 1 0 0 0 1\n4 1 1 1 1\n5 1 1\n6 1 1 1 1\n7 0 0 0 0? 1 0 0 0 0? 0?\n\n8 0 1 0 0?\n\n9 0 0 0 0\n10 0 0 0? 0? 0 0 0? 1\n11 0? 1\n12 0? 0?\n\nTabela 4.5: Coeficientes de pseudo-lifting\n\nna Tabela 4.4. Os par\u00e2metros destas tabelas ser\u00e3o necess\u00e1rios para o c\u00e1lculo dos fatores de pseudo-\n\nlifting. Para a K-cobertura C = {(1, 2), (2, 2), (3, 2), (4, 3), (5, 3), (6, 3)}, os conjuntos de \u00edndices das\n\nvari\u00e1veis cujos fatores de lifting ?n,k ser\u00e3o calculados s\u00e3o:\n\n\u2022 ?H (C) = {(4, 4), (4, 5), (5, 4), (6, 4), (6, 5)};\n\n\u2022 ?A(C) = {(1, 3), (1, 4), (1, 5), (1, 6), (2, 3), (2, 4), (2, 5), (2, 6), (3, 3), (3, 4), (3, 5), (3, 6)}; e\n\n\u2022 ?B(C) = ?12n=7?n.\n\nConsidere a parti\u00e7\u00e3o {?\n?\nr} de ?B(C) dada por ?\n\n?\n0 = /0, ?\n\n?\n1 = ?({7}) com n1 = 7, ?\n\n?\n2 = ?({8})\n\ncom n2 = 8, ?\n?\n3 = ?({9}) com n3 = 9, ?\n\n?\n4 = ?({10}) com n4 = 10, ?\n\n?\n5 = ?({11}) com n5 = 11, e\n\n?\n?\n6 = ?({12}) com n6 = 12.\n\nConsidere tamb\u00e9m a parti\u00e7\u00e3o {?\n??\nr} dada por ?\n\n??\n0 = {(7,3), (7,4), (7,5), (7,6), (8,3)}, ?\n\n??\n1 = {(9,2),\n\n(9,3), (9,4)} com n1 = 9, ?\n??\n2 = {(7,2), (10,2), (10,3), (10,4), (10,5)} com n2 = 10, ?\n\n??\n3 = {(8,2),\n\n(11,2)} com n3 = 11, e ?\n??\n4 = {(12,2)} com n4 = 12.\n\nOs fatores de pseudo-lifting para os conjuntos ?A(C) e ?H (C) est\u00e3o na Tabela 4.5 junto com os\nfatores para ?B(C), que variam de acordo com as parti\u00e7\u00f5es {?\n\n?\nr} e {?\n\n??\nr}. As posi\u00e7\u00f5es da tabela mar-\n\ncadas com uma estrela correspondem \u00e0s inst\u00e2ncias cujos fatores de pseudo-lifting ?n,k s\u00e3o diferentes\ndos fatores exatos ?n,k .\n\nPodemos observar que os fatores de pseudo-lifting s\u00e3o bastante pr\u00f3ximos dos fatores exatos, di-\n\nvergindo apenas em alguns pontos. Note tamb\u00e9m que a escolha das parti\u00e7\u00f5es {?r} influencia nos\nresultados obtidos.\n\n\n\n4. Modelo linear por partes 62\n\n4.5 Resultados computacionais\n\nForam realizados testes computacionais para avaliar o impacto da aplica\u00e7\u00e3o de cortes sobre o\n\npoliedro Pcpl (G) no desempenho do algoritmo de Branch and Bound. As curvas de performance\n\ndos po\u00e7os utilizadas s\u00e3o baseadas nas de Buitrago et al. [4], em que o campo em estudo possui 56\n\npo\u00e7os, com v\u00e1rias configura\u00e7\u00f5es de CPPs (uma CPP para cada po\u00e7o), algumas com resposta imediata\n\n(representando po\u00e7os surgentes) enquanto outras com a necessidade de uma inje\u00e7\u00e3o m\u00ednima de g\u00e1s\n\npara iniciar a produ\u00e7\u00e3o. A forma linear por partes destas curvas consiste em 20 regi\u00f5es lineares para\n\ncada po\u00e7o n. Realizamos testes com inst\u00e2ncias de 32, 64 e 85 po\u00e7os. Nas inst\u00e2ncias de 32 po\u00e7os,\n\nutilizamos as primeiras curvas de [4]. As inst\u00e2ncias de 64 e 85 po\u00e7os possuem as 56 curvas de\n\nBuitrago et al., e as restantes foram obtidas aplicando-se perturba\u00e7\u00f5es \u00e0s primeiras.\n\nOs grafos de restri\u00e7\u00e3o de preced\u00eancia G = (V, E) foram gerados aleatoriamente, com densidades\n\nque variam desde o caso irrestrito (E = /0) at\u00e9 grafos densos (|E|??|V|2/2?), formando 13 densidades\nde grafo para cada grupo de po\u00e7os. A quantidade total de g\u00e1s dispon\u00edvel qmaxin tamb\u00e9m variou de pouco\n\ng\u00e1s de inje\u00e7\u00e3o at\u00e9 grande capacidade de compress\u00e3o, formando 5 n\u00edveis de inje\u00e7\u00e3o para as inst\u00e2ncias\n\ncom 32 po\u00e7os, 4 n\u00edveis para as de 64 po\u00e7os e 5 n\u00edveis para as de 85 po\u00e7os.\n\nForam realizados testes comparando o desempenho do algoritmo sobre as inst\u00e2ncias puras, com\n\nas inst\u00e2ncias ap\u00f3s a aplica\u00e7\u00e3o de cortes, que s\u00e3o apresentados em duas tabelas. As inst\u00e2ncias foram\n\nresolvidas em uma esta\u00e7\u00e3o rodando o sistema operacional GNU/Linux, com 1GB de RAM e 2GB de\n\nespa\u00e7o de disco para mem\u00f3ria virtual, e equipado com um processador Intel Pentium IV de 3GHz.\n\nNa Tabela 4.6 podemos avaliar o impacto da gera\u00e7\u00e3o de cortes em cada uma das taxas de inje\u00e7\u00e3o\n\nde g\u00e1s, com a m\u00e9dia dos resultados obtidos variando o tamanho do grafo de preced\u00eancia. A Tabela\n\n4.7 apresenta o impacto da gera\u00e7\u00e3o de cortes de acordo com a densidade do grafo de restri\u00e7\u00f5es de\n\npreced\u00eancia, com a m\u00e9dia obtida nas inst\u00e2ncias que diferem pela capacidade de compress\u00e3o de g\u00e1s\n\nde inje\u00e7\u00e3o.\n\nOs resultados apresentados nas colunas \u201cSem cortes\u201d foram obtidos resolvendo as inst\u00e2ncias de\n\nPcpl (G) correspondentes utilizando o programa ILOG CPLEX [31], que \u00e9 tido como uma das fer-\n\nramentas mais poderosas para resolu\u00e7\u00e3o de problemas de programa\u00e7\u00e3o inteira-mista das existentes\n\nno mercado. As tabelas apresentam o n\u00famero de itera\u00e7\u00f5es realizadas, o n\u00famero de n\u00f3s gerados, e o\n\ntempo em segundos para resolu\u00e7\u00e3o do algoritmo de Branch and Bound.\n\nTamb\u00e9m foram aplicados cortes atrav\u00e9s de coberturas \u00e0s inst\u00e2ncias, e em seguida foram subme-\n\ntidas ao mesmo programa de resolu\u00e7\u00e3o de problemas de programa\u00e7\u00e3o inteira-mista. Os resultados\n\nobtidos destas inst\u00e2ncias s\u00e3o apresentados nas colunas \u201cCom cortes\u201d das Tabelas 4.6 e 4.7. A fase\n\nde gera\u00e7\u00e3o de cortes resolve iterativamente a relaxa\u00e7\u00e3o linear de cada inst\u00e2ncia, busca uma cobertura\n\ncuja desigualdade obtida a partir do processo de pseudo-lifting corte a solu\u00e7\u00e3o fracion\u00e1ria, e a adici-\n\nona ao conjunto de restri\u00e7\u00f5es. Este processo finaliza ap\u00f3s produzir certo n\u00famero de planos de corte,\n\nou atingir um n\u00famero de tentativas mal sucedidas. Como o problema de separa\u00e7\u00e3o \u00e9 dif\u00edcil, isto \u00e9, n\u00e3o\n\n\u00e9 f\u00e1cil encontrar uma cobertura cuja desigualdade corte a solu\u00e7\u00e3o fracion\u00e1ria, foi desenvolvida uma\n\nheur\u00edstica simples, por\u00e9m r\u00e1pida, que sistematicamente busca por coberturas m\u00ednimas, aplica o pro-\n\ncesso de pseudo-lifting, e verifica se a desigualdade resultante \u00e9 um plano de corte. O procedimento\n\n\n\n4. Modelo linear por partes 63\n\nSem cortes Com cortes Redu\u00e7\u00e3o (%)\nqmaxi Itera\u00e7\u00f5es N\u00f3s CPU Itera\u00e7\u00f5es N\u00f3s CPU Itera\u00e7\u00f5es N\u00f3s CPU Relax.\n\nN = 32\n300 25063 12271 5.7 310 13 0.28 98.76 99.89 95.09 16.06\n500 2590 1409 3.40 375 13 1.00 85.52 99.08 70.59 4.77\n700 46389 24476 19.21 19190 9309 10.65 58.63 61.97 44.56 4.99\n\n1100 67905 32907 28.55 45236 22207 22.94 33.38 32.52 19.65 2.38\n1500 28672 10845 13.16 25001 10906 11.30 12.80 -0.56 14.13 1.30\nTotal 170619 81908 70.02 90112 42448 46.17 47.19 48.18 34.06 5.90\n\nN = 64\n700 1159402 553323 694.26 37293 8611 18.88 96.78 98.44 97.28 4.20\n\n2300 7653030 3552912 6131.32 5981043 2708404 5079.69 21.85 23.77 17.15 1.23\n2700 3464600 1552803 2698.16 3022232 1330704 2545.21 12.77 14.30 5.67 1.09\n3500 377212 163308 304.78 259068 105303 220.64 31.32 35.52 27.61 0.86\nTotal 12654244 5822346 9828.52 9299636 4153022 7864.42 26.51 28.67 19.98 1.85\n\nN = 85\n730 13879 8207 28.80 2134 712 8.44 84.62 91.32 70.69 1.51\n996 1565583 828402 1618.51 260601 81406 205.68 83.35 90.17 87.29 1.56\n\n1261 17398974 8915702 19555.33 8074359 3183605 10381.58 53.59 64.29 46.91 3.35\n2058 15704801 7406702 15340.51 5221739 1803605 4455.65 66.75 75.65 70.96 1.16\n2324 3570 1019 24.25 3501 1017 16.15 1.93 0.20 33.40 0.46\n4648 4591 1208 23.64 2828 438 11.28 38.40 63.74 52.28 0.46\nTotal 34691398 17161240 36591.04 13565162 5070783 15078.78 60.90 70.45 58.79 1.42\n\nTotal 47516261 23065494 46489.58 22954910 9266253 22989.37 51.69 59.83 50.55 3.03\n\nTabela 4.6: Impacto dos planos de corte por taxa de inje\u00e7\u00e3o de g\u00e1s\n\nde gera\u00e7\u00e3o de cortes foi implementado em linguagem C++ [32], utilizando as bibliotecas ILOG [31]\n\npara resolver as relaxa\u00e7\u00f5es lineares e as estruturas de dados avan\u00e7adas suportadas pelo pacote LEDA\n\n[33].\n\nA coluna \u201cRedu\u00e7\u00e3o\u201d apresenta o impacto da aplica\u00e7\u00e3o dos cortes em rela\u00e7\u00e3o \u00e0s inst\u00e2ncias puras\n\nno n\u00famero de itera\u00e7\u00f5es e de n\u00f3s do algoritmo de Branch and Bound. A coluna \u201cRelax.\u201d apresenta a\n\nredu\u00e7\u00e3o relativa no valor da relaxa\u00e7\u00e3o linear devido \u00e0 aplica\u00e7\u00e3o dos planos de corte.\n\nApresentamos a seguir uma vis\u00e3o geral da heur\u00edstica de busca dos cortes. Inicialmente s\u00e3o compu-\n\ntados os conjuntos An e os par\u00e2metros ?(n, m, j) que n\u00e3o dependem da cobertura. Seja ?? = max{?(n) :\nn ?N }. Este pr\u00e9-processamento \u00e9 executado em tempo O(N 3??), ou O(N 4) dado que ?? ? O(N). Para\na busca de cada cobertura, os seguintes passos s\u00e3o executados:\n\n1. Inicie com uma cobertura vazia, C = /0 e H(C) = /0.\n\n2. Escolha aleatoriamente pares de (n, k) ? ?, para o qual xn,k 6= 0 no par (x, ?) e n 6? N(C),\natualizando C, H(C), e ?(C), at\u00e9 que uma cobertura seja obtida ou sejam realizadas no m\u00e1ximo\n?1 escolhas aleat\u00f3rias. Este passo \u00e9 executado em tempo O(?1N(log N + ??)) = O(N 4) para\n?1 = N?? e ?? ? O(N).\n\n3. Se o passo 2 falhar na busca de uma cobertura, ent\u00e3o busque nos pares (n, k) ? ? em ordem ar-\nbitr\u00e1ria, n\u00e3o levando em conta o valor de xn,k, e execute as mesmas a\u00e7\u00f5es para gerar a cobertura\n\nC. Este passo possui a mesma complexidade.\n\n4. Se C n\u00e3o \u00e9 uma cobertura, ent\u00e3o aborte a heur\u00edstica e notifique a falha. Caso contr\u00e1rio, remova\n\nos elementos de H(C) e C at\u00e9 que seja obtida uma cobertura m\u00ednima. Este passo \u00e9 executado\n\nem tempo O(N 3).\n\n\n\n4. Modelo linear por partes 64\n\nSem cortes Com cortes Redu\u00e7\u00e3o (%)\n|E(G)| Itera\u00e7\u00f5es N\u00f3s CPU Itera\u00e7\u00f5es N\u00f3s CPU Itera\u00e7\u00f5es N\u00f3s CPU Relax.\n\nN = 32\n0 30495 20300 13.34 82 5 0.11 99.73 99.98 99.18 3.57\n\n?N/8? 34755 18300 12.34 21280 10903 9.92 38.77 40.42 19.61 3.50\n?N/4? 36700 19000 14.02 33911 18302 17.28 7.60 3.67 -23.25 3.21\n?N/3? 23309 10200 7.33 4869 1904 1.96 79.11 81.33 73.26 3.31\n?N/2? 10344 3601 3.72 8067 3802 3.65 22.01 -5.58 1.88 2.70\n?2N/3? 17536 6101 5.36 10713 4202 5.06 38.91 31.13 5.60 3.13\n\nN 13510 3926 6.15 8572 3102 4.53 36.55 20.99 26.34 2.37\n2N 1484 302 1.54 1148 203 1.3 22.64 32.78 15.58 3.14\n3N 799 70 0.95 316 5 0.78 60.45 92.86 17.89 3.26\n4N 576 69 0.99 320 5 0.48 44.44 92.75 51.52 3.99\n5N 396 27 1.08 320 5 0.48 19.19 81.48 55.56 6.74\n?N2/3? 365 5 1.45 257 5 0.31 29.59 0 78.62 5.65\n?N2/2? 350 7 1.75 257 5 0.31 26.57 28.57 82.29 10.18\nTotal 170619 81908 70.02 90112 42448 46.17 47.19 48.18 34.06 5.90\n\nN = 64\n0 2492947 1318200 1978.32 114 4 0.21 100.00 100.00 99.99 1.86\n\n?N/8? 5067958 2577200 4297.35 4797594 2443601 4271.98 5.33 5.18 0.59 1.26\n?N/4? 1673498 708800 1258.03 1528423 645101 1352.08 8.67 8.99 -7.48 1.27\n?N/3? 1931502 793100 1394.37 1752252 707301 1354.86 9.28 10.82 2.83 1.34\n?N/2? 569639 176100 338.66 485924 153501 344.51 14.70 12.83 -1.73 1.27\n?2N/3? 427275 128900 233.11 271137 89001 226.08 36.54 30.95 3.02 1.29\n\nN 418611 109800 254.93 414835 106400 265.90 0.90 3.10 -4.30 0.10\n2N 31470 5200 18.76 16532 3301 13.33 47.47 36.52 28.94 0.37\n3N 12886 1900 10.47 12590 1800 12.04 2.30 5.26 -15.00 1.30\n4N 25509 3001 19.50 17282 2901 17.42 32.25 3.33 10.67 0.84\n5N 1003 103 5.99 1713 103 4.05 -70.79 0.00 32.39 3.26\n?N2/3? 1196 38 5.72 535 4 0.77 55.27 89.47 86.54 3.06\n?N2/2? 750 4 13.31 705 4 1.19 6.00 0.00 91.06 6.74\nTotal 12654244 5822346 9828.52 9299636 4153022 7864.42 26.51 28.67 19.98 1.85\n\nN = 85\n0 7014551 4607700 9366.13 87 4 0.28 100.00 100.00 100.00 1.95\n\n?N/8? 7159944 4125100 8660.61 87 4 0.28 100.00 100.00 100.00 1.15\n?N/4? 6041502 3048500 6297.51 82 4 0.29 100.00 100.00 100.00 1.11\n?N/3? 8740144 3816200 8235.11 7932336 3504502 10688.01 9.24 8.17 -29.79 0.51\n?N/2? 2776802 823500 1920.01 2746963 828601 2062.87 1.07 -0.62 -7.44 0.16\n?2N/3? 1420430 369300 976.18 1426351 363800 1084.78 -0.42 1.49 -11.12 0.08\n\nN 1336313 343601 916.20 1300825 349701 1094.43 2.66 -1.78 -19.45 3.16\n2N 134951 19401 80.24 115668 17901 69.26 14.29 7.73 13.68 0.16\n3N 16013 1601 15.30 13983 1601 16.27 12.68 0.00 -6.34 0.31\n4N 24479 2401 18.88 10407 1501 13.74 57.49 37.48 27.22 0.23\n5N 16533 1701 17.07 10621 1701 16.73 35.76 0.00 1.99 0.91\n?N2/3? 659 4 14.75 736 4 1.62 -11.68 0.00 89.02 4.64\n?N2/2? 916 4 25.16 687 4 2.79 25.00 0.00 88.91 4.04\nTotal 34683237 17159013 36543.15 13558833 5069328 15051.35 60.91 70.46 58.81 1.42\n\nTotal 34691398 17161240 36591.04 13565162 5070783 15078.78 60.90 70.45 58.79 3.03\n\nTabela 4.7: Impacto dos planos de corte por densidade do grafo\n\n\n\n4. Modelo linear por partes 65\n\n5. Calcule todos os conjuntos H(C, n)h e H(C, n, k)h. Este passo executa em tempo O(N\n3).\n\n6. Obtenha ??(C), ??H (C), ??A(C) e ??B(C), que \u00e9 executado em O(N 2 log N).\n\n7. Obtenha os fatores de pseudo-lifting ?n,k para todos (n, k) ? ??H (C)? ??A(C), que executa em\ntempo O(N 3).\n\n8. Em no m\u00e1ximo ?2 = N passos, sugira uma parti\u00e7\u00e3o {??r}Rr=0 de ??B(C) para induzir uma desi-\ngualdade de pseudo-lifting que corte a solu\u00e7\u00e3o:\n\n(a) Seja U o conjunto de folhas de G que n\u00e3o est\u00e1 em N(C).\n\n(b) Para cada n ?U , defina o conjunto ??i = ?({n}) com ni = n.\n\n(c) Aleatoriamente, separe V\\(U ?N(C)) em dois conjuntos disjuntos A e B.\n\n(d) Para cada n ? A, defina o conjunto ??i = ?({n}) com ni = n.\n\n(e) Seja ??0 = {(n, k) ? ? : n ? B, k = 3, . . . , ?(n)}.\n\n(f) Para cada n ? B, adicione (n, 2) a um conjunto aleat\u00f3rio ??r , r > 0, de maneira que n ? nr .\n\n(g) Compute os fatores de pseudo-lifting (n, k) ? ??B(C) de acordo com {??r}Rr=0.\n\n(h) Se a desigualdade de pseudo-lifting corta a solu\u00e7\u00e3o corrente, ent\u00e3o pare a busca e retorne\n\no plano de corte.\n\nOs passos 8-(a) \u00e0 8-(h) executam em tempo O(N 3), portanto, este passo executa em O(N 4).\n\n9. Se o passo 8 n\u00e3o encontrou um plano de corte, notifique a falha da heur\u00edstica.\n\nDos passos acima conclu\u00edmos que a heur\u00edstica de separa\u00e7\u00e3o \u00e9 executada em tempo O(N 4). Esta\n\nan\u00e1lise considera o pior caso, sendo que uma an\u00e1lise mais apurada pode levar a resultados melhores.\n\nUma an\u00e1lise mais otimista pode assumir ?? ? O(1).\n\nDa Tabela 4.6 podemos inferir que a aplica\u00e7\u00e3o de planos de corte promove uma diminui\u00e7\u00e3o subs-\n\ntancial do esfor\u00e7o computacional para resolu\u00e7\u00e3o do problema em termos do n\u00famero de itera\u00e7\u00f5es e n\u00f3s\n\nde Branch and Bound. Redu\u00e7\u00f5es maiores s\u00e3o observadas em circunst\u00e2ncias em que a disponibilidade\n\nde g\u00e1s de inje\u00e7\u00e3o \u00e9 limitada.\n\nA Tabela 4.7 apresenta a influ\u00eancia da densidade do grafo e seus ganhos com a aplica\u00e7\u00e3o de pla-\n\nnos de corte. Os resultados indicam que o problema se torna mais dif\u00edcil \u00e0 medida que a densidade do\n\ngrafo diminui. Ainda podemos observar que os ganhos absolutos da aplica\u00e7\u00e3o de planos de corte di-\n\nminuem com o aumento da densidade do grafo, enquanto os ganhos relativos aumentam nos extremos\n\n(devido \u00e0s restri\u00e7\u00f5es de preced\u00eancia e cen\u00e1rios altamente restritivos).\n\nOs resultados computacionais mostram que a gera\u00e7\u00e3o de planos de corte pode participar do pro-\n\ncesso de resolu\u00e7\u00e3o do problema. Entretanto, para um aproveitamento completo da teoria, a gera\u00e7\u00e3o de\n\nplanos de cortes deveria ocorrer em todos os n\u00f3s da \u00e1rvore de solu\u00e7\u00f5es, resultando em um algoritmo\n\nde Branch and Cut; e n\u00e3o apenas no poliedro completo, como foi implementado. Conforme a busca\n\navan\u00e7a nos ramos da \u00e1rvore de solu\u00e7\u00f5es, as vari\u00e1veis discretas s\u00e3o definidas como 0 ou 1, tornando o\n\ngrafo de preced\u00eancia esparso e permitindo que os cortes locais reduzam a dist\u00e2ncia primal-dual.\n\n\n\n4. Modelo linear por partes 66\n\n4.6 Sum\u00e1rio\n\nNeste cap\u00edtulo vimos uma formula\u00e7\u00e3o do problema de aloca\u00e7\u00e3o \u00f3tima de g\u00e1s de inje\u00e7\u00e3o sob\n\nrestri\u00e7\u00f5es de capacidade m\u00e1xima e de preced\u00eancia utilizando lineariza\u00e7\u00e3o por partes e programa\u00e7\u00e3o\n\nmatem\u00e1tica inteira-mista. Observamos que esta formula\u00e7\u00e3o \u00e9 reduzida a um problema da mochila sob\n\nrestri\u00e7\u00f5es de preced\u00eancia, assim, pudemos expandir a teoria de coberturas para buscar desigualdades\n\nv\u00e1lidas fortes para a formula\u00e7\u00e3o. Projetamos as desigualdades para todas as vari\u00e1veis de decis\u00e3o,\n\ncom os fatores de lifting, e propusemos uma maneira alternativa, computacionalmente mais leve,\n\npara o c\u00f4mputo de valores aproximados dos fatores de lifting, que chamamos de pseudo-lifting. Por\n\nfim, apresentamos resultados computacionais comparativos que comprovam a efic\u00e1cia da inser\u00e7\u00e3o de\n\nplanos de corte no problema.\n\n\n\nCap\u00edtulo 5\n\nInterface de otimiza\u00e7\u00e3o\n\nComo parte deste trabalho implementamos uma interface de usu\u00e1rio para resolu\u00e7\u00e3o de problemas\n\nde aloca\u00e7\u00e3o \u00f3tima de g\u00e1s de inje\u00e7\u00e3o. Desenvolvemos uma ferramenta de aux\u00edlio \u00e0 tomada de decis\u00e3o\n\npara opera\u00e7\u00e3o de campos de petr\u00f3leo operados por gas-lift.\n\nOs algoritmos de otimiza\u00e7\u00e3o s\u00e3o de natureza n\u00e3o similar e com interface algumas vezes complexa.\n\nBuscamos criar um ambiente que abstraia os modelos de otimiza\u00e7\u00e3o, para que o operador se preocupe\n\napenas com as informa\u00e7\u00f5es referentes ao campo de petr\u00f3leo, de maneira que a visualiza\u00e7\u00e3o dos dados\n\nseja o mais pr\u00f3ximo da realidade. Assim, fica a cargo do sistema a interpreta\u00e7\u00e3o dos dados e a\n\nmontagem e resolu\u00e7\u00e3o das inst\u00e2ncias, retirando do usu\u00e1rio a necessidade de compreender o modelo.\n\nEsta propriedade do sistema permite que para um mesmo cen\u00e1rio possam ser aplicados diferentes\n\nalgoritmos de otimiza\u00e7\u00e3o.\n\nUtilizamos uma estrutura cliente/servidor para resolu\u00e7\u00e3o dos algoritmos. Procuramos desenvolver\n\numa interface geral, que n\u00e3o seja aplic\u00e1vel apenas ao problema de interesse. A interface do cliente\n\npermite especificar problemas de aloca\u00e7\u00e3o \u00f3tima de g\u00e1s de inje\u00e7\u00e3o e possui flexibilidade para que\n\nsejam inclu\u00eddas restri\u00e7\u00f5es diferentes das tratadas em nosso trabalho como, por exemplo, restri\u00e7\u00f5es da\n\ntubula\u00e7\u00e3o, topologia da tubula\u00e7\u00e3o, perda de cargas, acoplamento de po\u00e7os e din\u00e2mica do processo.\n\nO servidor para algoritmos de otimiza\u00e7\u00e3o por sua vez, permite que qualquer algoritmo de otimiza\u00e7\u00e3o\n\nseja utilizado, n\u00e3o apenas os que tratam de problema de determina\u00e7\u00e3o de pontos de opera\u00e7\u00e3o para\n\ncampos de petr\u00f3leo.\n\nA estrutura cliente/servidor foi empregada para permitir que seja utilizada uma m\u00e1quina diferente\n\npara a caracteriza\u00e7\u00e3o do problema da m\u00e1quina em que a otimiza\u00e7\u00e3o ser\u00e1 executada. A resolu\u00e7\u00e3o\n\nde problemas de otimiza\u00e7\u00e3o, em geral, necessita de muito esfor\u00e7o e recursos computacionais para\n\ninst\u00e2ncias m\u00e9dias e grandes, exigindo um computador potente. Assim, destinamos a uma m\u00e1quina\n\nadequada, o servidor, a resolu\u00e7\u00e3o destes problemas; enquanto as m\u00e1quinas em que as inst\u00e2ncias\n\ndo problema s\u00e3o geradas podem ter recursos restritos. Outro fator considerado \u00e9 que algumas das\n\nferramentas utilizadas para a resolu\u00e7\u00e3o dos problemas de otimiza\u00e7\u00e3o s\u00e3o propriet\u00e1rias [31], ent\u00e3o\n\nesta estrutura requer apenas uma licensa de uso das ferramentas no servidor.\n\n\n\n5. Interface de otimiza\u00e7\u00e3o 68\n\nFigura 5.1: Ambiente de especifica\u00e7\u00e3o do problema\n\n5.1 Ambiente de especifica\u00e7\u00e3o do problema\n\nA interface de otimiza\u00e7\u00e3o possui um m\u00f3dulo de especifica\u00e7\u00e3o do problema em que o usu\u00e1rio\n\ndescreve cada um dos elementos que comp\u00f5em um campo de petr\u00f3leo. Este m\u00f3dulo foi estruturado\n\nde maneira bottom-up, para permitir que o sistema seja facilmente expandido, possibilitando que\n\nnovas caracter\u00edsticas sejam acrescentadas ao sistema de acordo com o surgimento das necessidades.\n\nA linguagem escolhida para implementa\u00e7\u00e3o deste sistema foi a Java [34], devido principalmente\n\na sua portabilidade entre sistemas operacionais e facilidade de implementa\u00e7\u00e3o de ambientes gr\u00e1ficos.\n\nNa Figura 5.1 podemos visualizar o ambiente desenvolvido e seus componentes. Este ambiente est\u00e1\n\ndividido em pain\u00e9is, cada um respons\u00e1vel pela edi\u00e7\u00e3o de um elemento ou caracter\u00edstica do campo de\n\npetr\u00f3leo:\n\nEditor gr\u00e1fico: este painel permite que o usu\u00e1rio formule um diagrama esquem\u00e1tico dos compo-\n\nnentes do campo (po\u00e7os, compressores, separadores e manifolds1 ) e suas conex\u00f5es atrav\u00e9s das\n\ntubula\u00e7\u00f5es, facilitando a visualiza\u00e7\u00e3o e navega\u00e7\u00e3o entre os elementos. Na Figura 5.2 temos\n\num exemplo de um diagrama representativo de um campo de petr\u00f3leo, seus componentes e\n\ntubula\u00e7\u00f5es.\n\nPre\u00e7os: nesta guia o usu\u00e1rio informa ao sistema os pre\u00e7os de mercado do \u00f3leo e g\u00e1s produzidos,\n\nassim como o custo de processamento da \u00e1gua extra\u00edda. Estes valores s\u00e3o necess\u00e1rios pois,\n\nnossos algoritmos de otimiza\u00e7\u00e3o utilizam um crit\u00e9rio econ\u00f4mico na fun\u00e7\u00e3o objetivo, buscando\n\no maior lucro da opera\u00e7\u00e3o do campo.\n\n1Elementos de conex\u00e3o de tubula\u00e7\u00e3o.\n\n\n\n5. Interface de otimiza\u00e7\u00e3o 69\n\nFigura 5.2: Editor gr\u00e1fico\n\nGrafo de preced\u00eancia: este painel permite que o usu\u00e1rio informe ao sistema as arestas que com-\n\np\u00f5em o grafo de restri\u00e7\u00f5es de preced\u00eancia de ativa\u00e7\u00e3o. Os v\u00e9rtices do grafo s\u00e3o os pr\u00f3prios\n\npo\u00e7os. Uma aresta significa que um po\u00e7o s\u00f3 ser\u00e1 ativado se seu predecessor estiver operando,\n\npelo menos, em seu n\u00edvel m\u00ednimo de produ\u00e7\u00e3o. O grafo de preced\u00eancia n\u00e3o possui rela\u00e7\u00e3o\n\ncom o grafo criado no editor gr\u00e1fico, ent\u00e3o um po\u00e7o pode preceder outro mesmo que eles n\u00e3o\n\nestejam conectados.\n\nCompressor: um campo de petr\u00f3leo operado por gas-lift possui pelo menos um compressor para\n\nproduzir o g\u00e1s de inje\u00e7\u00e3o, podendo ter v\u00e1rias unidades formando um banco de compressores.\n\nCada compressor possui uma capacidade m\u00e1xima de compress\u00e3o, que \u00e9 somada com a capa-\n\ncidade total do banco. Possui tamb\u00e9m um custo de compress\u00e3o associado. Uma caracter\u00edstica\n\ncomum dos compressores, separadores e po\u00e7os \u00e9 um nome que identifica o componente no\n\ncampo, e a possibilidade de desabilit\u00e1-lo. Um compressor desabilitado pode representar, por\n\nexemplo, que ele est\u00e1 desligado para manuten\u00e7\u00e3o, que gera a necessidade do rec\u00f4mputo das\n\ntaxas de inje\u00e7\u00e3o de cada po\u00e7o, pois a capacidade total de inje\u00e7\u00e3o \u00e9 uma restri\u00e7\u00e3o significativa.\n\nSeparador: este painel permite que o usu\u00e1rio informe ao sistema o limite de separa\u00e7\u00e3o do petr\u00f3leo\n\nproduzido em \u00f3leo, g\u00e1s e \u00e1gua, assim como as capacidades m\u00e1ximas de tratamento de cada um\n\ndos sub-produtos da extra\u00e7\u00e3o. Estes limites s\u00e3o tratados como restri\u00e7\u00f5es por Camponogara e\n\nNakashima [35], e foram inclu\u00eddos para tornar o programa compat\u00edvel com esta formula\u00e7\u00e3o.\n\nPo\u00e7o: nesta guia o usu\u00e1rio pode descrever cada um dos po\u00e7os do campo operados por gas-lift.\n\nPara cada po\u00e7o o usu\u00e1rio pode inserir v\u00e1rias CPPs, utilizando uma descri\u00e7\u00e3o linear por partes,\n\npolinomial, polinomial-logar\u00edtmica (polilog) ou exponencial (veja Se\u00e7\u00e3o 2.3). S\u00e3o permitidas\n\nm\u00faltiplas curvas, pois podemos utilizar tipos diferentes de express\u00f5es para representar a mesma\n\nCPP. Tamb\u00e9m \u00e9 poss\u00edvel que o operador n\u00e3o tenha certeza da curva que melhor descreve o po\u00e7o,\n\n\n\n5. Interface de otimiza\u00e7\u00e3o 70\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nWellField\n\nComponentCompressor\n\nSeparator\n\nWell\n\nManifold\n\nPipe\n\nPrecedenceGraph PrecedenceEdge\n\nAbstractWpc2\n\nExponentialWpc\n\nPolynomialWpc\n\nPolylogWpc\n\nPiecewiseLinearWpc\n\nPwlPoint\n\nFigura 5.3: Diagrama de classes da estrutura de dados da interface\n\ne deixa para o algoritmo a escolha da curva baseada em algum crit\u00e9rio como, por exemplo, o\n\npior caso ou caso m\u00e9dio [9]. Associado a cada CPP tamb\u00e9m temos as fra\u00e7\u00f5es m\u00e9dias de \u00f3leo,\n\ng\u00e1s e \u00e1gua presentes no petr\u00f3leo produzido pelo po\u00e7o.\n\nOutra capacidade do sistema \u00e9 a de transformar curvas de um tipo para outro. Curvas descritas\n\ncomo lineares por partes podem ser convertidas em polinomiais ou polilogs em um processo\n\nde ajuste por m\u00ednimos quadrados. O ajuste de curva pode ser irrestrito ou com garantia que a\n\ncurva seja c\u00f4ncava em seu intervalo de interesse. A garantia de concavidade \u00e9 uma exig\u00eancia\n\nde alguns algoritmos de otimiza\u00e7\u00e3o que utilizam programa\u00e7\u00e3o din\u00e2mica [9].\n\n5.1.1 Estrutura de dados\n\nO sistema foi estruturado internamente em um conjunto de classes que descrevem o campo de\n\npetr\u00f3leo. A Figura 5.3 mostra um diagrama de classes UML3 [36, 37] que representa as principais\n\nclasses desta estrutura. Nele apresentamos apenas os nomes das classes, omitindo seus atributos e\n\nm\u00e9todos. A classe base WellField representa o campo como um todo, e \u00e9 passada para todos os\n\nobjetos que a utilizam ou manipulam. A classe PrecedenceGraph representa o grafo de restri\u00e7\u00f5es de\n\npreced\u00eancia. Ela possui uma lista de arestas (PrecedenceEdge) e seus v\u00e9rtices s\u00e3o os pr\u00f3prios po\u00e7os\n\ndo campo.\n\nA classe abstrata Component representa todos os elementos que comp\u00f5em fisicamente o campo.\n\nDela herdam os compressores (Compressor), separadores (Separator), po\u00e7os de petr\u00f3leo (Well),\n\ntubos (Pipes) e conex\u00f5es de tubos (Manifold). A amplia\u00e7\u00e3o dos tipos de elementos do campo\n\npode ser feita herdando novas classes de Component. A estrutura do campo possui uma lista para\n\ncada classe filha de Component. Elas est\u00e3o ordenadas com base em um atributo identificador de\n\n2WPC - Well Performance Curve, Curva de Performance do Po\u00e7o.\n3UML - Unified Modeling Language, linguagem de modelagem que utiliza diagramas padronizados.\n\n\n\n5. Interface de otimiza\u00e7\u00e3o 71\n\nComponent, assim a busca de um elemento na lista, m\u00e9todo mais utilizado na implementa\u00e7\u00e3o, pode\n\nser feita como uma busca bin\u00e1ria, que executa em tempo ?(log2 n)[38]. Esta pol\u00edtica de manter a\nlista ordenada, em contrapartida, penaliza outros m\u00e9todos, como a inser\u00e7\u00e3o de novos elementos que\n\n\u00e9 executada em ?(n).\n\nCada po\u00e7o pode ter v\u00e1rias CPPs. A base para estas curvas \u00e9 a classe abstrata AbstractWpc. Desta\n\nclasse herdam as especializa\u00e7\u00f5es da curva, cada uma para sua express\u00e3o matem\u00e1tica equivalente: ex-\n\nponencial (ExponentialWpc), polinomial (PolynomialWpc), polinomial-logar\u00edtmica (PolylogWpc)\n\ne linear por partes (PiecewiseLinearWpc), que por sua vez possui um conjunto de pontos PwlPoint.\n\nCaso se deseje que o sistema trabalhe com alguma outra formula\u00e7\u00e3o para a CPP basta herdar uma nova\n\nclasse de AbstractWpc e desenvolver a interface com o usu\u00e1rio para a curva.\n\n5.1.2 Ajuste de curvas\n\nO sistema possui a capacidade de transformar curvas entre as formula\u00e7\u00f5es aceitas no sistema.\n\nEspecificamente, foram implementadas transforma\u00e7\u00f5es da curva linear por partes para as curvas po-\n\nlinomiais de terceira ordem e polilog. Estas transforma\u00e7\u00f5es s\u00e3o feitas por um m\u00e9todo de ajuste de\n\ncurvas por m\u00ednimos quadrados, que tenta aproximar a curva ao m\u00e1ximo dos pontos que formam a\n\ncurva linear por partes. Algoritmos como o de programa\u00e7\u00e3o din\u00e2mica apresentado em [9] exigem que\n\nas curvas de entrada no sistema sejam c\u00f4ncavas, por isso o sistema possui a capacidade de garantir a\n\nconcavidade da curva no ajuste.\n\nOutra transforma\u00e7\u00e3o poss\u00edvel \u00e9 uma discretiza\u00e7\u00e3o de qualquer uma das outras curvas em linear\n\npor partes. Entretanto, este processo considera apenas que a distribui\u00e7\u00e3o dos pontos seja feita em\n\nintervalos constantes, n\u00e3o levando em conta a correla\u00e7\u00e3o da curva proposta.\n\nA seguir apresentaremos a base matem\u00e1tica utilizada para os ajustes para curvas polinomias e\n\npolilog.\n\nPolinomial\n\nConsiderando a equa\u00e7\u00e3o polinomial de terceira ordem\n\np3(qin) = qout = c1 + c2qin + c3q\n2\nin + c4q\n\n3\nin (5.1)\n\ne um conjunto de k pontos Q ={(q1in, q\n1\nout ), . . . , (q\n\nk\nin, q\n\nk\nout )}. Se substituirmos cada ponto de Q em (5.1),\n\nchegamos a um sistema linear com 4 inc\u00f3gnitas e k equa\u00e7\u00f5es, que pode ser escrito matricialmente\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n1 (q1in) (q\n1\nin)\n\n2 (q1in)\n3\n\n1 (q2in) (q\n2\nin)\n\n2 (q2in)\n3\n\n...\n...\n\n...\n...\n\n1 (qkin) (q\nk\nin)\n\n2 (qkin)\n3\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nc1\nc2\nc3\nc4\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n=\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nq1out\nq2out\n\n...\n\nqkout\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n.\n\n\n\n5. Interface de otimiza\u00e7\u00e3o 72\n\nComo k ? 4 neste sistema linear Ax = b, minimizamos o res\u00edduo ? Ax?b ? para obter uma solu\u00e7\u00e3o\n\nque melhor se ajuste aos pontos, ou seja:\n\nMinimize\n1\n2\n? Ax?b ?2 (5.2)\n\nPara resolver (5.2) desenvolvemos a fun\u00e7\u00e3o objetivo\n\n1\n2\n? Ax?b ? =\n\n1\n2\n(Ax?b)T (Ax?b)\n\n=\n1\n2\n(xT AT ?bT )(Ax?b)\n\n=\n1\n2\n(xT AT Ax?xT AT b?bT Ax + bT b)\n\n=\n1\n2\n\nxT AT Ax?bT Ax +\n1\n2\n\nbT b. (5.3)\n\nComo 12 b\nT b \u00e9 constante, pode ser removido da fun\u00e7\u00e3o objetivo sem que seja alterado o valor das\n\nvari\u00e1veis de decis\u00e3o na solu\u00e7\u00e3o do problema. Minimizar a express\u00e3o (5.3) consiste em um problema\n\nde Programa\u00e7\u00e3o Quadr\u00e1tica. Note que xT AT Ax =? Ax ?2> 0, ?x, ou seja, a matriz AT A \u00e9 positiva\n\nsemi-definida. Se o posto de A \u00e9 completo, rank(A) = 4, ent\u00e3o AT A \u00e9 invers\u00edvel e a solu\u00e7\u00e3o para (5.2)\n\npode ser obtida com x = (AT A)?1AT b.\n\nDesejamos poder impor que o polin\u00f4mio p3(qin) seja c\u00f4ncavo em todo o intervalo [q\n1\nin, q\n\nk\nin]. Para\n\nisto sua segunda derivada deve ser negativa em todo o intervalo cont\u00ednuo,\n\np??3 (qin) = 6c4qin + 2c3 6 0,?qin ? [q\n1\nin, q\n\nk\nin].\n\nIsto implica em um n\u00famero infinito de restri\u00e7\u00f5es para cobrir todo o intervalo. Este n\u00famero de restri-\n\n\u00e7\u00f5es pode ser reduzido segundo a seguinte proposic\u00e3o:\n\nProposi\u00e7\u00e3o 5.1 Se p3(qin) for c\u00f4ncava em q1in e q\nk\nin, ent\u00e3o p3(qin) \u00e9 c\u00f4ncava para todo qin ? [q\n\n1\nin, q\n\nk\nin].\n\nProva: Como p??3 (qin) \u00e9 um polin\u00f4mio de primeira ordem (c4 6= 0), ele possui no m\u00e1ximo uma raiz\n\nno intervalo [q1in, q\nk\nin]. Se p\n\n??\n3 (qin) 6 0, qin ?{q\n\n1\nin, q\n\nk\nin}, segundo o Teorema de Bolzano [39], existe um\n\nn\u00famero par de ra\u00edzes para p??3 (qin) em [q\n1\nin, q\n\nk\nin]. Ent\u00e3o p\n\n??\n3 (qin) n\u00e3o possui ra\u00edzes em [q\n\n1\nin, q\n\nk\nin], ou seja,\n\nn\u00e3o ocorre altera\u00e7\u00e3o na concavidade de p3(qin) no intervalo em quest\u00e3o. Como p3(qin) \u00e9 c\u00f4ncava em\n\nq1in e q\nk\nin, ent\u00e3o p3(qin) \u00e9 c\u00f4ncava ?qin ? [q\n\n1\nin, q\n\nk\nin]. ?\n\nEsta proposi\u00e7\u00e3o restringe para dois o n\u00famero de restri\u00e7\u00f5es, que s\u00e3o lineares. Isto faz com que\n\nseja poss\u00edvel utilizar um algoritmo de Programa\u00e7\u00e3o Quadr\u00e1tica com Restri\u00e7\u00f5es para ajustar a curva\n\npolinomial aos pontos com garantia de concavidade.\n\n\n\n5. Interface de otimiza\u00e7\u00e3o 73\n\nPolinomial-logar\u00edtmica\n\nConsidere agora a equa\u00e7\u00e3o polinomial-logar\u00edtmica\n\npl (qin) = qout = c1 + c2qin + c3q\n2\nin + c4 ln(1 + qin) (5.4)\n\ne o conjunto de k pontos Q = {(q1in, q\n1\nout ), . . . , (q\n\nk\nin, q\n\nk\nout )}. De maneira an\u00e1loga \u00e0 se\u00e7\u00e3o anterior subs-\n\ntitu\u00edmos cada ponto de Q em (5.4) e obtemos o sistema linear representado matricialmente\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n1 (q1in) (q\n1\nin)\n\n2 ln(1 + q1in)\n\n1 (q2in) (q\n2\nin)\n\n2 ln(1 + q2in)\n...\n\n...\n...\n\n...\n\n1 (qkin) (q\nk\nin)\n\n2 ln(1 + qkin)\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nc1\nc2\nc3\nc4\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n=\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nq1out\nq2out\n\n...\n\nqkout\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n.\n\nCom o mesmo racioc\u00ednio que foi visto anteriormente, podemos obter a curva que melhor se ajuste\n\na Q sem garantia de que a curva seja c\u00f4ncava.\n\nPara que pl (qin) seja c\u00f4ncava em [q\n1\nin, q\n\nk\nin] sua derivada segunda deve ser negativa no intervalo,\n\np??l (qin) = 2c3 ?c4\n1\n\n(1 + qin)2\n&lt;0,?qin ? [q\n\n1\nin, q\n\nk\nin]\n\nProposi\u00e7\u00e3o 5.2 Se pl (qin) for c\u00f4ncava em q1in e q\nk\nin, ent\u00e3o pl (qin) \u00e9 c\u00f4ncava para todo qin ? [q\n\n1\nin, q\n\nk\nin].\n\nProva: Se p??l (q\nk\nin) &lt;0 e c4 > 0, conforme qin decresce a partir de q\n\nk\nin, p\n\n??\nl (qin) se torna mais negativa,\n\ngarantindo que pl (qin) seja c\u00f4ncava para todo qin 6 q\nk\nin. Caso c4 &lt;0, p\n\n??\nl (qin) decresce conforme qin\n\ncresce, ent\u00e3o \u00e9 necess\u00e1rio que p??l (q\n1\nin) &lt;0. Como c4 pode assumir qualquer sinal, \u00e9 necess\u00e1rio que\n\nnos dois casos a concavidade seja verificada. ?\n\nAssim, \u00e9 necess\u00e1rio apenas impor garantia de concavidade nos limites do conjunto para que a\n\nfun\u00e7\u00e3o seja c\u00f4ncava em todo o intervalo.\n\nNa figura 5.4 apresentamos a guia utilizada para caracterizar um po\u00e7o de petr\u00f3leo, na aba de CPP\n\n(WPC). No lado esquerdo o usu\u00e1rio informa separadamente as caracter\u00edsticas de cada uma das curvas.\n\nNo caso, est\u00e1 sendo editada a curva n\u00famero 1, que \u00e9 uma curva linear por partes com pontos de acordo\n\ncom os da tabela. No topo \u00e0 direita est\u00e3o as fra\u00e7\u00f5es de \u00f3leo, g\u00e1s e \u00e1gua produzidas pelo po\u00e7o. Abaixo\n\nest\u00e1 um gr\u00e1fico que mostra as curvas (algumas ou todas) do po\u00e7o. A curva descont\u00ednua desenhada\n\nrepresenta a linear por partes que est\u00e1 sendo editada. A curva de melhor correla\u00e7\u00e3o (mais pr\u00f3xima) \u00e0\n\ndescont\u00ednua foi gerada a partir do ajuste da primeira em uma express\u00e3o polinomial-logar\u00edtmica com\n\ngarantia de concavidade, resultando na express\u00e3o:\n\nqout = ?5, 5069\u00b710\n3 ?9, 3484\u00b710?1 \u00b7qin + 3, 7372\u00b710\n\n?5 \u00b7q2in + 1, 2951\u00b710\n3 \u00b7 ln(1 + qin).\n\n\n\n5. Interface de otimiza\u00e7\u00e3o 74\n\nFigura 5.4: Guia de caracteriza\u00e7\u00e3o de po\u00e7o com exemplo de ajuste de curva\n\nA terceira curva \u00e9 uma polinomial de terceira ordem, que tamb\u00e9m foi gerada com garantia de conca-\n\nvidade:\n\nqout = 5, 5866\u00b710\n2 + 2, 7233\u00b7qin ?9, 4509\u00b710\n\n?4 \u00b7q2in + 8, 439\u00b710\n?8 \u00b7q3in.\n\n5.1.3 Padr\u00e3o dos arquivos\n\n\u00c9 desej\u00e1vel no sistema que o usu\u00e1rio possa gravar e recuperar os dados referentes ao campo\n\nde petr\u00f3leo que est\u00e1 sendo estudado, para que o processo de caracteriza\u00e7\u00e3o do campo e invoca\u00e7\u00e3o\n\ndos algoritmos de otimiza\u00e7\u00e3o possa ser interrompido e recuperado a qualquer momento. Como um\n\nrequisito do nosso sistema \u00e9 a capacidade de expans\u00e3o, buscamos uma estrutura aberta e facilmente\n\nmanipul\u00e1vel. Para isto, utilizamos a linguagem XML4 [40], que procura padronizar a representa\u00e7\u00e3o\n\nde dados. Este padr\u00e3o \u00e9 bastante abrangente, sendo que foi utilizado apenas uma pequena parte de\n\nsuas funcionalidades.\n\nNa Figura 5.5 apresentamos um exemplo da estrutura do arquivo para um campo de petr\u00f3leo. Nela\n\npodemos observar os pre\u00e7os do \u00f3leo e g\u00e1s, e o custo do tratamento da \u00e1gua extra\u00edda. Observamos\n\ntamb\u00e9m que o campo possui um po\u00e7o (Well), um compressor (Compressor) e um tubo (Pipe). O po\u00e7o,\n\npor sua vez, \u00e9 descrito por duas CPPs: uma linear por partes, com quatro pontos, e outra polinomial-\n\nlogar\u00edtmica, ajustada a partir da primeira. O compressor possui sua capacidade m\u00e1xima de inje\u00e7\u00e3o de\n\ng\u00e1s e seu custo de opera\u00e7\u00e3o. Tanto no po\u00e7o como no compressor, existe uma informa\u00e7\u00e3o de posi\u00e7\u00e3o,\n\nque \u00e9 utilizada no editor esquem\u00e1tico do campo. O tubo liga o po\u00e7o \u201c1\u201d ao compressor \u201c1\u201d, e possui\n\numa quina. Para os atributos que n\u00e3o est\u00e3o descritos no arquivo s\u00e3o assumidos valores padr\u00e3o, como\n\npor exemplo, o \u201cHabilitado\u201d, que assume que o po\u00e7o e o compressor est\u00e3o em opera\u00e7\u00e3o.\n\n4XML - eXtensible Markup Language, linguagem de marca\u00e7\u00e3o extens\u00edvel. \u00c9 uma recomenda\u00e7\u00e3o para gerar linguagens\nde marca\u00e7\u00e3o cujo prop\u00f3sito principal \u00e9 facilitar o compartilhamento de informa\u00e7\u00f5es atrav\u00e9s da Internet.\n\n\n\n5. Interface de otimiza\u00e7\u00e3o 75\n\n<?xml version=\"1.0\"encoding=\"UTF-8\"?>\n<WellField>\n\n<OilPrice>20.0</OilPrice>\n<GasPrice>2.0</GasPrice>\n<WaterCost>1.0</WaterCost>\n<Well>\n\n<Number>1</Number>\n<Position X=\"60.0\"Y=\"200.0\"/>\n<Function Type=\"PieceWise\">\n\n<Oil>0.731</Oil>\n<Gas>0.203</Gas>\n<Water>0.066</Water>\n<Point QI=\"0.08\"QP=\"1774.0\"/>\n<Point QI=\"0.3\"QP=\"2053.0\"/>\n<Point QI=\"0.6\"QP=\"2215.0\"/>\n<Point QI=\"0.9\"QP=\"2266.0\"/>\n\n</Function>\n<Function Type=\"Polylog\">\n\n<Oil>0.731</Oil>\n<Gas>0.203</Gas>\n<Water>0.066</Water>\n<C1>1616.5813240907655</C1>\n<C2>-6422.52084981815</C2>\n<C3>1099.2515464911717</C3>\n<C4>8630.147464122258</C4>\n<LowerBound>0.08</LowerBound>\n<UpperBound>0.9</UpperBound>\n\n</Function>\n</Well>\n<Compressor>\n\n<Number>1</Number>\n<Capacity>0.1</Capacity>\n<CompCost>5.0</CompCost>\n<Position X=\"170.0\"Y=\"250.0\"/>\n\n</Compressor>\n<Pipe>\n\n<Extremity1 Number=\"1\"Type=\"Well\"/>\n<Extremity2 Number=\"1\"Type=\"Compressor\"/>\n<PipeCorner X=\"60.0\"Y=\"250.0\"/>\n\n</Pipe>\n</WellField>\n\nFigura 5.5: Exemplo do formato de grava\u00e7\u00e3o dos dados\n\n\n\n5. Interface de otimiza\u00e7\u00e3o 76\n\n5.2 Servidor de otimiza\u00e7\u00e3o\n\nO servidor \u00e9 a implementa\u00e7\u00e3o que permite que algoritmos de otimiza\u00e7\u00e3o possam ser executados\n\nremotamente. A m\u00e1quina que hospeda o servidor pode possuir programas espec\u00edficos de otimiza\u00e7\u00e3o,\n\nassim n\u00e3o \u00e9 necess\u00e1rio que estes programas sejam instalados na m\u00e1quina do usu\u00e1rio.\n\nEm nossa aplica\u00e7\u00e3o utilizamos ferramentas propriet\u00e1rias para resolu\u00e7\u00e3o de nossos algoritmos.\n\nFica a cargo do servidor disponibilizar o uso destas ferramentas para todos os usu\u00e1rios do sistema.\n\nOutro aspecto \u00e9 o sistema operacional necess\u00e1rio para a execu\u00e7\u00e3o das ferramentas. Como desej\u00e1va-\n\nmos um ambiente de especifica\u00e7\u00e3o de problema livre desta restri\u00e7\u00e3o, precisamos criar uma interface\n\ngen\u00e9rica para os algoritmos. Desej\u00e1vamos tamb\u00e9m que esta funcionalidade n\u00e3o estivesse dispon\u00edvel\n\napenas para algoritmos de otimiza\u00e7\u00e3o de taxas de inje\u00e7\u00e3o de g\u00e1s, mas que pudesse resolver outros\n\nproblemas de otimiza\u00e7\u00e3o.\n\nPara deixar a interface do servidor o mais gen\u00e9rica poss\u00edvel, optamos por utilizar uma estrutura\n\nbaseada em arquivos. O usu\u00e1rio envia um, ou v\u00e1rios, arquivos para o servidor contendo a inst\u00e2ncia\n\ndo problema e mais algum arquivo que possa necessitar, como por exemplo, o modelo caso n\u00e3o esteja\n\njunto com a inst\u00e2ncia. Envia tamb\u00e9m um arquivo com um ou mais comandos, que indica ao servidor\n\nquais devem ser as a\u00e7\u00f5es tomadas com os arquivos de inst\u00e2ncia. O servidor, por sua vez, grava todas\n\nas mensagens de resposta recebidas da execu\u00e7\u00e3o das inst\u00e2ncias do problema em um arquivo de sa\u00edda\n\ne outro de erros, que \u00e9 enviado ao usu\u00e1rio. Caso o usu\u00e1rio deseje direcionar passos intermedi\u00e1rios\n\npara arquivos auxiliares, tamb\u00e9m \u00e9 poss\u00edvel, podendo consult\u00e1-los posteriormente. Uma desvantagem\n\ndesta estrutura \u00e9 que n\u00e3o permite que o usu\u00e1rio monitore a resolu\u00e7\u00e3o de seu problema enquanto ela \u00e9\n\nexecutada; apenas permite que veja a resposta ap\u00f3s a resolu\u00e7\u00e3o ter sido conclu\u00edda.\n\nUm grande desafio enfrentado foi que o computador que possui os recursos para executar os\n\nalgoritmos de otimiza\u00e7\u00e3o estava localizado dentro de uma rede segura. Desej\u00e1vamos que este servidor\n\npudesse ser acessado a partir de qualquer computador, ou seja, que tamb\u00e9m pudesse ser acessado a\n\npartir de computadores localizados fora da rede segura. A conex\u00e3o direta entre estas duas m\u00e1quinas\n\nn\u00e3o \u00e9 permitida, pois abre um caminho para falhas na seguran\u00e7a da rede.\n\nPara resolver este problema foram desenvolvidos dois programas. O primeiro \u00e9 o gerenciador das\n\ninst\u00e2ncias, respons\u00e1vel por receber, gerenciar e executar as inst\u00e2ncias, e enviar e permitir consultas das\n\nsolu\u00e7\u00f5es obtidas. Este programa est\u00e1 instalado e executa no computador com recursos para resolver\n\nos problemas de otimiza\u00e7\u00e3o. O segundo programa \u00e9 uma interface do servidor, e fica alojado na\n\nm\u00e1quina que conecta a rede segura ao meio externo. Ele \u00e9 respons\u00e1vel por receber as inst\u00e2ncias,\n\nverificar se elas s\u00e3o seguras (n\u00e3o s\u00e3o arquivos maliciosos, com inten\u00e7\u00e3o de \u201catacar\u201d a rede interna), e\n\nencaminhar ao servidor; assim como pesquisar as respostas e apresentar para o usu\u00e1rio.\n\nA seguir, apresentamos detalhadamente cada um dos programas que formam o sistema.\n\n\n\n5. Interface de otimiza\u00e7\u00e3o 77\n\n5.2.1 Gerenciador de inst\u00e2ncias\n\nO gerenciador de inst\u00e2ncias \u00e9 o n\u00facleo do servidor de otimiza\u00e7\u00e3o. Desenvolvido em linguagem\n\nC++ [32, 41] para o sistema operacional Linux, o sistema foi estruturado utilizando programa\u00e7\u00e3o con-\n\ncorrente [42], que permite que v\u00e1rias a\u00e7\u00f5es sejam executadas simultaneamente (na realidade, ocorre\n\num pseudo-paralelismo entre os processos [43]). No computador em que est\u00e1 sendo executado, o ge-\n\nrenciador roda em segundo plano (background), ficando totalmente transparente para algum usu\u00e1rio\n\nque eventualmente esteja utilizando aquela m\u00e1quina.\n\nOs processos que comp\u00f5em o gerenciador s\u00e3o:\n\nGerenciador de conex\u00f5es: Este processo \u00e9 respons\u00e1vel por receber e despachar novas conex\u00f5es de\n\nrede executadas no servidor. Quando um usu\u00e1rio deseja conectar-se com o servidor, ele realiza\n\numa solicita\u00e7\u00e3o em uma porta TCP-IP [44] espec\u00edfica do servidor. Este processo, por sua vez,\n\nfica travado, aguardando esta solicita\u00e7\u00e3o. Quando ela ocorre, o processo avalia se a conex\u00e3o\n\npode ser estabelecida (limitando o n\u00famero m\u00e1ximo de conex\u00f5es), e caso positivo dispara um\n\nnovo processo que faz a comunica\u00e7\u00e3o com o usu\u00e1rio.\n\nConex\u00f5es: Cada conex\u00e3o estabelecida com o servidor gera um novo processo desta classe. Este\n\nprocesso recebe comandos do usu\u00e1rio e responde de maneira apropriada, por exemplo, a carga\n\nde uma nova inst\u00e2ncia ou obten\u00e7\u00e3o de uma resposta.\n\nMonitor de processador: Quando existe uma nova inst\u00e2ncia para ser executada, o sistema neces-\n\nsita saber se a m\u00e1quina est\u00e1 dispon\u00edvel para execut\u00e1-la. Algoritmos de otimiza\u00e7\u00e3o s\u00e3o CPU\n\nbounded, isto \u00e9, necessitam do processador intensamente. Adotamos ent\u00e3o como m\u00e9trica para\n\nsaber se \u00e9 poss\u00edvel executar o algoritmo um hist\u00f3rico (de aproximadamente um minuto) de ocu-\n\npa\u00e7\u00e3o do processador. Se o processador estiver sendo pouco utilizado (no caso menos de 50%\n\nem todos os pontos do hist\u00f3rico), o sistema est\u00e1 apto para disparar processos de otimiza\u00e7\u00e3o.\n\nEste processo tem como fun\u00e7\u00e3o verificar ciclicamente (em intervalos de aproximadamente 20\n\nsegundos) a ocupa\u00e7\u00e3o do processador e montar um hist\u00f3rico de uso, assim como permitir ou\n\nbloquear que novas inst\u00e2ncias sejam iniciadas.\n\nGerenciador de execu\u00e7\u00e3o: Quando o processo de conex\u00f5es recebe uma nova inst\u00e2ncia e manda que\n\nseja executada, ela \u00e9 colocada em uma fila. Este processo \u00e9 respons\u00e1vel por verificar se existem\n\nelementos nesta fila e, quando for permitido, executar os comandos da inst\u00e2ncia. Enquanto\n\nse busca a solu\u00e7\u00e3o de uma inst\u00e2ncia, este processo tamb\u00e9m \u00e9 respons\u00e1vel por verificar quanto\n\ntempo de processador o problema utilizou, o limitando de acordo com os direitos do usu\u00e1rio,\n\nevitando assim que problemas muito grandes sejam resolvidos por usu\u00e1rios com pouco direito\n\nde acesso. Finalizada a execu\u00e7\u00e3o da inst\u00e2ncia, este gerenciador \u00e9 respons\u00e1vel por enviar a\n\nresposta ao usu\u00e1rio.\n\nGerenciador de inst\u00e2ncias antigas: Este processo \u00e9 executado em intervalos de tempo bastante\n\nlongos. Sua fun\u00e7\u00e3o \u00e9 monitorar h\u00e1 quanto tempo cada inst\u00e2ncia est\u00e1 armazenada no servi-\n\ndor, e descart\u00e1-la se este per\u00edodo for maior que um certo limite. Isto faz com que inst\u00e2ncias\n\n\n\n5. Interface de otimiza\u00e7\u00e3o 78\n\nmuito antigas, e potencialmente n\u00e3o mais necess\u00e1rias ao usu\u00e1rio, sejam eliminadas do servidor,\n\nliberando espa\u00e7o de armazenamento.\n\nO protocolo de conex\u00e3o com o servidor foi feito inspirado nos protocolos SMTP [45] e POP [46].\n\nA troca de dados \u00e9 feita utilizando caracteres ASCII5, que torna a comunica\u00e7\u00e3o bastante simples.\n\nComandos s\u00e3o enviados ao servidor em um formato texto, interpretados e as respostas geradas s\u00e3o\n\nenviadas. Podemos dividi-los em tr\u00eas grupos: identifica\u00e7\u00e3o, que permite que o usu\u00e1rio se apresente\n\nao servidor atrav\u00e9s de uma identifica\u00e7\u00e3o (comando ID) e uma senha (comando PSW). Caso o usu\u00e1rio\n\nn\u00e3o se identifique, o servidor vai admitir que a conex\u00e3o \u00e9 an\u00f4nima, e seus direitos (como por exemplo\n\no tempo de processador para rodar sua inst\u00e2ncia) ser\u00e3o restritos.\n\nUm segundo grupo de comandos permite que o usu\u00e1rio informe ao servidor o problema a ser\n\nresolvido. Os comandos FILE e CMD permitem que o usu\u00e1rio envie arquivos contendo a inst\u00e2ncia e\n\nos comandos que ser\u00e3o executados, respectivamente. Para solicitar que o servidor execute a inst\u00e2ncia\n\nenviada utiliza-se os comandos RUN e RUNMAIL, sendo que o \u00faltimo envia a resposta por e-mail para\n\no usu\u00e1rio.\n\nO \u00faltimo grupo de comandos \u00e9 utilizado para verificar a resposta da execu\u00e7\u00e3o de um problema.\n\nEles s\u00e3o apresentados no exemplo da Figura 5.6, em que \u00e9 estabelecida uma conex\u00e3o com o servidor\n\ne solicitada esta resposta. As senten\u00e7as grifadas s\u00e3o os comandos enviados pelo usu\u00e1rio, e as sem\n\ngrifo s\u00e3o as respostas obtidas. Na primeira linha \u00e9 solicitada uma conex\u00e3o com o servidor, que\n\nest\u00e1 hospedado no mesmo computador em que o teste foi realizado, na porta 1209. A conex\u00e3o \u00e9\n\nestabelecida e na linha 2 o servidor envia uma mensagem de boas vindas. Em seguida o usu\u00e1rio\n\ninforma que deseja trabalhar com a inst\u00e2ncia n\u00famero 18, e solicita que o sistema informe o seu\n\nestado. O servidor responde (na linha 6) que j\u00e1 executou a inst\u00e2ncia. Outras respostas poderiam ser\n\nque est\u00e1 na fila aguardando (Queue) ou que est\u00e1 sendo executada naquele momento (Running). Por\n\nfim, o usu\u00e1rio solicita a resposta gerada, que est\u00e1 no arquivo out.txt.\n\n5.2.2 Interface\n\nPara abstrair os comandos do gerenciador de conex\u00f5es, e permitir que este seja acessado de fora\n\nda rede segura, foi desenvolvida uma interface amig\u00e1vel para o servidor. Esta interface \u00e9 acessada\n\ncomo uma p\u00e1gina de Internet6 e fica hospedada no computador que faz a conex\u00e3o da rede segura\n\ncom o meio externo. Esta parte do c\u00f3digo do servidor foi escrita em linguagem PHP [47], que \u00e9 uma\n\nlinguagem que permite gerar p\u00e1ginas din\u00e2micas. Quando a p\u00e1gina \u00e9 solicitada ao servidor de p\u00e1ginas,\n\no c\u00f3digo escrito em PHP \u00e9 executado e uma p\u00e1gina \u00e9 gerada especificamente para aquela conex\u00e3o.\n\nIsto permite que quando o usu\u00e1rio solicitar uma p\u00e1gina de respostas, por exemplo, o servidor de\n\np\u00e1ginas se conecta com o gerenciador de inst\u00e2ncias, consulta as informa\u00e7\u00f5es necess\u00e1rias e gera a\n\np\u00e1gina de acordo com a resposta do gerenciador.\n\n5ASCII - American Standard Code for Information Interchange, c\u00f3digo padronizado americano para troca de informa-\n\u00e7\u00f5es. Conjunto de c\u00f3digos criado em 1961 para o computador representar n\u00fameros, letras, pontua\u00e7\u00e3o e outros caracteres.\n\n6No momento da escrita desta disserta\u00e7\u00e3o esta interface pode ser acessada pelo endere\u00e7o\nhttp://www.das.ufsc.br/otimizacao.\n\n\n\n5. Interface de otimiza\u00e7\u00e3o 79\n\n1 deconto@deconto:?> telnet localhost 1209\n2 100 hello. welcome to das-ufsc optimization server\n3 SETINST 18\n4 100 working with instance 18\n5 GETSTATUS\n6 101 6 FINISHED\n7 GETFILE out.txt\n8 100 sending file\n9 ANP/PRH34 Gas-lift Optimization\n10 MILP answer\n11 ---------------------\n12 Optimum profit: 30787.4\n13 Oil Well Injection Rate\n14 1 - Oil Well 80\n15 2 - Oil Well 154\n16 3 - Oil Well 0\n17 4 - Oil Well 0\n18 .\n19 100 end of file\n20 QUIT\n21 100 bye\n\nFigura 5.6: Exemplo de conex\u00e3o com o gerenciador de inst\u00e2ncias\n\nA interface possui dois grupos de c\u00f3digo bastante semelhantes. O primeiro possui um ambiente\n\namig\u00e1vel para ser acessado pelo usu\u00e1rio, e permite que este escolha quais arquivos ser\u00e3o carregados,\n\ne verifique o estado de execu\u00e7\u00e3o e a resposta de sua inst\u00e2ncia. No segundo as funcionalidades s\u00e3o\n\nas mesmas do primeiro, mas o ambiente n\u00e3o permite intera\u00e7\u00e3o com o usu\u00e1rio (como bot\u00f5es e links).\n\nFoi gerado para que outros programas utilizem os recursos do servidor (no caso, o Ambiente de\n\nEspecifica\u00e7\u00e3o de Problema), uma vez que a comunica\u00e7\u00e3o do programa com o servidor \u00e9 feita de\n\nmaneira mais direta, com chamadas http [48, 49].\n\nNa Figura 5.7 apresentamos o ambiente para utilizar o servidor de otimiza\u00e7\u00e3o a partir de uma\n\np\u00e1gina de Internet. No topo podemos observar as tr\u00eas funcionalidades dispon\u00edveis: Submit data\n\npermite que o usu\u00e1rio submeta uma nova inst\u00e2ncia para ser executada no servidor; Get Status \u00e9\n\nutilizado para verificar o estado de uma inst\u00e2ncia submetida, podendo ser Aguardando, Executando\n\nou Conclu\u00eddo; a op\u00e7\u00e3o Get Answer retorna para o usu\u00e1rio a resposta obtida da execu\u00e7\u00e3o de uma dada\n\ninst\u00e2ncia. Abaixo est\u00e3o os campos para submeter uma nova inst\u00e2ncia: E-mail \u00e9 o endere\u00e7o eletr\u00f4nico\n\ndo usu\u00e1rio, caso ele deseje que a resposta lhe seja enviada por este meio; Commands \u00e9 o arquivo\n\nque cont\u00e9m os comandos que o servidor deve utilizar; e Data File n s\u00e3o os campos destinados aos\n\narquivos de inst\u00e2ncia que o usu\u00e1rio deseja submeter.\n\n5.3 Estudo de caso\n\nNesta se\u00e7\u00e3o apresentaremos como utilizar a interface de otimiza\u00e7\u00e3o para obter as taxas de inje\u00e7\u00e3o\n\n\u00f3timas em uma inst\u00e2ncia pequena. Para problemas em escala maior o procedimento \u00e9 exatamente o\n\nmesmo.\n\nConsidere um campo de petr\u00f3leo com quatro po\u00e7os operando por gas-lift. Este campo possui um\n\nbanco com tr\u00eas compressores e toda a produ\u00e7\u00e3o \u00e9 enviada para um separador. Na interface \u00e9 poss\u00edvel\n\n\n\n5. Interface de otimiza\u00e7\u00e3o 80\n\nFigura 5.7: Interface para o usu\u00e1rio do servidor de otimiza\u00e7\u00e3o\n\nn (q\nn,1\nin , q\n\nn,1\nout ) (q\n\nn,2\nin , q\n\nn,2\nout ) (q\n\nn,3\nin , q\n\nn,3\nout ) ?no ?\n\nn\ng ?\n\nn\nw\n\n1 ( 80, 960) (200, 1044) (267, 1060) 0,70 0,20 0,10\n2 ( 80, 998) (133, 1140) (200, 1412) 0,75 0,17 0,08\n3 ( 80, 1108) (133, 1132) (267, 1652) 0,65 0,25 0,10\n4 ( 80, 1090) (133, 1200) (267, 1500) 0,66 0,24 0,10\n\nTabela 5.1: Descri\u00e7\u00e3o dos campos de petr\u00f3leo para o estudo de caso\n\nabrir um editor esquem\u00e1tico do campo, e montar um diagrama como o apresentado na Figura 5.2\n\narrastando os componentes para dentro do painel de edi\u00e7\u00e3o. Este diagrama n\u00e3o \u00e9 necess\u00e1rio para que\n\nos problemas sejam instanciados, mas em casos de tamanho m\u00e9dio e grande ele pode ajudar o usu\u00e1rio\n\norganizando as informa\u00e7\u00f5es do campo.\n\nEm seguida devemos caracterizar o campo. Como nossos algoritmos s\u00e3o baseados em um crit\u00e9rio\n\necon\u00f4mico, \u00e9 necess\u00e1rio que sejam informados os pre\u00e7os do \u00f3leo e g\u00e1s produzido, assim como o\n\ncusto de tratamento da \u00e1gua extra\u00edda. Em nosso exemplo assumimos $ 20,00 e $ 2,00 para os pre\u00e7os\n\ndo \u00f3leo e g\u00e1s produzidos, e $ 1,00 para o custo de tratamento da \u00e1gua. Descrevemos cada po\u00e7o n com\n\numa CPP contendo tr\u00eas pontos cada. A Tabela 5.1 apresenta os pontos da curva de cada po\u00e7o, assim\n\ncomo suas propor\u00e7\u00f5es de \u00f3leo, g\u00e1s e \u00e1gua (?no, ?\nn\ng e ?\n\nn\nw) produzidas.\n\nNo banco de compressores consideramos que a capacidade de cada compressor \u00e9 60, 60 e 80\n\nunidades de g\u00e1s comprimido, resultando em 200 unidades de capacidade total de inje\u00e7\u00e3o, a um custo\n\ncomum de $ 5,00. Como o algoritmo de otimiza\u00e7\u00e3o que utilizaremos n\u00e3o considera restri\u00e7\u00f5es no\n\nseparador, ele n\u00e3o foi caracterizado. Admitimos tamb\u00e9m que n\u00e3o existe restri\u00e7\u00e3o de preced\u00eancia em\n\nnossa inst\u00e2ncia, mas um grafo de preced\u00eancia pode ser facilmente introduzido.\n\n\n\n5. Interface de otimiza\u00e7\u00e3o 81\n\nFigura 5.8: Apresenta\u00e7\u00e3o da solu\u00e7\u00e3o de um problema\n\nA caracteriza\u00e7\u00e3o do campo n\u00e3o precisa ser feita nesta seq\u00fc\u00eancia. O sistema d\u00e1 total liberdade\n\npara o usu\u00e1rio, de maneira que ele insira as informa\u00e7\u00f5es conforme elas lhe forem disponibilizadas.\n\nTamb\u00e9m \u00e9 poss\u00edvel fazer a qualquer momento altera\u00e7\u00f5es na estrutura do campo, como adicionar\n\nnovos po\u00e7os ou os excluir.\n\nMontado o campo \u00e9 poss\u00edvel fazer chamadas ao algoritmo de otimiza\u00e7\u00e3o para que as melhores\n\ntaxas de inje\u00e7\u00e3o de g\u00e1s sejam calculadas. A primeira etapa consiste em escolher qual algoritmo ser\u00e1\n\nutilizado. Em seguida \u00e9 aberto um di\u00e1logo com o usu\u00e1rio para que este configure detalhes da execu\u00e7\u00e3o\n\ndo algoritmo. No caso do modelo apresentado nesta disserta\u00e7\u00e3o, \u00e9 poss\u00edvel configurar se deseja-se\n\nou n\u00e3o que as restri\u00e7\u00f5es de preced\u00eancia sejam consideradas. O passo seguinte \u00e9 executar um pr\u00e9-\n\nprocessamento dos dados do campo. Nesta etapa s\u00e3o verificadas inconsist\u00eancias na inst\u00e2ncia, como\n\npor exemplo, um po\u00e7o n\u00e3o caracterizado por sua CPP, ou um compressor habilitado com capacidade\n\nde compress\u00e3o nula. Se o sistema gerar mensagens de alerta como as exemplificadas, o usu\u00e1rio ainda\n\npode continuar o processo, mas mensagens de erro como incoer\u00eancia nas fra\u00e7\u00f5es de produ\u00e7\u00e3o, exigem\n\ncorre\u00e7\u00f5es do usu\u00e1rio.\n\nPor fim os dados s\u00e3o submetidos ao servidor. \u00c9 poss\u00edvel escolher se a resposta deve ser enviada\n\npara a caixa de correio eletr\u00f4nico do usu\u00e1rio, ou apenas poder\u00e1 ser consultada pelo sistema. Ent\u00e3o \u00e9\n\naberto um di\u00e1logo com o usu\u00e1rio informando a solu\u00e7\u00e3o \u00f3tima para sua inst\u00e2ncia (Figura 5.8).\n\n5.4 Sum\u00e1rio\n\nNeste cap\u00edtulo apresentamos a ferramenta desenvolvida para o c\u00f4mputo das taxas \u00f3timas de inje-\n\n\u00e7\u00e3o de g\u00e1s em um campo operando por gas-lift. Adotamos uma estrutura cliente-servidor que permite\n\n\n\n5. Interface de otimiza\u00e7\u00e3o 82\n\nque o usu\u00e1rio caracterize localmente o problema, e que seja resolvido em uma m\u00e1quina espec\u00edfica\n\npara este fim. O ambiente de especifica\u00e7\u00e3o do problema permite que o usu\u00e1rio desenhe um esquema\n\ndo campo de petr\u00f3leo que est\u00e1 tratando, e descreva cada um de seus componentes, permitindo inclu-\n\nsive adicionar caracter\u00edsticas que possam ser utilizadas em outros algoritmos de otimiza\u00e7\u00e3o. Permite\n\ntamb\u00e9m que a partir do pr\u00f3prio ambiente, solicite que o servidor obtenha as taxas \u00f3timas de g\u00e1s de\n\ninje\u00e7\u00e3o.\n\nO servidor foi desenvolvido em duas partes: um gerenciador de inst\u00e2ncias, que efetivamente\n\nrealiza as chamadas dos algoritmos de otimiza\u00e7\u00e3o; e uma interface que permite que o gerenciador\n\nseja acessado de maneira segura e amig\u00e1vel. Por fim, apresentamos um estudo de caso, em que\n\nmostramos passo a passo como utilizar o sistema para obter uma resposta \u00f3tima para um campo de\n\npetr\u00f3leo simulado.\n\n\n\nCap\u00edtulo 6\n\nConclus\u00f5es e trabalhos futuros\n\nA atual competi\u00e7\u00e3o no mercado do petr\u00f3leo e os altos custos envolvidos tornam qualquer ganho\n\nrelativo no lucro de extra\u00e7\u00e3o de hidrocarbonetos significativos. Neste contexto, a obten\u00e7\u00e3o de taxas\n\n\u00f3timas de inje\u00e7\u00e3o de g\u00e1s no processo de eleva\u00e7\u00e3o por gas-lift, que permitam maximizar o lucro da\n\nextra\u00e7\u00e3o assume um papel de destaque nestes campos de produ\u00e7\u00e3o. Apresentamos uma formula\u00e7\u00e3o\n\npara este problema baseada em programa\u00e7\u00e3o linear inteira mista com restri\u00e7\u00f5es de quantidade m\u00e1xima\n\nde g\u00e1s de inje\u00e7\u00e3o e preced\u00eancia de ativa\u00e7\u00e3o de po\u00e7os. Tamb\u00e9m foi implementada uma ferramenta para\n\nespecifica\u00e7\u00e3o e resolu\u00e7\u00e3o destes problemas.\n\nA programa\u00e7\u00e3o linear inteira mista \u00e9 uma ferramenta poderosa que permite o c\u00f4mputo de solu\u00e7\u00f5es\n\n\u00f3timas globais com vari\u00e1veis de decis\u00e3o inteiras em problemas que a fun\u00e7\u00e3o objetivo \u00e9 linear. Para\n\no problema da mochila as coberturas permitem buscar facetas para o poliedro de restri\u00e7\u00f5es. Se adi-\n\ncionarmos restri\u00e7\u00f5es de preced\u00eancia, temos as K-coberturas que permitem gerar desigualdades fortes\n\npara o poliedro. Caso a fun\u00e7\u00e3o objetivo n\u00e3o seja linear, \u00e9 poss\u00edvel lineariz\u00e1-la por partes adicionando\n\nvari\u00e1veis bin\u00e1rias de decis\u00e3o. O modelo proposto por Sherali [28] se mostrou muito melhor que os\n\noutros devido a sua simplicidade e caracter\u00edsticas poliedrais.\n\nA formula\u00e7\u00e3o do problema de aloca\u00e7\u00e3o \u00f3tima de g\u00e1s de inje\u00e7\u00e3o utilizando programa\u00e7\u00e3o linear\n\ninteira mista apresenta uma s\u00e9rie de vantagens: generaliza os modelos existentes tratando explici-\n\ntamente as decis\u00f5es de ativa\u00e7\u00e3o e desativa\u00e7\u00e3o dos po\u00e7os de petr\u00f3leo; permite a aplica\u00e7\u00e3o intensiva\n\nda teoria e ferramentas algor\u00edtmicas do dom\u00ednio da programa\u00e7\u00e3o inteira, que permitem a obten\u00e7\u00e3o\n\nde \u00f3timos globais e uma medida da qualidade de solu\u00e7\u00f5es aproximadas; o modelo pode ser facil-\n\nmente expandido para comportar outras restri\u00e7\u00f5es. Esta classe de problemas \u00e9 NP-Dif\u00edcil no sentido\n\nforte, ent\u00e3o \u00e9 importante a inser\u00e7\u00e3o de cortes para agilizar o processo de busca, principalmente em\n\ninst\u00e2ncias de grande porte.\n\nApresentamos uma formula\u00e7\u00e3o para obter desigualdades v\u00e1lidas para um subconjunto das vari\u00e1-\n\nveis de decis\u00e3o do problema, e um procedimento de lifting para expandir estas desigualdades para\n\ntodo o espa\u00e7o das vari\u00e1veis de decis\u00e3o. Este procedimento de lifting envolve a resolu\u00e7\u00e3o de uma\n\nseq\u00fc\u00eancia de problemas, t\u00e3o dif\u00edceis quanto resolver o pr\u00f3prio problema de aloca\u00e7\u00e3o de g\u00e1s. Ent\u00e3o\n\napresentamos um procedimento para o c\u00f4mputo de fatores aproximados de lifting. Experimentos\n\n\n\n6. Conclus\u00f5es e trabalhos futuros 84\n\ncomputacionais mostraram que estas desigualdades de coberturas podem reduzir o n\u00famero de itera-\n\n\u00e7\u00f5es e o tamanho da \u00e1rvore de Branch and Bound.\n\nCriamos uma ferramenta para especifica\u00e7\u00e3o e resolu\u00e7\u00e3o de problemas de aloca\u00e7\u00e3o de g\u00e1s de in-\n\nje\u00e7\u00e3o. Sua estrutura faz com que o c\u00f4mputo das taxas de inje\u00e7\u00e3o seja realizada em um computador\n\nespec\u00edfico, com capacidade de processamento suficiente para resolver o problema. O emprego desta\n\nferramenta permite que o operador do campo utilize a formula\u00e7\u00e3o desenvolvida sem necessariamente\n\nconhecer detalhes do modelo e do algoritmo de resolu\u00e7\u00e3o. Em um estudo de caso mostramos que s\u00e3o\n\ntratadas apenas caracter\u00edsticas que descrevem a opera\u00e7\u00e3o do campo, sendo que detalhes do funciona-\n\nmento do algoritmo s\u00e3o abstra\u00eddos do usu\u00e1rio.\n\nComo sugest\u00e3o para trabalhos futuros propomos que no algoritmo de Branch and Bound para\n\nresolu\u00e7\u00e3o do problema sejam gerados cortes em cada n\u00f3 da \u00e1rvore de busca, que pode agilizar o\n\nprocesso de resolu\u00e7\u00e3o, e sejam feitos estudos comparativos. No Ap\u00eandice B apresentamos uma for-\n\nmula\u00e7\u00e3o para o problema que leva em considera\u00e7\u00e3o a concavidade da curva de performance do po\u00e7o.\n\nPropomos que esta formula\u00e7\u00e3o seja explorada, inicialmente fazendo um comparativo dos ganhos na\n\ndiminui\u00e7\u00e3o do esfor\u00e7o computacional desta formula\u00e7\u00e3o, por reduzir o n\u00famero de vari\u00e1veis de deci-\n\ns\u00e3o, com a formula\u00e7\u00e3o Ppl (G). Em seguida, podem ser expandidos os conceitos de K-coberturas e\n\nlifting para esta formula\u00e7\u00e3o.\n\nNa interface de otimiza\u00e7\u00e3o, propomos que seja estudada uma forma mais direta de conex\u00e3o do\n\nambiente de especifica\u00e7\u00e3o do problema com o servidor, que permita o acompanhamento do c\u00e1lculo da\n\nsolu\u00e7\u00e3o. Tamb\u00e9m propomos uma amplia\u00e7\u00e3o do modelo para outros tipos de restri\u00e7\u00f5es, como perdas\n\nde cargas na tubula\u00e7\u00e3o, interfer\u00eancia entre po\u00e7os e acompanhamento da din\u00e2mica do reservat\u00f3rio.\n\n\n\nAp\u00eandice A\n\nFatores de lifting exatos para uma\n\nfloresta\n\nNesta se\u00e7\u00e3o apresentamos um algoritmo em programa\u00e7\u00e3o din\u00e2mica para o c\u00f4mputo dos fatores\n\nexatos de lifting caso o grafo de restri\u00e7\u00f5es de preced\u00eancia de ativa\u00e7\u00e3o seja uma floresta. Tomemos\n\ncomo refer\u00eancia a formula\u00e7\u00e3o K ?t apresentada em (4.10), da Se\u00e7\u00e3o 4.3.\n\nAs simplifica\u00e7\u00f5es sobre (4.10e) podem ser programadas sequencialmente por (4.10e)\u2013(4.10e)\n\npara reescrever o problema como:\n\nK ??t : ?t = ?t + Maximize ?n?At ?(n,k)?Bt,n an,k xn,k (A.1a)\nSujeito a ?\n\nn?At\n?\n\n(n,k)?Bt,n\n\nbn,k xn,k 6 b (A.1b)\n\n?\n(m,i)?Bt,m\n\nxm,i > ?\n(n, j)?Bt,n\n\nxn, j, ?(m, n) ? E(G?t ) (A.1c)\n\n?\n(n,k)?Bt,n\n\nxn,k 6 1,?n ? r(G?t ) (A.1d)\n\nxn,k ?{0, 1}, ?(n, k) ??n?At Bt,n (A.1e)\n\npara os conjuntos At ? Nt , Bt,n ? St,n e G?t = G[At ]; e o escalar ?t . Podemos assumir sem perda de\ngeneralidade que b e bn,k s\u00e3o inteiros. Existe uma solu\u00e7\u00e3o recursiva paraK\n\n??\nt se G?t \u00e9 uma floresta. Seja\n\nT = {n1, n2, . . . , nT} uma ordena\u00e7\u00e3o topol\u00f3gica de G?t . Para simplificar a nota\u00e7\u00e3o, tomemos Bn = Bt,n\n\n\n\nA. Fatores de lifting exatos para uma floresta 86\n\ne seja Rn os filhos de n em G?t , isto \u00e9, Rn = {m : (n, m) ? E(G?t )}. A recurs\u00e3o \u00e9:\n\nPy(n, q) :\n\nJy(n, q) = Maximize ?\n(n,k)?Bn\n\nan,k xn,k + J\ny(Rn, q? q?) (A.2a)\n\nSujeito a ?(n,k)?Bn xn,k = y (A.2b)\n?(n,k)?Bn bn,k xn,k 6 q? (A.2c)\nq? ?{0, . . . , q} (A.2d)\n\nxn,k ?{0, 1}, ?(n, k) ? Bn (A.2e)\n\nPy(R, q) :\n\nJy(R, q) = Maximize Jy?(n, q?) + Jy(R\\{n}, q? q?) (A.3a)\n\nSujeito a y? ?{0}?{y} (A.3b)\n\nq? ?{0, 1, . . . , q} (A.3c)\n\nn ? n?, ?n? ? R\\{n} de acordo com T (A.3d)\n\nonde a interpreta\u00e7\u00e3o dos problemas est\u00e1 a seguir.\n\nPy(n, q) \u00e9 a forma restrita de K ??t , para um t particular, incluindo o po\u00e7o n e seus sucessores em\n\nG?t , isto \u00e9, Sn = {m ?V (G?t ) : n ? m}, e tendo uma capacidade de compress\u00e3o de g\u00e1s de q unidades.\n\nAinda, o po\u00e7o n est\u00e1 ativado se y = 1 e desativado se y = 0. Jy(n, q) \u00e9 o valor da fun\u00e7\u00e3o objetivo de\n\numa solu\u00e7\u00e3o \u00f3tima para Py(n, q). Note que Py(n, q) \u00e9 sempre fact\u00edvel se y = 0. Se y = 1 e q unidades\n\ns\u00e3o insuficientes para ativar o po\u00e7o n, ent\u00e3o Py(n, q) \u00e9 infact\u00edvel e Jy(n, q) = ??. Note tamb\u00e9m que\nos sucessores de n, Sn, podem ser ativados apenas se o po\u00e7o n estiver ativo.\n\nPy(R, q) \u00e9 a forma restrita de K ??t , para um t particular, considerando apenas as \u00e1rvores com\n\nra\u00edzes nos elementos de R ? V (G?t ) onde (Sm ?{m})?(Sn ?{n}) = /0 para todos m, n ? R distintos,\ne possuindo apenas q unidades de capacidade de compress\u00e3o. Ainda, cada po\u00e7o n ? R deve estar\n\ninativo se y = 0, mas os po\u00e7os podem estar ativos ou inativos se y = 1. Jy(R, q) \u00e9 o valor de uma\n\nsolu\u00e7\u00e3o \u00f3tima para Py(R, q). Note que Py(R, q) \u00e9 sempre fact\u00edvel independente dos valores de y e q,\n\ngarantindo que Jy(R, q) > 0.\n\nAs recorr\u00eancias (A.2a)\u2013(A.2e) e (A.3a)\u2013(A.3d) levam o problema \u00e0 equival\u00eanciaK ??t ?P\n1(r(G?t ), b)\n\ne, portanto, ?t = ?t + J1(r(G?t ), b). Um algoritmo em programa\u00e7\u00e3o din\u00e2mica pode ser desenvolvido\na partir de uma execu\u00e7\u00e3o seq\u00fcencial destas recorr\u00eancias. A seguir, apresentamos uma vis\u00e3o geral do\n\nalgoritmo.\n\nSeja J y(n) = {Jy(n, q) : q = 0, . . . , b} um conjunto de solu\u00e7\u00f5es para Py(n, q) variando q, em que\n\nJ (n) = J 0(n)?J 1(n) \u00e9 o conjunto de todas as solu\u00e7\u00f5es. Seja J y(R) = {Jy(R, q) : q = 0, . . . , b} o\n\nconjunto de solu\u00e7\u00f5es para Py(R, q) variando q e y ?{0, 1}, onde R ? Rn para algum n ? V (G?t ) ou\n\nR ? r(G?t ). Ainda, seja J (R) = J\n0(R)?J 1(R) o conjunto de todas as solu\u00e7\u00f5es.\n\n\n\nA. Fatores de lifting exatos para uma floresta 87\n\nO algoritmo consiste em varrer os n\u00f3s de G?t em ordem reversa de T , isto \u00e9, das folhas da\n\nfloresta at\u00e9 as ra\u00edzes, computando J (n) em cada n\u00f3 n, sobre J (Rn,i) para i = j, j ?1, . . . , 1, onde\n\nRn,i = {r\nn\ni , . . . , r\n\nn\nj} e Rn = {r\n\nn\n1, . . . , r\n\nn\nj} \u00e9 o conjunto de filhos de n obtidos de acordo com a ordem\n\ntopol\u00f3gica T . Pode ser mostrado que este algoritmo \u00e9 executado em tempo ?(4|V |q2) e utiliza\n?(4|V|q) unidades de mem\u00f3ria para armazenar as tabelas.\n\n\n\nAp\u00eandice B\n\nModelo linear por partes considerando\n\nconcavidade\n\nPropomos aqui um modelo linear por partes para o problema de aloca\u00e7\u00e3o \u00f3tima de g\u00e1s de inje\u00e7\u00e3o\n\nque considera a concavidade das curvas. Segundo Sherali [28], se um conjunto de pontos formar uma\n\nregi\u00e3o c\u00f4ncava, \u00e9 necess\u00e1rio apenas uma vari\u00e1vel de decis\u00e3o bin\u00e1ria por regi\u00e3o.\n\nEsta formula\u00e7\u00e3o aproveita o fato que a curva de performance do po\u00e7o (CPP) ou \u00e9 c\u00f4ncava, ou\n\npode ser dividida em regi\u00f5es c\u00f4ncavas. Esta formula\u00e7\u00e3o n\u00e3o reduz a complexidade computacional da\n\nresolu\u00e7\u00e3o do problema. Entretanto, h\u00e1 uma redu\u00e7\u00e3o no n\u00famero de vari\u00e1veis de decis\u00e3o inteiras, que\n\npode levar a um n\u00famero menor de n\u00f3s no algoritmo de Branch and Bound ou de planos de corte, e\n\npor conseq\u00fc\u00eancia em uma redu\u00e7\u00e3o nos custos computacionais para obten\u00e7\u00e3o da resposta.\n\nPara formula\u00e7\u00e3o deste modelo utilizamos as defini\u00e7\u00f5es apresentadas no Cap\u00edtulo 4.\n\nDefini\u00e7\u00e3o B.1 Para um po\u00e7o n, um conjunto T n = {k : qn,k ? Qn} = {tn1 , . . . ,t\nn\n?n} de \u00edndices consecu-\n\ntivos de pontos representam uma regi\u00e3o c\u00f4ncava se para todos os \u00edndices a, b e c ? T n, a &lt;b &lt;c,\n\nvaler:\n\nq\nn,b\nout > (\n\nq\nn,c\nin ?q\n\nn,b\nin\n\nqn,cin ?q\nn,a\nin\n\n)qn,aout + (\nqn,bin ?q\n\nn,a\nin\n\nqn,cin ?q\nn,a\nin\n\n)qn,cout (B.1)\n\nUma regi\u00e3o c\u00f4ncava \u00e9 m\u00e1xima se T n?{tn1 ?1} e T\nn?{tn?n + 1} n\u00e3o representam uma regi\u00e3o c\u00f4ncava.\n\nDividimos Kn = {1, . . . , ?(n)}, que \u00e9 o conjunto dos \u00edndices de Qn, em \u00b5(n) conjuntos T nm que\nrepresentam regi\u00f5es c\u00f4ncavas, tal que:\n\n\u2022 ?\n\u00b5(n)\nm=1T\n\nn\nm = K\n\nn;\n\n\u2022 |T nm| > 2, m = 1, . . . , \u00b5(n);\n\n\u2022 tnm?1,?n = t\nn\nm,1, m = 2, . . . , \u00b5(n).\n\n\n\nB. Modelo linear por partes considerando concavidade 89\n\nSe os conjuntos T nm , m = 1, . . . , \u00b5(n), representarem regi\u00f5es c\u00f4ncavas m\u00e1ximas, a representa\u00e7\u00e3o \u00e9\n\n\u00f3tima no n\u00famero de vari\u00e1veis de decis\u00e3o.\n\nPconpl (G) : Maximize f =\nN\n\n?\nn=1\n\n\u00b5(n)\n\n?\nm=1\n\n?\nk?T nm\n\nf n,k ?nm,k (B.2a)\n\nSujeito a:\nN\n\n?\nn=1\n\nqnin 6 q\nmax\nin (B.2b)\n\n\u00b5(i)\n\n?\nm=1\n\nxim 6\n\u00b5( j)\n\n?\nm=1\n\nx jm ?( j, i) ? E(G) (B.2c)\n\n\u00b5(n)\n\n?\nk=1\n\nxnm 6 1 ?n ? R(G) (B.2d)\n\nqnin =\n\u00b5(n)\n\n?\nm=1\n\n?\nk?T nm\n\nqn,kin ?\nn\nm,k n = 1, . . . , N (B.2e)\n\n?\nk?T nm\n\n?nm,k = x\nn\nm ?(n, m) ? ? (B.2f)\n\n?nm,k > 0\n?(n, m) ? ?\n?k ? T nm\n\n(B.2g)\n\nxnm > 0 ?(n, m) ? ? (B.2h)\n\nxnm ? Z ?(n, m) ? ? (B.2i)\n\nonde ? = {(n, m) : n = 1, . . . , N e m = 1, . . . , \u00b5(n)}.\n\nSe cada conjunto de pontos T nm possuir cardinalidade |T\nn\n\nm| = 2, ent\u00e3o P\ncon\npl (G) pode ser reduzido a\n\nPpl(G). Isto \u00e9, se cada conjunto T\nn\n\nm possui dois pontos consecutivos que representam uma regi\u00e3o de\n\nPpl(G), ent\u00e3o P\ncon\npl (G) \u00e9 equivalente a Ppl(G).\n\nB.1 Exemplo ilustrativo\n\nConsidere que para um dado po\u00e7o n a CPP possui a configura\u00e7\u00e3o apresentada na Figura B.1.\n\nObserve que os pontos (1, 1), (2, 3) e (3, 2) formam uma regi\u00e3o c\u00f4ncava m\u00e1xima, e que os pontos\n\n(3, 2), (4, 3), (5, 3) e (6, 2) formam outra regi\u00e3o. Assim, assumimos \u00b5(n) = 2 regi\u00f5es c\u00f4ncavas, e\n\ntemos que T n1 = {1, 2, 3} e T\nn\n\n2 = {3, 4, 5, 6}. Note que T\nn\n\n1 ?T\nn\n\n2 = {1, 2, 3, 4, 5, 6} = K\nn.\n\nUtilizando esta formula\u00e7\u00e3o temos 8 vari\u00e1veis de decis\u00e3o reais (? e qnin) e 2 vari\u00e1veis inteiras\npara representar este po\u00e7o n. Se aplicarmos esta curva no modelo Ppl(G) teremos 11 vari\u00e1veis de\n\ndecis\u00e3o reais e 5 inteiras. Podemos observar uma redu\u00e7\u00e3o significativa nas vari\u00e1veis de decis\u00e3o,\n\nprincipalmente nas inteiras, que levam a uma redu\u00e7\u00e3o dos custos computacionais para resolu\u00e7\u00e3o do\n\nproblema.\n\nSe fizermos T n1 = {1, 2}, T\nn\n\n2 = {2, 3}, T\nn\n\n3 = {3, 4}, T\nn\n\n4 = {4, 5} e T\nn\n\n5 = {5, 6}, ser\u00e3o necess\u00e1rias\n\n11 vari\u00e1veis reais e 5 inteiras, que corresponde \u00e0 formula\u00e7\u00e3o Ppl (G) original.\n\n\n\nB. Modelo linear por partes considerando concavidade 90\n\n1\n\n1\n\n2\n\n2\n\n3\n\n3 4 5 6\n\nxn1 x\nn\n2\n\n?n1,1\n\n?n1,2\n\n?n1,3\n\n?n2,3\n\n?n2,4 ?\nn\n2,5\n\n?n2,6\n\nqnin\n\nqnout\n\nFigura B.1: Exemplo de CPP considerando concavidade nas vari\u00e1veis de decis\u00e3o.\n\n\n\nRefer\u00eancias Bibliogr\u00e1ficas\n\n[1] MCKIE, C. et al. Economic benefits from automated optimization of high pressure gas usage in an\n\noil productin system. In: SPE Production and Operation Symposium. Oklahoma City, Oklahoma:\n\n[s.n.], 2001. Paper SPE 67187.\n\n[2] THOMAS, J. Fundamentos de Engenharia de Petr\u00f3leo. [S.l.]: Editora Interci\u00eancia Ltda, 2001.\n\n[3] JAHN, F.; COOK, M.; GRAHAM, M. Hydrocarbon exploration and production. [S.l.]: Elsevier\n\nScience, 2003.\n\n[4] BUITRAGO, S.; RODR\u00cdGUEZ, E.; ESPIN, S. D. Global optimization techniques in gas allo-\n\ncation for continuous flow gas lift systems. In: Proc. SPE Gas Technology Conference. Calgary,\n\nCanada: [s.n.], 1996. p. 375\u2013379. Paper SPE 15616.\n\n[5] ECONOMIDES, M.; HILL, A.; EHLIG-ECONOMIDES, C. Petroleum Production Systems.\n\n[S.l.]: Prentice Hall, 1993.\n\n[6] KANU, E. P.; MACH., J. M.; BROWN, K. E. Economic approach to oil production and gas\n\nallocation in continuous gas lift. Journal of Petroleum Technology, p. 1887\u20131892, Outubro 1981.\n\n[7] MACH, J.; PROANO, E.; BROWN, K. E. A nodal approach for applying systems analysis to the\n\nflowing and artificial lift of oil or gas well. In: Society of Petroleum Engineers. [S.l.: s.n.], 1979.\n\nPaper SPE 8025.\n\n[8] ALARC\u00d3N, G.; TORRES, C.; G\u00d3MEZ, L. Global optimization of gas allocation to a group of\n\nwells in artificial lift using nonlinear constrained programming. ASME Journal of Energy Resour-\n\nces Technology, v. 124, p. 262\u2013268, Dezembro 2002.\n\n[9] NAKASHIMA, P.; CAMPONOGARA, E. Solving a gas-lift optimization problem by dynamic\n\nprogramming. IEEE Transactions on Systems, Man, and Cybernetics\u2014Part A, v. 36, n. 2, p. 407\u2013\n\n414, 2006.\n\n[10] GAREY, M.; JOHNSON, P. A Guide to Theory or NP-Completeness. New York, NY: W.H. Fre-\n\neman, 1979.\n\n[11] MAYHILL, T. D. Simplified method for gas-lift well problem identification and diagnosis. In:\n\nProc. SPE Annual Fall Meeting. Houston, Texas: [s.n.], 1974. Paper SPE 5151.\n\n\n\nRefer\u00eancias Bibliogr\u00e1ficas 92\n\n[12] REDDEN, J. D.; SHERMAN, T. A. G.; BLANN, J. R. Optimizing gas-lift systems. In: Proc.\n\nof the 49th Annual Fall Meeting of the Society of Petroleum Engineers of AIME. Houston, Texas:\n\n[s.n.], 1974. Paper SPE 5150.\n\n[13] NISHIKIORI, N. et al. An improved method for gas lift allocation optimization. In: Proc. SPE\n\nAnnual Technical Conference and Exhibition. San Antonio, TX: [s.n.], 1989. Paper SPE 19711.\n\n[14] NISHIKIORI, N. et al. An improved method for gas lift allocation optimization. ASME Journal\n\nof Energy Resources Technology, v. 117, p. 87\u201392, 1995.\n\n[15] FANG, W. Y.; LO, K. K. A generalized well-management scheme for reservoir simulation. SPE\n\nReservoir Engineering, v. 11, n. 2, p. 116\u2013120, May 1996.\n\n[16] WANG, P.; LITVAK, M.; AZIZ, K. Optimization of production operations in petroleum fields.\n\nIn: Proc. 17th World Petroleum Congress. Rio de Janeiro, Brazil: [s.n.], 2002.\n\n[17] CAMPONOGARA, E.; NAKASHIMA, P. H. R. Applying dynamic programming to a gas-lift\n\noptimization problem. In: Proc. 2nd Brazilian Congress on Research and Development in Oil and\n\nGas. Rio de Janeiro, Brazil: [s.n.], 2003.\n\n[18] WILLIAMS, H. Model Building in Mathematical Programming. 4. ed. New York, NY: John\n\nWiley &amp; Sons, 1999.\n\n[19] NAKASHIMA, P. Otimiza\u00e7\u00e3o de Processos de Produ\u00e7\u00e3o de Petr\u00f3leo via Inje\u00e7\u00e3o Cont\u00ednua de\n\nG\u00e1s. Tese (Doutorado) \u2014 Universidade Federal de Santa Catarina, Florian\u00f3polis, Maio 2004.\n\n[20] VANDERBEI, R. J. Linear Programming: Foundations and Extensions. Boston: Kluwer Aca-\n\ndemic Publishers, 1996. Dispon\u00edvel em:&lt;citeseer.ist.psu.edu/vanderbei96linear.html>.\n\n[21] WOLSEY, L. Integer Programming. New York, NY: Wiley-Interscience, 1998. (Wiley-\n\nInterscience series in discrete mathematics and optimization).\n\n[22] NEMHAUSER, G. L.; WOLSEY, L. A. Integer and Combinatorial Optimization. [S.l.]: John\n\nWiley &amp; Sons\u201e 1988.\n\n[23] WRIGHT, S. Primal-Dual Interior-Point Methods. Philadelphia, PA: Soc for Industrial &amp; Ap-\n\nplied Math, 1997.\n\n[24] BALAS, E.; ZEMEL, E. Facets of the knapsack polytope from minimal covers. SIAM Journal\n\non Applied Mathematics, v. 34, n. 1, p. 119\u2013148, 1978.\n\n[25] KAPARIS, K.; LETCHFORD, A. A cut-and-branch algorithm for the multidimensional knap-\n\nsack problem. Lancaster University. nov 2005.\n\n[26] BOYD, E. Polyhedral results for the precedence-constrained knalsack problem. Discrete Applied\n\nMathematics, v. 41, p. 185\u2013201, 1993.\n\n[27] PADBERG, M. Approximating separable nonlinear functions via mixed zero-one programs.\n\nOperations Research Letters, v. 27, p. 1\u20135, 2000.\n\n\n\nRefer\u00eancias Bibliogr\u00e1ficas 93\n\n[28] SHERALI, H. On mixed-integer zero-one representations for separable lower-semicontinuous\n\npiecewise-linear functions. Operations Research Letters, v. 28, p. 155\u2013160, 2001.\n\n[29] CONTO, A. de; CAMPONOGARA, E. Aloca\u00e7\u00e3o \u00d3tima de lift-gas: Modelos de lineariza\u00e7\u00e3o\n\npor partes. In: 3o\n\u00af\n\nCongresso Brasileiro de P&amp;D em Petr\u00f3leo e G\u00e1s. Salvador, BA: [s.n.], 2005.\n\n[30] CAMPONOGARA, E.; CONTO, A. de. Gas-lift allocation under precedence constraints:\n\nPiecewise-linear formulation and k-covers. In: Proc. of the 44th IEEE Conference on Decision\n\nand Control, and the European Control Conference 2005. Sevilha, Espanha: [s.n.], 2005. p. 4422\u2013\n\n4427.\n\n[31] ILOG INCORPORATED. ILOG CPLEX 9.0: Getting Started. Mountain View, CA, 2003.\n\n[32] STROUSTRUP, B. The C++ Programming Language. 3. ed. Reading: Addison-Wesley, 1997.\n\n[33] MEHLHORN, K.; NAHER, S. LEDA: A Platform for Combinatorial and Geometric Compu-\n\nting. [S.l.]: Cambridge University Press, 1999.\n\n[34] DEITEL, H.; DEITEL, P. Java How to Program. 6. ed. Upper Saddle River, NJ: Prentice-Hall,\n\n2004.\n\n[35] CAMPONOGARA, E.; NAKASHIMA, P. Optimal allocation of lift-gas rates under multiple fa-\n\ncility constraints: A mixed-integer linear programming approach. A ser publicado no Transactions\n\nof ASME, 2007.\n\n[36] MARTIN, R. UML Tutorial: Part 1 - Class Diagram. [S.l.]. Dispon\u00edvel em:\n\n<www.objectmentor.com/publications/umlClassDiagrams.pdf>.\n\n[37] FOWLER, M.; KOBRYN, C.; BOOCH, G. UML Essencial. 3. ed. Porto Alegre: Bookman,\n\n2005.\n\n[38] CORMEN, T. et al. Introduction to Algorithms. 2. ed. [S.l.]: MIT Press, 2001.\n\n[39] LEITHOLD, L. O C\u00e1lculo com Geometria Anal\u00edtica. 3. ed. S\u00e3o Paulo: Harbra, 1993.\n\n[40] DEITEL, A.; DEITEL, P.; NIETO, R. XML: Como Programar. 1. ed. Porto Alegre: Bookman,\n\n2003.\n\n[41] MITCHELL, M.; OLDHAM, J.; SAMUEL, A. Advanced Linux Programming. 1. ed. Indiana-\n\npolis, Indiana: New Riders, 2001.\n\n[42] OLIVEIRA, R.; CARISSIMI, A.; TOSCANI, S. Sistemas Operacionais. 3. ed. Porto Alegre:\n\nEditora Sagra-Luzzato, 2004.\n\n[43] TANENBAUM, A. Sistemas Operacionais Modernos. 2. ed. Upper Saddle River, NJ: Prentice-\n\nHall, 2003.\n\n[44] CASAD, J.; WILLSEY, B. Aprenda TCP/IP em 24 horas. 5. ed. S\u00e3o Paulo: Campus, 1999.\n\n[45] POSTEL, J. RFC 821 - Simple Mail Transfer Protocol. University of Southern California, 1982.\n\nDispon\u00edvel em:&lt;http://www.ietf.org/rfc/rfc0821.txt>.\n\n\n\nRefer\u00eancias Bibliogr\u00e1ficas 94\n\n[46] MYERS, J.; ROSE, M. RFC 1725 - Post Office Protocol - Version 3. Carnegie-Mellon Univer-\n\nsity, 1994. Dispon\u00edvel em:&lt;http://www.ietf.org/rfc/rfc1725.txt>.\n\n[47] SOARES, W. Programando em PHP: Conceitos e Aplica\u00e7\u00f5es. S\u00e3o Paulo: \u00c9rica, 2000.\n\n[48] HAROLD, E. Java Network Programming. 3. ed. Cambridge, Massachusetts: O\u2019Reilly Media,\n\n2004.\n\n[49] FIELDING, R. et al. RFC 2616 - Hypertext Transfer Protocol - HTTP/1.1. The Internet Society,\n\n1999. Dispon\u00edvel em:&lt;http://www.ietf.org/rfc/rfc2616.txt>."}]}}}