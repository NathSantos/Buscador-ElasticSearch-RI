{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.10985"}, {"@name": "filename", "#text": "16196_Dissertac%cc%a7a%cc%83o_Jorge_Dias.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "Imagem\t\n\t\n\n\t\n\nJorge\tManuel\tAlves\tDias\t\n\n\t\n\n\t\n\n\t\n\nAlgoritmos\tpara\to\tCarregamento\tCoordenado\tde\tVe\u00edculos\t\n\nEl\u00e9tricos\tpara\ta\tIntegra\u00e7\u00e3o\tem\tLarga\tEscala\tde\tEnergias\t\n\nRenov\u00e1veis\t\n\t\n\n\t\n\n\t\nDisserta\u00e7\u00e3o\tde\tmestrado\tem\tEngenharia\tEletrot\u00e9cnica\te\tde\tComputadores\t\n\n\t\n\nfevereiro\tde\t2017 \n\n\t\n\t\n\n\t\n\n\t\n\n\t\n\n\t\n\n\t\n\n\t\n\n\t\n\n\t\n\n\t \t\n\nJorge\tManuel\tAlves\tDias\t\n\n\t\n\nAlgoritmos\tpara\to\tCarregamento\tCoordenado\tde\t\t\n\nVe\u00edculos\tEl\u00e9tricos\tpara\ta\tIntegra\u00e7\u00e3o\tem\t\t\n\nLarga\tEscala\tde\tEnergias\tRenov\u00e1veis\t\nDisserta\u00e7\u00e3o\tde\tMestrado\tem\tEngenharia\tEletrot\u00e9cnica\te\tde\tComputadores\t\n\n\t\n\nsetembro\tde\t2017\t \n\t\n\n\t\n\t\n\n\t\n\n\t\n\n\t\n\n\t\n\n\t\n\n\t\n\n\t\n\n\t\n\n\t\n\n\t\n\n\t\n\n\t\n\n\t\n\n\t\n\n\t\n\n\t\n\n\t\n\n\n\n  \n\n\t\n\n\n\n \n\n \n \n\nDepartamento de Engenharia Eletrot\u00e9cnica e de Computadores  \n\nFaculdade de Ci\u00eancias e Tecnologia \n\n Universidade de Coimbra \n\n \n\nDisserta\u00e7\u00e3o de Mestrado em Engenharia Eletrot\u00e9cnica e de Computadores \n\n \n\nAlgoritmos para o Carregamento Coordenado de \nVe\u00edculos El\u00e9tricos para a Integra\u00e7\u00e3o em Larga \n\nEscala de Energias Renov\u00e1veis  \n\nJorge Manuel Alves Dias \n\n \n\nDesenvolvido com a Supervis\u00e3o de Professor Doutor \n\n Pedro Manuel Soares Moura \n\nJ\u00fari?\n\nPresidente: Professor Doutor Carlos Alberto Henggeler de Carvalho Antunes \n\nVogal: Professor Doutor Paulo Jos\u00e9 Gameiro Pereirinha \n\nOrientador: Professor Doutor Pedro Manuel Soares Moura \n\n \n\nsetembro de 2017 \n\n\n\n \n\n  \n\n\n\n \n\n \n\nAgradecimentos \n\nAgrade\u00e7o de uma forma muito especial ao Prof. Doutor Pedro Moura pela \n\npaci\u00eancia e disponibilidade empreendida nesta disserta\u00e7\u00e3o. As suas contribui\u00e7\u00f5es foram \n\nvaliosas e fundamentais neste trabalho. Foi um privilegio desenvolver esta disserta\u00e7\u00e3o \n\nsobre a sua orienta\u00e7\u00e3o.  \n\nAos meus amigos que comigo percorram este longo percurso acad\u00e9mico, com os \n\nquais partilhei muitos momentos de alegria e experi\u00eancias acad\u00e9micas inesquec\u00edveis. Aos \n\namigos de inf\u00e2ncia e \u00e0queles que mesmo espalhados pelo mundo ajudaram-me sem o \n\naperceberem.  \n\nUm agradecimento especial \u00e0 minha namorada, por todo o amor, aten\u00e7\u00e3o e \n\ncarinho proporcionado nos bons e maus momentos.  \n\nPor ultimo e de maior import\u00e2ncia agrade\u00e7o \u00e0 minha fam\u00edlia que sempre me \n\napoiaram e me deram o sentimento mais importante, amor.  Sem eles n\u00e3o teria sido \n\nposs\u00edvel chegar a esta etapa. A motiva\u00e7\u00e3o e suporte prestados foram essenciais ao longo \n\nde toda a minha vida. \n\nA todos o meu sincero e profundo agradecimento.  \n\n  \n\n\n\n \n\n \n\n \n\n  \n\n\n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nA todos os que me educaram \n\n  \n\n\n\n \n\n \n\n  \n\n\n\n \n\nResumo \nDesde o in\u00edcio da mobilidade pessoal que os ve\u00edculos el\u00e9tricos estiveram presentes, mas os seus \n\nrivais movidos a combust\u00edveis f\u00f3sseis tinham um desempenho superior e eram mais baratos. Contudo, \n\natualmente o cen\u00e1rio j\u00e1 se come\u00e7a a inverter devido \u00e0 instabilidade de pre\u00e7os do petr\u00f3leo, polui\u00e7\u00e3o e \n\nincentivos na compra de ve\u00edculos el\u00e9tricos.  \n\nA mobilidade \u00e9 uma \u00e1rea que requer grandes quantidades de energia. Nos ve\u00edculos tradicionais \n\n\u00e9 f\u00e1cil armazenar e transportar o combust\u00edvel, mas nos ve\u00edculos el\u00e9tricos, a energia tem de ser \n\ntransportada em redes que, na maioria, n\u00e3o foram pensadas para suportar grandes cargas como um \n\ngrande aglomerado de ve\u00edculos el\u00e9tricos a carregar. Assim, caso n\u00e3o exista uma coordena\u00e7\u00e3o de \n\ncarregamentos podem ocorrer picos de procura de energia imprevistos levando \u00e0 falha da rede. \n\nOutro aliado no combate \u00e0 polui\u00e7\u00e3o \u00e9 a aposta na produ\u00e7\u00e3o de energias renov\u00e1veis, com as \n\nquais se consegue reduzir a emiss\u00e3o de gases de efeito estufa, mas a sua produ\u00e7\u00e3o \u00e9 intermitente e \n\nvari\u00e1vel. Este problema leva \u00e0 necessidade de grandes capacidades de produ\u00e7\u00e3o o que origina, por \n\nvezes, excesso de gera\u00e7\u00e3o renov\u00e1vel face ao consumo.  \n\nNeste trabalho ir\u00e3o ser desenvolvidos algoritmos para mitigar os dois problemas anteriores: \n\ncarregamento em massa de ve\u00edculos el\u00e9tricos e excesso de gera\u00e7\u00e3o renov\u00e1vel. Como tal, ir\u00e3o ser \n\ndesenvolvidos algoritmos com o objetivo de absorver excesso de gera\u00e7\u00e3o renov\u00e1vel, reduzir os custos \n\nassociados ao carregamento de ve\u00edculos el\u00e9tricos e otimizar o diagrama de carga nacional. \n\nOs algoritmos ir\u00e3o agendar os carregamentos para per\u00edodos onde haja um maior excesso ou \n\npercentagem de gera\u00e7\u00e3o renov\u00e1vel. Fazendo isto, espera-se evitar problemas de picos de procura na \n\nrede uma vez que o algoritmo distribui racionalmente os hor\u00e1rios de carregamento, proporcionando \n\nassim uma maior integra\u00e7\u00e3o de ve\u00edculos el\u00e9tricos, possibilitando o crescimento desta \u00e1rea. \n\nAdicionalmente, ir\u00e1 tamb\u00e9m ser simulado um algoritmo que ir\u00e1 agendar os carregamentos em fun\u00e7\u00e3o \n\ndo pre\u00e7o da energia e n\u00e3o no seu excesso. Geralmente, o excesso de energia ocorre sempre que a \n\nprocura \u00e9 baixa, o que leva \u00e0 diminui\u00e7\u00e3o dos custos da energia. Ao carregar os ve\u00edculos nesses \n\nper\u00edodos o seu custo ser\u00e1 reduzido obtendo assim vantagens n\u00e3o s\u00f3 para as redes el\u00e9tricas como \n\ntamb\u00e9m para os utilizadores de ve\u00edculos el\u00e9tricos.  \n\nCom as simula\u00e7\u00f5es efetuadas pode-se concluir que usando o algoritmo em fun\u00e7\u00e3o do excesso \n\nde energia, consegue-se aproveitar o excesso de gera\u00e7\u00e3o renov\u00e1vel, reduzir os custos associados ao \n\ncarregamento e suavizar o diagrama de carga. Usando o algoritmo em fun\u00e7\u00e3o do pre\u00e7o de energia j\u00e1 \n\ns\u00f3 se verifica a redu\u00e7\u00e3o dos custos. \n\n \n\nPalavras Chave: Ve\u00edculo El\u00e9trico, Carregamento, Otimiza\u00e7\u00e3o, Algoritmos, Energias Renov\u00e1veis \t  \n\n\n\n \n\n  \n\n\n\n \n\nAbstract \nSince the beginning of personal mobility, electric vehicles have been present, but their fossil \n\nfuel powered rivals had better performance and lower cost. However, nowadays this scenario is \n\nstarting to change due to the instability of oil prices, pollution and incentives for the purchase of \n\nelectric vehicles. \n\nMobility is an area that requires large quantity of energy. In traditional vehicles it is easy to \n\nstore and transport fuel, but, in electric vehicles, energy has to be transported in networks that were \n\nnot designed to withstand heavy loads, such as the required for a large fleet of electric vehicles. Thus, \n\nif there is no coordination of the charging process, unforeseen power demand peaks can lead to grid \n\nfailures. \n\nAnother ally in the fight against pollution is the commitment in renewable energy generation, \n\nwhich can reduce the emission of greenhouse gases, but its generation profile is intermittent and \n\nvariable. This problem leads to a need for large generation capacities, which sometimes leads to a \n\nsurplus of generation relatively to the consumption. \n\nIn this work, algorithms to mitigate the two previous problems will be developed: large scale \n\ncharging of electric vehicles and renewable generation surplus. Therefore, the goal of these \n\nalgorithms is to absorb the renewable generation surplus, reduce charging costs of electric vehicles \n\nand optimize the national load diagram. \n\nThe algorithms will reschedule the charging for the periods with larger percentage of renewable \n\ngeneration. By doing this, it is expected to avoid problems of demand peaks, since the algorithm \n\nrationally distributes the charging periods, ensuring a good integration of electric vehicles, enabling \n\nthe growth of this area. In addition, an algorithm that schedules the charging based on the energy \n\nprice and not on the generation surplus, will also be simulated. Generally, the generation surplus \n\nenergy occurs whenever demand is low which leads to a decrease in energy prices. By charging the \n\nvehicles in such periods the cost will be reduced obtaining advantages not only for the electrical grid, \n\nbut also for the users.  \n\nWith this work, it can be concluded that by using intelligent charging it is possible to take \n\nadvantage of the renewable generation surplus, reduce the costs associated with charging and smooth \n\nthe load diagram. By using the algorithm as a function of the energy price, there is only a reduction \n\nof costs. \n\n \n\nKey\twords: Electric\tVehicle,\tCharging,\tOptimization,\tAlgorithms,\tRenewable\tEnergies\t\n\n\t\n\n\n\n \n\n  \n\n\n\n i \n\n\u00cdndice \n \n\nLista\tde\tFiguras\t.........................................................................................................\tiii\t\n\nLista\tde\tTabelas\t........................................................................................................\tiv\t\n\nLista\tde\tAcr\u00f3nimos\t....................................................................................................\tv\t\n\n1\t Introdu\u00e7\u00e3o\t.........................................................................................................\t1\t\n\n1.1\t Enquadramento\t....................................................................................................\t1\t\n\n1.2\t Motiva\u00e7\u00e3o\t.............................................................................................................\t1\t\n\n1.3\t Objetivos\t..............................................................................................................\t2\t\n\n1.4\t Estrutura\tda\tDisserta\u00e7\u00e3o\t.......................................................................................\t3\t\n\n2\t Mobilidade\tEl\u00e9trica\t............................................................................................\t4\t\n\n2.1\t Tipos\tde\tVe\u00edculos\tEl\u00e9tricos\t....................................................................................\t4\t\n\n2.2\t El\u00e9trico\tvs.\tCombust\u00e3o\t..........................................................................................\t5\t\n\n2.3\t Motores\te\tBaterias\t................................................................................................\t6\t\n\n2.4\t Carregamento\tde\tum\tVe\u00edculo\tEl\u00e9trico\t...................................................................\t6\t\n\n2.5\t Impacto\tdos\tVe\u00edculos\tEl\u00e9tricos\t..............................................................................\t8\t\n\n2.5.1\t Impacto\tdos\tVEs\tnas\tredes\tde\tenergia\tel\u00e9trica\t......................................................\t9\t\n\n2.5.1.1\t Aumento\tdo\tpico\tde\tprocura\t......................................................................................\t9\t\n2.5.1.2\t Recurso\tde\tresposta\t\u00e0\tprocura\te\tarmazenamento\tde\tenergia\t...................................\t9\t\n2.5.1.3\t Qualidade\tda\tenergia\t................................................................................................\t10\t\n\n2.5.2\t Impacto\tambiental\tdos\tVEs\t..................................................................................\t12\t\n\n2.5.3\t Impacto\tecon\u00f3mico\tdos\tVEs\t.................................................................................\t13\t\n\n3\t Carregamento\tCoordenado\tde\tVe\u00edculos\tEl\u00e9tricos\t.............................................\t14\t\n\n3.1\t Controlo\tde\tcarregamento\tlocal\t..........................................................................\t15\t\n\n3.2\t Controlo\tde\tcarregamento\titerativo\t....................................................................\t15\t\n\n3.3\t Controlo\tde\tcarregamento\tcentralizado\t..............................................................\t16\t\n\n3.4\t Sistema\tMulti-Agente\t.........................................................................................\t16\t\n\n3.5\t Compara\u00e7\u00e3o\tde\tcarregamentos\tinteligentes\t........................................................\t17\t\n\n4\t Problema\t.........................................................................................................\t20\t\n\n4.1\t Excesso\tde\tprodu\u00e7\u00e3o\tde\tenergia\t..........................................................................\t20\t\n\n4.2\t Exporta\u00e7\u00e3o\te\tarmazenamento\t.............................................................................\t20\t\n\n\n\n ii \n\n4.3\t Ve\u00edculos\tel\u00e9tricos\tcomo\tcomplemento\t................................................................\t22\t\n\n5\t Descri\u00e7\u00e3o\tdo\tAlgoritmo\t....................................................................................\t24\t\n\n5.1\t Objetivos\t............................................................................................................\t24\t\n\n5.2\t Dados\tnecess\u00e1rios\t...............................................................................................\t25\t\n\n5.2.1\t Previs\u00e3o\tda\tprodu\u00e7\u00e3o\te\tconsumo\tenergia\t............................................................\t25\t\n\n5.2.2\t Pre\u00e7o\tda\tenergia\t...................................................................................................\t25\t\n\n5.2.3\t Estado\tdo\tVE\t.........................................................................................................\t26\t\n\n5.3\t Equipamentos\tnecess\u00e1rios\t..................................................................................\t27\t\n\n5.3.1\t Sistema\tde\tControlo\tAuxiliar\t................................................................................\t27\t\n\n5.3.2\t Sistema\tde\tControlo\tCentral\t.................................................................................\t28\t\n\n5.4\t Funcionamento\tdo\talgoritmo\t..............................................................................\t28\t\n\n5.4.1\t Entrada\tde\tdados\t..................................................................................................\t30\t\n\n5.4.2\t Agendamento\t.......................................................................................................\t31\t\n\n6\t Testes\te\tresultados\t..........................................................................................\t35\t\n\n6.1\t Dados\tnecess\u00e1rios\t...............................................................................................\t35\t\n\n6.2\t Simula\u00e7\u00e3o\tde\tinverno\t..........................................................................................\t38\t\n\n6.3\t Simula\u00e7\u00e3o\tde\tver\u00e3o\t.............................................................................................\t41\t\n\n7\t Conclus\u00f5es\te\ttrabalho\tfuturo\t...........................................................................\t46\t\n\n7.1\t Conclus\u00f5es\t..........................................................................................................\t46\t\n\n7.2\t Trabalho\tFuturo\t..................................................................................................\t49\t\n\nRefer\u00eancias\t.............................................................................................................\t51\t\n\n8\t Anexo\tA\t-\tAlgoritmo.m\t.....................................................................................\t57\t\n\n9\t Anexo\tB\t-\tPrevisao.m\t.......................................................................................\t64\t\n\n10\t Anexo\tC\t-\tListaVE.m\t.....................................................................................\t72\t\n\n11\t Anexo\tD\t-\tTempo.m\t.....................................................................................\t75\t\n\n12\t Anexo\tE\t\u2013\tErro.m\t..........................................................................................\t76\t\n\n13\t Anexo\tF\t-\tJanela.m\t.......................................................................................\t77\t\n\n14\t Anexo\tG\t-\tPlots.m\t.........................................................................................\t78\t\n\n15\t Anexo\tH\t\u2013\tPlotsComparativos.m\t..................................................................\t80\t\n\n16\t Anexo\tH\t\u2013\tLista\tVE\tfinal\t................................................................................\t82\t\n\n\n\n iii \n\n\t\n\nLista de Figuras \n\nFigura 1 - Classifica\u00e7\u00e3o dos impactos dos VEs ................................................................ 8\t\n\nFigura 2 \u2013 Impactos dos VEs nas redes de energia el\u00e9trica .............................................. 9\t\n\nFigura 3 \u2013 Impacto de emiss\u00f5es de um Nissan Leaf por km para diferentes modos de \n\ncondu\u00e7\u00e3o [38] .......................................................................................................... 13\t\n\nFigura 4 - Exemplo das arquiteturas dos algoritmos: (a) carregamento descontrolado, (b) \n\ncontrolo local, (c) controlo iterativo/centralizado ................................................... 16\t\n\nFigura 5 - Compara\u00e7\u00e3o do impacto dos diferentes m\u00e9todos de carregamento no diagrama \n\nde carga [49] ........................................................................................................... 17\t\n\nFigura 6 \u2013 Complementaridade H\u00eddrica [57] .................................................................. 21\t\n\nFigura 7 - Diagrama de consumo total para o dia 2 de janeiro de 2017 (Fonte REN) ... 22\t\n\nFigura 8 - Diagramas de energia dos dias 2 e 3 de fevereiro de 2017 ............................ 25\t\n\nFigura 9 - Fluxograma do SCA ....................................................................................... 29\t\n\nFigura 10 - Fluxograma do SCC ..................................................................................... 30\t\n\nFigura 11 \u2013 Informa\u00e7\u00e3o mostrada na janela de comandos do Matlab ............................ 33\t\n\nFigura 12 - Primeira e \u00faltima viagem ............................................................................. 37\t\n\nFigura 13 - Viagens de e para casa ................................................................................. 37\t\n\nFigura 14 - Simula\u00e7\u00e3o de inverno (2 e 3 de fevereiro de 2017) com pre\u00e7os MIBEL ..... 38\t\n\nFigura 15 - Simula\u00e7\u00e3o de inverno (2 e 3 de fevereiro de 2017) com pre\u00e7os Bi-hor\u00e1rio 39\t\n\nFigura 16 - Diagramas de energia dos dias 9 e 10 de agosto de 2016 (sem utiliza\u00e7\u00e3o do \n\nfator de redu\u00e7\u00e3o de 10 mil vezes) ........................................................................... 42\t\n\nFigura 17 - Simula\u00e7\u00e3o de ver\u00e3o (9 e 10 de agosto de 2016) com pre\u00e7os MIBEL .......... 42\t\n\nFigura 18 - Simula\u00e7\u00e3o de ver\u00e3o (9 e 10 de agosto de 2016) com pre\u00e7os Bi-hor\u00e1rio ...... 43\t\n\nFigura 19 - Diagramas de carga nos dias 2 e 3 de fevereiro de 2017 (consumo geral \n\nreduzido em 10 mil vezes) ...................................................................................... 48\t\n\nFigura 20 - Diagramas de carga nos dias 9 e 10 de agosto de 2016(consumo geral reduzido \n\nem 10 mil vezes) ..................................................................................................... 48\t\n\n \n\n  \n\n\n\n iv \n\nLista de Tabelas \n\n \n\nTabela 1 - \u2013 Limites de emiss\u00f5es de CO2 e vendas necess\u00e1rias para cumprir as metas de \n\nemiss\u00f5es em 2020 [12] .............................................................................................. 6\t\n\nTabela 2 \u2013 Dados necess\u00e1rios ao algoritmo .................................................................... 28\t\n\nTabela 3 - Vendas de VEs em Portugal [67] ................................................................... 36\t\n\nTabela 4 - Modelos de VE mais vendidos em Portugal [67] .......................................... 36\t\n\nTabela 5 - Resultados das simula\u00e7\u00f5es para os dias 2 e 3 de fevereiro de 2017 .............. 39\t\n\nTabela 6 - Resultados das simula\u00e7\u00f5es para os dias 9 e 10 de agosto de 2016 ................ 44\t\n\nTabela 7 - Compara\u00e7\u00e3o da redu\u00e7\u00e3o de custos ................................................................. 44\t\n\nTabela 8 - Comparativo do uso do excesso de renov\u00e1vel por cada algoritmo ................ 45\t\n\nTabela 9 - Resultados finais do algoritmo em fun\u00e7\u00e3o do excesso de renov\u00e1vel ............. 47\t\n\n \n\n \n\n  \n\n\n\n v \n\nLista de Acr\u00f3nimos \n\n  \n\nACAP  Associa\u00e7\u00e3o do Com\u00e9rcio Autom\u00f3vel de Portugal \n\nCCC Controlo de Carregamento Centralizado \n\nCCL Controlo de Carregamento Local \n\nERSE Entidade Reguladora do Sector Energ\u00e9tico \n\nEU Uni\u00e3o Europeia \n\nGEE Gases de Efeito Estufa \n\nMAS Multi Agent System \n\nMIBEL Mercado Ib\u00e9rico de Eletricidade \n\nMCI Motor de Combust\u00e3o Interna \n\nSEE Sistema de Energia El\u00e9trica \n\nSCA Sistema de Controlo Auxiliar \n\nSCC Sistema de Controlo Central \n\nSOC State of Charge \n\nUVE Associa\u00e7\u00e3o de Utilizadores de Ve\u00edculos El\u00e9tricos \n\nVE(s) Ve\u00edculo(s) El\u00e9trico(s) \n\n \n\n  \n\n\n\n vi \n\n \n\n  \n\n\n\n 1 \n\n\t\n\n1 Introdu\u00e7\u00e3o \n\n1.1 Enquadramento \nA sociedade moderna est\u00e1 dependente da energia el\u00e9trica. \u00c9 uma componente essencial do \n\nnosso estilo de vida e um fator determinante da economia e sustentabilidade do Mundo. \n\nCada vez h\u00e1 mais incentivos para a utiliza\u00e7\u00e3o de transportes p\u00fablicos, mas, na verdade, h\u00e1 \n\numa tend\u00eancia para a utiliza\u00e7\u00e3o de um ve\u00edculo pessoal. Como tal, \u00e9 necess\u00e1rio tirar partido deste \n\naspeto negativo e torn\u00e1-lo apelativo eletrificando a mobilidade e reduzindo a liberta\u00e7\u00e3o de gases \n\nde efeito estufa (GEE). \u00c9 sabido que os combust\u00edveis f\u00f3sseis est\u00e3o no cerne de grandes problemas \n\nambientais e altera\u00e7\u00f5es clim\u00e1ticas e s\u00e3o estes aspetos que t\u00eam suscitado uma aposta na produ\u00e7\u00e3o \n\nde energia el\u00e9trica com base em fontes de energia renov\u00e1veis, em detrimento de fontes que \n\npromovam a emiss\u00e3o de GEE.  \n\nNeste sentido, a Uni\u00e3o Europeia (UE) possui objetivos ambiciosos, uma vez que pretende que \n\nem 2030, 27% da energia total produzida seja proveniente de fontes renov\u00e1veis e que haja uma \n\nredu\u00e7\u00e3o em cerca de 40% (em rela\u00e7\u00e3o a 1990) n\u00e3o s\u00f3 da emiss\u00e3o de GEE, mas tamb\u00e9m do consumo \n\nde energia em geral, atrav\u00e9s de medidas de efici\u00eancia energ\u00e9tica. \n\nOutro fator importante que encoraja a mudan\u00e7a para a mobilidade el\u00e9trica \u00e9 o pre\u00e7o dos \n\ncombust\u00edveis f\u00f3sseis. O pre\u00e7o dos combust\u00edveis f\u00f3sseis \u00e9 proporcional ao pre\u00e7o do crude. No \n\nentanto h\u00e1 outra vari\u00e1vel que s\u00e3o as taxas politico econ\u00f3micas que, neste momento, em Portugal, \n\ns\u00e3o verdadeiramente elevadas. Em 2011, o barril de petr\u00f3leo custava mais do dobro do que \n\natualmente, no entanto, os pre\u00e7os dos combust\u00edveis eram id\u00eanticos aos que podemos encontrar \n\nhoje num posto fazendo com que os consumidores contenham as suas desloca\u00e7\u00f5es e pensem duas \n\nvezes no tipo de ve\u00edculo que pretendem adquirir. Antes de 2000 havia uma tend\u00eancia para ve\u00edculos \n\nmovidos a gasolina que rapidamente se alterou para gas\u00f3leo. Na atualidade, os compradores j\u00e1 t\u00eam \n\numa terceira alternativa \u00e0 altura dos rivais, o ve\u00edculo el\u00e9trico (VE). \n\n  \n\n1.2 Motiva\u00e7\u00e3o \nPor melhor que seja a decis\u00e3o de adotar os VEs como solu\u00e7\u00e3o a v\u00e1rios problemas da sociedade \n\ne aumentar a utiliza\u00e7\u00e3o de energias renov\u00e1veis, podem existir tamb\u00e9m inconvenientes.  \n\nAs energias renov\u00e1veis s\u00e3o maioritariamente incontrol\u00e1veis. Podem-se prever com alguma \n\nexatid\u00e3o, mas n\u00e3o h\u00e1 a possibilidade de controlar o n\u00edvel de produ\u00e7\u00e3o, que depende exclusivamente \n\ndas condi\u00e7\u00f5es climat\u00e9ricas. Portugal, durante o per\u00edodo noturno, costuma ter m\u00ednimos de consumo \n\nno diagrama de carga nacional abaixo de 3000 MW, o que \u00e9 aproximadamente 5 vezes inferior ao \n\n\n\n 2 \n\ntotal da capacidade instalada das principais de energias renov\u00e1veis que podem funcionar \u00e0 noite \n\n(e\u00f3lica e h\u00eddrica). Esta capacidade instalada \u00e9 necess\u00e1ria durante o dia, mas, durante a noite h\u00e1 \n\ndiversas situa\u00e7\u00f5es em que satisfaz totalmente a procura e at\u00e9 excedendo-a em algumas horas de \n\nmaior abund\u00e2ncia de energias renov\u00e1veis.  \n\nEm termos de massifica\u00e7\u00e3o da utiliza\u00e7\u00e3o dos VEs, o problema que se coloca \u00e9 a cria\u00e7\u00e3o de \n\numa nova ponta de procura no diagrama de carga. A generalidade dos utilizadores carrega o seu \n\nve\u00edculo ap\u00f3s o per\u00edodo laboral, no inicio da noite ao chegar a casa. Como a penetra\u00e7\u00e3o de VEs \n\nainda \u00e9 baixa o impacto atual \u00e9 insignificante. Nos anos que se seguem, com o aumento das \n\nunidades vendidas e com a crescente tend\u00eancia para cargas r\u00e1pidas nos primeiros instantes de \n\ncarregamento, os VEs podem conduzir a complicados problemas na gest\u00e3o das redes causando um \n\ngrande desequil\u00edbrio nos sistemas de energia el\u00e9trica (SEE). \n\nAtualmente, de maneira a estimular o equil\u00edbrio do diagrama de carga, \u00e9 utilizado um conjunto \n\nde tarifas de venda de energia a diferentes pre\u00e7os sendo mais baixo nos per\u00edodos noturnos ou ao \n\nfim-de-semana e mais elevado nos restantes per\u00edodos, quando comparado com uma tarifa simples \n\nem que o pre\u00e7o \u00e9 mantido constante. Estas medidas encorajam os consumidores a alterar os seus \n\nh\u00e1bitos de utiliza\u00e7\u00e3o de certos equipamentos como por exemplo usar a m\u00e1quina de lavar apenas \n\ndurante a noite quando a eletricidade \u00e9 mais barata. Ao fazer isto o utilizador contribui para a \n\nredu\u00e7\u00e3o do pico de procura e estabiliza\u00e7\u00e3o do diagrama de carga. \n\nEm contrapartida, esta a\u00e7\u00e3o implica uma gest\u00e3o eficiente por parte do utilizador o que por \n\nvezes pode ser complicada de gerir. Depender do consumidor para gerir o seu pr\u00f3prio consumo \n\npode funcionar durante um per\u00edodo inicial, em que est\u00e3o motivados pela novidade e poupan\u00e7as \n\nque podem alcan\u00e7ar, todavia, ap\u00f3s este per\u00edodo inicial, haver\u00e1 uma tend\u00eancia para voltar \u00e0 sua \n\n\u201czona de conforto\u201d e ceder aos antigos h\u00e1bitos [1]. \n\nUsando um sistema automatizado, que tenha em considera\u00e7\u00e3o as prefer\u00eancias do consumidor, \n\npara gerir o carregamento do VE \u00e9 uma melhor solu\u00e7\u00e3o que se adapta \u00e0s altera\u00e7\u00f5es da rede \n\npodendo at\u00e9 interromper o processo quando necess\u00e1rio [2][3]. Esta medida reduz a necessidade e \n\na utiliza\u00e7\u00e3o de centrais de produ\u00e7\u00e3o usadas nas horas de ponta contribuindo para a redu\u00e7\u00e3o da \n\nemiss\u00e3o de GEE uma vez que parte destas centrais s\u00e3o a g\u00e1s devido ao seu r\u00e1pido tempo de \n\natua\u00e7\u00e3o. Com o diagrama de carga equilibrado \u00e9 poss\u00edvel tamb\u00e9m aumentar a efici\u00eancia de todas \n\nas outras centrais pois estas podem passar a funcionar com um valor mais perto do nominal [4][5]. \n\n \n\n1.3 Objetivos \nNeste trabalho pretende-se desenvolver algoritmos para o controlo coordenado do \n\ncarregamento de frotas de VE. Tais algoritmos devem ser baseados na previs\u00e3o da gera\u00e7\u00e3o \n\n\n\n 3 \n\nrenov\u00e1vel e do consumo de forma a controlar o carregamento dos ve\u00edculos em fun\u00e7\u00e3o dos excessos \n\ne varia\u00e7\u00f5es da gera\u00e7\u00e3o renov\u00e1vel.  \n\nAssim, os objetivos desta disserta\u00e7\u00e3o s\u00e3o:  \n\n\u2022 Demonstrar que com o deslocamento do per\u00edodo hor\u00e1rio do carregamento de VEs \u00e9 \n\nposs\u00edvel absorver excesso de energia renov\u00e1vel; \n\n\u2022 Demonstrar que o deslocamento do per\u00edodo hor\u00e1rio do carregamento de um VEs pode \n\nassegurar uma redu\u00e7\u00e3o de custos ao utilizador; \n\n\u2022 Demonstrar que \u00e9 poss\u00edvel otimizar o diagrama de carga nacional deslocando o \n\ncarregamento de frotas de VEs de per\u00edodos de ponta para per\u00edodos com excedente de \n\nenergia renov\u00e1vel. \n\n \n\n1.4 Estrutura da Disserta\u00e7\u00e3o \nA presente disserta\u00e7\u00e3o encontra-se organizada em 7 cap\u00edtulos: \n\nO cap\u00edtulo 1 \u00e9 dedicado a uma introdu\u00e7\u00e3o ao tema seguido pelos problemas que enfrentamos \n\nna atualidade na \u00e1rea da mobilidade el\u00e9trica. \u00c9 tamb\u00e9m abordada a motiva\u00e7\u00e3o da elabora\u00e7\u00e3o desta \n\ndisserta\u00e7\u00e3o e os seus objetivos. \n\nO cap\u00edtulo 2 tem o intuito de dar continuidade \u00e0 introdu\u00e7\u00e3o com uma an\u00e1lise mais detalhada \n\nsobre ve\u00edculos el\u00e9tricos e aspetos relevantes a esta disserta\u00e7\u00e3o que gira em torno deles. Ser\u00e3o \n\ntamb\u00e9m debatidos os problemas relacionados com carregamento em massa de VEs. \n\nNo cap\u00edtulo 3 s\u00e3o apresentadas e comparadas diversas estrat\u00e9gias de carregamentos \n\ncoordenados j\u00e1 existentes. \n\nNo cap\u00edtulo 4 s\u00e3o analisados dados relativos a perfis de gera\u00e7\u00e3o e excessos, e poss\u00edveis \n\nsolu\u00e7\u00f5es a estes problemas. \n\nNo cap\u00edtulo 5 s\u00e3o descritos v\u00e1rios algoritmos para coordena\u00e7\u00e3o de carregamentos, o seu \n\nfuncionamento, finalidades e fazendo tamb\u00e9m uma analogia entre os mesmos.  \n\nNo cap\u00edtulo 6 ser\u00e3o apresentadas as simula\u00e7\u00f5es realizadas, os seus resultados e uma an\u00e1lise \n\ndos mesmos. \n\nPara concluir, segue-se o cap\u00edtulo 7 onde ser\u00e3o expostas as conclus\u00f5es deste trabalho, \n\nacompanhadas de sugest\u00f5es de implementa\u00e7\u00f5es futuras. \n\n  \n\n\n\n 4 \n\n \n\n2 Mobilidade El\u00e9trica \nOs VEs diferenciam-se dos ve\u00edculos usuais pelo facto de utilizarem um sistema de propuls\u00e3o \n\nel\u00e9trico. Em alternativa \u00e0 solu\u00e7\u00e3o comum, em que a propuls\u00e3o tem por base um dep\u00f3sito de \n\ncombust\u00edvel, um motor de combust\u00e3o interna (MCI) (que converte a energia armazenada no \n\ncombust\u00edvel em energia mec\u00e2nica) e um sistema de transmiss\u00e3o mec\u00e2nica \u00e0s rodas. J\u00e1 os VEs, \n\nutilizam motores el\u00e9tricos, que convertem energia el\u00e9trica na energia mec\u00e2nica necess\u00e1ria \u00e0 sua \n\npropuls\u00e3o. \n\nUm VE n\u00e3o s\u00f3 poder\u00e1 reduzir a emiss\u00e3o de GEE e outros poluentes, como tamb\u00e9m promove \n\na utiliza\u00e7\u00e3o de energia proveniente de fontes renov\u00e1veis [6]. Portanto, os VEs contribuem para um \n\nsector de transportes mais limpo e para a independ\u00eancia das energias f\u00f3sseis utilizadas atualmente. \n\n\u00c9 dif\u00edcil atribuir apenas a uma pessoa a inven\u00e7\u00e3o do primeiro VE. Em 1828, o H\u00fangaro \u00c1nyos \n\nJedlik, inventou um pequeno modelo de um carro movido por um motor el\u00e9trico. Ap\u00f3s Jedlik, \n\nv\u00e1rios inventores contribu\u00edram para esta inova\u00e7\u00e3o tais como Robert Anderson, Stratingh of \n\nGroningen, Thomas Davenport, entre outros [7]. Todos estes inventores estimularam a evolu\u00e7\u00e3o \n\ndos VEs at\u00e9 se tornarem nos ve\u00edculos atuais, com mais de 600 km de autonomia (o novo modelo \n\nda Tesla \u2013 P100D, com uma velocidade moderada e condi\u00e7\u00f5es ideais \u00e9 reivindicado pela empresa \n\ncomo tendo mais de 1000 km de autonomia), com desempenhos que desafiam qualquer carro \n\ndesportivo com MCI e, mais importante, sem utilizarem combust\u00edveis f\u00f3sseis.  \n\nOutro fator deveras essencial foi o desenvolvimento das baterias, pois sem estas, n\u00e3o seria \n\nposs\u00edvel armazenar energia para a propuls\u00e3o do VEs, sendo a autonomia e a dura\u00e7\u00e3o dos \n\ncarregamentos a grande limita\u00e7\u00e3o neste sector uma vez que todos os outros componentes do \n\nve\u00edculo j\u00e1 est\u00e3o numa fase de elevada maturidade. \n\n \n\n2.1 Tipos de Ve\u00edculos El\u00e9tricos \nOs VEs t\u00eam todos a mesma base tecnol\u00f3gica, contudo existem importantes diferen\u00e7as \n\ntecnol\u00f3gicas que permitem distinguir v\u00e1rios tipos de VEs. Assim, estes podem ser divididos em \n\ntr\u00eas categorias: ve\u00edculos puramente el\u00e9tricos, h\u00edbridos e ve\u00edculos de c\u00e9lula de combust\u00edvel.  \n\nO nome da categoria em si explica o conceito: ve\u00edculos puramente el\u00e9tricos apenas possuem \n\nmotores el\u00e9tricos alimentados por baterias sendo seu carregamento efetuado atrav\u00e9s da liga\u00e7\u00e3o a \n\numa tomada (Plug-in).  \n\nOs ve\u00edculos h\u00edbridos possuem um MCI aliado a um motor el\u00e9trico. Podem se dividir em \n\ndiferentes classes, s\u00e9rie (o MCI fornece pot\u00eancia ao alternador que, por sua vez, produz energia \n\nel\u00e9trica necess\u00e1ria ao funcionamento do motor el\u00e9trico que propulsiona o ve\u00edculo), paralelo (quer \n\n\n\n 5 \n\no MCI quer o motor el\u00e9trico fornecem pot\u00eancia em simult\u00e2neo \u00e0s rodas motrizes) ou s\u00e9rie-paralelo \n\n(uma combina\u00e7\u00e3o das duas anteriores que junta as suas vantagens em detrimento da \n\ncomplexidade). A ideia por detr\u00e1s dos VEs h\u00edbridos \u00e9 os motores se complementarem, permitindo \n\nter uma grande autonomia gra\u00e7as ao MCI com baixos consumos devido ao motor el\u00e9trico. O \n\ncarregamento das baterias \u00e9 efetuado pelo MCI ou, nos mais recentes, pode tamb\u00e9m ser carregado \n\ndiretamente por uma tomada. Atualmente, quase todos os ve\u00edculos h\u00edbridos vendidos s\u00e3o Plug-in.  \n\nOs ve\u00edculos de c\u00e9lula de combust\u00edvel produzem a energia necess\u00e1ria para a locomo\u00e7\u00e3o a partir \n\ndo hidrog\u00e9nio. A eletricidade resulta duma rea\u00e7\u00e3o qu\u00edmica entre o hidrog\u00e9nio e o oxig\u00e9nio cujo \n\nproduto, para al\u00e9m da eletricidade, \u00e9 \u00e1gua, pelo que se pode concluir que estes ve\u00edculos n\u00e3o s\u00e3o \n\npoluentes. A energia el\u00e9trica produzida \u00e9 utilizada na locomo\u00e7\u00e3o do ve\u00edculo ou guardada nas \n\nbaterias para uso posterior. Esta tecnologia possui a desvantagem de utilizar um combust\u00edvel \n\n(hidrog\u00e9nio) cuja ocorr\u00eancia na Natureza n\u00e3o \u00e9 abundante e cuja obten\u00e7\u00e3o implica um processo \n\nqu\u00edmico. Se este processo utilizar fontes de energia n\u00e3o-renov\u00e1veis, ent\u00e3o a produ\u00e7\u00e3o de \n\nhidrog\u00e9nio n\u00e3o \u00e9 ambientalmente favor\u00e1vel [8]. \n\n \n\n2.2 El\u00e9trico vs. Combust\u00e3o \nSendo os ve\u00edculos de combust\u00e3o interna os atuais rivais aos VEs, \u00e9 necess\u00e1rio fazer uma \n\naprecia\u00e7\u00e3o sobre os pr\u00f3s e contras envolvidos neste tema.  \n\nEstudos recentes [9][10], demonstram que os VEs s\u00e3o superiores aos ve\u00edculos tradicionais no \n\nque diz respeito a efici\u00eancia e em termos ambientais. Como consequ\u00eancia, \u00e9 esperado que o \n\nn\u00famero de unidades de VEs a circular venha a aumentar consideravelmente nos pr\u00f3ximos anos, \n\nespecialmente em \u00e1reas urbanas.  \n\n Um MCI moderno e sofisticado a gas\u00f3leo, consegue uma efici\u00eancia de 35-40% na gama \n\nde velocidade ideal, havendo um grande decl\u00ednio fora desta zona. J\u00e1 os motores a gasolina apenas \n\nconseguem uma efici\u00eancia entre os 18% e os 25% significando que aproximadamente 80% da \n\nenergia dispon\u00edvel \u00e9 desperdi\u00e7ada como calor [10].  \n\nApesar da enorme discrep\u00e2ncia de efici\u00eancias os MCI dominam completamente o sector \n\ndos transportes, representando 98% da totalidade [11] e emitindo GEE com um impacto \n\nconsider\u00e1vel. O transporte rodovi\u00e1rio \u00e9 respons\u00e1vel por aproximadamente por um quarto de todas \n\nas emiss\u00f5es de gases de efeito de estufa nos Europa e nos Estados Unidos, gerando mais de 3 Gt \n\nde CO2. A ado\u00e7\u00e3o de VEs pode vir a ter um grande impacto a atingir as metas globais de emiss\u00e3o \n\nde CO2 estabelecidas na Tabela 1. \n\n\n\n 6 \n\nTabela 1 - \u2013 Limites de emiss\u00f5es de CO2 e vendas necess\u00e1rias para cumprir as metas de emiss\u00f5es em 2020 [12] \n\n Limites de emiss\u00f5es de CO2 \npara ve\u00edculos novos \n\n(gCO2/km) \n\nPrevis\u00e3o atual de emiss\u00f5es \n\nde CO2 dos ve\u00edculos \n\n(gCO2/km) \n\nN\u00famero de novos \n\nVEs at\u00e9 2020 \n\n(milh\u00f5es) \n\n 2015  2020 2015 2020 \n\nEuropa 130 95 120 104 1,4 \n\nEUA 182 133 163 150 0,9 \n\n \n\n2.3 Motores e Baterias \nOs motores de tra\u00e7\u00e3o usados nos VEs, por norma, s\u00e3o motores DC, motores de indu\u00e7\u00e3o, \n\nmotores s\u00edncronos de \u00edmanes permanentes ou motores de relut\u00e2ncia. A decis\u00e3o depende da \n\ndensidade de pot\u00eancia, efici\u00eancia, controlabilidade, fiabilidade, maturidade tecnol\u00f3gica e custo \n\n[13][14][15], sendo os motores de \u00edmanes permanentes e os de indu\u00e7\u00e3o os mais comuns, devido \u00e0 \n\nsua efici\u00eancia que pode atingir desde os 85% a 95% numa ampla gama de velocidades [16]. \n\nO principal aspeto que tem atrasado a evolu\u00e7\u00e3o da mobilidade el\u00e9trica \u00e9 o armazenamento \n\nde energia. As baterias s\u00e3o a melhor solu\u00e7\u00e3o atualmente tendo o problema de terem um custo \n\nelevado, que representa uma percentagem substancial do custo do VE. \n\nOs fabricantes de autom\u00f3veis el\u00e9tricos est\u00e3o a apostar nas baterias de i\u00f5es de l\u00edtio, \n\nespecialmente pelo equil\u00edbrio que existe entre densidade de energia, durabilidade, seguran\u00e7a e \n\ncusto de fabrico. As baterias de i\u00f5es de l\u00edtio s\u00e3o caracterizadas pela aus\u00eancia de mem\u00f3ria e baixa \n\ntaxa de auto-descarga e, presentemente, ainda s\u00e3o vistas como a melhor op\u00e7\u00e3o para atingir os \n\nrequisitos de armazenamento de energia num VE. \n\nH\u00e1 op\u00e7\u00f5es que seriam mais apelativas como as baterias de pol\u00edmero de l\u00edtio que conseguem \n\nser mais compactas e leves que as de i\u00f5es de l\u00edtio, mas que ainda n\u00e3o est\u00e3o maduras o suficiente \n\npara aplica\u00e7\u00f5es de alta capacidade. Apesar disto, j\u00e1 h\u00e1 fabricantes, como a gigante da Coreia do \n\nSul Kia Motors Company, que j\u00e1 equipa os seus VEs com este tipo de baterias.  \n\n \n\n2.4 Carregamento de um Ve\u00edculo El\u00e9trico \nO carregamento de um VE consiste no processo de reposi\u00e7\u00e3o de energia el\u00e9trica na(s) \n\nbateria(s) do ve\u00edculo para um n\u00edvel m\u00e1ximo, ou pelo menos, superior. Os VEs est\u00e3o dotados de \n\num carregador interno que transforma a energia recebida (por meio de um cabo) em corrente \n\nalternada (CA) para corrente cont\u00ednua (CC), sendo dessa forma absorvida pela bateria. Para tal, o \n\nVE deve ser ligado \u00e0 rede el\u00e9trica, seja atrav\u00e9s de um posto de carregamento pr\u00f3prio ou \n\nsimplesmente usando uma tomada dom\u00e9stica normal. Contudo, pode haver variantes, como no \n\n\n\n 7 \n\ncaso dos supercarregadores Tesla, em que as baterias do carro recebem diretamente energia DC \n\nde uma rede exclusiva da pr\u00f3pria empresa. \n\nA norma europeia/portuguesa EN/NP61851 \u2013 Sistema de carga condutiva para VEs (2003), \n\nrevista em Dezembro de 2010, define como deve ser feito o carregamento de um VE e em que \n\ncondi\u00e7\u00f5es. Para esse efeito define 4 modos de carregamento [17]: \n\n\u2022 Modo 1 - Liga\u00e7\u00e3o do VE \u00e0 rede de alimenta\u00e7\u00e3o utilizando tomadas normalizadas de \n\ncorrente at\u00e9 16A, no lado da rede de alimenta\u00e7\u00e3o, monof\u00e1sica ou trif\u00e1sica, com \n\ncondutores de fase(s), de neutro e de terra de prote\u00e7\u00e3o, ou seja, utilizando tomadas \n\ndom\u00e9sticas do tipo schuko ou industriais da norma EN60309.  \n\n\u2022 Modo 3 - O Modo 3 antecede o Modo 2 pois trata-se de uma adapta\u00e7\u00e3o. Segundo a norma \n\nEN/NP61851, o Modo 3 \u00e9 um sistema de fornecimento de energia em corrente alternada, \n\ndesenvolvido especificamente para VEs. Este sistema visa aumentar a seguran\u00e7a do \n\nprocesso de carregamento de um VE e reduzir o risco decorrente de eventuais erros de \n\nmanipula\u00e7\u00e3o por seres humanos e de defeito de isolamento el\u00e9trico do VE, cabo de \n\nliga\u00e7\u00e3o ou tomada de fornecimento.  \n\n\u2022 Modo 2 -  \u00c9 um sistema de carregamento desenvolvido para permitir um ve\u00edculo que s\u00f3 \n\ncarrega em Modo 3, carregar numa tomada existente dom\u00e9stica ou industrial. Para esse \n\nefeito o cabo de carregamento tem a fun\u00e7\u00e3o de piloto de controlo desde o ve\u00edculo at\u00e9 a \n\numa caixa de comando situada na outra ponta do cabo. Esta caixa permite Modo 3 ao \n\nlongo do cabo. Da caixa de comando sai uma ficha dom\u00e9stica ou industrial para ligar a \n\numa tomada. \n\n\u2022 Modo 4 - \u00c9 definido como a liga\u00e7\u00e3o indireta do VE \u00e0 rede de alimenta\u00e7\u00e3o utilizando um \n\ncarregador externo no qual o condutor-piloto de controlo vai at\u00e9 ao equipamento \n\nligando-se de uma forma permanente \u00e0 rede de alimenta\u00e7\u00e3o. \u00c9 exemplo do Modo 4 os \n\ncarregadores r\u00e1pidos DC que alimentam a bateria do ve\u00edculo diretamente em DC, \n\nfazendo o bypass do carregador de bordo. \n\n\u00c9 hoje aceite, quer pela ind\u00fastria el\u00e9trica quer pela autom\u00f3vel, que o Modo 3 \u00e9 a solu\u00e7\u00e3o \n\nmais adequada para o carregamento de ve\u00edculos el\u00e9tricos, pois apresenta importantes vantagens, \n\nnomeadamente: \n\n\u2022 Ao utilizar tomadas dedicadas para o carregamento de VEs, impedem-se poss\u00edveis \n\nproblemas de utiliza\u00e7\u00e3o de correntes superiores ao suport\u00e1vel por tomadas antigas;  \n\n\u2022 A seguran\u00e7a adicional que representa a monitoriza\u00e7\u00e3o cont\u00ednua do isolamento do \n\nve\u00edculo quando em carga;  \n\n\u2022 A possibilidade de utiliza\u00e7\u00e3o de diferentes n\u00edveis de pot\u00eancia de fornecimento por um \n\nVE, utilizando a mesma ficha e tomada; \n\n\n\n 8 \n\n\u2022 A possibilidade intr\u00ednseca do encravamento das fichas do cabo de liga\u00e7\u00e3o, na tomada \n\nde fornecimento e do ve\u00edculo, durante a sess\u00e3o de carregamento, o que evita \n\ndesconex\u00e3o da ficha em tens\u00e3o; \n\n\u2022 A possibilidade intr\u00ednseca de a tomada estar sempre sem alimenta\u00e7\u00e3o, quando n\u00e3o est\u00e1 \n\nem utiliza\u00e7\u00e3o, atrav\u00e9s da monitoriza\u00e7\u00e3o do circuito de \u201cpiloto de controlo\u201d.  \n\n\u2022 A possibilidade do estabelecimento de uma sess\u00e3o de comunica\u00e7\u00e3o entre a tomada de \n\nfornecimento e o ve\u00edculo, que permite a coordena\u00e7\u00e3o do carregamento do ve\u00edculo com \n\na disponibilidade dos recursos de rede. \n\nN\u00e3o obstante \u00e0s vantagens do Modo 3, \u00e9 importante manter aberta utiliza\u00e7\u00e3o do Modo 1 e \n\n2, pois isso permite que qualquer ve\u00edculo carregue em qualquer lado, o que \u00e9 uma importante \n\nvantagem para o paradigma de mobilidade el\u00e9trica.  \n\n \n\n2.5 Impacto dos Ve\u00edculos El\u00e9tricos \nAtualmente, \u00e9 dada grande aten\u00e7\u00e3o aos VEs no que toca \u00e0s altera\u00e7\u00f5es clim\u00e1ticas dado que o \n\nsector de transportes \u00e9 considerado o segundo maior respons\u00e1vel por emiss\u00f5es CO2 [18]. O \n\ndesenvolvimento em massa de VEs pode ser uma boa solu\u00e7\u00e3o em alternativa ao consumo \n\nexcessivo de combust\u00edveis f\u00f3sseis e, eventualmente, polui\u00e7\u00e3o do ar. Face a este facto, \u00e9 natural o \n\nr\u00e1pido crescimento da popula\u00e7\u00e3o de VEs que se observa nos dias hoje.  \n\nContudo, este desenvolvimento abrupto acarreta impactos adversos em diferentes cen\u00e1rios. \n\nEstes impactos podem variar em fun\u00e7\u00e3o no n\u00edvel de penetra\u00e7\u00e3o de VEs, nas caracter\u00edsticas das \n\nsuas baterias, nas estrat\u00e9gias de carregamento, estilos de condu\u00e7\u00e3o, tempos de carregamento, \n\nestado de carga (State of Charge - SOC) da bateria, dist\u00e2ncias de condu\u00e7\u00e3o, estrat\u00e9gias de \n\nfornecimento e das tarifas el\u00e9tricas dispon\u00edveis [19][20]. Um VE n\u00e3o emite diretamente CO2, mas \n\npode ser mais prejudicial que um ve\u00edculo de combust\u00e3o padr\u00e3o caso a energia utilizada provenha \n\nde fontes n\u00e3o renov\u00e1veis. \n\nNo geral, os impactos dos VEs podem ser classificados em 3 categoriais principais mostradas \n\nda Figura 1 e detalhadas nas seguintes subse\u00e7\u00f5es.  \n\nFigura 1 - Classifica\u00e7\u00e3o dos impactos dos VEs \n\nImpactos dos \nVEs\n\nImpacto na rede \nel\u00e9trica\n\nImpacto \nambiental\n\nImpacto \necon\u00f3mico\n\n\n\n 9 \n\n2.5.1 Impacto dos VEs nas redes de energia el\u00e9trica \nO impacto dos VEs tem um papel crucial na fiabilidade de um SEE que \u00e9 essencial no que \n\ndiz respeito \u00e0 qualidade de abastecimento. Pode-se ter fatores positivos e negativos, tal como a \n\nFigura 2 indica: \n\n \nFigura 2 \u2013 Impactos dos VEs nas redes de energia el\u00e9trica \n\n2.5.1.1 Aumento do pico de procura \nV\u00e1rios estudos foram conduzidos de modo a examinar o impacto do carregamento de VEs \n\ndurante picos de procura na rede. O incremento causado pelos VEs neste per\u00edodo foi investigado \n\nem [21]. Foi determinado, pelos autores, que o carregamento completo n\u00e3o coordenado de VEs \n\ncom alta penetra\u00e7\u00e3o durante o per\u00edodo de ponta pode, por vezes, ser superior \u00e0 capacidade de \n\ngera\u00e7\u00e3o de energia el\u00e9trica em alguns dias de maior procura. Com isto, concluiu-se que 93% dos \n\ncarregamentos deveria ser desviado para intervalos de menor procura caso a capacidade m\u00e1xima \n\nde gera\u00e7\u00e3o se mantivesse constante.  \n\nNum estudo semelhante, Wang e Paranjape [22], mostraram que, com 30% de penetra\u00e7\u00e3o \n\nde VEs e com carregamento n\u00e3o controlado, o pico de procura numa rede de distribui\u00e7\u00e3o \n\nresidencial representada por um alimentador de teste IEEE de 34 nodos [23], iria aumentar em \n\n53%. \n\n \n\n2.5.1.2 Recurso de resposta \u00e0 procura e armazenamento de energia \nOs VEs podem ajudar a equilibrar o balan\u00e7o procura-oferta de uma rede.  Usando m\u00e9todos \n\nde carregamento coordenado \u00e9 poss\u00edvel, atrav\u00e9s da desloca\u00e7\u00e3o do per\u00edodo de carregamento, \n\nImpactos dos \nVEs nas redes \n\nde energia \nel\u00e9trica\n\nImpactos \npositivos\n\nRecurso de \nresposta \u00e0 \n\nprocura e de \narmazenamento \n\nde energia\n\nImpactos \nnegativos\n\nAumento do \npico de procura\n\nQualidade de \nenergia\n\nDistor\u00e7\u00e3o \nharm\u00f3nica\n\nDesequilibrio \ndas tens\u00f5es\n\nTremula\u00e7\u00f5es\n\nAuemento das \nperdas de \nenergia\n\nSobrecarga dos \ntransformadores\n\nInstabilidade de \ntens\u00e3o \n\n\n\n 10 \n\npreencher cavas no diagrama de carga, minimizar a ponta de procura (reduzindo assim os custos \n\nda rede) e possibilitando pre\u00e7os de carregamento mais baixos. Em [24] e [25], conseguiu-se reduzir \n\na ponta sem adicionar capacidade de gera\u00e7\u00e3o extra recorrendo a carregamentos inteligentes ou \n\ncontrolados e servindo-se de tarifas especiais. \n\n\u00c9 poss\u00edvel, recorrendo a uma frota de VEs, absorver excessos de gera\u00e7\u00e3o de renov\u00e1vel e \n\ncompensar r\u00e1pidas redu\u00e7\u00f5es atuando como um grande sistema de armazenamento de energia, \n\npossibilitando a integra\u00e7\u00e3o de mais energias renov\u00e1veis. Este cen\u00e1rio \u00e9 conhecido como Vehicle \n\nto Grid \u2013  Ve\u00edculo para a Rede, abreviado na literatura inglesa como V2G, consiste em utilizar as \n\nbaterias do VE para armazenar energia durante o per\u00edodo de carregamento quando ligadas \u00e0 rede \n\nde distribui\u00e7\u00e3o. \u00c9 uma tecnologia que aumenta a fiabilidade e diminui os custos de um SEE. O \n\nr\u00e1pido fornecimento de energia que este m\u00e9todo permite, \u00e9 uma maneira eficaz de contribuir para \n\na qualidade de energia mitigando as flutua\u00e7\u00f5es de tens\u00e3o, auxiliando nos per\u00edodos de ponta e \n\ndiminuindo as perdas no SEE em que est\u00e1 inclu\u00eddo. Em contrapartida, \u00e9 uma t\u00e9cnica que provoca \n\num grande desgaste nas baterias levando a uma substitui\u00e7\u00e3o das mesmas prematuramente. Com as \n\nbaterias que existem neste momento no mercado, \u00e9 um sistema que ainda n\u00e3o atrai os \n\nconsumidores devido \u00e0 n\u00e3o rentabilidade. \n\n \n\n2.5.1.3 Qualidade da energia \nA crescente penetra\u00e7\u00e3o de VEs numa rede de distribui\u00e7\u00e3o pode afetar a qualidade de \n\nfornecimento. V\u00e1rios estudos averiguaram o impacto a n\u00edvel da instabilidade da tens\u00e3o, distor\u00e7\u00e3o \n\nharm\u00f3nica, desequil\u00edbrio de tens\u00f5es, tremula\u00e7\u00f5es, aumento das perdas e sobrecargas de \n\ntransformadores. \n\n \n\n2.5.1.3.1 Instabilidade de tens\u00e3o \n\nEntende-se a instabilidade de tens\u00e3o como a capacidade do SEE, dada uma condi\u00e7\u00e3o inicial \n\nde opera\u00e7\u00e3o, reganhar um estado de equil\u00edbrio depois de sujeito a um dist\u00farbio. A crescente \n\npenetra\u00e7\u00e3o de VEs pode originar problemas ao n\u00edvel da tens\u00e3o dado que as suas carater\u00edsticas de \n\ncarregamento s\u00e3o diferentes das de uma casa tradicional ou cargas na ind\u00fastria. Os VEs s\u00e3o cargas \n\nn\u00e3o-lineares1 que consomem uma quantidade de energia consider\u00e1vel durante um curto per\u00edodo \n\nde tempo durante o seu carregamento que, como consequ\u00eancia, influencia a estabilidade da tens\u00e3o \n\n[26].  \n\n                                                \n1 Uma carga \u00e9 dita n\u00e3o-linear quando a corrente que ela absorve n\u00e3o tem a mesma forma da tens\u00e3o que a \n\nalimenta. \n\n\n\n 11 \n\n2.5.1.3.2 Distor\u00e7\u00e3o harm\u00f3nica \n\nA presen\u00e7a de harm\u00f3nicos \u00e9 sin\u00f3nimo de uma onda de tens\u00e3o ou corrente deformada. Essa \n\ndeforma\u00e7\u00e3o significa que a distribui\u00e7\u00e3o de energia el\u00e9trica \u00e9 perturbada e que a sua qualidade n\u00e3o \n\n\u00e9 \u00f3tima. Os harm\u00f3nicos s\u00e3o causados por cargas n\u00e3o lineares e t\u00eam um impacto econ\u00f3mico \n\nconsider\u00e1vel. Provocam o envelhecimento precoce do material, por vezes implicam o \n\nsobredimensionamento do sistema e aumentam as perdas de energia. Estes harm\u00f3nicos geralmente \n\nprovocam o aquecimento dos equipamentos como transformadores, fus\u00edveis e, por vezes, originam \n\no aparecimento de uma corrente no neutro da rede que pode acarretar problemas caso seja \n\nsobrecarregado [27]. \n\n \n\n2.5.1.3.3 Desequil\u00edbrio das tens\u00f5es \n\nA varia\u00e7\u00e3o da tens\u00e3o num sistema trif\u00e1sico \u00e9 uma condi\u00e7\u00e3o em que a as amplitudes das \n\ntr\u00eas fases n\u00e3o \u00e9 igual ou o desfasamento entre elas \u00e9 diferente de 120\u00ba. Este fen\u00f3meno ocorre nas \n\nredes de distribui\u00e7\u00e3o quando h\u00e1 um sobre carregamento de uma ou v\u00e1rias fases de um sistema \n\nmultif\u00e1sico devido ao desequil\u00edbrio de cargas. Neste caso, devido \u00e0 elevada pot\u00eancia que os \n\ncarregadores dos VEs necessitam \u00e9 um fen\u00f3meno comum de ocorrer. \n\n \n\n2.5.1.3.4 Tremula\u00e7\u00f5es  \n\nA tremula\u00e7\u00e3o da tens\u00e3o trata-se de uma interrup\u00e7\u00e3o n\u00e3o completa do fornecimento de \n\nenergia em que h\u00e1 uma redu\u00e7\u00e3o da tens\u00e3o eficaz durante um per\u00edodo de 10 ms a 1 mim [28]. Ocorre \n\nnuma rede de distribui\u00e7\u00e3o quando h\u00e1 um curto-circuito, sobrecarga ou arranque de motores \n\nel\u00e9tricos de pot\u00eancia consider\u00e1vel. Para estimar as consequ\u00eancias da integra\u00e7\u00e3o de VEs numa rede \n\nde distribui\u00e7\u00e3o, Lee et al. [29], criaram um modelo de um carregador de um VE. A simula\u00e7\u00e3o \n\nmostrou que as tremula\u00e7\u00f5es excediam os limites padr\u00e3o IEEE [30] com apenas 20% de penetra\u00e7\u00e3o. \n\n \n\n2.5.1.3.5 Aumento das perdas de energia \n\nA penetra\u00e7\u00e3o em massa de VEs pode afetar a rede de distribui\u00e7\u00e3o de tal maneira que a \n\nquantidade de perdas de energia nas linhas pode aumentar drasticamente.  \n\nDe maneira a calcular as perdas provocadas pelos VEs num cen\u00e1rio de elevada penetra\u00e7\u00e3o, \n\nPapodopoulos et al. [31], utilizando uma aproxima\u00e7\u00e3o probabil\u00edstica em que inclu\u00eda intensidade \n\nde carregamentos e dura\u00e7\u00f5es de carga incertas, mostrou que as perdas iriam aumentar 9%.  \n\nSemelhantemente, Pieltain et al. [32], com tr\u00eas cen\u00e1rios diferentes de penetra\u00e7\u00e3o, 35%, 51% e \n\n62%, usaram um modelo que n\u00e3o dependia do hor\u00e1rio de carregamento ou padr\u00f5es. Os resultados \n\nmostraram um incremento das perdas que iria dos 10% at\u00e9, no pior cen\u00e1rio, 40%. \n\n\n\n 12 \n\n \n\n2.5.1.3.6 Sobrecarga dos transformadores \n\nA penetra\u00e7\u00e3o em larga escala de VEs numa rede de distribui\u00e7\u00e3o produz uma press\u00e3o \n\nadicional nos transformadores de distribui\u00e7\u00e3o.  \n\nEm [33], os autores conclu\u00edram que, com uma penetra\u00e7\u00e3o de VEs de apenas 20%, alguns \n\ntransformadores de distribui\u00e7\u00e3o iram estar no limite de funcionamento nominal, sendo estes \n\nequipamentos os que podem vir a limitar a expans\u00e3o da mobilidade el\u00e9trica em algumas regi\u00f5es \n\n[34]. \n\n \n\n2.5.2 Impacto ambiental dos VEs \nA energia dos VEs puros e dos h\u00edbridos Plug-in prov\u00e9m da rede de energia el\u00e9trica ao \n\ncontr\u00e1rio dos transportes tradicionais que implicam a queima de combust\u00edveis f\u00f3sseis. Posto isto, \n\nas emiss\u00f5es de GEE durante a fase de opera\u00e7\u00e3o s\u00e3o nulas quando se opta por usar um VE desde \n\nque, a energia derive de fontes \u201climpas\u201d, tais como fontes de energia renov\u00e1veis.  \n\nDe modo a calcular as emiss\u00f5es de CO2 e outros poluentes por km, Donateo et al. [35] \n\nprop\u00f4s uma metodologia que inclu\u00eda o consumo de energia e a diversidade de gera\u00e7\u00e3o para cada \n\nevento de carregamento e n\u00edveis de emiss\u00e3o. O estudo apresenta as vantagens da mobilidade \n\nel\u00e9trica em termos de di\u00f3xido de carbono, mon\u00f3xido de carbono, mon\u00f3xido de nitrog\u00e9nio e outras \n\npart\u00edculas poluentes.  \u00c9 tamb\u00e9m conclu\u00eddo que um VE \u00e9 o ve\u00edculo que tem as emiss\u00f5es well-to-\n\nwheel \u2013 \u201cdo tanque \u00e0s rodas\u201d mais baixas. Sendo well-to-wheel um par\u00e2metro usado para calcular \n\nas emiss\u00f5es durante todo o ciclo de vida de um ve\u00edculo, desde a sua produ\u00e7\u00e3o \u00e0 utiliza\u00e7\u00e3o. \n\nUm modelo que avalia as emiss\u00f5es de GEE num cen\u00e1rio de ado\u00e7\u00e3o em massa de VE foi \n\ninvestigado em [36]. Os impactos foram calculados para dois anos espec\u00edficos com um intervalo \n\nde dez anos entre eles. Nos primeiros anos, o estudo revelou que, carregando os VEs durante \n\nper\u00edodos de vazio ou preenchendo cavas no diagrama de carga resultou numa maior liberta\u00e7\u00e3o de \n\nGEE, devido \u00e0 percentagem elevada de gera\u00e7\u00e3o recorrendo a centrais a carv\u00e3o. Contudo, na \n\nsegunda parte do estudo, com a remo\u00e7\u00e3o das centrais a carv\u00e3o, verificou-se uma redu\u00e7\u00e3o de 85% \n\nde emiss\u00f5es de CO2 no sector de transporte na Dinamarca. \n\nLund e Kempton [37] mostraram que, mesmo sem inclus\u00e3o de energia e\u00f3lica, o uso de VE \n\npode mitigar significativamente a emiss\u00e3o de CO2.  \n\nNum estudo similar [38], foram comparadas as emiss\u00f5es de CO2 por quil\u00f3metro percorrido \n\nde um Nissan Leaf. A an\u00e1lise envolveu tr\u00eas pa\u00edses com emiss\u00f5es de produ\u00e7\u00e3o de energia distintas \n\nobtendo os resultados da Figura 3. Na Fran\u00e7a, pa\u00eds com baixas emiss\u00f5es, o carregamento das \n\nbaterias implica uma liberta\u00e7\u00e3o de 83 gCO2/km, j\u00e1 para Portugal o valor sobe para os 122 gCO2/km \n\ne, no caso de um pa\u00eds com elevadas emiss\u00f5es, a Pol\u00f3nia, atinge-se 210 gCO2/km. \n\n\n\n 13 \n\n \nFigura 3 \u2013 Impacto de emiss\u00f5es de um Nissan Leaf por km para diferentes modos de condu\u00e7\u00e3o [38] \n\nNum outro estudo [39], foi investigado os impactos dos VE num ambiente urbano com \n\numa penetra\u00e7\u00e3o de 50%. Os autores verificaram a redu\u00e7\u00e3o de mon\u00f3xido de nitrog\u00e9nio (respons\u00e1vel \n\npor chuvas \u00e1cidas e nevoeiros qu\u00edmicos) e de di\u00f3xido de nitrog\u00e9nio (g\u00e1s irritante para os pulm\u00f5es \n\nque diminui a resist\u00eancia \u00e0s infe\u00e7\u00f5es respirat\u00f3rias) em 15% e 5,5%, respetivamente.  \n\n Em suma, carregar um VE numa rede el\u00e9trica que tenha como base energia proveniente de \n\nqueima de carv\u00e3o ou g\u00e1s natural, emite mais gases prejudiciais face ao uso de um ve\u00edculo \n\ntradicional [40]. Em situa\u00e7\u00e3o onde haja integra\u00e7\u00e3o de energia renov\u00e1vel as emiss\u00f5es s\u00e3o reduzidas \n\n[41]. \n\n \n\n2.5.3 Impacto econ\u00f3mico dos VEs \nOs impactos econ\u00f3micos dos VEs podem ser observados de duas diferentes perspetivas: \n\ndo lado do propriet\u00e1rio e do lado das entidades respons\u00e1veis pela gest\u00e3o das redes de energia \n\nel\u00e9trica [42].  \n\nDo ponto de vista do propriet\u00e1rio, os custos de manuten\u00e7\u00e3o e de utiliza\u00e7\u00e3o de um VE \u00e9 \n\ninferior ao de um ve\u00edculo tradicional devido \u00e0 maior efici\u00eancia do motor el\u00e9trico face ao MCI [43]. \n\nEm contrapartida, o custo inicial de adquisi\u00e7\u00e3o de um VE \u00e9 ainda elevado comparado com ve\u00edculos \n\ncom MCI. Contudo, a produ\u00e7\u00e3o em massa e incentivos \u00e0 compra podem reduzir significativamente \n\nos pre\u00e7os dos VEs no futuro.  \n\nDa perspetiva da rede el\u00e9trica, a integra\u00e7\u00e3o de VEs num SEE aumenta a complexidade, os \n\ncustos do sistema e as perdas. Contudo, uma estrat\u00e9gia de carregamento eficiente pode minimizar \n\nesses aspetos adversos [44][45].  \n\n\n\n 14 \n\n \n\n3 Carregamento Coordenado de Ve\u00edculos El\u00e9tricos  \n\nTal como descrito anteriormente, o desenvolvimento da mobilidade el\u00e9trica pode ter impactos \n\nnegativos nas redes de energia el\u00e9trica, pelo que \u00e9 necess\u00e1rio encontrar ferramentas que mitiguem \n\nesses efeitos. Simultaneamente, \u00e9 necess\u00e1rio manter os utilizadores dos VEs satisfeitos, sendo a \n\nsua principal preocupa\u00e7\u00e3o ter as baterias carregadas na altura em que necessitam usar o ve\u00edculo. \n\nContudo, existe um grau de flexibilidade elevado, pois os VEs, geralmente, passam mais tempo \n\nestacionados do que aquele necess\u00e1rio para carregar as baterias. Assim, pode-se explorar esta \n\nflexibilidade e mover os carregamentos para um per\u00edodo de tempo em que, por exemplo, o \n\nconsumo de energia seja menor, a gera\u00e7\u00e3o de energia renov\u00e1vel maior ou os custos menores. Esta \n\noportunidade possibilita o desenvolvimento de algoritmos de carregamento inteligentes de modo \n\na mitigar os problemas que os carregamentos dos VEs provocam nos SEE. Estes algoritmos \n\ndecidem quando o ve\u00edculo deve ser carregado e, caso seja permitido, a pot\u00eancia de carregamento \n\nde modo a atingir os objetivos pretendidos. Neste cap\u00edtulo ser\u00e3o apresentados v\u00e1rios casos de \n\notimiza\u00e7\u00e3o de carregamento de VEs, tendo como principais objetivos minimizar o custo de \n\ncarregamento, minimizar as pontas de procura, melhorar a qualidade dos SEE e maximizar uso da \n\nenergia renov\u00e1vel dispon\u00edvel. \n\nTradicionalmente, a oferta de energia \u00e9 ajustada em tempo real de modo a satisfazer a procura. \n\nDe modo a facilitar este equil\u00edbrio, os consumidores s\u00e3o encorajados, atrav\u00e9s de tarifas com pre\u00e7os \n\nmais reduzidos em per\u00edodos de pouca procura, a deslocar os seus consumos de maneira a preencher \n\nas cavas nos diagramas. Esta t\u00e9cnica n\u00e3o s\u00f3 tem um impacto econ\u00f3mico positivo para o \n\nconsumidor como, indiretamente, melhora a efici\u00eancia dos SEE devido \u00e0 redu\u00e7\u00e3o das pontas de \n\nprocura [46] tal como j\u00e1 foi analisado nas sec\u00e7\u00f5es 2.5.1.1 e 2.5.1.3.5. Ao diminuir as pontas de \n\nprocura, est\u00e1-se a diminuir a corrente no sistema provocando uma redu\u00e7\u00e3o de perdas. Outra \n\nconsequ\u00eancia \u00e9 a diminui\u00e7\u00e3o da resistividade das linhas, devido \u00e0 redu\u00e7\u00e3o da temperatura \n\nassociada \u00e0 redu\u00e7\u00e3o da corrente, que tamb\u00e9m contribui para a redu\u00e7\u00e3o das perdas.  \n\nColocar o VE a carregar em per\u00edodos de vazio pode ser o suficiente para os objetivos do \n\nutilizador. Contudo, para a rede el\u00e9trica, tal pode n\u00e3o ser suficiente, pois se todos os VEs \n\ncome\u00e7arem a carregar \u00e0 mesma hora, num caso de penetra\u00e7\u00e3o elevada de VEs, tal pode dar origem \n\na uma nova ponta no diagrama de carga. Para mitigar esse problema, \u00e9 necess\u00e1rio utilizar uma \n\nestrat\u00e9gia mais robusta e capaz de gerir v\u00e1rias vari\u00e1veis de controlo, mantendo sempre como \n\nprioridade a satisfa\u00e7\u00e3o das necessidades do utilizador.  \n\nO controlo inteligente de carregamento oferece uma potencial solu\u00e7\u00e3o para acomodar o \n\ncarregamento de uma vasta popula\u00e7\u00e3o de VEs numa rede de distribui\u00e7\u00e3o, sem a necessidade de \n\n\n\n 15 \n\nmelhorar significativamente as infraestruturas. Existem dois tipos principais de controlo \n\ninteligente de carregamento: Controlo de Carregamento Local (CCL) e Controlo de Carregamento \n\nCentralizado (CCC). No CCC, o carregamento de um grupo de VEs \u00e9 gerido por um controlador \n\ncentral. No CCL, o consumidor \u00e9 o respons\u00e1vel pelo carregamento do seu ve\u00edculo localmente. O \n\nCCC tem acesso a mais informa\u00e7\u00e3o e pode iniciar e interromper os carregamentos para controlar \n\na procura de energia global dentro do sistema, sendo mais vocacionada para o equil\u00edbrio de \n\ngera\u00e7\u00e3o-procura e qualidade de energia. No caso do CCL n\u00e3o existe um controlador principal e o \n\nprincipal objetivo \u00e9 o de minimizar os custos de carregamento. Este m\u00e9todo tamb\u00e9m pode ter em \n\nconta as restri\u00e7\u00f5es da rede, ajudando a mitigar as pontas de procura, por\u00e9m n\u00e3o \u00e9 t\u00e3o eficaz a n\u00edvel \n\nde controlo de qualidade de energia do SEE. Neste cap\u00edtulo, ser\u00e3o apresentados exemplos de v\u00e1rios \n\nm\u00e9todos e, por fim, uma compara\u00e7\u00e3o entre eles. \n\n \n\n3.1 Controlo de carregamento local \nO algoritmo desenvolvido em [47] \u00e9 um CCL que usa informa\u00e7\u00e3o do consumo local de \n\nmodo a determinar o hor\u00e1rio de carregamento. Assume-se que \u00e9 sabido o consumo de energia do \n\nlocal onde est\u00e1 estacionado o VE, o SOC, a dura\u00e7\u00e3o do carregamento e que existe um sistema \n\nauxiliar de programa\u00e7\u00e3o de modo a iniciar o carregamento no instante pretendido. O consumo \u00e9 \n\nprevisto com base o no hist\u00f3rico do edif\u00edcio e, como tal, o impacto de casas vizinhas e o perfil de \n\ncargas geral do SEE n\u00e3o \u00e9 considerado. Assim sendo, o objetivo \u00e9 minimizar a ponta local de \n\nprocura e a varia\u00e7\u00e3o do perfil do diagrama de carga. O algoritmo recorre a um modelo de \n\nprograma\u00e7\u00e3o quadr\u00e1tica, executado separadamente para cada ve\u00edculo, de modo a encontrar o \n\nhor\u00e1rio \u00f3timo de carregamento.  \n\n \n\n3.2 Controlo de carregamento iterativo \nO algoritmo introduzido em [48] usa uma t\u00e9cnica iterativa e \u00e9 um m\u00e9todo interm\u00e9dio entre \n\nCCL e CCC. O carregamento \u00e9 na mesma controlado localmente, mas neste caso \u00e9 considerado \n\nn\u00e3o apenas o consumo da casa, mas tamb\u00e9m o das casas vizinhas. Tem como objetivo equilibrar \n\no diagrama de carga visto do lado do transformador, tendo um prop\u00f3sito mais geral e abrangente. \n\nEste algoritmo \u00e9 baseado no m\u00e9todo \u201cfirst-come-first-served\u201d. Assim, quando um ve\u00edculo chega a \n\ncasa \u00e9 avaliado o seu impacto no diagrama de carga geral e calculado o per\u00edodo \u00f3timo de \n\ncarregamento. Ao chegar outro VE a outra resid\u00eancia, o algoritmo \u00e9 executado novamente apenas \n\npara este ultimo, tendo em conta os que j\u00e1 est\u00e3o previamente agendados. \n\n \n\n\n\n 16 \n\n3.3 Controlo de carregamento centralizado  \nO algoritmo introduzido em [49] \u00e9 um m\u00e9todo de CCC. Este considera o hist\u00f3rico de \n\nconsumo de cada casa e as sess\u00f5es de carregamento programadas que ir\u00e3o ocorrer no futuro na \n\n\u00e1rea que se est\u00e1 a controlar. Num per\u00edodo de carregamento, \u00e9 definido antecipadamente o hor\u00e1rio \n\nem que um conjunto de ve\u00edculos ir\u00e1 carregar. Para tal \u00e9 necess\u00e1rio saber o hor\u00e1rio de chegada, \n\nhor\u00e1rio de sa\u00edda, SOC e par\u00e2metros de carregamento, tais como a pot\u00eancia absorvida. Baseado \n\nnesta informa\u00e7\u00e3o, os hor\u00e1rios de carregamento de cada ve\u00edculo s\u00e3o determinados simultaneamente \n\nresolvendo um modelo de programa\u00e7\u00e3o quadr\u00e1tica. \u00c9 de notar que, em contraste com um modelo \n\nde CCL iterativo, o CCC apenas tem que ser executado uma vez de modo a encontrar a solu\u00e7\u00e3o \n\n\u00f3tima. A vantagem \u00e9 que este considera antecipadamente toda a informa\u00e7\u00e3o, permitindo uma \n\nmaior flexibilidade de hor\u00e1rios. Na Figura 4 s\u00e3o exemplificadas as diferentes abordagens \n\nanteriormente descritas. \n\n \nFigura 4 - Exemplo das arquiteturas dos algoritmos: (a) carregamento descontrolado, (b) controlo local, (c) controlo \n\niterativo/centralizado \n\n3.4  Sistema Multi-Agente \nOutra abordagem \u00e9 baseada num Sistema Multi-Agente (Multi Agent System - MAS). Um \n\nSistema Multi-Agente \u00e9 um sistema computacional em que dois ou mais agentes interagem ou \n\ntrabalham em conjunto de forma a desempenhar determinadas tarefas ou satisfazer um conjunto \n\nde objetivos [50]. Neste caso, o que define o per\u00edodo de carregamento \u00e9 o pre\u00e7o da energia, \n\nconsiderando os pre\u00e7os de mercado [51]. \u00c9 de notar que esta coordena\u00e7\u00e3o baseada num sistema \n\nde mercado assume que o pre\u00e7o da energia \u00e9 usado apenas para controlar o sinal que estimula o \n\ncontrolador do carregamento do VE a adiar ou avan\u00e7ar o seu consumo, mas nenhum sistema de \n\npre\u00e7o em tempo real est\u00e1 ligado a este tipo de sistema. A grande vantagem da coordena\u00e7\u00e3o de \n\ncarregamentos com base num mercado de eletricidade com um sistema MAS \u00e9 que n\u00e3o requer um \n\nalgoritmo de planeamento central e acomoda um grande n\u00famero de VEs. Em [52] foi formulado \n\n\n\n 17 \n\num algoritmo MAS que, segundo os autores, \u00e9 superior face aos \u00faltimos tr\u00eas devido a n\u00e3o \n\nnecessitar dados precisos acerca do carregamento dos VE. \n\n \n\n3.5 Compara\u00e7\u00e3o de carregamentos inteligentes \nEm [49], os autores do algoritmo CCC apresentado em 3.3, compararam o seu algoritmo \n\ncom outros tr\u00eas algoritmos diferentes. A simula\u00e7\u00e3o consistiu num cen\u00e1rio de 63 casas distribu\u00eddas \n\npor 3 postos de transforma\u00e7\u00e3o, ligados a um transformador de distribui\u00e7\u00e3o de 250 kVA. As casas \n\npossu\u00edam apenas uma liga\u00e7\u00e3o monof\u00e1sica, que s\u00e3o distribu\u00eddas uniformemente pelas 3 fases do \n\nsistema. Como hist\u00f3rico de consumo das resid\u00eancias foram usados dados reais recolhidos na \n\nB\u00e9lgica durante o inverno (pior cen\u00e1rio devido ao maior consumo de energia) e atribu\u00eddos \n\naleatoriamente \u00e0s casas da simula\u00e7\u00e3o. Os 4 m\u00e9todos foram simulados para 3 tipos de cen\u00e1rios \n\n(n\u00famero baixo, m\u00e9dio e elevado de VEs ligados \u00e0 rede). A Figura 5 mostra a carga vista pelo \n\ntransformador de distribui\u00e7\u00e3o num cen\u00e1rio descontrolado e num cen\u00e1rio controlado com m\u00e9dia \n\npenetra\u00e7\u00e3o de carregamento de VEs.  \n\n  \nFigura 5 - Compara\u00e7\u00e3o do impacto dos diferentes m\u00e9todos de carregamento no diagrama de carga [49] \n\n\u00c9 vis\u00edvel que o carregamento descontrolado conduz a um aumento substancial no ponta de \n\ncarga chegando quase aos 200 kW (para o cen\u00e1rio de m\u00e9dia penetra\u00e7\u00e3o). Com carregamento \n\ncoordenado esta ponta reduz-se para menos de metade. No algoritmo local (QP1) e no algoritmo \n\nbaseado no sistema multi-agente (MAS) os resultados foram muito similares: 53,84% e 53,19%, \n\nrespetivamente. No m\u00e9todo iterativo (QP2) e centralizado (QP3) a redu\u00e7\u00e3o da ponta foi \n\nligeiramente superior atingindo os 58,73%. \u00c9 de notar que, com estes dois \u00faltimos dois m\u00e9todos, \n\na ponta m\u00e1xima n\u00e3o ultrapassou o valor do cen\u00e1rio original em que n\u00e3o existem VEs a carregar \n\nnessa rede. O m\u00e9todo local apenas remove 92% da ponta adicional, pois apenas considera a ponta \n\nde cada casa individualmente, movendo o carregamento para um per\u00edodo fora da ponta dessa casa, \n\nmas que pode n\u00e3o ser compat\u00edvel com as casas vizinhas. O m\u00e9todo baseado no mercado de energia \n\ntamb\u00e9m sofre do mesmo problema eliminando apenas 90,64% da ponta no caso do cen\u00e1rio \n\ninterm\u00e9dio.  \n\n\n\n 18 \n\nOutro fator importante \u00e9 a varia\u00e7\u00e3o do perfil de carga pois influencia o despacho das centrais \n\nde produ\u00e7\u00e3o. Idealmente, quanto menor a varia\u00e7\u00e3o melhor o ser\u00e1 o perfil sendo esta varia\u00e7\u00e3o \n\ncalculada atrav\u00e9s do desvio m\u00e1ximo e m\u00ednimo do diagrama. Comparando com o cen\u00e1rio de \n\ncarregamento descontrolado, todos os algoritmos melhoram a estabilidade do perfil, no entanto, \n\nverifica-se uma grande diferen\u00e7a entre o m\u00e9todo baseado num mercado MAS e os que utilizam \n\nprograma\u00e7\u00e3o quadr\u00e1tica. Dentro destes \u00faltimos, como seria de esperar, \u00e9 com o algoritmo \n\ncentralizado que se consegue um melhor perfil, visto haver um maior leque de informa\u00e7\u00f5es que \n\npodem ser utilizadas para assegurar a coordena\u00e7\u00e3o. O MAS reduziu a varia\u00e7\u00e3o em 34,91%, \n\nenquanto que o CCC, reduziu em 60,50%.  \n\nEm suma, as abordagens baseadas em programa\u00e7\u00e3o quadr\u00e1tica s\u00e3o superiores, em termos de \n\ncontrolo da ponta de procura e varia\u00e7\u00e3o no perfil de carga, \u00e0s que usam sistemas multi-agente. Em \n\ncontrapartida, as que utilizam um MAS requerem menos conhecimentos, s\u00e3o mais f\u00e1ceis de \n\nimplementar e de adaptar para diferentes objetivos. Assim, se o objetivo for apenas limitar a ponta \n\nde procura, o MAS pode ser suficiente. Se a varia\u00e7\u00e3o do perfil de carga for relevante, j\u00e1 ser\u00e1 \n\nnecess\u00e1rio optar por um m\u00e9todo iterativo ou global. \n\nEm [53], foi realizado um estudo, usando tamb\u00e9m programa\u00e7\u00e3o quadr\u00e1tica, para resolver o \n\nproblema de otimiza\u00e7\u00e3o de forma a comparar algoritmos de CCC e de CCL. As principais \n\nconclus\u00f5es obtidas das simula\u00e7\u00f5es provam que as abordagens baseadas em CCC fazem um melhor \n\nuso das capacidades da rede e conseguem um melhor controlo de tes\u00e3o visto toda a informa\u00e7\u00e3o ser \n\nconhecida pelo controlador central. Em contrapartida, o CCC necessita uma infraestrutura de \n\ncomunica\u00e7\u00e3o significante confrontado com m\u00e9todos CCL. \n\nOs autores de [54] comparam tamb\u00e9m v\u00e1rios m\u00e9todos de controlo de carregamento com o \n\nobjetivo de otimizar o custo de produ\u00e7\u00e3o de energia el\u00e9trica. Os resultados das simula\u00e7\u00f5es \n\nmostraram que a melhor solu\u00e7\u00e3o, em termos de custo, \u00e9 obtida atrav\u00e9s de carregamento \n\ncentralizado, mas o CCL, conseguiu obter resultados igualmente satisfat\u00f3rios. Assim sendo, os \n\nautores conclu\u00edram que o m\u00e9todo CCL \u00e9 prefer\u00edvel uma vez que consegue bons resultados, requer \n\nmenos capacidade de comunica\u00e7\u00e3o e, muito importante, tem uma maior aceita\u00e7\u00e3o por parte dos \n\nconsumidores devido \u00e0 maior privacidade face a um CCC. \n\nColocados todos estes estudos em cima da mesa e fazendo uma an\u00e1lise geral, \u00e9 vis\u00edvel a \n\nsuperioridade do CCC face ao CC iterativo, CCL e MAS no entanto, poder\u00e1 n\u00e3o ser a melhor \n\nsolu\u00e7\u00e3o em alguns cen\u00e1rios. O CCC peca a n\u00edvel de custo de implementa\u00e7\u00e3o, privacidade e \n\ncomplexidade de funcionamento e comunica\u00e7\u00e3o. Outro fator importante \u00e9 o n\u00edvel de penetra\u00e7\u00e3o \n\nde VEs, pois em caso de ser reduzido, qualquer m\u00e9todo apresenta solu\u00e7\u00f5es v\u00e1lidas, j\u00e1 para alta \n\npenetra\u00e7\u00e3o uma arquitetura centralizada \u00e9 a melhor solu\u00e7\u00e3o de modo a tirar proveito e otimizar a \n\nrede.  \n\n\n\n 19 \n\nDado que em Portugal o n\u00famero de VEs ainda \u00e9 muito reduzido quando comparado com o \n\ntotal existente n\u00e3o ser\u00e1 necess\u00e1rio recorrer a algoritmos centralizados de modo a ter bons \n\nresultados. Como observado anteriormente, para n\u00edveis de baixa penetra\u00e7\u00e3o o CCC \u00e9 id\u00eantico ao \n\nCC iterativo o que nos leva a optar pelo segundo n\u00e3o s\u00f3 pelos resultados como tamb\u00e9m pela \n\nsimplicidade face ao primeiro. Notar ainda que este \u00e9 mais eficaz que o CCL afirmando ainda mais \n\na escolha do m\u00e9todo iterativo. \n\nDe modo a complementar este trabalho e ter um outro m\u00e9todo de compara\u00e7\u00e3o, ser\u00e1 tamb\u00e9m \n\nelaborado um algoritmo que recorra a um MAS, ou seja, ir\u00e1 coordenar os VEs tendo como base o \n\npre\u00e7o da energia el\u00e9trica.   \n\n\n\n 20 \n\n \n\n4 Problema \n\n4.1 Excesso de produ\u00e7\u00e3o de energia \nPara combater as mudan\u00e7as clim\u00e1ticas e cumprir objetivos ambientais \u00e9 natural o crescimento \n\ndas energias renov\u00e1veis. Portugal n\u00e3o foge \u00e0 exce\u00e7\u00e3o e j\u00e1 conta com uma capacidade de produ\u00e7\u00e3o \n\nde renov\u00e1veis de 13036 MW de um total de 19518 MW instalada (dados referentes a finais de \n\n2016). Portugal \u00e9 assim um dos pa\u00edses da Uni\u00e3o Europeia que consome mais energia proveniente \n\nde fontes renov\u00e1veis tendo este consumo chegado aos 57% em 2016 [55]. \n\nTodavia, parte desta gera\u00e7\u00e3o renov\u00e1vel n\u00e3o \u00e9 totalmente control\u00e1vel. Um exemplo disso \u00e9 o \n\nsector e\u00f3lico que conta com uma capacidade instalada de 5046 MW. No dia 2 de janeiro de 2017 \n\na REN registou um valor m\u00e1ximo instant\u00e2neo de 4532 MW, no entanto h\u00e1 dias em que n\u00e3o se \n\nverifica uma ter\u00e7a parte deste valor. Este desvio d\u00e1 origem a excessos de produ\u00e7\u00e3o em dias muito \n\nventosos que coincidam com dias de elevada produ\u00e7\u00e3o h\u00eddrica ou quando o consumo \u00e9 baixo. \n\nEsta situa\u00e7\u00e3o \u00e9 muito comum e, apesar dos v\u00e1rios incentivos de desvios de carga para \n\nper\u00edodos noturnos, como tarifas bi-hor\u00e1rias, o excesso de energia ir\u00e1 ocorrer cada vez mais devido \n\nao aumento futuro de gera\u00e7\u00e3o renov\u00e1vel. Adicionalmente, atualmente a energia \u00e9 sempre paga ao \n\nprodutor a um pre\u00e7o pr\u00e9-definido e, num cen\u00e1rio onde a produ\u00e7\u00e3o \u00e9 superior \u00e0 procura, o pre\u00e7o de \n\nvenda da energia tende para zero provocando um d\u00e9fice no sistema [56].  \n\n \n\n4.2 Exporta\u00e7\u00e3o e armazenamento \nQuando n\u00e3o \u00e9 poss\u00edvel consumir a totalidade da gera\u00e7\u00e3o os gestores dos SEE deparam-se \n\ncom dificuldades para os manterem est\u00e1veis e dentro dos par\u00e2metros de funcionamento. \n\nGeralmente o excesso de produ\u00e7\u00e3o em Portugal deve-se a n\u00edveis elevados de energia e\u00f3lica e \n\nh\u00eddrica. Como tais recursos n\u00e3o variam substancialmente entre Portugal e Espanha, quando h\u00e1 \n\nexcesso num pa\u00eds, por norma tamb\u00e9m h\u00e1 no outro. Esta realidade impossibilita a exporta\u00e7\u00e3o de \n\ngrandes quantidades de energia visto que Espanha \u00e9 o \u00fanico potencial importador de Portugal.  \n\nUma outra alternativa para mitigar este excesso \u00e9 armazenando a energia recorrendo a \n\nbombagem. As centrais hidroel\u00e9tricas, equipadas com bombagem, permitem usar o excesso de \n\nprodu\u00e7\u00e3o e\u00f3lica. Em per\u00edodos de menor consumo do dia, e de grande produ\u00e7\u00e3o e\u00f3lica, esta energia \n\npode ser aproveitada para bombear a \u00e1gua das albufeiras para posterior turbinamento nas horas de \n\nponta. Desse modo, \u00e9 poss\u00edvel a sua reutiliza\u00e7\u00e3o para produzir nova energia hidroel\u00e9trica em \n\nper\u00edodos mais rent\u00e1veis. Isto permite um melhor aproveitamento de projetos e\u00f3licos e h\u00eddricos nas \n\n\n\n 21 \n\ncentrais que disponham do sistema de bombagem, assegurando uma complementaridade h\u00eddrica-\n\ne\u00f3lica, tal como \u00e9 apresentado na Figura 6. \n\n \n\n \nFigura 6 \u2013 Complementaridade H\u00eddrica [57]  \n\nA grande capacidade de armazenamento com um arranque r\u00e1pido que estas centrais possuem \n\ntamb\u00e9m \u00e9 um aspeto positivo, sendo poss\u00edvel entrarem em servi\u00e7o em poucos minutos quando se \n\nverifica per\u00edodos de aumento de consumos. No entanto, os locais para a constru\u00e7\u00e3o destas centrais \n\ns\u00e3o limitados, requer custos iniciais elevados assim como o tempo de constru\u00e7\u00e3o e h\u00e1 perdas \n\ninerentes ao processo de armazenamento [58]. \n\nA bombagem em Portugal conta com uma pot\u00eancia instalada de 2437 MW. Em 2016 \n\nconsumiram 1519 GWh dos quais se reaproveitaram 1217 GWh [55]. A Figura 7 apresenta o \n\ndiagrama de consumo total do dia 2 de janeiro de 2017 onde se pode verificar o excesso de \n\nprodu\u00e7\u00e3o principalmente devido \u00e0 e\u00f3lica. De salientar que, das 00:00H at\u00e9 por volta das 11:00H, \n\nse realizou bombagem que teve uma ponta m\u00e1xima de 1823 MW e um consumo de 8,6 GWh, mais \n\n2,8 GWh do que no dia hom\u00f3logo do ano anterior. \n\n\n\n 22 \n\n \nFigura 7 - Diagrama de consumo total para o dia 2 de janeiro de 2017 (Fonte REN)\t\n\n4.3 Ve\u00edculos el\u00e9tricos como complemento \nNo futuro, os carregamentos inteligentes ser\u00e3o necess\u00e1rios de modo a prevenir pontas de \n\nprocura elevadas e outras adversidades. Se esse problema for aliado ao excesso de energia, pode-\n\nse colmatar v\u00e1rias quest\u00f5es com apenas uma solu\u00e7\u00e3o. Assim, com o carregamento coordenado de \n\nVEs focado no aproveitamento do excesso de energia renov\u00e1vel, n\u00e3o s\u00f3 se reduz as pontas de \n\nprocura, como tamb\u00e9m as emiss\u00f5es de CO2, aumenta-se a qualidade da energia nos SEE, \n\nequilibram-se os diagramas de carga e consegue-se reduzir os custos de carregamento das baterias \n\ndos VEs. \n\nUm estudo feito em Portugal em 2011 [59], concluiu que os portugueses viajam uma m\u00e9dia de \n\n30 km por dia o que, admitindo um consumo vari\u00e1vel entre 0,10 e 0,2 kWh/km [38] d\u00e1 uma m\u00e9dia \n\ndi\u00e1ria de 3 - 6 kWh por dia ou aproximadamente 1096 \u2013 2192 kWh por ano caso essa pessoa \n\ncircule num VE. Aliando a bombagem realizada em 2016 (1519 GWh) ao balan\u00e7o das exporta\u00e7\u00f5es \n\n(5085 GW) [55] \u00e9 poss\u00edvel calcular que essa energia (6604 GWh) daria para entre 3 e 6 milh\u00f5es \n\nde VEs circularem durante um ano (admitindo a m\u00e9dia portuguesa de 30 km/dia). Notar que, \n\napenas a bombagem, daria para 0,7 a 1,4 milh\u00f5es de VEs enquanto que a exporta\u00e7\u00e3o daria para \n\n2,3 a 4,6 milh\u00f5es de VEs. \n\nSegundo a Associa\u00e7\u00e3o do Com\u00e9rcio Autom\u00f3vel de Portugal (ACAP), em 2015 existiam \n\naproximadamente 4,5 milh\u00f5es de ve\u00edculos em circula\u00e7\u00e3o em Portugal o que significa que, num \n\ncen\u00e1rio ut\u00f3pico em que a penetra\u00e7\u00e3o de VE fosse 100%, a energia exportada atualmente em \n\nconjunto com a utilizada em bombagem em Portugal j\u00e1 seria suficiente para satisfazer as \n\ndesloca\u00e7\u00f5es dos portugueses.   \n\n\n\n 23 \n\nSegundo a Associa\u00e7\u00e3o de Utilizadores de Ve\u00edculos El\u00e9tricos (UVE), existem atualmente cerca \n\nde 5500 VE em Portugal (dando um consumo m\u00e9dio anual entre 6028 MWh e 12056 MWh). Esta \n\nalternativa seria um bom complemento \u00e0 bombagem e prefer\u00edvel \u00e0 exporta\u00e7\u00e3o uma vez que, os \n\npre\u00e7os s\u00e3o, geralmente, mais baixos do que os de comercializa\u00e7\u00e3o.  \n\n \n\n \n\n  \n\n\n\n 24 \n\n \n\n5 Descri\u00e7\u00e3o do Algoritmo \n\nA maioria dos utilizadores de VEs carrega o seu ve\u00edculo durante a noite para se poder deslocar \n\nno dia seguinte. A sua rotina passa por chegar a casa e ligar o ve\u00edculo \u00e0 rede da mesma maneira \n\nque faz com o seu telem\u00f3vel. O problema \u00e9 que um VE \u00e9 uma carga que pode consumir at\u00e9 dezenas \n\nde kWh e pode ter um grande impacto quando se pretende carregar milhares ao mesmo tempo. \n\nAlguns utilizadores mais avan\u00e7ados j\u00e1 possuem sistemas que apenas carregam o VE em per\u00edodos \n\nonde a energia \u00e9 mais barata. No entanto, esses sistemas n\u00e3o t\u00eam em aten\u00e7\u00e3o as necessidades dos \n\nSEE podendo at\u00e9 ser ainda mais prejudicial do que iniciar o carregamento imediatamente ao chegar \n\na casa, pois podem originar picos de procura devido \u00e0 simultaneidade do inicio do carregamento. \n\nFavoravelmente, este trabalho tem como um dos objetivos o aproveitamento do excesso de energia \n\nrenov\u00e1vel, que se verifica principalmente no per\u00edodo noturno coincidente com a maioria dos \n\ncarregamentos residenciais dos VEs.  \n\nUm estudo realizado em novembro de 2016 pela Universidade de Michigan [60] analisou as \n\nprefer\u00eancias de um grupo de 542 utilizadores norte-americanos de VEs do qual se concluiu que:  \n\n\u2022 73,1% dos inquiridos preferem um carregamento otimizado em detrimento do \n\ncarregamento n\u00e3o inteligente convencional; \n\n\u2022 65,3% dos inquiridos preferem um algoritmo de gest\u00e3o que d\u00ea prioridade \u00e0s energias \n\nrenov\u00e1veis, em detrimento de uma otimiza\u00e7\u00e3o apenas para redu\u00e7\u00e3o de custos e gest\u00e3o da \n\nprocura de energia. \n\nDado que com este trabalho se pretende conseguir uma redu\u00e7\u00e3o de custos de carregamento, \n\nfazendo o aproveitamento de energias renov\u00e1veis, calculasse que teria uma forte aceita\u00e7\u00e3o por \n\nparte dos consumidores. \n\n \n\n5.1 Objetivos \nO objetivo primordial deste algoritmo \u00e9 o de alocar a carga dos VEs para as horas com \n\nexcesso de produ\u00e7\u00e3o de energia proveniente de fontes renov\u00e1veis. Essas horas, geralmente, \n\ncoincidem com o per\u00edodo de menor consumo, sendo assim tamb\u00e9m um per\u00edodo onde o pre\u00e7o da \n\nenergia no mercado \u00e9 mais barato. Assim, consegue-se tr\u00eas benef\u00edcios principais: \n\n1. Aproveitar ao m\u00e1ximo o excesso de energia renov\u00e1vel; \n\n2. Reduzir os custos associados ao carregamento de VE; \n\n3. Otimizar o diagrama de carga nacional. \n\n \n\n\n\n 25 \n\n5.2  Dados necess\u00e1rios \n\n5.2.1 Previs\u00e3o da produ\u00e7\u00e3o e consumo energia \nAntes de qualquer c\u00e1lculo feito pelo algoritmo ser\u00e1 necess\u00e1rio possuir alguns dados \n\nantem\u00e3o, nomeadamente a previs\u00e3o do excesso de energia. Para tal ser\u00e1 necess\u00e1rio recolher \n\ninforma\u00e7\u00e3o da previs\u00e3o da produ\u00e7\u00e3o de energia dispon\u00edvel em [61] e do consumo esperado \n\ndispon\u00edvel em [62] (Sistema de Informa\u00e7\u00e3o de Mercados de Energia REN). No entanto, apesar de \n\nexistir previs\u00e3o com v\u00e1rios dias de anteced\u00eancia, a REN s\u00f3 disponibiliza nos seus sites a previs\u00e3o \n\nhor\u00e1ria. Como tal, para efeitos de simula\u00e7\u00e3o, ser\u00e3o usados dados de dias passados, para os quais \n\nse tem toda a informa\u00e7\u00e3o do que se consumiu e o que se produziu detalhadamente. Os dados \n\nrecolhidos v\u00eam em modo tabela, dispon\u00edveis em [63], onde existe toda a informa\u00e7\u00e3o com \n\nestat\u00edsticas di\u00e1rias, com a qual \u00e9 poss\u00edvel calcular o excesso de energia dispon\u00edvel ficando com o \n\naspeto da Figura 8. Estes dados permitir\u00e3o executar o algoritmo com o objetivo de aproveitar ao \n\nm\u00e1ximo o excesso de energia renov\u00e1vel. \n\n \n\n \nFigura 8 - Diagramas de energia dos dias 2 e 3 de fevereiro de 2017 \n\n \n\n5.2.2 Pre\u00e7o da energia \nSimultaneamente, ser\u00e1 necess\u00e1rio saber o pre\u00e7o da energia durante cada hora do dia. Com \n\nesta informa\u00e7\u00e3o, o algoritmo passa a ter como principal objetivo reduzir os custos de carregamento \n\npara os utilizadores e n\u00e3o o aproveitamento do excesso de energia renov\u00e1vel. Na pr\u00e1tica, visto em \n\n\n\n 26 \n\nPortugal ainda n\u00e3o existir uma tarifa em tempo real dos pre\u00e7os, a rede disponibilizar\u00e1 o tipo de \n\ntarif\u00e1rio que cada utilizador possui de modo a saber o pre\u00e7o da energia.  \n\nSegundo c\u00e1lculos da Entidade Reguladora do Sector Energ\u00e9tico (ERSE), o ponto de \n\nequil\u00edbrio entre o que se paga a menos na hora de vazio do mercado regulado e a mais fora desse \n\nper\u00edodo \u00e9 atingido quando o consumo no primeiro per\u00edodo fica acima de 36% do total, ou seja, se \n\no consumo nas horas de vazio for superior a esta percentagem, o cliente tem vantagens na tarifa \n\nbi-hor\u00e1ria. J\u00e1 se for inferior, \u00e9 mais vantajoso passar para a tarifa simples.  \n\nDe acordo com dados recentes da (ERSE), o consumo m\u00e9dio anual de eletricidade de um \n\ncliente dom\u00e9stico portugu\u00eas em baixa tens\u00e3o normal aproxima-se dos 2500 kWh. Assumindo uma \n\nm\u00e9dia anual de consumo de um VE de 1644 kWh (m\u00e9dia do consumo calculado em 4.3), e que o \n\nutilizador n\u00e3o desloca mais nenhum consumo para per\u00edodos de vazio sem ser o carregamento do \n\nVE calcula-se que este per\u00edodo represente cerca de 40% do consumo total. Posto isto, \u00e9 necess\u00e1rio \n\nque o utilizador de VE tenha, no m\u00ednimo, tarifa bi-hor\u00e1ria de modo a aumentar as suas poupan\u00e7as. \n\nO algoritmo receber\u00e1, da rede, informa\u00e7\u00f5es do tipo de tarifa do utilizador, contendo o pre\u00e7o \n\nda energia em cada hora. Para al\u00e9m do aproveitamento do excesso de renov\u00e1vel, ir\u00e1 ser analisado \n\num cen\u00e1rio em que se possua bi-hor\u00e1ria e, dado que a tend\u00eancia \u00e9 para que no futuro as tarifas \n\nsejam tempo real, ser\u00e1 tamb\u00e9m analisado um cen\u00e1rio de tarifa em tempo real tendo em conta a \n\nvaria\u00e7\u00e3o dos pre\u00e7os do Mercado Ib\u00e9rico de Eletricidade (MIBEL).  O pre\u00e7o da energia, como j\u00e1 \n\nreferido anteriormente, \u00e9 baseado no MIBEL, no entanto, esse pre\u00e7o n\u00e3o \u00e9 o real pago pelos \n\nconsumidores finais, uma vez que n\u00e3o tem em conta custos de transporte, distribui\u00e7\u00e3o, margens \n\nde lucro, etc. Assim, para se ter valores mais realistas, utilizou-se a varia\u00e7\u00e3o da tarifa do MIBEL \n\nmas multiplicada por um fator que a relaciona com o pre\u00e7o final. Considerando uma tarifa bi-\n\nhor\u00e1ria esta tem atualmente um pre\u00e7o m\u00e9dio, j\u00e1 com IVA, de 0,1913 \u20ac/kWh [64]. Dividindo 0,1913 \n\npelo pre\u00e7o m\u00e9dio MIBEL tem-se um fator entre 4 e 5 (dependendo dos dias), o que significa que \n\nos utilizadores v\u00e3o pagar 4 a 5 vezes mais do que o valor anunciado no MIBEL. \n\n \n\n5.2.3 Estado do VE \nPosteriormente, a saber a energia dispon\u00edvel e o seu pre\u00e7o, \u00e9 necess\u00e1rio saber os dados dos \n\nVEs que se pretende carregar. Do lado do VE ser\u00e1 necess\u00e1rio recolher a capacidade da bateria do \n\nve\u00edculo (em kWh) e o seu SOC atual. Adicionalmente, o utilizador dever\u00e1 introduzir a pot\u00eancia do \n\ncarregador (em kW), o SOC desejado e a hora a que pretende esse SOC.  \n\nO SOC desejado ir\u00e1 estar por defeito a 100%, no entanto, caso o utilizador n\u00e3o pretender \n\na totalidade da bateria, ir\u00e1 ter a possibilidade de alterar este par\u00e2metro. \n\nA hora prevista de sa\u00edda ir\u00e1 ser introduzida pelo utilizador tendo espa\u00e7amentos de 15 \n\nminutos. Ao introduzir a hora pretendida a que o SOC esteja no n\u00edvel desejado o SCA ir\u00e1 averiguar \n\n\n\n 27 \n\nse esse valor \u00e9 poss\u00edvel. Caso n\u00e3o seja poss\u00edvel, dever\u00e1 alertar o utilizador e indicar duas \n\nalternativas poss\u00edveis: \n\n1. A hora em que \u00e9 poss\u00edvel ter esse SOC; \n\n2. O SOC que \u00e9 poss\u00edvel ter \u00e0 hora prevista de sa\u00edda. \n\nTodos os dados introduzidos pelo utilizador ser\u00e3o automaticamente guardados para que, \n\nda pr\u00f3xima vez, seja um procedimento mais r\u00e1pido n\u00e3o tendo de voltar a introduzir tudo \n\nnovamente. Ex.: caso o utilizador precise sempre de 100% da bateria \u00e0s 8h00, n\u00e3o ter\u00e1 necessidade \n\nde estar sempre a colocar os mesmos dados, o SCA ir\u00e1 informar e perguntar ao utilizador se \n\npretende alterar os dados da \u00faltima sess\u00e3o. \n\nEm qualquer momento o utilizador pode cancelar o carregamento inteligente. Caso o \n\nutilizador se engane a introduzir os dados poder\u00e1 cancelar o agendamento, introduzir novamente \n\nos dados e dar reentrada no sistema. \n\n \n\n5.3 Equipamentos necess\u00e1rios \n\n5.3.1 Sistema de Controlo Auxiliar \nAdmite-se que os ve\u00edculos possuem um Sistema de Controlo Auxiliar (SCA) com \n\ncapacidade de comunica\u00e7\u00e3o bilateral que envia dados do ve\u00edculo e recebe ordens do Sistema de \n\nControlo Central (SCC) para iniciar o carregamento, pelo que, o SCA dever\u00e1 ter as seguintes \n\nfuncionalidades: \n\n\u00a7 Capacidade de avalia\u00e7\u00e3o do VE, isto \u00e9, tem de conseguir recolher os seguintes dados \n\nde informa\u00e7\u00e3o do VE: \n\n\u2022 SOC da bateria (0 \u2013 100%); \n\n\u2022 Capacidade da bateria (em kWh). \n\n\u00a7 Tem de ter a possibilidade de introdu\u00e7\u00e3o dos seguintes dados: \n\n\u2022 Tipo de carregamento (normal ou inteligente); \n\n\u2022 Hora prevista de partida (em intervalos de 15 mim). \n\n\u2022 SOC desejado (em %); \n\n\u2022 Pot\u00eancia do carregador (em kW); \n\nTodos os dados devem ser, posteriormente, enviados ao SCC de modo a que se proceda \n\naos c\u00e1lculos do per\u00edodo de carregamento. \n\n \n\n\n\n 28 \n\n5.3.2 Sistema de Controlo Central \nO SCC \u00e9 um dispositivo que recebe informa\u00e7\u00f5es de todos os VE ligados ao sistema e \n\ncalcula em tempo real o melhor hor\u00e1rio de carregamento para cada VE individualmente e de forma \n\niterativa, tendo em conta os seguintes aspetos: \n\n\u2022 Excesso de produ\u00e7\u00e3o de energia renov\u00e1vel; \n\n\u2022 Custo da energia a cada hora; \n\n\u2022 Dados dos VEs. \n\n \n\n5.4 Funcionamento do algoritmo \nPara executar o algoritmo o utilizador tem apenas de correr o ficheiro Algoritmo.m (Anexo \n\nA - Algoritmo.m). Este ir\u00e1, conforme necess\u00e1rio, executar outros ficheiros auxiliares de modo a \n\nter todos os dados necess\u00e1rios para realizar os c\u00e1lculos finais dos per\u00edodos de carregamento de \n\ncada ve\u00edculo. \n\nA Tabela 2 \u00e9 um resumo dos dados necess\u00e1rios para o algoritmo calcular o per\u00edodo de \n\ncarregamento ideal para um determinado VE. \n\n \nTabela 2 \u2013 Dados necess\u00e1rios ao algoritmo \n\nDados necess\u00e1rios ao algoritmo \nIntroduzidos pelo utilizador Recolhidas pelo SCA Necess\u00e1rias ao SCC \nPot\u00eancia do carregador (P) Capacidade da bateria (C) \n\n \nExcesso de produ\u00e7\u00e3o de energia \nrenov\u00e1vel \n\nEstado de carga desejado (SOCd) Estado de carga atual (SOCa) Custo da energia a cada hora \n \n\nHora prevista de Sa\u00edda (HPS)  Dados dos VEs (introduzidos pelo \nutilizador e recolhidos pelo SCA \n\n  Hora atual (H) \n\n \n\nO SCC garantir\u00e1, se poss\u00edvel, que todas as prefer\u00eancias dos utilizadores dos VEs \n\nrelativamente a SOC final e hora sejam satisfeitos. Como \u00e9 vis\u00edvel na Figura 8, a janela do \n\nalgoritmo ser\u00e1 de 2 dias divididas em intervalos de 15 mim tendo assim, no total, 192 per\u00edodos \n\nposs\u00edveis de carregamento. De modo a clarificar, o fluxograma do SCC ser\u00e1 independente do SCA, \n\nsendo apresentados e explicados na pr\u00f3xima sec\u00e7\u00e3o. \n\nA Figura 9 apresenta o fluxograma do funcionamento do SCA e a Figura 10 apresenta o \n\nfluxograma do funcionamento do SCC.  \n\n\n\n 29 \n\n \nFigura 9 - Fluxograma do SCA \n\n \n\n\n\n 30 \n\n \nFigura 10 - Fluxograma do SCC \n\n \n\n5.4.1 Entrada de dados \nO algoritmo recebe a previs\u00e3o da gera\u00e7\u00e3o e do consumo de energia e analisa esses dados \n\nde modo a obter a curva do excesso de gera\u00e7\u00e3o renov\u00e1vel, como demonstrado na Figura 8. Estes \n\ndados poder\u00e3o ser editados no ficheiro Previsao.m (Anexo B - Previsao.m) onde \u00e9 poss\u00edvel \n\nadicionar outros cen\u00e1rios de simula\u00e7\u00e3o. Para tal bastar aceder ao site do Centro de Informa\u00e7\u00e3o da \n\nREN [63], escolher um dia, fazer o download do respetivo ficheiro Excel e o algoritmo ir\u00e1 \n\nautomaticamente recolher os dados e calcular o excesso de energia renov\u00e1vel. Nesse ficheiro, \u00e9 \n\ntamb\u00e9m necess\u00e1rio colocar a informa\u00e7\u00e3o do pre\u00e7o da energia a cada hora do MIBEL o qual est\u00e1 \n\ndispon\u00edvel em [65] e o pre\u00e7o de uma tarifa bi-hor\u00e1ria [64], no caso de se querer simular um cen\u00e1rio \n\ncom esses pre\u00e7os. Uma vez que a informa\u00e7\u00e3o do pre\u00e7o da energia \u00e9 hor\u00e1ria, esses valores ser\u00e3o \n\n\n\n 31 \n\nadaptados para serem trabalhados n\u00e3o num formato de 24 pontos por dia, mas sim 96 (para se ter \n\nintervalos de 15 mim) e, posteriormente, associados numa vari\u00e1vel de 192 pontos, equivalente a \n\ndois dias.  \n\nPosteriormente, o algoritmo ir\u00e1 carregar uma lista de VEs no ficheiro ListaVE.m (Anexo \n\nC - ListaVE.m), no qual \u00e9 poss\u00edvel editar ou adicionar ve\u00edculos a serem carregados. A lista \u00e9 uma \n\nmatriz que possui todas as informa\u00e7\u00f5es necess\u00e1rias ao agendamento. Nesse ficheiro \u00e9 ainda \n\ncalculado, aleatoriamente, um SOCa e uma pot\u00eancia do carregador de modo a tornar a amostra \n\nvari\u00e1vel simulando utilizadores humanos como ser\u00e1 analisado, posteriormente com mais detalhe, \n\nna sec\u00e7\u00e3o 6.1. \n\nNa pr\u00e1tica, o utilizador ao chegar \u00e0 sua resid\u00eancia, colocar\u00e1 o VE ligado ao SCA que, por \n\nsua vez, est\u00e1 ligado \u00e0 rede e ao SCC. O primeiro passo ser\u00e1 a escolha entre um carregamento \n\n\u201cNormal\u201d e \u201cInteligente\u201d como vis\u00edvel na  Figura 9. Caso opte pelo \u201cNormal\u201d o VE ir\u00e1 iniciar \n\nimediatamente o carregamento e s\u00f3 vai terminar quando estiver totalmente carregado ou quando \n\no utilizador interromper o carregamento. Na op\u00e7\u00e3o \u201cInteligente\u201d ser\u00e1 pedido ao utilizador que \n\nintroduza os dados necess\u00e1rios (P, HPS, SOCd). Simultaneamente, o SCA faz uma an\u00e1lise do \n\nestado do ve\u00edculo recolhendo os dados do VE (C, SOCa) e enviando-os ao SCC, juntamente com \n\nas prefer\u00eancias do utilizador. O algoritmo ir\u00e1 simular sempre os dois cen\u00e1rios, normal e inteligente, \n\nde modo a ter uma compara\u00e7\u00e3o final da sua efic\u00e1cia. \n\n \n\n5.4.2 Agendamento \nAp\u00f3s receber toda a informa\u00e7\u00e3o necess\u00e1ria, o SCC, ir\u00e1 proceder ao c\u00e1lculo para determinar \n\nquando um ve\u00edculo dever\u00e1 carregar.  \n\nDado que se ir\u00e1 trabalhar apenas com carregamentos residenciais a pot\u00eancia do carregador \n\nser\u00e1 muito inferior \u00e0quela verificada num posto de carregamento p\u00fablico. Isto tr\u00e1s benef\u00edcios no \n\nque diz respeito \u00e0 simplicidade uma vez que, tal como demonstrado em [66], a baixa pot\u00eancia, a \n\nenergia consumida por uma bateria durante a fase de carregamento de um VE \u00e9 constante \n\nfacilitando assim o c\u00e1lculo da dura\u00e7\u00e3o do tempo de carregamento em fun\u00e7\u00e3o do SOC e da pot\u00eancia \n\ndo carregador. Posto isto, como se trata de um carregamento com uma pot\u00eancia constante, basta \n\nexecutar a Equa\u00e7\u00e3o 1 obtendo assim o tempo em horas necess\u00e1rio at\u00e9 atingir o SOC desejado. \n\n \n\n! =\t$%&amp;' ? $%&amp;)* \u00d7\t&amp;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(1) \n\n \n\nEm segundo lugar, ir\u00e1 calcular quanto tempo o VE tem dispon\u00edvel para carregar e verificar se \n\nesse tempo \u00e9 suficiente executando a condi\u00e7\u00e3o demonstrada pela Equa\u00e7\u00e3o 2. \n\n\n\n 32 \n\n \n\n\t/*$ ? / > !\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(2) \n \n\nCaso demore mais tempo a carregar do que aquele que tem dispon\u00edvel ir\u00e1 ser apresentada uma \n\nmensagem de erro ao utilizador com a informa\u00e7\u00e3o da percentagem do SOC da bateria \u00e0 hora \n\nprevista de sa\u00edda introduzida e a hora a que estar\u00e1 dispon\u00edvel o SOC desejado. Se o ve\u00edculo tiver \n\ntempo necess\u00e1rio para o carregamento pretendido ir-se-\u00e1 dar in\u00edcio ao algoritmo principal \n\nexemplificado na Figura 10. De notar que, por exemplo se a hora atual (H) for 12h do dia 2 e a \n\nhora prevista de sa\u00edda (HPS) for 8h o algoritmo ir\u00e1 assumir que, como HPS &lt;H, a HPS ser\u00e1 no \n\ndia seguinte por isso ir\u00e1 somar-lhe 24 horas ficando HPS = 32. \n\nEstes passos descritos anteriores ser\u00e3o executados no ficheiro Tempo.m (Anexo D - \n\nTempo.m) sendo a mensagem de erro e as respetivas informa\u00e7\u00f5es calculadas no ficheiro Erro.m \n\n(Anexo E \u2013 Erro.m).  No ficheiro principal, Algoritmo.m (Anexo A - Algoritmo.m), como se est\u00e1 \n\na simular dados de dias passados, foi definida uma hora H com um valor de 12, ou seja, o algoritmo \n\ninterpreta que sejam 12:00h do primeiro dia dessa simula\u00e7\u00e3o. Esse valor poder\u00e1 ser alterado pelo \n\nutilizador, no entanto, caso escolha um valor elevado (por exemplo 22), os VEs que tenham uma \n\nhora prevista de chegada no algoritmo antes das 22h ser\u00e3o considerados pelo sistema, entradas do \n\ndia seguinte podendo n\u00e3o haver tempo suficiente para carregarem pois s\u00f3 estar\u00e1 dispon\u00edvel uma \n\njanela das 22h \u00e0s 24h do segundo dia.  \n\nEm terceiro lugar, o SCC ir\u00e1 verificar a janela poss\u00edvel de carregamento e orden\u00e1-la conforme \n\no objetivo pretendido no ficheiro Janela.m (Anexo F - Janela.m): \n\n\u2022 Caso o objetivo seja o aproveitamento ao m\u00e1ximo do excesso de energia renov\u00e1vel, o \n\nalgoritmo ir\u00e1 ordenar os per\u00edodos de tempo dispon\u00edveis por ordem decrescente de \n\nexcesso; \n\n\u2022 Caso se pretenda reduzir os custos, o algoritmo ir\u00e1 ordenar os per\u00edodos de tempo por \n\nordem crescente em fun\u00e7\u00e3o do custo da energia. \n\nAp\u00f3s a ordena\u00e7\u00e3o, v\u00e3o ser atribu\u00eddos v\u00e1rios per\u00edodos de carregamento a esse VE como \n\nexemplificado na Figura 11 onde foi simulado um ve\u00edculo que chegou \u00e0s 20h ao local de \n\ncarregamento, com um SOCa de 80%, um SOCd de 100%, HPS 7h com P = 4 kW e C = 30 kWh. \n\n\n\n 33 \n\n \nFigura 11 \u2013 Informa\u00e7\u00e3o mostrada na janela de comandos do Matlab \n\nA vari\u00e1vel \u201cexcesso_adaptado_ordenado\u201d \u00e9 a lista dos per\u00edodos poss\u00edveis para o VE carregar. \n\nA primeira coluna \u00e9 a hora (em per\u00edodos de 15 mim), a segunda coluna \u00e9 o excesso de energia \n\nrenov\u00e1vel e a terceira \u00e9 o custo da energia nesse per\u00edodo (em \u20ac/MWh). Como o objetivo deste \n\nexemplo \u00e9 o aproveitamento do excesso de renov\u00e1vel, a matriz ser\u00e1 ordenada por ordem \n\ndecrescente da coluna 2. Como o VE s\u00f3 necessita de 6 per\u00edodos de um total de 43 dispon\u00edveis, \n\nlogo o algoritmo ir\u00e1 alocar os 6 primeiros per\u00edodos da lista \u201cexcesso_adaptado_ordenado\u201d a esse \n\nve\u00edculo (29, 30, 29.25, 30.25, 30.5 e 29.75), retirando 24 horas, 5h, 6h, 5:15h, 6:15h, 6:30h e 5:45h, \n\nou seja, ir\u00e1 carregar das 5h \u00e0s 5:30h e das 5:45h \u00e0s 6:45h). No fim, \u00e0 matriz inicial que contem os \n\nper\u00edodos com o respetivo excesso e custo da energia, ir-se-\u00e1 subtrair a energia que este VE ir\u00e1 \n\nconsumir de modo a ter a nova curva para efetuar com rigor os c\u00e1lculos para o pr\u00f3ximo ve\u00edculo \n\nque der entrada no sistema. Ap\u00f3s todos os c\u00e1lculos e as respetivas atribui\u00e7\u00f5es de per\u00edodos a cada \n\nVE s\u00e3o criados v\u00e1rios gr\u00e1ficos no ficheiro Plot.m (Anexo G - Plots.m), com os resultados obtidos.  \n\nDe modo a testar a efetividade dos algoritmos para cumprir o terceiro objetivo, suaviza\u00e7\u00e3o do \n\ndiagrama de carga, \u00e9 realizada uma compara\u00e7\u00e3o do antes e depois no ficheiro \n\n\n\n 34 \n\nPlotsComparativos.m (Anexo H \u2013 PlotsComparativos.m). Nesses gr\u00e1ficos poder-se-\u00e1 analisar o \n\nimpacto no diagrama de carga do carregamento de todos os ve\u00edculos. \n\nNo fim \u00e9 poss\u00edvel visualizar a lista de VEs atualizada, por ordem de chegada, e com a \n\ninforma\u00e7\u00e3o do custo de carregamento nas \u00faltimas tr\u00eas colunas da matriz dos tr\u00eas diferentes \n\nm\u00e9todos usados. Essa lista estar\u00e1 guardada na vari\u00e1vel ListaOrdenada (Anexo H \u2013 Lista VE final) \n\nonde tamb\u00e9m \u00e9 poss\u00edvel verificar o n\u00famero de per\u00edodos necess\u00e1rios ao carregamento de cada VE \n\nna oitava coluna. \n\n  \n\n\n\n 35 \n\n \n\n6 Testes e resultados \n\nNeste cap\u00edtulo ser\u00e3o testados 3 algoritmos em 2 cen\u00e1rios distintos, com 2 variantes (pre\u00e7o da \n\nenergia), dando um total de 12 simula\u00e7\u00f5es. O primeiro cen\u00e1rio ser\u00e1 um dia t\u00edpico de inverno, \n\nsimulado com dados de energia dos dias 2 e 3 de fevereiro de 2017, que foi um dia com excesso \n\nde energia renov\u00e1vel t\u00edpico desta esta\u00e7\u00e3o. Em contrapartida, de modo a simular um cen\u00e1rio oposto, \n\nrecorreu-se a dados de aproximadamente meio ano antes, nomeadamente 9 e 10 de agosto de 2016, \n\num cen\u00e1rio de ver\u00e3o em que \u00e9 dif\u00edcil haver excesso pois h\u00e1 menos produ\u00e7\u00e3o renov\u00e1vel proveniente \n\nde e\u00f3licas e as centrais hidroel\u00e9tricas ficam limitadas devido \u00e0 pouca precipita\u00e7\u00e3o. Em ambos os \n\ncasos foram executadas tr\u00eas simula\u00e7\u00f5es cada uma com um algoritmo diferente:  \n\n\u2022 a primeira com o objetivo de aproveitar ao m\u00e1ximo o excesso de renov\u00e1vel; \n\n\u2022 a segunda com o objetivo de reduzir ao m\u00e1ximo os custos de carregamento; \n\n\u2022 a terceira que simula carregamentos normais, sem usar qualquer tipo de sistema \n\ninteligente. \n\nOs 3 casos foram executados 2 vezes com pre\u00e7os de energia diferentes, um com uma tarifa \n\nbi-hor\u00e1ria e outro em fun\u00e7\u00e3o da varia\u00e7\u00e3o do pre\u00e7o do MIBEL. \u00c9 muito importante notar que ambos \n\nos cen\u00e1rios s\u00e3o referentes a dias \u00fateis e n\u00e3o a fins-de-semana, de modo a simular com coer\u00eancia o \n\ndia-a-dia dos utilizadores portugueses de VEs. \n\nCom estas simula\u00e7\u00f5es espera-se poder analisar os seguintes impactos: \n\n\u2022 Impactos que os algoritmos t\u00eam no aproveitamento de energia renov\u00e1vel e no \n\ndiagrama de carga; \n\n\u2022 Impacto no custo de carregamento da utiliza\u00e7\u00e3o de um carregamento inteligente; \n\n\u2022 Impacto no diagrama de carga de carregamentos n\u00e3o inteligentes e semi-inteligentes \n\n(agendamento do carregamento em fun\u00e7\u00e3o do custo de energia, em especial com \n\ntarifa bi-hor\u00e1ria) em que \u00e9 esperado que os ve\u00edculos comecem a carregar, \n\nsensivelmente, todos \u00e0 mesma hora, causando um pico de consumo; \n\n\u2022 Compara\u00e7\u00e3o de impactos e vantagens de um carregamento inteligente face a um \n\nsemi-inteligente e outro n\u00e3o inteligente; \n\n \n\n6.1 Dados necess\u00e1rios \nAntes da execu\u00e7\u00e3o das simula\u00e7\u00f5es \u00e9 necess\u00e1rio possuir de antem\u00e3o alguns dados de modo a \n\nemular a entrada de VEs, h\u00e1bitos dos utilizadores e as suas prefer\u00eancias. \n\n\n\n 36 \n\n  A popula\u00e7\u00e3o ser\u00e1 composta em fun\u00e7\u00e3o da percentagem dos VEs mais vendidos em Portugal \n\ntendo como base dados da Tabela 3. \n\n \nTabela 3 - Vendas de VEs em Portugal [67] \n\n\t 2011\t 2012\t 2013\t 2014\t 2015\t 2016\t 2017\t TOTAL\t\nVENDAS\t\t 210\t 161\t 224\t 362\t 1305\t 1970\t 1289\t 5521\t\n\nPERCENTAGEM\t(%)\t 3,8\t 2,9\t 4,0\t 6,6\t 23,6\t 35,7\t 23,4\t 100\t\n\n \n\nDado que, de janeiro de 2011 at\u00e9 dezembro de 2014 o n\u00famero de VE vendidos em Portugal \n\nfoi de apenas 957 unidades (correspondendo a 17,3% do total existente) e de forma a possuir uma \n\nlista de VEs modernos e mais atual principalmente a n\u00edvel de capacidade das baterias, apenas ser\u00e3o \n\ncontabilizados os VEs vendidos entre janeiro de 2015 e maio de 2017. Dessa lista, s\u00e3o \n\nconsiderados os 10 mais vendidos ficando a Tabela 4. A popula\u00e7\u00e3o de VEs ser\u00e1 ent\u00e3o constitu\u00edda \n\ntendo como base as percentagens dos VEs da Tabela 4.  \n\n \nTabela 4 - Modelos de VEs mais vendidos em Portugal [67] \n\n\t VE\u00cdCULO\t VENDAS\t %\t BATERIA\t(KWH)\t\n\n1\t Nissan Leaf 695\t 20\t 30\t\n\n2\t Mitsubishi Outlander PHEV 613\t 17\t 12\t\n\n3\t Renault Zoe 561\t 16\t 41\t\n\n4\t BMW i3 466\t 13\t 33\t\n\n5\t Mercedes C350e 461\t 13\t 6,2\t\n\n6\t Volvo V60 Plug-In 261\t 7\t 8\t\n\n7\t BMW 330e 214\t 6\t 7\t\n\n8\t Renault Twizy 100\t 3\t 6,1\t\n\n9\t BMW 225xe Active Tourer 97\t 3\t 7,6\t\n\n10\t Volkswagen Passat GTE 90\t 2\t 9\t\n\n\t Total 3558\t 100\t \t\n\n \n\nAdmitindo um consumo m\u00e9dio vari\u00e1vel entre 3 kWh e 6 kWh por dia, calculado na sec\u00e7\u00e3o \n\n4.3, foram gerados valores aleat\u00f3rios entre 3 e 6 para obter valores diferentes para o SOC atual \n\ndos VEs a carregar, tornando assim a amostra mais aleat\u00f3ria. Por defeito, o SOC desejado ser\u00e1 \n\n100%, com a possibilidade de altera\u00e7\u00e3o por parte do utilizador. \n\n\n\n 37 \n\nRelativamente \u00e0 pot\u00eancia do carregador, existe um vasto leque de carregadores dispon\u00edveis \n\ne pot\u00eancias vari\u00e1veis para promover o carregamento de um VE. Tendo em conta que o foco deste \n\ntrabalho \u00e9 em carregamentos dom\u00e9sticos ir\u00e3o ser tomados valores compreendidos entre 10 A e 32 \n\nA, o que corresponde a uma pot\u00eancia (para 230 V) de 2,3 kW a 7,36 kW. Nas simula\u00e7\u00f5es, ser\u00e3o \n\ngerados n\u00fameros aleat\u00f3rios entre 2300 e 7360 e associados \u00e0 coluna correspondente \u00e0 pot\u00eancia do \n\ncarregador. Na pr\u00e1tica, este valor ser\u00e1 inserido pelo utilizador.  \n\nA hora de entrada no sistema e hora prevista de sa\u00edda \u00e9, talvez, o passo mais dif\u00edcil de \n\nprever uma vez que depende de fatores humanos. Em contrapartida, pode-se criar um modelo \n\nbaseado nos h\u00e1bitos dos utilizadores de VEs e ter uma base s\u00f3lida tendo em conta os hor\u00e1rios mais \n\ncomuns de partida e de chegada dos utilizadores \u00e0 sua resid\u00eancia. Como base, ser\u00e1 considerado \n\num estudo heur\u00edstico realizado em Espanha em 2014 [68]. Dado que se trata de um pa\u00eds vizinho e \n\nos h\u00e1bitos socioculturais s\u00e3o semelhantes ser\u00e1 uma boa aproxima\u00e7\u00e3o do cen\u00e1rio nacional. Na \n\nFigura 12 \u00e9 apresentada a distribui\u00e7\u00e3o estat\u00edstica por hora da primeira viagem e da \u00faltima. De notar \n\nque a primeira viagem ocorre entre as 8:00h e as 10:00h, que corresponde ao inicio de um dia de \n\ntrabalho, e que a \u00faltima viagem de regresso a casa ocorre entre as 19:00h e as 24:00h. No entanto, \n\ndurante estes per\u00edodos, h\u00e1 utilizadores que se deslocam mais que uma vez podendo ser necess\u00e1rio \n\ncarregar o ve\u00edculo nesses instantes. De forma a abranger todos os cen\u00e1rios poss\u00edveis, a lista de VE \n\nusada ter\u00e1 como base a Figura 13 sendo adaptada conforme as percentagens indicadas em cada \n\nhora.  \n \n\n \nFigura 12 - Primeira e \u00faltima viagem \n\n \nFigura 13 - Viagens de e para casa \n\nDe notar que, tal como observado na Figura 8, o excesso tem o valor de pico a rondar os 1000 \n\nMW o que daria para suportar, nesse preciso instante, mais de 200 mil VEs (assumindo uma \n\npot\u00eancia m\u00e9dia constante de 5 kW e uma simultaneidade unit\u00e1ria de carregamentos). Como essa \n\nsimula\u00e7\u00e3o demoraria v\u00e1rias horas a ser executada e como esse n\u00famero ultrapassa em larga escala \n\nos 5500 VE registados em Portugal, a escala ser\u00e1 reduzida em 10 mil vezes de modo a acelerar as \n\nsimula\u00e7\u00f5es. Esse valor poder\u00e1 ser alterado no ficheiro Algoritmo.m (Anexo A - Algoritmo.m) na \n\n\n\n 38 \n\nvari\u00e1vel r. Dado que a nossa popula\u00e7\u00e3o \u00e9 de 100 VEs, a redu\u00e7\u00e3o de 10 mil vezes dos recursos \n\ndispon\u00edveis equivale, na realidade, a uma popula\u00e7\u00e3o de 1 milh\u00e3o de VEs. Este valor traduz-se num \n\ncen\u00e1rio imagin\u00e1rio de, aproximadamente, 20% de penetra\u00e7\u00e3o de VEs em Portugal. \n\n \n\n6.2 Simula\u00e7\u00e3o de inverno \nO cen\u00e1rio de inverno corresponde aos dias 2 e 3 de fevereiro de 2017. Foram dois dias \n\nbastantes ventosos e que procederam dias de alguma precipita\u00e7\u00e3o levando a que ocorresse uma \n\nelevada produ\u00e7\u00e3o de energia proveniente de fontes renov\u00e1veis, como observ\u00e1vel na Figura 8. \n\nNestes dois dias, a produ\u00e7\u00e3o total de energia foi de 435,9 GWh, da qual, com 75% com origem \n\nem fontes renov\u00e1veis. O pico de produ\u00e7\u00e3o renov\u00e1vel ocorreu no dia 3 e teve um valor de 7774 \n\nMW \u00e0s 18:45 h, onde o consumo se situava nos 7600 MW. \n\nAp\u00f3s as simula\u00e7\u00f5es, foi poss\u00edvel obter a Figura 14 e a Figura 15. Na Figura 14 s\u00e3o vis\u00edveis \n\nas 3 simula\u00e7\u00f5es (agendamento em fun\u00e7\u00e3o do excesso de renov\u00e1vel, agendamento em fun\u00e7\u00e3o do \n\ncusto da energia e agendamento n\u00e3o inteligente) usando pre\u00e7os de energia baseados na varia\u00e7\u00e3o \n\ndos pre\u00e7os do MIBEL. A Figura 15, por sua vez, mostra tamb\u00e9m os resultados das mesmas tr\u00eas \n\nsimula\u00e7\u00f5es, mas usando pre\u00e7os referentes a uma tarifa bi-hor\u00e1ria [64]. \n\n \nFigura 14 - Simula\u00e7\u00e3o de inverno (2 e 3 de fevereiro de 2017) com pre\u00e7os MIBEL \n\n \n\nEm detalhe, dada figura possui 5 sub gr\u00e1ficos (explicado do topo para baixo): \n\n1- Gr\u00e1fico do excesso de energia renov\u00e1vel antes e ap\u00f3s o carregamento dos VE, \n\nusando um algoritmo focado no aproveitamento do excesso de energia renov\u00e1vel; \n\n\n\n 39 \n\n2- Gr\u00e1fico que mostra os processos iterativos desde a curva original do excesso at\u00e9 \u00e0 \n\ncurva final, cada linha \u00e9 um carregamento de um VE; \n\n3- Gr\u00e1fico que mostra a evolu\u00e7\u00e3o do pre\u00e7o da energia ao longo do tempo; \n\n4- Gr\u00e1fico que mostra o excesso original, os processos iterativos de carregamento e \n\na curva final do excesso de energia renov\u00e1vel, usando um algoritmo focado na \n\nminimiza\u00e7\u00e3o dos custos de carregamento; \n\n5- Por fim, \u00e9 mostrado um cen\u00e1rio que seria de esperar caso n\u00e3o se use qualquer tipo \n\nde carregamento inteligente. \n\n \nFigura 15 - Simula\u00e7\u00e3o de inverno (2 e 3 de fevereiro de 2017) com pre\u00e7os Bi-hor\u00e1rio \n\nAp\u00f3s uma an\u00e1lise dos gr\u00e1ficos \u00e9 poss\u00edvel recolher dados de modo a obter a Tabela 5.  \n\n \nTabela 5 - Resultados das simula\u00e7\u00f5es para os dias 2 e 3 de fevereiro de 2017 \n\nTipo\tde\tsimula\u00e7\u00e3o\t Pico\t\nm\u00e1ximo\t\n(kw)\t\n\nPico\t\nm\u00ednimo\t\n(kw)\t\n\nDesvio\t\n(kw)\t\n\nDesvio\t(%)\t\nface\tao\t\noriginal\t\n\nCusto\t\nm\u00e9dio\t(\u20ac)\t\n\nOriginal\t 122,89\t -215,59\t 338,48\t -\t -\t\nEm\tfun\u00e7\u00e3o\tdo\texcesso\tde\t\n\nrenov\u00e1vel,\tcom\tpre\u00e7os\tmibel\t\n64,61\t -215,59\t 280,20\t -17,22\t 0,9531\t\n\nEm\tfun\u00e7\u00e3o\tdo\texcesso\tde\t\nrenov\u00e1vel,\tcom\tpre\u00e7os\tbi-hor\u00e1rio\t\n\n64,61\t -215,59\t 280,20\t -17,22\t 0,8442\t\n\nEm\tfun\u00e7\u00e3o\tdos\tpre\u00e7os\tmibel\t 122,89\t -540,11\t 663,0\t +95,88\t 0,6642\t\nEm\tfun\u00e7\u00e3o\tdos\tpre\u00e7os\tbi-hor\u00e1rio\t 122,89\t -576,50\t 699,39\t +106,63\t 0,6507\t\nN\u00e3o\tinteligente\tcom\tpre\u00e7os\tmibel\t 122,89\t -290,32\t 413,12\t +22,05\t 1,0895\t\nN\u00e3o\tinteligente\tcom\tpre\u00e7os\tbi-\n\nhor\u00e1rio\t\n122,89\t -290,32\t 413,12\t +22,05\t 1,0082\t\n\n\n\n 40 \n\nNa Tabela 5 \u00e9 poss\u00edvel notar a efic\u00e1cia do algoritmo que faz o agendamento dos \n\ncarregamentos em fun\u00e7\u00e3o do excesso de energia renov\u00e1vel, reduzindo em 17,22% o desvio que h\u00e1 \n\nentre o pico da curva original e o da final ap\u00f3s os carregamentos. Este m\u00e9todo mostrou-se bastante \n\neficaz no cumprimento do terceiro objetivo, suavizando e equilibrando o diagrama, pois o \n\nalgoritmo ir\u00e1 agendar os carregamentos para as horas de maior excesso come\u00e7ando pela hora em \n\nque h\u00e1 mais energia renov\u00e1vel, 6:00h do dia 3. \n\nNo segundo sub-gr\u00e1fico v\u00ea-se os per\u00edodos escolhidos pelo algoritmo para o carregamento \n\nideal de cada VE. Iterativamente, ir\u00e1 alocar v\u00e1rios per\u00edodos, a um determinado ve\u00edculo, come\u00e7ando \n\npelos per\u00edodos em que h\u00e1 um maior excesso de energia. Quando esse excesso deixa de existir, o \n\nalgoritmo ir\u00e1 alocar os per\u00edodos de carregamento nas situa\u00e7\u00f5es em que os valores de produ\u00e7\u00e3o de \n\nenergia renov\u00e1vel sejam menos negativos evitando assim a intensifica\u00e7\u00e3o do uso de fontes de \n\nenergia n\u00e3o renov\u00e1veis.  \n\nEm rela\u00e7\u00e3o ao segundo cen\u00e1rio (quarto sub-gr\u00e1fico), em que o agendamento \u00e9 feito em \n\nfun\u00e7\u00e3o do pre\u00e7o da energia \u00e9 de notar um elevado pico nos instantes em que o pre\u00e7o \u00e9 mais baixo. \n\nComo o pre\u00e7o \u00e9 mais baixo nessa hora ir\u00e1 haver uma prefer\u00eancia por esse hor\u00e1rio. Na Figura 14, \n\nque se usa um pre\u00e7o baseado no MIBEL, o pico mais negativo chega a atingir uma pot\u00eancia de  \n\n-540 kW enquanto que, na Figura 15, atinge os -576 kW. Este \u00faltimo caso \u00e9 o exemplo de um \n\ncarregamento semi-inteligente, em que os carregamentos est\u00e3o focados exclusivamente na \n\npoupan\u00e7a dos utilizadores. Como tal iniciam o carregamento no instante em que a energia \u00e9 mais \n\nbarata e dado que se trata de uma tarifa bi-hor\u00e1ria e os pre\u00e7os s\u00e3o comuns a todos os utilizadores \n\nnesta situa\u00e7\u00e3o, os carregamentos ser\u00e3o agendados todos para a mesma hora provocando uma ponta \n\nelevada. No caso de se trabalhar em fun\u00e7\u00e3o da varia\u00e7\u00e3o dos pre\u00e7os MIBEL o pico de procura \n\nocorre por volta das 4:00h do dia 3 enquanto que, em fun\u00e7\u00e3o de uma tarifa bi-hor\u00e1ria ocorre pouco \n\ndepois das 22:00h do dia 2, que \u00e9 logo ap\u00f3s o in\u00edcio do per\u00edodo de vazio na tarifa. \n\nPor fim, no \u00faltimo gr\u00e1fico \u00e9 apresentado o caso mais comum que \u00e9 referente a \n\ncarregamentos n\u00e3o inteligentes. Como seria de esperar, as curvas referentes a esse gr\u00e1fico da \n\nFigura 14 e da Figura 15 s\u00e3o iguais, uma vez que n\u00e3o existe qualquer tipo de agendamento em \n\nfun\u00e7\u00e3o do excesso de renov\u00e1vel ou do custo de energia. O carregamento depende apenas da hora \n\nde chegada e do estado de ve\u00edculo. \u00c9 de evidenciar que o pico de pot\u00eancia mais negativo desta \n\nsimula\u00e7\u00e3o se situa nos -280 kW o que \u00e9 um valor muito menos negativo que usando um algoritmo \n\nsemi-inteligente mostrando que, ao n\u00edvel de equil\u00edbrio de diagramas de SEE, \u00e9 prefer\u00edvel n\u00e3o usar \n\num sistema baseado em pre\u00e7os que inicie m\u00faltiplos carregamentos \u00e0 mesma hora sem ter no\u00e7\u00e3o \n\nda quantidade de cargas previstas a essa hora como acontece num sistema semi-inteligente. \n\nUm outro aspeto que \u00e9 um objetivo deste trabalho \u00e9 a redu\u00e7\u00e3o dos custos de carregamento. \n\nA compara\u00e7\u00e3o ser\u00e1 feita usando como base as simula\u00e7\u00f5es que usam um carregamento n\u00e3o \n\n\n\n 41 \n\ninteligente que apresentou em ambos os casos (usando varia\u00e7\u00e3o dos pre\u00e7os MIBEL ou tarifa bi-\n\nhor\u00e1ria) uma m\u00e9dia de custos dos carregamentos de aproximadamente 1 \u20ac. Como verificado na \n\nTabela 5, em qualquer cen\u00e1rio em que se use um algoritmo de carregamento os custos s\u00e3o \n\ninferiores.  \n\nNos casos em que o agendamento \u00e9 feito em fun\u00e7\u00e3o do excesso de renov\u00e1vel houve ligeiras \n\ndiferen\u00e7as que se devem a varia\u00e7\u00f5es no pre\u00e7o da energia ao longo do dia, que podem ser \n\nverificadas no terceiro sub gr\u00e1fico da Figura 14. A grande parte dos carregamentos usando este \n\nm\u00e9todo \u00e9 efetuada entre as 6:00h e as 8:00h da manh\u00e3, onde se regista um maior custo nessas horas \n\nno pre\u00e7o baseado na varia\u00e7\u00e3o do MIBEL face a uma tarifa bi-hor\u00e1ria.  \n\nUsando a varia\u00e7\u00e3o de pre\u00e7os do MIBEL, com o algoritmo para aproveitamento do excesso \n\nde renov\u00e1veis \u00e9 obtida uma redu\u00e7\u00e3o de custos de 12,52% e usando o algoritmo em fun\u00e7\u00e3o do pre\u00e7o \n\nda energia a redu\u00e7\u00e3o \u00e9 16,27%. De igual modo, usando uma tarifa bi-hor\u00e1ria reduziu-se em 39,04% \n\nusando o algoritmo em fun\u00e7\u00e3o do excesso de renov\u00e1veis e 35,46% usando o algoritmo em fun\u00e7\u00e3o \n\ndos pre\u00e7os, tudo face a um carregamento n\u00e3o inteligente. Assim, a n\u00edvel de custos \u00e9 claramente \n\nvis\u00edvel a superioridade do segundo m\u00e9todo face ao primeiro, no entanto, peca pelo pico gerado no \n\ndiagrama, o que n\u00e3o acontece no primeiro m\u00e9todo que o torna mais linear. \n\n \n\n6.3 Simula\u00e7\u00e3o de ver\u00e3o \nO cen\u00e1rio de ver\u00e3o corresponde aos dias 9 e 10 de agosto de 2016. Este foi um m\u00eas \n\nextremamente quente e seco (a precipita\u00e7\u00e3o atingiu apenas 30% do que \u00e9 t\u00edpico nesse m\u00eas), em \n\nque a temperatura m\u00e9dia foi superior \u00e0 normal e onde se registaram os dias mais quentes do ano \n\n(entre 5 a 14 desse m\u00eas) [69]. Estas circunst\u00e2ncias tornam o m\u00eas de agosto de 2016 um \u00f3timo teste \n\ncom um acentuado contraste ao cen\u00e1rio de inverno j\u00e1 analisado, possibilitando assim verificar o \n\ndesempenho dos algoritmos. Relativamente aos dias 9 e 10 de agosto de 2016, a produ\u00e7\u00e3o teve um \n\ntotal de 289,4 GWh em que 60% foi de origem renov\u00e1vel, tendo o pico da mesma ocorrido no dia \n\n10 \u00e0s 21:30h com um valor de 5155 MW, onde o consumo era de 6607 MW. \n\nNesta simula\u00e7\u00e3o, apesar de o excesso de energia renov\u00e1vel ser praticamente nulo, os \n\nresultados s\u00e3o id\u00eanticos aos da simula\u00e7\u00e3o de inverno, sobressaindo assim a versatilidade do \n\nalgoritmo em se adaptar a situa\u00e7\u00f5es muito distintas. De notar que a popula\u00e7\u00e3o de ve\u00edculos que foi \n\nusada para simular o cen\u00e1rio de inverno (n\u00famero de VEs, SOCa, H, HPS e P) \u00e9 id\u00eantica, n\u00e3o se \n\ntendo modificado nada que adultere os resultados. Os diagramas de energia correspondentes a \n\nesses dias s\u00e3o vis\u00edveis na Figura 16 onde \u00e9 poss\u00edvel verificar a inexist\u00eancia de excesso de produ\u00e7\u00e3o \n\nde energia renov\u00e1vel. \n\n\n\n 42 \n\nOs resultados das simula\u00e7\u00f5es, para o caso do uso do pre\u00e7o da energia baseado no MIBEL \n\ns\u00e3o mostrados na Figura 17, enquanto que, os resultados usando os pre\u00e7os de uma tarifa bi-hor\u00e1ria \n\ns\u00e3o vis\u00edveis na Figura 18. Os sub gr\u00e1ficos dessas figuras s\u00e3o an\u00e1logos aos da simula\u00e7\u00e3o de inverno.  \n\n \n\n \nFigura 16 - Diagramas de energia dos dias 9 e 10 de agosto de 2016 (sem utiliza\u00e7\u00e3o do fator de redu\u00e7\u00e3o de 10 mil vezes) \n\n \n\n \nFigura 17 - Simula\u00e7\u00e3o de ver\u00e3o (9 e 10 de agosto de 2016) com pre\u00e7os MIBEL \n\n\n\n 43 \n\n \nFigura 18 - Simula\u00e7\u00e3o de ver\u00e3o (9 e 10 de agosto de 2016) com pre\u00e7os Bi-hor\u00e1rio \n\nUma vez mais, o primeiro algoritmo teve um bom desempenho. N\u00e3o foi poss\u00edvel fazer uso \n\ndo excesso de energia renov\u00e1vel, no entanto, foi suavizado ao m\u00e1ximo o diagrama alocando os \n\ncarregamentos nos per\u00edodos em que o excesso de renov\u00e1vel foi menos negativo. Esse agendamento \n\niterativo \u00e9 vis\u00edvel no segundo sub gr\u00e1fico da Figura 17 e da Figura 18. \n\nEm rela\u00e7\u00e3o ao segundo algoritmo, os impactos negativos foram id\u00eanticos ao do cen\u00e1rio de \n\ninverno. Todos os carregamentos foram agendados para a mesma hora (mais barata) levando ao \n\naparecimento de um pico de procura acentuado. Esse pico, com um valor de aproximadamente \n\n500 kW, ocorreu as 4:00h da manh\u00e3 do dia 10, no caso em que se usou um pre\u00e7o da energia \n\nbaseado na varia\u00e7\u00e3o do MIBEL e ocorreu por volta das 22h do dia 9, no caso com pre\u00e7os bi-\n\nhor\u00e1rios, pois \u00e9 quando os pre\u00e7os da tarifa bi-hor\u00e1ria sofrem um abaixamento. Em nenhum dos \n\ncasos se verificou uma suaviza\u00e7\u00e3o do diagrama, tendo at\u00e9 provocado o efeito oposto, pois este \n\nalgoritmo ignora por completo o excesso de energia renov\u00e1vel ou o diagrama de carga. O seu \u00fanico \n\nobjetivo \u00e9 poupar nos custos de carregamento tendo por isso um efeito negativo ao gerar o pico de \n\nprocura vis\u00edvel no quarto sub gr\u00e1fico da Figura 17 e da Figura 18 sendo que, no \u00faltimo caso \n\n(usando pre\u00e7os bi-hor\u00e1rio), as consequ\u00eancias ser\u00e3o piores dados que a procura \u00e0s 22:00h \u00e9, \n\ngeralmente, superior \u00e0 verificada \u00e0s 4:00h. \n\nPor fim, usando um carregamento n\u00e3o inteligente, n\u00e3o se consegue suavizar o diagrama, \n\nreduzir custos nem assegurar qualquer primazia por energia renov\u00e1vel. Ainda assim, os seus \n\nefeitos negativos no diagrama de carga s\u00e3o inferiores ao caso do m\u00e9todo anterior, n\u00e3o originando \n\num pico de procura (\u00e9 de salientar que este pico \u00e9 baixo pois se est\u00e1 a trabalhar com n\u00edveis de \n\npenetra\u00e7\u00e3o baixos, caso se usasse n\u00edveis altos iria ser relevante e ainda mais nefasto no caso de \n\n\n\n 44 \n\nagendamento em fun\u00e7\u00e3o do pre\u00e7o). Dos tr\u00eas algoritmos, tal como observado na Tabela 6, o \n\ncarregamento n\u00e3o inteligente \u00e9 o que tem maiores custos para o utilizador uma vez que a maioria \n\ndos carregamentos iniciam entre as 20:00h e as 22:00h o que corresponde a um per\u00edodo de ponta \n\nem que a energia \u00e9 mais cara.  \n\nPara este cen\u00e1rio, usando a varia\u00e7\u00e3o de pre\u00e7os do MIBEL \u00e9 vis\u00edvel uma redu\u00e7\u00e3o de custos \n\nde 29,84% usando o algoritmo para aproveitamento do excesso de renov\u00e1vel e de 35,95% usando \n\no algoritmo em fun\u00e7\u00e3o do pre\u00e7o da energia. No caso das simula\u00e7\u00f5es com tarifa bi-hor\u00e1ria reduziu-\n\nse em 32,96% com o primeiro m\u00e9todo e 35,46% com o segundo, face a um carregamento n\u00e3o \n\ninteligente.  \n\n \nTabela 6 - Resultados das simula\u00e7\u00f5es para os dias 9 e 10 de agosto de 2016 \n\nTipo\tde\tsimula\u00e7\u00e3o\t M\u00e1ximo\t(kw)\t M\u00ednimo\t\n(kw)\t\n\nDesvio\t\n(kw)\t\n\nDesvio\tface\tao\t\noriginal\t(%)\t\n\nCusto\t\nm\u00e9dio\t(\u20ac)\t\n\nOriginal\t 5,21\t -387,39\t 392,60\t -\t -\t\n\nPor\texcesso\trenov\u00e1vel\t\ncom\tpre\u00e7os\tmibel\t\n\n-91,15\t -387,39\t 296,24\t -\t24,54\t 0,7420\t\n\nPor\texcesso\tcom\tpre\u00e7os\t\nbi-hor\u00e1rio\t\n\n-91,15\t -387,39\t 296,24\t -24,54\t 0,6759\t\n\nPor\tpre\u00e7os\tmibel\t 5,21\t -596,87\t 512,08\t +\t30,43\t 0,6773\t\nPor\tpre\u00e7os\tbi-hor\u00e1rio\t 5,21\t -604,02\t 609,23\t +55,18\t 0,6507\t\nN\u00e3o\tinteligente\tcom\t\n\npre\u00e7os\tmibel\t\n5,21\t -425,81\t 431,02\t +9,79\t 1,0575\t\n\nN\u00e3o\tinteligente\tcom\t\npre\u00e7os\tbi-hor\u00e1rio\t\n\n5,21\t -425,81\t 431,02\t +9,79\t 1,0082\t\n\n \n\nA Tabela 7 faz um resumo da redu\u00e7\u00e3o de custos de carregamento em todas as simula\u00e7\u00f5es dos \n\ndois cen\u00e1rios, inverno e ver\u00e3o. Como seria de esperar, \u00e9 vis\u00edvel a superioridade, em termos de \n\ncustos de carregamento, do m\u00e9todo de agendamento em fun\u00e7\u00e3o do custo da energia face a um \n\ncarregamento n\u00e3o inteligente e at\u00e9 superior ao carregamento inteligente de aproveitamento do \n\nexcesso de energia renov\u00e1vel. No cen\u00e1rio de ver\u00e3o o excesso \u00e9 praticamente nulo, no entanto, os \n\nvalores menos positivos coincidem com os per\u00edodos em que a energia \u00e9 mais barata da\u00ed a diferen\u00e7a \n\nda redu\u00e7\u00e3o de um algoritmo para o outro n\u00e3o ser t\u00e3o acentuada como no cen\u00e1rio de inverno.   \n\n \nTabela 7 - Compara\u00e7\u00e3o da redu\u00e7\u00e3o de custos \n\n\t Inverno\t Ver\u00e3o\t\nEm\tfun\u00e7\u00e3o\tdo\texcesso\tmibel\t 12,52%\t 29,84%\t\nEm\tfun\u00e7\u00e3o\tdo\texcesso\tbi-hor\u00e1rio\t 16,27%\t 32,96%\t\nEm\tfun\u00e7\u00e3o\tdo\tpre\u00e7o\tmibel\t 39,04%\t 35,95%\t\nEm\tfun\u00e7\u00e3o\tdo\tpre\u00e7o\tbi-hor\u00e1rio\t 35,46%\t 35,46%\t\n\n\n\n 45 \n\n \nSendo o principal objetivo deste trabalho o aproveitamento do excesso de energia \n\nrenov\u00e1veis em carregamentos dom\u00e9sticos de VEs, \u00e9 mostrado na Tabela 8 o desempenho de cada \n\nalgoritmo. \u00c9 importante relembrar que, como se est\u00e1 a trabalhar com dados nacionais reais e de \n\nmodo a encurtar o tempo da realiza\u00e7\u00e3o das simula\u00e7\u00f5es se est\u00e1 a reduzir em 10 mil vezes os valores \n\nde energia. Sendo que no cen\u00e1rio de inverno houve um excesso de gera\u00e7\u00e3o renov\u00e1vel de 25166 \n\nMWh, na simula\u00e7\u00e3o foi usado o valor de 2516,6 kWh. No de ver\u00e3o, os 5,2 kWh mostrados na \n\nTabela 8 corresponde na realidade a um excesso de 52 MWh. \n\n \nTabela 8 - Comparativo do uso do excesso de renov\u00e1vel por cada algoritmo \n\n\t Cen\u00e1rio\tde\t\ninverno\t\n\nCen\u00e1rio\tde\t\nver\u00e3o\t\n\nExcesso\tabsorvido\t\n(inverno)\t\n\nExcesso\tde\trenov\u00e1vel\toriginal\t\t 2516,6\tkwh\t 5,2\tkwh\t -\t\nExcesso\tap\u00f3s\to\t1\u00ba\tm\u00e9todo\t(fun\u00e7\u00e3o\t\ndo\texcesso)\t\n\n1144,2\tkwh\t 0\tkwh\t 54,5%\t\n\nExcesso\tap\u00f3s\to\t2\u00ba\tm\u00e9todo\t(fun\u00e7\u00e3o\t\ndo\tpre\u00e7o)\t\t\n\n2516,6\tkwh\t 5,2\tkwh\t 0%\t\n\nAbsor\u00e7\u00e3o\tn\u00e3o\tinteligente\t\t 2516,6\tkwh\t 5,2\tkwh\t 0%\t\n \n\nDa an\u00e1lise da Tabela 8 verifica-se que o algoritmo que agenda os carregamentos em fun\u00e7\u00e3o \n\ndo excesso conseguiu absorver 54,5% do total no cen\u00e1rio de inverno. J\u00e1 no caso dos outros dois \n\nalgoritmos, nenhum absorveu qualquer excesso de energia renov\u00e1vel uma vez que, em qualquer \n\ncen\u00e1rio usando pre\u00e7os bi-hor\u00e1rios ou baseados na varia\u00e7\u00e3o do MIBEL, os pre\u00e7os da energia mais \n\nbaixos n\u00e3o coincidiram com per\u00edodos de excesso de renov\u00e1vel. Como no cen\u00e1rio de ver\u00e3o apenas \n\nse verificou um excesso de 5,2 kWh n\u00e3o \u00e9 fi\u00e1vel afirmar que o primeiro algoritmo conseguiu \n\naproveitar 100% do excesso uma vez que se trata de um valor reduzido e que, por coincid\u00eancia, \n\ncoincidiu apenas com o per\u00edodo noturno. Se ocorresse a meio do dia, muito provavelmente, o \n\nalgoritmo n\u00e3o teria capacidade para aproveitar o excesso, tal como os outros, uma vez que poderia \n\nn\u00e3o haver ve\u00edculos a necessitar carregamento nessas horas.  \n\n  \n\n\n\n 46 \n\n \n\n7 Conclus\u00f5es e trabalho futuro \n\n7.1 Conclus\u00f5es \nDesde o in\u00edcio do trabalho que se estipulou 3 objetivos: \n\n1. Aproveitar ao m\u00e1ximo o excesso de energia renov\u00e1vel; \n\n2. Reduzir os custos associados ao carregamento de VEs; \n\n3. Otimizar o diagrama de carga nacional. \n\nO alcance destes objetivos seria atingindo adiando o carregamento para per\u00edodos mais \n\nfavor\u00e1veis. No caso de se focar no primeiro objetivo, o carregamento seria programado num \n\nhor\u00e1rio onde houvesse um maior excesso de energia renov\u00e1vel. No caso de se pretender o segundo \n\nobjetivo, os carregamentos seriam efetuados nas horas em que a energia seria mais barata. Dado \n\nque, quando h\u00e1 menos procura o pre\u00e7o da energia \u00e9 mais barata ou que, quando h\u00e1 excesso de \n\nenergia o pre\u00e7o da mesma \u00e9 mais barata, o terceiro objetivo seria frequentemente alcan\u00e7ado \n\nautomaticamente ap\u00f3s a execu\u00e7\u00e3o de qualquer um dos algoritmos.  \n\nAs tarifas energ\u00e9ticas est\u00e3o em constante evolu\u00e7\u00e3o. No futuro, \u00e9 muito prov\u00e1vel que Portugal \n\nadote tarifas em tempo real. Quando isso for poss\u00edvel, ser\u00e1 de esperar que o pre\u00e7o da energia seja \n\nmais barato quando houver excesso de energia renov\u00e1vel, o que dar\u00e1 origem a uma equival\u00eancia \n\nnos dois primeiros m\u00e9todos usados neste trabalho. O resultado obtido usando um algoritmo de \n\nagendamento em fun\u00e7\u00e3o do excesso ser\u00e1 igual ao obtido usando um algoritmo em fun\u00e7\u00e3o do pre\u00e7o \n\nda energia em tempo real, uma vez que estes estar\u00e3o fortemente relacionados. Como atualmente \n\nisso n\u00e3o ocorre \u00e9 natural que haja diferen\u00e7as no diagrama optando por m\u00e9todos diferentes.  \n\nOutro fator que ajudar\u00e1 a igualar os resultados dos m\u00e9todos ser\u00e1 num cen\u00e1rio de alta \n\npenetra\u00e7\u00e3o de VEs. Num futuro, quando houver um n\u00famero consider\u00e1vel de VEs em circula\u00e7\u00e3o, \n\nos seus carregamentos ter\u00e3o um grande impacto na rede, como tal, quando um grande aglomerado \n\nde VEs estiver a carregar o pre\u00e7o da energia ir\u00e1 aumentar fazendo com que os pr\u00f3ximos VEs a dar \n\nentrada no sistema j\u00e1 v\u00e3o carregar noutros per\u00edodos em que haja menos procura e que, \n\nconsequentemente, a energia seja mais barata. Dado que o pre\u00e7o da energia da tarifa bi-hor\u00e1ria ou \n\nbaseado no MIBEL ainda n\u00e3o est\u00e3o totalmente sincronizados com o excesso de energia, mas sim \n\ncom a procura, \u00e9 natural que a suaviza\u00e7\u00e3o do diagrama de carga (objetivo 3) s\u00f3 ser atingido usando \n\no primeiro algoritmo sendo at\u00e9 prejudicado usando o segundo, em que o agendamento \u00e9 em fun\u00e7\u00e3o \n\ndo pre\u00e7o. \n\nNo entanto, visto que o foco primordial deste trabalho \u00e9 o desenvolvimento de algoritmos \n\nque coordenem o carregamento de VEs que permitam a integra\u00e7\u00e3o em larga escala de energias \n\n\n\n 47 \n\nrenov\u00e1veis e ainda n\u00e3o est\u00e3o dispon\u00edveis tarifas em pre\u00e7o real, a conclus\u00e3o debru\u00e7ar-se-\u00e1 \n\nprincipalmente no primeiro m\u00e9todo desenvolvido com tarifas bi-hor\u00e1rias onde os resultados s\u00e3o \n\nvis\u00edveis na Tabela 9.  \nTabela 9 - Resultados finais do algoritmo em fun\u00e7\u00e3o do excesso de renov\u00e1vel \n\n\t Excesso\tde\trenov\u00e1vel\t\nabsorvido\t(%)\t\n\nM\u00e9dia\tredu\u00e7\u00e3o\tde\tcustos\t\n(%)\t\n\nAgendamento\tem\tfun\u00e7\u00e3o\tdo\texcesso\t\nde\trenov\u00e1vel\t\n\n54\t 16,27\ta\t32,96\t\n\n \n\nUsando o primeiro algoritmo, a absor\u00e7\u00e3o de excesso de energia renov\u00e1vel n\u00e3o foi superior \n\na 54%, pois os restantes 46% estavam em per\u00edodos em que n\u00e3o coincidiam com as prefer\u00eancias do \n\nutilizador. A outra grande fatia de excesso ocorreu entre a 01:00h e as 08h:00 do primeiro dia. \n\nCaso se estivesse a trabalhar com uma janela de tr\u00eas dias (1, 2 e 3 de fevereiro) ou em tempo \n\ncont\u00ednuo, os VE que chegassem no dia 1 iriam usar esse excesso do dia 2. Assim, o excesso \n\nabsorvido pelo carregamento de ve\u00edculos nos dias 2 e 3 de fevereiro teria valores perto de 100%. \n\nA n\u00edvel de otimiza\u00e7\u00e3o do diagrama de carga, a superioridade do algoritmo em fun\u00e7\u00e3o do \n\nexcesso de renov\u00e1vel face a um carregamento n\u00e3o inteligente pode ser observada na Figura 19, \n\nrelativa ao cen\u00e1rio de inverno e na Figura 20 para o cen\u00e1rio de ver\u00e3o, ambos os casos ilustrados \n\npelo ficheiro PlostsComparativos.m (Anexo H \u2013 PlotsComparativos.m). Novamente, de modo a \n\nacelerar as simula\u00e7\u00f5es, a escala foi reduzida em 10 mil vezes.  \n\nNa Figura 19 \u00e9 vis\u00edvel o aumento dos picos de procura devido ao carregamento de VEs \n\nquando se usa carregamentos n\u00e3o inteligentes. Usando o algoritmo em fun\u00e7\u00e3o do excesso de \n\nenergia \u00e9 poss\u00edvel verificar um controlo desse pico no cen\u00e1rio de inverno.  \n\nNa simula\u00e7\u00e3o de ver\u00e3o (Figura 20) o efeito de carregamentos descontrolados \u00e9 semelhante \n\nao da simula\u00e7\u00e3o de inverno ocorrendo um grande pico de procura por volta das 21:00h do dia 9. \n\nUm equil\u00edbrio quase ideal no que diz respeito a preenchimento de vales em diagramas de carga, \u00e9 \n\natingindo, usando o algoritmo de agendamento em fun\u00e7\u00e3o do excesso de renov\u00e1vel. Neste cen\u00e1rio, \n\no algoritmo consegue distribuir os v\u00e1rios carregamentos de forma equilibrada ao longo do per\u00edodo \n\nnoturno. N\u00e3o criou qualquer pico de procura e, no per\u00edodo das 24:00h \u00e0s 08:00h a procura n\u00e3o \n\nteve valores t\u00e3o baixos devido ao desvio de carregamentos para esse intervalo. \n\n\n\n 48 \n\n \nFigura 19 - Diagramas de carga nos dias 2 e 3 de fevereiro de 2017 (consumo geral reduzido em 10 mil vezes) \n\n \n\n \nFigura 20 - Diagramas de carga nos dias 9 e 10 de agosto de 2016 (consumo geral reduzido em 10 mil vezes) \n\n\n\n 49 \n\nEm termos de custos ao longo de um ano, usando um algoritmo focado no aproveitamento \n\ndo excesso de energia renov\u00e1vel, para al\u00e9m de ajudar a reduzir as emiss\u00f5es para a atmosfera de \n\nGEE e a estabilizar os diagramas de carga, consegue-se poupar entre 55 \u20ac e 118 \u20ac por cada VE. \n\nUsando um algoritmo em fun\u00e7\u00e3o do pre\u00e7o, essa poupan\u00e7a sobe para valores entre 135 \u20ac e 143 \u20ac. \n\nEm contrapartida, usando este \u00faltimo algoritmo, ir\u00e3o surgir picos de procura que poder\u00e3o ter de \n\nser fornecidos tendo como base combust\u00edveis f\u00f3sseis. \n\nResumindo, usando o algoritmo em fun\u00e7\u00e3o do excesso de energia, consegue-se aproveitar o \n\nexcesso de gera\u00e7\u00e3o renov\u00e1vel, reduzir os custos associados ao carregamento e suavizar o diagrama \n\nde carga. Usando o algoritmo em fun\u00e7\u00e3o do pre\u00e7o de energia j\u00e1 s\u00f3 se verifica a redu\u00e7\u00e3o dos custos. \n\nO aproveitamento de energias renov\u00e1veis por este segundo m\u00e9todo s\u00f3 ser\u00e1 aceit\u00e1vel se o pre\u00e7o da \n\nenergia variar em fun\u00e7\u00e3o do n\u00edvel de gera\u00e7\u00e3o renov\u00e1vel. Em termos de suaviza\u00e7\u00e3o do diagrama, \n\neste m\u00e9todo \u00e9 o pior tendo resultados mais nefastos do que carregamentos n\u00e3o inteligentes. Estes \n\n\u00faltimos, apesar de n\u00e3o provocarem, com este n\u00edvel de penetra\u00e7\u00e3o baixo, um grande efeito negativo, \n\nn\u00e3o fazem qualquer uso do excesso de energia renov\u00e1vel e s\u00e3o os que t\u00eam um maior custo de \n\ncarregamento dos tr\u00eas. Concluindo e tendo em conta todos os impactos causados pelos VEs, com \n\no carregamento coordenado de VEs focado no aproveitamento do excesso de energia renov\u00e1vel, \n\nn\u00e3o s\u00f3 se reduz as pontas de procura, como tamb\u00e9m as emiss\u00f5es de CO2, aumenta-se a qualidade \n\nda energia nos SEE, equilibram-se os diagramas de carga e consegue-se reduzir os custos de \n\ncarregamento das baterias dos VEs. \n\n \n\n7.2 Trabalho Futuro  \nComo observado na sec\u00e7\u00e3o anterior, em parte, os algoritmos t\u00eam um desempenho limitado \n\npela janela de simula\u00e7\u00e3o. Para aproveitar ao m\u00e1ximo o excesso de energia de dois dias seria \n\nnecess\u00e1rio ter uma janela de tr\u00eas dias originando um sistema de n+1 sendo n o n\u00famero de dias que \n\nse queira simular o aproveitamento do excesso de renov\u00e1vel. Com este j\u00e1 seria poss\u00edvel simular \n\ncom rigor os carregamentos durante uma semana inteira ou um per\u00edodo mais alargado. Idealmente, \n\nos algoritmos poderiam ser adaptados para funcionar em tempo real, tenho uma previs\u00e3o dos \n\ncarregamentos de VEs do dia decorrente e da produ\u00e7\u00e3o e do consumo das 24 horas seguintes. \n\nOutro aspeto que se pode mudar \u00e9 a finalidade do algoritmo, incluindo outros objetivos ou \n\numa an\u00e1lise multiobjectivo para o algoritmo tentar assegurar simultaneamente bons resultados \n\npara v\u00e1rios objetivos. \n\nTamb\u00e9m crucial para o trabalho futuro seria a n\u00edvel de otimiza\u00e7\u00e3o do c\u00f3digo, que poderia \n\nser melhorado usando computa\u00e7\u00e3o paralela de modo a se simular facilmente um n\u00famero de \n\namostras correspondente a uma frota de VEs de elevada dimens\u00e3o (por exemplo um milh\u00e3o de \n\nVEs). De forma a melhorar os resultados obtidos, uma vez que se estaria a aumentar os n\u00edveis de \n\n\n\n 50 \n\npenetra\u00e7\u00e3o de VE, tal como analisado na sec\u00e7\u00e3o 3.5, poder-se-ia optar por um controlo \n\ncentralizado em vez de iterativo. \n\n \n\n  \n\n\n\n 51 \n\nRefer\u00eancias \n\n[1] Samadi, P.; Mohsenian-Rad, H.; Schober, R.; Wong, V.W.S., Advanced Demand Side \n\nManagement for the Future Smart Grid Using Mechanism Design, IEEE Transactions on \n\nSmart Grid, vol.3, no.3, pp.1170,1180, Sept. 2012. \n\n[2] Koutitas, G., Control of Flexible Smart Devices in the Smart Grid, IEEE Transactions on \n\nSmart Grid, vol.3, no.3, pp.1333,1343, Sept. 2012. \n\n[3] Daniel Freund, Marco Lutzenberger, Sahin Albayrak, Costs and Gains of Smart Charging \n\nElectric Vehicles to Provide Regulation Services, Procedia Computer Science, vol. 10, pp. \n\n846- 853, 2012. \n\n[4] Aoife Foley, Barry Tyther, Patrick Calnan, Brian \u00d3 Gallach\u00f3ir, Impacts of Electric Vehicle \n\ncharging under electricity market operations, Applied Energy, vol. 101, pp. 93-102, 2013 \n\n[5] R. P. Faria, V. C. Ramirez, P. S. Moura, J. I. Moreno, J. B. Delgado, and A. T. De Almeida, \n\n\u201cSMARTplug?: Using smart devices for a managed charge of electric vehicles\u201d, 2013.  \n\n[6] Raslavicius L, Azzopardi B, Kersys A, Starevicius M, Bazaras Z, Makaras R. Electric \n\nvehicles challenges and opportunities: lithuanian review. Renewable and Sustainable \n\nEnergy Reviews 2015; 42:786\u2013800. \n\n[7] Bellis M., ThoughtCo., \u201cA History of Electric Vehicles\u201d, \n\nhttp://inventors.about.com/od/estartinventions/a/History-Of-Electric-Vehicles.htm - \n\nacedido a 28 de fevereiro de 2017. \n\n[8] L. N. M. Duarte, \u201cCompara\u00e7\u00e3o de Estrat\u00e9gias de Carregamento de Ve\u00edculos El\u00e9tricos,\u201d \n\nDisserta\u00e7\u00e3o de Mestrado, FEUP, 2012. \n\n[9] J. Larminie, J. Lowry, Electric Vehicle Technology Explained, John Wiley &amp; Sons, Ltd, \n\nEngland, 2003.  \n\n[10] R. Faria, P. Moura, J. Delgado, and A. T. De Almeida, A sustainability assessment of \n\nelectric vehicles as a personal mobility system,\u201d Energy Convers. Manag., vol. 61, pp. 19\u2013\n\n30, 2012. \n\n[11] Nick Zielinski; \u201cChevy Volt and E-Flex Enabling Energy Diversity\u201d; Cascadia \n\nTransTechEnergy Series, p.4, May 2007. \n\n[12] World Energy Council, \u201cWorld Energy Perspectives E-MOBILITY: CLOSING THE \n\nEMISSIONS GAP,\u201d p. 40, 2016. \n\n[13] Vicatos, M., Tegopoulos, J., 2003. A doubly-fed induction machine differential drive \n\nmodel for automobiles. IEEE Transactions on Energy Conversion 18, 225-230. \n\n\n\n 52 \n\n[14] Yang, Z., Shang, F., Brown, I.P., Krishnamurthy, M., 2015. Comparative Study of Interior \n\nPermanent Magnet, Induction, and Switched Reluctance Motor Drives for EV and HEV \n\nApplications. IEEE Transactions on Transportation Electrification 1, 245-254. \n\n[15] Zeraoulia, M., 2006. Electric motor drive selection issues for HEV propulsion systems: A \n\ncomparative study. IEEE Transactions on Vehicular Technology, vol. 55, 1756-1764. \n\n[16] S. Rezaee, E. Farjah, B. Khorramdel, Probabilistic analysis of plug-in electric vehicles \n\nimpact on electrical grid through homes and parking lots, Sustain. Energy, IEEE Trans. 4 \n\n(4) (2013) p 1024 - 1033. \n\n[17] Sociedade Gestora de Opera\u00e7\u00f5es da Rede de Mobilidade El\u00e9trica, \u201cFormas de \n\nCarregamento de Ve\u00edculos El\u00e9ctricos em Documento para o utilizador,\u201d pp. 3\u201321, 2011. \n\n[18] Leong YP, Indati MS, Hisham HA. Climate change challenges on CO2 emission reduction \n\nfor developing countries: a case for Malaysia's agenda for action. International Journal of \n\nClimate Change: Impacts Responses, 2011. \n\n[19] Rajakaruna S, Shahnia F, Ghosh A. Plug in electric vehicles in smart grids. 1st ed. Springer \n\nScience and Business Media Singapore Pte Ltd; 2015. \n\n[20] Leou RC, Su CL, Lu CN. Stochastic analyses of electric vehicle charging im- pacts on \n\ndistribution network. IEEE Transactions on Power Systems 2014; 29:1055\u201363.   \n\n[21] McCarthy D, Wolfs P. The HV system impacts of large scale electric vehicle deployments \n\nin a metropolitan area. In: Proceedings of the 20th Australasian Universities Power \n\nEngineering Conference (AUPEC), Christchurch; 2010. p. 1\u20136. \n\n[22] Wang Z, Paranjape R. An evaluation of electric vehicle penetration under demand response \n\nin a multi-agent based simulation. IEEE Electrical Power and Energy Conference (EPEC), \n\nCalgary, AB; 2014. p. 220-5. \n\n[23] W. H. Kersting, \"Radial distribution test feeders,\" in Power Engineering Society Winter \n\nMeeting, 2001. IEEE, 2001, pp. 908-912. \n\n[24] Kristofferson T, Capion K, Meibom P. Optimal charging of electric drive vehicles in a \n\nmarket environment. Applied Energy 2011; 88:1940\u20138. \n\n[25] Denholm P, Short W. An evaluation of utility system impacts and benefits of optimally \n\ndispatched plug-in hybrid electric vehicles. Golden, CO: National Renewable Energy \n\nLaboratory; 2006.   \n\n[26] Gomez JC, Morcos MM. Impact of EV battery chargers on the power quality of \n\ndistribution systems. IEEE Transations on Power Delivery 2003;18(3):975\u201381.  \n\n[27] Desmet JJM, Sweertvaegher I, Vanalme G, Stockman K, Belmans RJM. Analysis of the \n\nneutral conductor current in a three-phase supplied network with nonlinear single-phase \n\nloads. IEEE Transations on Industry Applications 2003; 39(3):587\u201393.  \n\n\n\n 53 \n\n[28] IEEE Standards Coordinating Committee 22 on Power Quality, IEEE Std 1159. IEEE \n\nRecommended Practice for Monitoring Electric Power Quality; 1995.   \n\n[29] Lee SJ, Kim JH, Kim DU, Go HS, Kim CH, Kim ES, et al. Evaluation of voltage sag and \n\nunbalance due to the system connection of electric vehicles on distribution system. Journal \n\nof Electrical Engineering and Technology 2014; 9:452\u201360. \n\n[30] IEEE Power &amp; Energy Society, IEEE Recommended Practice for Monitoring Electric \n\nPower Quality; 2009. \n\n[31] Papadopoulos P, Skarvelis-Kazakos S, Grau I, Awad B, Cipcigan LM, Jenkins N. Impact \n\nof residential charging of electric vehicles on distribution networks, a probabilistic \n\napproach. In: 45th International Universities Power Engineering Conference (UPEC); \n\n2010. p. 1\u20135. \n\n[32] Pieltain FL, Roman TGS, Cossent R, Domingo CM, Frias P. Assessment of the impact of \n\nplug-in electric vehicles on distribution networks. IEEE Transactions on Power Systems \n\n2011; 26(1):206\u201313. \n\n[33] Elnozahy MS, Salama MM. A comprehensive study of the impacts of PHEVs on \n\nresidential distribution networks. IEEE Transations on Sustainable Energy 2014; 5:332\u2013\n\n42. \n\n[34] Berisha SH, Karady GG, Ahmad R, Hobbs R, Karner D. Current harmonics generated by \n\nelectric vehicle battery chargers. In: Proceedings of the International Conference on Power \n\nElectronics, Drives, and Energy Systems for Industrial Growth; 1996. p. 584-9. \n\n[35] Donateo T, Ingrosso F, Licci F, Laforgia D. A method to estimate the environmental \n\nimpact of an electric city car during six months of testing in an Italian city. J Power Sources \n\n2014; 270:487\u201398. \n\n[36] Kim JD, Rahimi M. Future energy loads for a large-scale adoption of electric vehicles in \n\nthe city of Los Angeles: impacts on greenhouse gas (GHG) emissions. Energy Policy 2014; \n\n73:620\u201330. \n\n[37] Lund H, Kempton W. Integration of renewable energy into the transport and electricity \n\nsectors through V2G. Energy Policy 2008; 36:3578\u201387. \n\n[38] R. Faria, P. Marques, P. Moura, F. Freire, J. Delgado, and A. T. De Almeida, \u201cImpact of \n\nthe electricity mix and use profile in the life-cycle assessment of electric vehicles,\u201d \n\nRenew. Sustain. Energy Rev., vol. 24, pp. 271\u2013287, 2013.   \n\n[39] Ferrero E, Alessandrini S, Balanzino A. Impact of the electric vehicles on the air pollution \n\nfrom a highway. Applied Energy 2016; 169:450\u20139. \n\n[40] Sioshansi R, Miller J. Plug-in hybrid electric vehicles can be clean and economical in dirty \n\npower systems. Energy Policy 2011; 39(10):6151\u201361. \n\n\n\n 54 \n\n[41] Mwasilu F, Justo JJ, Kim EK, Do TD, Jung JW. Electric vehicles and smart grid \n\ninteraction: a review on vehicle to grid and renewable energy sources integration. \n\nRenewable and Sustainable Energy Reviews 2014; 34:501\u201316. \n\n[42] Richardson DB. Electric vehicles and the electric grid: a review of modeling approaches, \n\nimpacts and renewable energy integration. Renew Sustain Energy Rev 2013; 19:247\u201354. \n\n[43] Thomas C. Fuel cell and battery electric vehicles compared. International Journal of \n\nHydrogen Energy 2009; 34:6005\u201320.  \n\n[44] Kiviluoma J, Meibom P. Methodology for modeling plug-in electric vehicles in the power \n\nsystem and cost estimates for a system with either smart or dumb electric vehicles. Energy \n\n2011; 36:1758\u201367. \n\n[45] Weis A, Jaramillo P, Michalek J. Estimating the potential of controlled plug-in hybrid \n\nelectric vehicle charging to reduce operational and capacity expansion costs for electric \n\npower systems with high wind penetration. Applied Energy 2014; 115:190\u2013204.  \n\n[46] G. Strbac, \u201cDemand side management: Benefits and challenges,\u201d Energy Policy, vol. 36, \n\nno. 12, pp. 4419\u20134426, 2008. \n\n[47] K. Clement-Nyns, E. Haesen, and J. Driesen, \u201cThe Impact of Charging Plug-In Hybrid \n\nElectricVehicles on a Residential Distribution Grid,\u201d IEEE Transactions on Power \n\nSystems, vol. 25, no. 1, pp. 371\u2013380, February 2010. \n\n[48] K. Mets, T. Verschueren, W. Haerick, C. Develder, and F. De Turck, \u201cOptimizing Smart \n\nEnergy Control Strategies for Plug-In Hybrid Electric Vehicle Charging,\u201d pp. 293\u2013299, \n\n2010.   \n\n[49] K. Mets, R. D\u2019Hulst, and C. Develder, \u201cComparison of Intelligent charging algorithms for \n\nelectric vehicles to reduce peak load and demand variability in a distribution grid,\u201d J. \n\nCommun. Networks, vol. 14, no. 6, pp. 672\u2013681, 2012.  \n\n[50] Lu\u00eds Paulo Reis, Coordena\u00e7\u00e3o em Sistemas Multi-Agente: Aplica\u00e7\u00f5es na Gest\u00e3o \n\nUniversit\u00e1ria e Futebol Rob\u00f3tico (Coordination in Multi-Agent Systems: Applications in \n\nUniversity Management and Robotic Soccer), PhD Thesis, FEUP, July of 2003. \n\n[51] M. Hommelberg, C. Warmer, I. Kamphuis, J. Kok, and G. Schaeffer, \u201cDistributed control \n\nconcepts using multi-agent technology and automatic markets: an indispensable feature of \n\nsmart power grids,\u201d in Proc. 2007 IEEE Power Engineering Society General Meeting, \n\nTampa, Florida, USA, 2007, p. 7 pp. \n\n[52] Logenthiran T, Srinivasan D. Multi-agent system for managing a power distribution system \n\nwith plug-in hybrid electrical vehicles in smart grid. ISGT2011-India. IEEE 2011; \n\n0954:346\u201351. \n\n\n\n 55 \n\n[53] Richardson P, Flynn D, Keane A. Local versus centralized charging strategies for electric \n\nvehicles in low voltage distribution systems. IEEE Transactions on Smart Grid 2012; \n\n3:1020\u20138.  \n\n[54] Gonzalez Vaya M, Andersson G. Centralized and decentralized approaches to smart \n\ncharging of plug-in vehicles, 3rd IEEE PES Inovative Smart Grid Technologies Europe \n\n(ISGT Europe) 2012:1\u20138. \n\n[55] REN, Dados T\u00e9cnicos Eletricidade 2016 - Dispon\u00edvel em \n\nhttp://www.centrodeinformacao.ren.pt/PT/InformacaoTecnica/DadosTecnicos/REN%20\n\nDados%20T\u00e9cnicos%202016.pdf \u2013 Acedido a 11 de junho de 2017. \n\n[56] J. Delgado, R. Faria, P. Moura e A. de Almeida, \u201cThe contribution of Plug-In Electric \n\nVehicles to achieve energy transition goals in Energy Efficiency Improvement, Renewable \n\nEnergy integration and Greenhouse Gas emissions reduction\u201d., Instituto de Sistemas e \n\nRob\u00f3tica \u2013 Universidade de Coimbra, Julho de 2017. \n\n[57] EDP, Complementaridade h\u00eddrica-e\u00f3lica \u2013 Dispon\u00edvel em http://www.a-nossa-\n\nenergia.edp.pt/centros_produtores/complementariedade_hidroeolica_pe.php \u2013 Acedido a \n\n16 de junho de 2017. \n\n[58] Yang CJ. Pumped Hydroelectric Storage, Center on Global Change, Duke University, \n\nDurham, North Carolina 27708, USA, 2011. \n\n[59] P. Gomes, M. Lopes, H. Martins, J. Carvalho, P. Teixeira, and U. De Aveiro, \u201cAnexo 8 \n\nCustos internos e externos de Mobilidade \u00cdndice,\u201d 2011.  \n\n[60] B. Schoettle and M. Sivak, \u201cConsumer Preferences for the Charging of Plug-In Electric \n\nVehicles,\u201d Sustain. Worlwide Transp., no. November, 2016.  \n\n[61] REN, Previs\u00e3o de Produ\u00e7\u00e3o -  REN Sistema de Informa\u00e7\u00e3o de Mercados de Energia - \n\nhttp://www.mercado.ren.pt/PT/Electr/InfoMercado/Prod/Paginas/Prev.aspx \n\n[62] REN, Previs\u00e3o de Consumo - REN Sistema de Informa\u00e7\u00e3o de Mercados de Energia - \n\nDispon\u00edvel em:  \n\nhttp://www.mercado.ren.pt/PT/Electr/InfoMercado/Consumo/PrevConsumo/Paginas/Pre\n\nvConsDia.aspx \n\n[63] REN, Estat\u00edstica Di\u00e1ria \u2013 Centro de Informa\u00e7\u00e3o REN - Dispon\u00edvel em:   \n\nhttp://www.centrodeinformacao.ren.pt/EN/Pages/CIHomePage.aspx \n\n[64] EDP, Pre\u00e7o Tarifas Baixa Tens\u00e3o Normal \u2013 Dispon\u00edvel em:  \n\nhttp://www.edpsu.pt/pt/particulares/tarifasehorarios/BTN/Pages/TarifasBTNate20.7kVA.\n\naspx \n\n\n\n 56 \n\n[65] REN, Hist\u00f3rico de pre\u00e7os da energia \u2013 Dispon\u00edvel em:  \n\nhttp://www.mercado.ren.pt/PT/Electr/InfoMercado/InfOp/MercOmel/Paginas/Precos.asp\n\nx \n\n[66] R. Faria, P. Moura, J. Delgado, and A. T. De Almeida, \u201cManaging the charging of electrical \n\nvehicles: Impacts on the electrical grid and on the environment,\u201d IEEE Intell. Transp. Syst. \n\nMag., vol. 6, no. 3, pp. 54\u201365, 2014.  \n\n[67] Jos\u00e9 P., Vendas Ve\u00edculos El\u00e9tricos em Portugal \u2013 Dispon\u00edvel em: http://ev-\n\nsales.blogspot.pt/search/label/Portugal -  acedido a 5 de julho de 2017. \n\n[68] M. Alonso, H. Amaris, J. G. Germain, and J. M. Galan, \u201cOptimal charging scheduling of \n\nelectric vehicles in smart grids by heuristic algorithms,\u201d Energies, vol. 7, no. 4, pp. 2449\u2013\n\n2475, 2014. \n\n[69] IPMA, Resumo Clima Agosto 2016 - Dispon\u00edvel em:  \n\nhttps://www.ipma.pt/export/sites/ipma/bin/docs/relatorios/clima/resumo-clima-agosto-\n\n2016.pdf  \n\n\n\n 57 \n\n8 Anexo A - Algoritmo.m \n\n \n% 4 Simula\u00e7\u00f5es poss\u00edveis: \n% 1 - Em fun\u00e7\u00e3o do excesso de renov\u00e1vel \n% 2 - Em fun\u00e7\u00e3o dos pre\u00e7os MIBEL \n% 3 - Em fun\u00e7\u00e3o dos pre\u00e7os de tarifa bi-hor\u00e1ria (carrega em horas de vazio) \n% 4 - Carregamento normal, sem qualquer tipo de intelig\u00eancia \n% Para simular o caso 3 \u00e9 necess\u00e1rio alterar os valores dos pre\u00e7os em \n% Previsao.m \n  \ntic; clear; clc; close all \n  \nh = 12; %Hora atual hipot\u00e9tica \nr = 10; % Fator de redu\u00e7\u00e3o do excesso de energia \n% Estamos a reduzir o excesso em 10 mil vezes, uma vez que estamos a usar  \n% r = 10 e, para al\u00e9m disso, o excesso est\u00e1 em MW e os nossos ve\u00edculos em kW \n% Usamos este fator para tornar vis\u00edvel as diferen\u00e7as no gr\u00e1fico caso \n% contr\u00e1rio ter\u00edamos de usar 1 milh\u00e3o VE para ter o mesmo efeito com o sen\u00e3o \n% que a simula\u00e7\u00e3o demoraria v\u00e1rios dias a fazer. \n  \nrun Previsao.m \nrun ListaVE.m \nrun Tempo.m \n  \n%% ---------------------------------------- Dias 9 e 10 de agosto de 2016 \ndisp('Algortimo para os dias 9 e 10 de agosto de 2016') \nexcesso = excesso9_10; \nexcesso_original = excesso(:,2); \ndia1 = 9; \ndia2 = 10; \n  \nfigure \n    subplot(5,1,1) \n        hold on \n        plot(excesso(:,1),excesso_original,'LineWidth',3); %Excesso original \n    subplot(5,1,2) \n        hold on \n        plot(excesso(:,1),excesso_original,'b','LineWidth',3); %Excesso \noriginal  \n        LV4 = line([h h],[-500 200]); %Linha vertical hora atual hipot\u00e9tica \n        LV4.Color = 'blue'; \n        LV4.LineStyle = '--'; \n    subplot(5,1,3) \n        hold on \n        plot(excesso(:,1),excesso(:,3),'LineWidth',3); %Custo energia MIBEL \n        plot(excesso(:,1),excesso(:,4),'LineWidth',3); %Custo energia bi-\nhor\u00e1rio        \n    subplot(5,1,4) \n        hold on \n        plot(excesso(:,1),excesso_original,'b','LineWidth',3); %Excesso \noriginal \n        LV4 = line([h h],[-500 200]); %Linha vertical hora atual hipot\u00e9tica \n        LV4.Color = 'blue'; \n        LV4.LineStyle = '--'; \n    subplot(5,1,5) \n        hold on \n        plot(excesso(:,1),excesso_original,'b','LineWidth',3); %Excesso \noriginal \n        LV6 = line([h h],[-500 200]); %Linha vertical hora atual hipot\u00e9tica \n        LV6.Color = 'blue'; \n        LV6.LineStyle = '--'; \n  \n\n\n\n 58 \n\n%% Periodos de carregamento em fun\u00e7\u00e3o do excesso de energia renov\u00e1vel \ndisp('-----------------------------------------------------------------------\n--------------------------------------------------------') \ndisp('Carregamento em fun\u00e7\u00e3o do excesso de renov\u00e1vel') \nfor i=1:size(ListaOrdenada) %Ciclo corrido para cada ve\u00edculo (iterativo) \n    Periodos = 0; \n    z = 0; \n    custo = [excesso(:,1);excesso(:,3)]'; \n    run Janela.m   \n    if ListaOrdenada(i,9) > size(excesso_adaptado_ordenado) %Mensagem de erro \ncaso n\u00e3o haja tempo suficiente para carregar o VE \n        run Erro.m \n    else \n        % disp('-------------------------------------------------------------\n------------------------------------------------------------------') \n        % string2 = sprintf('\\nVe\u00edculo %d: \\n - Hora de chegada: %.2fh \\n - \nHora prevista de sa\u00edda: %.2fh \\n - Ir\u00e1 carregar nos seguintes per\u00edodos \n(precisa de %d, de um total dispon\u00edveis de \n%d):',ListaOrdenada(i,1),ListaOrdenada(i,2),ListaOrdenada(i,7),ListaOrdenada(\ni,9),size(excesso_adaptado_ordenado,1)); \n        % disp(string2) \n        for k=1:ListaOrdenada(i,9) %ListaOrdenada(:,9) = N\u00famero de periodos \nnecess\u00e1rios \n            Periodos(k,:) = excesso_adaptado_ordenado(k);  \n            ListaOrdenada(i,10) = ListaOrdenada(i,10) + ListaOrdenada(i,6) * \nexcesso_adaptado_ordenado(k,3)/4; %C\u00e1lculo do custo de carregamento \n            for a=1:size(excesso) %Subtra\u00e7\u00e3o da energia gasta pelo ve\u00edculo ao \ndiagrama de excessos \n                if excesso_adaptado_ordenado(k) == excesso(a,1) \n%size(excesso) = 96. O ciclo if ir\u00e1 percorrer a matriz \"excesso\", quando a \nhora do \"periodo\" for igual ao \"excesso\" ir\u00e1 ser subtra\u00edda a energia \nnecess\u00e1ria pelo VE ao excesso atual \n                    excesso(a,2) = excesso(a,2) - ListaOrdenada(i,6); % \nListaOrdenada(:,6) = Pot\u00eancia utilizada pelo carregador \n                end \n            end           \n        end    \n        % Periodos \n        % string3 = sprintf('Custo de carregamento: %.2f \nEuros\\n',ListaOrdenada(i,10)); \n        % disp(string3) \n    end     \n    subplot(5,1,2) %Interm\u00e9dio \n    plot(excesso(:,1),excesso(:,2),'LineWidth',1); \nend \n  \n%% Per\u00edodos de carregamento em fun\u00e7\u00e3o do pre\u00e7o da energia MIBEL \nconsumo(:,1) = excesso(:,1); \nconsumo(:,2) = excesso_original; \ndisp('-----------------------------------------------------------------------\n--------------------------------------------------------') \ndisp('Carregamento em fun\u00e7\u00e3o do pre\u00e7o da energia') \n  \nfor i=1:size(ListaOrdenada) %Ciclo corrido para cada ve\u00edculo (iterativo) \n    Periodos = 0; \n    z = 1; \n    run Janela.m \n       if ListaOrdenada(i,9) > size(excesso_adaptado_ordenado) %Mensagem de \nerro caso n\u00e3o haja tempo suficiente para carregar o VE \n           run Erro.m \n       else \n           %disp('-----------------------------------------------------------\n--------------------------------------------------------------------') \n           %string2 = sprintf('\\nVe\u00edculo %d: \\n - Hora de chegada: %.2fh \\n - \nHora prevista de sa\u00edda: %.2fh \\n - Ir\u00e1 carregar nos seguintes per\u00edodos \n\n\n\n 59 \n\n(precisa de %d, de um total dispon\u00edveis de \n%d):',ListaOrdenada(i,1),ListaOrdenada(i,2),ListaOrdenada(i,7),ListaOrdenada(\ni,9),size(excesso_adaptado_ordenado,1)); \n           %disp(string2) \n           for k=1:ListaOrdenada(i,9) %ListaOrdenada(:,9) = N\u00famero de \nper\u00edodos necess\u00e1rios \n               Periodos(k,:) = excesso_adaptado_ordenado(k);  \n               ListaOrdenada(i,11) = ListaOrdenada(i,11) + ListaOrdenada(i,6) \n* excesso_adaptado_ordenado(k,3)/4; %C\u00e1lculo do custo de carregamento \n               for a=1:size(excesso) %Subtra\u00e7\u00e3o da energia gasta pelo ve\u00edculo \nao diagrama de excessos \n                   if excesso_adaptado_ordenado(k) == excesso(a,1) \n%size(excesso) = 96. O ciclo if ir\u00e1 percorrer a matriz \"excesso\", quando a \nhora do \"per\u00edodo\" for igual ao \"excesso\" ir\u00e1 ser subtra\u00edda a energia \nnecess\u00e1ria pelo VE ao excesso atual \n                       consumo(a,2) = consumo(a,2) - ListaOrdenada(i,6); % \nListaOrdenada(:,6) = Pot\u00eancia utilizada pelo carregador \n                   end \n               end \n           end \n           Periodos; \n           %string3 = sprintf('Custo de carregamento: %.2f \nEuros\\n',ListaOrdenada(i,11)); \n           %disp(string3) \n       end \n       consumo; \n       subplot(5,1,4) %Interm\u00e9dio \n       hold on \n       plot(consumo(:,1),consumo(:,2),'LineWidth',1); \nend \n  \n  \nrun Plots.m \n  \n%% Carregamento n\u00e3o inteligente \nexcesso = excesso9_10; \n  \ndisp('--------------------------------------------------------------------') \ndisp('Carregamento n\u00e3o inteligente') \nfor i=1:size(ListaOrdenada) %Ciclo corrido para cada ve\u00edculo (iterativo) \n    Periodos = 0; \n    z = 2; \n    run Janela.m \n       if ListaOrdenada(i,9) > size(excesso_adaptado_ordenado) %Mensagem de \nerro caso n\u00e3o haja tempo suficiente para carregar o VE \n           run Erro.m \n       else \n           %disp('-----------------------------------------------------------\n--------------------------------------------------------------------') \n           %string2 = sprintf('\\nVe\u00edculo %d: \\n - Hora de chegada: %.2fh \\n - \nHora prevista de sa\u00edda: %.2fh \\n - Ir\u00e1 carregar nos seguintes per\u00edodos \n(precisa de %d, de um total dispon\u00edveis de \n%d):',ListaOrdenada(i,1),ListaOrdenada(i,2),ListaOrdenada(i,7),ListaOrdenada(\ni,9),size(excesso_adaptado_ordenado,1)); \n           %disp(string2) \n           for k=1:ListaOrdenada(i,9) %ListaOrdenada(:,9) = N\u00famero de \nper\u00edodos necess\u00e1rios \n               Periodos(k,:) = excesso_adaptado_ordenado(k);  \n               ListaOrdenada(i,12) = ListaOrdenada(i,12) + ListaOrdenada(i,6) \n* excesso_adaptado_ordenado(k,3)/4; %C\u00e1lculo do custo de carregamento \n               for a=1:size(excesso) %Subtra\u00e7\u00e3o da energia gasta pelo ve\u00edculo \nao diagrama de excessos \n                   if excesso_adaptado_ordenado(k) == excesso(a,1) \n%size(excesso) = 96. O ciclo if ir\u00e1 percorrer a matriz \"excesso\", quando a \n\n\n\n 60 \n\nhora do \"per\u00edodo\" for igual ao \"excesso\" ir\u00e1 ser subtra\u00edda a energia \nnecess\u00e1ria pelo VE ao excesso atual \n                    excesso(a,2) = excesso(a,2) - ListaOrdenada(i,6); % \nListaOrdenada(:,6) = Pot\u00eancia utilizada pelo carregador \n                end \n               end \n           end \n           Periodos; \n           %string3 = sprintf('Custo de carregamento: %.2f \nEuros\\n',ListaOrdenada(i,12)); \n           %disp(string3) \n       end \n        \n       subplot(5,1,5) %Interm\u00e9dio \n       hold on \n       plot(excesso(:,1),excesso(:,2),'LineWidth',1); \nend \nplot(excesso(:,1),excesso_original,'b','LineWidth',4); %Excesso original \ndisp('--------------------------------------------------------------------') \n%-------------------------------------------------------------------------- \n% ListaOrdenada \n  \n%% ---------------------------------------- Dia 2 e 3 de fevereiro de 2017 \ndisp('Algortimo para os dias 2 e 3 de fevereiro de 2016') \nexcesso = excesso2_3; \nexcesso_original = excesso(:,2); \ndia1 = 2; \ndia2 = 3; \n  \nfigure \n    subplot(5,1,1) \n        hold on \n        plot(excesso(:,1),excesso_original,'LineWidth',3); %Excesso original \n    subplot(5,1,2) \n        hold on \n        plot(excesso(:,1),excesso_original,'b','LineWidth',3); %Excesso \noriginal \n        LV4 = line([h h],[-500 200]); %Linha vertical hora atual hipot\u00e9tica \n        LV4.Color = 'blue'; \n        LV4.LineStyle = '--'; \n    subplot(5,1,3) \n        hold on \n        plot(excesso(:,1),excesso(:,3),'LineWidth',3); %Custo energia MIBEL \n        plot(excesso(:,1),excesso(:,4),'LineWidth',3); %Custo energia bi-\nhor\u00e1rio \n    subplot(5,1,4) \n        hold on \n        plot(excesso(:,1),excesso_original,'b','LineWidth',3); %Excesso \noriginal \n        LV4 = line([h h],[-500 200]); %Linha vertical hora atual hipot\u00e9tica \n        LV4.Color = 'blue'; \n        LV4.LineStyle = '--'; \n    subplot(5,1,5) \n        hold on \n        plot(excesso(:,1),excesso_original,'b','LineWidth',3); %Excesso \noriginal \n        LV6 = line([h h],[-500 200]); %Linha vertical hora atual hipot\u00e9tica \n        LV6.Color = 'blue'; \n        LV6.LineStyle = '--'; \n  \n%% Periodos de carregamento em fun\u00e7\u00e3o do excesso de energia renov\u00e1vel \ndisp('-----------------------------------------------------------------------\n--------------------------------------------------------') \ndisp('Carregamento em fun\u00e7\u00e3o do excesso de renov\u00e1vel') \nfor i=1:size(ListaOrdenada) %Ciclo corrido para cada ve\u00edculo (iterativo) \n\n\n\n 61 \n\n    Periodos = 0; \n    z = 0; \n    custo = [excesso(:,1);excesso(:,3)]'; \n    run Janela.m   \n    if ListaOrdenada(i,9) > size(excesso_adaptado_ordenado) %Mensagem de erro \ncaso n\u00e3o haja tempo suficiente para carregar o VE \n        run Erro.m \n    else \n        %disp('--------------------------------------------------------------\n-----------------------------------------------------------------') \n        %string2 = sprintf('\\nVe\u00edculo %d: \\n - Hora de chegada: %.2fh \\n - \nHora prevista de sa\u00edda: %.2fh \\n - Ir\u00e1 carregar nos seguintes per\u00edodos \n(precisa de %d, de um total dispon\u00edveis de \n%d):',ListaOrdenada(i,1),ListaOrdenada(i,2),ListaOrdenada(i,7),ListaOrdenada(\ni,9),size(excesso_adaptado_ordenado,1)); \n        %disp(string2) \n        for k=1:ListaOrdenada(i,9) %ListaOrdenada(:,9) = N\u00famero de periodos \nnecess\u00e1rios \n            Periodos(k,:) = excesso_adaptado_ordenado(k);  \n            ListaOrdenada(i,10) = ListaOrdenada(i,10) + ListaOrdenada(i,6) * \nexcesso_adaptado_ordenado(k,3)/4; %C\u00e1lculo do custo de carregamento \n            for a=1:size(excesso) %Subtra\u00e7\u00e3o da energia gasta pelo ve\u00edculo ao \ndiagrama de excessos \n                if excesso_adaptado_ordenado(k) == excesso(a,1) \n%size(excesso) = 96. O ciclo if ir\u00e1 percorrer a matriz \"excesso\", quando a \nhora do \"periodo\" for igual ao \"excesso\" ir\u00e1 ser subtra\u00edda a energia \nnecess\u00e1ria pelo VE ao excesso atual \n                    excesso(a,2) = excesso(a,2) - ListaOrdenada(i,6); % \nListaOrdenada(:,6) = Pot\u00eancia utilizada pelo carregador \n                end \n            end           \n        end    \n        %Periodos \n        %string3 = sprintf('Custo de carregamento: %.2f \nEuros\\n',ListaOrdenada(i,10)); \n        %disp(string3) \n    end     \n    subplot(5,1,2) %Interm\u00e9dio \n    hold on \n    plot(excesso(:,1),excesso(:,2),'LineWidth',1); \nend \n  \n%% Per\u00edodos de carregamento em fun\u00e7\u00e3o do pre\u00e7o da energia MIBEL \nconsumo(:,1) = excesso(:,1); \nconsumo(:,2) = excesso_original; \ndisp('-----------------------------------------------------------------------\n--------------------------------------------------------') \ndisp('Carregamento em fun\u00e7\u00e3o do pre\u00e7o da energia') \n  \nfor i=1:size(ListaOrdenada) %Ciclo corrido para cada ve\u00edculo (iterativo) \n    Periodos = 0; \n    z = 1; \n    run Janela.m \n       if ListaOrdenada(i,9) > size(excesso_adaptado_ordenado) %Mensagem de \nerro caso n\u00e3o haja tempo suficiente para carregar o VE \n           run Erro.m \n       else \n           %disp('-----------------------------------------------------------\n--------------------------------------------------------------------') \n           %string2 = sprintf('\\nVe\u00edculo %d: \\n - Hora de chegada: %.2fh \\n - \nHora prevista de sa\u00edda: %.2fh \\n - Ir\u00e1 carregar nos seguintes per\u00edodos \n(precisa de %d, de um total dispon\u00edveis de \n%d):',ListaOrdenada(i,1),ListaOrdenada(i,2),ListaOrdenada(i,7),ListaOrdenada(\ni,9),size(excesso_adaptado_ordenado,1)); \n           %disp(string2) \n\n\n\n 62 \n\n           for k=1:ListaOrdenada(i,9) %ListaOrdenada(:,9) = N\u00famero de \nperiodos necess\u00e1rios \n               Periodos(k,:) = excesso_adaptado_ordenado(k);  \n               ListaOrdenada(i,11) = ListaOrdenada(i,11) + ListaOrdenada(i,6) \n* excesso_adaptado_ordenado(k,3)/4; %C\u00e1lculo do custo de carregamento \n               for a=1:size(excesso) %Subtra\u00e7\u00e3o da energia gasta pelo ve\u00edculo \nao diagrama de excessos \n                   if excesso_adaptado_ordenado(k) == excesso(a,1) \n%size(excesso) = 96. O ciclo if ir\u00e1 percorrer a matriz \"excesso\", quando a \nhora do \"periodo\" for igual ao \"excesso\" ir\u00e1 ser subtra\u00edda a energia \nnecess\u00e1ria pelo VE ao excesso atual \n                       consumo(a,2) = consumo(a,2) - ListaOrdenada(i,6); % \nListaOrdenada(:,6) = Pot\u00eancia utilizada pelo carregador \n                   end \n               end \n           end \n           Periodos; \n           %string3 = sprintf('Custo de carregamento: %.2f \nEuros\\n',ListaOrdenada(i,11)); \n           %disp(string3) \n       end \n       consumo; \n       subplot(5,1,4) %Interm\u00e9dio \n       hold on \n       plot(consumo(:,1),consumo(:,2),'LineWidth',1); \nend \n  \nrun Plots.m \n  \n%% Carregamento n\u00e3o inteligente \nexcesso = excesso2_3; \n  \ndisp('--------------------------------------------------------------------') \ndisp('Carregamento n\u00e3o inteligente') \nfor i=1:size(ListaOrdenada) %Ciclo corrido para cada ve\u00edculo (iterativo) \n    Periodos = 0; \n    z = 2; \n    run Janela.m \n       if ListaOrdenada(i,9) > size(excesso_adaptado_ordenado) %Mensagem de \nerro caso n\u00e3o haja tempo suficiente para carregar o VE \n           run Erro.m \n       else \n           %disp('-----------------------------------------------------------\n--------------------------------------------------------------------') \n           %string2 = sprintf('\\nVe\u00edculo %d: \\n - Hora de chegada: %.2fh \\n - \nHora prevista de sa\u00edda: %.2fh \\n - Ir\u00e1 carregar nos seguintes per\u00edodos \n(precisa de %d, de um total dispon\u00edveis de \n%d):',ListaOrdenada(i,1),ListaOrdenada(i,2),ListaOrdenada(i,7),ListaOrdenada(\ni,9),size(excesso_adaptado_ordenado,1)); \n           %disp(string2) \n           for k=1:ListaOrdenada(i,9) %ListaOrdenada(:,9) = N\u00famero de \nperiodos necess\u00e1rios \n               Periodos(k,:) = excesso_adaptado_ordenado(k);  \n               ListaOrdenada(i,12) = ListaOrdenada(i,12) + ListaOrdenada(i,6) \n* excesso_adaptado_ordenado(k,3)/4; %C\u00e1lculo do custo de carregamento \n               for a=1:size(excesso) %Subtra\u00e7\u00e3o da energia gasta pelo ve\u00edculo \nao diagrama de excessos \n                   if excesso_adaptado_ordenado(k) == excesso(a,1) \n%size(excesso) = 96. O ciclo if ir\u00e1 percorrer a matriz \"excesso\", quando a \nhora do \"periodo\" for igual ao \"excesso\" ir\u00e1 ser subtra\u00edda a energia \nnecess\u00e1ria pelo VE ao excesso atual \n                    excesso(a,2) = excesso(a,2) - ListaOrdenada(i,6); % \nListaOrdenada(:,6) = Pot\u00eancia utilizada pelo carregador \n                end \n               end \n\n\n\n 63 \n\n           end \n           Periodos; \n           %string3 = sprintf('Custo de carregamento: %.2f \nEuros\\n',ListaOrdenada(i,12)); \n           %disp(string3) \n       end \n        \n       subplot(5,1,5) %Interm\u00e9dio \n       hold on \n       plot(excesso(:,1),excesso(:,2),'LineWidth',1); \nend \nplot(excesso(:,1),excesso_original,'b','LineWidth',4); %Excesso original \ndisp('--------------------------------------------------------------------') \n%-------------------------------------------------------------------------- \n% ListaOrdenada % Lista final de VE com os custos de carregamento \ntoc \n  \n\n\n\n 64 \n\n9 Anexo B - Previsao.m \n\n \n% Este script, atrav\u00e9s dos ficheiros Excel disponibilizados pelo site de  \n% informa\u00e7\u00e3o da REN (http://www.centrodeinformacao.ren.pt/) calcula o excesso \n% de energia renov\u00e1vel que existe em determinados dias \n% As informa\u00e7\u00f5es do pre\u00e7o da energia foram adquiridas em: \n%http://www.mercado.ren.pt/PT/Electr/InfoMercado/InfOp/MercOmel/Paginas/Preco\ns.aspx \n  \n%% Dados referentes a 9 de agosto de 2016 \n    data = xlsread('9ago.xlsx'); %Colocar nome do ficheiro. Por vezes ocorre \num erro que tem de se abrir o Excel normalmente e gravar novamente \n  \n    carvao = data(:,3); \n    fuel = data(:,4); \n    gas = data(:,5); \n    albufeiras = data(:,6); \n    fios = data(:,7); \n    import9 = data(:,8); \n    export9 = data(:,9); \n    PRE_hidro = data(:,10); \n    PRE_termico = data(:,11); \n    PRE_eolica = data(:,12); \n    PRE_foto = data(:,13); \n    PRE_ondas = data(:,14); \n    bombagem9 = data(:,15); \n    consumo9 = data(:,16); \n  \n    producao9 = carvao + fuel + gas + albufeiras + fios + PRE_hidro + \nPRE_termico + PRE_eolica + PRE_foto + PRE_ondas; \n    renovavel9 = albufeiras + fios +PRE_hidro + PRE_termico + PRE_eolica + \nPRE_foto + PRE_ondas; \n    excesso9 = renovavel9 - consumo9; \n     \n    preco9 = [45.1000000000000 42.5000000000000 37 35.2600000000000 \n32.5300000000000 32.5000000000000 39.7300000000000 43.7800000000000 \n44.8000000000000 43.4700000000000 39.4100000000000 40.8500000000000 \n42.1300000000000 43.4700000000000 43.4700000000000 38.7100000000000 38 38 37 \n35.8000000000000 38.4100000000000 44 44 36.0700000000000]; \n    preco9 = preco9 / 1000; \n     \n%% Dados referentes a 10 de agosto de 2016 \n    data = xlsread('10ago.xlsx'); %Colocar nome do ficheiro. Por vezes ocorre \num erro que tem de se abrir o Excel normalmente e gravar novamente pois o \nficheiro, segundo o Excel, prov\u00e9m de fontes n\u00e3o seguras. \n  \n    carvao = data(:,3); \n    fuel = data(:,4); \n    gas = data(:,5); \n    albufeiras = data(:,6); \n    fios = data(:,7); \n    import10 = data(:,8); \n    export10 = data(:,9); \n    PRE_hidro = data(:,10); \n    PRE_termico = data(:,11); \n    PRE_eolica = data(:,12); \n    PRE_foto = data(:,13); \n    PRE_ondas = data(:,14); \n    bombagem10 = data(:,15); \n    consumo10 = data(:,16); \n  \n\n\n\n 65 \n\n    producao10 = carvao + fuel + gas + albufeiras + fios + PRE_hidro + \nPRE_termico + PRE_eolica + PRE_foto + PRE_ondas; \n    renovavel10 = albufeiras + fios +PRE_hidro + PRE_termico + PRE_eolica + \nPRE_foto + PRE_ondas; \n    excesso10 = renovavel10 - consumo10; \n     \n    preco10 = [31.3400000000000 30.5200000000000 26.9000000000000 26 \n25.9700000000000 26.2200000000000 28.3900000000000 31.0500000000000 \n33.9500000000000 38.9800000000000 38.6300000000000 38.2900000000000 \n36.7000000000000 38.4400000000000 38.4400000000000 36.0900000000000 \n36.9000000000000 38.2900000000000 39.1200000000000 40.8400000000000 \n44.8400000000000 47.2000000000000 47 39.7000000000000]; \n    preco10 = preco10 / 1000; \n     \n%% Dados referentes a 2 de fevereiro de 2017 \n    data = xlsread('2fev.xlsx'); %Colocar nome do ficheiro. Por vezes ocorre \num erro que tem de se abrir o excel normalmente e gravar novamente pois o \nficheiro, segundo o Excel, prov\u00e9m de fontes n\u00e3o seguras. \n \n  \n    carvao = data(:,3); \n    fuel = data(:,4); \n    gas = data(:,5); \n    albufeiras = data(:,6); \n    fios = data(:,7); \n    import2 = data(:,8); \n    export2 = data(:,9); \n    PRE_hidro = data(:,10); \n    PRE_termico = data(:,11); \n    PRE_eolica = data(:,12); \n    PRE_foto = data(:,13); \n    PRE_ondas = data(:,14); \n    bombagem2 = data(:,15); \n    consumo2 = data(:,16); \n  \n    producao2 = carvao + fuel + gas + albufeiras + fios + PRE_hidro + \nPRE_termico + PRE_eolica + PRE_foto + PRE_ondas; \n    renovavel2 = albufeiras + fios +PRE_hidro + PRE_termico + PRE_eolica + \nPRE_foto + PRE_ondas; \n    excesso2 = renovavel2 - consumo2; \n     \n    preco2 = [41.1100000000000 38.7400000000000 36.9400000000000 \n33.9000000000000 33.8500000000000 33.7700000000000 39.9100000000000 \n55.5800000000000 57.1900000000000 59.1000000000000 58.6900000000000 \n57.6600000000000 57.6600000000000 54.4400000000000 50.9000000000000 \n47.1000000000000 45.9800000000000 48.8000000000000 56.1100000000000 \n60.7900000000000 61.2300000000000 60.7100000000000 49.6100000000000 \n42.1200000000000]; \n    preco2 = preco2 / 1000; \n     \n%% Dados referentes a 3 de fevereiro de 2017 \n    data = xlsread('3fev.xlsx'); %Colocar nome do ficheiro. Por vezes ocorre \num erro que tem de se abrir o excel normalmente e gravar novamente pois o \nficheiro, segundo o Excel, prov\u00e9m de fontes n\u00e3o seguras. \n \n  \n    carvao = data(:,3); \n    fuel = data(:,4); \n    gas = data(:,5); \n    albufeiras = data(:,6); \n    fios = data(:,7); \n    import3 = data(:,8); \n    export3 = data(:,9); \n    PRE_hidro = data(:,10); \n    PRE_termico = data(:,11); \n\n\n\n 66 \n\n    PRE_eolica = data(:,12); \n    PRE_foto = data(:,13); \n    PRE_ondas = data(:,14); \n    bombagem3 = data(:,15); \n    consumo3 = data(:,16); \n  \n    producao3 = carvao + fuel + gas + albufeiras + fios + PRE_hidro + \nPRE_termico + PRE_eolica + PRE_foto + PRE_ondas; \n    renovavel3 = albufeiras + fios +PRE_hidro + PRE_termico + PRE_eolica + \nPRE_foto + PRE_ondas; \n    excesso3 = renovavel3 - consumo3; \n     \n    preco3 = [39.8700000000000 34.9200000000000 34.2600000000000 \n32.5500000000000 32.4900000000000 34.5800000000000 40 52.6000000000000 \n53.6200000000000 55.7900000000000 56.6700000000000 55.9700000000000 \n54.3700000000000 53.6700000000000 51.9600000000000 48.4700000000000 \n47.4700000000000 52.0100000000000 55.7900000000000 58.2900000000000 \n53.6900000000000 52.6200000000000 44.2500000000000 39.8500000000000]; \n    preco3 = preco3 / 1000; \n     \n%% Associa\u00e7\u00f5es de dias de modo a ter uma janela n\u00e3o de um mas de dois dias \n% 9 com 10 de agosto \n    excesso9_10(1:96) = excesso9; \n    excesso9_10(97:192) = excesso10; \n     \n    producao9_10(1:96) = producao9; \n    producao9_10(97:192) = producao10; \n     \n    consumo9_10(1:96) = consumo9; \n    consumo9_10(97:192) = consumo10; \n     \n    bombagem9_10(1:96) = bombagem9; \n    bombagem9_10(97:192) = bombagem10; \n     \n    renovavel9_10(1:96) = renovavel9; \n    renovavel9_10(97:192) = renovavel10; \n     \n    export9_10(1:96) = export9; \n    export9_10(97:192) = export10; \n     \n    import9_10(1:96) = import9; \n    import9_10(97:192) = import10; \n     \n%2 com 3 de fevereiro \n    excesso2_3(1:96) = excesso2; \n    excesso2_3(97:192) = excesso3; \n     \n    producao2_3(1:96) = producao2; \n    producao2_3(97:192) = producao3; \n     \n    consumo2_3(1:96) = consumo2; \n    consumo2_3(97:192) = consumo3; \n     \n    bombagem2_3(1:96) = bombagem2; \n    bombagem2_3(97:192) = bombagem3; \n     \n    renovavel2_3(1:96) = renovavel2; \n    renovavel2_3(97:192) = renovavel3; \n     \n    export2_3(1:96) = export3; \n    export2_3(97:192) = export3; \n     \n    import2_3(1:96) = import3; \n    import2_3(97:192) = import3; \n     \n\n\n\n 67 \n\n    %Os pre\u00e7os est\u00e3o variam a cada hora. \u00c9 preciso ter valores de 15 em 15 \nmim tal como os diagramas de energia \n    i=1; \nfor j=1:24 %Pre\u00e7os de dia 2 com 96 valores. \n    preco2_96(i) = preco2(j); \n    i=i+1; \n    preco2_96(i) = preco2(j); \n    i=i+1; \n    preco2_96(i) = preco2(j); \n    i=i+1; \n    preco2_96(i) = preco2(j); \n    i=i+1; \nend \n  \n    i=1; \nfor j=1:24 %Pre\u00e7os de dia 3 com 96 valores. \n    preco3_96(i) = preco3(j); \n    i=i+1; \n    preco3_96(i) = preco3(j); \n    i=i+1; \n    preco3_96(i) = preco3(j); \n    i=i+1; \n    preco3_96(i) = preco3(j); \n    i=i+1; \nend \n  \npreco2_3(1:96) = preco2_96; \npreco2_3(97:192) = preco3_96; \n  \ni=1; \nfor j=1:24 %Pre\u00e7os de dia 9 com 96 valores. \n    preco9_96(i) = preco9(j); \n    i=i+1; \n    preco9_96(i) = preco9(j); \n    i=i+1; \n    preco9_96(i) = preco9(j); \n    i=i+1; \n    preco9_96(i) = preco9(j); \n    i=i+1; \nend \n  \n    i=1; \nfor j=1:24 %Pre\u00e7os de dia 3 com 96 valores. \n    preco10_96(i) = preco10(j); \n    i=i+1; \n    preco10_96(i) = preco10(j); \n    i=i+1; \n    preco10_96(i) = preco10(j); \n    i=i+1; \n    preco10_96(i) = preco10(j); \n    i=i+1; \nend \n  \npreco9_10(1:96) = preco9_96; \npreco9_10(97:192) = preco10_96; \n  \n%Pre\u00e7os tarifa bi-hor\u00e1ria \nn = 0.1942; \nv = 0.1014; \nbi = [v v v v v v v v n n n n n n n n n n n n n n v v]; \ni = 1; \nfor j=1:24 \n    bi_96(i) = bi(j); \n    i=i+1; \n    bi_96(i) = bi(j); \n\n\n\n 68 \n\n    i=i+1; \n    bi_96(i) = bi(j); \n    i=i+1; \n    bi_96(i) = bi(j); \n    i=i+1; \nend \n     \nbi_2_96(1:96) = bi_96; %Adaptar tarifa bi-hor\u00e1ria para 2 dias \nbi_2_96(97:192) = bi_96; \nbi_2_96 = bi_2_96 * 1.23; %(IVA) \n  \n%% Graficos 9 e 10 de agosto de 2016 \nx = 0:0.25:47.75; \n  \nfigure \n    subplot(3,1,1) % Diagrama Nacional \n        hold on \n        grid on \n  \n        yyaxis left \n            ylabel('MW','fontweight','bold') \n            a1 = area(x,consumo9_10+bombagem9_10); \n            a1.FaceColor = [255/255;211/255;155/255]; \n  \n            a2 = area(x,producao9_10); \n            a2.FaceColor = [191/255;239/255;255/255]; \n  \n            plot(x,consumo9_10 + bombagem9_10,'b','LineWidth',2); \n            plot(x,consumo9_10,'k','LineWidth',4); \n            plot(x,renovavel9_10,'g','LineWidth',2) \n  \n        yyaxis right \n            plot(x,preco9_10) \n            ylabel('E/MWh','fontweight','bold') \n  \n        title('Diagrama de Consumo Total - 9 e 10 de agosto de \n2016','fontweight','bold','fontsize',14) \n        legend('Importa\u00e7\u00e3o','Produ\u00e7\u00e3o','Consumo+Bombagem','Consumo','Renov\u00e1ve\nl','Custo Energia','Location','southeast') \n        xlabel('Horas','fontweight','bold'); \n        horizontal = line([0 48],[0 0]); %Linha horizontal y = 0 \n        horizontal.Color = 'black'; \n        set(gca,'XTick',0:2:48); %Aumentar o n\u00famero de espa\u00e7amentos no eixo x \n        xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 \n20 22 24}) \n        xlim([0 48]) \n  \n    subplot(3,1,2) % Balan\u00e7o Renov\u00e1vel \n        hold on \n        grid on \n  \n        aux1 = excesso9_10; \n        a3 = area(x,aux1); \n        a3.FaceColor = [202/255;255/255;112/255]; \n  \n        title('Balan\u00e7o Energia Renov\u00e1vel - 9 e 10 de agosto de 2016 (face ao \nconsumo)','fontweight','bold','fontsize',14) \n        legend('Balan\u00e7o energia renov\u00e1vel') \n        ylabel('MW','fontweight','bold') \n        xlabel('Horas','fontweight','bold'); \n        horizontal = line([0 48],[0 0]); %Linha horizontal y = 0 \n        horizontal.Color = 'black'; \n        set(gca,'XTick',0:2:48); %Aumentar o n\u00famero de espa\u00e7amentos no eixo x \n        xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 \n20 22 24}) \n\n\n\n 69 \n\n        xlim([0 48]) \n         \n    subplot(3,1,3); %Saldo Importador e Bombagem \n        hold on \n        grid on  \n  \n        a4 = area(x,bombagem9_10); \n        a4.FaceColor = [56/255;176/255;222/255]; \n        alpha(.7) \n  \n        a5 = area(x,-export9_10); \n        a5.FaceColor = [255/255 127/255 36/255]; \n  \n        a6 = area(x,import9_10); \n        a6.FaceColor = [255/255;211/255;155/255]; \n  \n        title('Saldo Importador e \nBombagem','fontweight','bold','fontsize',14) \n        legend('Bombagem','Exporta\u00e7\u00e3o','Importa\u00e7\u00e3o'); \n        ylabel('MW','fontweight','bold') \n        xlabel('Horas','fontweight','bold'); \n        xlim([0 23.5]) \n        set(gca,'XTick',0:1:24); %Aumentar o n\u00famero de espa\u00e7amentos no eixo x \n         \n%% Gr\u00e1ficos 2 e 3 de fevereiro de 2017    \nfigure     \n    subplot(3,1,1) % Diagrama Nacional \n        hold on \n        grid on \n  \n        yyaxis left \n            ylabel('MW','fontweight','bold') \n            a7 = area(x,consumo2_3+bombagem2_3); \n            a7.FaceColor = [255/255;211/255;155/255]; \n  \n            a8 = area(x,producao2_3); \n            a8.FaceColor = [191/255;239/255;255/255]; \n  \n            plot(x,consumo2_3 + bombagem2_3,'b','LineWidth',2); \n            plot(x,consumo2_3,'k','LineWidth',4); \n            plot(x,renovavel2_3,'g','LineWidth',2) \n  \n        yyaxis right \n            plot(x,preco2_3) \n            ylabel('E/MWh','fontweight','bold') \n  \n        title('Diagrama de Consumo Total - 2 e 3 de fevereiro de \n2017','fontweight','bold','fontsize',14) \n        legend('Importa\u00e7\u00e3o','Produ\u00e7\u00e3o','Consumo+Bombagem','Consumo','Renovave\nl','Custo Energia','Location','southeast') \n        xlabel('Horas','fontweight','bold'); \n        horizontal = line([0 48],[0 0]); %Linha horizontal y = 0 \n        horizontal.Color = 'black'; \n        set(gca,'XTick',0:2:48); %Aumentar o n\u00famero de espa\u00e7amentos no eixo x \n        xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 \n20 22 24}) \n        xlim([0 48]) \n  \n    subplot(3,1,2) % Balan\u00e7o Renov\u00e1vel \n        grid on \n        plot(x,excesso2_3) \n  \n        aux2 = excesso2_3; \n        a9 = area(x,aux2); \n        a9.FaceColor = [202/255;255/255;112/255]; \n\n\n\n 70 \n\n  \n        title('Balan\u00e7o Energia Renov\u00e1vel - 2 e 3 de fevereiro de 2017 (face \nao consumo)','fontweight','bold','fontsize',14) \n        legend('Balan\u00e7o energia renov\u00e1vel') \n        xlabel('Horas','fontweight','bold'); \n        ylabel('MW','fontweight','bold') \n        horizontal = line([0 48],[0 0]); %Linha horizontal y = 0 \n        horizontal.Color = 'black'; \n        set(gca,'XTick',0:2:48); %Aumentar o n\u00famero de espa\u00e7amentos no eixo x \n        xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 \n20 22 24}) \n        xlim([0 48]) \n         \n    subplot(3,1,3); %Saldo Importador e Bombagem \n        hold on \n        grid on  \n  \n        a10 = area(x,bombagem2_3); \n        a10.FaceColor = [56/255;176/255;222/255]; \n        alpha(.7) \n  \n        a11 = area(x,-export2_3); \n        a11.FaceColor = [255/255 127/255 36/255]; \n  \n        a12 = area(x,import2_3); \n        a12.FaceColor = [255/255;211/255;155/255]; \n  \n        title('Saldo Importador e \nBombagem','fontweight','bold','fontsize',14) \n        legend('Bombagem','Exporta\u00e7\u00e3o','Importa\u00e7\u00e3o'); \n        ylabel('MW','fontweight','bold') \n        xlabel('Horas','fontweight','bold'); \n        xlim([0 23.5]) \n        set(gca,'XTick',0:1:24); %Aumentar o n\u00famero de espa\u00e7amentos no eixo x \n  \n%% Pre\u00e7o real pago pelos consumidores \n% Estamos a utilizar os dados do MIBEL para termos tarifas vari\u00e1veis hora a \nhora.  \n% A \u00fanica incoer\u00eancia \u00e9 o seu valor absoluto. Quando houver tarifas em tempo  \n% real \u00e9 normal que estas acompanhem a varia\u00e7\u00e3o do MIBEL, mas o valor \nabsoluto  \n% da tarifa que chega ao cliente final \u00e9 obviamente mais alto (para pagar  \n% transporte, distribui\u00e7\u00e3o, margens de lucro, etc.). \n% Assim, para termos valores mais realistas o ideal \u00e9 utilizar a varia\u00e7\u00e3o  \n% da tarifa no MIBEL nesse dia, mas multiplicada por um fator que a relacione \n% com o pre\u00e7o final. \n  \n% Considerando a tarifa \n% \nhttp://www.edpsu.pt/pt/particulares/tarifasehorarios/BTN/Pages/TarifasBTNate2\n0.7kVA.aspx \n% [ 0,1942*1.23(IVA)*14(horas) + 0,1014*1.23(IVA)*10(horas) ] / 24 (horas) \n  \n% Podemos tamb\u00e9m calcular o pre\u00e7o m\u00e9dio do MIBEL para esse dia durante as  \n% 24 horas (M) e ter assim o fator que relaciona os pre\u00e7os m\u00e9dios F=C/M \n% Basta assim multiplicar os valores do MIBEL por F para no final termos um  \n% custo da energia m\u00e9dio que corresponde ao custo atual para o cliente final, \n% mas com uma varia\u00e7\u00e3o igual \u00e0 do MIBEL. \n  \nC = (0.1942*1.23*14 + 0.1014*1.23*10) / 24; \n  \nM9_10 = mean(preco9_10); \nF9_10 = C/M9_10; \n  \nM2_3 = mean(preco2_3);  \n\n\n\n 71 \n\nF2_3 = C/M2_3; \n  \npreco9_10 = preco9_10 * F9_10; \npreco2_3 = preco2_3 * F2_3; \n  \n%------------------------------------------------------------------------- \n% Alterar daqui para baixo caso se pretenda usar pre\u00e7os bi-hor\u00e1rio \n  \nexcesso9_10 = [x' excesso9_10'/r preco9_10' bi_2_96']; \nexcesso2_3 = [x' excesso2_3'/r preco2_3' bi_2_96']; \n  \n% Inverter coment\u00e1rios \n  \n% excesso9_10 = [x' excesso9_10'/r bi_2_96' bi_2_96']; \n% excesso2_3 = [x' excesso2_3'/r bi_2_96' bi_2_96']; \n  \n\n\n\n 72 \n\n10 Anexo C - ListaVE.m \n\n \n% Lista de VE a carregar. \n% Na realidade ser\u00e1 introduzido no sistema um a um (iterativo). \n% Cada carro, ao ser conectado ao sistema, ir\u00e1 executar de imediato o \nalgoritmo. \n% Cada VE \u00e9 uma linha. \n  \n%INFORMA\u00c7\u00d5ES RECOLHIDAS (por esta ordem; cada coluna uma informa\u00e7\u00e3o): \n% 1 - N\u00famero de entrada do Ve\u00edculo \n% 2 - Hora de chegada do ve\u00edculo (horas) \n% 3 - Capacidade da bateria (kWh) \n% 4 - SOC pretendido (%) \n% 5 - SOC atual (%) \n% 6 - Pot\u00eancia do carregador (kW) \n% 7 - Hora prevista de sa\u00edda (horas) \n% 8 - Tempo de carregamento (horas) \n% 9 - N\u00famero de per\u00edodos necess\u00e1rios (arredondado por excesso)  \n% 10 - Custo de carregamento indo pelo excesso de renov\u00e1vel (em Euros) \n% 11 - Custo de carregamento indo pelo custo de energia (em Euros) \n% 12 - Custo de carregamento indo por carregamento normal (Euros) \n  \n%Cen\u00e1rio real \nLista = [ \n%    1    2     3   4   5   6   7   8  9 10 11 12 \n    001 11.00 30.0 100 000 00 18.00 0 00 00 00 00 \n    002 13.00 30.0 100 000 00 17.00 0 00 00 00 00 \n    003 14.00 30.0 100 000 00 06.00 0 00 00 00 00 \n    004 15.00 30.0 100 000 00 07.00 0 00 00 00 00 \n    005 19.00 30.0 100 000 00 08.00 0 00 00 00 00 \n    006 20.00 30.0 100 000 00 08.00 0 00 00 00 00 \n    007 21.00 30.0 100 000 00 07.00 0 00 00 00 00 \n    008 22.00 30.0 100 000 00 08.00 0 00 00 00 00 \n    009 23.00 30.0 100 000 00 09.00 0 00 00 00 00 \n    010 24.00 30.0 100 000 00 09.00 0 00 00 00 00 \n    011 12.50 30.0 100 000 00 06.00 0 00 00 00 00 \n    012 13.00 30.0 100 000 00 08.00 0 00 00 00 00 \n    013 14.00 30.0 100 000 00 08.00 0 00 00 00 00 \n    014 15.00 30.0 100 000 00 08.00 0 00 00 00 00 \n    015 19.00 30.0 100 000 00 09.00 0 00 00 00 00 \n    016 20.00 30.0 100 000 00 09.00 0 00 00 00 00 \n    017 21.00 30.0 100 000 00 12.00 0 00 00 00 00 \n    018 22.00 30.0 100 000 00 16.00 0 00 00 00 00 \n    019 23.00 30.0 100 000 00 16.00 0 00 00 00 00 \n    020 24.00 30.0 100 000 00 16.00 0 00 00 00 00  \n    021 19.00 12.0 100 000 00 10.00 0 00 00 00 00 \n    022 22.00 12.0 100 000 00 16.00 0 00 00 00 00 \n    023 20.00 12.0 100 000 00 09.00 0 00 00 00 00 \n    024 22.00 12.0 100 000 00 08.00 0 00 00 00 00 \n    025 14.00 12.0 100 000 00 08.00 0 00 00 00 00 \n    026 20.00 12.0 100 000 00 08.00 0 00 00 00 00 \n    027 21.00 12.0 100 000 00 09.00 0 00 00 00 00 \n    028 19.00 12.0 100 000 00 09.00 0 00 00 00 00 \n    029 21.00 12.0 100 000 00 08.00 0 00 00 00 00 \n    030 20.00 12.0 100 000 00 09.00 0 00 00 00 00 \n    031 21.00 12.0 100 000 00 10.00 0 00 00 00 00 \n    032 14.00 12.0 100 000 00 08.00 0 00 00 00 00 \n    033 22.00 12.0 100 000 00 09.00 0 00 00 00 00 \n    034 22.00 12.0 100 000 00 17.00 0 00 00 00 00 \n    035 19.00 12.0 100 000 00 08.00 0 00 00 00 00 \n    036 22.00 12.0 100 000 00 09.00 0 00 00 00 00 \n    037 21.00 12.0 100 000 00 09.00 0 00 00 00 00 \n    038 14.00 41.0 100 000 00 09.00 0 00 00 00 00 \n\n\n\n 73 \n\n    039 22.00 41.0 100 000 00 09.00 0 00 00 00 00 \n    040 23.00 41.0 100 000 00 17.00 0 00 00 00 00 \n    041 13.00 41.0 100 000 00 08.00 0 00 00 00 00 \n    042 20.00 41.0 100 000 00 10.00 0 00 00 00 00 \n    043 21.00 41.0 100 000 00 08.00 0 00 00 00 00 \n    044 21.00 41.0 100 000 00 09.00 0 00 00 00 00 \n    045 20.00 41.0 100 000 00 09.00 0 00 00 00 00 \n    046 20.00 41.0 100 000 00 09.00 0 00 00 00 00 \n    047 21.00 41.0 100 000 00 09.00 0 00 00 00 00 \n    048 14.00 41.0 100 000 00 08.00 0 00 00 00 00 \n    049 22.00 41.0 100 000 00 09.00 0 00 00 00 00 \n    050 20.00 41.0 100 000 00 08.00 0 00 00 00 00 \n    051 19.00 41.0 100 000 00 08.00 0 00 00 00 00 \n    052 14.00 41.0 100 000 00 09.00 0 00 00 00 00 \n    053 15.00 41.0 100 000 00 09.00 0 00 00 00 00 \n    054 20.00 33.0 100 000 00 09.00 0 00 00 00 00 \n    055 22.00 33.0 100 000 00 08.00 0 00 00 00 00 \n    056 13.00 33.0 100 000 00 08.00 0 00 00 00 00 \n    057 21.00 33.0 100 000 00 08.00 0 00 00 00 00 \n    058 20.00 33.0 100 000 00 08.00 0 00 00 00 00 \n    059 20.00 33.0 100 000 00 08.00 0 00 00 00 00 \n    060 21.00 33.0 100 000 00 09.00 0 00 00 00 00 \n    061 22.00 33.0 100 000 00 09.00 0 00 00 00 00 \n    062 14.00 33.0 100 000 00 09.00 0 00 00 00 00 \n    063 22.00 33.0 100 000 00 08.00 0 00 00 00 00 \n    064 20.00 33.0 100 000 00 09.00 0 00 00 00 00 \n    065 21.00 33.0 100 000 00 08.00 0 00 00 00 00 \n    066 22.00 33.0 100 000 00 08.00 0 00 00 00 00 \n    067 14.00 06.2 100 000 00 08.00 0 00 00 00 00 \n    068 21.00 06.2 100 000 00 09.00 0 00 00 00 00 \n    069 21.00 06.2 100 000 00 08.00 0 00 00 00 00 \n    070 20.00 06.2 100 000 00 08.00 0 00 00 00 00 \n    071 22.00 06.2 100 000 00 08.00 0 00 00 00 00 \n    072 21.00 06.2 100 000 00 08.00 0 00 00 00 00 \n    073 21.00 06.2 100 000 00 08.00 0 00 00 00 00 \n    074 21.00 06.2 100 000 00 08.00 0 00 00 00 00 \n    075 23.00 06.2 100 000 00 17.00 0 00 00 00 00 \n    076 21.00 06.2 100 000 00 08.00 0 00 00 00 00 \n    077 22.00 06.2 100 000 00 17.00 0 00 00 00 00 \n    079 21.00 06.2 100 000 00 08.00 0 00 00 00 00 \n    078 22.00 06.2 100 000 00 09.00 0 00 00 00 00 \n    080 21.00 08.0 100 000 00 09.00 0 00 00 00 00 \n    081 19.00 08.0 100 000 00 09.00 0 00 00 00 00 \n    082 22.00 08.0 100 000 00 08.00 0 00 00 00 00 \n    083 21.00 08.0 100 000 00 08.00 0 00 00 00 00 \n    084 21.00 08.0 100 000 00 08.00 0 00 00 00 00 \n    085 21.00 08.0 100 000 00 08.00 0 00 00 00 00 \n    086 20.00 08.0 100 000 00 09.00 0 00 00 00 00 \n    087 22.00 07.0 100 000 00 09.00 0 00 00 00 00 \n    088 20.00 07.0 100 000 00 09.00 0 00 00 00 00 \n    089 23.00 07.0 100 000 00 17.00 0 00 00 00 00 \n    090 21.00 07.0 100 000 00 09.00 0 00 00 00 00 \n    091 19.00 07.0 100 000 00 09.00 0 00 00 00 00 \n    092 22.00 07.0 100 000 00 17.00 0 00 00 00 00 \n    093 20.00 06.1 100 000 00 09.00 0 00 00 00 00 \n    094 22.00 06.1 100 000 00 08.00 0 00 00 00 00 \n    095 24.00 06.1 100 000 00 18.00 0 00 00 00 00 \n    096 20.00 07.6 100 000 00 08.00 0 00 00 00 00 \n    097 20.00 07.6 100 000 00 09.00 0 00 00 00 00 \n    098 15.00 07.6 100 000 00 08.00 0 00 00 00 00 \n    099 20.00 09.0 100 000 00 17.00 0 00 00 00 00 \n    100 19.00 09.0 100 000 00 08.00 0 00 00 00 00 \n]; \n  \n   \n\n\n\n 74 \n\nfor i=1:size(Lista) %Estimativa SOC atual \n    % Admitindo m\u00e9dia de consumo de 3kWh - 6 kWh por dia (cap\u00edtulo 4.3) \n    Lista(i,5) = (Lista(i,3) - randi([3 6]))*100 / Lista(i,3); \nend \n  \nfor i=1:size(Lista) %Estimativa Pot\u00eancia do carregador  \n    % Valor vari\u00e1vel compreendido entre 10 e 32 Amperes. \n    % Convertido para pot\u00eancia usando uma tens\u00e3o igual a 230 V \n    Lista(i,6) = randi([10 32])*230/1000; \nend \n  \nF = 1; %Fator que multiplica a nossa lista de VE por um fator f. \nLista = repmat(Lista,F,1); \n% \u00datil caso se queira simular um maior n\u00famero de VEs. \n  \n\n\n\n 75 \n\n11 Anexo D - Tempo.m \n\n \n% Calculo do tempo de carregamento para cada ve\u00edculo. \n% A Lista fica ordenada por ordem de chegada \n  \nfor i=1:size(Lista,1) \n    Lista(i,8) = Lista(i,3) * (Lista(i,4)-Lista(i,5))/100/Lista(i,6); \n%C\u00e1lculo do tempo \n    Lista(i,9) = Lista(i,8)/(48/192); %C\u00e1lculo dos per\u00edodos necess\u00e1rios \n(quantos 15 mim precisa)(h\u00e1 96 per\u00edodos por dia) \n    Lista(i,9) = ceil(Lista(i,9)); %Arredondamento por excesso do n.\u00ba de \nper\u00edodos \n    if Lista(i,2) &lt;h %Explicado no ponto 1 \n        Lista(i,2) = Lista(i,2) +24;  \n    end \n    if Lista(i,7) &lt;Lista(i,2) %Explicado no ponto 2 \n        Lista(i,7) = Lista(i,7) + 24; \n    end \nend \n  \nListaOrdenada = sortrows(Lista,2); %Ordenamento da Lista de VEs por ordem \ndecrescente de per\u00edodos necess\u00e1rios \n  \n% Ponto 1 \n% Hora atual = 12h. Se na lista aparecer, por exemplo, um VE com hora de \nchegada 9h, \n% significa que \u00e9 do dia seguinte, logo temos de adicionar 24h. \n  \n%Ponto 2 \n% Na lista de VE temos VE a entrar por exemplo as 20:00h e a sair as 8:00h. \n% Na verdade essas 8:00h \u00e9 do dia seguinte. Para o algoritmo funcionar \n% corretamente temos de adicionar 24 horas a esses casos. \n  \n\n\n\n 76 \n\n12 Anexo E \u2013 Erro.m \n\n% Mensagem de erro caso o ve\u00edculo n\u00e3o tenha tempo de carregar \n  \ndisp('-----------------------------------------------------------------------\n--------------------------------------------------------') \n  \nstring1 = sprintf('\\nERRO - O ve\u00edculo n\u00famero %d n\u00e3o tem tempo suficiente para \ncarregar!\\n       Hora de chegada: %0.2fh\\n       Hora prevista de sa\u00edda: \n%dh\\n       Precisa de %d per\u00edodos e s\u00f3 tem dispon\u00edveis %d.', \nListaOrdenada(i,1),ListaOrdenada(i,2),ListaOrdenada(i,7),ListaOrdenada(i,9),s\nize(excesso_adaptado_ordenado,1)); \ndisp(string1) \n  \n%Informa\u00e7\u00e3o e solu\u00e7\u00e3o alternativa: \n  \n% O ve\u00edculo s\u00f3 conseguir\u00e1 carregar x% do total: \n% size(excesso_adaptado_ordenado,1); %N\u00famero de per\u00edodos dispon\u00edveis \n% ListaOrdenada(i,9); %N\u00famero de per\u00edodos necess\u00e1rios \n  \naux1 = round(size(excesso_adaptado_ordenado,1)*100/ListaOrdenada(i,9)); % \nRegra de 3 simples \n  \n% Carga dispon\u00edvel \u00e1s x horas: \naux2 = (ListaOrdenada(i,9) - size(excesso_adaptado_ordenado,1))/4 + \nListaOrdenada(i,7); \n  \nstring2 = sprintf('       O ve\u00edculo s\u00f3 conseguir\u00e1 carregar %d%% do total da \nbateria at\u00e9 as %dh. \\n       A carga total s\u00f3 estar\u00e1 dispon\u00edvel \u00e0s %0.2f \nhoras.',aux1,ListaOrdenada(i,7),aux2); \ndisp(string2) \n \n  \n\n\n\n 77 \n\n13 Anexo F - Janela.m \n\n \n% Calculo da janela de carregamento. \n% Cada ve\u00edculo ter\u00e1 a sua pr\u00f3rpia janela tendo em conta a hora atual e a hora \nprevista de sa\u00edda. \n  \na = -9999; %Vari\u00e1vel para ajudar a calcular a janela poss\u00edvel \n  \nexcesso_adaptado = zeros(192,4); \nfor j=1:192 %Ciclo para determinar janela poss\u00edvel tendo em conta hora \nprevista de sa\u00edda  \n    if (j-1 > ListaOrdenada(i,2)*96/24 &amp;&amp; j&lt;= ListaOrdenada(i,7)*96/24) %if \nhora de sa\u00edda > hora de excesso ou periodo j > hora real em periodos de 15 \nmim, \u00e9 poss\u00edvel carregar nessa hora \n        excesso_adaptado(j,:) = excesso(j,:); %janela limitada por hora de \nsa\u00edda \n    else \n        excesso_adaptado(j,:) = a; \n    end \nend \n \n% O ciclo abaixo serve para ordenar a vari\u00e1vel excesso_adaptado_ordenado em \nfun\u00e7\u00e3o do objetivo pretendido. \n  \nif z == 0 %Ciclo em fun\u00e7\u00e3o do pre\u00e7o \n    excesso_adaptado_ordenado = flip(sortrows(excesso_adaptado,2)); \nelseif z == 1 %Ciclo excesso energia \n    excesso_adaptado_ordenado = sortrows(excesso_adaptado,3); %Modificar caso \nse pretenda trabalhar com o custo de energia \nelseif z == 2 %Carregamento normal  \n    excesso_adaptado_ordenado = excesso_adaptado; \nend \n  \nrows_to_remove = any(excesso_adaptado_ordenado==a, 2); \nexcesso_adaptado_ordenado(rows_to_remove,:) = []; \nexcesso_adaptado_ordenado; %Janela que o VEi possui ordenada por ordem \n  \n% No ciclo for, o programa cria uma matriz 192x4, a qual grande parte \u00e9 zero. \n% Ele compara uma lista de 192 n\u00fameros. Quando \u00e9 verdadeiro \u00e9 copiada a \n% informa\u00e7\u00e3o da matriz \u201cexcesso\u201d para a matriz \u201cexcesso_adaptado\u201d mas, pelo  \n% meio a compara\u00e7\u00e3o tamb\u00e9m ir\u00e1 dar falso, como o programa tem de colocar  \n% qualquer coisa na matriz, ent\u00e3o mete esses valores todos a zero. Para o  \n% problema funcionar temos de remover todas as linhas que sejam zeros o que  \n% pode dar conflitos no caso em que haja 0 de nenov\u00e1vel \u00e0s 0 horas. Para  \n% superar este problema, quando for falso atribui-se \"99999999\" e  \n% posteriormente remove-se todos os 999999. \n  \n\n\n\n 78 \n\n14 Anexo G - Plots.m \n\n \n% Gr\u00e1ficos \n%-------------------------------------------------------------------------- \nsubplot(5,1,1) %Original vs Final \n    grid on \n     \n    plot(excesso(:,1),excesso(:,2),'LineWidth',2); %Excesso final \n     \n    LV2 = line([h h],[-500 200]); %Linha vertical hora atual hipot\u00e9tica \n    LV2.Color = 'blue'; \n    LV2.LineStyle = '--'; \n         \n    LV1 = line([0 48],[0 0]); %Linha horizontal y = 0 \n    LV1.Color = 'black'; \n     \n    str=sprintf('Diagrama de Excesso de Renov\u00e1vel nos dias %d e %d de \nfevereiro de 2017',dia1,dia2); \n    title(str,'fontweight','bold','fontsize',14) \n    legend('Excesso Inicial','Excesso Final','Hora atual') \n    ylabel('kW','fontweight','bold') \n    xlabel('Horas','fontweight','bold'); \n    xlim([0 48]) \n    ylim([-600 200]) \n    set(gca,'XTick',0:2:48); \n    xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 20 \n22 24}) \n  \n%-------------------------------------------------------------------------\n-     \n     \nsubplot(5,1,2) %Interm\u00e9dio, \u00e9 feito dentro do ciclo e atualizada para cada \nveiculo \n    grid on \n     \n    plot(excesso(:,1),excesso_original,'b','LineWidth',3); %Excesso original \n     \n    LV3 = line([0 48],[0 0]); %Linha horizontal y = 0 \n    LV3.Color = 'black'; \n     \n    title('Processos Iterativos','fontweight','bold','fontsize',14) \n    legend('Excesso Inicial','Hora atual','Itera\u00e7\u00f5es','Location','southeast') \n    ylabel('kW','fontweight','bold') \n    xlabel('Horas','fontweight','bold'); \n    xlim([0 48]) \n    ylim([-600 200]) \n    set(gca,'XTick',0:2:48); \n    xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 20 \n22 24}) \n     \n%-------------------------------------------------------------------------- \n     \nsubplot(5,1,3) %Custo da Energia \n    grid on \n     \n    LV5 = line([0 48],[0 0]); %Linha horizontal y = 0 \n    LV5.Color = 'black'; \n     \n    LV6 = line([h h],[-600 250]); %Linha vertical hora atual hipot\u00e9tica \n    LV6.Color = 'blue'; \n    LV6.LineStyle = '--'; \n     \n\n\n\n 79 \n\n    str=sprintf('Pre\u00e7os da Energia a %d e %d de fevereiro de \n2017',dia1,dia2); \n    title(str,'fontweight','bold','fontsize',14)    \n    legend('Custo da energia (MIBEL x Fator) (E/kWh)','Custo Energia (Bi-\nHor\u00e1rio + IVA) (E/kWh)','Hora atual','Location','southeast') \n    %legend('Custo Energia (Bi-Hor\u00e1rio + IVA) (E/kWh)','Hora \natual','Location','southeast') \n    ylabel('E/MWh','fontweight','bold') \n    xlabel('Horas','fontweight','bold'); \n    xlim([0 48]) \n    set(gca,'XTick',0:2:48); \n    ylim([0 .3]) \n    xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 20 \n22 24}) \n  \n%-------------------------------------------------------------------------- \n  \nsubplot(5,1,4) %Balan\u00e7o indo pelo excesso de energia \n    grid on \n     \n    LV3 = line([0 48],[0 0]); %Linha horizontal y = 0 \n    LV3.Color = 'black'; \n     \n    plot(excesso(:,1),excesso_original,'b','LineWidth',3); %Excesso original \n          \n    str=sprintf('Balan\u00e7o renov\u00e1vel em fun\u00e7\u00e3o do pre\u00e7o da energia a %d e %d de \nfevereiro de 2017',dia1,dia2); \n    legend('Excesso Inicial','Hora atual','Itera\u00e7\u00f5es') \n    title(str,'fontweight','bold','fontsize',14)    \n    ylabel('kW','fontweight','bold') \n    xlabel('Horas','fontweight','bold'); \n    xlim([0 48]) \n    set(gca,'XTick',0:2:48); \n    ylim([-600 200]) \n    xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 20 \n22 24}) \n     \n%-------------------------------------------------------------------------- \n  \nsubplot(5,1,5) %Balan\u00e7o indo pelo excesso de energia \n    grid on \n     \n    LV3 = line([0 48],[0 0]); %Linha horizontal y = 0 \n    LV3.Color = 'black'; \n              \n    sprintf('Diagrama utilizando um carregamento n\u00e3o inteligente'); \n    legend('Excesso Inicial','Hora atual','Itera\u00e7\u00f5es') \n  \n    title(str,'fontweight','bold','fontsize',14)    \n    ylabel('kW','fontweight','bold') \n    xlabel('Horas','fontweight','bold'); \n    xlim([0 48]) \n    set(gca,'XTick',0:2:48); \n    ylim([-600 200]) \n    xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 20 \n22 24}) \n     \n%-------------------------------------------------------------------------- \n \n\n \n\n \n\n \n\n  \n\n\n\n 80 \n\n15 Anexo H \u2013 PlotsComparativos.m \n\nfigure \n    subplot(2,1,1) \n        hold on \n        grid on \n         \n        plot(x,consumo9_10/r,'LineWidth',2) \n        plot(x,carregamentointeligente9_10,'LineWidth',2) \n         \n        str=sprintf('Diagrama de carga dos dias 9 e 10 de agosto de 2016\\n \nCarregamento Inteligente'); \n        title(str,'fontweight','bold','fontsize',14) \n        legend('Diagrama Inicial','Diagrama Final') \n        ylabel('kW','fontweight','bold') \n        xlabel('Horas','fontweight','bold'); \n        xlim([0 48]) \n        ylim([450 850]) \n        set(gca,'XTick',0:2:48); \n        xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 \n20 22 24}) \n         \n    subplot(2,1,2) \n        hold on \n        grid on \n         \n        plot(x,consumo9_10/r,'LineWidth',2) \n        plot(x,carregamentonaointeligente9_10,'LineWidth',2) \n         \n        str=sprintf('Diagrama de carga dos dias 9 e 10 de agosto de 2016\\n \nCarregamento N\u00e3o Inteligente'); \n        title(str,'fontweight','bold','fontsize',14) \n        legend('Diagrama Inicial','Diagrama Final') \n        ylabel('kW','fontweight','bold') \n        xlabel('Horas','fontweight','bold'); \n        xlim([0 48]) \n        ylim([450 850]) \n        set(gca,'XTick',0:2:48);  \n        xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 \n20 22 24}) \n  \n%-------------------------------------------------------------------------- \n         \nfigure \n    subplot(2,1,1) \n        hold on \n        grid on \n         \n        plot(x,consumo2_3/r,'LineWidth',2) \n        plot(x,carregamentointeligente2_3,'LineWidth',2) \n         \n        str=sprintf('Diagrama de carga dos dias 2 e 3 de fevereiro de 2017\\n \nCarregamento Inteligente'); \n        title(str,'fontweight','bold','fontsize',14) \n        legend('Diagrama Inicial','Diagrama Final') \n        ylabel('kW','fontweight','bold') \n        xlabel('Horas','fontweight','bold'); \n        xlim([0 48]) \n        ylim([450 950]) \n        set(gca,'XTick',0:2:48); \n        xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 \n20 22 24}) \n         \n    subplot(2,1,2) \n\n\n\n 81 \n\n        hold on \n        grid on \n         \n        plot(x,consumo2_3/r,'LineWidth',2) \n        plot(x,carregamentonaointeligente2_3,'LineWidth',2) \n         \n        str=sprintf('Diagrama de carga dos dias 2 e 3 de fevereiro de 2017\\n \nCarregamento N\u00e3o Inteligente'); \n        title(str,'fontweight','bold','fontsize',14) \n        legend('Diagrama Inicial','Diagrama Final') \n        ylabel('kW','fontweight','bold') \n        xlabel('Horas','fontweight','bold'); \n        xlim([0 48]) \n        ylim([450 950]) \n        set(gca,'XTick',0:2:48);  \n        xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 \n20 22 24}) \n \n\n  \n\n\n\n 82 \n\n16 Anexo H \u2013 Lista VE final \n\n \nColuna 1 - N\u00famero de entrada do Ve\u00edculo \nColuna 2 - Hora de chegada do ve\u00edculo (horas) \nColuna 3 - Capacidade da bateria (kWh) \nColuna 4 - SOC pretendido (%) \nColuna 5 - SOC atual (%) \nColuna 6 - Pot\u00eancia do carregador (kW) \nColuna 7 - Hora prevista de sa\u00edda (horas) \nColuna 8 - Tempo de carregamento (horas) \nColuna 9 - N\u00famero de per\u00edodos necess\u00e1rios (arredondado por excesso)  \nColuna 10 - Custo de carregamento indo pelo excesso de renov\u00e1vel (em \nEuros) \nColuna 11 - Custo de carregamento indo pelo custo de energia (em \nEuros) \nColuna 12 - Custo de carregamento indo por carregamento normal (Euros)"}]}}}