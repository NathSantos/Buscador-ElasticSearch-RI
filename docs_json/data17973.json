{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.21841"}, {"@name": "filename", "#text": "5637_DISSERTA%c3%87%c3%83O%20Roberto%20Navarro%20Pareja.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "ROBERTO NAVARRO PAREJA \n\n \n\n \n\n \n\n \nAjuste ao Hist\u00f3rico em Reservat\u00f3rios de Petr\u00f3leo \n\nUsando o M\u00e9todo do Filtro de Kalman \n\ncon Ensembles (EnKF)  \n\n \n\n \n \n\n \n\n \n\n \n\n \n\n \n\nRecife, 2014 \n\nUniversidade Federal de Pernambuco \n\nCentro de Tecnologia e Geoci\u00eancias \n\nP\u00f3s-Gradua\u00e7\u00e3o em Engenharia Civil \n\n\n\n \n\nROBERTO NAVARRO PAREJA \n\n \n\n \n\nAjuste ao Hist\u00f3rico em Reservat\u00f3rios de Petr\u00f3leo \n\nUsando o M\u00e9todo do Filtro de Kalman \n\ncon Ensembles (EnKF)  \n\n \n\n \n\nDisserta\u00e7\u00e3o de Mestrado submetida ao Corpo de Docente do Curso de P\u00f3s-Gradua\u00e7\u00e3o em \n\nEngenharia Civil da Universidade Federal de Pernambuco, como parte dos requisitos \n\nnecess\u00e1rios \u00e0 obten\u00e7\u00e3o do grau de Mestre em Ci\u00eancias em Engenharia Civil. \n\n \n\n \n\n \n\nRamiro Brito Willmersdorf, Ph. D. \nOrientador \n\n \n\n \n\n\u00c1rea de Concentra\u00e7\u00e3o: Simula\u00e7\u00e3o e Gerenciamento de Reservat\u00f3rios \n\n \n\n \n\n \n\n \n \n \n\nRecife, 2014. \n\n\n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nCataloga\u00e7\u00e3o na fonte \n\nBibliotec\u00e1ria Margareth Malta, CRB-4 / 1198 \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n P227a       Pareja, Roberto Navarro. \n\nAjuste ao  hist\u00f3rico em reservat\u00f3rios de petr\u00f3leo usando o M\u00e9todo do \n\nFiltro de Kalman con Ensembles (EnKF) / Roberto Navarro Pareja. - Reci-\n\nfe: O Autor, 2014. \n\n108 folhas, il., gr\u00e1fs., tabs. \n\n \n\n                          Orientador: Prof. Dr. Ramiro Brito Willmersdorf. \n\n      Disserta\u00e7\u00e3o (Mestrado) \u2013 Universidade Federal de Pernambuco. CTG. \n\nPrograma de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia Civil, 2014. \n\nInclui Refer\u00eancias e Anexo. \n\n \n\n1. Engenharia Civil.  2. Ajuste ao Hist\u00f3rico.  3. EnKF.   4. Assimila\u00e7\u00e3o \n\nde Dados. 5. MRST.  I. Willmersdorf, Ramiro Brito. (Orientador).  II. T\u00edtu-\n\nlo. \n\n \n\n \n\n                       UFPE \n\n \n\n624 CDD (22. ed.)          BCTG/2015-223 \n\n \n\n\n\n \n\n \n\n \n\n \n\nUNIVERSIDADE FEDERAL DE PERNAMBUCO  \n\nPROGRAMA DE P\u00d3S-GRADUA\u00c7\u00c3O EM ENGENHARIA CIVIL \n\nA comis\u00e3o examinadora da Defesa de Disserta\u00e7\u00e3o de Mestrado \n\n \n\n \n\n \n\nAJUSTE AO HIST\u00d3RICO EM RESERVAT\u00d3RIOS DE PETR\u00d3LEO USANDO \n\nO FILTRO DE KALMAN CON ENSEMBLES \n\n \n\ndefendida por \n\n \n\nRoberto Navarro Pareja \n\n \n\nConsidera o candidato APROVADO \n\n \n\nRefice, 26 de Agosto de 2014 \n\n \n\nBanca Examinadora: \n\n \n\n \n\n___________________________________ \n\nProf. Dr. Ramiro Brito Willmersdorf - UFPE \n\n(Orientador) \n\n \n\n \n\n \n\n____________________________________ \n\nProf. Dr. Raydonal Ospina Martinez - UFPE \n\n(examinador externo) \n\n \n\n \n\n \n\n_________________________________ \n\nProf. Dr. \u00c9zio da Rocha Araujo - UFPE \n\n(examinador interno) \n\n \n\n \n\n\n\n \n\nDedicado \n\n \n\n \n\nDedico este trabalho a minha fam\u00edlia, fonte de energia necess\u00e1ria para acordar, tra-\n\nbalhar, lutar e sonhar. \n\nAos meus pais Vicente e Marcelina, meu eterno agradecimento. Meu pai exemplo de \n\nsupera\u00e7\u00e3o e esfor\u00e7o constante na vida, minha m\u00e3e exemplo de amor e f\u00e9. \n\nA minha noiva Paola, agrade\u00e7o o amor, carinho e compreens\u00e3o que teve durante o \n\ndesenvolvimento de meu trabalho. \n\nAos meus irm\u00e3os, sogros e cunhados, meu agradecimento pelo apoio brindado em \n\ntodos os momentos. \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n\n\n \n\nAgradecimentos \n\n \n\nAo longo deste trabalho, tenho aprendido muito e gostaria de aproveitar nesta opor-\n\ntunidade para agradecer a todas as pessoas que ajudaram e me orientaram que, de \n\nalguma forma, contribu\u00edram para a sua realiza\u00e7\u00e3o. \n\nA Universidade Federal de Pernambuco (UFPE), ao programa de P\u00f3s-gradua\u00e7\u00e3o em \n\nEngenharia Civil, a CAPES pela concess\u00e3o da bolsa e Rede SIGER. \n\nAo professor Ramiro Brito Willmersdorf, pela sua valiosa orienta\u00e7\u00e3o para a realiza-\n\n\u00e7\u00e3o deste trabalho e pelo tempo investido durante seus ensinamentos. \n\nAos professores Ant\u00f4nio Barboza e Darlan Carvalho por as aulas motivadoras, por \n\nsuas recomenda\u00e7\u00f5es e amizade. \n\nAos professores Leonardo Guimar\u00e3es, Ivaldo Pontes, L\u00edcia Costa, Silvana Afonso e \n\nBernardo Horowitz, que contribu\u00edram na minha forma\u00e7\u00e3o profissional. \n\nA meus amigos e companheiros do LABCOM, Marcio, Eduardo, Felipe, Gustavo, \n\nLorena, Marcelo, T\u00falio, Luciolo, Tammhy, Nilson, T\u00e1ssio, pelo conv\u00edvio e amizade ao \n\nlongo destes dois anos compartilhando momentos dif\u00edceis do Mestrado. \n\nPara Manuel, Fernando e Liliane pelo conv\u00edvio, solidariedade, amizade e conheci-\n\nmentos brindados durante o desenvolvimento do trabalho. \n\nA meus amigos Ricardo, Fernando, Omar, Ernesto e Alberto, que com paci\u00eancia es-\n\ntavam ao meu lado me incentivando sempre a continuar.  \n\nAos colegas da P\u00f3s-gradua\u00e7\u00e3o, Rodrigo, Jefferson pela troca de ideais. \n\nE, principalmente, a Deus, pela for\u00e7a que me d\u00e1 para que eu sempre continue bus-\n\ncando meu aperfei\u00e7oamento. \n\n \n\n\n\n \n\nResumo \n\nA simula\u00e7\u00e3o de reservat\u00f3rios \u00e9 uma importante ferramenta usada pela ind\u00fastria do \n\npetr\u00f3leo para o gerenciamento de reservat\u00f3rios. A fim de obter previs\u00f5es da produ-\n\n\u00e7\u00e3o de \u00f3leo confi\u00e1veis, diferentes propriedades petrof\u00edsicas do reservat\u00f3rio, como \n\nporosidade e permeabilidade s\u00e3o usadas nos modelos de reservat\u00f3rios. Por\u00e9m, me-\n\ndi\u00e7\u00f5es diretas dessas propriedades s\u00e3o poss\u00edveis apenas em alguns poucos po\u00e7os. \n\nUma forma de melhorar o conhecimento sobre essas propriedades \u00e9 atrav\u00e9s do pro-\n\ncesso de ajuste ao hist\u00f3rico. O ajuste ao hist\u00f3rico consiste em melhorar estimativas \n\nde propriedades do reservat\u00f3rio usadas na constru\u00e7\u00e3o de um modelo de reservat\u00f3rio \n\nde forma que as previs\u00f5es do modelo se aproximem dos dados medidos em campo. \n\nNesta disserta\u00e7\u00e3o apresentamos um estudo para o ajuste ao hist\u00f3rico autom\u00e1tico \n\nbaseado em um modelo areal, isto \u00e9, que considera o reservat\u00f3rio plano e horizon-\n\ntal, descrito por apenas duas dimens\u00f5es geom\u00e9tricas, de um reservat\u00f3rio bif\u00e1sico \n\n(\u00f3leo/\u00e1gua), onde desejamos estimar a distribui\u00e7\u00e3o de permeabilidades do reserva-\n\nt\u00f3rio.  \n\nDevido \u00e0 sua simplicidade e efici\u00eancia, o m\u00e9todo do Filtro de Kalman com Ensem-\n\nbles (EnKF), \u00e9 usado para assimilar as medi\u00e7\u00f5es est\u00e1ticas e din\u00e2micas, atualizando \n\ncontinuamente as propriedades do reservat\u00f3rio. O EnKF nos \u00faltimos anos tem ga-\n\nnhado muita popularidade, \u00e9 um m\u00e9todo de assimila\u00e7\u00e3o de dados para modelos di-\n\nn\u00e2micos n\u00e3o lineares de alta dimens\u00e3o e portanto adequado para ser usado no ajus-\n\nte ao hist\u00f3rico de modelos de simula\u00e7\u00e3o de reservat\u00f3rios.  \n\nO EnKF foi implementado em Matlab e acoplado ao Matlab Reservoir Simulation To-\n\nolbox (MRST), que foi desenvolvido pelo SINTEF para simula\u00e7\u00e3o de reservat\u00f3rios, e \n\nfoi aplicado a dois casos sint\u00e9ticos simples. Os resultados mostraram que a rotina \n\nEnKF funcionou corretamente, mostrando-se que, para muitos dos par\u00e2metros com \n\nincerteza inicial, esta foi reduzida a um n\u00edvel aceit\u00e1vel, para a produ\u00e7\u00e3o de petr\u00f3leo \n\ne \u00e1gua. \n\n \nPalavras chaves: Ajuste ao Hist\u00f3rico. EnKF. Assimila\u00e7\u00e3o de Dados. MRST.\n\n\n\n \n\nAbstract \n\nReservoir simulation is an important tool used by the oil industry for reservoir \n\nmanagement. In order to obtain reliable predictions of oil production, different \n\npetrophysical properties such as porosity and permeability are used to build the \n\nreservoir models. However, direct measurements of these properties are only \n\npossible in a few wells. One way to improve the knowledge of these properties is \n\nthrough the history matching process. History matching improves the estimates of \n\nreservoir properties used in the construction of the reservoir model so that the model \n\npredictions are closer to the measured production of the field. In this paper we \n\npresent a study for an automatic history matching based upon and two-dimensional \n\nmodel of two-phase (oil/water) reservoir, where we wish to improve the estimate of \n\nthe distribution of the reservoir permeabilities. \n\nDue to its simplicity and efficiency, the method of the Ensemble Kalman Filter (EnKF) \n\nis used to assimilate the static and dynamic measurements, continuously updating \n\nthe properties of the reservoir. The EnKF, in recent years has gained much \n\npopularity, as it is a method for dynamic data assimilation for nonlinear models of \n\nhigh dimension and therefore suitable for use in history matching models of reservoir \n\nsimulations.  \n\nThe EnKF was implemented in Matlab and coupled to Matlab Reservoir Simulation \n\nToolbox (MRST), which was developed by SINTEF for reservoir simulation, and was \n\napplied to two simple synthetic cases. The results showed that the EnKF routine \n\nworks properly, showing that, for many of the parameters and initial uncertainty has \n\nbeen reduced to an acceptable level for the production of oil and water. \n\nKeywords: History Matching. EnKF. Data Assimilation. MRST. \n\n\n\n \n\nLista de Figuras \n\n \n\nFigura 2.1: Se\u00e7\u00e3o transversal de uma amostra de rocha de reservat\u00f3-\n\nrio..................22 \n\nFigura 2.2: Rocha-reservat\u00f3rio contendo tr\u00eas fluidos: \u00e1gua, \u00f3leo e g\u00e1s..................  \n\n24 \n\nFigura 4.1: Esquema de como assimila\u00e7\u00e3o de dados (DA) funciona e agrega valor \u00e0 \n\nobserva\u00e7\u00e3o e informa\u00e7\u00f5es do modelo.......................................................................24 \n\nFigura 4.2: O filtro de Kalman discreto.......................................................................27 \n\nFigura 4.3: Assimila\u00e7\u00e3o de dados com EnKF para o membro j  do ensemble.........32 \n\nFigura 4.4: Algoritmo B\u00e1sico do EnKF.........................................................................36 \n\nFigura 5.1: Simula\u00e7\u00e3o da Produ\u00e7\u00e3o em Reservat\u00f3rios.............................................38 \n\nFigura 5.2: Exemplos de M\u00f3dulos MRST..................................................................39 \n\nFigura 5.3: Amostragem gerada pelo m\u00e9todo de Monte Carlo.................................41 \n\nFigura 5.4: Amostragem gerada pelo m\u00e9todo de Quasi-Monte Carlo.......................41 \n\nFigura 5.5: Conjunto inicial de pontos geradores......................................................42 \n\nFigura 5.6: O m\u00e9todo de tessela\u00e7\u00e3o de Voronoi para os pontos da Figura 3.3........42 \n\nFigura 5.7: O m\u00e9todo de tessela\u00e7\u00e3o de Voronoi (CVT) ap\u00f3s atingir a condi\u00e7\u00e3o final \n\nde uniformidade.........................................................................................................42 \n\nFigura 5.8: Amostragem gerada pelo m\u00e9todo LHS num espa\u00e7o bidimensional (Giun-\n\nta et al, 2003).............................................................................................................43 \n\nFigura 5.9: Ilustra\u00e7\u00e3o da EnKF a partir do ponto de vista da concep\u00e7\u00e3o bayesia-\n\nna...............................................................................................................................44 \n\nFigura 5.10: Fluxo de trabalho de ajuste ao hist\u00f3rico baseado em EnKF para os da-\n\ndos de produ\u00e7\u00e3o.........................................................................................................45 \n\nFigura 5.11: Ajuste ao hist\u00f3rico tradicional e o baseado em EnKF...........................47 \n\nFigura 6.1: Campo de permeabilidade inicial............................................................49\n\n\n\nFigura 6.2: Campo Log-permeabilidade para 1825 dias e 3650 dias........................51 \n\nFigura 6.3: Campo Log-permeabilidade para 5475 dias e 7300 dias........................51 \n\nFigura 6.4: Campo Log-permeabilidade e Porosidade do ensemble m\u00e9dio.............51 \n\nFigura 6.5: Campo de Press\u00e3o e Satura\u00e7\u00e3o do ensemble m\u00e9dio.............................52 \n\nFigura 6.6: Produ\u00e7\u00e3o de \u00f3leo acumulada. A linha vermelha corresponde ao modelo \n\nverdadeiro, a linha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s reali-\n\nza\u00e7\u00f5es........................................................................................................................52 \n\nFigura 6.7: Produ\u00e7\u00e3o de \u00f3leo acumulada. A linha vermelha corresponde ao modelo \n\nverdadeiro, a linha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s reali-\n\nza\u00e7\u00f5es........................................................................................................................53 \n\nFigura 6.8: Taxa de \u00d3leo. A linha vermelha corresponde ao modelo verdadeiro, a \n\nlinha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es..........53 \n\nFigura 6.9: Taxa de \u00d3leo. A linha vermelha corresponde ao modelo verdadeiro, a \n\nlinha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es ........54 \n\nFigura 6.10: Corte de \u00c1gua. A linha vermelha corresponde ao modelo verdadeiro, a \n\nlinha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es ........54 \n\nFigura 6.11: Corte de \u00c1gua. A linha vermelha corresponde ao modelo verdadeiro, a \n\nlinha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es.........55 \n\nFigura 6.12: Campo de permeabilidade inicial..........................................................57 \n\nFigura 6.13: Campo Log-permeabilidade para 1825 dias e 3650 dias.....................58 \n\nFigura 6.14: Campo Log-permeabilidade para 5475 dias e 7300 dias.....................58 \n\nFigura 6.15: Campo de Log-permeabilidade e porosidade do ensemble m\u00e9dio.......59 \n\nFigura 6.16: Campo de Press\u00e3o e Satura\u00e7\u00e3o do ensemble m\u00e9dio...........................59 \n\nFigura 6.17: Produ\u00e7\u00e3o de \u00f3leo acumulada. A linha vermelha corresponde ao modelo \n\nverdadeiro, a linha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s reali-\n\nza\u00e7\u00f5es........................................................................................................................60 \n\nFigura 6.18: Produ\u00e7\u00e3o de \u00f3leo acumulada. A linha vermelha corresponde ao modelo \n\nverdadeiro, a linha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s reali-\n\nza\u00e7\u00f5es........................................................................................................................60 \n\nFigura 6.19: Produ\u00e7\u00e3o de \u00f3leo acumulada. A linha vermelha corresponde ao modelo \n\nverdadeiro, a linha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s reali-\n\nza\u00e7\u00f5es........................................................................................................................61\n\n\n\nFigura 6.20: Produ\u00e7\u00e3o de \u00f3leo acumulada. A linha vermelha corresponde ao modelo \n\nverdadeiro, a linha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s reali-\n\nza\u00e7\u00f5es........................................................................................................................61 \n\nFigura 6.21: Taxa de \u00d3leo. A linha vermelha corresponde ao modelo verdadeiro, a \n\nlinha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es..........62 \n\nFigura 6.22: Taxa de \u00d3leo. A linha vermelha corresponde ao modelo verdadeiro, a \n\nlinha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es.........62 \n\nFigura 6.23: Taxa de \u00d3leo. A linha vermelha corresponde ao modelo verdadeiro, a \n\nlinha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es.........63 \n\nFigura 6.24: Taxa de \u00d3leo. A linha vermelha corresponde ao modelo verdadeiro, a \n\nlinha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es.........63 \n\nFigura 6.25: Corte de \u00c1gua. A linha vermelha corresponde ao modelo verdadeiro, a \n\nlinha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es.........64 \n\nFigura 6.26: Corte de \u00c1gua. A linha vermelha corresponde ao modelo verdadeiro, a \n\nlinha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es.........64 \n\nFigura 6.27: Corte de \u00c1gua. A linha vermelha corresponde ao modelo verdadeiro, a \n\nlinha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es.........65 \n\nFigura 6.28: Corte de \u00c1gua. A linha vermelha corresponde ao modelo verdadeiro, a \n\nlinha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es.........65 \n\n \n\nANEXO A \n\nFigura A.1: Mapeamento de resultados de experimentos a n\u00fameros em eixo real...85 \n\nFigura A.2: FDA e pdf para a distribui\u00e7\u00e3o de Gauss.................................................92 \n\n \n\n \n\n \n\n \n\n \n\n \n\n\n\n \n\nLista de Tabelas \n\n \n\nTabela 6.1: Resumo das caracter\u00edsticas do modelo do Caso 1................................49 \n\nTabela 6.2: Resultados obtidos ap\u00f3s das simula\u00e7\u00f5es..............................................55 \n\nTabela 6.3: Resumo das caracter\u00edsticas do modelo do Caso 2................................56 \n\nTabela 6.4: Resultados obtidos ap\u00f3s das simula\u00e7\u00f5es...............................................66 \n\nANEXO A \n\nTabela A.1: Opera\u00e7\u00f5es entre eventos......................................................................78 \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n\n\n \n\nSUM\u00c1RIO \n\n \n\n1. Introdu\u00e7\u00e3o....................................................................................................16 \n\n1.1 Introdu\u00e7\u00e3o.................................................................................................... .16 \n\n1.2 Vis\u00e3o Geral da Disserta\u00e7\u00e3o..........................................................................17 \n\n1.3 Objetivo........................................................................................................17 \n\n1.4 Trabalhos Pr\u00e9vios........................................................................................18 \n\n \n\n2. Reservat\u00f3rios Petr\u00f3leo................................................................................22 \n\n2.1 Introdu\u00e7\u00e3o....................................................................................................22 \n\n2.2 Reservat\u00f3rios de Petr\u00f3leo............................................................................23 \n\n2.3 Principais Propriedades do Reservat\u00f3rio.....................................................23 \n\n2.3.1 Propriedades da Rocha................................................................................24 \n\n2.3.1.1 Porosidade (? ).............................................................................................24 \n\n2.3.1.2 Compressibilidade efetiva ? ?fc ....................................................................25 \n\n2.3.1.3 Satura\u00e7\u00e3o ( )S ..............................................................................................25 \n\n2.3.1.4 Permeabilidade ? ?k .....................................................................................26 \n\n2.3.2 Propriedades dos Fluidos.............................................................................27 \n\n2.3.2.1 Viscosidade ? ?? ...........................................................................................27 \n\n2.3.2.2 Compressibilidade ? ?c .................................................................................28 \n\n2.3.2.3 Fator Volume Forma\u00e7\u00e3o ? ?B ........................................................................28 \n\n2.4 Simula\u00e7\u00e3o de Reservat\u00f3rios........................................................................29 \n\n2.4.1 Formula\u00e7\u00e3o Matem\u00e1tica...............................................................................29 \n\n2.4.2 Equa\u00e7\u00e3o de Fluxo para o Escoamento Multif\u00e1sico......................................29 \n\n \n\n3. Ajuste de Hist\u00f3rico ......................................................................................31 \n\n3.1 Introdu\u00e7\u00e3o....................................................................................................31 \n\n3.2 Tipos de Ajuste ao Hist\u00f3ricos.......................................................................32 \n\n3.2.1 Ajuste ao Hist\u00f3rico Manual...........................................................................32 \n\n3.2.2 Ajuste ao Hist\u00f3rico Automatizado................................................................32 \n\n3.2.2.1 Recozimento Simulado (Annealing).............................................................33 \n\n3.2.2.2 Algoritmos Gen\u00e9ticos...................................................................................34 \n\n3.2.2.3 Busca Scatter e Tabu....................................................................................34 \n\n3.2.2.4 Algoritmo de Vizinhan\u00e7a...............................................................................35 \n\n3.2.2.5 Filtro de Kalman............................................................................................35 \n\n3.3 Diferen\u00e7as entre o Ajuste ao Hist\u00f3rico Tradicional e EnKF.........................36 \n\n3.4 Estimativa de Par\u00e2metros............................................................................37 \n\n3.4.1 Construir um Modelo Matem\u00e1tico................................................................37\n\n\n\n \n\n3.4.2 Defini\u00e7\u00e3o de uma Fun\u00e7\u00e3o Objetivo..............................................................38 \n\n3.4.3 Limita\u00e7\u00f5es do Ajuste ao Hist\u00f3rico................................................................39 \n\n \n\n4. Assimila\u00e7\u00e3o de Dados com EnKF...............................................................41 \n\n4.1 Introdu\u00e7\u00e3o....................................................................................................41 \n\n4.2 Revis\u00e3o do Filtro de Kalman........................................................................42 \n\n4.3 Filtro de Kalman...........................................................................................43 \n\n4.4 Filtro de Kalman Baseado em Ensemble.....................................................43 \n\n4.4.1 Representa\u00e7\u00e3o das Estat\u00edsticas de Erro......................................................44 \n\n4.5 An\u00e1lise do Esquema....................................................................................45 \n\n4.6 Implementa\u00e7\u00e3o Pr\u00e1tica.................................................................................48 \n\n4.6.1 Representa\u00e7\u00e3o do Ensemble da Covari\u00e2ncia..............................................48 \n\n4.6.2 Perturba\u00e7\u00f5es das Medi\u00e7\u00f5es.........................................................................49 \n\n4.6.3 Equa\u00e7\u00e3o de An\u00e1lise.....................................................................................49 \n\n \n\n5. Software e Metodolog\u00eda...............................................................................54 \n\n5.1 Introdu\u00e7\u00e3o....................................................................................................54 \n\n5.2 Matlab Reservoir Simulation Toolbox (MRST).............................................56 \n\n5.3 M\u00e9todos de Amostragem.............................................................................57 \n\n5.3.1 M\u00e9todo de Quasi-Monte Carlo (QMC).........................................................58 \n\n5.3.2 M\u00e9todo da Tessela\u00e7\u00e3o de Voronoi (CVT)....................................................59 \n\n5.3.3 Hipercubo Latino (LHS)................................................................................59 \n\n5.4 Ajuste de Hist\u00f3rico Baseado em EnKF........................................................60 \n\n5.5 Fluxo de Trabalho de Ajuste ao Hist\u00f3rico Baseado em EnKF.....................61 \n\n5.6 Metodologia EnKF........................................................................................62 \n\n5.7 Ajuste ao Hist\u00f3rico Tradicional Versus Baseado em EnKF.........................63 \n\n5.8 Recursos Computacionais...........................................................................64 \n\n \n\n6. Estudos de Caso.........................................................................................66 \n\n6.1 Introdu\u00e7\u00e3o....................................................................................................66 \n\n6.2 Caso 1..........................................................................................................67 \n\n6.2.1 Resultados do Caso 1..................................................................................68 \n\n6.3 Caso 2..........................................................................................................73 \n\n6.3.1 Resultados do Caso 2..................................................................................75 \n\n \n\n7. Conclus\u00f5es e Trabalhos Futuros.................................................................86 \n\n7.1 Conclus\u00e3o....................................................................................................86 \n\n7.2 Trabalhos Futuros........................................................................................87 \n\n \nRefer\u00eancias ...............................................................................................................88 \n\n\n\nAnexo A \n\nA.            Fundamentos da Estat\u00edstica e Probabilidades............................................95 \n\nA.1          Introdu\u00e7\u00e3o....................................................................................................95 \n\nA.2          Espa\u00e7o Amostral..........................................................................................96 \n\nA.2.1      Classifica\u00e7\u00e3o de um Espa\u00e7o Amostral.........................................................96 \n\nA.3      Evento.......................................................................................................... .96 \n\nA.3.1     Combina\u00e7\u00e3o de Elementos...........................................................................96 \n\nA.4         \u00c1lgebra de Conjuntos...................................................................................96 \n\nA.5         Conceptos de Probabilidade.........................................................................96 \n\nA.5.1      Defini\u00e7\u00e3o cl\u00e1ssica de probabilidade..............................................................96 \n\nA.5.2      Defini\u00e7\u00e3o de Probabilidade como Frequ\u00eancia Relativa................................97 \n\nA.5.2.1   Propriedades da Frequ\u00eancia Relativa...........................................................97 \n\nA.5.3      Defini\u00e7\u00e3o Axiom\u00e1tica de Probabilidade........................................................98 \n\nA.6         Eventos Independentes................................................................................99 \n\nA.7         Probabilidade Condicional............................................................................99 \n\nA.8         Probabilidade Condicional para Eventos Independentes.............................99 \n\nA.9         Probabilidade Total e Teorema de Bayes...................................................100 \n\nA.9.1      Probabilidade Total.....................................................................................100 \n\nA.9.2      Teorema de Bayes.......................................................................................101 \n\nA.10       Espa\u00e7o de Probabilidade............................................................................102 \n\nA.11       Vari\u00e1veis Aleat\u00f3rias....................................................................................102 \n\nA.11.1    Tipos de Vari\u00e1veis Aleat\u00f3rias.....................................................................102 \n\nA.11.1.1 Vari\u00e1veis Aleat\u00f3rias Discretas....................................................................102 \n\nA.11.1.2 Vari\u00e1veis Aleat\u00f3rias Continuas...................................................................103 \n\nA.12       Distribui\u00e7\u00f5es Bivariadas..............................................................................104 \n\nA.12.1    Distribui\u00e7\u00f5es Conjuntas Discretas..............................................................105 \n\nA.12.2    Distribui\u00e7\u00f5es Conjuntas Continuas.............................................................105 \n\nA.13       Distribui\u00e7\u00f5es Marginais...............................................................................105 \n\nA.13.1    Caso Discreto.............................................................................................106 \n\nA.13.2    Caso Continuo............................................................................................106 \n\nA.14       Esperan\u00e7a de uma Vari\u00e1vel Aleat\u00f3ria.........................................................106 \n\nA.15       Vari\u00e2ncia de uma Vari\u00e1vel Aleat\u00f3ria...........................................................107 \n\nA.16       Covari\u00e2ncia.................................................................................................107 \n\nA.17       Distribui\u00e7\u00f5es de Probabilidade...................................................................108 \n\nA.18       Trabalhando com Amostras de uma Distribui\u00e7\u00e3o.......................................109 \n\n\n\n16 \n \n\n \n\nCAP\u00cdTULO 1 \n\n1.  Introdu\u00e7\u00e3o \n\n1.1 Introdu\u00e7\u00e3o \n\nOs modelos para prever a produ\u00e7\u00e3o de um reservat\u00f3rio de petr\u00f3leo s\u00e3o baseados \n\nem dados s\u00edsmicos, testes de po\u00e7os e outras informa\u00e7\u00f5es onde h\u00e1 grandes incerte-\n\nzas associadas a esses dados. Em geral, o poder preditivo de tais modelos \u00e9 limita-\n\ndo e tende a deteriorar-se ao longo do tempo. Para evitar isto os modelos t\u00eam que \n\nser atualizados a intervalos regulares. A atualiza\u00e7\u00e3o usa novos dados do sistema de \n\nprodu\u00e7\u00e3o para atualizar o modelo. Este procedimento \u00e9 conhecido como Ajuste ao \n\nHist\u00f3rico e \u00e9 um campo bem estabelecido em engenharia de reservat\u00f3rio. Este pro-\n\ncesso pode ser feito manualmente, mas demora muito tempo e demanda muita ex-\n\nperi\u00eancia dos engenheiros de reservat\u00f3rios, al\u00e9m de n\u00e3o haver garantia que os re-\n\nservat\u00f3rios ajustados manualmente forne\u00e7am previs\u00f5es satisfat\u00f3rias da produ\u00e7\u00e3o. \n\nUma alternativa \u00e9 realizar o ajuste de forma assistida por computador. O ajuste ao \n\nhist\u00f3rico \u00e9 uma tarefa dif\u00edcil, com modelos que cont\u00eam muitos par\u00e2metros, sujeitos a \n\nelevada incerteza e com poucas medidas dispon\u00edveis. Normalmente, os modelos de \n\nreservat\u00f3rios atuais cont\u00eam centenas de milhares de c\u00e9lulas\n1\n, descritos por uma s\u00e9-\n\nrie de par\u00e2metros din\u00e2micos e est\u00e1ticos. Portanto, existe uma demanda por m\u00e9todos \n\nmais automatizados que sejam computacionalmente eficientes. Um m\u00e9todo popular \n\npara ajuste ao hist\u00f3rico \u00e9 o Filtro de Kalman com Ensembles\n2\n (EnKF). Este m\u00e9todo \n\nfoi desenvolvido por G. Evensen em 1994 para uso em modelos oce\u00e2nicos, enquan-\n\nto que a primeira aplica\u00e7\u00e3o de ajuste ao hist\u00f3rico foi dada por G. N\u00e6vdal et al. em \n\n2002. Este m\u00e9todo tem mostrado resultados promissores em v\u00e1rios casos de ajuste \n\nao hist\u00f3rico e \u00e9 computacionalmente eficiente. Esta \u00faltima propriedade possibilita um \n\nprocesso de atualiza\u00e7\u00e3o cont\u00ednua para o modelo, o que significa que os dados de \n\nprodu\u00e7\u00e3o, assim que se tornam dispon\u00edveis, podem ser usados para atualizar o mo-\n\n                                                           \n1\n C\u00e9lulas: C\u00e9lulas s\u00e3o subdom\u00ednios geom\u00e9tricos simples, hexa\u00e9dricos ou quadrilaterais, resultantes \n\ndo procedimento de discretiza\u00e7\u00e3o pelo m\u00e9todo das volumes finitos usado para a solu\u00e7\u00e3o das equa-\n\u00e7\u00f5es diferencias parciais que descrevem o escoamento multif\u00e1sico nos reservat\u00f3rios. \n2\n Ensemble: Conjunto de realiza\u00e7\u00f5es, onde cada realiza\u00e7\u00e3o representa um estado de um reservat\u00f3rio \n\nde petr\u00f3leo, com suas as propriedades petrofisicas est\u00e1ticas (permeabilidade, porosidade) e din\u00e2mi-\ncas (satura\u00e7\u00e3o, press\u00e3o) em cada c\u00e9lula. Na p\u00e1gina 28 \u00e9 dada uma defini\u00e7\u00e3o mais formal de ensem-\nble. \n\n\n\n17 \n \n\ndelo e tentar melhorar a sua capacidade preditiva. Todas essas qualidades fazem o \n\nEnKF adequado para a integra\u00e7\u00e3o com o gerenciamento do reservat\u00f3rio. \n\n \n \n \n\n1.2 Vis\u00e3o geral da disserta\u00e7\u00e3o \n\nOs demais cap\u00edtulos desse trabalho est\u00e3o organizados da seguinte maneira.  \n\nNo cap\u00edtulo 2 s\u00e3o apresentados os conceitos fundamentais da simula\u00e7\u00e3o de reserva-\n\nt\u00f3rios, mostrando a import\u00e2ncia que tem no estudo de ajuste ao hist\u00f3rico. No cap\u00edtu-\n\nlo 3, \u00e9 apresentado o ajuste ao hist\u00f3rico, tipos de ajustes e m\u00e9todos determin\u00edsticos \n\ne estoc\u00e1sticos que s\u00e3o aplicados no ajuste ao hist\u00f3rico. No cap\u00edtulo 4, s\u00e3o descritos \n\nconceitos fundamentais da Estat\u00edstica. Isso funciona como uma base para a com-\n\npreens\u00e3o da teoria do Filtro de Kalman apresentado no cap\u00edtulo 5. No cap\u00edtulo 5 \u00e9 \n\napresentado o algoritmo EnKF com base no Filtro de Kalman linear (KF). No cap\u00edtulo \n\n6, d\u00e1-se a conhecer a metodologia aplicada neste trabalho e al\u00e9m do software usado \n\ndurante a simula\u00e7\u00e3o. No cap\u00edtulo 7, s\u00e3o apresentados os casos sint\u00e9ticos que foram \n\nestudados neste trabalho, um campo com 3 po\u00e7os (1 injetor e 2 produtores) e outro \n\ncampo com 5 po\u00e7os (1 injetor e 4 produtores). Al\u00e9m disso, mostra-se os resultados \n\nobtidos com o m\u00e9todo EnKF. Finalmente, as conclus\u00f5es da disserta\u00e7\u00e3o e trabalhos \n\nfuturos s\u00e3o resumidas no cap\u00edtulo 8.  \n\n \n\n1.3 Objetivo \n\nO objetivo deste trabalho \u00e9 estudar uma t\u00e9cnica de assimila\u00e7\u00e3o de dados, o Filtro de \n\nKalman com Ensembles, para realizar ajuste ao hist\u00f3rico automatizado de reservat\u00f3-\n\nrios de petr\u00f3leo convencionais. Al\u00e9m disso, EnKF tamb\u00e9m fornece informa\u00e7\u00f5es vali-\n\nosas sobre o estado do reservat\u00f3rio ap\u00f3s o processo de assimila\u00e7\u00e3o de dados. O \n\nfoco principal foi estudar a estima\u00e7\u00e3o das propriedades petrof\u00edsicas do reservat\u00f3rio \n\n(permeabilidade e porosidade) atrav\u00e9s do tempo de produ\u00e7\u00e3o e observar as vari\u00e1-\n\nveis de produ\u00e7\u00e3o de \u00f3leo e corte de \u00e1gua (WCT) ap\u00f3s realizar os ajustes, para reali-\n\nzar uma previs\u00e3o adequada. O EnKF foi implementado com o Matlab, e as simula-\n\n\u00e7\u00f5es de reservat\u00f3rio foram realizadas com o Matlab Reservoir Simulation Toolbox \n\n(MRST), que \u00e9 uma caixa de ferramentas open-source de rotinas de Matlab para a \n\nrealiza\u00e7\u00e3o de simula\u00e7\u00e3o e visualiza\u00e7\u00e3o do reservat\u00f3rio. Este simulador acad\u00eamico \u00e9 \n\n\n\n18 \n \n\ndesenvolvido no SINTEF\n3\n, um centro de pesquisas da Noruega, e seu c\u00f3digo fonte \n\npode ser acessado livremente do site http://www.sintef.no/Projectweb/MRST/. Os \n\nexemplos simulados mostraram bons resultados em termos de assimila\u00e7\u00e3o de dados \n\ne atualiza\u00e7\u00e3o de par\u00e2metros do modelo ap\u00f3s a aplica\u00e7\u00e3o de EnKF para o ajuste ao \n\nhist\u00f3rico. \n\n1.4 Trabalhos pr\u00e9vios \n\nV\u00e1rios artigos sobre a aplica\u00e7\u00e3o com \u00eaxito do Filtro de Kalman com Ensembles na \n\nind\u00fastria do petr\u00f3leo t\u00eam sido publicados. A pesquisa sobre Filtro de Kalman com \n\nEnsembles (EnKF) come\u00e7ou com Evensen (1994) e mais tarde por Houtekamer e \n\nMitchell (1998), onde este m\u00e9todo \u00e9 classificado como de observa\u00e7\u00f5es perturbadas \n\nEnKF e s\u00e3o essencialmente ensembles de sistemas de assimila\u00e7\u00e3o de dados. Outro \n\ntipo de EnKF \u00e9 uma classe de filtros de raiz quadrada (Anderson, 2001, Whitaker e \n\nHamill, 2002, Bishop, et al. 2001, e Tippett, et al., 2003). Whitaker e Hamill, (2002) \n\nmostraram que os filtros de raiz quadrada s\u00e3o mais precisos que os filtros de obser-\n\nva\u00e7\u00e3o perturbadas por causa de erros de amostragem introduzidos pelas observa-\n\n\u00e7\u00f5es perturbadas com erros aleat\u00f3rios. Os filtros de raiz quadrada discutidos por \n\nTippett, et al. (2003) assimilam observa\u00e7\u00f5es sequencialmente (Houtekamer e Mit-\n\nchell, 1998) o que aumenta a efici\u00eancia ao evitar a invers\u00e3o de matrizes grandes. \n\nN\u00e6vdal, et al. (2002) utilizaram o  EnKF para a estimativa da permeabilidade num \n\nreservat\u00f3rio simples. Em seu trabalho o EnKF foi usado para atualizar par\u00e2metros \n\nest\u00e1ticos em modelos de reservat\u00f3rios ajustando o campo permeabilidade. N\u00e6vdal, \n\net al. (2005) utilizaram o EnKF para estimar a permeabilidade de todo o reservat\u00f3rio \n\nutilizando um modelo de reservat\u00f3rio 2D\n4\n simplificado de um campo do Mar do Nor-\n\nte\n5\n. Naquele trabalho, o modelo de reservat\u00f3rio trif\u00e1sico bidimensional\n\n6\n foi atualizado \n\ncontinuamente, ajustando o campo permeabilidade est\u00e1tico e campos din\u00e2micos de \n\nsatura\u00e7\u00e3o e press\u00e3o em cada passo de assimila\u00e7\u00e3o. Gu e Oliver (2005) analisaram o \n\nuso do EnKF para o estado e estimativa de par\u00e2metros no caso de teste do reserva-\n\n                                                           \n3\n SINTEF: \u00c9 a maior organiza\u00e7\u00e3o de pesquisa independente na Escandin\u00e1via que atua na gera\u00e7\u00e3o de \n\nconhecimento, pesquisa e inova\u00e7\u00e3o, e desenvolver solu\u00e7\u00f5es tecnol\u00f3gicas que s\u00e3o trazidas para o \nuso pr\u00e1tico. Realiza investiga\u00e7\u00e3o multidisciplinar em tecnologia, medicina e ci\u00eancias sociais. \n4\n Modelo de reservat\u00f3rio 2D: \u00c9 um modelo simplificado de um reservat\u00f3rio, onde se consideram \n\napenas duas dimens\u00f5es geom\u00e9tricas e propriedades constantes ao longo de sua profundidade. \n5\n Campo do Mar do Norte: O campo de Buzzard, no Mar do Norte, \u00e9 o maior e mais importante dos \n\ncampos petroleiros do Mar do Norte. \n6\n Modelo de reservat\u00f3rio trif\u00e1sico bidimensional: \u00c9 um modelo que considera o escoamento de \n\ntr\u00eas fases, \u00e1gua, \u00f3leo e g\u00e1s. \n\n\n\n19 \n \n\nt\u00f3rio PUNQ-S3\n7\n, um modelo de reservat\u00f3rio padr\u00e3o usado como benchmark para \n\nt\u00e9cnicas de ajuste ao hist\u00f3rico pela industria do petr\u00f3leo. O EnKF foi usado para \n\natualizar os campos de porosidade e permeabilidade, assim como os campos de \n\nsatura\u00e7\u00e3o e press\u00e3o, e em seguida, foi aplicado o ajuste aos dados de produ\u00e7\u00e3o das \n\ntr\u00eas fases. Brouwer, et al. (2004) investigaram o EnKF em uma malha fechado de \n\najuste com controle \u00f3timo em um modelo de reservat\u00f3rio bidimensional simples. \n\nN\u00e6vdal, et al. (2006) usou a combina\u00e7\u00e3o de EnKF para a atualiza\u00e7\u00e3o do modelo \n\ncont\u00ednua com otimiza\u00e7\u00e3o baseada em adjuntos de inje\u00e7\u00e3o de \u00e1gua para otimizar a \n\nestrat\u00e9gia de inje\u00e7\u00e3o de \u00e1gua. Gao, Zafari e Reynolds (2005), comparam o EnKF \n\ncom outro m\u00e9todo chamado m\u00e1xima verossimilhan\u00e7a randomizado (RML). Uma dife-\n\nren\u00e7a importante entre o EnKF e o RML \u00e9 que o RML \u00e9 baseado em adjuntos, o que \n\nrequer que o simulador de reservat\u00f3rios forne\u00e7a derivadas, enquanto o EnKF n\u00e3o \n\nexige muito esfor\u00e7o no acoplamento com o modelo de reservat\u00f3rio. Zafari e Rey-\n\nnolds (2005) testaram o m\u00e9todo em alguns problemas n\u00e3o lineares para validar o \n\nEnKF. Foi mostrado que o EnKF tem dificuldades em conseguir bons ajustes quando \n\nas distribui\u00e7\u00f5es da produ\u00e7\u00e3o s\u00e3o multi-modais e que a hip\u00f3tese Gaussiana das vari-\n\n\u00e1veis de produ\u00e7\u00e3o embutida no EnKF \u00e9 muito cr\u00edtica, no sentido de que o afasta-\n\nmento da normalidade prejudica fortemente o ajuste. Wen e Chen (2005) apresenta-\n\nram uma vers\u00e3o modificada do EnKF onde eles adicionaram um passo de confirma-\n\n\u00e7\u00e3o, \"confirming\", para executar a simula\u00e7\u00e3o do reservat\u00f3rio usando os mais recen-\n\ntes par\u00e2metros est\u00e1ticos atualizados do modelo, para que os par\u00e2metros est\u00e1ticos e \n\ndin\u00e2micos atualizados sejam sempre consistentes. No entanto, Zafari e Reynolds \n\n(2005) utilizaram um processo linear, para mostrar que o algoritmo com este passo \n\nde confirma\u00e7\u00e3o \u00e9 inconsistente. Liu e Oliver (2005a e 2005b) usaram o EnKF tanto \n\npara o ajuste ao hist\u00f3rico quanto para a estimativa das facies\n8\n de um modelo de si-\n\nmula\u00e7\u00e3o de reservat\u00f3rios. Eles descobriram que o m\u00e9todo EnKF superou o m\u00e9todo \n\nde minimiza\u00e7\u00e3o da norma da diferen\u00e7as entre as curvas de produ\u00e7\u00e3o observadas e \n\nprevistas, baseado em gradientes, em termos de efici\u00eancia de computa\u00e7\u00e3o e aplica-\n\nbilidade. Lorentzen, et al. (2005) estudaram a robustez do EnKF executando dez \n\ncasos do ensemble de diferentes condi\u00e7\u00f5es iniciais onde encontraram que o EnKF \u00e9 \n\nbem adequado para a previs\u00e3o de incerteza. Skjervheim, et al. (2005) sugiram um \n\n                                                           \n7\n PUNQ-S3: http://www3.imperial.ac.uk/earthscienceandengineering/research/perm/punq-s3model \n\n8\n F\u00e1cies: Denomina-se f\u00e1cies o conjunto de rochas com determinadas caracter\u00edsticas distintas dentro \n\nde um reservat\u00f3rio. \n\nhttp://pt.wikipedia.org/wiki/Rocha\n\n\n20 \n \n\nm\u00e9todo baseado no EnKF para incorporar dados s\u00edsmicos 4D\n9\n no modelo de atuali-\n\nza\u00e7\u00e3o continua. Eles mostraram que o EnKF poderia lidar com grande quantidade \n\nde dados s\u00edsmicos e teve um impacto positivo no ajuste do campo permeabilidade a \n\npartir de dados de medi\u00e7\u00e3o muito ruidosos. Dong, et al. (2006) tamb\u00e9m identificaram \n\numa conclus\u00e3o semelhante \u00e0 Skjervheim, et al. (2005), utilizando o EnKF para o \n\najuste ao hist\u00f3rico na produ\u00e7\u00e3o e dados de s\u00edsmica 4D. Reinlie (2006) usou o EnKF \n\ntradicional e condicionando as informa\u00e7\u00f5es de permeabilidade local ao redor do po-\n\n\u00e7o. Haugen, et al. (2006) usaram o EnKF para ajuste ao hist\u00f3rico em um caso de \n\ncampo do Mar do Norte, usando dados de produ\u00e7\u00e3o reais. Eles mostraram como \n\nEnKF pode melhorar os par\u00e2metros do modelo para o ajuste ao hist\u00f3rico e tamb\u00e9m \n\ndiscutiram a atualiza\u00e7\u00e3o dos estados do reservat\u00f3rio. Eles mostraram resultados \n\npromissores, mas conclu\u00edram que mais trabalhos devem ser feitos para ser capaz de \n\nestimar outros par\u00e2metros de reservat\u00f3rio utilizando o EnKF. Park e Choe (2006) \n\nestudaram o baixo valor da estimativa da covari\u00e2ncia de erro depois de alguns per\u00ed-\n\nodos de ajuste ao hist\u00f3rico e do n\u00famero versus qualidade dos dados de medi\u00e7\u00e3o. \n\nEles encontraram que as medidas de satura\u00e7\u00e3o de \u00e1gua perto da satura\u00e7\u00e3o de \u00e1gua \n\nirredut\u00edvel ou a satura\u00e7\u00e3o de \u00f3leo residual n\u00e3o s\u00e3o sens\u00edveis aos par\u00e2metros est\u00e1ti-\n\ncos, como a permeabilidade e porosidade, do reservat\u00f3rio e podem ser ignoradas. \n\nEvensen, et al. (2007) tamb\u00e9m mostraram como o EnKF pode ser utilizado para o \n\najuste ao hist\u00f3rico de um modelo para um reservat\u00f3rio do Mar do Norte. Eles inves-\n\ntigaram mais par\u00e2metros, como a WOC e GOC\n10\n\n, multiplicadores de transmissivida-\n\nde verticais e multiplicadores de transmissividade de falhas. O interesse e frequ\u00eancia \n\nde uso de EnKF como uma t\u00e9cnica de ajuste ao hist\u00f3rico aumentou significativamen-\n\nte e muitas aplica\u00e7\u00f5es recentes de EnKF para o ajuste ao hist\u00f3rico foram dadas. \n\nSaad e Ghanem (2009) desenvolveram uma abordagem para a assimila\u00e7\u00e3o de da-\n\ndos sequencial para representar vari\u00e1veis aleat\u00f3rias com a expans\u00e3o em Caos Poli-\n\nnomial (Wiener, 1938) e adotando o esquema de an\u00e1lise da EnKF. Zeng et al. \n\n(2010) propuseram coloca\u00e7\u00e3o probabil\u00edstica baseada em filtro de Kalman (PCKF). \n\nEmerick e Reynolds (2011) usam o EnKF com Localiza\u00e7\u00e3o de Covari\u00e2ncia para o \n\najuste ao hist\u00f3rico, e posteriormente (Emerick et al., 2012) combinaram o EnKF com \n\n                                                           \n9\n S\u00edmica 4D: Usa-se este termo quando testes s\u00edsmicos s\u00e3o realizados periodicamente ao longo da \n\nvida do reservat\u00f3rio e seus resultados usados para inferir a distribui\u00e7\u00e3o dos fluidos dentro dele. \n10\n\n WOC e GOC: Contato \u00c1gua \u2013 \u00d3leo e Contato G\u00e1s \u2013 \u00d3leo, termos usuais da ind\u00fastria do petr\u00f3leo \nque indicam qual \u00e9 a profundidade na qual o aqu\u00edfero se encontra e qual a profundidade na qual a \ncapa de g\u00e1s do reservat\u00f3rio come\u00e7a. \n\n\n\n21 \n \n\nMCMC para realizar o ajuste ao hist\u00f3rico de produ\u00e7\u00e3o. Tavakoli et al. (2013) utilizam \n\no EnKF para atualizar modelos estoc\u00e1sticos. Trani e Leeuwenburgh (2013), usam o \n\nEnKF no ajuste de hist\u00f3rico s\u00edsmico dos fluidos frontais.  \n\n\n\n22 \n \n\nCAP\u00cdTULO 2 \n\n2. Reservat\u00f3rios de Petr\u00f3leo \n\n2.1 Introdu\u00e7\u00e3o  \n\nRealizar ajuste ao hist\u00f3rico em um reservat\u00f3rio de petr\u00f3leo significa calibrar o mode-\n\nlo usado na simula\u00e7\u00e3o variando as propriedades de rocha e fluido com o objetivo de \n\naproximar as curvas de produ\u00e7\u00e3o previstas e observadas. Portanto, para obter su-\n\ncesso na calibra\u00e7\u00e3o \u00e9 necess\u00e1rio entender como funciona um reservat\u00f3rio, quais \n\ns\u00e3o as suas propriedades, como elas interferem no escoamento dos fluidos e quais \n\ns\u00e3o as equa\u00e7\u00f5es que as governam. \n\nNeste cap\u00edtulo, descrevemos alguns conceitos fundamentais de engenharia de re-\n\nservat\u00f3rios, que s\u00e3o essenciais para a discuss\u00e3o de qualquer aplica\u00e7\u00e3o da simula-\n\n\u00e7\u00e3o de reservat\u00f3rios, e introduzimos algumas terminologias comuns usadas em en-\n\ngenharia de reservat\u00f3rios. Come\u00e7amos com algumas defini\u00e7\u00f5es formais do reserva-\n\nt\u00f3rio de petr\u00f3leo, em seguida, descrevemos brevemente as equa\u00e7\u00f5es governantes. \n\n \n2.2 Reservat\u00f3rios de Petr\u00f3leo \n\nUm reservat\u00f3rio de petr\u00f3leo \u00e9 um aglomerado de rochas sedimentares, geralmente \n\narenitos ou carbonatos, portador de hidrocarbonetos (\u00f3leo e g\u00e1s), \u00e1gua e outros flui-\n\ndos. A Figura 2.1 ilustra uma se\u00e7\u00e3o transversal de uma rocha-reservat\u00f3rio com os \n\nseus principais componentes. \n\n \n\n \n\n  \n\n\n\n23 \n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nOs fluidos contidos na rocha reservat\u00f3rio (\u00e1gua, \u00f3leo e g\u00e1s) ficam armazenados sob \n\npress\u00e3o nos poros da rocha. Quando um po\u00e7o \u00e9 aberto, devido \u00e0 diferen\u00e7a de pres-\n\ns\u00f5es, esses fluidos escoam da rocha-reservat\u00f3rio para o po\u00e7o e, em seguida, para a \n\nunidade de produ\u00e7\u00e3o na superf\u00edcie onde s\u00e3o tratados. Este processo \u00e9 conhecido \n\ncomo recupera\u00e7\u00e3o prim\u00e1ria. Depois de um certo tempo de produ\u00e7\u00e3o, normalmente \u00e9 \n\niniciado um procedimento de recupera\u00e7\u00e3o secund\u00e1ria, no qual \u00e9 injetada \u00e1gua em \n\npo\u00e7os injetores\n11\n\n, para manter a press\u00e3o no reservat\u00f3rio e deslocar o \u00f3leo na dire-\n\n\u00e7\u00e3o dos po\u00e7os produtores. \n\n \n2.3 Principais Propriedades do Reservat\u00f3rio \n\n2.3.1 Propriedades da Rocha \n\nAs propriedades da rocha variam bastante em fun\u00e7\u00e3o ao hist\u00f3rico de deposi\u00e7\u00e3o e \n\ncompacta\u00e7\u00e3o dos seus sedimentos, como o tamanho e sele\u00e7\u00e3o dos gr\u00e3os, grau de \n\ncimenta\u00e7\u00e3o, hist\u00f3rico de press\u00e3o e temperatura, etc. Raramente, uma rocha reserva-\n\nt\u00f3rio \u00e9 homog\u00eanea ao longo de toda sua extens\u00e3o, sendo necess\u00e1rio realizar estu-\n\ndos sobre a varia\u00e7\u00e3o de suas propriedades. As propriedades petrof\u00edsicas tem uma \n\nvariabilidade inerente aos processos de forma\u00e7\u00e3o da subsuperf\u00edcie, e est\u00e1 sujeita a \n\ngrandes incertezas. Apenas em poucos pontos do reservat\u00f3rio as propriedades s\u00e3o \n\nconhecidas com alguma confian\u00e7a, em fun\u00e7\u00e3o de dados oriundos de po\u00e7os explora-\n\nt\u00f3rios e de correla\u00e7\u00f5es com outros tipos de informa\u00e7\u00f5es, como dados s\u00edsmicos e \n\n                                                           \n11\n\n Po\u00e7os injetores: \u00c9 um po\u00e7o usado para injetar fluidos no reservat\u00f3rio visando melhorar a recupe-\nra\u00e7\u00e3o de petr\u00f3leo, de g\u00e1s natural. \n\n \n\nFigura 2.1: Se\u00e7\u00e3o transversal de uma amostra de rocha de reservat\u00f3rio. \n\n \n\n (Rosa et al., 2006) \n\n \n\n\n\n24 \n \n\nafloramentos. A escolha natural para a descri\u00e7\u00e3o destas propriedades \u00e9 atrav\u00e9s de \n\ncampos estoc\u00e1sticos e as ferramentas usadas s\u00e3o baseadas em geoestat\u00edstica. \n\n \n\n2.3.1.1 Porosidade (? ) \n\nA porosidade \u00e9 uma medida dos espa\u00e7os vazios na rocha, e mede a capacidade de \n\narmazenar fluidos. Ela \u00e9 representada pela letra grega ?  e definida como: \n\np\n\nT\n\nV\n\nV\n? ?                                                                                                                      (2.1) \n\nonde \nT\n\nV  \u00e9 um volume representativo de rocha\n12\n\n e pV  \u00e9 o volume dos poros (vazios) \n\ninterconectados ou n\u00e3o. A porosidade \u00e9 expressa, geralmente, em porcentagem. \n\nA porosidade efetiva ? ?ef?  \u00e9 a raz\u00e3o entre o volume de poros conectados e o volume \n\nrepresentativo. Essa porosidade \u00e9 a mais importante para o estudo de reservat\u00f3rios, \n\npois o escoamento dos fluidos do reservat\u00f3rio se d\u00e1 atrav\u00e9s dos poros conectados. \n\n(Rosa et al., 2006). \n\n \n\n2.3.1.2 Compressibilidade Efetiva ( fc ) \n\nA compressibilidade efetiva expressa a varia\u00e7\u00e3o do volume de poros em fun\u00e7\u00e3o da \n\nvaria\u00e7\u00e3o de press\u00e3o ao qual a rocha est\u00e1 submetida: \n\n1 p\nf\n\np\n\nV\nc\n\nV p\n\n?\n?\n\n?\n                                                                                                              (2.2) \n\nonde p  \u00e9 a press\u00e3o. A compressibilidade \u00e9 medida, geralmente, em \n2 1\n\n( / )kg cm\n?\n\n. \n\n                                                           \n12\n\n Volume representativo de rocha: O volume representativo \u00e9 um conceito associado \u00e0 escala de \nvaria\u00e7\u00e3o das propriedades da rocha. Ele \u00e9 pequeno o suficiente para que as propriedades de interes-\nse possam ser consideradas constantes, mas n\u00e3o t\u00e3o pequeno que as propriedades, calculadas com \nalguma m\u00e9dia espacial, variem excessiva ou mesmo descontinuamente em torno da sua vizinhan\u00e7a. \nPor exemplo, se um volume considerado estivesse contido apenas em um poro ou em um gr\u00e3o maci-\n\u00e7o do material, a porosidade como definida acima n\u00e3o faria sentido, pois variaria entre 1 ou 0, sendo \nque nenhum destes dois valores representa a capacidade de um pequeno volume desta rocha arm a-\nzenar fluidos. Conforme o volume considerado aumenta, o valor da porosidade calculado como em \n(2.1) estabiliza-se em torno de um valor fixo. O menor volume para o qual isto ocorre \u00e9 o volume re-\npresentativo. \n\n\n\n25 \n \n\nConsiderando o volume total constante e substituindo a Equa\u00e7\u00e3o (2.1) na Equa\u00e7\u00e3o \n\n(2.2), e obtemos a compressibilidade da rocha: \n\n1 ?\n\n?\n\n?\n?\n\n?\nR\n\nc\np\n\n                                                                                                                (2.3) \n\n \n\n2.3.1.3 Satura\u00e7\u00e3o ( S ) \n\nA satura\u00e7\u00e3o \u00e9 a fra\u00e7\u00e3o ou porcentagem do volume de poro ocupado por um flu\u00eddo \n\nem particular (\u00f3leo, g\u00e1s, \u00e1gua). A Figura 2 mostra um corte transversal de uma ro-\n\ncha-reservat\u00f3rio com presen\u00e7a de fluidos, \u00e1gua, \u00f3leo e g\u00e1s nos poros. \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nf\n\nf\n\np\n\nV\nS\n\nV\n?                                                                                                                    (2.4) \n\nOnde fS  \u00e9 a satura\u00e7\u00e3o do fluido (\u00e1gua, \u00f3leo e g\u00e1s), fV  o volume que ocupa o fluido \n\ne pV  o volume poroso. A satura\u00e7\u00e3o \u00e9 expressa, geralmente, em porcentagem. \n\n \n\n2.3.1.4 Permeabilidade ? ?k  \n\nA permeabilidade absoluta \u00e9 uma medida que indica o qu\u00e3o f\u00e1cil \u00e9 a passagem de \n\nfluidos pelo meio poroso. Quanto maior for o seu valor, maior ser\u00e1 a vaz\u00e3o dos flui-\n\ndos quando o meio \u00e9 submetido a uma mesma diferen\u00e7a de press\u00f5es. O escoamen-\n\nto em meios rochosos acontece atrav\u00e9s de uma infinidade de microcanais formados \n\npelos poros, distribu\u00eddo em dire\u00e7\u00f5es e com conex\u00f5es completamente aleat\u00f3rias. \n\nFigura 2.2: Rocha-reservat\u00f3rio contendo tr\u00eas fluidos: \u00e1gua, \u00f3leo e g\u00e1s. \n\n \n\n (Rosa et al., 2006) \n\n\n\n26 \n \n\nConsidera\u00e7\u00f5es experimentais e te\u00f3ricas permitem que este escoamento possa ser \n\ndescrito por velocidades volum\u00e9tricas ou velocidades m\u00e9dias, sem que seja neces-\n\ns\u00e1ria a descri\u00e7\u00e3o detalhada do escoamento nos poros. No entanto, o que se verifica \n\ntanto experimental quanto teoricamente \u00e9 que uma diferen\u00e7a de press\u00f5es em uma \n\ndire\u00e7\u00e3o pode causar escoamento n\u00e3o s\u00f3 nesta dire\u00e7\u00e3o, mas tamb\u00e9m em dire\u00e7\u00f5es \n\nperpendiculares a ela. Para quantificar este fen\u00f4meno, a permeabilidade pode ser \n\nrepresentada por uma matriz quadrada, onde os coeficientes da diagonal relacionam \n\na velocidade m\u00e9dia com o gradiente de press\u00e3o na mesma dire\u00e7\u00e3o e os temos fora \n\nda diagonal relacionam o gradiente de press\u00e3o com velocidades de escoamento \n\nperpendiculares a ele. Outras considera\u00e7\u00f5es te\u00f3ricas mostram que a permeabilidade \n\natende aos crit\u00e9rios para ser considerada um tensor de segunda ordem. Em muitas \n\naplica\u00e7\u00f5es de simula\u00e7\u00f5es de reservat\u00f3rios usa-se uma simplifica\u00e7\u00e3o considerando a \n\npermeabilidade como um escalar ou tensor diagonal, isto \u00e9, que os gradientes de \n\npress\u00e3o s\u00f3 produzem escoamento na sua pr\u00f3pria dire\u00e7\u00e3o. Neste caso, como h\u00e1 tr\u00eas \n\ndire\u00e7\u00f5es espaciais, a permeabilidade pode ser representada por um vetor ou uma \n\nmatriz diagonal. A simplifica\u00e7\u00e3o final ocorre quando se considera que a permeabili-\n\ndade \u00e9 a mesma nas tr\u00eas dire\u00e7\u00f5es espaciais, e portanto pode ser representada por \n\num \u00fanico escalar. No restante deste cap\u00edtulo a permeabilidade ser\u00e1 considerada um \n\nescalar. Geralmente, \u00e9 expressa em miliDarcy ? ?mD  (Rosa et al., 2006). \n\nEm escoamentos multif\u00e1sicos, isto \u00e9, quando consideramos tr\u00eas fases diferentes \n\ncoexistindo no reservat\u00f3rio, a fase aquosa (agu\u00e1 e outros componentes dissolvidos), \n\noleica (hidrocarbonetos na fase l\u00edquida) e gasosa (hidrocarbonetos na fase gasosa), \n\na presen\u00e7a de cada fase influencia o escoamento das outras, e portanto a permeabi-\n\nlidade deve ser determinada para cada fase, sendo chamada neste caso de perme-\n\nabilidade efetiva ? ?, ,o g wk k k . A raz\u00e3o entre a permeabilidade efetiva de cada fluido e \n\na permeabilidade absoluta do reservat\u00f3rio \u00e9 chamada de permeabilidade relativa \n\n? ?, ,ro rg rwk k k . A permeabilidade deve ser medida experimentalmente, por\u00e9m, h\u00e1 \n\nf\u00f3rmulas anal\u00edticas, com par\u00e2metros ajust\u00e1veis em fun\u00e7\u00e3o de propriedades das ro-\n\nchas e das condi\u00e7\u00f5es de escoamento, que podem ser usadas em simuladores de \n\nreservat\u00f3rios e fornecem resultados adequados em algumas situa\u00e7\u00f5es. \n\n \n \n \n\n\n\n27 \n \n\n2.3.2 Propriedades dos Fluidos \n\nAs propriedades dos fluidos variam conforme a sua composi\u00e7\u00e3o, press\u00e3o e tempera-\n\ntura ao qual est\u00e3o submetidos e \u00e0 composi\u00e7\u00e3o da pr\u00f3pria rocha, devido \u00e0s intera-\n\n\u00e7\u00f5es rocha-fluido. Elas s\u00e3o medidas atrav\u00e9s de amostras coletadas em testes espe-\n\nc\u00edficos (viscosidade, PVT, etc.).  \n\n \n2.3.2.1 Viscosidade ( ? ) \n\nA viscosidade de um fluido \u00e9 a propriedade que mede a resist\u00eancia ao cisalhamento. \n\n\u00c9 definida como a raz\u00e3o entre a tens\u00e3o cisalhante e a gradiente de velocidades. \n\nNormalmente \u00e9 medida em centipoise ? ?cp  na engenharia de reservat\u00f3rios \n\n \n\n2.3.2.2 Compressibilidade ? ?c  \n\nComo na rocha reservat\u00f3rio, \u00e9 importante conhecer a varia\u00e7\u00e3o de volume de cada \n\nfluido em fun\u00e7\u00e3o da varia\u00e7\u00e3o de press\u00e3o. A determina\u00e7\u00e3o da compressibilidade o \n\nfluido \u00e9 an\u00e1loga \u00e0 da rocha e usa a mesma unidade.  \n\n \n\n2.3.2.3 Fator Volume de Forma\u00e7\u00e3o ? ?B  \n\nO fator volume de forma\u00e7\u00e3o \u00e9 a raz\u00e3o entre a massa espec\u00edfica de um fluido nas \n\ncondi\u00e7\u00f5es de superf\u00edcie (1.033 kg/cm\n2\n e 20\u00baC) e nas condi\u00e7\u00f5es de press\u00e3o e tempe-\n\nratura do reservat\u00f3rio. \n\nstd\n\nres\n\nB\n?\n\n?\n?                                                                                                                    (2.5) \n\nOnde \nstd\n\n? \u00e9 a massa espec\u00edfica nas condi\u00e7\u00f5es de superf\u00edcie e \nres\n\n?  \u00e9 a massa espec\u00ed-\n\nfica nas condi\u00e7\u00f5es de reservat\u00f3rio. \n\n2.4 Simula\u00e7\u00e3o de Reservat\u00f3rios \n\nNos itens anteriores, foram apresentadas algumas das propriedades do sistema ro-\n\ncha-fluido. Nesta se\u00e7\u00e3o, ser\u00e1 apresentada uma formula\u00e7\u00e3o matem\u00e1tica que embasa \n\no modelo num\u00e9rico utilizado na simula\u00e7\u00e3o de reservat\u00f3rios com a finalidade de mos-\n\ntrar a mec\u00e2nica que envolve o escoamento. Dentre os modelos aplicados na ind\u00fas-\n\n\n\n28 \n \n\ntria, o modelo Black Oil (Rosa et al., 2006) \u00e9 adotado neste trabalho devido a sua \n\nsimplicidade no tratamento do problema e boa aplicabilidade a problemas realistas. \n\nNeste modelo, \u00e9 considerado um escoamento trif\u00e1sico e com tr\u00eas componentes \n\n(\u00e1gua, \u00f3leo e g\u00e1s) onde: \n\n? A \u00e1gua e o \u00f3leo s\u00e3o imisc\u00edveis; \n\n? O g\u00e1s pode existir na forma livre ou dissolvida no \u00f3leo. A solubilidade do g\u00e1s \n\nna \u00e1gua \u00e9 desprezada; \n\n? A temperatura do reservat\u00f3rio \u00e9 assumida constante ao longo do tempo; \n\n? Os fluidos est\u00e3o em equil\u00edbrio termodin\u00e2mico dentro do reservat\u00f3rio (Ertekin et \n\nal., 2001). \n\n \n\n2.4.1 Formula\u00e7\u00e3o Matem\u00e1tica \n\nPara o desenvolvimento de um simulador num\u00e9rico, o primeiro passo \u00e9 o estudo da \n\nf\u00edsica do problema e desenvolvimento das equa\u00e7\u00f5es que a governam o comporta-\n\nmento do escoamento no meio poroso. A engenharia de reservat\u00f3rio, no que con-\n\ncerne a t\u00e9cnicas de simula\u00e7\u00e3o computacional, \u00e9 uma disciplina conservadora. Nos \n\nsimuladores comerciais, em geral, s\u00e3o usadas t\u00e9cnicas num\u00e9ricas baseadas em co-\n\nordenadas cartesianas e malhas estruturadas\n13\n\n, devido principalmente \u00e0 familiarida-\n\nde da ind\u00fastria com as mesmas e a confiabilidade percebida dos atuais simuladores \n\nque foram assim constru\u00eddos. As equa\u00e7\u00f5es que reguem o escoamento multif\u00e1sico \n\nem meios porosos podem, no entanto, ser escritas tamb\u00e9m em outros sistemas de \n\ncoordenadas e para outros tipos de malhas. \n\n \n2.4.2 Equa\u00e7\u00e3o de Fluxo para o Escoamento Trif\u00e1sico \n\nA formula\u00e7\u00e3o da equa\u00e7\u00e3o de fluxo adotada no simulador de escoamento empregado \n\nneste trabalho \u00e9 baseada na conserva\u00e7\u00e3o de massa para cada fase (l\u00edquida ou ga-\n\nsosa) e o modelo Black Oil o g\u00e1s se encontra em duas formas: uma livre, formando a \n\nfase gasosa, e a outra solubilizada no \u00f3leo, compondo a fase de hidrocarbonetos \n\nl\u00edquidos. A modelagem matem\u00e1tica do problema parte do princ\u00edpio da conserva\u00e7\u00e3o \n\nde massa, que fornece uma equa\u00e7\u00e3o de conserva\u00e7\u00e3o de massa para cada fase, e \n\n                                                           \n13\n\n Malhas estruturadas: S\u00e3o malhas localmente ortogonais que obedece a um sistema de coordena-\ndas usualmente formadas por quadril\u00e1teros (2D) e prismas retangulares geradas facilmente (3D). \n\n\n\n29 \n \n\nda lei de Darcy (Ertekin et al., 2001), uma lei fenomenol\u00f3gica que relaciona a veloci-\n\ndade m\u00e9dia de cada fase com os gradientes de press\u00e3o. A conserva\u00e7\u00e3o de massa e \n\na Lei de Darcy s\u00e3o expressas em termos de equa\u00e7\u00f5es diferenciais parciais, que po-\n\ndem ser resolvidas com uma s\u00e9rie de t\u00e9cnicas num\u00e9ricas, a t\u00e9cnica mais convencio-\n\nnal \u00e9 das diferen\u00e7as finitas baseadas em volumes de controle, que quando aplicadas \n\n\u00e0 conserva\u00e7\u00e3o de massa e Lei de Darcy, generalizada para escoamentos multif\u00e1si-\n\ncos, leva \u00e0s Equa\u00e7\u00f5es para as fases oleica, aquosa e gasosa de 2.6 a 2.8. \n\n,\n\nro o ro o\nx x o y y o\n\no o o o\n\nro o o\nz z o o std b\n\no o o\n\nk p k pZ Z\nA k x A k y\n\nx B x x y B y y\n\nk p SZ\nA k z q V\n\nz B z z t B\n\n? ?\n? ?\n\n?\n?\n\n?\n\n? ?? ? ? ?? ?? ? ? ?? ?\n? ? ? ? ?? ?? ? ? ?? ?\n\n? ? ? ? ? ?? ? ? ?? ? ? ?\n\n? ? ? ??? ? ?? ?\n? ? ? ? ?? ? ? ?? ?\n? ? ? ?? ?? ? ? ?\n\n                       (2.6) \n\n,\n\nrw w rw w\nx x w y y w\n\nw w w w\n\nrw w w\nz z w w std b\n\nw w w\n\nk p k pZ Z\nA k x A k y\n\nx B x x y B y y\n\nk p SZ\nA k z q V\n\nz B z z t B\n\n? ?\n? ?\n\n?\n?\n\n?\n\n? ?? ? ? ?? ?? ? ? ?? ?\n? ? ? ? ?? ?? ? ? ?? ?\n\n? ? ? ? ? ?? ? ? ?? ? ? ?\n\n? ? ? ??? ? ?? ?\n? ? ? ? ?? ? ? ?? ?\n? ? ? ?? ?? ? ? ?\n\n                          (2.7) \n\nrg g ro s o\nx x g x x o\n\ng g o o\n\nrg g ro s o\ny y g y y o\n\ng g o o\n\nrg g ro s o\nz z g z z\n\ng g o o\n\nk p k R pZ Z\nA k A k x\n\nx B x x B x x\n\nk p k R pZ Z\nA k A k y\n\ny B y y B y y\n\nk p k R pZ\nA k A k\n\nz B z z B\n\n? ?\n? ?\n\n? ?\n? ?\n\n?\n? ?\n\n? ??? ? ?? ? ?? ?\n? ? ? ?? ?? ? ? ?? ?? ? ? ? ?? ?? ?? ?\n\n? ??? ? ? ??? ? ?\n? ? ? ? ?? ?? ? ? ?? ?? ? ? ? ?? ?? ?? ?\n\n?? ? ?? ?\n? ? ?? ?\n? ? ? ?? ?\n\n,\n\no\n\ng s o\ng std\n\ng o\n\nZ\nz\n\nz z\n\nS R S\nq\n\nt B B\n\n?\n\n? ?\n\n? ??? ?\n? ?? ?? ?? ??? ?? ?\n\n? ??\n? ? ?? ?\n\n? ?? ? ?\n\n                                       (2.8) \n\nNestas equa\u00e7\u00f5es, A  \u00e9 a \u00e1rea de uma face de um volume de controle, tamb\u00e9m cha-\n\nmado de c\u00e9lula computacional ou apenas c\u00e9lula, k  \u00e9 a permeabilidade, \nr\n\nk  \u00e9 a per-\n\nmeabilidade relativa, p  \u00e9 a press\u00e3o, B  \u00e9 o fator volume de forma\u00e7\u00e3o, ?  \u00e9 a viscosi-\n\ndade, ?  \u00e9 o peso espec\u00edfico, Z  \u00e9 a altura do volume de controle em rela\u00e7\u00e3o a uma \n\naltura de refer\u00eancia, , ,x y z  s\u00e3o as coordenadas cartesianas, ?  \u00e9 a porosidade, S  \u00e9 \n\na satura\u00e7\u00e3o, q \u00e9 a vaz\u00e3o volum\u00e9trica e sR  \u00e9 a raz\u00e3o de solubilidade do g\u00e1s no \u00f3leo. \n\n\n\n30 \n \n\nEssas s\u00e3o as equa\u00e7\u00f5es que governam o fluxo para todos os fluidos que comp\u00f5em o \n\nreservat\u00f3rio. Elas foram obtidas atrav\u00e9s da combina\u00e7\u00e3o das equa\u00e7\u00f5es de conserva-\n\n\u00e7\u00e3o de massa, de estado e da lei de Darcy, por\u00e9m n\u00e3o s\u00e3o suficientes para comple-\n\ntar a descri\u00e7\u00e3o do fluido em um meio poroso. Para isso s\u00e3o necess\u00e1rias rela\u00e7\u00f5es \n\nadicionais de restri\u00e7\u00e3o de satura\u00e7\u00e3o de cada fase e express\u00f5es para as press\u00f5es \n\ncapilares como fun\u00e7\u00f5es da satura\u00e7\u00e3o de fases (Ertekin et al., 2001). As equa\u00e7\u00f5es \n\nque representam estas restri\u00e7\u00f5es est\u00e3o escritas abaixo: \n\n1\no g w\n\nS S S? ? ?                                                                                                          (2.9) \n\n? ?w o w wp p p f S? ? ?                                                                                              (2.10) \n\n? ?cgo g o gp p p f S? ? ?                                                                                             (2.11) \n\nNestas equa\u00e7\u00f5es, os subscritos o , w  e g  representam as fases oleica, aquosa e \n\ngasosa, respectivamente, e   \u00e9 uma fun\u00e7\u00e3o dada que relaciona press\u00f5es capilares e \n\nsatura\u00e7\u00f5es, e deve ser determinada experimentalmente. As equa\u00e7\u00f5es apresentadas \n\nacima junto com as condi\u00e7\u00f5es de contorno do reservat\u00f3rio descrevem a formula\u00e7\u00e3o \n\nBlack Oil. Observe que o n\u00famero de inc\u00f3gnitas para uma \u00fanica c\u00e9lula \n\n? ?, , , , ,o w g o w gp p p S S S  coincide com o n\u00famero de equa\u00e7\u00f5es. Todas as outras vari\u00e1veis \n\ns\u00e3o medidas ou estimadas, ou seja, s\u00e3o par\u00e2metros de entrada na simula\u00e7\u00e3o de \n\nreservat\u00f3rios e comp\u00f5em o dom\u00ednio do espa\u00e7o de busca no ajuste ao hist\u00f3rico. \n\n \n\n \n\n  \n\n\n\n31 \n \n\nCAP\u00cdTULO 3 \n\n3. Ajuste ao Hist\u00f3rico \n\n3.1 Introdu\u00e7\u00e3o \n\nO processo de modifica\u00e7\u00e3o de par\u00e2metros do modelo de reservat\u00f3rio usado em uma \n\nsimula\u00e7\u00e3o para tentar fazer com que as previs\u00f5es de taxas de inje\u00e7\u00e3o e produ\u00e7\u00e3o, \n\npress\u00f5es, satura\u00e7\u00f5es e outras vari\u00e1veis se aproximem dos valores observados \n\nquando o campo entra em produ\u00e7\u00e3o \u00e9 chamado de ajuste ao hist\u00f3rico. \n\nO procedimento consiste no ajuste de um ou mais modelos matem\u00e1ticos aos dados \n\nhist\u00f3ricos, at\u00e9 que se obtenha uma discrep\u00e2ncia aceit\u00e1vel entre os dados observa-\n\ndos e os resultados previstos pelo modelo. Durante o processo, os par\u00e2metros do \n\nreservat\u00f3rio s\u00e3o alterados para que se obtenha, por exemplo, a menor diferen\u00e7a \n\nposs\u00edvel entre uma curva de produ\u00e7\u00e3o de \u00f3leo prevista e observada, em alguma \n\nnorma conveniente. O ajuste ao hist\u00f3rico \u00e9, portanto, um processo de otimiza\u00e7\u00e3o, \n\nonde se procura minimizar as discrep\u00e2ncias entre os resultados do modelo de reser-\n\nvat\u00f3rio e as observa\u00e7\u00f5es feitas no campo. (Rosa et al., 2006). \n\nO hist\u00f3rico de dados de produ\u00e7\u00e3o cont\u00eam informa\u00e7\u00f5es do reservat\u00f3rio que podem \n\nser usadas para reduzir a incerteza na previs\u00e3o do desempenho futuro. Avalia\u00e7\u00e3o da \n\nincerteza, que pode ser feita quando o ajuste ao hist\u00f3rico \u00e9 feito de forma estoc\u00e1sti-\n\nca, \u00e9 importante por permitir uma avalia\u00e7\u00e3o dos riscos associados \u00e0 produ\u00e7\u00e3o da-\n\nquele reservat\u00f3rio. Espera-se tamb\u00e9m que a assimila\u00e7\u00e3o ao longo do tempo de da-\n\ndos observados de produ\u00e7\u00e3o permita que haja uma redu\u00e7\u00e3o da incerteza associada \n\nao modelo do reservat\u00f3rio. Neste trabalho, o Filtro de Kalman com Ensembles, que \u00e9 \n\num m\u00e9todo estoc\u00e1stico para ajuste ao hist\u00f3rico autom\u00e1tico tem com resultado \u00fatil \n\numa avalia\u00e7\u00e3o da incerteza associada ao modelo do reservat\u00f3rio. Neste caso, o mo-\n\ndelo do reservat\u00f3rio deve ser entendido como todo o conjunto de realiza\u00e7\u00f5es petro-\n\nf\u00edsicas que s\u00e3o atualizadas ao longo do tempo durante o processo de ajuste. A pre-\n\nvis\u00e3o da produ\u00e7\u00e3o \u00e9 feita para cada membro do conjunto e estat\u00edsticas de interesse \n\npodem ser calculadas sobre o ensemble para qualquer instante no futuro, e podem \n\nser usadas para quantificar a incerteza no modelo. \n\n \n\n \n\n\n\n32 \n \n\n3.2 Tipos de Ajuste ao Hist\u00f3rico \n\nNa engenharia de petr\u00f3leo classifica-se o ajuste ao hist\u00f3rico em manual, onde as \n\nmodifica\u00e7\u00f5es no modelo s\u00e3o feitas apenas de acordo com a experi\u00eancia dos profis-\n\nsionais envolvidos e automatizado ou assistido por computador, onde programas de \n\ncomputador que implementam algum algoritmo matem\u00e1tico ditam as modifica\u00e7\u00f5es \n\nno modelo de foram a aproximar a previs\u00e3o do modelo aos dados observados. \n\n \n\n3.2.1 Ajuste ao Hist\u00f3rico Manual  \n\nO ajuste ao hist\u00f3rico manual se caracteriza por ser um processo de tentativa e erro, \n\nque depende essencialmente da experi\u00eancia e intui\u00e7\u00e3o dos engenheiros de reserva-\n\nt\u00f3rios e ge\u00f3logos. Normalmente, \u00e9 mais trabalhoso do ponto de vista de esfor\u00e7o do \n\nprofissional envolvido no processo, pois todas as tarefas, tais como altera\u00e7\u00f5es do \n\nmodelo de simula\u00e7\u00e3o, execu\u00e7\u00e3o das simula\u00e7\u00f5es, an\u00e1lise dos resultados, dentre ou-\n\ntras, s\u00e3o realizadas de forma manual e exigem mais intera\u00e7\u00e3o com o processo, to-\n\nmando mais tempo de trabalho. Al\u00e9m disto, as decis\u00f5es sobre quanto modificar os \n\npar\u00e2metros de projeto s\u00e3o tomadas sem um grande embasamento matem\u00e1tico. Mui-\n\ntas vezes, o conhecimento sobre a geologia do campo \u00e9 ignorado na busca de um \n\nmelhor ajuste entre curvas previstas e observadas. Este procedimento \u00e9 oneroso, \n\ndemorado e propenso a erros, e os ajustes manuais tendem a n\u00e3o serem confi\u00e1veis \n\npara previs\u00f5es de longo prazo. \n\n \n\n3.2.2 Ajuste ao Hist\u00f3rico Automatizado \n\nO ajuste ao hist\u00f3rico automatizado tende a ser muito mais r\u00e1pido do que o procedi-\n\nmento manual. Ele pode tratar um grande n\u00famero de diferentes par\u00e2metros de ajus-\n\nte, em contraste ao procedimento manual, e tamb\u00e9m pode tratar com muito mais \n\nfacilidade um grande n\u00famero de po\u00e7os, campos de grande dimens\u00e3o e complexida-\n\nde geol\u00f3gica. O ajuste ao hist\u00f3rico autom\u00e1tico tamb\u00e9m pode fornecer resultados \n\nmais confi\u00e1veis nos casos onde as litologias s\u00e3o mais complexas, com grande hete-\n\nrogeneidade. A ideia geral do ajuste ao hist\u00f3rico autom\u00e1tico \u00e9 come\u00e7ar a partir de \n\numa estimativa inicial de um par\u00e2metro e melhor\u00e1-la por meio da assimila\u00e7\u00e3o de da-\n\ndos de campo em um la\u00e7o autom\u00e1tico, segundo algum mecanismo de otimiza\u00e7\u00e3o. \n\nAs altera\u00e7\u00f5es dos par\u00e2metros do modelo do reservat\u00f3rio s\u00e3o feitas diretamente por \n\nprogramas de computadores, para minimizar uma fun\u00e7\u00e3o objetivo, por exemplo, a \n\n\n\n33 \n \n\nintegral dos quadrados das diferen\u00e7as entre os dados simulados e observados para \n\nalgumas vari\u00e1veis de interesse. Usualmente, o procedimento n\u00e3o \u00e9 completamente \n\nautomatizado, a experi\u00eancia dos profissionais de engenharia de reservat\u00f3rios \u00e9 \n\naproveitada impondo restri\u00e7\u00f5es aos modelos admiss\u00edveis no processo de otimiza-\n\n\u00e7\u00e3o, como a exist\u00eancia de caracter\u00edsticas estruturais geol\u00f3gicas importantes. O ajus-\n\nte ao hist\u00f3rico automatizado pode ser feito por etapas, e pode incluir etapas de inter-\n\nfer\u00eancia manual direta no processo. \n\nV\u00e1rias investiga\u00e7\u00f5es foram feitas sobre muitos m\u00e9todos de ajuste ao hist\u00f3rico auto-\n\nm\u00e1tico nas \u00faltimas d\u00e9cadas no setor de petr\u00f3leo. Estes m\u00e9todos podem ser classifi-\n\ncados como: \n\n \na) Algoritmos Determin\u00edsticos \n\nAlgoritmos determin\u00edsticos usam abordagens tradicionais de otimiza\u00e7\u00e3o e usam um \n\nmodelo de reservat\u00f3rio ideal como um modelo que torna uma determinada fun\u00e7\u00e3o \n\nobjetivo estacion\u00e1ria, sujeita a um conjunto de restri\u00e7\u00f5es. Nas implementa\u00e7\u00f5es usu-\n\nais, o gradiente da fun\u00e7\u00e3o objetivo \u00e9 calculado, alguma dire\u00e7\u00e3o de busca de otimiza-\n\n\u00e7\u00e3o \u00e9 ent\u00e3o determinada e um algoritmo do tipo \u201cline search\u201d \u00e9 aplicado ao longo \n\ndesta dire\u00e7\u00e3o (Liang, 2007). Os algoritmos determin\u00edsticos normalmente minimizam \n\na diferen\u00e7a entre as medidas observadas no campo e os resultados do simulador de \n\nreservat\u00f3rios, dentro de um processo iterativo que inclui entre suas principais eta-\n\npas: \n\n? Execu\u00e7\u00e3o do simulador de reservat\u00f3rio para o per\u00edodo completo de ajuste ao \n\nhist\u00f3rico; \n\n? Avalia\u00e7\u00e3o da fun\u00e7\u00e3o objetivo; \n\n? Atualiza\u00e7\u00e3o das propriedades petrof\u00edsicas do modelo. \n\nAlguns algoritmos que s\u00e3o comumente usados para o ajuste ao hist\u00f3rico baseado \n\nem algoritmos de otimiza\u00e7\u00e3o determin\u00edstica s\u00e3o listados a seguir. (Landa, 1979 e \n\nLiang, 2007): \n\n \n\n? Algoritmos Baseados em Gradiente: \n\n? M\u00e9todo de Gauss - Newton (GN); \n\n? Algoritmo de Levenberg \u2013 Marquardt; \n\n\n\n34 \n \n\n? M\u00e9todo de Gradientes Conjugados; \n\n? M\u00e9todo Quase \u2013Newton; \n\n? M\u00e9todo de Broyden, Fletcher, Goldfarb e Shannon (BFGS); \n\n  \n\nb) Algoritmos Estoc\u00e1sticos \n\nOs algoritmos estoc\u00e1sticos podem consumir uma quantidade consider\u00e1vel de tempo \n\ncomputacional, em compara\u00e7\u00e3o com um algoritmo determin\u00edstico, mas devido ao \n\nr\u00e1pido desenvolvimento da capacidade de mem\u00f3ria do computador e velocidade de \n\nprocessamento, algoritmos estoc\u00e1sticos est\u00e3o recebendo cada vez mais aten\u00e7\u00e3o.  \n\nAlgoritmos estoc\u00e1sticos t\u00eam tr\u00eas principais vantagens diretas:  \n\n? A abordagem estoc\u00e1stica gera um conjunto de modelos de reservat\u00f3rio e, por-\n\ntanto, \u00e9 mais apropriada para os problemas de ajuste ao hist\u00f3rico que conside-\n\nram incertezas; \n\n? A quantifica\u00e7\u00e3o de incertezas da previs\u00e3o de desempenho \u00e9 relativamente \n\nsimples e direta. \n\n? Algoritmos estoc\u00e1sticos podem, teoricamente, atingir o \u00f3timo global.  \n\nAlguns importantes algoritmos estoc\u00e1sticos para otimiza\u00e7\u00e3o s\u00e3o. (Liang, 2007):  \n\n \n\n? Algoritmos Baseados em Metaheur\u00edsticas:  \n\n? Recozimento simulado ( Simulated Annealing); \n\n? Algoritmos Gen\u00e9ticos; \n\n? Buscas Scatter e Tabu; \n\n? Algoritmo de Busca na Vizinhan\u00e7a (Neighborhood Search); \n\n? Algoritmos baseados em Ensembles (Filtro de Kalman); \n\n \n3.2.2.1 Recozimento Simulado \n\nRecozimento simulado (simulated annealing) \u00e9 um algoritmo probabil\u00edstico para pro-\n\nblemas de otimiza\u00e7\u00e3o global, que normalmente fornece uma boa aproxima\u00e7\u00e3o para \n\no \u00f3timo global de uma fun\u00e7\u00e3o dada em um grande espa\u00e7o de busca. Para certos \n\nproblemas o recozimento simulado (annealing) encontra uma solu\u00e7\u00e3o aceit\u00e1vel em \n\num per\u00edodo de tempo razo\u00e1vel. O nome de recozimento (annealing) vem da metalur-\n\n\n\n35 \n \n\ngia, de uma t\u00e9cnica que envolve aquecimento e resfriamento controlado de material \n\npara aumentar o tamanho dos seus cristais e reduzir os seus defeitos. Recozimento \n\nsimulado \u00e9 uma generaliza\u00e7\u00e3o de um m\u00e9todo de Monte Carlo para analisar as equa-\n\n\u00e7\u00f5es de estado e estados congelados de sistemas n-corpos (Metropolis, et al. 1953). \n\nPanda e Lake (1993), e Portellaand e Prais (1999) aplicaram a t\u00e9cnica de recozi-\n\nmento simulado para o ajuste ao hist\u00f3rico em reservat\u00f3rios. \n\n \n3.2.2.2 Algoritmos Gen\u00e9ticos \n\nAlgoritmos Gen\u00e9ticos (GA) s\u00e3o algoritmos de busca heur\u00edstica adaptativa que tem \n\ncomo premissa as ideias evolucion\u00e1rias de sele\u00e7\u00e3o natural e gen\u00e9tica. O m\u00e9todo \n\nenvolve uma popula\u00e7\u00e3o de cromossomos, onde cada cromossomo \u00e9 normalmente \n\ncodificado como uma sequ\u00eancia de bits e processado por \"sele\u00e7\u00e3o natural\" de uma \n\ngera\u00e7\u00e3o para a pr\u00f3xima gera\u00e7\u00e3o, associada com a heran\u00e7a, muta\u00e7\u00e3o, sele\u00e7\u00e3o e cru-\n\nzamento. As solu\u00e7\u00f5es vi\u00e1veis s\u00e3o chamadas indiv\u00edduos. O conceito b\u00e1sico dos GA \u00e9 \n\no de simular processos do ambiente natural necess\u00e1rios para a evolu\u00e7\u00e3o, especifi-\n\ncamente aqueles que seguem os princ\u00edpios estabelecidos por Charles Darwin da \n\nsobreviv\u00eancia do mais apto. Como tal, eles representam uma explora\u00e7\u00e3o inteligente \n\ndentro de um espa\u00e7o de busca definido para resolver um problema. Algoritmos ge-\n\nn\u00e9ticos t\u00eam sido amplamente estudados, experimentados e aplicados em muitos \n\ncampos do mundo da engenharia (Holland, 1975). Sua aplica\u00e7\u00e3o direta a problemas \n\nrealistas de grande porte \u00e9 dif\u00edcil, devido ao alto custo computacional inerente \u00e0 sua \n\nconverg\u00eancia lenta. Os algoritmos gen\u00e9ticos podem resolver bem problemas de \n\ngrande escala com muitos m\u00ednimos locais. \n\n \n\n3.2.2.3 Busca Scatter e Tabu \n\nBusca Scatter e Tabu s\u00e3o m\u00e9todos heur\u00edsticos, estabelecidos por Fred Glover na \n\nUniversidade do Colorado (Glover, 1977). A Busca Scatter (Glover, 1994) opera em \n\num conjunto de pontos chamados de pontos de refer\u00eancia que constituem boas so-\n\nlu\u00e7\u00f5es obtidas a partir de solu\u00e7\u00f5es anteriores. A abordagem sistematicamente gera \n\ncombina\u00e7\u00f5es lineares de pontos de refer\u00eancia para criar novos pontos, cada um dos \n\nquais est\u00e1 mapeado e associado a pontos poss\u00edveis. A busca Tabu (Glover e Lagu-\n\nna, 1997) \u00e9 uma orienta\u00e7\u00e3o inteligente para o processo de busca. Na ind\u00fastria do \n\npetr\u00f3leo, para a explora\u00e7\u00e3o e produ\u00e7\u00e3o de petr\u00f3leo, um otimizador contendo busca \n\n\n\n36 \n \n\nde scatter, busca tabu e redes neurais foi usado em alguns exemplos simples (April, \n\net al. 2003a) e tamb\u00e9m utilizado para gerenciamento de portf\u00f3lio (April, et al. 2003b).  \n\nSousa e colaboradores (2006) utilizaram a busca scatter para casos simples de ajus-\n\nte ao hist\u00f3rico e Cullick, et al. (2006) combinaram a busca scatter com um modelo \n\nsubstituto baseado em rede neural n\u00e3o-linear para problemas de ajuste ao hist\u00f3rico \n\ncom um pequeno n\u00famero de par\u00e2metros desconhecidos. \n\n \n3.2.2.4 Algoritmo de Vizinhan\u00e7a \n\nO algoritmo de vizinhan\u00e7a \u00e9 um algoritmo de otimiza\u00e7\u00e3o estoc\u00e1stico inicialmente \n\nempregado para problemas de invers\u00e3o s\u00edsmica (Sambridge, 1999a, 1999b), que \n\nagora \u00e9 usado para ajuste ao hist\u00f3rico (Christie, et al 2002 e 2006;. Suzuki e Caers, \n\n2006). \u00c9 uma t\u00e9cnica popular de invers\u00e3o por busca direta, semelhante ao recozi-\n\nmento simulado (annealing) e algoritmos gen\u00e9ticos. \n\n \n3.2.2.5 Filtro de Kalman \n\nO Filtro de Kalman (KF) foi desenvolvido por Kalman (1960) e \u00e9 o esquema de assi-\n\nmila\u00e7\u00e3o de dados sequencial mais conhecido. O Filtro de Kalman \u00e9 um procedimen-\n\nto computacional que proporciona uma boa efici\u00eancia para estimar o estado de um \n\nprocesso, de uma maneira que minimiza a m\u00e9dia do erro quadr\u00e1tico. Ele estima o \n\nestado de um sistema din\u00e2mico linear a partir de uma s\u00e9rie de medi\u00e7\u00f5es ruidosas. \n\nEm teoria, o Filtro de Kalman Estendido (EKF) \u00e9 a vers\u00e3o n\u00e3o-linear do Filtro de \n\nKalman que lineariza em torno da m\u00e9dia e covari\u00e2ncia atuais. A desvantagem do \n\nEKF \u00e9 que ele n\u00e3o \u00e9 eficiente no caso de sistemas altamente n\u00e3o lineares (Emerick, \n\n2012). \n\nMuitas varia\u00e7\u00f5es de Filtro de Kalman t\u00eam sido propostos para lidar com estas difi-\n\nculdades. Entre eles o Filtro de Kalman com Ensembles (EnKF) \u00e9 promissor. \u00c9 um \n\nfiltro recursivo, o que significa que quando novos dados chegam, ele pode apenas \n\ncalcular o pr\u00f3ximo passo e n\u00e3o h\u00e1 necessidade de executar uma nova otimiza\u00e7\u00e3o \n\ncompleta e \u00e9 adequado para problemas com um grande n\u00famero de vari\u00e1veis, tais \n\ncomo discretiza\u00e7\u00f5es de equa\u00e7\u00f5es diferenciais parciais em modelos geof\u00edsicos. O \n\nEnKF originou-se como uma vers\u00e3o do filtro de Kalman para grandes problemas em \n\nque a matriz de covari\u00e2ncia \u00e9 calculada aproximadamente a partir das realiza\u00e7\u00f5es \n\nque comp\u00f5em o ensemble, e agora \u00e9 um importante componente de assimila\u00e7\u00e3o de \n\n\n\n37 \n \n\ndados. Devido \u00e0 formula\u00e7\u00e3o simples e f\u00e1cil implementa\u00e7\u00e3o, o EnKF ganhou popula-\n\nridade para previs\u00e3o do tempo, oceanografia, hidrologia e engenharia de petr\u00f3leo. \n\nNesta disserta\u00e7\u00e3o, o EnKF \u00e9 usado para ajuste ao hist\u00f3rico autom\u00e1tico e assimila-\n\n\u00e7\u00e3o seq\u00fcencial de dados. \n\n \n3.3 Diferen\u00e7as entre o Ajuste ao Hist\u00f3rico Tradicional e EnKF \n\nO ajuste ao hist\u00f3rico tradicional atualiza os par\u00e2metros est\u00e1ticos do reservat\u00f3rio co-\n\nmo porosidade e permeabilidade at\u00e9 que um ajuste aceit\u00e1vel seja alcan\u00e7ado execu-\n\ntando o modelo de forma iterativa (Liang, 2007), e suas principais caracter\u00edsticas \n\ns\u00e3o:  \n\n? Repetidas simula\u00e7\u00f5es de reservat\u00f3rio para todo o hist\u00f3rico da produ\u00e7\u00e3o; \n\n? Requer o c\u00e1lculo de coeficientes de sensibilidade, que s\u00e3o as derivadas da \n\nfun\u00e7\u00e3o objetivo em rela\u00e7\u00e3o \u00e0s vari\u00e1veis de otimiza\u00e7\u00e3o; \n\n? Normalmente n\u00e3o \u00e9 totalmente automatizado; \n\n? O ajuste \u00e9 repetido com todo o hist\u00f3rico de produ\u00e7\u00e3o quando novos dados es-\n\ntiverem dispon\u00edveis; \n\n? N\u00e3o \u00e9 adequado para a atualiza\u00e7\u00e3o do modelo de reservat\u00f3rio em tempo real; \n\n? N\u00e3o incorpora facilmente a avalia\u00e7\u00e3o da incerteza. \n\n \nO EnKF atualiza o modelo de reservat\u00f3rio sequencialmente para ambos os par\u00e2me-\n\ntros est\u00e1ticos como porosidade e permeabilidade e par\u00e2metros din\u00e2micos como \n\npress\u00e3o e satura\u00e7\u00e3o, e suas principais caracter\u00edsticas s\u00e3o:  \n\n? Adequado para a atualiza\u00e7\u00e3o do modelo n\u00e3o-linear de simula\u00e7\u00e3o de reservat\u00f3-\n\nrio de grande porte, com centenas de milhares ou milh\u00f5es de c\u00e9lulas; \n\n? Uma simula\u00e7\u00e3o independente \u00e9 realizada para cada membro do ensemble o \n\nque permite uma implementa\u00e7\u00e3o em computa\u00e7\u00e3o distribu\u00edda tirivial; \n\n? N\u00e3o h\u00e1 necessidade c\u00e1lculos de derivadas, pois n\u00e3o s\u00e3o usados algoritmos de \n\notimiza\u00e7\u00e3o sequencial; \n\n? Pode ser totalmente automatizado; \n\n? Os dados de produ\u00e7\u00e3o s\u00e3o assimilados sequencialmente no tempo; \n\n? Os membros do ensemble s\u00e3o atualizados sequencialmente no tempo e refle-\n\ntem os \u00faltimos dados assimilados; \n\n\n\n38 \n \n\n? A previs\u00e3o de incerteza \u00e9 sempre atualizada e obtida diretamente dos mem-\n\nbros do ensemble.  \n\n \n \n3.4 Estimativa de Par\u00e2metros \n\nEstima\u00e7\u00e3o \u00e9 uma aproxima\u00e7\u00e3o calculada para um resultado que \u00e9 utiliz\u00e1vel se os \n\ndados de entrada s\u00e3o incompletos ou incertos. Em matem\u00e1tica, a aproxima\u00e7\u00e3o ou \n\nestima\u00e7\u00e3o normalmente significa encontrar limites superiores ou inferiores de uma \n\nquantidade que n\u00e3o pode ser facilmente calculada com precis\u00e3o. Em um enfoque \n\nonde a quantifica\u00e7\u00e3o de incertezas \u00e9 importante, no entanto, estamos mais interes-\n\nsados em determinar estat\u00edsticas, como m\u00e9dias, vari\u00e2ncias e percentiis, das vari\u00e1-\n\nveis estimadas. \n\nA estima\u00e7\u00e3o de par\u00e2metros \u00e9 uma aplica\u00e7\u00e3o \u00fatil do ajuste ao hist\u00f3rico para a deter-\n\nmina\u00e7\u00e3o das propriedades do reservat\u00f3rio. Todos os m\u00e9todos de estima\u00e7\u00e3o de pa-\n\nr\u00e2metros t\u00eam tr\u00eas etapas principais:  \n\n? Constru\u00e7\u00e3o de um modelo matem\u00e1tico. \n\n? Defini\u00e7\u00e3o de uma fun\u00e7\u00e3o-objetivo. \n\n? Escolha de um algoritmo de minimiza\u00e7\u00e3o (otimiza\u00e7\u00e3o). \n\n \n3.4.1 Constru\u00e7\u00e3o de um Modelo Matem\u00e1tico \n\nUm modelo matem\u00e1tico descreve o comportamento do sistema f\u00edsico sob diferentes \n\ncondi\u00e7\u00f5es, com uma precis\u00e3o adequada. O problema de calcular a resposta do mo-\n\ndelo matem\u00e1tico a um conjunto de condi\u00e7\u00f5es que representam as caracter\u00edsticas de \n\nopera\u00e7\u00e3o do sistema \u00e9 referido como o problema para frente. \n\nAs seguintes leis fundamentais s\u00e3o relevantes para a din\u00e2mica do reservat\u00f3rio, e \n\ns\u00e3o usadas para a constru\u00e7\u00e3o do modelo matem\u00e1tico:  \n\n? Lei de conserva\u00e7\u00e3o de massa. \n\n? Lei de Darcy. \n\n? Equa\u00e7\u00f5es de Estado. \n\n \n  \n\n\n\n39 \n \n\n3.4.2 Defini\u00e7\u00e3o de uma Fun\u00e7\u00e3o-Objetivo \n\nA fun\u00e7\u00e3o-objetivo mede a discrep\u00e2ncia entre os dados observados e a resposta do \n\nsimulador para um determinado conjunto de par\u00e2metros. Existem tr\u00eas formas b\u00e1si-\n\ncas para definir a fun\u00e7\u00e3o-objetivo.  \n\n \n\na) Formula\u00e7\u00e3o por M\u00ednimos Quadrados \n\n? ? ? ?? ? ?\nT\n\nobs sim obs sim\nF d d d d\n\n                                                                                  (3.12) \n\nonde, \n\n? F  \u00e9 a fun\u00e7\u00e3o-objetivo. \n\n? obsd  \u00e9 um vetor formado pelos dados de produ\u00e7\u00e3o hist\u00f3rica. \n\n? simd  \u00e9 um vetor formado pelos dados de produ\u00e7\u00e3o simulada. \n\n \n\nb) Formula\u00e7\u00e3o por M\u00ednimos Quadrados Ponderada \n\n? ? ? ?? ? ?\nT\n\nobs sim obs sim\nF d d W d d                                                                               (3.13) \n\nOnde,  \n\n? W  \u00e9 uma matriz diagonal que atribui pesos individuais para cada uma das me-\n\ndi\u00e7\u00f5es. \n\n \n\nc) Formula\u00e7\u00e3o Generalizada dos M\u00ednimos Quadrados \n\n?\n?\n\n? ?\nobs previo\n\nF F F                                                                                                    (3.14) \n\nOnde,  \n\n? \nobs\n\nF  \u00e9 a soma ponderada dos quadrados das diferen\u00e7as entre os valores de \n\nprodu\u00e7\u00e3o simulados simd  e o hist\u00f3rico de dados de produ\u00e7\u00e3o \nobs\n\nd , conforme \n\nmostrado na Equa\u00e7\u00e3o 3.4. \n\n? ?\n?\n \u00e9 o fator de pondera\u00e7\u00e3o que expressa a import\u00e2ncia relativa no modelo ini-\n\ncial. \n\n? previoF  \n\u00e9 a fun\u00e7\u00e3o objetivo pr\u00e9vio definida na Equa\u00e7\u00e3o 3.5. \n\n\n\n40 \n \n\n? ?\n2\n\n1\n\n1\n\n2 ??\n\n?\n? ?\n\nobs\nsim obsn\ni i\n\nobs i\n\ni i\n\nd d\nF w                                                                                       (3.15) \n\nonde, na Equa\u00e7\u00e3o 3.4, temos que, \n\n? \nobs\n\nn  \u00e9 o n\u00famero de observa\u00e7\u00f5es (dados) \n\n? \ni\n\nw  \u00e9 um fator de pondera\u00e7\u00e3o, que pode ser usado equilibrar a magnitude dos \n\ncomponentes da fun\u00e7\u00e3o objetivo, que poder, por exemplo, ter unidades diferen-\n\ntes. \n\n? \ni\n\n?  \u00e9 o desvio padr\u00e3o do erro da medi\u00e7\u00e3o de thi  observa\u00e7\u00e3o. \n\n? \nsim\n\ni\nd  s\u00e3o os dados simulados pelo modelo matem\u00e1tico do reservat\u00f3rio. \n\n? \nobs\n\ni\nd  s\u00e3o os dados observados. \n\nO fator  \n\n? ? ? ?1?? ? ? ?\n?\n\n? ? ?\nT\n\nprevio previo previo\nF C                                                                         (3.16) \n\nOnde,  \n\n\u2022 ?  \u00e9 um vetor com os par\u00e2metros do reservat\u00f3rio ap\u00f3s a atualiza\u00e7\u00e3o. \n\n\u2022 previo?  \n\u00e9 um vetor com os par\u00e2metros do reservat\u00f3rio antes da atualiza\u00e7\u00e3o \n\n\u2022 C?  \u00e9 a matriz de covari\u00e2ncia dos estimadores dos par\u00e2metros do modelo ma-\n\ntem\u00e1tico. \n\n \n3.4.3 Limita\u00e7\u00f5es do Ajuste ao Hist\u00f3rico \n\nO melhor ajuste para os dados de produ\u00e7\u00e3o, em alguns casos, n\u00e3o fornece uma boa \n\nprevis\u00e3o para a produ\u00e7\u00e3o futura, que \u00e9 o objetivo principal do ajuste ao hist\u00f3rico. As \n\nvezes, um modelo com bem ajustado ao hist\u00f3rico de produ\u00e7\u00e3o produz previs\u00f5es \n\nruins, e vice-versa, um modelo pouco ajustado ao hist\u00f3rico pode levar a uma boa \n\nprevis\u00e3o (Tavassoli, et al. 2004). A experi\u00eancia da comunidade de engenheiros de \n\nreservat\u00f3rio registra que qualidade dos dados de entrada \u00e9 essencial para o ajuste \n\nao hist\u00f3rico. N\u00e3o existe ainda na engenharia de petr\u00f3leo uma teoria que indique pa-\n\nra um campo de petr\u00f3leo espec\u00edfico e um conjunto de dados de produ\u00e7\u00e3o se as pre-\n\nvis\u00f5es feitas ap\u00f3s um procedimento de ajuste ser\u00e3o aceit\u00e1veis ou n\u00e3o. Esta \u00e9 uma \n\n\u00e1rea muito interessante para pesquisa.  \n\n\n\n41 \n \n\n \n\nCAP\u00cdTULO 4 \n\n4. Assimila\u00e7\u00e3o de Dados com EnKF \n\n4.1 Introdu\u00e7\u00e3o  \n\nAssimila\u00e7\u00e3o de dados \u00e9 um processo no qual os par\u00e2metros do modelo e vari\u00e1veis \n\ndin\u00e2micas s\u00e3o atualizadas, mantendo consist\u00eancia com as observa\u00e7\u00f5es e as equa-\n\n\u00e7\u00f5es governantes. M\u00e9todos eficazes s\u00e3o necess\u00e1rios para atualizar continuamente \n\nos modelos din\u00e2micos atrav\u00e9s da assimila\u00e7\u00e3o de dados din\u00e2micos. O EnKF e suas \n\nvariantes fornecem uma alternativa eficiente, que \u00e9 explorada neste estudo para as-\n\nsimila\u00e7\u00e3o de dados din\u00e2micos. \n\nPara qualquer sistema din\u00e2mico, temos duas fontes de informa\u00e7\u00e3o: \n\n1. Medi\u00e7\u00f5es do sistema ou observa\u00e7\u00f5es. \n\n2. Compreens\u00e3o da evolu\u00e7\u00e3o temporal e espacial do sistema ou modelos. \n\nA Figura 4.1 mostra a rela\u00e7\u00e3o entre os participantes de um processo de assimila\u00e7\u00e3o \n\nde dados. \n\nFigura 4.1: Esquema de como assimila\u00e7\u00e3o de dados (DA) funciona e agrega valor \u00e0 observa\u00e7\u00e3o e \n\ninforma\u00e7\u00f5es do modelo. \n\n \n\n (Lahoz, 2010) \n\n\n\n42 \n \n\nCome\u00e7aremos com uma revis\u00e3o do filtro de Kalman. Em seguida, apresentaremos o \n\nFiltro de Kalman baseado em Ensembles (EnKF) e terminaremos este cap\u00edtulo com \n\nos detalhes pr\u00e1ticos da implementa\u00e7\u00e3o do EnKF. \n\n4.2 Revis\u00e3o do Filtro de Kalman \n\nO Filtro de Kalman (KF) foi desenvolvido em 1960 por Rudolf Emil Kalman, que pu-\n\nblicou o seu famoso artigo (Kalman, 1960) descrevendo uma solu\u00e7\u00e3o recursiva para \n\no problema da filtragem linear de dados discretos. Desde ent\u00e3o, devido aos grandes \n\navan\u00e7os da computa\u00e7\u00e3o digital, o KF tem sido uma ferramenta muito importante nas \n\n\u00e1reas da navega\u00e7\u00e3o, climatologia, oceanografia, astronomia, economia, etc. \n\nNa realidade o KF \u00e9 um algoritmo que atualiza a estimativa do estado sempre que as \n\nmedi\u00e7\u00f5es est\u00e3o dispon\u00edveis. Vamos supor que as medi\u00e7\u00f5es e que a previs\u00e3o do \n\nmodelo estejam sujeitas a erros, isto \u00e9, que sejam ruidosas. Vamos supor tamb\u00e9m \n\nque o ru\u00eddo seja seja Gaussiano, isto \u00e9, que seja uma vari\u00e1vel aleat\u00f3ria com fun\u00e7\u00e3o \n\ndensidade de probabilidade normal, e que nenhuma correla\u00e7\u00e3o esteja presente entre \n\nestes ru\u00eddos. Considere um fun\u00e7\u00e3o ? ?,x t? , definida em algum dom\u00ednio espacial de \n\ninteresse D  com coordenadas espaciais x . Quando esta fun\u00e7\u00e3o representa a res-\n\nposta de um modelo computacional de um fen\u00f4meno f\u00edsico que foi criado com um \n\nm\u00e9todo num\u00e9rico como o m\u00e9todo dos elementos finitos ou das diferen\u00e7as finitas, \n\nesta fun\u00e7\u00e3o \u00e9 aproximada por um conjunto finito de valores associados a pontos no \n\ndom\u00ednio espacial. O conjunto destes pontos associados \u00e0 informa\u00e7\u00f5es de vizinhan\u00e7a \n\nforma uma malha computacional para o m\u00e9todo num\u00e9rico. A fun\u00e7\u00e3o ? ?,x t?  pode \n\nent\u00e3o ser representada por um vetor de estado \nk\n\n?\n \nem cada instante de tempo \n\nk\nt . \n\nConsideremos tamb\u00e9m que novas medi\u00e7\u00f5es est\u00e3o dispon\u00edveis no instante \nk\n\nt . Defi-\n\nnimos a nova estimativa para o vetor de estado como \n\n? ?a f fk k k k k kK d M? ? ?? ? ? ,                                                                                       (4.1) \n\n(Evensen, 2007), em que \na\n\nk\n?  e \n\nf\n\nk\n?  s\u00e3o as estimativas analisadas e previs\u00e3o respec-\n\ntivamente, \nk\n\nd  \u00e9 o vetor de medi\u00e7\u00f5es, \nk\n\nM  \u00e9 a matriz que fornece a rela\u00e7\u00e3o entre as \n\nmedi\u00e7\u00f5es \nk\n\nd  e os estados do modelo \nk\n\n?  e \nk\n\nK  \u00e9 o fator de pondera\u00e7\u00e3o ou o ganho \n\nde Kalman.  \n\n\n\n43 \n \n\nA covari\u00e2ncia do estado analisado \u00e9 dada por \n\n? ? ? ? ? ?\n2\n\n1\na f\n\nk k\nk k\n\nC K M C? ??? ??                                                                                      (4.2) \n\nOnde ? ?\nf\n\nk\nC??  \u00e9 a covari\u00e2ncia de erro do estado do modelo previsto, e ? ?kC??  \u00e9 a ma-\n\ntriz de covari\u00e2ncia de erro de medi\u00e7\u00e3o. Um valor ideal para \nk\n\nK  pode ser encontrado \n\nescolhendo \nk\n\nK  de tal forma que a covari\u00e2ncia de \na\n\nk\n?\n\n \nseja minimizada. A solu\u00e7\u00e3o \n\ndeste problema de minimiza\u00e7\u00e3o \u00e9 dada por: (Evensen, 2007). \n\n? ? ? ? ? ?? ?\n1\n\nf f\nT T\n\nk k k k kk k\nK C M M C M C\n\n?\n\n? ??? ?? ??                                                                 (4.3) \n\ne a covari\u00e2ncia correspondente \u00e9 dada por:(Evensen, 2007). \n\n? ? ? ?? ?1? ?\na f\n\nk k\nk k\n\nC K M C?? ??                                                                                        (4.4) \n\n \n\n4.3 Filtro de Kalman \n\nSupomos que o verdadeiro estado \nt?\n \nevolui no tempo de acordo com o modelo di-\n\nn\u00e2mico linear \n\n1 1\n\nt t\n\nk k k\nF q\n\n? ?\n? ?? ?                                                                                                        (4.5) \n\nem que F  \u00e9 um operador linear e \n1k\n\nq\n?  \n\n\u00e9 o erro de modelo desconhecido sobre um \n\npasso de tempo de 1k ?  para k  e o sobrescrito t  \u00e9 a sigla para verdade. Neste caso, \n\no modelo evolui de acordo com, \n\n1\n\nf a\n\nk k\nF\n\n?\n?? ?                                                                                                               (4.6) \n\nonde os sobrescritos a  e f denotam an\u00e1lise e previs\u00e3o respectivamente. Ou seja, \n\ndada a melhor estimativa poss\u00edvel (an\u00e1lise) para ?\n \nno tempo \n\n1k\nt\n?\n\n, a previs\u00e3o \u00e9 cal-\n\nculada para o tempo \nk\n\nt , usando a equa\u00e7\u00e3o aproximada (4.6).  \n\nA equa\u00e7\u00e3o da covari\u00e2ncia do erro \u00e9 ent\u00e3o derivada das equa\u00e7\u00f5es (4.5) e (4.6). \n\n(Evensen, 2007). \n\n\n\n44 \n \n\n? ? ? ? ? ?\n1 1? ?\n\n? ?\nf a\n\nT\n\nk k k\nC F C F C?? ?? qq                                                                                (4.7) \n\nonde as matrizes de covari\u00e2ncia de erro para as estimativas previstas e analisados \n\ns\u00e3o definidos como \n\n? ?? ?\nT\n\nf f t f t\nC ? ? ??? ? ? ? ?                                                                                         (4.8) \n\n? ?? ?\nT\n\na a t a t\nC ? ? ??? ? ? ? ?                                                                                         (4.9) \n\nA linha continua sobre uma vari\u00e1vel est\u00e1 sendo empregada como o operador de ex-\n\npectativa. A Figura 4.2 descreve o princ\u00edpio de funcionamento de assimila\u00e7\u00e3o de da-\n\ndos pelo filtro de Kalman.  \n\nFigura 4.2: O filtro de Kalman discreto. \n\n \n\n (Fonte: Internet\n14\n\n) \n\n \n\n4.4 Filtro Kalman Baseado em Ensemble \n\nEnquanto o filtro de Kalman cl\u00e1ssico fornece uma solu\u00e7\u00e3o completa para a estima-\n\n\u00e7\u00e3o de estado de sistemas lineares com ru\u00eddo Gaussiano, a estima\u00e7\u00e3o de sistemas \n\nn\u00e3o lineares continua sendo um problema. Resultados rigorosos para problemas \n\nn\u00e3o-lineares t\u00eam pouca aplicabilidade ou s\u00e3o computacionalmente caros (S. Gillijns, \n\n                                                           \n14\n\n http://www.cimat.mx/~alram/VC/MSAA.htm \n\n\n\n45 \n \n\n2006). O Filtro de Kalman baseado em Ensembles \u00e9 uma abordagem de Monte Car-\n\nlo (Weisstein, 2012), para superar as limita\u00e7\u00f5es filtro de Kalman mencionadas acima. \n\n \n\n4.4.1 Representa\u00e7\u00e3o das estat\u00edsticas de erro \n\nAs matrizes de covari\u00e2ncia de erros fC??  \ne aC??  para as estimativas prevista e anali-\n\nsada no filtro de Kalman s\u00e3o definidos em termos do estado verdadeiro em (4.8) e \n\n(4.9). No entanto, j\u00e1 que o estado verdadeiro nunca \u00e9 conhecido, no EnKF utilizamos \n\num conjunto de modelos distintos para o mesmo sistema f\u00edsico, o ensemble, que s\u00e3o \n\najustados e avan\u00e7ados no tempo simultaneamente. Aproximamos as matrizes de \n\ncovari\u00e2ncia do modelo em termos da m\u00e9dia do ensemble ?\n \nao inv\u00e9s de usarmos o \n\nestado verdadeiro, de acordo com, \n\n? ? ? ?? ?\nTf\n\ne f f f f\nC ? ? ??? ? ? ? ?                                                                                (4.10) \n\n? ? ? ?? ?\nTa\n\ne a a a a\nC ? ? ??? ? ? ? ?                                                                                  (4.11) \n\nonde a sobrelinha denota o operador de expectativa. Assim, podemos usar uma in-\n\nterpreta\u00e7\u00e3o onde o ensemble m\u00e9dio \u00e9 a melhor estimativa e a dispers\u00e3o do ensem-\n\nble em torno da m\u00e9dia \u00e9 uma defini\u00e7\u00e3o natural do erro associado ao ensemble m\u00e9-\n\ndio. \n\n \n\n4.5 An\u00e1lise do Esquema \n\nO EnKF depende do ensemble inicial do modelo de reservat\u00f3rio condicionado a to-\n\ndos os dados est\u00e1ticos dispon\u00edveis at\u00e9 o momento da assimila\u00e7\u00e3o. Os modelos de \n\nreservat\u00f3rios que formam os ensembles s\u00e3o geralmente criados usando t\u00e9cnicas de \n\ninterpola\u00e7\u00e3o geoestat\u00edstica como Simula\u00e7\u00e3o Sequencial Gaussiana, (Deutsche e \n\nJournel, 1998). O ensemble pode ser descrito como um conjunto de amostras alea-\n\nt\u00f3rias de uma fun\u00e7\u00e3o de distribui\u00e7\u00e3o de probabilidade Gaussiana previa multidimen-\n\nsional, com uma m\u00e9dia e vari\u00e2ncia especificadas, que refletem a incerteza nessas \n\nestimativas iniciais. O processo de assimila\u00e7\u00e3o de dados tenta melhorar as estimati-\n\nvas iniciais destas vari\u00e1veis do modelo, que podem incluir a distribui\u00e7\u00e3o espacial da \n\npermeabilidade, porosidade, satura\u00e7\u00e3o de fluidos, etc. Os modelos atualizados com-\n\n\n\n46 \n \n\npreendem amostras de uma pdf posterior que s\u00e3o consistentes com todos os dados \n\nest\u00e1ticos previamente adquiridos e observa\u00e7\u00f5es.  \n\nO EnKF para o modelo de atualiza\u00e7\u00e3o cont\u00ednua propaga um ensemble de realiza-\n\n\u00e7\u00f5es iniciais do reservat\u00f3rio ao longo do tempo para assimilar dados. O ensemble de \n\nvetores \u00e9 denotado por: \n\n1 2\n, , ,\n\neN\nA ? ??\n\n? ?\n? ? ?                                                                                                 (4.12) \n\nonde \ne\n\nN  \u00e9 o n\u00famero total de membros do ensemble e ; 1j ej N??  \ns\u00e3o vetores de \n\nestado. Cada vetor de estado consiste em par\u00e2metros do modelo ( )m , tais como \n\nporosidade e permeabilidade, vari\u00e1veis de estado ( )u , como press\u00e3o e satura\u00e7\u00e3o, \n\nque s\u00e3o vari\u00e1veis dependentes do tempo e observa\u00e7\u00f5es ( )d , como a taxa de produ-\n\n\u00e7\u00e3o de fluido do reservat\u00f3rio e o corte de \u00e1gua (WCT). Em um certo passo de tempo \n\nk\nt , 1\n\nt\nk N? ; o vetor de estado para o modelo de simula\u00e7\u00e3o do reservat\u00f3rio \u00e9 re-\n\npresentado como, \n\nk\n\nk k\n\nk\n\nm\n\nu\n\nd\n\n? ?\n? ?\n\n?\n? ?\n? ?? ?\n\n?                                                                                                               (4.13) \n\nonde k  indica o passo de tempo em que os dados s\u00e3o assimilados. \n\nA ideia principal do EnKF para assimila\u00e7\u00e3o de dados cont\u00e9m duas etapas sequen-\n\nciais. Uma delas \u00e9 a etapa de previs\u00e3o, em que o modelo de previs\u00e3o \u00e9 aplicado a \n\ncada membro do ensemble separadamente usando um simulador de reservat\u00f3rio \n\ncom base na solu\u00e7\u00e3o das equa\u00e7\u00f5es din\u00e2micas de fluxo e transporte de fluidos no \n\nmeio poroso, \n\n? ?, 1, 1\nf a\n\nk j k j k\nF q\n\n? ?\n? ?? ?                                                                                               (4.14) \n\nonde, ? ?F  \u00e9 o operador previs\u00e3o, que \u00e9 representado pelo simulador de reservat\u00f3-\n\nrio e \n1k\n\nq\n?\n\n representa o erro de modelo. Os sobrescritos f  e a  denotam os estados \n\nprevistos e analisados, respectivamente. Nesta etapa do modelo as propriedades da \n\nrocha s\u00e3o inalteradas, mas \u00e9 substitu\u00edda a press\u00e3o, satura\u00e7\u00e3o e dados simulados no \n\nvetor de estado previsto. O passo de previs\u00e3o \u00e9 muitas vezes o passo mais exigente \n\n\n\n47 \n \n\ncomputacionalmente, para grandes modelos de reservat\u00f3rios e grandes tamanhos \n\ndo ensemble. \n\nA outra \u00e9 a etapa de an\u00e1lise, no qual a atualiza\u00e7\u00e3o do modelo \u00e9 feita corrigindo as \n\nvari\u00e1veis que representam o estado do sistema para honrar as observa\u00e7\u00f5es. O es-\n\nquema de atualiza\u00e7\u00e3o no KF usando as covari\u00e2ncias do ensemble \u00e9 definido em \n\n(4.10) e (4.11). \u00c9 essencial que as observa\u00e7\u00f5es possam ser tratadas como vari\u00e1veis \n\naleat\u00f3rias tendo uma distribui\u00e7\u00e3o com m\u00e9dia igual ao valor observado e covari\u00e2ncia \n\nigual a C??  (Burgers, et al. 1998). Come\u00e7amos por definir um ensemble de observa-\n\n\u00e7\u00f5es \n\n,\n, 1\n\nj obs j j\nd d j N? ? ??                                                                                           (4.15) \n\nonde N  \u00e9 o n\u00famero de membros do ensemble. Em seguida, a matriz de covari\u00e2ncia \n\ndo ensemble dos erros de medi\u00e7\u00e3o \u00e9 definida como, \n\n?\ne T\n\nC?? ??                                                                                                                 (4.16) \n\nEsta matriz converge para o erro atual da matriz covari\u00e2ncia C??  usado no filtro de \n\nKalman, quando temos um n\u00famero infinito de realiza\u00e7\u00f5es e o sobescrito e  indica \n\nque a matriz corresponde aos erros calculados para o ensemble.  \n\nNo passo de an\u00e1lise do EnKF, atualiza\u00e7\u00f5es s\u00e3o realizadas em cada um dos mem-\n\nbros do ensemble, dadas por \n\n? ? ? ?? ? ? ?\n1\n\nf f\na f e T e T e f\n\nj j j j\nC M M C M C d M\n\n?\n\n? ? ? ??? ?? ??? ? ?                                          (4.17) \n\nOnde 0M I? ? ?? ?  \n\u00e9 o operador de observa\u00e7\u00e3o, que extrai os dados simulados a partir \n\ndo vetor de estado \nf\n\nj\n? . Al\u00e9m disto, 0  \u00e9 uma matriz ? ?d m uN N N? ? , com todos os \n\nelementos nulos e I  \u00e9 a matriz identidade de \nd d\n\nN N? . \n\nDevemos notar que com um tamanho finito do ensemble, o uso das covari\u00e2ncias do \n\nensemble \u00e9 uma aproxima\u00e7\u00e3o das verdadeiras covari\u00e2ncias. Al\u00e9m disso, as matrizes \n\n? ?\nf\n\ne T\nM C M??  e \n\ne\nC??  s\u00e3o singulares quando o n\u00famero de medi\u00e7\u00f5es \u00e9 maior do que o \n\n\n\n48 \n \n\nn\u00famero de membros do ensemble (Evensen, 2007), e devemos usar pseudoinver-\n\ns\u00e3o em vez de invers\u00e3o para avaliar (4.17).  \n\nA equa\u00e7\u00e3o (4.17), implica que, \n\n? ? ? ?? ? ? ?\n1\n\nf f\na f e T e T e f\n\nC M M C M C d M\n?\n\n? ? ? ??? ?? ??? ? ?                                            (4.18) \n\nem que d d? , uma vez que temos um ensemble de m\u00e9dia zero das perturba\u00e7\u00f5es de \n\nmedi\u00e7\u00e3o. Assim, temos a mesma rela\u00e7\u00e3o entre o ensemble m\u00e9dio analisado e pre-\n\nvisto, como temos entre o estado analisado e previsto no filtro de Kalman padr\u00e3o, \n\nal\u00e9m de utilizar ? ?\n,f a\n\ne\nC??  e \n\ne\nC??  em vez de \n\n,f a\nC??  e C??  respectivamente. Devemos \n\ntamb\u00e9m observar que a introdu\u00e7\u00e3o de um ensemble de observa\u00e7\u00f5es n\u00e3o afeta a \n\natualiza\u00e7\u00e3o do ensemble m\u00e9dio.  \n\nVamos agora mostrar que, atualizando cada um dos membros do ensemble usando \n\nas observa\u00e7\u00f5es perturbadas, podemos criar um novo ensemble com as estat\u00edsticas \n\nde erro corretas. Obtivemos a estimativa da covari\u00e2ncia de erro analisada como re-\n\nsultado do esquema de an\u00e1lise acima, apesar de manter a forma padr\u00e3o do filtro de \n\nKalman para as equa\u00e7\u00f5es de estado. Primeiro, obtemos usando (4.17) e (4.18). \n\n? ?? ? ? ?a a f fj e j e jI K M K d d? ? ? ? ? ?? ? ? ? ,                                                           (4.19) \n\nonde o ganho de Kalman \u00e9, (Evensen, 2007) \n\n? ? ? ?? ?\n1\n\nf f\ne T e T e\n\ne\nK C M M C M C\n\n?\n\n? ??? ?? ??                                                                    (4.20) \n\nUsando a equa\u00e7\u00e3o (4.11), obtemos a atualiza\u00e7\u00e3o do erro da covari\u00e2ncia como, \n\n? ? ? ?? ?\na f\n\ne e\n\ne\nC I K M C? ??? ??                                                                                       (4.21) \n\nAgora, consideramos que as incertezas do modelo e as incertezas das medi\u00e7\u00f5es \n\ns\u00e3o independentes. No entanto, usando um ensemble de tamanho finito e negligen-\n\nciando o termo cruzado introduzem-se erros de amostragem.  \n\nQuando a matriz de ganho de Kalman \u00e9 singular, a invers\u00e3o em (4.20) pode ser \n\nsubstitu\u00edda pela pseudo invers\u00e3o, e pode-se escrever o ganho de Kalman como: \n\n\n\n49 \n \n\n? ? ? ?? ?\n?\n\n? ?\nf f\n\ne T e T e\n\ne\nK C M M C M C?? ?? ??                                                                      (4.22) \n\nQuando a matriz na invers\u00e3o tem posto completo, (4.22) torna-se id\u00eantico a (4.20) \n\n(Evensen, 2007). A Figura 4.3 mostra o princ\u00edpio de funcionamento do EnKF para \n\num membro do ensemble.  \n\nFigura 4.3: Assimila\u00e7\u00e3o de dados com EnKF para o membro j  do ensemble. \n\n. \n\n \n\n(Khairullah, 2012) \n\n \n \n\n4.6 Implementa\u00e7\u00e3o Pr\u00e1tica  \n\n4.6.1 Representa\u00e7\u00e3o do Ensemble da Covari\u00e2ncia  \n\nDefinimos a matriz A  cujas colunas s\u00e3o os membros do ensemble \nn\n\ni\n??  (Even-\n\nsen, 2007) por, \n\n? ?1 2, , ,\nn N\n\nN\nA\n\n?\n? ?? ? ?                                                                                        (4.23) \n\nonde N  \u00e9 o n\u00famero de realiza\u00e7\u00f5es e n  \u00e9 o tamanho do vetor de estado do modelo. \n\nO ensemble m\u00e9dio \u00e9 armazenado em cada coluna de A , que \u00e9 definida como: \n\n1\nN\n\nA A? ,                                                                                                                (4.24) \n\nem que 1\nN N\n\nN\n\n?\n?  \u00e9 uma matriz cujas entradas s\u00e3o todas iguais 1 N . A matriz de \n\nperturba\u00e7\u00e3o do ensemble \u00e9 definida como \n\n\n\n50 \n \n\n? ?1NA A A A I? ? ? ? ?                                                                                             (4.25) \n\nA matriz de covari\u00e2ncia do ensemble e n nC ????  pode ser definida como \n\n? ?\n1\n\n1\n\nTe\nC A A\n\nN\n? ??\n\n?\n??\n\n                                                                                                (4.26) \n\n \n\n4.6.2 Perturba\u00e7\u00f5es das Medi\u00e7\u00f5es \n\nDado um vetor de medi\u00e7\u00f5es de \nm\n\nd ? , onde m  \u00e9 o n\u00famero de medi\u00e7\u00f5es, que defi-\n\nnem os N  vetores perturbados das observa\u00e7\u00f5es (Evensen, 2007) como; \n\n, 1\nj j\n\nd d j N? ? ??                                                                                               (4.27) \n\nque est\u00e3o armazenados nas colunas da matriz \n\n? ?1 2, , ,\nm N\n\nN\nD d d d\n\n?\n? ?                                                                                        (4.28) \n\nenquanto que o ensemble m\u00e9dio das perturba\u00e7\u00f5es s\u00e3o armazenados na matriz \n\n? ?1 2, , ,\nm N\n\nN\nE\n\n?\n? ?? ? ?                                                                                          (4.29) \n\na partir do qual constru\u00edmos a representa\u00e7\u00e3o da matriz de covari\u00e2ncia de erro de \n\nmedi\u00e7\u00e3o do ensemble \n\n1\n\n1\n\ne T\nC EE\n\nN\n?\n\n?\n??\n\n                                                                                                       (4.30) \n\n \n\n4.6.3 Equa\u00e7\u00e3o de An\u00e1lise \n\nA equa\u00e7\u00e3o de an\u00e1lise (4.17), expressada em termos de matrizes do ensemble \n\n(Evensen, 2007), \u00e9, \n\n? ? ? ?\n1\n\na e T e T e\nA A C M MC M C D MA\n\n?\n\n? ? ? ??? ?? ??                                                            (4.31) \n\nem que a matriz de medi\u00e7\u00e3o \u00e9 \nm n\n\nM\n?\n\n? .  \n\nDefinimos o conjunto de vetores de inova\u00e7\u00e3o, \n\n\n\n51 \n \n\nD D MA? ? ?                                                                                                           (4.32) \n\nem que \n???\n\nm N\nD . Usando D? , juntamente com as defini\u00e7\u00f5es das matrizes de cova-\n\nri\u00e2ncia de erro do ensemble em (4.26) e (4.30), a matriz de perturba\u00e7\u00e3o pode ser \n\nexpressa como, \n\n? ?\n1\n\na T T T T T\nA A A A M MA A M EE D\n\n?\n\n? ? ? ? ?? ? ?                                                               (4.33) \n\nVamos agora definir a matriz \nm N\n\nS\n?\n\n? , mantendo as medi\u00e7\u00f5es das perturba\u00e7\u00f5es do \n\nconjunto, por, \n\nS MA??                                                                                                                  (4.34) \n\nE a matriz \nm m\n\nC\n?\n\n? , \n\n? ?1TC SS N C? ? ? ?? .                                                                                              (4.35) \n\nAqui podemos usar a matriz de covari\u00e2ncia do erro das medi\u00e7\u00f5es exata C??  ou a re-\n\npresenta\u00e7\u00e3o de posto reduzido \ne\n\nC??  definida em (4.30).  \n\nA equa\u00e7\u00e3o de an\u00e1lise (4.33) pode ent\u00e3o ser escrita como, \n\n? ?\n\n? ?? ?\n\n1 1\n\n1\n\n1\n\n1\n\na T T\n\nN\n\nT\n\nN\n\nA A A S C D A A I S C D\n\nA I I S C D AX\n\n? ?\n\n?\n\n? ? ?? ? ? ? ?\n\n?? ? ? ?\n                                                             (4.36) \n\nem que usamos a identidade em (4.25). A matriz \nN N\n\nX\n?\n\n?  \u00e9 definida como, \n\n? ? 11 TNX I I S C D\n? ?? ? ?                                                                                           (4.37) \n\nCom base no pressuposto de que 1 0\nT\n\nN\nS ? , (4.36) pode ser escrita como, \n\n? ?1a TA A I S C D AX? ?? ? ?                                                                                       (4.38) \n\nEm seguida, (4.37) se torna \n\n1T\nX I S C D\n\n? ?? ?                                                                                                      (4.39) \n\nQuando o n\u00famero de medi\u00e7\u00f5es \u00e9 maior do que o n\u00famero de membros das realiza-\n\n\u00e7\u00f5es, a matriz C  \u00e9 singular e em vez de usar inversa devemos usar a pseudo-\n\n\n\n52 \n \n\ninversa de C  nas express\u00f5es acima. Uma forma popular para calcular a pseudo-\n\ninversa de uma matriz C  \u00e9 usando a decomposi\u00e7\u00e3o em valores singulares (SVD) \n\nusando a seguinte formula\u00e7\u00e3o (Evensen, 2007). \n\nT\nC VS U\n\n? ?\n?                                                                                                            (4.40) \n\nem que U  e V  s\u00e3o as matrizes singulares \u00e0 esquerda e \u00e0 direita de C , respectiva-\n\nmente, S  \u00e9 uma matriz diagonal contendo os valores singulares de C , em ordem \n\ndecrescente, e S\n?\n\n\u00e9 definido como \n\n1\n, se e 0\n\n0, caso contr\u00e1rio\n\nij\n\nij\n\ni j S\nSS\n\n?\n\n?\n? ??\n\n? ?\n?\n?\n\n                                                                             (4.41) \n\nA outra maneira de escrever (4.35) \u00e9 \n\nT T\nC SS EE? ?                                                                                                        (4.42) \n\n? ?? ?\nT\n\nC S E S E? ? ?                                                                                                 (4.43) \n\nAssumindo que as perturba\u00e7\u00f5es do conjunto e as perturba\u00e7\u00f5es de medi\u00e7\u00e3o s\u00e3o cor-\n\nrelacionadas, que \u00e9 equivalente a \n\n0\nT T\n\nSE MA E?? ?                                                                                                    (4.44) \n\nCalcula-se o SVD \n\nT\nS E U V? ? ? ,                                                                                                      (4.45) \n\nem seguida (4.33) se torna \n\n1a T T\nA A A S U U D\n\n?? ?? ? ? ,                                                                                       (4.46) \n\nem que \n\nT\n? ? ??                                                                                                                  (4.47) \n\nEsta \u00e9 outra abordagem de c\u00e1lculo da matriz de perturba\u00e7\u00e3o, evitando a invers\u00e3o de \n\numa matriz grande quando m N , baseada nas suposi\u00e7\u00f5es acima mencionadas. \n\n\n\n53 \n \n\nExistem duas principais fontes de erros de amostragem no EnKF: o uso de um en-\n\nsemble finito de realiza\u00e7\u00f5es de modelos estoc\u00e1sticos e a introdu\u00e7\u00e3o de perturba\u00e7\u00f5es \n\nna (Evensen, 2004, 2007). \n\nNa Figura 4.4 se mostra um algoritmo base para o Filtro de Kalman baseado em en-\n\nsemble. \n\n \n\nFigura 4.4: Algoritmo B\u00e1sico do EnKf. \n\n1 2\n\n0,\n\n1\n\nEntrada : , ,\n\n, , , Gerar Ensemble inicial dos par\u00e2metros do modelo\n\nO n\u00famero de estados iniciais do sistema, de acordo com o n\u00famero de realiza\u00e7\u00f5es\n\n1:\n\nPasso em Frente\n\nCalc\n\ne\n\ne\n\nobs\n\nN\n\nj\n\nk\n\nk\n\nQ C d\n\nA\n\nfor k t\n\nq\n?\n\n? ?? ?\n? ?\n\n?\n\n?\n\n?\n\n??\n\n? ? ?\n\n?\n\n? ?\n\n? ? ? ?? ?? ?\n, 1, 1\n\n1\n\n,\n\n, , ,\n\nule modelo de ru\u00eddo com (0, )\n\n% Passo em Frente\n\n1\n% C\u00e1lculo da covari\u00e2ncia\n\n1\n\nPasso de atualiza\u00e7\u00e3o \n\nCalcule ru\u00eddo de medi\u00e7\u00e3o com (0, )\n\n%\n\ne\n\nf a\n\nk j k j k\n\nN Tf\ne f f f f\n\nj j\n\nje\n\nd e\n\nk j\n\nd\n\nk j obs j k j\n\nN Q\n\nF q\n\nC\nN\n\nN C\n\nd d\n\n? ?\n\n?\n\n? ?\n\n? ? ?\n?\n\n?\n\n? ?\n\n???\n\n??\n\n? ?\n\n? ? ? ?\n\n?\n\n?\n\n? ? ? ?? ?\n? ?\n\n? ? ? ?? ?\n\n1\n\n, , ,\n\nMedi\u00e7\u00f5es perturbadas\n\n% C\u00e1lculo de ganho de Kalman \n\n% Par\u00e2metros do modelo de atualiza\u00e7\u00e3o \n\n% Atualiza\u00e7\u00e3o da covari\u00e2ncia do erro \n\n1 % Pr\u00f3ximo p\n\nf f\ne T e T e\n\ne\n\na f f\n\nk j k j e j k j\n\na f\ne e\n\ne\n\nK C M M C M C\n\nK d M\n\nC I K M C\n\nk k\n\n?\n\n? ?\n\n? ? ?\n\n? ?\n\n? ?\n\n?? ?? ??\n\n?? ??\n\n? ? ?\n\nasso\n\nend \n\n \n\n(Fonte: Autor) \n\n \n\n  \n\n\n\n54 \n \n\nCAP\u00cdTULO 5 \n\n5. Software e Metodologia  \n\n5.1 Introdu\u00e7\u00e3o  \n\nAtualmente, v\u00e1rios programas de computador s\u00e3o usados dentro dos processos de \n\ngerenciamento e engenharia de reservat\u00f3rios. Simuladores de reservat\u00f3rios, pro-\n\ngramas para interpreta\u00e7\u00e3o s\u00edsmica e cria\u00e7\u00e3o de modelos, assim como software de \n\nvisualiza\u00e7\u00e3o 3D s\u00e3o exemplos t\u00edpicos. Estes programas s\u00e3o usados para modelar, \n\ncompreender melhor e fazer previs\u00f5es sobre o comportamento dos reservat\u00f3rios. \n\nUma melhor compreens\u00e3o do reservat\u00f3rio possibilita previs\u00f5es mais precisas, maio-\n\nres oportunidades para aumentar a recupera\u00e7\u00e3o de petr\u00f3leo, maior retorno de inves-\n\ntimento e maior tempo de vida de um campo e um maior lucro.  \n\nNo mercado atual encontramos muitos simuladores de reservat\u00f3rios que modelam \n\nescoamentos em meios porosos considerando alta complexidade geol\u00f3gica, trajet\u00f3-\n\nrias complexas dos po\u00e7os, m\u00e9todos avan\u00e7ados de recupera\u00e7\u00e3o, recupera\u00e7\u00e3o de \n\n\u00f3leo pesado e reservat\u00f3rios n\u00e3o convencionais. H\u00e1 simuladores comerciais (Eclipse, \n\nImex, Petrel, etc) e simuladores com distribui\u00e7\u00e3o livre, livres (BOAST, WinB4D, \n\nMRST, etc), que tem sido utilizados para simular estrat\u00e9gias complexas de produ-\n\n\u00e7\u00e3o. Um n\u00famero grande de fatores leva a simula\u00e7\u00e3o da produ\u00e7\u00e3o a obter resultados \n\nprecisos no menor tempo poss\u00edvel. \n\nNesta disserta\u00e7\u00e3o foi usado como plataforma de desenvolvimento o Matlab Reser-\n\nvoir Simulation Toolbox (MRST), que \u00e9 um simulador com distribui\u00e7\u00e3o livre. O simu-\n\nlador \u00e9 desenvolvido pela SINTEF e pode ser obtido a partir de \n\nhttp://www.sintef.no/Projectweb/MRST/. Neste cap\u00edtulo ser\u00e1 mostrado o ajuste ao \n\nhist\u00f3rico usando o EnKF acoplado ao simulador de reservat\u00f3rios MRST. \n\nA Figura 5.1 mostra um processo completo e integrado para o gerenciamento de um \n\ncampo de petr\u00f3leo. Esta disserta\u00e7\u00e3o se concentra na etapa da simula\u00e7\u00e3o de reser-\n\nvat\u00f3rios, tentando melhorar seus modelos com a assimila\u00e7\u00e3o de dados de produ\u00e7\u00e3o. \n\n \n\n \n\n \n\nhttp://www.sintef.no/Projectweb/MRST/\n\n\n55 \n \n\nFigura 5.1: Simula\u00e7\u00e3o da Produ\u00e7\u00e3o em Reservat\u00f3rios. \n\n \n\n (Adaptado de Schlumberger e Chevron, 2012) \n\n \n\nUm engenheiro de reservat\u00f3rio usa dados est\u00e1ticos e din\u00e2micos (canto inferior direi-\n\nto, Fig. 5.1) e desenvolve um modelo para um simulador de reservat\u00f3rio (canto infe-\n\nrior esquerda, Fig. 5.1). O simulador de reservat\u00f3rios, cuja principal tarefa \u00e9 o de \n\nmodelar o escoamento multif\u00e1sico em meios porosos, produz perfis de produ\u00e7\u00e3o \n\ncalculados em fun\u00e7\u00e3o do tempo de opera\u00e7\u00e3o do campo para os po\u00e7os do reservat\u00f3-\n\nrio. Estes dados s\u00e3o transferidos ao engenheiro de produ\u00e7\u00e3o para desenvolver mo-\n\ndelos de eleva\u00e7\u00e3o, que tratam o escoamento multif\u00e1sico dentro das tubula\u00e7\u00f5es que \n\nlevam o petr\u00f3leo do reservat\u00f3rio at\u00e9 a superf\u00edcie, e para alimentarem os simuladores \n\nde rede de superf\u00edcie (canto superior esquerdo, Fig. 5.1). Um engenheiro de instala-\n\n\u00e7\u00f5es de superf\u00edcie utiliza os dados de produ\u00e7\u00e3o e composi\u00e7\u00e3o do \u00f3leo produzido \n\npara construir um modelo de planta de processo com a ajuda de um simulador de \n\nprocessos (canto superior direito, Fig. 5.1). Finalmente, os dados de todos os simu-\n\nladores, de reservat\u00f3rios, eleva\u00e7\u00e3o e processos, s\u00e3o usados para alimentar um si-\n\nmulador econ\u00f4mico (\u00e0 direita, Fig. 5.1). Este procedimento leva ao planejamento da \n\nprodu\u00e7\u00e3o para obter os melhores resultados econ\u00f4micos dentro das limita\u00e7\u00f5es ope-\n\nracionais e econ\u00f4micas do campo (Schlumberger e Chevron, 2012). \n\n \n \n \n \n \n \n \n \n\n\n\n56 \n \n\n5.2 Matlab Reservoir Simulation Toolbox (MRST) \n\nO MRST \u00e9 um programa de c\u00f3digo aberto desenvolvido em conjunto com a iniciativa \n\nOpen Porous Media (OPM) do SINTEF, um Instituto de Matem\u00e1tica Aplicada locali-\n\nzado em Oslo. O objetivo da MRST \u00e9 de funcionar como uma plataforma de testes \n\neficiente para novas implementa\u00e7\u00f5es de t\u00e9cnicas de discretiza\u00e7\u00e3o, formula\u00e7\u00f5es nu-\n\nm\u00e9ricas e m\u00e9todos de solu\u00e7\u00e3o de sistemas de equa\u00e7\u00f5es lineares e n\u00e3o lineares em \n\naplica\u00e7\u00f5es de simula\u00e7\u00e3o de reservat\u00f3rio. Ele cont\u00e9m m\u00f3dulos para gera\u00e7\u00e3o de ma-\n\nlhas, um conjunto completo de fun\u00e7\u00f5es e rotinas para manipula\u00e7\u00e3o de par\u00e2metros \n\nde fluidos, po\u00e7os e condi\u00e7\u00f5es de contorno, ferramentas de p\u00f3s-processamento e \n\nvisualiza\u00e7\u00e3o em 2D e 3D, al\u00e9m de uma s\u00e9rie de m\u00f3dulos para os m\u00e9todos de solu-\n\n\u00e7\u00e3o num\u00e9rica e otimiza\u00e7\u00e3o. \n\nO MRST foi lan\u00e7ado sob a licen\u00e7a GNU General Public License (GPL). As equa\u00e7\u00f5es \n\ngovernantes do escoamento em meios porosos s\u00e3o avaliadas utilizando o m\u00e9todo \n\ndos volumes finitos e o sistema de equa\u00e7\u00f5es equa\u00e7\u00f5es alg\u00e9bricas, resultante da dis-\n\ncretiza\u00e7\u00e3o das equa\u00e7\u00f5es diferencias parciais que modelam o escoamento \u00e9 resolvi-\n\ndo de forma totalmente impl\u00edcita usando o m\u00e9todo de Newton-Raphson a cada pas-\n\nso de tempo de integra\u00e7\u00e3o. Em uma t\u00e9cnica impl\u00edcita, os valores das vari\u00e1veis em \n\ntodas as c\u00e9lulas do dom\u00ednio computacional, em um instante de tempo, s\u00e3o fun\u00e7\u00f5es \n\ndos valores destas vari\u00e1veis em outras c\u00e9lulas do dom\u00ednio no mesmo instante de \n\ntempo, o que requer a solu\u00e7\u00e3o de um sistema de equa\u00e7\u00f5es alg\u00e9bricas para a deter-\n\nmina\u00e7\u00e3o de seus valores. Em contraste, em uma t\u00e9cnica expl\u00edcita, os valores nas \n\nc\u00e9lulas dependem apenas de valores calculados em instantes de tempo anteriores, \n\nde forma que cada c\u00e9lula pode ser atualizada independentemente, sem a necessi-\n\ndade da solu\u00e7\u00e3o de um sistema de equa\u00e7\u00f5es alg\u00e9bricas. \n\nNa Figura 5.2, mostramos os exemplos de m\u00f3dulos que s\u00e3o fornecidos pelo MRST. \n\n \n\n\n\n57 \n \n\nFigura 5.2: Exemplos de M\u00f3dulos MRST.\n\n \n\n (Adaptado: http://www.sintef.no/Projectweb/MRST/) \n\n \nEm raz\u00e3o de o MRST ser um programa cujo c\u00f3digo fonte est\u00e1 publica e livremente \n\ndispon\u00edvel, nesta disserta\u00e7\u00e3o o autor usou uma rotina existente do EnKF para MRST \n\n2013a, que foi fornecida por Olwijn Leeuwenburgh\n15\n\n (TNO), al\u00e9m disso, o autor mo-\n\ndificou v\u00e1rios arquivos do c\u00f3digo fonte fornecido, para gerar os c\u00e1lculos de produ\u00e7\u00e3o \n\ndo \u00f3leo, gera\u00e7\u00e3o de malhas e gr\u00e1ficos como os de produ\u00e7\u00e3o acumulada e instant\u00e2-\n\nnea, permeabilidades, porosidade, satura\u00e7\u00e3o e press\u00e3o, que n\u00e3o eram fornecidos no \n\nc\u00f3digo fonte original, ap\u00f3s realizar ajustes ao hist\u00f3rico de produ\u00e7\u00e3o.  \n\n \n\n5.3 M\u00e9todos de Amostragem \n\nO planejamento de experimentos \u00e9 uma t\u00e9cnica importante da estat\u00edstica que \u00e9 usa-\n\nda nas ci\u00eancias experimentais para que experimentos com m\u00faltiplos fatores possam \n\nser realizados com um n\u00famero razo\u00e1vel de amostras, o que seria invi\u00e1vel com, por \n\nexemplo, um planejamento fatorial completo (Montgomery e Douglas, 2012). H\u00e1 uma \n\ndiferen\u00e7a fundamental entre o planejamento para experimentos f\u00edsicos e experimen-\n\ntos computacionais, visto que os primeiros s\u00e3o sujeitos a erros de medi\u00e7\u00e3o enquanto \n\nque os experimentos computacionais, salvo interesse particular, s\u00e3o determin\u00edsticos. \n\nDesta forma, normalmente n\u00e3o se amostra v\u00e1rias vezes o mesmo ponto no planeja-\n\nmento de experimentos computacionais. V\u00e1rias metodologias est\u00e3o dispon\u00edveis para \n\ngera\u00e7\u00e3o dos valores dos fatores que comp\u00f5em um ponto amostral, tais como Quasi-\n\nMonte Carlo (QMC), Hipercubo latino (LHS - Latin Hypercube Sampling) e m\u00e9todo \n\n                                                           \n15\n\n Engenheiro de Reservat\u00f3rio - Pesquisador da TNO. \n\n\n\n58 \n \n\nda tessela\u00e7\u00e3o de Voronoi (CVT - Centroidal Voronoi Tesselation), (Giunta, 2002; \n\nGiunta et al, 2003). Todas as t\u00e9cnicas tentam gerar boa cobertura do espa\u00e7o amos-\n\ntral e uma distribui\u00e7\u00e3o espacial que se aproxime da uniforme, com um n\u00famero razo-\n\n\u00e1vel de amostras, particularmente quando o n\u00famero de fatores \u00e9 muito grande. Nes-\n\nte trabalhos as t\u00e9cnicas para gera\u00e7\u00e3o dos pontos amostrais ser\u00e3o chamadas de \n\nDOE, do ingl\u00eas Design of Experiments. Neste trabalho foi utilizada como t\u00e9cnica de \n\nDOE o Hipercubo Latino (LHS), mas faremos uma breve defini\u00e7\u00e3o de algumas alter-\n\nnativas. \n\nA caracter\u00edstica principal do DOE aplicado em experimentos computacionais deter-\n\nmin\u00edsticos \u00e9 que n\u00e3o existe erro aleat\u00f3rio, ou seja, se uma simula\u00e7\u00e3o computacional \n\n\u00e9 executada duas vezes teremos a gera\u00e7\u00e3o do mesmo conjunto de amostras.  \n\nConsideraremos como exemplo um experimento computacional com apenas dois \n\nfatores, cujos valores variam entre 0 e 1, por simplicidade. Uma t\u00e9cnica cl\u00e1ssica para \n\ngera\u00e7\u00e3o de amostras \u00e9 o m\u00e9todo de Monte Carlo (Halton, 1970; Oliver et al, 2008). \n\nPara um pequeno n\u00famero de amostras, no entanto, tem-se possivelmente a gera\u00e7\u00e3o \n\nde amostras mal distribu\u00eddas no dom\u00ednio, com a gera\u00e7\u00e3o de v\u00e1rios vazios e regi\u00f5es \n\ncom uma concentra\u00e7\u00e3o excessiva de pontos amostrais, conforme mostrado na Figu-\n\nra 5.3, onde temos a gera\u00e7\u00e3o 100 pontos amostrais. \n\nFigura 5.3: Amostragem gerada pelo m\u00e9todo de Monte Carlo. \n\n \n\n(Giunta et al, 2003) \n\n \n \n \n \n \n\n\n\n59 \n \n\n5.3.1 M\u00e9todo de Quasi-Monte Carlo (QMC) \n\nO m\u00e9todo de Quasi-Monte Carlo (Giunta et al, 2003; Kocis e Whiten, 1997) \u00e9 pura-\n\nmente determin\u00edstico e gera amostragens com uma melhor distribui\u00e7\u00e3o do que seria \n\nobtido com um m\u00e9todo de gera\u00e7\u00e3o aleat\u00f3ria, como Monte Carlo. Este m\u00e9todo \u00e9 ca-\n\nracterizado por usar sequ\u00eancias de baixa discrep\u00e2ncia, onde discrep\u00e2ncia \u00e9 a medi-\n\nda quantitativa de quanto a distribui\u00e7\u00e3o de amostras desvia de uma distribui\u00e7\u00e3o uni-\n\nforme ideal. \n\nA Figura 5.4 mostra um planejamento usando o m\u00e9todo Quasi-Monte Carlo, onde \n\ntemos a gera\u00e7\u00e3o de 100 pontos amostrais para o mesmo exemplo da Figura 5.3. \n\nFigura 5.4: Amostragem gerada pelo m\u00e9todo de Quasi-Monte Carlo. \n\n \n\n(Giunta et al, 2003) \n\n \n\n5.3.2 M\u00e9todo da Tessela\u00e7\u00e3o de Voronoi (CVT) \n\nConsiderando um conjunto de pontos gerados aleatoriamente, o m\u00e9todo da tessela-\n\n\u00e7\u00e3o de Voronoi (CVT \u2013 Centroidal Voronoi Telsselation) \u00e9 baseado na constru\u00e7\u00e3o de \n\nmosaicos de Voronoi (Du et al, 1999). Nas Figuras 5.5 a 5.7 temos exemplo de um \n\nconjunto de amostras gerados pelo m\u00e9todo CVT. Este m\u00e9todo pode ser usado na \n\nforma LCVT (Latinized Centroidal Voronoi Telsselations). Neste caso, para todas as \n\nproje\u00e7\u00f5es unidimensionais das amostras, somente deve existir uma \u00fanica proje\u00e7\u00e3o \n\nno intervalo particionado de cada vari\u00e1vel. Est\u00e1 ideia ser\u00e1 mostrada na pr\u00f3xima se-\n\n\u00e7\u00e3o referente a m\u00e9todo LHS. \n\n \n\n\n\n60 \n \n\n \n\n \n\n \n\nFigura 5.5: Conjunto inicial de pontos geradores. \n\n \n\nFigura 5.6: O m\u00e9todo de tessela\u00e7\u00e3o de Voronoi para os pontos da Figura 3.3. \n\n \n\nFigura 5.7: O m\u00e9todo de tessela\u00e7\u00e3o de Voronoi (CVT) ap\u00f3s atingir a condi\u00e7\u00e3o final de uniformi-\n\ndade. \n\n \n\n \n\n5.3.3 Hipercubo Latino (LHS) \n\nA ideia principal do Hipercubo Latino (LHS - Latin Hypercube Sampling) consiste em \n\ndividir a faixa de valores de cada vari\u00e1vel ( )\nj\n\nx  em m  intervalos com mesma probabi-\n\n\n\n61 \n \n\nlidade de incid\u00eancia, sendo os pontos da amostragem gerados aleatoriamente em \n\ncada intervalo (Giunta et al, 2003). \n\nConsiderando n  amostras com dimens\u00e3o d , ? ?1 2, , , dx x x , e as faixas de valores \n\nde cada vari\u00e1vel, teremos um total de \nd\n\nn  intervalos. Um exemplo de amostras esco-\n\nlhidas aleatoriamente num espa\u00e7o de dimens\u00e3o dois \u00e9 mostrado na Figura 5.8. \n\nFigura 5.8: Amostragem gerada pelo m\u00e9todo LHS num espa\u00e7o bidimensional. \n\n \n\n(Giunta et al, 2003) \n\n \n\nAs condi\u00e7\u00f5es para gera\u00e7\u00e3o das amostras s\u00e3o: \n\n1. Somente uma amostra \u00e9 escolhida dentro de cada \u00e1rea retangular (Bin). \n\n2. Para todas as proje\u00e7\u00f5es unidimensionais das amostras, somente deve existir \n\numa \u00fanica proje\u00e7\u00e3o no intervalo particionado de cada vari\u00e1vel. \n\n \n\n5.4 Ajuste ao Hist\u00f3rico com EnKF \n\nO EnKF \u00e9 uma abordagem de Monte Carlo que atualiza um conjunto de modelos \n\nsequencialmente, usando assimila\u00e7\u00e3o de dados. As realiza\u00e7\u00f5es iniciais geralmente \n\ns\u00e3o geradas a partir do conhecimento pr\u00e9vio geol\u00f3gico (Figura 5.5). As etapas se-\n\nguintes do ajuste ao hist\u00f3rico s\u00e3o um la\u00e7o iterativo de um circuito fechado que con-\n\nsiste na previs\u00e3o e assimila\u00e7\u00e3o de dados. O EnKF oferece um cen\u00e1rio ideal para a \n\natualiza\u00e7\u00e3o em tempo real e previs\u00e3o em modelos de simula\u00e7\u00e3o de reservat\u00f3rios. \n\nPeriodicamente, ao longo da vida operacional do reservat\u00f3rio, novas valores de pro-\n\ndu\u00e7\u00e3o de \u00f3leo, g\u00e1s e \u00e1gua est\u00e3o dispon\u00edveis e podem ser assimiladas para melhorar \n\nos par\u00e2metros do modelo (permeabilidade e porosidade) e as vari\u00e1veis associadas \n\n\n\n62 \n \n\n(satura\u00e7\u00e3o e press\u00e3o). Portanto, o ensemble de modelos ao final do processo de \n\najuste proporciona modelos que s\u00e3o condicionados aos dados de produ\u00e7\u00e3o existen-\n\ntes, e podem ser utilizados para previs\u00e3o da futura estrat\u00e9gia de planejamento da \n\nprodu\u00e7\u00e3o. Alguns detalhes sobre a codifica\u00e7\u00e3o de cada uma destas etapas ser\u00e3o \n\napresentados a seguir. As abordagens para verificar os resultados correspondentes \n\ne as previs\u00f5es tamb\u00e9m s\u00e3o discutidas. \n\nEste cap\u00edtulo \u00e9 uma base para o pr\u00f3ximo cap\u00edtulo, onde ser\u00e1 mostrado o impacto do \n\nesquema de assimila\u00e7\u00e3o, como melhorar a estrat\u00e9gia inicial de amostragem aleat\u00f3-\n\nria, e uma modifica\u00e7\u00e3o do m\u00e9todo EnKF usando uma m\u00e9dia ponderada na equa\u00e7\u00e3o \n\nassimila\u00e7\u00e3o. O EnKF poder ser visto sob um ponto de vista Bayesiano, ilustrado na \n\nFigura 5.9. \n\nFigura 5.9: Ilustra\u00e7\u00e3o da EnKF a partir do ponto de vista da concep\u00e7\u00e3o bayesiana. \n\n \n\n (Liang, 2007) \n\n \nA aproxima\u00e7\u00e3o do ensemble posterior \u00e9 dependente apenas da m\u00e9dia e da covari-\n\n\u00e2ncia calculadas a partir do ensemble anterior e das novas medi\u00e7\u00f5es. O ensemble \n\nposterior no tempo ti \u00e9 projetado para frente no tempo e utilizado como conjunto pr\u00e9-\n\nvio no tempo ti+1, e o processo repete-se sequencialmente ao longo do tempo. \n\n \n\n5.5 Fluxo de Trabalho de Ajuste ao Hist\u00f3rico Baseado em EnKF \n\nQuando um ensemble inicial de modelos de reservat\u00f3rios \u00e9 gerado, o EnKF \u00e9 usado \n\npara atualizar sequencialmente o ensemble no tempo para honrar as novas obser-\n\nva\u00e7\u00f5es de produ\u00e7\u00e3o no momento em que eles chegam. O EnKF consiste em uma \n\nintegra\u00e7\u00e3o para a frente gerando a previs\u00e3o seguido pela atualiza\u00e7\u00e3o da vari\u00e1vel de \n\nestado para gerar a an\u00e1lise, como mostrado na Figura 5.10. A cada passo de assimi-\n\n\n\n63 \n \n\nla\u00e7\u00e3o, o modelo \u00e9 atualizado de acordo com a Equa\u00e7\u00e3o 4.14 e n\u00e3o h\u00e1 necessidade \n\nde executar o simulador a partir do tempo inicial novamente. As observa\u00e7\u00f5es assimi-\n\nladas s\u00e3o consideradas como vari\u00e1veis aleat\u00f3rias com uma distribui\u00e7\u00e3o normal com \n\nm\u00e9dia igual ao valor observado e uma covari\u00e2ncia de erro que reflete a precis\u00e3o da \n\nmedi\u00e7\u00e3o. O conjunto atualizado \u00e9 ent\u00e3o integrado no tempo at\u00e9 o pr\u00f3ximo tempo de \n\natualiza\u00e7\u00e3o. O resultado \u00e9 um conjunto atualizado de realiza\u00e7\u00f5es, condicionado a \n\ntodos os dados anteriores de produ\u00e7\u00e3o e, portanto, fornece o ponto de partida ideal \n\npara as previs\u00f5es de produ\u00e7\u00e3o futura (Seiler et. al. 2009). \n\nFigura 5.10: Fluxo de trabalho de ajuste ao hist\u00f3rico baseado em EnKF para os dados de produ\u00e7\u00e3o \n\n \n\n(Fahimuddin, 2010) \n\n \n\n5.6 Metodologia EnKF \n\nO EnKF \u00e9 um procedimento para ajuste ao hist\u00f3rico autom\u00e1tico que requer colabo-\n\nra\u00e7\u00e3o entre diversas \u00e1reas da engenharia e geologia do petr\u00f3leo e tem diversas eta-\n\npas:  \n\n? Cria\u00e7\u00e3o de um modelo inicial do reservat\u00f3rio com base na interpreta\u00e7\u00e3o geol\u00f3-\n\ngica; \n\n? Parametriza\u00e7\u00e3o do problema de estima\u00e7\u00e3o (vari\u00e1veis est\u00e1ticas e din\u00e2micas, \n\nmedi\u00e7\u00f5es, etc); \n\n? Defini\u00e7\u00e3o do problema em termos matem\u00e1ticos; \n\n\n\n64 \n \n\n? Cria\u00e7\u00e3o do ensemble inicial; \n\n? Execu\u00e7\u00e3o do la\u00e7o de assimila\u00e7\u00e3o de dados e atualiza\u00e7\u00e3o dos modelos; \n\n? Interpreta\u00e7\u00e3o de resultados. \n\nOs resultados insatisfat\u00f3rios devem ser analisados novamente desde o in\u00edcio para \n\nencontrar o erro e refazer o procedimento a partir do ponto onde foi detectado o pro-\n\nblema na assimila\u00e7\u00e3o. \n\n \n\n5.7 Ajuste de Hist\u00f3rico Tradicional Versus Baseado em EnKF \n\nA primeira desvantagem do m\u00e9todo tracional \u00e9 o fato de que para os m\u00e9todos tradi-\n\ncionais de ajuste ao hist\u00f3rico, os dados de produ\u00e7\u00e3o para todo o hist\u00f3rico s\u00e3o ajus-\n\ntados ao mesmo tempo, e, portanto, \u00e9 necess\u00e1rio repetir simula\u00e7\u00f5es de fluxos de \n\ntodo o hist\u00f3rico. Isso faz com que o ajuste seja extremamente demorado. Na Figura \n\n5.11, mostramos uma an\u00e1lise comparativa entre o ajuste ao hist\u00f3rico baseada em \n\nEnKF e um m\u00e9todo de ajuste ao hist\u00f3rico tradicional. Observe o recurso de atualiza-\n\n\u00e7\u00e3o sequencial do EnKF comparado com o m\u00e9todo tradicional.  \n\nEm segundo lugar, m\u00e9todos de otimiza\u00e7\u00e3o baseados em gradientes para o ajuste ao \n\nhist\u00f3rico exigem c\u00e1lculos de coeficiente de sensibilidade e de minimiza\u00e7\u00e3o que s\u00e3o \n\ncomplicados, caros e muitas vezes, ficam presos em m\u00ednimos locais. No entanto, h\u00e1 \n\ntamb\u00e9m t\u00e9cnicas estoc\u00e1sticas de otimiza\u00e7\u00e3o global que n\u00e3o precisam de gradiente e \n\nn\u00e3o ficam presos em m\u00ednimos locais, por\u00e9m estas t\u00e9cnicas s\u00e3o muito mais custosas \n\nem termos de tempo de execu\u00e7\u00e3o do que a aplica\u00e7\u00e3o do EnKF (Fahimuddin, 2010). \n\n\u00c9 dif\u00edcil avaliar a incerteza com os m\u00e9todos tradicionais, e este processo pode incluir \n\na repeti\u00e7\u00e3o do processo de ajuste ao hist\u00f3rico com diferentes modelos iniciais. Com \n\no EnKF a avalia\u00e7\u00e3o da incerteza \u00e9 imediata e intr\u00ednseca ao m\u00e9todo, com a avalia\u00e7\u00e3o \n\ndireta de estat\u00edsticas sobre o ensemble. Uma limita\u00e7\u00e3o de EnKF \u00e9 o fato de que seus \n\nc\u00e1lculos baseiam-se apenas em momentos de primeira e segunda ordem das vari\u00e1-\n\nveis de produ\u00e7\u00e3o, e h\u00e1 problemas que s\u00e3o dif\u00edceis de tratar quando as distribui\u00e7\u00f5es \n\nde probabilidade destas vari\u00e1veis s\u00e3o multi-modais (Haugen et. al., 2008). Apesar de \n\nquest\u00f5es te\u00f3ricas e pr\u00e1ticas sobre a aplicabilidade do EnKF para problemas reserva-\n\nt\u00f3rio altamente n\u00e3o-lineares e n\u00e3o-gaussianos, tem sido encontrados resultados \n\npromissores do uso do EnKF como uma ferramenta de ajuste ao hist\u00f3rico (Aanonsen \n\net al., 2009). \n\n\n\n65 \n \n\n \n\n \n\nFigura 5.11: Ajuste ao hist\u00f3rico tradicional e o baseado em EnKF \n\n \n\n (Liang, 2007) \n\n \n\n5.8 Recursos Computacionais \n\nComo o tempo de processamento e a demanda por mem\u00f3ria s\u00e3o as principais difi-\n\nculdades em simula\u00e7\u00f5es computacionais de problemas de grande porte um sistema \n\ncomputacional para ajuste ao hist\u00f3rico deve utilizar t\u00e9cnicas para a redu\u00e7\u00e3o do es-\n\nfor\u00e7o computacional requerido pelos processos de ajuste e de propaga\u00e7\u00e3o de incer-\n\nteza. Da mesma forma, uma vez que decis\u00f5es cr\u00edticas ser\u00e3o tomadas baseadas nas \n\ninforma\u00e7\u00f5es geradas pelas simula\u00e7\u00f5es num\u00e9ricas, \u00e9 necess\u00e1rio que o sistema for-\n\nne\u00e7a dados confi\u00e1veis. Nesta disserta\u00e7\u00e3o foram tratados apenas problemas acad\u00ea-\n\nmicos de pequeno porte, portanto foi usado um computador pessoal convencional, \n\ncom um processador Intel(R) core (TM) i7-3930k CPU 3.80GHz com sistema opera-\n\ncional Windows 7 e memoria RAM de 8,00 GB, para realizar as simula\u00e7\u00f5es. Atual-\n\nmente, problemas com at\u00e9 alguns milhares de c\u00e9lulas computacionais s\u00e3o conside-\n\nrados de pequeno porte.  \n\n \n\n \n\n  \n\n\n\n66 \n \n\nCAP\u00cdTULO 6 \n\n6. Estudos de Caso \n\n6.1 Introdu\u00e7\u00e3o  \n\nA metodologia do EnKF foi aplicada a dois casos com caracter\u00edsticas distintas. Cada \n\num dos casos possui peculiaridades no que se refere \u00e0 complexidade de sua geo-\n\nmetria, heterogeneidade e esquema de produ\u00e7\u00e3o. A permeabilidade e a porosidade \n\ns\u00e3o os principais par\u00e2metros petrof\u00edsicos para o modelo de simula\u00e7\u00e3o de reservat\u00f3-\n\nrio, e t\u00eam um impacto significativo sobre as reservas, previs\u00f5es de produ\u00e7\u00e3o e vari\u00e1-\n\nveis econ\u00f4micas dos reservat\u00f3rios. Os principais par\u00e2metros de sa\u00edda s\u00e3o satura-\n\n\u00e7\u00f5es e press\u00f5es para cada c\u00e9lula nos intervalos de tempo desejados e as vari\u00e1veis \n\nem observa\u00e7\u00e3o s\u00e3o a produ\u00e7\u00e3o de \u00f3leo e corte de \u00e1gua (WCT). \n\nO EnKF \u00e9 usado juntamente com o simulador de reservat\u00f3rio MRST nestes dois ca-\n\nsos para a estimativa dos par\u00e2metros petrof\u00edsicos do reservat\u00f3rio e criar um conjunto \n\nde modelos ajustados que forne\u00e7a uma previs\u00e3o adequada da produ\u00e7\u00e3o futura do \n\nreservat\u00f3rio, com uma quantifica\u00e7\u00e3o da sua incerteza. \n\nO objetivo principal desses casos \u00e9 estudar e avaliar o EnKF dentro de condi\u00e7\u00f5es \n\nsimplificadas e de f\u00e1cil controle. \n\n6.2 Caso 1 \n\nO caso 1 \u00e9 um problema modelo artificial, mas cuja simplicidade permite a cria\u00e7\u00e3o \n\nde situa\u00e7\u00f5es, sua finalidade principal \u00e9 verificar a correta implementa\u00e7\u00e3o do m\u00e9todo \n\ne das ferramentas desenvolvidas nesta disserta\u00e7\u00e3o. \n\nO modelo de simula\u00e7\u00e3o do Caso 1 tem 51x51x1 c\u00e9lulas e apresenta as propriedades \n\nresumidas na Tabela 6.1.  \n\n\n\n67 \n \n\nTabela 6.1: Resumo das caracter\u00edsticas do modelo do Caso 1. \n\nPROPRIEDADE DADOS \n\nMalha de Simula\u00e7\u00e3o  51(510m)x51(510m)x1(4m)  \n\nPorosidade  30% \n\nPermeabilidade horizontal (kh)  1000 mD \n\nPermeabilidade vertical (kv) 10% de kh \n\nCompressibilidade da Rocha @ 200 kgf/cm\n2\n 5.10\n\n?5\n (kgf/cm\n\n2\n)\n?1\n\n \n\nViscosidade \u00c1gua \u00d3leo \n\n0.97 cP 0.97 cP \n\nDensidade \u00c1gua \u00d3leo \n\n965.284 kg/m\n3\n 903.249 kg/m\n\n3\n \n\nContatos entre Fluidos  Sem Contatos entre Fluidos  \n\nPress\u00e3o de Satura\u00e7\u00e3o (Psat)  273 kgf/cm\n2 \n \n\nRaz\u00e3o G\u00e1s-\u00d3leo de Forma\u00e7\u00e3o (RGOF) 115.5 m\n3\n/m\n\n3\nstd  \n\n \n \nEsse modelo resulta num sistema com 7.083 graus de liberdade. O modelo usado \n\nem nosso estudo foi inspirado pelo usado na disserta\u00e7\u00e3o de Oliveira (2006), que \u00e9 \n\num reservat\u00f3rio com 1 po\u00e7o injetor e 2 po\u00e7os produtores como mostrado na Figura \n\n6.1, mas que no modelo de Oliveira possui apenas tr\u00eas regi\u00f5es de permeabilidade \n\ndistintas. O campo de permeabilidades suposto como real \u00e9 mostrado na Figura 6.1, \n\ne tem 16 regi\u00f5es de permeabilidade, com valores variando entre 200 mD e 3000 mD. \n\nFigura 6.1: Campo de permeabilidade inicial (Adaptado de Oliveira, 2006). \n\n \n\n\n\n68 \n \n\nFoi considerado que a permeabilidade de cada bloco \u00e9 uma realiza\u00e7\u00e3o de uma vari-\n\n\u00e1vel aleat\u00f3ria padr\u00e3o independente, e foram geradas 10 realiza\u00e7\u00f5es aleat\u00f3rias da \n\npermeabilidade a partir do modelo inicial, usando um gerador de amostras Latin \n\nHypercube Sampling (LHS). Cada vari\u00e1vel aleat\u00f3ria tem densidade de probabilidade \n\nnormal, sendo a m\u00e9dia igual a 1200 mD, e desvio padr\u00e3o igual a 400 mD. O reserva-\n\nt\u00f3rio foi considerado bif\u00e1sico, isto \u00e9, com apenas \u00f3leo e \u00e1gua, e a produ\u00e7\u00e3o de \u00f3leo \n\nao longo do tempo foi calculada com o m\u00e9todo impl\u00edcito adaptativo dispon\u00edvel no si-\n\nmulador de reservat\u00f3rios MRST. \n\nOs po\u00e7os produtores s\u00e3o restringidos por uma vaz\u00e3o m\u00e1xima de l\u00edquido de 40m\n3\n/dia, \n\nsem ter nenhum controle secund\u00e1rio complementar, e o po\u00e7o injetor foi controlado \n\napenas pela vaz\u00e3o m\u00e1xima de \u00e1gua injetada, definida em 44m\n3\n/dia. Esse valor foi \n\nadotado buscando-se a manuten\u00e7\u00e3o da press\u00e3o m\u00e9dia do reservat\u00f3rio. \n\nPara analisar o modelo do caso 1 foram consideradas tr\u00eas situa\u00e7\u00f5es com diferentes \n\nn\u00fameros de passos de assimila\u00e7\u00e3o de dados (itera\u00e7\u00f5es). Em todas as situa\u00e7\u00f5es a \n\npermeabilidade foi considerada ortotr\u00f3pica, a permeabilidade horizontal igual nas \n\nduas dire\u00e7\u00f5es e a permeabilidade vertical igual a dez por cento da horizontal. As va-\n\nri\u00e1veis observadas s\u00e3o a produ\u00e7\u00e3o de \u00f3leo e corte de \u00e1gua (WCT). Nestas situa\u00e7\u00f5es \n\nfoi utilizado um per\u00edodo de 30 anos de produ\u00e7\u00e3o, com 20 anos de hist\u00f3rico e 10 anos \n\nde previs\u00e3o.  \n\n \n\n6.2.1 Resultados do caso 1. \n\nNeste caso foram gerados os campos de permeabilidade, porosidade e press\u00e3o \n\nmostrados nas Figuras 6.2 a 6.5, que s\u00e3o gerados a partir da m\u00e9dia dos ensembles, \n\nal\u00e9m, que os campos de permeabilidade s\u00e3o mostrados em momentos diferentes e \n\ns\u00e3o feitas com 10 realiza\u00e7\u00f5es e 20 passos de tempo (itera\u00e7\u00f5es) de ajuste de hist\u00f3ri-\n\nco. As Figuras 6.6 a 6.11 mostram a produ\u00e7\u00e3o de \u00f3leo acumulado, taxa de produ\u00e7\u00e3o \n\nde \u00f3leo e corte de \u00e1gua para os po\u00e7os produtores para todo o per\u00edodo de conces-\n\ns\u00e3o. \n\n \n\n \n\n \n\n \n\n\n\n69 \n \n\n \n\nFigura 6.2: Campo Log-permeabilidade para 1825 dias e 3650 dias. \n\n \n\n \n\nFigura 6.3: Campo Log-permeabilidade para 5475 dias e 7300 dias. \n\n \n\n \n\nFigura 6.4: Campo Log-permeabilidade e Porosidade do ensemble m\u00e9dio. \n\n \n\n \n\n\n\n70 \n \n\n \n \n\nFigura 6.5: Campo de Press\u00e3o e Satura\u00e7\u00e3o do ensemble m\u00e9dio. \n\n \n\n \n\nFigura 6.6: Produ\u00e7\u00e3o de \u00f3leo acumulada. A linha vermelha corresponde ao modelo verdadeiro, a \n\nlinha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es. \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n0 2000 4000 6000 8000 10000\n850\n\n900\n\n950\n\n1000\nEnKF\n\nTempo\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 1\n\n0 2000 4000 6000 8000 10000\n0\n\n1\n\n2\n\n3\nx 10\n\n6 EnKF\n\nTempo\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 2\n\n0 2000 4000 6000 8000 10000\n0\n\n1\n\n2\n\n3\nx 10\n\n6 EnKF\n\nTempo\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 3\n\nPrevis\u00e3o Hist\u00f3rico \n\n\n\n71 \n \n\n \n\n \n\nFigura 6.7: Produ\u00e7\u00e3o de \u00f3leo acumulada. A linha vermelha corresponde ao modelo verdadeiro, a \n\nlinha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es. \n\n \n\n \n\n \n\nFigura 6.8: Taxa de \u00d3leo. A linha vermelha corresponde ao modelo verdadeiro, a linha azul \n\ncorresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es. \n\n \n\n \n\n \n\n \n\n \n\n \n\n0 2000 4000 6000 8000 10000\n850\n\n900\n\n950\n\n1000\nEnKF\n\nTempo\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 1\n\n0 2000 4000 6000 8000 10000\n0\n\n1\n\n2\n\n3\nx 10\n\n6 EnKF\n\nTempo\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 2\n\n0 2000 4000 6000 8000 10000\n0\n\n1\n\n2\n\n3\nx 10\n\n6 EnKF\n\nTempo\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 3\n\n0 2000 4000 6000 8000 10000\n0\n\n500\n\n1000\nEnKF\n\nTempoT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 1\n\n0 2000 4000 6000 8000 10000\n0\n\n5\n\n10\nx 10\n\n4 EnKF\n\nTempoT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 2\n\n0 2000 4000 6000 8000 10000\n0\n\n5\n\n10\nx 10\n\n4 EnKF\n\nTempoT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 3\n\nPrevis\u00e3o Hist\u00f3rico \n\nPrevis\u00e3o Hist\u00f3rico \n\n\n\n72 \n \n\n \n\n \n\nFigura 6.9: Taxa de \u00d3leo. A linha vermelha corresponde ao modelo verdadeiro, a linha azul \n\ncorresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es. \n\n \n\n \n\nFigura 6.10: Corte de \u00c1gua. A linha vermelha corresponde ao modelo verdadeiro, a linha azul \n\ncorresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es. \n\n \n\n \n\n \n\n \n\n0 2000 4000 6000 8000 10000\n0\n\n500\n\n1000\nEnKF\n\nTempoT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n)\n P\n\no\n\u00e7\no\n 1\n\n0 2000 4000 6000 8000 10000\n0\n\n5\n\n10\nx 10\n\n4 EnKF\n\nTempoT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n)\n P\n\no\n\u00e7\no\n 2\n\n0 2000 4000 6000 8000 10000\n0\n\n5\n\n10\nx 10\n\n4 EnKF\n\nTempoT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n)\n P\n\no\n\u00e7\no\n 3\n\n0 2000 4000 6000 8000 10000\n0\n\n0.5\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 1\n\n0 2000 4000 6000 8000 10000\n0\n\n0.5\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 2\n\n0 2000 4000 6000 8000 10000\n0\n\n0.5\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 3\n\nPrevis\u00e3o Hist\u00f3rico \n\nPrevis\u00e3o Hist\u00f3rico \n\n\n\n73 \n \n\n \n\n \n\nFigura 6.11: Corte de \u00c1gua. A linha vermelha corresponde ao modelo verdadeiro, a linha azul \n\ncorresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es. \n\n \n\n \nAp\u00f3s de realizar as simula\u00e7\u00f5es aplicando o m\u00e9todo EnKF e realizar o ajuste no caso \n\n1, obtendo-se as curvas de \u00d3leo Acumulado, Fator de Recupera\u00e7\u00e3o e Corte de \n\n\u00c1gua para os po\u00e7os de produ\u00e7\u00e3o, observamos que o m\u00e9todo EnKF fornece modelos \n\nmuito ajustados com rela\u00e7\u00e3o ao modelo verdadeiro. Infelizmente este resultado n\u00e3o \n\ndeve ser generalizado, pois as curvas de produ\u00e7\u00e3o deste modelo s\u00e3o muito pouco \n\nsens\u00edveis \u00e0s varia\u00e7\u00f5es de permeabilidade. A converg\u00eancia dos hist\u00f3ricos de produ-\n\n\u00e7\u00e3o no final do per\u00edodo de concess\u00e3o deve-se mais ao esgotamento do reservat\u00f3rio \n\ndo que ao procedimento de ajuste. \n\n A Tabela 6.2 mostra o n\u00famero de itera\u00e7\u00f5es e tempo de simula\u00e7\u00e3o para o EnKF, uti-\n\nlizado para realizar o ajuste de hist\u00f3rico durante o tempo de concess\u00e3o. \n\nTabela 6.2: Resultados obtidos ap\u00f3s das simula\u00e7\u00f5es. \n\nCaso 1 \n\nHist\u00f3rico de produ\u00e7\u00e3o: 20 anos Tempo de produ\u00e7\u00e3o: 30 anos \n\nM\u00e9todo Realiza\u00e7\u00f5es Itera\u00e7\u00f5es Tempo de simula\u00e7\u00e3o \n\nEnKF 10 20 3019.68 seg. \n\n \n \n \n\n0 2000 4000 6000 8000 10000\n0\n\n0.5\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 1\n\n0 2000 4000 6000 8000 10000\n0\n\n0.5\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 2\n\n0 2000 4000 6000 8000 10000\n0\n\n0.5\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 3\n\nPrevis\u00e3o Hist\u00f3rico \n\n\n\n74 \n \n\n \n \n \n \n6.3 Caso 2 \n\nO caso 2 \u00e9 um caso sint\u00e9tico com propriedades mais realistas, que se comp\u00f5e de \n\num modelo geol\u00f3gico um pouco mais complexo, mais pr\u00f3ximo de um modelo de re-\n\nservat\u00f3rio real. O modelo tem um campo de permeabilidade aleat\u00f3rio Gaussiano, \n\ngerado no simulador de reservat\u00f3rios MRST e os par\u00e2metros petrof\u00edsicos foram ob-\n\ntidos pela rela\u00e7\u00e3o de Carman \u2013 Kozeny, conforme pode ser visto no MRST (K,-A. \n\nLie, 2012). \n\nO modelo usa uma malha de 21x21x1 c\u00e9lulas, onde foram locados os 5 po\u00e7os que \n\ncomp\u00f5em o plano de desenvolvimento proposto para esse caso. Tratam-se de 4 po-\n\n\u00e7os produtores e 1 po\u00e7o injetor, est\u00e3o situados nos quatros cantos e no meio do re-\n\nservat\u00f3rio, respectivamente, posicionados segundo as caracter\u00edsticas permo-\n\nporosas e de continuidade do reservat\u00f3rio. \u00c9 um sistema de duas fases (\u00e1gua e \n\n\u00f3leo). Com fluidos incompress\u00edveis e n\u00e3o h\u00e1 for\u00e7as de capilaridade presentes.  \n\nSuas principais caracter\u00edsticas est\u00e3o resumidas na Tabela 6.3. \n\n \n\nTabela 6.3: Resumo das caracter\u00edsticas do modelo do Caso 2. \n\nPROPRIEDADE DADOS \n\nMalha de Simula\u00e7\u00e3o  21(1000m)x21(1000m)x1(10m)  \n\nPorosidade  Entre 10% e 26% \n\nPermeabilidade horizontal (kh)  Ver Mapas \n\nPermeabilidade vertical (kv) 10% de kh \n\nCompressibilidade da Rocha @ 200 kgf/cm\n2\n 5.10\n\n?5\n (kgf/cm\n\n2\n)\n?1\n\n \n\nViscosidade \u00c1gua  \u00d3leo \n\n0.40 cP 0.90 cP \n\nDensidade \u00c1gua \u00d3leo \n\n1014 kg/m\n3\n 859 kg/m\n\n3\n \n\nContatos entre Fluidos  Sem Contatos entre Fluidos  \n\nPress\u00e3o de Satura\u00e7\u00e3o (Psat)  350 kgf/cm\n2 \n \n\nRaz\u00e3o G\u00e1s-\u00d3leo de Forma\u00e7\u00e3o (RGOF) 115.5 m\n3\n/m\n\n3\nstd  \n\n \n\n \nComo no caso anterior, a permeabilidade foi considerada ortotr\u00f3pica, a permeabili-\n\ndade horizontal igual nas duas dire\u00e7\u00f5es e a permeabilidade vertical igual a dez por \n\n\n\n75 \n \n\ncento da horizontal. As vari\u00e1veis a ser observadas s\u00e3o a produ\u00e7\u00e3o de \u00f3leo e corte \n\nde \u00e1gua (WCT), que s\u00e3o medidos a cada 30 d\u00edas. As medi\u00e7\u00f5es s\u00e3o criadas adicio-\n\nnando algum ru\u00eddo Gaussiano, com m\u00e9dia zero e desvio padr\u00e3o igual a 10% do va-\n\nlor produzido no campo real no instante de tempo correspondente, para simular er-\n\nros de medi\u00e7\u00e3o. \n\nO tempo total de produ\u00e7\u00e3o \u00e9 de 30 anos, onde foi utilizado um hist\u00f3rico de produ\u00e7\u00e3o \n\nde um per\u00edodo de 20 anos e 10 anos de previs\u00e3o. As vaz\u00f5es de produ\u00e7\u00e3o e inje\u00e7\u00e3o \n\nforam distribu\u00eddas equitativamente entre os po\u00e7os. Assim, todos os po\u00e7os produtores \n\nestar\u00e3o produzindo a uma mesma vaz\u00e3o de 150m\n3\n/dia, al\u00e9m disso, a press\u00e3o do \n\nfundo de po\u00e7o (BHP) \u00e9 de 300 bar para os po\u00e7os produtores \u00e9 de 350 bar para o \n\npo\u00e7o injetor, desprezando a gravidade. \n\nFoi gerado um ensemble inicial com 50 realiza\u00e7\u00f5es, considerando-se uma permeabi-\n\nlidade m\u00e9dia de 90 mD e desvio padr\u00e3o de 47 mD, com densidade de probabilidade \n\nnormal. Este caso tamb\u00e9m \u00e9 resolvido com o m\u00e9todo adaptativo, que determina du-\n\nrante a execu\u00e7\u00e3o, em cada c\u00e9lula, se a mesma ser\u00e1 tratada de forma impl\u00edcita ou \n\nexpl\u00edcita, de acordo com as caracter\u00edsticas f\u00edsicas da c\u00e9lula naquele instante de tem-\n\npo, dispon\u00edvel no simulador de reservat\u00f3rios MRST. \n\nEste modelo ser\u00e1 considerado aquele que descreve o Caso 2. O mapa de permeabi-\n\nlidade para o Caso 2 est\u00e1 apresentado na Figura 6.12, onde as permeabilidades es-\n\nt\u00e3o entre 10 mD a 170 mD. \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n\n\n76 \n \n\n \n\nFigura 6.12: Campo de permeabilidad inicial. \n\n \n\n6.3.1 Resultados do caso 2. \n\nSimilarmente ao caso anterior, neste caso foram gerados os campos de permeabili-\n\ndade, porosidade e press\u00e3o mostrados nas Figuras 6.13 a 6.16, que s\u00e3o gerados a \n\npartir da m\u00e9dia dos ensembles, al\u00e9m, que os campos de permeabilidade s\u00e3o mos-\n\ntrados em momentos diferentes e s\u00e3o feitas com 50 realiza\u00e7\u00f5es e 50 passos de \n\ntempo (itera\u00e7\u00f5es) de ajuste de hist\u00f3rico. As Figuras 6.17 a 6.28 mostram a produ\u00e7\u00e3o \n\nde \u00f3leo acumulado, taxa de produ\u00e7\u00e3o de \u00f3leo e corte de \u00e1gua para os po\u00e7os produ-\n\ntores para todo o per\u00edodo de concess\u00e3o. Obtendo-se os seguintes resultados. \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n\n\n77 \n \n\n \n\nFigura 6.13: Campo Log-permeabilidade para 1825 dias e 3650 dias. \n\n \n\n \n\nFigura 6.14: Campo Log-permeabilidade para 5475 dias e 7300 dias. \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n\n\n78 \n \n\n \n\nFigura 6.15: Campo de Log-permeabilidade e porosidade do ensemble m\u00e9dio. \n\n \n\n \n\nFigura 6.16: Campo de Press\u00e3o e Satura\u00e7\u00e3o do ensemble m\u00e9dio. \n\n \n\n \n\n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n\n\n\n79 \n \n\n \n \n\nFigura 6.17: Produ\u00e7\u00e3o de \u00f3leo acumulada. A linha vermelha corresponde ao modelo verdadeiro, a \n\nlinha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es. \n\n \n\n \n\nFigura 6.18: Produ\u00e7\u00e3o de \u00f3leo acumulada. A linha vermelha corresponde ao modelo verdadeiro, a \n\nlinha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es. \n\n \n\n \n\n \n\n \n\n \n\n \n\n0 2000 4000 6000 8000 10000\n5000\n\n5500\n\n6000\n\n6500\n\n7000\n\n7500\nEnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 1\n\n0 2000 4000 6000 8000 10000\n0\n\n1\n\n2\n\n3\n\n4\nx 10\n\n6 EnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 2\n\n0 2000 4000 6000 8000 10000\n0\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\nx 10\n\n6 EnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 3\n\n0 2000 4000 6000 8000 10000\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\nx 10\n\n6 EnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 4\n\n0 2000 4000 6000 8000 10000\n0\n\n0.5\n\n1\n\n1.5\n\n2\nx 10\n\n6 EnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 5\n\n0 2000 4000 6000 8000 10000\n5000\n\n5500\n\n6000\n\n6500\n\n7000\n\n7500\nEnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 1\n\n0 2000 4000 6000 8000 10000\n0\n\n1\n\n2\n\n3\n\n4\nx 10\n\n6 EnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 2\n\n0 2000 4000 6000 8000 10000\n0\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\nx 10\n\n6 EnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 3\n\n0 2000 4000 6000 8000 10000\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\nx 10\n\n6 EnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 4\n\n0 2000 4000 6000 8000 10000\n0\n\n0.5\n\n1\n\n1.5\n\n2\nx 10\n\n6 EnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 5\n\nPrevis\u00e3o Hist\u00f3rico \n\nPrevis\u00e3o Hist\u00f3rico \n\n\n\n80 \n \n\n \n\n \n\nFigura 6.19: Produ\u00e7\u00e3o de \u00f3leo acumulada. A linha vermelha corresponde ao modelo verdadeiro, a \n\nlinha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es. \n\n \n\n \n\nFigura 6.20: Produ\u00e7\u00e3o de \u00f3leo acumulada. A linha vermelha corresponde ao modelo verdadeiro, a \n\nlinha azul corresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es. \n\n \n\n \n\n \n\n \n\n0 2000 4000 6000 8000 10000\n5000\n\n5500\n\n6000\n\n6500\n\n7000\n\n7500\nEnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 1\n\n0 2000 4000 6000 8000 10000\n0\n\n1\n\n2\n\n3\n\n4\nx 10\n\n6 EnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 2\n\n0 2000 4000 6000 8000 10000\n0\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\nx 10\n\n6 EnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 3\n\n0 2000 4000 6000 8000 10000\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\nx 10\n\n6 EnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 4\n\n0 2000 4000 6000 8000 10000\n0\n\n0.5\n\n1\n\n1.5\n\n2\nx 10\n\n6 EnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 5\n\n0 2000 4000 6000 8000 10000\n5000\n\n5500\n\n6000\n\n6500\n\n7000\n\n7500\nEnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 1\n\n0 2000 4000 6000 8000 10000\n0\n\n1\n\n2\n\n3\n\n4\nx 10\n\n6 EnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 2\n\n0 2000 4000 6000 8000 10000\n0\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\nx 10\n\n6 EnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 3\n\n0 2000 4000 6000 8000 10000\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\nx 10\n\n6 EnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 4\n\n0 2000 4000 6000 8000 10000\n0\n\n0.5\n\n1\n\n1.5\n\n2\nx 10\n\n6 EnKF\n\nTempo\n\n\u00d3\nle\n\no\n a\n\nc\nu\nm\n\nu\nla\n\nd\no\n (\n\nm\n3\n) \n\nP\no\n\u00e7\no\n 5\n\nPrevis\u00e3o Hist\u00f3rico \n\nPrevis\u00e3o Hist\u00f3rico \n\n\n\n81 \n \n\n \n\n \n\nFigura 6.21: Taxa de \u00d3leo. A linha vermelha corresponde ao modelo verdadeiro, a linha azul \n\ncorresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es. \n\n \n\n \n\nFigura 6.22: Taxa de \u00d3leo. A linha vermelha corresponde ao modelo verdadeiro, a linha azul \n\ncorresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es. \n\n \n\n \n\n \n\n \n\n0 2000 4000 6000 8000 10000\n0\n\n1000\n\n2000\n\n3000\n\n4000\n\n5000\n\n6000\nEnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 1\n\n0 2000 4000 6000 8000 10000\n0\n\n2\n\n4\n\n6\n\n8\n\n10\nx 10\n\n4 EnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 2\n\n0 2000 4000 6000 8000 10000\n0\n\n2\n\n4\n\n6\n\n8\n\n10\nx 10\n\n4 EnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 3\n\n0 2000 4000 6000 8000 10000\n2\n\n4\n\n6\n\n8\n\n10\nx 10\n\n4 EnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 4\n\n0 2000 4000 6000 8000 10000\n0\n\n2\n\n4\n\n6\n\n8\n\n10\nx 10\n\n4 EnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 5\n\n0 2000 4000 6000 8000 10000\n0\n\n1000\n\n2000\n\n3000\n\n4000\n\n5000\n\n6000\nEnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 1\n\n0 2000 4000 6000 8000 10000\n0\n\n2\n\n4\n\n6\n\n8\n\n10\nx 10\n\n4 EnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 2\n\n0 2000 4000 6000 8000 10000\n0\n\n2\n\n4\n\n6\n\n8\n\n10\nx 10\n\n4 EnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 3\n\n0 2000 4000 6000 8000 10000\n2\n\n4\n\n6\n\n8\n\n10\nx 10\n\n4 EnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 4\n\n0 2000 4000 6000 8000 10000\n0\n\n2\n\n4\n\n6\n\n8\n\n10\nx 10\n\n4 EnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 5\n\nPrevis\u00e3o Hist\u00f3rico \n\nPrevis\u00e3o Hist\u00f3rico \n\n\n\n82 \n \n\n \n\n \n\nFigura 6.23: Taxa de \u00d3leo. A linha vermelha corresponde ao modelo verdadeiro, a linha azul \n\ncorresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es. \n\n \n\n \n\nFigura 6.24: Taxa de \u00d3leo. A linha vermelha corresponde ao modelo verdadeiro, a linha azul \n\ncorresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es. \n\n \n\n \n\n \n\n \n\n \n\n0 2000 4000 6000 8000 10000\n0\n\n1000\n\n2000\n\n3000\n\n4000\n\n5000\n\n6000\nEnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 1\n\n0 2000 4000 6000 8000 10000\n0\n\n2\n\n4\n\n6\n\n8\n\n10\nx 10\n\n4 EnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 2\n\n0 2000 4000 6000 8000 10000\n0\n\n2\n\n4\n\n6\n\n8\n\n10\nx 10\n\n4 EnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 3\n\n0 2000 4000 6000 8000 10000\n2\n\n4\n\n6\n\n8\n\n10\nx 10\n\n4 EnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 4\n\n0 2000 4000 6000 8000 10000\n0\n\n2\n\n4\n\n6\n\n8\n\n10\nx 10\n\n4 EnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 5\n\n0 2000 4000 6000 8000 10000\n0\n\n1000\n\n2000\n\n3000\n\n4000\n\n5000\n\n6000\nEnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 1\n\n0 2000 4000 6000 8000 10000\n0\n\n2\n\n4\n\n6\n\n8\n\n10\nx 10\n\n4 EnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 2\n\n0 2000 4000 6000 8000 10000\n0\n\n2\n\n4\n\n6\n\n8\n\n10\nx 10\n\n4 EnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 3\n\n0 2000 4000 6000 8000 10000\n2\n\n4\n\n6\n\n8\n\n10\nx 10\n\n4 EnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 4\n\n0 2000 4000 6000 8000 10000\n0\n\n2\n\n4\n\n6\n\n8\n\n10\nx 10\n\n4 EnKF\n\nTempo\n\nT\na\nx\na\n d\n\ne\n \u00f3\n\nle\no\n (\n\nm\n3\n/d\n\nia\n) \n\nP\no\n\u00e7\no\n 5\n\nPrevis\u00e3o Hist\u00f3rico \n\nPrevis\u00e3o Hist\u00f3rico \n\n\n\n83 \n \n\n \n\n \n\n \n\nFigura 6.25: Corte de \u00c1gua. A linha vermelha corresponde ao modelo verdadeiro, a linha azul \n\ncorresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es. \n\n \n\n \n\nFigura 6.26: Corte de \u00c1gua. A linha vermelha corresponde ao modelo verdadeiro, a linha azul \n\ncorresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es. \n\n \n\n \n\n \n\n \n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 1\n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 2\n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 3\n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 4\n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 5\n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 1\n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 2\n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 3\n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 4\n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 5\n\nPrevis\u00e3o Hist\u00f3rico \n\nPrevis\u00e3o Hist\u00f3rico \n\n\n\n84 \n \n\n \n\n \n\nFigura 6.27: Corte de \u00c1gua. A linha vermelha corresponde ao modelo verdadeiro, a linha azul \n\ncorresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es. \n\n \n\n \n\nFigura 6.28: Corte de \u00c1gua. A linha vermelha corresponde ao modelo verdadeiro, a linha azul \n\ncorresponde ao ensemble m\u00e9dio e as linhas cinzas \u00e0s realiza\u00e7\u00f5es. \n\n \n\n \n\nObservamos que, o quarto po\u00e7o produtor apresenta resultados n\u00e3o aceit\u00e1veis. Isso \n\nocorre porque ainda n\u00e3o haver irrup\u00e7\u00e3o de \u00e1gua no per\u00edodo de ajuste. Al\u00e9m disso, \n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 1\n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 2\n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 3\n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 4\n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 5\n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 1\n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 2\n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 3\n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 4\n\n0 2000 4000 6000 8000 10000\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\nEnKF\n\nTempo\n\nW\nC\n\nT\n P\n\no\n\u00e7\no\n 5\n\nPrevis\u00e3o Hist\u00f3rico \n\nPrevis\u00e3o Hist\u00f3rico \n\n\n\n85 \n \n\nobservamos que o m\u00e9todo EnKF gera modelos mais aceit\u00e1veis nos outros po\u00e7os \n\nprodutores ao longo da vida do campo, as outras figuras mostram os campos esti-\n\nmados para a permeabilidade, porosidade, press\u00e3o e satura\u00e7\u00e3o ap\u00f3s a execu\u00e7\u00e3o do \n\nEnKF. Na qual mostram um aumento de porosidade ao final da atualiza\u00e7\u00e3o com o \n\nEnKF, na qual foram utilizadas diferentes tempos de assimila\u00e7\u00e3o de dados. \n\nA Tabela 6.4, mostra o n\u00famero de itera\u00e7\u00f5es e tempo de simula\u00e7\u00e3o do m\u00e9todo EnKF, \n\nutilizados para realizar o ajuste ao hist\u00f3rico no caso 2. \n\nTabela 6.4: Resultados obtidos ap\u00f3s das simula\u00e7\u00f5es. \n\nCaso 2 \n\nHist\u00f3rico de produ\u00e7\u00e3o: 20 anos Tempo de produ\u00e7\u00e3o: 30 anos \n\nM\u00e9todo Realiza\u00e7\u00f5es Itera\u00e7\u00f5es Tempo de simula\u00e7\u00e3o \n\nEnKF 50 50 7821.84 seg. \n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n  \n\n\n\n86 \n \n\nCAP\u00cdTULO 7 \n\n7.  Conclus\u00e3o e Trabalhos Futuros  \n\n7.1 Conclus\u00e3o \n\nAtualmente as companhias petroleiras est\u00e3o se esfor\u00e7ando para atender \u00e0 demanda \n\ncrescente de energia. Portanto \u00e9 importante desenvolver novas tecnologias e estra-\n\nt\u00e9gias para otimizar a recupera\u00e7\u00e3o de \u00f3leo em campos existentes e nos novos cam-\n\npos que entram em produ\u00e7\u00e3o. Qualquer que seja a tecnologia ou estrat\u00e9gia, esta \n\nrequer um melhor conhecimento e caracteriza\u00e7\u00e3o do reservat\u00f3rio. Isto \u00e9 conseguido \n\natrav\u00e9s do ajuste de par\u00e2metros incertos do modelo que descreve o reservat\u00f3rio, \n\ntais como a permeabilidade, usando o ajuste ao hist\u00f3rico ou assimila\u00e7\u00e3o de dados. \n\nO EnKF mostrou-se uma ferramenta \u00fatil para esta assimila\u00e7\u00e3o. Reduzir o tempo de \n\nassimila\u00e7\u00e3o de dados em todo o ciclo de gest\u00e3o do reservat\u00f3rio \u00e9 uma quest\u00e3o im-\n\nportante. \n\nNesta disserta\u00e7\u00e3o foi descrito o processo do ajuste ao hist\u00f3rico baseado no m\u00e9todo \n\nEnKF, aplicado a reservat\u00f3rios de petr\u00f3leo. Abaixo resumimos outras quest\u00f5es im-\n\nportantes relevantes para a implementa\u00e7\u00e3o de EnKF em reservat\u00f3rios de petr\u00f3leo. \n\n1. O EnKF \u00e9 f\u00e1cil de implementar e seu desempenho \u00e9 muito satisfat\u00f3rio em com-\n\npara\u00e7\u00e3o com outros m\u00e9todos que s\u00e3o usados para o ajuste ao hist\u00f3rico em re-\n\nservat\u00f3rios de petr\u00f3leo.  \n\n2. Foram usadas de 10 at\u00e9 50 realiza\u00e7\u00f5es, para avaliar cada um dos casos estu-\n\ndados neste trabalho e a efici\u00eancia do EnKF para o ajuste foi aceit\u00e1vel. \n\n3. O EnKF tradicional pode fazer a assimila\u00e7\u00e3o de dados, minimiza\u00e7\u00e3o de vari\u00e2ncia \n\ne fornece previs\u00f5es adequadas que utilizam resultados de previs\u00f5es anteriores e \n\nas medi\u00e7\u00f5es passadas e presentes.  \n\n4. Aumentando o n\u00famero de realiza\u00e7\u00f5es proporcionalmente aumenta o tamanho do \n\nproblema para a etapa de previs\u00e3o e o tempo de execu\u00e7\u00e3o \u00e9 proporcionalmente \n\naumentado, no entanto, o tamanho do problema para a etapa de an\u00e1lise perma-\n\nnece praticamente o mesmo e o tempo de execu\u00e7\u00e3o n\u00e3o se altera significativa-\n\nmente.  \n\n5. O simulador de reservat\u00f3rios com c\u00f3digo livre MRST pode ser modificado com \n\nfacilidade e adaptado para outros m\u00e9todos e t\u00e9cnicas. \n\n\n\n87 \n \n\n6. Partir dos resultados apresentados, o trabalho de implementa\u00e7\u00e3o do EnKF \n\nusando o simulador MRST, foi bem sucedido. \n\n \n7.2 Trabalhos futuros  \n\nDurante este trabalho algumas ideias para desenvolvimentos futuros foram levanta-\n\ndas, como por exemplo.  \n\n1. Acoplar o m\u00e9todo EnKF com outros m\u00e9todos estoc\u00e1sticos, como o m\u00e9todo de \n\nColoca\u00e7\u00e3o Estoc\u00e1stica (Dongxiao et. al. 2011). \n\n2. Estender o c\u00f3digo do MRST para explorar as possibilidades de uso iterativo \n\nEnKF em caso de utiliza\u00e7\u00e3o de dados s\u00edsmicos. \n\n3. A constru\u00e7\u00e3o de uma interface de usu\u00e1rio e simplificar o processo de aplica\u00e7\u00e3o \n\ndo filtro.  \n\n4. O sistema desenvolvido \u00e9 acad\u00eamico e seria interessante leva-lo para um est\u00e1-\n\ngio em que pudesse ser incorporado aos procedimentos mais avan\u00e7ados de \n\ngest\u00e3o do reservat\u00f3rio. \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n  \n\n\n\n88 \n \n\nRefer\u00eancias  \n\nAanonsen, S.; N\u00e6vdal, G.; Oliver, D.; Reynolds, A.; and Vall\u00e8s, B.; \u201cThe Ensemble \n\nKalman Filter in Reservoir Engineering - a Review\u201d, SPE Journal, SPE 117274, 2009. \n\nAnderson, J.L., \u201cAn Ensemble Adjustment Kalman Filter for Data Assimilation\u201d. \n\nMonthly Weather Review, 129: 2884-2903. 2001. \n\nFahimuddin Abul; \u201c4D Seismic History Matching Using the Ensemble Kalman Filter \n\n(EnKF): Possibilities and Challenges\u201d, PhD Thesis Department of Mathematics Uni-\n\nversity of Bergen. March, 2010. \n\nApril, J.; Glover, F.; Kelly, J.; Laguna, M.; Erdogen, M.; Mudford, B. and Stegemeier, \n\nD.; \u201cAdvanced Optimization Methodology in the Oil and Gas Industry: The Theory of \n\nScatter Search Techniques with Simple Examples\u201d. Paper presented at the SPE Hy-\n\ndrocarbon Economics and Evaluation Symposium, Dallas, TX. SPE 82009. 5 - 8 \n\nApril, 2003a. \n\nApril, J.; Glover, F.; Kelly, J. and Laguna, M.; \u201cA New Optimization Methodology for \n\nPortfolio Management\u201d. Paper presented at the SPE Annual Technical Conference \n\nand Exhibition, Denver, CO. SPE 84332. 5 - 8 October 2003b. \n\nBishop, C.H., Etherton, B.J., and Majumdar, S.J., 2001. \u201cAdaptive Sampling with En-\n\nsemble Transform Kalman Filter\u201d. Part I: Theoretical Aspects. Monthly Weather Re-\n\nview, 129: 420-436. \n\nBrouwer, D.R., N\u00e6vdal, G., Jansen, J.D., Vefring, E.H., and Van Kruijsdijk, C.P.J.W., \n\n2004. \u201cImproved Reservoir Management through Optimal Control and Continuous \n\nModel Updating\u201d. Paper presented at the SPE Annual Technical Conference and Ex-\n\nhibition, Houston, TX, 26-29 September, SPE 90149. \n\nBrown, R. G. and Hwang, P. Y. C.; \u201cIntroduction to Random Signals and Applied \n\nKalman Filtering: with MATLAB Exercises and Solutions\u201d. Wiley New York, ISBN 0-\n\n471-12839-2. 1997. \n\nBurgers, G.; Van Leeuwen, P. J. and Evensen, G.; \u201cAnalysis Scheme in the Ensem-\n\nble Kalman Filter\u201d. Mon. Weather Rev., 126:1719\u20131724, 1998. \n\nChristie, M.; Macbeth, C. and Subbey, S.; \u201cMultiple History-Matched Models for Teal \n\nSouth\u201d. The Leading Edge, 21(3): 286-289. 2002. \n\nChristie, M.; Demyanov, V. and Erbas, D.; \u201cUncertainty Quantification of Porous Me-\n\ndia Flows\u201d. Journal of Computational Physics, 217: 143-158. 2006. \n\nCoxeter, H.S.M., \u201cRegular Polytopes\u201d. 3rd ed. New York: Dover, p. 45. 1973. \n\nCullick, A.S.; Johnson, D. and Shi, G.; \u201cImproved and More Rapid History Matching \n\nwith a Nonlinear Proxy and Global Optimization\u201d. Paper presented at the SPE Annual \n\n\n\n89 \n \n\nTechnical Conference and Exhibition, San Antonio, TX, 24-27 September, SPE \n\n101933. 2006. \n\nDa Costa Freitas C.; \u201cEstat\u00edstica \u2013 Curso I\u201d, Minist\u00e9rio da Ci\u00eancia e Tecnologia Insti-\n\ntuto Nacional de Pesquisas Espaciais, S\u00e3o Jos\u00e9 dos Campos 2003. \n\nDe Lira Junior J. D.; \u201cOtimiza\u00e7\u00e3o com Modelos Substitutos Considerando Incertezas \n\nem Reservat\u00f3rios de Petr\u00f3leo\u201d. Tese de Doutorado, Engenharia Civil, Universidade \n\nFederal de Pernambuco. Recife \u2013 Brasil. 2012. \n\nDeutsch, C.V. and Journel, A.G.; \u201cGSLIB: Geostatistical Software Library and User's \n\nGuide\u201d; Oxford University Press, New York. 1998. \n\nDong, Y., Gu, Y., Oliver, D.S., 2006. \u201cSequential Assimilation of 4D Seismic Data for \n\nReservoir Description Using the Ensemble Kalman Filter\u201d. Journal of Petroleum Sci-\n\nence and Engineering, 53 (1-2): 83-99. \n\nDongxiao Zhang, Heng Li, and Haibin Chang. \u201cHistory Matching for Non-Gaussian \n\nRandom Fields Using the Probabilistic Collocation Based Kalman Filter\u201d. SPE, Pe-\n\nking University, 2011. \n\nDu, Q.,Vance F., Gunzburger; M.; \u201cCentroidal Voronoi Tessellations: Applications \n\nand Algorithms\u201d, Society for Industrial and Applied Mathematics, 1999. \n\nEmerick, A. A. and Reynolds, A. C.; \u201cHistory Matching a Field Case Using the En-\n\nsemble Kalman Filter With Covariance Localization\u201d, SPE Reservoir Evaluation &amp; \n\nEngineering, 14(4), 423-432, 2011. \n\nEmerick, A. A. and Reynolds, A. C.; \u201cCombining the Ensemble Kalman Filter With \n\nMarkov Chain Monte Carlo for Improved History Matching and Uncertainty Character-\n\nization\u201d, SPE Journal, in press, 2012. \n\nEmerick, A. A., \u201cHistory Matching and Uncertainty Characterization Using Ensemble \n\nBased Methods\u201d, Ph. D. Thesis, Petroleum Engineering, University of Tulsa, 2012. \n\nErtekin, T.; Abou-Kassem, J. H. and King, G. R.; \u201cBasic Applied Reservoir Simula-\n\ntion\u201d. 1. ed. Rirchadson, Texas: Society of Petroleum Engineers, (Textbook, 7). 2001. \n\nEvensen, G., 1994. \u201cSequential Data Assimilation with a Nonlinear Quasi-\n\nGeostrophic Model using Monte Carlo Methods to Forecast Error Statistics\u201d. Journal \n\nof Geophys. Res. 99 (C5): 10143-10162. \n\nEvensen, G.; \u201cSampling Strategies and Square Root Analysis Schemes for the \n\nEnKF\u201d. Ocean Dyn., 54:539\u2013560, 2004. \n\nEvensen, G.; \u201cData Assimilation: The Ensemble Kalman Filter\u201d. Springer: New York, \n\n2007. \n\n\n\n90 \n \n\nEvensen, G., Hove, J., Meisingset, E., Reiso, K.S., Seim and Espelid, \u00d8., 2007. \u201cUs-\n\ning the EnKF for Assisted History Matching of a North Sea Reservoir Model\u201d. Paper \n\npresented in the SPE Reservoir Simulation Symposium, Houston, TX, 26-28 Febru-\n\nary, SPE 106184. \n\nFahimuddin, A., \u201c4D Seimic History Matching Using the Ensemble Kalman Filter \n\n(EnKF): Possibilities and Challenges\u201d, Ph. D. Thesis, Department of Mathematics, \n\nUniversity of Bergen, 2010. \n\nGao, G., Zafari, M., and Reynolds, A.C., 2005. \u201cQuantifying Uncertainty for the \n\nPUNQ-S3 Problem in a Bayesian Setting with RML and EnKF\u201d. Paper presented at \n\nSPE Reservoir Simulation Symposium, Houston, TX, 31 January-02 February, SPE \n\n99324. \n\nGillijns, S.; Barrero M. O.; Chandrasekar, J. B; de Moor, L. R.; Bernstein, D. S. and \n\nRidley, A.; \u201cWhat is the Ensemble Kalman Filter and How Well Does it Work?\u201d. In \n\nProceedings of the 2006 American Control Conference, pages 4448\u20134453, 2006. \n\nGiunta, A. A.; \u201cUse of Data Sampling, Surrogate Models, and Numerical Optimization \n\nin Engineering Design\u201d, Proceedings of the 40th AIAA Aerospace Sciences Meeting and Ex-\n\nhibit, Reno, NV, 2002. \n\nGiunta, A. A., Wojtkiewicz, S. F.,Eldred, M. S.; \u201cOverview of Modern Design of Exper-\n\niments Methods for Computational Simulations\u201d, Proceedings of the 41st AIAA Aero-\n\nspace Sciences Meeting and Exhibit, Reno, NV, 2003. \n\nGlover, F.; \u201cHeuristics for Integer Programming Using Surrogate Constraints\u201d. Deci-\n\nsion Sciences, 8: 156-166. 1977. \n\nGlover, F.; \u201cGenetic Algorithms and Scatter Search: Unsuspected Potentials\u201d. Statis-\n\ntics and Computing, 4: 131-140. 1994. \n\nGlover, F. and Laguna, M.; \u201cTabu Search\u201d. Kluwer Academic Publishers, Boston. \n\n1997. \n\nGu, Y., and Oliver, D.S., 2005. \u201cHistory Matching of the PUNQ-S3 Reservoir Model \n\nUsing the Ensemble Kalman Filter\u201d. Society of Petroleum Engineering Journal 10 (2) \n\n217- 224. \n\nHalton, J. H.; \u201cA Retrospective and Prospective Survey of the Monte Carlo Method\u201d. \n\nSIAM, 1970. \n\nHaugen, V., Natvik, L.; Evensen, G.; Berg, A.; Flornes, K. and Naevdal, G., \u201cHistory \n\nMatching Using the Ensemble Kalman Filter on a North Sea Field Case\u201d. SPE Jour-\n\nnal, v. 13, no. 4, p. 382\u2013391. 2006. \n\nHaugen, V. and N\u00e6vdal, G.; \u201cHistory Matching Using the Ensemble Kalman Filter on \n\na North Sea Field Case\u201d, SPE Journal, SPE 102430, 2008. \n\n\n\n91 \n \n\nHolland, J. H.; \u201cAdaptation in Natural and Artificial Systems\u201d. University of Michigan \n\nPress, Ann Arbor. 1975. \n\nHoutekamer, P.L., and Mitchell, H.L., 1998. \u201cData assimilation using an ensemble \n\nKalman filter technique\u201d. Monthly Weather Review, 126: 796-811. \n\nJazwinski, A. H.; \u201cStochastic Processes and Filtering Theory\u201d. Academic Press New \n\nYork, ISBN 3-540-38300-X. 1970. \n\nJensen, J. P.; \u201cEnsemble Kalman Filter for State and Parameter Estimation on a \n\nReservoir Model\u201d. M.Sc. Thesis paper submitted in the Department of Science in En-\n\ngineering Cybernetics. 2007. \n\nKalman, R. E.; \u201cA New Approach to Linear Filtering and Predictions Problems\u201d. \n\nTransaction of the ASME-Journal of Basic Engineering, pp. 35-45, March 1960. \n\nK.-A. Lie; S. Krogstad; I. S. Ligaarden; J. R. Natvig; H. M. Nilsen and B. Skaflestad.; \n\n\u201cOpen Source MATLAB Implementation of Consistent Discretisations on Complex \n\nGrids\u201d. Comput. Geosci., Vol. 16, No. 2, pp. 297-322, 2012. DOI: 10.1007/s10596-\n\n011-9244-4. \n\nKhairullah, Md., \u201cParallelization of Ensemble Kalman Filter (EnKF) For Oil Reser-\n\nvoirs\u201d. Master\u2019s Thesis in Computer Simulations for Science and Engineering \n\n(COSSE). Delft University of Technology. The Netherlands. 2012. \n\nKocis, L, Whiten, J. W., \u201cComputational Investigations of Low-discrepancy Sequenc-\n\nes\u201d, ACM Transactions on Mathematical Software, 1997. \n\nLanda, J. L.; \u201cReservoir Parameter Estimation Constrained to Pressure Transients, \n\nPerformance History and Distributed Saturation Data\u201d. PhD thesis, Stanford Universi-\n\nty. 1979. \n\nLahoz, W.; Khattatov, B. and Menard, R., \u201cData Assimilation: Making Sense of Ob-\n\nservations\u201d. editors. Springer, 2010. \n\nLiang, B.; \u201cAn Ensemble Kalman Filter Module for Automatic History Matching\u201d. Dis-\n\nsertation presented to the Faulty of Graduate School, University of Texas, Austin. \n\n2007. \n\nLiu, N., and Oliver, D.S.; \u201cCritical Evaluation of the Ensemble Kalman Filter on Histo-\n\nry Matching of Geological Facies\u201d. Paper presented at the SPE Reservoir Simulation \n\nSymposium, Houston, TX, 31 January-2 February, SPE 92867. 2005a. \n\nLiu, N., and Oliver, D.S.; \u201cEnsemble Kalman Filter for Automatic History Matching of \n\nGeologic Facies\u201d. Journal of Petroleum Science and Engineering 47: 147\u2013161. \n\n2005b. \n\nLorentzen, R.J., N\u00e6vdal, G., Vall\u00e8s, B., SPE, and Grimstad, A.-A., RF-Rogaland Re-\n\nsearch.; \u201cAnalysis of the Ensemble Kalman Filter for Estimation of Permeability and \n\n\n\n92 \n \n\nPorosity in Reservoir Models\u201d. Paper presented at the SPE Annual Technical Con-\n\nference and Exhibition, Dallas, Texas, USA, SPE 96375. 2005. \n\nMachale, D.; \u201cGeorge Boole: His Life and Work\u201d. Dublin, Ireland: Boole. 1985. \n\nMaschio, C.; Campane, V. A. and Schiozer, D. J.; \u201cIntegra\u00e7\u00e3o do Processo de Ajuste \n\nde Hist\u00f3rico com a Modelagem Geoestat\u00edstica em Reservat\u00f3rios de Petr\u00f3leo\u201d, Revis-\n\nta Brasileira de Geoci\u00eancias, 38(1 - Suplemento): 75-81, mar\u00e7o 2008. \n\nMei Han; Gaoming Li and Jingyi Chen.; \u201cAssimilating Microseismic and Welltest Data \n\nUsing EnKF for Accurate Reservoir Characterisation\u201d, International Petroleum Tech-\n\nnology Conference (IPTC), University of Tulsa, 26-28, March 2013. \n\nMetropolis, N.; Rosenbluth, A.; Rosenbluth, M.; Teller, A. and Teller, E.; \u201cEquation of \n\nState Calculations by Fast Computing Machines\u201d. Journal of Chem. Phys., 21, 6: \n\n1087-1092. 1953. \n\nN\u00e6vdal, G., Mannseth, T., Vefring, E.H.; \u201cNear-Well Reservoir Monitoring through \n\nEnsemble Kalman Filter\u201d. Presented at SPE/DOE Improved Oil Recovery Symposi-\n\num, Tulsa, Oklahoma, 13-17 April, USA, SPE 75235. 2002. \n\nMontgomery, D. C., Runger, G. C., \u201cEstat\u00edstica Aplicada e Probabilidade para Enge-\n\nnheiros\u201d, LTC, 2012. \n\nN\u00e6vdal, G., Johnsen, L.M., Aanonsen, S.I., Vefring, E.H.; \u201cReservoir Monitoring and \n\nContinuous Model Updating using Ensemble Kalman Filter\u201d. Society of Petroleum \n\nEngineering Journal 10 (1): 66-74. 2005. \n\nN\u00e6vdal, G., Brouwer, D.R., and Jansen, J.D.; \u201cWaterflooding Using Closed-Loop \n\nControl\u201d. Computational Geosciences 10 (1): 37-60. 2006. \n\nOliveira, Diego F. B.; \u201cT\u00e9cnicas de Otimiza\u00e7\u00e3o da produ\u00e7\u00e3o para Reservat\u00f3rios de \n\nPetr\u00f3leo\u201d, 137 f. Disserta\u00e7\u00e3o (Mestrado em Engenharia Civil), Departamento de En-\n\ngenharia Civil, UFPE, Recife. 2006. \n\nOliver, D. S., Reynolds, A. C, Liu, N.; \u201cInverse Theory for Petroleum Reservoir Characteri-\n\nzation and History Matching\u201d, Cambridge University Press, 2008. \n\nPanda, M. N. and Lake, L. W.; \u201cParallel Simulated Annealing for Stochastic Reservoir \n\nModeling\u201d. Paper SPE 26418 presented at the SPE Annual Technical Conference \n\nand Exhibition, Houston, TX, 3-6 October. 1993. \n\nPark, K., and Choe, J.; \u201cUse of Ensemble Kalman Filter with 3-Dimensional Reservoir \n\nCharacterization\u201d. Paper presented at the SPE Europec/EDGE Annual Conference \n\nand Exhibition, Vienna, Austria, 12-15 June, SPE 100178. 2006. \n\nPortellaand, R. C. M. and Prais, F.; \u201cUse of Automatic History Matching and Geosta-\n\ntistical Simulation to Improve Production Forecast\u201d. Paper SPE 53976 presented at \n\n\n\n93 \n \n\nthe Latin American and Caribbean Petroleum Engineering Conference, Caracas, \n\nVenezuela, 21-23 April. 1999. \n\nPress, W. H; Teukolsky, S. A.; Vetterling W. T. and Flannery, B. P.; \u201cNumerical Reci-\n\npes in Fortran\u201d. Cambridge University Press, p. 963. 1989. \n\nReinlie, S.T.; \u201cAnalysis of Continuous Monitoring Data and Rapid, Stochastic Updat-\n\ning of Reservoir Models\u201d. PhD Dissertation, University of Texas, Austin. 2006 \n\nReza, T.; Sanjay, S. and Mary, F. W.; \u201cRapid Updating of Stochastic Models Using an \n\nEnsemble Filter Approach\u201d, SPE, U. of Texas 2013, Society of Petroleum Engineers, \n\nTexas USA, 18\u201320 February 2013. \n\nRosa, A. J.; Carvalho, R. D. S.; Xavier, J. A. D., \u201cEngenharia de Reservat\u00f3rios de \n\nPetr\u00f3leo\u201d. 1. ed. Rio de Janeiro: Editora Interci\u00eancia, 2006. \n\nSaad G, Ghanen, R, \u201cCaracterization of Reservoir Simulation using a polynomial \n\nchaos based ensemble Kalman Filter\u201d, Water Resources Research, vol. 45, n. 4, \n\nW04417, 2009.  \n\nSambridge, M.; \u201cGeophysical Inversion with a Neighborhood Algorithm-I: Searching a \n\nParameter Space\u201d. Geophys. J. Int., 138: 479-494. 1999a. \n\nSambridge, M.; \u201cGeophysical Inversion with a Neighborhood Algorithm-I: Appraising \n\nthe Ensemble\u201d. Geophys. J. Int., 138: 727-746. 1999b. \n\nSeiler, A.; Evensen, G.; Skjervheim, J. A.; Hove, J.; \u201cAdvanced Reservoir Manage-\n\nment Work Flow Using an EnKF Based Assisted History Matching Method\u201d. SPE \n\nReservoir Simulation Symposium, SPE 118906, 2009. \n\nSkjervheim, J.-A., Evensen, G., Aanonsen, S.I., Ruud, B.O., and Johnansen, T.A.; \n\n\u201cIncorporating 4D Seismic Data in Reservoir Simulation Models Using Ensemble \n\nKalman Filter\u201d. Paper presented at the SPE Annual Technical Conference and Exhi-\n\nbition, Dallas, Texas, USA, 9-12 October, SPE 95789. 2005. \n\nSINTEF. Homepage of the MRST project. url: http://www.sintef.no/Projectweb/MRST  \n\n(visited on 13/03/2014). \n\nSousa, S. H. G.; Maschio, C. and Schiozer, D. J.; \u201cScatter Search Metaheuristic Ap-\n\nplied to the History-Matching Problem\u201d. Paper SPE 102975 presented at the SPE \n\nAnnual Technical Conference and Exhibition, San Antonio, TX, 24-27 September. \n\n2006. \n\nSuzuki, S. and Caers, J.; \u201cHistory Matching with an Uncertain Geological Scenario\u201d. \n\nPaper SPE 102154 presented at the SPE Annual Technical Conference and Exhibi-\n\ntion, San Antonio, TX, 24-27 September. 2006. \n\nhttp://www.sintef.no/Projectweb/MRST\n\n\n94 \n \n\nTavakoli, R., Pencheva, G., Wheeler, M. F., Ganis, B., \u201cA parallel ensemble-based \n\nframework for reservoir history matching and characterization\u201d, Computational Geo-\n\nsciences, n. 17, pp. 83-97, 2013. \n\nTavassoli, Z.; Carter, J. N.; King, P. R.; \u201cErrors in History Matching\u201d. SPE 86883. \n\n2004. \n\nTippett, M.K., Anderson, J.L., Bishop, C.H., Hamill, T.M., and Whitaker, J.S.; \u201cEn-\n\nsemble Square Root Filters\u201d. Monthly Weather Review, 131: 1485-1490. 2003. \n\nTrani, M.; Arts, R. and Leeuwenburgh, O.; \u201cSeismic History Matching of Fluid Fronts \n\nUsing the Ensemble Kalman Filter\u201d, Delft University of Technology, TNO, 2013. \n\nWeisstein, Eric.; Monte Carlo Method. http://mathworld.wolfram.com/ MonteCarlo-\n\nMethod.html. 2012. \n\nWen, X.-H., and Chen, W.H.; \u201cReal-Time Reservoir Model Updating Using Ensemble \n\nKalman Filter\u201d. Paper presented at the SPE Annual Reservoir Simulation Symposi-\n\num, Houston, TX, 31 January-2 February, SPE 92991. 2005. \n\nWhitaker, J.S., and Hamill, T.M.; \u201cEnsemble Data Assimilation without Perturbed Ob-\n\nservations\u201d. Monthly Weather Review, 130: 1913-1924. 2002. \n\nWiener, N., \u201cThe Homogeneous Chaos\u201d, American Journal of Mathematics, vol. 60, \n\nn. 4, pp 897-936, 1938. \n\nZafari, M., and Reynolds, A.C.; \u201cAssessing the Uncertainty in the Reservoir Descrip-\n\ntion and Performance Predictions with the Ensemble Kalman Filter\u201d. Paper presented \n\nat the SPE Annual Technical Conference and Exhibition, Dallas, TX, 9- 12 October, \n\nSPE 95750. 2005. \n\n \n\n \n\n  \n\nhttp://mathworld.wolfram.com/\n\n\n95 \n \n\nANEXO A \n\nFundamentos da Estat\u00edstica e Probabilidade \n\nA.1 Introdu\u00e7\u00e3o  \n\nO material neste cap\u00edtulo foi baseado do material de aula do curso de Estat\u00edstica (Da \n\nCosta, 2003), e tem como objetivo proporcionar ao leitor uma base para a compre-\n\nens\u00e3o da teoria do filtro. Alguns termos b\u00e1sicos de estat\u00edstica s\u00e3o apresentados pri-\n\nmeiro, seguido de uma introdu\u00e7\u00e3o para a distribui\u00e7\u00e3o de probabilidade de Gauss.  \n\nNo nosso cotidiano, lidamos sempre com situa\u00e7\u00f5es em que est\u00e1 presente a incerte-\n\nza do resultado, embora, muitas vezes, os resultados poss\u00edveis sejam conhecidos. \u00c9 \n\nconveniente, ent\u00e3o, dispormos de uma medida que exprima a incerteza presente em \n\ncada um destes acontecimentos. Tal medida \u00e9 a probabilidade. \n\nA Teoria da Probabilidade que permite estudar, por exemplo, de forma abstrata um \n\nfen\u00f4meno f\u00edsico ao qual est\u00e1 associado uma incerteza. Toda a vez que se emprega \n\na matem\u00e1tica com a finalidade de estudar algum fen\u00f4meno deve-se come\u00e7ar por \n\nconstruir um modelo. Este modelo pode ser constru\u00eddo de fen\u00f4menos determin\u00edsti-\n\ncos ou probabil\u00edsticos. \n\n? Fen\u00f4menos Determin\u00edsticos \n\nS\u00e3o aqueles em que os resultados s\u00e3o sempre os mesmos, para as mesmas condi-\n\n\u00e7\u00f5es da experi\u00eancia, qualquer que seja o n\u00famero de ocorr\u00eancias verificadas. \n\n? Fen\u00f4menos Probabil\u00edsticos \n\nS\u00e3o aqueles que, mesmo repetidos v\u00e1rias vezes sob condi\u00e7\u00f5es id\u00eanticas, apresen-\n\ntam resultados diferentes e imprevis\u00edveis. \n\n  \n\n\n\n96 \n \n\nA.2. Espa\u00e7o Amostral \n\nDefine-se espa\u00e7o amostral ? ??  o conjunto de todos os resultados poss\u00edveis de um \n\nexperimento ou fen\u00f4meno aleat\u00f3rio. \n\nUm resultado do experimento ? ??  \u00e9 chamado ponto amostral e o espa\u00e7o amostral \u00e9 \n\no conjunto de todos os pontos amostrais. \n\n \n\nA.2.1 Classifica\u00e7\u00e3o de um Espa\u00e7o Amostral \n\nUm espa\u00e7o amostral pode ser classificado em: \n\n? Finito, quando sua cardinalidade \u00e9 finita. Por exemplo: ? ?1, 2, 3, 4, 5, 6? ?  \n\n? Infinitos, caso contr\u00e1rio. Neste caso, podem ser:  \n\n? Enumer\u00e1veis (ou cont\u00e1veis), quando podemos associar a cada elemento do \n\nespa\u00e7o biunivocamente um n\u00famero natural. Por exemplo: \n\n? ?1, 2, 3, 4, 5,? ?  \n\n? N\u00e3o-enumer\u00e1veis, caso isto n\u00e3o seja poss\u00edvel (ou n\u00e3o cont\u00e1veis), Por \n\nexemplo: ? ?/ 0? ? ? ?t IR t  \n\n \n\nA.3 Evento  \n\nChamamos de evento ? ??  qualquer subconjunto do espa\u00e7o amostral ? ??\n \nde um ex-\n\nperimento aleat\u00f3rio. Assim, um evento aleat\u00f3rio pode ser um \u00fanico ponto amostral \n\nou uma reuni\u00e3o deles.  \n\n? Se ?? = , ?  \u00e9 chamado evento certo. \n\n? Se ? ??  e ?  \u00e9 um conjunto unit\u00e1rio,  \u00e9 chamado evento elementar. \n\n? Se ?? = ,  \u00e9 chamado evento imposs\u00edvel. \n\n  \n\n?\n\n?\n\n\n\n97 \n \n\nA.3.1 Combina\u00e7\u00e3o de Eventos \n\nPodem-se realizar opera\u00e7\u00f5es entre eventos da mesma forma que elas s\u00e3o realiza-\n\ndas entre conjuntos. Sejam ?  e ?  dois eventos de um mesmo espa\u00e7o amostra ? . A \n\nTabla mostra as opera\u00e7\u00f5es entre eventos, \n\nTabela A.1: Opera\u00e7\u00f5es entre eventos, a regi\u00e3o sombreada \u00e9 o resultado da opera\u00e7\u00e3o. \n\n?  uni\u00e3o ?  ou ?  soma ? , anotado por ??? , \n\nse e somente se ?  ocorre ou ?  ocorre. \n\n \n\n?  produto ?  ou ?  interse\u00e7\u00e3o ? , anotado por\n\n??? , se e somente ?  ocorre e ?  ocorre. \n\n \n\n?  menos ?  ou ?  diferen\u00e7a ? , anota-se ???\n\n, se e somente se ?  ocorre e ?  n\u00e3o ocorre. \n\n \n\nO complementar de ? , anotado por \nc? ou ??  \n\nse e somente se ?  n\u00e3o ocorre. \n\n \n\nDois eventos ?  e ? , s\u00e3o denominados mutuamente exclusivos ou excludentes, se eles n\u00e3o pude-\n\nrem ocorrer juntos, isto \u00e9, se ?? ? ?? . \n\n \n\n \n  \n\n\n\n98 \n \n\nA.4 \u00c1lgebra de Conjuntos \n\nEstamos interessados em trabalhar com subconjuntos do espa\u00e7o amostral, e estes \n\nsubconjuntos formam uma classe. Para consist\u00eancia da Teoria da Probabilidade, \n\nesta classe deve ter algumas propriedades que definem uma \u00e1lgebra. \n\n\u00c9 definido como uma \u00e1lgebra de subconjuntos de ? , um conjunto F  qualquer, que \n\nseja subconjunto n\u00e3o-vazio do espa\u00e7o amostral ?  e satisfa\u00e7a as seguintes proprie-\n\ndades: \n\n? Se ? F? , ent\u00e3o ?\nc\n\nF? . \n\n? Se ? F?  e F? ? , ent\u00e3o F?? ?? . \n\nA partir dessas propriedades podemos observar que uma \u00e1lgebra de conjuntos tam-\n\nb\u00e9m seguir\u00e1 as propriedades a seguir: \n\n? ?? F . \n\n? ??F . \n\n? Se , 1? ?\ni\n\nF i? , ent\u00e3o \n1?\n\n?\nn\n\ni\n\ni\n\nF? . \n\nPara que F  seja chamado uma ? -\u00e1lgebra, as mesmas propriedades anteriores s\u00e3o \n\nvalidas, mas com uma modifica\u00e7\u00e3o na \u00faltima: a uni\u00e3o deve ser verificada \u201cexausti-\n\nvamente\u201d, ou seja, de forma a que todas as poss\u00edveis uni\u00f5es venham a pertencer ao \n\nconjunto, \n\n? Se , 1? ?\ni\n\nF i? , ent\u00e3o \n1\n\n?\n\n?\n\n?\ni\n\ni\n\nF? . \n\n \n\nA.5 Conceitos de Probabilidade \n\nExistem tr\u00eas formas de se definir probabilidade. A defini\u00e7\u00e3o cl\u00e1ssica, a defini\u00e7\u00e3o fre-\n\nquentista e a defini\u00e7\u00e3o axiom\u00e1tica. \n\n \n\nA.5.1 Defini\u00e7\u00e3o Cl\u00e1ssica de Probabilidade \n\nSeja ?  um experimento aleat\u00f3rio e ?  um espa\u00e7o amostral. Seja ? ??  um evento, \n\na probabilidade de ? , \u00e9 definida: \n\n\n\n99 \n \n\n( ) ?\nPoss\u00edveis resultados favorecendo o evento\n\nP\nN\u00famero total de resultados poss\u00edveis\n\n?\n?  \n\n \n\nCr\u00edtica \u00e0 Defini\u00e7\u00e3o Cl\u00e1ssica \n\n? A defini\u00e7\u00e3o cl\u00e1ssica \u00e9 d\u00fabia, j\u00e1 que a id\u00e9ia de \u201cigualmente prov\u00e1vel\u201d \u00e9 a mesma \n\nde \u201ccom probabilidade igual\u201d, isto \u00e9, a defini\u00e7\u00e3o \u00e9 circular, porque est\u00e1 definin-\n\ndo essencialmente a probabilidade com seus pr\u00f3prios termos. \n\n? A defini\u00e7\u00e3o n\u00e3o pode ser aplicada quando o espa\u00e7o amostral \u00e9 infinito. \n\n \n\nA.5.2 Defini\u00e7\u00e3o de Probabilidade como Frequ\u00eancia Relativa \n\nUma das defini\u00e7\u00f5es de probabilidade utiliza a freq\u00fc\u00eancia relativa, j\u00e1 que as frequ\u00ean-\n\ncias relativas s\u00e3o estimativas de probabilidades. Podemos ent\u00e3o definir a probabili-\n\ndade como a propor\u00e7\u00e3o (ou frequ\u00eancia relativa) em uma seq\u00fc\u00eancia muito grande de \n\nexperimentos. \n\n? ?\n( ) lim\n\n???\n? ?\n\nN\n\nn n\u00famero de vezes que ocorre\nP\n\nN n\u00famero de vezes que \u00e9 repetido\n\n? ?\n?  \n\n \n\nA.5.2.1 Propriedades da Freq\u00fc\u00eancia Relativa \n\nSeja ?  um experimento e ?  e ?  dois eventos de um espa\u00e7o amostral ? . Sejam \n\n? ?P ? e ? ?P ? as freq\u00fc\u00eancias relativas de  e ?  respectivamente. Ent\u00e3o, \n\n? ? ?0 1? ?P ? , isto \u00e9, a freq\u00fc\u00eancia relativa do evento ?  \u00e9 um n\u00famero que varia \n\nentre 0 e 1. \n\n? ? ? 1?P ? , se e somente se, ?  ocorre em todas as repeti\u00e7\u00f5es de ? . \n\n? ? ? 0?P ? , se e somente se, ?  nunca ocorre nas repeti\u00e7\u00f5es de ? . \n\n? ? ? ? ? ? ?P P P? ?? ? ?? ? , se  e ?  forem eventos mutuamente excludentes. \n\nCr\u00edtica \u00e0 Defini\u00e7\u00e3o Frequentista \n\nEsta defini\u00e7\u00e3o, embora \u00fatil na pr\u00e1tica, apresenta dificuldades matem\u00e1ticas, pois o \n\nlimite pode n\u00e3o existir. Em virtude dos problemas apresentados pela defini\u00e7\u00e3o cl\u00e1s-\n\n?\n\n?\n\n\n\n100 \n \n\nsica e pela defini\u00e7\u00e3o frequentista, foi desenvolvida uma teoria, na qual a probabilida-\n\nde \u00e9 um conceito indefinido, como o ponto e a reta o s\u00e3o na geometria. \n\n \n\nA.5.3 Defini\u00e7\u00e3o Axiom\u00e1tica de Probabilidade \n\nPara um dado experimento, \u00e9 necess\u00e1rio atribuir para cada evento ?  no espa\u00e7o \n\namostral ?  um n\u00famero ? ?P ?  que indica a probabilidade de ?  ocorrer. Para satisfa-\n\nzer a defini\u00e7\u00e3o matem\u00e1tica de probabilidade, este n\u00famero ? ?P ?\n \ndeve satisfazer tr\u00eas \n\naxiomas espec\u00edficos: \n\n? Axioma 1: Para qualquer evento ? , ? ? 0?P ? . \n\n? Axioma 2: ? ? 1? ?P . \n\n? Axioma 3: Para qualquer seq\u00fc\u00eancia infinita de eventos disjuntos ? ? ?i j? ? ;\n\n, 1, 2, ,?i j ? ??i j , ent\u00e3o, \n\n? ?\n11\n\n? ?\n\n??\n\n? ?\n?? ?\n\n? ?\n?i i\nii\n\nP P? ?                                                                                                   A.1 \n\nA defini\u00e7\u00e3o matem\u00e1tica de probabilidade pode agora ser dada como segue: \n\nA distribui\u00e7\u00e3o de probabilidade, ou simplesmente a probabilidade, no espa\u00e7o amos-\n\ntral ?  \u00e9 uma especifica\u00e7\u00e3o de n\u00fameros ( )p ?  que satisfazem os axiomas 1, 2, e 3. \n\nDestes axiomas decorrem um n\u00famero de teoremas \u00fateis cuja demonstra\u00e7\u00e3o \u00e9 trivial. \n\nTeorema 1: ? ? 0?P ?  \n\nTeorema 2: Para qualquer seq\u00fc\u00eancia finita de eventos disjuntos ? ? ?i j? ? ; \n\n? ?, 1, 2, ,? ?i j n i j  \n\n? ?\n11 ??\n\n? ?\n?? ?\n\n? ?\n?\n\nn n\n\ni i\n\nii\n\nP P? ?                                                                                                   A.2 \n\nTeorema 3: Para qualquer evento ? ,  \n\n? ? ? ?1? ?cP P? ?                                                                                                        A.3 \n\n\n\n101 \n \n\nTeorema 4: Para qualquer evento ? ,  \n\n? ?0 1? ?P ?                                                                                                                A.4 \n\nTeorema 5: Se ??? , ent\u00e3o  \n\n? ? ? ?P P ???                                                                                                              A.5 \n\nTeorema 6: Para qualquer dois eventos ?  e ? ,  \n\n? ? ? ? ? ? ? ?P P P P? ? ?? ? ? ? ?? ? ?                                                                           A.6 \n\nA.6 Eventos Independentes \n\nSuponha que dois eventos ? e ?  ocorram independentes um do outro no sentido \n\nque a ocorr\u00eancia ou n\u00e3o de um deles tenha nenhuma rela\u00e7\u00e3o, e nenhuma influ\u00eancia \n\nna ocorr\u00eancia ou na n\u00e3o ocorr\u00eancia do outro. Nessas condi\u00e7\u00f5es \n\n? ? ? ? ? ?P P P? ?? ? ?? ?                                                                                               A.7 \n\nA.7 Probabilidade Condicional \n\nSe ?  e ?  s\u00e3o dois eventos, a probabilidade de ?  ocorrer, depois de ?  ter aconte-\n\ncido, \u00e9 representada por ? ?P ??\\\n \n(probabilidade de ?  dado ? ) e \u00e9 definida como: \n\n? ?\n( )\n\n; ( ) 0\n( )\n\nP\nP P\n\nP\n\n?\n? ?\n\n?\n\n?\n? ?\n\n?\n?\\                                                                                    A.8 \n\nSe ( ) 0P ? ?  a ? ?P ??\\  n\u00e3o \u00e9 definida. \n\n \n\nA.8 Probabilidade Condicional para Eventos Independentes \n\nSe ?  e ?  s\u00e3o independentes, ent\u00e3o ? ? ? ? ? ?P P P? ?? ? ?? ? . Logo, \n\n? ?\n? ?( )\n\n( )\n( )\n\nP P\nP P\n\nP\n\n?\n?\n\n?\n\n?\n? ?\n\n?\n?\\ ?                                                                                      A.9 \n\nDa mesma forma, \n\n \n\n\n\n102 \n \n\n? ?\n? ? ( )\n\n( )\n( )\n\nP P\nP P\n\nP\n\n?\n? ?\n\n?\n? ?\n\n?\n\\?\n\n?\n                                                                                   A.10 \n\nTeorema: \n\nSuponha que \n1 2\n, , ,\n\nn\n? ? ?  sejam quaisquer eventos tais que: \n\n? ? ? ?1 1 20, 0,? ? ?P P? ? ? ? ?1 2 1, 0?? ? ? ?nP ? ? ? , ent\u00e3o, \n\n? ? ? ? ? ? ? ?\n\n? ?\n\n1 2 1 2 1 3 1 2\n\n1 2 1?\n\n? ? ? ? ? ? ? ?\n\n? ? ? ?\n\nn\n\nn n\n\nP P P P\n\nP\n\n? ? ? ? ? \\? ? \\? ?\n\n? \\? ? ?\n                                     A.11 \n\nA.9 Probabilidade Total e Teorema de Bayes \n\nDiz-se que os conjuntos \n1 2\n, , ,\n\nn\n? ? ?  eventos de um mesmo espa\u00e7o amostral ? , \n\nformam uma parti\u00e7\u00e3o deste espa\u00e7o se: \n\n? ? ? ?i j? ? , para todo ?i j . \n\n? \n1 2\n? ? ? ? ?\n\nn\n? ? ? . \n\n? ? ? 0?iP ? , para todo i . \n\n \n\nA.9.1 Probabilidade total \n\nConsidere-se um espa\u00e7o amostra ?  e 1 2, , , n? ? ?  uma parti\u00e7\u00e3o deste espa\u00e7o \n\namostral. Seja ?  um evento de ? . Ent\u00e3o ? , pode ser escrito como: \n\n? ? ? ? ? ?1 2 n? ? ? ?? ? ? ? ? ? ?? ? ?                                                                      A.12 \n\n\u00c9 claro que, alguns destes conjuntos j? ?? , poder\u00e3o ser vazios, mas isto n\u00e3o re-\n\npresenta nenhum problema na decomposi\u00e7\u00e3o de ? . O importante \u00e9 que todos os \n\nconjuntos \n1 2\n, , ,? ?? ?? ?\n\nn\n? ??  s\u00e3o dois a dois mutuamente excludentes. E por \n\nisto, pode-se aplicar a propriedade da adi\u00e7\u00e3o de eventos mutuamente excludentes e \n\nescrever. \n\n? ? ? ? ? ? ? ?? ?\n\n? ? ? ? ? ?\n\n1 2\n\n1 2\n\nn\n\nn\n\nP P\n\nP P P\n\n? ? ? ?\n\n? ? ?\n\n? ? ? ? ? ? ?\n\n? ? ? ? ? ? ?\n\n? ? ?\n\n? ? ?\n                                                         A.13 \n\n\n\n103 \n \n\nMas cada um dos termos ? ?jP ? ??  \npode ser escrito na forma: \n\n? ? ? ? ? ?\\j j jP P P? ?? ? ?? ? ?                                                                                    A.14 \n\nPela defini\u00e7\u00e3o de probabilidade condicional, obt\u00e9m-se ent\u00e3o o denominado teorema \n\nda probabilidade total: \n\n? ? ? ? ? ? ? ? ? ? ? ? ? ?1 1 2 2\\ \\ \\n nP P P P P P P? ? ? ?? ? ? ? ? ? ?? ? ? ? ? ?                             A.15 \n\nOu \n\n? ? ? ? ? ?\n1\n\n\\\nn\n\nj j\n\nj\n\nP P P? ?\n?\n\n? ?? ? ?                                                                                       A.16 \n\nA.9.2 Teorema de Bayes \n\nPela nota\u00e7\u00e3o j\u00e1 vista acima, e generalizando-o que se est\u00e1 interessado em obter \u00e9 a \n\nprobabilidade de ocorr\u00eancia de um dos j?  dado que ?  ocorreu, isto \u00e9, o que se quer \n\n\u00e9 saber o valor de ? ?\\jP ?? , em que os eventos 1 2, , , n? ? ?  formam uma parti\u00e7\u00e3o \n\nde ?  e ?  \u00e9 um evento qualquer de ? . \n\nAplicando a defini\u00e7\u00e3o de probabilidade condicionada segue que: \n\n? ?\n? ?\n? ?\n\n? ? ? ?\n? ?\n\n\\\n\\\n\nj j j\n\nj\n\nP P P\nP\n\nP P\n\n? ?\n?\n\n? ?\n\n? ?\n? ?\n\n? ? ?\n?                                                                 A.17 \n\nonde ? ?P ?  \u00e9 avaliado pelo teorema da probabilidade total. Este resultado \u00e9 conhe-\n\ncido como teorema de Bayes. Assim: \n\n? ?\n? ? ? ?\n\n? ? ? ? ? ? ? ? ? ? ? ?1 1 2 2\n\n\\\n\\\n\n\\ \\ \\\n\nj j\n\nj\n\nn n\n\nP P\nP\n\nP P P P P P\n\n?\n?\n\n? ? ?\n\n?\n?\n\n? ? ? ? ? ?\n\n? ?\n?\n\n? ? ? ? ? ?\n                     A.18 \n\nOu \n\n? ?\n? ? ? ?\n\n? ? ? ?\n1\n\n\\\n\\\n\n\\\n\nj j\n\nj n\n\nj j\n\nj\n\nP P\nP\n\nP P\n\n?\n?\n\n?\n?\n\n?\n?\n\n??\n\n? ?\n?\n\n? ?\n\n                                                                                A.19 \n\n\n\n104 \n \n\nA.10 Sistema de Probabilidade \n\nO trio formado por: \n\n? Um espa\u00e7o amostral ? . \n\n? Uma ? -\u00e1lgebra F .  \n\n? Uma media de probabilidade P . \n\nConfigura um espa\u00e7o de probabilidade, denotado por: \n\n? ?, ,? ?S F P                                                                                                            A.20 \n\nA.11 Vari\u00e1veis Aleat\u00f3rias (VA) \n\nUma fun\u00e7\u00e3o X  que associe a cada elemento de ?  ? ????  um n\u00famero real \n\n? ???x X  \u00e9 denominada vari\u00e1vel real aleat\u00f3ria (VA), mostrada na Figura 4.1, \n\nFigura A.1: Mapeamento de resultados de experimentos a n\u00fameros em eixo real. \n\n \n\n \n\nA.11.1 Tipos de Vari\u00e1veis Aleat\u00f3rias \n\nOs tipos de vari\u00e1veis s\u00e3o discretas e continuas ou mistas, a continua\u00e7\u00e3o falaremos \n\nde cada uma delas, mas para nosso casso faremos uso das vari\u00e1veis aleat\u00f3rias con-\n\ntinuas. \n\n \nA.11.1.1 Vari\u00e1veis Aleat\u00f3rias Discretas (VAD) \n\nUma VA X  \u00e9 dita discreta se o seu conjunto de valores ? ??X  \u00e9 finito ou ent\u00e3o infi-\n\nnito cont\u00e1vel ou enumer\u00e1vel. \n\n\n\n105 \n \n\na) Fun\u00e7\u00e3o de Probabilidade \n\nSe a cada resultado ?\ni\n\nx  de ? ??X  associa-se um n\u00famero ? ? ? ?? ?i if x P X x , \u00e9 \n\ndenominada fun\u00e7\u00e3o de probabilidade de xi e tal que satisfa\u00e7a as seguintes proprie-\n\ndades: \n\n? ? ? 0?if x , para todo \u201ci \u201d. \n\n? ? ?\n1\n\n1\n?\n\n?\n\n?? i\ni\n\nf x  \n\nA cole\u00e7\u00e3o dos pares ? ?? ?,i ix f x , para 1, 2, 3,?i  \u00e9 denominada de distribui\u00e7\u00e3o de \n\nprobabilidade da VAD X . \n\n \n\nA.11.1.2 Vari\u00e1vel Aleat\u00f3ria Continua (VAC) \n\nSeja X  uma vari\u00e1vel aleat\u00f3ria cont\u00ednua. A fun\u00e7\u00e3o densidade de probabilidade (pdf) \n\n\u00e9 uma fun\u00e7\u00e3o f  que satisfaz \u00e0s seguintes condi\u00e7\u00f5es: \n\n? ? ? 0,? ? xf x x  \n\n? ? ? 1??\nx\n\nf x dx  \n\nAl\u00e9m disso, definimos, para qualquer ?c d  (em \nx\n\n16\n) \n\n? ? ? ?? ? ? ?\nd\n\nc\n\nP c x d f x dx                                                                                            A.21 \n\nObs: \n\n? ? ?? ?P c x d\n \nrepresenta a \u00e1rea sob a curva, como exemplificado no gr\u00e1fico da \n\nFigura 4.2, da fdp. f , entre ?x c  e ?x d . \n\n? Como consequ\u00eancia da descri\u00e7\u00e3o probabil\u00edstica de X que, para qualquer valor \n\nespecificado de X , digamos 0x , teremos ? ?0 0? ?P X x , porque \n\n? ? ? ?\n0\n\n0\n0\n\n0? ? ??\nx\n\nx\nP X x f x dx . \n\n                                                           \n16\n\n \nx\n: x  \u00e9 a vari\u00e1vel aleat\u00f3ria nos reais. \n\n\n\n106 \n \n\na) Fun\u00e7\u00e3o de Distribui\u00e7\u00e3o Acumulada (FDA) \n\nA fun\u00e7\u00e3o de distribui\u00e7\u00e3o acumuladada VA Real X , representada por XF  ou sim-\n\nplesmente por F , \u00e9 definida por: \n\n? ? ? ?? ?XF x P X x                                                                                                     A.22 \n\nObserva\u00e7\u00e3o: \n\n? A fun\u00e7\u00e3o de distribui\u00e7\u00e3o de X  \u00e9 tamb\u00e9m frequentemente chamada de fun\u00e7\u00e3o \n\nde distribui\u00e7\u00e3o acumulada de X . \n\n? A fun\u00e7\u00e3o ? ?XF x  \u00e9 n\u00e3o-decrescente quando x  aumenta, isto \u00e9, se 1 2?x x , en-\n\nt\u00e3o, \n\n? ? ? ?1 2?X XF x F x                                                                                               A.23 \n\n? Para qualquer valor de x , \n\n? ? ? ?1? ? ? XP X x F x                                                                                        A.24 \n\n? Para quaisquer valores \n1\n\nx  e \n2\n\nx , tais que \n1 2\n?x x , \n\n? ? ? ? ? ?1 2 2 1? ? ? ?X XP x X x F x F x                                                                      A.25 \n\nTeoremas: \n\n? Se X  for uma VAD, \n\n? ? ? ?\n?\n\n? ? ? ?\ni\n\ni\n\nx x\n\nF x P X x x\n\n                                                                                  A.26 \n\n? Se X  for uma VAC com pdf f , \n\n? ? ? ?\nx\n\nX\nF x f s ds\n\n??\n? ?                                                                                           A.27 \n\nA.12 Distribui\u00e7\u00f5es Bivariadas \n\nA distribui\u00e7\u00e3o de probabilidade conjunta de duas VA \u00e9 denominada uma distribui\u00e7\u00e3o \n\nbivariada. \n\n \n \n \n\n\n\n107 \n \n\nA.12.1 Distribui\u00e7\u00f5es Conjuntas Discretas \n\nA fun\u00e7\u00e3o de probabilidade conjunta de X  e Y  \u00e9 definida pela fun\u00e7\u00e3o f  tal que \n\nqualquer ponto ? ?,x y\n \nno plano xy , \n\n? ? ? ?, ,f x y P X x Y y? ? ?                                                                                       A.28 \n\nObserva\u00e7\u00e3o: \n\n? ? ?, 1?? i i\ni\n\nf x y . \n\n? Se X  e Y  forem independentes, ? ? ? ? ? ?, ? ? ? ?i i i if x y P X x P Y y , para todo i. \n\n \n\nA.12.2 Distribui\u00e7\u00f5es Conjuntas Cont\u00ednuas \n\nDuas VA, X  e Y  possuem uma distribui\u00e7\u00e3o conjunta cont\u00ednua se existe uma fun\u00e7\u00e3o \n\nf n\u00e3o negativa, definida sobre o plano xy , tal que para qualquer subconjunto S  do \n\nplano, \n\n? ? ? ?, ,? ?? ?? ? ??SP x y S f x y dx dy                                                                                 A.29 \n\nA fun\u00e7\u00e3o f  \u00e9 denominada pdf conjunta de X  e Y . Esta fun\u00e7\u00e3o deve satisfazer \n\n? ?, 0?f x y\n \npara ?? ? ? ?x  , ?? ? ? ?y  \n\ne \n\n? ?, 1f x y dx dy\n? ?\n\n?? ??\n?? ?                                                                                               A.30 \n\n \n\nA.13 Distribui\u00e7\u00f5es Marginais \n\nDenomina-se fun\u00e7\u00e3o densidade de probabilidade marginal de X  \u00e0 pdf de X  quan-\n\ndo ela \u00e9 obtida atrav\u00e9s da pdf conjunta de X  e Y . \n\n \n \n \n \n \n\n\n\n108 \n \n\n \n \n \nA.13.1 Caso Discreto \n\nSe X  e Y  s\u00e3o VA discretas com fun\u00e7\u00e3o de probabilidade conjunta ? ?,f x y , ent\u00e3o a \n\nfun\u00e7\u00e3o de probabilidade marginal de X  \u00e9 obtida por: \n\n? ? ? ? ? ?,? ? ? ?X\ny\n\nP x P X x f x y                                                                                  A.31 \n\nSimilarmente, a fun\u00e7\u00e3o de probabilidade marginal de Y  \u00e9: \n\n? ? ? ? ? ?,? ? ??Y\nx\n\nP y P Y y f x y                                                                                   A.32 \n\nA.13.2 Caso Cont\u00ednuo \n\nSe X  e Y  possuem uma distribui\u00e7\u00e3o conjunta com pdf conjunta ? ?,f x y , ent\u00e3o a \n\npdf marginal ? ?Xf x  de X  \u00e9 obtida por: \n\n? ? ? ?,\n?\n\n??\n? ?Xf x f x y dy                                                                                                A.33 \n\nSimilarmente, a pdf marginal de Y  \u00e9 obtida por: \n\n? ? ? ?,\n?\n\n??\n? ?Yf y f x y dx                                                                                                A.34 \n\nObserva\u00e7\u00e3o  \n\nSe X  e Y  forem independentes \n\n? ? ? ? ? ? ?, ? ?X YP x y P x P y  (Caso discreto) \n\n? ? ? ? ? ? ?, ? ?X Yf x y f x f y  (Caso continuo) \n\n \n\nA.14 Esperan\u00e7a de uma Vari\u00e1vel Aleat\u00f3ria  \n\nSeja X  uma VA real, a esperan\u00e7a de X , denotada por ? ?E X , \u00e9 um n\u00famero defini-\n\ndo por: \n\n\n\n109 \n \n\n? ? ? ? ?\n1\n\n?\n?\n\n? ? ?\nn\n\ni i\n\ni\n\nE X x f x  (Caso discreto) \n\n? ? ? ? ??\n?\n\n??\n? ? ?E X x f x dx  (Caso cont\u00ednuo) \n\nDada a m\u00e9dia da amostra\n17\n\n, onde o valor esperado que \u00e9 o resultado esperado se \n\ninfinitos dados est\u00e3o presentes pode ser aproximada por, \n\n? ?\n1\n\n1\n?\n\n?\n\n? ? ? ?\nN\n\ni\n\ni\n\nE X x x\nN\n\n                                                                                            A.35 \n\nonde, \n\n? N  \u00e9 o n\u00famero de realiza\u00e7\u00f5es independentes de x . \n\n? x  tem dimens\u00e3o m  e a distribui\u00e7\u00e3o ? ?f x .  \n\n \n\nA.15 Vari\u00e2ncia de uma Vari\u00e1vel Aleat\u00f3ria \n\nSeja X  uma VA real, a vari\u00e2ncia de X , denotada por ? ?Var X , \u00e9 um n\u00famero defini-\n\ndo por: \n\n? ? ? ? ? ? ?\n22\n\n1\n\nN\n\ni i\n\ni\n\nVar X x f x? ?\n?\n\n? ? ??  (Caso discreto) \n\n? ? ? ? ? ? ?\n22\n\n? ?\n?\n\n??\n? ? ??Var X x f x dx  (Caso continuo) \n\nA vari\u00e2ncia amostral pode ser aproximada como mostrado na Equa\u00e7\u00e3o (A.36). \n\n? ? ? ?\n22\n\n1\n\n1\n\n1\n?\n\n?\n\n? ? ?\n?\n?\n\nN\n\ni\n\ni\n\nVar X x x\nN\n\n                                                                               A.36 \n\nonde, 1?N  \u00e9 utilizado em vez de N  para proporcionar um estimador para a vari\u00e2n-\n\ncia. \n\n \n\nA.16 Covari\u00e2ncia \n\n                                                           \n17\n\n S\u00e3o os objetos selecionados da popula\u00e7\u00e3o. Se esses objetos s\u00e3o selecionados de tal maneira que \ncada objeto tem a mesma chance de ser selecionado do que o outro, temos uma amostra aleat\u00f3ria. \n\n\n\n110 \n \n\nDadas duas VA X  e Y , e suas respectivas pdfs ? ?f x\n \ne ? ?f y , sua covari\u00e2ncia \u00e9 \n\ndefinida como, \n\n? ? ? ? ? ?, ( )( )COV X Y E X E X Y E Y? ?? ? ?? ?                                                                    A.37 \n\nSe X  e Y  s\u00e3o independentes ( , ) ( ). ( )?f X Y f X f Y  e assim ? ?, 0?COV X Y . Quali-\n\ntativamente a covari\u00e2ncia descreve a depend\u00eancia entre duas vari\u00e1veis aleat\u00f3rias \n\nX  e Y . \n\nA covari\u00e2ncia da amostra \u00e9 derivada utilizando as mesmas propriedades da vari\u00e2n-\n\ncia da amostra como acima e \u00e9 dada pela \n\n? ? ? ? ? ? ? ?? ?\n1\n\n1\n, ( )( )\n\n1 ?\n? ?? ? ? ? ? ?? ?\n\n?\n?\n\nN\n\ni i\n\ni\n\nCOV X Y E X E X Y E Y x x y y\nN\n\n                             A.38 \n\nA.17 Distribui\u00e7\u00f5es de Probabilidade \n\nExistem muitas distribui\u00e7\u00f5es de vari\u00e1veis aleat\u00f3rias, nesta disserta\u00e7\u00e3o faremos uso \n\num dos principais modelos de distribui\u00e7\u00e3o cont\u00ednua, que \u00e9 a distribui\u00e7\u00e3o normal ou \n\nde Gauss. Sua import\u00e2ncia para a Estat\u00edstica (pr\u00e1tica) reside no fato que muitas va-\n\nri\u00e1veis encontradas na natureza se distribuem de acordo com o modelo normal. Este \n\nmodelo tamb\u00e9m tem uma import\u00e2ncia te\u00f3rica devido ao fato de ser uma distribui\u00e7\u00e3o \n\nlimite. A distribui\u00e7\u00e3o de Gauss \u00e9 dada pela pdf, \n\n? ?? ?\n2\n\n2\n\n1\n\n2\n1\n\n( ) ,\n2\n\n?\n\n??\n\n? ?\n\n? ?? ? ? ?\nx E X\n\nf e xx                                                                       A.39 \n\nA distribui\u00e7\u00e3o normal tem uma fun\u00e7\u00e3o de distribui\u00e7\u00e3o e pdf exemplificadas na Figura \n\n4.3. Aqui nesta figura a FDA e pdf para uma distribui\u00e7\u00e3o gaussiana s\u00e3o representa-\n\ndas para diferentes desvios padr\u00e3o ? e media ? . \n\n? ?? ?2,?X N E X  \u00e9 uma nota\u00e7\u00e3o compacta para dizer que uma vari\u00e1vel aleat\u00f3ria X  \n\n\u00e9 normalmente distribu\u00edda com um valor esperado ? ?E X e desvio padr\u00e3o ?. Se X  \u00e9 \n\num vetor de vari\u00e1veis aleat\u00f3rias com distribui\u00e7\u00e3o gaussiana com m\u00e9dia ? ?E X  e uma \n\nmatriz de covari\u00e2ncia Q , ent\u00e3o isso pode ser denotado como ? ?? ?,X N E X Q . Os \n\nelementos da diagonal de Q  denotam a vari\u00e2ncia para cada uma das vari\u00e1veis alea-\n\n\n\n111 \n \n\nt\u00f3rias em X  e os elementos fora da diagonal representam a covari\u00e2ncia entre as \n\nvari\u00e1veis. \n\nFigura A.2: FDA e pdf para a distribui\u00e7\u00e3o de Gauss \n\na) Fun\u00e7\u00e3o de distribui\u00e7\u00e3o acumulativa (FDA)      b) Fun\u00e7\u00e3o de densidade de probabilidade (pdf) \n\n \n\n (Jensen, 2007) \n\n \nA.18 Trabalhando com Amostras de uma Distribui\u00e7\u00e3o  \n\nQuando a dimens\u00e3o de uma fun\u00e7\u00e3o de probabilidade aumenta torna-se impratic\u00e1vel, \n\nse n\u00e3o imposs\u00edvel, avaliar os integrais por integra\u00e7\u00e3o num\u00e9rica em uma malha regu-\n\nlar. Suponha que a dimens\u00e3o \u00e9 10 e precisamos de 10 pontos de grade em cada \n\ndire\u00e7\u00e3o para ter uma representa\u00e7\u00e3o adequada da densidade. Uma grade com 10\n10\n\n \n\nn\u00f3s teria que ser armazenado o que exigiria 40 Gigabytes de armazenamento e 10\n10\n\n \n\nadi\u00e7\u00f5es seriam necess\u00e1rios para calcular a integral.  \n\nFelizmente, h\u00e1 t\u00e9cnicas para a integra\u00e7\u00e3o num\u00e9rica direta, que muitas vezes funcio-\n\nnam muito bem para sistemas de alta dimens\u00e3o. Uma \u00e9 a abordagem chamada o \n\nm\u00e9todo de Markov Chain Monte Carlo (MCMC), (Robert e Casella, 2004), e assume \n\nque n\u00f3s temos dispon\u00edvel um grande n\u00famero N , de realiza\u00e7\u00f5es da distribui\u00e7\u00e3o ( )f x\n\n."}]}}}