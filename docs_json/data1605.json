{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-BT.04928"}, {"@name": "filename", "#text": "BTP_2002_45_2_04_Deteccao_em_tempo.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "DETEC\u00c7\u00c3O EM TEMPO REAL DE VAZAMENTOS EM REDES DE ESCOAMENTO PARA FLUIDOS INCOMPRESS\u00cdVEIS: UMA ABORDAGEM EM S\u00c9RIES TEMPORAIS\nREAL TIME DETECTION OF LEAKS IN NON-COMPRESSIBLE FLUID FLOW SYSTEMS: A TIME\nSERIES APPROACH\nDETECCI\u00d3N EN TIEMPO REAL DE P\u00c9RDIDAS EN REDES DE\nTRANSPORTE DE FLUIDOS INCOMPRESIBLES: UN\nABORDAJE EN SERIES TEMPORALES\nC\u00e9sar Augusto Fernandes de Oliveira Laborat\u00f3rio SDV- Dutos Escola de Qu\u00edmica Universidade Federal do Rio de Janeiro (UFRJ) e-mail:j lm@eq.ufrj .br\nRESUMO\nForam desenvolvidos algoritmos para a detec\u00e7\u00e3o, quantifica\u00e7\u00e3o e localiza\u00e7\u00e3o em tempo real de vazamentos em redes de escoamento operando com fluidos incompress\u00edveis. Entradas e sa\u00eddas do processo s\u00e3o assumidas dispon\u00edveis por meio de sensores de campo, tratadas por procedimentos de reconcilia\u00e7\u00e3o e armazenadas em s\u00e9ries hist\u00f3ricas temporais. O processo aqui apresentado foi modelado como uma rede pseudo-estacion\u00e1ria para a gera\u00e7\u00e3o de dados do processo nas vari\u00e1veis de interesse: press\u00f5es nodais, vaz\u00f5es de escoamento nos tubos e n\u00f3s de entrada ou sa\u00edda. O procedimento consiste em gerar s\u00e9ries sob a ocorr\u00eancia de eventos programados e empreg\u00e1-las para treinamento de preditores MIMO em estrutura ARX/ARMAX, permanentemente atualizados. Um vazamento repentino \u00e9 detectado pelo afastamento instant\u00e2neo, estatisticamente significativo, entre um conjunto de predi\u00e7\u00f5es e as medi\u00e7\u00f5es do processo correspondentes \u00e0s respostas dos preditores. Identificado o evento, a pr\u00f3xima etapa \u00e9 localiz\u00e1-lo e quantific\u00e1-lo por meio de outro grupo de preditores treinados por dados simulados do processo para eventos de vazamento conhecidos. Estes preditores t\u00eam par\u00e2metros de vazamento (i.e. sua localiza\u00e7\u00e3o e di\u00e2metro do orif\u00edcio) como entradas suplementares, de tal forma que possam ser estimados para predizerem as respostas reais do processo que se afastam das predi\u00e7\u00f5es originalmente monitoradas na manifesta\u00e7\u00e3o do evento.\nABSTRACT\nAlgorithms were developed for real time detection, estimation and location of leaks in flow systems operating with non-compressible fluids. Process inputs and outputs are assumed to be available by means of field sensing, treated through historical time series reconciliation and storage. The process presented herein was built as a pseudo stationary system for process data generation at the selected variables: nodal pressures, flow rates in pipes and input and output nodes. The procedure consists in generating data series during the occurrence of programmed events and use them during the training of ARX/ARMAX structure MIMO predictors, with constant update. A sudden leak is detected by a statistically significant instant deviation between a group ofpredictions and the measures of the process associated with the predictors' answers. Once the event is identified, the next step is to locate and estimate its size using another group of predictors trained through simulated process data of known leak events. These predictors use leak parameters (i.e., its location and orifice diameter) as additional inputs so that estimation can be performed in order to predict real\nanswers to the process that are being deviated from the original predictions monitored during the manifestation of the event.\nRESUMEN\nSe han desarrollado algoritmos para la detecci\u00f3n, cuantificaci\u00f3n y localization, en tiempo real de p\u00e9rdidas o fugas en las redes de transporte de flujo que operan con fluidos incompresibles. Las entradas y salidas del proceso se asumen que est\u00e1n disponibles por medio de sensores de campo, estas informaciones son tratadas por procedimientos de reconciliation y son almacenadas en series hist\u00f3ricas temporales. El proceso aqu\u00ed presentado fue modelado como una red pseudo estacionaria para la generaci\u00f3n de datos del proceso de las siguientes variables de inter\u00e9s: presiones nodales, caudales de descarga en los tubos y en los nodos de entrada o salida. El procedimiento consiste en generar series considerando la ocurrencia de eventos programados y emplearlas para el entrenamiento de predictores MIMO en estructura ARX/ARMAX, que son permanentemente actualizados. Una p\u00e9rdida repentina es detectada por el distanciamiento instant\u00e2neo, estad\u00edsticamente significante, entre el conjunto de predicciones y las mediciones del proceso correspondientes a las respuestas de los predictores. Identificado el evento, la pr\u00f3xima etapa es localizarlo y cuantificarlo, por medio de otro grupo de predictores entrenados por datos simulados del proceso verificado en eventos de p\u00e9rdida o fuga conocidos. Estos predictores poseen par\u00e2metros de p\u00e9rdida (es decir, su localizaci\u00f3n y di\u00e1metro del orif\u00edcio) que son utilizados como entradas suplementarias, de tal forma que puedan ser estimados para predecir las respuestas reales del proceso que se ha distanciado de las predicciones originalmente monitoreadas en la manifestaci\u00f3n del evento.\nOBJETIVO\nDesenvolvimento de ferramentas computacionais para detec\u00e7\u00e3o, quantifica\u00e7\u00e3o (tempo de vazamento, vaz\u00e3o de vazamento e quantidade vazada) e localiza\u00e7\u00e3o de padr\u00f5es anormais de opera\u00e7\u00e3o.\nRELEV\u00c2NCIA\nRedes de escoamento s\u00e3o estruturas importantes na sociedade moderna, sendo respons\u00e1veis pelo transporte e distribui\u00e7\u00e3o de \u00e1gua, combust\u00edveis l\u00edquidos e gasosos al\u00e9m de mat\u00e9rias-primas industriais como petr\u00f3leo e g\u00e1s natural. Falhas e vazamentos nestes sistemas podem ocasionar, al\u00e9m de perdas econ\u00f4micas decorrentes da inutiliza\u00e7\u00e3o de material de valor comercial, desastres urbanos, industriais e ambientais. Em conseq\u00fc\u00eancia, o desenvolvimento de sistemas confi\u00e1veis e r\u00e1pidos para a detec\u00e7\u00e3o de vazamentos assume grande import\u00e2ncia no cen\u00e1rio da tecnologia de opera\u00e7\u00e3o de dutos e redes de escoamento.\n1.\tINTRODU\u00c7\u00c3O\nEstrat\u00e9gias de monitora\u00e7\u00e3o suportadas por sistemas de aquisi\u00e7\u00e3o de dados em tempo-real permitem a detec\u00e7\u00e3o de vazamentos pela identifica\u00e7\u00e3o de altera\u00e7\u00e3o repentina do padr\u00e3o de comportamento temporal de vari\u00e1veis do processo (como vaz\u00f5es e press\u00f5es). A localiza\u00e7\u00e3o de vazamentos \u00e9 obtida como conseq\u00fc\u00eancia da alta incid\u00eancia de pontos de medi\u00e7\u00e3o no sistema. A quantifica\u00e7\u00e3o do vazamento \u00e9 obtida pelo registro de vaz\u00f5es em ponto a montante e a jusante da zona do evento (1). Claramente, esta abordagem tem forte impacto no investimento da planta, al\u00e9m de necessitar de constantes e onerosas rotinas de manuten\u00e7\u00e3o de sensores. Medeiros (1) ressalta que a confiabilidade desta classe de Sistema de Detec\u00e7\u00e3o de Vazamentos (SDV) est\u00e1 assegurada apenas para sistemas caracterizados por uma grande linha de escoamento. No caso de redes de escoamento com topologia em \u00e1rvore, ou possuindo ciclos, estas estrat\u00e9gias, al\u00e9m de caras, mostram-se insuficientes.\nOutras classes de SDVs s\u00e3o apresentadas na literatura (2-4) como mais promissoras, confi\u00e1veis e associadas a menores investimentos de implanta\u00e7\u00e3o. Nestas, a qualidade da detec\u00e7\u00e3o obtida depende de modelos apropriados ao processo, sejam eles de natureza estoc\u00e1stica, gerados por estrat\u00e9gias de identifica\u00e7\u00e3o sobre s\u00e9ries temporais de vari\u00e1veis de entrada e sa\u00edda (estados), ou constru\u00eddos com base em princ\u00edpios e leis fenomenol\u00f3gicos. Geiger etal.(5 apresentam m\u00e9todos de detec\u00e7\u00e3o e localiza\u00e7\u00e3o de vazamentos com base em\nobservadores de estado derivados pela lineariza\u00e7\u00e3o de um modelo matem\u00e1tico b\u00e1sico. O sistema foi capaz de detectar vazamentos de 2% da vaz\u00e3o do duto.\nForam desenvolvidos, aqui, algoritmos para a detec\u00e7\u00e3o, quantifica\u00e7\u00e3o e localiza\u00e7\u00e3o, em tempo real, de vazamentos em redes de escoamento operando com fluidos incompress\u00edveis. Assume-se que o processo opera sob a influ\u00eancia de entradas variantes no tempo que cont\u00eam ru\u00eddos de processo ou de medi\u00e7\u00e3o de acordo com v\u00e1rios padr\u00f5es de ru\u00eddo poss\u00edveis. As entradas do processo, assim como algumas sa\u00eddas selecionadas, s\u00e3o assumidas dispon\u00edveis atrav\u00e9s de sensores de campo, tratadas por procedimentos de reconcilia\u00e7\u00e3o e armazenadas em s\u00e9ries hist\u00f3ricas temporais. Para se gerarem estas s\u00e9ries, que permitem a elabora\u00e7\u00e3o e teste de procedimentos de detec\u00e7\u00e3o, o processo foi modelado como uma rede de dutos pseudo-estacion\u00e1ria respondendo sem atrasos \u00e0s entradas. As vari\u00e1veis de processo de interesse s\u00e3o press\u00f5es nodais, vaz\u00e3o de escoamento no tubo e vaz\u00f5es de escoamento nodais de entrada ou sa\u00edda. As rela\u00e7\u00f5es do modelo incluem equa\u00e7\u00f5es de estado estacion\u00e1rio para balan\u00e7o de massa nodal e equa\u00e7\u00f5es de balan\u00e7o de momentum para os tubos. Os graus de liberdade estacion\u00e1rios remanescentes s\u00e3o atribu\u00eddos \u00e0s entradas do processo, que s\u00e3o compostas por um conjunto de press\u00f5es nodais e vaz\u00f5es de escoamento nodais de entrada ou sa\u00edda. Esta descri\u00e7\u00e3o do processo pode se apresentar como n\u00e3o realista, mas exibe propriedades altamente desej\u00e1veis para teste e desenvolvimento de estrat\u00e9gias com base em s\u00e9ries temporais de dados do processo para detec\u00e7\u00e3o, localiza\u00e7\u00e3o e quantifica\u00e7\u00e3o em tempo-real de escoamento.\nO procedimento t\u00edpico consiste em gerar s\u00e9ries temporais de entradas e respostas de opera\u00e7\u00e3o de redes, sob a ocorr\u00eancia de eventos pr\u00e9-programados como vazamentos, partidas e paradas de alimenta\u00e7\u00e3o e suprimentos. Estas s\u00e9ries s\u00e3o empregadas para treinamento de preditores MIMO em estrutura ARX/ARMAX. Os preditores auxiliares s\u00e3o permanentemente treinados e atualizados ao longo do tempo. A qualidade do treinamento \u00e9 medida por meio de entidades estat\u00edsticas como intervalo de confian\u00e7a para predi\u00e7\u00f5es corretas e estimadores. Uma manifesta\u00e7\u00e3o repentina de vazamento \u00e9 detectada como um afastamento instant\u00e2neo, estatisticamente significativo, entre um conjunto de predi\u00e7\u00f5es selecionadas e as medi\u00e7\u00f5es do processo correspondentes \u00e0s respostas dos preditores. A precis\u00e3o da detec\u00e7\u00e3o depende do conjunto de respostas treinadas e sua proximidade f\u00edsica com respeito \u00e0 localiza\u00e7\u00e3o do evento na rede: quanto maior o n\u00famero de respostas monitoradas e processadas na rede mais f\u00e1cil a detec\u00e7\u00e3o do evento.\nNa hip\u00f3tese de identifica\u00e7\u00e3o do evento, a pr\u00f3xima etapa \u00e9 localiz\u00e1-lo e quantific\u00e1-lo. Estes objetivos s\u00e3o atingidos por um outro grupo de preditores treinados por dados simulados do processo para eventos de vazamento conhecidos. Estes preditores t\u00eam par\u00e2metros de vazamento (i.e. sua localiza\u00e7\u00e3o e di\u00e2metro do orif\u00edcio) como entradas suplementares, de tal forma que possam ser estimados para predizer as respostas reais do processo que se afastam das predi\u00e7\u00f5es originalmente monitoradas na manifesta\u00e7\u00e3o do evento.\n2.\tDETEC\u00c7\u00c3O DE VAZAMENTOS E EVENTOS VIA ACOMPANHAMENTO DO PROCESSO COM PREDITORES ARX-MIMO\nAs sa\u00eddas do processo s\u00e3o acompanhadas por respostas calculadas pro meio de modelos estoc\u00e1sticos anteriormente treinados com dados estoc\u00e1sticos hist\u00f3ricos, i.e., s\u00e9ries temporais. Define-se como S\u00e9ries Temporais um conjunto de observa\u00e7\u00f5es geradas seq\u00fcencialmente no tempo . Empregou-se, aqui, estrutura ARX (Auto Regressive EXogenous Input) com m\u00faltiplas entradas e m\u00faltiplas sa\u00eddas (MIMO).\n2.1.\tPreditores ARX-MIMO\n\u2022 Vari\u00e1veis b\u00e1sicas\ny(t)\t: vetor (ny x 1) de sa\u00eddas do processo sob acompanhamento em t;\ny(t)\t: predi\u00e7\u00e3o para y(t) (ny x 1);\nw(t)\t: vetor (nu x 1) de entradas do processo sob acompanhamento em t;\nq(.)\t: operador de deslocamento;\nAk\t: matriz ny x nu constante;\nBk\t: matriz ny x nu constante;\nn\t: ordem do filtro de auto-regress\u00e3o (AR) do ARX-MIMO;\nm\t: ordem do filtro de entrada (X) do ARX-MIMO;\nAk (q) : operador matricial do filtro AR (ny x ny);\nBk (q) : operador matricial do filtro X (ny x nu).\nn k\nA(q)=1+ X Akq k(\u2022)\t(1)\n-\tk=1- k\nn k\nB(q)=1+S Bkq k(\u2022)\t(2)\n-\tk=1- k\n\u2022\tEqua\u00e7\u00f5es do Preditor para Instante t + 1\ny(t +1) = B(q)u (t) + q|1 - A(q)iy(t)\t(3)\n\u2022\tAbrindo operadores e estendendo predi\u00e7\u00e3o para instantes t + 1, t + N\ny(t +1) = B1 u(t) +... + Bmu(t - m +1) - A1 y(t) - \u2022\u2022\u2022 - Bny(t - n +1)\ny(t + N) = B\u00c1u.(t + N - 1) + \u2022\u2022\u2022 + BmU.(t + N - m) - A y(t + N - 1) - \u2022\u2022\u2022 - An y(t + N - n)\n\"\tm\t~\t\" -\t(4)\n\u2022\tMetodologia\nA metodologia de detec\u00e7\u00e3o de eventos consiste em construir preditores da classe (equa\u00e7\u00f5es 3 ou 4) e coloc\u00e1-los para prever estados do processo com respeito a apenas uma pequena parte do grande elenco plaus\u00edvel de vari\u00e1veis^ Teoricamente, na aus\u00eancia de anormalidades, e sob influ\u00eancia de ru\u00eddos estoc\u00e1sticos ordin\u00e1rios, o preditor dever\u00e1 rastrear com sucesso as vari\u00e1veis sob acompanhamento^ Entende-se por isto que a predi\u00e7\u00e3o distar\u00e1 do valor correspondente medido algo inferior \u00e0 largura do intervalo de confian\u00e7a da predi\u00e7\u00e3o^ Na ocorr\u00eancia de evento anormal e n\u00e3o-estoc\u00e1stico (re^ associado a ru\u00eddos) a predi\u00e7\u00e3o se afastar\u00e1 do valor medido em uma dist\u00e2ncia muito superior \u00e0 largura do intervalo de confian\u00e7a correspondente^ T\u00eam-se, assim, os fundamentos de um detector de anormalidades^\nAs fases principais da metodologia s\u00e3o:\nT gera\u00e7\u00e3o do preditor via treinamento com dados de processo em t + 1, \u2022 \u2022\u2022, t + N;\n2^ acompanhamento do processo com preditor gerado em t + N + 1, \u2022 \u2022\u2022, t + N + NI;\n3^ constru\u00e7\u00e3o de limites est\u00e1sticos de confian\u00e7a para preditores;\n4^ detec\u00e7\u00e3o de evento na faixa temporal t + N + 1, \u2022 \u2022\u2022, t + N + NI quando houver disparidade entre predi\u00e7\u00e3o e medi\u00e7\u00e3o al\u00e9m dos limites de confian\u00e7a;\n5^ ap\u00f3s t + N + NI regenerar o preditor com nova sess\u00e3o de treinamento com N instantes (normalmente NI >> N);\nRepetir etapas (ii) a (v), ap\u00f3s fazer t = t + N + NL\nA seguir, ser\u00e3o apresentados os principais fundamentos e procedimentos num\u00e9ricos das fases acima, que constituem o M\u00c9TODO DE DETEC\u00c7\u00c3O DE EVENTOS EM PROCESSOS DESCRITOS EM S\u00c9RIES TEMPORAL Este m\u00e9todo est\u00e1 sendo desenvolvido no Laborat\u00f3rio SDV-Dutos da Escola de Qu\u00edmica da UFRL\nA cole\u00e7\u00e3o matricial para treinamento do ARX-MIMO est\u00e1 apresentada no Ap\u00eandice 1 (equa\u00e7\u00f5es de 1T a L6\u00c9\n\u2022 Estima\u00e7\u00e3o de Par\u00e2metros para Sa\u00edda i\nHip\u00f3teses\n(i)\tModelo ARX \u00e9 correto para representar o processo:\nh i = X\u00c8i\n(5)\nonde:\n0 i \u00e9 o valor correto de par\u00e2metros;\nh i\u00e9 o vetor correto de predi\u00e7\u00f5es (t + 1,...,t + N) para a sa\u00edda i.\n(ii)\tAmostragem experimental para a sa\u00edda i, O i (coluna i de ), segue padr\u00e3o normal n\u00e3o correlacionado em torno de h :\ni\n1\n(2p ) N\nexp[-2(^i -1)R_1(^ -1.)]\n(6)\nR, = COV(^i) = 1idiag(r<);\t(r : Nx1)\n(7)\nDefinindo-se i\n(conhecida), tem-se:\n(8)\nPara se estimar q_i constr\u00f3i-se a fun\u00e7\u00e3o verossimilhan\u00e7a para a sa\u00edda i a partir da equa\u00e7\u00e3o 8\n.\tJdet(^,)\t1 A\tA\nl(*iq) = \u2019-'2 exp[--Yi)tW!&amp; -Y)]\n(9)\nEstima-se maximizando a fun\u00e7\u00e3o densidade conjunta dos valores medidos atrav\u00e9s de L(Ot ,f)t) :\nMax . L(Oi ,qi)\n(10)\nque corresponde a (W, conhecida):\nMin{ } 2<\u00a3-\u00edt) W(t,S.,)\n(11)\n\u25a0 i\nonde:\nY i \u00e9 o vetor de preditores para a sa\u00edda i dado em pela equa\u00e7\u00e3o 1.6 - Ap\u00eandice 1. Substitui\u00e7\u00e3o de (1.6 -Ap\u00eandice 1) seguida de busca de ponto estacion\u00e1rio em (2.1 - Ap\u00eandice 2), resulta em:\n0i = [X\u2018W X]-1 XW o,\n(12)\nA caracteriza\u00e7\u00e3o da Estima\u00e7\u00e3o, Regi\u00e3o de Confian\u00e7a de Par\u00e2metros, Regi\u00e3o de Confian\u00e7a para Predi\u00e7\u00f5es Corretas na Janela de Treinamento do ARX-MIMO e Fora da Janela de Treinamento est\u00e3o apresentadas no Ap\u00eandice 2.\n3.\tLOCALIZA\u00c7\u00c3O E QUANTIFICA\u00c7\u00c3O DE VAZAMENTOS E EVENTOS AP\u00d3S DETEC\u00c7\u00c3O\nEste procedimento \u00e9 implementado em duas fases:\n(1)\ttreinamento de preditor ARX-MIMO dual para reprodu\u00e7\u00e3o de resposta do processo sob a\u00e7\u00e3o de eventos;\n(2)\tobten\u00e7\u00e3o de estimadores para localiza\u00e7\u00e3o e quantifica\u00e7\u00e3o do evento detectado via estima\u00e7\u00e3o do feixe dual de entradas do preditor de modo a reproduzir o comportamento do processo antes e ap\u00f3s sua ocorr\u00eancia.\n3.1.\tPreditor ARX-MIMO DUAL\nTrata-se do mesmo preditor usado para detec\u00e7\u00e3o dotado de filtro extra da classe X (entrada) para processar feixe dual de entradas que correspondem \u00e0 altera\u00e7\u00e3o do sistema devido \u00e0 ocorr\u00eancia de eventos.\n\u2022 Vari\u00e1veis B\u00e1sicas\ny(tY-\nvetor (ny x 1) de sa\u00eddas do processo sob acompanhamento em t;\ny(t) :\tpredi\u00e7\u00e3o para y(t) (ny x 1);\nU(t) :\tvetor de entradas cl\u00e1ssicas do processo em t (nu x 1);\nz(t) :\tvetor de entradas duais do processo em t, correspondendo a\naltera\u00e7\u00f5es do processo (nz x 1);\nA(q), B(q), C(q): operadores matriciais dados por:\nnb\nA(q)=1+X Akq ~k (\u2022);\nk=1\nnb\nB(q) = 1+X Bkq ~k (\u2022);\nk=1\nnc\nC (q) = 1+X Ckq ~k (\u2022)\nk=1\n\u2022 Propostas de Vari\u00e1veis-chaves\ny (t Y u (t):\tpress\u00f5es de n\u00f3s t\u00edpicos da rede dotados de medidores; press\u00f5es especificadas em n\u00f3s de entrada da rede devido a bombas, compressores. Idem para n\u00f3s com vaz\u00f5es de entradas especificadas. z(t) = [zD1 zL1 zD2\tzL2\t... zDnt zLnt ]ntx1\nonde:\nnt \u00e9 o n\u00famero de tubos da rede em considera\u00e7\u00e3o, e (zD\u00ed,zL\u00ed ) s\u00e3o 2 valores num\u00e9ricos para descri\u00e7\u00e3o de furo na linha i. As seguintes express\u00f5es s\u00e3o propostas:\nzD1= (Df /Dt )2,5\nzLi= (Df / Dt )(1 + Lf / Lt)\n(13)\nonde:\nDit Li s\u00e3o o di\u00e2metro e comprimento da linha, DF \u00e9 o di\u00e2metro do furo e Lf sua posi\u00e7\u00e3o segundo orienta\u00e7\u00e3o pr\u00e9-definida do tubo. As equa\u00e7\u00f5es 13 evidenciam que um tubo sem anormalidade (DF = 0) corresponde \u00e0 entrada do sinal:\nz\nDi\n= 0\nz\nl _\nAnalogamente, \u00e0 rede em condi\u00e7\u00e3o normal em t corresponder\u00e1 z(t) = 0 . Neste caso, o preditor dever\u00e1 responder como o anteriormente descrito para detec\u00e7\u00e3o de eventos.\n\u2022\tEqua\u00e7\u00e3o do Preditor para t + 1\ny(t + f) = B(q)u(t +1) + C(q)z(t +1) + q[1 - A(q)ly(t)\t(14)\n\u2022\tAbrindo Operadores e Estendendo Predi\u00e7\u00e3o para t + 1, ..., t + N\ny(t +1) = Bu(t +1) +... + B u(t ~ m +1) +\nC1 z(t) + ...Cpz(t - p +1) +\nAiy(t) _..._ Any(t ~ n+1)\n...\t(15)\ny(t + N) = B u(t + N -1) +... + B u(t + N - m) +\nCz(t + N-1) + ...C z(t + N-p) +\nAjy(t+n -1) -... - Any(t+n - n)\n\u2022\tMetodologia para Treinamento de Preditor ARX-MIMO-DUAL\nMulti-eventos de furos de v\u00e1rios di\u00e2metros e posi\u00e7\u00f5es s\u00e3o simulados ao longo de grande per\u00edodo operacional, podendo haver concomit\u00e2ncia de eventos, sendo que estes se aplicam apenas durante certo intervalo de tempo ap\u00f3s o que s\u00e3o desligados. O Preditor ARX-MIMO-DUAL \u00e9 levado a reproduzir o comportamento das vari\u00e1veis acompanhadas ( y(t) ) \u00e0 medida que o sistema adquire entradas ( y(t) ) cl\u00e1ssicas e eventos (ou entradas duais) (z(t)).\nNo Ap\u00eandice 3 apresentam-se as Cole\u00e7\u00f5es Matriciais para Treinamento para o ARX-MIMO Dual, enquanto que o Ap\u00eandice 4 re\u00fane a Caracteriza\u00e7\u00e3o Estat\u00edstica do ARX-MIMO Dual.\n4.\tMODELO DE REDES DE ESCOAMENTO INCOMPRESS\u00cdVEL PSEUDO-ESTACION\u00c1RIO\nAs S\u00e9ries Temporais utilizadas para treinamento e teste dos detectores foram geradas por modelo de escoamento pseudo-estacion\u00e1rio descrito no Ap\u00eandice 5.\n5.\tDESCRI\u00c7\u00c3O DA METODOLOGIA VIA APLICA\u00c7\u00c3O EM REDE DE ESCOAMENTO DE 13 TUBOS\n\u2022\tRede B\u00e1sica\nA rede b\u00e1sica em considera\u00e7\u00e3o \u00e9 mostrada na figura 1. Consiste em 13 linhas com 0.1 m de di\u00e2metro no plano de cota virtual zero. A viscosidade e densidade do fluido s\u00e3o respectivamente 1cP e 1 g/cm3. A rugosidade de parede \u00e9 de 10-7m. As dimens\u00f5es das linhas (marcadas com c\u00edrculos) e as posi\u00e7\u00f5es dos n\u00f3s (marcados com losangos) podem ser obtidas na figura. As oito especifica\u00e7\u00f5es deste sistema s\u00e3o: P1=250bar, P4=10bar, P6=P8=1bar, W2=0Kg/s, W3=0Kg/s, W5=0Kg/s, w7=200Kg/s. As vari\u00e1veis de entrada (u) s\u00e3o um subconjunto das especifica\u00e7\u00f5es sujeitas a comportamento din\u00e2mico (u1=P1, u2=P4, u3=W7). As entradas s\u00e3o produzidas por geradores de s\u00e9ries temporais que superp\u00f5em ru\u00eddo pseudo-rand\u00f4mico aos calores nominais de P1, P4 e W7. As amplitudes dos ru\u00eddos s\u00e3o limitadas a 10% dos valores nominais, sendo adotado 70% de probabilidade do sinal (t + 1) repetir o valor do sinal (t). Estes geradores de entrada emulam o\ncomportamento caracter\u00edstico de sistemas deste tipo, impulsionados por m\u00e1quinas alternativas ou rotativas. Cabe lembrar que o modelo do sistema \u00e9 extremamente simples, consistindo da resposta pseudo-estacion\u00e1ria das equa\u00e7\u00f5es de balan\u00e7o material e de energia mec\u00e2nica \u00e0s entradas acima descritas. Apesar de simples, o desempenho geral do modelo \u00e9 satisfat\u00f3rio para aplica\u00e7\u00e3o de metodologias de detec\u00e7\u00e3o/localiza\u00e7\u00e3o de vazamentos via uma abordagem em s\u00e9ries temporais. As vari\u00e1veis de sa\u00edda (y) do sistema foram selecionadas como y1=P2, y2=P3, y3=P4 e y4=P7. Sobre as s\u00e9ries destas vari\u00e1veis s\u00e3o aplicados os procedimentos de detec\u00e7\u00e3o/localiza\u00e7\u00e3o de eventos de vazamento.\nFig. 1 - Rede b\u00e1sica.\nFig. 1 - Basic system.\nFig. 2 - Rede de escoamento com tr\u00eas eventos em 1000 instantes.\nFig. 2 - Three events flow system at 1,000 moments.\nFig. 3 - S\u00e9ries temporais de quatro press\u00f5es da rede com tr\u00eas eventos.\nFig. 3 - Four pressure time series of three events system.\n\u2022 Rede Perturbada por tr\u00eas Eventos de Vazamento\nA rede b\u00e1sica ser\u00e1 simulada ao longo de 1000 instantes com incid\u00eancia de tr\u00eas eventos (c\u00f3digo de sistema alterado: CAD3FS1). Na tabela I apresentam-se dados dos eventos que podem ser identificados na figura 2.\nTABELA I EVENTOS IMPOSTOS \u00c0 REDE\nTABLE I\nEVENTS SUBMITTED TO SYSTEM\nEVENTO\tTUBO\tDI\u00c2METRO (mm)\tPOSI\u00c7\u00c3O %\tINSTANTE PARTIDA (E)\tINSTANTE DESLIGAMENTO (D)\n1\t2\t10\t40\t250\t930\n2\t4\t13\t60\t550\t960\n3\t8\t10\t80\t700\t985\nO comportamento das vari\u00e1veis de sa\u00edda de CAD3F$1 \u00e9 mostrado na figura 3, onde est\u00e3o assinalados os instantes de incid\u00eancia (E) e de desligamento (D) dos eventos.\n\u2022 Detector ARX-MIMO 4x3\nAs s\u00e9ries de registros dos tr\u00eas valores \u201cu\u201d e dos quatro valores \u201cy\u201d foram utilizadas para treinar preditor ARX-MIMO 4 x 3 que, quando devidamente utilizado, pode funcionar como detector de eventos de alta sensibilidade. Esta sensibilidade estar\u00e1 garantida desde que os intervalos de treinamento do detector n\u00e3o contenham partida/desligamento de eventos. Assim, a incid\u00eancia de um ou mais eventos ser\u00e1 fortemente evidenciada quando o detector est\u00e1 monitorando o sistema ap\u00f3s o encerramento de uma sess\u00e3o de treino. O c\u00f3digo do detector gerado \u00e9 Det1. Sua janela de treino cont\u00e9m 90 instantes, sendo seguida de janela de trabalho de 210 instantes. Estas janelas alternam-se at\u00e9 totaliza\u00e7\u00e3o da s\u00e9rie de CAD3FS1. O Filtro \u201cAR\u201d e o Filtro \u201cX\u201d t\u00eam ambos ordem tr\u00eas. Det1 foi gerado pelo procedimento descrito no item 3 e Ap\u00eandice 2. As figuras 4-a,b,c,d evidenciam a sensibilidade de Det1 atuando sobre CAD3FS1. Os instantes de incid\u00eancia de eventos e de seus desligamentos s\u00e3o assinalados com \u201cE\u201d e \u201cD\u201d. Os instantes de in\u00edcio de treino s\u00e3o marcados com\nFig. 4 - Detec\u00e7\u00e3o de vazamentos na rede de tr\u00eas eventos com detector Det1. Fig 4 - Leak detection in three events system using Det1 detector.\nA detec\u00e7\u00e3o \u00e9 marcada por forte disparidade entre a vari\u00e1vel de processo sob acompanhamento (y) e a respectiva predi\u00e7\u00e3o gerada pelo ARX-MIMO. Esta diverg\u00eancia cessar\u00e1 quando o detector for convocado para novo treino, quando ent\u00e3o estar\u00e1 apto para nova detec\u00e7\u00e3o (fig. 4).\n\u2022 Rede Multi-eventos para Treinamento de Localizador\nA localiza\u00e7\u00e3o e quantifica\u00e7\u00e3o de um vazamento ser\u00e3o tentadas por preditor ARX-MIMO-DUAL 4 x 3 x nz, ap\u00f3s a detec\u00e7\u00e3o do evento obtida por Deti (item 3). No entanto, o localizador necessita de treino sobre a manifesta\u00e7\u00e3o de eventos. Adotou-se, aqui, que o grupo de entradas \u201cz\u201d ser\u00e1 formado por dois sinais num\u00e9ricos caracterizadores de evento por tubo em considera\u00e7\u00e3o, sendo seis os tubos desta classe, respectivamente, 2, 4, 5, 6, 7 e 8. Sendo assim, o feixe de entradas \u201dz\u201d cont\u00e9m 12 componentes (nz = 12). Os sinais de caracteriza\u00e7\u00e3o adotados por tubo est\u00e3o na equa\u00e7\u00e3o i3. Note-se que zD e zL s\u00e3o independentes e se anulam. Quando n\u00e3o existir furos, os sinais \u201cy\u201d e \u201cu\u201d do localizador s\u00e3o os mesmos dos detectores. Prop\u00f5e-se treinar o localizador com extensa seq\u00fc\u00eancia de eventos sobre os seis tubos citados acima. No caso, s\u00e3o formados tr\u00eas eventos por tubo, com di\u00e2metro aleat\u00f3rio entre 5 mm e 20 mm, e posi\u00e7\u00f5es equi-espa\u00e7adas com corrup\u00e7\u00e3o aleat\u00f3ria. Os eventos foram sorteados seq\u00fcencialmente por tubo, com dura\u00e7\u00e3o de aproximadamente 100 instantes cada e superposi\u00e7\u00e3o entre vizinhos de = 20%, de modo que a rede permanece, ora sob a a\u00e7\u00e3o de um evento, ora sob a a\u00e7\u00e3o de dois eventos. O programa de eventos foi lan\u00e7ado ap\u00f3s 100 instantes de opera\u00e7\u00e3o normal e, ap\u00f3s encerrado, tamb\u00e9m seguido por 100 instantes normais. Este procedimento tamb\u00e9m gerou a cadeia temporal CADM6x3S1 (ou CADEIA 1), com 2 150 instantes. A rede alterada pelos eventos \u00e9 mostrada na figura 5. Os valores zD e zL gerados s\u00e3o vistos na figura 6 ao longo do tempo. As quatro sa\u00eddas do processo sob CADM6x3S1 s\u00e3o mostrados na figura 7 contra o tempo.\n\u2022 Treino do Localizador\nFoi gerado o localizador LOCM6x3S1 com os dados de CADM6x3S1 pelo procedimento do item 3 (Ap\u00eandices 3 e 4). Percebe-se a sensibilidade de LOCM6x3S1 ao feixe \u201cz\u201d pela figura 8. A ader\u00eancia de LOCM6x3S1 a CADM6x3S1 \u00e9 de qualidade inferior quando \u201cz\u201d \u00e9 enviado como nulo (fig. 8-a,b,c), onde 8-c apresenta histograma de res\u00edduos de ader\u00eancia indicando 4 000 res\u00edduos de pequeno tamanho. Quando o feixe \u201cz\u201d \u00e9 preenchido corretamente com os valores zD e zL de CADM6x3S1 (fig. 6), a ader\u00eancia de LOCM6x3S1 cresce (figs. 8-d,e,f), onde 8-f aponta 5 000 res\u00edduos de pequeno valor. Apesar disto, a sensibilidade do localizador aos sinais \u201cz\u201d n\u00e3o parece grande, o que implicar\u00e1 em menor poder de localiza\u00e7\u00e3o de eventos. Isto pode ser conseq\u00fc\u00eancia das fun\u00e7\u00f5es propostas para zD e zL que, em princ\u00edpio, podem ser melhoradas.\n\u2022 Localiza\u00e7\u00e3o e Quantifica\u00e7\u00e3o de Eventos\nAp\u00f3s a prepara\u00e7\u00e3o do localizador com a bateria de eventos simulados, volta-se \u00e0 cadeia de tr\u00eas eventos e 1 000 instantes sobre a rede original: CAD3FS1. A a\u00e7\u00e3o dp detector Deti sobre CAD3FS1 revela os eventos (E1, E2, E3) mostrados na figura 9. LOCM6x3S1 ser\u00e1 utilizado para localizar E1, que, como visto, ocorreu sobre o tubo 2 com DF = 10 mm, LF/L = 40%.\nFig. 5 - Rede de treinamento do localizador com 6 X 3 eventos em 2 150 instantes.\nFig. 5 - Localizer training system with 6 x 3 events at 2,150 moments.\nEntradas de Sinais de Furos (Tipo1)(T= 2150)\nFig. 6 - Modelo proposto para sinais de furos na rede de 6 X 3 eventos.\nFig. 6 - Suggested model for signs of holes in 6 x 3 events system.\nFig. 7 - S\u00e9ries temporais de quatro press\u00f5es da rede com 6 X 3 eventos.\nFig. 7 - Four pressure time series of 6 x 3 events system.\n\u00c9 feito extrato de 300 instantes ao redor de Eb em CAD3FS1. Este extrato \u00e9 submetido a LOCM6x3S1 que procurar\u00e1 maximizar sua ader\u00eancia ao extrato manipulando as entradas (zD , zL) de cada um de seus tubos de treino (ao todo seis). Isto implicar\u00e1 na minimiza\u00e7\u00e3o dos quadrados dos res\u00edduos gerados entre a predi\u00e7\u00e3o de LOCM6x3S1 e os valores no extrato ao redor de Eb para zD , zL de cada tubo de treino. O par (zD , zL) que obtiver melhor ader\u00eancia de LOCM6x3S1 evidencia: (1) o tubo da ocorr\u00eancia; (2) seu di\u00e2metro de furo, por zD; (3) sua posi\u00e7\u00e3o aproximada, por zL.\nFig. 8 - Sensibilidade do localizador ap\u00f3s treino com rede 6 X 3 eventos.\nFig. 8 - Localizer sensitivity after training with 6 x 3 events system.\nNa figura 10 s\u00e3o apresentados os resultados desta otimiza\u00e7\u00e3o para cada um dos tubos de treino, sendo gerada na tela de resultados do sistema desenvolvido. A otimiza\u00e7\u00e3o para o tubo dois foi a mais bem sucedida, sendo estimados DF = 13,7 mm, LF /L = 27,3%, com fun\u00e7\u00e3o-objetivo (FOB) = 5674,8. Na figura 11- a, b, c, d, e, f consolidam-se as otimiza\u00e7\u00f5es para vari\u00e1veis (zD , zL) dos seis tubos de treino, onde os histogramas referem-se \u00e0s distribui\u00e7\u00f5es de res\u00edduos em cada caso; \u201cyR\u201d, \u201cyPR\u201d referem-se ao extrato \u201cy\u201d e os respectivos preditores. Tamb\u00e9m s\u00e3o apresentados zD , zL ao longo da busca (feita com m\u00e9todo SIMPLEX).\nFig. 9 - Detec\u00e7\u00e3o de vazamentos com Det1 na rede de tr\u00eas eventos.\nFig. 9 - Leak detection using Det1 in three events system.\nFig. 10 - Resumo das buscas de localiza\u00e7\u00e3o e quantifica\u00e7\u00e3o de vazamentos relativas ao primeiro evento da rede de tr\u00eas eventos.\nFig .10 - Summary of the localization and estimation searches of leaks associated with the first event in the three events system.\nOtimiza\u00e7\u00e3o Tubo 6\n6300\nO 6200\n6150\n6100\n6050\n5\t10\n\u25a0 \u00ed.\n100\n80\n60\n40\nFig. 11 - Resultados individualizados da localiza\u00e7\u00e3o e quantifica\u00e7\u00e3o de vazamentos relativos ao primeiro evento da rede de tr\u00eas eventos.\nFig. 11 - Individual results of the localization and estimation of leaks associated with the first event in the three events system.\n5.\tCONCLUS\u00d5ES\nApresentou-se uma metodologia para detec\u00e7\u00e3o, localiza\u00e7\u00e3o e quantifica\u00e7\u00e3o de vazamentos em tempo real para redes de escoamento incompress\u00edvel. A metodologia \u00e9 baseada em s\u00e9ries temporais de processo e em preditores ARX-MIMO.\nEstruturas ARX-MIMO mostraram-se excelentes como detectores e eventos a partir da discrep\u00e2ncia entre valores de processo e as respectivas predi\u00e7\u00f5es.\nEstruturas ARX-MIMO expandidas com um filtro de entradas duais foram elaboradas para cursar o caminho inverso, isto \u00e9, ap\u00f3s a detec\u00e7\u00e3o do evento, determinar em qual tubo e que posi\u00e7\u00e3o e di\u00e2metro caracterizam o vazamento. Os resultados s\u00e3o promissores, embora demandem ainda ajustes para aumento de sensibilidade.\nREFER\u00caNCIAS BIBLIOGR\u00c1FICAS\n(1)\t. MEDEIROS, J., L.; ARA\u00daJO, O. \u201cIdentifica\u00e7\u00e3o de Processos: O Uso de Dados para Modelagem de\nProcessos\u201d, Apostila de Curso de Identifica\u00e7\u00e3o de Processos, Escola de Qu\u00edmica da UFRJ (2000).\n(2)\t. MURKHEJEE, J.; NARASIMHAN, S. \u201cLeak Detection in Networks of Pipelines by the Generalized\nLikelihood Ratio Method\u201d, Ind. Eng. Chem. Resa., 35, 1889-1893 (1996).\n(3)\t. BAGASEWICZ, M.; JIANG, Q. \u201cGross Error Modeling and Detection in Plant Linear Dynamic\nReconciliation\u201d, Computers and Chemical Engineering, 22 (12), 1789-1809 (1998).\n(4)\t. COELHO, R. M. L.; MEDEIROS, J. L. \u201cDetec\u00e7\u00e3o de Vazamento em Redes de Escoamento\nIncompress\u00edvel via Reconcilia\u00e7\u00e3o N\u00e3o-Linear\u201d. Anais do II ENPROMER - II Congresso de Engenharia de Processos do Mercosul, Outubro de 1999, Florian\u00f3polis, Brasil (1999).\n(5)\t. GEIGER, G.; GREGORITZA, W.; MATKO, D. \u201cLeak Detection and Localisation in Pipes and\nPipelines\u201d. European Symposium on Computer Aided Process Engineering - 10, Ed; S. Pierucci, 781786 (2000).\n(6)\t. BOX, G.; JENKINS, G.; REINSEL, C. \u201cTime Series Analysis, Forecasting and Control\u201d, Prentice Hall\n(1994).\nAP\u00caNDICE 1\nCOLE\u00c7\u00c3O MATRICIAL PARA TREINAMENTO DOS PREDITORES ARX\nAs s\u00e9ries temporais s\u00e3o organizadas matricialmente:\nU =\nu (t - (m -1))\nM\nu (t)\nM\nu (t + N -1)\n(N + m-1 x nu)\ny (t - (m -1))\nM\nY = y (t)\n(N + m-1 x ny)\nM\ny (t + N -1)\ny \u2018(t+1)\t\ty (t +1)\nM\t\tM\ny'(t)\t\ty (t)\nM\t\tM\n_ yt (t+n )_\t\t_ y (t+n )_\n(N x ny)\nonde:\nu (t), y(t) s\u00e3o os vetores de entrada (nu x 1) e de sa\u00eddas (ny x 1) do processo. Considera-se a predi\u00e7\u00e3o da resposta \u201ci\u201d, yi(t) (i =1... ny). Ser\u00e1, portanto, necess\u00e1rio operar com as linhas \u201ci\u201dde B...,Bm,A,...An \u2022 Sejam AA e Bk as linhas \u201ci\u201d de Ak e . Assim por (1.2), tem-se:\ny(t +1) =\tu (t) +... + Bm, u (t - m +1) - Ay(t) -... - An y(t - n +1)\nM\t(1.1)\ny(t+n )=Bmu(t+n -1)+...+Bmtu(t+n -m) - Am^+n - o -... - Amy (t+n -n)\nSejam:\nbkij : elemento ij de B^ akij : elemento ij de A^ uj(t), yj(t) : elemento j de\tu(t) e y(t)\nAssim:\nny\n\u2022\u2022_=anijyj(t - (n _ 1))\ny i\nnu\tnu\tny\n(t + 1) =\tj (t) + ... + J=bmiju j(t - (m -1)) - = aj j(t) - \u2022\nnu\n]= bmiju j (t + N - m)) -\nny X j=1\na1ijy j(t+N -1) _ \u2022\nny\n.. - X anijy j(t + N - n)) j=1\nEscrevendo a coluna i de Y(t) como:\ny t (t+1)\nY(t) =\n(N x 1)\ny i (t+n )\nas equa\u00e7\u00f5es anteriores tornam-se:\nnu\t\tu j(t)\t\tu j (t - (m -1))\nX j=1\tb1ij\tu j (t + N -1)\t+...+ bmij\tu j (t + N - m)\nny\t\tyj\u00ab)\t\tyj(t -(n -1))\nY \u00ed j=1\ta1ij\t}j (t + N - 1)\t+...+ amij\ty j (t + N - n)\n(1.2)\nAnalogamente, escreve-se a coluna j de Ue Y como:\n\tut (t - (m -1))\t\tyt (t -(n -1))\nUj =\t\t(N+m-1 x 1); Yj =\t\n\tut (t + N -1)\t\ty&lt;(t+n -1)\n(N+n-1 x 1)\nS\u00e3o definidos os seletores esparsos:\nS!,..., Sm ;[S, ]: Nx( N + m -1) $ ,...,$ ;[$ ]:Nx(N + n-1) =1\t=n =k\nN + m - 1\nEstes seletores garantem:\nuj(t)\nu(t + N -1)\n= [S1 ]Uj\ny()\ny(t+n -1)\n= [ $1 li.\nu(t - (m -1))\nuj(t + N - m)\n=[S ]Uj ;\n*- =m \u2014J\ny (t -(n -1))\ny}(t + N - n)\n= [$ ]Yj\n= n J\nAssim, (1.2) torna-se:\nA m\tnu\tn\tny\nYi -Z S- 1Z Ujbkij -Z [$ k 1Z Yjonj k=1\tj=1\tk=1\tj=1\n(1.3)\nou ainda:\nN + n - 1\nJ\nA m\tn\nYi -Z [\u00a3k lUBki + Z [$k li-\t(1.4)\nk=1\tk=1\nDefine-se a matriz (Nx (nx * ny + m* nu)):\nX = [- $1y ... - $nY\ts1u... SmUJ\ne o vetor de par\u00e2metros do ARX-MIMO para gera\u00e7\u00e3o da predi\u00e7\u00e3o i:\n0i ( (nx * ny + m* nu) x 1), dado por sua vez por: = [AH - AtnJB11 -B!m]\n<-------->\na\u00cd\n\n=mr\n-->\nAssim, tem-se a rela\u00e7\u00e3o de predi\u00e7\u00e3o da sa\u00edda i:\nY = X],, e_i\nNo formato de estima\u00e7\u00e3o de par\u00e2metros:\nObserva\u00e7\u00f5es:\nai\nbi\n(1.5)\nb _\nY = [x] , (i=1,---,ny)\n(1.6)\na)\tmatriz X \u00e9 \u00fanica para todas as sa\u00eddas do ARX-MIMO;\nb)\tcada sa\u00edda (i=1,...,ny) diferencia-se apenas pelo vetor de par\u00e2metros correspondentes;\nc)\tidentifica\u00e7\u00f5es / estima\u00e7\u00f5es podem ser feitas separadamente para cada sa\u00edda do ARX, incluindo estimativas de incertezas e intervalos de confian\u00e7a.\nAP\u00caNDICE 2\nBASE ESTAT\u00cdSTICA DO PREDITOR ARX-MIMO\n\u2022 Caracteriza\u00e7\u00e3o da Estima\u00e7\u00e3o\n(i)\t*\u00cai \u00e9 normal, logo 0i como fun\u00e7\u00e3o linear de tamb\u00e9m \u00e9 normal;\n(ii)\t\u00ea_i \u00e9 estimativa n\u00e3o-tendenciosa: E(\u00d2i) = [X WyX]X WiE($j) sendo\nE(\u2014i) =\t= XPi, tem-se que:\nE( \u00ea i) = e_ i\n(2.1)\n(iii)\n0i \u00e9 estimativa coerente:\nCOV(\u00ea_t) = E[qi -\u00ea.i)(\u00ea.i -\u00ea.t)t\ncom a equa\u00e7\u00e3o 12 escreve-se:\n0i ~Q_i = [XWiX] 1XWj^-i ~^i), resultando, com a equa\u00e7\u00e3o 7, em COV(\u00d2i) = ^ \\XWX]\t(2.2)\n(2.2)\ntransparecendo a coer\u00eancia quando N .\n(iv)\nComportamento de A i:\nAi = (\u00ea i -\u00ea.i/ [COV(\u00eai)]- i -\u00ea i)\n(2.3)\nOra, COV (Oi) \u00e9 sim\u00e9trica positiva-definida podendo ser fatorada segundo:\ncov(\u00eai) = peX => [ov(\u00d2j)]1\n(2.4)\nonde e \u00e9 diagonal de autovalores positivos e P \u00e9 ortogonal de autovalores ortonormais. Assim:\na i = (\u00ea i -\u00ea. i) tpeT 1/2e_ 1/2 Pt (\u00ea i -\u00ea. i)\nA i =\t;\tz_i =e~1/2 Pt (\u00eai - )\n(2.5)\n(2.6)\nMas zi \u00e9 combina\u00e7\u00e3o de normais, logo \u00e9 normal;\nE (z) = 0\nCOV (zj) = E () = I\nPortanto, cada componente de z_i segue distribui\u00e7\u00e3o normal padronizada sem correla\u00e7\u00e3o entre eles. Disto resulta que Ai segue, por (2.6), distribui\u00e7\u00e3o c2 com nx*ny + m*nu graus de liberdade:\nA i ~>C\n2\nn = n*ny+m*nu\n(2.7)\n\u2022 Estima\u00e7\u00e3o de_ 1j: Xj (sa\u00edda i)\n\u00cd i -h i = ti i - Li )+ Y i ~\u2019li )\nonde, com: R. = 1zW. 1\n\u2019\t=z\tz=z\n(2.8)\nOra, usando-se z- ~h)=\tz- -0z-) verifica-se que o \u00faltimo termo \u00e0 direita em (2.8) \u00e9 nulo devido \u00e0\nequa\u00e7\u00e3o de ponto estacion\u00e1rio (equa\u00e7\u00e3o 11). Com a mesma substitui\u00e7\u00e3o, verifica-se que o segundo termo \u00e0 direita \u00e9 Ai (2.2 e 2.3). Finalmente, o termo \u00e0 esquerda segue distribui\u00e7\u00e3o C com N graus de liberdade (via hip\u00f3tese (ii) da estima\u00e7\u00e3o, equa\u00e7\u00e3o 7 e \u00e1lgebra similar \u00e0 usada em (2.3) a (2.7). Portanto, a equa\u00e7\u00e3o 2.8 traduz-se em:\nCn = SR\n(N - n * ny - m * nu)\n+ Cn = n*ny+m*nu\n(2.9)\n1i\nonde:\n1\nS2 =\nSR =\nN - n * ny - m * nu\n(Oi - Y )tWi\ti - Y?i )t\n(2.10)\n2\nOra, pelo teorema da Parti\u00e7\u00e3o c resulta que o primeiro termo \u00e0 direita \u00e9:\nS2 (N - n * ny - m * nu) Rz\n\u25a0>C2 Ar *\t*\t(2.11)\nA'V=N -n*ny - m*nu'\t'\n1i\nou\n\n1i\nSR\n\\\nC2 AZ *\t*\t(2.12)\n'\u25a0v = N - n*ny - m*nu'\t'\nN - n * ny - m * nu )\nDando que\nE(S2 ) = 1z (2.13)\ni\n(\nVar (SR ) =\n21i2\nN - n * ny - m * nu \u00e8 /\n(2.14)\nAl\u00e9m de ser independente de z-.\n2\nEm outras palavras, S\n\u00e9 um estimador coerente e n\u00e3o-tendencioso para lj: li = S\nDisto resulta tamb\u00e9m que\nCO V (\u00d4 i)=sR\nXwix\n(2.15)\n2 R '\n\u2022 Regi\u00e3o de Confian\u00e7a de Par\u00e2metros Corretos para a Sa\u00edda i i\nAi = (9-q))[COV(\u00e8t)]-9-9) ^X2r=\u201e,\u201ey+m.nu P.I6)\nS2 (N - n * ny - m * nu)\nRX '\t2\nli\tAy= N - n*ny - m*nu\n2 Dada a independ\u00eancia entre estas quantidades, dada (2.2), e com o teorema F sobre a raz\u00e3o de vari\u00e1veis % , chega-se a:\n(9-9 z- )t [ X/W.X ]\" 1(9-\u00ed?i)\n------ -------i-------------> F(n * ny + m * nu,N -n * ny - m * nu) (2.17) S _ (n * ny + m * nu)\nRi\nIsto \u00e9, a raz\u00e3o \u00e0 esquerda segue distribui\u00e7\u00e3o F com graus de liberdade indicados.\nSeja f 1 _ a a abscissa Fisher obtida para a distribui\u00e7\u00e3o F tal que a probabilidade dela ser ultrapassada \u00e9 de Prob(h>&lt;&amp;1_a) = (1 -a)*100%,\ta = 0.1,0.05,0.01,... ou menos. Assim:\n(\u00d4.i -e.i/[X^w.xr\\\u00eai -e_i) &lt;sR (n * ny + m * nu)f1_a (2.18)\nregi\u00e3o de confian\u00e7a para com probabilidade (1 -a)*100% .\n\u2022 Regi\u00e3o de Confian\u00e7a para Predi\u00e7\u00f5es Corretas na Janela de Treinamento do ARX-MIMO\nCom, as equa\u00e7\u00f5es 1.6; 2.1 e 5\nE(Yi) = X\u00d4i =h . (2.19)\nPortanto:\nCOV(Yi) = E[(Yi -hi)(Yi -hi)](2.20)\nCom (Y_i ~hi) = X(9 i - 9i) chega-se a:\nCOV(Yi) =li[XtWiX]~1 Xf (2.21)\nonde:\tCOV (Is i) =liX[XtWiX] 1 Xt (2.22)\nOra, por (1.6), Y_i \u00e9 fun\u00e7\u00e3o linear de Qj cujo comportamento \u00e9 normal. Logo, Y_i tamb\u00e9m tem comportamento normal. Admitindo pequena ou nenhuma correla\u00e7\u00e3o de Y_j, tem-se com (2.19) e (2.21):\nYik\tN(hik,liXk- 1[XtWiX] 1 Xk\nonde:\nN(a,b) representa comportamento normal com m\u00e9dia \u201ca\u201d e vari\u00e2ncia \u201cb\u201d; Xk \u00e9 a k-\u00e9sima linha de X; e\nYik \u00e9 o k-\u00e9sima componente de Yz-, isto \u00e9:\nYik = yi (t + k )(ver (1.1). Tem-se assim:\n___________Yik hik____________\niXkt [ X^X ]-1 Xk\nN(0i ,1)\nS2 * (N - n * ny - m * nu)\n2\nn= N - n*ny - m*nu\n\n2 * Pela independ\u00eancia entre S\u201e e 6 r7\ti, e por (1.6), tem-se independ\u00eancia entre os dois termos \u00e0 esquerda acima.\n2\nCom o Teorema t, sobre a raz\u00e3o da vari\u00e1vel normal padronizada e raiz quadrada de vari\u00e1vel X , chega-se a:\nt=\n\u25a0\u00bb tr=n-n*ny-m*nu (2.23)\nIsto \u00e9, a raz\u00e3o acima segue distribui\u00e7\u00e3o t com grau de liberdade indicado.\nSeja t1-a/2 a abcissa obtida na distribui\u00e7\u00e3o tal que a probabilidade dela ser ultrapassada \u00e9 de a/2*100% (a=0,05; 0,01; etc). Assim, com (2.23)\nYik\tt1-a/2^SRFik -Vik -Yik + t1-a/2^SRFik (2.24)\nque \u00e9 o intervalo de confian\u00e7a para Vikcom probabilidade (1-a)*100%, onde:\nFik = Xkt [XtWiX] 1 Xk (2.25)\nou, equivalentemente,\nY (t + k)-t1_a/^ SRFik&lt;Vi (t + k) &lt;Y (t + k) + t1_a/2^sR,Fik (2.26)\nque \u00e9 o intervalo de confian\u00e7a para predi\u00e7\u00e3o correta da sa\u00edda \u201ci\u201d no instante t+k, (1 &lt;k &lt;N),na janela de treinamento, com probabilidade (1 -a)*100% .\n\u2022 Regi\u00e3o de Confian\u00e7a para Predi\u00e7\u00f5es Corretas Fora da Janela de Treinamento do ARX-MIMO\nAp\u00f3s estima\u00e7\u00e3o de 0_j (i=1...ny), o preditor operar\u00e1 fora da janela de treinamento segundo equa\u00e7\u00e3o de predi\u00e7\u00e3o da forma (5). Para predizer sa\u00edda \u201ci\u201d em instante k+1, tem-se:\nY (k +1) = Zfk 0i (2.27)\nZ\nt _ k _\n-Y (k) -Yt (k -1).... - Yf (k - (n - 1)Ut (k)Ut (k -1)...U(k - (m -1))\n(2.28)\n(k+1>t+N)\nAssim, dada a normalidade de (z- , tem-se que Yj (k +1) tamb\u00e9m segue comportamento normal, dando:\nE(fi (k +1)) _ Zfk \u00d4i _ h. (k +1) (2.29) var(Y i(K+1) _ E {Zk (i-e ii-e i Z\nVAR(Yi (K +1) _ ZkCOV(i ')k\nVAR(Y i (K + 1) _l iZfk\nA partir disto, pode-se escrever analogamente ao caso anterior\nY (k +1) -hi (k +1) ^liZk [ XtWiX ]-1 Zk\nN(0,1)\nS2 (N - n * ny - m * nu)\nRt\t2\nli\t/-\\>_ N - n*ny - m*nu\nPela independ\u00eancia entre os termos \u00e0 esquerda, e seguindo processo id\u00eantico ao anterior via teorema t, chega-se \u00e0 express\u00e3o do intervalo de confian\u00e7a para a predi\u00e7\u00e3o correta da resposta\u201di\u201d em instante k+1 (k+1>t+N) com probabilidade (1 -a)100% (a _ 0.05,0.01, etc):\nYi (k +1) - t1_a /^ SR F*&lt;h i (k +1) &lt;Yi (k +1) +\t/^ sR F* (2.31)\n(k+1>t+N)\nonde:\n* t\n\u25a0 _ Zk\nt 1-1\nXtWX\nZk (2.32)\nYi (k +1) _ Zfk(i (2.33)\n(t\\-a /2 exatamente a mesma da f\u00f3rmula (2.26))\nAP\u00caNDICE 3\nCOLE\u00c7\u00c3O MATRICIAL PARA TREINAMENTO DE PREDITORES ARX-DUAL\n\u2022 Cole\u00e7\u00f5es Matriciais para Treinamento\nU,Y, Y,id\u00eanticos \u00e0s anteriores.\n\u00c3 (t - p +1)\nJ (t)\nZ =\n(N+p-1 x nz)\nzt (t + N -1)\nProcedendo exatamente conforme preditor ARX-MIMO, chega-se a:\ny. (t +1) = Bi tu(t +1) +... + Bm^ u(t \u2014 m +1) +\nC tz(t) + ...C\ttz(t -p +1) +\n=1\t=Pi\nA1 ty(t) -... - An fy(t -n+1)\ny i (t + N) = B1 t u(t + N -1) +... + Bmt u(t + N - m) +\nCA tz(t + N \u2014 1) + ...C tz(t + N \u2014 p) + =1-\t=Pi\nA1 ty(t + N -1) -... - An ty(t + N - n) li \u2014\trlj \u2014\n(3.1)\nDefinindo-se:\nY\ti : U J :\nY\tJ : \u00f4 j :\nZ J :\nColuna i de T , com predi\u00e7\u00f5es para a sa\u00edda i\nColuna j de U\nColuna j de Y\nColuna j de O, com medi\u00e7\u00f5es para sa\u00edda i\nColuna j de Z\ny i(t +1)\t\tui (t - (m -1))\t\tyj (t - (n -1))\n\t, U =\t\t, Y , =\t\n\t\u2019 \u20141\t\t\u2019-J\t\n_ yi (t+n ')\t\tu- (t + N -1)\t\tu j (t + N -1)\nyi (t+1)\t\tzj (t - (m -1))\n\t,Z =\t\n\t\u2019-j\t\n_ yi (t+n )_\t\tzj (t + N -1)\ne os seletores seguintes (esparsos):\nS,,...,S ;[S, ]: Nx(N + m -1) =1\u2019\t=m =k\n$,,...,$ ;[$.]: Nx(N + n -1)\n=1\t=n =k\nM1,...,Mp;[Mk]: Nx(N + p -1) (Sk, $ k id\u00eanticos aos anteriores)\nTem-se assim:\nN (K=1,..p)\nm\tp\tn\nYi = L[\u00a3k ]UBk. + S[Mk ]Z\u00a3k - L[$k ]YAk.&lt;3-2) k=1\t1 k=1\t1 k=1\t1\nonde:\nbk,\u2018-\tlinha i de\nCk\u2018:\tlinha i de C, =k\nAk\u2018:\tlinha i de A^\nDefine-se a matriz (N x n * ny + m*nu + p*nz):\nX = [-$1y\t... -$nY S1U... SmU\nM.Z... M Z](3.3) 1m\ne o novo vetor de par\u00e2metros do ARX-MIMO-D para gera\u00e7\u00e3o da sa\u00edda i: 0 i\n0i :\t(n*ny + m*nu + p*nz) x 1\n01 = [At ... At Bt ... Bt\tCt ... Ct ](3.4)\n-z\tL=1i\t=nj\t= 1i\t=mi\t=1i\t=pi\n<-------->\t<--------->\t<---------->\n\ntem-se a rela\u00e7\u00e3o de predi\u00e7\u00e3o para a sa\u00edda i:\nd.\nai\nY =\t]i; qi = b_i (3.5)\nL c-i J\nNo formato da estima\u00e7\u00e3o de par\u00e2metros:\nY =\t&amp;, (i=1,...,ny)(3.6)\nSeguem-se resultados an\u00e1logos para a nova estima\u00e7\u00e3o. Matrizes R W s\u00e3o id\u00eanticas \u00e0s anteriores. tem a mesma defini\u00e7\u00e3o anterior, h ; \u00e9 novamente o valor correto de O, e de Yi \u25a0\nAP\u00caNDICE 4\nBASE ESTAT\u00cdSTICA DOS PREDITORES ARX-MIMO-DUAL\n\u2022 Estima\u00e7\u00e3o de Par\u00e2metros para a Sa\u00edda \u201ci\u201d do ARX-MIMO-D\nResultam:\n? r t\ti-1\nq? i = xtWiX\ni (4.1)\nI-1\n(4.2)\n\u2014i\ncov(\u00f3i) = ii xtWiX\nS1 =------------1-----------(Oi - Yi )tW. (Oi -Yi) (4.3)\nS2 =------------1-----------C2\t*\t*\t*\t(4.4)\nRi\tN - n * ny - m * nu - p * nz N~n*ny~m*nu~P*nz\n(0i -d_i) &lt;SR (N - n * ny - m * nu - p * nz)f 1_a (4.5)\n(q i -0 i) xlwix\n(f^_a abscissa da distribui\u00e7\u00e3o F( n * ny + m * nu + p * nz , N - n * ny - m * nu - p * nz)) ?\tr t\t4-1\nCOV(Yi) = 1iXXtW.X\nX (4.6)\n\u2022 Intervalos de Confian\u00e7a para Predi\u00e7\u00f5es Corretas na Janela de Treinamento\n1?ik : h ik :\tPredi\u00e7\u00e3o yi (t + k) Valor correto hi (t + k) Yik ~ t1-a/2^SRFik ~hik - Yik + t1-a/2^SRFik (4.7) Fik = Xkt [xtwix] XXk (4.8)\nonde:\nXkl:\tLinha k de X\nt1-a /2:\tAbscissa da distribui\u00e7\u00e3o tv = N - n * ny - m * nu - p * nz\n\u2022 Intervalos de Confian\u00e7a para Predi\u00e7\u00f5es Corretas Fora da Janela de Treino do ARX-MIMO-D\ny(k +1):\tpredi\u00e7\u00e3o da sa\u00edda i em instante k+1 (k+1) > t+ N) y(k +1) = 40i (4.9) z\\ = [\u2014yt (k)... -yt(k - (n -1)) ut(k) ... ut(k -(m -1)) zt(k)... k\t-\t-\t(4.10) z (k - (p -1))]\nObt\u00e9m-se:\tyi(k +1) _ t1\u2014a/2^SRFik ~hi(k +1) - yi(k +1) +11\u2014a/2^SRFik (4.11)\nonde:\tk + 1 > t + N $\tt r t\t\"1 1 Fik = Zk [XW-X]\tZk (4.12) yi (k +1) = Z^i (4.13)\nAP\u00caNDICE 5\nMODELO DE REDE DE ESCOAMENTO INCOMPRESS\u00cdVEL PSEUDO-ESTACION\u00c1RIA\n\u2022\tN\u00famero de V\u00e9rtices: N\n\u2022\tN\u00famero de Arestas: m\n\u2022\tMatriz de Incid\u00eancia da Rede: M (N x M)\nMij = 1 se aresta j chega no v\u00e9rtice i\nMij = -1 se aresta j sai no v\u00e9rtice i\nMij = 0 se arestaj n\u00e3o contata o v\u00e9rtice i\n\u2022\tVetor de Vaz\u00f5es M\u00e1ssicas na Rede (m x 1): q\nqj > 0 se aresta j cont\u00e9m corrente no mesmo sentido da aresta\nqj &lt;0 se aresta j cont\u00e9m corrente no sentido oposto da aresta\n\u2022\tVetor de Vaz\u00f5es M\u00e1ssicas Nodais (Kg/s) indo para vindo do exterior (N x 1): w\nwi > 0 se v\u00e9rtice i recebe corrente externa\nwi &lt;0 se v\u00e9rtice i perde corrente externa\n\u2022\tVetor de Press\u00f5es Nodais (Pa = N/m2 = Kg/m.s2) (N x 1): P\n\u2022\tVetor de Cotas Verticais Nodais (m) (Nx 1): z\n\u2022\tVetor de Fatores de Atrito de Darcy das Arestas (m x 1): f\n\u2022\tVetor de Par\u00e2metros Hidr\u00e1ulicos de arestas (Kg.m)-1(m x 1):\n8PLj p2D2p2\nonde:\nLj: Comprimento(m) da aresta j\nD,: Di\u00e2metro(m) da aresta j p : Densidade (Kg/m3) do fuido\n\u2022\tGravidade (m/s2): g\n\u2022\tVetor de Reynolds de arestas (m x1):\nRe =\n4 \u2022 \\qj\\ p .d j m\n\u2022\tViscosidades (Kg/m.s) do fuido: p\n\u2022\tC\u00e1lculo do fator de atrito para aresta j\n1\n12\nfj = 8 \u2022\u00ed\n12\n(Equa\u00e7\u00e3o de Churchill (1977))\nsendo:\nAj =\u00ed\n\t\t\t\t\ty\n2.457 \u2022 ln\t\t\t1\t\t\n\t\t\t\t\t0.9\n\t0.27\te j\t+\t7\t\n\t\tDj \\ J )\t\tRe j \u00e8 J )\t)-\n>\n16\nBj =\n37530\nRe j\n16\n\u00a3j : rugosidade relativa (m) da aresta j\n\u2022 Equa\u00e7\u00f5es da rede\nM \u25a0 q + w = 0\nBalan\u00e7o material nodal (N x 1)\nM \u25a0 P+F(q) + p-g\u25a0 Mt \u25a0 z = 0\nBalan\u00e7o de energia mec\u00e2nica\nonde:\nFk(qk) = fk \u25a0 Kk \u25a0 |qk|\u2022 qk\nKk\n8 \u25a0 Lk p 2 Dkp\n(k=1,,,m)\ne\ntotal de equa\u00e7\u00f5es :\tN+m\nvari\u00e1veis : P q, w : 2N+m\nEspecifica\u00e7\u00f5es necess\u00e1rias : N (1 para cada v\u00e9rtice)\nSitua\u00e7\u00f5es :\ni.\tS\u00e3o dados wk (k=1,,,N) e um valor de press\u00e3o Pk .\nCalcular Pk (k=1,,,N) e qk (k=1,,,m)\nii,\tS\u00e3o dados Pk (k=1,,,N)\nCalcular wk (k=1,,,N) e qk (k=1,,,m)"}]}}}