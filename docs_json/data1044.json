{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-BT.04727"}, {"@name": "filename", "#text": "BTP_2002_45_2_07_Modelagem_dinamica.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "MODELAGEM DIN\u00c2MICA EM REDES DE ESCOAMENTO COMPRESS\u00cdVEL PARA APLICA\u00c7\u00d5ES \u00c0 DETEC\u00c7\u00c3O DE VAZAMENTOS EM TEMPO REAL\nDYNAMIC MODELING IN COMPRESSIBLE FLOW\nSYSTEMS FOR APPLICATION IN REAL TIME LEAK DETECTION\nMODELADO DIN\u00c1MICO EN REDES DE TRANSPORTE DE FLUJO COMPRESIBLE PARA APLICAR ENLA DETECCI\u00d3N DE P\u00c9RDIDAS EN TIEMPO REAL\nJoaquim Pamponet Pires Neto Laborat\u00f3rio SDV - Dutos Escola de Qu\u00edmica Universidade Federal do Rio de Janeiro (UFRJ) e-mail: joaquim@copene.com.br\nRESUMO\n\u00c9 not\u00e1vel a escassez de uma ferramenta computacional que elabore uma an\u00e1lise do comportamento transiente das vari\u00e1veis de processo num escoamento compress\u00edvel, principalmente em partidas e paradas de planta. A partir deste cen\u00e1rio, desenvolve-se, aqui, modelagem e simula\u00e7\u00e3o din\u00e2mica de redes de escoamento compress\u00edvel e apresenta-se uma proposta de metodologia computacional para detectar vazamentos em tempo real. O modelo fenomenol\u00f3gico est\u00e1 fundamentado nas equa\u00e7\u00f5es da continuidade e de momento em regime transiente. Considerou-se escoamento unidimensional e isentr\u00f3pico de g\u00e1s natural. O conjunto de equa\u00e7\u00f5es diferenciais \u00e9 resolvido com integra\u00e7\u00f5es num\u00e9ricas no tempo, via m\u00e9todos Runge-Kutta, ap\u00f3s aplica\u00e7\u00e3o do m\u00e9todo de elementos finitos no cont\u00ednuo espacial. A metodologia proposta para detec\u00e7\u00e3o de vazamentos tem como base modelo param\u00e9trico estoc\u00e1stico auto-regressivo. O procedimento consiste em gerar s\u00e9ries de dados de entrada e sa\u00edda transientes do processo, tais como press\u00f5es nodais e vaz\u00f5es de escoamento nos tubos, sob a ocorr\u00eancia de eventos programados pelo simulador din\u00e2mico e empreg\u00e1-las para treinamento de preditores MIMO em estrutura de modelo ARX permanentemente atualizados. A manifesta\u00e7\u00e3o de um vazamento \u00e9 detectada pelo afastamento instant\u00e2neo, estatisticamente v\u00e1lido, fora dos limites de confian\u00e7a, entre um conjunto de predi\u00e7\u00f5es e as medi\u00e7\u00f5es correspondentes do processo.\nABSTRACT\nIt is remarkable how there are hardly any computer tools that can build a transient behavioral analysis of process variables in a compressible flow, especially during starting and shutdown of plant. From this scenario, a modeling and dynamic simulation of compressible flow systems was built, and a computer method for detecting leaks in real time was presented. The phenomenon model is based on moment and continuity equations in transient basis. Unidimensional and isentropic natural gas flow was considered. The set of differential equations is solved through numerical integrations in time, using Runge-Kutta methods, after applying the finite elements method to spatial continuum. The suggested method for detection of leaks is based on the self-regressive stochastic parametric model. The procedure consist in generating process transient input and output data series, such as nodal pressures and flow rates in pipes, during the occurrence of the events programmed by the dynamic simulator and use them during training of IMO predictors in RX model structure, with constant\nupdate. The manifestation of a leak is detected by the instant deviation, statistically significant and beyond safety limits, between a group of predictions and the corresponding process measures.\nRESUMEN\nEs notable la escasez de una herramienta computacional que elabore un an\u00e1lisis del comportamiento transiente de las variables de proceso de un transporte de flujo compresible, principalmente en los aspectos asociados con las partidas y paradas de planta. A partir de este escenario, se desarrolla aqu\u00ed, el modelado y la simulaci\u00f3n din\u00e1mica de redes de transporte de flujo compresible y se presenta una propuesta de metodolog\u00eda computacional para detectar fugas o p\u00e9rdidas en tiempo real. El modelo fenomenol\u00f3gico est\u00e1 fundamentado en ecuaciones de continuidad y de momento en r\u00e9gimen transiente. Se consider\u00f3 un transporte de flujo unidimensional e isentr\u00f3pico de gas natural. El conjunto de ecuaciones diferenciales es resuelto con integraciones num\u00e9ricas en el tiempo, por medio de los m\u00e9todos de Runge-Kutta, despu\u00e9s de la aplicaci\u00f3n del m\u00e9todo de elementos finitos en el continuo espacial. La metodolog\u00eda propuesta para la detecci\u00f3n de fugas o p\u00e9rdidas se basa en el modelo param\u00e9trico estoc\u00e1stico autoregresivo. El procedimiento consiste en generar series de datos de entrada y salida transientes del proceso, tales como presiones nodales y caudales del flujo de descarga en los tubos, considerando la ocurrencia de eventos programados por el simulador din\u00e1mico y emplearlas en el entrenamiento de predictores MIMO en estructura de modelo ARX que son permanentemente actualizados. La manifestaci\u00f3n de una fuga o p\u00e9rdida es detectada por el distanciamiento instant\u00e1neo, estad\u00edsticamente significante, fuera de los limites de confianza, entre un conjunto de predicciones y las mediciones del proceso correspondientes.\nNOTA\u00c7\u00c3O\nS\tSe\u00e7\u00e3o transversal do tubo\n(m2)\nx\tPosi\u00e7\u00e3o axial do tubo\n(m)\nt\tTempo\t(s)\np\tDensidade\t(kg/m3)\nq\tVaz\u00e3o m\u00e1ssica\t(kg/s)\np\tPress\u00e3o\t(Pa)\nV\tVelocidade\t(m/s)\nD\tDi\u00e2metro do tubo\t(m)\nF\tTens\u00e3o cizalhante da parede do tubo\t(kg(m/s)/m2s)\ng\tAcelera\u00e7\u00e3o da gravidade\t(m/s2)\na\t\u00c2ngulo de inclina\u00e7\u00e3o do tubo\t(graus)\nf\tFator de atrito\t\ne\tRugosidade do tubo\t(m)\nm\tViscosidade do fluido\t(kg m/s)\nPM\tMassa molar\t(kg/gmol)\nV\tVolume do fluido\tm3\ng\tRaz\u00e3o entre as Capacidades Calor\u00edficas do fluido (Cp/Cv)\t\nP\tPress\u00e3o de refer\u00eancia\t(Pa)\nP 0\tDensidade de refer\u00eancia\t(kg/m3)\nY\tVetor de estado contendo press\u00e3o \u201cP\u201d e vaz\u00e3o \u201cq\u201d\t\n1.\tINTRODU\u00c7\u00c3O\nO transporte de produtos qu\u00edmicos, tais como g\u00e1s natural, eteno, nafta, \u00f3leos pesados, etc., s\u00e3o normalmente feitos atrav\u00e9s de dutos. Mesmo se apresentando como um dos meios mais eficientes e econ\u00f4micos, h\u00e1 sempre o risco associado da ocorr\u00eancia de acidentes. Estes sistemas normalmente transportam materiais inflam\u00e1veis, sob press\u00e3o e/ou com alto poder de toxicidade, que est\u00e3o sujeitos a falhas operacionais e vazamentos. Agrega-se a este fato, al\u00e9m da perda de produto transportado, estas linhas ou sistemas n\u00e3o raramente cruzarem zonas de ocupa\u00e7\u00e3o humana ou \u00e1reas de prote\u00e7\u00e3o ambiental, o que agrava o potencial de risco envolvido e a seriedade dos danos causados. Desta forma, a detec\u00e7\u00e3o instant\u00e2nea de anormalidades operacionais, principalmente de vazamentos, nestes sistemas de distribui\u00e7\u00e3o e transporte podem minimizar ou at\u00e9 mesmo evitar, desde pequenas perdas de material transportado at\u00e9 acidentes de propor\u00e7\u00f5es catastr\u00f3ficas.\nA partir deste cen\u00e1rio, desenvolve-se, aqui, modelagem e simula\u00e7\u00e3o din\u00e2mica de redes de escoamento compress\u00edvel e apresenta-se um algoritmo computacional capaz de detectar vazamentos em tempo real.\nO modelo determin\u00edstico desenvolvido para a an\u00e1lise din\u00e2mica de redes de escoamento compress\u00edvel est\u00e1 fundamentado nas equa\u00e7\u00f5es de continuidade e de momento. O comportamento transiente est\u00e1 caracterizado pelas vari\u00e1veis, em fun\u00e7\u00e3o do tempo e do espa\u00e7o, a serem expressas. Assim sendo, o comportamento din\u00e2mico das vari\u00e1veis de estado do sistema emerge da solu\u00e7\u00e3o num\u00e9rica de duas equa\u00e7\u00f5es diferenciais parciais ordin\u00e1rias n\u00e3o-lineares, n\u00e3o-homog\u00eaneas de primeira ordem, referente \u00e0 press\u00e3o e vaz\u00e3o do sistema. O modelo din\u00e2mico de escoamento compress\u00edvel \u00e9 resolvido com integra\u00e7\u00f5es num\u00e9ricas em tempo, via m\u00e9todos Runge-Kutta com ajuste de passo, ap\u00f3s discretiza\u00e7\u00e3o do problema pelo m\u00e9todo de elementos finitos aplicando o formalismo Galerkin no espa\u00e7o, com fun\u00e7\u00f5es-base do tipo pulso triangular.\nO sistema de detec\u00e7\u00e3o de vazamento utiliza modelo param\u00e9trico ARX-MIMO (\u201cAuto-Regressive, Exogenous Signal\u201d) (Box, G.; Jenkins, G.M.; Reisel, G.C.)(9). Basicamente, este sistema processar\u00e1 uma significativa massa de dados originada da simula\u00e7\u00e3o do modelo determin\u00edstico previamente desenvolvido. Estas s\u00e9ries temporais s\u00e3o empregadas para treinamento dos preditores ARX-MIMO, identificando um modelo emp\u00edrico entre as vari\u00e1veis de estado de entrada e de sa\u00edda do sistema. Este modelo relacional ter\u00e1 condi\u00e7\u00f5es de estimar o comportamento das vari\u00e1veis de estado (press\u00e3o e vaz\u00e3o) nos pontos de monitora\u00e7\u00e3o Ljung, L.(10). O algoritmo ser\u00e1 capaz de elaborar an\u00e1lise estat\u00edstica entre os estados medidos e os estimados e, caso existam discrep\u00e2ncias entre predi\u00e7\u00f5es e vari\u00e1veis de processo fora dos limites de confian\u00e7a da vari\u00e1vel predita, haver\u00e1 detec\u00e7\u00e3o de anormalidades operacionais naqueles pontos de monitora\u00e7\u00e3o do sistema, constatando-se a exist\u00eancia de um vazamento na rede simulada.\n2.\tREVIS\u00c3O BIBLIOGR\u00c1FICA\n2.1.\tModelagem Din\u00e2mica de Escoamento Compress\u00edvel\nO comportamento da press\u00e3o, vaz\u00e3o e temperatura em processos de escoamento tem sido amplamente estudado. A maioria dos trabalhos existentes na d\u00e9cada de 80, at\u00e9 meados da d\u00e9cada de 90, aborda o problema de forma simplificada, apresentando e implementando modelos baseados em condi\u00e7\u00f5es estacion\u00e1rias. Nota-se, contudo, que este tipo de abordagem n\u00e3o tem demonstrado aplica\u00e7\u00e3o satisfat\u00f3ria em grandes redes de escoamento, as quais estados transientes s\u00e3o mais freq\u00fcentemente encontrados (Ke e Ti)(1). Desta forma, a abordagem estacion\u00e1ria tem sido aos poucos abandonada, sendo substitu\u00edda por uma an\u00e1lise din\u00e2mica, que requer maior esfor\u00e7o computacional.\nOosthuinzen e Carscallen (2) apresentaram as mais diversas formas de an\u00e1lise de escoamento de gases. Entre elas, destaca-se a an\u00e1lise n\u00e3o estacion\u00e1ria do problema. Foi desenvolvido um modelo tendo como premissas b\u00e1sicas: escoamento unidimensional, com \u00e1rea da tubula\u00e7\u00e3o constante e assumindo ser um processo isentr\u00f3pico. Desta forma, mantendo-se a entropia constante, a equa\u00e7\u00e3o de conserva\u00e7\u00e3o de energia n\u00e3o adiciona nenhuma informa\u00e7\u00e3o ao modelo, que pode ent\u00e3o ser reduzido \u00e0s equa\u00e7\u00f5es de conserva\u00e7\u00e3o de massa e momento.\nMatko(3) tamb\u00e9m parte destas mesmas equa\u00e7\u00f5es para formular um modelo din\u00e2mico de escoamento compress\u00edvel, n\u00e3o linear, com par\u00e2metros distribu\u00eddos. Evidencia-se em seu trabalho algumas premissas para simplifica\u00e7\u00e3o do modelo. S\u00e3o elas: (i) Escoamento adiab\u00e1tico; (ii) Fluxo unidimensional; (iii) Fluido homog\u00eaneo; (iv) Temperatura, viscosidade e di\u00e2metro do tubo constantes. O modelo foi composto de duas equa\u00e7\u00f5es diferenciais parciais, hiperb\u00f3licas, n\u00e3o lineares, tendo como vari\u00e1veis dependentes a vaz\u00e3o m\u00e1ssica e a press\u00e3o do sistema, e como vari\u00e1veis independentes a posi\u00e7\u00e3o ao longo do tubo e o tempo. O m\u00e9todo caracter\u00edstica foi usado como solu\u00e7\u00e3o do sistema, transformando o problema em quatro express\u00f5es diferenciais ordin\u00e1rias.\n2.2.\tM\u00e9todos de Detec\u00e7\u00e3o de Vazamento\nMuitos m\u00e9todos para detec\u00e7\u00e3o de vazamentos em linhas que transportam l\u00edquidos e gases t\u00eam sido propostos. Os principais deles s\u00e3o baseados em dados coletados das vari\u00e1veis de processos usualmente medidos, tais como, press\u00e3o, vaz\u00e3o e temperatura.\nTalvez o m\u00e9todo mais comum seja o que faz balan\u00e7o de volume em linha (Ellul)(4). O mesmo baseia-se na conserva\u00e7\u00e3o de massa no duto, aplicada aos dados provenientes de medidores de vaz\u00e3o distribu\u00eddos na tubula\u00e7\u00e3o. Dois tipos de balan\u00e7o s\u00e3o elaborados: um simplificado e, portanto, mais r\u00e1pido, que identifica grandes vazamentos, e outro mais rebuscado e por conseq\u00fc\u00eancia mais lento, que detecta vazamentos de at\u00e9 0,5% da vaz\u00e3o nominal da linha num per\u00edodo de 3 a 6 horas.\nZhang(5) descreve um m\u00e9todo estat\u00edstico para quantificar e localizar vazamentos. O sistema usa valores medidos de vaz\u00e3o e press\u00e3o do final da linha. O mesmo t\u00eam sido aplicado em simula\u00e7\u00f5es de dutos com at\u00e9 100 km. O m\u00e9todo foi aplicado em um caso real numa linha de propeno. Ambas aplica\u00e7\u00f5es demonstram poder detectar vazamentos de at\u00e9 1% do valor nominal da dutovia, bem como a sua localiza\u00e7\u00e3o com uma boa precis\u00e3o.\nJonsson e Larson (6) estudaram a caracter\u00edstica da propaga\u00e7\u00e3o em forma de onda atrav\u00e9s de um duto de \u00e1gua de 5 040 metros, depois da parada de uma bomba, com e sem ocorr\u00eancia de vazamento. Foram analisados os efeitos de um vazamento nas varia\u00e7\u00f5es dos sinais de press\u00e3o do sistema. O m\u00e9todo conseguiu detectar fugas de at\u00e9 7% do valor nominal do fluxo de teste.\nOutra classe de sistema de detec\u00e7\u00e3o de vazamentos \u00e9 apresentada por (Coelho e Medeiros)(7) como mais promissoras, confi\u00e1veis e associadas a menores investimento de implanta\u00e7\u00e3o. Nestas, a qualidade da detec\u00e7\u00e3o obtida depende de modelos apropriados ao processo, sejam eles de natureza estoc\u00e1stica, gerados por estrat\u00e9gias de identifica\u00e7\u00e3o sobre s\u00e9ries temporais de vari\u00e1veis de entrada e sa\u00edda (estados), ou constru\u00eddos com base em princ\u00edpios e leis fenomenol\u00f3gicas.\n3.\tMODELAGEM DIN\u00c2MICA DE ESCOAMENTO COMPRESS\u00cdVEL\nO modelo matem\u00e1tico utilizado para a an\u00e1lise transiente em redes de escoamento compress\u00edvel est\u00e1 fundamentado nas equa\u00e7\u00f5es de continuidade e momento. No desenvolvimento do modelo, foram assumidas algumas premissas b\u00e1sicas com o intuito de simplifica\u00e7\u00e3o do mesmo, s\u00e3o elas : (i) Escoamento Isentr\u00f3pico : n\u00e3o h\u00e1 transfer\u00eancia de energia entre o fluido e a tubula\u00e7\u00e3o; (ii) Fluxo unidimensional : press\u00e3o e vaz\u00e3o dependem apenas do eixo x; (iii) viscosidade e di\u00e2metro do tubo constantes. A aplica\u00e7\u00e3o conjunta destas duas express\u00f5es, considerando as premissas acima citadas, faz surgir duas equa\u00e7\u00f5es diferenciais parciais n\u00e3o lineares, n\u00e3o homog\u00eaneas de ordem 1, referente \u00e0 press\u00e3o e \u00e0 vaz\u00e3o do sistema, unidimensional no espa\u00e7o e transiente.\n3.1.\tEqua\u00e7\u00e3o da Continuidade e da Quantidade de Movimento\nA equa\u00e7\u00e3o da continuidade e da quantidade de movimento s\u00e3o obtidas aplicando o princ\u00edpio da conserva\u00e7\u00e3o da massa e momento, num volume de controle.\nS\nFig. 1 - Volume de Controle.\nFig. 1 - Control volume.\nConsiderando a situa\u00e7\u00e3o apresentada na figura 1, chega-se \u00e0 apresenta\u00e7\u00e3o do modelo contendo, respectivamente, as express\u00f5es finais da continuidade e da quantidade de movimento de um escoamento isentr\u00f3pico:\n3P'\n/\tV r-1 \\\t\n7\tp' r\nSP 0 J\t\n( 2\n(1)\n( 1 1\t( \\ 2 q\n\u00e8p 0S 0\tr-1 p' r '\npo S\t-\ndx\n\u00e8P 0 S\n~(P o Sg sen\u00ab)P 'g dx\n(2)\n1\nP0SD\nq\\q\\P'r\n31\nV\nqP'r\n(1\n<2\n\\ ( f\n7 \u00e8\n7\nA formula\u00e7\u00e3o detalhada das equa\u00e7\u00f5es 1 e 2 encontra-se no Ap\u00eandice 1.\n3.2.\tResolu\u00e7\u00e3o Num\u00e9rica do Modelo\nO modelo representado pelas equa\u00e7\u00f5es 1 e 2 foi resolvido no espa\u00e7o pelo m\u00e9todo de elementos finitos usando-se o formalismo Galerkin (Cook)(8). Por meio deste procedimento, \u00e9 poss\u00edvel reduzirem-se as equa\u00e7\u00f5es diferenciais parciais do modelo a um sistema de equa\u00e7\u00f5es diferenciais ordin\u00e1rias no tempo.\nCom esta finalidade, foi escolhida como base funcional de dimens\u00e3o N o conjunto\t(x)}N de\nfun\u00e7\u00f5es pulso triangular dado pela equa\u00e7\u00e3o 3:\nf j(x) = 0,\te<-1\nf j(x) = 1 + 3,\t-1&lt;e<o (3)\nf j(x) = 1 -e,\to&lt;e&lt;1\nf j(x) = 0, e = x - j\te> 1,\nh\nonde:\nh \u00e9 o comprimento caracter\u00edstico da discretiza\u00e7\u00e3o na dimens\u00e3o espacial que ir\u00e1 resultar das formas\n(3), dado pela equa\u00e7\u00e3o 4:\nh = xMAX ~ xMIN\nN\n(4)\nxMIN normalmente \u00e9 igual a zero e xMAX \u00e9 o comprimento total do tubo a ser resolvido pelo modelo. N \u00e9 o n\u00famero de elementos de comprimento h.\npara\nA aplica\u00e7\u00e3o do formalismo Galerkin demanda inicialmente a coloca\u00e7\u00e3o de todas as fun\u00e7\u00f5es do problema sob a forma de truncamentos em s\u00e9ries de Fourier a partir da base\nfun\u00e7\u00f5es dependentes do tempo e de x, os coeficientes de Fourier depender\u00e3o apenas do tempo. T\u00eam-se (equa\u00e7\u00e3o 5):\nN\nY(x,t)&lt;\u00a3 Yk(t)f k(x)\nk=0\n(5)\nOnde o vetor de estado Y , contendo press\u00e3o \u201cP\u201d e vaz\u00e3o \u201cq\u201d contidas nas equa\u00e7\u00f5es (1 e 2). No procedimento Galerkin, a equa\u00e7\u00e3o 5 \u00e9 substitu\u00edda nas equa\u00e7\u00f5es diferenciais (1 e 2), modelo final de escoamento compress\u00edvel, gerando o res\u00edduo (equa\u00e7\u00e3o 6) dependente do tempo (t) e do espa\u00e7o (x):\nR = |=+A(Y)(^=)+ B(Y)\t(6)\n3 t =\t3x\nEm seguida, imp\u00f5e-se que os produtos internos de tais res\u00edduos com as fun\u00e7\u00f5es-base (equa\u00e7\u00e3o 3) sejam nulos, conforme equa\u00e7\u00e3o 7:\noo\nJ Rf k(x) = 0\n0\n(7)\npara k= 0,..,N.\nA aplica\u00e7\u00e3o da equa\u00e7\u00e3o 7 e suas propriedades resultam no sistema de equa\u00e7\u00f5es diferenciais ordin\u00e1rias no tempo(equa\u00e7\u00f5es 8 e 9).\nHk =\n(h)\n' h\\\u2022\n&lt;6F\nk)\n[{K}\n,, \u2022\t(h'\\ \u2022\nTT Yk-i + -V 3 7\nf kde-\nYk-1JAk)fY\niw-\n+ &lt;k-1\nJ Af a! Yk \u25a0\niw-\n(8)\npara k = 1,..N\n' h\\ k3 J\nJk =\n(h)\n(h\\ \u2022\n- Y k+1 + k 6 J-k+1\nk+1)\n.{K+1}\n- Yk-\u00ed JAk+1)fkde\\Y\n.{K+1T\n'k+i - Yk)+\n(9)\nf d*-\npara jk- 0,..,N-1\nAs integrais existentes nas equa\u00e7\u00f5es 8 e 9 foram resolvidas numericamente pelo m\u00e9todo de Quadratura Gaussiana (equa\u00e7\u00e3o 10). Tal m\u00e9todo consiste em expandir a integral de \u201cF(x)\u201d em um somat\u00f3rio de termos formados pela pr\u00f3pria fun\u00e7\u00e3o nos pontos de quadratura, multiplicada pelos pesos de quadrature Wj, determinados pelo n\u00famero de termos escolhido \u201cn\u201d.\nj'/VW =\tWjF(Xj)\n2 j\n(10)\nSendo assim, as equa\u00e7\u00f5es 8 e 9 foram resolvidas com integra\u00e7\u00f5es num\u00e9ricas em tempo via m\u00e9todos Runge-Kutta com ajuste de passo, para os coeficientes de Fourier das vari\u00e1veis de estado press\u00e3o e vaz\u00e3o, com as seguintes condi\u00e7\u00f5es de contorno (equa\u00e7\u00f5es 11 e 12):\nX = 0 ^P'= PEntrada (t) i X = L ^V=VSada. (0\nE condi\u00e7\u00f5es iniciais : t = 0 => P' = P'o (x) ; t = 0 q = q0(x)\n(11)\n(12)\n4.\tDETEC\u00c7\u00c3O DE VAZAMENTOS VIA PREDITORES ARX-MIMO\nO m\u00e9todo proposto para detec\u00e7\u00e3o de vazamento est\u00e1 baseado em modelo estoc\u00e1stico auto-regressivo Empregou-se no sistema uma estrutura ARX (Auto Regressive EXogenous Input) com m\u00faltiplas entradas e m\u00faltiplas sa\u00eddas (MIMO).\n4.1\t- Metodologia\nO procedimento consiste em gerar s\u00e9ries temporais(1) dos dados de entrada e sa\u00edda transientes do processo, tais como press\u00f5es nodais e vaz\u00f5es de escoamento nos tubos, sob a ocorr\u00eancia de eventos programados pelo simulador din\u00e2mico e empreg\u00e1-las para treinamento de preditores ARX-MIMO e coloc\u00e1-los para prever estados do processo com respeito a apenas uma pequena parte do grande elenco de vari\u00e1veis do sistema. Em tese, na aus\u00eancia de anormalidades operacionais, o preditor dever\u00e1 rastrear com efetivo sucesso as vari\u00e1veis sob acompanhamento. O valor predito ir\u00e1 diferir do medido numa faixa inferior \u00e0 largura do intervalo de confian\u00e7a da predi\u00e7\u00e3o. A manifesta\u00e7\u00e3o de um vazamento \u00e9 detectada pelo afastamento instant\u00e2neo, e significativamente fora dos limites de confian\u00e7a , entre um conjunto de predi\u00e7\u00f5es e as medi\u00e7\u00f5es do processo correspondentes.\nAs fases principais da metodologia s\u00e3o:\n(i)\tgera\u00e7\u00e3o do preditor via treinamento com dados de processo em t+1, ..., t+N;\n(ii)\tacompanhamento do processo com preditor gerado em t+N+1, ..., t+N+NI;\n(iii)\tconstru\u00e7\u00e3o de limites estat\u00edsticos de confian\u00e7a para preditores;\n(iv)\tdetec\u00e7\u00e3o de eventos na faixa temporal t+N+1, ..., t+N+NI quando houver disparidade entre predi\u00e7\u00e3o e medi\u00e7\u00e3o al\u00e9m dos limites de confian\u00e7a;\n(v)\tap\u00f3s t+N+NI regenerar o preditor com nova sess\u00e3o de treinamento com N instantes (Normalmente NI>>N);\n(vi)\trepetir etapas (ii) a (v), ap\u00f3s fazer t = t+N+NI.\nA seguir, apresentam-se os principais fundamentos e procedimentos num\u00e9ricos das fases acima, que constituem o M\u00e9todo de Detec\u00e7\u00e3o de Eventos em Processos Descritos em S\u00e9ries Temporais. Tal m\u00e9todo est\u00e1 sendo desenvolvido no Laborat\u00f3rio SDV Dutos da Escola de Qu\u00edmica da UFRJ.\nTodo o desenvolvimento matricial para a fase de treinamento do ARX-MIMO est\u00e1 apresentado no Ap\u00eandice 2.\n4.2\t\u2014 Estrutura do Modelo Preditor ARX-MIMO\n\u2022 Vari\u00e1veis b\u00e1sicas:\ny(t)\t: Vetor (ny x 1) de sa\u00eddas do processo sob acompanhamento em t\ny(t)\t: Predi\u00e7\u00e3o para y(t) (ny x 1)\nl/(t)\t: Vetor (nu x 1) de entradas do processo sob acompanhamento em t\nq(.)\t: Operador de deslocamento\nA : Matriz ny x nu constante\nB : Matriz ny x nu constante\nn\t: Ordem do filtro de auto-regress\u00e3o (AR) do ARX-MIMO\nm\t: Ordem do filtro de entrada (X) do ARX-MIMO\nAk (q)\t: Operador matricial do filtro AR (ny x ny)\nBk(q)\t: Operador matricial do filtro X (ny x nu)\nn\nASt) = 1+\u00a3Aq\u2018(.)\t(13)\nk=1\nm\nB(q) = 1 + XBkq-k(.)\t(14)\nk=1\n\u2022 Equa\u00e7\u00f5es do Preditor para Instante t+1 (equa\u00e7\u00e3o 15):\nyt +1) = B(q)u(t) + q[l - A(q)Jy(t)\n(15)\n\u2022 Abrindo operadores e estendendo predi\u00e7\u00e3o para instantes t+1, ..., t+N (equa\u00e7\u00e3o 16):\ny(t +1) = Bu(t)+ ...+ Bmu(t - m +1)-Ay(t)-Bny(t - n +1)\ny(t + N) = Bu(t + N -1) +... + B u(t + N - m) - Ay(t + N -1) -\n... - A y(t + N - n)\nA cole\u00e7\u00e3o matricial para treinamento do ARX-MIMO est\u00e1 apresentada no Ap\u00eandice 2 (equa\u00e7\u00f5es 2.1 a 2.6).\n\u2022 Estima\u00e7\u00e3o de Par\u00e2metros para Sa\u00edda i\nHip\u00f3teses\n(i)\tModelo ARX \u00e9 correto para representar o processo (equa\u00e7\u00e3o 17):\nh i=xq i\n(17)\nonde:\nQi \u00e9 o valor correto de par\u00e2metros; hi \u00e9 o vetor correto de predi\u00e7\u00f5es (t+1,...,t+N) para a sa\u00edda i.\n(ii) Amostragem experimental para a sa\u00edda i, O i (coluna i de O), segue padr\u00e3o normal n\u00e3o-\ncorrelacionado em torno de h i (equa\u00e7\u00f5es 18 e 19):\nFD(\u00ae i) =\n1\n(2p )N/27det(R.)\nexp[-|(Oi -hi)tRi_1(^i -h;)]\nR = COV(\u00aei) = lidiagr);\t(r, : Nx1)\n(18)\n(19)\nDefinindo-se W = [diag(ri)] ~1 (conhecida), tem-se (equa\u00e7\u00e3o 20):\nJdet(W-)\t1 t\n1 exp[--(Oi-hi)tWi(^. ~h.)]\nFD-i)\t(2i\u00c2,.)N/2\n(20)\nPara estimar (. constr\u00f3i-se a fun\u00e7\u00e3o verossimilhan\u00e7a para sa\u00edda i a partir de (20)\ndet(W)\t1\nL(-i\u2019-i) = (2i prexp[--(O,\u25a0 - Yi)tWi(^>i -Y/)l\t(21)\nEstima-se 0. maximizando a fun\u00e7\u00e3o densidade conjunta dos valores medidos atrav\u00e9s de L(\u00c7> ,, \u00d4_i) (equa\u00e7\u00e3o 22):\nMax\nL(O .I)\n(22)\nque corresponde a ( W. conhecida) (equa\u00e7\u00e3o 23):\nii\n1 . t \u201e Min{} \u2014Yt-Oi) WYi)\n(23)\nonde:\nY_. \u00e9 o vetor de preditores para a sa\u00edda i dado em (equa\u00e7\u00e3o 2.6 - Ap\u00eandice 2). Substitui\u00e7\u00e3o de (2.6 -Ap\u00eandice 2) seguida de busca de ponto estacion\u00e1rio em (3.1 - Ap\u00eandice 3), resulta em (equa\u00e7\u00e3o 24):\n\u00f4.=[x'WiXr 'XWi .\n(24)\nA caracteriza\u00e7\u00e3o da Estima\u00e7\u00e3o, Regi\u00e3o de Confian\u00e7a de Par\u00e2metros, Regi\u00e3o de Confian\u00e7a para Predi\u00e7\u00f5es Corretas na Janela de Treinamento do ARX-MIMO e Fora da Janela de Treinamento est\u00e3o apresentadas no Ap\u00eandice\n5.\tSIMULA\u00c7\u00d5ESE RESULTADOS\nFoi modelada uma rede planar de 5 tubos de 0,45m de di\u00e2metro para escoamento de g\u00e1s conforme mostrado na figura 2. A viscosidade do g\u00e1s foi assumida constante igual a 0,01cP, com expoente politr\u00f3pico g=1,25. A rugosidade do tubo foi suposta de 10-7m. As propriedades termodin\u00e2micas de escoamento foram modeladas com a equa\u00e7\u00e3o 1.10 - Ap\u00eandice 1. As vari\u00e1veis de entrada do processo s\u00e3o as press\u00f5es dos n\u00f3s 1 e 6 (P1 e P6), vaz\u00f5es de fornecimento de 40 Kg/s nos n\u00f3s 3 e 4 (W3 e W4), vaz\u00e3o de alimenta\u00e7\u00e3o do sistema no n\u00f3 2 (P2) e um ponto de vazamento no n\u00f3 5 (W5). As press\u00f5es de carga P1 e P6 ser\u00e3o programadas para variar entre dois n\u00edveis especificados conforme visto na figura 8. Nesta figura, tamb\u00e9m pode ser visto o padr\u00e3o de opera\u00e7\u00e3o especificado para as vaz\u00f5es de fornecimento e de alimenta\u00e7\u00e3o (W3, W4 e W2). O n\u00f3 de vazamento foi programado para acionar em t=260s, gerando uma vaz\u00e3o proporcional \u00e0 raiz quadrada da diferen\u00e7a de press\u00e3o entre o n\u00f3 e o exterior. O comportamento deste n\u00f3 (W5 e P5) tamb\u00e9m pode ser visto na figura 8. Os impactos de todos estes padr\u00f5es de opera\u00e7\u00e3o refletem-se nos tubos da rede conforme pode ser visto nas figuras de 3 a 14, que ilustram comportamentos P(x,t) e q(x,t), sendo P uma press\u00e3o de um ponto e q uma vaz\u00e3o. Telas de opera\u00e7\u00e3o e de controle do simulador que foi desenvolvido no Laborat\u00f3rio SDV - Dutos da Escola de Qu\u00edmica da UFRJ tamb\u00e9m s\u00e3o apresentadas nas figuras de 15 a 17.\nEm futuro desenvolvimento desta pesquisa, pretende-se implementar a detec\u00e7\u00e3o de vazamentos com estruturas preditoras ARX-MIMO usando-se o simulador como fonte de treinamento dos preditores.\nFig. 2 - Rede exemplo para escoamento compress\u00edvel em condi\u00e7\u00e3o transiente.\nFig. 2 - Sample system for compressible flow in transient condition.\nFig. 3 - Distribui\u00e7\u00e3o espa\u00e7o temporal de press\u00e3o e vaz\u00e3o no tubo 1.\nFig. 3 - Time space distribution of pressure and flow rate in pipe #1.\nFig. 4 - Distribui\u00e7\u00e3o espa\u00e7o temporal de press\u00e3o e vaz\u00e3o para o tubo 2.\nFig. 4 - Time space distribution of pressure and flow rate in pipe #2.\nFig. 5 - Distribui\u00e7\u00e3o espa\u00e7o temporal de press\u00e3o e vaz\u00e3o para o tubo 3.\nFig. 5 - Time space distribution of pressure and flow rate in pipe #3.\nRede 3 Tubo4\n110\n100\n90\n80\n- 18000 m\n20000 m\n---\t0 m\n-\t2000 m\n-\t4000 m 6000 m\n--- 8000 m 10000m\n---12000 m --- 14000 m\n-\t16000 m\n400\n300\n200\nCT\n100\nFig. 6 - Distribui\u00e7\u00e3o espa\u00e7o temporal de press\u00e3o e vaz\u00e3o para o tubo 4.\nFig. 6 - Time space distribution of pressure and flow rate in pipe #4.\n400\nFig. 7 - Distribui\u00e7\u00e3o espa\u00e7o temporal de press\u00e3o e vaz\u00e3o para o tubo 5.\nFig. 7 - Time space distribution of pressure and flow rate in pipe #5.\nFig. 8 - Comportamento din\u00e2mico das vari\u00e1veis de press\u00e3o e vaz\u00e3o para o exterior dos n\u00f3s da rede.\nFig. 8 - Dynamic behavior of pressure and flow rate variables outside system nodes.\nFig. 9 - Superf\u00edcie P(x,t) para o tubo 1.\nFig. 9 - P(x,t) surface for pipe #1.\nFig. 10 - Superf\u00edcie P(x,t) para o tubo 2.\nFig. 10 - P(x,t) surface for pipe #2.\nRede 3 Tubo4\nFig. 11 - Superf\u00edcie P(x,t) para o tubo 4.\nFig. 11 - P(x,t) surface for pipe #4.\nRede3Tubo4\nFig. 12 - Superf\u00edcie q(x,t) para o tubo 4.\nFig. 12 - q(x,t) surface for pipe #4.\nFig. 13 - Superf\u00edcie P(x,t) para o tubo 5.\nFig. 13 - P(x,t) surface for pipe #5.\nFig. 14 - Superf\u00edcie q(x,t) para o tubo 5.\nFig. 14 - q(x,t) surface for pipe #5.\nFig. 15 - Tela principal do simulador.\nFig. 15 - Main screen of simulator.\n\nRohzero(kg/m3)\nFator de Volume\nOrdem de Quadratura\n-) Figure No, 1: Condi\u00e7\u00f5es Simula\u00e7\u00e3o\nRel\u00f3gio(s)\nHorizonte(s)\nExpoente Politr\u00f3pico\nTempo Amostragem (s)\nViscosidade (kg/m.s)\nElemento Base(m)\nRugosidade (m)\nFig. 16 - Tela de par\u00e2metros de simula\u00e7\u00e3o.\nFig. 16 - Simulating parameter screen.\nFig. 17 - Tela de acesso a recursos da rede de escoamento.\nFig. 17 - Access screen to flow system resources.\n6.\tCONCLUS\u00d5ES EPR\u00d3XIMAS ETAPAS\nAs principais conclus\u00f5es deste trabalho foram:\n\u2022\tfoi desenvolvido, com \u00eaxito, modelagem e simula\u00e7\u00e3o din\u00e2mica de redes de escoamento compress\u00edvel;\nO trabalho aqui desenvolvido pode ser aperfei\u00e7oado de v\u00e1rias maneiras. As seguintes etapas dever\u00e3o ser futuramente implementadas:\n\u2022\tvalida\u00e7\u00e3o do modelo din\u00e2mico de escoamento compress\u00edvel, com dados reais de um sistema de transporte de g\u00e1s;\n\u2022\tinstala\u00e7\u00e3o de sistema de detec\u00e7\u00e3o baseado em preditores ARX-MIMO rastreando respostas medidas do processo;\n\u2022\taperfei\u00e7oamento do modelo de equa\u00e7\u00e3o de estado do simulador din\u00e2mico de redes de escoamento compress\u00edvel;\n\u2022\tdesenvolvimento de algoritmos de localiza\u00e7\u00e3o e quantifica\u00e7\u00e3o de vazamentos em escoamento compress\u00edvel.\nO aperfei\u00e7oamento da tecnologia de preven\u00e7\u00e3o e detec\u00e7\u00e3o de vazamentos e falhas em sistemas de transporte de g\u00e1s, via redes de escoamento compress\u00edvel, trar\u00e1 indiscut\u00edveis benef\u00edcios, principalmente os de ordem econ\u00f4mica, com o aumento da seguran\u00e7a dos sistemas e sua conseq\u00fcente otimiza\u00e7\u00e3o operacional; e os de ordem ambiental, com a dr\u00e1stica redu\u00e7\u00e3o de polui\u00e7\u00e3o atmosf\u00e9rica, e diminui\u00e7\u00e3o de risco relacionados a inc\u00eandios, explos\u00f5es e devasta\u00e7\u00e3o de ecossistemas cuja amplitude depende do tempo gasto pelo sistema de detec\u00e7\u00e3o em tomar ci\u00eancia da ocorr\u00eancia e acionar medidas de conten\u00e7\u00e3o.\nREFER\u00caNCIAS BIBLIOGR\u00c1FICAS\n(01) KE, S. L.; TI, H. C. \u201c Transient analysis of isothermal gas flow in pipeline network\u201d, Chemical Engineering Jounal, 76, p. 169-177, (2000).\n(02) OOSTHUINZEN, P. H.; CARSCALLEN, W. E. \u201cCompressible fluid flow\u201d, McGrow-Hill International Editions, (1997).\n(03) MATKO, D.; GEIGER, G.; GREGORITZA, W. \u201cPipeline simulation techniques\u201d, Mathematics and Computers in Simulation, 52, p. 211-230, (2000).\n(04) ELLUL, I. \u201cPipeline leak detection\u201d, Chemical Engineering, N 461 (1989).\n(05) ZHANG, X. J. \u201cStatistical method for detection and localization of leaks in pipeline\u201d, OMAE, Vol. V-B, , Pipeline Technology, ASME, New York (1992).\n(06) JONSSON, L.; LARSON, M. \u201cLeak detection through hydraulic transient analysis\u201d, Pipeline Systems, Kluwer Academic Publishers, Dordrecht, Holland (1992).\n(07) COELHO, R.M.L.; MEDEIROS, J.L. \u201c Detec\u00e7\u00e3o de Vazamento em Redes de Escoamento Incompress\u00edvel via Reconcilia\u00e7\u00e3o N\u00e3o-Linear\u201d. Anais do II ENPROMER - II Congresso de Engenharia de Processos do Mercosul, Outubro de 1999, Florian\u00f3polis, Brasil (1999).\n(08) COOK, R. D. \u201cConcepts and applications of finite elements analysis\u201d, Second Edition by John Willey &amp; Sons, Inc. (1981)\n(09) BOX, G.; JENKINS, G.M.; REISEL, G.C. \u201cTime series analysis\u201d, Prentice Halll, (1994) Churchill, S. W., \u201cFriction-factor equation spans all fluid-flow regimes\u201d, Chemical Engineering, No 11, p. 91-92 (1977).\n(10) LJUNG, L. \u201c System Identification : Theory for the user\u201d, Prentice Hall PTR Information and System Sciences Series, (1987).\nAP\u00caNDICE 1\nFORMULA\u00c7\u00c3O DO MODELO DIN\u00c2MICO DE ESCOAMENTO\n1.1.\tEqua\u00e7\u00e3o da Continuidade\nA equa\u00e7\u00e3o da continuidade \u00e9 obtida aplicando o princ\u00edpio da conserva\u00e7\u00e3o da massa atrav\u00e9s de um volume de controle. Tem-se (equa\u00e7\u00e3o 1.1):\n\u00c7A\t(U)\nSAx a7 = q ~ (/-\nDividindo-se a equa\u00e7\u00e3o 1.1 por S e Ax, e aplicando-se o limite quando Ax tende a zero, obt\u00e9m-se a equa\u00e7\u00e3o 1.2:\n3p = \u00c7 1 ^3q\n31\tS 0 dx\n(1.2)\n1.2\t- Equa\u00e7\u00e3o da Quantidade de Movimento\nA equa\u00e7\u00e3o de quantidade de movimento \u00e9 obtida aplicando o princ\u00edpio da conserva\u00e7\u00e3o de momento em um volume de controle. As for\u00e7as que agem no sistema podem ser expressadas da seguinte forma (equa\u00e7\u00e3o 1.3):\n3(pv)\t2\t2\t(1.3)\nSAx^-P- = SPX -SPx+\u00edx + Sp\\'2x -Spv2v- -pDAxF-pgsenaSAx\na t\nDividindo-se a equa\u00e7\u00e3o 1.3 por Si e Ax, e aplicando-se o limite quando Ax tende a zero, chega-se \u00e0 seguinte express\u00e3o (equa\u00e7\u00e3o 1.4):\na(pv)= ap a(pv2) (kd dt\tdx\tdt\t\u00e8 S\npg sen a\n(1.4)\nSabendo-se que (equa\u00e7\u00e3o 1.5):\n\to\tq q = pvS qv=^~ Sp\t\t(1.5)\nE que (equa\u00e7\u00e3o 1.6),\t2\tqv\t_\t2 q2\t\n\tpv\t=-\u2014 = S\t^PV = V2 p S p\t(1.6)\nO balan\u00e7o de quantidade de movimento fica (equa\u00e7\u00e3o 1.7):\ndq\tdP 2q dq q2 dp\n- = -S---------\u2014- +  \u2014 - pDF - pSg sen a\ndt\tdx pS dx p S dx\n(1.7)\nSendo que o item \u201cpDF\u201d da express\u00e3o, que cont\u00e9m o termo de fator de atrito pode ser substitu\u00eddo pela equa\u00e7\u00e3o 1.8.\npDF =\n' 1\n<2\nq\\q\\\n)\n(1.8)\nE o fator de atrito contido na equa\u00e7\u00e3o 1.8 deve ser baseado na formula\u00e7\u00e3o de Churchill(1977) (equa\u00e7\u00e3o 1.9).\nf = 8\u00ed\n(1.9)\n' _8_\n&lt;Re\nSendo que:\nA =\nRe =\n' 4 q pDm\nv /\n1.3.\tEscoamento Isentr\u00f3pico\nO modelo proposto considera o escoamento adiab\u00e1tico, ou seja, n\u00e3o ser\u00e1 admitido troca de calor do fluido com as vizinhan\u00e7as. Tal premissa pode ser assumida desde que os efeitos de viscosidade e de troca de calor n\u00e3o sejam restri\u00e7\u00f5es do problema, nem tampouco sejam importantes para compor as condi\u00e7\u00f5es de contorno. Assim, por defini\u00e7\u00e3o, a entropia permanece constante e pode ser assumida a seguinte rela\u00e7\u00e3o (equa\u00e7\u00e3o 1.10):\nPV g =\nPM g\n(1.10)\nP\ng\n= C\nDiferenciando ambos termos da express\u00e3o tem-se (equa\u00e7\u00e3o 1.11):\n3P\n(Cp 'pp\n(1.11)\nMg jdp\nSubstituindo a equa\u00e7\u00e3o 1.10 na 1.11, obt\u00e9m-se a equa\u00e7\u00e3o 1.12 :\n3P\ndh\n' gP ^3p \u00e8 p J\u00e2h\n(1.12)\nAssim, pode-se assumir a seguinte rela\u00e7\u00e3o, tendo a entropia (S) constante (equa\u00e7\u00e3o 1.13):\ngP _(3P_\nP [dp\n(1.13)\n> s\nDesta forma, podem-se usar as f\u00f3rmulas abaixo para substituir a densidade (p) pela press\u00e3o (P) nas express\u00f5es da continuidade (1.2) e da quantidade de movimento (1.7).\n3p\n3x\n'_p> gP Jax\n(1.14)\nap a t\nypP g pt\n1.4 - Equa\u00e7\u00f5es Finais de Continuidade e Momento\nSubstituindo as equa\u00e7\u00f5es (1.14) e (1.8) nas (1.2) e (1.7) chega-se \u00e0 apresenta\u00e7\u00e3o do modelo contendo as express\u00f5es da continuidade e da quantidade de movimento, respectivamente. Sendo o fator de atrito \u201cf\u201d evidenciado pela equa\u00e7\u00e3o 1.9.\n3P\n31\nP/ _ q2 ()l gPpS\n' 2q ^3q PS Px\n(1\n<2\n(1.15)\n(1.16)\n' gP Mq k Sp px\nAdimensionalizando as vari\u00e1veis press\u00e3o (P) e densidade (p) contida nas equa\u00e7\u00f5es 1.15 e 1.16 com as seguintes express\u00f5es (equa\u00e7\u00e3o 1.17).\nP\nP\np'\n(1.17)\nDesta forma a rela\u00e7\u00e3o fenomenol\u00f3gica existente em (1.10) torna-se (equa\u00e7\u00e3o 1.18):\nP' _ d g\n(1.18)\nAplicando a equa\u00e7\u00e3o 1.17 nas equa\u00e7\u00f5es 1.15 e 1.16 e eliminando a densidade \u201cd\u201d com a rela\u00e7\u00e3o da express\u00e3o 1.18, encontra-se:\n3P'\na t\n0\ns\u00ed\np'\nax\n7\n(1.19)\na q\n~dt\n( 1 1\t(\tX 2 q\n[\u00edP 0 S 0\ty-1 p' y \\ r\t7\np0 s P -\nax\n( 2\n[P 0 S\ny\tZ1\nqP'y\n\"(P 0 Sg sen\u00ab)P 'g ax\n(1.20)\n11 f\t( 1\n2 lf\t[p 0 SD\nAP\u00caNDICE 2\nCOLE\u00c7\u00c3O MATRICIAL PARA TREINAMENTO\nAs s\u00e9ries temporais s\u00e3o organizadas matricialmente:\nut(t - (m-1))\nU = U(t)\n(N + m-1 x nu)\nu(t + N -1)\ny(t - (m-1))\nY = /(t)\n(N + m-1 x ny)\nyt(t + N -1)\n\t~y(t+1)\u2019\t\t~y\u2019(t +1) \u2019\t\ny=\ty(t)\t; 9=\ty'(t)\t(N x ny)\n\t_ y(t+N)\t\ty'(t + N)\t\nonde u(t), y(t) s\u00e3o os vetores de entrada (nu x 1) e de sa\u00eddas (ny x 1) do processo. Considere a predi\u00e7\u00e3o da resposta \u201ci\u201d, yi(t) (i =1... ny). Ser\u00e1, portanto, necess\u00e1rio operar com as linhas \u201ci\u201d de By..,B ,A1,...,A . Sejam Aki e Btki as linhas \u201ci\u201d de Ak e Bk . Assim pela (equa\u00e7\u00e3o 16), tem-se:\ny(t+1) = Bu+...+Bmiu(t - m+1) - Ay) -... - Ay - n+1)\nyy(t + N) = By + N -1) +... + Btmiu(t + N - m) - Ay + N -1) -... - Ay + N - n)\n(2.1)\nSejam:\nbkij : elemento ij de Bk\nakij : elemento ij de Ak\nUj(t), yj(t) : elemento j de\tu(t) e y(t)\nAssim:\nnu\tnu\tny\tny\nyi(t+1)=\u00ca bijuj(t)+...+X bmuj(t - (m~1))-\u00a3 aijyj(t) - \u25a0\u25a0\u25a0 -\u00a3 anjyj(t - (n~1))\nj=i\tj=i\tj=i\tj=i\nnu\tnu\nyi(t + N) = \u00a3 bViuJ(t + N -1) +... + \u00a3\t+ N - m)) -\nj=1\tj=1\nny\tny\n\u00a3 aijyj(t+N -1) - \u25a0\u25a0\u25a0 -\u00a3 anijyj(t+N - n))\nj=i\tj=1\nEscrevendo a coluna i de Y(t) como :\nY(t) =\nyt+1)\ny^t+n)\n(N x 1)\nas equa\u00e7\u00f5es anteriores tornam-se:\nnu\t\tuj(t)\t\t- j _ (m - 1))T\nY = Y \u00ed\tb1ij\t\t+ \u25a0\u25a0\u25a0 + bmj\t\nj=1\t\tuj(t + N -1)\t\tuj(t + N - m)\nny\nY \u00ed\nj=1\nyj(t)\nyj(t + n -1)\n+ \u25a0\u25a0\u25a0 + amj\nyj(t - (n -1))\nyj(t + N - n)\n(2.2)\nAnalogamente, escreve-se a coluna j de U e Y como a seguir:\n\t~u,(t - (m -1))-\t\t~ y,(t - (n -1))-\nUj =\t\t(N+m-1 x 1); Yj =\t\n\tui(t + N -1)\t\tyi(t + N -1)\nDefinem-se os seletores esparsos:\n(N+n-1 x 1)\n>\n\u00e2-WNN + m -1)\nNx(N + n-1)\nN + m - 1\nN + n - 1\nEstes seletores garantem:\nUj(t)\nu (t + N -1)\n= SiUj\nJ\ny(t)\ny (t + n -1)\n= \u00ediilYj\nUj(t - (m-1))\nuj(t + N - m)\n= ISmlUj ;\ny j (t - (n -1)) yj (t + N - n)\n= [$ ]Y j\n=n J\nAssim, a equa\u00e7\u00e3o 2.2 torna-se (equa\u00e7\u00e3o 2.3):\nm\tnu\tn\tny\nY = X [skfL Ub -\u00a3 [$kiY Ya\nk=1 j=1\tk=1 j=1\n(2.3)\nou ainda (equa\u00e7\u00e3o 2.4):\nm\tn\nY = L [SklUBkl+Y l$k]YAki(2.4)\nk=1\tk=1\nDefine-se a matriz (Nx (nx * ny + m* nu)):\nx = l-\u25a0\u25a0\u25a0 -H\tSU- SmU\ne o vetor de par\u00e2metros do ARX-MIMO para gera\u00e7\u00e3o da predi\u00e7\u00e3o i:\n0,\u25a0 ( (nx * ny + m* nu) x 1), dado por sua vez por:\nX \u25a0\u25a0\u25a0Bi]\n1i\tmi\n0i= [Ai\t\u25a0\u25a0\u25a0 A B\nL=1i\t=ni\n<------> \u00ab\nai\nb\nAssim, tem-se a rela\u00e7\u00e3o de predi\u00e7\u00e3o da sa\u00edda i (equa\u00e7\u00e3o 2.5):\ny=|x]qi, 0-i =\nai\nb\n(2.5)\nNo formato de estima\u00e7\u00e3o de par\u00e2metros (equa\u00e7\u00e3o 2.6):\nY = XL&lt;1=1.........ny)\n(2.6)\nObserva\u00e7\u00f5es:\na)\tmatriz X \u00e9 \u00fanica para todas as sa\u00eddas do ARX-MIMO;\nb)\tcada sa\u00edda (i=1,...,ny) diferencia-se apenas pelo vetor de par\u00e2metros correspondentes;\nc)\tidentifica\u00e7\u00f5es / estima\u00e7\u00f5es podem ser feitas separadamente para cada sa\u00edda do ARX, incluindo estimativas de incertezas e intervalos de confian\u00e7a.\nAP\u00caNDICE 3\nBASE ESTAT\u00cdSTICA DO PREDITOR ARX-MIMO\n\u2022 Caracteriza\u00e7\u00e3o da Estima\u00e7\u00e3o\n(i)\tO, \u00e9 normal, logo 0 i como fun\u00e7\u00e3o linear de O, tamb\u00e9m \u00e9 normal;\n(ii)\t0, \u00e9\testimativa n\u00e3o-tendenciosa:\tE((^i) = [X\u2019W,\ti) sendo\nE(O,.) = h i = X\u00d4 i , tem-se que (equa\u00e7\u00e3o 3.1):\nE(\u00d4_i) = 0 i\t(3.1)\n(iii)\t0, \u00e9 estimativa coerente:\ncov_(\u00f4,) = E[(\u00eai -0 i)(\u00eai -0 ,)\u2019\ncom a equa\u00e7\u00e3o 24 escreve-se:\n0, -0i = [XtWiX]~^X\u2019W^, -h i), resultando, com (equa\u00e7\u00e3o 19), em (equa\u00e7\u00e3o 3.2) COV(\u00d4,) = l, [wx] 1\t(3.2)\ntransparecendo a coer\u00eancia quando N .\n(iv)\tComportamento de Ai (equa\u00e7\u00e3o 3.3):\nAi = (0,-0,)\u2019[COV(\u00d4,)]~\\\u00d4, -0i)\t(3.3)\nOra, COV(6,) \u00e9 sim\u00e9trica positiva-definida podendo ser fatorada segundo (3.4):\nCOV(\u00d4, ) = PeP\t|cOV(0, )]1 = Pe~1P\u2019\t(3.4)\nonde e \u00e9 diagonal de autovalores positivos e P\u00e9 ortogonal de autovalores ortonormais. Assim (equa\u00e7\u00f5es 3.5 e 3.6):\nA i = (0,-0 i)tp\u00a3~V2e~V2pt((-i-0- i)\t(3.5)\nA, = ZiZ,;\tz, =E~1l2p\u2019(0i-0,)\t(3.6)\nMas Z, \u00e9 combina\u00e7\u00e3o de normais, logo \u00e9 normal;\nE(Zi) = 0\nCOV(Zi) = E(ZiZ\u2019) = I\nPortanto, cada componente de Z, segue distribui\u00e7\u00e3o normal padronizada sem correla\u00e7\u00e3o entre eles. Disto resulta que A, segue, por (4.24), distribui\u00e7\u00e3o X2 com nx*ny + m*nu graus de liberdade (equa\u00e7\u00e3o 3.7):\nA, ^X\n2 v=n*ny+m*nu\n(3.7)\n\u2022 Estima\u00e7\u00e3o de_ 1 j: \u2014 (sa\u00edda i)\n4j-hj =Uj - Yj)+ Y-hj) (j=1,2,..,N)\n_ 1\nonde, com: R = 1j W;\nOra, usando-se\n(Yj ~hj)= X\u2014\tj), verifica-se que o \u00faltimo termo \u00e0 direita em (3.8) \u00e9 nulo\ndevido \u00e0 equa\u00e7\u00e3o de ponto estacion\u00e1rio (equa\u00e7\u00e3o 23). Com a mesma substitui\u00e7\u00e3o verifica-se que o segundo termo \u00e0 direita \u00e9 A j (via 3.2 e 3.3). Finamente, o termo \u00e0 esquerda segue distribui\u00e7\u00e3o X2 * com N graus de liberdade (via hip\u00f3tese (ii) da estima\u00e7\u00e3o, equa\u00e7\u00e3o 19, e \u00e1lgebra similar \u00e0 usada em (3.3) a (3.7). Portanto, (3.8) traduz-se em (equa\u00e7\u00e3o 3.9):\nXv = SR,\n,2 (N - n*ny - m*nu)\n+ Xv=n*ny+m*nu\n(3.9)\n\nonde (equa\u00e7\u00e3o 3.10):\nS\n2 R =\n1\nN - n*ny - m*nu\n(* j\n-\tj - Yj)\n(3.10)\n2\nOra, pelo teorema da Parti\u00e7\u00e3o X resulta que o primeiro termo \u00e0 direita \u00e9 (equa\u00e7\u00e3o 3.11):\nSR (N - n*ny - m*nu)\t2\n* Xv=N-n*ny-m*nu\nlj\nou (equa\u00e7\u00e3o 3.12)\nSr\nlj\nN - n*ny - m* nu y\nXv = N- n*ny- m*nu\nDando que (equa\u00e7\u00f5es 3.13 e 3.14)\nE(SR) = 1\nVar(SR) =\n21?\nN - n*ny - m*nu\nV\t7\n(3.11)\n(3.12)\n(3.13)\n(3.14)\n\u00ed\n\nAl\u00e9m de ser independente de \u2014.\n2\t2\nEm outras palavras, SR \u00e9 um estimador coerente e n\u00e3o-tendencioso para : lj = SR .\nDisto resulta tamb\u00e9m que (equa\u00e7\u00e3o 3.15)\ncovi\u00ea) = sR [wx]1\t(3.15)\n\u2022 Regi\u00e3o de Confian\u00e7a de Par\u00e2metros Corretos para a Sa\u00edda i 3_j (equa\u00e7\u00e3o 3.16)\nAj = (\u00d4j -3jf [COV(\u00d4j)] 1(3-3) ~> /r=n*ny+m*nu\t(3.16)\nSR (N - n*ny - m*nu)\t2\n* Xv=N-n*ny-m*nu\nDada a independ\u00eancia entre estas quantidades, dada (4.20), e com o teorema F sobre a raz\u00e3o de\n2\nvari\u00e1veis X , chega-se \u00e0 equa\u00e7\u00e3o 3.17:\n-\u00d3Lj)t[XtWjX]~ ^(O-\u00d3Li\nSR (n* ny+m*nu)\nIsto \u00e9, a raz\u00e3o \u00e0 esquerda segue distribui\u00e7\u00e3o F com graus de liberdade indicados.\nSeja fi_a a abcissa Fisher obtida para a distribui\u00e7\u00e3o F tal que a probabilidade dela ser ultrapassada \u00e9\nde Prob(\u2014 &lt;\u2014i_a ) = (1 -a)*100%,\t. = 0.1,0.05,0.01,.. ou menos. Assim:\n(\u00bbi -3i ),[X,W\u00edXT'((\u00cd\u00ed -3i) S sR (n*ny + m* nu)fi_a\t(3.18)\nregi\u00e3o de confian\u00e7a para 3_jcom probabilidade (1 -a)*100%.\n-\tF(n *ny + m* nu, N - n*ny - m*nu)\n(3.17)\n\u2022 Regi\u00e3o de Confian\u00e7a para Predi\u00e7\u00f5es Corretas na Janela de Treinamento do ARX-MIMO\nCom (2.6), (3.1) e (equa\u00e7\u00e3o 17)\nE(Yj) = X3 j =h j\nPortanto (equa\u00e7\u00e3o 3.20):\nCOVC\u00cdj) = E[C\u00cdj-h \u00ed)(Y\u00ed-h)]\nCom (Yj ~hj) = X(\u00d3j ~ 0j)chega-se a (equa\u00e7\u00e3o 3.21):\nCOV(Y,) = i[XWVX]1Xt\n(3.19)\n(3.20)\n(3.21)\nDonde (equa\u00e7\u00e3o 3.22)\nCOV(Y:) = 1X[X*WX] 'X\t(3.22)\nOra, por (2.6), Y_i \u00e9 fun\u00e7\u00e3o linear de 0\u00b0 cujo comportamento \u00e9 normal. Logo, Y_i tamb\u00e9m tem comportamento normal. Admitindo pequena ou nenhuma correla\u00e7\u00e3o de Yj, tem-se com (3.19) e (3.21):\nY\tNh ik,iiXk~ '[xWiXr 'Xk\nOnde N(a,b) representa comportamento normal com m\u00e9dia \u201ca\u201d e vari\u00e2ncia \u201cb\u201d; Xk \u00e9 a k-\u00e9sima linha de X ; e Yik \u00e9 o k-\u00e9sima componente de Yj, isto \u00e9:\nYik = Yi(t + k)(ver (4.5)). Tem-se assim:\ntYik~h ik -\tN(0i,')\n\u25a0p-iXk [XWiX]~X\nSR(N - n*ny - m*nu)\t2\nl\t> Xv=N-n*ny-m*nu\n2\nPela independ\u00eancia entre e Oi, e por (2.6), tem-se independ\u00eancia entre os dois termos \u00e0 esquerda acima. Com o Teorema t, acerca da raz\u00e3o da vari\u00e1vel normal padronizada e raiz quadrada de vari\u00e1vel 2\nX , chega-se a (equa\u00e7\u00e3o 3.23):\nt=\nYi ~h ik\n. XrX.XXw X] 'X\n---~*r=N-n*ny-m*nu\nXk\n(3.23)\nIsto \u00e9, a raz\u00e3o acima segue distribui\u00e7\u00e3o t com grau de liberdade indicado.\nSeja t1-a/2 a abcissa obtida na distribui\u00e7\u00e3o tal que a probabilidade de ela ser ultrapassada \u00e9 de a/2*100%o (a=0,05; 0,01; etc). Assim, com (3.23) tem-se (3.24)\nYik - *'-a/2\n-a/2\n(3.24)\nque \u00e9 o intervalo de confian\u00e7a para hikcom probabilidade (1-a)*100%>, onde (equa\u00e7\u00e3o 3.25):\nFk = Xk,[X,WiX]~ 'Xk\nou, equivalentemente (equa\u00e7\u00e3o 3.26),\n(3.25)\nYi(t + k)-tj_a/2^SRFik - pi(t + k) - Yi(t + k) + h-a/2^SRFik\t(3.26)\nque \u00e9 o intervalo de confian\u00e7a para predi\u00e7\u00e3o correta da sa\u00edda \u201ci\u201d no instante t+k, (l &lt;k &lt;N), na janela de treinamento, com probabilidade (1 - a)*100% .\n\u2022 Regi\u00e3o de confian\u00e7a para predi\u00e7\u00f5es corretas fora da janela de treinamento do ARX-MIMO:\nAp\u00f3s estima\u00e7\u00e3o de 6_i (i=1...ny), o preditor operar\u00e1 fora da janela de treinamento para predizer sa\u00edda \u201ci\u201d em instante k+1, tem-se (equa\u00e7\u00f5es 3.27 e 3.28):\nY(k+1)=zq\n(3.27)\nZk = [- Yt(k)- Yt(k -1)....- Yt(k - (n - 1)Ut(k)Ut(k - 1).^Ut(k - (m -1))] (3.28)\n(k+1>t+N)\nAssim, dada a normalidade de dj, tem-se que Y(k +1)tamb\u00e9m segue comportamento normal, dando (equa\u00e7\u00f5es 3.29 e 3.30):\nE(Yi(k + 1)) = zke i =p (k + 1)\t(3.29)\nVAR(Y,(K+1) = Zk (-e i )\u2022(-e i )k}\nVAR(Yj(K +1) = Z\u2018:COV((_. )zk\nVAR(YI(K +1) = l.Z't[x:WXj1Zt\t(3.30)\nA partir disto pode-se escrever analogamente ao caso anterior\nt = Y(k + 1)-p (k +1)\n^ZkixWxr Z\nN(0,1)\nSR (N - n*ny - m*nu)\t2\nXv=N-n*ny-m*nu\nli\nPela independ\u00eancia entre os termos \u00e0 esquerda e seguindo processo id\u00eantico ao anterior via teorema t, chega-se \u00e0 express\u00e3o do intervalo de confian\u00e7a para a predi\u00e7\u00e3o correta da resposta\u201di\u201d em instante k+1\t(k+1>t+N) com probabilidade\n(1 - a)*100% (a = 0.05,0.01,etc) (equa\u00e7\u00e3o 3.31):\nYi(k + 1)-t1_a/2^lSRFik\ti(k + 1)Yi(k + 1)+ t1-a/2^SRFik\n(3.31)\n(k+1>t+N)\nonde (equa\u00e7\u00f5es 3.32 e 3.33)\nF* _ Zk['ivx]'zk\nYi(k +1) _ Zq\n(3.32)\n(3.33)\n(t\\-a/2 exatamente a mesma da f\u00f3rmula (3.26))."}]}}}