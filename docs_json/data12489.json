{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.16882"}, {"@name": "filename", "#text": "23579_000730603.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL \n\nINSTITUTO DE INFORM\u00c1TICA \n\nCURSO DE CI\u00caNCIA DA COMPUTA\u00c7\u00c3O \n\n \n\n \n\n \n\n \n\n \n\nVINICIUS ROSA DOS SANTOS \n\n \n\n \n\n \n\n \n\nSistema de busca e exibi\u00e7\u00e3o de dados \ngeorreferenciados \n\n \n\n \n\n \n\n \n\n \n\n \n\nTrabalho de Gradua\u00e7\u00e3o. \n \n \n \n \n \nProf. Dr. Carlos Alberto Heuser \nOrientador \n \n \n\n \n \n \n \n \n \n \n \n \n\nPorto Alegre, novembro de 2009.\n\n\n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n \n \n\n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \nUNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL \nReitor: Prof. Carlos Alexandre Netto \nVice-Reitor: Prof. Rui Vicente Oppermann \nPr\u00f3-Reitora de Gradua\u00e7\u00e3o: Profa. Valquiria Link Bassani \nDiretor do Instituto de Inform\u00e1tica: Prof. Fl\u00e1vio Rech Wagner \nCoordenador do CIC: Prof. Jo\u00e3o C\u00e9sar Netto \nBibliotec\u00e1ria-Chefe do Instituto de Inform\u00e1tica: Beatriz Regina Bastos Haro \n \n\n \n\n\n\n \n\n \n\n \n\nSUM\u00c1RIO \n\nLISTA DE ABREVIATURAS E SIGLAS ................................................................... 4 \nLISTA DE FIGURAS ..................................................................................................... 5 \nLISTA DE TABELAS .................................................................................................... 6 \nRESUMO ......................................................................................................................... 7 \nABSTRACT .................................................................................................................... 8 \n1 INTRODU\u00c7\u00c3O ...................................................................................................... 9 \n2 SERVI\u00c7OS DE EXIBI\u00c7\u00c3O DE DADOS GEORREFERENCIADOS ........... 11 \n2.1 Google Maps ...................................................................................................... 11 \n2.1.1 Pol\u00edgonos .................................................................................................... 12 \n2.1.2 Marcadores ................................................................................................. 12 \n2.1.3 Limites geogr\u00e1ficos .................................................................................... 13 \n2.1.4 Coordenadas geogr\u00e1ficas ............................................................................ 13 \n2.2 GeoNames .......................................................................................................... 13 \n3 T\u00c9CNICAS DE BUSCA DE DADOS POR SIMILARIDADE ........................ 15 \n3.1 Ideia b\u00e1sica da solu\u00e7\u00e3o ..................................................................................... 15 \n3.2 Detalhamento da solu\u00e7\u00e3o ................................................................................. 16 \n3.2.1 Nota\u00e7\u00f5es b\u00e1sicas ......................................................................................... 16 \n3.2.2 Q-grams ...................................................................................................... 16 \n3.2.3 Problema a ser resolvido............................................................................. 17 \n3.2.4 Solu\u00e7\u00e3o simplista ........................................................................................ 17 \n3.2.5 Prepara\u00e7\u00e3o do banco de dados .................................................................... 18 \n3.2.6 Filtragem de resultados atrav\u00e9s de propriedades dos q-grams ................... 18 \n3.2.6.1               Filtro por contagem .............................................................................. 18 \n3.2.6.2               Filtro por posi\u00e7\u00e3o .................................................................................. 19 \n3.2.6.3               Filtro por tamanho ................................................................................ 19 \n3.2.7 Express\u00e3o e avalia\u00e7\u00e3o SQL ........................................................................ 19 \n3.3 Utiliza\u00e7\u00e3o da t\u00e9cnica na aplica\u00e7\u00e3o ................................................................... 21 \n4 FUNCIONALIDADES DA APLICA\u00c7\u00c3O ......................................................... 22 \n4.1 Diagrama de casos de uso ................................................................................ 22 \n4.2 Descri\u00e7\u00f5es textuais de casos de uso e telas de interface ................................ 24 \n5 ARQUITETURA DA APLICA\u00c7\u00c3O .................................................................. 41 \n5.1 Arquitetura geral .............................................................................................. 41 \n5.2 Modelo de dados ............................................................................................... 43 \n5.3 Diagramas de classes ........................................................................................ 45 \n5.4 Diagramas de sequ\u00eancia ................................................................................... 50 \n6 CONCLUS\u00c3O ....................................................................................................... 55 \nREFER\u00caNCIAS ........................................................................................................... 56 \n\n\n\n \n\n \n\n \n\nLISTA DE ABREVIATURAS E SIGLAS \n\nAPI Application Programming Interface \n\nUDF User Defined Function \n\nSQL Structured Query Language \n\nUML Unified Modeling Language \n\nDBMS Database Management System \n\nJSON JavaScript Object Notation \n\n \n\n\n\n \n\n \n\n \n\nLISTA DE FIGURAS \n\nFigura 2.1: Interface do Google Maps......................................................................................... 11 \nFigura 3.1: Express\u00e3o SQL contendo as tr\u00eas propriedades dos q-grams .................................... 20 \nFigura 4.1: Diagrama de casos de uso da aplica\u00e7\u00e3o .................................................................... 23 \nFigura 4.2: Tela de interface inicial da aplica\u00e7\u00e3o ........................................................................ 25 \nFigura 4.3: Tela de interface do caso de uso \"Pesquisa estruturada por col\u00f4nia e linha\" ........... 26 \nFigura 4.4: Tela de interface do caso de uso \"Pesquisa estruturada por col\u00f4nia e linha\" com mais \nde uma linha colonial selecionada ............................................................................................... 27 \nFigura 4.5: Tela de interface do caso de uso \"Pesquisa nomes de propriet\u00e1rios\" ....................... 28 \nFigura 4.6: Tela de interface do caso de uso \"Pesquisa por propriet\u00e1rio\" ................................... 30 \nFigura 4.7: Tela de interface do caso de uso \"Pesquisa por propriet\u00e1rio\" em seu fluxo alternativo\n ..................................................................................................................................................... 31 \nFigura 4.8: Tela de interface do caso de uso \"Pesquisa nomes de cidades\" ................................ 32 \nFigura 4.9: Tela de interface do caso de uso \"Pesquisa por cidade\" ........................................... 34 \nFigura 4.10: Tela de interface do caso de uso \"Pesquisa por cidade\" em seu fluxo alternativo.. 34 \nFigura 4.11: Tela de interface do caso de uso \"Pesquisa nomes de cidades\" .............................. 36 \nFigura 4.12: Tela de interface do caso de uso \"Pesquisa livre por col\u00f4nia e linha\" com sele\u00e7\u00e3o \nde col\u00f4nia .................................................................................................................................... 38 \nFigura 4.13: Tela de interface do caso de uso \"Pesquisa livre por col\u00f4nia e linha\" com sele\u00e7\u00e3o \nde linha ........................................................................................................................................ 38 \nFigura 4.14: Tela de interface do caso de uso \"Pesquisa por localidade\" em seu fluxo alternativo\n ..................................................................................................................................................... 39 \nFigura 4.15: Tela de interface do caso de uso \"Pesquisa informa\u00e7\u00f5es do lote\" .......................... 40 \nFigura 5.1: Arquitetura geral do sistema ..................................................................................... 41 \nFigura 5.2: Modelo ER da aplica\u00e7\u00e3o ........................................................................................... 44 \nFigura 5.3: Diagrama de classes: classes de neg\u00f3cio .................................................................. 46 \nFigura 5.4: Diagrama de classes: classes de dados ..................................................................... 48 \nFigura 5.5: Diagrama de classes: classes \u00fateis ............................................................................ 49 \nFigura 5.6: Diagrama de sequ\u00eancia do caso de uso \"Pesquisa estruturada por col\u00f4nia e linha\" . 50 \nFigura 5.7: Diagrama de sequ\u00eancia do caso de uso \"Pesquisa nomes de propriet\u00e1rios\" ............. 51 \nFigura 5.8: Diagrama de sequ\u00eancia do caso de uso \"Pesquisa por propriet\u00e1rio\" ........................ 52 \nFigura 5.9: Diagrama de sequ\u00eancia do caso de uso \"Pesquisa nomes de cidades\" ..................... 52 \nFigura 5.10: Diagrama de sequ\u00eancia do caso de uso \"Pesquisa por cidade\" ............................... 53 \nFigura 5.11: Diagrama de sequ\u00eancia do caso de uso \"Pesquisa nomes de localidades\" ............. 53 \nFigura 5.12: Diagrama de sequ\u00eancia do caso de uso \"Pesquisa livre por col\u00f4nia e linha\" ......... 54 \nFigura 5.13: Diagrama de sequ\u00eancia do caso de uso \"Pesquisa informa\u00e7\u00f5es do lote\" ................ 54 \n \n\n\n\n \n\n \n\n \n\nLISTA DE TABELAS \n\nTabela 4.1: Descri\u00e7\u00e3o do caso de uso \"Pesquisa estruturada por col\u00f4nia e linha\" ...................... 25 \nTabela 4.2: Descri\u00e7\u00e3o do caso de uso \"Pesquisa nomes de propriet\u00e1rios\" .................................. 27 \nTabela 4.3: Descri\u00e7\u00e3o do caso de uso \"Pesquisa por propriet\u00e1rio\" ............................................. 29 \nTabela 4.4: Descri\u00e7\u00e3o do caso de uso \"Pesquisa nomes de cidades\" .......................................... 31 \nTabela 4.5: Descri\u00e7\u00e3o do caso de uso \"Pesquisa por cidade\" ...................................................... 32 \nTabela 4.6: Descri\u00e7\u00e3o do caso de uso \"Pesquisa nomes de localidades\" .................................... 35 \nTabela 4.7: Descri\u00e7\u00e3o do caso de uso \"Pesquisa livre por col\u00f4nia e linha\" ................................ 36 \nTabela 4.8: Descri\u00e7\u00e3o do caso de uso \"Pesquisa informa\u00e7\u00f5es do lote\" ....................................... 39 \n\n\n\n \n\n \n\n \n\n  \n\nRESUMO \n\nUm dos maiores problemas encontrados por historiadores e ge\u00f3logos ao trabalharem \ncom informa\u00e7\u00f5es hist\u00f3ricas relativas \u00e0 nossa coloniza\u00e7\u00e3o, especialmente informa\u00e7\u00f5es \ngeogr\u00e1ficas e refer\u00eancias geneal\u00f3gicas, \u00e9 como publicar tais dados. As ferramentas de \nsoftware de georreferenciamento e geoprocessamento dispon\u00edveis no mercado carecem \nde uma forma simplificada e acess\u00edvel de visualiza\u00e7\u00e3o e pesquisa das informa\u00e7\u00f5es \ncoletadas. Uma alternativa \u00e9 combinar servi\u00e7os e t\u00e9cnicas variadas em uma s\u00f3 solu\u00e7\u00e3o, \nprovendo ao usu\u00e1rio final uma experi\u00eancia satisfat\u00f3ria na intera\u00e7\u00e3o com os dados \ncoloniais. Neste trabalho \u00e9 apresentado um sistema que mescla as funcionalidades de \num servi\u00e7o Web de mapeamento geogr\u00e1fico com t\u00e9cnicas de busca de informa\u00e7\u00f5es por \nsimilaridade, com o objetivo de publicar informa\u00e7\u00f5es coloniais do Estado do Rio \nGrande do Sul. Desta forma, obt\u00e9m-se uma f\u00e1cil visualiza\u00e7\u00e3o das regi\u00f5es coloniais em \num mapa e uma alta flexibilidade na pesquisa dos dados cadastrados, uma vez que \ninforma\u00e7\u00f5es hist\u00f3ricas s\u00e3o sens\u00edveis a erros tipogr\u00e1ficos e possuem grafias alternativas \npara nomes de lugares e pessoas. Al\u00e9m disso, a solu\u00e7\u00e3o proposta \u00e9 acess\u00edvel \nglobalmente atrav\u00e9s da Internet, podendo ser consultada por qualquer interessado. \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nPalavras-Chave: georreferenciamento, busca por similaridade, geoprocessamento, \nmapeamento \n\n\n\n \n\n \n\n \n\nGeoreferenced data search and display system \n\nABSTRACT \n\nOne of the main problems encountered by historians and geologists when they work \nwith historical information related to our colonization, especially geographic \ninformation and genealogical references, is how to publish such data. The available \ncommercial software tools for georeferencing and geoprocessing lack of a simplified \nand accessible way of visualization and search of the collected information. An \nalternative is to combine various services and techniques in a single solution, providing \nthe end user a satisfying experience in interacting with the colonial data. This paper \npresents a system that combines the functionality of a web mapping service application \nwith similarity search techniques in order to publish colonial information about Rio \nGrande do Sul State. Thus, easy visualization of the colonial regions on a map is \nobtained. Besides that, a high flexibility in the search of the registered data is acquired, \nas historical information are sensitive to typographical errors and have alternative \nspellings for places and people names. Moreover, the proposed solution is available \nglobally via the Internet and can be consulted by anyone interested. \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nKeywords: georeferencing, similarity search, geoprocessing, mapping \n\n\n\n \n\n \n\n \n\n1 INTRODU\u00c7\u00c3O \n\nMuitos historiadores, ge\u00f3logos e ge\u00f3grafos, principalmente do Rio Grande do Sul, \nt\u00eam um interesse especial sobre informa\u00e7\u00f5es hist\u00f3ricas referentes \u00e0 coloniza\u00e7\u00e3o do \nEstado. Fontes de dados sobre a divis\u00e3o geogr\u00e1fica das col\u00f4nias e sobre seus \npropriet\u00e1rios (possivelmente por um interesse na genealogia de tais colonos) mostram-\nse abundantes nos mais variados formatos, desde documentos oficiais antigos a simples \nrelatos passados de gera\u00e7\u00e3o em gera\u00e7\u00e3o. Entretanto, o problema reside, principalmente, \nno momento dessas informa\u00e7\u00f5es serem catalogadas, unificadas e exibidas em um meio \ncomum que seja de f\u00e1cil visualiza\u00e7\u00e3o e de acesso global. Existem v\u00e1rios aplicativos que \nauxiliam no georreferenciamento dos dados, ou seja, na transcri\u00e7\u00e3o das informa\u00e7\u00f5es de \numa imagem, por exemplo, para coordenadas geogr\u00e1ficas. O mais famoso deles \u00e9 o \nArcGIS (http://www.esri.com/software/arcgis/), uma su\u00edte de aplica\u00e7\u00f5es com v\u00e1rios \nutilit\u00e1rios voltados exclusivamente ao processamento de dados geogr\u00e1ficos. O software \ntamb\u00e9m auxilia na cataloga\u00e7\u00e3o de qualquer tipo de informa\u00e7\u00e3o agregada. Contudo, al\u00e9m \nde ser um aplicativo pago, n\u00e3o oferece uma interface acess\u00edvel a qualquer pessoa \ninteressada na visualiza\u00e7\u00e3o dos dados. Tamb\u00e9m n\u00e3o resolve o problema de unifica\u00e7\u00e3o \ndas informa\u00e7\u00f5es, uma vez que, j\u00e1 que elas v\u00eam de diversas fontes, diferentes grafias de \nnomes de lugares e pessoas podem ser utilizadas. O ideal seria uma ferramenta \ndispon\u00edvel atrav\u00e9s da Web, com acesso livre a todos e que disponibilizasse uma forma \nflex\u00edvel de consulta aos dados. \n\nFelizmente, a Internet oferece alguns servi\u00e7os gratuitos que podem auxiliar na \nvisualiza\u00e7\u00e3o de dados geogr\u00e1ficos atrav\u00e9s de mapas. Talvez o mais famoso deles seja o \nGoogle Maps (GOOGLE, 2009), o qual, atrav\u00e9s de seus mapas e imagens de sat\u00e9lite, \npermite que qualquer dado geogr\u00e1fico espacial seja exibido como se estivesse em um \nmapa f\u00edsico. Al\u00e9m disso, seu atlas compreende todo o territ\u00f3rio da Terra e com n\u00edveis de \ndetalhe impressionantes no Rio Grande do Sul, permitindo uma an\u00e1lise bastante apurada \ndas informa\u00e7\u00f5es geogr\u00e1ficas que exibe. \n\nPara a resolu\u00e7\u00e3o do problema referente \u00e0 unifica\u00e7\u00e3o dos dados provindos de fontes \ndiferentes, existem t\u00e9cnicas de busca de informa\u00e7\u00f5es por similaridade. Atrav\u00e9s delas, a \ninforma\u00e7\u00e3o pesquisada pelo usu\u00e1rio \u00e9 comparada por aproxima\u00e7\u00e3o aos dados \ncadastrados. Com tal flexibilidade, n\u00e3o existe a necessidade do usu\u00e1rio saber a grafia \nexata de um determinado nome ou lugar, bastando que o mesmo informe algo \n\u201cparecido\u201d. \n\nA solu\u00e7\u00e3o proposta adota o Google Maps como ferramenta de visualiza\u00e7\u00e3o dos \ndados geogr\u00e1ficos espaciais e a t\u00e9cnica apresentada em (GRAVANO, 2005) para a \nimplementa\u00e7\u00e3o da busca de informa\u00e7\u00f5es por similaridade. Os dados cadastrados \nreferem-se \u00e0 coloniza\u00e7\u00e3o italiana e alem\u00e3 no Rio Grande do Sul no final do s\u00e9culo XIX. \nTodas as informa\u00e7\u00f5es foram cedidas por Otavio Augusto Boni Licht, ge\u00f3logo, mestre e \n\n\n\n \n\n \n\n10 \n\ndoutor, da L&amp;S Consultoria Geol\u00f3gica Ltda, de Curitiba, PR. Os dados foram \ngeorreferenciados atrav\u00e9s do software ArcGIS e, para serem utilizados pela aplica\u00e7\u00e3o, \nforam convertidos de forma que pudessem popular um banco de dados relacional. \n\nO presente documento est\u00e1 organizado conforme o que se segue. O cap\u00edtulo 2 \napresenta uma discuss\u00e3o detalhada a respeito do Google Maps e como o mesmo foi \nutilizado na solu\u00e7\u00e3o proposta, al\u00e9m de apresentar o GeoNames, outro servi\u00e7o Web que \nfornece algumas informa\u00e7\u00f5es adicionais sobre dados georreferenciados. O cap\u00edtulo 3 \nexplica a t\u00e9cnica de busca por similaridade utilizada, mostrando exemplos conceituais e \nsua aplica\u00e7\u00e3o na solu\u00e7\u00e3o. O cap\u00edtulo 4 mostra as funcionalidades do sistema, isto \u00e9, o \nque ele oferece ao usu\u00e1rio. Finalmente, o cap\u00edtulo 5 demonstra como as funcionalidades \nda aplica\u00e7\u00e3o foram implementadas atrav\u00e9s da arquitetura geral do sistema. \n\n\n\n \n\n \n\n \n\n2 SERVI\u00c7OS DE EXIBI\u00c7\u00c3O DE DADOS \nGEORREFENCIADOS \n\nDispondo de dados georreferenciados referentes \u00e0s col\u00f4nias italianas e alem\u00e3s do \nRio Grande do Sul, \u00e9 necess\u00e1rio um meio para exibi-los em um mapa que seja acess\u00edvel \nglobalmente atrav\u00e9s da Internet. Al\u00e9m disso, tamb\u00e9m seria interessante mostrar algumas \ninforma\u00e7\u00f5es adicionais, obtidas atrav\u00e9s de geoprocessamento, sobre os lotes coloniais. \nPara tanto, a aplica\u00e7\u00e3o faz uso do Google Maps, um servi\u00e7o Web de mapeamento, o \nqual tem todas as ferramentas necess\u00e1rias para uma detalhada visualiza\u00e7\u00e3o dos dados, e \ndo GeoNames, outro servi\u00e7o Web que mant\u00e9m uma base de dados geogr\u00e1fica e que \nfornece v\u00e1rios tipos de informa\u00e7\u00e3o a partir de determinadas coordenadas geogr\u00e1ficas. \nUma explica\u00e7\u00e3o sobre ambos os servi\u00e7os e como eles s\u00e3o utilizados pela aplica\u00e7\u00e3o ser\u00e1 \napresentada durante o decorrer do cap\u00edtulo. \n\n2.1 Google Maps \nO Google Maps (GOOGLE, 2009) \u00e9 um servi\u00e7o Web de pesquisa e visualiza\u00e7\u00e3o de \n\nmapas e imagens de sat\u00e9lite, fornecido e desenvolvido pela empresa Google. Oferece \nmapas de ruas, planejamento de rotas a p\u00e9, a carro ou por transporte p\u00fablico, al\u00e9m de \nv\u00e1rios outros servi\u00e7os. Uma vez que \u00e9 totalmente acess\u00edvel atrav\u00e9s da Internet, torna-se \num meio formid\u00e1vel para a publica\u00e7\u00e3o de dados de interesse p\u00fablico. A Figura 2.1 \nmostra a interface inicial do site. \n\n \n\nFigura 2.1: Interface do Google Maps \n\n \n\n\n\n \n\n \n\n12 \n\nO servi\u00e7o tamb\u00e9m oferece, de forma gratuita para uso n\u00e3o-comercial, uma API \n(Application Programming Interface) acess\u00edvel atrav\u00e9s da linguagem de programa\u00e7\u00e3o \nJavaScript, possibilitando que as funcionalidades do Google Maps sejam incorporadas a \nqualquer p\u00e1gina Web. Dessa forma, os mapas podem ser manipulados a partir de v\u00e1rios \nutilit\u00e1rios dispon\u00edveis pela API. Dentre tais servi\u00e7os, destacam-se a cria\u00e7\u00e3o de rotas a \npartir de pontos de in\u00edcio e fim (da mesma forma j\u00e1 existente no site), a geocodifica\u00e7\u00e3o \ndireta (obten\u00e7\u00e3o das coordenadas geogr\u00e1ficas de um dado endere\u00e7o) e a reversa \n(obten\u00e7\u00e3o do endere\u00e7o de uma rua atrav\u00e9s de suas coordenadas geogr\u00e1ficas). Por causa \nda farta documenta\u00e7\u00e3o dispon\u00edvel sobre sua API, ampla abrang\u00eancia de localidades e \npor sua popularidade na Web, o Google Maps foi o escolhido para ser utilizado na \naplica\u00e7\u00e3o. Outros servi\u00e7os de mapeamento tamb\u00e9m foram cogitados, tais como Bing \nMaps (BING, 2009) e Yahoo Maps (YAHOO, 2009), mas foram descartados em \ndetrimento do servi\u00e7o da Google. Apesar das in\u00fameras funcionalidades dispon\u00edveis, a \naplica\u00e7\u00e3o utiliza apenas aquelas necess\u00e1rias \u00e0 exibi\u00e7\u00e3o e intera\u00e7\u00e3o com os lotes \ncoloniais no mapa e outras quest\u00f5es relacionadas a zoom de uma determinada regi\u00e3o \npelo usu\u00e1rio. Tais funcionalidades e suas respectivas estruturas de dados ser\u00e3o \nexplicadas a seguir. \n\n2.1.1 Pol\u00edgonos \n\nA API do Google Maps oferece a possibilidade do desenho de pol\u00edgonos de \nqualquer formato no mapa. Para tanto, basta que sejam informadas as coordenadas \ngeogr\u00e1ficas (latitude e longitude) dos v\u00e9rtices do pol\u00edgono. Essas formas geom\u00e9tricas \ns\u00e3o utilizadas na aplica\u00e7\u00e3o para representar um determinado lote colonial no mapa. \nAlgumas op\u00e7\u00f5es de customiza\u00e7\u00e3o tamb\u00e9m s\u00e3o oferecidas, tais como cor e opacidade do \npreenchimento e da borda do pol\u00edgono. Contudo, a forma geom\u00e9trica n\u00e3o \u00e9 apenas um \nmero desenho no mapa: \u00e9 uma estrutura de dados que cont\u00e9m propriedades que podem \nser lidas e definidas em tempo de execu\u00e7\u00e3o, al\u00e9m de fornecer uma s\u00e9rie de eventos \ndisparados na intera\u00e7\u00e3o com o usu\u00e1rio. O \u00fanico evento utilizado na aplica\u00e7\u00e3o \u00e9 o que \nocorre quando o usu\u00e1rio clica sobre um determinado pol\u00edgono. Quando ele \u00e9 disparado, \ntodas as informa\u00e7\u00f5es dispon\u00edveis referentes ao lote clicado s\u00e3o buscadas no banco de \ndados e apresentadas em um bal\u00e3o de informa\u00e7\u00f5es situado sobre o pol\u00edgono, \nfuncionalidade esta que tamb\u00e9m \u00e9 fornecida pela API. Apesar de oferecer outras \nfuncionalidades, tais como altera\u00e7\u00e3o din\u00e2mica da forma de um pol\u00edgono ou at\u00e9 mesmo a \npossibilidade do usu\u00e1rio construir sua pr\u00f3pria forma geom\u00e9trica, a solu\u00e7\u00e3o fez uso \napenas de um subconjunto b\u00e1sico de opera\u00e7\u00f5es. \n\n2.1.2 Marcadores \n\nOs marcadores, como o pr\u00f3prio nome j\u00e1 diz, marcam no mapa uma determinada \ncoordenada geogr\u00e1fica definida pelo usu\u00e1rio atrav\u00e9s da API. De forma semelhante aos \npol\u00edgonos, basta que sejam informadas a latitude e longitude do ponto para que tal \nlocaliza\u00e7\u00e3o seja visualizada no mapa atrav\u00e9s de um \u00edcone. A aplica\u00e7\u00e3o utiliza \nmarcadores para apontar a localiza\u00e7\u00e3o do lote de um determinado propriet\u00e1rio. A API \npossibilita que o \u00edcone do marcador seja totalmente customizado, podendo ser utilizada \nqualquer imagem definida pelo usu\u00e1rio. Os marcadores fornecem ainda mais \nfuncionalidades do que as oferecidas pelos pol\u00edgonos, com mais propriedades e eventos \ndispon\u00edveis. Na aplica\u00e7\u00e3o, \u00e9 usado o evento de clique sobre o marcador e, assim como \nacontece com os pol\u00edgonos, as informa\u00e7\u00f5es referentes ao lote apontado s\u00e3o buscadas no \nbanco de dados e apresentadas no mesmo bal\u00e3o de informa\u00e7\u00f5es mencionado \n\n\n\n \n\n \n\n \n\nanteriormente. Al\u00e9m disso, o evento de clique com o bot\u00e3o direito do mouse tamb\u00e9m \u00e9 \ntratado, pois, dessa forma, \u00e9 poss\u00edvel que o lote seja ocultado do mapa. \n\n2.1.3 Limites geogr\u00e1ficos \n\nUm limite geogr\u00e1fico para a API do Google Maps \u00e9 um ret\u00e2ngulo n\u00e3o-visual em \ncoordenadas geogr\u00e1ficas. Na pr\u00e1tica, necessita de apenas duas informa\u00e7\u00f5es: a \ncoordenada sudoeste (canto esquerdo inferior do ret\u00e2ngulo) e a coordenada nordeste \n(canto direito superior do ret\u00e2ngulo). Atrav\u00e9s de um limite, tem-se conhecimento da \nviewport do usu\u00e1rio no mapa, ou seja, a \u00e1rea de visualiza\u00e7\u00e3o mostrada atualmente. Na \naplica\u00e7\u00e3o, \u00e9 constru\u00eddo um limite para cada regi\u00e3o visualizada pelo usu\u00e1rio, seja ela \numa col\u00f4nia ou uma linha colonial. Dessa forma, \u00e9 oferecida ao usu\u00e1rio a possibilidade \ndo mesmo realizar um zoom, a qualquer momento, sobre qualquer regi\u00e3o selecionada. \n\n2.1.4 Coordenadas geogr\u00e1ficas \n\nA API do Google Maps n\u00e3o trabalha apenas com valores em ponto flutuante de \nlatitude e longitude em suas coordenadas geogr\u00e1ficas. Assim como os demais itens \napresentados, uma coordenada \u00e9 uma estrutura de dados rica, com funcionalidades que \nv\u00e3o desde convers\u00e3o de valores para radianos at\u00e9 o c\u00e1lculo da dist\u00e2ncia entre duas dadas \ncoordenadas. Contudo, o uso de tais operadores na aplica\u00e7\u00e3o n\u00e3o se mostrou necess\u00e1rio. \n\n2.2 GeoNames \nO GeoNames (GEONAMES, 2009) \u00e9 uma base de dados geogr\u00e1fica, com acesso \n\ntotalmente gratuito e sob uma licen\u00e7a da Creative Commons Attribuition, a qual \u00e9 \nacess\u00edvel atrav\u00e9s de v\u00e1rios web services. Cont\u00e9m mais de oito milh\u00f5es de nomes \ngeogr\u00e1ficos e consiste em mais de seis milh\u00f5es e meio de recursos exclusivos, dos quais \nmais de dois milh\u00f5es s\u00e3o nomes de lugares povoados e outros quase dois milh\u00f5es \nreferem-se a nomes alternativos. Os dados armazenados no GeoNames podem ser \neditados na Web por todos os interessados. Al\u00e9m disso, o servi\u00e7o conta com \nembaixadores em v\u00e1rios pa\u00edses, os quais t\u00eam como fun\u00e7\u00e3o auxiliar na localiza\u00e7\u00e3o de \nfontes confi\u00e1veis de dados e em quest\u00f5es sobre a divis\u00e3o administrativa de cada na\u00e7\u00e3o. \n\nCada web service dispon\u00edvel pelo GeoNames prov\u00ea um tipo de informa\u00e7\u00e3o \ngeogr\u00e1fica diferente (ou o mesmo tipo de informa\u00e7\u00e3o de fontes distintas). A aplica\u00e7\u00e3o \nutiliza dois desses servi\u00e7os: dados da cidade mais pr\u00f3xima e eleva\u00e7\u00e3o de um \ndeterminado lote. \n\nA obten\u00e7\u00e3o dos dados da cidade mais pr\u00f3xima se d\u00e1 atrav\u00e9s do endere\u00e7o \nhttp://ws.geonames.org/findNearbyPlaceNameJSON?lat=xx.xx&amp;lng=yy.yy, onde xx.xx \n\u00e9 o valor de latitude e yy.yy \u00e9 o valor de longitude do local pesquisado. O retorno da \nrequisi\u00e7\u00e3o \u00e9 um objeto estruturado com v\u00e1rias informa\u00e7\u00f5es a respeito da localidade \nmais pr\u00f3xima do ponto de pesquisa, tais como nome da localidade, seu estado, pa\u00eds, \ntitula\u00e7\u00e3o (cidade, vila, etc), fuso hor\u00e1rio, entre outros. Na aplica\u00e7\u00e3o, apenas o nome da \ncidade \u00e9 utilizado. \n\nO banco de dados j\u00e1 est\u00e1 populado com a informa\u00e7\u00e3o de cidade de todos os lotes, ou \nseja, nenhuma requisi\u00e7\u00e3o \u00e9 realizada ao GeoNames durante a execu\u00e7\u00e3o da aplica\u00e7\u00e3o. No \npr\u00e9-processamento dos dados, quando os mesmos est\u00e3o sendo preparados para serem \ninseridos no banco, a API do Google Maps \u00e9 utilizada para se obter as coordenadas \n\n\n\n \n\n \n\n14 \n\ncentrais (latitude e longitude) de cada lote. Ent\u00e3o, \u00e9 realizada uma requisi\u00e7\u00e3o ao servi\u00e7o \npara cada lote, passando-se os valores da coordenada obtida de cada um deles. \n\nA eleva\u00e7\u00e3o do lote (ou seja, sua altura em rela\u00e7\u00e3o ao n\u00edvel do mar) \u00e9 obtida atrav\u00e9s \ndo endere\u00e7o http://ws.geonames.org/srtm3?lat=xx.xx&amp;lng=yy.yy, onde xx.xx \u00e9 o valor \nde latitude e yy.yy \u00e9 o valor de longitude da posi\u00e7\u00e3o pesquisada. A pesquisa \u00e9 baseada \nnos dados do SRTM (Shuttle Radar Topography Mission), um sistema de radar \nespecialmente modificado que voou juntamente com o Space Shuttle Endeavour (uma \nnave espacial da NASA) durante uma miss\u00e3o de onze dias em fevereiro de 2000. A \u00e1rea \nde amostra dos dados \u00e9 de 90m2, isto \u00e9, a cada 90m2 tem-se um valor de eleva\u00e7\u00e3o \ndistinto. O retorno da requisi\u00e7\u00e3o \u00e9 um simples n\u00famero informando a eleva\u00e7\u00e3o, em \nmetros, da posi\u00e7\u00e3o pesquisada. \n\nAssim como no caso do nome da cidade mais pr\u00f3xima, os dados de eleva\u00e7\u00e3o dos \nlotes s\u00e3o obtidos antes do banco de dados ser populado. Entretanto, n\u00e3o \u00e9 realizada \napenas uma requisi\u00e7\u00e3o por lote. Primeiramente, \u00e9 pesquisada a eleva\u00e7\u00e3o de cada \ncoordenada do lote e cada valor \u00e9 armazenado em uma lista pr\u00f3pria do lote. Depois, \nnovamente atrav\u00e9s da API do Google Maps, as coordenadas centrais do lote s\u00e3o obtidas \ne sua eleva\u00e7\u00e3o \u00e9 pesquisada, a qual tamb\u00e9m \u00e9 inserida na lista. Por fim, \u00e9 calculada a \nm\u00e9dia aritm\u00e9tica dos valores constantes na lista, tendo-se, desta forma, a eleva\u00e7\u00e3o \nm\u00e9dia aproximada do lote. \n\n\n\n \n\n \n\n \n\n3 T\u00c9CNICAS DE BUSCA DE DADOS POR \nSIMILARIDADE \n\nA manipula\u00e7\u00e3o de dados hist\u00f3ricos provindos de v\u00e1rias fontes de informa\u00e7\u00e3o \ndiferentes, como \u00e9 o caso da aplica\u00e7\u00e3o, leva, invariavelmente, a muitos erros \ntipogr\u00e1ficos em nomes de pessoas e lugares. Al\u00e9m disso, existem certos termos que s\u00e3o \nescritos praticamente da mesma forma, com a mudan\u00e7a de apenas uma ou duas letras. \nComo exemplo, podemos citar o sobrenome \u201cSchmidt\u201d, o qual, muitas vezes, \u00e9 escrito \ncomo \u201cSchmit\u201d, \u201cSchmitt\u201d ou \u201cShmidt\u201d. Tanto no caso de erros quanto no caso de \nnomes praticamente iguais, qualquer pesquisa que utilize uma compara\u00e7\u00e3o de nomes \nexata pode levar a um resultado n\u00e3o t\u00e3o relevante quanto o esperado. Afinal, o usu\u00e1rio \nmuitas vezes n\u00e3o sabe exatamente a grafia de um determinado nome. Portanto, nas \npesquisas por dados hist\u00f3ricos, deve ser utilizado um mecanismo que tenha tal \nflexibilidade a ponto de retornar resultados aproximados (at\u00e9 certo ponto) ao \npesquisado. \n\nPara resolver tais quest\u00f5es, a solu\u00e7\u00e3o proposta adota busca por similaridade nas \npesquisas por lotes coloniais atrav\u00e9s de nome de propriet\u00e1rio e localidade (col\u00f4nia ou \nlinha colonial). Uma vez que tais informa\u00e7\u00f5es est\u00e3o propensas a erros tipogr\u00e1ficos e/ou \ngrafias alternativas, elas foram escolhidas para a implementa\u00e7\u00e3o de tal mecanismo. \nTendo em vista que os bancos de dados comerciais n\u00e3o oferecem de forma direta a \nfuncionalidade de processamento por aproxima\u00e7\u00e3o de strings, a aplica\u00e7\u00e3o adota a \nsolu\u00e7\u00e3o proposta em (GRAVANO, 2005), a qual \u00e9 explicada durante o restante do \ncap\u00edtulo. \n\n3.1 Ideia b\u00e1sica da solu\u00e7\u00e3o \nA t\u00e9cnica foi criada tendo como objetivo correlacionar informa\u00e7\u00f5es, em formato \n\nstring, de fontes diferentes (possivelmente de bancos de dados distintos), criando-se \numa vis\u00e3o unificada das mesmas (por exemplo, dados de clientes em bases \nindependentes, onde, em cada uma, o nome do mesmo cliente aparece com grafias \nligeiramente diferentes). Para tanto, baseia-se no conceito de jun\u00e7\u00f5es (joins) em bancos \nde dados relacionais. Contudo, a solu\u00e7\u00e3o foi levemente adaptada na aplica\u00e7\u00e3o para que \nfosse implementada em buscas diretas por uma determinada string de pesquisa, ou seja, \nn\u00e3o se busca a correla\u00e7\u00e3o de dados. \n\nExistem algumas dificuldades na implanta\u00e7\u00e3o do processamento aproximado de \nstrings em bancos de dados relacionais, uma vez que, conforme j\u00e1 mencionado, eles n\u00e3o \noferecem tal suporte embutido. H\u00e1 certas ferramentas que podem ser utilizadas fora do \nbanco de dados, no pr\u00e9-processamento das informa\u00e7\u00f5es, o que, geralmente, n\u00e3o \u00e9 \ndesej\u00e1vel. Outra alternativa seria utilizar os algoritmos empregados por tais ferramentas \n\n\n\n \n\n \n\n16 \n\ncomo UDFs (User Defined Functions) na base de dados. Contudo, tal abordagem \u00e9 \nbastante ineficiente, principalmente tratando-se de jun\u00e7\u00f5es, pois os bancos relacionais, \nao avaliar jun\u00e7\u00f5es envolvendo UDFs cujos argumentos incluem atributos pertencendo a \nm\u00faltiplas tabelas, computam o produto cartesiano das mesmas e aplicam a UDF ap\u00f3s o \nprocessamento (GRAVANO, 2005). \n\nPara enfrentar tais dificuldades, a solu\u00e7\u00e3o utiliza t\u00e9cnicas para a identifica\u00e7\u00e3o \neficiente de todos os pares de strings com correspond\u00eancia aproximada em uma base de \ndados. Para tanto, deve ser especificada uma m\u00e9trica de aproxima\u00e7\u00e3o. O trabalho \nutiliza, para tal finalidade, a chamada \u201cdist\u00e2ncia de edi\u00e7\u00e3o\u201d (edit distance) entre duas \nstrings. De acordo com o conceito, exclus\u00e3o, inser\u00e7\u00e3o e substitui\u00e7\u00e3o de um caractere s\u00e3o \nconsideradas opera\u00e7\u00f5es de custo unit\u00e1rio e a dist\u00e2ncia de edi\u00e7\u00e3o entre duas strings \u00e9 \ndefinida como a sequ\u00eancia de opera\u00e7\u00f5es de menor custo que pode transformar uma \nstring na outra. \n\nA t\u00e9cnica de busca por similaridade abordada baseia-se no conceito de q-grams, \nque s\u00e3o pequenas substrings (de uma determinada palavra) de tamanho q, as quais s\u00e3o \ncomparadas entre si em uma dada pesquisa. Ao levar-se em considera\u00e7\u00e3o o n\u00famero total \nde correspond\u00eancias nas compara\u00e7\u00f5es realizadas e as posi\u00e7\u00f5es dos q-grams nessas \ncompara\u00e7\u00f5es, garante-se que n\u00e3o haja falsas rejei\u00e7\u00f5es de resultados utilizando-se a \nm\u00e9trica da dist\u00e2ncia de edi\u00e7\u00e3o. Al\u00e9m disso, \u00e9 realizada a identifica\u00e7\u00e3o de um conjunto \nde pares candidatos com poucos \u201cfalsos positivos\u201d (isto \u00e9, resultados que, a princ\u00edpio, \nparecem corretos, mas que na verdade devem ser descartados) que pode ser verificado \nposteriormente para uma melhor corre\u00e7\u00e3o do resultado final. \n\n3.2 Detalhamento da solu\u00e7\u00e3o \nA fim de detalhar a t\u00e9cnica de busca por aproxima\u00e7\u00e3o, inicialmente ser\u00e3o \n\napresentadas algumas defini\u00e7\u00f5es b\u00e1sicas referentes aos conceitos da solu\u00e7\u00e3o. \nPosteriormente, ser\u00e1 explicado como tais conceitos s\u00e3o aplicados em um banco de \ndados relacional para que a t\u00e9cnica funcione de maneira satisfat\u00f3ria. \n\n3.2.1 Nota\u00e7\u00f5es b\u00e1sicas \n\nAlgumas nota\u00e7\u00f5es s\u00e3o utilizadas durante o decorrer da explica\u00e7\u00e3o, as quais s\u00e3o \ndefinidas conforme se segue. \n\nUsa-se R, possivelmente com subscritos, para denotar tabelas, A, possivelmente \ncom subscritos, para denotar atributos de uma tabela e t, possivelmente com subscritos, \npara denotar registros em uma tabela. Usa-se a nota\u00e7\u00e3o R.Ai para refer\u00eancia ao atributo \nAi da tabela R e R.Ai(tj) para refer\u00eancia ao valor do atributo R.Ai do registro tj. \n\nUsa-se ? como um alfabeto finito de tamanho |?|. Faz-se o uso de s\u00edmbolos gregos \nem letra min\u00fascula, tal como ?, possivelmente com subscritos, para denotar strings em \n?*. Sendo ? ? ?* uma string de tamanho n, usa-se ?[i...j], 1 ? i ? j ? n, para denotar \numa substring de ? de tamanho j \u2013 i + 1 come\u00e7ando na posi\u00e7\u00e3o i. \n\n3.2.2 Q-grams \n\nDada uma string ?, seus q-grams posicionais s\u00e3o obtidos \u201cdeslizando-se\u201d uma janela \nde tamanho q sobre os caracteres de ?. Uma vez que os q-grams no in\u00edcio e no fim da \nstring podem ter menos do que q caracteres, s\u00e3o introduzidos novos caracteres \u201c#\u201d e \n\u201c$\u201d, os quais n\u00e3o est\u00e3o em ?, e a string ? \u00e9 estendida conceitualmente ao ser prefixada \n\n\n\n \n\n \n\n \n\ncom q \u2013 1 ocorr\u00eancias de \u201c#\u201d e sufixada com q \u2013 1 ocorr\u00eancias de \u201c$\u201d. Deste modo, \ncada q-gram cont\u00e9m exatamente q caracteres, apesar de alguns deles n\u00e3o fazerem parte \ndo alfabeto ?. \n\nUm q-gram posicional de uma string ? \u00e9 um par (i, ?[i...i + q \u2013 1]), onde ?[i...i + q \u2013 \n1] \u00e9 o q-gram de ? que inicia na posi\u00e7\u00e3o i, levando-se em considera\u00e7\u00e3o a string \nestendida. O conjunto G? de todos os q-grams posicionais de uma string ? \u00e9 o conjunto \nde todos os |?| + q \u2013 1 pares constru\u00eddos de todos os q-grams de ?. \n\nA ideia do uso de q-grams como base do processamento de strings por aproxima\u00e7\u00e3o \nvem do fato de que, quando duas strings ?1 e ?2 est\u00e3o numa pequena dist\u00e2ncia de edi\u00e7\u00e3o \nentre si, elas compartilham um grande n\u00famero de q-grams em comum (UKKONEN, \n1992). O exemplo a seguir ilustra essa observa\u00e7\u00e3o. \n\nOs q-grams posicionais de tamanho q=3 da string \u201cjohn_smith\u201d s\u00e3o {(1, ##j), (2, \n#jo), (3, joh), (4, ohn), (5, hn_), (6, n_s), (7, _sm), (8, smi), (9, mit), (10, ith), (11, th$), \n(12, h$$)}. De forma similar, os q-grams posicionais de tamanho q=3 da string \n\u201cjohn_a_smith\u201d, a qual est\u00e1 numa dist\u00e2ncia de edi\u00e7\u00e3o de dois  para \u201cjohn_smith\u201d, s\u00e3o \n{(1, ##j), (2, #jo), (3, joh), (4, ohn), (5, hn_), (6, n_a), (7, _a_), (8, a_s), (9, _sm), (10, \nsmi), (11, mit), (12, ith), (13, th$), (14, h$$)}. Se a informa\u00e7\u00e3o de posi\u00e7\u00e3o for ignorada, \nos dois conjuntos de q-grams t\u00eam onze q-grams em comum. Curiosamente, apenas os \nprimeiro cinco q-grams da primeira string s\u00e3o tamb\u00e9m q-grams posicionais da segunda \nstring. Entretanto, outros seis q-grams das duas strings diferem em apenas duas \nposi\u00e7\u00f5es. Isso ilustra que, em geral, o uso de q-grams posicionais para o processamento \nde strings por aproxima\u00e7\u00e3o envolve a compara\u00e7\u00e3o de posi\u00e7\u00f5es de q-grams \ncorrespondentes dentro de uma certa \u201cfaixa\u201d. \n\n3.2.3 Problema a ser resolvido \n\nFormalmente, o problema a ser resolvido pela t\u00e9cnica \u00e9 definido conforme se segue. \nDadas tabelas R1 e R2 com atributos string R1.Ai e R2.Aj e um inteiro k, recuperar todos \nos pares de registros (t, t\u2019) ? R1 \u00d7 R2 tal que edit_distance(R1.Ai(t), R2.Aj(t\u2019)) ? k. \n\nConforme j\u00e1 mencionado, a t\u00e9cnica baseia-se em dois passos principais. Primeiro, \num conjunto de resultados candidatos \u00e9 obtido utilizando-se um algoritmo simples e \naproximado que garante nenhuma falsa rejei\u00e7\u00e3o. Isso \u00e9 alcan\u00e7ado ao se realizar uma \njun\u00e7\u00e3o dos q-grams juntamente com alguns filtros adicionais que garantem a n\u00e3o-\nelimina\u00e7\u00e3o de qualquer correspond\u00eancia aproximada real. Ap\u00f3s, no segundo passo, usa-\nse um algoritmo custoso, em mem\u00f3ria, para verifica\u00e7\u00e3o da dist\u00e2ncia de edi\u00e7\u00e3o entre \ncada par de strings candidato e a elimina\u00e7\u00e3o de todos os falsos positivos. \n\n3.2.4 Solu\u00e7\u00e3o simplista \n\nO problema pode ser facilmente expressado em qualquer banco de dados relacional \nque ofere\u00e7a suporte a UDFs, tais como Oracle ou SQL Server. Poderia ser registrada na \nbase uma fun\u00e7\u00e3o edit_distance(s1, s2, k) que retorna verdadeiro se as duas strings \nutilizadas como argumentos estiverem dentro de uma dist\u00e2ncia de edi\u00e7\u00e3o do argumento \ninteiro k. Ent\u00e3o, o problema de jun\u00e7\u00e3o de string por aproxima\u00e7\u00e3o para a dist\u00e2ncia de \nedi\u00e7\u00e3o k poderia ser representado, em SQL (Structured Query Language), como: \n\nSELECT  R1.Ai, R2.Aj \nFROM   R1, R2 \nWHERE   edit_distance(R1.Ai, R2.Aj, k) \n\n\n\n \n\n \n\n18 \n\nPara avaliar essa express\u00e3o, os motores relacionais deveriam, essencialmente, ter \nque computar o produto cartesiano das tabelas R1 e R2 e aplicar a compara\u00e7\u00e3o da UDF \ncomo um filtro de p\u00f3s-processamento. Entretanto, produtos cartesianos de tabelas \ngrandes s\u00e3o imensos e a invoca\u00e7\u00e3o da UDF, a qual \u00e9 um elemento custoso, em cada \nregistro do produto cartesiano faz com que o custo da opera\u00e7\u00e3o de jun\u00e7\u00e3o seja \nproibitivo. Por essas raz\u00f5es, a t\u00e9cnica busca uma solu\u00e7\u00e3o melhor, a qual \u00e9 baseada no \nque se segue nas pr\u00f3ximas se\u00e7\u00f5es. \n\n3.2.5 Prepara\u00e7\u00e3o do banco de dados \n\nPara permitir o processamento aproximado de strings em um banco de dados \natrav\u00e9s do uso de q-grams, \u00e9 necess\u00e1rio um mecanismo para popular a base com os q-\ngrams posicionais correspondentes \u00e0s strings originais do banco. A explica\u00e7\u00e3o que se \nsegue detalha o processo. \n\nR \u00e9 uma tabela com colunas (A0, A1, ..., Am), tal que A0 \u00e9 a chave prim\u00e1ria de R \n(identificando unicamente seus registros) e alguns atributos Ai, i > 0, s\u00e3o valores string. \nPara cada atributo string Ai que ser\u00e1 considerado para o processamento aproximado de \nstrings, \u00e9 criada uma tabela auxiliar RAiQ(A0, Pos, Qgram) com tr\u00eas atributos. Para uma \nstring ? do atributo Ai de um registro de R, seus |?| + q \u2013 1 q-grams posicionais s\u00e3o \nrepresentados como registros distintos na tabela RAiQ, onde RAiQ.Pos identifica a \nposi\u00e7\u00e3o do q-gram contido em RAiQ.Qgram. Esses |?| + q \u2013 1 registros compartilham o \nmesmo valor para o atributo RAiQ.A0, o qual \u00e9 uma chave estrangeira para a tabela R. \n\n3.2.6 Filtragem de resultados atrav\u00e9s de propriedades dos q-grams \n\nPara alcan\u00e7ar os dois objetivos principais do uso de q-grams juntamente com a \nm\u00e9trica de dist\u00e2ncia de edi\u00e7\u00e3o \u2013 nenhuma falsa rejei\u00e7\u00e3o e poucos falsos positivos \u2013 a \nt\u00e9cnica utiliza-se de tr\u00eas propriedades chave dos q-grams, as quais s\u00e3o utilizadas em tr\u00eas \nt\u00e9cnicas de filtragem explicadas a seguir. \n\n3.2.6.1 Filtro por contagem \n\nA ideia b\u00e1sica do filtro por contagem \u00e9 aproveitar a informa\u00e7\u00e3o obtida atrav\u00e9s dos \nconjuntos G?1 e G?2 dos q-grams das strings ?1 e ?2, ignorando-se a informa\u00e7\u00e3o \nposicional, determinando se ?1 e ?2 est\u00e3o numa dist\u00e2ncia de edi\u00e7\u00e3o menor ou igual a k. \nO princ\u00edpio \u00e9 que strings que est\u00e3o numa dist\u00e2ncia de edi\u00e7\u00e3o pequena entre si \ncompartilham um grande n\u00famero de q-grams em comum. \n\nConsiderando-se uma string ?1 e outra string ?2, a qual \u00e9 obtida atrav\u00e9s da \nsubstitui\u00e7\u00e3o de um \u00fanico caractere de ?1, os conjuntos de q-grams G?1 e G?2 diferem no \nm\u00e1ximo por q (o tamanho do q-gram). Isso ocorre pois q-grams que n\u00e3o sobrep\u00f5em-se \nao caractere substitu\u00eddo devem ser comuns aos dois conjuntos, e h\u00e1 apenas q q-grams \nque sobrep\u00f5em-se ao caractere substitu\u00eddo. De forma similar, o mesmo ocorre para \ninser\u00e7\u00f5es e remo\u00e7\u00f5es de um \u00fanico caractere. Em outras palavras, nesses casos, ?1 e ?2 \ndevem ter pelo menos (max(|?1|, |?2| + q \u2013 1) \u2013 q = max(|?1|, |?2|) \u2013 1 q-grams em \ncomum. Quando a dist\u00e2ncia de edi\u00e7\u00e3o entre ?1 e ?2 \u00e9 k, o limite inferior do n\u00famero de \ncorrespond\u00eancias de q-grams \u00e9 o valor apresentado na preposi\u00e7\u00e3o a seguir. \n\nPreposi\u00e7\u00e3o 3.1 Considere strings ?1 e ?2 de tamanhos |?1| e |?2| respectivamente. Se ?1 e \n?2 est\u00e3o dentro de uma dist\u00e2ncia de edi\u00e7\u00e3o de k, ent\u00e3o a cardinalidade de G?1 ? G?2, \nignorando-se informa\u00e7\u00e3o posicional, deve ser de pelo menos max(|?1|, |?2|) \u2013 1 \u2013 (k \u2013 1) \n* q. \n\n\n\n \n\n \n\n \n\n3.2.6.2 Filtro por posi\u00e7\u00e3o \n\nEnquanto o filtro por contagem \u00e9 efetivo em aumentar a efici\u00eancia do processamento \naproximado de strings, n\u00e3o aproveita a informa\u00e7\u00e3o posicional de um q-gram. \n\nEm geral, a rela\u00e7\u00e3o entre as posi\u00e7\u00f5es de correspond\u00eancias de q-grams e a dist\u00e2ncia \nde edi\u00e7\u00e3o \u00e9 bastante complexa. Qualquer dado q-gram em uma string pode n\u00e3o ocorrer \nem outra string, e as posi\u00e7\u00f5es de q-grams sucessivos podem estar fora da faixa v\u00e1lida \ndevido a inser\u00e7\u00f5es e remo\u00e7\u00f5es. Al\u00e9m disso, existe a possibilidade de um q-gram em \numa string ocorrer em m\u00faltiplas posi\u00e7\u00f5es em outra string. \n\nUm q-gram posicional (i, ?1) em uma string ?1 corresponde a um q-gram posicional \n(j, ?2) em outra string ?2 se ?1 = ?2 e (i, ?1), ap\u00f3s a sequ\u00eancia de opera\u00e7\u00f5es de edi\u00e7\u00e3o que \nconverte ?1 em ?2, torna-se o q-gram (j, ?2) na string editada (ULLMANN, 1977). \n\nExemplo: Considere as strings ?1 = abaxabaaba e ?2 = abaabaaba. A dist\u00e2ncia de \nedi\u00e7\u00e3o entre essas strings \u00e9 de um (remover x para transformar a primeira string na \nsegunda). Ent\u00e3o (7, aba) em ?1 corresponde a (6, aba) em ?2 mas n\u00e3o a (9, aba). \n\nN\u00e3o obstante a complexidade de corresponder q-grams posicionais na presen\u00e7a de \nerros de edi\u00e7\u00e3o em strings, um filtro \u00fatil pode ser planejado baseando-se na seguinte \nobserva\u00e7\u00e3o. \n\nPreposi\u00e7\u00e3o 3.2 Se strings ?1 e ?2 est\u00e3o dentro de uma dist\u00e2ncia de edi\u00e7\u00e3o de k, ent\u00e3o um \nq-gram posicional em uma string n\u00e3o pode corresponder a um q-gram posicional da \noutra que difira da mesma em mais de k posi\u00e7\u00f5es. \n\n3.2.6.3 Filtro por tamanho \n\nFinalmente, observa-se que o tamanho da string prov\u00ea informa\u00e7\u00e3o \u00fatil para \nrapidamente descartar strings que n\u00e3o est\u00e3o na dist\u00e2ncia de edi\u00e7\u00e3o desejada. \n\nPreposi\u00e7\u00e3o 3.3 Se duas strings ?1 e ?2 est\u00e3o dentro de uma dist\u00e2ncia de edi\u00e7\u00e3o de k, \nseus tamanhos n\u00e3o podem diferir em mais de k. \n\n3.2.7 Express\u00e3o e avalia\u00e7\u00e3o SQL \n\nAlgo particularmente interessante \u00e9 que os filtros por contagem, posi\u00e7\u00e3o e tamanho \npodem ser naturalmente expressos como uma express\u00e3o SQL na base de dados \npopulada descrita na se\u00e7\u00e3o 3.2.4, e eficientemente implementada por um banco de \ndados relacional comercial. A Figura 3.1 mostra a express\u00e3o SQL reunindo as tr\u00eas \npropriedades descritas. \n\n\n\n \n\n \n\n20 \n\n \n\nFigura 3.1: Express\u00e3o SQL contendo as tr\u00eas propriedades dos q-grams (GRAVANO, \n2005) \n\nEssencialmente, a express\u00e3o SQL da Figura 3.1 realiza uma jun\u00e7\u00e3o das tabelas \nauxiliares correspondentes aos atributos string R1.Ai e R2.Aj em seus atributos Qgram, \nal\u00e9m de fazer jun\u00e7\u00f5es de chaves estrangeiras/chaves prim\u00e1rias com as tabelas originais \nR1 e R2 para recuperar os pares de strings que devem ser retornados ao usu\u00e1rio. \n\nO filtro por posi\u00e7\u00e3o \u00e9 implementado como uma condi\u00e7\u00e3o da cl\u00e1usula WHERE da \nexpress\u00e3o SQL. A condi\u00e7\u00e3o remove quaisquer pares de strings em R1 \u00d7 R2 que \ncompartilham muitos q-grams em comum mas que as posi\u00e7\u00f5es dos q-grams id\u00eanticos \ndifiram substancialmente. Deste modo, tais pares de strings ser\u00e3o desconsiderados antes \nque as condi\u00e7\u00f5es COUNT(*) na cl\u00e1usula HAVING sejam testadas. Al\u00e9m disso, esse \nfiltro reduz o tamanho da jun\u00e7\u00e3o dos q-grams, deixando a computa\u00e7\u00e3o da express\u00e3o \nmais r\u00e1pida, uma vez que menos pares de q-grams devem ser examinados pelas \ncl\u00e1usulas GROUP BY e HAVING. \n\nO filtro por tamanho \u00e9 implementado como uma condi\u00e7\u00e3o adicional na cl\u00e1usula \nWHERE da express\u00e3o, a qual compara os tamanhos de duas strings. Novamente, assim \ncomo a t\u00e9cnica de filtro por posi\u00e7\u00e3o, este filtro reduz o tamanho da jun\u00e7\u00e3o dos q-grams \ne, em consequ\u00eancia, o tamanho do conjunto candidato. \n\nFinalmente, o filtro por contagem \u00e9 implementado principalmente pelas condi\u00e7\u00f5es \nna cl\u00e1usula HAVING. Os pares de strings que compartilham somente alguns poucos q-\ngrams s\u00e3o eliminados pelas condi\u00e7\u00f5es do COUNT(*) na cl\u00e1usula HAVING. Quaisquer \npares de strings em R1 \u00d7 R2 que n\u00e3o compartilham q-grams s\u00e3o descartados pelas \ncondi\u00e7\u00f5es na cl\u00e1usula WHERE. \n\nContudo, mesmo ap\u00f3s os passos de filtragem, o conjunto candidato pode ainda ter \nfalsos positivos. Deste modo, a custosa invoca\u00e7\u00e3o da UDF edit_distance(R1.Ai, R2.Aj, k) \nainda deve ser realizada, mas, desta vez, em apenas uma pequena fra\u00e7\u00e3o de todos os \npares poss\u00edveis de strings. \n\n\n\n \n\n \n\n \n\n3.3 Utiliza\u00e7\u00e3o da t\u00e9cnica na aplica\u00e7\u00e3o \nUma vez que o objetivo da busca por similaridade de strings na aplica\u00e7\u00e3o \u00e9 de \n\nlocalizar correspond\u00eancias diretas com um determinado nome informado pelo usu\u00e1rio \n(isto \u00e9, n\u00e3o se procura a correla\u00e7\u00e3o de dados), a t\u00e9cnica apresentada foi levemente \nadaptada. Utilizando-se a express\u00e3o apresentada na Figura 3.1 para compara\u00e7\u00f5es, as \nseguintes mudan\u00e7as foram realizadas. \n\nApenas os dados da tabela R1 s\u00e3o de interesse, j\u00e1 que a tabela R2 apenas \ncorrelaciona seus dados com a tabela R1. Desta forma, as refer\u00eancias \u00e0 tabela R2 na \ncl\u00e1usula SELECT foram eliminadas. Nas demais cl\u00e1usulas, o atributo R2.Aj foi \nsubstitu\u00eddo diretamente pela string de consulta. Na cl\u00e1usula FROM, a tabela R2 tamb\u00e9m \nfoi descartada; entretanto, a tabela R2AjQ foi substitu\u00edda por uma tabela que \u00e9 populada \ndinamicamente a cada pesquisa efetuada. Essa tabela armazena os q-grams do nome \npesquisado pelo usu\u00e1rio (valor do atributo R2.Aj), uma vez que \u00e9 realizada uma jun\u00e7\u00e3o \nentre a mesma e a tabela de q-grams da tabela R1. A cl\u00e1usula WHERE mant\u00e9m-se \ninalterada, com exce\u00e7\u00e3o da jun\u00e7\u00e3o envolvendo a tabela R2, a qual foi removida. A \ncl\u00e1usula GROUP BY mant\u00e9m apenas os campos constantes na cl\u00e1usula SELECT, isto \u00e9, \natributos referentes \u00e0 tabela R1. Finalmente, a chamada \u00e0 UDF edit_distance n\u00e3o \nocorre na cl\u00e1usula HAVING. Ao inv\u00e9s disso, ela aparece numa cl\u00e1usula ORDER BY, \npois, dessa forma, os resultados j\u00e1 v\u00eam ordenados conforme a dist\u00e2ncia de edi\u00e7\u00e3o para a \nstring de pesquisa (em ordem ascendente de dist\u00e2ncia). Uma vez que os filtros dos q-\ngrams j\u00e1 foram aplicados antes da chamada \u00e0 fun\u00e7\u00e3o e que a pesquisa limita o n\u00famero \nde registros retornados em 5, 10, 15 ou 20 ocorr\u00eancias, a invoca\u00e7\u00e3o da UDF n\u00e3o \u00e9 \nimpactante no desempenho da consulta. \n\nComo exemplo, ser\u00e1 apresentada a express\u00e3o SQL formada para a pesquisa de um \ndeterminado propriet\u00e1rio atrav\u00e9s do sobrenome \u201cCorso\u201d, com o limite de at\u00e9 20 \nregistros. Na aplica\u00e7\u00e3o, a dist\u00e2ncia de edi\u00e7\u00e3o considerada e o tamanho dos q-grams \u00e9 de \ntr\u00eas. O banco de dados utilizado \u00e9 o SQL Server (instru\u00e7\u00f5es TOP e LEN). A pesquisa \ntamb\u00e9m \u00e9 realizada na tabela Lote pois apenas os propriet\u00e1rios que t\u00eam lote associado \ndevem ser recuperados. \n\n \n\nSELECT  TOP 20 PRO.ID, PRO.Nome, PRO.Sobrenome \nFROM  Proprietario PRO, Lote LOT, Proprietario_Qgram PRQ, \n\nConsulta_Qgram COQ \nWHERE  PRO.Chave_Lote = LOT.Chave AND  \n\nPRO.ID = PRQ.Proprietario_ID AND  \nPRQ.Qgram = COQ.Qgram AND  \nABS(PRQ.Posicao \u2013 COQ.Posicao)&lt;= 3 AND \nABS(LEN(PRO.Sobrenome) \u2013 LEN(\u2018Corso\u2019))&lt;= 3 \n\nGROUP BY  PRO.ID, PRO.Nome, PRO.Sobrenome \nHAVING  COUNT(*) >= LEN(PRO.Sobrenome) \u2013 1 \u2013 (3 - 1) * 3 AND \n\nCOUNT(*) >= LEN(\u2018Corso\u2019) \u2013 1 \u2013 (3 \u2013 1) * 3 \nORDER BY  edit_distance(PRO.Sobrenome, \u2018Corso\u2019) \n\n \n\nA tabela Consulta_Qgram \u00e9 a tabela populada a cada pesquisa com os q-grams da \nstring sendo consultada (no exemplo, os q-grams da palavra Corso). Ela exerce o papel \nda tabela R2AjQ mostrada na express\u00e3o da Figura 3.1. \n\n\n\n \n\n \n\n22 \n\n4 FUNCIONALIDADES DA APLICA\u00c7\u00c3O \n\nPara demonstrar as funcionalidades oferecidas pela aplica\u00e7\u00e3o (isto \u00e9, o que o \nsistema prov\u00ea), utilizar-se-\u00e1 a linguagem de modelagem UML (Unified Modeling \nLanguage). A UML \u00e9 uma fam\u00edlia de nota\u00e7\u00f5es gr\u00e1ficas que ajuda a descrever e projetar \nsistemas de software, especialmente aplica\u00e7\u00f5es constru\u00eddas utilizando-se o estilo \norientado a objetos (FOWLER, 2005). Tal linguagem \u00e9 largamente utilizada na \u00e1rea de \nEngenharia de Software e sua padroniza\u00e7\u00e3o foi criada e \u00e9 controlada pelo OMG (Object \nManagement Group). \n\n4.1 Diagrama de casos de uso \nUtilizamos diagramas de casos de uso em UML para demonstrar, graficamente e \n\nem alto n\u00edvel, como os usu\u00e1rios interagem com o sistema. Atrav\u00e9s de um diagrama, \npode-se distinguir rapidamente a quais funcionalidades do sistema cada tipo de usu\u00e1rio \ntem acesso. Na Figura 4.1, \u00e9 apresentado o diagrama de casos de uso da aplica\u00e7\u00e3o. \n\n\n\n \n\n \n\n \n\n \nFigura 4.1: Diagrama de casos de uso da aplica\u00e7\u00e3o \n\nNo diagrama da Figura 4.1 podem-se visualizar tr\u00eas tipos principais de elementos: \natores, casos de uso e associa\u00e7\u00f5es. \n\nOs atores s\u00e3o os agentes externos que interagem com o sistema, ou seja, n\u00e3o est\u00e3o \nsob a influ\u00eancia do mesmo. Na aplica\u00e7\u00e3o, tem-se apenas um tipo de ator: o usu\u00e1rio, o \nqual inicia diretamente todos os casos de uso. \n\nOs casos de uso representam unidades discretas de intera\u00e7\u00e3o entre um ator e o \nsistema. Descrevem o comportamento do sistema ao responder \u00e0s requisi\u00e7\u00f5es de um \ndeterminado ator. Casos de uso n\u00e3o descrevem como uma determinada funcionalidade \ndeve ser constru\u00edda e sim qual ser\u00e1 o seu comportamento (o que ela oferece).  \n\n\n\n \n\n \n\n24 \n\nAs associa\u00e7\u00f5es s\u00e3o liga\u00e7\u00f5es entre diferentes elementos e, no diagrama da Figura \n4.1, dividem-se em dois tipos: associa\u00e7\u00e3o entre ator e caso de uso e associa\u00e7\u00e3o entre \ncasos de uso. A associa\u00e7\u00e3o entre ator e caso de uso caracteriza uma intera\u00e7\u00e3o \n(requisi\u00e7\u00e3o) entre o ator e alguma funcionalidade do sistema. A associa\u00e7\u00e3o entre casos \nde uso representa como tais entidades relacionam-se entre si. Na aplica\u00e7\u00e3o, existe \napenas um tipo de relacionamento entre casos de uso: preced\u00eancia, no qual um caso de \nuso (o apontador) precede outro caso de uso (o apontado). \n\nA finalidade dos casos de uso \u201cPesquisa estruturada por col\u00f4nia e linha\u201d, \u201cPesquisa \npor propriet\u00e1rio\u201d, \u201cPesquisa por cidade\u201d e \u201cPesquisa livre por col\u00f4nia e linha\u201d \u00e9 a \nmesma: exibir lotes coloniais no mapa. A diferen\u00e7a entre eles \u00e9 o meio (dados \nselecionados e/ou informados pelo usu\u00e1rio) atrav\u00e9s do qual se chega aos resultados. O \ncaso de uso \u201cPesquisa informa\u00e7\u00f5es do lote\u201d \u00e9 um complemento de qualquer um dos \noutros quatro casos de uso mencionados anteriormente, pois apresenta ao usu\u00e1rio \ninforma\u00e7\u00f5es pertinentes a um dado lote colonial selecionado no mapa. \n\nOs casos de uso precedentes \u2013 \u201cPesquisa nomes de propriet\u00e1rios\u201d, \u201cPesquisa nomes \nde cidades\u201d e \u201cPesquisa nomes de localidades\u201d \u2013 t\u00eam como finalidade auxiliar o usu\u00e1rio \nna identifica\u00e7\u00e3o das informa\u00e7\u00f5es cadastradas no banco de dados. Deste modo, por \nexemplo, ao informar o nome de uma cidade, ele j\u00e1 fica ciente das cidades cujos nomes \niniciam pelos dados j\u00e1 informados. A rela\u00e7\u00e3o de preced\u00eancia indica sequ\u00eancia no tempo \ne n\u00e3o depend\u00eancia \u2013 com exce\u00e7\u00e3o do caso de uso \u201cPesquisa informa\u00e7\u00f5es do lote\u201d (o \nqual necessita que haja lotes coloniais exibidos no mapa), todos os casos de uso s\u00e3o \nindependentes entre si. \n\n4.2 Descri\u00e7\u00f5es textuais de casos de uso e telas de interface \nO diagrama de casos de uso apresentado na Figura 4.1 \u00e9 \u00fatil para caracterizar, \n\ngraficamente, as funcionalidades oferecidas pela aplica\u00e7\u00e3o. Entretanto, n\u00e3o especifica \nquais s\u00e3o os passos necess\u00e1rios, na intera\u00e7\u00e3o entre usu\u00e1rio e sistema, para se chegar a \ntais fins. Para tanto, faz-se o uso de descri\u00e7\u00f5es textuais de casos de uso, as quais s\u00e3o \ndivididas em UML, usualmente, em duas categorias: alto n\u00edvel e expandidas. Contudo, \nambas ser\u00e3o apresentadas de forma \u00fanica neste trabalho, visando a facilita\u00e7\u00e3o da leitura. \n\nAs descri\u00e7\u00f5es de casos de uso explicitam, passo a passo, as intera\u00e7\u00f5es entre os \natores e os casos de uso do sistema. Al\u00e9m disso, detalham todas as poss\u00edveis varia\u00e7\u00f5es \ndo fluxo principal de eventos da intera\u00e7\u00e3o. Tamb\u00e9m apresentam a l\u00f3gica do processo do \ncaso de uso, enriquecendo as informa\u00e7\u00f5es j\u00e1 fornecidas pelo diagrama. \n\nAcompanhando as descri\u00e7\u00f5es, ser\u00e3o apresentadas as telas de interface para cada \ncaso de uso, demonstrando, na pr\u00e1tica, a intera\u00e7\u00e3o entre o usu\u00e1rio e o sistema. A Figura \n4.2 apresenta a tela inicial do sistema, antes de qualquer caso de uso ter sido iniciado \npelo usu\u00e1rio. \n\n\n\n \n\n \n\n \n\n \n\nFigura 4.2: Tela de interface inicial da aplica\u00e7\u00e3o \n\nA Figura 4.2 mostra que existem tr\u00eas se\u00e7\u00f5es principais no menu da aplica\u00e7\u00e3o: \n\u201cPesquisa por col\u00f4nia e linha\u201d, \u201cPesquisa por propriet\u00e1rio\u201d e \u201cPesquisa por localidade\u201d. \nCada se\u00e7\u00e3o representa um tipo de pesquisa diferente e um caso de uso diferente, exceto \na se\u00e7\u00e3o \u201cPesquisa por localidade\u201d, a qual abrange os casos de uso \u201cPesquisa por cidade\u201d \ne \u201cPesquisa livre por col\u00f4nia e linha\u201d. A se\u00e7\u00e3o \u201cPesquisa por col\u00f4nia e linha\u201d \u00e9 a \u00fanica \nexpandida por padr\u00e3o, sendo considerada a principal do menu. \n\nTabela 4.1: Descri\u00e7\u00e3o do caso de uso \u201cPesquisa estruturada por col\u00f4nia e linha\u201d \n\nUC 01 \u2013 Pesquisa estruturada por col\u00f4nia e linha \n\nAtores: Usu\u00e1rio. \n\nPr\u00e9-condi\u00e7\u00e3o: Nenhuma. \n\nP\u00f3s-condi\u00e7\u00e3o: Lotes da linha colonial selecionada \nexibidos no mapa. \n\nDescri\u00e7\u00e3o: Usu\u00e1rio pesquisa por lotes selecionando \numa col\u00f4nia atrav\u00e9s de seu nome e, ap\u00f3s \nisso, seleciona uma linha pertencente \u00e0 \ncol\u00f4nia selecionada, tamb\u00e9m atrav\u00e9s de \nseu nome. Rela\u00e7\u00e3o de lotes da linha \nselecionada \u00e9 mostrada ao usu\u00e1rio no \nmapa. \n\nSequ\u00eancia de eventos: \n\nAtor Sistema \n\n1. Seleciona uma col\u00f4nia atrav\u00e9s de seu  \n\n\n\n \n\n \n\n26 \n\nnome em uma caixa de sele\u00e7\u00e3o. \n\n 2. Apresenta, em uma caixa de sele\u00e7\u00e3o, \numa lista de linhas pertencentes \u00e0 col\u00f4nia \nselecionada. \n\n3. Seleciona uma linha atrav\u00e9s de seu \nnome na caixa de sele\u00e7\u00e3o apresentada. \n\n \n\n 4. Exibe no mapa os lotes da linha \ncolonial selecionada. \n\n5. O usu\u00e1rio visualiza os lotes da linha \nselecionada e o caso de uso \u00e9 encerrado. \n\n \n\n \n\nNa Tabela 4.1 \u00e9 detalhada a pesquisa estruturada de lotes atrav\u00e9s de col\u00f4nia e linha, \nconstante na se\u00e7\u00e3o \u201cPesquisa por col\u00f4nia e linha\u201d do menu da aplica\u00e7\u00e3o. \n\nUma pr\u00e9-condi\u00e7\u00e3o \u00e9 o estado no qual o sistema deve estar antes do caso de uso ser \niniciado. Uma p\u00f3s-condi\u00e7\u00e3o \u00e9 o estado no qual o sistema ficar\u00e1 ap\u00f3s o caso de uso ser \nfinalizado. Conforme j\u00e1 mencionado na se\u00e7\u00e3o 4.1, com exce\u00e7\u00e3o do caso de uso \n\u201cPesquisa informa\u00e7\u00f5es do lote\u201d, n\u00e3o existe depend\u00eancia entre os casos de uso do \nsistema e, portanto, nenhum deles exige pr\u00e9-condi\u00e7\u00e3o. Uma vez que o \u00fanico ator da \naplica\u00e7\u00e3o \u00e9 o usu\u00e1rio, todas as intera\u00e7\u00f5es s\u00e3o realizadas entre o usu\u00e1rio e o sistema. \n\n \n\nFigura 4.3: Tela de interface do caso de uso \u201cPesquisa estruturada por col\u00f4nia e linha\u201d \n\nA Figura 4.3 mostra a p\u00f3s-condi\u00e7\u00e3o do caso de uso \u201cPesquisa estruturada por \ncol\u00f4nia e linha\u201d, ou seja, lotes coloniais exibidos no mapa. Conforme detalhado na \nTabela 4.1, o usu\u00e1rio seleciona o nome da col\u00f4nia atrav\u00e9s de uma caixa de sele\u00e7\u00e3o e, \nap\u00f3s isso, o nome da linha pertencente \u00e0 col\u00f4nia atrav\u00e9s de outra caixa de sele\u00e7\u00e3o. \n\n\n\n \n\n \n\n \n\nDessa forma, os lotes coloniais da linha s\u00e3o apresentados no mapa, al\u00e9m de ser criada \numa tabela no menu contendo as linhas atualmente exibidas para aquela col\u00f4nia. \n\n\u00c9 poss\u00edvel que o usu\u00e1rio selecione mais de uma linha colonial na col\u00f4nia \nselecionada, sendo que, dessa forma, v\u00e1rias linhas s\u00e3o exibidas no mapa e na tabela do \nmenu. Tal situa\u00e7\u00e3o \u00e9 demonstrada na Figura 4.4. \n\n \n\nFigura 4.4: Tela de interface do caso de uso \u201cPesquisa estruturada por col\u00f4nia e linha\u201d \ncom mais de uma linha colonial selecionada \n\nO menu de linhas coloniais da col\u00f4nia selecionada cont\u00e9m uma cor para cada linha, \nfacilitando, dessa forma, a distin\u00e7\u00e3o dos lotes exibidos no mapa. \n\nTabela 4.2: Descri\u00e7\u00e3o do caso de uso \u201cPesquisa nomes de propriet\u00e1rios\u201d \n\nUC 02 \u2013 Pesquisa nomes de propriet\u00e1rios \n\nAtores: Usu\u00e1rio. \n\nPr\u00e9-condi\u00e7\u00e3o: Nenhuma. \n\nP\u00f3s-condi\u00e7\u00e3o: Lista com sobrenomes de propriet\u00e1rios \nque iniciem pelo texto informado \napresentada. \n\nDescri\u00e7\u00e3o: Usu\u00e1rio pesquisa por lotes informando o \nnome do propriet\u00e1rio e, enquanto isso, \u00e9 \napresentada ao mesmo uma lista com \ntodos os nomes que iniciem pelo texto j\u00e1 \ninformado (precede o caso de uso \n\u201cPesquisa por propriet\u00e1rio\u201d). \n\nSequ\u00eancia de eventos: \n\n\n\n \n\n \n\n28 \n\nAtor Sistema \n\n1. Come\u00e7a a informar o nome da fam\u00edlia \nde um propriet\u00e1rio para pesquisa de seus \nlotes, conforme UC 02. \n\n \n\n 2. Apresenta uma lista com sobrenomes \nde propriet\u00e1rios que iniciem pelo texto j\u00e1 \ninformado pelo usu\u00e1rio. \n\n3. O usu\u00e1rio visualiza a lista de \nsobrenomes e o caso de uso \u00e9 encerrado. \n\n \n\nRN 01 \u2013 Regra de neg\u00f3cio 01: \n\n1. A pesquisa por nomes de propriet\u00e1rios deve ser iniciada somente a partir da 2\u00aa \n(segunda) letra informada pelo usu\u00e1rio. \n\nRN 02 \u2013 Regra de neg\u00f3cio 02: \n\n2. A pesquisa por nomes de propriet\u00e1rios deve ser realizada sempre que o usu\u00e1rio \ninformar uma nova letra do nome (a partir da 2\u00aa, conforme RN 01). \n\n \n\nNa Tabela 4.2 \u00e9 detalhada a pesquisa autom\u00e1tica de nomes de propriet\u00e1rios, \nconstante na se\u00e7\u00e3o \u201cPesquisa por propriet\u00e1rio\u201d do menu da aplica\u00e7\u00e3o. \n\nO caso de uso apresenta duas regras de neg\u00f3cio, as quais s\u00e3o complementos da \nespecifica\u00e7\u00e3o do caso de uso e que sempre devem ser obedecidas. Elas ficam em uma \nse\u00e7\u00e3o \u00e0 parte da sequ\u00eancia de eventos pois s\u00e3o mut\u00e1veis, isto \u00e9, podem ser modificadas \nou removidas. \n\n \n\nFigura 4.5: Tela de interface do caso de uso \u201cPesquisa nomes de propriet\u00e1rios\u201d \n\n\n\n \n\n \n\n \n\nA Figura 4.5 mostra a p\u00f3s-condi\u00e7\u00e3o do caso de uso \u201cPesquisa nomes de \npropriet\u00e1rios\u201d, ou seja, lista de sobrenomes de propriet\u00e1rios iniciados pelo texto \ninformado pelo usu\u00e1rio \u00e9 apresentada. Conforme detalhado na Tabela 4.2, assim que o \nusu\u00e1rio come\u00e7a a digitar (a partir da segunda letra) o nome desejado, o sistema \napresenta uma lista com os nomes que iniciam com o texto j\u00e1 informado, atualizando-a \na cada nova letra. Dessa forma, o usu\u00e1rio pode selecionar um dos nomes da lista e \niniciar o caso de uso \u201cPesquisa por propriet\u00e1rio\u201d de forma r\u00e1pida. \n\nTabela 4.3: Descri\u00e7\u00e3o do caso de uso \u201cPesquisa por propriet\u00e1rio\u201d \n\nUC 03 \u2013 Pesquisa por propriet\u00e1rio \n\nAtores: Usu\u00e1rio. \n\nPr\u00e9-condi\u00e7\u00e3o: Nenhuma. \n\nP\u00f3s-condi\u00e7\u00e3o: Lotes do propriet\u00e1rio selecionado exibidos \nno mapa. \n\nDescri\u00e7\u00e3o: Usu\u00e1rio pesquisa por lotes informando o \nnome da fam\u00edlia do propriet\u00e1rio. Rela\u00e7\u00e3o \nde propriet\u00e1rios com sobrenomes iguais \ne/ou similares ao informado \u00e9 apresentada \nao usu\u00e1rio. Usu\u00e1rio seleciona um dos \npropriet\u00e1rios da lista e os lotes do mesmo \ns\u00e3o mostrados no mapa. \n\nSequ\u00eancia de eventos: \n\nAtor Sistema \n\n1. Informa o nome da fam\u00edlia do \npropriet\u00e1rio e o n\u00famero m\u00e1ximo de \nregistros a serem retornados. \n\n \n\n 2. Apresenta uma lista de propriet\u00e1rios \ncom sobrenome igual e/ou similar ao \ninformado. \n\n3. Seleciona um dos propriet\u00e1rios da \nlista. \n\n \n\n 4. Exibe no mapa os lotes do propriet\u00e1rio \nselecionado. \n\n5. O usu\u00e1rio visualiza os lotes do \npropriet\u00e1rio selecionado e o caso de uso \n\u00e9 encerrado. \n\n \n\nFluxo alternativo 01: \n\n1.1. Informa um nome de fam\u00edlia  \n\n\n\n \n\n \n\n30 \n\ninexistente e sem similaridade com \nqualquer nome existente. \n\n 2.1. Informa que n\u00e3o h\u00e1 registros de \npropriet\u00e1rios com o sobrenome \ninformado. O caso de uso \u00e9 encerrado. \n\n \n\nNa Tabela 4.3 \u00e9 detalhada a pesquisa de lotes atrav\u00e9s de propriet\u00e1rio, constante na \nse\u00e7\u00e3o \u201cPesquisa por propriet\u00e1rio\u201d do menu da aplica\u00e7\u00e3o. \n\nO caso de uso apresenta um fluxo alternativo, o qual apresenta a sequ\u00eancia de \neventos caso a intera\u00e7\u00e3o entre ator e sistema n\u00e3o ocorra exatamente conforme descrita \nno fluxo principal. Nesse caso, se o usu\u00e1rio informar um nome inexistente para a \npesquisa (sem similaridade com os nomes cadastrados), o sistema deve apresentar uma \nmensagem informando que n\u00e3o h\u00e1 registros para o nome informado, encerrando o caso \nde uso. \n\n \n\nFigura 4.6: Tela de interface do caso de uso \u201cPesquisa por propriet\u00e1rio\u201d \n\nA Figura 4.6 mostra a p\u00f3s-condi\u00e7\u00e3o do caso de uso \u201cPesquisa por propriet\u00e1rio\u201d, ou \nseja, o(s) lote(s) do propriet\u00e1rio exibido(s) no mapa. Conforme detalhado na Tabela 4.3, \nap\u00f3s o usu\u00e1rio ter informado o nome da fam\u00edlia desejada, o sistema apresenta uma lista \ncom os propriet\u00e1rios de sobrenome igual e/ou similar ao informado. Depois disso, basta \no usu\u00e1rio selecionar um dos propriet\u00e1rios da lista e seu(s) lote(s) \u00e9(s\u00e3o) exibido(s) no \nmapa. \n\n\n\n \n\n \n\n \n\n \n\nFigura 4.7: Tela de interface do caso de uso \u201cPesquisa por propriet\u00e1rio\u201d em seu fluxo \nalternativo \n\nA Figura 4.7 mostra o fluxo alternativo do caso de uso \u201cPesquisa por propriet\u00e1rio\u201d, \nno qual o sistema informa ao usu\u00e1rio que n\u00e3o h\u00e1 registros com o nome informado e nem \nsimilares a ele. \n\nTabela 4.4: Descri\u00e7\u00e3o do caso de uso \u201cPesquisa nomes de cidades\u201d \n\nUC 04 \u2013 Pesquisa nomes de cidades \n\nAtores: Usu\u00e1rio. \n\nPr\u00e9-condi\u00e7\u00e3o: Nenhuma. \n\nP\u00f3s-condi\u00e7\u00e3o: Lista com nomes de cidades que iniciem \npelo texto informado apresentada. \n\nDescri\u00e7\u00e3o: Usu\u00e1rio pesquisa por lotes informando o \nnome da cidade e, enquanto isso, \u00e9 \napresentada ao mesmo uma lista com \ntodos os nomes que iniciem pelo texto j\u00e1 \ninformado (precede o caso de uso \n\u201cPesquisa por cidade\u201d). \n\nSequ\u00eancia de eventos: \n\nAtor Sistema \n\n1. Come\u00e7a a informar o nome da cidade \npara pesquisa de seus lotes, conforme \nUC 03. \n\n \n\n\n\n \n\n \n\n32 \n\n 2. Apresenta uma lista com nomes de \ncidades que iniciem pelo texto j\u00e1 \ninformado pelo usu\u00e1rio. \n\n3. O usu\u00e1rio visualiza a lista de nomes e \no caso de uso \u00e9 encerrado. \n\n \n\nRN 01 \u2013 Regra de neg\u00f3cio 01: \n\n1. A pesquisa por nomes de cidades deve ser iniciada somente a partir da 2\u00aa (segunda) \nletra informada pelo usu\u00e1rio. \n\nRN 02 \u2013 Regra de neg\u00f3cio 02: \n\n2. A pesquisa por nomes de cidades deve ser realizada sempre que o usu\u00e1rio informar \numa nova letra do nome (a partir da 2\u00aa, conforme RN 01). \n\n \n\nNa Tabela 4.4 \u00e9 detalhada a pesquisa autom\u00e1tica de nomes de cidades, constante na \nse\u00e7\u00e3o \u201cPesquisa por localidade\u201d do menu da aplica\u00e7\u00e3o. \n\n \n\nFigura 4.8: Tela de interface do caso de uso \u201cPesquisa nomes de cidades\u201d \n\nA Figura 4.8 mostra a p\u00f3s-condi\u00e7\u00e3o do caso de uso \u201cPesquisa nomes de cidades\u201d, \nou seja, lista de nomes de cidades iniciados pelo texto informado pelo usu\u00e1rio \u00e9 \napresentada. Sua forma de funcionamento \u00e9 id\u00eantica ao caso de uso \u201cPesquisa nomes de \npropriet\u00e1rios\u201d descrita anteriormente. \n\nTabela 4.5: Descri\u00e7\u00e3o do caso de uso \u201cPesquisa por cidade\u201d \n\nUC 05 \u2013 Pesquisa por cidade \n\nAtores: Usu\u00e1rio. \n\n\n\n \n\n \n\n \n\nPr\u00e9-condi\u00e7\u00e3o: Nenhuma. \n\nP\u00f3s-condi\u00e7\u00e3o: Lotes de uma determinada linha colonial \nsituada na cidade informada exibidos no \nmapa. \n\nDescri\u00e7\u00e3o: Usu\u00e1rio pesquisa por lotes informando o \nnome da cidade. Rela\u00e7\u00e3o de linhas \ncoloniais com lotes na cidade informada \u00e9 \napresentada ao usu\u00e1rio. Usu\u00e1rio seleciona \numa das linhas da lista e os lotes da \nmesma s\u00e3o mostrados no mapa. \n\nSequ\u00eancia de eventos: \n\nAtor Sistema \n\n1. Informa o nome da cidade.  \n\n 2. Apresenta uma lista de linhas coloniais \nque tenham lotes na cidade informada. \n\n3. Seleciona uma das linhas coloniais da \nlista. \n\n \n\n 4. Exibe no mapa os lotes da linha \nselecionada. \n\n5. O usu\u00e1rio visualiza os lotes da linha \nselecionada e o caso de uso \u00e9 encerrado. \n\n \n\nFluxo alternativo 01: \n\n1.1. Informa um nome de cidade \ninexistente ou sem registro de linhas \ncoloniais. \n\n \n\n 2.1. Informa que n\u00e3o h\u00e1 registros de linhas \ncoloniais na cidade informada. \n\n \n\nNa Tabela 4.5 \u00e9 detalhada a pesquisa de lotes atrav\u00e9s de cidade, constante na se\u00e7\u00e3o \n\u201cPesquisa por localidade\u201d do menu da aplica\u00e7\u00e3o. \n\nO caso de uso apresenta um fluxo alternativo semelhante ao caso de uso \u201cPesquisa \npor propriet\u00e1rio\u201d. Entretanto, o nome informado pelo usu\u00e1rio deve ser id\u00eantico ao \ncadastrado no sistema, uma vez que n\u00e3o \u00e9 efetuada pesquisa por similaridade em nomes \nde cidades. \n\n\n\n \n\n \n\n34 \n\n \n\nFigura 4.9: Tela de interface do caso de uso \u201cPesquisa por cidade\u201d \n\nA Figura 4.9 mostra a p\u00f3s-condi\u00e7\u00e3o do caso de uso \u201cPesquisa por cidade\u201d, ou seja, \nlotes de uma determinada linha colonial exibidos no mapa. Conforme detalhado na \nTabela 4.5, o usu\u00e1rio informa o nome da cidade e o sistema exibe uma tabela com as \nlinhas coloniais que tem lotes na cidade informada, exibindo o nome da col\u00f4nia a qual a \nlinha pertence e o n\u00famero de lotes que pertencem \u00e0 cidade pesquisada. Ent\u00e3o, o usu\u00e1rio \nseleciona uma das linhas da tabela e seus lotes s\u00e3o mostrados no mapa, al\u00e9m de ser \ncriada uma entrada para a linha colonial na se\u00e7\u00e3o \u201cPesquisa por col\u00f4nia e linha\u201d, a \nprincipal da aplica\u00e7\u00e3o. \n\n \n\nFigura 4.10: Tela de interface do caso de uso \u201cPesquisa por cidade\u201d em seu fluxo \nalternativo \n\n \n\n\n\n \n\n \n\n \n\nA Figura 4.10 mostra o fluxo alternativo do caso de uso \u201cPesquisa por cidade\u201d, no \nqual o sistema informa ao usu\u00e1rio que n\u00e3o h\u00e1 registros com o nome informado. \n\nTabela 4.6: Descri\u00e7\u00e3o do caso de uso \u201cPesquisa nomes de localidades\u201d \n\nUC 06 \u2013 Pesquisa nomes de localidades \n\nAtores: Usu\u00e1rio. \n\nPr\u00e9-condi\u00e7\u00e3o: Nenhuma. \n\nP\u00f3s-condi\u00e7\u00e3o: Lista com nomes de localidades (col\u00f4nias \ne/ou linhas) que iniciem pelo texto \ninformado apresentada. \n\nDescri\u00e7\u00e3o: Usu\u00e1rio pesquisa por lotes informando o \nnome de col\u00f4nia e/ou linha e, enquanto \nisso, \u00e9 apresentada ao mesmo uma lista \ncom todos os nomes que iniciem pelo \ntexto j\u00e1 informado (precede o caso de uso \n\u201cPesquisa livre por col\u00f4nia e linha\u201d). \n\nSequ\u00eancia de eventos: \n\nAtor Sistema \n\n1. Come\u00e7a a informar o nome da col\u00f4nia \ne/ou linha para pesquisa de seus lotes, \nconforme UC 04. \n\n \n\n 2. Apresenta uma lista com nomes de \nlocalidades que iniciem pelo texto j\u00e1 \ninformado pelo usu\u00e1rio. \n\n3. O usu\u00e1rio visualiza a lista de nomes e \no caso de uso \u00e9 encerrado. \n\n \n\nRN 01 \u2013 Regra de neg\u00f3cio 01: \n\n1. A pesquisa por nomes de localidades deve ser iniciada somente a partir da 2\u00aa \n(segunda) letra informada pelo usu\u00e1rio. \n\nRN 02 \u2013 Regra de neg\u00f3cio 02: \n\n2. A pesquisa por nomes de localidades deve ser realizada sempre que o usu\u00e1rio \ninformar uma nova letra do nome (a partir da 2\u00aa, conforme RN 01). \n\n \n\nNa Tabela 4.6 \u00e9 detalhada a pesquisa autom\u00e1tica de nomes de localidades, \nconstante na se\u00e7\u00e3o \u201cPesquisa por localidade\u201d do menu da aplica\u00e7\u00e3o. \n\n\n\n \n\n \n\n36 \n\n \n\nFigura 4.11: Tela de interface do caso de uso \u201cPesquisa nomes de localidades\u201d \n\nA Figura 4.11 mostra a p\u00f3s-condi\u00e7\u00e3o do caso de uso \u201cPesquisa nomes de \nlocalidades\u201d, ou seja, lista de nomes de localidades (col\u00f4nias e/ou linhas) iniciadas pelo \ntexto informado pelo usu\u00e1rio \u00e9 apresentada. Sua forma de funcionamento \u00e9 id\u00eantica aos \ncasos de uso \u201cPesquisa nomes de propriet\u00e1rios\u201d e \u201cPesquisa nomes de cidades\u201d \ndescritas anteriormente. \n\nTabela 4.7: Descri\u00e7\u00e3o do caso de uso \u201cPesquisa livre por col\u00f4nia e linha\u201d \n\nUC 07 \u2013 Pesquisa livre por col\u00f4nia e linha \n\nAtores: Usu\u00e1rio. \n\nPr\u00e9-condi\u00e7\u00e3o: Nenhuma. \n\nP\u00f3s-condi\u00e7\u00e3o: Col\u00f4nia selecionada na caixa de sele\u00e7\u00e3o \ncorrespondente (no caso da localidade ser \ncol\u00f4nia) ou lotes da linha selecionada \nexibidos no mapa (no caso da localidade \nser linha). \n\nDescri\u00e7\u00e3o: Usu\u00e1rio pesquisa por lotes informando o \nnome da col\u00f4nia e/ou linha. Rela\u00e7\u00e3o de \ncol\u00f4nias e/ou linhas com nomes iguais \ne/ou similares ao informado \u00e9 apresentada \nao usu\u00e1rio. Usu\u00e1rio seleciona uma das \nlocalidades da lista: caso seja col\u00f4nia, a \nmesma \u00e9 selecionada; caso seja linha, os \nlotes da mesma s\u00e3o mostrados no mapa. \n\nSequ\u00eancia de eventos: \n\n\n\n \n\n \n\n \n\nAtor Sistema \n\n1. Informa o nome da localidade (col\u00f4nia \ne/ou linha) e o n\u00famero m\u00e1ximo de \nregistros a serem retornados. \n\n \n\n 2. Apresenta uma lista de localidades \n(col\u00f4nias e/ou linhas) com nome igual \ne/ou similar ao informado. \n\n3. Seleciona uma das localidades da lista.  \n\n 4. Se a localidade selecionada for col\u00f4nia, \nseleciona a mesma na caixa de sele\u00e7\u00e3o \ncorrespondente; caso tratar-se de uma \nlinha, exibe os lotes da mesma no mapa. \n\n5. O usu\u00e1rio visualiza a col\u00f4nia \nselecionada ou os lotes da linha \nselecionada e o caso de uso \u00e9 encerrado. \n\n \n\nFluxo alternativo 01: \n\n1.1. Informa um nome de localidade \ninexistente e sem similaridade com \nqualquer nome existente. \n\n \n\n 2.1. Informa que n\u00e3o h\u00e1 registros de \nlocalidades com o nome informado. \n\n \n\nNa Tabela 4.7 \u00e9 detalhada a pesquisa livre de lotes atrav\u00e9s de col\u00f4nia e linha, \nconstante na se\u00e7\u00e3o \u201cPesquisa por localidade\u201d do menu da aplica\u00e7\u00e3o. \n\nO caso de uso apresenta um fluxo alternativo id\u00eantico ao caso de uso \u201cPesquisa por \npropriet\u00e1rio\u201d, isto \u00e9, o sistema apresenta uma mensagem informando que n\u00e3o h\u00e1 \nregistros com o nome informado quando n\u00e3o h\u00e1 pelo menos um nome similar \ncadastrado. \n\n\n\n \n\n \n\n38 \n\n \n\nFigura 4.12: Tela de interface do caso de uso \u201cPesquisa livre por col\u00f4nia e linha\u201d com \nsele\u00e7\u00e3o de col\u00f4nia \n\nA Figura 4.12 mostra uma das p\u00f3s-condi\u00e7\u00f5es do caso de uso \u201cPesquisa livre por \ncol\u00f4nia e linha\u201d \u2013 quando o usu\u00e1rio seleciona uma col\u00f4nia na lista de resultados da \npesquisa, a mesma \u00e9 selecionada na se\u00e7\u00e3o \u201cPesquisa por col\u00f4nia e linha\u201d, a principal do \nmenu da aplica\u00e7\u00e3o. Conforme detalhado na Tabela 4.7, ap\u00f3s o usu\u00e1rio ter informado o \nnome da localidade, o sistema exibe uma lista de localidades (col\u00f4nias e/ou linhas). Na \nFigura 4.12, existe uma col\u00f4nia e uma linha com o nome \u201cAlfredo Chaves\u201d e o usu\u00e1rio \nescolheu a col\u00f4nia, sendo que a mesma foi selecionada na caixa de sele\u00e7\u00e3o \ncorrespondente. \n\n \n\nFigura 4.13: Tela de interface do caso de uso \u201cPesquisa livre por col\u00f4nia e linha\u201d com \nsele\u00e7\u00e3o de linha \n\n\n\n \n\n \n\n \n\nA Figura 4.13 mostra outra das p\u00f3s-condi\u00e7\u00f5es do caso de uso \u201cPesquisa livre por \ncol\u00f4nia e linha\u201d \u2013 quando o usu\u00e1rio seleciona uma linha na lista de resultados da \npesquisa, seus lotes s\u00e3o exibidos no mapa, al\u00e9m de ser criada uma entrada para a mesma \nna se\u00e7\u00e3o \u201cPesquisa por col\u00f4nia e linha\u201d, a principal da aplica\u00e7\u00e3o. Na Figura 4.13, existe \numa col\u00f4nia e uma linha com o nome \u201cAlfredo Chaves\u201d e o usu\u00e1rio escolheu a linha, \nsendo que seus lotes s\u00e3o mostrados no mapa. \n\n \n\nFigura 4.14: Tela de interface do caso de uso \u201cPesquisa por localidade\u201d em seu fluxo \nalternativo \n\nA Figura 4.14 mostra o fluxo alternativo do caso de uso \u201cPesquisa por localidade\u201d, \nno qual o sistema informa ao usu\u00e1rio que n\u00e3o h\u00e1 registros com o nome informado e nem \nsimilares a ele. \n\nTabela 4.8: Descri\u00e7\u00e3o do caso de uso \u201cPesquisa informa\u00e7\u00f5es do lote\u201d \n\nUC 08 \u2013 Pesquisa informa\u00e7\u00f5es do lote \n\nAtores: Usu\u00e1rio. \n\nPr\u00e9-condi\u00e7\u00e3o: Lote exibido no mapa. \n\nP\u00f3s-condi\u00e7\u00e3o: Tabela de informa\u00e7\u00f5es do lote \napresentada. \n\nDescri\u00e7\u00e3o: Usu\u00e1rio pesquisa pelas informa\u00e7\u00f5es do \nlote selecionando-o no mapa. Tabela de \ninforma\u00e7\u00f5es referentes ao lote \u00e9 \napresentada ao usu\u00e1rio. \n\nSequ\u00eancia de eventos: \n\nAtor Sistema \n\n\n\n \n\n \n\n40 \n\n1. Seleciona, atrav\u00e9s do clique do mouse, \num lote exibido no mapa. \n\n \n\n 2. Apresenta uma tabela com informa\u00e7\u00f5es \nreferente ao lote selecionado. \n\n3. O usu\u00e1rio visualiza as informa\u00e7\u00f5es do \nlote e o caso de uso \u00e9 encerrado. \n\n \n\n \n\nNa Tabela 4.8 \u00e9 detalhada a pesquisa por informa\u00e7\u00f5es de um determinado lote do \nmapa. O caso de uso \u00e9 bastante simples, n\u00e3o apresentando fluxos alternativos ou regras \nde neg\u00f3cios. Entretanto, requer pr\u00e9-condi\u00e7\u00e3o, ou seja, que haja ao menos um lote \nexibido no mapa \u2013 p\u00f3s-condi\u00e7\u00e3o dos casos de uso \u201cPesquisa estruturada por col\u00f4nia e \nlinha\u201d, \u201cPesquisa por propriet\u00e1rio\u201d, \u201cPesquisa por cidade\u201d e \u201cPesquisa livre por col\u00f4nia \ne linha\u201d. \n\n \n\nFigura 4.15: Tela de interface do caso de uso \u201cPesquisa informa\u00e7\u00f5es do lote\u201d \n\nA Figura 4.15 mostra a p\u00f3s-condi\u00e7\u00e3o do caso de uso \u201cPesquisa informa\u00e7\u00f5es do \nlote\u201d, ou seja, tabela de informa\u00e7\u00f5es do lote selecionado \u00e9 exibida. Conforme detalhado \nna Tabela 4.8, o usu\u00e1rio seleciona um lote no mapa clicando sobre o mesmo e o sistema \nexibe suas informa\u00e7\u00f5es b\u00e1sicas, dados obtidos atrav\u00e9s de geoprocessamento e \ninforma\u00e7\u00f5es sobre seu(s) propriet\u00e1rio(s) (se houver). \n\n\n\n \n\n \n\n \n\n5 ARQUITETURA DA APLICA\u00c7\u00c3O \n\nPara demonstrar a arquitetura da solu\u00e7\u00e3o (isto \u00e9, como o sistema prov\u00ea suas \nfuncionalidades), continuar\u00e1 se utilizando a UML atrav\u00e9s de seus diagramas de classes e \nde sequ\u00eancia. Entretanto, antes disso, \u00e9 muito importante detalhar a estrutura geral da \nsolu\u00e7\u00e3o proposta, citando as tecnologias envolvidas e como elas se relacionam entre si \ne, al\u00e9m disso, o modelo de dados utilizado para armazenamento das informa\u00e7\u00f5es da \naplica\u00e7\u00e3o. \n\n5.1 Arquitetura geral \nA solu\u00e7\u00e3o proposta apresenta v\u00e1rias tecnologias relacionando-se entre si formando \n\na arquitetura do sistema. A Figura 5.1 demonstra, graficamente, as associa\u00e7\u00f5es entre tais \ntecnologias. \n\n \n\nFigura 5.1: Arquitetura geral do sistema \n\n\u00c9 necess\u00e1rio detalhar cada elemento (e seus relacionamentos) da Figura 5.1 para \num bom entendimento da estrutura proposta. \n\nHTML (Hypertext Markup Language) \u2013 linguagem de marca\u00e7\u00e3o estruturada \nutilizada na aplica\u00e7\u00e3o para denotar os elementos da p\u00e1gina, tais como caixas de sele\u00e7\u00e3o, \ncaixas de texto e t\u00edtulos. N\u00e3o configura o visual dos componentes: sua fun\u00e7\u00e3o \u00e9 definir \napenas a estrutura da p\u00e1gina. \n\n\n\n \n\n \n\n42 \n\nCSS (Cascading Style Sheets) \u2013 linguagem de estilos utilizada na aplica\u00e7\u00e3o para \ncaracterizar o visual de seus componentes (os quais foram definidos atrav\u00e9s de HTML), \nou seja, a cor de um objeto, seu posicionamento em rela\u00e7\u00e3o aos demais elementos, entre \noutras formata\u00e7\u00f5es. \n\nDOM (Document Object Model) \u2013 conven\u00e7\u00e3o utilizada por browsers para \nrepresentar uma p\u00e1gina HTML como um conjunto de objetos que podem ser acessados \nprogramaticamente atrav\u00e9s de JavaScript. \n\nJavaScript \u2013 linguagem de script executada em browsers que permite o dinamismo \nem uma p\u00e1gina Web, isto \u00e9, permite o acesso e a manipula\u00e7\u00e3o program\u00e1tica dos objetos \nde uma p\u00e1gina (atrav\u00e9s da interface DOM), al\u00e9m de orquestrar as requisi\u00e7\u00f5es ao \nservidor (atrav\u00e9s do objeto XMLHttpRequest). \n\nASP.NET AJAX \u2013 conjunto de extens\u00f5es do framework ASP.NET com a finalidade \nde fornecer uma interface de programa\u00e7\u00e3o Ajax mais simplificada e produtiva. Divide-\nse em dois frameworks: do lado cliente (biblioteca JavaScript) e do lado servidor \n(biblioteca de classes .NET). O framework do lado cliente (chamado de Microsoft Ajax \nLibrary) \u00e9 utilizado extensivamente na aplica\u00e7\u00e3o, pois, al\u00e9m das facilidades em Ajax, \nminimiza as discrep\u00e2ncias de implementa\u00e7\u00e3o da DOM e do JavaScript em diferentes \nbrowsers.  \n\nXMLHttpRequest \u2013 objeto que \u00e9 utilizado dentro do JavaScript para enviar e \nreceber requisi\u00e7\u00f5es HTTP diretamente ao/do servidor Web, dando vida ao paradigma de \nprograma\u00e7\u00e3o Ajax (Asynchronous JavaScript and XML). Dessa forma, \u00e9 poss\u00edvel que o \nbrowser realize transfer\u00eancias de dados ass\u00edncronas com o servidor, sem a necessidade \nde um refresh da p\u00e1gina. \n\nJSON (JavaScript Object Notation) \u2013 formato de interc\u00e2mbio de dados utilizado \nprincipalmente como alternativa ao XML na transfer\u00eancia de informa\u00e7\u00f5es em \nrequisi\u00e7\u00f5es Ajax. Sua maior vantagem \u00e9 o fato de ser um formato bastante leve e muito \nsemelhante a objetos literais do JavaScript. \n\nASP.NET \u2013 framework para o desenvolvimento de aplica\u00e7\u00f5es Web utilizado no \nsistema para constru\u00e7\u00e3o da p\u00e1gina Web e para o acesso aos dados. Para tanto, \u00e9 usado \nem conjunto com alguma linguagem de programa\u00e7\u00e3o .NET \u2013 no caso da solu\u00e7\u00e3o \nproposta, a linguagem C#. \n\nBanco de dados \u2013 cole\u00e7\u00e3o de registros logicamente conectados onde todos os dados \nda aplica\u00e7\u00e3o ficam armazenados. A solu\u00e7\u00e3o proposta oferece suporte para dois DBMSs \n(Database Management System): SQL Server e MySQL. \n\nO usu\u00e1rio, atrav\u00e9s de seu browser, visualiza apenas HTML e estilos dos elementos \naplicados atrav\u00e9s de CSS. Conforme ele vai interagindo com a p\u00e1gina, JavaScript \u00e9 \nutilizado para realizar todo o tipo de procedimento, desde mostrar ou esconder uma \nse\u00e7\u00e3o do menu at\u00e9 pesquisar informa\u00e7\u00f5es no banco de dados (atrav\u00e9s de requisi\u00e7\u00f5es \nAjax). Para manipular os elementos da p\u00e1gina, JavaScript utiliza a DOM e, dependendo \ndo caso, aplica estilos CSS dinamicamente. Para a intera\u00e7\u00e3o com o servidor, a biblioteca \nASP.NET AJAX encapsula as fun\u00e7\u00f5es da API XMLHttpRequest e trata do envio e do \nrecebimento das requisi\u00e7\u00f5es Ajax realizadas. Apesar do nome, a XMLHttpRequest n\u00e3o \ntrabalha apenas com XML \u2013 no caso do ASP.NET AJAX, os dados entre cliente e \nservidor s\u00e3o trafegados atrav\u00e9s de JSON. Para tanto, existe a serializa\u00e7\u00e3o e a \ndesserializa\u00e7\u00e3o autom\u00e1tica de JSON para objetos v\u00e1lidos em JavaScript (lado cliente) e \nC# (lado servidor), tudo realizado automaticamente pelo framework do ASP.NET \n\n\n\n \n\n \n\n \n\nAJAX. No lado do servidor, o ASP.NET, atrav\u00e9s de classes especializadas, realiza as \ndevidas requisi\u00e7\u00f5es ao banco de dados, o qual fornece as informa\u00e7\u00f5es necess\u00e1rias para \ncada requisi\u00e7\u00e3o do cliente. As chamadas entre cliente e servidor ser\u00e3o vistas com mais \ndetalhe quando forem apresentados os diagramas de sequ\u00eancia dos casos de uso da \nsolu\u00e7\u00e3o proposta na se\u00e7\u00e3o 5.4. \n\nO modelo de desenvolvimento adotado na solu\u00e7\u00e3o proposta \u00e9 chamado de Modelo \nde desenvolvimento centrado no (lado) cliente (tradu\u00e7\u00e3o do termo, em ingl\u00eas, client-\ncentric development model). Tal modelo se caracteriza pelo fato da l\u00f3gica de \napresenta\u00e7\u00e3o e de neg\u00f3cios da aplica\u00e7\u00e3o estar concentrada no lado cliente, isto \u00e9, \ncontrolada atrav\u00e9s de JavaScript. As intera\u00e7\u00f5es entre cliente e servidor limitam-se \napenas ao acesso aos dados estritamente necess\u00e1rios em cada momento, tal como buscar \na lista de linhas de uma dada col\u00f4nia ou pesquisar as informa\u00e7\u00f5es de um dado lote no \nmomento que o usu\u00e1rio assim o desejar. Quando tais dados chegam ao lado cliente, o \nc\u00f3digo JavaScript atualiza apenas as por\u00e7\u00f5es da p\u00e1gina que dizem respeito \u00e0quelas \ninforma\u00e7\u00f5es. Este modelo tem como princ\u00edpio oferecer uma interatividade bem maior \nentre o usu\u00e1rio e a aplica\u00e7\u00e3o rodando em seu browser, resultando em uma experi\u00eancia \nmais rica e intuitiva (GALLO, 2007). \n\n5.2 Modelo de dados \nA modelagem do banco de dados da aplica\u00e7\u00e3o foi baseada na modelagem \n\npreviamente existente em formato .dbf (DBMS dBase) fornecida pelo Dr. Ot\u00e1vio Licht. \nTal formato foi utilizado tendo em vista que o software ArcGIS, onde a plotagem inicial \ndos dados georreferenciados foi realizada, armazena todas as suas informa\u00e7\u00f5es (com \nexce\u00e7\u00e3o das coordenadas dos lotes coloniais) em arquivos .dbf. \n\nA Figura 5.2 mostra a modelagem ER (entidade-relacionamento) do banco de \ndados da aplica\u00e7\u00e3o. \n\n\n\n \n\n \n\n44 \n\n \n\nFigura 5.2: Modelo ER da aplica\u00e7\u00e3o \n\nA principal tabela de dados da aplica\u00e7\u00e3o \u00e9 Lote, a qual cont\u00e9m as informa\u00e7\u00f5es \nb\u00e1sicas de um dado lote colonial, tal como a identifica\u00e7\u00e3o de sua col\u00f4nia, sua linha e um \ncampo de chave que serve para manter a rela\u00e7\u00e3o com seu(s) propriet\u00e1rio(s). Tendo em \nvista a exist\u00eancia de v\u00e1rios n\u00facleos, cidades, sec\u00e7\u00f5es, lados/alas, col\u00f4nias e linhas \ncompartilhados entre v\u00e1rios lotes, h\u00e1 uma tabela de dados para cada um desses \nelementos, com uma chave estrangeira para cada um. Com exce\u00e7\u00e3o das informa\u00e7\u00f5es \nsobre cidade e eleva\u00e7\u00e3o m\u00e9dia (as quais s\u00e3o provindas dos dados obtidos atrav\u00e9s do \nservi\u00e7o GeoNames), todos os dados foram constru\u00eddos atrav\u00e9s da tabela .dbf j\u00e1 \nexistente. \n\nA tabela Coordenada_Lote mant\u00e9m uma rela\u00e7\u00e3o de muitos-para-um com a tabela \nLote pois armazena todas as coordenadas da borda de um lote. Dessa forma, por \nexemplo, se um lote tiver um formato estritamente retangular, ele ter\u00e1 associa\u00e7\u00e3o com, \npelo menos, quatro registros da tabela Coordenada_Lote (um para cada esquina do lote, \nno m\u00ednimo). \n\n\n\n \n\n \n\n \n\nA tabela Proprietario n\u00e3o mant\u00e9m informa\u00e7\u00f5es referentes apenas ao dono do lote, e \nsim tamb\u00e9m sobre os dados de concess\u00e3o do mesmo. Devido \u00e0 fraca integridade dos \ndados constantes na tabela em dBase original, n\u00e3o foi poss\u00edvel mapear cada propriet\u00e1rio \nindividualmente e manter uma tabela de dados \u00e0 parte para as informa\u00e7\u00f5es de cada \npessoa e outra apenas para os dados da concess\u00e3o. Dessa forma, foi utilizada a estrutura \nj\u00e1 existente. O campo Chave_Lote referencia o campo Chave da tabela Lote, associando \num propriet\u00e1rio a seu lote. Contudo, n\u00e3o se trata de uma chave estrangeira, uma vez \nque, nos dados iniciais das tabelas em dBase, existiam propriet\u00e1rios sem rela\u00e7\u00e3o com \nlote e vice-versa. \n\nAs tabelas com sufixo _Qgram armazenam os dados referentes aos q-grams \ndetalhados no cap\u00edtulo 3. Dessa forma, por exemplo, Linha_Qgram mant\u00e9m os q-grams \nde todos os nomes de linhas existentes na tabela Linha. A \u00fanica exce\u00e7\u00e3o \u00e9 a tabela \nConsulta_Qgram a qual, conforme j\u00e1 explicado no cap\u00edtulo 3, \u00e9 populada \ndinamicamente com os q-grams da string de consulta realizada. \n\n5.3 Diagramas de classes \nVisando obter uma melhor estrutura\u00e7\u00e3o da solu\u00e7\u00e3o proposta, o c\u00f3digo-fonte no lado \n\nservidor foi organizado em tr\u00eas tipos de classes: neg\u00f3cio, dados e \u00fateis. Dessa forma, a \np\u00e1gina ASP.NET (no servidor) n\u00e3o cont\u00e9m l\u00f3gica alguma, delegando tais tarefas \u00e0s \nreferidas classes. \u00c9 importante uma breve explica\u00e7\u00e3o sobre a fun\u00e7\u00e3o de cada categoria \nde classe. \n\nNeg\u00f3cio \u2013 categoria que tamb\u00e9m poderia ser chamada de \u201cTransporte\u201d, espelha a \nmodelagem das tabelas do banco de dados. \u00c9 utilizada na transfer\u00eancia dos dados entre \nas classes de dados e a p\u00e1gina ASP.NET e entre a \u00faltima e a p\u00e1gina no lado cliente \n(JavaScript). \n\nDados \u2013 realiza a tarefa de obter as informa\u00e7\u00f5es solicitadas junto ao banco de dados. \nPara tanto, faz uso das classes de neg\u00f3cio, criando um objeto espec\u00edfico a partir das \ninforma\u00e7\u00f5es de um registro de uma dada tabela do banco, e das classes \u00fateis, para \nrealizar procedimentos comuns. \n\n\u00dateis \u2013 categoria que tamb\u00e9m poderia ser chamada de \u201cSuporte\u201d, realiza \nprocedimentos repetitivos para a classe de dados e outras fun\u00e7\u00f5es que n\u00e3o se encaixam \nnas atribui\u00e7\u00f5es dos demais tipos de classes. \n\nAtrav\u00e9s da separa\u00e7\u00e3o das classes em categorias distintas, a manuten\u00e7\u00e3o do c\u00f3digo \nfica bem mais facilitada, uma vez que os erros podem ser descobertos mais facilmente. \nAl\u00e9m disso, altera\u00e7\u00f5es pontuais internas \u00e0s classes podem ser realizadas de maneira a \nn\u00e3o afetar as intera\u00e7\u00f5es com os demais tipos de classe, desde que se mantenha uma \ninterface consistente entre eles. \n\nA Figura 5.3 mostra a estrutura das classes de neg\u00f3cio da aplica\u00e7\u00e3o. \n\n\n\n \n\n \n\n46 \n\n \n\nFigura 5.3: Diagrama de classes: classes de neg\u00f3cio \n\nA modelagem das classes de neg\u00f3cio, conforme j\u00e1 mencionado, \u00e9 espelhada na \nmodelagem do banco de dados. Com exce\u00e7\u00e3o das tabelas de q-grams (as quais s\u00e3o \nutilizadas somente nas buscas por similaridade) e Cidade (a qual foi substitu\u00edda pela \nclasse LoteCidade, explicada adiante), todas as demais tabelas do banco foram \nmapeadas para classes. Entretanto, respeitando a programa\u00e7\u00e3o orientada a objetos, ao \ninv\u00e9s de haver chaves estrangeiras, as associa\u00e7\u00f5es s\u00e3o realizadas atrav\u00e9s de refer\u00eancias \na objetos (por exemplo, Lote cont\u00e9m uma inst\u00e2ncia da classe Colonia). Tais associa\u00e7\u00f5es \ndividem-se em composi\u00e7\u00e3o (o objeto referenciado n\u00e3o tem sentido sem o objeto que o \nreferencia), caracterizada pela liga\u00e7\u00e3o com o losango preenchido, e agrega\u00e7\u00e3o (o objeto \nreferenciado \u00e9 independente do objeto que o referencia, ou seja, mesmo que o \u00faltimo \nseja destru\u00eddo, o primeiro continua fazendo sentido), caracterizada pela liga\u00e7\u00e3o com o \nlosango vazio. \n\n\n\n \n\n \n\n \n\nAl\u00e9m das entidades existentes no banco de dados, foram criadas outras classes \nauxiliares. Uma breve explica\u00e7\u00e3o sobre tais elementos faz-se importante. \n\nProprietarioSimples \u2013 \u00e9 utilizada no caso de uso \u201cPesquisa por propriet\u00e1rio\u201d \nquando o sistema exibe uma lista de propriet\u00e1rios com nome igual e/ou similar ao \ninformado pelo usu\u00e1rio. Tal classe \u00e9 utilizada pois a classe Proprietario tem atributos \nque n\u00e3o s\u00e3o necess\u00e1rios pelo caso de uso e, visando buscar um maior rendimento na \npesquisa ao banco e na transfer\u00eancia de dados entre servidor e cliente, tal decis\u00e3o de \nprojeto foi tomada. \n\nLoteCidade \u2013 substitui a tabela Cidade, uma vez que n\u00e3o \u00e9 apresentada ao usu\u00e1rio \numa lista com os nomes de todas as cidades cadastradas. \u00c9 utilizada no caso de uso \n\u201cPesquisa por cidade\u201d ap\u00f3s o usu\u00e1rio ter informado o nome da cidade desejada. Ent\u00e3o, o \nsistema exibe uma tabela com as linhas coloniais que contenham lotes na cidade, \nmostrando o nome da col\u00f4nia e o n\u00famero de lotes naquela localidade. \n\nLocalidade \u2013 \u00e9 utilizada no caso de uso \u201cPesquisa por localidade\u201d quando o sistema \nexibe uma lista de col\u00f4nias e/ou linhas com nome igual e/ou similar ao informado pelo \nusu\u00e1rio. Conta com um campo do tipo enumera\u00e7\u00e3o, TipoLocalidade, para caracterizar o \nobjeto como representando uma col\u00f4nia ou linha. \n\nEncodedPolyline \u2013 \u00e9 utilizada apenas para fins de melhoria de desempenho na \n\u201cplotagem\u201d (desenho) dos lotes no Google Maps. Apesar de a classe Lote manter uma \nlista de objetos da classe Coordenada, os pol\u00edgonos referentes aos lotes s\u00e3o desenhados \nno mapa atrav\u00e9s de um objeto EncodedPolyline, o qual cont\u00e9m todas as coordenadas do \nlote em um formato codificado (uma breve explica\u00e7\u00e3o sobre tal codifica\u00e7\u00e3o ser\u00e1 \napresentada junto \u00e0 classe PolylineEncoder das classes \u00fateis). A classe Coordenada s\u00f3 \u00e9 \nutilizada no c\u00f3digo JavaScript para determinar onde ser\u00e1 realizado o zoom sobre uma \ndeterminada regi\u00e3o selecionada pelo usu\u00e1rio. \n\nA Figura 5.4 mostra a estrutura das classes de dados da aplica\u00e7\u00e3o. \n\n\n\n \n\n \n\n48 \n\n \n\nFigura 5.4: Diagrama de classes: classes de dados \n\nAs classes de acesso a dados foram categorizadas conforme o tipo de pesquisa que \nrealizam. \n\nA classe AutoCompleteDAL \u00e9 respons\u00e1vel pelas pesquisas realizadas nos casos de \nuso \u201cPesquisa nomes de propriet\u00e1rios\u201d, \u201cPesquisa nomes de cidades\u201d e \u201cPesquisa nomes \nde localidades\u201d (fun\u00e7\u00f5es de auto-completar). Seus m\u00e9todos recebem como par\u00e2metros o \ntexto j\u00e1 informado e o n\u00famero m\u00e1ximo de registros a serem retornados. \n\nA classe PesquisaDAL \u00e9 respons\u00e1vel pelas pesquisas gerais da aplica\u00e7\u00e3o. Todos os \nm\u00e9todos que n\u00e3o se encaixam em uma categoria espec\u00edfica pertencem a esta classe. \n\nA classe SimilaridadeDAL \u00e9 respons\u00e1vel pelas pesquisas realizadas nos casos de uso \n\u201cPesquisa por propriet\u00e1rio\u201d e \u201cPesquisa livre por col\u00f4nia e linha\u201d (buscas por \nsimilaridade de nomes). Assim como na classe AutoCompleteDAL, seus m\u00e9todos \np\u00fablicos recebem como par\u00e2metros o texto informado e o n\u00famero m\u00e1ximo de registros \n(esse \u00faltimo argumento escolhido pelo usu\u00e1rio). \n\nA Figura 5.5 mostra a estrutura das classes \u00fateis da aplica\u00e7\u00e3o. \n\n\n\n \n\n \n\n \n\n \n\nFigura 5.5: Diagrama de classes: classes \u00fateis \n\nA classe DBHelper \u00e9 utilizada exclusivamente pelas classes de dados para realizar \nalguns procedimentos comuns, tal como criar uma conex\u00e3o com o banco de dados, e \nfornecer uma forma de abstra\u00e7\u00e3o independente do banco de dados utilizado (SQLServer \nou MySQL). Dessa forma, por exemplo, a classe de dados n\u00e3o tem o dever de saber \nqual \u00e9 a fun\u00e7\u00e3o utilizada pelo DBMS sendo utilizado para determinar o tamanho de uma \nstring: basta ler o valor da propriedade FuncaoTamanhoString da classe DBHelper. \n\nAs classes PolylineEncoder e Trackpoint, assim como a classe de neg\u00f3cios \nEncodedPolyline, foram obtidas no site http://www.svennerberg.com (acesso em agosto \nde 2009) e est\u00e3o sob a licen\u00e7a GPL (General Public License), ou seja, podem ser usadas \ne alteradas livremente (contudo, na aplica\u00e7\u00e3o est\u00e3o sendo utilizadas exatamente \nconforme foram projetadas). A finalidade de tais entidades \u00e9 melhorar o desempenho da \nplotagem de pol\u00edgonos (os quais representam os lotes coloniais na solu\u00e7\u00e3o proposta) no \nGoogle Maps. O algoritmo que codifica as coordenadas remove algumas que s\u00e3o \nirrelevantes e tamb\u00e9m controla o n\u00famero de pontos mostrados no mapa quando o \nusu\u00e1rio altera o zoom. Dessa forma, mais lotes podem ser exibidos no mapa ao mesmo \ntempo com uma menor degrada\u00e7\u00e3o da performance da aplica\u00e7\u00e3o. \n\n\n\n \n\n \n\n50 \n\n5.4 Diagramas de sequ\u00eancia \nOs diagramas de sequ\u00eancia da UML s\u00e3o importantes para demonstrar a intera\u00e7\u00e3o \n\nentre os objetos da aplica\u00e7\u00e3o, dando \u00eanfase \u00e0 sequ\u00eancia com que tais relacionamentos \nacontecem. A partir deles, a arquitetura geral tende a ficar mais clara, uma vez que \nmostram todas as requisi\u00e7\u00f5es (e respectivas respostas) realizadas entre cliente \n(JavaScript) e servidor (ASP.NET). \n\nNormalmente, \u00e9 constru\u00eddo um diagrama de sequ\u00eancia para cada caso de uso \n(quando este \u00e9 muito grande, pode ser decomposto em mais de um diagrama) e assim \nfoi feito para a solu\u00e7\u00e3o proposta. A Figura 5.6 mostra o diagrama de sequ\u00eancia para o \ncaso de uso \u201cPesquisa estruturada por col\u00f4nia e linha\u201d. \n\n \n\nFigura 5.6: Diagrama de sequ\u00eancia do caso de uso \u201cPesquisa estruturada por col\u00f4nia e \nlinha\u201d \n\nPrimeiramente, algumas considera\u00e7\u00f5es devem ser feitas. Conforme j\u00e1 mencionado \nanteriormente, o framework ASP.NET AJAX, atrav\u00e9s da biblioteca Microsoft Ajax \nLibrary para JavaScript, abstrai a funcionalidade do objeto XMLHttpRequest a fim de \nfacilitar a realiza\u00e7\u00e3o de requisi\u00e7\u00f5es Web ao servidor. Na programa\u00e7\u00e3o Ajax, o m\u00e9todo \ncomum (sem aux\u00edlio de bibliotecas) requer que o programador primeiro verifique o \nbrowser que est\u00e1 acessando a p\u00e1gina: dependendo do navegador, o objeto \nXMLHttpRequest \u00e9 criado de uma forma diferente. Ap\u00f3s isso, deve definir uma s\u00e9rie de \npar\u00e2metros e realizar algumas checagens, algo que se torna tedioso e propenso a erros. \nAo encapsular as funcionalidades do XMLHttpRequest (atrav\u00e9s de certos proxies \ncriados automaticamente entre o cliente e o servidor), o ASP.NET AJAX permite que \num m\u00e9todo definido no servidor (na p\u00e1gina ASP.NET) seja invocado pelo c\u00f3digo \nJavaScript atrav\u00e9s de seu nome, exatamente como se ambos estivessem no lado \nservidor. Para tanto, basta prefixar o nome do m\u00e9todo com \u201cPageMethods.\u201d e passar \ncomo par\u00e2metros os tipos de dados requisitados (os quais s\u00e3o serializados e \ndesserializados em JSON, conforme j\u00e1 mencionado). Os tipos de dados entre cliente e \n\n\n\n \n\n \n\n \n\nservidor s\u00e3o convertidos para tipos v\u00e1lidos em ambos os lados. Por exemplo, n\u00e3o existe \num tipo List em JavaScript (como existe em C#) mas, ao serializ\u00e1-lo para JSON, o \nASP.NET AJAX converte o tipo para um array v\u00e1lido em JavaScript (e o contr\u00e1rio \ntamb\u00e9m \u00e9 verdadeiro). Dessa forma, a integra\u00e7\u00e3o entre cliente e servidor ocorre de \nforma transparente ao programador. \n\nA Figura 5.6 detalha a sequ\u00eancia de requisi\u00e7\u00f5es realizadas ao servidor no caso de \nuso \u201cPesquisa estruturada por col\u00f4nia e linha\u201d. A l\u00f3gica \u00e9 bastante simples: logo que a \naplica\u00e7\u00e3o \u00e9 iniciada, a lista de col\u00f4nias \u00e9 pesquisada no banco de dados e armazenada \nno lado cliente. Ap\u00f3s isso, assim que o usu\u00e1rio selecionar uma das col\u00f4nias da caixa de \nsele\u00e7\u00e3o correspondente, suas linhas s\u00e3o automaticamente pesquisadas. Com isso, basta o \nusu\u00e1rio selecionar uma das linhas coloniais e seus lotes s\u00e3o pesquisados e \nposteriormente exibidos no mapa. Conforme j\u00e1 explicado na se\u00e7\u00e3o 5.3, a p\u00e1gina \nASP.NET simplesmente repassa as requisi\u00e7\u00f5es para a classe de dados respons\u00e1vel, a \nqual, nesse caso, \u00e9 PesquisaDAL. \n\n \n\nFigura 5.7: Diagrama de sequ\u00eancia do caso de uso \u201cPesquisa nomes de propriet\u00e1rios\u201d \n\nA Figura 5.7 detalha a sequ\u00eancia de intera\u00e7\u00f5es entre cliente e servidor no caso de \nuso \u201cPesquisa nomes de propriet\u00e1rios\u201d. Apenas uma requisi\u00e7\u00e3o \u00e9 realizada a cada nova \nletra digitada pelo usu\u00e1rio na caixa de texto correspondente. \n\n \n\n\n\n \n\n \n\n52 \n\n \n\nFigura 5.8: Diagrama de sequ\u00eancia do caso de uso \u201cPesquisa por propriet\u00e1rio\u201d \n\nA Figura 5.8 detalha a sequ\u00eancia de requisi\u00e7\u00f5es realizadas entre cliente e servidor \nno caso de uso \u201cPesquisa por propriet\u00e1rio\u201d. Nesse caso, duas classes de dados est\u00e3o \nenvolvidas, uma vez que primeiramente \u00e9 buscada uma lista de propriet\u00e1rios com nome \nigual e/ou similar ao informado pelo usu\u00e1rio (SimilaridadeDAL) e, ap\u00f3s o usu\u00e1rio \nselecionar o propriet\u00e1rio, seus lotes s\u00e3o pesquisados (PesquisaDAL). \n\n \n\nFigura 5.9: Diagrama de sequ\u00eancia do caso de uso \u201cPesquisa nomes de cidades\u201d \n\nA Figura 5.9 detalha a sequ\u00eancia de intera\u00e7\u00f5es entre cliente e servidor no caso de \nuso \u201cPesquisa nomes de cidades\u201d. Afora o nome dos m\u00e9todos chamados, o fluxo \u00e9 \nid\u00eantico ao do caso de uso \u201cPesquisa nomes de propriet\u00e1rios\u201d. \n\n\n\n \n\n \n\n \n\n \n\nFigura 5.10: Diagrama de sequ\u00eancia do caso de uso \u201cPesquisa por cidade\u201d \n\nA Figura 5.10 detalha a sequ\u00eancia de requisi\u00e7\u00f5es realizadas ao servidor no caso de \nuso \u201cPesquisa por cidade\u201d. O diagrama mostra que a segunda chamada ao ASP.NET s\u00f3 \n\u00e9 realizada atrav\u00e9s de uma condi\u00e7\u00e3o: se a linha selecionada pelo usu\u00e1rio j\u00e1 n\u00e3o constar \nno mapa. Tal condi\u00e7\u00e3o tamb\u00e9m existe nos demais casos de uso de pesquisa por lotes, \nmas foram omitidos por simplifica\u00e7\u00e3o. Se os lotes selecionados j\u00e1 est\u00e3o sendo exibidos \nno mapa, n\u00e3o se faz necess\u00e1ria uma nova requisi\u00e7\u00e3o ao banco de dados. \n\n \n\nFigura 5.11: Diagrama de sequ\u00eancia do caso de uso \u201cPesquisa nomes de localidades\u201d \n\nA Figura 5.11 detalha a sequ\u00eancia de intera\u00e7\u00f5es entre cliente e servidor no caso de \nuso \u201cPesquisa nomes de localidades\u201d. Com exce\u00e7\u00e3o dos m\u00e9todos chamados, o fluxo \u00e9 \nid\u00eantico ao dos casos de uso \u201cPesquisa nomes de propriet\u00e1rios\u201d e \u201cPesquisa nomes de \ncidades\u201d. \n\n\n\n \n\n \n\n54 \n\n \n\nFigura 5.12: Diagrama de sequ\u00eancia do caso de uso \u201cPesquisa livre por col\u00f4nia e linha\u201d \n\nA Figura 5.12 detalha a sequ\u00eancia de requisi\u00e7\u00f5es realizadas ao servidor no caso de \nuso \u201cPesquisa livre por col\u00f4nia e linha\u201d. O diagrama apresenta uma condi\u00e7\u00e3o, assim \ncomo na Figura 5.10, para buscar os lotes no banco de dados. Para tanto, o usu\u00e1rio deve \nter selecionado uma linha colonial na lista de localidades retornadas, uma vez que, \nquando ele escolhe uma col\u00f4nia, esta \u00e9 apenas selecionada na caixa de sele\u00e7\u00e3o \ncorrespondente. \n\n \n\nFigura 5.13: Diagrama de sequ\u00eancia do caso de uso \u201cPesquisa informa\u00e7\u00f5es do lote\u201d \n\nA Figura 5.13 detalha a sequ\u00eancia de intera\u00e7\u00f5es entre cliente e servidor no caso de \nuso \u201cPesquisa informa\u00e7\u00f5es do lote\u201d. Os dados do lote selecionado s\u00e3o simplesmente \npesquisados no banco de dados atrav\u00e9s do identificador \u00fanico do lote. \n\n\n\n \n\n \n\n \n\n6 CONCLUS\u00c3O \n\nEste trabalho apresentou um sistema para busca e exibi\u00e7\u00e3o de dados \ngeorreferenciados referentes \u00e0 coloniza\u00e7\u00e3o do Estado do Rio Grande do Sul no final do \ns\u00e9culo XIX. Para tanto, fez uso de diversas tecnologias diferentes interagindo entre si, \nal\u00e9m de dois componentes b\u00e1sicos: um servi\u00e7o Web de mapeamento e uma t\u00e9cnica de \nbusca de informa\u00e7\u00f5es por similaridade. \n\nA aplica\u00e7\u00e3o fez uso do Google Maps como ferramenta de visualiza\u00e7\u00e3o das regi\u00f5es \ncoloniais em um mapa. Tal servi\u00e7o oferece, de forma gratuita, uma API que permite a \ninclus\u00e3o de suas funcionalidades em qualquer p\u00e1gina Web. A partir delas, \u00e9 poss\u00edvel \noferecer ao usu\u00e1rio final uma intera\u00e7\u00e3o intuitiva com os lotes coloniais, uma vez que \nqualquer informa\u00e7\u00e3o geogr\u00e1fica pode ser representada nos mapas dispon\u00edveis. \n\nPara facilitar na pesquisa pelas informa\u00e7\u00f5es coloniais, tanto geogr\u00e1ficas quanto \nreferentes aos propriet\u00e1rios de lotes, a t\u00e9cnica apresentada em (GRAVANO, 2005) foi \nutilizada para a busca por similaridade. Tendo em vista que informa\u00e7\u00f5es hist\u00f3ricas s\u00e3o \nsuscet\u00edveis a erros tipogr\u00e1ficos e grafias alternativas para nomes de lugares e pessoas, \nfoi implementada uma solu\u00e7\u00e3o para que o usu\u00e1rio n\u00e3o tivesse que saber a grafia exata \nde um determinado dado de pesquisa. Dessa forma, pesquisas cr\u00edticas do sistema \u2013 por \nlocalidades coloniais e por propriet\u00e1rio \u2013 s\u00e3o realizadas a partir de aproxima\u00e7\u00f5es com a \ninforma\u00e7\u00e3o procurada pelo usu\u00e1rio. \n\nUma ideia interessante a ser desenvolvida em trabalhos futuros seria a possibilidade \nde a aplica\u00e7\u00e3o oferecer, aos usu\u00e1rios interessados, a oportunidade deles mesmos \ncederem informa\u00e7\u00f5es a respeito dos lotes coloniais, nos mesmos moldes apresentados \npelo Wikipedia (http://www.wikipedia.org), uma enciclop\u00e9dia livre e gratuita na Web, e \npelo pr\u00f3prio GeoNames, servi\u00e7o utilizado na solu\u00e7\u00e3o. Qualquer tipo de nova \ninforma\u00e7\u00e3o poderia ser aceito, desde dados puramente geneal\u00f3gicos sobre os \npropriet\u00e1rios at\u00e9 a inclus\u00e3o de novos lotes coloniais no mapa. Atrav\u00e9s de um registro de \nusu\u00e1rios cadastrados, seria poss\u00edvel saber a fonte dos dados, podendo ser formada at\u00e9 \nmesmo uma pseudo rede social, onde seus integrantes poderiam trocar informa\u00e7\u00f5es \nentre si, criar grupos de pesquisa, entre outras op\u00e7\u00f5es. Dessa forma, o site seria uma \nfonte ainda mais rica de dados hist\u00f3ricos. \n\n\n\n \n\n \n\n56 \n\n REFER\u00caNCIAS \n\nGOOGLE MAPS. Dispon\u00edvel em: http://maps.google.com. Acesso em: nov. 2009. \n\nBING MAPS. Dispon\u00edvel em: http://www.bing.com/maps. Acesso em: nov. 2009. \n\nYAHOO MAPS. Dispon\u00edvel em: http://maps.yahoo.com. Acesso em: nov. 2009. \n\nGEONAMES. Dispon\u00edvel em: http://www.geonames.org. Acesso em: nov. 2009. \n\nFOWLER, Martin. UML Distilled: A Brief Guide to the Standard Object Modeling \nLanguage. 3rd ed. Boston: Addison-Wesley Professional, 2005. \n\nGALLO, Alessandro; BARKOL, David; RAMA, Krishna V. ASP.NET AJAX in \nAction. 1st ed. Greenwich: Manning Publications, 2007. \n\nGRAVANO, Luis; et. al. Approximate String Joins in a Database (Almost) for Free. \nProceedings of the 27th International Conference on Very Large Data Bases. San \nFrancisco, CA, EUA. ACM 2001. p. 491-500. \n\nUKKONEN, Esko. Approximate string matching with q-grams and maximal \nmatches. Theoretical Computer Science, 92(1):191-211. 1992. \n\nULLMANN, Julian R. A binary n-gram technique for automatic correction of \nsubstitution, deletion, insertion and reversal errors in words. The Computer Journal, \n20(2):141-147. 1977."}]}}}