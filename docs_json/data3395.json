{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.08362"}, {"@name": "filename", "#text": "13196_Ana_Julia_Righetto_versao_revisada.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "University of S\u00e3o Paulo\n\u201cLuiz de Queiroz\u201d College of Agriculture\n\nThe impact of choosing different meshes under INLA/SPDE\nframework for geostatistical modelling\n\nAna Julia Righetto\n\nThesis presented to obtain the degree of Doctor in Sci-\nence. Area: Statistics and Agricultural Experimenta-\ntion\n\nPiracicaba\n2017\n\n\n\nAna Julia Righetto\nDegree in Statistics\n\nThe impact of choosing different meshes under INLA/SPDE\nframework for geostatistical modelling\nvers\u00e3o revisada de acordo com a resolu\u00e7\u00e3o CoPGr 6018 de 2011\n\nAdviser:\nProf. Dr. PAULO JUSTINIANO RIBEIRO JUNIOR\n\nThesis presented to obtain the degree of Doctor in Science.\nArea: Statistics and Agricultural Experimentation\n\nPiracicaba\n2017\n\n\n\n2\n\nDados Internacionais de Cataloga\u00e7\u00e3o na Publica\u00e7\u00e3o\nDIVIS\u00c3O DE BIBLIOTECA - DIBD/ESALQ/USP\n\nRighetto, Ana Julia\nThe impact of choosing different meshes under INLA/SPDE framework\n\nfor geostatistical modelling/ Ana Julia Righetto. \u2013 \u2013 vers\u00e3o revisada de acordo\ncom a resolu\u00e7\u00e3o CoPGr 6018 de 2011. \u2013 \u2013 Piracicaba, 2017 .\n\n95 p.\n\nTese (Doutorado) \u2013 \u2013 USP / Escola Superior de Agricultura \u201cLuiz de\nQueiroz\u201d.\n\n1. Geoestat\u00edstica 2. INLA 3. SPDE 4. Malhas . I. T\u00edtulo.\n\n\n\n3\n\nDEDICATORATION\n\nTo my parents,\nEdison Righetto and Luzia Francisca Pedrazzi Righetto, for all support and encouragement.\n\nTo my boyfriend,\nThiago Gentil Ramires for always being by my side.\n\nTo them,\nI dedicate this work.\n\n\n\n4\n\nACKNOWLEDGMENTS\n\nI have so much to thank for...\nI thank my God and \u2019Santo Expedito\u2019 for giving me faith enough to believe and reach my\n\ndreams.\nTo my parents, Edison Righetto and Luzia Francisca Pedrazzi Righetto, I have no words to\n\nthank for all the support, love and encouragement. You are examples of human beings and I am very\ngrateful to have you in my life. Having your support during all my life was fundamental. Thank you,\nThank you, Thank you! I love you very much! Shalom Eilechem!\n\nTo all my family, thank you for all cheer for this achievement. Special thanks to my grandmother\nLaura Righetto who fulfilled our agreement.\n\nTo my advisor Paulo Justiniano, thank you very much for all these years of partnership, that\nbegan during my master\u2019s degree. Thank you for all the help, guidance and support. It was an honor to\nwork under your supervision.\n\nFor my advisor in Belgium, Christel Faes, thank you for being so receptive and for having\nmagnified my work. It was a pleasure to meet you and work with you. Dank you!\n\nTo Yannick Vandendijck, who along with Christel, did not measure efforts to help me. Dank\nyou!\n\nFor all LEG/UFPR staff, who have always been helpful to me and a special thanks to Elias\nKrainski, who helped me in defining the theme of my PhD and was always very attentive.\n\nTo my boyfriend, Thiago Gentil Ramires, my life partner and academic. Thank you for all the\nencouragement and for always be there. \u2019Meu Fifu\u2019!\n\nTo my friends Rodrigo Pescim, Luiz Ricardo Nakamura, Mariana Ragassi, Everton Batista,\nPedro Henrique Cerqueira, Camila Cerqueira, Taciana Savian, Heber Alvarenga, Antonia Alvarenga,\nLuc\u00e9lia Borgo, Fl\u00e1vio Rabelo, D\u00e9bora Robert de Godoi, Ezequiel Lopez, Everton Hanser, Lucas Cunha,\nGuilherme Biz, C\u00e1ssio Dessotti, Alexandre Lavorenti, Djair Frade, Natalie Veronika, Maria Joseane,\nThiago Oliveira, thank you for the friendship, for all the help and for making postgraduate life less\nstressful.\n\nTo my friends since always Aline, Thais, Gisele, Mar\u00edlia, Rannay, Ana Cl\u00e1udia, Leticia, Karine,\nIara, Jenifer, Ariany, Juliana, P\u00e9rola thank you for the sincere friendship and constant presence in my\nlife.\n\nA special thanks to Suelen Monteiro, who closely followed all the development of my doctorate\nand has always been a friendly shoulder even with all physical distance between us.\n\nTo my friends Amanda Ferro, Vanessa Sehaber, Daniel Grados, Paula Carvalho, Elizabeth\nHashimoto, Mariele Queiroz, Fabiana Watanabe, Gabriel Batalini, Tatiana David, Karina Loureiro,\nLysandra Fernandes, thank you for all the talk and distraction.\n\nTo the Xibiu family, Rafael Jacomini, Pedro Lian, Andre Sanches, Henrique Gioia, Karina\nFerracioli, T\u00e2mara Zago, Ana Paula Teles, Fernanda Galende, Augusto Seabra, Gustavo Giachini, thank\nyou for all the barbecues and conversations. We are all Xanxi!\n\nTo my friends from Belgium, Shah Rukh Sajid (my panda friend), Svitlana, Gilani, Tooba,\nAmena, Sarmad, Shahram, Farhan, Muhammad Shaker, Stefani (Peffi Wie), thank you for helping me\nto have a more pleasure life during my stay in Belgium. My Belgium gift for all my life.\n\nTo all professor from the Department of Exact Science at ESALQ/USP, Prof. Dr. Roseli\nAparecida Leandro, Prof. Dr. Taciana Villela Savian, Prof. Dr. Carlos Tadeu, Prof. Dr. Gabriel Adri\u00e1n\nSarri\u00e9s, Prof. Dr. Silvio Sandoval Zocchi, Prof. Dr. Sonia Maria De Stefano Piedade, Prof. Dr. Cristian\nMarcelo Villegas Lobos, Prof. Dr. Idemauro Antonio, Prof. Dr. Renata Alcarde, Prof. Dr. Edwin\n\n\n\n5\n\nMoises Marcos Ortega, for all the support, teaching, wisdom and dedication in those years and a special\nthanks to Profa. Dr. Clarice Dem\u00e9trio, who played a key role in my trip to Belgium.\n\nTo all colleagues in the department, specially Fernando Mayer, Renan Pinto, Maria Cristina,\nRicardo Klein, Reginaldo Hil\u00e1rio e Andreia Hil\u00e1rio, thank you for the friendship and for all the knowledge\nexchanged.\n\nTo the staff of the Department of Exact Science at ESALQ/USP, the secretary Luciane Braj\u00e3o,\nand the computer technicians Eduardo Bonilha and Jorge Wiendl. Thank you for all the help. A special\nthanks to secretary Solange Sabadin. Thank you, S\u00f4, for all the help. You are very special to me.\n\nTo Geert Molenberghs, Martine Machiels, Marc Thoelen, Chantal Brodie, Kevin Watjou and\nMaren Vranckx, for all the help during my stay in Belgium.\n\nTo Nani (in memmoriam), Rebeca, Lilica, Negao and Pingo. My four legged hairy, thank you\nfor your loyalty and for helping me lead a lighter life.\n\nTo GCAA (\u2019Grupo de Controle de Animais Abandonados no Campus\u2019), thank you for having\nbeen my therapy in Piracicaba since 2014. I hope that all dogs find a home.\n\nTo CAPES and CNPq, for financial support.\nAnd finally, a special thanks to myself for never giving up!\n\n\n\n6\n\nCONTENTS\n\nResumo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7\nAbstract . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8\n1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9\nReferences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11\n2 On the choice of the mesh for the analysis of geostatistical data using R-INLA . . . . . . . . . . 13\n\n2.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n2.2 INLA and SPDE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14\n\n2.2.1 Model fitting and predictive information criteria . . . . . . . . . . . . . . . . . . . . 16\n2.3 Simulation Study . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17\n\n2.3.1 Simulation Design . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17\n2.3.2 Impact of mesh on inference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17\n2.3.3 Selecting the best mesh . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n\n2.4 Data Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24\n2.5 Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26\n\nReferences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27\n3 A simulation study with different meshes for geostatistical data with random, cluster and regular\n\ngrids. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29\n3.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29\n3.2 Methodology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n\n3.2.1 Goodness of fit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31\n3.3 Simulation Study . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32\n\n3.3.1 Simulation Design . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32\n3.4 Data Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49\n3.5 Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54\n\nReferences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54\n4 Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57\nAPPENDICES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59\n\n\n\n7\n\nRESUMO\n\nO impacto na escolha de diferentes malhas em modelagem geoestat\u00edstica sob a abordagem\nINLA/SPDE\n\nM\u00e9todos de estat\u00edstica espacial s\u00e3o amplamente utilizados, uma vez que v\u00e1rias \u00e1reas do\nconhecimento, como ci\u00eancias ambientais, geologia, agronomia, entre outros, envolvem a compreens\u00e3o\nda distribui\u00e7\u00e3o espacial de processos a partir de dados referenciados espacialmente. Com o avan\u00e7o dos\nSistemas de Informa\u00e7\u00e3o Geogr\u00e1fica e dos Sistemas de Posicionamento Global, esse uso foi ampliado.\nMuitos m\u00e9todos utilizados na estat\u00edstica espacial s\u00e3o computacionalmente exigentes e, portanto, o\ndesenvolvimento de m\u00e9todos mais eficientes recebeu muita aten\u00e7\u00e3o nos \u00faltimos anos. Um desenvolvi-\nmento importante foi a introdu\u00e7\u00e3o do m\u00e9todo de aproxima\u00e7\u00e3o de Laplace aninhado integrado, capaz\nde realizar an\u00e1lises Bayesianas de forma mais eficiente. O uso deste m\u00e9todo para dados geoestat\u00edsti-\ncos \u00e9 comumente feito considerando a abordagem de equa\u00e7\u00f5es diferenciais parciais estoc\u00e1sticas que\nrequer a cria\u00e7\u00e3o de uma malha que cobre a \u00e1rea de estudo. Este \u00e9 o primeiro e um importante passo,\npois todos os resultados depender\u00e3o da escolha desta malha. Como n\u00e3o existe uma maneira formal\ne direta de especificar a malha, investigamos poss\u00edveis diretrizes sobre como uma malha adequada \u00e9\nescolhida para um problema espec\u00edfico. Atrav\u00e9s de estudos de simula\u00e7\u00f5es, tentamos criar diretrizes\npara a constru\u00e7\u00e3o da malha para conjunto de dados aleat\u00f3rios, regulares e de cluster e aplicamos\nessas diretrizes em conjunto de dados reais.\n\nPalavras-chave: Geoestat\u00edstica; INLA; SPDE; Malhas\n\n\n\n8\n\nABSTRACT\n\nThe impact of choosing different meshes under INLA/SPDE framework for geostatistical modelling\n\nSpatial statistics methods are widely used since several areas of knowledge such as en-\nvironmental sciences, geology, agronomy, among others, involve the understanding of the spatial\ndistribution of processes from spatially referenced data. With the advancement of Geographic In-\nformation Systems and the Global Positioning Systems this use has been extended. Many methods\nused in spatial statistics are computationally demanding, and therefore, the development of more\ncomputationally efficient methods has received a lot of attention in recent years. One such important\ndevelopment is the introduction of the integrated nested Laplace approximation method which is able\nto carry out Bayesian analysis in a more efficient way. The use of this method for geostatistical data\nis commonly done considering the stochastic partial differential equation approach that requires the\ncreation of a mesh overlying the study area. This is the first and an important step since all results\nwill depend on the choice of this mesh. As there is no formal and close way to specify the mesh,\nwe investigate possible guidelines on how a suitable mesh is chosen for a specific problem. Through\nsimulations studies, we tried to create guidelines for the construction of the mesh for random, regular\nand cluster data set and we aplly this guidelines in real data set.\n\nKeywords: Geostatistics; INLA; SPDE; Meshes\n\n\n\n9\n\n1 INTRODUCTION\n\nThe understanding of the spatial distribution of data from phenomena occurring in space is a\nmajor challenge to clarify key issues in various areas of knowledge, such as health, environment, geology,\nagronomy, among many other areas. Such studies are becoming increasingly common, due to advances\nin Geographic Information Systems (GIS) and Global Positioning Systems (GPS), which are related to\nspatial information systems, as well as advances in computational procedures that enable and facilitate\nthe analysis or representation of space and phenomena that occur in it. Thus, there is growing interest\nin analyzing and fit models to georeferenced data.\n\nSpatial statistics methods are intended to measure properties and relationships, taking into\naccount the spatial location of the studied phenomenon. This area of statistics is didactically divided\ninto three sub-areas: geostatistics (point referenced data), area data (area referenced data) and poit\nprocess. Different statistical methods are used to analyze and describe the data for each of these sub-\nareas. This work will emphasizes the sub-area of geostatistics, which incorporates the interpretation of\nthe statistical distribution and the spatial correlation of the samples. According to Matheron (1963),\ngeostatistics is the application of the formalism of random functions for the recognition and estimation\nof natural phenomena.\n\nIn geostatistical analysis, the data consist of measurements y1,..,yn obtained in locations s1,..,\nsn sampled from a spatially continuous region A ? Rd. These measurements are associated to a spatial\nphenomenon, treated as the realization of a stochastic process X(s), s ? Rd which is not directly observed,\ngiven by any set of random variables Y (s), s ? Rd, defined in a common probability space.\n\nConsidering a latend Gaussian random field X(s) over the study region A, it is necessary to\nperform a sampling, in n locations, to obtain values of the variable of interest, Y(s) of dimension n, from\nthe values observed in the sampled locations s = (s1, .., sn). The basic model is given by\n\nY (s) = \u00b5 + X(s) + ?, (1.1)\n\nin which ? is the white noise, \u00b5 = D?, where D is a matrix of covariates and ? is a q-dimensional vector\nof parameters and X(s) is a Gaussian random field, with vector of null mean and covariance matrix ?\ntaking into account some correlation function.\n\nWith geostatistical techniques it is possible to describe the spatial dependence structure of\nthe data, establishing a spatial correlation function that depends only on the distance of the position\nof the samples and represents the behavior of the spatial variability of the data, using a model. In\norder to analyze the spatial dependence of a random variable, the geostatistical model is based on the\ncovariance or semivariance function and, according to Mello et al. (2005), these functions are important\nfor the definition of the spatial variability structure and the interpolation of values by kriging, obtaining\nminimal errors in the interpolation and enabling the construction of thematic maps. The covariances\nare functions of the distance between observations and usual models for the covariance functions are the\nspherical, exponencial, gaussian, Mate?rn, among others.\n\nThe log-likelihoog for the model (1) is given by\n\nL(?) = ?\n1\n\n2\n(nlog(2?) + log(|?|) + (y ? \u00b5)\n\n?\n??1(y ? \u00b5)).\n\nThe computations that involves the covariance matrix is costly as it depends on the covariance function,\nwhich depends on the distances of the locations. This cost also appears on the predictions, so it is\nnecessary to choose wisely the covariance function.\n\nAccording to Bolin and Lindgren (2013), traditional methods in spatial statistics were typically\ndeveloped without any consideration of computational efficiency and, in many applications, the cost of\ntaking measurements limits the sample size in which the required computational cost is not a problem.\n\n\n\n10\n\nHowever, with the increasing use of GIS and GPS, which produce large data sets, computational efficiency\nis of the utmost importance.\n\nSomethimes the inference, as is usually done in the classical approach, may present problems\nespecially in the estimation of variance components, since the inference process is based on the asymptotic\ndistribution of the maximum likelihood estimators. As a solution to this, it is common to propose the use\nof the Bayesian approach, which allows the updating of information. However the Bayesian approach still\nrequires the demanding computations related to the covariance matrix in the likelihood and specification\nof more realistic priori in order to make the model identifiable. In recent years, a new method has been\nproposed by Rue, Martino and Chopin (2009), called Integrated Nested Laplace Approximation (INLA),\nwhich is a computationally effective alternative to methods based on Markov Chain Monte Carlo (MCMC)\nalgorithms.\n\nAccording to Lindgren and Rue (2015), INLA is designed for latent Gaussian models, a very\nbroad and flexible class of models, ranging from a mixed (generalized) linear model to spatial and\ntemporal-spatial models. In the spatial setup it can be combined with the approach of Stochastic Partial\nDifferential Equation (SPDE) (Lindgren, Rue and Lindstrom, 2011), one can accommodate georeferenced\ndata from all sub-areas of spatial statistics.\n\nA Gaussian field (GF) is is the key component in geostatistical modeling and it is important\nwhen specifying hierarchical spatial models. According to Lindgren, Rue and Lindstrom (2011), the\ncovariance function specification of an intuitive interpretation of the field properties, as regards compu-\ntational efficiency, impairs the GF because the cost of factoring dense matrices is cubic in dimension.\nWhen a GF satisfies the Markov property (conditional independence), it will be considered a Gaussian\nMarkov random field (GMRF).\n\nConsider the graph G = (V, E), in which V = {1, ..., n} and E is defined by xi?xj|x?i,j, meaning\nthat there is no edge between the knots i and j. Rue and Held (2005) define a GMRF as a random vector\nx = (x1, ..., xn)\n\n?\n? Rn which follows a multivariate normal distribution and satisfies the Markov property.\n\nAlso, the GMRF, with mean vector \u00b5 and precision matrix Q > 0, in which Q = ??1, will be with\nrespect to the graph G = (V, E), with the condition that Qij ?= 0 ? i, j ? E for all i ?= j and that its\ndensity will be:\n\n?(x) = (2?)\n? n\n\n2 |Q|\n1\n2 exp\n\n(\n?\n1\n\n2\n(x ? \u00b5)\n\n?\nQ(x ? \u00b5)\n\n)\n. (1.2)\n\nAccording to Lindgren, Rue and Lindstrom (2011), GMRF is a discretly indexed Gaussian field\nin which the complete conditionals of ?(xi|x?i), which x?i represents all elements of x except the ith,\ndepend only on a set of neighbors ?i for each place i, i = 1, ..., n and this generates a computational gain\ndue to the zero standard in the precision matrix Q. The GMRF is widely used in hierarchical models\nbecause it allows stochastic dependence among a set of unknown parameters. This hierarchy is done in\nthree steps, in which the unknown hyperparameters ? specify a GMRF. In this way, x is connected to\nthe data y and it is usually assumed that y is conditionally independent of x. Considering a simple case,\neach yi depends only on xi and, in this way, the two vectors have the same dimension. The three steps\nof the hierarchy are given by:\n\n? ? ?(?) (1.3)\n\nx ? ?(x|?)\n\nyi ? ?(yi|xi),\n\nthus, a posteriori distribution is given by ?(x, ?|y) ? ?(?)?(x|?)\n?n\n\ni=1 ?(yi|xi).\n\n\n\n11\n\nEmpirically, Rue and Tjelmeland (2002) have demonstrated that it can be found a GMRF\nwhich can approximate a GF for most of the common covariance functions used in geostatistical analysis\nand have proposed using GMRF instead of GF precisely because of computational issues. This proposal\nhas shown problems since the adjustment of GMRF to GF was restricted to the regular grid. In this way,\nthis approach implies some restrictions because, according to Lindgren, Rue and Lindstrom (2011), the\nmodeling must be done with a GF in a set of locations {si} and one must construct a GF with matrix of\ncovariance ? of which there is a GMRF with local neighborhood and precision matrix Q, such that Q?1\n\nis close to ? and computations should be performed with the GMRF by numerical methods for sparse\nmatrices.\n\nFollowing the requirements from the proposal of Rue and Tjelmeland (2002), Lindgren, Rue and\nLindstrom (2011) have demonstrated that these it can be satisfied for some GF members when using the\nMate?rn covariance function, where the GMRF representation is explicit. The GMRF construct can be\ndone using a certain SPDE that has GF with Mate?rn covariance function as the solution when triggered\nby a Gaussian white noise. The result is given by a basic function representation with parts-based linear\nfunctions and Gaussian weights with Markov dependencies determined by general domain triangulation.\nThis triangulation is called mesh.\n\nCurrently, the INLA method has received considerable importance due to its precision and\ncomputational speed. When used in conjunction with SPDE for geostatistical models, it is necessary to\ngenerate a mesh, formed by junctions of triangles, under the study region and, in addition, the precision\nof the parameter estimates, as well as the prediction of the final model, will depend on this mesh. A set\nof attributed needs to be carefully chosen on order to create a suitable mesh: set values for the edges\nof the triangles inside the mesh (which encompasses the study region), for the edges of the outer mesh\n(outside the study region, to avoid edge effect) and for the smallest permitted distance between the edge\njunctions (knots). Each change in these values implies more or less knots in the mesh, which implies\nmore or less computational burden.\n\nIn this work we named by a the maximal allowed lengths of triangle edges in the inner domain,\nby b the maximal allowed lengths of triangle edges in the outter domain and by c the shortest distance\nallowed between points. Different combinations of this three values, generate different meshes, as we\ncan see in Figure 1.1. where meshes were generate with b = 0.03 and with a = (0.02, 0.08, 0.14) and\nc = (0.002, 0.03) As we increase the value of a and c, we get meshes with less triangle and different mesh\ngives different results in the analysis.\n\nBolin and Lindstro?m (2014), raise concerns about the importance of using the appropriate mesh\nand how a simple change in the mesh can affect the result of the analysis. Then, following up on these\nissues, the main objective here is to try to find a way to create the more suitable mesh for different types\nof georeferenced data (regular grid, irregular grid or data with clusters), through a simulation study.\n\nIn this context, in Chapter 2 we reports results of a simulation study, for random data with\ndifferent sample sizes, to investigate the most appropriate mesh, in which the meshes were generated\ntaking into account the sample locations and changing some parameters for the creation. In Chapter 3,\nwe fixed the sample size and focus on different types of data, being them regular, irregular and cluster\ndata. For each type of data, were considered different parameter values to generate the meshes as well\nas different ways to define the knots. Chapter 4 shows an overall conclusion.\n\nReferences\n\nBolin, D.; Lindgren, F. A comparison between Markov approximations and other methods for large\nspatial data sets. Computational Statistics &amp; Data Analysis, v. 61, p. 7-21, 2013.\n\n\n\n12\n\n(I) (II)\n\n(III) (VI)\n\nFigure 1.1. Generate meshes with b = 0.03 different values of (a, c) given by I) (0.02, 0.002),\nII)(0.08, 0.002), III) (0.08, 0.03) and IV) (0.14, 0.03).\n\nBolin, D. Lindstrom, J. Spatial Statistics using R-INLA and Gaussian Markov random fields. Pan-\nAmerican Advanced Study Institute, 15:29:57Z, rev.3691, 2014.\n\nLindgren, F.; Rue, H. Bayesian Spatial Modelling with R-INLA. Journal of Statistical Software, v.\n63, 2015.\n\nLindgren, F.; Rue, H.; Lindstrom, J. An explicit link between Gaussian fields and Gaussian Markov\nrandom fields: the stochastic partial differential equation approach. Journal of the Royal Statistical\nSociety, v. 73, p. 423-498, 2011.\n\nMatheron, G. Principles of geostatistics. Economic Geology, Austin, v. 58, p. 1246-1266, 1963.\n\nMello, J. M.; Batista, J. L. F.; Ribeiro Jr, P. J.; Oliveira, M. S. Ajuste e sele\u00e7\u00e3o de modelos espaciais\nde semivariograma visando \u00e0 estimativa volum\u00e9trica de Eucalyptus grandis. Scientia Florestalis,\nPiracicaba, v.1, n. 69, p. 25-37, 2005.\n\nRue, H.; Martino, S.; Chopin, N. Appriximate Bayesian inference for latent Gaussian models by using\nintegrated nested Laplace aproximations (with discussion). Journal of the Royal Statistical Society\n- Series B, v.71, Part 2, p.319-392, 2009.\n\nRue, H.; Tjelmeland, H. Fitting Gaussian Markov random fields to Gaussian fields. Scand. J. Statist,\nv. 29, p. 31-50, 2002.\n\n\n\n13\n\n2 ON THE CHOICE OF THE MESH FOR THE ANALYSIS OF GEOSTATISTICAL\nDATA USING R-INLA\n\nAbstract: Spatial statistics are useful to measure properties and relationships of a ge-\nographically studied phenomenon. Many methods used in spatial statistics are computationally\ndemanding, and therefore, the development of more computationally efficient methods has received\na lot of attention in recent years. One such important development is the introduction of the inte-\ngrated nested Laplace approximation method which is able to carry out Bayesian analysis in a more\nefficient way. The use of this method for geostatistical data is commonly done considering the SPDE\napproach that requires the creation of a mesh overlying the study area. This is an important step in\nthe analysis since the obtained results depend on the choice of this mesh. Here, the impact of the\nmesh on inference and prediction is investigated through simulation studies. As there is no formal\nprocedure to specify the mesh, we investigate possible guidelines on how an optimal mesh is chosen.\nThrough a simulation study, with random data set, different meshes were created, considering the\nsample locations as starting point for the knots of the mesh. An application using rainfall data in\nParana? state, Brazil, is presented.\nKeywords: Geostatistics; Integrated nested Laplace approximation; Mesh; Stochastic partial differ-\nential equation.\n\n2.1 Introduction\n\nModels in spatial statistics are used to measure properties and relationships of a geographi-\ncally measured outcome, explicitly taking into account the spatial locations of the studied phenomenon.\nTraditional methods in spatial statistics were developed without the consideration of computational ef-\nficiency, as in many applications the sample size was limited due to the cost involved in obtaining the\nmeasurements (Bolin and Lindgren, 2013). Nowadays, however, with the increasing use of geographic\ninformation systems and global positioning systems, large data sets are becoming available, and compu-\ntational efficiency has become extremely important.\n\nGeostatistical data are widely analyzed using the kriging method, an optimal interpolation\nmethod employing the spatial autocorrelation to derive predictions at unmeasured locations (Gelfand et\nal., 2010). A popular choice to estimate the statistical dependence is the Mate?rn family of covariance\nfunctions, which includes, for example, the exponential and Gaussian covariance functions, as particular\ncases. For inference, it is common to use the Bayesian framework, which is based on the observed data\nonly and easily allows for sequential updating of information. Sampling methods such as Markov Chain\nMonte Carlo (MCMC) are well known in Bayesian inference, but demand intense computation time.\n\nAs an alternative to the computational intensive MCMC methods, Rue, Martino and Chopin\n(2009) proposed the use of integrated nested Laplace approximations (INLA). INLA is an approximate\nmethod designed for inference of latent Gaussian models, a very wide and flexible class of models ranging\nfrom (generalized) linear mixed model to spatial and spatio-temporal models (Lindgren and Rue, 2015).\nWhen combined with stochastic partial differential equation (SPDE) (Lindgren, Rue and Lindstrom,\n2011), it can accommodate georeferenced data from all sub-areas of spatial statistics (geostatistics, lattice\ndata and point processes). Recently, INLA has received considerable attention due to its accuracy and\ncomputational speed (Karagiannis et al., 2013; Lindgren, 2012).\n\nThe SPDE approach approximates the Gaussian field using a Gaussian Markov random field.\nFor geostatistical data, the spatial field is described using a weighted sum of piece-wise linear basis function\nthat is ussually defined from a triangularisation of the study area, called the mesh. The accuracy of the\nestimates as well as the predictions will depend on the mesh specification. The idea is that smaller\n\n\n\n14\n\ntriangles will increase the accuracy, though when the spatial range is larger, larger triangles can be used.\nThe mesh can be constructed using different principles. A common method, using R-INLA, is to use the\nlocations of the measurements as initial triangulation vertices, and add or remove knots according to the\nsize for the edges of the triangles of the inside mesh (which includes the study region), for the edges of the\nouter mesh (outside the study area, to avoid border effects) and to the shortest distance allowed between\nthe junctions of the edges (knots). Each combination of these three values implies a certain number of\nknots on the mesh, and more knots can increase in the computational cost. While it has been indicated\nthat the choice of the mesh must be done carefully (Lindgren and Rue, 2015), no conclusive way to create\nthe best mesh has been described.\n\nAs the analysis depends on the chosen mesh, the objective of this work is to extensively study\nthe parameters for the creation of the mesh, to see their impact on the analysis and set guidelines to\nconstruct the optimal mesh in two dimensional spatial domains, for irregular geostatistical data, solving\nsome issues raised by Bolin and Lindstrom (2014). In Section 2.2 , we give a brief introduction to INLA\nand the SPDE approach and discuss some criteria to evaluate the mesh. A simulation study is performed\nin Section 2.3 and an application with real data set is provided in Section 2.4. A discussion is provided\nin Section 2.5.\n\n2.2 INLA and SPDE\n\nINLA is a deterministic method to perform Bayesian inference of latent Gaussian models,\navoiding computational intensive Markov chain Monte Carlo simulations (Rue, Martino and Chopin,\n2009). The method is designed for a large class of Gaussian Markov random fields (GMRF), including\nmany of the hierarchical models with latent Gaussian processes. If y represents the data, x the GMRF\nand ? the vector of hyperparameters, the idea of INLA is to approximate the posterior density ?(?|y)\nvia Gaussian approximation of the posterior of the latent field ?(x|?, y) and a Laplace approximation in\nthe latent field marginal posterior calculations. Details can be found in Rue, Martino and Chopin (2009).\n\nLindgren, Rue and Lindstrom (2011) showed that the use of INLA is not restricted to discrete\nspatial domains, given there is a connection between continuous domains and Markov models. Indeed,\na large class of random field models can be expressed as a solution of a continuous domains stochastic\npartial differential equation (SPDE). Whittle (1954) showed that the Mate?rn covariance function can be\nseen as a solution of the SPDE. This connection allows one to carry out the calculations for a continuous\nrandom field using the (discrete) GMRF representation. This is done by approximating the spatial field\nas a basis function representation:\n\nx(s) =\nK?\n\nk=1\n\n?k(s)xk, (2.1)\n\nwhere ?k(s) are piece-wise linear basis function defined on a triangulation of the study domain and\n{x1, ..., xK} are Gaussian weights chosen to approximate the solutions to the SPDE on the domain. The\ntriangulation consists in subdividing the study area into a set of non-intersecting triangles (Cameletti et\nal., 2012), with linear basis function defined with barycentric interpolation. This SPDE/GMRF analysis\nis available in the R-package INLA (Rue, Martino and Chopin, 2009).\n\nThe first step of the analysis is the construction of a triangulated mesh on which the SPDE/GMRF\nrepresentation is built (Lindgren, 2012). As an initial step, we can choose to place the triangle vertices at\nthe locations where measurements were taken, and after that, add or remove additional vertices, creating\nthe triangulation for the analysis. As the solution may present a border effect, it is necessary to extend\nthe mesh also outside the study area to avoid it. According to Lindgren (2012), the effect in constructing\ntriangles is that we can obtain small ones (and so obtain high accuracy to represent the field) where the\n\n\n\n15\n\nlocations are dense, and bigger ones when the locations are sparse. As the analysis depends on the mesh,\nit is very important to create a mesh suited for the data at hand.\n\nIn the R-INLA implementation, the function inla.mesh.2d() is available to create the mesh.\nSeveral parameters in this function can be chosen as to construct a mesh for the problem at hand, e.g.\nthe max.edge parameters define the maximal allowed lengths of triangle edges in the inner domain and\nin the outer extension, the cutoff parameter corresponds with the shortest distance allowed between\npoints (Krainski and Lindgren, 2014; Krainski and Rue, 2013). A change in one of these values, will\ncreate a different mesh, making it more or less dense (with more or less knots).\n\nWe will work with the above three arguments for building the convex mesh: the maximal\nallowed edge length in the inner domain (a) and outer domain (b), and the shortest allowed distance\nbetween points (c). We will always consider larger values of the maximal allowed edge length for the\nouter domain as for the inner domain (b > a), as the outer domain is needed only to avoid border effects.\n\n(I) (IV)\n\n(II) (V)\n\n(III) (VI)\n\nFigure 2.1. Example of meshes with b = 0.40 and (a, c) given by (I) (0.03, 0.001), (II) (0.07, 0.001),\n(III) (0.11, 0.001), (IV) (0.07, 0.01), (V) (0.07, 0.03), (VI) (0.07, 0.06)\n\nFor exploratory reasons, we ilustrated how the choice of these parameters determine the aspect\nof the mesh in Figure 2.1. We consider 100 randomly generated locations of a spatial process on the unit\nsquare. Starting with these locations as initial vertices of the triangulation, we create different meshes,\ndepending on the parameters a, b and c. In the left panel, we fix the maximal allowed edge length\n(b = 0.4) and shortest distance allowed between points (c = 0.001), but change the value of the maximal\nallowed edge length in the inner domain (a = (0.03, 0.07, 0.11)). By increasing the maximal allowed edge\nlength, the triangulation becomes less dense, with the number of vertices decreasing from 3701 to 890\nand 633, respectively. The right panel in Figure 2.1 shows the impact of increasing the minimal allowed\ndistance between vertices (c = 0.01, 0.03, 0.06). The edge length for the inner and outer domain was kept\nfix (a = 0.07, b = 0.4). While changing c from 0.001 (panel II) to 0.01 (panel IV) has only little impact, a\nfurther increase of c has a bigger one, changing the number of vertices to 859, 753 and 266, respectively.\n\n\n\n16\n\nBy increasing the value of c, less clustered vertices are observed, making the mesh more regular over the\nwhole domain. Even a small change in one parameter to construct the mesh can generate a complete\ndifferent mesh and the results will be affected. Then, the focus of this survey is to investigate the impact\nof the mesh in the analysis.\n\n2.2.1 Model fitting and predictive information criteria\n\nTo evaluate and compare the performance of different meshes, different predictive information\ncriteria can be used. Three information criteria are considered in this study: the deviance information\ncriterion (DIC), the Watanabe-Akaike information criterion (WAIC) and the conditional predictive ordi-\nnate (CPO). In Section 2.3, we investigate the performance of these criteria to perform mesh selection.\nThese criteria are briefly explained below.\n\nThe deviance information criterion, described by Spiegelhalter et al. (2000), is defined as\n\nDIC = ?2 log p(y|??) + 2pDIC,\n\nwhere 2 log p(y|??) is the posterior expected deviance measuring the suitability of the model and pDIC\nthe estimated effective number of parameters of the model, representing the complexity of the model. In\nthis way, DIC takes into consideration both the suitability and complexity of the model.\n\nProposed by Watanabe (2010), WAIC can be viewed as an improvement on the DIC for Bayesian\nmodels (Vehtari and Gelman, 2014) and is given by\n\nWAIC = ?2 log\n?\n\np(y|?)?(?|y)d? +\nn?\n\ni=1\n\nV ar (log(p(yi|?))) .\n\nSimilar as with DIC, the first term measures the predictive performance, and the second term penalizes\nfor model complexity. Compared to DIC, WAIC averages p(y|?) over the posterior distribution of ?,\nwhereas DIC conditions on the point estimate of ?. The complexity term is a sum of the variance for\neach data point separately, yielding more stable results as DIC (Gelman, Hwang and Vehtari, 2014).\n\nThe conditional predictive ordinate is a cross-validation method, estimating the leave-one-out\npredictive distribution (Geisser and Eddy, 1979). The posterior predictive distribution for an observation\ni can be expressed as\n\np(yi|y?i) =\n?\n\np(yi|?)?(?|y?i)d?,\n\nwhere yi is the ith observation of y and y?i is y without observation i. So the CPO is the probability a\nposteriori to observe yi when the model is adjusted without yi. A bigger value of CPO indicates a better\nadjustment. Instead of having to refit the model each time, an approximation of CPO can be obtained\nby sampling from the posterior distribution:\n\nCPOi =\n1\n\nT ?1\n?T\n\nt=1 p(yi|?t)?1\n,\n\nwhere ?t is a sample from ?(?|yi) and T indicated the number of posterior samples. This is the inverse\nof the posterior mean of the inverses of the likelihood. This is an efficient method, but requires care since\nnumerical problems in the calculations can occur (Held, Schrodle and Rue, 2010). However, when using\nINLA it is possible to verify if numerical problems did occur and recompute the CPO using a less efficient\nmethod (re-fitting the model for every observation).\n\nIn this work we used a summary by calculating the log-score, given by\n\nlog CPO = ? 1\nn\n\n?n\ni=1 log(p(yi|y?i)).\n\nThis log-score is an estimator of the log marginal likelihood function and smaller values indicate better\nmodel performance. In contrast to DIC and WAIC, the log CPO score does not adjust for the complexity\nof the model.\n\n\n\n17\n\n2.3 Simulation Study\n\nIn this section, we first describe the simulation design, after which results are discussed. The\nfirst goal of the simulation study is to investigate the impact of the choice of the mesh on the inference\n(parameter estimation and prediction). The second goal is to investigate how we can select an optimal\nmesh for a particular data problem at hand.\n\n2.3.1 Simulation Design\n\nA simulation study, with 200 simulation runs, was set up to compare different meshes. Different\nsimulation scenarios are considered. Spatial geostatistical processes with sample sizes of n = 300, 100 and\n50 are generated. Observed locations are randomly generated on the unit square. A response vector y is\ngenerated according to the model y = ?0 + ?1x + s + e, where x is a uniformly distributed covariate, s is\na Mate?rn spatial random field with correlaton function given by M(h|k, ?) = 1\n\n2k?1?(k)\n(?||h||)kKk(?||h||)\n\nand e is white noise. Parameters are fixed to ?0 = 1, ?1 = 2. The spatial variability of the Mate?rn spatial\nrandom field is set to ?2s = 0.7 and Gaussian white noise variability to ?2e = 0.3. The nominal range of the\nspatial random field is specified as ?? =\n\n?\n8(?? d\n\n2\n)\n\nk\n= 0.20, by setting the smooth parameter k = 10, the\n\nfractional operator order ? = 1.5 and d = 2, as the study region A ? Rd. Note that the choice of ? = 1.5\nin the Mate?rn spatial random field corresponds to an exponential random field (Gelfand et al., 2010). For\nthe prior, we used the log-gamma distribution with parameters c(1.0,0.00005). To prevent effects caused\nby a single choice of coordinates, we conduct the simulation in five batches of 40 simulations and within\none batch the coordinates are kept fixed.\n\nTo investigate the impact of meshes, different meshes are constructed for the generated pro-\ncesses. The initial triangulation taken is given by the locations of the generated process. Note that, as we\nkeep the coordinates fixed within batches, also the meshes will remain the same within a batch. Different\nmeshes are considered by allowing the max.edge=(a,b) and cutoff=c parameters to change. The set of\nvalues considered for the maximal allowed edge length in the inner domain is a = (0.05, 0.09, 0.13, 0.17, 0.19, 0.20),\nfor the maximal edge length in the outer domain is b = (0.4, 0.3, 0.2) and for the shortest allowed distance\nbetween two points is c = (0.001, 0.005, 0.01, 0.03, 0.05, 0.07, 0.10, 0.13). Combinations of these three val-\nues leads to a total of 144 different meshes. These values were chosen such that the value of a is smaller\nor equal to the range ??, and the value of b, controlling the outer boundaries to avoid boundary effects,\nshould be larger than a. The results are shown for b = 0.3, as we notice that there is almost no impact\nfor the different values of b\n\nTable 2.1 summarizes, for the different combination of the parameters a and c, the average\nnumber of vertices (rounded to integer) in the mesh, for a sample size of n = 100 and a maximal edge\nlength in the outer domain of b = 0.3. A more dense triangulation is obtained with smaller values of both\na and c. When the cutoff parameter is large, the number of vertices in the triangulation is lower than\nthe number of observed locations. In addition, we observe that the influence of a decreases as c increases.\nResults in the next sections focus on the scenario of a sample size of n = 100. Results for n = 50 and\nn = 300 are given in the Appendix A.\n\n2.3.2 Impact of mesh on inference\n\nTo investigate the impact of the mesh on the inference, we calculated, for each mesh, the\ncoverage (based on the 95% Confidence Interval), bias and mean squared error (MSE) for each of the\nparameters in the model and for the predictions.\n\nTable 2.2 summarizes the simulation coverage for the covariance function parameters (?2e , ?2s , k\nand ??) and for ?0 and ?1, for meshes with varying maximal allowed edge length in the inner domain (a)\n\n\n\n18\n\nTable 2.1. Average number of knots for different combinations of the parameters a and c, with parameter\nb = 0.3 and sample size n = 100.\n\nc=0.001 c=0.005 c=0.01 c=0.03 c=0.05 c=0.07 c=0.10 c=0.13\na=0.05 1398 1394 1390 989 400 208 120 86\na=0.09 523 517 507 487 400 206 117 84\na=0.13 315 307 293 251 236 206 116 84\na=0.17 272 265 250 203 174 159 115 84\na=0.19 266 259 243 192 160 145 115 84\na=0.20 263 256 241 189 155 140 113 84\n\nand varying shortest allowed distance between points (c), but with fixed maximal length in the external\narea (namely, b = 0.3). Figure A.1 in the Appendix A shows the coverage for all considered meshes.\n\nTable 2.2. Coverage, in %, of the 95% credible intervals of the parameters ?0, ?1, ?2e , ?2s , k and ?? for\ndifferent meshes with b = 0.3.\n\nCoverage in % for:\nMesh c a ?0 ?1 ?2e ?\n\n2\ns k ?\n\n?\n\n1 0.001 0.05 90.50 90.00 13.50 52.50 30.00 30.00\n2 0.09 92.50 90.00 8.50 17.50 21.50 21.50\n3 0.13 93.00 90.50 6.50 9.00 19.00 19.00\n4 0.17 92.50 90.00 6.50 8.00 21.00 21.00\n5 0.19 92.50 90.50 8.00 9.00 21.50 21.50\n6 0.20 92.00 90.00 7.50 8.50 21.50 21.00\n7 0.005 0.05 88.50 85.00 17.00 56.50 34.00 34.00\n8 0.09 89.50 84.00 13.00 26.50 26.00 26.00\n9 0.13 89.50 84.00 12.00 16.00 25.50 25.50\n\n10 0.17 89.50 84.00 12.00 16.00 27.00 27.00\n11 0.19 89.00 84.50 12.00 15.00 26.50 26.50\n12 0.20 88.50 84.50 12.50 15.50 26.50 26.00\n13 0.01 0.05 92.00 86.00 36.50 70.50 52.00 52.00\n14 0.09 94.00 90.00 38.50 50.00 48.50 48.50\n15 0.13 92.50 89.50 37.50 39.50 46.50 46.50\n16 0.17 92.50 89.00 39.00 38.00 47.00 47.00\n17 0.19 92.50 89.00 37.00 37.00 48.00 48.50\n18 0.20 92.00 89.00 37.50 37.50 48.50 48.00\n19 0.03 0.05 95.50 90.00 79.00 91.00 89.50 88.50\n20 0.09 97.00 92.00 83.50 94.00 92.50 92.50\n21 0.13 98.00 92.50 81.50 94.00 91.50 92.00\n22 0.17 98.00 93.50 80.50 92.00 89.50 90.00\n23 0.19 97.50 94.00 78.00 90.50 90.00 90.50\n24 0.20 97.50 94.00 78.50 91.00 90.50 90.50\n25 0.05 0.05 97.50 91.00 83.50 96.00 91.00 91.00\n26 0.09 98.50 92.00 80.50 96.00 90.00 90.00\n27 0.13 99.50 92.50 74.00 97.50 89.50 89.50\n28 0.17 99.50 93.00 66.00 97.50 88.50 88.50\n29 0.19 99.50 93.00 67.00 96.00 88.00 88.00\n30 0.20 99.00 93.50 65.50 96.00 88.50 88.50\n31 0.07 0.05 99.00 92.50 60.50 96.00 87.00 86.50\n32 0.09 99.50 92.00 59.00 95.50 86.50 86.50\n33 0.13 99.50 92.50 59.50 95.50 86.50 86.50\n34 0.17 99.00 94.00 44.00 94.50 82.00 82.00\n35 0.19 99.00 92.50 39.50 96.00 85.00 85.00\n36 0.20 99.50 92.50 36.50 96.50 84.00 84.00\n37 0.10 0.05 99.50 93.50 20.50 93.50 83.50 83.50\n38 0.09 99.50 92.50 19.50 92.50 82.00 82.00\n39 0.13 99.50 93.50 19.00 93.50 82.50 82.50\n40 0.17 99.50 93.50 19.50 93.00 84.00 84.00\n41 0.19 99.50 93.50 19.50 92.50 85.00 85.00\n42 0.20 99.50 93.00 18.50 93.00 85.50 85.50\n43 0.13 0.05 98.50 93.50 2.50 94.50 86.00 86.00\n44 0.09 98.50 93.00 2.00 94.50 89.00 89.00\n45 0.13 98.50 93.50 3.00 94.00 89.50 90.00\n46 0.17 98.50 93.50 3.00 94.00 89.50 90.00\n47 0.19 98.50 93.00 3.00 94.00 89.50 90.50\n48 0.20 98.50 93.50 3.00 94.50 89.50 90.00\n\nIt can be observed that the largest impact on the coverage is observed for the cutoff parameter\nc. The parameters ?0 and ?1 have good coverage specially for meshes with high values of c. Increasing\nthe shortest allowed distance, improves the coverage for the parameters ?2s , k and ??, no matter much\nthe value of a. However, we also observe an undercoverage for the parameter ?2e , especially if c gets too\nsmall or too large. Overall, we can also observe that an increase of the maximal allowed edge length in\nthe inner domain (a) has a negative impact on the coverage of most parameters. These results show that,\nindeed, the choice of the mesh is very important to obtain good coverage for the covariance parameters.\nMesh 20, with a = 0.09, b = 0.3 and c = 0.03, has the best coverage of ?2e , k and ??, meshes 27 and 28\nhave the best results for ?2s and meshes with c = 0.10 have the best coverage for ?0 and ?1. So there does\n\n\n\n19\n\nnot seem to be one mesh that is outperforming all other meshes for all parameters together. Considering\nthe coverage of all parameters together, mesh 20 has the best results overall.\n\nResults given in the Appendix A with sample size of n = 50 or n = 300 are very similar.\nWhen the value of the cutoff parameter c is very small, the coverage for all covariance parameters is too\nlow. Increasing the value of c, decreases the number of knots in the mesh, but leads to better nominal\ncoverages. However, when c is too large, the coverage for ?2e drops again. The impact of changing the\nmaximal allowed length in the inner domain (a) has much less impact on the nominal coverage and\nchanging the value of b, the maximal allowed length in the outer domain, has no impact. The mesh with\nbest coverage depends on the parameter of interest and the sample size: for ?2e , mesh 29 has has a slightly\nbetter results for coverage when n = 50 and for all the others parameters, mesh 45 is outstanding when\nn = 50; when n = 300, ?2e has the best coverage for mesh 13, while for the others parameters, meshes\nwith higher values of c have better results.\n\nTable 2.3 presents the absolute bias of the estimated parameters, for all meshes with b = 0.3.\nWe observe again that the impact of the cutoff parameter is largest, compared to the impact of the\nmax.edge parameter. The bias of the estimated parameters is highest when the minimal allowed distance\nbetween points is very small. Note that when c is very small, the mesh can have a highly clustered\npattern, whereas when c is very large, the mesh has only a very limited number of knots. Decreasing the\nnumber of knots by increasing the maximal allowed edge in the inner domain, slightly decreases the bias\nwhen c is small. We can observe that for ?0 and ?1, the values of bias is really small, and quite often\nzero, for ?2e , mesh 20 has the minimal absolute bias. For the parameter ?2s , mesh 21 performs well, for k\nmeshes with c = 0.07 have the small bias and for ??, the minimum value of bias is obtained by c = 0.01.\nLooking all the parameters together, we can conclude that meshes with c = 0.03 would yield optimal\nresults in this simulation setting.\n\nTable 2.3. Absolute bias of the parameters ?0, ?1, ?2e , ?2s , k and ?? for different meshes with b = 0.3.\nBias for: Bias for:\n\nMesh c a ?0 ?1 ?2e ?\n2\ns k ?\n\n? Mesh c a ?0 ?1 ?2e ?\n2\ns k ?\n\n?\n\n1 0.001 0.05 0.00 0.03 0.26 0.27 13.92 0.08 25 0.05 0.05 0.01 0.02 0.06 0.02 0.20 0.10\n2 0.09 0.01 0.02 0.28 0.45 13.06 0.09 26 0.09 0.01 0.02 0.07 0.01 0.54 0.09\n3 0.13 0.00 0.03 0.28 0.56 11.06 0.08 27 0.13 0.01 0.02 0.10 0.03 0.62 0.11\n4 0.17 0.00 0.03 0.28 0.62 9.76 0.08 28 0.17 0.01 0.02 0.12 0.01 0.27 0.11\n5 0.19 0.00 0.03 0.28 0.63 9.22 0.08 29 0.19 0.01 0.02 0.13 0.02 0.20 0.11\n6 0.20 0.00 0.03 0.28 0.63 8.97 0.07 30 0.20 0.01 0.02 0.13 0.01 0.01 0.10\n7 0.005 0.05 0.00 0.03 0.25 0.26 13.14 0.07 31 0.07 0.05 0.01 0.02 0.15 0.01 0.51 0.13\n8 0.09 0.00 0.04 0.26 0.42 12.06 0.08 32 0.09 0.01 0.02 0.15 0.01 0.64 0.13\n9 0.13 0.00 0.04 0.26 0.52 10.07 0.07 33 0.13 0.01 0.02 0.15 0.01 0.73 0.14\n\n10 0.17 0.00 0.04 0.26 0.58 8.80 0.06 34 0.17 0.01 0.02 0.17 0.01 0.50 0.15\n11 0.19 0.00 0.04 0.26 0.59 8.49 0.06 35 0.19 0.01 0.02 0.18 0.05 0.03 0.14\n12 0.20 0.00 0.04 0.26 0.59 8.27 0.06 36 0.20 0.01 0.02 0.18 0.06 0.24 0.13\n13 0.01 0.05 0.01 0.02 0.20 0.19 9.18 0.03 37 0.10 0.05 0.01 0.02 0.23 0.28 1.73 0.13\n14 0.09 0.01 0.02 0.18 0.28 7.79 0.02 38 0.09 0.01 0.02 0.23 0.31 1.78 0.13\n15 0.13 0.00 0.03 0.19 0.37 6.79 0.02 39 0.13 0.01 0.02 0.23 0.33 1.75 0.13\n16 0.17 0.00 0.03 0.18 0.42 6.03 0.02 40 0.17 0.01 0.02 0.23 0.32 1.68 0.13\n17 0.19 0.00 0.03 0.18 0.43 5.74 0.02 41 0.19 0.01 0.02 0.23 0.32 1.65 0.13\n18 0.20 0.00 0.03 0.18 0.43 5.57 0.02 42 0.20 0.00 0.03 0.24 0.29 1.33 0.13\n19 0.03 0.05 0.01 0.02 0.05 0.02 1.94 0.05 43 0.13 0.05 0.00 0.03 0.29 0.50 2.77 0.12\n20 0.09 0.01 0.02 0.01 0.01 0.30 0.08 44 0.09 0.00 0.03 0.29 0.53 2.75 0.12\n21 0.13 0.01 0.02 0.03 0.00 0.18 0.09 45 0.13 0.00 0.03 0.30 0.43 2.16 0.12\n22 0.17 0.01 0.02 0.04 0.03 0.06 0.09 46 0.17 0.00 0.03 0.30 0.44 2.20 0.12\n23 0.19 0.01 0.02 0.04 0.04 0.10 0.09 47 0.19 0.00 0.03 0.30 0.45 2.22 0.12\n24 0.20 0.01 0.02 0.04 0.04 0.10 0.08 48 0.20 0.00 0.03 0.30 0.44 2.24 0.12\n\nThe mean square error (MSE) was calculated for each parameter and results are presented in\nTable A.1 in the Appendix A. As we can notice, the value of MSE is high for k in all meshes, especially\nfor meshes with small values of c and a. For ?0 almost all meshes have the same results and for ?1 meshes\nwith c = 0.07 and c = 0.10 the results are the same and with the minimum value. For ?2e the best results\nfor MSE occur for c = 0.03 and for ?2s and k small values for MSE occur for mesh 21, and for ?? meshes\n4 and 5 have the minimum value for MSE. Similar results are observed when n = 50 and n = 300.\n\nFinally, we also investigated the impact of the mesh on the predictive performance of the model.\nFor each mesh, the coverage and the mean square error (MSE) of the predictions in the sampled locations\n\n\n\n20\n\nTable 2.4. Nominal coverage, in %, and MSE for the variable Y calculated for each mesh with b = 0.3,\nconsidering 200 simulations.\n\nMesh c a Coverage(%) MSE Mesh c a Coverage(%) MSE\n1 0.001 0.05 18.75 0.28 25 0.05 0.05 90.97 0.21\n2 0.09 13.11 0.29 26 0.09 90.79 0.21\n3 0.13 11.41 0.29 27 0.13 89.83 0.22\n4 0.17 12.24 0.29 28 0.17 89.04 0.22\n5 0.19 12.51 0.29 29 0.19 88.89 0.22\n6 0.20 12.82 0.29 30 0.20 88.72 0.22\n7 0.005 0.05 26.48 0.28 31 0.07 0.05 87.76 0.23\n8 0.09 23.54 0.28 32 0.09 87.59 0.23\n9 0.13 23.25 0.28 33 0.13 87.61 0.23\n10 0.17 23.79 0.28 34 0.17 85.91 0.25\n11 0.19 23.82 0.28 35 0.19 85.42 0.25\n12 0.20 23.98 0.28 36 0.20 84.98 0.25\n13 0.01 0.05 45.17 0.25 37 0.10 0.05 82.06 0.28\n14 0.09 48.95 0.25 38 0.09 81.81 0.28\n15 0.13 48.67 0.25 39 0.13 81.33 0.28\n16 0.17 49.01 0.25 40 0.17 81.28 0.28\n17 0.19 48.74 0.25 41 0.19 81.33 0.28\n18 0.20 48.85 0.25 42 0.20 81.06 0.28\n19 0.03 0.05 85.56 0.21 43 0.13 0.05 75.89 0.32\n20 0.09 90.49 0.20 44 0.09 75.53 0.32\n21 0.13 90.83 0.20 45 0.13 75.28 0.32\n22 0.17 90.84 0.20 46 0.17 75.28 0.32\n23 0.19 90.95 0.20 47 0.19 75.33 0.32\n24 0.20 90.92 0.21 48 0.20 75.36 0.32\n\nare calculated. Results are presented in Table 2.4 (as well as Table A.5 and Table A.11 in the Appendix\nA). Within the groups of meshes with the same value of c, changing the value of a has little impact on\nthe MSE and coverage of the predictions. While meshes with the smallest c value perform the worst in\nterm of coverage, meshes with c = 0.03 have the best coverage and MSE. The results for b = 0.4 and\nb = 0.2 are similar. In Table 2.4 we can notice that mesh 20 is one of the meshes with better results and\nwas the mesh that in Table 2.2 has the best results.\n\nThe predictive performance of the model was also investigated for locations not used in the\nanalysis. For n = 100 the predictions was made in 25 locations, and for n = 50 and n = 300 in 13 and 75\nlocations, respectively. Table 2.5 presents the results and we can notice that as the value of c increases,\nthe coverage is smaller and the MSE has a slight decrease and gets bigger again with c = 0.10. Within\nthe groups, the mesh with a = 0.05 has the best results. For n = 50 and n ? 300 the same results are\npresented in Table A.6 and Table A.12 in the Appendix A.\n\nBoxplots of bias for each mesh, considering the 25 extra locations are presented in Figure 2.2\n(as well as in Figure A.3 and Figure A.7 in the Appendix A) and we can notice that there is no difference\nwithin and between the groups.\n\n2.3.3 Selecting the best mesh\n\nResults in the previous section showed that there is a large impact of the mesh on the inference\n(parameter estimation and prediction). Also, it is was observed that there is not a single mesh which is\noptimal. Therefore, in this section, we investigate whether we can use the predictive information criteria\nas described in Section 2.1, to select an optimal mesh.\n\nTo perform mesh selection, we calculate DIC, WAIC and logCPO, for each simulation run. To\nsimplify the comparison, we fix b = 0.3 and a and compare meshes for different values of c. Figure 2.3\nshows the number of simulations in which the mesh with a particular value of c was chosen as the best\naccording to DIC (panel I), WAIC (panel II) or logCPO (panel III). In settings where two meshes perform\nequally good, the lowest value was considered for the two meshes. Looking at Figure 2.3, we observe an\n\n\n\n21\n\nTable 2.5. Nominal coverage, in %, and MSE for the variable Y calculated for each mesh with b = 0.3,\nconsidering 200 simulations, for 25 locations not in the analysis.\n\nMesh c a Coverage(%) MSE Mesh c a Coverage(%) MSE\n1 0.001 0.05 90.80 0.45 25 0.05 0.05 82.60 0.44\n2 0.09 80.26 0.45 26 0.09 82.54 0.44\n3 0.13 71.40 0.46 27 0.13 78.60 0.44\n4 0.17 62.86 0.47 28 0.17 74.56 0.44\n5 0.19 61.14 0.47 29 0.19 73.02 0.45\n6 0.20 59.64 0.47 30 0.20 71.58 0.45\n7 0.005 0.05 90.76 0.45 31 0.07 0.05 77.78 0.45\n8 0.09 80.62 0.45 32 0.09 77.62 0.45\n9 0.13 72.50 0.46 33 0.13 77.62 0.45\n10 0.17 64.68 0.47 34 0.17 73.82 0.45\n11 0.19 63.04 0.47 35 0.19 71.82 0.45\n12 0.20 61.50 0.47 36 0.20 70.46 0.46\n13 0.01 0.05 89.94 0.44 37 0.10 0.05 71.32 0.46\n14 0.09 81.30 0.45 38 0.09 71.06 0.47\n15 0.13 73.94 0.45 39 0.13 70.62 0.47\n16 0.17 67.38 0.46 40 0.17 70.22 0.47\n17 0.19 65.92 0.46 41 0.19 70.12 0.47\n18 0.20 65.26 0.46 42 0.20 69.72 0.47\n19 0.03 0.05 87.98 0.44 43 0.13 0.05 65.98 0.49\n20 0.09 83.10 0.44 44 0.09 65.98 0.49\n21 0.13 78.66 0.45 45 0.13 65.94 0.49\n22 0.17 74.88 0.45 46 0.17 65.66 0.49\n23 0.19 73.60 0.45 47 0.19 65.72 0.49\n24 0.20 72.68 0.45 48 0.20 65.96 0.49\n\nFigure 2.2. Bias for Y in 25 extra locations, for all 200 simulations, for b = 0.3.\n\napparent difference between the DIC and WAIC measured on the one hand, and the logCPO on the other\nhand. Results based on DIC and WAIC are very similar, with smaller values of c to be preferred in most\nsimulation runs (no matter which a is selected). LogCPO, on the other hand, seem to select meshes with\na larger value of c, and meshes with c = 0.03 (blue color) seems to standout.\n\nThe mean of DIC, WAIC and logCPO are reported in Table 2.6 for b = 0.3. We can observe\n\n\n\n22\n\n(I)\n\n(II)\n\n(III)\n\nFigure 2.3. For each value of a, minimum value of: (I) DIC; (II) WAIC and (III) logCPO, for all 200\nsimulations, for b = 0.3.\n\nthat meshes with smaller value of c are selected using DIC and WAIC. For the mean of logCPO, there\nare multiple meshes with good results and a way to choose one can be the minimum number of knots,\nwhich occurs with higher values of c and a. If we consider all these three results together, we can choose\n\n\n\n23\n\nmesh 20 as the best one, which is the same conclusion as in section 2.3.2. As we have seen before that\nthe meshes with smaller value of c lead to larger MSE and bias for inference of covariance parameters, it\ncan be argued that those selection methods are not well suited if interest is in the covariance function.\n\nTable 2.6. Mean values of DIC, WAIC and logCPO for meshes with b = 0.3.\nMesh c a DIC WAIC logCPO Mesh c a DIC WAIC logCPO\n\n1 0.001 0.05 -442.09 -448.64 2.07 25 0.05 0.05 230.73 231.21 1.28\n2 0.09 -490.14 -500.73 2.09 26 0.09 231.33 231.77 1.28\n3 0.13 -504.62 -515.26 2.13 27 0.13 237.21 237.70 1.28\n4 0.17 -495.78 -506.18 2.12 28 0.17 240.72 241.35 1.28\n5 0.19 -496.70 -506.81 2.11 29 0.19 241.05 241.69 1.28\n6 0.20 -492.78 -503.08 2.11 30 0.20 241.55 242.19 1.28\n7 0.005 0.05 -369.05 -370.31 1.98 31 0.07 0.05 242.94 243.85 1.28\n8 0.09 -389.08 -395.66 1.96 32 0.09 243.20 244.13 1.28\n9 0.13 -387.74 -395.32 1.97 33 0.13 243.30 244.24 1.28\n10 0.17 -384.21 -389.65 1.96 34 0.17 246.10 247.05 1.28\n11 0.19 -383.24 -389.03 1.95 35 0.19 246.78 247.72 1.29\n12 0.20 -381.55 -387.75 1.95 36 0.20 247.02 247.92 1.28\n13 0.01 0.05 -211.80 -205.13 1.78 37 0.10 0.05 251.05 252.20 1.29\n14 0.09 -162.39 -163.09 1.69 38 0.09 250.94 252.10 1.29\n15 0.13 -161.75 -166.19 1.70 39 0.13 251.48 252.61 1.29\n16 0.17 -156.79 -160.54 1.68 40 0.17 251.50 252.63 1.29\n17 0.19 -162.57 -163.38 1.68 41 0.19 251.39 252.54 1.29\n18 0.20 -162.23 -162.97 1.68 42 0.20 251.62 252.79 1.29\n19 0.03 0.05 155.35 161.35 1.34 43 0.13 0.05 255.85 257.13 1.30\n20 0.09 213.02 213.13 1.28 44 0.09 256.22 257.47 1.30\n21 0.13 221.37 221.18 1.28 45 0.13 256.55 257.78 1.30\n22 0.17 223.23 223.12 1.28 46 0.17 256.55 257.78 1.30\n23 0.19 223.54 223.35 1.28 47 0.19 256.49 257.73 1.30\n24 0.20 223.71 223.56 1.28 48 0.20 256.57 257.80 1.30\n\nWe now evaluate the logCPO, DIC and WAIC criteria for mesh selection over all values of a,\nb and c. Figure 2.4 shows boxplots of parameter estimates based on the mesh with lowest DIC, WAIC\nor logCPO, obtained in each simulation. For comparison, we also present in this figure the boxplots of\nthe estimates obtained for each parameter with mesh 20, the mesh chosen as the one with best overall\nperformance for the chosen simulation settings (based on bias, MSE, coverage of parameter estimates\nand predictions). We can observe that the boxplots obtained with mesh 20 are similar to the boxplots\nobtained for the results of logCPO. Selection of the mesh using DIC and WAIC has bad performance,\nseen in the large bias of all covariance parameters. Indeed, DIC and WAIC tends to select the mesh\nwith smaller cutoff values, and thus the more dense meshes, though it was observed in the previous\nsection that a mesh with smallest c value leads to larger bias and worse coverage for estimation of the\ncovariance parameters. The logCPO tends to select the mesh with larger cutoff values, and thus the more\nsparse/regular meshes. While the difference between the DIC, WAIC and logCPO would be expected\nto behave similarly (as they are asymptotically the same), it is important to realize that all methods\nare only approximations of the predictive accuracy. While DIC and WAIC give reasonable answers in\nmany cases, they only attempt to capture the predictive behavior within the sample, whereas the logCPO\ncaptures also out-of-sample prediction error.\n\nSimilar results are observed for other sample sizes. For n = 50 and n = 300, the best values\nof DIC and WAIC also occurs for smaller values of c, as we can see in Table A.7 and Table A.13 of the\nAppendix A, respectively. For logCPO with n = 50, the best results occur for larger value of c, especially\nfor c = 0.10. In the case of n = 300, meshes with smaller values of c, mainly c = 0.01, have the best\nvalues of logCPO. Considering the analysis, we can assume that mesh 27 is a good one for n = 50 and\nmesh 13 for n = 300. These meshes have plausible and satisfactory results. Figure A.5 and Figure A.9\nof the Appendix A are figures similar to Figure 2.4 above and in all this three figures, the boxplot of the\nchosen mesh is more alike with the boxplot of logCPO, so as told before, logCPO is the best criteria for\nmesh selection.\n\n\n\n24\n\nFigure 2.4. Estimated ?0, ?1, ?2e , ?2s , k and ??, considering the meshes with minimal DIC, WAIC and\nlogCPO, and based on mesh 20.\n\nBased on these simulation results, it is confirmed that the logCPO criterion is better suited for\nmesh selection.\n\n2.4 Data Analysis\n\nThe data analysed was the so called Parana? dataset, which is freely available in the geoR\npackage (Ribeiro and Diggle, 2001) in R (R Core Team, 2015). The data considers average precipitation\nlevels throughout Parana? state, Brazil. Data is available on 143 locations and the response represents\naverage winter (dry season) rainfall.\n\nTo perform the analysis we take out the linear trend from the variable, because we noticed that\nthis trend lead to misleading results. To model these data, we assume the model y = ?0 +s+?, where s is\na Mate?rn spatial random field with ? = 1.5. Considering the range as 380, assumed by a semivariogram\nanalysis, we create eighteen meshes to analyse this data set, namely a = c(20, 35, 55, 100, 240, 380),\nb = 570 and c = c(13, 35, 51). The value of a was chosen taking into account the value of range, allowing\nfor small values until we reach the expected value of the range. The value of b is chosen larger than a\nand for c values it was considered random values in the case that all the coordinates are the inner mesh.\nIn Table 2.7 we present the number of knots for each of these meshes. We can observe that the number\nof knots almost does not change for values of a larger than 100.\n\n\n\n25\n\nTable 2.7. Number of knots and values for DIC, WAIC and logCPO for each mesh for Para?na data.\n\nMesh c a Number knots DIC WAIC logCPO\n1 13 20 1235 1305.94 1306.35 4.58\n2 35 678 1307.34 1307.46 4.58\n3 55 362 1306.53 1306.47 4.58\n4 100 234 1307.85 1307.78 4.58\n5 240 230 1307.97 1307.91 4.58\n6 380 230 1307.97 1307.91 4.58\n7 35 20 197 1307.69 1306.64 4.58\n8 35 195 1308.14 1307.04 4.58\n9 55 194 1307.90 1306.81 4.58\n10 100 134 1309.51 1308.59 4.58\n11 240 122 1309.71 1308.65 4.58\n12 380 122 1309.71 1308.65 4.58\n13 51 20 100 1308.18 1307.65 4.58\n14 35 100 1308.44 1307.93 4.58\n15 55 97 1307.65 1307.09 4.58\n16 100 94 1307.60 1307.08 4.58\n17 240 77 1307.83 1307.05 4.57\n18 380 77 1307.83 1307.05 4.57\n\nThe posterior distributions for ?0, ?2s , k and ?? are not very different across the considered\nmeshes, as we can observe in Figures 13-16 of the Supplementary Material. Table 2.8 shows the posterior\nmean estimates for the parameters and we can observe that the choice of the mesh does not have a large\nimpact on the estimates, though mesh 16 was the one that estimates the value for ?? closer to the one\nthat we obtained from the exploratory analysis and also has good results for ?2s . The values of DIC,\nWAIC and logCPO was computed and added into Table 2.7. As for the posterior estimates, these three\ncriteria also only show minor difference between the meshes. The smallest results for these three criteria\noccurs for meshes 1, 17 and 18, in which meshes 17 and 18 are exactly the same. Comparing the results\nof this meshes with mesh 16 we can say that mesh 16 is better although it has more knots than meshes\n17 and 18. So we selected mesh 16 and computed the prediction mean and prediction standard deviation\nover the study area. This is given in Figure 2.5.\n\n\n\n26\n\nTable 2.8. Estimates of the parameters for each mesh.\nMesh c a ?0 ?2s k ??\n\n1 13 20 -3.04 1004.25 4x10?3 530.36\n2 35 -2.90 1019.22 3x10?3 568.74\n3 55 -2.88 1026.20 3x10?3 573.44\n4 100 -2.87 1020.58 3x10?3 588.12\n5 240 -2.85 1007.17 3x10?3 582.86\n6 380 -2.85 1007.17 3x10?3 582.86\n7 35 20 -2.80 1002.03 3x10?3 555.72\n8 35 -2.75 1003.72 3x10?3 570.49\n9 55 -2.77 987.82 3x10?3 556.80\n10 100 -2.60 1018.22 3x10?3 588.27\n11 240 -2.37 1063.74 3x10?3 618.14\n12 380 -2.37 1063.74 3x10?3 618.14\n13 51 20 -3.25 994.48 4x10?3 520.95\n14 35 -3.14 979.35 4x10?3 512.67\n15 55 -3.24 979.76 4x10?3 504.03\n16 100 -3.14 979.48 4x10?3 494.87\n17 240 -2.11 1263.75 3x10?3 666.64\n18 380 -2.11 1263.75 3x10?3 666.64\n\n(I) (II)\n\n(III) (IV)\n\nFigure 2.5. (I) Histogram, (II) plot of sample and corresponding values, (III) predicted surface and\n(IV) prediction standard deviation considering mesh 16.\n\n2.5 Conclusion\n\nThe first step to use the SPDE/GMRF approach in INLA with geostatistical data is to create\na triangulated mesh over the study area. Using a simulation study, we have shown that inferential results\ndepend on the considered mesh. The simulation results indicated that the value of b, the maximal edge\n\n\n\n27\n\nlength in the outer domain, has almost no impact on the results. On the other hand, the choice of the\nvalue of c, the shortest allowed distance between points, has the largest impact. Thirdly, conditional on\na value of c, the value of a, the maximal edge length in the inner domain, also leads to some differences.\n\nPre-specification of the triangulated mesh is not straightforward, since it is possible to create a\nmesh with very good predictive behavior, but that leads to poor covariance parameter estimates. We have\nused three predictive information criteria, namely DIC, WAIC and CPO, to investigate whether these\ncriteria can be used to select an optimal mesh for a specific data problem. We noticed that the predictive\ninformation criteria DIC and WAIC lead to choosing dense meshes. These meshes indeed perform well\nin terms of coverage and mean squared error for predictions, but do not perform well in the other parts\nof the analysis, namely the estimation of the covariance parameters. Thus, DIC and WAIC showed to\nprefer meshes with more knots. Further, we have noticed that mesh selection using the logCPO leads to\nbetter performing meshes overall.\n\nWorking with INLA is fast, but selection of the mesh is hindered by the computationally\nintensive logCPO measurement. While a fast approximating method for CPO calculating is available\nin INLA, it is very important to ensure that no numerical problems occur. We have observed that in\nmany cases, especially with dense meshes, this approximating method does not work and, therefore, CPO\nneeded to be recalculated by refitting the model, leaving out every observation one at a time.\n\nIn this paper, we focused on a simple simulation scenario to investigate the impact of different\nmeshes on prediction and estimation of covariance parameters. Further investigation is still needed\ntowards the mesh triangulation using the SPDE/GMRF approach in INLA. For example, in our simulation\nstudy the meshes were created considering the coordinates. However, it is not required that the observed\nlocations are included as nodes in the mesh. Thus, it is also possible to create meshes without the\nobserved coordinates or by using a specific subset of the observed locations. Additionally, situation in\nwhich the observed data locations are more clustered or more regular should be investigated in more\ndetails.\n\nIn the analyzed scenarios, we choose the mesh that stands out from the others, but there is not\nonly one suitable mesh. For n = 50, meshes constructed with c = 0.05 have good results and comparing\nwith range, it is a ratio of 0.25 ;for n = 100, meshes with c = 0.03 have good results, generating a\nproportion of 0.15 with range and for sample size n = 300, the proportion is 0.05, with c = 0.01.\n\nReferences\n\nBOLIN, D.; LINDGREN, F. A comparison between Markov approximations and other methods for large\nspatial data sets. Computational Statistics &amp; Data Analysis, v. 61, p. 7-21, 2013.\n\nBOLIN, D.; LINDSTRO?M, J. Spatial Statistics using R-INLA and Gaussian Markov random fields.\nPan-American Advanced Study Institute, 15:29:57Z, rev.3691, 2014.\n\nCAMELETTI, M.; LINDGREN, F.; SIMPSON, D., RUE, H. Spatio-temporal modeling of particulate\nmatter concentration through the SPDE approach. Advances in Statistical Analysis, v. 97, p. 109-131,\n2012.\n\nGEISSER, S.; EDDY, W. A predictive approach to model selection. Journal of the American Statistical\nAssociation, Boston, v.74, n.365, p.153-160, 1979.\n\nGELFAND, A E. Model determination using sampling-based methods. In: GILKS, W.; S. RI- CHARD-\nSON, S.; SPIEGELHALTER, D. (Eds.), Markov chain Monte Carlo in practice. Florida: Chapman &amp;\nHall/CRC, 1996. chap. 9, p. 145-161.\n\n\n\n28\n\nGELFAND, A. E.; DIGGLE, P. J., FUENTES, M.; GUTTORP, P. (Eds) Handbook of spatial statistics.\nCRC press, 2010.\n\nGELMAN, A.; HWANG,J.; VEHTARI, A. Understanding predictive information criteria for Bayesian\nmodels. Statistics and Computing, v. 24, n. 6, p. 997-1016, 2014.\n\nHELD, L., SCHRODLE, B., RUE, H. Posterior and Cross-validatory Predictive Checks: A comparison\nof MCMC and INLA. In T. Kneib and G. Tutz, editors,Statistical Modelling and Regression Structures,\np. 91 , 2010.\n\nKARAGIANNIS-VOULES, D-A, SCHOLTE, R. G. C., GUIMARE?ES, L. H., UTZINGER, J.,\nVOUNATSOU, P. Bayesian Geostatistical Modeling of Leishmaniasis Incidence in Brazil. PLoS Ne-\nglected Tropical Diseases, v. 7, n. 5, e2213. doi:10.1371/journal.pntd.0002213. 2013.\n\nKRAINSKI, E. T.; RUE, H. A short introduction on how to fit a SPDE model with INLA. 2013.\n\nKRAINSKI, E. T.; LINDGREN, F. The R-INLA tutorial: SPDE models. 2014.\n\nLINDGREN, F. Continuous domain spatial models in R-INLA. The ISBA Bulletin, v. 19, n. 4, 2012.\n\nLINDGREN, F.; RUE, H. Bayesian spatial modelling with R-INLA. Journal of Statistical Software, v.\n63, 2015.\n\nLINDGREN, F.; RUE, H.; LINDSTRo?M, J. An explicit link between Gaussian fields and Gaussian\nMarkov random fields: The stochastic partial differential equation approach. Journal of the Royal Sta-\ntistical Society, v. 73, p. 423-498, 2011.\n\nR Core Team (2015). R: A language and environment for statistical computing. R Foundation for\nStatistical Computing, Vienna, Austria. URL https://www.R-project.org/.\n\nRIBEIRO JR., P.J. and DIGGLE, P.J. (2001) geoR: A package for geostatistical analysis. R-NEWS\nVol 1, No 2. ISSN 1609-3631. Available for download at: http://cran.r-project.org/doc/Rnews.\n\nRUE, H.; MARTINO, S.; CHOPIN, N. Appriximate Bayesian inference for latent Gaussian models by\nusing integrated nested Laplace aproximations (with discussion). Journal of the Royal Statistical Society\n- Series B, v.71, Part 2, p.319-392, 2009.\n\nSPIEGELHALTER, D.J.; BEST, N.G.; CARLIN, B.P.; LINDE, A.V.D. Bayesian measures of model\ncomplexity and fit. Journal of the Royal Statistical Society Series B, London, v.64, n.4, p.583-639, 2000.\n\nVEHTARI, A.; GELMAN, A. WAIC and cross-validation in Stan. Submitted. http://www.stat.columbia.\nedu/gelman/research/unpublished/waic stan.pdf Accessed, v. 27, n. 2015, p. 5, 2014.\n\nWATANABE, S. Asymptotic equivalence of Bayes cross validation and widely applicable information\ncriterion in singular learning theory. Journal of Machine Learning Research, v. 11, p. 3571-3594, 2010.\n\nWHITTLE, P. On stationary processes in the plane. Biometrika, v. 41, p. 434-449, 1954.\n\n\n\n29\n\n3 A SIMULATION STUDY WITH DIFFERENT MESHES FOR GEOSTATISTICAL\nDATA WITH RANDOM, CLUSTER AND REGULAR GRIDS.\n\nAbstract: Advanced in Geographic Information Systems and Global Positioning Systems\nplaced increasing demands and chalenge for spatial statistics analysis. Most of the methods used\nin this analysis are computationally demandingOne approach, which is considered an remarkable\ndevelopment, is the introduction of the integrated nested Laplace approximation method which is\nable to carry out Bayesian analysis in a more efficient way. The use of this method for geostatistical\ndata is commonly done considering the SPDE approach that requires the creation of a mesh over the\nstudy area. This is the first and an important step since all results will depend on the choice of this\nmesh. As there is no formal and close way to specify the mesh, we investigate possible guidelines on\nhow an optimal mesh is chosen for a specific problem. We study the impact of the mesh for random,\nregular and cluster data set, through a simulation study in which we considered different ways to\ndefine the knots. Two applications with real data set,rainfall data in Parana? state, Brazil, and soil\ndata set, is presentend.\nKeywords: Geostatistics; Clustered data; Random data; Integrated nested Laplace approximation;\nMesh\n\n3.1 Introduction\n\nThe methods of spatial statistics have the purpose of measuring properties and relationships,\ntaking into account the spatial location of the phenomenon studied in an explicit way. Geostatistics is a\nsub-area of spatial statistics and according to Matheron (1963) it is the application of the formalism of\nrandom functions for the recognition and estimation of natural phenomena.\n\nFor geostatistical modeling with Bayesian analysis a method of approach has been increasingly\nused, which is the integrated nested Laplace approximations (INLA), proposed by Rue, Martino and\nChopin (2009). This method is an alternative for Markov Chain Monte Carlo (MCMC) and it is faster\n(Karagiannis et al., 2013; Lindgren, 2012). INLA is an approximate method designed for inference\nof latent Gaussian models, a very wide and flexible class of models ranging from (generalized) linear\nmixed model to spatial and spatio-temporal models (Lindgren and Rue, 2015). When combined with\nstochastic partial differential equation (SPDE) (Lindgren, Rue and Lindstrom, 2011), it can accommodate\ngeoreferenced data from all sub-areas of spatial statistics.\n\nWhen combaning INLA with SPDE, for geostatistical data, the spatial field is best described\nusing a weighted sum of piece-wise linear basis function that is usually defined from a triangularisation\nof the study area, called the mesh. This triangularisation can be done with small or big trianguls or a\ncombination of both. The idea is that smaller triangles will increase the accuracy, though when the spatial\nrange is larger, larger triangles can be used. The mesh can be constructed using different principles. we\ncan create the mesh using all the coordinate or just using a sample of it or we can also use only the\ndomain of the area.\n\nAlthough it is known that the choice of the mesh must be done carefully (Lindgren and Rue,\n2015), since accuracy of the estimates as well as the predictions will depend on the choice of the mesh,\nthere is no conclusive way to create the best one. In this way, the objective of this work is to study the\nparameters for the creation of the mesh with different type of meshes, to see their impact on the analysis\nand set guidelines to construct the optimal mesh in two dimensional spatial domains. The study is made\nwith creation of meshes using all coordinate, using a sample of the coordinate and only considering the\ndomain of the study area. With this three types of meshes, we made the study for irregular, regular\nand cluster geostatistical data. The objective is to try to solve issue raised by Bolin and Lindstrom\n\n\n\n30\n\n(2014), which was how different meshes impact in analysis. In Section 3.2, we give a brief introduction to\nINLA and the SPDE approach and discuss some criteria to evaluate the mesh, in Section 3.3 we show a\nsimulation study, applications with real data set are provided in Section 3.4 and a discussion is provided\nin Section 3.5.\n\n3.2 Methodology\n\nIn a study that requires the use of the position of the sample elements, traditional statistical\ntechniques are no longer sufficient for analysis. For such studies, one needs the approaches used in\nspatial statistics. Geostatistics is a sub-area of spatial statistics and, according to Diggle, Ribeiro Jr and\nChristensen (2003), the data in this sub-area consist of measurements y1,..,yn obtained in locations s1,..,\nsn, sampled from a region A spatially continuous, in which A ? Rd. The grid of this samples can be in\ndifferent way, as it can be in a regular grid, meaning that all points of sample are equal spaced, it can be\nin a random grid or a cluster one.\n\nDiggle, Tawn and Moyeed (1998) introduced the term \u201dmodel-based geostatistics\u201d, in which\nmodeling is performed by specifying a parametric model for the variable(s) under study and using statis-\ntical inference methods based on the likelihood function applied to geostatistical studies. With geosta-\ntistical techniques it is possible to describe the spatial dependence structure of the data, establishing a\nspatial correlation function that depends only on the distance of the position of the samples and repre-\nsents the behavior of the spatial variability of the data, by means of a model. Also, the parameters of the\nmodels are estimated and used in the spatial predictions of the variables under study and then, it can\nbe said that there is uncertainty about these parameters and as a consequence, there is uncertainty in\nthe predictions made. When using the classical geostatistical methodology in the estimation of parame-\nters through the maximum likelihood method, we use only the information from the data, the adopted\nmodel and the asymptotic theories, but when using the Bayesian methods, besides all this knowledge we\nalso use a priori information about the parameters, that is, there may be an initial knowledge that is\nexpressed through a prior distributions. Under this approach, there is no difference between parameters\nand observations, both of which are treated as random quantities.\n\nAfter defining the priori distribution of the parameters it is possible to summarize inferential\ntechniques, usually using probabilities and expectation. In this step, it is often necessary to use intensive\ncomputational methods such as Monte Carlo via Markov Chains (MCMC). In geostatistics, the Gibbs\nsampler and the Metropolis-Hastings algorithm were the most used methods. An alternative approach\nis the INLA method, which is a deterministic method to perform Bayesian inference in a large class of\nGaussian Markov random fields (GMRF), including many of the hierarchical models with latent Gaussian\nprocesses. It has been gaining a lot of space on the practice because it is more computationally efficient\n(Rue, Martino and Chopin, 2009).\n\nIf y represents the data, x the GMRF and ? the vector of hyperparameters, the idea of INLA\nis to approximate the posterior density ?(?|y) via Gaussian approximation of the posterior of the la-\ntent field ?(x|?, y) and a Laplace approximation in the latent field marginal posterior calculations.\nFor more details see Rue, Martino and Chopin (2009). Lindgren, Rue and Lindstrom (2011) showed\nthat INLA is not restricted to discrete spatial domains, given there is a connection between continu-\nous domains and Markov models. Also, a large class of random field models can be expressed as a\nsolution of a continuous domains stochastic partial differential equation (SPDE) and it is possible to\nobtain connections between the parameters of the SPDE and the elements of the precision matrix for\nweights in representation, using as basis the covariance function Mate?rn. The Mate?rn function is given\nby M(h|k, ?) = 2\n\n1?k\n\n?(k)\n(?||h||)kKk(?||h||), in which ?(.) is the Gamma function, Kk is Bessel function with\n\norder k and ||h|| is the distance between two locations. With this connection it is possible to carry out\n\n\n\n31\n\nthe calculations for a continuous random field using the (discrete) GMRF representation:\n\nx(s) =\n\nK?\nk=1\n\n?k(s)xk, (3.1)\n\nwhere ?k(s) are piece-wise linear basis function defined on a triangulation of the study domain and\n{x1, ..., xK} are Gaussian weights chosen to approximate the solutions to the SPDE on the domain. This\ntriangulation consists of partitioning the study area into a set of non-intersecting triangles (Cameletti et\nal., 2012), with linear basis function defined with barycentric interpolation. This approach is available in\nthe R-package INLA (Rue, Martino and Chopin, 2009).\n\nThis partitioning can be done with the construction of a triangulated mesh on which the\nSPDE/GMRF representation is built (Lindgren, 2012). As an initial step, we can choose to place the\ntriangle vertices at the locations where measurements were taken, and after that, add or remove additional\nvertices, creating the triangulation for the analysis. As the solution may present a border effect, it is\nnecessary to extend the mesh also outside the study area to avoid it. According to Lindgren (2012), the\nglobal effect in constructing triangles is that we can obtain small ones (and so obtain high accuracy to\nrepresent the field) where the locations are dense, and bigger ones when the locations are sparse. As the\nanalysis depends on the mesh, this first step is very important, so we can create a mesh suited for the\ndata at hand.\n\nThe function inla.mesh.2d(), in the R-INLA implementation, is available to create the mesh.\nSeveral parameters in this function can be chosen as to construct a mesh for the problem at hand but in\nthis work we are only using three: the max.edge parameters, which define the maximal allowed lengths of\ntriangle edges in the inner domain and in the outer extension, the cutoff parameter, which corresponds\nwith the shortest distance allowed between points (Krainski and Lindgren, 2014; Krainski and Rue, 2013).\nA change in one of these values, will create a different mesh, making it with more or less knots.\n\nIn this work we named the parameters to construct the mesh as: the maximal allowed edge\nlength in the inner domain is a, the outer domain is represented by b and the shortest allowed distance\nbetween points by c. We will always consider larger values of the maximal allowed edge length for the\nouter domain as for the inner domain (b > a), as the outer domain is needed only to avoid border effects.\n\n3.2.1 Goodness of fit\n\nTo compare the results obtained from the differents meshes, we used some criteria to try to\nobatin the optimal mesh. The criteria used were: the deviance information criterion (DIC), the Watanabe-\nAkaike information criterion (WAIC) and the conditional predictive ordinate (CPO).\n\nSpiegelhalter et al. (2000) described DIC as\n\nDIC = ?2 log p(y|??) + 2pDIC,\n\nwhere 2 log p(y|??) is the posterior expected deviance measuring the suitability of the model and pDIC\nis the estimated effective number of parameters of the model, representing the complexity of the model.\nThus, we can say that DIC takes into consideration both the suitability and complexity of the model.\n\nWAIC was proposed by Watanabe (2010) and can be viewed as an improvement on the DIC\nfor Bayesian models (Vehtari and Gelman, 2014).The formula for WAIC is given by\n\nWAIC = ?2 log\n?\n\np(y|?)?(?|y)d? +\nn?\n\ni=1\n\nV ar (log(p(yi|?))) .\n\nIn the same way for DIC, in WAIC the first term measures the predictive performance, and the second\nterm penalizes for model complexity. According to Gelman, Hwang and Vehtari (2014), the complexity\nterm is a sum of the variance for each data point separately, yielding more stable results as DIC.\n\n\n\n32\n\nCPO statistics is a model assessment tool which has been widely used in the statistical literature\nunder various contexts (Ibrahim, Chen and Sinha, 2013) and it is a cross-validation method, estimating\nthe leave-one-out predictive distribution (Geisser and Eddy, 1979). The posterior predictive distribution\nfor an observation i can be expressed as\n\np(yi|y?i) =\n?\n\np(yi|?)?(?|y?i)d?,\n\nwhere yi is the ith observation of y and y?i is y without observation i. So the CPO is the probability a\nposteriori to observe yi when the model is adjusted without yi. A bigger value of CPO indicates a better\nadjustment. Instead of having to refit the model each time, an approximation of CPO can be obtained\nby sampling from the posterior distribution:\n\nCPOi =\n1\n\nT ?1\n?T\n\nt=1 p(yi|?t)?1\n,\n\nwhere ?t is a sample from ?(?|yi) and T indicated the number of posterior samples. This is the inverse\nof the posterior mean of the inverses of the likelihood. This is an efficient method, but requires care since\nnumerical problems in the calculations can occur (Held, Schrodle and Rue, 2010). However, when using\nINLA it is possible to verify if numerical problems did occur and recompute the CPO using a less efficient\nmethod (re-fitting the model for every observation).\n\nNormally, CPO is used plotting a graphic of CPO\u2019s values against the observation index. An\nalternative to this plots, is to use the average of the summary statistics named as the logarithm of\nthe Pseudomarginal Likelihood (LPML) (Ibrahim, Chen and Sinha, 2013). In this paper we named as\nlogCPO and the formula is given by log CPO = ? 1\n\nn\n\n?n\ni=1 log(p(yi|y?i)). This log-score is an estimator\n\nof the log marginal likelihood function and smaller values indicate better model performance. In contrast\nto DIC and WAIC, the log CPO score does not adjust for the complexity of the model.\n\nIn addition to look only the estimates of the parameters, Zhang and Zimmerman (2007) said\nthat the ratio ?\n\n2\ns\n\n?\naffects interpolation more than each this parameter separately. So, we will also consider\n\nthe estimate of this ratio, in which ? = 1\n?? , in our notation.\n\n3.3 Simulation Study\n\nThis section is to describe the simulation design and its results in which we investigate the\nimpact of the choice of the mesh in the parameter estimation and prediction and we also investigate how\nto select an optimal mesh for a particular data problem considering the design of the sample.\n\nAll the analysis was made using R software (R Core Team, 2015) and INLA package (Rue,\nMartino and Chopin, 2009).\n\n3.3.1 Simulation Design\n\nIn this simulation study, we runned 200 simulations and investigate the optimal mesh for three\nkind of sample design: random, regular and cluster data set, always with sample size n = 100, on the unit\nsquare. We conduct the simulation in five batches of 40 simulations and within one batch the coordinates\nare kept fixed, except on regular sample, to avoid possible confounding of the generated coordinates on\nthe simulation results,\n\nA response vector y is generated according to the model y = ?0 + ?1x + s + e, where x is a\nuniformly distributed covariate, s is a Mate?rn spatial random field and e is white noise. Parameters are\nfixed to ?0 = 1, ?1 = 2. The spatial variability of the Mate?rn spatial random field is set to ?2s = 0.7\nand Gaussian white noise variability to ?2e = 0.3. The scale parameter (k) has value 10 and the nominal\n\n\n\n33\n\nrange, specified as ?? =\n?\n\n8(?? d\n2\n)\n\nk\n, has value 0.2. We also fixed the fractional operator order ? = 1.5 and\n\nd = 2, as the study region A ? Rd. For the prior, we used the log-gamma distribution with parameters\nc(1.0,0.00005).\n\nWe worked with 48 meshes for each type of data and they are divided in three groups, of 16\nmeshes each: the first one (GM1) is the group in which the initial triangulation taken is given by the\nlocations of the generated process; the second group (GM2) is the one that we did not considered the\ncoordinate to create the mesh, we only take into account a specific domain and in the third group (GM3)\nthe meshes was created by half of the coordinate and for the selection of the coordinate we use the space\nfilling algorithm (Johnson, 1990)\n\nThe spacial domain used was [?0.1, 1.1]\u00d7 [?0.1, 1.1]. To create different meshes, we considered\nthe max.edge and cutoff parameters to change. The values considered for the maximal allowed edge\nlength in the inner domain is a = (0.05, 0.09, 0.17, 0.20), for the maximal edge length in the outer\ndomain is b = 0.3 and for the shortest allowed distance between two points is c = (0.005, 0.03, 0.07, 0.10).\nCombinations of these three values leads to a total of 16 different meshes. These values were chosen such\nthat the value of a is smaller or equal to the range ??, and the value of b, controlling the outer boundaries\nto avoid boundary effects, should be larger than a.\n\nThe analysis will be presented separately according to the data design.\n\n\u2022 Random data set\n\nTable 3.1 summarizes, for the three groups and for the different combination of the parameters\na and c, the average number of knots in the mesh. A more dense triangulation is obtained with smaller\nvalues of both a and c. We can observe that meshes created with domain and not taking any coordinate,\nalways gets larger numbers of knots.\n\nTable 3.1. Average number of knots for different combinations of the parameters a and c, with parameter\nb = 0.3 for random data.\n\nc=0.005 c=0.03 c=0.07 c=0.10\nGM1 a=0.05 1593 1191 269 148\n\na=0.09 598 567 270 146\na=0.17 347 286 204 147\na=0.20 333 269 170 143\n\nGM2 a=0.05 2109 1586 370 208\na=0.09 727 727 369 208\na=0.17 252 252 252 209\na=0.20 212 212 212 206\n\nGM3 a=0.05 1599 1198 267 145\na=0.09 567 565 267 145\na=0.17 251 248 201 144\na=0.20 221 218 163 141\n\nWe calculated the coverage (based on the 95% Confidence Interval), bias and mean square error\n(MSE) for each of the parameters in the model and for the predictions and also bias and MSE for the\nratio ?\n\n2\ns\n\n?\n, to investigate the impact of the mesh on the inference,\n\nThe values of the coverage (in %) for the covariance function parameters (?2e , ?2s , k and ??)\nand for ?0 and ?1 are summarized on Table 3.2. In the Appendix B, Figure B.1 shows the coverage for\nall considered meshes. As we can observe in this table, all meshes have good results for coverage of ?0\nand ?1. For ?2e , meshes from GM1 have better results, specially the ones with c = 0.03 and as the value\nof a gets higher, the coverage gets small. For the parameters ?2s , k and ??, all the meshes, except the\nmeshes from GM1 with c = 0.005, have similar and good results and this is is very clear when looking at\nthe Figure B.1 of the Appendix B. So, considering the coverage of all parameters together, mesh 6 was\nthe one with the best results overall.\n\n\n\n34\n\nTable 3.2. Coverage, in %, of the 95% credible intervals of the parameters ?0, ?1, ?2e , ?2s , k and ?? for\ndifferent meshes with b = 0.3, for random data set.\n\nCoverage in % for:\nGroup Mesh c a ?0 ?1 ?2e ?\n\n2\ns k ?\n\n?\n\n1 0.005 0.050 88.000 86.000 19.000 61.000 35.500 35.500\n2 0.005 0.090 89.000 83.000 11.000 22.000 23.500 23.500\n3 0.005 0.170 89.000 84.000 12.500 16.000 25.000 25.000\n4 0.005 0.200 89.500 84.000 13.000 15.000 27.500 28.000\n5 0.030 0.050 96.000 92.000 81.500 92.500 90.500 90.500\n6 0.030 0.090 97.500 92.000 82.500 94.500 91.000 90.500\n7 0.030 0.170 97.500 93.500 80.000 93.000 90.000 90.000\n\nGM1 8 0.030 0.200 97.500 93.500 80.000 90.500 90.500 90.500\n9 0.070 0.050 99.500 93.000 63.500 96.500 84.500 84.500\n\n10 0.070 0.090 99.500 93.500 62.500 95.000 84.500 84.500\n11 0.070 0.170 99.000 93.500 47.500 96.000 82.500 82.500\n12 0.070 0.200 99.500 92.000 37.000 96.500 81.500 81.500\n13 0.010 0.050 99.000 93.500 25.500 96.000 84.000 84.000\n14 0.010 0.090 99.000 94.000 26.500 96.000 83.000 83.000\n15 0.010 0.170 99.000 93.500 25.500 97.000 83.500 83.500\n16 0.010 0.200 98.500 93.500 23.500 96.000 85.000 85.000\n17 0.005 0.050 94.000 91.000 63.000 68.500 65.500 65.500\n18 0.005 0.090 96.000 92.500 76.000 90.000 87.500 87.500\n19 0.005 0.170 98.000 92.000 31.500 86.500 84.000 84.000\n20 0.005 0.200 97.000 93.500 16.500 89.000 84.500 84.500\n21 0.030 0.050 96.000 90.000 68.000 75.000 74.500 74.500\n22 0.030 0.090 96.000 92.500 76.000 90.000 87.500 87.500\n23 0.030 0.170 98.000 92.000 31.500 86.500 84.000 84.000\n\nGM2 24 0.030 0.200 97.000 93.500 16.500 89.000 84.500 84.500\n25 0.070 0.050 99.500 92.500 50.500 88.000 86.000 86.000\n26 0.070 0.090 98.500 93.500 50.000 92.000 85.000 85.000\n27 0.070 0.170 98.000 92.000 31.500 86.500 84.000 84.000\n28 0.070 0.200 97.000 93.500 16.500 89.000 84.500 84.500\n29 0.010 0.050 98.500 92.500 23.500 89.000 85.500 85.500\n30 0.010 0.090 99.000 93.500 20.000 88.500 82.000 82.000\n31 0.010 0.170 99.000 94.500 18.000 89.000 85.500 86.000\n32 0.010 0.200 98.500 93.500 18.000 91.000 87.000 87.000\n33 0.005 0.050 96.000 90.500 69.000 78.500 76.500 77.000\n34 0.005 0.090 98.000 91.000 77.500 92.500 89.000 89.000\n35 0.005 0.170 98.500 93.500 39.500 95.000 82.000 82.000\n36 0.005 0.200 98.500 94.000 29.000 94.500 81.500 81.500\n37 0.030 0.050 97.000 91.000 77.000 83.500 83.500 83.500\n38 0.030 0.090 98.000 91.500 77.500 92.500 89.500 89.500\n39 0.030 0.170 98.500 93.500 40.000 95.000 83.000 83.000\n\nGM3 40 0.030 0.200 98.000 94.000 29.000 94.500 82.500 82.500\n41 0.070 0.050 99.000 93.500 56.500 92.500 83.500 83.500\n42 0.070 0.090 99.000 93.500 55.500 93.500 84.000 84.000\n43 0.070 0.170 98.500 93.500 38.000 96.500 82.000 82.500\n44 0.070 0.200 98.000 94.000 25.500 94.000 83.000 83.000\n45 0.010 0.050 99.000 94.000 24.500 92.500 82.500 82.500\n46 0.010 0.090 99.000 94.000 25.000 93.000 83.500 83.500\n47 0.010 0.170 99.000 94.000 23.500 92.500 83.500 83.500\n48 0.010 0.200 99.000 94.000 20.000 92.500 84.000 84.000\n\nTable 3.3 presents the absolute bias of the estimated parameters and for the ratio ?\n2\ns\n\n?\n. We can\n\nnotice that the bias for ?0 and ?1 have small values and similar results for the meshes. For ?2e , the best\nvalue for the bias is obtained with mesh 6 and the highest value with mesh 2,but it is not so different\nfrom the values from other meshes. The small value of bias for ?2s is with mesh 9 and for these parameter\nthe values are higher than for ?2e , but almost all meshes have the same behavior. The bias for parameter\nk some meshes obtained high and discrepant values from the others, as for example, mesh 1 has bias with\nvalue 11.943 and mesh 10 obtained value 0.051, and we can notice that meshes from GM1 have smaller\nresults. For ?? the values obtained for bias vary from 0.024 to 0.144, so there is no huge difference from\neach mesh. The results of bias for the ratio ?\n\n2\ns\n\n?\nalso did not have big change between meshes and the\n\nlowest values were obtained with c = 0.005 from GM1.\nTable B.1 from the Appendix B shows the results of MSE for the parameters and the ratio.\n\nSimilar as the values of bias, we can notice high values of MSE for k and meshes from GM1 with c = 0.03\nare the ones with small values and theses values are really small when comparing with the other meshes.\nFor the others parameters and for the ratio, there are no big difference of the values from all meshes.\n\nConsidering the variable, we calculated the coverage and MSE of prediction in the sample\nlocations to investigate the impact of the mesh on the predictive performance of the model. These results\nare in Table 3.4 and we can notice that the highest values for coverage and the lowest values for MSE\nare from meshes with c = 0.03 from GM1; all the others meshes have similar results for MSE and only\nmeshes with the lowest value of c from GM1 have very small values for coverage.\n\nThe predictive performance of the model was also investigated for locations not used in the\n\n\n\n35\n\nTable 3.3. Absolute bias of the parameters ?0, ?1, ?2e , ?2s , k and ?? and for\n?2s\n?\n\n, considering all meshes\nwith random data set.\n\nBias for:\n\nGroup Mesh c a ?0 ?1 ?2e ?\n2\ns k ?\n\n? ?\n2\ns\n?\n\n1 0.005 0.050 0.004 0.030 0.246 0.232 11.943 0.055 0.010\n2 0.005 0.090 0.001 0.035 0.261 0.445 12.328 0.075 0.015\n3 0.005 0.170 0.001 0.040 0.257 0.574 8.716 0.063 0.016\n4 0.005 0.200 0.002 0.039 0.256 0.601 8.127 0.060 0.024\n5 0.030 0.050 0.005 0.025 0.045 0.051 2.395 0.057 0.037\n6 0.030 0.090 0.008 0.018 0.014 0.022 0.139 0.089 0.050\n7 0.030 0.170 0.008 0.019 0.035 0.032 0.263 0.093 0.060\n\nGM1 8 0.030 0.200 0.008 0.020 0.040 0.043 0.384 0.091 0.064\n9 0.070 0.050 0.008 0.017 0.137 0.001 0.072 0.140 0.083\n\n10 0.070 0.090 0.009 0.017 0.140 0.006 0.051 0.137 0.082\n11 0.070 0.170 0.009 0.018 0.167 0.024 0.054 0.145 0.084\n12 0.070 0.200 0.009 0.017 0.183 0.065 0.308 0.138 0.080\n13 0.010 0.050 0.010 0.020 0.216 0.164 1.185 0.138 0.086\n14 0.010 0.090 0.009 0.021 0.216 0.165 1.306 0.138 0.086\n15 0.010 0.170 0.009 0.021 0.215 0.168 1.197 0.138 0.086\n16 0.010 0.200 0.010 0.019 0.220 0.162 1.289 0.132 0.085\n17 0.005 0.050 0.013 0.012 0.068 0.322 7.567 0.024 0.040\n18 0.005 0.090 0.008 0.021 0.066 0.261 2.707 0.079 0.074\n19 0.005 0.170 0.007 0.024 0.198 0.662 3.907 0.088 0.097\n20 0.005 0.200 0.007 0.025 0.237 0.631 3.753 0.101 0.121\n21 0.030 0.050 0.011 0.010 0.033 0.290 5.703 0.038 0.048\n22 0.030 0.090 0.008 0.021 0.066 0.261 2.707 0.079 0.074\n23 0.030 0.170 0.007 0.024 0.198 0.662 3.907 0.088 0.097\n\nGM2 24 0.030 0.200 0.007 0.025 0.237 0.631 3.753 0.101 0.121\n25 0.070 0.050 0.007 0.022 0.154 0.353 2.582 0.085 0.081\n26 0.070 0.090 0.006 0.025 0.155 0.313 2.456 0.090 0.084\n27 0.070 0.170 0.007 0.024 0.198 0.662 3.907 0.088 0.097\n28 0.070 0.200 0.007 0.025 0.237 0.631 3.753 0.101 0.121\n29 0.010 0.050 0.006 0.024 0.222 0.874 4.695 0.086 0.115\n30 0.010 0.090 0.005 0.023 0.224 0.723 4.108 0.105 0.121\n31 0.010 0.170 0.003 0.028 0.227 0.565 3.250 0.095 0.101\n32 0.010 0.200 0.005 0.026 0.226 0.840 4.039 0.098 0.116\n33 0.005 0.050 0.010 0.013 0.061 0.125 3.618 0.043 0.036\n34 0.005 0.090 0.012 0.013 0.064 0.036 0.293 0.106 0.066\n35 0.005 0.170 0.011 0.016 0.183 0.096 0.674 0.143 0.082\n36 0.005 0.200 0.009 0.018 0.206 0.138 1.154 0.138 0.078\n37 0.030 0.050 0.011 0.012 0.023 0.127 3.561 0.050 0.040\n38 0.030 0.090 0.012 0.012 0.064 0.037 0.312 0.106 0.067\n39 0.030 0.170 0.011 0.016 0.183 0.096 0.679 0.144 0.082\n\nGM3 40 0.030 0.200 0.009 0.018 0.206 0.136 1.145 0.137 0.077\n41 0.070 0.050 0.007 0.018 0.147 0.049 0.034 0.133 0.077\n42 0.070 0.090 0.006 0.018 0.147 0.031 0.298 0.136 0.076\n43 0.070 0.170 0.009 0.019 0.186 0.088 0.572 0.142 0.084\n44 0.070 0.200 0.010 0.018 0.212 0.136 0.701 0.140 0.079\n45 0.010 0.050 0.010 0.016 0.216 0.293 2.343 0.126 0.083\n46 0.010 0.090 0.010 0.017 0.218 0.348 2.457 0.126 0.084\n47 0.010 0.170 0.011 0.016 0.219 0.291 2.197 0.128 0.084\n48 0.010 0.200 0.011 0.015 0.222 0.352 2.367 0.131 0.085\n\nTable 3.4. Nominal coverage, in %, and MSE for the variable Y calculated for each mesh, considering\n200 simulations, with random data set.\n\nGroup Mesh c a Coverage(%) MSE Group Mesh c a Coverage(%) MSE\n1 0.005 0.050 28.955 0.273 25 0.070 0.050 88.115 0.238\n2 0.005 0.090 23.740 0.281 26 0.070 0.090 87.925 0.238\n3 0.005 0.170 23.385 0.281 27 0.070 0.170 85.045 0.259\n4 0.005 0.200 23.650 0.280 GM2 28 0.070 0.200 81.745 0.282\n5 0.030 0.050 87.405 0.205 29 0.010 0.050 82.775 0.273\n6 0.030 0.090 90.485 0.203 30 0.010 0.090 83.005 0.272\n7 0.030 0.170 90.795 0.205 31 0.010 0.170 83.105 0.273\n\nGM1 8 0.030 0.200 90.870 0.205 32 0.010 0.200 82.585 0.275\n9 0.070 0.050 88.270 0.229 33 0.005 0.050 78.620 0.218\n\n10 0.070 0.090 88.100 0.230 34 0.005 0.090 89.875 0.211\n11 0.070 0.170 86.455 0.242 35 0.005 0.170 85.515 0.249\n12 0.070 0.200 85.485 0.249 36 0.005 0.200 83.610 0.261\n13 0.010 0.050 82.745 0.268 37 0.030 0.050 86.180 0.209\n14 0.010 0.090 82.710 0.268 38 0.030 0.090 89.875 0.211\n15 0.010 0.170 82.815 0.268 39 0.030 0.170 85.510 0.249\n16 0.010 0.200 82.540 0.270 GM3 40 0.030 0.200 83.605 0.261\n17 0.005 0.050 71.860 0.223 41 0.070 0.050 87.790 0.234\n18 0.005 0.090 89.760 0.212 42 0.070 0.090 87.795 0.234\n19 0.005 0.170 85.045 0.259 43 0.070 0.170 85.310 0.251\n\nGM2 20 0.005 0.200 81.745 0.282 44 0.070 0.200 83.090 0.265\n21 0.030 0.050 79.475 0.215 45 0.010 0.050 82.805 0.268\n22 0.030 0.090 89.760 0.212 46 0.010 0.090 82.690 0.269\n23 0.030 0.170 85.045 0.259 47 0.010 0.170 82.740 0.269\n24 0.030 0.200 81.745 0.282 48 0.010 0.200 82.150 0.272\n\nanalysis and it was made in 25 locations. Results for coverage and MSE for these 25 locations are\npresented in Table 3.5. We can notice that the values for MSE are very similar for all the meshes, the\nresults are around 0.4. The values for coverage for the variable in 25 extra locations are not all so high\nas for 100 locations in the analysis, most meshes have coverage less than 80% and the mesh with highest\n\n\n\n36\n\ncoverage is mesh 17 (a = 0.05 and c = 0.005), from GM2. Mesh 6 obtained the lowest MSE (0.443) and\ncoverage of 83.22, being that the best value was 92.08%.\n\nTable 3.5. Nominal coverage, in %, and MSE for the variable Y na calculated for each mesh in 25\nlocations, considering 200 simulations, with random data set.\n\nGroup Mesh c a Coverage(%) MSE Group Mesh c a Coverage(%) MSE\n1 0.005 0.050 90.580 0.451 25 0.070 0.050 82.680 0.452\n2 0.005 0.090 80.620 0.452 26 0.070 0.090 83.240 0.451\n3 0.005 0.170 65.840 0.467 27 0.070 0.170 80.320 0.459\n4 0.005 0.200 61.900 0.473 GM2 28 0.070 0.200 76.000 0.466\n5 0.030 0.050 87.820 0.444 29 0.010 0.050 77.780 0.461\n6 0.030 0.090 83.220 0.443 30 0.010 0.090 77.020 0.462\n7 0.030 0.170 75.700 0.444 31 0.010 0.170 77.260 0.462\n\nGM1 8 0.030 0.200 72.920 0.448 32 0.010 0.200 77.380 0.461\n9 0.070 0.050 77.480 0.447 33 0.005 0.050 90.020 0.453\n\n10 0.070 0.090 77.660 0.446 34 0.005 0.090 84.400 0.447\n11 0.070 0.170 74.620 0.452 35 0.005 0.170 74.420 0.454\n12 0.070 0.200 71.060 0.454 36 0.005 0.200 70.680 0.461\n13 0.010 0.050 70.620 0.462 37 0.030 0.050 88.620 0.452\n14 0.010 0.090 70.060 0.463 38 0.030 0.090 84.380 0.447\n15 0.010 0.170 70.620 0.462 39 0.030 0.170 74.460 0.454\n16 0.010 0.200 70.080 0.464 GM3 40 0.030 0.200 70.640 0.461\n17 0.005 0.050 92.080 0.463 41 0.070 0.050 78.020 0.447\n18 0.005 0.090 87.720 0.451 42 0.070 0.090 78.240 0.446\n19 0.005 0.170 80.320 0.459 43 0.070 0.170 74.160 0.455\n\nGM2 20 0.005 0.200 76.000 0.466 44 0.070 0.200 70.080 0.461\n21 0.030 0.050 91.700 0.462 45 0.010 0.050 70.900 0.465\n22 0.030 0.090 87.720 0.451 46 0.010 0.090 70.800 0.464\n23 0.030 0.170 80.320 0.459 47 0.010 0.170 70.620 0.465\n24 0.030 0.200 76.000 0.466 48 0.010 0.200 70.680 0.466\n\nThe bias for the prediction in these 25 extra locations was calculated and ploted with boxplot,\nas we can see in Figure 3.1. The 48 boxplot for the values of bias are quite the same and we can notice\nthat there is no difference within and between the groups.\n\nFigure 3.1. Bias for Y in 25 extra locations, with random data set.\n\nThese results showed that there is a large impact of the mesh on the inference (parameter\nestimation and prediction) and it is was observed that there is not a single mesh which is optimal in\neverything. Therefore, we investigate whether we can use the predictive information criteria as described\nin Section 2.1, to select an optimal mesh.\n\nWe calculate the mean of DIC, WAIC and logCPO (Table 3.6) to perform mesh selection.\nMinimum values of DIC and WAIC occur with meshes from CM1 with c = 0.005 and occur negative\n\n\n\n37\n\nvalues for DIC and WAIC, as we can notice in Table 3.6. Disregarding negative values, the minimum\nvalues for DIC and WAIC occur with mesh 17 (35.877 and 43.257) and it is the mesh with more knots\n(2109 knots, Table 3.1). This does not occur for logCPO. Meshes 7 and 8 have minimum value for logCPO\n(1.279), followed by mesh 6 and other meshes, with value of 1.281. Mesh 6 has value 213.639 for DIC\nand 213.871 for WAIC.\n\nTable 3.6. Mean values of DIC, WAIC and logCPO for meshes with random data set .\nGroup Mesh c a DIC WAIC logCPO Group Mesh c a DIC WAIC logCPO\n\n1 0.005 0.050 -348.646 -347.352 1.935 25 0.070 0.050 242.810 244.572 1.283\n2 0.005 0.090 -387.573 -392.315 1.981 26 0.070 0.090 243.059 244.826 1.283\n3 0.005 0.170 -388.284 -394.420 1.965 27 0.070 0.170 247.626 249.531 1.287\n4 0.005 0.200 -383.974 -390.865 1.949 GM2 28 0.070 0.200 251.459 253.263 1.292\n5 0.030 0.050 170.092 176.546 1.316 29 0.010 0.050 249.753 251.548 1.288\n6 0.030 0.090 213.639 213.871 1.281 30 0.010 0.090 250.074 251.837 1.289\n7 0.030 0.170 222.671 222.477 1.279 31 0.010 0.170 250.767 252.612 1.292\n\nGM1 8 0.030 0.200 223.690 223.589 1.279 32 0.010 0.200 250.367 252.118 1.290\n9 0.070 0.050 241.802 242.580 1.281 33 0.005 0.050 90.609 103.326 1.411\n\n10 0.070 0.090 242.071 242.810 1.282 34 0.005 0.090 223.217 224.530 1.287\n11 0.070 0.170 245.125 245.932 1.284 35 0.005 0.170 246.560 247.588 1.284\n12 0.070 0.200 246.970 247.811 1.285 36 0.005 0.200 248.739 249.705 1.286\n13 0.010 0.050 249.704 250.704 1.288 37 0.030 0.050 163.988 169.977 1.331\n14 0.010 0.090 249.621 250.623 1.288 38 0.030 0.090 223.214 224.509 1.287\n15 0.010 0.170 249.675 250.683 1.288 39 0.030 0.170 246.600 247.616 1.284\n16 0.010 0.200 250.128 251.117 1.289 GM3 40 0.030 0.200 248.768 249.734 1.286\n17 0.005 0.050 35.877 43.257 1.487 41 0.070 0.050 242.290 243.264 1.281\n18 0.005 0.090 219.211 221.541 1.288 42 0.070 0.090 242.284 243.290 1.281\n19 0.005 0.170 247.626 249.531 1.287 43 0.070 0.170 247.018 248.037 1.285\n\nGM2 20 0.005 0.200 251.459 253.263 1.292 44 0.070 0.200 249.300 250.256 1.287\n21 0.030 0.050 110.325 115.101 1.400 45 0.010 0.050 249.623 250.653 1.287\n22 0.030 0.090 219.211 221.541 1.288 46 0.010 0.090 249.764 250.797 1.288\n23 0.030 0.170 247.626 249.531 1.287 47 0.010 0.170 249.805 250.854 1.288\n24 0.030 0.200 251.459 253.263 1.292 48 0.010 0.200 250.144 251.178 1.288\n\nTaking all the results into account (bias, MSE, coverage of parameter estimates and predictions),\nwe can consider that mesh 6 is the optimal one from random data set. In Figure 3.2 we can observe\nboxplots of parameter estimates based on the mesh with lowest DIC, WAIC or logCPO, obtained in each\nsimulation and for comparison, we also present in this figure the boxplots of the estimates obtained for\neach parameter with mesh 6.\n\nWe can observe that the boxplots obtained with mesh 6 are more similar to the boxplots\nobtained for the results of logCPO. Also, selection of the mesh using DIC and WAIC has bad performance,\nseen in the large bias of all covariance parameters. While the difference between the DIC, WAIC and\nlogCPO would be expected to behave similarly, sinse they are asymptotically the same, it is important\nto realize that all methods are only approximations of the predictive accuracy. While DIC and WAIC\ngive reasonable answers in many cases, they only attempt to capture the predictive behavior within the\nsample, whereas the logCPO captures also out-of-sample prediction error. So, it is confirmed that the\nlogCPO criterion is better suited for mesh selection.\n\n\n\n38\n\nFigure 3.2. Estimated ?0, ?1, ?2e , ?2s , k and ??, considering the meshes with minimal DIC, WAIC and\nlogCPO, and based on mesh 6 for random data set.\n\n\u2022 Regular data set\n\nAs previously stated, for regular data set we do not have the batches of 40 simulations, we\nonly have one simulated coordinate. So, Table 3.7 shows the number of knots in the mesh, for the three\ngroups. For regular data, meshes created with part of the coordinate (GM3), obtained smaller numbers\nof knots, when comparing with GM1 and GM2.\n\nTable 3.7. Number of knots for different combinations of the parameters a and c, with parameter b = 0.3\nfor regular data.\n\nc=0.005 c=0.03 c=0.07 c=0.10\nGM1 a=0.05 2211 1365 309 179\n\na=0.09 648 648 310 179\na=0.17 228 228 201 179\na=0.20 212 212 182 179\n\nGM2 a=0.05 2109 1586 370 208\na=0.09 727 727 369 208\na=0.17 252 252 252 209\na=0.20 212 212 212 206\n\nGM3 a=0.05 1925 1467 279 167\na=0.09 614 614 281 167\na=0.17 227 227 187 167\na=0.20 198 198 169 167\n\nThe values of the coverage (in %) for all the parameters (?0, ?1?2e , ?2s , k and ??) are summarized\non Table 3.8. In the Appendix B, Figure B.2 shows the coverage for all considered meshes. As we can\n\n\n\n39\n\nobserve in these table and figure, for ?0 and ?1, all meshes have good coverage. Observing the results\nfor the others parameters, we can notice that meshes from GM1 have bad results. In fact, for ?2e , all the\nmeshes from GM1 have 0% of coverage. Some meshes from GM2 also have 0% coverage for ?2e but meshes\n19, 23 and 27 obtained 35.5%. Meshes 35 and 39 (both from GM3) were the ones that obtained the best\nresult for this parameter: 41% for coverage . For ?2s , some meshes from GM1 obtained 0% of coverage,\nthe majority of the meshes of GM2 have good results and the best value for coverage is from mesh 46\n(GM3) and mesh 36 (GM2) with 96%. Meshes 19, 23, 27, 35 and 39 all obtained 95% of coverage for ?2s .\nThe results for parameter k are more homogeneous between the groups and mesh 31 was the one with\nbetter results, 90% of coverage. In the last column of the table are the results for ?? and we can observe\nthat the results are quite similar to the ones for k. The best value is for mesh 31 (90% of coverage).\nMeshes 19, 23 and 27 obatined 87% and meshes 35 and 39 obtained 84% both for k and ??.\n\nTable 3.8. Coverage, in %, of the 95% credible intervals of the parameters ?0, ?1, ?2e , ?2s , k and ?? for\ndifferent meshes with b = 0.3, for regular data set.\n\nCoverage in % for:\nGroup Mesh c a ?0 ?1 ?2e ?\n\n2\ns k ?\n\n?\n\n1 0.005 0.050 95.000 92.000 0.000 65.500 73.500 73.500\n2 0.005 0.090 95.500 91.500 0.000 31.500 63.000 63.500\n3 0.005 0.170 92.500 91.000 0.000 0.000 31.500 31.500\n4 0.005 0.200 93.000 92.500 0.000 0.000 33.500 34.000\n5 0.030 0.050 95.500 91.500 0.000 57.000 73.000 73.000\n6 0.030 0.090 95.500 91.500 0.000 31.500 63.000 63.500\n7 0.030 0.170 92.500 91.000 0.000 0.000 31.500 31.500\n\nGM1 8 0.030 0.200 93.000 92.500 0.000 0.000 33.500 34.000\n9 0.070 0.050 95.500 91.000 0.000 10.000 60.500 63.000\n\n10 0.070 0.090 95.500 91.500 0.000 9.000 59.500 60.500\n11 0.070 0.170 92.500 91.500 0.000 0.000 31.500 33.000\n12 0.070 0.200 92.500 91.500 0.000 0.500 34.000 36.000\n13 0.010 0.050 93.000 91.000 0.000 0.000 33.000 34.500\n14 0.010 0.090 93.000 91.000 0.000 0.000 33.000 34.500\n15 0.010 0.170 93.000 91.000 0.000 0.000 33.000 34.500\n16 0.010 0.200 93.000 91.000 0.000 0.000 33.000 34.500\n17 0.005 0.050 93.500 92.000 0.000 4.000 55.000 55.500\n18 0.005 0.090 93.500 92.500 0.000 0.000 37.500 37.500\n19 0.005 0.170 97.000 90.500 35.500 95.000 87.000 87.000\n20 0.005 0.200 97.000 91.500 15.500 95.500 87.500 87.000\n21 0.030 0.050 96.000 91.000 0.000 1.500 53.500 53.500\n22 0.030 0.090 93.500 92.500 0.000 0.000 37.500 37.500\n23 0.030 0.170 97.000 90.500 35.500 95.000 87.000 87.000\n\nGM2 24 0.030 0.200 97.000 91.500 15.500 95.500 87.500 87.000\n25 0.070 0.050 92.000 90.500 15.000 27.000 27.500 27.500\n26 0.070 0.090 93.000 90.500 17.500 33.000 33.500 34.000\n27 0.070 0.170 97.000 90.500 35.500 95.000 87.000 87.000\n28 0.070 0.200 97.000 91.500 15.500 95.500 87.500 87.000\n29 0.010 0.050 97.500 92.500 18.500 95.000 86.000 85.500\n30 0.010 0.090 96.000 92.500 24.500 94.000 86.000 86.000\n31 0.010 0.170 96.500 90.500 20.000 95.000 90.000 90.000\n32 0.010 0.200 96.500 91.000 20.500 96.000 88.000 88.000\n33 0.005 0.050 96.000 92.500 0.000 30.500 76.500 76.500\n34 0.005 0.090 96.500 90.000 0.000 1.500 65.500 65.500\n35 0.005 0.170 97.500 92.000 41.000 95.000 84.000 84.000\n36 0.005 0.200 97.500 92.500 35.000 95.000 84.000 84.000\n37 0.030 0.050 96.000 91.500 0.000 20.000 72.500 72.500\n38 0.030 0.090 96.500 90.000 0.000 1.500 65.500 65.500\n39 0.030 0.170 97.500 92.000 41.000 95.000 84.000 84.000\n\nGM3 40 0.030 0.200 97.500 92.500 35.000 95.000 84.000 84.000\n41 0.070 0.050 93.000 87.000 13.000 23.000 34.500 35.500\n42 0.070 0.090 92.500 88.000 8.000 15.500 32.500 34.000\n43 0.070 0.170 97.500 92.000 38.000 95.000 82.500 82.500\n44 0.070 0.200 96.500 92.500 36.000 95.500 83.500 83.500\n45 0.010 0.050 96.500 92.000 37.000 95.000 83.000 83.000\n46 0.010 0.090 97.000 91.500 34.500 96.000 83.500 83.500\n47 0.010 0.170 96.500 92.000 37.000 95.000 83.000 83.000\n48 0.010 0.200 96.500 92.000 37.000 95.000 83.000 83.000\n\nWe also calculated the bias for all the parameters and for the ratio ?\n2\ns\n\n?\n. These results are\n\npresented in Table 3.9 and as we can notice, for ?0 the values are very similar and for the parameter\n?1, meshes from GM2 have slightly better results. For ?2e , all meshes from GM1 have the same results,\nmeshes from GM2 have similar results and meshes 25 and 26 stand out with the lowest values of this\ngroup (0.155 and 0.126, respectively) and from GM3, the best one is mesh 41 with value of 0.167 for\ncoverage. The bias for ?2s have some high values and the lowest one is 0.103 from mesh 29. For the\nparameter k, big values for bias appear for meshes from GM1 and the lowest value is 0.028 of mesh 31.\nThe values for the bias are more homogeneous for parameter ?? and mesh 26 has the lowest value (0.013).\n\n\n\n40\n\nResults for the ratio ?\n2\ns\n\n?\ndo not differ much between the meshes. The lowest value of bias (0.008) for the\n\nratio was obtained with mesh 1. Although meshes 19, 23, 27, 35 and 39 did not obtained the best results\nof bias for either any parameter or the ratio, the results obtained was not so bad, compared with the best\nones.\n\nTable 3.9. Absolute bias of the parameters ?0, ?1, ?2e , ?2s , k and ?? and for\n?2s\n?\n\n, considering all meshes\nwith regular data set.\n\nBias for:\n\nGroup Mesh c a ?0 ?1 ?2e ?\n2\ns k ?\n\n? ?\n2\ns\n?\n\n1 0.005 0.050 0.015 0.009 0.300 0.380 8.246 0.044 0.008\n2 0.005 0.090 0.015 0.009 0.300 1.266 10.831 0.049 0.018\n3 0.005 0.170 0.015 0.005 0.300 1.710 11.672 0.085 0.052\n4 0.005 0.200 0.015 0.007 0.300 2.363 13.660 0.086 0.063\n5 0.030 0.050 0.014 0.010 0.300 0.418 7.170 0.038 0.015\n6 0.030 0.090 0.015 0.009 0.300 1.266 10.831 0.049 0.018\n7 0.030 0.170 0.015 0.005 0.300 1.710 11.672 0.085 0.052\n\nGM1 8 0.030 0.200 0.015 0.007 0.300 2.363 13.660 0.086 0.063\n9 0.070 0.050 0.014 0.011 0.300 2.187 10.991 0.042 0.053\n\n10 0.070 0.090 0.014 0.012 0.300 1.981 9.727 0.041 0.051\n11 0.070 0.170 0.015 0.006 0.300 2.786 13.740 0.085 0.058\n12 0.070 0.200 0.017 0.005 0.300 5.736 15.966 0.084 0.073\n13 0.010 0.050 0.017 0.005 0.300 5.357 17.596 0.086 0.078\n14 0.010 0.090 0.017 0.005 0.300 5.357 17.596 0.086 0.078\n15 0.010 0.170 0.017 0.005 0.300 5.357 17.596 0.086 0.078\n16 0.010 0.200 0.017 0.005 0.300 5.357 17.596 0.086 0.078\n17 0.005 0.050 0.015 0.007 0.300 0.791 9.115 0.067 0.025\n18 0.005 0.090 0.015 0.005 0.300 2.015 13.050 0.083 0.054\n19 0.005 0.170 0.018 0.009 0.248 0.257 0.119 0.164 0.081\n20 0.005 0.200 0.022 0.002 0.319 0.177 0.110 0.182 0.076\n21 0.030 0.050 0.013 0.011 0.300 0.691 8.119 0.070 0.027\n22 0.030 0.090 0.015 0.005 0.300 2.015 13.050 0.083 0.054\n23 0.030 0.170 0.018 0.009 0.248 0.257 0.119 0.164 0.081\n\nGM2 24 0.030 0.200 0.022 0.002 0.319 0.177 0.110 0.182 0.076\n25 0.070 0.050 0.014 0.008 0.155 4.720 19.477 0.036 0.123\n26 0.070 0.090 0.015 0.009 0.126 9.635 21.615 0.013 0.141\n27 0.070 0.170 0.018 0.009 0.248 0.257 0.119 0.164 0.081\n28 0.070 0.200 0.022 0.002 0.319 0.177 0.110 0.182 0.076\n29 0.010 0.050 0.019 0.008 0.316 0.103 0.388 0.208 0.073\n30 0.010 0.090 0.018 0.008 0.301 0.242 0.409 0.185 0.077\n31 0.010 0.170 0.018 0.009 0.306 0.176 0.028 0.168 0.067\n32 0.010 0.200 0.019 0.010 0.305 0.169 0.030 0.175 0.070\n33 0.005 0.050 0.013 0.013 0.300 0.326 4.011 0.044 0.022\n34 0.005 0.090 0.013 0.011 0.300 1.107 6.607 0.052 0.056\n35 0.005 0.170 0.014 0.014 0.238 0.139 2.763 0.241 0.076\n36 0.005 0.200 0.014 0.012 0.258 0.153 2.846 0.246 0.076\n37 0.030 0.050 0.013 0.012 0.300 0.480 6.321 0.046 0.026\n38 0.030 0.090 0.013 0.011 0.300 1.107 6.607 0.052 0.056\n39 0.030 0.170 0.014 0.014 0.238 0.139 2.763 0.241 0.076\n\nGM3 40 0.030 0.200 0.014 0.012 0.258 0.153 2.846 0.246 0.076\n41 0.070 0.050 0.009 0.020 0.167 2.987 12.030 0.018 0.090\n42 0.070 0.090 0.012 0.015 0.210 2.559 11.241 0.026 0.085\n43 0.070 0.170 0.013 0.015 0.249 0.153 2.811 0.245 0.077\n44 0.070 0.200 0.014 0.013 0.256 0.151 2.725 0.244 0.075\n45 0.010 0.050 0.013 0.013 0.254 0.148 2.752 0.243 0.075\n46 0.010 0.090 0.013 0.013 0.263 0.142 2.784 0.262 0.083\n47 0.010 0.170 0.013 0.013 0.254 0.148 2.768 0.243 0.075\n48 0.010 0.200 0.013 0.013 0.254 0.148 2.768 0.243 0.075\n\nTable B.2 from the Appendix B shows the results of MSE for the parameters and the ratio,\nwith regular data set. The results are quite similar to the ones obtained for the bias. There is no mesh\nthat stands out for the values of MSE for ?0 and ?1. For ?2e , meshes 25 and 26 were the best ones, with\nMSE of 0.085, followed by meshes 35 and 39, with value of 0.086. The values of MSE for the parameter\n?2s are very high for some meshes and the lowest value is 0.120 obtained with meshes 35 and 39. The\nbest value of MSE for k was 34.614 with mesh 33, followed by 37.899 with meshes 35 and 39. Most of all\nthe other meshes have very high values. For the nominal range, the lowest results was 0.004 with mesh\n33, followed by 0.005 with several meshes, including meshes 35 and 39. The value of MSE for the ratio\nwas similar between the meshes, the best results (0.004) with meshes 17 andd 21. For values of MSE,\nmeshes 35 and 39 have better results than meshes 19, 23 and 27.\n\nWe also calculated the coverage (in %) and MSE of prediction in the 100 coordinate of sample\nlocations to investigate the impact of the mesh on the predictive performance of the model. Table 3.10\nshows these results and we can notice that the values of coverage for meshes fom GM1 are very low,\nmeshes form GM2 with small values of a (0.05 and 0.09) with small values of c (0.005 and 0.03) also have\nlow value for coverage and the same occur for these configuration of meshes from GM3. The best result\n\n\n\n41\n\nfor coverage is 86.765% with meshes 35 and 39, meshes 19,23 and 27 obatined 85.720%. For MSE, all\nmeshes have similar results.\n\nTable 3.10. Nominal coverage, in %, and MSE for the variable Y calculated for each mesh, considering\n200 simulations, with regular data set.\n\nGroup Mesh c a Coverage(%) MSE Group Mesh c a Coverage(%) MSE\n1 0.005 0.050 3.100 0.301 25 0.070 0.050 28.510 0.295\n2 0.005 0.090 3.040 0.301 26 0.070 0.090 33.290 0.294\n3 0.005 0.170 2.980 0.301 27 0.070 0.170 85.720 0.307\n4 0.005 0.200 2.980 0.301 GM2 28 0.070 0.200 80.830 0.348\n5 0.030 0.050 3.065 0.301 29 0.010 0.050 80.760 0.347\n6 0.030 0.090 3.040 0.301 30 0.010 0.090 81.920 0.339\n7 0.030 0.170 2.980 0.301 31 0.010 0.170 82.300 0.340\n\nGM1 8 0.030 0.200 2.980 0.301 32 0.010 0.200 81.430 0.342\n9 0.070 0.050 2.990 0.301 33 0.005 0.050 3.125 0.301\n\n10 0.070 0.090 3.000 0.301 34 0.005 0.090 3.075 0.301\n11 0.070 0.170 2.965 0.301 35 0.005 0.170 86.765 0.300\n12 0.070 0.200 2.980 0.301 36 0.005 0.200 85.730 0.310\n13 0.010 0.050 2.975 0.301 37 0.030 0.050 3.105 0.301\n14 0.010 0.090 2.975 0.301 38 0.030 0.090 3.075 0.301\n15 0.010 0.170 2.975 0.301 39 0.030 0.170 86.765 0.300\n16 0.010 0.200 2.975 0.301 GM3 40 0.030 0.200 85.730 0.310\n17 0.005 0.050 3.105 0.301 41 0.070 0.050 25.660 0.301\n18 0.005 0.090 3.035 0.301 42 0.070 0.090 17.400 0.302\n19 0.005 0.170 85.720 0.307 43 0.070 0.170 86.345 0.305\n\nGM2 20 0.005 0.200 80.830 0.348 44 0.070 0.200 85.880 0.309\n21 0.030 0.050 3.085 0.301 45 0.010 0.050 85.870 0.307\n22 0.030 0.090 3.035 0.301 46 0.010 0.090 85.670 0.312\n23 0.030 0.170 85.720 0.307 47 0.010 0.170 85.875 0.307\n24 0.030 0.200 80.830 0.348 48 0.010 0.200 85.875 0.307\n\nThe predictive performance of the model was also investigated for locations not used in the\nanalysis and it was made in 25 locations, randomly selected. These results for coverage and MSE are\npresented in Table 3.11. We can observe that the values for coverage for these 25 extra locations are\nmore homogeneous than for the coverage for the sample set. The best value (90.5%) was obtained with\nmesh 17. Meshes 19, 23 and 27 obtained 75.580% while meshes 35 and 39 obtained 70.720%. For MSE\nvalues, there is no mesh that stands out from the rest.\n\nTable 3.11. Nominal coverage, in %, and MSE for the variable Y na calculated for each mesh in 25\nlocations, considering 200 simulations, with regular data set.\n\nGroup Mesh c a Coverage(%) MSE Group Mesh c a Coverage(%) MSE\n1 0.005 0.050 88.480 0.435 25 0.070 0.050 72.420 0.599\n2 0.005 0.090 78.840 0.447 26 0.070 0.090 71.960 0.605\n3 0.005 0.170 19.720 0.504 27 0.070 0.170 75.580 0.463\n4 0.005 0.200 19.840 0.504 GM2 28 0.070 0.200 72.880 0.460\n5 0.030 0.050 84.720 0.439 29 0.010 0.050 74.500 0.463\n6 0.030 0.090 78.840 0.447 30 0.010 0.090 75.880 0.461\n7 0.030 0.170 19.720 0.504 31 0.010 0.170 73.980 0.460\n\nGM1 8 0.030 0.200 19.840 0.504 32 0.010 0.200 74.840 0.465\n9 0.070 0.050 60.300 0.467 33 0.005 0.050 89.680 0.440\n\n10 0.070 0.090 60.220 0.467 34 0.005 0.090 78.180 0.499\n11 0.070 0.170 19.860 0.504 35 0.005 0.170 70.720 0.445\n12 0.070 0.200 19.840 0.504 36 0.005 0.200 70.140 0.447\n13 0.010 0.050 19.820 0.504 37 0.030 0.050 87.860 0.447\n14 0.010 0.090 19.820 0.504 38 0.030 0.090 78.180 0.499\n15 0.010 0.170 19.820 0.504 39 0.030 0.170 70.720 0.445\n16 0.010 0.200 19.820 0.504 GM3 40 0.030 0.200 70.140 0.447\n17 0.005 0.050 90.500 0.466 41 0.070 0.050 60.040 0.560\n18 0.005 0.090 85.280 0.493 42 0.070 0.090 59.320 0.571\n19 0.005 0.170 75.580 0.463 43 0.070 0.170 70.800 0.444\n\nGM2 20 0.005 0.200 72.880 0.460 44 0.070 0.200 69.840 0.446\n21 0.030 0.050 89.320 0.468 45 0.010 0.050 69.960 0.446\n22 0.030 0.090 85.280 0.493 46 0.010 0.090 70.140 0.448\n23 0.030 0.170 75.580 0.463 47 0.010 0.170 69.960 0.446\n24 0.030 0.200 72.880 0.460 48 0.010 0.200 69.960 0.446\n\nThe bias for the prediction in these 25 extra locations was calculated and ploted with individual\nboxplot for each mesh, as we can see in Figure 3.3. All the boxplots for the values of bias are quite the\nsame and we can notice that there is no difference between groups and nor among groups. Boxplot of\nmeshes with c = 0.10 tends to be more homogeneous.\n\n\n\n42\n\nFigure 3.3. Bias for Y in 25 extra locations, with regular data set.\n\nAs for the random data set, we can observe that these results showed that there is a large\nimpact of the mesh on parameter estimation and prediction and there is not a single mesh which is\noptimal in everything. So, to select an optimal mesh, we calculate the mean of DIC, WAIC and logCPO\nand these results are in Table 3.12. We can notice that, despite only meshes 1 and 5 have more than one\nthousan knots, all meshes from GM1 have similar results for DIC and WAIC and are among the lowest\nvalues. But, meshes from this gruop did not have any good results. Considering logCPO, the best value\nwas 1.361 from meshes 30 and 32. Meshe 19, 23 and 27 obtained 254.947(DIC), 258.455 (WAIC) and\n1.364 (logCPO). Meshes 35 and 39, obtained 1.367 for logCPO and for DIC and WAIC, this two meshes\nobtained 256.932 and 258.662, respectively. The three meshes from GM2 have better results.\n\nMeshes 19, 23 and 27 have all the same results and in fact, have the same number of knots\nand the same occur withe meshes 35 and 39 between them. If we consider all the results of bias, MSE,\ncoverage of parameter estimates, predictions and also DIC, WAIC and logCPO we can assume that the\nthrees meshes form GM2 are the optimals ones.\n\nTable 3.12. Mean values of DIC, WAIC and logCPO for meshes with regular data set .\nGroup Mesh c a DIC WAIC logCPO Group Mesh c a DIC WAIC logCPO\n\n1 0.005 0.050 -579.196 -592.839 2.312 25 0.070 0.050 -335.895 -345.227 2.370\n2 0.005 0.090 -580.335 -594.935 2.391 26 0.070 0.090 -286.396 -294.157 2.274\n3 0.005 0.170 -582.154 -598.045 2.474 27 0.070 0.170 254.947 258.455 1.364\n4 0.005 0.200 -582.022 -597.948 2.475 GM2 28 0.070 0.200 264.722 266.418 1.363\n5 0.030 0.050 -579.478 -593.444 2.336 29 0.010 0.050 264.149 265.766 1.362\n6 0.030 0.090 -580.335 -594.935 2.391 30 0.010 0.090 262.865 264.600 1.361\n7 0.030 0.170 -582.154 -598.045 2.474 31 0.010 0.170 263.674 265.591 1.363\n\nGM1 8 0.030 0.200 -582.022 -597.948 2.475 32 0.010 0.200 263.287 264.924 1.361\n9 0.070 0.050 -581.576 -597.302 2.502 33 0.005 0.050 -579.016 -592.257 2.340\n\n10 0.070 0.090 -581.712 -597.473 2.477 34 0.005 0.090 -579.656 -593.857 2.471\n11 0.070 0.170 -582.055 -598.090 2.467 35 0.005 0.170 256.932 258.662 1.367\n12 0.070 0.200 -582.052 -597.709 2.471 36 0.005 0.200 259.909 261.429 1.367\n13 0.010 0.050 -581.955 -598.152 2.481 37 0.030 0.050 -579.043 -592.596 2.363\n14 0.010 0.090 -581.955 -598.152 2.481 38 0.030 0.090 -579.656 -593.857 2.471\n15 0.010 0.170 -581.955 -598.152 2.481 39 0.030 0.170 256.932 258.662 1.367\n16 0.010 0.200 -581.955 -598.152 2.481 GM3 40 0.030 0.200 259.909 261.429 1.367\n17 0.005 0.050 -579.227 -592.826 2.339 41 0.070 0.050 -355.104 -365.382 2.382\n18 0.005 0.090 -580.254 -594.793 2.410 42 0.070 0.090 -436.668 -448.883 2.511\n19 0.005 0.170 254.947 258.455 1.364 43 0.070 0.170 258.444 260.108 1.367\n\nGM2 20 0.005 0.200 264.722 266.418 1.363 44 0.070 0.200 259.794 261.287 1.368\n21 0.030 0.050 -579.273 -593.235 2.336 45 0.010 0.050 259.219 260.790 1.367\n22 0.030 0.090 -580.254 -594.793 2.410 46 0.010 0.090 259.749 261.360 1.368\n23 0.030 0.170 254.947 258.455 1.364 47 0.010 0.170 259.219 260.790 1.367\n24 0.030 0.200 264.722 266.418 1.363 48 0.010 0.200 259.219 260.790 1.367\n\nIn Figure 3.4 we can observe boxplots of parameter estimates based on the mesh with lowest\nDIC, WAIC or logCPO, obtained in each simulation and we also present in this figure the boxplots of\n\n\n\n43\n\nthe estimates obtained for each parameter with mesh 19.\nWe can observe that the boxplots obtained with mesh 19 are more similar to the boxplots\n\nobtained for the results of logCPO. Also, selection of the mesh using DIC and WAIC has bad performance,\nseen in the large bias of all covariance parameters. In this case, DIC and WAIC tends to select not only\nmore denses meshes but also the ones with really bad results.\n\nFigure 3.4. Estimated ?0, ?1, ?2e , ?2s , k and ??, considering the meshes with minimal DIC, WAIC and\nlogCPO, and based on mesh 19 for regular data set.\n\n\u2022 Cluster data set\n\nAs same as for random data set, for cluster data we conduct the simulation in five batches of\n40 simulations and within one batch the coordinates are kept fixed, resulting in 200 simulation. Table\n3.13 shows the average number of knots for each mesh. .\n\n\n\n44\n\nTable 3.13. Average number of knots for different combinations of the parameters a and c, with\nparameter b = 0.3 for cluster data.\n\nc=0.005 c=0.03 c=0.07 c=0.10\nGM1 a=0.05 1539 1143 265 145\n\na=0.09 587 550 265 143\na=0.17 346 281 199 143\na=0.20 333 265 166 140\n\nGM2 a=0.05 2109 1586 370 208\na=0.09 727 727 369 208\na=0.17 252 252 252 209\na=0.20 212 212 212 206\n\nGM3 a=0.05 1524 1147 262 143\na=0.09 550 548 263 142\na=0.17 250 247 195 142\na=0.20 227 223 162 138\n\nFor ?0, ?1?2e , ?2s , k and ??, we calculated values for coverage and summarized the results in\nTable 3.14 and in the Appendix B, Figure B.3 shows the values of coverage.. The results for cluster data\nset are very similar to the results for random data. Values of coverage for ?0 and ?1 are very similiar\namongst the meshes. For ?2e , the parameter more critical for coverage, mesh 5 has the best results of\n86.500%, For ?2s , k and ??, the results are quite homogeneous between meshes, although the meshes with\nc = 0.005 from GM1 stand out with very low results. The best results for ?2s is 98.5% with mesh 5; mesh\n31 got the best value of 98.5% for the parameter k and the best results of coverage for ?? was 89.5% with\nmesh 37.\n\nExcluding ?0 and ?1, we have four parameters and three meshes with good results: mesh 5, 31\nand 37. Looking for the results of these three meshes, mesh 31 is not efficient in covering ?2e . Meshes 5\nand 37 have very similar results. It is worth mentioning that both have the same value for a = 0.05 and\nc = 0.03.\n\n\n\n45\n\nTable 3.14. Coverage, in %, of the 95% credible intervals of the parameters ?0, ?1, ?2e , ?2s , k and ?? for\ndifferent meshes with b = 0.3, for cluster data set.\n\nCoverage in % for:\nGroup Mesh c a ?0 ?1 ?2e ?\n\n2\ns k ?\n\n?\n\n1 0.005 0.050 89.500 87.000 28.500 59.000 31.000 31.000\n2 0.005 0.090 89.000 84.000 22.500 33.500 25.500 25.500\n3 0.005 0.170 91.500 86.500 23.000 27.500 28.500 28.500\n4 0.005 0.200 93.000 87.000 22.500 27.500 32.000 32.000\n5 0.030 0.050 97.000 93.000 86.500 98.500 86.500 86.000\n6 0.030 0.090 97.500 93.500 84.500 98.000 87.500 87.500\n7 0.030 0.170 96.500 94.000 80.500 96.000 86.000 86.000\n\nGM1 8 0.030 0.200 97.000 93.500 80.000 97.000 88.000 88.000\n9 0.070 0.050 96.000 93.500 56.000 97.000 83.500 83.500\n\n10 0.070 0.090 95.500 93.500 58.500 97.000 83.000 83.000\n11 0.070 0.170 97.500 92.500 35.500 97.000 80.000 80.000\n12 0.070 0.200 97.000 93.500 33.500 96.000 82.000 82.000\n13 0.010 0.050 98.000 93.500 24.000 95.500 79.000 78.500\n14 0.010 0.090 98.000 93.500 21.000 95.000 79.000 79.000\n15 0.010 0.170 97.500 94.000 23.000 95.500 80.500 80.000\n16 0.010 0.200 98.000 93.500 18.000 93.000 82.500 82.500\n17 0.005 0.050 96.500 92.000 81.000 88.000 82.000 82.000\n18 0.005 0.090 96.500 92.500 73.000 92.000 85.000 85.000\n19 0.005 0.170 98.000 94.500 27.000 86.000 83.000 83.000\n20 0.005 0.200 99.000 94.000 16.500 88.000 85.500 86.000\n21 0.030 0.050 96.500 93.500 81.000 91.500 87.500 87.500\n22 0.030 0.090 96.500 92.500 73.000 92.000 85.000 85.000\n23 0.030 0.170 98.000 94.500 27.000 86.000 83.000 83.000\n\nGM2 24 0.030 0.200 99.000 94.000 16.500 88.000 85.500 86.000\n25 0.070 0.050 97.000 92.000 45.000 88.500 85.500 85.500\n26 0.070 0.090 96.500 92.000 47.500 89.000 84.500 84.500\n27 0.070 0.170 98.000 94.500 27.000 86.000 83.000 83.000\n28 0.070 0.200 99.000 94.000 16.500 88.000 85.500 86.000\n29 0.010 0.050 97.000 93.000 17.000 86.000 82.500 81.500\n30 0.010 0.090 96.500 92.500 21.000 83.500 85.000 85.000\n31 0.010 0.170 98.000 93.000 22.500 87.000 88.500 88.500\n32 0.010 0.200 98.000 92.500 21.500 86.500 83.500 83.500\n33 0.005 0.050 96.500 93.500 83.000 93.000 86.500 86.000\n34 0.005 0.090 98.000 93.000 78.500 97.500 86.500 86.500\n35 0.005 0.170 97.000 93.500 39.500 96.500 84.500 84.000\n36 0.005 0.200 96.000 93.000 35.000 95.500 79.500 79.500\n37 0.030 0.050 97.000 93.500 83.000 96.000 89.500 89.500\n38 0.030 0.090 98.000 93.000 78.500 97.500 86.500 86.500\n39 0.030 0.170 97.000 93.500 39.500 96.500 84.500 84.500\n\nGM3 40 0.030 0.200 96.000 93.000 35.000 96.000 79.000 79.500\n41 0.070 0.050 98.000 92.500 47.000 96.500 81.000 81.000\n42 0.070 0.090 98.000 93.000 48.500 97.000 82.000 81.500\n43 0.070 0.170 97.000 92.500 35.500 95.000 80.500 80.500\n44 0.070 0.200 96.500 93.000 29.500 94.500 81.000 81.000\n45 0.010 0.050 98.500 91.500 18.500 96.000 85.500 85.500\n46 0.010 0.090 98.500 92.000 19.500 95.500 84.500 84.000\n47 0.010 0.170 98.500 91.500 17.500 96.000 85.500 85.500\n48 0.010 0.200 98.500 91.500 17.500 95.000 85.000 85.000\n\nBesides the coverage, we also calculated the values for bias for the six parameters and for the\nratio ?\n\n2\ns\n\n?\n. Table 3.15 shows this results and we can observe that no huge difference appears for ?0 and\n\n?1. For ?2e , the best result occur with mesh 33 with value of 0.001. For ?2e , mesh 5 obtain 0.006 of bias\nand mesh 37 got 0.018. For the parameter ?2s the best result (0.002) was with mesh 5; mesh 37 obtain\n0.039. For parameter k, the values of bias are more different between the meshes. The best result was\n0.066 with mesh 34; mesh 5 got 1.034 and for mesh 37 it was 1.274. The value of bias for ?? was best\nwith meshes 3 and 4 with value of 0.027. For this parameter, bias with mesh 5 was 0.071 and with mesh\n37 was 0.065. The results for the ratio ?\n\n2\ns\n\n?\nare not very different between the meshes; meshes from GM1\n\nwith c = 0.005 obtain better results and the best one was 0.003 with mesh 2. For the ratio, mesh 5 got\n0.051 and mesh 37 got 0.050. In general, considering values of bias, mesh 5 was better than mesh 37.\n\nTable B.3 from the Appendix B shows the results of MSE for the parameters and the ratio.\nThis value for ?0 and ?1 are very similar for all meshes, also for ?2e . The best result (0.015) of MSE for\n?2e was with mesh 6. Mesh 5 got 0.016 and mesh 37 got 0.017. For the parameter ?2s , the lowest value\nwas 0.052 with mesh 5 and mesh 37 got 0.093. Values of MSE for k are very high and the best one was\n60.188 with mesh 7. Meshes 5 and 37 obtained 117.775 and 93.509, respectively. For ??, the best value\nwas 0.028 with mesh 2. Value for mesh 5 and mesh 37 was 0.037 and 0.042, in this order. MSE for the\nratio has tittle change between the meshes and the lowest value was 0.010 with mesh 4 and for meshes 5\nand 37 the values was 0.023 and 0.027, respectively. Again meshe 5 has slightly better results than mesh\n37.\n\nValues for coverage and MSE was calculated to evaluate prediction in the 100 coordinate of\n\n\n\n46\n\nTable 3.15. Absolute bias of the parameters ?0, ?1, ?2e , ?2s , k and ?? and for\n?2s\n?\n\n, considering all meshes\nwith cluster data set.\n\nBias for:\n\nGroup Mesh c a ?0 ?1 ?2e ?\n2\ns k ?\n\n? ?\n2\ns\n?\n\n1 0.005 0.050 0.009 0.027 0.219 0.216 12.153 0.047 0.012\n2 0.005 0.090 0.005 0.029 0.228 0.361 10.745 0.051 0.003\n3 0.005 0.170 0.007 0.029 0.216 0.492 7.078 0.027 0.033\n4 0.005 0.200 0.010 0.025 0.214 0.510 6.286 0.027 0.034\n5 0.030 0.050 0.013 0.016 0.006 0.002 1.034 0.071 0.051\n6 0.030 0.090 0.014 0.015 0.046 0.016 0.313 0.096 0.064\n7 0.030 0.170 0.014 0.016 0.064 0.029 0.350 0.106 0.076\n\nGM1 8 0.030 0.200 0.015 0.017 0.065 0.036 0.508 0.099 0.073\n9 0.070 0.050 0.011 0.024 0.145 0.046 0.505 0.125 0.081\n\n10 0.070 0.090 0.011 0.025 0.145 0.048 0.603 0.126 0.080\n11 0.070 0.170 0.013 0.022 0.173 0.053 0.522 0.129 0.085\n12 0.070 0.200 0.013 0.023 0.182 0.079 0.512 0.124 0.087\n13 0.010 0.050 0.015 0.024 0.210 0.258 2.124 0.138 0.102\n14 0.010 0.090 0.014 0.024 0.213 0.257 2.032 0.137 0.101\n15 0.010 0.170 0.015 0.023 0.210 0.247 1.986 0.140 0.105\n16 0.010 0.200 0.014 0.023 0.219 0.265 2.094 0.137 0.104\n17 0.005 0.050 0.013 0.011 0.010 0.132 2.746 0.058 0.059\n18 0.005 0.090 0.011 0.019 0.088 0.172 1.828 0.089 0.078\n19 0.005 0.170 0.010 0.019 0.200 0.551 3.424 0.111 0.127\n20 0.005 0.200 0.013 0.016 0.236 0.527 2.780 0.118 0.125\n21 0.030 0.050 0.014 0.011 0.035 0.138 2.383 0.067 0.065\n22 0.030 0.090 0.011 0.019 0.088 0.172 1.828 0.089 0.078\n23 0.030 0.170 0.010 0.019 0.200 0.551 3.424 0.111 0.127\n\nGM2 24 0.030 0.200 0.013 0.016 0.236 0.527 2.780 0.118 0.125\n25 0.070 0.050 0.014 0.017 0.161 0.339 2.267 0.102 0.097\n26 0.070 0.090 0.010 0.022 0.157 0.345 3.052 0.089 0.090\n27 0.070 0.170 0.010 0.019 0.200 0.551 3.424 0.111 0.127\n28 0.070 0.200 0.013 0.016 0.236 0.527 2.780 0.118 0.125\n29 0.010 0.050 0.010 0.021 0.232 0.699 4.141 0.110 0.141\n30 0.010 0.090 0.013 0.015 0.224 0.646 3.723 0.108 0.120\n31 0.010 0.170 0.014 0.016 0.224 0.563 3.705 0.097 0.116\n32 0.010 0.200 0.012 0.019 0.226 0.688 4.129 0.110 0.128\n33 0.005 0.050 0.012 0.019 0.001 0.053 2.364 0.056 0.046\n34 0.005 0.090 0.015 0.017 0.083 0.007 0.066 0.100 0.066\n35 0.005 0.170 0.015 0.018 0.172 0.043 0.542 0.127 0.086\n36 0.005 0.200 0.014 0.019 0.183 0.143 1.348 0.125 0.093\n37 0.030 0.050 0.013 0.019 0.018 0.039 1.274 0.065 0.050\n38 0.030 0.090 0.015 0.017 0.083 0.007 0.091 0.101 0.067\n39 0.030 0.170 0.015 0.018 0.172 0.045 0.574 0.127 0.086\n\nGM3 40 0.030 0.200 0.014 0.019 0.182 0.138 1.285 0.125 0.093\n41 0.070 0.050 0.016 0.019 0.152 0.041 0.402 0.127 0.083\n42 0.070 0.090 0.016 0.018 0.150 0.039 0.412 0.126 0.082\n43 0.070 0.170 0.016 0.019 0.176 0.122 1.548 0.122 0.094\n44 0.070 0.200 0.015 0.019 0.192 0.220 1.886 0.125 0.098\n45 0.010 0.050 0.014 0.023 0.216 0.171 1.278 0.134 0.107\n46 0.010 0.090 0.015 0.022 0.215 0.173 1.272 0.135 0.108\n47 0.010 0.170 0.014 0.024 0.215 0.177 1.330 0.134 0.107\n48 0.010 0.200 0.015 0.023 0.218 0.226 1.829 0.128 0.106\n\nsample locations. Meshes with c = 0.005 from GM1 obtained the worst result for coverage. The best\nvalue was 91.550 % with mesh 5, mesh 37 obtained 90.600%. For MSE, values were very similar and the\nbest one was 0.189 with mesh 5.\n\nTable 3.16. Nominal coverage, in %, and MSE for the variable Y calculated for each mesh, considering\n200 simulations, with cluster data set.\n\nGroup Mesh c a Coverage(%) MSE Group Mesh c a Coverage(%) MSE\n1 0.005 0.050 36.975 0.263 25 0.070 0.050 85.855 0.232\n2 0.005 0.090 34.060 0.267 26 0.070 0.090 85.990 0.230\n3 0.005 0.170 34.820 0.265 27 0.070 0.170 82.375 0.255\n4 0.005 0.200 36.060 0.264 GM2 28 0.070 0.200 78.720 0.278\n5 0.030 0.050 91.550 0.189 29 0.010 0.050 78.825 0.273\n6 0.030 0.090 91.290 0.191 30 0.010 0.090 79.805 0.269\n7 0.030 0.170 90.525 0.196 31 0.010 0.170 79.650 0.269\n\nGM1 8 0.030 0.200 90.710 0.196 32 0.010 0.200 79.745 0.269\n9 0.070 0.050 86.380 0.223 33 0.005 0.050 87.985 0.194\n\n10 0.070 0.090 86.325 0.223 34 0.005 0.090 90.135 0.201\n11 0.070 0.170 84.120 0.237 35 0.005 0.170 83.660 0.238\n12 0.070 0.200 82.995 0.242 36 0.005 0.200 82.725 0.244\n13 0.010 0.050 80.220 0.260 37 0.030 0.050 90.600 0.192\n14 0.010 0.090 79.890 0.262 38 0.030 0.090 90.120 0.201\n15 0.010 0.170 80.180 0.260 39 0.030 0.170 83.650 0.238\n16 0.010 0.200 79.355 0.265 GM3 40 0.030 0.200 82.750 0.244\n17 0.005 0.050 89.090 0.195 41 0.070 0.050 85.570 0.227\n18 0.005 0.090 90.030 0.204 42 0.070 0.090 85.815 0.226\n19 0.005 0.170 82.375 0.255 43 0.070 0.170 82.635 0.241\n\nGM2 20 0.005 0.200 78.720 0.278 44 0.070 0.200 81.355 0.249\n21 0.030 0.050 91.115 0.194 45 0.010 0.050 79.820 0.263\n22 0.030 0.090 90.030 0.204 46 0.010 0.090 79.715 0.262\n23 0.030 0.170 82.375 0.255 47 0.010 0.170 79.795 0.263\n24 0.030 0.200 78.720 0.278 48 0.010 0.200 79.510 0.264\n\n\n\n47\n\nFor 25 locations not used in the analysis and randomly chosen, we also calcultaed the predictive\nperformance of the model. Table 3.17 presents the results for coverage and MSE for this 25 extra locations.\nThe best value for coverage was 91.320% with mesh 17 from GM2; meshes 5 and 37 obtained 88.260%\nand 88.800%, respectively. Values for MSE did not differ greatly between groups nor among groups. The\nlowest value was 0.458 with meshes 6, 34, 37 and 38; mesh 5 got 0.459.\n\nTable 3.17. Nominal coverage, in %, and MSE for the variable Y na calculated for each mesh in 25\nlocations, considering 200 simulations, with cluster data set.\n\nGroup Mesh c a Coverage(%) MSE Group Mesh c a Coverage(%) MSE\n1 0.005 0.050 90.920 0.471 25 0.070 0.050 82.200 0.471\n2 0.005 0.090 82.560 0.473 26 0.070 0.090 82.400 0.470\n3 0.005 0.170 67.600 0.486 27 0.070 0.170 80.760 0.473\n4 0.005 0.200 63.680 0.493 GM2 28 0.070 0.200 78.600 0.480\n5 0.030 0.050 88.260 0.459 29 0.010 0.050 78.180 0.481\n6 0.030 0.090 84.520 0.458 30 0.010 0.090 76.660 0.486\n7 0.030 0.170 77.160 0.461 31 0.010 0.170 77.360 0.488\n\nGM1 8 0.030 0.200 75.420 0.461 32 0.010 0.200 76.960 0.485\n9 0.070 0.050 79.680 0.466 33 0.005 0.050 89.460 0.460\n\n10 0.070 0.090 79.820 0.465 34 0.005 0.090 85.220 0.458\n11 0.070 0.170 75.500 0.470 35 0.005 0.170 76.000 0.467\n12 0.070 0.200 73.360 0.469 36 0.005 0.200 73.160 0.467\n13 0.010 0.050 73.620 0.475 37 0.030 0.050 88.800 0.458\n14 0.010 0.090 73.460 0.475 38 0.030 0.090 85.220 0.458\n15 0.010 0.170 73.600 0.475 39 0.030 0.170 75.960 0.467\n16 0.010 0.200 72.960 0.476 GM3 40 0.030 0.200 73.140 0.467\n17 0.005 0.050 91.320 0.462 41 0.070 0.050 79.360 0.465\n18 0.005 0.090 87.000 0.460 42 0.070 0.090 79.200 0.464\n19 0.005 0.170 80.760 0.473 43 0.070 0.170 75.980 0.467\n\nGM2 20 0.005 0.200 78.600 0.480 44 0.070 0.200 73.080 0.469\n21 0.030 0.050 90.140 0.467 45 0.010 0.050 73.980 0.475\n22 0.030 0.090 87.000 0.460 46 0.010 0.090 74.200 0.475\n23 0.030 0.170 80.760 0.473 47 0.010 0.170 73.940 0.475\n24 0.030 0.200 78.600 0.480 48 0.010 0.200 73.560 0.474\n\nThe bias for the prediction in these 25 extra locations was calculated and ploted with individual\nboxplot for each mesh (Figure 3.5). As we can notice, all the boxplots for the values of bias are quite the\nsame.\n\nFigure 3.5. Bias for Y in 25 extra locations, with regular data set.\n\nAs for the others data set, we can observe that there is a large impact of the mesh on parameter\nestimation and prediction and there is not a single mesh which is optimal in all results. To try to select\nan optimal mesh, we calculate the mean of DIC, WAIC and logCPO (Table 3.18). Meshes from GM1\nwith c = 0.005, got negative values for DIC and WAIC and were the meshes with higher values of\nlogCPO. Disregarding this meshes, the lowest value for DIC and WAIC were both with mesh 33 (180.702\nand 182.276, respectively). The lowest value for logCPO was 1.253 with meshes 6,7 and 18. Values for\n\n\n\n48\n\nmesh 5 were DIC=215.528, WAIC=216.189 and logCPO= 1.255 and for mesh 37 were DIC=208.811,\nWAIC=210.748 and logCPO=1.262.\n\nTable 3.18. Mean values of DIC, WAIC and logCPO for meshes with cluster data set .\nGroup Mesh c a DIC WAIC logCPO Group Mesh c a DIC WAIC logCPO\n\n1 0.005 0.050 -277.241 -277.101 1.810 25 0.070 0.050 240.772 242.300 1.260\n2 0.005 0.090 -294.297 -299.530 1.809 26 0.070 0.090 240.600 242.299 1.260\n3 0.005 0.170 -285.426 -292.638 1.808 27 0.070 0.170 244.745 246.397 1.265\n4 0.005 0.200 -275.800 -279.642 1.795 GM2 28 0.070 0.200 248.235 249.763 1.273\n5 0.030 0.050 215.528 216.189 1.255 29 0.010 0.050 247.828 249.316 1.271\n6 0.030 0.090 225.410 225.558 1.253 30 0.010 0.090 246.918 248.395 1.268\n7 0.030 0.170 228.594 228.673 1.253 31 0.010 0.170 247.144 248.646 1.270\n\nGM1 8 0.030 0.200 229.018 229.180 1.254 32 0.010 0.200 247.121 248.697 1.269\n9 0.070 0.050 240.008 240.634 1.259 33 0.005 0.050 180.702 182.276 1.298\n\n10 0.070 0.090 240.042 240.651 1.259 34 0.005 0.090 231.515 232.218 1.255\n11 0.070 0.170 243.106 243.729 1.263 35 0.005 0.170 242.657 243.356 1.261\n12 0.070 0.200 243.876 244.484 1.264 36 0.005 0.200 243.752 244.468 1.262\n13 0.010 0.050 246.180 246.919 1.267 37 0.030 0.050 208.811 210.748 1.262\n14 0.010 0.090 246.592 247.284 1.268 38 0.030 0.090 231.541 232.245 1.255\n15 0.010 0.170 246.203 246.946 1.267 39 0.030 0.170 242.633 243.333 1.261\n16 0.010 0.200 247.122 247.812 1.269 GM3 40 0.030 0.200 243.701 244.419 1.262\n17 0.005 0.050 195.986 198.941 1.271 41 0.070 0.050 240.637 241.284 1.259\n18 0.005 0.090 230.923 232.265 1.253 42 0.070 0.090 240.352 240.997 1.258\n19 0.005 0.170 244.745 246.397 1.265 43 0.070 0.170 242.941 243.538 1.261\n\nGM2 20 0.005 0.200 248.235 249.763 1.273 44 0.070 0.200 244.638 245.247 1.263\n21 0.030 0.050 217.715 220.822 1.254 45 0.010 0.050 247.072 247.860 1.270\n22 0.030 0.090 230.923 232.265 1.253 46 0.010 0.090 246.952 247.744 1.269\n23 0.030 0.170 244.745 246.397 1.265 47 0.010 0.170 247.051 247.840 1.270\n24 0.030 0.200 248.235 249.763 1.273 48 0.010 0.200 247.217 247.991 1.269\n\nConsidering all results, meshes 5 and 37 stand out from the other meshes and mesh 5 have\nslightly better results tha mesh 37.\n\nIn Figure 3.6 we can observe boxplots of parameter estimates based on the mesh with lowest\nDIC, WAIC or logCPO, obtained in each simulation and we also present in this figure the boxplots of the\nestimates obtained for each parameter with mesh 5. Boxplots obtained with mesh 5 are more similar to\nthe boxplots obtained for the results of logCPO. Also, selection of mesh using DIC and WAIC has bad\nperformance, seen in the large bias of all covariance parameters.\n\n\n\n49\n\nFigure 3.6. Estimated ?0, ?1, ?2e , ?2s , k and ??, considering the meshes with minimal DIC, WAIC and\nlogCPO, and based on mesh 5 for cluster data set.\n\n3.4 Data Analysis\n\n\u2022 Parana? dataset\n\nOne of the analyzed datasets was the so called Parana? dataset, available in the geoR package\n(Ribeiro and Diggle, 2001) in R. The data were collected in 143 random locations and consider the mean\nlevels of precipitation in the entire state of Paran?-Brazil, and the response variable represents the average\nwinter precipitation (dry season).\n\nTo perform the analysis we take out the linear trend from the variable, because we noticed that\nthis trend lead to misleading results. To model these data, we assume the model y = ?0 + s + ?, where s\nis a Mate?rn spatial random field with ? = 1.5\n\nPerforming a semivariogram analysis, we assumed the range as 380(??) and based on this value,\nwe created 54 meshes being 18 created with all locations (GM1), 18 created with domain (GM2) and\n18 created with part of the locations using the space filling algorithm (GM3). To create each of this 18\nmeshes, for the maximal allowed lengths of triangle edges in the inner domain (a) we used the values\na = c(20, 35, 55, 100, 240, 380) taking into account the value of range and allowing for small values until\nwe reach the expected value of the range. For the maximal allowed lengths of triangle edges in the outer\ndomain (b) the value was b = 570 and for the shortest distance allowed between points (c) the values\nwere c = c(13, 35, 51). For the domain, we used the bordes available in the data set plus 2.5. Table 3.19\nshow the number of knots for each mesh in each group and Figures B.4-B.12 of Appendix B show the\nimage of the meshes.\n\n\n\n50\n\nTable 3.19. Number of knots for each mesh for Paran? data.\nGroup Mesh c a Number knots Group Mesh c a Number knots Group Mesh c a Number knots\n\n1 13 20 1235 19 13 20 1410 37 13 20 1218\n2 13 35 678 20 13 35 777 38 13 35 679\n3 13 55 362 21 13 55 353 39 13 55 320\n4 13 100 234 22 13 100 125 40 13 100 152\n5 13 240 230 23 13 240 45 41 13 240 137\n6 13 380 230 24 13 380 32 42 13 380 137\n7 35 20 197 25 35 20 209 43 35 20 193\n8 35 35 195 26 35 35 212 44 35 35 194\n\nGM1 9 35 55 194 GM2 27 35 55 208 GM3 45 35 55 192\n10 35 100 134 28 35 100 126 46 35 100 126\n11 35 240 122 29 35 240 42 47 35 240 104\n12 35 380 122 30 35 380 32 48 35 380 104\n13 51 20 100 31 51 20 119 49 51 20 106\n14 51 35 100 32 51 35 118 50 51 35 105\n15 51 55 97 33 51 55 117 51 51 55 104\n16 51 100 94 34 51 100 114 52 51 100 105\n17 51 240 77 35 51 240 41 53 51 240 80\n18 51 380 77 36 51 380 32 54 51 380 80\n\nFigure B.13 in the Appendix B, shows the posterior distributions for ?0, ?2s , k and ?? and\nwe can notice that for ?0, the posterior for mesh 37 behaves differently from other meshes with less\nvariability, for the parameter ?2s the posterior for mesh 37 has a high variability and posterior for meshes\n23, 24, 29, 30, 35 and 36 stand out from the others with different means and variability. We can notice\nthat the same occur with the posterior of this six meshes for k and ??. The parameter estimates are in\nTable 3.20 and we can observe that the choice of the mesh does not have a large impact on the estimates.\nMeshes 9, 13 until 16 and 26 have better results for ?2s and for parameter ??, mesh 23 has the best value,\nalthough mesh 16 also gets good results.\n\nTable 3.20. Estimates of the parameters for each meshfor Paran? data.\nGroup Mesh c a ?0 ?2s k ?\n\n? Group Mesh c a ?0 ?2s k ?\n?\n\n1 13 20 -3.041 1004.249 0.004 530.363 28 35 100 -2.809 1071.426 0.004 564.845\n2 35 -2.899 1019.222 0.004 568.737 29 240 -4.124 2111.668 0.009 226.850\n3 55 -2.883 1026.202 0.003 573.441 30 380 -7.804 3161.480 0.014 144.841\n4 100 -2.867 1020.585 0.003 588.119 31 51 20 -2.695 1085.372 0.004 558.542\n5 240 -2.852 1007.166 0.003 582.856 GM2 32 35 -2.726 1092.988 0.004 568.645\n6 380 -2.852 1007.166 0.003 582.856 33 55 -2.961 1070.469 0.004 532.726\n7 35 20 -2.797 1002.032 0.004 555.719 34 100 -3.057 1145.570 0.003 584.626\n8 35 -2.747 1003.724 0.004 570.486 35 240 -4.022 1720.023 0.008 243.698\n\nGM1 9 55 -2.766 987.824 0.004 556.803 36 380 -7.547 3285.426 0.013 152.666\n10 100 -2.605 1018.224 0.003 588.273 37 13 20 -3.907 19759.314 0.318 6.293\n11 240 -2.370 1063.741 0.003 618.143 38 35 -2.781 1016.201 0.004 565.346\n12 380 -2.370 1063.741 0.003 618.143 39 55 -2.865 1009.105 0.004 557.738\n13 51 20 -3.249 994.481 0.004 520.953 40 100 -2.738 1041.134 0.003 638.464\n14 35 -3.145 979.349 0.004 512.673 41 240 -2.608 1033.338 0.003 638.393\n15 55 -3.244 979.765 0.004 504.027 42 380 -2.608 1033.338 0.003 638.393\n16 100 -3.140 979.482 0.004 494.867 43 35 20 -3.068 1025.605 0.003 572.346\n17 240 -2.110 1263.745 0.003 666.639 44 35 -3.048 1039.799 0.003 573.872\n18 380 -2.110 1263.745 0.003 666.639 GM3 45 55 -3.062 1045.103 0.003 578.584\n19 13 20 -3.101 1027.246 0.004 516.609 46 100 -2.892 1080.247 0.003 662.980\n20 35 -3.227 1021.859 0.004 498.400 47 240 -2.763 1103.220 0.003 670.484\n21 55 -3.023 1032.815 0.004 511.843 48 380 -2.763 1103.220 0.003 670.484\n22 100 -2.943 1046.193 0.004 505.889 49 51 20 -2.787 1043.170 0.003 583.009\n\nGM2 23 240 -3.550 1627.018 0.006 318.852 50 35 -2.741 1041.540 0.003 582.401\n24 380 -7.615 3362.882 0.013 155.867 51 55 -2.642 1039.266 0.003 581.089\n25 35 20 -2.986 1010.473 0.004 543.476 52 100 -2.479 1075.265 0.003 614.429\n26 35 -3.058 989.798 0.004 529.683 53 240 -3.091 1032.363 0.004 540.050\n27 55 -3.017 1017.109 0.004 538.467 54 380 -3.091 1032.363 0.004 540.050\n\nThe values of DIC, WAIC and logCPO was computed and added into Table 3.21 and we can\nnotice better results for mesh 37 but this mesh has really bad results for estimates. Values for DIC, WAIC\nand logCPO show minor difference between the meshes. So, we can assume mesh 16 is the optimal one.\n\n\n\n51\n\nTable 3.21. Values for DIC, WAIC and logCPO for each mesh for Paran? data.\nGroup Mesh c a DIC WAIC logCPO Group Mesh c a DIC WAIC logCPO\n\n1 13 20 1305.94 1306.35 4.58 28 35 100 1311.83 1312.10 4.59\n2 35 1307.34 1307.46 4.58 29 240 1300.32 1299.51 4.55\n3 55 1306.53 1306.47 4.58 30 380 1311.99 1311.71 4.59\n4 100 1307.85 1307.78 4.58 31 51 20 1309.11 1308.93 4.58\n5 240 1307.97 1307.91 4.58 GM2 32 35 1309.31 1309.08 4.58\n6 380 1307.97 1307.91 4.58 33 55 1307.69 1307.24 4.58\n7 35 20 1307.69 1306.64 4.58 34 100 1308.75 1308.86 4.58\n8 35 1308.14 1307.04 4.58 35 240 1306.39 1305.56 4.57\n\nGM1 9 55 1307.90 1306.81 4.58 36 380 1316.75 1316.43 4.60\n10 100 1309.51 1308.59 4.58 37 13 20 -838.05 -862.64 -2.12\n11 240 1309.71 1308.65 4.58 38 35 1307.64 1307.85 4.58\n12 380 1309.71 1308.65 4.58 39 55 1306.69 1306.88 4.58\n13 51 20 1308.18 1307.65 4.58 40 100 1310.78 1310.67 4.59\n14 35 1308.44 1307.93 4.58 41 240 1310.56 1310.49 4.59\n15 55 1307.65 1307.09 4.58 42 380 1310.56 1310.49 4.59\n16 100 1307.60 1307.08 4.58 43 35 20 1308.01 1308.17 4.58\n17 240 1307.83 1307.05 4.57 44 35 1307.69 1307.77 4.58\n18 380 1307.83 1307.05 4.57 GM3 45 55 1308.05 1308.17 4.58\n19 13 20 1306.33 1306.97 4.58 46 100 1313.99 1314.40 4.60\n20 35 1305.62 1306.48 4.58 47 240 1313.50 1313.78 4.60\n21 55 1306.63 1306.99 4.58 48 380 1313.50 1313.78 4.60\n22 100 1307.74 1307.51 4.58 49 51 20 1312.86 1313.90 4.60\n\nGM2 23 240 1307.18 1306.44 4.57 50 35 1312.66 1313.39 4.60\n24 380 1316.20 1315.69 4.60 51 55 1313.08 1314.15 4.60\n25 35 20 1309.85 1310.09 4.59 52 100 1313.13 1314.24 4.60\n26 35 1310.06 1310.20 4.59 53 240 1310.72 1311.30 4.59\n27 55 1308.95 1308.97 4.58 54 380 1310.72 1311.30 4.59\n\nUsing mesh 16, we computed the prediction mean and prediction standard deviation over the\nstudy area (the two figures from the bottom in Figure 3.7). Comparing Figure 3.7 II and Figure 3.7 III\nwe can assume that mesh 16 gives good prediction.\n\n(I) (II)\n\n(III) (IV)\n\nFigure 3.7. (I) Histogram, (II) plot of sample and corresponding values, (III) predicted surface and\n(IV) prediction standard deviation considering mesh 16.\n\n\u2022 Soil dataset\n\nThe data set here analyzed is the camg data set, in a regular grid, also available in the geoR\npackage (Ribeiro and Diggle, 2001) in R. We are analyzing the soil samples of magnesium in depth 0-20,\nnamed mg020, colected in 178 locations.\n\n\n\n52\n\nTo model these data, we assume the model y = ?0 + s + ?, where s is a Mate?rn spatial random\nfield with ? = 1.5. The variance of the variable is 39.39 and with the aid of a semivariogram analysis, we\nassumed the range as 400 (??) and so, k = 0.005. Based on this value we created 54 meshes. The same\nas before, we separeted the meshes into three groups: 18 meshes created with all locations (GM1), 18\ncreated with domain (GM2) and 18 created with part of the locations using the space filling algorithm\n(GM3).\n\nTo create the meshes, we considered for the maximal allowed lengths of triangle edges in\nthe inner domain (a) the values (20,40,60,120,260,400); for the maximal allowed lengths of triangle\nedges in the outer domain (b) the value was b = 600 and for the shortest distance allowed between\npoints (c) the values were (14,37,54). To create the domain, we use one function of the package R-\nINLA called inla.nonconvex.hull and the domain is given by inla.nonconvex.hull(coordinate,60,\n50,resolution=c(90,90))$loc. Figures B.14-B.22 from Appendix B show the images of created meshes\nand Table 3.22 below shows the number of knots for each mesh.\n\nTable 3.22. Number of knots for each mesh for soil data.\nGroup Mesh c a Number knots Group Mesh c a Number knots Group Mesh c a Number knots\n\n1 14 20 3362 19 14 20 4313 37 14 20 3215\n2 14 40 1690 20 14 40 2079 38 14 40 1602\n3 14 60 795 21 14 60 986 39 14 60 736\n4 14 120 295 22 14 120 282 40 14 120 208\n5 14 260 246 23 14 260 77 41 14 260 146\n6 14 400 245 24 14 400 51 42 14 400 145\n7 37 20 557 25 37 20 691 43 37 20 548\n8 37 40 553 26 37 40 673 44 37 40 543\n\nGM1 9 37 60 554 GM2 27 37 60 686 GM3 45 37 60 544\n10 37 120 295 28 37 120 276 46 37 120 208\n11 37 260 246 29 37 260 77 47 37 260 146\n12 37 400 245 30 37 400 51 48 37 400 145\n13 54 20 270 31 54 20 349 49 54 20 267\n14 54 40 270 32 54 40 352 50 54 40 264\n15 54 60 273 33 54 60 351 51 54 60 265\n16 54 120 208 34 54 120 286 52 54 120 196\n17 54 260 147 35 54 260 78 53 54 260 128\n18 54 400 144 36 54 400 49 54 54 400 127\n\nThe parameter estimates are in Table 3.23 and we can notce that for ?0, the estimated values\nare almost the same. For the parameter ?2s , half of meshes from GM1 overestimated this parameter, the\nsame occur with meshes 24, 25, 30 and 36 from GM2 and meshes 37, 38 and 44 from GM3. The best\nvalue for ?2s occur with mesh 27. For k, some meshes, including mesh 27, obtained the exact value. For\n??, the estimate most similar to the stipulated value was with mesh 53 the value of 396.201 and mesh 27\nobtained 417.423.\n\nThe values of DIC, WAIC and logCPO was computed and added into Table 3.24. We can notice\nthat meshes from GM1 have negative results for this three criteria and those meshes have bad results in\nall analysis. The small (positive) results for DIC was 1037.02 with mesh 26, for WAIC was 1040.80 also\nwith mesh 26 and for logCPO the best value was 2.97 with meshes 34, 40 and 46. This results with mesh\n27 were 1046.39 (DIC), 1048.73 (WAIC) and 2.98 (logCPO), not far from the minors ones.\n\n\n\n53\n\nTable 3.23. Estimates of the parameters for each mesh for Soil data.\nGroup Mesh c a ?0 ?2s k ?\n\n? Group Mesh c a ?0 ?2s k ?\n?\n\n1 14 20 27.349 225.546 0.311 6.436 28 37 120 24.790 39.813 0.007 274.361\n2 40 27.249 212.464 0.201 9.943 29 260 24.161 47.518 0.006 356.202\n3 60 25.502 38.138 0.012 168.098 30 400 23.532 112.748 0.010 193.083\n4 120 25.544 41.596 0.015 135.957 31 54 20 24.372 39.492 0.005 375.086\n5 260 26.184 536.623 0.146 13.677 GM2 32 40 24.511 37.671 0.006 356.415\n6 400 26.186 533.051 0.147 13.635 33 60 24.431 39.159 0.005 369.717\n7 37 20 27.007 392.239 0.156 12.825 34 120 24.455 40.683 0.005 373.239\n8 40 25.659 39.245 0.014 143.499 35 260 24.056 51.629 0.007 276.123\n\nGM1 9 60 27.006 389.648 0.156 12.857 36 400 22.970 136.836 0.011 187.693\n10 120 25.544 41.596 0.015 135.957 37 14 20 27.497 205.812 0.229 8.726\n11 260 26.184 536.623 0.146 13.677 38 40 27.204 257.290 0.183 10.957\n12 400 26.186 533.051 0.147 13.635 39 60 25.591 44.040 0.013 150.161\n13 54 20 24.039 38.553 0.003 614.885 40 120 24.483 37.161 0.005 437.492\n14 40 24.033 38.645 0.003 613.556 41 260 24.453 36.714 0.004 484.431\n15 60 23.884 39.873 0.003 610.772 42 400 24.452 36.749 0.004 484.269\n16 120 24.308 36.371 0.004 514.214 43 37 20 25.675 46.431 0.017 119.675\n17 260 24.172 36.932 0.004 567.643 44 40 26.929 496.750 0.161 12.388\n18 400 24.283 35.917 0.004 541.241 GM3 45 60 25.765 46.740 0.017 115.848\n19 14 20 25.695 43.909 0.016 126.075 46 120 24.483 37.161 0.005 437.492\n20 40 25.828 48.753 0.017 117.083 47 260 24.453 36.714 0.004 484.431\n21 60 26.146 64.464 0.026 76.259 48 400 24.452 36.749 0.004 484.269\n22 120 24.297 37.278 0.005 423.440 49 54 20 24.370 36.666 0.004 507.665\n\nGM2 23 260 24.501 47.362 0.006 318.026 50 40 24.511 36.060 0.004 445.414\n24 400 23.935 102.094 0.010 204.161 51 60 24.519 35.560 0.005 436.221\n25 37 20 26.357 104.627 0.033 60.693 52 120 24.629 36.447 0.005 386.195\n26 40 24.789 37.422 0.006 327.538 53 260 24.724 34.445 0.005 396.201\n27 60 24.473 39.346 0.005 417.423 54 400 24.743 34.243 0.005 390.551\n\nTable 3.24. Values for DIC, WAIC and logCPO for each mesh for Soil data.\nGroup Mesh c a DIC WAIC logCPO Group Mesh c a DIC WAIC logCPO\n\n1 14 20 -1045.52 -1064.51 -2.09 28 37 120 1043.60 1048.56 2.98\n2 40 -1051.57 -1090.31 -2.16 29 260 1072.81 1072.84 3.02\n3 60 -1037.86 -1053.63 -2.06 30 400 1067.59 1067.17 3.00\n4 120 -1017.69 -1052.80 -2.06 31 54 20 1049.29 1051.18 2.98\n5 260 -1111.69 -1166.31 -2.38 GM2 32 40 1053.02 1055.10 2.99\n6 400 -1112.32 -1166.93 -2.38 33 60 1049.06 1051.17 2.98\n7 37 20 -1046.77 -1101.36 -2.19 34 120 1048.73 1050.50 2.97\n8 40 -1031.61 -1051.38 -2.06 35 260 1066.28 1065.48 3.00\n\nGM1 9 60 -1047.36 -1101.95 -2.20 36 400 1068.88 1068.67 3.00\n10 120 -1017.69 -1052.80 -2.06 37 14 20 -1066.48 -1119.93 -2.25\n11 260 -1111.69 -1166.31 -2.38 38 40 -1042.52 -1095.65 -2.18\n12 400 -1112.32 -1166.93 -2.38 39 60 -1032.84 -1053.26 -2.06\n13 54 20 1066.26 1066.83 3.02 40 120 1047.06 1047.13 2.97\n14 40 1066.86 1067.50 3.02 41 260 1054.90 1054.56 2.98\n15 60 1064.53 1065.47 3.01 42 400 1054.87 1054.56 2.98\n16 120 1060.81 1060.14 3.00 43 37 20 -1020.86 -1059.65 -2.08\n17 260 1064.89 1063.83 3.00 44 40 -1085.68 -1140.24 -2.30\n18 400 1064.75 1063.63 3.00 GM3 45 60 -1031.49 -1052.65 -2.06\n19 14.00 20 -1019.59 -1056.11 -2.07 46 120 1047.06 1047.13 2.97\n20 40 -1030.01 -1049.40 -2.05 47 260 1054.90 1054.56 2.98\n21 60 -1033.28 -1056.65 -2.07 48 400 1054.87 1054.56 2.98\n22 120 1062.98 1066.29 3.01 49 54 20 1056.61 1057.91 3.00\n\nGM2 23 260 1073.61 1073.16 3.02 50 40 1049.74 1050.44 2.98\n24 400 1073.70 1073.41 3.02 51 60 1048.95 1049.86 2.98\n25 37 20 -1044.52 -1062.07 -2.08 52 120 1044.12 1044.07 2.96\n26 40 1037.02 1040.80 2.98 53 260 1054.13 1054.46 2.98\n27 60 1046.39 1048.73 2.98 54 400 1054.03 1054.36 2.98\n\nUsing mesh 27, we computed the prediction mean and prediction standard deviation over the\nstudy area (the two figures from the bottom in Figure 3.8). Comparing Figure 3.8 I and Figure 3.8 III\nwe can assume that mesh 27 obtained good prediction.\n\n\n\n54\n\n(I) (II)\n\n(III) (IV)\n\nFigure 3.8. (I) Plot of sample and corresponding values, (II) histogram , (III) predicted surface and\n(IV) prediction standard deviation considering mesh 27.\n\n3.5 Conclusion\n\nWhen using th SPDE/GMRF approach in INLA in geostatistical analysis, the first step is to\ncreate a mesh over and plus the study area. With a simulation study we showed that inferential results\ndepend on this created mesh. In a previous study, we notice that the value of b(the maximal edge length\nin the outer domain) has almost no impact on the results,so in this study we fixed it. The choice of the\nvalue of c, the shortest allowed distance between points, has the largest impact and, conditional on a\nvalue of c, the value of a (the maximal edge length in the inner domain) also leads to some differences.\n\nWe worked with three predictive information criteria, namely DIC, WAIC and CPO, to inves-\ntigate whether these criteria can be used to select an optimal mesh for a specific data problem and we\nnotice that DIC and WAIC lead to choosing meshes with poor results in the analysis while CPO has\na better sense. The only problem with CPO is that we need to make sure that no numerical problems\noccur because if it happens, CPO needed to be recalculated by refitting the model, leaving out every\nobservation one at a time and this could take a long time, specially in simulation study.\n\nIn this paper, our focus was to investigate different types to create a convex mesh for different\ngeostatistical data set. We worked with three ways to create the mesh and it is possible to notice\nthat working with radom and cluster data, best results are obtained with meshes generated with all\ncoordinates, with a relation with ratio of 0.15 between c = 0.03 and range. For regular data, results were\nnot good when meshes were created considering the coordinates, better results were obtained with mesh\ncreation by domain. Further investigation with convex mesh is still needed and also to investigate how\nnon-convex meshes worked for each kind of this data set.\n\nReferences\n\nBOLIN, D.; LINDSTRO?M, J. Spatial Statistics using R-INLA and Gaussian Markov random fields.\nPan-American Advanced Study Institute, 15:29:57Z, rev.3691, 2014.\n\nCAMELETTI, M.; LINDGREN, F.; SIMPSON, D., RUE, H. Spatio-temporal modeling of particulate\nmatter concentration through the SPDE approach. Advances in Statistical Analysis, v. 97, p. 109-131,\n2012.\n\n\n\n55\n\nDIGGLE, P.J.; RIBEIRO JR., P.J.; CHRISTENSEN, O.F. An introduction to model-based geostatistics.\nIn: M?LLER, J. (Ed.). Spatial Statistics and Computational Methods. New York: Springer, 2003.\np. 43-86.\n\nDIGGLE, P. J.; TAWN, J. A.; MOYEED, R. A. Model-based geostatistics. Journal of the Royal\nStatistical Society: Series C, v. 47, p. 299-350, 1998.\n\nGEISSER, S.; EDDY, W. A predictive approach to model selection. Journal of the American Statistical\nAssociation, Boston, v.74, n.365, p.153-160, 1979.\n\nGELMAN, A.; HWANG,J.; VEHTARI, A. Understanding predictive information criteria for Bayesian\nmodels. Statistics and Computing, v. 24, n. 6, p. 997-1016, 2014.\n\nHELD, L., SCHRODLE, B., RUE, H. Posterior and Cross-validatory Predictive Checks: A comparison\nof MCMC and INLA. In T. Kneib and G. Tutz, editors,Statistical Modelling and Regression Structures,\np. 91 , 2010.\n\nIBRAHIM, J. G.; CHEN, M.; SINHA, D.Bayesian Survival Analysis. Ed: Springer Science &amp; Business\nMedia, 2013. 480 p.\n\nJOHNSON, M.E.; MOORE, L.M.; YLVISAKER,D. Minimax and maximin distance designs. Journal of\nStatistical Planning and Inference,n. 26, p. 131-148, 1990.\n\nKARAGIANNIS-VOULES, D.A., SCHOLTE, R. G. C., GUIMARE?ES, L. H., UTZINGER, J.,\nVOUNATSOU, P. Bayesian Geostatistical Modeling of Leishmaniasis Incidence in Brazil. PLoS Neglected\nTropical Diseases, v. 7, n. 5, e2213. doi:10.1371/journal.pntd.0002213. 2013.\n\nKRAINSKI, E. T.; RUE, H. A short introduction on how to fit a SPDE model with INLA. 2013.\n\nKRAINSKI, E. T.; LINDGREN, F. The R-INLA tutorial: SPDE models. 2014.\n\nLINDGREN, F. Continuous domain spatial models in R-INLA. The ISBA Bulletin, v. 19, n. 4, 2012.\n\nLINDGREN, F.; RUE, H. Bayesian spatial modelling with R-INLA. Journal of Statistical Software, v.\n63, 2015.\n\nLINDGREN, F.; RUE, H.; LINDSTRo?M, J. An explicit link between Gaussian fields and Gaussian\nMarkov random fields: The stochastic partial differential equation approach. Journal of the Royal Sta-\ntistical Society, v. 73, p. 423-498, 2011.\n\nMATHERON, G. Principles of geostatistics. Economic Geology, Austin, v. 58, p.1246-1266, 1963.\n\nR Core Team (2015). R: A language and environment for statistical computing. R Foundation for Sta-\ntistical Computing, Vienna, Austria. URL https://www.R-project.org/.\n\nRIBEIRO JR., P.J. and DIGGLE, P.J. (2001) geoR: A package for geostatistical analysis. R-NEWS Vol\n1, No 2. ISSN 1609-3631. Available for download at: http://cran.r-project.org/doc/Rnews.\n\nRUE, H.; MARTINO, S.; CHOPIN, N. Appriximate Bayesian inference for latent Gaussian models by\nusing integrated nested Laplace aproximations (with discussion). Journal of the Royal Statistical Society\n- Series B, v.71, Part 2, p.319-392, 2009.\n\nSPIEGELHALTER, D.J.; BEST, N.G.; CARLIN, B.P.; LINDE, A.V.D. Bayesian measures of model\ncomplexity and fit. Journal of the Royal Statistical Society Series B, London, v.64, n.4, p.583-639, 2000.\n\nVEHTARI, A.; GELMAN, A. WAIC and cross-validation in Stan. Submitted. http://www.stat.columbia.\nedu/gelman/research/unpublished/waic stan.pdf Accessed, v. 27, n. 2015, p. 5, 2014.\n\nWATANABE, S. Asymptotic equivalence of Bayes cross validation and widely applicable information\ncriterion in singular learning theory. Journal of Machine Learning Research, v. 11, p. 3571-3594, 2010.\n\n\n\n56\n\nZHANG, H.; ZIMMERMAN, D. L. Hybrid Estimation of Semivariogram Parameters. Mathematical\nGeology, v. 39, n. 2, February 2007. DOI: 10.1007/s11004-006-9070-8.\n\n\n\n57\n\n4 CONCLUSION\n\nWhen using the INLA method for geostatistical data, the first step is to create a mesh under\nthe study region and all the analysis will depend on this mesh. This mesh is composed of several triangles\nin which the junction of the edges (knots) may or may not coincide with the locations. There are several\nways to create the mesh and in this work we approach the creation using the maximal allowed edge length\nin the inner (a) and outer (b) domain and the shortest allowed distance between two points (c). We could\nnotice that the value of b has almost no impact on the results and the choice of the value of c has the\nlargest impact. Also, conditional on a value of c, the value of a also leads to some differences.\n\nPre-specification of the triangulated mesh is not easy, since it is possible to create a mesh with\nvery good predictive behavior, but that leads to poor covariance parameter estimates. We have used\nDIC, WAIC and CPO, to investigate whether these criterias can be used to select an optimal mesh for a\nspecific data problem. We noticed that the predictive information criterias DIC and WAIC almost always\nlead to choosing dense meshes. These meshes indeed perform well in terms of coverage and mean squared\nerror for predictions, but do not perform well in the other parts of the analysis, namely the estimation\nof the covariance parameters. Thus, DIC and WAIC showed to prefer meshes with more knots. Further,\nwe have noticed that mesh selection using the logCPO leads to better performing meshes overall.\n\nThe logCPO criteria needs careful since it is very important to ensure that no numerical prob-\nlems occur. We have observed that in many cases, especially with dense meshes, this approximating\nmethod does not work and, therefore, CPO needed to be recalculated by refitting the model, leaving out\nevery observation one at a time.\n\nFirst, we study for random data the behavior of the maximal allowed edge length in the inner (a)\nand outer (b) domain and the shortest allowed distance between two points (c) for different sample values\nto verify the impact of the mesh with different sample values then we extended the study to different\nways to create the mesh with the use of different values of a, b and c. There is still much to study for\na better guide on how to create the mesh but with this beginning of study we can notice similarities in\nthe real data applications with the simulation study carried out. It is possible to notice that analysis\nwith regular data set works better withe meshes created by domain, not considering the coordinates. For\nrandom and cluster data set, meshes created considering all the locations, generate better results and\nproportion given by c\n\n?? is equal to 0.15, a proportion to give a special attention when creating the mesh.\nAlso, we notice that the value of b to create the mesh has no impact in the analysis, the attention should\nbe in a and b.\n\n\n\n58\n\n\n\n59\n\nAPPENDICES\n\nAppendix A: Supplementary Material for Chapter 2\n\nAdditional simulations results\n\nIn Section 2.3 of Chapter 2, a simulation study is presented with n = 100. In this section of\nAppendix A we provide the results of the simulation study considering n = 50 and n = 300.\n\nThe colours of the graphics in the following sessions are: red for c=0.001, orange for c=0.005,\ngreen for c=0.01, blue for c= 0.03, light blue for c=0.05, pink for c=0.07, yellow for c=0.10 and grey for\nc=0.13. And in each group of these colours, the value of a increases from left to right.\n\nSimulation study with n=100\n\nImpact of mesh on inference\n\nFigure A.1. Coverage of the meshes for: beta0, beta1, ?2e , ?2s , k and ?? with n=100.\n\n\n\n60\n\nTable A.1. MSE of the parameters?0, ?1, ?2e , ?2s , k and ?? for different meshes with b = 0.3.\nMSE for:\n\nMesh c a ?0 ?1 ?2e ?\n2\ns k ?\n\n?\n\n1 0.001 0.05 0.07 0.12 0.08 0.29 543.04 0.02\n2 0.09 0.07 0.12 0.08 0.34 299.48 0.02\n3 0.13 0.06 0.12 0.08 0.40 182.82 0.02\n4 0.17 0.06 0.12 0.08 0.48 144.96 0.01\n5 0.19 0.06 0.12 0.08 0.47 127.04 0.01\n6 0.20 0.06 0.12 0.08 0.48 122.49 0.02\n7 0.005 0.05 0.07 0.14 0.08 0.30 544.10 0.02\n8 0.09 0.07 0.14 0.08 0.33 285.95 0.02\n9 0.13 0.07 0.14 0.08 0.38 171.38 0.02\n\n10 0.17 0.07 0.14 0.08 0.44 131.29 0.02\n11 0.19 0.07 0.14 0.08 0.46 121.33 0.02\n12 0.20 0.07 0.14 0.08 0.45 115.09 0.02\n13 0.01 0.05 0.07 0.14 0.06 0.28 424.82 0.04\n14 0.09 0.07 0.14 0.06 0.24 202.96 0.04\n15 0.13 0.07 0.13 0.06 0.26 120.75 0.04\n16 0.17 0.07 0.13 0.06 0.32 100.72 0.04\n17 0.19 0.07 0.13 0.06 0.33 91.92 0.04\n18 0.20 0.07 0.13 0.06 0.33 86.29 0.04\n19 0.03 0.05 0.06 0.12 0.03 0.07 87.72 0.06\n20 0.09 0.06 0.11 0.02 0.14 88.41 0.06\n21 0.13 0.06 0.11 0.02 0.06 31.88 0.07\n22 0.17 0.06 0.11 0.02 0.07 34.07 0.07\n23 0.19 0.06 0.11 0.02 0.08 32.10 0.07\n24 0.20 0.06 0.11 0.02 0.08 32.60 0.06\n25 0.05 0.05 0.06 0.11 0.02 0.08 88.57 0.07\n26 0.09 0.06 0.11 0.02 0.12 131.08 0.06\n27 0.13 0.06 0.11 0.02 0.07 36.54 0.07\n28 0.17 0.06 0.11 0.03 0.08 51.22 0.08\n29 0.19 0.06 0.11 0.03 0.10 59.79 0.07\n30 0.20 0.06 0.10 0.03 0.09 46.20 0.06\n31 0.07 0.05 0.06 0.10 0.03 0.09 45.91 0.10\n32 0.09 0.06 0.10 0.03 0.10 46.08 0.10\n33 0.13 0.06 0.10 0.03 0.09 41.33 0.11\n34 0.17 0.06 0.10 0.04 0.14 49.59 0.12\n35 0.19 0.06 0.10 0.05 0.22 66.93 0.11\n36 0.20 0.06 0.10 0.05 0.23 69.40 0.11\n37 0.10 0.05 0.06 0.10 0.06 1.16 123.40 0.11\n38 0.09 0.06 0.10 0.06 1.96 125.43 0.12\n39 0.13 0.06 0.10 0.07 2.32 138.98 0.11\n40 0.17 0.06 0.10 0.07 1.91 130.67 0.12\n41 0.19 0.06 0.10 0.07 1.93 127.96 0.11\n42 0.20 0.06 0.11 0.07 2.44 111.41 0.11\n43 0.13 0.05 0.06 0.11 0.09 1.87 130.20 0.12\n44 0.09 0.06 0.11 0.10 2.20 133.10 0.12\n45 0.13 0.06 0.11 0.10 1.33 107.18 0.11\n46 0.17 0.06 0.11 0.10 1.38 108.93 0.11\n47 0.19 0.06 0.11 0.10 1.42 112.95 0.11\n48 0.20 0.06 0.11 0.10 1.37 109.74 0.12\n\n\n\n61\n\nSimulation study with n=50\n\nImpact of mesh on inference\n\nFigure A.2. Coverage of the meshes for: beta0, beta1, ?2e , ?2s , k and ?? with n=50.\n\n\n\n62\n\nTable A.2. Coverage, in %, of the 95% credible intervals of the parameters?0, ?1, ?2e , ?2s , k and ?? for\ndifferent meshes with b = 0.3, for n = 50.\n\nCoverage in % for:\nMesh c a ?0 ?1 ?2e ?2s k ??\n\n1 0.001 0.05 93.00 93.50 0.50 59.50 51.50 55.00\n2 0.09 92.00 93.50 1.00 33.50 43.00 43.00\n3 0.13 92.00 94.50 1.00 18.00 41.50 42.00\n4 0.17 93.00 94.50 0.50 11.50 44.50 45.50\n5 0.19 92.50 95.00 1.00 11.50 43.50 43.50\n6 0.20 92.50 95.50 0.50 11.00 45.00 45.00\n7 0.005 0.05 93.00 93.50 0.50 59.50 51.50 55.00\n8 0.09 92.00 93.50 1.00 33.50 43.00 43.00\n9 0.13 92.00 94.50 1.00 18.00 41.50 42.00\n10 0.17 93.00 94.50 0.50 11.50 44.50 45.50\n11 0.19 92.50 95.00 1.00 11.50 43.50 43.50\n12 0.20 92.50 95.50 0.50 11.00 45.00 45.00\n13 0.01 0.05 93.50 90.00 5.50 62.50 57.00 60.00\n14 0.09 92.50 89.50 7.00 38.00 49.00 49.00\n15 0.13 93.00 91.00 7.50 24.00 47.50 48.00\n16 0.17 93.50 91.50 7.00 17.50 50.00 51.00\n17 0.19 92.50 92.00 8.00 16.50 50.00 50.00\n18 0.20 93.00 92.50 7.50 16.50 51.50 51.50\n19 0.03 0.05 91.00 87.00 25.50 61.50 62.50 63.00\n20 0.09 92.00 85.00 42.00 55.50 65.00 65.00\n21 0.13 89.50 84.50 59.50 67.00 72.00 73.00\n22 0.17 90.00 86.00 61.00 66.00 72.00 72.00\n23 0.19 90.00 86.50 62.50 65.50 73.50 74.00\n24 0.20 92.00 86.50 63.50 64.50 73.00 73.00\n25 0.05 0.05 92.50 88.50 57.50 66.00 71.00 70.00\n26 0.09 91.50 88.00 52.00 61.50 66.00 66.50\n27 0.13 94.50 88.50 72.00 82.50 78.50 78.50\n28 0.17 94.00 89.50 74.00 86.50 82.00 82.00\n29 0.19 94.50 91.00 74.50 86.50 81.50 81.50\n30 0.20 95.50 91.50 74.00 88.00 81.00 81.00\n31 0.07 0.05 94.00 91.50 68.00 88.50 81.50 81.50\n32 0.09 96.00 91.00 67.50 88.00 82.50 82.50\n33 0.13 96.50 92.00 69.00 86.50 83.50 84.00\n34 0.17 97.50 92.50 64.50 91.50 82.00 82.00\n35 0.19 96.50 93.50 61.00 91.50 81.00 81.00\n36 0.20 97.50 93.50 60.00 90.00 82.00 82.00\n37 0.10 0.05 96.50 92.50 54.50 89.50 83.00 83.00\n38 0.09 97.00 93.00 56.50 90.50 83.00 83.00\n39 0.13 96.50 92.50 54.50 92.50 86.00 86.00\n40 0.17 96.50 92.50 55.00 92.00 86.00 86.00\n41 0.19 96.50 92.50 53.50 91.00 86.00 86.00\n42 0.20 96.00 93.00 54.00 92.00 85.50 85.50\n43 0.13 0.05 97.50 93.00 35.00 91.00 88.00 88.00\n44 0.09 97.00 94.00 29.00 91.00 88.50 88.50\n45 0.13 97.50 94.00 29.00 92.50 89.50 89.50\n46 0.17 97.00 93.50 28.50 92.50 89.00 89.00\n47 0.19 96.50 94.00 29.00 92.50 89.00 89.00\n48 0.20 97.00 93.50 28.50 92.00 89.00 89.00\n\n\n\n63\n\nTable A.3. Absolute bias of the parameters?0, ?1, ?2e , ?2s , k and ?? for different meshes with b = 0.3,\nfor n = 50.\n\nBias for:\nMesh c a ?0 ?1 ?2e ?2s k ??\n\n1 0.001 0.05 0.03 0.00 0.30 0.67 18.57 0.08\n2 0.09 0.02 0.00 0.30 0.62 14.04 0.08\n3 0.13 0.03 0.00 0.30 0.73 11.33 0.08\n4 0.17 0.02 0.00 0.30 0.83 9.35 0.07\n5 0.19 0.02 0.00 0.30 0.85 8.53 0.07\n6 0.20 0.02 0.00 0.30 0.87 8.35 0.07\n7 0.005 0.05 0.03 0.00 0.30 0.67 18.57 0.08\n8 0.09 0.02 0.00 0.30 0.62 14.04 0.08\n9 0.13 0.03 0.00 0.30 0.73 11.33 0.08\n10 0.17 0.02 0.00 0.30 0.83 9.35 0.07\n11 0.19 0.02 0.00 0.30 0.85 8.53 0.07\n12 0.20 0.02 0.00 0.30 0.87 8.35 0.07\n13 0.01 0.05 0.02 0.00 0.28 0.62 15.71 0.06\n14 0.09 0.02 0.01 0.28 0.56 11.97 0.06\n15 0.13 0.02 0.01 0.28 0.66 9.71 0.06\n16 0.17 0.02 0.01 0.28 0.75 7.94 0.05\n17 0.19 0.02 0.01 0.28 0.77 7.18 0.05\n18 0.20 0.02 0.01 0.28 0.79 7.15 0.05\n19 0.03 0.05 0.02 0.02 0.21 0.32 9.56 0.00\n20 0.09 0.02 0.01 0.16 0.53 9.04 0.05\n21 0.13 0.01 0.03 0.10 0.42 4.57 0.10\n22 0.17 0.02 0.03 0.09 0.65 5.25 0.09\n23 0.19 0.02 0.02 0.09 0.57 4.54 0.09\n24 0.20 0.02 0.02 0.08 0.60 4.39 0.11\n25 0.05 0.05 0.04 0.02 0.08 0.49 6.61 0.10\n26 0.09 0.04 0.02 0.09 0.63 7.91 0.12\n27 0.13 0.03 0.01 0.01 0.25 2.76 0.16\n28 0.17 0.04 0.02 0.04 0.31 2.16 0.19\n29 0.19 0.04 0.03 0.05 0.32 2.00 0.19\n30 0.20 0.04 0.03 0.06 0.30 1.72 0.19\n31 0.07 0.05 0.03 0.01 0.08 0.29 1.22 0.22\n32 0.09 0.03 0.00 0.09 0.46 1.92 0.22\n33 0.13 0.03 0.01 0.09 0.21 0.68 0.23\n34 0.17 0.03 0.01 0.13 0.21 0.59 0.24\n35 0.19 0.03 0.01 0.15 0.33 1.11 0.25\n36 0.20 0.03 0.01 0.16 0.38 1.33 0.25\n37 0.10 0.05 0.03 0.01 0.19 0.36 1.35 0.24\n38 0.09 0.03 0.01 0.20 0.48 1.48 0.25\n39 0.13 0.03 0.01 0.19 0.25 0.95 0.25\n40 0.17 0.03 0.01 0.19 0.22 0.46 0.25\n41 0.19 0.03 0.01 0.20 0.22 0.41 0.26\n42 0.20 0.03 0.01 0.20 0.29 1.10 0.25\n43 0.13 0.05 0.03 0.01 0.27 0.64 2.64 0.21\n44 0.09 0.03 0.01 0.28 0.52 2.37 0.21\n45 0.13 0.03 0.01 0.28 0.50 2.08 0.22\n46 0.17 0.03 0.01 0.28 0.50 2.07 0.21\n47 0.19 0.03 0.01 0.28 0.49 2.21 0.21\n48 0.20 0.03 0.01 0.28 0.50 2.06 0.22\n\n\n\n64\n\nTable A.4. MSE of the parameters?0, ?1, ?2e , ?2s , k and ?? for different meshes with b = 0.3, for n = 50.\nMSE for:\n\nMesh c a ?0 ?1 ?2e ?2s k ??\n1 0.001 0.05 0.10 0.20 0.09 13.77 2187.42 0.01\n2 0.09 0.10 0.19 0.09 1.18 541.03 0.01\n3 0.13 0.10 0.19 0.09 0.86 266.87 0.01\n4 0.17 0.11 0.19 0.09 1.00 179.91 0.01\n5 0.19 0.11 0.19 0.09 0.95 142.91 0.01\n6 0.20 0.11 0.19 0.09 1.04 140.73 0.01\n7 0.005 0.05 0.10 0.20 0.09 13.77 2187.42 0.01\n8 0.09 0.10 0.19 0.09 1.18 541.03 0.01\n9 0.13 0.10 0.19 0.09 0.86 266.87 0.01\n10 0.17 0.11 0.19 0.09 1.00 179.91 0.01\n11 0.19 0.11 0.19 0.09 0.95 142.91 0.01\n12 0.20 0.11 0.19 0.09 1.04 140.73 0.01\n13 0.01 0.05 0.11 0.23 0.09 13.72 1969.76 0.02\n14 0.09 0.11 0.23 0.09 1.10 452.62 0.02\n15 0.13 0.11 0.24 0.09 0.75 214.01 0.03\n16 0.17 0.11 0.23 0.09 0.89 140.82 0.03\n17 0.19 0.12 0.24 0.08 0.85 111.39 0.03\n18 0.20 0.12 0.23 0.08 0.95 117.64 0.03\n19 0.03 0.05 0.12 0.24 0.07 0.44 406.22 0.09\n20 0.09 0.12 0.24 0.06 2.11 591.50 0.12\n21 0.13 0.12 0.25 0.05 1.14 230.60 0.16\n22 0.17 0.12 0.25 0.05 3.87 283.34 0.16\n23 0.19 0.11 0.24 0.05 1.95 214.86 0.16\n24 0.20 0.11 0.24 0.05 2.08 215.06 0.24\n25 0.05 0.05 0.11 0.24 0.06 1.69 360.94 0.17\n26 0.09 0.11 0.25 0.06 3.23 491.41 0.24\n27 0.13 0.10 0.22 0.04 0.78 204.33 0.21\n28 0.17 0.11 0.22 0.04 1.24 174.91 0.28\n29 0.19 0.11 0.22 0.04 1.38 167.62 0.29\n30 0.20 0.11 0.22 0.04 1.13 156.68 0.30\n31 0.07 0.05 0.10 0.21 0.05 2.45 175.99 0.31\n32 0.09 0.10 0.21 0.05 6.31 222.77 0.32\n33 0.13 0.10 0.21 0.05 0.92 132.95 0.31\n34 0.17 0.10 0.21 0.05 0.70 119.57 0.32\n35 0.19 0.10 0.20 0.06 2.35 176.24 0.34\n36 0.20 0.10 0.20 0.06 4.00 201.84 0.34\n37 0.10 0.05 0.10 0.20 0.07 2.05 140.64 0.33\n38 0.09 0.10 0.20 0.07 5.62 145.15 0.36\n39 0.13 0.10 0.20 0.07 0.92 100.31 0.36\n40 0.17 0.10 0.20 0.07 0.81 85.61 0.37\n41 0.19 0.10 0.20 0.07 0.79 86.43 0.38\n42 0.20 0.10 0.20 0.07 1.38 107.11 0.36\n43 0.13 0.05 0.10 0.20 0.11 5.73 145.46 0.34\n44 0.09 0.10 0.20 0.11 3.76 137.79 0.33\n45 0.13 0.10 0.20 0.11 3.83 132.40 0.34\n46 0.17 0.10 0.20 0.11 3.84 130.75 0.34\n47 0.19 0.10 0.20 0.11 2.93 129.65 0.33\n48 0.20 0.10 0.20 0.11 3.83 131.23 0.34\n\n\n\n65\n\nTable A.5. Nominal coverage, in %, and MSE for the variable Y calculated for each mesh with b=0.3,\nconsidering 200 simulations, for n=50.\n\nMesh c a Coverage(%) MSE Mesh c a Coverage(%) MSE\n1 0.001 0.05 3.51 0.29 25 0.05 0.05 65.38 0.24\n2 0.09 3.94 0.29 26 0.09 60.46 0.25\n3 0.13 3.97 0.29 27 0.13 82.89 0.24\n4 0.17 3.87 0.29 28 0.17 85.77 0.24\n5 0.19 4.01 0.29 29 0.19 87.82 0.24\n6 0.20 3.89 0.29 30 0.20 87.87 0.24\n7 0.005 0.05 3.51 0.29 31 0.07 0.05 85.83 0.25\n8 0.09 3.94 0.29 32 0.09 84.81 0.25\n9 0.13 3.97 0.29 33 0.13 85.66 0.25\n10 0.17 3.87 0.29 34 0.17 87.21 0.26\n11 0.19 4.01 0.29 35 0.19 87.00 0.27\n12 0.20 3.89 0.29 36 0.20 86.58 0.27\n13 0.01 0.05 10.24 0.29 37 0.10 0.05 84.71 0.29\n14 0.09 11.66 0.29 38 0.09 84.74 0.29\n15 0.13 13.62 0.29 39 0.13 84.91 0.29\n16 0.17 13.73 0.29 40 0.17 84.86 0.29\n17 0.19 14.01 0.29 41 0.19 84.76 0.29\n18 0.20 13.75 0.29 42 0.20 84.72 0.29\n19 0.03 0.05 30.92 0.27 43 0.13 0.05 79.78 0.33\n20 0.09 46.52 0.26 44 0.09 79.43 0.34\n21 0.13 70.26 0.24 45 0.13 78.93 0.34\n22 0.17 71.48 0.24 46 0.17 78.92 0.34\n23 0.19 74.28 0.24 47 0.19 79.26 0.34\n24 0.20 74.16 0.24 48 0.20 79.01 0.34\n\n\n\n66\n\nTable A.6. Nominal coverage, in %, and MSE for the variable Y calculated for each mesh with b = 0.3,\nconsidering 200 simulations, for 13 locations not in the analysis.\n\nMesh c a Coverage(%) MSE Mesh c a Coverage(%) MSE\n1 0.001 0.05 93.27 0.54 25 0.05 0.05 84.08 0.57\n2 0.09 88.04 0.54 26 0.09 84.42 0.57\n3 0.13 79.15 0.54 27 0.13 81.00 0.54\n4 0.17 72.12 0.55 28 0.17 75.54 0.54\n5 0.19 69.31 0.56 29 0.19 75.00 0.53\n6 0.20 65.96 0.56 30 0.20 73.50 0.54\n7 0.005 0.05 93.27 0.54 31 0.07 0.05 79.77 0.54\n8 0.09 88.04 0.54 32 0.09 79.35 0.54\n9 0.13 79.15 0.54 33 0.13 79.15 0.54\n10 0.17 72.12 0.55 34 0.17 76.38 0.54\n11 0.19 69.31 0.56 35 0.19 75.00 0.54\n12 0.20 65.96 0.56 36 0.20 73.73 0.54\n13 0.01 0.05 92.62 0.54 37 0.10 0.05 74.38 0.54\n14 0.09 87.46 0.54 38 0.09 74.58 0.55\n15 0.13 78.62 0.55 39 0.13 74.62 0.54\n16 0.17 72.15 0.56 40 0.17 74.54 0.54\n17 0.19 69.04 0.56 41 0.19 74.65 0.54\n18 0.20 66.19 0.56 42 0.20 74.38 0.54\n19 0.03 0.05 90.54 0.55 43 0.13 0.05 71.31 0.54\n20 0.09 84.65 0.57 44 0.09 70.92 0.55\n21 0.13 80.85 0.54 45 0.13 70.62 0.55\n22 0.17 75.42 0.54 46 0.17 70.65 0.55\n23 0.19 73.46 0.54 47 0.19 70.81 0.55\n24 0.20 71.88 0.54 48 0.20 70.77 0.55\n\nFigure A.3. Bias for Y in 13 extra locations, for all 200 simulations, for b=0.3.\n\nSelecting the best mesh\n\n\n\n67\n\n(I)\n\n(II)\n\n(III)\n\nFigure A.4. For each value of a, minimum value of:(I)DIC; (II) WAIC and (III)logCPO, for all 200\nsimulations, for b=0.3 with n=50.\n\n\n\n68\n\nTable A.7. Mean values of DIC, WAIC and logCPO for meshes with b=0.3 for n=50.\n\nMesh c a DIC WAIC logCPO Mesh c a DIC WAIC logCPO\n1 0.001 0.05 -288.32 -295.62 2.31 25 0.05 0.05 -9.21 -5.38 1.69\n2 0.09 -286.83 -294.16 2.30 26 0.09 -26.82 -25.34 1.74\n3 0.13 -286.75 -293.89 2.26 27 0.13 82.06 84.10 1.43\n4 0.17 -286.63 -293.64 2.24 28 0.17 97.90 98.59 1.41\n5 0.19 -286.25 -293.34 2.26 29 0.19 108.68 109.72 1.37\n6 0.20 -286.39 -293.46 2.25 30 0.20 108.39 109.89 1.37\n7 0.005 0.05 -288.32 -295.62 2.31 31 0.07 0.05 103.82 105.70 1.39\n8 0.09 -286.83 -294.16 2.29 32 0.09 103.59 104.93 1.39\n9 0.13 -286.75 -293.89 2.26 33 0.13 104.92 106.40 1.38\n10 0.17 -286.63 -293.64 2.24 34 0.17 119.19 120.30 1.35\n11 0.19 -286.25 -293.34 2.26 35 0.19 123.92 124.77 1.35\n12 0.20 -286.39 -293.46 2.25 36 0.20 124.63 125.44 1.35\n13 0.01 0.05 -259.84 -264.27 2.25 37 0.10 0.05 125.45 126.37 1.35\n14 0.09 -253.27 -258.52 2.23 38 0.09 126.95 128.03 1.35\n15 0.13 -244.01 -246.87 2.16 39 0.13 127.08 128.03 1.35\n16 0.17 -244.53 -245.40 2.12 40 0.17 127.17 128.13 1.35\n17 0.19 -242.69 -244.77 2.15 41 0.19 127.35 128.31 1.35\n18 0.20 -243.27 -244.81 2.14 42 0.20 127.50 128.45 1.35\n19 0.03 0.05 -167.43 -166.10 2.02 43 0.13 0.05 130.57 131.41 1.36\n20 0.09 -94.18 -92.02 1.86 44 0.09 131.11 131.95 1.36\n21 0.13 14.21 21.02 1.55 45 0.13 131.26 132.08 1.36\n22 0.17 24.51 26.20 1.55 46 0.17 131.31 132.14 1.36\n23 0.19 36.91 40.09 1.51 47 0.19 131.12 131.98 1.36\n24 0.20 36.69 40.18 1.50 48 0.20 131.28 132.11 1.36\n\n\n\n69\n\nFigure A.5. Estimates for ?0, ?1, ?2e , ?2s , k and ??, considering the mesh with minimal DIC, WAIC\nand logCPO, and estimates considering mesh 27.\n\n\n\n70\n\nSimulation study with n=300\n\nImpact of mesh on inference\n\nFigure A.6. Coverage of the meshes for: beta0, beta1, ?2e , ?2s , k and ?? with n=300.\n\n\n\n71\n\nTable A.8. Coverage, in %, of the 95% credible intervals of the parameters?0, ?1, ?2e , ?2s , k and ?? for\ndifferent meshes with b = 0.3, for n = 300.\n\nCoverage in % for:\nMesh c a ?0 ?1 ?2e ?2s k ??\n\n1 0.001 0.05 97.00 92.00 80.00 91.00 80.00 80.00\n2 0.09 95.50 91.00 69.50 77.00 69.00 69.00\n3 0.13 95.00 92.00 68.50 77.00 68.50 69.00\n4 0.17 95.00 92.00 72.50 78.50 69.50 70.00\n5 0.19 95.00 92.00 72.50 78.50 69.50 70.00\n6 0.20 95.00 92.00 72.50 78.50 69.50 70.00\n7 0.005 0.05 97.00 91.50 81.50 91.50 80.00 80.00\n8 0.09 95.00 92.00 77.00 81.50 75.00 75.00\n9 0.13 94.50 91.50 74.50 82.00 72.00 72.00\n10 0.17 94.50 91.00 76.50 82.50 74.50 75.00\n11 0.19 94.50 91.00 77.00 83.00 75.00 75.00\n12 0.20 94.50 91.00 77.00 83.00 75.00 75.00\n13 0.01 0.05 98.00 92.00 90.00 95.00 88.50 88.50\n14 0.09 97.50 92.50 86.00 94.00 88.50 88.00\n15 0.13 97.00 92.50 86.50 93.50 86.00 86.00\n16 0.17 97.50 92.50 86.00 93.00 86.50 86.50\n17 0.19 97.50 92.50 86.00 93.00 86.50 86.50\n18 0.20 97.50 92.50 86.00 93.00 86.50 86.50\n19 0.03 0.05 97.50 92.50 75.50 94.50 88.00 88.50\n20 0.09 97.50 92.00 55.00 92.00 87.00 87.00\n21 0.13 98.00 92.50 45.50 94.00 87.50 87.50\n22 0.17 97.50 92.50 45.00 94.50 87.00 87.00\n23 0.19 97.50 92.50 45.00 94.50 87.50 87.50\n24 0.20 97.50 92.50 45.00 94.50 87.50 87.50\n25 0.05 0.05 97.50 93.00 20.00 95.00 86.00 86.00\n26 0.09 98.00 93.50 20.00 95.00 86.50 86.50\n27 0.13 97.00 94.00 6.50 96.50 87.50 87.50\n28 0.17 97.00 93.50 4.00 96.50 88.00 88.00\n29 0.19 97.00 93.50 4.00 97.00 86.50 86.50\n30 0.20 97.00 93.50 4.00 97.00 86.00 86.00\n31 0.07 0.05 97.00 93.50 1.00 96.00 88.50 88.50\n32 0.09 97.00 93.50 1.00 97.00 88.00 88.00\n33 0.13 97.50 93.50 1.00 97.00 88.50 88.50\n34 0.17 97.00 94.00 0.00 96.00 87.50 87.50\n35 0.19 96.50 93.50 0.00 96.50 89.00 89.00\n36 0.20 96.50 93.50 0.00 97.00 88.50 88.50\n37 0.10 0.05 97.00 93.50 0.00 91.00 86.00 85.50\n38 0.09 97.00 94.50 0.00 89.50 83.50 83.50\n39 0.13 96.50 93.50 0.00 90.00 86.50 86.50\n40 0.17 96.50 93.50 0.00 90.00 86.50 86.50\n41 0.19 96.50 93.50 0.00 89.50 86.50 86.50\n42 0.20 96.00 94.00 0.00 89.00 85.50 85.50\n43 0.13 0.05 96.50 93.50 0.00 78.50 82.50 82.50\n44 0.09 97.00 92.50 0.00 80.50 82.00 82.00\n45 0.13 96.50 92.00 0.00 78.00 81.00 81.00\n46 0.17 97.50 93.00 0.00 78.50 81.50 81.50\n47 0.19 97.00 93.00 0.00 79.50 80.50 80.50\n48 0.20 97.50 93.00 0.00 78.50 81.50 81.50\n\n\n\n72\n\nTable A.9. Absolute bias of the parameters?0, ?1, ?2e , ?2s , k and ?? for different meshes with b = 0.3,\nfor n = 300.\n\nBias for:\nMesh c a ?0 ?1 ?2e ?2s k ??\n\n1 0.001 0.05 0.02 0.01 0.03 0.01 1.64 0.01\n2 0.09 0.02 0.01 0.05 0.05 3.24 0.00\n3 0.13 0.02 0.01 0.05 0.07 3.12 0.00\n4 0.17 0.02 0.01 0.05 0.07 2.91 0.00\n5 0.19 0.02 0.01 0.05 0.07 2.89 0.00\n6 0.20 0.02 0.01 0.05 0.07 2.89 0.00\n7 0.005 0.05 0.02 0.01 0.03 0.01 1.34 0.01\n8 0.09 0.02 0.01 0.03 0.02 2.29 0.01\n9 0.13 0.02 0.01 0.04 0.05 2.35 0.00\n10 0.17 0.02 0.01 0.03 0.05 2.14 0.00\n11 0.19 0.02 0.01 0.03 0.04 2.05 0.00\n12 0.20 0.02 0.01 0.03 0.04 2.05 0.00\n13 0.01 0.05 0.02 0.01 0.01 0.04 0.36 0.03\n14 0.09 0.02 0.01 0.01 0.03 0.08 0.03\n15 0.13 0.02 0.01 0.01 0.02 0.14 0.02\n16 0.17 0.02 0.01 0.01 0.01 0.10 0.02\n17 0.19 0.02 0.01 0.01 0.01 0.10 0.02\n18 0.20 0.02 0.01 0.01 0.01 0.10 0.02\n19 0.03 0.05 0.02 0.01 0.06 0.04 1.56 0.06\n20 0.09 0.02 0.01 0.08 0.06 1.81 0.07\n21 0.13 0.02 0.01 0.09 0.05 1.62 0.06\n22 0.17 0.02 0.01 0.09 0.04 1.61 0.06\n23 0.19 0.02 0.01 0.09 0.04 1.60 0.06\n24 0.20 0.02 0.01 0.09 0.04 1.60 0.06\n25 0.05 0.05 0.02 0.01 0.12 0.05 1.71 0.07\n26 0.09 0.02 0.01 0.12 0.05 1.69 0.07\n27 0.13 0.02 0.01 0.14 0.05 1.46 0.07\n28 0.17 0.02 0.01 0.15 0.04 1.38 0.07\n29 0.19 0.02 0.01 0.15 0.03 1.35 0.07\n30 0.20 0.02 0.01 0.15 0.03 1.36 0.07\n31 0.07 0.05 0.02 0.01 0.17 0.00 0.75 0.06\n32 0.09 0.02 0.01 0.17 0.00 0.78 0.06\n33 0.13 0.02 0.01 0.17 0.00 0.77 0.06\n34 0.17 0.02 0.01 0.20 0.02 0.29 0.05\n35 0.19 0.02 0.01 0.20 0.04 0.06 0.05\n36 0.20 0.02 0.01 0.20 0.04 0.01 0.05\n37 0.10 0.05 0.02 0.01 0.24 0.25 1.23 0.04\n38 0.09 0.02 0.01 0.25 0.24 1.06 0.04\n39 0.13 0.02 0.01 0.24 0.24 1.00 0.04\n40 0.17 0.02 0.01 0.24 0.24 1.00 0.04\n41 0.19 0.02 0.01 0.25 0.25 1.10 0.04\n42 0.20 0.02 0.01 0.25 0.26 1.21 0.04\n43 0.13 0.05 0.02 0.01 0.29 0.64 2.85 0.04\n44 0.09 0.02 0.01 0.30 0.70 3.14 0.04\n45 0.13 0.01 0.01 0.30 35x10100 3.00 25.75\n46 0.17 0.02 0.01 0.30 48x10100 3.11 27107.18\n47 0.19 0.02 0.01 0.30 48x10100 3.06 27107.18\n48 0.20 0.02 0.01 0.30 48x10100 3.11 27107.18\n\n\n\n73\n\nTable A.10. MSE of the parameters?0, ?1, ?2e , ?2s , k and ?? for different meshes with b = 0.3, for\nn = 300.\n\nMSE for:\nMesh c a ?0 ?1 ?2e ?2s k ??\n\n1 0.001 0.05 0.03 0.03 0.01 0.02 50.01 0.01\n2 0.09 0.03 0.03 0.02 0.04 70.98 0.01\n3 0.13 0.03 0.03 0.02 0.05 62.53 0.01\n4 0.17 0.03 0.03 0.02 0.05 57.79 0.01\n5 0.19 0.03 0.03 0.02 0.05 57.34 0.01\n6 0.20 0.03 0.03 0.02 0.05 57.34 0.01\n7 0.005 0.05 0.03 0.03 0.01 0.03 41.74 0.01\n8 0.09 0.03 0.03 0.01 0.04 52.63 0.01\n9 0.13 0.03 0.03 0.01 0.04 49.64 0.01\n10 0.17 0.03 0.03 0.01 0.04 44.97 0.01\n11 0.19 0.03 0.03 0.01 0.04 43.63 0.01\n12 0.20 0.03 0.03 0.01 0.04 43.63 0.01\n13 0.01 0.05 0.03 0.03 0.01 0.02 11.61 0.01\n14 0.09 0.03 0.03 0.01 0.02 13.99 0.01\n15 0.13 0.03 0.03 0.01 0.02 14.80 0.01\n16 0.17 0.03 0.03 0.01 0.02 13.86 0.01\n17 0.19 0.03 0.03 0.01 0.02 13.86 0.01\n18 0.20 0.03 0.03 0.01 0.02 13.86 0.01\n19 0.03 0.05 0.03 0.03 0.01 0.03 9.27 0.01\n20 0.09 0.03 0.03 0.01 0.03 10.96 0.01\n21 0.13 0.03 0.03 0.01 0.03 10.20 0.01\n22 0.17 0.03 0.03 0.01 0.03 10.37 0.01\n23 0.19 0.03 0.03 0.01 0.03 10.30 0.01\n24 0.20 0.03 0.03 0.01 0.03 10.30 0.01\n25 0.05 0.05 0.03 0.03 0.02 0.03 12.56 0.01\n26 0.09 0.03 0.03 0.02 0.03 13.09 0.01\n27 0.13 0.04 0.03 0.02 0.03 18.25 0.01\n28 0.17 0.04 0.03 0.03 0.03 16.68 0.01\n29 0.19 0.04 0.03 0.03 0.03 17.07 0.01\n30 0.20 0.04 0.03 0.03 0.03 17.04 0.01\n31 0.07 0.05 0.04 0.03 0.03 0.03 23.65 0.01\n32 0.09 0.04 0.03 0.03 0.03 24.57 0.01\n33 0.13 0.04 0.03 0.03 0.03 23.70 0.01\n34 0.17 0.04 0.03 0.04 0.04 41.76 0.01\n35 0.19 0.04 0.03 0.04 0.07 55.41 0.01\n36 0.20 0.04 0.03 0.04 0.07 50.53 0.01\n37 0.10 0.05 0.04 0.03 0.06 0.35 64.42 0.02\n38 0.09 0.04 0.03 0.06 0.25 57.28 0.02\n39 0.13 0.04 0.03 0.06 0.24 55.05 0.02\n40 0.17 0.04 0.03 0.06 0.24 55.05 0.02\n41 0.19 0.04 0.03 0.06 0.31 60.95 0.02\n42 0.20 0.04 0.03 0.07 0.29 61.35 0.02\n43 0.13 0.05 0.04 0.03 0.09 1.42 104.70 0.02\n44 0.09 0.04 0.03 0.09 1.73 116.24 0.03\n45 0.13 0.04 0.03 0.09 14x10100 114.39 13x105\n46 0.17 0.04 0.03 0.09 14x10100 127.19 14x1010\n47 0.19 0.04 0.03 0.09 14x10100 125.52 14x1010\n48 0.20 0.04 0.03 0.09 14x10100 127.19 14x1010\n\n\n\n74\n\nTable A.11. Nominal coverage, in %, and MSE for the variable Y calculated for each mesh with b=0.3,\nconsidering 200 simulations, for n=300.\n\nMesh c a Coverage(%) MSE Mesh c a Coverage(%) MSE\n1 0.001 0.05 90.08 0.16 25 0.05 0.05 87.74 0.18\n2 0.09 86.75 0.17 26 0.09 87.73 0.18\n3 0.13 86.99 0.17 27 0.13 84.80 0.19\n4 0.17 87.46 0.17 28 0.17 83.81 0.20\n5 0.19 87.53 0.17 29 0.19 83.75 0.20\n6 0.20 87.53 0.17 30 0.20 83.73 0.20\n7 0.005 0.05 90.83 0.16 31 0.07 0.05 81.81 0.21\n8 0.09 89.17 0.17 32 0.09 81.69 0.21\n9 0.13 88.77 0.17 33 0.13 81.75 0.21\n10 0.17 89.53 0.17 34 0.17 78.25 0.22\n11 0.19 89.70 0.17 35 0.19 77.31 0.23\n12 0.20 89.70 0.17 36 0.20 77.15 0.23\n13 0.01 0.05 93.70 0.15 37 0.10 0.05 71.87 0.25\n14 0.09 93.42 0.15 38 0.09 71.23 0.26\n15 0.13 93.47 0.15 39 0.13 71.49 0.26\n16 0.17 93.50 0.15 40 0.17 71.49 0.26\n17 0.19 93.49 0.15 41 0.19 71.33 0.26\n18 0.20 93.49 0.15 42 0.20 70.73 0.26\n19 0.03 0.05 92.30 0.16 43 0.13 0.05 63.44 0.30\n20 0.09 90.70 0.16 44 0.09 62.91 0.30\n21 0.13 90.06 0.17 45 0.13 62.76 0.30\n22 0.17 89.88 0.17 46 0.17 62.47 0.30\n23 0.19 89.87 0.17 47 0.19 62.59 0.30\n24 0.20 89.87 0.17 48 0.20 62.47 0.30\n\n\n\n75\n\nTable A.12. Nominal coverage, in %, and MSE for the variable Y calculated for each mesh with b = 0.3,\nconsidering 200 simulations, for 75 locations not in the analysis.\n\nMesh c a Coverage(%) MSE Mesh c a Coverage(%) MSE\n1 0.001 0.05 87.41 0.31 25 0.05 0.05 79.54 0.30\n2 0.09 76.05 0.32 26 0.09 79.50 0.30\n3 0.13 73.03 0.32 27 0.13 74.19 0.31\n4 0.17 73.11 0.32 28 0.17 70.81 0.31\n5 0.19 73.03 0.32 29 0.19 70.17 0.31\n6 0.20 73.03 0.32 30 0.20 70.12 0.31\n7 0.005 0.05 87.45 0.30 31 0.07 0.05 74.32 0.32\n8 0.09 80.17 0.31 32 0.09 74.18 0.32\n9 0.13 77.83 0.31 33 0.13 74.26 0.32\n10 0.17 77.15 0.31 34 0.17 69.95 0.32\n11 0.19 77.11 0.31 35 0.19 67.43 0.33\n12 0.20 77.11 0.31 36 0.20 66.99 0.33\n13 0.01 0.05 87.60 0.30 37 0.10 0.05 65.80 0.34\n14 0.09 81.55 0.30 38 0.09 65.20 0.35\n15 0.13 79.32 0.30 39 0.13 65.53 0.34\n16 0.17 78.88 0.30 40 0.17 65.53 0.34\n17 0.19 78.85 0.30 41 0.19 65.38 0.35\n18 0.20 78.85 0.30 42 0.20 64.92 0.35\n19 0.03 0.05 86.01 0.30 43 0.13 0.05 58.07 0.37\n20 0.09 80.59 0.30 44 0.09 57.44 0.38\n21 0.13 75.27 0.30 45 0.13 57.19 0.38\n22 0.17 73.94 0.30 46 0.17 56.89 0.38\n23 0.19 73.82 0.30 47 0.19 56.73 0.38\n24 0.20 73.78 0.30 48 0.20 56.89 0.38\n\n\n\n76\n\nFigure A.7. Bias for Y in 75 extra locations, for all 200 simulations, for b=0.3.\n\nSelecting the best mesh\n\n\n\n77\n\n(I)\n\n(II)\n\n(III)\n\nFigure A.8. For each value of a, minimum value of:(I)DIC; (II) WAIC and (III)logCPO, for all 200\nsimulations, for b=0.3 with n=300.\n\n\n\n78\n\nTable A.13. Mean values of DIC, WAIC and logCPO for meshes with b=0.3 for n=300.\n\nMesh c a DIC WAIC logCPO Mesh c a DIC WAIC logCPO\n1 0.001 0.05 559.42 558.85 1.18 25 0.05 0.05 683.73 684.27 1.17\n2 0.09 499.23 494.29 1.20 26 0.09 683.82 684.36 1.17\n3 0.13 502.19 495.79 1.20 27 0.13 691.72 692.03 1.18\n4 0.17 506.62 502.02 1.20 28 0.17 694.74 695.01 1.18\n5 0.19 507.47 502.82 1.20 29 0.19 694.85 695.13 1.18\n6 0.20 507.47 502.82 1.20 30 0.20 694.91 695.19 1.18\n7 0.005 0.05 581.58 580.48 1.17 31 0.07 0.05 698.96 699.83 1.18\n8 0.09 557.66 552.72 1.17 32 0.09 699.29 700.14 1.18\n9 0.13 547.11 541.86 1.18 33 0.13 699.05 699.91 1.18\n10 0.17 563.49 557.37 1.17 34 0.17 706.11 706.65 1.19\n11 0.19 565.44 559.80 1.17 35 0.19 707.55 707.97 1.19\n12 0.20 565.44 559.80 1.17 36 0.20 707.72 708.11 1.19\n13 0.01 0.05 633.13 634.15 1.16 37 0.10 0.05 718.08 719.39 1.20\n14 0.09 634.34 635.34 1.16 38 0.09 719.85 721.11 1.21\n15 0.13 633.61 634.30 1.16 39 0.13 719.30 720.53 1.21\n16 0.17 634.02 634.72 1.16 40 0.17 719.30 720.53 1.21\n17 0.19 634.02 634.70 1.16 41 0.19 719.64 720.86 1.21\n18 0.20 634.02 634.70 1.16 42 0.20 720.88 722.01 1.21\n19 0.03 0.05 662.41 662.78 1.17 43 0.13 0.05 732.98 733.78 1.23\n20 0.09 672.36 672.62 1.17 44 0.09 733.87 734.63 1.23\n21 0.13 675.26 675.52 1.17 45 0.13 734.37 735.14 1.23\n22 0.17 675.98 676.28 1.17 46 0.17 735.14 735.81 1.23\n23 0.19 675.99 676.29 1.17 47 0.19 735.00 735.69 1.23\n24 0.20 676.01 676.31 1.17 48 0.20 735.14 735.81 1.23\n\n\n\n79\n\nFigure A.9. Boxplots for estimated ?0, ?1, ?2e , ?2s , k and ??, considering the mesh with minimal DIC,\nWAIC and logCPO, and boxplots of estimated considering mesh 13.\n\n\n\n80\n\nAdditional data analysis results\n\nFigure A.10. Meshes with c = 13, b = 570 and a = (20, 35, 55, 100, 240, 380).\n\nFigure A.11. Meshes with c = 35, b = 570 and a = (20, 35, 55, 100, 240, 380).\n\nFigure A.12. Meshes with c = 51, b = 570 and a = (20, 35, 55, 100, 240, 380).\n\n\n\n81\n\nFigure A.13. Posterior density for meshes with c = 13.\n\nFigure A.14. Posterior density for meshes with c = 35.\n\n\n\n82\n\nFigure A.15. Posterior density for meshes with c = 51.\n\n\n\n83\n\nAppendix B: Supplementary Material for Chapter 3\n\nAdditional simulations results\n\nIn Section 3 of the paper a simulation study is presented. In this section of the supplementary\nmaterials we provide some extra figures and tables\n\nThe colours of the graphics in the following sessions are: green for c=0.005, blue for c=0.03,\nlight blue for c=0.07 and pink for c=0.10 and in each group of these colours, the value of a increases from\nleft to right. First are the meshes from GM1, in the middle the meshes of GM2 and then the meshes\nfrom GM3.\n\nSimulation study with random data set\n\nFigure B.1. Coverage of the meshes for: beta0, beta1, ?2e , ?2s , k and ??, with random data set.\n\n\n\n84\n\nTable B.1. MSE of the parameters ?0, ?1, ?2e , ?2s , k and ?? and for\n?2s\n?\n\n, considering all meshes with\nrandom data set.\n\nMSE for:\nGroup Mesh c a ?0 ?1 ?2e ?2s k ??\n\n?2s\n?\n\n1 0.005 0.050 0.076 0.142 0.074 0.107 342.507 0.042 0.037\n2 0.005 0.090 0.073 0.143 0.078 0.518 334.709 0.020 0.008\n3 0.005 0.170 0.071 0.143 0.078 0.424 124.373 0.022 0.011\n4 0.005 0.200 0.071 0.141 0.078 0.459 109.720 0.023 0.014\n5 0.030 0.050 0.064 0.115 0.027 0.214 234.545 0.068 0.043\n6 0.030 0.090 0.062 0.111 0.020 0.054 36.953 0.074 0.046\n7 0.030 0.170 0.062 0.109 0.019 0.071 25.885 0.085 0.055\n\nGM1 8 0.030 0.200 0.062 0.108 0.020 0.076 24.274 0.075 0.059\n9 0.070 0.050 0.061 0.100 0.031 0.099 77.397 0.118 0.097\n10 0.070 0.090 0.061 0.101 0.032 0.133 73.769 0.112 0.101\n11 0.070 0.170 0.061 0.100 0.041 0.137 64.926 0.121 0.086\n12 0.070 0.200 0.061 0.101 0.045 0.227 79.323 0.113 0.079\n13 0.010 0.050 0.061 0.102 0.059 0.661 91.492 0.134 0.091\n14 0.010 0.090 0.061 0.102 0.059 0.475 92.817 0.135 0.090\n15 0.010 0.170 0.061 0.102 0.059 0.690 92.569 0.136 0.090\n16 0.010 0.200 0.062 0.102 0.060 0.539 88.267 0.134 0.102\n17 0.005 0.050 0.066 0.123 0.039 0.431 303.055 0.082 0.060\n18 0.005 0.090 0.063 0.104 0.024 0.819 135.185 0.101 0.078\n19 0.005 0.170 0.060 0.101 0.052 5.094 209.869 0.103 0.080\n20 0.005 0.200 0.061 0.103 0.067 2.482 150.564 0.131 0.141\n21 0.030 0.050 0.065 0.120 0.033 0.341 178.225 0.088 0.064\n22 0.030 0.090 0.063 0.104 0.024 0.819 135.185 0.101 0.078\n23 0.030 0.170 0.060 0.101 0.052 5.094 209.869 0.103 0.080\n\nGM2 24 0.030 0.200 0.061 0.103 0.067 2.482 150.564 0.131 0.141\n25 0.070 0.050 0.060 0.100 0.038 1.083 122.125 0.086 0.063\n26 0.070 0.090 0.060 0.099 0.038 0.751 115.402 0.095 0.063\n27 0.070 0.170 0.060 0.101 0.052 5.094 209.869 0.103 0.080\n28 0.070 0.200 0.061 0.103 0.067 2.482 150.564 0.131 0.141\n29 0.010 0.050 0.062 0.103 0.063 11.461 233.469 0.112 0.139\n30 0.010 0.090 0.059 0.099 0.062 4.373 194.848 0.144 0.174\n31 0.010 0.170 0.059 0.099 0.063 2.485 136.485 0.097 0.060\n32 0.010 0.200 0.058 0.099 0.063 10.929 212.877 0.131 0.142\n33 0.005 0.050 0.066 0.125 0.036 0.137 114.452 0.074 0.046\n34 0.005 0.090 0.064 0.111 0.023 0.137 68.511 0.086 0.056\n35 0.005 0.170 0.062 0.101 0.045 0.580 112.107 0.115 0.071\n36 0.005 0.200 0.063 0.103 0.054 0.511 111.039 0.115 0.072\n37 0.030 0.050 0.066 0.120 0.027 0.587 416.993 0.057 0.045\n38 0.030 0.090 0.064 0.111 0.023 0.138 68.930 0.087 0.057\n39 0.030 0.170 0.062 0.101 0.046 0.574 112.003 0.116 0.071\n\nGM3 40 0.030 0.200 0.063 0.103 0.054 0.514 109.933 0.114 0.071\n41 0.070 0.050 0.062 0.104 0.035 0.325 82.094 0.104 0.067\n42 0.070 0.090 0.062 0.103 0.035 0.318 68.569 0.109 0.063\n43 0.070 0.170 0.062 0.103 0.047 0.443 98.785 0.123 0.093\n44 0.070 0.200 0.062 0.104 0.057 0.705 101.313 0.117 0.071\n45 0.010 0.050 0.061 0.102 0.059 1.131 142.069 0.127 0.079\n46 0.010 0.090 0.061 0.101 0.060 2.132 164.644 0.122 0.082\n47 0.010 0.170 0.061 0.102 0.060 1.258 139.509 0.129 0.081\n48 0.010 0.200 0.061 0.102 0.061 2.103 161.523 0.133 0.079\n\n\n\n85\n\nSimulation study with regular data set\n\nFigure B.2. Coverage of the meshes for: beta0, beta1, ?2e , ?2s , k and ??, with regular data set.\n\nTable B.2. MSE of the parameters ?0, ?1, ?2e , ?2s , k and ?? and for\n?2s\n?\n\n, considering all meshes with\nregular data set.\n\nMSE for:\n\nGroup Mesh c a ?0 ?1 ?2e ?\n2\ns k ?\n\n? ?\n2\ns\n?\n\n1 0.005 0.050 0.059 0.122 0.090 3.031 1513.227 0.005 0.005\n2 0.005 0.090 0.059 0.123 0.090 55.848 1607.877 0.006 0.005\n3 0.005 0.170 0.061 0.125 0.090 57.665 470.474 0.009 0.007\n4 0.005 0.200 0.061 0.126 0.090 69.132 797.943 0.010 0.010\n5 0.030 0.050 0.059 0.123 0.090 2.272 757.171 0.005 0.005\n6 0.030 0.090 0.059 0.123 0.090 55.848 1607.877 0.006 0.005\n7 0.030 0.170 0.061 0.125 0.090 57.665 470.474 0.009 0.007\n\nGM1 8 0.030 0.200 0.061 0.126 0.090 69.132 797.943 0.010 0.010\n9 0.070 0.050 0.059 0.121 0.090 101.645 1420.148 0.006 0.011\n\n10 0.070 0.090 0.059 0.121 0.090 111.090 1247.377 0.006 0.010\n11 0.070 0.170 0.060 0.125 0.090 294.339 1147.598 0.010 0.012\n12 0.070 0.200 0.060 0.125 0.090 2146.851 2683.051 0.009 0.032\n13 0.010 0.050 0.060 0.125 0.090 805.068 2435.142 0.010 0.027\n14 0.010 0.090 0.060 0.125 0.090 805.068 2435.142 0.010 0.027\n15 0.010 0.170 0.060 0.125 0.090 805.068 2435.142 0.010 0.027\n16 0.010 0.200 0.060 0.125 0.090 805.068 2435.142 0.010 0.027\n17 0.005 0.050 0.061 0.124 0.090 8.358 825.628 0.006 0.004\n18 0.005 0.090 0.061 0.132 0.090 72.039 1158.467 0.009 0.007\n19 0.005 0.170 0.061 0.128 0.095 1.984 83.765 0.171 0.042\n20 0.005 0.200 0.059 0.125 0.124 1.148 71.887 0.185 0.039\n21 0.030 0.050 0.060 0.125 0.090 1.519 269.073 0.007 0.004\n22 0.030 0.090 0.061 0.132 0.090 72.039 1158.467 0.009 0.007\n23 0.030 0.170 0.061 0.128 0.095 1.984 83.765 0.171 0.042\n\nGM2 24 0.030 0.200 0.059 0.125 0.124 1.148 71.887 0.185 0.039\n25 0.070 0.050 0.067 0.140 0.085 380.776 1497.534 0.072 0.036\n26 0.070 0.090 0.067 0.143 0.085 4458.014 3401.350 0.085 0.086\n27 0.070 0.170 0.061 0.128 0.095 1.984 83.765 0.171 0.042\n28 0.070 0.200 0.059 0.125 0.124 1.148 71.887 0.185 0.039\n29 0.010 0.050 0.059 0.127 0.125 0.830 75.770 0.266 0.040\n30 0.010 0.090 0.059 0.127 0.116 1.661 97.474 0.222 0.040\n31 0.010 0.170 0.059 0.126 0.117 2.239 91.836 0.170 0.032\n32 0.010 0.200 0.059 0.125 0.119 0.950 78.014 0.179 0.031\n33 0.005 0.050 0.060 0.124 0.090 0.131 34.614 0.004 0.005\n34 0.005 0.090 0.064 0.136 0.090 47.797 725.652 0.005 0.008\n35 0.005 0.170 0.060 0.128 0.086 0.120 37.899 0.205 0.044\n36 0.005 0.200 0.059 0.126 0.093 0.126 40.235 0.213 0.047\n37 0.030 0.050 0.061 0.128 0.090 1.674 562.439 0.005 0.005\n38 0.030 0.090 0.064 0.136 0.090 47.797 725.652 0.005 0.008\n39 0.030 0.170 0.060 0.128 0.086 0.120 37.899 0.205 0.044\n\nGM3 40 0.030 0.200 0.059 0.126 0.093 0.126 40.235 0.213 0.047\n41 0.070 0.050 0.063 0.155 0.083 498.872 1652.502 0.107 0.035\n42 0.070 0.090 0.066 0.151 0.087 310.197 932.174 0.041 0.024\n43 0.070 0.170 0.059 0.128 0.090 0.121 41.305 0.212 0.047\n44 0.070 0.200 0.059 0.127 0.093 0.126 42.211 0.211 0.047\n45 0.010 0.050 0.059 0.126 0.092 0.138 44.709 0.208 0.046\n46 0.010 0.090 0.059 0.125 0.098 0.154 46.126 0.256 0.053\n47 0.010 0.170 0.059 0.126 0.092 0.138 43.749 0.208 0.046\n48 0.010 0.200 0.059 0.126 0.092 0.138 43.749 0.208 0.046\n\n\n\n86\n\nSimulation study with cluster data set\n\nFigure B.3. Coverage of the meshes for: beta0, beta1, ?2e , ?2s , k and ??, with cluster data set.\n\n\n\n87\n\nTable B.3. MSE of the parameters ?0, ?1, ?2e , ?2s , k and ?? and for\n?2s\n?\n\n, considering all meshes with\ncluster data set.\n\nMSE for:\nGroup Mesh c a ?0 ?1 ?2e ?2s k ??\n\n?2s\n?\n\n1 0.005 0.050 0.077 0.122 0.067 0.098 358.855 0.029 0.015\n2 0.005 0.090 0.079 0.137 0.069 0.212 224.366 0.028 0.013\n3 0.005 0.170 0.080 0.140 0.068 0.371 105.996 0.047 0.023\n4 0.005 0.200 0.075 0.123 0.068 0.397 86.291 0.030 0.010\n5 0.030 0.050 0.070 0.096 0.016 0.052 117.775 0.037 0.023\n6 0.030 0.090 0.068 0.095 0.015 0.068 92.372 0.040 0.031\n7 0.030 0.170 0.068 0.094 0.018 0.065 60.188 0.060 0.035\n\nGM1 8 0.030 0.200 0.067 0.093 0.017 0.062 48.392 0.046 0.027\n9 0.070 0.050 0.070 0.097 0.033 0.233 104.191 0.076 0.042\n10 0.070 0.090 0.070 0.098 0.033 0.212 111.425 0.075 0.039\n11 0.070 0.170 0.070 0.096 0.041 0.159 87.497 0.083 0.050\n12 0.070 0.200 0.070 0.098 0.044 0.176 73.412 0.088 0.057\n13 0.010 0.050 0.070 0.097 0.056 0.861 129.622 0.131 0.079\n14 0.010 0.090 0.070 0.098 0.057 0.875 123.825 0.131 0.082\n15 0.010 0.170 0.070 0.097 0.056 0.770 120.767 0.140 0.092\n16 0.010 0.200 0.069 0.097 0.059 0.900 131.053 0.132 0.086\n17 0.005 0.050 0.071 0.096 0.024 0.111 89.881 0.064 0.043\n18 0.005 0.090 0.070 0.092 0.023 0.167 95.257 0.077 0.039\n19 0.005 0.170 0.070 0.096 0.053 2.064 176.069 0.123 0.100\n20 0.005 0.200 0.071 0.097 0.069 1.559 125.360 0.148 0.108\n21 0.030 0.050 0.070 0.094 0.021 0.199 147.394 0.062 0.042\n22 0.030 0.090 0.070 0.092 0.023 0.167 95.257 0.077 0.039\n23 0.030 0.170 0.070 0.096 0.053 2.064 176.069 0.123 0.100\n\nGM2 24 0.030 0.200 0.071 0.097 0.069 1.559 125.360 0.148 0.108\n25 0.070 0.050 0.071 0.098 0.040 1.201 147.496 0.090 0.055\n26 0.070 0.090 0.070 0.098 0.037 0.677 138.932 0.090 0.049\n27 0.070 0.170 0.070 0.096 0.053 2.064 176.069 0.123 0.100\n28 0.070 0.200 0.071 0.097 0.069 1.559 125.360 0.148 0.108\n29 0.010 0.050 0.071 0.096 0.067 2.519 173.810 0.166 0.190\n30 0.010 0.090 0.071 0.096 0.064 2.352 163.539 0.123 0.066\n31 0.010 0.170 0.072 0.102 0.064 1.518 146.115 0.137 0.122\n32 0.010 0.200 0.070 0.097 0.065 2.870 182.690 0.155 0.118\n33 0.005 0.050 0.072 0.103 0.019 0.087 172.062 0.043 0.027\n34 0.005 0.090 0.070 0.095 0.019 0.091 83.856 0.051 0.032\n35 0.005 0.170 0.072 0.097 0.040 0.120 75.647 0.107 0.067\n36 0.005 0.200 0.072 0.099 0.044 0.376 126.372 0.105 0.074\n37 0.030 0.050 0.071 0.096 0.017 0.093 93.509 0.042 0.027\n38 0.030 0.090 0.070 0.095 0.019 0.092 85.093 0.051 0.033\n39 0.030 0.170 0.072 0.097 0.040 0.121 74.818 0.107 0.067\n\nGM3 40 0.030 0.200 0.072 0.099 0.044 0.351 115.666 0.105 0.072\n41 0.070 0.050 0.072 0.097 0.034 0.231 101.557 0.087 0.053\n42 0.070 0.090 0.072 0.098 0.034 0.209 94.262 0.088 0.055\n43 0.070 0.170 0.072 0.098 0.042 0.284 107.271 0.128 0.122\n44 0.070 0.200 0.072 0.100 0.047 0.718 142.403 0.126 0.110\n45 0.010 0.050 0.073 0.101 0.057 0.350 103.119 0.144 0.152\n46 0.010 0.090 0.074 0.101 0.057 0.344 96.259 0.148 0.158\n47 0.010 0.170 0.073 0.101 0.057 0.360 104.559 0.142 0.150\n48 0.010 0.200 0.073 0.100 0.058 0.625 131.008 0.139 0.142\n\n\n\n88\n\nAdditional data analysis results\n\n\u2022 Parana? dataset\n\nFigure B.4. Meshes with c = 13, b = 570 and a = (20, 35, 55, 100, 240, 380) of GM1.\n\nFigure B.5. Meshes with c = 35, b = 570 and a = (20, 35, 55, 100, 240, 380) of GM1.\n\nFigure B.6. Meshes with c = 51, b = 570 and a = (20, 35, 55, 100, 240, 380)of GM1.\n\n\n\n89\n\nFigure B.7. Meshes with c = 13, b = 570 and a = (20, 35, 55, 100, 240, 380) of GM2.\n\nFigure B.8. Meshes with c = 35, b = 570 and a = (20, 35, 55, 100, 240, 380) of GM2.\n\nFigure B.9. Meshes with c = 51, b = 570 and a = (20, 35, 55, 100, 240, 380)of GM2.\n\n\n\n90\n\nFigure B.10. Meshes with c = 13, b = 570 and a = (20, 35, 55, 100, 240, 380) of GM3.\n\nFigure B.11. Meshes with c = 35, b = 570 and a = (20, 35, 55, 100, 240, 380) of GM3.\n\nFigure B.12. Meshes with c = 51, b = 570 and a = (20, 35, 55, 100, 240, 380)of GM3.\n\n\n\n91\n\nFigure B.13. Posterior density for meshes with Paran\u00e1 data set.\n\n\n\n92\n\n\u2022 Soil data set\n\nFigure B.14. Meshes with c = 14, b = 600 and a = (20, 40, 60, 120, 260, 400) of GM1.\n\nFigure B.15. Meshes with c = 37, b = 600 and a = (20, 40, 60, 120, 260, 400) of GM1.\n\n\n\n93\n\nFigure B.16. Meshes with c = 54, b = 600 and a = (20, 40, 60, 120, 260, 400)of GM1.\n\nFigure B.17. Meshes with c = 14, b600 and a = (20, 40, 60, 120, 260, 400) of GM2.\n\nFigure B.18. Meshes with c = 37, b = 600 and a = (20, 40, 60, 120, 260, 400) of GM2.\n\n\n\n94\n\nFigure B.19. Meshes with c = 54, b = 600 and a = (20, 40, 60, 120, 260, 400) of GM2.\n\nFigure B.20. Meshes with c = 14, b = 600 and a = (20, 40, 60, 120, 260, 400) of GM3.\n\nFigure B.21. Meshes with c = 37, b = 600 and a = (20, 40, 60, 120, 260, 400) of GM3.\n\n\n\n95\n\nFigure B.22. Meshes with c = 54, b = 600 and a = (20, 40, 60, 120, 260, 400) of GM3."}]}}}