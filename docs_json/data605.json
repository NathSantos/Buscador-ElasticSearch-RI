{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-BG.03920"}, {"@name": "filename", "#text": "BGP_2006_14_2_11_Triangulacoes_adaptativas_em_multirresolucao_para_objetos_heterogeneos.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "Triangula\u00e7\u00f5es adaptativas em multirresolu\u00e7\u00e3o para objetos heterog\u00eaneos\nMulti-resolution adaptive triangulations for heterogeneous objects\nRicardo Marroquim I Paulo Roma Cavalcanti\nresumo\nEste artigo apresenta um m\u00e9todo para gerar triangula\u00e7\u00f5es adaptativas em multirresolu\u00e7\u00e3o de objetos 3D com v\u00e1rias regi\u00f5es, geometria complexa e cujas fronteiras n\u00e3o s\u00e3o, necessariamente, variedades. O m\u00e9todo pode ser empregado em modelos geol\u00f3gicos os quais cont\u00eam v\u00e1rias caracter\u00edsticas que dificultam o uso de algoritmos de triangula\u00e7\u00e3o tradicionais, como, por exemplo, falhas, pinch-outs e cavidades. O algoritmo tem como objetivo gerar malhas que n\u00e3o contenham elementos malformados e que suportem deforma\u00e7\u00f5es, sendo desta forma adequados a simula\u00e7\u00f5es num\u00e9ricas. A primeira etapa do estudo \u00e9 mergulhar o modelo em uma\nmalha tetra\u00e9drica adaptativa semi-regular, conhecida como multitriangula\u00e7\u00e3o bin\u00e1ria (binary multiresolution triangulation - BMT). Os elementos da malha s\u00e3o, ent\u00e3o, empurrados em dire\u00e7\u00e3o \u00e0 fronteira original por meio de um sistema de compress\u00e3o baseado em f\u00edsica, no caso deste trabalho, um sistema massa-mola. A triangula\u00e7\u00e3o final n\u00e3o cont\u00e9m tetraedros degenerados e oferece uma aproxima\u00e7\u00e3o da fronteira do modelo baseada em uma escolha de um n\u00edvel de resolu\u00e7\u00e3o adequado.\n(originais recebidos em 10.10.2006)\nPalavras-chave: malhas volum\u00e9tricas | multirresolu\u00e7\u00e3o simula\u00e7\u00f5es num\u00e9ricas\nabstract\nThis paper presents a method for generating multi-resolution triangulations of non-manifold 3D objects composed by several regions with arbitrary geometry. Our target application comes from Geosciences in which geological models for instance are often composed by several regions (forming geo-logical layers), and have an irregular geometry, with surfaces that meet at very small angles (pinch-out). The goal is to generate meshes without bad elements that are able to support deformations and that can be used in numerical simulations. The algorithm has two main steps. In the first step, a grid is adaptively created over the object in order to subdivide the sur-rounding space. The second step shapes the vertices of the grid to the boundary of the object using a compression scheme, while trying to maintain well shaped elements. Springs are placed on each tetra-hedron to prevent them from collapsing and to restrain vertices movements. The final triangulation usually has no degenerated triangles and provides an approximation of the boundary based on a selected resolution.\n(expanded abstract available at the end of the paper)\nKeywords: volumetric meshes I multi-resolution I numerical simulations\nintrodu\u00e7\u00e3o\nAs simula\u00e7\u00f5es num\u00e9ricas se tornaram ferramentas importantes no desenvolvimento de produtos de engenharia e predi\u00e7\u00e3o do comportamento de fen\u00f4menos f\u00edsicos, como condi\u00e7\u00f5es clim\u00e1ticas, gera\u00e7\u00e3o e migra\u00e7\u00e3o de \u00f3leo, movimento das ondas e terremotos.\nPara fazer uso de uma simula\u00e7\u00e3o num\u00e9rica, \u00e9 necess\u00e1rio que o dom\u00ednio em quest\u00e3o seja discre-tizado. Nesta discretiza\u00e7\u00e3o, geralmente conhecida como triangula\u00e7\u00e3o, uma s\u00e9rie de equa\u00e7\u00f5es, descrevendo leis f\u00edsicas, devem ser resolvidas.\nV\u00e1rios algoritmos de triangula\u00e7\u00e3o foram propostos nos \u00faltimos anos. Dentre eles, aqueles conhecidos como m\u00e9todos de Delaunay obtiveram um n\u00edvel alto de aceita\u00e7\u00e3o em muitas \u00e1reas. Por\u00e9m, eles n\u00e3o foram t\u00e3o bem-sucedidos em\ntr\u00eas dimens\u00f5es como o foram em duas (Molino et al. 2003), devido ao fato de produzirem tetrae-dros com volume desprez\u00edvel, conhecidos como tetraedros \"chatos\". Shewchuk (1998) oferece uma vis\u00e3o geral dos m\u00e9todos de Delaunay e raz\u00f5es pelas quais alguns resultados te\u00f3ricos podem ser dif\u00edceis de serem obtidos na pr\u00e1tica. Cheng et al. (2000) discutem v\u00e1rios m\u00e9todos para remover os tetraedros \"chatos\", contudo admitem que sua estimativa ainda \u00e9 muito pessimista. Edelsbrunner e Guoy (2002) mostram que o m\u00e9todo de Cheng etal. (2000) pode apresentar problemas perto das fronteiras.\nA maioria das aplica\u00e7\u00f5es num\u00e9ricas requer triangula\u00e7\u00f5es que preservem fielmente a fronteira de um modelo. Em tr\u00eas dimens\u00f5es, isto significa que a fronteira deve corresponder a faces triangulares de tetraedros. Enquanto o m\u00e9todo tradicional de Delaunay triangula apenas o fecho convexo do modelo, v\u00e1rias extens\u00f5es foram propostas para garantir que fronteiras poligonais arbitr\u00e1rias estejam presentes na triangula\u00e7\u00e3o final. Muitos destes m\u00e9todos constroem primeiro uma triangula\u00e7\u00e3o de Delaunay n\u00e3o restrita, e depois inserem novos v\u00e9rtices para recuperar as faces ou arestas ausentes (Murphy et al. 2001; Cohen-Steiner et al. 2002; George e Borouchaki, 1998; Weatherhill e Hassan, 1994; Shewchuk, 2002).\nComo alternativa para os m\u00e9todos baseados em Delaunay, existem os m\u00e9todos de \"Avan\u00e7o de Fronteira\" (Mavriplis, 1995; Lohner e Parikh, 1988; Peraire et al. 1999; Lohner 1996; Frey et al. 1996; Fleischmann e Siegfried, 1997). Estes m\u00e9todos partem da fronteira (j\u00e1 triangulada) e adicionam novos v\u00e9rtices para criar tetraedros de boa forma, avan\u00e7ando a fronteira para o interior do modelo. A dificuldade est\u00e1 em compatibilizar as diferentes frentes sem gerar inconsist\u00eancias geom\u00e9tricas. A cria\u00e7\u00e3o dos novos elementos pode seguir uma variedade de metodologias, como a de empacotamento de esferas (Li et al. 1999) ou crit\u00e9rios de Delaunay (Mavriplis, 1995; Fleischmann e Siegfried 1997; Frey et al. 1996). Os m\u00e9todos de avan\u00e7o de fronteira possuem a caracter\u00edstica de produzir malhas que se adequam perfeitamente \u00e0 fronteira do pol\u00edgono, o que \u00e9 importante para algumas aplica\u00e7\u00f5es, como por\nexemplo, na gera\u00e7\u00e3o de malhas para pe\u00e7as mec\u00e2nicas. A desvantagem principal do m\u00e9todo est\u00e1 no fato de que \u00e9 dependente da qualidade da poligoniza\u00e7\u00e3o da fronteira inicial. Em particular, tri\u00e2ngulos malformados na frente inicial provavelmente resultar\u00e3o em tetraedros malformados (Moller e Hansbo, 1995).\nNo caso de aplica\u00e7\u00f5es cuja fronteira mude com o tempo, como no caso de simula\u00e7\u00f5es de corpos deform\u00e1veis, \u00e9 desej\u00e1vel que a topologia da malha mude o menos poss\u00edvel durante os passos de tempo. Molino et al. (2003) desenvolveram um m\u00e9todo de triangula\u00e7\u00e3o baseado em um sistema f\u00edsico no qual uma grade gerada sobre o modelo \u00e9 aproximada por meio de um sistema de massa-mola. O m\u00e9todo foi criado para gerar simula\u00e7\u00f5es de contra\u00e7\u00f5es de m\u00fasculos, onde a malha deve suportar grandes deforma\u00e7\u00f5es.\n\u00c9 apresentado neste trabalho um m\u00e9todo baseado em f\u00edsica que utiliza uma BMT (multitrian-gula\u00e7\u00e3o bin\u00e1ria) para ser capaz de produzir uma estrutura adaptativa e malhas em multirresolu\u00e7\u00e3o (Mello et al. 2003). Em outras palavras, a natureza hier\u00e1rquica da BMT possibilita n\u00e3o s\u00f3 uma adapta\u00e7\u00e3o ao dom\u00ednio (produz uma triangula\u00e7\u00e3o mais fina nos locais de maior interesse), mas tamb\u00e9m um truncamento em qualquer n\u00edvel inferior, produzindo uma aproxima\u00e7\u00e3o mais grosseira sem custo adicional. As aplica\u00e7\u00f5es-alvo deste m\u00e9todo s\u00e3o os modelos geol\u00f3gicos que t\u00eam fronteiras que evoluem com o tempo e, em algumas simula\u00e7\u00f5es, devem ser conduzidas em n\u00edveis diferentes de resolu\u00e7\u00e3o. Al\u00e9m disso, modelos como estes cont\u00eam v\u00e1rias propriedades que dificultam sua discretiza\u00e7\u00e3o. Geralmente, possuem bordas complexas e irregulares, pois devem representar falhas, cavidades e diferentes materiais nas camadas dos terrenos. Os algoritmos tradicionais podem apresentar muita dificuldade para triangular este tipo de modelo, al\u00e9m de gerar elementos de m\u00e1 qualidade, o que certamente acarreta problemas num\u00e9ricos.\nO algoritmo proposto aqui pode ser dividido em dois passos principais. Primeiramente, uma malha adaptativa \u00e9 gerada sobre o modelo original para subdividir o espa\u00e7o. Num segundo passo, a malha gerada \u00e9 comprimida utilizando um sistema f\u00edsico para adequar-se \u00e0 fronteira do modelo.\nsubdivis\u00e3o espacial\nPara gerar os elementos da triangula\u00e7\u00e3o, o primeiro passo do algoritmo consiste em subdividir o espa\u00e7o que envolve o modelo gerando uma malha tetraedral. Os elementos desta subdivis\u00e3o espacial ser\u00e3o rearranjados de forma a se adequarem \u00e0 fronteira do modelo. No entanto, nenhum elemento novo \u00e9 inserido ap\u00f3s a fase de subdivis\u00e3o.\nExistem alguns pontos importantes na escolha da estrutura da malha: ela deve ser adaptativa, deve suportar multirresolu\u00e7\u00e3o e deve gerar elementos com boa forma.\nUma estrutura adaptativa permite que coexistam elementos de tamanhos e formas diferentes na malha. Esta propriedade \u00e9 necess\u00e1ria para que se obtenham elementos menores somente nos locais onde uma aproxima\u00e7\u00e3o melhor \u00e9 importante como, por exemplo, nas imedia\u00e7\u00f5es da fronteira do modelo. Desta forma, obt\u00e9m-se uma estrutura menos densa, economizando-se elementos onde for poss\u00edvel.\nA segunda propriedade importante \u00e9 o suporte \u00e0 multirresolu\u00e7\u00e3o. Deve ser poss\u00edvel gerar a subdivis\u00e3o espacial de um mesmo modelo em diferentes n\u00edveis de resolu\u00e7\u00e3o. A escolha do n\u00edvel implica na quantidade de elementos gerados na malha e, conseq\u00fcentemente, na qualidade final da aproxima\u00e7\u00e3o do modelo. Resolu\u00e7\u00f5es altas geram malhas densas e aproxima\u00e7\u00f5es melhores, enquanto resolu\u00e7\u00f5es baixas geram malhas mais leves e aproxima\u00e7\u00f5es mais grosseiras.\nA terceira caracter\u00edstica desejada \u00e9 que a malha n\u00e3o possua elementos de m\u00e1 forma. Quanto menores os \u00e2ngulos da subdivis\u00e3o espacial inicial, mais chances de se obter elementos com formas ruins ao final da compress\u00e3o. Um dos objetivos durante a compress\u00e3o \u00e9 manter, o mais que poss\u00edvel, a forma inicial dos elementos. Para tanto, \u00e9 importante que a malha inicial os forne\u00e7a numa configura\u00e7\u00e3o adequada, isto \u00e9, o mais pr\u00f3ximo poss\u00edvel de um tetraedro perfeito, com \u00e2ngulos di\u00e9dricos entre 45\u00b0 e 90\u00b0.\nNesta implementa\u00e7\u00e3o \u00e9 utilizada uma BMT por possuir todas as caracter\u00edsticas desejadas. A estrutura inicial de uma BMT \u00e9 um cubo dividido em seis tetraedros com \u00e2ngulos di\u00e9dricos de 45\u00b0. Para subdividir um tetraedro, a dist\u00e2ncia do seu\ncentr\u00f3ide \u00e0 fronteira deve ser menor do que a m\u00e9dia dos comprimentos de suas arestas.\nEste tipo de estrutura tamb\u00e9m possui a vantagem de produzir uma transi\u00e7\u00e3o gradual entre os elementos de n\u00edveis de refinamento diferentes. Um exemplo \u00e9 apresentado na figura 1.\nFigura 1\nFigura 3 - Um corte bidimensional do modelo do Golfo do M\u00e9xico.\nFigure 3 - 2D cut view of the model of the Gulf of Mexico.\nUma esfera com elementos menores perto da fronteira e maiores no interior. A malha exibida j\u00e1 passou pelo processo de compress\u00e3o.\nFigure 1\nA sphere with smaller elements near the boundary and larger elements inside.\nThis mesh has already been exposed to the compression process.\nModelos geol\u00f3gicos geralmente possuem caracter\u00edsticas que s\u00f3 podem ser representadas por estruturas de dados complexas. Estes modelos podem conter v\u00e1rias regi\u00f5es, falhas, cavidades e normalmente n\u00e3o s\u00e3o variedades (non-manifold). Al\u00e9m disso, modelos que representam bacias sedimentares podem se estender por v\u00e1rios quil\u00f4metros, mas ter uma espessura relativamente pequena. Um exemplo de um modelo geol\u00f3gico pode ser visto na figura 2. Um corte bidimensional deste modelo \u00e9 mostrado na figura 3.\nFigura 2 - Modelo em tr\u00eas dimens\u00f5es da\tFigure 2 - 3D Model of the basin of the\nBacia do Golfo do M\u00e9xico.\tGulf of Mexico.\nPara representar adequadamente modelos tridimensionais, \u00e9 utilizada a estrutura de dados radial-edge (RED), que permite obter qualquer rela\u00e7\u00e3o de adjac\u00eancia em tempo constante (Weiler,\n1988). As estruturas de dados dos modelos s\u00e3o criadas utilizando a biblioteca do sistema complete geometric complexes (CGC) (Cavalcanti et al. 1997).\nfun\u00e7\u00e3o dist\u00e2ncia\nDurante toda execu\u00e7\u00e3o do algoritmo, a dist\u00e2ncia de um ponto no espa\u00e7o \u00e0 fronteira do modelo \u00e9 computada diversas vezes. Portanto, uma fun\u00e7\u00e3o dist\u00e2ncia r\u00e1pida se faz necess\u00e1ria e uma octree \u00e9 utilizada para melhorar o desempenho.\nO n\u00f3 ra\u00edz da octree \u00e9 definido pelas coordenadas da caixa envolvente do modelo. Para criar uma estrutura compacta, as coordenadas dos n\u00f3s internos e folhas n\u00e3o s\u00e3o armazenadas, mas computadas em tempo real ao atravessar a octree. Os \u00fanicos atributos mantidos em um n\u00f3 interno s\u00e3o ponteiros para seus oito filhos, enquanto um n\u00f3 folha armazena somente uma lista de objetos in-tersectados pela sua caixa.\nEspecificamente, a lista de itens cont\u00e9m todas as faces do modelo que intersectam ou est\u00e3o con\ntidas na caixa do n\u00f3 folha. Quando o n\u00famero de elementos desta lista ultrapassar um limite m\u00e1ximo pr\u00e9-determinado, o n\u00f3 \u00e9 subdividido. No entanto, para que um n\u00f3 n\u00e3o seja repartido indefinidamente, a altura da \u00e1rvore tamb\u00e9m \u00e9 limitada. Note que se existisse um v\u00e9rtice com mais faces incidentes do que o tamanho limite da lista, o n\u00f3 contendo este v\u00e9rtice seria subdividido eternamente.\nPara encontrar a menor dist\u00e2ncia de um ponto p \u00e0 superf\u00edcie do modelo, a \u00e1rvore \u00e9 atravessada a partir do n\u00f3 ra\u00edz. Durante a execu\u00e7\u00e3o do algoritmo, uma estimativa do melhor resultado \u00e9 armazenada. Quando um n\u00f3 folha \u00e9 visitado, a dist\u00e2ncia para a face mais pr\u00f3xima \u00e9 retornada. Quando um n\u00f3 interno \u00e9 visitado, os seus filhos s\u00e3o ordenados em ordem ascendente da dist\u00e2ncia de p aos seus octantes. Cada octante filho \u00e9 visitado recursivamente, mas somente se a sua dist\u00e2ncia correspondente for menor do que a melhor estimativa at\u00e9 o momento. Se algum filho retornar um valor menor do que a melhor estimativa, esta \u00e9 atualizada. Na figura 4 h\u00e1 o pseudo-c\u00f3digo deste algoritmo.\nmalha de deslocamento\nUm sistema f\u00edsico de massa-mola \u00e9 utilizado para adaptar a malha refinada \u00e0 fronteira do\nglobal float melhor \u00bb procedimento dist\u00e2ncia (ponto p, n\u00f3Octree T)\nse T\u00e9 um n\u00f3 folha ent\u00e3o\nretorna a dist\u00e2ncia entre p e a face mais perto em T se n\u00e3o\nordena os filhos de T em ordem ascendente de dist\u00e2ncia \u00e0 p para cada filho S (ordenados) fa\u00e7a\nseja d a dist\u00e2ncia entre p e a caixa de S\nse d &lt;melhor ent\u00e3o D dist\u00e2ncia (p, S) se D &lt;melhor ent\u00e3o melhor D retorna melhor\nmodelo. O prop\u00f3sito \u00e9 selecionar um subconjunto de elementos da malha, chamado de malha-d ou malha de deslocamento, e comprimi-lo para que se adeque \u00e0 fronteira do modelo. Os v\u00e9rtices na fronteira da malha-d s\u00e3o marcados para serem projetados na dire\u00e7\u00e3o da fronteira. Ao movimentar estes v\u00e9rtices marcados, as for\u00e7as geradas s\u00e3o propagadas para os outros v\u00e9rtices, rearranjando os elementos interiores. Na figura 5 s\u00e3o mostradas a malha-d (a, b, c) e a triangula\u00e7\u00e3o final (d, e, f) de uma esfera em tr\u00eas resolu\u00e7\u00f5es diferentes.\nAlguns v\u00e9rtices da malha devem ser selecionados ou marcados para serem empurrados na dire\u00e7\u00e3o da fronteira do modelo. Idealmente, a ma-lha-d deve estar o mais pr\u00f3xima poss\u00edvel da fronteira. Seguindo o esquema de Molino, a malha de\nFigura 4\nPseudo-c\u00f3digo para a fun\u00e7\u00e3o dist\u00e2ncia da octree.\nFigure 4\nPseudo-code for the octree distance function.\nFigura 5\nA malha-d de uma esfera antes (a, b, c) e depois (d, e, f) da compress\u00e3o em tr\u00eas n\u00edveis de resolu\u00e7\u00e3o diferentes.\nFigure 5\nMesh-d of a sphere before (a, b, c) and after (d, e, f) compression at three different resolution levels.\ndeslocamento \u00e9 composta por todos os tetrae-dros incidentes em um conjunto de v\u00e9rtices suficientemente interiores ao modelo, chamado de envelope interior (Molino et al. 2003). Este conjunto cont\u00e9m todos os v\u00e9rtices em que, pelo menos 25% das arestas incidentes est\u00e3o no interior\n\nFigura 6\nUma representa\u00e7\u00e3o em duas dimens\u00f5es da malha de deslocamento. Os v\u00e9rtices do envelope interior est\u00e3o desenhados em branco. Em preto, os v\u00e9rtices da fronteira da malha de deslocamento ligados pela linha preta grossa. A curva representa a fronteira original do modelo. As linhas pontilhadas s\u00e3o as arestas descartadas da malha inicial.\nFigure 6\nA 2D representation of the displacement mesh. The inside envelope vertices have been drawn in white. The vertices of the boundary of the dis-placement mesh are in black and connected by the thick black line.\nThe curve represents the original boundary of the model. The dotted lines represent the edges that have been eliminated from the initial mesh.\ndo modelo. Esta condi\u00e7\u00e3o implica em que todos os tetraedros da malha-d possuam no m\u00ednimo um v\u00e9rtice no interior da fronteira do modelo.\nTodos os v\u00e9rtices da malha-d que n\u00e3o pertencem ao envelope interior s\u00e3o marcados para serem empurrados em dire\u00e7\u00e3o \u00e0 fronteira. Este procedimento garante que nenhum tetraedro ter\u00e1 seus quatro v\u00e9rtices marcados. O conjunto de v\u00e9rtices marcados \u00e9 uma aproxima\u00e7\u00e3o grosseira da fronteira da malha. Todos os tetraedros que n\u00e3o pertencem \u00e0 malha de deslocamento s\u00e3o descartados.\nAlguns v\u00e9rtices marcados s\u00e3o exteriores \u00e0 fronteira, e outros interiores, mas todos est\u00e3o suficientemente pr\u00f3ximos, como pode ser visto na figura 6. Quanto maior o deslocamento de um v\u00e9rtice para alcan\u00e7ar a fronteira, maior ser\u00e3o as for\u00e7as criadas na malha. For\u00e7as de compress\u00e3o muito altas causam perturba\u00e7\u00f5es na malha, podendo inclusive colapsar alguns elementos.\nPara garantir uma compress\u00e3o suave, dois casos particulares devem ser tratados. Primeiro, arestas internas da malha-d com os dois v\u00e9rtices incidentes marcados podem ser achatadas durante a compress\u00e3o. Uma aresta interna, como mostrado na figura 7, \u00e9 identificada quando todos os tetraedros do seu operador Estrela, i.e. os tetraedros incidentes na aresta, pertencem \u00e0 malha-d. O segundo caso refere-se \u00e0s arestas na fronteira da\nFigura 7 - As arestas\tFigure 7 - The highlight-\napontadas representam\ted edges represent\nas arestas interiores da\tmesh-d connecting two\nmalha-d conectando dois\tmarked vertices. Mesh-d\nv\u00e9rtices marcados. A\tboundary has been\nfronteira da malha-d est\u00e1\tdrawn with thick\ndesenhada com segmen-\tsegments and the curve\ntos grossos e a linha\tline represents the model\ncurva representa a fron-\tboundary. Mesh-d has\nteira do modelo. Para\tbeen represented in 2D\nfacilitar a visualiza\u00e7\u00e3o, a\tto make it easier to\nmalha-d est\u00e1 represen-\tdistinguish it, but the 3D\ntada em duas dimens\u00f5es,\tcase is analogue to\nmas o caso para tr\u00eas\tthis one.\ndimens\u00f5es \u00e9 an\u00e1logo.\t\nmalha-d, com mais de duas faces na fronteira incidente, ou seja, arestas que n\u00e3o s\u00e3o variedades.\nEm um primeiro passo, todas as arestas que se enquadram em um desses casos s\u00e3o subdivididas, e a malha-d \u00e9 computada novamente. Quando uma aresta interna \u00e9 subdividida, o v\u00e9rtice criado \u00e9 automaticamente inserido no envelope interior. Como a aresta est\u00e1 no interior da malha, \u00e9 certo que o novo v\u00e9rtice tamb\u00e9m estar\u00e1.\nEm passadas subseq\u00fcentes, a malha-d \u00e9 novamente verificada. Cada vez que um dos dois casos \u00e9 identificado, o v\u00e9rtice da aresta em quest\u00e3o com menor dist\u00e2ncia \u00e0 fronteira da malha \u00e9 inserido no envelope interior. Como a dist\u00e2ncia \u00e9 negativa dentro da fronteira, se os dois v\u00e9rtices forem interiores, o mais interno \u00e9 escolhido. Ap\u00f3s cada passada, a malha-d \u00e9 recomputada, e o processo repetido at\u00e9 que nenhum outro caso seja identificado.\nInterior Edges\nFigura 8\n\u00c0 esquerda, uma vis\u00e3o do modelo completo de um domo de sal. \u00c0 direita, as regi\u00f5es separadas.\nFigure 8\nTo the left, a view of the complete model of a salt dome. To the right, separate regions.\nmodelos com multirregi\u00e3o\nAo se trabalhar com modelos com multirre-gi\u00e3o, envelopes interiores s\u00e3o criados separadamente para cada uma. Na figura 8 h\u00e1 exemplo de um modelo contendo mais de uma regi\u00e3o. Como os envelopes interiores possuem apenas v\u00e9rtices internos das regi\u00f5es, \u00e9 garantido que n\u00e3o h\u00e1 intersec\u00e7\u00e3o entre envelopes diferentes. Por\u00e9m, um tetraedro intersectando uma fronteira do modelo pode ser incidente em mais de um envelope interior e, ao se computar a malha-d, pode ter os quatro v\u00e9rtices marcados.\nPara solucionar este problema, \u00e9 preciso criar uma superf\u00edcie delimitadora entre regi\u00f5es adjacentes. Tal superf\u00edcie deve conter os v\u00e9rtices marcados e, ap\u00f3s a compress\u00e3o, se constituir\u00e1 na aproxima\u00e7\u00e3o da fronteira entre as regi\u00f5es.\nAo computar os envelopes interiores de cada regi\u00e3o, as mesmas regras s\u00e3o aplicadas: um v\u00e9rtice deve ter todas as arestas incidentes, pelo menos, 25% no interior da fronteira para pertencer ao envelope. Por\u00e9m, para encontrar a superf\u00edcie delimitadora, a malha-d \u00e9 computada somente para algumas regi\u00f5es. Para isso, \u00e9 utilizado um\ncrit\u00e9rio simples baseado na identifica\u00e7\u00e3o da regi\u00e3o. Ao selecionar os v\u00e9rtices marcados na fronteira\nentre duas regi\u00f5es, somente a regi\u00e3o com menor n\u00famero de identifica\u00e7\u00e3o \u00e9 considerada. Ao computar a superf\u00edcie delimitadora da malha-d para uma regi\u00e3o, ela \u00e9 automaticamente definida para a regi\u00e3o adjacente, como mostrado na figura 9.\nFigura 9\nUma vis\u00e3o em duas dimens\u00f5es da superf\u00edcie delimitadora (linha vermelha) entre as regi\u00f5es branca e cinza. Os v\u00e9rtices na superf\u00edcie delimitadora s\u00e3o os v\u00e9rtices marcados para serem empurrados em dire\u00e7\u00e3o \u00e0 fronteira, representada pela curva.\nFigure 9\nA 2D view of the boundary surface (red line) between the white and the gray region. The vertices found in the boundary surface have been marked to be pushed towards the boundary, which has been represented by the curve.\nEm modelos com multirregi\u00f5es, \u00e9 importante identificar as faces na fronteira da malha de deslocamento para que as arestas internas sejam removidas. Estas arestas s\u00e3o facilmente identificadas como aquelas que possuem os dois v\u00e9rtices incidentes marcados e sem incid\u00eancia de faces na fronteira. No entanto, n\u00e3o \u00e9 trivial identificar uma face na fronteira da malha-d, ou seja, na regi\u00e3o delimitadora entre duas regi\u00f5es. Para uma face estar na fronteira, algumas condi\u00e7\u00f5es devem ser atendidas. A primeira condi\u00e7\u00e3o estabelece que todos os seus tr\u00eas v\u00e9rtices estejam tamb\u00e9m na fronteira da malha-d e, portanto, marcados para serem empurrados para a fronteira do modelo. Contudo, esta condi\u00e7\u00e3o n\u00e3o \u00e9 suficiente para garantir que a face esteja na fronteira, como pode ser visto na figura 10. Para garantir que uma face esteja realmente na fronteira, \u00e9 preciso analisar a classifica\u00e7\u00e3o dos dois te-traedros incidentes a ela.\nFigura 10\nUm canto de um cubo com uma face interior com os tr\u00eas v\u00e9rtices na fronteira.\nFigure 10\nA corner of a cube with one inside face with the three boundary vertices.\nA classifica\u00e7\u00e3o dos tetraedros \u00e9 realizada de acordo com as regi\u00f5es que cont\u00eam os seus v\u00e9rtices. O principal fato que permite classificar os te-traedros de acordo com a classifica\u00e7\u00e3o de seus v\u00e9rtices \u00e9 que, exceto aqueles marcados (na fronteira da malha-d), todos os remanescentes devem pertencer a uma mesma regi\u00e3o. Na figura 9 nota-se que ao remover os v\u00e9rtices marcados, nenhum tri\u00e2ngulo cinza possui v\u00e9rtices na\nregi\u00e3o branca e vice-versa. Esta mesma propriedade \u00e9 v\u00e1lida para modelos em tr\u00eas dimens\u00f5es. Portanto, um tetraedro pode ser classificado como pertencente \u00e0 mesma regi\u00e3o de qualquer um de seus v\u00e9rtices n\u00e3o marcados.\nAp\u00f3s classificar os tetraedros, uma face de fronteira pode ser facilmente identificada quando seus dois tetraedros incidentes est\u00e3o em regi\u00f5es diferentes.\nO esquema de classifica\u00e7\u00e3o de tetraedros pode falhar para aqueles no exterior do modelo. Estes tetraedros podem ter todos os quatro v\u00e9rtices marcados e, portanto, nenhum v\u00e9rtice livre para associar a classifica\u00e7\u00e3o. Embora seja uma condi\u00e7\u00e3o que deva ser evitada, estes tetraedros n\u00e3o fazem parte da malha de deslocamento e, portanto, n\u00e3o s\u00e3o considerados na triangula\u00e7\u00e3o final. Na figura 11 h\u00e1 um exemplo de um tetrae-dro exterior com todos os v\u00e9rtices marcados. Para se evitar falhas no teste, sempre que este caso for encontrado, o tetraedro \u00e9 classificado como exterior e, assim, n\u00e3o pertencente a regi\u00e3o alguma.\nFigura 11 - Tetraedro exterior com os quatro v\u00e9rtices marcados: V0, V,, V2, e V3. As faces de fronteira s\u00e3o as hachuradas (F0 e F,) e as setas apontam para o interior do modelo.\nFigure 11 - The outside tetrahedron with the four marked vertices: V0, V1r V2, and V3. The faces of the boundary have been shaded (F0 and F1) and the arrows point to the inside of the model.\nsistema f\u00edsico\nO sistema f\u00edsico escolhido para comprimir a malha \u00e9 baseado em um esquema de massas e molas. Esta compress\u00e3o realiza a aproxima\u00e7\u00e3o da malha-d em rela\u00e7\u00e3o \u00e0 fronteira do modelo. Os elementos da malha-d s\u00e3o utilizados para representar as molas e part\u00edculas do sistema.\nconfigura\u00e7\u00e3o das molas\nUma quest\u00e3o muito importante \u00e9 como configurar as molas na malha tetraedral para se realizar a compress\u00e3o. Molas mal posicionadas podem ser incapazes de manter a forma dos elementos ou pior: n\u00e3o impedir que sejam colapsa-dos durante a compress\u00e3o. Diversos esquemas diferentes s\u00e3o poss\u00edveis para configurar as molas (fig. 12).\n\u00c9 f\u00e1cil perceber que uma configura\u00e7\u00e3o com molas, por exemplo, somente nas arestas dos tri\u00e2ngulos n\u00e3o \u00e9 suficiente para manter a forma dos elementos. Um v\u00e9rtice pode se deslocar, sem muita resist\u00eancia, para o centro da sua aresta oposta colapsando o tri\u00e2ngulo.\nA configura\u00e7\u00e3o que apresenta melhores resultados consiste em uma mola por aresta, mais tr\u00eas molas de proje\u00e7\u00e3o por tri\u00e2ngulo, como ilustrado na figura 12f. Cada mola de proje\u00e7\u00e3o \u00e9 posicionada entre um v\u00e9rtice da malha e a sua proje\u00e7\u00e3o ortogonal na aresta oposta do tri\u00e2ngu-\nlo.\tPara isto, \u00e9 necess\u00e1rio criar alguns v\u00e9rtices auxiliares que n\u00e3o fazem parte da malha-d, desenhados em branco na figura 12. Esta configura\u00e7\u00e3o n\u00e3o s\u00f3 apresenta melhores resultados na pr\u00e1tica, mas tamb\u00e9m possui prova te\u00f3rica de que evita os colapsos com maior efici\u00eancia, como demonstrado por Cooper e Maddock (1997).\nEm tr\u00eas dimens\u00f5es, \u00e9 utilizada uma configura\u00e7\u00e3o an\u00e1loga \u00e0quela ilustrada na figura 12f. As arestas da malha referenciam suas molas correspondentes enquanto cada face referencia suas duas molas de proje\u00e7\u00e3o, como mostrado na figura 13.\nPara computar as for\u00e7as nas molas, duas equa\u00e7\u00f5es distintas s\u00e3o utilizadas: uma para as molas de aresta, outra para as molas de pro-\nFigura 12 - Seis esquemas diferentes para configura\u00e7\u00e3o do sistema de massa-mola na malha:\n(a)\tsomente molas nas arestas da malha;\n(b)\tsomente molas dos v\u00e9rtices ao cen-tr\u00f3ide do tri\u00e2ngulo;\n(c)\tmolas nas arestas e nos centr\u00f3ides;\n(d)\tsomente molas nas medianas do tri\u00e2ngulo;\n(e)\tmolas nas arestas e nas medianas;\n(f)\tmolas nas arestas e nas proje\u00e7\u00f5es dos v\u00e9rtices \u00e0s arestas opostas.\nEm preto, os v\u00e9rtices reais da malha, em branco os v\u00e9rtices virtuais.\nFigure 12 - Six different schemes to setup the physical mass spring system:\n(a)\tonly springs on the mesh edges;\n(b)\tonly springs from the vertices to the centroid of the triangle;\n(c)\tsprings on the edges and centroids;\n(d)\tonly springs on the medians of the triangle;\n(e)\tsprings on the edges and medians;\n(f)\tsprings on the edges and on the projections of the vertices to the opposed edges.\nActual vertices of the mesh in black; virtual vertices in white.\nFigura 13\nMolas incidentes no v\u00e9rtice v0: tr\u00eas molas de aresta e uma mola de proje\u00e7\u00e3o. As outras molas do tetraedro (tr\u00eas de proje\u00e7\u00e3o e tr\u00eas de aresta) n\u00e3o est\u00e3o ilustradas nessa figura.\nFigure 13\nSprings on vertex v0: three edge springs and one projection spring. The other springs of the tetrahedron (three projection springs and three edge springs) have not been included in this figure.\nje\u00e7\u00e3o. A equa\u00e7\u00e3o 1 se refere \u00e0s molas de aresta e segue a lei de Hooke:\n(1)\nonde ks e kd s\u00e3o os coeficientes de elasticidade e amortecimento, x0 \u00e9 o comprimento de descanso da mola e Ax e Av s\u00e3o as diferen\u00e7as de posi\u00e7\u00e3o e velocidade dos v\u00e9rtices.\nPara as molas de proje\u00e7\u00e3o \u00e9 aplicada uma equa\u00e7\u00e3o n\u00e3o linear, como descrito em Cooper e Maddock (1997) e mostrado na equa\u00e7\u00e3o 2. Esta mola n\u00e3o linear exerce uma for\u00e7a infinita nos v\u00e9rtices quando seu comprimento tende a zero.\n(2)\nsistema de part\u00edculas\nPara simular o movimento oscilat\u00f3rio do sistema massa-mola, a malha \u00e9 tratada como um sistema de part\u00edculas (Witkin, 1994). Cada v\u00e9rtice representa uma part\u00edcula no sistema, e part\u00edculas s\u00e3o associadas \u00e0s extremidades das molas. Algumas part\u00edculas tempor\u00e1rias podem ser introduzidas para representar os v\u00e9rtices virtuais. Tais part\u00edculas existem apenas ao computar as for\u00e7as associadas \u00e0s suas molas de proje\u00e7\u00e3o e, portanto, influenciam apenas localmente o sistema.\nCada part\u00edcula possui os seguintes atributos: posi\u00e7\u00e3o, velocidade, for\u00e7a e massa. O sistema ite-ra em passos de tempo, atualizando, a cada ciclo, a posi\u00e7\u00e3o e a velocidade de cada part\u00edcula. A cada passo de tempo s\u00e3o computadas as for\u00e7as nas part\u00edculas. A for\u00e7a em cada v\u00e9rtice \u00e9 a soma de todas as for\u00e7as geradas por suas molas incidentes.\nO valor da massa \u00e9 calculado diferentemente para cada part\u00edcula. Aquelas nas proximidades da fronteira do modelo s\u00e3o mais pesadas do que aquelas mais afastadas. Isto implica serem os te-traedros menores, perto da fronteira, sejam mais r\u00edgidos e menos suscet\u00edveis a perder a forma original. Por outro lado, os tetraedros maiores, no interior do modelo, s\u00e3o mais leves e podem ser\nrearranjados com mais facilidade. Desta forma, quando a resist\u00eancia dos tetraedros interiores \u00e9 muito grande, evita-se que aqueles na fronteira fiquem muito deformados, ou que seus v\u00e9rtices marcados n\u00e3o alcancem a fronteira. A massa de um tetraedro \u00e9 computada como a raz\u00e3o entre seu n\u00edvel de refinamento e o n\u00edvel m\u00e1ximo de refinamento da subdivis\u00e3o espacial. A massa de cada part\u00edcula \u00e9 calculada como a m\u00e9dia de todas as massas dos tetraedros incidentes.\nA dura\u00e7\u00e3o de um passo de tempo \u00e9 definida pelo usu\u00e1rio. Valores pequenos s\u00e3o melhores, pois criam menos oscila\u00e7\u00f5es nas molas. Por\u00e9m, valores pequenos tamb\u00e9m resultam em mais itera\u00e7\u00f5es e, conseq\u00fcentemente, em tempos de simula\u00e7\u00e3o maiores.\nCada itera\u00e7\u00e3o pode ser dividida em tr\u00eas fases distintas:\n1.\tc\u00e1lculo da for\u00e7a acumulada em cada v\u00e9rtice;\n2.\tc\u00e1lculo dos valores derivados;\n3.\tc\u00e1lculo das novas posi\u00e7\u00f5es e velocidades.\nacumuladores de for\u00e7as\nA for\u00e7a acumulada em cada v\u00e9rtice \u00e9 a soma das contribui\u00e7\u00f5es de todas as molas incidentes. V\u00e9rtices virtuais n\u00e3o possuem acumuladores, mas contribuem para a for\u00e7a acumulada no v\u00e9rtice real na outra extremidade da mola.\nO primeiro passo em cada itera\u00e7\u00e3o de tempo \u00e9 inicializar as for\u00e7as de todas as part\u00edculas com valores nulos. Em seguida, todas as arestas e faces s\u00e3o iteradas para calcular os valores correspondentes nas suas part\u00edculas utilizando as equa\u00e7\u00f5es 1 e 2, respectivamente. Para cada mola, uma das equa\u00e7\u00f5es \u00e9 computada e seu valor \u00e9 somado ao acumulador de for\u00e7a de um v\u00e9rtice. Ao acumulador de for\u00e7a do v\u00e9rtice na outra extremidade, caso seja um v\u00e9rtice real, \u00e9 somado o mesmo valor com sinal contr\u00e1rio. No caso de um v\u00e9rtice virtual, n\u00e3o \u00e9 necess\u00e1rio acumular sua for\u00e7a incidente, j\u00e1 que sua posi\u00e7\u00e3o \u00e9 computada dinamicamente de acordo com a aresta de proje\u00e7\u00e3o.\nvalores derivados\nNeste passo, as derivadas dos valores da posi\u00e7\u00e3o e a velocidade de cada part\u00edcula s\u00e3o calcu\nladas, ou seja, sua velocidade e acelera\u00e7\u00e3o, respectivamente.\nUm vetor auxiliar \u00e9 utilizado para armazenar tais valores. O tamanho do vetor \u00e9 6n, onde n \u00e9 o n\u00famero de part\u00edculas no sistema. O vetor de derivadas \u00e9 escalado para o tempo de uma itera\u00e7\u00e3o.\natualiza\u00e7\u00e3o das coordenadas\ne velocidades\nOutro vetor \u00e9 criado para armazenar os valores correntes das coordenadas e a velocidade de cada part\u00edcula. O tamanho do vetor \u00e9 o mesmo do vetor de derivadas. Para calcular os valores das novas coordenadas e velocidades das part\u00edculas, os dois vetores descritos s\u00e3o somados.\ncrit\u00e9rios de compress\u00e3o\nOs comprimentos de repouso das molas s\u00e3o definidos como seus comprimentos iniciais, ou seja, inicialmente o sistema est\u00e1 completamente est\u00e1vel. Portanto, se nenhuma perturba\u00e7\u00e3o for introduzida no sistema, o estado n\u00e3o muda. Para iniciar a compress\u00e3o, os v\u00e9rtices marcados s\u00e3o empurrados em dire\u00e7\u00e3o \u00e0 fronteira.\nPara que a compress\u00e3o comece, as part\u00edculas da fronteira da malha-d s\u00e3o projetadas na dire\u00e7\u00e3o definida pela m\u00e9dia das normais das faces de fronteira incidentes. Se o v\u00e9rtice estiver no exterior da fronteira do modelo, as normais apontando para dentro da fronteira s\u00e3o utilizadas. Caso contr\u00e1rio, se o v\u00e9rtice estiver no interior, as normais contr\u00e1rias s\u00e3o utilizadas.\nPara os v\u00e9rtices marcados, considera-se apenas a componente da for\u00e7a perpendicular \u00e0 velocidade. Ap\u00f3s cada passo de tempo, a velocidade \u00e9 recomputada utilizando as normais das faces incidentes. Assim, os v\u00e9rtices marcados caminham em dire\u00e7\u00e3o \u00e0 fronteira enquanto se rearranjam no plano perpendicular \u00e0 sua trajet\u00f3ria. Esta dire\u00e7\u00e3o impede que v\u00e9rtices vizinhos cheguem muito pr\u00f3ximos \u00e0 fronteira. Se estes v\u00e9rtices interagissem livremente, as for\u00e7as internas da malha, eventualmente, os retornaria a seus estados iniciais.\nlimitando a compress\u00e3o\nPara melhor controlar a malha-d durante a compress\u00e3o, algumas restri\u00e7\u00f5es s\u00e3o impostas ao movimento das part\u00edculas. Tais restri\u00e7\u00f5es s\u00e3o motivadas pelas t\u00e9cnicas utilizadas em simula\u00e7\u00e3o de tecidos (Bridson et al. 2002; Baraff e Witkin, 1998; Provot, 1995). Estas t\u00e9cnicas limitam a compress\u00e3o m\u00e1xima das molas e a taxa de compress\u00e3o por passo de tempo. Primeiro, nenhuma mola pode sofrer uma compress\u00e3o maior do que 60% do seu comprimento de repouso. Segundo, durante um passo de tempo, nenhuma part\u00edcula pode se movimentar de tal sorte que alguma de suas molas incidentes sofra uma compress\u00e3o maior do que 10% da sua altura corrente. Quando um v\u00e9rtice infringe uma dessas condi\u00e7\u00f5es, ele \u00e9 congelado durante o passo de tempo atual. Todos os v\u00e9rtices que n\u00e3o foram parados t\u00eam suas posi\u00e7\u00f5es e velocidades recomputadas iterativamente como em um passo de tempo comum. Tal procedimento \u00e9 repetido at\u00e9 que nenhuma part\u00edcula precise ser congelada. Estes limites artificiais geram uma robustez maior durante a compress\u00e3o da malha e ajudam a obter uma triangula\u00e7\u00e3o com maior qualidade.\nOs v\u00e9rtices marcados, que est\u00e3o sendo empurrados em dire\u00e7\u00e3o \u00e0 fronteira, tamb\u00e9m podem ser congelados quando infringem uma das condi\u00e7\u00f5es descritas. Em alguns casos, podem ser continuamente parados de forma que nunca cheguem at\u00e9 a fronteira. Isto acontece mais comumente em malhas de baixa resolu\u00e7\u00e3o, onde os v\u00e9rtices devem caminhar dist\u00e2ncias maiores e a varia\u00e7\u00e3o de tamanho - entre os elementos perto da fronteira e aqueles no interior - \u00e9 pequena. Este procedimento \u00e9 v\u00e1lido somente onde uma justaposi\u00e7\u00e3o da fronteira do modelo n\u00e3o \u00e9 necess\u00e1ria. A simula\u00e7\u00e3o termina quando todos os v\u00e9rtices marcados chegam na fronteira ou est\u00e3o congelados.\nresultados\nNa figura 14 \u00e9 exposta uma aproxima\u00e7\u00e3o grosseira do modelo do coelho de Stanford. Esta malha cont\u00e9m 30 K tetraedros, com \u00e2ngulo di\u00e9-drico m\u00ednimo de aproximadamente 3,5\u00b0, onde 99,4% dos \u00e2ngulos est\u00e3o acima de 18\u00b0.\nFigura 14\nAproxima\u00e7\u00e3o grosseira do coelho de Stanford com 30 K tetraedros. Na seq\u00fc\u00eancia, a malha-d antes (a), durante (b) e ao final com (c) e sem arestas (d) da compress\u00e3o.\nFigure 14\nGross approximation of Stanford Rabbit with 30 K tetrahedrons. The sequence of mesh-d before (a), during (b) and after c(c) ompression (with and without edges)\nA triangula\u00e7\u00e3o do tigre, na figura 15, foi gerada com 160 K tetraedros e \u00e2ngulo di\u00e9drico m\u00ednimo de 4,6\u00b0. Na figura 16 \u00e9 exposto o interior do tigre. Na figura 17 s\u00e3o mostrados 21 n\u00edveis de resolu\u00e7\u00e3o diferentes para o modelo.\nFigura 15\nTriangula\u00e7\u00e3o do tigre com aproximadamente 160 K tetraedros.\nFigure 15\nTiger triangulation with approximately 160 K tetrahedrons.\nFigura 16 - Um corte do modelo do tigre.\nFigure 16 - A cut view of the tiger model.\n\nFigura 17 - Modelo do tigre exposto em diversas resolu\u00e7\u00f5es consecutivas.\nFigure 17 - Tiger model exposed in different consecutive resolutions.\nFigura 18\nTr\u00eas vis\u00f5es da malha final (a, b, c) e uma da malha-d (d).\nFigure 18\nThree views of the final mesh and one view of mesh-d.\nNa figura 18, tr\u00eas vis\u00f5es (duas com arestas e uma sem) de um modelo de uma cabe\u00e7a s\u00e3o mostradas, e tamb\u00e9m sua respectiva malhas-d. Esta malha cont\u00e9m 242 K tetraedros, seu \u00e2ngulo m\u00ednimo \u00e9 de 3,1\u00b0 e 99% dos \u00e2ngulos est\u00e3o acima dos 25\u00b0. O tempo de execu\u00e7\u00e3o foi de aproximadamente uma hora.\nDois cortes da malha do domo de sal s\u00e3o mostrados na figura 19. A triangula\u00e7\u00e3o final cont\u00e9m aproximadamente 900 K tetraedros, \u00e2ngulo m\u00ednimo de 4,9\u00b0 e com 99,7% dos \u00e2ngulos acima de 18\u00b0.\nFigura 19 - Dois cortes da malha do domo de sal.\nFigure 19 - Two cut views of the salt dome mesh.\nconclus\u00f5es\nFoi apresentado aqui um algoritmo para triangula\u00e7\u00e3o de modelos em tr\u00eas dimens\u00f5es com bordas complexas e irregulares. O algoritmo \u00e9 capaz de gerar a malha em diversas resolu\u00e7\u00f5es e n\u00e3o produz elementos de \u00e1rea ou volume zero. Estas s\u00e3o as principais vantagens oferecidas como extens\u00e3o dos algoritmos de triangula\u00e7\u00e3o tradicionais.\nUma das maiores diferen\u00e7as dos modelos convencionais reside no fato de n\u00e3o haver uma fidelidade quanto \u00e0 fronteira da malha gerada em rela\u00e7\u00e3o \u00e0 fronteira original do modelo. Apesar desta propriedade ser importante em v\u00e1rios casos, existem aplica\u00e7\u00f5es onde uma aproxima\u00e7\u00e3o \u00e9 acei\nt\u00e1vel, como, por exemplo, em modelos geol\u00f3gicos. Estes modelos prov\u00eam de interpreta\u00e7\u00f5es humanas de dados s\u00edsmicos e, por esta raz\u00e3o, est\u00e3o sujeitos a erros. Assim, pequenos desvios nos detalhes da malha n\u00e3o provocam grandes problemas na sua utiliza\u00e7\u00e3o. Al\u00e9m disso, modelos geol\u00f3gicos s\u00e3o utilizados em simula\u00e7\u00f5es num\u00e9ricas nas quais a qualidade dos elementos da malha \u00e9 de maior import\u00e2ncia do que a fidelidade \u00e0 fronteira. Elementos achatados e \u00e2ngulos muito pequenos sempre causam problemas num\u00e9ricos.\nAlguns algoritmos de triangula\u00e7\u00e3o tradicionais obtiveram resultados expressivos com provas te\u00f3ricas de \u00e2ngulo m\u00ednimo e com garantia de t\u00e9rmino, especialmente em duas dimens\u00f5es.\nO algoritmo proposto tamb\u00e9m oferece um esquema de multirresolu\u00e7\u00e3o sem esfor\u00e7o adicional. A malha, ap\u00f3s ter sido gerada, pode ser visualizada em qualquer resolu\u00e7\u00e3o. Isto se deve n\u00e3o s\u00f3 ao fato da estrutura utilizada para gerar a grade j\u00e1 possuir a propriedade de multirresolu\u00e7\u00e3o como tamb\u00e9m ao fato da topologia da malha n\u00e3o ser alterada durante todo processo.\ntrabalhos futuros\nUm esquema de subdivis\u00e3o espacial baseado na curvatura da fronteira, e n\u00e3o na dist\u00e2ncia da mesma, \u00e9 de grande interesse. A malha conter\u00e1, desta forma, tetraedros menores em locais onde a fronteira for mais detalhada e complexa. Nas regi\u00f5es onde a fronteira \u00e9 mais homog\u00eanea, \u00e9 poss\u00edvel diminuir a quantidade de elementos.\nOutra proposta \u00e9 a cria\u00e7\u00e3o de uma m\u00e9trica para avaliar a aproxima\u00e7\u00e3o da malha em rela\u00e7\u00e3o \u00e0 fronteira original. Com isto, \u00e9 poss\u00edvel saber quais malhas apresentaram uma aproxima\u00e7\u00e3o melhor e onde ocorrem os maiores desvios.\nO problema do serrilhamento \u00e9 outro ponto a ser melhorado. Refinar mais a malha onde ocorre o serrilhamento pode melhorar a aproxima\u00e7\u00e3o, mas ainda n\u00e3o elimina o problema por completo.\nUma investiga\u00e7\u00e3o mais detalhada para encontrar valores ideais para as constantes el\u00e1sticas e de amortecimento das molas pode melhorar os resultados gerados. Os testes mostram que varia\u00e7\u00f5es nas constantes melhoram os \u00e2ngulos m\u00edni\nmos gerados em alguns modelos. Para um mesmo modelo de uma esfera, por exemplo, foi poss\u00edvel elevar o \u00e2ngulo m\u00ednimo de 19\u00b0 para 41\u00b0, apenas aumentando os valores das constantes, tornando as molas mais flex\u00edveis. Por\u00e9m, est\u00e1 rela\u00e7\u00e3o ainda n\u00e3o est\u00e1 clara.\nrefer\u00eancias bibliogr\u00e1ficas\nBARAFF, D.; WITKIN, A. Large steps in cloth simula-tion. In: ANNUAL CONFERENCE ON COMPUTER GRAPHICS AND INTERACTIVE TECHNIQUES, 25., 1998, Orlando. Proceedings... New York: ACM Press,\n1998.\tp. 43-54.\nBERN, M.; EPPSTEIN, D. Quadrilateral meshing by cir-cle packing. International Journal of Computational Geometry and Applications, Singapore, v. 10, n. 4, p. 347-360, 2000.\nBRIDSON, R.; FEDKIW, R.; ANDERSON, J. Robust treatment of collisions, contact and friction for cloth animation. In: ANNUAL CONFERENCE ON COMPUT-ER GRAPHICS AND INTERACTIVE TECHNIQUES, 29., 2002, San Antonio, Texas. Proceedings... New York: ACM Press, 2002. p. 594-603.\nCAVALCANTI, P R.; CARVALHO, P C. P; MARTHA, L. F. Nonmanifold modeling: an approach based on spa-tial subdivisions. Computer-Aided Design, Guildford, v. 29, n. 3, p. 209-220, Mar. 1997.\nCHENG, S. W.; DEY, T K.; EDELSBRUNNER, H.; FACEL-LO, M. A.; TENG, S. H. Silver exudation. In: ANNUAL SYMPOSIUM ON COMPUTATIONAL GEOMETRY, 15.,\n1999,\tMiami Beach. Proceedings. New York: ACM Press, 1999. p. 1-13.\nCOHEN-STEINER, D.; VERDI\u00c8RE, E. C. de; YVINEC, M. Conforming delaunay triangulations in 3D. In: SYMPO-SIUM ON COMPUTATIONAL GEOMETRY, 18., 2002, Barcelona. Proceedings. New York: ACM Press, 2002. p. 199-208.\nCOOPER, L.; MADDOCK, S. Preventing collapse within mass-spring-damper models of deformable objects. In: INTERNATIONAL CONFERENCE IN CENTRAL EUROPE\nON COMPUTER GRAPHICS AND VISUALIZATION, 5., 1997, Plzen-Bory, Czech Republic. Proceedings... Holoubkov: Vikomt, 1997. p. 70-78.\nEDELSBRUNNER, H.; GUOY, D. An experimental study of sliver exudation. Engineering with Computers, New York, v. 18, n. 3, p. 229-240, Oct. 2002.\nFLEISCHMANN, P.; SELBERHERR, S. Three-dimension-al delaunay mesh generation using a modified advancing front approach. In: INTERNATIONAL MESHING ROUNDTABLE, 6., 1997, Park City, Utah. Proceedings. New Mexico: Sandia National Laboratories, 1997. p. 267-278.\nFREY, P. J.; BOROUCHAKI, H.; GEORGE, P. L. Delaunay tetrahedralization using an advancing-front approach. In: INTERNATIONAL MESHING ROUNDTABLE, 5., 1996, Pittsburgh, Pennsylvania. Proceedings.\nNew Mexico: Sandia National Laboratories, 1996. p. 21-46.\nGEORGE, P. L.; BOROUCHAKI, H. Delaunay triangula-tion and meshing: application to finite elements. Paris: Hermes, 1998. 413 p.\nLI, X. Y.; TENG, S. H.; \u00dcNGOR, A. Biting spheres in 3D. In: INTERNATIONAL MESHING ROUNDTABLE, 8., 1999, South Lake Tahoe, California. Proceedings. New Mexico: Sandia National Laboratories, 1999. p. 85-95.\nLOHNER, R. Progress in grid generation via the advanc-ing front technique. Engineering with Computers, New York, v. 12, n. 3/4, p. 186-210, Sep. 1996.\nLOHNER, R.; PARIKH, P. Three-dimensional grid generation by the advancing front method. International Journal for Numerical Methods in Fluids, Chichester, v. 8, p. 1135-1149, 1988.\nMAVRIPLIS, D. J. An advancing front Delaunay trian-gulation algorithm designed for robustness. Journal of Computational Physics, New York, v. 117, n. 1, p. 90-101, 1995.\nMELLO, V.; VELHO, L.; CAVALCANTI, P. R.; SILVA, C. Bmt: a generic programming approach to multiresolu-tion spatial decompositions. In: HEGE, H.; POLTHIER, K.\n(Ed.). Visualization and Mathematics III. Berlin: Springer-Verlag, 2003. p. 337-360.\nMOLINO, N.; BRIDSON, R.; TERAN, J.; FEDKIW, R. A crystalline, red green strategy for meshing higly deformable objects with tetrahedra. In: INTERNATION-AL MESHING ROUNDTABLE, 12., 2003, Santa Fe, New Mexico. Proceedings. New Mexico: Sandia National Laboratories, 2003. p. 103-114.\nMOLLER, P.; HANSBO, P. On advancing front mesh generation in three dimensions. International Journal for Numerical Methods in Engineering, Chichester, v. 38, p. 3551-3569, 1995.\nMURPHY, M.; MOUNT, D. M.; GABLE, C. W. A point-placement strategy for conforming delaunay tetrahe-dralization. International Journal of Computacional Geometry and Applications, Singapore, v. 11, n. 6, p. 669-682, 2001.\nPERAIRE, J.; PEIR\u00d3, J.; MORGAN, K. Advancing front grid generation. In: THOMPSON, J. F.; SONI, B. K.; WEATHERILL, N. P. (Ed.). Handbook of grid genera-tion. Boca Raton: CRC Presss, 1999. Chapter 17.\nPROVOT, X. Deformation constraints in a mass-spring model to describe rigid cloth behavior. In: GRAPHICS INTERFACE '95, 1995, Quebec. Proceedings. Ontario: Canadian Human-Computer Communications Society, 1995. p. 147-154.\nRUPPERT, J. Results on triangulation and high quality mesh generation. Berkeley: University of California at Berkeley, 1992. 135 p. Thesis (Ph. D.).\nRUPPERT, J. Delauney refinement algorithm for quali-ty 2-dimensional mesh generation. Journal of Algorithms, San Diego, v. 18, n. 3, p. 548-585, 1995.\nSHEWCHUK, J. R. Tetrahedral mesh generation by delaunay refinement. In: ANNUAL SYMPOSIUM ON COMPUTATIONAL GEOMETRY, 14., 1998, Minneapolis, Minnesota. Proceedings. New York: ACM Press, 1998. p. 86-95.\nSHEWCHUK, J. R. Delaunay refinement algorithms for triangular mesh generation. Computational Geometry:\ntheory and application, Amsterdam, v. 22, n. 1/3, p. 2174, May 2002.\nSHEWCHUK, J. R. Delaunay refinement mesh gen-eration. Pittsburgh: Carnegie Mellon University. Department of Computer Science, 1997. Thesis (Ph. D.)\nWEATHERILL, N. P.; HASSAN, O. Efficient three-dimensional delaunay triangulation with automatic point creation and imposed boundary constraints. International Journal for Numerical Methods in Engineering, Chichester, v. 37, p. 2005-2039, 1994.\nWEILER, K. The radial-edge structure: a topological representation for nonmanifold geometric boundary representations. In: INTERNATIONAL FEDERATION FOR INFORMATION PROCESSING WORKING GROUP 5.2 WORKING CONFERENCE, 1986, Rensselaerville, New York. Geometric modeling for CAD applica-tions: selected and expanded papers. Hardbound: Elsevier, 1988. p. 3-36.\nWITKIN, A. An introduction to physically based modeling: particle system dynamics. New York: Rochester Institute of Technology, 1994. (Association for Computing Machinery's Special Interest Group on Graphics and Interactive Techniques. Course Notes, 32).\nexpanded abstract\nNumerical simulations have become an essential step in the development of engineering products, or in predicting the behavior of physical phenomena, such as weather conditions, oil generation and migra-tion, tide movement, earthquakes, etc.\nIn order to be able to carry out any simulation it is necessary to discretize the domain of interest, onto which a set of equations that describe physical laws must be solved. This discretization process is generi-cally referred to as the triangulation of the domain.\nAlthough several triangulation algorithms have been proposed in the past three decades, these algo-rithms are meant mainly to deal with mechanical parts, produced by computer aided design (CAD) sys-tems. However, there are numerous important appli-cations in which the domain presents no symmetry at all, and boundaries are not well or clearly established.\nGeological models for instance are often com-posed by several regions (and form geological layers), and have an irregular geometry, with surfaces that meet at very small angles, a situation known as a pinch-out. The geometry of the surfaces (horizons and faults) is obtained from seismic data, by a process that is not automatic and requires a geologist's inter-pretation. As a consequence, the whole model cre-ation process not exact, and tends to be error prone.\nTraditional triangulation algorithms can be classi-fied according to the way they work. Delaunay based algorithms recover the boundaries after triangulating the convex hull of the pointset (Cavalcanti et al. 1997). Ruppert and Shewchuck (Ruppert, 1992; Ruppert, 1995; Shewchuck, 1997) insert a vertex at the circum-center of a bad element to improve the mesh quality.\nOn the other hand, advancing front algorithms (Mavriplis, 1995) start at the boundaries and proceed toward the center of the model, thus inserting new vertices to create good shaped elements. The trick is to merge the different fronts without generating any inconsistency. The success of the algorithm depends greatly on the simplicity of the boundary geometry. Also, as cited by George and Borouchaki (1999), there is no theoretical guarantee about the conver-gence of this process.\nPacking sphere algorithms (Bern, 2000; Li et al.\n1999)\tgenerate a vertices distribution by forcing edges and faces to be present in the final mesh. The latter can be then generated by a Delaunay-like algorithm.\nEfforts were also made to join some of these tech-niques. Frey et al. (1996) proposed a method that\njoined some advantages of the Delaunay approach with the advancing-front point placement strategy generating good quality meshes.\nAlthough many of these traditional triangulation algorithms have achieved good results in many cases, it is difficult for them to deal with models having complex and irregular boundaries that contain small angles. Moreover, they do not support multi-resolu-tion, i.e. the ability to generate meshes in different levels of detail for the same model. Even when a tri-angulation algorithm does a good job meshing this kind of model, it may generate small angles in the final mesh, which usually cause problems in running numerical simulations.\nFurthermore, Shewchuk (1998) states that for any angle bound larger than zero, there is a PSLG (planar straight line graph) that cannot be triangulated with-out creating a new angle smaller than the bound, and this holds true for every triangulation algorithm.\nThis paper presents an adaptive algorithm to tri-angulate non-manifold, multi-region models, which approximates their irregular boundaries instead of trying to match them exactly. Although the boundary is just an approximation, our main concern is to gen-erate a good mesh, as close as possible to the original one. Some features, like multi-resolution can only be implemented by loosening the boundary preserva-tion. The algorithm is able to produce meshes in dif-ferent levels of the details for the same model, that is, models that may contain more or less elements. Thus small input angles can be eliminated. The ability to tri-angulate multi-region models is also important as most target geological models contain more than one region defined by geological layers.\nPhysically based triangulation algorithms are not new. Molino (2003) has used a similar approach to obtain numerical meshes before. Nonetheless, despite his good results, he considered only single region manifold objects. In this paper we expand Molino's work to be able to deal with non-manifold multi-region objects, which are necessary to address a broader set of applications.\nThe algorithm has two main steps. In the first step, a grid is adaptively created over the object in order to subdivide the surrounding space. The adaptive prop-erty of this mesh can be enhanced based on a given criterion. The one chosen here is the distance from a tetrahedron to a boundary surface, thus producing finer resolution near the boundary, and coarser on the inside. The representation of the input data has been created using the complete geometric complex CGC\nsystem (Cavalcanti et al. 1997), and the target is geological applications, which define a set of horizons and faults. Faults represent discontinuities (cracks) in the subsurface of the earth, and divide the model into a set of regions. A group of regions with similar attrib-utes forms a geological layer. The geometry of geo-logical models is intrinsically complex because surfaces have been folded many times during their formation process. A model representing a sedimentary basin may extend from several hundred kilometers along x and y, to just a few hundred meters in z. A layer near the boundary may be only 30 m deep.\nThe second step shapes the vertices of the grid to the boundary of the object using a compression scheme, boundary of the object using a compression scheme, while trying to maintain well shaped ele-ments. In order to assure that the enhanced mesh is in conformity with the model boundary, a physical mass spring system is used. The idea is to select a subset of the mesh and compress it to the boundary of the model. Springs are placed on each tetrahedron to preserve their shape during compression. In order to sim-ulate the mass-spring oscillatory movement, the mesh is treated as a particle system. The algorithm has sev-eral advantages over traditional triangulation tech-niques, such as:\n1)\tit is easy to implement and offers multi-resolu-tion at the same time;\n2)\tit can deal with models that have complex and irregular boundaries; and\n3)\tit is not overly affected by numerical issues.\nautor principal\nRicardo Marroquim\nUniversidade Federal do Rio de Janeiro (UFRJ)\nLaborat\u00f3rio de Computa\u00e7\u00e3o Gr\u00e1fica - COPPE e-mail: ricardo@lcg.ufrj.br\nRicardo Marroquim concluiu o Mestrado em engenharia de sistemas e computa\u00e7\u00e3o pela Universidade Federal do Rio de Janeiro (UFRJ) em 2005, onde cursa Doutorado desde ent\u00e3o. Recebeu o 2\u00b0 lugar na categoria Tecnologia de Explora\u00e7\u00e3o da 1a edi\u00e7\u00e3o do Pr\u00eamio Petrobras de Tecnologia em 2005. Na \u00e1rea de computa\u00e7\u00e3o gr\u00e1fica, seus interesses s\u00e3o: malhas tetraedrais, multirresolu\u00e7\u00e3o, sistema baseado em f\u00edsica e visualiza\u00e7\u00e3o volum\u00e9trica."}]}}}