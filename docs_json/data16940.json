{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.20279"}, {"@name": "filename", "#text": "3750_291658.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE FEDERAL DE SANTA CATARINA\n\nPROGRAMA DE P\u00d3S-GRADUA\u00c7\u00c3O EM ENGENHARIA MEC\u00c2NICA\n\nFernando Sandro Velasco Hurtado\n\nFORMULA\u00c7\u00c3O TRIDIMENSIONAL DE VOLUMES FINITOS PARA\n\nSIMULA\u00c7\u00c3O DE RESERVAT\u00d3RIOS DE PETR\u00d3LEO COM\n\nMALHAS N\u00c3O-ESTRUTURADAS H\u00cdBRIDAS\n\nFlorian\u00f3polis\n\n2011\n\n\n\nFernando Sandro Velasco Hurtado\n\nFORMULA\u00c7\u00c3O TRIDIMENSIONAL DE VOLUMES FINITOS PARA\n\nSIMULA\u00c7\u00c3O DE RESERVAT\u00d3RIOS DE PETR\u00d3LEO COM\n\nMALHAS N\u00c3O-ESTRUTURADAS H\u00cdBRIDAS\n\nTese submetida ao Programa de P\u00f3s-Gradua\u00e7\u00e3o\n\nem Engenharia Mec\u00e2nica da Universidade\n\nFederal de Santa Catarina para a obten\u00e7\u00e3o do\n\ngrau de Doutor em Engenharia Mec\u00e2nica.\n\nOrientador: Clovis Raimundo Maliska, Ph.D\n\nFlorian\u00f3polis\n\n2011\n\n\n\n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n \n\nCataloga\u00e7\u00e3o na fonte pela Biblioteca Universit\u00e1ria \nda \n\nUniversidade Federal de Santa Catarina \n \n \n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n!\n\n!!!!!!!!!\n\"!\n\n!\n!\n\n         \n\n!!!!!!!!!!\n!!!!\n!#$%&amp;'!!#()*+,-.!/0)1+1,-!2+1,)-!304+56-!\n!!!!!!!!!!!/-)7(4+89-!*):,:7015:-1+4!,0!;-4(705!':1:*-5!<+)+!5:7(4+89-!\n!!!!!!!!,0!)050);+*=):-5!,0!<0*)=40-!6-7!7+4>+5!19-?05*)(*()+,+5!!\n!!!!!!!!>@A):,+5!B*050C!D!/0)1+1,-!2+1,)-!304+56-!#()*+,-!E!!\n!!!!!!!!-):01*+,-).!F4-;:5!G+:7(1,-!H+4:5I+\"!?!/4-):+1=<-4:5.!2F.!\n!!!!!!!!JKLL\"!!\n!!!!!!!!!!!L&amp;M!<\"N!:4\".!O)+'5\"!\n!\n!!!!!!!!!!!P050!Q,-(*-)+,-R!?!S1:;0)5:,+,0!/0,0)+4!,0!2+1*+!F+*+):1+.!\n!!!!!!!!F01*)-!P061-4=O:6-\"!T)-O)+7+!,0!T=5?U)+,(+89-!07!V1O01>+):+!\n!!!!!!!!H06W1:6+\"!\n!!\n!!!!!!!!!!!X164(:!)0'0)Y16:+5!\n!\n!!!!!!!!!!!L\"!V1O01>+):+!706W1:6+\"!J\"!G050);+*=):-5!?!HZ*-,-5!\n!!!!!!!!,0!5:7(4+89-\"![\"!HZ*-,-!,-5!;-4(705!':1:*-5\"!X\"!H+4:5I+.!\n!!!!!!!!F\"!G\"!QF4-;:5!G+:7(1,-R\"!XX\"!S1:;0)5:,+,0!/0,0)+4!,0!\n!!!!!!!!2+1*+!F+*+):1+\"!T)-O)+7+!,0!T=5?U)+,(+89-!07!V1O01>+):+!\n!!!!!!!!H06W1:6+\"!XXX\"!P@*(4-\"!!\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!F\\S!%JL!\n!\n!\n!\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n!\n!\n\n\n\nFernando Sandro Velasco Hurtado\n\nFORMULA\u00c7\u00c3O TRIDIMENSIONAL DE VOLUMES FINITOS PARA\n\nSIMULA\u00c7\u00c3O DE RESERVAT\u00d3RIOS DE PETR\u00d3LEO COM\n\nMALHAS N\u00c3O-ESTRUTURADAS H\u00cdBRIDAS\n\nEsta tese foi julgada aprovada para a obten\u00e7\u00e3o do t\u00edtulo de \"Doutor em Engenharia\n\nMec\u00e2nica\", e aprovada em sua forma final pelo Curso de P\u00f3s-gradua\u00e7\u00e3o em Enge-\n\nnharia Mec\u00e2nica.\n\nFlorian\u00f3polis, 05 de abril de 2011\n\nProf. Eduardo Alberto Fancello, D. Sc.\nCoordenador\n\nProf. Clovis Raimundo Maliska, Ph. D.\nOrientador\n\nBanca examinadora:\n\nProf. Clovis Raimundo Maliska, Ph. D.\nPresidente\n\nProf. Francisco Marcondes, Dr. Eng.\nRelator\n\n\n\nProf. \u00c1lvaro Luiz Gayoso de Azeredo Coutinho, Dr.\n\nProf. Eduardo Alberto Fancello, D. Sc.\n\nProf. Ant\u00f3nio F\u00e1bio Carvalho da Silva, Dr. Eng.\n\n\n\nA minha m\u00e3e Gueisa e\n\na minha tia Arminda\n\n\n\nAgradecimentos\n\nAo professor Clovis R. Maliska, pela orienta\u00e7\u00e3o, motiva\u00e7\u00e3o e apoio cons-\n\ntante. Expresso minha eterna gratid\u00e3o pela oportunidade de trabalhar sob\n\nsua orienta\u00e7\u00e3o no laborat\u00f3rio SINMEC.\n\nAo professor F\u00e1bio C. da Silva, pelos conselhos e as discuss\u00f5es que\n\nenriqueceram o conte\u00fado do trabalho.\n\nAos colegas e amigos Carlos N. Donatti, Gustavo G. Ribeiro e Aymar B.\n\nV. Pescador Jr. pela importante ajuda nos aspectos computacionais.\n\nAo pesquisador visitante Axel Dihlmann e a nossa secret\u00e1ria Tatiane\n\nC. Martins pelo aux\u00edlio e colabora\u00e7\u00e3o constantes em nossas atividades co-\n\ntidianas no laborat\u00f3rio SINMEC.\n\nAo Programa de P\u00f3s-gradua\u00e7\u00e3o em Engenharia Mec\u00e2nica da Univer-\n\nsidade Federal de Santa Catarina pela oportunidade de realizar o curso de\n\ndoutorado.\n\nAo Programa de Recursos Humanos da Ag\u00eancia Nacional do Petr\u00f3leo,\n\nG\u00e1s Natural e Biocombust\u00edveis (PRH-ANP), pela bolsa de estudos.\n\n\u00c0 Rede Tem\u00e1tica de Simula\u00e7\u00e3o e Gerenciamento de Reservat\u00f3rios, pa-\n\ntrocinada pela empresa Petrobras S. A., pelo incentivo \u00e0s pesquisas que\n\nmotivaram a realiza\u00e7\u00e3o do presente trabalho.\n\n\u00c0 empresa Engineering Simulation and Scientific Software (ESSS), pelo\n\napoio t\u00e9cnico e por permitir a utiliza\u00e7\u00e3o do aplicativo Kraken para o p\u00f3s-\n\nprocessamento e visualiza\u00e7\u00e3o de resultados.\n\nA toda minha fam\u00edlia, pelo carinho e apoio que recebo a pesar da\n\ndist\u00e2ncia.\n\n\n\nSum\u00e1rio\n\nLista de figuras iv\n\nLista de s\u00edmbolos x\n\nResumo xiv\n\nAbstract xv\n\n1 Introdu\u00e7\u00e3o 1\n1.1 Escopo e contribui\u00e7\u00f5es . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6\n\n1.2 Organiza\u00e7\u00e3o do trabalho . . . . . . . . . . . . . . . . . . . . . . . . . . . 7\n\n2 Aspectos geom\u00e9tricos da discretiza\u00e7\u00e3o 9\n2.1 Malhas n\u00e3o-estruturadas h\u00edbridas . . . . . . . . . . . . . . . . . . . . 9\n\n2.2 Especifica\u00e7\u00e3o de uma malha n\u00e3o-estruturada . . . . . . . . . . . 14\n\n2.3 Topologia dos elementos . . . . . . . . . . . . . . . . . . . . . . . . . . . 17\n\n2.3.1 Tetraedro . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18\n\n2.3.2 Hexaedro . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19\n\n2.3.3 Prisma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n\n2.3.4 Pir\u00e2mide . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21\n\n2.4 Entidades duais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23\n\n2.4.1 Constru\u00e7\u00e3o das faces . . . . . . . . . . . . . . . . . . . . . . . . 25\n\n2.4.2 Constru\u00e7\u00e3o dos subelementos . . . . . . . . . . . . . . . . . 28\n\n2.4.3 Entidades duais compostas . . . . . . . . . . . . . . . . . . . 29\n\n2.5 Malhas de contorno . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34\n\ni\n\n\n\n3 Aspectos num\u00e9ricos b\u00e1sicos 37\n3.1 Caracter\u00edsticas gerais de um m\u00e9todo de volumes finitos ba-\n\nseado em elementos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37\n\n3.2 Conven\u00e7\u00f5es relativas \u00e0 nota\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . 40\n\n3.3 Transforma\u00e7\u00e3o de coordenadas . . . . . . . . . . . . . . . . . . . . . . 44\n\n3.3.1 Matriz jacobiana . . . . . . . . . . . . . . . . . . . . . . . . . . . 45\n\n3.3.2 Fun\u00e7\u00f5es de forma . . . . . . . . . . . . . . . . . . . . . . . . . . 46\n\n3.4 Integra\u00e7\u00e3o num\u00e9rica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50\n\n3.4.1 Aproxima\u00e7\u00e3o de integrais de volume . . . . . . . . . . . . . 50\n\n3.4.2 Aproxima\u00e7\u00e3o de integrais de superf\u00edcie . . . . . . . . . . . 52\n\n3.5 Aproxima\u00e7\u00e3o do gradiente de uma vari\u00e1vel . . . . . . . . . . . . . 56\n\n3.6 Esquemas de interpola\u00e7\u00e3o espacial . . . . . . . . . . . . . . . . . . . 58\n\n4 Discretiza\u00e7\u00e3o de uma equa\u00e7\u00e3o de conserva\u00e7\u00e3o 61\n4.1 Equa\u00e7\u00e3o de conserva\u00e7\u00e3o gen\u00e9rica . . . . . . . . . . . . . . . . . . . . 61\n\n4.2 Discretiza\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63\n\n4.2.1 Termo de transporte advectivo . . . . . . . . . . . . . . . . . 63\n\n4.2.2 Termo de transporte difusivo . . . . . . . . . . . . . . . . . . 64\n\n4.2.3 Integra\u00e7\u00e3o temporal . . . . . . . . . . . . . . . . . . . . . . . . . 65\n\n4.3 Montagem do sistema de equa\u00e7\u00f5es . . . . . . . . . . . . . . . . . . . 68\n\n4.4 Inclus\u00e3o de condi\u00e7\u00f5es de contorno . . . . . . . . . . . . . . . . . . . 72\n\n4.4.1 Condi\u00e7\u00e3o de fluxo prescrito . . . . . . . . . . . . . . . . . . . 72\n\n4.4.2 Condi\u00e7\u00e3o de Dirichlet . . . . . . . . . . . . . . . . . . . . . . . . 73\n\n5 Aplica\u00e7\u00e3o a um modelo de escoamento em reservat\u00f3rios 77\n5.1 Modelo de escoamento bif\u00e1sico . . . . . . . . . . . . . . . . . . . . . . 77\n\n5.2 Discretiza\u00e7\u00e3o do modelo . . . . . . . . . . . . . . . . . . . . . . . . . . . 81\n\n5.2.1 Equa\u00e7\u00e3o da press\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . 82\n\n5.2.2 Equa\u00e7\u00e3o da satura\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . 83\n\n5.2.3 Esquemas de interpola\u00e7\u00e3o espacial . . . . . . . . . . . . . . 85\n\n5.3 Algoritmo de solu\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87\n\n5.4 Representa\u00e7\u00e3o discreta dos po\u00e7os . . . . . . . . . . . . . . . . . . . . 91\n\n5.5 Modelo de po\u00e7o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97\n\n6 Exemplos de aplica\u00e7\u00e3o 105\n6.1 Problemas de difus\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106\n\n6.1.1 Problema 1-A . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108\n\nii\n\n\n\n6.1.2 Problema 1-B . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119\n\n6.1.3 Problema 1-C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123\n\n6.2 Problema 2: advec\u00e7\u00e3o n\u00e3o-linear . . . . . . . . . . . . . . . . . . . . . 124\n\n6.3 Verifica\u00e7\u00e3o do modelo de po\u00e7o . . . . . . . . . . . . . . . . . . . . . . 131\n\n6.3.1 Problema 3-A . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136\n\n6.3.2 Problema 3-B . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 138\n\n6.3.3 Problema 3-C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 140\n\n6.4 Problema 4: deslocamento bif\u00e1sico . . . . . . . . . . . . . . . . . . . 142\n\n7 Conclus\u00e3o 152\n\nRefer\u00eancias bibliogr\u00e1ficas 156\n\nA Par\u00e2metros geom\u00e9tricos 165\nA.1 Determina\u00e7\u00e3o do vetor \u00e1rea de face . . . . . . . . . . . . . . . . . . . 165\n\nA.2 Baricentro das faces . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 168\n\nA.3 C\u00f4mputo do volume de um subelemento . . . . . . . . . . . . . . 170\n\niii\n\n\n\nLista de figuras\n\n1.1 Exemplo de um reservat\u00f3rio discretizado por uma malha\n\ncorner point. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2\n\n1.2 Exemplo de uma malha de Voronoi aplicada a discretiza-\n\n\u00e7\u00e3o de um reservat\u00f3rio . . . . . . . . . . . . . . . . . . . . . . . . . . 3\n\n1.3 Malha h\u00edbrida com geometria radial ao redor dos po\u00e7os . . 4\n\n1.4 Exemplo de uma malha n\u00e3o-estruturada de tri\u00e2ngulos em-\n\npregada no m\u00e9todo de volumes finitos baseado em ele-\n\nmentos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5\n\n1.5 Malha de prismas para a representa\u00e7\u00e3o discreta de fratu-\n\nras em um meio poroso . . . . . . . . . . . . . . . . . . . . . . . . . . 6\n\n2.1 Entidades b\u00e1sicas em uma malha tridimensional . . . . . . . 10\n\n2.2 Exemplos de situa\u00e7\u00f5es que n\u00e3o satisfazem as condi\u00e7\u00f5es\n\nde conformidade . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n\n2.3 Exemplos de transi\u00e7\u00e3o conforme entre hexaedros e tetrae-\n\ndros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14\n\n2.4 Exemplo da especifica\u00e7\u00e3o dos v\u00e9rtices de uma malha . . . . 15\n\n2.5 Exemplo da especifica\u00e7\u00e3o dos elementos de uma malha . . 17\n\n2.6 Topologia do tetraedro . . . . . . . . . . . . . . . . . . . . . . . . . . 18\n\n2.7 Topologia do hexaedro . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n\n2.8 Topologia do prisma . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21\n\n2.9 Topologia da pir\u00e2mide . . . . . . . . . . . . . . . . . . . . . . . . . . . 22\n\n2.10 Entidades prim\u00e1rias e entidades duais em n\u00edvel de elemento 24\n\n2.11 Constru\u00e7\u00e3o das faces no tetraedro, no hexaedro e no prisma 26\n\n2.12 Constru\u00e7\u00e3o das faces no elemento piramidal . . . . . . . . . . 27\n\niv\n\n\n\n2.13 Faces e subelementos no tetraedro . . . . . . . . . . . . . . . . . 28\n\n2.14 Faces e subelementos no hexaedro . . . . . . . . . . . . . . . . . 29\n\n2.15 Faces e subelementos no prisma . . . . . . . . . . . . . . . . . . . 30\n\n2.16 Faces e subelementos na pir\u00e2mide . . . . . . . . . . . . . . . . . . 30\n\n2.17 Volume de controle em uma malha tridimensional mista . 31\n\n2.18 Corte de um volume de controle . . . . . . . . . . . . . . . . . . . 32\n\n2.19 Entidades prim\u00e1rias e entidades duais compostas . . . . . . 33\n\n2.20 Exemplo da especifica\u00e7\u00e3o de uma malha de contorno . . . 34\n\n2.21 Subdivis\u00e3o dos elementos de contorno . . . . . . . . . . . . . . 35\n\n2.22 Volume de controle adjacente a um contorno . . . . . . . . . . 36\n\n3.1 Caracter\u00edsticas fundamentais dos m\u00e9todos de volumes fi-\n\nnitos baseados em elementos . . . . . . . . . . . . . . . . . . . . . 39\n\n3.2 Nota\u00e7\u00e3o de entidades e conjuntos de entidades (parte 1). . 41\n\n3.3 Nota\u00e7\u00e3o de entidades e conjuntos de entidades (parte 2). . 42\n\n3.4 Nota\u00e7\u00e3o de entidades e conjuntos de entidades associa-\n\ndas \u00e0 malhas de contorno. . . . . . . . . . . . . . . . . . . . . . . . . 43\n\n3.5 Tetraedro no espa\u00e7o transformado . . . . . . . . . . . . . . . . . . 47\n\n3.6 Hexaedro no espa\u00e7o transformado . . . . . . . . . . . . . . . . . . 48\n\n3.7 Prisma no espa\u00e7o transformado . . . . . . . . . . . . . . . . . . . . 49\n\n3.8 Pir\u00e2mide no espa\u00e7o transformado . . . . . . . . . . . . . . . . . . 50\n\n3.9 Orienta\u00e7\u00e3o absoluta do vetor \u00e1rea de face . . . . . . . . . . . . 54\n\n3.10 Orienta\u00e7\u00e3o do vetor \u00e1rea de face, relativa aos volumes de\n\ncontrole . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55\n\n3.11 Interpola\u00e7\u00e3o upwind de um ponto . . . . . . . . . . . . . . . . . . 60\n\n4.1 Volume de controle em um escoamento . . . . . . . . . . . . . . 63\n\n4.2 Equa\u00e7\u00e3o discretizada para um volume de controle . . . . . . 68\n\n4.3 Contribui\u00e7\u00f5es de um elemento no sistema de equa\u00e7\u00f5es\n\ndiscretizadas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70\n\n4.4 Contribui\u00e7\u00f5es de uma face no sistema de equa\u00e7\u00f5es dis-\n\ncretizadas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71\n\n4.5 Redu\u00e7\u00e3o do sistema de equa\u00e7\u00f5es pela imposi\u00e7\u00e3o de uma\n\ncondi\u00e7\u00e3o de Dirichlet . . . . . . . . . . . . . . . . . . . . . . . . . . . 75\n\n5.1 Varia\u00e7\u00e3o t\u00edpica das fun\u00e7\u00f5es dependentes da satura\u00e7\u00e3o e\n\nsuas derivadas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87\n\nv\n\n\n\n5.2 Variante do algoritmo de solu\u00e7\u00e3o IMPES . . . . . . . . . . . . . 89\n\n5.3 Representa\u00e7\u00e3o discreta de um po\u00e7o . . . . . . . . . . . . . . . . . 92\n\n5.4 Volume de controle associado a um n\u00f3 no po\u00e7o . . . . . . . . 95\n\n5.5 Grandezas envolvidas em um modelo de po\u00e7o convencional 98\n\n5.6 Problema auxiliar para a determina\u00e7\u00e3o do \u00edndice de po\u00e7o\n\nem duas dimens\u00f5es . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100\n\n5.7 Problema auxiliar para a determina\u00e7\u00e3o do \u00edndice de po\u00e7o\n\nem tr\u00eas dimens\u00f5es . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103\n\n6.1 Especifica\u00e7\u00e3o do problema 1-A . . . . . . . . . . . . . . . . . . . . 108\n\n6.2 Malhas de 20\u00d720\u00d720 hexaedros, apresentando diferente\namplitude de distor\u00e7\u00e3o dos elementos . . . . . . . . . . . . . . . 110\n\n6.3 Converg\u00eancia da press\u00e3o no problema 1-A, para malhas\n\nde hexaedros com diferente amplitude de distor\u00e7\u00e3o . . . . . 111\n\n6.4 Converg\u00eancia do gradiente da press\u00e3o no problema 1-A,\n\npara malhas de hexaedros com diferente amplitude de dis-\n\ntor\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111\n\n6.5 Converg\u00eancia dos fluxos no problema 1-A, para malhas de\n\nhexaedros com diferente amplitude de distor\u00e7\u00e3o . . . . . . . 111\n\n6.6 \u00cdndice de deforma\u00e7\u00e3o dos elementos para diferentes am-\n\nplitudes de distor\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113\n\n6.7 Proje\u00e7\u00e3o de uma faceta arqueada sobre o plano m\u00e9dio . . . 114\n\n6.8 \u00cdndice de arqueamento dos elementos para diferentes am-\n\nplitudes de distor\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114\n\n6.9 Divis\u00e3o de um hexaedro em tetraedros, prismas ou pir\u00e2-\n\nmides . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115\n\n6.10 Converg\u00eancia da press\u00e3o no problema 1-A, para malhas\n\nde tetraedros com diferente amplitude de distor\u00e7\u00e3o . . . . . 116\n\n6.11 Converg\u00eancia do gradiente da press\u00e3o no problema 1-A,\n\npara malhas de tetraedros com diferente amplitude de dis-\n\ntor\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116\n\n6.12 Converg\u00eancia dos fluxos no problema 1-A, para malhas de\n\ntetraedros com diferente amplitude de distor\u00e7\u00e3o . . . . . . . 116\n\n6.13 Converg\u00eancia da press\u00e3o no problema 1-A, para malhas\n\nde prismas com diferente amplitude de distor\u00e7\u00e3o . . . . . . . 117\n\nvi\n\n\n\n6.14 Converg\u00eancia do gradiente da press\u00e3o no problema 1-A,\n\npara malhas de prismas com diferente amplitude de dis-\n\ntor\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117\n\n6.15 Converg\u00eancia da press\u00e3o no problema 1-A, para malhas\n\nde pir\u00e2mides com diferente amplitude de distor\u00e7\u00e3o . . . . . 118\n\n6.16 Converg\u00eancia do gradiente da press\u00e3o no problema 1-A,\n\npara malhas de pir\u00e2mides com diferente amplitude de dis-\n\ntor\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118\n\n6.17 Tr\u00eas malhas h\u00edbridas utilizadas nos testes de converg\u00eancia 119\n\n6.18 Compara\u00e7\u00e3o da converg\u00eancia da press\u00e3o no problema 1-A\n\nem malhas hexa\u00e9dricas, tetra\u00e9dricas e h\u00edbridas . . . . . . . . 120\n\n6.19 Compara\u00e7\u00e3o da converg\u00eancia do gradiente da press\u00e3o no\n\nproblema 1-A em malhas hexa\u00e9dricas, tetra\u00e9dricas e h\u00ed-\n\nbridas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120\n\n6.20 Compara\u00e7\u00e3o da converg\u00eancia dos fluxos no problema 1-A\n\nem malhas hexa\u00e9dricas, tetra\u00e9dricas e h\u00edbridas . . . . . . . . 120\n\n6.21 Especifica\u00e7\u00e3o do problema 1-B . . . . . . . . . . . . . . . . . . . . 121\n\n6.22 Converg\u00eancia da press\u00e3o no problema 1-B em malhas de\n\ndiferente topologia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122\n\n6.23 Converg\u00eancia do gradiente da press\u00e3o no problema 1-B\n\nem malhas de diferente topologia . . . . . . . . . . . . . . . . . . 122\n\n6.24 Converg\u00eancia dos fluxos no problema 1-B em malhas de\n\ndiferente topologia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122\n\n6.25 Especifica\u00e7\u00e3o do problema 1-C . . . . . . . . . . . . . . . . . . . . 123\n\n6.26 Converg\u00eancia da press\u00e3o no problema 1-C em malhas de\n\ndiferentes topologias . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125\n\n6.27 Converg\u00eancia do gradiente da press\u00e3o no problema 1-C\n\nem malhas de diferentes topologias . . . . . . . . . . . . . . . . . 125\n\n6.28 Converg\u00eancia dos fluxos no problema 1-C em malhas de\n\ndiferentes topologias . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125\n\n6.29 Especifica\u00e7\u00e3o do problema 2 . . . . . . . . . . . . . . . . . . . . . . 126\n\n6.30 Fun\u00e7\u00e3o fluxo fracion\u00e1rio e perfil de satura\u00e7\u00e3o anal\u00edtico para\n\no problema 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127\n\n6.31 Varia\u00e7\u00e3o temporal da norma do erro da satura\u00e7\u00e3o no pro-\n\nblema 2, para tr\u00eas malhas de hexaedros regulares . . . . . . . 129\n\nvii\n\n\n\n6.32 Converg\u00eancia do erro da satura\u00e7\u00e3o para malhas hexa\u00e9dri-\n\ncas regulares . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129\n\n6.33 Converg\u00eancia do erro da satura\u00e7\u00e3o para malhas hexa\u00e9dri-\n\ncas apresentando diferente amplitude de distor\u00e7\u00e3o . . . . . 130\n\n6.34 Campos de satura\u00e7\u00e3o correspondentes \u00e0 solu\u00e7\u00e3o anal\u00edtica\n\ne a solu\u00e7\u00f5es num\u00e9ricas obtidas em malhas com diferentes\n\namplitudes de distor\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . . . . . 132\n\n6.35 Converg\u00eancia do erro da satura\u00e7\u00e3o para malhas regulares\n\nde diferente topologia . . . . . . . . . . . . . . . . . . . . . . . . . . . 133\n\n6.36 Especifica\u00e7\u00e3o da geometria do dom\u00ednio e do po\u00e7o . . . . . . 133\n\n6.37 Estrutura da malha M-1 . . . . . . . . . . . . . . . . . . . . . . . . . . 134\n\n6.38 Estrutura da malha M-2 . . . . . . . . . . . . . . . . . . . . . . . . . . 135\n\n6.39 Tensor permeabilidade para os problemas 3-A, 3-B e 3-C . 136\n\n6.40 Compara\u00e7\u00e3o dos campos de press\u00e3o para o problema 3-A\n\nresolvido nas malhas M-1 e M-2 . . . . . . . . . . . . . . . . . . . . 137\n\n6.41 Compara\u00e7\u00e3o dos resultados de vaz\u00e3o no po\u00e7o para o pro-\n\nblema 3-A . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 138\n\n6.42 Compara\u00e7\u00e3o dos campos de press\u00e3o para o problema 3-B\n\nresolvido nas malhas M-1 e M-2 . . . . . . . . . . . . . . . . . . . . 139\n\n6.43 Compara\u00e7\u00e3o dos resultados de vaz\u00e3o no po\u00e7o para o pro-\n\nblema 3-B . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139\n\n6.44 Compara\u00e7\u00e3o dos campos de press\u00e3o para o problema 3-C\n\nresolvido nas malhas M-1 e M-2 . . . . . . . . . . . . . . . . . . . . 141\n\n6.45 Compara\u00e7\u00e3o dos resultados de vaz\u00e3o no po\u00e7o para o pro-\n\nblema 3-C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141\n\n6.46 Malha n\u00e3o-estruturada para o problema 4 . . . . . . . . . . . . 142\n\n6.47 Propriedades f\u00edsicas associadas \u00e0s camadas do reservat\u00f3-\n\nrio no problema 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143\n\n6.48 Geometria dos po\u00e7os e condi\u00e7\u00f5es de opera\u00e7\u00e3o prescritas\n\npra o problema 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144\n\n6.49 Campo de press\u00e3o em tr\u00eas instantes de tempo . . . . . . . . . 145\n\n6.50 Campo de satura\u00e7\u00e3o em tr\u00eas instantes de tempo . . . . . . . 147\n\n6.51 Campo de satura\u00e7\u00e3o em duas se\u00e7\u00f5es transversais do do-\n\nm\u00ednio, para tr\u00eas instantes de tempo . . . . . . . . . . . . . . . . . 148\n\n6.52 Vaz\u00f5es ao longo dos po\u00e7os produtores, em tr\u00eas n\u00edveis de\n\ntempo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 149\n\nviii\n\n\n\n6.53 Varia\u00e7\u00e3o temporal das vaz\u00f5es completas no po\u00e7o P-1 . . . . 150\n\n6.54 Varia\u00e7\u00e3o temporal das vaz\u00f5es completas no po\u00e7o P-2 . . . . 150\n\n6.55 Corte de \u00e1gua nos dois po\u00e7os produtores . . . . . . . . . . . . . 151\n\n6.56 Volume de \u00f3leo produzido nos dois po\u00e7os produtores . . . . 151\n\nA.1 Transforma\u00e7\u00e3o de coordenadas para o c\u00f4mputo do vetor\n\n\u00e1rea de uma face quadrangular . . . . . . . . . . . . . . . . . . . . 166\n\nA.2 Coordenadas locais dos baricentros das faces do tetraedro 169\n\nA.3 Coordenadas locais dos baricentros das faces do hexaedro 169\n\nA.4 Coordenadas locais dos baricentros das faces do prisma . . 170\n\nA.5 Coordenadas locais dos baricentros das faces da pir\u00e2mide 170\n\nA.6 Coordenadas locais dos baricentros e volume dos subele-\n\nmentos do tetraedro . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171\n\nA.7 Coordenadas locais dos baricentros e volume dos subele-\n\nmentos do hexaedro . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171\n\nA.8 Coordenadas locais dos baricentros e volume dos subele-\n\nmentos do prisma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 172\n\nA.9 Coordenadas locais dos baricentros e volume dos subele-\n\nmentos da pir\u00e2mide . . . . . . . . . . . . . . . . . . . . . . . . . . . . 172\n\nix\n\n\n\nLista de s\u00edmbolos\n\nGrandezas f\u00edsicas\n\nC Condut\u00e2ncia gen\u00e9rica\n\nF Fun\u00e7\u00e3o fluxo fracion\u00e1rio\n\ng Magnitude da acelera\u00e7\u00e3o da gravidade LT?2\n\ng Vetor acelera\u00e7\u00e3o da gravidade LT?2\n\nG Fun\u00e7\u00e3o potencial associada \u00e0 gravidade L2 T?2\n\nK Tensor permeabilidade absoluta L2\n\nk r Permeabilidade relativa\n\nm? Fluxo de massa MT?1\n\nM Massa M\n\nP Press\u00e3o ML?1 T?2\n\nr Vetor posi\u00e7\u00e3o de um ponto L\nr Coordenada radial L\n\nq Vaz\u00e3o L3 T?1\n\ns Satura\u00e7\u00e3o\n\nS Vetor \u00e1rea L2\n\nt Tempo T\n\nu Coordenada na dire\u00e7\u00e3o axial de um po\u00e7o L\n\nv Vetor velocidade LT?1\n\nV Volume L3\n\nWI \u00cdndice de po\u00e7o L3\n\nx , y , z Coordenadas cartesianas L\n\n? Fluxo gen\u00e9rico atrav\u00e9s de uma fronteira\n? Mobilidade M?1 LT\n\nx\n\n\n\n\u00b5 Viscosidade din\u00e2mica ML?1 T?1\n\n? Fluxo parcial associado ao termo da gravidade L5 T?2\n\n$ Vaz\u00e3o entre po\u00e7o e reservat\u00f3rio L3 T?1\n\n$? Vaz\u00e3o por unidade de comprimento de po\u00e7o L2 T?1\n\n? Press\u00e3o na interface entre po\u00e7o e reservat\u00f3rio ML?1 T?2\n\n? Termo fonte na equa\u00e7\u00e3o gen\u00e9rica de conserva\u00e7\u00e3o\n\n? Densidade ML?3\n\n? Produto da mobilidade total e a densidade m\u00e9dia L?2 T\n\n? Porosidade\n\n? Densidade de fluxo gen\u00e9rica\n? Grandeza escalar gen\u00e9rica\n? Tempo adimensional\n\n? Fun\u00e7\u00e3o auxiliar associada ao termo da gravidade M?1 LT\n? Coordenada na dire\u00e7\u00e3o da gravidade L\n\n?,?,? Coordenadas locais L\n\nSub\u00edndices\n\nadm Admiss\u00edvel\n\naux Auxiliar\n\nM M\u00e9dio\n\nmax M\u00e1ximo\n\nmin M\u00ednimo\n\no Fasea \u00f3leo\n\nref Referido ao n\u00edvel de refer\u00eancia\n\nw Fase \u00e1gua\n\nwo Dependente de ambas as fases, \u00e1gua e \u00f3leo\n\nT Total\n\n? Fase gen\u00e9rica\n\nEntidades geom\u00e9tricas\n\nB Malha superficial associada a um contorno\ne Elemento\n\nE Conjunto de elementos\n\nxi\n\n\n\nf Face\n?f Baricentro de uma face\nF Conjunto de faces\n` N\u00f3 (v\u00e9rtice) quando referido a um elemento\n\nM Malha volum\u00e9trica\nn N\u00f3 (v\u00e9rtice)\n\nN Conjunto de n\u00f3s\np N\u00f3 (v\u00e9rtice) quando associado a um volume de controle\n\ns Subelemento\n?s Baricentro de um subelemento\nS Superf\u00edcie de controle\nV Volume de controle\nW Malha unidimensional associada a um po\u00e7o\nbe Elemento de contorno\nbE Conjunto de elementos de contorno\nbf Face de contorno\nbF Conjunto de faces de contorno\nwe Elemento de po\u00e7o\nwE Conjunto de elementos de po\u00e7o\n? Dom\u00ednio\n?? Contorno\n\nGrandezas associadas \u00e0 discretiza\u00e7\u00e3o\n\nA Matriz de coeficientes de um sistema de equa\u00e7\u00f5es lineares\nA Coeficiente de uma equa\u00e7\u00e3o linear. Amplitude da distor\u00e7\u00e3o\n\nde uma malha\n\nb Vetor de termos independentes de um sistema de equa\u00e7\u00f5es\nlineares\n\nb Termo independente de uma equa\u00e7\u00e3o linear\n\nD Matriz de derivadas parciais das fun\u00e7\u00f5es de forma\nh Comprimento representativo dos elementos de uma malha\n\nI Tensor identidade\nJ Matriz jacobiana da transforma\u00e7\u00e3o de coordenadas\nnB( f ) N\u00f3 (volume de controle) localizado atr\u00e1s da face f , de\n\nacordo com a orienta\u00e7\u00e3o absoluta\n\nxii\n\n\n\nnC(bf ) N\u00f3 (volume de controle) associado \u00e0 face de contorno bf\n\nnF( f ) N\u00f3 (volume de controle) localizado a frente da face f , de\n\nacordo com a orienta\u00e7\u00e3o absoluta\n\nN Fun\u00e7\u00e3o de forma\nN en N\u00famero de n\u00f3s (v\u00e9rtices) do elemento e\n\nN Me N\u00famero total de elementos da malha M\nN Mn N\u00famero de n\u00f3s (v\u00e9rtices) da malha M\nNt N\u00famero de n\u00edveis de tempo discretos\n\n? Coeficiente associado a um esquema de interpola\u00e7\u00e3o local\n\nem um elemento\n\n? Operador associado \u00e0 aproxima\u00e7\u00e3o do fluxo difusivo atrav\u00e9s\nde uma face\n\n? Componente do operador associado \u00e0 aproxima\u00e7\u00e3o do fluxo\n\ndifusivo atrav\u00e9s de uma face\n\n?S Vetor \u00e1rea associado a uma entidade geom\u00e9trica da malha\n?t Intervalo de tempo\n?V Volume de uma entidade geom\u00e9trica da malha\n? Norma do erro associado a uma aproxima\u00e7\u00e3o num\u00e9rica\n\n? Par\u00e2metro auxiliar que fornece o sinal apropriado para o\n\nvetor \u00e1rea de face em rela\u00e7\u00e3o a um volume de controle\n\nOutros s\u00edmbolos\n\n??? Derivada parcial da vari\u00e1vel ? em rela\u00e7\u00e3o \u00e0 vari\u00e1vel inde-\npendente ?\n\n?? Gradiente da vari\u00e1vel escalar ?\n?\u00b7? Divergente da vari\u00e1vel vetorial ?\n?? Valor m\u00e9dio da vari\u00e1vel ?\n?? Valor nodal da vari\u00e1vel ?\n?? Vetor de valores nodais da vari\u00e1vel ?\n??\n\ne\nVetor de valores nodais da vari\u00e1vel ? no elemento e\n\nb?cm Valor da vari\u00e1vel ? no n\u00edvel de tempo m\nAT Transposta da matriz A\nA?1 Inversa da matriz A\nA?T Inversa da transposta da matriz A\n\nxiii\n\n\n\nResumo\n\nA simula\u00e7\u00e3o num\u00e9rica \u00e9 uma das ferramentas mais poderosas que auxi-\n\nliam a tomada de decis\u00f5es nos processos de produ\u00e7\u00e3o de reservat\u00f3rios\n\nde petr\u00f3leo. Entretanto, atualmente h\u00e1 uma defasagem entre a qualidade\n\nda descri\u00e7\u00e3o f\u00edsica e geom\u00e9trica dos reservat\u00f3rios dispon\u00edvel e a capaci-\n\ndade dos m\u00e9todos num\u00e9ricos empregados para resolver os modelos de\n\nescoamento multif\u00e1sico nos simuladores comerciais. O grande desafio \u00e9\n\nincorporar essa informa\u00e7\u00e3o detalhada em modelos num\u00e9ricos de modo a\n\nincrementar a precis\u00e3o e a confiabilidade das simula\u00e7\u00f5es obtidas. Uma\n\ndas alternativas para tanto, analisada neste trabalho, \u00e9 a utiliza\u00e7\u00e3o de ma-\n\nlhas n\u00e3o-estruturadas h\u00edbridas como base geom\u00e9trica para a discretiza\u00e7\u00e3o\n\ndas equa\u00e7\u00f5es que modelam o escoamento nos reservat\u00f3rios. As malhas\n\ntridimensionais consideradas podem estar formadas, no caso mais geral,\n\npor quatro tipos de elementos: tetraedros, hexaedros, prismas e pir\u00e2mi-\n\ndes. Uma vez que cada um desses tipos de elementos se adapta melhor\n\n\u00e0 discretiza\u00e7\u00e3o de determinados tipos de geometrias, a possibilidade de\n\nutiliz\u00e1-los do modo unificado em uma mesma formula\u00e7\u00e3o confere a ela\n\num alto grau de flexibilidade geom\u00e9trica. O m\u00e9todo de volumes finitos\n\nbaseado em elementos \u00e9 considerado para a discretiza\u00e7\u00e3o das equa\u00e7\u00f5es\n\ndiferenciais que descrevem o escoamento multif\u00e1sico nos reservat\u00f3rios.\n\nUma das principais caracter\u00edsticas do m\u00e9todo, de import\u00e2ncia fundamen-\n\ntal na simula\u00e7\u00e3o de reservat\u00f3rios, \u00e9 a conserva\u00e7\u00e3o estrita das grandezas\n\nf\u00edsicas no n\u00edvel discreto. Mediante experimentos num\u00e9ricos empregando a\n\nformula\u00e7\u00e3o apresentada, diversas caracter\u00edsticas da metodologia s\u00e3o ava-\n\nliadas neste trabalho.\n\nxiv\n\n\n\nAbstract\n\nNumerical simulation is a powerful tool for predicting the production per-\n\nformance of petroleum reservoirs. However, it is evident an increasing\n\ngap between the quality of the geologic models currently available and the\n\ncapacity of numerical models in reservoir simulators. The incorporation of\n\nsuch detailed geometrical and physical information in flow numerical mo-\n\ndels, in order to increase accuracy and reliability, is a big challenge today.\n\nAn option for that, analyzed in this work, is the use of hybrid unstructured\n\ngrids as geometrical basis for the discretization of differential equations.\n\nThe three-dimensional grids considered are formed by tetrahedra, hexahe-\n\ndra, prisms, and pyramids, in the most general case. A numerical formu-\n\nlation treating those elements in a unified way achieves a high degree of\n\nflexibility for dealing with complex domains. In order to achieve that, the\n\nelement-based finite volume method is considered for the discretization of\n\nthe multiphase flow differential equations. The strict conservation of phy-\n\nsical quantities at discrete level is one of the main features of the method,\n\nand a fundamental one for reservoir simulation. By means of numerical\n\nexperiments, several properties of the described numerical formulation\n\nare evaluated in this work.\n\nxv\n\n\n\nCAP\u00cdTULO\n\n1\nIntrodu\u00e7\u00e3o\n\nA simula\u00e7\u00e3o de reservat\u00f3rios de petr\u00f3leo tem como meta final a previs\u00e3o\n\nda produ\u00e7\u00e3o de hidrocarbonetos de um reservat\u00f3rio sob diferentes estra-\n\nt\u00e9gias de opera\u00e7\u00e3o. Para tanto, modelos matem\u00e1ticos do escoamento de\n\nfluidos no reservat\u00f3rio devem ser aproximados numericamente e resolvi-\n\ndos com aux\u00edlio de equipamentos computacionais. Todo modelo num\u00e9-\n\nrico est\u00e1 baseado em aproxima\u00e7\u00f5es num\u00e9ricas das equa\u00e7\u00f5es governantes,\n\nassociadas a uma representa\u00e7\u00e3o discreta do dom\u00ednio de solu\u00e7\u00e3o, a deno-\n\nminada malha computacional.\n\nNos prim\u00f3rdios da simula\u00e7\u00e3o de reservat\u00f3rios consideravam-se ma-\n\nlhas extremamente simples para representar a geometria de um reservat\u00f3-\n\nrio. Isso, por uma parte, permitia simplificar o modelo num\u00e9rico a ponto\n\nde permitir a solu\u00e7\u00e3o das equa\u00e7\u00f5es resultantes com os recursos computa-\n\ncionais dispon\u00edveis na \u00e9poca. Al\u00e9m do mais, o conhecimento da estrutura\n\nf\u00edsica dos reservat\u00f3rios, que a tecnologia da \u00e9poca permitia determinar, era\n\ntamb\u00e9m bastante limitado. Contudo, essa situa\u00e7\u00e3o tem mudado significa-\n\ntivamente em anos recentes, em que modelos geol\u00f3gicos tridimensionais\n\nbastante detalhados podem ser obtidos, gra\u00e7as a avan\u00e7os sustanciais em\n\ndisciplinas tais como a geof\u00edsica, a petrof\u00edsica e a geoestat\u00edstica. Os mo-\n\ndelos geol\u00f3gicos dispon\u00edveis atualmente cont\u00eam muita mais informa\u00e7\u00e3o\n\n1\n\n\n\nINT RO DU\u00c7\u00c3O 2\n\nsobre a estrutura f\u00edsica dos reservat\u00f3rios da que pode ser utilizada na si-\n\nmula\u00e7\u00e3o dos escoamentos associados [29].\nNa atualidade, a maioria dos simuladores comerciais empregam as\n\ndenominadas malhas corner point [13, 19], para a representa\u00e7\u00e3o geom\u00e9-\ntrica dos reservat\u00f3rios. Essas malhas s\u00e3o formadas por hexaedros, os quais\n\nest\u00e3o organizados mantendo a mesma estrutura l\u00f3gica das malhas carte-\n\nsianas. No entanto, como nas malhas corner point \u00e9 poss\u00edvel especificar as\n\ncoordenadas dos v\u00e9rtices dos hexaedros, estas podem ser n\u00e3o-ortogonais.\n\nGra\u00e7as a isso \u00e9 poss\u00edvel conformar as faces dos volumes com algumas su-\n\nperf\u00edcies do modelo geol\u00f3gico, tais como os horizontes que separam ca-\n\nmadas de diferente material rochoso ou falhas geol\u00f3gicas. Contudo, como\n\na malha deve manter uma estrutura l\u00f3gica r\u00edgida, a representa\u00e7\u00e3o de algu-\n\nmas dessas caracter\u00edsticas geom\u00e9tricas do reservat\u00f3rio pode ser bastante\n\ngrosseira. A figura 1.1 mostra um exemplo de uma malha corner point\n\nrepresentando a geometria de um reservat\u00f3rio.\n\nVolume de controle\n\nFigura 1.1 \u2013 Exemplo de um reservat\u00f3rio discretizado por uma malha cor-\nner point.\n\nEm certas aplica\u00e7\u00f5es pode ser necess\u00e1ria a representa\u00e7\u00e3o mais acu-\n\nrada da geometria de componentes cr\u00edticos do modelo f\u00edsico de um re-\n\nservat\u00f3rio, como falhas, fraturas ou po\u00e7os. Uma alternativa, para tanto,\n\n\u00e9 o uso de malhas n\u00e3o-estruturadas, as quais s\u00e3o amplamente utilizadas\n\nem outras disciplinas, por exemplo, CFD 1, an\u00e1lise estrutural, eletromag-\n\n1 Computational fluid dynamics.\n\n\n\nINT RO DU\u00c7\u00c3O 3\n\nnetismo e outras. Nesse tipo de malhas, o dom\u00ednio de solu\u00e7\u00e3o \u00e9 dividido\n\nem entidades de geometria simples, as quais n\u00e3o precisam ser arranjadas\n\nde acordo a uma estrutura predeterminada. Gra\u00e7as a essa caracter\u00edstica, as\n\nmalhas n\u00e3o-estruturadas podem representar geometrias altamente com-\n\nplexas de modo preciso e eficiente. O presente trabalho est\u00e1 dedicado ao\n\ndesenvolvimento de uma formula\u00e7\u00e3o num\u00e9rica de volumes finitos, capaz\n\nde resolver problemas de escoamento multif\u00e1sico em reservat\u00f3rios discre-\n\ntizados por meio de malhas n\u00e3o-estruturadas tridimensionais.\n\nUma das primeiras tentativas de aplica\u00e7\u00e3o de malhas n\u00e3o-estruturadas\n\n\u00e0 simula\u00e7\u00e3o de reservat\u00f3rios tridimensionais deu-se no in\u00edcio da d\u00e9cada de\n\nnoventa, com as denominadas malhas de Voronoi 2 [29, 30, 48, 79]. Nessas\nmalhas, as interfaces entre volumes de controle vizinhos s\u00e3o perpendicu-\n\nlares aos segmentos que unem os pontos em que as vari\u00e1veis s\u00e3o aproxi-\n\nmadas e, al\u00e9m disso, cortam esses segmentos no ponto m\u00e9dio. Gra\u00e7as a\n\ntal propriedade, ilustrada na figura 1.2, o fluxo em uma interface pode ser\n\naproximado considerando apenas valores correspondentes aos dois pon-\n\ntos vizinhos \u00e0 interface. Essa simplifica\u00e7\u00e3o, contudo, somente \u00e9 v\u00e1lida se o\n\nmeio poroso representado for isotr\u00f3pico.\n\nVolume decontrole \n\nFace perpendicular\u00e0 reta entre n\u00f3s vizinhos  \nFigura 1.2 \u2013 Exemplo de uma malha de Voronoi aplicada a discretiza\u00e7\u00e3o de\n\num reservat\u00f3rio.\n\nApesar de ter sido desenvolvida uma extens\u00e3o das malhas de Voronoi\n\npara casos anisotr\u00f3picos, as denominadas malhas kPEBI [29], sua apli-\n\n2 Mais conhecidas na \u00e1rea como malhas PEBI (perpendicular bisection).\n\n\n\nINT RO DU\u00c7\u00c3O 4\n\nca\u00e7\u00e3o era limitada a baixos n\u00edveis de anisotropia. Al\u00e9m disso, como no\n\nexemplo da figura 1.2, na maioria das discretiza\u00e7\u00f5es aplicando malhas de\n\nVoronoi a malha era n\u00e3o-estruturada apenas no plano horizontal. Mais\n\nrecentemente foram propostas t\u00e9cnicas para constru\u00e7\u00e3o de malhas h\u00edbri-\n\ndas baseadas em uma generaliza\u00e7\u00e3o dos diagramas de Voronoi [5, 21, 55].\nNessas malhas h\u00edbridas, um exemplo das quais \u00e9 mostrado na figura 1.3, a\n\nmaior parte do reservat\u00f3rio \u00e9 discretizado por uma malha estruturada cor-\n\nner point, a vizinhan\u00e7a dos po\u00e7os por malhas cil\u00edndricas adaptadas \u00e0 tra-\n\njet\u00f3ria dos po\u00e7os e as regi\u00f5es de transi\u00e7\u00e3o por malhas com caracter\u00edsticas\n\nsemelhantes \u00e0s malhas de Voronoi. O intuito desse tipo de discretiza\u00e7\u00e3o\n\n\u00e9 a representa\u00e7\u00e3o acurada da trajet\u00f3ria de po\u00e7os direcionais. O modelo\n\nnum\u00e9rico para o escoamento mant\u00e9m, entretanto, as mesmas limita\u00e7\u00f5es\n\nque nas malhas corner point e Voronoi quanto \u00e0 representa\u00e7\u00e3o de meios\n\nanisotr\u00f3picos.\n\nMalha ao redorde um po\u00e7o\n\nFigura 1.3 \u2013 Malha h\u00edbrida com geometria radial ao redor dos po\u00e7os (repro-\nduzida da refer\u00eancia [21]).\n\nNa literatura, a maioria das aplica\u00e7\u00f5es de malhas n\u00e3o-estruturadas\n\nmais gerais \u00e0 simula\u00e7\u00e3o de reservat\u00f3rios correspondem a formula\u00e7\u00f5es bi-\n\ndimensionais, em que o reservat\u00f3rio \u00e9 representado por uma malha de tri-\n\n\u00e2ngulos [17, 22, 26, 28], de quadril\u00e1teros [38, 70] ou uma mistura de tri\u00e2n-\ngulos e quadril\u00e1teros [12, 24, 34]. Todas as publica\u00e7\u00f5es rec\u00e9m citadas em-\npregam variantes do denominado control-volume finite element method\n\n(CVFEM), para a discretiza\u00e7\u00e3o das equa\u00e7\u00f5es do modelo de escoamento.\n\nNesse m\u00e9todo, as vari\u00e1veis s\u00e3o aproximadas nos v\u00e9rtices da malha e os vo-\n\n\n\nINT RO DU\u00c7\u00c3O 5\n\nlumes de controle s\u00e3o constru\u00eddos como entidades duais dos v\u00e9rtices, com\n\ncontribui\u00e7\u00f5es de diferentes elementos. N\u00e3o existe, como em formula\u00e7\u00f5es\n\nutilizadas com malhas de Voronoi, nenhum requisito de ortogonalidade\n\npara a constru\u00e7\u00e3o dos volumes de controle. Um volume de controle t\u00edpico\n\ndo m\u00e9todo \u00e9 mostrado na figura 1.4, al\u00e9m de um exemplo de uma malha\n\nn\u00e3o-estruturada de tri\u00e2ngulos.\n\nA deriva\u00e7\u00e3o das equa\u00e7\u00f5es discretizadas segue as diretrizes do m\u00e9todo\n\nde volumes finitos, em que cada equa\u00e7\u00e3o representa o balan\u00e7o de alguma\n\ngrandeza f\u00edsica em um volume de controle. Nesses balan\u00e7os, os fluxos nas\n\ninterfaces entre volumes de controle podem ser determinados mediante\n\naproxima\u00e7\u00f5es num\u00e9ricas restritas aos elementos da malha. Devido a essas\n\ncaracter\u00edsticas, neste trabalho prefere-se empregar para esse tipo de abor-\n\ndagem o nome de m\u00e9todo de volumes finitos baseado em elementos [45]. A\nformula\u00e7\u00e3o num\u00e9rica apresentada nos cap\u00edtulos subsequentes segue esse\n\nenfoque b\u00e1sico e o estende a malhas tridimensionais h\u00edbridas, formadas\n\npor tetraedros, hexaedros, prismas e pir\u00e2mides.\n\nVolume decontrole\n\nElemento\nFigura 1.4 \u2013 Exemplo de uma malha n\u00e3o-estruturada de tri\u00e2ngulos (repro-\n\nduzida da refer\u00eancia [28]) e da constru\u00e7\u00e3o de um volume de\ncontrole no m\u00e9todo de volumes finitos baseado em elementos.\n\nAlgumas formula\u00e7\u00f5es empregando malhas n\u00e3o-estruturadas tridimen-\n\nsionais t\u00eam sido publicadas em anos recentes, a maioria delas voltadas \u00e0\n\nsimula\u00e7\u00e3o de reservat\u00f3rios fraturados [25, 33, 50, 53, 58, 68]. Nessas for-\nmula\u00e7\u00f5es, as fraturas s\u00e3o representadas de forma discreta, segundo ilus-\n\ntra a figura 1.5, aproveitando a flexibilidade geom\u00e9trica das malhas n\u00e3o-\n\nestruturadas.\n\n\n\nINT RO DU\u00c7\u00c3O 6\n\nFracturas\nFigura 1.5 \u2013 Malha de prismas para a representa\u00e7\u00e3o discreta de fraturas em\n\num meio poroso (reproduzida da refer\u00eancia [33]).\n\n1.1 Escopo e contribui\u00e7\u00f5es\n\nO objetivo principal deste trabalho \u00e9 desenvolver uma extens\u00e3o para tr\u00eas\n\ndimens\u00f5es do m\u00e9todo de volumes finitos baseado em elementos, apta para\n\nser aplicada \u00e0 simula\u00e7\u00e3o de reservat\u00f3rios. De forma semelhante ao caso\n\nbidimensional, em que \u00e9 poss\u00edvel tratar de forma unificada malhas n\u00e3o-\n\nestruturadas de tri\u00e2ngulos e/ou quadril\u00e1teros, a formula\u00e7\u00e3o apresentada\nconsidera malhas que podem estar constitu\u00eddas por elementos de formas\n\ndiferentes. As malhas tridimensionais consideradas podem estar formadas\n\npor hexaedros, tetraedros, prismas, pir\u00e2mides ou uma mistura de todos\n\nesses elementos. \u00c9 poss\u00edvel antever o grande potencial da aplica\u00e7\u00e3o de\n\nmalhas h\u00edbridas, formadas por esses tipos de elementos, para a represen-\n\nta\u00e7\u00e3o de detalhes geom\u00e9tricos importantes dos reservat\u00f3rios de petr\u00f3leo.\n\nA possibilidade de considerar diferentes elementos na discretiza\u00e7\u00e3o de um\n\ndom\u00ednio f\u00edsico confere um grau adicional de flexibilidade a uma formula-\n\n\u00e7\u00e3o num\u00e9rica para malhas n\u00e3o-estruturadas.\n\nA descri\u00e7\u00e3o da formula\u00e7\u00e3o \u00e9 realizada de forma sistem\u00e1tica, abordando\n\ninicialmente os aspectos puramente geom\u00e9tricos da metodologia, para de-\n\npois apresentar as aproxima\u00e7\u00f5es num\u00e9ricas associadas, em ordem cres-\n\ncente de complexidade. Alguns aspectos importantes que nem sempre\n\ns\u00e3o descritos adequadamente na literatura, por exemplo, a especifica\u00e7\u00e3o\n\n\n\nINT RO DU\u00c7\u00c3O 7\n\nde malhas n\u00e3o-estruturadas, s\u00e3o abordados com certo detalhe. Especial\n\n\u00eanfase \u00e9 dada a defini\u00e7\u00e3o de uma nota\u00e7\u00e3o completa e consistente para\n\nassociar as aproxima\u00e7\u00f5es num\u00e9ricas a entidades geom\u00e9tricas das malhas\n\ncomputacionais.\n\nPara a apresenta\u00e7\u00e3o da formula\u00e7\u00e3o num\u00e9rica adotou-se um enfoque\n\nque vai do geral ao particular de forma gradual. Inicialmente s\u00e3o descritas\n\nas aproxima\u00e7\u00f5es num\u00e9ricas b\u00e1sicas de modo geral, sem qualquer parti-\n\nculariza\u00e7\u00e3o espec\u00edfica aos modelos de escoamentos em reservat\u00f3rios de\n\npetr\u00f3leo. Por uma parte, isso facilita a apresenta\u00e7\u00e3o, pois permite focar a\n\ndescri\u00e7\u00e3o nos aspectos num\u00e9ricos relevantes sem que detalhes espec\u00edficos\n\na um dado modelo tornem as equa\u00e7\u00f5es mais complexas do necess\u00e1rio. Por\n\noutro lado, essa abordagem permitir\u00e1 que o trabalho sirva de base para\n\nfuturos trabalhos visando aplicar a metodologia apresentada a outro tipo\n\nde problemas f\u00edsicos.\n\nAp\u00f3s consolidadas as bases geom\u00e9tricas e num\u00e9ricas da metodologia,\n\nela \u00e9 aplicada \u00e0 discretiza\u00e7\u00e3o de um modelo de escoamento bif\u00e1sico em re-\n\nservat\u00f3rios. Um dos componentes chave para uma formula\u00e7\u00e3o aplicada \u00e0\n\nsimula\u00e7\u00e3o de reservat\u00f3rios \u00e9 a modelagem do escoamento entre os po\u00e7os e\n\no reservat\u00f3rio. Para a discretiza\u00e7\u00e3o na vizinhan\u00e7a dos po\u00e7os \u00e9 considerada\n\numa abordagem similar \u00e0 proposta em [5, 21], com malhas de geometria\ncil\u00edndrica acompanhando a trajet\u00f3ria dos po\u00e7os. Entretanto, diferente-\n\nmente das malhas consideradas nas refer\u00eancias citadas, com a formula\u00e7\u00e3o\n\nde volumes finitos baseada em elementos n\u00e3o existe qualquer restri\u00e7\u00e3o de\n\nortogonalidade para a discretiza\u00e7\u00e3o dos reservat\u00f3rios. Complementando\n\nesse tipo de representa\u00e7\u00e3o geom\u00e9trica, \u00e9 considerado um procedimento\n\nespecial para determinar os denominados \u00edndices de po\u00e7o, os quais s\u00e3o\n\nempregados para modelar o escoamento entre um po\u00e7o e o reservat\u00f3rio.\n\n1.2 Organiza\u00e7\u00e3o do trabalho\n\nEste trabalho est\u00e1 dividido em 7 cap\u00edtulos, incluindo a presente introdu\u00e7\u00e3o\n\ne a conclus\u00e3o. Os restantes cap\u00edtulos s\u00e3o sintetizados a seguir.\n\nO cap\u00edtulo 2 apresenta os conceitos relativos \u00e0 geometria da discre-\n\ntiza\u00e7\u00e3o em um m\u00e9todo de volumes finitos baseado em elementos. Esses\n\nconceitos ser\u00e3o aplicados nos cap\u00edtulos subsequentes na descri\u00e7\u00e3o siste-\n\nmatizada da formula\u00e7\u00e3o num\u00e9rica. Espacial aten\u00e7\u00e3o \u00e9 dada aos aspectos\n\n\n\nINT RO DU\u00c7\u00c3O 8\n\nconstrutivos das entidades duais que determinam os volumes de controle,\n\ndada a import\u00e2ncia dessas entidades na metodologia adotada.\n\nNo cap\u00edtulo 3 s\u00e3o apresentados os ingredientes b\u00e1sicos de uma for-\n\nmula\u00e7\u00e3o num\u00e9rica de volumes finitos baseada em elementos. As aproxi-\n\nma\u00e7\u00f5es num\u00e9ricas descritas neste cap\u00edtulo possuem car\u00e1ter geral, pois\n\npodem ser aplicadas \u00e0 discretiza\u00e7\u00e3o de equa\u00e7\u00f5es que modelam um amplo\n\nespectro de processos f\u00edsicos, al\u00e9m daqueles encontrados na simula\u00e7\u00e3o\n\nde reservat\u00f3rios. O esquema de nota\u00e7\u00e3o proposto para a metodologia \u00e9\n\ndescrito no in\u00edcio do cap\u00edtulo.\n\nNo cap\u00edtulo 4, os conceitos apresentados no cap\u00edtulo 3 s\u00e3o aplicados\n\n\u00e0 discretiza\u00e7\u00e3o de uma equa\u00e7\u00e3o de conserva\u00e7\u00e3o de uma grandeza escalar\n\ngen\u00e9rica. Essa equa\u00e7\u00e3o \u00e9 o prot\u00f3tipo das equa\u00e7\u00f5es que comp\u00f5em diversos\n\nmodelos de escoamentos, n\u00e3o apenas no \u00e2mbito da simula\u00e7\u00e3o de reser-\n\nvat\u00f3rios. Por esse motivo, o conte\u00fado desse cap\u00edtulo, assim como o dos\n\ncap\u00edtulos precedentes, pode ser utilizado em outras formula\u00e7\u00f5es num\u00e9ri-\n\ncas aplicando a metodologia. A descri\u00e7\u00e3o da discretiza\u00e7\u00e3o da equa\u00e7\u00e3o de\n\nconserva\u00e7\u00e3o gen\u00e9rica \u00e9 realizada passo a passo at\u00e9 a fase final do processo,\n\nque \u00e9 a inclus\u00e3o das condi\u00e7\u00f5es de contorno do problema no sistema de\n\nequa\u00e7\u00f5es discretizadas.\n\nNo cap\u00edtulo 5, o procedimento de discretiza\u00e7\u00e3o descrito em cap\u00edtulos\n\nprecedentes \u00e9 aplicado a um modelo de escoamento bif\u00e1sico imisc\u00edvel.\n\nAl\u00e9m de descrever adequadamente diversos processos de deslocamento\n\nem reservat\u00f3rios, esse modelo e o suficientemente simples como para per-\n\nmitir uma descri\u00e7\u00e3o detalhada do processo de discretiza\u00e7\u00e3o das equa\u00e7\u00f5es.\n\nNa parte final do cap\u00edtulo \u00e9 descrita a forma como o escoamento entre um\n\npo\u00e7o e o reservat\u00f3rio \u00e9 modelado na formula\u00e7\u00e3o.\n\nPor fim, o cap\u00edtulo 6 \u00e9 dedicado a apresentar resultados de alguns\n\nexemplos de aplica\u00e7\u00e3o da formula\u00e7\u00e3o desenvolvida. No intuito de verifi-\n\ncar a converg\u00eancia das solu\u00e7\u00f5es num\u00e9ricas, problemas simplificados s\u00e3o\n\nresolvidos em sequ\u00eancias de malhas com refinamento progressivo. Para\n\ntanto, dom\u00ednios de geometria simples e malhas de estrutura topol\u00f3gica\n\nfixa s\u00e3o consideradas, a fim de manter sob controle a forma em que o refi-\n\nnamento das malhas \u00e9 realizado. Considerando outro tipo de problemas,\n\n\u00e9 realizada a verifica\u00e7\u00e3o do modelo de po\u00e7o proposto no cap\u00edtulo 5. Na\n\nparte final do cap\u00edtulo \u00e9 apresentado um problema demonstrativo em um\n\nreservat\u00f3rio sint\u00e9tico tridimensional.\n\n\n\nCAP\u00cdTULO\n\n2\nAspectos geom\u00e9tricos\nda discretiza\u00e7\u00e3o\n\n2.1 Malhas n\u00e3o-estruturadas h\u00edbridas\n\nDe uma forma geral, uma malha computacional \u00e9 um conjunto de entida-\n\ndes geom\u00e9tricas que constituem a representa\u00e7\u00e3o discreta de um dom\u00ednio\n\nespacial. O prop\u00f3sito de uma malha \u00e9 proporcionar o suporte geom\u00e9trico\n\nao processo de discretiza\u00e7\u00e3o das equa\u00e7\u00f5es governantes de um problema\n\nf\u00edsico definido nesse dom\u00ednio. Assim, em um m\u00e9todo num\u00e9rico, a repre-\n\nsenta\u00e7\u00e3o discreta das vari\u00e1veis do problema sempre est\u00e1 associada a de-\n\nterminadas entidades da malha computacional.\n\nUma malha \u00e9 composta, em geral, por entidades geom\u00e9tricas de dife-\n\nrente dimens\u00e3o. Em uma malha definida em Rn coexistem entidades de\ndimens\u00e3o d = 0, . . . , n , com rela\u00e7\u00f5es de interdepend\u00eancia entre elas. As\nentidades de dimens\u00e3o n s\u00e3o as entidades principais da malha, pois s\u00e3o\n\nas por\u00e7\u00f5es finitas em que o dom\u00ednio \u00e9 dividido. Neste trabalho, como na\n\nmaior parte da literatura, essas entidades s\u00e3o denominadas de elementos.\n\n9\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 10\n\nEmR3, os elementos s\u00e3o corpos poli\u00e9dricos, geralmente de forma simples,\nsendo os mais comuns os tetraedros e os hexaedros.\n\nCada entidade de uma malha \u00e9 limitada por entidades de dimens\u00e3o\n\nmenor. Assim, em malhas tridimensionais, os elementos encontram-se li-\n\nmitados por entidades de dimens\u00e3o 2, as quais recebem o nome de facetas.1\n\nAs facetas, por sua vez, s\u00e3o limitadas por entidades de dimens\u00e3o 1, as\n\narestas. Por fim, nas duas extremidades de uma aresta encontram-se os\n\nv\u00e9rtices, que s\u00e3o entidades de dimens\u00e3o 0. A figura 2.1 ilustra todas as\n\nentidades mencionadas, em uma por\u00e7\u00e3o de malha tridimensional.\n\nElemento\nAresta\n\nV\u00e9rtice\n\nFaceta\nFigura 2.1 \u2013 Entidades b\u00e1sicas em uma malha tridimensional.\n\nA seguir s\u00e3o formalizadas algumas defini\u00e7\u00f5es referidas \u00e0 malha com-\n\nputacional.\n\nDefini\u00e7\u00e3o 2.1. M \u00e9 uma malha do dom\u00ednio fechado ?, se satisfaz as se-\nguintes condi\u00e7\u00f5es [23]:\n\nC1: Todo elemento e de M possui um interior n\u00e3o-vazio.\nC2: A interse\u00e7\u00e3o do interior de dois elementos em M \u00e9 o\n\nconjunto vazio.\n\nC3: ?=\n?\n\ne?M e .\n\n1 Na literatura, o nome mais comum para essas entidades \u00e9 face, por\u00e9m, neste trabalho\nessa denomina\u00e7\u00e3o \u00e9 reservada para as entidades que limitam os volumes de controle, os quais\nser\u00e3o definidos mais adiante.\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 11\n\nDefini\u00e7\u00e3o 2.2. A conectividade de uma malha \u00e9 a defini\u00e7\u00e3o das conex\u00f5es\nentre seus v\u00e9rtices [23].\n\nDefini\u00e7\u00e3o 2.3. Uma malha n\u00e3o-estruturada \u00e9 uma malha cuja conectivi-\ndade \u00e9 irregular e, portanto, deve ser definida explicitamente.\n\nDiferentemente, a conectividade de uma malha estruturada pode es-\n\ntar definida de forma impl\u00edcita, por exemplo, por um mapeamento entre\n\nseus v\u00e9rtices e os elementos de uma matriz. Entretanto, tal mapeamento\n\nrequer uma organiza\u00e7\u00e3o r\u00edgida de elementos e v\u00e9rtices, o qual dificulta a\n\ngera\u00e7\u00e3o desse tipo de malhas em dom\u00ednios de geometria complexa. Ao\n\ncontr\u00e1rio, as malhas n\u00e3o-estruturadas possuem uma extraordin\u00e1ria flexi-\n\nbilidade geom\u00e9trica, uma vez que v\u00e9rtices e elementos podem estar dis-\n\ntribu\u00eddos de modo quase arbitr\u00e1rio. Devido a isso, a melhor alternativa\n\npara a discretiza\u00e7\u00e3o espacial de dom\u00ednios de geometria complexa s\u00e3o as\n\nmalhas n\u00e3o-estruturadas. A conveni\u00eancia deste tipo de malhas \u00e9 ainda\n\nmaior quando se requer solu\u00e7\u00f5es mais precisas em determinadas regi\u00f5es\n\ndo dom\u00ednio, pela facilidade de realizar refino localizado nessas regi\u00f5es.2\n\nDefini\u00e7\u00e3o 2.4. Uma malha mista ou h\u00edbrida \u00e9 uma malha que possui ele-\nmentos de diferente forma geom\u00e9trica.3\n\nAs malhas h\u00edbridas proporcionam um grau de flexibilidade adicional\n\nem rela\u00e7\u00e3o \u00e0s malhas n\u00e3o-estruturadas de um \u00fanico tipo de elemento. O\n\nobjetivo da utiliza\u00e7\u00e3o de malhas h\u00edbridas \u00e9 o melhor aproveitamento das\n\ncaracter\u00edsticas de cada tipo de elemento em diferentes regi\u00f5es do dom\u00ednio.\n\nEm aplica\u00e7\u00f5es de CFD em tr\u00eas dimens\u00f5es, as malhas n\u00e3o-estruturadas\n\nmais comuns s\u00e3o as malhas de tetraedros, principalmente porque os al-\n\ngoritmos de gera\u00e7\u00e3o desse tipo de malhas s\u00e3o mais robustos e sofisticados,\n\npermitindo discretizar virtualmente qualquer geometria de forma autom\u00e1-\n\ntica ou com pouca interven\u00e7\u00e3o do usu\u00e1rio [8, 57]. Entretanto, os elementos\nhexa\u00e9dricos produzem malhas mais compactas4 e apresentam caracte-\n\nr\u00edsticas geom\u00e9tricas mais favor\u00e1veis do ponto de vista num\u00e9rico, espe-\n\ncialmente quando \u00e9 necess\u00e1rio utilizar elementos com raz\u00e3o de aspecto\n\n2 Isto \u00e9, reduzir o tamanho m\u00e9dio dos elementos nessas regi\u00f5es do dom\u00ednio.\n3 Em alguns textos, a denomina\u00e7\u00e3o de malha h\u00edbrida \u00e9 atribu\u00edda a malhas mistas que\n\napresentam regi\u00f5es estruturadas e n\u00e3o-estruturadas [23, 73]. Entretanto, neste trabalho n\u00e3o\nser\u00e1 considerada essa distin\u00e7\u00e3o e as duas denomina\u00e7\u00f5es ser\u00e3o utilizadas como equivalentes.\n\n4 Mais compactas no sentido de possuir menos elementos para um dado n\u00famero de\nv\u00e9rtices. Dependendo do tipo de implementa\u00e7\u00e3o, isto pode gerar uma importante economia\nde recursos computacionais.\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 12\n\ngrande.5 Por\u00e9m, preencher um dom\u00ednio tridimensional arbitr\u00e1rio conside-\n\nrando apenas elementos hexa\u00e9dricos \u00e9 uma tarefa que envolve um enorme\n\ngrau de dificuldade. Nesse sentido, nenhum algoritmo desenvolvido para\n\ngera\u00e7\u00e3o de malhas de hexaedros se equipara aos algoritmos existentes para\n\ngera\u00e7\u00e3o de malhas tetra\u00e9dricas [15, 52, 57].\nA utiliza\u00e7\u00e3o conjunta de tetraedros e hexaedros em malhas h\u00edbridas\n\n\u00e9 uma alternativa promissora para a discretiza\u00e7\u00e3o de dom\u00ednios tridimen-\n\nsionais complexos. De uma forma geral, a ideia central para a constru\u00e7\u00e3o\n\ndessas malhas \u00e9 discretizar as regi\u00f5es mais importantes do dom\u00ednio com\n\nhexaedros, deixando os tetraedros para preencher as regi\u00f5es de geometria\n\nmais intrincada ou de menor import\u00e2ncia, ou, inclusive, as por\u00e7\u00f5es onde\n\nfor necess\u00e1rio considerar refino localizado. Contudo, a transi\u00e7\u00e3o entre\n\nhexaedros e tetraedros requer a introdu\u00e7\u00e3o de elementos adicionais, tais\n\ncomo prismas e pir\u00e2mides, a fim de garantir a conformidade da malha. A\n\nconformidade \u00e9 uma condi\u00e7\u00e3o necess\u00e1ria para v\u00e1rios m\u00e9todos num\u00e9ricos,\n\nentre eles o m\u00e9todo de volumes finitos baseado em elementos.\n\nDefini\u00e7\u00e3o 2.5. A malha M \u00e9 uma malha conforme se satisfaz as condi\u00e7\u00f5es\nda defini\u00e7\u00e3o 2.1, al\u00e9m da condi\u00e7\u00e3o:\n\nC4: A interse\u00e7\u00e3o de dois elementos em M \u00e9 o conjunto vazio,\num v\u00e9rtice, uma aresta ou uma faceta [23].\n\nA modo de ilustra\u00e7\u00e3o, a figura 2.2 apresenta alguns casos t\u00edpicos de\n\nn\u00e3o-conformidade, em que as condi\u00e7\u00f5es da defini\u00e7\u00e3o 2.5 n\u00e3o s\u00e3o satisfei-\n\ntas. Em todos esses casos, o procedimento de constru\u00e7\u00e3o dos volumes de\n\ncontrole em um m\u00e9todo de volumes finitos baseado em elementos pro-\n\nduz volumes an\u00f4malos, em que a superf\u00edcie de controle n\u00e3o \u00e9 fechada.\n\nPortanto, inclusive a ocorr\u00eancia de apenas uma \u00fanica situa\u00e7\u00e3o de n\u00e3o-\n\nconformidade na malha utilizada pode tornar inconsistente o modelo nu-\n\nm\u00e9rico obtido com o m\u00e9todo.\n\nComo mencionado anteriormente, malhas h\u00edbridas que compreen-\n\ndem apenas tetraedros e hexaedros n\u00e3o satisfazem as condi\u00e7\u00f5es de con-\n\nformidade. A situa\u00e7\u00e3o usual nesse caso \u00e9 como a mostrada na figura 2.2(d),\n\nem que a faceta quadrangular de um hexaedro coincide com as facetas\n\n5 Um exemplo tipico \u00e9 a discretiza\u00e7\u00e3o de reservat\u00f3rios de petr\u00f3leo, em que a dimens\u00e3o\nvertical \u00e9 geralmente muito menor que as outras dimens\u00f5es. Essa situa\u00e7\u00e3o obriga a utilizar\nelementos de raz\u00e3o de aspecto grande, a fim de manter reduzido o n\u00famero global de\nelementos da malha.\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 13\n\nSuperposi\u00e7\u00e3ode elementos Contatoparcial de facetas\n\nContatoparcial de arestas\nFaceta em contato commais de uma faceta\n\n(a)\n\n(d)\n\n(b)\n\n(c)\nFigura 2.2 \u2013 Exemplos de situa\u00e7\u00f5es que n\u00e3o satisfazem as condi\u00e7\u00f5es de\n\nconformidade.\n\ntriangulares de dois tetraedros vizinhos. Em uma malha conforme, a fa-\n\nceta de um elemento deve coincidir exatamente com a faceta de um ele-\n\nmento vizinho. Para isso ser poss\u00edvel em uma malha misturando hexaedros\n\ne tetraedros, devem ser utilizados elementos de transi\u00e7\u00e3o que possuam\n\ntanto facetas triangulares como quadrangulares. Os elementos mais sim-\n\nples com essa caracter\u00edstica geom\u00e9trica s\u00e3o a pir\u00e2mide de base quadrada e\n\no prisma de base triangular. A fim de garantir a conformidade, uma faceta\n\ntriangular desses elementos deve coincidir sempre com a faceta de um te-\n\ntraedro, enquanto que uma faceta quadrangular deve faz\u00ea-lo com a faceta\n\nde um hexaedro. A figura 2.3 ilustra exemplos de transi\u00e7\u00f5es conformes\n\nentre hexaedros e tetraedros.\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 14\n\nHexaedro\n\nHexaedro\n\nPir\u00e2mide\n\nPrisma\n\nTetraedro\n\nTetraedro\n\n(a)\n\n(b)\nFigura 2.3 \u2013 Exemplos de transi\u00e7\u00e3o conforme entre hexaedros e tetraedros.\n\n2.2 Especifica\u00e7\u00e3o de uma malha n\u00e3o-estruturada\n\nA constru\u00e7\u00e3o de uma malha a partir da geometria de um dom\u00ednio tridi-\n\nmensional \u00e9 uma opera\u00e7\u00e3o que envolve um alto n\u00edvel de complexidade.\n\nEssa tarefa \u00e9 realizada, em geral, por softwares especializados que execu-\n\ntam algoritmos sofisticados a fim de garantir que as malhas geradas aten-\n\ndam os requerimentos de uma dada formula\u00e7\u00e3o num\u00e9rica. Apesar de os\n\nprocedimentos de gera\u00e7\u00e3o de malha n\u00e3o serem abordados aqui, pois n\u00e3o \u00e9\n\no objeto do presente trabalho6, \u00e9 importante descrever, ainda que de ma-\n\n6 Diferentes m\u00e9todos e algoritmos para gera\u00e7\u00e3o de malhas n\u00e3o-estruturadas tridimensio-\nnais s\u00e3o descritos em detalhes, por exemplo, nas refer\u00eancias [23, 52, 57, 74, 75, 81]\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 15\n\nneira sucinta, a forma de especifica\u00e7\u00e3o das malhas n\u00e3o-estruturadas. Este\n\nconhecimento \u00e9 necess\u00e1rio para poder interpretar em um c\u00f3digo compu-\n\ntacional as malhas vindas de um software de gera\u00e7\u00e3o e tamb\u00e9m para esta-\n\nbelecer uma estrutura de dados adequada para manipul\u00e1-las no c\u00f3digo.\n\nExistem diversas alternativas para a especifica\u00e7\u00e3o de uma malha n\u00e3o-\n\nestruturada. Na maioria delas, o ponto de partida \u00e9 a especifica\u00e7\u00e3o dos\n\nv\u00e9rtices da malha, estabelecendo a localiza\u00e7\u00e3o de todos eles em rela\u00e7\u00e3o\n\na um sistema de coordenadas, usualmente cartesiano. Para uma iden-\n\ntifica\u00e7\u00e3o un\u00edvoca, a cada v\u00e9rtice deve estar associado um \u00edndice \u00fanico,\n\nestabelecendo-se dessa forma um esquema de numera\u00e7\u00e3o global para os\n\nv\u00e9rtices da malha, conforme ilustrado na figura 2.4 para um caso simples.\n\n1 2 3 4 5\n6 7 8 9\n\n10\n11\n\n12\n13\n\n14\n\n1516 18\n19\n\n20\n\n26\n\n21\n\n22\n\n23\n24 17\n\n25\nz\n\nx y Coordenadas dos v\u00e9rtices\n1 2,104 5,203 7,3052 1,596 7,002 8,3043 2,697 8,987 7,0124 3,003 9,345 6,232\n\nx y zV\u00e9rtice\n\nFigura 2.4 \u2013 Exemplo da especifica\u00e7\u00e3o dos v\u00e9rtices de uma malha.\n\nAs restantes entidades da malha podem ser definidas com base nos\n\nv\u00e9rtices j\u00e1 especificados. Neste ponto \u00e9 poss\u00edvel considerar diferentes pos-\n\nsibilidades. Por exemplo, pode ser empregada uma descri\u00e7\u00e3o hier\u00e1rquica\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 16\n\n[23] em que as arestas s\u00e3o especificadas com base nos v\u00e9rtices, as face-\ntas s\u00e3o especificadas com base nas arestas e, por fim, os elementos s\u00e3o\n\nespecificados com base nas facetas. Essa abordagem, na qual \u00e9 definido\n\num esquema de numera\u00e7\u00e3o global pr\u00f3prio para cada tipo de entidade da\n\nmalha, \u00e9 demasiado geral para a maioria dos m\u00e9todos num\u00e9ricos, em que\n\nn\u00e3o todas as entidades possuem a mesma import\u00e2ncia. Em m\u00e9todos em\n\nque a maioria das opera\u00e7\u00f5es \u00e9 realizada em n\u00edvel de elemento, como no\n\nm\u00e9todo cl\u00e1ssico de elementos finitos e tamb\u00e9m no m\u00e9todo de volumes fi-\n\nnitos baseado em elementos, \u00e9 suficiente a especifica\u00e7\u00e3o da conectividade\n\ndos elementos para completar a defini\u00e7\u00e3o de uma malha. Nessa aborda-\n\ngem, arestas e facetas ficam determinadas de forma impl\u00edcita e podem ser\n\nacessadas localmente em cada elemento, se necess\u00e1rio.\n\nA lista dos v\u00e9rtices associados a um dado elemento, ordenada segundo\n\nalgum esquema convencional, \u00e9 suficiente para definir a conectividade\n\ndesse elemento. Nessa lista, os v\u00e9rtices devem ser identificados mediante\n\nos \u00edndices globais especificados no passo pr\u00e9vio. Conforme ilustra a figura\n\n2.5, um \u00edndice pr\u00f3prio \u00e9 atribu\u00eddo tamb\u00e9m a cada elemento para poder\n\nidentific\u00e1-lo posteriormente. Al\u00e9m disso, nas malhas h\u00edbridas pode ser\n\nnecess\u00e1rio indicar explicitamente a forma geom\u00e9trica de cada elemento,\n\ncaso essa informa\u00e7\u00e3o n\u00e3o possa ser inferida a partir do n\u00famero de v\u00e9rtices\n\nespecificado para o elemento. A ordena\u00e7\u00e3o convencional dos v\u00e9rtices para\n\ntodos os tipos de elementos considerados neste trabalho \u00e9 indicada na\n\nse\u00e7\u00e3o seguinte.\n\nA lista de v\u00e9rtices especificada para definir a conectividade de um\n\nelemento determina de forma indireta um esquema numera\u00e7\u00e3o local para\n\nseus v\u00e9rtices. Assim, por exemplo, no elemento 1 da malha mostrada na\n\nfigura 2.5, o v\u00e9rtice com \u00edndice global 3 pode ser identificado localmente\n\ncomo v\u00e9rtice 1, o v\u00e9rtice 5 como v\u00e9rtice local 2, o v\u00e9rtice 21 como v\u00e9rtice\n\nlocal 3, e assim por diante. A especifica\u00e7\u00e3o da conectividade de um ele-\n\nmento pode ser vista tamb\u00e9m como a defini\u00e7\u00e3o de um esquema de conver-\n\ns\u00e3o global/local para a indexa\u00e7\u00e3o dos v\u00e9rtices. Essa convers\u00e3o possui um\npapel fundamental nos m\u00e9todos num\u00e9ricos baseados em elementos, pois\n\no resultado de muitas opera\u00e7\u00f5es que s\u00e3o realizadas em n\u00edvel de elemento\n\ndeve ser depois utilizado de forma global e vice-versa. Como ser\u00e1 visto\n\nna pr\u00f3xima se\u00e7\u00e3o, com base na numera\u00e7\u00e3o local dos v\u00e9rtices \u00e9 poss\u00edvel\n\ntamb\u00e9m fazer a descri\u00e7\u00e3o completa da topologia dos diferentes tipos de\n\nelementos.\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 17\n\n1119\n22\n\n1 3\n5\n\n6\n10\n\n13\n1821\n\n24\n\n2\n4\n\n7 8 9\n12\n\n14\n\n151620\n\n26\n\n23\n\nElemento 1 Elemento 2\n\nConectividade dos elementos\n17\n\n25\n\n1 3 5 21 17 6 1 24 252 13 10 5 18 - - - -3 5 3 17 21 16 - - -\n\nEleme\nnto\n\n1\u00ba v\u00e9rt\nice\n\n2\u00ba v\u00e9rt\nice\n\n3\u00ba v\u00e9rt\nice\n\n4\u00ba v\u00e9rt\nice\n\n5\u00ba v\u00e9rt\nice\n\n6\u00ba v\u00e9rt\nice\n\n7\u00ba v\u00e9rt\nice\n\n8\u00ba v\u00e9rt\nice\n\nz\nx y\n\nFigura 2.5 \u2013 Exemplo da especifica\u00e7\u00e3o dos elementos de uma malha.\n\n2.3 Topologia dos elementos\n\nA topologia de um elemento tridimensional pode ser completamente des-\n\ncrita em termos de suas facetas, arestas e v\u00e9rtices [23]. Por sua vez, as\nfacetas e arestas podem ser definidas com base nos v\u00e9rtices do elemento,\n\nordenados segundo algum esquema convencional. Consequentemente, a\n\ndescri\u00e7\u00e3o completa da topologia de um elemento pode ser realizada em\n\ntermos dos v\u00e9rtices, ap\u00f3s ser estabelecida a referida conven\u00e7\u00e3o para a or-\n\ndena\u00e7\u00e3o dessas entidades. Nesta se\u00e7\u00e3o \u00e9 descrita a topologia dos qua-\n\ntro tipos de elemento considerados neste trabalho: tetraedros, hexaedros,\n\nprismas e pir\u00e2mides. A descri\u00e7\u00e3o da topologia \u00e9 realizada com base na\n\nconven\u00e7\u00e3o usual para a ordena\u00e7\u00e3o de v\u00e9rtices em cada tipo de elemento.\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 18\n\n2.3.1 Tetraedro\n\nO tetraedro \u00e9 um elemento de quatro facetas triangulares, seis arestas e\n\nquatro v\u00e9rtices. Os v\u00e9rtices do tetraedro s\u00e3o numerados convencional-\n\nmente utilizando a regra da m\u00e3o direita [84]. O intuito \u00e9 garantir que\no volume do tetraedro, calculado mediante determinantes, seja sempre\n\npositivo. Para tanto, posiciona-se a m\u00e3o direita em uma faceta qualquer\n\ndo elemento com o polegar apontando para o v\u00e9rtice oposto. Numeram-\n\nse, ent\u00e3o, os v\u00e9rtices da faceta escolhida no sentido indicado pelos quatro\n\ndedos restantes, conforme ilustrado na figura 2.6. O \u00faltimo v\u00e9rtice a nu-\n\nmerar \u00e9 o v\u00e9rtice oposto \u00e0 faceta considerada.\n\n2\n3\n\n1\n\n4\n\nArestas\n1 1 22 2 33 3 14 1 45 2 46 3 4\n\nAresta 1\u00ba v\u00e9rt\nice\n\n2\u00ba v\u00e9rt\niceFacetas\n\n1 1 3 22 1 4 33 1 2 44 2 3 4\n\nFaceta 1\u00ba v\u00e9rt\nice\n\n2\u00ba v\u00e9rt\nice\n\n3\u00ba v\u00e9rt\nice\n\nFigura 2.6 \u2013 Topologia do tetraedro.\n\nNa figura 2.6 \u00e9 indicada tamb\u00e9m a defini\u00e7\u00e3o local de facetas e arestas,\n\nconforme a refer\u00eancia [23]. \u00c9 importante notar que impl\u00edcita nessa defi-\nni\u00e7\u00e3o encontra-se uma dada orienta\u00e7\u00e3o para essas entidades. Assim, as\n\narestas podem ser consideradas como segmentos dirigidos, com orienta-\n\n\u00e7\u00e3o do primeiro ao segundo v\u00e9rtice. De modo semelhante, na defini\u00e7\u00e3o\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 19\n\ndas facetas, a ordena\u00e7\u00e3o dos v\u00e9rtices determina um sentido de rota\u00e7\u00e3o\n\nque, pela regra da m\u00e3o direita, induz uma orienta\u00e7\u00e3o positiva apontando\n\nsempre para fora do elemento.\n\nComo \u00e9 l\u00f3gico, quando a conectividade de um elemento tetra\u00e9drico\n\nfor especificada, a ordena\u00e7\u00e3o dos v\u00e9rtices dever\u00e1 respeitar a conven\u00e7\u00e3o\n\nanteriormente citada. Deve-se notar, no entanto, que um mesmo ele-\n\nmento pode ser especificado de m\u00faltiplas formas equivalentes. Assim,\n\npor exemplo, se a conectividade de um dado elemento for especificada\n\npela lista de v\u00e9rtices (a , b , c , d), o mesmo elemento poder\u00e1 ser definido\ntamb\u00e9m pelas listas (b , c , a , d) e (c , a , b , d), as quais cumprem do mesmo\nmodo a regra da m\u00e3o direita. De fato, existem em total doze permuta\u00e7\u00f5es\n\nna lista de v\u00e9rtices de um tetraedro que satisfazem essa regra, todas sendo\n\nrepresenta\u00e7\u00f5es v\u00e1lidas da conectividade desse elemento.\n\n2.3.2 Hexaedro\n\nO hexaedro \u00e9 um elemento que possui seis facetas quadrangulares, doze\n\narestas e oito v\u00e9rtices. Ele \u00e9 topologicamente equivalente a um cubo, ape-\n\nsar de que, em um caso geral, suas facetas podem n\u00e3o ser planas. A figura\n\n2.7 ilustra a conven\u00e7\u00e3o para a numera\u00e7\u00e3o dos v\u00e9rtices de um hexaedro,\n\nassim como uma poss\u00edvel defini\u00e7\u00e3o de suas facetas e arestas com base nos\n\nv\u00e9rtices.\n\nA numera\u00e7\u00e3o dos v\u00e9rtices do hexaedro segue uma conven\u00e7\u00e3o seme-\n\nlhante \u00e0 descrita para o tetraedro. Primeiro s\u00e3o numerados os v\u00e9rtices de\n\numa faceta do elemento, seguindo o sentido de rota\u00e7\u00e3o positivo dado pela\n\nregra da m\u00e3o direita. Para tanto, posiciona-se a m\u00e3o direita sobre a faceta\n\nem quest\u00e3o, com o polegar apontando para a faceta oposta, como mostra\n\na figura 2.7. Seguidamente s\u00e3o numerados os v\u00e9rtices da faceta oposta,\n\ncome\u00e7ando pelo v\u00e9rtice oposto ao primeiro v\u00e9rtice da faceta j\u00e1 numerada\n\ne seguindo o mesmo sentido de rota\u00e7\u00e3o considerado nela.\n\nA especifica\u00e7\u00e3o da conectividade de um hexaedro deve levar em conta\n\na conven\u00e7\u00e3o descrita acima para a ordena\u00e7\u00e3o dos v\u00e9rtices. Caso contr\u00e1-\n\nrio, podem surgir ambiguidades, por exemplo, no c\u00e1lculo das grandezas\n\ngeom\u00e9tricas associadas ao elemento. Entretanto, igual que no caso do\n\ntetraedro, a especifica\u00e7\u00e3o de um hexaedro n\u00e3o \u00e9 \u00fanica, sendo que dife-\n\nrentes listas de v\u00e9rtices satisfazem o crit\u00e9rio de ordena\u00e7\u00e3o descrito e s\u00e3o,\n\nportanto, especifica\u00e7\u00f5es v\u00e1lidas para o elemento.\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 20\n\n2\n\n6\n4\n\n8\n\n3\n1\n\n5\n\nArestas\n1 1 22 2 33 3 44 4 15 5 66 6 77 7 88 8 59 1 510 2 611 3 712 4 8\n\nAresta 1\u00ba v\u00e9rt\nice\n\n2\u00ba v\u00e9rt\nice\n\nFacetas\n1 1 4 3 22 1 5 8 43 1 2 6 54 5 6 7 85 2 3 7 66 3 4 8 7\n\nFaceta 1\u00ba v\u00e9rt\nice\n\n2\u00ba v\u00e9rt\nice\n\n3\u00ba v\u00e9rt\nice\n\n4\u00ba v\u00e9rt\nice\n\n7\n\nFigura 2.7 \u2013 Topologia do hexaedro.\n\n2.3.3 Prisma\nO prisma triangular, ou simplesmente prisma, \u00e9 um elemento que pos-\n\nsui duas facetas triangulares opostas, separadas por tr\u00eas facetas de forma\n\nquadrangular. Al\u00e9m disso, o prisma possui nove arestas e seis v\u00e9rtices.\n\nApesar de existirem facetas de forma diferente, a configura\u00e7\u00e3o topol\u00f3gica\n\nem todos os v\u00e9rtices do prisma \u00e9 id\u00eantica.7 Isto \u00e9, em qualquer um dos seis\n\nv\u00e9rtices do prisma confluem tr\u00eas arestas e tr\u00eas facetas, das quais duas s\u00e3o\n\nsempre quadrangulares e uma triangular.\n\n7 No tetraedro e no hexaedro se produz tamb\u00e9m este tipo de simetria. Isso \u00e9 mais\nevidente nesses elementos pelo fato de todas as facetas serem tri\u00e2ngulos ou quadril\u00e1teros,\nrespectivamente.\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 21\n\nA figura 2.8 mostra a numera\u00e7\u00e3o convencional dos v\u00e9rtices do prisma,\n\nal\u00e9m da defini\u00e7\u00e3o das arestas e facetas em fun\u00e7\u00e3o da numera\u00e7\u00e3o local dos\n\nv\u00e9rtices. Para tal numera\u00e7\u00e3o, consideram-se inicialmente os v\u00e9rtices de\n\numa das facetas triangulares, os quais s\u00e3o numerados segundo o sentido\n\npositivo dado pela m\u00e3o direita, com o polegar apontando para a faceta\n\ntriangular oposta. Depois s\u00e3o numerados os v\u00e9rtices nessa faceta oposta,\n\nseguindo o mesmo sentido e come\u00e7ando no v\u00e9rtice oposto ao primeiro\n\nv\u00e9rtice numerado.\n\n2\n\n5\n3\n\n6\n1\n\n4\n\nArestas\n1 1 22 2 33 3 14 4 55 5 66 6 17 1 48 2 59 3 6\n\nAresta 1\u00ba v\u00e9rt\nice\n\n2\u00ba v\u00e9rt\nice\n\nFacetas\n1 1 3 2 -2 4 5 6 -3 1 4 6 34 1 2 5 45 2 3 6 5\n\nFaceta 1\u00ba v\u00e9rt\nice\n\n2\u00ba v\u00e9rt\nice\n\n3\u00ba v\u00e9rt\nice\n\n4\u00ba v\u00e9rt\nice\n\nFigura 2.8 \u2013 Topologia do prisma.\n\n2.3.4 Pir\u00e2mide\n\nO elemento piramidal considerado em malhas h\u00edbridas \u00e9 uma pir\u00e2mide\n\nde base quadrangular. Ele possui, portanto, cinco facetas, das quais qua-\n\ntro s\u00e3o triangulares e uma quadrangular. O n\u00famero de arestas \u00e9 oito e\n\no n\u00famero de v\u00e9rtices cinco. Nos quatro v\u00e9rtices da base quadrangular\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 22\n\nconvergem tr\u00eas arestas e tr\u00eas facetas. O v\u00e9rtice oposto \u00e0 base, por\u00e9m,\n\napresenta uma configura\u00e7\u00e3o topol\u00f3gica diferente, j\u00e1 que nele confluem\n\nquatro arestas e as quatro facetas triangulares da pir\u00e2mide. Esse v\u00e9rtice\n\n\u00e9 comumente chamado de \u00e1pice.\n\nO esquema de numera\u00e7\u00e3o considerado para os v\u00e9rtices da pir\u00e2mide \u00e9\n\nilustrado na figura 2.9. Sempre s\u00e3o numerados primeiro os v\u00e9rtices da base\n\nquadrangular, seguindo o sentido positivo da m\u00e3o direita com o polegar\n\napontando para o \u00e1pice. O \u00faltimo v\u00e9rtice a numerar \u00e9, precisamente, o\n\n\u00e1pice. A figura 2.9 apresenta tamb\u00e9m a defini\u00e7\u00e3o local das arestas e das\n\nfacetas da pir\u00e2mide.\n\n2\n41\n\n5\n\n3 Arestas\n1 1 22 2 33 3 44 4 15 1 56 2 57 3 58 4 5\n\nAresta 1\u00ba v\u00e9rt\nice\n\n2\u00ba v\u00e9rt\niceFacetas\n\n1 1 5 4 -2 1 2 5 -3 2 3 5 -4 3 4 5 -5 1 4 3 2\n\nFaceta 1\u00ba v\u00e9rt\nice\n\n2\u00ba v\u00e9rt\nice\n\n3\u00ba v\u00e9rt\nice\n\n4\u00ba v\u00e9rt\nice\n\nFigura 2.9 \u2013 Topologia da pir\u00e2mide.\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 23\n\n2.4 Entidades duais\nAs malhas e entidades descritas nas se\u00e7\u00f5es anteriores ser\u00e3o denominadas,\n\nneste trabalho, malhas prim\u00e1rias e entidades prim\u00e1rias, respectivamente.\n\nElas determinam a representa\u00e7\u00e3o discreta da regi\u00e3o do espa\u00e7o onde o pro-\n\nblema f\u00edsico a resolver est\u00e1 definido. \u00c9 poss\u00edvel associar, entretanto, uma\n\nentidade dual a cada entidade prim\u00e1ria. A uni\u00e3o das entidades duais forma\n\na que ser\u00e1 denominada de malha dual, a qual pode ser considerada como\n\numa parti\u00e7\u00e3o alterna do dom\u00ednio de solu\u00e7\u00e3o. As entidades duais t\u00eam um\n\npapel fundamental em um m\u00e9todo de volumes finitos baseado em ele-\n\nmentos, pois os volumes de controle, com base nos quais s\u00e3o constru\u00eddas\n\nas equa\u00e7\u00f5es em n\u00edvel discreto, s\u00e3o formadas por entidades duais, como se\n\nver\u00e1 mais adiante.\n\nA primeira entidade dual que pode ser definida \u00e9 a entidade dual do\n\nelemento, que \u00e9 um ponto interior a ele. Tal ponto \u00e9 localizado conven-\n\ncionalmente no baricentro dos v\u00e9rtices do elemento. Embora se trate de\n\numa escolha aparentemente arbitr\u00e1ria, essa localiza\u00e7\u00e3o possui v\u00e1rias van-\n\ntagens, conforme ser\u00e1 discutido posteriormente. Quanto \u00e0s restantes en-\n\ntidades duais, elas podem ser definidas primeiro em n\u00edvel de elemento e\n\ndepois generalizadas mediante composi\u00e7\u00e3o.\n\nUma entidade dual pode ser definida considerando entidades duais\n\nde menor dimens\u00e3o, estabelecendo-se dessa forma uma estrutura hier\u00e1r-\n\nquica semelhante \u00e0 das entidades prim\u00e1rias. Assim, em um elemento, a\n\nentidade dual de uma faceta \u00e9 um segmento unindo a entidade dual do\n\nelemento com um ponto sobre a faceta. Por sua vez, a entidade dual de\n\numa aresta \u00e9 um pol\u00edgono limitado pelas entidades duais das facetas adja-\n\ncentes \u00e0 aresta mais dois segmentos constru\u00eddos sobre essas facetas. Neste\n\ntrabalho, as entidades duais das arestas, definidas em n\u00edvel de elemento,\n\ns\u00e3o denominadas de faces. Finalmente, a entidade dual de um v\u00e9rtice \u00e9 um\n\npoliedro limitado por certo n\u00famero de faces e pol\u00edgonos constru\u00eddos sobre\n\nas facetas adjacentes ao v\u00e9rtice. Essa entidade dual \u00e9 denominada aqui de\n\nsubelemento. A forma de constru\u00e7\u00e3o das entidades duais ser\u00e1 abordada\n\ncom maiores detalhes nas subse\u00e7\u00f5es seguintes.\n\nA figura 2.10 mostra de forma esquem\u00e1tica as estruturas hier\u00e1rquicas\n\ndas entidades prim\u00e1rias e duais em n\u00edvel de elemento. Algumas caracte-\n\nr\u00edsticas importantes devem ser ressaltadas. Em primeiro lugar, se d = k \u00e9\na dimens\u00e3o de uma dada entidade prim\u00e1ria, a dimens\u00e3o da entidade dual\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 24\n\nEntidades prim\u00e1rias Entidades duais\n\nSubelemento (d = 3)V\u00e9rtice (d = 0)\n\nElemento (d = 3) Baricentro (d = 0)\n\nAresta (d = 1)\nFace (d = 2)\n\nFaceta (d = 2) Segmento (d = 1)\n\nFigura 2.10 \u2013 Entidades prim\u00e1rias e entidades duais em n\u00edvel de elemento.\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 25\n\ncorrespondente \u00e9 d = 3?k . Esta particularidade n\u00e3o \u00e9 casual, j\u00e1 que deriva\nde uma propriedade dos complexos celulares estudados na topologia al-\n\ng\u00e9brica,8 dos quais as malhas aqui consideradas s\u00e3o casos particulares\n\n[51, 76]. Outro aspecto a destacar \u00e9 a correspond\u00eancia de um para um\nentre uma entidade prim\u00e1ria e uma entidade dual. Isto implica que, na\n\npr\u00e1tica, para identificar uma entidade dual pode ser utilizado o \u00edndice da\n\nentidade prim\u00e1ria correspondente e vice-versa.\n\n2.4.1 Constru\u00e7\u00e3o das faces\n\nO processo de constru\u00e7\u00e3o geom\u00e9trica das faces \u00e9 id\u00eantico em todos os\n\nelementos considerados, exceto na pir\u00e2mide, a qual possui algumas par-\n\nticularidades comentadas mais adiante. Como mostra a figura 2.11, no\n\ntetraedro, no hexaedro e no prisma as faces s\u00e3o quadril\u00e1teros, determina-\n\ndos por quatro pontos, denotados por M, R, C e L. Desses quatro pontos,\n\no ponto C, \u00fanico interior ao elemento, \u00e9 comum a todas as faces. Esse\n\nponto trata-se, em realidade, da anteriormente referida entidade dual do\n\nelemento que, convencionalmente, \u00e9 localizada no baricentro dos seus\n\nv\u00e9rtices. A posi\u00e7\u00e3o desse ponto, portanto, \u00e9 dada pelo vetor 9\n\nr\nC\n=\n\n1\n\nNv\n\nNv\n?\n\nk=1\n\nr?k , (2.1)\n\nem que Nv \u00e9 o n\u00famero de v\u00e9rtices do elemento e r?k (k = 1, . . . , Nv) \u00e9 o vetor\nposi\u00e7\u00e3o de cada um desses v\u00e9rtices.\n\nA equa\u00e7\u00e3o (2.1) mostra a conveni\u00eancia de localizar o ponto C no bari-\n\ncentro dos v\u00e9rtices do elemento. Como se pode observar, a posi\u00e7\u00e3o desse\n\nponto est\u00e1 influenciada exatamente da mesma forma pela posi\u00e7\u00e3o de to-\n\ndos os v\u00e9rtices do elemento. Isto torna tal posi\u00e7\u00e3o invariante em rela-\n\n\u00e7\u00e3o \u00e0 numera\u00e7\u00e3o desses v\u00e9rtices. Lembre-se que, na especifica\u00e7\u00e3o da co-\n\nnectividade de um elemento, diferentes permuta\u00e7\u00f5es na lista de v\u00e9rtices\n\ndeterminam um mesmo elemento. Ora, se a posi\u00e7\u00e3o do ponto C fosse\n\ndada por uma express\u00e3o em que a posi\u00e7\u00e3o de cada v\u00e9rtice tivesse uma\n\n8 A topologia alg\u00e9brica \u00e9 uma parte da matem\u00e1tica que estuda as propriedades topol\u00f3gicas\ndos espa\u00e7os associando-os com estruturas alg\u00e9bricas apropriadas [51]. Muitos conceitos\ne resultados desta disciplina podem ser aplicados para a sistematiza\u00e7\u00e3o do tratamento de\nmalhas computacionais [7].\n\n9 Note-se que o ponto C \u00e9 localizado no baricentro dos v\u00e9rtices do elemento e n\u00e3o no\nbaricentro do pr\u00f3prio elemento. Apenas no tetraedro ambos os pontos coincidem sempre.\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 26\n\npondera\u00e7\u00e3o diferente, para cada permuta\u00e7\u00e3o na lista de v\u00e9rtices ter-se-\n\nria uma posi\u00e7\u00e3o diferente para tal ponto. Esta situa\u00e7\u00e3o seria altamente\n\ninconveniente, pois se tratando de um mesmo elemento, o ponto C deveria\n\nter a mesma posi\u00e7\u00e3o em todos os casos.\n\n(a) (b)\n\n(c)\n\nM Ponto m\u00e9dio da arestaL, R Baricentros dos v\u00e9rtices associados \u00e0s facetasadjacentes \u00e0 arestaC Baricentro dos v\u00e9rtices do elemento\n\nC\n\nC\n\nC\nM\n\nM\n\nM\nL\n\nL\n\nL\nR\n\nR\n\nR\n\nFigura 2.11 \u2013 Constru\u00e7\u00e3o das faces no tetraedro, no hexaedro e no prisma.\n\nNo mais, o ponto M \u00e9 um ponto localizado sobre a aresta da qual\n\na face em quest\u00e3o \u00e9 a entidade dual. Al\u00e9m disso, os pontos R e L s\u00e3o\n\npontos localizados sobre as facetas adjacentes a essa aresta. Pelos mesmos\n\nargumentos expostos no caso do ponto C, os pontos R e L s\u00e3o localizados\n\nconvencionalmente nos baricentros das respectivas facetas. Mais preci-\n\nsamente, s\u00e3o localizados nos baricentros dos v\u00e9rtices associados a essas\n\nfacetas, cuja posi\u00e7\u00e3o \u00e9 determinada por express\u00f5es an\u00e1logas \u00e0 equa\u00e7\u00e3o\n\n(2.1). De forma equivalente, o ponto M \u00e9 considerado coincidente com o\n\nponto m\u00e9dio da aresta em quest\u00e3o.\n\nA forma de constru\u00e7\u00e3o geom\u00e9trica descrita, denominada baric\u00eantrica\n\n[77], garante que as faces resultantes ser\u00e3o quadril\u00e1teros planos, se todas\nas facetas quadrilaterais do elemento tamb\u00e9m forem planas. No tetraedro,\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 27\n\no qual possui somente facetas triangulares, as faces resultantes sempre s\u00e3o\n\nplanas. Entretanto, se o mesmo esquema de constru\u00e7\u00e3o fosse empregado\n\ntamb\u00e9m na pir\u00e2mide, algumas das faces resultantes n\u00e3o seriam planas,\n\nmesmo se a base do elemento fosse plana [58]. Ainda que tal situa\u00e7\u00e3o\nn\u00e3o seja t\u00e3o s\u00e9ria do ponto de vista num\u00e9rico,10 neste trabalho preferiu-\n\nse adotar um esquema de constru\u00e7\u00e3o modificado.\n\nNesse esquema, o ponto comum a todas as faces \u00e9 o ponto B, locali-\n\nzado no baricentro dos v\u00e9rtices da base da pir\u00e2mide. Com essa varia\u00e7\u00e3o\n\ngarante-se que todas as faces em uma pir\u00e2mide de base quadrada ser\u00e3o\n\nplanas. Conforme ser\u00e1 visto no cap\u00edtulo 3, uma pir\u00e2mide qualquer pode\n\nser mapeada em um pir\u00e2mide de base quadrada, mediante uma transfor-\n\nma\u00e7\u00e3o de coordenadas adequada. A figura 2.12(a) ilustra a constru\u00e7\u00e3o das\n\nfaces adjacentes \u00e0s arestas que convergem no \u00e1pice da pir\u00e2mide. Essas\n\nfaces encontram-se determinadas pelos pontos M, R, B e L, os quais, com\n\nexce\u00e7\u00e3o do ponto B, est\u00e3o definidos da forma j\u00e1 descrita para os outros\n\nelementos. As quatro faces restantes, aquelas adjacentes \u00e0s arestas que\n\nlimitam a base da pir\u00e2mide, resultam faces triangulares. Conforme mos-\n\ntrado na figura 2.12(b), cada uma dessas faces est\u00e1 determinada pelo ponto\n\nM, o ponto m\u00e9dio da aresta adjacente, o ponto B, o baricentro dos v\u00e9rtices\n\nda base, e o ponto L, que \u00e9 o baricentro dos v\u00e9rtices da faceta triangular\n\ncont\u00edgua.\n\n(a) (b)\nB\n\nM L\nR BM\n\nL\n\nFigura 2.12 \u2013 Constru\u00e7\u00e3o das faces no elemento piramidal.\n\n10 Nas faces devem ser aproximadas integrais de superf\u00edcie e mesmo em faces quadran-\ngulares n\u00e3o-planas \u00e9 poss\u00edvel realizar essa aproxima\u00e7\u00e3o de forma consistente, conforme \u00e9\nmostrado no ap\u00eandice A.\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 28\n\n2.4.2 Constru\u00e7\u00e3o dos subelementos\n\nO conjunto das faces em um elemento gera uma subdivis\u00e3o deste em certo\n\nn\u00famero de por\u00e7\u00f5es. Cada uma dessas por\u00e7\u00f5es \u00e9 o que neste trabalho \u00e9\n\nchamado de subelemento.11 Como mencionado anteriormente, os subele-\n\nmentos podem ser considerados entidades duais dos v\u00e9rtices do elemento.\n\nExiste, portanto, uma correspond\u00eancia biun\u00edvoca entre v\u00e9rtices e subele-\n\nmentos, de forma equivalente \u00e0 correspond\u00eancia entre arestas e faces.\n\nAs figuras 2.13, 2.14, 2.15 e 2.16 ilustram a subdivis\u00e3o do tetraedro,\n\ndo hexaedro, do prisma e da pir\u00e2mide, respectivamente. Pode-se obser-\n\nvar que as faces subdividem tamb\u00e9m as facetas dos elementos em tr\u00eas ou\n\nquatro por\u00e7\u00f5es quadrilaterais. Se as facetas dos elementos tridimensio-\n\nnais fossem interpretadas como elementos bidimensionais, essas por\u00e7\u00f5es\n\nseriam subelementos bidimensionais. Em rela\u00e7\u00e3o \u00e0 malha tridimensional,\n\npor\u00e9m, esses subelementos podem ser interpretados como faces externas.\n\nEssas entidades s\u00e3o \u00fateis na discretiza\u00e7\u00e3o dual do contorno dos dom\u00ednios\n\ntridimensionais, conforme se ver\u00e1 na se\u00e7\u00e3o 2.5.\n\n(a)\n(b)\n\nFigura 2.13 \u2013 (a) As seis faces e (b) os quatro subelementos no tetraedro.\n\nTodos os subelementos, exceto aquele associado ao \u00e1pice da pir\u00e2mide,\n\nencontram-se limitados por tr\u00eas faces e tr\u00eas das faces externas antes ci-\n\ntadas. Tratam-se de corpos hexa\u00e9dricos, que possuem, al\u00e9m disso, uma\n\n11 O nome subvolume de controle [45, 67] \u00e9 tamb\u00e9m utilizado para essa entidade.\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 29\n\n(a)\n(b)\n\nFigura 2.14 \u2013 (a) As doze faces e (b) os oito subelementos no hexaedro.\n\npropriedade adicional. No espa\u00e7o transformado associado a cada tipo de\n\nelemento,12 os subelementos possuem o mesmo volume. Com a divis\u00e3o\n\nbaric\u00eantrica gera-se, portanto, a distribui\u00e7\u00e3o mais equilibrada poss\u00edvel do\n\nvolume de um elemento. A exce\u00e7\u00e3o novamente \u00e9 a pir\u00e2mide, na qual o\n\nsubelemento adjacente ao \u00e1pice, al\u00e9m de ser de forma octa\u00e9drica, possui\n\num volume maior que os restantes subelementos no correspondente es-\n\npa\u00e7o transformado.\n\n2.4.3 Entidades duais compostas\n\nAs entidades duais definidas em n\u00edvel de elemento podem ser reunidas\n\npara formar entidades duais compostas. Assim, a entidade dual composta\n\nde um v\u00e9rtice da malha \u00e9 a reuni\u00e3o dos subelementos associados ao v\u00e9r-\n\ntice, em todos os elementos que o compartilham. Uma vez que, nos m\u00e9to-\n\ndos de volumes finitos baseado em elementos, as equa\u00e7\u00f5es de conserva\u00e7\u00e3o\n\ns\u00e3o integradas nessas entidades compostas, elas s\u00e3o denominadas volu-\n\nmes de controle, seguindo a nomenclatura cl\u00e1ssica do m\u00e9todo de volumes\n\nfinitos.\n\n12 Em cada tipo de elemento \u00e9 considerada uma transforma\u00e7\u00e3o local de coordenadas que\nauxilia em algumas aproxima\u00e7\u00f5es num\u00e9ricas. Essa transforma\u00e7\u00e3o de coordenadas \u00e9 descrita\nna se\u00e7\u00e3o 3.3.\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 30\n\n(a)\n(b)\n\nFigura 2.15 \u2013 (a) As nove faces e (b) os seis subelementos no prisma.\n\n(a)\n(b)\n\nFigura 2.16 \u2013 (a) As oito faces e (b) os cinco subelementos na pir\u00e2mide.\n\nComo ilustra\u00e7\u00e3o, a figura 2.17 apresenta um volume de controle em\n\numa malha mista. Nesse exemplo espec\u00edfico, elementos das quatro formas\n\nconsideradas contribuem na forma\u00e7\u00e3o do volume mostrado. O volume de\n\ncontrole resultante da uni\u00e3o de subelementos \u00e9 um corpo poli\u00e9drico, em\n\ngeral, bastante irregular. Sua forma depende da configura\u00e7\u00e3o espec\u00edfica da\n\nmalha prim\u00e1ria em torno ao v\u00e9rtice interior. Quanto maior for o n\u00famero\n\nde elementos que confluam nesse v\u00e9rtice, mais complexa ser\u00e1 a forma do\n\nvolume. Por constru\u00e7\u00e3o, no interior de cada volume de controle existe um\n\nv\u00e9rtice da malha, conforme mostra a figura 2.18. O volume de controle \u00e9,\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 31\n\nprecisamente, a entidade dual composta do v\u00e9rtice interior. Tal caracter\u00eds-\n\ntica permite que, em um m\u00e9todo num\u00e9rico que considere essas entidades,\n\no volume de controle seja identificado pelo mesmo \u00edndice global do v\u00e9rtice\n\ninterior.\n\nVolume decontroleMalhaprim\u00e1ria\n\nFigura 2.17 \u2013 Volume de controle em uma malha tridimensional mista.\n\nOs esquemas de constru\u00e7\u00e3o geom\u00e9trica das entidades duais, descritos\n\nao longo desta se\u00e7\u00e3o, d\u00e3o origem a volumes de controle que preenchem o\n\nmesmo espa\u00e7o tridimensional que a malha prim\u00e1ria, sem se superpor ou\n\ndeixar vazios. Em conjunto, os volumes de controle e as restantes enti-\n\ndades duais formam uma malha alternativa para o dom\u00ednio discretizado\n\npela malha prim\u00e1ria. Trata-se de uma malha, em geral, de geometria mais\n\ncomplexa que a malha original, pelo fato dos volumes de controle serem\n\ncorpos poli\u00e9dricos usualmente mais irregulares que os elementos prim\u00e1-\n\nrios. Apesar dessa maior complexidade e das in\u00fameras formas que os\n\nvolumes de controle podem adquirir, sua manipula\u00e7\u00e3o \u00e9 facilitada pelo\n\nfato de estarem formados por componentes de geometria simples e bem\n\ndeterminada.\n\nEssa \u00e9, precisamente, uma das caracter\u00edsticas fundamentais de um\n\nm\u00e9todo de volumes finitos baseado em elementos. Em vez de se lidar\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 32\n\nV\u00e9rtice central\n\nFigura 2.18 \u2013 Corte de um volume de controle, mostrando o v\u00e9rtice central.\n\ndiretamente com os volumes e superf\u00edcies de controle, opera-se com suas\n\nentidades componentes em n\u00edvel de elemento. Como se viu nas subse\u00e7\u00f5es\n\npr\u00e9vias, o n\u00famero de formas poss\u00edveis para essas entidades, os subelemen-\n\ntos e as faces, \u00e9 bastante reduzido. Isto torna sua manipula\u00e7\u00e3o em um\n\nc\u00f3digo computacional extremamente simples. Equa\u00e7\u00f5es e outros entes\n\nmatem\u00e1ticos associados aos volumes de controle s\u00e3o obtidos seguindo o\n\nmesmo processo de constru\u00e7\u00e3o destes, isto \u00e9, mediante composi\u00e7\u00e3o das\n\ncontribui\u00e7\u00f5es associadas \u00e0s entidades componentes em n\u00edvel de elemento.\n\nDe resto, podem ser associadas tamb\u00e9m entidades duais compostas \u00e0s\n\narestas e facetas da malha prim\u00e1ria. Assim, reunindo as faces associadas\n\na uma aresta em todos os elementos que a compartilham, obt\u00e9m-se uma\n\nface composta. Por outro lado, unindo os dois segmentos duais a uma fa-\n\nceta, correspondentes aos dois elementos adjacentes, obt\u00e9m-se a entidade\n\ndual composta dessa faceta. A figura 2.19 ilustra esquematicamente essas\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 33\n\nentidades compostas. Elas s\u00e3o mencionadas aqui por quest\u00f5es de com-\n\npleteza, j\u00e1 que n\u00e3o cumprem um papel importante no m\u00e9todo abordado\n\nneste trabalho. A superf\u00edcie de controle, a qual limita um volume de con-\n\ntrole, poderia ser considerada como a uni\u00e3o de faces compostas. Por\u00e9m,\n\nna maioria dos casos \u00e9 mais conveniente considerar que tal superf\u00edcie est\u00e1\n\nformada diretamente por faces simples.\n\nV\u00e9rtice (d = 0)\n\nEntidades prim\u00e1rias Entidades duais\n\nVolume decontrole (d = 3)\n\nFacecomposta(d = 2)\n\nSegmentocomposto(d = 1)\n\nAresta (d = 1)\n\nFaceta (d = 2)\nFigura 2.19 \u2013 Entidades prim\u00e1rias e entidades duais compostas.\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 34\n\n2.5 Malhas de contorno\nA especifica\u00e7\u00e3o completa de um problema deve incluir informa\u00e7\u00e3o acerca\n\nda solu\u00e7\u00e3o nas fronteiras do dom\u00ednio de solu\u00e7\u00e3o, mediante as condi\u00e7\u00f5es de\n\ncontorno. A fim de incluir essas condi\u00e7\u00f5es no problema discretizado, pode\n\nser necess\u00e1ria a exist\u00eancia de uma representa\u00e7\u00e3o discreta dos contornos\n\nnos quais elas s\u00e3o especificadas. A forma mais direta para tal representa-\n\n\u00e7\u00e3o \u00e9 aquela integrada pelas facetas coincidentes com os contornos. Pode-\n\nse considerar que essas facetas s\u00e3o elementos bidimensionais que formam\n\numa malha superficial para cada contorno do dom\u00ednio de solu\u00e7\u00e3o. Tais\n\nelementos ser\u00e3o denominados aqui elementos de contorno e a malha que\n\nformam malha de contorno. Para o tipo de discretiza\u00e7\u00e3o considerado neste\n\ntrabalho, os elementos de contorno s\u00e3o tri\u00e2ngulos e/ou quadril\u00e1teros.\nUma vez que os elementos de contorno coincidem com as facetas\n\nda malha volum\u00e9trica, para especificar uma malha de contorno pode ser\n\nempregada uma forma compacta como a mostrada na figura 2.20. Nela,\n\nespecificam-se em uma lista os elementos volum\u00e9tricos adjacentes e as\n\nz\nx y\n\n1 33 22 71 13 19 1\n\nEleme\nnto\n\n de con\ntorno Eleme\nnto \n\nvolum\n\u00e9trico Faceta\n\nMalha de contorno\n\nEspecifica\u00e7\u00e3o da malha de contorno\n\nElementovolum\u00e9trico\n\nFaceta\n\nFigura 2.20 \u2013 Exemplo da especifica\u00e7\u00e3o de uma malha de contorno.\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 35\n\nfacetas nesses elementos que coincidem com o contorno. Para tanto pode-\n\nse empregar a numera\u00e7\u00e3o global dos elementos, definida na especifica\u00e7\u00e3o\n\nda conectividade da malha volum\u00e9trica, junto com a numera\u00e7\u00e3o local das\n\nfacetas em cada elemento.\n\nCom ajuda da conectividade dos elementos da malha volum\u00e9trica \u00e9\n\nposs\u00edvel determinar de forma indireta toda a informa\u00e7\u00e3o relativa a uma\n\nmalha de contorno associada. Assim, por exemplo, \u00e9 poss\u00edvel estabelecer\n\nquais s\u00e3o o os v\u00e9rtices localizados sobre o contorno e tamb\u00e9m todas as\n\nrela\u00e7\u00f5es de vizinhan\u00e7a entre entidades de contorno e volum\u00e9tricas. Entre-\n\ntanto, em algumas situa\u00e7\u00f5es particulares, para implementar uma condi\u00e7\u00e3o\n\nde contorno pode-se precisar apenas uma lista dos v\u00e9rtices pertencentes\n\nao contorno. Nesse caso pode-se dispensar a especifica\u00e7\u00e3o completa de\n\numa malha de contorno e especificar apenas tal lista.\n\nConforme visto na se\u00e7\u00e3o 2.4.2, a subdivis\u00e3o de um elemento volu-\n\nm\u00e9trico em subelementos estabelece simultaneamente uma parti\u00e7\u00e3o das\n\nfacetas do elemento. Isso implica tamb\u00e9m uma parti\u00e7\u00e3o dos elementos de\n\ncontorno, j\u00e1 que coincidem com as facetas da malha volum\u00e9trica. Como\n\nmostra a figura 2.21, essa parti\u00e7\u00e3o \u00e9 realizada por segmentos que unem o\n\nbaricentro dos v\u00e9rtices do elemento (C) com os pontos m\u00e9dios das suas\n\narestas (M).13 Produto da subdivis\u00e3o, resultam tr\u00eas pol\u00edgonos no tri\u00e2ngulo\n\ne quatro pol\u00edgonos no quadril\u00e1tero. Esses pol\u00edgonos s\u00e3o chamados aqui\n\nC M\n\nC M\nFaces de contorno\n\n(a)\n\n(b)\nFigura 2.21 \u2013 Subdivis\u00e3o dos elementos de contorno.\n\n13 Trata-se de uma subdivis\u00e3o baric\u00eantrica para elementos bidimensionais, equivalente \u00e0\ndescrita na se\u00e7\u00e3o 2.4.2 para elementos tridimensionais.\n\n\n\nA SPECTO S G EO M \u00c9T R ICO S DA DI SCR ET I Z A\u00c7 \u00c3O 36\n\nfaces de contorno e podem ser interpretados como as entidades duais dos\n\nv\u00e9rtices em n\u00edvel de elementos de contorno.\n\nAs faces de contorno fecham as superf\u00edcies de controle dos volumes\n\nadjacentes aos contornos, como ilustra a figura 2.22. Conforme se observa\n\nnessa figura, uma caracter\u00edstica adicional desses volumes de controle \u00e9 que\n\no v\u00e9rtice associado encontra-se situado sobre o contorno. Diferentemente,\n\nnos volumes internos o v\u00e9rtice associado sempre \u00e9 localizado no interior\n\ndos volumes.\n\nMalha de contorno\n\nMalha volum\u00e9trica\n\nFace de contorno\n\nFigura 2.22 \u2013 Volume de controle adjacente a um contorno.\n\n\n\nCAP\u00cdTULO\n\n3\nAspectos num\u00e9ricos b\u00e1sicos\n\n3.1 Caracter\u00edsticas gerais de um m\u00e9todo de volumes\nfinitos baseado em elementos\n\nUm m\u00e9todo de volumes finitos se caracteriza pela aplica\u00e7\u00e3o de equa\u00e7\u00f5es\n\nintegrais de conserva\u00e7\u00e3o a volumes de controle discretos. Em um m\u00e9todo\n\nde volumes finitos baseado em elementos, os volumes de controle s\u00e3o\n\nas entidades duais dos v\u00e9rtices da malha prim\u00e1ria de elementos. Como\n\nvisto no cap\u00edtulo anterior, essas entidades preenchem completamente o\n\ndom\u00ednio de solu\u00e7\u00e3o determinado pela malha prim\u00e1ria, sem deixar espa\u00e7os\n\nvazios ou se superpor. Al\u00e9m de satisfazer esse requisito b\u00e1sico dos m\u00e9todos\n\nde volumes finitos [20], por constru\u00e7\u00e3o, as interfaces entre volumes de\ncontrole s\u00e3o pol\u00edgonos localizados no interior dos elementos da malha\n\nprim\u00e1ria. Isto permite que os fluxos que atravessam essas interfaces se-\n\njam determinados mediante aproxima\u00e7\u00f5es locais da varia\u00e7\u00e3o da vari\u00e1veis\n\nem cada elemento. De fato, praticamente todas as opera\u00e7\u00f5es necess\u00e1rias\n\nno processo de constru\u00e7\u00e3o das equa\u00e7\u00f5es discretas pode ser realizado em\n\nn\u00edvel de elemento. Depois, mediante um procedimento de montagem se-\n\nmelhante ao empregado ordinariamente no m\u00e9todo de elementos finitos,\n\nobt\u00eam-se as equa\u00e7\u00f5es de balan\u00e7o referidas aos volumes de controle.\n\n37\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 38\n\nEm um m\u00e9todo de volumes finitos baseado em elementos, a represen-\n\nta\u00e7\u00e3o discreta de uma vari\u00e1vel em um dado n\u00edvel de tempo \u00e9 um conjunto\n\nde valores, cada um dos quais encontra-se associado a um v\u00e9rtice da malha\n\nprim\u00e1ria. Seguindo a nomenclatura tradicional, os pontos onde valores\n\ndas vari\u00e1veis s\u00e3o aproximados s\u00e3o denominados n\u00f3s. No tipo de m\u00e9todo\n\ndescrito neste trabalho, portanto, os n\u00f3s est\u00e3o localizados nos v\u00e9rtices da\n\nmalha de elementos. Devido \u00e0 dualidade entre v\u00e9rtices e volumes de con-\n\ntrole, o n\u00famero de n\u00f3s e o n\u00famero de volumes de controle em uma malha\n\nconforme sempre ser\u00e1 o mesmo. Uma vez que as equa\u00e7\u00f5es discretas s\u00e3o\n\nreferidas aos volumes de controle e os valores discretos de uma vari\u00e1vel s\u00e3o\n\nreferidos aos n\u00f3s, o produto da discretiza\u00e7\u00e3o de uma equa\u00e7\u00e3o diferencial\n\nem uma vari\u00e1vel \u00e9 sempre um sistema fechado de equa\u00e7\u00f5es alg\u00e9bricas.\n\nIsto \u00e9, um sistema no qual o n\u00famero de equa\u00e7\u00f5es \u00e9 igual ao n\u00famero de\n\ninc\u00f3gnitas. Modelos de v\u00e1rias equa\u00e7\u00f5es diferenciais em v\u00e1rias vari\u00e1veis\n\nnormalmente conduzem tamb\u00e9m a sistemas fechados de equa\u00e7\u00f5es.\n\nAs caracter\u00edsticas b\u00e1sicas de um m\u00e9todo de volumes finitos baseado\n\nem elementos, citadas acima, encontram-se ilustradas esquematicamente\n\nna figura 3.1. Quanto \u00e0 aproxima\u00e7\u00e3o local das vari\u00e1veis em fun\u00e7\u00e3o dos\n\nvalores nodais em um elemento, diversas alternativas podem ser conside-\n\nradas. Em princ\u00edpio, n\u00e3o existe impedimento para a utiliza\u00e7\u00e3o de diferen-\n\ntes tipos de aproxima\u00e7\u00f5es na discretiza\u00e7\u00e3o dos diferentes termos de uma\n\nequa\u00e7\u00e3o de conserva\u00e7\u00e3o. Assim, por exemplo, nos temos de trasporte ad-\n\nvectivo \u00e9 poss\u00edvel utilizar aproxima\u00e7\u00f5es do tipo upwind, que representam\n\nde forma adequada esse tipo de transporte.\n\nEm geral, a aproxima\u00e7\u00e3o num\u00e9rica do gradiente de uma vari\u00e1vel, ne-\n\ncess\u00e1ria na discretiza\u00e7\u00e3o dos termos de transporte difusivo, \u00e9 uma das\n\nopera\u00e7\u00f5es mais laboriosas em um m\u00e9todo num\u00e9rico. A escolha mais \u00f3bvia\n\nem um m\u00e9todo de volumes finitos baseado em elementos \u00e9 a diferencia-\n\n\u00e7\u00e3o de express\u00f5es anal\u00edticas que aproximem a varia\u00e7\u00e3o das vari\u00e1veis nos\n\nelementos. Para tanto, utilizam-se as fun\u00e7\u00f5es polinomiais empregadas\n\nhabitualmente no m\u00e9todo de elementos finitos. Nesse caso, a no\u00e7\u00e3o de\n\nelemento transcende o papel puramente geom\u00e9trico, ao serem associadas\n\na cada tipo de elemento fun\u00e7\u00f5es polinomiais compat\u00edveis com sua forma,\n\nas quais s\u00e3o utilizadas para a interpola\u00e7\u00e3o das vari\u00e1veis. Essas fun\u00e7\u00f5es s\u00e3o\n\ncomumente denominadas fun\u00e7\u00f5es de forma. Apesar de existirem outras\n\nalternativas para a aproxima\u00e7\u00e3o num\u00e9rica dos termos de transporte difu-\n\nsivo, neste trabalho s\u00e3o utilizadas fun\u00e7\u00f5es de forma. Nas restantes se\u00e7\u00f5es\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 39\n\nz\nx y\n\nFluxos e outras grandezas determinados mediante aproxima\u00e7\u00f5es locais em fun\u00e7\u00e3o dos valores nodais em um elemento\n\nValores discretos das vari\u00e1veis associadosaos v\u00e9rtices da malha prim\u00e1ria (n\u00f3s)\n\nEqua\u00e7\u00f5es discretas associadas \u00e0s entidades duais dos v\u00e9rtices da malha (volumes de controle)\n\nFigura 3.1 \u2013 Caracter\u00edsticas fundamentais dos m\u00e9todos de volumes finitos\nbaseados em elementos.\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 40\n\ndeste cap\u00edtulo s\u00e3o apresentados os ingredientes b\u00e1sicos do m\u00e9todo de vo-\n\nlumes baseado em elementos, aplicado no presente trabalho \u00e0 simula\u00e7\u00e3o\n\nde reservat\u00f3rios.\n\n3.2 Conven\u00e7\u00f5es relativas \u00e0 nota\u00e7\u00e3o\nConforme visto no cap\u00edtulo 2, na especifica\u00e7\u00e3o da malha prim\u00e1ria s\u00e3o es-\n\ntabelecidos implicitamente esquemas de indexa\u00e7\u00e3o global para v\u00e9rtices e\n\nelementos. Dado que tais esquemas permitem identificar univocamente\n\nessas entidades, as restantes entidades envolvidas no processo de discre-\n\ntiza\u00e7\u00e3o s\u00e3o normalmente referidas a elementos ou v\u00e9rtices relacionados\n\ncom elas. Contudo, j\u00e1 que no m\u00e9todo considerado n\u00f3s e v\u00e9rtices coinci-\n\ndem na mesma localiza\u00e7\u00e3o geom\u00e9trica, em vez de se referir aos v\u00e9rtices,\n\na nota\u00e7\u00e3o far\u00e1 refer\u00eancia aos n\u00f3s. Isto porque a no\u00e7\u00e3o de n\u00f3 tem uma\n\nconota\u00e7\u00e3o mais ampla que a de v\u00e9rtice, no contexto do m\u00e9todo num\u00e9rico.\n\nSeja ? uma dada grandeza envolvida na descri\u00e7\u00e3o do problema consi-\nderado. Para denotar o valor dessa grandeza associada ao n\u00f3 p , escrever-\n\nse-\u00e1 ??p . Quando se fizer refer\u00eancia ao valor nodal em um n\u00f3 ` localizado\nno elemento e , escrever-se-\u00e1 ??e\n\n`\n. Nesse contexto, ` pode ser interpretado\n\ncomo o \u00edndice local que identifica o n\u00f3 no elemento, isto \u00e9, `?\n\u00a6\n\n1, 2, . . . , N e\nn\n\n\u00a9\n\n,\n\nonde N e\nn\n\n\u00e9 o n\u00famero de n\u00f3s associados ao elemento em quest\u00e3o.\n\nA nota\u00e7\u00e3o para a associa\u00e7\u00e3o com outras entidades segue uma conven-\n\n\u00e7\u00e3o similar. Assim, por exemplo, ?ef indica que a grandeza ? est\u00e1 associada\n\u00e0 face f , localizada no elemento e . Por outro lado, ?es indica que a gran-\ndeza est\u00e1 associada ao subelemento s do elemento e . Em geral, faces e\n\nsubelementos s\u00e3o indexados apenas localmente nos elementos. Portanto,\n\nnas grandezas associadas a essas entidades o sobrescrito e frequentemente\n\nser\u00e1 omitido, a fim de simplificar a nota\u00e7\u00e3o. Note-se, por outro lado, que\n\napenas as grandezas associadas aos n\u00f3s, por sua relev\u00e2ncia nas equa\u00e7\u00f5es\n\ndiscretizadas, levam o sinal diacr\u00edtico (?).\nMuitas das opera\u00e7\u00f5es relativas \u00e0 discretiza\u00e7\u00e3o das equa\u00e7\u00f5es envolvem\n\ndiversos conjuntos de entidades. Por exemplo, todas as equa\u00e7\u00f5es de con-\n\nserva\u00e7\u00e3o discretas est\u00e3o referidas aos volumes de controle e \u00e0s superf\u00ed-\n\ncies que os limitam, os quais, como indicado no cap\u00edtulo 2, s\u00e3o formados\n\npor subelementos e faces, respectivamente. Logo, um volume de controle\n\npode ser definido como um conjunto de subelementos e sua superf\u00edcie de\n\ncontrole como a uni\u00e3o de um conjunto de faces e um conjunto de faces\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 41\n\nde contorno. A fim de facilitar a escrita das equa\u00e7\u00f5es discretizadas, neste\n\ntrabalho \u00e9 utilizada uma nota\u00e7\u00e3o especial para esses e outros conjuntos de\n\nentidades. A defini\u00e7\u00e3o desses conjuntos, assim como a nota\u00e7\u00e3o empregada\n\npara eles, encontra-se indicada com exemplos nas figuras 3.2 e 3.3, para\n\nentidades da malha volum\u00e9trica, e na figura 3.4, para entidades das malhas\n\nde contorno. Os esquemas que ilustram cada defini\u00e7\u00e3o correspondem\n\na malhas bidimensionais, para permitir uma visualiza\u00e7\u00e3o mais clara das\n\nentidades envolvidas.1\n\nN\u00f3 p\n\nElemento e Elemento e\n\nSubelemento do elemento adjacente ao n\u00f3 p e\n\nConjunto dos n\u00f3s associadosao elemento e Conjunto das faces no interiordo elemento e\n\nConjunto das faces no interior doelemento e, associadas ao n\u00f3 p \nN\u00f3 p\n\nElemento e Elemento e\n\nFigura 3.2 \u2013 Nota\u00e7\u00e3o de entidades e conjuntos de entidades (parte 1).\n\n1 As por\u00e7\u00f5es de malha mostradas nos esquemas podem ser interpretadas tamb\u00e9m como\ncortes transversais de uma malha tridimensional.\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 42\n\nN\u00f3 p\n\nConjunto dos elementosque compartilham o n\u00f3 p\n\nN\u00f3 p\n\nN\u00f3 pN\u00f3 p\n\nVolume de controleao redor do n\u00f3 p\n\nEst\u00e9ncil associadoao n\u00f3 p Conjunto das faces ao redor do n\u00f3 p\n\nFigura 3.3 \u2013 Nota\u00e7\u00e3o de entidades e conjuntos de entidades (parte 2).\n\nNa nota\u00e7\u00e3o empregada, as entidades e conjuntos de entidades referi-\n\ndas \u00e0s malhas de contorno se distinguem daquelas da malha volum\u00e9trica\n\npela anteposi\u00e7\u00e3o do \u00edndice b . Assim, por exemplo, um elemento de con-\n\ntorno \u00e9 denotado por be e uma face de contorno por bf . Outros exemplos\n\ndessa nota\u00e7\u00e3o s\u00e3o apresentados na figura 3.4. Note-se que nessa figura,\n\numa superf\u00edcie de controle foi definida como a uni\u00e3o do conjunto das faces\n\ninternas \u00e0 malha associadas a um volume de controle, Fp , e do conjunto\ndas suas faces de contorno, bFp . Para um volume de controle interno, isto\n\u00e9, n\u00e3o adjacente a um contorno, bFp \u00e9 um conjunto vazio e, portanto, sua\nsuperf\u00edcie de controle \u00e9 simplesmente Fp .\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 43\n\nN\u00f3 p N\u00f3 p\n\nConjunto dos elementos decontorno que compartilhamo n\u00f3 p Conjunto das faces no elemento de contorno     , adjacentes ao n\u00f3 p                   \nElemento decontorno\n\nConjunto de todas as faces de contorno adjacentes ao n\u00f3 p\nSuperf\u00edcie de controle associada ao volume\n\nN\u00f3 p N\u00f3 p\n\nFigura 3.4 \u2013 Nota\u00e7\u00e3o de entidades e conjuntos de entidades associadas \u00e0\nmalhas de contorno.\n\nDado que a formula\u00e7\u00e3o apresentada est\u00e1 destinada maiormente a pro-\n\nblemas em regime transiente, para a discretiza\u00e7\u00e3o considerar-se-\u00e1 uma\n\nparti\u00e7\u00e3o finita do intervalo de tempo, t 0 &lt;t 1 &lt;t 2 &lt;. . . &lt;t m &lt;. . . &lt;t Nt .\n\nCada um desses n\u00edveis de tempo discretos pode ser interpretado como um\n\nn\u00f3 em uma malha unidimensional na linha do tempo. Nessa malha, ?t m\ndenota um intervalo de tempo particular, definido por ?t m ? t m ?t m?1.\n\nPara denotar o valor de uma grandeza ?, dependente do tempo, no\nn\u00edvel t = t m , escrever-se-\u00e1 b?cm . Sempre que for poss\u00edvel, o \u00edndice m ser\u00e1\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 44\n\nomitido a fim de simplificar a nota\u00e7\u00e3o das express\u00f5es discretizadas. Nesse\n\ncaso, ficar\u00e1 impl\u00edcito que qualquer grandeza dependente do tempo estar\u00e1\n\nassociada ao n\u00edvel de tempo t = t m . Apenas quando tal pr\u00e1tica possa gerar\nexpress\u00f5es amb\u00edguas ser\u00e3o utilizados os \u00edndices apropriados relativos ao\n\ntempo.\n\n3.3 Transforma\u00e7\u00e3o de coordenadas\nA estrat\u00e9gia comumente adotada para se lidar com a distor\u00e7\u00e3o geom\u00e9trica\n\ndos elementos em uma malha n\u00e3o-estruturada \u00e9 o denominado mapea-\n\nmento [35, 84]. Trata-se de uma correspond\u00eancia biun\u00edvoca entre os pon-\ntos de um elemento no espa\u00e7o f\u00edsico e os pontos de um elemento regu-\n\nlar com a mesma topologia, no denominado espa\u00e7o transformado. Tal\n\nmapeamento implica a exist\u00eancia de equa\u00e7\u00f5es de transforma\u00e7\u00e3o entre o\n\nsistema de coordenadas global, no qual est\u00e1 definida a malha no espa\u00e7o\n\nf\u00edsico, e um sistema de coordenadas local em cada elemento. A vantagem\n\ndesta transforma\u00e7\u00e3o \u00e9 que v\u00e1rias das opera\u00e7\u00f5es necess\u00e1rias para a discre-\n\ntiza\u00e7\u00e3o das equa\u00e7\u00f5es podem ser expressas de forma gen\u00e9rica, e geralmente\n\nmais simples, no sistema local de coordenadas.\n\nA maneira mais conveniente de expressar a transforma\u00e7\u00e3o de coor-\n\ndenadas em um elemento \u00e9 mediante fun\u00e7\u00f5es de forma. As fun\u00e7\u00f5es de\n\nforma para elementos tridimensionais s\u00e3o fun\u00e7\u00f5es cont\u00ednuas e deriv\u00e1veis\n\ndas coordenadas locais ?, ? e ?, que possuem algumas propriedades es-\n\npeciais, citadas mais adiante. Com ajuda dessas fun\u00e7\u00f5es, as equa\u00e7\u00f5es de\n\ntransforma\u00e7\u00e3o das coordenadas locais \u00e0s coordenadas cartesianas globais,\n\npara um ponto no interior ou no contorno de um elemento, podem ser\n\nescritas como [84]\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nx =\n?\n\n`?N e\nN`(?,?,?) x? e` ,\n\ny =\n?\n\n`?N e\nN`(?,?,?) y? e` ,\n\nz =\n?\n\n`?N e\nN`(?,?,?) z? e` .\n\n(3.1)\n\nNestas equa\u00e7\u00f5es, N`(?,?,?), para ` ? N e =\n\u00a6\n\n1, 2, . . . , N e\nn\n\n\u00a9\n\n, s\u00e3o fun\u00e7\u00f5es\n\nde forma adaptadas \u00e0 topologia do elemento em quest\u00e3o, enquanto que\n\nx? e\n`\n\n, y? e\n`\n\ne z? e\n`\n\ns\u00e3o as coordenadas globais dos n\u00f3s associados a ele.\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 45\n\nO n\u00famero de fun\u00e7\u00f5es de forma diferentes que podem ser definidas\n\nem um elemento \u00e9 igual ao n\u00famero de n\u00f3s associados a ele. Para todos\n\nos elementos considerados neste trabalho, as express\u00f5es matem\u00e1ticas das\n\nfun\u00e7\u00f5es de forma utilizadas s\u00e3o apresentadas na subse\u00e7\u00e3o 3.3.2. Todas\n\nessas fun\u00e7\u00f5es satisfazem algumas propriedades b\u00e1sicas. Assim, por exem-\n\nplo, elas variam sempre no intervalo [0, 1], no interior e sobre o contorno\nde um elemento. No ponto coincidente com o n\u00f3 de \u00edndice local a , a\n\nfun\u00e7\u00e3o de forma Na adquire o valor 1, enquanto todas as restantes fun\u00e7\u00f5es\nse anulam. Al\u00e9m disso, os valores das fun\u00e7\u00f5es de forma em um ponto\n\nqualquer do elemento constituem uma parti\u00e7\u00e3o da unidade [84], isto \u00e9,\nsatisfazem a rela\u00e7\u00e3o\n\n?\n\n`?N e\nN`(?,?,?) = 1 . (3.2)\n\n3.3.1 Matriz jacobiana\n\nV\u00e1rias express\u00f5es matem\u00e1ticas relativas a discretiza\u00e7\u00e3o, quando expressas\n\nem coordenadas locais, incluem a denominada matriz jacobiana. Para\n\numa transforma\u00e7\u00e3o como a dada pelas equa\u00e7\u00f5es (3.1), essa matriz \u00e9 de-\n\nfinida por [82]\n\nJ (?,?,?) ?\n\n?\n\n?\n\n?\n\n?\n\n??x ??x ??x\n\n??y ??y ??y\n\n??z ??z ??z\n\n?\n\n?\n\n?\n\n?\n\n, (3.3)\n\nNesta express\u00e3o, ??x , por exemplo, \u00e9 uma nota\u00e7\u00e3o reduzida para a\n\nderivada parcial ?x/??. Todas as derivadas parciais inclu\u00eddas na matriz\n\njacobiana podem ser obtidas explicitamente diferenciando as equa\u00e7\u00f5es\n\n(3.1). Assim, por exemplo, para a derivada parcial ??x , tem-se\n\n??x =\n?\n\n`?N e\n??N` \u00b7 x? e` . (3.4)\n\nSubstituindo express\u00f5es equivalentes para todas as derivadas parciais\n\nna defini\u00e7\u00e3o da matriz jacobiana, obt\u00e9m-se\n\nJ =\n\n?\n\n?\n\n?\n\n?\n\n?\n\n??N` \u00b7 x? e`\n?\n\n??N` \u00b7 x? e`\n?\n\n??N` \u00b7 x? e`\n?\n\n??N` \u00b7 y? e`\n?\n\n??N` \u00b7 y? e`\n?\n\n??N` \u00b7 y? e`\n?\n\n??N` \u00b7 z? e`\n?\n\n??N` \u00b7 z? e`\n?\n\n??N` \u00b7 z? e`\n\n?\n\n?\n\n?\n\n?\n\n. (3.5)\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 46\n\nEsta express\u00e3o pode ser reescrita de um modo mais conveniente para\n\no c\u00f4mputo da matriz jacobiana, como\n\nJ =\n\n?\n\n?\n\n?\n\n?\n\nx? e1 x?\ne\n2 . . . x?\n\ne\nNn\n\ny? e1 y?\ne\n\n2 . . . y?\ne\n\nNn\n\nz? e1 z?\ne\n2 . . . z?\n\ne\nNn\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n??N1 ??N1 ??N1\n??N2 ??N2 ??N2\n\n...\n...\n\n...\n\n??NN en ??NN en ??NN en\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n. (3.6)\n\nPara uso nesta express\u00e3o, as derivadas parciais das fun\u00e7\u00f5es de forma\n\nem rela\u00e7\u00e3o \u00e0s coordenadas locais podem ser obtidas explicitamente me-\n\ndiante diferencia\u00e7\u00e3o das equa\u00e7\u00f5es que as definem em cada tipo de ele-\n\nmento. A matriz que cont\u00e9m essas derivadas participa tamb\u00e9m em outras\n\nexpress\u00f5es, motivo pelo qual ser\u00e1 definida formalmente como\n\nD(?,?,?) ?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n??N1 ??N1 ??N1\n??N2 ??N2 ??N2\n\n...\n...\n\n...\n\n??NN en ??NN en ??NN en\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n. (3.7)\n\n3.3.2 Fun\u00e7\u00f5es de forma\n\nA seguir s\u00e3o detalhadas as fun\u00e7\u00f5es de forma consideradas neste trabalho.\n\nElas s\u00e3o compat\u00edveis com as geometrias dos elementos e com a localiza\u00e7\u00e3o\n\ndefinida para os n\u00f3s. \u00c9 f\u00e1cil comprovar que satisfazem todas as restri\u00e7\u00f5es\n\nindicadas anteriormente para as fun\u00e7\u00f5es de forma.\n\nAs fun\u00e7\u00f5es de forma para o tetraedro s\u00e3o fun\u00e7\u00f5es lineares nas coorde-\n\nnadas locais, definidas por\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nN1(?,?,?) = 1??????,\n\nN2(?,?,?) = ?,\n\nN3(?,?,?) = ?,\n\nN4(?,?,?) = ?.\n\n(3.8)\n\nA figura 3.5 mostra o elemento tetra\u00e9drico no espa\u00e7o transformado,\n\njunto com as coordenadas locais dos seus v\u00e9rtices. Qualquer tetraedro em\n\numa malha, sem importar qu\u00e3o deformado se encontrar, se aplicar\u00e1 no\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 47\n\ntetraedro regular da figura 3.5, quando for considerarada a transforma\u00e7\u00e3o\n\ndada pelas equa\u00e7\u00f5es (3.1), com as fun\u00e7\u00f5es de forma dadas pelas equa\u00e7\u00f5es\n\n(3.8). No tetraedro transformado, as coordenadas locais variam nos inter-\n\nvalos 0\u00b6?\u00b61????, 0\u00b6?\u00b61???? e 0\u00b6?\u00b61????.\n\n2 3\n1\n4\n\nCoordenadas locaisdos v\u00e9rtices\n1 0 0 02 1 0 03 0 1 04 0 0 1\n\nV\u00e9rtice\nFigura 3.5 \u2013 Tetraedro no espa\u00e7o transformado.\n\nAs fun\u00e7\u00f5es de forma para o elemento hexa\u00e9drico s\u00e3o as oito fun\u00e7\u00f5es\n\ntrilineares\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nN1(?,?,?) = (1??) (1??) (1??),\n\nN2(?,?,?) = ? (1??) (1??),\n\nN3(?,?,?) = ?? (1??),\n\nN4(?,?,?) = (1??)? (1??),\n\nN5(?,?,?) = (1??) (1??)?,\n\nN6(?,?,?) = ? (1??)?,\n\nN7(?,?,?) = ???,\n\nN8(?,?,?) = (1??)??.\n\n(3.9)\n\nCom uma transforma\u00e7\u00e3o de coordenadas empregando essas fun\u00e7\u00f5es\n\nde forma, um hexaedro qualquer \u00e9 mapeado em um cubo de dimens\u00f5es\n\nunit\u00e1rias, segundo mostra a figura 3.6. Nesse elemento hexa\u00e9drico trans-\n\nformado, os intervalos de varia\u00e7\u00e3o das coordenadas locais s\u00e3o 0 \u00b6?\u00b6 1,\n0 \u00b6?\u00b6 1 e 0 \u00b6 ?\u00b6 1, respectivamente. Qualquer uma das fun\u00e7\u00f5es de\nforma do hexaedro se reduz a uma fun\u00e7\u00e3o linear sobre as tr\u00eas arestas que\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 48\n\nconfluem no v\u00e9rtice cujo \u00edndice local coincide com o da fun\u00e7\u00e3o, anulando-\n\nse nas restantes arestas. Al\u00e9m disso, nas facetas adjacentes ao v\u00e9rtice, a\n\nfun\u00e7\u00e3o de forma se reduz a uma fun\u00e7\u00e3o bilinear, id\u00eantica \u00e0 considerada\n\nem um elemento quadril\u00e1tero bidimensional.\n\nCoordenadas locaisdos v\u00e9rtices\n1 0 0 02 1 0 03 1 1 04 0 1 05 0 0 16 1 0 17 1 1 18 0 1 1\n\nV\u00e9rtice\n2\n\n6\n4\n\n8\n1\n\n5\n\n7\n\n3\nFigura 3.6 \u2013 Hexaedro no espa\u00e7o transformado.\n\nAs fun\u00e7\u00f5es de forma consideradas para o prisma s\u00e3o as seguintes\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nN1(?,?,?) = (1????) (1??),\n\nN2(?,?,?) = ? (1??),\n\nN3(?,?,?) = ? (1??),\n\nN4(?,?,?) = (1????)?,\n\nN5(?,?,?) = ??,\n\nN6(?,?,?) = ??.\n\n(3.10)\n\nO prisma no espa\u00e7o transformado \u00e9 mostrado na figura 3.7. Nele, os\n\nintervalos de varia\u00e7\u00e3o das coordenadas locais s\u00e3o 0\u00b6?\u00b61??, 0\u00b6?\u00b61??\ne 0 \u00b6 ? \u00b6 1. De modo semelhante ao caso do hexaedro, as fun\u00e7\u00f5es de\nforma do prisma se reduzem a fun\u00e7\u00f5es lineares em tr\u00eas arestas e se anu-\n\nlam nas restantes. Nas facetas triangulares, as fun\u00e7\u00f5es tornam-se lineares,\n\nenquanto que nas facetas quadrangulares se reduzem a fun\u00e7\u00f5es biline-\n\nares em duas coordenadas. Isto garante a compatibilidade das fun\u00e7\u00f5es\n\nde forma do prisma com as do tetraedro e as do hexaedro. Ou seja, em\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 49\n\numa faceta triangular comum a um tetraedro e a um prisma, a varia\u00e7\u00e3o\n\ndas fun\u00e7\u00f5es de forma \u00e9 id\u00eantica para ambos os elementos. Uma situa\u00e7\u00e3o\n\nequivalente acontece em uma faceta quadrangular compartilhada por um\n\nhexaedro e um prisma.\n\nCoordenadas locaisdos v\u00e9rtices\n1 0 0 02 1 0 03 0 1 04 0 0 15 1 0 16 0 1 1\n\nV\u00e9rtice\n2\n\n5\n3\n\n6\n1\n\n4\n\nFigura 3.7 \u2013 Prisma no espa\u00e7o transformado.\n\nFinalmente, as fun\u00e7\u00f5es de forma consideradas para a pir\u00e2mide s\u00e3o\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nN1(?,?,?) = (1??) (1??) ? 14? + (??\n1\n2\n) (?? 1\n\n2\n)?/(1??),\n\nN2(?,?,?) = ? (1??) ? 14? ? (??\n1\n2\n) (?? 1\n\n2\n)?/(1??),\n\nN3(?,?,?) = ?? ? 14? + (??\n1\n2\n) (?? 1\n\n2\n)?/(1??),\n\nN4(?,?,?) = (1??)? ? 14? ? (??\n1\n2\n) (?? 1\n\n2\n)?/(1??),\n\nN5(?,?,?) = ?.\n\n(3.11)\n\nEstas fun\u00e7\u00f5es de forma diferem das dos outros elementos na presen\u00e7a\n\nde um termo racional em quatro delas. Conforme [83], esse termo \u00e9 ne-\ncess\u00e1rio para garantir a compatibilidade com as fun\u00e7\u00f5es de tetraedros e\n\nhexaedros e para evitar a singularidade da matriz jacobiana.2 De fato, \u00e9\n\nposs\u00edvel comprovar que as fun\u00e7\u00f5es da equa\u00e7\u00e3o (3.11) se reduzem a fun\u00e7\u00f5es\n\nlineares sobre as facetas triangulares e a fun\u00e7\u00f5es bilineares sobre a base\n\nquadrangular, como requerido para a transi\u00e7\u00e3o com os outros elementos.\n\n2 As fun\u00e7\u00f5es da equa\u00e7\u00e3o (3.11), no entanto, diferem das apresentadas em [83] nos interva-\nlos de varia\u00e7\u00e3o das coordenadas locais. Variou-se esses intervalos a fim de compatibiliz\u00e1-los\ncom os considerados nas fun\u00e7\u00f5es de forma dos outros elementos, sempre entre 0 e 1.\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 50\n\nO elemento piramidal no espa\u00e7o transformado encontra-se representado\n\nna figura 3.8. Os intervalos de varia\u00e7\u00e3o admiss\u00edveis para as coordenadas\n\nlocais s\u00e3o ?\n2\n\u00b6?\u00b61? ?\n\n2\n, ?\n\n2\n\u00b6?\u00b61? ?\n\n2\ne 0\u00b6?\u00b61.\n\nCoordenadas locaisdos v\u00e9rtices\n1 0 0 02 1 0 03 1 1 04 0 1 05 \u00bd \u00bd 1\n\nV\u00e9rtice\n\n2\n41\n\n5\n\n3\nFigura 3.8 \u2013 Pir\u00e2mide no espa\u00e7o transformado.\n\n3.4 Integra\u00e7\u00e3o num\u00e9rica\nEm geral, um m\u00e9todo de volumes finitos \u00e9 baseado na aproxima\u00e7\u00e3o nu-\n\nm\u00e9rica da forma integral das equa\u00e7\u00f5es de conserva\u00e7\u00e3o. Portanto, uma\n\ndas opera\u00e7\u00f5es mais importantes do m\u00e9todo \u00e9 a aproxima\u00e7\u00e3o de integrais.\n\nOrdinariamente, dois tipos de integrais precisam ser aproximadas em uma\n\nequa\u00e7\u00e3o de conserva\u00e7\u00e3o: integrais de volume, cujo dom\u00ednio s\u00e3o os volumes\n\nde controle, e integrais de superf\u00edcie, cujo dom\u00ednio s\u00e3o as superf\u00edcies de\n\ncontrole que limitam esses volumes.\n\n3.4.1 Aproxima\u00e7\u00e3o de integrais de volume\n\nA forma mais simples de aproxima\u00e7\u00e3o de uma integral de volume \u00e9 o pro-\n\nduto do valor m\u00e9dio do integrando no dom\u00ednio de integra\u00e7\u00e3o pelo volume\n\ndesse dom\u00ednio. No contexto do m\u00e9todo de volumes finitos, o valor m\u00e9dio\n\ndo integrando pode ser aproximado pelo seu valor nodal, correspondente\n\nao n\u00f3 interior do volume de controle. Pode-se, portanto, escrever para essa\n\naproxima\u00e7\u00e3o\n?\n\nVp\n\n? dV ? ??p ?Vp , (3.12)\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 51\n\nem que ??p \u00e9 o valor nodal do integrando e ?Vp \u00e9 o volume do volume de\ncontrole, ambos associados ao n\u00f3 p .\n\nQuando o n\u00f3 p estiver localizado no baricentro do volume de controle\n\nVp , como aconteceria em uma malha cartesiana regular, a aproxima\u00e7\u00e3o\n(3.12) ter\u00e1 precis\u00e3o de segunda ordem [20]. Nos volumes de controle poli\u00e9-\ndricos constru\u00eddos sobre uma malha n\u00e3o-estruturada irregular, entretanto,\n\nraramente o n\u00f3 interior estar\u00e1 localizado no baricentro do volume. Nesses\n\ncasos, a precis\u00e3o da aproxima\u00e7\u00e3o (3.12) se reduz a primeira ordem. Ape-\n\nsar disso, em um m\u00e9todo de volumes finitos \u00e9 comum utilizar esse tipo\n\nde aproxima\u00e7\u00e3o, especialmente no termo transiente de uma equa\u00e7\u00e3o de\n\nconserva\u00e7\u00e3o.\n\nNo contexto de um m\u00e9todo de volumes finitos baseado em elemen-\n\ntos, a aproxima\u00e7\u00e3o de uma integral de volume pode ser feita tamb\u00e9m em\n\nn\u00edvel de subelementos. Uma vez que um volume de controle encontra-se\n\nformado por certo n\u00famero de subelementos, \u00e9 poss\u00edvel escrever\n\n?\n\nVp\n\n? dV =\n?\n\ne?Ep\n\n?\n\ns ep\n\n? dV . (3.13)\n\nCada uma das integrais definidas sobre os subelementos pode ser en-\n\nt\u00e3o aproximada, resultando a express\u00e3o\n\n?\n\nVp\n\n? dV ?\n?\n\ne?Ep\n\n?e?sp ?V\ne\n\nsp\n, (3.14)\n\nonde ?e?sp \u00e9 o valor do integrando, avaliado no baricentro do subelemento\n\ns ep , enquanto que ?V\ne\n\nsp\n\u00e9 o volume de tal subelemento. No caso de n\u00e3o\n\nexistir uma express\u00e3o expl\u00edcita para o integrando em fun\u00e7\u00e3o de coordena-\n\ndas espaciais, pode ser necess\u00e1rio o uso de esquemas de interpola\u00e7\u00e3o para\n\nrelacionar o valor de ?e?sp com valores nodais.\n\nComo no espa\u00e7o transformado os subelementos possuem uma forma\n\nmais regular, seu volume pode ser determinado mais facilmente mediante\n\nintegra\u00e7\u00e3o nesse espa\u00e7o. O fator de escala entre o volume de um elemento\n\ndiferencial no espa\u00e7o f\u00edsico e o correspondente volume no espa\u00e7o transfor-\n\nmado \u00e9 dado pelo determinante da matriz jacobiana |J| da transforma\u00e7\u00e3o\n[84]. Portanto, para determinar o volume de um subelemento, pode ser\nutilizada a express\u00e3o integral\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 52\n\n?V esp =\n\n?\n\ns ep\n\n|J| dV ??? , (3.15)\n\nna qual, dV ??? \u00e9 o elemento diferencial de volume no espa\u00e7o transfor-\n\nmado. Isso implica que a integra\u00e7\u00e3o \u00e9 realizada nesse espa\u00e7o. Os detalhes\n\ndas t\u00e9cnicas de integra\u00e7\u00e3o empregadas neste trabalho para o c\u00e1lculo da\n\nintegral na equa\u00e7\u00e3o (3.15) s\u00e3o apresentados no ap\u00eandice A.\n\nEncontrando-se dispon\u00edveis os volumes dos subelementos, o volume\n\nde um volume de controle completo, necess\u00e1rio na equa\u00e7\u00e3o (3.12), pode\n\nser obtido mediante a soma\n\n?Vp =\n?\n\ne?Ep\n\n?V esp . (3.16)\n\n3.4.2 Aproxima\u00e7\u00e3o de integrais de superf\u00edcie\n\nAs integrais de superf\u00edcie em uma equa\u00e7\u00e3o de conserva\u00e7\u00e3o representam\n\nos fluxos advectivos e/ou difusivos atravessando a superf\u00edcie de controle.\nO fluxo total atrav\u00e9s de uma superf\u00edcie de controle pode ser expresso por\n\numa integral da forma\n?\n\nSp\n? \u00b7 dS , onde ? \u00e9 a densidade de fluxo e dS um\n\nelemento diferencial de \u00e1rea, sendo ambas as grandezas vetoriais. O vetor\n\ndS \u00e9 normal \u00e0 superf\u00edcie de controle em qualquer ponto, com orienta\u00e7\u00e3o\napontando para o exterior do volume de controle.\n\nUma vez que uma superf\u00edcie de controle encontra-se formada, em\n\ngeral, por um conjunto de faces internas \u00e0 malha e um conjunto de faces\n\nde contorno, pode-se ent\u00e3o escrever\n\n?\n\nSp\n\n? \u00b7 dS =\n?\n\nFp\n\n? \u00b7 dS +\n?\n\nbFp\n\n? \u00b7 dS . (3.17)\n\nConsiderando inicialmente a integral sobre Fp , ela ser\u00e1 igual \u00e0 soma\ndas integrais definidas sobre as faces individuais f que perten\u00e7am a Fp .\nOu seja,\n\n?\n\nFp\n\n? \u00b7 dS =\n?\n\nf ?Fp\n\n?\n\nf\n\n? \u00b7 dS . (3.18)\n\nAinda, dado que essas faces encontram-se distribu\u00eddas nos elementos\n\nque contribuem na forma\u00e7\u00e3o do volume de controle, a \u00faltima equa\u00e7\u00e3o\n\npode ser reescrita de forma equivalente como\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 53\n\n?\n\nFp\n\n? \u00b7 dS =\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?\n\nf\n\n? \u00b7 dS . (3.19)\n\nCada face f \u00e9 um quadril\u00e1tero o um tri\u00e2ngulo localizado no interior\n\nde um elemento e . A integral em uma dessas faces pode ser aproximada\n\npela regra do ponto m\u00e9dio [20], isto \u00e9, pelo produto escalar do integrando,\navaliado no baricentro da face, e o vetor \u00e1rea da face em quest\u00e3o.3 Intro-\n\nduzindo essa aproxima\u00e7\u00e3o na equa\u00e7\u00e3o (3.19), obt\u00e9m-se, finalmente,\n\n?\n\nFp\n\n? \u00b7 dS ?\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n??f \u00b7?S f , p . (3.20)\n\nNesta express\u00e3o, ??f \u00e9 o valor da densidade de fluxo no baricentro da\nface f , enquanto que ?S f , p \u00e9 o vetor \u00e1rea da referida face, com orienta\u00e7\u00e3o\npositiva relativa ao volume de controle Vp .\n\nO vetor \u00e1rea \u00e9 o produto da \u00e1rea de uma face pelo vetor unit\u00e1rio na\n\nsua dire\u00e7\u00e3o normal.4 Quanto \u00e0 orienta\u00e7\u00e3o desse vetor, pode-se definir uma\n\norienta\u00e7\u00e3o absoluta e uma orienta\u00e7\u00e3o relativa aos volumes de controle que\n\na face separa.\n\nDefini\u00e7\u00e3o 3.1. A orienta\u00e7\u00e3o absoluta do vetor \u00e1rea de uma face \u00e9 id\u00eantica\n\u00e0 orienta\u00e7\u00e3o da aresta associada \u00e0 face.\n\nNa se\u00e7\u00e3o 2.3, quando foi descrita a topologia dos elementos, definiu-\n\nse a orienta\u00e7\u00e3o das arestas em fun\u00e7\u00e3o da ordena\u00e7\u00e3o em que s\u00e3o especi-\n\nficados os v\u00e9rtices.5 Convencionalmente, a defini\u00e7\u00e3o 3.1 estabelece que\n\numa face e uma aresta, que s\u00e3o entidades duais em n\u00edvel de elemento,\n\npossuem a mesma orienta\u00e7\u00e3o. Isso \u00e9 mostrado esquematicamente na fi-\n\ngura 3.9. Nessa figura \u00e9 indicada tamb\u00e9m uma nota\u00e7\u00e3o para os dois n\u00f3s\n\nnas extremidades de uma aresta, a qual esta relacionada com a orienta\u00e7\u00e3o\n\nda face.\n\n3 Essa aproxima\u00e7\u00e3o \u00e9 equivalente ao emprego de uma quadratura de Gauss [35, 84] com\num \u00fanico ponto de integra\u00e7\u00e3o sobre a face.\n\n4 O c\u00f4mputo do vetor \u00e0rea \u00e9 descrito no ap\u00eandice A, considerando inclusive o caso da face\nser um quadril\u00e1tero n\u00e3o plano.\n\n5 Conforme se definiu na se\u00e7\u00e3o 2.3, a orienta\u00e7\u00e3o positiva de uma aresta \u00e9 aquela que vai\ndo primeiro ao segundo v\u00e9rtice especificado.\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 54\n\nFace f\n\nAresta\n  (1\u00b0 n\u00f3)\n\n (2\u00b0 n\u00f3)\nFigura 3.9 \u2013 Orienta\u00e7\u00e3o absoluta do vetor \u00e1rea de face.\n\nEntretanto, as express\u00f5es aproximadas para os fluxos nas faces, como\n\na da equa\u00e7\u00e3o (3.20), devem ser escritas considerando a orienta\u00e7\u00e3o das\n\nfaces relativa aos volumes de controle adjacentes.\n\nDefini\u00e7\u00e3o 3.2. O vetor \u00e1rea de uma face possui orienta\u00e7\u00e3o positiva em\nrela\u00e7\u00e3o a um volume de controle adjacente se aponta para o exterior do\n\nvolume.\n\nNeste trabalho, o vetor \u00e1rea associado \u00e0 face f , quando considerado\n\ncom orienta\u00e7\u00e3o absoluta, \u00e9 denotado como ?Sf . No entanto, quando for\nnecess\u00e1rio especificar a orienta\u00e7\u00e3o relativa a um volume de controle adja-\n\ncente, o vetor ser\u00e1 denotado como ?S f , p , sendo p o n\u00f3 interior ao volume\nreferido. Conforme ilustra a figura 3.10(a), ?S f , p coincide com?Sf quando\np \u00e9 o n\u00f3 localizado no lado oposto ao apontado por?Sf . No caso contr\u00e1rio,\no mostrado na figura 3.10(b), tem-se que ?S f , p =??Sf .\n\nDo ponto de vista da implementa\u00e7\u00e3o computacional \u00e9 mais vantajoso\n\nexpressar os fluxos nas faces considerando a orienta\u00e7\u00e3o absoluta do vetor\n\n\u00e1rea. Dessa forma, um fluxo \u00e9 calculado uma \u00fanica vez em uma dada face.\n\nQuando tal fluxo deva ser adicionado nas equa\u00e7\u00f5es de conserva\u00e7\u00e3o dos\n\nvolumes de controle adjacentes, ele ter\u00e1 sinal positivo para um volume\n\ne negativo para o outro.6 A diferen\u00e7a no sinal \u00e9 originada pela diferente\n\norienta\u00e7\u00e3o relativa do vetor \u00e1rea da face em rela\u00e7\u00e3o aos dois volumes.\n\n6 Isto \u00e9, o fluxo que abandona um volume de controle por uma dada face \u00e9 o mesmo fluxo\nque ingressa no volume vizinho, por essa face. Essa \u00e9 uma das caracter\u00edsticas fundamentais\nde um m\u00e9todo de volumes finitos, a consist\u00eancia dos fluxos nas interfaces entre volumes de\ncontrole [45, 59].\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 55\n\n,nB =Face f\n\nVolume decontrole\n,nF =\n\n(a)\n\n(b)\nFigura 3.10 \u2013 Orienta\u00e7\u00e3o do vetor \u00e1rea de face, relativa aos volumes de\n\ncontrole.\n\nUma forma pr\u00e1tica de expressar a aproxima\u00e7\u00e3o de uma integral de\n\nsuperf\u00edcie em fun\u00e7\u00e3o de ?Sf \u00e9 mediante a defini\u00e7\u00e3o do par\u00e2metro\n\n?f , p =\n\n\u00a8\n\n1 se p = nB(f ) ,\n\n?1 se p = nF(f ) ,\n(3.21)\n\nonde nB(f ) e nF(f ) s\u00e3o os n\u00f3s localizados atr\u00e1s e a frente da face f , respec-\n\ntivamente, segundo a nota\u00e7\u00e3o indicada nas figuras 3.9 e 3.10. Com esse\n\npar\u00e2metro, tem-se que ?S f , p =?f , p ?Sf , com o qual a equa\u00e7\u00e3o (3.20) pode\nser reescrita na forma final\n\n?\n\nFp\n\n? \u00b7 dS ?\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?f , p ??f \u00b7?Sf . (3.22)\n\nVoltando novamente \u00e0 aproxima\u00e7\u00e3o das integrais em uma superf\u00edcie\n\nde controle, na equa\u00e7\u00e3o (3.17) resta aproximar a integral definida sobre\nbFp , para os volumes adjacentes a contornos. A aproxima\u00e7\u00e3o dessa integral\npode ser escrita de forma an\u00e1loga \u00e0 aproxima\u00e7\u00e3o da integral sobre Fp .\nTem-se ent\u00e3o,\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 56\n\n?\n\nbFp\n\n? \u00b7 dS ?\n?\n\nbe?bEp\n\n?\n\nbf ?bF bep\n\n?b?f \u00b7?Sbf , (3.23)\n\nonde ?b?f \u00e9 o valor da densidade de fluxo no baricentro da face de contorno,\nenquanto que ?Sbf \u00e9 o vetor \u00e1rea correspondente a essa face. Os vetores\n?Sbf s\u00e3o constru\u00eddos de modo que sempre apontem para o exterior do\ndom\u00ednio. Em consequ\u00eancia, neste caso n\u00e3o h\u00e1 necessidade de distinguir\n\nentre orienta\u00e7\u00e3o absoluta e relativa aos volumes de controle, como no caso\n\ndas faces internas, porque ambas as orienta\u00e7\u00f5es sempre coincidem.\n\n3.5 Aproxima\u00e7\u00e3o do gradiente de uma vari\u00e1vel\n\nO transporte difusivo de uma grandeza f\u00edsica \u00e9 dependente do gradiente\n\ndessa grandeza. Logo, toda vez que for necess\u00e1rio aproximar numerica-\n\nmente o termo de transporte difusivo em uma equa\u00e7\u00e3o de conserva\u00e7\u00e3o,\n\nser\u00e1 necess\u00e1rio aproximar gradientes ou componentes desses gradientes\n\nem determinadas dire\u00e7\u00f5es.\n\nNa formula\u00e7\u00e3o de volumes finitos baseada em elementos apresentada\n\nneste trabalho, considerar-se-\u00e1 a abordagem tradicional, determinando os\n\ngradientes mediante diferencia\u00e7\u00e3o de aproxima\u00e7\u00f5es baseadas nas fun\u00e7\u00f5es\n\nde forma. Isto \u00e9, para efeito do c\u00f4mputo do gradiente, a varia\u00e7\u00e3o de uma\n\ngrandeza ? em um elemento ser\u00e1 aproximada pela express\u00e3o\n\n?(?,?,?) ?\n?\n\n`?N e\nN`(?,?,?) ??e` , (3.24)\n\nna qual, N`(?,?,?) s\u00e3o as mesmas fun\u00e7\u00f5es de forma consideradas no ma-\npeamento dos elementos 7 e ??e\n\n`\ns\u00e3o os valores nodais da grandeza.\n\nA aplica\u00e7\u00e3o da aproxima\u00e7\u00e3o (3.24) \u00e0 defini\u00e7\u00e3o do gradiente de uma\n\nfun\u00e7\u00e3o dependente das coordenadas cartesianas,\n\n?? ?\n\n?\n\n?\n\n?\n\n?\n\n?x?\n?y ?\n?z?\n\n?\n\n?\n\n?\n\n?\n\n, (3.25)\n\n7 Esta \u00e9 uma caracter\u00edstica, na nomenclatura do m\u00e9todo de elementos finitos, dos elemen-\ntos isoparam\u00e9tricos [35, 84].\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 57\n\nd\u00e1 origem \u00e0 express\u00e3o\n\n?? ?\n?\n\n`?N e\n\n?\n\n?\n\n?\n\n?\n\n?x N`\n?y N`\n?z N`\n\n?\n\n?\n\n?\n\n?\n\n??e\n`\n\n. (3.26)\n\nNo entanto, uma vez que as fun\u00e7\u00f5es de forma s\u00e3o definidas em rela\u00e7\u00e3o\n\n\u00e0s coordenadas locais, as derivadas parciais na equa\u00e7\u00e3o (3.26) n\u00e3o podem\n\nser obtidas diretamente. Para obt\u00ea-las, deve-se fazer uso da regra da cadeia\n\npara deriva\u00e7\u00e3o de fun\u00e7\u00f5es compostas. Dessa forma, por exemplo, para a\n\nderivada ??N` pode ser obtida a express\u00e3o\n\n??N` = ??x \u00b7 ?x N` + ??y \u00b7 ?y N` + ??z \u00b7 ?z N` . (3.27)\n\nRela\u00e7\u00f5es equivalentes podem tamb\u00e9m ser obtidas para as derivadas\n\nparciais ??N` e ??N` . As tr\u00eas express\u00f5es podem ser reunidas para formar\na equa\u00e7\u00e3o matricial\n\n?\n\n?\n\n?\n\n?\n\n??N`\n??N`\n??N`\n\n?\n\n?\n\n?\n\n?\n\n=\n\n?\n\n?\n\n?\n\n?\n\n??x ??y ??z\n\n??x ??y ??z\n\n??x ??y ??z\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?x N`\n?y N`\n?z N`\n\n?\n\n?\n\n?\n\n?\n\n. (3.28)\n\nA matriz presente no lado direito desta \u00faltima equa\u00e7\u00e3o \u00e9 a transposta\n\nda matriz jacobiana, conforme se pode comprovar observando a defini\u00e7\u00e3o\n\ndessa matriz, na equa\u00e7\u00e3o (3.3). Logo, a equa\u00e7\u00e3o (3.28) pode ser reescrita\n\ncomo\n?\n\n?\n\n?\n\n?\n\n??N`\n??N`\n??N`\n\n?\n\n?\n\n?\n\n?\n\n= JT\n\n?\n\n?\n\n?\n\n?\n\n?x N`\n?y N`\n?z N`\n\n?\n\n?\n\n?\n\n?\n\n, (3.29)\n\nda qual se deduz\n?\n\n?\n\n?\n\n?\n\n?x N`\n?y N`\n?z N`\n\n?\n\n?\n\n?\n\n?\n\n= J?T\n\n?\n\n?\n\n?\n\n?\n\n??N`\n??N`\n??N`\n\n?\n\n?\n\n?\n\n?\n\n, (3.30)\n\nem que J?T \u00e9 uma nota\u00e7\u00e3o reduzida para a inversa da transposta da matriz\njacobiana.\n\nA equa\u00e7\u00e3o (3.30) pode agora ser substitu\u00edda na equa\u00e7\u00e3o (3.25), obtendo-\n\nse ent\u00e3o a express\u00e3o\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 58\n\n?? = J?T\n?\n\n`?N e\n\n?\n\n?\n\n?\n\n?\n\n??N`\n??N`\n??N`\n\n?\n\n?\n\n?\n\n?\n\n??e\n`\n\n, (3.31)\n\na qual pode ser reescrita na forma matricial equivalente\n\n?? = J?T\n\n?\n\n?\n\n?\n\n?\n\n??N1 ??N2 \u00b7\u00b7\u00b7 ??NN en\n??N1 ??N2 \u00b7\u00b7\u00b7 ??NN en\n??N1 ??N2 \u00b7\u00b7\u00b7 ??NN en\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n??e1\n??e2\n\n...\n\n??eNn\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n. (3.32)\n\nNa segunda matriz do lado direito desta equa\u00e7\u00e3o \u00e9 poss\u00edvel reconhe-\n\ncer a transposta da matriz D, definida anteriormente na equa\u00e7\u00e3o (3.7).\nDefinindo, ainda, o vetor de valores nodais da vari\u00e1vel ? como\n\n??\ne\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n??e1\n??e2\n\n...\n\n??eNn\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n, (3.33)\n\n\u00e9 poss\u00edvel escrever a express\u00e3o final, mais compacta, para a aproxima\u00e7\u00e3o\n\ndo gradiente em um ponto qualquer de um elemento\n\n??(?,?,?) = J?TDT??\ne\n\n. (3.34)\n\n3.6 Esquemas de interpola\u00e7\u00e3o espacial\nNa discretiza\u00e7\u00e3o de uma equa\u00e7\u00e3o de conserva\u00e7\u00e3o \u00e9 necess\u00e1rio tamb\u00e9m\n\naproximar valores de uma vari\u00e1vel em locais diferentes aos dos n\u00f3s. Uma\n\nvez que a forma fechada das equa\u00e7\u00f5es discretizadas apenas pode conter\n\nvalores nodais das vari\u00e1veis, torna-se necess\u00e1rio o emprego de esquemas\n\nde interpola\u00e7\u00e3o, para relacionar valores em pontos espec\u00edficos dos elemen-\n\ntos, geralmente localizados sobre as faces, com os valores nodais.\n\nO caso mais importante surge na aproxima\u00e7\u00e3o do fluxo advectivo em\n\numa equa\u00e7\u00e3o de conserva\u00e7\u00e3o. O fluxo advectivo na superf\u00edcie de um vo-\n\nlume de controle \u00e9 representado matematicamente por uma integral de\n\nsuperf\u00edcie como a considerada na se\u00e7\u00e3o 3.4.2. Nessa integral, a densidade\n\nde fluxo \u00e9 usualmente dada por ?=?v?, onde ? e v s\u00e3o a densidade do\nfluido e a velocidade do escoamento que transporta a grandeza intensiva\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 59\n\n?, respectivamente. Quando a essa integral \u00e9 aplicada a aproxima\u00e7\u00e3o dada\npela equa\u00e7\u00e3o (3.22), torna-se evidente a necessidade de aproximar valores\n\nde vari\u00e1vel nos baricentros das faces, isto \u00e9, valores de ??f .\nEm um m\u00e9todo de volumes baseado em elementos, um esquema de\n\ninterpola\u00e7\u00e3o \u00e9 geralmente restrito aos valores nodais associados a um ele-\n\nmento. Assim, a express\u00e3o mais geral para um esquema de interpola\u00e7\u00e3o\n\npara o valor de uma vari\u00e1vel no baricentro de uma face \u00e9\n\n??f ?\n?\n\n`?N e\n?ef,`??\n\ne\n`\n\n, (3.35)\n\nem que ?ef,` s\u00e3o coeficientes escalares que ponderam a influ\u00eancia de cada\n\nvalor nodal sobre o valor interpolado na face. O n\u00famero de coeficientes\n\nnecess\u00e1rios para esta interpola\u00e7\u00e3o \u00e9 igual ao n\u00famero de n\u00f3s associados\n\nao elemento e onde a face se encontra. Por exemplo, em um esquema\n\nde interpola\u00e7\u00e3o equivalente \u00e0 aproxima\u00e7\u00e3o empregada para o c\u00f4mputo\n\ndo gradiente, os valores dos coeficientes de interpola\u00e7\u00e3o seriam iguais aos\n\nvalores das fun\u00e7\u00f5es de forma nos baricentros das faces, isto \u00e9,\n?\n\n?ef,`\n\n?\n\nforma\n= N`(??f ,??f ,??f ) , (3.36)\n\nem que ??f ,??f e ??f s\u00e3o as coordenadas locais do baricentro da face f .\n\nEmbora seja poss\u00edvel empregar este tipo de interpola\u00e7\u00e3o na aproxi-\n\nma\u00e7\u00e3o do termo advectivo, sua utiliza\u00e7\u00e3o n\u00e3o \u00e9 aconselh\u00e1vel. Essa pr\u00e1tica\n\n\u00e9 equivalente ao uso de esquemas de diferen\u00e7as centrais em formula\u00e7\u00f5es\n\nconvencionais de volumes finitos, portanto, usualmente d\u00e1 origem a coefi-\n\ncientes negativos na forma final das equa\u00e7\u00f5es discretizadas [67]. Conforme\n\u00e9 relatado extensamente na literatura [42, 44, 45, 59, 60], problemas de\nmonotonicidade e de oscila\u00e7\u00f5es esp\u00farias s\u00e3o comumente consequ\u00eancia\n\ndireta da presen\u00e7a desses coeficientes.\n\nO esquema de interpola\u00e7\u00e3o mais empregado para os termos advec-\n\ntivos, na simula\u00e7\u00e3o de reservat\u00f3rios, \u00e9 o esquema upwind de um ponto\n\n[3] ou esquema donor cell [44]. Nesse esquema, o valor nodal localizado\na montante de uma interface, levando em conta o sentido do escoamento\n\nque a atravessa, \u00e9 atribu\u00eddo integralmente como valor interpolado nessa\n\ninterface. Essa aproxima\u00e7\u00e3o possui precis\u00e3o de primeira ordem e preserva\n\na monotonicidade de solu\u00e7\u00f5es discretas inicialmente monot\u00f4nicas [78].\nPortanto, produz solu\u00e7\u00f5es fisicamente coerentes, embora apresentando\n\nforte difus\u00e3o num\u00e9rica [45].\n\n\n\nA SPECTO S N UM \u00c9R ICO S B\u00c1 SICO S 60\n\nNo contexto de um m\u00e9todo de volumes finitos baseado em elementos,\n\no esquema upwind de um ponto, denotado daqui em diante com a sigla\n\nSPU,8 pode ser definido matematicamente pela express\u00e3o\n\n?\n\n??f\n?\n\nSPU\n=\n\n\u00a8\n\n??nB(f ) se (?v)?f \u00b7?Sf > 0 ,\n??nF(f ) se (?v)?f \u00b7?Sf &lt;0 ,\n\n(3.37)\n\nna qual, igual que na equa\u00e7\u00e3o (3.21), nB(f ) e nF(f ) \u00e9 uma nota\u00e7\u00e3o para os\n\nn\u00f3s localizados detr\u00e1s e a frente da face f , de acordo com a orienta\u00e7\u00e3o\n\nabsoluta da face. Al\u00e9m disso, (?v)?f \u00b7?Sf \u00e9 a vaz\u00e3o que atravessa a face,\nda qual somente \u00e9 considerado seu sinal. Os dois casos considerados na\n\nequa\u00e7\u00e3o (3.37) encontram-se ilustrados esquematicamente na figura 3.11.\n\nTodos os coeficientes ?ef,` associados ao esquema SPU s\u00e3o nulos, exceto\n\naquele associado ao n\u00f3 a montante, o qual adquire um valor unit\u00e1rio.\n\nArestaN\u00f3 a montante\n\nN\u00f3 a montante\n\n(a)\n\n(b)\n\nFace f\n\nFigura 3.11 \u2013 Os dois casos na interpola\u00e7\u00e3o upwind de um ponto (SPU).\n\n8 Do ingl\u00eas Single Point Upwind.\n\n\n\nCAP\u00cdTULO\n\n4\nDiscretiza\u00e7\u00e3o de uma equa\u00e7\u00e3o\nde conserva\u00e7\u00e3o\n\n4.1 Equa\u00e7\u00e3o de conserva\u00e7\u00e3o gen\u00e9rica\nA fim de mostrar de forma objetiva a aplica\u00e7\u00e3o das aproxima\u00e7\u00f5es num\u00e9ri-\n\ncas apresentadas no cap\u00edtulo anterior, neste cap\u00edtulo ser\u00e1 descrita, passo a\n\npasso, a discretiza\u00e7\u00e3o de uma equa\u00e7\u00e3o de conserva\u00e7\u00e3o gen\u00e9rica. A equa-\n\n\u00e7\u00e3o de conserva\u00e7\u00e3o de uma grandeza escalar \u00e9 considerada aqui um pro-\n\nt\u00f3tipo das equa\u00e7\u00f5es que formam parte dos diferentes modelos de escoa-\n\nmento em reservat\u00f3rios de petr\u00f3leo. Ap\u00f3s ser descrita a obten\u00e7\u00e3o da forma\n\ndiscretizada dessa equa\u00e7\u00e3o, ser\u00e1 abordado o procedimento de montagem\n\ndo sistema linear de equa\u00e7\u00f5es resultante da discretiza\u00e7\u00e3o em todos os vo-\n\nlumes de controle de uma malha. A descri\u00e7\u00e3o detalhada desses procedi-\n\nmentos, aplicados a uma equa\u00e7\u00e3o simples como a equa\u00e7\u00e3o de conserva-\n\n\u00e7\u00e3o de uma grandeza escalar, servir\u00e1 como fundamento para a posterior\n\naplica\u00e7\u00e3o a um modelo de escoamento multif\u00e1sico em reservat\u00f3rios de\n\npetr\u00f3leo.\n\n61\n\n\n\nDISC R ET IZ A\u00c7\u00c3O DE UM A EQUA\u00c7 \u00c3O DE CO NSERVA\u00c7\u00c3O 62\n\nA forma diferencial da equa\u00e7\u00e3o de conserva\u00e7\u00e3o de uma grandeza es-\n\ncalar ?, associada ao escoamento de um fluido e expressa por unidade de\nmassa, pode ser escrita de forma gen\u00e9rica como [20]\n\n? (??)\n?t\n\n+? \u00b7 (??v) = ? \u00b7 (K??) +? . (4.1)\n\nNesta equa\u00e7\u00e3o, ? \u00e9 a densidade do fluido, v \u00e9 a sua velocidade e K\no coeficiente de difusividade da grandeza ?, expressa como um tensor\nde segunda ordem.1 A equa\u00e7\u00e3o 4.1 representa um balan\u00e7o da grandeza\n\n? em um volume de controle infinitesimal. O primeiro termo do lado\nesquerdo representa a varia\u00e7\u00e3o temporal da grandeza gen\u00e9rica no volume.\n\nO segundo termo representa o transporte advectivo atrav\u00e9s da superf\u00edcie\n\ndo volume infinitesimal. O primeiro termo no lado direito representa o\n\ntransporte difusivo atrav\u00e9s da mesma superf\u00edcie. Por fim, o termo ? \u00e9\n\no termo fonte da equa\u00e7\u00e3o, o qual leva em conta qualquer mecanismo de\n\ngera\u00e7\u00e3o, convers\u00e3o ou transporte da grandeza ? n\u00e3o considerado explici-\ntamente nos outros termos da equa\u00e7\u00e3o.\n\nO ponto de partida para a aplica\u00e7\u00e3o de um m\u00e9todo de volumes finitos\n\n\u00e9 geralmente a forma integral de uma equa\u00e7\u00e3o de conserva\u00e7\u00e3o. Para a\n\nequa\u00e7\u00e3o (4.1), a forma integral equivalente \u00e9 [20]\n\n?\n\n?t\n\n?\n\nV\n\n?? dV +\n\n?\n\nS\n\n??v \u00b7 dS =\n?\n\nS\n\nK?? \u00b7 dS +\n?\n\nV\n\n?dV . (4.2)\n\nEsta equa\u00e7\u00e3o corresponde ao balan\u00e7o em um volume de controle V ,\nlimitado por uma superf\u00edcie fechada S , fixo em uma regi\u00e3o do espa\u00e7o pela\nqual escoa um fluido [8]. Tal como ilustra a figura 4.1, dS \u00e9 um vetor\ndiferencial de \u00e1rea sobre a superf\u00edcie S , dirigido na dire\u00e7\u00e3o normal a ela\ne apontando para o exterior do volume.\n\nExiste uma correspond\u00eancia termo a termo entre as equa\u00e7\u00f5es (4.1) e\n\n(4.2). Entretanto, a forma diferencial \u00e9 mais restritiva no sentido de n\u00e3o\n\nadmitir solu\u00e7\u00f5es apresentando descontinuidades, tais como ondas de cho-\n\nque ou interfaces entre fluidos imisc\u00edveis [8, 44]. Uma vez que a forma in-\ntegral n\u00e3o possui restri\u00e7\u00f5es em rela\u00e7\u00e3o a descontinuidades, ela \u00e9 preferida\n\ncomo base da maioria das formula\u00e7\u00f5es num\u00e9ricas [8].\n\n1 Em uma equa\u00e7\u00e3o de conserva\u00e7\u00e3o associada \u00e0 descri\u00e7\u00e3o de um escoamento em um\nreservat\u00f3rio, K representaria a permeabilidade do meio.\n\n\n\nDISC R ET IZ A\u00c7\u00c3O DE UM A EQUA\u00c7 \u00c3O DE CO NSERVA\u00c7\u00c3O 63\n\nFigura 4.1 \u2013 Volume de controle em um escoamento.\n\n4.2 Discretiza\u00e7\u00e3o\n\nA equa\u00e7\u00e3o (4.2) pode ser aplicada diretamente a um volume de controle\n\npoli\u00e9drico como os obtidos com os procedimentos descritos na se\u00e7\u00e3o 2.4.\n\nNeste caso, conforme a nota\u00e7\u00e3o apresentada na se\u00e7\u00e3o 3.2, considerar-se-\n\n\u00e1 um volume de controle Vp , limitado pela superf\u00edcie Sp . Nas subse\u00e7\u00f5es\nseguintes ser\u00e1 descrita a discretiza\u00e7\u00e3o dos diferentes termos da equa\u00e7\u00e3o\n\nintegral de conserva\u00e7\u00e3o, aplicando as aproxima\u00e7\u00f5es apresentadas ante-\n\nriormente no cap\u00edtulo 3.\n\n4.2.1 Termo de transporte advectivo\n\nPara a aproxima\u00e7\u00e3o num\u00e9rica dos termos de transporte, inicialmente ser\u00e1\n\nconsiderado um volume de controle localizado no interior do dom\u00ednio, ou\n\nseja, um volume que n\u00e3o possui faces de contorno (bFp = ;). A contribui-\n\u00e7\u00e3o das faces de contorno ser\u00e1 considerada posteriormente como parte\n\ndas condi\u00e7\u00f5es de contorno do problema.\n\nA aplica\u00e7\u00e3o da equa\u00e7\u00e3o (3.22), com ? = ?v?, da origem \u00e0 seguinte\naproxima\u00e7\u00e3o para o termo advectivo na forma integral da equa\u00e7\u00e3o de con-\n\nserva\u00e7\u00e3o\n?\n\nSp\n\n??v \u00b7 dS ?\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?f , p (??v)?f \u00b7?Sf . (4.3)\n\n\n\nDISC R ET IZ A\u00c7\u00c3O DE UM A EQUA\u00c7 \u00c3O DE CO NSERVA\u00c7\u00c3O 64\n\nAinda, ap\u00f3s definir o fluxo de massa pela face como m? f ? (?v)?f \u00b7?Sf ,\na aproxima\u00e7\u00e3o pode ser escrita na forma mais compacta\n\n?\n\nSp\n\n??v \u00b7 dS ?\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?f , p m? f ??f . (4.4)\n\nA forma final da aproxima\u00e7\u00e3o do termo advectivo \u00e9 obtida substituindo\n\na express\u00e3o utilizada para interpolar os valores da vari\u00e1vel nas faces, em\n\nfun\u00e7\u00e3o de valores nodais. Aqui ser\u00e1 empregada a express\u00e3o geral dada pela\n\nequa\u00e7\u00e3o (3.35), com a qual obt\u00e9m-se\n\n?\n\nSp\n\n??v \u00b7 dS ?\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?\n\n`?N e\n?f , p m? f ?\n\ne\nf,`??\n\ne\n`\n\n. (4.5)\n\n4.2.2 Termo de transporte difusivo\n\nAplicando desta vez a equa\u00e7\u00e3o (3.22) com ? = K??, obt\u00e9m-se a seguinte\nexpress\u00e3o aproximada para o termo difusivo da equa\u00e7\u00e3o de conserva\u00e7\u00e3o\n\n?\n\nSp\n\nK?? \u00b7 dS ?\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?f , p (K??)?f \u00b7?Sf . (4.6)\n\nA fim de aproximar o fluxo difusivo em cada face da superf\u00edcie de con-\n\ntrole, pode-se agora substituir a express\u00e3o aproximada para o gradiente,\n\ndada na equa\u00e7\u00e3o (3.34). Al\u00e9m disso, para facilitar a posterior manipula-\n\n\u00e7\u00e3o alg\u00e9brica, o produto escalar que determina o fluxo pode ser escrito\n\nutilizando a representa\u00e7\u00e3o alternativa a \u00b7 b = a Tb , obtendo-se a rela\u00e7\u00e3o\naproximada\n\n(K??)?f \u00b7?Sf ?\n?\n\nK?f J\n?T\n?f\n\nDT?f ??\ne\n?T\n?Sf . (4.7)\n\nUma vez que a aproxima\u00e7\u00e3o da integral de superf\u00edcie na face requer\n\nque o gradiente seja avaliado no baricentro da face, tanto a matriz jaco-\n\nbiana J como a matriz D s\u00e3o avaliadas nesse ponto. Al\u00e9m disso, K?f \u00e9 o\ncoeficiente de difusividade no mesmo ponto.2\n\n2 Na simula\u00e7\u00e3o de reservat\u00f3rios, K representa a permeabilidade absoluta, uma propri-\nedade do meio poroso no qual acontece o escoamento. Na representa\u00e7\u00e3o discreta da\nvaria\u00e7\u00e3o espacial dessa grandeza, \u00e9 conveniente associar a cada elemento um valor \u00fanico\nde permeabilidade, a fim de evitar descontinuidades nas faces.\n\n\n\nDISC R ET IZ A\u00c7\u00c3O DE UM A EQUA\u00c7 \u00c3O DE CO NSERVA\u00c7\u00c3O 65\n\nJ\u00e1 que o produto escalar de dois vetores \u00e9 comutativo, isto \u00e9, a Tb =\nb Ta , a equa\u00e7\u00e3o (4.7) pode ser rescrita como\n\n(K??)?f \u00b7?Sf ? ?S\nT\nf K?f J\n\n?T\n?f\n\nDT?f ??\ne\n\n. (4.8)\n\nEsta forma da aproxima\u00e7\u00e3o do fluxo difusivo em uma face permite\n\ndefinir o operador\n?\n\n?ef\n\n?T\n? ?STf K?f J\n\n?T\n?f\n\nDT?f , (4.9)\n\ncom o qual o fluxo em uma face pode ser escrito como\n\n(K??)?f \u00b7?Sf ?\n?\n\n?ef\n\n?T\n??\n\ne\n=\n?\n\n`?N e\n?ef,`??\n\ne\n`\n\n, (4.10)\n\nonde ?ef,` s\u00e3o as componentes do operador\n?\n\n?ef\n\n?T\n, o qual \u00e9 um vetor de\n\ndimens\u00e3o igual ao n\u00famero de n\u00f3s do elemento ao qual a face em ques-\n\nt\u00e3o pertence. Introduzindo essa aproxima\u00e7\u00e3o na equa\u00e7\u00e3o (4.6), resulta a\n\nexpress\u00e3o final para a aproxima\u00e7\u00e3o do termo difusivo\n\n?\n\nSp\n\nK?? \u00b7 dS ?\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?\n\n`?N e\n?f , p ?\n\ne\nf,` ??\n\ne\n`\n\n. (4.11)\n\n4.2.3 Integra\u00e7\u00e3o temporal\n\nPara completar a discretiza\u00e7\u00e3o da equa\u00e7\u00e3o integral (4.2), resta aproximar\n\nos termos representados por integrais de volume. Ap\u00f3s aplicar a aproxima-\n\n\u00e7\u00e3o dada na equa\u00e7\u00e3o (3.12) para ambas as integrais e substituir, al\u00e9m disso,\n\nas aproxima\u00e7\u00f5es dos termos de transporte advectivo e difusivo, obt\u00e9m-se\n\na equa\u00e7\u00e3o\n\n?\n\n?t\n\n?\n\nMp??p\n?\n\n+\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?\n\n`?N e\n?f , p m? f ?\n\ne\nf,`??\n\ne\n`\n=\n\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?\n\n`?N e\n?f , p ?\n\ne\nf,` ??\n\ne\n`\n+ ??p ?Vp ,\n\n(4.12)\n\nna qual tem-se introduzido o par\u00e2metro Mp ? ?p ?Vp , o qual representa\na massa de fluido contida no volume de controle.\n\n\n\nDISC R ET IZ A\u00c7\u00c3O DE UM A EQUA\u00c7 \u00c3O DE CO NSERVA\u00c7\u00c3O 66\n\nA equa\u00e7\u00e3o (4.12) deve ser ainda integrada no tempo para poder ser\n\nobtida a vers\u00e3o final da equa\u00e7\u00e3o em n\u00edvel discreto. Ap\u00f3s levar o termo de\n\nfluxo advectivo para o lado direito da equa\u00e7\u00e3o e integrar todos os termos\n\nentre nos n\u00edveis discretos de tempo t m?1 e t m , chega-se a\n\nMp??p\n?\n\n?\n\nt m\nt m?1\n\n=\n\n? t m\n\nt m?1\n\n?\n\n?\n\n?\n\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?\n\n`?N e\n?f , p\n\n?\n\n?ef,`?m? f ?\ne\nf,`\n\n?\n\n??e\n`\n+ ??p ?Vp\n\n?\n\n?\n\n?\ndt .\n\n(4.13)\n\nA integral do lado direito deve agora ser aproximada numericamente\n\nem fun\u00e7\u00e3o de valores nos n\u00edveis de tempo t m e/ou t m?1. Nesta opera\u00e7\u00e3o\nqualquer uma das abordagens empregadas ordinariamente em m\u00e9todos\n\nconvencionais de volumes finitos pode ser considerada [8, 20, 45]. Como\nexemplo, a seguir ser\u00e1 considerada a abordagem totalmente impl\u00edcita [45],\nna qual a integral \u00e9 aproximada avaliando o integrando no n\u00edvel de tempo\n\nt m e multiplicando-o pelo intervalo ?t m ? t m ?t m?1. Ou seja\n\nbMp cmb??p cm ? bMp cm?1b??p cm?1 =\n?\n\n?\n\n?\n\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?\n\n`?N e\n?f , p\n\n?\n\n?ef,`?bm? f ?\ne\nf,`c\n\nm\n?\n\nb??e\n`\ncm + b??p cm?Vp\n\n?\n\n?\n\n?\n?tm .\n\n(4.14)\n\nEsta equa\u00e7\u00e3o pode ser rearranjada convenientemente, levando todos\n\nos termos associados a valores nodais da vari\u00e1vel no n\u00edvel de tempo t m ao\n\nlado esquerdo e todos os restantes termos ao lado direito. Isto \u00e9\n\nbMp cmb??p cm ? ?tm\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?\n\n`?N e\n?f , p\n\n?\n\n?ef,`?bm? f ?\ne\nf,`c\n\nm\n?\n\nb??e\n`\ncm =\n\nbMp cm?1b??p cm?1 + b??p cm?Vp ?tm .\n(4.15)\n\nAssumiu-se que o termo fonte da equa\u00e7\u00e3o de conserva\u00e7\u00e3o independe\n\nda vari\u00e1vel ?. Caso exista essa depend\u00eancia mediante uma rela\u00e7\u00e3o n\u00e3o-\nlinear, pode ser necess\u00e1rio realizar uma lineariza\u00e7\u00e3o do termo fonte, con-\n\nforme explicado em [45, 59].\nA equa\u00e7\u00e3o (4.15) \u00e9 a forma fechada da equa\u00e7\u00e3o discretizada de conser-\n\nva\u00e7\u00e3o, uma vez que apenas cont\u00e9m valores nodais da vari\u00e1vel inc\u00f3gnita.\n\nOs n\u00f3s que participam desta equa\u00e7\u00e3o s\u00e3o somente aqueles associados aos\n\n\n\nDISC R ET IZ A\u00c7\u00c3O DE UM A EQUA\u00c7 \u00c3O DE CO NSERVA\u00c7\u00c3O 67\n\nelementos que contribuem na forma\u00e7\u00e3o do volume de controle. Esses n\u00f3s\n\nformam o denominado est\u00eancil ou mol\u00e9cula computacional [8, 20] N p da\nequa\u00e7\u00e3o, na qual apenas os coeficientes associados a inc\u00f3gnitas nesses n\u00f3s\n\napresentar\u00e3o valores n\u00e3o-nulos. A equa\u00e7\u00e3o (4.15) pode ser escrita tamb\u00e9m\n\nna forma mais usual em um m\u00e9todo de volumes finitos,\n\nA pb??p cm +\n?\n\nn?N p\nn 6=p\n\nA nb??n cm = b p , (4.16)\n\nna qual, A p \u00e9 o coeficiente central da equa\u00e7\u00e3o, associado ao n\u00f3 localizado\n\nno interior do volume de controle, o qual re\u00fane contribui\u00e7\u00f5es de todos\n\nos elementos ao redor. Al\u00e9m disso, A n s\u00e3o os coeficientes associados aos\n\nrestantes n\u00f3s no est\u00eancil da equa\u00e7\u00e3o, que envolvem contribui\u00e7\u00f5es dos ter-\n\nmos de fluxo. Finalmente, b p \u00e9 o termo independente que, para a equa\u00e7\u00e3o\n\n(4.16), inclui as duas parcelas do lado direito.\n\nA figura 4.2 ilustra a estrutura da equa\u00e7\u00e3o (4.16), mediante um exem-\n\nplo em uma malha bidimensional simples. As equa\u00e7\u00f5es em malhas tri-\n\ndimensionais apresentam exatamente a mesma estrutura, por\u00e9m, geral-\n\nmente com est\u00eanceis envolvendo maior quantidade de n\u00f3s. Quando reu-\n\nnidas as equa\u00e7\u00f5es de todos os volumes de controle em uma malha, obt\u00e9m-\n\nse um sistema de equa\u00e7\u00f5es, o qual pode ser expresso de forma geral como\n\nAb??cm = b , (4.17)\n\nonde A \u00e9 a matriz de coeficientes, b \u00e9 o vetor de termos independentes\ne b??cm o vetor de valores nodais da vari\u00e1vel para o n\u00edvel de tempo t m .\nConforme mostra a figura 4.2, as componentes da matriz e dos vetores\n\nno sistema de equa\u00e7\u00f5es est\u00e3o organizados segundo os \u00edndices globais que\n\nidentificam aos n\u00f3s e volumes de controle na malha. Ap\u00f3s incluir a repre-\n\nsenta\u00e7\u00e3o discreta das condi\u00e7\u00f5es de contorno do problema sendo resolvido,\n\no sistema de equa\u00e7\u00f5es permite determinar uma aproxima\u00e7\u00e3o do campo\n\nassociado \u00e0 vari\u00e1vel ? no n\u00edvel de tempo t m .\nA solu\u00e7\u00e3o transiente da equa\u00e7\u00e3o (4.2) pode ser obtida resolvendo uma\n\nsequ\u00eancia de sistemas de equa\u00e7\u00f5es, cada sistema associado a um n\u00edvel de\n\ntempo discreto, mediante um procedimento de marcha [45]. Caso existam\nn\u00e3o-linearidades e/ou acoplamento com outras equa\u00e7\u00f5es, poder\u00e1 ser ne-\ncess\u00e1rio considerar um n\u00edvel iterativo adicional em cada n\u00edvel de tempo,\n\nconforme explicado em [20, 45].\n\n\n\nDISC R ET IZ A\u00c7\u00c3O DE UM A EQUA\u00c7 \u00c3O DE CO NSERVA\u00c7\u00c3O 68\n\n1\n2\n\n3\n4 5\n\n6\n7\n\n8\n9 10\n\n11\n12\n\n13 14\n\nSistema de equa\u00e7\u00f5es discretizadas\n\nEqua\u00e7\u00e3o parao volume 7\n\n=\n1234567891011121314 1 2 3 4 5 6 7 8 9 10 11 12 13 14\n\nFigura 4.2 \u2013 Estrutura da equa\u00e7\u00e3o discretizada para um volume de controle\nem uma malha simples.\n\n4.3 Montagem do sistema de equa\u00e7\u00f5es\nA montagem dos sistemas de equa\u00e7\u00f5es discretizadas pode ser sistemati-\n\nzado a fim de tornar mais eficiente sua implementa\u00e7\u00e3o computacional. A\n\nseguir \u00e9 descrito um dos procedimentos poss\u00edveis, com base na equa\u00e7\u00e3o\n\n(4.15). O procedimento envolve duas etapas, uma relativa \u00e0s contribui\u00e7\u00f5es\n\ndos termos de fluxo e outra relacionada aos restantes termos.\n\nQuanto aos termos de fluxo, sua representa\u00e7\u00e3o na equa\u00e7\u00e3o (4.15) su-\n\ngere um procedimento de montagem em que, para cada volume de con-\n\ntrole p , devem ser visitados os elementos e ? Ep , as faces f ? F ep e os n\u00f3s\nlocais `? N e . Entretanto, isto implica que um mesmo elemento deva ser\n\n\n\nDISC R ET IZ A\u00c7\u00c3O DE UM A EQUA\u00c7 \u00c3O DE CO NSERVA\u00c7\u00c3O 69\n\nvisitado v\u00e1rias vezes, dado que contribuir\u00e1 na forma\u00e7\u00e3o de v\u00e1rios volumes\n\nde controle, possivelmente repetindo-se v\u00e1rios c\u00e1lculos de forma desne-\n\ncess\u00e1ria. Para a implementa\u00e7\u00e3o computacional da montagem do sistema\n\nde equa\u00e7\u00f5es \u00e9 mais vantajoso um procedimento em que, cada vez que um\n\nelemento \u00e9 visitado, todas as contribui\u00e7\u00f5es associadas a ele sejam calcula-\n\ndas e adicionadas em posi\u00e7\u00f5es adequadas da matriz de coeficientes.\n\nA figura 4.3 ilustra, de modo esquem\u00e1tico, a contribui\u00e7\u00e3o de um ele-\n\nmento quadril\u00e1tero nos coeficientes das equa\u00e7\u00f5es discretizadas associa-\n\ndas aos quatro volumes de controle dos quais forma parte.3 De acordo \u00e0\n\nnumera\u00e7\u00e3o global considerada no exemplo, o elemento contribui \u00e0s equa-\n\n\u00e7\u00f5es dos volumes ao redor dos n\u00f3s 3, 6, 7 e 9, cujos coeficientes devem\n\nestar localizados, respectivamente, nas linhas 3, 6, 7 e 9 da matriz de coe-\n\nficientes. Em cada uma dessas equa\u00e7\u00f5es existir\u00e3o coeficientes associados\n\naos valores nodais da vari\u00e1vel no elemento em quest\u00e3o. Isto quer dizer que\n\nhaver\u00e1 contribui\u00e7\u00f5es nos coeficientes localizados nas colunas 3, 6, 7 e 9,\n\numa vez que os coeficientes nessas colunas multiplicam, respectivamente,\n\nos valores nodais ??e3 , ??\ne\n6 , ??\n\ne\n7\n\ne ??e9 .\n\n\u00c9 importante notar, no entanto, que as contribui\u00e7\u00f5es de um elemento\n\naos termos de fluxo prov\u00eam, em realidade, de contribui\u00e7\u00f5es das faces no\n\ninterior do elemento. Conforme a figura 4.4 mostra esquematicamente,\n\numa face contribui nas equa\u00e7\u00f5es dos dois volumes adjacentes. Essa situa-\n\n\u00e7\u00e3o acontece tanto em elementos bidimensionais quanto tridimensionais,\n\npois uma face sempre separa dois volumes. Um algoritmo que percorra as\n\nfaces de um elemento para fazer a montagem dos coeficientes da matriz A\npode aproveitar essa caracter\u00edstica e atribuir diretamente o sinal correto \u00e0s\n\ncontribui\u00e7\u00f5es. Esse sinal, que na equa\u00e7\u00e3o (4.15) est\u00e1 dado pelo par\u00e2metro\n\n?f , p , ser\u00e1 sempre positivo para um dos volumes adjacentes a uma face e\n\nnegativo para o outro. Um algoritmo dessa natureza \u00e9 esbo\u00e7ado a seguir:\n\n1: para todos os elementos e ? M\n2: para todas as faces f ? F e\n\n3: para todos os n\u00f3s `? N e\n\n4: c ? (?ef,`?bm? f ?\ne\nf,`c\n\nm)?tm\n5: A nB(f ), g(`)? A nB(f ), g(`) + c\n6: A nF(f ), g(`)? A nF(f ), g(`) ? c\n\n3 A situa\u00e7\u00e3o \u00e9 completamente equivalente para um elemento tridimensional, apenas com\nmaior n\u00famero de volumes de controle e n\u00f3s envolvidos.\n\n\n\nDISC R ET IZ A\u00c7\u00c3O DE UM A EQUA\u00c7 \u00c3O DE CO NSERVA\u00c7\u00c3O 70\n\nSistema de equa\u00e7\u00f5es discretizadas\n\n=\n1234567891011121314 1 2 3 4 5 6 7 8 9 10 11 12 13 14\n\n1\n2\n\n3\n4 5\n\n6\n\n7\n\n8\n9 10\n\n11\n12\n\n13 14\n\nFigura 4.3 \u2013 Contribui\u00e7\u00f5es de um elemento no sistema de equa\u00e7\u00f5es discre-\ntizadas.\n\nNeste algoritmo, assume-se que os valores dos fluxos de massa e dos\n\noperadores ?ef,` e ?\ne\nf,` encontram-se dispon\u00edveis e com eles \u00e9 calculada a\n\ncontribui\u00e7\u00e3o c de uma face. Essa contribui\u00e7\u00e3o \u00e9 adicionada no coeficiente\n\nA nB(f ), g(`) , correspondente ao n\u00f3 localizado atr\u00e1s da face, e subtra\u00edda do\n\ncoeficiente A nF(f ), g(`) , correspondente ao n\u00f3 localizado \u00e0 frente da face.\n\nNo contexto do algoritmo anterior, nB(f ) e nF(f ) s\u00e3o fun\u00e7\u00f5es que forne-\n\ncem os \u00edndices globais dos n\u00f3s (ou volumes de controle) atr\u00e1s e \u00e0 frente\n\nda face f , considerando sua orienta\u00e7\u00e3o absoluta, conforme discutido na\n\nse\u00e7\u00e3o 3.4.2. Esses \u00edndices indicam a linha da matriz onde as contribui\u00e7\u00f5es\n\ndevem ser acrescidas ou subtra\u00eddas. J\u00e1 a localiza\u00e7\u00e3o da coluna na matriz \u00e9\n\ndada pelo \u00edndice global do n\u00f3 considerado no ciclo sobre os n\u00f3s locais do\n\nelemento. Na nota\u00e7\u00e3o empregada, esse \u00edndice \u00e9 dado pela fun\u00e7\u00e3o g(`), que\n\n\n\nDISC R ET IZ A\u00c7\u00c3O DE UM A EQUA\u00c7 \u00c3O DE CO NSERVA\u00c7\u00c3O 71\n\nSistema de equa\u00e7\u00f5es discretizadas\n\nFace\n\n=\n1234567891011121314 1 2 3 4 5 6 7 8 9 10 11 12 13 14\n\n1\n2\n\n3\n4 5\n\n6\n8\n\n9 (      ) 10\n11\n\n12\n13 147 (      )\n\nFigura 4.4 \u2013 Contribui\u00e7\u00f5es de uma face na matriz de coeficientes.\n\ndeve extrair essa informa\u00e7\u00e3o da defini\u00e7\u00e3o da conectividade dos elementos\n\nda malha.\n\nPara concluir a montagem do sistema de equa\u00e7\u00f5es discretizadas, resta\n\nainda acrescentar as contribui\u00e7\u00f5es do termo fonte e do termo temporal.\n\nPara tanto \u00e9 necess\u00e1rio realizar um ciclo percorrendo todos os n\u00f3s da ma-\n\nlha, uma vez que essas contribui\u00e7\u00f5es dependem apenas de grandezas re-\n\nlativas aos n\u00f3s ou aos volumes de controle associados, como mostra a\n\nequa\u00e7\u00e3o (4.15). O ciclo pode ser implementado como esbo\u00e7ado a seguir:\n\n1: para todos os n\u00f3s p ? M\n2: A g(p), g(p)? A g(p), g(p) + bMp cm\n\n3: b g(p)?b g(p) + bMp cm?1b??p cm?1 + b??p cm?Vp ?tm\n\n\n\nDISC R ET IZ A\u00c7\u00c3O DE UM A EQUA\u00c7 \u00c3O DE CO NSERVA\u00c7\u00c3O 72\n\n4.4 Inclus\u00e3o de condi\u00e7\u00f5es de contorno\n\nA fim de completar a especifica\u00e7\u00e3o da formula\u00e7\u00e3o num\u00e9rica para um pro-\n\nblema f\u00edsico, a condi\u00e7\u00e3o inicial e as condi\u00e7\u00f5es de contorno devem ser in-\n\nclu\u00eddas no sistema de equa\u00e7\u00f5es discretizadas. A condi\u00e7\u00e3o inicial para um\n\nproblema transiente descrito por uma equa\u00e7\u00e3o como a (4.1) consiste na\n\ndistribui\u00e7\u00e3o espacial da vari\u00e1vel em t 0, a qual \u00e9 utilizada no primeiro in-\n\ntervalo de tempo para aproximar a derivada temporal em cada volume de\n\ncontrole. Na imposi\u00e7\u00e3o das condi\u00e7\u00f5es de contorno, a seguir ser\u00e3o descritos\n\nsucintamente os procedimentos adotados em duas situa\u00e7\u00f5es poss\u00edveis.\n\n4.4.1 Condi\u00e7\u00e3o de fluxo prescrito\n\nA situa\u00e7\u00e3o em que o valor do fluxo que atravessa uma fronteira \u00e9 conhe-\n\ncido, ou pode ser determinado em fun\u00e7\u00e3o de valores conhecidos, \u00e9 a mais\n\nsimples do ponto de vista operacional. A equa\u00e7\u00e3o semidiscretizada corres-\n\npondente a um volume de controle adjacente a uma fronteira desse tipo\n\nadquire a forma\n\n?\n\n?t\n\n?\n\nMp??p\n?\n\n+\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?\n\n`?N e\n?f , p m? f ?\n\ne\nf,`??\n\ne\n`\n+\n?\n\nbe?bEp\n\n?\n\nbf ?bF bep\n\n?bf =\n\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?\n\n`?N e\n?f , p ?\n\ne\nf,` ??\n\ne\n`\n+ ??p ?Vp ,\n\n(4.18)\n\nque \u00e9 a mesma equa\u00e7\u00e3o correspondente a um volume interno,4 exceto\n\npela inclus\u00e3o do termo correspondente ao fluxo na por\u00e7\u00e3o da superf\u00edcie de\n\ncontrole coincidente com a fronteira. Nesse termo, ?bf \u00e9 o fluxo total, isto\n\u00e9, o fluxo envolvendo advec\u00e7\u00e3o e difus\u00e3o, atrav\u00e9s de uma face de contorno\nbf . Em concord\u00e2ncia com a conven\u00e7\u00e3o anteriormente estabelecida, ?bf\n\u00e9 positivo quando abandona o volume de controle. A inclus\u00e3o de fluxos\n\ndessa natureza no sistema de equa\u00e7\u00f5es discretizadas, pode ser realizado\n\ncom o seguinte procedimento simples:\n\n1: para todos os elementos de contorno be ? B fluxo\n\n2: para todas as faces de contorno bf ? be\n3: b nC(bf )?b nC(bf ) ??bf\n\n4 Compare-se, por exemplo, com a equa\u00e7\u00e3o (4.12).\n\n\n\nDISC R ET IZ A\u00c7\u00c3O DE UM A EQUA\u00c7 \u00c3O DE CO NSERVA\u00c7\u00c3O 73\n\nNo procedimento esbo\u00e7ado, percorrem-se todos os elementos de con-\n\ntorno sobre a fronteira em quest\u00e3o (B fluxo), visitando-se em cada um deles\ntodas faces de contorno inclu\u00eddas. Como se considera que o fluxo pres-\n\ncrito ?bf independe das inc\u00f3gnitas, ele \u00e9 acrescido no termo independente\nda equa\u00e7\u00e3o correspondente, com sinal negativo.5 O \u00edndice do volume de\n\ncontrole associado \u00e0 face de contorno \u00e9 dado pela fun\u00e7\u00e3o nC(bf ), que deve\n\nextrair essa informa\u00e7\u00e3o a partir da conectividade da malha de contorno.\n\nEm certas situa\u00e7\u00f5es, o termo de fluxo atrav\u00e9s da fronteira na equa\u00e7\u00e3o\n\n(4.18) pode ser modelado como sendo proporcional \u00e0 diferen\u00e7a entre o\n\nvalor nodal da vari\u00e1vel e um valor de refer\u00eancia conhecido. Ou seja,6\n\n?\n\nbe?bEp\n\n?\n\nbf ?bF bep\n\n?bf = C? p (??p ??ref ) , (4.19)\n\nem que C? p seria a condut\u00e2ncia da por\u00e7\u00e3o de fronteira associada ao volume.\n\nEsse tipo de condi\u00e7\u00e3o pode ser facilmente implementada por um procedi-\n\nmento da forma seguinte:\n\n1: para todos os n\u00f3s p ? B conv\n\n2: A g(p), g(p)? A g(p), g(p) + C? p\n3: b g(p)?b g(p) + C? p ?ref\n\nDesta vez apenas \u00e9 necess\u00e1rio percorrer os n\u00f3s sobre a fronteira em\n\nquest\u00e3o (B conv), uma vez que todos os par\u00e2metros necess\u00e1rios s\u00e3o referen-\ntes aos n\u00f3s ou aos volumes de controle associados.\n\n4.4.2 Condi\u00e7\u00e3o de Dirichlet\n\nExistem descritas na literatura diversas t\u00e9cnicas para impor condi\u00e7\u00f5es de\n\nDirichlet em formula\u00e7\u00f5es num\u00e9ricas com n\u00f3s localizados nos v\u00e9rtices da\n\nmalha. Uma particularidade deste tipo de malha \u00e9 a exist\u00eancia de n\u00f3s\n\nsobre as fronteiras do dom\u00ednio, como ilustra a figura 2.22. Uma vez que em\n\numa condi\u00e7\u00e3o de Dirichlet valores da vari\u00e1vel da equa\u00e7\u00e3o s\u00e3o conhecidos\n\nem uma fronteira, os valores nodais em n\u00f3s localizados sobre essa fonteira\n\ndeixam de ser inc\u00f3gnitas do problema discreto.\n\n5 O sinal negativo prov\u00e9m da transposi\u00e7\u00e3o do termo de fluxo na fronteira ao lado direito\nda equa\u00e7\u00e3o.\n\n6 O fluxo proveniente de po\u00e7os, em reservat\u00f3rios de petr\u00f3leo, \u00e9 normalmente modelado\npor uma express\u00e3o desse tipo.\n\n\n\nDISC R ET IZ A\u00c7\u00c3O DE UM A EQUA\u00c7 \u00c3O DE CO NSERVA\u00c7\u00c3O 74\n\nUma das formas usuais para incluir uma condi\u00e7\u00e3o de Dirichlet no\n\nsistema de equa\u00e7\u00f5es \u00e9 o denominado m\u00e9todo da penalidade [84], o qual\nvisa evitar a alterara\u00e7\u00e3o da estrutura do sistema de equa\u00e7\u00f5es resultante da\n\nmontagem previamente descrita. Operacionalmente, esse m\u00e9todo equi-\n\nvale a impor uma condi\u00e7\u00e3o de fluxo da forma dada na equa\u00e7\u00e3o (4.19) com\n\num valor da condut\u00e2ncia v\u00e1rias ordens de grandeza maior que os restantes\n\ncoeficientes da equa\u00e7\u00e3o e um valor de refer\u00eancia igual ao valor prescrito.\n\nComo efeito dessa opera\u00e7\u00e3o, o valor nodal depois de resolvido o sistema de\n\nequa\u00e7\u00f5es se aproxima do valor estipulado na condi\u00e7\u00e3o de Dirichlet. Outra\n\nt\u00e9cnica comum \u00e9 a substitui\u00e7\u00e3o das equa\u00e7\u00f5es discretizadas dos volumes\n\nadjacentes \u00e0s fronteiras com condi\u00e7\u00e3o de Dirichlet por equa\u00e7\u00f5es da forma\n\n??p = ?Dirichlet , em que o valor nodal correspondente \u00e9 diretamente igua-\nlado ao valor prescrito na condi\u00e7\u00e3o. Para tanto \u00e9 necess\u00e1rio alterar todos\n\nos coeficientes e o termo independente das equa\u00e7\u00f5es associadas a esses\n\nvolumes.\n\nUma t\u00e9cnica alternativa, utilizada nas implementa\u00e7\u00f5es computacio-\n\nnais realizadas neste trabalho,7 \u00e9 a elimina\u00e7\u00e3o das equa\u00e7\u00f5es discretizadas\n\ncorrespondentes aos volumes adjacentes a uma fronteira com condi\u00e7\u00e3o de\n\nDirichlet. O procedimento est\u00e1 ilustrado mediante um exemplo na figura\n\n4.5. Nele, os coeficientes das linhas e colunas cujos \u00edndices coincidem com\n\nos \u00edndices dos n\u00f3s com condi\u00e7\u00e3o de Dirichlet s\u00e3o eliminados da matriz. De\n\nforma similar, no vetor de inc\u00f3gnitas e no vetor de termos independentes\n\ns\u00e3o retiradas as componentes com os mesmos \u00edndices. Dessa forma, as\n\nequa\u00e7\u00f5es completas dos volumes associados a esses n\u00f3s est\u00e3o sendo eli-\n\nminadas do sistema de equa\u00e7\u00f5es. Os coeficientes eliminados nas colunas\n\nda matriz, que no sistema original multiplicavam os valores nodais nos\n\nn\u00f3s com condi\u00e7\u00e3o de Dirichlet, devem ser multiplicados pelos respectivos\n\nvalores prescritos e subtra\u00eddos dos termos independentes, a fim de n\u00e3o\n\nalterar as equa\u00e7\u00f5es discretizadas remanentes. Como resultado desse pro-\n\ncesso, obt\u00e9m-se um sistema de equa\u00e7\u00f5es reduzido, cujas inc\u00f3gnitas s\u00e3o\n\napenas valores nodais de n\u00f3s internos e de n\u00f3s localizados em fronteiras\n\ncom outro tipo de condi\u00e7\u00e3o, como mostra a figura 4.5.\n\n7 A escolha dessa t\u00e9cnica est\u00e1 relacionada com a utiliza\u00e7\u00e3o do m\u00e9todo multigrid de\ncorre\u00e7\u00f5es aditivas [39], considerada neste trabalho para resolver os sistemas de equa\u00e7\u00f5es re-\nsultantes da discretiza\u00e7\u00e3o. Observou-se que as altera\u00e7\u00f5es na matriz de coeficientes realizadas\ncom as outras t\u00e9cnicas deterioram o desempenho desse m\u00e9todo.\n\n\n\nDISC R ET IZ A\u00c7\u00c3O DE UM A EQUA\u00c7 \u00c3O DE CO NSERVA\u00c7\u00c3O 75\n\n1\n2\n\n3\n4 5\n\n6\n7\n\n8\n9 10\n\n11\n12\n\n13 14\n\nRedu\u00e7\u00e3o do sistema de equa\u00e7\u00f5es ap\u00f3s a montagem\nN\u00f3s com condi\u00e7\u00e3ode Dirichlet\n\nValores prescritos\n\nValores provenientesdas colunas eliminadas\n\nSistema de equa\u00e7\u00f5es reduzido\n\n1234567891011121314 1 2 3 4 5 6 7 8 9 10 11 12 13 14\n\n=\n\n=\nFigura 4.5 \u2013 Redu\u00e7\u00e3o do sistema de equa\u00e7\u00f5es pela imposi\u00e7\u00e3o de uma con-\n\ndi\u00e7\u00e3o de Dirichlet.\n\n\n\nDISC R ET IZ A\u00c7\u00c3O DE UM A EQUA\u00c7 \u00c3O DE CO NSERVA\u00c7\u00c3O 76\n\nUma das principais vantagens dessa pr\u00e1tica \u00e9 que o sistema de equa-\n\n\u00e7\u00f5es a ser resolvido \u00e9 menor que o original. Entretanto, dado que geral-\n\nmente deve ser utilizado algum esquema de armazenamento compacto\n\npara matrizes esparsas [71], altera\u00e7\u00f5es na estrutura da matriz de coeficien-\ntes podem ser muito complexas e demandar um tempo de computa\u00e7\u00e3o\n\nadicional consider\u00e1vel. A fim de evitar essas dificuldades, na implementa-\n\n\u00e7\u00e3o realizada neste trabalho efetua-se j\u00e1 de in\u00edcio a montagem da matriz de\n\ncoeficientes reduzida, introduzindo algumas modifica\u00e7\u00f5es no algoritmo\n\nde montagem esbo\u00e7ado na se\u00e7\u00e3o 4.3.\n\n\u00c9 importante notar que embora sejam eliminadas do sistema de equa-\n\n\u00e7\u00f5es, as equa\u00e7\u00f5es de conserva\u00e7\u00e3o dos volumes adjacentes a fronteiras com\n\ncondi\u00e7\u00e3o de Dirichlet continuam sendo v\u00e1lidas. Essas equa\u00e7\u00f5es podem ser\n\nempregadas para determinar os fluxos totais que atravessam essas frontei-\n\nras, ap\u00f3s ser resolvido o sistema de equa\u00e7\u00f5es e estarem dispon\u00edveis todos\n\nos valores nodais da vari\u00e1vel inc\u00f3gnita. Nessa situa\u00e7\u00e3o, o termo\n?\n\nbe\n\n?\n\nbf ?bf\ntorna-se a inc\u00f3gnita da equa\u00e7\u00e3o (4.18) associada a todos os volumes con-\n\nt\u00edguos a fronteiras com condi\u00e7\u00e3o de Dirichlet. Consequentemente, essa\n\nequa\u00e7\u00e3o pode ser utilizada para determinar o valor dessa inc\u00f3gnita a pos-\n\nteriori. Dessa forma, a conserva\u00e7\u00e3o da grandeza ? \u00e9 sastisfeita mesmo\nnos volumes de controle cujas equa\u00e7\u00f5es foram eliminadas do sistema de\n\nequa\u00e7\u00f5es.\n\n\n\nCAP\u00cdTULO\n\n5\nAplica\u00e7\u00e3o a um modelo de\nescoamento em reservat\u00f3rios\n\n5.1 Modelo de escoamento bif\u00e1sico\n\nPara aplica\u00e7\u00e3o da formula\u00e7\u00e3o num\u00e9rica desenvolvida \u00e0 simula\u00e7\u00e3o tridi-\n\nmensional de reservat\u00f3rios de petr\u00f3leo, optou-se por um modelo de es-\n\ncoamento bif\u00e1sico imisc\u00edvel. Este modelo permite desacoplar de forma\n\nsimples as equa\u00e7\u00f5es discretizadas, facilitando desse modo a sua solu\u00e7\u00e3o\n\npor meio de um m\u00e9todo segregado. Quanto ao tratamento dos aspec-\n\ntos geom\u00e9tricos da discretiza\u00e7\u00e3o, que \u00e9 o foco da formula\u00e7\u00e3o apresen-\n\ntada neste trabalho, modelos de escoamento mais sofisticados requere-\n\nr\u00e3o, em geral, uma abordagem id\u00eantica \u00e0 mostrada aqui para o modelo\n\nbif\u00e1sico. Entretanto, aspectos intr\u00ednsecos \u00e0 modelagem f\u00edsica introduzem\n\nacoplamentos e n\u00e3o-linearidades adicionais, os quais tornam a descri\u00e7\u00e3o\n\nda discretiza\u00e7\u00e3o mais complexa, porem, sem agregar aspectos novos, pelo\n\nmenos do ponto de vista geom\u00e9trico. \u00c9 importante notar, contudo, que o\n\nm\u00e9todo de discretiza\u00e7\u00e3o apresentado \u00e9 totalmente apto para ser aplicado\n\na modelos de escoamento mais complexos.\n\n77\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 78\n\nUma das equa\u00e7\u00f5es fundamentais em qualquer modelo macrosc\u00f3pico\n\nde escoamento em reservat\u00f3rios \u00e9 a express\u00e3o matem\u00e1tica da lei de Darcy.\n\nA forma comumente adotada para escoamento multif\u00e1sico \u00e9 [3]\n\nv? = ??? K (?P ??? g ) , ?= w ,o . (5.1)\n\nNesta express\u00e3o, v?, ?? e ?? s\u00e3o, respectivamente, a velocidade m\u00e9dia\nou velocidade de Darcy, a mobilidade e a densidade, associadas \u00e0 fase\n\ngen\u00e9rica ?. No modelo considerado, as duas fases s\u00e3o identificadas como\n\n\u00e1gua (w) e \u00f3leo (o). Ainda na equa\u00e7\u00e3o (5.1), ?P \u00e9 o gradiente da press\u00e3o e\ng \u00e9 a acelera\u00e7\u00e3o devida \u00e0 gravidade. Considera-se uma press\u00e3o \u00fanica pois\nassume-se que a influ\u00eancia da press\u00e3o capilar na escala considerada nas\n\nsimula\u00e7\u00f5es \u00e9 pouco significativa. Por fim, K \u00e9 o tensor permeabilidade. A\nmetodologia adotada neste trabalho \u00e9 apta para lidar de forma consistente\n\ncom tensores sim\u00e9tricos completos, isto \u00e9,\n\nK =\n\n?\n\n?\n\n?\n\n?\n\nK x x K x y K x z\nK x y K y y K y z\nK x z K y z K z z\n\n?\n\n?\n\n?\n\n?\n\n, (5.2)\n\nem que todas as componentes podem ser n\u00e3o-nulas.\n\nDo ponto de vista da discretiza\u00e7\u00e3o, \u00e9 vantajoso expressar a acelera\u00e7\u00e3o\n\nda gravidade como o gradiente de um potencial escalar G , dado por\n\nG ? g x x + g y y + g z z , (5.3)\n\nem que g x , g y e g z s\u00e3o as componentes cartesianas do vetor g , enquanto\nque, como \u00e9 habitual, x , y e z s\u00e3o as coordenadas cartesianas de um dado\n\nponto. A partir da defini\u00e7\u00e3o em (5.3) \u00e9 trivial mostrar que g =?G , com o\nqual, a equa\u00e7\u00e3o (5.1) transforma-se em\n\nv? = ??? K (?P ? ???G ) , ?= w ,o. (5.4)\n\nA mobilidade que figura nas equa\u00e7\u00f5es (5.1) e (5.4) \u00e9 definida por\n\n?? ?\nk r?\n\u00b5?\n\n, ?= w ,o . (5.5)\n\nonde k r? e \u00b5? s\u00e3o, respectivamente, a permeabilidade relativa e a viscosi-\n\ndade da fase. A permeabilidade relativa \u00e9 usualmente dada na forma de\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 79\n\numa curva, que descreve sua depend\u00eancia em rela\u00e7\u00e3o \u00e0 satura\u00e7\u00e3o de uma\n\ndas fases. Note-se que a defini\u00e7\u00e3o da mobilidade na equa\u00e7\u00e3o (5.5) difere\n\nda usual [3, 60] por n\u00e3o incluir a permeabilidade absoluta, a qual, ao ser\nconsiderada aqui um tensor completo, \u00e9 escrita de forma independiente\n\nda mobilidade.\n\nA outra equa\u00e7\u00e3o essencial em um modelo de escoamento multif\u00e1sico\n\n\u00e9 a equa\u00e7\u00e3o de balan\u00e7o de massa. Assume-se aqui que cada fase \u00e9 in-\n\ncompress\u00edvel e est\u00e1 formada por um \u00fanico componente, logo a equa\u00e7\u00e3o\n\nde conserva\u00e7\u00e3o pode ser escrita, para cada fase, na forma [60]\n\n? (?s ?)\n?t\n\n+ ? \u00b7 v? = 0 , ?= w ,o . (5.6)\n\nNesta equa\u00e7\u00e3o, s ? \u00e9 a satura\u00e7\u00e3o da fase, isto \u00e9, a fra\u00e7\u00e3o do volume\n\nporoso ocupada pela referida fase. Al\u00e9m do mais, ? \u00e9 a porosidade do\n\nmeio, ou seja, a fra\u00e7\u00e3o do um volume representativo do meio poroso n\u00e3o\n\nocupada pela matriz s\u00f3lida.1\n\nO modelo \u00e9 completado pela denominada equa\u00e7\u00e3o de restri\u00e7\u00e3o volu-\n\nm\u00e9trica\ns w + so = 1 , (5.7)\n\na qual \u00e9 consequ\u00eancia da hip\u00f3tese que as duas fases consideradas ocupam\n\ntodo o espa\u00e7o poroso dispon\u00edvel.\n\nAs equa\u00e7\u00f5es diferenciais do modelo de escoamento bif\u00e1sico, escri-\n\ntas acima, podem ser combinadas algebricamente para dar origem a um\n\nconjunto de equa\u00e7\u00f5es equivalente. Para o caso considerado, em que as\n\nfases possuem densidade constante, essas equa\u00e7\u00f5es alternativas adquirem\n\numa forma simples que facilita, em alguma medida, o processo de discre-\n\ntiza\u00e7\u00e3o. Assim, por exemplo, a combina\u00e7\u00e3o das equa\u00e7\u00f5es (5.6) e (5.7) d\u00e1\n\norigem \u00e0 equa\u00e7\u00e3o de balan\u00e7o global\n\n? \u00b7 vT = 0 , (5.8)\n\nna qual, vT \u00e9 a denominada velocidade total [60], a qual \u00e9 definida como a\nsoma das velocidades das duas fases consideradas, isto \u00e9,\n\nvT ? vw + vo . (5.9)\n\n1 Posteriormente, o escoamento entre o reservat\u00f3rio e os po\u00e7os nele contidos ser\u00e1 intro-\nduzido como condi\u00e7\u00f5es de contorno para a equa\u00e7\u00e3o (5.6).\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 80\n\nUma express\u00e3o relacionando a velocidade total com o gradiente de\n\npress\u00e3o pode ser obtida somando-se as duas inst\u00e2ncias da equa\u00e7\u00e3o (5.4),\n\ncorrespondentes \u00e0s duas fases consideradas no modelo. Dessa forma chega-\n\nse \u00e0 rela\u00e7\u00e3o\n\nvT = ??T K (?P ? ?M?G ) , (5.10)\n\nNesta express\u00e3o foram introduzidas duas novas propriedades. A pri-\n\nmeira \u00e9 denominada mobilidade total, definida por\n\n?T ? ?w + ?o . (5.11)\n\nA outra propriedade \u00e9 a densidade m\u00e9dia ponderada pela mobilidade,\n\ndefinida pela express\u00e3o\n\n?M ?\n?w ?w + ?o ?o\n?w + ?o\n\n. (5.12)\n\nA substitui\u00e7\u00e3o da equa\u00e7\u00e3o (5.10) no balan\u00e7o global, dado na equa\u00e7\u00e3o\n\n(5.8), origina a equa\u00e7\u00e3o diferencial da press\u00e3o,\n\n?? \u00b7 (?T K?P ) +? \u00b7 (?M ?T K?G ) = 0 . (5.13)\n\nA fim de completar a forma alternativa do modelo de escoamento bi-\n\nf\u00e1sico \u00e9 usual considerar a equa\u00e7\u00e3o de conserva\u00e7\u00e3o da fase \u00e1gua, expressa\n\nem fun\u00e7\u00e3o da velocidade total anteriormente definida. Essa forma espec\u00ed-\n\nfica, conhecida como forma de Buckley-Leverett da equa\u00e7\u00e3o da satura\u00e7\u00e3o\n\n[60], pode ser obtida combinando as equa\u00e7\u00f5es (5.4) e (5.6), expressas para\na fase \u00e1gua, com a equa\u00e7\u00e3o (5.10). Seguindo esse procedimento, chega-se\n\n\u00e0 equa\u00e7\u00e3o\n\n? (?s)\n?t\n\n+ ? \u00b7 (Fw vT ) + ? \u00b7 (?wo ??wo K?G ) = 0 . (5.14)\n\nPor conveni\u00eancia, nesta equa\u00e7\u00e3o a satura\u00e7\u00e3o da fase \u00e1gua denotou-se\n\nsimplesmente como s . Por outro lado, Fw \u00e9 a denominada fun\u00e7\u00e3o fluxo\n\nfracion\u00e1rio [60] para a fase \u00e1gua, definida pela raz\u00e3o de mobilidades\n\nFw ?\n?w\n\n?T\n. (5.15)\n\nDe forma similar, ?wo \u00e9 uma fun\u00e7\u00e3o tamb\u00e9m dependente das mobili-\ndades das fases, dada por\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 81\n\n?wo ? ?o Fw =\n?o ?w\n\n?T\n. (5.16)\n\nNo modelo bif\u00e1sico considerado, as mobilidades s\u00e3o fun\u00e7\u00f5es apenas\n\nda satura\u00e7\u00e3o de uma das fases, via as permeabilidades relativas. Conse-\n\nquentemente, Fw e ?wo s\u00e3o tamb\u00e9m fun\u00e7\u00f5es apenas da satura\u00e7\u00e3o, uma\nvez que s\u00e3o dadas por combina\u00e7\u00f5es das mobilidades.\n\nPor fim, na equa\u00e7\u00e3o (5.14), ??wo simboliza a diferen\u00e7a entre as densi-\ndades das duas fases, isto \u00e9,\n\n??wo = ?w ??o . (5.17)\n\nPara fins do processo de discretiza\u00e7\u00e3o posterior, \u00e9 conveniente ex-\n\npressar as equa\u00e7\u00f5es de conserva\u00e7\u00e3o apresentadas na sua forma integral\n\nequivalente. Para a equa\u00e7\u00e3o da press\u00e3o, tem-se\n\n?\n?\n\nS\n\n?T K?P \u00b7 dS +\n?\n\nS\n\n?T K?G \u00b7 dS = 0 , (5.18)\n\nonde, a fim de simplificar a express\u00e3o, foi introduzido o coeficiente ?T ,\n\ndado por\n?T ? ?M ?T = ?w ?w + ?o ?o . (5.19)\n\nFinalmente, a forma integral da equa\u00e7\u00e3o da satura\u00e7\u00e3o considerada \u00e9\n\n?\n\n?t\n\n?\n\nV\n\n?s dV +\n\n?\n\nS\n\nFw vT \u00b7 dS +\n?\n\nS\n\n?wo ??wo K?G \u00b7 dS = 0 . (5.20)\n\n5.2 Discretiza\u00e7\u00e3o do modelo\nNesta se\u00e7\u00e3o \u00e9 descrita a discretiza\u00e7\u00e3o das equa\u00e7\u00f5es do modelo matem\u00e1tico\n\npara escoamento bif\u00e1sico, aplicando os conceitos e procedimentos apre-\n\nsentados nos cap\u00edtulos precedentes. Considera-se que o dom\u00ednio de so-\n\nlu\u00e7\u00e3o \u00e9 um reservat\u00f3rio tridimensional, discretizado por uma malha n\u00e3o-\n\nestruturada formada, no caso mais geral, pelos quatro tipos de elementos\n\ndescritos no cap\u00edtulo 2.\n\nAs duas vari\u00e1veis fundamentais do modelo bif\u00e1sico considerado s\u00e3o a\n\npress\u00e3o e a satura\u00e7\u00e3o. Embora ambas as vari\u00e1veis estejam presentes nas\n\nduas equa\u00e7\u00f5es de conserva\u00e7\u00e3o, na forma apresentada na se\u00e7\u00e3o anterior,\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 82\n\ncada equa\u00e7\u00e3o possui uma vari\u00e1vel dominante. Gra\u00e7as a essa caracter\u00edstica,\n\nna discretiza\u00e7\u00e3o dessas equa\u00e7\u00f5es, \u00e9 poss\u00edvel desacopl\u00e1-las mediante uma\n\nescolha apropriada do n\u00edvel de tempo em que cada equa\u00e7\u00e3o \u00e9 aproximada.\n\nDessa forma, torna-se poss\u00edvel a utiliza\u00e7\u00e3o de um esquema de solu\u00e7\u00e3o se-\n\ngregado para a obten\u00e7\u00e3o da evolu\u00e7\u00e3o temporal das vari\u00e1veis no problema\n\nem quest\u00e3o, que \u00e9 o objetivo da simula\u00e7\u00e3o.\n\n5.2.1 Equa\u00e7\u00e3o da press\u00e3o\n\nA aproxima\u00e7\u00e3o num\u00e9rica das integrais na equa\u00e7\u00e3o da press\u00e3o, na forma\n\ndada pela equa\u00e7\u00e3o (5.18), d\u00e1 origem \u00e0 express\u00e3o discreta\n\n?\n?\n\nf ?Fp\n\n?f , p\n?\n\n?T K?P\n?\n\n?f\n\u00b7?Sf +\n\n?\n\nf ?Fp\n\n?f , p\n?\n\n?T K?G\n?\n\n?f\n\u00b7?Sf = 0 . (5.21)\n\nA forma fechada da equa\u00e7\u00e3o \u00e9 obtida ap\u00f3s introduzir a aproxima\u00e7\u00e3o\n\ndos fluxos difusivos em fun\u00e7\u00e3o dos valores nodais das vari\u00e1veis, dada de\n\nforma gen\u00e9rica pela equa\u00e7\u00e3o (4.10). Fica evidente agora a conveni\u00eancia de\n\nrepresentar a acelera\u00e7\u00e3o da gravidade como o gradiente do potencial G ,\n\npois ambos os termos da equa\u00e7\u00e3o (5.21) podem ser aproximados empre-\n\ngando os mesmos operadores.\n\nA fim de facilitar a escrita das equa\u00e7\u00f5es, e tamb\u00e9m simplificar sua\n\nimplementa\u00e7\u00e3o, \u00e9 conveniente definir os fluxos parciais\n\n?f ? (K?G)?f \u00b7?Sf ?\n?\n\n`?N e\n?ef,`G?\n\ne\n`\n\n, (5.22)\n\nque independem do tempo e, portanto, podem ser calculados uma \u00fanica\n\nvez no in\u00edcio do processo. Ap\u00f3s introduzir essa defini\u00e7\u00e3o na equa\u00e7\u00e3o (5.21),\n\nal\u00e9m de aproxima\u00e7\u00f5es locais dos fluxos dependentes do gradiente de pres-\n\ns\u00e3o, chega-se a\n\n?\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?\n\n`?N e\n?f , p (?T)?f ?\n\ne\nf,` P?\n\ne\n`\n+\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?f , p (?T)?f ?f = 0 . (5.23)\n\nEmbora a equa\u00e7\u00e3o da press\u00e3o n\u00e3o possua um termo temporal como\n\na equa\u00e7\u00e3o da satura\u00e7\u00e3o, certamente os coeficientes (?T)?f e (?T)?f variam\ncom o tempo, pois eles dependem da satura\u00e7\u00e3o. Consequentemente, para\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 83\n\ncompletar a aproxima\u00e7\u00e3o num\u00e9rica, a equa\u00e7\u00e3o (5.22) deve ser associada a\n\num n\u00edvel discreto de tempo, como feito a seguir\n\n?\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?\n\n`?N e\n?f , p\n\nj\n\n(?T)?f\nkm\n?ef,`bP?\n\ne\n`\ncm +\n\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?f , p\nj\n\n(?T)?f\nkm\n?f = 0 .\n\n(5.24)\n\nSupondo que no n\u00edvel de tempo t m estiver dispon\u00edvel uma aproxima-\n\n\u00e7\u00e3o do campo de satura\u00e7\u00e3o, valores de (?T)?f e (?T)?f poder\u00e3o ser calcula-\ndos nesse n\u00edvel de tempo e, portanto, as \u00fanicas inc\u00f3gnitas restantes na\n\nequa\u00e7\u00e3o (5.24) ser\u00e3o os valores nodais da press\u00e3o. Essa \u00e9, precisamente,\n\na abordagem considerada em um algoritmo de solu\u00e7\u00e3o sequencial para a\n\nobten\u00e7\u00e3o da evolu\u00e7\u00e3o temporal do escoamento. Nessa situa\u00e7\u00e3o, o proce-\n\ndimento de montagem do sistema de equa\u00e7\u00f5es apresentado na se\u00e7\u00e3o 4.3\n\npode ser empregado sem qualquer altera\u00e7\u00e3o, dando lugar ao sistema\n\nAbP? cm = b , (5.25)\n\ncuja solu\u00e7\u00e3o deve fornecer uma aproxima\u00e7\u00e3o discreta do campo de pres-\n\ns\u00e3o no n\u00edvel de tempo t m .\n\n5.2.2 Equa\u00e7\u00e3o da satura\u00e7\u00e3o\n\nNa equa\u00e7\u00e3o integral da satura\u00e7\u00e3o podem ser empregadas aproxima\u00e7\u00f5es\n\nnum\u00e9ricas semelhantes \u00e0s consideradas na discretiza\u00e7\u00e3o da equa\u00e7\u00e3o da\n\npress\u00e3o. Entretanto, como essa equa\u00e7\u00e3o possui uma derivada temporal, \u00e9\n\nnecess\u00e1rio considerar tamb\u00e9m uma integra\u00e7\u00e3o no tempo, como mostrado\n\nna express\u00e3o a seguir, obtida a partir da equa\u00e7\u00e3o (5.20)\n\n?p ?Vp s?p\n?\n\n?\n\nt m+1\nt m\n+\n\n? t m+1\n\nt m\n\n?\n\n?\n\n?\n\n?\n\nf ?Fp\n\n?f , p\n?\n\nFw vT\n?\n\n?f\n\u00b7?Sf\n\n?\n\n?\n\n?\ndt\n\n+\n\n? t m+1\n\nt m\n\n?\n\n?\n\n?\n\n?\n\nf ?Fp\n\n?f , p\n?\n\n?wo ??wo K?G\n?\n\n?f \u00b7?Sf\n\n?\n\n?\n\n?\ndt = 0 .\n\n(5.26)\n\nDiferentemente do exemplo considerado na se\u00e7\u00e3o 4.2.3, desta vez os\n\nfluxos ser\u00e3o aproximados no n\u00edvel de tempo inicial do intervalo, t m . Isto\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 84\n\ncaracteriza uma aproxima\u00e7\u00e3o expl\u00edcita [20, 45], cuja estabilidade \u00e9 con-\ndicional, conforme se ver\u00e1 mais adiante. Procedendo da forma indicada,\n\nobt\u00e9m-se\n\n?p ?Vpbs?p cm+1 ? ?p ?Vpbs?p cm + ?tm+1\n?\n\nf ?Fp\n\n?f , p\nj\n\n?\n\nFw vT\n?\n\n?f\n\nkm\n\u00b7?Sf\n\n+ ?tm+1\n?\n\nf ?Fp\n\n?f , p\nj\n\n?\n\n?wo ??wo K?G\n?\n\n?f\n\nkm\n\u00b7?Sf = 0 .\n\n(5.27)\n\nNeste ponto \u00e9 conveniente definir a vaz\u00e3o volum\u00e9trica total em uma\n\nface, originada na velocidade total vT . Isto \u00e9,\n\nqf ? (vT)?f \u00b7?Sf . (5.28)\n\nOs valores das vaz\u00f5es totais no n\u00edvel de tempo t m podem ser determi-\n\nnados, ap\u00f3s resolver o sistema de equa\u00e7\u00f5es da press\u00e3o, mediante a expres-\n\ns\u00e3o\n\nbqf c\nm = ?\n\nj\n\n(?T)?f\nkm ?\n\n`?N e\n?ef,`bP?\n\ne\n`\ncm +\n\nj\n\n(?T)?f\nkm\n?f . (5.29)\n\nEsta \u00faltima express\u00e3o \u00e9 obtida substituindo a equa\u00e7\u00e3o (5.10) na defi-\n\nni\u00e7\u00e3o dada em (5.28) e depois aplicando as mesmas aproxima\u00e7\u00f5es num\u00e9-\n\nricas consideradas na discretiza\u00e7\u00e3o da equa\u00e7\u00e3o da press\u00e3o.2\n\nIntroduzindo na equa\u00e7\u00e3o (5.27) as vaz\u00f5es definidas nas equa\u00e7\u00f5es (5.22)\n\ne (5.28), obt\u00e9m-se\n\n?p ?Vpbs?p cm+1 ? ?p ?Vpbs?p cm + ?tm+1\n?\n\nf ?Fp\n\n?f , p\nj\n\nqf (Fw)?f\nkm\n\n+ ?tm+1\n?\n\nf ?Fp\n\n?f , p\nj\n\n(?wo)?f\nkm\n??wo ?f = 0 .\n\n(5.30)\n\nA rigor, a \u00fanica inc\u00f3gnita nesta \u00faltima equa\u00e7\u00e3o \u00e9 o valor nodal bs?p cm+1,\npois, dado que foi considerada uma aproxima\u00e7\u00e3o expl\u00edcita, os valores de\n\ntodos os restantes termos devem encontrar-se dispon\u00edveis ou podem ser\n\ndeterminados mediante esquemas de interpola\u00e7\u00e3o espacial apropriados.\n\nLogo, a equa\u00e7\u00e3o (5.30) pode ser empregada como equa\u00e7\u00e3o evolutiva para\n\n2 A forma discretizada da equa\u00e7\u00e3o da press\u00e3o pode ser escrita alternativamente como\n?\n\nf ?Fp ?f , p qf = 0, a qual \u00e9 uma aproxima\u00e7\u00e3o discreta da equa\u00e7\u00e3o (5.8), que \u00e9 precisamente a\nequa\u00e7\u00e3o que deu origem \u00e0 equa\u00e7\u00e3o diferencial da press\u00e3o.\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 85\n\na satura\u00e7\u00e3o, pois permite determinar os valores nodais dessa vari\u00e1vel em\n\num novo instante de tempo sem ser necess\u00e1rio resolver um sistema simul-\n\nt\u00e2neo de equa\u00e7\u00f5es. Para tanto, pode ser conveniente rearranjar a equa\u00e7\u00e3o\n\nna forma\n\nbs?p cm+1 = bs?p cm ?\n\n?tm+1\n?p ?Vp\n\n\u00a8\n\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?f , p\n\n?\n\nj\n\nqf (Fw)?f\nkm\n+\nj\n\n(?wo)?f\nkm\n??wo ?f\n\n?\n\n\u00ab\n\n(5.31)\n\n5.2.3 Esquemas de interpola\u00e7\u00e3o espacial\n\nPara que a discretiza\u00e7\u00e3o das equa\u00e7\u00f5es do modelo de escoamento esteja\n\ncompleta, devem ser especificados ainda esquemas de interpola\u00e7\u00e3o a ser\n\nempregados para determinar valores de grandezas nas faces dos volumes\n\nde controle.\n\nNa equa\u00e7\u00e3o (5.24) s\u00e3o necess\u00e1rios valores de ?T e ?T , ambas as pro-\n\npriedades dependentes da satura\u00e7\u00e3o. Em geral, a escolha do esquema de\n\ninterpola\u00e7\u00e3o para essas propriedades n\u00e3o tem consequ\u00eancias negativas\n\nsobre a estabilidade do m\u00e9todo, dada a natureza el\u00edptica da equa\u00e7\u00e3o da\n\npress\u00e3o [66, 80]. Conforme sugerido em [80], um esquema de segunda or-\ndem \u00e9 uma escolha adequada nesse caso, pois reduz em alguma medida o\n\nefeito de orienta\u00e7\u00e3o de malha [37]. No contexto de um m\u00e9todo de volumes\nfinitos baseado em elementos isso \u00e9 conseguido realizando a interpola\u00e7\u00e3o\n\nvia fun\u00e7\u00f5es de forma, ou seja,\n\n(?T)?f ?\n?\n\n`?N e\nN ,??f (??T)\n\ne\n`\n\n, (5.32)\n\n(?T)?f ?\n?\n\n`?N e\nN ,??f (??T)\n\ne\n`\n\n, (5.33)\n\nonde N`,?f \u00e9 uma nota\u00e7\u00e3o reduzida para N`(??f ,??f ,??f ), isto \u00e9, os valores das\nfun\u00e7\u00f5es de forma avaliadas nos baricentros das faces.\n\nA interpola\u00e7\u00e3o das propriedades para a equa\u00e7\u00e3o da satura\u00e7\u00e3o requer\n\num maior cuidado. Uma vez que se trata de uma equa\u00e7\u00e3o hiperb\u00f3lica\n\n[60], se os coeficientes oriundos da discretiza\u00e7\u00e3o n\u00e3o satisfizerem crit\u00e9-\nrios de positividade, valores n\u00e3o f\u00edsicos e/ou oscila\u00e7\u00f5es poder\u00e3o surgir nas\nsolu\u00e7\u00f5es num\u00e9ricas obtidas [69]. O esquema mais simples que atende\nesses crit\u00e9rios \u00e9 o esquema upwind de um ponto (SPU) [41], cuja forma\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 86\n\nadaptada \u00e0s malhas n\u00e3o-estruturadas foi descrita na se\u00e7\u00e3o 3.6. Para a\n\nfun\u00e7\u00e3o fluxo fracion\u00e1rio, a forma correspondente a esse esquema \u00e9\n\n(Fw)?f =\n\n(\n\n(F?w)nB(f ) se qf > 0 ,\n(F?w)nF(f ) se qf &lt;0 ,\n\n(5.34)\n\nna qual o valor nodal a montante \u00e9 determinado analisando o sinal da\n\nvaz\u00e3o total na face, qf . Dado que Fw \u00e9 uma fun\u00e7\u00e3o n\u00e3o-linear da vari\u00e1vel\n\nda equa\u00e7\u00e3o, a rigor, na equa\u00e7\u00e3o (5.34) deveria ser analisado o sinal do\n\nproduto da derivada dFw /ds pela vaz\u00e3o qf .\n3 Contudo, como essa derivada\n\n\u00e9 positiva em todo o intervalo de varia\u00e7\u00e3o da satura\u00e7\u00e3o, ela n\u00e3o altera o\n\ncrit\u00e9rio considerado para selecionar o valor nodal a montante.\n\nA fun\u00e7\u00e3o?wo , entretanto, \u00e9 uma fun\u00e7\u00e3o n\u00e3o-monot\u00f4nica, como ilustra\na figura 5.1 para um caso t\u00edpico. A derivada d?wo/ds apresenta, portanto,\numa mudan\u00e7a de sinal no intervalo de varia\u00e7\u00e3o da satura\u00e7\u00e3o. Isto indica\n\nque \u00e9 imprescind\u00edvel a considera\u00e7\u00e3o do sinal dessa derivada na determi-\n\nna\u00e7\u00e3o do n\u00f3 a montante para a interpola\u00e7\u00e3o de ?wo . Para tanto, uma\naproxima\u00e7\u00e3o num\u00e9rica do valor da derivada na face \u00e9 suficiente, como\n\nmostrado nas express\u00f5es seguintes\n\n(?wo)?f =\n\n(\n\n(??wo)nB(f ) se ?f ?f > 0 ,\n(??wo)nF(f ) se ?f ?f &lt;0 ,\n\n(5.35)\n\nonde\n\n?f ? sgn ??wo \u00b7 sgn\n?\n\n(??wo)nB(f )? (??wo)nF(f )\ns? nB(f )? s? nF(f )\n\n?\n\n, (5.36)\n\nem que a fun\u00e7\u00e3o sinal est\u00e1 definida por\n\nsgn x ?\n\n?\n\n?\n\n?\n\n1 se x > 0 ,\n\n0 se x = 0 ,\n?1 se x &lt;0 .\n\n(5.37)\n\n3 Segundo a teoria das equa\u00e7\u00f5es hiperb\u00f3licas n\u00e3o-lineares [44], a solu\u00e7\u00e3o da equa\u00e7\u00e3o\nda satura\u00e7\u00e3o, em aus\u00eancia do termo da gravidade, pode ser considerada como uma su-\nperposi\u00e7\u00e3o de ondas se deslocando com velocidade (dFw /ds)vT . Na situa\u00e7\u00e3o oposta, se o\ntermo ? \u00b7 (Fw vT ) fosse nulo na equa\u00e7\u00e3o (5.14), a velocidade de propaga\u00e7\u00e3o seria dada por\n(d?wo/ds)??wo K?G . A fim de garantir a positividade dos coeficientes, essas duas situa\u00e7\u00f5es\nextremas s\u00e3o consideradas na interpola\u00e7\u00e3o upwind nos respectivos termos da equa\u00e7\u00e3o da\nsatura\u00e7\u00e3o.\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 87\n\nPor quest\u00e3o de generalidade, o sinal de ??wo foi tamb\u00e9m inclu\u00eddo\nporque, dependendo dos valores das densidades das fases, essa diferen\u00e7a\n\npode ser positiva ou negativa.\n\n0 0.2 0.4 0.6 0.8 10\n0.2\n0.4\n0.6\n0.8\n\n1\n\nSatura\u00e7\u00e3o normalizada 0 0.2 0.4 0.6 0.8 10\n1\n2\n3\n4\n\nSatura\u00e7\u00e3o normalizada\n\n0 0.2 0.4 0.6 0.8 10\n2\n4\n6\n8 x 10-3\n\nSatura\u00e7\u00e3o normalizada 0 0.2 0.4 0.6 0.8 1\n-0.04\n-0.02\n\n0\n0.02\n\nSatura\u00e7\u00e3o normalizada\n\nFun\u00e7\u00e3o Derivada\n\nFun\u00e7\u00e3o Derivada\n\nFigura 5.1 \u2013 Varia\u00e7\u00e3o t\u00edpica das fun\u00e7\u00f5es dependentes da satura\u00e7\u00e3o e suas\nderivadas.\n\n5.3 Algoritmo de solu\u00e7\u00e3o\n\nA abordagem considerada na se\u00e7\u00e3o 5.2 para a aproxima\u00e7\u00e3o temporal \u00e9\n\nnormalmente empregada a fim de desacoplar parcialmente as equa\u00e7\u00f5es\n\ndiscretizadas e poder utilizar o algoritmo IMPES 4 [3, 49]. Neste algoritmo\ns\u00e3o resolvidas de forma sucessiva as equa\u00e7\u00f5es da press\u00e3o e da satura\u00e7\u00e3o\n\npara avan\u00e7ar no tempo essas duas vari\u00e1veis de modo segregado. Trata-se\n\nde um dos algoritmos mais simples para o tipo de modelo considerado,\n\ncontudo, sua estabilidade \u00e9 condicionada ao uso de passos de tempo que\n\nsatisfa\u00e7am o denominado crit\u00e9rio CFL [11].\n\n4 Implicit pressure\u2013explicit saturation.\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 88\n\nO crit\u00e9rio de estabilidade para o algoritmo IMPES \u00e9 geralmente muito\n\nrestritivo, e na pr\u00e1tica isso provoca que os tempos de computa\u00e7\u00e3o cres\u00e7am\n\nde forma exagerada, especialmente quando se consideram malhas com\n\nalgum tipo de refino. Uma das alternativas para remediar esse problema\n\nseria considerar uma aproxima\u00e7\u00e3o impl\u00edcita dos fluxos, o qual daria lugar a\n\num sistema de equa\u00e7\u00f5es n\u00e3o-lineares em que press\u00e3o e satura\u00e7\u00e3o estariam\n\nfortemente acopladas. Nessa situa\u00e7\u00e3o o passo de tempo estaria condi-\n\ncionado apenas pelas n\u00e3o-linearidades e pela precis\u00e3o, no entanto, seria\n\nnecess\u00e1ria a utiliza\u00e7\u00e3o de m\u00e9todos de solu\u00e7\u00e3o de sistemas de equa\u00e7\u00f5es\n\nn\u00e3o-lineares, como o m\u00e9todo de Newton-Raphson, por exemplo.\n\nA fim de reduzir os tempos de computa\u00e7\u00e3o utilizando o algoritmo\n\nIMPES, neste trabalho foi considerada uma variante em que uma estra-\n\nt\u00e9gia de passos de tempo diferenciados \u00e9 empregada a fim de acelerar a\n\nexecu\u00e7\u00e3o dos processos de solu\u00e7\u00e3o transiente. A variante considerada foi\n\nestudada previamente [9, 36], concluindo-se que redu\u00e7\u00f5es significativas\nno tempo de computa\u00e7\u00e3o podem ser obtidas com essa estrat\u00e9gia, sem\n\nintroduzir um erro num\u00e9rico adicional importante. Os passos principais\n\ndo algoritmo s\u00e3o descritos a seguir.\n\nDe forma pr\u00e9via ao in\u00edcio de processo de avan\u00e7o no tempo, os valores\n\ndos par\u00e2metros que independem do tempo s\u00e3o computados. Entre esses\n\npar\u00e2metros encontram-se, por exemplo, os operadores ?ef , definidos na\nequa\u00e7\u00e3o (4.9), e os fluxos relativos \u00e0 gravidade, ?f , definidos na equa\u00e7\u00e3o\n\n(5.22). Para iniciar o processo iterativo, os valores nodais da satura\u00e7\u00e3o s\u00e3o\n\ninicializados com valores correspondentes \u00e0 condi\u00e7\u00e3o inicial prescrita para\n\no problema.\n\nNa figura 5.2 est\u00e3o representadas de forma esquem\u00e1tica as opera\u00e7\u00f5es\n\nfundamentais do algoritmo, em um dado n\u00edvel de tempo durante o pro-\n\ncesso de avan\u00e7o no tempo. No n\u00edvel de tempo m , valores nodais do campo\n\nde satura\u00e7\u00e3o devem estar dispon\u00edveis, provenientes do n\u00edvel de tempo an-\n\nterior ou da condi\u00e7\u00e3o inicial do problema. Com esses valores de satura\u00e7\u00e3o,\n\nvalores nodais de ?T e ?T s\u00e3o computados em todos os n\u00f3s da malha, a\n\npartir das propriedades especificadas para os fluidos e das curvas de per-\n\nmeabilidade relativa. Em seguida, utilizando o esquema de interpola\u00e7\u00e3o\n\nescolhido, s\u00e3o determinados valores de ?T e ?T nas faces dos volumes de\n\ncontrole, necess\u00e1rios para construir as equa\u00e7\u00f5es discretizadas da press\u00e3o.\n\nAp\u00f3s realizada a montagem do sistema de equa\u00e7\u00f5es da press\u00e3o e inclu\u00eddas\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 89\n\nas condi\u00e7\u00f5es de contorno e as condi\u00e7\u00f5es de opera\u00e7\u00e3o dos po\u00e7os,5 uma\n\naproxima\u00e7\u00e3o discreta do campo \u00e9 obtida no n\u00edvel de tempo m , resolvendo\n\npara tanto o referido sistema de equa\u00e7\u00f5es. Esse \u00e9 o passo 1 representado\n\nesquematicamente na figura 5.2.\n\nt\n\nt\n\nMontagem e solu\u00e7\u00e3o do sistema de equa\u00e7\u00f5es da press\u00e3o\n\nC\u00f4mputo das vaz\u00f5es nas faces\n1\n2\n\nt3\n\nPasso de tempo para a press\u00e3o\nPasso de tempopara a satura\u00e7\u00e3o\n\nAvan\u00e7o expl\u00edcitoda satura\u00e7\u00e3o(n vezes)\n\nFigura 5.2 \u2013 Variante do algoritmo IMPES, com escalas de tempo diferentes\npara press\u00e3o e satura\u00e7\u00e3o.\n\nOs valores nodais da press\u00e3o obtidos, junto com os valores de ?T e ?T\ninterpolados nas faces, permitem determinar as vaz\u00f5es totais qf para todas\n\n5 A representa\u00e7\u00e3o dos po\u00e7os nas equa\u00e7\u00f5es discretizadas \u00e9 descrita na se\u00e7\u00e3o seguinte.\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 90\n\nas faces internas da malha, utilizando para tanto a equa\u00e7\u00e3o (5.29). Esse \u00e9 o\n\npasso 2 na figura 5.2.\n\nAp\u00f3s calcular as vaz\u00f5es nas faces, os valores nodais da satura\u00e7\u00e3o no\n\npr\u00f3ximo n\u00edvel de tempo podem ser calculados mediante a equa\u00e7\u00e3o (5.31).\n\nNa forma convencional do algoritmo IMPES, seguidamente se retornaria\n\nao passo 1, para determinar um novo campo de press\u00e3o. Entretanto, na\n\nvariante apresentada aqui, repete-se o avan\u00e7o temporal da satura\u00e7\u00e3o certo\n\nn\u00famero de vezes, com os mesmos valores das vaz\u00f5es qf , antes de atualizar\n\no campo de press\u00e3o novamente. Essa pr\u00e1tica, ilustrada no passo 3 da\n\nfigura 5.2, implica que a evolu\u00e7\u00e3o temporal da press\u00e3o e da satura\u00e7\u00e3o \u00e9\n\ndeterminada com escalas de tempo diferentes. O passo de tempo para a\n\nsatura\u00e7\u00e3o \u00e9 sempre menor, porque deve satisfazer a restri\u00e7\u00e3o imposta pelo\n\ncrit\u00e9rio CFL, a fim de garantir a estabilidade. Por outro lado, o intervalo\n\nde atualiza\u00e7\u00e3o do campo de press\u00e3o \u00e9 incrementado o mais poss\u00edvel com\n\no intuito de reduzir o tempo de computa\u00e7\u00e3o, pois a montagem e a solu\u00e7\u00e3o\n\ndo sistema de equa\u00e7\u00f5es da press\u00e3o s\u00e3o as opera\u00e7\u00f5es mais custosas de todo\n\no processo.\n\nPara completar a descri\u00e7\u00e3o do algoritmo de solu\u00e7\u00e3o, resta especificar\n\num esquema autom\u00e1tico para gerenciar o passo de tempo para a atualiza-\n\n\u00e7\u00e3o da press\u00e3o e, consequentemente, das vaz\u00f5es nas faces. Um esquema\n\nadequado deve estipular passos de tempo em que a varia\u00e7\u00e3o das vaz\u00f5es\n\nseja uniforme ao longo da simula\u00e7\u00e3o. Isto \u00e9, estipular passos de tempo\n\nmaiores quando as vaz\u00f5es variarem pouco em todo o dom\u00ednio e passos\n\nprogressivamente menores quando as vaz\u00f5es come\u00e7arem a variar forte-\n\nmente em alguma regi\u00e3o. A raz\u00e3o para associar o tamanho do passo de\n\ntempo \u00e0 varia\u00e7\u00e3o das vaz\u00f5es nas faces \u00e9 \u00f3bvia pois, no algoritmo descrito,\n\nos valores dessas vaz\u00f5es s\u00e3o mantidos constantes em cada um desses in-\n\ntervalos de tempo.\n\nNa implementa\u00e7\u00e3o realizada, o passo de tempo para a press\u00e3o \u00e9 de-\n\nterminado pela express\u00e3o\n\n?t m+nP =?t\nm\n\nP\n\n?bQ adm\nb?bQ maxcm\n\n, (5.38)\n\nem que ?t m+nP \u00e9 o novo passo de tempo, equivalente a n passos de tempo\nda satura\u00e7\u00e3o, determinado com base no passo anterior, ?t mP . Al\u00e9m disso,\nb?bQ maxcm \u00e9 um par\u00e2metro normalizado, indicador da m\u00e1xima varia\u00e7\u00e3o\ndas vaz\u00f5es em toda a malha durante o intervalo de tempo ?t mP . Por fim,\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 91\n\n?bQ adm \u00e9 o valor estipulado para essa varia\u00e7\u00e3o, isto \u00e9, o valor alvo que o\nesquema deve manter aproximadamente uniforme durante a simula\u00e7\u00e3o.\n\nO par\u00e2metro associado \u00e0 varia\u00e7\u00e3o m\u00e1xima das vaz\u00f5es no intervalo\n\n?t mP \u00e9 computado com base nos volumes de controle, mediante a rela\u00e7\u00e3o\n\nb?Q maxcm ? max\np?M\n\n?\n\n?\n\n?\n\n?\n\n?\n\nf ?Fp\n\n?\n\n?\n\n?bqf c\nm ?bqf c\n\nm?l\n?\n\n?\n\n?\n\n?p ?Vp\n\n?\n\n?\n\n?\n\n?\n\n, (5.39)\n\nna qual, como indicado, \u00e9 necess\u00e1rio percorrer todos os volumes de con-\n\ntrole da malha M a fim de determinar o valor m\u00e1ximo da express\u00e3o entre\npar\u00eanteses. Nessa express\u00e3o, bqf c\n\nm?l \u00e9 o valor de uma vaz\u00e3o no n\u00edvel de\n\ntempo imediatamente anterior a t m , na escala de tempo da press\u00e3o. \u00c9 im-\n\nportante notar que na equa\u00e7\u00e3o (5.38), b?bQ maxcm \u00e9 um valor normalizado\ndo par\u00e2metro definido na equa\u00e7\u00e3o (5.39). O fator de normaliza\u00e7\u00e3o \u00e9 o valor\n\ndo pr\u00f3prio par\u00e2metro no primeiro intervalo de tempo do processo de so-\n\nlu\u00e7\u00e3o, assumindo-se que em t = 0 todas as vaz\u00f5es s\u00e3o nulas. Experimentos\nnum\u00e9ricos indicam que valores de ?bQ adm na ordem de 10?2 conduzem a\nsolu\u00e7\u00f5es transientes sem apreci\u00e1vel erro que possa ser atribu\u00eddo \u00e0 variante\n\nno algoritmo e com significativamente menor tempo de computa\u00e7\u00e3o que\n\nusando o algoritmo IMPES convencional.\n\n5.4 Representa\u00e7\u00e3o discreta dos po\u00e7os\nDado que, em geral, o maior interesse em uma simula\u00e7\u00e3o num\u00e9rica est\u00e1\n\nfocalizado no escoamento na vizinhan\u00e7a dos po\u00e7os, \u00e9 de fundamental im-\n\nport\u00e2ncia considerar uma representa\u00e7\u00e3o acurada da trajet\u00f3ria dos po\u00e7os.\n\nDiferentemente de outras caracter\u00edsticas geom\u00e9tricas do reservat\u00f3rio, das\n\nquais geralmente s\u00f3 existem descri\u00e7\u00f5es aproximadas, as trajet\u00f3rias dos\n\npo\u00e7os s\u00e3o conhecidas com suficiente precis\u00e3o e podem inclu\u00eddas de forma\n\ndetalhada em um modelo num\u00e9rico. \u00c9 precisamente na representa\u00e7\u00e3o dis-\n\ncreta dos po\u00e7os que mais se pode aproveitar a flexibilidade geom\u00e9trica das\n\nmalhas n\u00e3o-estruturadas, especialmente quando os po\u00e7os s\u00e3o direcionais\n\nou multilaterais.\n\nA figura 5.3 ilustra, de modo esquem\u00e1tico, a abordagem considerada\n\nneste trabalho para a representa\u00e7\u00e3o dos po\u00e7os no modelo num\u00e9rico. Nela,\n\no po\u00e7o est\u00e1 constitu\u00eddo por uma sequ\u00eancia de elementos unidimensionais,\n\nos quais devem coincidir com arestas da malha volum\u00e9trica que representa\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 92\n\nz\nx y\n\nN\u00edvel de refer\u00eanciapara o po\u00e7o,\n\nPo\u00e7o\n\nN\u00f3 Por\u00e7\u00e3o de malhaem torno do po\u00e7o\n\nElemento depo\u00e7o\nFigura 5.3 \u2013 Representa\u00e7\u00e3o discreta de um po\u00e7o.\n\no reservat\u00f3rio. Dessa forma garante-se que n\u00f3s da malha, onde ser\u00e3o de-\n\nterminados valores das vari\u00e1veis relevantes do problema, estejam localiza-\n\ndos sobre a trajet\u00f3ria do po\u00e7o. Note-se, entretanto, que na representa\u00e7\u00e3o\n\ndiscreta n\u00e3o \u00e9 considerado o raio real do po\u00e7o, pois o po\u00e7o \u00e9 reduzido a\n\numa linha. A informa\u00e7\u00e3o do raio \u00e9 considerada no chamado modelo de\n\npo\u00e7o, introduzido para aproximar a rela\u00e7\u00e3o entre a vaz\u00e3o que atravessa a\n\nsuperf\u00edcie de uma por\u00e7\u00e3o do po\u00e7o e os valores nodais de press\u00e3o de po\u00e7o e\n\nreservat\u00f3rio.6 A malha volum\u00e9trica na vizinhan\u00e7a do po\u00e7o pode ser gerada\n\n6 O modelo de po\u00e7o empregado \u00e9 descrito na se\u00e7\u00e3o 5.5.\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 93\n\ncom geometria cil\u00edndrica, a qual pode capturar com mais fidelidade a es-\n\ntrutura predominantemente radial do escoamento nessa regi\u00e3o [21]. Essa\nabordagem \u00e9 uma extens\u00e3o tridimensional das malhas polares em torno\n\ndos po\u00e7os, utilizadas em alguns modelos areais de reservat\u00f3rios [27, 65].\nDuas condi\u00e7\u00f5es de opera\u00e7\u00e3o dos po\u00e7os s\u00e3o as mais comuns em pro-\n\nblemas de reservat\u00f3rios, em rela\u00e7\u00e3o \u00e0s grandezas estipuladas como dados\n\nde entrada [3]. Em uma delas \u00e9 conhecida a press\u00e3o em alguma se\u00e7\u00e3o de\nrefer\u00eancia no interior do po\u00e7o, enquanto que na outra \u00e9 estipulada a vaz\u00e3o\n\ntotal que escoa do reservat\u00f3rio para o po\u00e7o ou vice-versa. A inclus\u00e3o das\n\ncondi\u00e7\u00f5es de opera\u00e7\u00e3o dos po\u00e7os na formula\u00e7\u00e3o requer, em geral, algum\n\ntipo de modelagem do escoamento no interior do po\u00e7o, a fim de determi-\n\nnar a varia\u00e7\u00e3o da press\u00e3o na interface entre po\u00e7o e reservat\u00f3rio. A modo de\n\nexemplo, a seguir \u00e9 descrito o procedimento considerando que a press\u00e3o\n\nno interior do po\u00e7o tem varia\u00e7\u00e3o hidrost\u00e1tica. Logicamente, poderiam ser\n\nconsiderados modelos de escoamento mais completos, como os apresen-\n\ntados em [56], incluindo varia\u00e7\u00f5es de press\u00e3o causadas por atrito, entrada\nde massa, intera\u00e7\u00e3o entre fases etc.\n\nSeja ? a press\u00e3o m\u00e9dia em uma se\u00e7\u00e3o do po\u00e7o e ? a dire\u00e7\u00e3o vertical,\nem que atua a gravidade. A varia\u00e7\u00e3o dessa press\u00e3o, considerando apenas a\n\ninflu\u00eancia da gravidade, \u00e9 dada por\n\n?\nd?\nd?\n+ ??g = 0 , (5.40)\n\nonde ?? \u00e9 a densidade m\u00e9dia da mistura de fluidos escoando pelo po\u00e7o e g\n\na magnitude da acelera\u00e7\u00e3o devida \u00e0 gravidade.\n\nIntegrando a equa\u00e7\u00e3o (5.40) entre um n\u00edvel de refer\u00eancia, aqui consi-\n\nderado como o n\u00edvel do primeiro n\u00f3 do po\u00e7o, e o n\u00edvel de um n\u00f3 qualquer\n\np na trajet\u00f3ria do po\u00e7o, tem-se\n\n?\n?\n\n?p ??ref\n?\n\n+\n\n? ?p\n\n?ref\n\n??g d? = 0 . (5.41)\n\nA integral nesta equa\u00e7\u00e3o pode ser aproximada em cada elemento de\n\npo\u00e7o, pela regra do ponto m\u00e9dio [20], ap\u00f3s o qual pode ser obtida a se-\nguinte express\u00e3o para a press\u00e3o no interior do po\u00e7o, no n\u00edvel do n\u00f3 p\n\n?p ? ?ref +\n?\n\nwe?wEp -ref\n\n??we g ??we , (5.42)\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 94\n\nem que wEp -ref \u00e9 o conjunto de elementos de po\u00e7o entre os n\u00edveis de re-\nfer\u00eancia e o do n\u00f3 p . Al\u00e9m disso, ??we = ?p 2 ??p1 \u00e9 o comprimento da\nproje\u00e7\u00e3o do elemento de po\u00e7o na dire\u00e7\u00e3o vertical e ??we =\n\n1\n2\n\n?\n\n??p1 +??p 2\n?\n\n\u00e9 a densidade m\u00e9dia da mistura nesse elemento. Como mostrado na fi-\n\ngura 5.3, p 1 e p 2 s\u00e3o os n\u00f3s nas duas extremidades do elemento de po\u00e7o\n\nem quest\u00e3o, we . Por sua vez, a densidade da mistura em cada n\u00f3, pode\n\nser aproximada como uma m\u00e9dia ponderada das densidades das fases,\n\nlevando em conta a quantidade de cada fase na por\u00e7\u00e3o do po\u00e7o associada.\n\nA figura 5.4 mostra um volume de controle da malha do reservat\u00f3rio\n\nque cont\u00e9m um n\u00f3 de po\u00e7o. Conforme se observa, um desses volumes\n\nenvolve a metade de dois elementos de po\u00e7o adjacentes.7 Como \u00e9 l\u00f3gico,\n\na vaz\u00e3o entre o volume de controle e essas por\u00e7\u00f5es de elementos de po\u00e7o\n\ndeve ser levada em conta nas suas equa\u00e7\u00f5es de balan\u00e7o. Assim, por exem-\n\nplo, na equa\u00e7\u00e3o da press\u00e3o, que prov\u00e9m de um balan\u00e7o global das duas\n\nfases, ter-se-ria\n\n?\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?\n\n`?N e\n?f , p (?T)?f ?\n\ne\nf,` P?\n\ne\n`\n+\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?f , p (?T)?f ?f + $p = 0 , (5.43)\n\nem que o termo adicional $p \u00e9 a vaz\u00e3o total entre po\u00e7o e volume de con-\n\ntrole, positiva se abandona o volume e negativa no caso contr\u00e1rio.8 Se-\n\nguindo a pr\u00e1tica normal em simula\u00e7\u00e3o de reservat\u00f3rios, essa vaz\u00e3o \u00e9 rela-\n\ncionada com a diferen\u00e7a entre a press\u00e3o nodal Pp e a press\u00e3o no interior\n\ndo po\u00e7o ?p , por meio de uma express\u00e3o da forma\n\n$p = (?T)p WIp\n?\n\nP?p ??p\n?\n\n. (5.44)\n\nNesta rela\u00e7\u00e3o, WIp \u00e9 o denominado \u00edndice de produtividade do po\u00e7o\n\nou, simplesmente, \u00edndice de po\u00e7o [10, 61], para a por\u00e7\u00e3o de po\u00e7o em con-\ntato com o volume considerado. A determina\u00e7\u00e3o de valores de WIp apro-\n\npriados \u00e0 discretiza\u00e7\u00e3o considerada neste trabalho \u00e9 descrita na se\u00e7\u00e3o 5.5.\n\nA fim de se obter uma express\u00e3o final para a equa\u00e7\u00e3o da press\u00e3o para\n\nvolumes em contato com po\u00e7os, a equa\u00e7\u00e3o (5.42) pode ser substitu\u00edda em\n\n(5.44) e o resultado substitu\u00eddo ainda em (5.43), chegando-se ent\u00e3o a\n\n7 No entanto, se o n\u00f3 em quest\u00e3o estiver localizado em uma extremidade do po\u00e7o, o\nvolume de controle estar\u00e1 em contato apenas com a metade de um elemento de po\u00e7o.\n\n8 A equa\u00e7\u00e3o (5.43) prov\u00e9m da equa\u00e7\u00e3o (5.24). Os \u00edndices correspondentes ao n\u00edvel de\ntempo foram omitidos a fim de simplificar a nota\u00e7\u00e3o.\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 95\n\nVolume decontrole\n\nPo\u00e7o\n\nN\u00f3\n\nVaz\u00e3o do volumeao po\u00e7o:\nFigura 5.4 \u2013 Volume de controle associado a um n\u00f3 sobre o po\u00e7o.\n\n?\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?\n\n`?N e\n?f , p (?T)?f ?\n\ne\nf,` P?\n\ne\n`\n+\n?\n\ne?Ep\n\n?\n\nf ?F ep\n\n?f , p (?T)?f ?f +\n\n(?T)p WIp\n?\n\nP?p ??ref ???p -ref\n?\n\n= 0 ,\n\n(5.45)\n\nem que ??p -ref \u00e9 uma nota\u00e7\u00e3o compacta para o somat\u00f3rio da equa\u00e7\u00e3o\n(5.42), ou seja\n\n??p -ref ?\n?\n\nwe?wEp -ref\n\n??we g ??we . (5.46)\n\nA equa\u00e7\u00e3o (5.45) \u00e9 v\u00e1lida para todos os volumes de controle associados\n\na n\u00f3s a longo da trajet\u00f3ria de um po\u00e7o produtor ou injetor. No caso em\n\nque o valor da press\u00e3o de refer\u00eancia ?ref for estipulado como condi\u00e7\u00e3o\nde opera\u00e7\u00e3o do po\u00e7o, nenhuma inc\u00f3gnita adicional ser\u00e1 acrescentada na\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 96\n\nequa\u00e7\u00e3o da press\u00e3o pela inclus\u00e3o do termo associado \u00e0 vaz\u00e3o para o po\u00e7o.\n\nIsto porque valores de ??p -ref podem ser avaliados diretamente com a\nequa\u00e7\u00e3o (5.46).9\n\nQuando o valor estipulado for a vaz\u00e3o total que ingressa ou abandona\n\no po\u00e7o, ?ref \u00e9 uma inc\u00f3gnita adicional nas equa\u00e7\u00f5es da press\u00e3o de todos\nos volumes de controle em contato com o po\u00e7o. Logo, precisa-se de uma\n\nequa\u00e7\u00e3o adicional para que o sistema de equa\u00e7\u00f5es da press\u00e3o possa ser\n\nresolvido. Essa equa\u00e7\u00e3o prov\u00e9m do balan\u00e7o global para o po\u00e7o completo,\n\no qual pode ser escrito como\n\n$W ?\n?\n\np?W\n\n$p = 0 , (5.47)\n\nonde $W \u00e9 o valor estipulado para a vaz\u00e3o total que ingressa ou abandona\n\no po\u00e7o, segundo se trate de um po\u00e7o injetor ou produtor. O sinal de $W \u00e9\n\npositivo no primeiro caso e negativo no segundo. Substituindo a express\u00e3o\n\npara as vaz\u00f5es individuais em cada volume de controle, dada na equa\u00e7\u00e3o\n\n(5.44), obt\u00e9m-se\n\n$W ?\n?\n\np?W\n\n(?T)p WIp\n?\n\nP?p ??ref ???p -ref\n?\n\n= 0 . (5.48)\n\nEsta equa\u00e7\u00e3o possui como inc\u00f3gnitas todos os valores nodais da pres-\n\ns\u00e3o ao longo do po\u00e7o, al\u00e9m do valor da press\u00e3o do po\u00e7o no n\u00edvel de refer\u00ean-\n\ncia. Uma equa\u00e7\u00e3o desse tipo deve ser acrescentada no sistema de equa\u00e7\u00f5es\n\nda press\u00e3o, para cada po\u00e7o em que um valor da vaz\u00e3o total seja estipulado.\n\nPor outro lado, a equa\u00e7\u00e3o da satura\u00e7\u00e3o correspondente aos volumes\n\nem contato com um po\u00e7o deve incluir tamb\u00e9m um termo adicional. Uma\n\nvez que essa equa\u00e7\u00e3o representa um balan\u00e7o da fase \u00e1gua, o termo adi-\n\ncional \u00e9 dado por (Fw)p$p , que \u00e9 fra\u00e7\u00e3o da vaz\u00e3o entre volume de con-\ntrole e po\u00e7o que corresponde \u00e0 fase \u00e1gua. Independentemente de qual\n\nfor a condi\u00e7\u00e3o de opera\u00e7\u00e3o estipulada para o po\u00e7o, a vaz\u00e3o $p pode ser\n\ncomputada com a equa\u00e7\u00e3o (5.44), ap\u00f3s resolver o sistema de equa\u00e7\u00f5es da\n\npress\u00e3o. Dado que no n\u00edvel de tempo t m , ao qual correspondem todos os\n\ntermos analisados, encontram-se dispon\u00edveis valores nodais da satura\u00e7\u00e3o,\n\no valor de (Fw)p pode ser facilmente computado tamb\u00e9m.\n\n9 Entretanto, modelos mais detalhados do escoamento no interior do po\u00e7o podem intro-\nduzir n\u00e3o-linearidades e acoplamentos adicionais que requeiram um tratamento especial no\nprocesso de solu\u00e7\u00e3o.\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 97\n\n5.5 Modelo de po\u00e7o\nUma das principais caracter\u00edsticas do escoamento na vizinhan\u00e7a de um\n\npo\u00e7o \u00e9 a forte varia\u00e7\u00e3o da press\u00e3o e, consequentemente, da velocidade\n\nnessa regi\u00e3o. Mesmo representando de maneira precisa a trajet\u00f3ria do\n\npo\u00e7o na malha, como descrito na se\u00e7\u00e3o anterior, para captar de forma\n\nadequada os fortes gradientes de press\u00e3o seria necess\u00e1rio tamb\u00e9m refinar\n\nextremamente a malha adjacente ao po\u00e7o na dire\u00e7\u00e3o radial. Uma vez que\n\no di\u00e2metro t\u00edpico de um po\u00e7o e v\u00e1rias ordens de grandeza menor que as\n\ndimens\u00f5es normais de um reservat\u00f3rio, um refino dessa natureza \u00e9 geral-\n\nmente impratic\u00e1vel, pois aumentaria excessivamente o n\u00famero de inc\u00f3g-\n\nnitas do modelo num\u00e9rico. A dificuldade torna-se mais cr\u00edtica porque a\n\nvaz\u00e3o entre o reservat\u00f3rio e um po\u00e7o deveria ser normalmente computada\n\ncom os gradientes de press\u00e3o na sua vizinhan\u00e7a. Logo, se com a malha uti-\n\nlizada n\u00e3o fosse poss\u00edvel captar adequadamente esses gradientes, um erro\n\nde magnitude inaceit\u00e1vel seria introduzido na solu\u00e7\u00e3o num\u00e9rica, devido \u00e0\n\nimport\u00e2ncia trascendental da vaz\u00e3o desde ou para os po\u00e7os.\n\nPara contornar ese tipo de dificuldades, desde os prim\u00f3rdios da si-\n\nmula\u00e7\u00e3o de reservat\u00f3rios s\u00e3o empregados os denominados modelos de\n\npo\u00e7o [10, 61]. O intuito desses modelos \u00e9 desvincular o c\u00f4mputo da vaz\u00e3o\nda aproxima\u00e7\u00e3o num\u00e9rica do gradiente de press\u00e3o adjacente aos po\u00e7os.\n\nIsto geralmente \u00e9 conseguido introduzindo hip\u00f3teses adicionais quanto \u00e0\n\nnatureza do escoamento na vizinhan\u00e7a imediata aos po\u00e7os.\n\nPara um escoamento monof\u00e1sico, o modelo de po\u00e7o \u00e9 normalmente\n\ndado pela express\u00e3o\n\n$ =\nWI\n\n\u00b5\n\n?\n\nPp ??\n?\n\n, (5.49)\n\nonde, como ilustrado na figura 5.5 para um caso bidimensional, $ \u00e9 a va-\n\nz\u00e3o entre o reservat\u00f3rio e o po\u00e7o, Pp \u00e9 a press\u00e3o nodal associada ao volume\n\nonde o po\u00e7o se encontra e ? \u00e9 a press\u00e3o na superf\u00edcie do po\u00e7o. A equa\u00e7\u00e3o\n(5.49) pode ser considerada a defini\u00e7\u00e3o do \u00edndice de po\u00e7o WI, o qual \u00e9 um\n\npar\u00e2metro que depende apenas da permeabilidade e das geometrias do\n\npo\u00e7o e da malha na regi\u00e3o adjacente ao po\u00e7o. De fato, a quest\u00e3o chave de\n\num modelo de po\u00e7o \u00e9 a determina\u00e7\u00e3o do valor de WI adequado para uma\n\ndada configura\u00e7\u00e3o geom\u00e9trica do po\u00e7o em rela\u00e7\u00e3o \u00e0 malha circundante.\n\nA extens\u00e3o da equa\u00e7\u00e3o (5.49) para escoamentos multif\u00e1sicos \u00e9 direta,\n\nsendo necess\u00e1rio apenas introduzir a permeabilidade relativa, do mesmo\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 98\n\nVaz\u00e3oN\u00f3 com press\u00e3o\nPo\u00e7o de raio W Press\u00e3o\n\nx\ny\n\nFigura 5.5 \u2013 Grandezas envolvidas em um modelo de po\u00e7o convencional.\n\nmodo que \u00e9 realizado para aplicar a lei de Darcy a v\u00e1rias fases. Essa forma\n\ndo modelo de po\u00e7o pode ser escrita de modo compacto como\n\n$? = ??WI\n?\n\nPp ??\n?\n\n, (5.50)\n\nem que $? e ?? s\u00e3o, respectivamente, a vaz\u00e3o e a mobilidade 10 da fase\n\ngen\u00e9rica ?. Admite-se que o valor do \u00edndice de po\u00e7o WI na equa\u00e7\u00e3o (5.50)\n\n\u00e9 o mesmo que o da equa\u00e7\u00e3o (5.49) para escoamento monof\u00e1sico. Por\n\ntal raz\u00e3o, os valores dos \u00edndices de po\u00e7o s\u00e3o determinados usualmente\n\nconsiderando escoamentos monof\u00e1sicos, mesmo que sua aplica\u00e7\u00e3o final\n\nseja em problemas multif\u00e1sicos [10].\nA primeira deriva\u00e7\u00e3o de uma express\u00e3o anal\u00edtica para calcular o \u00edndice\n\nde po\u00e7o foi feita por Peaceman [61], para modelos num\u00e9ricos baseados em\nmalhas cartesianas regulares. Diversas extens\u00f5es e generaliza\u00e7\u00f5es foram\n\nrealizadas posteriormente na correla\u00e7\u00e3o de Peaceman [14, 62\u201364], as quais\ns\u00e3o amplamente utilizadas em simuladores comerciais. Infelizmente, es-\n\nquemas anal\u00edticos desse tipo n\u00e3o podem ser aplicados diretamente a uma\n\nformula\u00e7\u00e3o em malhas n\u00e3o-estruturadas, devido ao forte enraizamento\n\ndesses esquemas na configura\u00e7\u00e3o geom\u00e9trica simples das malhas estru-\n\nturadas.\n\n10 Conforme mostra a equa\u00e7\u00e3o (5.5), a permeabilidade relativa est\u00e1 envolvida na defini\u00e7\u00e3o\nda mobilidade.\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 99\n\nNeste trabalho \u00e9 considerada uma abordagem diferente \u00e0 convencio-\n\nnal, baseada na metodologia proposta por Aavastmark e Klausen em [1].11\n\nEssa metodologia \u00e9 suficientemente geral como para ser aplicada com ma-\n\nlhas tanto estruturadas como n\u00e3o-estruturadas e em duas ou tr\u00eas dimen-\n\ns\u00f5es. O delineamento geral do m\u00e9todo pode ser mais facilmente descrito\n\nconsiderando inicialmente uma situa\u00e7\u00e3o bidimensional, e depois ser es-\n\ntendido a casos tridimensionais, como feito a seguir.\n\nConsidere-se o problema esbo\u00e7ado na figura 5.6(a), em que um po\u00e7o\n\nprodutor de raio rW encontra-se localizado na origem de um dom\u00ednio bi-\n\ndimensional infinito. No regime estacion\u00e1rio, um escoamento monof\u00e1sico\n\nincompress\u00edvel dirigido na dire\u00e7\u00e3o do po\u00e7o pode ser descrito pelas equa-\n\n\u00e7\u00f5es\n\n? \u00b7 v = 0 , (5.51)\n\nv = ?\nK\n\n\u00b5\n?P , (5.52)\n\nsujeitas \u00e0s seguintes restri\u00e7\u00f5es na interface entre po\u00e7o e reservat\u00f3rio\n\nP |r=rW = ?, (5.53)\n?\n\nr=rW\n\nv \u00b7 dS = $. (5.54)\n\nNeste modelo simples, o meio \u00e9 considerado homog\u00eaneo, por\u00e9m, com\n\npossibilidade de ser anisotr\u00f3pico. A solu\u00e7\u00e3o do problema descrito acima\n\npode ser determinada analiticamente e \u00e9 dada por uma fun\u00e7\u00e3o cont\u00ednua\n\nP(x , y ), para qualquer ponto exterior ao po\u00e7o.12 Nessa solu\u00e7\u00e3o anal\u00edtica,\na press\u00e3o varia de forma logar\u00edtmica e as isolinhas s\u00e3o elipses com semi-\n\neixos nas dire\u00e7\u00f5es principais do tensor permeabilidade. \u00c0 medida que se\n\nafastam do po\u00e7o, por\u00e9m, as isolinhas tendem a tornar-se circulares.\n\nNa metodologia considerada, para determinar um \u00edndice de po\u00e7o asso-\n\nciado a uma dada malha, o problema monof\u00e1sico descrito deve ser resol-\n\nvido numericamente. Para tanto, deve ser considerada uma por\u00e7\u00e3o da ma-\n\nlha que inclua o po\u00e7o e um n\u00famero adequado de elementos. No problema\n\n11 Apesar de n\u00e3o ser citada em [1], uma metodologia semelhante tinha sido esbo\u00e7ada\npreviamente por Morita et al. [54].\n\n12 A obten\u00e7\u00e3o da solu\u00e7\u00e3o P(x , y ) \u00e9 descrita em detalhes no ap\u00eandice C da refer\u00eancia [62],\npara o caso em que K \u00e9 dado por um tensor diagonal. A solu\u00e7\u00e3o para um tensor K completo\nrequer a diagonaliza\u00e7\u00e3o do tensor como passo pr\u00e9vio.\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 100\n\nCondi\u00e7\u00e3o de Dirichleta partir de\n\nN\u00f3 do po\u00e7o\n\nSolu\u00e7\u00e3o anal\u00edtica:\n\n(a) Especifica\u00e7\u00e3o do problema (b) Enfoque num\u00e9rico\n\nFigura 5.6 \u2013 Problema auxiliar para a determina\u00e7\u00e3o do \u00edndice de po\u00e7o em\nduas dimens\u00f5es.\n\nnum\u00e9rico auxiliar, conforme ilustra a figura 5.6(b), a fronteira externa do\n\ndom\u00ednio \u00e9 sujeita a condi\u00e7\u00f5es de Dirichlet, com valores determinados a\n\npartir da solu\u00e7\u00e3o anal\u00edtica P(x , y ). Para tanto, s\u00e3o considerados valores\narbitr\u00e1rios da vaz\u00e3o $, da press\u00e3o do po\u00e7o ? e da viscosidade \u00b5. A per-\nmeabilidade K deve ser considerada com o valor tensorial especificado\nno problema original para os elementos no subdom\u00ednio auxiliar. Existe\n\na restri\u00e7\u00e3o, entretanto, que esse valor deve ser \u00fanico para todos esses ele-\n\nmentos, a fim de respeitar a hip\u00f3tese de meio homog\u00eaneo considerada na\n\nsolu\u00e7\u00e3o anal\u00edtica. Por fim, para completar a especifica\u00e7\u00e3o do problema\n\nauxiliar, no volume de controle que inclui o po\u00e7o \u00e9 considerada a vaz\u00e3o $,\n\ncom o mesmo valor considerado na solu\u00e7\u00e3o anal\u00edtica. A pesar de n\u00e3o ser\n\nestritamente necess\u00e1rio, no esquema considerado neste trabalho um n\u00f3\n\nsempre coincide com a localiza\u00e7\u00e3o do po\u00e7o. Como \u00e9 logico, para resolver\n\no problema num\u00e9rico auxiliar deve ser considerada a mesma discretiza-\n\n\u00e7\u00e3o que ir\u00e1 ser utilizada depois no modelo num\u00e9rico para o reservat\u00f3rio\n\ncompleto.\n\nIdealmente, a solu\u00e7\u00e3o num\u00e9rica do problema auxiliar deveria ser pr\u00f3-\n\nxima \u00e0 solu\u00e7\u00e3o anal\u00edtica, pois em ambos os casos o problema resolvido \u00e9 o\n\nmesmo. No entanto, em geral, com as malhas utilizadas normalmente n\u00e3o\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 101\n\n\u00e9 poss\u00edvel capturar a forte varia\u00e7\u00e3o da press\u00e3o na regi\u00e3o adjacente ao po\u00e7o,\n\npor n\u00e3o serem refinadas o suficiente. Na fronteira do subdom\u00ednio auxiliar\n\nambas as solu\u00e7\u00f5es coincidir\u00e3o, pela imposi\u00e7\u00e3o das condi\u00e7\u00f5es de Dirichlet\n\na partir da solu\u00e7\u00e3o anal\u00edtica. Por\u00e9m, \u00e0 medida que os pontos se aproxima-\n\nrem do po\u00e7o, a discrep\u00e2ncia entre ambas as solu\u00e7\u00f5es aumentar\u00e1, em geral,\n\nde forma acentuada. Desse modo, a discrep\u00e2ncia se torna m\u00e1xima no n\u00f3\n\nda malha coincidente com o po\u00e7o.13 A diferen\u00e7a entre a press\u00e3o Pp nesse\n\nn\u00f3 e a press\u00e3o ? pode ser considerada como uma medida da insufici\u00eancia\nda formula\u00e7\u00e3o num\u00e9rica para capturar a varia\u00e7\u00e3o exata da press\u00e3o na vizi-\n\nnhan\u00e7a do po\u00e7o. O papel do modelo de po\u00e7o \u00e9, precisamente, compensar\n\nessa insufici\u00eancia relacionando o valor exato da vaz\u00e3o com essa diferen\u00e7a\n\nde press\u00f5es. Como mostra a equa\u00e7\u00e3o (5.49), o \u00edndice de po\u00e7o \u00e9 definido\n\ncomo fator de proporcionalidade entre essa duas grandezas.\n\nNo procedimento descrito, ap\u00f3s ser resolvido o problema num\u00e9rico\n\nauxiliar, o valor correspondente ao \u00edndice de po\u00e7o pode ser determinado\n\npela express\u00e3o seguinte, derivada da equa\u00e7\u00e3o (5.49),\n\nWI =\n\n?\n\n\u00b5$\n\nPp ??\n\n?\n\naux\n\n. (5.55)\n\nO valor do \u00edndice de po\u00e7o assim computado pode ser aplicado depois\n\n\u00e0 solu\u00e7\u00e3o de problemas na malha completa do reservat\u00f3rio. Uma vez que\n\na infu\u00eancia das condi\u00e7\u00f5es em outros po\u00e7os ou nos contornos sobre o esco-\n\namento na vizinhan\u00e7a imediata de um po\u00e7o \u00e9 m\u00ednima [1, 54], assume-se\nque o valor do \u00edndice de po\u00e7o n\u00e3o estar\u00e1 influenciado de forma signifi-\n\ncativa por essas condi\u00e7\u00f5es. Al\u00e9m disso, dada linearidade da rela\u00e7\u00e3o entre\n\nvelocidade e gradiente de press\u00e3o na lei de Darcy, o valor do \u00edndice de po\u00e7o\n\ndever\u00e1 manter-se inalterado quando forem utilizados valores de vaz\u00e3o ou\n\npress\u00e3o diferentes aos considerados no problema auxiliar descrito.\n\nPor outro lado, da mesma forma que nas correla\u00e7\u00f5es de Peaceman,\n\no valor do \u00edndice de po\u00e7o obtido pela equa\u00e7\u00e3o (5.55) carrega informa\u00e7\u00e3o\n\ngeom\u00e9trica da malha circundante ao po\u00e7o, al\u00e9m da permeabilidade nessa\n\nregi\u00e3o. Entretanto, no procedimento descrito acima essa informa\u00e7\u00e3o \u00e9\n\nintroduzida de modo indireto, na discretiza\u00e7\u00e3o do problema auxiliar. \u00c9\n\npor tal raz\u00e3o, que resulta imprescind\u00edvel que essa discretiza\u00e7\u00e3o inclua o\n\n13 Nessa an\u00e1lise \u00e9 desconsiderado o raio do po\u00e7o, cujo valor \u00e9, em geral, insignificante\nquando comparado com o tamanho dos elementos da malha.\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 102\n\nmesmo tipo de aproxima\u00e7\u00f5es para os fluxos difusivos que a discretiza\u00e7\u00e3o\n\ndo problema completo.\n\nO mesmo enfoque descrito pode ser utilizado em situa\u00e7\u00f5es tridimen-\n\nsionais, fazendo-se algumas considera\u00e7\u00f5es adicionais. A diferen\u00e7a mais\n\nimportante \u00e9 que em tr\u00eas dimens\u00f5es existem v\u00e1rios n\u00f3s ao longo de um\n\npo\u00e7o. Em consequ\u00eancia, a cada um desses n\u00f3s deve ser associado um\n\n\u00edndice de po\u00e7o que permita calcular a vaz\u00e3o para o volume de controle\n\ncorrespondente. A fim de determinar os valores desses \u00edndices de po\u00e7o,\n\ncada elemento de po\u00e7o deve ser considerado de forma separada. Em tr\u00eas\n\ndimens\u00f5es, solu\u00e7\u00f5es anal\u00edticas simples somente podem ser determinadas\n\nconsiderando um po\u00e7o reto de comprimento infinito em um meio ho-\n\nmog\u00eaneo infinito.14 Logo, para cada elemento de po\u00e7o \u00e9 associado um\n\nproblema auxiliar equivalente ao descrito para o caso bidimensional, con-\n\nsiderando que o po\u00e7o se estende indefinidamente na dire\u00e7\u00e3o do elemento\n\nem quest\u00e3o.\n\nA situa\u00e7\u00e3o descrita encontra-se ilustrada de modo esquem\u00e1tico na\n\nfigura 5.7. Para resolver numericamente o problema auxiliar \u00e9 conside-\n\nrada uma por\u00e7\u00e3o da malha com certo n\u00famero de elementos ao redor do\n\nsegmento de po\u00e7o. Experimentos num\u00e9ricos mostram que duas ou tr\u00eas\n\ncamadas de elementos ao redor do segmento s\u00e3o adequados para obter\n\nresultados suficientemente precisos para o \u00edndice de po\u00e7o. No contorno\n\nexterno da submalha auxiliar \u00e9 prescrita a condi\u00e7\u00e3o de Dirichlet, com valo-\n\nres determinados por meio da solu\u00e7\u00e3o anal\u00edtica. As outras duas fronteiras\n\ns\u00e3o consideradas imperme\u00e1veis e pelo segmento de po\u00e7o considera-se que\n\natravessa uma vaz\u00e3o uniforme $.\n\nDepois de resolver o problema auxiliar, valores nodais da press\u00e3o es-\n\ntar\u00e3o dispon\u00edveis para os n\u00f3s p 1 e p 2 , localizados nas extremidades do\n\nelemento de po\u00e7o. A cada um desses n\u00f3s deve ser associado um valor de\n\n\u00edndice de po\u00e7o proveniente do problema auxiliar. Na discretiza\u00e7\u00e3o desse\n\nproblema, a vaz\u00e3o $\u00e9 repartida em partes iguais entre os dois volumes de\n\ncontrole associados aos n\u00f3s p 1 e p 2 . Logo, para cada um desses n\u00f3s \u00e9 pos-\n\ns\u00edvel escrever express\u00f5es an\u00e1logas \u00e0 equa\u00e7\u00e3o (5.55), por\u00e9m, considerando\n\na vaz\u00e3o $/2. Isto \u00e9,\n\nWI\nwe\np1 =\n\n1\n\n2\n\n?\n\n\u00b5$\n\nPp1??\n\n?\n\naux\n\n, (5.56)\n\n14 A solu\u00e7\u00e3o anal\u00edtica considerada neste trabalho \u00e9 a derivada por Aavatsmark e Klausen\nem [1].\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 103\n\nWI\nwe\np2 =\n\n1\n\n2\n\n?\n\n\u00b5$\n\nPp2??\n\n?\n\naux\n\n. (5.57)\n\nPo\u00e7o\n\nVaz\u00e3o ao elemento            de po\u00e7o:\nCondi\u00e7\u00e3o de Dirichleta partir da solu\u00e7\u00e3o anal\u00edtica \n\nN\u00f3\n\nN\u00f3\n\nFigura 5.7 \u2013 Submalha no problema auxiliar para a determina\u00e7\u00e3o do \u00edndice\nde po\u00e7o em tr\u00eas dimens\u00f5es.\n\nOs \u00edndices de po\u00e7o nas equa\u00e7\u00f5es (5.56) e (5.57) carregam o \u00edndice we\n\nporque s\u00e3o valores parciais referidos apenas ao elemento de po\u00e7o consi-\n\nderado no problema auxiliar. Segundo mostra a figura 5.4, todo volume de\n\ncontrole em contato com um po\u00e7o, exceto os dois nas duas extremidades,\n\nenvolve as metades de dois elementos de po\u00e7o. O valor do \u00edndice de po\u00e7o\n\ndado pela equa\u00e7\u00e3o (5.56) ou pela equa\u00e7\u00e3o (5.57) corresponde a uma dessas\n\nmetades. Para todos os n\u00f3s de po\u00e7o, menos os das extremidades, o valor\n\na ser utilizado para o volume de controle completo deve ser a soma dos\n\nvalores parciais correspondentes \u00e0s duas metades associadas ao n\u00f3. De\n\n\n\nA PLI CA\u00c7\u00c3O A UM M O DELO DE ESCOA M ENTO EM R ESERVAT\u00d3 R IO S 104\n\nforma simb\u00f3lica, pode-se escrever\n\nWIp =\n?\n\nwe?wEp\n\nWI\nwe\np , (5.58)\n\nonde wEp \u00e9 o conjunto de elementos de po\u00e7o associados ao n\u00f3 p . Esse\nconjunto ter\u00e1 dois elementos para todos os n\u00f3s de um po\u00e7o, exceto os das\n\nextremidades, que somente ter\u00e1 um.\n\n\n\nCAP\u00cdTULO\n\n6\nExemplos de aplica\u00e7\u00e3o\n\nNeste cap\u00edtulo s\u00e3o apresentados diversos problemas resolvidos aplicando\n\na formula\u00e7\u00e3o num\u00e9rica descrita nos cap\u00edtulos precedentes. Os problemas\n\napresentados foram escolhidos de modo que fosse poss\u00edvel testar diferen-\n\ntes aspectos das solu\u00e7\u00f5es num\u00e9ricas. Na maioria dos casos, tratam-se de\n\nsitua\u00e7\u00f5es f\u00edsicas descritas por equa\u00e7\u00f5es diferenciais simplificadas, as quais\n\napresentam algumas caracter\u00edsticas comuns com as equa\u00e7\u00f5es do modelo\n\nde escoamento bif\u00e1sico considerado no cap\u00edtulo 5. Al\u00e9m de considerar\n\nequa\u00e7\u00f5es simplificadas, s\u00e3o considerados tamb\u00e9m dom\u00ednios de geometria\n\nregular, a fim de tornar poss\u00edvel a obten\u00e7\u00e3o de solu\u00e7\u00f5es anal\u00edticas exatas,\n\ncom as quais as solu\u00e7\u00f5es num\u00e9ricas s\u00e3o comparadas. Em alguns casos\n\nfaz-se uso da t\u00e9cnica denominada das solu\u00e7\u00f5es manufaturadas [72], na\nqual prop\u00f5e-se a solu\u00e7\u00e3o exata para uma equa\u00e7\u00e3o diferencial e, por meio\n\nde diferencia\u00e7\u00e3o, determina-se a express\u00e3o matem\u00e1tica do termo fonte\n\ncorrespondente \u00e0 equa\u00e7\u00e3o. Esses diversos problemas com solu\u00e7\u00f5es conhe-\n\ncidas permitem testar, de forma separada, as caracter\u00edsticas fundamentais\n\ndo modelo num\u00e9rico empregado para a simula\u00e7\u00e3o de reservat\u00f3rios.\n\nDe posse da solu\u00e7\u00e3o exata para um problema, \u00e9 poss\u00edvel determinar\n\na magnitude do erro de discretiza\u00e7\u00e3o de uma solu\u00e7\u00e3o num\u00e9rica para o\n\nproblema. Isto permite, por sua vez, analisar o comportamento do erro de\n\ndiscretiza\u00e7\u00e3o \u00e0 medida que as malhas s\u00e3o refinadas e determinar a ordem\n\n105\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 106\n\nde converg\u00eancia da discretiza\u00e7\u00e3o, isto \u00e9, a taxa de diminui\u00e7\u00e3o desse erro\n\nquando o tamanho m\u00e9dio dos elementos da malha \u00e9 reduzido. Sempre que\n\nposs\u00edvel, uma an\u00e1lise de converg\u00eancia desse tipo \u00e9 realizada nos proble-\n\nmas apresentados neste cap\u00edtulo. Quando pertinente, \u00e9 analisada tamb\u00e9m\n\na influ\u00eancia de algumas caracter\u00edsticas das malhas e/ou do problema sobre\na ordem de converg\u00eancia.\n\nO modelo de po\u00e7o considerado neste trabalho \u00e9 tamb\u00e9m objeto de\n\nverifica\u00e7\u00e3o em um dos problemas deste cap\u00edtulo. Entretanto, nesse caso a\n\nobten\u00e7\u00e3o de uma solu\u00e7\u00e3o exata apresenta maior dificuldade e por tal raz\u00e3o\n\noptou-se por utilizar uma solu\u00e7\u00e3o num\u00e9rica como solu\u00e7\u00e3o de refer\u00eancia\n\npara realizar as compara\u00e7\u00f5es. Nessa malha, a superf\u00edcie e a vizinhan\u00e7a do\n\npo\u00e7o s\u00e3o discretizadas com um grau de refino suficiente para dispensar o\n\nuso de um modelo de po\u00e7o.\n\nUm problema de recupera\u00e7\u00e3o secund\u00e1ria de \u00f3leo em um reservat\u00f3rio\n\nde geometria complexa \u00e9 considerado na parte final deste cap\u00edtulo. Dado\n\nque a obten\u00e7\u00e3o da solu\u00e7\u00e3o exata para um problema dessa natureza est\u00e1\n\nfora de quest\u00e3o, alguns aspectos da solu\u00e7\u00e3o num\u00e9rica desse problema s\u00e3o\n\napresentados apenas com car\u00e1ter ilustrativo, sem qualquer compara\u00e7\u00e3o\n\nou verifica\u00e7\u00e3o.\n\nTodos os resultados apresentados neste cap\u00edtulo foram obtidos com\n\nc\u00f3digos implementados na linguagem C ++, com a aux\u00edlio das bibliotecas\n\nEFVLib e ACMLib. A biblioteca EFVLib [47], cujo objetivo \u00e9 a sistemati-\nza\u00e7\u00e3o da implementa\u00e7\u00e3o de formula\u00e7\u00f5es de volumes finitos baseadas em\n\nelementos, foi desenvolvida com a fundamenta\u00e7\u00e3o te\u00f3rica apresentada\n\nneste trabalho. J\u00e1 a biblioteca ACMLib [46] permite a solu\u00e7\u00e3o dos sistemas\nde equa\u00e7\u00f5es lineares, oriundos do processo de discretiza\u00e7\u00e3o, pelo m\u00e9todo\n\nmultigrid de corre\u00e7\u00f5es aditivas [18, 39]. Para todos os problemas apre-\nsentados neste cap\u00edtulo, os sistemas de equa\u00e7\u00f5es lineares foram resolvidos\n\ncom o referido m\u00e9todo, iterando-se at\u00e9 a norma L 2 dos res\u00edduos do sistema\n\nser menor que 10?8.\n\n6.1 Problemas de difus\u00e3o\n\nNesta se\u00e7\u00e3o s\u00e3o considerados problemas descritos pela equa\u00e7\u00e3o diferen-\n\ncial el\u00edptica\n\n?? \u00b7 K?P = ?(x , y , z) em ?, (6.1)\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 107\n\nem que o dom\u00ednio ? \u00e9 o cubo unit\u00e1rio 0 \u00b6 x \u00b6 1; 0 \u00b6 y \u00b6 1; 0 \u00b6 z \u00b6 1. O\ncontorno ?? desse dom\u00ednio \u00e9 sujeito \u00e0 condi\u00e7\u00e3o de Dirichlet\n\nP = P Dir(x , y , z) em ??. (6.2)\n\nA equa\u00e7\u00e3o (6.1) pode ser considerada um prot\u00f3tipo da equa\u00e7\u00e3o da\n\npress\u00e3o em uma formula\u00e7\u00e3o de escoamento multif\u00e1sico. A representa\u00e7\u00e3o\n\ndiscreta de um termo diferencial de segunda ordem da forma que aparece\n\nnessa equa\u00e7\u00e3o \u00e9 um dos ingredientes fundamentais de qualquer formu-\n\nla\u00e7\u00e3o num\u00e9rica para simula\u00e7\u00e3o de reservat\u00f3rios. O prop\u00f3sito dos testes\n\napresentados aqui \u00e9 verificar a ordem de converg\u00eancia para uma vari\u00e1vel\n\neliptica para os diferentes tipos de elementos considerados. Al\u00e9m disso,\n\nprocura-se identificar se a distor\u00e7\u00e3o dos elementos da malha ou a varia\u00e7\u00e3o\n\nespacial do tensor K t\u00eam alguma influ\u00eancia sobre a converg\u00eancia.\nOs testes realizados seguem as diretrizes de um exerc\u00edcio comparativo\n\nproposto no 5th International Symposium on Finite Volumes for Complex\n\nApplications [31]. A forma adimensional da norma L 2 do erro para a vari\u00e1-\nvel da equa\u00e7\u00e3o foi computada pela express\u00e3o\n\n?P =\n\n?\n\n?\n\n?\n\n?\n\np?M\n\n?\n\nP(x p , yp , z p)?P?p\n?2\n?Vp\n\n?\n\np?M\n\n?\n\nP(x p , yp , z p)\n?2\n?Vp\n\n?\n\n?\n\n?\n\n1/2\n\n, (6.3)\n\nem que P(x p , yp , z p) \u00e9 o valor correspondente \u00e0 solu\u00e7\u00e3o exata no ponto\ncoincidente com o n\u00f3 p , enquanto que P?p \u00e9 o valor obtido na solu\u00e7\u00e3o\n\nnum\u00e9rica para o mesmo n\u00f3.\n\nPor analogia com a express\u00e3o da norma do erro da vari\u00e1vel da equa-\n\n\u00e7\u00e3o, foi definida a seguinte norma para o erro na aproxima\u00e7\u00e3o do seu gra-\n\ndiente\n\n??P =\n\n?\n\n?\n\n?\n\n?\n\n?\n\nf ?M\n\n?\n\n?\n\n??P(x?f , y?f , z?f )??P??f\n?\n\n?\n\n?\n\n2\n?Sf\n\n?\n\nf ?M\n\n?\n\n?\n\n??P(x?f , y?f , z?f )\n?\n\n?\n\n?\n\n2\n?Sf\n\n?\n\n?\n\n?\n\n?\n\n1/2\n\n. (6.4)\n\nUma vez que nas equa\u00e7\u00f5es discretizadas o gradiente \u00e9 aproximado no\n\nbaricentro das faces, a norma do gradiente foi definida com base nessas\n\naproxima\u00e7\u00f5es, denotadas na express\u00e3o (6.4) como ?P??f . Nessa express\u00e3o,\n?P(x?f , y?f , z?f ) \u00e9 o valor exato do gradiente no baricentro da face, obtido por\ndiferencia\u00e7\u00e3o da solu\u00e7\u00e3o anal\u00edtica. Al\u00e9m disso, ?Sf \u00e9 a \u00e1rea da face em\nquest\u00e3o.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 108\n\nEntretanto, na aproxima\u00e7\u00e3o do fluxo difusivo em uma face, apenas\n\nparticipa a componente normal \u00e0 face do produto K?P . Devido a isso,\ndecidiu-se comparar o valor da aproxima\u00e7\u00e3o num\u00e9rica dessa componente\n\ncom o valor determinado a partir da solu\u00e7\u00e3o anal\u00edtica no baricentro das\n\nfaces. Para tanto, definiu-se a norma para o erro nos fluxos\n\n?q =\n\n?\n\n?\n\n?\n\n?\n\n?\n\nf ?M\n\nh\n\nK?P(x?f , y?f , z?f ) \u00b7?Sf ?K\ne?P??f \u00b7?Sf\n\ni2\n\n?\n\nf ?M\n\nh\n\nK?P(x?f , y?f , z?f ) \u00b7?Sf\ni2\n\n?\n\n?\n\n?\n\n?\n\n1/2\n\n, (6.5)\n\nem que K?P(x?f , y?f , z?f ) \u00e9 computado com o valor exato do gradiente no\nbaricentro de uma face e o valor do tensor K avaliado no mesmo ponto,\nquando for vari\u00e1vel espacialmente. No entanto, na aproxima\u00e7\u00e3o num\u00e9rica,\n\nKe \u00e9 o valor associado ao elemento em que a face se encontra, avaliado no\nbaricentro do elemento, quando K for uma fun\u00e7\u00e3o da posi\u00e7\u00e3o.1\n\n6.1.1 Problema 1-A\n\nNo problema 1-A, a permeabilidade \u00e9 dada por um tensor identidade, por-\n\ntanto, trata-se de um problema de difus\u00e3o em um meio isotr\u00f3pico. O termo\n\nfonte da equa\u00e7\u00e3o est\u00e1 definido na figura 6.1. Conforme indicado na mesma\n\nfigura, um valor nulo \u00e9 prescrito para a vari\u00e1vel no contorno do dom\u00ednio.\n\nx 1 1\n\n1\n\nz\n\ny\n\nDom\u00ednio Permeabilidade\nTermo fonte\nValor prescrito no contorno\n\nFigura 6.1 \u2013 Problema 1-A.\n\n1 Uma vez que em problemas de simula\u00e7\u00e3o de reservat\u00f3rios a varia\u00e7\u00e3o espacial da per-\nmeabilidade \u00e9 aproximada associando um valor constante a blocos da malha, na formula\u00e7\u00e3o\nimplementada esses valores s\u00e3o atribu\u00eddos aos elementos da malha prim\u00e1ria.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 109\n\nPara as condi\u00e7\u00f5es especificadas, a solu\u00e7\u00e3o exata da equa\u00e7\u00e3o (6.1) \u00e9\n\nP = sin(2?x)sin(2?y )sin(2?z). (6.6)\n\nNa solu\u00e7\u00e3o num\u00e9rica do problema foram consideradas sequ\u00eancias de\n\nmalhas com n\u00edvel de refinamento progressivamente maior, mantendo exa-\n\ntamente a mesma estrutura sempre que poss\u00edvel. O intuito foi verificar a\n\nredu\u00e7\u00e3o do valor das normas dos erros definidas anteriormente e estimar\n\npara cada caso a taxa de converg\u00eancia. Al\u00e9m disso, analisar a influ\u00eancia da\n\ndistor\u00e7\u00e3o dos elementos da malha sobre a converg\u00eancia.\n\nInicialmente s\u00e3o apresentados os resultados com malhas formadas\n\nsomente por elementos hexa\u00e9dricos. A primeira sequ\u00eancia de malhas est\u00e1\n\nformada por malhas regulares igualmente espa\u00e7adas. Mediante desloca-\n\nmento dos v\u00e9rtices internos dessas malhas obtiveram-se sequ\u00eancias de\n\nmalhas com elementos distorcidos. Para tanto, aplicaram-se as rela\u00e7\u00f5es\n\nmatem\u00e1ticas\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nx ?p = x p +?p ,\n\ny ?p = yp +?p ,\n\nz ?p = z p +?p ,\n\n?p = A sin(2?x p)sin(2?yp)sin(2?z p) .\n\n(6.7)\n\nNestas express\u00f5es, x p , yp e z p s\u00e3o as coordenadas dos v\u00e9rtices na\n\nmalha-base regular, enquanto que x ?p , y\n?\np e z\n\n?\np s\u00e3o as coordenadas dos\n\nv\u00e9rtices na malha com elementos distorcidos. Estipulando diferentes va-\n\nlores para a amplitude A controla-se o grau de distor\u00e7\u00e3o das sequ\u00eancias\n\nde malhas.2 Nos experimentos num\u00e9ricos realizados foram consideradas\n\nsequ\u00eancias de malhas distorcidas obtidas com amplitudes 0.04, 0.08 e 0.12.3\n\nPara ilustrar, a figura 6.2 mostra as malhas resultantes ap\u00f3s a distor\u00e7\u00e3o,\n\nconsiderando uma malha-base de 20\u00d720\u00d720 hexaedros regulares.\nNas figuras 6.3, 6.4 e 6.5 s\u00e3o apresentados gr\u00e1ficos da varia\u00e7\u00e3o das nor-\n\nmas dos erros definidos nas equa\u00e7\u00f5es (6.3), (6.4) e (6.5), respectivamente,\n\nem rela\u00e7\u00e3o ao comprimento representativo dos elementos da malha. Neste\n\n2 Este tipo de distor\u00e7\u00e3o senoidal das malhas de hexaedros \u00e9 uma extens\u00e3o tridimensional\nda distor\u00e7\u00e3o considerada em [6] para malhas quadril\u00e1teros.\n\n3 \u00c9 f\u00e1cil comprovar que uma amplitude maior a 0.012 desloca alguns v\u00e9rtices para fora do\ndom\u00ednio do problema e produz tamb\u00e9m elementos an\u00f4malos.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 110\n\n(a)  A = 0 (base)\n\n(c)  A = 0.08\n\n(b)  A = 0.04\n\n(d)  A = 0.12\nFigura 6.2 \u2013 Malhas de 20 \u00d7 20 \u00d7 20 hexaedros, apresentando diferente\n\namplitude de distor\u00e7\u00e3o dos elementos.\n\ne todos os casos apresentados mais adiante, esse comprimento caracter\u00eds-\n\ntico \u00e9 determinado pela express\u00e3o [32]\n\nh =\n?\n\nV ?/N Me\n?\n\n1\n3 , (6.8)\n\nem que V ? \u00e9 o volume do dom\u00ednio e N Me \u00e9 o n\u00famero total de elementos\n\nvolum\u00e9tricos da malha M que discretiza tal dom\u00ednio.\nNos gr\u00e1ficos apresentados, cada ponto representa o valor da norma\n\nde um dos erros, determinada na solu\u00e7\u00e3o num\u00e9rica em uma dada malha.\n\nNas malhas de hexaedros consideraram-se sequ\u00eancias de malhas em que\n\na malha mais grosseira possui 10 \u00d7 10 \u00d7 10 elementos e a mais refinada\n143\u00d7143\u00d7143 elementos. Para cada sequ\u00eancia de malhas, apresentam-se\ntamb\u00e9m ajustes dos pontos a express\u00f5es da forma ? = a h b , cujas repre-\nsenta\u00e7\u00f5es na escala logar\u00edtmica s\u00e3o as linhas retas presentes nos gr\u00e1ficos.\n\nO expoente do ajuste indica a taxa de converg\u00eancia observada, na norma\n\nL 2 considerada, da vari\u00e1vel da equa\u00e7\u00e3o, do gradiente ou dos fluxos.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 111\n\n0.01 0.1\n\n10\n-3\n\n10\n-2\n\n10\n-1\n\n \n\n \n\n \n\n \n \n\n \n\n \n \n\nA = 0\n\nA = 0.04\n\nA = 0.08\n\nA = 0.12\n\n2.010~ 9.88 h\n\n2.009~ 10.32 h\n\n2.009~ 11.43 h\n\n2.011~ 12.66 h\n\nFigura 6.3 \u2013 Converg\u00eancia da press\u00e3o no problema 1-A, para malhas de\nhexaedros com diferente amplitude de distor\u00e7\u00e3o.\n\n0.01 0.1\n\n10\n-2\n\n10\n-1\n\n \n\n \n\n \n \n\n \n\n \n \n\nA = 0\n\nA = 0.04\n\nA = 0.08\n\nA = 0.12\n\n0.999~ 1.27 h\n\n0.998~ 1.39 h\n\n0.997~ 1.71 h\n\n0.998~ 2.24 h\n\nFigura 6.4 \u2013 Converg\u00eancia do gradiente da press\u00e3o no problema 1-A, para\nmalhas de hexaedros com diferente amplitude de distor\u00e7\u00e3o.\n\n0.01 0.1\n10\n\n-5\n\n10\n-4\n\n10\n-3\n\n10\n-2\n\n10\n-1\n\n \n\n \n\n \n\n \n\n \n \n\n \n\n \n \n\nA = 0\n\nA = 0.01\n\nA = 0.04\n\nA = 0.08\n\nA = 0.12\n\n2.124~ 0.71 h\n\n1.093~ 0.11 h\n\n1.036~ 0.37 h\n\n1.018~ 0.80 h\n\n1.005~ 1.43 h\n\nFigura 6.5 \u2013 Converg\u00eancia dos fluxos no problema 1-A, para malhas de\nhexaedros com diferente amplitude de distor\u00e7\u00e3o.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 112\n\nConforme se pode observar nas figuras 6.3 e 6.4, a acur\u00e1cia \u00e9 de se-\n\ngunda ordem para P e de primeira ordem para ?P , independentemente\nda distor\u00e7\u00e3o considerada para as malhas. No caso de P , a influ\u00eancia da\n\ndistor\u00e7\u00e3o \u00e9 m\u00ednima e os ajustes obtidos para as sequ\u00eancias de malhas est\u00e3o\n\nquase superpostos. No caso da norma do erro nos fluxos, cuja conver-\n\ng\u00eancia \u00e9 mostrada na figura 6.5 \u00e9 observado um fen\u00f4meno particular. A\n\nconverg\u00eancia dessa norma para as malhas regulares acontece a uma taxa\n\nlevemente maior a segunda ordem, enquanto que para todas as malhas\n\ndistorcidas observa-se uma taxa de primeira ordem. J\u00e1 que no problema\n\n1-A a permeabilidade \u00e9 isotr\u00f3pica, isso significaria que para malhas de\n\nhexaedros regulares a aproxima\u00e7\u00e3o da componente normal \u00e0s faces con-\n\nverge a uma taxa maior que a aproxima\u00e7\u00e3o do pr\u00f3prio gradiente. Na li-\n\nteratura, quando o erro de uma aproxima\u00e7\u00e3o num\u00e9rica em um ponto se\n\nreduz a uma taxa maior do que no entorno, diz-se que a aproxima\u00e7\u00e3o \u00e9\n\nsuperconvergente nesse ponto [84]. Pelos resultados obtidos, os baricen-\ntros das faces apresentam superconverg\u00eancia em malhas regulares, para\n\na aproxima\u00e7\u00e3o da componente do gradiente normal \u00e0 face. Infelizmente,\n\napenas uma leve distor\u00e7\u00e3o nos elementos j\u00e1 causa uma redu\u00e7\u00e3o significa-\n\ntiva na taxa de converg\u00eancia. Como mostra a figura 6.5, uma amplitude de\n\ndistor\u00e7\u00e3o de 0.01, que na pr\u00e1tica apenas pode distinguir-se visualmente,\n\nreduz a taxa de converg\u00eancia a um valor pr\u00f3ximo \u00e1 unidade.\n\nOs resultados apresentados at\u00e9 agora mostram que a distor\u00e7\u00e3o dos\n\nelementos hexa\u00e9dricos n\u00e3o influ\u00eancia de modo significativo a taxa de con-\n\nverg\u00eancia, pelo menos para os erros associados \u00e0 vari\u00e1vel da equa\u00e7\u00e3o e ao\n\ngradiente. Contudo, \u00e9 importante quantificar de alguma forma a distor\u00e7\u00e3o\n\nnas malhas consideradas at\u00e9 agora. Uma medida usualmente utilizada\n\npara quantificar a deforma\u00e7\u00e3o de elementos hexa\u00e9dricos \u00e9 a raz\u00e3o entre\n\no m\u00ednimo e o m\u00e1ximo valor do jacobiano da transforma\u00e7\u00e3o de coordena-\n\ndas, definida previamente na equa\u00e7\u00e3o (3.1) [2, 43]. Aqui foi considerado o\nseguinte \u00edndice de deforma\u00e7\u00e3o para os elementos hexa\u00e9dricos\n\nI edef = 1?\nminp?N e |J|p\nmaxp?N e |J|p\n\n, (6.9)\n\no qual ser\u00e1 nulo quando o hexaedro for regular e tender\u00e1 a 1 \u00e1 medida que\n\naumentar a deforma\u00e7\u00e3o do elemento.4\n\n4 Se minp?N e |J|p for negativo atribui-se diretamente um valor unit\u00e1rio a I edef\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 113\n\nOs histogramas da figura 6.6 ilustram a distribui\u00e7\u00e3o de valores do \u00edn-\n\ndice de distor\u00e7\u00e3o definido na equa\u00e7\u00e3o (6.9), para as malhas mostradas na\n\nfigura 6.2. Conforme se pode observar, nas malhas com amplitudes de\n\ndistor\u00e7\u00e3o A = 0.08 e A = 0.12 existe uma grande porcentagem de elementos\ncom valor significativamente alto do \u00edndice de deforma\u00e7\u00e3o.\n\n0\n25\n50\n75\n\n100 A = 0A = 0.04A = 0.08A = 0.12\n\n\u00cdndice de deforma\u00e7\u00e3o\n\nPorcen\ntagem\n\n de ele\nmento\n\ns\n\n0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0\nFigura 6.6 \u2013 \u00cdndice de deforma\u00e7\u00e3o dos elementos para diferentes amplitu-\n\ndes de distor\u00e7\u00e3o, nas malhas de 20\u00d720\u00d720 hexaedros.\n\nDevido ao deslocamento dos v\u00e9rtices, as facetas das malhas distor-\n\ncidas devem ter adquirido curvatura e deixado de ser planas. Como es-\n\nperado, esse fen\u00f4meno n\u00e3o teve incid\u00eancia sobre a taxa de converg\u00eancia,\n\npor\u00e9m, \u00e9 importante tamb\u00e9m quantificar o grau de arqueamento que so-\n\nfreram as facetas no processo de distor\u00e7\u00e3o das malhas. Baseado na proje-\n\n\u00e7\u00e3o de uma faceta quadrangular sobre um plano m\u00e9dio, na refer\u00eancia [2] \u00e9\ndefinido o seguinte \u00edndice de arqueamento\n\nI arq =\n2?\n\np\n\nA proj\n. (6.10)\n\nO procedimento de c\u00f4mputo do \u00edndice e o significado dos par\u00e2metros\n\nenvolvidos est\u00e3o ilustrados na figura 6.7. Inicialmente \u00e9 determinado um\n\nvetor normal m\u00e9dio para a faceta, mediante o produto vetorial de suas\n\ndiagonais. Com ajuda desse vetor determina-se um plano m\u00e9dio passando\n\npelo baricentro dos v\u00e9rtices da faceta. O comprimento ? na equa\u00e7\u00e3o (6.10)\n\n\u00e9 a dist\u00e2ncia de um dos v\u00e9rtices ao referido plano m\u00e9dio. Por constru\u00e7\u00e3o,\n\nessa dist\u00e2ncia \u00e9 a mesma para os quatro v\u00e9rtices. Finalmente, A proj \u00e9 a \u00e1rea\n\ndo quadril\u00e1tero projetada no plano m\u00e9dio. O \u00edndice de arqueamento para\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 114\n\num elemento hexa\u00e9drico ser\u00e1 o m\u00e1ximo valor dos \u00edndices determinados\n\npela equa\u00e7\u00e3o (6.10), entre todas as facetas do elemento [2].\n\nA\n\nB\n\nC\nD\n\nProje\u00e7\u00e3o noplano m\u00e9dio(\u00e1rea         ) (a) (b)\nFigura 6.7 \u2013 Proje\u00e7\u00e3o de uma faceta arqueada sobre o plano m\u00e9dio.\n\nOs histogramas da figura 6.8 apresentam a distribui\u00e7\u00e3o de valores do\n\n\u00edndice de arqueamento definido previamente, para as malhas mostradas\n\nna figura 6.2. Na malha com amplitude de distor\u00e7\u00e3o A = 0.12, os valores\nm\u00e1ximos do \u00edndice de arqueamento atingem 0.2. Apesar desse valor n\u00e3o\n\nser especialmente alto, pode-se observar que a porcentagem de elementos\n\ncom facetas n\u00e2o-planas nessa malha \u00e9 pr\u00f3ximo a 75%.\n\n0\n25\n50\n75\n\n100 A = 0A = 0.04A = 0.08A = 0.12\n\n\u00cdndice de arqueamentoP\norcent\n\nagem d\ne elem\n\nentos\n\n0.00 0.04 0.08 0.12 0.16 0.20\nFigura 6.8 \u2013 \u00cdndice de arqueamento dos elementos para diferentes ampli-\n\ntudes de distor\u00e7\u00e3o, nas malhas de 20\u00d720\u00d720 hexaedros.\n\nA fim de determinar o comportamento dos erros com elementos de\n\noutras formas, o problema 1-A foi resolvido com sequ\u00eancias de malhas for-\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 115\n\nmadas por tetraedros, prismas e pir\u00e2mides. Para manter controle sobre a\n\nestrutura dessas malhas ao serem refinadas, elas foram obtidas por divis\u00e3o\n\ndas malhas de hexaedros descritas anteriormente. Cada elemento dessas\n\nmalhas foi dividido em tetraedros, prismas ou pir\u00e2mides, da forma ilus-\n\ntrada na figura 6.9. As malhas de tetraedros e prismas possuem o mesmo\n\nn\u00famero de v\u00e9rtices que as correspondentes de hexaedros, por\u00e9m, maior\n\nquantidade de elementos. J\u00e1 as malhas de pir\u00e2mides, al\u00e9m de possuir\n\nmais elementos que as de hexaedros, possuem tamb\u00e9m mais v\u00e9rtices, pela\n\nadi\u00e7\u00e3o de um v\u00e9rtice central em cada hexaedro, como mostra a figura 6.9.\n\nHexaedro\n\n6 tetraedros\n\n6 pir\u00e2mides\n\n2 prismas\n\nFigura 6.9 \u2013 Divis\u00e3o de um hexaedro em tetraedros, prismas ou pir\u00e2mides.\n\nNas figuras 6.10, 6.11 e 6.12 s\u00e3o apresentados gr\u00e1ficos que mostram\n\na redu\u00e7\u00e3o das normas dos erros ?P , ??P e ?q , respectivamente, com ma-\n\nlhas de tetraedros obtidas da forma descrita acima. Como nas malhas de\n\nhexaedros, nesses gr\u00e1ficos compara-se a converg\u00eancia para sequ\u00eancias de\n\nmalhas apresentando diferente amplitude de distor\u00e7\u00e3o. Para distorcer as\n\nmalhas empregou-se o mesmo procedimento sintetizado na equa\u00e7\u00e3o (6.7).\n\nA taxa de converg\u00eancia da press\u00e3o \u00e9 praticamente de segunda ordem\n\npara as malhas sem distor\u00e7\u00e3o. O incremento do erro e a diminui\u00e7\u00e3o da taxa\n\nde converg\u00eancia ao distorcer as malhas s\u00e3o mais acentuados que no caso\n\ndos hexaedros, por\u00e9m, mesmo assim s\u00e3o pouco significativos. A influ\u00eancia\n\nda distor\u00e7\u00e3o no erro do gradiente \u00e9 ainda menor, podendo-se afirmar que\n\na converg\u00eancia \u00e9 de primeira ordem em todos os casos. A converg\u00eancia do\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 116\n\n \n\n \n\n \n \n\n \n\n \n \n\nA = 0\n\nA = 0.04\n\nA = 0.08\n\nA = 0.12\n\n1.998~ 12.05 h\n\n1.975~ 13.05 h\n\n1.94~ 17.33 h\n\n1.93~ 28.47 h\n\nTETRA+\n\n0.01 0.1\n10\n\n-4\n\n10\n-3\n\n10\n-2\n\n \n\nFigura 6.10 \u2013 Converg\u00eancia da press\u00e3o no problema 1-A, para malhas de\ntetraedros com diferente amplitude de distor\u00e7\u00e3o.\n\n \n\n \n\n \n \n\n \n\n \n \n\nA = 0\n\nA = 0.04\n\nA = 0.08\n\nA = 0.12\n\n0.99~ 6.23 h\n\n0.987~ 6.34 h\n\n0.987~ 6.91 h\n\n0.996~ 8.65 h\n\nP1 TETRA+++\n\n0.01 0.1\n10\n\n-2\n\n10\n-1\n\nFigura 6.11 \u2013 Converg\u00eancia do gradiente da press\u00e3o no problema 1-A, para\nmalhas de tetraedros com diferente amplitude de distor\u00e7\u00e3o.\n\n \n\n \n\n \n \n\n \n\n \n \n\nA = 0\n\nA = 0.04\n\nA = 0.08\n\nA = 0.12\n\n0.987~ 5.96 h\n\n0.982~ 5.97 h\n\n0.978~ 6.43 h\n\n0.988~ 8.35 h\n\nP1 TETRA+++\n\n0.01 0.1\n10\n\n-2\n\n10\n-1\n\nFigura 6.12 \u2013 Converg\u00eancia dos fluxos no problema 1-A, para malhas de\ntetraedros com diferente amplitude de distor\u00e7\u00e3o.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 117\n\nerro dos fluxos \u00e9 praticamente id\u00eantica \u00e0 do erro do gradiente, diferente-\n\nmente do fen\u00f4meno observado nas malhas de hexaedros.\n\nAs figuras 6.13 e 6.14 apresentam os resultados obtidos para a conver-\n\ng\u00eancia da press\u00e3o e do gradiente, respectivamente, nas malhas de prismas.\n\nResultados equivalentes obtidos nas malhas de pir\u00e2mides s\u00e3o mostrados\n\nnas figuras 6.15 e 6.16. A converg\u00eancia dessas grandezas em ambos os\n\ncasos \u00e9 qualitativamente semelhante \u00e1quela observada nas malhas de te-\n\ntraedros, sendo que a taxa de converg\u00eancia para a press\u00e3o \u00e9 pr\u00f3xima a 2,\n\nenquanto que para o gradiente \u00e9 pr\u00f3xima de 1. Como nos outros tipos de\n\nelementos j\u00e1 examinados, n\u00e3o \u00e9 observada uma influ\u00eancia significativa da\n\ndistor\u00e7\u00e3o das malhas nos valores dessas taxas de converg\u00eancia.\n\n \n\n \n\n \n \n\n \n\n \n \n\nA = 0\n\nA = 0.04\n\nA = 0.08\n\nA = 0.12\n\n1.998~ 8.37 h\n\n1.999~ 9.49 h\n\n1.985~ 12.08 h\n\n1.942~ 15.07 h\n\nP1 PRISM+++\n\n0.01 0.1\n10\n\n-4\n\n10\n-3\n\n10\n-2\n\n10\n-1\n\n \n\nFigura 6.13 \u2013 Converg\u00eancia da press\u00e3o no problema 1-A, para malhas de\nprismas com diferente amplitude de distor\u00e7\u00e3o.\n\n \n\n \n\n \n \n\n \n\n \n \n\nA = 0\n\nA = 0.04\n\nA = 0.08\n\nA = 0.12\n\n0.999~ 2.91 h\n\n0.993~ 3.01 h\n\n0.985~ 3.39 h\n\n0.978~ 4.04 h\n\nP1 PRISM+++\n\n0.01 0.1\n10\n\n-2\n\n10\n-1\n\nFigura 6.14 \u2013 Converg\u00eancia do gradiente da press\u00e3o no problema 1-A, para\nmalhas de prismas com diferente amplitude de distor\u00e7\u00e3o.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 118\n\n \n\n \n\n \n \n\n \n\n \n \n\nA = 0\n\nA = 0.04\n\nA = 0.08\n\nA = 0.12\n\n2.009~ 17.61 h\n\n2.007~ 18.78 h\n\n2.001~ 22.10 h\n\n1.99~ 27.31 h\n\nP1 PYRA+++\n\n \n\n0.01 0.1\n10\n\n-4\n\n10\n-3\n\n10\n-2\n\n10\n-1\n\n \n\nFigura 6.15 \u2013 Converg\u00eancia da press\u00e3o no problema 1-A, para malhas de\npir\u00e2mides com diferente amplitude de distor\u00e7\u00e3o.\n\n \n\n \n\n \n \n\n \n\n \n \n\nA = 0\n\nA = 0.04\n\nA = 0.08\n\nA = 0.12\n\n1.001~ 2.59 h\n\n1.0~ 2.78 h\n\n0.998~ 3.31 h\n\n0.999~ 4.18 h\n\nP1 PYR+++\n\n0.01 0.1\n10\n\n-2\n\n10\n-1\n\nFigura 6.16 \u2013 Converg\u00eancia do gradiente da press\u00e3o no problema 1-A, para\nmalhas de pir\u00e2mides com diferente amplitude de distor\u00e7\u00e3o.\n\nPara finalizar esta se\u00e7\u00e3o s\u00e3o apresentados resultados obtidos em uma\n\nsequ\u00eancia de malhas h\u00edbridas. A estrutura das malhas h\u00edbridas utilizadas\n\nno teste pode ser evidenciada na figura 6.17, a qual mostra as tr\u00eas malhas\n\nmais grosseiras da sequ\u00eancia. Todas as malhas t\u00eam uma por\u00e7\u00e3o central\n\nc\u00fabica formada por elementos hexa\u00e9dricos regulares, cuja dimens\u00e3o \u00e9 40%\n\nda dimens\u00e3o do dom\u00ednio. A por\u00e7\u00e3o externa \u00e9 formada por elementos te-\n\ntra\u00e9dricos, existindo entre ela e a por\u00e7\u00e3o central uma regi\u00e3o de transi\u00e7\u00e3o\n\nformada por pir\u00e2mides.\n\nOs resultados correspondentes \u00e0 converg\u00eancia das tr\u00eas normas ana-\n\nlisadas s\u00e3o apresentados nas figuras 6.18, 6.19 e 6.20, respectivamente.\n\nPara fins de compara\u00e7\u00e3o, os gr\u00e1ficos incluem resultados j\u00e1 apresentados,\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 119\n\n(a) Hexaedros: 27\nPir\u00e2mides: 54\n\nTetraedros: 2754\n\n(b) Hexaedros: 64\nPir\u00e2mides: 96\n\nTetraedros: 6395\n\n(c) Hexaedros: 343\nPir\u00e2mides: 294\n\nTetraedros: 38811\n\nFigura 6.17 \u2013 Tr\u00eas malhas h\u00edbridas utilizadas nos testes de converg\u00eancia.\n\ncorrespondentes \u00e0s malhas regulares de hexaedros e tetraedros. No caso\n\nda converg\u00eancia dos erros da press\u00e3o, os valores obtidos para a norma\n\ndesses erros nas malhas h\u00edbridas s\u00e3o levemente maiores que os obtidos\n\nnas malhas de hexaedros e tetraedros. A taxa de converg\u00eancia tamb\u00e9m\n\n\u00e9 levemente menor, contudo, os tr\u00eas valores s\u00e3o bastante pr\u00f3ximos entre\n\nsi. No caso da converg\u00eancia do gradiente e dos fluxos, os valores obtidos\n\npara as normas dos erros nas malhas h\u00edbridas s\u00e3o intermedi\u00e1rios entre os\n\ndas malhas hexa\u00e9dricas, que sempre s\u00e3o menores, e os das malhas tetra\u00e9-\n\ndricas. No caso da norma dos erros para os fluxos, os valores nas malhas\n\nde hexaedros s\u00e3o significativamente menores e a taxa de converg\u00eancia \u00e9\n\nmaior, pelo fen\u00f4meno de superconverg\u00eancia comentado previamente. Os\n\nvalores dessa norma e a taxa de converg\u00eancia nas malhas h\u00edbridas conside-\n\nradas s\u00e3o mais pr\u00f3ximos dos valores obtidos com as malhas tetra\u00e9dricas.\n\n6.1.2 Problema 1-B\n\nNo problema de difus\u00e3o 1-B, descrito tamb\u00e9m pelas equa\u00e7\u00f5es (6.1) e (6.2),\n\n\u00e9 considerado um tensor permeabilidade cujas componentes s\u00e3o fun\u00e7\u00f5es\n\ndas coordenadas espaciais. O objetivo deste problema \u00e9 determinar como\n\nesse tipo de anisotropia influencia a converg\u00eancia da solu\u00e7\u00e3o num\u00e9rica\n\nobtida com a formula\u00e7\u00e3o proposta.\n\nO tensor permeabilidade e a solu\u00e7\u00e3o exata para o problema 1-B est\u00e3o\n\nespecificados na figura 6.21. Neste caso empregou-se a t\u00e9cnica das solu-\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 120\n\n \n\n \n\n \n\n \n\n \n\n \n\nHexaedros\n\nTetraedros\n\nH\u00edbrida\n\n2.010~ 9.88 h\n\n1.998~ 12.05 h\n\n1.932~ 11.51 h\n\n0.01 0.1\n10\n\n-4\n\n10\n-3\n\n10\n-2\n\n10\n-1\n\n \n\nFigura 6.18 \u2013 Compara\u00e7\u00e3o da converg\u00eancia da press\u00e3o no problema 1-A,\nem malhas hexa\u00e9dricas, tetra\u00e9dricas e h\u00edbridas.\n\n0.01 0.1\n\n10\n-2\n\n10\n-1\n\n \n\n \n\n \n\n \n\n \n\nHexaedros\n\nTetraedros\n\nH\u00edbrida\n\n0.999~ 1.27 h\n\n0.99~ 6.23 h\n\n1.064~ 4.87 h\n\nFigura 6.19 \u2013 Compara\u00e7\u00e3o da converg\u00eancia do gradiente da press\u00e3o no\nproblema 1-A em malhas hexa\u00e9dricas, tetra\u00e9dricas e h\u00edbridas.\n\n \n\n \n\n \n\n2.124~ 0.71 h\n\n0.987~ 5.96 h\n\n1.201~ 6.12 h\n\n0.01 0.1\n\n10\n-5\n\n10\n-4\n\n10\n-3\n\n10\n-2\n\n10\n-1\n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\nHexaedros\n\nTetraedros\n\nH\u00edbrida\n\nFigura 6.20 \u2013 Compara\u00e7\u00e3o da converg\u00eancia dos fluxos no problema 1-A,\nem malhas hexa\u00e9dricas, tetra\u00e9dricas e h\u00edbridas.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 121\n\n\u00e7\u00f5es manufaturadas [72]. Isto \u00e9, substituindo a solu\u00e7\u00e3o exata na equa\u00e7\u00e3o\ndiferencial, obteve-se o termo fonte ?(x , y , z) correspondente. O referido\ntermo fonte foi obtido com aux\u00edlio de um software de matem\u00e1tica simb\u00f3-\n\nlica e incorporado diretamente ao c\u00f3digo em C ++ implementado para ob-\n\nter a solu\u00e7\u00e3o num\u00e9rica. Al\u00e9m disso, os valores prescritos como condi\u00e7\u00e3o de\n\nDirichlet no contorno do dom\u00ednio, para a obten\u00e7\u00e3o da solu\u00e7\u00e3o num\u00e9rica,\n\nforam determinados a partir da pr\u00f3pria solu\u00e7\u00e3o exata.\n\nx 1 1\n\n1\n\nz\n\ny\n\nDom\u00ednio Permeabilidade\n\nSolu\u00e7\u00e3o anal\u00edtica\n\nFigura 6.21 \u2013 Problema 1-B.\n\nDa mesma forma que no problema 1-A, foram consideradas sequ\u00ean-\n\ncias de malhas progressivamente refinadas para analisar a converg\u00eancia\n\ndas tr\u00eas normas, ?P , ??P e ?q . No entanto, neste caso unicamente foram\n\nempregadas malhas regulares, sem nenhuma distor\u00e7\u00e3o, a fim de isolar o\n\nefeito da anisotropia do tensor K. Os resultados obtidos s\u00e3o apresentados\nnas figuras 6.22, 6.23 e 6.24. Nos gr\u00e1ficos s\u00e3o comparadas as normas dos\n\nerros nas malhas regulares de hexaedros, tetraedros, prismas e pir\u00e2mides,\n\ne tamb\u00e9m nas malhas h\u00edbridas empregadas no problema anterior.\n\nNo caso da norma do erro associado \u00e0 press\u00e3o, nas malhas regulares\n\nnovamente observa-se converg\u00eancia de segunda ordem. J\u00e1 nas malhas\n\nh\u00edbridas, a taxa de converg\u00eancia \u00e9 menor, embora os valores da norma do\n\nerro n\u00e3o sejam muito diferentes do que nas outras malhas. No caso das\n\nnormas dos erros relativos ao gradiente e aos fluxos, as taxas de converg\u00ean-\n\ncia encontram-se em quase todos os casos pr\u00f3ximas de primeira ordem. A\n\nexce\u00e7\u00e3o \u00e9 o caso da norma dos fluxos nas malhas h\u00edbridas, que apresenta\n\numa taxa de converg\u00eancia ligeiramente maior.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 122\n\n \n\n \n\n \n\n \n \n\n \n\n \n\n \n\n \n\n \n\nHexaedros\n\nTetraedros\n\nPrismas\n\nPir\u00e2mides\n\nH\u00edbrida\n\n2.008~ 5.41 h\n\n1.978~ 11.85 h\n\n1.993~ 9.25 h\n\n1.999~ 9.37 h\n\n1.781~ 4.84 h0.01 0.1\n\n10\n-3\n\n10\n-2\n\n10-1\n\n \n\nFigura 6.22 \u2013 Converg\u00eancia da press\u00e3o no problema 1-B em malhas de\ndiferente topologia.\n\n0.01 0.1\n10\n\n-2\n\n10\n-1\n\n \n\n \n\n \n \n\n \n\n \n\n \n\n \n\n \n\nHexaedros\n\nTetraedros\n\nPrismas\n\nPir\u00e2mides\n\nH\u00edbrida\n\n1.021~ 2.09 h\n\n0.993~ 6.34 h\n\n1.007~ 3.63 h\n\n1.006~ 4.06 h\n\n1.047~ 6.34 h\n\nFigura 6.23 \u2013 Converg\u00eancia do gradiente da press\u00e3o no problema 1-B em\nmalhas de diferente topologia.\n\n0.01 0.1\n\n10\n-2\n\n10\n-1\n\n \n\n \n\n \n \n\n \n\n \n\n \n\n \n\n \n\nHexaedros\n\nTetraedros\n\nPrismas\n\nPir\u00e2mides\n\nH\u00edbrida\n\n1.077~ 1.19 h\n\n0.985~ 7.74 h\n\n0.98~ 3.84 h\n\n1.005~ 2.96 h\n\n1.119~ 8.27 h\n\nFigura 6.24 \u2013 Converg\u00eancia dos fluxos no problema 1-B em malhas de\ndiferente topologia.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 123\n\n6.1.3 Problema 1-C\n\nNo problema 1-C considera-se um tensor permeabilidade descont\u00ednuo.\n\nConforme mostra a figura 6.25, a descontinuidade se encontra localizada\n\nno plano x = 1\n2\n\n, que divide o dom\u00ednio em duas regi\u00f5es.5 Para x \u00b6 1\n2\n\na per-\n\nmeabilidade \u00e9 dada pelo tensor identidade, enquanto que na outra regi\u00e3o\n\n\u00e9 dada por um tensor com duas dire\u00e7\u00f5es principais rotacionadas 45? em\n\nrela\u00e7\u00e3o aos eixos x e y , e a terceira coincidente com o eixo z . Os autovalo-\n\nres desse tensor s\u00e3o {1,\", 1}, sendo \" um par\u00e2metro que permite controlar\no n\u00edvel de anisotropia na regi\u00e3o x > 1\n\n2\n. Nos resultados apresentados nesta\n\nse\u00e7\u00e3o considerou-se \"= 10?4.\n\nx 1 1\n\n1\n\nz\n\ny\n\nDom\u00ednio\n\nx = \nPermeabilidade\n\nSolu\u00e7\u00e3o anal\u00edtica\n\nFigura 6.25 \u2013 Problema 1-C.\n\nA solu\u00e7\u00e3o anal\u00edtica considerada para o problema, especificada na fi-\n\ngura 6.25, satisfaz a condi\u00e7\u00e3o de fluxo cont\u00ednuo atrav\u00e9s da superf\u00edcie de\n\ndescontinuidade, como requerido na equa\u00e7\u00e3o diferencial (6.1). A densi-\n\ndade de fluxo nessa superf\u00edcie \u00e9 dada por\n\n?K?P \u00b7 un\n?\n\n?\n\nx= 1\n2\n= ?1\n\n2\n\n?\n\n(1+\")sin y +(1?\")cos y\n?\n\n, (6.11)\n\n5 O problema 1-C \u00e9 uma generaliza\u00e7\u00e3o do problema 4.4 apresentado na refer\u00eancia [32].\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 124\n\nem que un =(1, 0, 0) \u00e9 o vetor unit\u00e1rio normal \u00e0 superf\u00edcie x =\n1\n2\n\n.\n\nMediante substitui\u00e7\u00e3o da solu\u00e7\u00e3o anal\u00edtica na equa\u00e7\u00e3o diferencial (6.1),\n\ndetermina-se o termo fonte correspondente, o qual \u00e9 dado por\n\n? =\n\n?\n\n?\n\n?\n\n1\n2\n\n?\n\nx ? 1\n2\n\n?\n\nh\n\n(1+\") sin y +(1?\") cos y\ni\n\n+ sin y se x \u00b6 1\n2\n\n?(1?\") e x?\n1\n2 cos y se x > 1\n\n2\n.\n\n(6.12)\n\nComo nos problemas anteriores, para o problema 1-C s\u00e3o apresen-\n\ntados a seguir resultados da converg\u00eancia das normas dos erros ?P , ??P\ne ?q . Esses resultados encontram-se nos gr\u00e1ficos das figuras 6.26, 6.27 e\n\n6.28, respectivamente. Para a obten\u00e7\u00e3o das solu\u00e7\u00f5es num\u00e9ricas, os valores\n\nprescritos no contorno como condi\u00e7\u00e3o de Dirichlet foram determinados a\n\npartir da solu\u00e7\u00e3o anal\u00edtica do problema.\n\nNo problema 1-C somente foram consideradas as sequ\u00eancias de ma-\n\nlhas regulares de hexaedros, tetraedros, prismas e pir\u00e2mides, utilizadas\n\npara os problemas anteriores. Neste caso, os valores observados para as ta-\n\nxas de converg\u00eancia coincidem quase exatamente com os valores te\u00f3ricos,\n\nindependentemente da topologia dos elementos da malha. Isto \u00e9, segunda\n\nordem para os erros na press\u00e3o, e primeira ordem para os erros no gra-\n\ndiente e nos fluxos. Apesar dessa regularidade nas taxas de converg\u00eancia,\n\nobserva-se diferen\u00e7as pronunciadas nos valores das normas dos erros para\n\ndiferentes tipos de elementos considerados.\n\n6.2 Problema 2: advec\u00e7\u00e3o n\u00e3o-linear\n\nNesta se\u00e7\u00e3o \u00e9 considerado o problema de advec\u00e7\u00e3o descrito pela equa\u00e7\u00e3o\n\n?s\n\n?t\n+ ? \u00b7 (Fw v) = 0 em ?, (6.13)\n\nem que Fw(s) \u00e9 uma fun\u00e7\u00e3o n\u00e3o-linear e v \u00e9 o vetor velocidade. No pro-\nblema considerado, o dom\u00ednio ? \u00e9 o cubo unit\u00e1rio 0\u00b6x \u00b61; 0\u00b6y \u00b61;\n0\u00b6z \u00b61.\n\nA equa\u00e7\u00e3o (6.13) \u00e9 uma forma simplificada da equa\u00e7\u00e3o da satura\u00e7\u00e3o,\n\nque forma parte do modelo de deslocamento bif\u00e1sico descrito no cap\u00edtulo\n\n5. No caso mais simples, em que o vetor v \u00e9 constante, \u00e9 poss\u00edvel obter uma\nsolu\u00e7\u00e3o anal\u00edtica exata para a equa\u00e7\u00e3o (6.13). Com auxilio dessa solu\u00e7\u00e3o \u00e9\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 125\n\n \n\n \n\n \n \n\n \n\n \n \n\nHexaedros\n\nTetraedros\n\nPrismas\n\nPir\u00e2mides\n\n1.987~ 0.0047 h\n\n1.996~ 0.0326 h\n\n2.004~ 0.0152 h\n\n2.001~ 0.0412 h\n\n0.01 0.1\n\n10\n-6\n\n10\n-5\n\n10\n-4\n\n \n\nFigura 6.26 \u2013 Converg\u00eancia da press\u00e3o no problema 1-C em malhas de\ndiferentes topologias.\n\n \n\n \n\n \n \n\n \n\n \n \n\nHexaedros\n\nTetraedros\n\nPrismas\n\nPir\u00e2mides\n\n1.0~ 0.098 h\n\n1.0~ 0.538 h\n\n1.0~ 0.363 h\n\n1.0~ 0.277 h\n\n0.01 0.1\n\n10\n-3\n\n10\n-2\n\nFigura 6.27 \u2013 Converg\u00eancia do gradiente da press\u00e3o no problema 1-C em\nmalhas de diferentes topologias.\n\n \n\n \n\n \n \n\n \n\n \n \n\nHexaedros\n\nTetraedros\n\nPrismas\n\nPir\u00e2mides\n\n1.0~ 0.057 h\n\n0.997~ 0.204 h\n\n0.999~ 0.122 h\n\n1.0~ 0.140 h\n\n0.01 0.1\n\n10\n-3\n\n10\n-2\n\nFigura 6.28 \u2013 Converg\u00eancia dos fluxos no problema 1-C em malhas de\ndiferentes topologias.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 126\n\nposs\u00edvel analisar a converg\u00eancia de solu\u00e7\u00f5es num\u00e9ricas para o problema\n\nadvectivo, de forma semelhante ao feito nos problemas de difus\u00e3o apre-\n\nsentados anteriormente.\n\nConforme mostra a figura 6.29, para os experimentos num\u00e9ricos foi\n\nestipulada uma velocidade igual a ux , isto \u00e9, uma velocidade unit\u00e1ria na\ndire\u00e7\u00e3o x . Isso implica que o deslocamento acontece somente nessa dire-\n\n\u00e7\u00e3o. A superf\u00edcie de entrada do escoamento \u00e9 o plano x = 0 e a superf\u00edcie de\nsa\u00edda o plano x = 1. As outras superf\u00edcies de contorno n\u00e3o s\u00e3o atravessadas\npelos fluidos. A condi\u00e7\u00e3o de contorno na superf\u00edcie de entrada \u00e9 estipulada\n\ncomo\ns = 1 em x = 0 ; t > 0 . (6.14)\n\nPara completar a especifica\u00e7\u00e3o do problema, prescreve-se a condi\u00e7\u00e3o\n\ninicial\ns = 0 em ?; t = 0 . (6.15)\n\nx\n\nz\n\ny\n\nEntrada (x = 0)\nSa\u00edda(x = 1)\n\nVelocidade\nFun\u00e7\u00e3o fluxo fracion\u00e1rio\n\nDom\u00ednio\n\nFigura 6.29 \u2013 Problema 2.\n\nO problema especificado \u00e9 uma descri\u00e7\u00e3o simplificada de um pro-\n\ncesso de deslocamento \u00e1gua-\u00f3leo. O \u00f3leo, que inicialmente preenche o\n\ndom\u00ednio, \u00e9 deslocado gradualmente pela \u00e1gua que ingressa por x = 0.\nA equa\u00e7\u00e3o diferencial considerada ignora qualquer influ\u00eancia da gravi-\n\ndade, da press\u00e3o capilar ou da compressibilidade. Unicamente com essas\n\nsimplifica\u00e7\u00f5es \u00e9 poss\u00edvel determinar uma solu\u00e7\u00e3o anal\u00edtica simples para o\n\nproblema, a denominada solu\u00e7\u00e3o de Buckley-Leverett [16].\nNa descri\u00e7\u00e3o matem\u00e1tica do problema, a forma em que a \u00e1gua des-\n\nloca o \u00f3leo durante o processo depende da fun\u00e7\u00e3o fluxo fracion\u00e1rio. Para\n\nos experimentos num\u00e9ricos foi considerada a fun\u00e7\u00e3o indicada na figura\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 127\n\n6.29, a qual corresponde corresponde \u00e0s curvas de permeabilidade relativa\n\ndadas por k rw = s 2 e k ro =(1?s)2, e uma raz\u00e3o de viscosidades \u00b5o/\u00b5w = 4.\nA figura 6.30 mostra a representa\u00e7\u00e3o gr\u00e1fica da fun\u00e7\u00e3o fluxo fracion\u00e1rio\n\nconsiderada.\n\nPerfil de satura\u00e7\u00e3oFun\u00e7\u00e3o\n\n0 0.2 0.4 0.6 0.8 10\n0.2\n0.4\n0.6\n0.8\n\n1\n\n0 0.5 1 1.5 2 2.50\n0.2\n0.4\n0.6\n0.8\n\n1\n\n0.447\n\nFigura 6.30 \u2013 Fun\u00e7\u00e3o fluxo fracion\u00e1rio e perfil de satura\u00e7\u00e3o anal\u00edtico para o\nproblema 2.\n\nA equa\u00e7\u00e3o 6.13 pode ser transformada em uma equa\u00e7\u00e3o diferencial\n\nordin\u00e1ria, introduzindo a nova vari\u00e1vel independente ? = x/t . Portanto, a\nsolu\u00e7\u00e3o da equa\u00e7\u00e3o \u00e9 auto-similar, ou seja, apesar de evoluir no tempo, seu\n\nformato geom\u00e9trico permanece inalterado. A representa\u00e7\u00e3o da solu\u00e7\u00e3o\n\nanal\u00edtica para o problema 2, em rela\u00e7\u00e3o \u00e0 vari\u00e1vel independente x/t , \u00e9\n\nmostrada tamb\u00e9m na figura 6.30. Para o tipo de problema f\u00edsico conside-\n\nrado, essa curva \u00e9 usualmente denominada perfil de satura\u00e7\u00e3o. A referida\n\nsolu\u00e7\u00e3o anal\u00edtica foi obtida segundo o procedimento descrito em [4]. Note-\nse que o perfil apresenta uma descontinuidade, a qual \u00e9 t\u00edpica em equa\u00e7\u00f5es\n\nhiperb\u00f3licas n\u00e3o-lineares como a equa\u00e7\u00e3o 6.13.\n\nA fim de analisar a converg\u00eancia de solu\u00e7\u00f5es num\u00e9ricas para o pro-\n\nblema 2, considerou-se a norma L 1 do erro na aproxima\u00e7\u00e3o discreta do\n\ncampo de satura\u00e7\u00e3o. Essa norma, mais adequada para solu\u00e7\u00f5es que apre-\n\nsentam descontinuidades [44, 85], \u00e9 dada por\n\n?s =\n?\n\np?M\n\n?\n\n?s (x p , yp , z p)? s?p\n?\n\n??Vp . (6.16)\n\nNote-se que neste caso n\u00e3o \u00e9 considerada nenhuma normaliza\u00e7\u00e3o,\n\npois os valores da satura\u00e7\u00e3o est\u00e3o restritos sempre ao intervalo [0, 1].\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 128\n\nPara a obten\u00e7\u00e3o das solu\u00e7\u00f5es num\u00e9ricas, empregou-se uma imple-\n\nmenta\u00e7\u00e3o simplificada da formula\u00e7\u00e3o de escoamento bif\u00e1sico apresentada\n\nno cap\u00edtulo 5. Considerou-se um esquema expl\u00edcito para o avan\u00e7o da so-\n\nlu\u00e7\u00e3o no tempo, al\u00e9m de interpola\u00e7\u00e3o upwind de um ponto para aproxi-\n\nmar o fluxo fracion\u00e1rio nas faces dos volumes de controle. A condi\u00e7\u00e3o de\n\ncontorno dada na equa\u00e7\u00e3o (6.14) n\u00e3o foi implementada como condi\u00e7\u00e3o de\n\nDirichlet, isto \u00e9, n\u00e3o se for\u00e7ou que os valores nodais na fronteira de entrada\n\nadquiram o valor s = 1. Em vez disso, como \u00e9 costumeiro em formula\u00e7\u00f5es\nde volumes finitos, introduziu-se esse valor na equa\u00e7\u00e3o de balan\u00e7o para\n\nos volumes adjacentes, como parte do fluxo advectivo ingressando pelas\n\nfaces coincidentes com a fronteira. O fluxo atrav\u00e9s de uma dessas faces \u00e9\n\ndado por (Fw|s=1)v \u00b7?Sbf , no entanto, como Fw|s=1 = 1, o fluxo prescrito se\nreduz a v \u00b7?Sbf .\n\nUma dificuldade adicional para a an\u00e1lise de converg\u00eancia no problema\n\n2 \u00e9 a depend\u00eancia da solu\u00e7\u00e3o com o tempo. Entretanto, o prop\u00f3sito prin-\n\ncipal da an\u00e1lise \u00e9 verificar a converg\u00eancia da solu\u00e7\u00e3o num\u00e9rica ao refinar\n\nprogressivamente as malhas. Como uma forma de isolar o efeito do refina-\n\nmento espacial, o passo de tempo foi mantido fixo durante todo o processo\n\ntransiente e para todas as malhas. O valor do passo de tempo utilizado foi\n\n?t = 0.001, o qual satisfaz o crit\u00e9rio CFL em todas as malhas consideradas\nnos testes.\n\nA fim de se obter uma percep\u00e7\u00e3o inicial do comportamento da norma\n\ndo erro da satura\u00e7\u00e3o, a figura 6.31 mostra a varia\u00e7\u00e3o dessa norma com\n\no tempo, para solu\u00e7\u00f5es em tr\u00eas malhas estruturadas igualmente espa\u00e7a-\n\ndas, formadas por elementos hexa\u00e9dricos. Segundo se observa, as cur-\n\nvas apresentam um crescimento oscilat\u00f3rio na parte inicial. Uma vez que\n\nna equa\u00e7\u00e3o (6.16) apenas s\u00e3o considerados valores discretos da solu\u00e7\u00e3o\n\nanal\u00edtica, a posi\u00e7\u00e3o exata da descontinuidade nessa solu\u00e7\u00e3o, em um dado\n\ninstante de tempo, n\u00e3o pode ser percebida pela norma considerada. Al\u00e9m\n\ndisso, a maior parte dos erros se concentram na vizinhan\u00e7a da desconti-\n\nnuidade. Essas duas particularidades explicam o comportamento oscilat\u00f3-\n\nrio na parte inicial das curvas. Ao redor de t = 0.6, a descontinuidade aban-\ndona o dom\u00ednio e a partir desse instante observa-se uma redu\u00e7\u00e3o nos valo-\n\nres da norma do erro. Uma vez que, como j\u00e1 mencionado, o erro encontra-\n\nse concentrado principalmente em torno a descontinuidade, grande parte\n\ndele \u00e9 advectado para fora do dom\u00ednio quando a descontinuidade atra-\n\nvessa a fronteira de sa\u00edda.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 129\n\n \u00d7Malha 100 100 100\u00d7\n\n\u00d7Malha 40 0 04 \u00d74\n\n\u00d7Malha 10 10 10\u00d7\n\n0.0 0.2 0.4 0.6 0.8 1.0\n10\n\n-3\n\n10\n-2\n\n10\n-1\n\nt\n\nFigura 6.31 \u2013 Varia\u00e7\u00e3o temporal da norma do erro na satura\u00e7\u00e3o no pro-\nblema 2, para tr\u00eas malhas de hexaedros regulares.\n\nNo intuito de analisar a taxa de converg\u00eancia das solu\u00e7\u00f5es num\u00e9ricas,\n\nforam selecionados quatro instantes de tempo: t = {0.25, 0.5, 0.75, 1}. Nos\ndois primeiros, a descontinuidade se encontra ainda no interior do dom\u00ed-\n\nnio, enquanto que nos dois \u00faltimos, ela j\u00e1 atravessou a fronteira de sa\u00edda.\n\nOs valores determinados para a norma do erro, em malhas hexa\u00e9dricas\n\nregulares, encontram-se representados na figura 6.32, versus o tamanho\n\nrepresentativo dos elementos. Da mesma forma que para os problemas\n\ndifusivos, os gr\u00e1ficos incluem ajustes dos valores obtidos a express\u00f5es da\n\nforma \"s = a h b .\n\n \n\n \n\n \n \n\n \n\n \n \n\nt = 0.25\n\nt = 0.50\n\nt = 0.75 \n\nt = 1.0\n\n0.682~ 0.36 h\n\n0.687~ 0.46 h\n\n0.855~ 0.33 h\n\n0.852~ 0.27 h\n\n0.01 0.1\n\n10\n-2\n\n10\n-1\n\n \n\nFigura 6.32 \u2013 Converg\u00eancia do erro da satura\u00e7\u00e3o em 4 instantes de tempo,\npara malhas hexa\u00e9dricas regulares.\n\nPara t = 0.25 e t = 0.5, a taxa de converg\u00eancia observada \u00e9 de aproxi-\nmadamente 0.68. Este valor \u00e9 inferior \u00e0 taxa de primeira ordem que seria\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 130\n\nesperada para uma formula\u00e7\u00e3o em que \u00e9 utilizada interpola\u00e7\u00e3o upwind,\n\ncuja acur\u00e1cia \u00e9 formalmente de primeira ordem [78]. Entretanto, a partir\nde considera\u00e7\u00f5es te\u00f3ricas \u00e9 poss\u00edvel mostrar que, em presen\u00e7a de descon-\n\ntinuidades, a ordem de acur\u00e1cia de um esquema num\u00e9rico de primeira\n\nordem pode ser reduzida \u00e0 metade [85]. Para os outros dois instantes de\ntempo considerados, t = 0.75 e t = 1, a taxa de converg\u00eancia observada \u00e9\nde aproximadamente 0.85 em ambos os casos. Como para esses tempos\n\nn\u00e3o h\u00e1 mais descontinuidade no dom\u00ednio, a solu\u00e7\u00e3o \u00e9 suave e, portanto,\n\nera de se esperar uma taxa de converg\u00eancia mais pr\u00f3xima de 1. Por\u00e9m, em\n\nnenhum dos muitos casos testados, inclusive com perfis de satura\u00e7\u00e3o sem\n\nqualquer descontinuidade, obtiveram-se valores da taxa de converg\u00eancia\n\nmaiores aos apresentados aqui.\n\nA seguir s\u00e3o apresentados resultados com malhas distorcidas de ele-\n\nmentos hexa\u00e9dricos, do tipo considerado anteriormente nos problemas de\n\ndifus\u00e3o. A converg\u00eancia da norma do erro para essas malhas, no instante\n\nt = 0.5, encontra-se representada na figura 6.33. Nota-se pouca influ\u00eancia\nda distor\u00e7\u00e3o das malhas sobre a forma como o valor da norma do erro\n\n\u00e9 reduzida. Os valores da taxa de converg\u00eancia obtidos nos ajustes para\n\nas malhas distorcidas \u00e9 ligeiramente maior que no caso da malha regular.\n\nApesar disso, os valores da norma dos erros para essas malhas s\u00e3o ainda\n\nlevemente maiores do que na malha regular.\n\n \n\n \n\n \n \n\n \n\n \n \n\n0.687~ 0.46 h\n\n0.716~ 0.55 h\n\n0.727~ 0.55 h\n\n0.732~ 0.56 h\n\n \n\n0.01 0.1\n\n10\n-2\n\n10\n-1\n\n \n\nA = 0\n\nA = 0.04\n\nA = 0.08\n\nA = 0.12\n\nFigura 6.33 \u2013 Converg\u00eancia do erro da satura\u00e7\u00e3o em t = 0.5, para malhas\nhexa\u00e9dricas apresentando diferente amplitude de distor\u00e7\u00e3o.\n\nA fim de se obter uma vis\u00e3o alternativa da influ\u00eancia da distor\u00e7\u00e3o\n\ndas malhas sobre a solu\u00e7\u00e3o num\u00e9rica, na figura 6.34 s\u00e3o comparados os\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 131\n\ncampos de satura\u00e7\u00e3o correspondentes \u00e0 solu\u00e7\u00e3o anal\u00edtica e \u00e0s solu\u00e7\u00f5es\n\nnum\u00e9ricas nas malhas com distor\u00e7\u00e3o. Os campos para as solu\u00e7\u00f5es num\u00e9-\n\nricas correspondem, de forma aproximada, ao plano y = 0.25 das malhas\nde 21 \u00d7 21 \u00d7 21 elementos hexa\u00e9dricos. Esse \u00e9 um dos planos em que a\ndistor\u00e7\u00e3o das malhas \u00e9 m\u00e1xima.\n\nUma das primeiras particularidades a ser notada na figura 6.34 \u00e9 o\n\naparente adiantamento da descontinuidade nas solu\u00e7\u00f5es num\u00e9ricas. Em\n\nrealidade, devido ao car\u00e1ter difusivo dos erros, a descontinuidade encontra-\n\nse espalhada em uma espessura equivalente a dois ou tr\u00eas elementos. Isso\n\ncausa uma leve varia\u00e7\u00e3o da satura\u00e7\u00e3o diante do que seria a posi\u00e7\u00e3o exata\n\nda descontinuidade, dando a impress\u00e3o de ser a pr\u00f3pria descontinuidade\n\nna solu\u00e7\u00e3o num\u00e9rica. Por outro lado, a deforma\u00e7\u00e3o da geometria da des-\n\ncontinuidade n\u00e3o \u00e9 t\u00e3o severa quanto a deforma\u00e7\u00e3o da malha. Devido\n\nao car\u00e1ter senoidal da distor\u00e7\u00e3o das malhas, a deforma\u00e7\u00e3o da descon-\n\ntinuidade adquire tamb\u00e9m formato senoidal. Provavelmente por causa\n\ndisso \u00e9 que erros adicionais no campo de satura\u00e7\u00e3o se cancelam e, como\n\nresultado, n\u00e3o h\u00e1 um incremento apreci\u00e1vel na norma do erro para as\n\nmalhas distorcidas.\n\nPara finalizar a apresenta\u00e7\u00e3o de resultados relativos ao problema 2, na\n\nfigura 6.35 \u00e9 comparada a converg\u00eancia do erro da satura\u00e7\u00e3o para malhas\n\nformadas por outros tipos de elementos. Os resultados correspondem ao\n\ninstante t = 0.5, para malhas regulares de hexaedros, tetraedros, prismas\ne pir\u00e2mides. Em cada um desses tipos de malhas, a taxa de converg\u00eancia\n\nobservada \u00e9 similar \u00e0 previamente obtida para o problema 2.\n\n6.3 Verifica\u00e7\u00e3o do modelo de po\u00e7o\nNa se\u00e7\u00e3o 5.5 foi apresentado um modelo de po\u00e7o adequado para uso em\n\nmalhas n\u00e3o-estruturadas. Nesta se\u00e7\u00e3o procura-se verificar essa aborda-\n\ngem, mediante compara\u00e7\u00e3o de resultados obtidos utilizando o modelo com\n\nresultados de uma solu\u00e7\u00e3o de refer\u00eancia. Infelizmente n\u00e3o foi poss\u00edvel\n\nencontrar uma situa\u00e7\u00e3o para a qual seja poss\u00edvel determinar uma solu\u00e7\u00e3o\n\nexata para um problema envolvendo um po\u00e7o. A situa\u00e7\u00e3o na qual \u00e9 fact\u00edvel\n\nobter uma solu\u00e7\u00e3o anal\u00edtica para o escoamento em torno a um po\u00e7o j\u00e1\n\n\u00e9 empregada como parte do procedimento de determina\u00e7\u00e3o dos \u00edndices\n\nde po\u00e7o, portanto, n\u00e3o \u00e9 adequada para verificar o modelo. Considerou-\n\nse como solu\u00e7\u00e3o de refer\u00eancia, por tal raz\u00e3o, uma solu\u00e7\u00e3o num\u00e9rica em\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 132\n\nt = 0.05\nA = 0\n\nA = 0.\n04\n\nA = 0.\n08\n\nA = 0.\n12\n\n t = 0.25  t = 0.50\nS\n\n. \nA\n\nN\nA\n\nL\n\u00cd\nT\n\nI\nC\n\nA\n\nS\nA\n\nT\nU\n\nR\nA\n\n\u00c7\n\u00c3\n\nO\n\nS\nO\n\nL\nU\n\n\u00c7\n\u00c3\n\nO\n \n\nN\nU\n\nM\n\u00c9\n\nR\nI\n\nC\nA\n\n0\n0.5\n0.25\n0.75\n1\n\nFigura 6.34 \u2013 Campos de satura\u00e7\u00e3o no plano y = 0.25 correspondentes \u00e0\nsolu\u00e7\u00e3o anal\u00edtica e a solu\u00e7\u00f5es num\u00e9ricas obtidas em malhas\ncom diferentes amplitudes de distor\u00e7\u00e3o.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 133\n\n \n\n \n\n \n \n\n \n\n \n \n\n0.687~ 0.46 h\n\n0.651~ 0.59 h\n\n0.675~ 0.51 h\n\n0.742~ 0.63 h\n\nHexaedros\n\nTetraedos\n\nPrismas\n\nPir\u00e2mides\n\n0.01 0.1\n\n10\n-2\n\n10\n-1\n\n \n\nFigura 6.35 \u2013 Converg\u00eancia do erro da satura\u00e7\u00e3o em t = 0.5, para malhas\nregulares de diferentes topologias.\n\numa malha extremamente refinada na vizinhan\u00e7a do po\u00e7o, com a qual \u00e9\n\nposs\u00edvel dispensar o uso de um modelo de po\u00e7o.\n\nA geometria dos problemas considerados est\u00e1 especificada na figura\n\n6.36. Trata-se de um dom\u00ednio paralelepip\u00e9dico que cont\u00e9m um po\u00e7o reto\n\nde raio 0.1 m, inclinado em rela\u00e7\u00e3o \u00e0s fronteiras.6 Em todos os problemas\n\napresentados a seguir, o escoamento ingressa ao dom\u00ednio pela fronteira\n\nx = 0 e o abandona atrav\u00e9s do po\u00e7o. Todas as restantes fronteiras s\u00e3o\nconsideradas imperme\u00e1veis.\n\n(1000,500, 250)\n\n(150,100,50)\n\n(850, 400, 200)\n\nx\n\nO\n\nyz Entrada\nPo\u00e7o de raio 0.1 m\n\nFigura 6.36 \u2013 Geometria do dom\u00ednio e do po\u00e7o.\n\n6 Todas as coordenadas indicadas na figura 6.36, as quais determinam a geometria do\nproblema, est\u00e3o em metros.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 134\n\nDuas malhas n\u00e3o-estruturadas foram empregadas para os experimen-\n\ntos num\u00e9ricos nesta se\u00e7\u00e3o. A primeira malha, denominada malha M-1, \u00e9\n\nutilizada para obter a solu\u00e7\u00e3o de refer\u00eancia. Nela, a superf\u00edcie do po\u00e7o,\n\nisto \u00e9, a interface entre o po\u00e7o e o meio circundante, \u00e9 discretizada com\n\nelementos de contorno triangulares. No modelo num\u00e9rico para a solu\u00e7\u00e3o\n\nde refer\u00eancia, portanto, essa superf\u00edcie \u00e9 considerada como uma fronteira\n\ndo dom\u00ednio. Conforme ilustra a figura 6.37, a malha volum\u00e9trica est\u00e1 for-\n\nmada exclusivamente por elementos tetra\u00e9dricos. Dado que o raio do po\u00e7o\n\n\u00e9 v\u00e1rias ordens de grandeza menor que as dimens\u00f5es do dom\u00ednio, foi ne-\n\ncess\u00e1rio considerar uma redu\u00e7\u00e3o gradual do tamanho dos elementos at\u00e9\n\na superf\u00edcie do po\u00e7o, conforme mostra a referida figura. Esse refinamento\n\npermite discretizar adequadamente a superf\u00edcie do po\u00e7o e captar com sufi-\n\nciente precis\u00e3o na solu\u00e7\u00e3o num\u00e9rica o forte gradiente de press\u00e3o adjacente\n\nao po\u00e7o. Entretanto, esse tratamento exige um n\u00famero desproporcional\n\nde elementos em rela\u00e7\u00e3o a magnitude do problema considerado, mais de\n\n5 milh\u00f5es de elementos, como indica a figura 6.37.\n\nPo\u00e7o\n\nMalha de tetraedrosN\u00famero de elementos: 5 106 860N\u00famero de v\u00e9rtices: 875 919\nFigura 6.37 \u2013 Malha M-1: superf\u00edcie do po\u00e7o discretizada com elementos\n\nde contorno triangulares.\n\nA segunda malha considerada \u00e9 a malha M-2, mostrada na figura 6.38.\n\nNesta malha o po\u00e7o \u00e9 representado de forma discreta como uma sequ\u00eancia\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 135\n\nde elementos unidimensionais. Ao redor do po\u00e7o, a malha volum\u00e9trica\n\npossui formato cil\u00edndrico, como mostrado no detalhe da figura 6.38, com\n\numa camada de prismas e duas camadas de hexaedros. A por\u00e7\u00e3o restante\n\ndo dom\u00ednio \u00e9 discretizada com elementos tetra\u00e9dricos, al\u00e9m de alguns\n\nelementos piramidais na regi\u00e3o de transi\u00e7\u00e3o. Note-se que o n\u00famero total\n\nde elementos e o n\u00famero de v\u00e9rtices na malha M-2 s\u00e3o duas ordens de\n\ngrandeza menores que na malha M-1.\n\nMalha do po\u00e7o\n\nN\u00famero de tetraedros: 27 535N\u00famero de hexaedros: 336N\u00famero de prismas: 168N\u00famero de pir\u00e2mides: 192N\u00famero de v\u00e9rtices: 5 779Submalha cil\u00edndrica\nMalha mista\n\nFigura 6.38 \u2013 Malha M-2: po\u00e7o discretizado com elementos de po\u00e7o unidi-\nmensionais.\n\nNo dom\u00ednio mostrado na figura 6.36 foram resolvidos tr\u00eas problemas\n\nde escoamento monof\u00e1sico incompress\u00edvel em regime estacion\u00e1rio. A equa-\n\n\u00e7\u00e3o diferencial considerada para descrever tal tipo de escoamento \u00e9\n\n?? \u00b7\nK\n\n\u00b5\n?P = 0 , (6.17)\n\nque prov\u00e9m da substitui\u00e7\u00e3o da velocidade de Darcy na equa\u00e7\u00e3o de conser-\n\nva\u00e7\u00e3o de massa, a qual, para o caso considerado, reduz-se a?\u00b7 v = 0. Para\nsimplificar ainda mais a an\u00e1lise, desconsiderou-se tamb\u00e9m a influ\u00eancia da\n\ngravidade sobre o escoamento.\n\nA especifica\u00e7\u00e3o matem\u00e1tica do problema \u00e9 completada pelas condi-\n\n\u00e7\u00f5es de contorno\nP = 1000 bar em x = 0 , (6.18)\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 136\n\nP = 1 bar em ??W , (6.19)\n\nonde ??W \u00e9 a superf\u00edcie do po\u00e7o. Conforme mencionado previamente, as\nrestantes fronteiras do dom\u00ednio s\u00e3o consideradas imperme\u00e1veis.\n\nA rigor, a condi\u00e7\u00e3o (6.19) somente \u00e9 considerada quando o problema\n\n\u00e9 resolvido numericamente na malha M-1. Quando a solu\u00e7\u00e3o \u00e9 obtida na\n\nmalha M-2, emprega-se o modelo de po\u00e7o, definido pela equa\u00e7\u00e3o (5.49).\n\nNessa equa\u00e7\u00e3o considera-se ? = 1 bar ao longo de todo o po\u00e7o, isto \u00e9,\no mesmo valor de press\u00e3o considerado na malha M-1 como press\u00e3o na\n\nsuperf\u00edcie do po\u00e7o. Os valores dos \u00edndices de po\u00e7o para todos os volumes\n\nde controle em contato com o po\u00e7o s\u00e3o determinados segundo o procedi-\n\nmento descrito na se\u00e7\u00e3o 5.5.\n\nA seguir s\u00e3o apresentados resultados de tr\u00eas casos, os quais diferem no\n\ntensor permeabilidade, o qual \u00e9 uniforme em todo o dom\u00ednio. Na figura\n\n6.39 est\u00e3o especificados os tensores permeabilidade considerados. Nos\n\ntr\u00eas casos o valor da viscosidade do fluido \u00e9 10?3 Pa \u00b7s .\n\nProblema 3-AMeio homog\u00eaneo de permeabilidade K\nProblema 3-B\nProblema 3-C\n\nFigura 6.39 \u2013 Tensor permeabilidade para os problemas 3-A, 3-B e 3-C.\n\n6.3.1 Problema 3-A\n\nNo problema 3-A, a permeabilidade \u00e9 um tensor esf\u00e9rico e o meio poroso \u00e9,\n\nportanto, isotr\u00f3pico. Os campos de press\u00e3o obtidos nas malhas M-1 e M-2\n\ns\u00e3o comparados na figura 6.40. Os gr\u00e1ficos mostram a vari\u00e7\u00e3o do campo\n\nnas fronteiras externas, assim como algumas superf\u00edcies de valor constante\n\nou isosuperf\u00edcies. Observa-se uma proximidade not\u00e1vel no formato das\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 137\n\nisosuperf\u00edcies, considerando que a malha M-2 \u00e9 muito mais grosseira do\n\nque a malha M-1. As isosuperf\u00edcies apresentam um formato agu\u00e7ado na\n\nvizinhan\u00e7a do po\u00e7o por causa do elevado gradiente nessa regi\u00e3o.\n\nP\nR\n\nE\nS\n\nS\n\u00c3\n\nO\n  \n\n[bar]\n1000\n\n1000\n\n1000\n\n750\n\n750\n\n500\n\n500\n\n250\n\n250\n\n175\n\n175\n\n500.5\n750.25\n250.25\n1\n\n(a)\n\n(b)\n\nS\nO\n\nL\nU\n\n\u00c7\n\u00c3\n\nO\n N\n\nA\n-\n\nM\nA\n\nL\nH\n\nA\n M\n\n1\nS\n\nO\nL\n\nU\n\u00c7\n\n\u00c3\nO\n\n N\nA\n\n-\nM\n\nA\nL\n\nH\nA\n\n M\n2\n\nFigura 6.40 \u2013 Compara\u00e7\u00e3o dos campos de press\u00e3o para o problema 3-A\nresolvido nas malhas M-1 e M-2.\n\nNo problema especificado, o valor de press\u00e3o na interface entre po\u00e7o\n\ne reservat\u00f3rio \u00e9 mantido constante ao longo do po\u00e7o. Nessa circunst\u00e2ncia,\n\no resultado relevante para o po\u00e7o \u00e9 a vaz\u00e3o. A vaz\u00e3o que ingressa em um\n\npo\u00e7o n\u00e3o \u00e9 uniforme e, em geral, apresenta varia\u00e7\u00e3o significativa ao longo\n\ndo seu comprimento. Se u for a coordenada ao longo do po\u00e7o, a vaz\u00e3o total\n\nque abandona o reservat\u00f3rio pelo po\u00e7o ser\u00e1 dada por\n\n$W =\n\n?\n\nW\n\n$? du , (6.20)\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 138\n\nem que a derivada $? = d$/du pode ser aproximada, no problema dis-\ncreto, por\n\n$? ? $p /?up . (6.21)\n\nEsta aproxima\u00e7\u00e3o \u00e9 adequada para a solu\u00e7\u00e3o na malha M-2, sendo $p\na vaz\u00e3o para um volume de controle associado ao po\u00e7o e ?up a dimens\u00e3o\ndesse volume na dire\u00e7\u00e3o axial do po\u00e7o. A figura 6.41 apresenta a varia-\n\n\u00e7\u00e3o de $? ao longo do po\u00e7o no problema 3-A, determinada em ambas as\n\nmalhas. Para determinar os valores na malha M-1, a superf\u00edcie do po\u00e7o\n\nfoi dividida em 100 fatias do mesmo comprimento, somaram-se os valores\n\nda vaz\u00f5es atrav\u00e9s de todos os elementos de contorno em cada fatia e o\n\nresultado foi dividido pelo comprimento da respectiva fatia. Conforme\n\nse pode observar na figura 6.41, a concord\u00e2ncia entre os resultados em\n\nambas as malhas \u00e9 not\u00e1vel, tanto na varia\u00e7\u00e3o de $?, quanto no valor total\n\nda vaz\u00e3o.\n\n0 300 600 9000.000\n0.002\n0.004\n0.006\n0.008\n0.010\n\nx\n\ny\nu\n\nz\n\n Solu\u00e7\u00e3o na malha M-1Solu\u00e7\u00e3o na malha M-2\n\nMalha M-1Malha M-2 Erro: 0.2%2.4222.428\nVaz\u00e3o total \n\nFigura 6.41 \u2013 Compara\u00e7\u00e3o dos resultados de vaz\u00e3o no po\u00e7o para o pro-\nblema 3-A.\n\n6.3.2 Problema 3-B\n\nNo problema 3-B, as dire\u00e7\u00f5es principais do tensor K coincidem com as\ndire\u00e7\u00f5es coordenadas, entretanto, a permeabilidade na dire\u00e7\u00e3o z \u00e9 um\n\nd\u00e9cimo da permeabilidade nas outras dire\u00e7\u00f5es. As figuras 6.42 e 6.43 apre-\n\nsentam os resultados correspondentes a este problema.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 139\n\nP\nR\n\nE\nS\n\nS\n\u00c3\n\nO\n  \n\n[bar]\n\n1000\n1000\n\n1000\n\n800\n\n800\n\n600\n\n600\n\n500\n\n500\n\n400\n\n400\n\n500.5\n750.25\n250.25\n1\n\n(a)\n\n(b)\n\nS\nO\n\nL\nU\n\n\u00c7\n\u00c3\n\nO\n N\n\nA\n-\n\nM\nA\n\nL\nH\n\nA\n M\n\n1\nS\n\nO\nL\n\nU\n\u00c7\n\n\u00c3\nO\n\n N\nA\n\n-\nM\n\nA\nL\n\nH\nA\n\n M\n2\n\nFigura 6.42 \u2013 Compara\u00e7\u00e3o dos campos de press\u00e3o para o problema 3-B\nresolvido nas malhas M-1 e M-2.\n\nMalha M-1Malha M-2 Erro: 5.8%1.2171.146\nVaz\u00e3o total \n\nu\n0 300 600 9000.000\n\n0.001\n0.002\n0.003\n0.004\n0.005  Solu\u00e7\u00e3o na malha M-1Solu\u00e7\u00e3o na malha M-2\n\nFigura 6.43 \u2013 Compara\u00e7\u00e3o dos resultados de vaz\u00e3o no po\u00e7o para o pro-\nblema 3-B.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 140\n\nConforme se pode evidenciar na figura 6.42, as isosuperf\u00edcies apre-\n\nsentam um formato achatado na dire\u00e7\u00e3o z , pelo fato da permeabilidade\n\nser menor nessa dire\u00e7\u00e3o. Em geral, em problemas como o resolvido, a\n\ncomponente maior do gradiente de press\u00e3o est\u00e1 orientada na dire\u00e7\u00e3o da\n\nmenor permeabilidade e, portanto, as isosuperf\u00edcies tendem a ser perpen-\n\ndiculares a essa dire\u00e7\u00e3o.\n\nDos tr\u00eas problemas considerados aqui para verificar o modelo de po\u00e7o,\n\no problema 3-B \u00e9 o que maior discrep\u00e2ncia apresenta entre os resultados\n\nnas malhas M-1 e M-2. Isso \u00e9 mais evidente nos resultados da vaz\u00e3o no\n\npo\u00e7o, mostrados na figura 6.43. A causa mais prov\u00e1vel para essa discrep\u00e2n-\n\ncia encontra-se no procedimento de determina\u00e7\u00e3o dos \u00edndices de po\u00e7o.\n\nQuando o problema num\u00e9rico \u00e9 resolvido em uma por\u00e7\u00e3o de malha ao\n\nredor de um elemento de po\u00e7o, como a ilustrada na figura 5.7, assume-\n\nse que a vaz\u00e3o pelas fronteiras transversais \u00e9 desprez\u00edvel. Essa hip\u00f3tese\n\n\u00e9 aceit\u00e1vel quando o meio for isotr\u00f3pico, situa\u00e7\u00e3o em que o escoamento\n\nser\u00e1 radial na vizinhan\u00e7a imediata do po\u00e7o e, portanto, o gradiente de\n\npress\u00e3o apontar\u00e1 sempre na dire\u00e7\u00e3o radial. Em um meio anisotr\u00f3pico, no\n\nentanto, pode existir uma componente importante do gradiente na dire\u00e7\u00e3o\n\naxial, pelo fato comentado previamente do gradiente tender a orientar-se\n\nna dire\u00e7\u00e3o de menor permeabilidade. A omiss\u00e3o da vaz\u00e3o axial induzida\n\npor essa componente pode estar causando um desvio no valor dos \u00edndices\n\nde po\u00e7o calculados, o qual, por sua vez, estaria provocando a maior discre-\n\np\u00e2ncia observada no problema 3-B.\n\n6.3.3 Problema 3-C\n\nA permeabilidade especificada para o problema 3-C \u00e9 dada por um tensor\n\ncheio, isto \u00e9, um tensor com todas as componentes n\u00e3o-nulas. Os valores\n\nprincipais do tensor s\u00e3o 10?14, 10?13 e 10?15 m 2, associados aos autove-\n\ntores (0.873,?0.436,?0.218), (0,?0.447, 0.894) e (?0.488,?0.781,?0.390),\nrespectivamente. Os resultados relevantes para este problema est\u00e3o resu-\n\nmidos nas figuras 6.44 e 6.45.\n\nUma das caracter\u00edsticas destac\u00e1veis dos resultados do problema 3-C\n\n\u00e9 a vaz\u00e3o quase nula na por\u00e7\u00e3o inicial do po\u00e7o.7 Como se pode deduzir\n\nda figura 6.44, a maior varia\u00e7\u00e3o da press\u00e3o est\u00e1 concentrada na regi\u00e3o\n\n7 Inicial em rela\u00e7\u00e3o \u00e0 coordenada u que, como mostrado na figura 6.45, tem sua origem\nno topo do po\u00e7o.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 141\n\nP\nR\n\nE\nS\n\nS\n\u00c3\n\nO\n  \n\n[bar]\n\n1000\n1000\n\n1000\n\n800\n\n800\n\n600\n\n600\n\n200\n\n200\n\n100\n\n100\n\n50\n\n50\n\n400\n\n400\n\n500.5\n750.25\n250.25\n1\n\n(a)\n\n(b)\n\nS\nO\n\nL\nU\n\n\u00c7\n\u00c3\n\nO\n N\n\nA\n-\n\nM\nA\n\nL\nH\n\nA\n M\n\n1\nS\n\nO\nL\n\nU\n\u00c7\n\n\u00c3\nO\n\n N\nA\n\n-\nM\n\nA\nL\n\nH\nA\n\n M\n2\n\nFigura 6.44 \u2013 Compara\u00e7\u00e3o dos campos de press\u00e3o para o problema 3-C\nresolvido nas malhas M-1 e M-2.\n\n Solu\u00e7\u00e3o na malha M-1Solu\u00e7\u00e3o na malha M-2\n\nu\n0 300 600 9000.0000\n\n0.0005\n0.0010\n0.0015\n0.0020\n\nMalha M-1Malha M-2 Erro: 1.9%0.25860.2636\nVaz\u00e3o total \n\nFigura 6.45 \u2013 Compara\u00e7\u00e3o dos resultados de vaz\u00e3o no po\u00e7o para o pro-\nblema 3-C.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 142\n\npr\u00f3xima \u00e0 fronteira de entrada. No outro extremo do dom\u00ednio, a press\u00e3o\n\n\u00e9 praticamente constante, o que implica um gradiente nulo nessa regi\u00e3o. A\n\nvaz\u00e3o nula na parte superior do po\u00e7o \u00e9 concordante com essa distribui\u00e7\u00e3o\n\nespacial da press\u00e3o. Por outro lado, \u00e9 poss\u00edvel observar que as isosuperf\u00ed-\n\ncies de press\u00e3o tendem a se posicionar perpendicularmente ao autovetor\n\n(?0.488,?0.781,?0.390), o qual est\u00e1 associado ao menor autovalor do ten-\nsor permeabilidade.\n\n6.4 Problema 4: deslocamento bif\u00e1sico\nPara finalizar este cap\u00edtulo s\u00e3o apresentados alguns resultados correspon-\n\ndentes a um problema em que o escoamento \u00e9 descrito pelo modelo de\n\ndeslocamento bif\u00e1sico apresentado no cap\u00edtulo 5. Trata-se do processo\n\nde recupera\u00e7\u00e3o secund\u00e1ria de \u00f3leo em um reservat\u00f3rio tridimensional, no\n\nqual existem tr\u00eas po\u00e7os injetores e dois po\u00e7os produtores. Um esbo\u00e7o da\n\ngeometria e da malha considerada \u00e9 mostrado na figura 6.46.\n\nz xy -Po\u00e7o I 1\n-Po\u00e7o P 1\n\n-Po\u00e7o I 2\n-Po\u00e7o P 2\n\n-Po\u00e7o I 3\nMalha\nDom\u00ednio\n\nN\u00famero de tetraedros: 35286N\u00famero de hexaedros: 544N\u00famero de prismas: 544N\u00famero de pir\u00e2mides: 576N\u00famero de v\u00e9rtices: 8073\n\nDimens\u00e3o m\u00e1xima em x: 200 mDimens\u00e3o m\u00e1xima em y: 200 mDimens\u00e3o m\u00e1xima em z: 130 m\n\nFigura 6.46 \u2013 Malha n\u00e3o-estruturada para o problema 4.\n\nO reservat\u00f3rio possui tr\u00eas camadas de diferentes rochas, as quais apre-\n\nsentam propriedades f\u00edsicas diferentes. A geometria das camadas e os\n\nvalores das propriedades correspondentes s\u00e3o apresentados na figura 6.47.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 143\n\nCamada 1Camada 2Camada 3\nz xy\n\nCamada 1\nCamada 2\nCamada 3\n\nFigura 6.47 \u2013 Propriedades f\u00edsicas associadas \u00e0s camadas do reservat\u00f3rio\nno problema 4.\n\nOs tr\u00eas po\u00e7os injetores s\u00e3o po\u00e7os verticais que atravessam integral-\n\nmente a espessura do reservat\u00f3rio. J\u00e1 os dois po\u00e7os produtores s\u00e3o po\u00e7os\n\ndirecionais, cuja geometria \u00e9 mostrada de forma esquem\u00e1tica na figura\n\n6.48. Conforme indicado nessa figura, a vaz\u00e3o de \u00e1gua injetada em todos os\n\npo\u00e7os injetores \u00e9 de 0.005 m 3/s . Por outro lado, a press\u00e3o de refer\u00eancia para\n\nambos os po\u00e7os produtores \u00e9 de 10 bar. Para o problema considerado, essa\n\npress\u00e3o corresponde \u00e0 press\u00e3o interna na se\u00e7\u00e3o onde cada po\u00e7o atravessa\n\n\u00e0 fronteira superior do reservat\u00f3rio. Em torno a cada um dos po\u00e7os a malha\n\nvolum\u00e9trica tem formato cil\u00edndrico, acompanhando a trajet\u00f3ria da linha\n\nque representa o po\u00e7o no modelo discreto. A por\u00e7\u00e3o restante da malha do\n\nreservat\u00f3rio est\u00e1 formada por tetraedros e algumas pir\u00e2mides, na transi\u00e7\u00e3o\n\ncom as por\u00e7\u00f5es de geometria cil\u00edndrica ao redor dos po\u00e7os.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 144\n\nz xy\n-I 1-I 1\n\n-I 2-I 2\n\n-P 1\n-P 1\n\n-P 2-I 3-P 2-I 3\n\nz xy\n\n- -Po\u00e7os produtores P 1, P 2\n- - -Po\u00e7os injetores I 1, I 2, I 3 Raio [m] Condi\u00e7\u00e3o de opera\u00e7\u00e3o\n\nFigura 6.48 \u2013 Geometria dos po\u00e7os e condi\u00e7\u00f5es de opera\u00e7\u00e3o prescritas para\no problema 4.\n\nO processo de deslocamento \u00e1gua-\u00f3leo no reservat\u00f3rio foi simulado\n\nconsiderando as curvas de permeabilidade relativa dadas por k rw = s 2\n\ne k ro = (1 ? s)2, para as fases \u00e1gua e \u00f3leo, respectivamente. Os valores\nde viscosidade considerados para essas fases foram \u00b5w = 0.001 Pa \u00b7s e\n\u00b5o = 0.01 Pa \u00b7s , respectivamente. Al\u00e9m disso, os valores da densidade das\nfases foram fixados em ?w = 1000 kg/m 3 e ?o = 800 kg/m 3, respectiva-\nmente. A acelera\u00e7\u00e3o devida \u00e0 gravidade especificada foi g =(9.8, 0, 0) m/s 2.\nFinalmente, como condi\u00e7\u00e3o inicial para o processo, considerou-se s = 0\nem todo o dom\u00ednio de solu\u00e7\u00e3o. Todas as fronteiras do reservat\u00f3rio s\u00e3o\n\nimperme\u00e1veis.\n\nA seguir s\u00e3o apresentados alguns resultados num\u00e9ricos relevantes, ob-\n\ntidos para o problema com a formula\u00e7\u00e3o proposta. Os resultados mostra-\n\ndos t\u00eam apenas car\u00e1ter ilustrativo, pois, para um problema dessa enver-\n\ngadura \u00e9 extremamente dif\u00edcil determinar uma solu\u00e7\u00e3o de refer\u00eancia para\n\nfins de compara\u00e7\u00e3o.\n\nA figura 6.49 mostra algumas isosuperf\u00edcies de press\u00e3o em tr\u00eas est\u00e1-\n\ngios do processo transiente. Os n\u00edveis de tempo correspondem ao ins-\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 145\n\nP\nR\n\nE\nS\n\nS\n\u00c3\n\nO\n \n \n[bar]\n\n155.1\n85.0\n120.0\n50.0\n14.9\n\nP\nR\n\nE\nS\n\nS\n\u00c3\n\nO\n \n \n[bar]\n\n197.4\n107.2\n152.3\n62.1\n17.0\n\nP\nR\n\nE\nS\n\nS\n\u00c3\n\nO\n \n \n[bar]\n\n773.6\n398.4\n586.0\n210.8\n23.2\n\n  = 0\n\n  = 1 VPI\n\n  = 2 VPI\n\nFigura 6.49 \u2013 Campo de press\u00e3o em tr\u00eas instantes de tempo.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 146\n\ntante inicial do processo,8 e depois de terem-se injetado volumes de \u00e1gua\n\nequivalentes a 1 e 2 volumes porosos do reservat\u00f3rio. Na simula\u00e7\u00e3o de\n\nprocessos de recupera\u00e7\u00e3o secund\u00e1ria de \u00f3leo \u00e9 usual definir como tempo\n\nadimensional o volume poroso injetado (VPI) que \u00e9, precisamente, a fra\u00e7\u00e3o\n\ndo volume poroso do reservat\u00f3rio equivalente ao volume de \u00e1gua injetada\n\nat\u00e9 um dado n\u00edvel de tempo. Matematicamente, tem-se\n\n? =\n\n?\n\nW inj??\n\n? t\n\n0\n$W dt\n\n?\n\n?\n? dV\n\n, (6.22)\n\nonde a soma no numerador se estende a todos os po\u00e7os injetores no dom\u00ed-\n\nnio. Em todos os resultados apresentados nesta se\u00e7\u00e3o, a grandeza adimen-\n\nsional definida na equa\u00e7\u00e3o (6.22) substitui a vari\u00e1vel tempo.\n\nA figura 6.50 ilustra a evolu\u00e7\u00e3o do campo de satura\u00e7\u00e3o mediante iso-\n\nsuperf\u00edcies, em tr\u00eas est\u00e1gios iniciais do processo de deslocamento. Em es-\n\nt\u00e1gios posteriores do processo, a geometria das isosuperf\u00edcies de satura\u00e7\u00e3o\n\ntorna-se bem mais intrincada, o qual dificulta sua visualiza\u00e7\u00e3o. De forma\n\ncomplementar, a figura 6.51 mostra a configura\u00e7\u00e3o do campo de satura\u00e7\u00e3o\n\nem dua se\u00e7\u00f5es obtidas cortando o dom\u00ednio com dois planos verticais.\n\nGeralmente, os resultados mais importantes na simula\u00e7\u00e3o de um pro-\n\ncesso de recupera\u00e7\u00e3o s\u00e3o referidos aos po\u00e7os produtores. Para o problema\n\nconsiderado, a figura 6.52 apresenta a varia\u00e7\u00e3o das vaz\u00f5es por unidade de\n\ncomprimento, determinadas segundo indica a equa\u00e7\u00e3o (6.21), em tr\u00eas n\u00ed-\n\nveis de tempo selecionados e para os dois po\u00e7os produtores. Essa varia\u00e7\u00e3o\n\n\u00e9 representada em rela\u00e7\u00e3o \u00e0s coordenadas curvil\u00edneas u 1 e u 2, definidas ao\n\nlongo dos po\u00e7os P-1 e P-2, respectivamente. A origem desses sistemas co-\n\nordenados est\u00e1 localizada na se\u00e7\u00e3o em que esses po\u00e7os atravessam a fron-\n\nteira superior do reservat\u00f3rio. Complementando os gr\u00e1ficos da figura 6.52,\n\nas figuras 6.53 e 6.54 apresentam a varia\u00e7\u00e3o temporal das vaz\u00f5es completas\n\nde \u00f3leo, \u00e1gua e a soma de ambas, para os po\u00e7os P-1 e P-2, respectivamente.\n\nNessas figuras pode-se evidenciar que a frente de \u00e1gua chega primeiro\n\nao po\u00e7o P-1 do que ao po\u00e7o P-2, em um est\u00e1gio bastante inicial do pro-\n\ncesso. Essa frente de \u00e1gua procede do po\u00e7o injetor I-1, o qual se encon-\n\ntra localizado bastante pr\u00f3ximo da parte inicial do po\u00e7o P-1. Uma vis\u00e3o\n\n8 Uma vez que no modelo considerado os fluidos s\u00e3o incompress\u00edveis, ap\u00f3s um infinit\u00e9-\nsimo de tempo do processo de inje\u00e7\u00e3o ter-se iniciado, um campo de press\u00e3o estabelece-se\nem todo o dom\u00ednio. Esse \u00e9 o campo mostrado na figura 6.49, para ?= 0.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 147\n\nS\nA\n\nT\nU\n\nR\nA\n\n\u00c7\n\u00c3\n\nO\n\n1\n0.5\n0.75\n0.25\n0\n\nIsosuperf\u00edciesrepresentadas0.30.450.60.750.9\n\n  = 0.2 VPI\n\n  = 0.4 VPI\n\n  = 0.6 VPI\n\nFigura 6.50 \u2013 Campo de satura\u00e7\u00e3o em tr\u00eas instantes de tempo, na parte\ninicial do processo transiente.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 148\n\nS\nA\n\nT\nU\n\nR\nA\n\n\u00c7\n\u00c3\n\nO\n\n1\n0.5\n0.75\n0.25\n0\n\n  = 0.25 VPI\n\n  = 1 VPI\n\n  = 2 VPI\n\nFigura 6.51 \u2013 Campo de satura\u00e7\u00e3o em duas se\u00e7\u00f5es transversais do dom\u00ednio,\npara tr\u00eas instantes de tempo.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 149\n\n0 10 20 30 40 50 60 700.0\n1.5 x10-4\n3.0 x10-4\n4.5 x10-4\n6.0 x10-4\n\n0 10 20 30 40 50 60 700.0\n1.5 x10-4\n3.0 x10-4\n4.5 x10-4\n6.0 x10-4\n\n0.0\n1.5 x10-4\n3.0 x10-4\n4.5 x10-4\n6.0 x10-4\n\n0 10 20 30 40 50 60 70\n\n0 10 20 30 40 50 60 700\n10-4\n\n2 x10-4\n3 x10-4\n\n0 10 20 30 40 50 60 700\n10-4\n\n2 x10-4\n3 x10-4\n\n0 10 20 30 40 50 60 700\n10-4\n\n2 x10-4\n3 x10-4\n\n1 2\n\n1 2\n\n1 2\n\nP O \u00c7 O P - 1 P O \u00c7 O P - 2\n\n\u00d3leo  \u00c1gua  Total\n\n   = 0.05 VPI\n\n   = 0.5 VPI\n\n   = 1 VPI\n\nFigura 6.52 \u2013 Vaz\u00f5es ao longo dos po\u00e7os produtores em tr\u00eas n\u00edveis de\ntempo.\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 150\n\n0.0 0.5 1.0 1.5 2.0\n\n0.000\n\n0.004\n\n0.008\n\n0.012\n\nVaz\u00e3o de \u00f3leo\n\nVaz\u00e3o de \u00e1gua\n\nVaz\u00e3o total\n\nP O \u00c7 O P - 1\n\nFigura 6.53 \u2013 Varia\u00e7\u00e3o temporal das vaz\u00f5es completas no po\u00e7o P-1.\n\nVaz\u00e3o de \u00f3leo\n\nVaz\u00e3o de \u00e1gua\n\nVaz\u00e3o total\n\nP O \u00c7 O P - 2\n\n0.0 0.5 1.0 1.5 2.0\n\n0.000\n\n0.002\n\n0.004\n\n0.006\n\nFigura 6.54 \u2013 Varia\u00e7\u00e3o temporal das vaz\u00f5es completas no po\u00e7o P-2.\n\nmais abrangente do desempenho qualitativo dos po\u00e7os produtores pode\n\nser obtida com o gr\u00e1fico de corte de \u00e1gua. O corte de \u00e1gua \u00e9 definido\n\ncomo a raz\u00e3o entre a vaz\u00e3o de \u00e1gua e a vaz\u00e3o total produzida por um po\u00e7o.\n\nO gr\u00e1fico do corte de \u00e1gua para os po\u00e7os P-1 e P-2 \u00e9 mostrado na figura\n\n6.55. Nele evidencia-se mais claramente que n\u00e3o apenas a \u00e1gua chega\n\nmais rapidamente ao po\u00e7o P-1, como ele produz proporcionalmente mais\n\n\u00e1gua durante todo o processo simulado. Apesar disso, o volume de \u00f3leo\n\nproduzido por esse po\u00e7o \u00e9 maior que o produzido pelo po\u00e7o P-2, conforme\n\nmostra a figura 6.56. Esse aparente paradoxo pode ser explicado exami-\n\nnando novamente as figuras 6.53 e 6.54, as quais mostram que a vaz\u00e3o total\n\nproduzida em um dado tempo pelo po\u00e7o P-1 \u00e9 mais do dobro da vaz\u00e3o\n\ntotal produzida pelo po\u00e7o P-2. Assim, a vaz\u00e3o de \u00f3leo produzido pelo po\u00e7o\n\nP-1 \u00e9 proporcionalmente menor, em rela\u00e7\u00e3o \u00e0 vaz\u00e3o total produzida por\n\n\n\nEX EM P LO S DE AP LIC A\u00c7 \u00c3O 151\n\nesse po\u00e7o, por\u00e9m, ainda assim \u00e9 maior do a que vaz\u00e3o de \u00f3leo produzida\n\npelo po\u00e7o P-2, em termos absolutos.\n\n0.0 0.5 1.0 1.5 2.0\n\n0.0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1.0\n\nPo\u00e7o P-1\n\nPo\u00e7o P-2\n\nCo\nrt\n\ne \nde\n\n \u00e1\ngu\n\na\n\nFigura 6.55 \u2013 Corte de \u00e1gua nos dois po\u00e7os produtores.\n\n0.0 0.5 1.0 1.5 2.0\n\n0\n\n10\n4\n\n2 x10\n4\n\n3 x10\n4\n\n4 x10\n4\n\n5 x10\n4\n\nPo\u00e7o P-1\n\nPo\u00e7o P-2\n\nPr\nod\n\nu\u00e7\n\u00e3o\n\n d\ne \n\n\u00f3l\neo\n\n \n\nFigura 6.56 \u2013 Volume de \u00f3leo produzido nos dois po\u00e7os produtores.\n\n\n\nCAP\u00cdTULO\n\n7\nConclus\u00e3o\n\nNeste trabalho foi apresentada uma formula\u00e7\u00e3o num\u00e9rica tridimensional,\n\naplicando o m\u00e9todo de volumes finitos baseado em elementos a um mo-\n\ndelo de deslocamento de fluidos em reservat\u00f3rios de petr\u00f3leo. A formu-\n\nla\u00e7\u00e3o admite a utiliza\u00e7\u00e3o de malhas n\u00e3o-estruturadas h\u00edbridas formadas\n\npor hexaedros, tetraedros, prismas e pir\u00e2mides. Al\u00e9m de proporcionar\n\numa maior flexibilidade para a representa\u00e7\u00e3o geom\u00e9trica de reservat\u00f3rios\n\ntridimensionais, a formula\u00e7\u00e3o \u00e9 conservativa no n\u00edvel discreto, caracte-\n\nr\u00edstica fundamental de todo m\u00e9todo de volumes finitos. Por constru\u00e7\u00e3o,\n\ntodas as aproxima\u00e7\u00f5es num\u00e9ricas s\u00e3o restritas aos elementos da malha\n\nempregada para representar o reservat\u00f3rio, o qual facilita de forma signifi-\n\ncativa a implementa\u00e7\u00e3o computacional do m\u00e9todo. A formula\u00e7\u00e3o admite,\n\nal\u00e9m disso, que a permeabilidade de um meio anisotr\u00f3pico esteja repre-\n\nsentada por um tensor completo, quando as dire\u00e7\u00f5es principais do tensor\n\nn\u00e3o coincidirem com os eixos coordenados. Reservat\u00f3rios heterog\u00eaneos\n\npodem ser representados com permeabilidade e porosidade variando de\n\num elemento a outro da malha.\n\nOs resultados apresentados no cap\u00edtulo 6 permitem estabelecer al-\n\ngumas conclus\u00f5es quanto ao desempenho de diferentes aspectos da for-\n\nmula\u00e7\u00e3o. Para os testes nesse cap\u00edtulo, adotou-se um enfoque em que as\n\n152\n\n\n\nCO NCLU S\u00c3O 153\n\npartes componentes da formula\u00e7\u00e3o s\u00e3o testadas de forma separada. Esse\n\nenfoque \u00e9 comum com modelos num\u00e9ricos de certa complexidade, pela\n\ndificuldade de se obter solu\u00e7\u00f5es anal\u00edticas, para comparar os resultados\n\nnum\u00e9ricos, envolvendo a formula\u00e7\u00e3o como um todo.\n\nEm problemas puramente difusivos, a taxa de converg\u00eancia observada\n\npara a vari\u00e1vel da equa\u00e7\u00e3o foi de segunda ordem. Essa taxa de converg\u00ean-\n\ncia foi a mesma em malhas formadas por hexaedros, tetraedros, prismas\n\nou pir\u00e2mides. Em um tipo especial de malha h\u00edbrida considerado em um\n\ndos experimentos num\u00e9ricos, o valor da taxa de converg\u00eancia observada\n\nfoi ligeiramente menor a 2. Entretanto, a causa para essa redu\u00e7\u00e3o pode\n\nestar na diferente estrutura topol\u00f3gica da por\u00e7\u00e3o tetra\u00e9drica para diferen-\n\ntes n\u00edveis de refinamento, pois na gera\u00e7\u00e3o das malhas n\u00e3o se teve controle\n\nsobre essa estrutura. Por outro lado, nos testes realizados com malhas\n\nformadas por um \u00fanico tipo de elemento, o valor da taxa de converg\u00eancia\n\nmanteve-se praticamente inalterado mesmo quando os elementos das ma-\n\nlhas foram distorcidos. Resultados semelhantes foram obtidos com per-\n\nmeabilidade constante e isotr\u00f3pica quanto com permeabilidade vari\u00e1vel e\n\nanisotr\u00f3pica.\n\nNos mesmos experimentos num\u00e9ricos foi evidenciada uma taxa de\n\nconverg\u00eancia de primeira ordem para a aproxima\u00e7\u00e3o do gradiente da va-\n\nri\u00e1vel e para a aproxima\u00e7\u00e3o dos fluxos nas faces dos volumes de controle. A\n\nnot\u00e1vel exce\u00e7\u00e3o foram as solu\u00e7\u00f5es nas malhas regulares de hexaedros, nas\n\nquais a norma do erro associado aos fluxos nas faces diminui a uma taxa\n\nlevemente maior a 2, quando a permeabilidade \u00e9 isotr\u00f3pica.\n\nEm um problema advectivo n\u00e3o-linear, determinado pela equa\u00e7\u00e3o de\n\nBuckley-Leverett, observaram-se taxas de converg\u00eancia com valores infe-\n\nriores ao valor te\u00f3rico de primeira ordem associado ao tipo de aproxima-\n\n\u00e7\u00f5es num\u00e9ricas consideradas para o termo advectivo. Esse valor te\u00f3rico,\n\ncontudo, corresponde a casos em que a solu\u00e7\u00e3o \u00e9 suave, sem desconti-\n\nnuidades. Entretanto, a solu\u00e7\u00e3o para o problema considerado apresenta\n\numa descontinuidade que avan\u00e7a com velocidade constante. Os valores\n\nobservados para a taxa de converg\u00eancia em instantes de tempo em que\n\na descontinuidade se encontra no dom\u00ednio s\u00e3o levemente menores aos\n\ncorrespondentes a instantes posteriores a sua sa\u00edda.\n\nEm outro conjunto de problemas, o modelo de po\u00e7o considerado neste\n\ntrabalho foi testado considerando diferentes tensores permeabilidade. Ante\n\na car\u00eancia de uma solu\u00e7\u00e3o exata para os problemas considerados, solu-\n\n\n\nCO NCLU S\u00c3O 154\n\n\u00e7\u00f5es num\u00e9ricas em malhas extremamente refinadas foram consideradas\n\ncomo ponto de compara\u00e7\u00e3o para as solu\u00e7\u00f5es em malhas grosseiras em\n\nque o modelo de po\u00e7o era utilizado. O grau de concord\u00e2ncia observado\n\nentre essas solu\u00e7\u00f5es testemunha o desempenho satisfat\u00f3rio da abordagem\n\nproposta neste trabalho para a modelagem dos po\u00e7os no modelo num\u00e9-\n\nrico. A maior discord\u00e2ncia observada nos casos anisotr\u00f3picos pode ser\n\natribu\u00edda \u00e0 hip\u00f3tese de vaz\u00e3o nula em superf\u00edcies transversais ao po\u00e7o,\n\nconsiderada no subproblema auxiliar para a determina\u00e7\u00e3o dos \u00edndices de\n\npo\u00e7o. Acredita-se que eliminando essa hip\u00f3tese e calculando essas vaz\u00f5es\n\na partir da solu\u00e7\u00e3o anal\u00edtica do subproblema auxiliar, os resultados possam\n\nmelhorar e se equiparar aos do caso isotr\u00f3pico.\n\nO \u00faltimo problema apresentado no cap\u00edtulo 6 permitiu mostrar um\n\npouco do potencial da formula\u00e7\u00e3o num\u00e9rica em aplica\u00e7\u00f5es mais real\u00edsti-\n\ncas. Um dom\u00ednio tridimensional contendo po\u00e7os direcionais foi discreti-\n\nzado por uma malha h\u00edbrida, formada principalmente por elementos te-\n\ntra\u00e9dricos. Nesse caso, uma malha relativamente grosseira permitiu de-\n\nterminar uma aproxima\u00e7\u00e3o num\u00e9rica detalhada de grandezas associadas\n\nao escoamento nos po\u00e7os produtores, os quais apresentavam trajet\u00f3ria\n\ncurva no problema considerado. O enfoque considerado para os po\u00e7os na\n\nformula\u00e7\u00e3o \u00e9 promissor para casos em que a representa\u00e7\u00e3o da trajet\u00f3ria\n\ndos po\u00e7os no modelo num\u00e9rico seja de import\u00e2ncia cr\u00edtica. Obviamente\n\nque, quando necess\u00e1rio, maiores detalhes podem ser introduzidos na mo-\n\ndelagem, especialmente no referido \u00e0 descri\u00e7\u00e3o do escoamento no interior\n\ndos po\u00e7os.\n\n\u00c9 previs\u00edvel que no futuro malhas n\u00e3o-estruturadas tridimensionais\n\nsejam adotadas na simula\u00e7\u00e3o de reservat\u00f3rios em aplica\u00e7\u00f5es espec\u00edficas\n\nque requeiram uma descri\u00e7\u00e3o acurada de detalhes geom\u00e9tricos. A possibi-\n\nlidade de considerar malhas com elementos de diferentes topologias e de\n\nrefinar facilmente nos locais de maior interesse, tornam as malhas n\u00e3o-\n\nestruturadas h\u00edbridas uma excelente alternativa para a aproxima\u00e7\u00e3o da\n\ngeometria dos reservat\u00f3rios. Como visto ao longo deste trabalho, m\u00e9todos\n\nde volumes finitos baseados em elementos s\u00e3o uma op\u00e7\u00e3o que oferece\n\nm\u00faltiplas vantagens. Al\u00e9m de permitir a utiliza\u00e7\u00e3o de elementos de dife-\n\nrente topologia de modo unificado e simples em uma mesma formula\u00e7\u00e3o,\n\ngarante a conserva\u00e7\u00e3o no n\u00edvel discreto, tanto global como localmente,\n\ncomo todo m\u00e9todo de volumes finitos. A aproxima\u00e7\u00e3o consistente dos\n\nfluxos para tensores permeabilidade completos, um problema de longa\n\n\n\nCO NCLU S\u00c3O 155\n\ndata na simula\u00e7\u00e3o de reservat\u00f3rios com malhas convencionais, \u00e9 uma ca-\n\nracter\u00edstica intr\u00ednseca da forma do m\u00e9todo apresentada neste trabalho.\n\nCertamente a ado\u00e7\u00e3o de malhas n\u00e3o-estruturadas para a representa-\n\n\u00e7\u00e3o de reservat\u00f3rios de petr\u00f3leo ainda requer um longo processo de ade-\n\nqua\u00e7\u00e3o. O modelo f\u00edsico de um reservat\u00f3rio, que \u00e9 utilizado como base\n\npara a simula\u00e7\u00e3o dos escoamentos, \u00e9 resultado de um trabalho multidisci-\n\nplinar envolvendo uma s\u00e9rie de opera\u00e7\u00f5es para interpretar dados de campo\n\ne de laborat\u00f3rio. Muitos desses procedimentos est\u00e3o fortemente enrai-\n\nzados em representa\u00e7\u00f5es geom\u00e9tricas dos reservat\u00f3rios mediante malhas\n\ncartesianas ou corner point. Consequentemente, a adapta\u00e7\u00e3o a uma re-\n\npresenta\u00e7\u00e3o discreta com malhas n\u00e3o-estruturadas n\u00e3o envolve apenas a\n\nformula\u00e7\u00e3o num\u00e9rica para resolver os escoamentos, mas todo o conjunto\n\nde ferramentas computacionais empregadas na constru\u00e7\u00e3o do modelo f\u00ed-\n\nsico do reservat\u00f3rio.\n\nCom alguns desenvolvimentos complementares, contudo, seria poss\u00ed-\n\nvel viabilizar a ado\u00e7\u00e3o de malhas n\u00e3o-estruturadas em situa\u00e7\u00f5es particula-\n\nres. Esses desenvolvimentos poderiam incluir, por exemplo, procedimen-\n\ntos de upscaling para transferir a informa\u00e7\u00e3o referente \u00e0s propriedades\n\nf\u00edsicas em modelos convencionais para as malhas n\u00e3o-estruturadas. Al\u00e9m\n\ndisso, podem ser desenvolvidos procedimentos especiais de gera\u00e7\u00e3o de\n\nmalha para, apenas nas regi\u00f5es de maior interesse, substituir alguns blocos\n\nde uma malha convencional corner-point por por\u00e7\u00f5es mais refinadas de\n\nmalha n\u00e3o-estruturada que acompanhem a geometria de componentes\n\nimportantes do reservat\u00f3rio. Dessa forma, a maior parte do modelo f\u00edsico\n\nj\u00e1 existente para um reservat\u00f3rio poderia ser aproveitada e apenas nas\n\nregi\u00f5es discretizadas com malha n\u00e3o-estruturada seria necess\u00e1rio realizar\n\nupscaling das propriedades f\u00edsicas. O intuito, logicamente, seria incremen-\n\ntar a precis\u00e3o da simula\u00e7\u00e3o nessas regi\u00f5es de maior interesse.\n\nSeja qual for o cen\u00e1rio futuro para o uso de malhas n\u00e3o-estruturadas\n\nna simula\u00e7\u00e3o de reservat\u00f3rios, o presente trabalho tem procurado contri-\n\nbuir apresentando uma formula\u00e7\u00e3o num\u00e9rica apta para o uso dessas ma-\n\nlhas em problemas tridimensionais. Pelos motivos previamente expostos,\n\na formula\u00e7\u00e3o ser\u00e1 uma alternativa apropriada para ser adotada, quando as\n\ncondi\u00e7\u00f5es forem prop\u00edcias para a ado\u00e7\u00e3o de malhas n\u00e3o-estruturadas na\n\nsimula\u00e7\u00e3o de reservat\u00f3rios.\n\n\n\nRefer\u00eancias bibliogr\u00e1ficas\n\n[1] AAVATSMARK, I., KLAUSEN, R. A. Well index in reservoir simulation\nfor slanted and slightly curved wells in 3D grids. SPE Journal, v. 8, n. 1,\npp. 41\u201348, 2003.\n\n[2] ANSYS. Theory reference for ANSYS and ANSYS Workbench Release\n12.0. ANSYS Inc., Canonsburg, USA, 2009.\n\n[3] AZIZ, K., SETTARI, A. Petroleum reservoir simulation. Applied\nScience Publishers Ltd., London, England, 1979.\n\n[4] BARENBLATT, G. I., ENTOV, V. M., RYZHIK, V. M. Theory of fluid flow\nthrough natural rocks. Kluwer Academic Publishers, Dordrecht, The\nNetherlands, 1990.\n\n[5] BENNIS, C., BOROUCHAKI, H., FLANDRIN, N. 3D conforming power\ndiagrams for radial LGR in CPG reservoir grids. Engineering with\nComputers, v. 24, pp. 253\u2013265, 2008.\n\n[6] BERNDT, M., LIPNIKOV, K., MOULTON, J. D., SHASHKOV, M. Con-\nvergence of mimetic finite difference discretizations of the diffusion\nequation. East-west Journal of Numerical Mathematics, v. 9, n. 4,\npp. 253\u2013316, 2001.\n\n[7] BERTI, G. Generic software components for scientific computing.\nPh.D. Thesis, Faculty of Mathematics, Computer Science, and Natural\n\nScience, Cottbus, Germany, 2000.\n\n[8] BLAZEK, J. Computational fluid dynamics: principles and applicati-\nons. Elsevier Science Ltd., Oxford, UK, 2001.\n\n156\n\n\n\nR EFER \u00caNCIA S BIB LIO GR \u00c1F ICA S 157\n\n[9] CHEN, Z., HUAN, G., LI, B. An improved IMPES method for two-phase\nflow in porous media. Transport in Porous Media, v. 54, pp. 361\u2013376,\n2004.\n\n[10] CHEN, Z., HUAN, G., MA, Y. Computational methods for multiphase\nflows in porous media. Society for Industrial and Applied Mathematics,\nPhiladelphia, USA, 2006.\n\n[11] COATS, K. H. IMPES stability: selection of stable timesteps. SPE\nJournal, v. June 2003, pp. 181\u2013188, 2003.\n\n[12] CORDAZZO, J. Simula\u00e7\u00e3o de reservat\u00f3rios de petr\u00f3leo utilizando\no m\u00e9todo EbFVM e multigrid alg\u00e9brico. Tese de doutorado, De-\npartamento de Engenharia Mec\u00e2nica, Universidade Federal de Santa\n\nCatarina, Florian\u00f3polis, Brasil, 2006.\n\n[13] DING, Y., LEMONNIER, P. Use of corner point geometry in reservoir\nsimulation. In International Meeting on Petroleum Engineering , Beijing,\nChina, 1995.\n\n[14] DING, Y., RENARD, G., WEILL, L. Representation of wells in nume-\nrical reservoir simulation. SPE Reservoir Evaluation &amp; Engineering , v.\nFebruary 1998, pp. 18\u201323, 1998.\n\n[15] DOUGLASS, R. W., CAREY, G. F., WHITE, D. R., HANSEN, G. A., KAL-\nLINDERIS, Y., WEATHERILL, N. P. Current views on grid generation:\nsummaries of a panel discussion. Numerical Heat Transfer, Part B, v.\n41, pp. 211\u2013237, 2002.\n\n[16] DULLIEN, F. A. L. Porous media fluid transport and pore structure.\nAcademic Press Inc., London, England, 1979.\n\n[17] DURLOFSKY, L. J. A triangle based mixed finite element - finite vo-\nlume technique for modeling two phase flow through porous media.\nJournal of Computational Physics, v. 105, pp. 252\u2013266, 1993.\n\n[18] ELIAS, S. R., STUBLEY, G. D., RAITHBY, G. D. An adaptive agglo-\nmeration method for the additive correction multigrid. International\nJournal for Numerical Methods in Engineering , v. 40, pp. 887\u2013903, 1997.\n\n\n\nR EFER \u00caNCIA S BIB LIO GR \u00c1F ICA S 158\n\n[19] FARMER, C. L. Geological modelling and reservoir simulation. In\nISKE, A., RANDEN, T., editors, Mathematical methods and modeling\n\nin hydrocarbon exploration and production. Springer-Verlag, Berlin,\n\nGermany, 2005.\n\n[20] FERZIGER, J. H., PERIC?, M. Computational methods for fluid dyna-\nmics, third edition. Springer-Verlag, Berlin, Germany, 2002.\n\n[21] FLANDRIN, N., BOROUCHAKI, H., BENNIS, C. 3D hybrid mesh ge-\nneration for reservoir simulation. International Journal for Numerical\nMethods in Engineering , v. 65, n. 10, pp. 1639\u20131672, 2005.\n\n[22] FORSYTH, P. A. A control-volume, finite-element method for local\nmesh refinement in thermal reservoir simulation. SPE Reservoir Engi-\nneering , v. November 1990, pp. 561\u2013566, 1990.\n\n[23] FREY, P. J., GEORGE, P. L. Mesh generation: application to finite\nelements. Hermes Science Publications, Paris, France, 2000.\n\n[24] FROLKOVIC, P., SCHEPPER, H. Numerical modelling of convection\ndominated transport coupled with density driven flow in porous me-\ndia. Advances in Water Resources, v. 24, n. 1, pp. 63\u201372, 2000.\n\n[25] FU, Y., YANG, Y. K., DEO, M. Three-dimensional, three-phase\ndiscrete-fracture reservoir simulator based on control volume finite\nelement formulation. In SPE Reservoir Simulation Symposium, Hous-\nton, USA, 2005.\n\n[26] FUNG, L. S. K., HIEBERT, A. D., NGHIEM, L. X. Reservoir simulation\nwith a control-volume finite-element method. SPE Reservoir Enginee-\nring , v. August 1992, pp. 349\u2013357, 1992.\n\n[27] FUNG, L. S. K., BUCHANAN, L., SHARMA, R. Hybrid-CVFE method\nfor flexible-grid reservoir simulation. SPE Reservoir Engineering , v.\nAugust 1994, pp. 188\u2013194, 1994.\n\n[28] GEIGER, S., ROBERTS, S., MATTH\u00c4I, S. K., ZOPPOU, C., BURRI, A.\nCombining finite element and finite volume methods for efficient\nmultiphase flow simulations in highly heterogeneous and structurally\ncomplex geologic media. Geofluids, v. 4, pp. 284\u2013299, 2004.\n\n\n\nR EFER \u00caNCIA S BIB LIO GR \u00c1F ICA S 159\n\n[29] HEINEMANN, G. F., HEINEMANN, Z. E. Gridding concept for the\nthird generation of reservoir simulators. In 6th International Forum\non Reservoir Simulation, Schloss Fuschl, Austria, 2001.\n\n[30] HEINEMANN, Z. E., BRAND, C. W., MUNKA, M., CHEN, Y. M. Mode-\nling reservoir geometry with irregular grids. SPE Reservoir Engineering ,\nv. May 1991, pp. 225\u2013232, 1991.\n\n[31] HERBIN, R., HUBERT, F. Benchmark on the discretization schemes\nfor anisotropic diffusion problems on general grids. In 5th Internati-\nonal Symposium on Finite Volumes for Complex Applications, Aussois,\n\nFrance, 2008.\n\n[32] HERMELINE, F. A finite volume method for approximating 3D\ndiffusion operators on general meshes. Journal of Computational\nPhysics, v. 228, pp. 5763\u20135786, 2009.\n\n[33] HOTEIT, H., FIROOZABADI, A. An efficient numerical model for\nincompressible two-phase flow in fractured media. Advances in Water\nResources, v. 31, pp. 891\u2013905, 2008.\n\n[34] HUBER, R., HELMIG, R. Node-centered finite volume discretizations\nfor the numerical simulation of multiphase flow in heterogeneous\nporous media. Computational Geosciences, v. 4, pp. 141\u2013164, 2000.\n\n[35] HUGHES, T. J. R. The finite element method. Prentice-Hall, Inc., New\nJersey, USA, 1987.\n\n[36] HURTADO, F. S. V., MALISKA, C. R., SILVA, A. F. C. A variable timestep\nstrategy for accelerating the IMPES solution algorithm in reservoir si-\nmulation. In XXVII Iberian Latin American Congress on Computational\nMethods in Engineering \u2013 CILAMCE 2006, Bel\u00e9m, Brazil, 2006.\n\n[37] HURTADO, F. S. V., MALISKA, C. R., SILVA, A. F. C. On the factors\ninfluencing the grid orientation effect in reservoir simulation. In\n19th International Congress of Mechanical Engineering \u2013 COBEM 2007 ,\n\nBrasilia, Brazil, 2007.\n\n[38] HURTADO, F. S. V., MALISKA, C. R., SILVA, A. F. C., CORDAZZO,\nJ. A quadrilateral element-based finite-volume formulation for the\n\n\n\nR EFER \u00caNCIA S BIB LIO GR \u00c1F ICA S 160\n\nsimulation of complex reservoirs. In X Latin American and Caribbean\nPetroleum Engineering Conference \u2013 LACPEC 2007 , Buenos Aires, Argen-\n\ntina, 2007.\n\n[39] HUTCHINSON, B. R., RAITHBY, G. D. A multigrid method based on\nthe additive correction strategy. Numerical Heat Transfer, v. 9, pp. 511\u2013\n537, 1986.\n\n[40] KAPLAN, M. A., POPETTI, R. A. A note on quadrilateral interpola-\ntion. Journal of the Association for Computing Machinery, v. 18, n. 4,\npp. 576\u2013585, 1971.\n\n[41] KOZDON, J., MALLISON, B. T., GERRITSEN, M. G. Robust multi-D\ntransport schemes with reduced grid orientation effects. Transport in\nPorous Media, v. 78, pp. 47\u201375, 2009.\n\n[42] KUZMIN, D., M\u00d6LLER, M. Algebraic flux correction I: Scalar con-\nservation laws. In KUZMIN, D., L\u00d6HNER, R., TUREK, S., editors, Flux-\ncorrected transport: Principles algorithms and applications. Springer-\n\nVerlag, Berlin, Germany, 2005.\n\n[43] KWOK, W., CHEN, Z. A simple and effective mesh quality metric for\nhexaedral and wedge elements. In Proceedings of the 9th International\nMeshing Roundtable, p. 325\u2013333, New Orleans, USA, 2000.\n\n[44] LEVEQUE, R. J. Finite volume methods for hyperbolic problems.\nCambridge University Press, Cambridge, UK, 2002.\n\n[45] MALISKA, C. R. Transfer\u00eancia de calor e mec\u00e2nica dos fluidos\ncomputacional, segunda edi\u00e7\u00e3o. LTC Editora S.A., Rio de Janeiro, Brasil,\n2004.\n\n[46] MALISKA, C. R., HURTADO, F. S. V., DONATTI, C. N., PESCADOR, A.\nV. B., SILVA, A. F. C. Desenvolvimento da biblioteca ACMLib \u2013 Conclu-\ns\u00e3o. Relat\u00f3rio t\u00e9cnico SIGER\u20134, parte 2, Laborat\u00f3rio SINMEC/UFSC,\nFlorian\u00f3polis, Brasil, 2009.\n\n[47] MALISKA, C. R., HURTADO, F. S. V., DONATTI, C. N., PESCADOR, A.\nV. B., SILVA, A. F. C. Desenvolvimento da biblioteca EFVLib \u2013 Conclu-\ns\u00e3o. Relat\u00f3rio t\u00e9cnico SIGER\u20134, parte 1, Laborat\u00f3rio SINMEC/UFSC,\nFlorian\u00f3polis, Brasil, 2009.\n\n\n\nR EFER \u00caNCIA S BIB LIO GR \u00c1F ICA S 161\n\n[48] MARCONDES, F. Solu\u00e7\u00e3o num\u00e9rica usando m\u00e9todos adaptativos-\nimpl\u00edcitos e malha de Voronoi de problemas de reservat\u00f3rios de pe-\ntr\u00f3leo. Tese de doutorado, Departamento de Engenharia Mec\u00e2nica,\nUniversidade Federal de Santa Catarina, Florian\u00f3polis, Brasil, 1996.\n\n[49] MATTAX, C. C., DALTON, R. L. Reservoir simulation. Society of\nPetroleum Engineers Inc., Richardson, USA, 1990.\n\n[50] MATTH\u00c4I, S. K., MAZENTEV, A., BELAYNEH, M. Control-volume\nfinite-element two-phase flow experiments with fractured rock repre-\nsented by unstructured 3D hybrid meshes. In SPE Reservoir Simulation\nSymposium, Houston, USA, 2005.\n\n[51] MATTIUSSI, C. A reference discretization strategy for the numerical\nsolution of physical field problems. Advances in Imaging and Electron\nPhysics, v. 121, pp. 143\u2013279, 2002.\n\n[52] MIN, W. Generating hexahedron-dominant mesh based on shrink-\ning mapping method. In 6th International Meshing Roundtable, p. 171\u2013\n182, Park City, USA, 1997.\n\n[53] MONTEAGUDO, J. E. P., FIROOZABADI, A. Control-volume model\nfor simulation of water injection in fractured media: Incorporating\nmatrix heterogeneity and reservoir wettability effects. SPE Journal, v.\nSeptember 2007, pp. 355\u2013366, 2007.\n\n[54] MORITA, N., SINGH, S. P., CHEN, H. S., WHITFILL, D. L. Three-\ndimensional well model pre-processors for reservoir simulation with\nhorizontal and curved inclined wells. In 65th Annual Technical Confe-\nrence and Exhibition of the SPE, New Orleans, USA, 1990.\n\n[55] MOUTON, T., BENNIS, C., BOROUCHAKI, H. Hybrid mesh genera-\ntion for reservoir flow simulation in CPG grids. In CLARK, B. W., editor,\nProceedings of the 18th International Meshing Roundtable, pp. 415\u2013427.\n\nSpringer-Verlag, 2009.\n\n[56] OUYANG, L. B., ARBABI, S., AZIZ, K. A single-phase wellbore-flow\nmodel for horizontal, vertical, and slanted wells. SPE Journal, v. June\n1998, pp. 124\u2013133, 1998.\n\n\n\nR EFER \u00caNCIA S BIB LIO GR \u00c1F ICA S 162\n\n[57] OWEN, J. O. A survey of unstructured mesh generation technology.\nIn 7th International Meshing Roundtable, Dearborn, USA, 1998.\n\n[58] PALUSZNY, A., MATTH\u00c4I, S. K., HOHMEYER, M. Hybrid finite\nelement-finite volume discretization of complex geologic structures\nand a new simulation workflow demonstrated on fractured rocks.\nGeofluids, v. 7, pp. 186\u2013208, 2007.\n\n[59] PATANKAR, S. V. Numerical heat transfer and fluid flow. Hemisphere\nPublishing Corporation, New York, USA, 1980.\n\n[60] PEACEMAN, D. W. Fundamentals of numerical reservoir simulation.\nElsevier Scientific Publishing Company, Amsterdam, The Netherlands,\n\n1977.\n\n[61] PEACEMAN, D. W. Interpretation of well-block pressures in nume-\nrical reservoir simulation. SPE Journal, v. June 1978, pp. 183\u2013194, 1978.\n\n[62] PEACEMAN, D. W. Interpretation of well-block pressures in nume-\nrical reservoir simulation with nonsquare grid blocks and anisotropic\npermeability. SPE Journal, v. June 1983, pp. 531\u2013543, 1983.\n\n[63] PEACEMAN, D. W. Representation of a horizontal well in numerical\nreservoir simulation. SPE Advanced Technology Series, v. 1, n. 1, pp. 7\u2013\n16, 1993.\n\n[64] PEACEMAN, D. W. A new method for calculating well indexes\nfor multiple wellblocks with arbitrary rates in numerical reservoir\nsimulation. In SPE Reservoir Simulation Symposium, Houston, USA,\n2003.\n\n[65] PEDROSA, O. A., AZIZ, K. Use of a hybrid grid in reservoir simulation.\nSPE Reservoir Engineering , v. November 1986, pp. 611\u2013621, 1986.\n\n[66] POTEMPA, T. Mobility weighting in numerical reservoir simulation.\nSPE Journal, v. August 1985, pp. 565\u2013572, 1985.\n\n[67] RAW, M. A new control-volume based finite element procedure for\nthe numerical solution of the fluid flow and scalar transport equati-\nons. PhD Thesis, University of Waterloo, Canada, 1985.\n\n\n\nR EFER \u00caNCIA S BIB LIO GR \u00c1F ICA S 163\n\n[68] REICHENBERGER, V., JAKOBS, H., BASTIAN, P., HELMIG, R. A mixed-\ndimensional finite volume method for two-phase flow in fractured\nporous media. Advances in Water Resources, v. 29, n. 7, pp. 1020\u20131036,\n2006.\n\n[69] ROE, P. L., SIDILKOVER, D. Optimum positive linear schemes for\nadvection in two and three dimensions. SIAM Journal of Numerical\nAnalysis, v. 29, n. 6, pp. 1542\u20131568, 1992.\n\n[70] ROZON, B. J. A generalized finite volume discretization method for\nreservoir simulation. In Reservoir Simulation Symposium, Houston,\nUSA, 1989.\n\n[71] SAAD, Y. Iterative methods for sparse linear systems, second edition.\nSociety for Industrial and Applied Mathematics, Philadelphia, USA,\n\n2003.\n\n[72] SALARI, K., KNUPP, P. Code verification by the method of manu-\nfactured solutions. Technical report SAND2000\u20131444, Sandia National\nLaboratories, Albuquerque, USA, 2000.\n\n[73] SHAW, J. A. Hybrid grids. In THOMPSON, J. F., SONI, B. K.,\nWEATHERILL, N. P., editors, Handbook of grid generation, ch. 23. CRC\n\nPress, Boca Raton, USA, 1999.\n\n[74] SHIMADA, K. Current trends and issues in automatic mesh gene-\nration. Computer-Aided Design &amp; Applications, v. 3, n. 6, pp. 741\u2013750,\n2006.\n\n[75] THOMPSON, J. F., SONI, B. K., WEATHERILL, N. P., editors. Handbook\nof grid generation. CRC Press, Boca Raton, USA, 1999.\n\n[76] TONTI, E. A direct discrete formulation for the wave equation.\nJournal of Computational Acoustics, v. 9, n. 4, pp. 1355\u20131382, 2001.\n\n[77] TONTI, E. A direct discrete formulation of field laws: the Cell\nmethod. Computer Modeling in Engineering &amp; Sciences, v. 2, n. 2,\npp. 237\u2013258, 2001.\n\n[78] VAN LEER, B. Upwind and high-resolution methods for compressi-\nble flow: from donor cell to residual-distribution schemes. Communi-\ncations in Computational Physics, v. 1, n. 2, pp. 192\u2013206, 2006.\n\n\n\nR EFER \u00caNCIA S BIB LIO GR \u00c1F ICA S 164\n\n[79] VERMA, S. K. Flexible grids for reservoir simulation. PhD Disser-\ntation, Department of Petroleum Engineering, Stanford University, Palo\n\nAlto, USA, 1996.\n\n[80] VINSOME, P. K., AU, A. D. K. One approach to the grid orientation\nproblem in reservoir simulation. In 54th Annual Fall Technical Confe-\nrence and Exhibition of the SPE, Las Vegas, USA, 1979.\n\n[81] WADA, Y., YOSHIMURA, S., YAGAWA, G. Automatic mesh generation\nof hexahedral elements using intelligent local approach. Annual\nreport ADV 99\u20131, School of Engineering, University of Tokio, Japan, 1999.\n\n[82] WEISSTEIN, E. W. Concise encyclopedia of mathematics. CRC Press,\nBoca Raton, USA, 1999.\n\n[83] ZGAINSKI, F. X., COULOMB, J. L., MAR\u00c9CHAL, Y., CLAEYSSEN, F.,\nBRUNOTTE, X. A new family of finite elements: the pyramidal ele-\nments. IEEE Transactions on Magnetics, v. 32, n. 3, pp. 1393\u20131396, 1996.\n\n[84] ZIENKIEWICZ, O. C., TAYLOR, R. L. The finite element method,\nVolume 1: the basis, fifth edition. Butterworth-Heinemann, Oxford, UK,\n2000.\n\n[85] ZOPPOU, C., ROBERTS, S. Behaviour of finite difference solution\nof the advection equation. Technical report MRR 062\u201396, School\nof Mathematical Sciences, Australian National University, Camberra,\n\nAustralia, 1996.\n\n\n\nAP\u00caNDICE\n\nA\nPar\u00e2metros geom\u00e9tricos\n\nA.1 Determina\u00e7\u00e3o do vetor \u00e1rea de face\nUm dos par\u00e2metros geom\u00e9tricos mais importantes em um m\u00e9todo de vo-\n\nlumes finitos \u00e9 a \u00e1rea das faces que limitam os volumes de controle. No\n\nm\u00e9todo de volumes finitos baseado em elementos considerado, as faces\n\ns\u00e3o quadril\u00e1teros ou tri\u00e2ngulos localizados no interior dos elementos. A\n\nseguir \u00e9 descrito o procedimento para a determina\u00e7\u00e3o do vetor \u00e1rea das\n\nfaces quadrilaterais.\n\nA figura A.1(a) mostra uma face quadrangular convexa, cujos v\u00e9rtices\n\nC, L, M e R podem ser n\u00e3o-coplanares no espa\u00e7o f\u00edsico. A face pode ser\n\nmapeada em um quadrado unit\u00e1rio plano, mostrado na figura A.1(b), me-\n\ndiante a transforma\u00e7\u00e3o de coordenadas\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nx =\n4\n?\n\nk=1\n\nNk (?,?) x k ,\n\ny =\n4\n?\n\nk=1\n\nNk (?,?) yk ,\n\nz =\n4\n?\n\nk=1\n\nNk (?,?) z k .\n\n(A.1)\n\n165\n\n\n\nPA R \u00c2 M ET RO S G EO M \u00c9T R ICO S 166\n\nC\n\nC\n\nL\n\nL\nR\n\nR\n\nM\n\nM\nFace f\n\n(a) (b)\nz\n\nx y\nFigura A.1 \u2013 Transforma\u00e7\u00e3o de coordenadas para o c\u00f4mputo do vetor \u00e1rea\n\nde uma face quadrangular.\n\nNa transforma\u00e7\u00e3o da equa\u00e7\u00e3o (A.1) s\u00e3o consideradas as fun\u00e7\u00f5es de\n\nforma bilineares\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\n?\n\nN1(?,?) = (1??) (1??),\n\nN2(?,?) = ? (1??),\n\nN3(?,?) = ??,\n\nN4(?,?) = (1??)?.\n\n(A.2)\n\nAl\u00e9m disso, na equa\u00e7\u00e3o (A.1), x k , yk e z k , k ? {1, 2, 3, 4}, s\u00e3o as coor-\ndenadas dos v\u00e9rtices da face no espa\u00e7o f\u00edsico. Convencionalmente, ape-\n\nnas para uso na equa\u00e7\u00e3o (A.1), considera-se a seguinte equival\u00eancia entre\n\na numera\u00e7\u00e3o dos v\u00e9rtices e a nota\u00e7\u00e3o indicada para eles na figura A.1:\n\n{C, L, M, R} ? {1, 2, 3, 4}. Para a orienta\u00e7\u00e3o absoluta do vetor \u00e1rea de face\ncoincidir com a orienta\u00e7\u00e3o da aresta associada, como definido na se\u00e7\u00e3o\n\n3.4.2, os v\u00e9rtices da face devem ser ordenados de acordo a regra da m\u00e3o di-\n\nreita. Isto \u00e9, quando o polegar da m\u00e3o direita apontar no sentido atribu\u00eddo\n\n\u00e0 aresta, os outros dedos indicar\u00e3o o sentido na ordena\u00e7\u00e3o dos v\u00e9rtices.\n\nConsiderando a transforma\u00e7\u00e3o bilinear definida, o vetor \u00e1rea de face\n\npode ser determinado mediante integra\u00e7\u00e3o no plano transformado, em-\n\npregando a express\u00e3o seguinte [82]\n\n?Sf =\n\n? 1\n\n0\n\n? 1\n\n0\n\n??r \u00d7??r d? d?, (A.3)\n\nem que r = x ux + y uy + z uz \u00e9 o vetor posi\u00e7\u00e3o de um ponto pertencente\nao quadril\u00e1tero, no espa\u00e7o f\u00edsico. Os vetores ??r e ??r s\u00e3o tangentes \u00e0 su-\n\n\n\nPA R \u00c2 M ET RO S G EO M \u00c9T R ICO S 167\n\nperf\u00edcie da face no ponto correspondente e, portanto, ??r \u00d7??r \u00e9 um vetor\nnormal \u00e0 face. Al\u00e9m disso, o m\u00f3dulo desse produto \u00e9 um fator de escala\n\nentre as \u00e1reas de elementos diferenciais sobre a superf\u00edcie, no espa\u00e7o f\u00edsico\n\ne no plano transformado.\n\nRealizando a integra\u00e7\u00e3o indicada na equa\u00e7\u00e3o (A.3), obt\u00e9m-se a se-\n\nguinte express\u00e3o para o c\u00f4mputo do vetor \u00e1rea de uma face\n\n?Sf =\n1\n2\n\n?\n\n(y C ?y M)(z L ?z R)?(y L ?y R)(z C ?z M)\n?\n\nux +\n1\n2\n[(z C ?z M)(x L ?x R)?(z L ?z R)(x C ?x M)]uy +\n\n1\n2\n\n?\n\n(x C ?x M)(y L ?y R)?(x L ?x R)(y C ?y M)\n?\n\nuz .\n\n(A.4)\n\nEsta express\u00e3o \u00e9 v\u00e1lida para quadril\u00e1teros planos e n\u00e3o-planos. O\n\nm\u00f3dulo do vetor \u00e9 numericamente igual \u00e0 \u00e1rea do quadril\u00e1tero definido\n\npelos quatro v\u00e9rtices. No caso dos v\u00e9rtices n\u00e3o se encontrarem em um\n\nmesmo plano, a \u00e1rea corresponde a uma por\u00e7\u00e3o do hiperboloide de uma\n\nfolha [40], definido pela transforma\u00e7\u00e3o bilinear (A.1). Para uma face plana,\n?Sf \u00e9 perpendicular ao plano da face. Para uma face n\u00e3o-plana, a dire\u00e7\u00e3o\nde ?Sf \u00e9 a dire\u00e7\u00e3o m\u00e9dia das normais \u00e0 superf\u00edcie da face.\n\n\u00c9 interessante notar que a equa\u00e7\u00e3o (A.4) pode ser escrita na forma\n\ncompacta\n?Sf =\n\n1\n2\n\n??\nCM\u00d7??LR . (A.5)\n\nonde\n??\nCM e\n\n??\nLR s\u00e3o vetores coincidentes com as diagonais da face quadran-\n\ngular.\n\nOutro fato a destacar \u00e9 que a aproxima\u00e7\u00e3o num\u00e9rica da integral da\n\nequa\u00e7\u00e3o (A.3) pela quadratura de Gauss [84] com um \u00fanico ponto, isto \u00e9,\n? 1\n\n0\n\n? 1\n\n0\n\n??r \u00d7??r d? d? ?\n?\n\n??r \u00d7??r\n?\n\n?= 1\n2\n\n,?= 1\n2\n\n, (A.6)\n\nconduz \u00e0 express\u00e3o exata para o vetor ?Sf , dada na equa\u00e7\u00e3o (A.4). A\nquadratura de Gauss de um ponto \u00e9 equivalente \u00e0 regra do ponto m\u00e9dio\n\n[20], mencionada na se\u00e7\u00e3o 3.4.2.\nA equa\u00e7\u00e3o (A.4) pode ser empregada em todas as faces quadrangula-\n\nres, inclusive as da pir\u00e2mide.1 J\u00e1 o vetor \u00e1rea para as faces triangulares\n\ndesse elemento pode ser determinado mediante o m\u00e9todo convencional\n\n1 Para manter consist\u00eancia com a nota\u00e7\u00e3o empregada na se\u00e7\u00e3o 3.4.2, para as faces da\npir\u00e2mide o \u00edndice C deve ser substitu\u00eddo pelo \u00edndice B na equa\u00e7\u00e3o (A.4).\n\n\n\nPA R \u00c2 M ET RO S G EO M \u00c9T R ICO S 168\n\ndo c\u00e1lculo da \u00e1rea de um tri\u00e2ngulo em tr\u00eas dimens\u00f5es. Assim, para a face\n\ntriangular de v\u00e9rtices B, L e M, o vetor \u00e1rea pode ser determinado pela\n\nexpress\u00e3o\n\n?Sf =\n1\n2\n\n??\nBL\u00d7??BM. (A.7)\n\nonde\n??\nBL e\n\n??\nBM s\u00e3o vetores coincidentes com dois lados da face triangular.\n\nA.2 Baricentro das faces\n\nNa se\u00e7\u00e3o 3.4.2 foi vista a aproxima\u00e7\u00e3o num\u00e9rica de integrais de superf\u00edcie.\n\nUma integral desse tipo, restrita \u00e0 superf\u00edcie de em uma face, pode ser ex-\n\npressa tamb\u00e9m considerando a transforma\u00e7\u00e3o bilinear definida na se\u00e7\u00e3o\n\nanterior. Dessa forma resulta\n\n?\n\nf\n\n? \u00b7 dS =\n? 1\n\n0\n\n? 1\n\n0\n\n? \u00b7 (??r \u00d7??r) d? d?. (A.8)\n\nO lado direito da equa\u00e7\u00e3o pode ser aproximado por uma quadratura\n\nde Gauss de um ponto, com o qual obt\u00e9m-se\n\n?\n\nf\n\n? \u00b7 dS ?\nh\n\n? \u00b7 (??r \u00d7??r)\ni\n\n?= 1\n2\n\n,?= 1\n2\n\n. (A.9)\n\nComo mencionado na se\u00e7\u00e3o anterior, a avalia\u00e7\u00e3o do produto ??r \u00d7??r\nno ponto m\u00e9dio de uma face quadrilateral conduz a express\u00e3o exata para\n\no vetor \u00e1rea. Logo, pode-se escrever\n\n?\n\nf\n\n? \u00b7 dS ? ?\n?\n\n?\n\n?= 1\n2\n\n,?= 1\n2\n\u00b7?Sf . (A.10)\n\nConsequentemente, a densidade de fluxo ? deve ser avaliada no ponto\ncujas coordenadas no plano transformado s\u00e3o ? = 1\n\n2\ne ?= 1\n\n2\n. Esse ponto\n\n\u00e9 o baricentro dos v\u00e9rtices da face, cuja posi\u00e7\u00e3o no espa\u00e7o f\u00edsico \u00e9 dada\n\npela m\u00e9dia aritm\u00e9tica das coordenadas dos v\u00e9rtices da face. A menos que\n\na face seja um ret\u00e2ngulo, a posi\u00e7\u00e3o do baricentro dos v\u00e9rtices ser\u00e1 diferente\n\nda posi\u00e7\u00e3o do baricentro da pr\u00f3pria superf\u00edcie da face. Entretanto, j\u00e1 que,\n\npelos argumentos pr\u00e9vios, a aproxima\u00e7\u00e3o num\u00e9rica de uma integral na\n\nface requer avaliar o integrando sempre no baricentro dos v\u00e9rtices da face,\n\n\n\nPA R \u00c2 M ET RO S G EO M \u00c9T R ICO S 169\n\npor simplicidade, esse ponto sempre \u00e9 referido neste trabalho como bari-\n\ncentro da face e denotado como ?f . As figuras A.2, A.3, A.4 e A.5 apresen-\ntam as coordenadas que determinam a posi\u00e7\u00e3o do baricentro das faces do\n\ntetraedro, do hexaedro, do prisma e da pir\u00e2mide, respectivamente. Essas\n\ncoordenadas est\u00e3o referidas ao sistema local definido em cada elemento.\n\n1 17/48 7/48 7/482 17/48 17/48 7/483 7/48 17/48 7/484 7/48 7/48 17/485 7/48 17/48 17/486 17/48 7/48 17/48\nFace\n\n2\n31\n\n4\n5 6\n\nFigura A.2 \u2013 Coordenadas locais dos baricentros das faces do tetraedro.\n\n1 1/2 1/4 1/42 3/4 1/2 1/43 1/2 3/4 1/44 1/4 1/2 1/45 1/2 1/4 3/46 3/4 1/2 3/47 1/2 3/4 3/48 1/4 1/2 3/49 1/4 1/4 1/210 3/4 1/4 1/211 3/4 3/4 1/212 1/4 3/4 1/2\n\nFace\n\n2 3\n\n9\n110 4\n5\n\n6\n11\n\n127\n8\n\nFigura A.3 \u2013 Coordenadas locais dos baricentros das faces do hexaedro.\n\n\n\nPA R \u00c2 M ET RO S G EO M \u00c9T R ICO S 170\n\n1 5/12 1/6 1/42 5/12 5/12 1/43 1/6 5/12 1/44 5/12 1/6 3/45 5/12 5/12 3/46 1/6 5/12 3/47 5/24 5/24 1/28 7/12 5/24 1/29 5/24 7/12 1/2\n\nFace\n\n7\n\n2\n3\n\n9\n1\n\n4 5 6\n\n8\n\nFigura A.4 \u2013 Coordenadas locais dos baricentros das faces do prisma.\n\n1 1/2 2/9 1/92 7/9 1/2 1/93 1/2 7/9 1/94 2/9 1/2 1/95 17/48 17/48 7/246 31/48 17/48 7/247 17/48 31/48 7/248 31/48 31/48 7/24\n\nFace\n7\n\n2 3\n1 4\n\n5\n6 8\n\nFigura A.5 \u2013 Coordenadas locais dos baricentros das faces da pir\u00e2mide.\n\nA.3 C\u00f4mputo do volume de um subelemento\nConforme visto na se\u00e7\u00e3o 3.4.1, o volume de um subelemento pode ser\n\ndeterminado mediante integra\u00e7\u00e3o no espa\u00e7o transformado, empregando\n\na express\u00e3o\n\n?Vs =\n\n?\n\ns\n\n|J| dV ??? . (A.11)\n\nNeste trabalho, o valor da integral foi computado por uma quadratura\n\nde Gauss de um ponto, isto \u00e9\n\n?Vs ? |J|?s ?V\n???\n\ns , (A.12)\n\n\n\nPA R \u00c2 M ET RO S G EO M \u00c9T R ICO S 171\n\nem que?s \u00e9 o baricentro dos v\u00e9rtices do subelemento e ?V\n???\n\ns \u00e9 seu volume\n\nno espa\u00e7o transformado. A equa\u00e7\u00e3o (A.12) fornece um valor exato para os\n\nsubelementos do tetraedro e aproximado para outros elementos.\n\nPara utiliza\u00e7\u00e3o na equa\u00e7\u00e3o (A.12), as coordenadas locais dos baricen-\n\ntros dos subelementos, al\u00e9m dos volumes no espa\u00e7o transformado, s\u00e3o\n\nindicados nas figuras A.6, A.7, A.8 e A.9, respectivamente, para o tetraedro,\n\no hexaedro, o prisma e a pir\u00e2mide.\n\n1 17/96 17/96 17/96 1/242 15/32 17/96 17/96 1/243 17/96 15/32 17/96 1/244 17/96 17/96 15/32 1/24\nSubel.\n\n2 31\n4\n\nFigura A.6 \u2013 Coordenadas locais dos baricentros e volume dos subelemen-\ntos do tetraedro.\n\n1 1/4 1/4 1/4 1/82 3/4 1/4 1/4 1/83 3/4 3/4 1/4 1/84 1/4 3/4 1/4 1/85 1/4 1/4 3/4 1/86 3/4 1/4 3/4 1/87 3/4 3/4 3/4 1/88 1/4 3/4 3/4 1/8\n\nSubel.\n\n2 3\n1 4\n\n5\n6 7\n\n8\n\nFigura A.7 \u2013 Coordenadas locais dos baricentros e volume dos subelemen-\ntos do hexaedro.\n\n\n\nPA R \u00c2 M ET RO S G EO M \u00c9T R ICO S 172\n\n2 3\n1\n4\n\n5 6 1 5/24 5/24 1/4 1/122 11/24 5/24 1/4 1/123 5/24 11/24 1/4 1/124 5/24 5/24 3/4 1/125 11/24 5/24 3/4 1/126 5/24 11/24 3/4 1/12\n\nSubel.\n\nFigura A.8 \u2013 Coordenadas locais dos baricentros e volume dos subelemen-\ntos do prisma.\n\n2 3\n4\n\n5 1 29/96 29/96 7/48 1/182 67/96 29/96 7/48 1/183 67/96 67/96 7/48 1/184 29/96 67/96 7/48 1/185 1/2 1/2 13/24 1/9\n\nSubel.\n\n1\n\nFigura A.9 \u2013 Coordenadas locais dos baricentros e volume dos subelemen-\ntos da pir\u00e2mide."}]}}}