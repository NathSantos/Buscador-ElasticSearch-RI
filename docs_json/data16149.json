{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.20260"}, {"@name": "filename", "#text": "3731_212915.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "VALDEMAR ANTONIO DALLAGNOL FILHO\n\nIdentificac?a?o de modelos ARMAX e NARMAX\n\npara um poc?o de petro?leo operando por injec?a?o\n\ncont??nua de ga?s\n\nFLORIANO?POLIS\n\n2005\n\n\n\nUniversidade Federal de Santa Catarina\n\nPrograma de Po?s-Graduac?a?o\n\nem Engenharia Ele?trica\n\nIdentificac?a?o de modelos ARMAX e\n\nNARMAX para um poc?o de petro?leo\n\noperando por injec?a?o cont??nua de ga?s\n\nDissertac?a?o submetida a?\n\nUniversidade Federal de Santa Catarina\n\ncomo parte dos requisitos para a\n\nobtenc?a?o do grau de Mestre em Engenharia Ele?trica\n\nValdemar Antonio Dallagnol Filho\n\nFloriano?polis, fevereiro de 2005.\n\n\n\nIdentificac?a?o de modelos ARMAX e NARMAX\n\npara um poc?o de petro?leo operando por injec?a?o\n\ncont??nua de ga?s\n\nValdemar Antonio Dallagnol Filho\n\nEsta Dissertac?a?o foi julgada adequada para obtenc?a?o do T??tulo de Mestre em Enge-\n\nnharia Ele?trica, A?rea de Concentrac?a?o em Automac?a?o e Sistemas, e aprovada em sua\n\nforma final pelo Programa de Po?s-Graduac?a?o em Engenharia Ele?trica da Universidade\n\nFederal de Santa Catarina.\n\nFloriano?polis, 25 de Fevereiro de 2005.\n\nProf. Denizar Cruz Martins, Dr.\nCoordenador do Programa de Po?s-Graduac?a?o em Engenharia Ele?trica\n\nProf. Daniel Juan Pagano, Dr.\nOrientador\n\nProf. Edson Roberto de Pieri, Dr.\nCo-Orientador\n\nBanca Examinadora\n\nProf. Daniel Juan Pagano, Dr.\nPresidente da Banca\n\nProf. Eduardo Camponogara, Dr.\n\nProf. Julio Elias Normey Rico, Dr\n\nProf. Nestor Roqueiro, Dr.\n\n\n\n\u201cTudo o que voce? fizer sera? insignificante,\n\nmas e? muito importante que voce? o fac?a\u201d\n\nMahatma Gandhi\n\n\n\nAgradecimentos\n\nAo professor Daniel Juan Pagano, pela valiosa orientac?a?o e amizade.\n\nAo professor Edson Roberto De Pieri, pela coragem em me orientar a? dista?ncia\n\nnuma a?rea pouco explorada.\n\nA? minha fam??lia, pelo carinho, presenc?a constante e apoio irrestrito: Ma?e, Pai,\n\nLuciana, Paulo, Rodrigo e Lucas.\n\nA? Patr??cia Schaeffer, pelo carinho e incessante est??mulo.\n\nAo colega Agustinho Pluce?nio pela infinda?vel disposic?a?o em ajudar.\n\nAos membros da banca - Prof. Eduardo Camponogara, Prof. Julio Elias Normey\n\nRico e Prof. Nestor Roqueiro - por suas sugesto?es.\n\nA todos meus amigos, por fazerem parte da minha vida. Na?o me atrevo a cita?-los\n\nnominalmente para na?o correr o risco de injustamente deixar algue?m de fora.\n\nAo professor Luis Antonio Aguirre e ao engenheiro Ma?rcio Santos Barroso por\n\nprontamente terem disponibilizado rotinas de grande utilidade para este trabalho.\n\nA? empresa Scandpower por disponibilizar para a UFSC uma licenc?a acade?mica do\n\nsimulador OLGA 2000.\n\nAo CNPq pelo suporte financeiro.\n\nA? Age?ncia Nacional de Petro?leo - ANP, atrave?s do programa de Recursos Humanos\n\nda ANP para o setor de Petro?leo e Ga?s Natural - PRH34-ANP/MCT, pelo apoio\n\nfinanceiro.\n\niii\n\n\n\nResumo da Dissertac?a?o apresentada a? UFSC como parte dos requisitos necessa?rios\n\npara a obtenc?a?o do grau de Mestre em Engenharia Ele?trica.\n\nIdentificac?a?o de modelos ARMAX e NARMAX\npara um poc?o de petro?leo operando por injec?a?o\n\ncont??nua de ga?s\n\nValdemar Antonio Dallagnol Filho\n\nOrientador : Daniel Juan Pagano, Dr.\n\nCo-orientador : Edson Roberto De Pieri, Dr.\n\nA?rea : Automac?a?o e Sistemas\n\nPalavras-chave : Identificac?a?o de Sistemas, Sistemas Na?o-Lineares,\n\nModelos ARMAX, Modelos NARMAX, Produc?a?o de Petro?leo,\n\nElevac?a?o Artificial, Gas-Lift\n\nNu?mero de pa?ginas : 121\n\nNeste trabalho sa?o identificados modelos lineares do tipo ARMAX e na?o-lineares\n\ndo tipo NARMAX polinomial para a relac?a?o existente entre a vaza?o ma?ssica de ga?s\n\ninjetado e a pressa?o no tubo de produc?a?o de um poc?o de petro?leo operando por injec?a?o\n\ncont??nua de ga?s, simulado pelo software OLGA 2000. O objetivo e? fornecer um mo-\n\ndelo que seja u?til posteriormente para o projeto de um controlador que possibilite ao\n\npoc?o operar na regia?o de maior interesse econo?mico. A escolha do par de varia?veis de\n\nentrada e sa??da permitiu que a ana?lise do sistema fosse feita como sendo monovaria?vel,\n\nsendo controladores locais utilizados para as demais varia?veis do poc?o. Ale?m disso,\n\nas varia?veis de entrada e sa??da sa?o facilmente mensura?veis, ja? existindo toda a instru-\n\nmentac?a?o necessa?ria nos poc?os atuais, ao contra?rio de outras estrate?gias de controle\n\npara sistemas similares, encontradas na literatura.\n\nTre?s modelos do tipo ARMAX foram identificados em diferentes pontos de operac?a?o\n\ndentro da regia?o de interesse, demonstrando ter validade restrita a uma faixa muito\n\nestreita de operac?a?o, devido a? caracter??stica na?o-linear do poc?o. Dois modelos do tipo\n\nNARMAX polinomial foram enta?o obtidos, sendo o primeiro identificado com o uso de\n\numa entrada mais \u201cagressiva\u201d, que visa excitar toda a dina?mica na?o-linear do sistema.\n\nEssa entrada, no entanto, apresenta um maior risco a?s instalac?o?es devido a?s variac?o?es\n\n\n\nabruptas. O modelo identificado demonstrou ser va?lido para uma regia?o maior que\n\nos modelos lineares. O segundo modelo NARMAX foi identificado reaproveitando-se\n\nos dados usados para a identificac?a?o dos modelos lineares - mais \u201ccomportados\u201d e\n\nmais seguros para as instalac?o?es. Devido a na?o-linearidade existente na?o ser ta?o forte,\n\no uso de dados mais comportados mostrou ser suficiente para a identificac?a?o de um\n\nmodelo va?lido para toda a regia?o de operac?a?o. Entradas deste tipo possibilitam que a\n\nidentificac?a?o seja realizada sem grandes alterac?o?es na operac?a?o normal do poc?o real e\n\nque a realizac?a?o dos testes na?o cause perda de produc?a?o.\n\n\n\nAbstract of Dissertation presented to UFSC as a partial fulfillment of the refinements\n\nfor the degree of Master in Electrical Engineering.\n\nIdentification of ARMAX and NARMAX models\nfor an oil well operating by continuous gas-lift\n\nValdemar Antonio Dallagnol Filho\n\nAdvisor : Daniel Juan Pagano, Dr.\n\nCo-advisor : Edson Roberto De Pieri, Dr.\n\nArea : Automation and Systems\n\nKeywords : System Identification, Nonlinear Systems,\n\nARMAX Models, NARMAX Models, Oil Production,\n\nArtificial Lift, Gas-Lift\n\nNumber of pages : 121\n\nLinear ARMAX models and nonlinear polynomial NARMAX models are identified\n\nfor the relation between the mass flow of injected gas and pressure in the production\n\ntubing of an oil well operating with continuous gas-lift, simulated by the software\n\nOLGA 2000. The goal is to find a model that is useful for the design of a controller\n\nthat allows the operation of the well in the region of greater economic gains. The\n\nchoice of the input/output pair allowed the analysis of the system to be done as if it\n\nwere SISO, with local controllers used for the remaining variables of the well. Besides\n\nthat, the input and output variables are easily measurable, with all the instrumentation\n\nneeded already available in modern wells, unlike other control strategies proposed for\n\nsimilar systems, found in literature.\n\nThree ARMAX models were identified in different operating points inside the desi-\n\nred region, showing to be valid only in a small zone, due to the nonlinear characteristics\n\nof the well. Two polynomial NARMAX models were then identified, the first one iden-\n\ntified with the usage of an \u201caggressive\u201d input, which tries to excite all the nonlinear\n\ndynamics of the system. This input, however, offers a risk to the plant due to its abrupt\n\nshifts. The identified model was shown to be valid in a region larger than that for li-\n\nnear models. The second NARMAX model was identified reusing the data collected\n\nfor identifying linear models - more \u201cwell-behaved\u201d and safer for the plant. Because\n\n\n\nthe existent nonlinearity is not very strong, the use of the well-behaved data showed to\n\nbe enough to identify a model valid in all the operating region. These kind of inputs\n\nallow the identification to be done without great shifts in the normal operation of the\n\nwell and that the execution of the tests do not cause loss in production.\n\n\n\nSuma?rio\n\n1 Introduc?a?o 1\n\n2 Modelagem de Sistemas Dina?micos 4\n\n2.1 Introduc?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4\n\n2.2 Classificac?a?o de Modelos . . . . . . . . . . . . . . . . . . . . . . . . . . 6\n\n2.3 Representac?o?es Lineares . . . . . . . . . . . . . . . . . . . . . . . . . . 8\n\n2.3.1 Representac?a?o Geral Discreta . . . . . . . . . . . . . . . . . . . 8\n\n2.3.2 Modelos AR e ARX . . . . . . . . . . . . . . . . . . . . . . . . 9\n\n2.3.3 Modelos ARMA e ARMAX . . . . . . . . . . . . . . . . . . . . 9\n\n2.4 Representac?o?es na?o-Lineares e Modelos NARMAX . . . . . . . . . . . . 11\n\n3 Identificac?a?o de Sistemas 15\n\n3.1 Introduc?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15\n\n3.2 Etapas na identificac?a?o de Sistemas . . . . . . . . . . . . . . . . . . . . 16\n\n3.3 Func?o?es de Correlac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . 17\n\n3.4 Projeto do Sinal de Teste . . . . . . . . . . . . . . . . . . . . . . . . . . 18\n\n3.5 Determinac?a?o do per??odo de amostragem . . . . . . . . . . . . . . . . . 20\n\n3.6 Estimac?a?o de Para?metros . . . . . . . . . . . . . . . . . . . . . . . . . . 21\n\n3.6.1 O Estimador de M??nimos Quadrados (MQ) . . . . . . . . . . . . 21\n\nviii\n\n\n\n3.6.2 O Me?todo de MQ com Modelos Autoregressivos . . . . . . . . . 25\n\n3.6.3 Polarizac?a?o de Estimadores . . . . . . . . . . . . . . . . . . . . 27\n\n3.7 Crite?rios de Informac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . 28\n\n3.8 Ferramentas Utilizadas na Identificac?a?o de Sistemas na?o-Lineares . . . 30\n\n3.8.1 Algoritmos MQ Ortogonais . . . . . . . . . . . . . . . . . . . . 30\n\n3.8.2 A Taxa de Reduc?a?o de Erro . . . . . . . . . . . . . . . . . . . . 33\n\n3.8.3 Agrupamento de termos . . . . . . . . . . . . . . . . . . . . . . 36\n\n3.8.4 Caracter??stica esta?tica . . . . . . . . . . . . . . . . . . . . . . . 38\n\n3.9 Validac?a?o do Modelo . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38\n\n4 Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 42\n\n4.1 Introduc?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42\n\n4.2 Descric?a?o do Sistema . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43\n\n4.3 O simulador Olga . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58\n\n4.4 Identificac?a?o Linear . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60\n\n4.4.1 Identificac?a?o em torno de u=1.5 kg/s . . . . . . . . . . . . . . . 66\n\n4.4.2 Identificac?a?o em torno de u=2.15 kg/s . . . . . . . . . . . . . . 72\n\n4.4.3 Identificac?a?o em torno de u=2.8 kg/s . . . . . . . . . . . . . . . 75\n\n4.4.4 Comenta?rios sobre os modelos lineares identificados . . . . . . . 82\n\n4.5 Identificac?a?o na?o-Linear . . . . . . . . . . . . . . . . . . . . . . . . . . 88\n\n4.5.1 Identificac?a?o usando sinal de entrada \u201cagressivo\u201d . . . . . . . . 89\n\n4.5.2 Identificac?a?o usando sinal de entrada \u201ccomportado\u201d . . . . . . . 98\n\n4.6 Comparac?a?o entre os modelos identificados . . . . . . . . . . . . . . . . 106\n\n4.7 Comenta?rios ao controle do sistema . . . . . . . . . . . . . . . . . . . . 113\n\n5 Considerac?o?es Finais 116\n\n\n\nLista de Figuras\n\n3.1 Exemplo de res??duos na equac?a?o de uma reta . . . . . . . . . . . . . . . 24\n\n3.2 Validac?a?o atrave?s da simulac?a?o livre de um modelo . . . . . . . . . . . 40\n\n4.1 Curva IPR (Inflow Performance Relationship) t??pica para fluido subsa-\n\nturado . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44\n\n4.2 Poc?o morto . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45\n\n4.3 Esquema de um poc?o operando por elevac?a?o cont??nua de ga?s, destacando\n\nos principais equipamentos envolvidos . . . . . . . . . . . . . . . . . . . 46\n\n4.4 Curva da vaza?o de produc?a?o x vaza?o de injec?a?o, com a a?rea de maior\n\ninteresse econo?mico em destaque. . . . . . . . . . . . . . . . . . . . . . 48\n\n4.5 Estrutura do controlador de vaza?o ma?ssica de injec?a?o de ga?s . . . . . . 49\n\n4.6 Pontos de medic?a?o e atuac?a?o no poc?o de petro?leo, inicialmente utilizados 50\n\n4.7 Pressa?o no tubo de produc?a?o em func?a?o da vaza?o de injec?a?o de ga?s . . 51\n\n4.8 Pressa?o no fundo do poc?o em func?a?o da vaza?o de injec?a?o de ga?s . . . . 51\n\n4.9 Queda de pressa?o no choke de produc?a?o em func?a?o da vaza?o de injec?a?o\n\nde ga?s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52\n\n4.10 Quantidade de l??quido (produzido) na sa??da do sistema em func?a?o da\n\nvaza?o de injec?a?o de ga?s . . . . . . . . . . . . . . . . . . . . . . . . . . . 52\n\n4.11 Pontos de medic?a?o e atuac?a?o no poc?o de petro?leo . . . . . . . . . . . . 54\n\n4.12 Sequ?e?ncia de degraus de teste aplicada na entrada e sa??da do sistema,\n\nmostrando a na?o-linearidade do mesmo . . . . . . . . . . . . . . . . . . 55\n\nx\n\n\n\n4.13 Degrau mostrando a presenc?a de fase na?o-m??nima no sistema . . . . . . 56\n\n4.14 Pressa?o no tubo de produc?a?o em func?a?o da vaza?o de injec?a?o de ga?s para\n\nPh constante . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57\n\n4.15 Pressa?o no fundo do poc?o em func?a?o da vaza?o de injec?a?o de ga?s para Ph\n\nconstante . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57\n\n4.16 Quantidade de l??quido (produzido) na sa??da do sistema em func?a?o da\n\nvaza?o de injec?a?o de ga?s para Ph constante . . . . . . . . . . . . . . . . 58\n\n4.17 Geometria do sistema em ana?lise, implementado no OLGA . . . . . . . 60\n\n4.18 Sinal aplicado na entrada do sistema para realizar a identificac?a?o linear 61\n\n4.19 Sa??da do sistema para a identificac?a?o linear com a entrada em torno de\n\n1.5 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62\n\n4.20 Sa??da do sistema para a identificac?a?o linear com a entrada em torno de\n\n2.15 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62\n\n4.21 Sa??da do sistema para a identificac?a?o linear com a entrada em torno de\n\n2.8 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63\n\n4.22 Func?a?o de autocovaria?ncia linear usada para definir o fator de reamos-\n\ntragem adequado para o sinal de sa??da . . . . . . . . . . . . . . . . . . 64\n\n4.23 Sinal aplicado na entrada do sistema para validar a identificac?a?o linear 65\n\n4.24 Valor de AIC para modelos estimados em torno da entrada 1.5 kg/s . . 67\n\n4.25 Simulac?a?o livre do modelo ARX encontrado em torno da entrada 1.5 kg/s 68\n\n4.26 Diagrama de po?los e zeros do modelo ARX encontrado em torno da\n\nentrada 1.5 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69\n\n4.27 Autocorrelac?a?o dos res??duos do modelo ARX encontrado em torno da\n\nentrada 1.5 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70\n\n4.28 Autocorrelac?a?o dos res??duos do modelo ARMAX encontrado em torno\n\nda entrada 1.5 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71\n\n4.29 Simulac?a?o livre do modelo ARMAX encontrado em torno da entrada 1.5\n\nkg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72\n\n\n\n4.30 Diagrama de po?los e zeros do modelo ARMAX encontrado em torno da\n\nentrada 1.5 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73\n\n4.31 Valor de AIC para modelos estimados em torno da entrada 2.15 kg/s . 74\n\n4.32 Autocorrelac?a?o dos res??duos do modelo ARX encontrado em torno da\n\nentrada 2.15 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75\n\n4.33 Autocorrelac?a?o dos res??duos do modelo ARMAX encontrado em torno\n\nda entrada 2.15 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76\n\n4.34 Simulac?a?o livre do modelo ARMAX encontrado em torno da entrada\n\n2.15 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76\n\n4.35 Diagrama de po?los e zeros do modelo ARMAX encontrado em torno da\n\nentrada 2.15 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77\n\n4.36 Valor de AIC para modelos estimados em torno da entrada 2.8 kg/s . . 78\n\n4.37 Diagrama de po?los e zeros do modelo ARX encontrado em torno da\n\nentrada 2.8 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79\n\n4.38 Autocorrelac?a?o dos res??duos do modelo ARX encontrado em torno da\n\nentrada 2.8 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80\n\n4.39 Autocorrelac?a?o dos res??duos do modelo ARMAX encontrado em torno\n\nda entrada 2.8 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81\n\n4.40 Simulac?a?o livre do modelo ARMAX encontrado em torno da entrada 2.8\n\nkg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81\n\n4.41 Diagrama de po?los e zeros do modelo ARMAX encontrado em torno da\n\nentrada 2.8 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82\n\n4.42 Diagrama com os po?los e zeros de todos os tre?s modelos lineares encon-\n\ntrados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84\n\n4.43 Simulac?a?o livre do modelo ARMAX encontrado em torno da entrada 1.5\n\nkg/s com a amplitude da entrada de 0.6 kg/s . . . . . . . . . . . . . . . 86\n\n4.44 Simulac?a?o livre do modelo ARMAX encontrado em torno da entrada\n\n2.15 kg/s com a amplitude da entrada de 0.6 kg/s . . . . . . . . . . . . 86\n\n\n\n4.45 Simulac?a?o livre do modelo ARMAX encontrado em torno da entrada 2.8\n\nkg/s com a amplitude da entrada de 0.6 kg/s . . . . . . . . . . . . . . . 87\n\n4.46 Sa??da do modelo ARMAX encontrado em torno de 2.8 kg/s para um\n\ndegrau unita?rio aplicado na entrada . . . . . . . . . . . . . . . . . . . . 87\n\n4.47 Sinal de entrada do sistema (vaza?o de ga?s injetado) para estimac?a?o de\n\npara?metros do modelo na?o-linear . . . . . . . . . . . . . . . . . . . . . 90\n\n4.48 Pressa?o no tubo de produc?a?o (sa??da do sistema) para estimac?a?o de\n\npara?metros do modelo na?o-linear . . . . . . . . . . . . . . . . . . . . . 90\n\n4.49 Sinal de entrada do sistema (vaza?o de ga?s injetado) para validac?a?o do\n\nmodelo na?o-linear . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91\n\n4.50 Pressa?o no tubo de produc?a?o (sa??da do sistema) para validac?a?o do mo-\n\ndelo na?o-linear . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92\n\n4.51 Func?a?o de autocovaria?ncia normalizada - caso na?o-linear . . . . . . . . 93\n\n4.52 Coeficientes de agrupamento do modelo NARMAX obtido para o sistema\n\nexcitado com uma entrada \u201cagressiva\u201d . . . . . . . . . . . . . . . . . . 94\n\n4.53 Valor do AIC em func?a?o do nu?mero de para?metros para modelos NAR-\n\nMAX do sistema excitado por uma entrada agressiva . . . . . . . . . . 96\n\n4.54 Simulac?a?o livre do modelo NARMAX encontrado com o uso de uma\n\nentrada agressiva comparada com os dados de validac?a?o . . . . . . . . . 98\n\n4.55 Pontos fixos do modelo NARMAX identificado com a entrada agressiva 99\n\n4.56 Valor do AIC em func?a?o do nu?mero de para?metros para modelos NAR-\n\nMAX do sistema excitado por uma entrada comportada . . . . . . . . 102\n\n4.57 Simulac?a?o livre do modelo NARMAX encontrado com o uso de uma\n\nentrada comportada comparada com os dados de validac?a?o . . . . . . . 103\n\n4.58 Pontos fixos do modelo NARMAX identificado com a entrada comportada104\n\n4.59 Simulac?a?o livre dos modelos ARMAX L1.5 e L2.8 comparados com a\n\nsa??da real do sistema para uma entrada PRBS de amplitude 0.6 kg/s em\n\ntorno de 1.5 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107\n\n\n\n4.60 Simulac?a?o livre do modelo ARMAX L1.5 comparado com a sa??da real\n\ndo sistema para uma entrada PRBS de amplitude 0.6 kg/s em torno de\n\n2.8 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109\n\n4.61 Simulac?a?o livre do modelo NARMAX NLC comparado com a sa??da real\n\ndo sistema para uma entrada PRBS de amplitude 0.6 kg/s em torno de\n\n1.5 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110\n\n4.62 Simulac?a?o livre do modelo NARMAX NLA comparado com a sa??da real\n\ndo sistema para uma entrada PRBS de amplitude 0.6 kg/s em torno de\n\n1.5 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111\n\n4.63 Histograma de valores da entrada u(k) para a entrada agressiva e com-\n\nportada . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112\n\n4.64 Histograma de valores da sa??da y(k) para a entrada agressiva e comportada112\n\n\n\nLista de Tabelas\n\n4.1 Po?los, zeros e ganhos esta?ticos dos modelos lineares identificados . . . . 84\n\n4.2 Ajuste das curvas dos modelos lineares para diferentes amplitudes do\n\nsinal de entrada . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85\n\n4.3 Termos do modelo NARMAX identificado para uma entrada agressiva,\n\nem ordem do valor de ERR . . . . . . . . . . . . . . . . . . . . . . . . 95\n\n4.4 Termos do modelo NARMAX identificado para uma entrada agressiva,\n\nem ordem do valor de ERR, com todos os para?metros estatisticamente\n\nsignificativos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97\n\n4.5 Termos do modelo NARMAX identificado para uma entrada agressiva,\n\nem ordem do valor de ERR, para aplicac?a?o em controle preditivo . . . 100\n\n4.6 Termos do modelo NARMAX identificado para uma entrada compor-\n\ntada, em ordem do valor de ERR, com todos os para?metros estatistica-\n\nmente significativos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103\n\n4.7 Termos do modelo NARMAX identificado para uma entrada compor-\n\ntada, em ordem do valor de ERR, para aplicac?a?o em controle preditivo 105\n\n4.8 Modelos lineares e na?o-lineares identificados . . . . . . . . . . . . . . . 108\n\n4.9 Comparac?a?o do desempenho dos modelos, para entradas PRBS osci-\n\nlando em torno de uma entrada . . . . . . . . . . . . . . . . . . . . . . 109\n\nxv\n\n\n\nCap??tulo 1\n\nIntroduc?a?o\n\nE? inega?vel o quanto a sociedade atual depende do petro?leo. Na?o somente do petro?leo\n\ncomo fonte de energia, mas tambe?m dos produtos derivados dele, como por exemplo\n\nos pla?sticos, borrachas sinte?ticas, tintas, corantes, adesivos, solventes, detergentes, ex-\n\nplosivos, produtos farmace?uticos, cosme?ticos entre outros [37].\n\nConstitu??do basicamente de uma mistura de compostos qu??micos orga?nicos (hidro-\n\ncarbonetos), o petro?leo tem sido utilizado pelo ser humano desde a e?poca dos ba-\n\nbilo?nicos, que utilizavam o petro?leo para assentar tijolos, e dos fen??cios, que o usavam\n\npara calafetar embarcac?o?es. Naquela e?poca, o petro?leo era retirado de exsudac?o?es natu-\n\nrais. Hoje em dia, a demanda crescente de petro?leo requer o uso de te?cnicas modernas\n\nde engenharia para sua prospecc?a?o e explorac?a?o, sendo o petro?leo obtido de poc?os cada\n\nvez mais profundos. Quando a pressa?o do reservato?rio de petro?leo for suficientemente\n\nalta, o petro?leo fluira? ate? a superf??cie sem a necessidade de ajuda externa. No entanto,\n\nquando a pressa?o for baixa, utilizam-se me?todos de elevac?a?o artificial para suplementar\n\na energia natural e melhorar a produtividade do poc?o. Um dos me?todos de elevac?a?o\n\nartificial utilizados e? a elevac?a?o por injec?a?o cont??nua de ga?s (continuous gas-lift), onde\n\natrave?s da injec?a?o de ga?s num ponto profundo do poc?o, diminui-se a densidade da\n\ncoluna de petro?leo, reduzindo as forc?as contra?rias a? chegada deste ate? a superf??cie.\n\nO me?todo de elevac?a?o por injec?a?o cont??nua de ga?s possui uma vaza?o o?tima de ga?s,\n\ndo ponto de vista econo?mico, numa regia?o de operac?a?o do poc?o que e? muito oscilato?ria.\n\nAssim, ha? um grande interesse em estruturas para o controle de poc?os que operem com\n\neste me?todo de elevac?a?o artificial.\n\nPara efetuar o controle do poc?o, recorrem-se a?s ferramentas da teoria de controle,\n\n\n\nIntroduc?a?o 2\n\nque requerem o uso de um modelo matema?tico do sistema em ana?lise. A modelagem\n\nfenomenolo?gica das relac?o?es de entrada e sa??da do poc?o e? uma tarefa complexa, en-\n\nvolvendo equac?o?es com derivadas parciais de dif??cil manipulac?a?o. Uma alternativa e?\n\nrecorrer a? modelagem emp??rica, ou identificac?a?o de sistemas, que e? um ramo da cie?ncia\n\nque se ocupa em encontrar relac?o?es matema?ticas entre uma se?rie de valores de entrada\n\ne uma se?rie de valores de sa??da de um sistema, sem que haja conhecimento pre?vio do\n\nseu funcionamento interno (identificac?a?o caixa-preta). Tal conhecimento pre?vio pode\n\nevidentemente ser utilizado, quando dispon??vel, para melhorar a qualidade dos modelos\n\nidentificados, chamando-se esse procedimento de identificac?a?o caixa-cinza.\n\nO sistema em ana?lise possui um comportamento na?o-linear, de forma que modelos\n\nlineares que venham a ser obtidos sera?o va?lidos somente dentro de uma estreita faixa\n\nde operac?a?o. Como ha? interesse que o sistema possa funcionar dentro de uma regia?o\n\nmais ampla que aquela permitida pelos modelos lineares, recorrem-se aos modelos na?o-\n\nlineares, que apesar de serem mais complexos e requererem um ferramental espec??fico,\n\nrepresentam de forma mais completa a caracter??stica esta?tica e dina?mica de um sistema\n\nna?o-linear.\n\nA motivac?a?o para este trabalho e? justamente a necessidade da obtenc?a?o de modelos\n\nlineares e na?o-lineares para um poc?o, que possam ser utilizados na implementac?a?o de\n\nestruturas de controle que visem a otimizac?a?o do seu funcionamento.\n\nO tipo de modelo utilizado neste trabalho e? o NARMAX (na?o-linear auto-regressivo\n\ncom me?dia mo?vel e entradas exo?genas - do ingle?s Nonlinear AutoRegressive Moving\n\nAverage with eXogenous inputs) polinomial, que e? adequado para representar sistemas\n\nna?o-lineares desde que na?o haja variac?o?es abruptas nos dados de sa??da, estando dis-\n\npon??veis uma se?rie de algoritmos simples e robustos (conseguem lidar com um certo\n\nn??vel de mal-condicionamento nume?rico) para estimac?a?o dos para?metros do modelo.\n\nAs varia?veis de entrada e sa??da do sistema foram definidas como sendo a vaza?o\n\nma?ssica de injec?a?o de ga?s na entrada do poc?o e a pressa?o no tubo de produc?a?o, respec-\n\ntivamente. Esta escolha de varia?veis tem o me?rito de transformar o sistema a ser contro-\n\nlado num sistema SISO, com controles locais atuando sobre as demais varia?veis. Ale?m\n\ndisso, as varia?veis escolhidas sa?o facilmente mensura?veis, tornando a implementac?a?o\n\npra?tica do sistema fact??vel e interessante financeiramente.\n\nEste trabalho esta? organizado da seguinte maneira. O cap??tulo 2 faz uma revisa?o\n\nteo?rica sobre modelagem e identificac?a?o de sistemas, classificac?a?o de modelos e sobre as\n\n\n\nIntroduc?a?o 3\n\nrepresentac?o?es lineares e na?o-lineares existentes, em particular as representac?o?es ARX\n\ne ARMAX (lineares) e a representac?a?o NARMAX polinomial (na?o-linear), utilizadas\n\nmais adiante.\n\nO cap??tulo 3 faz uma revisa?o teo?rica sobre identificac?a?o de sistemas; etapas na\n\nidentificac?a?o de sistemas; questo?es pra?ticas como a escolha do per??odo de amostragem e\n\ndo sinal de entrada para identificac?a?o; estimac?a?o de para?metros; ferramentas espec??ficas\n\na? identificac?a?o de sistemas na?o-lineares do tipo NARMAX; e sobre a validac?a?o dos\n\nmodelos obtidos.\n\nO cap??tulo 4 conte?m a parte pra?tica deste trabalho, com o estudo de caso de um\n\npoc?o de petro?leo operando por injec?a?o cont??nua de ga?s, simulado pelo software OLGA\n\n2000. Faz-se inicialmente uma descric?a?o do sistema em estudo e do software utilizado\n\npara simulac?a?o; seguida da identificac?a?o de modelos lineares para o sistema em tre?s\n\npontos de operac?a?o; identificac?a?o de modelos na?o-lineares utilizando duas estrate?gias\n\npara o sinal de entrada; e comparac?a?o entre os modelos obtidos. E? tambe?m sugerida\n\numa estrate?gia para o controle do poc?o com o uso dos modelos identificados, a ser\n\nusada em trabalhos futuros.\n\nPor u?ltimo, no cap??tulo 5 sa?o apresentadas considerac?o?es finais e sugesto?es para\n\ntrabalhos futuros.\n\n\n\nCap??tulo 2\n\nModelagem de Sistemas Dina?micos\n\n2.1 Introduc?a?o\n\nUm sistema pode ser definido como \u201cum conjunto de objetos agrupados por alguma\n\ninterac?a?o ou interdepende?ncia, de modo que existam relac?o?es de causa e efeito nos\n\nfeno?menos que ocorrem com os elementos deste conjunto\u201d [29]. Em Ogata [31] define-\n\nse um sistema como \u201cuma combinac?a?o de componentes que atuam em conjunto e\n\nrealizam um certo objetivo. Um sistema na?o e? limitado apenas a algo f??sico. O conceito\n\nde sistemas pode ser aplicado a feno?menos abstratos, dina?micos, como os encontrados\n\nem Economia\u201d.\n\nPara estudos quantitativos de sistemas, como os feitos na engenharia, e? necessa?rio\n\nque estes sistemas sejam representados por modelos matema?ticos adequados aos estudos\n\nem curso. Fala-se em modelo adequado pois e? praticamente imposs??vel obter um modelo\n\nmatema?tico exato que represente um sistema. Ale?m de imposs??vel, um modelo exato\n\nseria inu?til na maioria das vezes pois, em geral, o que se deseja e? um modelo que seja\n\nrepresentativo de uma ou mais caracter??sticas do sistema em ana?lise, na?o de todas elas\n\nao mesmo tempo. Um modelo que represente todas as caracter??sticas de um sistema\n\nde forma exata seria ta?o complexo que seria mais fa?cil lidar com o pro?prio sistema e\n\nignorar o modelo.\n\nAssim, utilizam-se modelos aproximados, sendo a aproximac?a?o boa ou na?o de acordo\n\ncom o objetivo do estudo. Por exemplo, modelos constru??dos com base na meca?nica\n\nNewtoniana para estudar o movimento de um carro podem ser uma boa aproximac?a?o.\n\n\n\nModelagem de Sistemas Dina?micos 5\n\nSe entretanto tratamos de movimento de ele?trons, esta aproximac?a?o na?o sera? adequada,\n\nsendo necessa?rio utilizar modelos baseados na meca?nica qua?ntica. Ve?-se enta?o que na?o\n\nha? um u?nico modelo para representar um sistema.\n\nCoelho [12] menciona alguns usos poss??veis para os modelos obtidos:\n\nPrevisa?o Sa?o tentativas de \u201cprever\u201d o comportamento futuro do sistema com base no\n\nseu estado atual e na entrada do sistema.\n\nAna?lise e projeto de sistemas de controle Os modelos sa?o nesse caso utilizados\n\npara a s??ntese de controladores usando as ferramentas da Teoria de Controle.\n\nEm geral os modelos utilizados para projeto de sistemas de controle na?o sa?o de\n\ngrande complexidade.\n\nSupervisa?o Utilizados para a detecc?a?o de erros e diagno?sticos, ao comparar-se a\n\ndina?mica esperada (sa??da do modelo validado) comparada com o comportamento\n\ndo sistema real.\n\nOtimizac?a?o Usados como ferramenta de tomada de decisa?o, visando a maxi-\n\nmizac?a?o/minimizac?a?o de alguma varia?vel. Para o propo?sito de otimizac?a?o,\n\nexigem-se modelos matema?ticos precisos.\n\nTreinamento Utilizados para treinamento de operadores. Como exemplo desta ca-\n\ntegoria de modelos pode-se citar os simuladores de vo?o, que sa?o baseados em\n\nmodelos matema?ticos do sistema real (um avia?o).\n\nPode-se obter o modelo basicamente de duas formas: atrave?s de uma modelagem\n\nf??sica do processo ou atrave?s de uma modelagem emp??rica. A modelagem f??sica e?\n\nderivada das equac?o?es f??sicas que regem um dado sistema, sendo tambe?m conhecida\n\npor modelagem pela natureza do processo, modelagem fenomenolo?gica, conceitual ou\n\nainda modelagem caixa branca. Para tanto, faz-se necessa?rio conhecer a fundo o sistema\n\nem ana?lise e as equac?o?es que o regem, o que nem sempre e? poss??vel ou via?vel. Ja? a\n\nmodelagem emp??rica, tambe?m conhecida por modelagem (ou identificac?a?o) caixa preta\n\nrequer pouco conhecimento do funcionamento interno do sistema, baseando a ana?lise\n\nsomente no estudo dos dados provenientes de observac?o?es do sistema.\n\nEste cap??tulo faz uma breve revisa?o teo?rica de modelagem, comec?ando pela clas-\n\nsificac?a?o de modelos segundo a Teoria de Sistemas Dina?micos. Em seguida, mostra\n\n\n\nModelagem de Sistemas Dina?micos 6\n\nalguns modelos lineares usados, entre eles os modelos AR(X) e ARMA(X) utilizados\n\nno estudo de caso mais adiante. Finalmente, comenta-se sobre representac?o?es na?o-\n\nlineares e, em particular, a representac?a?o NARMAX e NARMAX polinomial, sendo\n\nesta u?ltima o foco deste trabalho.\n\n2.2 Classificac?a?o de Modelos\n\nAs poss??veis representac?o?es matema?ticas de sistemas sa?o diversas, sendo a seguir\n\nmencionadas algumas classificac?o?es poss??veis de modelos, de acordo com a nomencla-\n\ntura comumente usada na Teoria de Sistemas Dina?micos [4, 29].\n\nModelos Esta?ticos ou Dina?micos Modelos dina?micos sa?o aqueles modelos onde o\n\nestado de um sistema num dado instante de tempo depende do estado do sistema\n\nem instantes anteriores. Tais modelos sa?o normalmente descritos por equac?o?es\n\ndiferenciais ou a diferenc?as. Ja? modelos esta?ticos (ou instanta?neos) sa?o aqueles\n\nonde para calcular o estado do sistema num dado instante de tempo, o estado\n\ndo sistema em instantes anteriores na?o e? relevante. Em outras palavras, mode-\n\nlos esta?ticos na?o te?m memo?ria, sendo normalmente representados por equac?o?es\n\nalge?bricas. Na pra?tica, os sistemas reais sa?o todos dina?micos, mas para uma dada\n\nana?lise a dina?mica do sistema pode ser desprez??vel por ser muito ra?pida ou muito\n\nlenta comparada com a escala de tempo utilizada.\n\nModelos de Tempo Cont??nuo, de Tempo Discreto ou H??bridos Um modelo e?\n\nde tempo cont??nuo quando a varia?vel que representa o tempo t e? um nu?mero real\n\npositivo. Ou seja, pode-se encontrar o valor de uma dada varia?vel do sistema em\n\nqualquer instante de tempo t ? R+. Estes modelos sa?o em geral representados\npor equac?o?es diferenciais, como por exemplo: x?(t) + 2x(t) = 0. A temperatura de\n\numa sala, por exemplo, pode ser representada por um modelo de tempo cont??nuo,\n\nja? que para qualquer instante de tempo, pode-se encontrar um valor de tempe-\n\nratura correspondente. Modelos de tempo discreto sa?o aqueles onde o valor que\n\ndefine um instante de tempo k e? um nu?mero inteiro positivo, sendo normalmente\n\nrepresentados por equac?o?es a diferenc?as como: x(k)?3x(k?1) = 0, onde k ? Z+.\nO prec?o de fechamento de uma ac?a?o na bolsa de valores e? bem representado num\n\nmodelo a tempo discreto, ja? que este dado so? e? obtido uma vez por dia, no final\n\ndo prega?o. Sistemas amostrados tambe?m sa?o bem representados por modelos a\n\n\n\nModelagem de Sistemas Dina?micos 7\n\ntempo discreto, sendo este tipo de sistema muito utilizado na Identificac?a?o de\n\nSistemas. Modelos h??bridos te?m uma parte descrita na forma cont??nua e outra\n\nparte descrita na forma discreta, sendo u?teis em aplicac?o?es de Controle Digital e\n\npara Tratamento Digital de Sinais.\n\nModelos Lineares ou na?o-Lineares Um modelo e? dito linear se verifica o princ??pio\n\nda superposic?a?o [9]. Caso contra?rio e? chamado de na?o-linear. De forma pra?tica,\n\num modelo e? dito linear se as varia?veis que o definem na?o aparecem na equac?a?o\n\nsob a forma de func?o?es na?o lineares. Por exemplo, o modelo 2x?(t) + x(t) = u(t) e?\n\nlinear, ja? os modelos 2x?(t) + x2(t) = u(t) e 2x?(t) + x(t)u(t) = 0 sa?o na?o-lineares.\n\nModelos Causais ou Antecipativos Um modelo e? dito causal (ou na?o-\n\nantecipativo) quando a sa??da do sistema no instante t na?o depende das\n\nentradas aplicadas ao sistema apo?s o instante de tempo t. Um modelo e? dito\n\nantecipativo (ou na?o-causal) quando a sa??da do sistema no instante t depende do\n\nvalor da entrada apo?s o instante de tempo t. Ainda que seja poss??vel representar\n\nmatematicamente um modelo antecipativo, nenhum sistema f??sico tem esta\n\ncaracter??stica. Portanto os modelos estudados sera?o sempre causais.\n\nModelos Auto?nomos ou na?o-Auto?nomos Modelos que na?o conte?m sinais de en-\n\ntrada dependendo explicitamente do tempo sa?o chamados de auto?nomos. As\n\nentradas do modelo sa?o frequ?entemente chamadas de entradas exo?genas, onde\n\nexo?gena significa que e? algo determinado fora do sistema considerado.\n\nModelos Monovaria?veis ou Multivaria?veis Sa?o chamados de monovaria?veis os\n\nmodelos que representam a relac?a?o entre uma entrada e uma sa??da. Na lite-\n\nratura sa?o conhecidos tambe?m por modelos SISO (single input single output).\n\nCaso haja mais de uma entrada ou mais de uma sa??da os modelos passam a\n\nser chamados de multivaria?veis. Dentre estes, e? comum classifica?-los em: MISO\n\n(multiple input single output) quando ha? va?rias entradas e somente uma sa??da;\n\nSIMO (single input multiple output) para o caso em que ha? uma u?nica entrada e\n\nmais de uma sa??da; e finalmente MIMO (multiple input multiple output) quando\n\nha? va?rias entradas e va?rias sa??das.\n\nModelos Determin??sticos ou Estoca?sticos Segundo Ljung [28], chama-se um mo-\n\ndelo de determin??stico se ele trabalha com uma relac?a?o exata entre as varia?veis\n\nem ana?lise e se expressa sem incertezas. Por outro lado, um modelo e? estoca?stico\n\nse ele tambe?m trabalha com conceitos de incerteza e probabilidade. Desta forma,\n\n\n\nModelagem de Sistemas Dina?micos 8\n\na sa??da de um modelo estoca?stico e? uma varia?vel aleato?ria. Na pra?tica, sem-\n\npre teremos algum grau de contaminac?a?o dos dados por ru??do ou incerteza na\n\nmedic?a?o, de forma que os modelos estoca?sticos sa?o mais adequados a? identificac?a?o\n\nde sistemas.\n\n2.3 Representac?o?es Lineares\n\nAs representac?o?es de um sistema tentam descrever da forma mais completa poss??vel\n\nas caracter??sticas de um sistema. Pore?m, sempre existe algum grau de simplificac?a?o.\n\nQuando se considera que a caracter??stica de entrada-sa??da de um sistema e? razoa-\n\nvelmente linear dentro de uma certa faixa de operac?a?o, utilizam-se as representac?o?es\n\nlineares. As principais representac?o?es de sistemas lineares sa?o a resposta ao impulso,\n\na func?a?o de transfere?ncia, a resposta em frequ?e?ncia e as representac?o?es no espac?o de\n\nestados, todas elas existentes no caso cont??nuo e no caso discreto. Descreve-se a seguir\n\na representac?a?o geral discreta e duas representac?o?es derivadas dela, particularmente\n\nu?teis no contexto de identificac?a?o de sistemas: os modelos ARX e ARMAX.\n\n2.3.1 Representac?a?o Geral Discreta\n\nUm sistema linear de tempo discreto pode ser representado sob a forma geral:\n\nA(q)y(k) =\nB(q)\n\nF(q)\nu(k) +\n\nC(q)\n\nD(q)\n?(k), (2.1)\n\nonde q?1 e? o operador de atraso, u(k) e? entrada do sistema, y(k) e? a sa??da do sistema\n\ne ?(k) e? um ru??do branco. O operador atraso e? um operador linear tal que:\n\nq?1y(k) = y(k ? 1). (2.2)\n\nAs principais propriedades do operador de atraso sa?o discutidas em [16]. Os po-\n\nlino?mios A(q),B(q),C(q),D(q) e F(q) sa?o definidos a seguir:\n\nA(q) = 1 + a1q\n?1 + \u00b7 \u00b7 \u00b7 + anyq\n\n?ny ;\n\nB(q) = b0 + b1q\n?1 + \u00b7 \u00b7 \u00b7 + bnuq\n\n?nu ;\n\nC(q) = 1 + c1q\n?1 + \u00b7 \u00b7 \u00b7 + cn?q\n\n?n? ;\n\nD(q) = 1 + d1q\n?1 + \u00b7 \u00b7 \u00b7 + dndq\n\n?nd ;\n\nF(q) = 1 + f1q\n?1 + \u00b7 \u00b7 \u00b7 + fnf q\n\n?nf . (2.3)\n\n\n\nModelagem de Sistemas Dina?micos 9\n\nOs modelos derivados da forma geral discreta, como por exemplo os modelos ARX\n\ne ARMAX, sa?o particularmente u?teis para a identificac?a?o de sistemas por existirem\n\ndiversos algoritmos para a estimac?a?o de seus para?metros.\n\n2.3.2 Modelos AR e ARX\n\nO modelo ARX, sigla de auto-regressivo com entradas exo?genas (do ingle?s - Au-\n\ntoRegressive with eXogenous inputs) e? obtido a partir da representac?a?o geral discreta\n\nfazendo-se C(q) = D(q) = F(q) = 1 e arbitrando-se os polino?mios A(q) e B(q). Desta\n\nforma, um modelo ARX possui a seguinte representac?a?o:\n\nA(q)y(k) = B(q)u(k) + ?(k). (2.4)\n\nReagrupando-se os termos, temos:\n\ny(k) =\nB(q)\n\nA(q)\nu(k) +\n\n1\n\nA(q)\n?(k). (2.5)\n\nO modelo AR, ou modelo auto-regressivo, e? um caso particular do modelo ARX,\n\nonde na?o existem entradas externas, ou seja, B(q) = 0. Assim:\n\nA(q)y(k) = ?(k)\n\n(1 + a1q\n?1 + \u00b7 \u00b7 \u00b7 + apq?p)y(k) = ?(k)\n\ny(k) = ?(a1q?1 + \u00b7 \u00b7 \u00b7 + apq?p)y(k) + ?(k)\n\ny(k) = ?(a1y(k ? 1) + \u00b7 \u00b7 \u00b7 + apy(k ? p)) + ?(k) (2.6)\n\nDesta forma, a evoluc?a?o da se?rie representativa do sistema e? func?a?o apenas das\n\ncondic?o?es iniciais e do ru??do que incide sobre o sistema.\n\n2.3.3 Modelos ARMA e ARMAX\n\nO modelo ARMAX, sigla de autoregressivo com me?dia mo?vel e entradas exo?genas\n\n(do ingle?s - AutoRegressive Moving Average with eXogenous inputs), e? obtido a par-\n\ntir da representac?a?o geral discreta fazendo-se D(q) = F(q) = 1 e arbitrando-se os\n\npolino?mios A(q), B(q) e C(q). Um modelo ARMAX tem a forma:\n\nA(q)y(k) = B(q)u(k) + C(q)?(k). (2.7)\n\n\n\nModelagem de Sistemas Dina?micos 10\n\nReagrupando-se os termos, temos:\n\ny(k) =\nB(q)\n\nA(q)\nu(k) +\n\nC(q)\n\nA(q)\n?(k). (2.8)\n\nOs modelos do tipo ARMA (autoregressivos com me?dia mo?vel) sa?o um caso par-\n\nticular do modelo ARMAX, onde na?o existem entradas externas, ou seja, B(q) = 0.\n\nAssim:\n\nA(q)y(k) =C(q)?(k)\n\n(1 + a1q\n?1 + \u00b7 \u00b7 \u00b7 + apq?p)y(k) =(1 + c1q?1 + \u00b7 \u00b7 \u00b7 + cqq?q)?(k)\n\ny(k) = ?(a1q?1 + \u00b7 \u00b7 \u00b7 + anyq\n?ny )y(k) + ?(k) + c1?(k ? 1) + \u00b7 \u00b7 \u00b7 + cq?(k ? q). (2.9)\n\nOs modelos do tipo ARMA podem ser utilizados quando a se?rie em ana?lise e? esta-\n\nciona?ria. De forma resumida, uma se?rie e? estaciona?ria quando possui me?dia e varia?ncia\n\nconstantes e sua covaria?ncia e? invaria?vel no tempo1. Entretanto muita se?ries temporais\n\nna?o atendem a esses requisitos, como por exemplo a se?rie histo?rica do Produto Interno\n\nBruto (PIB) de um pa??s, sendo consideradas integradas.\n\nQuando uma se?rie temporal for integrada de ordem 1 (tambe?m chamadas de se?rie\n\ndo tipo I(1)), suas primeiras diferenc?as sa?o do tipo I(0), ou seja, na?o-integradas ou\n\nestaciona?rias. Assim, dada uma se?rie y do tipo I(1), fazendo-se:\n\n?y(k) = y(k) ? y(k ? 1), (2.10)\n\ntemos que a se?rie ?y sera? estaciona?ria.\n\nDa mesma forma, um processo do tipo I(2) tera? a sua segunda diferenc?a do tipo\n\nI(0) que e? estaciona?ria. De forma gene?rica, um processo do tipo I(d ) podera? ser trans-\n\nformado em estaciona?rio diferenciando-o d vezes.\n\nUm modelo ARIMA (do tipo I(1)) e? enta?o um modelo ARMA da primeira diferenc?a\n\nde um sinal. O \u201cI\u201d da sigla corresponde a? integrac?a?o discreta necessa?ria: a sa??da do\n\nmodelo ARMA deve ser integrada para chegar ao sinal original.\n\n1Uma discussa?o mais detalhada sobre estacionariedade de se?ries pode ser vista em [7, 20]\n\n\n\nModelagem de Sistemas Dina?micos 11\n\n2.4 Representac?o?es na?o-Lineares e\n\nModelos NARMAX\n\nObservando os sistemas existentes na Natureza, pode-se dizer que a grande maio-\n\nria (talvez todos) sa?o na?o-lineares. No entanto, muitos deles podem ser considerados\n\nlineares dentro de uma certa faixa de operac?a?o. Quando se esta? trabalhando fora desta\n\nfaixa, ou quando o sistema possui uma dina?mica na?o-linear muito forte, recomenda-se\n\na utilizac?a?o de uma representac?a?o na?o-linear do sistema. Segundo Aguirre [4], mais\n\ndo que melhorar a exatida?o dos modelos, o uso de representac?o?es na?o-lineares e? ne-\n\ncessa?ria por possibilitar a representac?a?o de certos comportamentos dina?micos que na?o\n\nsa?o poss??veis de serem descritos com o modelos lineares.\n\nO leque de representac?o?es dispon??veis para sistemas na?o-lineares e? vasta, podendo\n\nserem citadas, entre outras, os modelos NARMAX, a se?rie de Volterra, os modelos\n\nde Hammerstein e de Wiener, modelos polinomiais cont??nuos, func?o?es de base radial e\n\nredes neurais artificiais [1, 21]. Cada representac?a?o possui suas vantagens, desvantagens\n\ne gama de aplicac?o?es, na?o sendo objetivo deste trabalho detalha?-las.\n\nOs modelos NARMAX, sigla de na?o-linear auto-regressivo com me?dia mo?vel e en-\n\ntradas exo?genas (Non-linear AutoRegressive Moving Average model with eXogenous\n\ninputs), podem ser representados da seguinte maneira [25]:\n\ny(k) = F[y(k ? 1), . . . ,y(k ?ny),u(k ? 1), . . . ,u(k ?nu),?(k),?(k ? 1), . . . ,?(k ?n? )],\n(2.11)\n\nonde F e? uma func?a?o na?o-linear, ny, nu e n? sa?o os maiores atrasos em y, u e ?,\n\nrespectivamente. Entretanto, a determinac?a?o da func?a?o F e? de grande dificuldade.\n\nUm modelo NARMAX polinomial e? uma expansa?o da func?a?o F (equac?a?o 2.11) em\n\numa func?a?o polinomial com grau de na?o-linearidade `. Considera-se que o sistema na?o\n\ntem atraso puro de tempo e que nenhum dos para?metros a ser estimado depende de\n\n?(k). Assim, um modelo NARMAX polinomial e? dado por uma parte determin??stica\n\nNARX, mais uma parte me?dia mo?vel contendo o erro. A aproximac?a?o polinomial de\n\ngrau ` e? descrita por [10]:\n\ny(k) = ?0 +\nn?\n\ni1=1\n\n?i1xi1 (k) +\nn?\n\ni1=1\n\nn?\ni2=i1\n\n?i1i2xi1 (k) \u00b7 xi2 (k) + . . .\n\n+\nn?\n\ni1=1\n\n\u00b7 \u00b7 \u00b7\nn?\n\nil=il?1\n\n?i1...ilxi1 (k) . . .xil (k) + ?(k) (2.12)\n\n\n\nModelagem de Sistemas Dina?micos 12\n\nonde:\n\nn = ny + nu\n\nx1 = y(k ? 1)\n\nx2 = y(k ? 2)\n...\n\nxny = y(k ? ny)\n\nxny+1 = u(k ? 1)\n...\n\nxn = u(k ? nu) (2.13)\n\ne ? sa?o para?metros constantes.\n\nOu seja, y(k) e? uma soma de termos com grau de na?o-linearidade m, com 1 ? m ? `.\nSendo p o grau de y e q o grau de u num dado termo, enta?o p + q = m ? `. O grau de\nna?o-linearidade ` do modelo polinomial corresponde ao maior valor m dentre todos os\n\ntermos do modelo.\n\nPara exemplificar, um modelo NARMAX representado por uma func?a?o F expandida\n\nem um polino?mio com grau ` = 2, com ny = 2 e nu = 1 tem sua parte determin??stica\n\ndada por:\n\ny(k) = c0,0 + c1,0(1)y(k ? 1) + c1,0(2)y(k ? 2) + c0,1(1)u(k ? 1)\n\n+ c2,0(1, 1)y\n2(k ? 1) + c2,0(1, 2)y(k ? 1)y(k ? 2) + c2,0(2, 2)y2(k ? 2)\n\n+ c1,1(1, 1)y(k ? 1)u(k ? 1) + c1,1(2, 1)y(k ? 2)u(k ? 1). (2.14)\n\nA constante na forma cp,q(n1, . . . ,nm), vista na equac?a?o 2.14, representa a constante\n\nque multiplica um termo onde os fatores em y possuem grau p, os fatores em u possuem\n\ngrau q e os valores ni representam os atrasos em cada um dos termos em y seguidos\n\ndos atrasos nos termos em u.\n\nUm fato interessante a ser notado no modelo NARMAX polinomial e? que apesar\n\nde ser um modelo na?o-linear nas varia?veis, ele e? linear nos para?metros, sendo poss??vel\n\ncoloca?-lo na forma (ver sec?a?o 3.6.2):\n\ny(k) = ?T (k)\n~?\n? + ?(k) (2.15)\n\n\n\nModelagem de Sistemas Dina?micos 13\n\nque e? linear nos para?metros, facilitando a estimac?a?o destes. No caso do modelo\n\ndo exemplo anterior (equac?a?o 2.14), temos que o vetor de regressores e o vetor de\n\npara?metros sa?o dados por:\n\n?(k) =\n\n?\n???????????????????\n\n1\n\ny(k ? 1)\ny(k ? 2)\nu(k ? 1)\ny2(k ? 1)\n\ny(k ? 1)y(k ? 2)\ny2(k ? 2)\n\ny(k ? 1)u(k ? 1)\ny(k ? 2)u(k ? 1)\n\n?\n???????????????????\n\n,\n~?\n? =\n\n?\n???????????????????\n\nc0,0\n\nc1,0(1)\n\nc1,0(2)\n\nc0,1(1)\n\nc2,0(1, 1)\n\nc2,0(1, 2)\n\nc2,0(2, 2)\n\nc1,1(1, 1)\n\nc1,1(2, 1)\n\n?\n???????????????????\n\n. (2.16)\n\nE? poss??vel, de forma ana?loga aos modelos ARIMA(X), utilizar modelos NA-\n\nRIMA(X), correspondendo a modelos NARMA(X) da diferenciac?a?o de um sinal (ver\n\nsec?a?o 2.3.3). Isso corresponderia a? existe?ncia de um ou mais integradores no modelo.\n\nNo entanto, na?o e? muito comum encontrar refere?ncias na literatura ao uso destes mo-\n\ndelos.\n\nO uso da representac?a?o NARMAX pode ser justificada por va?rias razo?es, dentre as\n\nquais [5, 23]:\n\n\u2022 e? uma representac?a?o global, permitindo representar a dina?mica global do sistema\ne na?o somente em torno a um ponto de equil??brio;\n\n\u2022 consegue lidar com n??veis moderados de ru??do;\n\n\u2022 informac?o?es anal??ticas sobre o modelo sa?o fa?ceis de se obter;\n\n\u2022 e? poss??vel obter modelos NARMAX com bom ajuste aos dados desde que os dados\nde sa??da na?o apresentem variac?o?es abruptas;\n\n\u2022 algoritmos simples e robustos podem ser utilizados para a estimac?a?o de\npara?metros (ja? que o modelo e? linear nos para?metros).\n\nEntretanto, como o modelo e? linear nos para?metros, ele requer mais para?metros\n\npara representar um sistema do que modelos que sa?o na?o-lineares nos para?metros,\n\ncomo e? o caso de modelos NARMAX racionais [4].\n\n\n\nModelagem de Sistemas Dina?micos 14\n\nAle?m disso, comparando-se com modelos puramente lineares, fica claro que o\n\nnu?mero de regressores candidatos acaba sendo muito maior nos modelos NARMAX\n\npolinomiais do que nos modelos ARMAX (lineares), fazendo com que seja mais com-\n\nplexa a tarefa de encontrar a estrutura ideal para o modelo.\n\n\n\nCap??tulo 3\n\nIdentificac?a?o de Sistemas\n\n3.1 Introduc?a?o\n\nA identificac?a?o de sistemas, ou modelagem emp??rica dedica-se a encontrar uma\n\nrelac?a?o matema?tica entre as entradas e as sa??das de um sistema, sem necessariamente\n\nse ater a?s relac?o?es f??sicas que o regem. Mas por que utilizar identificac?a?o em um\n\nsistema em vez de modela?-lo fisicamente? A modelagem f??sica permite obter um modelo\n\nque pode ser \u201cinterpretado\u201d: em geral ha? um significado teo?rico para cada um dos\n\npara?metros e para a estrutura da equac?a?o. Com isso, e? mais fa?cil que o modelo acomode\n\neventuais alterac?o?es no sistema, bastando para isso atualizar um ou mais para?metros\n\ndo modelo. Pore?m, quando se trata de sistemas complexos e? por vezes dif??cil (ou\n\ninvia?vel) obter um modelo que descreva de forma satisfato?ria a interac?a?o entre todos\n\nos subsistemas presentes. Recorre-se enta?o a? identificac?a?o de sistemas, que teve um\n\ngrande avanc?o nas u?ltimas de?cadas com a evoluc?a?o e o aumento na velocidade de ca?lculo\n\ndos computadores.\n\nO problema da identificac?a?o pode ser tratado como um problema de otimizac?a?o,\n\nonde a func?a?o custo e? definida de forma a penalizar os modelos que na?o represen-\n\ntem adequadamente as caracter??sticas de interesse do sistema. Va?rios fatores podem\n\ninfluenciar a selec?a?o dos modelos e o ajuste dos para?metros [12]:\n\n\u2022 Conhecimento a priori do sistema (na?o-linearidade, atraso de transporte, carac-\nter??stica esta?tica).\n\n\u2022 Propriedades do modelo identificado (complexidade).\n\n\n\nIdentificac?a?o de Sistemas 16\n\n\u2022 Selec?a?o da medida do erro a ser minimizado.\n\n\u2022 Presenc?a de ru??dos.\n\nA identificac?a?o pode ser feita considerando-se somente as se?ries de entrada e sa??da\n\ndo sistema, sem qualquer outra informac?a?o adicional, sendo neste caso chamada de\n\nidentificac?a?o caixa preta. Em alguns casos, dispo?em-se de dados adicionais sobre o\n\nsistema, como por exemplo a caracter??stica esta?tica ou o diagrama de bifurcac?o?es.\n\nEvidentemente seria um desperd??cio na?o utilizar essas informac?o?es para melhorar o\n\nmodelo. Chama-se de identificac?a?o caixa cinza aquela que busca incorporar dados\n\nadicionais sobre o sistema, ale?m das informac?o?es obtidas das se?ries de entrada e sa??da.\n\nPara executar a identificac?a?o de sistemas, faz-se uso de um conjunto de ferramen-\n\ntas matema?ticas e estat??sticas. Este cap??tulo faz uma breve revisa?o do ferramental\n\ndispon??vel, dando e?nfase a?quelas ferramentas utilizadas na identificac?a?o de modelos\n\nARMAX e NARMAX polinomiais, que sa?o utilizados no restante deste trabalho.\n\n3.2 Etapas na identificac?a?o de Sistemas\n\nA identificac?a?o de um sistema segue uma se?rie de passos de forma iterativa, ate?\n\nque se encontre um modelo adequado ao uso previsto. Os principais passos podem ser\n\nassim descritos [7]:\n\n1. Determine uma classe de modelos adequada ao fim para o qual o modelo se\n\nprestara?. Esta classe de modelos pode ser uma representac?a?o matema?tica do\n\ntipo Func?a?o de Transfere?ncia, Rede Neural, ou um modelo do tipo ARMAX, por\n\nexemplo.\n\n2. Determine uma sub-classe dentro desta classe de modelos selecionada, ou seja,\n\ndetermine a estrutura do modelo a ser usada. No caso de uma func?a?o de trans-\n\nfere?ncia isso significa determinar o nu?mero de po?los e zeros, no caso de uma rede\n\nneural significa determinar o nu?mero de camadas de neuro?nios e o nu?mero de\n\nneuro?nios por camada.\n\n3. Estime os para?metros do modelo com base nos dados dispon??veis.\n\n\n\nIdentificac?a?o de Sistemas 17\n\n4. Valide o modelo, verificando se ele e? aplica?vel ao propo?sito previsto e descreve\n\nadequadamente as caracter??sticas de interesse do sistema em ana?lise. Caso isso\n\nna?o se verifique, retorne ao ciclo de determinac?a?o de estrutura, estimac?a?o dos\n\npara?metros e validac?a?o do modelo.\n\nAle?m dos passos descritos acima, Aguirre [4] menciona mais um passo, logo no\n\nin??cio, que consiste em testes dina?micos e coletas de dados. Neste passo sa?o escolhidos\n\no sinal de excitac?a?o do sistema, a forma de execuc?a?o do teste e o tempo de amostragem.\n\nNo caso de sistemas auto?nomos, este passo na?o faz tanto sentido, ja? que na?o ha? sinal\n\nexterno excitando o sistema. Eventualmente pode-se ter que retornar a? etapa de testes\n\ndina?micos apo?s uma validac?a?o frustrada do modelo, devido, por exemplo, a um sinal\n\nde teste mal projetado.\n\n3.3 Func?o?es de Correlac?a?o\n\nDefine-se a Func?a?o de Correlac?a?o Cruzada (FCC) entre dois sinais u(t) e y(t) como\n\nsendo:\n\nruy(?,t) = E[u(t)y(t + ?)]. (3.1)\n\nConsiderando-se o processo ergo?dico1 e estaciona?rio2 pode-se substituir a esperanc?a\n\nmatema?tica pela me?dia temporal e eliminar a depende?ncia da FCC com o tempo [4],\n\nresultando, no caso discreto, em:\n\nruy(k) = lim\nN??\n\n1\n\n2N + 1\n\nN?\ni=?N\n\nu(i)y(i + k), (3.2)\n\ncom k ? Z.\n1Um processo aleato?rio e? ergo?dico se existe equivale?ncia, para janelas longas de tempo, entre as\n\nme?dias de conjunto e as me?dias temporais do processo. Em suma, ergodicidade implica que qualquer\n\nrealizac?a?o do processo estoca?stico sera? suficientemente \u201ct??pica\u201d ou, de outra maneira, as realizac?o?es\n\nna?o diferem muito entre si\n2Segundo Gujarati [20]: \u201ca grosso modo, um processo estoca?stico e? estaciona?rio se suas me?dias e\n\nvaria?ncia forem constantes ao longo do tempo e o valor da covaria?ncia entre dois per??odos de tempo\n\ndepender apenas da dista?ncia ou defasagem entre os dois per??odos, e na?o do per??odo efetivo em que a\n\ncovaria?ncia e? calculada\u201d. Estacionariedade, enta?o, implica em dizer que o processo esta? num estado\n\nparticular de equil??brio estat??stico [7].\n\n\n\nIdentificac?a?o de Sistemas 18\n\nA Func?a?o de Correlac?a?o Cruzada entre dois sinais mede a depende?ncia temporal\n\nentre eles, ou seja, o qua?o relacionados esta?o dois sinais no tempo. Para dois sinais\n\nindependentes no tempo, a FCC entre eles possuira? valores estatisticamente iguais\n\na zero para todos os valores de atraso (para todo k no caso discreto ou ? no caso\n\ncont??nuo).\n\nDe forma ana?loga a? equac?a?o 3.1, a Func?a?o de Autocorrelac?a?o (FAC) de um sinal e?\n\ndefinida como:\n\nruu(?,t) = E[u(t)u(t + ?)], (3.3)\n\npodendo ser estimada no caso discreto atrave?s de:\n\nruu(k) = lim\nN??\n\n1\n\n2N + 1\n\nN?\ni=?N\n\nu(i)u(i + k), (3.4)\n\npermitindo avaliar se os valores que um sinal adquire esta?o relacionados com os valores\n\nanteriores ou posteriores do mesmo sinal. Um sinal aleato?rio satisfaz ruu(k) = 0,\n\n?k 6= 0, pois se ele e? aleato?rio, na?o ha? nenhuma relac?a?o entre os valores da se?rie.\n\n3.4 Projeto do Sinal de Teste\n\nA escolha do sinal a ser utilizado na entrada do sistema que se deseja identificar\n\ne? um fator que define criticamente a qualidade dos modelos obtidos. O sinal de en-\n\ntrada do sistema e? responsa?vel por excitar as dina?micas internas do sistema na faixa de\n\noperac?a?o desejada. Um sinal mal projetado pode, por um lado, na?o revelar o comporta-\n\nmento do sistema num dado regime de operac?a?o ou, por outro lado, trazer informac?o?es\n\nindesejadas de fora deste regime.\n\nTipicamente deseja-se que a func?a?o de autocorrelac?a?o (equac?a?o 3.4) do sinal de\n\nentrada utilizado seja nula para todos os valores de k 6= 0. Dois tipos de sinais que\nsatisfazem essa condic?a?o sa?o os sinais aleato?rios e os pseudo-aleato?rios. O uso de sinais\n\naleato?rios ou pseudo-aleato?rios para identificac?a?o pode ser justificada de duas maneiras:\n\numa delas e? que a estimac?a?o de para?metros envolve a inversa?o de uma matriz e quanto\n\nmenos variar o sinal u(k), mais mal-condicionada sera? esta matriz, ja? que duas colunas\n\ncontendo regressores do tipo u(k ? i) sera?o muito parecidas (sera?o quase linearmente\ndependentes). Outro motivo e? que um sinal aleato?rio possui pote?ncia espectral numa\n\ngrande faixa de frequ?e?ncias. Em particular para a identificac?a?o linear isto e? interessante\n\n\n\nIdentificac?a?o de Sistemas 19\n\npois, num sistema linear, as frequ?e?ncias presentes na sa??da sera?o aquelas da entrada.\n\nAssim, um sistema excitado por um sinal aleato?rio tera? energia suficiente na faixa\n\nde frequ?e?ncias desejada para que elas se revelem na sa??da. Para sistemas lineares,\n\nsa?o frequ?entemente utilizados sinais pseudo-aleato?rios do tipo PRBS (Pseudo Random\n\nBinary Signal ). Ja? para sistemas na?o-lineares, prefere-se utilizar sinais aleato?rios [4].\n\nSegundo Brosilow [8], algumas vantagens de usar sinais do tipo PRBS sa?o:\n\n\u2022 Um sinal PRBS perturba o sistema em torno de um ponto de operac?a?o em regime\npermanente, sem desvia?-lo significativamente deste valor. Esta e? uma vantagem\n\npois permite que o sistema continue funcionando na sua regia?o de operac?a?o en-\n\nquanto e? feita a identificac?a?o, o que e? particularmente importante em processos\n\nlentos, onde a execuc?a?o dos testes requer um tempo longo (como e? o caso do poc?o\n\nde petro?leo operando por elevac?a?o artificial tipo injec?a?o cont??nua de ga?s, que sera?\n\nestudado no cap??tulo 4);\n\n\u2022 O conteu?do frequ?encial de um sinal PRBS pode ser ajustado facilmente para\natender as especificac?o?es sobre qual faixa de frequ?e?ncias se deseja excitar;\n\n\u2022 Sinais PRBS podem ser repetidos muitas vezes (e va?rios ensaios podem ser feitos),\no que pode aumentar a precisa?o das estimativas.\n\nLjung [28] sugere inicialmente aplicar uma entrada do tipo degrau no sistema, para\n\nobter uma impressa?o geral sobre as constantes de tempo do sistema. Desta forma evita-\n\nse aplicar um sinal que seja ta?o \u201cra?pido\u201d que o sistema na?o tenha tempo de responder\n\na ele. Aguirre [4] fornece uma heur??stica mais precisa, sugerindo que apo?s definir o\n\ntempo de amostragem do sistema, manter constante cada valor aleato?rio por 3 a 5\n\nper??odos de amostragem, e no caso de sinais PRBS, fazer com que o menor patamar\n\ndo sinal dure de 3 a 5 per??odos de amostragem.\n\nOutro fator a ser determinado no projeto do sinal de teste e? a amplitude do sinal\n\nde entrada, sendo ela responsa?vel por levar o sistema a diferentes regio?es de operac?a?o.\n\nNo caso linear, busca-se que a amplitude seja a menor poss??vel para na?o excitar as\n\nna?o-linearidades do sistema (mas que seja grande o suficiente para garantir uma boa\n\nrelac?a?o sinal-ru??do). Ja? no caso na?o-linear, a amplitude do sinal deve ser projetada\n\npara levar o sistema a?s regio?es de operac?a?o onde se deseja proceder a identificac?a?o.\n\n\n\nIdentificac?a?o de Sistemas 20\n\n3.5 Determinac?a?o do per??odo de amostragem\n\nO per??odo de amostragem (Ts) de um sistema corresponde ao intervalo de tempo\n\ndecorrido entre duas amostras e sua escolha tem grande impacto na qualidade dos mo-\n\ndelos identificados. Um per??odo de amostragem muito grande significa que ao amostrar\n\num sinal, uma parte da dina?mica do sistema na?o esta? sendo registrada. Ja? um per??odo\n\nde amostragem muito pequeno resulta em mal condicionamento nume?rico no problema\n\nde identificac?a?o. A raza?o deste mal-condicionamento nume?rico e? que ha? pouca diferenc?a\n\nno valor de y(kTs) para y((k + 1)Ts), onde k e? o valor do instante de tempo discreto.\n\nAssim, na equac?a?o 3.30, as colunas da matriz ? sera?o muito parecidas (quando Ts ? 0,\ny(kTs) = y ((k + 1)Ts)), causando problema na inversa?o da matriz da equac?a?o 3.31.\n\nSendo ?s a frequ?e?ncia de amostragem dada em radianos por segundo (?s = 2?/Ts)\n\ne ?max a maior frequ?e?ncia que compo?e um sinal y(t), o teorema de Shannon afirma\n\nque e? poss??vel reconstruir o sinal y(t) a partir do sinal amostrado y(kTs), desde que\n\n?s > 2 ?max. Na pra?tica, entretanto, costuma-se utilizar a frequ?e?ncia de amostragem\n\nde 5 a 10 vezes maior do que a maior frequ?e?ncia do sistema (5 ?max &lt;?s &lt;10 ?max).\n\nAle?m disso, pode-se utilizar um filtro para eliminar os componentes de frequ?e?ncia mais\n\nelevadas que eventualmente existam, de forma a evitar o aliasing3 do sinal.\n\nUm problema existente para a aplicac?a?o da heur??stica acima e? que, em geral, na?o se\n\nconhece o valor de ?max a priori. Uma estrate?gia utilizada e? amostrar o sinal y(t) com\n\numa frequ?e?ncia muito maior do que a necessa?ria e posteriormente reamostrar o sinal\n\nconvenientemente, conforme descrito em [4] e apresentado, resumidamente, a seguir.\n\nDado um sinal amostrado y?(k), calcula-se as func?o?es de autocovaria?ncia:\n\nry?(?) = E\n[(\ny?(k) ? y?(k)\n\n)(\ny?(k ? ?) ? y?(k)\n\n)]\n, (3.5)\n\nry?2 (?) = E\n[(\ny?2(k) ? y?2(k)\n\n)(\ny?2(k ? ?) ? y?2(k)\n\n)]\n, (3.6)\n\nonde E[\u00b7] e? a esperanc?a matema?tica, y?(k) e? a me?dia de y?(k) e y?2(k) e? a me?dia do\nquadrado de y?(k).\n\nO uso das func?o?es de autocovaria?ncia linear (equac?a?o 3.5) e na?o-linear (equac?a?o 3.6)\n\nvisa quantificar o quanto de redunda?ncia existe nas amostras feitas do sinal original.\n\nDeterminam-se os m??nimos de ry?(?) e ry?2 (?), correspondendo a ?y? e ?y?2 respectiva-\n\n3Para uma descric?a?o do feno?meno de aliasing, sugere-se a leitura do cap??tulo 3 de [30]\n\n\n\nIdentificac?a?o de Sistemas 21\n\nmente. E? deseja?vel que no caso linear a seguinte relac?a?o seja satisfeita:\n\n10 ? ?y? ? 20 (3.7)\n\ne no caso na?o-linear:\n\n10 ? min(?y?,?y?2 ) ? 20. (3.8)\n\nPara que tal objetivo seja alcanc?ado, busca-se determinar uma taxa de reamostra-\n\ngem ? ? N tal que y(k) = y?(?k). A escolha de ? deve permitir a y(k) satisfazer as\nequac?o?es 3.7 e 3.8. Vale notar que as func?o?es de autocovaria?ncia de y(k) e de y?(k)\n\nsera?o as mesmas, exceto pelo fator de escala ?. Assim, ? deve ser escolhido de forma\n\na satisfazer:\n?y?\n\n20\n? ? ?\n\n?y?\n\n10\n(3.9)\n\npara o caso linear ou\nmin(?y?,?y?2 )\n\n20\n? ? ?\n\nmin(?y?,?y?2 )\n\n10\n(3.10)\n\npara o caso na?o-linear.\n\n3.6 Estimac?a?o de Para?metros\n\nUma vez definida a estrutura de um modelo, passa-se a? etapa de estimac?a?o de\n\npara?metros, que consiste em determinar os valores dos para?metros de uma equac?a?o,\n\ncom base em dados de entrada e sa??da do sistema real. Esta estimac?a?o pode ser vista\n\ncomo um problema de otimizac?a?o, onde se busca o vetor de para?metros que minimize\n\numa certa func?a?o custo. Faz-se a seguir uma breve revisa?o do estimador de m??nimos\n\nquadrados - um dos estimadores mais utilizados - de onde derivam va?rios outros estima-\n\ndores. Em seguida comenta-se o seu uso para identificac?a?o de para?metros de modelos\n\nauto-regressivos. Finalmente trata-se o problema da polarizac?a?o das estimativas e como\n\ncontorna?-lo.\n\n3.6.1 O Estimador de M??nimos Quadrados (MQ)\n\nConsidere uma func?a?o escalar y = f(~x,~?), onde y e? a varia?vel dependente, ~x e? um\n\nvetor de varia?veis independentes (ou regressoras) e ~? e? um vetor contendo os para?metros\n\nda func?a?o f.\n\n\n\nIdentificac?a?o de Sistemas 22\n\nTomando-se um conjunto de n aplicac?o?es da func?a?o f podemos montar o seguinte\n\nconjunto de equac?o?es:\n\ny1 = f( ~x1,~?)\n\ny2 = f( ~x2,~?)\n\n... =\n...\n\nyN = f( ~xN,~?). (3.11)\n\nCada uma das equac?o?es 3.11 e? chamada de uma restric?a?o da func?a?o f, desta forma,\n\n3.11 forma um conjunto de N restric?o?es da func?a?o f.\n\nConsiderando-se que a func?a?o f seja linear e que f e ~? permanec?am os mesmos em\n\ntodas as N restric?o?es, podemos reescrever a equac?a?o 3.11 como:?\n??????\ny1\n\ny2\n...\n\nyN\n\n?\n?????? =\n\n?\n??????\n\n~x1\nT\n\n~x2\nT\n\n...\n\n~xN\nT\n\n?\n??????\n\n?\n??????\n?1\n\n?2\n...\n\n?n\n\n?\n?????? , (3.12)\n\nonde a func?a?o f possui n para?metros, dados por ?i (com i = 1, 2, . . . ,n) e\n\n~xk\nT = [ xk1 xk2 . . . xkn ], com k = 1, 2, . . . ,N, e? um vetor com n regressores. Po-\n\ndemos reescrever a equac?a?o 3.12 da seguinte maneira:?\n??????\ny1\n\ny2\n...\n\nyN\n\n?\n?????? =\n\n?\n??????\nx11 x12 . . . x1n\n\nx21 x22 . . . x2n\n...\n\n...\n...\n\nxN 1 xN 2 . . . xN n\n\n?\n??????\n\n?\n??????\n?1\n\n?2\n...\n\n?n\n\n?\n?????? ,\n\n~y = X~?. (3.13)\n\nNo caso em que n = N, ou seja, quando existem o mesmo nu?mero de restric?o?es que\n\nde para?metros, pode-se encontrar o vetor de para?metros do sistema fazendo-se:\n\n~? = X?1~y, (3.14)\n\ndesde que X seja na?o singular.\n\nPor exemplo, supondo que temos dois pontos P1 e P2 em R2 dados pelas coordenadas\nPi = (xi,yi), sendo: P1 = (1, 2) e P2 = (2, 3). Deseja-se encontrar a reta que melhor se\n\najusta a estes pontos.\n\n\n\nIdentificac?a?o de Sistemas 23\n\nA equac?a?o de uma reta e? dada por:\n\ny = ?1 + ?2x. (3.15)\n\nAssim, podemos escrever o conjunto de restric?o?es como sendo:\n\n2 = ?1 + ?2,\n\n3 = ?1 + 2?2. (3.16)\n\nNa forma matricial, com o formato da equac?a?o 3.13 temos:[\n2\n\n3\n\n]\n=\n\n[\n1 1\n\n1 2\n\n][\n?1\n\n?2\n\n]\n. (3.17)\n\nPode-se encontrar o vetor de para?metros ~? = [ ?1 ?2 ]\nT com o uso da equac?a?o 3.14,\n\nresultando em ~? = [ 1 1 ]T e, por consequ?e?ncia, y = 1 + x.\n\nA soluc?a?o da equac?a?o matricial 3.13 possui tre?s casos:\n\n\u2022 Quando posto(X) = posto( [X ~y] ) = n, o sistema possui uma soluc?a?o u?nica, que\ne? o caso da equac?a?o 3.17;\n\n\u2022 Quando posto(X) = posto( [X ~y] ) &lt;n, o sistema possui infinitas soluc?o?es;\n\n\u2022 Finalmente, quando posto(X) &lt;posto( [X ~y] ), o sistema na?o possui soluc?a?o.\n\nPor exemplo, tomando-se um conjunto de N = 12 pontos mostrados na figura 3.1,\n\nna?o conseguimos encontrar uma reta que passe por todos os pontos do gra?fico. Em\n\ngeral procura-se uma reta que melhor se encaixe aos pontos apresentados. Para cada\n\nponto, havera? uma dista?ncia ? entre a reta e o ponto em questa?o, conforme mostrado\n\nna figura 3.1, sendo essa dista?ncia chamada de res??duo. O res??duo corresponde ao erro\n\nque o modelo encontrado comete em descrever a varia?vel y. Para cada restric?a?o i (com\n\ni = 1, 2, . . . ,N), o res??duo ?i e? definido como:\n\n?i = yi ? [ xi1 xi2 . . . xin ]\n\n?\n??????\n??1\n\n??2\n...\n\n??n\n\n?\n?????? ,\n\n?i = yi ? ~xiT\n~?\n?, (3.18)\n\n\n\nIdentificac?a?o de Sistemas 24\n\nFigura 3.1: Exemplo de res??duos na equac?a?o de uma reta\n\nonde o acento circunflexo em ?? indica que estamos tratando de uma estimativa dos\n\npara?metros.\n\nPode-se escrever os res??duos numa equac?a?o matricial, levando-se em considerac?a?o\n\ntodas as restric?o?es, da seguinte forma:?\n??????\n?1\n\n?2\n...\n\n?N\n\n?\n?????? =\n\n?\n??????\ny1\n\ny2\n...\n\nyN\n\n?\n?????? ?\n\n?\n??????\nx11 x12 . . . x1n\n\nx21 x22 . . . x2n\n...\n\n...\n...\n\nxN 1 xN 2 . . . xN n\n\n?\n??????\n\n?\n??????\n??1\n\n??2\n...\n\n??n\n\n?\n?????? ,\n\n~? = ~y ? X~??. (3.19)\n\nO me?todo dos m??nimos quadrados busca minimizar o somato?rio do quadrado dos\n\nres??duos, sendo o somato?rio do quadrado dos res??duos definido por:\n\nJM Q =\nN?\n\ni=1\n\n?(i)2 = ? ~? ?2 = ~? T ~? (3.20)\n\nSubstituindo-se a equac?a?o 3.19 na equac?a?o 3.20 temos:\n\nJM Q = (~y ? X\n~?\n?)T (~y ? X~??). (3.21)\n\n\n\nIdentificac?a?o de Sistemas 25\n\nPara minimizar a func?a?o de custo JM Q em relac?a?o a\n~?\n? deve-se fazer:\n\n?JM Q\n\n?\n~?\n?\n\n= 0. (3.22)\n\nO que se consegue com [4]:\n\n~?\n? = [XT X]?1XT ~y, (3.23)\n\nque fornece uma estimativa para o vetor de para?metros, com base em um conjunto de\n\nrestric?o?es do modelo proposto, minimizando-se o somato?rio do quadrado dos res??duos.\n\nE? interessante notar que [XT X]?1 existe se e somente se X tem posto completo, ou\n\nseja, se posto(X) = n.\n\nPode-se ainda escrever a estimativa dos para?metros, de uma forma mais geral:\n\n~?\n? = A~y, (3.24)\n\nonde A e? o estimador utilizado. No caso do estimador de m??nimos quadrados,\n\nA = [XT X]?1XT .\n\n3.6.2 O Me?todo de MQ Usado Para Estimar Para?metros de\n\nModelos Autoregressivos\n\nConsidere um modelo do tipo ARX como o mostrado na equac?a?o 2.4, com um atraso\n\nde transporte na entrada de tal forma que a entrada u so? passe a afetar a sa??da y a partir\n\ndo instante de tempo discreto nk, ou seja, que os coeficientes b0 = . . . = bnk?1 = 0.\n\nExpandindo-se os polino?mios e rearranjando-se os termos, temos que:\n\ny(k) = a1y(k ? 1) + \u00b7 \u00b7 \u00b7 + anyy(k ? ny)\n\n+ bnku(k ? nk) + b1+nku(k ? nk ? 1) + \u00b7 \u00b7 \u00b7 + bnu+nku(k ? nk ? nu) + ?(k).\n(3.25)\n\n\n\nIdentificac?a?o de Sistemas 26\n\nComparando-se a equac?a?o 3.25 com a equac?a?o 3.18 e isolando-se y(k), temos que:\n\ny(k) =\n[\ny(k ? 1) \u00b7 \u00b7 \u00b7 y(k ? ny) u(k ? nk) \u00b7 \u00b7 \u00b7 u(k ? nk ? nu)\n\n]\n?\n????????????\n\na1\n...\n\nany\n\nbnk\n...\n\nbnu+nk\n\n?\n????????????\n\n+ ?(k),\n\ny(k) = ?T (k)\n~?\n? + ?(k), (3.26)\n\nonde ?T (k) =\n[\ny(k ? 1) . . . y(k ? ny) u(k ? nk) . . . u(k ? nk ? nu)\n\n]\ne? o vetor\n\ncom os regressores e\n~?\n? =\n\n[\na1 \u00b7 \u00b7 \u00b7 any bnk \u00b7 \u00b7 \u00b7 bnk+nu\n\n]T\ne? o vetor com os para?metros\n\na serem estimados, ambos com dimensa?o n? = ny + nu.\n\nTomando-se um conjunto de N restric?o?es, forma-se a equac?a?o matricial:?\n??????\ny1\n\ny2\n...\n\nyN\n\n?\n?????? =\n\n?\n??????\n?T1\n\n?T2\n...\n\n?TN\n\n?\n??????\n\n?\n??????\n\n??1\n\n??2\n...\n\n??n?\n\n?\n?????? +\n\n?\n??????\n?1\n\n?2\n...\n\n?N\n\n?\n??????\n\n~y = ?\n~?\n? + ~?. (3.27)\n\nPor exemplo, supondo um modelo ARX com ny = 2, nu = 2 e nk = 1, a equac?a?o\n\nque representa o modelo sera?:\n\ny(k) = a1y(k ? 1) + a2y(k ? 2) + b1u(k ? 1) + b2u(k ? 2) + ?(k), (3.28)\n\nou ainda:\n\ny(k) =\n[\ny(k ? 1) y(k ? 2) u(k ? 1) u(k ? 2)\n\n]\n?\n??????\na1\n\na2\n\nb1\n\nb2\n\n?\n?????? + ?(k). (3.29)\n\nTomando-se uma massa de dados, podemos escrever um conjunto de restric?o?es sob\n\n\n\nIdentificac?a?o de Sistemas 27\n\na forma: ?\n??????\ny(0)\n\ny(1)\n\ny(2)\n...\n\n?\n?????? =\n\n?\n??????\ny(?1) y(?2) u(?1) u(?2)\ny(0) y(?1) u(0) u(?1)\ny(1) y(0) u(1) u(0)\n\n...\n...\n\n...\n\n?\n??????\n\n?\n??????\na1\n\na2\n\nb1\n\nb2\n\n?\n?????? +\n\n?\n??????\n?(0)\n\n?(1)\n\n?(2)\n...\n\n?\n?????? ,\n\n~y = ?\n~?\n? + ~?, (3.30)\n\nque e? ana?loga a? equac?a?o 3.19. Assim, a estimativa dos para?metros de um modelo\n\nauto-regressivo e?:\n\n~?\n? = [?T ?]?1?T ~y. (3.31)\n\n3.6.3 Polarizac?a?o de Estimadores\n\nSeja ~? um vetor de para?metros \u201creal\u201d que define um sistema e\n~?\n? o seu valor estimado.\n\nDefine-se a polarizac?a?o (tambe?m conhecida por vie?s ou bias) como:\n\n~b = E[\n~?\n?] ? ~?. (3.32)\n\nDeve-se notar que ~? e? um valor determin??stico, ainda que desconhecido, e\n~?\n? e? uma\n\nvaria?vel aleato?ria, possuindo valores diferentes para cada realizac?a?o, sendo por isso\n\nusada a esperanc?a matema?tica para o ca?lculo da polarizac?a?o b.\n\nDado um modelo do tipo y(k) = ?T (k)~? + e(k), linear em ~? (onde e(k) e? um erro\n\naleato?rio introduzido no sistema) pode-se estimar os para?metros deste modelo com\n\num estimador do tipo\n~?\n? = A~y, como mostrado na equac?a?o 3.24. A matriz A e? uma\n\nmatriz que depende dos elementos da matriz de regressores (A = [?T ?]?1?T no caso\n\ndo estimador de m??nimos quadrados). Substituindo-se a equac?a?o 3.24 na equac?a?o 3.32\n\ne manipulando-a, chega-se a:\n\n~b = (E[A? ? I]) ~? + E[A~e]. (3.33)\n\nPara que a polarizac?a?o do estimador seja nula (~b = 0 na equac?a?o 3.33) deve-se\n\natender aos seguintes requisitos [4]:\n\n1. A matriz A deve ser tal que A? = I.\n\n\n\nIdentificac?a?o de Sistemas 28\n\n2. Os elementos de A na?o devem estar correlacionados com o vetor de erro ~e, de\n\nforma que se possa dizer que E[A~e] = E[A]E[~e].\n\n3. O erro deve ter me?dia zero, ou seja, E[~e] = 0.\n\nNo caso do estimador de m??nimos quadrados, a matriz A = [?T ?]?1?T . Portanto\n\no primeiro requisito listado e? atendido. Se o erro que incide sobre o sistema na?o tiver\n\nme?dia nula (terceiro requisito), basta acrescentar um termo constante a ser estimado\n\njunto com os outros para?metros. Desta forma, o requisito mais importante a ser avali-\n\nado para o estimador de MQ e? o segundo, ou seja, os elementos de A na?o devem estar\n\ncorrelacionados com o vetor de erro ~e. Esses requisitos sa?o todos atendidos quando o\n\nru??do e(k) e? branco.\n\nAs representac?o?es ARMAX e NARMAX sa?o duas representac?o?es que sofrem com\n\na polarizac?a?o, ou seja, os para?metros estimados pelo estimador de m??nimos quadrados\n\nsera?o sistematicamente diferentes dos para?metros reais do sistema. Para contornar\n\neste problema, recorre-se aos estimadores na?o-polarizados que de alguma forma tentam\n\ntransformar a equac?a?o de regressa?o, fazendo com que o vetor de erros passe a ser branco\n\ne, assim, seja poss??vel utilizar o me?todo dos m??nimos quadrados originalmente descrito.\n\nDentre tais estimadores na?o polarizados, podemos citar o Estimador Estendido de\n\nM??nimos Quadrados (EMQ), o Estimador Generalizado de M??nimos Quadrados (GMQ)\n\ne o Me?todo das Varia?veis Instrumentais (VI), todos eles descritos em [4].\n\n3.7 Crite?rios de Informac?a?o\n\nUma vez que tenham sido gerados diversos modelos para um sistema, e? necessa?rio\n\ncompara?-los para ver qual deles e? o mais adequado para o uso em questa?o. Uma das\n\nformas de verificar a adequac?a?o de um modelo e? verificar o qua?o bem ele se encaixa\n\naos dados utilizados para estimar os para?metros. E? claro que aumentando-se o nu?mero\n\nde para?metros do modelo, o nu?mero de graus de liberdade do modelo aumenta e,\n\npor consequ?e?ncia, ele passa a se \u201cencaixar\u201d melhor nos dados. No limite, quando\n\ntemos o mesmo nu?mero de para?metros que de restric?o?es, a matriz de regressores ?\n\npassa a ser quadrada e pode-se calcular o vetor de para?metros diretamente, resolvendo-\n\nse um sistema linear. Um modelo sub-parametrizado possui menos para?metros do\n\nque os necessa?rios para representar a dina?mica do sistema e e? incapaz de descreve?-la\n\n\n\nIdentificac?a?o de Sistemas 29\n\nadequadamente. Ja? um modelo sobre-parametrizado acaba descrevendo mais do que\n\na dina?mica do sistema, passando a descrever tambe?m a realizac?a?o espec??fica do ru??do\n\nque incidiu sobre o sistema durante o ensaio, na?o sendo suficientemente gene?rico. Ou\n\nseja, um modelo sobre-parametrizado seria inu?til diante de uma realizac?a?o diferente do\n\nru??do. O modelo ideal situa-se enta?o na fronteira entre um modelo sub-parametrizado\n\ne de um modelo sobre-parametrizado.\n\nPara decidir se o nu?mero de para?metros utilizados em determinado modelo e? o\n\nideal, pode-se recorrer aos crite?rios de informac?a?o. Eles atribuem um ??ndice ao modelo,\n\npenalizando por um lado o mal ajuste aos dados e por outro o excesso de para?metros. O\n\nmodelo ideal sera? aquele com o menor valor do crite?rio de informac?a?o utilizado dentre\n\ntodos os modelos candidatos.\n\nO Crite?rio de Informac?a?o de Akaike (AIC - do ingle?s Akaike Information Criterium)\n\n[6] e? definido por:\n\nAIC(n?) = N ln(?\n2\nerro) + 2n?, (3.34)\n\nonde n? e? o nu?mero de para?metros do modelo, N e? o nu?mero de restric?o?es e ?\n2\nerro e? a\n\nvaria?ncia do erro de modelagem (varia?ncia dos res??duos). O valor de AIC sera? maior\n\n(pior) quanto maior for a varia?ncia do erro de modelagem (o modelo na?o se ajusta bem\n\naos dados), ou quando mais para?metros tiver um modelo (maior a sua complexidade).\n\nLeontaritis e Billings [26] argumentam que o crite?rio de Akaike pode levar a? escolha\n\nde modelos sobre-parametrizados, propondo que em vez dele se utilize uma equac?a?o\n\nsimilar, mas que penalize de forma mais dura o nu?mero de termos do modelo:\n\nC(n?) = N ln(?\n2\nerro) + 4n?, (3.35)\n\nno entanto o AIC e? largamente utilizado na identificac?a?o de sistemas e sera? utilizado\n\nneste trabalho tal como mostrado na equac?a?o 3.34.\n\nOutro crite?rio similar e? o Erro Final de Predic?a?o, ou em ingle?s, Final Prediction\n\nError (FPE) [6], definido por:\n\nFPE(n?) = N ln(?\n2\nerro) + N ln\n\n(\nN + n?\nN ? n?\n\n)\n. (3.36)\n\nO valor absoluto dos ??ndices dados pelas equac?o?es 3.34 e 3.36 na?o e? importante. O\n\nque e? importante e? encontrar dentre um conjunto de modelos candidatos aquele que\n\npossui o valor m??nimo para o ??ndice em ana?lise. Deve-se lembrar que estes sa?o crite?rios\n\nestat??sticos para definir o nu?mero de para?metros e na?o garantem que o modelo escolhido\n\nseja o?timo em termos de validade para a aplicac?a?o pretendida.\n\n\n\nIdentificac?a?o de Sistemas 30\n\n3.8 Ferramentas Utilizadas na Identificac?a?o de Sis-\n\ntemas na?o-Lineares\n\nUm modelo do tipo NARMAX polinomial e? um modelo na?o-linear na relac?a?o entre a\n\nentrada e a sa??da, mas e? linear nos para?metros, de forma que pode-se utilizar a equac?a?o\n\nmatricial 3.27. Os vetores que compo?em a matriz ? sa?o mostrados na equac?a?o 2.16.\n\nCaso o conjunto de termos do modelo seja pequeno, a matriz ? tera? poucas colunas\n\ne portanto e? poss??vel encontrar o valor de\n~?\n? com a aplicac?a?o da equac?a?o 3.31. Deve\n\nser notado que da entrada e sa??da utilizadas na estimac?a?o de para?metros de modelos\n\nNARMAX na?o se desconta a me?dia dos dados, tal como feito na identificac?a?o linear\n\n(onde se trabalha com ?y(k) = y(k) ? y0 e ?u(k) = u(k) ? u0), trabalhando-se com\nos dados colhidos na entrada (u(k)) e sa??da (y(k)) do sistema diretamente [23].\n\nNo entanto, tipicamente o nu?mero de termos candidatos para um modelo NARMAX\n\ne? grande, levando a um problema de mal condicionamento nume?rico. Assim, utilizam-se\n\nalgoritmos alternativos para a estimac?a?o dos para?metros. Segundo Chen et al [11], ha?\n\ntre?s maneiras via?veis para determinar\n~?\n?: solucionar a equac?a?o normal por eliminac?a?o\n\ngaussiana ou formando a decomposic?a?o de Cholesky de ?T ?; formar uma decomposic?a?o\n\nortogonal de ?; ou formar uma decomposic?a?o de valores singulares (SVD) de ?. Cada\n\num dos tre?s me?todos possui suas vantagens e desvantagens. Neste trabalho utiliza-se\n\na decomposic?a?o ortogonal de ?, que e? o me?todo mais preciso, ainda que a?s custas de\n\num maior esforc?o computacional.\n\nA sec?a?o 3.8.1 fala sobre a decomposic?a?o ortogonal de ? e a sec?a?o 3.8.2 mostra\n\numa alterac?a?o no algoritmo de ortogonalizac?a?o que permite classificar os regressores\n\npor ordem de importa?ncia, servindo como ferramenta para a selec?a?o de estrutura do\n\nmodelo. Em seguida sa?o definidos os coeficientes de agrupamento (sec?a?o 3.8.3) e seu\n\nuso no ca?lculo da caracter??stica esta?tica dos modelos (sec?a?o 3.8.4).\n\n3.8.1 Algoritmos MQ Ortogonais\n\nA ortogonalizac?a?o da matriz ? pode ser feita com va?rios algoritmos, como por\n\nexemplo atrave?s do me?todo cla?ssico de Gram-Schmidt (CGS), do me?todo modificado\n\nde Gram-Schmidt e atrave?s da transformac?a?o de Householder. A descric?a?o destes\n\nalgoritmos pode ser vista em [19] e [34]. A aplicac?a?o destes me?todos para modelos\n\n\n\nIdentificac?a?o de Sistemas 31\n\nNARMAX e? mostrada em [11]. A seguir descreve-se o me?todo da transformac?a?o de\n\nHouseholder utilizada neste trabalho.\n\nSendo ? uma matriz de dimensa?o N \u00d7n? com posto pleno de colunas, ela pode ser\ndecomposta em:\n\n? = QR, (3.37)\n\nonde Q e? uma matriz ortogonal (QT Q = I) com dimensa?o N \u00d7 n? e R e? uma matriz\ntriangular superior com dimensa?o n? \u00d7 n?.\n\nForma-se enta?o a matriz Q? expandindo-se a matriz Q com (N ? n?) colunas orto-\nnormais, de forma a gerar um conjunto de N vetores ortogonais:\n\nQ? = [Q : q?n?+1 . . . q?N ]. (3.38)\n\nAssim:\n\n? = Q?R? = Q?\n\n[\nR\n\n0\n\n]\n(3.39)\n\nAplicando-se Q?T ao vetor contendo a sa??da do sistema (~y), encontramos:\n\nQ?T ~y =\n\n[\n~y1\n\n~y2\n\n]\n, (3.40)\n\nonde ~y1 e? um vetor com n? elementos e ~y2 e? um vetor com (N ? n?) elementos.\n\nReescrevendo-se a equac?a?o 3.30 e calculando-se a norma, obte?m-se:\n\n? ~? ? = ?~y ? ?~?? ?. (3.41)\n\nDas equac?o?es 3.41 e 3.20, chega-se a:\n\nJM Q = ? ~? ? = ?~y ? ?\n~?\n? ? (3.42)\n\nMultiplicando ambos os lados da equac?a?o 3.42 por ?Q?T ? e manipulando-a:\n\nJM Q = ?Q?T ~y ? R\n~?\n? ? (3.43)\n\nFinalmente, recorrendo-se a? equac?a?o 3.40:\n\nJM Q = ?~y1 ? R\n~?\n? ? + ?~y2 ?. (3.44)\n\n\n\nIdentificac?a?o de Sistemas 32\n\nA estimativa que minimiza o crite?rio de m??nimos quadrados descrito na equac?a?o\n\n3.44 pode ser enta?o obtida solucionando-se o sistema triangular:\n\nR\n~?\n? = ~y1 (3.45)\n\ne a soma do quadrado dos res??duos (JM Q) sera? enta?o ?~y2 ?.\n\nAntes de mostrar como se chega a? matriz Q?T , conve?m definir a matriz de regressores\n\nmodificada ??:\n\n?? = [? : ~y ], (3.46)\n\nque e? formada pelas colunas da matriz ?, tendo sido adicionada como u?ltima coluna\n\no vetor ~y. Ao iniciar o algoritmo, a matriz ??(0) = ??, e com a aplicac?a?o da k-e?sima\n\ntransformac?a?o de Householder (H(k)) sera?o obtidas as matrizes ??(1) = H(1)??(0), ??(2) =\n\nH(2)??(1) e assim por diante.\n\nA matriz Q?T pode ser encontrada calculando-se:\n\nQ?T = H(?)H(??1) . . . H(1) (3.47)\n\nsendo a k-e?sima transformac?a?o de Householder dada por:\n\nH(k) = I ? ?(k)~v (k)(~v (k))T , (3.48)\n\ncom\n\n?(k) =\n\n???? N?\ni=k\n\n(??\n(k?1)\nik )\n\n2 (3.49)\n\n?(k) =\n1\n\n?(k)(?(k) + |??(k?1)kk |)\n(3.50)\n\n~v (k) = [v\n(k)\n1 . . . v\n\n(k)\nN ]\n\nT (3.51)\n\nv\n(k)\ni =\n\n????\n???\n\n0, para i &lt;k\n\n??\n(k?1)\nkk + sgn[??\n\n(k?1)\nkk ]?\n\n(k), para i = k\n\n??\n(k?1)\nik , para i > k\n\n, (3.52)\n\nsendo ??ij o elemento da matriz ?? situado na i-e?sima linha e j-e?sima coluna.\n\n\n\nIdentificac?a?o de Sistemas 33\n\nA aplicac?a?o de ? transformac?o?es de Householder a? matriz ?? (ver equac?a?o 3.47)\n\npermite chegar a? matriz ??(?):\n\n??(?) = Q?T ??(0) =\n\n[\nR ~y1\n\n0 ~y2\n\n]\n(3.53)\n\nque possibilita solucionar o problema de estimac?a?o de para?metros bastando para isso\n\nsolucionar o sistema linear triangular dado na equac?a?o 3.45.\n\nConve?m notar que a matriz Q?T na?o precisa necessariamente ser calculada, ja? que\n\nnos interessa somente o valor de ??(?) e esse pode ser calculado iterativamente com o\n\nuso da equac?a?o:\n\n??(k) = H(k)??(k?1) k = 1, . . . ,?. (3.54)\n\n3.8.2 A Taxa de Reduc?a?o de Erro\n\nOs algoritmos de m??nimos quadrados ortogonais sa?o de grande utilidade por permi-\n\ntir contornar os problemas de mal condicionamento geralmente existentes no problema\n\nde estimac?a?o de para?metros de modelos NARMAX polinomiais. Ale?m disso, uma mo-\n\ndificac?a?o no algoritmo permite detectar dentre o conjunto de regressores candidatos,\n\nquais sa?o os realmente importantes para explicar a sa??da em func?a?o da entrada.\n\nDado um modelo NARMAX descrito por (ver equac?a?o 2.15):\n\ny(k) =\n\nn??\ni=1\n\n??i?i(k) + ?(k), (3.55)\n\nonde ??i sa?o os para?metros associados aos regressores ?i(k) (com i = 1, . . . ,n?), avaliados\n\nno instante de tempo k, pode-se derivar um modelo auxiliar:\n\ny(k) =\n\nn??\ni=1\n\ng?iwi(k) + ?(k), (3.56)\n\nonde g?i e? o para?metro associado ao regressor ortogonal wi (com i = 1, . . . ,n?).\n\nTomando um conjunto de N restric?o?es para a equac?a?o 3.56 (fazendo-se k =\n\n1, . . . ,N), pode-se escrever a equac?a?o matricial:\n\n~y = W~?g + ~?. (3.57)\n\n\n\nIdentificac?a?o de Sistemas 34\n\nA soma dos quadrados da varia?vel dependente ~y e? enta?o [11]:\n\nN?\ni=1\n\ny(k)2 = ~y T ~y = ?~y,~y? =\nn??\ni=1\n\ng2i ?~wi, ~wi? + ?~?, ~?? (3.58)\n\nonde ?\u00b7, \u00b7? significa o produto interno.\n\nA Taxa de Reduc?a?o de Erro (Error Reduction Ratio - ERR) e? enta?o definida como:\n\n[ERR]i =\ng2i ?~wi, ~wi?\n?~y,~y?\n\n(3.59)\n\ne representa a frac?a?o da sa??da que a inclusa?o do i-e?simo regressor consegue descrever.\n\nQuanto maior for o ERR de um termo, maior a sua importa?ncia para o modelo. Termos\n\ncom ERR baixo na?o contribuem significativamente para o modelo e podem ser exclu??dos\n\ndo modelo final. Assim, pode-se determinar a estrutura de um modelo escolhendo\n\naqueles termos que possuem os maiores valores de ERR.\n\nO me?todo de Householder descrito na sec?a?o 3.8.1 pode ser adaptado para incluir o\n\nERR. Inicia-se com a matriz ??(0) (ver equac?a?o 3.46):\n\n??(0) = [? : ~y] = [??\n(0)\n1 . . . ??\n\n(0)\nn?\n\n: ~y (0)] (3.60)\n\ne chama-se de Rk o menor principal da matriz R (sendo esta definida na equac?a?o 3.39).\n\nApo?s a aplicac?a?o de k ? 1 transformac?o?es de Householder, a matriz ??(0) e? transfor-\nmada em:\n\n??(k?1) =\n\n[\nRk?1\n\n0\n??\n\n(k?1)\nk . . . ??\n\n(k?1)\nn?\n\n: ~y (k?1)\n\n]\n. (3.61)\n\nA soma do quadrado dos res??duos sera? dada por (ver equac?o?es 3.44 e 3.45):\n\nJ\n(k?1)\nM Q =\n\nN?\ni=k\n\n(y\n(k?1)\ni )\n\n2, (3.62)\n\nonde y\n(k?1)\ni e? o i-e?simo elemento do vetor ~y apo?s a aplicac?a?o de k ? 1 transformac?o?es\n\nde Householder. Vale notar que a aplicac?a?o da j-e?sima transformac?a?o de Householder\n\n(H(j)) deixa inalteradas as primeiras j ? 1 linhas de ??(j?1).\n\nAplicando-se a k-e?sima transformac?a?o de Householder, a soma do quadrado dos\n\nres??duos passa a ser:\n\nJ\n(k)\nM Q =\n\nN?\ni=k+1\n\n(y\n(k)\ni )\n\n2 =\nN?\n\ni=k\n\n(y\n(k?1)\ni )\n\n2 ? (y(k)k )\n2 (3.63)\n\nJ\n(k)\nM Q = J\n\n(k?1)\nM Q ? (y\n\n(k)\nk )\n\n2. (3.64)\n\n\n\nIdentificac?a?o de Sistemas 35\n\nBusca-se enta?o selecionar qual coluna de ? (dentre as colunas ??\n(k?1)\nk , . . . , ??\n\n(k?1)\nn? )\n\nminimiza o valor de (y\n(k)\nk )\n\n2, ou em outras palavras, qual e? o pro?ximo regressor a ser\n\ninclu??do no modelo.\n\nPara determinar qual coluna deve ser inclu??da, considere [11]:\n\na\n(k)\nj =\n\n???? N?\ni=k\n\n(??\n(k?1)\nij )\n\n2 (3.65)\n\nb\n(k)\nj =\n\nN?\ni=k\n\n??\n(k?1)\nij y\n\n(k?1)\ni (3.66)\n\npara j = k, . . . ,n?, onde ??\n(k?1)\nij e? o elemento da matriz ??\n\n(k?1) situado na i-e?sima linha\n\ne j-e?sima coluna, ou de forma equivalente, e? o i-e?simo elemento do vetor ?j.\n\nO valor de ERR dos (n? ? (k ? 1)) regressores ainda na?o inclu??dos no modelo na\nk-e?sima iterac?a?o pode ser calculado com o uso da equac?a?o [4]:\n\n[ERR]\n(k)\nj =\n\n(\nb\n(k)\nj\n\n)2\na\n\n(k)\nj ?~y , ~y?\n\npara j = k, . . . ,n? (3.67)\n\nAssim, na k-e?sima iterac?a?o calcula-se o valor de ERR de todos os regressores candi-\n\ndatos ainda na?o inclu??dos no modelo e escolhe-se aquele com o mais alto valor de ERR.\n\nSendo jm o ??ndice do regressor com maior ERR, basta enta?o trocar na matriz ??\n(k?1) a\n\ncoluna jm com a coluna k e aplicar a k-e?sima transformac?a?o de Householder a? matriz\n\nresultante.\n\nO nu?mero de termos a ser inclu??do no modelo final pode ser determinado com o uso\n\nde um crite?rio de parada tal como [11]:\n\n1 ?\nM?\ni=1\n\n[ERR]i &lt;?, (3.68)\n\nonde M e? o nu?mero de regressores ja? inclu??dos no modelo e (0 &lt;? ? 1) e? a tolera?ncia\ndesejada.\n\nOutra maneira muito utilizada e? o uso paralelo de um crite?rio de informac?a?o como o\n\ncrite?rio de Akaike. A cada termo inclu??do, simula-se o modelo e calculam-se os res??duos.\n\nO modelo com menor AIC sera? o modelo com a quantidade ideal de termos.\n\n\n\nIdentificac?a?o de Sistemas 36\n\n3.8.3 Agrupamento de termos\n\nConsiderando-se um modelo NARMAX polinomial descrito pela equac?a?o abaixo\n\n(que e? equivalente a? equac?a?o 2.12) [2]:\n\ny(k) =\n??\nm=0\n\nm?\np=0\n\nny ,nu?\nn1,nm\n\ncp,m?p(n1, . . . ,nm)\n\np?\ni=1\n\ny(k ? ni)\nm?\n\ni=p+1\n\nu(k ? ni), (3.69)\n\nonde\nny ,nu?\nn1,nm\n\n?\nny?\n\nn1=1\n\n\u00b7 \u00b7 \u00b7\nnu?\n\nnm=1\n\n(3.70)\n\ne uma janela de dados suficientemente suave onde seja poss??vel fazer as seguintes apro-\n\nximac?o?es:\n\ny(k ? 1) ? y(k ? 2) ? . . . ? y(k ? ny) (3.71)\n\nu(k ? 1) ? u(k ? 2) ? . . . ? u(k ? nu). (3.72)\n\nPodemos enta?o escrever a seguinte aproximac?a?o:\n\ny(k) ?\nny ,nu?\nn1,nm\n\ncp,m?p(n1, . . . ,nm)\n??\nm=0\n\nm?\np=0\n\ny(k ? 1)pu(k ? 1)m?p. (3.73)\n\nOs agrupamentos de termos ?ypum?p sa?o conjuntos que conte?m os termos do tipo\n\nypum?p para m = 0, . . . ,` e p = 0, . . . ,m. As constantes que aparecem na equac?a?o\n\n3.73 sa?o chamadas de coeficientes de agrupamentos e sa?o representadas por ?ypum?p\n\n[3]. Os coeficientes de agrupamento de termos sa?o simplesmente o somato?rio de todos\n\nos termos do modelo que pertencem a um dado agrupamento (ou seja, que possuem o\n\nmesmo formato).\n\nPor exemplo, no caso do modelo com grau ` = 2, ny = 2 e nu = 1 mostrado na\n\nequac?a?o 2.14 e repetido abaixo:\n\ny(k) = c0,0 + c1,0(1)y(k ? 1) + c1,0(2)y(k ? 2) + c0,1(1)u(k ? 1)\n\n+ c2,0(1, 1)y\n2(k ? 1) + c2,0(1, 2)y(k ? 1)y(k ? 2) + c2,0(2, 2)y2(k ? 2)\n\n+ c1,1(1, 1)y(k ? 1)u(k ? 1) + c1,1(2, 1)y(k ? 2)u(k ? 1),\n\n\n\nIdentificac?a?o de Sistemas 37\n\ntemos os seguintes agrupamentos de termos:\n\n?0 = {c0,0} (3.74)\n\n?u = {c0,1(1)u(k ? 1)} (3.75)\n\n?y = {c1,0(1)y(k ? 1),c1,0(2)y(k ? 2)} (3.76)\n\n?y2 = {c2,0(1, 1)y2(k ? 1),c2,0(1, 2)y(k ? 1)y(k ? 2),c2,0(2, 2)y2(k ? 2)} (3.77)\n\n?yu = {c1,1(1, 1)y(k ? 1)u(k ? 1),c1,1(2, 1)y(k ? 2)u(k ? 1)} (3.78)\n\nOs coeficientes de agrupamento deste modelo sa?o:\n\n?0 = c0,0 (3.79)\n\n?u = c0,1(1) (3.80)\n\n?y = c1,0(1) + c1,0(2) (3.81)\n\n?y2 = c2,0(1, 1) + c2,0(1, 2) + c2,0(2, 2) (3.82)\n\n?yu = c1,1(1, 1) + c1,1(2, 1) (3.83)\n\nDe forma que em uma janela de dados suficientemente suave, podemos escrever:\n\ny(k) ? ?0 + ?u \u00b7 u(k ? 1) + ?y \u00b7 y(k ? 1)\n\n+ ?y2 \u00b7 y2(k ? 1) + ?yu \u00b7 y(k ? 1)u(k ? 1). (3.84)\n\nO uso dos agrupamentos de termos facilita o ca?lculo da caracter??stica esta?tica do\n\nmodelo, ale?m de ajudar na detecc?a?o da estrutura. Para tal empreitada o que se faz e?\n\ngerar uma fam??lia de modelos com nu?mero crescente de termos selecionados pelo ERR.\n\nDepois trac?am-se gra?ficos com o valor dos coeficientes de agrupamento em func?a?o do\n\nnu?mero de termos e buscam-se ind??cios de que algum agrupamento e? espu?rio (e portanto\n\npode ser eliminado do conjunto de termos candidatos). Alguns ind??cios procurados nos\n\ngra?ficos para caracterizar agrupamentos espu?rios sa?o [2, 4]:\n\n\u2022 Inclusa?o tardia de um dado agrupamento (o coeficiente do agrupamento sera?\ndiferente de zero somente para um valor \u201cgrande\u201d do nu?mero de termos)\n\n\u2022 Valor absoluto de um coeficiente muito pequeno comparado com os demais ou\ndecrescentes com o aumento do nu?mero de termos (devem ser descontados os\n\nproblemas decorrentes de mal-condicionamento nume?rico)\n\n\u2022 Coeficientes com valores oscilato?rios\n\n\n\nIdentificac?a?o de Sistemas 38\n\n3.8.4 Caracter??stica esta?tica\n\nA caracter??stica esta?tica de um sistema corresponde a? relac?a?o alge?brica existente\n\nentre uma entrada constante e a sa??da do sistema em regime permanente. A carac-\n\nter??stica esta?tica de um modelo na?o-linear a tempo discreto e? definida pelos seus pontos\n\nfixos de primeira ordem, sendo os pontos fixos de primeira ordem de uma equac?a?o a\n\ndiferenc?as definidos por:\n\nx(k + 1) = x(k) = x? (3.85)\n\nonde x(\u00b7) e? o vetor de estados do sistema. Os pontos fixos de primeira ordem do caso\ndiscreto correspondem aos pontos de equil??brio de uma equac?a?o diferencial cont??nua.\n\nUma vez que x? e? atingido, as sucessivas iterac?o?es na?o sa?o capazes de tirar o sistema\n\ndeste ponto [29].\n\nNo caso de um modelo NARMAX, os pontos fixos sa?o definidos como sendo aqueles\n\npontos onde y(k) = y(k + i), ?i ? Z. Para o caso de modelos auto?nomos, os pontos\nfixos podem ser calculados com o uso dos coeficientes de agrupamento como descrito\n\npor Aguirre e Mendes [2]. Para o caso na?o auto?nomo, uma a?lgebra similar e? utilizada,\n\npore?m considera-se que a entrada u? e? constante e serve como para?metro para definir a\n\nlocalizac?a?o dos pontos fixos. Para modelos de grau ` = 2, os pontos fixos do sistema\n\nna?o-auto?nomo podem ser calculados buscando y? que satisfac?a a seguinte equac?a?o de\n\nsegundo grau:\n\n(?y2 )y?\n2 + (?y + ?yuu? ? 1)y? + (?0 + ?uu? + ?u2u?2) = 0 (3.86)\n\nNo caso particular de um modelo com grau ` = 2 com coeficiente de agrupamento\n\n?y2 = 0, teremos somente um ponto fixo, dado por:\n\ny? = ?\n(?0 + ?uu? + ?u2u?\n\n2)\n\n(?y + ?yuu? ? 1)\n(3.87)\n\n3.9 Validac?a?o do Modelo\n\nComo ja? foi dito anteriormente, na modelagem ou identificac?a?o de um sistema,\n\nna?o se deseja um modelo que represente exatamente todas as caracter??sticas de um\n\nsistema, mas sim um modelo que aproxime satisfatoriamente algumas caracter??sticas\n\nde interesse. Validar um modelo significa verificar se o modelo encontrado representa\n\n\n\nIdentificac?a?o de Sistemas 39\n\nadequadamente as caracter??sticas de interesse do sistema. Basicamente ha? dois tipos\n\nde validac?a?o: validac?a?o estat??stica e validac?a?o dina?mica.\n\nA validac?a?o estat??stica busca verificar se um dado modelo conseguiu descrever tudo\n\no que e? poss??vel, em um conjunto de dados. Quando isso e? verificado, os res??duos (o que\n\nsobrou dos dados) devem ser puramente aleato?rios. Esta tarefa e? chamada de ana?lise\n\nde res??duos, onde os res??duos sa?o definidos por:\n\n?(k) = y(k) ? ?(k) T ~??. (3.88)\n\nNa identificac?a?o linear, busca-se satisfazer [28]:\n\nr??(?) = E[?(k)?(k ? ?)] = ?(k) (3.89)\n\nr?u(?) = E[?(k)u(k ? ?)] = 0 ?? (3.90)\n\nonde r?? e? a func?a?o de autocorrelac?a?o dos res??duos (ver equac?o?es 3.3 e 3.4), r?u e? a\n\nfunc?a?o de correlac?a?o cruzada entre os res??duos e a entrada (ver equac?o?es 3.1 e 3.2) e\n\n?(k) e? func?a?o delta de Dirac4. A equac?a?o 3.89 garante que os res??duos sa?o brancos e,\n\nportanto, a estimativa de para?metros na?o esta? polarizada. Por outro lado, a equac?a?o\n\n3.90 garante que o modelo e? gene?rico, ou seja, os res??duos obtidos na?o dependem da\n\nentrada do sistema utilizada para estimac?a?o de para?metros e o modelo pode ser usado\n\ncom um outro conjunto de dados.\n\nNo caso de modelos lineares, so? e? poss??vel explicar as relac?o?es lineares entre a\n\nentrada e a sa??da. Portanto eventuais correlac?o?es na?o-lineares detectadas na ana?lise de\n\nres??duos podem ser ignoradas, bastando ater-se a?s equac?o?es 3.89 e 3.90.\n\nQuando se lida com modelos na?o-lineares, busca-se modelar toda dina?mica do sis-\n\ntema, mesmo a na?o-linear. Assim, outros testes devem ser incorporados a? ana?lise de\n\nres??duos, como por exemplo [5]:\n\nr??u(?) = E[?(k)?(k ? ?)u(k ? ?)] = 0 ??\n\nru2? ?(?) = E[(u\n2(k) ? E[u2(k)]) ?(k ? ?)] = 0 ?? (3.91)\n\nru2? ?2 (?) = E[(u\n2(k) ? E[u2(k)]) ?2(k ? ?)] = 0 ??\n\n4A func?a?o Delta de Dirac, no caso discreto, e? definida como:\n\n?(k) =\n\n??\n?1 para k = 00 para k 6= 0\n\n\n\nIdentificac?a?o de Sistemas 40\n\nA validac?a?o estat??stica de um modelo garante que na?o existam correlac?o?es na?o\n\nmodeladas no modelo, mas na?o garante que o modelo tenha as caracter??sticas dina?micas\n\nde interesse. Faz-se necessa?rio enta?o a validac?a?o dina?mica dos dados.\n\nNa validac?a?o dina?mica do modelo, trabalha-se com um conjunto de dados diferente\n\ndaquele utilizado para estimac?a?o dos para?metros, para assegurar que o modelo em\n\nana?lise possui capacidade de generalizac?a?o. Esse conjunto de dados diferente pode vir\n\nde um segundo ensaio feito no sistema (tendo-se o cuidado de garantir que o segundo\n\nensaio tenha sido feito nas mesmas condic?o?es do primeiro) ou dividindo-se a massa\n\noriginal de dados em dois conjuntos, sendo um utilizado para estimac?a?o de para?metros\n\n(este conjunto e? chamado de dados de estimac?a?o) e o segundo utilizado para validac?a?o\n\ndos modelos (chamado de dados de validac?a?o).\n\nDuas maneiras utilizadas para a validac?a?o dina?mica de um modelo sa?o a ana?lise\n\nda caracter??stica esta?tica e o resultado da simulac?a?o livre. A comparac?a?o entre a\n\ncaracter??stica esta?tica de um modelo e a caracter??stica esta?tica do sistema real permite\n\navaliar se em regime permanente a sa??da do modelo e a do sistema real se equivalem\n\npara uma mesma entrada.\n\nPara avaliar o comportamento no transito?rio do sistema, pode-se utilizar a si-\n\nmulac?a?o livre (tambe?m conhecida por predic?a?o de infinitos passos a? frente), que consiste\n\nem aplicar no modelo uma entrada e comparar a sua sa??da com a sa??da do sistema ex-\n\ncitado pela mesma entrada. A ana?lise de um gra?fico contendo as sa??das do modelo e\n\ndo sistema permite avaliar o desempenho dina?mico do modelo em ana?lise. A figura 3.2\n\nmostra como e? feita a simulac?a?o livre de um modelo.\n\nFigura 3.2: Validac?a?o atrave?s da simulac?a?o livre de um modelo\n\nQuantitavamente, pode-se avaliar o desempenho dina?mico do modelo com o uso de\n\n\n\nIdentificac?a?o de Sistemas 41\n\n??ndices, como por exemplo a soma do quadrado dos res??duos, ou o ??ndice sugerido por\n\nLjung [27]:\n\najuste = 100 ?\n\n(\n1 ?\n\n?~?y ? ~y?\n?~y ? me?dia(~y)?\n\n)\n, (3.92)\n\nonde ~?y e? o vetor contendo a sa??da do modelo e ~y e? o vetor contendo a sa??da real\n\ndo sistema. Um modelo com ajuste = 100% corresponde a um modelo que descreva\n\nexatamente a sa??da do sistema com base em uma dada entrada. Ja? um modelo com\n\najuste = 0% dara? uma soma do quadrado dos res??duos igual ao que se obteria pelo uso\n\nda me?dia dos dados da sa??da como preditor trivial. Esse ??ndice e? u?til principalmente\n\npara a comparac?a?o entre o desempenho de va?rios modelos, sendo equivalente ao RMSE\n\n(Root Mean Square Error ) [4]:\n\nRMSE =\n\n??N\nk=1(y(k) ? y?(k))2??N\n\nk=1(y(k) ? y?)\n(3.93)\n\npore?m e? de mais fa?cil interpretac?a?o.\n\nNo pro?ximo cap??tulo sera?o aplicadas estas te?cnicas a um estudo de caso: um poc?o\n\nde petro?leo simulado, operando com elevac?a?o artificial por injec?a?o cont??nua de ga?s.\n\n\n\nCap??tulo 4\n\nEstudo de Caso:\n\nAplicac?a?o a? Indu?stria Petrol??fera\n\n4.1 Introduc?a?o\n\nNos cap??tulos anteriores foi realizada uma breve revisa?o teo?rica sobre modelagem e\n\nidentificac?a?o de sistemas. Neste cap??tulo sera? feita uma aplicac?a?o deste conhecimento\n\nsobre um poc?o de petro?leo simulado, operando por elevac?a?o artificial mediante injec?a?o\n\ncont??nua de ga?s (gas-lift).\n\nO objetivo deste cap??tulo e? analisar a problema?tica de encontrar modelos va?lidos\n\npara o sistema, que possam ser utilizados para o controle do poc?o numa certa regia?o\n\nde operac?a?o com comportamento na?o-linear. Os dados utilizados foram obtidos num\n\nmodelo simulado no software OLGA 2000 da empresa Scandpower Petroleum Techno-\n\nlogies. Considera-se o uso do software OLGA 2000 suficiente para gerac?a?o de dados\n\nnuma primeira abordagem, ja? que este software e? amplamente utilizado na indu?stria e\n\nfoi validado com centenas de aplicac?o?es reais.\n\nInicialmente e? feita uma descric?a?o do sistema em ana?lise na sec?a?o 4.2, seguida de\n\numa descric?a?o do software OLGA 2000 na sec?a?o 4.3. Na sec?a?o 4.4 e? feita a identificac?a?o\n\nde modelos lineares para operar em tre?s pontos de operac?a?o do poc?o. A sec?a?o 4.5 faz a\n\nidentificac?a?o de modelos na?o-lineares do tipo NARMAX polinomial para o poc?o, sendo\n\ninicialmente utilizada uma entrada mais \u201cagressiva\u201d e em seguida e? feita a identificac?a?o\n\nde um modelo reaproveitando os dados da identificac?a?o linear. Por u?ltimo, a sec?a?o 4.6\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 43\n\nfaz uma comparac?a?o dos modelos lineares e na?o-lineares obtidos e a sec?a?o 4.7 sugere\n\numa estrate?gia para o controle, a ser implementada em trabalhos futuros.\n\n4.2 Descric?a?o do Sistema\n\nO petro?leo e? uma substa?ncia formada basicamente por hidrocarbonetos, com impu-\n\nrezas tais como compostos sulfurados, compostos nitrogenados, compostos oxigenados,\n\nresinas, asfaltenos e compostos meta?licos [37]. Ele e? formado a partir da mate?ria\n\norga?nica depositada junto com sedimentos, sob condic?o?es na?o-oxidantes. Esta mate?ria\n\norga?nica quando soterrada a uma profundidade suficiente para que haja um aumento de\n\ntemperatura e pressa?o, desencadeia o processo de maturac?a?o, similar a um cozimento\n\nem panela de pressa?o, dando origem ao petro?leo [32].\n\nApo?s a gerac?a?o do petro?leo, ocorre a migrac?a?o do petro?leo para a superf??cie. Quando\n\no caminho do petro?leo para a superf??cie e? interrompido por alguma armadilha geolo?gica,\n\ncomec?a o processo de acumulac?a?o. A barreira que se interpo?e no caminho do petro?leo e?\n\nchamada de rocha selante, tendo como principal caracter??stica a baixa permeabilidade,\n\nale?m da plasticidade (que permite a? rocha manter sua condic?a?o selante mesmo apo?s\n\nsubmetida a esforc?os determinantes de deformac?o?es). Abaixo desta rocha forma-se um\n\nreservato?rio de petro?leo, constitu??do por uma rocha com espac?os vazios no seu interior\n\n(porosidade intergranular), onde o petro?leo se deposita.\n\nPara explorar uma formac?a?o de petro?leo, e? necessa?ria a perfurac?a?o de um ou mais\n\npoc?os que permitam o acesso ao petro?leo a partir da superf??cie. Preliminarmente\n\nsa?o perfurados poc?os explorato?rios, nos quais sa?o feitos diversos testes para avaliar a\n\nformac?a?o. Segundo Pluce?nio [32], os principais resultados de um teste de formac?a?o sa?o\n\na pressa?o esta?tica do reservato?rio, a permeabilidade, a curva IPR (Inflow Performance\n\nRelationship), a ana?lise PVT (Pressa?o, Volume, Temperatura) do fluido de formac?a?o,\n\no teor de areia e as razo?es A?gua-O?leo e Ga?s-O?leo. Uma curva IPR t??pica para fluido\n\nsubsaturado e? mostrada na figura 4.1, relacionando a vaza?o de produc?a?o na cabec?a do\n\npoc?o para diferentes valores de pressa?o no fundo do poc?o. Para fluidos saturados, a\n\ncurva se altera ligeiramente, deixando de ser um reta e adquirindo uma curvatura. O\n\nprocesso de prospecc?a?o de petro?leo e? explicado em [37] e a perfurac?a?o e explorac?a?o de\n\npoc?os e? detalhada em [13, 37].\n\nConsidere um poc?o onde a pressa?o esta?tica do reservato?rio (Pr) e? igual a? pressa?o da\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 44\n\nFigura 4.1: Curva IPR (Inflow Performance Relationship) t??pica para fluido subsatu-\n\nrado\n\ncoluna de fluido dentro do tubo de produc?a?o (Ptp), sem que a coluna de fluido atinja\n\na cabec?a do poc?o, na?o haveria produc?a?o, como pode ser visto na figura 4.2. Para que\n\nseja poss??vel extrair petro?leo deste poc?o e? necessa?rio que se utilize alguma forma de\n\nelevac?a?o artificial. Em outro caso menos extremo, o reservato?rio pode possuir pressa?o\n\nsuficiente para vencer o peso da coluna de fluido (Pr > Ptp) mas na?o o suficiente para\n\nproporcionar uma vaza?o que seja interessante do ponto de vista econo?mico. Tambe?m\n\nneste caso utiliza-se algum me?todo de elevac?a?o artificial. Ale?m disso, conforme se extrai\n\npetro?leo de uma reservato?rio, a pressa?o dele diminui com o tempo, exigindo alguma\n\nforma de elevac?a?o artificial.\n\nSegundo Pluce?nio [32], os principais me?todos de elevac?a?o artificial de petro?leo sa?o:\n\n\u2022 bomba de succ?a?o com hastes;\n\n\u2022 bomba de cavidade;\n\n\u2022 bomba centr??fuga submersa;\n\n\u2022 elevac?a?o por injec?a?o cont??nua de ga?s;\n\n\u2022 elevac?a?o por injec?a?o intermitente de ga?s.\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 45\n\nFigura 4.2: Poc?o morto\n\nPara escolher o me?todo de elevac?a?o artificial mais adequado para um dado poc?o,\n\ndeve-se levar em considerac?a?o fatores tais como a geometria do poc?o, profundidade,\n\ncaracter??sticas do fluido, pressa?o esta?tica do reservato?rio, disponibilidades de insumos\n\npara o me?todo, entre outros. O me?todo da elevac?a?o atrave?s da injec?a?o cont??nua de ga?s\n\npossui um bom desempenho comparado com os demais me?todos, na?o sendo entretanto\n\nrecomendado para reservato?rios ja? muito esgotados, onde os custos tornam a operac?a?o\n\ninvia?vel em termos econo?micos.\n\nAs principais vantagens do me?todo de elevac?a?o por injec?a?o cont??nua de ga?s sa?o [24]:\n\n\u2022 custos iniciais do equipamento podem ser menores do que outros tipos de siste-\nmas;\n\n\u2022 custo de manutenc?a?o e? mais baixo;\n\n\u2022 grande facilidade de instalac?a?o e operac?a?o;\n\n\u2022 permite operac?a?o intermitente para poc?os com baixa produc?a?o;\n\n\u2022 adapta-se facilmente a poc?os que produzam areia, o que poderia danificar outros\ntipos de sistemas.\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 46\n\nO me?todo de elevac?a?o por injec?a?o cont??nua de ga?s (gas lift) funciona atrave?s da\n\nreduc?a?o da pressa?o hidrosta?tica no tubo de produc?a?o. Para realizar esta tarefa, uma\n\nva?lvula direcional e? colocada no tubo de produc?a?o no ponto mais profundo poss??vel\n\ne ga?s e? injetado com pressa?o maior do que a pressa?o da coluna de fluido naquele\n\nponto. O ga?s, por ser mais leve do que o fluido existente na coluna, sobe e gaseifica\n\no conteu?do do tubo de produc?a?o, reduzindo a densidade do fluido ali existente. Isso\n\ndiminui a pressa?o da coluna de fluido na formac?a?o e, quando a pressa?o da coluna de\n\nfluido tornar-se menor do que a pressa?o na formac?a?o, consegue-se efetuar a elevac?a?o\n\nartificial do petro?leo [14, 22, 32]. A figura 4.3 apresenta os principais equipamentos\n\nutilizados num poc?o operando por elevac?a?o cont??nua de ga?s.\n\nFigura 4.3: Esquema de um poc?o operando por elevac?a?o cont??nua de ga?s, utilizando\n\no me?todo cla?ssico onde o controle e? realizado na pro?pria va?lvula de gas-lift inserta?vel,\n\ndestacando os principais equipamentos envolvidos - Adaptado de [32]\n\nEm um reservato?rio, podemos ter a?gua, o?leo ou ga?s em quaisquer combinac?o?es. O\n\nfluido obtido na sa??da do poc?o passara? enta?o por um separador, que fara? a separac?a?o\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 47\n\ndas tre?s fases do fluido. O ga?s extra??do podera? evidentemente ser reaproveitado no\n\nprocesso de elevac?a?o por injec?a?o de ga?s.\n\nAinda sobre a figura 4.3, nota-se a presenc?a de dois \u201cchokes\u201d (ou \u201cchoke valves\u201d -\n\ndo ingle?s: \u201cva?lvula de estrangulamento\u201d): o de produc?a?o e o de injec?a?o de ga?s. Um\n\nchoke e? uma va?lvula de orif??cio com grande resiste?ncia a? abrasa?o, na?o sofrendo danos\n\ncom a passagem das part??culas so?lidas que eventualmente venham junto com o fluido\n\nda formac?a?o (que pode inclusive escoar a uma velocidade superso?nica). Quando se\n\ntrata da vaza?o de ga?s por um choke, tem-se que caso a pressa?o a montante do choke\n\n(P1) seja igual a? pressa?o a jusante (P2), na?o ha? fluxo atrave?s dele. Para valores de\n\nP2/P1 abaixo de um certo valor (ao redor de 0.5), atinge-se um fluxo cr??tico onde uma\n\ndiminuic?a?o de P2 na?o mais provoca um aumento na vaza?o ma?ssica atrave?s do choke.\n\nIsso ocorre pois nesta condic?a?o a vaza?o ocorre a? velocidade do som. Essa propriedade\n\ndos chokes e? usada na indu?stria do petro?leo para garantir que oscilac?o?es na pressa?o dos\n\nequipamentos existentes a jusante do choke de produc?a?o na?o afetem a vaza?o ma?ssica\n\nque passa pela tubulac?a?o. Por outro lado, a inclusa?o deste choke provoca o aumento\n\nda pressa?o nos componentes a montante no choke, o que no fim provoca uma queda na\n\nproduc?a?o do poc?o [33].\n\nDe acordo com a vaza?o de ga?s injetada, temos diversos regimes de operac?a?o do\n\npoc?o:\n\n\u2022 Fluxo tipo bolhas - para pequenas vazo?es de ga?s, o ga?s sobe ate? a superf??cie na\nforma de bolhas;\n\n\u2022 Fluxo tipo plugue - aumentando-se a vaza?o de ga?s, as bolhas acabam se fundindo\ne formam um fluxo de l??quido entremeado por golfadas de ga?s;\n\n\u2022 Fluxo anular - neste regime, a quantidade de ga?s toma a sec?a?o central do tubo\nde produc?a?o e a fase l??quida viaja rente a? parede do tubo;\n\n\u2022 Fluxo ne?voa - a fase l??quida deixa de ocupar as paredes do tubo de produc?a?o e\npassa a viajar na forma de gotas carregadas pelo ga?s.\n\nA figura 4.4 mostra um gra?fico teo?rico da curva de produc?a?o de um poc?o ope-\n\nrando por injec?a?o cont??nua de ga?s. A vaza?o de produc?a?o e? func?a?o da vaza?o de ga?s\n\ninjetado. Conforme explicado anteriormente, a injec?a?o de ga?s reduz a densidade do\n\nfluido presente no tubo de produc?a?o, tornando a pressa?o da coluna de fluido menor do\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 48\n\nque a pressa?o na frente dos canhoneados do poc?o, o que resulta num fluxo subindo o\n\ntubo de produc?a?o. Com o aumento da vaza?o de ga?s, o atrito do fluido da coluna de\n\nproduc?a?o aumenta ate? um ponto onde passa a dominar a dina?mica do fluxo, reduzindo\n\na vaza?o de produc?a?o do poc?o. Existe uma regia?o o?tima de operac?a?o do poc?o, em termos\n\necono?micos, assinalada na figura 4.4, que esta? relacionada com o custo de compressa?o\n\ndo ga?s, o prec?o do petro?leo no mercado, entre outros. Esta regia?o, no entanto, possui o\n\ninconveniente de apresentar oscilac?o?es, quando o sistema opera em malha aberta, o que\n\ne? ruim por reduzir a produtividade do poc?o e dificultar a separac?a?o da a?gua/ga?s/o?leo\n\n[14].\n\nFigura 4.4: Curva da vaza?o de produc?a?o x vaza?o de injec?a?o, com a a?rea de maior\n\ninteresse econo?mico em destaque.\n\nEm Imsland et al [15, 22] propo?em-se estrate?gias para a estabilizac?a?o das oscilac?o?es\n\nde poc?os operando por gas lift, mas nelas devem estar dispon??veis as medic?o?es da\n\npressa?o na cabec?a e no fundo do poc?o e a vaza?o ma?ssica atrave?s do choke de produc?a?o e\n\nde injec?a?o. Os modelos utilizados sa?o lineares, mas o procedimento detalhado utilizado\n\npara a modelagem do sistema e? omitida nos artigos.\n\nPluce?nio [32], por outro lado, propo?e uma estrate?gia para o controle de um poc?o\n\noperando por gas lift que envolve a medic?a?o da vaza?o ma?ssica de produc?a?o na superf??cie,\n\nutilizando uma rede Fieldbus como plataforma para o desenvolvimento do controle. Os\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 49\n\nmodelos utilizados sa?o lineares do tipo ARX, identificados em tre?s diferentes pontos de\n\noperac?a?o.\n\nBusca-se neste trabalho identificar um modelo (ou fam??lia de modelos) que possibi-\n\nlite a posterior implementac?a?o do controle da produc?a?o no poc?o de petro?leo, eliminando\n\nas oscilac?o?es existentes e permitindo que o sistema opere na faixa que economicamente\n\ne? mais interessante. Devido a? caracter??stica na?o-linear do sistema, o interesse principal\n\nreside na obtenc?a?o de modelos na?o-lineares.\n\nInicialmente, considera-se que sa?o medidas a pressa?o no fundo do poc?o (Pwf ) e a\n\npressa?o na cabec?a do poc?o (Ph). Pode-se atuar sobre a abertura do choke de injec?a?o\n\nde ga?s e sobre a abertura do choke de produc?a?o. Supo?e-se que haja um compressor\n\ncapaz de fornecer ga?s comprimido a uma pressa?o constante, sendo o controle da vaza?o\n\nde ga?s efetivamente injetado no sistema feito atrave?s da abertura do choke de injec?a?o.\n\nA estrutura do controlador de vaza?o ma?ssica de ga?s injetado e? mostrada na figura\n\n4.5, onde Kp = 5 \u00d7 10?3 e Ki = 0.1). Considerando-se a existe?ncia deste controle\nlocal, as entradas do sistema a ser identificado passam a ser a vaza?o ma?ssica de injec?a?o\n\nde ga?s (Qi - refere?ncia do controlador mostrado na figura 4.5) e a abertura do choke\n\nde produc?a?o (?c). A figura 4.6 ilustra os pontos de medic?a?o e atuac?a?o das varia?veis\n\nmencionadas acima.\n\nFigura 4.5: Estrutura do controlador de vaza?o ma?ssica de injec?a?o de ga?s\n\nNa figura 4.7 pode-se ver uma fam??lia de curvas relacionando a pressa?o no tubo\n\nde produc?a?o (Ptp - corresponde a? diferenc?a de pressa?o na cabec?a e no fundo do poc?o)\n\nem regime permanente em func?a?o da vaza?o de injec?a?o de ga?s (Qi), com o choke de\n\nproduc?a?o mantido com abertura constante, igual a 20%, 35%, 50%, 65%, 80% e 95%.\n\nNo mesmo ensaio foram tambe?m medidos a pressa?o no fundo do poc?o (Pwf ), a queda\n\nde pressa?o no choke de produc?a?o (Pc) e a vaza?o de l??quido na sa??da (Qliq), todos em\n\nfunc?a?o da vaza?o de injec?a?o de ga?s, podendo os resultados serem vistos nas figuras 4.8,\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 50\n\nFigura 4.6: Pontos de medic?a?o e atuac?a?o no poc?o de petro?leo, inicialmente utilizados\n\n4.9 e 4.10. A pressa?o no separador (boundary do sistema) foi mantida constante em\n\n375 psi (que corresponde a aproximadamente 2.59 MPa).\n\nAs figuras 4.7 e 4.8 sa?o fa?ceis de interpretar: dado que esta? sendo injetado continu-\n\namente ga?s na entrada do sistema, quanto mais fechado estiver o choke de produc?a?o,\n\nmaior sera? a pressa?o a montante desta va?lvula, ou seja, maior sera? a pressa?o no tubo\n\nde produc?a?o e no fundo do poc?o. Na figura 4.7 a pressa?o no tubo de produc?a?o de-\n\ncresce com o aumento da vaza?o de injec?a?o (em cada uma das curvas) pois com mais\n\nga?s injetado na coluna de produc?a?o, reduz-se a densidade do fluido ali existente e con-\n\nsequ?entemente a pressa?o (pois Ptp = ?gh), ate? um ponto onde o atrito do fluido com\n\nas paredes da tubulac?a?o passam a influenciar mais fortemente a dina?mica. A figura 4.9\n\nmostra que quanto mais fechado estiver o choke de produc?a?o, maior sera? a diferenc?a\n\nda pressa?o a montante e a jusante dele e a figura 4.10 mostra o custo de utilizar um\n\nchoke de produc?a?o: a reduc?a?o da produc?a?o do poc?o.\n\nCom a definic?a?o feita de varia?veis de entrada (Qi e ?c) e de sa??da (Pwf e Ph), temos\n\num modelo multivaria?vel com 2 entrada e 2 sa??das. No entanto, em testes preliminares,\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 51\n\nFigura 4.7: Pressa?o no tubo de produc?a?o em func?a?o da vaza?o de injec?a?o de ga?s em\n\nregime permanente - choke de produc?a?o com abertura igual a: 20%, 35%, 50%, 65%,\n\n80% e 95%\n\nFigura 4.8: Pressa?o no fundo do poc?o em func?a?o da vaza?o de injec?a?o de ga?s em regime\n\npermanente - choke de produc?a?o com abertura igual a: 20%, 35%, 50%, 65%, 80% e\n\n95%\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 52\n\nFigura 4.9: Queda de pressa?o no choke de produc?a?o em func?a?o da vaza?o de injec?a?o de\n\nga?s em regime permanente - choke de produc?a?o com abertura igual a: 20%, 35%, 50%,\n\n65%, 80% e 95%\n\nFigura 4.10: Quantidade de l??quido (produzido) na sa??da do sistema em func?a?o da\n\nvaza?o de injec?a?o de ga?s em regime permanente - choke de produc?a?o com abertura igual\n\na: 20%, 35%, 50%, 65%, 80% e 95%\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 53\n\nverificou-se que a identificac?a?o do modelo e o posterior controle do sistema com esta\n\nestrutura se tornaria dif??cil, pois ha? uma relac?a?o forte entre a pressa?o no fundo do poc?o\n\n(Pwf ) e a pressa?o na cabec?a do poc?o (Ph). Isso porque a pressa?o no fundo do poc?o pode\n\nser aproximada por Pwf = Pr + Ptp + Ph, onde Pr e? a pressa?o me?dia do reservato?rio,\n\nPtp e? a pressa?o exercida pela coluna de fluido no tubo de produc?a?o e Ph e? a pressa?o\n\nmedida na cabec?a do poc?o. Podemos tambe?m escrever Ph = Pc + Psep, onde Pc e? a\n\nqueda de pressa?o no choke de produc?a?o e Psep e? a pressa?o no separador. Vemos que\n\ncom esta estrutura, a pressa?o no fundo do poc?o e a pressa?o na cabec?a do poc?o esta?o\n\ninter-relacionadas, dificultando a implementac?a?o de um controlador multivaria?vel que\n\nconsiga isolar Pwf de Ph.\n\nPartiu-se enta?o para uma redefinic?a?o das entradas e sa??das do sistema. Em vez\n\nde lidar diretamente com a pressa?o no fundo do poc?o, passou-se a utilizar a queda de\n\npressa?o no tubo de produc?a?o Ptp, que e? definida como: Ptp = Pwf ? Ph. A vantagem\nde passarmos a lidar com Ptp em vez de Pwf e? que, enquanto variac?o?es na pressa?o do\n\nseparador afetavam diretamente Pwf , a pressa?o da coluna de fluido no tubo de produc?a?o\n\nna?o e? afetada. Isso porque Ptp e? calculada como a diferenc?a entre Pwf e Ph e estes dois\n\ntermos reagem de forma similar a eventuais perturbac?o?es na pressa?o no separador.\n\nA pressa?o na cabec?a do poc?o passa enta?o a ser controlada por um controlador\n\nlocal, que agindo sobre a abertura do choke de produc?a?o garante que Ph permanec?a\n\nconstante (o que e? deseja?vel na pra?tica). A refere?ncia utilizada para o controlador de\n\npressa?o na cabec?a do poc?o foi de 325 Psi (aproximadamente 2.24 MPa) e a estrutura\n\ndo controlador e? a mesma utilizada para o controle da vaza?o de ga?s injetado, mostrada\n\nna figura 4.5, mas com Kp = ?1 \u00d7 10?5 e Ki = 0.01).\n\nO sistema a ser identificado passa enta?o a ser um sistema monovaria?vel, cuja en-\n\ntrada e? a vaza?o de ga?s injetado (Qi) e a sa??da e? a pressa?o da coluna de fluido no tubo\n\nde produc?a?o (Ptp), conforme mostrado na figura 4.11. Esta estrutura tem a vantagem\n\nde ser facilmente implementada na pra?tica, ja? que todos os novos poc?os ve?m equipa-\n\ndos com sensores para medir a pressa?o no fundo e na cabec?a do poc?o. Ale?m disso, a\n\ninstrumentac?a?o necessa?ria para medic?a?o de pressa?o e? trivial, ao contra?rio da instru-\n\nmentac?a?o requerida para medic?a?o de vaza?o de um fluido multifa?sico, que e? muito cara,\n\ndificultando a implementac?a?o das estrate?gias de controle propostas por Pluce?nio [32]\n\nou por Imsland et al [22]. A relac?a?o entre Ptp e a vaza?o de produc?a?o na sa??da (que e? o\n\nque efetivamente se desejaria controlar) e? considerada como tendo uma dina?mica des-\n\nprez??vel. Assim, e? suficiente levantar posteriormente uma relac?a?o esta?tica entre essas\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 54\n\nduas varia?veis.\n\nFigura 4.11: Pontos de medic?a?o e atuac?a?o no poc?o de petro?leo, utilizados no restante\n\ndeste trabalho\n\nE? interessante notar que a modelagem fenomenolo?gica da relac?a?o entre Ptp e Qi\n\ne? complexa, pois envolve equac?o?es com derivadas parciais, na?o sendo automa?tica a\n\nconversa?o para modelos com formatos que possibilitem a aplicac?a?o de ferramentas\n\nhabituais da teoria de controle.\n\nO sistema possui um comportamento evidentemente na?o linear, como pode ser\n\nobservado na figura 4.12, onde foram aplicados degraus na entrada do sistema (vaza?o\n\nde injec?a?o de ga?s) e medida a pressa?o no tubo de produc?a?o em um poc?o simulado\n\nutilizando o software OLGA (descrito na sec?a?o 4.3). Percebe-se que na?o somente a\n\nresposta em regime transito?rio do sistema se altera de acordo com a regia?o de operac?a?o,\n\napresentando uma resposta muito oscilato?ria para baixos valores de Qi, mas tambe?m a\n\nresposta em regime permanente. Vale notar que foram desprezados os dados referentes\n\na? partida do poc?o, que possui um comportamento particular, cuja descric?a?o na?o faz\n\nparte do escopo deste trabalho.\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 55\n\nFigura 4.12: No alto, sequ?e?ncia de degraus de teste aplicada na entrada (Qi) e embaixo\n\na sa??da (Ptp), mostrando a na?o-linearidade do sistema\n\nAle?m da caracter??stica na?o-linear, o sistema possui uma resposta com fase na?o-\n\nm??nima1, como pode ser observado na figura 4.13, que e? uma ampliac?a?o da figura 4.12.\n\nA presenc?a da fase na?o-m??nima significa que o sistema reage a uma entrada inicialmente\n\nna direc?a?o contra?ria a? esperada, o que dificulta a implementac?a?o de um controlador.\n\nAs figuras 4.14, 4.15 e 4.16 mostram a pressa?o no tubo de produc?a?o (Ptp), a pressa?o\n\nno fundo do poc?o (Pwf ) e a quantidade de l??quido produzido na sa??da do sistema\n\n(Qliq) respectivamente, todos em regime permanente, em func?a?o da quantidade de ga?s\n\ninjetado na entrada do sistema, para o caso onde se implementou um controlador que\n\n1O termo \u201cfase na?o-m??nima\u201d e? em geral utilizado no contexto de sistemas lineares significando a\n\npresenc?a de um zero fora do c??rculo unita?rio (no caso discreto). Essa noc?a?o foi aqui extrapolada,\n\nutilizando-se o termo \u201cresposta com fase na?o-m??nima\u201d pois a resposta do sistema apresenta um com-\n\nportamento similar ao que se observaria num sistema linear com fase na?o-m??nima [18]. E? poss??vel\n\nencontrar na literatura o termo \u201cresposta inversa\u201d com o mesmo significado.\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 56\n\nFigura 4.13: No alto, degrau aplicado na entrada do sistema. Embaixo a sa??da (Ptp),\n\nmostrando a presenc?a de fase na?o-m??nima no sistema\n\nmante?m a pressa?o na cabec?a do poc?o constante em Ph = 325 Psi. A regia?o de operac?a?o\n\ne? mostrada em linha cheia nestes gra?ficos e os tre?s pontos de operac?a?o onde foram\n\nidentificados modelos lineares sa?o representados com c??rculos, correspondendo a Qi =\n\n1.5, Qi = 2.15 e Qi = 2.8 kg/s. A relac?a?o Pwf \u00d7 Qi vista na figura 4.15 corresponde a?\ncaracter??stica esta?tica entre a varia?vel de entrada e a de sa??da do sistema a ser modelado.\n\nCaso o sistema fosse linear, este gra?fico seria uma reta, o que evidentemente na?o e? o\n\ncaso. Nota-se tambe?m nesta figura e na figura 4.14 que o sistema possui ganho esta?tico\n\nnegativo ate? um valor de Qi pro?ximo a 3 kg/s e para valores maiores que este o ganho\n\nesta?tico passa a ser positivo. Na figura 4.16 observa-se que a regia?o de trabalho situa-se\n\ndentro da faixa de o?timo econo?mico mostrada teoricamente na figura 4.4.\n\nDeve ser notado que o modelo identificado quantificando a relac?a?o Ptp \u00d7 Qi e? in-\nfluenciado pela escolha dos para?metros dos controladores de vaza?o de ga?s injetado e\n\ndo controlador de pressa?o na cabec?a do poc?o. Assim, qualquer alterac?a?o na estru-\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 57\n\nFigura 4.14: Pressa?o no tubo de produc?a?o em func?a?o da vaza?o de injec?a?o de ga?s quando\n\na pressa?o na cabec?a do poc?o (Ph) e? mantida constante em 325 Psi. A regia?o de operac?a?o\n\ne? mostrada em linha cheia. Os c??rculos mostram os tre?s pontos onde foram identificados\n\nmodelos lineares\n\nFigura 4.15: Pressa?o no fundo do poc?o em func?a?o da vaza?o de injec?a?o de ga?s quando a\n\npressa?o na cabec?a do poc?o (Ph) e? mantida constante em 325 Psi. A regia?o de operac?a?o e?\n\nmostrada em linha cheia. Os c??rculos mostram os tre?s pontos onde foram identificados\n\nmodelos lineares\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 58\n\nFigura 4.16: Quantidade de l??quido (produzido) na sa??da do sistema em func?a?o da\n\nvaza?o de injec?a?o de ga?s quando a pressa?o na cabec?a do poc?o (Ph) e? mantida constante\n\nem 325 Psi. A regia?o de operac?a?o e? mostrada em linha cheia. Os c??rculos mostram os\n\ntre?s pontos onde foram identificados modelos lineares\n\ntura ou nos para?metros destes controladores exige a reidentificac?a?o do sistema. Da\n\nmesma forma, uma alterac?a?o na refere?ncia do controlador de pressa?o na cabec?a do\n\npoc?o tambe?m exige uma nova identificac?a?o do sistema.\n\nA pressa?o no reservato?rio foi considerada constante neste estudo, mas conforme ele\n\nfor explorado, esta pressa?o deve diminuir. A constante de tempo envolvida, entretanto,\n\ne? bastante lenta e os modelos identificados para o poc?o devem mostrar-se va?lidos por\n\num intervalo de tempo razoa?vel.\n\n4.3 O simulador Olga\n\nPara o desenvolvimento deste trabalho, foi utilizado o software OLGA 2000, versa?o\n\n4.10.1, da empresa Scandpower Petroleum Technologies AS. Este software originalmente\n\nchamava-se OLGA 83, tendo sido desenvolvido em 1983 para a Norwegian State Oil\n\nCompany. Desde enta?o, o OLGA tem sido aprimorado sendo atualmente capaz de fazer\n\nsimulac?o?es dina?micas de sistemas operando com duas ou tre?s fases fluidas, incluindo\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 59\n\nequipamentos como compressores, bombas, trocadores de calor, separadores, va?lvulas\n\ne controladores [36].\n\nO software OLGA e? validado com dados do SINTEF Multi-Phase Flow Laboratory,\n\nIFE, dados de laborato?rio de processos de pequena escala, ale?m de dados tirados de\n\npoc?os reais em operac?a?o. Os me?todos nume?ricos utilizados pelo OLGA permitem a\n\nsimulac?a?o de transientes de operac?a?o de um sistema. Este software e? comumente\n\nutilizado na indu?stria do petro?leo [14].\n\nObviamente a opc?a?o de identificar um modelo para a relac?a?o Ptp\u00d7Qi obtida atrave?s\nde dados provenientes de simulac?o?es com o software OLGA na?o e? o ideal, ja? que o que\n\ne? simulado dentro do OLGA e? tambe?m um modelo. O ideal seria a utilizac?a?o de dados\n\nextra??dos de um poc?o real. No entanto, a ide?ia e? que o modelo identificado venha a\n\nser utilizado posteriormente para a implementac?a?o de um controlador. A utilizac?a?o do\n\nOLGA permite que se verifique a viabilidade da implementac?a?o deste controlador, sem\n\nse preocupar com limitac?o?es f??sicas existentes num poc?o real. Ale?m disso, a execuc?a?o de\n\num teste de identificac?a?o num poc?o real requereria a interrupc?a?o da operac?a?o do poc?o,\n\nou ao menos a alterac?a?o da operac?a?o normal, por um certo tempo. Antes de chegar a?\n\nexecuc?a?o destes testes no sistema real e? conveniente testar num modelo de computador\n\n(dentro do OLGA) se a abordagem e? fact??vel e com isso minimizar o tempo de poc?o\n\nparado e os riscos da implementac?a?o. Considera-se que o software OLGA, por ser muito\n\nusado na indu?stria do petro?leo, represente uma boa aproximac?a?o do comportamento\n\nde um poc?o real.\n\nO sistema que foi montado no simulador e? uma modificac?a?o de um modelo fornecido\n\npela Scandpower de um poc?o real operando em a?guas profundas no Golfo do Me?xico,\n\ncom completac?a?o a seco. A figura 4.17 mostra a geometria do sistema em estudo, que\n\npossui as seguintes caracter??sticas:\n\n\u2022 Pressa?o esta?tica do reservato?rio = 4.800 Psi = 33,094 MPa\n\n\u2022 Temperatura do reservato?rio = 82, 2oC\n\n\u2022 I?ndice de produtividade do reservato?rio = 2 \u00d7 10?6 kg/s/Pa\n\n\u2022 Pressa?o do separador = 375 psi = 2,585 Mpa\n\n\u2022 Temperatura do separador = 26, 7oC\n\n\u2022 Pressa?o do ga?s na sa??da do compressor = 9,652 Mpa\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 60\n\n\u2022 Temperatura do ga?s na sa??da do compressor = 20oC\n\nFigura 4.17: Geometria do sistema em ana?lise, implementado no OLGA\n\n4.4 Identificac?a?o Linear\n\nA primeira abordagem feita e? a realizac?a?o da identificac?a?o de modelos lineares para\n\no sistema. Como ja? se mostrou anteriormente, o sistema possui uma caracter??stica\n\nna?o-linear, portanto os modelos lineares encontrados sera?o va?lidos somente dentro de\n\numa estreita faixa de operac?a?o.\n\nA identificac?a?o linear foi feita em torno de tre?s valores de entrada: Qi = 1.5 kg/s,\n\nQi = 2.15 kg/s e Qi = 2.8 kg/s. Qi = 1.5 kg/s foi o menor valor de Qi que o simulador\n\npermitiu simular. Abaixo deste valor o simulador OLGA apresentava erro por entrar\n\nnuma regia?o onde as caracter??sticas do fluido na?o estavam descritas. Qi = 2.8 kg/s foi\n\nescolhido pois para uma vaza?o de injec?a?o em torno de 3 kg/s ocorre o ponto de m??nimo\n\nda curva Ptp \u00d7 Qi, como pode ser observado na figura 4.7. Ha? interesse em operar\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 61\n\nabaixo deste valor, por isso a escolha acima. Ja? Qi = 2.15 kg/s foi escolhido por ser o\n\nponto me?dio entre Qi = 1.5 kg/s e Qi = 2.8 kg/s.\n\nPara proceder a identificac?a?o, o valor da vaza?o de injec?a?o de ga?s foi mantido cons-\n\ntante ate? o sistema estabilizar-se e em seguida foi adicionado ao sinal de entrada cons-\n\ntante um sinal PRBS variando entre ?0.1 e 0.1 kg/s, com durac?a?o de 12600 segundos,\nde forma a excitar as diversas frequ?e?ncias do sistema, mas possuindo amplitude sufi-\n\ncientemente pequena para evitar excitar as na?o-linearidades presentes. O tempo em\n\nque cada valor do sinal PRBS e? mantido na entrada foi escolhido como sendo de 200\n\nsegundos. O sinal PRBS de entrada pode ser visto na figura 4.18. A sa??da do sistema\n\n(Ptp) para as tre?s entradas descritas acima (uma para cada ponto de operac?a?o) pode\n\nser vista nas figuras 4.19, 4.20 e 4.21.\n\nFigura 4.18: Sinal ?u(t) aplicado na entrada do sistema para realizar a identificac?a?o\n\nlinear\n\nAs varia?veis foram redefinidas passando-se a ser considerada como entrada e sa??da\n\ndo sistema a variac?a?o em torno do ponto de operac?a?o. O ponto de operac?a?o utilizado\n\nfoi obtido mantendo-se a vaza?o de injec?a?o de ga?s (entrada) constante num valor e\n\nobservando-se o valor em que a sa??da estabilizava. As novas definic?o?es das varia?veis\n\nde entrada e sa??da esta?o listadas nas equac?o?es 4.1, 4.2 e 4.3, relativas aos tre?s casos\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 62\n\nFigura 4.19: Sa??da do sistema (Ptp) para a identificac?a?o linear com Qi em torno de 1.5\n\nkg/s\n\nFigura 4.20: Sa??da do sistema (Ptp) para a identificac?a?o linear com Qi em torno de 2.15\n\nkg/s\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 63\n\nFigura 4.21: Sa??da do sistema (Ptp) para a identificac?a?o linear com Qi em torno de 2.8\n\nkg/s\n\nanalisados na identificac?a?o linear.\n\n?u(t) = u(t) ? 1.5 [kg/s]\n\n?y(t) = y(t) ? 3.588600 [MPa] (4.1)\n\n?u(t) = u(t) ? 2.15 [kg/s]\n\n?y(t) = y(t) ? 3.398670 [MPa] (4.2)\n\n?u(t) = u(t) ? 2.8 [kg/s]\n\n?y(t) = y(t) ? 3.329300 [MPa] (4.3)\n\nComo per??odo de amostragem, adotou-se a estrate?gia descrita na sec?a?o 3.5,\n\namostrando-se o sistema a uma taxa muito acima da necessa?ria e depois reamostrando-\n\nse o sinal adequadamente. Neste caso utilizou-se uma taxa de amostragem inicial de 1\n\nsegundo, que observando-se a resposta do sistema da figura 4.12, e? suficiente para lidar\n\ncom as maiores frequ?e?ncias de interesse presentes no sistema.\n\nA figura 4.22 mostra a func?a?o de autocovaria?ncia linear (equac?a?o 3.5) da sa??da do\n\nsistema (Ptp). As tre?s func?o?es mostradas correspondem a? autocovaria?ncia do sistema\n\nexcitado na entrada em torno de Qi = 1.5, Qi = 2.15 e Qi = 2.8 kg/s. Para facilitar a\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 64\n\nvisualizac?a?o, o resultado da equac?a?o 3.5 foi normalizado, fazendo com que ry?(0) = 1\n\nnos tre?s casos. Para a entrada variando em torno de Qi = 1.5 kg/s, temos que o\n\nprimeiro m??nimo de ry?(?) ocorre em ? = 691, para Qi = 2.15 kg/s o primeiro m??nimo\n\nocorre em ? = 560 e para Qi = 2.8 kg/s o primeiro m??nimo ocorre em ? = 472.\n\nFigura 4.22: Func?a?o de autocovaria?ncia linear usada para definir o fator de reamostra-\n\ngem adequado para o sinal de sa??da\n\nO fator de reamostragem (?) do sinal deve ser escolhido de modo a satisfazer a ine-\n\nquac?a?o 3.9, resultando nas inequac?o?es 4.4, 4.5 e 4.6, que correspondem a? identificac?a?o\n\nfeita com a entrada em torno de Qi = 1.5, Qi = 2.15 e Qi = 2.8 kg/s, respectivamente.\n\n34.55 ? ? ? 69.10 (4.4)\n\n28.00 ? ? ? 56.00 (4.5)\n\n23.60 ? ? ? 47.20 (4.6)\n\nEscolheu-se utilizar nos tre?s casos um fator de reamostragem ? = 40, que satisfaz\n\nsimultaneamente as inequac?o?es 4.4, 4.5 e 4.6. Como inicialmente utilizou-se um tempo\n\nde amostragem de 1 segundo, apo?s a reamostragem o sinal usado para a identificac?a?o\n\npossui Ts = 40 segundos. Logicamente seria poss??vel utilizar um fator de reamostragem\n\ndiferente para cada um dos casos analisados, mas e? interessante utilizar a mesma taxa\n\npara facilitar a eventual comparac?a?o entre os modelos identificados.\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 65\n\nSegundo o que foi discutido na sec?a?o 3.4, uma heur??stica para o projeto do sinal de\n\nteste e? que a durac?a?o do menor patamar esteja entre 3Ts e 5Ts (neste caso, entre 120 e\n\n200 segundos). O sinal PRBS utilizado para este ensaio possui o menor patamar com\n\ndurac?a?o de 200 segundos, portanto esta? adequado para a utilizac?a?o na identificac?a?o\n\ndeste sistema. Escolheu-se uma durac?a?o grande para o menor patamar para aumentar\n\na excitac?a?o das baixas frequ?e?ncias do sistema.\n\nApo?s a reamostragem do sinal, os vetores contendo a entrada e a sa??da do sistema\n\npossuem 316 elementos cada. Vale notar que estes dados foram utilizados na ??ntegra\n\npara a estimac?a?o dos para?metros do sistema. Para validac?a?o dos modelos, foram feitos\n\noutros tre?s ensaios similares pore?m utilizando um sinal PRBS diferente (visto na figura\n\n4.23) mas com as mesmas caracter??sticas do sinal de entrada usado para gerar os dados\n\nde estimac?a?o. Este sinal de entrada para validac?a?o tem 6200 segundos de durac?a?o\n\ntotal, e os vetores contendo a entrada e a sa??da, apo?s a reamostragem, possuem 156\n\nelementos cada.\n\nFigura 4.23: Sinal ?u(t) aplicado na entrada do sistema para validar a identificac?a?o\n\nlinear\n\nNa identificac?a?o linear em torno dos tre?s pontos de operac?a?o mencionados, buscam-\n\nse modelos que tenham a ordem mais baixa poss??vel e que tenham a mesma estrutura\n\n(nu, ny e nk sejam os mesmos para os tre?s modelos), de forma a facilitar a comparac?a?o\n\nentre eles. Este u?ltimo requisito e? buscado desde que a manutenc?a?o da estrutura na?o\n\ncomprometa o desempenho do modelo naquele ponto de operac?a?o.\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 66\n\n4.4.1 Identificac?a?o em torno de u=1.5 kg/s\n\nO primeiro modelo a ser identificado foi para a entrada do sistema variando em torno\n\nde Qi = 1.5 kg/s. Inicialmente supo?s-se que na?o existe uma dina?mica significativa\n\nno ru??do, buscando-se enta?o um modelo do tipo ARX, cuja estrutura atendesse a:\n\n1 ? ny ? 8, 1 ? nu ? 8 e 0 ? nk ? 5. Ou seja, buscou-se um modelo autoregressivo\nque utilize informac?o?es da sa??da e da entrada atrasadas em ate? 8 instantes de tempo\n\n(de y(k ? 1) ate? y(k ? 8) e de u(k ? nk) ate? u(k ? nk ? 7)) e que possua atraso de\ntransporte (nk) de ate? 5 instantes de tempo discreto.\n\nO crite?rio utilizado para a classificac?a?o dos modelos e selec?a?o do mais adequado\n\nfoi o crite?rio de Akaike (ver sec?a?o 3.7), que penaliza por um lado o mau ajuste do\n\nmodelo aos dados e por outro lado o nu?mero de para?metros do modelo. Para aumentar\n\na robustez do crite?rio de Akaike, primeiramente foram estimados modelos com base\n\nnos dados de estimac?a?o, para va?rios valores de ny, nu e nk. Em seguida, calculou-se\n\nos res??duos da simulac?a?o livre dos modelos encontrados, comparado com os dados de\n\nvalidac?a?o. Do valor destes res??duos calculou-se o AIC do modelo.\n\nA figura 4.24 mostra um gra?fico onde os AICs dos modelos foram agrupados por\n\nnu?mero de para?metros do modelo (nu + ny). Ou seja, cada valor da figura 4.24 re-\n\npresenta o menor AIC encontrado dentre todos os modelos com um dado nu?mero de\n\npara?metros. O melhor modelo enta?o, segundo o crite?rio adotado, possui 5 para?metros,\n\nsendo ny = 3, nu = 2 e nk = 1:\n\nA(q)y(k) = B(q)u(k) + ?(k)\n\nA(q) = 1 ? 2.796q?1 + 2.634q?2 ? 0.8331q?3\n\nB(q) = 0.003566q?1 ? 0.006526q?2 (4.7)\n\nou, de outra maneira:\n\ny(k) =2.796y(k ? 1) ? 2.634y(k ? 2) + 0.8331y(k ? 3)\n\n+ 0.003566u(k ? 1) ? 0.006526u(k ? 2) + ?(k). (4.8)\n\nUma simulac?a?o livre do modelo, comparada com os dados de validac?a?o pode ser\n\nvista na figura 4.25. Nesta simulac?a?o, as condic?o?es iniciais do modelo foram definidas\n\ncomo sendo o valor da sa??da do sistema real para os tre?s primeiros valores da sa??da, ja?\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 67\n\nFigura 4.24: Valor de AIC para modelos estimados em torno de Qi = 1.5 kg/s em\n\nfunc?a?o do nu?mero de para?metros do modelo estimado\n\nque o modelo possui 3 estados. A partir de k = 4 (inclusive), o modelo foi simulado\n\ntendo em comum com o sistema real apenas a entrada do sistema. Uma ana?lise visual\n\nda figura 4.25 sugere que o modelo encontrado e? adequado para explicar a pressa?o no\n\ntubo de produc?a?o a partir da vaza?o de ga?s injetado na entrada do sistema.\n\nComo ??ndice para quantificar a qualidade do ajuste da curva de sa??da do modelo\n\nsimulado aos dados reais de validac?a?o, utilizou-se o ??ndice de ajuste dado pela equac?a?o\n\n3.92, resultando num ajuste de 66.4%. Aqui vale comentar que o uso da func?a?o compare\n\ndo Matlab resultaria num melhor ajuste da curva para o mesmo modelo (neste caso, a\n\nfunc?a?o compare do Matlab encontrou um ajuste de 80.4%), uma vez que ela busca um\n\nconjunto de condic?o?es iniciais que minimize o res??duo na comparac?a?o dos resultados.\n\nPor outro lado, a func?a?o de comparac?a?o e ca?lculo de ajuste implementada neste traba-\n\nlho utiliza como condic?o?es iniciais os primeiros valores da se?rie de dados de validac?a?o\n\ne somente depois deixa o modelo \u201crodar livremente\u201d, por isso o ??ndice de ajuste das\n\ncurvas pode ficar pior. A justificativa para esta escolha de func?a?o e? que escolher as\n\ncondic?o?es iniciais que possibilitem um melhor ajuste das curvas parece de certa forma\n\nartificial. Ale?m disso, deseja-se utilizar o mesmo ??ndice de desempenho quando for\n\nfeita a comparac?a?o com os modelos na?o-lineares NARMAX mais adiante no trabalho\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 68\n\nFigura 4.25: Simulac?a?o livre do modelo ARX encontrado em torno de Qi = 1.5 kg/s\n\ne as bibliotecas padro?es do Matlab na?o possuem suporte a este tipo de modelo, da?? a\n\nnecessidade da implementac?a?o de uma nova func?a?o.\n\nDesprezando-se a parte aleato?ria do modelo (a dina?mica do ru??do). e substituindo-\n\nse q = z, onde q e? o operador de atraso e z corresponde a? transformada z do sistema,\n\npodemos encontrar a func?a?o de transfere?ncia entre a entrada e sa??da do modelo ARX\n\nem ana?lise:\nY (z)\n\nU(z)\n=\n\n0.003566z2 ? 0.006526z\nz3 ? 2.796z2 + 2.634z ? 0.8331\n\n, (4.9)\n\nde onde se calculam os 3 po?los e 2 zeros existentes:\n\np1 = 0.8555 z1 = 1.8300\n\np2 = 0.9703 + 0.1797i z2 = 0.0000\n\np3 = 0.9703 ? 0.1797i. (4.10)\n\nA figura 4.26 mostra ale?m da localizac?a?o dos po?los e zeros, a regia?o onde com 99% de\n\nprobabilidade eles se localizam (em trac?o e ponto). Percebe-se que na?o ha? necessidade\n\nde reduzir a ordem do modelo, pois na?o ocorrem cancelamentos prova?veis entre po?los\n\ne zeros.\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 69\n\nFigura 4.26: Diagrama de po?los e zeros do modelo ARX encontrado em torno de\n\nQi = 1.5 kg/s, com as respectivas regio?es de 99% de probabilidade (em trac?o e ponto)\n\nPara proceder com a identificac?a?o do modelo ARX da equac?a?o 4.7, supo?s-se que\n\no ru??do presente no sistema era branco. No entanto, caso tal hipo?tese na?o fosse ver-\n\ndadeira, os para?metros do modelo encontrado seriam polarizados. Atrave?s da ana?lise\n\nde res??duos, pode-se verificar se a dina?mica existente foi modelada adequadamente.\n\nNa figura 4.27 pode observa-se a autocorrelac?a?o dos res??duos do modelo. Nesta figura\n\npercebe-se que existe uma dina?mica na?o modelada no res??duo, em particular parece\n\nhaver uma correlac?a?o entre ?(k) e ?(k ? 5), o que pode ter resultado numa polarizac?a?o\ndos para?metros estimados.\n\nPassa-se enta?o para o uso de um modelo ARMAX, que com a parte me?dia mo?vel\n\nbusca eliminar a polarizac?a?o da estimativa dos para?metros. Apo?s um processo intera-\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 70\n\nFigura 4.27: Autocorrelac?a?o dos res??duos do modelo ARX encontrado em torno de\n\nQi = 1.5 kg/s, com os intervalos de confianc?a de 99%\n\ntivo de busca do melhor modelo, encontrou-se o modelo abaixo:\n\nA(q)y(k) = B(q)u(k) + C(q)?(t)\n\nA(q) = 1 ? 2.634q?1 + 2.319q?2 ? 0.6755q?3\n\nB(q) = 0.01326q?1 ? 0.01763q?2\n\nC(q) = 1 ? 0.4218q?1 + 0.1711q?2 + 0.08476q?3\n\n+ 0.1723q?4 ? 0.8331q?5 + 0.4569q?6 (4.11)\n\nou, de outra maneira:\n\ny(k) = 2.634y(k ? 1) ? 2.319y(k ? 2) + 0.6755y(k ? 3)\n\n+ 0.01326u(k ? 1) ? 0.01763u(k ? 2)\n\n+ ?(k) ? 0.4218?(k ? 1) + 0.1711?(k ? 2) + 0.08476?(k ? 3)\n\n+ 0.1723?(k ? 4) ? 0.8331?(k ? 5) + 0.4569?(k ? 6). (4.12)\n\nA figura 4.28 mostra a autocorrelac?a?o dos res??duos do modelo ARMAX encon-\n\ntrado, calculadas com o uso dos dados de estimac?a?o. Percebe-se que desta vez na?o\n\nha? evide?ncias de qualquer dina?mica na?o modelada nos res??duos, ja? que todos os va-\n\nlores do gra?fico esta?o dentro da faixa onde estatisticamente sa?o iguais a zero (com\n\n99% de probabilidade). A u?nica excec?a?o e? o ponto zero, mas isso e? esperado, ja? que\n\n?(k) = ?(k + 0).\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 71\n\nFigura 4.28: Autocorrelac?a?o dos res??duos do modelo ARMAX encontrado em torno de\n\nQi = 1.5 kg/s, com os intervalos de confianc?a de 99%\n\nUma simulac?a?o livre deste modelo pode ser vista na figura 4.29. O ??ndice de ajuste\n\ndo modelo aos dados de validac?a?o foi de 79.6%, que e? superior ao ajuste de 66.4% do\n\nmodelo ARX encontrado anteriormente. E? importante notar que a parte me?dia mo?vel\n\ndo modelo (polino?mio C(q)) e? utilizada somente na estimac?a?o dos para?metros para\n\nevitar polarizac?a?o. Para a simulac?a?o e? utilizada somente a parte determin??stica do\n\nmodelo, ou seja, os polino?mios A(q) e B(q).\n\nFazendo q = z, encontramos a func?a?o de transfere?ncia do modelo ARMAX encon-\n\ntrado:\nY (z)\n\nU(z)\n=\n\n0.01326z2 ? 0.01763z\nz3 ? 2.634z2 + 2.319z ? 0.6755\n\n, (4.13)\n\nde onde se calculam os 3 po?los e 2 zeros:\n\np1 = 0.6969 z1 = 1.3297\n\np2 = 0.9685 + 0.1766i z2 = 0.0000\n\np3 = 0.9685 ? 0.1766i. (4.14)\n\nO diagrama de po?los e zeros pode ser visto na figura 4.30, juntamente com a regia?o\n\nonde com 99% de probabilidade eles se encontram (em trac?o e ponto). As diferenc?as\n\nmais evidentes em relac?a?o ao diagrama de po?los e zeros do modelo ARX (figura 4.26)\n\ne? o deslocamento do zero que esta? fora do c??rculo unita?rio em direc?a?o a? origem e o\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 72\n\nFigura 4.29: Simulac?a?o livre do modelo ARMAX encontrado em torno de Qi = 1.5\n\nkg/s\n\ndeslocamento do po?lo real tambe?m em direc?a?o a? origem, o que demonstra como a\n\nestimativa dos para?metros do modelo ARX estava polarizada. Ale?m disso, a regia?o\n\nonde com 99% de probabilidade se localiza o zero fora do c??rculo unita?rio reduziu seu\n\ntamanho, indicando um aumento da precisa?o da estimac?a?o deste para?metro. Ja? a\n\nlocalizac?a?o do po?lo real tornou-se mais incerta no modelo ARMAX.\n\n4.4.2 Identificac?a?o em torno de u=2.15 kg/s\n\nPara efetuar a identificac?a?o em torno do ponto de operac?a?o existente com a injec?a?o\n\nde ga?s igual Qi = 2.15 kg/s, seguiu-se passos similares aos mostrados na sec?a?o 4.4.1.\n\nBuscou-se inicialmente um modelo ARX com 1 ? ny ? 8, 1 ? nu ? 8 e 0 ? nk ? 5,\nsendo os valores dos AICs encontrados mostrados na figura 4.31. Com base neste\n\ngra?fico, o melhor modelo e? um modelo com 6 para?metros, sendo ny = 3, nu = 3 e\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 73\n\nFigura 4.30: Diagrama de po?los e zeros do modelo ARMAX encontrado em torno de\n\nQi = 1.5 kg/s, com as respectivas regio?es de 99% de probabilidade (em trac?o e ponto)\n\nnk = 0:\n\nA(q)y(k) = B(q)u(k) + ?(k)\n\nA(q) = 1 ? 2.582q?1 + 2.251q?2 ? 0.6604q?3\n\nB(q) = 0.006281 ? 0.003272q?1 ? 0.004691q?2. (4.15)\n\nNo entanto, o modelo com ny = 3, nu = 2 e nk = 1 na?o apresenta uma performance\n\nmuito inferior ao modelo mostrado na equac?a?o 4.15, com a vantagem de manter a\n\nmesma estrutura do modelo encontrado na sec?a?o 4.4.1 (equac?a?o 4.7), o que era uma\n\ndas metas da identificac?a?o linear em curso. Portanto, prefere-se utilizar o modelo:\n\nA(q)y(k) = B(q)u(k) + ?(k)\n\nA(q) = 1 ? 2.519q?1 + 2.137q?2 ? 0.607q?3\n\nB(q) = 0.01139q?1 ? 0.01345q?2. (4.16)\n\nO teste da autocorrelac?a?o dos res??duos do modelo ARX estimado (equac?a?o 4.16)\n\npode ser visto na figura 4.32. Ali percebe-se um forte ind??cio de polarizac?a?o da es-\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 74\n\nFigura 4.31: Valor de AIC para modelos estimados em torno de Qi = 2.15 kg/s em\n\nfunc?a?o do nu?mero de para?metros do modelo estimado\n\ntimativa dos para?metros do modelo, ja? que a figura demonstra haver uma dina?mica\n\nna?o modelada no res??duo do modelo (atrasos 2, 4, 5 e 6 fora da faixa onde seriam\n\nestatisticamente nulos).\n\nParte-se enta?o para um modelo ARMAX com estrutura similar ao modelo ARX\n\nmostrado na equac?a?o 4.16, chegando, apo?s o teste de va?rios modelos candidatos, ao\n\nmodelo:\n\nA(q)y(k) = B(q)u(k) + C(q)?(t)\n\nA(q) = 1 ? 2.492q?1 + 2.087q?2 ? 0.5826q?3\n\nB(q) = 0.0121q?1 ? 0.01423q?2\n\nC(q) = 1 ? 0.9664q?1 + 0.008977q?2 + 0.0006797q?3\n\n+ 0.05992q?4 ? 0.5734q?5 + 0.6454q?6 (4.17)\n\nDesta vez, na?o ha? ind??cios de dina?mica na?o modelada dos res??duos, como pode ser\n\nvisto na figura 4.33, portanto os para?metros devem estar mais pro?ximos dos valores\n\n\u201creais\u201d. O desempenho do modelo pode ser visto na figura 4.34 que mostra uma\n\nsimulac?a?o livre do modelo comparada com a sa??da real do sistema. O ??ndice de ajuste\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 75\n\nFigura 4.32: Autocorrelac?a?o dos res??duos do modelo ARX encontrado em torno de\n\nQi = 2.15 kg/s, com os intervalos de confianc?a de 99%\n\ndo modelo aos dados de validac?a?o foi de 79.82%, o que representa um desempenho\n\nmuito bom.\n\nA func?a?o de transfere?ncia do modelo e? mostrada abaixo:\n\nY (z)\n\nU(z)\n=\n\n0.0121z2 ? 0.01423z\nz3 ? 2.492z2 + 2.087z ? 0.5826\n\n, (4.18)\n\nde onde se calculam os 3 po?los e 2 zeros existentes (mostrados sob a forma de diagrama\n\nna figura 4.35):\n\np1 = 0.7031 z1 = 1.1767\n\np2 = 0.8946 + 0.1680i z2 = 0.0000\n\np3 = 0.8946 ? 0.1680i. (4.19)\n\n4.4.3 Identificac?a?o em torno de u=2.8 kg/s\n\nPara a identificac?a?o em torno deste ponto, novamente buscou-se um modelo ARX\n\nque satisfizesse 1 ? ny ? 8, 1 ? nu ? 8 e 0 ? nk ? 5. O gra?fico mostrando o valor\ndo AIC em func?a?o do nu?mero de para?metros do modelo esta? mostrado na figura 4.36.\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 76\n\nFigura 4.33: Autocorrelac?a?o dos res??duos do modelo ARMAX encontrado em torno de\n\nQi = 2.15 kg/s, com os intervalos de confianc?a de 99%\n\nFigura 4.34: Simulac?a?o livre do modelo ARMAX encontrado em torno de Qi = 2.15\n\nkg/s\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 77\n\nFigura 4.35: Diagrama de po?los e zeros do modelo ARMAX encontrado em torno de\n\nQi = 2.15 kg/s, com as respectivas regio?es de 99% de probabilidade (em trac?o e ponto)\n\npouco vis??veis neste caso\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 78\n\nSegundo este crite?rio, o melhor modelo para descrever a relac?a?o Ptp \u00d7 Qi quando Qi\noscila em torno de 2.8 kg/s possui 9 para?metros, sendo ny = 2, nu = 7 e nk = 0:\n\nA(q)y(k) = B(q)u(k) + ?(k)\n\nA(q) = 1 ? 1.734q?1 + 0.7698q?2\n\nB(q) = 0.005164 + 0.001886q?1 ? 0.001235q?2 ? 0.00241q?3\n\n? 0.00145q?4 ? 0.001435q?5 ? 0.002131q?6 (4.20)\n\nFigura 4.36: Valor de AIC para modelos estimados em torno de Qi = 2.8 kg/s em\n\nfunc?a?o do nu?mero de para?metros do modelo estimado\n\nNo entanto a ordem deste modelo parece desnecessariamente alta, especialmente ao\n\nse observar o diagrama de po?los e zeros deste modelo na figura 4.37. Ali vemos que os\n\ndois zeros complexos com parte real negativa possuem uma grande incerteza sobre a\n\nlocalizac?a?o, como se pode notar pelas duas elipses que delimitam a regia?o de 99% de\n\nprobabilidade. O zero real com parte real negativa tambe?m possui uma grande incerteza\n\nde localizac?a?o, correspondendo ao segmento de reta sobre o eixo das abscissas. Ale?m de\n\nhaver grande incerteza sobre a localizac?a?o destes zeros (ou seja, sobre os coeficientes do\n\npolino?mio B(q)), ha? um prova?vel cancelamento destes zeros com os po?los localizados na\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 79\n\norigem. Tenta-se portanto encontrar um outro modelo ARX que possua ordem menor\n\nmas que ainda seja capaz de representar adequadamente a dina?mica do sistema.\n\nFigura 4.37: Diagrama de po?los e zeros do modelo ARX encontrado em torno de\n\nQi = 2.8 kg/s, com as respectivas regio?es de 99% de probabilidade (em trac?o e ponto)\n\nO novo modelo com ordem mais baixa encontrado utilizando o crite?rio de Akaike e?\n\num modelo ARX com ny = 3, nu = 3 e nk = 0, mas que na?o apresenta um desempenho\n\nmuito superior a um modelo ARX com ny = 3, nu = 2 e nk = 1 (apresentando ajuste\n\naos dados de validac?a?o de 74.71% e 74.67%, respectivamente). Prefere-se enta?o este\n\nu?ltimo por apresentar estrutura ide?ntica aos utilizados em torno de Qi = 1.5 kg/s e\n\nQi = 2.15 kg/s. O modelo utilizado e? enta?o:\n\nA(q)y(k) = B(q)u(k) + ?(k)\n\nA(q) = 1 ? 2.382q?1 + 1.909q?2 ? 0.5134q?3\n\nB(q) = 0.01103q?1 ? 0.01178q?2 (4.21)\n\nEste modelo, entretanto, apresenta uma dina?mica na?o modelada do ru??do, como pode\n\nser visto na figura 4.38. Assim, opta-se pelo uso de um modelo ARMAX, como feito\n\nnos dois outros pontos de operac?a?o. O modelo ARMAX escolhido consegue modelar\n\nadequadamente a dina?mica dos res??duos, como se pode ver na figura 4.39, sendo dado\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 80\n\nFigura 4.38: Autocorrelac?a?o dos res??duos do modelo ARX encontrado em torno de\n\nQi = 2.8 kg/s, com os intervalos de confianc?a de 99%\n\npelos seguintes polino?mios:\n\nA(q)y(k) = B(q)u(k) + C(q)?(t)\n\nA(q) = 1 ? 2.324q?1 + 1.8q?2 ? 0.4617q?3\n\nB(q) = 0.01227q?1 ? 0.01301q?2\n\nC(q) = 1 ? 1.127q?1 + 0.04333q?2 + 0.06346q?3\n\n+ 0.1797q?4 ? 0.3374q?5 + 0.2615q?6 (4.22)\n\nUma comparac?a?o entre a sa??da da simulac?a?o livre do modelo ARMAX e os dados\n\nde validac?a?o pode ser vista na figura 4.40. Nesta comparac?a?o, o ajuste do modelo\n\naos dados foi de 75.73%. Ali percebe-se que exceto pelos primeiros 1000 segundos, o\n\nmodelo tem um o?timo ajuste aos dados.\n\nQuanto a? estrutura em si do modelo, temos que a func?a?o de transfere?ncia entre a\n\nentrada e a sa??da e? dada por:\n\nY (z)\n\nU(z)\n=\n\n0.01227z2 ? 0.01301z\nz3 ? 2.324z2 + 1.8z ? 0.4617\n\n, (4.23)\n\nde onde se calculam os 3 po?los e 2 zeros existentes (mostrados sob a forma de diagrama\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 81\n\nFigura 4.39: Autocorrelac?a?o dos res??duos do modelo ARMAX encontrado em torno de\n\nQi = 2.8 kg/s, com os intervalos de confianc?a de 99%\n\nFigura 4.40: Simulac?a?o livre do modelo ARMAX encontrado em torno de Qi = 2.8\n\nkg/s\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 82\n\nna figura 4.41):\n\np1 = 0.6244 z1 = 1.0601\n\np2 = 0.8497 + 0.1321i z2 = 0.0000\n\np3 = 0.8497 ? 0.1321i. (4.24)\n\nFigura 4.41: Diagrama de po?los e zeros do modelo ARMAX encontrado em torno de\n\nQi = 2.8 kg/s, com as respectivas regio?es de 99% de probabilidade (em trac?o e ponto)\n\n4.4.4 Comenta?rios sobre os modelos lineares identificados\n\nNas sec?o?es 4.4.1, 4.4.2 e 4.4.3 foram feitas a identificac?a?o de modelos lineares em\n\ntorno dos valores de entrada Qi = 1.5, Qi = 2.15 e Qi = 2.8 kg/s, respectivamente.\n\nAinda que os modelos que melhor se ajustassem aos dados dos tre?s conjuntos na?o\n\ntivessem a mesma estrutura, optou-se em manter a estrutura fixa para facilitar a com-\n\nparac?a?o. O desempenho dos modelos na?o apresentou piora significativa por tal res-\n\ntric?a?o, sendo os modelos encontrados adequados para fins de projeto de controladores\n\ndesde que o sistema opere dentro de uma estreita faixa.\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 83\n\nO ganho esta?tico de um modelo linear identificado em um dado ponto de operac?a?o\n\ncorresponde a? derivada da curva mostrada na figura 4.15). Assim, ja? era esperado que o\n\nganho esta?tico dos tre?s modelos lineares na?o fosse o mesmo. Ale?m disso, a localizac?a?o\n\ndos po?los e zeros dos tre?s modelos e? diferente, como pode ser observado na tabela\n\n4.1. Nela vemos que conforme se aumentou a vaza?o de injec?a?o de ga?s (passando de\n\nQi = 1.5 a Qi = 2.8 kg/s) os po?los do sistema deslocaram-se em direc?a?o a? origem, ou\n\nseja, tornaram-se mais ra?pidos. Tal posicionamento dos po?los era esperado observando-\n\nse as figuras 4.19, 4.20 e 4.21, onde se percebe que conforme aumenta-se o valor de Qi as\n\nfrequ?e?ncias mais altas passam a estar mais presentes na sa??da, tornando a resposta do\n\nsistema mais ra?pida. Na figura 4.19 (referente a Qi = 1.5 kg/s), por exemplo, percebe-\n\nse que as alterac?o?es no sinal de entrada levam um tempo maior ate? serem refletidas no\n\nsinal de sa??da do que no caso da identificac?a?o feita em torno de Qi = 2.15 ou Qi = 2.8\n\nkg/s.\n\nEm relac?a?o ao po?lo real puro existente, conve?m notar que apesar de ele estar mais\n\nafastado na origem para o caso onde Qi = 2.15 kg/s, tal fato na?o e? garantido, dada a\n\nincerteza do posicionamento dos po?los vista nas figuras 4.30 e 4.35. No caso de Qi = 1.5\n\nkg/s, onde a incerteza e? maior, a observac?a?o da linha trac?o e ponto da figura 4.30 nos\n\npermite dizer que com 99% de probabilidade este po?lo localiza-se entre 0.6 e 0.79. Assim\n\ne? poss??vel que tambe?m o po?lo real puro seja maior para o modelo identificado em torno\n\nde Qi = 1.5 kg/s e menor para o modelo identificado em torno de Qi = 2.8 kg/s. Na\n\nidentificac?a?o realizada, os po?los reais puros dos casos onde Qi = 1.5 e Qi = 2.15 kg/s sa?o\n\npraticamente iguais, de forma que a diferenc?a na resposta e? influenciada pela dina?mica\n\ndos dois po?los complexos conjugados. No caso onde Qi = 1.5 kg/s eles esta?o mais\n\ndistantes da origem que nos outros dois casos, confirmando a dina?mica mais lenta. A\n\nfigura 4.42 mostra num mesmo diagrama os po?los e zeros dos tre?s modelos identificados,\n\npossibilitando a visualizac?a?o da regia?o em que eles podem ser encontrados quando se\n\nvaria o ponto de operac?a?o.\n\nO sistema em ana?lise entretanto e? bastante na?o-linear, como ja? mencionado anteri-\n\normente. Desta forma, a regia?o de validade dos modelos identificados na?o sera? muito\n\ngrande. Para testar o quanto sa?o va?lidos os modelos identificados quando aumenta a\n\nregia?o de operac?a?o, utilizou-se como entrada o mesmo sinal mostrado na figura 4.23,\n\nmas multiplicou-se a amplitude de ?u(t) primeiramente por dois e depois por tre?s,\n\nfazendo o sinal ?u(t) variar entre -0.2 e 0.2 kg/s, no primeiro caso e entre -0.3 e 0.3\n\nkg/s no segundo caso. A tabela 4.2 mostra o quanto se altera o ajuste da sa??da do\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 84\n\nQi = 1.5 kg/s Qi = 2.15 kg/s Qi = 2.8 kg/s\n\nPo?los\n0.6969 0.7031 0.6244\n\n0.9685 \u00b1 0.1766i 0.8946 \u00b1 0.1680i 0.8497 \u00b1 0.1321i\n\nZeros\n1.3297 1.1767 1.0601\n\n0.0000 0.0000 0.0000\n\nGanho Esta?tico\n0.013255 0.012272 0.012096\n\n(MPa s/Kg)\n\nTabela 4.1: Po?los, zeros e ganhos esta?ticos dos modelos lineares identificados\n\nFigura 4.42: Diagrama com os po?los e zeros de todos os tre?s modelos lineares encon-\n\ntrados\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 85\n\nPonto de operac?a?o do modelo\n\nAmplitude do sinal ?u(t) Qi = 1.5 kg/s Qi = 2.15 kg/s Qi = 2.8 kg/s\n\n0.2 kg/s 79.6% 79.8% 75.7%\n\n0.4 kg/s 72.0% 80.5% 75.1%\n\n0.6 kg/s 52.9% 74.0% 70.1%\n\nTabela 4.2: Ajuste das curvas dos modelos lineares para diferentes amplitudes do sinal\n\nde entrada\n\nmodelo aos dados reais. As figuras 4.43, 4.44 e 4.45 mostram a comparac?a?o entre uma\n\nsimulac?a?o livre dos modelos obtidos em torno de Qi = 1.5, Qi = 2.15 e Qi = 2.8 kg/s,\n\nrespectivamente, para ?u(t) variando entre -0.3 e 0.3 kg/s.\n\nO fato de que o modelo obtido em torno de Qi = 2.8 kg/s ser mais robusto a?\n\nvariac?o?es na amplitude da entrada, comparado com os outros dois modelos obtidos, e?\n\njustificado observando-se a figura 4.15. Ali pode-se ver que com o aumento da vaza?o\n\nde injec?a?o de ga?s na entrada do sistema, a inclinac?a?o da curva com os pontos fixos\n\naproxima-se da horizontal, portanto a variac?a?o do ganho esta?tico com a mudanc?a de\n\nQi e? menor tambe?m naquela regia?o. A melhoria do ajuste da curva para o modelo\n\nidentificado em torno de Qi = 2.15 kg/s e? muito pequeno e pode ser considerada\n\nacidental, na?o sendo digna de nota.\n\nEm todos os tre?s modelos lineares identificados ha? um zero de fase na?o-m??nima (fora\n\ndo c??rculo unita?rio). A presenc?a deste zero representa uma dificuldade no projeto do\n\ncontrolador, pois implica que para uma dada entrada aplicada no sistema, a resposta\n\nsera? primeiramente no sentido contra?rio ao esperado em regime permanente. A figura\n\n4.46 mostra o resultado da aplicac?a?o de um degrau unita?rio na entrada do modelo linear\n\nencontrado em torno de Qi = 2.15 kg/s (equac?a?o 4.17). Nela se percebe claramente\n\nque como o ganho esta?tico do modelo e? negativo, em regime permanente a sa??da do\n\nmodelo sera? negativa. No entanto, logo apo?s aplicado o degrau, a sa??da do modelo\n\natinge ?y = 0.06 MPa (positivo). E outro inconveniente deste zero e? que ele na?o\n\npode ser cancelado pela adic?a?o de um po?lo no controlador, sob o risco de instabilizar\n\no sistema.\n\nE? poss??vel concluir-se, a? luz dos modelos obtidos, que a variac?a?o do ganho esta?tico\n\nrepresenta uma parte importante da na?o-linearidade. Pode-se tentar utilizar este co-\n\nnhecimento de alguma maneira para facilitar o projeto do controlador.\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 86\n\nFigura 4.43: Simulac?a?o livre do modelo ARMAX encontrado em torno de Qi = 1.5\n\nkg/s com a amplitude da entrada de 0.6 kg/s\n\nFigura 4.44: Simulac?a?o livre do modelo ARMAX encontrado em torno de Qi = 2.15\n\nkg/s com a amplitude da entrada de 0.6 kg/s\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 87\n\nFigura 4.45: Simulac?a?o livre do modelo ARMAX encontrado em torno de Qi = 2.8\n\nkg/s com a amplitude da entrada de 0.6 kg/s\n\nFigura 4.46: Sa??da do modelo ARMAX encontrado em torno de Qi = 2.8 kg/s para\n\num degrau unita?rio aplicado na entrada\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 88\n\n4.5 Identificac?a?o na?o-Linear\n\nOs modelos lineares encontrados para este sistema te?m validade somente dentro\n\nde uma faixa estreita em torno dos pontos onde foram identificados. Isso se deve\n\nprincipalmente em func?a?o da variac?a?o do ganho esta?tico do sistema de acordo com a\n\nfaixa de operac?a?o. O uso de um modelo na?o-linear parece enta?o bastante adequado\n\npara este sistema, quando se deseja operar numa regia?o mais ampla.\n\nO modelo na?o-linear que sera? usado sera? do tipo NARMAX polinomial. Uma\n\nalterac?a?o feita no modelo NARMAX polinomial, descrito por Chen e Billings [10] na\n\nsec?a?o 2.4, e? que aqui foram inclu??dos como parte dos regressores candidatos os termos\n\ncontendo u(k). A presenc?a de um termo do tipo u(k) entre os termos candidatos\n\nsignifica que pode haver uma transmissa?o imediata de informac?a?o entre a entrada e\n\na sa??da do sistema, ou seja, que uma parte da dina?mica do sistema e? suficientemente\n\nra?pida para refletir-se \u201cimediatamente\u201d na sa??da. Nas equac?o?es 2.11 (NARMAX) e\n\n2.12 (NARMAX polinomial) na?o se considerou termos contendo u(k), somente termos\n\ncom pelo menos um atraso (de u(k ? 1) em diante), pois considerou-se que a sa??da\ndo sistema no instante atual depende de informac?o?es de instantes anteriores. Para\n\nmuitos sistemas ha? que se fazer esta restric?a?o, em particular quando se trabalha com\n\ncontrole preditivo. No entanto, para o sistema em ana?lise, tem-se condic?o?es de saber\n\nexatamente qual e? a entrada do sistema no instante atual, ja? que a entrada do sistema\n\ne? uma refere?ncia do controle da injec?a?o de ga?s, sendo esta estabelecida pelo usua?rio.\n\nAssim, o formato do modelo procurado sera?:\n\ny(k) = ?0 +\nn?\n\ni1=1\n\n?i1xi1 (k) +\nn?\n\ni1=1\n\nn?\ni2=i1\n\n?i1i2xi1 (k) \u00b7 xi2 (k) + . . .\n\n+\nn?\n\ni1=1\n\n\u00b7 \u00b7 \u00b7\nn?\n\nil=il?1\n\n?i1...ilxi1 (k) . . .xil (k) + e(k) (4.25)\n\nonde:\n\nn = ny + nu + 1\n\nx1 = y(k ? 1)\n\nx2 = y(k ? 2)\n...\n\nxny = y(k ? ny)\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 89\n\nxny+1 = u(k)\n\nxny+2 = u(k ? 1)\n...\n\nxn = u(k ? nu)\n\ne ny e? o atraso ma?ximo em y e nu e? o atraso ma?ximo em u.\n\nComo sinal de entrada, adotou-se duas estrate?gias. A primeira e? utilizar um si-\n\nnal mais \u201cagressivo\u201d, com variac?o?es mais abruptas, que possibilite excitar uma grande\n\nquantidade de frequ?e?ncias e regio?es de comportamento do sistema. Pore?m, este sinal\n\nprovavelmente na?o seria bem aceito pelo operador do processo real, por utilizar al-\n\nterac?o?es muito bruscas na entrada, deixando o processo muito \u201csolto\u201d e aumentando o\n\nrisco de danos aos equipamentos. Decorrente disso, fez-se uma segunda identificac?a?o,\n\nutilizando um sinal mais \u201ccomportado\u201d, reaproveitando os dados utilizados para a iden-\n\ntificac?a?o linear feita na sec?a?o 4.4. Este sinal varia de forma menos abrupta, reduzindo\n\no risco de danos a?s instalac?o?es.\n\n4.5.1 Identificac?a?o usando sinal de entrada \u201cagressivo\u201d\n\nO sinal de entrada \u201cagressivo\u201d foi obtido mantendo-se o sinal constante u = 2.15\n\nkg/s, ate? que estivesse completo o transito?rio de inicializac?a?o do poc?o. Em seguida,\n\nsomou-se ao valor 2.15 um sinal aleato?rio com me?dia nula e varia?ncia unita?ria, sendo\n\nque cada patamar do sinal foi mantido por 200 segundos. O uso deste sinal aleato?rio\n\nbusca excitar um largo espectro de frequ?e?ncias. E como o sistema e? na?o-linear, busca-\n\nse, ale?m da excitac?a?o das va?rias frequ?e?ncias existentes, a excitac?a?o das na?o-linearidades\n\nexistentes nas diferentes regio?es de operac?a?o. Assim, o sinal aleato?rio foi multiplicado\n\npor um valor crescente, antes de ser somado a 2.15, de forma que inicialmente o sistema\n\nopere somente em torno da entrada 2.15 kg/s e se afaste cada vez mais deste ponto\n\ncom o passar do tempo. O perfil do sinal de entrada e? mostrado na figura 4.47, e a\n\nsa??da correspondente e? mostrada na figura 4.48. Apesar da regia?o de operac?a?o desejada\n\nconsistir do intervalo de u = 1.5 kg/s a u = 3.0 kg/s, tomou-se o cuidado do sinal de\n\nentrada na?o avanc?ar demasiado em direc?a?o a esses limites, pois no regime transito?rio\n\na sa??da do sistema poderia atingir valores perigosamente fora da regia?o de interesse. A\n\ndurac?a?o total do sinal de teste e? de 15000 segundos, sendo formada por 75 patamares.\n\nEstes dados foram utilizados para estimac?a?o dos para?metros do sistema.\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 90\n\nFigura 4.47: Sinal de entrada do sistema (vaza?o de ga?s injetado) para estimac?a?o de\n\npara?metros do modelo na?o-linear\n\nFigura 4.48: Pressa?o no tubo de produc?a?o (sa??da do sistema) para estimac?a?o de\n\npara?metros do modelo na?o-linear\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 91\n\nTambe?m foi gerado um outro sinal com as mesmas caracter??sticas, mas com ou-\n\ntra realizac?a?o de nu?mero aleato?rios para servir como dados de validac?a?o dos modelos\n\nencontrados. A entrada utilizada para validac?a?o e? mostrada na figura 4.49 e a sa??da\n\ncorrespondente na figura 4.50.\n\nFigura 4.49: Sinal de entrada do sistema (vaza?o de ga?s injetado) para validac?a?o do\n\nmodelo na?o-linear\n\nA determinac?a?o da taxa de reamostragem dos sinais foi feita conforme descrito na\n\nsec?a?o 3.5, sendo a taxa inicial de amostragem utilizada de 1 segundo. A figura 4.51\n\nmostra a autocovaria?ncia normalizada dos dados de estimac?a?o. No caso particular\n\ndeste sistema, a autocovaria?ncia normalizada linear do sinal de entrada coincide com a\n\nautocovaria?ncia normalizada quadra?tica. O primeiro m??nimo de ry?(?) (e tambe?m de\n\nry?2 (?)) ocorre em ? = 742, de forma que a taxa de reamostragem deve satisfazer:\n\n37 ? ? ? 74 (4.26)\n\nFoi escolhido para este sistema um fator de reamostragem ? = 40, por ser a mesma\n\ntaxa utilizada para o caso linear, o que facilita eventuais comparac?o?es. Assim, o novo\n\ntempo de amostragem e? Ts = 40 segundos. O conjunto de dados de estimac?a?o possui\n\nenta?o 376 amostras.\n\nBuscou-se um modelo com grau de na?o-linearidade ` = 2, ny = nu = 5, resul-\n\ntando em 78 termos candidatos. Ale?m destes, incluiu-se 10 termos lineares de ru??do,\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 92\n\nFigura 4.50: Pressa?o no tubo de produc?a?o (sa??da do sistema) para validac?a?o do modelo\n\nna?o-linear\n\npara eliminar a polarizac?a?o da estimac?a?o. O nu?mero de termos de ru??do foi esco-\n\nlhido suficientemente grande para acomodar a dina?mica do ru??do. Poderia ocorrer que\n\nfosse necessa?rio um nu?mero menor de termos, mas nesse caso a pro?pria estimac?a?o de\n\npara?metros se encarregaria de estimar para?metros estatisticamente insignificantes para\n\nos termos a mais. Caso o nu?mero de termos de ru??do fosse menor do que o necessa?rio,\n\ntal fato se revelaria nas equac?o?es 3.89, 3.90 e 3.91. Como os termos que modelam o\n\nru??do sa?o descartados para simulac?a?o do modelo, na?o e? problema?tico ter mais termos\n\npara o ru??do do que o estritamente necessa?rio, mas e? cr??tico ter um nu?mero m??nimo de\n\ntermos.\n\nEm seguida, identificou-se um conjunto de modelos com nu?mero crescente de termos\n\nselecionados pelo crite?rio ERR e calculou-se o coeficiente de agrupamento de termos,\n\npara detectar eventuais agrupamentos de termos espu?rios. A figura 4.52 mostra o\n\ncoeficiente de agrupamentos dos 6 conjuntos existentes (?0, ?y, ?y2 , ?u, ?u2 e ?yu)\n\nnos termos candidatos. Observando-se a figura em busca de ind??cios de agrupamentos\n\nespu?rios, percebemos que o coeficiente de agrupamento ?y2 e? inclu??do tardiamente no\n\nmodelo. Portanto, exclui-se os regressores que compo?em esse agrupamento do conjunto\n\nde termos candidatos. Ale?m do agrupamento ?y2 ser espu?rio segundo o teste feito, ele e?\n\nindeseja?vel no conjunto de regressores candidatos, pois se deseja um modelo NARMAX\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 93\n\nFigura 4.51: Func?a?o de autocovaria?ncia normalizada do sinal de sa??da usada para defi-\n\nnir o fator de reamostragem adequado para a identificac?a?o na?o-linear (a autocovaria?ncia\n\nnormalizada linear e quadra?tica sa?o iguais neste caso)\n\npolinomial com somente um ponto fixo (ver equac?a?o 3.86). O novo conjunto de termos\n\ncandidatos passa a ter enta?o 63 termos de processo candidatos em 5 agrupamentos:\n\n?0, ?y, ?u, ?u2 e ?yu.\n\nO crite?rio ERR foi utilizado para ordenar os termos que devem ser inclu??dos no\n\nmodelo final. Para a selec?a?o do ponto de corte, ou seja, do nu?mero de termos que\n\no modelo efetivamente vai incluir utilizou-se o crite?rio de Akaike. Para cada nu?mero\n\nde para?metros no modelo, estimou-se um modelo com esta quantidade de para?metros\n\ne efetuou-se uma simulac?a?o livre do modelo. Em seguida, calculou-se os res??duos do\n\nmodelo confrontado com os dados de validac?a?o. Estes res??duos foram utilizados para\n\no ca?lculo do AIC. A figura 4.53 mostra os valores do crite?rio de Akaike para diferentes\n\nnu?meros de termos no modelo. O menor valor do AIC corresponde ao seguinte modelo\n\ncom 8 termos de processo (mais 10 termos de ru??do para eliminar a polarizac?a?o da\n\nestimac?a?o de para?metros), sendo o valor dos para?metros estimados, os respectivos\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 94\n\nFigura 4.52: Coeficientes de agrupamento do modelo NARMAX obtido para o sistema\n\nexcitado com uma entrada \u201cagressiva\u201d em func?a?o do nu?mero de para?metros do modelo\n\nERR e desvio padra?o do para?metro estimado listados na tabela 4.3:\n\ny(k) = +2.48317 y(k ? 1)\n?1.99585 y(k ? 2)\n+5.07796\u00d710?1 y(k ? 3)\n+2.78594\u00d710?2 u(k ? 2)y(k ? 3)\n+2.75746\u00d710?3 u(k ? 2)u(k)\n+3.06819\u00d710?2\n\n?4.90432\u00d710?4 u(k ? 4)u(k)\n?3.12171\u00d710?2 u(k ? 2)y(k ? 2)\n+?(k)\n\n(4.27)\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 95\n\nOrdem Regressor ??i ERR ?\n\n1 y(k ? 1) +2.48317 +9.99997\u00d710?1 +5.80593\u00d710?2\n\n2 y(k ? 2) ?1.99585 +2.35586\u00d710?6 +1.55969\u00d710?1\n\n3 y(k ? 3) +5.07796\u00d710?1 +1.11143\u00d710?7 +1.08937\u00d710?1\n\n4 u(k ? 2)y(k ? 3) +2.78594\u00d710?2 +1.97021\u00d710?8 +3.60594\u00d710?2\n\n5 u(k ? 2)u(k) +2.75746\u00d710?3 +1.36129\u00d710?8 +3.35207\u00d710?4\n\n6 constante +3.06819\u00d710?2 +5.99208\u00d710?9 +6.99328\u00d710?3\n\n7 u(k ? 4)u(k) ?4.90432\u00d710?4 +3.87273\u00d710?9 +2.54059\u00d710?4\n\n8 u(k ? 2)y(k ? 2) ?3.12171\u00d710?2 +1.40659\u00d710?9 +3.61177\u00d710?2\n\nTabela 4.3: Termos do modelo NARMAX identificado para uma entrada agressiva, em\n\nordem do valor de ERR. ??i e? o valor do para?metro estimado e ? e? o valor do desvio\n\npadra?o do para?metro estimado\n\nonde ?(k) conte?m os 10 termos lineares de res??duo, na?o sendo necessa?rios a? simulac?a?o\n\ndo sistema:\n?(k) = ?5.84466\u00d710?1 ?(k ? 1)\n\n?2.61484\u00d710?1 ?(k ? 7)\n+1.30859\u00d710?1 ?(k ? 3)\n?1.28290\u00d710?1 ?(k ? 2)\n?1.99363\u00d710?1 ?(k ? 10)\n?8.05819\u00d710?2 ?(k ? 8)\n?1.43919\u00d710?1 ?(k ? 5)\n?1.23529\u00d710?1 ?(k ? 6)\n+7.61805\u00d710?2 ?(k ? 4)\n?2.52195\u00d710?2 ?(k ? 9).\n\n(4.28)\n\nObservando-se o valor dos para?metros estimados (??i) e comparando-se com o valor\n\ndo desvio padra?o dos para?metros na tabela 4.3, podemos testar se os para?metros esti-\n\nmados sa?o estatisticamente significativos. Para uma confianc?a de 99%, os para?metros\n\nsera?o estatisticamente insignificantes se ?3?i ? ??i ? 3?i. Portanto, os para?metros\ncorrespondentes aos termos u(k ? 2)y(k ? 3), u(k ? 4)u(k) e u(k ? 2)y(k ? 2) na?o\nte?m significa?ncia estat??stica e devem ser removidos do conjunto de termos candidatos,\n\nsendo necessa?ria a estimac?a?o de um novo modelo.\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 96\n\nFigura 4.53: Valor do AIC em func?a?o do nu?mero de para?metros para modelos NAR-\n\nMAX do sistema excitado por uma entrada agressiva\n\nOs seguintes passos foram enta?o executados de forma iterativa: gerou-se um novo\n\nconjunto de termos candidatos sem os termos considerados insignificantes estatisti-\n\ncamente, ordenou-se estes termos pelo ERR, definiu-se o nu?mero de termos a serem\n\ninclu??dos com o uso do AIC e verificou-se a significa?ncia estat??stica dos termos do\n\nmodelo encontrado. O modelo encontrado possui 6 termos de processo:\n\ny(k) = +2.01356 y(k ? 1)\n?1.01002 y(k ? 2)\n?3.49843\u00d710?2 u(k ? 4)y(k ? 2)\n+2.37093\u00d710?2 u(k ? 4)y(k ? 5)\n+3.09134\u00d710?2 u(k ? 4)\n+8.50101\u00d710?4 u2(k) + ?(k)\n\n(4.29)\n\nonde ?(k) conte?m os termos do tipo MA utilizados para evitar a polarizac?a?o da esti-\n\nmativa dos para?metros.\n\nA tabela 4.4 mostra os termos de processo inclu??dos, juntamente com o ERR e o\n\ndesvio padra?o da estimativa dos para?metros, onde desta vez se verifica que todos os\n\ntermos inclu??dos sa?o estatisticamente significativos com 99% de probabilidade.\n\nEste modelo foi validado estatisticamente, satisfazendo a?s equac?o?es 3.89, 3.90 e\n\n3.91, que garantem que na?o ha? dina?mica na?o modelada nos res??duos. Para validac?a?o\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 97\n\nOrdem Regressor ??i ERR ?\n\n1 y(k ? 1) +2.01356 +9.99997\u00d710?1 +2.23668\u00d710?2\n\n2 y(k ? 2) ?1.01002 +2.35586\u00d710?6 +2.24378\u00d710?2\n\n3 u(k ? 4)y(k ? 2) ?3.49843\u00d710?2 +7.57968\u00d710?8 +2.93181\u00d710?3\n\n4 u(k ? 4)y(k ? 5) +2.37093\u00d710?2 +4.70686\u00d710?8 +3.52717\u00d710?3\n\n5 u(k ? 4) +3.09134\u00d710?2 +1.03597\u00d710?8 +2.84186\u00d710?3\n\n6 u2(k) +8.50101\u00d710?4 +1.18979\u00d710?8 +7.68678\u00d710?5\n\nTabela 4.4: Termos do modelo NARMAX identificado para uma entrada agressiva, em\n\nordem do valor de ERR, com todos os para?metros estatisticamente significativos. ??i e?\n\no valor do para?metro estimado e ? e? o valor do desvio padra?o do para?metro estimado\n\ndina?mica, recorreu-se a uma comparac?a?o entre a sa??da do modelo encontrado e os dados\n\nreais de validac?a?o, mostrada na figura 4.54. O ajuste da sa??da do modelo aos dados\n\nreais e? de 87.78% que e? bastante superior ao desempenho obtido pelos modelos lineares\n\n(ver tabela 4.2), ainda mais quando se considera que no caso linear a entrada oscilou\n\ncom pequena amplitude em torno dos pontos de linearizac?a?o e no caso na?o-linear houve\n\numa grande variac?a?o na amplitude da entrada.\n\nPara calcular os pontos fixos do modelo encontrado, recorre-se a? equac?a?o 3.87, resul-\n\ntando na figura 4.55, que mostra a localizac?a?o dos pontos fixos do modelo comparada\n\ncom a do sistema real. Percebe-se que dentro da faixa de operac?a?o do sistema (que e? de\n\nQi = 1.5 kg/s a Qi = 3 kg/s), o modelo aproxima razoavelmente bem o a caracter??stica\n\nesta?tica real. Na parte central da faixa de operac?a?o o ajuste e? praticamente exato e nas\n\nextremidades ocorre um pequeno erro do modelo em relac?a?o ao sistema real (0.59% em\n\nQi = 1.5 kg/s e -2.76% em Qi = 3 kg/s). Na figura 4.55 este erro pode parecer maior\n\ndevido a? escala utilizada para o eixo das ordenadas.\n\nPara que o modelo encontrado possa ser usado em aplicac?o?es de controle preditivo,\n\nna?o pode haver um modelo instanta?neo entre a entrada e a sa??da, ou seja, na?o podem\n\nexistir termos contendo u(k). Assim, foi identificado um outro modelo, a partir dos\n\ndados \u201cagressivos\u201d, que possa ser u?til para tais aplicac?o?es. Para encontrar um modelo\n\nque ainda seja representativo do sistema, foi necessa?rio reduzir o tempo de amostragem\n\npara Ts = 20 segundos, resultando no seguinte modelo (ver tambe?m tabela 4.5), com\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 98\n\nFigura 4.54: Simulac?a?o livre do modelo NARMAX encontrado com o uso de uma\n\nentrada agressiva comparada com os dados de validac?a?o\n\najuste de 73.1% aos dados de validac?a?o:\n\ny(k) = +2.06136 y(k ? 1)\n?1.06075 y(k ? 2)\n?9.36609\u00d710?1 u(k ? 5)y(k ? 2)\n+6.26485\u00d710?2 u(k ? 5)y(k ? 6)\n+3.13088\u00d710?1 u(k ? 5)y(k ? 1)\n+1.01030 u(k ? 5)y(k ? 3)\n?4.51079\u00d710?1 u(k ? 5)y(k ? 4)\n+4.18587\u00d710?3 u(k ? 5)\n+2.24055\u00d710?4 u(k ? 1)u(k ? 1) + ?(k)\n\n(4.30)\n\n4.5.2 Identificac?a?o usando sinal de entrada \u201ccomportado\u201d\n\nNa sec?a?o 4.5.1 foi identificado um modelo NARMAX que representou adequada-\n\nmente a dina?mica do sistema em ana?lise. No entanto, a entrada utilizada para identi-\n\nficac?a?o do sistema era muito \u201cagressiva\u201d, por apresentar variac?o?es abruptas e, portanto,\n\nrepresenta um risco maior de danos aos equipamentos.\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 99\n\nFigura 4.55: Pontos fixos do modelo NARMAX identificado com a entrada agressiva\n\nem func?a?o da vaza?o de injec?a?o de ga?s, comparado com os pontos fixos do sistema real\n\nNesta sec?a?o sera? feita a identificac?a?o de um modelo NARMAX com o uso de uma\n\nentrada mais bem \u201ccomportada\u201d, ou seja, com variac?o?es mais suaves, de forma a di-\n\nminuir os riscos ao patrimo?nio. A entrada \u201ccomportada\u201d aplicada no sistema e? uma\n\nreutilizac?a?o dos dados utilizados para a identificac?a?o linear. Assim, sendo u1.5 e y1.5\n\nas se?ries colhidas respectivamente na entrada e na sa??da do sistema, utilizadas para\n\nidentificac?a?o linear em torno do ponto de operac?a?o 1.5 kg/s (ver sec?a?o 4.4.1), pode-se\n\nformar a matriz ?1.5 contendo os regressores candidatos para a identificac?a?o na?o-linear.\n\nDa mesma maneira, pode-se formar a matriz ?2.15 com as se?ries u2.15 e y2.15 e a matriz\n\n?2.8 com os se?ries u2.8 e y2.8. As se?ries u2.15 e y2.15 foram utilizadas para identificac?a?o\n\nlinear em torno de 2.15 kg/s (sec?a?o 4.4.2) e as se?ries u2.8 e y2.8 foram utilizadas para\n\nidentificac?a?o linear em torno de 2.8 kg/s (sec?a?o 4.4.3). Assim:\n\n?1.5 = f(u1.5 , y1.5) (4.31)\n\n?2.15 = f(u2.15 , y2.15) (4.32)\n\n?2.8 = f(u2.8 , y2.8) (4.33)\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 100\n\nOrdem Regressor ??i ERR ?\n\n1 y(k ? 1) +2.06136 +9.99999\u00d710?1 +3.11657\u00d710?2\n\n2 y(k ? 2) ?1.06075 +6.17695\u00d710?7 +3.11643\u00d710?2\n\n3 u(k ? 5)y(k ? 2) ?9.36609\u00d710?1 +3.75491\u00d710?9 +1.33013\u00d710?1\n\n4 u(k ? 5)y(k ? 6) +6.26485\u00d710?2 +4.49870\u00d710?9 +1.00275\u00d710?2\n\n5 u(k ? 5)y(k ? 1) +3.13088\u00d710?1 +5.36415\u00d710?10 +4.96058\u00d710?2\n\n6 u(k ? 5)y(k ? 3) +1.01030 +7.87245\u00d710?10 +1.44218\u00d710?1\n\n7 u(k ? 5)y(k ? 4) ?4.51079\u00d710?1 +3.75076\u00d710?10 +7.11290\u00d710?2\n\n8 u(k ? 5) +4.18587\u00d710?3 +1.16190\u00d710?10 +6.85643\u00d710?4\n\n9 u(k ? 1)u(k ? 1) +2.24055\u00d710?4 +2.76396\u00d710?10 +2.85129\u00d710?5\n\nTabela 4.5: Termos do modelo NARMAX identificado para uma entrada agressiva, em\n\nordem do valor de ERR, para aplicac?a?o em controle preditivo. ??i e? o valor do para?metro\n\nestimado e ? e? o valor do desvio padra?o do para?metro estimado\n\ne pode-se definir a matriz ? contendo todos as restric?o?es:\n\n? =\n\n?\n???\n\n?1.5\n\n?2.15\n\n?2.8\n\n?\n??? , (4.34)\n\na ser utilizada nos algoritmos de estimac?a?o de para?metros.\n\nOs dados utilizados para estimac?a?o de para?metros na?o sa?o ideais do ponto de vista\n\nde identificac?a?o, pois o sinal de entrada fica restrito a tre?s regio?es de operac?a?o do\n\nsistema, na?o excursionando por toda a faixa de interesse (entrada variando de 1.5 kg/s\n\na 3 kg/s). Pore?m, o uso deste conjunto de dados te?m duas vantagens claras sobre o\n\nsinal de entrada utilizado na sec?a?o 4.5.1:\n\n\u2022 Representa menos risco ao patrimo?nio, por ser uma entrada mais comportada;\n\n\u2022 Permite a continuidade da produc?a?o durante a execuc?a?o dos testes, pois a um\nsinal constante na entrada adiciona-se apenas uma pequena variac?a?o.\n\nPara a validac?a?o dos modelos obtidos nesta sec?a?o, utilizou-se o mesmo conjunto de\n\ndados utilizados na validac?a?o dos modelos da sec?a?o 4.5.1, ou seja, usou-se a entrada\n\nmostrada na figura 4.49 e a sa??da mostrada na figura 4.50. O uso destes dados foi feito\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 101\n\npara que os modelos obtidos nesta sec?a?o sejam testados de forma mais \u201cagressiva\u201d do\n\nque os dados de estimac?a?o, ale?m de permitir uma comparac?a?o direta entre os ??ndices\n\nde ajuste do modelo nas duas sec?o?es.\n\nInicialmente, utilizou-se as func?o?es de autocovaria?ncia definidas nas equac?o?es 3.5 e\n\n3.6, sendo que a taxa de reamostragem escolhida deve satisfazer a equac?a?o 3.8 nos tre?s\n\nconjuntos de dados. Verificou-se que e? poss??vel escolher a mesma taxa de reamostragem\n\ndas sec?o?es anteriores (? = 40), resultando em Ts = 40 segundos.\n\nPassou-se enta?o a buscar modelos candidatos, com grau de na?o-linearidade ` = 2,\n\nny = nu = 5, e mais 10 termos lineares de ru??do para eliminar a polarizac?a?o da es-\n\ntimac?a?o, como descrito anteriormente na sec?a?o 4.5.1. Do conjunto de termos candidatos\n\nfoi eliminado o agrupamento de termos ?y2 pois se deseja um modelo com apenas um\n\nponto fixo.\n\nApo?s a classificac?a?o dos demais termos candidatos com o uso do ERR, eliminac?a?o\n\ndos agrupamentos espu?rios (o agrupamento ?0 mostrou tambe?m aqui ser espu?rio), a\n\ndefinic?a?o do nu?mero de termos a serem inclu??dos no modelo com o uso do AIC (ver\n\nfigura 4.56), a verificac?a?o da significa?ncia estat??stica dos para?metros estimados e a\n\nrepetic?a?o iterativa deste processo ate? que todos os para?metros sejam significativos,\n\nchegou-se ao modelo:\n\ny(k) = +2.84619 y(k ? 1)\n?2.23221 y(k ? 2)\n+3.88183\u00d710?1 y(k ? 4)\n?7.26036\u00d710?3 u(k ? 2)y(k ? 1)\n+5.29649\u00d710?3 u(k)\n+2.78799\u00d710?3 u(k ? 5)\n?2.67362\u00d710?1 u(k ? 3)y(k ? 1)\n+1.25873\u00d710?2 u(k ? 2)\n?1.22951\u00d710?3 u(k ? 5)u(k ? 3)\n+3.64800\u00d710?1 u(k ? 3)y(k ? 2)\n?9.75874\u00d710?2 u(k ? 3)y(k ? 4)\n+1.73758\u00d710?3 u(k ? 2)u(k ? 2)\n+?(k)\n\n(4.35)\n\nque possui 12 termos de processo e onde ?(k) corresponde aos 10 termos lineares do\n\ntipo me?dia mo?vel utilizados para eliminar a polarizac?a?o da estimativa dos para?metros.\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 102\n\nFigura 4.56: Valor do AIC em func?a?o do nu?mero de para?metros para modelos NAR-\n\nMAX do sistema excitado por uma entrada comportada\n\nOs termos inclu??dos, com os respectivos ERR e desvio padra?o sa?o mostrados na\n\ntabela 4.6. Este modelo antes de tudo foi validado estatisticamente, satisfazendo a?s\n\nequac?o?es 3.89, 3.90 e 3.91. Uma comparac?a?o entre os dados de validac?a?o e a simulac?a?o\n\nlivre do modelo pode ser vista na figura 4.57. O modelo teve um ajuste de 91.2% aos\n\ndados de validac?a?o, que e? um desempenho excelente. O fato do ajuste deste modelo aos\n\ndados de validac?a?o ser superior ao ajuste aos mesmos dados do modelo encontrado na\n\nsec?a?o 4.5.1 (ajuste de 87.78%) na?o significa que o modelo encontrado nesta sec?a?o seja\n\n\u201cmelhor\u201d em todos os sentidos. Um ensaio utilizando uma outra entrada pode resultar\n\nnuma mundanc?a nos ??ndices de desempenho, que esta?o pro?ximos. Ale?m disso, como o\n\nmodelo descrito na equac?a?o 4.29 possui apenas 6 termos de processo (contra 12 termos\n\ndo modelo desta sec?a?o - equac?a?o 4.35) mostra que aquele modelo e? mais \u201cconciso\u201d para\n\ndescrever os dados e e? mais facilmente manipula?vel, que sa?o caracter??sticas deseja?veis\n\nnum modelo \u201cideal\u201d. Pode-se dizer que ambos os modelos descrevem satisfatoriamente\n\na dina?mica do sistema em ana?lise, dentro da faixa de operac?a?o desejada.\n\nA figura 4.58 mostra a caracter??stica esta?tica do modelo, comparada com a carac-\n\nter??stica esta?tica do sistema real. Percebe-se que os pontos fixos do modelo esta?o muito\n\npro?ximos dos pontos fixos do sistema real. O modelo encontrado nesta sec?a?o possui\n\numa caracter??stica esta?tica mais pro?xima do sistema real do que o modelo encontrado\n\nna sec?a?o 4.5.1. A explicac?a?o prova?vel para esta melhora e? que a entrada agressiva\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 103\n\nOrdem Regressor ??i ERR ?\n\n1 y(k ? 1) +2.84619 +9.99997\u00d710?1 +3.94354\u00d710?2\n\n2 y(k ? 2) ?2.23221 +2.97116\u00d710?6 +5.70014\u00d710?2\n\n3 y(k ? 4) +3.88183\u00d710?1 +1.59919\u00d710?7 +1.83896\u00d710?2\n\n4 u(k ? 2)y(k ? 1) ?7.26036\u00d710?3 +5.01335\u00d710?10 +5.33763\u00d710?4\n\n5 u(k) +5.29649\u00d710?3 +2.99404\u00d710?8 +1.78812\u00d710?4\n\n6 u(k ? 5) +2.78799\u00d710?3 +4.68878\u00d710?9 +6.50890\u00d710?4\n\n7 u(k ? 3)y(k ? 1) ?2.67362\u00d710?1 +1.60423\u00d710?9 +2.23946\u00d710?2\n\n8 u(k ? 2) +1.25873\u00d710?2 +7.31568\u00d710?10 +2.18152\u00d710?3\n\n9 u(k ? 5)u(k ? 3) ?1.22951\u00d710?3 +1.47531\u00d710?9 +2.48621\u00d710?4\n\n10 u(k ? 3)y(k ? 2) +3.64800\u00d710?1 +1.58334\u00d710?9 +3.17758\u00d710?2\n\n11 u(k ? 3)y(k ? 4) ?9.75874\u00d710?2 +1.13923\u00d710?9 +9.86630\u00d710?3\n\n12 u(k ? 2)u(k ? 2) +1.73758\u00d710?3 +1.16196\u00d710?9 +2.33335\u00d710?4\n\nTabela 4.6: Termos do modelo NARMAX identificado para uma entrada comportada,\n\nem ordem do valor de ERR, com todos os para?metros estatisticamente significativos. ??i\n\ne? o valor do para?metro estimado e ? e? o valor do desvio padra?o do para?metro estimado\n\nFigura 4.57: Simulac?a?o livre do modelo NARMAX encontrado com o uso de uma\n\nentrada comportada comparada com os dados de validac?a?o\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 104\n\nexcursionava por uma ampla faixa, mas concentrava-se em torno da me?dia do sinal\n\n(u = 2.15 kg/s). A entrada comportada, por outro lado, na?o excursionava por uma\n\nampla faixa, mas tinha valores de entrada concentrados em torno de 3 pontos (u = 1.5,\n\nu = 2.15 e u = 2.8 kg/s). Assim, o estimador tinha \u201cdados melhores\u201d, ao menos para\n\nestimar a caracter??stica esta?tica do sistema.\n\nFigura 4.58: Pontos fixos do modelo NARMAX identificado com a entrada comportada\n\nem func?a?o da vaza?o de injec?a?o de ga?s, comparado com os pontos fixos do sistema real\n\nFinalmente, para uma poss??vel aplicac?a?o em controle preditivo, foi identificado um\n\nmodelo sem termos contendo u(k). Este modelo esta? listado a seguir (ver tambe?m\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 105\n\nOrdem Regressor ??i ERR ?\n\n1 y(k ? 1) +2.84173 +9.99997\u00d710?1 +4.92964\u00d710?2\n\n2 y(k ? 2) ?2.19893 +2.97116\u00d710?6 +6.92244\u00d710?2\n\n3 y(k ? 4) +3.60274\u00d710?1 +1.59919\u00d710?7 +2.17346\u00d710?2\n\n4 u(k ? 2)y(k ? 1) ?1.03589\u00d710?2 +5.01335\u00d710?10 +8.82645\u00d710?4\n\n5 u(k ? 2) +2.30653\u00d710?2 +1.77098\u00d710?8 +2.49163\u00d710?3\n\n6 u(k ? 1) +6.65549\u00d710?3 +6.26630\u00d710?9 +4.81868\u00d710?4\n\n7 u(k ? 3)y(k ? 1) ?3.12043\u00d710?1 +2.03759\u00d710?9 +3.44452\u00d710?2\n\n8 u(k ? 3)y(k ? 2) +4.15930\u00d710?1 +2.77158\u00d710?9 +4.80461\u00d710?2\n\n9 u(k ? 2)u(k ? 2) +1.90760\u00d710?3 +2.74267\u00d710?9 +2.42476\u00d710?4\n\n10 u(k ? 3)y(k ? 4) ?1.04140\u00d710?1 +1.06766\u00d710?9 +1.43814\u00d710?2\n\n11 u(k ? 5)u(k ? 3) ?1.20889\u00d710?3 +1.85126\u00d710?9 +2.12560\u00d710?4\n\nTabela 4.7: Termos do modelo NARMAX identificado para uma entrada comportada,\n\nem ordem do valor de ERR, para aplicac?a?o em controle preditivo. ??i e? o valor do\n\npara?metro estimado e ? e? o valor do desvio padra?o do para?metro estimado\n\ntabela 4.7), com ajuste de 82.9% aos dados de validac?a?o:\n\ny(k) = +2.84173 y(k ? 1)\n?2.19893 y(k ? 2)\n+3.60274\u00d710?1 y(k ? 4)\n?1.03589\u00d710?2 u(k ? 2)y(k ? 1)\n+2.30653\u00d710?2 u(k ? 2)\n+6.65549\u00d710?3 u(k ? 1)\n?3.12043\u00d710?1 u(k ? 3)y(k ? 1)\n+4.15930\u00d710?1 u(k ? 3)y(k ? 2)\n+1.90760\u00d710?3 u(k ? 2)u(k ? 2)\n?1.04140\u00d710?1 u(k ? 3)y(k ? 4)\n?1.20889\u00d710?3 u(k ? 5)u(k ? 3) + ?(k)\n\n(4.36)\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 106\n\n4.6 Comparac?a?o entre os modelos identificados\n\nNeste trabalho foram identificados 5 modelos, sendo 3 lineares (em torno dos pontos\n\nde operac?a?o dados pelas entradas Qi = 1.5 kg/s, Qi = 2.15 kg/s e Qi = 2.8 kg/s) e 2\n\nna?o-lineares (um identificado com o uso de uma entrada \u201cagressiva\u201d e outro identificado\n\ncom uma entrada mais \u201ccomportada\u201d). Esta sec?a?o visa promover uma comparac?a?o en-\n\ntre os modelos lineares e na?o-lineares, de forma a justificar o aumento de complexidade\n\ndecorrente.\n\nA tabela 4.6 faz uma s??ntese dos modelos encontrados, mostrando a parte deter-\n\nmin??stica dos modelos e desprezando os termos MA utilizados para evitar a polarizac?a?o\n\ndas estimativas. A tabela 4.9 faz um comparativo do desempenho dos modelos encon-\n\ntrados, utilizando sinais PRBS em torno de 3 pontos de operac?a?o na entrada: u0 = 1.5,\n\nu0 = 2.15 e u0 = 2.8 kg/s. O sinal PRBS utilizado e? o mesmo variando apenas a sua\n\namplitude. O objetivo e? avaliar como os modelos se comportam em torno dos pontos\n\nonde foram identificados os modelos lineares e quando afastados destas regio?es. Os\n\ncomenta?rios sobre a performance dos modelos lineares em torno aos valores de entrada\n\nonde foram identificados podem ser vistos na sec?a?o 4.4.4. Quando o ponto de operac?a?o\n\ne? mudado, a pro?pria linearizac?a?o utilizada (se mantida a mesma) invalidaria os mode-\n\nlos, o que pode ser visto observando-se as equac?o?es 4.1, 4.2, 4.3 ou o gra?fico 4.14. Para\n\nmontar a tabela 4.9, considerou-se que os valores de u0 e y0 tambe?m sa?o mudados nas\n\nlinearizac?o?es. Assim, para quantificar o ajuste do modelo L1.5 aos dados gerados para\n\numa entrada em torno de u0 = 2.15 kg/s, por exemplo, utilizou-se os pontos fixos da-\n\ndos pela equac?a?o 4.2, referente ao modelo L2.15, mas com a dina?mica dada pelo modelo\n\nL1.5.\n\nMesmo com essas alterac?o?es, os modelos lineares se mostraram de pouca valia\n\nquando afastado do ponto onde foram identificados. No pior caso para o modelo L2.8,\n\nquando utilizado em torno do ponto u0 = 1.5 kg/s, o seu uso se revela praticamente\n\nigual ao uso da me?dia da sa??da como preditor trivial (ajuste pro?ximo a 0%), o que pode\n\nser visto na figura 4.59. O modelo L1.5, por outro lado, possui desempenho negativo\n\nquando utilizado em outros pontos de operac?a?o. O desempenho negativo significa que\n\no uso do modelo para predizer o comportamento do sistema e? pior do que o uso da\n\nme?dia como preditor trivial. Isso ocorre porque o modelo L1.5 possui um ganho esta?tico\n\nmuito superior ao ganho esta?tico do sistema operando na regia?o das entradas 2.15 e 2.8\n\nkg/s. A figura 4.60 mostra uma comparac?a?o da sa??da do modelo L1.5 quando operando\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 107\n\nem torno da entrada 2.8 kg/s, onde e? fa?cil ver como o ganho esta?tico elevado do modelo\n\ntorna-o inu?til para operar naquela regia?o.\n\nFigura 4.59: Simulac?a?o livre dos modelos ARMAX L1.5 e L2.8 comparados com a sa??da\n\nreal do sistema para uma entrada PRBS de amplitude 0.6 kg/s em torno de u0 = 1.5\n\nkg/s, mostrando que neste caso o desempenho do modelo L2.8 fica muito aque?m do\n\nesperado\n\nAssim, como ja? era esperado, o uso dos modelos lineares fica restrito a uma faixa\n\nmuito estreita em torno do ponto onde foram linearizados. Ja? os modelos na?o-lineares\n\nforam gerados justamente para representar a dina?mica do sistema numa faixa maior\n\nde operac?a?o. O modelo NLC demonstra cumprir seu objetivo, apresentando um ajuste\n\ncompara?vel ao modelo linear em torno de u0 = 2.8 kg/s e ligeiramente inferior em torno\n\nde u0 = 2.15 e u0 = 1.5 kg/s. A figura 4.61, por exemplo, mostra uma comparac?a?o\n\nda sa??da do modelo NLC com o sistema para uma entrada PRBS oscilando em torno\n\nde u0 = 1.5 kg/s e amplitude 0.6 kg/s. Apesar da sa??da do modelo estar ligeiramente\n\nafastada da sa??da do sistema real, o modelo ainda mostra-se u?til para representar\n\na dina?mica do sistema. Juntando isso com o o?timo ajuste do modelo a? curva da\n\ncaracter??stica esta?tica do sistema (figura 4.58), tem-se que o modelo NLC foi o que\n\napresentou melhor performance dentre os modelos identificados.\n\nDo modelo NLA esperava-se que representasse o melhor desempenho, pois os dados\n\nutilizados como entrada do sistema eram os que mais pro?ximos estavam do ideal teo?rico\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 108\n\nModelo Co?digo Parte determin??stica\n\nLinear em torno de 1.5 L1.5\n\ny(k) = 2.634y(k ? 1) ? 2.319y(k ? 2)\n+0.6755y(k ? 3)\n+0.01326u(k ? 1) ? 0.01763u(k ? 2)\n\nLinear em torno de 2.15 L2.15\n\ny(k) = 2.492y(k ? 1) ? 2.087y(k ? 2)\n+0.5826y(k ? 3)\n+0.0121u(k ? 1) ? 0.01423u(k ? 2)\n\nLinear em torno de 2.8 L2.8\n\ny(k) = 2.324y(k ? 1) ? 1.8y(k ? 2)\n+0.4617y(k ? 3)\n+0.01227u(k ? 1) ? 0.01301u(k ? 2)\n\nNa?o-Linear Agressivo NLA\n\ny(k) = +2.01356 y(k ? 1)\n?1.01002 y(k ? 2)\n?3.49843\u00d710?2 u(k ? 4)y(k ? 2)\n+2.37093\u00d710?2 u(k ? 4)y(k ? 5)\n+3.09134\u00d710?2 u(k ? 4)\n+8.50101\u00d710?4 u2(k)\n\nNa?o-Linear Comportado NLC\n\ny(k) = +2.84619 y(k ? 1)\n?2.23221 y(k ? 2)\n+3.88183\u00d710?1 y(k ? 4)\n?7.26036\u00d710?3 u(k ? 2)y(k ? 1)\n+5.29649\u00d710?3 u(k)\n+2.78799\u00d710?3 u(k ? 5)\n?2.67362\u00d710?1 u(k ? 3)y(k ? 1)\n+1.25873\u00d710?2 u(k ? 2)\n?1.22951\u00d710?3 u(k ? 5)u(k ? 3)\n+3.64800\u00d710?1 u(k ? 3)y(k ? 2)\n?9.75874\u00d710?2 u(k ? 3)y(k ? 4)\n+1.73758\u00d710?3 u(k ? 2)u(k ? 2)\n\nTabela 4.8: Modelos lineares e na?o-lineares identificados\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 109\n\nAjuste dos Modelos\n\nu0 Amplitude do sinal L1.5 L2.15 L2.8 NLA NLC\n\n1.5 kg/s\n\n0.2 kg/s 79.6% 16.8% 5.0% 10.5% 66.9%\n\n0.4 kg/s 72.0% 14.8% 3.5% 20.1% 58.6%\n\n0.6 kg/s 52.9% 10.3% 0.7% 22.1% 53.9%\n\n2.15 kg/s\n\n0.2 kg/s -166.6% 79.8% 37.6% 75.8% 68.4%\n\n0.4 kg/s -172.4% 80.5% 33.7% 72.6% 74.6%\n\n0.6 kg/s -158.8% 74.0% 31.5% 68.5% 70.9%\n\n2.8 kg/s\n\n0.2 kg/s -545.5% -27.7% 75.7% 19.4% 70.4%\n\n0.4 kg/s -554.8% -28.4% 75.1% 28.8% 70.7%\n\n0.6 kg/s -563.5% -30.7% 70.1% 23.0% 64.6%\n\nTabela 4.9: Comparac?a?o do desempenho dos modelos, para entradas PRBS oscilando\n\nem torno da entrada u0, com diferentes amplitudes ma?ximas\n\nFigura 4.60: Simulac?a?o livre do modelo ARMAX L1.5 comparado com a sa??da real do\n\nsistema para uma entrada PRBS de amplitude 0.6 kg/s em torno de u0 = 2.8 kg/s\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 110\n\nFigura 4.61: Simulac?a?o livre do modelo ARMAX NLC comparado com a sa??da real do\n\nsistema para uma entrada PRBS de amplitude 0.6 kg/s em torno de u0 = 1.5 kg/s\n\npara identificac?a?o de sistemas na?o-lineares. No entanto, a performance do modelo\n\ndegradou-se fora do entorno da entrada u0 = 2.15 kg/s, como pode ser visto na figura\n\n4.62 que mostra uma comparac?a?o da sa??da do modelo com o sistema, para uma entrada\n\nem torno de u0 = 1.5 kg/s com amplitude 0.6 kg/s. A principal raza?o que explica o\n\nfraco desempenho do modelo NLA quando comparado com o modelo NLC e? que o\n\nsinal de entrada usado para gerar os dados de estimac?a?o para o modelo NLA tinham\n\ncomo centro o ponto u0 = 2.15 kg/s e na?o chegavam a atingir, por uma questa?o de\n\nseguranc?a, os extremos da regia?o de operac?a?o do sistema. Assim, o estimador na?o tinha\n\ninformac?o?es sobre o comportamento do sistema nos extremos da regia?o de operac?a?o,\n\ndevendo extrapolar os dados para tanto. A figura 4.63 mostra o histograma dos valores\n\nde u(k) aplicado ao sistema para identificac?a?o, no caso de um sinal agressivo e no caso\n\nde um sinal comportado. Percebe-se que a entrada comportada cobre um espectro\n\nmaior dos poss??veis valores de u(k), ao contra?rio do sinal agressivo, que concentra-se\n\nme torno do centro da regia?o (u0 = 2.15 kg/s). Na figura 4.64 ve?-se o histograma de\n\nvalores de y(k), onde tambe?m percebe-se que o sinal comportado esta? mais distribu??do\n\ndo que o sinal agressivo. Na?o se pode esquecer, no entanto, que o sistema possui mais\n\nde um estado, de forma que na?o somente o valor de y(k) e? importante, mas sim todos\n\nos estados envolvidos deveriam ser excitados pela entrada (y(k?1), . . . ,y(k?ny)). As\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 111\n\nfiguras mencionadas servem somente como ind??cio do que causou a pior performance\n\ndo modelo NLA comparada com o modelo NLC .\n\nFigura 4.62: Simulac?a?o livre do modelo ARMAX NLA comparado com a sa??da real do\n\nsistema para uma entrada PRBS de amplitude 0.6 kg/s em torno de u0 = 1.5 kg/s\n\nA gerac?a?o de um sinal de entrada aleato?rio que excite de forma mais uniforme o\n\nsistema por toda a faixa de operac?a?o e? uma tarefa dif??cil pois possivelmente este sinal,\n\npara garantir todas as propriedades estat??sticas exigidas, apresentara? variac?o?es muito\n\nabruptas e dificilmente sera? aceito pelos supervisores do processo devido ao risco que\n\ncoloca a? integridade das instalac?o?es.\n\nO modelo NLA na?o pode ser considerado \u201cruim\u201d, apesar dos comenta?rios acima.\n\nValidando-se o modelo com uma entrada similar a utilizada para estimar o seus\n\npara?metros (ver figura 4.57), ve?-se que o modelo tem um bom ajuste (87.78%) mesmo\n\ncomparado ao modelo NLC (91.2%). Ale?m disso, o modelo NLA tem a vantagem de\n\nser mais conciso que o modelo NLC facilitando a sua utilizac?a?o, por exemplo, em al-\n\nguma estrutura de controle que efetue a linearizac?a?o da equac?a?o atrave?s da entrada.\n\nAssim, caso se pretenda trabalhar na maioria dos casos pro?ximo ao centro da regia?o\n\nde operac?a?o definida, o modelo NLA e? adequado.\n\nO modelo NLC , por outro lado, cumpriu seu papel de mostrar que e? poss??vel obter\n\num modelo na?o-linear com ampla faixa de validade, com base em dados obtidos sem\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 112\n\nFigura 4.63: Histograma de valores da entrada u(k) para a entrada agressiva e com-\n\nportada\n\nFigura 4.64: Histograma de valores da sa??da y(k) para a entrada agressiva e comportada\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 113\n\ngrandes alterac?o?es na operac?a?o normal do processo. Foi poss??vel obter este modelo\n\nsomente porque a na?o-linearidade presente na?o e? muito severa, na?o havendo grandes\n\nmudanc?as estruturais no sistema.\n\n4.7 Comenta?rios ao controle do sistema\n\nO objetivo deste trabalho e? encontrar modelos na?o-lineares do tipo NARMAX po-\n\nlinomial que fossem va?lidos para prever o comportamento do sistema para valores de\n\nentrada oscilado entre 1.5 e 3 kg/s. Tal objetivo foi cumprido nas sec?o?es anteriores,\n\ntendo sido mostrado a superioridade dos modelos na?o-lineares em relac?a?o aos linea-\n\nres, para predizer a sa??da do sistema em diferentes pontos de operac?a?o. O controle\n\ndo sistema na?o faz parte do objetivo deste trabalho, no entanto nesta sec?a?o tecem-se\n\nalgumas considerac?o?es sobre o poss??vel uso dos modelos para controle.\n\nA estrutura de controle que parece ser mais imediatamente aplica?vel aos modelos\n\nencontrados e? o Controle Preditivo com Modelos Na?o-Lineares (NMPC - do ingle?s\n\nNonlinear Model Predictive Control ), que e? um caso particular do Controle Preditivo\n\ncom Modelos (MPC - do ingle?s Model Predictive Control ). MPC e? o nome dado a um\n\nconjunto de algoritmos que busca controlar o comportamento futuro de um sistema\n\ncom base em um modelo de processo. A cada amostragem o controlador calcula uma\n\nsequ?e?ncia de valores para a entrada do sistema (atuando em malha aberta) que otimiza\n\no comportamento futuro do sistema. O primeiro valor desta sequ?e?ncia e? enta?o aplicado\n\nna entrada e toda rotina de otimizac?a?o e? executada novamente na pro?xima amostra\n\n[35].\n\nUma vantagem do MPC em relac?a?o a outros me?todos de controle e? que no algo-\n\nritmo de otimizac?a?o podem ser incorporadas diretamente restric?o?es sobre as entradas\n\nde controle e sobre as varia?veis controladas. A performance de um controlador MPC\n\ndepende criticamente das capacidades preditivas do modelo utilizado, sendo este mo-\n\ndelo comumente obtido na pra?tica por modelagem emp??rica [17]. Por esses motivos, os\n\nmodelos NARMAX polinomiais parecem ser especialmente indicados.\n\nDado um modelo SISO no espac?o de estados, na?o-linear a tempo discreto:\n\n~x(k + 1) = f (~x(k),u(k),~v(k), ~w(k)) (4.37)\n\ny(k) = g (~x(k)) + ?(k) (4.38)\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 114\n\nonde y(k) e? a sa??da do sistema, ~x(k) e? um vetor contendo os estados do sistema, u(k)\n\ne? a entrada do sistema, ~v(k) sa?o perturbac?o?es mensura?veis, ~w(k) sa?o perturbac?o?es na?o\n\nmensura?veis (ou ru??do) e ?(k) e? o ru??do de medic?a?o, o problema do controle preditivo\n\nconsiste em calcular uma sequ?e?ncia de entradas {u(k)} que leve o sistema a um valor\nys(k). Um algoritmo de controle NMPC minimiza um objetivo similar a:\n\nJN M P C =\nP?\n\nj=1\n\n(ey(k + j)wyj)\n2 +\n\nM?1?\nj=0\n\n(?u(k + j)w?uj)\n2 +\n\nM?1?\nj=0\n\n(eu(k + j)wuj)\n2 (4.39)\n\nsujeito a?s restric?o?es do modelo:\n\n~x(k + j) = f (~x(k + j ? 1),u(k + j ? 1)) (4.40)\n\ny(k + j) = g (~x(k + j)) (4.41)\n\ne a?s restric?o?es para o controle:\n\ny\nj\n\n? y(k + j) ? yj ?j = 1,P\n\nu ? u(k + j) ? u ?j = 0,M ? 1\n?u ? ?u(k + j) ? ?u ?j = 0,M ? 1\n\n(4.42)\n\nNa equac?a?o 4.39, existem tre?s parcelas conflitantes:\n\ney(k + j) = y(k + j) ? ys(k + j) (4.43)\n\n?u(k + j) = u(k + j) ? u(k + j ? 1) (4.44)\n\neu(k + j) = u(k + j) ? us(k + j) (4.45)\n\nonde ey(k + j) penaliza o erro da sa??da do sistema, sobre um horizonte de predic?a?o P ,\n\n?u(k + j) penaliza as variac?o?es abruptas na entrada e eu(k + j) penaliza os desvios em\n\nrelac?a?o ao valor desejado de us(k), sobre um horizonte de controle M. Os termos de\n\nerro sa?o multiplicados por wyj, w?uj e wuj, permitindo atribuir pesos diferentes para\n\ncada um dos tipos de erro e para cada instante de tempo do horizonte de predic?a?o.\n\nNas restric?o?es de controle dadas na equac?a?o 4.42, y\nj\n\ne yj sa?o os limites inferior e\n\nsuperior, respectivamente, para a sa??da do sistema y(k) no instante de tempo k + j; u\n\ne u sa?o os limites inferior e superior, respectivamente, para a entrada do sistema u(k);\n\ne ?u e ?u sa?o os limites inferior e superior, respectivamente, para a variac?a?o aceita?vel\n\nno sinal u(k) entre cada amostra.\n\nA soluc?a?o do problema de otimizac?a?o resulta em um vetor ~uc com M valores de\n\nentrada futura:\n\n~uc =\n[\nu(k) u(k + 1) \u00b7 \u00b7 \u00b7 u(k + M ? 1)\n\n]T\n(4.46)\n\n\n\nEstudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 115\n\nO valor de u(k) e? usado como entrada na planta e todos os ca?lculos sa?o repetidos\n\nna pro?xima amostra.\n\nAlguns dos problemas que imediatamente surgem com o uso do NMPC sa?o:\n\n\u2022 O uso de modelos na?o-lineares no controle MPC em geral leva a? perda de con-\nvexidade no problema, o que significa que e? muito mais dif??cil de encontrar uma\n\nsoluc?a?o e na?o ha? garantia de que a soluc?a?o encontrada seja um o?timo global.\n\n\u2022 Os algoritmos MPC para serem u?teis em aplicac?o?es industriais precisam convergir\nrapidamente, o que pode na?o ser o caso quando se usa um modelo na?o-linear.\n\n\u2022 Uma soluc?a?o o?tima para o controle na?o necessariamente implica em estabilidade\nem malha fechada, mesmo quando o modelo representa a planta perfeitamente\n\n[35].\n\nDesta forma, limita-se aqui a indicar um poss??vel uso dos modelos encontrados,\n\ndeixando o estudo da aplicac?a?o em controle como sugesta?o para trabalhos futuros.\n\n\n\nCap??tulo 5\n\nConsiderac?o?es Finais\n\nNeste trabalho foram identificados modelos lineares e na?o-lineares para um poc?o de\n\npetro?leo operando por elevac?a?o artificial via injec?a?o cont??nua de ga?s. O uso de modelos\n\nlineares revelou-se limitado pois o sistema possui uma caracter??stica esta?tica na?o-linear\n\ne quando ocorre uma afastamento maior do ponto onde os modelos foram identificados,\n\neles rapidamente perdem sua validade. Ademais, a pro?pria dina?mica do sistema, dada\n\npelos po?los e zeros existentes e? alterada de acordo com o ponto de operac?a?o.\n\nA escolha de varia?veis de entrada e sa??da para o sistema foi feita de forma a tornar o\n\nsistema monovaria?vel e facilitar a implementac?a?o futura do controle do poc?o. Escolheu-\n\nse como varia?vel de entrada a vaza?o ma?ssica de ga?s injetado no poc?o e como sa??da a\n\npressa?o no tubo de produc?a?o, sendo esta u?ltima dada pela diferenc?a entre a pressa?o na\n\ncabec?a e no fundo do poc?o. A vantagem de escolher a pressa?o no tubo de produc?a?o\n\ncomo varia?vel de sa??da e? que isto permite isolar a varia?vel de sa??da de flutuac?o?es da\n\npressa?o no separador. Ale?m disso, as varia?veis escolhidas sa?o facilmente mensura?veis\n\nem qualquer poc?o, tornando fact??vel a implementac?a?o posterior do controle num sistema\n\nreal.\n\nMostrou-se a viabilidade de usar modelos do tipo NARMAX polinomial com grau\n\n` = 2 para o sistema, tendo sido identificados dois modelos diferentes a partir de dois\n\nconjuntos de dados: o primeiro conjunto de dados utiliza uma entrada mais \u201cagressiva\u201d\n\nque visa excitar ao ma?ximo a dina?mica na?o-linear do sistema; o segundo utiliza uma\n\nentrada mais bem \u201ccomportada\u201d, consistindo no reaproveitamento dos dados utilizados\n\nna identificac?a?o linear - sinais PRBS que fazem a entrada oscilar em torno dos tre?s\n\npontos de operac?a?o onde os modelos lineares foram identificado.\n\n\n\nConsiderac?o?es Finais 117\n\nA estrate?gia que reutilizou dados da identificac?a?o linear para identificac?a?o de um\n\nmodelo na?o-linear mostrou ser bem sucedida, ao resultar num modelo com grande\n\najuste da dina?mica e caracter??stica esta?tica em toda a regia?o de operac?a?o. Esta es-\n\ntrate?gia tem a vantagem de representar menor risco aos equipamentos, por utilizar\n\npequenas variac?o?es em torno a tre?s pontos de operac?a?o estrategicamente selecionados\n\ndentro da regia?o de operac?a?o. Ale?m disso, as entradas utilizadas permitem a continui-\n\ndade da produc?a?o do poc?o, na?o alterando significativamente a sua operac?a?o durante\n\na coleta de dados. Este ponto e? muito importante do ponto de vista econo?mico. Foi\n\nposs??vel obter um modelo na?o-linear com o uso de uma entrada mais \u201ccomportada\u201d\n\nporque a na?o-linearidade existente no sistema na?o e? muito severa.\n\nComo perspectivas para trabalhos futuros sugere-se:\n\n\u2022 Implementac?a?o de estrate?gias de controle utilizando os modelos identificados, a\nserem testadas no software OLGA 2000. Sugere-se como primeira abordagem\n\numa estrutura de controle preditivo por modelo na?o-linear (NMPC).\n\n\u2022 Identificac?a?o de modelos e implementac?a?o do controle proto?tipo de poc?o operando\npor gas-lift existente na UFSC e posteriormente em um poc?o real.\n\nUm dos problemas que possivelmente surgira?o quando forem feitos testes em siste-\n\nmas reais e? a existe?ncia de ru??do na medic?a?o, que pode exigir mais testes ate? encontrar\n\na relac?a?o sinal/ru??do ideal.\n\n\n\nRefere?ncias Bibliogra?ficas\n\n[1] AGARWAL, M. A systematic classification of neural-network-based control.\n\nIEEE Control Systems Magazine, v. 17, n. 2, p. 75\u201393, Abril 1997.\n\n[2] AGUIRRE, L. A.; MENDES, E. M. A. M. Global nonlinear polynomial models:\n\nStructure, term clusters and fixed points. Int. J. Bifurcation and Chaos, v. 6,\n\nn. 2, p. 279\u2013294, 1995.\n\n[3] AGUIRRE, L.; BILLINGS, S. Improved structure selection based on term\n\nclustering. International Journal of Control, v. 62, n. 3, p. 569\u2013587, 1995.\n\n[4] AGUIRRE, L. A. Introduc?a?o a? Identificac?a?o de Distemas: Te?cnicas\n\nLineares e Na?o-Lineares Aplicadas a Sistemas Reais. 2a ed. Belo Horizonte:\n\nEd. UFMG, 2004.\n\n[5] AGUIRRE, L. A.; RODRIGUES, G. G.; JACOME, C. R. F. Indentificac?a?o de\n\nsistemas na?o-lineares utilizando modelos narmax polinomiais - uma revisa?o e novos\n\nresultados. SBA Controle &amp; Automac?a?o, v. 9, n. 2, p. 90\u2013106, Maio-Agosto\n\n1998.\n\n[6] AKAIKE, H. A new look at the statistical model identification. IEEE\n\nTransactions on Automatic Control, v. 19, n. 6, p. 716\u2013723, dezembro 1974.\n\n[7] BOX, G. E. P.; JENKINS, G. M.; REINSEL, G. C. Time Series Analysis:\n\nForecasting and Control. 3 ed. New Jersey: Prentice-Hall, 1994.\n\n[8] BROSILOW, C.; JOSEPH, B. Techniques of model based control. Upper\n\nSaddler River: Prentice Hall, 2002.\n\n[9] CHEN, C.-T. Linear System Theory and Design. 3 ed. New York: Oxford\n\nUniversity Press, 1998.\n\n\n\nRefere?ncias Bibliogra?ficas 119\n\n[10] CHEN, S.; BILLINGS, S. A. Representation of non-linear systems: the narmax\n\nmodel. International Journal of Control, v. 49, n. 3, p. 1013\u20131032, 1989.\n\n[11] CHEN, S.; BILLINGS, S. A.; LUO, W. Orthogonal least squares methods and\n\ntheir application to non-linear system identification. International Journal of\n\nControl, v. 50, n. 5, p. 1873\u20131896, 1989.\n\n[12] COELHO, A. A. R.; COELHO, L. S. Identificac?a?o de Sistemas Dina?micos\n\nLineares. Floriano?polis: Editora da UFSC, 2004.\n\n[13] ECONOMIDES, M. J.; HILL, A. D.; EHLIG-ECONOMIDES, C. Petroleum\n\nProduction Systems. Upper Saddle River: Prentice Hall, 1993.\n\n[14] EIKREM, G. O.; FOSS, B.; IMSLAND, L. Stabilization of gas lifted wells based\n\non state estimation. IFAC ADCHEM2003, Hong Kong, 2004.\n\n[15] EIKREM, G. O. et al. Stabilization of gas lifted wells. Proceedings of the\n\nIFAC 15th World Congress, Barcelona, 2002.\n\n[16] ENDERS, W. Applied econometric time series. 1 ed. New York: John Wiley\n\n&amp; Sons, 1995.\n\n[17] FOSS, B. A.; JOHANSEN, T. A.; S\u00d8RENSEN, A. V. Nonlinear predictive\n\ncontrol using local models - applied to a batch fermentation process. Control Eng.\n\nPractice, v. 3, n. 3, p. 389\u2013396, 1995.\n\n[18] GLAD, T. Step responses of nonlinear non-minimum phase systems. In:\n\nPreprints, 6th IFAC Symposium on Nonlinear Control Systems,\n\nNOLCOS 2004. Stuttgart, Germany: [s.n.], 2004. p. 1445\u20131449.\n\n[19] GOLUB, G. H.; Van Loan, C. F. Matrix Computations. 2 ed. Baltimore:\n\nJohns Hopkins University Press, 1989.\n\n[20] GUJARATI, D. N. Econometria Ba?sica. 3 ed. Sa?o Paulo: Makron Books,\n\n2000.\n\n[21] HAGAN, M.; DEMUTH, H. Neural networks for control. Invited Tutorial,\n\nAmerican Control Conference, San Diego, p. 1642\u20131656, Junho, 1999.\n\n[22] IMSLAND, L.; EIKREM, G. O.; FOSS, B. State feedback control of a class of\n\npositive systems: Application to gas lift control. ECC\u201903, Cambridge, 2003.\n\n\n\nRefere?ncias Bibliogra?ficas 120\n\n[23] JACOME, C. R. F. Uso de Conhecimento Pre?vio na Identificac?a?o de\n\nModelos Polinomiais NARMAX. Dissertac?a?o \u2014 Programa de Po?s-Graduac?a?o\n\nem Engenharia Ele?trica, Universidade Federal de Minas Gerais, Belo Horizonte,\n\n1996.\n\n[24] LANGSTON, L. V. The Lease Pumpers Handbook. 1a. ed. Norman,\n\nOklahoma: Commission on Marginally Producing Oil and Gas Wells of Oklahoma,\n\n2003.\n\n[25] LEONTARITIS, I. J.; BILLINGS, S. A. Input-output parametric models for\n\nnon-linear systems. part i: deterministic non-linear systems; part ii: stochastic\n\nnon-linear systems. International Journal of Control, v. 41, n. 2, p. 303\u2013344,\n\n1985.\n\n[26] LEONTARITIS, I. J.; BILLINGS, S. A. Model selection and validation methods\n\nfor non-linear systems. International Journal of Control, v. 45, n. 1, p. 311\u2013341,\n\n1987.\n\n[27] LJUNG, L. System Identification Toolbox For Use With Matlab 6.0.\n\nNatick, MA: The MathWorks, Inc., 2004.\n\n[28] LJUNG, L.; GLAD, T. Modelling of Dynamical Systems. Englewwod Cliffs,\n\nNJ: Prentice-Hall, 1994.\n\n[29] MONTEIRO, L. H. A. Sistemas dina?micos. Sa?o Paulo: Editora Livraria da\n\nF??sica, 2002.\n\n[30] OGATA, K. Discrete-Time Control Systems. 2 ed. Englewood Cliffs, New\n\nJersey: Prentice-Hall, 1995.\n\n[31] OGATA, K. Engenharia de Controle Moderno. 3 ed. Rio de Janeiro: LTC,\n\n2000.\n\n[32] PLUCENIO, A. Automac?a?o da Produc?a?o de Poc?os de Petro?leo Operando\n\ncom Elevac?a?o Artificial por Injec?a?o Cont??nua de Ga?s. Dissertac?a?o \u2014\n\nPrograma de Po?s-Graduac?a?o em Engenharia Ele?trica, Universidade Federal de\n\nSanta Catarina, Floriano?polis, 2003.\n\n[33] PLUCENIO, A. Uma estrate?gia de controle para a elevac?a?o por gaslift.\n\nRelato?rio interno do DAS - UFSC, 2004.\n\n\n\nRefere?ncias Bibliogra?ficas 121\n\n[34] POLLOCK, D. A Handbook of Time-Series Analysis, Signal Processing\n\nand Dynamics. London: Academic Press, 1999.\n\n[35] QIN, S. J.; BADGWELL, T. A. An overview of nonlinear model predictive\n\ncontrol applications. Nonlinear MPC Workshop, Ascona, Switzerland, 1998.\n\n[36] Scandpower Petroleum Technologies. Olga 2000 v. 4.10 User Manual. Kjeller,\n\nNorway: Scandpower P. T., 2003.\n\n[37] TOMAS, J. E. Fundamentos de Engenharia de Petro?leo. Rio de Janeiro:\n\nEditora Intercie?ncia, 2001.\n\n\n\tIntrodu\u00e7\u00e3o\n\tModelagem de Sistemas Din\u00e2micos\n\tIntrodu\u00e7\u00e3o\n\tClassifica\u00e7\u00e3o de Modelos\n\tRepresenta\u00e7\u00f5es Lineares\n\tRepresenta\u00e7\u00e3o Geral Discreta\n\tModelos AR e ARX\n\tModelos ARMA e ARMAX\n\n\tRepresenta\u00e7\u00f5es n\u00e3o-Lineares e Modelos NARMAX\n\n\tIdentifica\u00e7\u00e3o de Sistemas\n\tIntrodu\u00e7\u00e3o\n\tEtapas na identifica\u00e7\u00e3o de Sistemas\n\tFun\u00e7\u00f5es de Correla\u00e7\u00e3o\n\tProjeto do Sinal de Teste\n\tDetermina\u00e7\u00e3o do per\u00edodo de amostragem\n\tEstima\u00e7\u00e3o de Par\u00e2metros\n\tO Estimador de M\u00ednimos Quadrados (MQ)\n\tO M\u00e9todo de MQ com Modelos Autoregressivos\n\tPolariza\u00e7\u00e3o de Estimadores\n\n\tCrit\u00e9rios de Informa\u00e7\u00e3o\n\tFerramentas Utilizadas na Identifica\u00e7\u00e3o de Sistemas n\u00e3o-Lineares\n\tAlgoritmos MQ Ortogonais\n\tA Taxa de Redu\u00e7\u00e3o de Erro\n\tAgrupamento de termos\n\tCaracter\u00edstica est\u00e1tica\n\n\tValida\u00e7\u00e3o do Modelo\n\n\tEstudo de Caso: Aplica\u00e7\u00e3o \u00e0 Ind\u00fastria Petrol\u00edfera\n\tIntrodu\u00e7\u00e3o\n\tDescri\u00e7\u00e3o do Sistema\n\tO simulador Olga\n\tIdentifica\u00e7\u00e3o Linear\n\tIdentifica\u00e7\u00e3o em torno de u=1.5 kg/s\n\tIdentifica\u00e7\u00e3o em torno de u=2.15 kg/s\n\tIdentifica\u00e7\u00e3o em torno de u=2.8 kg/s\n\tComent\u00e1rios sobre os modelos lineares identificados\n\n\tIdentifica\u00e7\u00e3o n\u00e3o-Linear\n\tIdentifica\u00e7\u00e3o usando sinal de entrada ``agressivo''\n\tIdentifica\u00e7\u00e3o usando sinal de entrada ``comportado''\n\n\tCompara\u00e7\u00e3o entre os modelos identificados\n\tComent\u00e1rios ao controle do sistema\n\n\tConsidera\u00e7\u00f5es Finais"}]}}}