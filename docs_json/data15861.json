{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.19482"}, {"@name": "filename", "#text": "2840_Gomes_JoseAdilsonTenorio_M.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "UNIVERSIDADE ESTADUAL DE CAMPINAS\nFACULDADE DE ENGENHARIA MEC\u00c2NICA\nDEPARTAMENTO DE ENGENHARIA DE PETR\u00d3LEO\nDisserta\u00e7\u00e3o Apresentada \u00e0\nFaculdade de Engenharia Mec\u00e2nica Como Requisito Parcial \u00e0 Obten\u00e7\u00e3o do T\u00edtulo de Mestre em Engenharia de Petr\u00f3leo\nSIMULA\u00c7\u00c3O NUM\u00c9RICA DE PO\u00c7OS HORIZONTAIS EM RESERVAT\u00d3RIOS COM FLUXO MULTIF\u00c1SICO,\nUSANDO REFINAMENTO LOCAI..\n5oho\nAutor : Jos\u00e9 Adilson Tenorio Gomes\n:'A\nNovembro de 1990\nUNIVERSIDADE ESTADUAL DE CAMPINAS\nFACULDADE DE ENGENHARIA MEC\u00c2NICA\nDEPARTAMENTO DE ENGENHARIA DE PETR\u00d3LEO\nA disserta\u00e7\u00e3o\u201dSimula\u00e7\u00e3o Num\u00e9rica de Po\u00e7os Horizontais em Reservat\u00f3rios com Fluxo Multif\u00e1sico, usando Refinamento Local\u201d, elaborada por Jos\u00e9 Adilson Ten\u00f3rio Gomes e aprovada por todos os membros da Banca Examinadora foi aceita pela Sub-Comissao de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Petr\u00f3leo como requisito parcial a obten\u00e7\u00e3o do t\u00edtulo de Mestre em Engenharia de Petr\u00f3leo.\nCampinas,23 de Novembro de 1990\nAntonio Cl\u00e1udio de Fran\u00e7a Corr\u00eaa, Ph.D.\nA Dora\nThiago e Ligia\nA minha m\u00e3e\nE ao meu pai (em mem\u00f3ria )\nAGRADECIMENTOS\n\u25a0s\nA Walter Pereira Formosinho por tornar poss\u00edvel a participa\u00e7\u00e3o do mestrado.\nAo colega Celso Cesar Moreira Branco por sua valiosa contribui\u00e7\u00e3o.\nAos colegas de mestrado, professores e funcion\u00e1rios do CEPETRO pelo apoio necess\u00e1rio ao bom andamento do curso.\n\u00c0 todas as pessoas que direta ou indiretamente contribuiram para a realiza\u00e7\u00e3o desta tese.\nConte\u00fado\n1\tintrodu\u00e7\u00e3o\ti\n2\tREVIS\u00c3O BIBLIOGR\u00c1FICA\t3\n2.1\tPo\u00e7o Horizontal............................................   3\n2.2\tRefinamento Local . ....................................      6\n3\tDEFINI\u00c7\u00c3O DO PROBLEMA\t9\n4\tFORMULA\u00c7\u00c3O DO MODELO\tNUM\u00c9RICO\t11\n4.1\tFormula\u00e7\u00e3o Geral...........................................  11\n4.1.1\tCondi\u00e7\u00f5es Iniciais ................................    12\n4.1.2\tCondi\u00e7\u00f5es de Contorno..............................    13\n4.2\tDiscretiza\u00e7\u00e3o das Equa\u00e7\u00f5es de Fluxo . ....................   13\n4.2.1\tTermo de Acumula\u00e7\u00e3o\t ................................ 13\n4.2.2\tTermo de Fluxo...................................    .\t. 14\n4.2.3\tTratamento das Interfaces............................. 19\n4.3\tEqua\u00e7\u00f5es de Fluxo na Forma de Diferen\u00e7as...................  21\n5\tSOLU\u00c7\u00c3O DO MODELO NUM\u00c9RICO\t23\n5.1\tDescri\u00e7\u00e3o do Problema .................................    .\t23\n5.2\tSolu\u00e7\u00e3o do Sistema n\u00e3o-Linear de Equa\u00e7\u00f5es .................. 24\n5.3\tOrdena\u00e7\u00e3o da Malha e Solu\u00e7\u00e3o da Matriz.....................  25\n5.3.1\tModelo Totalmente Acoplado..........................   25\n5.3.2\tModelo Desacoplado..................................   29\n5.4\tSolu\u00e7\u00e3o do Sistema Linear de Equa\u00e7\u00f5es......................  33\n5.5\tCondi\u00e7\u00f5es de Produ\u00e7\u00e3o ...................................    34\n5.6\tDerivadas................................................    36\n5.7\tControle Autom\u00e1tico do Tempo................................ 36\n6\tVALIDA\u00c7\u00c3O DO MODELO\t38\n6.1\tSolu\u00e7\u00e3o Anal\u00edtica ...................................      3g\n6.2\tSimula\u00e7\u00e3o dos Testes ..................................... 43\n6.2.1\tComportamento da Press\u00e3o no Drawdown ................43\n6.2.2\tDetermina\u00e7\u00e3o da Permeabilidade...................... . 46\n7\tAN\u00c1LISE DOS RESULTADOS\t54\n7.1\tModelo Totalmente Acoplado................................ 54\n7.1.1\tCompara\u00e7\u00e3o entre os M\u00e9todos de Solu\u00e7\u00e3o ..............54\n7.1.2\tRefinamento Radial.................................. 56\n7.1.3\tRefinamento Angular.........  ....................... 57\n7.2\tCompara\u00e7\u00e3o entre o Acoplado e os Desacoplados..............58\n8\tAPLICA\u00c7\u00c3O DO MODELO\t72\n9\tCONCLUS\u00d5ES E RECOMENDA\u00c7\u00d5ES\t81\n10\tREFER\u00caNCIAS\t83\n10.1\tPo\u00e7os Horizontais......................................   83\n10.2\tRefinamento local.......................................  85\n11\tAP\u00caNDICE A - Derivadas das Equa\u00e7\u00f5es\tde\tFluxo\t87\n12\tAP\u00caNDICE B - Dados Utilizados na Simula\u00e7\u00e3o\t102\n13\tAP\u00caNDICE C - Resultados\t105\n13.1\tPo\u00e7o com 300m de comprimento  .......................    105\n13.2\tPo\u00e7o com 100m de comprimento...........................  112\n14\tAP\u00caNDICE D - Programas Computacionais\t120\n3.1\tRepresenta\u00e7\u00e3o do reservat\u00f3rio................................\t. . . 10\n4.1\tRepresenta\u00e7\u00e3o das linhas de fluxo pr\u00f3ximo ao po\u00e7o .......................... 14\n4.2\tBloco cil\u00edndrico para c\u00e1lculo da posi\u00e7\u00e3o do ponto nodal ...........\t18\n5.1\tModelo f\u00edsico e si tema de coordenadas ....................................  24\n5.2\tOrdena\u00e7\u00e3o da malha.......................................................    26\n5.3\tMatriz\tJacobiana do sistema totalmente acoplado .............................28\n5.4\tMatriz\tJacobiana referente a malha\tcartesiana..............................  30\n5.5\tMatriz\tJacobiana referente a malha\tcil\u00edndrica ...............................30\n5.6\tFluxogramas para os m\u00e9todos desacoplados ..................................  31\n5.7\tRepresenta\u00e7\u00e3o dos termos de fluxo .............................  .\t32\n6.1\tRepresenta\u00e7\u00e3o do modelo f\u00edsico.............................................. 39\n6.2\tRepresenta\u00e7\u00e3o das linhas de fluxo dos regimes do transiente .................39\n6.3\tCompara\u00e7\u00e3o entre a solu\u00e7\u00e3o anal\u00edtica e a num\u00e9rica\t .....................45\n6.4\tGr\u00e1fico de\tAp vs\tZn\u00ed, para\to radial inicial............................. 50\n6.5\tGr\u00e1fico de\tAp vs\tInt, para\to pseudo radial\ttardio -\tk\t=\t1.97\tx\t10~14m2\t.\t.\t51\n6.6\tGr\u00e1fico de\tAp vs\tInt, para\to pseudo radial\ttardio -\tk\t~\t9.87\tx\t10\u201c15m2\t.\t.\t52\n6.7\tGr\u00e1fico de\tAp vs\ti1/2, para\to linear tardio............................. 53\n7.1\tFator de sobre-relaxa\u00e7\u00e3o versus tempo ...................................... 60\n7.2\tRefinamento radial (caso 1 ) - pwy versus tempo............................. 61\n7.3\tRefinamento radial\t(\tcaso\t1\t)\t* Qo versus tempo ...........................62\n7.4\tRefinamento radial\t(\tcaso\t2\t)\t- pwy versus tempo.........................  63\n7.5\tRefinamento radial\t(\tcaso\t2\t)\t~ Qo versus tempo ...........................64\n7.6\tRefinamento radial\t(\tcaso\t2\t)- Qw versus tempo.........................    65\n7.7\tRefinamento radial ( caso 2 )- RWO versus tempo\t..............\t66\n7.8\tRefinamento angular - pwj versus tempo ..................................    67\n7.9\tRefinamento angular - Qo versus tempo .....................................  68\n7.10\tCompara\u00e7\u00e3o entre os modelos - pm/ versus tempo ..............................69\n7.11\tCompara\u00e7\u00e3o entre os modelos - Qo versus tempo ...............70\n7.12\tCompara\u00e7\u00e3o entre os modelos - Qw versus tempo ..............\t71\n8.1\tPosi\u00e7\u00e3o do po\u00e7o - pwj versus tempo ........................   74\n8.2\tPosi\u00e7\u00e3o do po\u00e7o - Qo versus tempo.........................    75\n8.3\tPosi\u00e7\u00e3o do po\u00e7o - Qw versus tempo..........................   76\n8.4\tComprimento do po\u00e7o - pwj versus tempo ...................    77\n8.5\tComprimento do po\u00e7o - Qo versus tempo . ..................... 78\n8.6\tComprimento do po\u00e7o ~ Qw versus tempo ....................... 79\n8.7\tPerfil vertical de satura\u00e7\u00e3o de \u00e1gua......................... 80\nv\u00edii\n6.1\tPar\u00e2metros usados na valida\u00e7\u00e3o......................................... 44\n6.2\tCaracter\u00edsticas do reservat\u00f3rio e malha................................\t46\n6.3\tDura\u00e7\u00e3o, em horas, dos regimes transiente.............................. 46\n7.1\tPar\u00e2metros Usados na Simula\u00e7\u00e3o . ...................................    55\nB.l Propriedades PVT do \u00f3leo saturado.......................................\t102\nB.2\tPropriedades PVT do \u00f3leo sub-saturado ...............................  102\nB.3\tPropriedades PVT da \u00e1gua...........................................    102\nB.4\tPropriedades PVT do g\u00e1s .........................................      103\nB.5 Permeabilidades relativas \u00f3leo - \u00e1gua.................................  103\nB.6 Curva de press\u00e3o capilar \u00f3leo - \u00e1gua . .................................104\nLISTA DE S\u00cdMBOLOS\nA = Area da Se\u00e7\u00e3oTransversal (m2)\na = Dimens\u00e3o do reservat\u00f3rio perpendicular ao po\u00e7o (m)\nB ~ Fator volume de forma\u00e7\u00e3o (m3res/m3s\u00edd)\nb = Dimens\u00e3o de reservat\u00f3rio paralela ao po\u00e7o (m)\nc ~ Compressibilidade (Pa\"1)\nd\t= Menor dimens\u00e3o; po\u00e7o/limite do reservat\u00f3rio (m)\nD\t\u2014 Maior dimens\u00e3o: po\u00e7o/limite do reservat\u00f3rio (\u00edti)\nI) = Profundidade em rela\u00e7\u00e3o a um plano de refer\u00eancia (m) e\t~\tVetor unit\u00e1rio\nFF\t\u2014\tFator de forma\nh\t=\tEspessura da forma\u00e7\u00e3o (m)\nk\t=\tPermeabilidade (m2)\nL\t\u2014\tComprimento do po\u00e7o (m)\nm = Massa por unidade de volume (kg/m3)\nm\t=\u25a0\tFluxo de massa (kg/m3/s)\nn\t~\tN\u00famero de blocos\np\t=\tPress\u00e3o (Pa)\nQ\t\u2014 Vaz\u00e3o em condi\u00e7\u00f5es de superf\u00edcie (m3std/d)\ng\t= Vaz\u00e3o em condi\u00e7\u00f5es de reservat\u00f3rio\t(m3/d)\ng\t= Termo fonte (kg/m3/s)\nR\t= Raz\u00e3o de solubilidade (m3sid/m3std)\nr\t= Raio (m)\nS\t= Satura\u00e7\u00e3o (fr)\ns\t\u2014 Skin\nt\t\u2014 Tempo (.s)\nT\t= Transmissibilidade\n\u00fc\t~ Velocidade m\u00e9dia (m/s)\nV\t= Volume (m3)\nw\t\u2014 Ponderador ou fator de sobre-relaxa\u00e7\u00e3o\nLETRAS GREGAS\nA = Operador de diferen\u00e7as d \u2014 Operador diferenciai parcial V \u2014 Operador divergente $\t=\tPorosidade (/r)\n6\t=\tPotencial de fluxo\np ~ Viscosidade (Pa,s)\nP = Massa Espec\u00edfica (fcg/m3)\n7\t\u2014 Peso Espec\u00edfico (kgf /m3)\n0\t= Dire\u00e7\u00e3o angular\n\u00cdNDICES INFERIORES e\t=\tExterno\nend\t~\tFinai de um\tregime\nl\t~\tFase; \u00f3leo, \u00e1gua\tou g\u00e1s\no\t\u2014\tOleo\np\tPoroso\nph ~ Po\u00e7o horizontal\nr ~ Rocha ou relativa ou dire\u00e7\u00e3o radial start = In\u00edcio de um regime\ni\t=\tTotal\nw\t=\tAgua ou\tpo\u00e7o\nx,\ti\t=\tDire\u00e7\u00e3o\t\u00a3\ny,\tj\t~\tDire\u00e7\u00e3o\ty\nz,\tk\t\u2014\tDire\u00e7\u00e3o\tz\n\u00cdNDICES SUPERIORES\nm ~ Itera\u00e7\u00e3o anterior do sistema linear de equa\u00e7\u00f5es\nm + 1\t= Itera\u00e7\u00e3o atual do sistema linear de equa\u00e7\u00f5es\nn = Time step anterior\nn + 1\t\u2014 Time step atual\n!/\t~ Itera\u00e7\u00e3o anterior do sistema n\u00e3o linear de equa\u00e7\u00f5es\nv 4-1\t= Itera\u00e7\u00e3o atual do sistema n\u00e3o linear de equa\u00e7\u00f5es\n*\tN\u00edvel de itera\u00e7\u00e3o intermedi\u00e1rio\nRESUMO\nCom o aprimoramento tecnol\u00f3gico dos m\u00e9todos de perfura\u00e7\u00e3o e com-pleta\u00e7\u00e3o e a necessidade de otimiza\u00e7\u00e3o do volume de \u00f3leo recuper\u00e1vel, nota-se um crescente interesse na perfura\u00e7\u00e3o de po\u00e7os horizontais para a drenagem de reservat\u00f3rios de petr\u00f3leo. Estes po\u00e7os s\u00e3o altamente atrativos, principalmente para reservat\u00f3rios com pequena espessura de \u00f3leo e presen\u00e7a de aqu\u00edfero e/ou capa de g\u00e1s, para os quais s\u00e3o grandes os riscos de forma\u00e7\u00e3o de cones de \u00e1gua e/ou g\u00e1s, quando se utilizam po\u00e7os verticais para sua drenagem.\n0 objetivo deste trabalho, \u00e9 o desenvolvimento de uma t\u00e9cnica de simula\u00e7\u00e3o num\u00e9rica, na qual possa ser utilizada uma geometria de refinamento local para o po\u00e7os horizontais, que represente adequadamente a geometria do fluxo multif\u00e1sico ao redor do po\u00e7o.\nPara melhor representar a geometria do fluxo, considera-se que nas proximidades do po\u00e7o, o fluxo \u00e9 predominantemente radial, tendendo para linear, conforme se afasta do po\u00e7o. Ent\u00e3o, para a representa\u00e7\u00e3o num\u00e9rica utiliza-se uma malha cil\u00edndrica nas proximidades do po\u00e7o e uma malha cartesiana para a regi\u00e3o do reservat\u00f3rio mais afastada do po\u00e7o.\nForam desenvolvidos dois simuladores, com as equa\u00e7\u00f5es que regem o fluxo dos fluidos no meio poroso, discretizadas num\u00e9ricamente por diferen\u00e7as finitas, totalmente impl\u00edcito, sendo o primeiro considerando um sistema radial/cartesiano acoplado e resolvidos simultaneamente. O segundo considera os dois sistemas desacoplados, com o acoplamento radial/cartesiano feito num time-step ou numa itera\u00e7\u00e3o Newtoniana.\nA valida\u00e7\u00e3o foi feita atrav\u00e9s da compara\u00e7\u00e3o dos resultados num\u00e9ricos com as solu\u00e7\u00f5es anal\u00edticas desenvolvidas para an\u00e1lises de testes para o regime transiente.\nS\u00e3o feitas an\u00e1lises entre os m\u00e9todos de acoplamento, entre os m\u00e9todos de solu\u00e7\u00e3o do sistema linear de equa\u00e7\u00f5es e s\u00e3o apresentados alguns exemplos de aplica\u00e7\u00e3o dos modelos.\nABSTRACT\nThe main purpose of this work is to present a finite difference numerical simulator for horizontal wells, based on the use of a local refinement technique. The radial multiphase flow close to the well is more realistically represented through the use of a cylindrically oriented grid blocks. The outer region of the reservoir, where the flow regime is predominatily linear, is modelled by regular cartesian blocks.\nThe connection between the well and reservoir regions was implemented considering two approaches: in the coupled approach the radial/cartesian system is solved simultaneously, while in the uncoupled the reservoir region is solved first, followed by the solution of the well region at each time-step or at each Newtonian iteration.\nThe validation of the model was done through comparison of the numerical results with analitycal ones in the transient flow regimes.\nThe coupling and matrix solution methods as well as some results of the simulation runs are discussed in this work.\n1\tINTRODU\u00c7\u00c3O\nComo consequ\u00eancia, houve grande avan\u00e7o tecnol\u00f3gico em diversas \u00e1reas, principalmente na perfura\u00e7\u00e3o e completa\u00e7ao de po\u00e7os direcionais, permitindo que se tornasse cada vez mais vi\u00e1vel a perfura\u00e7\u00e3o, completa\u00e7\u00e3o e utiliza\u00e7\u00e3o de po\u00e7os horizontais para a produ\u00e7\u00e3o de petr\u00f3leo. A id\u00e9ia da utiliza\u00e7\u00e3o de po\u00e7os horizontais nao \u00e9 nova, pois at\u00e9 os anos 50, mais de uma centena j\u00e1 haviam sido perfurados, mas com \u00edndices de sucesso tanto para a perfura\u00e7\u00e3o quanto para a produ\u00e7\u00e3o pouco satisfat\u00f3rios. Somente a partir do inicio dos anos 80 \u00e9 que os po\u00e7os horizontais come\u00e7aram a ter resultados mais promissores.\nOs princ\u00edpios f\u00edsicos que regem o fluxo de fluidos no meio poroso mostram que os po\u00e7os horizontais oferecem muitas vantagens sobre os verticais. Dentre estas, podemos destacar a grande diferen\u00e7a entre a produtividade dos dois tipos de po\u00e7os, pois esta depende da extens\u00e3o do po\u00e7o em contato com a forma\u00e7\u00e3o produtora, que para os po\u00e7os horizontais n\u00e3o \u00e9 limitada pela espessura da forma\u00e7\u00e3o como \u00e9 para os po\u00e7os verticais. A recupera\u00e7\u00e3o final \u00e9 maior, devido a melhor efici\u00eancia de varrido. Para reservat\u00f3rios com grande extens\u00e3o areal, o n\u00famero de po\u00e7os necess\u00e1rio para sua drenagem \u00e9 bem menor. Este aspecto \u00e9 muito interessante para campos offshore, explotados com po\u00e7os perfurados a partir de plataformas. Devido a grande extens\u00e3o atingida pelo po\u00e7o horizontal, h\u00e1 maior contribui\u00e7\u00e3o para um melhor conhecimento geol\u00f3gico lateral do reservat\u00f3rio, pois em po\u00e7os verticais isto fica restrito a um ponto. Os po\u00e7os horizontais podem tamb\u00e9m oferecer solu\u00e7\u00f5es para problemas da produ\u00e7\u00e3o de \u00f3leo e g\u00e1s em reservat\u00f3rios onde os po\u00e7os verticais convencionais teriam resultados poucos satisfat\u00f3rios. Como exemplo, podemos citar: reservat\u00f3rios com problemas de forma\u00e7\u00e3o de cones de \u00e1gua ou g\u00e1s, reservat\u00f3rios com fraturas verticais, reservat\u00f3rios com baixa permeabilidade ou com anisotropia e em reservat\u00f3rios com baixa efici\u00eancia de varrido ou com baixa injetividade.\nde base para a escolha do tipo de po\u00e7o mais adequado, dever\u00e1 ser cercado de todos os cuidados, mesmo porque o custo de um po\u00e7o horizontal ainda \u00e9 maior que um po\u00e7o vertical ou direcional. Assim, para que todas as vari\u00e1veis possam ser cuidadosamente analisadas, minimizando os riscos, muitas pesquisas tem sido feitas. No inicio, estas pesquisas eram voltadas mais para a determina\u00e7\u00e3o de f\u00f3rmulas anal\u00edticas para a previs\u00e3o da produtividade dos po\u00e7os horizontais e sua compara\u00e7\u00e3o com os verticais. Mais recentemente, com o grande avan\u00e7o da inform\u00e1tica, muito se tem estudado em rela\u00e7\u00e3o a po\u00e7os horizontais. Tamb\u00e9m as novas t\u00e9cnicas em solu\u00e7\u00e3o de sistemas matriciais tem permitido avan\u00e7os na \u00e1rea de refinamento de malha e decomposi\u00e7\u00e3o de dom\u00ednios, que tem aplica\u00e7\u00e3o direta em estudos de po\u00e7os horizontais.\nEste trabalho tem por principal objetivo, a utiliza\u00e7\u00e3o de t\u00e9cnicas de refinamento de malha, aplicadas a diferen\u00e7as finitas para o desenvolvimento de um simulador que possa representar adequadamente a geometria de fluxo no reservat\u00f3rio drenado por um po\u00e7o horizontal. Tamb\u00e9m, estudar as diversas formas de solu\u00e7\u00e3o dos sistemas gerados e diferentes formas de acoplamento entre as malhas, para que possam ser aplicadas com diferentes objetivos, seja para o estudo de po\u00e7o ou para o estudo global de um reservat\u00f3rio.\n2\tREVIS\u00c3O BIBLIOGR\u00c1FICA\n2.1 Po\u00e7o Horizontal\nA id\u00e9ia da utiliza\u00e7\u00e3o de po\u00e7os horizontais para a produ\u00e7\u00e3o de petr\u00f3leo n\u00e3o \u00e9 recente, j\u00e1 que em algumas publica\u00e7\u00f5es \u00ed3,1^ encontramos refer\u00eancias de que at\u00e9 os anos 50 e 60, mais de uma centena de po\u00e7os horizontais j\u00e1 haviam sido perfurados, principalmente na URSS, mas com resultados at\u00e9 ent\u00e3o pouco satisfat\u00f3rios em termos de produ\u00e7\u00e3o de petr\u00f3leo. At\u00e9 esta \u00e9poca, os poucos estudos para a an\u00e1lise do comportamento dos po\u00e7os horizontais eram realizados em laborat\u00f3rios, com o aux\u00edlio de modelos anal\u00f3gicos el\u00e9tricos e se concentravam principalmente na compara\u00e7\u00e3o entre a produtividade do po\u00e7o horizontal com a do vertical. Devido as limita\u00e7\u00f5es f\u00edsicas dos modelos utilizados, poucas vari\u00e1veis podiam ser examinadas, entre elas, o comprimento do po\u00e7o e a espessura da forma\u00e7\u00e3o. \u00c9 citado ^7'1^ que nesta mesma \u00e9poca foi desenvolvida por Merkulov, V.P. (1958), a primeira f\u00f3rmula anal\u00edtica para o c\u00e1lculo do IP de po\u00e7os horizontais.\nA partir do final dos anos 70, devido \u00e0 crescente valoriza\u00e7\u00e3o do petr\u00f3leo, iniciou-se uma incessante corrida da ind\u00fastria petrol\u00edfera, para a descoberta de novas reservas e otimiza\u00e7\u00e3o da produ\u00e7\u00e3o e recupera\u00e7\u00e3o final dos campos em produ\u00e7\u00e3o. Como consequ\u00eancia, houve um grande avan\u00e7o em diversas \u00e1reas, principalmente nas t\u00e9cnicas de perfura\u00e7\u00e3o , completa\u00e7\u00e3o e perfilagem de po\u00e7os direcionais, tornando-se a partir da\u00ed, tecnicamente vi\u00e1vel, a utiliza\u00e7\u00e3o de po\u00e7os horizontais para a produ\u00e7\u00e3o de petr\u00f3leo. \u00c9 a partir de ent\u00e3o que come\u00e7am a ser publicados v\u00e1rios artigos sobre a tecnologia de po\u00e7os horizontais.\nA partir de 1978 - principalmente com a Elf Acquitaine e o Instituto Franc\u00eas de Petr\u00f3leo, que financiados pela comunidade econ\u00f4mica europ\u00e9ia, iniciaram estudos para a perfura\u00e7\u00e3o de quatros po\u00e7os horizontais - \u00e9 que come\u00e7aram a ser publicados v\u00e1rios artigos sobre o comportamento de po\u00e7os horizontais. G\u00edger apresentou f\u00f3rmulas anal\u00edticas para o c\u00e1lculo do IP de po\u00e7os horizontais e vaz\u00e3o cr\u00edtica para a forma\u00e7\u00e3o de cristas de \u00e1gua. Apresentou tamb\u00e9m os crit\u00e9rios para a escolha entre po\u00e7os horizontais e verticais conven -\ndon\u00e1is. Crit\u00e9rios que levavam em considera\u00e7\u00e3o as dimens\u00f5es do reservat\u00f3rio, mecanismos de manuten\u00e7\u00e3o de press\u00e3o, anisotropia e caracter\u00edsticas dos fluidos. Em outro artigo Giger analisou as vantagens da produ\u00e7\u00e3o atrav\u00e9s de po\u00e7os horizontais em reservat\u00f3rios com heterogeneidades tais como: varia\u00e7\u00f5es da permeabilidade lateral e vertical e com fraturas. Analisou tamb\u00e9m, os efeitos dos mecanismos de alimenta\u00e7\u00e3o e o comprimento do po\u00e7o horizontal. Ap\u00f3s os primeiros cinco anos de produ\u00e7\u00e3o dos po\u00e7os perfurados pela Elf Aquitaine e o Instituto Franc\u00eas de Petr\u00f3leo, Reiss l3) apresentou os principais resultados, comparando-os com as an\u00e1lise te\u00f3ricas desenvolvidas para o estudo do IP, efici\u00eancia de varrido e produ\u00e7\u00e3o em reservat\u00f3rios fraturados.\nCom a utiliza\u00e7\u00e3o de um modelo hodogr\u00e1fico, Giger desenvolveu f\u00f3rmulas anal\u00edticas para o c\u00e1lculo da deforma\u00e7\u00e3o vertical dos contatos \u00f3leo/\u00e1gua e g\u00e1s/\u00f3leo e a vaz\u00e3o cr\u00edtica para a forma\u00e7\u00e3o de crista de \u00e1gua. Aplicou as f\u00f3rmulas para reservat\u00f3rios com capa de g\u00e1s e aqu\u00edfero n\u00e3o atuante, influxo de \u00e1gua de fundo e lateral. Chaperon fez um estudo das vantagens da produ\u00e7\u00e3o com po\u00e7os horizontais em reservat\u00f3rios com camadas isoladas de baixa permeabilidade. Utilizando as f\u00f3rmulas anal\u00edticas desenvolvidas por Giger, Kacher W estudou o problema da produtividade dos po\u00e7os horizontais em reservat\u00f3rios fraturados e com anisotropia. Joshi desenvolveu equa\u00e7\u00f5es para o IP de po\u00e7os horizontais e fez estudos para determina\u00e7\u00e3o da influ\u00eancia da anisotropia do reservat\u00f3rio, espessura, \u00e1rea de drenagem do po\u00e7o e da excentricidade na produtividade. Estudou tamb\u00e9m a tend\u00eancia da forma\u00e7\u00e3o de cristas de g\u00e1s e \u00e1gua. Babu et al ma-tendo a forma inicial proposta por Giger, desenvolveram o c\u00e1lculo do IP para reservat\u00f3rios limitados com po\u00e7o parcialmente penetrante.\nOs estudos desenvolvidos at\u00e9 ent\u00e3o, se prendiam ao desenvolvimento de f\u00f3rmulas anal\u00edticas, sem refer\u00eancias \u00e0 utiliza\u00e7\u00e3o de simuladores num\u00e9ricos para o estudo do comportamento de po\u00e7os horizontais. Sherrard \u00ed6- apresentou um estudo para po\u00e7os horizontais no qual fez uso de um simulador black-oil, totalmente impl\u00edcito com o po\u00e7o horizontal sendo representado por v\u00e1rios blocos, numa regi\u00e3o em que a malha tinha um grande refinamento, que se estendia por todo o reservat\u00f3rio, em todas as dire\u00e7\u00f5es. Uma an\u00e1lise\ndos cuidados na utiliza\u00e7\u00e3o de f\u00f3rmulas para o c\u00e1lculo do 1P aplicadas para simuladores num\u00e9ricos convencionais por diferen\u00e7as finitas, foi feita por Lee \u00ed8h Para evitar resultados errados recomendou um grande refinamento e que o po\u00e7o fosse representado por varios blocos. Kossack tamb\u00e9m usou um simulador black-oil totalmente impl\u00edcito para simular o comportamento da produ\u00e7\u00e3o atrav\u00e9s de po\u00e7os horizontais, em reservat\u00f3rios com. v\u00e1rias f\u00e1cies de diferentes permeabilidades. Chang usou o BOAST para fazer a simula\u00e7\u00e3o do po\u00e7o horizontal ou inclinado, atrav\u00e9s da decomposi\u00e7\u00e3o do po\u00e7o em tr\u00eas componentes centrados e paralelos \u00e0s faces dos blocos e o c\u00e1lculo do IP para cada componente usando o m\u00e9todo das imagens.\nTodas as f\u00f3rmulas desenvolvidas para o c\u00e1lculo do IP assumiram at\u00e9 agora o comportamento do regime permanente, ou seja, davam estimativa para a produtividade ou injetividade para po\u00e7os, para os quais, a queda de press\u00e3o entre o po\u00e7o e a forma\u00e7\u00e3o permanece constante, tais como nos processos de inje\u00e7\u00e3o de \u00e1gua.\n0 comportamento do fluxo de um fluido incompress\u00edvel em po\u00e7os horizontais no regime transiente, para reservat\u00f3rios com espessura finita e infinito horizontalmente foi es* tudado por Lara e Clonts Goode e Thambynayagam descreveram as repostas de press\u00e3o no po\u00e7o horizontal para um fluido levemente compress\u00edvel num reservat\u00f3rio semi-infmito: limitado verticalmente e na dire\u00e7\u00e3o perpendicular ao po\u00e7o, desprezando o efeito gravitacional. Ozkan et al (161 desenvolveram curvas tipos para testes de po\u00e7os horizontais em reservat\u00f3rio infinito, Odeh e Babu l13) apresentaram an\u00e1lises do comportamento no regime transiente para reservat\u00f3rio limitado em todas as dire\u00e7\u00f5es e para po\u00e7o parcialmente ou totalmente penetrante, localizado paralelamente a duas faces, em qualquer ponto do reservat\u00f3rio. Tamb\u00e9m para fluido levemente compress\u00edvel sem o efeito gravitacional.\n2.2 Refinamento Local\nDurante a simula\u00e7\u00e3o num\u00e9rica de reservat\u00f3rios \u00e9 desej\u00e1vel que as regi\u00f5es em que ocorrem fortes varia\u00e7\u00f5es nas caracter\u00edsticas do fluxo, sejam representadas por uma malha com refinamento tal, que possa mostrar com precis\u00e3o estas varia\u00e7\u00f5es. Estas regi\u00f5es na maioria dos casos s\u00e3o as regi\u00f5es dos po\u00e7os, que \u00e9 uma regi\u00e3o relativamente pequena quando comparada com todo o reservat\u00f3rio. Portanto, \u00e9 interessante que somente esta regi\u00e3o tenha um grau de refinamento maior, deixando as outras partes de reservat\u00f3rio representada por blocos maiores, o que n\u00e3o provoca nenhuma perda de precis\u00e3o e contribui enormemente para o aumento da velocidade de simula\u00e7\u00e3o e economia de mem\u00f3ria computacional.\nNa simula\u00e7\u00e3o num\u00e9rica de reservat\u00f3rios com discretiza\u00e7\u00e3o por diferen\u00e7as finitas e uso de coordenadas cartesianas, devem ser tomados alguns cuidados na implementa\u00e7\u00e3o de refinamentos local, para que n\u00e3o ocorram erros que comprometam os resultados. Um dos primeiros pequi sadores nesta \u00e1rea foi Rosenberg que apresentou um m\u00e9todo de refinamento local onde prev\u00ea quatro diferentes configura\u00e7\u00f5es para a aplica\u00e7\u00e3o de diferen\u00e7as finitas. Mostra que o uso destas configura\u00e7\u00f5es s\u00e3o efetivas e mais econ\u00f4micas. Quandalle e Besset com o objetivo de melhor representar reservat\u00f3rios com falhas, discord\u00e2ncias geol\u00f3gicas e outras anomalias, fizeram a aplica\u00e7\u00e3o do refinamento local em v\u00e1rios n\u00edveis, com o uso de m\u00faltiplos time-steps para diferentes grupos de blocos, num simulador black-oil impl\u00edcito na press\u00e3o e na satura\u00e7\u00e3o. Concluiram que o uso deste procedimento proporcionava resultados bem pr\u00f3ximos dos obtidos com a utiliza\u00e7\u00e3o de uma malha totalmente refinada, mas com grande redu\u00e7\u00e3o no tempo de computa\u00e7\u00e3o.\nHeinemann et al UD sugeriram a aplica\u00e7\u00e3o do refinamento local din\u00e2mico em simulador de m\u00faltiplas aplica\u00e7\u00f5es, com o objetivo de fazer uma grande redu\u00e7\u00e3o no n\u00famero de blocos necess\u00e1rios \u00e0 representa\u00e7\u00e3o do reservat\u00f3rio. As equa\u00e7\u00f5es foram formuladas para diferentes graus de implicitude, que dependiam dos n\u00edveis de varia\u00e7\u00e3o da press\u00e3o, satura\u00e7\u00e3o e da temperatura do reservat\u00f3rio. Tamb\u00e9m foi feita a sele\u00e7\u00e3o din\u00e2mica do refinamento e do tamanho do time-step e uma an\u00e1lise do erro de discretiza\u00e7\u00e3o devido a este\nrefinamento.\nA malha h\u00edbrida proposta por Pedrosa, representava a regi\u00e3o pr\u00f3xima ao po\u00e7o atrav\u00e9s de uma malha cil\u00edndrica ou el\u00edptica - a depender das caracter\u00edsticas do reservat\u00f3rio - e a regi\u00e3o mais afastada do po\u00e7o atrav\u00e9s de uma malha cartesiana. Esta configura\u00e7\u00e3o adaptava perfeitamente \u00e0 geometria do fluxo pr\u00f3ximo e longe do po\u00e7o, podendo dentro da malha cil\u00edndrica, os blocos serem sucessivamente menores, conforme se aproxima do po\u00e7o. Com esta configura\u00e7\u00e3o, desenvolveu simuladores com graus de implici-tudes diferentes para as duas regi\u00f5es; a regi\u00e3o do po\u00e7o totalmente impl\u00edcita e a regi\u00e3o do reservat\u00f3rio num esquema IMPES. As duas regi\u00f5es foram resolvidas independentemente, sendo as condi\u00e7\u00f5es dos blocos cartesianos vizinhos aos cil\u00edndricos, usadas como condi\u00e7\u00f5es de fronteira para os cil\u00edndricos, num processo que poderia ser iterativo ou nao. 0 processo n\u00e3o iterativo traz bons resultados, pois segundo Akbar et al ^i8) a converg\u00eancia num processo iterativo \u00e9 atingida numa \u00fanica itera\u00e7\u00e3o.\nEm outro artigo, Quandalle e Besset analisaram o efeito do refinamento de malha em diferentes n\u00edveis, e para eliminar efeitos indesej\u00e1veis, propuseram esquemas mais sofisticados para diferen\u00e7as finitas envolvendo cinco e nove pontos, ao inv\u00e9s de dois, aplic\u00e1vel a qualquer composi\u00e7\u00e3o de malha tridimensional. Han apresentou um esquema de refinamento din\u00e2mico para qualquer regi\u00e3o do reservat\u00f3rio, onde o refinamento \u00e9 sempre de um bloco para um n\u00famero par de vizinhos. Wasserman prop\u00f4s a aplica\u00e7\u00e3o do refinamento est\u00e1tico em v\u00e1rios n\u00edveis para simuladores tridimensionais, usando para a solu\u00e7\u00e3o o conceito de decomposi\u00e7\u00e3o de dom\u00ednios. Ewing et al discutiram as v\u00e1rias estrat\u00e9gias para o refinamento de malha e o uso da decomposi\u00e7\u00e3o de dom\u00ednios. Heine-mann et al propuseram o m\u00e9todo de discretiza\u00e7ao volume finito ou balan\u00e7o, que fica entre a diferen\u00e7a finita e o elemento finito e se caracteriza pela forma\u00e7\u00e3o dos blocos pela\n8 liga\u00e7\u00e3o entre as linhas perpendiculares aos grid points, fazendo com que cada bloco tenha uma geometria irregular e com seis vizinhos. Brand e Heinemman&lt;29\\ apresentaram novas formas de fatora\u00e7ao da matriz esparsa gerada quando do uso de refinamento local e apresentaram tamb\u00e9m alguns m\u00e9todos eficientes de ordena\u00e7\u00e3o da malha.\n3\tDEFINI\u00c7\u00c3O DO PROBLEMA\n0 principal objetivo deste trabalho, \u00e9 o estudo das t\u00e9cnicas e desenvolvimento de um simulador num\u00e9rico, com malha que represente adequadamente a geometria de fluxo, para o estudo do comportamento de reservat\u00f3rios com produ\u00e7\u00e3o atrav\u00e9s de po\u00e7os horizontais.\nAs equa\u00e7\u00f5es de fluxo foram desenvolvidas para a constru\u00e7\u00e3o de um simulador tridimensional, bif\u00e1sico ( \u00f3leo e \u00e1gua ), totalmente impl\u00edcito e utiliza\u00e7\u00e3o do conceito de malha h\u00edbrida, ou seja, a regi\u00e3o pr\u00f3xima ao po\u00e7o - onde ocorrem grandes varia\u00e7\u00f5es de press\u00e3o e satura\u00e7\u00e3o e onde a geometria do fluxo \u00e9 predominantemente radial - ser\u00e1 representada por uma malha cil\u00edndrica. A regi\u00e3o mais afastada do po\u00e7o ser\u00e1 representada por uma malha cartesiana com o acoplamento entre as duas regi\u00f5es atrav\u00e9s de dois processos distintos:\n\u2022 Sistema totalmente acoplado:\nConsidera as duas malhas sendo resolvidas simult\u00e1neamente no mesmo sistema linear de equa\u00e7\u00f5es, ou seja, no mesmo Jacobiano;\n\u00bb Sistemas desacoplados:\nConsidera as malhas resolvidas separadamente, com posterior acoplamento atrav\u00e9s da transfer\u00eancia dos termos de fluxo em cada time-step ou em cada itera\u00e7\u00e3o New-toniana.\nS\u00e3o feitas compara\u00e7\u00f5es entre os resultados gerados pelos diferentes m\u00e9todos de acoplamente das regi\u00f5es e tamb\u00e9m s\u00e3o feitas an\u00e1lises em rela\u00e7\u00e3o aos m\u00e9todos de solu\u00e7\u00e3o do sistema linear de equa\u00e7\u00f5es,\nO reservat\u00f3rio a ser estudado \u00e9 ilustrado pela figura 3.1.\nPo\u00e7o horizontal\nFigura 3.1: Representa\u00e7\u00e3o do reservat\u00f3rio\n4\tFORMULA\u00c7\u00c3O DO MODELO NUM\u00c9RICO\n4.1 Formula\u00e7\u00e3o Geral\n0 modelo desenvolvido \u00e9 um simulador black-oil, totalmente impl\u00edcito, tridimensional, bif\u00e1sico ( \u00f3leo e \u00e1gua. ), com as regi\u00f5es que representam o reservat\u00f3rio e o po\u00e7o podendo ser totalmente acopladas ou desacopladas.\nAs equa\u00e7\u00f5es que regem o fluxo dos fluidos no meio poroso s\u00e3o derivadas a partir da equa\u00e7\u00e3o da conserva\u00e7\u00e3o de massa para o fluxo de uma fase,\n\u201e . dm\n= \u2014-H;\t(4.1)\nonde : m \u2014 fluxo de massa atrav\u00e9s da fronteira;\nm = massa por unidade de volume;\nq \u2014 termo fonte.\nFazendo a substitui\u00e7\u00e3o do fluxo de massa e a massa no meio poroso em termos de densidade m\u00e9dia, porosidade e satura\u00e7\u00e3o, teremos para a fase Z:\n-\t- ^(p^) +\t,\t(4.2)\nUsando a lei de Darcy para o fluxo multif\u00e1sico, que \u00e9 dada por;\ntq =\t~ 7\u00edVB)\t(4.3)\nM\u00ed\ne o conceito de fator volume de forma\u00e7\u00e3o, podemos derivar a equa\u00e7\u00e3o que rege o fluxo para cada, fase, conforme:\nV.[Al(Vp,-7iW = |)[^\u00edl + ?i\t(4-4)\n\nAl\nSegundo a formula\u00e7\u00e3o apresentada por PedrosaL2^ esta equa\u00e7\u00e3o pode ser inte-\ngrada sobre um volume de controle 1<\nDefinindo a diferen\u00e7a de potencial como, V&amp;/ =\tD) e admitindo fluxo\npermanente atrav\u00e9s das fronteiras, a equa\u00e7\u00e3o 4.4 pode ser reescrita e integrada como:\njv V.[A,V\u00cd,]dV = jv\t+ 9,\t(4.6)\nUsando o teorema do divergente ( ou teorema de Gauss ), que transforma uma\nintegral de volume em uma integral de superf\u00edcie, esta equa\u00e7\u00e3o pode ser reescrita, com o\nlado esquerdo modificado para uma integral do fluxo de massa sobre uma superf\u00edcie A,\nassim:\nonde : \u00e2A ~ elemento de \u00e1rea atravessada pelo fluxo;\nn ~ vetor unit\u00e1rio normal a superf\u00edcie;\n(4.7)\nV ~ volume de controle.\nO lado esquerdo da equa\u00e7\u00e3o acima, \u00e9 o termo de fluxo e representa o fluxo de massa sobre toda superf\u00edcie de controle e o lado direito \u00e9 0 termo de acumula\u00e7\u00e3o que repesenta a taxa de expans\u00e3o e contra\u00e7\u00e3o do volume de controle.\nPara a solu\u00e7\u00e3o do problema s\u00e3o necess\u00e1rias as seguintes rela\u00e7\u00f5es adicionais:\nZSi ^=SO + SW=1\n\" Po \u201c Pw ~\n(4.8)\n(4.9)\n4.1.1\tCondi\u00e7\u00f5es Iniciais\n0 reservat\u00f3rio se apresenta inicialmente saturado com \u00f3leo e \u00e1gua conata, podendo ou n\u00e3o ter presen\u00e7a de \u00e1gua livre ( aqu\u00edfero ). Quando houver aqu\u00edfero, considera-se que as fases est\u00e3o em equil\u00edbrio gravitacional e capilar. A press\u00e3o original, pt) \u00e9 dada no contato \u00f3leo/\u00e1gua ou numa profundidade de refer\u00eancia arbitr\u00e1ria.\n4.2\tDiscretiza\u00e7\u00e3o das Equa\u00e7\u00f5es de Fluxo\nAs equa\u00e7\u00f5es anteriores sao discretizadas por diferen\u00e7as finitas para formula\u00e7\u00e3o totalmente impl\u00edcita, com esquema de bloco centrado com cinco pontos.\n4.1.2\tCondi\u00e7\u00f5es de Contorno\n4.2.1\tTermo de Acumula\u00e7\u00e3o\nConsiderando diferen\u00e7as regressivas no tempo, o termo de acumula\u00e7\u00e3o pode ser\naproximado por:\n(4.10)\nonde At \u00e9 o operador de diferen\u00e7as no tempo, definido como:\n(4.11)\nonde n representa o n\u00edvel de tempo e \u00e3; \u00e9 o inverso do fator volume de forma\u00e7\u00e3o B( , ou seja, bi \u2014\nSabendo que:\n\nn4-l\n(4.12)\nA<[^] = ^f{[l +\t~ P?)](l - S':+'K+l - ( WU\n+ Mrt+1 ~\t- (S\u201e6w)\u201d)u\u00ed\nPara a equa\u00e7\u00e3o do \u00f3leo foi usada a rela\u00e7\u00e3o adicional:\n$t> + Sw = 1\n(4.13)\n(4.14)\n(4.15)\n4.2.2\tTermo de Fluxo\nO termo de fluxo \u00e9 fortemente dependente da geometria da malha, e esta tem que ser levada em conta na discretiza\u00e7\u00e3o das equa\u00e7\u00f5es. Para a representa\u00e7\u00e3o do po\u00e7o horizontal adotou-se a hip\u00f3tese de que pr\u00f3ximo ao po\u00e7o, as linhas de fluxo s\u00e3o aproximadamente radiais com as linhas equ\u00edpotenciais circulares, conforme ilustrado na figura 4.1, o que levou \u00e0 ado\u00e7\u00e3o de uma malha h\u00edbrida ( Pedrosa^22^ ), ou seja, cil\u00edndrica para a regi\u00e3o pr\u00f3xima ao po\u00e7o e cartesiana para regi\u00f5es mais afastadas.\nFigura 4.1: Representa\u00e7\u00e3o das linhas de fluxo pr\u00f3ximo ao po\u00e7o\nPortanto, para a discretiza\u00e7\u00e3o do termo de fluxo tem que ser levado em considera\u00e7\u00e3o o sistema de coordenadas e a \u00e1rea atravessada pelo fluxo. Para um determinado\n(4.16)\n0 potencial de fluxo pode ser decomposto em parcelas referentes a cada, dire\u00e7\u00e3o em cada sistema de coordenadas, ou seja:\nCoordenadas cil\u00edndricas\nV0;\nCoordenadas cartesianas\n(4.17)\n(4.18)\nonde, er , e# , ez, ev e e- s\u00e3o vetores unit\u00e1rios para cada dire\u00e7\u00e3o.\nAssim quando aplicado a uma determinada dire\u00e7\u00e3o as parcelas referentes \u00e0s outras dire\u00e7\u00f5es se anulam. Por exemplo, para a dire\u00e7\u00e3o x teremos:\nkri d$i Bw dx\ndA\n(4-19)\nConsiderando que pode ser obtido como um valor m\u00e9dio, que d A pode ser determinada de acordo corn a geometria e que o termo\tseja fun\u00e7\u00e3o somente da\ndire\u00e7\u00e3o considerada a integral pode ser determinada, chegando-se a seguinte forma:\n\n(4.20)\nO termo (jFF^^)jace, representa a transmissibilidade e cujas parcelas s\u00e3o calculadas para as faces, como a seguir:\ninterface\nI\n</, I a, \u2019 + >\nI I d\nponderador : w = portanto:\nPljace = (1 ~\t+ w/z\u00ed(+1\t(4.21)\nBi\u00edace ~ (1 - w)Bu + wBu+i\t(4.22)\nAs propriedades nos pontos nodais, s\u00e3o fun\u00e7\u00f5es das press\u00f5es nos mesmos.\n\u00bb FF - Fator de forma, que leva em considera\u00e7\u00e3o a geometria da face atravessada pelo fluxo c portanto definidos para cada tipo de malha ( cartesiana ou cil\u00edndrica ) e para cada dire\u00e7\u00e3o, conforme a formula\u00e7\u00e3o que \u00e9 apresentada por Pedrosa^22h\n- Malha Cil\u00edndrica\n* Dire\u00e7\u00e3o Radial - r\nri rf\tr\t.\n\u00edi+1/2 ~ +\nKrijh\t\u00abr\u00ed+lj* \u2019'.+ 1/2\nonde kr\u00edjk \u00e9 a permeabilidade absoluta na dire\u00e7\u00e3o radial.\n* Dire\u00e7\u00e3o Angular - 0\n^\u25a0fzj+i/2 \u2014 [\n(4.24)\n^S\u00edj+ik\nonde k\u00e7ijk \u00e9 a permeabilidade absoluta na dire\u00e7\u00e3o angular.\n* Dire\u00e7\u00e3o Linear - z\nFF ........ ^(\u00ed^+l/z)2 ~ (r,-i/2)2)1\n1 j /\u2018j-\u00edh | \u00a3\u00ed*\u00b1jl~\u00a3\u00ed\u00b1lzi fcp\u00edjk\tkp\u00edjfc-H\nonde ki)ijh \u00e9 a permeabilidade absoluta na dire\u00e7\u00e3o linear.\n- Malha Cartesiana\n* Dire\u00e7\u00e3o - x\nri p\t_ r\n\u00edj-Fl/2 [ Xj^y^-X\u00ed __ Xf + l~Xi^i/2\n*\tDire\u00e7\u00e3o - y\nf AXtADfc ,\nr ^b+i/2 \u201d lyjW2-y7 _ y,-+1-r>+1/a J\n*\tDire\u00e7\u00e3o - z\nA Y AV,\nPP\t_ r__________________________\ni ifc+1/2 ~\t__\nkD\u00edjk\tfcpvk + i\npara as faces i \u2014 1/2, j \u2014 1/2 e k \u2014 1/2 as f\u00f3rmulas s\u00e3o similares.\n(4.25)\n(4.26)\n(4.27)\n(4.28)\nPara a malha cil\u00edndrica \u00e9 adotado um espa\u00e7amento logaritmo, que se caracteriza por ter blocos exponencialmente maiores conforme se afasta do po\u00e7o. Esta configura\u00e7\u00e3o \u00e9 interessante, pois pr\u00f3ximo ao po\u00e7o, as mudan\u00e7as de satura\u00e7\u00e3o e press\u00e3o s\u00e3o mais intensas. Para o c\u00e1lculo da posi\u00e7\u00e3o do ponto nodal, cons\u00eddera-se que para o fluxo de um fluido incompress\u00edvel numa malha cil\u00edndrica, este ponto deve estar localizado no ponto onde a distribui\u00e7\u00e3o de press\u00e3o para o regime permanente, seja igual a press\u00e3o m\u00e9dia volum\u00e9trica do bloco.\nPara o bloco radial, representado pela figura 4.2, a distribui\u00e7\u00e3o de press\u00e3o para o fluxo permanente \u00e9 dado por:\n\n\u00eakhln{\nT\nD-1/2\n)\nPara o fluxo incompress\u00edvel no regime permanente a vaz\u00e3o g, atrav\u00e9s de qualquer se\u00e7\u00e3o transversal do bloco \u00e9 constante. E a press\u00e3o m\u00e9dia volum\u00e9trica \u00e9 dada por:\n1\n(4.30)\nFigura 4.2: Bloco cil\u00edndrico para c\u00e1lculo da posi\u00e7\u00e3o do ponto nodal\n0 volume de um bloco cil\u00edndrico, conforme esquematizado na figura 4.2, \u00e9 dado\npor:\n= f (^+1/2 \u2014\tO31)\ne\ndV Ohrdr\n(4.32)\nPortanto a press\u00e3o m\u00e9dia volum\u00e9trica do bloco pode ser escrita como:\n2\t/\u2022\u2019\u25a0&lt;+1/2 r\nn/r'\u00bf\t\u201e \u201e2\t)/} / UA-\u00ed/2 +\n\u00ed+l/2 ri-l/2)n ^\u00ed-1/2\n......]Ohrdr\nri-l/2\n(4.34)\nque integrada de\t\u00e0 n+1/2, resulta era:\nrt'+\u00cd/2\nr,-i/2\n(4.35)\nse Ti \u00e9 o ponto nodal, ent\u00e3o a press\u00e3o ( p ), neste ponto deve ser igual a press\u00e3o m\u00e9dia, da\u00ed igualando as equa\u00e7\u00f5es 4.29 e 4.35, teremos a posi\u00e7\u00e3o deste ponto:\nonde : o =\ne a posi\u00e7\u00e3o das faces dos blocos \u00e9 dada por:\nn+1/2 = ru,ei\u00e3p\nN.Blocos\n(4.37)\n4.2.3\tTratamento das Interfaces\nA malha cil\u00edndrica possui o mesmo volume e o mesmo n\u00famero de blocos na dire\u00e7\u00e3o z, que os blocos cartesianos atravessados pelo po\u00e7o. Na dire\u00e7\u00e3o radial o n\u00famero m\u00ednimo de blocos s\u00e3o 2 e estes sao exponencialmente crescentes a partir do po\u00e7o. Na dire\u00e7\u00e3o angular o n\u00famero m\u00ednimo de blocos s\u00e3o 4.\nPara o modelo totalmente acoplado pode haver, na dire\u00e7\u00e3o radial (r) e linear (z), comunica\u00e7\u00e3o entre a malha cil\u00edndrica e a cartesiana. A \u00fanica diferen\u00e7a que ocorre nas equa\u00e7\u00f5es de fluxo dos blocos de interfaces s\u00e3o os fatores de forma. Estes s\u00e3o dados por:\n1.\tDire\u00e7\u00e3o Radial - r\nA0AD\nFFii+i/2 +\n2.\tDire\u00e7\u00e3o Linear - z\nFFIM/i = I\nA\u00dc((r,H/2)! - (r,_1/2)2) AD(rL\u201eJ^) A^rv\t*zci<\n(4.39)\nNestas equa\u00e7\u00f5es ternos:\n\u2666\tre ~ raio externo da malha, cil\u00edndrica;\n\u2666\t?nx = ponto nodal do bloco mais externo da malha cil\u00edndrica;\n\u00bb dcv = dist\u00e2ncia entre ponto nodal do bloco znais externo da malha cil\u00edndrica e o do bloco catesiano vizinho;\n\u2666\tkrnx \u2014 permeabilidade absoluta do bloco cil\u00edndrico mais externo na dire\u00e7\u00e3o radial;\n\u2666\tkTCV = permeabilidade absoluta do bloco cartesiano na dire\u00e7\u00e3o do bloco radial vizinho;\n\u2666\tkznx = permeabilidade absoluta do bloco cil\u00edndrico mais externo na dire\u00e7\u00e3o linear;\n\u00bb kxcv = permeabilidade absoluta do bloco cartesiano na dire\u00e7\u00e3o do bloco radial vizinho;\nPara os modelos desacoplados n\u00e3o existem termos de interfaces, pois a comunica\u00e7\u00e3o cartesiano/cil\u00edndrico \u00e9 determinada pela substitui\u00e7\u00e3o do termo de fluxo referente as faces externas dos blocos cil\u00edndricos, pelos termos de fluxo dos blocos cartesianos vizinhos, calculados numa itera\u00e7\u00e3o ou num time step. No pr\u00f3ximo cap\u00edtulo ser\u00e3o dados mais detalhes sobre este acoplamento.\n4,3\tEqua\u00e7\u00f5es de Fluxo na Forma de Diferen\u00e7as\nDe acordo com as discretiza\u00e7\u00f5es do termo de acumula\u00e7\u00e3o e termo de fluxo, feitas nas se\u00e7\u00f5es anteriores, as equa\u00e7\u00f5es para o fluxo do \u00f3leo e \u00e1gua no meio poroso, num esquema totalmente impl\u00edcito na press\u00e3o e na satura\u00e7\u00e3o, podem ser escritas da seguinte forma:\nEqua\u00e7\u00e3o para o \u00f3leo:\nE \u00cd71\t\u00cdMti\u00f5WS - A+1) - KtrifM. - Ml +\t\n\t^ro\u201df1/2((p\u2122+1 - PS) - 7.\"+-\\/,(Dm - MJ]) = ^4([1 + c,(Pr\u2018 - ?;)i(i - S\u2019\u00abK+' - (SA)\")W + ?0\t(4.40)\nEqua\u00e7\u00e3o para a \u00e1gua:\nE mr;,z,\u00edt\u00f3\\ - *+ij -\t- p^+') -\t- b.\u00bb +\nm\n- pS) - (a,4\u00ed\u2019 ~\t- a,-.))} =\n^([\u00ed + Cr(?;+1 - ;>;)](s\u201e\u00ed>,\u201e)\"+1 - (Sw6\u201e)\")\u00ed>4 + \u25a0?\u00ab.\t(4.4i)\nNas equa\u00e7\u00f5es acima, m representa as tr\u00eas dire\u00e7\u00f5es (i, j, k ), o time step anterior ( aid time step level), \u00e9 dado por n e o time step atual ( new time step level), por n 4-1. A transinissibilidade e o peso espec\u00edfico dos fluidos s\u00e3o calculados nas faces dos blocos.\nEstas equa\u00e7\u00f5es podem ser escritas simplificadamente utilizando-se a nota\u00e7\u00e3o definda por Aziz e Settari30, da seguinte forma:\nA[T((APi - 7,AD)g+' =\t(4-42)\nOnde o primeiro membro significa:\nkzlTJ&amp;zPt - 7\u00ed^D)]^\nPara uma vari\u00e1vel U, o operador de diferen\u00e7as centrais \u00e9 definido como: (A^)f - Ui+l/2 - U^/2\nEm termos de p0 e Sw a equa\u00e7\u00e3o 4,42 pode ser escrita como:\nA[T\u201e(APo - %AD)]\"t\u2019 =\tA,[<(1 - S\u201e)]w\t(4.44)\nA[T,\u201e(Ap. - AP\u201e\u201e -\tA.D)]$\u2019 =\t(4-45)\nEstas equa\u00e7\u00f5es escritas para todos blocos ijk, (i = 1,2, - \u2022 \u2022 nz, j = 1,2, - \u2022 \u2022 ny e k \u2014 1,2, > \u25a0 \u2022 nz ) no n\u00edvel de itera\u00e7\u00e3o n +1 geram um sistema n\u00e3o-linear de 2 x nx x ny x nz equa\u00e7\u00f5es com 2 x n\u00ae x ny x nz inc\u00f3gnitas.\n\u25a0Os m\u00e9todos de solu\u00e7\u00e3o do sistema n\u00e3o linear de equa\u00e7\u00f5es, assim como os m\u00e9todos de solu\u00e7\u00e3o do sistema j\u00e1 linearizado ser\u00e3o abordados no pr\u00f3ximo cap\u00edtulo.\n5\tSOLU\u00c7\u00c3O DO MODELO NUM\u00c9RICO\n0 objetivo deste cap\u00edtulo \u00e9 fazer a descri\u00e7\u00e3o do problema a ser resolvido e todas as hip\u00f3teses utilizadas para sua solu\u00e7\u00e3o.\n5.1\tDescri\u00e7\u00e3o do Problema\nAs equa\u00e7\u00f5es desenvolvidas e discretizadas anteriormente ser\u00e3o aplicadas para o estudo do comportamento de um reservat\u00f3rio produzindo atrav\u00e9s de um po\u00e7o horizontal num modelo com as seguintes caracter\u00edsticas:\n\u2022\tTotalmente impl\u00edcito;\n\u2022\tTridimensional;\n\u2022\tBif\u00e1sico ( \u00f3leo e \u00e1gua );\n\u2022\tPo\u00e7o com condutividade infinita e com fluxo nas pontas desprez\u00edvel;\n\u2022\tProdu\u00e7\u00e3o com vaz\u00e3o ou press\u00e3o de fluxo de fundo especificada;\n\u2022\tUso de malha h\u00edbrida, com regi\u00e3o do po\u00e7o em coordenadas cil\u00edndricas e a regi\u00e3o do reservat\u00f3rio em coordenadas cartesianas;\n\u2022\tRegi\u00f5es totalmente acopladas ou desacopladas;\n\u2022\tConsidera\u00e7\u00e3o do efeito gravitacionai;\n\u2022\tConsidera\u00e7\u00e3o do sentido de fluxo;\n\u2022\tSolu\u00e7\u00e3o do sistema n\u00e3o linear de equa\u00e7\u00f5es pelo m\u00e9todo de Newton-Raphson;\n\u2022\tSolu\u00e7\u00e3o do sistema linear de equa\u00e7\u00f5es por m\u00e9todo direto e iterativo.\nFigura 5.1: Modelo f\u00edsico e sitema de coordenadas\n5.2\tSolu\u00e7\u00e3o do Sistema n\u00e3o-Linear de Equa\u00e7\u00f5es\nPara o esquema totalmente impl\u00edcito, o m\u00e9todo de Newton Raphson ser\u00e1 aplicado para resolver o sistema n\u00e3o linear de equa\u00e7\u00f5es, nas inc\u00f3gnitas pa e SWi que \u00e9 gerado com a aplica\u00e7\u00e3o das equa\u00e7\u00f5es desenvolvidas anteriormente a todos os blocos que formam o reservat\u00f3rio.\nO esquema iterativo do Newton-Raphson \u00e9 gerado a partir da expans\u00e3o das fun\u00e7\u00f5es de res\u00edduos de cada fase,\t~ o, w ), em torno da itera\u00e7\u00e3o ( v ), e reten\u00e7\u00e3o\ndos termos de menor ordem.\nGen\u00e9ricamente o m\u00e9todo de Newton-Raphson pode ser escrito, como:\n\n(\ndF\u00a1 dx\n(5.1)\nonde:\n\u2022 F\u00a1 s\u00e3o as fun\u00e7\u00f5es de res\u00edduos dadas pelas equa\u00e7\u00f5es;\n= A[T0(Ap\u201e - 7,Aflg\u2018 - ^A([^\u201e(l -\t- 9o = 0\t(5.2)\nFwijk AfTuifApo A/1,.7\u00ab'Aa)]\u00cdJ;j\tA.\u00edp\u00f3,, .S7\u00f3.\u00a1j\u2014 q..: \u2014 0 (5.3)\n\u2022 d\u00e9\u2019)P\u2019 representa a matriz Jacobiana, que \u00e9 formada pelas derivadas das fun\u00e7\u00f5es res\u00edduos, em rela\u00e7\u00e3o as vari\u00e1veis primarias ( po e Sw ) para todos os blocos e seus vizinhos. Para o nosso problema, que \u00e9 tridimensional e bif\u00e1sico a matriz resultante \u00e9 heptadiagonal blocada e os blocos 2x2, com a seguinte composi\u00e7\u00e3o:\n\\ \u00e0po\n/\n*\t, \u00e9 o vetor solu\u00e7\u00e3o dado por \u00bfrir\"4,1 = ;zr\u2019,'+\u20181 \u2014 ari, sendo x as vari\u00e1veis pa e Sw\ne \u00ed/ o n\u00edvel de itera\u00e7\u00e3o Newtonian a.\n5.3\tOrdena\u00e7\u00e3o da Malha e Solu\u00e7\u00e3o da Matriz\n0 acoplamento entre a regi\u00e3o do po\u00e7o ( malha cil\u00edndrica. ) e a regi\u00e3o do reservat\u00f3rio ( malha cartesiana ) ser\u00e1 resolvido de duas formas distintas; 1) de forma totalmente acoplada e 2) de forma desacoplada, como ser\u00e1 discutido a seguir:\n5.3.1\tModelo Totalmente Acoplado\nNeste caso as duas regi\u00f5es s\u00e3o resolvidas simult\u00e1neamente no mesmo sistema de equa\u00e7\u00f5es, para o esquema totalmente impl\u00edcito na press\u00e3o e na satura\u00e7\u00e3o.\nA figura 5.2 ilustra o tipo de ordena\u00e7\u00e3o da malha adotada neste trabalho.\nFigura 5.2: Ordena\u00e7\u00e3o da malha\nf dce V\t\u00ed &amp;G y+1\t( GCV\nV Jrc Jrr J\t\\ \u00f3\u00ae J\t\\ Gr )\nonde : Jcc \u00e9 a submatriz de derivadas parciais das fun\u00e7\u00f5es de res\u00edduos do sistema cartesiano com rela\u00e7\u00e3o \u00e0s vari\u00e1veis prim\u00e1rias do mesmo sistema;\nJrT \u00e9 a submatriz de derivadas parciais das fun\u00e7\u00f5es de res\u00edduos do sistema cil\u00edndrico com rela\u00e7\u00e3o \u00e0s vari\u00e1veis prim\u00e1rias do mesmo sistema;\nJcr \u00e9 a submatriz de derivadas parciais das fun\u00e7\u00f5es de res\u00edduos do sistema cartesiano com rela\u00e7\u00e3o \u00e0s vari\u00e1veis prim\u00e1rias do sistema cil\u00edndrico;\nJrc \u00e9 a submatriz de derivadas parciais das fun\u00e7\u00f5es de res\u00edduos do sistema cil\u00edndrico com rela\u00e7\u00e3o \u00e0s vari\u00e1veis prim\u00e1rias sistema cartesiano;\n\u00eaxc \u00e9 o vetor solu\u00e7\u00e3o para o sistema cartesiano;\n\u00f2xT \u00e9 o vetor solu\u00e7\u00e3o para o sistema cil\u00edndrico;\nG\u2019c \u00e9 o vetor de termo independente para o sistema cartesiano;\nGt \u00e9 o vetor de termo independente para o sistema cil\u00edndrico.\nAs submatrizes e Jrc correspondem aos elementos de interfaces e a dist\u00e2ncia destes elementos \u00e0 parte central da matriz depende da ordena\u00e7\u00e3o da malha. A figura 5.3 ilustra a matriz Jacobiana completa para uma malha com as seguintes caracter\u00edsticas: cartesiana com 3x3x4, com um total de 34 blocos e uma cil\u00edndrica de 2x4x2, com um total de 16 blocos, conforme a figura 5.2.\nNesta matriz e nas seguintes as letras (de A at\u00e9 G), representam blocos e tem o seguinte significado:\nAB D\tF\t\t\t\t\t\t\nCAB D\tF\t\t\t\t\t\t\nCAB D\tF\t\t\t\t\t\t\nCA\tD\tp\t\t\t\t\t\t\nE\tAB D\t\tF\t\t\t\t\t\nE CAB D\t\t\t\t\t\t\tF\nE CAE D\t\t\t\t\t\t\tF\nE CA\tD\t\tF\t\t\t\t\t\nE\tAB\t\tF\t\t\t\t\t\nE CAB\t\tF\t\t\t\t\t\nE CAB\t\tF\t\t\t\t\t\nE CA\t\tF\t\t\t\t\t\nG\tAB\tD\tF\t\t\t\t\nG\tCAB\t\tF\t\t\t\tD\nG\tCAS\t\tF\t\t\t\tD\nG\tCA\tD\tF\t\t\t\t\nG\tE\tA D\t\tF\t\t\tB B B B\nG\tE\tA\tD\t\tF\t\t\tC c C C\nG\t\tE AB\t\t\tF\t\t\nG\t\tCAE\t\t\tF\t\tG\nG\t\tCAB\t\t\tF\t\tG\nG\t\tE\tCA\t\t\tF\t\t\n\tG\t\tAS\tD\t\t\t\n\tG\t\tCAB\tD\t\t\t\n\tG\t\tCAB\tD\t\t\t\n\tG\t\tCA\tD\t\t\t\n\t\tG\tE\tAB\tD\t\t\n\t\t\tr E.\tCAB\tD\t\tG\n\t\t\tE\tCAB\tD\t\tG\n\t\tG\tE\tCA\tD\t\t\n\t\tG\t\tE\tAS\t\t\n\t\tG\t\tE\tCAB\t\t\n\t\tG\t\tE\tCAB\t\t\n\t\t,...G\t\t\tE\tCA\t\t\n\t\t\t\t\t\tABD\tE\tF\n\t\t\t\t\t\tCA D\tE\tF\n\t\t\t\t\t\tE ABD\tF\n\t\t\t\t\t\tECA D\tF\n\t\t\t\t\t\tE ABD\tF\n\t\t\t\t\t\tECA D\tF\n\t\t\t\t\t\t&amp;\tE fiE\tF\n\t\t\t\t\t\tD\tECA\tF\n\t\tC\t\tF\t\tG\tABD\tE\n\t\tE\t\tF\t\tG\tCfi D\tE\n\t\tC F\t\t\t\tG\tE ABD\n\t\tB\tF\t\t\t\tG\tECA D\nF\t\tC\t\t\t\tG\tE ABD\nF\t\tB\t\t\t\tG\tECA D\n\tF\tC\t\t\t\tG\tD\tE fiB\n\tF\tB\t\t\t|\tG\tD\tECA\n\t\t\t\t\t\t\t\nFigura 5.3: Matriz Jacobiana do sistema totalmente acoplado\n/ -SFi^ SF,\u201e \\\n^Pf\u00edjjk ^^wijk dFo tdFr,\nX ^Poijk \u00d3Fwijk /\n\u2022\tB =\tHem, em\trela\u00e7\u00e3o\taos\tblocos\ti, j, k + 1;\n\u2022\tC \u2014\tHem, em\trela\u00e7\u00e3o\taos\tblocos\ti, j, k \u2014 1;\n\u2022\tD = Hem, em rela\u00e7\u00e3o aos blocos i,j + 1, k',\n*\tE ~ Idem, em rela\u00e7\u00e3o aos blocos i,j \u2014 1, k;\n*\tF =\tHem, em\trela\u00e7\u00e3o\taos\tblocos\ti + 1, j, k;\n\u2666\tG =\tHem, em\trela\u00e7\u00e3o\taos\tblocos\ti \u2014 1, j, k.\n5.3,2\tModelo Desacoplado\nPor este m\u00e9todo as duas regi\u00f5es s\u00e3o resolvidas separadamente, ou seja, \u00e9 gerada uma matriz heptadiagonal para a malha cartesiana e outra para a malha cil\u00edndrica.\n0 sistema de ordena\u00e7\u00e3o \u00e9 o mesmo adotado anteriormente ( figura 5.2 ) que resultar\u00e1 em matrizes heptadiagonais com blocos 2x2, tanto para a regi\u00e3o do po\u00e7o ( malha cil\u00edndrica ) quanto para a regi\u00e3o do reservat\u00f3rio ( malha cartesiana ), conforme pode ser visto respectivamente nas figuras 5.4 e 5.5. Deve ser observado que as matrizes geradas tem as bandas bem definidas, para as quais existern m\u00e9todos eficientes de solu\u00e7\u00e3o.\n0 acoplamento entre as duas regi\u00f5es \u00e9 feito atrav\u00e9s da transfer\u00eancia de massa de uma malha para outra, no qual o balan\u00e7o de massa deve ser respeitado. Esta transfer\u00eancia pode ser feita atrav\u00e9s de dois processos, cujos fluxogramas s\u00e3o apresentados na figura 5.6. No primeiro, os termos de fluxos s\u00e3o transferidos de uma malha para a outra num timestep. J\u00e1 no segundo, esta transfer\u00eancia \u00e9 feita dentro de uma itera\u00e7\u00e3o Newtonian a.\nEsta transfer\u00eancia \u00e9 representada na figura 5.7, onde os termos qm, s\u00e3o os termos de fluxo das faces dos blocos cartesianos, e s\u00e3o calculados numa itera\u00e7\u00e3o ou num time\nFigura 5.4: Matriz Jacobiana referente a malha cartesiana\nE F\nE\nABD\nCft D\nE ABD\nECA D\nE ABD\nECA D E AB ECA\nD\nD\nG\nG G\nG\nG\nZ-\u20191 *\u00bf3\nF\nF\nF\nF\nF\nF\nE\nE\nABD ca d\nE ABD\nECA D\nE ABD\nECA D\nE fiB\nECA\nG\nF\nD\nG D\nFigura 5.5: Matriz Jacobiana referente a malha cil\u00edndrica\na ) Acoplamiento no time siep\nGD\nb ) Acoplamiento na iterar\u00e1\u00bb\nFigura 5.6: Fluxogramas para os m\u00e9todos desacoplados\nQuando a malha cil\u00edndrica for mais refinada que a cartesiana, \u00e9 feita a pondera\u00e7\u00e3o dos termos de fluxo. Pela figura 5.6, nota-se que o fluxo que sai (entra) num bloco cartesiano deve ser igual ao somat\u00f3rio dos fluxos que entra (sai) de cada bloco cil\u00edndrico, ou seja:\nFigura 5.7: Representa\u00e7\u00e3o dos termos de fluxo\nn\nj=i\n(5.4)\n0 fluxo para cada bloco cil\u00edndrico tamb\u00e9m pode ser calculado pela lei de Darcy:\n- t A\nQlj \u2014 ^\u00a1jA\u00c1 )jront\n(5-5)\nonde, A,-j =\tser\u00e1 calculada no bloco a montante, Aj \u00e9 a \u00e1rea de interface,\na varia\u00e7\u00e3o do potencial entre um bloco cartesiano e um bloco cil\u00edndrico e d a proje\u00e7\u00e3o vertical ou horizontal da dist\u00e2ncia entre os pontos nodais.\nDividindo a equa\u00e7\u00e3o 5.5 pela 5.4, obtem-se:\n(5.6)\nfM I front\n(5-7)\n5.4\tSolu\u00e7\u00e3o do Sistema Linear de Equa\u00e7\u00f5es\nPara a solu\u00e7\u00e3o do sistema matricial podem ser usados m\u00e9todos diretos ou iterativos. Para casos em que n\u00e3o se exija uma malha muito refinada, \u00e9 perfeitamente vi\u00e1vel a utiliza\u00e7\u00e3o do m\u00e9todo direto por elimina\u00e7\u00e3o de Gauss. J\u00e1 para casos mais complexos em que deve haver um grande refinamento da malha \u00e9 recomend\u00e1vel a utiliza\u00e7\u00e3o de m\u00e9todos iterativos.\nNeste trabalho resolveremos o sistema pelo m\u00e9todo direto, com o uso de um\nalgoritmo com otimiza\u00e7\u00e3o do processo de elimina\u00e7\u00e3o de Gauss ( com o algoritmo para matrizes esparsas, NSPIV34 ) e tamb\u00e9m pelo m\u00e9todo iterativo BSOR (Aziz e Settari \u00ed30)). Este \u00faltimo pode ser representado da seguinte forma:\nse refere a regi\u00e3o do po\u00e7o, e Jrc se referem \u00e0s interfaces entre as duas regi\u00f5es. xc e a'r s\u00e3o os vetores de inc\u00f3gnitas, Gc e Gr s\u00e3o os termos independentes.\nA partir de um valor inicial para x.~ e xr resolve-se, num primeiro passo, o sistema para a inc\u00f3gnita xr'.\n~ wx* + (1 \u2014 w)x\u2122\no segundo passo \u00e9 usar xm+1, determinado no passo anterior e resolver o sistema\npara xc, com a seguir:\n5.5\tCondi\u00e7\u00f5es de Produ\u00e7\u00e3o\nTanto para o modelo totalmente acoplado, quanto para os desacoplados, a condi\u00e7\u00e3o de produ\u00e7\u00e3o poder ser pela especifica\u00e7\u00e3o da vaz\u00e3o de produ\u00e7\u00e3o ou da press\u00e3o de fluxo de fundo.\n1,\tVaz\u00e3o Especificada\nQuando a vaz\u00e3o for especificada ( vaz\u00e3o constante ), a press\u00e3o de fluxo de fundo em cada itera\u00e7\u00e3o \u00e9 calculada usando as propriedades de rocha e fluidos, da itera\u00e7\u00e3o anterior. 0 c\u00e1lculo da press\u00e3o de fluxo de fundo, \u00e9 feito com base nas propriedades de um bloco cil\u00edndrico que se comunica, com o po\u00e7o. Devido \u00e0s dimens\u00f5es reduzidas destes blocos e o fato do po\u00e7o ter condutividade infinita, este procedimento mostrou-se perfeitamente aceit\u00e1vel, pois testes para o c\u00e1lculo de pwf com todos os blocos comunicante com o po\u00e7o, deram resultados praticamente iguais. Assim, usando o primeiro bloco teremos:\npwy \u2014\t7\u00ed>l/2,\ncri k\n(5.8)\nNesta equa\u00e7\u00e3o o sub\u00edndice\tsignifica que a propriedade \u00e9 tomada no ponto\nnodal e (1/2, j, k) na face do po\u00e7o. Qoltj\u00bf \u00e9 a vaz\u00e3o do bloco (1, j, k), que \u00e9 a vaz\u00e3o total especificada ponderada de acordo com as transmissibilidades das faces produtoras, ou seja, para um determinado j e k:\n\n\n\n(5.9)\n1\nA transnaissibilidade na face do po\u00e7o \u00e9 dada por:\nrT'\t__ 17 I?\t\u2122T(A,},k\n10X']/2,j1fc \u201d 7 rsl/2,j,\u00ed:'\tn\nf\u00ed\u00f51/2,j>kJ:^/2j,k\n(5.10)\ne o fator de forma na face do po\u00e7o \u00e9 dado por:\n/2,j,k ~~\n\u00bfXOj&amp;Dk\ni lnri>\u00ed\u2019k kl,},k\n(5.11)\n2. Press\u00e3o de Fluxo de Fundo Especificada\nQuando a press\u00e3o \u00e9 especificada, a vaz\u00e3o \u00e9 determinada pelo somat\u00f3rio das vaz\u00f5es de cada bloco em comunica\u00e7\u00e3o com o po\u00e7o:\nnz\n= EE Qoi,i\u00bf \u00ed=ifc=i\n(5.12)\nonde:\nQ^lJ,k \u2014 r^'oxlj1klpol,3\u00a1k PWJ 'Yol/2,j,k(Dph\n\u00e9 a vaz\u00e3o de \u00f3leo de cada bloco cil\u00edndrico em comunica\u00e7\u00e3o com o po\u00e7o. Na equa\u00e7\u00e3o 5.12 ny e nz s\u00e3o o n\u00famero de blocos da malha cil\u00edndrica nas dire\u00e7\u00e3o y e z, respectivamente.\n3. Vaz\u00e3o de G\u00e1s e Agua\nEm todos os casos simulados a press\u00e3o em qualquer bloco sempre estar\u00e1 acima da press\u00e3o de satura\u00e7\u00e3o, assim a vaz\u00e3o de g\u00e1s ser\u00e1 dada por:\nny m\nny nz\nQs \u2014 EL\n&amp;=1\n(5-14)\nA vaz\u00e3o de \u00e1gua ser\u00e1 obtida atrav\u00e9s das razoes de mobilidades:\nny ni\nQw^\nnj/ \u00ab5\t\\\n>1 fc=l\nas mobilidades do \u00f3leo e da \u00e1gua s\u00e3o definidas como:\n1\t__ \"'rol,j,fc\n\u201co\n(5.16)\n(5.17)\nEste procedimento para o c\u00e1lculo das condi\u00e7\u00f5es de produ\u00e7\u00e3o \u00e9 usado tanto para o modelo totalmente acoplado como para os modelos desacoplados, isto proporciona a vantagem da n\u00e3o utiliza\u00e7\u00e3o de modelos de po\u00e7o.\n5.6\tDerivadas\nConforme visto anteriormente, a solu\u00e7\u00e3o do sistema com a aplica\u00e7\u00e3o do m\u00e9todo de Newton Raphson, exige a determina\u00e7\u00e3o das derivadas das fun\u00e7\u00f5es de res\u00edduos do \u00f3leo e da \u00e1gua em rela\u00e7\u00e3o as vari\u00e1veis prim\u00e1rias para todos os blocos e seus vizinhos. As derivadas das fun\u00e7\u00f5es de res\u00edduos - termos de fluxo e termos de acumula\u00e7\u00e3o - dos termos fontes e todas as hip\u00f3teses consideradas para sua determina\u00e7\u00e3o sao apresentadas no anexo A.\n5.7\tControle Autom\u00e1tico do Tempo\n0 tamanho do time step deve ser selecionado de forma adequada a garantir a estabilidade da solu\u00e7\u00e3o e erros de truncamentos aceit\u00e1veis, ( Aziz e Settarb30) ). Esta sele\u00e7\u00e3o pode ser feita com base na compara\u00e7\u00e3o entre as m\u00e1ximas varia\u00e7\u00f5es da press\u00e3o e da satura\u00e7\u00e3o ocorridas num bloco, com valores limites pr\u00e9-estabelecidos, de press\u00e3o ( DPLIM) e satura\u00e7\u00e3o ( DSL\u00cdM), que s\u00e3o fornecidos como dados de entrada.\nNo programa s\u00e3o calculadas as varia\u00e7\u00f5es m\u00e1ximas para os blocos, que podem\nser representadas por:\nDSMAXn max{XtS^k}\nDPMAXn = m^fA^}\n(5.18)\n(5.19)\nCaso DSMAX e/ ou DPMAX excedam os valores limites, um novo valor para Atn+\u00cd ser\u00e1 calculado, conforme:\nA\u00eds = At\"\nDSLIM\nDSMAX'1\n(5.20)\nou\n\nA n DPL1M\nA\u00ed\u201d------\nDPMAXn\n(5.21)\nAssim o tamanho do novo time step ser\u00e1:\nAtn+1 = min{ AC, A\u00edp}\t(5.22)\nQuando as varia\u00e7\u00f5es de press\u00e3o e satura\u00e7\u00e3o est\u00e3o dentro dos limites estabelecidos, o controle do time step \u00e9 feito pelo n\u00famero de itera\u00e7\u00f5es Newtonianas. Assim estabelece-se um n\u00famero m\u00ednimo ( ITMIN) e um n\u00famero m\u00e1ximo ( ITMAX) de itera\u00e7\u00f5es. O novo time step ser\u00e1 estabelecido da seguinte forma:\nn\u00famero de itera\u00e7\u00f5es &lt;ITMIN -+ A\u00edn+1 = 1.5A\u00ed\u201d\nITMIN &lt;n\u00famero de itera\u00e7\u00f5es &lt;ITMAX \u2014* Atn+1 \u2014 Xtn\nn\u00famero de itera\u00e7\u00f5es > ITMAX \u2014+ Atn+1 = 0.5A\u00ed71\n6\tVALIDA\u00c7AO DO MODELO\nA valida\u00e7\u00e3o foi feita atrav\u00e9s da compara\u00e7\u00e3o dos resultados obtidos dos modelos desenvolvidos com as solu\u00e7\u00f5es anal\u00edticas desenvolvidas por Odeh e Babu \u00edl3) para o drawdown em um po\u00e7o horizontal com fluxo de uma fase.\n6.1\tSolu\u00e7\u00e3o Anal\u00edtica\nAs an\u00e1lises para a descri\u00e7\u00e3o do comportamento do fluxo monof\u00e1sico, apresentadas por alguns pesquisadores \u00ed11-17), mostram que para um po\u00e7o horizontal podem acorrer at\u00e9 quatro regimes de fluxo transientes distintos, que tem sua exist\u00eancia e dura\u00e7\u00e3o como fun\u00e7\u00e3o das caracter\u00edsticas do reservat\u00f3rio - dimens\u00f5es e forma - caracter\u00edsticas da rocha, fluido e do po\u00e7o horizontal - raio, comprimento e localiza\u00e7\u00e3o dentro do reservat\u00f3rio.\nAs solu\u00e7\u00f5es anal\u00edticas usadas para a valida\u00e7\u00e3o, consideram o fluxo de um fluido levemente compress\u00edvel e sem considerar o efeito gravitacional. Assume um po\u00e7o horizontal com condutividade infinita, raio rw e comprimento L, perfurado paralelamente a uma das faces de um reservat\u00f3rio fechado. As dimens\u00f5es do reservat\u00f3rio s\u00e3o, espessura; h, comprimento ( dire\u00e7\u00e3o x ); a, largura ( dire\u00e7\u00e3o y, paralela ao po\u00e7o ); b. O po\u00e7o horizontal com coordenadas do in\u00edcio e fim definidos respectivamente por (a-\u2019o>yi!^o) e (j:q, y?, \u00bfo)-O modelo f\u00edsico e os par\u00e2metros usados nas f\u00f3rmulas anal\u00edticas est\u00e3o representados na figura 6.1.\nConforme mencionado anteriormente, o transiente completo para um po\u00e7o horizontal apresenta quatro regimes distintos: 1) Radial inicial, 2) Linear inicial, 3) Pseudo radial tardio e 4) Linear tardio. A representa\u00e7\u00e3o esquem\u00e1tica das linhas de fluxo em cada regime s\u00e3o apresentadas na figura 6.2.\nAs equa\u00e7\u00f5es que regem o comportamento da press\u00e3o do fluxo monof\u00e1sico para produ\u00e7\u00e3o com vaz\u00e3o constante, e os tempos de inicio e fim para os quatros regimes de fluxos , s\u00e3o apresentados a seguir:\n1.\tRegime Radial Inicial\nFigura 6.1: Representa\u00e7\u00e3o do modelo f\u00edsico\nF\u00edgura 6.2: Representa\u00e7\u00e3o das linhas de fluxo dos regimes do transiente\n4D\nt.nd = 0.4744^^ \u00a1kz\n(6.1)\nou\nl.,j. =&lt;\u00a1.03'\u00bfQL2i/>iic\u00ed/ky\n(6-2)\nDevido \u00e0 curta dura\u00e7\u00e3o, este per\u00edodo pode ser mascarado pelos efeitos decorrentes do in\u00edcio do primeiro fluxo. Em adi\u00e7\u00e3o , a n\u00e3o considera\u00e7\u00e3o do efeito gravitacional pode distorcer os resultados.\nO comportamento da press\u00e3o \u00e9 dado por:\n\nPuf = pi~\n0.1833gpB\n+ 0.3492 +0.87^)\n(6-3)\nPara este regime um gr\u00e1fico semi-log de [(p; \u2014 pwj) = Ap] vs i dar\u00e1 uma linha reta com inclina\u00e7\u00e3o m, dada por:\n.\t. 0.1833gpB\n(6.4)\n2.\tRegime Linear Inicial\nEste regime ocorre no per\u00edodo em que o transiente de press\u00e3o \u00e9 influenciado somente pelos limites inferior e superior do reservat\u00f3rio, e ocorrer\u00e1 se o comprimento do po\u00e7o for significativamente maior que a espessura do reservat\u00f3rio, e se a contribui\u00e7\u00e3o do fluxo nas pontas do po\u00e7o for desprezada. A dura\u00e7\u00e3o deste per\u00edodo \u00e9 dada aproximadamente por:\nO comportamento da press\u00e3o \u00e9 dado por:\n(6.7)\nPara este regime um gr\u00e1fico de (p\u00bf \u2014 pTO/) vs \\A dar\u00e1 uma linha reta com inclina\u00e7\u00e3o m, dada por:\n\u25a0\\Z^fictkxLh\n(6.8)\n3. Regime Pseudo Radial Tardio\nSe a espessura do reservat\u00f3rio nao for suficientemente grande quando comparada com a largura, este regime pode n\u00e3o ocorrer. Tamb\u00e9m \u00e9 necess\u00e1rio que raz\u00e3o de penetra\u00e7\u00e3o, definida por L/\u00e8, seja menor que 0.45. O in\u00edcio deste per\u00edodo ocorre\npara:\ntatart ~ Q.39W)L?$\u00a1lCt/kv\n(6.9)\ne o final para o menor valor abaixo:\nt^d - 0.5271\t+ L/4)2/k9\n(6.10)\nou\ntend =\n(6.11)\n0 comportamento da press\u00e3o \u00e9 dado por:\nt\ti Rir7-.\n+0,25/71\u201c - Insen\u2014- 1.838 + 5O)]\nKz\t11\n(6.12)\nPara este regime um gr\u00e1fico semi-log de - pw\u00ed) vs i, \u00e9 uma linha reta com inclina\u00e7\u00e3o m, dada por:\n0.1833\u00e7pB\n(6.13)\n4. Regime Linear Tardio\nEste per\u00edodo ocorre ap\u00f3s o transiente de press\u00e3o ter atingido os limites do reservat\u00f3rio nas dire\u00e7\u00f5es y e z e o comportamento nestas dire\u00e7\u00f5es se tornar\u00e1 do tipo pseudo permanente. E an\u00e1logo ao fluxo linear que ocorre para uma fratura vertical, com uma queda de press\u00e3o adicional resultante da penetra\u00e7\u00e3o parcial nas dire\u00e7\u00f5es y e z, Se o reservat\u00f3rio for infinito este per\u00edodo poder\u00e1 n\u00e3o ocorrer. O in\u00edcio deste per\u00edodo \u00e9 dado pelo menor valor aba\u00edxo:\ni3tart = 1.2&amp;5Q^pct(Dv + L/4)2/^\n(6.14)\nIstart = 0.4744\u00a3>^/xcf/^\n(6.15)\no final \u00e9 dado por:\nfend 0.4348^/\u00edC\u00edd')./tI\n(6.16)\nh\nO comportamento da press\u00e3o \u00e9 dado por:\nPluf\nPi -\n0.5646^.0\nbh\n[Vt^pCikx +\n0.2803\u00c0\n(Zn\u2014 _p 0,25/u\" + A\tC\n, 180\u00b0^o\n\u2014brisen\u2014j----- 1,838 -f- so)]\nPara este regime um gr\u00e1fico (p\u00bf \u2014 pwj) vs y/t \u00e9 uma linha reta com inclina\u00e7\u00e3o m. dada por:\n0.5646gpB yf (^pCtJCgbh\nEm seu artigo Odeh e Babu observam que a ocorr\u00eancia dos quatro regimes de fiuxo podem n\u00e3o ser garantida. Assim, devemos nos preocupar em que a dura\u00e7\u00e3o de um regime particular seja suficientemente longa para que as an\u00e1lises possam ser conclusivas, A permeabilidade, volume drenado, forma do reservat\u00f3rio, o comprimento e a localiza\u00e7\u00e3o do po\u00e7o, afetam em diferentes graus a dura\u00e7\u00e3o de cada per\u00edodo de fluxo. Podem ocorrer situa\u00e7\u00f5es em que nao ocorram nenhum dos quatro regimes de fiuxo transiente.\n6.2\tSimula\u00e7\u00e3o dos Testes\nPara demonstrar a validade do modelo desenvolvido, foi feito primeiramente, a compara\u00e7\u00e3o entre os resultados anal\u00edticos e num\u00e9ricos para o comportamento da press\u00e3o no drawdown para o caso de um po\u00e7o horizontal totalmente penetrante. Posteriormente, foi feita a determina\u00e7\u00e3o da permeabilidade, individualmente para cada per\u00edodo do regime transiente e compara\u00e7\u00e3o com os valores usados na simula\u00e7\u00e3o.\nOs princip\u00e1is par\u00e1metros utilizados em todos os casos simulados foram os mesmos apresentados por Odeh e Babu<13) e s\u00e3o apresentados na tabela 6.1.\n6.2.1\tComportamento da Press\u00e3o no Drawdown\nConforme mencionado anteriormente, foi escolhida uma situa\u00e7\u00e3o para a compara\u00e7\u00e3o do comportamento da press\u00e3o obtidos num\u00e9rica e anal\u00edticamente. Esta situa\u00e7\u00e3o\nPar\u00e2metro\tValor\nVaz\u00e3o (wPstd/d)\t127.2\nViscosidade (Pa.s)\t1.0 x 10~3\nFator volume de forma\u00e7\u00e3o (m3res/m3std)\t1.25\nRaio do po\u00e7o (m)\t0.08\nPososidade (fr)\t0.20\nCompressibilidade total (Pa~])\t2.18 x 10~9\nSkin\t0.0\nPermeabilidade absoluta (m2)\t4.94 x 10~14\nTabela 6.1: Par\u00e2metros usados na valida\u00e7\u00e3o\n\u00e9 a simula\u00e7\u00e3o da produ\u00e7\u00e3o de um reservat\u00f3rio produzindo atrav\u00e9s de um po\u00e7o totalmente penetrante e cujo objetivo \u00e9 verificar os resultados num\u00e9ricos sujeitos \u00e0 influ\u00eancia da mudan\u00e7a da forma de simula\u00e7\u00e3o do fluxo na dire\u00e7\u00e3o a', ou seja, em dire\u00e7\u00e3o ao po\u00e7o, a representa\u00e7\u00e3o do fluxo passa de linear para radial.\nAs caracter\u00edsticas do reservat\u00f3rio, malha utilizada e os per\u00edodos de ocorr\u00eancia de cada regime s\u00e3o apresentados nas tabelas 6.2 e 6.3. E a compara\u00e7\u00e3o entre a solu\u00e7\u00e3o anal\u00edtica com os resultados obtidos pelo modelo num\u00e9rico \u00e9 mostrada na figura 6.3.\nDa an\u00e1lise deste gr\u00e1fico, conclui-se que \u00e9 boa a concord\u00e2ncia entre os resultados. Havendo um pequeno desvio entre as curvas logo no inicio, que \u00e9 devido aos efeitos iniciais da entrada em produ\u00e7\u00e3o e a n\u00e3o considera\u00e7\u00e3o do efeito gravitacional nas f\u00f3rmulas anal\u00edticas, e outro desvio ap\u00f3s o t\u00e9rmino do regime radial inicial - similar a um pseudo skiii - que \u00e9 causado pela diferen\u00e7a entre os volumes dos blocos da interface da malha cilindrica com a cartesiana. Este ultimo efeito pode ser reduzido com uma discretiza\u00e7ao mais refinada e com varia\u00e7\u00e3o mais suave entre os volumes dos blocos externos da malha cil\u00edndrica e os blocos cont\u00edguos da malha cartesiana. Devido as limita\u00e7\u00f5es de computador, isto nao foi poss\u00edvel neste trabalho.\nFigura 6.3: Compara\u00e7\u00e3o entre a solu\u00e7\u00e3o anal\u00edtica e a num\u00e9rica\nCaracter\u00edsticas\t\nComprimento do reservat\u00f3rio (m)\t1050.0\nLargura do reservat\u00f3rio (m)\t500.0\nEspessura do reservat\u00f3rio (m)\t50.0\nComprimento do po\u00e7o (m)\t500.0\nMalha cartesiana\t\nN\u00famero de blocos na dire\u00e7\u00e3o x\t21\nN\u00famero de blocos na dire\u00e7\u00e3o y\t1\nN\u00famero de blocos na dire\u00e7\u00e3o z\t1\nMalha cil\u00edndrica\t\nN\u00famero de blocos na dire\u00e7\u00e3o r\t20\nN\u00famero de blocos na dire\u00e7\u00e3o 0\t4\nN\u00famero de blocos na dire\u00e7\u00e3o z\t1\nTabela 6.2: Caracter\u00edsticas do reservat\u00f3rio e malha\nRegimes\ttempo (hr)\t\n\tin\u00edcio\tfim\nRadial inicial\t\u2014~\t0.73\nLinear inicial\t0.73\t25.82\nPseudo radial tardio\t\u2014\t\u2014\nLinear tardio\t48.41\t293.5\nTabela 6.3; Dura\u00e7\u00e3o, em horas, dos regimes transiente.\n6.2.2\tDetermina\u00e7\u00e3o da Permeabilidade\nPara a determina\u00e7\u00e3o da permeabilidade atrav\u00e9s dos resultados num\u00e9ricos, e posterior compara\u00e7\u00e3o com os utilizados na simula\u00e7\u00e3o, foram escolhidos reservat\u00f3rio com dimens\u00f5es particulares, nas quais os diversos regimes de fluxo transiente tenham dura\u00e7\u00e3o suficiente para as an\u00e1lises individuais.\n1.\tRegime Radial Inicial\nOs principais par\u00e2metros usados para o regime radial inicial foram:\nQ \u2014 50 m3sid/ d\nkz = ky =\t9.869 x 10\u201d15m2 ( 10 md)\na = 550 m\nb = 500 m\nh ~ 50 m\nL ~ 500 m\n<4 = 250 m dz \u2014 25 m\nA malha usada foi: cartesiana; llxlxl e a. cil\u00edndrica; 10x4x1. Para o reservat\u00f3rio com as dimens\u00f5es acima, segundo a equa\u00e7\u00e3o 6.1 ou a 6.2 o final do regime radial inicial ocorrer\u00e1 para ien{\u00a1 \u2014 3.63/ir. O gr\u00e1fico de Apw/ vs logt \u00e9 mostrado na figura 6.4, do qual obtem-se uma reta com inclina\u00e7\u00e3o de m = 26.88/1 Pa/ciclo, e atrav\u00e9s da equa\u00e7\u00e3o 6.4, obtem-se a permeabilidade de 9.849 x 10\u201c15 m2 (9.98 md).\n2.\tRegime Linear Inicial\nPara o regime linear inicial n\u00e3o foi feita a determina\u00e7\u00e3o da permeabilidade, pois a dura\u00e7\u00e3o deste regime \u00e9 muito pequena e ocorre para situa\u00e7\u00f5es muito particulares.\n3.\tRegime Pseudo Radial Tardio\nPara a valida\u00e7\u00e3o do regimes pseudo radial tardio, foi encontrada certa dificuldades, pois o simulador desenvolvido faz o uso intensivo de matrizes de quatro dimens\u00f5es ( tr\u00eas dimens\u00f5es para as tr\u00eas dire\u00e7\u00f5es, e uma para cada reservat\u00f3rio; cil\u00edndrico e cartesiano ), isto exige grande capacidade de mem\u00f3ria de computador e como estamos trabalhando com micro computador ficamos limitados ao refinamento ( n\u00famero de blocos ) da malha. O maior refinamento areal da malha conseguido foi de 7x7x1 para o cartesiano e para o cil\u00edndrico. Para se conseguir um tempo suficientemente longo para as an\u00e1lises do regime em quest\u00e3o \u00e9 necess\u00e1rio uma malha mais refinada nas dire\u00e7\u00f5es x e y.\nMesmo limitado ao pequeno n\u00famero de blocos, fizemos dois testes, que mesmo n\u00e3o dando uma grande dura\u00e7\u00e3o para o regime pseudo radial tardio, mostra que os resultados do modelo s\u00e3o coerentes com as dedu\u00e7\u00f5es anal\u00edticas.\nOs principais par\u00e2metros usados foram:\nQ = 50 msstd/ d\na = 350 m\nb = 350 m\nh \u2014 50 m\nDx ~ Dy = 75 m\nDz = 25 m\nFoi feita a simula\u00e7\u00e3o com o uso de dois valores de permeabilidade:\n9.8690 x 10\"\u00ed5 m2 ( 10 md ) e 1.9738 x IO\"1\u20191 m2 ( 20 md ).\nPara estas condi\u00e7\u00f5es, o regime pseudo radial tardio tem a seguinte dura\u00e7\u00e3o: tatari = 11.94 hr e tend = 163.00 hr. Os gr\u00e1ficos de Ap vs logt, para as permeabilidades de 9.8690 x 10~ls m2 ( 10 md ) e 1.9738 x 10~14 m2 ( 20 md ), s\u00e3o apresentados respectivamente, nas figuras 6.5 e 6.6. Nestes gr\u00e1ficos notamos que, apesar do regime n\u00e3o ter longa dura\u00e7\u00e3o, se tomarmos a inclina\u00e7\u00e3o da reta logo ap\u00f3s o t\u00e9rmino do regime radial inicial ( visto que neste caso nao h\u00e1 ocorr\u00eancia do regime linear inicial ), ser\u00e3o obtidas as seguintes inclina\u00e7\u00f5es: m \u2014 25Q.QK Pa/ciclo em ~ 125 Kpa/ciclo. Usando estes valores na equa\u00e7\u00e3o 6.13 obtem-se aproximadamente permeabilidades de 9.8690 X 10\u201c15m2(10md) e 1.9738 x 10~1,sm2(20md).\n4.\tRegime Linear Tardio\nPara o regime linear tardio os par\u00e2metros usados foram:\nQ \u2014 50 m3std/d\nkx \u2014 ky = kz = 9.869 x 10\"15m2(10md)\na \u2014 1350 m\nb ~ 500 m\nh, \u2014 50 m\nL ~ \u00d5QQ m\nNa figura 6.7, \u00e9 representado o gr\u00e1fico de A/3 vs y/t, da qual obtem-se uma reta com inclina\u00e7\u00e3o m \u2014 l\u00f2SkPaJhr^2, que aplicada, a equa\u00e7\u00e3o 6.18 resulta numa permeabilidade de 9,671 x 10\u201c15m2(9.8md),\nTempo (horas)\nT\n\u25a0J d\n-i\nJe\nT\u201di\u2014|\u2014\u2014nr\n\u25a1near tmc\u00edol\n\u25a0i i\ts\u2014up\n10\no\n[ I F I \u2018 I I i I t |\n20\t30\nTempo^2 (hr1'/2)\n1 i !\n40\n50\n7\tAN\u00c1LISE DOS RESULTADOS\n0 objetivo deste capitulo \u00e9 a apresenta\u00e7\u00e3o e an\u00e1lise dos resultados da simula\u00e7\u00e3o do comportamento de um reservat\u00f3rio produzindo atrav\u00e9s de um po\u00e7o horizontal e dos m\u00e9todos usados para esta simula\u00e7\u00e3o. Esta an\u00e1lise foi feita em duas partes: na primeira, s\u00e3o apresentados os resultados do simulador totalmente acoplado, com o sistema linear de equa\u00e7\u00f5es resolvido por m\u00e9todo direto e iterativo (BSOR) e a malha cil\u00edndrica que representa a regi\u00e3o do po\u00e7o com diferentes refinamentos angular e radial. Na segunda parte foi feita a compara\u00e7\u00e3o entre os resuldados obtidos pelos modelos que usam o m\u00e9todo totalmente acoplado e os desacoplados.\nOs dados de simula\u00e7\u00e3o, condi\u00e7\u00f5es de produ\u00e7\u00e3o e as caracter\u00edsticas do reservat\u00f3rio que foram usados na simula\u00e7\u00e3o s\u00e3o apresentados na tabela 7.1. Enquanto que os dados das an\u00e1lises PVT do \u00f3leo, g\u00e1s e \u00e1gua e os dados das an\u00e1lises petrof\u00edsicas s\u00e3o apresentados no anexo B.\nVoltamos a salientar que devido ao uso de micro computador as malhas simuladas n\u00e3o tem grande refinamento, mas foram o suficiente para que as an\u00e1lises fossem conclusivas.\n7.1\tModelo Totalmente Acoplado\n7.1.1\tCompara\u00e7\u00e3o entre os M\u00e9todos de Solu\u00e7\u00e3o\nO programa computacional desenvolvido prev\u00ea a solu\u00e7\u00e3o da matriz Jacobiana por m\u00e9todo direto ou iterativo. Para efeito de investiga\u00e7\u00e3o, a solu\u00e7\u00e3o com m\u00e9todo direto foi feita de duas formas: a primeira forma foi a utiliza\u00e7\u00e3o da. elimina\u00e7\u00e3o de Gauss normal com a matriz completa - trabalhando inclusive com os elementos nulos - e a segunda \u00e9 atrav\u00e9s da utiliza\u00e7\u00e3o do algoritmo ( NSPIV34 ), tamb\u00e9m baseado na elimina\u00e7\u00e3o de Gauss, que trabalha somente com os elementos n\u00e3o nulos. Para os casos simulados pode-se fazer as seguintes observa\u00e7\u00f5es:\nPar\u00e2metros de Simula\u00e7\u00e3o\tUnidade\tValor\nToler\u00e2ncia para press\u00e3o\tPa\t3447.40\nToler\u00e2ncia para satura\u00e7\u00e3o\tfr\t0.0010\nM\u00e1xima varia\u00e7\u00e3o da satura\u00e7\u00e3o num time slep\tfr\t0.0500\nM\u00e1xima varia\u00e7\u00e3o da press\u00e3o num time step\tkPa\t689.48\nIncremento de tempo m\u00e1ximo\tdias\t10.00\nIncremento de tempo m\u00ednimo\tdias\t0.0010\nN\u00famero m\u00e1ximo de itera\u00e7\u00f5es no Jacobiano\t\t5\nN\u00famero m\u00ednimo de itera\u00e7\u00f5es no Jacobiano\t\t2\nDados de produ\u00e7\u00e3o e po\u00e7o\t\t\nVaz\u00e3o de \u00f3leo m\u00e1xima\tm3/dia\t300.00\nVaz\u00e3o de \u00f3leo m\u00ednima\tm3/dia\t15.00\nPress\u00e3o de fluxo m\u00ednima no po\u00e7o\tMPa\t30.00\nRaio do po\u00e7o\t771\t0.10\nCota do po\u00e7o\tfn\t-2560.00\nDados do reservat\u00f3rio\t\t\nSatura\u00e7\u00e3o inicial de \u00e1gua\tfr\t0.12\nCompressibilidade da rocha\tMPa\"1\t0.440 x 10\u201c3\nPress\u00e3o inicial do reservat\u00f3rio\tM'Pa\t35.00\nCota do contato \u00f3leo/\u00e1gua\tm\t-2585.00\nPermeabilidade absoluta (z,y e z)\tm2\t49.3 x 10\u201c13\nPorosidade\tfr\t0.30\nTabela 7.1: Par\u00e2metros Usados na Simula\u00e7\u00e3o\n\u2022\tTempo de execu\u00e7\u00e3o - o algoritmo otimizado trouxe uma. redu\u00e7\u00e3o m\u00e9dia de at\u00e9 60% no tempo de simula\u00e7\u00e3o, em rela\u00e7\u00e3o a elimina\u00e7\u00e3o de Gauss com a matriz completa;\n\u2022\tArea de mem\u00f3ria * A primeira vista pode-se pensar que o m\u00e9todo otimizado traria uma redu\u00e7\u00e3o de mem\u00f3ria necess\u00e1ria, mas isso nao ocorre, porque apesar de n\u00e3o necessitar de armazenar toda a matriz, o algoritmo trabalha com vetores auxiliares que s\u00e3o t\u00e3o maiores quanto for a espars\u00eddade da matriz, ou seja, a dist\u00e2ncia entre os elementos que representam as interfaces e a diagonal principal.\nO m\u00e9todo iterativo usado foi o de sobre-relaxa\u00e7\u00e3o sucessiva por blocos (BSOR),e para as situa\u00e7\u00f5es simuladas notou-se que esse m\u00e9todo \u00e9 desvantajoso, em rela\u00e7\u00e3o ao m\u00e9todo direto, quanto ao tempo de simula\u00e7\u00e3o. Para, que os resultados fossem aceit\u00e1veis, a toler\u00e2ncia usada no processo iterativo do sistema linear de equa\u00e7\u00f5es n\u00e3o p\u00f4de ser menor que 10~5.\nA vantagem desse m\u00e9todo \u00e9 em rela\u00e7\u00e3o a pequena \u00e1rea de mem\u00f3ria necess\u00e1ria., assim para problemas com grande n\u00famero de blocos passa a ser atrativo.\nPara a situa\u00e7\u00e3o de um po\u00e7o horizontal totalmente penetrante num reservat\u00f3rio de 300 x 150 x 150m, representado por uma malha cartesiana de 3 x 3 x 1 e uma malha cil\u00edndrica de 3 x 4 x 1, o fator de sobre-relaxa\u00e7\u00e3o que proporcionou um menor n\u00famero de itera\u00e7\u00f5es foi de aproximadamente 1.15, conforme pode ser visto pela figura 7.1\n7.1.2\tRefinamento Radial\nO objetivo \u00e9 verificar a influ\u00eancia do refinamento da malha cil\u00edndrica na dire\u00e7\u00e3o radial, sobre o comportamento da produ\u00e7\u00e3o em duas situa\u00e7\u00f5es: a primeira, com o po\u00e7o totalmente penetrante e a segunda com po\u00e7o parcialmente penetrante.\n\u00bb Po\u00e7o totalmente penetrante -\nNesta primeira situa\u00e7\u00e3o o refinamento radial influi somente na malha cil\u00edndrica, j\u00e1 que nao h\u00e1 mudan\u00e7a do n\u00famero de interfaces cilindro/cartesiano nas dire\u00e7\u00f5es x e y. Os resultados do comportamento da press\u00e3o de fluxo e vaz\u00e3o de \u00f3leo s\u00e3o apresem tados respectivamente nas figuras 7.2 e 7.3. Observa-se que para o comportamento da press\u00e3o para vaz\u00e3o constante, os resultados s\u00e3o iguais para os tr\u00eas refinamentos. H\u00e1 uma diferen\u00e7a entre os tempos de chegada a press\u00e3o de fluxo e a vaz\u00e3o m\u00ednima; quanto maior o refinamento mais r\u00e1pido ser\u00e3o atingido estes tempos.\nA produ\u00e7\u00e3o de \u00e1gua em todos os casos foi insignificante, e como n\u00e3o houve diferen\u00e7as para, este caso, torna-se desnecess\u00e1rio a apresenta\u00e7\u00e3o dos gr\u00e1ficos.\n* Po\u00e7o parcialmente penetrante:\nAs dimens\u00f5es do reservat\u00f3rio foram: 300 x 150 x 300m com malha cartesiana de 3 x 3 x 3 e malha cil\u00edndrica de 2,3,5 x 4 x 1.\nNesta situa\u00e7\u00e3o h\u00e1 varia\u00e7\u00e3o do n\u00famero de interfaces na dire\u00e7\u00e3o z. Quanto maior o refinamento, maior ser\u00e1 o n\u00famero de elementos de interfaces na matriz Jacobi-ana. Os resultados do comportamento do reservat\u00f3rio com a produ\u00e7\u00e3o de um po\u00e7o horizontal centrado com 100 m de comprimento, s\u00e3o apresentados nas figuras 7.4;\nversus tempo, figura 7.5; vaz\u00e3o de \u00f3leo versus tempo, figura 7.6; vaz\u00e3o de \u00e1gua versus tempo e figura 7.7; raz\u00e3o \u00e1gua/\u00f3leo versus o tempo. Pelo gr\u00e1fico de pwf vs t nota-se que h\u00e1 uma pequena diferen\u00e7a entre as press\u00f5es para os diferentes refinamentos. Nesta situa\u00e7\u00e3o, a produ\u00e7\u00e3o de \u00e1gua j\u00e1 \u00e9 significativa, sendo maior para malha com menor refinamento, conforme pode ser visto pela figura 7.6 e 7.7. Isto pode ser explicado pelo fato de que para um maior refinamento a distribui\u00e7\u00e3o da satura\u00e7\u00e3o de \u00e1gua \u00e9 mais homog\u00eanea.\n7.1.3\tRefinamento Angular\nPara este caso, foi estudado o comportamento da produ\u00e7\u00e3o de um po\u00e7o totalmente penetrante com a malha cil\u00edndrica sendo dividida em 4 e 8 partes na dire\u00e7\u00e3o angular. Quando\nNa figura 7.8 sao apresentadas as curvas de pwj vs t. Nota-se que o comportamento \u00e9 igual era todos os casos. O comportamento da vaz\u00e3o de \u00f3leo cora tempo \u00e9 apresentado na figura 7.9, na qual nota-se que h\u00e1 uma tend\u00eancia de redu\u00e7\u00e3o do tempo de produ\u00e7\u00e3o para malhas mais refinadas, quando a vaz\u00e3o de produ\u00e7\u00e3o \u00e9 vari\u00e1vel e pequena. Neste caso a produ\u00e7\u00e3o de \u00e1gua , tamb\u00e9m foi insignificante.\nDeve ser observado, que se ocorresse a produ\u00e7\u00e3o significativa de urna segunda fase, haveria diferen\u00e7as no comportamento para os diferentes refinamentos angulares, pois a distribui\u00e7\u00e3o de satura\u00e7\u00f5es nos dois casos seriam diferentes.\n7,2\tCompara\u00e7\u00e3o entre o Acoplado e os Desacoplados\nUm dos principais objetivos desse trabalho \u00e9 a compara\u00e7\u00e3o entre os resultados do simulador totalmente acoplado e os desacoplados - que fazem o acoplamento numa itera\u00e7\u00e3o ou num time step. Pelos casos simulados, podem ser feitas as seguintes observa\u00e7\u00f5es:\n\u2022\ttoler\u00e2ncia - Para os desacoplados, deve-se tomar certos cuidados com uma toler\u00e2ncia \u2019\u2019folgada\u201d no processo de converg\u00eancia do Newton-Raphson. Pois como \u00e9 um processo que usa os termos de fluxo, da itera\u00e7\u00e3o ou do time step anterior da malha cartesiana., como influxo nas fronteiras externas da malha cil\u00edndrica, pode haver problemas de balan\u00e7o de materiais nos blocos da malha cil\u00edndrica.\n\u2022\tTempo - O tempo de simula\u00e7\u00e3o \u00e9 menor para os modelos desacoplados.\n\u2022\tCapacidade de mem\u00f3ria - A grande vantagem dos modelos desacoplados \u00e9 em rela\u00e7\u00e3o \u00e0 menor \u00e1rea de mem\u00f3ria necess\u00e1ria ao processamento. S\u00e3o armazenadas somente as matrizes Jacob!anas referentes \u00e0s duas malhas - que a depender do algoritmo\nOs resultados para um reservat\u00f3rio de 250 x 250 x 600m com uma malha cartesiana 5x3x1 e malha cilindrica de 3x4x1, para um po\u00e7o totalmente penetrante, podem ser vistos \u00f1as figuras 7.10, 7.11 e 7.12. Atrav\u00e9s destes gr\u00e1ficos nota-se que no per\u00edodo em que a vaz\u00e3o de \u00f3leo \u00e9 constante, os resultados dos desacoplados coincidem e existe uma pequena diferen\u00e7a deles para o totalmente acoplado. A outra diferen\u00e7a notada, \u00e9 que quando o acoplamento \u00e9 feito num time siep h\u00e1. tendencia, de ser um pouco maior o tempo de produ\u00e7\u00e3o . quando a press\u00e3o de fundo \u00e9 constante e a vaz\u00e3o \u00e9 baixa.\nTTTTT~rn~TTTh | i i i ! 1 iTTTTTTm H \u00ed i | ! h i i'i~rrrrTT\"H i i i i ! p i i i i i^'T^-[-T\u00ed,Tn\"nn~T7TT~TT-rTT~n~\n1.00\t1.10\t1.20\t1.30\t1.40\t1.50\t1.60\t1.70\t1.80\nFator de Sobre\u2014 Reloxacao (w)\nTempo (dias)\n4 O U\ti' s' i s \u00ed i rr-t i i rrrrrTTTTrrn-r~r~o-rnn^nrrT^TT-ttt\n\n-G42-----fr\no \u00bfdo\n-\u00a3&amp;\nOD o-\n-fr-fr\n\n\nj\n\u25a1-\n<\u25a0 NXR\n-a NXR\n\n0\t20\t40\t60\t80\nTempo (d\u00edas)\n-r\"| 'i i t \u25a0 i i t i i [ [\u25a0 i t j \u25a0] r\"i TT r\n100\t120\t140\nTempo (dias)\nFigura 7.4: Refinamento radiai ( caso 2 ) - Pwf versus tempo\nTempo (dios)\nTT\"r~T~TT^-\u00ed~>l IHII\tt f 3 t I M I' r I' 1' r M i M 1 M M I M 1 I I I i M I I\nSx\u00edjSxl\n2 Q -prrr-r-rrT i i \u00a1 s n\"r~rT~T\"T t : ; s rrr-rTT i \u00a1 \u00ed \u00a1 s \u25a0, \u25a0\u25a0\u25a0r--[\u2014r-T\u2014f \u25a0 ! \u00a1 t i i 'i'i\"rr~[~rTT~i hih |H''rr~r~T~7~7~rT~\n0\t20\t40\t60\t80\t100\t120\t140\nTempo (dios)\nTempo (dias)\nTempo (dios)\nU. O -7 r~i~r Him \"rrmTi' \u25a0[ f \u25a0rrrTrrrTi' 1 > 11 1 1 s 1 1 i1 rr 1 r 1 t rr~T~T'i ; i ! r r 1-y n~n~m i 1 \u00a1 ! rr\n20\t40\t60\t80\t100\t120\t140\t160\nTempo (dios)\n7 9\t|\u2014r~[-r-T\"r-Rn im| rn-1~rr-rl-T-n h\u00edi\u00edh , \u25a0|..p-rT-rl--r-1~T-1.. r r r ; ; [ $ i i i\n0\t50\t100.\t150\t200\t250\t300\nTempo (dias)\n350 -q\u2014r\"s i i i ; i\u2014i\u2014i i i 'i\"i\u2014i i r\t\u00a1\t\u00a1\u25a0 \u25a0\u25a0\u25a0; |...-r-1--r~r-T~7--\u00ed\u25a0\u25a0 r\t,\u2014t , , F \u25a0 \u25a0 \u25a0r...r..r--lr.\n50\t100\t150\t200\t250\t300\nTempo (dias)\n1 b D . 0\t\u2014!\u2014\u00ed\u2014I\u2014!\u201c'1\u2014r-1\u2014s--!\u2014I\u2014I\u2014)\u2014!\u2014\u00ed\u2014I\u2014I\u2014!\u2014I\u2014[\u2014I\u20141\u2014i\u2014I \u25a0 1 \u25a0 V\u2014r \u25a0 1 \u25a0 ! '\"T~T~1 ' I ' 1 ' \u25a0i~T~T~l\u2014I\u2014I\u20141\u20141\u20141\u2014r-r~r~r^T~r*T\n\u25a0 3\n2\n1\nPoco no bioco 1\nTempo (dias)\n3 D\ti r\u2014i\u2014i\u2014r-T\"T\u201d~T i~~i ! \u00a1 i i rm\u2014i r~'r i ' i i i f r r-1 i\u2014i\u2014i\u2014i\u2014\u00ed\u2014;\u2014\u00ed\u2014i\u2014i\u2014i\u2014i\u2014r\nt~t~t i i i vttvi i i ! ! \u25a0 tt~r~'rr i [ ! i i\u25a0 \u25a0 i\u2014i\u2014i\u2014t\u2014t~t~ 40\t60\t80\t100\nTempo (dias)\nf-\u00ed 0 U J\u201d i T T i r*i~~r\tj \u00ed\ti t~~r~r~~j * ? y\u2014s\tf\t\u00a1\u2014r\n<>\n-a---------et\u2014e-\n\u00a9\u25a0\u25a0&amp;-e-&amp;-o Poco corri 300 m\nPoco coro 200 m\nM-\u00edrtrt poco com 100' m\n3x4x1,2,3\n-f-Y\u2014(\u2014f\u2014\u25a0- I \u25a0\u25a0} ; 'T\u2014j\u2014r.-T~r~T\u2014n-r i [ j j\u2014I\u2014I\u2014] 1 'I\n20\t40\t60\t\u25a0\t80\nTempo (dias)\n1\"!\u2014!\u2014i\u2014(\u20141\u2014!\u2019\nroto\nPace\nPoco\ncam 300 m\ncorr\u00ed 200 m\ny\n3x4x1.2.3\n100\nTernpo (d\u00edas)\n\n\nFigura 8.7: Perfil vertical de satura\u00e7\u00e3o de agua\n9 CONCLUS\u00d5ES E RECOMENDA\u00c7\u00d5ES\nAs principais conclus\u00f5es obtidas no desenvolvimento deste trabalho foram:\n\u2022\tPo\u00e7o horizontal;\n\u201c Com o avan\u00e7o das t\u00e9cnicas de perfura\u00e7\u00e3o e completa\u00e7\u00e3o, a utiliza\u00e7\u00e3o de po\u00e7os horizontais surge como alternativa vi\u00e1vel para a drenagem de reservat\u00f3rios, onde a utiliza\u00e7\u00e3o de po\u00e7os verticais convencionais \u00e9 comprovadamente ineficaz.\n\u2022\tRefinamento local de malha e decomposi\u00e7\u00e3o de dom\u00ednios:\n\u2014 S\u00e3o ferramentos muito \u00fateis, que podem ser utilizadas para economizar tempo e mem\u00f3ria computacional, n\u00e3o s\u00f3 para a simula\u00e7\u00e3o de po\u00e7os horizontais mas tamb\u00e9m para a representa\u00e7\u00e3o de qualquer fen\u00f4meno localizados.\n\u2022\tModelos desenvolvidos:\n-\tTanto o modelo totalmente acoplado quanto os desacoplados - com acoplamento na itera\u00e7\u00e3o e no time step - fazem a representa\u00e7\u00e3o do comportamento de reservat\u00f3rio com po\u00e7o horizontal e da geometria do fluxo ao redor deste, de forma adequada e econ\u00f4mica;\n\u2014 Nos modelos desacoplados deve-se ter aten\u00e7\u00e3o especial com as toler\u00e2ncias usadas no processo de conv\u00eargencia;\n-\u25a0 O modelo totalmente acoplado tem maior aplica\u00e7\u00e3o em problemas que podem ser representados por malhas grosseiras;\n-\tOs modelos desacoplado podem ser implementados em simuladores convencionais.\n\u2022\tM\u00e9todos de solu\u00e7\u00e3o do sistema linear de equa\u00e7\u00f5es:\n-\tA utiliza\u00e7\u00e3o de m\u00e9todos de solu\u00e7\u00e3o de matrizes esparsas que trabalhem somente com os elementos n\u00e3o nulos trazem significativa economia de tempo;\nComo recomenda\u00e7\u00f5es para o aprimoramento deste trabalho, sugerimos:\n\u2022\tAdapta\u00e7\u00e3o dos modelos desenvolvidos para, computadores de grande porte, para simula\u00e7\u00e3o de malhas com maior refinamento;\n\u2022\tAdapta\u00e7\u00e3o de malhas esf\u00e9ricas para a representa\u00e7\u00e3o do fluxo nas pontas do po\u00e7o;\n\u2022\tPesquisa de algoritmo mais otimizado para a solu\u00e7\u00e3o de matrizes esparsas com elementos de interface de malhas.\n10 REFER\u00caNCIAS\n10.1\tPo\u00e7os Horizontais\n1.\tGiger, F. M.,Reiss, L. H. and Jourdan, A. P., \u201cThe Reservoir Engineering Aspects of Horizontal Drilling\u201d, paper SPE 13024 presented at the 59th Annual Technical Conference and Exhibition, Houston, September, 1984.\n2.\tGiger, F. M., \u201c Horizontal Wells Production Techniques in Heterogeneous Reservoirs \u201d, paper SPE 13710 presented at the Middle East Oil Technical Conference and Exhibition, Bahrain, March, 1985.\n3.\tReiss, L. H., \u201cHorizontal Wells\u2019 Production After Five Years\u201d, paper SPE 14338 presented at the 60th Annual Technical Conference and Exhibition of the SPE, Las Vegas, September, 1985.\n4.\tGiger, F. M.,\u201c Analytic 2-D Models of Water Cresting Before Breakthrough for Horizontal Wells\u201d, paper SPE 15378 presented at the 61th SPE Annual Technical Conference and Exhibition, New Orleans, October, 1986.\n5.\tChaperon, L, \u201cTheoretical Study of Conning Toward Horizontal and Vertical Wells in Anisotropic Formations: Subcritical and Critical Rates\u201d, paper SPE 15377 presented at the 61th SPE Annual Technical Conference and Exhibition, New Orleans, October, 1986.\n6.\tSherrrard, D. W., Brice, B. W. and MacDonald, D.G., \u201cApplication of Horizontal Wells at Prudhoe Bay\u201d, paper SPE 15376 presented at the 61th SPE Annual Technical Conference and Exhibition, New Orleans, October, 1986.\n7.\tKarcher, B. J., Giger, F. M. and Combe, J., \u201cSome Practical Formulas to Predict Horizontal Well Behavior\", paper SPE 15430 presented at the 61th SPE Annual Technical Conference and Exhibition, New Orleans, October, 1986.\n8.\tLee, S. H.,\u201cAnalysis of Produtivity of Inclined Wells and its Implication on Pinite Difference Reservoir Simulation\u201d, paper SPE 16002 presented at the Ninth Symposium on Reservoir Simulation , San Antonio, February, 1987.\n9.\tKossack, C. A.,Kleppe, J. and Aasen, T., \u201cOil Production from the Troll Field: A Comparison of Horizontal and Vertical Wells\u201d, paper SPE 16869 presented at the 62th Annual Technical Conference and Exhibition of SPE, Dallas, September, 1987.\n10.\tJoshi, S. D., \u201cAugmentation of Well Produtivity With Slant and Horizontal Wells\u201d, paper SPE 15375 presented at the 61th SPE Annual Technical Conference and Exhibition. New Orleans, October, 1986.\n11.\tGoode, P. A., Thambynayagam, R. K. M., \u201cPressure Drawdown and Buildup Analysis Wells in Anisotropic Media\u201d, paper SPE 14250 presented at the 1985 SPE Annual Technical and Conference and Exhibition in Las Vegas, Sept. 22-25.\n12.\tLara, A. Q., \u201dEstudo do Comportamento Transients de Press\u00e3o em Po\u00e7os Horizontais\u201d, tese de mestrado, Universidade Federal de Ouro Preto, mar\u00e7o, 1986.\n13.\tOdeh, S. A., \u201cTransient Flow Behavior of Horizontal Wells: Pressure Drawdown and Buildup Analysis\u201d, paper SPE 18802 presented at the 1989 SPE California Regional Meeting, April 5-7.\n14.\tChang, M. M., \u201cSimulation of Production from Wells With Horizontal-Slanted Laterals\u201d, Final Report, IIT Research Institute National for Petroleum and Energy Research, Bartlesville, Oklahoma, March, 1989.\n15.\tBabu, D. K., Odeh, A. S., \u2019\u2019Productivy of a Horizontal Well\u201d, paper SPE 18298, presented at the SPE Annual Technical Conference and Exhibition, Houston, October, 1988.\n16.\tOzkan, E., et al, \u2019\u2019Horizontal-Well Pressure Analisys\u201d, paper SPE 16378, presented at the 1987 SPE California Regional Meeting, April, 1987.\n17.\tClonts, M. D., Ramey, H. J., \u201d Pressure Transiente Analysis for Wells with Horizontal Drainholes \u201d, paper SPE presented at the 56th California Regional Meeting in Dokland, C.A., April, 1986.\n10.2\tRefinamento local\n18.\tAkbar, A., et al, \u2019\u2019Numerical Simulation of Individual Wells in a Field Simulation Model\u201d, paper SPE 4073 presented at the SPE-AIME, 47th Annual Fall Meeting, San Aantonio, October 1972.\n19.\tRosenberg, D., \u201cLocal Mesh Refinement fo Finite Diference Methods\u201d, paper SPE 10974 presented at the 57th Fall Technical Conference and Exhibition of the SPE, New Orleans,1982.\n20.\tQuandale, P. and Besset, P., \u201cThe Use of Flexible for Reservoir Modeling\u201d, paper SPE 12239 presented at the SPE Symposium on Reservoir Simulation , San Francisco, November, 1983.\n21.\tHeinemann, Gerken, G. and HantelmannM, G., \u201cUsing Local Grid Refinement in a Multi pie-Application Reservoir Simulator\u201d, paper SPE 12255 presented at the SPE Symposium on Reservoir Simulation , San Francisco, November, 1983,\n22.\tPedrosa, O, A., \u201c Use of Hybrid Grid in Reservoir Simulation \u201d Tese de Doutorado, Stanford University, December, 1984.\n23.\tForsyth, P. A. and Sammon, P. H.,\u201cLocal Mesh Refinement and Modelling of Faults and Pinchouts\u201d, paper SPE 13524 presented at the SPE 1985 Reservoir Simulation Symposium, Dallas, February, 1985.\n24.\tQuandale, P. and Besset P., \u201cReduction of Grid Effects Due to Local Sub-Gridding in Simulations Using a Composite Grid\u201d, paper SPE 13527 presented at the SPE 1985 Reservoir Simulation Symposium, Dallas, February, 1985.\n25,\tHan, I). K., Yan, C.Z. and Peng, L.T., \u201cA More Flexible Aproach of Dynamic Local Refinement for Reservoir Modding\u201d, paper SPE 16014 presented at the Ninth SPE Symposium on Reservoir Simulation, San Antonio, February, 1987,\n26,\tWasserman, M. L.,\u201cLocal Grid Refinement fo Three-Dimensional\nSimulators\u201d, paper SPE 16013 presented at the Ninth SPE Symposium on Reservoir Simulation, San Antonio, February, 1987.\n27,\tEwing, R. E., Boyet, B. A. and Babu, D. K./Effient Use of Locally Refined Grids for MultifaseReservoir Simulation\u201d, paper SPE 18413 presented at the SPE Symposium on Reservoir Simulation , Houston, February, 1989,\n28- Heinemann, Z. E., Brand, C., Munka, M. and Chen, Y. M., \u201cModeling Reservoir Geometry With Irregular Grids\u201d, paper SPE 18412 presented at the SPE Symposium on Reservoir Simulation , Houston, February, 1989.\n29.\tBrand, C., Heinernman, Z. E,, \u201dA New Iterative Solution Technique for Reservoir Simulation Equation on Localy Refined Grids\u201d, paper SPE 18410, presented at the SPE Symposium on Reservoir Simulation in Houston, February, 1989.\n30.\tAris, K, e Settari, A., \u201d Petroleum Reservoir Simulation\u201d, Applied Science Publisher, 1979.\n31.\tPeacernan, D. W,, \u201dFundamentals of Numerical Reservoir Simulation\u201d, Elsevier Scientific Publishing Co., Amsterdam, 1977.\n32.\tCrichlow, H. B., \u201dModern Reservoir Engeneering - a Simulation Approach\", Prentice Hall Inc., Engledwood Cliffs, NJ, 1977.\n33.\tDake, L, P., \u201d Fundamentals of Reservoir Engineering\u201d, Elsevier Scientific Publishing Co., Amsterdam, 1978.\n34.\tSherman, A. H.,\u201d NSPIV - A Fortran for Sparse Gaussian Elimination with Partial Pivoting\u201d, The University of Texas at Austin,\nNeste ap\u00eandice, s\u00e3o apresentadas todas as derivadas e as hip\u00f3teses usadas para a solu\u00e7\u00e3o do problema na forma totalmente impl\u00edcita.\nAs equa\u00e7\u00f5es para o fluxo do \u00f3leo e da \u00e1gua s\u00e3o:\nEqua\u00e7\u00e3o para o \u00f3leo:\nT&amp;m+'l/Z iCpm+r Pm}\t\u00bfAn-l-1)] 4\"\nPOTOM2\n<I'Qm\u2014l/2 KPtb Pm-l) ~\t1/2 (^An\u20141 ~ 7?m)] ~\ns 1\t.........-v  ...........\nPOTOMl\n\u201c\u00a3\u201c([1 + er(po - pon)][l - 5w)\u00f2o] - (Sobo}n}ijk +Qo\t(A.l)\n\u25a0---:------------------------------------------\nACO\nEqua\u00e7\u00e3o para a \u00e1gua:\nTwm+i/2 [(pm + 1 Pm)\t'ywm+l/2^^m ^An-H)] 4\u201c\n.. ...........\nP0TWM2\n[(Pm\tPm\u20141)\t~\t\u20141)\t.. ^m)] \u201d\n-.-----------------------/\nP0TWM1\n-j^--([l + cr(po \u2014 pon}](Swbw} - (Sobo)n)ijk +Qw\t(A.2)\nACW\nComo as equa\u00e7\u00f5es acima est\u00e3o escritas de forma simplificadas deve-se observar que:\n\u2022 Os termos de fluxo devem ser tomados em todas dire\u00e7\u00f5es, portanto, as transmis-sibilidades devem ser calculadas para todas dire\u00e7\u00f5es, assim nesta representa\u00e7\u00e3o m, representa os blocos \u00ed,j e fc,\nm + 1/2 representa as faces i + 1 /2, j + 1/2 e k + 1/2 e\n\u2022\tP0TIM2 representa a diferen\u00e7a de potencial de fluxo entre os blocos m e m 4 1. P0TIM1 representa a diferen\u00e7a de potencial de fluxo entre os blocos m e m \u2014 1. Z, pode ser \u00f3leo (o) ou agua (w).\nM, representa as dire\u00e7\u00f5es x, y ou z.\n\u2022\tComo \u00f3 usado o esquema totalmente impl\u00edcito, a maioria das vari\u00e1veis s\u00e3o calculadas no time step n 4 1, Para simplificar as equa\u00e7\u00f5es, somente ser\u00e3o colocados os expoentes quando elas estivem no time step n.\n\u2022\tACl \u00e9 o termo de acumula\u00e7\u00e3o para o \u00f3leo ou a \u00e1gua.\n\u2022\tp \u00e9 a press\u00e3o na fase \u00f3leo.\n\u2022\tPe \u00e9 a press\u00e3o capilar \u00f3leo/\u00e1gua.\nPortanto usando a nomenclatura simplificada as fun\u00e7\u00f5es de res\u00edduos podem ser escritas:\n\u00d3leo:\nPo = Tom+1/2POTOM2 - Tom^/2POTOM1 - ACO - Qo\t(A.3)\n\u00c1gua:\nFw = Twm+\u00cd/2POTWM2 - Twm~\u00ed/2POTWM1 - ACW ~ Qw\n(A.4)\nDerivadas das Fun\u00e7\u00f5es Res\u00edduos do \u00d3leo - Fo\nL Eni Rela\u00e7\u00e3o a Press\u00e3o ( Equa\u00e7\u00e3o Geral )\ndFo dp\nP0T0M2^-^^\ndp\n4* l\\i+l/2\n\u00d4P0T0M2 dp\n- POTOM1\nTom..1/2 rr dPOTOMl dACO dQo dp\tdp\tdp dp\n(A.5)\n2.\tEm Rela\u00e7\u00e3o a\ndFo dpm~i\n= \u2014POTOMA\ndpm-\\\ndPOTOMl\ndp\n(A.6)\n\n3.\tEm Rela\u00e7\u00e3o a, pm\ndFo dPm\nP0T0M2^-^Ul\ndpm\n4- Tom+l/2\ndP0T0M2\ndPm\nTom~l/2\tdPOTOMl _ dACO\ndpm\tQPm\tQPm\n- P0T0M1\ndQo dpm\n(A.7)\n4.\tEm Rela\u00e7\u00e3o a pm+l\ndFo\ndpm.+1\n= P0T0M2^F\u00b1yi\n4- Tom+l/2\ndP0T0M2 dpm-Vl\n(A.8)\n1, Em Rela\u00e7\u00e3o a Satura\u00e7\u00e3o ( Equa\u00e7\u00e3o Geral )\n= P0T0M2 o\u00e0w\ndSw\n+ Tom+i/2\ndPOTOM2 dSw\nTo^/2\t\u201e dPOTOMl\ndSw\tdSw\n\u00d4ACO\ndSw\n- P0T0M1\ndQo dSw\n(A.9)\n2. Em Rela\u00e7\u00e3o a Swm~i\n^- = -P0T0Ml^^\n(A.10)\n3.\tEm Rela\u00e7\u00e3o a Swm\n9Fo\ndSwm\nPOTOM2dT^+i/2 - POTOMl^^- -\t+\nuSwm\t\u00bf\u00c0SWrr\u00e7 (jSw^\ndQo\ndSwm\n(A.ll)\n4-, Em Rela\u00e7\u00e3o a Swm+i\ndFo dSwm+i\n= POTOM2aPm+I/3\n(A.12)\nDerivadas das Fun\u00e7\u00f5es Res\u00edduos do \u00c1gua - Fw\n1. Em Rela\u00e7\u00e3o a Press\u00e3o ( Equa\u00e7\u00e3o Geral )\ndFw\ndp\nP0TWM2\ndTwm+y2 dp\n+ Twm+l/2\n9POTWM2\ndp\n- P0TWM1\nTwm~1/2\tdPOTWMl \u00d4ACW \u00d4Qw\ndp\tm-l/2\n2. Em Rela\u00e7\u00e3o a pm-x\n\u00d4Fw dpm~i\n= -POTWMl^^ dpm-l\nTwm~.2f2\ndPOTWMl dp-m-i\n(A.14)\n3, Em Rela\u00e7\u00e3o a pm\ndFw dpm\nPOTWM2dT^m+1/2 + Twm+l/2\nT- 1/2 dpm\ndpm\ndPOTWMl\n-Tw^1(2\ndPm\n4. Em Rela\u00e7\u00e3o a pTO+1\n\u00d4Fw dpm+l\n= P0TWM2dT\u2122m+^\ndPOTWM2\n- P0TWM1\ndpm\ndACW \u00d4Qw\ndpm\ndpm\n(A, 15)\n_ dPOTWM\u20182\n+ J wm+l/2-a\ndpm+i\n1. Em Rela\u00e7\u00e3o a Satura\u00e7\u00e3o ( Equa\u00e7\u00e3o Geral )\ndFw dSw\n= I0TWM2-~l^ + Tw^~~~Js^~ +\n-potwmJ-^ -\t+\ndACW dQw dSw dSw\ndSw\n(A.,17)\n2. Ern Rela\u00e7\u00e3o a S'wm_3\n\u00d4Fw dSwm~!\n= ~POTWMlT\u2122m~l/2\nrri\n\u2014 J w\nm\u20141/2\n\u00d4POTWMl dSwm~i\n(A.18)\n3. Em Rela\u00e7\u00e3o a\ndFw dSwm\nPOTWM2^M111 _L Tw SPOTWMZ\n1 OTA M2 dS^ + 2 wm+1/2 dSw^ + \u00d4POTWMl t\n\u2014POIW Ml    1 wm \u201e! M......4-\noSwm\ndACW dQw\ndSwm + \u00d5Swm\ndSwm\n(A.19)\n4. Em Rela\u00e7\u00e3o a Swm+1\ndFw dS\n^i^\u00f4Twm+1/2 i m 3POTWM2\n\u2014 P07 WM2\u2014------F Twm+i/2\ndSwm+\u00ed\n(A.20)\nDerivadas dos Potenciais em Rei a\u00e7\u00e3o a Press\u00e3o\nP0T0M1 ou 7WIVAH\nPOTOMX\n= (Pm ~ Pm-i ) \u201c (\u00ab>7oto + (1 - w)yom^t)]\n(Dm-i\n(A. 21)\n\nP0TWM1 = (pm - pm^) ~ (Pc\u2122 ~ Pc^ ) +\n-[w7wm + (1 - w)7wra_j)](Pm_i - Dm)\n(A.22)\ndPOTIMl\ndPOTIMl\ndpm-i\n(A.23)\n= 1 _\t_ Z>\u201e)\n$Pm\t\u00aepm\n(A.24)\ndPOTIMl dpm^l\n(A.25)\n\u00bb P0T0M2 ou P0TWM2\nP0T0M2 = (Pm+l Pm) - [W7<?m+1 + (1 - w)7Om)]\n(Dyn ~ Dm+1)\n(A.26)\nP0TWM2 = (pm+i -\t- (Pcm+1 -\t4-\n~[w7wm+i + (1 - w)7wm)](Pm - Dm+1)\n(A.27)\ndPOTIMZ\n&amp;Pm-l\n(A,28)\n\u00d4P0TIM2 dpm\n(A.29)\n9POTIM2\n&amp;Pm+1\n^\u2019y dpm+1\n(A.30)\n= 1 ~ W\n\nDerivadas dos Potenciais em Rela\u00e7\u00e3o a. Satura\u00e7\u00e3o\n\u2022 P0T0M1 ou P0T0M2\ndP0T0M\\,2 __ dPOTOMl.,2 _ dPOTOM 1,2 dSwm_i\tdSwm\tdSwm+i\n\u00bb P0TWM1\ndPOTWMl\ndSWn-i\ndPcm-!\ndSwm\u2014\\\ndPOTWMl 9Pcm\ndSwm \" dSwm\ndPOTWMl dSwm+i\n\u00bb P0TWM2\n(A.34)\n&amp;P0TWM2 dSwm_!\n(A.35)\n9POTWM2 __ dPc^ dSwm \u00e2Swm\n(A.36)\ndP0TWM2 dSwm+1\n(A.37)\ndP Cjn.-\u00ed-i\nDerivadas das Transmissibilidade\nConven\u00e7\u00e3o do sentido de fluxo para, as duas malhas s\u00e3o;\ncoordenada m\tsentido do fluxo\t\n\tA\tB\ni\tcontr\u00e1rio ao e\u00edxo x\tsentido do eixo x\nj\tsentido do eixo y\tcontr\u00e1rio ao eixo y\nk\tsentido do eixo z\tcontr\u00e1rio ao eixo z\nDerivadas em rela\u00e7\u00e3o a press\u00e3o\nAs derivadas em rela\u00e7\u00e3o a press\u00e3o s\u00e3o iguais para todos os eixos de fluxo.\nqualquer sentido\ndTlm+1/2\ndPm\u2014l\n(A.38)\ndpm\n\n1 dblm ^m+l/2 dpm\n1 dplm\nP^m+1/2 dp Trt\n(A.39)\n&amp;Tlm+l/2 dpm+1\n1 dblm+i\n^rn+l/2 dpm^-i\n1 dplm+-\u00ed p^m+1/2 dpm^.i\n(A.40)\ndTlm_1/2\ndpm^i\n= (1\n\n1\tdblm\u2014|\nbt-rn \u20141/2 dp^ \u2014 l\n1/2\n(A.41)\narUi/2 dpm\n\u00ed,\tr 1 dblm. J 1 dplr,,_\n(1 - W)1\t-----[\u2014i-----T\u2014-\n(A.42)\ndTlm-lpi Q &amp;pm-l\n(A,43)\nDerivadas em rela\u00e7\u00e3o a satura\u00e7\u00e3o\n1. Dire\u00e7\u00e3o x\n(a) Sentido A\nderivada\tface i \u2014 1/2\tface i 4\" 1/2\n\u00d5Tl\t0\t0\ndSwi\u2014i\t\t\n8T\u00cd\tZ7 JT\t/ 6/ \\\tdkrli t\u20141/21\t) 1\u20141/2 \u00bf5^\t0\ndT\u00cd\t0\tCE?\t. / bl \\\t. dfcrii+i *\u20141/2\u00c7 f\u00edj )i-~l/2 J5ttl\u00bf+1\n&amp;Swi\u00b1i\t\t\n(b) Sentido B\nderivada\tface \u00ed-l /2\tface i +1/2\nari\t\t0\nj\t\t\nari dSll\u00edi\t0\t1? E?\t/ M 'I\tikrit-}\n&amp;TI\t0\t0\ndeltaSiui+i\t\t\n2. Dire\u00e7\u00e3o y e z\n(a) Sentido A\nderivada\tface m \u2014 1/2\tface m + 1 /2\n\u00d5Tl\tI? L1\t. f bl\\\t.\t0\n\t\t\n3TI SSwm\t0\tP p\t, \u00ed bl\\\t\u00e0krl^\n&amp;Ti\t0\t0\ndeltaSwm-f.1\t\t\n(b) Sentido B\nderivada\tface m \u2014 1/2\tface in 4- 1/2\n9T\u00cd\t0\t0\n\t\t\nST1 9Swm\tr? IV\tt b\u00ed \\\tdkrl-n, \u00bfSwm\t0\n3TI\t0\tiv r?\tf bi \\\tdkrlm+1 m-H./2l jjJm+1/2\nQ$u>m + i\t\t\nDerivadas dos Termos de acumula\u00e7\u00e3o\nOleo\n&amp;ACO Vp\u00edjkf!, t f\tydbo h Z1 n s\n1^7 = \u201dST<|1 + cr(p - p )](1 - Sw)~ + (1 - Sw)bocr)\n(A.44)\ndACO\nVpijk\nA/\nQ1 +cr(p-pn)]6o\n(A.45)\n\u00c1gua\ndACW _ VPijk\ndp\u00edjk\n([1 4- cr(p \u2014 pn)]Sw\ndbw dp\n4- Swbwcr)\n(A.46)\ndACW\ndSwijk\n^^([1 + cr(p - pn)]bw\n(A.47)\nDerivadas das Vaz\u00d3es\nA vazao de cada Moco comunicante com o poco \u00e9 dada por:\nQl = Tl^POTlXl\n\u00d3leo\n(A.48)\nou,\ndQo dpijk\n\nm POTIXA\n(A.49)\ndQo\tnn'ri v i t m\tdboijk 1 /\u00bfdljfc .\n~\u2014 = porixi[wi 01/2M,............................ )\t+\ndpijk\tbo1/2jk Pijk\tIi<hi2jk Pisk\nVpljk\ndQo _ DnTjvir tv. {dT^ptik\ndSw\u00bfjk POTlXllwT*W&lt;dSwi3k\nPara a Agua\n(A.50)\n(A.51)\ndQw\ndpijk\nXw\tkrwbwpo\nQo== -\u2014 ----QO\nXo\tkrobopw\nRMIVO\ndQo = RMWO^ dpijk\n+ Qo\nRMWO dpw\n(A.52)\n(A.53)\nQw ~\nonde o temo\n\u00ed\u00b0\u2019 ca\u00edcu^a(io-\n\nkrw po dbw bw (to bwpo bo kro\u00edbopw dp bopw dp bo^pwdp\nbwpo pw bopw2 dp\n(A.54)\nesta equa\u00e7\u00e3o pode ser escrita de outra forma:\nRMWO dpijk\nkrwbwpo 1 dbw 1 po 1 bo 1 pw\nkrobopw lbw dp podp bodp pw dp\n(A.55)\nSRM.WQ\n\u00d4p\nportanto mais simplificadamente, teremos:\n^ = rmwo[^l + Qo^2]\ndpijk\tdpijk\tdpijk\n(A. 56)\nEm rela\u00e7\u00e3o a satura\u00e7\u00e3o teremos:\ndQw dSw\u00edjk\nRMWO\ndQo dSw^jk\nRMWO d S t?i j \u00bf\n(A.57)\ndRMWO bwpo j dkrw\tkrw dkro\ndSwijk\tkrobopo1 dSwijk\tkro dSwijk\n(A.58)\nPress\u00e3o MPa\tB, m3/m3 std\tViscosidade cp\tDensidade kg/m3\t7?.,o rn3 std/m3 std\n0.10\t1.062\t1.040\t714.4\t0.2\n1.82\t1.150\t0.975\t698.2\t16.1\n3.55\t1.207\t0.910\t678.0\t32.1\n7.00\t1.295\t0.830\t657.4\t66.1\n13.89\t1.435\t0.695\t625.2\t113.3\n17.34\t1.500\t0.641\t614.1\t138.0\n20.79\t1.565\t0.594\t605.8\t165.6\n27.68\t1.695\t0.510\t594.0\t226.2\n34.57\t1.827\t0.449\t584.0\t288.2\n62.15\t2.357\t0.203\t552.9\t531.4\nTabela B.l: Propriedades PVT do \u00f3leo saturado\nPress\u00e3o\tBo\tViscosidade\tDensidade\nMPa\tm3/m3 std\tcp\tkg/m3\n27.68\t1.695\t0.510\t594.0\n62.15\t1.579\t0.740\t637.6\nTabela B.2: Propriedades PVT do \u00f3leo sub-saturado\nPress\u00e3o MPa\tK m3/m3 std\tViscosidade cp\tDensidade kg/m3\tR m3 std/m3 std\n0.10\t1.0410\t0.310\t997.0\t0.0\n1.82\t1.0403\t0.310\t997.7\t0.0\n3.55\t1.0395\t0.310\t998.4\t0.0\n7.00\t1,0380\t0.310\t999.8\t0.0\n13.89\t1.0350\t0.310\t1002.7\t0.0\n17.34\t1.0335\t0.310\t1004.2\t0.0\n20.79\t1.0320\t0.310\t1005.7\t0.0\n27.68\t1.0290\t0.310\t1008.6\t0.0\n34.57\t1.0258\t0.310\t1011.7\t0.0\n62.15\t1.0130\t0.310\t1024.5\t0.0\nTabela B.3: Propriedades PVT da \u00e1gua\nPress\u00e3o MPa\tm3/in3 std\tViscosidade cp\tDensidade kg/m3\n0.10\t0.93576\t0.0080\t1.0\n1.82\t0.06790\t0.0096\t14.3\n3.55\t0.03523\t0.0112\t27.5\n7.00\t0.01795\t0.0140\t54.0\n13.89\t0.00906\t0.0189\t107.0\n17.34\t0.00727\t0.0208\t133.5\n20.79\t0.00606\t0.0228\t159.9\n27.68\t0.00455\t0.0268\t213.0\n34.57\t0.00364\t0.0309\t266.1\n62.15\t0.00217\t0.0470\t447.7\nTabela B.4: Propriedades PVT do g\u00e1s\nsw\t\u2022* *\t\n0.00\t0.0\t1.0\n0.12\t0.0\t1.000\n0.20\t0.075\t0.997\n0.25\t0.125\t0.980\n0.30\t0.190\t0.900\n0.40\t0.410\t0.500\n0.45\t0.60\t0.100\n0.50\t0.72\t0.050\n0.60\t0.87\t0.0001\n0.70\t0.94\t0.0\n0.85\t0.98\t0.0\n1.00\t1.00\t0.0\n1.10\t1.00\t0.0\nTabela B.5: Permeabilidades relativas \u00f3leo - \u00e1gua\nSt = sur\tPCOU! (Pa)\n0.0\t50000.\n0.12\t50000.\n0,2\t20000.\n0,3\t10000.\n0.35385\t5000.\n0.40769\t2500.\n0.46154\t1000.\n0.51538\t500.\n0.56923\t200.\n0.62308\t100.\n0.67692\t50.\n0.73077\t25.\n0.83846\t15.\n0.89231\t10.\n0.94615\t5.\n1.00000\t0.0\n1.10000\t0.0\nTabela B.6: Curva de press\u00e3o capilar \u00f3leo - \u00e1gua\n13 AP\u00caNDICE C - Resultados\n13,1 Po\u00e7o com 300m de comprimento\nPROGRAMA ACTION.FOR\nTOTALMENTE IMPLICITO\nTRIDIMENSIONAL\nBI-FASICO ( OLEO/AGUA )\neBXHGIE\u00e2lS-e\u00e2DQS-UnilZADOS\nPar\u00e2metros de Simulacao:\nRegi\u00e3o do reservat\u00f3rio - GRID\nCARTESIANO -\nN# de blocos na direcao X\t(13)\tNXC===>\t3\nN# de blocos na direcao Y\t(13)\tNYC===>\t3\nN# de blocos na direcao 2\t(13)\tNZC==*>\t1\nDim. dos blocos direcao X\t(FIO.4)\tDBDX===>\t100.00\nDim. dos blocos direcao Y\t(FIO.4)\tDBDY===>\t50.00\nDim. dos blocos direcao Z\t(FIO.4)\tdbdz===>\t300.00\nN. de blocos produtores\t(13)\tNBP===>\t1\nCoord, i do bloco produtor\t(13)\tipx==>\t2\nCoord, j do bloco produtor\t(13)\tJP===>\t2\nCoord, k do primeiro bloco produtor Regiao do poco - GRID RADIAL -\t(13)\tKP===>\t1\nN# de blocos na direcao X\t(13) NX===>\t\t3\nN# de blocos na direcao Y\t(13) NY===>\t\t4\nN# de blocos na direcao Z\t, (13\ti) NZ===>\t1\n.001\nDT===>\nTime step inicial (dias) Tolerancia para pressao (Pa) Tolerancia para saturacao (fr) Max var de sat num DT (fracaa) Max var de pres, num DT (KPa) Vazao de oleo maxima (m3/dia) Vazao de oleo minima (m3/dia) Tempo final de simulacao (dias) Pwf minima no poco (MPa)\nRaio do poco (m)\nInt. tempo p/ impr.relatorio (dias) Int. tempo p/ impr.gr\u00e1fica (dias) Int. c\u00e9lulas de impressao Incremento de tempo m\u00e1ximo (dias) Incrementode tempo m\u00ednimo (dias) N# max de iteracoes no JAC\u00dcBIANO N# min de iteracoes no JACOBIAND Fatia J base para o calculo de Pwf Dados do teste de formacao:\n(F8.3\u00cd\n(F8.3) T0LP===>3447.400\n(F6.4) T0LS===>\n(F6.4)DSLIM===>\n(F8.3)DPLIM===>\n(F8.3)Q0MAX===>\n(F8.3)Q0MIN===>\n(F8.2) TSIM===> 5000.00\n(F8,3)PWMIN===>\n(F8.4) RW===>\n(F5.l)TIMPR~-=> (F5.1)TIMPG-==>\n(I3)IRIMP==> 1\n(F5.1)DTMAX==S=>\n(F6.4)DTMIN===> (I3)ITMAX===> (I3)ITMIN===> (13)JPROD===>\n.0010\n.0500\n689.480\n300.000 15.000\n30.000 .1000 3Q.0 10.0\n10.0 .0010\n5\n2\n1\nSimulacao de teste de formacao\nVazao de producao (m3/dia)\nTempo de fluxo (horas)\nTempo de est\u00e1tica (horas)\nIncr. de tempo no teste (horas)\n(S ou N) 0PT===>N\n(F8.3) QOTF===>\n(F8.3) TPTF=\u2014>\n(F8.3) TETF===>\n(F8.3) DTTF===>\n50.000 24.000 72.000\n.500\n.8000 .440E-03 35.0000 90.0000\n39.894\nTemperatura do reservat\u00f3rio (\u00aeC) Raio externo da regi\u00e3o do poco (m) Cota do poco (m)\nCota do contato o/w (m) Porosidade igual a\t.3000 para\nPermeabilidade na direcao X igual a Permeabilidade na direcao Y igual a Permeabilidade na direcao Z igual a\nDados do reservat\u00f3rio:\nSaturacao inicial de agua (fracao) (F6.4) SWII\u00ed===> .1200\nDensidade do gas (adim)\t(F6.4) DGAS===>\nCompressibilidade da rocha (1/MPa)\t(E9.3) CR===>\nPress\u00e3o inicial do reservat\u00f3rio(MPa) (F8.4) PRIN==>\n(F8.4) TEMP===>\n(F8.4) RE-==>\n(F8.3) ZC===>-2560.00 (F8.3) ZCOW=s==>~2610.00 todos os blocos\n50.0000 para todos blocos 50.0000 para todos blocos 50.0000 para todos blocos\nRESUMO D0 TIME STEP 1\t\t\nTempo\t(dia)\t! .00100 !\nDt\t(dia)\tI\t.00100\t!\nqo\t(m3/dia)\t!\t.3000D+03\t!\nQg\t(m3/dia)\tI\t.6786D+05\t!\nQw\t(m3/dia)\t!\t.OOOOD+OO\t!\nRG0\t(m3/m3)\t! 226.2000 !\nRWO\t(m3/m3)\t! .0000 !\nPwf\t(MPa)\t!\t34.6510\t!\nNp\t(m3)\t!\t.3000D+00\t!\nGp\t(\u00ae3)\t!\t.6786D+02\t!\nWp\t(m3)\tI\t.OOOOD+OO\t!\nBalan\u00e7o\tde Materais\t\nOleo\t(\u2019/.)\t!\t.\u00cdOOOD+Ol\t!\nGas\t(7.)\t!\t.\u00cdOOOD+Ol\t!\nAgua\t(X)\t!\t. \u00cdOOOD+Ol\tI\nRecup.\t(7.)\t! .0000\nIP\t(m3/d/kg/cm2)!\t552,5163\nMapa de Press\u00e3o e Saturacao (Press\u00e3o, So e Sw) GRID CARTESIANO\nCamada 1\n! 01 !\t\t02 !\t03\t!\n\t34.4088 !\t34.4088 !\t34.4088 !\n3\t.88000 !\t.88000 !\t.88000 !\n\t.12000 !\t.12000 !\t.12006 !\n\t34.7043 !\t.0000 !\t34.7043 !\n2\t.88000 !\t.88000 !\t.88000 !\n\t.12000 !\t.00000 !\t.12000 \u00ab\n\t35.0000 !\t35.0006 !\t35.0000 !\n1\t.00000 !\t.00000 !\t.00000 !\n\t1.00000 !\t1.00000 !\t1.00000 !\n\tGRID RADIAL\t\t\nCamada 1\t\t\t\n\t01 !\t02 !\t03\t?\n\t34.6208 I\t34.6861 !\t34.7042 !\n1\t.87999 !\t,88000 !\t.88000 !\n\t.12001 !\t.12000 !\t.12000 !\n\t34.6180 !\t34.6659 I\t34.5557 !\n2\t.87999 !\t.88000 !\t.88000 !\n\t.12001 !\t.12000 !\t.12000 I\n\t34.62Q8 !\t34.6861 !\t34.7042 !\n3\t.87999 !\t.88000 !\t.88000 !\n\t.12001 \u2019\t.12000 !\t.12000 !\n\t34.6235 !\t34.7062 !\t34.8518 !\n4\t.87999 !\t.88000 !\t.88000 !\n\t.12001 !\t.12000 !\t.12000 !\nCamada 1\nBLOCO\tPRESS\u00c3O\tQoj,k Qwj,k\tRWO\n1=1 J\t(MPa)\t(m3/D)\t(m3/D)\t(m3/m3)\n1\t34,62077\t75.00000\t.00000\t.00000\n34.61804\n34.62077\n34.62349\n75.00000\n75.00000\n75.00000\n.00000\n.00000\n.00000\n.00000\n.00000\n.00000\nRESUMO DO TIME STEP 24\t\t\nTempo\t(d\u00eda)\t!\t32.44348\t!\nDt\t(dia)\t! 10.00000 !\nQo\t(m3/dia)\t!\t.3000D+03\t1\nQg\t(m3/dia)\t!\t.6786D+05\t!\nQw\t(m3/dia)\t!\t.18910+00\tI\nRGG\t(\u00ae3/m3)\t! 226.2000 !\nRWO Pwf\t(m3/m3) (MPa)\t! .0006\t! !\t32.2753\t!\nNp\t(m3)\t!\t.9733D+04\t!\nGp\t(m3)\t!\t.2202D+07\t!\nWp\t(\u00ae3)\t!\t.37940+01\t\u25a0\nBalanco\tde Materais\t\nOleo\t(\u2019/.) !\t. 1000D+01\t!\nGas\t(*/,)\tI\t. 1000D+01\t\u2019\nAgua\t(%) !\t. 1000D+01\t!\nRecup.\t(%) 1\t.6949\nIP\t(m3/d/kg/cm2)!\t127.8716\nMapa de Press\u00e3o e Saturacao (Pressao, GRID CARTESIANO\nCamada 1\nSo e Sw)\n01\t!\t02\t!\t03\n1 3 ! i\t32.2221 ! .87978 ! .12022 !\t32.2062 ! .87977 ! .12023 !\t32.2221 ! .87978 ! .12022 1\n2 |\t32.5054 ! .87976 ! .12024 !\t.0000 ! .88000 ! .00000 !\t32.5054 \u2018 .87976 ! .12024 !\n\u00ed 1 ! \u00ed\t32.8419 ! .00000 ! 1.00000 !\t32.8288 ! .00000 \u2019 1.00000 \u2019\t32.8419 ! .00000 ! 1.00000 !\nGRID RADIAL\nCamada 1\n!\ti 02 j \u201d\"o3\n32.3272 ! .87976 ! .12024 !\t32.3949 ! .87976 ! .12024 !\t32.4634 ! .87976 1 .12024 !\n32.3245 ! .87972 ! .12028 !\t32.3750 ! .87974 ! .12026 !\t32.3164 ! .87979 \u2018 .12021 !\n32.3272 1 .87976 ! ,12024 !\t32.3949 ! .87976 J .12024 !\t32.4634 ! .87976 ! .12024 !\n32.3298 ! .87983 ! .12017 1\t32.4144 ! .87982 I .12018 !\t32.6074 ! ,85597 \u25a0 .14403 !\nCamada 1\nBLOCO\tPRESS\u00c3O\tQoj\t,k\tQwj,k\tRWO\nJ\t(MPa)\t(m3/D)\t(m3/D)\t(m3/ra3)\n1\t32,\t32716\t74.\t99997\t.04908\t.00065\n2\t32.\t32449\t74.\t99988\t.05614\t.00075\n3\t32.\t32716\t74.\t99997\t,04908\t.00065\n4\t32.\t32976\t75.\t00017\t.03481\t.00046\nRESUMO DO TIME STEP 27\t\t\t\t\nTempo\t(dia)\t!\t62.44348\t\u00ed\nDt\t(dia)\t1\t10.00000\tt\nqo\t(m3/dia)\tt\t.3000D+03\t1\nQg\t(m3/dia)\t1\t.6786D+05\tt\nQw\t(m3/dia)\t1\t.3419D+00\t1\nRGO\t(m3/m3)\ti\t226,2000\t1\nRWO\t(m3/m3)\tt\t.0011\t1\nPwf\t(MPa)\t1\t30.2398\t1\nNp\t(m3)\tt\t.1873D+05\t1\nGp\t(m3)\tt\t,42370+07\tt\nWp\t(m3)\t!\t,1256D+02\t1\nBalance\tde Materais\t\t\t\nOleo\tCZ)\ti\t\u25a0\u00cdOOOD+Ol\t1\nGas\tCZ)\t\t.lOOOD+Ol\t1\nAgua\tCZ)\ti\t.\u00cdOOOD+Ol\t(\nRecup.\tCZ)\t1\t1.3374\t\nIP\t(m3/d/kg/cm2)!\t\t130.5906\t\n\tMapa de Press\u00e3o\t\te Saturacao\t(Press\u00e3o, So\nGRID CARTESIANO\nCamada 1\n01\t!\t02 \u00ed 03\ni 30.1828 !\n3 !\t.87960\t!\n!\t.12040 !\n30.1672 !\n.87956 !\n.12044 !\n30.1828 !\n.87960 \u2019\n.12040 !\n!\t30.4651\t!\n2 !\t.87953\t!\n!\t.12047 !\n.0000 I 30.4651 ! .88000 !\t.87953\t!\n.00000 !\t.12047\t!\n!\t30.8104\t!\t30.7973\t!\n1\t!\t.00000\t!\t.00000\t!\n!\t1,00000\t!\t1,00000\t!\n30.8104 !\n.00000 !\n1.00000 !\nGRID RADIAL\nCamada 1\n01\t\u2019\t02 \u00ed 03\n!\t30.2906\t!\t30.3569\t!\n1\t!\t.87954\t!\t.87955\t!\n1\t.12046\t!\t.12045\t\u2018\n30.4240 !\n.87955 !\n.12045 !\n!\t30.2879\t!\t30.3370\t!\n2\t!\t.87951\t1\t.87955\t!\n!\t.12049\t!\t.12045\t!\n30.2766 !\n.87964 !\n,12036 !\n30.2906 !\n.87954 !\n,12046 !\n30.3569 !\t30.4240\t!\n.87955 !\t.87955\t!\n.12045 !\t.12045\t\u00bb\ni\n4 j\ni\n30.2931 *\t30.3763\t\u2022\n,87966 !\t.87964\t!\n.12034 !\t.12036\t\u25a0\n30.5674 ! .83326 ! .16674 !\nCamada 1\nBLOCO\n1=1 J\n1 2\n3\n4\nPRESS\u00c3O\n(MPa)\n30.29055\n30.28789\n30.29055\n30.29315\n(m3/D)\n74.99994\n74.99984\n74.99994\n75.00027\nQoj ,k\n(m3/D) .08952 .09632 .08952\n.06656\nQwj,k\nRWO\n(m3/m3) .00119 .00128 .00119 .00089\nRESUMO DO TIME STEP 34\t\t\nTempo\t(dia)\t!\t84.42590\t!\nDt\t(dia)\t!\t7.11914\tI\nQo\t(m3/dia)\t!\t.7956D+01\t!\nQg\t(m3/dia)\t!\t.1800D+04\t!\nQw\t(m3/dia)\t!\t.1249D-01\t!\nRGO\t(m3/m3)\t!\t226.2000 !\nRWO\t(m3/m3)\t!\t.0016 !\nPwf\t(MPa)\t!\t30.0060\t!\nNp\t(m3)\t!\t.2070D+05\t!\nGp\t(m3)\t!\t.4682D+07\t!\nWp\t(m3)\t!\t.1496D+02\t!\nBalanco\tde Materais\t\nOleo\t(7.)\t\u2022\t.lOOOD+Ol\t!\nGas\t(\u2019/.) !\t.lOOOD+Ol\t!\nAgua\t(7.)\t\u2019\t.lOOOD+Ol\t!\nRecup.\t(7.)\t!\t1.4777\nIP\t(m3/d/kg/cm2)!\t132.0135\nMapa de Press\u00e3o e Saturacao (Pressao, So e Sw)\nGRID CARTESIANO\nCamada 1\n!\n01\n02\n03\nf\ni\ni\ni\n3 !\ni\n29.7195 ! .87959 !\n\u25a0\n3o70119~! .87947 ! .12053 I\n30.3747 * .00000 !\n1.00000 !\n29.7191 ! .87952 !\n-\u00bf12048J 7oo\u00f5\u00f5~T .88000 ! .00000 !\n30.3742 ! .00000 !\n1.00000 !\n29.7195 ! .87959 ! .12041 !\n30.0119 ! .87947 I .12053 !\n30.3747 !\n.00000 }\n1.00000 !\nGRID RADIAL\nCamada 1\n03\ni\n02\nt\n01\ni\nt 1 ! i\t30.0073 ! .87933 ! .12067 !\t30.0091 ! .87950 ! .12050 !\t30.0108 I .87951 ! .12049 !\nI 2 i\t30.0046 \u2019 .87914 ! .12086 !\t29.9891 ! .87948 \u2018 .12052 !\t29.8637 ! .87966 I .12034 !\ni 3 ! i\t30.0073 > .87933 ! .12067 !\t30.0091 ! .87950 ! .12050 !\t30.0108 ! .87951 ! .12049 !\n\u2019\t30.0100\t! 4 !\t.87964\t1 !\t.12036 1\t30.0291 ! .87961 ! .12039 !\t30.1579 \u00bb .82825 ! .17175 !\nCamada 1\t\t\nBLOCO\tPRESS\u00c3O\tQoifk\tQw\u00ed.k\t\tRWO\n1=1 J\t(MPa)\t(m3/D)\t(m3/D)\t(m3/m3)\n1\t30.00733\t1.98917\t.00325\t.00163\n2\t30.00462\t1.98681\t.00426\t.00215\n3\t30.00733\t1.98917\t.00325\t.00163\n4\t30.01005\t1.99079\t.00173\t.00087\nTempo\tde execucao (\u00a1\tseg) =27\t\t\n13,2 Po\u00e7o com 100m de comprimento\nPROGRAMA ACTION.FOR\nSISI5iADQB_Pga!BgSEBYAIDBIQ_gQH!!5EQgD=HfiBIZQNTAI!\nTOTALMENTE IMPLICITO TRIDIMENSIONAL BI-FASICO ( OLEO/AGUA )\nEBIfi\u00c7I\u00a3\u00e2IS-D\u00e2DQS_UIILIZ\u00d4DOS\nParametros de Simulacao:\nRegi\u00e3o do reservat\u00f3rio - GRID CARTESIANO -X\nY\nZ\nX\nY\nZ\ndirecao direcao direcao direcao direcao direcao\nN# de blocos na N# de blocos na N# de blocos na Dim. dos blocos Dim. dos blocos Dim. dos blocos\nN. de blocos produtores\n(FIO.4)\n(FIO.4)\n(FIO.4) (13)\n(13) NXC==> (13) NYC\u2122> (13) NZC===> DBDX===> dbdy===> DBDZ===> NBP== >\n3\n3\n3\n100.00 50.00\n100.00\n1\nCoord, i do bloco produtor\t(13)\tIP===>\t2\nCoord, j do bloco produtor\t(13)\tJP===>\t2\nCoord, k do primeiro bloco produtor\t(13)\tKP===>\t1\nRegi\u00e3o do poco ~ GRID RADIAL -\t\t\t\nN# de blocos na direcao X\t(13)\tNX===>\t3\nN# de blocos na direcao Y\t(13)\tNY===>\t4\nN# de blocos na direcao Z\t(13)\tNZ===>\t1\nTime step inicial (dias)\t(F8.3)\tDT===>\t.001\nTolerancia para pressao (Pa) Tolerancia para saturacao (fr) Max var de sat num DT (fracao) Max var de pres. num DT (KPa) Vazao de oleo maxima (m3/dia) Vazao de oleo minima (m3/dia) Tempo final de simulacao (dias) Pwf minima no poco (MPa) Raio do poco (m)\nInt. tempo p/ impr.relatorio (dias) Int. tempo p/ impr.gr\u00e1fico (dias) Int. c\u00e9lulas de impressao Incremento de tempo m\u00e1ximo (dias) Incrementode tempo m\u00ednimo (dias) N# max de iteracoes no JACOBIANO N# min de iteracoes no JACDBIANO Fatia J base para o calculo de Pwf\nDados do teste de formacao:\nSimulacao de teste de formacao Vazao de producao (m3/dia) Tempo de fluxo (horas) Tempo de est\u00e1tica (horas) Incr. de tempo no teste (horas)\n(F8.3) T0LP===>3447.400\n(F6.4) T\u00dcLS===>\n(F6.4)DSLIM===>\n(F8.3)DPLIM===>\n(F8.3)qOMAX\u2014>\n(F8.3)qOMIN===>\n(F8.2) TSIM===> (F8.3)PWMIN===>\n(F8.4) RW=\u201c> (F5.1)TIMPR==~> (F5.1)TIMPG===> (I3)IRIMP===>\t1\n(F5.1)DTMAX===> (F6.4)DTMIN==->\n(13)ITMAX===> (I3)ITMIN===>\n(13)JPROD===>\n.0010 .0500 689.480 300.000\n15.000 5000.00\n30.000 .1000\n30.0\n10.0\n10.0 .0010\n5\n2\n1\n(s\nou N) OPT-\n(F8.3) (F8.3) (F8.3) (F8.3)\n>N QOTF===> tptf=\u2014> TETF===> DTTF===>\n50.000\n24.000\n72.000\n.500\nDados do reservat\u00f3rio:\nSaturacao inicial de agua (fracao) (F6.4) SWIN===> .1200 Densidade do gas (adim) Compressibilidade da rocha (1/MPa) Press\u00e3o inicial do reservat\u00f3rio(MPa) Temperatura do reservat\u00f3rio (\u00aeC) Raio externo da regi\u00e3o do poco (m) Cota do poco (m) Cota do contato o/w (m)\nPorosidade igual a\t.3000 para *\nPermeabilidade na direcao X igual a Permeabilidade na direcao Y igual a Permeabilidade na direcao Z igual a\n(F6.4) DGAS===>\n(E9.3) CR===>\n(F8.4) PRIN==>\n(F8.4) TEMP===>\n(F8.4) RE-==>\n(F8.3) ZC===>-2560.00\n(F8.3) ZC0W===>-2610..00 todos os blocos\ni\t50.0000\tpara\ttodos\tblocos\ni,\t50.0000\tpara\ttodos\tblocos\ni\t50.0000\tpara\ttodos\tblocos\n.8000 .440E-03 35.0000 90.0000\n39.894\nRESUMO DO TIME STEP 1\nTempo\t(dia)\t!\t.00100\nDt\t(dia)\t!\t.00100\nQo\t(m3/dia)\t1\t.3000D+03\nQg\t(m3/dia)\t!\t.6786D+05\nQw\t(m3/dia)\t!\t.OOOOD+OO\nRGO\t(m3/m3)\t!\t226.2000\nRWO\t(m3/m3)\t!\t.0000\nPwf\t(MPa)\t!\t34.5445\nNp\t(m3)\t!\t.3000D+00\nGp\t(m3)\t!\t.6786D+02\nWp\t(m3)\t!\t.00000+00\nBalanco\tde Materais\t\nOleo\t(*Z)\t\u25a0\t.1000D+01\t!\nGas\t\t.1000D+01\t!\nAgua\t(7.)\t!\t.1000D+01\t!\nRecup,\t(\u2022/.) !\t.0000\nIP\tCm3/d/kg/cm2)!\t184.1721\nMapa de Press\u00e3o e Saturacao (Pressao, So e Sw)\nGRID CARTESIANO Camada 1\n! 01 !\t\t02 \u2019\t03\tI\ni 3 ! i\t34.4088 ! .88000 ! .12000 !\t34.4088 ! .88000 \u2019 .12000 !\t34.4088 ! .88000 ! .12000 !\n1 2 I i\t34.7043 ! .88000 ! .12000 !\t,0000 \u2019 .88000 ! .00000 I\t34.7043 ! .88000 ! .12000 !\ni 1 ! f\t35.0000 ! .00000 ! 1.00000 !\t35.0006 ! .00000 \u2019 1.00000 I\t35.0000 ! .00000 ! 1.00000 !\nCamada 2\t\t\t\ni\t01 !\t02 !\t03\t!\nJ 3 ! i\t34.4088 ! .88000 ! .12000 \u00cd\t34.4088 ! .88000 ! .12000 !\t34.4088 ! .88000 ! .12000 \u2019\n1 2 1\t34.7043 ! .88000 ! .12000 !\t34.7040 ! .88000 ! .12000 !\t34.7043 ! .88000 ! .12000 !\ni 1 ! !\t35.0000 ! .00000 ! 1.00000 !\t35.0000 ! .00000 ! 1.00000 !\t35.0000 ! ,00000 ! 1.00000 !\nCamada 3\t\t\t\n! 01 !\t\t02 !\t03\tI\ni\t34.4088 !\t34.4088 !\t34.4088 !\n3 !\t.88000 !\t.88000 I\t.88000 !\ni\t.12000 !\t.12000 !\t.12000 !\n!\t34.7043\t!\n2 ! ,88000 !\nI .12000 !\n34.7043 ! .88000 ! .12000 !\n34.7043 ! .88000 ! .12000 !\n1 1 i 1\t'\t35.0000\t! i\t.00000\t! ' 1.00000 !\t35.0000 ! .00000 ! 1.00000 !\t35.0000 ! ,00000 ! 1.00000 !\nGRID RADIAL Camada 1\t\t\t\ni\t01 !\t02 !\t03\t!\ni\t!\t34.4538 !\t34.6498 !\t34.7039 !\n1 !\t!\t.87997 !\t.87999 \u2019\t.88000 !\ni\t!\t.12003 !\t.12001 !\t.12000 !\n3\t!\t34,4511 !\t34,6296 !\t34.5554 !\n2 !\t!\t.87997 !\t.87999 ! .12001 !\t.88000 !\ni\t1\t.12003 !\t\t.12000 !\n!\t!\t34.4538 ! !\t.87997 !\t34,6498 !\t34.7039 !\n3 !\t\t.87999 !\t.88000 !\ni\t!\t.12003 !\t.12001 }\t.12000 !\n\t! 34.4565 ! ! .87997 ! ! .12003 !\t34.6698 ! .87999 !\t34.8515 !\n4 !\t\t\t.88000 !\n1\t\t.12001 !\t.12000 !\nCamada 1\nBLDCD\tPRESSAC\t]\tQoj ,k\tQwj,k\tRWQ\n1 = 1 J\t(MPa)\t(\u00ae3/D)\t(m3/D)\t(m3/m3)\n1\t34.45381\t75.00000\t.00000\t.00000\n2\t34.45108\t75.00000\t.00000\t.00000\n3\t34.45381\t75.00000\t.00000\t.00000\n4\t34.45653\t75.00000\t.00000\t.00000\nRESUMO DO TIME STEP168\nTempo\t(dia)\t!\t30.05590\t!\nDi\t(dia)\t!\t.19462\ti\nQo\t(m3/dia)\t!\t.3000D+03\t1\nQg\t(m3/di a)\t!\t.6786D+05\t1\nQw\t(m3/dia)\tI\t.1017D+02\t1\nRGO\t(m3/m3)\t!\t226.2000\ti\nRWD\t(m3/m3)\t!\t.0339\t{\nPw\u00ed\t(MPa)\t!\t31.9132\tJ\nNp\t(m3)\t!\t. 9017D+04\tt\nGp\t(m3)\t!\t.2040D+07\t1\nwp\t(m3)\t!\t. 1401D+03\t1\nBalance\tde Materais\t\t\nOleo\t(X)\t!\t.1000D+01\tf\nGas\t(7.)\t\u2022\t.10\u00d40D+01\t1\nAgua\t(7.)\t\u25a0\t.1000D+01\t1\nRecup.\tCO\t!\t.6437\t\nIP\t(m3/d/kg/cm2)!\t43.9504\t\nMapa de Press\u00e3o e Saturacao (Pressao, So e Sw) GRID CARTESIANO\nCamada 1\n!\t01\t\u2018\t02\t!\t03\ni\n3 !\ni\n32.3138 !\n.87979 ! .12021 !\n32.2763 ! .87978 ! .12022 !\n32.3138 ! .87979 ! .12021 !\n*\t32.5826\tI\n2 !\t,87977\t!\n!\t.12023\t!\n.0000 !\t32.5826\t!\n.88000 !\t.87977\tI\n-00000 !\t.12023\t!\nI\t32.9601\t!\t32.9172\t!\n1\t!\t.00000\t!\t.00000\t!\n!\t1.00000\t!\t1.00000\t!\n32.9601 ! .00000 !\n1.00000 !\nCamada 2\n01\t1\t02\t\u2022\t03\ni 3 ! i\t32.3923 ! .87980 ! .12020 !\t32.3800 ! .87979 I .12021 !\ni 2 ! i\t32.6833 ! .87978 ! .12022 !\t32.6657 ! .87978 ! .12022 !\ni 1 ! i\t32.9898 ! .00002 ! .99998 !\t32.9807 ! .00000 ! 1.00000 !\n32.3923 ! .87980 ! .12020 !\n32.6833 !\n.87978 1\n.12022 !\n32.9898 ! .00002 ! .99998 !\nCamada 3\nf\t01 !\t02 !\t03\t!\ni 3 I 1\t32.4363 ! .87980 ! .12020 !\t32.4331 ! .87980 ! .12020 \u2019\t32.4363 ! .87980 ! .12020 !\nt 2 ! t\t32.7274 I .87979 ! .12021 !\t32.7239 I .87979 ! .12021 !\t32.7274 ! .87979 ! .12021 !\n1 1 ! i\t33.0153 ! .00229 ! .99771 !\t33.0126 ! .00206 ! .99794 !\t33.0153 ! .00229 ! .99771 !\nGRID RADIAL Camada 1\t\t\t\n!\t01 !\t02 !\t03\t!\n1 1 ! \u00ed\t32.0721 ! .87494 ! .12506 !\t32.2745 ! .87856 ! .12144 !\t32.4760 ! .87976 ! .12024 !\ni 2 ! i\t32.0693 ! .87975 ! .12025 !\t32.2540 ! .87976 ! .12024 !\t32.3256 ! .87979 ! .12021 !\ni 3 I t\t32.0721 ! .87494 ! .12506 !\t32.2745 ! .87856 \u2018 .12144 !\t32.4760 ! .87976 ! .12024 !\ni 4 ! i\t32.0748 1 .83972 ! .16028 !\t32.2947 ! .83030 ! .16970 !\t32.6238 \u2019 .79096 ! .20904 !\nCamada i\nPRESS\u00c3O\nQoj\nQwj,k\nBLOCO\n1=1\nJ\t(MPa)\t(m3/D)\t(\u00bb3/D)\t(m3/i\n1\t32.07208\t75.02146\t1.01680\t.01355\n2\t32.06926\t75.03504\t.05114\t.00068\n3\t32.07208\t75.02146\t1.01680\t.01355\n4\t32.07484\t74.92205\t8.08654\t.10793\nRWO\n___________RESUM0_D0_TIME_STEP316____\nTempo (dia)\tI\t60.12462\nDt\t(dia)\t!\t.43789\nQo\t(m3/dia)\t!\t. 2320D+03\t!\nQg\t(\u00ae3/dia)\t\u2019\t.5248D+05\t!\nQw\t(nt3/dia)\t!\t.1520D+02\t!\nRGO\t(m3/m3)\t!\t226.2000 !\nRWO\t(m3/m3)\t!\t.0655\t!\nPwf\t(MPa)\t!\t30.0170\t!\nNp\t(m3)\t\u2022\t. 1793D+05\t!\nGp\t(m3)\t!\t.4055D+07\t!\nWp\t(m3)\t!\t.5932D+03\t!\nBalance\tde Materais\t\nOleo\t(X)\t!\t. 1000D+01\t1\nGas\ty.)\t*\t.1000D+01\t!\nAgua\t(7.)\t!\t. 1000D+01\t!\nRecup.\t(X)\t!\t1.2800\nIP\t(m3/d/kg/cm2)!\t44.5924\n\tMapa de Pressao\te Saturacao (Pressao, So e Sw)\nGRID CARTESIANO\nCamada 1\n01 I 02\t!\t03\n\u00ed 3 \u00ed \u00ed\t30.2545 ! .87960 ! .12040 !\t30.2246 ! .87957 ! .12043 !\t30.2545 ! .87960 ! .12040 !\ni 2 ! i\t30.5272 ! .87953 ! .12047 !\t.0000 ! .88000 ! .00000 !\t30.5272 ! .87953 ! .12047 !\ni 1 ! i\t30.9030 1 .00000 ! 1.00000 !\t30.8712 ! .00000 ! 1.00000 !\t30.9030 ! .00000 ! 1.00000 !\nCamada 2\n01\t!\t02\t!\t03\t!\n30.3218 ! .87961 1 .12039 !\t30.3113 ! .87961 ! .12039 !\t30.3218 ! .87961 ! .12039 \u00bb\n30.6122 ! .87955 ! .12045 !\t30.5969 ! .87955 ! .12045 !\t30.6122 \u2019 .87955 ! .12045 !\n30.9247 ! .00002 ! .99998 !\t30.9179 ! ,00000 ! 1.00000 !\t30.9247 ! .00002 ! .99998 !\nCamada 3\n01\t!\t02\t!\t03\n30.3619 ! .87961 ! .12039 !\t30.3591 ! .87961 ! .12039 !\t30,3619 ! .87961 ! .12039 !\n30.6531 ! .87956 ! .12044 !\t30.6501 ! .87956 ! .12044 !\t30.6531 ! .87956 \u2019 .12044 \u2018\n30.9426 ! .00427 ! .99573 !\t30.9404 ! .00380 ! .99620 !\t30.9426 ! .00427 ! ,99573 !\nGRID RADIAL\nCamada 1\n01 !\t02 !\t03\t!\n30.1338 !\t30.2868 !\t30.4426 !\n.86201 !\t.87088 !\t.87954 !\n.13799 !\t.12912 !\t.12046 !\n30.1313 !\t30.2672 !\t30.2940 !\n.87803 !\t.87957 !\t.87964 !\n.12197 !\t.12043 !\t.12036 !\n30.1338 !\t30.2868 \u2018\t30.4426 !\n.86201 !\t.87088 !\t.87954 !\n.13799 !\t.12912 !\t,12046 !\n30.1361 I\t30.3043 !\t30.5876 !\n.81679 !\t.79437 !\t.71263 !\n.18321 !\t.20563 !\t.28737 !\nCamada 1\nBLQCO\tPRESSA\u00dc\t\tQoj,k\tQwi.k\tRWO\n1=1 J\t(MPa)\t(m3/D)\t(m3/D)\t\t(m3/m3)\n1\t30.13384\t58.05285\t2.69940\t.04650\n2\t30.13128\t58.16289\t.29044\t.00499\n3\t30.13384\t58.05285\t2.69940\t.04650\n4\t30.13610\t57.72554\t9.50680\t.16469\nRESUMO DO TIME STEP351\t\t\nTempo\t(dia)\t!\t89.70982\t!\nDt\t(dia)\ti\t2.21684\t!\nQo\t(m3/di a)\t\u2019\t.1480D+02\t!\nQg\t(m3/d i a)\t!\t.3349D+04\t!\nQw\t(m3/dia)\t!\t.1005D+00\t!\nRGO\t(\u00ae3/m3)\t\u2019\t226.2000 !\nRWO\t(m3/m3)\t!\t.0068 !\nPwf\t(MPa)\tI\t30.0170\t!\nNp\t(m3)\t!\t.2019D+05\t!\nGp\t(m3)\t!\t.4568D+07\t!\nwp\t(m3)\t!\t.6893D+03\t!\nBalance\tde Materais\t\nOleo\t(X)\t*\t. 1000D+01\t\u2019\nGas\t(7.)\t!\t. 10Q0D+01\t!\nAgua\t(7.)\t1\t. 1000D+01\tI\nRecup.\t(7.)\t\u25a0\t1.4418\nIP\t(m3/d/kg/cm2)!\t39.1183\nMapa de Press\u00e3o e Saturacao (Pressao, So e Sw)\nGRID CARTESIANO\nCamada 1\ni\t01 !\t02 !\t03\t!\n3 ! i\t29.7628 ! .87959 ! .12041 !\t29.7608 ! .87953 \u2019 .12047 !\t29.7628 ! .87959 I .12041 !\ni 2 ! t\t30.0541 ! .87946 ! .12054 !\t.0000 ! .88000 ! .00000 !\t30.0541 ! .87946 ! .12054 !\ni 1 !\t30.4361 ! .00000 !\t30.4344 ! .00000 !\t30.4361 ! .00000 !\n! 1.00000 ! 1.00000 ! 1.00000 \u2019\nCasada 2\n!\t01 !\t02 !\t03\t!\ns 3 i\t29.7679 ! .87959 ! .12041 *\t29.7674 ! .87959 ! .12041 !\t29.7679 ! .87959 ! .12041 !\n1 2 I F\t30.0605 ! .87948 ! .12052 !\t30.0599 ! .87947 ! .12053 !\t30.0605 ! .87948 ! .12052 !\n1 1 ! s\t30.4371 ! .00002 1 .99998 1\t30.4367 ! .00000 ! 1.00000 !\t30.4371 ! .00002 ! .99998 \u2019\nCassada 3\n01\n02\n03\n!\t29.7711\t\u00bb\n3 f .87959 !\nI .12041 !\n29.7709 !\n.87959 !\n.12041 !\n29.7711 !\n.87959 !\n.12041 !\n30.0638 t\n.87948 I\n.12052 !\n30.0637 ! .87948 !\n.12052 !\n30.0638 I .87948 ! .12052 i\ni\n2 ! t\n1 ! s\n30.4377 \u2018 .00436 ! .99564 !\n30.4376 ! .00386 ! .99614 !\n30.4377 ! .00436 ! .99564 \u2018\nGRID RADIAL\nCamada 1\ni\n01\ns\n02\ni\n03\nt\ni\n3 !\ni\ni\n2 !\ni\ni\n4 ! i\n30.0258 ! .87748 ! .12252 !\t30,0370 ! .87730 ! .12270 !\t30.0482 ! .87949 ! .12051 !\n30.0232 ! .87926 ! .12074 \u00bb\t30.0171 ! .87950 ! .12050 !\t29.9010 ! .87968 ! .12032 !\n30.0258 ! .87748 ! .12252 1\t30.0370 \u2022 .87730 ! .12270 !\t30.0482 ! .87949 ! .12051 !\n30.0285 ! .87550 ! .12450 !\t30.0566 ! .86638 ! .13362 !\t30.1952 ! .69598 ! .30402 !\nCamada 1\nBL0C0\tPRESSAO\tQoj,k\tQwi,k\t\t\tRWO\n1 = 1 J\t(MPa)\t(m3/D)\t(m3/D)\t(m3/m3)\n1\t30,02585\t3.70475\t.02511\t.00678\n2\t30.02316\t3.71582\t.00738\t.00199\n3\t30.02585\t3.70475\t.02511\t.00678\n4\t30.02851\t3.67845\t.04289\t.01166\nTempo\tde execucao\t(seg) =2641\t\t\nNeste anexo \u00e9 apresentada a listagem do programa computacional, em linguagem FORTRAN, para o modelo totalmente acoplado. Este programa e os demais desacoplados, assim como os arquivos de exemplos de dados de entrada e de saldas, encontram-se arquivados no Departamento de Engenharia de Petr\u00f3leo da Faculdade de Engenharia Mec\u00e2nica da UNICAMP.\nNo total s\u00e3o tr\u00eas programas em linguagem FORTRAN:\nL Modelo totalmente acoplado\nPrograma ACTIOW.FOR.\n2.\tModelo desacoplado com acoplamento na itera\u00e7\u00e3o\nPrograma ACOOWLFOR\n3.\tModelo desacoplado com acoplamento no iime-slep\nPrograma ACOOWTS.FOR\nUNIVERSIDADE ESTADUAL DE CAMPINAS - UNICAMP MESTRADO EM ENGENHARIA DE PETROLEO - TURMA 1989\nSIMULADOR DE RESERVAT\u00d3RIO COM POCO HORIZONTAL\nAUTOR: JOSE ADILSON TENORIO GOMES\nPROGRAMA ---- ACTIDW.FOR (totalmente acoplado)\nCARACTERISTICAS DO PROGRAMA\n*\n*\n*\n*\n*\n*\n*\n*\nLinguagem FORTRAN;\nSimula o comportamento de um reservat\u00f3rio retangular produzindo atrav\u00e9s de um poco horizontal, usando refinamento local, ou seja, a regiao do poco e representada por uma malha cilindrica e a regiao do reservat\u00f3rio por uma malha cartesiana;\nRegioes totalmente acoplados - resolvidas simultaneamente no mesmo Jacobiano;\nTridimensional;\nBif\u00e1sico - oleo/agua;\nTotalmente impl\u00edcito;\nFluidos inicialmente em\nA matriz jacobiana pode\n-\tm\u00e9todo direto usando\n-\tm\u00e9todo direto usando\n-\tm\u00e9todo iterativo\nequilibrio gravitacional;\nser resolvida das seguintes formas: eliminacao de Gauss algoritmo otimizado (NSPIV)\nBSOR\nArquivas de entrada Entrada\n1 :\n2 ;\n3\t:\nSAIDA\n4\t:\n(PVTW.DAT)\n(PETRDW.DAT) -\n(ACTIDW.DAT) -\n(ACTION.REL) -\ne saida :\n5 :\n7\t:\n8\t:\n9 :\n11:\n12:\n(ACTIO1.DAT) -\n(ACTI02.DAT) -\n(ACTIO3.DAT) -\n(ACTI04.DAT) - saida (PHTEST.REL) - saida (PHTEST.DAT) - saida\ndados de analises PVT\ndados de analises petrofis\u00edcas\ndados gerais de reservat\u00f3rio e de simulacao\nRelatorio geral, com balan\u00e7o de materiais de saturacao saida saida saida\npara para para para para para\nresultados da producao, e mapas\n(tempo, (tempo,\n(tempo,\n(perfil de teste de formacao\nde pressao e\nQo> Qw, Qg, Pwf)\nNp, Wp)\nRWD, RGO) veri de saturacao)\nC~ c c c c c c c c c c c c c c c c c c c-c c c c c c c c c c c c c c c c c c c c c\nc c c c c c c c c c c c c c c c c c~\n$system\nIMPLICIT DOUBLE PRECISI0N(A-H,0~Z)\nPARAMETER(NLAB=18,NXM=08,NYM^OB,NZM-04,PI-3.141592654D0) C Dados PVT e petrofisica\nCOMMON/LPETR/SWL,KRWL,KROL,SLL,PCOWL, NKR,NPC\nC Parametros de simulacao e de producao\nCOMMON/NCEL/DBDX,DBDY,DBDZ,WRC,NBLOC,NXC,NYC,NZC,NBP,\n*\tNXR,NYR,NZR,NQL,NQS,NQI,IP,JP,KP\nCOMMON/SIM/DT,DTMAX,DTMIN,TOLP,TOLS,DSLIMfDPLIM,TSIM,\n*\tQOMAX,QOMIN,PWMIN,BSOR,JPROD,MSDLU,ITMAX,ITMIN C Dados do reservat\u00f3rio\nCOMMON/RES/DGAS,CR,PRIN tTEMP,ZC,RW tRE,SHIN,PHI,PERX,PERY,\n*\tPERZ,ZCOW,INDPOR,INDPER\nC Dados de impress\u00e3o\nCOMMON/IMP/TIMPR,TIMPG,IRIMP\nC Dados do teste de formacao\nCOMMON/TFR/QOTF,TPTF,TETF,DTTF,DTI,TFLUX,BETA,OPT\nC Variavais da malha\nCOMMON/MALHA/ZB,RB,VPDR,DRO,WX,WY,WZ,FFX,FFY,FFZ,DTETA\nC Variaveis do passo de tempo n\nCOMMON/TSA/POA,SOA,SGA,SWA\nCOMMON/PVTA/BOA,RSDA,BWA\nC Variaveis do passo de tempo n+1\nCOMMON/TS/PO,SO,SG,SW\nCOMMON/PVT/BO,DBO,VO,DVO,DO,DDO,RSO,DESO,BW,DBW,VW,DVW,DW,DDW,CW C Variaveis das interfaces X e Y\nCOMMON/IFACEX/BOMX,VOMX,DOMX,BWMX,VWMX,DWMX\nCOMMON/IFACEY/BOMY,VOMY,DOMY,BWMY,VWMY,DWMY\nCOMMON/IFACEZ/BOMZ,VOMZ,DOMZ,BWMZ,VWMZ,DWMZ\nC Valores de perm, relativas ,press\u00f5es capilares e suas derivadas COMMON/PETR/KRO,KRW,DKRO,DKRW,PC,DPC\nC Valores de transmissibilidades e suas derivadas (faces X e Z) COMMON/DTRANS/TOX,TWX,TOY,TWY,TOZ,TWZ,\n*\tTDX1SA,TOX1SI,TWX1SA,TWX1SI,\n*\tT0X2SI,T0X2SP,TWX2SI,TWX2SP,\n*\tTOY1SA,TOY1SI,TWY1SA,TWY1SI,\n*\tT0Y2SI,T0Y2SP,TWY2SI,TWY2SP,\n*\tTOZlSAjTOZlSI,TWZ1SA,TWZ1SI,\n*\tT0Z2SI,T0Z2SP,TWZ2SI,TWZ2SP\nC Vaz\u00f5es e suas derivadas, press\u00e3o de fluxo tempo\nCOMMON/VAZAO/QO,qOT,QG,QGT,qW,QWT,DQOP,DqOS,\n*\tDQWP,DQWS,RWO,RGO,PWF,TEMPO C Volumes acumulados\nCOMMON/ACUM/qOAC,QGAC,QWAC,VOORR,VWORR,VOORC,VWORC,BNPR,BWPR,\n*\tBNPC,BWPC,PWFA\nC Matriz jacobiana e vetores solucao e independente\nCOMMON/SEQS/XR,XC\nC\nDIMENSION POL(NLAB),BOL(NLAB),V0L(NLAB),DOL(NLAB),RSOL(NLAB),\n*\tPOLS(NLAB),BOLS(NLAB), VOLS(NLAB),DDLS(NLAB)\nDIMENSION PWL(NLAB),BWL(NLAB),VWL(NLAB),DWL(NLAB),RSWL(NLAB)\nDIMENSION PGL(NLAB),BGL(NLAB),VGL(NLAB),DGL(NLAB)\nDIMENSION SWL(NLAB),SLL(NLAB),PCOWL(NLAB)\nREAL*8 KRWL(NLAB),KROL(NLAB)\nC DIMENSION PHI(NXM,NYM,NZM,2),PERX(NXM,NYM,NZM,2),\n*\tPERY(NXM,NYM,NZM,2),PERZ(NXM,NYM,NZM,2)\nDIMENSION ZB(O:NXM+1,NYM,2),RB(NXM+1),VPOR(NXM,NYM,NZM,2),\n*\tFFX(NXM+1,NYM,NZM,2),FFY(NXM+1,NYM,NZM,2),\n*\tFFZ(NXM+1,NYM,NZM+1,2),DTETA(NYM+1)\nDIMENSION POA(NXM,NYM,NZM,2),SOA(NXM,NYM,NZM\u201e2),\n*\tSGA(NXM,NYM,NZM,2),SWA(NXM,NYM,NZM,2)\nDIMENSION BOA(NXM,NYM,NZM,2),BWA(NXM,NYM,NZM,2)\nDIMENSION PO(O:NXM+i,0:NYM+1,0:NZM+1,2),SO(NXM,NYM,NZM,2),\n*\tSG(NXM , NYM,NZM,2),SW(NXM,NYM , NZM,2)\nDIMENSION B0(NXM,NYM,NZM,2),DBO(0;NXM+1,0:NYM+1,0;NZM+1,2),\n*\tV0(NXM,NYM,NZM,2),DV0(0:NXM+l,0:NYM+1,0:NZM+1,2),\n*\tDO(NXM,NYM,NZM,2),DDO(O:NXM+1,0:NYM+1,0:NZM+1,2),\n*\tBW(NXM,NYM,NZM,2),DBW(0:NXM+1,0:NYM+1,0:NZM+1,2),\n*\tVW(NXM,NYM,NZM,2),DVW(0:NXM+1,0:NYM+1,0:NZM+1,2),\n*\tDW(NXM,NYM,NZM,2),DDW(O:NXM+1,0:NYM+1,0;NZM+1,2),\n*\tCW(NXM,NYM,NZM,2)\nDIMENSION BOMX(O:NXM+1,NYM,NZM,2),VOMX(O:NXM+1,NYM,NZM,2) ,\n*\tDOMX(0:NXM+1,NYM,NZM,2),BWMX(0:NXM+1,NYM,NZM,2),\n*\tVWMX(0:NXM+1,NYM,NZM,2),DWMX(O:NXM+1,NYM,NZM,2) DIMENSION BOMY(NXM,NYM+1,NZM,2),V0MY(NXM,NYM+l,NZM,2),\n*\tDOMY(NXM,NYM+1,NZM,2),BWMY(NXM,NYM+1,NZM,2),\n*\tVWMY(NXM,NYM+1,NZM,2),DWMY(NXM,NYM+1,NZM,2)\nDIMENSION B0MZ(NXM,NYM,NZM+l,2),V0MZ(NXM,NYM,NZM+l,2),\n*\tDOME(NXM,NYM,NZM+1, 2),BWMZ(NXM,NYM,NZM+1,2),\n*\tVWMZ(NXM,NYM,NZM+1,2),DWMZ(NXM,NYM,NZM+1,2)\nDIMENSION DKRO(NXM,NYM,NZM,2),DKRW(NXM,NYM,NZM,2),\n*\tPC(O:NXM+1,0;NYM+1,0:NZM+1,2),DPC(O:NXM+1,0:NYM+1,0:NZM+1,2)\nREAL*8\tKRO(NXM,NYM,NZM,2),KRW(NXM,NYM,NZM,2)\nDIMENSION T0X(NXM+l,NYM,NZM,2),TWX(NXM+1,NYM,NZM,2),\n*\tTOXISA(NXM,NYM,NZM,2),TOX1SI(NXM,NYM,NZM,2),\n*\tTWX1SA(NXM,NYM,NZM,2),TWX1SI(NXM,NYM,NZM,2),\n*\tT0X2SI(NXM,NYM,NZM,2),T0X2SP(NXM,NYM,NZM,2),\n*\tTWX2SI(NXM,NYM,NZM,2),TWX2SP(NXM,NYM,NZM,2)\nDIMENSION TOY(NXM,NYM+1,NZM,2),TWY(NXM,NYM+1,NZM,2),\n*\tTOY1SA(NXM,NYM,NZM,2),TOY1SI(NXM,NYM,NZM,2),\n*\tTWY1SA(NXM,NYM,NZM,2),TWY1SI(NXM,NYM,NZM,2),\n*\tT0Y2SI(NXM,NYM,NZM,2),T0Y2SP(NXM,NYM,NZM,2),\n*\tTWY2SI(NXM,NYM,NZM,2),TWY2SP(NXM,NYM,NZM,2)\nDIMENSION TOZ(NXM,NYM,NZM+1,2),TWZ(NXM,NYM,NZM+1,2),\n*\tT0ZiSA(NXM,NYM,NZM,2),T0ZlSI(NXM,NYM,NZM,2),\n*\tTWZISA(NXM,NYM,NZM,2),TWZ1SI(NXM,NYM,NZM,2),\n*\tT0Z2SI(NXM,NYM,NZM,2),T0Z2SP(NXM,NYM,NZM,2),\n*\tTWZ2SI(NXM,NYM,NZM,2),TWZ2SP(NXM,NYM,NZM,2)\nDIMENSION XR(NXM*NYM*NZM*2),XC(NXM*NYM*NZM*2)\nDIMENSION QO(NYM,NZM),QG(NYM,NZM),QW(NYM,NZM),DQOP(NYM,NZM),\n*\tDQOS(NYM.NZM),DQWP(NYM,NZM),DQWS(NYM,NZM) integer*4 STOPW,in\nCHARACTER*1 OPT\nLOGICAL TESTE,VPWF,CONV,VDS\nC abertura dos arquivos\nOPEN(UNIT=1,FILE- >PVTW.DAT > ,STATUS-\u2019OLD >) OPEN(UNIT=2,FILE->PETROW.DAT\u2019,STATUS-\u2019OLD\u2019) 0PEN(UNIT=3,FILE=\u2019ACTION.DAT\u2022,STATUS-\u2019OLD\u2019) 0PEN(UNIT=4,FILE-\u2019ACTION.RELSTATUS-\u2019UNKNOWN\u2019) OPEN(UNIT-5,FILE-\u2019ACTI01.DAT\u2019,STATUS- >UNKNOWN1) 0PEN(UNIT=7,FILE=\u2019ACTI02.DAT1,STATUS\u00bb\u2019UNKNOWN\u2019) 0PEN(UNIT=8,FILE\u00bb1ACTI03.DAT*,STATUS\u00bb* UNKNOWN >) OPEN(UNIT-9,FILE-\u2019ACTI04.DAT\u2019,STATUS-\u2019UNKNOWN>) DPEN(UNIT=11,FILE->PRIEST.REL1,STATUS-'UNKNOWN1)\no nao ct nn a a oa oaa o no\taaaanoa\n0PEN(UNIT=12,FILE-\u2019PHTEST. DAT\u2019,STATUS='UNKNOWN')\nPROGRAMA PRINCIPAL\nLeitura dos dados\nin=_STOPW(0)\nCALL ENTRA\nIF(MS0LU.EQ.3) THEN\nwrite(*,*)'Entre com bsor (1 a 2)'\nread(*,*)BS0R\nENDIF\nCALL IMPDE\nConvers\u00e3o das unidades lidas para o sistema S.I.\ncall\u2019c\u00d5nv\u00dcn\u00cd\t\u2019 \u2019 ~~\nInicializacao de variaveis\n___CALL INICIA\t\u2019\t\u201d\nLan\u00e7amento da malha e calculo das cotas dos pontos, fatores de forma e ponderadores\nc\u00c3ll~grid\t~\t~\nCalculo das press\u00f5es e satura\u00e7\u00f5es de agua iniciais\nCALL PRESSO (PWF)\nInicializacao das satura\u00e7\u00f5es das fases nos blocos Calculo do volume porose inicial dos blocos\n$\nNX=NXR\nNY=NYR\nNZ=NZR DO 5 1=1,2\nIF(L.EQ.2) THEN\nNX=NXC\nNY=NYC\nNZ=NZC\nENDIF\nDO 5 1=1,NX\nDO 5 J=1,NY DO 5 K=1,NZ\nIF\u00cdL.EQ.2) THEN AUX=PHI(I,J,K,L)*(1.0D0-CR*P0A(I,J,K,L)) VPOR\u00cdI,J,K,L)=AUX*DBDX*DBDY*DBDZ IF(I.EQ.IP.AND.l,EQ.JP.AND.K.GE.KP.AND.K.LT.KP+NBP)\n\u2018\tVPOR(I,J,K,L)=O.ODO\nELSE AUXl=RW*RW*DBDZ/2.0D0 AUX=PHI(I,J,K,L)*(1.ODO-CR*POA(I,J,K,L))\nVP0R(I,J,K\u00edL)=(DEXP(2.0D0*I*DR0))-(DEXP(2.0D0*(I-l)*DR0)) VP0R(I,1,K,L)=VP0R(I,J,K,L)*AUX*AUX1*DTETA(I)\nENDIF\nS0A(I,J,K,L)=1.ODO-SWA(I,J,K,L)\nSGA(I,J,K,L)=O.ODO P0(I,J,K,L>P0A(I,J,K,L) SO(I,J,K,L)=SOA(I,J,K,L) SG(I,J,K,L)=SGA(I,J,K,L) SW(I,J,K,L)=SWA(I,J,K,L)\na o no Q no ci n on noon can\tn on o on an\tn an\tci an o on\n5 CONTINUE\nCalculo dos volumes originais de oleo e agua\nCALL RESERV\nImpress\u00e3o dos cabe\u00e7alhos para os arquivos do gr\u00e1ficos\nWRITE(5,10)\nWRITE(7,15)\nWRITE(8,16)\n10\tFORMAT\u00cd\u2019TEMPO(dias) *MPa)*)\tQ0(m3/dia)\tQW(m3/dia)\tQg(m3/dia)\n15\tFORMAT(\u2019TEMPO(dias)\tNP(m3)\tWP(m3)\tGP(m3)\u2019)\n16\tFORMAT(\u2019TEMPO(dias)\tRWD(m3/m3)\tRG0(m3/m3)\u2019:\t)\nInic. de producoes de oleo, gas e agua acumuladas, do tempo e de pwf\nQOAC=O.0D0\nQGAOO. 0D0\nQWAC-0.0D0\nQOT-QOMAX\nPWFA=PWF TEMP0=0.0D0\nInicializacao de variaveis de contraole de impress\u00e3o, contador de passos de tempo e de outras var. de controle do processo iterativo\nITR=0\nITG-0\nNTS-0\niniciar com vazao constante\nVPWF=.TRUE.\n---> vpwf=.true.\nOpcao para teste de formacao\nIF((OPT.EQ. \u2019S\u2019).AND.(TETF.NE.0.0) .AND. (DTTF.NE.O.O)) THEN 0PT='P\nTESTE=.TRUE.\nDTI=DT\nTEMPTF=0.ODO\nCALL CTESTE(TESTE,NTS,DT,QOMAX,TEMPTF,NITER)\nELSE\nTESTE=.FALSE.\nENDIF\nInicio de um time-step - Ponto de retorno apos cada DELTA-T\nGRID RADIAL\nGRID RETANGULAR\n---> --->\nL-l\nL=2\n500\nNTS=NTS+1\nNITER-1\nCalculo das propriedades dos fluidas dependentes das press\u00f5es na iteracao anterior (passo de tempo n)\nCALL FPOA\nPonto de retomo no processo iterativo dentra de uma iteracao no tempo\n400 CONTINUE\nCalculo das propriedades dos fluidos dependentes das press\u00f5es na iteracao atual e das press\u00f5es nas interfaces\nanoa aa\to ao n\ta\ta ao a ao n n aan\nCALL FPPOMCPWF^X\u2019WY.WZ)\nVerificacao do sentido de fluxo entre os blocos e calculo das transmissibrlidades das fases nas interfaces dos blocos peloiAS PELO esquema \"one point upsteam\" e de suas derivadas em relacao a Sw\nCALL TRANS\nCalculo das vazoes de oleo e agua e de suas derivadas\nIF(VPWF) THEN\nVazao de oleo constante -> calculo da pressao pwf no poco\n*\n*\npara pwf\nSUMT=0.ODO\nDO 90 1=1,NYR\nDO 90 K=1,NZR\nSUMT=SUMT+TOX(1, J, K, 1)\nCONTINUE\nDO 91 J=1,NYR\nDO 91 K=1,NZR\nQO(J,K)=QOT*TOX(1,J,K,1)/SUMT\nCONTINUE\nPWF=PO(1,JPROD,1,1)-DOMX(1,JPROD,1,1)*(ZC-ZB(1,JPROD, 1) ) -Q0(JPROD,1)/TOX(1,JPROD,1,1)\nDO 80 J=1,NYR\nDO 80 K=1,NZR\nDQOP(J,K)=O.ODO\nDQ0S(J,K)=0.0D0\nCONTINUE\nIF((PWF.LT.1.001D0*PWMIN).AND.(PWF.GT.0.999D0+PWMIN))\nVPWF=.FALSE.\ngravar\" com pwfmin\nIF(PWF.LE.0.999D0*PWMIN) THEN\nDT=DT/2.0D0\nCALL REPTS(NTS,PWFA,PWF)\nGOTO 500\nENDIF\nENDIF\nit\nIF(.NOT.VPWF) THEN\nVazao de oleo varialve -> calculo de Qo e sual derivadas\n60\nQOT-O.ODO\nDO 60 J=1,NYR\nDO 60 K=1,NZR\nPQT=PO(1,J,K,1)-PWF~DOMX(1,J,K,1)*(ZC-ZB(1, J,1)) QO(J,K)=TOX(1,J,K,1)*POT\nDQOP(J,K)=-WX*TOX(1,J,K,1)*(DVO(1,J,K,1)/VOMX(1,J,K,1)-\nDBO(1,J,K,1)/BOMX(1,J,K,1))*POT+(1.ODO-WX* DDO(1,J,K,1)*(ZC-ZB(1,J,1)))*TOX(1,J,K,1) DQOS(J,K)=POT*TOXlSI(i,J,K,l)\nQOT=QOT+QO(J,K)\nCONTINUE\nENDIF\nCalculo da vazao de agua e gas e suas derivadas\nQw=Qo*(mobilidade agua),suas derivadas existem\nQg=Qo*Rs ( considerando que nao havera gas livre no reservat\u00f3rio ) Razao de solubilidade na pressao de saturacao\nn Qa o n o \u00f4 oo o a on\nQWT=0.0D0\nQGT-0.ODO\nDO 70 j=i,m DO 70 K-l.NZR RMWO=(KRW(1,JJK,1)*BW(1,J>K,1)*VO(1,J,K,1))/\n*\t(KRO(1, J,K,1) *BO(1,J,K, 1)*W(1,J,K, 1)) QW(J,K)=QO(J,K)*RMWQ AUX=DVO(l,J,K,l)/VO(l,J,K,l)-DBO(i,J,K,l)/BO(l,J,K,i)-\n*\tDVW(l,J,K4)/VW(l.JtK,l)+DBW(l>J,K,l)/BW(l,J,K,i) DQWP(J,K)=RMW0*(AUX*QO(J,K)+DQOP( J, K) )\nAUX=DKRW(1, J,K,1)\u201cKRW(1, J,K,l)*nKRO(l, J,Kfl)/KRO(l,d,K,l)\nAUX=AUX*BW(l,JJK,l)*VO(\u00ed,JJK,l)/(KRO(lJJ,KJl)*\n*\tBO(\u00cd,J,K,l)*VW(l,J,K,i))\nDQWS(J jK)=RMWO*DQOS(J,K)+AUX*QO(J,K)\nQWT=QWT+QW(J,K) QG(J>K)=QO(JJK)*RSS QGT=QGT+QG(J,K)\n70 CONTINUE\nIF(qOT.NE.O.ODO) RWO=QWT/QOT\nIF(QOT.NE.O.ODO) RGO=qGT/QOT\nCalculo das funcoes de res\u00edduos do oleo e da agua e de suas derivadas para a montagem da matriz Jacobiana\nCALL MONJAC\nSolucao do sistema linear de equa\u00e7\u00f5es\n1- por m\u00e9todo direto usando Gauss\n2~ por m\u00e9todo direto usando algoritmo otimizado (NSPIV)\n3- por matodo iterativo (BSOR)\nIF(MSOLU.EQ.l) CALL SOLVEI\nIF(MS0LU.EQ.2) CALL S0LVE2\nIF(MSOLU.EQ.a) CALL S0LVE3\n\u00c2tualizacao dos valores de press\u00e3o e saturacao\nNC~\u00d5\nLC-0\nDO 20 I=1,NXC DO 20 >1,NYC\nD0 20 K^ljNZC\nIF(I.EQ.IP.AND.J.EQ.JP.AND.K.GE.KP.AND.K.LT.KP+NBP) GOTO 20 NC=NC+1\nLC=2*NC-1\nPD(I,J,K,2)=P0(I,J,K\u00cd2)+XC(LC) SW(I,J,K,2)=SW(IJJ,K,2)+XC(LC+1)\nIF(SW(I,J,K,2).GT.1.0D0) SW(I,J,K,2)\u00ab1.0D0 IF(SW(I,J,K,2).LT.SWIN) SW<I,J,K,2)=SWIN SO(ItJ,K,2X.ODO-SW(I, J,K,2)\n20 CONTINUE\nNC-0\nLC=0\nIF(SW(I,J,K,1).GT.1.ODO) SW(I,J,K,1)=1.ODO\nIF(SW(I, J,K, 1) .LT.SWIN) SW(I, J,K,1)=SWIN\na on\tn a an\n21\nSO(I,J,K,1)=1.ODO-SW(I,J,K,1)\nCONTINUE\nAanlise da converg\u00eancia\nVerificacao dsa varia\u00e7\u00f5es da saturacao e pressao\nCONV=.TRUE.\nNC=O\nLC=0\nDO 25 1=1,NXC\nDO 25 J=1,NYC DO 25 K=1,NZC\nIF(I.EQ.IP.AND.J.EQ.JP.AND.K.GE.KP.AND.K.LT.KP+NBP) GOTO 25\nNC=NC+1\nLC=2*NC-1\nIF(DABS(XC(LC)).GT.TOLP) CONV=.FALSE. IF(DABS(XC(LC+1)).GT.TOLS) C0NV=.FALSE.\n25\tCONTINUE\nNC=0\nLC=O\nDO 26 1=1,NXR\nDO 26 J=1,NYR\nDO 26 K=1,NZR\nNC=NC+1\nlc=2*lc-i\nIF(DABS(XR(LC)).GT.TOLP) CONV=,FALSE, IF(DABS(XR(LC+1)).GT.TOLS) CONV=.FALSE.\n26\tCONTINUE\nIF(CONV) THEN\nwrite(*,*)* dt=\u2019,dt/86400.0,1 tempo=J,tempo/86400.0\nDeterminacao das maximas variacoes de sat. e pr. no passo de tempo\n30\nVDS=.TRUE.\nDS=O.ODO\nDP=O.ODO\nDO 30 1=1,NXC\nDO 30 J=1,NYC\nDO 30 K=1,NZC\nIF(I.EQ.IP.AND.J.Eq.JP.AND.K.GE.KP.AND.K.LT.KP+NBP) GOTO 30\nAUX\u00abDABS(S0(I,J,K,2)-S0A(I,J,K,2)) IF(AUX.GT.DS) DS=AUX\nAUX=DABS(SW(I,J,K,2)-SWA(I,J,K,2)) IF(AUX.GT.DS) DS=AUX\nAUX=DABS(P0(I,J,K,2)-P0A(I,J,K,2))\nIF(AUX.GT.DP) DP=AUX\nCONTINUE\nDO 31 1=1,NXR\nDO 31 ...... .\nDO\nJ=1,NYR\n31 K=1,NZR\nAUX=DABS(SO(I,J,K,1)~SOA(I,J,K,1)) IF(AUX.GT.DS) DS=AUX\nAUX=DABS(SW(I,J,K,1)-SWA(I,J,K,1))\nIF(AUX.GT.DS) DS=AUX\nAUX=DABS(PO(I,J,K,1)-POA(I,J,K,1))\nIF(AUX.GT.DP) DP=AUX\n1.2D0*DSLIM) VDS=.FALSE.\nn no\tc\u00a1 on\ta aa\ta an\to o\nDS=DSLIM/DS\nDP=DPLIM/DP\nIF(DP.LE.DS) THEN DT=DT*DP\nELSE\nDT=DT*DS\nEND IF\nCALL REPTS(NTS,PWFA,PWF)\nEND IF\nGDTD 500\nSe chegou-se ate esse ponto tem-se um passo de tempo bem sucedido\nDO 35 L=l,2\nNX=NXR\nNY=NYR\nNZ=NZR\nIF(L.EQ.2) THEN\nNX=NXC\nNY=NYC\nNZ=NZC ENDIF DO 35\nDO\n*\n*\n35\n1=1,NX\n35 J=1,NY DO 35 K=1,NZ\nVP0R(I,J,K,L)=VP0R(I,J,K,L)*(1.0D0+CR*(P0(I,J,K,L)~ POA(I,J,K,L))j\nPOA(I,J,K,L)=PO(I,J,K,L) SOA(I,J,K,L)\u00abSO(I,J,K,L) SWA(I,J,K,L)\u00bbSW(I,J,K,L) SGA(I,J,K,L)=SG(I,J,K,L)\nIF(L.EQ.2.AND.I.EQ.IP.AND.J.EQ.JP.AND.K.GE.KP.AND.K.LT.KP+NBP)\nVPOR(I,J,K,L)=O.ODO\nCONTINUE\nCalculo das producoes de oleo, gas e agua acumulados\nPWFA=PWF\nQOAC=QOAC+QOT*DT\nQGAC=QGAC+QGT*DT QWAC=qWAC+QWT*DT TEMPO=TEMPO+DT\nOpcao para teste de formacao\nIF(TESTE) THEN\nCALL CTESTE(TESTE,NTS,DT,qOMAX,TEMPTF,NITER) GOTO 500\nENDIF\nControle de impress\u00e3o de resultados para relatorio e gr\u00e1ficos\nIF(((TSIM.NE,0.ODO),AND.(TEMPO.GE.TSIM)).OR.(QOT,LE,QOMIN)) THEN CALL BALM\nCALL IMPRER(DT,NTS)\nCALL IMPRER(DT,NTS)\nEND IF\nIF(TEMPO.GE.ITG*TIMPG) THEN write(*,40)tempa/86400.,pwf/l.OD+6,rwo,dt/86400.,sw(l,1,1,1)\n40 formatC tempo\u00bb\u2019,f8.3,\u2019 pwf\u00bb\u2019 ,f6.3, * rwo\u00bb\\el0.4,\n*\u2019 dt=\\f7.4/ sw\u00bb\\f6.4)\nITG=ITG+1\nCALL BALM\nCALL IMPREG\nENDIF\nGoo\u00fcfj a\ta\tno oo no nao\to o on\nControle autom\u00e1tico de DT ao final de um passo de tempo bem sucedido\nQuando P\u00bbf se aproxima da press\u00e3o de sat. no poco reduz-se DT\nIF((PWF.GE.0.95D0*P\u00dcLS(1)).AND.(PWF,LE.1.O5D0+P0LS(1))) *\tDT=DT/2.0D0\nIF(NITER.LE.ITMIN) DT\u00bb1.5D0*DT\nIF(DT.GT.DTMAX) DT=DTMAX\nIF(DT.LT.DIMIN) DT=DTMIN\nGOTO 500\nEN D IF\nnao se obteve converg\u00eancia,assim uma nova iteracao sera feita\nwrite(*,*)\u2019---------------> nao convergiu dt=\u2019 ,dt/86400.\nNITER=NITER+1\nn# de itera\u00e7\u00f5es em um passo de tempo superou o m\u00e1ximo,logo reduz-se DT e reinicia-se o processo do inicio.Chama-se portanto rotina REPTS,\nIF(NITER.GT.ITMAX) THEN DT=DT/2.0D0\nCALL REPTS(NTS,PWF A,PWF) GOTO 500\nEND IF\nGOTO 400\n50 in=_ST0PW(l)\nWRITE(4,*)\u2019 Tempo de execucao (seg) =\u2019,in/1000\nCLOSE(UNIT=4,STATUS\u00bb\u2019KEEP\u2019)\nCLQSE(UNIT=6,STATUS\u00bb\u2019KEEP\u2019)\nCLOSE(UNIT=7,STATUS\u00bb\u2019KEEP\u2019)\nSTOP\nEND\nSUBBOTINA DE LEITURA DOS DADOS DE ENTRADA\nSUBROUTINE ENTRA\nIMPLICIT DOUBLE PRECISI0N(A-H,0-Z)\nPARAMETER(NLAB=18,NXM=08,NYM=05,NZM=04)\nCOMMON/LPVTO/POL,BOL, VOL,DOL,RSOL,POLS,BOLS,VOLS,DOES,NPO,NPOS\nCOMMON/LPVTW/PWL,BWL,VWL,DWL,RSWL,NPW\nCOMMON/LPVTG/PGL,BGL,VGL,DGL,NPG\nCOMMON/LPETR/SWL,KRWL,KROL,SLL,PCOWL,NKR,NPC\nCOMMON/NCEL/DBDX,DBDY,DBDZ,WRC,NBL0C,NXC,NYC,NZC,NBP,\n*\tNXR,NYR,NZR,NQL,NQS,NQI,IP,JP,KP\nCOMMON/SIM/DT,DTMAX,DTMIN,TOLP,TOLS,DSLlM,DPLIM,TSIM,\n\u00dcCI OO\to o\tou\tu o\to\tou\n*\tqOMAX,QOMIN,PWMIN,BSOR,JPROD,MSOLU,ITMAX,ITMIN\nCOMMON/RES/DGAS,CR,PRIN,TEMP,ZC,RW,RE,SWIN,PHI,PERX,PERY,\n*\tPERZ tZCOW,INDPOR,INDPER\nCOMMON/IMP/TIMPR,TIMPG,IRIMP\nCOMMON/TFR/QOTF,TPTF ,TETF,DTTF,DTI,TFLUX,BETA,OPT\nDIMENSION PQL(NLAB) ,BOL(NLAB) ,VOL(NLAB) ,DOL(NLAB) ,RS0L(NLAB) ,\n*\tPOLS(NLAB),BOLS(NLAB),VOLS(NLAB),DOLS(NLAB)\nDIMENSION PWL(NLAB),BWL(NLAB),VWL(NLAB),DWL(NLAB),RSWL(NLAB) DIMENSION PGL(NLAB),BGL(NLAB),VGL(NLAB),DGL(NLAB)\nDIMENSION SWL(NLAB) ,SLL(NLAB) ,PCOWL(NLAB)\nREAL*8\tKRWL(NLAB),KROL(NLAB)\nDIMENSION PHI(NXM,NYM,NZM,2),PERX(NXM,NYM,NZM,2),\n*\tPERY(NXM,NYM,NZM,2),PERZ(NXM,NYM,NZM,2) LOGICAL SINAL.SINALl\nCHARACTER*! OPT,FLAG\nLeitura dos dados PVT para oleo,agua,gas\nREAD(1,*,ERR\u00bb200)\nREAD(l,*,ERR=200)\nREAD(l,*,ERR=200)\n1=0\n1=1+1\nREAD(1,100,ERR=200)P0L(I),B0L(I),V0L(I),DOL(I),RSOL(I),FLAG\nIF(FLAG.EQ.1 J) GOTO 5\nNP0=I\nREAD(l,*,ERR=200)\nREAD(l,*,ERR=200)\n10 1=1+1\nREAD(1,110,ERR=200)POLS(I),BOLS(I) ,VDLS(I),DOLS(I),FLAG IF(FLAG.EQ.J \u00bb) GOTO 10\nNPOS=I\nREAD(l,*,ERR=200)\nREAD(l,*,ERR=200)\n1=0\n15\t1=1+1\nREAD(l,100,ERR=200)PWL(I),BWL(I),VWL(I),DWL(I),RSWL(I),FLAG IF(FLAG.EQ.\u2019 \u2019) GOTO 15\nNPW=I\nREAD(l,*,ERR=200)\nREAD(l,*,ERR=200)\n1=0\n20 1=1+1\nREAD(1,115,ERR=200)PGL(I),BGL(I),VGL(I),DGL(I),FLAG\nIF(FLAG.EQ.> \u2019) GOTO 20\nNPG=I\n100\tFORMAT(5F10.4,A1)\n110 F0RMAT(4F10.4,1OX,A1)\n115\tF0RMAT(F10.4,2F10.6,F10.4,1OX,A1)\nCLOSE(UNIT-1,STATUS\u00bb>KEEP\u2019)\nLeitura de dados de press\u00e3o capilar e de permeabilidade relativa\nREAD(2,*,ERR=200)\nREAD(2,*,ERR=200)\nREAD(2,*,ERR=200)\nC\n1=0\n25\t1=1+1\nREAD(2,120,ERR=200)SWL(I),KRWL(I),KR0L(I),FLAG\nIF(FLAG.Eq.> \u2019) GOTO 25\nNKR=I\nC\nREAD(2,*,ERR=200)\nREAD(2,*,ERR=200)\nC\n1=0\n30\t1=1+1\nREAD(2,125,ERR=200)SLL(I),PCOWL(I).FLAG\nIF(FLAG.EQ.' \u00bb) GOTO 30\nNPC=I\nC\n120 F0RMAT(3F10.6,Al)\n125 F0RMAT(F10.6,F10.3,1OX,Al)\nCL0SE(UNIT=2,STATUS='KEEP >)\na a\tn no\nLeitura dos par\u00e1metros de simulacao\nREAD(3,*,ERR=200)\nREAD(3,*,ERR=200)\nREAD(3,130,ERR=2 0 0)NXC\nREAD(3,130,ERR=200)NYC\nREAD(3,130,ERR=200)NZC\nREAD(3, 155,ERR=200)DBDX\nREAD(3,155,ERR=200)DBDY\nREAD(3,155,ERR=200)DBDZ\nREAD(3,130,ERR=2OO)NBP\nREAD(3,130,ERR=200)IP\nREAD(3,130,ERR=2OO)JP\nREAD(3,130,ERR=200)KP\nREAD(3,130,ERR=200)NXR\nREAD(3,130,ERR=200)NQL\nREAD(3,130,ERR=200)NQS\nREAD(3,130,ERR=200)NQI\nDetermina\u00e7\u00e3o do numero de blocos na direcao y\nNYR=2*NQL+NQS+NQI\nREAD(3,130,ERR=200)MS0LU\nREAD(3,130,ERR=200)ITMAX\nREAD(3,130,ERR=200)ITMIN\nREAD(3,140,ERR=200)DT\nREAD(3,135,ERR=200)DTMAX\nREAD(3,145,ERR=200)DTMIN\nREAD(3,140,ERR=200)TDLP\nREAD(3,145,ERR=200)TQLS\nREAD(3,145,ERR=200)DSLIM\nREAD(3,140,ERR=200)DPLIM\nREAD(3,140,ERR=2QO)QQMAX\nREAD(3,\u00cd40,ERR=200)qOMII\u00cd\nREAD(3,155,ERR=200)TSIM\nREAD(3,140,ERR=200)PWMIN\nREAD(3,150,ERR=200)RW\nREAD(3,135,ERR=200)TIMER\nREAD(3,135,ERR=200)TIMPG\nREAD(3,130,ERR=200)IRIMP\nREAD(3,130,ERR=200)JPROD\nIF(IRIMP.EQ.O) IRIMP=1\nIFCHMPR.Eq.O.ODO) TIMPR=182.5D0\nIF(TIMPG.EQ.0.0D0) TIMPG=TIMPR\nREAD(3,*,ERR=200)\no a an o\ta\taan a\tana\nLeitura dos dados do teste de formacao\nREAD(3,165,ERR=200)0PT\nREAD(3,155tERR=200)QOTF\nREAD(3,155,ERR=200)TPTF\nREAD(3\u00ed155,ERR=200)TETF\nREAD(3,155,ERRss200)DTTF\nREAD(3,155,ERR=200)BETA\nREAD(3,*,ERR=200)\nLeitura dos dados do reservat\u00f3rio\nREAD(3,145,ERR=200)SWIN\nREAD(3,145,ERR=200)DGAS\nREAD(3,160,ERR=s200)CR\nREAD(3,150,ERR=200)PRIN\nREAD(3,150,ERR=200)TEMP\nREAD(3,155,ERR=200)ZC\nREAD(3,155,ERR=200)ZCOW\nRE=DSQRT(DBDX*DBDY/3.141592654D0)\n130 F0RMAT(35X,I3)\n135 F0RMAT(35X,F5.1)\n140 F\u00dcRMAT(35X,F8.3)\n145 FDRMAT(35X,F6.4)\n150\tF0RMAT(35X,F8.4)\n155 F0RMAT(35X,F10.4)\n160 FORMAT(35X,D9.3)\n165\tFORMAT(35X,Al)\n166\tF0RMAT(35X,3(I2,\u00cdX))\nREAD(3,*,ERR=200)\nBloco de leitura do vetor porosidade a Patm ,um valor por camada, associado a um numero NPHI de camadas sobrepostas (de baixo para cima)\n170\n180\n210\nREAD(3,170,ERR=200)INDPOR\nFORMAT(Il)\nG0T0(180,190), INDPOR\nREAD(31210,ERR=200)AUXP\nFORMAT(F8.2)\nDO 220 1=1,NXR D0 220 J=1,NYR\nD0 220 K=1,NZR\nPHI(I,J,K,1)\u00bbAUXP\nCONTIN\u00dc\nD0 221\nf-l,NXC\nDO 221 J=1,NYC\nDO 221 K=1,NZC\nPHI(I,J,K,2)=AUXP\n221\tCONTINUE\nGOTO 230\n190\tWRITE(*,*)'NA0 DEFINIDA OPCAO PARA POROSIDADE POR BLOCOS'\n230\tREAD(3,*,ERR=200)\nn cio\to oo o\ta no\nBloco de leitura da permeabilidades na direcao x\n240\tREAD(3,170,ERR=200)INDPER G0T0(240,250),INDPER READ(3, 210,ERR=200)AUXP DO 260 1=1,NXR DO 260 J=1,NYR DO 260 K=1,NZR\n260\tPERX(I,J,K,1)=AUXP CONTINUE DO 261 1=1,NXC DO 261 J=1,NYC DO 261 K=1,NZC\n261\tPERXfl,J,K,2)=AUXP CONTINUE\n250\tGOTO 270 WRITE(*,*)'NA0 DEFINIDA OPCAO PARA PERMEABILIDADE POR BLOCOS'\n270 READ(3,*,ERR=200)\nBloco de leitura da permeabilidades na direcao y\n280\n300\n301\n290\n310\nREAD(3,170,ERR=200)INDPER\nGOT0(28O,29O),INDPER\nREAD(3,210,ERR=200)AUXP\nD0 300 1=1,NXR\nD0 300 J=1,NYR\nD0 300 K=1,NZR PERY(I,J,K,1)=AUXP CONTINUE\nD0 301 1=1,NXC\nD0 301 J=1,NYC\nD0 301 K=1,NZC\nPERY(I,J,K,2)=AUXP\nCONTINUE\nGOTO 310\nWRITE(*,*)'NA0 DEFINIDA OPCAO PARA PERMEABILIDADE POR BLOCOS' READ(3,*,ERR=200)\nBloco de leitura da permeabilidades na direcao y\nREAD(3,170,ERR=200)INDPER\nG0T0(320,330),INDPER\n320\tREAD(3,210,ERR=200)AUXP\nDO 340 1=1,NXR DO 340 1=1,NYR\nDD 340 K=1,NZR PERZ(I,J,K,1)=AUXP 340 CONTINUE\nDO 341 1=1,NXC DO 341 J=1,NYC\nDO 341 K=1,NZC\nPERZ(I,J,K,2)=AUXP\nrs no\tan\to\to o aooaa o o crn\nCaso ocorra erro na leitura de dados de permeabilidade\nCLOSE(UNIT-3,STATUS='KEEP')\n200 PRINT*,'ERRO NA LEITURA DE ARQUIVO DE DADOS'\nRETURN\nEND\nSUBBOTINA DE IMPRESS\u00c3O DOS DADOS LIDOS PARA SUA VERIFICACAD\nSUBR\u00d3\u00dct\u00cd\u00d1\u00c9\u2019\u00cdmPD\u00c9 ~\nIMPLICIT DOUBLE PRECISION(A-H,0-Z)\nPARAMETER (NLAB<8, NXM=08, NYM=05, NZM=04)\nCOMMON/LPVTO/POL,BOL,VOL,DOL,RSOL,POLS,BOLS,VOLS,DOLS,NPO,NPOS COMMON/LPVTW/PWL,BWL,VWL ,DWL,RSWL,NPW\nCOMMON/LPVTG/PGL,BGL,VGL,DGL,NPG\nCOMMON/LPETR/SWL,KRWL,KROL,SLL,PCOWL,NKR,NPC\nCOMMON/NCEL/DBDX,DBDY,DBDZ,WRC,NBLOC,NXC,NYC,NZC,NBP,\n*\tNXR,NYR,NZR,NQL,NQS,NQI,IP,JP,KP COMMON/SIM/DT,DTMAX,DTMIN,TOLP,TOLS,DSLIM,DPLIM,TSIM,\n*\tQDMAX,QOMIN,PWMIN,BSOR,JPRQD,MSOLU,ITMAX,ITMIN COMMON/RES/DGAS,CR,PRIN,TEMP,ZC,RW,RE,SWIN, PHI,PERX,PERY,\n*\tPERZ,ZCOW, INDPOR,INDPER\nCOMMON/IMP/TIMPR,TIMPG,IRIMP\nCOMMON/TFR/QOTF,TPTF,TETF,DTTF,DTI,TFLUX,BETA,OPT\nDIMENSION POL(NLAB).BOL(NLAB),VOL(NLAB),DOL(NLAB),RSOL(NLAB),\n*\tPOLS(NLAB),BOLS(NLAB),VOLS(NLAB),DOLS(NLAB) DIMENSION PWL(NLAB),BWL(NLAB),WL(NLAB),DWL(NLAB),RSWL(NLAB) DIMENSION PGL(NLAB),BGL(NLAB),VGL(NLAB),DGL(NLAB) DIMENSION SWL(NLAB),SLL(NLAB),PCOWL(NLAB)\nREAL*8 KRWL(NLAB),KROL(NLAB)\nDIMENSION PHKNXM.NYM.NZK^) ,PERX(NXM,NYM,NZM,2),\n*\tPERY(NXMNYM,NZM, 2) , PERZ(NXM, NYM,NZM,2) CHARACTER*1 OPT\nImpress\u00e3o do cabecalho\nWRITE(04,4)\n4\tFORMAT(//,30X,'PROGRAMA ACTI0W4.FOR',\n*//,20X,\u2019SIMULADOR DE RESERVAT\u00d3RIO COM POCO HORIZONTAL'Jt *20X,45(\u2019\u00ab'),//,30X,'TOTALMENTE IMPLICITO'J,30X,'TRIDIMENSIONAL\u2019,/ *,30X,'BI-FASICO ( OLEO/AGUA )>JD\nGRAVACAQ DOS PARAMETROS DE SIMULACAO,DADOS DO RESEV. E DO TESTE\nWRITE (04,3)NXC,NYC,NZC,DBDX,DBDY,DBDZ ,NBP,IP,JP,KP\n3\tFORMATOX/PRINCIPAIS DADOS UTILIZADOS' ,/,3X,25('=') ,//, *3X,'Parametros de Simulacao :',//,\n*5X,'Regiao do reservat\u00f3rio ~ GRID CARTESIANO -',/,\n*\t\u2019\tN#\tde\tblocos\tna\tdirecao\tX\t(13)\tNXC===>\u2019,13,/,\nc\n5\n\tDim. dos blocos direcao Y\t(FIO.4)\tDBDY===>\u2019,F9.2,/,\n*>\tDim. dos blocos direcao Z\t(FIO.4)\tDBDZ===>\u2019,F9.2,/,\n*\u2019\tN. de blocos produtores\t(13)\tNBP===>\u2018,13,/,\n*\u2019\tCoord, i do bloco produtor\t(13)\tIP===>\u2019,13,/,\n\tCoord, j do bloco produtor\t(13)\tJP===>\u2019,13,/,\n*1\tCoord, k do primeiro bloco\tprodutor\t(13)\tKP~~=>\u2019,13)\nWRITE(04,5)NXR,NYR,NZR,DT,T0LP,T0LS,DSLIM,DPLIM,Q0MAX,Q0MIN,TSIM,\n\u2666PWMIN,HW,TIMPR,TIMPG\nF0RMAT(4X,\u2019Regi\u00e3o do poco - GRID RADIAL\n*\u00bb\n*\u00bb\n*>\n* >\n* >\n* >\n* >\n*>\n*}\n*>\nN# de blocos na direcao X N# de blocos na direcao Y N# de blocos na direcao Z Time step inicial (dias) Tolerancia para press\u00e3o (Pa) Tolerancia para saturacao (fr) Max var de sa\u00ed num DT (fracao) Max var de pres. num DT (KPa) Vazao de oleo maxima (m3/dia) Vazao de oleo m\u00ednima (m3/dia) Tempo final de simulacao (dias) Pwf m\u00ednima no poco (MPa) Raio do poco (m)\nInt. tempo p/ impr.relatorio (dias) Int. tempo p/ impr.grafico (dias)\n6\nC\n10\n-SJ.\n(13) (13) (13) (F8.3)\n(F8.3) TDLP; (F6.4) T0LS= (F6.4)DSLIM! (F8.3)DPLIM: (F8.3)Q0MAX: (F8.3)Q0MIN: (F8.2) TSIM= (F8.3)PWMIN= (F8.4) RW= (F5.1)TIMPR! (F5.1)TIMPG= WRITE(04,6) IRIMP ,DTMAX\", DTMIN, ITMAX, ITMIN,JPROD FDRMAT(5X,\u2019Int. c\u00e9lulas de impress\u00e3o\nIncremento de tempo m\u00e1ximo (dias) Incrementode tempo minimo (dias) N# max de itera\u00e7\u00f5es no JACOBIANO N# min de itera\u00e7\u00f5es no JACOBIANO Fatia J base para o calculo de Pwf\n*\u00bb *\u00bb *>\n*\u2019\nc\n15\nNX NY; NZ===> > DT===>\u2019\n==>\u2019\n==>' = = >' = = >\u2019 = = >'\n>',13,/, >',13,/, ,13,/, ,F8.3,/, ,F8.3,/, ,F6.4,/, ,F6.4,/\u00bb ,F8.3,/, ,F8.3,/, ,F8.3,/, ,F8.2,/, >\u2019,F8.3,/, >\u2019,F8.4,/, >\\F5.1,/, >\u2019,F5.1)\n(13)IRIMP===>\u2019 (F5.1)DTMAX===>\u2019 (F6.4)DTMIN===>\u2019 (I3)ITMAX===>\u2019 (I3)ITMIN===>' (13)JPR0D===>\u2019\n,13,/,\n>F5.1,/, >F6.4,/, >13,/, ,13,/, ,13,/)\nWRITE(04,10)OPT,QOTF,TPTF,TETF,DTTF\nFORMAT(3X,\u2019Dados do teste de formacao ,//,\n*>\tSimulacao de teste de formacao\t(S ou N)\tDPT===>',A1,/,\n\tVazao de produ\u00e7\u00e3o (m3/dia)\t(F8.3)\tqOTF===>\u2019,F8.3,/,\n* \u2019\tTempo de fluxo (horas)\t(F8.3)\tTPTF--->\u2019,F8.3,/,\n* \u2019\tTempo de est\u00e1tica (horas)\t(F8.3)\tTETF===>\u2019,F8.3,/,\n*>\tIncr. de tempo no teste (horas)\t(F8.3)\tDTTF--=>\u2019,F8.3,/)\nWRITE(04,15)SWIN,DGAS,CR,PRIN,TEMP,RE,ZC,ZCDW\nFORMAT(3XDados do reservat\u00f3rio :\u2019,//,\n*\u2019 Saturacao inicial de agua (fracao) (F6.4) SWIN==!SS>\u2019 ,F6.4,/, \u2666\u2019 Densidade do gas (adim)\t(F6.4) DGAS===>\u2019,F6.4,/,\n*\u2019\tCompress\u00edbilidade da rocha (1/MPa)\t(E9.3)\tCR-=->\u2019,E9.3,/,\n*\u2019 Press\u00e3o inicial do reservatorio(MPa) (F8.4) PRIN==>\u2019,F8.4,/, *\u2019\tTemperatura do reservat\u00f3rio (SC) (F8.4) TEMP===>\u2019,F8.4,/,\n\u2666 *\tRaio externo da regi\u00e3o do poco (m)\t(F8.4)\tRE===>1,F8.3,/,\n*'\tCota do poco (m)\t(F8.3)\tZC===>\u2019,F8.2,/,\n30\n31\n32\nC\nC\nC\n50\n60\n55\n65\n75\n70\n80\n90\n85\n95\n106\n100\nC c c\n110\nWRITE(04,32)PERZ(1,1,1,1)\nF0RMAT(5X,'Permeabilidade na direcao jjc Ij2t-Oco*s^)\nF0RMAT(5X,\u2019Permeabilidade na direcao\n*\tblocos\u2019)\nF0RMAT(5X,\u2019Permeabilidade na direcao\n*\tblocos\u2019)\nX igual a\u2019,FIO.4,\u2019 para todos\nY igual a1,FIO.4,\u2019 para todos\nZ igual a\u2019,FIO.4,\u2019 para todos\nGRAVACAO DOS DADDS DE PVT\nWRITE(04,50)NP0\nF0RMAT(/,3X,\u2019NP0=\u2019,13,' DADDS PVT DO OLEO SATURADO',//,3X,' Pol(MP *a) Bol(m3/m3) Vol(cp) Dol(kg/m3) RSol(m3/m3)\u2019,/)\nDQ 55 1=1,NPO\nWRITE(04,60)P0L(I),B0L(l),VOL(I),DOL(I),RS0L(I)\nF0RMAT(3X,5(F8.3,2X))\nCONTINUE\nWRITE(04,65)NPOS\nF0RMAT(/,3X,\u2019NPOS=\u2019 ,13,' DADOS PVT DO OLEO SUBSATURADD\u2019,//,3X,' Po *ls(MPa) Bols(m3/m3) Vols(cp) Dols(kg/m3)\u2019,/)\nDO 70 I=1,NPOS\nWRITE(04,75)P0LS(I),BOLS(I),VOLS(I),DOLS(I)\nF0RMAT(3X,3(F8.3,2X),4X,F8.3)\nCONTINUE\nWRITE(04,80)NPW\nF0RMAT(/,3X,\u2019NPW=\u2019,13,' DADOS PVT DA AGUA\u2019,//,3X,\u2019 Pwl(MPa) Bwl(m *3/m3) Vwl(cp) Dwl(kg/m3) RSwl(m3/m3)',/)\nDO 85 1=1 NPW\nWRITE(04,90)PWL(I),BWL(I),VWL(I),DWL(I),RSWL(I)\nF0RMAT(3X,5(F9.4,2X))\nCONTINUE\nWRITE(04,95)NPG\nF0RMAT(/,3X,\u2019NPG=\u2019,13,\u2019 DADOS PVT DO GAS \u2019,//,3X,' Pgl(MPa) Bgl(m *3/m3) Vgl(cp) Dgl(kg/m3)',/)\nDO 100 1=1,NPG\nWRITE(04,105)PGL(l),BGL(I),VGL(I),DGL(I)\nF0RMAT(3X,F8.3,2X,F8.6,2X,F8.5,2X,F8.3)\nCONTINUE\nGRAVACAO DOS DADOS DE PETROFISICA\nWRITE(04,110)NKR\nFDRMAT(/,3X,\u2019NKR=',I3,\u2019 DADOS DE PERMEABILIDADE RELATIVA OLEO/AGUA\n*',//,3X,' Swl\tKrwl\tKrol',/)\nDO 115 1=1,NKR\nWRITE(04,120)SWL(I),KRWL(I),KR0L(I)\n120\tFORMAT(3X, 3(F8.5,2X))\n115 CONTINUE\nWRITE(04,125)NPC\n125\tF0RMAT(/,3X,'NPC=',I3,\u2019 DADOS DE PRESSAO CAPILAR OLEO/AGUA\u2019,//,3X,\n*\u2019 Sil Pcow(Pa)\u2019,/)\nDO 130 1=1,NPC\nWRITE(04,135)SLL(I),PCOWL(I)\n135\tF0RMAT(3X,2(F12.5,2X))\n130 CONTINUE\nC\nRETURN\nEND\nC------------------------------------------------------------------------\nC\n-----:----------------------------------------------------------------\nSUBROUTINE CONVUNI\nC\nIMPLICIT DOUBLE PRECISION(A~H,O-Z)\nPARAMETER(NLAB=18,NXM=08iNYM=Q5)NZM=04)\nC\nCOMMON/LPVTO/POL,BOL,VOL,DDL,RSOL,POLS,BOLS,VOLS,DDLS,NPO,NPOS\nCOMMON/LPVTW/PWL ,BWL, VWL,DWL,RSWL,NPW\nCOMMON/LPVTG/PGL,BGL ,VGL,DGL,NPG\nCOMMON/LPETR/SWL, KRWL t KROL, SLL ,PCOWL ,NKR, NFC\nCOMMON/NCEL/DBDX, DBDY, DBDZ, WRC ,NBLOC, NIC, NYC, NZC, NBP,\n*\tNXR,NYR,NZR,NQL,NQS,NQI,IP,JP,KP\nCOMMON/SIM/DT,DTMAX,DTMIN ,TOLP ,TOLS, DSLIM ,DPLIM,TSIM,\n*\tQOMAX,QOMIN,PWMIN,BSORtJPROD,MSOLU,ITMAX,ITMIN\nCOMMON/RES/DGAS, CR, PRIN, TEMP, ZC, RW, RE, SWIN, PHI, PERX, PERY,\n*\tPERZ,ZCOW,INDPOR,INDPER\nCOMMON/IMP/TIMPR,TIMPG,IRIMP\nCOMMON/TFR/QOTF,TPTF,TETF, DTTF,DTI,TFLUX,BETA, OPT\nC\nC\nDIMENSION POL(NLAB),BOL(NLAB),VOL(NLAB),D0L(NLAB),RSOL(NLAB),\n*\tPOLS(NLAB),BOLS(NLAB), VOLS(NLAB),DOLS(NLAB)\nDIMENSION PWL(NLAB),BWL(NLAB),VWL(NLAB),DWL(NLAB),RSWL(NLAB)\nDIMENSION PGL(NLAB),BGL(NLAB),VGL(NLAB),DGL(NLAB)\nDIMENSION SWL(NLAB),SLL(NLAB),PCOWL(NLAB)\nREAL*8 KRWL(NLAB),KR0L(NLAB)\nDIMENSION PHI(NXM,NYM,NZM,2),PERX(NXM,NYM,NZM,2),\n*\tPERY(NXM,NYM,NZM,2),PERZ(NXM,NYM,NZM,2) CHARACTER*! OPT\n5\n10\n15\n20\nTransforma-se MPa para Pa , cp para kg/s*m , massa esp. para peso esp. DO 5 1=1,NPO\nPOL(I)=1,0D+06*P0L(I)\nV0L(I)=1.0D-03*V0L(I)\nD0L(I)=9,8067D0*D0L(l)\nBOL(I)=1.ODO/BOL(I)\ni CONTINUE\nDO 10 1=1,NPOS\nPQLS(I)=1.0D+06*P0LS(I)\nVOLS(I)=1.00-03*VOLS(I)\nD0LS(I)=9.8067D0*D0LS(I)\nBOLs\u00a3l)=l,ODO/BOLS(I)\nCONTINUE\nDO 15 1=1,NPW\nPWL(I)=1,0D+06*PWL(I)\nVWL(I)=1,0D-03*VWL(l)\nDWL(I)=9,8067DO*DWL(I) BWL(I)=1,ODO/BWL(I)\nCONTINUE\nDO 20 1=1,NPG\nPGL(I)=1.0D+06*PGL(I)\nVGL(I)=1.0D-03*VGL(I) DGL(I)=9.8067D0*DGL(I)\nBGL(I)=1.ODO/BGL(I)\nDPLlfcl:0D+03*DPLIM\nCR=1.0D-06+CR\nC\nC Transforma-se md para m2- onde lmd=9.869E-16 m2\nDO 25 1=1,NXR\nDO 25 1=1,NYR DO 25 K=1.NZR\nPERX(I,J,K,1)=9.869D-16*PERX(I,J,K,1) PERY(I,J,K,1)=9.869D-16*PERY(I,J,K,1)\nPERZ(I, J,K, 1)=59.869D-16*PERZ(I, J,K, 1)\n25\tCONTINUE\nDO 26 1=1,NXC DO 26 J=1,NYC\nDO 26 K=1,NZC\nPERX(I,J,K,2)\u00ae9.869D\u201c16*PERX(I,J,K,2)\nPERY(I, J ,K,2)=9,869D-16*PERY(I,J,K,2)\nPERZ(I,J,K,2)=9.869D~16*PERZ(I,J,K,2)\n26\tCONTINUE\nGO OOQ o\ton\nVazoes de m3/dia para m3/s, tempos de dia ou hora para s\nT*3600.ODO 7*3600.ODO\nQOMAX=Q0MAX/864OO,ODO Q0MIN=Q0MIN/86400.ODO Q0TF=Q0TF/86400.0D0\nDT=DT*86400.ODO DTTF=DTTF*3600.ODO \u201cj\u2019pypss'pp*\u2014 - - * - \u2014 TETF=TE._ T .____,\nDTMAX=DTMAX*86400.ODO DTMIN=DTMIN*86400.ODO TSIM=TSIM*86400.0D0 TIMPR=TIMPR*86400.0D0 TIMPG=TIMPG*86400.0D0\nRETURN\nEND\nINICIALIZACAO DE VARIAVEIS DA MALHA (press\u00f5es,prop. PVT,trajismissib.)\nSUBROUTINE INICIA\nIMPLICIT DOUBLE PRECISION(A-H,0~Z)\nPARAMETER(NXM=08,NYM=05,NZM=04)\nCOMMON/NCEL/DBDX,DBDY,DBDZ,WRC,NBL0C,NXC,NYC,NZC,NBP,\n*\tNXR,NYR,NZR,NQL,NQS,NQI,IP,JP,KP\nCOMMON/TS/PO,SO,SG,SW\nCOMMON/PVT/BO,DBO,VO,DVO,DO, DDO, RSO, DRSO, BW, DBW, VW, DVW, DW, DDW, CW\nCOMMON/IFACEX/BOMX,VOMX,DOMX,BWMX,VWMX,DWMX\nCOMMON/IFACEY/BOMY,VOMY,DOMY,BWMY,VWMY,DWMY\nCOMMON/IFACEZ/BOMZ,VOMZ,DOMZ,BWMZ,VWMZ,DWMZ\nCOMMON/PETR/KRO,KRW,DKRO,DKRW,PC,DPC\nCOMMON/DTRANS/TOX,TWX,TOY,TWY,TOZ,TWZ,\n*\tTOX1SA,TOX1SI,TWX1SA,TWX1SI,\n*\tT0X2SI,T0X2SP,TWX2SI,TWX2SP,\n*\tTOY1SA,TQY1SI,TWY1SA,TWY1SI,\n*\tT0Y2SI,T0Y2SP,TWY2SI,TWY2SP,\n*\tTOZ1SA,TOZ1SI,TWZ1SA,TWZ1SI,\n*\tT0Z2SI,T0Z2SP,TWZ2SI,TWZ2SP\nDIMENSION P0(0:NXM-H,0:NYM+l,0:NZM+l,2),SO(NXM,NYM,NZM,2),\n*\tSG(NXM,NYM,NZM,2),SW(NXM,NYM,NZM,2)\nDIMENSION BD(NXM,NYM,NZM,2),DBO(O:NXM+1,0:NYM+1,0:NZM+1,2) ,\n*\tVQ(NXM,NYM,NZM,2),DV0(0:NXM+l,0:NYM+l,0:NZM+l,2),\n*\tDO(NXM,NYM,NZM,2),DDO(0:NXM+1,0:NYM+1,0:NZM+1,2),\n*\tBW(NXM,NYM,NZM,2),DBW(O:NXM+1,0:NYM+1,0:NZM+1,2) ,\n*\tVW(NXM,NYM,NZM,2),DVW(O;NXM+1,0:NYM+1,0:NZM+i,2) ,\n*\tDW(NXM,NYM,NZM,2),DDW(0:NXM+l,0:NYM+l,0:NZM+l,2),\n*\tCV(NXM,NYM,NZM,2)\nDIMENSION BQMX(O:NXM+1,NYM,NZM,2),VOMX(O:NXM+1,NYM,NZM,2),\n*\tDOMX(O:NXM+1,NYM,NZM,2),BWMX(O:NXM+1,NYM,NZM,2),\n*\tVWMX(0:NXM+l,NYM,NZM.2),DWMX(0:NXM+l,NYM,NZM,2)\nDIMENSION BOMY(NXM,NYM+1,NZM,2),VOMY(NXM,NYM+1,NZM,2),\n*\tDOMY(NXM,NYM+1,NZM,2),BWMY (NXM,NYM+1,NZM,2),\n*\tVWMY(NXM,NYM+1,NZM,2),DWMY(NXM,NYM+1,NZM,2)\nDIMENSION BOMZ(NXM,NYM ,NZM+1,2),VOMZ(NXM,NYM,NZM+1,2),\n*\tDOMZ(NXM,NYM,NZM+1,2),BWMZ(NXM,NYM,NZM+1,2),\n*\tVWMZ(NXM,NYM,NZM+1,2),DWMZ(NXM,NYM,NZM+1,2)\nDIMENSION DKRO(NXM,NYM,NZM,2),DKRW(NXM,NYM,NZM,2),\n*\tPC(O:NXM+1,O:NYM+1,0:NZM+l,2),DPC(O:NXM+1,O:NYM+1,O:NZM+1,2)\nREAL*8\tKRO(NXM,NYM,NZM,2),KRW(NXM,NYM,NZM,2)\nDIMENSION TOX(NXM+1,NYM,NZM,2),TWX(NXM+1,NYM,NZM,2) ,\n*\tTOX1SA(NXM,NYM,NZM,2),TOX1SI(NXM,NYM,NZM,2),\n*\tTWXISA(NXM,NYM,NZM,2),TWX1SI(NXM,NYM,NZM,2),\n*\tTOX2SI(NXM,NYM,NZM,2),T0X2SP(NXM,NYM,NZM,2),\n*\tTWX2SI(NXM,NYM,NZM,2),TWX2SP(NXM,NYM,NZM,2)\nDIMENSION TOY(NXM,NYM+1,NZM,2),TWY(NXM,NYM+1,NZM,2),\n*\tTOYISA(NXM, NYM,NZM,2),TOY1SI(NXM,NYM,NZM,2),\n*\tTWY1SA(NXM,NYM,NZM,2),TWY1SI(NXM,NYM,NZM,2),\n*\tTOY2SI(NXM,NYM,NZM,2),T0Y2SP(NXM,NYM,NZM, 2) ,\n*\tTWY2SI(NXM,NYM,NZM,2),TWY2SP(NXM,NYM,NZM,2)\nDIMENSION TOZ(NXM,NYM,NZM+1,2),TWZ(NXM,NYM,NZM+1,2),\n*\tTOZ1SA(NXM,NYM,NZM,2),TOZ1SI(NXM,NYM,NZM,2),\n*\tTWZISA(NXM,NYM,NZM,2),TWZ1SI(NXM,NYM,NZM,2),\n*\tTOZ2SI(NXM,NYM,NZM,2),T0Z2SP(NXM,NYM,NZM,2),\n*\tTWZ2SI(NXM,NYM,NZM,2),TWZ2SP(NXM,NYM,NZM,2)\nL=l,2\n5\nDD 50\nLX=NXR\nLY=NYR\nLZ=NZR\nIF&amp;.EQ.2) THEN\nLX=NXC\nEY=NYC\nLZ=NZC\nEND IF\nDO 5 I=1,LX+1\nDO 5 J=1,LY\nDO 5 K-1,LZ\nTOX(I,J,K,L)=O.ODO\nTWX(I,J,K,L)=O.ODO\nCONTINUE\nDO 6 1=1, IX\nDO 6 J=1,LY+1 DO 6 K=1,LZ\nTOY(I,J,K,L)=O.ODO TWY(I,J,K,L)=O.ODO CONTINUE\nDO 10 1=1,LX\nDO 10 J=1,LY DO 10 K=1,LZ+1\nTOZfl,I,K,L)=O.ODO\nTWZ(I,J,K,L)=O.ODO\n6\n10 CONTINUE\nDO 15 I=O,LX+1\nDO 15 J=O,LY+1\nDO 15 K=O,LZ+1\nO O O O QQQa o o o o\no\nO\no\no Q O\nO O O O O O QQaanci o o o o o o\no o o o o o Q Q QQ Q Q O O O O O O\no o o\no\nII\n1-4 tH o 1-1 II H II II\nII\no II\n\u25a0rt Tt O >4 i4 O li II II II II II\n\n*\u20143 i\u2014l d H \u2022\u2014\u25a0J \u2022\u20141\ns\u00aba- tt\u00ed fet\u00ed \u00a1*\u00a1 w: NI *\u25a0 \" \" \" - \" P 1\t*\u25a0\"}\nOOOOOOOOOO QQQQQQQQQQ OOOOOOOOOO\noooooooooo II II II II II H II II It II\nO Q O\no II\nd \u00ed\u20143 i\u2014I >\u2014J\t1 \u00bb\u20143 >\u20141 i\u20143\t>\u20145 *\u20141\n\n\u25a1\u25a1\u25a1\tJ\nUCuQQQQOaQ\n\u00edrfll mo Oh oi O a\nMin o\nHOl C3\nQO ua\no o o 5k s\u00e9 5r CQ \u00ed> O PQ P* O\nEsun&lt;oo a-Hc-ia \u00a1Z\u00a1\nHICO Hoi ci as\n\u25a1o OQ\nHOO\nHCOQ a oo UQ\ntdW O\u00bb\nWM\nE-*H \u00a1Z\u00a13\u00a1 oa uu\n\u00a131\nUJ Pi\nm\nO Ol\nUO OI\nO Cl\noo corn\nQ\nna non ona ono\tooana\tno nnaa\to nnaaoo\nSUBROTINA DE LAN\u00c7AMENTO DA MALHA,CALCULO DOS PONTOS DE MALHA E DAS SUAS COTAS,CALCULO DOS FATORES DE FORMA E DO PONDERADOR WX E WZ\ns\u00dabr\u00f5\u00dct\u00cdnFgrid\nIMPLICIT DOUBLE PRECISION(A-H,O-Z)\nPARAMETER(NXM=08,NYM=05,NZM=04,PI=3.141592654D0) COMMON/NCEL/DBDX,DBDY,DBDZ,WRC,NBLOC,NXC,NYC,NZC,NBP,\n*\tNXR,NYR,NZR,NQL,NQS,NQI,IP,JP,KP\nCOMMON/RES/DGAS,CR,PRIN,TEMP,ZC,RW,RE,SWIN,PHI,PERX,PERY,\n*\tPERZ,ZCOW,INDPOR,INDPER\nCOMMON/TFR/QOTF,TPTFtTETF,DTTF,DTI,TFLUX,BETA,OPT COMMON/MALHA/ZB,RB,VPOR,DRO tWX ,WY,WZ,FFX,FFY,FFZ,DTETA DIMENSION PHI(NXM,NYM,NZM,2),PERX(NXM,NYM,NZM,2),\n*\tPERY(NXM,NYM , NZM,2),PERZ(NXM,NYM,NZM,2)\nDIMENSION ZB(O:NXM+1,NYM,2),RB(NXM+1),VPOR(NXM,NYM,NZM,2),\n*\tFFX(NXM+1,NYM,NZM,2),FFY(NXM+1,NYM,NZM,2),\n*\tFFZ(NXM+1,NYM,NZM+1,2),DTETA(NYM+1) CHARACTER*! OPT\nGRID RADIAL === calculo das cotas e fatores de forma\nCalculo dos raios RB dos grids points ( o raio e o mesmo para as camadas NZR e fatias NYR do mesmo I)\nDRO=DLOG(RE/RW)/NXR\nALFA-DEXP(DRO)\nALFA=DEXP((ALFA*ALFA*DRO)/(ALFA*ALFA-1.0D0)-0.5D0) DO 10 1=1,NXR\nAUX\u201cRW*DEXP((I~1)*DRO) RB(I)=AUX*ALFA\n10 CONTINUE\nFormacao do grid\nDetermina\u00e7\u00e3o dos \u00e2ngulos lado direito\nAA=PI/2.OD0\nDO 20 J=1,NQL\nDTETA(J)=AA/FLOAT(NQL)\n20 CONTINUE\nlado superior\nDO 30 J=(NQL+1),(NQL+NQS) DTETA(J)=AA/FLOAT(NQS) 30 CONTINUE\nlado esquerdo\nDO 40 J=(NQL+NQS+1),(2*NQL+NQS) DTETA( J)=AA/FLOAT(NqL) 40 CONTINUE\nlado inferior\nDO 50 J=(2*NQL+NQS+1),NYR DTETA(I)=AA/FLOAT(NQI) 50 CONTINUE\nCalculo das cotas de cada grid point\nSUMT=(DTETA(1)/2.ODO)-(PI/4.ODO)\nDO 100 J=1,NYR\nZB(I,J,1)=ZC+RB(I)*DSIN(SUMT) SUHT=SUMT+(DTETA(J)+DTETA(J+1))/2.ODO IF(OPT,EQ.'S') ZB(I,J,1)=ZC\n100 CONTINUE\na aa\to no\tnon on\tnon\nPonderadores WX, WY e WZ nas dire\u00e7\u00f5es X, Y e Z\nIF(NXR.GT.2) THEM\nWX=((NXR-2)*DRO-DLOG(RB(NXR-2)/RW))/DLOG(RB(NXR-1)/RB(NXR~2))\nELSE\nWX=0.5D0\nEND IF\nWY=0.5D0\nWZ=Q.5D0\nWRC=(RE-RB(NXR))/(RE+DBDX/2.ODO-RB(NXR))\nCalculo dos fatores geom\u00e9tricos FFX para a 1# coluna i=l (poco)\npara a 1# coluna i=l (poco)\nDO 120 K=1,NZR\nDO 120 J=1,NYR\nFFX(1,J,K,1)=DTETA(J)*DBDZ*PERX(1,J,K,1)/DLOG(RB(1)/RW)\n120 CONTINUE\npara i=2,NXR ;j=l,NYR ;k=l,NZR\nDO 130 1=2, NXR\nAUX=RW*DEXP((l-l)*DRO)\nDO 130 J=1,NYR\nDO 130 K=1,NZR\nAUX1=DTETA(J)*DBDZ*PERX(I-1, J, K, 1)*PERX(I, J, K, 1) FFX(I,3,K,1)=AUX1/(PERX(I,J,K,1)*\n*\tDLOG(AUX/RB(I-1))+PERX(I-l,J,K,1)*DLOG(RB(I)/AUX))\n130 CONTINUE\npara i=NXR+l ;j=l,NYR\nDO 131 J=1,NYR\nDO 131 K=1,NZR IF(J.LE.NQL) THEN\nIF(IP.EQ.NXC) GO TO 131\nIX=IP+1 3x= Jp\nAVXK=PERX(IX,JX,KP,2)\nENDIF\nIF(J.GT.NQL.AND.J.LE.NQL+NQS) THEN IF(JP.EQ.NYC) GO TO 131 IX=IP\nJX=JP+1 AUXK=PERY(IX,JX,KP,2) ENDIF\nIF(J.GT.NQL+NQS.AND.J.LE.NQS+2*NQL) THEN IF(IP.EQ.l) GO TO 131\nIX\u00bbIP-1\nJX=JP AUXK=PERX(IX,JX,KP,2) ENDIF\nIF(J.GT.NQS+2*NQL) THEN\nIF(JP.EQ.l) GO TO 131\nJX\u00abJP-1\nAUXK=PERY(IX,JX,KP,2)\nENDIF\nAUX1=DTETA(J)*DBDZ\nFFX(NXR+1, J, K, 1)=AUX1/(DLOG(RE/RB(NXR))/PERX(NXR,J,K,1)*\n*\tDLOG((RE+DBDX/2.ODO)/RE)/AUXK)\nC\tFFX(NXR+l,J,K,l)=0,0D0\n131 CONTINUE\no m\to ano\to\tq no\tn no\nCalculo dos fatores geom\u00e9tricos FFZ\nDO 140 K=2,NZR\nDO 140 I=1,NXR\nDO 140 J=1,NYR AUX=DTETA(J)*RW*RW*(DEXP(2.0D0*I*DR0)-\n*\tDEXP(2,0D0*(I~l)*DR0))\nFFZ(I,J,K,1)=AUX*PERZ(I,J,K-1,1)*PERZ(I,J,K,1)/\n*\t(DBDZ*(PERZ(I,J,K-1,1)+PERZ(I,J,K,1)))\n140\tCONTINUE\nCalculo dos fatores geom\u00e9tricos FFZ, para a prim. e ultima face\nIF(KP.NE.l) TREN\nDO 141 I=1\u00cdNXR DO 141 J=1,NYR\nAUX=DTETA(J)*RW*RW*(DEXP(2.0D0*I*DR0)-\n*\tDEXP(2.0D0*(I\u201cl)*DR0))\nFFZ(I,J,l,\u00ed)=AUX*PERZ(IP,JP,KP-l,2)*PERZ(I,J,l,l)/\n*\t(DBDZ*(PERZ(IP,JP,KP-1,2)+PERZ(I,J,1,1)))\n141\tCONTINUE\nENDIF\nIF(KP+NBP-1.LT.NZC) THEN\nDO 142 1=1,NXR DO 142 J=1,NYR\nAUX=DTETA(J)*RW*RW*(DEXP(2.ODO*I*DRO)-\n*\tDEXP(2.ODO*(I-1)*DR0))\nFFZ(I,J,NZR+1,1)=AUX*PERZ(I,J,NZR,1)*PERZ(IP,JP,KP+NBP,2)/\n*\t(DBDZ*(PERZ(I,J,NZR,1)+PERZ(IP,JP,KP+NBP, 2)))\n142\tCONTINUE\nENDIF\nCalculo dos fatores geom\u00e9tricos FFY\n\u00c3\u00dcx=dbdz*dr\u00d5*2.\u00d5d\u00f4\nDO 150 1=1,NXR\nDO 150 J=1,NYR\nDO 150 K=1,NZR\nJMA=1\nIF(J.NE.NYR) JMA=J+1 AUX2=AUX/DTETA(J) FFY(I,J,K,1)=AUX2/(1.0D0/PERY(I,J,K,i)+l.ODO/\n*\tPERYfl,JMA,K,1))\n150 CONTINUE\nImpress\u00e3o para verificacao\nWRITE(04,170)\nSAREA=0.0D0\nDO 160 J=1,NYR\nDO 160 1=1,NXR\nn on\to na\tq na\taanoaa\n160\n170\n180\n181\n190\n200\n210\nAUX1=RW*DEXP((I-1)*DRO)\nAUX2=RW*DEXP(I*DR0)\nAUX3=DTETA(J)*(AUX2*AUX2-AUXl*AUXl)/2.ODO\nGTETA-DTETA(J)*360.ODO/(2.ODO*PI)\nWRITE(04,180)IfJ,AUX1,RB(I),AUX2,ZB(I,J.l).\n*\tGTETA.AUX3\nSAREA=SAREA+AUX3\nCONTINUE\nFORMAT(//,\u2019\tVerificacao dos resultados da Sub GRID',/,\n*\u2019 GRID RADIAL\u2019,//,\n*/, * BLOGO\u2019,T13,\u2019Ri-1/2 Ri Ri+1/2 Cota Angulo area\u2019, \u2666/, \u2019 I J K\u2019,T16t\u2019mJ,125,\u2019\u00ae\u2019,134,\u2019m\u2019,T41,\u2019m graus m2\u2019)\nF0RMAT(2(I2,IX),6(F8.2,1X))\nWRITE(04,181)SAREA\nFORMAT(T32Area total =',F8.2)\nWRITE(04,190)\nFORMATC//,* BLOCO\tFFX\tFFY\tFEZ\u2019)\nDO 200 K=1,NZR+1\nDO 200 I=1,NXR+1\nDO 200 J=1,NYR WRITE(04,210)I,J,K,FFX(ItJ,K,l),FFY(I,J,K,l),FFZ(I,JiK,l) CONTINUE\nF0RMAT(3(I2,lX),3(D14.4ilX))\n=== GRID RETANGULAR === calculo das cotas e fatores de forma\nCalculo das cotas\nIF(OPT.EQ.\u2019S\u2019) THEN\nDO 221 I\u00ab1,NXC DO 221 J=1,NYC ZB(I,J,2)-ZC\nCONTINUE\nELSE\nDO 220 1=1,NXC\nZB(I,JP,2)\u00abZC\nCalculo das cotas dos blocos abaixo do poco\nSUM=DBDY\nDO 230 J=(JP-1),1,-1\nZB(I,J,2)=ZC-SUM\nSUM=SUM+DBDY\nCONTINUE\nCalculo das cotas dos blocos acima do poco\nSUM=DBDY\nDO 240 J=(JP+1),NYC\nZB(I,J,2)\u00bbZC+SUM SVM=SUM+DBDY\n240 CONTINUE\n220 CONTINUE\nEND IF\nCalculo dos fatores geom\u00e9tricos FFX para i=2,NX ;j=l,NY\nDO 270 1=2,NXC\nDO 270 J=1,NYC\nDO 270 K=1,NZC\nAUX=2.ODO*DBDY*DBDZ*PERX(I-1,J,K,2)*PERX(I,J,K, 2)/DBDX\nFFXCI,J,K,2)=AUX/(PERX(I-1,J,K,2)+PERX(I,J,K,2))\n270 CONTINUE\nOU \u00dc\tUU O\t\u00dcU Q\tV ocwu\nCalculo dos fatores geom\u00e9tricos FFZ para k-2,NX ;j=l,NY\nDO 280 1=1,NXC\nDO 280 J=1,NYC\nDO 280 K=2,NZC\nIF(I.EQ.IP.AND.J.EQ.JP.AND.K.GE,KP.AND.K.LE,KP+NBP)GO TO 280 AUX=2.ODO*DBDX*DBDY*PERZ(I,J,K-l,2)*PERZ(I,J,K,2)/DBDZ FFZ(I,J,K,2)=AUX/(PERZ(I,J,K-1,2)+PERZ(I,J,K,2))\nCONTINUE\nCalculo dos fatores geom\u00e9tricos FFY\nDO 290 J=2,NYC\nDO 290 1=1,NXC\nDO 290 K=1,NZC\nIF(K.GE.KP.AND.K.LT.KP+NBP)THEN\nIF(I.EQ.IP.AND.J.EQ.JP.OR.I.EQ.IP.AND,J.EQ.JP+1)GO TO 290 END IF\nAUX=2.0D0*DBDX*DBDZ*PERY(I,J-1,K,2)*PERY(I,J,K,2)/DBDY FFYd,J,K,2)=AUX/(PERY(I,J-l,K,2)+PERYd,J,K,2))\n290 CONTINUE\nImpress\u00e3o para verificacao\nWRITE(04,300)\n300 FORMAT(//,\u2019 GRID RETANGULAR', *//,\u2019 BLOCO\tFFX\tFFY\tFFZ1)\nDO 310 K=1,NZC\nDO 310 1=1,NXC DO 310 J=1,NYC\nWRITE(04,320)I,J,K,FFX(I,J,K,2),FFY(I,J,K,2),FFZ(I,J,K,2)\n310 CONTINUE\ts z\n320 FORMAT(3(12,IX),3(D14.4,IX))\nDO 250 1=1,NXC\nDO 250 J=1,NYC\nWRITE(4,26O)I,J,ZB(I,J,2)\n260\tFORMAT!? 1=\u2019 ,12, \u2019J=\u2019 ,12,1 CQTA=',F20.12)\n250 CONTINUE\nRETURN\nEND\nSUBROT. PARA CALC. DAS PRESS\u00d5ES E SATURA\u00c7\u00d5ES DE AGUA NOS GRIDS POINTS\nSUBROUTINE PRESSO(PWF)\nIMPLICIT DOUBLE PRECISION(A-H,O-Z)\nPARAMETER(NLAB=18,NXM=08,NYM=05,NZM=04)\nCOMMON/NCEL/DBDX,DBDY,DBDZ,WRC,NBLOC, NXC,NYC,NZC,NBP,\n*\tNXR,NYR,NZR,NQL,NQS,NQI,IP,JP,KP\nCOMMON/RES/DGAS,CR,PRIN,TEMP,ZC,RW,RE,SWIN,PHI,PERX,PERY,\n*\tPERZ,ZCOW,INDPOR,INDPER\nCOMMON/MALHA/ZB,RB,VPOR,DRO,WX,WY,WZ,FFX,FFY,FFZ,DTETA\nCDMMON/TSA/POA,SOA,SGA,SWA\nCOMMON/LPETR/SWL,KRWL,KROL,SLL,PCOWL,NKR,NPC\nDIMENSION PHI(NXM,NYM,NZM,2),PERX(NXM,NYM,NZM,2),\n*\tPERY(NXM,NYM,NZM,2),PERZ(NXM,NYM,NZM,2)\nDIMENSION ZB(O:NXM+1,NYM,2),RB(NXM+1),VPOR(NXM,NYM,NZM,2),\n*\tFFX(NXM+1,NYM,NZM,2),FFY(NXM+1,NYM,NZM,2),\n*\tFFZ(NXM+1 ,NYM,NZM+1,2),DTETA(NYM+1)\nDIMENSION P0A(NXM,NYM,NZM,2),S0A(NXM,NYM,NZM,2),\n*\tSGA(NXM,NYM,NZM,2),SWA(NXM,NYM,NZM,2)\nDIMENSION SWL(NLAB),SLL(NLAB),PCOWL(NLAB)\nREAL*8 KRWL(NLAB),KR0L(NLAB)\na oa\tQ\to o \u00ab9 ri\nPressao de referencia no contato oleo/agua\nZREF=ZCOW\nPREF=PRIN\nDet. das press\u00f5es iniciais nos blocos I, J. Para as camadas K\u2019s se\nrepetem\nDO 60 L-1,2\nLX=NXR\nLY=NYR\nLZ=NZR\nIF(L.EQ.2) THEN\nLX=NXC\nLY=NYC LZ=NZC ENDIF\nDO 10 1=1,LX\nDO 10 J=1,LY\nDO 10 K=1,LZ\nP0A(I,J,K,L)=PR(ZB(I,J,L),PREF,ZREF,1) PWA~PR(ZB(I,J, L) ,PREF,ZREF,2) IF(ZB(I,J,L).LT.ZREF) THEN\nPOA(I,J,K,L)=PWA DPCA=O.0D0 ELSE\nDPCA=POA(I,1,K,L)~PWA\nENDIF\nCalculo das satura\u00e7\u00f5es iniciais\nIF(DPCA.LE.O.ODO) SWA(I,J,K,L)=1.ODO IF(DPCA.GT.PCOWL(1)) SWA(I,J,K,L)=SWIN IF(DPCA.GT.0.ODO.AND.DPCA.LE.PCOWL(1))\n*\tCALL INTERPC(PCOWL,SLL,NPC,DPCA,SWA(I,J,K,L) ,AUX)\n10 CONTINUE\nPWF=PDA(1,1,1,1)\nImpress\u00e3o para verificacao\nIF(L.EQ.l) WRITE(04,70)\nIF(L.EQ.2) WRITE(04,80)\nFDRMATC//,\u2019\nFORMAT\u00cd//,\u2019 WRITE(04,30) FORMATt//,\u2019 *\u2019 Bloco\nDO 40 K=1,LZ\nDO 40 J=1,LY DO 40 1=1,LX\nWRITE(04,50)1,J,K,POA(I,J,K,L)/1.OD+6,SWA(I,J,K,L) F0RMAT(lX,3(I2flX),3X,F10.4,3X,F10.4)\nCONTINUE\nCONTINUE RETURN END\n70\n80\n30\n50\n40\n60\nGRID RADIAL - regi\u00e3o do poco\u2019)\nGRID RETANGULAR - regi\u00e3o do reservat\u00f3rio\u2019)\nImpress\u00e3o para verificacao da sub PRESSO\u2019,//, Press\u00e3o (MPa) Saturacao de Agua\u2019)\nC\nDOUBLE PRECISION FUNCTION PR(ZAUX,PREF,ZREF,IZ)\nIMPLICIT DOUBLE PRECISION(A-H.O-Z)\nPARAMETER(NLAB=18)\nCOMMON/LPVTO/POL,BOL,VDL,DOL,RSOL,POLS,BOLS,VOLS,DDLS,NPO,NPOS COMMON/LPVTW/PWL,BWL,VWL ,DWL,RSWL,NPW\nDIMENSION POL(NLAB),BOL(NLAB),VOL(NLAB),DOL(NLAB),RSOL(NLAB),\n*\tPOLS(NLAB),BOLS(NLAB), VOLS(NLAB),DOLS(NLAB)\nDIMENSION PWL(NLAB),BWL(NLAB),VWL(NLAB),DWL(NLAB),RSWL(NLAB)\n5\nIF(IZ.EQ.l) THEN\nIF(PREF.GE.POLS(1)) THEN\nCALL INTER(POLS,DDLS,NPOS,PREF,DORF,YDORF) ELSE\nCALL INTER(POL,DOL,NPO,PREF,DORF,YDORF) ENDIF\nET.SE\nCALL INTER(PWL,DWL,NPW,PREF,DORF,YDORF) ENDIF\nPB=PREF+DORF*(ZREF-ZAUX)\nPMED=(PB+PREF)/2.0D0\nIF(IZ.EQ.l) THEN\nIF(PMED.GE.FOLS(1)) THEN\nCALL INTER(POLS,DOLS,NPOS,PMED,DORF,YDORF) KT.SE\nCALL INTER(POL,DDL,NPO,PMED,DORF,YDORF) ENDIF\nELSE\nCALL INTER(PWL,DWL,NPW,PREF,DORF,YDORF)\nENDIF ,\t,\nFR=2.ODO*(PMED-PREF)-DORF*(ZREF-ZAUX) DFR=2.ODO-(ZREF-ZAUX)*YDORF\nDPMED=-FR/DFR\nPMED=PMED+DPMED\nIF(DPMED.GT.1.OD-6) THEN\nGOTO 5\nFT SF\nPR=2.ODO*PMED~PREF\nENDIF\n\u00dcUU CIU\nRETURN END\nCALCULO DOS VOLUMES ORIGINAIS DE OLEO, GAS E AGUA NO RESERVAT\u00d3RIO\nSUBROUTINE RESERV\nIMPLICIT DOUBLE PRECISI0N(A-H,O-Z)\nPARAMETER(NXM=08,NYM=05,NZM=04)\nCOMMON/NCEL/DBDX,DBDY,DBDZ,WRC,NBLOC,NXC,NYC,NZC,NBP,\n*\tNXR,NYR,NZR,NQL,NQS,NQI,IP,IP,KP\nCOMMON/ACUM/QOAC,QGAC,QWAC,VOORR,VWORR,VOORC,VWORC,BNPR,BWPR,\n*\tBNPC,BWPC,PWFA\nCOMMON/MALHA/ZB,RB,VPOR,DRO,WX,WY,WZ,FFX,FFY,FFZ,DTETA CQMMDN/TSA/POA,SOA,SGA,SWA\nCOMMON/PVTA/BOA,RSOA,BWA\nDIMENSION POA(NXM,NYM,NZM,2),S0A(NXM,NYM,NZM,2),\n*\tSGA(NXM,NYM,NZM,2),SWA(NXM,NYM,NZM,2)\nDIMENSION BOA(NXM,NYM,NZM,2),BWA(NXM,NYM,NZM,2)\nDIMENSION ZB(O:NXM+1,NYM,2),RB(NXM+1),VP0R(NXM,NYM,NZM,2),\n*\tFFX(NXM+i,NYM,NZM,2),FFY(NXM+1,NYM,NZM,2),\n*\nc\nFFZ(NXM+1, NYM,NZM+1,2),DTETA(NYM+1)\nODO ODO ODO ODO ODO ODO\nOGU\tUQU\tGU \u00dc\tUUUOU\nVQ0RR=0\nVG0RR=0\nVWGRR=O\nVOORC=O\nVGORC=O\nVWORC=O.\nCALL FPOA\nDO 40 L=l,2\nIF(L.EQ.l) THEN\nGRID RADIAL\nWRITE(04,50)\nF0RMAT(/,7 GRID RADIAL'bloco\tVp')\nDO 6 1=1,NXR\nDO 6 J=1,NYR\nDO 6 K=1,NZR\nVOORR=VOORR+VPOR(I,J,K,L)*SOA(I,J,K,L)*BOA(I,J,K,L) VW0RR=VW0RR+VP0R(I,J,K,L)*SWA(I,J,K,L)*BWA(I,J,K,L) WRITE(04,30)IJJ,K,VP0R(l,J,K,L)\nFORMAT(3(I2,IX),IX,F14.2)\nCONTINUE\nELSE\nGRID CARTESIANO\nWRITE(04,60)\n60\tFORMAT(/,J GRID RETANGULAR',/,' bloco\tVp')\nDO 5 I=1,NXC\nDO 5 J=1,NYC\nDO 5 K=1,NZC\nIF(I.EQ,IP.AND.J.EQ.JP.AND.K.GE.KP.AND.K.LT.KP+NBP)GO TO 5 VOOROVODRC+VPORfl, J ,K, L) *SOA (I, J, K, L) *BOA(I, J,K,L) VWORC=VWORC+VPOR(I,J,K,L)*SWA(I,J,K,L)*BWA(I,J,K,L) WRITE(04,30)I,J,K,VPOR(I,J,K,L)\n5\tCONTINUE\nEND IF\n40 CONTINUE\nImpress\u00e3o para verificacao\nWRITE(04,10)VOORR,VWORR,VOORC,VWORC,(VOORR+VOORC),(VWORR+VWORC)\n10\tF0RMAT(//,\u2019 Verificacao dos volumes originais',/,\n*'\tRadial\tCartesiano\tTotal',/,\n*'\t0IP(m3) WIP(m3) 0IP(m3) WIP(m3) 0IP(m3) WIP(m3)',/,\n*3X,6(D9.3,1X))\nRETURN\nEND\nSUBROTINA DE CONTROLE DA EXECUCAO DE TESTE DE FORMACAO\nSUBROUTINE CTESTE(TESTE,NTS,DT,QOMAX,TEMPI?,NITER)\nIMPLICIT DOUBLE PRECISION(A-H,O-Z)\nPARAMETER(NLAB=18,NXM=08,NYM=05,NZM=04,PI=3.141592654D0) COMMON/NCEL/DBDX,DBDY,DBDZ,WRC,NBLOC,NXC,NYC,NZC,NBP,\n*\tNXR,NYR,NZR,NQL,NQS,NQI,IP,JP,KP\nCQMMON/TFR/QOTF,TPTF,TETF,DTTF,DTI,TFLUX,BETA,OPT COMMON/VAZAO/QO,QOT,QG,QGT,QW,QWT,DQOP,DQOS,\n*\tDQWP,DQWS,RW0,RGO,PWF,TEMPO\n*\tPERZ,ZCOW,INDPOR,INDPER\nDIMENSION QO(NYM,NZM),QG(NYM,NZM),QW(NYM,NZM),DqOP(NYM,NZM),\n*\tDQOS(NYM,NZM),DQWP(NYM,NZM),DQWS(NYM,NZM)\nDIMENSION B0(NXM,NYM,NZM,2),DBD(0:NXM+1,0:NYM+1,0:NZM+1,2),\n*\tV0(NXM,NYM,NZM,2),DVO(O:NXM+1,0:NYM+l,0:NZM+1,2),\n*\tD0(NXM,NYM,NZM,2),DDO(O:NXM+1,0:NYM+1,0:NZM+1,2) ,\n*\tBW(NXM,NYM,NZM,2),DBW(O:NXM+1,O:NYM+1,O:NZM+1,2) ,\n*\tVW(NXM,NYM,NZM,2),DVW(0:NXM+l,0:NYM+l,0:NZM+l,2),\n*\t. DW(NXM,NYM,NZM,2),DDW(O:NXM+l,0:NYM+l,0:NZM+l,2),\n*\tCW(NXM NYM NZM 2)\nDIMENSION PHI(NXM,NYM,NZM,2),PERX(NXM,NYM,NZM,2),\n*\tPERY(NXM ,NYM,NZM,2),PERZ(NXM,NYM ,NZM,2) LOGICAL TESTE\nCHARACTER*1 OPT\nC\nC1-3600.0D0\nC2=1.0D+6\nC3=1.0D+3\nC Inido do processo, passa-se a usar vazao e DT do teste.\nIF(OPT.EQ.\u2019I\u2019) THEN\nQOT=QOTF\nDT=DTTF OPT='F\u2019 WRITE(12,5) F0RMAT(2X,\u2019Tempo(h) \u2019Tempo(h) (t+dt)/dt RETURN ENDIF\nC Fase de fluxo, ao sen final IF\u00cdOPT.EQ.\u2019F\u2019) THEN\nIF(TEMP0/C1.LT.0.0001)\nIF(TEMP0/C1.GE.0.0001.AND.TEMPD/C1.LT.0.001) IF(TEMPD/C1.GE.0.001.AND.TEMP0/C1.LT.0.01) IF(TEMP0/C1.GE.0.01. AND.TEMPO/C1.LT.0.1) IF(TEMPO/C1.GE.0.1.AND.TEMP0/C1.LT.1.0) IF\u00cdTEMPD/C1.GE.1.0.AND.TEMPG/C1.LT.10.0) IF(TEMPQ/C1.GE.10.0.AND.TEMP0/C1.LT.100.0) IF(TEMP0/C1.GE.100.0.AND.TEMP0/C1.LT.1000.0) IF(TEMP0/C1.GE.1000.0.AND.TEMP0/C1.LT.10000. DTITF=DTITF*C1 IF(TEMPD.GE.TEMPTF) THEN\nDELTP=PRIN-PWF WRITEdZdOTEMPO/C^DSqRTtTEMPO/CD^WF/CZ^ELTP/CS FORMAT(4(E10.5,2X)) TEMPTF=TEMPTF+DTITF\nENDIF\nIF(NITER.LE.2) DT=1.5D0+DT IF(DT.GE.DTITF) DT=DTITF\nIF(TEMPO.GE.TPTF) THEN CALL IMPRET(DT,OPT,L) QOT-O.ODO RW0=0.0D0 TFLUX=TEMPO DT-DT/12.ODO OPT=\u2019E\u2019 RETURN\nENDIF ENDIF\nC Fase de estatica, ao sen final verifica-se se a simul. vai prosseguir.\ndsqrt(t) pws (MPa)\nvazao de\ncc\n10\nCC CC CC\nC\npwf(MPa) pi-pwf(KPa)\u2019,/,2X, pi-pws(KPa)\u2019)\noleo eh nula.\nDTITF=0 DTITF=O DTITF=O DTITF=0 DTITF=O DTITF=1\n0)\n00001\n0001\n001\n01\n1\n0\nDTITFdO.O\nDTITF=100.0\nDTITF=1000.0\n5\n*\n11\n15\nIF(OPT.EQ.\u2019E1) THEN\nHORN=TEMPO/(TEMPO-TFLUX) DELTP=PRIN-PWF\nWRITE(12,11)TEMPO/Cl,HORN,PWF/C2,DELTP/C3\nFORMAT(4(El2.6,IX))\nIF(TEMPO.GE.(TPTF+24.ODO*DT)) DT=DTTF\nIF(TEMPO.GE.(TETF+TPTF)) THEN\nCALL IMPRET(DT,OPT,L)\nPRINT*/FINAL DO TESTE DE FORMACAD'\nPRINT*/DESEJA PROSSEGUIR COM A SIMULACAO S ou N READ(*,15)OPT FORMAT(Al)\nIF(OPT.NE.JS\u2019) THEN\nPRINT*/FINAL DO PROGRAMA, APENAS REALIZADO TFR' STOP\nELSE\nTEMPO=O.ODO\nNTS=0\nDT=DTI qOT=QOMAX TESTE=.FALSE.\nEND IF\nENDIF\nENDIF\nnno\to aaQ\u00f4nao\nRETURN END\nCALCULO DAS PROPRIEDADES DOS FLUIDOS DEPENDENTES DAS PRESS\u00d5ES NA ITERACAO ANTERIOR (passo de tempo n)\na partir desta sub nao existe po(ip,jp,kp,l) e sw(ip,jp,kp,l)\nSUBROUTINE FPOA\nIMPLICIT DOUBLE PRECISION(A~H,O~Z)\nPARAMETER(NLAB~18,NXM=08,NYM=05,NZM=04)\nCOMMON/NCEL/DBDX,DBDY,DBDZ,WRC,NBLOC,NXC,NYC,NZC,NBP,\n*\tNXR,NYR,NZR,NQL,NQS,NQI,IP,JP,KP\nCOMMON/LPVTO/POL,BOL,VOL,DOL,RSOL,POLS,BQLS,VOLS,DOLS,NPO,NPOS\nCOMMON/LPVTW/PWL,BWL, VWL,DWL,RSWL,NPW\nCOMMON/TSA/POA,SOA,SGA,SWA\nCOMMON/PVTA/BOA,RSOA,BWA\nDIMENSION POL(NLAB),BOL(NLAB),V0L(NLAB),DOL(NLAB),RS0L(NLAB),\n*\tPOLS(NLAB) ,BOLS(NLAB),VOLS(NLAB),DOLS(NLAB)\nDIMENSION PWL(NLAB).BWL(NLAB),VWL(NLAB),DWL(NLAB),RSWL(NLAB)\nDIMENSION PDA(NXM,NYM,NZM,2),S0A(NXM,NYM,NZM,2),\n*\tS GA(NXM,NYM,NZM,2),SWA(NXM,NYM,NZM,2)\nDIMENSION BOA(NXM,NYM,NZM,2),BWA(NXM,NYM,NZM,2)\nFuncoes de POA\nLX-NXR\nLY=NYR\nLZ=NZR\nDO 10 L=i,2\nIF(L.EQ.2) THEN\nLX=NXC LY-NYC\nENDIF\nLZ=NZC\nDO 5 1=1,LX\nDO 5 J=T ,LY\nDO 5 K=1,LZ\n*\nCONTINUE\nCONTINUE\nRETURN END\nIF(L.EQ.2.AND.I.EQ.IP.AND.J.EQ.JP.AND.\nK.GE.KP.AND.K-LT.KP+NBP) GO TO 5\nIF(POA(I,J,K,L).GE.POLS(i)) THEN\nCALL INTER(PGLS,BOLS,NPOS,POA(I,J,K,L),BOA(I,J,K,L),AUX) ELSE\nCALL INTER(POL,BOL,NPO,POA(I,J,K,L),BOA(I,J,K,L),AUX) ENDIF\nCALL INTER(PWL,BWL,NPW,POA(I,J,K,L),BWA(I,J,K,L),AUX)\nono\ta nannao\nCALCULO DAS PROPRIEDADES DOS FLUIDOS DEPENDENTES DAS PRESS\u00d5ES NA ITERACAO PRESENTE E DAS PRESS\u00d5ES NA INTERFACES\nSUBROUTINE FPPOM(PWF,WX,WY,WZ)\nIMPLICIT DOUBLE PRECISION(A-H,O-Z)\nPARAMETER(NLAB=18,NXM=08,NYM=05,NZM=04)\nCOMMON/NCEL/DBDX,DBDY,DBDZ,WRC,NBLDC,NXC,NYC,NZC,NBP,\n*\tNXR,NYR,NZRJ$QL,NQS,11QI,IP,JP,KP\nCOMMON/LPVTO/POL,BOL,VOL,DOL,RSOL,POLS,BOLS,VOLS,DOLS >NPO,NPOS\nCOMMON/LPVTW/PWL,BWL,VWL,DWL,RSWL,NPW\nCOMMON/LPVTG/PGL,BGL,VGL,DGL,NPG\nCOMMON/TS/PO,SO,SG,SW\nCOMMON/PVT/BO,DBO,VO,DVO,DO,DDO,RSO,DRSO,BW,DBW,VW,DVW,DW,DDW,CW COMMON/IFACEX/BOMX,VOMX,DOMX,BWMX,VWMX,DWMX\nCOMMON/IFACEY/BOMY ,VOMY,DOMY,BWMY,VWMY,DWMY\nCOMMON/IFACEZ/BOMZ,VOMZ,DOMZ , BWMZ ,VWMZ,DWMZ\nDIMENSION POL(NLAB) , BOL (NUB) ,VOL(NLAB) ,DOL(NLAB) ,RSOL(NLAB) ,\n*\tPOLS(NLAB),BOLS(NLAB),VOLS(NLAB),DOLS(NLAB)\nDIMENSION PWL(NLAB),BWL(NLAB),VWL(NLAB),DWL(NLAB),RSWL(NLAB)\nDIMENSION PGL(NLAB),BGL(NLAB),VGL(NLAB),DGL(NLAB)\nDIMENSION PO(0:NXM+1,O:NYM+1,0:NZM+1,2),S0(NXM,NYM,NZM,2),\n*\tSG(NXM,NYM,NZM,2) ,SW(NXM,NYM,NZM,2)\nDIMENSION BO(NXM,NYM,NZM,2),DBD(O:NXM+1,0:NYM+1,0:NZM+1,2),\n*\tVO(NXM,NYM,NZM,2),DVO(O:NXM+1,0:NYM+1,0:NZM+1,2) ,\n*\tDO(NXM,NYM,NZM,2),DDO(O:NXM+1,0:NYM+1,0:NZM+1,2) ,\n*\tBW(NXM,NYM,NZM,2),DBW(0:NXM+l,0:NYM+l,0:NZM+l,2),\n*\tVW(NXM,NYM,NZM,2) ,DVW(O:NXM+1,O:NYM+1,O:NZM+1,2) ,\n*\tDW(NXM,NYM,NZM,2),DDW(O:NXM+1,0 :NYM+1,0:NZM+1,2),\n*\tCW(NXM,NYM,NZM,2)\nDIMENSION BOMX(0:NXM+1,NYM,NZM,2),VOMX(0:NXM+1,NYM,NZM,2),\n*\tDOMX(0:NXM+1,NYM,NZM,2),BWMX(0:NXM+1, NYM ,NZM,2),\n*\tVWMX(0:NXM+l,NYM,NZM,2),DWMX(0:NXM+1,NYM,NZM,2)\nDIMENSION BOMY(NXM,NYM+1,NZM,2),VOMY(NXM,NYM+1,NZM,2),\n*\tDOMY(NXM,NYM+1,NZM,2),BWMY(NXM,NYM+1, NZM,2),\n*\tVWMY(NXM,NYM+1,NZM,2),DWMY(NXM,NYM+1,NZM,2)\nDIMENSION BOMZ(NXM,NYM,NZM+1, 2),VOMZ(NXM,NYM,NZM+1,2),\n*\tDOMZ(NXM,NYM,NZM+1, 2),BWMZ(NXM,NYM,NZM+1,2),\n*\tVWMZ(NXM,NYM,NZM+1,2),DWMZ(NXM,NYM,NZM+1,2)\nooa\tnon a no\tnano\n5\nDO 4 L=l,2\nIF(L.EQ.2) THEN\nNX=NXC\nNY=NYC\nNZ=NZC\nENDIF\nDO 5 1=1,NX\nDO 5 J=1,NY\nDO 5 K=13NZ\nIF(L.EQ.2.AND.I.EQ.IP.AND.J.EQ.JP.AND.\n*\tK.GE.KP.AND.K.LT.KP+NBP) GO TO 5\nIF(PO(I,JtK,L).GT.POLS(l)) THEN\nCALL\t'\t\u2018\t'\nCALL\nCALL\nELSE\nCALL\nCALL\nCALL\nENDIF\nCALL INTER(PWL,BWL,NPW,PD(I,J,K,L),BW(I,J,K,L),DBW(I,J,K,L)> CALL INTER(PWL,VWL3NPW,PO(I,J,K,L),VW(I,J,K,L),DVW(I,J,K,L)) CALL INTER(PWL,DWL,NPW,PD(I,J,K3L) ,DWd, J,K,L) ,DDW(I, J,K,L)) CW(I,J,K3L)=DDW(I,J,K,L)/DW(I,J3K3L)\nCONTINUE\nINTER(POLSJBOLS,NPOS3PO(IiJ,K,L),BO(IlJ,K,L) ,DBO(I, J,K,L) )\nINTERCPOLSjVOLS,NP0S3P0(I,J,K,L)fV0(I,JjK,L),DV0(I,J,K,L)) INTER(P\u00a3JLS,DQLS,NPOS,POd,J,K,L),DOd,J,K3L)fDDOd,J,K3L))\nINTER(PDL,BOLfNPO,POd,J,K,L),BOd,J,K,L) iDBD(IIJ3K3L)) INTER(POL,VOL,NPO,PO(I,J,KtL),V0(I3J,K,L) ,DVO(I,J,K,L)) INTER(POL,DOL3NPO,POd,J,K,L),DOd,J,K,L),DDOd,J,K>L))\nFuncoes PVT das pr. nas interfaces X,Y e Z internas (usam sub. saux.) Interface d3j3k) - face do poco GRID RADIAL\nIF(L.EQ.l) THEN\nDO 10 J=1,NY\nDO 10 K=1,NZ\nCALL SAUX(PWFtBOMX(l,J,K,L),VOMX(1,J,K,L),DOMX(1,J,K3L) ,\n*\tBWMX(13J,K,L),VWMX(1,J,K,L) ,DWMXd,J,K,L))\n10\tCONTINUE\nENDIF\nInterfaces X (apenas as interfaces internas da malha) Na face externa3I-NX+l, e 1=0 as funcoes sao iguais a ZERO\ncartesiano\nIF(L.EQ.2) THEN\nW=0.EDO\nDO 20 1=2,NX\nDO 20 J=1,NY\nDO 20 K=ljNZ IF(K.GE.KP.AND.K.LT.KP+NBP) THEN\nIF(I-EQ.IP.AND.J.EQ.JP.OR.I.EQ.IP+1.AND.J,EQ.JP) GO TO 20 ENDIF\nP0M=(1.ODO-W)*P0(I-1,J,K\u00bbL)+W*P0(I, J, K, L)\nCALL SAUX(P0M3B0MXd,J,K,L)3V0NX(I,J,K3L) 3D0MX(I, J,K,L) ,\n*\tBWMXd,J,K,L),VWMX(I,J,K3L) ,DWMX(I, J ,K ,L) )\n20 CONTINUE\nENDIF\nradial\nIF(L.EQ.l) THEN\nDO 21 1=2,NX\nDO 21 J-1,NY\nDO 21 K=13NZ\n*\n*\n*\n21\nIF(I.EQ.NX) THEN\nIF(J.LE.NQL) then\nIF(IP.EQ.NXC) GO TO 21\nIX-IP+1\nJX=JP\nENDIF\nIF(J.GT.NQL.AND.J.LE.Nqt+NQS) THEN\nIF(IP.EQ.NYC) GO TO 21\nIX=IP\nJX=JP+1\nENDIF\nIF(J.GT.NQL+NQS.AND.J.LE.NQS+2*NQL) THEN IF(IP.EQ.l) GO TO 21 IX=IP-1 JX=JP\nENDIF\nIF(J.GT.NQS+2*NQL) THEN\nIF(JP.EQ.l) GO TO 21\nIX-IP\nJX=JP-1\nENDIF\nP0M=(1.ODO-WRC)*PO(NX,J,K,1)+WRC*PO(IX,JX,KP+K-1,2)\nCALL SAUX(POM,BOMX(I+1,J,K,1),V0MX(I+l,J,K,1), DOMX(I+1,J,K,1),BWMX(I+1,J,K,1), VWMX(I+1,J,K,1),DWMX(I+1,J,K,1))\nENDIF\nPOM=(1.ODO-WX)*PO(I-1,J,K,1)+WX*PO(I,J,K,L)\nCALL SAUX(POM,BOMX(I> JjKiLXVOMXtl, J,K,L) ,DOMX(I,J,KtL) , BWMX(I,J,K,L),VWMX(I,J,K,L),DWMX(I,J,K,L))\no ao\to oo\nCONTINUE END IF\nInterfaces 2 (apenas as interfaces internas da malha)\nDO 40 1*1,NX\nDO 40 J=1,NY\nDO 40 K=2,NZ IF(L.EQ.2.AND.I.EQ.IP.AND.J.EQ.JP) THEN IF(K.GE.KP.AND.K.LT.KP+NBP) GO TO 40 ENDIF\nPOM*(1.0D0-WZ)*P0(I,J,K~1,L)+WZ*PO(I,J,K,L)\nCALL SAUX(POM,BOMZ(I,J,K,L),VDMZ(I,J,K,L),DOMZ(I,J,K,L) ,\n*\tBWMZ(I,J,K,L),VWMZ(I,J,K,L) ,DWMZ(I,J,K,L))\n40 CONTINUE\nInterfaces Z (primeira e ultima face para o grid radial)\n*\nIF(L.EQ.l) THEN\nIF(KP.NE.l) THEN\nDO 41 1=1,NX\nDO 41 J*1,NY\nP0M\u00bb(1.0D0-WZ)*P0dP,JP,KP-l,2)+WZ*P0d, J ,1,1)\nCALL SAUX(POM,BOMZ(I,J,1,1),V0MZ(I,J,1,1),D0MZ(I,J,1,1) , BWMZ(I,J,1,1),VWMZ(I,J,1,1),DWMZ(I,J,1,1))\nCONTINUE\nENDIF\nIF(KP+NBP-1.LT.NZC) THEN\nDO 42 1=1,NX\nDO 42 J=1 NY\nPOM=(1.ODO-WZ)*PO(I,J,NZR,1)+WZ*PO(IP,JP,KP+NBP,2)\nCALL SAUX(POM,BOMZ(I,J,NZR+l,l),VOMZd,J,NZR+l,l),\n*\tDOMZ(I,J,NZR+1,1),BWMZ(I,J,NZR+1,1),\n*\n42\nCONTINUE ENDIF\nENDIF\nVWMZ(I , J (NZR+1, 1) ,DWMZ(I , J,NZR+1, 1) )\n\u00d3O\u00d3\tO \u00d3OUW\t\u00dc\tu UUOO\u00dcO\nInterfaces Y (apenas as interfaces internas da malha)\nLINF=1\nLSUP=NY\nIF(L.EQ.2) THEN\nLINF=2\nENDIF\nDO 50\nDO\n*\n1=1,NX\n50 J=LINF,LSUP\nDO 50 K=1,NZ IF(L.EQ.2.AND.K.GE.KP.AND.K.LT.KP+NBP) THEN\nIFd.EQ.IP.AND.J.EQ.JP. OR.\nI.EQ.IP.AND.J.EQ.JP+1) GO TO 50 ENDIF\nAUXP=PO(I,J\"1,K,L)\nIF(L.EQ,1.AND,J.EQ.1) AUXP=PO(I,NY,K,L) P0M=(1.ODO-WY)*AUXP+WY*PO(I,J,K,L)\nCALL SAVX(P0M,B0MY(I,J}K,L) ,V0MY(I,J,K,L) ,D0MY(I, J,K,L) ,\nBWMY(I,J,K,L),VWMY(I,J,K,L) ,DWMY(I,J,K,L))\nCONTINUE CONTINUE\nRETURN END\nSubrot. auxiliar para calculo das funcoes das pressoes nas interfaces\nSUBROUTINE SAUX(P0M,BOM,VOM,DOM,BWM,VWM,DWM)\nIMPLICIT DOUBLE PRECISI0N(A-H,0-Z)\nPARAMETER(NLAB=18)\nC0MM0N/LPVT0/P0L,BOL, VOL,DOL,RSOL,POLS,BOLS,VOLS,DOLS,NPO,NPOS\nCOMMDN/LPVTW/PWL,BWL, VWL,DHL,RSWL,NPW\nDIMENSION PDL(NLAB) ,BOL(NLAB) ,VOL(NLAB) ,DOL(NLAB) ,RSOL(NLAB) ,\n*\tPOLS(NLAB),BOLS(NLAB),VOLS(NLAB),DOLS(NLAB)\nDIMENSION PWL(NLAB),BWL(NLAB),VWL(NLAB),DWL(NLAB),RSWL(NLAB)\nIF(POM.GT.POLS(1)) THEN\nCALL INTER(POLS,BOLS,NPOS,POM,BOM,AUX)\nCALL INTER(POLS,VOLS,NPOS,P0M,V0M,AUX)\nCALL INTER (POLS >DOLS,NPOS , POM,DOM,AUX)\nELSE\nCALL INTER(POL,BOL,NPO,POM,BOM,AUX)\nCALL INTER(POL, VOL,NPO,POM,VOM,AUX)\nCALL INTER (POL,DOL,NPO,POM,DOM,AUX)\nENDIF\nCALL INTER(PWL,BWL,NPW,POM,BWM,AUX)\nCALL INTER(PWL,VWL,NPW,POM,VWM,AUX)\nCALL INTERtPWL,DWL,NPW,POM,DWM,AUX)\nRETURN\nEND\nSUBROUTINE TRANS\nC\nIMPLICIT DOUBLE PRECISION(A~H,O-Z)\nPARAMETER(NLAB=18,NXM-08,NYM=05,NZM=O4)\nCOMMON/SIM/DT,DTMAX,DTMIN,TOLP,TOLS,DSLIM,DPLIM,TSIM,\n*\tQOMAX,QOMIN,PWMIN,BSOR,JPRDD.MSOLU,ITMAX,ITMIN COMMON/NCEL/DBDX, DBDY, DBDZ, WRC ,NBLOC ,NXC, NYC, NZC, NBP,\n*\tNXR,NYR,NZR,NQL,NQS,NQI,IP,JP,KP\nCOMMON/RES/DGAS,CR,PRIN,TEMP,ZC,RW,RE,SWIN,PHI,PERX,PERY,\n*\tPERZ,ZCOW,INDPOR >INDPER\nCOMMON/LPETR/SWL,KRWL tKROL,SLL ,PCOWL,NKR,NPC COMMON/MALHA/ZB,RB,VPOR,DRO,WX,WY,WZ,FFX,FFY,FEZ,DTETA COMMON/TS/PO,SO,SG,SW\nCOMMON/IFACEX/BOMX,VOMX,DOMX,BWMX,VWMX,DWMX\nCOMMON/IFACEY/BOMY,VOMY,DDMY,BWMY,VWMY,DWMY\nCOMMON/IFACEZ/BOMZ,VOMZ,DOMZ ,BWMZ,VWMZ,DWMZ COMMON/PETR/KRO , KRW,DKRO,DKRW,PC,DPC COMMON/DTRANS/TOX,TWX,TOY,TWY,TOZ,THZ,\n*\tTOX1SA,TOX1SI,TWX1SA,TWX1SI,\n*\tT0X2SI,T0X2SP,TWX2SI,TWX2SP,\n*\tTOY1SA,TOY1SI,TWY1SA,TWY1SI,\n*\tT0Y2SI,T0Y2SP,TWY2SI,TWY2SP,\n*\tTOZ1SA,TOZ1SI,TWZ1SA,TWZ1SI,\n*\tT0Z2SI,T0Z2SP,TWZ2SI,TWZ2SP\nCOMMON/TF/TFLUXO,TFLUXW,SUMTO,SUMTW,AFXO,AFXW\nDIMENSION SWL(NLAB),SLL(NLAB),PCOWL(NLAB)\nREAL+8 KRWL(NLAB),KROL(NLAB)\nDIMENSION ZB(O:NXM+1,NYM,2),RB(NXM+1),VP0R(NXM,NYM,NZM,2),\n*\tFFX(NXM+1,NYM,NZM,2),FFY(NXM+1,NYM,NZM,2),\n*\tFFZ(NXM+1,NYM,NZM+1,2),DTETA(NYM+1)\nDIMENSION PO(0:NXM+1,O:NYM+1,O:NZM+1,2),S0(NXM,NYM,NZM,2),\n*\tSG(NXM,NYM,NZM,2),SW(NXM,NYM,NZM,2)\nDIMENSION PHI(NXM,NYM,NZM,2),PERX(NXM,NYM,NZM,2),\n*\tPERY(NXM,NYM,NZM,2),PERZ(NXM,NYM,NZM,2) DIMENSION BOMX(0:NXM+1,NYM,NZM,2),VOMX(0:NXM+1,NYM,NZM,2),\n*\tDOMX(O:NXM+1,NYM,NZM,2),BWMX(O:NXM+1,NYM,NZM,2),\n*\tVWMX(O:NXM+1,NYM,NZM,2),DWMX(0:NXM+1,NYM,NZM,2)\nDIMENSION B0MY(NXM,NYM+l,NZM,2),V0MY(NXM,NYM+l,NZM,2),\n*\tDOMY(NXM,NYM+1,NZM,2),BWMY(NXM,NYM+1,NZM,2),\n*\tVWMY (NXM, NYM+1, NZM, 2 ), DWMY (NXM, NYM+1, NZM, 2 )\nDIMENSION BOMZ(NXM,NYM,NZM+1,2), VOMZ(NXM,NYM,NZM+1,2),\n*\tDOMZ(NXM,NYM,NZM+1,2),BWMZ(NXM,NYM,NZM+1,2),\n*\tVWMZ (NXM, NYM, NZM+1,2), DWMZ (NXM, NYM, NZM+1,2) DIMENSION DKRO(NXM,NYM,NZM,2),DKRW(NXM,NYM,NZM,2),\n*\tPC(0:NXM+1,O:NYM+1,0:NZM+1,2),DPC(O:NXM+1,0:NYM+1,0:NZM+1,2)\nREAL*8\tKRO(NXM,NYM,NZM,2),KRW(NXM,NYM,NZM,2)\nDIMENSION TOX(NXM+1,NYM,NZM,2),TWX(NXM+1,NYM,NZM,2),\n*\tTOX1SA(NXM,NYM,NZM,2),TOX1SI(NXM,NYM,NZM,2),\n*\tTWX1SA(NXM,NYM,NZM,2),TWX1SI(NXM,NYM,NZM,2),\n*\tT0X2SI(NXM,NYM,NZM,2),T0X2SP(NXM,NYM,NZM,2),\n*\tTWX2SI(NXM,NYM,NZM,2),TWX2SP(NXM,NYM,NZM,2)\nDIMENSION T0Y(NXM,NYM+l,NZM,2),TWY(NXM,NYM+1,NZM,2),\n*\tTOYISA(NXM,NYM,NZM,2),TOY1SI(NXM,NYM,NZM,2),\n*\tTWY1SA(NXM,NYM,NZM,2),TWY1SI(NXM,NYM,NZM,2),\n*\tT0Y2SI(NXM,NYM,NZM,2),T0Y2SP(NXM,NYM,NZM,2),\n*\tTWY2SI(NXM,NYM,NZM,2),TWY2SP(NXM,NYM,NZM,2)\na o a a ao\tq\ta o oao q a aa\tn\tan qq\nDIMENSION\tTOZ(NXM,NYM,NZM+1,2),TWZ(NXM,NYM,NZM+1,2),\n*\tT0ZlSA(NXM,NYM,NZMt2),TOZ1SI(NXM,NYM,NZM,2),\n*\tTWZ1SA(NXM,NYM,NZM,2),TWZ1SI(NXM,NYM,NZM,2),\n*\tT0Z2SI(NXM,NYM,NZM,2),TOZ2SP(NXM,NYM,NZM,2),\n*\tTWZ2SI(NXM,NYM,NZM,2),TWZ2SP(NXM,NYM,NZM,2)\nINTEGER\tDELTO,DELTW,DTD(NYM,NYM), DTW(NYM,NYM)\nDet, de perm, relat, ao oleo e a agua,press\u00f5es capilares e derivadas\nDO 1 1=1,NXR\nDO 1 1=1,NYR\nDO 1 K=1,NZR\nCALL INTER(SWL,KROL,NKR,SW(I,J,K,1),KRD(I,J,K,1),DKR0(I,J,K,1))\nCALL INTER(SWL,KRWL,NKR,SW(I,1,K,1),KRW(I,J,K,1),DKRW(I,1,K,1))\nCALL INTER(SLL,PCOWL,NPC,SW(I,J,K,1),PC(I,J,K,1),DPC(I,J,K,1))\nCONTINUE\nDO 2 1=1,NXC\nDO 2 1=1,NYC\nDO 2 K=1,NZC\nIF(I,EQ.IP.AND.J.EQ.JP.AND.K.GE.KP.AND.K.LT.KP+NBP) GO TO 2\nCALL INTER(SWL,KROL,NKR,SW(I,1,K,2),KR0(I,J,K,2),DKR0(I,J,K,2))\nCALL INTER(SWL,KRWL,NKR,SW(I,J,K,2),KRW(I,J,K,2),DKRW(I,J,K,2))\nCALL INTER(SLL,PC0WL,NPC,SW(I,l,K,2),PC(I,J,K,2),DPC(I,J,K,2)) CONTINUE\nNX=NXR\nNY=NYR\nNZ=NZR\nDO 1000 L=l,2\nIF(L.EQ.2) THEN\nVerificacao dos sentidos de fluxo para as fases oleo e agua para \"head\" positivo :delto e deltw =1 (fluxo para o poco) para \u2019\u2019head\" negativo : deito e deltw =0 (fluxo contra o poco)\nBlocos do poco - GRID RADIAL\nTransmissibilidades ao oleo e a agua no poco ,derivadas dT/dSw\nIF(L.EQ.l) THEN\n00 40 1=1,NY\nDO 40 K=1,NZ\nTOX(1,1,K,L)=FFX(1,1,K,L)*BOMX(1,I,K,L)*KRO(1,1,K,L)/VQMX(1,1,K,L)\nTWX(l,J,K,L)=FFX(l,J,K,L)*BWMX(l,I,K,L)*KRW(i,J,K,L)/VWMX(l,J,K,L)\nT0X1SI(1,J,K,L)=FFX(1,1,K,L)*BOMX(1,I,K,L)*DKRO(1,1,K,L)/\n*\tVOMX(1,1,K,L)\nTWX1SI(1,1,K,L)=FFX(1,J,K,L)*BWMX(1,J,K,L)*DKRW(1,J,K,L)/\n*\tVWMX(1,J,K,L)\n40 CONTINUE\nEND IF\na a,C3\to n\nBlocos (l,jtk)\nDD 50 >1,NY\nDO 50 K=1,NZ IF\u00cdL.EQ.Z.AND.K.GE.KP.AND.K.LT.KP+NBP) THEN\nIF(IP.EQ.1.AND.J.EQ.JP.OR.\n*\tIP.EQ.2.AND.J.EQ.JP) GO TO 50 ENDIF\nHEAD=P0(2,J,K,L)-PO(1,J,K,L)+D0MX(2,J,K,L)*(ZB(2,J.Lj-ZBCl,Jt L) ) DELTO=1\nIF(HEAD.LT.O.ODO) delto=o\nHEAD\u00bbPO(2,J,KiL)-PO(l\u00edJ,K>L)-PC(2,J,K,L)+PC(1,J,K,L)+\n*\tDWMX(2,J,K,L)*(ZB(2,J,L)-ZB(1,J,L)) DELTW=1\nIF(HEAD.LT.O.ODO) DELTW=0 T0X2SI(1,J,K,L)=(1-DELTO)*FFX(2,J,K,L)*B0MX(2,JjKjL)*\n*\tDKR0(1jJ)KiL)/V0MX(2,JiK,L)\nT0X2SP(l,J,K,L)=DELT0*FFX(2,J,K,L)*B0MX(2,J,K,L)*\n*\tDKR0(2,J,K,L)/V0MX(2,J\u00edK,L)\nTWX2SI\u00cd1,J,K1L)=(1-DELTW)*FFX(2,J,K,L)*BWMX(2,JjKjL)*\n*\tDKRW(1,J,K,L)/VWMX(2,J,K,L) TWX2SP(1,J,K,L)=DELTW*FFX(2,J,K}L)*BWMX(2,J,K,L>*\n*\tDKRW(2,J,K,L)/VWMX(2,J,K,L) DT0(J,K)=DELT0\nDTW(J,K)\u00abDELTW\n50 CONTINUE\nINTERFACES X:Transmissib. ao oleo e a agua e suas derivadas dT/dSw\nDO 10 K=1,NZ\nDO 10 J=1,NY\nDO 10 I\u00ab2,NX-1\nIF\u00cdI.EQ.2) THEN\nDELTQ=DTO(J,K)\nDELTW=DTW(J,K)\nENDIF\nIF(L.EQ.2.AND.K.GE.KP.AND.K.LT.KP+NBP) THEN\nIF(I.EQ.IP.AND.J.EQ.JP) GO TO 10\nIF(I.EQ.IP+1.AND.J.EQ.JP)GO TO 11\nENDIF\nT0X(I,J,K,L)=DELTD*FFX(I,J,K,L)*BOMX(I,J,K,L)*KRO(I,J,K,L)/\n*\tVOMX\u00cdI.JXLJ + Cl-DELTO^FFXCI.JJC.L)*\n*\tBOMX(I,J,K,L)*KRO(I-1,J,K,L)/VOMX(I,J,K,L)\nTWX(I,J\u00edKjL)=DELTW*FFX(I,j,k,l)*bwmx(i,j,k,l)*krw(i,j,k,l)/\n*\tVWMX(I,J\u00edK)L) + (1-DEI.TW)*FFX(I)JjK,L)*\n*\tBWMX(I,J)K)L)*KRW(I-1,JjKiL)/WMX(I,J,K)L)\nTOX1SA(I,J,K,L)^(1-DELTO)*FFX(I,J,K,L)*BOMX(I,J,K,L)*\u2019\n*\tDKRO(I-1,J,K,L)/VOMX(I,J,K,L) TOXlSI(I,J,K,L)=DELTD*FFX(I,J,KtL)*BOMX(I,J,K,L)*DKRO(I,J,K,L)/\n*\tV0MX(I,J,K,L)\nTWXlSAd,J,K,L)B<l-DELTW)*FFXd,J,K,L)*BWMXd,J,K,L)*\n*\tDKRW(I-1,J,KjL)/VWMX(I,JjK,L)\nTWX1SI(I,J,K,L)=DELTW*FFX(I,JJK>L)*BWMX(I,J,K,L)*\n*\tDKRWCI, J,K,L)/WMX(I,J,K,L)\nC Repete-se a verificacao do sentido de fluxo para a pr\u00f3xima interface X\nIFCL.EQ.2.AND.I.EQ.IP-1.AND.J.EQ.JP)GO TO 10\n11\tHEAD=PO(I+1,J\u00edK)L)-P0(IiJjKjL)+D0MX(I+1jJ,K,L)*\n*\t(ZBd+l,J,L)-ZBd,J,L))\n1\u00d59\nDELTO=\u00cd.\nIF (HEAD. LT. 0. ODO) DELTOO\nHEAD=PO(I+1,J,K,L)-P0(I,J,K,L)-PC(I+1,J,K,L)+PC(I,J,K,L)+\n*\tDWMX(I+1,J,K,L)*(ZB(I+1,J,L)-ZB(I,J,L>)\ndeltw=i\nIF(HEAD.LT.0.ODO) DELTW=0\nT0X2SI(I, J ,K,L)SS(1-DELTO)*FFX(I+1, J,K,L)*BOMX(I+1,J,K,L)*\n*\tDKR0(I,J,K,L)/VOMX(I+1,J,K,L)\nT0X2SP(I,J,K,L)\u00abDELTO*FFX(I+1,J,K,L)*BOMX(I+1,J,K,L)*\n*\tDKRO(I+1,J,K,L)/VOMX(I+1,J,K,L)\nTWX2SI(I,J,KfL)=(l-DELTW)*FFX(I+l,J,K,L)*BWMX(I+1,J,K,L)*\n*\tDKRW(I,J,K,L)/VWMX(I+1,J,K,L)\nTWX2SP(I, J ,K,L)=DELTW*FFX(I+1, J,K,L)*BWMX(I+1, J ,K,L) *\n*\tDKRW(I+1,J,K,L)/VWMX(I+1,J,K,L)\nC\n10\tCONTINUE\na on no\nINTERF.X:Transmissib. ao oleo e a agua e suas derivadas dT/dSw na ULTIMA COLUNA de celulas (no limite do reserv. To e Tw = 0)\nRepete-se a verificacao do sentido de fluxo nas interfaces X\n*\n*\n*\n*\n*\n*\n*\nC\n*\n*\n*\nDC 20 1=1,NY\nDO 20 K=1,NZ\nIF(L.EQ.2.AND.K,GE.KP.AND.K,LT.KP+NBP) THEN\nIF(IP.EQ.NX-1.AND.J.EQ.JP.OR.\nIP.EQ.NX.AND.J.EQ.JP) GO TO 20 ENDIF\tv\nHEAD=PO(NX,J,K,L)-PO(NX-1,J,K,L)+DOMX(NX,J,K,L)* (ZB(NX,J,L)-ZB(NX-1,J,L))\nDELTO=1\nIF(HEAD.LT.O.ODO) DELTO=O\nHEAD^PO^NX,J,K,L)-PO(NX~1,J,K,L)-PC(NX>J,K,L)+PC(NX~1,J,K,L)+ DWMX(NX,J,K,L)*(ZB(NX,J,L)-ZB(NX-1,J,L))\nDELTW=1\nIF(HEAD.LT.O.ODO) DELTW=0\nTOXfNX,JJK,L)=DELTO*FFX(NX,J,K,L)*BOMX(NX,J,K,L)*KRO(NX,J,K,L)/ VOMX(NX,J,K,L)+\n(1-DELTO)*FFX(NX,J,K,L)*BOMX(NX,J,K,L)*\nKRO(NX-1,J,K,L)/VOMX(NX,J,K,L)\nTWX\u00c7NX,J\u00cdK,L)=DELTW*FFX(NX,J,K,L)*BWMX(NX,J,K,L)*KRW(NX,J,K,L)/\nVWMX(NX,J,K,L)+\n(1-DELTW)*FFX(NX,J,K,L)*BWMX(NX,J,K,L)* KRW(NX-1,J,K,L)/VWMX(NX,J,K,L)\nTOX1SA(NX,J,K,L)=(1~DELTO)*FFX(NX,J,KfL)*BOMX(NX,J,K,L)*\nDKRO(NX-1,J,K,L)/VOMX(NX,J,K,L)\nT0X1SKNX, J, K, L) =DELTO*FFX (NX, J,K,L)*BOMX (NX, J, K,L) *\nDKRO(NX,J,K,L)/VOMX(NX,J,K,L)\nTWX1SA(NX,J,K,L)=(1\"DELTW)*FFX(NX,J,K,L)*BWMX(NX,J,K,L)*\n<\tDKRW(NX-1,J,K,L)/VWMX(NX, J, K, L )\nTWX1SI(NX,J,K,L)=DELTW*FFX(NX,J,K,L)*BWMX(NX,J,K,L)*\n\u00ab\tDKRW(NX,J,K,L)/VWMX(NX,J,K,L)\n*\nC transmissibilidade e derivadas na face externa IF(L.EQ.l) THEN\nIF(J.LE.NQL) THEN\nIF(IP.EQ.NXC) GO TO 20\nIX=IP+1 JX=JP ENDIF IF(J.GT.NQL,AND.J.LE.NQL+NQS) THEN\nIF<JP.EQ,NYC) GO TO 20\nIX-IP\nJX=JP+1 ENDIF\nIF(J. GT.NQL+NQS.AMD.J.LE.NQS+2*NQL) THEN\nIF(IP.EQ.l) GO TO 20\nIX=IP-1\nJX=JP\nENDIF\nIF(J.GT.NQS+2*NQL) THEN\nF(JP.Eq.l) GO TO 20\nX=IP\nX=JP-1\n*\n*\n*\n*\nENDIF\nAKROC=KRO(IX,JX,KP+K-1,2)\nAKRWOKRW(IX,JX,KP+K-1,2)\nAUXBO=BOMX(NX+1,J,K,1)\nAUXBW=BWMX(NX+1,J,K,1)\nAUXDO=DOMX(NX+1, J,K,1)\nAUXDW=DWMX(NX+1, J, K, 1)\nAUXVO=VOMX(NX+1,J,K,1)\nAUXVW=VWMX(NX+1,J,K,1)\nHEAD=P0(IX,JX,KP+K-1,2)-P0(NX,J,K,1)+AUXD0*\n(ZB(NX,J,1)-ZB(IX,JX,2))\nDELTO=1\nIF(HEAD.LT.O.ODO) DELTO-O\nHEAD=PD(IX,JX,KP+K-1,2)-P0(NX,J,K,L)-PC(IX,JX,KP+K-1,2) + PC(NX,J,K,1)+AUXDW*(ZB(NX,J,1)-ZB(IX,JX,2))\nDELTW=1\nIF(HEAD.LT.0.ODO) DELTW=0\nTOX(NX+1,J,K,L)=DELTO*FFX(NX+liJ,K,L)*AUXBO*AKRDC/AUXVO+\n(1-DELTO)*FFX(NX+1, J,K,L)*AUXBO*KRD(NX, J,K,L)/AUXV0\nTWX(NX+1,J,K,L)=DELTW+FFX(NX+1,J,K,L)*AUXBW*AKRWC/AUXVW+\n(1-DELTW) *FFX (NX+1, J, K, L) * AUXBW+KRW (NX, J, K, L)/AUXVW\nc\n20\nT0X2SI(NX,J,K,L)=(1-DELTO)*FFX(NX+1,J,K,L)*AUXB0*\n*\tDKRO(NX,J,K,L)/AUXVD\nT0X2SP(NX,J,K,L)=DELTO*FFX(NX+1,J,K,L)*AUXBO*\n*\tDKRD(IX,JX,KP+K-1,2)/AUXVO\nTWX2SI(NX, J, K, L) = (1-DELTW)*FFX(NX+1,J,K,L)*AUXBW*\n*\tDKRW\u00cdNX,J,K,L)/AUXVW\nTWX2SP(NX,J,K,L)=DELTW*FFX(NX+1,J,K,L)*AUXBW*\n*\tDKRW(IX,JX,KP+K-1,2)/AUXVW\nENDIF\nCONTINUE\nono o ona an\nINTERFACES Z:Transmissib. ao oleo e a agua e suas derivadas dT/dSw\nVerificacao do sentido de fluxo nas interfaces Z\npara \"head'* positivo :delto e deltg =1 (fluxo para dentro \"do papel\") para \"head\" negativo :deito e deltg =0 (fluxo para fora \"do papel\") Res. horizontal a diferen\u00e7a entre ZB*s e ZERO.\nSentido de fluxo da 1 e 2 camada\nDO 60 1=1,NX\nDO 60 J=1,NY\nIF(L.EQ.2.AND.I.EQ.IP.AND.J.Eq.JP) THEN\nIF(KP.EQ.1.OR.KP.EQ.2) GO TO 60 ENDIF\nIF(L.EQ.1.AND.KP.NE.1) THEN\nC\n*\n*\n*\n*\n*\nC\nquando tem fluxo na primeira interface cilindro/cartes\u00edano HEAD=PO(IP,JP,KP\"1,2)-P0(I,J,1,1)~DOMZ(I,J,1,1)* (ZBd,J,l)\"ZBdP,JP,2))\nDELTO=1 IF(HEAD.LT.O.ODO) DELTO=O\nHEAD=P0(IP,JP,KP-l,2)\u2019P0(I,J,l,l)-PCdP,JP,KP-l,2)+PCd,J,l,l)-DWMZd,J,l,l)*(ZBd,J,l)-ZBdP,JP,2))\nDELTW=1 IF(HEAD.LT.O.ODO) DELTW=O\nTOZ(I,J,l,l)=DELTO*FFZd,J,l,l)*BOMZ(I, J,l,l)* KRO(IP,JP,KP-1,2)/V0MZ(I,J,1,1)+ (1~DELTO)*FFZ(I,J,1,1)*BOMZ(I,J,1,1)* KROd,J,ld)/VOMZd,J,l,l)\nTWZ(I,J,l,l)=DELTW*FFZd,J,l,l)*BWMZ(I,J,lfl)* KRW(IP,JP,KP*1,2)/VWMZ(I,J,1,1)+ (1-DELTW)*FFZ(I,J,1,1)*BWMZ(I,J,1,1)* KRW(I,J,1,1)/VWMZ(I,J,1,1)\nTOZ\u00cdSAd,J,l,l)=DELTO*FFZ(I,J,l,l)*BOMZd,J,l,l)* DKRO\u00cdIP,JP,KP~1,2)/V0MZ(I,J,1,1) TOZISId, J,l,l)=(l-DELTO)*FFZ(I,J,l,l)*BDMZd,J,l,l)* DKRO(I, J, 1,1)/VOMZ(I, J, 1,1)\nTWZ1SA(I,J,1,1)=DELTW*FFZ(I,J,1,1)*BWMZ(I,J,1,1)* DKRW(IP,JP,KP-1,2)/VWMZd,J,1,1) TWZlSIfl,J,l,1)=(1-DELTW)*FFZ(I,J,1,1)*BWMZ(I,J,1,1)* DKRW(I,J,1,1)/VWMZ(I,J,1,1)\n*\n*\n*\n*\n*\n*\n*\nENDIF\nHEAD=PO(I, J,1,L) -P0d,J,2,L)\nDELTO=1\nIF(HEAD.LT.O.ODO) DELTO=O\nHEAD=PO(I, J,l,L)-POd, J,2,L)~PC(I, J ,1 ,L)+PC(I, J,2,L)\nDELTW-1\nIF(HEAD.LT.O.ODO) DELTW=O\nT0Z2SI(I,J,lJL)\u00abDELT0*FFZ(I,J,2)L)*B0MZ(I,J,2,L)* DKRO(I,J,1,L)/VOMZ(I, J, 2, L)\nT0Z2SP(I,J,1,L)=(1-DELTO)*FFZ(I,J,2,L)*B0MZ(I,J,2,L)*\nDKRO(I,J,2,L)/VOMZ(I,J,2,L)\nTWZ2SI (I, J, 1 ,L)=DELTW*FFZ(I,J,2,L) *BWMZ(I,J,2 ,L) * DKRW(I,J,1,L)/VWMZ(I,J,2,L)\nTWZ2SPd,J,l,L)\u201c(l\u201cDELTW)*FFZ(I,J,2,L)*BWMZ(I,J,2,L)*\nDKRWd,J,2,L)/VWMZd,J,2,L)\nOTO d, J)~DELTO\nDTWd, J)=DELTW\nCONTINUE\nDO\nc\n*\n*\n*\n*\n60 C\n30 DO\n*\n*\n1=1,NX\n30 J=1,NY\nDO 30 K=2,NZ-1\nIF(L.EQ.2.AND.I.EQ.IP.AND.J.EQ.JP) THEN\nIF(K.GE,KP.AND.K.LT.KP+NBP) GO TO 30 ENDIF\nIF(L.EQ.2.AND.I.EQ.IP.AND.J.EQ.JP.AND.K.EQ.KP+NBP)GO TO 61\nIF(K.EQ.2) THEN\nDELTO=DTO(I,J)\nDELTW=DTW(I,J)\nENDIF TOZd,J,K,L)=DELTO*FFZ(I,J,K,L)*BOMZd,J,K,L)*\nKRO(I,J,K-l,L)/V0MZ(I,J,K,L) +\n(1-DELTO)*FFZ(I,J,K,L)*BOMZ(I,J,K,L)*\n*\tKRD(I,J,K,L)/VOMZ(I,J,K,L) TWZ(I, J ,K,L)=DELTW*FFZ(I, J ,K ,L)*BWMZ(I, J ,K,L) *\n*\tKRV(IU,K-1,L)/VWMZ(I,J>K,L) +\n*\t(i-DELTW)*FFZ(ItJ,K,L)*BWMZ(I,J,K,L)*\n*\tKRW(I,J,K,L)/VWMZ(I,J,K,L)\nTOZ1SA(I,J,K,L)=DELTO*FFZ(I,J,K,L)*BOMZ(I,J,K,L)*\n*\tDKRO(I,J,K-1,L)/VOMZ(I,J,K,L) TQZISKI, J,K,L)\u00bb(1-DELTO)*FFZ(I,J,K>L)*BOMZ(I, J,K,L)*\n*\tDKR0(I,J,K,L)/V0MZ(I,J,K,L) TWZ1SA(IIJ,K,L)=DELTW*FFZ(I,J,K,L)*BWMZ(I,JJK,L)*\n*\tDKRW(I,J,K-l,L)/VWMZ(I,J, K ,L) TWZ1SI(I,J,K,L)=(1-DELTW)*FFZ(I,J,K,L)*BWMZ(I,J,K,L)*\n*\tDKRW(I,J\u00bbK,L)/VWMZ(I>J,K,L)\nRepete-se a verificacao do sentido de fluxo para a pr\u00f3xima interface Z o res. e horizontal, dai deltaz=0\nIF(L.EQ.2. AND.I.EQ.IP.AND.J.EQ.JP.AND.K.EQ.KP~l)G0T0 30 61\tHEAD=PO(I,J,K,L)\"P0(I,JjK+ljL)\nDELTO=1\nIF(HEAD.LT.O.ODO) DELT0=0\nHEAD\u00abPO(I,J,K,L)-PDd,J,K+l,L)-PC(I,J,K,L)+PCd, J,K+1,L) DELTW^1 IF(HEAD.LT.O.ODO) DELTW=O\nT0Z2SI(I,J,KIL)=DELTO*FFZ(IfJ,K+1,L)*B0HZ(I,J,K+1,L)*\n*\tDKRO(I,J,K,L)/VOMZ(I,J,K+1,L) T0Z2SP(I, J,K,L)as(l-DELTO)*FFZ(I, J,K+1 ,L)*BOMZ(I, J,K+1 ,L)*\n*\tDKROd,J,K+l,L)/VOMZ(I,J,K+l,L) TWZ2SI(I,J,K,L)\u00aeDELTW*FFZ(I,J,K+1,L)*BWMZ(I,J,K+1,L)*\n*\tDm(I,J,K,L)/VWMZ(I,J,K+l,L) TWZ2SP(I,J,K,L)\u00ab(1-DELTW)*FFZ(I,J,K+1,L)*BWMZ(I,J,K+1,L)*\n*\tDKRW(I,J,K+1,L)/VWMZ(I,J,K+1,L)\n30\tCONTINUE\nca no\tcs n\nINTERF.Z:Transmissib. ao oleo e a agua e suas derivadas dT/dSw na ultima camada de c\u00e9lulas (no limite do reserv. To e Tw = 0)\nc\nDO 35 I\u201c1,NX\nDO 35 J=1,NY\nIF(L,EQ .2. AND.I.EQ.IP.AND. J.EQ. JP. AND. KP+NBP-1 .GE. NZC-l) GOTO 35\nHEAD=P0(I,J,NZ-1,L)-PO(I,J,NZ,L)\nDELTO=1\nIF(HEAD.LT.0.0D0) DELTO=O\nHEAD=Pa(I,J,NZ-l,L)-POdJJ,NZ,L)-PC(I,J,NZ-l,L)+PC(I,J,NZ>L)\nDELTW=i\nIFCHEAD,LT.0.0D0) DELTW=O\nT0Z(I,J,NZ,L)~DELTD*FFZ(I,J,NZ,L)*BOMZ(I,J,NZ,L)*\n*\tKRO(I,J,NZ~1,L)/VOMZ(I,J,NZ,L)+\n*\t(1-DELTD)*FFZ(I,J,NZ,L)*BOMZ(I,J,NZ,L)*\n*\tKRO(I,J,NZ,L)/VOMZ(I,J,NZ,L)\nTWZ(I, J,NZ,L)=DELTW*FFZ(I, J,NZ,L)*BWMZ(I, J,NZ,L)*\n*\tKRWd,J,NZ-l,L)/VWMZ(I, J,NZ,L) +\n*\t(l-DELTW)*FFZd,J,NZ,L)*BWMZ(I,J,NZ,L)*\n*\tKRW(I,J,NZ,L)/VWMZd,J,MZ1L)\nTOZ1SA(I, J,NZ,L)=DELTO*FFZ(I, J,NZ,L)*BOMZ(I, J,NZ,L)*\n*\tDKRO\u00cdI,J,NZ-1,L)/V0MZ(I,J,NZ,L)\nT0Z1SI(I\u00edJ,NZ,L)\u00bb(1-DELT0)*FFZ(I,J,KZ,L)*B0MZ(I>J,NZ,L)*\n*\tDKROd, J,KZ,L)/VOMZ(I, J ,NZ,L)\nTWZ1SA(I,J,NZ,L)=DELTW*FFZ(I,J,NZ,L)*BWMZ(I,J,NZ,L)*\n*\tDKRW(I,J,NZ-1,L)/VWMZ(I,J,NZ,L)\nTWZ1SI(I,J,NZ,L)=(1-DELTW)*FFZ(I,J,NZ,L)*BWMZ(I,J,NZ,L)*\n*\tDKRW(I, J,NZ,L)/WMZd, J,NZ,L)\nC quando tem fluxo na ultima interface cilindro/cartesiano\nIFCL.EQ.1.AND.KP+NBP-1.LT.NZC) THEN\nC\tHEAD=PD(1,1,NZR, 1)-PO(IP,JP,KP+NBP,2)\nHEAD=P0(I\u00bbJ,NZR, 1)-PD(IP,JP,KP+NBP,2)-D0MZ(I,JfNZR+1,1)*\n*\t(ZB(lP,JP,2)-ZBd,J,l))\nDELTO=1 IF(HEAD.LT.O.ODO) DELT0=0\nHEAD=P0(I,J,NZR,1)-PO(IP,JP,KP+NBP,2)-\n*\tPC(I,J,NZR,1)+PC(IP,JP,KP+NBP,2)\u201cDWMZ(I,J,NZR+1,1)*\n*\t(ZB(IP,JP,2)-ZB(I,J,1))\nDELTW=1\nIF(HEAD.LT.O.ODO) DELTW=0\nT0Z(I,J,NZR+1,1)=DELTO*FFZ(I,J,NZR+1,1)*BOMZ(I,J,NZR+1,1)*\n*\tKRO(I,J,NZR,1)/VOMZ(I,J,NZR+1,1)+\n*\t(l-DELTO)*FFZd,J, NZR+1,1)*BOMZ(I, j,nzr+i,d*\n*\tKRO(IP,JP,KP+NBP,2)/V0MZ(I,J,NZR+1,1)\n*\n*\n*\n$\n*\n*\n*\nTWZ(I,J,NZR+1,1)=DELTW*FFZ(1,1,NZR+1,1)*BWMZ(I, J, NZR+1,1)* KRW(I,J,NZR,1)/VWMZ(I,J,NZR+1,1) + (1-DELTW)*FFZ(I,J,NZR+1,1)*BWMZ(I,J,NZR+1,1)* KRW(IP,JP,KP+NBP,2)/VWMZ(l,J,NZR+1,1)\nT0Z2SI(I,J,NZR,1)=DELT0*FFZ(I,J,NZR+1,1)*\nBOMZ\u00cdI,J,NZR+1,1)*DKRO(I,J,NZR,1)/VOHZ(I,J,NZR+1,1) TOZ2SP(I,J ,NZR,1)~(1\u201dDELTO)*FFZ(I,J,NZR+1,1)*\nBOMZ(I,J,NZR+1,1)*DKRO(IP,JP,KP+NBP,2)/V\u00dcMZ(I,J,NZR+1,1) TWZ2SI(I,J,NZR,1)=DELTW*FFZ(I,J,NZR+1, 1) *\nBWMZd,J, NZR+1,1)*DKRW(I,J, NZR ,1)/VWMZ(I,J, NZR+1,1)\nTWZ2SP(I,J,NZR,1)=(1-DELTW)*FFZ(I,J,NZR+1,1)*\nBWMZ(I,J,NZR+1,1)*DKR#(IP,JP,KP+NBP,2)/VWMZ(I, J,NZR+1,1) ENDIF\no o n o na aa\n35 CONTINUE\nINTERF.Y\u00edTransmissib. ao oleo e a agua e suas derivadas dT/dSw na\nVerificacao do sentido de fluxo para \"head\" positivo :delto e deltw para \"head\" negativo :deito e deltw\n=1 (fluxo no sentido anti hor\u00e1rio) ou (fluxo para cima)\n=0 (fluxo no sentido hor\u00e1rio)\nou (fluxo para baixo)\nJl=l\nJ2=2\nIF(L.EQ.l) THEN\nJ1=NY\nJ2=l\nENDIF T\nDD 80 1=1,NX\nDD 80 K=1,NZ IF(L.EQ.2.AND.K.GE*KP.AND,K.LT.KP+NBP) THEN\nIF(I.EQ.IP.AND.JP.EQ.l.OR.\n*\tI.EQ.IP,AND.JP,EQ,2) GO TO 80\nENDIF\nHEAD=PO(I,J1,K,L)-PO(I,J2,K,L)+D0MY(I,J2,K,L)*\n*\t(ZB(I,J1,L)-ZB(I,J2,L)) DELTO=1\n*\n+ o o X *<\nK >\npi\n\n#\no\n-4\n\u00ae Xi\n\u00ae c4 \u00ae I\na>\n\n\u00ab\ntn \u00a33\nXI\n> a o\n*\n*\n*\n*\npt\n\u00a3X O\n\ntn \u00a33\nX\n1\nG) O\no\n-O O\ncs\n*\n* * *\n*\n*\nn on\nX P*\nt-i\nX\nPl\nco o\n*\n*\n\n*\n*\nG P n g\nS~4\t\tH\tH\tH\n\t\to\to\tX\n\t\u2022<\t*<\t*<\tH\npt\tp*.\tt-t\t\ty\u2014i\ncn\tcn\tw\ttn\tH\n\t>\tt\u20141\t>\t*\n\t^\u25a0'N\tX-\u201dX\t\tCh4\n\u00cd\u20141\t\tHH\tM\tk\u00bb\na*\t%>\tw\t*\tPS\nCblB^\n>5\nX\nt-\nW\nX M \u00cd\u2014tX o hskx \u201c\u00cd/\u201447JO .\nr li H o o M \u2022&lt;-(Xi tn tn -mt r4 c O\u00d5J-1- X! Xi\n<D X\ni\u2014II-IO xxio KCK H If H\nOH'-J \u00ae\n\u25a1 nr tr Z-'-.l\u2014I osrao.o. oo- n si 3\n\tkm p> O HPSOH X-\t\t<fc\tMf fw\u00c3a COOM\tH\tH\tH\tH M mW\ntn\tH O O II \u2022\tw\to\tMH HP\tX\t\u00ab\to\to x nm\nX\tXj\tHM\t\t{fl\tX OW\t\tH\t\u201cC\t\nMW\tZ~X O M-\to\t\t\tKJ\tto\tto\tto HXH\nnHHH\tr* o ii sa;\t\to\tHH11\tCfl\ttn\ttxt\ttn - tn\u00ab\ny~xXIXt xt\tH-\t\t\u00a3\tU\tW\tT?\tw\tXJ\tm tn > ti o\nM\tX M-\tC\tUj,\t\t5*5 W\tZ\"-X.\t\tz~x\tz-\\O \u00dcH \u00a3t\nvfr ImJ. h* I\n\nps m\ntT >\nH I! O O tn tn c r-H H \u00ab: o\nPS\np;\nt-\n\nPi HO\nM tri *\nr* Eno\nr- .__________\n\u00dc\nit p: it o\n\nto\n\nps\nc\n\nt-\no \u00a171 r-H K II\nO\nt-'\n*\nto X\n\u00ae - \u00dcKH- CJ3KH\nPS M Pl \u00ab X M MO f-h- H- *'\u2022 H- * HrHPnrHPX a . -\t\u201c\u25a0 \u25a0\u201c\t\u201c\nX 0\n\nw * co w\u2019-'s;\n\n'~'O o\na o\no\nH\nH o\nc H\n-4 O\np; XI 4-X\n03 X\nto\nr-1\n\u00d3E * C *<\nac M 3t -H&lt;-t\nw o 3! \u00ab5\nm\n\nps\nPS\nps\nt~*\nt\u00ab4\ntx\nH\n<-<\nH\nX\n+\tO 4- H\t\ttn\tH to H\t\t\tto\n\t\t<*^x\tX\t\t\u00bb\u2022\t\t*\u2022\nM\t\u2022<\thH\t\t\tX\tM\tX\nw\t\tV\t\t\u25a0*\tW\tW-\tw\n<-H\tM\t<\u20141\t\tKJ\tH\tK>\t\n\tV\t\t\t*-\t\tM-\t\n\t\t\t\t\t*\t\t\nw\t\t\u25a0w\t\t\t\t\u00bb*\t\nH\tX\tr1\t\t\t\tr*\t\nX-Z\t*\u2022\t\t\t\t\t\t\n*\tr>\t*\t\t*\t\t*\t\nIPO=1\nIF (HEAD, LT. 0. ODO) DELTOO IF(HEAD.EQ.O.ODO) IP0=0\nHEAD^POCI, J,K,L)-PO(I, JMA,K ,L)-PC(I, J ,K,L)+PCd, JMA,KfL) +\n*\tDWMY(I,JMA,K,L)*(ZBd,J,L)-ZBd,JMA,L))\nDELTW=1\nIPW=1\nIF(HEAD.LT.0,ODO) DELTW=O IF(HEAD.EQ.O.ODO) IPW=O\nTDY2SKI, J ,K ,L)=IP0*DELT0*FFYd, JMA,K,L)*BOMY(I, JMA , K,L)*\n*\tDKROCI,J,K,L)/VOMY(I,JMA,K,L)\nTDY2SP(I,J,K,L)=IPD*(l-DELTO)*FFYd,JMA,K,L)*BOMY(I,JMA,K,L)*\n*\tDKRO(I,JMA,K,L)/VOMY(I,JMA,K,L) TWY2SI(I,J,K,L)=IPW*DELTW*FFY(I,JMA,K,L)*BWMY(I,JMA,K,L)*\n*\tDKRW(I,J,K,L)/VWMY(I,JMA,K,L)\nTWY2SP(I,JfKIL)=IPW*(l~DELTW)*FFY(I,JMA,K,L)*BWMY(I,JMA,K,L)*\n*\tDKRW(I,JMA,K,L)/VWMY(I,JMA,K,L)\n70 CONTINUE\non n\tno\too on\nINTERF.Y:Transmissib. ao oleo e a agua e suas derivadas dT/dSw na ultima camada de celulas (no limite do reserv. To e Tw = 0)\nIF(L.EQ,2) THEN\nDO 75 I-1,NX\nDO 75 K=1,NZ IF(K.GE.KP.AND.K.LT.KP+NBP) THEN\nIF(I.EQ.IP.AND.JP.EQ.NY.OR.I.EQ.IP.AND.JP.EQ.NY-1) GO TO 75 END IF\nHEAD=PO(I,NY*l,K,L)-POd,NY,K,L)+DOMY(I,NY,K,L)*\n*\t(ZBd,NY-l,L)-ZBd,NY,L))\nDELTO=1\nIF(HEAD.LT.0.ODO) DELTO=O\nHEAD=POd,NY-l,K,L)-PO(I,NY,K,L)-PCd,NY-l,K,L)+PC(I,NY,K,L) +\n*\tDWMYd,NY,K,L)*(ZBd,NY-l,L)-ZB(l,NY,L))\nDELTW=1\nIF(HEAD.LT.0.ODO) DELTW=O\nTOYd,NY,K,L)=DELTO*FFYd,NY,K,L)*BOMY(I,NY,K,L)*\n*\tKROd,NY-l,K,L)/VOMY(I,NY,K,L)+\n*\t(1-DELTO)*FFY(I,NY,K,L)*BOMY(I,NY,K,L)*\n*\tKRO(I,NY,K,L)/VOMY(ItNY,K,L) TWY(I,NY,K,L)=DELTW*FFY(I,NY,K,L)*BWMYd,NY,K,L)*\n*\tKRW(I,NY-1,K,L)/VWMY(I,NY,K,L)+\n*\t(l-DELTW)*FFY(I,NY,K,L)*BWMYd,NY,K,L)*\n*\tKRW(I,NY,K,L)/VWMY(I,NY,K,L)\nTOYlSAd,NY,K,L>DELTO*FFYd,NY,K,L)*BOMY(I,NY,K,L)*\n*\tDKRO(I,NY-1,K,L)/V0MY(I,NY,K,L)\nTOYlSId INY,K,L)=S(1-DELTO)*FFY(I,NY,K,L)*BOMY(I,NY,K,L)*\n*\tDKRO(I,NY,K,L)/VOMYd,NY,K,L)\nTWYlSAd,NY,K,L)=DELTW*FFY(I,NY,K,L)*BWMY(I,NY,K,L)*\n*\tDKRW(I,NY-1,K,L)/VWMY(I,NY,K,L) TWY1SI(I,NY,K,L)=(1-DELTW)*FFY(I,NY,K,L)*BWMY(I,NY,K,L)*\n*\tDKRW(I,NY,K,L)/VWMYd,NY,K,L)\n75 CONTINUE\nEND IF\n1000 CONTINUE\nRETURN\nn a a o QQonri o\to\to\to cioonao\nI\tt\ti\ti\nEND\nSUBROT, DE REINICIALIZ. DE VAR. PARA REPETI\u00c7\u00c3O DE PASSO DE TEMPO QUE ULTRAPASSOU D N# MAX DE ITER OU QUE NAO TENHA VERIE. DSLIM OU DPLIM\nSUBROUTINE REPTS(NTS,PWFA,PWF)\nIMPLICIT DOUBLE PRECISION(A-H.O-Z)\nPARAMETER(NXM=08,NYM=05,NZM=04)\nCOMMON/NCEL/DBDX,DBDY,DBDZ ,WRC,NBLOC,NXC,NYC,NZC,NBP,\n*\tNXR,NYR,NZR,NQL,NQS,NQI,IP,JP,KP\nCOMMON/TSA/POA,SOA,SGA ,SWA\nCOMMON/TS/PO,SO,SG,SW\nDIMENSION P0A(NXM,NYM,NZM,2),S0A(NXM,NYM,NZM,2),\n*\tSGA(\u00bbXM>NYM,NZM,2)>SWA(\u00bbXM,NYM>NZM,2)\nDIMENSION PO(0:NXM+1,0:NYM+1\u00cd0:NZM+1,2)\u00cdSO(NXM\u00cdNYM,NZM,2),\n*\tSG(NXM1NYM,NZM,2)iSW(NXMfNYMfNZM>2)\nDO\n*\n4\tL=l,2\nNX=NXR\nNY=NYR\nNZ=NZR\nIF\u00cdL.EQ.2) THEN\nNX=NXC\nNY=NYC\nNZ=NZC\nENDIF\nDO 5 1=1,NX\nDO 5 J=1,NY\nDO 5 K=1,NZ\nIF(L.EQ.2.AND.I.EQ.IP.AND.J.EQ.JP.AND.K.GE.KP.AND. K.LT.KP+NBP) GO TO 5\nPO(ItJ,K,L)=POA(I,J,K,L) SO(I,J,K,L)=SOA(I,J,K,L) SW(I,J,K,L)=SWA(I,J,K,L)\nSG(I,J,K,L)=SGA(I,J,K,L)\nCONTINUE\nCONTINUE\nNTS=NTS~1\nPWF=PWFA\nRETURN END\nSUBBOTINA DE CALCULO DAS FUNCOES DE RESIDU0S DO OLEO E DO SUAS DERIVADAS PARA A MONTAGEM DA MATRIZ JACOBIANA Obs.IDR eh para anular ou nao os termos de fluxo, vazao e das no poco do GRID RADIAL.\nIDC eh para anular ou nao a vazao e suas derivadas no poco do GRID CARTESIANO.\nGAS E DE suas deriva-\nbloco do\nSUBROUTINE MQNJAC\nIMPLICIT DOUBLE PRECISION(A-H,O~Z)\nPARAMETER(NXM=08,NYM=05,NZM=O4)\nCOMMON/NCEL/DBDX,DBDY,DBDZ,WRC,NBLOC,NXC,NYC,NZC,NBP,\n*\tNXR,NYR,NZR ,NQL,NQS,NQI,IP,JP,KP\nCOMMON/SIM/DT,DTMAX,DTMIN,T0LP,TOLS,DSLIM,DPLIM,TSIM,\n*\tQOMAX,QOMIN,PWMIN,BSOR,JPROD,MSOLU,ITMAX,ITMIN COMMON/RES/DGAS,CR,PRIN,TEMP,ZC,RW,RE,SWIN,PHI,PERX,PERY,\n****** * ******\n*\tPERZ,ZCOW,INDPOR,INDPER\nCOMMON/MALHA/ZB,RB,VPOR,DRO,WX,WY,WZ,FFX,FFY,FFZ,DTETA COMMON/TSA/POA,SOA,SGA,SWA\nCOMMON/PVTA/BOA,RSOA,BWA\nCOMMON/TS/PO,SO,SG,SW\nCOMMON/PVT/BO,DBO ,VO,DVO,DO,DDO,RSO,DRSO,BW,DBW,VW,DVW ,DW,DDW , CW COMMON/IFACEX/BOMX,VOMX,DOMX ,BWMX,VWMX,DWMX COMMON/IFACEY/BOMY,VOMY,DOMY , BWMY,VWMY,DWMY\nCOMMQN/IFACEZ/BOMZ,VOMZ,DOMZ,BWMZ ,VWMZ,DWMZ COMMON/PETR/KRO,KRW,DKRO,DKRW ,PC,DPC COMMON/DTRANS/TOX,TWX,TOY,TWY,TOZ,TWZ,\nTOX1SA,TOX1SI,TWX1SA,TWX1SI, TOX2SI,TOX2SP,TWX2SI,TWX2SP, TOY1SA,TOY\u00cdSI,TWY1SA,TWY1SI, T0Y2SI,T0Y2SP,TWY2SI,TWY2SP, TOZ1SA,TDZ1SI,TWZ1SA,TWZ1SI, TOZ2SI,TOZ2SP,TWZ2SI,TWZ2SP\nCOMMON/VAZAO/QO,QOT,QG,QGT,QW,QWT,DQOP,DQOS,\nDQWP,DQWS,RWO,RGO,PWF,TEMPO\nCOMMON/ANULA/IX1,1X2,IY1,IY21IZ1,IZ2,IDR,IDC,LBC,JMA,JME,IX,IX, LBR COMMON/NBLC/A,D,NBC,NBR,NBT\nCDMMON/ACU/ACO,ACW,DACOP,DACOS,DACWP,DACWS\nCOMMON/POT/POTOX1,P0T0X2,PQTOY1,P0T0Y2,POTOZ1,POTOZ2 , POTWX1,P0TWX2,POTWY1,POTWY2,POTWZ1,POTWZ2, PDX1PA,POX1PI,POY1PA,POY1PI,POZ1PA,POZ1PI, P0X2PI,P0X2PP,POY2PI,POY2PP,POZ2PI,P0Z2PP, PWX1PA,PWX1PI,PWY1PA,PWY1PI,PWZ1PA,PWZ1PI, PWX2PI,PWX2PP,PWY2PI,PWY2PP,PWZ2PI,PWZ2PP, TOX1PA,TOX1PI,TOY1PA,TOY1PI,TOZ1PA,TOZ1PI,\n*\tT0X2PI,TOX2PP,TOY2PI,TOY2PP,TOZ2PI,TOZ2PP,\n*\tTWX1PA,TWX1PI,TWY1PA,TWY1PI,TWZ1PA,TWZ1PI,\n*\tTWX2PI,TWX2PP,TWY2PI,TWY2PP,TWZ2PI,TWZ2PP COMMON/SDEDW/STPO,STPW,SDEOPI,SDEOSI,SDEWPI,SDEWSI,\n*\tDFOPX , DFOSX,DFWPX,DFWSX , DFOPZ,DFOSZ,DFWPZ,DFWSZ DIMENSION PHI(NXM,NYM,NZM,2),PERX(NXM,NYM,NZM,2),\n*\tPERY(NXM,NYM,NZM,2) ,PERZ(NXM,NYM,NZM,2)\nDIMENSION ZB(O:NXM+1,NYM,2),RB(NXM+1),VPOR(NXM,NYM,NZM,2),\n*\tFFX(NXM+1,NYM,NZM,2),FFY(NXM+1,NYM,NZM,2),\n*\tFFZ(NXM+1,NYM,NZM+1,2),DTETA(NYM+1)\nDIMENSION POA(NXM,NYM,NZM,2),SOA(NXM,NYM,NZM,2),\n*\tSGA(NXM,NYM,NZM,2),SWA(NXM,NYM,NZM,2)\nDIMENSION BOA(NXM,NYM,NZM,2),BWA(NXM,NYM,NZM,2)\nDIMENSION PQ(OiNXM+l,0:NYM+i,0:NZM+1,2),S0(NXM,NYM,NZM,2),\n*\tSG(NXM, NYM,NZM,2),SW(NXM,NYM,NZM,2)\nDIMENSION BQ(NXM,NYM,NZM,2),DBO(O:NXM+1,0:NYM+1,0:NZM+1,2),\n*\tVO(NXM,NYM,NZM,2),DVO(O:NXM+1,0:NYM+1,0:NZM+1,2) ,\n*\tD0(NXM,NYM,NZM,2),DDO(O:NXM+1,0:NYM+1,0:NZM+1,2),\n*\tBW(NXM,NYM,NZM,2),DBW(O:NXM+1,0:NYM+1,0;NZM+1,2),\n*\tVW(NXM,NYM,NZM,2),DVW(O:NXM+1,0:NYM+1,0:NZM+1,2) ,\n*\tDW(NXM,NYM,NZM,2),DDW(O:NXM+1,0:NYM+1,0:NZM+1,2),\n*\tCW(NXM,NYM,NZM,2)\nDIMENSION B0MX(0:NXM+l,\u00bbYM,NZM,2),V0MX(0:KXM+l,NYM,NZM,2),\n*\tDOMX(O:NXM+1,NYM,NZM,2),BWMX(O:NXM+1,NYM,NZM,2),\n*\tVWMX(0:NXM+1,NYM,NZM,2),DWMX(0:NXM+1,NYM,NZM,2)\nDIMENSION BOMY(NXM,NYM+1,NZM,2),VOMY(NXM,NYM+1,NZM,2),\n*\tDOMY(NXM,NYM+1,NZM,2),BWMY(NXM,NYM+1,NZM,2),\n*\tVWMY(NXM,NYM+1,NZM,2),DWMY(NXM,NYM+1,NZM,2) DIMENSION BOMZ(NXM,NYM,NZM+1,2),VOMZ(NXM,NYM,NZM+1,2),\n*\tDOMZ(NXM,NYM , NZM+1,2),BWMZ(NXM,NYM,NZM+1,2),\n*\tVWMZ(NXM,NYM,NZM+1,2),DWMZ(NXM,NYM,NZM+1,2) DIMENSION DKRO(NXM,NYM,NZM,2),DKRW(NXM,NYM,NZM,2),\n*\tPC(O:NXM+1,0:NYM+1,0:NZM+l,2),DPC(O:NXM+i,O:NYM+1,0:NZM+1,2) REAUS KR0(NXM,NYM,NZM,2) ,KRW(NXM,NYM,NZM,2)\nDIMENSION TOX(NXM+1,NYM,NZM,2),TWX(NXM+1,NYM,NZM,2),\n*\tTOXISA(NXM,NYM,NZM,2),TOX1SI(NXM,NYM,NZM,2),\n*\tTWX1SA(NXM,NYM,NZM,2),TWX1SI(NXM,NYM,NZM,2),\n*\tTDX2SI(NXM,NYM,NZM,2),TOX2SP(NXM,NYM,NZM,2),\n*\tTWX2SI(NXM,NYM,NZM,2),TWX2SP(NXM,NYM,NZM,2)\nDIMENSION TOY(NXM,NYM+1,NZM,2)>TWY(NXM,NYM+1,NZM,2),\n*\tTOY1SA(NXM,NYM,NZM,2),TOY1SI(NXM,NYM,NZM,2),\n*\tTWYISA(NXM,NYM,NZM,2),TWY1SI(NXM,NYM,NZM,2),\n*\tTOY2SI(NXM,NYM,NZM,2),TQY2SP(NXM,NYM,NZM,2),\n*\tTWY2SI(NXM,NYM,NZM,2),TWY2SP(NXM,NYM,NZM,2)\nDIMENSION TOZ(NXM,NYM,NZM+1,2),TWZ(NXM,NYM,NZM+1,2),\n*\tTOZISA(NXM,NYM,NZM,2),TOZ1SI(NXM,NYM,NZM,2),\n*\tTWZ1SA(NXM,NYM,NZM,2),TWZ1SI(NXM,NYM,NZM,2),\n*\tT0Z2SI(NXM,NYM,NZM,2),TOZ2SP(NXM,NYM,NZM,2),\n*\tTWZ2SI(NXM,NYM,NZM,2),TWZ2SP(NXM,NYM,NZM,2) DIMENSION A(NXM*NYM*NZM*4,NXM*NYM*NZM*4),D(NXM*NYM*NZM*4) DIMENSION QO(NYM,NZM) ,QG(NYM,NZM),QW(NYM,NZM),DQDP(NYM,NZM),\n*\tDQOS(NYM,NZM),DQWP(NYM,NZM),DQWS(NYM,NZM) DIMENSION STPO(O:6,NZM),STPW(O:6,NZM)\nC\tSTPO \u2014> Somatorio de Trans. X Pot. doOleo\nDIMENSION SDEOPI(0:6,NZM),SDEWPI(0:6,NZM),SDEOSI(0:6,NZM) ,\n*\tSDEWSI(0:6,NZM)\nSDEOP\u2014> Som. da Derivada da Eq. do Oleo em rel, a Pres.\nno\to\to\tnon nooc\u00a1\nInicializacao do jacobiano (matriz A) e do termo ind. com zeros\nNBC=NXC*NYC*NZC-NBP NBR=NXR*N\u00a5R*NZR NBT=NBC+NBR\npara evitar if's no calculo do potencial\nDO 1 K=KP,KP+NBP-1\nPO(IP,JP,K,2)=O.ODO\nSW(IP,JP,K,2)=0,ODO\n1 CONTINUE\n5\n10\nDO 5 I=1,NBT*2\nDO 5 J\u00ab1,NBT*2\nA(I,J)=O.ODO\nCONTINUE\nDO 10 I=1,NBT*2\nD(I)=O.ODO CONTINUE\nDO 6 K=1,NZR\nDO 6 1=0,6\nSTPO(I,K)=O.ODO\nSTPW(I,K)=O.ODO\nSDEOPI(I,K)=0.ODO\nSDEWPI(I,K)=0.ODO SDEOSI(I,K)=O.ODO SDEWSI(I,K)=0.ODO\n6\tCONTINUE\nC\nDO\n1000 L-1,2 NX=NXR\nny=nyr\nNZ=NZR\nNC=NBC\nIF(L.EQ.2) THEN\nNX=NXC\nNY=NYC NZ=NZC\nNC=0\nEND IF\nnoQoorsaooo on\nDO 15 1=1,NX\nDO 15 J=1,NY\nDO 15 K=1,NZ\nIF(L.EQ.2.AND.I.EQ.IP.AND.J.EQ.JP.AND.K.GE,KP.AND.\n*\tK.LT.KP+NBP) GO TO 15\nFator de controle para a condicao de contorno das c\u00e9lulas\nidr \u2014>\tindicador do poco no radial (=0 se i=l e =1\tse i=/l)\nide \u2014>\tindica se o bl cart eh viz do poco (=1 se\tsis, =0\tse\tnao)\nixl \u2014>\tanulara as eqs. em i~l/2 qdo for face com\to\tbloco\tdo\tpoco\nix2 \u2014>\tanulara as eqs. em i+1/2 qdo for face com\to\tbloco\tdo\tpoco\niyl, iy2, izl e iz2 \u2014> idem a ixl e ix2\nlbc \u2014> posicao do cartesiano vizinho ao poco\n>\tlbc=l cartesiano vizinho a direita ou esquerda do poco\n>\tlbc=2 cartesiano vizinho acima do poco\n>\tlbc=3 cartesiano vizinho abaixo do poco\nDFOSX=O DFWPX=0 DFWSX=Q DFDPZ=0\nJMA=J+1\nJME=J\u201c1 IDR=1 IDOO LBC=0 LBR=1 1X1=1 1X2=1\nIY1=1 IY2=1\nIZ1=1\nIZ2=1 IV=0 IX=0 IY=0 DFOPX=O.ODO ----- ~ \u00d4DO\nODD 0D0 ________0D0 DF0SZ=0.0D0 DFWPZ=O.0D0 DFWSZ=0.0D0\nIF(L.EQ.l) THEN\nIF(I.EQ.l) IDR=0\nIF(J.EQ.l) JME=NY\nIF(J.EQ.NY) JMA=1\nTHEN\nTHEN\nTHEN\nn o an n an n ao\nC\nC\nc\nc\nIF(I.EQ.IP.AND.J.EQ.JP+1)\nIDC=1\nIY1=O\nLBC=2 LBR=K-KP+1\nENDIF\nIF(I.EQ.IP-1.AND.J,EQ.JP)\nIDC=1 1X2=0 LBC=3 LBR=K-KP+1\nENDIF\nIF(I.EQ.IP.AND.J.EQ.JP-l)\nIDC=1\nIY2=0\nLBC=4 LBR=K-KP+1\nENDIF ENDIF IF(I.EQ.IP.AND.J,EQ.JP.AND,K.EQ.KP-1) THEN\nIDO1\n122=0\nLBC=5\nLBR=1\nENDIF\nIF(I.EQ.IP.AND.J.EQ.JP,AND.K.EQ.KP+NBP) THEN\nIDC=1\n121=0\nLBC=6 LBR=NZR\nENDIF\nW=0.5D0\n-ENDIF\nNumero da c\u00e9lula na ordenacao sequencial de c\u00e9lulas na malha\nNC=NC+1\nEndere\u00e7o dos elementos da diagonal principal da c\u00e9lula i,j no jacob.\nLC=2*NC-1\nCalculo das dif.de potencial nas fases oleo e agua\nix e iy dah as coordenadas do cartesiano vizinho\nEQ NXJ THEN\nlateral direita\nIF(J.LE.NQL) THEN\nIV=1 IX=IP+1 JX=JP ENDIF lado superior\nIF(J.GT.NQL.AND.J.LE.NQL+NQS) THEN\nIV=2\nIX=IP JX=JP+1\nENDIF lateral esquerda\nIF(J.GT.NQL+NQS.AND.J.LE.NQS+2*NQL) THEN IV=3 IX=IP-1 JX=JP\nENDIF lado inferior\nIF(J.GT.NQS+2*NQL) THEN\nIV=4\nIX=IP\nJX=JP-1\n\nc\nC Na\nENDIF\nA\u00dcXDD=DOMX(NX+1,J ,K,1)\nAUXDW=DWMX(NX+1,J,K,1)\nAUXBO-BDMX(NX+1, J, K, 1)\nAUXBW=BWMX(NX+1,J,K,1)\nAUXVO=VOMX(NX+1,J,K,1)\nAVXVW=VWMX(NX+1,J,K,1) P0T0X2=P0(IX,JX,KP+K-1,2)-PO(NX,J,K,1)+AUXD0*\n*\t(ZB(IX,JX,2)-ZB(NX,J,l))\nP0TWX2=P0(IX,JX,KP+K-1,2)-PO(NX,J,K,1)+AUXDW*\n*\t(ZB(IX,JX,2)-ZB(NX, J,l))-PCdX,JX,KP+K-l,2)+PC(NX, J,K,1)\nSTPO(IV,K)=STPO(IV,K)-TOX(NX+1,J,K,L)*PDT0X2\nSTPW(IV,K)\u00bbSTPW(IV,K)-TWX\u00cdNX+1,J,K,L)*POTWX2 ET.SE\nPDT0X2=P0(I+l,J,K,L)-P0(I,J,K,L)-DOMX(I+1,J,K,L)*\n*\t(ZB(I,J,L)-ZB(I+1,J.L))\nP0TWX2=P0(I+l,J,K,L)-P0(I,J,K,L)-DWMX(I+1,J,K,L)*\n*\t(ZBdjJ.D-ZBd+l, J,L))-PC(I+1,J,K,L)+PC(I,J,K,L) ENDIF\nPOTOX1\u00abIDR*(PO(I,J,K,L)-PO(I-1,J,K,L) -D0MX(I, J,K,L)+\n*\t(ZB(I-1,J,L)-ZB(I,J,L)))\nPOTWX1=IDR*(PO(I,J,K,L)-PD(I-1,J,K,L) -DWMXd, J,K,L)*\n*\t(ZB(I-1,J,L)-ZB(I,J,L))-PC(I,J,K,L)+PC(I-1,J,K,L)) P0T0Y2-PD(I, JMA,K,L)-PO(I, J,K,L)-DDMYd, JMA,K,L)*\n*\t(ZB(I,J(L)-ZB(I,JMA.L))\nP0TOY1-PD(I, J,K,L)-PO(I,JME,K,L)-DOMY(I,J,K,L)*\n*\t(zb(i, jme,l)-zb(i , j ,D)\nP0TWY2-P0(I,JMA,K,L)-PO(I,J,K,L)-DWMY(I,JMA,K,L)*\n*\t(ZBd,J,L)-ZBd,JMA,L))-PCd,JMA,K,L)+PC(I,J,K,L>\nPOTWY1=PO(I,J,K,L)-PO(I, JME,K,L) -DWMY(I, J ,K ,L) *\n*\t(ZB(I,JME,L)-ZB(I, J,L))-PC(I,J,K,L)+PC(I, JME,K,L)\ndirecao Z a diferen\u00e7a de ZB e zero\nIF(L.EQ.1.AND.K.EQ.1.AND.KP.NE.1) THEN IV\u00ab5 P0T0Zl\u00abP0(l,J,l,l)-P0(IP,JP,KP-l,2)-\n*\tD0MZd,Jdd)*(ZB(IPdP,2)-ZBd,Jd>) POTWZ1-PO(l,J,1,1)-PO(IP,JP,KP-1,2)-\n*\tpcdj.id\u00ed+pcdPdP.Kp-id)\"\n*\tDWMZ(I,J,1,1)*(ZB(IP,JP,2)-ZB(I,J,1))\nSTPO(IV >K)=STPO(IV,K)+TOZ(I, J,1,\u00ed)+POTDZ1\nSTPW(IV,K)=STPW(IV,K)+TWZ(I,J,1,1)+POTWZ1 ELSE\nPOTOZ1=PO(I,J,K,L)-PO(I,J,K-l,L) POTWZ1=PO(I,J,K,L)-PO(I,J,K-l,L)-\n*\tPC(I, J,K,L)+PC(I,J,K-1,L)\nENDIF\nIF(L\u25a0EQ.1.AND.K.EQ.NZR.AND,KP+NBP-1.LT.NZC) THEN\nIV=6\nP0T0Z2=P0(IP,JP,KP+NBP,2)-P0(I,J,NZR,1)-\n*\tDOMZ(I,J,NZR+1,1)*(ZB(I,J,1)-ZB(IP,JP,2)) P0TWZ2=P0(IP,JP,KP+NBP,2)-PO(I,J,NZR,1)-\n*\tPC(IP,JP,KP+NBP,2)+PC(I,J,NZR,1)-\n*\tDWMZ(I, J,NZR+l,l)*(ZBd, J,1)-ZB(IP, JP,2))\nSTPO(IV,K)=STPO(IV,K)-TOZ(I,J,NZR+1,1)*P0T0Z2\nSTPW(IV,K)=STPW(IV,K)-TWZ(I,J,NZR+1,1)+P0TWZ2\nELSE\no\n*\n\n*\n*\n*\n*\n*\n\n*\n*\n*\n*\n*\n*\n*\nn \u00a3\no p\nO P\nQQ I I i i i i I\no \u00a9 c* (&amp; s\no oo I\nI\n\u00ed\nI\n\u00ed\nJ \u00ed\no t\u00ed\n03\t*0 03 03 *0\t*0\nC\tsooo\to\n\u2022<\t\t\nh\tH tO tO H\t1\u2014\n03\t03 03 13 03\t\n1-1\t> 03 H H\t>\nII\t11 II II II\tti\nH\t1 H* 1\t\u00bb-*\tt\n*\tH > H \u2018\t\nO\t\u20220-0\t4\nC3\tO O O O z*> O\t\nOz~s\t\u00fc O O O NI O\t\nf tO\tO 1 O 1 03 O\t\nSC 03\ti ac i aC^%\t1\n\u201cir,\ty'\"s\t*-&lt;b-d r^s\t\n* H\tH # H * u\tHk\nO-\t\u25a0 O \u2022 Q&lt;_<\t\nO H\tOCO\u00dcXO\t\nC X\tO O O O 03 O\t\n\u25a0r> 03\tO \u00cd\u2014.O/~V\u2018\tO\nC3\n\u2666\nCm t\u2014I\tW Zo* b-I\n\t\t\t\t\t\tI\tO 1\t1\t\t\t1 H- 1\t\t\u00ed\to\n\t\t03\t\tP3\t\tH I\t1\t1\t\t\t1 t\u00ed 1\t\t1\t\n\t\t522\t\tr>\t\tOJ 1\t(X 1\t1 o\tC3\t\tI p I\t\t1\t\u00edX\n03\t03 03\tO3C3O3\t03 03\tO3C/3O3\t03 03\tO3<-v 1\tp 1\t1\tZ\u2014V\t\ti n i\t\t1\to\nsC\tac o\towie\t3C O\tcm\tC o\ta r* i\ttn i\ti r1\tr* o\te>\ti p i\t\t\t\u00cd\u00d5\nX\tX X\tXO3X\tX X\tX X\tX X\tX \u2022 i\ti\t1 o\ta<\"-'\tz\u2014\t1 o I\t\t1\t\n1-*\t4k*. lk-i\ti-1 lo\tto to\t\u00abO IO\tto to\tto x i\tpx i\ti +\t4-\tf\ti\ti\t\t1\tct\n03\t03 03\t03\t03\t03 03\t03\t03\t03 03\t03 jO I\tft 1\ti h\t\u25ba** Q\tQ\t1 fX 1\t\t> !> 1\t0\nH\tS\u00bb h\t>\t03\tH 03\ti\u20141\t03\t1-1 03\tl-t \u25a0\t1\t0 i\ti\t\ts_z\t1 p 1\tn\ta a i\tH\n11\tII II\tII\t13\tII II\tII 11\tII II\tII H 1\tp. :\ti li\tIt II\t11\t1 M I\to\tc X 1\t9\nW\nI I I I\nI i\nI ( i I\nI I\nI i\nI I\nI\nM\nES\nO\n1~* Z\u2014x 1\tl-J- z*\\ 1\ti-1 o l\t(-* 1\t\u25a0 1\t&lt;1\t1 1 >\tHUI-I 1 > W H H\t1\tI\t1\t1!\t11 H 1\t0 i *Td\t03\n- Nt i-*\t\u2022 N \u00bb-\t\u2022 N i\u2014*\t\u2022 ISl f-*\t3> 1\tp \u00ed\ti o n\tto\u00ab:xt3Qb4\u00ab;x\tt Hs I\t1 VI&lt;3 tt\u00ed &lt;11 1\t1\tO\nO t\u00bb \u25a0\tO t\u00bb \u2022\to tn -\tO 03 \u25a0\tS3 t\tpj J\t1\tto to Mrs S3 iO to IO\tt p I\ti *; os c 03 H i\t1\tH\nQz-xO\tC3^O\tO\u00ed-xO\tGz-xO\tC3 t\tp 1\ti Ir* i\t* * * r* i % * *\ti y ;\t1 r.D>O- 1\ta i\t\u00ab\nO i-t C3\tO 1-1 O\tO C3\tO !S\u00cd C3\t\tCft i\ti Oz~x\tr,rs/-',C|z'xrsrx/-s\ti a i\t1 H 3I3z\u201cxpt3 O 1\t0 J\tto\n1 - O\tI - O\t1 X o\t1 X O\tIH I\t1\t1 4* b**-\tH H \u2019-J1\u2014' H *~3 M H\t1 o\t1 - r-.Hrsd 1\t1\tto\nX\n01\nI I\nI I i\nI I\nI I i I\nI I\nI\n\u00cdX \u00ae\nP n t\u00ed S t\u00ed\nir\nO o\n03 O H O N to l\u00ed\n03 O\nPe\n\u25ba1\n\u00a1X p w\nQu H \u00ea> f H\t+ Z-X. 1\t4- rx 1\tzx CD 1 z\u2014s O 1\tI \u2019\t1\to X > H\t\u00ab X > H\t1 Ct?\nQ r~* \u25a0 o\u2019\u2014>.\tH w aC H H SC\tHz-x\u00ae Wz-xSI H\t1 1\tiK + U\tU\tz\u2014s 4- u u\t1 \u00bb\nX'\u2014'O o 1 o\tu\t4- XuZu\t4- XuZ\tX H po X H S3 S3\t1 pu 1\t<- H X X\tH H X X\tI\nz-x 1 OrxN C3\tH H * t\u20141 H *\t- X O\u00bb X O M\t1 0 1\tu\tu\tu\tU\tW\tM\tS\u00ab\t1*\ti Qa\nHNOHtOO\tu u Qu u Q\tO'-\t-'t_\u00bbu oze;\t1 1\tx Q o r-\tx f r* to\t1 \u00a3\nu 03 t u zx I\t?? H Q X H O\t>i t_, * X h *\t1 TJ t\t\u2014Z\u2014'\u2014'\t<\tx-z x-z '\u25a0> Xu/\t1 O\nt-\u00a1 zx sc&lt;_&lt;H a:\tu\t-\t:\u00a3u\tu\tO\t- X C3\u201c X O\ti O f\t+ * * *\t+ * * *\t1 Cfl\nu\t1-1 X_Zu u s\u2014z\tt-1 tOzzx.r\u2019 Qz-x\tXu O Xu Q\tt ct 1\tH 03 03 03\tH 03 03 03\tj\n:xu * x&lt;-&lt;*\tVhZs^1' f\u20141\t\"Ox-z\t03 to aCu to o\t* *\tQ O O C3\to o q o\t1 z\"o\nu\t<_Z Qu U\tQ\t*\t- O\u2019zxtJ\u2019-'/x\tt \u00a3 I\tO H H H\tO H H \u2022\u2014]\t1 c+\nje se\nNi \u00ab\u00ed IO tO\n\u00ab\nX to\nP O P O\nPu O\no\n\n\u00a3*M \u00a3M [-M\nN*\tW *u tO f\u00bb\t\nte r\u00bb\tXN\u201c ^^3\t\nhh\ttn ce\tb-i\tX\n**\tM\tZ~X*\t*\tw\nCm\t^hf4 ci\tX\n\t* \u25a0* 'w*-z \u00cd3\u00cd\tto\n\t\t|*M\nM\t\t'v-z\nr*\t* f ro r*\t*\n\t'-'W '\u2014'\t\n1\t1 z\u201cs i\t\nN\tNHN\t\nce\tW- W\t\n\tt\u2014) z\u2014\\\t\nhd\tH\u00bb l-l\t\n\t- r-\u2019\u2019-\t\nCm\tS i -\t\nr1\t> N f\t\nz\t-\t03'-'\t\n\t'\u2014't-t&lt;-\u00ed\t\nr*\n[\u201c* **\tO H O O\t\tz\"~x\tCm '\u201c\u25a0\"\u25a0x\tCm\t\t\t1\u20141\t1 O 1\t* o o o\t\nf*\tKsjxzO\t\tb4\t- Nt\tto\t\t* *\tto\t1 H- 1\tCO NJ *-&lt;X\t\n* V-z\tz-v * v\t\tte\t5*: te\trs:\t*\tCm z~o\tCm\t1 p 1\tH to to to\t\n\t' W /*>'*-\t\to\t* \u2713->\tto\t\tto\tM\tto\t1 H 1\tOf S^VuZ\t\n\t1 b4\tt\t1\u2014!\ttr* w\tr*\tN\tte\tP*\t1 1\tO 1\t1\t1\nta\tte\t1\u2014L\tM\t\t*to-z\tCO\t* z-s\tV\t1 ft 1\tz-,H H\tW\n\t* z-x\t\u00abe\tCm\t# Cm\t\tz**x\t\t\u00ed-^\t1 S 1\tQ CO \"&lt;X\t\n1\u20144\tCm M\tCm\t\t*\t\t\tVM* >q\t'u-Z\t1 1\tttf H H H\t\n\t** t\t\tr-\tr1\t\tX\t* *\t*\t1 H 1\ta * *\t*\n1\u2014\tX H\t\t\tV-z\t\tto\tCm\t\t1 ft 1\tto\t\n\t\tV\t1\t1\t\tCm\tto\t\t1 H 1\tf**\tH\nCm\tQ H\tr*\tN\tN\t\tto\tfuM,\t\t1 P 1\tDO O O\tO\n4*\tX^Zu\t'XhX\tte\tW\t\tM-\t\t\tt n t\tJO M \u00abi\tX\nr*\t* r>\t*\t\tZ\u201c*X\t\tx/\tI\t\ti p i\t\t\n\tS\u2014'\t\tM\tM\t\t1\t(S3\t\tI O 1\ti \u2014i i.\u2014i L i \u201c1\thd\n1\t1\t\t+\t+\t\tN1\tDO\t\tt\t1\tto\tto\tto\nN\tN\t\t\t\t\tm\tZ\u2014-X\t\tt p 1\tCm Cm\tCm\nco\tCD\t\t\u25a0*\t\u25a0\u00bb\t\t\tW\t\tt\t1\tto\tto\tto\n\t,\ts\t\tCm\tCm\t\tW\tX\t\tt 03 t\tXXX\t\nJ-d\tH\t\tw\ta\u00bb\t\tX\tto\t\tt H 1\tto\tto\tto\nw\t\t\t\tr*1\t\t*\tU\t\tI ft 1\trrr\t\nCm\tCm\t\ts_-*\t\u25a0XM-\t\tCm\tX\t\tt tn t\t\t\n\tw\t\t\t\t\tX\tto\t\t1 w t\t* #\t*\nr*\t\u00a3\u00ab4\t\t\t\t\t\tto\t\t1 p t\t03 03\t03\n\tVpX\t\t\t\t\tN?\t*x_Z\t\tt o t\tO O\tO\n\t\t\t\t\t\t\u25a0x-z\tx_z\t\tt\tt\tH H\tH\n\t\t\t\t\t\t\t\t\t1\tI\tO O\tO\nto \u00ab:\nx\nI i i t\nI\nft y o M\nr nr\nS>\no\n0\nX\n*\ny (X\nIX o\nt/i\nCm Cm Cm\nXXX\n\u00ab&lt;+\nIX m\n\u25bao \u00bb\nv_z\nt~&lt;(_,\n* x en* c r*\n1 + +\nP CM\nC P\nSJ\nP\nfxrnj Cm\nX X X\nto f f\n* O o o S-/ i\no -i\nCm\n\nr*\nn\np:\nP\nM-\n\u2014I to\nC\n*\n*\nPWY2PI=-1.0D0-(1.0D0-WY)*DDWd,J,K,L)*(ZB(I,J,L)-ZB(I, JMA,L) )\nPVY2PP\u00bb1.0D0-WY*D0W(I\u00edJMA,K,L)*(ZB(I,J\u00edL)-ZB(I,JMA,L))\nC\n*\n*\nIF(L.EQ.1.AND.K.EQ.1.AND.KP.NE.1) THEN\nPOZ1PA=~1.ODO-(1.ODO-WZ)*DDO(IP,JP,KP-1,2)*(ZB(IP,JP,2)-ZB(I,J,1))\nPWZlPA=-1.0D0\"(1.0D0-WZ)*DDW(IP,JP,KP-l,2)*(ZB(IP,JP,2)\u201c ZB(I,J,1))\nP0ZlPI=1.0D0+WZ*DDD(I,J,l,l)*(ZB(IP,JP,2)-ZB(IJJtl>)\nPWZ1PI=1.ODO+WZ*DDW(I,J,1,1)*(ZB(IP,JP,2)-ZB(I,J,1)) ELSE\nPDZ1PA--1.0D0\nPWZ1PA=-1,ODO\nPOZ1PW.ODO\nPWZ1PK.0D0\nEND IF\no Cid\to nna\nIF(L,EQ.1.AND.K.EQ.NZR.AND.KP+NBP-1.LT.NZC) THEN\nPDZ2PI=-i.ODO+(i.ODO-WZ)*DDO(ItJ,NZR,l)*(ZB(I,J,l)~\nZB(IP JP 2))\nPWZ2PI=-\u00cd.OD\u00d2+(\u00cd.ODO-WZ)*DDW(IJJJNZHJ1)*(ZB(IJJJ\u00cd>-ZB(IP JP 2))\nP0Z2PP-1.ODO+WZ*DDD(IP,JP,KP+NBP,2)*(ZBd, J ,1)-ZB(IP, JP,2))\nPWZ2PP=1.ODO+WZ*DDW(IP,JP,KP+NBP,2)*(ZB(I,J,1)-ZB(IP,JP,2)) ELSE\nP0Z2PI=-1.0D0\nPWZ2PI=-1.ODO\nP0Z2PP=1.0D0\nPWZ2PP-1.0DQ\nEND IF\nCalculo das derivadas dos ternos de acumulacao ACW e ACO em relacao a a Swijj e Poi,j (nas demais variaveis essas derivadas se anulam)\nDACWP=VPOR(I,J,K,L)*(CR*BW(I,JtK,L)*SW(I,J,K,L)+AUX1*\n*\tSW(IjJ3K,L)*DBW(I,JiKjL))/DT DACWS=VPQR(IiJ\u00edK1L)*AUX1*BW(I>J3K)L)/DT\nDACOP\u00abVPOR(I,J>K,L)*(CR*BO(I,J\u00edK,L)*(1.ODO-SW(I,J,K,L))+\n*\tAUX1*(1,000-SWd, J ,K,L))*DBO(I, J,K,L))/DT\nDACOS=-VPOR(IJJjK,L)*AUXl*BO(IjJfK,L)/DT\nCalculo das deriv. das transmissib. TOX e TWX em relacao a press\u00e3o\n*\n*\n*\n*\nC\nIF(L.EQ.l.AND.I.EQ.NX) THEN\nT0X2PI=(WRC-l.ODO)*TOX(I+1,JjL)*(DV0(I,JjK>L)/ AUXVO-DBO(I,J \u00bbK,L)/AUXBO)\nTQX2PP\u00ab-WRC*T0X(I+l,J,K,L)*(DVO(IX,JX,KP,2)/ AUXVO-DBO(IX,JX >KP,2)/AUXBO)\nTWX2PI=(WRC~1.0D0)*TWXd+l,J.K,L)*(DVW(I,J,K,L)/\nAUXVW-DBW(IjJjK,L)/AUXBW)\nTWX2PP=-WRC*TWX(1+1,J,K,L)*(DVW(IX,JX,KP,2)/ AUXVW-DBW(IX,JX,KP,2)/AUXBW)\nIF(J.LE.NQL) THEN\nIV-1\nENDIF\nIF(J.GT.NQL.AND.J.LE.NQL+NQS) THEN\na aci\nIV=4\nENDIF IF(IV,EQ,1.OR.IV.EQ.2) THEN\nSDE0PI(IV,K)^SDEDPI(IV,K)-(T0X(I+l,J,K)l)*P0X2PP+P0T0X2*T0X2PP)\nSDEOSI(IV,K)=SDEOSI(IV,K)-(P0T0X2*T0X2SP(I,JtK,1))\nSDEWPI<IVtK)=SDEWPI(IV,K)-<TWX(I+1,JJKil)*PWX2PP+P0TWX2*TWX2PP)\nSDEWSI(IV,K)=SDEWSI(IV,K)-(~TWX(I+1,J,K,1)*DPC(IX,JX.KP+K-l,2)+\n*\tP0TWX2*TWX2SP(I,J fK,1))\nENDIF\nIF(IV.EQ.3.0R.IV.EQ.4) THEN\nSDEOPI(IV,K)=SDEOPI(IV,K)-TOX(I+1,J,K,1)*P0X2PP-P0T0X2*T0X2PP SDEOSI(IV,K)~SDEOSI(IV,K)-POTOX2*TOX2SP(I,JfK,1)\nSDEWPI(IV,K)=SDEWPI(IV,K)-TWX(I+1,J,KJ1)*PWX2PP\u201cPOTWX2*TWX2PP\nSDEWSI (IV,K)=SDEWSI (IV,K)+TWX(I+1, J\tD^DPCQX, JX,KP+K-1,2)-\n*\tP0TWX2*TWX2SP(I,J,K11)\nENDIF\nDFWPX=~TWX(1+1,J,K,1)*PWX2PI~P0TWX2*TWX2PI DFWSX=\u201cTWXd+l, J,K, 1)*DPC(I, J jK, 1)-POTWX2*TWX2SI(I, J ,K, 1) DFOPX=-TOX(I+1,J,K,1)*POX2PI-POTOX2*TOX2PI DF0SX=-P0T0X2*T0X2SI(I,J,K,1)\nELSE\nT0X2PI=(W-l.ODO)*TOX(I+1,J,K,L)*(DVO(I,J,K,L)/\n*\tVOMX(I+1,J,K,L)-DBO(I,J,K,L)/BOMX(I+1,J,K,L)) TOX2PP=\"W*TOX(I+1,J,K,L)*(DVO(I+1,J,K,L)/\n*\tVOMXU+l, J ,K ,L)\"DBO(I+13 J ,K ,L)/BOMX(I+1, J, K,L) ) TWX2PI=(W-1.ODO)*TWX(I+1,J,KtL)*(DVW(I,J,K,L)/\n*\tVWMX(I+1jJ,K,L)-DBW(I,JjK,L)/BWMX(I+1,J,KjD)\nTWX2PP=-W*TWX(1+1,J,K,L)*(DVW(1+1,J,K,L)/\n*\tVWMXd+l, J,K,L)-DBW(I+1,J,K,L)/BWMX(I+1,J,K,L)) ENDIF\nTOX1PA\u00abIDR*((W-1.ODO)*TDX(I,J,K,L)*(DVO(I-1,J,K,L)/\n*\tVOMX(I,J,K,L)-DBQ(I-i,J,K,L)/BOMX(I,j,k,l))) TOX1PI=IDR*(-W*TOX(I,J,K,L)*(DVO(I,J,K,L)/VOMX(I,J,K,L)-\n*\tDBO(I,J,K,L)/BDMX(I,J,K,L))) TWX1PA\u00abIDR*((W-1.ODO)*TWX(I,J,K,L)*(DVW(I-1,J,K,L)/\n*\tVWMX(I,J,K,L)-DBW(I-1,J,K,L)/BWMX(I,J1K,L))) TWX1PI*IDR*(-W*TWX(I,J,K,L)*(DVW(I,J,K,L)/VWMX(I,J,K,L)\u201d\n*\tDBW(I,J,K,L)/BWMX(I,J,K,L)>)\nCalculo das deriv. das transmissib. TOY e TWY em relacao a pressao\nTDYlPA^Grf-i.ODO^TOYd^K\u2019U+GOVOa, JMEjKiLj7\n*\tV0MY(I,J,K,L)-DB0(I,JME,K,L)7B0MY(I,J,K,L)) TOY1PI=-WY*TOY(I,JjK}L)*(DVO(I,J,K,L)/V0MY(I,J,K,L)~\n*\tDB0(IfJ,K,L)/BOMY(IjJ,K,L))\nT0Y2PI=(WY-1.ODO)*TOY(I,JMA,K,L)*(DVO(I,J,K,L)/\n*\tVOMY(l)JMAiKJL)\"DBO(liJ1KJL)/BOMY(I,JMAiKiL)) T0Y2PP=-WY*T0Y(IUMAiK,L)*(DV0(I,JMA1K,L)/V0MY(IJJMA>KJL)-\n*\tDBO(I,JMA,K,L)/BOMY(I,JMA,K,L)) TWY1PA-(WY-1.0D0)*TWY(I,J,K,L)*(DVW(I,JME,K,L)/\n*\tVWMY(I,J,K,L)-DBW(I,JME,K,L)/BWMY(I,J,K,L))\nTWY1PI=:~WY*TWY(I, J ,Kjt)*(DVW(I, J ,K ,L)/VWMY(I, J ,K ,L)-\n*\tDBW(I,J,K,L)/BWMY(I,J,K,L)) TWY2PI=(WY\u201c1.0D0)*TWY(I,JMA>K,L)*(DVW(I,J,KJL)/\n*\tVWMY(I, JMAjKjD-DBWd, J JK,L)/BWMY(IJ JMAjK^L)) TWY2PP-~WY*TWY(I,JMA,K > L)*(DVW(I,JMA,K,L)/VWMY(I,IMA,X,L) -\n*\tDBW(I,JMA,K,L)/BWMY(I,JMA,K,L))\nC\no O\nC\nIF(L.EQ.1.AND.K.EQ.1.AND.KP.NE.1) THEN IV=5 TQZlPA=(WZ-1.0D0)*T0Z(I,J,l,l)*(DV0(IP,JP,KP-l,2)/\n*\tVOMZ(I,J,1,1)-DBO(IP,JP,KP-l,2)/B0MZ(I,J,l,l)) TOZ1PI-~WZ*TOZ(I,1,1,1)*(DV0(I,J,1,1)/VOMZ(I,1,1,1)-\n*\tDBO(I,J,1,1)/BOMZ(I,1,1,1)) TWZ1PA-(WZ-1.ODO)*TWZ(I,J,1,1)*(DVW(IP,1P,KP-1,2)/\n*\tVWMZ(I,J,l,l)-DBW(IP,JP,KP-l,2)/BWMZ(l,1,1,1)) TWZIPI^-WZ+TWZ\u00cdI,1,1,1)*(DVW(I,1,1,1)/VWMZ(I,1,1,i)~\n*\tDBW(I,1,1,1)/BWMZ(I,1,1,1)) SDEQPI(IV,K)\u00bbSDEOPI(IV,K)+(TOZ(I,1,1,1)*POZ1PA+POTOZ1*TOZ1PA) SDEOSI(IV,K)=SDE0SI(IV,K)+(POTOZ1*TOZ1SA(I,1,1,1)) SDEWPI(IV,K)=SDEWPI(IV,K)+(TWZ(1,1,1,1)*PWZ1PA+POTWZ1*TWZ1PA) SDEWSI(IV,K)~SDEWSI(IV,K)+(TWZ(I,1,1,1)*DPC(IP,JP,KP-1,2)+\n*\tPOTWZ1*TWZ1SA(I,1,1,1))\nDFWPZ=TWZ(I,1,1,1)*PWZ1PI+POTWZ1*TWZ1PI\nDF0PZ=T0Z(I,1,1,1)*POZ1PI+PDTOZ1*TOZ1PI DFOSZ=POTOZ1*TOZ1SI(I,1,1,1) DFWSZ=\u201cTWZ(I,1,1,1)*DPC(I,1,1,1)+POTWZ1*TWZ1SI(I,I,1,1) ELSE\nT0ZlPA\u00ab(WZ-1.0D0)*T0Z(I,l,K,L)*(DV0(I,l,K-l,L)/\n*\tVOMZ(I,1,K,L)-DBO(I,1,K-1,L)/BOMZ(I,1,K,L)) TOZ1PI\u00ae-WZ*TOZ(I,1,K,L)*(DV0(I,1,K,L)/VOMZ(I,J,K,L)-\n*\tDBO(I,J,K,L)/BDMZ(I,1,K,L))\nTWZ1PA=(WZ-1.0D0)+TWZ(I,1,K,L)*(DVW(I,1,K-1,L)/\n*\tVWMZ(I,1,K,L)-DBW(I,1,K-1,L)/BWMZ(I,1,K,L)) TWZ1PI=-WZ*TWZ(I,J,K,L)*(DVW(I,J,K,L)/VWMZ(I,J,K,L)-\n*\tDBW(I,J,K,L)/BWMZ(I,J,K,L)) ENDIF\nIF(L,EQ.1\u25a0AND.K.EQ.NZR.AND.KP+NBP-1. LT.NZC) THEN IV\u00ae6\nT0Z2PI=(WZ-1.0D0)*T0Z(I,1 ,NZR+1, 1) *(DVO(I,I,NZR,1)/\n*\tVOMZ(I,l,NZR+l,l)-DBO(I,I,NZR,l)/BOMZ(l,l,NZR+l,l))\nT0Z2PP=-WZ*T0Z(I,I,NZR+1,1)*(DVD(IP,1P,KP+NBP,2)/\n*\tVOMZ (I, J ,NZR+1,1) -DBO (IP, JP, KP+NBP,2)/BDMZ(I,1 ,NZR+1,1)) TWZ2PI\u201c(WZ-1.0D0)*THZ(I,l,NZR+l,l)*(DVW(I,l,NZR,l)/\n*\tVWMZ(I,I,NZR+1,1)-DBW(I,1,NZR,1)/BWMZ(I,J,NZR+1,1)) TWZ2PP=-WZ*TWZ(I,J,NZR+1,1)*(DVW(IP,IP,KP+NBP, 2)/\n*\tVHMZ(1,1,NZR+1,1)-DBW(IP,1P,KP+NBP,2)/BWMZ(I,I,NZR+1,1) ) SDEOPI(IV,K)\u201cSDEOPI(IV,K)\u201c(TOZ(I,1,NZR+1,l)*PDZ2PP+P0T0Z2*T0Z2PP) SDE0SI(IV,K)=SDE0SI(IV,K)-(P0T0Z2*T0Z2SP(I,l,NZR,l)) SDEWPI(IV,K)\u00abSDEWPI(IV,K)-CrWZ(I,l,NZR+l,l)*PWZ2PP+P0TWZ2*TWZ2PP) SDEWSI(IV,K)=SDEWSI(IV,K)-(-TWZ(I,l,NZR+l,l)*DPC(IP,lP,KP+NBP,2)+\n*\tP0TWZ2+TWZ2SP(I,1,NZR,1))\nDFWPZ-TWZ(I,1,NZR+1,1)*PWZ2PI+POTWZ2*TWZ2PI\nDFQPZ=TOZ(I,1,NZR+1,l)*P0Z2PI+P0T0Z2*T0Z2PI DF0SZ=P0T0Z2*T0Z2SI(1,1,NZR, 1)\nDFWSZ=TWZ(1,1,NZR,1)*DPC(I,1,NZR, l)+P0TWZ2*TWZ2SI(I,l,NZR,1)\nDFWPZ=-DFWPZ\nDFOPZ--DFOPZ\nDFOSZ=-DFWSZ\nDFWSZ=-DFWSZ\nELSE\nTOZ2PI\u00ae(WZ~1.0DO)*TOZ(I,J,K+1,L)*(DVO(I,J,K,L)/\n*\nVOMZ(\u00cd,J,K+1,L)-DB\u00d3(I,\u00ed,K,L)/BOMZ(\u00cd,\u00ed,K+1,L))\nnao\tono\to an\tnao aon\ta nano no o anona\n*\tDBO(I,J,K+1,L)/BOMZ(I,J,K+1,L))\nTWZ2PI<WZ-1.0D0) *TWZd , J>K+l,L) *(DVWd , J ,K,L) /\n*\tVWMZd, J, K+l,L)-DBW(I,J,K,L)/BWMZ(I,J,K+i,L)) TWZ2PP--WZ*TWZ(I, J,K+1,L)*(DVW(I, J,K+1 ,L)/VWMZd, J,K+1 ,L)-\n*\tDBWfl,J,K+1,L)/BWMZ(X,J,K+1,L))\nENDIF\nDetermina\u00e7\u00e3o das derivadas das funcoes de residuos em relacao as variaveis da malha : determina\u00e7\u00e3o dos elementos da matriz jacobiana dFw/Poi,j,k\nCALL JAC (I,J,K,L)\n15 CONTINUE\n1000 CONTINUE RETURN\nEND\nMONTAGEM DA MATRIZ JACOBIANA PARA GRID COMPOSTO MATRIZ COM BLOCOS 2X2\nSUBROUTINE JAC (I,J,K,L)\nIMPLICIT DOUBLE PRECISION(A-H,O-Z)\nPARAMETER(NXM=08,NYM=O5,NZM=04)\nCOMMON/NCEL/DBDX,DBDY,DBDZ , WRC,NBLOC,NXC,NYC,NZC,NBP ,\n*\tNXR,NYR,NZR,NQL,NQS,NQI,IP,JP,KP\nCOMMDN/NBLC/A,D,NBC,NBR,NBT\nC0MM0N/ANULA/IX1,1X2,IY1,IY2,IZ1,IZ2,IDR,IDC,LBC,JMA,JME,IX, JX, LBR\nDIMENSION A(NXM*NYM*NZM*4,NXM*NYM*NZM*4),D(NXM*NYM*NZM*4)\nPARTE REFERENTE AO GRID CARTESIANO\nKP1=KP\nKPN=KP+NBP-1\nIF(L.EQ.2) THEN\n\u2014I-----\t(1,1,1) ate (ip-2,j,k)\nIF(I.LE.(IP-2)) THEN\nNCC\u00ab(I-1)+NYC+NZC+(J-1)*NZC+K\nCALL MONTA (I,J,K,L,NCC)\nENDIF\n\u20142----- de (ip-l,l,k) ate (ip-1,jp-1,k)\nIF(I>EQ.(IP-1) .AND.J.LE.(JP-1)) THEN NCC=(I-1)*NYC*NZC+(J-1)*NZC+K CALL MONTA (I,J,K,L,NCC)\nENDIF\n\u20143----- de (ip-l,jp,l) ate (ip-1,jp,kpl-l)\nIF(I.EQ.(IP-i) .AND. J.EQ. JP.AND.K,LT.KPI) THEN NCC=(I-1)+NYC+NZC+(J-1)*NZC+K CALL MONTA d,J,K,L,NCC)\nENDIF\n-4-----de (ip-1,jp.kpl) ate (ip-1,jp,kpn)\nC\nC\nc\nIF(I.EQ,(IP-1).AND.J.EQ.JP.AND.K.GE.KP1.AND.K.LE.KPN) THEN NCC- (I -1) *NYC*NZC+ (J-1) *NZC+K CALL MONTA (I,J,K,L,NCC)\nNL=2*NCC-1 zerar os elementos i+1\nIF(I.NE.NXC) THEN dfo/dpoi+lj ,sgi+l,j, swi+l,j NH~NL+NYC+NZC*2 A(NL,NH)=0.ODO A(NL,NH+1)=O.ODO dfw/dpoi+l,j ,sgi+ljj, swi+l,j\nA(NL+1,NH)=O.ODO A(NL+1,NH+1)=O.ODO END IF\nEND IF\nono\tn\tno\tano\n\u20145----- de (ip-1,jp,kpn+l) ate (ip-1,jp,nzc)\nIF(I.EQ.(IP-1).AND.J.EQ.JP.AND.K.GT.KPN) THEN NCC=(I-1)*NYC*NZC+(J-1)+NZC+K CALL MONTA (I,J,K,L,NCC)\nNL=2*NCC-1\nreduzir de 1 posicao os eleitientos i+1\nIF(I.NE.NXC) THEN dfo/dpoi+l,j ,sgi+l,j, swi+l,j\nNH=NL+NYC*NZC*2\nNP=NBP*2\nA(NL,NH-NP)=A(NL,NH)\nA(NL,NH-NP+1)-A(NL,NH+1)\nA(NL,NH)=0.ODO\nA(NL,NH+1)=O.ODO\ndfw/dpoi+1,j ,sgi+l,j, swi+l,j\nA(NL+1,NH-NP)=A(NL+1,NH)\nA(NL+1,NH-NP+1)=A(NL+1,NH+1)\nA(NL+1,NH)=O.ODO\nA(NL+1,NH+1)=O.ODO\nENDIF\nENDIF\n\u2014\u00a7-----\u00bfe (ip-ijp+i,1) ate (ip-l,nyc,nzc)\nC\nC\nC\nIF(I.EQ.(IP-1).AND.J.GE.JP+1) THEN NCC=(I-1)+NYC+NZC+(J-1)+NZC+K CALL MONTA (I,J,K,L,NCC) NL=2*NCC-1 reduzir de 1 posicao os elementos i+1 IF(I.NE.NXC) THEN dfo/dpoi+l,j ,sgi+l,j, swi+l,j NH=NL+NYC*NZC*2 NP=NBP*2 A(NL,NH-NP)=A(NL,NH) A(NL,NH-NP+1)=A(NL,NH+1) A(NL,NH)=0.ODO A(NL,NH+1)=O.ODO dfw/dpoi+lj ,sgi+l,j, swi+l,j\nA(NL+1,NH-NP)-A(NL+1,NH) A(NL+1,NH-NP+1)=A(NL+1,NH+1) A(NL+1,NH)=O.ODO\nA(NL+1,NH+1)=O.ODO\nENDIF\nENDIF\nno\to nn\tn\tno\tnon\tn\tno\tnon\n\u20147-----a-te (ip;jp-2,nzc)\nIF(I.EQ.IP.AND.J.LE.(JP-2)) THEM\nNCC=(I-1)*NYC*NZC+(J-1)*NZC+K CALL MQNTA (I,J,K,L,NCC) NL=2*NCC\u201d1 reduzir de 1 posicao os elementos i+1\nIF(I.NE.NXC) THEN dfo/dpoi+l,j ,sgi+l,j, swi+lj\nNH=NL+NYC*NZC*2 NP=NBP*2 A(NL,NH-NP)=A(NLfNH)\nA(NL,NH-NP+1)\u201cA(NL,NH+1) A(NL,NH)=0.ODO A(NL,NH+1)-O.ODO dfw/dpoi+l,j ,sgi+i,j, swi+l,j\nA(NL+i,NH-NP)=A(NL+l,NH)\nA(NL+1,NH-NP+1)=A(NL+1,NH+1) A(NL+l,NH)=0.0D0\nA(NL+1,NH+1)=O.ODO\nENDIF\nENDIF\n\u20148----- de (ip,jp-1,1) ate (ip,jp\u201cl,kpl-l)\nIFd.EQ.IP.AND.J.EQ. (JP-1).AND.K.LT.KPI) THEN NCC=(I-1)*NYC*NZC+( J-1)*NZC+K CALL MONTA (I,JjK,L,NCC)\nNL=2*NCC-1 reduzir de 1 posicao os elementos i+l IFd.NE.NXC) THEN\ndfo/dpoi+l,j ,sgi+i,j, swi+lj\nNH=NL+NYC*NZC*2 NP=NBP*2 A(NLfNH-NP)=A(NL,NH) A(NL,NH-NP+1)=A(NL,NH+1) A(NL,NH)=O.ODO A(NL,NH+1)=O.ODO\ndfw/dpoi+l,j jSgi+i.j, swi+l,j\nA(NL+1,NH-NP)=A(NL+1,NH)\nA(NL+1,NH-NP+1)-A(NL+1,NH+1)\nA(NL+1,NH)=O.ODO A(NL+1,NH+1)\u00abO.ODO ENDIF\nENDIF\n\u20149-----de (ip,jp-l,kpl) ate (ip,jp-l,kpn)\nIF(I.EQ.IP.AND.J.EQ. (JP-1).AND.K.GE.KPI .AND.K.LE.KPN) THEN\nNCC-d-l)*NYC*NZC+(J-i)*NZC+K\nCALL MONTA (I,J,K,L,NCC)\nNL=2*NCC-1\nzerar os elementos em j+1 dfo/dpoi,j+l ,sgi,j+i, swi,j+l\nNH=NL+NZC*2\nA(NL,NH)~O.ODO\nA(NL,NH+l)=0.0D0\nC dfw/dpoi,j+l ,sgi,j41, swi,j+l\nA(NL+1,NH)=0.ODO\nC\nC\nc\nA(NL+1,NH+1)=O.ODO reduzir de 1 posicao os elementos i+1 IF(I.NE.NXC) THEN dfo/dpoi+l,j ,sgi+l,j, swi+l,j\nNH=NL+NYC*NZC*2 NP=NBP*2 A(NL,NH~NP)\u00abA(NL,NH) A(NL,NH-NP+1)=A(NL,NH+1) A(NL,NH)\u00abO,ODO A(NL,NH+l)=0.0D0 dfw/dpoi+ljj ,sgi+l,j, s\u00bbi+i,j\nA(NL+1,NH~NP)=A(NL+1,NH) A(NL+1,NH-NP+1)=A(NL+1,NH+1) A(NL+1,NH)-0.ODO\nA(NL+1,NH+1)=O.ODO\nENDIF\nOO U\tU Q\tO\tO Q\tO\tOO G>\nEND IF\n\u20141$\u2014 \u00bfe (ip,jp-1,kpn+l) ate (ip,jp-1,nzc)\nIF(I.EQ.IP.AND.J.EQ. (JP-1).AND.K.GT.KPN) THEN NCC=(I-1>*NYC*NZC+(J-1)*NZC+K CALL MONTA (I,J,K,L,NCC)\nNL=2*NCC-1\nNP=NBP*2\nreduzir de 1 posicao os elementos i+1\nIF(I.NE.NXC) THEN dfo/dpoi+l,j ,sgi+l,j, swi+l,j\nNH=NL+NYC*NZC*2\nA(NL,NH~NP)=A(NL,NH) A(NL,NH-NP+1)=A(NL,NH+1) A(NL,NH)=0.0D0 A(NL,NH+l)-0.ODO dfw/dpoi+l,j ,sgi+l,j, swi+l,j\nA(NL+1,NH-NP)=A(NL+1,NH) A(NL+1,NH-NP+1)=A(NL+1,NH+1) A(NL+i,NH)=0.0D0\nA(NL+1,NH+l)\u00ae0.0D0\nENDIF\nreduz os elementos em j+1 dfo/dpoi,j+1 ,sgi,j+l, swi,j+l\nNH=NL+NZC*2\nA(NL,NH-NP)=A(NL,NH)\nA(NL,NH-NP+l)=A(NL,NH+i)\nA(NL,NH)=0.ODO A(NL,NH+l)=0.0D0 dfw/dpoi,j+l ,sgi,j+l, swi,j+l\nA(NL+1,NH-NP)=A(NL+1,NH)\nA(NL+1,NH-NP+1)=A(NL+1,NH+1) A(NL+1,NH)=0.ODO\nA(NL+1,NH+1)=O.ODO\nENDIF\n\u201411---- de (ip,jp,l) ate (ip,jp,kpl-2)\nC\nC\nC\nC\nC\nC\no on\nNP=NBP*2 reduzir de 1 posicao os elementos i+1 IF(I.NE.NXC) THEN dfo/dpoi+l,j ,sgi+l,j, swi+l,j NH=NL+NYC*NZC*2 A(NL,NH-NP)=A(NLJNH) A(NL,NH-NP+1)=A(NL,NH+1) A(NL,NH)=0,ODO A(NL,NH+1)=O.ODO dfw/dpoi+i,j ,sgi+l,j, swi+l,j\nA(NL+1,NH-NP)=A(NL+1, NH) A(NL+1,NH-NP+1)=A(NL+1,NH+1) A(NL+i,NH)~O.ODO A(NL+1,NH+1)=O.ODO\nENDIF redux os elementos em j+1\nIF(J.NE.NYC) THEN dfo/dpoi,j+l ,sgi,j+l, swij+l\nNH=NL+NZC*2 A(NLiNH-NP)=A(NL,NH) A(NL,NH-NP+1>A (NL.NH+l) A(NL,NH)=O.ODO A(NL,NH+1)=O.ODO dfw/dpoi,j+l jSgi.j+l, swi,j+l\nA(NL+1,NH-NP)=A(NL+1,NH) A(NL+1,NH-NP+1)=A(NL+1,NH+1) A(NL+l,NH)S50 .ODO\nA(NL+1,NH+1)\u201c0.ODO\nENDIF\nENDIF\n\u2014 12--- (ip,jp,kpl-l)\nC\nC\nC\nC\nC\nIF(I.EQ.IP.AND.J.EQ.JP.AND.K.EQ.(KP1-1)) THEN NCC=(I-i)*NYC*NZC+(J~l)*NZC+K CALL MONTA (I,J,K,L,NCC)\nNL=2*NCC-1 NP=NBP*2 reduzir de 1 posicao os elementos i+1 IF(I.NE.NXC) THEN dfo/dpoi+l,j ,sgi+l,j, swi+l,j\nNH=NL+NYC*NZC*2 A(NL,NH-NP)\u00abA(NL,NH) A(NL,NH-NP+1)-A(NL,NH+1) A(NL,NH)=O.ODO A(NL,NH+1)=O.ODO dfw/dpoi+l,j ,sgi+l,j, swi+lj\nA(NL+1,NH-NP)=A(NL+1,NH)\nA(NL+1,NH-NP+1)=A(NL+1,NH+1)\nA(NL+1,NH)=0.ODO\nAfNL+i,NH+1)=O.ODO\nENDIF\nreduz os elementos em j+1 IF(J.NE.NYC) THEN dfo/dpoi,j+1 ,sgi,j+l, swij+l\nNH=NL+NZC*2 A(NL,NH-NP)=A(NL,NH) A(NL,NH-NP+1)=A(NL,NH+1) A(NL,NH)=O.ODO\nC\nC\nc\nc\nn on\nc\nc\nc\nc\nC\nC\nC\nc\nc\nA(NL,NH+l)-0.0D0 dfw/dpoi,j+l ,sgi,j+l, swi,j+l\nA(NL+1f NH-NP)=A(NL+1f NH) A(NL+1,NH-NP+1)=A(NL+1,NH+1) A(NL+l,NH)\u00ab0.0D0 A(NL+l,NH+l)=0.0D0\nENDIF anula os elementos em k+1\nIF(K.NE.NZC) THEN dfo/dpoi,j,k+l ,sgi,j,k+i, swi^jjk+l A(NLINL+2)=0.0D0 A(NL,NL+3)\u00ab0.0D0 dfw/dpoi,j,k+l ,sgi,j,k+l, swi,j,k+l A(NL+1,NL+2)=0.0D0 A(NL+1,NL+3)=0.0D0\nENDIF ENDIF_ \u2014 13--- (ip,jp,kpn+l)\nIF (I.EQ,IP.AND. 1. EQ.JP.AND.K.EQ.(KPN+1j) THEN NCO (I-l) +NYC+NZC+ (J-1) +NZC+K-NBP CALL MONTA (I,J,K,L,NCC)\nNL=2*NCC-1 NP=NBP*2 avan\u00e7ar de 1 posicao os elementos i-1\nIF(I.NE.l) THEN dfo/dpoi-l,j >sgi-l,j, swi-l,j\nNH=NL-NYC*NZC*2 A(NL,NH+NP)=A(NL,NH) A(NL,NH+NP+1)-A(NL,NH+1) A(NL,NH)=0.0D0 A(NL,NH+l)a0.0D0 dfw/dpoi-l.j ,sgi-i,j, swi\u2019l,j\nA(NL+1,NH+NP)=A(NL+1,NH) A(NL+1,NH+NP+1)=A(NL+1,NH+1) A(NL+1,NH)=0.0D0\nA(NL+1,NH+1)=O.0D0\nENDIF avan\u00e7ar os elementos em j-1\nIF(J.NE.l) THEN ,sgi,j-l, swij-l NH=NL-NZC*2 A(NL,NH+NP)=A(NL,NH) A(NL,NH+NP+1)=A(NL,NH+1) A(NL,NH)=O,ODO A(NL,NH+1)~O.0D0 ,sgi,j-l, sw\u00edj-l A(NL+1,NH+NP)-A(NL+1,NH) A(NL+1fNH+NP+1)=A(NL+1,NH+1) A(NL+1tNH)\u00ab0,0D0 A(NL+l1NH+l)=0.0D0\nENDIF anula os elementos em k-i IF(K.NE.l) THEN dfo/dpoi,j,k\u201dl ,sgi,j,k-l, swi >j,k-l A(NL,NL-2)=0.0D0 aO\u00edl.nl-\u00edM.odo\ndfw/dpoi,j,k-l ,sgij,k-l, swi,j,k-l\ndfo/dpoi,j-1\ndfw/dpoi,j-1\nono\ta\tao\ta\to o\tooo\nENDIF\nENDIF\nA(NL+l,NL-2)=0.0D0\nA(NL+1,NL-1)=0.000\n\u201414\u2014 (ip,jp,kpn+2) ate (\u00edp,jp,nzc)\nIF(I.EQ.IP.AND.J.Eq.JP.AND.K,GT.(KPN+1)) THEN NCC=(I-l)*NYC*NZC+(J-\u00ed)*NZC+K-NBP CALL MONTA (I,J,K,L,NCC)\nNL=2*NCC-1 NP=NBP*2 avan\u00e7ar de 1 posicao os elementos i-1\nIF(l.NE.l) THEN dfo/dpoi-i,j ,sgi~l,j, swi-l,j NH=NL-NYC*NZC*2 A(NL,NH+NP)=A(NL,NH) A(NL,NH+NP+1)=A(NL,NH+1) A(NL,NH)=O.ODO A(NL,NH+1)=O.0D0 dfw/dpoi-1,j ,sgi-l,j, swi-lj\nA(NL+1,NH+NP)=A(NL+1,NH) A(NL+1,NH+NP+1)=A(NL+1,NH+1) A(NL+1,NH)=O.ODO A(NL+1,NH+1)=O,ODO\nENDIF avan\u00e7ar os elementos em j-1 IF(J.NE.l) THEN ,sgi,j-l, swij-l NH=NL-NZC*2 A(NL,NH+NP)\u00abA(NL,NH) A(NL,NH+NP+1)=A(NL,NH+1) A(NL,NH)-0.0D0 A(NL,NH+1)\u00bbO.000 ,sgi,j-l, swi,j-l A(NL+1,NH+NP)=A(NL+1,NH) A(NL+1,NH+NP+1)=A(NL+1,NH+1) A(NL+l,NH)\u00bb0.0D0 A(NL+1,NH+1)=O. 0D0\noij-1\ndfv/dpoi,j~l\nENDIF\nENDIF\n\u201415---- (ip,jp+l,l) ate (ip,jp+l,kpl-l)\nIF(I.EQ.IP. AND.J .EQ. (JP+1) . AND.K\".LT.KP1) THEN\nNCC=(I-1)*NYC*NZC+(J-1)+NZC+K-NBP\nCALL MONTA (I,J,K,L,NCC)\nNL=2*NCC-1\nNP=NBP*2\nC avan\u00e7ar de 1 posicao os elementos i-1\nIF(I.NE.l) THEN\nC dfo/dpoi-lj ,sgi-l,j, swi-lj NH=NL-NYC*NZC*2 A(NL,NH+NP)=A(NL,NH)\nA(NL,NH+NP+1)\u00abA(NL,NH+1) A(NL,NH)=0.0D0 A(NL,NH+1)=O.ODO\nC dfw/dpoi-\u00cdJ ,sgi-l,j, swi-l,j\nA(NL+1,NH+NP)-A(NL+1,NH)\nc\nc\nc\nA(NL+1,NH+NP+1)=A(NL+1,NH+1)\nA(NL+1,NH)~O.ODO\nA(NL+1,NH+1)=O.ODO\nEND IF avan\u00e7ar os elementos era j-1\nIF(J.NE.l) THEN\ndfo/dpoi,j-l\ndfw/dpoijj-l\nENDIF\nEND IF\n,Sgl,J-i, SW1J-1 NH\u00abNL-NZC*2 A(NL,NH+NP)=A(NL,NH) A(NL,NH+NP+1)=A(NL,NH+1) A(NL,NH>0.0D0\nA(NL,NH+1)=0.ODO\n,sgi,j-l, swi,j-l\nA(NL+1,NH+NP)=A(NL+1,NH) A(NL+1,NH+NP+1)=A(NL+1,NH+1) A(NL+1,NH)=Q.ODO\nA(NL+1,NH+1)=O.ODO\nnon\tnon\to\to a\taoa\n\u201415\u2014 (ip,jp+1 ,kj)l) ate (ip,jp+1,kpn)\nIF(I.EQ.IP.AND.J.EQ.(JP+1).AND.K.GE.KPI.AND.K.LE.KPN) THEN NCC=(I-1)*NYC*NZC+(J-1)+NZC+K-NBP CALL MONTA (I,J,K,L,NCC)\nNL-2*NCC-1 NP=NBP*2 avan\u00e7ar de 1 posicao os elementos i~l\nIF(I.NE.l) THEN dfo/dpoi-l,j ,sgi\u201dl,j, swi-l,j\nNH=NL-NYC*NZC*2 A(NL,NH+NP)\u00bbA(NL,NH) A(NL,NH+NP+1)\u00bbA(NL,NH+1)\nA(NL,NH)=0.ODO A(NL,NH+1)=O.ODO\ndfw/dpoi-l,j ,sgi-l,j, svi-l.j\nA(NL+1,NH+NP)\"A(NL+1,NH)\nA(NL+1,NH+NP+1)=A(NL+1,NH+1)\nA(NL+1,NH)=0,ODO\nA(NL+1,NH+1)=O.ODO ENDIF\nanula os elementos em j~l\nIF(J.NE.l) THEN dfo/dpoi,j-l ,sgi,j-l, swi,j-l\nNH-NL-NZC*2 A(NL,NH)=0.ODO A(NL,NH+1)=Q.ODO\ndfw/dpoij-l ,sgi,j-l, swij-l\nA(NL+1,NH)=O.ODO A(NL+1,NH+1)=O.ODO ENDIF\nENDIF\n\u201417---- (ip,jp+l,kpn+l) ate (ip,jp+1,nzc)\nC\nC\nc\noaa\to\tno\ta on\navancar de 1 posicao os elementos i-1\nIF(I.NE.l) THEN dfo/dpoi-l,j ,sgi-l,j, swi-l,j\nNH=NL-NYC*NZC*2\nA(NL,NH+NP)=A(NL,NH) aCnunh+np+D-aCni^nh+i) A(NL,NH)=O.ODO\nA(NL,NH+1)=O.ODO dfw/dpoi-l,j ,sgi-l,j, swi-ljj\nA(NL+1,NH+NP)\u201cA(NL+1,NH)\nA(NL+1,NH+NP+1)=A(NL+1,NH+1)\nA(NL+1,NH)=0.ODO\nA(NL+1,NH+i)=O.ODO\nENDIF\nENDIF\n\u201417a\u2014\t(ip,jp+2,l) at\u00ae (ipjiiycjiizc)\nIF(I.EQ.IP.AND.J.GE.(JP+2)) THEN\nNCO(I-1)*NYC*NZC+(J-1)*NZC+K-NBP CALL MONTA (I,J,K,L,NCC) NL=2*NCC-1 avaucar de 1 posicao os eleroentos i-1 dfo/dpoi-lj ,sgi-l,j, swi-l,j\nIF(I.NE.l) THEN NH=NL~NYC*NZC*2 NP=NBP*2 A(NL,NH+NP)=A(NL,NH) AiNL.NH+NP+D-ACNLjNH+l) A(NL,NH)=0.ODO A(NL,NH+1)=O.ODO dfw/dpoi-1,j ,sgi-l,j, swi-1,j\nA(NL+1 ,NH+NP)S\u00a3A(NL+1,NH) A(NL+1,NH+NP+1)=A(NL+1,NH+1) A(NL+1,NH)=0.ODO\nA(NL+1,NH+1)=O.ODO\nENDIF\nENDIF\n\u201418\u2014\t(ip+1,1,1) ate (ip+l,nyc,nzc)\nIF(X.EQ.(IP+1).AND.J.LE.(JP-1)) THEN NCC=(I-1)*NYC*NZC+(J-1)*NZC+K~NBP CALL MONTA (I,JtK,L,NCC) NL\u00ab2*NCC-1\nC avancar de 1 posicao os elementos 1-1 IF(I.NE.I) THEN\nC dfo/dpoi-l,j ,sgi-l,j, swi-l,j NH-NL-NYC*NZC*2\nA(NL,NH+NP)=A(NL,NH) A(NL,NH+NP+1)=A(NL,NH+1) A(NL,NH)=0.0D0 A(NL,NH+1)=O.ODO\nC dfw/dpoi-1,j ,sgi-l,j, swi-l,j\nA(NL+1,NH+NP)=A(NL+1,NH) A(NL+1,NH+NP+1)\u00abA(NL+1,NH+1) A(NL+l,NH)=0.0D0\nA(NL+1,NH+1)=O.ODO\nENDIF\naoo\tn no\tci on\tn\tno\tn nn\to\tan\tnon\nENDIF\n\u201419\u2014 (ip+l,jp,l) ate (ip+1,jp,kpl-i)\nIF(I.EQ.(IP+1) .AND.J.Eq.JP.AND.K.LT.KPI) THEN NCC=(I-1)*NYC*NZC+(J-1)*NZC+K~NBP CALL MONTA (I,J,K,L,NCC)\nNL=2*NCC~1 avancar de 1 posicao os elementos i-1\nIF(I.NE.l) THEN dfo/dpai-1,j ,sgi-l,j, swi-l,j\nNH=NL-NYC*NZC*2 NP-NBP+2\nA(NL,NH+NP)=A(NL,NH) A(NL,NH+NP+1)=A(NL,NH+1) A(NL,NH)=0.0D0 A(NL,NH+1)=O.ODO\ndfw/dpoi-1,j ,sgi-l,j, swi-l,j A(NL+1,NH+NP)\u00bbA(NL+1,NH) A(NL+1,NH+NP+1)-A(NL+1,NH+1) A(NL+1,NH)=0.ODO A(NL+l,NH+l)=0.0D0\nENDIF\nENDIF\n\u201420\u2014\t(ip+1,jp.kpl) ate (ip+1,jp,kpn)\nIF(I.EQ.(IP+1).AND.J.EQ.JP.AND.K.GE.KP1.AND.K.LE.KPN) THEN NCC=(I-1)+NYC+NZC+(J-1)+NZC+K-NBP CALL MONTA (I,J,K,L,NCC)\nNL=2*NCC-1 anula os elementos i~l\nIF(I.NE.l) THEN dfo/dpoi~l,j ,sgi-l,j, swi-l,j NH=NL-NYC*NZC*2 A(NL,NH)=0.0D0 A(NL,NH+1)=O. ODO dfw/dpoi-1,j ,sgi-l,j, swi\u2014l,j\nA(NL+1,NH)=O-ODO\nA(NL+l,NH+l)\u00ab0.0D0\nENDIF\nENDIF\n\u201421\u2014\t(ip+1,jp,kpn+l) ate (ip+1,jp,nzc)\nIF(I.EQ.(IP+1).AND.J.EQ.JP.AND.K.GT.KPN) THEN NCC=(I -1)*NYC*NZC+(J-1)+NZC+K-NBP CALL MONTA (I,J,K,L,NCC)\nENDIF\n\u201422  (ip+1,jp+1,1) ate (ip+l,nyc,nzc)\nIF(I.EQ.(IP+1).AND.J.GE.(JP+1)) THEN NCC=(I\u201c1)*NYC*NZC+(J-1)+NZC+K-NBP CALL MONTA (I,J,K,L,NCC)\nENDIF\n\u201423---- (ip+2,1,1) ate (nxc,nyc,nzc)\nIF(I,GE.(IP+2)) THEN\nNCC=(I-1)+NYC+NZC+(J-1)+NZC+K-NBP\nCALL MONTA (I,J,K,L,NCC)\nGoon a aan o o naan\nEND IF\nENDIF\nPARTE REFERENTE AD GRID RADIAL\nIF(L.EQ.l) THEN\nNCR=NBC+(I-1)*NYR*NZR+(J-1)*NZR+K CALL MONTA (I,J,K,L,NCR)\nENDIF\nPARTE REFERENTE AS INTERFACES DO RADIAL COM 0 CARTESIANO\nIF(L.EQ.1.AND.I.EQ.NXR) CALL MONTAIN (I,J,K,L,1)\nIF(L.EQ.1.AND.K.EQ.1.AND.KP.NE.l) CALL MONTAIN (I,J,K,L,2)\nIF(L.EQ.1.AND.K.Eq.NZR.AND,KP+NBP~1.LT.NZC)CALL MONTAIN(I,J,K,L,3)\nRETURN\nEND\nMONTAGEM DA MATRIZ JACOBIANA\nSUBROUTINE MONTA (I^K^NC)\nIMPLICIT DOUBLE PRECISION(A-H.O-Z)\nPARAMETER(NXM=08,NYM=05,NZM=O4)\nCOMMON/NCEL/DBDX,DBDY,DBDZ,WRC,NBLOC ,NXC,NYC,NZC,NBP,\n*\tNXR,NYR,NZR,NQL,NqS,NQIfIP,JP,KP\nCOMMON/NBLC/A,D,NBC,NBR,NBT\nCOMMON/PETR/KRO,KRW,DKRO,DKRW,PC,DPC\nCOMMON/DTRANS/TOX,TWX,TOY,TWY,TOZ,TWZ,\n*\tTOX1SA,TOX1SI,TWX1SA,TWX1SI,\n*\tT0X2SI,T0X2SP}TWX2SI,TWX2SPJ\n*\tTOY1SA,TOY1SI,TWY1SA,TWY1SI,\n*\tTOY2SI,T0Y2SP,TWY2SI,TWY2SP,\n*\tTOZ1SA,TOZ1SI,TWZ1SA,TWZ1SI,\n*\tT0Z2SI,T0Z2SP,TWZ2SIjTWZ2SP\nCOMMON/VAZAO/qO,QOT,QG,QGT,qW,QWT,DQOP,DqOS,\n*\tDqWP,DQWS ,RWO,RGQ,PWF,TEMPO\nCOMMON/ANULA/IX1 tIX2,IYl,IY2,IZl,IZ2,IDR,IDCtLBC,JMA,JME,IX,JX,LBR\nCOMMON/ACU/ACO,ACW,DACOP,DACOS,DACWP,DACWS\nCOMMON/POT/POTOX1,P0T0X2,POTOY1,P0T0Y2,POTOZ1,P0TDZ2,\n*\tPOTWX1,P0TWX2,P0TWYl,P0TWY2,P0TWZl,PDTWZ2,\n*\tPOX1PA,POX1PI,POY1PA,POY1PI,POZ1PA,POZ1PI,\n*\tPOX2PI,POX2PP,PDY2PI,POY2PP,POZ2PI,P0Z2PP,\n*\tPWX1PA,PWX1PI,PWY1PA,PWY1PI,PWZ1PA,PWZ1PI,\n*\tPWX2PI,PWX2PP,PWY2PI,PWY2PP,PWZ2PI,PWZ2PP,\n*\tT0X1PA,T0X1PI,TOY1PA,TDY1PI,TDZ1PA.T0Z1PI,\n*\tT0X2PI,T0X2PP,T0Y2PI,T0Y2PP,TOZ2PI,T0Z2PP,\n*\tTWX1PA,TWX1PI,TWY1PA,TWY1PI,TWZ1PA,TWZ1PI,\n*\tTWX2PI,TWX2PP,TWY2PI,TWY2PP,TWZ2PI,TWZ2PP\nCOMMON/SDEOW/STPO,STPW,SDEOPI,SDEOSI,SDEWPI,SDEWSI,\n*\tDFOPX,DFOSX,DFWPX,DFWSX,DFOPZ,DFOSZ,DFWPZ > DFWSZ\nDIMENSION DKR0(NXM,NYM,NZM,2),DKRW(NXM,NYM,NZM,2),\n*\tPC(0:NXM+l,0:NYM+l,0:NZM+l,2),DPC(Q:NXM+1,0:NYM+1,0:NZM+1,2)\nREAL*8\tKR0(NXM,NYM,NZM,2),KRW(NXM,NYM,NZM,2)\nDIMENSION TOX(NXM+1,NYM,NZM , 2),TWX(NXM+11NYM,NZM,2),\n*\tT0XlSA(NXMJNYM)NZMi2)iTQXlSI(NXM1NYMfNZM,2),\n*\tTWX1SA(NXM>NYK,NZM>2),TWX1SI(NXM,NYM,NZM>2)>\nC\n*\tTOX2SI(NXM,NYM,NZM,2).TOX2SP(NXM,NYM,NZM,2),\n*\tTWX2SI(NXM,NYM,NZM,2),TWX2SP(NXM,NYM tNZM,2)\nDIMENSION T0Y(NXM,NYM+l,NZM,2),TWY(NXM,NYM+l,NZM,2),\n*\tTOY1SA(NXM,NYM,NZM,2) ,TOY1SI(NXM,NYM,NZM,2),\n*\tTWY1SA(NXM,NYM,NZM,2) ,TVY1SI(NXM,NYM,NZM,2),\n*\tT0Y2SI(NXM,NYM,NZM,2),T0Y2SP(NXM,NYM,NZM,2),\n*\tTWY2SI(NXM,NYM,NZM,2),TWY2SP(NXM,NYM,NZM,2) DIMENSION TOZ(NXM,NYM,NZM+1,2),TWZ(NXM,NYM,NZM+1,2) ,\n*\tTOZISA(NXM,NYM,NZM,2),TOZ1SI(NXM,NYM,NZM,2),\n*\tTWZ1SA(NXM,NYM,NZM,2),TWZ1SI(NXM,NYM,NZM,2),\n*\tT0Z2SI(NXM,NYM,NZM,2),T0Z2SP(NXM,NYM,NZM,2),\n*\tTWZ2SI(NXM,NYM,NZM,2),TWZ2SP(NXM,NYM,NZM,2)\nDIMENSION QO(NYM,NZM),QG(NYM,NZM),QW(NYM,NZM),DQOP(NYM,NZM),\nDQOS(NYM,NZM),DqWP(NYM,NZM),DQWS(NYM,NZM)\nDIMENSION A(NXM*NYM*NZM*4,NXM*NYM*NZM*4),D(NXM*NYM*NZM*4)\nDIMENSION STPO(0:6,NZM),STPW(0:6,NZM)\nSTPO \u2014> Somatorio de Trans. X Pot. do Oleo\nDIMENSION SDEOPI(0:6,NZM),SDEWPI(0:6 ,NZM),SDEOSI(0:6,NZM),\nNX-NXC\nSDEWSI(0:6,NZM)\nSDEOP\u2014> Som. da Derivada da Eq. do Oleo em rel. a Pres.\nIF(L.EQ.l) THEN\nNL=2*NC-1\nC dfw/dpoij ,sgij, swij\nA(NL ,NL)=IX2*(P0TWX2+TWX2PI+TWX(1+1,J,K, L)+PWX2PI)-\n*\n*\n*\n*\n*\n*\n1X1+(P0TWX1+TWX1PI+TWX(I,J,K, L)+PWX1PI)+\nIY2 *(P0TWY2* TWY2PI+TWY(I,JMA,K,L)*PWY2PI)-IY1*(P0TWY1+TWY1PI+TWY(I,J, K, L)+PWY1PI)+\nIZ2*(P0TWZ2+TWZ2PI+TWZ(I,J,K+l,L)+PWZ2PI)-\nIZ1*(P0TWZ1+TWZ1PI+TWZ(I,J,K,L)+PWZ1PI)-\nDACWP-(1-IDR)*DQWP(J,K)+IDC*SDEWPI(LBC,LBR)\nC dF\u00bb/dSwi,j,k\nA(NL,NL+1)=\n*\t1X2+(PQTWX2+TWX2SI(I, J, K, L) +TWX(1+1, J, K, L )*DPC(I,J,K,L))-\n*\tIX1*(POTWX1*TWX1SI(I,J,K,L)~IDR*TWX(I,d,K,L)*DPC(I,J,K,L))+\n*\tIY2*(P0TWY2*TWY2SI(I,J,K,L)+TWY(I,JMA,K,L)*DPC(I,J,K,L) )~\n*\tIY1*(POTWY1*TWY1SI(I,J,K,L)-TWY(T,J,K,L)*DPC(I,J,K,L))+\n*\tIZ2*(P0TWZ2+TWZ2SI(I,J,K,L)+TWZ(I,J,K+l,L)*DPC(I,J,K,L))-\n*\tIZ1*(POTWZ1*TWZ1SI(I,J,K,L)-TWZ(I,J,K,L)*DPC(I,J,K,L))-\n*\tDACWS~(l-IDR)*DQnS(J,K)+IDC*SDEWSI(LBC,LBR)\nC dFo/dPoi,j,k\nA(NL+1,NL>IX2*(P0T0X2*T0X2PI+T0X(I+l,J,K,L)+P0X2PI)-\n*\tIX1*(PDTOX1*TOX1PI+TOX(I,J,K,L)*POX1PI)+\n*\tIY2*(P0T0Y2*T0Y2PI+TDY(I,JMA,K,L)*P0Y2PI)-\n+\tIY1*(POTOY1*TOY1PI+TOY(I,J,K,L)*POY1PI)+\n*\tIZ2*(P0T0Z2*T0Z2PI+T0Z(I,J,K+l,L)+P0Z2PI)~\n*\tIZ1*(POTOZ1*TOZ1PI+TOZ(I,J,K,L)*POZ1PI)-\nC dFo/dSwi,j,k\nDACOP-(1-IDR)*DQOP(J,K)+IDC+SDEOPI(LBC,LBR)\n*\tIY1*(POTOY1*TDY1SI(I,J,K,L))+\n*\tIZ2*(P0T0Z2*T0Z2SI(I3J,K,L))-\n*\tIZl*(POTDZl*TOZlSI(I,J,KiL))~\n*\tDAGOS-(1-IDR)*DQOS(JJK)+IDC*SDEOSI(LBC,LBR)\nIF(I.NE.l) THEN\nNH=NY*NZ*2\nC dFw/dPoi-13j,k A(NL,NL-NH)=-POTWX1*TWX1PA-TWX(I,J,K,L)*PWX1PA\nC dFw/dSwi-1,j,k A(NLJNL-NH+1)=-POTWX1*TWX1SA(I,J}K,L)-\n*\tIDR*(TWX(I,J,K,L)*DPC(I-1,J,K,L))\nC dFo/dPoi-1,j,k\nA(NL+1,NL-NH)=-POTOX1*TOX1PA-TOX(I,J,K,L)*PDX1PA\nC dFo/dSwi-lJ jk\nA(NL+1> NL-NH+1)=-P0T0X1*TOX1SA(I, J,K,L)\nENDIF\nC\nIF(I.NE.NX) THEN\nNH~NY*NZ*2\nC dFw/dPoi+l,j,k\nA(NL,NL+NH)=P0TWX2*TWX2PP+TWX(1+1,J,K,L)+PWX2PP\nC dFw/dSwi+1,j,k A(NLiNL+NH+l)=P0TWX2*TWX2SP(I,J,K1L)-\n*\tTWX(I+1,J,K,L)*DPC(I+1,J,K,L)\nC dFo/dPoi+1,j,k\nA(NL+1,NL+NH)=POTOX2*TOX2PP+TOX(I+1?J>K,L)*P0X2PP\nC dFo/dSwi+1J,k\nA(NL+1,NL+NH+1)=POTOX2*TOX2SP(I, J t K\u00bbL)\nENDIF\nC\nIF(J.NE.l) THEN\nNH=NZ*2\nC dFw/dPoi,j-l,k\nA(NL,NL-NH)=-POTWYl*TWYlPA-TWY(I,J,KJL)*PWY1PA\nC dFw/dSwi,j-1,k\nA(NLINL-NH+1)=-POTWY1*TWY1SA(I,J}KtL)-TWY(I3J,K,L)*\n*\tDPC(I,JME,K,L)\nC dFo/dPoi,j-l,k\nA(NL+1jNL-NH)=-P0T0Yl*T0YlPA-T0Y(l,J,K,L)*POY1PA\nC dFo/dSwi,j-l,k\nA(NL+1,NL~NH+1)=~POTOY1*TOY1SA(I,J,K,L)\nENDIF\nc\nIF(J.NE.NY) THEN\nNH=NZ*2\nC dFw/dPoi,j+13k\nA(NL,NL+NH)=P0TWY2*TWY2PP+TWY(I,JMA,K,L)+PWY2PP\nC dFw/dSwi,j+13k\nA(NL,NL+NH+1)=P0TWY2*TWY2SP(I,J,K,L)-\n*\tTWY(I,JMAfK,L)*DPC(I,JMA,K(L)\nC dFo/dPoi3j+13k\nA(NL+1,NL+NH)=P0T0Y2*T0Y2PP+T0Y(I,JMA,K,L)*P0Y2PP\nC dFo/dSwi,j+1,k\nA(NL+1,NL+NH+1)=POTOY2*TOY2SP(I,J,K,L)\nENDIF\nC So radial\nIF(L,EQ.1.AND.J.EQ.1) THEN\nNH~(NY*NZ~NZ)*2\nC dFw/dPoi,j-lfk\nA(NL,NL+NH)\u00ab\"POTWY1*TWY1PA-TWY(I,J,K,L)*PWY1PA\nC dFw/dSwiJ-hk\nA(NL,NL+NH+1)=-POTWY1*TWY1SA(I,J,K,L)-TWY(I,J,K,L)*\n*\tDPC(I,JME,K,L)\nC dFo/dPoiJ-l.k\nA(NL+1,NL+NH)=-P0T0Yl*T0YlPA-T0Y(I,J,K,L)+P0Y1PA\nC dFo/dS\u00bbi,j\"l,k\nA(NL+1,NL+NH+1)=-POTOY1*TDY1SA(I,J,K,L)\nEND IF\nSo radial\nIF(L.EQ.l.AND.J.EQ.NY) THEN\nNH=(NY*NZ-NZ)*2\ndFw/dPoi,j+l,k\nA(NL,NL-NH)=P0TWY2*TWY2PP+TWY(I,JMA,K,L)*PWY2PP dFw/dSsi,j+1,k\nA (NL,NL-NH+1)=P0TWY2*TWY2SP(I,J,K,L)-\n*\tTWY(I,JMA,K)L)*DPC(I,JMA,K,L) dFo/dPoi,j+l,k\nA(NL+1,NL-NH)=P0T0Y2*T0Y2PP+T0Y(I,JMA,K,L)*P0Y2PP dFo/dSwi,j+1,k\nA(NL+1,NL~NH+l)-P0TQY2*T0Y2SP(I,J,K,L)\nENDIF\noo o es o o o o na a a nan aa\tan a a an\nC\u00e9lulas atraz da c\u00e9lula i,j,k\nIF(K.NE.l) THEN dFw/dPoi,j,k-l\nA(NL)NL-2)=\u2019P0TWZ1*TWZ1PA-TWZ(IiJjKjL)*PWZ1PA\ndFw/dSwi*j,\u00bf-1\nA(NL,NL-1)sb\u201dP0TWZ1*TWZ1SA(I , J,K,L)~TWZ(I, J ,K,L)*\n*\tDPC(I,J,K-1,L) dFo/dPoi J(k-1\nA(NL+1,NL-2)\u00ae-P0T0Zl*T0ZiPA\u201cTQZ(I,J,K,L)*POZ1PA\ndFo/dSwi,j,k\u201dl\nA(NL+1,NL-1)=C-POTOZ1*TOZ1SA(I, J,K,L)\nENDIF\nC\u00e9lulas a frente da c\u00e9lula i,j,k\nIF(K.NE.NZ) THEN dFw/dPoi,j,k+l\nA(NL,NL+2)=P0TWZ2*TWZ2PP+TWZ(I,J,K+1,L)*PWZ2PP\ndFw/dSwi,j,\u00bf+1\nA(NL.NL+3)=P0TWZ2*TWZ2SP(I,J,K,L)-\n*\tTWZ(I,J,K+1,L)*DPC(I,J,K+1,L) dFo/dPoi,j,k+l\nA(NL+l,NL+2)=PDT0Z2*T0Z2PP+T0Z(I,J,K+l,L)*P0Z2PP dFo/dSwi,j,k+l\nA(NL+1,NL+3)=POTOZ2*TOZ2SP(I,J,K,L)\nENDIF\nRETURN\n_ END\n\u2019\u201dpART\u00c9~H\u00c9f\u00c9r\u00c9\u00d1te\u201d\u00c1s\"\u00cd\u00d1tERF\u00c1c\u00c9s\u201ddO RADIAL~COm\u2019o CARTESIANO\nC\nc\nSUBROUTINE MONTAIN (I,J,K,L,IND)\nIMPLICIT DOUBLE PRECISION(A-H,O-Z) PARAMETER(NXM=08,NYM-05,NZM=04)\nCOMMON/NCEL/DBDX,DBDY,DBDZ,WRC,NBLOC,NXC,NYC,NZC,NBP,\n*\tNXR,NYR,NZR,NQL,NQS,NQI,IP,JP,KP COMMON/NBLC/A,D,NBC,NBR,NBT\nCOMMON/PETR/KRO,KRW,DKRO,DKRW,PC,DPC COMMON/DTRANS/TOX,TWX,TOY,TWY,TOZ,TWZ,\n*\tTOX1SA,TOX1SI,TWX1SA,TWX1SI,\n*\tT0X2SI,T0X2SP,TWX2SI,TWX2SP,\n*\tTOY1SA,TDY1SI,TWY1SA,TWY1SI,\n*\tT0Y2SI,T0Y2SP,TWY2SI,TWY2SP,\n*\tTOZ1SA,TOZ1SI,TWZ1SA,TWZ1SI,\n*\tT0Z2SI,T0Z2SP,TWZ2SI,TWZ2SP COMMON/VAZAO/qO,QOT,QG,QGT,QW,QWT,DQOP,DqOS,\n*\tDqwp,dqws,RWO,EGO,PWF,TEMPO\nCOMMON/ANULA/IX1,1X2,IY1,IY2,IZ1,IZ2,IDR,IDC,LBC,JMA,JME,IX,JX,LBR COMMON/ACU/ACO, ACW,DACOP,DACDS,DACWP,DACWS\nCOMMON/POT/POTOX1,P0T0X2,P0T0Y1,P0T0Y2,P0T0Z1,P0T0Z2, POTWX1,P0TWX2,P0TWY1,PQTWY2,POTWZ1,P0TWZ2, P0X1PA,P0X1PI,P0Y1PA,P0Y1PI,POZ1PA,P0Z1PI, P0X2PI,P0X2PP,P0Y2PI,P0Y2PP,P0Z2PI,P0Z2PP, PWX1PA,PWX1PI,PWYiPA,PWY1PI,PWZ1PA,PWZ1PI, PWX2PI,PWX2PP,PWY2PI,PWY2PP,PWZ2PI,PWZ2PP, TOX1PA,TOX1PI,TOY1PA,TOY1PI,TOZ1PA,TOZ1PI, TOX2PI,TOX2PP,TOY2PI,TOY2PP,TOZ2PI,TDZ2PP, TWX1PA,TWX1PI,TWY1PA,TWY1PI,TWZ1PA,TWZ1PI, TWX2PI,TWX2PP,TWY2PI,TWY2PP,TWZ2PI,TWZ2PP\nCOMMON/SDEOW/STPO,STPW,SDEOPI,SDEOSI,SDEWPI,SDEWSI,\n*\tDFOPX,DFOSX,DFWPX,DFWSX,DFOPZ,DFOSZ,DFWPZ,DFWSZ DIMENSION DKRO(NXM,NYM,NZM,2),DKRW(NXM,NYM,NZM,2),\n*\tPC(O:NXM+1,0:NYM+l,0:NZM+l,2),DPC(O:NXM+1,O:NYM+1,0:NZM+l,2) REAL*8\nDIMENSION\n*\n*\n*\n*\nDIMENSION\n*\n*\n*\n*\nDIMENSION\n*\n*\n*\n*\nDIMENSION\n*\nDIMENSION DIMENSION\n*\n*\n*\n*\n*\n*\n*\n*\n*\nc\nDIMENSION\n\u2666\nc\nC'\nKRO(NXM tNYM,NZM,2),KRW (NXM,NYM,NZM,2) TOX(NXM+1 ,NYM,NZM,2) ^XCNXM+l.NYM^ZM^) , TQX1SA(NXM,NYM,NZM,2),TOX1SI(NXM,NYM,NZM,2), TWX1SA(NXM,NYM,NZM,2),TWX1SI(NXM,NYM,NZM,2), T0X2SI(NXM,NYM,NZM,2),T0X2SP(NXM,NYM,NZM,2), TWX2SI(NXM,NYM,NZM,2),TWX2SP(NXM,NYM,NZM,2) T0Y(NXM,NYM+l,NZM,2),TWY(NXM,NYM+1,NZM,2), TOY1SA(NXM,NYM,NZM,2),TOY1SI(NXM,NYM,NZM,2) TWY1SA(NXM,NYM,NZM,2),TWY1SI(NXM,NYM,NZM,2) T0Y2SI(NXM,NYM,NZM,2),T0Y2SP(NXM,NYM,NZM,2) TWY2SI(NXM,NYM,NZM,2),TWY2SP(NXM,NYM,NZM,2) TOZ(NXM,NYM,NZM+1,2),TWZ(NXM,NYM,NZM+1,2), TOZ1SA(NXM,NYM,NZM,2),TOZ1SI(NXM,NYM,NZM,2) TWZ1SA(NXM,NYM,NZM,2),TWZ1SI(NXM,NYM,NZM,2) TDZ2SI(NXM,NYM,NZM,2)fT0Z2SP(NXM,NYM,NZM,2) TWZ2SI(NXM,NYM,NZM,2),TWZ2SP(NXM,NYM,NZM,2) QO (NYM,NZM) , QG (NYM,NZM) , qW (NYM,NZM) , DqOP (NYM, NZM) , DQOS(NYM,NZM),DqWP(NYM,NZM),DqWS(NYM,NZM) A(NXM*NYM*NZM*4,NXM*NYM*NZM*4) ,D(NXM*NYM*NZM*4) STPD(0:6,NZM) ,STPW(0:6,NZM)\nSTPO \u2014> Somatorio de Trans. X Pot. do Oleo SDEOPKO: 6 ,NZM) ,SDEWPI(0:6 ,NZM) ,SDEOSI(O:6 ,NZM) , SDEWSI(O:6,NZM)\nSDEOP\u2014> Som. da Derivada da Eq. do Oleo em rel. a Pres.\n>\nf\na\ns\nC INTERFACES I=NXR\nC----------------,------------------------------\nIF(IND.EQ.1) THEN\nbloca abaixa do poco cartesiano: i=ip j=jp~1 k=kc , radial: i j k\nIF(J.GT.NQS+2 *NQL.AND.JP.NE.1) THEN NCC=(IP-1)*NYC*NZC+(JP-2)*NZC+(KP+K-1) NLO2+NCC-1\nNCR=NBC+(I-1)*NYR*NZR+(J-l)*NZR+K NLR=2*NCR-1\ncartesiano com radial dFw/dPoi,j+l,k\nA(NLC3NLR)=DFWPX dFs/dSwijj+l,k\nA(NLC3NLR+1)=DFWSX dFo/dPoi,j+l,k\nA(NLC+1,NLR)=DFOPX dFo/dSwi,j+l3k\nA(NLC+1 ,NLR+1)!SDFDSX\nENDIF\nooao non no\tnoon o o o oo\to o nn\nbloco a esquerda do poco\ncartesiano: i=ip-l j-jp k=kc , radial: i j k\nIF(J.GT.NQL+NQS.AND.J.LE.NQS+2*NQL.AND.IP.NE.1) THEN\nNCC=(IP-2)*NYC*NZC+(JP~D*NZC+(KP+K-1)\nNLC=2*NCC-1\nNCR=NBC+(1\u20191)*NYR*NZR+(J-l)*NZR+K\nNLR=2*NCR-1\ncartesiano com radial dFw/dPoi+l,j,k\nA\u00cdNLCjNLR\u00cd^DFWPX dFw/dSwi+1,j,k\nA(NLC,NLR+1)=DFWSX dFo/dPoi+1,j,k\nA(NLC+1JNLR)=DFQPX dFo/dSwi+1jj,k\nA(NLC+1,NLR+1)=DFOSX\nENDIF\nbloco acima do poco\ncartesiano: i=ip j=jp+l k~kc , radial: i j k\nIF(J.GT.NQL,AND.J.LE.NQL+NQS.AND,JP.NE,NYC) THEN NCC-(IP-1)*NYC*NZC+JP+NZC+(KP+K-1)-NBP NLC=2*NCC-1\nNCR=NBC+(I-1)*NYR*NZR+(J-l)*NZR+K NLR=2*NCR-1\nC cartesiano com radial\nC dFw/dPoi,j-l.k\nA(NLC,NLR)=DFWPX\nC dFw/dSwijj-ljk\na(nlc,nlr+d\u00bbdfwsx\nC dFo/dPoi,j-lfk\nACNLC+lfNLR)=DFOPX\nC dFo/dSwijj-ljk\nA(NLC+1,NLR+1)=DFOSX\nENDIF\nao a a a na\tr\u00a1 o naaaa o o a aoo m o o n ao\to a o\nbloco a direita do poco\ncartesiano: i=ip+l j-jp k=kc , radial: i j k\nIF(J.LE.NQL.AND.IP.NE.NXC) THEN\nNCC=IP*NYC*NZC+(JP~1)*NZC+(KP+K-1)-NBP\nNLC=2*NCC\u201c1\nNCR=NBC+(I-1)*NYR*NZR+(J-1)*NZR+K\nNLR=2*NCR~\u00cd\ncartesiano com radial dFw/dPoi-1,j,k\nA(NLC1NLR)=DFWPX\ndFw/dSwi-l.j,k\nA(NLC,NLR+1)=DFWSX dFo/dPoi-l,j,k\nA(NLC+1,NLR)=DFOPX dFo/dSwi-ijj,k\nA(NLC+1,NLR+1)=DFOSX\nENDIF\nradial com cartesiano para qualquer posicao do cartesiano vizinho\ndFw/dPoi+1,j,k\nA(NLR,NLC)~P0TWX2*TWX2PP+TWX(1+1,JtK,L)*PWX2PP dFs/dSwi+lJ.k\nA(NLR1NLC+l)=P0TWX2*TWX2SP(ItJ,K,L)-\n*\tTWX(I+1,J,K,L)*DPC(IX,JX,KP,2)\ndFo/dPoi+1, j,k\nA(NLR+1,NLC)=POTOX2*TOX2PP+TOX(1+1,J,K,L)*P0X2PP dFo/dSwi+lj ,k\nA(NLR+1,NLC+1)-P0TDX2*T0X2SP(I,J,K,L) ENDIF\n\"interfaces\" \u201ck=i~e~\u00d1xr\nbloco anterior ao poco\ncartesiano: i-ip j=jp k=kp-l , radial: i j 1 IFCIND.EQ.2) TREN\nNCC=(IP-l)*NYC*NZC+(JP-1)*NZC+KP-1 NLC=2*NCC-1\nDO 10 M=1,NXR\nDO 10 N=1,NYR NCR=NBC+(M-1)*NYR*NZR+(N-l)*NZR+K\nNLR=2*NCR-1\ncartesiano com radial\ndFw/dPoi,j ,k+l\nA(NLC, NLR)=DFWPZ\ndFw/dSwi >j ,k+l\nA(NLC,NLR+1)=DFWSZ\ndFo/dPoi,j ,k+l\nA(NLC+1,NLR)=DF0PZ\ndFo/dSwi,j ,k+l\nA(NLC+1,NLR+1)=DFOSZ\nradial com cartesiano dFw/dPoi,j ,k-l\nA(NLR,NLC)=-POTWZ1*TWZ1PA-TWZ(I,J,K,L)*PWZ1PA\nC dFw/dSwi,j ,k-l\nA(NLRtNLC+l)=\u201cPOTWZl*TWZlSA(I,J,K,L)-TWZ(I,J,K ,L) *\n*\tDPC(IP,JP,KP-1,2)\nC dFc/dPoi\u00bbj,k-l A(NLR+1,NLC)\u00ab-POTOZ1*TOZ1PA-TOZ(I,J,K,L)*POZ1PA\nC dFo/dSwi\u00bbj,k-l\nA(NLR+i,NLG+l)=-POTOZl*TOZlSA(IfJ,KfL)\n10 CONTINUE\nENDIF\nbloco posterior ao poco cartesiano: i=ip j=jp k=kp+nbp , radial: i j nzr\nnon\t\u00ab oQono\to o o rao non no\toooo\nIF(IND.EQ.3) THEN ncc=(ip-i)*nyc*nzc+(jp-i)*nzc+kp NLC~2*NCC-1\nDO 11 M-1,NXR\nDO 11 N=i}NYR\nNCR=NBC+(M-1)*NYR*NZR+(N-1)*NZR+K NLR=2*NCR~1\ncartesiano com radial dFw/dPoi,j,k\"l\nA(NLC,NLR)-DFWPZ\ndFw/dSwi,j,k-l\nA(NLC,NLR+1)=DFWSZ\ndFo/dPoi,j,k-l\nA(NLC+1,NLR)SSDFOPZ\ndFo/dSwi.j,k-l\nAiNLC+l.NLR+D^DFOSZ\nradial com cartesiano dFw/dPoi,j,k+l\nA(NLR,NLC)=P0TWZ2*TWZ2PP+TWZ(IIJJNZR+liL)*PWZ2PP dFw/dSwi,j,k+l\nA(NLR,NLC+l)=P0TWZ2*TWZ2SP(I,J,NZR,L)-\n*\tTWZ(I,J,NZR+1,L)*DPC(IP,JP,KP+NBP,2)\ndFo/dPoi3j,k+l\nA(NLR+1,NLC)=P0T0Z2*T0Z2PP+T0Z(I,J,NZR+1,L)*P0Z2PP dFo/dSwi tj,k+l\nA(NLR+1,NLC+l)=P0T0Z2*T0Z2SP(I,J,NZR,L)\n.1 CONTINUE\nENDIF\nRETURN\nEND\nSOLUCAO DO SISTEMA USANDO METODO DIRETO COM GAUSS\nSUBROUTINE S0LVE1\nIMPLICIT DOUBLE PRECISION(A-H,O-Z)\nPARAMETER(NXM=08,NYM=055NZM=04)\nCOMMON/NCEL/DBDX,DBDY,DBDZ,WRC,NBLDC,NXC,NYC,NZC,NBP,\n*\tNXR,NYR,NZR,NQL,NQS,NQI,IP,JP,KP\nCDMMON/SEQS/XR,XC\nCOMMON/NBLC/A,D,NBC,NBR,NBT\nDIMENSION XR(NXM*NYM*NZM*2),XC(NXM*NYM*NZM*2)\nDIMENSION A(NXM*NYM*NZM*4,NXM*NYM*NZM*4),D(NXM*NYM*NZM*4)\ncalculo do n. de incognitas (N)\nNR~NXR*NYR*NZR*2\naonna q\tqqo\tono\tnon n\tnanan ono\nNC=NXC*NYC*NZC*2-NBP*2\nentra com A,D,NR e NC e sai com XR e XC\nCALL GAUSS1(NR,NC)\nRETURN\nEND\nSOLUCAO DA MATRIZ USANDO 0 METODO DE ELIMINACAO DE GAUSS\nSUBROUTINE GAUSSi (NR,NC)\nIMPLICIT DOUBLE PRECISION(A-H,O-Z)\nPARAMETER(NXM=08,NYM=05,NZM=04)\nCOMMON/SEQS/XR,XC\nCOMMON/NBLC/A,D,NBC,NBR,NBT\nDIMENSION XR(NXM*NYM*NZM*2),XC(NXM*NYM*NZM*2),X(NXM*NYM*NZM*4)\nDIMENSION A(NXM*NYM*NZM*4,NXM*NYM*NZM*4),D(NXM*NYM*NZM*4)\nN=NC+NR\nTRIANGULARIZACAO\nDO\n650 K=1,N-1\nDO 640 I\u00aeK+i,N FATOR=A(I,K)/A(K,K) D(I)=D(I)-FATQR*D(K) A(IfK)=O.ODO DO 630 J=K+1,N\nA(I,J)-A(I,J)\u201cFATDR*A(K,J) CONTINUE\nCONTINUE CONTINUE\nSUBSTITUI\u00c7\u00c3O REGRESSIVA\nX(N)=D(N)/A(N,N)\nDO 670 I=N-1,1,~1 S0M=0.0D0\nDO 660 J=N,I+1,\u201c1 SOM\u00abSOM+A(X,J)*X(J)\nCONTINUE x\tK\nX(I)=(D(I)-SOM)/A(I,I)\nCONTINUE\nSEPARACAO DO VETOR SOLUCAO EM DOIS VETORES\n10\n20\nDO 10 1=1,NC XC(I)=X(I)\nCONTINUE\nD0~20 I=NC+1,NR+NC\nIC=IC+1\nXR(IC)=X(I)\nCONTINUE\nRETURN END\nPARAMETER(NXM=08,NYM=05,NZM=04,MAX=1500)\nCOMMON/NCEL/DBDX,DBDY,DBDZ,WRC,NBLOC,NXC,NYC,NZC,NBP,\n*\tNXRjNYRjNZR^QL.NQS.NQIjIP, JP,KP\nCOMMGN/SEQS/XR,XC\nCOMMON/NBLC/AA,B,NBC,NBR, NBT\nDIMENSION XR(NXM*NYM*NZM*2),XC(NXM*NYM*NZM*2)\nDIMENSION AA(NXM*NYM*NZM*4,NXM*NYM*NZM*4),B(NXM*NYM*NZM*4)\nINTEGER R(NXM*NYM*NZM*4),C(NXM*NYM*NZM*4)\nINTEGER ITEMP(8*NXM*NYM*NZM+MAX+2),RTEMP(4*NXM*NYM*NZM+MAX)\nDIMENSION A(NXM*NXM*NYM*NYM*NZM*NZM*2)\nDIMENSION X(NXM*NYM*NZM*4)\nDIMENSION IA(NXM*NYM*NZM*4+1)}JA(NXM*NYM*NZM*4),IC(NXM*NYM*NZM*4)\nona n\tano n oo\ncalculo do n. de incognitas (N)\t\nNR=NXR*NYR*NZR*2 NC=NXC*NYC*NZC*2-NBP*2 N=NC+NR\t\nMONTAGEM DOS VETORES PARA A\tNSPIV\nINI=O 11=0 IFIRST=O ILAST=O LOC=1 DO 20\nDO\n15\n20\n26\n1=1,N\n15 1=1,N\nIF(AA(I,J).NE.O.ODOOO) THEN\n11=11+1\nA(H)=AA(I,J) JA(II)=J IF(INI.Eq.0) THEN IA(1)=J INI=1\nENDIF\nENDIF\nCONTINUE\nILAST=II\nLOC=LOC+1\nIA(LOC)=IA(LOC-1)+ILAST-IFIRST\nIFIRST=II\nCONTINUE\nDO 26 1=1,N\nR(I)=I C(I)=I\nIC(I)=I CONTINUE\nCALL NSPIVfN,IA,JA,A,B,MAX,R,C,IC,X,ITEMP,RTEMP,IERR)\nSEPARACAO DO VETOR SOLUCAO EM DOIS VETORES\nDO 30 1=1,NC\nXC(I)=X(I)\n30\n40 C\nCONTINUE\nIK^O\nDO 40 I=NC+1,NR+NC\nIK=IK+1\nXR(IK)=X(I) CONTINUE\nRETURN END\nQoooaa nanoon a can o an a oo ooo no no a o a na non oaaa a ana na na na nana ano anana\nSubrotina NSPIV\nUsa a eliminacao Gaussiana dispersa com interc\u00e2mbio de coluna para resolver um sistema linear do tipo (A* X= B). A fase eliminacao realiza operacoes nas linhas de ,A> e para obter uma matriz triangular superior \u2019U' e um vetor\tA fase solu -\ncao resolve (U * X = Y)\nArgumentos de entrada :\nN - numero de equa\u00e7\u00f5es e inc\u00f3gnitas\nIA - vetor de (N \u2666 1) entradas contendo indicadores de linha para \u2019A^ veja descricao do armazenamento da matriz abaixo )\nJA - vetar com uma entrada por elemento nao-zero em >A> contendo os numeros das colunas de elementos nao-zero de >A>\nA\t~ vetor real com uma entrada por elemento nao-zero em JA\u2019\ncontendo os verdadeiros elementos nao-zero ( veja des -cricao do armazenamento de matriz abaixo)\nB\t- vetor real com N entradas contendo os dados do la -\ndo direito\nMAX - numero inteiro especificando o numero m\u00e1ximo de entra -das de \"diagonais extras com elementos nao-zero\" de \u2019U' que devem ser armazenadas\nR\t- vetor inteiro com N entradas especificando a ordem\ndas linhas de 'A'\nC\t- vetor inteiro com N entradas especificando a ordem\ndas colunas de ,AJ.,C) e tamb\u00e9m um argumento de saida\nIC - vetor inteiro de N entradas que e o inverso de ' CJ (i.e., IC(C(I)) = I ). IC e tamb\u00e9m um argumento de saida\nITEMP - vetor inteiro de (2 * N + MAX + 2) entradas para uso interno\nRTEMP - vetor inteiro de (N + MAX) entradas para uso interno\nArgumentos de saida :\nc\t- vetor inteiro de N entradas especificando a ordem das colunas de \u2019U\u2019. ,C> e tamb\u00e9m um argumento de en -\nIC\tt r ad a vetor inteiro de N entradas que e o inverso de 'CJ (i.e.f IC(C(I)) = I). IC e tamb\u00e9m um argumento de en-\nX IERR\t-\tvetor real de N entradas contendo o vetor solucao -\tnumero inteiro que indica a condicao de erro ou o numero de entradas de \"diagonais extras\" em \u2019U\u2019 ( para finalizacao bem-sucedida)\nOs valores de IERR sao:\n0 ,LT. IERR\tFinalizacao bem-sucedida. \u2019U\u2019 tem IERR entradas de \"diago -nais extras\" nao-zero.\nIERR = 0\tErro. N = 0\n-N.LE.IERR.LT.O\tErro. Linha numero IABS(IERR) de \u2019A' e nula.\nn non o no nnoaoa\tacto\t\u00abno\taoannnnonnnnnonnononnncnoaonnnnn\n-2*N.LE.IERR.LT.-N\nErro.Linha numero IABS(IERR + N) tem uma entrada duplicada,\n-3*N.LE.IERR.LT.-2*N\nErro.Linha numero IABS(IERR + 2*N) tem um pivo zero,\n-4*N.LE.IERR.LT.IERR.LT.3*N\nErro.Linha numero IABS(IERR + 3*N) excede a capacidade de armazenamento\nArmazenamento da matriz esparsa :\nA matriz esparsa \u2019A' e armazenada usando tres vetores \u2019IA', \u2019JA! e *A\u2019. 0 vetor >k> contem os elementos nao-zeros da matriz linha por linha, nao necessariamente em ordem crescente do numero de colunas. \u00d3 vetor \u2019JA* contem os numeros das colunas correspondentes aos elementos nao-zero armazenados no vetor JAJ(i.e., se o elemento nao-zero armazenado em ,A(K))) esta na coluna JJ\u2019 ent\u00e3o, \"JA(K) = ?)\u2022 0 vetor \u2019IA\u2019 contem indicadores para as li -nhas de indices de colunas nao-zero no vetor \u2019A/JA\u2019 (i.e., \u00cdA(IA(I))/JA(IA(I))1 e a primeira entrada para a linha JI' no vetor JA/JA'). \u2019IA(N + 1)\u2019 e considerado tal que JIA(N+1)=IA(I)' = numero de nao-zeros em 'A\u2019.\nSUBROUTINE NSPIV(N,IA,JA,A,B,MAX,R,C,IC,X,ITEMP,RTEMP,IERR)\nIMPLICIT DOUBLE PRECISION(A-H,O-Z)\nDIMENSION A(l), B(l), X(l), RTEMP(l)\nINTEGER IA(i), JA(1) , R(l), C(l), IC(1) , ITEMP(l) INTEGER IU, JU, U, Y, P\nColoca indices para dividir o armazenamento temporario por NSPIVI\nY \u00ae 1\nU = Y + N\nP \u00ab 1\nChama a subrotina NSPIVI para realizar os c\u00e1lculos\nCALL NSPIVI(N,IA,JA,A,B,MAX,R,C,IC,X,RTEMP(Y),ITEMP(P),\n+\tITEMP(IU),ITEMP(JU),RTEMP(U),IERR)\nRETURN\nEND\nSubrotina NSPIVI\nNSPIVI usa a eliminacao Gaussiana com troca de colunas para resolver o sistema linear * A* X= B\u2019.A fase eliminacao realiza . operacoes em >AJ e em \u2019B\u2019 para obter uma unidade de matriz triangular superior JU' e um vetor 'Y* . A fase solucao resolve JU * X = Y\u2019.\nC\tres atualizados do lado direito\nCP\t-\tVetor inteiro de \u2019N+i\u2019 entradas usado por urna lista\nC\tde conex\u00e3o. \u2019P(N+1)\u2019 e o primeiro da lista, e a entra-\nC\tda seguinte \u2019P(K)' e em \u2019P(P(K))'. Entao \u2019P(N+1)\u2019 e o\nC\tprimeiro item dado, \u2019P(P(N+1))\u2019 e o segundo, etc. Um\nC\tindicador de \u2019N+l\u2019 marca o fim da lista\nC IU - vetor inteiro de \u2019N+l' entradas usado como indicador\nC\tde linhas para *U\u2019\nC JU\tvetor inteiro de \u2019MAX\u2019 entradas usados para as colunas de\nC\telementos nao-zero no triangulo estritamente superior de\nC\t'U'\nCU - vetor real de \u2019MAX\u2019 entradas usados para os elementos nao-C\tzero no triangulo estritamente superior de \u2019U'\nC\nC\nC Armazenamento da matriz esparsa:\nC\nC\tA matriz esparsa \u2019A\u2019e armazenada usando tres vetore 'IA\u2019, \u2019JA'\nC e 'A'.O vetor \u2019A\u2019 contem os elementos nao-zero da matriz linha por C linha, nao necessarimente em ordem crescente de numeros de colunas.\nC 0 vetor \u2019JA\u2019 contem os numeros das colunas correspondentes aos ele-C mentos nao-zero armazenados no vetor \u2019A' (i.e., se o elemento nao-C zero armazenado em \u2019A(K)\u2019 esta na coluna 'J\u2019, entao 'JA(K) = J'. 0 C vetor \u2019IA\u2019 contem indicadores para as linhas de indices de coluna C \u2019nao-zero\u2019 no vetor \u2019A/JA\u2019 (i.e., \u2019A(IA(I))/JA(IA(I)) e a primeira C para a linha \u2019I\u2019 no vetor 'A/JA'). \u2019IA(N+1)=IA(I)\u2019 - numero de C elementos nao-zero em \u2019A\u2019, \u2019IU\u2019,'JU\u2019 e \u2019U\u2019 sao usado de maneira si-C milar para armazenar o triangulo estritamente superior de \u2019U\u2019, exce-C to que 'J(U)\u2019 contem na verdade \u2019C(J)\u2019 ao inves de \u2019J\u2019.\nC C C\nSUBROUTINE NSPIVI(N,IA,JA,A,B,MAX,R,C,IC,X,Y,P,IU,JU,U,IERR) IMPLICIT DOUBLE PRECISION(A-H,O-Z)\nDIMENSION A(l), B(l), U(l), X(l), Y(l)\nREAL*8 DK, LKI, ONE, XPV, XPVMAX, YK, ZERO INTEGERC(l), IA(1), IC(1), IU(1), JA(1), JU(1), P(l), R(l) INTEGER CK, PK, PPK, PV, V, VI, VJ, VK\nC\nC\nIF(N ,EQ. 0) G0 TO 1001\nC\nONE = 1.\nZERO = 0.0D0\nC\nC Inicializa o trabalho de armazenamento e indicadores para 'JU'\nC\tDO 10 J=1,N\nX(J) = 0.0D0\n10\tCONTINUE\nIU(1) = 1 JUPTR = 0\n\u00e7\nC Realiza fatorizacao num\u00e9rica e simb\u00f3lica linha por linha\nC \u2019VK(VI,VJ)' e o v\u00e9rtice do grafico para a linha 'K-th' de 'U'\nC C\nC Inicia lista de conex\u00e3o e armazenamento livre para esta linha\nC a linha \u2019R(K)-th' de \u2019A\u2019 torna-se a linha \u2019K-th\u2019 de \u2019U\u2019\nC\nDO 170 K = 1,N\nC\nC c\nc c\nP(N+1) - N + 1\nVK = R(K)\nEstabelece a linha adjacente para \u2018VK\u2019, ordenado na ordem corrente das colunas de . 0 indice do laco diminui para explorar qualquer coluna de \u2019A* numa ordem relativa correta\n20\nC\nC c\nc\n30\nJMIN = IA(VK)\nJMAX ~ IA(VK+1) - 1\nIF(JMIN .GT. JMAX) G0 T0 1002\n1 \u00ab JMAX JAJ = JA(J) VJ - IC(JAJ)\nArmazena \u2019A\u00cdKjJ)\u2019 no vetor de trabalho\nX(VJ) = A(J)\nEste codigo insere JVJ' na lista adjacente de *VK\u2019\n40\nPPK = P(PK)\nIF(PPK - VJ) 30,1003,40\nP(VJ) * PPK\nP(PK) = VJ\nJ = J - 1\nIF(J .GE. JMIN) GO T0 20\n0 codigo seguinte calcula a 'K-th? linha de \u2019UJ\nC\nC\nc\nso\nc\nc\n0\nc\nc\nVI\t= N + 1\nYK = B(VK)\nVI = P(VI)\nIF(VI .GE. K) G0 T0 110\n>VI .LT. VKJ \u2014 processa o elemento L(K,I) e margeia a adjac\u00eancia de \u2019VI\u2019 com a adjcencia ordenada de *VK?\nLKI - - X(VI)\nX(VI) = ZERO\nAjusta o lado direito para refletir a eliminacao\nc\nc c\nc c c c\nYK = YK + LKI * Y(VI)\nPPK = VI\nJMIN = IU(VI)\nJMAX = IUCVI+1) - 1\nIF\u00cdJMIN .GT. JMAX) G0 T0 50\nDO 100 J=JMIN,JMAX\nJUJ = JU(J)\nVJ = IC(JUJ)\nSe WJ\u2019 ja esta na adjac\u00eancia de \u2019VK', pule a inser\u00e7\u00e3o\nIF(X(VJ) .NE. ZERO) G0 T0 90\nInserte \u2019VJ* na lista adjacente de \u2019VK*\n\"reset\" 'PPK1 to \u2019VI\u2019 se nos tivermos passado o ponto de inser\u00e7\u00e3o correto. (Isto acontece quando a adjac\u00eancia de \u2019VI1 nao esta na ordem corrente da coluna devido ao pivoteamento)\n80\nPPK = P(PK)\nIF(PPK - VJ) 70,90,80\nP(VJ) = PPK\nP(PK) ~ VJ\nPPK \u00bb VJ\nCalcula }L(K,J) \u00ae L(K,I)*U(I,J)1 para \u2019L(K,I)\u2019 nao-zero, compute JU*(K,J) - U*(K,J) - L(K,I) * U(I,J)\u2019 para \u2019U(K,J)> nao - zero '(U*(K,J) \u00ab U(K,J) * D(K,K))\u2019\nX(VJ) = X(VJ) + LKI * U(J) CONTINUE T0 50\n- troca a\nc\nC ' c\nc c 90 100\nC\nc :\nC ! c\nc : c 110\nGO\nPivo\t------\nda diagonal\nEncontra a maior\nmaior entrada da 'K-th\u00ed linha de 'U' com a entrada\nentrada, contando as diagonais extras nao-zero\n120\nGO TO 1004\nIF(VI ,GT. N)\nXPVMAX \u00ab DABS(X(VI))\nMAXC = VI\nNZCNT = 0\nPV = VI\nV = PV\nPV = P(PV)\nIF(PV&lt;GT. N) G0 T0 130\nNZCNT = NZCNT + 1\nXPV \u00ab DAES(X(PV))\nIF(XPV ,LE. XPVMAX) GO TO 120\nXPVMAX = XPV\nMAXC = PV\nMAXCL \u00ab V\nGO TO 120\nIF(XPVMAX .EQ. ZERO) GO TO 1004\nJVI=K\u2019, ent\u00e3o existe uma entrada para diagonal que deve ser dele-\n130 c c\nc \u25a0 c\nVI =\n140\nC\nC Calcula\nC\n150\nDK =\nC\nC\nC\nc c c\nSe\t.\ntada. Senao delete a entrada que ira ser a entrada da diagonal.\nIF(VI .EQ. K) GO TO 140\nIF(VI .Eq. MAXC) G0 T0 140 P(MAXCL) = P(MAXC)\nG0 T0 150\nP(VI)\n>D(K) = 1/L(K,K) \u2019 e faz a troca\nONE / X(MAXC)\nX(MAXC) \u00ab X(K)\nI = C(K)\nC(K) = C(MAXC)\nC(MAXC) \u00bb I\nCK \u00ab C(K)\nIC(CK) = K\nIC(I) = MAXC\nX(K) = ZERO\nAtualiza lado direito\nY(K) = YK * DK\nc c c c c\n160\nIF(IU(K+1) -GT. MAX+1) GO TO 1005\nIF(VI .GT. N) G0 T0 170\nJ = VI\ni JUPTR = JUPTR + 1 JU(JUPTR) = C(J) U(JUPTR) = X(J) * DK X(J) = ZERD J = P(J)\nIF(J .LE. N) GO TO 160\ni CONTINUE\nVolta e resolve 'U*X= Y' e reordena \u2019X\u2019 ao correspondente com ,k>\n170\nC\nC ' c\nK = N\nDQ \"\n180\n190\n200\n0\nc :\nc\n200 I = 1,N YK = Y(K) JMIN = IU(K)\nIMAX = IU(K+1) ~ 1\nIF(JMIN -GT, JMAX) GO TO 190 DO 180 J \u201c JMIN,IMAX\nJUJ = JU(J)\nJUJ - IC(JUJ)\nYK = YK - U(J) * Y(JUJ) CONTINUE Y(K) = YK CK = C(K) X(CK) \u00ab YK\nK \u201c K \"\" 1\nCONTINUE\nRetorne com \u2019IERR' = numero de diagonais extras de nao-zeros em 'U'\nIERR = IU(N+1) - IU(I) RETURN\nRetorno dos erros\nC\nC\nC\nC\nC\n1001\tIERR = RETURN\nC\nC Linha >KJ\nC\n1002\tIERR = RETURN\nC\nC Linha \u2019 K\u2019\nC\n1003\tIERR = RETURN\nC\nC Pivo zero\nC\n1004\tIERR ~ RETURN\nde )A) e nula\n-K\nde \u2019A\u2019 tem entrada duplicada\n~(N+K)\nna linha \u2019K\u2019\n-(2\n* N + K)\nC\nC Armazenamento C\n1005 IERR = -(3 RETURN END\nde *UJ excedido na linha 'KJ\n* N + K)\nN = O\n0\nnao\tano\tana o an aaaannnQnn\to\taa nao\nSOLUCAO DO SISTEMA USANDO METODO ITERATIVO BSOR COM GAUSS\nSUBROUTINE SOLVES\nIMPLICIT DOUBLE PRECISION(A-H,0-Z)\nPARAMETER(NXM=08,NYM-05,NZM=O4)\nCOMMON/NCEL/DBDX,DBDY ,DBDZ,WRC,NBLOC,NXC,NYC,NZC ,NBP,\n*\tNXR,NYR,NZR,NQL,NQS,NQI,IP,JP,KP\nCOMMON/SIM/DT, DTMAX , DTMIN, TOLP, TOLS, DSLIM, DPLIM, TSIM,\n*\tQOMAX,QDMIN,PWMIN,BSOR,JPROD,MSOLU,UMAX,ITMIN\nCOMMON/SEQS/XR,XC\nCOMMON/NBLC/A,D tNBC,NBR,NBT\nDIMENSION XR(NXM*NYM*NZM*2),XC(NXM*NYM*NZM*2)\nDIMENSION A(NXM*NYM*NZM*4,NXM*NYM*NZM*4),D(NXM*NYM*NZM*4)\nDIMENSION ACG(NXM*NYM*NZM*2,NXM*NYM*NZM*2)\nDIMENSION ARG(NXM*NYM*NZM*2,NXM*NYM*NZM*2)\nDIMENSION DRA(NXM*NYM*NZM*2),DCA(NXM*NYM*NZM*2)\nDIMENSION DR(NXM*NYM*NZM*2),DC(NXM*NYM*NZM*2)\nDIMENSION XRA(NXM*NYM*NZM*2),XCA(NXM*NYM*NZM*2)\nLOGICAL CONV\njacobiana total (A) e o vetor (D) termo indep.\nda da\ntransforma transforma\nfaz: parte parte\nmatriz A ref. matriz A ref.\nentra com a matriz para o GAUSS, a a\ntransforma\ta\tparte\tdo\tvetor\tD\tref.\tao\ntransforma\ta\tparte\tdo\tvetor\tD\tref.\tao\ntransforma\ta\tparte\tdo\tvetor\tX\tr\u00e9f.\tao\ntransforma\ta\tparte\tdo\tvetor\tX\tref.\tao\nao radial, na matriz ARG ao cartesiano, na matriz ACG\n>\tradial, no vetor DRA\n>\tcartesiano, no vetor DCA \u00ed radial, no vetor XRA\n>\tcartesiano, no vetor XCA a solucao e representada pelos vetores XR e XC\ncalculo do n. de incognitas (N) e largura da banda (M)\nNR=NXR*NYR*NZR*2\nNC=NXC*NYC*NZC*2-NBP*2\ntrans\u00edormacao do vetor X em dois vetores\n1\n2\nDO 1 1=1,NR\nXRA(I)=O.ODO CONTINUE DO 2 1=1,NC\nXCA(I)=O.ODO\nCONTINUE\ntrans\u00edormacao do vetor D em dois vetores\nDO 5 I=1,NBC*2 DCA(I)=D(I)\n5\tCONTINUE\nIC=Q\nDO 6 I=(NBC*2+1),NBT*2 IC=IC+1 DRA(IC)=D(I)\n6\tCONTINUE\nACG(I,J)=A(I,J)\nCONTINUE\nra oo anoa\t\u00abnan noao\nLX=O\nDO 20 I=NC+1,NC+NR LX=LX+1 LY=O\nDO 20 J=NC+1,NC+NR LY=LY+1 ARG(LX,LY)=A(I,J) 20 CONTINUE\n__PONTO DE RETORNO DO PROCESSO ITERATIVO iter=0\n1000 CONTINUE\niter=\u00edter+l\nmontagem do termo independente\n2\nIF(L.EQ.l) THEN\nLIX=NC+1\nEND IF\nIC=0\nDO 40 I~LIX,LSX\nAUX=O.0D0\nID=0\nD0 50 J=LIY,LSY\nID=ID+1\nIF(L.EQ.1) AUX=AUX+A(I,J)*XCA(ID) IF0..EQ.2) AUX=AUX+A(I, J)*XR(ID) CONTINUE\nIC=IC+1\nIF(L.EQ.l) DR(IC)=DRA(IC)-AUX IF\u00cdL.EQ.2) DC(IC)=DCA(IC)-AUX CONTINUE\nTF\u00edT F(3 THEN\nCALLGAUSS2 (NR,ARG,DR,XR) DO 70 K~1,NR\nXR(K)=BSOR*XR(K)+(1.0D0-BS0R)*XRA(K) write(*,*) \u2019 i=\u2019 ,k, \u2019 xr^Sxr\u00edk) write(*,*)\u2019i=\u2019,k,> xra~xr=i,xra(k)~xr(k)\n80\n60\nCALL GAUSS2 (NC,ACG,DCfXC)\nDO 80 K=1,NC\nXC(K)=BSOR*XC(K)+(1.ODO-BSOR)*XCA(K) write(*,*) Ji=' ,k, \u2019 xc^xc\u00edk) write(*,*),i=\u2019,k,\u2019 xca-xc=*,xca(k)-xc(k)\nCONTINUE ENDIF CONTINUE\nteste do convergencia\nC0NV=.TRUE.\nOO\u00fc\tO\t\u00dcUUUQ\tO O\u00dcU\t\u00dcUO\tU CJU\u00dc\u00dc\n110\n120\nDO \u00cdIQ 1*1,NR\nIF(DABS(XR(I)-XRA(I)).GT.1.0D-9) conv=.false. CONTINUE\nDO 120 1*1,NC\nIF(DABS(XC(I)-XCA(I)).GT.1.OD-9) CONV=.FALSE. CONTINUE\natualizacao dos resultadas\nDO 90 1*1,NR XRA(I)*XR(I) 90 CONTINUE\nDO 100 1*1,NC XCA(I)=XC(I) 100 CONTINUE\nIF(.NOT.CONV) GO TO 1000\nwrite(*,*)'bsor-;,bsor,\u2019 convergiu iter*\u2019, iter RETURN\nEND\nSOLUCAO DA MATRIZ USANDO 0 METODO DE ELIMINACAO DE GAUSS\nSUBROUTINE GAUSS2 (N,A,D,X)\nIMPLICIT DOUBLE PRECISION(A-H,O~Z)\nPARAMETER(NXM=08,NYM=05,NZM=04)\nDIMENSION A(NXM*NYM*NZM*2,NXM*NYM*NZM*2),D(NXM*NYM*NZM*2),\n*\tX(NXM*NYM*NZM*2)\nTRIANGULARIZACAO\nDO 650 K*1,N-1\nDO 640 I=K+1,N\nFATOR=A(I,K)/A(K,K)\nD(I)*D(I)-FATOR*D(K)\nA(I,K)=0.0D0 DO 630 J=K+1,N\nA(I,J)*A(I,J)-FATOR*A(K,\n630\tCONTINUE\n640\tCONTINUE\n650 CONTINUE\nSUBSTITUI\u00c7\u00c3O REGRESSIVA\nX(N)*D(N)/A(N,N)\nDO 670 I=N-1,1,-1\nSOM=O.ODO\nDO 660 J=N,I+1,~1 SOM=SOM+A(I,J)*X(J) 660\tCONTINUE\nX(I)*(D(I)-SOM)/A(I,I)\n670 CONTINUE\nRETURN END\nJ)\nSUBROT. DE CALCULO DE PRODUCOES DE OLEO E GAS POR BALAN\u00c7O DE MATERIAIS\nSUBROUTINE BALM\n*\tBNPC,BWPC,PWFA\nCOMMON/NCEL/DBDX,DBDY,DBDZ,WRC,NBLOC,NXC,NYC,NZC,NBP,\n*\tNXR,NYR,NZR,NQL,NQS,NQI,IP,JP,KP\nCOMMON/MALHA/ZB,RB,VPOR,DRO,WX,WY,WZ,FFX,FFY,FFZ,DTETA\nCOMMON/PVT/BO,DBO,VO,DVO,DO ,DDO,RSO,DRSO,BW ,DBW,VW,DVW,DW,DDW, CW COMMON/TS/PO,SO,SG,SW\nCOMMON/TF/TFLUXO,TFLUXW,SUMTO,SUMTW,AFXO,AFXW\nDIMENSION ZB(0:NXM+1,NYM,2),RB(NXM+1),VPOR(NXM,NYM,NZM,2),\n*\tFFX(NXM+1,NYM,NZM,2),FFY(NXM+1,NYM,NZMt2),\n*\tFFZ(NXM+1,NYM ,NZM+1,2),DTETA(NYM+1)\nDIMENSION BO(NXM,NYM,NZM,2),DBO(O:NXM+1,0:NYM+1,0:NZM+1,2) ,\n*\tV0(NXM,NYM,NZM,2),DVO(O:NXM+1,O:NYM+1,0:NZM+1,2),\n*\tDO(NXM,NYM,NZM,2),DDO(0:NXM+1,0:NYM+1,0:N2M+1,2),\n*\tBW(NXM,NYM,NZM,2),DBW(O:NXM+1,0:NYM+i,0:NZM+1,2) ,\n*\tVW(NXM,NYM,NZM,2),DVW(O:NXM+1,O:NYK+1,0:NZM+1,2),\n*\tDW(NXM,NYM,NZM,2),DDW(O:NXM+1,Q:NYM+1,0:NZM+1,2),\n*\tCW(NXM,NYM,NZM,2)\nDIMENSION PO(0:NXM+1,0:NYM+1,0:NZM+1,2),SO(NXM,NYM,NZM,2),\n*\tSG(NXM,NYM,NZM,2),SW(NXM,NYM,NZM,2)\n4\n5\n10 C\nDO 10 L=l,2\nIF(L.EQ.l) THEN\nBNPR=O,ODO\nBWPR=O.ODO\nDO 4 J=1,NYR\nDO 4 1=1,NXR\nDO 4 K=1,NZR\nBNPR=BNPR+VPOR(I,J,K,L)*SO(I,J,K,L)*BO(I,J,K,L)\nBWPR=BWPR+VPOR(I,J,K,L)*SW(I,J,K,L)*BW(I,J,K,L) CONTINUE\nBNPOO. ODO\nBWPOO.ODO\nDO 5 J=1,NYC\nDO 5 1=1,NXC\nDO 5 K=1,NZC\nIF(I.EQ.IP.AND,J.Eq.JP,AND.K.GE.KP.AND.K.LT.KP+NBP) GO TO 5\nBNPC=BNPC+VPOR(I,J,K,L)*SO(I,J,K,L)*BO(I,J,K,L)\nBWPC=BWPC+VPOR(I,J,K,L)*SW(I,J,K,L)*BW(I,J,K,L) CONTINUE\nEND IF\nCONTINUE\nOGOD\nRETURN END\nSUBBOTINA DE IMPRESS\u00c3O DE RESULTADOS PARA RELATORIO\nSUBROUTINE IMPRER(DT,NTS)\nIMPLICIT DOUBLE PRECISION(A-H.O-Z)\nPARAMETER(NXM=08,NYM=05,NZM=04)\nCOMMON/NCEL/DBDX,DBDY,DBDZ,WRC,NBLOC,NXC,NYC,NZC,NBP,\n*\tNXR,NYR,NZR,NQL,NQS,NQI,IP,JP,KP\nCOMMON/IMP/TIMPR,TIMPG,IRIMP\nCOMMON/ACUM/QOAC,QGAC,QWAC,VOORR,VWORR,VOORC,VWORC,BNPR,BWPR,\n*\tBNPC,BWPC,PWFA\nCOMMON/MALHA/ZB,RB,VPOR,DRO,WX,WY,WZ,FFX,FFY,FFZ,DTETA COMMON/TS/PO,SO,SG,SW\nCOMMON/VAZAO/QO,QOT,qG,QGT,qW,QWT,DqOP,DQOS,\nC\nC\n110\nC\n120\n*\tDQWP,DQWS,RW0,RG0,PWF.TEMPO\nDIMENSION P0(0:NXM+l,0:NYM+l,0:NZM+l,2),S0(NXM,NYM,NZM,2) ,\n*\tSG(NXM,NYM,NZM,2),SW(NXM,NYM,NZM,2)\nDIMENSION ZB(O:NXM+1,NYM,2),RB(NXM+1),VP0R(NXM,NYM,NZM,2),\n*\tFFX(NXM+1,NYM,NZM,2),FFY(NXM+1,NYM,NZM,2),\n*\tFFZ(NXM+1,NYM,NZM+1,2),DIETA(NYM+1)\nDIMENSION QO(NYM,NZM),\u00c7G(NYM,NZM),qw(NYM,NZM),DQOP(NYM,NZM),\n*\tDQOS(NYM,NZM),DQWP(NYM,NZM),DQWS(NYM,NZM) CHARACTER*8 TIT\n\u20ac1=86400.ODO\nC2\u00ab1.0D+6\nC3=C2/1000.0DO\nREC=QOAC/(VOORR+VOORC)*100.0\nPID=QOT*C1/((PO(NXC,JP,KP,2)-PWF)/98067.ODO)\nWRITE(4,110)NTS\nFORMAT(\u2019 \u2019,19,43(\u2019-\u2019),/,T2O,\u2019RESUMO DO TIME STEP\u2019,I3,/,T9,43(\u2019-\u2019))\nIF(QOAC.NE.0.ODO) BALO=(QOAC+(BNPR+BNPC))/(VOORR+VOORC)\nIF(QWAC.NE.0.ODO) BALW=(QWAC+(BWPR+BWPC))/(VWORR+VWORC) BALG=1.0D0\nWRITE(4,12O)TEMPO/C1,DT/C1,C1*QOT,\n*Cl*qGT,Cl*QWT,RGO,RW0,PWFA/C2,\n*Q0AC,QGAC,qWAC,BALO,BALG,BALW,REC,FID\nFORMAT(T10,\u2019Tempo\t(dia) \u2019,T31,\u2019!\t\u2019.F10.5,'\n1 \u2019 / iff\n*110,\u2019Dt\t(dia)\t\u2019,T31,\u2019i\t\u2019.F10.5,\u2019\t!\t\n*T10,\u2019Qo\t(m3/dia)\u2019,T31,\u2019!\t\u2019.D10.4,\u2019\t!\t\n*T10,\u2019Qg\t(m3/dia)\u2019,T31,\u2019!\t\u2019.D10.4,\u2019\t!\t\n*T10,\u2019Qw\t(m3/dia)\u2019,T31,\u2019!\t\u2019,D10.4,\u2019\t!\t\\/>\n*T1O,'RGO\t(m3/m3) \u2019,131,\u2019!\t\u2019.F10.4,\u2019\t!\t\n*T10,\u2019RW0\t(m3/m3) \u2019,T31,\u2019!\t\u2019,F10.4,\u2019\t!\t\u2019 J,\n*T10,\u2019Pwf\t(MPa)\t\u2019,T31,\u2019!\t\u2019,F10.4,\u2019\t!\t* J>\n*T10,\u2019Np\t(m3)\t\u2019,T31,\u2019!\t\u2019,D10.4,\u2019\t!\t1 7,\n*110,\u2019Gp\t(m3)\t\u2019,T31,\u2019!\t\u2019.D10.4,\u2019\t!\t7/,\n*T10,\u2019Wp\t(m3)\t\u2019,131,\u2019!\t\u2019,D10.4,\u2019\t!\t\u2018J,\n*T9,43(\u2019-\u2019),/\t,T9,\u2019Balanco de Materais\u2019,/,T9,43('-\t\t\n*T10,\u201901eo\t(\u2019/,)\t\u2019,131,\u2019!\t\u2019,010.4,\u2019\t!\t\n*T10,\u2019Gas\t(X)\t\u2019,T31,\u2019\u00bb\t\u2019,010.4,\u2019\t!\tJ7.\n*T10,\u2019Agua\tC\u2018Z)\t\u2019,T31,\u2019!\t\u2019,D10.4,\u2019\t!\t\u20197,\n*T9,43(\u2019-\u2019),/\t1\t\t\n*T10,\u2019Recup.\t(7.)\t\u2019,T31,\u2019!\t\u2019,F10,4,/,\t\n*T10,\u2019IP\t(m3/d/kg/cm2)\u2019,T31,\t\u2019!\t\u2019.F10.4,/,\t\n*T9,43(\u2019-\u2019))\t\t\t\no nn\nMapa de pressao e saturacao do grid cartesiano\nWRITE(4,400)\n400 F0RMAT(T22,\u2019Mapa de Pressao e Saturacao (Presao, So e Sw)\u2019) WRITE(4,100)\n100 F0RMAT(/,5X,\u2019GRID CARTESIANO\u2019)\nDO 410 K=1,NZC\nWRITE(4,420)K\n420 FORMAT(1X,\u2019Camada \u2019,I2,/,70(\u2019-\u2019))\nWRITE(4,450)\n450 F0RMAT(T4,\u2019!\t01\t!\t02\t!\t03\t!\t04\t!1 ,\n*\u2019\t05\t!\t06\t!\u2019 ,/,70(\u2019-\u2019))\nDO 410 J=NYC,1,-1\nWRITE(4,460) (P0(I,J,K,2)/C2,1=1 ,NXC)\n460 F0RMAT(T4,\u2019! \\6(F8.4/ ! \u2019))\nWRITE(4,470)J,(S0(I,J,K,2),1=1,NXC)\n470 F0RMAT(I2,* \u2019 \u2019,6(F8.5,' ! '))\nWRITE\u00cd4,480)<SW(I,J,K,2),1=1,NXC)\n480 F0RMAT(T4,\u2019! '^(FS.B,1 ! '))\nWRITE(4,490)\n490\tF0RMAT(70(\u2019-'))\n410 CONTINUE\nci no\t.\tQo\u00e7\t_\to na\nMapa de press\u00e3o e saturacao do grid radial\nLIX=1\nIF(NXR.LE.6) THEN\nLIM\u00bb1 LSX=NXR\nENDIF\nIF(NXR.GT.6.AND.NXR.LE.12) THEN\nLIM=2\nLSX=6\nENDIF\nWRITE(4,500)\nFORMAT(/,5X,'GRID RADIAL1)\nDO 421 K=1,NZR WRITE(4,420)K\nDO 510 M=1,LIM\nIF(M.EQ.l)WRITE(4,450) IF(M.EQ.2)WRITE(4,451)\nFORMAT(T4,J!\t07\n*' 11 ! 12\nDO 610 J=1,NYR\nWRITE(4,460)(P0(I,J,K,1)/C2,I=LIX,LSX) WRITE(4,470)J,(SO(I,J,K,1),I=LIX,LSX) WRITE(4,480)(SW(I,J,K,1),I=LIX,LSX) WRITE(4,490)\nCONTINUE\nIF(LIM.EQ.2) THEN\nLIX=7 LSX=NXR\nENDIF\nCONTINUE\nCONTINUE\nio\n!\t08 I 09\n!',/,7o('~'))\nDISTRIBUI\u00c7\u00c3O DAS VAZOES\n60\n55\n35\n61\nDO 61 K=1,NZR\nWRITE(4,420)K\nWRITE(4,45)\nFORMAT(/,6X,'BLOCO ',2X,'PRESS\u00c3O 1,3X/ Qoj,k\u2019,3X, *\u2019 Qwj,k',10X,'RWO',\n*/,3X,'1=1 J\t(MPa)\t(m3/D)\t(m3/D)',8X,'(m3/m3)9\nDO 55 J=1,NYR\nAUX=O.ODO\t. t ,\nIF(QO(J,K).NE.O.ODO)AUX=qW(J,K)/QO(J,K)\nWRITE(4,60)J,P0(l,J,K,1)/C2,Q0(J,K)*C1,QW(J,K)*C1,AUX\nFORMAT(7X,I2,1X,4(F1O.5,2X))\nCONTINUE\nWRITE(4,35)\nFORMAT(IX)\nCONTINUE\nWRITE(9,88O)TEMPD/C1\n880\tFQRMAT(\u2019tempo=',F10.2,\u2019 par\u00e2metros abaixo:dvp,sw*)\nJJ=2*NQL+NQS+NQI/2+l\nDO 870 1=1,NXR\nDELSW=SW(I,JJ,1,l)-0.12D0 WRITE(9,890)-RB(I),SW(I,JJ,1,l)*100.0\n890 F0RMAT(2(F10.2,2X))\n870 CONTINUE\nC\nRETURN\nEND\nSUBROTINA DE IMPRESS\u00c3O DE RESULTADOS PARA GR\u00c1FICOS\n\" SUBROUTINE\"IMPR\u00cag\"\nIMPLICIT DOUBLE PRECISIDN(A-H,O-Z)\nPARAMETER(NXM=08,NYM=O5,NZM=04)\nCOMMON/ACUM/QOAC, QGAC, QWAC, VOORR, VWORR,VOORC, VWORC, BNPR, BWPR,\n*\tBNPC,BWPC,PWFA\nCOMMON/VAZAO/QD,QOT,QG,QGT,QW,QWT,DQOP,DQOS,\n*\tDQWP,DQWS,RWO,RGO,PWF,TEMPD\nDIMENSION QO(NYM,NZM),QG(NYM,NZM),QW(NYM,NZM),DQOP(NYM,NZM),\n*\tDQOS(NYM,NZM),DQWP(NYM,NZM),DQWS(NYM,NZM)\nCi=86400.ODO\nC2=1.0D+6\nWRITE(5,1D)TEMP0/C1,Cl*QOT,Cl*QWT,QGT*C1, PWF/C2\nWRITE(7,20)TEMPO/C1,QOAC,QWAC>QGAC WRITE\u00cd8,30)TEMP0/Cl,QWT/QOT,QGT/QOT\n10\tF0RMAT(E10.4,3X,E10.4,3X,E10.4,3X,E10.4,3X,E10.4)\n20\tF0RMAT(E10.4,3X,E10.4,3X,E10.4,3X,E10.4)\n30\tF0RMAT(E10.4,3X,E10.4,3X,E10.4)\nRETURN\nEND\nWU\u00dcU U\tO\tO U\u00dcW\nSUBROTINA DE IMPRESS\u00c3O DOS DADOS DO TESTE DE FORMACAO\nSUBROUTINE IMPRET(DT,OPT,L)\nIMPLICIT DOUBLE PRECISION(A-H,0-2)\nPARAMETER(NXM=08,NYM=05,NZM=04)\nCOMMON/NCEL/DBDX, DBDY, DBDZ, WRC ,NBLOC ,NXC, NYC, NZC, NBP,\n*\tNXR^YR^ZR.NQL^QS^QI.IP.JP^P\nCOMMQN/TS/PO,SO,SG, SW\nCOMMON/MALHA/ZB,RB,VPOR,D RO,WX,WY,WZ,FFX,FFY,FFZ,DTETA COMMON/VAZAO/QO,QOT,QG,QGT,qW,qWT,DQOP,DQOS,\n*\tDQWP,DQWS,RWO,RGO,PWF,TEMPO\nCOMMON/ACUM/QOAC, QGAC, QWAC, VOORR, VWORR, VOORC, VWORC, BNPR, BWPR,\n*\tBNPC,BWPC,PWFA\nCOMMON/IMP/TIMPR,TIMPG,IRIMP\nDIMENSION PD(0:NXM+1,0:NYM+1,0:NZM+1,2),SO(NXM,NYM,NZM,2) ,\n*\tSG(NXM,NYM,NZM,2),SW(NXM,NYM,NZM,2)\nDIMENSION ZB(O:NXM+1,NYM,2) ,RB(NXM+1) ,VP0R(NXM,NYM,NZM,2) ,\n*\tFFX(NXM+1,NYM,NZM,2),FFY(NXM+1,NYM,NZM,2),\n*\tFFZ(NXM+1,NYM,NZM+1,2),DTETA(NYM+1)\nDIMENSION QO(NYM,NZM) ,QG(NYM,NZM) ,QW(NYM,NZM) ,DQOP(NYM,NZM) ,\n*\tDQOS(NYM,NZM),DQWP(NYM,NZM),DqWS(NYM,NZM)\nC\n5\nCHARACTER*! 0PT,SIT*5\nC1=3600.0DO\nC2\u00bb1.0D+6\nC3=24.0D0*Cl\nIF(OPT.EQ.\u2019F\u2019) THEN\nSIT\u00ae\u2019FLUXO\u2019\nELSE\nSIT\u00ae\u2019ESTAT\u2019\nENDIF\nWRITE(11,5)SIT,NXC,NYC,NEC,TEMPO/C1,DT/C1,C3*QOT,C3*QWT,RWO,PWF/C2\nF0RMAT(\u2019 \u2019,/,15X,\u2019RESULTADOS DO SIMULADOR ACTI0W4',//,\n*5X,\u2019FASE DE TESTE DE FORMACAO\t\u2019 '\nX\nY\nZ\n- FINAL \u2019.A5,//,\n\u00ed\n1\nJ\nJ\nJ\nJ\n>\n>\n15\n20\n*5X,\u2019N# DE BLOCOS NA DIRECAO\n*5X,\u2019N# DE BLOCOS NA DIRECAO\n*5X,\u2019N# DE BLOCOS NA DIRECAO\n*5X,'TEMPO ACUMULADO (horas)\n*5X,\u2019INCREMENTO DE TEMPO (horas)......\n+5X/VAZA0 DE OLEO (m3/dia)............\n*5X,\u2019VAZA0 DE GAS (m3/dia)............\n*5X,\u2019RAZA0 GAS OLEO (m3/dia / m3/dia).\n*5X,\u2019PRESSA0 Pwf NO POCO (MPa)........\nDO 10 K=1,NZR\nWRITE(11,15)K\nFORMAT\u00cd/,5X,\u2019CAMADA:\u2019,13)\nWRITE(ll,20)\nFORMAT(/,5X/GRID RADIAL',/,5X,\u2019 BLOCO \u2019,5X,\u2019PRESSAO(MPA)\u2019, 3X,\u2019SAT OLEO\u2019,4X,'SAT GAS\u2019,5X,'SAT AGUA\u2019)\nDO 10 I\u00ab1,NXR\nDO 10 J=1,NYR WRITE(11,25)I,J,PO(I,J,K,1)/C2,SO(I,J,K,1),\nSG(I,J,K,1),SW(I,J,K,1)\nFORMAT(5X,2(I2,1X),5(F10.4,2X))\nCONTINUE\nDO 30 K=1,NZC\nWRITE(11,35)K\nFORMAT(/,5X,\u2018CAMADA:',13)\nWRITE(ll,40)\nFORMAT(/,5X,'GRID CARTESIANO\u2019,/,5X,\u2019 BLOCO \u2019,5X,\u2019PRESS\u00c3O(MPA)\u2019, 3X/SAT OLEO\u2019,4X,'SAT GAS\u2019,5X,'SAT AGUA\u2019)\nDO 30 1=1,NXC\nDO 30 J=1,NYC WRITE(ll,55)I,J,P0(I,J,K,2)/C2,S0(I,J,K,2),\n\u25a0\u25a0\tSG(I,J,K,2) ,SW(I,J,K,2)\nFORMAT(5X,2(I2,1X),5(F10.4,2X))\nCONTINUE\nRETURN\nEND\n,13,/,\n,13,/,\n,13,/, jElO.4,/, ,F10.4,/, ,F10.4,/,\nE10.4,/,\nE10.4,/,\nFIO.4)\n*\n*\n25\n10 C\n35\n40\n55\n30\n\n*\n*\nSUBBOTINA DE INTERPOLA\u00c7\u00c3O POR PESQUISA BINARIA E CALC. DA 1# DERIVADA\nSUBROUTINE INTER(X,Y,N,XO,YO,YDP)\nREAL*8 X(N),Y(N),X0,Y0,YOP\nINTEGER IN,MAX,MEIO\nIF((XO.LT.X(l)).OR.(XO.GT.X(N))) THEN\nPRINT*,'NAO FOI POSS\u00cdVEL INTERPOLAR XO=\u2019,XO DO 5 J-1,N\nPRINT*,!,1\tY=\u2019,Y(J)\n5\tCONTINUE\nXO\n15\no oooo\nSTOP\nEND IF\nIN\u00bb1\nMAX=N\nMEI0=(MAX+IN)/2\nIF((XO,GE.X(MEIO)).AND.(XO.LE,X(MEI0+l))) THEN\nYOP=(Y(MEI0+1)~Y(MEIO))/(X(MEI0+l)~X(MEIO)) Y0=Y(MEI0)+(XQ-X(MEIO))*YOP\nGOTO 15\nELSE\nIF(X0.GT.X(MEI0)) IN=MEI0\nIF(XO.LT.XfMEIO)) MAX=MEI0\nGOTO 10\nENDIF\nRETURN\nEND\nC\n5\n10\nSUBROTINA DE INTERPOLA\u00c7\u00c3O POR PESQUISA BINARIA E CALC. DA 1# DERIVADA SOMENTE PARA A PRESS\u00c3O CAPILAR, dado pcow calcular sw\nSUBROUTINE INTERPC(X,Y,N,X0,YO,YOP) REAL*8 X(N),Y(N),X0,YO,YOP\nINTEGER IN,MAX,MEIO\nIF((XO.GT.X(l)).OR.(XO.LT.X(N))) THEN PRINT*,\u2019NAO FOI POSS\u00cdVEL INTERPOLAR XO=\u2019,XO DO 5 J-1,N\nPRINT*,!,\u2019 X=,,X(J),\u2019\tY=\u2019,Y(!)\nCONTINUE\nSTOP\nENDIF\nIN=N\nMAX=1\nMEI0=(MAX+IN)/2\nIF((XO.GE.X(MEIO)).AND.(XO.LE.X(MEIO-1))) THEN YOP=(Y(MEIO-1)-Y(MEIO))/(X(MEI0-l)~X (MEIO)) YO=Y(MEIO)+(XO-X(MEIO))*YOP GOTO 15\nELSE\nIF(XO.GT.X\u00cdMEIO)) IN=MEIO IF(XO.LT.X(MEID)) MAX=MEI0 GOTO 10\nENDIF\nRETURN\nEND"}]}}}