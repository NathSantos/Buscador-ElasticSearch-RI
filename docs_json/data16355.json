{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.20281"}, {"@name": "filename", "#text": "3752_338915.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "Victor Antonio Paludetto Magri\n\nPr\u00e9-Condicionador Multiescala\nAlg\u00e9brico Aplicado \u00e0 Simula\u00e7\u00e3o de\n\nReservat\u00f3rios de Petr\u00f3leo\n\nBrasil\n2015, Setembro\n\n\n\n\n\nVictor Antonio Paludetto Magri\n\nPr\u00e9-Condicionador Multiescala Alg\u00e9brico\nAplicado \u00e0 Simula\u00e7\u00e3o de Reservat\u00f3rios de\n\nPetr\u00f3leo\n\nDisserta\u00e7\u00e3o submetida ao Pro-\ngrama de P\u00f3s-Gradua\u00e7\u00e3o em En-\ngenharia Mec\u00e2nica da Universi-\ndade Federal de Santa Catarina\npara a obten\u00e7\u00e3o do Grau de Mes-\ntre em Engenharia Mec\u00e2nica.\n\nUniversidade Federal de Santa Catarina - UFSC\nDepartamento de Engenharia Mec\u00e2nica\n\nPrograma de P\u00f3s-Gradua\u00e7\u00e3o\n\nOrientador: Clovis R. Maliska\nCoorientador: M\u00e1rio C. Zambaldi\n\nBrasil\n2015, Setembro\n\n\n\nVictor Antonio Paludetto Magri\nPr\u00e9-Condicionador Multiescala Alg\u00e9brico Aplicado \u00e0 Simula\u00e7\u00e3o de Reserva-\n\nt\u00f3rios de Petr\u00f3leo/ Victor Antonio Paludetto Magri. \u2013 Brasil, 2015, Setembro-\n224 p. : il. (algumas color.) ; 30 cm.\n\nOrientador: Clovis R. Maliska\nCoorientador: M\u00e1rio C. Zambaldi\n\nDisserta\u00e7\u00e3o (Mestrado) \u2013 Universidade Federal de Santa Catarina - UFSC\nDepartamento de Engenharia Mec\u00e2nica\nPrograma de P\u00f3s-Gradua\u00e7\u00e3o, 2015, Setembro.\n1. Simula\u00e7\u00e3o de Reservat\u00f3rios. 2. M\u00e9todos Multiescala. 3. MsFVM. 4. Pr\u00e9-\n\ncondicionadores. I. Cl\u00f3vis R. Maliska. II. Universidade Federal de Santa Catarina.\nIII. Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia Mec\u00e2nica. IV. Mestrado.\n\n\n\nVictor Antonio Paludetto Magri\n\nPr\u00e9-Condicionador Multiescala Alg\u00e9brico\nAplicado \u00e0 Simula\u00e7\u00e3o de Reservat\u00f3rios de\n\nPetr\u00f3leo\n\nEsta Disserta\u00e7\u00e3o foi julgada adequada para obten\u00e7\u00e3o do T\u00edtulo\nde Mestre em Engenharia Mec\u00e2nica e aprovada em sua forma\nfinal pelo Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia Mec\u00e2nica.\n\nBrasil, 14 de Setembro de 2015.\n\nProf. Armando Albertazzi, Dr.\nCoordenador do Curso\n\nClovis R. Maliska, PhD. - Orientador\nUniversidade Federal de Santa Catarina\n\nM\u00e1rio C. Zambaldi, Dr. - Coorientador\nUniversidade Federal de Santa Catarina\n\nBanca Examinadora:\n\nProf. Daniel Norberto Kozakevich, Dr.\nUniversidade Federal de Santa Catarina\n\n\n\nProf. Juliano de Bem Francisco, PhD.\nUniversidade Federal de Santa Catarina\n\nProf. S\u00e9rgio Peters, Dr. Eng.\nUniversidade Federal de Santa Catarina\n\n\n\nAGRADECIMENTOS\n\nAgrade\u00e7o em primeiro lugar a Deus pela gra\u00e7a que viabi-\nlizou a realiza\u00e7\u00e3o desse trabalho; aos meus pais Marcos e M\u00e1rcia,\nos quais se esfor\u00e7aram para que eu pudesse conduzir meus estudos\nlonge de minha cidade natal; aos meus companheiros do grupo de\npesquisa SINMEC, cada qual com seu papel especial no desenvol-\nvimento desse trabalho. Agrade\u00e7o em especial aos companheiros\nde sala Ed\u00e3o e Giovani e tamb\u00e9m ao Gustavo pelas discuss\u00f5es\nsobre m\u00e9todos de solu\u00e7\u00e3o de sistemas lineares e pela grande ajuda\nconcedida em rela\u00e7\u00e3o \u00e0 organiza\u00e7\u00e3o do tempo dedicado \u00e0s ativi-\ndades de pesquisa. Nesse \u00e2mbito, outra pessoal fundamental foi a\nTatiane, que esteve sempre atenta para me lembrar das datas de\nentregas de trabalhos e demais prazos estipulados pelo programa\nde p\u00f3s-gradua\u00e7\u00e3o al\u00e9m de conceder v\u00e1rias dicas fundamentais\npara a apresenta\u00e7\u00e3o oral do trabalho. Incluo nessa \u00faltima observa-\n\u00e7\u00e3o os amigos Mariele, Vit\u00e3o e Ta\u00edsa, cujas dicas foram essenciais\npara que eu conseguisse enquadrar os aspectos mais relevantes do\ntrabalho dentro do tempo estipulado para sua apresenta\u00e7\u00e3o.\n\nAgrade\u00e7o muito aos meus orientadores Clovis Maliska e\nM\u00e1rio Zambaldi. Ao primeiro, pela oportunidade de trabalhar\nao longo dos \u00faltimos 6 anos no laborat\u00f3rio SINMEC e por se\npreocupar em manter sempre nosso ambiente de pesquisa antenado\ncom as tend\u00eancias em simula\u00e7\u00e3o num\u00e9rica do escoamento em\nreservat\u00f3rios de petr\u00f3leo; ao segundo, agrade\u00e7o pelas aulas de\n\u00e1lgebra linear que despertaram a paix\u00e3o pela pesquisa em an\u00e1lise\nnum\u00e9rica e tamb\u00e9m pelas v\u00e1rias conversas e conselhos obtidos.\n\nEstendo minha gratid\u00e3o tamb\u00e9m aos amigos que n\u00e3o\nparticiparam diretamente na realiza\u00e7\u00e3o do trabalho mas que\nproporcionaram bons momentos de conv\u00edvio, essenciais para o\ndescanso da mente e seu preparo para o dia seguinte. Aos amigos\ne tamb\u00e9m professores Marcos e L\u00e9o pelas boas conversas e tam-\nb\u00e9m em especial aos irm\u00e3os de morada: Henrique Martin, Ed\u00e3o,\nSerginho, Renanz\u00e3o, al\u00e9m dos v\u00e1rios h\u00f3spedes que passaram pelo\napartamento A202 do Vivenda das Verbenas ao longo desses dois\nanos e meio de exist\u00eancia. \u00d3timas recorda\u00e7\u00f5es ficam desse per\u00edodo.\n\nPor \u00faltimo agrade\u00e7o \u00e0 Universidade Federal de Santa Ca-\n\n\n\ntarina e ao Programa de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia Mec\u00e2nica\npela excel\u00eancia do curso oferecido. Ao Programa de Recursos\nHumanos da ANP pela estrutura disponibilizada e pelo apoio\nfinanceiro bem como ao Conselho Nacional de Pesquisa e Desen-\nvolvimento Cient\u00edfico CNPq.\n\n\n\n\u201cSenhor, tudo para a tua gl\u00f3ria e por Amor.\u201d\n(Caminho - 788)\n\n\n\n\n\nRESUMO\n\nUm dos grandes desafios presentes na simula\u00e7\u00e3o num\u00e9rica de\nreservat\u00f3rios de petr\u00f3leo diz respeito \u00e0 resolu\u00e7\u00e3o dos sistemas line-\nares obtidos pela discretiza\u00e7\u00e3o de equa\u00e7\u00f5es el\u00edpticas. Essa tarefa\ntorna-se ainda mais complexa quando campos de permeabilidade\naltamente heterog\u00eaneos s\u00e3o considerados. Diversas estrat\u00e9gias\nde solu\u00e7\u00e3o diretas e iterativas foram desenvolvidas ao longo dos\n\u00faltimos anos e empregadas nesse contexto, restringindo-se \u00e0s\n\u00faltimas, nota-se que os m\u00e9todos iterativos constru\u00eddos a partir\nde pr\u00e9-condicionadores do tipo multigrid s\u00e3o os mais utilizados\ndevido a sua robustez e efici\u00eancia. Nesse trabalho avaliam-se as\npropriedades matem\u00e1ticas e o desempenho computacional de uma\nsubclasse de pr\u00e9-condicionadores desse \u00faltimo tipo conhecida\ncomo \u201cmultiescala\u201d. As alternativas estudadas s\u00e3o implementadas\ncomputacionalmente e empregadas em conjunto com diversos\nm\u00e9todos iterativos para a resolu\u00e7\u00e3o precisa e tamb\u00e9m aproxi-\nmada de problemas el\u00edpticos desafiadores. Dentre os problemas\ntestados, verifica-se que a melhor estrat\u00e9gia de configura\u00e7\u00e3o para\no pr\u00e9-condicionador multiescala \u00e9 constitu\u00edda por um operador\nde restri\u00e7\u00e3o do tipo galerkin, suavizador baseado em fatora\u00e7\u00e3o\nincompleta e raz\u00f5es de engrossamento ao redor de 10 ao longo\nde cada dire\u00e7\u00e3o do reservat\u00f3rio. Diversas outras estrat\u00e9gias de\nsolu\u00e7\u00e3o direta e iterativa dispon\u00edveis no pacote cient\u00edfico PETSc\ns\u00e3o testadas para a resolu\u00e7\u00e3o dos problemas em quest\u00e3o, da\nonde conclui-se que o pr\u00e9-condicionador BoomerAMG associado\nao m\u00e9todo do gradiente conjugado e tamb\u00e9m o m\u00e9todo direto\nCholesky-UMFPACK s\u00e3o as mais eficientes em ambos quesitos\nmatem\u00e1tico e computacional, inclusive em rela\u00e7\u00e3o ao m\u00e9todo\nmultiescala de refer\u00eancia quando se deseja encontrar solu\u00e7\u00f5es com\nelevadas precis\u00f5es.\n\nPalavras-chave: simula\u00e7\u00e3o de reservat\u00f3rios. Pr\u00e9-condicionadores\nmultiescala. M\u00e9todo dos volumes finitos multiescala.\n\n\n\n\n\nABSTRACT\n\nOne of the major challenges faced by reservoir simulation is about\nthe solution of the linear systems obtained by the discretization\nof elliptic equations. This task turns out to be even more com-\nplex when highly heterogeneous permeability fields are present.\nDifferent strategies of direct and iterative methods have been\ndeveloped in the last years and employed in this context. Consid-\nering the last ones, it\u2019s possible to note that iterative methods\nbuilt by multigrid preconditioners are the most employed because\nof their robustness and efficiency. In this work, the mathematical\nproperties and the computational performance of multigrid-like\npreconditioners called \u201cmultiscale preconditioners\u201d are evaluated.\nThe studied alternatives are implemented computationally and\nemployed in conjunction of iterative methods for the precise and\napproximate solution of challenging elliptic problems. Given the\ntested problems, it was possible to verify that the best configura-\ntion properties for a multiscale preconditioner are composed by\na galerkin restriction operator, smoothers based on incomplete\nfactorization and coarsening ratios around of ten for each direc-\ntion of the grid. Several others solutions strategies available in\nthe scientific package PETSc were evaluated using the same set\nof problems as before and it was possible to conclude that the\nBoomerAMG preconditioner associated with the conjugate gradi-\nent method as well as the direct method Cholesky-UMFPACK\nare the most efficient ones in both mathematical and computa-\ntional evaluation points and are even better than the multiscale\npreconditioner when the intention is to get a precise solution.\n\nKeywords: reservoir simulation. Multiscale preconditioners. Mul-\ntiscale finite volume method.\n\n\n\n\n\nLISTA DE ILUSTRA\u00c7\u00d5ES\n\nFigura 1 \u2013 Stencil de sete pontos. . . . . . . . . . . . . . . 56\nFigura 2 \u2013 Ilustra\u00e7\u00e3o da matriz de coeficientes. . . . . . . 56\nFigura 3 \u2013 Fluxograma para resolu\u00e7\u00e3o do escoamento bi-\n\nf\u00e1sico. . . . . . . . . . . . . . . . . . . . . . . . 66\nFigura 4 \u2013 Ilustra\u00e7\u00e3o da ideia central do upscaling. . . . . 71\nFigura 5 \u2013 Decomposi\u00e7\u00e3o LDU da matriz A. . . . . . . . . 83\nFigura 6 \u2013 Problema teste: logaritmo do campo de perme-\n\nabilidade absoluta - log10(K[mD]). . . . . . . . 99\nFigura 7 \u2013 Problema teste: malhas envolvidas no MsFVM. 100\nFigura 8 \u2013 Problema teste: fun\u00e7\u00f5es base duais. . . . . . . 103\nFigura 9 \u2013 Problema teste: campo de press\u00e3o referente \u00e0\n\nmalha grosseira. . . . . . . . . . . . . . . . . . 105\nFigura 10 \u2013 Problema teste: solu\u00e7\u00e3o para o campo de press\u00e3o.105\nFigura 11 \u2013 Problema teste: linhas de corrente (MsFVM). . 107\nFigura 12 \u2013 Problema teste: compara\u00e7\u00e3o entre linhas de\n\ncorrente. . . . . . . . . . . . . . . . . . . . . . . 108\nFigura 13 \u2013 Problema teste: fun\u00e7\u00f5es de corre\u00e7\u00e3o. . . . . . . 110\nFigura 14 \u2013 Problema teste: particionamento wirebasket. . . 114\nFigura 15 \u2013 Problema teste: estrutura da matriz de coefi-\n\ncientes original, \u00e0 esquerda, e reordenada, \u00e0\ndireita. . . . . . . . . . . . . . . . . . . . . . . 116\n\nFigura 16 \u2013 Problema teste: estrutura da matriz de coe-\nficientes reordenada, \u00e0 esquerda, e da matriz\nque gera o pr\u00e9-condicionador multiescala com\nfun\u00e7\u00f5es de corre\u00e7\u00e3o, \u00e0 direita. . . . . . . . . . . 117\n\nFigura 17 \u2013 Problema teste: estrutura da matriz Aii. . . . . 118\nFigura 18 \u2013 Problema teste: estrutura da matriz Mee. . . . 118\nFigura 19 \u2013 Problema teste: estrutura da matriz M?vv. . . . 119\nFigura 20 \u2013 Problema teste: interpreta\u00e7\u00e3o para as colunas\n\nda matriz P. . . . . . . . . . . . . . . . . . . . 122\nFigura 21 \u2013 Problema teste: formato do operador de corre-\n\n\u00e7\u00e3o C. . . . . . . . . . . . . . . . . . . . . . . . 123\nFigura 22 \u2013 Problema teste: operador de restri\u00e7\u00e3o RFV . . . 124\nFigura 23 \u2013 Problema teste: estrutura da matriz A?. . . . . 131\nFigura 24 \u2013 Caso 1: campo de permeabilidade. . . . . . . . 137\n\n\n\nFigura 25 \u2013 Caso 1: solu\u00e7\u00e3o MsFVM-16x16. . . . . . . . . . 138\nFigura 26 \u2013 Caso 1: solu\u00e7\u00e3o MsFVM-32x32. . . . . . . . . . 139\nFigura 27 \u2013 Caso 1: solu\u00e7\u00e3o MsFVM-64x64. . . . . . . . . . 139\nFigura 28 \u2013 Caso 1: linhas de corrente para a solu\u00e7\u00e3o MsFVM-\n\n64x64. . . . . . . . . . . . . . . . . . . . . . . . 141\nFigura 29 \u2013 Caso 1: solu\u00e7\u00e3o MsFEM-16x16. . . . . . . . . . 141\nFigura 30 \u2013 Caso 1: solu\u00e7\u00e3o MsFEM-32x32. . . . . . . . . . 142\nFigura 31 \u2013 Caso 1: solu\u00e7\u00e3o MsFEM-64x64. . . . . . . . . . 142\nFigura 32 \u2013 Caso 1: campo de press\u00e3o. . . . . . . . . . . . . 144\nFigura 33 \u2013 Caso 1: tempo dos solvers diretos. . . . . . . . 145\nFigura 34 \u2013 Caso 1: etapas dos solvers diretos. . . . . . . . 145\nFigura 35 \u2013 Caso 1: uso de mem\u00f3ria pelos solvers diretos. . 146\nFigura 36 \u2013 Caso 1: converg\u00eancia dos m\u00e9todos iterativos de\n\nrefer\u00eancia. . . . . . . . . . . . . . . . . . . . . . 147\nFigura 37 \u2013 Caso 1: converg\u00eancia dos m\u00e9todos iterativos de\n\nrefer\u00eancia. . . . . . . . . . . . . . . . . . . . . . 148\nFigura 38 \u2013 Caso 1: autovalores aproximados do operador\n\npr\u00e9-condicionado com BoomerAMG. . . . . . . 149\nFigura 39 \u2013 Caso 1: autovalores aproximados do operador\n\npr\u00e9-condicionado com GAMG. . . . . . . . . . 150\nFigura 40 \u2013 Caso 1: autovalores aproximados do operador\n\npr\u00e9-condicionado com ILU(0). . . . . . . . . . . 150\nFigura 41 \u2013 Caso 1: autovalores aproximados do operador\n\npr\u00e9-condicionado com ParaSails. . . . . . . . . 150\nFigura 42 \u2013 Caso 1: tempos dos m\u00e9todos iterativos de refe-\n\nr\u00eancia. . . . . . . . . . . . . . . . . . . . . . . . 151\nFigura 43 \u2013 Caso 1: mem\u00f3ria dos m\u00e9todos iterativos de\n\nrefer\u00eancia. . . . . . . . . . . . . . . . . . . . . . 152\nFigura 44 \u2013 Caso 1: norma do res\u00edduo pr\u00e9-condicionado -\n\nMSilu. . . . . . . . . . . . . . . . . . . . . . . . 153\nFigura 45 \u2013 Caso 1: norma do res\u00edduo real - MSilu. . . . . . 154\nFigura 46 \u2013 Caso 1: tempos das estrat\u00e9gias MSilu. . . . . . 154\nFigura 47 \u2013 Caso 1: norma do res\u00edduo pr\u00e9-condicionado -\n\nMSsor. . . . . . . . . . . . . . . . . . . . . . . . 155\nFigura 48 \u2013 Caso 1: norma do res\u00edduo real - MSsor. . . . . 156\nFigura 49 \u2013 Caso 1: tempos das estrat\u00e9gias - MSsor. . . . . 156\n\n\n\nFigura 50 \u2013 Caso 1: norma do res\u00edduo pr\u00e9-condicionado -\nMShs. . . . . . . . . . . . . . . . . . . . . . . . 157\n\nFigura 51 \u2013 Caso 1: norma do res\u00edduo real - MShs. . . . . . 158\nFigura 52 \u2013 Caso 1: tempos das estrat\u00e9gias - MShs. . . . . 158\nFigura 53 \u2013 Caso 1: norma do res\u00edduo pr\u00e9-condicionado. . . 159\nFigura 54 \u2013 Caso 1: norma do res\u00edduo real. . . . . . . . . . 159\nFigura 55 \u2013 Caso 1: tempos das estrat\u00e9gias multiescala. . . 160\nFigura 56 \u2013 Caso 1: uso de mem\u00f3ria de diferentes estrat\u00e9-\n\ngias de solu\u00e7\u00e3o. . . . . . . . . . . . . . . . . . . 160\nFigura 57 \u2013 Caso 1: norma do res\u00edduo pr\u00e9-condicionado da\n\nestrat\u00e9gia MsFEilu1sym variando-se o tama-\nnho do problema global. . . . . . . . . . . . . . 161\n\nFigura 58 \u2013 Caso 1: norma do res\u00edduo real da estrat\u00e9gia Ms-\nFEilu1sym variando-se o tamanho do problema\nglobal. . . . . . . . . . . . . . . . . . . . . . . . 162\n\nFigura 59 \u2013 Caso 1: tempos obtidos variando-se o tamanho\ndo problema global. . . . . . . . . . . . . . . . 163\n\nFigura 60 \u2013 Caso 1: espectro do operador pr\u00e9-condicionado\npor MsFEilu1sym-64x64. . . . . . . . . . . . . 163\n\nFigura 61 \u2013 Caso 1: picos de mem\u00f3ria obtidos variando-se\no tamanho do problema global. . . . . . . . . . 164\n\nFigura 62 \u2013 Caso 2: campo de permeabilidade. . . . . . . . 165\nFigura 63 \u2013 Caso 2: campo de press\u00e3o. . . . . . . . . . . . . 166\nFigura 64 \u2013 Caso 2: linhas de corrente de refer\u00eancia. . . . . 166\nFigura 65 \u2013 Caso 2: campo de press\u00e3o MsFVM-100x100. . . 167\nFigura 66 \u2013 Caso 2: campo de press\u00e3o MsFEM-100x100. . . 168\nFigura 67 \u2013 Caso 2: campo de press\u00e3o MsFVM-160x160. . . 169\nFigura 68 \u2013 Caso 2: campo de press\u00e3o MsFEM-160x160. . . 169\nFigura 69 \u2013 Caso 2: res\u00edduo real obtido pelo m\u00e9todo MsFEilu1sym-\n\nCG. . . . . . . . . . . . . . . . . . . . . . . . . 170\nFigura 70 \u2013 Caso 2: res\u00edduo real pelo m\u00e9todo MsFEssor2sym-\n\nCG. . . . . . . . . . . . . . . . . . . . . . . . . 171\nFigura 71 \u2013 Caso 2: tempo computacional pela estrat\u00e9gia\n\nMsFEilu1sym-CG. . . . . . . . . . . . . . . . . 172\nFigura 72 \u2013 Caso 2: res\u00edduo real para as estrat\u00e9gias de re-\n\nfer\u00eancia. . . . . . . . . . . . . . . . . . . . . . . 172\n\n\n\nFigura 73 \u2013 Caso 2: espectro aproximado do operador ori-\nginal pr\u00e9-condicionado com BoomerAMG. . . . 173\n\nFigura 74 \u2013 Caso 2: espectro aproximado do operador ori-\nginal pr\u00e9-condicionado com MsFEilu1sym-40x40.173\n\nFigura 75 \u2013 Caso 2: Tempos computacionais das estrat\u00e9gias\nde refer\u00eancia. . . . . . . . . . . . . . . . . . . . 174\n\nFigura 76 \u2013 Caso 2: pico de mem\u00f3ria da estrat\u00e9gia MsFEilu1sym-\nCG. . . . . . . . . . . . . . . . . . . . . . . . . 175\n\nFigura 77 \u2013 Caso 3: curvas de permeabilidade relativa. . . . 175\nFigura 78 \u2013 Caso 3: campo de permeabilidade absoluta. . . 176\nFigura 79 \u2013 Caso 3: tempo de solu\u00e7\u00e3o de acordo com di-\n\nferentes tamanhos para o problema na malha\ngrossa. . . . . . . . . . . . . . . . . . . . . . . . 179\n\nFigura 80 \u2013 Caso 3: n\u00famero de itera\u00e7\u00f5es da estrat\u00e9gia MsFEilu1sym3x9-\nCG em fun\u00e7\u00e3o do passo de tempo. . . . . . . . 180\n\nFigura 81 \u2013 Caso 3: tempo de execu\u00e7\u00e3o da estrat\u00e9gia MsFEilu1sym3x9-\nCG em fun\u00e7\u00e3o do passo de tempo. . . . . . . . 180\n\nFigura 82 \u2013 Caso 3: tempo computacional total associado\n\u00e0 execu\u00e7\u00e3o das estrat\u00e9gias de refer\u00eancia. . . . . 181\n\nFigura 83 \u2013 Caso 3: tempo de execu\u00e7\u00e3o da estrat\u00e9gia MsFEilu1sym3x9-\nCG em fun\u00e7\u00e3o do passo de tempo. . . . . . . . 182\n\nFigura 84 \u2013 Caso 3: campos de press\u00e3o. . . . . . . . . . . . 183\nFigura 85 \u2013 Caso 3: campos de satura\u00e7\u00e3o da fase \u00f3leo. . . . 184\nFigura 86 \u2013 Caso 4: campo de permeabilidade absoluta na\n\ndire\u00e7\u00e3o \u201cx\u201d. . . . . . . . . . . . . . . . . . . . . 185\nFigura 87 \u2013 Caso 4: tempos computacionais de acordo com\n\na estrat\u00e9gia de solu\u00e7\u00e3o. . . . . . . . . . . . . . 187\nFigura 88 \u2013 Caso 4: campo de press\u00e3o no instante final. . . 188\nFigura 89 \u2013 Caso 4: campo de satura\u00e7\u00e3o de \u00e1gua no instante\n\nfinal. . . . . . . . . . . . . . . . . . . . . . . . . 188\nFigura 90 \u2013 Caso 4: campo de satura\u00e7\u00e3o de \u00f3leo no instante\n\nfinal. . . . . . . . . . . . . . . . . . . . . . . . . 189\nFigura 91 \u2013 Caso 4: campo de satura\u00e7\u00e3o de g\u00e1s no instante\n\nfinal. . . . . . . . . . . . . . . . . . . . . . . . . 189\nFigura 92 \u2013 Caso 4: produ\u00e7\u00f5es totais acumuladas de g\u00e1s,\n\n\u00f3leo e \u00e1gua, respectivamente. . . . . . . . . . . 190\n\n\n\nLISTA DE TABELAS\n\nTabela 1 \u2013 M\u00e9todos de solu\u00e7\u00e3o diretos. . . . . . . . . . . . 134\nTabela 2 \u2013 Pr\u00e9-condicionadores padr\u00e3o. . . . . . . . . . . 134\nTabela 3 \u2013 Pr\u00e9-condicionadores do tipo multiescala. . . . . 136\nTabela 4 \u2013 Caso 3: propriedades dos po\u00e7os. . . . . . . . . 176\nTabela 5 \u2013 Caso 3: passos de tempo. . . . . . . . . . . . . 177\n\n\n\n\n\nLISTA DE ALGORITMOS\n\n1 Aplica\u00e7\u00e3o da fatora\u00e7\u00e3o LU. . . . . . . . . . . . . . . 75\n2 GMRes pr\u00e9-condicionado \u00e0 esquerda. . . . . . . . . 78\n3 CG pr\u00e9-condicionado \u00e0 esquerda. . . . . . . . . . . . 79\n4 Aplica\u00e7\u00e3o de M?1SSOR sobre um vetor. . . . . . . . . 84\n5 Aplica\u00e7\u00e3o da fatora\u00e7\u00e3o ILU. . . . . . . . . . . . . . 85\n6 Pr\u00e9-condicionador CPR . . . . . . . . . . . . . . . . 87\n7 Multigrid de dois n\u00edveis. . . . . . . . . . . . . . . . . 90\n\n\n\n\n\nLISTA DE ABREVIATURAS E SIGLAS\n\nAIM Adaptive Implicit Method.\n\nABF Alternate Block Factorization.\n\nAMG Algebraic Multigrid.\n\nAMS Algebraic Multiscale Solver.\n\nAMD Approximate Minimal Degree.\n\nASPIN Additive Schwartz Preconditioned Inexact New-\nton.\n\nBiCGStab Biconjugate Gradient Stabilized.\n\nBLAS Basic Linear Algebra Subprograms.\n\nCG Conjugate Gradient.\n\nCGS Conjugate Gradient Squared.\n\nCPU Central Processing Unit.\n\nCPR Constrained Pressure Residual.\n\nDD Domain Decomposition.\n\nDRS Dynamic Row Sum.\n\nFDM Finite Difference Method.\n\nFEM Finite Element Method.\n\nFIM Fully Implicit Method.\n\nFVM Finite Volume Method.\n\nGMRes Generalized Minimal Residual.\n\nGPU Graphics Processing Unit.\n\nHYPRE High Performance Preconditioners.\n\n\n\nILU Incomplete Lower Upper Factorization.\n\nILUT Incomplete Lower Upper Threshold Factoriza-\ntion.\n\nILUTP Incomplete Lower Upper Threshold Factoriza-\ntion with Pivoting.\n\nIMPES Implicit Pressure Explicit Saturation.\n\nLGR Local Grid Refinement.\n\nMMsFEM Mixed Multiscale Finite Element Method.\n\nMMsFVM Mixed Multiscale Finite Volume Method.\n\nMsFEM Multiscale Finite Element Method.\n\nMsFVM Multiscale Finite Volume Method.\n\nMPI Message Parsing Interface.\n\nMRST Matlab Reservoir Simulation Toolkit\n\nND Nested Dissection.\n\nNNC Non-Neighbour Connection.\n\nORTHOMIN Orthogonal Minimum Residual.\n\nPETSc Portable Extensible Toolkit for Scientific Com-\nputing.\n\nRAM Random Access Memory.\n\nRCM Reverse Cuthill-McKee.\n\nTPFA Two Point Flux Approximation.\n\nSFI Sequential Fully Implicit.\n\nSPD Symmetric Positive Definite.\n\nSSOR Symmetric Successive Overrelaxation.\n\nWDRS Weighted Dynamic Row Sum.\n\n\n\nLISTA DE S\u00cdMBOLOS\n\nS\u00cdMBOLOS GREGOS MAI\u00daSCULOS\n\n? Dom\u00ednio [?]\n\n?C Dom\u00ednio referente \u00e0 malha primal [?]\n\n?D Dom\u00ednio referente \u00e0 malha dual [?]\n\nS\u00cdMBOLOS GREGOS MIN\u00daSCULOS\n\n?? Mobilidade referente \u00e0 fase ? [1/(Pa s)]\n\n? Porosidade [?]\n\n?\nj\ni fun\u00e7\u00e3o base j referente ao volume de controle i\n\n[?]\n\n?? Densidade da fase ?\n[\nkg/m3\n\n]\n\u00b5? Viscosidade da fase ? [Pa s]\n\n? Fator de relaxa\u00e7\u00e3o [?]\n\n? Toler\u00e2ncia absoluta para a fatora\u00e7\u00e3o incom-\npleta LU [?]\n\nS\u00cdMBOLOS ROMANOS MAI\u00daSCULOS\n\nA \u00c1rea\n[\nm2\n]\n\nA Matriz de coeficientes [?]\n\nB? Fator volume de forma\u00e7\u00e3o da fase ?\n[\nm3/stdm3\n\n]\nBob Fator volume de forma\u00e7\u00e3o da fase \u00f3leo na pres-\n\ns\u00e3o de ponto de bolha\n[\nm3/stdm3\n\n]\nC Operador de corre\u00e7\u00e3o [?]\n\n\n\nCA Complexidade do operador alg\u00e9brico [?]\n\nCG Complexidade geom\u00e9trica [?]\n\nG Matriz de itera\u00e7\u00e3o [?]\n\nK Tensor permeabilidade absoluta\n[\nm2\n]\n\nKm Espa\u00e7o de Krylov de dimens\u00e3o m [?]\n\nL Matriz triangular inferior [?]\n\nM?1 Inversa da matriz de pr\u00e9-condicionamento. [?]\n\nMwn N\u00famero de zonas perfuradas do po\u00e7o n [?]\n\nNw N\u00famero de po\u00e7os [?]\n\nP Operador de prolonga\u00e7\u00e3o [?]\n\nP? Operador de proje\u00e7\u00e3o na dire\u00e7\u00e3o ? [?]\n\nQ Matriz de permuta\u00e7\u00e3o wirebasket [?]\n\nR Operador de restri\u00e7\u00e3o [?]\n\nRl Res\u00edduo referente \u00e0 itera\u00e7\u00e3o l do m\u00e9todo de\nNewton [?]\n\nRso Raz\u00e3o de solubilidade do componente g\u00e1s na\nfase \u00f3leo\n\n[\nstdm3/stdm3\n\n]\nS Matriz de suaviza\u00e7\u00e3o [?]\n\nS? Satura\u00e7\u00e3o da fase ? [?]\n\nT? Tensor transmissibilidade da fase ? [m d]\n\nT??d Transmissibilidade da fase ? na dire\u00e7\u00e3o d\n[\nstdm3/(Pa d)\n\n]\nU Matriz triangular superior [?]\n\nV Volume\n[\nm3\n]\n\n\n\nS\u00cdMBOLOS ROMANOS MIN\u00daSCULOS\n\nb lado direito do sistema linear [?]\n\nc? Compressibilidade da fase ?\n[\nPa?1\n\n]\nd Dire\u00e7\u00e3o (1,2 ou 3) [?]\n\nf? Fun\u00e7\u00e3o fluxo fracion\u00e1rio da fase ? [?]\n\nkr? Permeabilidade relativa da fase ? [?]\n\np Press\u00e3o [Pa]\n\npcow Press\u00e3o capilar \u00e1gua/\u00f3leo [Pa]\n\npcgo Press\u00e3o capilar g\u00e1s/\u00f3leo [Pa]\n\nq? Fonte/sumidouro de massa da fase ?\n[\nkg/(m3 s)\n\n]\nq?? Fonte/sumidouro de massa da fase ? [1/s]\n\nr res\u00edduo referente \u00e0 solu\u00e7\u00e3o aproximada do sis-\ntema linear [?]\n\nrw Raio do po\u00e7o [m]\n\nre Raio equivalente do po\u00e7o [m]\n\nx solu\u00e7\u00e3o aproximada do sistema linear [?]\n\nx? solu\u00e7\u00e3o exata do sistema linear [?]\n\nz Profundidade [m]\n\nSUBSCRITOS\n\nb Ponto de bolha [?]\n\nbh Fundo de po\u00e7o [?]\n\nc N\u00edvel grosso de malha [?]\n\n\n\no Componente/fase \u00f3leo [?]\n\nf N\u00edvel fino de malha [?]\n\ng Componente/fase g\u00e1s [?]\n\nl N\u00edvel de itera\u00e7\u00e3o [?]\n\nn Instante de tempo [?]\n\nw Componente/fase \u00e1gua [?]\n\ns Condi\u00e7\u00f5es padr\u00e3o de temperatura e press\u00e3o [?]\n\n\n\nSUM\u00c1RIO\n\n1 INTRODU\u00c7\u00c3O . . . . . . . . . . . . . . . . 31\n1.1 Motiva\u00e7\u00e3o . . . . . . . . . . . . . . . . . . . . . 34\n1.2 Objetivo Geral . . . . . . . . . . . . . . . . . . 36\n1.3 Objetivos Espec\u00edficos . . . . . . . . . . . . . . . 36\n1.4 Organiza\u00e7\u00e3o do Trabalho . . . . . . . . . . . . 37\n\n2 MODELAGEM MATEM\u00c1TICA E NUM\u00c9RICA 39\n2.1 Escoamento Trif\u00e1sico . . . . . . . . . . . . . . 40\n2.1.1 Discretiza\u00e7\u00e3o das Equa\u00e7\u00f5es . . . . . . . . . . . 44\n2.1.2 Determina\u00e7\u00e3o do Ponto de Bolha . . . . . . . 58\n2.2 Escoamento Bif\u00e1sico . . . . . . . . . . . . . . . 60\n2.2.1 Discretiza\u00e7\u00e3o das Equa\u00e7\u00f5es . . . . . . . . . . . 61\n2.3 Escoamento Monof\u00e1sico . . . . . . . . . . . . . 65\n\n3 SOLU\u00c7\u00c3O DO MODELO MATEM\u00c1TICO . 69\n3.1 Upscaling . . . . . . . . . . . . . . . . . . . . . 70\n3.2 Solvers Lineares . . . . . . . . . . . . . . . . . . 72\n3.2.1 Fatora\u00e7\u00e3o LU completa . . . . . . . . . . . . . 74\n3.2.2 M\u00e9todo de Richardson . . . . . . . . . . . . . . 75\n3.2.3 M\u00e9todo do Res\u00edduo Generalizado M\u00ednimo . . 76\n3.2.4 M\u00e9todo do Gradiente Conjugado . . . . . . . . 79\n3.3 Pr\u00e9-Condicionadores . . . . . . . . . . . . . . . 80\n3.3.1 M\u00e9todo da Sobre-Relaxa\u00e7\u00e3o Sucessiva . . . . 82\n3.3.2 Fatora\u00e7\u00e3o LU Incompleta . . . . . . . . . . . . 84\n3.3.3 Constrained Pressure Residual . . . . . . . . . 86\n3.3.4 Multigrid Alg\u00e9brico . . . . . . . . . . . . . . . . 88\n3.3.5 Decomposi\u00e7\u00e3o de Dom\u00ednio . . . . . . . . . . . 92\n\n4 M\u00c9TODO DOS VOLUMES FINITOS MUL-\nTIESCALA - MSFVM . . . . . . . . . . . . . 97\n\n4.1 Fun\u00e7\u00f5es Base Duais . . . . . . . . . . . . . . . 101\n4.2 Problema na Malha Grossa . . . . . . . . . . . 103\n4.3 Reconstru\u00e7\u00e3o do Campo de Velocidade . . . . 106\n4.4 Fun\u00e7\u00f5es de Corre\u00e7\u00e3o . . . . . . . . . . . . . . . 108\n\n\n\n4.5 Desenvolvimentos Recentes . . . . . . . . . . . 109\n\n5 PR\u00c9-CONDICIONADOR MULTIESCALA AL-\nG\u00c9BRICO . . . . . . . . . . . . . . . . . . . 113\n\n5.1 Operadores de Transfer\u00eancia . . . . . . . . . . 120\n5.2 Problema na Malha Grossa . . . . . . . . . . . 125\n5.3 Defini\u00e7\u00e3o do Pr\u00e9-Condicionador . . . . . . . . 126\n5.4 Reconstru\u00e7\u00e3o do Campo de Velocidades . . . 129\n\n6 RESULTADOS . . . . . . . . . . . . . . . . . 133\n6.1 Caso 1: monof\u00e1sico 2D . . . . . . . . . . . . . 135\n6.1.1 Solu\u00e7\u00e3o aproximada . . . . . . . . . . . . . . . 137\n6.1.2 M\u00e9todos diretos . . . . . . . . . . . . . . . . . 143\n6.1.3 M\u00e9todos iterativos . . . . . . . . . . . . . . . . 146\n6.2 Caso 2: escoamento canalizado . . . . . . . . . 164\n6.2.1 Solu\u00e7\u00e3o aproximada . . . . . . . . . . . . . . . 167\n6.2.2 Solu\u00e7\u00e3o precisa . . . . . . . . . . . . . . . . . . 168\n6.3 Caso 3: bif\u00e1sico incompress\u00edvel 2D . . . . . . . 175\n6.3.1 Solu\u00e7\u00e3o aproximada . . . . . . . . . . . . . . . 177\n6.3.2 Solu\u00e7\u00e3o precisa . . . . . . . . . . . . . . . . . . 178\n6.4 Caso 4: teste comparativo SPE 9 . . . . . . . 182\n\n7 CONCLUS\u00d5ES . . . . . . . . . . . . . . . . 191\n7.1 Sugest\u00f5es para trabalhos futuros . . . . . . . . 192\n\nRefer\u00eancias . . . . . . . . . . . . . . . . . . . 195\n\nAP\u00caNDICES 219\n\nAP\u00caNDICE A \u2013 PAR\u00c2METROS DO MODELO\nBLACK-OIL . . . . . . . . 221\n\nA.1 Fase \u00c1gua . . . . . . . . . . . . . . . . . . . . . 221\nA.2 Fase \u00d3leo . . . . . . . . . . . . . . . . . . . . . 221\nA.2.1 Estado subsaturado . . . . . . . . . . . . . . . 221\nA.2.2 Estado saturado . . . . . . . . . . . . . . . . . 222\n\n\n\nA.3 Fase G\u00e1s . . . . . . . . . . . . . . . . . . . . . . 222\n\nAP\u00caNDICE B \u2013 PR\u00c9-CONDICIONADOR MUL-\nTIESCALA ALG\u00c9BRICO 3D 223\n\n\n\n\n\n31\n\n1 INTRODU\u00c7\u00c3O\n\nReservat\u00f3rios de petr\u00f3leo s\u00e3o constitu\u00eddos por forma\u00e7\u00f5es\nrochosas repletas de espa\u00e7os vazios interconectados entre si atra-\nv\u00e9s dos quais fluidos derivados principalmente de hidrocarbonetos\nescoam mediante um diferencial de press\u00e3o. A explora\u00e7\u00e3o desses\nreservat\u00f3rios envolve diversas etapas entre as quais a de produ-\n\u00e7\u00e3o representa uma das fundamentais. Nessa fase, os fluidos s\u00e3o\nretirados dos reservat\u00f3rios atrav\u00e9s de po\u00e7os que conectam estes\n\u00faltimos at\u00e9 a superf\u00edcie1. Devido a limita\u00e7\u00f5es f\u00edsicas, n\u00e3o \u00e9 poss\u00ed-\nvel recuperar todo o fluido contido no reservat\u00f3rio, no entanto, \u00e9\nposs\u00edvel maximizar tal quantidade desde que estrat\u00e9gias eficientes\nde explota\u00e7\u00e3o sejam implementadas. Uma ferramenta fundamen-\ntal para a avalia\u00e7\u00e3o dessas t\u00e9cnicas \u00e9 a simula\u00e7\u00e3o do escoamento\nem reservat\u00f3rios. A partir dela, \u00e9 poss\u00edvel predizer o volume dos\nfluidos recuperado em cada um dos po\u00e7os, bem como sua taxa\nde produ\u00e7\u00e3o, entre outros par\u00e2metros ao longo do tempo. Estes\ndados, por sua vez, podem ser utilizados no c\u00e1lculo do fator de\nrecupera\u00e7\u00e3o, par\u00e2metro fundamental para a an\u00e1lise da efici\u00eancia\nassociada \u00e0 estrat\u00e9gia de produ\u00e7\u00e3o adotada.\n\nNesse contexto, o reservat\u00f3rio costuma ser modelado fi-\nsicamente como um meio poroso atrav\u00e9s do qual fluidos escoam\na baixas velocidades (hip\u00f3tese de Stokes). Isso permite que tal\nvari\u00e1vel seja escrita em fun\u00e7\u00e3o da press\u00e3o atrav\u00e9s da lei de Darcy\n(KAVIANY, 1995). Esta e outras equa\u00e7\u00f5es baseadas em princ\u00edpios\nb\u00e1sicos da mec\u00e2nica dos fluidos como a conserva\u00e7\u00e3o da massa\ne da energia constituem o modelo matem\u00e1tico que representa o\nescoamento em reservat\u00f3rios.\n\nDo ponto de vista matem\u00e1tico, tais equa\u00e7\u00f5es s\u00e3o classifi-\ncadas como diferenciais parciais e podem acoplar mais de uma\ninc\u00f3gnita referente ao escoamento como press\u00e3o, velocidade e\nsatura\u00e7\u00e3o. Existem situa\u00e7\u00f5es b\u00e1sicas em que \u00e9 poss\u00edvel de se\nencontrar a solu\u00e7\u00e3o anal\u00edtica dessas equa\u00e7\u00f5es, por\u00e9m, na maio-\nria dos casos, isso n\u00e3o \u00e9 poss\u00edvel devido \u00e0 geometria complexa\n\n1 Na nomenclatura de engenharia de reservat\u00f3rios, diz-se que o fluido foi\nrecuperado ou produzido do reservat\u00f3rio.\n\n\n\n32 Cap\u00edtulo 1. Introdu\u00e7\u00e3o\n\ndos reservat\u00f3rios bem como aos processos f\u00edsicos complexos que\nsucedem durante o escoamento. Portanto, \u00e9 comum resolver tais\nequa\u00e7\u00f5es numericamente, isto \u00e9, de forma aproximada segundo\nalgum m\u00e9todo num\u00e9rico como volumes finitos ou elementos finitos.\nPor sua vez, a aplica\u00e7\u00e3o do m\u00e9todo num\u00e9rico gera um ou mais\nsistemas de equa\u00e7\u00f5es discretizadas possivelmente n\u00e3o-lineares que\ns\u00e3o de grande porte e esparsos2.\n\nNa simula\u00e7\u00e3o de reservat\u00f3rios, assim como na maioria\ndas aplica\u00e7\u00f5es envolvendo simula\u00e7\u00e3o num\u00e9rica, a resolu\u00e7\u00e3o desses\nsistemas alg\u00e9bricos representa a maior parte do tempo associado\n\u00e0 execu\u00e7\u00e3o do c\u00f3digo computacional. Em especial, a etapa de\nresolu\u00e7\u00e3o de equa\u00e7\u00f5es el\u00edpticas3, como a empregada para o c\u00e1lculo\nda vari\u00e1vel press\u00e3o, \u00e9 a que se mais destaca nessa \u00faltima parcela.\nDe fato, uma \u00e1rea muito ativa na simula\u00e7\u00e3o de reservat\u00f3rios, bem\ncomo em outras \u00e1reas de engenharia que apresentam problemas\nde car\u00e1ter el\u00edptico, busca propor m\u00e9todos mais eficientes para\na sua resolu\u00e7\u00e3o em termos do uso de recursos computacionais\ne tamb\u00e9m de precis\u00e3o na solu\u00e7\u00e3o, j\u00e1 que esta pode ser obtida\napenas aproximadamente al\u00e9m de exatamente.\n\nNo \u00e2mbito de estrat\u00e9gias de solu\u00e7\u00e3o eficientes, um consi-\nder\u00e1vel avan\u00e7o foi obtido com o advento dos m\u00e9todos multigrid.\nBasicamente, estes s\u00e3o pr\u00e9-condicionadores utilizados em conjunto\ncom m\u00e9todos iterativos respons\u00e1veis por empregar c\u00e1lculos em\nv\u00e1rios n\u00edveis de malhas com o intuito de eliminar erros de solu\u00e7\u00e3o\nassociados a diferentes frequ\u00eancias e acelerar a taxa de converg\u00ean-\ncia dos m\u00e9todos iterativos (HACKBUSCH, 1985). Podem-se citar\ntamb\u00e9m os m\u00e9todos baseados em decomposi\u00e7\u00e3o de dom\u00ednio, cuja\nideia fundamental \u00e9 dividir um problema original em diversos\nsubproblemas locais de menor tamanho que podem ser resolvidos\nparalelamente e cuja solu\u00e7\u00e3o \u00e9 empregada para o c\u00e1lculo da solu-\n\u00e7\u00e3o do problema original (SANDVIN, 2012). Ambas estrat\u00e9gias\nmencionadas apresentam diversos par\u00e2metros de configura\u00e7\u00e3o que\nd\u00e3o origem a diferentes pr\u00e9-condicionadores para serem utilizados\n2 O n\u00famero de elementos n\u00e3o nulos da matriz \u00e9 relativamente baixo.\n3 Do ponto de vista f\u00edsico, quando uma vari\u00e1vel de car\u00e1ter el\u00edptico sofre\n\numa pertuba\u00e7\u00e3o em determinada posi\u00e7\u00e3o do dom\u00ednio, esta propaga-se em\ntodas as dire\u00e7\u00f5es de modo possivelmente irregular.\n\n\n\n33\n\nem conjunto com solvers iterativos.\nUma outra maneira de se melhorar a efici\u00eancia computaci-\n\nonal consiste em reduzir a precis\u00e3o da solu\u00e7\u00e3o calculada, por\u00e9m de\nmodo que esta possa ainda ser considerada confi\u00e1vel. Dessa forma,\numa quantidade menor de recursos computacionais necessita ser\nalocada durante o processo de resolu\u00e7\u00e3o dos sistemas alg\u00e9bricos\nlineares ou possivelmente n\u00e3o-lineares. Essa \u00e9 justamente a abor-\ndagem das t\u00e9cnicas de upscaling, que buscam a constru\u00e7\u00e3o de um\nproblema de menor tamanho em rela\u00e7\u00e3o ao original4(CHRISTIE,\n1996). Esse processo \u00e9 realizado numa etapa anterior \u00e0 simula\u00e7\u00e3o\ndo escoamento propriamente dita, nele assume-se um comporta-\nmento pr\u00e9vio para o escoamento com o intuito de se calcular, para\na malha grosseira, as propriedades f\u00edsicas da rocha bem como\nalguns par\u00e2metros relativos \u00e0 intera\u00e7\u00e3o entre rocha e fluido como\npress\u00e3o capilar e permeabilidade relativa. Devido a tal hip\u00f3tese\nsobre o escoamento, a solu\u00e7\u00e3o do problema obtido a partir do\nupscaling apresenta certo grau de imprecis\u00e3o em rela\u00e7\u00e3o \u00e0quela\nque seria obtida caso o problema original fosse resolvido com alta\nprecis\u00e3o.\n\nReservat\u00f3rios altamente heterog\u00eaneos como os de forma-\n\u00e7\u00e3o carbon\u00e1tica, cujo campo de permeabilidade apresenta elevada\nvaria\u00e7\u00e3o ao longo do espa\u00e7o, levam a uma dificuldade adicional\nna resolu\u00e7\u00e3o da equa\u00e7\u00e3o da press\u00e3o. Isso se d\u00e1 porque tais re-\nservat\u00f3rios exigem o uso de t\u00e9cnicas ainda mais complexas de\nupscaling para a obten\u00e7\u00e3o de solu\u00e7\u00f5es confi\u00e1veis ou ainda solvers\nmais robustos, j\u00e1 que o n\u00famero de condicionamento da matriz ob-\ntida no processo de discretiza\u00e7\u00e3o da equa\u00e7\u00e3o da press\u00e3o \u00e9 elevado\nnesses casos, o que prejudica a performance de solvers iterativos.\nAl\u00e9m dessa dificuldade, a solu\u00e7\u00e3o do escoamento nesses casos\npode demandar malhas computacionais com alt\u00edssimo n\u00famero\nde inc\u00f3gnitas a ponto de inviabiliz\u00e1-la devido a limita\u00e7\u00f5es de\nrecursos computacionais.\n\nUma poss\u00edvel solu\u00e7\u00e3o para a simula\u00e7\u00e3o eficiente do ponto\n4 O problema original \u00e9 normalmente referido como refinado e descrito\n\nde acordo com um modelo geol\u00f3gico, enquanto o problema de menor\ntamanho \u00e9 referido como grosseiro e descrito de acordo com um modelo\nde reservat\u00f3rio.\n\n\n\n34 Cap\u00edtulo 1. Introdu\u00e7\u00e3o\n\nde vista computacional e, ao mesmo tempo, que conduz a uma\nsolu\u00e7\u00e3o com grau de precis\u00e3o adequado consiste no uso de m\u00e9todos\nmultiescala. Estes podem ser vistos como tipos especiais de pr\u00e9-\ncondicionadores multigrid que tentam capturar a varia\u00e7\u00e3o do\ncampo de permeabilidade em n\u00edvel refinado e utiliz\u00e1-la no c\u00e1lculo\nde um campo de press\u00e3o nessa mesma escala a partir de um\ncampo de press\u00e3o calculado em malha grosseira. Por outro lado,\nos m\u00e9todos multiescala tamb\u00e9m apresentam uma semelhan\u00e7a forte\ncom as t\u00e9cnicas de upscaling, uma vez que prop\u00f5em a resolu\u00e7\u00e3o\naproximada do problema original a partir da resolu\u00e7\u00e3o de um\nsistema linear em n\u00edvel grosseiro. No entanto, eles contam com a\nvantagem de promover uma captura do campo de permeabilidade\nmais fidedigna \u00e0 f\u00edsica do problema, especialmente nos casos de\nsimula\u00e7\u00e3o transiente, bem como permitir o c\u00e1lculo de um campo\nde press\u00e3o e velocidade em n\u00edvel refinado ao inv\u00e9s de grosseiro\nsomente, como \u00e9 o caso no upscaling (KIPPE; AARNES; LIE,\n2008).\n\n1.1 MOTIVA\u00c7\u00c3O\n\nDentre os m\u00e9todos multiescala, \u00e9 de especial interesse\no m\u00e9todo dos volumes finitos multiescala - Multiscale Finite\nVolume Method (MsFVM) - o qual foi desenvolvido recentemente\npor Jenny, Lee e Tchelepi (2003). Apesar do nome sugerir que se\ntrata de uma nova alternativa para a discretiza\u00e7\u00e3o de equa\u00e7\u00f5es\ndiferenciais, assim como o m\u00e9todo dos volumes finitos ou elementos\nfinitos, este consiste numa estrat\u00e9gia para a solu\u00e7\u00e3o aproximada\ndas equa\u00e7\u00f5es discretizadas com o m\u00e9todo dos volumes finitos,\nespecialmente da equa\u00e7\u00e3o da press\u00e3o.\n\nO MsFVM pode ser visto como um desenvolvimento na\nlinha das t\u00e9cnicas de upscaling, uma vez que busca uma solu\u00e7\u00e3o\naproximada para o problema discretizado atrav\u00e9s da resolu\u00e7\u00e3o de\num problema grosseiro. As vantagens observadas nesse m\u00e9todo\nsobre t\u00e9cnicas usuais de upscaling s\u00e3o basicamente duas:\n\na) o campo de press\u00e3o calculado a partir desse m\u00e9todo\nconduz a um campo de velocidades conservativo na\nmalha original do problema, isto \u00e9, tal campo obedece\n\n\n\n1.1. Motiva\u00e7\u00e3o 35\n\n\u00e0 lei da conserva\u00e7\u00e3o da massa nesse mesmo n\u00edvel de ma-\nlha. Esta caracter\u00edstica \u00e9 fundamental para a resolu\u00e7\u00e3o\napropriada das equa\u00e7\u00f5es de transporte como aquelas\ndestinadas ao c\u00e1lculo do campo de satura\u00e7\u00f5es em es-\ncoamentos multif\u00e1sicos. Al\u00e9m disso, o sistema linear\nreferente ao n\u00edvel grosseiro \u00e9 atualizado em proble-\nmas transientes, tornando o m\u00e9todo bastante robusto\nespecialmente em problemas altamente heterog\u00eaneos;\n\nb) assim como m\u00e9todos de decomposi\u00e7\u00e3o de dom\u00ednio,\no MsFVM divide o problema original em subproble-\nmas locais que s\u00e3o independentes entre si e podem ser\nresolvidos paralelamente. Isso torna seu algoritmo alta-\nmente suscept\u00edvel ao processamento paralelo. Mesmo\nque seja empregado processamento sequencial, o custo\ncomputacional envolvido na resolu\u00e7\u00e3o desses subpro-\nblemas \u00e9 menor que aquele referente ao problema\noriginal.\n\nNos \u00faltimos anos, produziram-se v\u00e1rios trabalhos com\no intuito de estender a aplica\u00e7\u00e3o do MsFVM a problemas de\nsimula\u00e7\u00e3o de reservat\u00f3rios que apresentam fen\u00f4menos f\u00edsicos di-\nversificados. Nesse sentido, nota-se que a aplica\u00e7\u00e3o desse m\u00e9todo\nem simuladores comerciais bem como seu uso para o tratamento\nde reservat\u00f3rios reais tornam-se cada vez mais em pauta (MANEA;\nSEWALL; TCHELEPI, 2015). Um dos aperfei\u00e7oamentos mais\nsignificativos deu-se com a concep\u00e7\u00e3o da formula\u00e7\u00e3o alg\u00e9brica\ndo m\u00e9todo, assim como sua extens\u00e3o para a esfera de m\u00e9todos\niterativos voltados \u00e0 solu\u00e7\u00e3o do problema de acordo com o n\u00ed-\nvel de precis\u00e3o que se queira. Nesse \u00faltimo contexto, o MsFVM\nd\u00e1 origem aos pr\u00e9-condicionadores multiescala alg\u00e9bricos, que\npossuem diversos par\u00e2metros de configura\u00e7\u00e3o e s\u00e3o empregados\npara a resolu\u00e7\u00e3o de sistemas lineares el\u00edpticos atrav\u00e9s de m\u00e9todos\niterativos.\n\n\n\n36 Cap\u00edtulo 1. Introdu\u00e7\u00e3o\n\n1.2 OBJETIVO GERAL\n\nDadas as vantagens e a relev\u00e2ncia observada pelo MsFVM\nbem como pela sua formula\u00e7\u00e3o alg\u00e9brica como um pr\u00e9-condicionador\nvoltado \u00e0 resolu\u00e7\u00e3o de problemas el\u00edpticos, o presente trabalho\napresenta como objetivo principal a implementa\u00e7\u00e3o computacio-\nnal de ambas estrat\u00e9gias para a resolu\u00e7\u00e3o da equa\u00e7\u00e3o da press\u00e3o\nem simula\u00e7\u00e3o de reservat\u00f3rios altamente heterog\u00eaneos.\n\n1.3 OBJETIVOS ESPEC\u00cdFICOS\n\nDado o foco de estudo, os seguintes objetivos particulares\ns\u00e3o determinados:\n\na) Avaliar o desempenho computacional do c\u00f3digo de-\nsenvolvido para a resolu\u00e7\u00e3o de escoamentos monof\u00e1si-\ncos, bif\u00e1sico e tamb\u00e9m trif\u00e1sicos em malhas estrutu-\nradas. Considera-se aqui tanto a formula\u00e7\u00e3o original\ndo MsFVM para a obten\u00e7\u00e3o de solu\u00e7\u00f5es aproximadas\nassim como o seu uso como um pr\u00e9-condicionador ali-\nado \u00e0 m\u00e9todos iterativos para a obten\u00e7\u00e3o de solu\u00e7\u00f5es\nprecisas.\n\nb) Considerando-se o uso dos m\u00e9todos multiescala como\npr\u00e9-condicionadores de solvers iterativos empregados\nna resolu\u00e7\u00e3o precisa de problemas lineares el\u00edpticos,\navalia-se tamb\u00e9m seu desempenho matem\u00e1tico, isto\n\u00e9, em termos da taxa de converg\u00eancia observada pelo\nm\u00e9todo iterativo resultante.\n\nc) Aferir o melhor uso que pode ser feito dos m\u00e9todos\nmultiescala: como um pr\u00e9-condicionador associado a\nm\u00e9todos iterativos ou como uma t\u00e9cnica de upsca-\nling para a obten\u00e7\u00e3o de uma solu\u00e7\u00e3o aproximada do\nproblema.\n\nd) Encontrar a melhor combina\u00e7\u00e3o poss\u00edvel de par\u00e2metros\npara a defini\u00e7\u00e3o de pr\u00e9-condicionadores multiescala\neficientes.\n\n\n\n1.4. Organiza\u00e7\u00e3o do Trabalho 37\n\ne) Prover uma plataforma unificada para testar diferentes\nestrat\u00e9gias de pr\u00e9-condicionamento e avaliar a melhor\nop\u00e7\u00e3o em termos de taxa de converg\u00eancia, exatid\u00e3o dos\nresultados, tempo computacional e uso de mem\u00f3ria.\n\n1.4 ORGANIZA\u00c7\u00c3O DO TRABALHO\n\nO primeiro cap\u00edtulo desse trabalho buscou contextualiz\u00e1-\nlo na \u00e1rea de simula\u00e7\u00e3o de reservat\u00f3rios e apresentar seu objetivo.\nNo segundo cap\u00edtulo, as equa\u00e7\u00f5es respons\u00e1veis pela modelagem do\nescoamento em reservat\u00f3rios ser\u00e3o apresentadas, bem como seu\nformato discretizado de acordo com o m\u00e9todo dos volumes finitos\ntradicional5. No terceiro cap\u00edtulo ser\u00e3o discutidos os m\u00e9todos\ncomumente empregados para a solu\u00e7\u00e3o das equa\u00e7\u00f5es discretizadas.\nNo quarto cap\u00edtulo apresenta-se a formula\u00e7\u00e3o original do m\u00e9todo\ndos volumes finitos multiescala, que \u00e9 baseada em argumentos de\ncar\u00e1ter f\u00edsico. No quinto cap\u00edtulo, discute-se a formula\u00e7\u00e3o alg\u00e9-\nbrica desse m\u00e9todo bem como os pr\u00e9-condicionadores que podem\nser constru\u00eddos a partir de sua ideia b\u00e1sica. No sexto cap\u00edtulo,\ntais estrat\u00e9gias de solu\u00e7\u00e3o ser\u00e3o testadas em problemas sint\u00e9ticos,\nassim como em um problema padr\u00e3o bastante desafiador, o qual \u00e9\ncomumente empregado no benchmarking de novas t\u00e9cnicas de solu-\n\u00e7\u00e3o. Por fim, no \u00faltimo cap\u00edtulo ser\u00e3o apresentadas as conclus\u00f5es\ndo presente trabalho e sugest\u00f5es para pesquisas futuras.\n\n5 A malha empregada \u00e9 estruturada e o c\u00e1lculo dos fluxos nas fronteiras\ndos volumes de controle \u00e9 feito de acordo com um esquema de dois pontos\n(TPFA).\n\n\n\n\n\n39\n\n2 MODELAGEM MATEM\u00c1TICA E NUM\u00c9RICA\n\nA modelagem matem\u00e1tica do escoamento em reservat\u00f3rios\nde petr\u00f3leo \u00e9 realizada por um conjunto de equa\u00e7\u00f5es diferenci-\nais parciais baseadas nas leis de conserva\u00e7\u00e3o de massa, esp\u00e9cie,\nquantidade de movimento e energia al\u00e9m de rela\u00e7\u00f5es de fecha-\nmento, necess\u00e1rias para que o n\u00famero de inc\u00f3gnitas do modelo\nse iguale ao n\u00famero de equa\u00e7\u00f5es. De modo geral, tais equa\u00e7\u00f5es\ndescrevem as rela\u00e7\u00f5es existentes entre vari\u00e1veis do escoamento\ncomo press\u00e3o, temperatura, satura\u00e7\u00e3o e composi\u00e7\u00e3o das fases em\nfun\u00e7\u00e3o das propriedades f\u00edsicas da rocha-reservat\u00f3rio, dos fluidos\ne das propriedades f\u00edsicas relativas \u00e0 intera\u00e7\u00e3o entre a rocha e os\nfluidos.\n\nDuas grandes classes de modelos podem ser empregadas\nde acordo com o tipo de escoamento presente no reservat\u00f3rio:\ncomposicional e black-oil. Em ambos os modelos, o escoamento\npode apresentar at\u00e9 tr\u00eas fases sendo elas: aquosa, oleosa e gasosa.\nA diferen\u00e7a b\u00e1sica entre essas duas escolhas consiste no n\u00famero\nde informa\u00e7\u00f5es que se deseja obter do escoamento, sendo que os\nmodelos composicionais s\u00e3o mais minuciosos.\n\nNos modelos composicionais (ACS; DOLESCHALL; FAR-\nKAS, 1986; TRANGENSTEIN; BELL, 1989; COATS; THOMAS;\nPIERSON, 1998; QIN; EWING; CHEN, 2000), as fases oleosa\ne gasosa cont\u00e9m diversos hidrocarbonetos de diferentes massas\nmoleculares. \u00c9 de interesse a descri\u00e7\u00e3o detalhada do escoamento\ndesses componentes, isto \u00e9, como eles se propagam ao longo do re-\nservat\u00f3rio bem como o c\u00e1lculo de sua fra\u00e7\u00e3o volum\u00e9trica presente\nnessas fases, realizado atrav\u00e9s de modelos baseados em equil\u00ed-\nbrio termodin\u00e2mico. Os modelos composicionais s\u00e3o largamente\nempregados quando a produ\u00e7\u00e3o de \u00f3leo envolve m\u00e9todos de recu-\npera\u00e7\u00e3o avan\u00e7ada (LAKE, 2010), um exemplo \u00e9 a inje\u00e7\u00e3o de g\u00e1s\ncarb\u00f4nico em determinadas \u00e1reas do reservat\u00f3rio com o intuito\nde armazenar o g\u00e1s e tamb\u00e9m deslocar o \u00f3leo em dire\u00e7\u00e3o a po\u00e7os\nprodutores.\n\nQuando o grau de volatilidade do \u00f3leo \u00e9 baixo, o compor-\ntamento das fases torna-se menos complexo e o uso do modelo\ncomposicional completo deixa de ser necess\u00e1rio para a modelagem\n\n\n\n40 Cap\u00edtulo 2. Modelagem Matem\u00e1tica e Num\u00e9rica\n\nprecisa do escoamento. Nesse caso, o sistema pode ser representado\nem termos do componente \u00e1gua mais dois pseudo-componentes\ncom caracter\u00edstica de hidrocarbonetos, designados por \u00f3leo e g\u00e1s,\no que d\u00e1 origem ao modelo black-oil (AZIZ; SETTARI, 1979).\n\nNa sua forma mais geral, esse modelo permite que todos os\ncomponentes estejam presentes em qualquer uma das fases aquosa,\noleosa ou gasosa. No entanto, aplica\u00e7\u00f5es usuais geralmente n\u00e3o\nrequerem um grau de mobilidade t\u00e3o elevado para os componentes,\nportanto os simuladores de reservat\u00f3rios costumam empregar duas\nvariantes simplificadas do modelo black-oil: padr\u00e3o e vol\u00e1til.\n\nNo black-oil padr\u00e3o, permite-se que somente o componente\ng\u00e1s mude de fase e tal mudan\u00e7a pode ser apenas entre as fases\noleica e gasosa. Naturalmente, as fases aquosa, oleica e gasosa\ns\u00e3o formadas pelos componentes \u00e1gua, \u00f3leo e g\u00e1s. J\u00e1 no modelo\nblack-oil vol\u00e1til, o componente \u00f3leo pode estar presente na fase\ngasosa, al\u00e9m de estar naturalmente presente na fase oleica.\n\nNesse trabalho, emprega-se o modelo black-oil padr\u00e3o\npara a simula\u00e7\u00e3o do escoamento em reservat\u00f3rios de petr\u00f3leo. No\npresente cap\u00edtulo, ser\u00e3o apresentadas as equa\u00e7\u00f5es que comp\u00f5em\ntal modelo bem como simplifica\u00e7\u00f5es que podem ser obtidas no\ncaso de escoamentos bif\u00e1sico e monof\u00e1sico. Informa\u00e7\u00f5es mais deta-\nlhadas a respeito da modelagem do escoamento em reservat\u00f3rios\ne sua resolu\u00e7\u00e3o podem ser encontradas nos trabalhos de (AZIZ;\nSETTARI, 1979; PEACEMAN, 1983; CHEN, 2007).\n\n2.1 ESCOAMENTO TRIF\u00c1SICO\n\nNo modelo black-oil padr\u00e3o, as equa\u00e7\u00f5es que governam o\nescoamento em reservat\u00f3rios s\u00e3o obtidas, basicamente, a partir do\nprinc\u00edpio da conserva\u00e7\u00e3o da quantidade de massa aplicada a cada\num dos componentes verificados no escoamento. \u00c9 importante\nobservar que a massa \u00e9 conservada na fase aquosa, por\u00e9m o mesmo\nn\u00e3o pode ser afirmado para as fases oleosa e gasosa, uma vez\nque o componente g\u00e1s pode transitar entre elas (CHEN, 2007).\nConsiderando que a temperatura do reservat\u00f3rio \u00e9 constante, o\n\n\n\n2.1. Escoamento Trif\u00e1sico 41\n\nconjunto de equa\u00e7\u00f5es que formam o modelo \u00e9 dado a seguir:\n\n?\n\n?t\n(??wSw) = ?\u00b7 (?w~uw) + qw, (2.1a)\n\n?\n\n?t\n(??ooSo) = ?\u00b7 (?oo~uo) + qo, (2.1b)\n\n?\n\n?t\n(? (?goSo + ?gSg)) = ?\u00b7 (?go~uo + ?g~ug) + qg, (2.1c)\n\npcow (Sw) = po ?pw, (2.1d)\n\npcgo (Sg) = pg ?po, (2.1e)\n\nSw + So + Sg = 1. (2.1f)\n\nAo todo, tem-se seis equa\u00e7\u00f5es para o c\u00e1lculo da press\u00e3o e\nsatura\u00e7\u00e3o referentes \u00e0s fases \u00e1gua, \u00f3leo e g\u00e1s, isto \u00e9: Pw; Po; Pg;\nSw; So; Sg. Nas equa\u00e7\u00f5es (2.1a) a (2.1c), a vari\u00e1vel ?? representa a\nmassa espec\u00edfica do componente ? pertencente \u00e0 fase ?, enquanto\n??? refere-se \u00e0 massa espec\u00edfica do componente ? pertencente \u00e0\nfase ?. J\u00e1 a vari\u00e1vel ? denota a porosidade da rocha, a qual pode\nvariar ao longo da simula\u00e7\u00e3o de acordo com a rela\u00e7\u00e3o\n\n? = ?o (1 + cR (p?po)) , (2.2)\n\nem que ?o \u00e9 a porosidade medida na press\u00e3o de refer\u00eancia po\ne cR \u00e9 o fator de compressibilidade da rocha. Na presen\u00e7a de\nefeitos capilares, as fases podem apresentar diferentes valores\npara press\u00e3o no equil\u00edbrio termodin\u00e2mico, tal efeito \u00e9 modelado\npelas press\u00f5es capilares \u00e1gua/\u00f3leo e g\u00e1s/\u00f3leo, de acordo com as\nfun\u00e7\u00f5es (2.1d) e (2.1e), as quais s\u00e3o informadas atrav\u00e9s de tabelas\nem fun\u00e7\u00e3o das satura\u00e7\u00f5es. Por fim, a equa\u00e7\u00e3o (2.1f) realiza o\nfechamento do problema ao impor uma restri\u00e7\u00e3o para o c\u00e1lculo\ndas satura\u00e7\u00f5es.\n\nO primeiro termo do lado direito das equa\u00e7\u00f5es (2.1a) a\n(2.1c) modela o transporte de massa no reservat\u00f3rio por advec\u00e7\u00e3o,\nisso envolve a velocidade da fase que \u00e9 transportada: ~u?. Em\nescoamentos ao longo de meios porosos, esse termo \u00e9 usualmente\n\n\n\n42 Cap\u00edtulo 2. Modelagem Matem\u00e1tica e Num\u00e9rica\n\nescrito como\n\n~u? =\nk?\n\u00b5?\n\n(?p? ???g?z) , ? = w,o,g. (2.3)\n\nEsta \u00e9 chamada por lei de Darcy (DAKE, 1978), a qual pode\nser obtida simplificando-se a lei da conserva\u00e7\u00e3o da quantidade de\nmovimento para o caso de escoamentos a baixas velocidades em\nmeios porosos (hip\u00f3tese de Stokes) (WHITAKER, 1986).\n\nO modelo black-oil padr\u00e3o pode ser tamb\u00e9m escrito em\ntermos de conserva\u00e7\u00e3o volum\u00e9trica, nesse caso as equa\u00e7\u00f5es (2.1a)\na (2.1c) s\u00e3o substitu\u00eddas por:\n\n?\n\n?t\n\n(\n?Sw\nBw\n\n)\n= ?\u00b7 (K?w [?pw ??w?z]) +\n\nqws\nBw\n\n, (2.4a)\n\n?\n\n?t\n\n(\n?So\nBo\n\n)\n= ?\u00b7 (K?o [?po ??o?z]) +\n\nqos\nBw\n\n, (2.4b)\n\n?\n\n?t\n\n[\n?\n\n(\nSg\nBg\n\n+\nRsoSo\nBo\n\n)]\n=\nqgs\nBg\n\n+\nRsoqos\nBo\n\n+ ?\u00b7 (K?g [?pg ??g?z] + RsoK?o [?po ??o?z]) ,\n(2.4c)\n\nem que o tensor K \u00e9 a permeabilidade absoluta da rocha-reservat\u00f3rio\ne a vari\u00e1vel B? \u00e9 denominada fator volume de forma\u00e7\u00e3o da fase\n?, sendo dada por:\n\nBw =\n?ws\n?w\n\n, ?ws = ?w (1 atm, 20 ?C) , (2.5a)\n\nBg =\n?gs\n?g\n, ?gs = ?g (1 atm, 20 ?C) , (2.5b)\n\nBo =\nRso?gs + ?os\n\n?o\n, ?os = ?o (1 atm, 20 ?C) . (2.5c)\n\nNa equa\u00e7\u00e3o (2.5c), Rso representa a raz\u00e3o de solubilidade\ndo componente g\u00e1s na fase \u00f3leo. Esta vari\u00e1vel \u00e9 fun\u00e7\u00e3o da press\u00e3o.\nTal vari\u00e1vel \u00e9 definida como o volume do g\u00e1s, medido nas con-\ndi\u00e7\u00f5es padr\u00e3o de temperatura e press\u00e3o (P = 1 atm,T = 20 ?C),\n\n\n\n2.1. Escoamento Trif\u00e1sico 43\n\ndissolvido em uma unidade volum\u00e9trica de \u00f3leo nas condi\u00e7\u00f5es de\ntemperatura e press\u00e3o do reservat\u00f3rio.\n\nRso =\nVgs\nVos\n\n. (2.6)\n\nPresente no lado direito das equa\u00e7\u00f5es (2.4a) a (2.4c), o\ntermo ?? \u00e9 chamado de mobilidade da fase ?. Este \u00e9 respons\u00e1vel\npor medir a facilidade com que a fase ? escoa no reservat\u00f3rio,\nsendo definido a seguir:\n\n?? =\nkr?\n\u00b5?B?\n\n, (2.7)\n\nem que kr? \u00e9 a permeabilidade relativa \u00e0 fase ? e \u00b5? sua vis-\ncosidade din\u00e2mica. Express\u00f5es t\u00edpicas para as permeabilidade\nrelativas kr? como fun\u00e7\u00e3o da satura\u00e7\u00e3o podem ser encontradas\nem Chen (2007). No presente trabalho, utiliza-se o modelo de\nStone II, descrito no ap\u00eandice A.\n\nPor \u00faltimo, as taxas volum\u00e9tricas nas condi\u00e7\u00f5es padr\u00e3o\nde cada fase s\u00e3o relacionadas com as taxas nas condi\u00e7\u00f5es de\nreservat\u00f3rio da seguinte forma:\n\nqws =\nBwqw\n?ws\n\n, (2.8a)\n\nqos =\nBoqo\n?os\n\n, (2.8b)\n\nqgs =\nBgqg\n?gs\n\n?\nBgRsoqo\n?os\n\n. (2.8c)\n\nAtrav\u00e9s desses termos, \u00e9 poss\u00edvel modelar a a\u00e7\u00e3o de po-\n\u00e7os injetores e produtores em reservat\u00f3rios conforme a seguintes\nequa\u00e7\u00e3o:\n\nq?s =\nNw?\nn=1\n\nMwn?\nm=1\n\nWInm\nkr?\n\u00b5?\n\n[\npnbh ?p? ??? (z\n\nn\nbh ?z)\n\n]\n? (~x?~xnm) ,\n\n? = w,o,g,\n(2.9)\n\n\n\n44 Cap\u00edtulo 2. Modelagem Matem\u00e1tica e Num\u00e9rica\n\nem que, o \u00edndice de po\u00e7o \u00e9 dado por\n\nWInm =\n2?k??h\n\nln (re/rw)\n\n?????\nn\n\nm\n\n; (2.10)\n\n? (~x) \u00e9 a fun\u00e7\u00e3o delta de Dirac; Nw \u00e9 o n\u00famero total de po\u00e7os;\nMwn \u00e9 o n\u00famero total de volumes de controle que o n-\u00e9simo\npo\u00e7o atravessa; ?hnm e ~xnm s\u00e3o o comprimento e a posi\u00e7\u00e3o central\ndo segmento do po\u00e7o que atravessa o volume de controle m; a\nquantidade k?m \u00e9 a permeabilidade absoluta m\u00e9dia do volume m;\nrnw \u00e9 o raio do n-\u00e9simo po\u00e7o; rne,m \u00e9 o raio de drenagem e pnbh \u00e9 a\npress\u00e3o de fundo de po\u00e7o.\n\nDe acordo com o modelo de Peaceman (1983), a perme-\nabilidade m\u00e9dia k?m \u00e9 dada por\n\n?\nk11k22, em que 1 e 2 s\u00e3o as\n\ndire\u00e7\u00f5es perpendiculares ao po\u00e7o. Al\u00e9m disso, o raio de drenagem\nrne,m \u00e9 dado por:\n\nrne,m =\n0.14\n\n?(\nk22\nk11\n\n)\nh21 +\n\n(\nk11\nk22\n\n)\nh22\n\n0.5\n[(\n\nk22\nk11\n\n)1/4\n+\n(\nk11\nk22\n\n)1/4] , (2.11)\nonde considera-se que as completa\u00e7\u00f5es do po\u00e7o interceptam o\ncentro do volume de controle do reservat\u00f3rio.\n\nPor fim, o fechamento do modelo \u00e9 realizado atrav\u00e9s da\nespecifica\u00e7\u00e3o das condi\u00e7\u00f5es de contorno e inicial. As primeiras di-\nzem respeito ao valor da press\u00e3o e das satura\u00e7\u00f5es nas fronteiras do\nreservat\u00f3rio, enquanto a segunda diz respeito \u00e0 distribui\u00e7\u00e3o dessas\nvari\u00e1veis no instante inicial da simula\u00e7\u00e3o. Em geral, adotou-se\nnesse trabalho que as fronteiras do reservat\u00f3rio s\u00e3o imperme\u00e1veis,\nisto \u00e9, a componente normal das derivadas da press\u00e3o e satura\u00e7\u00f5es\ns\u00e3o nulas. Al\u00e9m disso, adotou-se que a distribui\u00e7\u00e3o inicial dos\ncampos de press\u00e3o e satura\u00e7\u00e3o \u00e9 especificada como par\u00e2metro de\nentrada na simula\u00e7\u00e3o.\n\n2.1.1 Discretiza\u00e7\u00e3o das Equa\u00e7\u00f5es\n\nConforme mostrado anteriormente, a modelagem mate-\nm\u00e1tica do escoamento em reservat\u00f3rios envolve a resolu\u00e7\u00e3o de\n\n\n\n2.1. Escoamento Trif\u00e1sico 45\n\nequa\u00e7\u00f5es baseadas em princ\u00edpios de conserva\u00e7\u00e3o. Tais equa\u00e7\u00f5es\ns\u00e3o do tipo diferencial, isto \u00e9, envolvem derivadas das pr\u00f3prias\ninc\u00f3gnitas que se deseja encontrar. Em geral, elas n\u00e3o podem ser\nresolvidas analiticamente, portanto recorre-se a m\u00e9todos num\u00e9ri-\ncos para a obten\u00e7\u00e3o da sua solu\u00e7\u00e3o aproximada.\n\nDiversos m\u00e9todos num\u00e9ricos podem ser empregados na\nsimula\u00e7\u00e3o de reservat\u00f3rios, o mais antigo e primeiro a ser utili-\nzado na constru\u00e7\u00e3o de simuladores foi o m\u00e9todo das diferen\u00e7as\nfinitas - Finite Difference Method (FDM) (AZIZ; SETTARI, 1979;\nPEACEMAN, 1977). Este prop\u00f5e aproxima\u00e7\u00f5es para as derivadas\nde primeira e segunda ordem das inc\u00f3gnitas presentes no modelo\nem fun\u00e7\u00e3o de seus valores em determinados pontos ao longo da\nmalha. Sua grande vantagem est\u00e1 na versatilidade em apresentar\naproxima\u00e7\u00f5es com diferentes graus de precis\u00e3o, o que \u00e9 realizado\nde acordo com o n\u00famero de pontos utilizados no c\u00e1lculo das de-\nrivadas. No entanto, o m\u00e9todo carece de um apelo f\u00edsico, pois a\nsolu\u00e7\u00e3o que \u00e9 proposta por ele n\u00e3o atende, em geral, aos princ\u00edpios\nde conserva\u00e7\u00e3o, caracter\u00edstica altamente desej\u00e1vel para a solu\u00e7\u00e3o\nde problemas de car\u00e1ter hiperb\u00f3lico como \u00e9 o caso das equa\u00e7\u00f5es\nenvolvendo satura\u00e7\u00e3o. Al\u00e9m disso, sua aplica\u00e7\u00e3o se restringe a\nmalhas estruturadas e de geometrias simples.\n\nLargamente aplicado em problemas estruturais como na\ngeomec\u00e2nica, os m\u00e9todos baseados em elementos finitos - Finite\nElement Method (FEM) - tamb\u00e9m podem ser empregados na\nsimula\u00e7\u00e3o do escoamento em reservat\u00f3rios (CHEN; HUAN; MA,\n2006). Na sua formula\u00e7\u00e3o mais comum, baseada em Galerkin, as\nequa\u00e7\u00f5es diferenciais s\u00e3o reescritas na forma fraca e sua solu\u00e7\u00e3o \u00e9\naproximada segundo um conjunto de fun\u00e7\u00f5es bases cont\u00ednuas no\nespa\u00e7o. Em rela\u00e7\u00e3o ao FDM, o FEM apresenta maior versatilidade\na respeito dos tipos de malhas e geometria do reservat\u00f3rio que\ns\u00e3o suportados, o que estimula seu uso em casos de reservat\u00f3rios\ncomplexos. No entanto, assim como o FDM, o m\u00e9todo n\u00e3o observa\nos princ\u00edpios de conserva\u00e7\u00e3o. Outras formula\u00e7\u00f5es do FEM como\na mista - Mixed Finite Element Method (MixedFEM) (ARNOLD,\n1990) - ou a baseada em Galerkin descont\u00ednuo - Discontinuous\nGalerkin (ARNOLD et al., 2002) - atendem ao princ\u00edpio da con-\nserva\u00e7\u00e3o local, no entanto isso \u00e9 alcan\u00e7ado \u00e0s custas de maior\n\n\n\n46 Cap\u00edtulo 2. Modelagem Matem\u00e1tica e Num\u00e9rica\n\nn\u00famero e complexidade de equa\u00e7\u00f5es referentes ao modelo discreto.\nM\u00e9todos baseados em volumes finitos - Finite Volume\n\nMethod (FVM) - receberam bastante aten\u00e7\u00e3o e hoje s\u00e3o utili-\nzados pela maioria dos simuladores comerciais de reservat\u00f3rios.\nEssa classe de m\u00e9todos tem como caracter\u00edstica fundamental a\nobserv\u00e2ncia dos princ\u00edpios de conserva\u00e7\u00e3o em n\u00edvel discreto, os\nquais s\u00e3o atendido atrav\u00e9s do c\u00e1lculo apropriado de fluxos de\nmassa, quantidade de movimento e energia atrav\u00e9s das interfaces\ndos volumes de controle que comp\u00f5em a malha computacional.\nAl\u00e9m disso, tais m\u00e9todos permitem a resolu\u00e7\u00e3o do escoamento\nem reservat\u00f3rios com geometrias complexas. Em sua formula\u00e7\u00e3o\ntradicional, o m\u00e9todo dos volumes finitos \u00e9 restrito a malhas de to-\npologia estruturada ou semi-estruturada1, nesse sentido \u00e9 comum\no emprego de malhas do tipo corner-point (POINTING, 1989).\nRecentemente, o FVM foi estendido para malhas n\u00e3o-estruturadas\natrav\u00e9s da sua formula\u00e7\u00e3o baseada em elementos (FORSYTH,\n1990; MALISKA, 2004) - Element Based Finite Volume Method\n(EbFVM) - o que conferiu ainda maior versatilidade \u00e0 essa classe\nde m\u00e9todos para o tratamento de reservat\u00f3rios que exibam aspec-\ntos f\u00edsicos mais avan\u00e7ados como aqueles apresentando falhas ou\nfraturas.\n\nPelo fato de ser o m\u00e9todo mais difundido em simula\u00e7\u00e3o\nde reservat\u00f3rios e tamb\u00e9m atender ao princ\u00edpio da conserva\u00e7\u00e3o\nde massa em n\u00edvel local, emprega-se nesse trabalho o m\u00e9todo\ndos volumes finitos tradicional no processo de discretiza\u00e7\u00e3o das\nequa\u00e7\u00f5es diferenciais. Para tanto, ser\u00e1 utilizada a implementa\u00e7\u00e3o\nnum\u00e9rica contida no pacote MRST - Matlab Reservoir Simulation\nToolkit - cuja valida\u00e7\u00e3o computacional pode ser verificada nos\ntrabalhos escritos por Lie et al. (2012) e Krogstad et al. (2015).\n\nConsiderando-se que o tensor permeabilidade \u00e9 diago-\nnal, isto \u00e9 K = diag (K11,K22,K33), as equa\u00e7\u00f5es (2.4a) a (2.4c)\n\n1 Quando h\u00e1 liga\u00e7\u00f5es com n\u00e3o-vizinhos - Non-Neighbour Connections\n(NNC); refinamento local da malha - Local Grid Refinement (LGR) -\ne c\u00e9lulas de volume nulo (pinch-outs).\n\n\n\n2.1. Escoamento Trif\u00e1sico 47\n\npodem ser escritas da seguinte forma:\n\n?\n\n?t\n\n(\n?Sw\nBw\n\n)\n=\n\n?\n\n?x1\n\n[\nK11?w\n\n(\n?pw\n?x1\n??w\n\n?z\n\n?x1\n\n)]\n+\n\n?\n\n?x2\n\n[\nK22?w\n\n(\n?pw\n?x2\n??w\n\n?z\n\n?x2\n\n)]\n+\n\n?\n\n?x3\n\n[\nK33?w\n\n(\n?pw\n?x3\n??w\n\n?z\n\n?x3\n\n)]\n+ q?ws,\n\n(2.12)\n\n?\n\n?t\n\n(\n?So\nBo\n\n)\n=\n\n?\n\n?x1\n\n[\nK11?o\n\n(\n?po\n?x1\n??o\n\n?z\n\n?x1\n\n)]\n+\n\n?\n\n?x2\n\n[\nK22?o\n\n(\n?po\n?x2\n??o\n\n?z\n\n?x2\n\n)]\n+\n\n?\n\n?x3\n\n[\nK33?g\n\n(\n?po\n?x3\n??o\n\n?z\n\n?x3\n\n)]\n+ q?os,\n\n(2.13)\n\n?\n\n?t\n\n[\n?\n\n(\nSg\nBg\n\n+\nRsoSo\nBo\n\n)]\n=\n\n?\n\n?x1\n\n[\nK11?g\n\n(\n?pg\n?x1\n??g\n\n?z\n\n?x1\n\n)]\n+\n\n?\n\n?x2\n\n[\nK22?g\n\n(\n?pg\n?x2\n??g\n\n?z\n\n?x2\n\n)]\n+\n\n?\n\n?x3\n\n[\nK33?g\n\n(\n?pg\n?x3\n??g\n\n?z\n\n?x3\n\n)]\n+\n\n?\n\n?x1\n\n[\nK11Rso?o\n\n(\n?po\n?x1\n??o\n\n?z\n\n?x1\n\n)]\n+\n\n?\n\n?x2\n\n[\nK22Rso?o\n\n(\n?po\n?x2\n??o\n\n?z\n\n?x2\n\n)]\n+\n\n?\n\n?x3\n\n[\nK33Rso?o\n\n(\n?pg\n?x3\n??o\n\n?z\n\n?x3\n\n)]\n+ q?gs.\n\n(2.14)\n\nAs vari\u00e1veis presentes nas equa\u00e7\u00f5es anteriores s\u00e3o fun\u00e7\u00f5es\ndo tempo e espa\u00e7o, portanto \u00e9 necess\u00e1rio que esquemas de dis-\ncretiza\u00e7\u00e3o nessas dimens\u00f5es sejam empregados. Com rela\u00e7\u00e3o \u00e0\ndiscretiza\u00e7\u00e3o no tempo, diversas formula\u00e7\u00f5es num\u00e9ricas est\u00e3o dis-\npon\u00edveis, entre as mais empregadas est\u00e3o a formula\u00e7\u00e3o totalmente\n\n\n\n48 Cap\u00edtulo 2. Modelagem Matem\u00e1tica e Num\u00e9rica\n\nimpl\u00edcita (FIM), impl\u00edcita na press\u00e3o e expl\u00edcita na satura\u00e7\u00e3o\n(IMPES) e adaptativa impl\u00edcita (AIM).\n\nNa formula\u00e7\u00e3o totalmente impl\u00edcita - Fully Implicit Method\n(FIM) (DOUGLAS; PEACEMAN; JR., 1959) - as propriedades\nda rocha e dos fluidos s\u00e3o avaliadas no tempo atual e o sistema de\nequa\u00e7\u00f5es discretizadas s\u00e3o resolvidas simultaneamente. As vari\u00e1-\nveis obtidas diretamente atrav\u00e9s da solu\u00e7\u00e3o dessas equa\u00e7\u00f5es s\u00e3o\ndenominadas como prim\u00e1rias. Esta \u00e9 uma formula\u00e7\u00e3o bastante\nrobusta e sua estabilidade depende fundamentalmente do controle\ndas n\u00e3o-linearidades presentes no sistema, no entanto, ela requer o\nuso de pr\u00e9-condicionadores projetados de acordo com o problema\nresolvido para que a solu\u00e7\u00e3o das equa\u00e7\u00f5es possa ser encontrada\nde modo eficiente em termos computacionais.\n\nA formula\u00e7\u00e3o impl\u00edcita na press\u00e3o e expl\u00edcita na satu-\nra\u00e7\u00e3o - IMplicit Pressure Explicit Saturation (IMPES) (AZIZ;\nSETTARI, 1979) - \u00e9 baseada no desacoplamento entre as vari\u00e1-\nveis press\u00e3o e satura\u00e7\u00e3o. A vari\u00e1vel press\u00e3o \u00e9 resolvida atrav\u00e9s da\nsolu\u00e7\u00e3o de um sistema linear, assumindo-se que as propriedades\ndos fluidos dependentes da satura\u00e7\u00e3o s\u00e3o avaliadas de acordo com\na satura\u00e7\u00e3o relativa ao passo de tempo anterior, enquanto que as\npropriedades que s\u00e3o fun\u00e7\u00e3o da press\u00e3o s\u00e3o avaliadas de acordo\ncom o valor referente \u00e0 \u00faltima itera\u00e7\u00e3o do m\u00e9todo de Newton.\nEm seguida, a vari\u00e1vel satura\u00e7\u00e3o \u00e9 atualizada explicitamente, isto\n\u00e9, atrav\u00e9s da simples multiplica\u00e7\u00e3o de uma matriz por um vetor.\nEsse procedimento \u00e9 repetido a cada passo de tempo e tamb\u00e9m\na cada itera\u00e7\u00e3o do m\u00e9todo de Newton conforme um crit\u00e9rio de\nconverg\u00eancia.\n\nPor \u00faltimo, a formula\u00e7\u00e3o adaptativa impl\u00edcita -Adaptative\nImplicit Method (AIM) (THOMAS; THURNAU, 1983) - \u00e9 uma\nmistura das duas \u00faltimas. A motiva\u00e7\u00e3o fundamental dessa abor-\ndagem consiste no fato de que as vari\u00e1veis referentes a diferentes\nvolumes de controle da malha est\u00e3o sujeitas a varia\u00e7\u00f5es distintas\nao longo do tempo. Caso tais varia\u00e7\u00f5es sejam menores que uma\ndada toler\u00e2ncia, que \u00e9 fun\u00e7\u00e3o da vari\u00e1vel prim\u00e1ria em considera-\n\u00e7\u00e3o, o c\u00e1lculo de satura\u00e7\u00f5es ou composi\u00e7\u00f5es pode ser realizado\nexplicitamente. As vantagens dessa formula\u00e7\u00e3o consistem na re-\ndu\u00e7\u00e3o do tamanho do sistema alg\u00e9brico a ser resolvido em rela\u00e7\u00e3o\n\n\n\n2.1. Escoamento Trif\u00e1sico 49\n\n\u00e0 formula\u00e7\u00e3o totalmente impl\u00edcita e tamb\u00e9m no aumento de es-\ntabilidade em rela\u00e7\u00e3o \u00e0 formula\u00e7\u00e3o IMPES (FUNG; COLLINS;\nNGHIEM, 1989; WATTS; SHAW, 2005; BO; WHEELER, 2009).\n\n\u00c9 importante observar que em qualquer uma das formu-\nla\u00e7\u00f5es discutidas, \u00e9 necess\u00e1rio que se resolva uma equa\u00e7\u00e3o de\ncar\u00e1ter el\u00edptico. Isso \u00e9 v\u00e1lido at\u00e9 mesmo no caso da formula-\n\u00e7\u00e3o totalmente impl\u00edcita, porque nesse caso \u00e9 comum o emprego\nde pr\u00e9-condicionadores que desacoplam os diferentes fen\u00f4menos\nf\u00edsicos modelados pelo sistema linear obtido no processo de dis-\ncretiza\u00e7\u00e3o. Os problemas tratados no cap\u00edtulo de resultados s\u00e3o\nresolvidos a partir das formula\u00e7\u00f5es impl\u00edcita e IMPES. Nessa\nse\u00e7\u00e3o, apresenta-se somente a discretiza\u00e7\u00e3o espacial e temporal\ndas equa\u00e7\u00f5es discretizadas pela primeira formula\u00e7\u00e3o. O segundo\ncaso pode ser obtido a partir do primeiro, por\u00e9m, se o leitor deseja\nobter mais informa\u00e7\u00f5es a respeito desse caso, este \u00e9 referido para\no trabalho de Chen (2007).\n\nSe h\u00e1 presen\u00e7a de g\u00e1s livre no reservat\u00f3rio, isto \u00e9 Sg 6= 0,\ndiz-se que o reservat\u00f3rio encontra-se em estado saturado, caso con-\ntr\u00e1rio, todo g\u00e1s encontra-se dissolvido na fase \u00f3leo e o reservat\u00f3rio\nencontra-se em estado subsaturado. As vari\u00e1veis prim\u00e1rias que\nser\u00e3o resolvidas atrav\u00e9s das equa\u00e7\u00f5es (2.12) a (2.14) s\u00e3o distintas\nde acordo com o estado do reservat\u00f3rio. Vari\u00e1veis secund\u00e1rias s\u00e3o\nobtidas sem a necessidade de resolu\u00e7\u00e3o de sistemas alg\u00e9bricos e\ndiretamente a partir das vari\u00e1veis prim\u00e1rias.\n\nNo caso de estado saturado, as vari\u00e1veis prim\u00e1rias s\u00e3o\n(p = po,Sw,So), enquanto as vari\u00e1veis secund\u00e1rias s\u00e3o obtidas da\nseguinte maneira:\n\nSg = 1 ?Sw ?So, (2.15a)\npw = po ?pcow (Sw) , (2.15b)\npg = po + pcgo (Sg) . (2.15c)\n\nA t\u00edtulo de simplificar a express\u00e3o discreta, define-se a\ntransmissibilidade da seguinte maneira:\n\nT??d =\nAdKdd??\n\nhd\n, d = 1,2,3; ? = w,o,g. (2.16)\n\n\n\n50 Cap\u00edtulo 2. Modelagem Matem\u00e1tica e Num\u00e9rica\n\nConsiderando aproxima\u00e7\u00e3o de segunda ordem no espa\u00e7o e primeira\nordem no tempo, a discretiza\u00e7\u00e3o das equa\u00e7\u00f5es (2.12) a (2.14) \u00e9\ndada por:\n\n?VP\n?t\n\n[(\n?Sw\nBw\n\n)n+1\n?\n(\n?Sw\nBw\n\n)n]\nP\n\n=\n\nT?n+1w1,e\n\n(\npn+1E ?p\n\nn+1\nP\n\n)\n? T?n+1w1,w\n\n(\npn+1P ?p\n\nn+1\nW\n\n)\n+T?n+1w2,n\n\n(\npn+1N ?p\n\nn+1\nP\n\n)\n? T?n+1w2,s\n\n(\npn+1P ?p\n\nn+1\nS\n\n)\n+T?n+1w3,t\n\n(\npn+1T ?p\n\nn+1\nP\n\n)\n? T?n+1w3,b\n\n(\npn+1P ?p\n\nn+1\nB\n\n)\n?T?n+1w1,e\n\n(\npn+1cow,E ?p\n\nn+1\ncow,P\n\n)\n+ T?n+1w1,w\n\n(\npn+1cow,P ?p\n\nn+1\ncow,W\n\n)\n?T?n+1w2,n\n\n(\npn+1cow,N ?p\n\nn+1\ncow,P\n\n)\n+ T?n+1w2,s\n\n(\npn+1cow,P ?p\n\nn+1\ncow,S\n\n)\n?T?n+1w3,t\n\n(\npn+1cow,T ?p\n\nn+1\ncow,P\n\n)\n+ T?n+1w3,b\n\n(\npn+1cow,P ?p\n\nn+1\ncow,B\n\n)\n?\n(\nT?w1?w\n\n)n+1\ne\n\n(zE ?zP ) +\n(\nT?w1?w\n\n)n+1\nw\n\n(zP ?zW )\n\n?\n(\nT?w2?w\n\n)n+1\nn\n\n(zN ?zP ) +\n(\nT?w2?w\n\n)n+1\ns\n\n(zP ?zS)\n\n?\n(\nT?w3?w\n\n)n+1\nt\n\n(zT ?zP ) +\n(\nT?w3?w\n\n)n+1\nb\n\n(zP ?zB) + q?n+1w,P ?VP ;\n(2.17)\n\n?VP\n?t\n\n[(\n?So\nBo\n\n)n+1\n?\n(\n?So\nBo\n\n)n]\nP\n\n=\n\nT?n+1o1,e\n\n(\npn+1E ?p\n\nn+1\nP\n\n)\n? T?n+1o1,w\n\n(\npn+1P ?p\n\nn+1\nW\n\n)\n+T?n+1o2,n\n\n(\npn+1N ?p\n\nn+1\nP\n\n)\n? T?n+1o2,s\n\n(\npn+1P ?p\n\nn+1\nS\n\n)\n+T?n+1o3,t\n\n(\npn+1T ?p\n\nn+1\nP\n\n)\n? T?n+1o3,b\n\n(\npn+1P ?p\n\nn+1\nB\n\n)\n?\n(\nT?o1?o\n\n)n+1\ne\n\n(zE ?zP ) +\n(\nT?o1?o\n\n)n+1\nw\n\n(zP ?zW )\n\n?\n(\nT?o2?o\n\n)n+1\nn\n\n(zN ?zP ) +\n(\nT?o2?o\n\n)n+1\ns\n\n(zP ?zS)\n\n?\n(\nT?o3?o\n\n)n+1\nt\n\n(zT ?zP ) +\n(\nT?o3?o\n\n)n+1\nb\n\n(zP ?zB) + q?n+1o,P ?VP ;\n(2.18)\n\n\n\n2.1. Escoamento Trif\u00e1sico 51\n\n?VP\n?t\n\n?\n?(?Sg\n\nBg\n+\n?RsoSo\nBo\n\n)n+1\n?\n(\n?Sg\nBg\n\n+\n?RsoSo\nBo\n\n)n??\nP\n\n=\n\nT?n+1g1,e\n\n(\npn+1E ?p\n\nn+1\nP\n\n)\n? T?n+1g1,w\n\n(\npn+1P ?p\n\nn+1\nW\n\n)\n+T?n+1g2,n\n\n(\npn+1N ?p\n\nn+1\nP\n\n)\n? T?n+1g2,s\n\n(\npn+1P ?p\n\nn+1\nS\n\n)\n+T?n+1g3,t\n\n(\npn+1T ?p\n\nn+1\nP\n\n)\n? T?n+1g3,b\n\n(\npn+1P ?p\n\nn+1\nB\n\n)\n+T?n+1g1,e\n\n(\npn+1cgo,E ?p\n\nn+1\ncgo,P\n\n)\n? T?n+1g1,w\n\n(\npn+1cgo,P ?p\n\nn+1\ncgo,W\n\n)\n+T?n+1g2,n\n\n(\npn+1cgo,N ?p\n\nn+1\ncgo,P\n\n)\n? T?n+1g2,s\n\n(\npn+1cgo,P ?p\n\nn+1\ncgo,S\n\n)\n+T?n+1g3,t\n\n(\npn+1cgo,T ?p\n\nn+1\ncgo,P\n\n)\n? T?n+1g3,b\n\n(\npn+1cgo,P ?p\n\nn+1\ncgo,B\n\n)\n+\n(\nRsoT?o1\n\n)n+1\ne\n\n(\npn+1E ?p\n\nn+1\nP\n\n)\n?\n(\nRsoT?g1\n\n)n+1\nw\n\n(\npn+1P ?p\n\nn+1\nW\n\n)\n+\n(\nRsoT?o2\n\n)n+1\nn\n\n(\npn+1N ?p\n\nn+1\nP\n\n)\n?\n(\nRsoT?g2\n\n)n+1\ns\n\n(\npn+1P ?p\n\nn+1\nS\n\n)\n+\n(\nRsoT?o3\n\n)n+1\nt\n\n(\npn+1T ?p\n\nn+1\nP\n\n)\n?\n(\nRsoT?g3\n\n)n+1\nb\n\n(\npn+1P ?p\n\nn+1\nB\n\n)\n?\n(\nT?g1?g + RsoT?o1?o\n\n)n+1\ne\n\n(zE ?zP )\n\n+\n(\nT?g1?g + RsoT?o1?o\n\n)n+1\nw\n\n(zP ?zW )\n\n?\n(\nT?g2?g + RsoT?o2?o\n\n)n+1\nn\n\n(zN ?zP )\n\n+\n(\nT?g2?g + RsoT?o2?o\n\n)n+1\ns\n\n(zP ?zS)\n\n?\n(\nT?g3?g + RsoT?o3?o\n\n)n+1\nt\n\n(zT ?zP )\n\n+\n(\nT?g3?g + RsoT?o3?o\n\n)n+1\nb\n\n(zP ?zB)\n\n+q?n+1g,P ?VP .\n(2.19)\n\nNo c\u00e1lculo das transmissibilidades nas faces dos volumes\nde controle, \u00e9 necess\u00e1rio o uso de algum esquema de interpola\u00e7\u00e3o,\numa vez que os valores das inc\u00f3gnitas do sistema representam\nvalores m\u00e9dios ao longo desses volumes. Cada termo que comp\u00f5e\na transmissibilidade \u00e9 calculada de maneira distinta: a perme-\n\n\n\n52 Cap\u00edtulo 2. Modelagem Matem\u00e1tica e Num\u00e9rica\n\nabilidade absoluta da rocha e as propriedades dos fluidos s\u00e3o\ncalculadas a partir das m\u00e9dia harm\u00f4nica e aritm\u00e9tica, respectiva-\nmente, entre os valores relativos aos volumes que compartilham a\nmesma face. Enquanto isso, a permeabilidade relativa \u00e9 calculada\na partir do esquema upwind.\n\nAs equa\u00e7\u00f5es (2.17) a (2.19) s\u00e3o n\u00e3o-lineares, pois seus\ncoeficientes dependem das pr\u00f3prias inc\u00f3gnitas que se deseja encon-\ntrar. Tais equa\u00e7\u00f5es s\u00e3o comumente resolvidas atrav\u00e9s de um pro-\ncesso de lineariza\u00e7\u00e3o, conforme proposto pelo m\u00e9todo de Newton-\nRaphson2. Em cada itera\u00e7\u00e3o do m\u00e9todo, as vari\u00e1veis prim\u00e1rias\nreferentes ao passo de tempo n + 1 do volume de controle P s\u00e3o\nescritas como\n\npl+1P = p\nl\nP + ?p\n\nl+1\nP ; (2.20a)\n\nSl+1w,P = S\nl\nw,P + ?S\n\nl+1\nw,P ; (2.20b)\n\nSl+1o,P = S\nl\no,P + ?S\n\nl+1\no,P , (2.20c)\n\nem que o \u00edndice n + 1 foi omitido propositalmente, a t\u00edtulo de\neconomia de nota\u00e7\u00e3o. Os res\u00edduos das equa\u00e7\u00f5es (2.17) a (2.19)\n\n2 Recentemente, o multigrid n\u00e3o-linear - Full Approximation Scheme (FAS)\n- (HENSON, 2003) e o m\u00e9todo de Newton inexato precondicionado com o\nm\u00e9todo Schwarz aditivo (ASPIN) (SUN; KEYES; LIU, 2013) t\u00eam recebido\nbastante aten\u00e7\u00e3o como alternativas para o m\u00e9todo de Newton tradicional.\n\n\n\n2.1. Escoamento Trif\u00e1sico 53\n\ns\u00e3o escritos como:\n\nRlw,P =\n?VP\n?t\n\n[(\n?Sw\nBw\n\n)l\n?\n(\n?Sw\nBw\n\n)n]\nP\n\n?T? lw1,e\n(\nplE ?p\n\nl\nP\n\n)\n+ T? lw1,w\n\n(\nplP ?p\n\nl\nW\n\n)\n?T? lw2,n\n\n(\nplN ?p\n\nl\nP\n\n)\n+ T? lw2,s\n\n(\nplP ?p\n\nl\nS\n\n)\n?T? lw3,t\n\n(\nplT ?p\n\nl\nP\n\n)\n+ T? lw3,b\n\n(\nplP ?p\n\nl\nB\n\n)\n+T?n+1w1,e\n\n(\npn+1cow,E ?p\n\nn+1\ncow,P\n\n)\n? T?n+1w1,w\n\n(\npn+1cow,P ?p\n\nn+1\ncow,W\n\n)\n+T?n+1w2,n\n\n(\npn+1cow,N ?p\n\nn+1\ncow,P\n\n)\n? T?n+1w2,s\n\n(\npn+1cow,P ?p\n\nn+1\ncow,S\n\n)\n+T?n+1w3,t\n\n(\npn+1cow,T ?p\n\nn+1\ncow,P\n\n)\n? T?n+1w3,b\n\n(\npn+1cow,P ?p\n\nn+1\ncow,B\n\n)\n+\n(\nT?w1?w\n\n)n+1\ne\n\n(zE ?zP ) ?\n(\nT?w1?w\n\n)n+1\nw\n\n(zP ?zW )\n\n+\n(\nT?w2?w\n\n)n+1\nn\n\n(zN ?zP ) ?\n(\nT?w2?w\n\n)n+1\ns\n\n(zP ?zS)\n\n+\n(\nT?w3?w\n\n)n+1\nt\n\n(zT ?zP ) ?\n(\nT?w3?w\n\n)n+1\nb\n\n(zP ?zB)\n\n?q?n+1w,P ?VP ;\n(2.21)\n\nRlo,P =\n?VP\n?t\n\n[(\n?So\nBo\n\n)l\n?\n(\n?So\nBo\n\n)n]\nP\n\n?T? lo1,e\n(\npn+1E ?p\n\nn+1\nP\n\n)\n+ T?n+1o1,w\n\n(\nplP ?p\n\nn+1\nW\n\n)\n?T? lo2,n\n\n(\npn+1N ?p\n\nn+1\nP\n\n)\n+ T?n+1o2,s\n\n(\nplP ?p\n\nn+1\nS\n\n)\n?T? lo3,t\n\n(\npn+1T ?p\n\nn+1\nP\n\n)\n+ T?n+1o3,b\n\n(\nplP ?p\n\nn+1\nB\n\n)\n+\n(\nT?o1?o\n\n)l\ne\n\n(zE ?zP ) ?\n(\nT?o1?o\n\n)l\nw\n\n(zP ?zW )\n\n+\n(\nT?o2?o\n\n)l\nn\n\n(zN ?zP ) ?\n(\nT?o2?o\n\n)l\ns\n\n(zP ?zS)\n\n+\n(\nT?o3?o\n\n)l\nt\n(zT ?zP ) ?\n\n(\nT?o3?o\n\n)l\nb\n(zP ?zB) ? q?n+1o,P ?VP ;\n\n(2.22)\n\n\n\n54 Cap\u00edtulo 2. Modelagem Matem\u00e1tica e Num\u00e9rica\n\nRlg,P =\n?VP\n?t\n\n?\n?(?Sg\n\nBg\n+\n?RsoSo\nBo\n\n)l\n?\n(\n?Sg\nBg\n\n+\n?RsoSo\nBo\n\n)n??\nP\n\n?\n(\nT?g1 + RsoT?o1\n\n)l\ne\n\n(\nplE ?p\n\nl\nP\n\n)\n+\n(\nT?g1 + RsoT?o1\n\n)l\nw\n\n(\nplP ?p\n\nl\nW\n\n)\n?\n(\nT?g1 + RsoT?o1\n\n)l\nn\n\n(\nplN ?p\n\nl\nP\n\n)\n+\n(\nT?g1 + RsoT?o1\n\n)l\ns\n\n(\nplP ?p\n\nl\nS\n\n)\n?\n(\nT?g1 + RsoT?o1\n\n)l\nt\n\n(\nplT ?p\n\nl\nP\n\n)\n+\n(\nT?g1 + RsoT?o1\n\n)l\nb\n\n(\nplP ?p\n\nl\nB\n\n)\n?T? lg1,e\n\n(\npn+1cgo,E ?p\n\nl\ncgo,P\n\n)\n+ T? lg1,w\n\n(\nplcgo,P ?p\n\nl\ncgo,W\n\n)\n?T? lg2,n\n\n(\npn+1cgo,N ?p\n\nl\ncgo,P\n\n)\n+ T? lg2,s\n\n(\nplcgo,P ?p\n\nl\ncgo,S\n\n)\n?T? lg3,t\n\n(\npn+1cgo,T ?p\n\nl\ncgo,P\n\n)\n+ T? lg3,b\n\n(\nplcgo,P ?p\n\nl\ncgo,B\n\n)\n+\n(\nT?g1?g + RsoT?o1?o\n\n)l\ne\n\n(zE ?zP )\n\n?\n(\nT?g1?g + RsoT?o1?o\n\n)l\nw\n\n(zP ?zW )\n\n+\n(\nT?g2?g + RsoT?o2?o\n\n)l\nn\n\n(zN ?zP )\n\n?\n(\nT?g2?g + RsoT?o2?o\n\n)l\ns\n\n(zP ?zS)\n\n+\n(\nT?g3?g + RsoT?o3?o\n\n)l\nt\n(zT ?zP )\n\n?\n(\nT?g3?g + RsoT?o3?o\n\n)l\nb\n(zP ?zB)\n\n?q?lg,P ?VP ,\n(2.23)\n\nos quais s\u00e3o agrupados no vetor de res\u00edduos referente ao volume\nde controle P como:\n\n~RlP =\n\n?\n??R\n\nl\nw,P\n\nRlo,P\nRlg,P\n\n?\n?? . (2.24)\n\nAgrupando-se as vari\u00e1veis pP ,Sw,P e So,P no vetor\n\n~xP =\n\n?\n?? pPSw,P\nSo,P\n\n?\n?? , (2.25)\n\n\n\n2.1. Escoamento Trif\u00e1sico 55\n\nsegue que a aplica\u00e7\u00e3o de uma itera\u00e7\u00e3o do m\u00e9todo de Newton-\nRaphson no sistema de equa\u00e7\u00f5es (2.17) a (2.19) gera um sistema\nlinear em termos da vari\u00e1vel ?~xl+1 cuja equa\u00e7\u00e3o referente ao\nvolume de controle P \u00e9 dada por:\n\n?~RlP =\n? ~RlP\n?~xW\n\n?~xl+1W +\n? ~RlP\n?~xS\n\n?~xl+1S\n\n+\n? ~RlP\n?~xB\n\n?~xl+1B +\n? ~RlP\n?~xP\n\n?~xl+1P\n\n+\n? ~RlE\n?~xE\n\n?~xl+1E +\n? ~RlP\n?~xN\n\n?~xl+1N +\n? ~RlP\n?~xT\n\n?~xl+1T ,\n\n(2.26)\n\nem que\n\n? ~RP\n?~xP\n\n=\n\n?\n??????????\n\n?Rw\n?p\n\n?Rw\n?So\n\n?Rw\n?Sw\n\n?Ro\n?p\n\n?Ro\n?So\n\n?Ro\n?Sw\n\n?Rg\n?p\n\n?Rg\n?So\n\n?Rg\n?Sw\n\n?\n??????????\nP\n\n. (2.27)\n\nNo caso 3D, a matriz de coeficientes gerada por (2.26) tem\nstencil de sete pontos conforme mostrado na figura3 1, enquanto\nque no caso 2D, o stencil \u00e9 de cinco pontos.\n\nEscrevendo-se a equa\u00e7\u00e3o (2.26) para todos os volumes de\ncontrole, obt\u00e9m-se a matriz jacobiana J, ilustrada na figura 2. \u00c9\nimportante observar que essa matriz \u00e9 composta por blocos de\ntamanho 3 \u00d7 3, referentes \u00e0s vari\u00e1veis press\u00e3o e satura\u00e7\u00f5es das\nfases \u00e1gua e \u00f3leo.\n\nResolvendo-se o sistema linear induzido pela matriz jaco-\nbiana\n\nJ ?~xl+1 = ?~Rl, (2.28)\n\nobt\u00e9m-se o vetor de corre\u00e7\u00f5es ?~xl+1, o qual \u00e9 utilizado para\natualizar o valor das vari\u00e1veis prim\u00e1rias em rela\u00e7\u00e3o \u00e0 \u00faltima\n3 As figuras elaboradas pelo pr\u00f3prio autor n\u00e3o receber\u00e3o legenda daqui em\n\ndiante.\n\n\n\n56 Cap\u00edtulo 2. Modelagem Matem\u00e1tica e Num\u00e9rica\n\nFigura 1 \u2013 Stencil de sete pontos.\n\nP\nW\n\nE\n\nN\n\nS\n\nT\n\nB\n\nFonte: elaborada pelo autor.\n\nFigura 2 \u2013 Ilustra\u00e7\u00e3o da matriz de coeficientes.\n\nx x x\nx xP xx x x\n\nx x x\nx xWxx x x\n\nx x x\nx x x\nx x x\n\nx x x\nx x x\nx x x\n\nx x x\nx xNxx x x\n\nx x x\nx x x\nx x x\n\nx x x\nx x x\nx x x ESB T\n\n\n\n2.1. Escoamento Trif\u00e1sico 57\n\nitera\u00e7\u00e3o do m\u00e9todo de Newton da seguinte maneira:\n\n~xl+1 = ~xl + ?~xl+1, (2.29)\n\nat\u00e9 que algum crit\u00e9rio de converg\u00eancia seja satisfeito. Os termos\nfonte s\u00e3o atualizados de acordo com:\n\nql+1?s =\nNw?\nn=1\n\nMwn?\nm=1\n\nWInmk\nl+1\nr?\n\n\u00b5?\n\n[\np\nn,l+1\nbh ?p\n\nl+1\n? ??\n\nl+1\n? (z\n\nn\nbh ?z)\n\n]\n? (~x?~xnm) .\n\n(2.30)\nQuando a press\u00e3o de fundo de po\u00e7o pbh \u00e9 desconhecida, a equa\u00e7\u00e3o\n(2.30) \u00e9 acoplada \u00e0s equa\u00e7\u00f5es (2.21) a (2.23) para o c\u00e1lculo das\ninc\u00f3gnitas (?p,?Sw,?So,?pbh). Quando a press\u00e3o de fundo de po\u00e7o\n\u00e9 conhecida, as vari\u00e1veis prim\u00e1rias se restringem \u00e0s do escoamento\nno reservat\u00f3rio.\n\nNo estado subsaturado, sabe-se que Sg = 0, por\u00e9m a\nquantidade do componente g\u00e1s dissolvido na fase \u00f3leo n\u00e3o \u00e9\nconhecida a priori. Assim, as vari\u00e1veis prim\u00e1rias do modelo s\u00e3o\nmodificadas para (p,Sw,pb), em que pb \u00e9 a press\u00e3o de satura\u00e7\u00e3o da\nfase \u00f3leo em rela\u00e7\u00e3o ao componente g\u00e1s. Nesse caso, as equa\u00e7\u00f5es\nde conserva\u00e7\u00e3o discretizadas referentes \u00e0s fases \u00e1gua e \u00f3leo s\u00e3o\nas mesmas que (2.21) e (2.22), no entanto, a equa\u00e7\u00e3o referente \u00e0\n\n\n\n58 Cap\u00edtulo 2. Modelagem Matem\u00e1tica e Num\u00e9rica\n\nfase g\u00e1s \u00e9 substitu\u00edda por:\n\nRlg,P =\n?VP\n?t\n\n[(\n?RsoSo\nBo\n\n)l\n?\n(\n?RsoSo\nBo\n\n)n]\nP\n\n?\n(\nRsoT?o1\n\n)l\ne\n\n(\nplE ?p\n\nl\nP\n\n)\n+\n(\nRsoT?o1\n\n)l\nw\n\n(\nplP ?p\n\nl\nW\n\n)\n?\n(\nRsoT?o1\n\n)l\nn\n\n(\nplN ?p\n\nl\nP\n\n)\n+\n(\nRsoT?o1\n\n)l\ns\n\n(\nplP ?p\n\nl\nS\n\n)\n?\n(\nRsoT?o1\n\n)l\nt\n\n(\nplT ?p\n\nl\nP\n\n)\n+\n(\nRsoT?o1\n\n)l\nb\n\n(\nplP ?p\n\nl\nB\n\n)\n+\n(\nRsoT?o1?o\n\n)l\ne\n\n(zE ?zP ) ?\n(\nRsoT?o1?o\n\n)l\nw\n\n(zP ?zW )\n\n+\n(\nRsoT?o2?o\n\n)l\nn\n\n(zN ?zP ) ?\n(\nRsoT?o2?o\n\n)l\ns\n\n(zP ?zS)\n\n+\n(\nRsoT?o3?o\n\n)l\nt\n(zT ?zP ) ?\n\n(\nRsoT?o3?o\n\n)l\nb\n(zP ?zB)\n\n?\n(\nq?osRso\nBo\n\n)l\n?VP .\n\n(2.31)\n\nComo uma das vari\u00e1veis prim\u00e1rias \u00e9 modificada, a matriz\njacobiana \u00e9 substitu\u00edda por:\n\n? ~R\n\n?~x\n=\n\n?\n??????????\n\n?Rw\n?p\n\n?Rw\n?Sw\n\n?Rw\n?pb\n\n?Ro\n?p\n\n?Ro\n?Sw\n\n?Ro\n?pb\n\n?Rg\n?p\n\n?Rg\n?Sw\n\n?Rg\n?pb\n\n?\n??????????\n, (2.32)\n\na qual \u00e9 empregada para a constru\u00e7\u00e3o de um sistema linear\nconforme descrito no caso de escoamento em estado saturado.\n\n2.1.2 Determina\u00e7\u00e3o do Ponto de Bolha\n\nDado um volume de controle, o estado em que a fase\n\u00f3leo se encontra pode alterar de saturado para subsaturado ou\nvice-versa durante uma simula\u00e7\u00e3o. Se a transi\u00e7\u00e3o entre esses dois\nestados for reconhecida corretamente, a taxa de converg\u00eancia do\n\n\n\n2.1. Escoamento Trif\u00e1sico 59\n\nm\u00e9todo de Newton-Raphson pode ser aumentada. Esse problema\n\u00e9 denominado como ponto de bolha.\n\nA transi\u00e7\u00e3o do estado saturado para subsaturado ocorre\nquando a seguinte condi\u00e7\u00e3o \u00e9 atendida:\n\np\nn+1,l+1\nb + ?pb > p\n\nn+1,l+1, (2.33)\n\nenquanto que, a transi\u00e7\u00e3o inversa ocorre quando\n\nSn+1,l+1g &lt;0. (2.34)\n\nAl\u00e9m disso, as condi\u00e7\u00f5es de restri\u00e7\u00e3o para o estado satu-\nrado s\u00e3o dadas por:\n\nSn+1,lw + S\nn+1,l\no + S\n\nn+1,l\ng = 1, (2.35)\n\npn+1,l = pn+1,lb . (2.36)\n\nEnquanto que, para o estado subsaturado:\n\nSn+1,lw + S\nn+1,l\no = 1, (2.37)\n\npn+1,l > p\nn+1,l\nb , (2.38)\n\nCom o intuito de tratar o problema do ponto de bolha\napropriadamente, \u00e9 necess\u00e1rio checar as condi\u00e7\u00f5es de mudan\u00e7a\nde estado (2.33) e (2.34). Quando a press\u00e3o no reservat\u00f3rio di-\nminui para um valor menor que a press\u00e3o do ponto de bolha, o\ncomponente g\u00e1s escapa da fase \u00f3leo e forma uma fase pr\u00f3pria.\nNesse caso h\u00e1 transfer\u00eancia do estado subsaturado para saturado.\nPara tanto, \u00e9 necess\u00e1rio que a satura\u00e7\u00e3o da fase \u00f3leo diminua.\nQuando o reservat\u00f3rio encontra-se no estado saturado, as vari\u00e1veis\nrespeitam as restri\u00e7\u00f5es (2.35) e (2.36).\n\nQuando a press\u00e3o em um determinado local do reserva-\nt\u00f3rio aumenta de modo que todo g\u00e1s se dissolve na fase \u00f3leo,\ntem-se que Sn+1,l+1g &lt;0, acarretando em transfer\u00eancia para o\nestado subsaturado. Com o intuito de garantir que a press\u00e3o da\nfase \u00f3leo po seja maior que a press\u00e3o do ponto de bolha pb no\nnovo estado, ?pb \u00e9 configurado com um valor pequeno. Assim\nque ocorre a transfer\u00eancia de estado, assegura-se que as vari\u00e1veis\nsejam atualizadas de modo a obedecer as condi\u00e7\u00f5es de restri\u00e7\u00e3o\n(2.37) e (2.38).\n\n\n\n60 Cap\u00edtulo 2. Modelagem Matem\u00e1tica e Num\u00e9rica\n\n2.2 ESCOAMENTO BIF\u00c1SICO\n\nConsiderando-se escoamento bif\u00e1sico imisc\u00edvel do tipo\n\u00e1gua/\u00f3leo, a satura\u00e7\u00e3o da fase g\u00e1s e a press\u00e3o capilar g\u00e1s/\u00f3leo\ns\u00e3o nulas, portanto, as equa\u00e7\u00f5es governantes do modelo black-oil\npodem ser simplificadas da seguinte maneira:\n\n?\n\n?t\n\n(\n?Sw\nBw\n\n)\n= ?\u00b7 (K?w [?pw ??w?z]) +\n\nq?ws\nBw\n\n, (2.39a)\n\n?\n\n?t\n\n(\n?So\nBo\n\n)\n= ?\u00b7 (K?o [?po ??o?z]) +\n\nq?os\nBo\n\n, (2.39b)\n\nSw + So = 1, (2.39c)\n\npcow (Sw) = po ?pw. (2.39d)\n\nFazendo-se ainda as seguintes hip\u00f3teses:\na) press\u00e3o capilar \u00e1gua/\u00f3leo desprez\u00edvel;\nb) rocha e fluidos s\u00e3o incompress\u00edveis, isto \u00e9, ? ? cte e\n\nB? = 1,\nas equa\u00e7\u00f5es (2.39a) a (2.39d) podem ser reescritas da seguinte\nforma:\n\n?\n?Sw\n?t\n\n= ?\u00b7 (K?w [?p??wg?z]) + q?w, (2.40a)\n\n?\n?So\n?t\n\n= ?\u00b7 (K?o [?p??og?z]) + q?o, (2.40b)\n\nSw + So = 1. (2.40c)\n\nDefinindo-se a mobilidade total como:\n\n?t (Sw) = ?w + ?o =\nkrw\n\u00b5w\n\n+\nkro\n\u00b5o\n, (2.41)\n\nsegue que a soma das equa\u00e7\u00f5es (2.40a) e (2.40b) d\u00e1 origem \u00e0\nseguinte express\u00e3o:\n\n?\u00b7 (K?t?p) = ?\u00b7 (K (?w?w + ?o?o) g?z) ? (q?w + q?o) , (2.42)\n\n\n\n2.2. Escoamento Bif\u00e1sico 61\n\na qual \u00e9 conhecida como a \u201cequa\u00e7\u00e3o da press\u00e3o\u201d, uma vez que\n\u00e9 empregada para o c\u00e1lculo dessa mesma vari\u00e1vel. Ela car\u00e1ter\nel\u00edptico e sua resolu\u00e7\u00e3o envolve a maior parte do tempo compu-\ntacional da simula\u00e7\u00e3o (KILLOUGH; WANG, 2013). Usando-se\nainda o conceito de mobilidade total, a velocidade total pode ser\nexpressa como:\n\n~ut = ~uw + ~uo\n\n= K [?t?P ? (?w?w + ?o?o) g?z] ,\n(2.43)\n\nde modo que a rela\u00e7\u00e3o entre as velocidades das fases \u00e1gua e \u00f3leo\ncom a velocidade total \u00e9 dada por:\n\n~uw = fw~ut + K?ofw (?w ??o) g?z, (2.44)\n\n~uo = fo~ut + K?wfo (?o ??w) g?z, (2.45)\n\nem que f? \u00e9 a fun\u00e7\u00e3o fluxo fracion\u00e1rio da fase ?, dada por:\n\nf? =\n??\n?t\n, ? = [w,o]. (2.46)\n\nSubstituindo-se as express\u00f5es (2.41) e (2.44) em (2.40a),\nsegue que esta \u00faltima pode ser reescrita da seguinte maneira:\n\n?\n?Sw\n?t\n\n+ ?\u00b7 (fw~ut) ??\u00b7 (K?ofw (?o ??w) g?z) = q?w, (2.47)\n\na qual \u00e9 conhecida como equa\u00e7\u00e3o de Buckley-Leverett ou simples-\nmente como equa\u00e7\u00e3o da satura\u00e7\u00e3o. Esta possui car\u00e1ter hiperb\u00f3lico\ne pode ser resolvida implicitamente ou explicitamente ao longo\ndo tempo, de acordo com a formula\u00e7\u00e3o num\u00e9rica empregada.\n\nEm s\u00edntese, o modelo de escoamento bif\u00e1sico imisc\u00edvel \u00e9\ncomposto pelas equa\u00e7\u00f5es (2.40c), (2.42), (2.43) e (2.47), as quais\nest\u00e3o acopladas atrav\u00e9s da satura\u00e7\u00e3o da fase \u00e1gua e formam um\nsistema n\u00e3o-linear.\n\n2.2.1 Discretiza\u00e7\u00e3o das Equa\u00e7\u00f5es\n\nA discretiza\u00e7\u00e3o das equa\u00e7\u00f5es (2.42) e (2.47) \u00e9 realizada\nda mesma maneira que no caso de escoamento trif\u00e1sico, isto \u00e9,\n\n\n\n62 Cap\u00edtulo 2. Modelagem Matem\u00e1tica e Num\u00e9rica\n\natrav\u00e9s do m\u00e9todo dos volumes finitos tradicional empregando-se\no esquema de dois pontos (TPFA). Para a aproxima\u00e7\u00e3o no tempo\ndas equa\u00e7\u00f5es j\u00e1 discretizadas, emprega-se a formula\u00e7\u00e3o totalmente\nimpl\u00edcita sequencial - Sequential Fully Implicit (SFI) (SPILLETE;\nHILLESTAD; STONE, 1973; JENNY; LEE; TCHELEPI, 2006)\nem que as equa\u00e7\u00f5es s\u00e3o resolvidas de modo impl\u00edcito e sequencial.\n\nA equa\u00e7\u00e3o da press\u00e3o no formato discretizado \u00e9 dada por:\n\n(\nq?n+1w,P + q?\n\nn+1\no,P\n\n)\n?VP =T?n+1t1,e\n\n(\npn+1E ?p\n\nn+1\nP\n\n)\n? T?n+1t1,w\n\n(\npn+1P ?p\n\nn+1\nW\n\n)\n+T?n+1t2,n\n\n(\npn+1N ?p\n\nn+1\nP\n\n)\n? T?n+1t2,s\n\n(\npn+1P ?p\n\nn+1\nS\n\n)\n+T?n+1t3,t\n\n(\npn+1T ?p\n\nn+1\nP\n\n)\n? T?n+1t3,b\n\n(\npn+1P ?p\n\nn+1\nB\n\n)\n?\n(\nT?w1?w + T?o1?o\n\n)n+1\ne\n\n(zE ?zP )\n\n+\n(\nT?w1?w + T?o1?o\n\n)n+1\nw\n\n(zP ?zW )\n\n?\n(\nT?w2?w + T?o2?o\n\n)n+1\nn\n\n(zN ?zP )\n\n+\n(\nT?w2?w + T?o2?o\n\n)n+1\ns\n\n(zP ?zS)\n\n?\n(\nT?w3?w + T?o3?o\n\n)n+1\nt\n\n(zT ?zP )\n\n+\n(\nT?w3?w + T?o3?o\n\n)n+1\nb\n\n(zP ?zB) ,\n(2.48)\n\nem que T??d \u00e9 a transmissibilidade na dire\u00e7\u00e3o d referente \u00e0 fase\n?, j\u00e1 apresentada na equa\u00e7\u00e3o (2.16). A permeabilidade absoluta\nnas interfaces dos volumes de controle s\u00e3o avaliadas de acordo\ncom a m\u00e9dia harm\u00f4nica dos valores referentes aos volumes que\ncompartilham a mesma face, enquanto que a permeabilidade\nrelativa nas fronteiras \u00e9 calculada a partir de um esquema de\ninterpola\u00e7\u00e3o upwind de primeira ordem.\n\n\n\n2.2. Escoamento Bif\u00e1sico 63\n\nA forma discreta da equa\u00e7\u00e3o da satura\u00e7\u00e3o \u00e9 dada por:\n\n??VP\n?t\n\n(\nSn+1w,P ?S\n\nn\nw,P\n\n)\n= ?\n\n(\nfn+1w ~u\n\nn+1\nt A\n\n)\ne\n\n+\n(\nfn+1w ~u\n\nn+1\nt A\n\n)\nw\n\n?\n(\nfn+1w ~u\n\nn+1\nt A\n\n)\nn\n\n+\n(\nfn+1w ~u\n\nn+1\nt A\n\n)\ns\n\n?\n(\nfn+1w ~u\n\nn+1\nt A\n\n)\nt\n+\n(\nfn+1w ~u\n\nn+1\nt A\n\n)\nb\n\n?\n[\nT?o1fw (?o ??w)\n\n]n+1\ne\n\n(zE ?zP )\n\n+\n[\nT?o1fw (?o ??w)\n\n]n+1\nw\n\n(zP ?zW )\n\n?\n[\nT?o2fw (?o ??w)\n\n]n+1\nn\n\n(zN ?zP )\n\n+\n[\nT?o2fw (?o ??w)\n\n]n+1\ns\n\n(zP ?zS)\n\n?\n[\nT?o3fw (?o ??w)\n\n]n+1\nt\n\n(zT ?zP )\n\n+\n[\nT?o3fw (?o ??w)\n\n]n+1\nb\n\n(zP ?zB)\n\n+q?n+1w,P ?VP ,\n(2.49)\n\nem que Ai \u00e9 a \u00e1rea da interface i. Tal equa\u00e7\u00e3o \u00e9 n\u00e3o-linear, uma\nvez que o fluxo fracion\u00e1rio da fase \u00e1gua \u00e9 fun\u00e7\u00e3o da satura\u00e7\u00e3o,\nportanto emprega-se o m\u00e9todo de Newton-Raphson para sua\nresolu\u00e7\u00e3o.\n\n\u00c9 poss\u00edvel observar que as equa\u00e7\u00f5es (2.48) e (2.49) est\u00e3o\nacopladas devido \u00e0 permeabilidade relativa, que \u00e9 fun\u00e7\u00e3o da satu-\nra\u00e7\u00e3o, e tamb\u00e9m \u00e0 velocidade total do escoamento, que \u00e9 fun\u00e7\u00e3o\ndo campo de press\u00e3o. Por conta desse acoplamento, estabelece-se\num procedimento iterativo para a resolu\u00e7\u00e3o sequencial dessas\nequa\u00e7\u00f5es at\u00e9 que um crit\u00e9rio de converg\u00eancia baseado na varia\u00e7\u00e3o\nda satura\u00e7\u00e3o seja satisfeito. Denotando por l+ 1 a itera\u00e7\u00e3o recente\ne l, a antiga e suprimindo o \u00edndice n + 1, as equa\u00e7\u00f5es (2.48) e\n\n\n\n64 Cap\u00edtulo 2. Modelagem Matem\u00e1tica e Num\u00e9rica\n\n(2.49) podem ser reescritas como:\n\n(\nq?lw,P + q?\n\nl\no,P\n\n)\n?VP =T? lt1,e\n\n(\npl+1E ?p\n\nl+1\nP\n\n)\n? T? lt1,w\n\n(\npl+1P ?p\n\nl+1\nW\n\n)\n+T? lt2,n\n\n(\npl+1N ?p\n\nl+1\nP\n\n)\n? T? lt2,s\n\n(\npl+1P ?p\n\nl+1\nS\n\n)\n+T? lt3,t\n\n(\npl+1T ?p\n\nl+1\nP\n\n)\n? T? lt3,b\n\n(\npl+1P ?p\n\nl+1\nB\n\n)\n?\n(\nT?w1?w + T?o1?o\n\n)l\ne\n\n(zE ?zP )\n\n+\n(\nT?w1?w + T?o1?o\n\n)l\nw\n\n(zP ?zW )\n\n?\n(\nT?w2?w + T?o2?o\n\n)l\nn\n\n(zN ?zP )\n\n+\n(\nT?w2?w + T?o2?o\n\n)l\ns\n\n(zP ?zS)\n\n?\n(\nT?w3?w + T?o3?o\n\n)l\nt\n(zT ?zP )\n\n+\n(\nT?w3?w + T?o3?o\n\n)l\nb\n(zP ?zB) ;\n\n(2.50)\n\n\n\n2.3. Escoamento Monof\u00e1sico 65\n\n??VP\n?t\n\n(\nSl+1w ?S\n\nn\nw\n\n)\n= ?\n\n(\nfn+1w ~u\n\nl+1\nt A\n\n)\ne\n\n+\n(\nfn+1w ~u\n\nl+1\nt A\n\n)\nw\n\n?\n(\nfn+1w ~u\n\nl+1\nt A\n\n)\nn\n\n+\n(\nfn+1w ~u\n\nl+1\nt A\n\n)\ns\n\n?\n(\nfn+1w ~u\n\nl+1\nt A\n\n)\nt\n+\n(\nfn+1w ~u\n\nl+1\nt A\n\n)\nb\n\n?\n[\nT?o1fw (?o ??w)\n\n]l\ne\n\n(zE ?zP )\n\n+\n[\nT?o1fw (?o ??w)\n\n]l\nw\n\n(zP ?zW )\n\n?\n[\nT?o2fw (?o ??w)\n\n]l\nn\n\n(zN ?zP )\n\n+\n[\nT?o2fw (?o ??w)\n\n]l\ns\n\n(zP ?zS)\n\n?\n[\nT?o3fw (?o ??w)\n\n]l\nt\n(zT ?zP )\n\n+\n[\nT?o3fw (?o ??w)\n\n]l\nb\n(zP ?zB)\n\n+q?lw,P ?VP ,\n(2.51)\n\nas quais s\u00e3o resolvidas de acordo com a Figura 3.\n\u00c9 importante observar que o algoritmo apresentado en-\n\nvolve a resolu\u00e7\u00e3o de sistemas lineares, isso \u00e9 v\u00e1lido tamb\u00e9m para\na equa\u00e7\u00e3o da satura\u00e7\u00e3o, uma vez que ela \u00e9 resolvida atrav\u00e9s do\nm\u00e9todo de Newton. Os m\u00e9todos empregados para a resolu\u00e7\u00e3o de\nproblemas lineares \u00e9 discutida no cap\u00edtulo 3.\n\n2.3 ESCOAMENTO MONOF\u00c1SICO\n\nNo caso de escoamento de uma \u00fanica fase ?, o sistema de\nequa\u00e7\u00f5es (2.1a) a (2.1f) referentes ao modelo black-oil trif\u00e1sico\nreduz-se a uma \u00fanica equa\u00e7\u00e3o, de car\u00e1ter el\u00edptico, que \u00e9 utilizada\npara o c\u00e1lculo da press\u00e3o conforme:\n\n?\n\n?t\n\n(\n?\n\nB\n\n)\n= ?\u00b7\n\n(\nK\n\n\u00b5\n(?p??g?z)\n\n)\n+\nqs\nB\n. (2.52)\n\nEnquanto que o campo de velocidades pode ser calculado explici-\ntamente pela lei de Darcy, equa\u00e7\u00e3o (2.3).\n\n\n\n66 Cap\u00edtulo 2. Modelagem Matem\u00e1tica e Num\u00e9rica\n\nFigura 3 \u2013 Fluxograma para resolu\u00e7\u00e3o do escoamento bif\u00e1sico.\n\nSl = Sn\n\nResolva (2.50) para pl+1\n\nCalcule ~ul+1 atrav\u00e9s de (2.43)\n\nResolva (2.51) para Sl+1\n\n???Sl+1 ?Sl???\n?\n&lt;?\n\nSn+1 = Sl+1\npn+1 = pl+1\n\nl = l + 1\nSimN\u00e3o\n\nConsiderando ainda que o fluido encontra-se no estado\nl\u00edquido (\u00e1gua ou \u00f3leo), pode-se assumir que o escoamento \u00e9 in-\ncompress\u00edvel. Al\u00e9m disso, desprezando-se a compressibilidade\nda rocha, que pode fazer a porosidade variar, a equa\u00e7\u00e3o (2.52)\nreduz-se \u00e0 equa\u00e7\u00e3o diferencial ordin\u00e1ria de segunda ordem:\n\n?\u00b7\n(\n\nK\n\u00b5\n\n(?p??g?z)\n)\n\n+ qs = 0, (2.53)\n\ncujas condi\u00e7\u00f5es de contorno podem ser de press\u00e3o ou fluxo pres-\ncrito.\n\nA discretiza\u00e7\u00e3o da equa\u00e7\u00e3o (2.53) \u00e9 realizada atrav\u00e9s do\nm\u00e9todo dos volumes finitos, empregando-se o esquema de dois\n\n\n\n2.3. Escoamento Monof\u00e1sico 67\n\npontos para o c\u00e1lculo dos fluxos nas interfaces, conduzindo a\n\nqs?VP =T?1,e (pE ?pP ) ? T?1,w (pP ?pW )\n\n+T?1,n (pN ?pP ) ? T?1,s (pP ?pS)\n\n+T?1,t (pT ?pP ) ? T?1,b (pP ?pB)\n\n(2.54)\n\nem que a transmissibilidade na dire\u00e7\u00e3o d \u00e9 dada pela equa\u00e7\u00e3o\n(2.16).\n\nQuando escrita para cada um dos volumes de controle da\nmalha, a equa\u00e7\u00e3o (2.54) forma um sistema linear de car\u00e1ter el\u00edp-\ntico cuja vari\u00e1vel \u00e9 a press\u00e3o. Os m\u00e9todos comumente empregados\npara a resolu\u00e7\u00e3o desse sistema linear s\u00e3o descritos no cap\u00edtulo 3.\n\n\n\n\n\n69\n\n3 SOLU\u00c7\u00c3O DO MODELO MATEM\u00c1TICO\n\nA discretiza\u00e7\u00e3o das equa\u00e7\u00f5es diferenciais que modelam o\nescoamento em reservat\u00f3rios pode conduzir a sistemas de equa\u00e7\u00f5es\nn\u00e3o-lineares ou lineares, de acordo com o car\u00e1ter das equa\u00e7\u00f5es go-\nvernantes do escoamento. Conforme descrito no cap\u00edtulo anterior,\nos modelos de escoamento que envolvem sistemas de equa\u00e7\u00f5es\nn\u00e3o-lineares s\u00e3o resolvidos atrav\u00e9s de v\u00e1rios sistemas lineares em\nsequ\u00eancia, cujas respostas convergem para a solu\u00e7\u00e3o do problema\nn\u00e3o-linear. Al\u00e9m disso, os modelos de escoamento lineares s\u00e3o\nresolvidos, naturalmente, pela solu\u00e7\u00e3o de sistemas de equa\u00e7\u00f5es\ntamb\u00e9m lineares. Desse modo, nota-se que os esfor\u00e7os num\u00e9ricos\npresentes na simula\u00e7\u00e3o do escoamento em reservat\u00f3rios resumem-\nse \u00e0 solu\u00e7\u00e3o de sistemas do tipo\n\nAx = b, (3.1)\n\nem que A ?&lt;n\u00d7n \u00e9 conhecida como a matriz de coeficientes,\nrespons\u00e1vel por descrever a a\u00e7\u00e3o do operador diferencial em for-\nmato discreto; x ?<n, o vetor solu\u00e7\u00e3o, que abrange as inc\u00f3gnitas\ndo modelo discretizado e b ?&lt;n, um vetor cujos valores s\u00e3o\nconhecidos respons\u00e1vel por modelar fen\u00f4menos externos como a\nentrada ou sa\u00edda de massa no reservat\u00f3rio, bem como a a\u00e7\u00e3o das\ncondi\u00e7\u00f5es de contorno.\n\nModelos geol\u00f3gicos de reservat\u00f3rios podem apresentar\nmais de 1.0 \u00d7 108 inc\u00f3gnitas, o que d\u00e1 origem a sistemas lineares\nde grande porte (CHRISTIE, 1996). Al\u00e9m disso, devido ao fato\nde representarem fen\u00f4menos f\u00edsicos complexos, tais sistemas s\u00e3o,\nem geral, mal condicionados do ponto de vista da \u00e1lgebra linear.\nIsso \u00e9 verificado especialmente no caso em que o campo de per-\nmeabilidade absoluta da rocha \u00e9 altamente heterog\u00eaneo, isto \u00e9,\ncom grande variabilidade ao longo do espa\u00e7o.\n\nA resolu\u00e7\u00e3o eficiente dos sistemas lineares representa um\ngrande desafio em termos de recursos computacionais, sendo que\nat\u00e9 90% do tempo de simula\u00e7\u00e3o pode ser consumido na resolu\u00e7\u00e3o\nde sistemas lineares esparsos (DOGRU et al., 2011; KILLOUGH;\nWANG, 2013). Considerando-se a necessidade de rapidez em se\ntomar decis\u00f5es a cerca de estrat\u00e9gias de explota\u00e7\u00e3o do reservat\u00f3rio\n\n\n\n70 Cap\u00edtulo 3. Solu\u00e7\u00e3o do Modelo Matem\u00e1tico\n\ne a complexidade do modelo de escoamento, essa tarefa tende a\nser proibitiva nos computadores dispon\u00edveis atualmente devido a\nlimita\u00e7\u00f5es de mem\u00f3ria RAM e tamb\u00e9m de poder de processamento.\nDuas estrat\u00e9gias s\u00e3o comumente empregadas no tratamento desse\ndesafio: redu\u00e7\u00e3o do tamanho do modelo discretizado e uso de\nsolvers e pr\u00e9-condicionadores eficientes. Esse cap\u00edtulo apresenta\nde modo resumido o estado da arte de cada uma dessas t\u00e9cnicas\ncom enfoque nas suas respectivas vantagens e desvantagens, bem\ncomo em qual posi\u00e7\u00e3o o presente trabalho se situa.\n\n3.1 UPSCALING\n\nA primeira estrat\u00e9gia, conhecida como upscaling, consiste\nem reduzir o n\u00famero de informa\u00e7\u00f5es presentes nos modelos para\nas propriedades da rocha-reservat\u00f3rio e sua intera\u00e7\u00e3o com os\nfluidos que escoam atrav\u00e9s dela de modo que suas caracter\u00edsticas\nfundamentais sejam preservadas. Em m\u00e9todos eficazes, isto faz\ncom que a solu\u00e7\u00e3o obtida para o escoamento em reservat\u00f3rios\nsegundo tais campos seja muito pr\u00f3xima \u00e0quela que seria obtida\ncaso o problema original fosse resolvido.\n\nDo ponto de vista alg\u00e9brico, a aplica\u00e7\u00e3o de t\u00e9cnicas de\nupscaling faz com que o n\u00famero de inc\u00f3gnitas do modelo discreti-\nzado de escoamento tamb\u00e9m reduza. Isto quer dizer que, ao inv\u00e9s\nde se resolver o problema original 3.1, resolve-se um sistema do\ntipo\n\nAcxc = bc, (3.2)\n\ncom c referindo-se ao modelo novo de escoamento e sendo que\na dimens\u00e3o da matriz de coeficientes Ac \u00e9 bem menor que a\ndimens\u00e3o de Af. Uma consequ\u00eancia direta disso \u00e9 a redu\u00e7\u00e3o do\nesfor\u00e7o computacional necess\u00e1rio para se resolver o escoamento\nem reservat\u00f3rios.\n\nA figura 4 ilustra o campo de permeabilidade absoluta\nobtido com a aplica\u00e7\u00e3o do upscaling em um modelo heterog\u00eaneo,\nbem como a redu\u00e7\u00e3o do n\u00famero de volumes de controle envolvidos\nno modelo grosseiro.\n\n\n\n3.1. Upscaling 71\n\nFigura 4 \u2013 Ilustra\u00e7\u00e3o da ideia central do upscaling.\n\n\u00c9 importante observar que as t\u00e9cnicas de upscaling in-\nserem uma aproxima\u00e7\u00e3o no modelo do escoamento, j\u00e1 que in-\nforma\u00e7\u00f5es locais s\u00e3o ponderadas, em geral, de maneira inexata\nno processo de obten\u00e7\u00e3o do modelo grosseiro. Desse modo, os\ncampos de press\u00e3o, satura\u00e7\u00e3o ou temperatura calculados com o\nnovo modelo, apesar de bastante pr\u00f3ximos, n\u00e3o s\u00e3o equivalentes\n\u00e0queles que seriam obtidos caso o problema original 3.1 fosse\nresolvido.\n\nExistem diversas t\u00e9cnicas de upscaling, sendo que elas\ns\u00e3o usualmente classificadas em termos dos par\u00e2metros que se-\nr\u00e3o calculados em n\u00edvel grosseiro. Porosidade e permeabilidade\nabsoluta das rochas s\u00e3o denotados como par\u00e2metros monof\u00e1sicos,\npois s\u00e3o recalculados em qualquer t\u00e9cnica de upscaling, j\u00e1 a per-\nmeabilidade relativa e as curvas de press\u00e3o capilar s\u00e3o denotados\ncomo par\u00e2metros multif\u00e1sicos por serem dependentes das satu-\nra\u00e7\u00f5es relativas \u00e0s fases que escoam no reservat\u00f3rio. Em geral,\nestes \u00faltimos par\u00e2metros precisam ser recalculados em escoamen-\ntos multif\u00e1sicos, por\u00e9m, quando esquemas de redu\u00e7\u00e3o moderada\nno n\u00famero de inc\u00f3gnitas s\u00e3o empregados, \u00e9 suficiente recalcular\napenas a porosidade e a permeabilidade absoluta (SANDVIN,\n2012).\n\nO desenvolvimento de novas t\u00e9cnicas de upscaling cada\n\n\n\n72 Cap\u00edtulo 3. Solu\u00e7\u00e3o do Modelo Matem\u00e1tico\n\nvez mais fi\u00e9is ao problema original \u00e9 uma \u00e1rea ativa de pesquisa\n(FARMER, 2002; DURLOFSKY, 2003; CHEN; DENG; YE, 2005;\nCHEN, 2006). Essa \u00e9 uma tarefa complexa, em especial para pro-\nblemas de escoamento multif\u00e1sico, os quais s\u00e3o comuns em casos\nreais de aplica\u00e7\u00e3o e podem envolver permeabilidades relativas e\npress\u00f5es capilares vari\u00e1veis ao longo da simula\u00e7\u00e3o, cujo efeito em\nescala global \u00e9 de dif\u00edcil representa\u00e7\u00e3o.\n\nDadas as vantagens e desvantagens do upscaling, nota-se\nque existem situa\u00e7\u00f5es em que estas t\u00e9cnicas n\u00e3o representam\numa solu\u00e7\u00e3o vi\u00e1vel para a economia de recursos computacionais\ninvestidos na simula\u00e7\u00e3o. Nesses casos, torna-se imprescind\u00edvel\no uso de m\u00e9todos eficientes para a solu\u00e7\u00e3o do problema inicial.\nEssa \u00e9 justamente a abordagem do presente trabalho e tamb\u00e9m o\nassunto da se\u00e7\u00e3o seguinte.\n\n3.2 SOLVERS LINEARES\n\nNa segunda abordagem empregada para a resolu\u00e7\u00e3o do\nescoamento em reservat\u00f3rios, busca-se o desenvolvimento de algo-\nritmos eficientes do ponto de vista alg\u00e9brico, isto \u00e9, que envolvam\no menor n\u00famero de opera\u00e7\u00f5es aritm\u00e9ticas poss\u00edvel e tamb\u00e9m do\nponto de vista computacional, ou seja, que utilizem a m\u00e1xima ca-\npacidade de computa\u00e7\u00e3o dispon\u00edvel1(WILLIAMS; WATERMAN;\nPATTERSON, 2009) e que tamb\u00e9m sejam escal\u00e1veis tanto no sen-\ntido forte como fraco2. Essa \u00faltima caracter\u00edstica \u00e9 essencial para\na resolu\u00e7\u00e3o dos sistemas lineares atrav\u00e9s de m\u00e1quinas paralelas\n(BALAY et al., 2015).\n\n1 Essa caracter\u00edstica \u00e9 bastante dependente da arquitetura apresentada\npela unidade de processamento em quest\u00e3o, CPUs s\u00e3o as mais utilizadas,\nenquanto que GPUs t\u00eam recebido interesse crescente. Em geral, a perfor-\nmance de pico em cada arquitetura \u00e9 raramente alcan\u00e7ada por limita\u00e7\u00f5es\ndevidas \u00e0 transfer\u00eancia de dados entre mem\u00f3ria RAM e processador.\n\n2 A escalabilidade forte de um algoritmo \u00e9 fun\u00e7\u00e3o do esfor\u00e7o num\u00e9rico\nempregado na resolu\u00e7\u00e3o de um problema a medida que seu tamanho\naumenta, enquanto que a escalabilidade fraca mede a varia\u00e7\u00e3o desse\nesfor\u00e7o num\u00e9rico a medida que a resolu\u00e7\u00e3o do problema \u00e9 distribu\u00edda para\ndiferentes unidades de processamento.\n\n\n\n3.2. Solvers Lineares 73\n\nOs algoritmos empregados na resolu\u00e7\u00e3o de sistemas linea-\nres s\u00e3o comumente referidos como solvers e divididos em m\u00e9todos\ndiretos e iterativos. Na primeira classe, os sistemas lineares s\u00e3o\nresolvidos exatamente segundo a precis\u00e3o da m\u00e1quina empregada.\nJ\u00e1 na segunda, estima-se uma solu\u00e7\u00e3o x0 para o sistema linear e\nforma-se uma sequ\u00eancia de vetores xk, segundo alguma heur\u00edstica,\nque convergem para a solu\u00e7\u00e3o exata do problema. Tal sequ\u00eancia\n\u00e9 truncada de acordo com algum crit\u00e9rio baseado na proximidade\nentre os vetores que a comp\u00f5em ou ent\u00e3o baseado na norma dos\nres\u00edduos calculados segundo tais vetores.\n\nOs m\u00e9todos diretos s\u00e3o reconhecidos por sua robustez e\nagilidade na resolu\u00e7\u00e3o de problemas lineares at\u00e9 um determinado\ntamanho. Suas complexidades com rela\u00e7\u00e3o ao uso de mem\u00f3ria e\npoder de processamento s\u00e3o fun\u00e7\u00f5es, basicamente, do tamanho\nN do sistema linear e da dimens\u00e3o do problema a qual se refere.\nExistem t\u00e9cnicas, por exemplo, que resolvem problemas 2D de\nacordo com O(N3/2) opera\u00e7\u00f5es de ponto flutuante e O(N log N)\nde uso de mem\u00f3ria (BANGERTH, 2013).\n\nJ\u00e1 m\u00e9todos iterativos s\u00e3o conhecidos por seu baixo custo\ncomputacional em termos de poder de processamento e uso de\nmem\u00f3ria RAM, desde que pr\u00e9-condicionadores apropriados sejam\nempregados na resolu\u00e7\u00e3o dos sistemas lineares, assunto que ser\u00e1\ndiscutido na se\u00e7\u00e3o 3.3. Em determinadas ocasi\u00f5es, \u00e9 poss\u00edvel\nobservar que a complexidade de tais m\u00e9todos pode ser at\u00e9 de\nordem linear O(N), o qual representa o melhor cen\u00e1rio poss\u00edvel.\nApesar de bastante promissores, em especial na solu\u00e7\u00e3o paralela de\nsistema lineares, dados os computadores atualmente dispon\u00edveis,\nsolvers iterativos s\u00e3o competitivos em rela\u00e7\u00e3o aos diretos somente\nem problemas com ao menos 105 inc\u00f3gnitas (BANGERTH, 2013).\n\nApresentam-se nessa se\u00e7\u00e3o os m\u00e9todos comumente em-\npregados para a solu\u00e7\u00e3o de problemas lineares provenientes da\nsimula\u00e7\u00e3o de escoamentos em reservat\u00f3rios, suas vantagens e des-\nvantagens particulares ser\u00e3o abordadas com o intuito de delinear\no estado da arte na escolha de m\u00e9todos para a resolu\u00e7\u00e3o dos\nproblemas referidos. Uma descri\u00e7\u00e3o mais detalhada matematica-\nmente desses m\u00e9todos pode ser verificada nos trabalhos de Saad\n(2003) e Kelley (1995).\n\n\n\n74 Cap\u00edtulo 3. Solu\u00e7\u00e3o do Modelo Matem\u00e1tico\n\n3.2.1 Fatora\u00e7\u00e3o LU completa\n\nA fatora\u00e7\u00e3o LU completa \u00e9 um dos m\u00e9todos mais conheci-\ndos para a resolu\u00e7\u00e3o direta de sistemas lineares, sua ideia b\u00e1sica\nconsiste em encontrar duas matrizes L, triangular inferior, e U,\ntriangular superior, de modo que A = LU. Em seguida, resolve-se\no problema\n\nLUx = b, (3.3)\n\no qual \u00e9 matematicamente equivalente ao sistema linear (3.1),\npor\u00e9m de manipula\u00e7\u00e3o simplificada.\n\nO m\u00e9todo em quest\u00e3o pode ser implementado compu-\ntacionalmente de diversas maneiras de acordo com a estrat\u00e9gia\nempregada para o c\u00e1lculo dos fatores L e U (SAAD, 2003). Tipi-\ncamente, tais procedimentos consistem de quatro passos:\n\n1. Reordena-se o grafo referente \u00e0 matriz de coeficientes com\no intuito de se reduzir a gera\u00e7\u00e3o de novos elementos n\u00e3o-\nnulos durante o c\u00e1lculo dos fatores L e U. Para tanto,\nestrat\u00e9gias comumente empregadas s\u00e3o Nested Dissection\n(ND) (GEORGE, 1976); Reverse Cuthill-McKee (RCM)\n(LIU; SHERMAN, 1976) e Approximate Mininal Degree\n(AMD) (AMESTOY; DAVIS; DUFF, 1996).\n\n2. Realiza-se uma fatora\u00e7\u00e3o simb\u00f3lica da matriz, isto \u00e9, sem\nque os valores num\u00e9ricos das entradas sejam considerados.\nAqui \u00e9 importante o uso de algoritmos que levem em conta\na esparsidade da matriz. O intuito dessa etapa \u00e9 calcular\ncomo ser\u00e1 o preenchimento dos fatores triangulares, ou\nseja, quantos elementos n\u00e3o-nulos ser\u00e3o adicionados e suas\nrespectivas posi\u00e7\u00f5es.\n\n3. Realiza-se a fatora\u00e7\u00e3o num\u00e9rica da matriz, a qual leva em\nconta os valores de seus coeficientes. Dessa forma, os fatores\ntriangulares s\u00e3o completamente definidos.\n\n4. Por \u00faltimo, utilizam-se os fatores L e U para a resolu\u00e7\u00e3o\ndo sistema linear (3.3) conforme apresentado no Algoritmo\n1.\n\n\n\n3.2. Solvers Lineares 75\n\nAlgoritmo 1: Aplica\u00e7\u00e3o da fatora\u00e7\u00e3o LU.\nData: Ax = b, A = LU.\nResult: x = U?1L?1b.\n\n1 Resolva Ly = b por substitui\u00e7\u00e3o direta.\n2 Resolva Ux = y por substitui\u00e7\u00e3o reversa.\n\n\u00c9 importante notar que a resolu\u00e7\u00e3o dos sistemas triangu-\nlares por substitui\u00e7\u00e3o direta e reversa \u00e9 uma tarefa barata com-\nputacionalmente, enquanto que a etapa de obten\u00e7\u00e3o dos fatores\ntriangulares, conhecida como setup ou configura\u00e7\u00e3o do algoritmo,\napresenta a maior demanda de recursos computacionais envolvi-\ndos em seu emprego. Isso \u00e9 v\u00e1lido especialmente para o uso de\nmem\u00f3ria RAM, a medida que o n\u00famero de elementos n\u00e3o-nulos\nda matriz de coeficientes \u00e9 maior.\n\nA fatora\u00e7\u00e3o LU \u00e9 conhecida por ser um m\u00e9todo de so-\nlu\u00e7\u00e3o robusto, pois n\u00e3o imp\u00f5e restri\u00e7\u00f5es quanto ao n\u00famero de\ncondicionamento da matriz de coeficientes e sua simetria. Al\u00e9m\ndisso, a solu\u00e7\u00e3o proposta \u00e9 exata, a menos dos erros de arredonda-\nmento da m\u00e1quina que surgem devido a sua precis\u00e3o limitada na\nrepresenta\u00e7\u00e3o de n\u00fameros. Esta \u00e9 uma t\u00e9cnica bastante atraente\nquando se deseja resolver m\u00faltiplos sistemas lineares com a mesma\nmatriz de coeficientes A. No entanto, seu uso pode ser proibitivo\nem computadores que apresentam limita\u00e7\u00f5es de mem\u00f3ria RAM\nou pode ser n\u00e3o-aconselh\u00e1vel quando se deseja resolver o sistema\nlinear de modo aproximado somente. Nesse \u00faltimo caso, \u00e9 comum\no uso de m\u00e9todos iterativos.\n\n3.2.2 M\u00e9todo de Richardson\n\nDentre os solvers iterativos, um dos mais b\u00e1sicos e primei-\nros a serem utilizados \u00e9 o m\u00e9todo de Richardson (RICHARDSON,\n1911). Nele, uma s\u00e9rie de solu\u00e7\u00f5es xk s\u00e3o obtidas com k variando\nentre zero e o n\u00famero m\u00e1ximo de itera\u00e7\u00f5es segundo a equa\u00e7\u00e3o:\n\nxk+1 = xk + ?M?1\n(\nb? Axk\n\n)\n, (3.4)\n\n\n\n76 Cap\u00edtulo 3. Solu\u00e7\u00e3o do Modelo Matem\u00e1tico\n\nem que ? \u00e9 um escalar n\u00e3o-negativo usualmente igual \u00e0 uni-\ndade e M?1, uma matriz denominada de \"pr\u00e9-condicionador\".\nAmbos elementos t\u00eam como finalidade aumentar a taxa de con-\nverg\u00eancia do m\u00e9todo iterativo, papel que desempenhado espe-\ncialmente pela matriz de pr\u00e9-condicionamento. A defini\u00e7\u00e3o de\npr\u00e9-condicionadores eficientes \u00e9 uma tarefa complexa e altamente\ndependente do tipo de problema que se esteja resolvendo, isto \u00e9\ndiscutido com mais detalhes na se\u00e7\u00e3o 3.3, em que tamb\u00e9m se apre-\nsenta os pr\u00e9-condicionadores comumente utilizados na simula\u00e7\u00e3o\nde reservat\u00f3rios.\n\nA equa\u00e7\u00e3o 3.4 tamb\u00e9m pode ser escrita em termos de\nitera\u00e7\u00e3o em torno do ponto fixo xk da seguinte maneira:\n\nxk+1 =\n(\nI ??M?1A\n\n)\nxk + ?M?1b, (3.5)\n\nem que G = I ??M?1A \u00e9 denominada como matriz de itera\u00e7\u00e3o.\nPode-se provar que a converg\u00eancia desse m\u00e9todo \u00e9 garantida\nquando o raio espectral3 dessa matriz, denotado por ? (G), \u00e9\nmenor que a unidade (SAAD, 2003). Quando tal condi\u00e7\u00e3o n\u00e3o\n\u00e9 atendida, torna-se necess\u00e1rio o emprego de solvers iterativos\nmais robustos conforme exposto nas se\u00e7\u00f5es seguintes.\n\n3.2.3 M\u00e9todo do Res\u00edduo Generalizado M\u00ednimo\n\nO m\u00e9todo do res\u00edduo m\u00ednimo generalizado - Generalized\nMinimal Residual (GMRes) - \u00e9 um solver iterativo baseado em\nespa\u00e7os de Krylov desenvolvido inicialmente por Saad e Schultz\n(1986). Esse m\u00e9todo \u00e9 voltado para a solu\u00e7\u00e3o de problemas n\u00e3o-\nsim\u00e9tricos, sendo normalmente empregado na sua vers\u00e3o pr\u00e9-\ncondicionada, e apresenta larga aplica\u00e7\u00e3o em diversas \u00e1reas da\nengenharia.\n\nSejam M?1, matriz de pr\u00e9-condicionamento; x0, uma esti-\nmativa inicial e r0, o res\u00edduo inicial dado por r0 = M?1 (b? Ax0).\nO algoritmo GMRes procura uma solu\u00e7\u00e3o xm para o problema\n\n3 Supremo do conjunto formado pelo valor absoluto dos autovalores que\nconstituem o espectro de uma matriz.\n\n\n\n3.2. Solvers Lineares 77\n\n(3.1) no subespa\u00e7o x0 + Km de dimens\u00e3o m&lt;&lt;n, em que\n\nKm = span\n{\nr0, M?1Ar0, ...,\n\n(\nM?1A\n\n)m?1\nr0\n\n}\n. (3.6)\n\nPara tanto, empregam-se m restri\u00e7\u00f5es de acordo com a condi\u00e7\u00e3o\nde Petrov-Galerkin, dada por\n\nb? Aum ? Lm, (3.7)\n\nem que Lm \u00e9 o subespa\u00e7o de restri\u00e7\u00f5es, o qual varia de acordo com\no m\u00e9todo iterativo escolhido. Para o GMRes, escolhe-se Lm =\nAKm, fazendo com que a norma do res\u00edduo pr\u00e9-condicionado\n\nr =\n??????M?1 (b? Ax)??????\n\n2\n(3.8)\n\nseja minimizada para os candidatos x pertencentes ao subespa\u00e7o\nKm.\n\nO pseudoc\u00f3digo da vers\u00e3o pr\u00e9-condicionada \u00e0 esquerda\ndesse m\u00e9todo \u00e9 dado pelo algoritmo 2. Os passos 1 a 12 tem\ncomo finalidade encontrar uma base ortonormal de vetores para\no subespa\u00e7o de Krylov Km, enquanto que nos passos posteriores\nencontra-se a melhor combina\u00e7\u00e3o linear desses vetores de modo a\nminimizar o valor do res\u00edduo pr\u00e9-condicionado 3.8.\n\n\u00c9 importante citar que existem outras implementa\u00e7\u00f5es do\nalgoritmo GMRes que prop\u00f5em pequenas mudan\u00e7as na maneira\ncomo a matriz de Hessenberg Hm \u00e9 constru\u00edda e tamb\u00e9m no\nmodo como o problema de minimiza\u00e7\u00e3o especificado no passo 13\n\u00e9 resolvido. Exemplos comuns s\u00e3o o Flexible Generalized Minimal\nResidual (FMGRes) e o Direct Quasi Generalized Minimal Re-\nsidual (DQGMRes) (SAAD, 2003). Al\u00e9m disso, podem tamb\u00e9m\nexistir variantes do GMRes que s\u00e3o matematicamente equivalentes\nentre si, por\u00e9m que apresentam diferentes custos computacionais,\ncomo \u00e9 o caso do Pipeline Generalized Minimal Residual (PGM-\nRes), vers\u00e3o do GMRes tradicional especializada na resolu\u00e7\u00e3o\nem paralelo de problemas de larga escala (BALAY et al., 2015).\nNota-se que a solu\u00e7\u00e3o iterativa de um problema pode envolver\npar\u00e2metros que v\u00e3o muito al\u00e9m da simples escolha do m\u00e9todo\niterativo base.\n\n\n\n78 Cap\u00edtulo 3. Solu\u00e7\u00e3o do Modelo Matem\u00e1tico\n\nAlgoritmo 2: GMRes pr\u00e9-condicionado \u00e0 esquerda.\nData: r0 = M?1 (b? Ax0) , ? = ||r0||2 , v1 = r0/?.\nResult:\n\narg min\nx?Km\n\n??????M?1 (b? Ax)??????\n2\n.\n\n1 for j = 1 to m do\n2 Calcule w = M?1Avj\n3 for i = 1 to j do\n4 Calcule hi,j = (w,vi)\n5 Atualize w = w ?hi,jvi\n6 end\n7 Calcule hj+1,j = ||w||2\n8 if hj+1,j &lt;htol then\n9 m = j, v\u00e1 para 13.\n\n10 end\n11 Calcule vj+1 = w/hj+1,j\n12 end\n13 Defina V = [v1, ...,vm].\n14 Defina Hm = hi,j com 1 ? i ? (j + 1) ; 1 ? j ? m.\n15 Resolva ym = argminy ||?e1 ?Hmy||2.\n16 Calcule xm = x0 + Vmym.\n17 Calcule r = M?1 (b? Axm).\n18 if ||r||2 /\n\n????M?1b????2 ? tol then\n19 Atualize x0 = xm e volte para o passo 1.\n20 else\n21 Fim\n22 end\n\n\n\n3.2. Solvers Lineares 79\n\n3.2.4 M\u00e9todo do Gradiente Conjugado\n\nO m\u00e9todo do gradiente conjugado - Conjugate Gradient\n(CG) - \u00e9 um solver iterativo baseado em espa\u00e7os de Krylov, assim\ncomo o GMRes, em que o subespa\u00e7o de restri\u00e7\u00f5es escolhido \u00e9\no pr\u00f3prio Km. Esse m\u00e9todo foi desenvolvido inicialmente por\nHestenes e Stiefel (1952) como uma alternativa \u00e0 fatora\u00e7\u00e3o LU\ncompleta para a resolu\u00e7\u00e3o direta de sistemas lineares sim\u00e9tricos.\nHoje em dia, no entanto, \u00e9 comumente empregado como um\nm\u00e9todo iterativo para a resolu\u00e7\u00e3o aproximada desses problemas\nde acordo com a precis\u00e3o que se queira.\n\nO objetivo do m\u00e9todo do gradiente conjugado consiste\nem minimizar a norma energia do erro entre a solu\u00e7\u00e3o calculada\ne aquela que seria obtida caso o problema fosse resolvido direta-\nmente. Definindo-se como x? a solu\u00e7\u00e3o exata do sistema linear\n3.1, tal condi\u00e7\u00e3o pode ser expressa da seguinte maneira:\n\narg min\nx?Km\n\n||x?x?||A . (3.9)\n\nO passo-a-passo da vers\u00e3o pr\u00e9-condicionada \u00e0 esquerda desse\nm\u00e9todo \u00e9 dado pelo algoritmo 3.\n\nAlgoritmo 3: CG pr\u00e9-condicionado \u00e0 esquerda.\nData: r0 = (b? Ax0) , z0 = M?1r0, p0 = z0.\nResult:\n\narg min\nx?Km\n\n||x?x?||A .\n\n1 for j = 0 to m? 1 do\n2 ?j = (rj,zj)/(Apj,pj).\n3 xj+1 = xj + ?jpj.\n4 rj+1 = rj ??jApj.\n5 zj+1 = M?1rj+1.\n6 ?j = (rj+1,zj+1)/(rj,zj).\n7 pj+1 = zj+1 + ?jpj.\n8 end\n\nAssim como o GMRes, o m\u00e9todo do gradiente conjugado\nbaseia-se em opera\u00e7\u00f5es alg\u00e9bricas envolvendo somente vetores\n\n\n\n80 Cap\u00edtulo 3. Solu\u00e7\u00e3o do Modelo Matem\u00e1tico\n\nbem como em produtos entre matrizes esparsas e vetores, as\nquais n\u00e3o envolvem tanto esfor\u00e7o computacional quanto opera\u00e7\u00f5es\nenvolvendo somente matrizes, presentes em m\u00e9todos de solu\u00e7\u00e3o\ndireta como 3.2.1. Por outro lado, o CG envolve quantia menor de\nopera\u00e7\u00f5es que o GMRes para a resolu\u00e7\u00e3o do problema linear, o que\n\u00e9 permitido gra\u00e7as ao aproveitamento da simetria do problema,\nal\u00e9m de requerer menor espa\u00e7o para armazenamento dos vetores\nque comp\u00f5em seu algoritmo. Tais caracter\u00edsticas tornam o CG\num m\u00e9todo iterativo bastante atraente.\n\nA fim de que o m\u00e9todo descrito apresente uma taxa de\nconverg\u00eancia elevada, \u00e9 necess\u00e1rio o uso de um pr\u00e9-condicionador\neficiente de acordo com o problema, observa\u00e7\u00e3o v\u00e1lida inclu-\nsive para qualquer outro m\u00e9todo iterativo. Na pr\u00f3xima se\u00e7\u00e3o,\nas t\u00e9cnicas de pr\u00e9-condicionamento usualmente empregadas s\u00e3o\ndiscutidas.\n\n3.3 PR\u00c9-CONDICIONADORES\n\nDe modo simplificado, t\u00e9cnicas de pr\u00e9-condicionamento\ns\u00e3o respons\u00e1veis por modificarem o sistema linear inicial com o\nintuito de facilitar seu processo de resolu\u00e7\u00e3o atrav\u00e9s de m\u00e9todos\niterativos (BENZI, 2002; GAMBOLATI; FERRONATO; JANNA,\n2011). Nesse processo, diminui-se o raio espectral da matriz de\nitera\u00e7\u00e3o referente \u00e0 aplica\u00e7\u00e3o desse m\u00e9todo, o que acarreta no\naumento de sua taxa de converg\u00eancia para a obten\u00e7\u00e3o da solu\u00e7\u00e3o.\nDe fato, a busca por m\u00e9todos iterativos eficientes resume-se \u00e0\ndefini\u00e7\u00e3o de pr\u00e9-condicionadores apropriados.\n\nO novo problema obtido com a aplica\u00e7\u00e3o dessas t\u00e9cnicas\n\u00e9 referido como \u201cpr\u00e9-condicionado\u201d, enquanto que o operador res-\npons\u00e1vel por tal modifica\u00e7\u00e3o \u00e9 referido como \u201cpr\u00e9-condicionador\u201d,\nsendo normalmente representado pela matriz M?1.\n\nExistem, basicamente, tr\u00eas maneiras de se aplicar um\npr\u00e9-condicionador ao sistema linear original (3.1). A primeira e\nmais comum, conhecida como \u201cpr\u00e9-condicionamento \u00e0 esquerda\u201d\n\u00e9 dada por\n\nM?1Ax = M?1b; (3.10)\n\n\n\n3.3. Pr\u00e9-Condicionadores 81\n\na segunda \u00e9 conhecida como \u201cpr\u00e9-condicionamento \u00e0 direita\u201d,\nsendo dada por:\n\nAM?1Mx = b; (3.11)\n\npor fim, a \u00faltima \u00e9 referida como \u201cpr\u00e9-condicionamento misto\u201d, a\nqual combina as duas \u00faltimas estrat\u00e9gias para obter:\n\nM?11 AM\n?1\n2 y = M\n\n?1\n1 b, x = M\n\n?1\n2 y. (3.12)\n\nPode-se mostrar que as matrizes M?1A, AM?1 e M?11 AM\n?1\n2 s\u00e3o\n\nsimilares e portanto possuem os mesmos autovalores. No caso em\nque A e M?1 s\u00e3o matrizes sim\u00e9tricas e positivo definidas (SPD),\nsolvers voltados para problemas sim\u00e9tricos como o gradiente con-\njugado apresentam a mesma taxa de converg\u00eancia em qualquer\numa dessas estrat\u00e9gias. No entanto, quando alguma dessas matri-\nzes \u00e9 n\u00e3o-sim\u00e9trica, torna-se necess\u00e1rio o uso de solvers espec\u00edficos\ncomo o GMRes ou o m\u00e9todo do gradiente biconjugado estabili-\nzado - BiConjugate Gradient Stabilized. (BiCGStab) - apresentam\ntaxas de converg\u00eancia diferentes de acordo com a estrat\u00e9gia de\npr\u00e9-condicionamento empregada (BENZI, 2002). Nesse trabalho,\nadota-se o pr\u00e9-condicionamento \u00e0 esquerda (3.10).\n\nAs t\u00e9cnicas de pr\u00e9-condicionamento podem tamb\u00e9m ser\nclassificadas em expl\u00edcitas ou impl\u00edcitas de acordo com a maneira\ncom que a multiplica\u00e7\u00e3o entre as matrizes A e M?1 \u00e9 avaliada.\nConforme o nome sugere, na primeira estrat\u00e9gia, a matriz for-\nmada pelo produto das outras duas \u00e9 calculada explicitamente.\nJ\u00e1 na segunda, o que \u00e9 calculado \u00e9 a a\u00e7\u00e3o do produto dessas\nmatrizes sobre um vetor arbitr\u00e1rio, uma vez que a aplica\u00e7\u00e3o de\npr\u00e9-condicionadores em m\u00e9todos iterativos resume-se a esse tipo\nde opera\u00e7\u00e3o matem\u00e1tica, ou seja\n\nM?11 Ax = M\n?1\n1 y = z. (3.13)\n\nEsta \u00faltima estrat\u00e9gia \u00e9 a mais comum, uma vez que propor-\nciona maior economia de recursos computacionais, e os pr\u00e9-\ncondicionadores discutidos nesse cap\u00edtulo se enquadram nesse\ncaso.\n\nDuas caracter\u00edsticas s\u00e3o fundamentais para a constru\u00e7\u00e3o\nde um pr\u00e9-condicionador eficiente, elas s\u00e3o\n\n\n\n82 Cap\u00edtulo 3. Solu\u00e7\u00e3o do Modelo Matem\u00e1tico\n\n1. O produto M?1v deve ser pr\u00f3ximo a A?1v com v um vetor\narbitr\u00e1rio. Diz-se nesse caso que a a\u00e7\u00e3o da matriz de pr\u00e9-\ncondicionamento \u00e9 pr\u00f3xima \u00e0 a\u00e7\u00e3o da matriz inversa do\nsistema original.\n\n2. A constru\u00e7\u00e3o e aplica\u00e7\u00e3o do pr\u00e9-condicionador deve ser\nbarata em termos de recursos computacionais.\n\nA primeira caracter\u00edstica assegura que o solver iterativo\nconvergir\u00e1 em poucas itera\u00e7\u00f5es (efici\u00eancia alg\u00e9brica), enquanto que\na segunda condi\u00e7\u00e3o proporciona que o custo computacional por\nitera\u00e7\u00e3o seja baixo (efici\u00eancia computacional). \u00c9 importante ob-\nservar que essas condi\u00e7\u00f5es competem entre si e portanto busca-se\nobter um balan\u00e7o entre elas. De fato, encontrar um bom pr\u00e9-\ncondicionador para a resolu\u00e7\u00e3o de um determinado sistema linear\n\u00e9 visto como uma combina\u00e7\u00e3o entre arte e ci\u00eancia (SAAD, 2003).\nIsso ocorre tamb\u00e9m porque seu uso eficiente \u00e9 altamente depen-\ndente do problema em quest\u00e3o: existem pr\u00e9-condicionadores cujo\ndesempenho \u00e9 atraente para determinadas classes de problemas\nenquanto que para outras, pode se mostrar insatisfat\u00f3rio.\n\nNessa se\u00e7\u00e3o, apresentam-se as t\u00e9cnicas de pr\u00e9-condicio-\nnamento comumente utilizadas na simula\u00e7\u00e3o de reservat\u00f3rios,\nsuas vantagens e desvantagens, bem como o tipo de problema\nlinear que cada t\u00e9cnica \u00e9 especializada em resolver. Destaca-se\naqui um dos objetivos fundamentais desse trabalho: a an\u00e1lise de\num pr\u00e9-condicionador concebido para problemas el\u00edpticos.\n\n3.3.1 M\u00e9todo da Sobre-Relaxa\u00e7\u00e3o Sucessiva\n\nO m\u00e9todo da sobre-relaxa\u00e7\u00e3o sucessiva - Successive Over-\nRelaxation (SOR) - foi um dos primeiros pr\u00e9-condicionadores a\nser empregado na resolu\u00e7\u00e3o dos sistemas lineares presentes em si-\nmula\u00e7\u00e3o de reservat\u00f3rios. No in\u00edcio, esse m\u00e9todo era normalmente\nutilizado em conjunto com o solver Richardson 3.2.2, sendo muitas\nvezes denominado diretamente como o solver do problema. Com\no desenvolvimento de solvers baseados em espa\u00e7os de Krylov, fica\nclaro que tais m\u00e9todos podem ser denominados apropriadamente\ncomo pr\u00e9-condicionadores ao inv\u00e9s de solvers.\n\n\n\n3.3. Pr\u00e9-Condicionadores 83\n\nO SOR tem como motiva\u00e7\u00e3o fundamental o desmembra-\nmento da matriz de coeficientes em tr\u00eas partes: triangular inferior,\nL; diagonal, D e triangular superior U, conforme mostrado na\nfigura 5.\n\nFigura 5 \u2013 Decomposi\u00e7\u00e3o LDU da matriz A.\n\nD\nL\n\nU\nA =\n\nInserindo-se um escalar ?, denominado de fator de rela-\nxa\u00e7\u00e3o, tal desmembramento pode ser escrito algebricamente da\nseguinte maneira:\n\nA =\n(D + ?L)\n\n?\n+\n\n(?U + (? ? 1) D)\n?\n\n. (3.14)\n\nDesse modo, o pr\u00e9-condicionador de sobre-relaxa\u00e7\u00e3o sucessiva\npode ser escrito como:\n\nM?1SOR = ? (D + ?L)\n?1\n, (3.15)\n\nsendo que sua a\u00e7\u00e3o sobre um vetor arbitr\u00e1rio r pode ser calculada\na partir de substitui\u00e7\u00e3o direta.\n\nHoje em dia, o algoritmo SOR deixou de ser empregado\ndiretamente para a solu\u00e7\u00e3o do sistema linear 3.1. Ao inv\u00e9s disso,\neste m\u00e9todo \u00e9 bastante utilizado no \u00e2mbito de pr\u00e9-condicionadores\nmultigrid alg\u00e9bricos, desempenhando o papel de suavizador para\na redu\u00e7\u00e3o das componentes de frequ\u00eancias elevadas do erro as-\nsociado \u00e0 solu\u00e7\u00e3o proposta pelo solver iterativo. Isso \u00e9 descrito\ndetalhadamente na se\u00e7\u00e3o 3.3.4.\n\nNo caso de problemas sim\u00e9tricos, uma variante do m\u00e9todo\nSOR denominada SSOR - Symmetric Successive Over Relaxation\n\u00e9 comumente empregada a fim de preservar a simetria do problema\ninicial e permitir o uso de solvers sim\u00e9tricos como o gradiente\n\n\n\n84 Cap\u00edtulo 3. Solu\u00e7\u00e3o do Modelo Matem\u00e1tico\n\nconjugado. Esse pr\u00e9-condicionador pode ser escrito algebricamente\nda seguinte maneira:\n\nM?1SSOR = ? (2 ??) (D + ?U)\n?1 D (D + ?L)?1 , (3.16)\n\nsendo que sua a\u00e7\u00e3o sobre um vetor arbitr\u00e1rio \u00e9 dada de acordo\ncom o algoritmo 4.\n\nAlgoritmo 4: Aplica\u00e7\u00e3o de M?1SSOR sobre um vetor.\nData: L, U, r, ?.\nResult: z = M?1SSOR r.\n\n1 Resolva (D + ?L) x1 = ? (2 ??) r por substitui\u00e7\u00e3o\ndireta.\n\n2 Calcule x2 = Dx1.\n3 Resolva (D + ?U) z = x2 por substitui\u00e7\u00e3o reversa.\n\n3.3.2 Fatora\u00e7\u00e3o LU Incompleta\n\nFatora\u00e7\u00e3o LU incompleta - Incomplete LU Factorization\n(ILU) - consiste em uma classe de pr\u00e9-condicionadores baseados na\nfatora\u00e7\u00e3o aproximada da matriz original A, isto \u00e9, desprezando-se\nos elementos n\u00e3o-nulos adicionais que formariam os fatores trian-\ngulares L e U exatos caso a fatora\u00e7\u00e3o LU 3.2.1 fosse empregada.\nDesse modo, a matriz de pr\u00e9-condicionamento M?1ILU \u00e9 dada por:\n\nM?1ILU = U?\n?1L??1. (3.17)\n\nEstes pr\u00e9-condicionadores foram um dos primeiros apli-\ncados na simula\u00e7\u00e3o de reservat\u00f3rios para a resolu\u00e7\u00e3o de ambas\nequa\u00e7\u00f5es el\u00edpticas e hiperb\u00f3licas presentes no modelo do escoa-\nmento (BEHIE; VINSOME, 1982; BEHIE; COLLINS; JR., 1984).\nHoje em dia, s\u00e3o comumente utilizados para a resolu\u00e7\u00e3o das equa-\n\u00e7\u00f5es hiperb\u00f3licas do modelo apenas. Seu algoritmo \u00e9 apresentado\n\nNo pr\u00e9-condicionador ILU mais simples, denominado de\nILU(0), os fatores L? e U? s\u00e3o calculados de modo que a soma do\n\n\n\n3.3. Pr\u00e9-Condicionadores 85\n\nAlgoritmo 5: Aplica\u00e7\u00e3o da fatora\u00e7\u00e3o ILU.\nData: A ? L?U?.\nResult: z = M?1ILUr = U?\n\n?1L??1r.\n1 Resolva L?y = r por substitui\u00e7\u00e3o direta.\n2 Resolva U?z = y por substitui\u00e7\u00e3o reversa.\n\nn\u00famero de elementos n\u00e3o nulos de cada fator seja igual \u00e0quele\nreferente \u00e0 matriz original A. Diz-se nesse caso que o grau de\npreenchimento do algoritmo \u00e9 nulo. A demanda computacional\nassociada \u00e0 constru\u00e7\u00e3o desse pr\u00e9-condicionador \u00e9 baixa, sendo\nque tal estrat\u00e9gia se mostra eficiente em muitos problemas sim-\nplificados. No entanto, em casos complexos, torna-se necess\u00e1rio o\nuso de estrat\u00e9gias mais robustas.\n\nNesse sentido, um pr\u00e9-condicionador baseado em fatora\u00e7\u00e3o\nLU incompleta mais robusto que o anterior \u00e9 o ILUTP(?,?)\n(SAAD, 1994a; SAAD, 1994b). Esse obt\u00e9m fatores triangulares L?\ne U? aproximados ao desprezar entradas da matriz A cujo valor\ndesobedece a um determinado crit\u00e9rio definido pela toler\u00e2ncia\nabsoluta ?. Al\u00e9m disso, dada uma linha da matriz A, somente as ?\nmaiores entradas s\u00e3o retidas na forma\u00e7\u00e3o dos fatores triangulares.\nO objetivo da primeira aproxima\u00e7\u00e3o consiste em reduzir o custo\ncomputacional referente ao c\u00e1lculo do pr\u00e9-condicionador, enquanto\na segunda consiste em controlar o uso de mem\u00f3ria (SAAD, 2003).\nPor \u00faltimo, uma diferen\u00e7a not\u00e1vel desse algoritmo em rela\u00e7\u00e3o\nao anterior consiste na adi\u00e7\u00e3o de um passo para o pivotamento\ndas linhas da matriz A. Esta opera\u00e7\u00e3o tem como finalidade a\nestabiliza\u00e7\u00e3o do algoritmo, dando origem a fatores triangulares\ncuja inversa tem norma controlada, o que melhora a converg\u00eancia\ndo solver iterativo.\n\nAs estrat\u00e9gias discutidas anteriormente s\u00e3o aplic\u00e1veis\ntanto para problemas n\u00e3o-sim\u00e9tricos como sim\u00e9tricos. Sabe-se que\na fatora\u00e7\u00e3o exata destes \u00faltimos conduz a matrizes L e U que s\u00e3o\ntranspostas uma em rela\u00e7\u00e3o a outra. Esse fato pode ser levado\nem considera\u00e7\u00e3o para o desenvolvimento de outras estrat\u00e9gias de\nfatora\u00e7\u00e3o incompleta que reduzem o espa\u00e7o de mem\u00f3ria RAM\n\n\n\n86 Cap\u00edtulo 3. Solu\u00e7\u00e3o do Modelo Matem\u00e1tico\n\nutilizado pelo algoritmo. Um exemplo largamente empregado \u00e9 a\nfatora\u00e7\u00e3o Cholesky incompleta (KERSHAW, 1978).\n\nDesenvolvimentos recentes em fatora\u00e7\u00e3o incompleta t\u00eam\nsido no sentido de aumentar a efici\u00eancia no c\u00e1lculo dos fatores\ntriangulares a partir de algoritmos multifrontais (SAAD, 1996;\nOSEI-KUFFUOUR; SAAD, 2015) e tamb\u00e9m de reordenamento\nda matriz de coeficientes original conforme descrito na se\u00e7\u00e3o\n3.2.1, os quais tamb\u00e9m alteram a pr\u00f3pria qualidade dos fatores\ntriangulares aproximados e a converg\u00eancia do m\u00e9todo iterativo.\n\n3.3.3 Constrained Pressure Residual\n\nO pr\u00e9-condicionador CPR foi desenvolvido inicialmente\npor Wallis (1983) e Wallis, Kendall e Little (1985) para a solu\u00e7\u00e3o\nde sistemas lineares provenientes da discretiza\u00e7\u00e3o acoplada de pro-\nblemas multif\u00e1sicos. A ideia fundamental desse pr\u00e9-condicionador\n\u00e9 desacoplar o problema inicial segundo os diferentes fen\u00f4menos\nf\u00edsicos que este modela, desse modo, os subproblemas obtidos\npodem ser resolvidos de acordo com pr\u00e9-condicionadores apropri-\nados.\n\nNa simula\u00e7\u00e3o de reservat\u00f3rios isot\u00e9rmicos, o sistema origi-\nnal pode ser dividido em dois subsistemas. O primeiro \u00e9 definido\nem fun\u00e7\u00e3o da inc\u00f3gnita press\u00e3o. Do ponto de vista da \u00e1lgebra\nlinear, este \u00e9 classificado como semipositivo definido e apresenta\ncar\u00e1ter aproximadamente el\u00edptico sendo comumente resolvido\natrav\u00e9s de pr\u00e9-condicionadores do tipo multigrid. J\u00e1 o segundo o\nsistema linear refere-se \u00e0 inc\u00f3gnita satura\u00e7\u00e3o, \u00e9 n\u00e3o-sim\u00e9trico e\napresenta car\u00e1ter hiperb\u00f3lico sendo comumente resolvido atrav\u00e9s\nde pr\u00e9-condicionadores baseados em fatora\u00e7\u00e3o LU incompleta. A\nalgoritmo 6 descreve a a\u00e7\u00e3o do pr\u00e9-condicionador CPR tradicio-\nnal (CAO et al., 2005), representado por M?1CPR sobre um vetor\narbitr\u00e1rio r.\n\nA etapa inicial dos pr\u00e9-condicionadores CPR consiste na\nobten\u00e7\u00e3o de um sistema linear envolvendo somente a vari\u00e1vel\npress\u00e3o. Este \u00e9 formado a partir da multiplica\u00e7\u00e3o de uma determi-\nnada matriz pelo sistema linear original, que envolve as vari\u00e1veis\nprim\u00e1rias. A escolha dessa matriz de desacoplamento representa\n\n\n\n3.3. Pr\u00e9-Condicionadores 87\n\nAlgoritmo 6: Pr\u00e9-condicionador CPR\nData:\n\nA =\n[\n\nApp Aps\nAsp Ass\n\n]\n; r = b? Ax.\n\nResult: z = M?1CPRr.\n1 Defina:\n\nP =\n[\n\nIpp\n0sp\n\n]\n; R = PT ? App = RAP.\n\n2 Restrinja o res\u00edduo global para a parcela referente \u00e0\npress\u00e3o: rp = Rr.\n\n3 Resolva o problema el\u00edptico: (RAP) xp = rp.\n4 Prolongue xp para obter a solu\u00e7\u00e3o global: u = Pxp.\n5 Corrija o res\u00edduo global: v = r ? Au.\n6 Aplique o pr\u00e9-condicionador ILU no sistema global\npara obter: w = ILU(A)v.\n\n7 Combine os res\u00edduos obtidos no primeiro e segundo\nest\u00e1gios: z = u + w.\n\numa \u00e1rea ativa de pesquisa, de modo que diversas escolhas j\u00e1\nforam desenvolvidas, as mais conhecidas s\u00e3o: Alternate Block\nFactorization (ABF) (LACROIX et al., 2003; MASSON et al.,\n2004), quasi-IMPES (SCHEICHL; MASSON; WENDEBOURG,\n2003), reflex\u00f5es de Householder (SCHEICHL; MASSON; WEN-\nDEBOURG, 2003), Dynamic Row Sum (DRS) (GRIES et al.,\n2014) e Weighted Dynamic Row Sum (WDRS) (BROWN; COL-\nLINS; CHEN, 2015). O sistema obtido para a press\u00e3o \u00e9 resolvido\naproximadamente atrav\u00e9s de pr\u00e9-condicionadores AMG, em que\ncostuma-se aplicar apenas uma itera\u00e7\u00e3o do m\u00e9todo. Por sua vez,\ntal solu\u00e7\u00e3o \u00e9 utilizada para atualizar o res\u00edduo referente \u00e0 press\u00e3o\ne, em seguida, o res\u00edduo do sistema completo. Por fim, aplica-se\num pr\u00e9-condicionador baseado em fatora\u00e7\u00e3o incompleta, como\ndescrito na se\u00e7\u00e3o 3.3.2, no vetor res\u00edduo atual conduzindo a uma\nnova solu\u00e7\u00e3o para os campos das vari\u00e1veis press\u00e3o e satura\u00e7\u00e3o.\n\n\n\n88 Cap\u00edtulo 3. Solu\u00e7\u00e3o do Modelo Matem\u00e1tico\n\nDo ponto de vista alg\u00e9brico, a aplica\u00e7\u00e3o do pr\u00e9-condicionador\nCPR pode ser escrita na seguinte forma compacta:\n\nM?1CPR = P (RAP)\n?1 R+\n\nILU(A)\n[\nI ? AP (RAP)?1 R\n\n]\n.\n\n(3.18)\n\n3.3.4 Multigrid Alg\u00e9brico\n\nM\u00e9todos multigrid foram desenvolvidos inicialmente na\nd\u00e9cada de 70 para a resolu\u00e7\u00e3o eficiente de equa\u00e7\u00f5es diferenciais\nparciais escalares com car\u00e1ter el\u00edptico (STUBEN, 2001). Sua ideia\nfundamental consiste na resolu\u00e7\u00e3o aproximada da equa\u00e7\u00e3o 3.1\natrav\u00e9s da aplica\u00e7\u00e3o de um m\u00e9todo iterativo simples nesse sistema\nem conjunto com uma corre\u00e7\u00e3o proveniente da resolu\u00e7\u00e3o exata de\num problema com menor n\u00famero de inc\u00f3gnitas e relacionado com\no original. Esta ideia pode ser estendida recursivamente, dando\norigem a diversos n\u00edveis de malha, da\u00ed o nome do m\u00e9todo. A t\u00edtulo\nde simplifica\u00e7\u00e3o, a abordagem descrita nessa se\u00e7\u00e3o considera\nm\u00e9todos multigrid de dois n\u00edveis, por\u00e9m tamb\u00e9m apresenta-se,\ndevido a sua vasta aplica\u00e7\u00e3o, o operador alg\u00e9brico referente ao\npr\u00e9-condicionador multigrid alg\u00e9brico de v\u00e1rios n\u00edveis.\n\nNa nomenclatura do multigrid, o m\u00e9todo iterativo empre-\ngado em todos os n\u00edveis de malha, exceto o grosseiro, \u00e9 denominado\ncomo \u201csuavizador\u201d, sendo respons\u00e1vel por eliminar as componen-\ntes de alta frequ\u00eancia do erro4 tornando-as suaves em rela\u00e7\u00e3o \u00e0\nmalha adotada. O suavizador \u00e9 denotado por S, sendo que sua\na\u00e7\u00e3o pode ser expressa por:\n\nxk+1 = Sxk + (I ? S) A?1b, S = I ? M?1A. (3.19)\n\nEscolhas comuns podem ser representadas por M?1 = M?1SOR,\nconforme definido pela equa\u00e7\u00e3o (3.15), ou M?1 = M?1SSOR, con-\nforme (3.16). J\u00e1 a corre\u00e7\u00e3o obtida a partir do sistema grosseiro \u00e9\ncalculada atrav\u00e9s de um solver direto, de modo que esta \u00e9 respon-\ns\u00e1vel por eliminar as componentes suaves ou de baixa frequ\u00eancia\n4 Aquelas cujo comprimento de onda \u00e9 da ordem do espa\u00e7amento observado\n\nentre as inc\u00f3gnitas da malha em quest\u00e3o, segundo an\u00e1lise de Fourier.\n\n\n\n3.3. Pr\u00e9-Condicionadores 89\n\ndo erro em malha refinada que passam a ser classificadas como\nde alta frequ\u00eancia na malha grosseira.\n\nO \u201cn\u00edvel refinado\u201d refere-se ao conjunto de inc\u00f3gnitas que\ncomp\u00f5em o sistema linear original (ou a malha computacional\noriginal, no caso de m\u00e9todos multigrid geom\u00e9tricos) de tamanho\nN1, enquanto que o \u201cn\u00edvel grosseiro\u201d refere-se \u00e0quelas selecionadas\npara compor um sistema de menor de tamanho N0&lt;&lt;N1 que\naproxima, de alguma maneira, o primeiro. O operador que realiza\na transfer\u00eancia de informa\u00e7\u00f5es do n\u00edvel grosseiro para o n\u00edvel\nrefinado \u00e9 denominado como P, de formato retangular e ordem\nN1\u00d7N0. J\u00e1 a transfer\u00eancia de informa\u00e7\u00f5es no sentido oposto \u00e9 feita\nsegundo o operador R, de ordem N0 \u00d7N1. Usualmente considera-\nse que R = PT, conhecida como formula\u00e7\u00e3o de Galerkin, a qual\npreserva a simetria do problema inicial, caso exista. Definidos tais\noperadores, pode-se construir o sistema linear em n\u00edvel grosseiro\nAc da seguinte maneira:\n\nAc = RAP. (3.20)\n\n\u00c9 importante observar que esse processo faz com que o n\u00famero\nde elementos n\u00e3o-nulos por linha da matriz Ac seja maior que\naquele referente \u00e0 matriz A. Nesse sentido, medidas do uso de\nmem\u00f3ria associado aos m\u00e9todos multigrid podem ser estabelecidas\nde acordo com as complexidades referentes \u00e0 malha CG e ao\noperador CA, dadas por:\n\nCG =\n?\nl\n\n(\nNl\nNn?1\n\n)\n, CA =\n\n?\nl\n\n(\nml\nmn?1\n\n)\n, (3.21)\n\nem que Nl e ml denotam o n\u00famero de vari\u00e1veis e de elementos\nn\u00e3o-nulos referentes ao n\u00edvel l, respectivamente, com n? 1 sendo\no n\u00edvel mais refinado, no caso em que h\u00e1 mais de dois n\u00edveis.\n\nDe modo semelhante \u00e0 fatora\u00e7\u00e3o LU incompleta, o uso de\num pr\u00e9-condicionador multigrid \u00e9 marcado por duas fases: configu-\nra\u00e7\u00e3o ou setup e aplica\u00e7\u00e3o do pr\u00e9-condicionador. A primeira fase\n\u00e9 constitu\u00edda essencialmente por duas outras: a de engrossamento,\ndo ingl\u00eas coarsening, e a de interpola\u00e7\u00e3o, do ingl\u00eas interpolation.\nNa etapa de engrossamento, determinam-se recursivamente as va-\nri\u00e1veis que ser\u00e3o mantidas a cada n\u00edvel de malha empregada pelo\n\n\n\n90 Cap\u00edtulo 3. Solu\u00e7\u00e3o do Modelo Matem\u00e1tico\n\nm\u00e9todo, enquanto que na etapa de interpola\u00e7\u00e3o, determinam-se\nos operadores de restri\u00e7\u00e3o R e prolonga\u00e7\u00e3o P.\n\nExistem diversas maneiras de se definir as etapas de en-\ngrossamento e interpola\u00e7\u00e3o. No multigrid geom\u00e9trico, o engrossa-\nmento \u00e9 determinado de acordo com a malha empregada no pro-\ncesso de discretiza\u00e7\u00e3o, enquanto que a interpola\u00e7\u00e3o \u00e9 constru\u00edda\nde modo constante por partes. J\u00e1 na implementa\u00e7\u00e3o BoomerAMG\ndo multigrid alg\u00e9brico, o engrossamento pode ser realizado princi-\npalmente de acordo com os algoritmos RS, RS3, CLJP e Falgout;\nenquanto que para a interpola\u00e7\u00e3o, podem ser empregados os algo-\nritmos cl\u00e1ssico, direto, padr\u00e3o ou multi-passe (HENSON; YANG,\n2002).\n\nConsiderando S(1,?), um suavizador com ? itera\u00e7\u00f5es e\nM?11 , sua representa\u00e7\u00e3o no formato de pr\u00e9-condicionador con-\nforme (3.19); S0, um solver direto para o c\u00e1lculo da a\u00e7\u00e3o de\n(Ac)?1 sobre um vetor arbitr\u00e1rio e x0, uma estimativa inicial para\na solu\u00e7\u00e3o do problema 3.1, a aplica\u00e7\u00e3o de um pr\u00e9-condicionador\nmultigrid de dois n\u00edveis em um vetor arbitr\u00e1rio pode ser descrita\nalgebricamente conforme o algoritmo 7.\n\nAlgoritmo 7: Multigrid de dois n\u00edveis.\nData: A, b, x0, r0 = b? Ax0, P, R, S0.\nResult: z = M?1AMGr0.\n\n1 x1/3 = x0 + M?11 (b? Ax0)\n2 x2/3 = x1/3 + P S0 R\n\n(\nb? Ax1/3\n\n)\n3 x1 = x2/3 + M?11\n\n(\nb? Ax2/3\n\n)\n4 z = x1 ?x0\n\n\u00c9 importante observar que tal algoritmo pode ser esten-\ndido para m\u00faltiplos n\u00edveis quando aplicado recursivamente no\nlugar de S0. Al\u00e9m disso, sua etapa de aplica\u00e7\u00e3o costuma deman-\ndar menor quantidade de recursos computacionais que a etapa de\nconfigura\u00e7\u00e3o do m\u00e9todo.\n\nComo realizado para os outros pr\u00e9-condicionadores, a ma-\ntriz que representa a a\u00e7\u00e3o do multigrid sobre um vetor arbitr\u00e1rio\n\n\n\n3.3. Pr\u00e9-Condicionadores 91\n\npode ser representada da seguinte maneira:\n\nM?1AMG =\n[\nI ?\n\n(\nI ? M?11 A\n\n)(\nI ? P S0 R A\n\n)(\nI ? M?11 A\n\n)]\nA?1,\n\n(3.22)\nou tamb\u00e9m, de modo expandido, como:\n\nM?1AMG =M\n?1\n1 +\n\nPS0R\n(\nI ? AM?11\n\n)\n+\n\nM?11\n(\nI ? APS0R\n\n)(\nI ? AM?11\n\n)\n.\n\n(3.23)\n\nNo caso gen\u00e9rico em que o m\u00e9todo multigrid apresenta n\nn\u00edveis com M?1l , pr\u00e9-suavizador e N\n\n?1\nl , p\u00f3s-suavizador relativos\n\nao n\u00edvel l, ambos no formato de pr\u00e9-condicionador. Considerando\ntamb\u00e9m que Rl e Pl s\u00e3o os operadores de restri\u00e7\u00e3o e prolonga\u00e7\u00e3o\nreferentes ao n\u00edvel l, sendo que Rn?1 = Pn?1 = I, a a\u00e7\u00e3o de um\nciclo V do multigrid pode ser expressa algebricamente da seguinte\nmaneira:\n\nM?1AMG =\n[\nI ?\n\nn?1?\nl=1\n\n(\nI ?\n\n(\nPM?1R\n\n)\n(n?l)\n\nA\n)\n\u00d7\n\n(\nI ?\n\n(\nP0S0R0\n\n)\nA\n)\n\u00d7\n\nn?1?\nl=1\n\n(\nI ?\n\n(\nPN?1R\n\n)\nl\nA\n)]\n\nA?1\n\n(3.24)\n\nNos m\u00e9todos multigrid, estrat\u00e9gias adequadas de cons-\ntru\u00e7\u00e3o dos operadores de interpola\u00e7\u00e3o bem como de sele\u00e7\u00e3o das\nvari\u00e1veis que ir\u00e3o compor o sistema grosseiro s\u00e3o cruciais para a\nobten\u00e7\u00e3o de taxas de converg\u00eancia elevadas e pouco dependentes\ndo n\u00famero de inc\u00f3gnitas. Via de regra, quanto maior \u00e9 o esfor\u00e7o\ncomputacional para a constru\u00e7\u00e3o de interpoladores eficientes,\nmaior \u00e9 a taxa de converg\u00eancia num\u00e9rica do pr\u00e9-condicionador5,\n5 Os autovalores da matriz de itera\u00e7\u00e3o SAM G =\n\n(\nI ? M?1AM GA\n\n)\nest\u00e3o\n\nagrupados em torno de zero.\n\n\n\n92 Cap\u00edtulo 3. Solu\u00e7\u00e3o do Modelo Matem\u00e1tico\n\nno entanto a redu\u00e7\u00e3o do n\u00famero de itera\u00e7\u00f5es necess\u00e1rias para a\nconverg\u00eancia pode ser insuficiente para pagar tal esfor\u00e7o adicio-\nnal. Por outro lado, quanto mais simples forem os algoritmos de\ninterpola\u00e7\u00e3o e engrossamento, maiores s\u00e3o as restri\u00e7\u00f5es quanto\n\u00e0 qualidade dos suavizadores empregados, isto \u00e9, eles precisam\nser ainda mais eficientes na redu\u00e7\u00e3o das componentes de diversas\nfrequencias do erro. Segue que a defini\u00e7\u00e3o de algoritmos AMG\neficientes recai em encontrar um balan\u00e7o \u00f3timo entre estrat\u00e9-\ngias de interpola\u00e7\u00e3o e engrossamento em rela\u00e7\u00e3o a estrat\u00e9gias\nde suaviza\u00e7\u00e3o (TROTTENBERG; OOSTERLEE; SCH\u00dcLLER,\n2001).\n\nNo \u00e2mbito da simula\u00e7\u00e3o do escoamento em reservat\u00f3rios,\nm\u00e9todos multigrid foram empregados inicialmente por Behie e\nForsyth (1983) para a resolu\u00e7\u00e3o da equa\u00e7\u00e3o da conserva\u00e7\u00e3o da\nmassa, a qual apresenta car\u00e1ter aproximadamente el\u00edptico6. Desde\nent\u00e3o, essa classe de m\u00e9todos vem sendo largamente aplicada,\nespecialmente sua variante alg\u00e9brica, e tamb\u00e9m aperfei\u00e7oada para\no tratamento de problemas apresentando novas t\u00e9cnicas de discre-\ntiza\u00e7\u00e3o num\u00e9rica referentes a malhas cada vez mais complexas,\nal\u00e9m de fen\u00f4menos f\u00edsicos desafiadores(STUBEN, 2007; KLIE et\nal., 2007; CLEES; GANZER, 2010; KILLOUGH; WANG, 2013;\nGRIES et al., 2014; GRIES; PLUM, 2015; BROWN; COLLINS;\nCHEN, 2015; BARKER et al., 2015). Descri\u00e7\u00f5es mais detalhadas\nda teoria por tr\u00e1s dos m\u00e9todos multigrid podem ser encontradas\nnos trabalhos de Hackbusch (1985) e Trottenberg, Oosterlee e\nSch\u00fcller (2001), enquanto que boas revis\u00f5es sobre avan\u00e7os refe-\nrentes aos m\u00e9todos multigrid alg\u00e9bricos podem ser verificadas em\nStuben (2001), Henson e Yang (2002) e Yang (2006).\n\n3.3.5 Decomposi\u00e7\u00e3o de Dom\u00ednio\n\nM\u00e9todos de decomposi\u00e7\u00e3o de dom\u00ednio, do ingl\u00eas Domain\nDecomposition (DD), foram introduzidos inicialmente em 1870\npor Schwarz para a resolu\u00e7\u00e3o de problemas el\u00edpticos em dom\u00ednios\n6 A presen\u00e7a de po\u00e7os bem como falhas ou fraturas no reservat\u00f3rio pode\n\ndegradar o car\u00e1ter el\u00edptico do operador de Poisson, por isso diz-se \u201capro-\nximadamente el\u00edptico\u201d.\n\n\n\n3.3. Pr\u00e9-Condicionadores 93\n\nconstru\u00eddos pela sobreposi\u00e7\u00e3o de formas geom\u00e9tricas bem esta-\nbelecidas como ret\u00e2ngulos e c\u00edrculos. Desde ent\u00e3o, esses m\u00e9todos\nreceberam v\u00e1rios aperfei\u00e7oamentos e suas ideias foram propagadas\npara diversas \u00e1reas de conhecimento envolvendo a resolu\u00e7\u00e3o de\nequa\u00e7\u00f5es diferenciais parciais.\n\nDo ponto de vista da \u00e1lgebra linear computacional, tais\nm\u00e9todos podem ser vistos como pr\u00e9-condicionadores destinados \u00e0\nresolu\u00e7\u00e3o de problemas lineares el\u00edpticos atrav\u00e9s de uma estrat\u00e9gia\nbaseada em \u201cdivis\u00e3o e conquista\u201d. Isto \u00e9, dado um sistema linear\nreferente ao tipo (3.1), este \u00e9 decomposto em diversos sistemas de\nmenor tamanho e desacoplados entre si; tais sistemas s\u00e3o resol-\nvidos por meio de algum solver e suas solu\u00e7\u00f5es s\u00e3o combinadas\nde alguma maneira para a constru\u00e7\u00e3o da resposta do problema\ninicial. \u00c9 interessante observar que a resolu\u00e7\u00e3o desses subproble-\nmas apresenta elevado grau de paraleliza\u00e7\u00e3o, uma vez que eles\ns\u00e3o desacoplados entre si.\n\nOs pr\u00e9-condicionadores baseados em decomposi\u00e7\u00e3o de\ndom\u00ednios envolvem a especifica\u00e7\u00e3o de um conjunto de par\u00e2metros,\nque s\u00e3o resumidos a seguir:\n\na) m\u00e9todo de particionamento da malha, o qual \u00e9 res-\npons\u00e1vel por determinar a maneira como o problema\ninicial \u00e9 dividido em subproblemas menores. Aqui\ninclui-se a possibilidade da constru\u00e7\u00e3o de subdom\u00ednios\nsobrepostos. Essa \u00e9 uma tarefa simples em malhas\nestruturadas, mas pode ser complexa no caso de ma-\nlhas n\u00e3o-estruturadas e demandar o uso de algoritmos\ncomplexos de particionamento da malha. Estrat\u00e9gias\nbem estabelecidas para tanto est\u00e3o implementadas\nnas bibliotecas METIS (KARYPIS; KUMAR, 1998) e\nPT-Scotch (CHEVALIER; PELLEGRINI, 2008). Um\nbom algoritmo de particionamento conduz \u00e0 subpro-\nblemas de tamanhos semelhantes, diz-se nesse caso\nque o balan\u00e7o de carga \u00e9 bom;\n\nb) estrat\u00e9gia de solu\u00e7\u00e3o dos subproblemas, que podem\nser resolvidos diretamente nos pr\u00e9-condicionadores DD\nexatos ou iterativamente nos inexatos de acordo com al-\n\n\n\n94 Cap\u00edtulo 3. Solu\u00e7\u00e3o do Modelo Matem\u00e1tico\n\ngum solver iterativo associado a um pr\u00e9-condicionador,\nconforme apresentados nas se\u00e7\u00f5es 3.2 e 3.3, respecti-\nvamente;\n\nc) maneira como as solu\u00e7\u00f5es dos subproblemas s\u00e3o com-\nbinadas, aqui existem duas estrat\u00e9gias. Na primeira\ncategoria denominada de aditiva, os subproblemas s\u00e3o\nresolvidos separadamente de modo que a solu\u00e7\u00f5es de\nsubproblemas acoplados entre si (caso de subdom\u00ed-\nnios vizinhos na malha) n\u00e3o interferem entre si. J\u00e1\nna segunda categoria, denominada de multiplicativa,\ntal acoplamento \u00e9 levado em considera\u00e7\u00e3o de modo\nsemelhante ao realizado no m\u00e9todo de Gauss-Seidel.\nObserva-se que a primeira alternativa conduz a pr\u00e9-\ncondicionadores menos eficientes do ponto de vista\nalg\u00e9brico, por\u00e9m que podem ser facilmente implemen-\ntados em m\u00e1quinas paralelas.\n\nConsideremos que a malha computacional referente ao\nsistema linear (3.1) seja dividida em NC subdom\u00ednios possivel-\nmente sobrepostos entre si. Seja Ri o operador composto de 0\ne 1 que restringe tal sistema linear ao subsistema i ? [1 NC],\nreferente ao subdom\u00ednio de mesmo \u00edndice. Tal subsistema pode\nser representado por:\n\nRiAx = Rib\n\n? RiARTi Rix = Rib\n\n? Aixi = bi. (3.25)\n\nA resolu\u00e7\u00e3o independente dos subsistemas gerados com \u201ci\u201d vari-\nando de 1 a NC d\u00e1 origem ao pr\u00e9-condicionador Schwarz aditivo\nde um n\u00edvel, definido a seguir:\n\nM?1AS1 =\nNC?\ni=1\n\n(\nRTi A\n\n?1\ni Ri\n\n)\n. (3.26)\n\nA taxa de converg\u00eancia desse pr\u00e9-condicionador \u00e9 bas-\ntante dependente do grau de sobreposi\u00e7\u00e3o especificado entre os\n\n\n\n3.3. Pr\u00e9-Condicionadores 95\n\nsubdom\u00ednios. Quanto maior esse grau, mais r\u00e1pido se d\u00e1 a trans-\nfer\u00eancia de informa\u00e7\u00f5es de um subdom\u00ednio para seus vizinhos e\nmaior ser\u00e1 a taxa de converg\u00eancia do m\u00e9todo iterativo empregado\npara a resolu\u00e7\u00e3o do problema original. Por outro lado, graus de\nsobreposi\u00e7\u00e3o elevados podem conduzir a subsistemas de dimens\u00f5es\nelevadas, cuja resolu\u00e7\u00e3o requer um tempo adicional maior que\naquele poupado por conta do aumento da taxa de converg\u00eancia.\nPortanto, segue que existe um grau de sobreposi\u00e7\u00e3o \u00f3timo na\ndefini\u00e7\u00e3o desse pr\u00e9-condicionador.\n\nUma outra estrat\u00e9gia comumente empregada para aumen-\ntar a taxa de converg\u00eancia dos pr\u00e9-condicionadores DD consiste\nem adicionar a resolu\u00e7\u00e3o de um problema global em sua formu-\nla\u00e7\u00e3o. Tal problema \u00e9 respons\u00e1vel por acoplar os subproblemas\nnum mesmo sistema linear, o qual \u00e9 definido num espa\u00e7o grosseiro\nde dimens\u00e3o Ng muito menor que a do problema inicial Nf e que\ncostuma ser igual ao n\u00famero de subdom\u00ednios tratados. Seja R0 o\noperador de dimens\u00e3o Ng \u00d7Nf, respons\u00e1vel por realizar a trans-\nfer\u00eancia entre os n\u00edveis refinada e grosseiro, o pr\u00e9-condicionador\nSchwarz aditivo de dois n\u00edveis, pode ser definido da seguinte\nmaneira:\n\nM?1AS2 =\nNC?\ni=0\n\n(\nRTi A\n\n?1\ni Ri\n\n)\n. (3.27)\n\nA solu\u00e7\u00e3o do problema grosseiro pode ainda ser combinada\nde modo multiplicativo com as solu\u00e7\u00f5es dos subproblemas locais.\nIsso d\u00e1 origem ao pr\u00e9-condicionador Schwarz h\u00edbrido de dois\nn\u00edveis, exposto a seguir:\n\nM?1HS2 =\n\n?\n?NC?\ni=0\n\n(\nRTi A\n\n?1\ni Ri\n\n)???\n?\n?NC?\ni=1\n\n(\nRTi A\n\n?1\ni Ri\n\n)?? A (RT0 A?10 R0) .\n(3.28)\n\nA qualidade do espa\u00e7o grosseiro ?0 \u00e9 determinada pela\nsua estrat\u00e9gia de constru\u00e7\u00e3o e tamb\u00e9m pelas caracter\u00edsticas do\nproblema em quest\u00e3o, como a distribui\u00e7\u00e3o do campo de permeabi-\nlidade em problemas de simula\u00e7\u00e3o de reservat\u00f3rios. Boas t\u00e9cnicas\ns\u00e3o fundamentais para a constru\u00e7\u00e3o de pr\u00e9-condicionadores esca-\nl\u00e1veis. Esta tarefa \u00e9, de fato, uma \u00e1rea ativa de pesquisa. Nesse\n\n\n\n96 Cap\u00edtulo 3. Solu\u00e7\u00e3o do Modelo Matem\u00e1tico\n\n\u00e2mbito, \u00e9 importante citar os recentes trabalhos de Dolean et\nal. (2012) e Dolean et al. (2014), que desenvolveram um m\u00e9todo\npara a constru\u00e7\u00e3o de espa\u00e7os grosseiros bastante robustos, sendo\ngerados por um n\u00famero pequeno e bem selecionado de auto-\nvetores provenientes de problemas de autovalores generalizados\ndefinidos nos subdom\u00ednio locais. Conforme ser\u00e1 apresentado em\ncap\u00edtulo posterior, o m\u00e9todo multiescala pode ser visto como uma\nmetodologia para a constru\u00e7\u00e3o de um espa\u00e7o grosseiro espec\u00edfico.\n\nPr\u00e9-condicionadores DD apresentam bastante semelhan\u00e7a\ncom pr\u00e9-condicionadores multigrid pois ambos s\u00e3o classificados\ncomo m\u00e9todos de corre\u00e7\u00e3o em subespa\u00e7o (XU, 2001). Por um lado,\nm\u00e9todos multigrid s\u00e3o t\u00e9cnicas multin\u00edveis conhecidas por empre-\ngar graus de refino moderado e m\u00e9todos de relaxa\u00e7\u00e3o simples. Por\noutro, m\u00e9todos de decomposi\u00e7\u00e3o de dom\u00ednio s\u00e3o normalmente\nrestritos a dois n\u00edveis e conhecidos por empregar graus de refino\nelevados, al\u00e9m de m\u00e9todos de relaxa\u00e7\u00e3o mais robustos para a\nresolu\u00e7\u00e3o dos sistemas lineares em n\u00edvel refinado.\n\nPor fim, descri\u00e7\u00f5es mais detalhadas dos pr\u00e9-condicionadores\nbaseados em decomposi\u00e7\u00e3o de dom\u00ednio podem ser encontradas nos\ntrabalhos (SMITH; BJ\u00f8RSTAD; GROPP, 1996; TOSELLI; WI-\nDLUND, 2005; MATHEW, 2008; DOLEAN; JOLIVET; NATAF,\n2015).\n\n\n\n97\n\n4 M\u00c9TODO DOS VOLUMES FINITOS MULTIESCALA -\nMSFVM\n\nM\u00e9todos multiescala s\u00e3o t\u00e9cnicas computacionais desen-\nvolvidas para a resolu\u00e7\u00e3o eficiente e aproximada de equa\u00e7\u00f5es\nel\u00edpticas na forma (2.53) envolvendo tensores de permeabilidade\nheterog\u00eaneos. Tais equa\u00e7\u00f5es podem ser encontradas em diver-\nsas aplica\u00e7\u00f5es na engenharia, desde a simula\u00e7\u00e3o de reservat\u00f3rios\ncarbon\u00e1ticos at\u00e9 a transfer\u00eancia de calor em materiais comp\u00f3sitos.\n\nNesses m\u00e9todos verifica-se algo parecido com o upscaling,\npois prop\u00f5em uma solu\u00e7\u00e3o aproximada para o escoamento em\nreservat\u00f3rios a partir de um modelo em n\u00edvel grosseiro, isto \u00e9, com\nmenor n\u00famero de inc\u00f3gnitas em rela\u00e7\u00e3o ao original. A constru\u00e7\u00e3o\ndesse modelo \u00e9 realizada de acordo com a solu\u00e7\u00e3o de problemas\nlocais definidos em subdom\u00ednios da malha original. Isso \u00e9 realizado\ndentro de uma etapa de configura\u00e7\u00e3o do m\u00e9todo, anterior \u00e0 etapa\nde solu\u00e7\u00e3o, em que o problema na malha grossa \u00e9 resolvido.\n\nNo caso de escoamento multif\u00e1sico, o problema grosseiro\npode ainda ser din\u00e2mico, isto \u00e9, atualizado ao longo da simula\u00e7\u00e3o\na medida que varia\u00e7\u00f5es locais no campo de mobilidade dos fluidos\ns\u00e3o observadas. Isso confere uma grande vantagem aos m\u00e9todos\nmultiescala em rela\u00e7\u00e3o \u00e0s t\u00e9cnicas de upscaling, uma vez que o\nmodelo grosseiro pode se adequar \u00e0s peculiaridades do escoamento\nao longo da simula\u00e7\u00e3o, conduzindo a solu\u00e7\u00f5es que representam\nmelhor o modelo geol\u00f3gico tratado. Al\u00e9m disso, as solu\u00e7\u00f5es obti-\ndas por esses m\u00e9todos podem ser projetadas na malha original\ndo problema, o que n\u00e3o \u00e9 permitido por t\u00e9cnicas de upscaling\ntradicionais.\n\nDiversos m\u00e9todos multiescala foram propostos nos \u00faltimos\n20 anos, todos eles baseados em uma abordagem envolvendo\ndois n\u00edveis de malhas, no entanto, apresentando diferen\u00e7as na\nmetodologia empregada para a constru\u00e7\u00e3o do problema em n\u00edvel\ngrosso. Entre os mais conhecidos \u00e9 poss\u00edvel citar:\n\na) m\u00e9todo dos elementos finitos multiescala (MsFEM),\ndo ingl\u00eas Multiscale Finite Element Method, o qual\n\u00e9 baseado no m\u00e9todo dos elementos finitos e foi o\nprimeiro m\u00e9todo multiescala desenvolvido de acordo\n\n\n\n98 Cap\u00edtulo 4. M\u00e9todo dos Volumes Finitos Multiescala - MsFVM\n\ncom os trabalhos de Hou e Wu (1997) e Hou, Wu e\nCai (1999). Uma descri\u00e7\u00e3o detalhada desse m\u00e9todo\ncontendo os \u00faltimos avan\u00e7os pode ser verificada no\ntrabalho de Efendiev e Hou (2009);\n\nb) m\u00e9todo dos elementos finitos multiescala misto (MMs-\nFEM), Mixed Multiscale Finite Element Method, que\nexpandiu as ideias dos m\u00e9todos multiescala presen-\ntes no MsFEM para ambas resolu\u00e7\u00f5es do escoamento\n(press\u00e3o) e do transporte (satura\u00e7\u00e3o) (CHEN; HOU,\n2003; AARNES; KIPPE; LIE, 2005; ALPAK; PAL;\nLIE, 2012; PAL et al., 2014) no contexto dos m\u00e9todos\nde elementos finitos mistos (ARNOLD, 1990; ARBO-\nGAST; WHEELER; YOTOV, 1997);\n\nc) m\u00e9todo dos volumes finitos multiescala (MsFVM) -\nMultiscale Finite Volume Method - (JENNY; LEE;\nTCHELEPI, 2003), que ad\u00e9qua as ideias dos m\u00e9todos\nmultiescala ao contexto do m\u00e9todo dos volumes finitos;\n\nd) m\u00e9todo dos elementos finitos multiescala generalizado\n(GMsFEM) - Generalized Multiscale Finite Element\nMethod, o qual deriva do MsFEM e prop\u00f5e uma me-\ntodologia baseada em decomposi\u00e7\u00e3o espectral para a\nconstru\u00e7\u00e3o de operadores em n\u00edvel grosseiro de me-\nlhor qualidade (BUSH; GINTING; PRESHO, 2013;\nCHUNG; EFENDIEV; LI, 2014; PRESHO; GALVIS,\n2015).\n\nNa simula\u00e7\u00e3o de reservat\u00f3rios, os m\u00e9todos multiescala que\nmais se destacam entre os citados s\u00e3o o MsFVM e o MMsFEM.\nIsso se d\u00e1 pelo fato de conduzirem a solu\u00e7\u00f5es conservativas para\no campo de press\u00e3o em malha refinada, isto \u00e9, que geram campos\nde velocidade satisfazendo o princ\u00edpio de conserva\u00e7\u00e3o da massa\nna malha original do problema. Conforme discutido no cap\u00edtulo 2,\nisto \u00e9 essencial para a resolu\u00e7\u00e3o apropriada de equa\u00e7\u00f5es hiperb\u00f3li-\ncas como a referente \u00e0 satura\u00e7\u00e3o. No MMsFEM, tal caracter\u00edstica\n\u00e9 atendida \u00e0s custas de maior empenho computacional em rela\u00e7\u00e3o\nao MsFVM, j\u00e1 que ambas vari\u00e1veis press\u00e3o e velocidade s\u00e3o resol-\nvidas implicitamente, isto \u00e9, a partir de um sistema de equa\u00e7\u00f5es\n\n\n\n99\n\nalg\u00e9bricas. Por conta disso e tamb\u00e9m pelo fato do MsFVM traba-\nlhar com malhas estruturadas, largamente aplicadas na simula\u00e7\u00e3o\nde reservat\u00f3rios, tal estrat\u00e9gia \u00e9 estudada no presente trabalho.\n\nNesse cap\u00edtulo, descreve-se a formula\u00e7\u00e3o matem\u00e1tica do\nm\u00e9todo dos volumes finitos multiescala. A t\u00edtulo de exemplifica-\n\u00e7\u00e3o, considera-se um problema bidimensional, pois isso facilita a\nvisualiza\u00e7\u00e3o dos conceitos b\u00e1sicos do m\u00e9todo em rela\u00e7\u00e3o ao caso\n3D, o qual pode ser obtido por extens\u00e3o das ideias aqui descritas.\nA apresenta\u00e7\u00e3o descrita ser\u00e1 de grande ajuda para a compreens\u00e3o\ndo pr\u00e9-condicionador multiescala alg\u00e9brico, discutido no cap\u00edtulo\nseguinte, segundo um ponto de vista f\u00edsico, uma vez que ambas\nestrat\u00e9gias compartilham das mesmas estruturas b\u00e1sicas.\n\nO problema tratado consiste no escoamento monof\u00e1sico,\nincompress\u00edvel e sujeito a efeitos gravitacionais atrav\u00e9s de um\nmeio poroso de dimens\u00f5es 150 m \u00d7 150 m com fronteiras imper-\nme\u00e1veis, cujo campo de permeabilidade \u00e9 isotr\u00f3pico e altamente\nheterog\u00eaneo sendo dado pela figura 6.\n\nFigura 6 \u2013 Problema teste: logaritmo do campo de permeabilidade\nabsoluta - log10(K[mD]).\n\nx [m]\n0 50 100 150\n\ny \n[m\n\n]\n\n0\n\n50\n\n100\n\n150\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\n\n3\n\nlog\n10\n\n (K [mD])\n\nConsidera-se que \u00e1gua escoa nesse reservat\u00f3rio nas con-\n\n\n\n100 Cap\u00edtulo 4. M\u00e9todo dos Volumes Finitos Multiescala - MsFVM\n\ndi\u00e7\u00f5es padr\u00e3o de press\u00e3o e temperatura. Por fim, h\u00e1 um po\u00e7o\ninjetor com press\u00e3o prescrita de 300 MPa e um po\u00e7o produtor com\npress\u00e3o prescrita de 10 MPa no reservat\u00f3rio conforme ilustrado\nna figura 7 de acordo com os \u00edndices I e P, respectivamente.\n\nApesar de j\u00e1 apresentada na se\u00e7\u00e3o 2.3, reescreve-se a seguir\na equa\u00e7\u00e3o que modela o escoamento incompress\u00edvel monof\u00e1sico:\n\n?\u00b7 (??p) = ?\u00b7 (??g?z) ?qs, (4.1)\n\nem que o lado esquerdo descreve a varia\u00e7\u00e3o do campo de press\u00e3o\nenquanto o lado direito refere-se a efeitos gravitacionais e de\nentrada ou sa\u00edda de massa atrav\u00e9s dos po\u00e7os.\n\nAo inv\u00e9s de utilizar a malha refinada ?? diretamente para a\nsolu\u00e7\u00e3o do escoamento, o MsFVM emprega duas malhas grosseiras\nrelacionadas entre si. Estas s\u00e3o ilustradas na figura 7 e definidas\nem seguida.\n\nFigura 7 \u2013 Problema teste: malhas envolvidas no MsFVM.\n\n?\nD\n\n?\nC~\n\n~\n\n?\n~\n\nI\n\nP\n\na) ?? refere-se a uma discretiza\u00e7\u00e3o em n\u00edvel refinado para\no dom\u00ednio ? totalizando Nf volumes de controle. Nesse\nexemplo, tal malha \u00e9 composta por 15 \u00d7 15 volumes\nde controle cujo interior \u00e9 colorido em branco;\n\n\n\n4.1. Fun\u00e7\u00f5es Base Duais 101\n\nb) ??C \u00e9 chamada de malha primal, sendo uma discreti-\nza\u00e7\u00e3o em n\u00edvel grosseiro para o dom\u00ednio ? formada\npor NC volumes de controle, que por sua vez s\u00e3o\nconstru\u00eddos a partir de um conjunto de subvolumes\npertencentes \u00e0 malha refinada ??. Na figura 7, a malha\ngrosseira primal \u00e9 definida por 3 \u00d7 3 volumes tota-\nlizando NC = 9 sendo que um exemplo de volume\npertencente a essa malha \u00e9 ilustrado em verde. Esta\nmalha \u00e9 empregada para o c\u00e1lculo, na malha refinada,\nde um campo de velocidade conservativo;\n\nc) ??D \u00e9 denominada de malha dual, sendo uma discreti-\nza\u00e7\u00e3o em n\u00edvel grosseiro para o dom\u00ednio ? deslocada\nem rela\u00e7\u00e3o \u00e0 malha primal, de modo que os volumes\nde controle em malha refinada que constituem o centro\ndos volumes de controle primais formam os v\u00e9rtices\ndos volumes duais. O n\u00famero desses \u00faltimos \u00e9 igual\na ND, sendo que, no problema considerado, eles s\u00e3o\ndelimitados de acordo com as linhas pontilhadas e\nND = 16. Os volumes de controle da malha refinada\nassociadas com o sexto volume dual s\u00e3o coloridos em\namarelo na figura 7. Esta malha \u00e9 empregada para o\nc\u00e1lculo de uma solu\u00e7\u00e3o aproximada para o campo de\npress\u00e3o.\n\n4.1 FUN\u00c7\u00d5ES BASE DUAIS\n\nNa formula\u00e7\u00e3o original do MsFVM (JENNY; LEE; TCHE-\nLEPI, 2003), definem-se problemas locais e independentes na ma-\nlha dual conforme apresentado pela equa\u00e7\u00e3o 4.2, isto \u00e9, em cada\num dos subdom\u00ednios de ? definidos por ??Dj , para j = 1, 2, \u00b7 \u00b7 \u00b7 ,ND.\n\n??????\n?????\n?\u00b7\n\n(\n???ji\n\n)\n= 0, em ??Dj ;\n\n?t \u00b7\n(\n???ji\n\n)\n= 0, em ???Dj ;\n\n?\nj\ni (xk) = ?ki, xk ? ?.\n\n(4.2)\n\n\n\n102 Cap\u00edtulo 4. M\u00e9todo dos Volumes Finitos Multiescala - MsFVM\n\nAs inc\u00f3gnitas ?ji, denominadas como fun\u00e7\u00f5es base duais,\ns\u00e3o respons\u00e1veis por captar varia\u00e7\u00f5es locais do campo de permea-\nbilidade. Com a discretiza\u00e7\u00e3o da equa\u00e7\u00e3o diferencial presente no\nproblema (4.2), as fun\u00e7\u00f5es base ?ji s\u00e3o calculadas ao longo dos\nvolumes internos associados ao subdom\u00ednio \u201cj\u201d da malha dual.\nO conjunto ? \u00e9 formado pelas coordenadas relativas aos v\u00e9rtices\ndos volumes de controle duais denotados por \u201cx\u201d na figura 7, ou\nseja, as mesmas referentes ao centro dos volumes de controle da\nmalha primal.\n\nA condi\u00e7\u00e3o de contorno empregada nesse problema \u00e9\ndenominada como \u201creduzida\u201d. Proposta inicialmente por Hou e\nWu (1997) e tamb\u00e9m utilizada pelo m\u00e9todo dos elementos finitos\nmultiescala, esta \u00e9 obtida a partir da solu\u00e7\u00e3o homog\u00eanea da\nequa\u00e7\u00e3o diferencial (4.1), ou seja, desconsiderando-se os termos\npresentes em seu lado direito. Al\u00e9m disso, considera-se que n\u00e3o\nh\u00e1 escoamento na dire\u00e7\u00e3o \u201c~n\u201d, que \u00e9 normal \u00e0 fronteira ???Dj ,\nrestando somente os termos na dire\u00e7\u00e3o tangencial, denotada por\n\u201ct\u201d, sendo que o operador ?t pode ser expresso da seguinte forma:\n\n?t = (I ? P~n)? =\n(\nI ?~n~nT\n\n)\n?. (4.3)\n\nAtrav\u00e9s da \u00faltima rela\u00e7\u00e3o apresentada na equa\u00e7\u00e3o (4.2),\nespecifica-se que ?ji assume valor nulo nos v\u00e9rtices do volume\ndual exceto em um deles, cujo valor \u00e9 igual \u00e0 unidade. O processo\n\u00e9 repetido at\u00e9 que todos os v\u00e9rtices sejam varridos, por isso o\nsub\u00edndice \u201ci\u201d. Desse modo, calculam-se quatro fun\u00e7\u00f5es base para\ncada volume dual no caso 2D ou oito, no caso 3D. \u00c9 importante\nnotar que o suporte das fun\u00e7\u00f5es base referentes ao volume dual\n\u201cj\u201d \u00e9 restrito \u00e0 regi\u00e3o desse mesmo volume. As fun\u00e7\u00f5es base duais\nreferentes ao volume de controle dual indicado na figura 7 s\u00e3o\ndadas pela figura 8.\n\nA condi\u00e7\u00e3o de contorno reduzida estabelece uma maneira\nde se calcular a distribui\u00e7\u00e3o de ?ji em ???\n\nD\nj . Esta \u00e9 justamente\n\na aproxima\u00e7\u00e3o adicionada pelo MsFVM durante a solu\u00e7\u00e3o do\nproblema (4.1) em escala refinada. \u00c9 importante notar que, se tal\ncondi\u00e7\u00e3o de contorno pudesse ser escolhida como a pr\u00f3pria solu\u00e7\u00e3o\ndo problema em escala refinada, o esquema proposto conduziria \u00e0\n\n\n\n4.2. Problema na Malha Grossa 103\n\nFigura 8 \u2013 Problema teste: fun\u00e7\u00f5es base duais.\n\nFun\u00e7\u00e3o base dual ?\n4\n\nFun\u00e7\u00e3o base dual ?\n3\n\nFun\u00e7\u00e3o base dual ?\n1\n\nFun\u00e7\u00e3o base dual ?\n2\n\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n1\n\nmesma solu\u00e7\u00e3o encontrada pela aplica\u00e7\u00e3o do m\u00e9todo dos volumes\nfinitos nesse n\u00edvel e n\u00e3o haveria aproxima\u00e7\u00e3o do MsFVM em\nrela\u00e7\u00e3o \u00e0 solu\u00e7\u00e3o do problema original em malha refinada.\n\nConstru\u00eddas as fun\u00e7\u00f5es base duais, uma solu\u00e7\u00e3o aproxi-\nmada para o campo de press\u00e3o em escala refinada pode ser escrita\npela superposi\u00e7\u00e3o dessas fun\u00e7\u00f5es com um campo de press\u00e3o pCi\nconforme a equa\u00e7\u00e3o:\n\np ? p\n?\n\n=\nND?\nj=1\n\n?\n?NC?\ni=1\n\n?\nj\nip\nC\ni\n\n?\n? . (4.4)\n\n4.2 PROBLEMA NA MALHA GROSSA\n\nO campo de press\u00e3o em escala grosseira pCi presente na\nequa\u00e7\u00e3o 4.4 \u00e9 calculado a partir da resolu\u00e7\u00e3o do escoamento na\nmalha primal ??C. Substituindo-se (4.4) na equa\u00e7\u00e3o (4.1), obt\u00e9m-\nse\n\n?\u00b7\n\n?\n??? ND?\n\nj=1\n\n?\n?NC?\ni=1\n\n?\nj\nip\nC\ni\n\n?\n?\n?\n? = ?\u00b7 (?g??z) ?qs. (4.5)\n\n\n\n104 Cap\u00edtulo 4. M\u00e9todo dos Volumes Finitos Multiescala - MsFVM\n\nIntegrando-se a equa\u00e7\u00e3o (4.5) no volume de controle \u201ci\u201d\nda malha grosseira primal ??C:\n\n?\n??C\n\ni\n\n?\u00b7\n\n?\n??? ND?\n\nj=1\n\n?\n?NC?\ni=1\n\n?\nj\nkp\nC\nk\n\n?\n?\n?\n?d? = ?\n\n??C\ni\n\n[?\u00b7 (?g??z) ?qs] d?,\n\n(4.6)\n\n?\n?i?\nk=i\n\n?\n???\n?\n\n???C\ni\n\n?\n?? ND?\n\nj=1\n??jkp\n\nC\nk\n\n?\n?~n d?\n\n?\n??? =\n\n?\n??C\n\ni\n\nrd?, (4.7)\n\nem que o conjunto ?i agrupa os volumes de controle da ma-\nlha primal que influenciam na equa\u00e7\u00e3o referente ao volume ?Ci ,\nenquanto o termo r representa o lado direito da equa\u00e7\u00e3o (4.1).\nProsseguindo a dedu\u00e7\u00e3o:\n\n?i?\nk=i\n\n?\n???\nND?\nj=1\n\n?\n???C\n\ni\n???D\n\nj\n\n(\n???jk\n\n)\n~n d?\n\n?\n???pCk =\n\n?\n??C\n\ni\n\nrd? (4.8)\n\n?\n?i?\nk=i\n\nTikp\nC\nk = q?i (4.9)\n\n? TpC = q?. (4.10)\n\nA equa\u00e7\u00e3o (4.10) define o sistema linear para o campo de\npress\u00e3o na malha grossa, o qual \u00e9 ilustrado na figura 9 para o\nproblema teste. \u00c9 importante observar que tal solu\u00e7\u00e3o conduz a\num campo de velocidade conservativo nesse n\u00edvel de malha, j\u00e1\nque foi obtida atrav\u00e9s da aplica\u00e7\u00e3o do m\u00e9todo dos volumes finitos.\n\nAp\u00f3s a obten\u00e7\u00e3o do campo de press\u00e3o na malha grossa, o\ncampo de press\u00e3o na malha refinada ?? pode ser calculado a partir\nda equa\u00e7\u00e3o (4.4), mediante o uso das fun\u00e7\u00f5es base duais. A figura\n10 ilustra \u00e0 direita esse campo para o problema teste, bem como o\ncampo de press\u00e3o de refer\u00eancia, \u00e0 esquerda, calculado atrav\u00e9s de\num m\u00e9todo de solu\u00e7\u00e3o direto. Uma vez que as fun\u00e7\u00f5es base duais\n\n\n\n4.2. Problema na Malha Grossa 105\n\nFigura 9 \u2013 Problema teste: campo de press\u00e3o referente \u00e0 malha\ngrosseira.\n\nx [m]\n0 50 100 150\n\ny \n[m\n\n]\n\n0\n\n50\n\n100\n\n150\n\n12\n\n14\n\n16\n\n18\n\n20\n\n22\n\n24\n\nP [MPa]\n\napenas aproximam as varia\u00e7\u00f5es do campo de permeabilidade em\nn\u00edvel refinado (local) ao inv\u00e9s de as reproduzirem fielmente, tem-se\nque o campo de press\u00e3o obtido em n\u00edvel refinado pelo MsFVM\nn\u00e3o \u00e9 equivalente ao de refer\u00eancia, apesar de bastante pr\u00f3ximo.\n\nFigura 10 \u2013 Problema teste: solu\u00e7\u00e3o para o campo de press\u00e3o.\n\n15\n\n10\n\nSolu\u00e7\u00e3o de refer\u00eancia\n\n5\n\n015\n\n10\n\nx\n\n5\n\n30\n\n15\n\n10\n\n20\n\n5\n\n0\n\n25\n\n15\n\n10\n\n5\n\nSolu\u00e7\u00e3o MsFVM\n\n015\n\n10\n\nx\n\n5\n\n5\n\n15\n\n20\n\n25\n\n30\n\n10\n\n0\n\n12\n\n14\n\n16\n\n18\n\n20\n\n22\n\n24\n\nP [MPa]\n\n\n\n106 Cap\u00edtulo 4. M\u00e9todo dos Volumes Finitos Multiescala - MsFVM\n\nV\u00e1rios autores descrevem que a vantagem do uso de m\u00e9-\ntodos multiescala consiste na qualidade da solu\u00e7\u00e3o obtida, que\napesar de inexata \u00e9 considerada boa, dadas as incertezas de enge-\nnharia presentes no campo de permeabilidade que a determina.\nAl\u00e9m disso, defende-se que o tempo computacional associado a tal\nestrat\u00e9gia tende a ser baixo em compara\u00e7\u00e3o com outras estrat\u00e9gias\ncomumente empregadas (MOYNER; LIE, 2014a).\n\n4.3 RECONSTRU\u00c7\u00c3O DO CAMPO DE VELOCIDADE\n\nO campo de press\u00e3o em escala refinada calculado pela\nequa\u00e7\u00e3o (4.4) \u00e9 cont\u00ednuo nas regi\u00f5es ocupadas pelas interfaces\ndos volumes de controle duais, por\u00e9m o gradiente desse campo\n\u00e9 descont\u00ednuo nessas regi\u00f5es (JENNY; LEE; TCHELEPI, 2006;\nMOYNER, 2012). Desse modo, se for empregado para o c\u00e1lculo de\num campo de velocidades em malha refinada conforme a equa\u00e7\u00e3o\n(??), esse n\u00e3o garantir\u00e1 a conserva\u00e7\u00e3o da massa localmente. A fim\nde que isso seja alcan\u00e7ado, o MsFVM prop\u00f5e uma metodologia\npara a reconstru\u00e7\u00e3o do campo de velocidade segundo um campo\nde press\u00e3o atualizado.\n\nAs fronteiras dos volumes de controle da malha primal\ns\u00e3o contidas pelos volumes de controle duais. Por constru\u00e7\u00e3o do\nMsFVM, sabe-se que o campo de velocidade calculado nessas\nregi\u00f5es \u00e9 cont\u00ednuo. Tais fatos motivam a especifica\u00e7\u00e3o das condi-\n\u00e7\u00f5es de contorno para problemas locais definidos nos volumes de\ncontrole da malha primal ??Ci , em que i = 1, 2, \u00b7 \u00b7 \u00b7 ,NC, conforme?????\n\n????\n?\u00b7\n\n(\n??p\n\n??\n)\n\n= f\n?\ni, em ??\n\nC\ni .(\n\n??p\n??\n)\n\u00b7~ni =\n\n(\n??p\n\n?\n)\n\u00b7~ni, em ???Ci .\n\np\n??\n\n(xk) = p\n?\n(xk) , xk ? ?,\n\n(4.11)\n\nem que p\n?\nrepresenta o campo de press\u00e3o local obtido a partir da\n\nequa\u00e7\u00e3o (4.4) conforme descrito na se\u00e7\u00e3o passada; p\n??\n, o campo\n\nde press\u00e3o corrigido que conduz \u00e0 solu\u00e7\u00e3o conservativa para a\nvelocidade; ~ni, o vetor normal \u00e0 fronteira ???Ci e, por fim, f\n\n?\ni pode\n\nser visto como um termo fonte associado \u00e0 entrada/sa\u00edda de massa\n\n\n\n4.3. Reconstru\u00e7\u00e3o do Campo de Velocidade 107\n\nno volume de controle ??Ci , respons\u00e1vel tamb\u00e9m pela modelagem\nde efeitos gravitacionais, dado por\n\nf\n?\ni = ?\n\n?\n???C\n\ni\n\n??p\n?\nd?\n\n??\n?C\n\ni\n\nd?\n. (4.12)\n\nAp\u00f3s a reconstru\u00e7\u00e3o do campo de press\u00e3o, o campo de\nvelocidade pode ser calculado explicitamente pela equa\u00e7\u00e3o (2.3).\nAs linhas de corrente obtidas a partir dos campos de velocidades\noriginal (calculado a partir de p\n\n?\n) e reconstru\u00eddo (calculado a\n\npartir de p\n??\n) para o problema teste s\u00e3o ilustradas na figura 11.\n\nFigura 11 \u2013 Problema teste: linhas de corrente (MsFVM).\n\nx [m]\n0 50 100 150\n\ny \n[m\n\n]\n\n0\n\n50\n\n100\n\n150\nSem reconstru\u00e7\u00e3o\n\nx [m]\n0 50 100 150\n\ny \n[m\n\n]\n\n0\n\n50\n\n100\n\n150\nCom reconstru\u00e7\u00e3o\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\n\n3\n\nlog\n10\n\n (K [mD])\n\nDessa figura conclui-se que o campo de velocidade cal-\nculado pelo MsFVM sem haver o processo de reconstru\u00e7\u00e3o \u00e9\ninconsistente do ponto de vista f\u00edsico, enquanto que o novo campo\naproxima-se mais da solu\u00e7\u00e3o real. De fato, calculando-se o campo\nde velocidade a partir da solu\u00e7\u00e3o exata do escoamento, esta \u00faltima\nobserva\u00e7\u00e3o \u00e9 confirmada. Uma compara\u00e7\u00e3o entre os campos de\nvelocidade de refer\u00eancia e obtido pelo MsFVM empregando-se a\nestrat\u00e9gia de reconstru\u00e7\u00e3o pode ser verificada na figura 12.\n\n\u00c9 importante lembrar que os problemas locais definidos\npela equa\u00e7\u00e3o (4.11) para os diferentes volumes ??Ci s\u00e3o independen-\n\n\n\n108 Cap\u00edtulo 4. M\u00e9todo dos Volumes Finitos Multiescala - MsFVM\n\nFigura 12 \u2013 Problema teste: compara\u00e7\u00e3o entre linhas de corrente.\n\nx [m]\n0 50 100 150\n\ny \n[m\n\n]\n\n0\n\n50\n\n100\n\n150\nRefer\u00eancia\n\nx [m]\n0 50 100 150\n\ny \n[m\n\n]\n\n0\n\n50\n\n100\n\n150\nMsFVM com reconstru\u00e7\u00e3o\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\n\n3\n\nlog\n10\n\n (K [mD])\n\ntes entre si, portanto sua solu\u00e7\u00e3o pode ser facilmente paralelizada.\nA mesma observa\u00e7\u00e3o \u00e9 v\u00e1lida para o problema que define as fun-\n\u00e7\u00f5es base duais (4.2). Esse \u00e9 justamente um dos pontos positivos\nmais relevantes do MsFVM: o alto grau de paraleliza\u00e7\u00e3o de seu\nalgoritmo.\n\n4.4 FUN\u00c7\u00d5ES DE CORRE\u00c7\u00c3O\n\nUm aperfei\u00e7oamento no MsFVM foi proposto pelas for-\nmula\u00e7\u00f5es apresentadas por Lunati e Jenny (2008), Lunati e Lee\n(2009), em que al\u00e9m das fun\u00e7\u00f5es base duais, definem-se tamb\u00e9m\nfun\u00e7\u00f5es de corre\u00e7\u00e3o respons\u00e1veis por captar os efeitos causados\npelos termos independentes da equa\u00e7\u00e3o (4.1) sobre o campo de\npress\u00e3o em n\u00edvel refinado.\n\nAssim como no caso das fun\u00e7\u00f5es base duais, as fun\u00e7\u00f5es\nde corre\u00e7\u00e3o s\u00e3o encontradas atrav\u00e9s da resolu\u00e7\u00e3o de problemas\nindependentes definidos nos volumes de controle da malha dual.\nTomando-se um volume dual ???Dj gen\u00e9rico, a fun\u00e7\u00e3o de corre\u00e7\u00e3o\n??j associada a esse volume \u00e9 encontrada resolvendo-se o seguinte\n\n\n\n4.5. Desenvolvimentos Recentes 109\n\nproblema:?????\n????\n?\u00b7\n\n(\n????j\n\n)\n= ?\u00b7 (?g??z) + q, em ??Dj .\n\n?t \u00b7\n(\n????j\n\n)\n= ?t \u00b7 (?g??z) , em ???Dj .\n\n??j (xk) = 0, xk ? ?,\n\n(4.13)\n\nNota-se que este \u00e9 bastante similar ao problema dado por (4.2),\nas diferen\u00e7as fundamentais entre eles consistem nas condi\u00e7\u00f5es\nde contorno para os v\u00e9rtices dos volumes ???Dj , as quais s\u00e3o\nnulas no presente caso e ao fato de (4.13) considerar fen\u00f4menos\nf\u00edsicos modelados pelo lado direito da equa\u00e7\u00e3o (4.1). Al\u00e9m disso \u00e9\nimportante notar que, dado um volume dual arbitr\u00e1rio, calcula-se\numa \u00fanica fun\u00e7\u00e3o de corre\u00e7\u00e3o associada a ele independentemente\ndo problema ser bidimensional ou tridimensional.\n\nQuando as fun\u00e7\u00f5es de corre\u00e7\u00e3o s\u00e3o consideradas, a ex-\npress\u00e3o para o c\u00e1lculo do campo de press\u00e3o em escala refinada a\npartir do campo em escala grossa \u00e9 modificada para a seguinte\nequa\u00e7\u00e3o\n\np ? p\n?\n\n=\nND?\nj=1\n\n?\n?NC?\ni=1\n\n?\nj\nip\nC\ni + ?\n\n?\nj\n\n?\n? . (4.14)\n\nNo problema teste, os po\u00e7os est\u00e3o localizados nos pr\u00f3-\nprios centr\u00f3ides dos volumes de controle da malha primal, isso\npermite que seu efeito sobre o escoamento possa ser devidamente\nconsiderado pelo lado direito do sistema linear em n\u00edvel grosso\n(4.10), logo a parcela das fun\u00e7\u00f5es de corre\u00e7\u00e3o referente \u00e0 a\u00e7\u00e3o dos\npo\u00e7os \u00e9 nula. No entanto, efeitos gravitacionais est\u00e3o presentes no\nsentido oposto do eixo \u201cy\u201d, logo as fun\u00e7\u00f5es de corre\u00e7\u00e3o devem ser\ndiferentes de zero. Com efeito, a corre\u00e7\u00e3o no campo de press\u00e3o\ngerada por tais fun\u00e7\u00f5es \u00e9 ilustrada na figura 13.\n\n4.5 DESENVOLVIMENTOS RECENTES\n\nO m\u00e9todo dos volumes finitos multiescala foi inicialmente\nproposto para a resolu\u00e7\u00e3o de problemas el\u00edpticos homog\u00eaneos\n(JENNY; LEE; TCHELEPI, 2003), que correspondem ao caso\n\n\n\n110 Cap\u00edtulo 4. M\u00e9todo dos Volumes Finitos Multiescala - MsFVM\n\nFigura 13 \u2013 Problema teste: fun\u00e7\u00f5es de corre\u00e7\u00e3o.\n\nx [m]\n0 50 100 150\n\ny \n[m\n\n]\n\n0\n\n50\n\n100\n\n150\n\n-0.2\n\n-0.1\n\n0\n\n0.1\n\n0.2\n\n0.3\n\nP [MPa]\n\nde escoamento monof\u00e1sico e incompress\u00edvel. Posteriormente, este\nfoi estendido para a resolu\u00e7\u00e3o de problemas hiperb\u00f3licos como\na equa\u00e7\u00e3o do transporte (satura\u00e7\u00e3o) (LEE; ZHOU; TCHELEPI,\n2009; KUNZE, 2014). Desde sua cria\u00e7\u00e3o, tal m\u00e9todo recebeu cons-\ntantes aprimoramentos de modo a adapt\u00e1-lo para a resolu\u00e7\u00e3o de\nproblemas cada vez mais real\u00edsticos em simula\u00e7\u00e3o de reservat\u00f3rios.\nNesse sentido, os avan\u00e7os mais significantes s\u00e3o sintetizados a\nseguir\n\n\u2022 Escoamentos compress\u00edveis monof\u00e1sicos e multif\u00e1sicos (JENNY;\nLEE; TCHELEPI, 2005; JENNY; LEE; TCHELEPI, 2006;\nLUNATI; JENNY, 2006b; LUNATI; JENNY, 2006a; ZHOU,\n2006; ZHOU; TCHELEPI, 2008; HAJIBEYGI; JENNY,\n2009).\n\n\u2022 Reservat\u00f3rios anisotr\u00f3picos (LUNATI; JENNY, 2007; HESSE;\nMALLISON; TCHELEPI, 2008; HAJIBEYGI; WANG; TCHE-\nLEPI, 2014; MOYNER; LIE, 2014b).\n\n\u2022 Modelagem de po\u00e7os com trajet\u00f3ria complexa atrav\u00e9s das\nfun\u00e7\u00f5es de corre\u00e7\u00e3o (WOLFSTEINER; LEE; TCHELEPI,\n\n\n\n4.5. Desenvolvimentos Recentes 111\n\n2006; JENNY; LUNATI, 2009).\n\n\u2022 Escoamento em reservat\u00f3rios com falhas geol\u00f3gicas (HAJI-\nBEYGI; DEB; JENNY, 2011).\n\n\u2022 Escoamento em reservat\u00f3rios fraturados (HAJIBEYGI; KAR-\nVOUNIS; JENNY, 2011; SANDVE; KEILEGAVLEN; NORD-\nBOTTEN, 2014).\n\n\u2022 Escoamento multif\u00e1sico black-oil (LEE; WOLFSTEINER;\nTCHELEPI, 2008).\n\n\u2022 Escoamento multif\u00e1sico composicional (HAJIBEYGI; TCHE-\nLEPI, 2014; CUSINI et al., 2014).\n\n\u2022 Malhas estratigr\u00e1ficas e n\u00e3o-estruturadas (MOYNER, 2014;\nMOYNER; LIE, 2014a; MOYNER; LIE, 2015).\n\nUma frente de pesquisa bastante ativa prop\u00f5e mudan\u00e7as\nna formula\u00e7\u00e3o dos m\u00e9todos multiescala que conduzam a solu\u00e7\u00f5es\nde melhor qualidade, isto \u00e9, mais pr\u00f3ximas \u00e0quelas calculadas exa-\ntamente na malha refinada, e de baixo custo computacional. Nesse\nsentido, um caminho bastante explorado consiste na defini\u00e7\u00e3o de\nnovas condi\u00e7\u00f5es de contorno que sejam mais pr\u00f3ximas \u00e0 solu\u00e7\u00e3o\nexata para os problemas que definem as fun\u00e7\u00f5es base duais (4.2),\neste \u00e9 justamente o objeto de estudo dos trabalhos escritos por\nNordbotten e Bjorstad (2008); Moyner e Lie (2014a) e Keilegavlen\ne Nordbotten (2014). Outra t\u00e1tica consiste na aplica\u00e7\u00e3o iterativa\ndo MsFVM de modo que as condi\u00e7\u00f5es de contorno dos problemas\nduais sejam atualizadas com as solu\u00e7\u00f5es antigas do campo de\npress\u00e3o. Isso foi proposto inicialmente por Hajibeygi et al. (2008)\natrav\u00e9s do m\u00e9todo dos volumes finitos multiescala iterativo - ite-\nrative Multiscale Finite Volume Method (iMsFVM) - desde ent\u00e3o,\ndiversos aperfei\u00e7oamentos foram desenvolvidos para esse m\u00e9todo\n(BONFIGLI; JENNY, 2010; ZHOU, 2010; LUNATI; TYAGI; LEE,\n2011; HAJIBEYGI; JENNY, 2011), dando origem \u00e0 interpreta\u00e7\u00e3o\ndo MsFVM como um pr\u00e9-condicionador voltado para a solu\u00e7\u00e3o\nde problemas el\u00edpticos. Essa abordagem \u00e9 detalhada no cap\u00edtulo\nseguinte.\n\n\n\n\n\n113\n\n5 PR\u00c9-CONDICIONADOR MULTIESCALA ALG\u00c9BRICO\n\nAmbos m\u00e9todos dos volumes finitos multiescala original\n(MsFVM) e iterativo (iMsFVM) podem ser formulados algebri-\ncamente, ou seja, por meio de opera\u00e7\u00f5es envolvendo matrizes e\nvetores (ZHOU, 2006; ZHOU; TCHELEPI, 2008). Isso \u00e9 atraente\npor diversos motivos, entre os quais destacam-se a melhor compre-\nens\u00e3o da qualidade da solu\u00e7\u00e3o obtida por esses m\u00e9todos bem como\ndas propriedades de converg\u00eancia de sua formula\u00e7\u00e3o iterativa e\na viabiliza\u00e7\u00e3o de sua extens\u00e3o natural a malhas corner-point e\nn\u00e3o-estruturadas, apesar de ainda atrelada a aspectos geom\u00e9tricos.\nEm especial no caso do iMsFVM, sua formula\u00e7\u00e3o matricial d\u00e1\norigem ao pr\u00e9-condicionador multiescala alg\u00e9brico, classificado\ncomo uma variante do multigrid de dois n\u00edveis cujo operador de\nprolonga\u00e7\u00e3o \u00e9 constru\u00eddo atrav\u00e9s da resolu\u00e7\u00e3o direta de subpro-\nblemas independentes definidos em malha refinada (ZHOU, 2010;\nZHOU; TCHELEPI, 2012; WANG, 2012; WANG; HAJIBEYGI;\nTCHELEPI, 2014). Tal pr\u00e9-condicionador \u00e9 voltado para a re-\nsolu\u00e7\u00e3o de problemas el\u00edpticos e apresenta como par\u00e2metros de\nconfigura\u00e7\u00e3o os itens citados a seguir.\n\na) o tipo do operador de restri\u00e7\u00e3o empregado para a\nconstru\u00e7\u00e3o do problema em n\u00edvel global.\n\nb) a raz\u00e3o de engrossamento utilizada para a determina-\n\u00e7\u00e3o do tamanho do problema na malha grossa.\n\nc) o tipo de estrat\u00e9gia, denominada como suavizador,\npara a resolu\u00e7\u00e3o aproximada do sistema linear original.\n\nApresenta-se nesse cap\u00edtulo os conceitos envolvidos na\ndefini\u00e7\u00e3o do pr\u00e9-condicionador multiescala alg\u00e9brico bem como\nseu formato matricial. Com o intuito de ilustrar claramente tais\nconceitos, considera-se o mesmo problema teste bidimensional\nempregado no cap\u00edtulo 4. As mudan\u00e7as associadas \u00e0 extens\u00e3o para\no caso 3D consistem basicamente na redefini\u00e7\u00e3o dos operadores\nde interpola\u00e7\u00e3o (prolonga\u00e7\u00e3o e restri\u00e7\u00e3o) utilizados pelo m\u00e9todo\nconforme exposto no ap\u00eandice B.\n\nConsiderando-se a malha refinada ?? ilustrada na figura 7,\na discretiza\u00e7\u00e3o do problema el\u00edptico (4.1) atrav\u00e9s do m\u00e9todo dos\n\n\n\n114 Cap\u00edtulo 5. Pr\u00e9-condicionador Multiescala Alg\u00e9brico\n\nvolumes finitos tradicional1 conduz a um sistema linear do tipo\n(3.1), o qual \u00e9 reescrito a seguir como:\n\nAp = q, (5.1)\n\nem que a vari\u00e1vel desconhecida press\u00e3o \u00e9 definida num conjunto\nfinito de pontos If = {xj}j?[1,nf ], enquanto a matriz A \u00e9 esparsa\ncom estrutura pentadiagonal.\n\nA divis\u00e3o do dom\u00ednio ? conforme volumes primais, ??Ci , e\nduais, ??Dj , induz um particionamento da malha refinada denomi-\nnado como wirebasket e ilustrado na figura 14. Nesse ordenamento,\nos volumes da malha refinada ?? podem ser divididos em tr\u00eas ca-\ntegorias2, conforme:\n\nFigura 14 \u2013 Problema teste: particionamento wirebasket.\n\nx [m]\n0 50 100 150\n\ny \n[m\n\n]\n\n0\n\n50\n\n100\n\n150\n\na) interior (branco), formando um conjunto de \u201cNi\u201d vo-\nlumes denotado por Ii = {xj}j?[1,Ni];\n\n1 Com aproxima\u00e7\u00e3o de dois pontos para o fluxo (TPFA).\n2 No caso de escoamento tridimensional, adiciona-se uma nova categoria:\n\nos volumes de face, que constituem as superf\u00edcies dos volumes de controle\nda malha dual.\n\n\n\n115\n\nb) aresta (verde claro), formando um conjunto de \u201cNe\u201d\nvolumes denotado por Ie = {xj}j?[1,Ne];\n\nc) v\u00e9rtice (azul escuro), formando um conjunto de \u201cNv\u201d\nvolumes denotado por Iv = {xj}j?[1,Nv ].\n\nA uni\u00e3o desses agrupamentos formam o conjunto dos volumes\npertencentes \u00e0 malha refinada ??:\n\nIf = Ii ? Ie ? Iv, (5.2)\n\nsendo que Nf = Ni + Ne + Nv.\nDefinindo-se como Q? a matriz de permuta\u00e7\u00e3o que realiza a\n\ntransfer\u00eancia entre os ordenamentos lexicogr\u00e1fico (natural) e wire-\nbasket, a vari\u00e1vel press\u00e3o pode ser escrita nesse novo ordenamento\ncomo\n\np? = Q?p =\n\n?\n??\np?i\n\np?e\n\np?v\n\n?\n?? , (5.3)\n\ne a matriz A como\n\nA? = Q?AQ?T =\n\n?\n???\n\nA?ii A?ie 0iv\nA?ei A?ee A?ev\n0vi A?ve A?vv\n\n?\n??? , (5.4)\n\nem que a submatriz gen\u00e9rica A?ab tem dimens\u00e3o Na\u00d7Nb e denota\na contribui\u00e7\u00e3o dos volumes de controle da categoria \u201cb\u201d sobre a\nequa\u00e7\u00e3o de conserva\u00e7\u00e3o da massa referente aos volumes da cate-\ngoria \u201ca\u201d. Como o esquema de interpola\u00e7\u00e3o adotado no processo\nde discretiza\u00e7\u00e3o da equa\u00e7\u00e3o diferencial \u00e9 de dois pontos, segue\nque os volumes interiores n\u00e3o influenciam os volumes de v\u00e9rtice\ne vice-versa, portanto A?vi = A?Tiv = 0vi. A figura 15 ilustra a\nestrutura das matrizes original A (\u00e0 esquerda) e reordenada A?\n(\u00e0 direita).\n\nUma vez que as matrizes de permuta\u00e7\u00e3o s\u00e3o ortogonais,\ntem-se que Q?T = Q??1 e Q?T Q? = I. Logo, o sistema linear (5.1)\npode ser reescrito na forma reordenada como:\n\nQ?AQ?T Q?p = Q?q\n\n? A?p? = q?. (5.5)\n\n\n\n116 Cap\u00edtulo 5. Pr\u00e9-condicionador Multiescala Alg\u00e9brico\n\nFigura 15 \u2013 Problema teste: estrutura da matriz de coeficientes\noriginal, \u00e0 esquerda, e reordenada, \u00e0 direita.\n\nnz = 1065\n0 50 100 150 200\n\n0\n\n50\n\n100\n\n150\n\n200\n\nnz = 1065\n0 144 216\n\n0\n\n144\n\n216\n\nO sistema linear resolvido pelo MsFVM usando-se as\nfun\u00e7\u00f5es de corre\u00e7\u00e3o, apresentadas na se\u00e7\u00e3o 4.4, consiste numa\naproxima\u00e7\u00e3o desse \u00faltimo e pode ser escrito como\n\nMmswcp?\n?\n\n= q?\n?\n, (5.6)\n\nem que Mmswc representa o operador multiescala considerando-se\nas fun\u00e7\u00f5es de corre\u00e7\u00e3o, o qual \u00e9 dado por\n\nMmswc =\n\n?\n???\n\nA?ii A?ie 0iv\n0ei Mee A?ev\n0vi 0ve Mvv\n\n?\n??? . (5.7)\n\nJ\u00e1 o lado direito q?\n?\nda equa\u00e7\u00e3o (5.6) \u00e9 denominado como vetor\n\nindependente modificado, sendo dado por:\n\nq?\n?\n\n=\n\n?\n???\nq?i\n\nq?\n?\ne\n\nq?\n?\nv\n\n?\n??? . (5.8)\n\nA matriz Mmswc \u00e9 obtida a partir de A? ao desconsiderar-\nse a contribui\u00e7\u00e3o dos volumes de interior \u201ci\u201d sobre a equa\u00e7\u00e3o\n\n\n\n117\n\nda conserva\u00e7\u00e3o da massa referente aos volumes de aresta \u201ce\u201d,\nbem como a contribui\u00e7\u00e3o desses \u00faltimos \u00e0 equa\u00e7\u00e3o relativa aos\nvolumes de v\u00e9rtice \u201cv\u201d, ou seja, A?ei = 0ei e A?ve = 0ve. Na figura\n16 verifica-se uma compara\u00e7\u00e3o entre as estruturas das matrizes A?\n(\u00e0 esquerda) e Mmswc (\u00e0 direita) exibidas pelo problema teste.\n\nFigura 16 \u2013 Problema teste: estrutura da matriz de coeficientes\nreordenada, \u00e0 esquerda, e da matriz que gera o pr\u00e9-\ncondicionador multiescala com fun\u00e7\u00f5es de corre\u00e7\u00e3o,\n\u00e0 direita.\n\nnz = 1065\n0 144 216\n\n0\n\n144\n\n216\n\nnz = 925\n0 144 216\n\n0\n\n144\n\n216\n\nNota-se que o n\u00famero de elementos n\u00e3o nulos \u00e9 reduzido\npara o segundo operador (de 1065 para 925, nesse caso). Al\u00e9m\ndisso, a quebra das conex\u00f5es provenientes dos volumes de inte-\nrior em sentido aos de aresta, A?ei, bem como desses \u00faltimos em\nsentido aos volumes de v\u00e9rtice, A?ve, faz com que os problemas\nlocais definidos em volumes duais distintos tornem-se desacopla-\ndos entre si. Isso pode ser visualizado claramente nas figuras\n17 e 18 que mostram as estruturas das submatrizes A?ii e Mee,\nrespectivamente.\n\nTal desacoplamento entre os problemas locais permite\nque sua resolu\u00e7\u00e3o possa ser realizada de acordo com estrat\u00e9gias\nparalelas ou ent\u00e3o que haja menor grau de preenchimento quando\nalgum m\u00e9todo de solu\u00e7\u00e3o direto, como fatora\u00e7\u00e3o LU 3.2.1, \u00e9\nempregado.\n\n\n\n118 Cap\u00edtulo 5. Pr\u00e9-condicionador Multiescala Alg\u00e9brico\n\nFigura 17 \u2013 Problema teste: estrutura da matriz Aii.\n\nFigura 18 \u2013 Problema teste: estrutura da matriz Mee.\n\n\n\n119\n\nComo consequ\u00eancia da considera\u00e7\u00e3o A?ei = 0ei, a matriz\nA?ee precisa ser atualizada de modo que contribui\u00e7\u00f5es provenientes\nde volumes interiores sejam descartadas. Isso \u00e9 realizado com a\ndefini\u00e7\u00e3o do operador de \u201cproblema reduzido\u201d:\n\nMee = A?ee + diag\n(?\n\ni\n\nA?Tie\n\n)\n, (5.9)\n\nem que o operador diag () transforma um vetor em uma matriz\ndiagonal.\n\nA submatriz Mvv, de dimens\u00e3o Nv \u00d7Nv, refere-se ao pro-\nblema definido na malha primal ou grossa, j\u00e1 descrito na se\u00e7\u00e3o 4.2.\nTal matriz tamb\u00e9m \u00e9 referida como operador grosseiro ou global\ne pode ser constru\u00edda algebricamente, o que ser\u00e1 apresentado na\nse\u00e7\u00e3o 5.2. Como sua dimens\u00e3o \u00e9 muito menor que a dimens\u00e3o\nde Mmswc, \u00e9 dif\u00edcil de se visualizar claramente a estrutura dessa\nmatriz na figura 16, portanto, ela \u00e9 apresentada isoladamente na\nfigura 19.\n\nFigura 19 \u2013 Problema teste: estrutura da matriz M?vv.\n\nnz = 49\n\n0 3 6 9\n0\n\n3\n\n6\n\n9\n\n\n\n120 Cap\u00edtulo 5. Pr\u00e9-condicionador Multiescala Alg\u00e9brico\n\nAqui fica claro que o stencil do operador grosseiro no\ncaso 2D \u00e9 de 9 pontos, portanto, o c\u00e1lculo da inc\u00f3gnita referente\na um determinado volume de controle envolve as informa\u00e7\u00f5es\nde seus vizinhos nas dire\u00e7\u00f5es vertical, horizontal e tamb\u00e9m di-\nagonal. Isso \u00e9 semelhante ao observado para uma discretiza\u00e7\u00e3o\natrav\u00e9s do m\u00e9todo dos volumes finitos cujo c\u00e1lculo dos fluxos\natrav\u00e9s das fronteiras \u00e9 realizado segundo um esquema baseado\nem m\u00faltiplos pontos - Multipoint Flux Approximation (MPFA)\n(AAVATSMARK, 2002; AMBRUS, 2009).\n\nPor \u00faltimo, o vetor q?\n?\n\u00e9 obtido de q? mediante as seguintes\n\nconsidera\u00e7\u00f5es:\na) a componente q?\n\n?\ni \u00e9 igual \u00e0 q?i;\n\nb) a componente q?\n?\ne \u00e9 calculada a partir de q?e ao desprezar-\n\nse a componente normal de sua parcela gravitacional.\nIsso \u00e9 induzido pela hip\u00f3tese de localiza\u00e7\u00e3o empregada\nna defini\u00e7\u00e3o das condi\u00e7\u00f5es de contorno dos problemas\nduais (4.2);\n\nc) a componente q?\n?\nv \u00e9 definida como o vetor independente\n\ndo problema em n\u00edvel grosseiro, apresentado na se\u00e7\u00e3o\n4.2. A defini\u00e7\u00e3o alg\u00e9brica dessa componente \u00e9 realizada\nna se\u00e7\u00e3o a seguir.\n\n5.1 OPERADORES DE TRANSFER\u00caNCIA\n\nA matriz Mmswc tem formato blocado e triangular supe-\nrior, isso permite que o sistema linear (5.6) possa ser resolvido\natrav\u00e9s de um processo de substitui\u00e7\u00e3o reversa em blocos, condu-\nzindo \u00e0 seguinte solu\u00e7\u00e3o:\n\np?\n?\nv = M\n\n?1\nvv q?\n\n?\nv; (5.10a)\n\np?\n?\ne = ?Mee\n\n(\nA?evp?\n\n?\nv ? q?\n\n?\ne\n\n)\n; (5.10b)\n\np?\n?\ni = ?A?\n\n?1\nii\n\n(\nA?iep?\n\n?\ne ? q?\n\n?\ni\n\n)\n= A??1ii\n\n[\nA?ieM?1ee\n\n(\nA?evp?\n\n?\nv ? q?\n\n?\ne\n\n)\n? q?\n\n?\ni\n\n]\n,\n\n(5.10c)\n\n\n\n5.1. Operadores de Transfer\u00eancia 121\n\na qual pode ser expressa em formato matricial conforme:\n\n?\n???\np?\n?\ni\n\np?\n?\ne\n\np?\n?\nv\n\n?\n??? =\n\n?\n???\n\nA??1ii A?ieM\n?1\nee A?ev\n\n?M?1ee A?ev\nIvv\n\n?\n??? p??v+\n\n?\n???\n\nA??1ii ?A?\n?1\nii A?ieM\n\n?1\nee 0iv\n\n0ei M?1ee 0ev\n0vi 0ve 0vv\n\n?\n???\n?\n???\nq?i\n\nq?\n?\ne\n\nq?\n?\nv\n\n?\n??? .\n\n(5.11)\n\nEsta resposta motiva a defini\u00e7\u00e3o de operadores lineares cuja\ncombina\u00e7\u00e3o produz o pr\u00e9-condicionador multiescala alg\u00e9brico\ncom fun\u00e7\u00f5es de corre\u00e7\u00e3o M?1mswc. O primeiro deles \u00e9 o operador\nde prolonga\u00e7\u00e3o, dado por:\n\nP =\n\n?\n???\n\nA??1ii A?ieM\n?1\nee A?ev\n\n?M?1ee A?ev\nIvv\n\n?\n??? . (5.12)\n\nEste \u00e9 retangular de ordem igual a Nf \u00d7Nv e tem como objetivo a\ntransfer\u00eancia de informa\u00e7\u00f5es do n\u00edvel grosso para o n\u00edvel refinado.\n\u00c9 interessante notar que as colunas dessa matriz possuem uma\ninterpreta\u00e7\u00e3o especial: a de \u00edndice \u201ci\u201d \u00e9 formada pelo somat\u00f3rio\ndas fun\u00e7\u00f5es base duais que assumem valor unit\u00e1rio no centro do\nvolume de mesmo \u00edndice referente \u00e0 malha primal, ou seja:\n\nPei =\n?\nj\n\n?\nj\ni. (5.13)\n\nO formato do operador de prolonga\u00e7\u00e3o para o problema\nteste \u00e9 apresentado \u00e0 esquerda da figura 20. \u00c0 sua direita ilustram-\nse os volumes da malha refinada que s\u00e3o abrangidos pelo processo\nde prolonga\u00e7\u00e3o quando a informa\u00e7\u00e3o considerada \u00e9 proveniente\ndos volumes primais 1 (laranja), 3 (azul), 7 (vermelho) e 9 (verde).\n\n\n\n122 Cap\u00edtulo 5. Pr\u00e9-condicionador Multiescala Alg\u00e9brico\n\nFigura 20 \u2013 Problema teste: interpreta\u00e7\u00e3o para as colunas da\nmatriz P.\n\nA matriz quadrada de ordem Nf\u00d7Nf presente no segundo\ntermo da equa\u00e7\u00e3o (5.11) leva \u00e0 defini\u00e7\u00e3o do operador de corre\u00e7\u00e3o\n\nC =\n\n?\n???\n\nA??1ii ?A?\n?1\nii A?ieM\n\n?1\nee 0iv\n\n0ei M?1ee 0ev\n0vi 0ve 0vv\n\n?\n??? , (5.14)\n\no qual desempenha o papel das fun\u00e7\u00f5es de corre\u00e7\u00e3o apresentadas\nna se\u00e7\u00e3o 4.4. De fato, o termo Cq?\n\n?\n\u00e9 igual ao somat\u00f3rio das fun\u00e7\u00f5es\n\nde corre\u00e7\u00e3o referentes a cada um dos volumes de controle que\nformam a malha dual ??D, isto \u00e9:\n\nCq?\n?\n\n=\nND?\nj=1\n\n??j. (5.15)\n\nAo contr\u00e1rio do operador de prolonga\u00e7\u00e3o, o operador\nde corre\u00e7\u00e3o n\u00e3o \u00e9 formado explicitamente, pois isso envolveria o\nc\u00e1lculo expl\u00edcito de matrizes inversas, o que \u00e9 muito caro computa-\ncionalmente e deve ser evitado. No pr\u00e9-condicionador multiescala,\n\n\n\n5.1. Operadores de Transfer\u00eancia 123\n\na matriz C \u00e9 empregada somente em opera\u00e7\u00f5es matem\u00e1ticas do\ntipo produto matriz/vetor, portanto, \u00e9 suficiente o c\u00e1lculo de sua\na\u00e7\u00e3o sobre um vetor arbitr\u00e1rio, conforme:\n\nCq?\n?\n\n=\n\n?\n???\n\nA??1ii\n(\nq?i ? A?ieM?1ee q?\n\n?\ne\n\n)\nM?1ee q?\n\n?\ne\n\n0vv\n\n?\n??? . (5.16)\n\nA t\u00edtulo de exemplifica\u00e7\u00e3o, o formato do operador C para\no problema teste \u00e9 mostrado na figura 21, em que \u00e9 poss\u00edvel\nobservar as inc\u00f3gnitas afetadas pela aplica\u00e7\u00e3o desse operador.\nSomente as submatrizes que se referem aos volumes de v\u00e9rtice\ns\u00e3o nulas, portanto, as inc\u00f3gnitas referentes a tais volumes s\u00e3o as\n\u00fanicas que n\u00e3o s\u00e3o afetadas pelo operador em quest\u00e3o.\n\nFigura 21 \u2013 Problema teste: formato do operador de corre\u00e7\u00e3o C.\n\nnz = 3440\n\n0 144 216\n0\n\n144\n\n216\n\nPor fim, define-se o operador de restri\u00e7\u00e3o R, cujo objetivo\nconsiste na transfer\u00eancia de informa\u00e7\u00f5es do n\u00edvel refinado para\no grosseiro. Ou seja, este apresenta o papel inverso do operador\nde prolonga\u00e7\u00e3o P. O operador R \u00e9 representado por uma matriz\nretangular de ordem Nv \u00d7Nf, a qual pode ser constru\u00edda a partir\n\n\n\n124 Cap\u00edtulo 5. Pr\u00e9-condicionador Multiescala Alg\u00e9brico\n\nde duas estrat\u00e9gias distintas: a primeira \u00e9 baseada em volumes\nfinitos sendo que a matriz obtida \u00e9 chamada de RFV , enquanto\na segunda \u00e9 baseada em elementos finitos, conduzindo \u00e0 matriz\nRFE.\n\nA primeira escolha traduz algebricamente o processo de\nrestri\u00e7\u00e3o presente no m\u00e9todo dos volumes finitos multiescala\n(MsFVM). Nesse caso, os volumes de controle da malha refinada\nque formam o mesmo volume de controle da malha primal con-\ntribuem de modo equivalente para a transfer\u00eancia de informa\u00e7\u00e3o\nentre as duas malhas. Sua defini\u00e7\u00e3o alg\u00e9brica \u00e9 dada pela equa\u00e7\u00e3o\n(5.17), enquanto que seu formato para o problema teste \u00e9 ilustrado\nna figura 22\n\n(RFV )ij =\n{\n\n1 se o volume j est\u00e1 contido em ?i;\n0 caso contr\u00e1rio.\n\n(5.17)\n\nFigura 22 \u2013 Problema teste: operador de restri\u00e7\u00e3o RFV .\n\nEnquanto o operador RFV est\u00e1 para o m\u00e9todo dos vo-\nlumes finitos multiescala, o operador RFE est\u00e1 para o m\u00e9todo\ndos elementos finitos multiescala (MsFEM). Nesse caso, diz-se\nque o operador de restri\u00e7\u00e3o \u00e9 do tipo Galerkin sendo dado pelo\ntransposto do operador de prolonga\u00e7\u00e3o, ou seja:\n\nRFE = PT . (5.18)\n\nNo operador RFE, pondera-se a contribui\u00e7\u00e3o de diferen-\ntes volumes de controle durante o processo de transfer\u00eancia de\ninforma\u00e7\u00e3o entre as malhas refinada e grosseira. Essa escolha\nconduz a pr\u00e9-condicionadores multiescala eficientes em termos de\n\n\n\n5.2. Problema na Malha Grossa 125\n\nconverg\u00eancia num\u00e9rica, no entanto, a propriedade de conserva-\n\u00e7\u00e3o da massa em ambos n\u00edveis grosseiro e refinado deixa de ser\natendida.\n\nQuando o operador RFE \u00e9 utilizado para a constru\u00e7\u00e3o\ndo problema em n\u00edvel grosso, uma estrat\u00e9gia comumente empre-\ngada para preservar a propriedade conservativa do campo de\npress\u00e3o em escala grosseira consiste em aplicar uma itera\u00e7\u00e3o do\npr\u00e9-condicionador multiescala alg\u00e9brico baseado em volumes fi-\nnitos na etapa de p\u00f3s-processamento da solu\u00e7\u00e3o. Desse modo, \u00e9\nposs\u00edvel tamb\u00e9m aplicar a estrat\u00e9gia de reconstru\u00e7\u00e3o do campo\nde velocidade a fim de obter um campo conservativo em escala\nrefinada.\n\n5.2 PROBLEMA NA MALHA GROSSA\n\nDefinidos os operadores de prolonga\u00e7\u00e3o e corre\u00e7\u00e3o, segue\nque a solu\u00e7\u00e3o proposta pelo pr\u00e9-condicionador multiescala com\nfun\u00e7\u00f5es de corre\u00e7\u00e3o M?1mswc (5.11) pode ser reescrita da seguinte\nmaneira:\n\np? = Pp?\n?\nv + Cq?\n\n?\n. (5.19)\n\nSubstituindo-se a equa\u00e7\u00e3o (5.19) para p? no sistema linear\noriginal reordenado (5.5), obt\u00e9m-se o seguinte sistema para a\nvari\u00e1vel p?\n\n?\nv:\n\nA?Pp?\n?\nv =\n\n(\nI ? A?C\n\n)\nq?. (5.20)\n\nComo esse \u00e9 um sistema retangular, multiplica-se ambos os lados\npelo operador de restri\u00e7\u00e3o R, gerando o seguinte problema de\ndimens\u00e3o Nv \u00d7Nv em n\u00edvel grosseiro:\n\nMvvp?\n?\nv = q?\n\n?\nv, (5.21)\n\nsendo que\nMvv = RA?P (5.22)\n\ndenota a matriz de coeficientes e\n\nq?\n?\nv = R\n\n(\nI ? A?C\n\n)\nq? (5.23)\n\ndenota o vetor independente referente ao problema grosseiro.\n\n\n\n126 Cap\u00edtulo 5. Pr\u00e9-condicionador Multiescala Alg\u00e9brico\n\n5.3 DEFINI\u00c7\u00c3O DO PR\u00c9-CONDICIONADOR\n\nCombinando-se as equa\u00e7\u00f5es (5.19), (5.21), (5.22) e (5.23),\no pr\u00e9-condicionador multiescala alg\u00e9brico com fun\u00e7\u00f5es de corre\u00e7\u00e3o\nM?1mswc pode ser representado na seguinte forma compacta:\n\nM?1mswc = P\n(\nRA?P\n\n)?1\nR (I ? AC) + C, (5.24)\n\no qual ap\u00f3s algumas manipula\u00e7\u00f5es alg\u00e9bricas pode ser reescrito\ncomo:\n\nM?1mswc = M\n?1\nms + C ? M\n\n?1\nmsA?C, (5.25)\n\nem que M?1ms \u00e9 denominado simplesmente como pr\u00e9-condicionador\nmultiescala, sendo dado por:\n\nM?1ms = P\n(\nRA?P\n\n)?1\nR. (5.26)\n\nQuando o operador de restri\u00e7\u00e3o baseado em volumes\nfinitos, RFV , \u00e9 empregado para a constru\u00e7\u00e3o pr\u00e9-condicionador\nmultiescala, obt\u00e9m-se o pr\u00e9-condicionador multiescala baseado\nem volumes finitos:\n\nM?1msfv = P\n(\nRFV A?P\n\n)?1\nRFV . (5.27)\n\nPor outro lado, quando o operador de restri\u00e7\u00e3o do tipo galer-\nkin, RFE, \u00e9 utilizado, obt\u00e9m-se o pr\u00e9-condicionador multiescala\nbaseado em elementos finitos:\n\nM?1msfe = P\n(\nPT A?P\n\n)?1\nPT . (5.28)\n\nAmbos operadores M?1ms e M?1mswc n\u00e3o s\u00e3o formados expli-\ncitamente, pois, da mesma forma como explicado para o operador\nC, \u00e9 de interesse somente o c\u00e1lculo de sua a\u00e7\u00e3o sobre um vetor\narbitr\u00e1rio. Esse processo envolve claramente o c\u00e1lculo da inversa\nda matriz Mvv, o que \u00e9 realizado diretamente atrav\u00e9s de fato-\nra\u00e7\u00e3o LU 3.2.1, j\u00e1 que o tamanho desse sistema linear costuma\nser pequeno. Al\u00e9m disso, a aplica\u00e7\u00e3o do operador de corre\u00e7\u00e3o\nC, presente no pr\u00e9-condicionador M?1mswc, envolve a resolu\u00e7\u00e3o de\n\n\n\n5.3. Defini\u00e7\u00e3o do Pr\u00e9-Condicionador 127\n\nsistemas lineares definidos pelas matrizes A?ii e M?ee, o que tam-\nb\u00e9m \u00e9 feito de modo direto. O c\u00f3digo computacional desenvolvido\nno presente trabalho permite a resolu\u00e7\u00e3o desses sistemas atrav\u00e9s\nde algum m\u00e9todo iterativo, no entanto, foi verificado que para\nos problemas testados, a estrat\u00e9gia de solu\u00e7\u00e3o direta mostrou-se\nmais eficiente.\n\nQuando o pr\u00e9-condicionador M?1mswc \u00e9 utilizado em con-\njunto com o m\u00e9todo iterativo de Richardson, o processo iterativo\n\np?k+1 = p?k + M?1mswc\n(\nq? ? A?p?\n\n)\n(5.29)\n\npode ser dividido em dois est\u00e1gio e visto da seguinte maneira:\n\np?k+1/2 = p?k + C\n(\nq? ? A?p?k\n\n)\n; (5.30a)\n\np?k+1 = p?k+1/2 + M?1ms\n(\nq? ? A?p?k+1/2\n\n)\n, (5.30b)\n\nem que o primeiro est\u00e1gio \u00e9 denominado como local e encarrega-se\nde atualizar a solu\u00e7\u00e3o atrav\u00e9s das fun\u00e7\u00f5es de corre\u00e7\u00e3o, enquanto\no segundo \u00e9 denominado como global e tem como objetivo a\natualiza\u00e7\u00e3o da solu\u00e7\u00e3o por meio do operador multiescala. Nessa\ndivis\u00e3o fica claro que o pr\u00e9-condicionador multiescala alg\u00e9brico\ncom fun\u00e7\u00f5es de corre\u00e7\u00e3o pode ser visto como uma combina\u00e7\u00e3o\ndo tipo multiplicativa dos pr\u00e9-condicionadores de corre\u00e7\u00e3o C\ne multiescala M?1ms. Adiciona-se ainda que o primeiro est\u00e1gio\ntrabalha no n\u00edvel refinado da malha e reduz as componentes do\nerro de alta frequ\u00eancia enquanto o segundo trabalha no n\u00edvel\ngrosseiro e reduz as componentes de baixa frequ\u00eancia.\n\nEm problemas complexos, como aqueles que apresentam\ncampos de permeabilidade anisotr\u00f3picos ou fortemente canaliza-\ndos, Hajibeygi, Karvounis e Jenny (2011), Wang (2012) e Wang,\nHajibeygi e Tchelepi (2014) descreveram em seus trabalhos que\ntorna-se necess\u00e1rio a adi\u00e7\u00e3o de um novo est\u00e1gio local, tamb\u00e9m\ndenominado como suavizador, ao pr\u00e9-condicionador multiescala a\nfim de que este seja convergente. O trabalho pioneiro de Hajibeygi,\nKarvounis e Jenny (2011) avaliou estrat\u00e9gias de relaxa\u00e7\u00e3o em\nlinha (LR), enquanto que Wang (2012) empregou fatora\u00e7\u00e3o LU\n\n\n\n128 Cap\u00edtulo 5. Pr\u00e9-condicionador Multiescala Alg\u00e9brico\n\nincompleta em blocos (BILU)3, al\u00e9m da fatora\u00e7\u00e3o ILU tradicional\nem trabalho posterior, dando origem ao pr\u00e9-condicionador AMS\n(WANG; HAJIBEYGI; TCHELEPI, 2014). O presente trabalho\nconsidera as duas \u00faltimas alternativas al\u00e9m de empregar tam-\nb\u00e9m suavizadores simples baseados em sobre-relaxa\u00e7\u00e3o sucessiva\n(SOR), bem como suavizadores mais robustos como aqueles base-\nados em Schwarz aditivo com resolu\u00e7\u00e3o exata dos subproblemas\nlocais.\n\nSeja M?1l a matriz de pr\u00e9-condicionamento referente \u00e0\nestrat\u00e9gia de suaviza\u00e7\u00e3o considerada, conhecida tamb\u00e9m como a\nmatriz de pr\u00e9-condicionamento referente ao est\u00e1gio local ou ent\u00e3o\nsimplesmente como pr\u00e9-condicionador local. De modo geral, o pr\u00e9-\ncondicionador multiescala constru\u00eddo a partir dessa alternativa\npode ser escrito da seguinte maneira:\n\np?k+1/2 = p?k + M?1l\n(\nq? ? A?p?k\n\n)\n;\n\np?k+1 = p?k+1/2 + M?1ms\n(\nq? ? A?p?k+1/2\n\n)\n, (5.31a)\n\nem que o primeiro est\u00e1gio \u00e9 de suaviza\u00e7\u00e3o, enquanto o segundo\nrefere-se \u00e0 corre\u00e7\u00e3o em n\u00edvel global. Este \u00faltimo \u00e9 identificado de\nmodo gen\u00e9rico pelo operador M?1ms, o qual deve ser substitu\u00eddo\npor M?1msfv ou M\n\n?1\nmsfe, de acordo com a estrat\u00e9gia empregada\n\npara o operador de restri\u00e7\u00e3o.\nQuando dois ou mais suavizadores s\u00e3o utilizados, aumenta-\n\nse proporcionalmente o n\u00famero de est\u00e1gios locais sendo que estes\ns\u00e3o combinados de modo multiplicativo, ou seja, a solu\u00e7\u00e3o obtida\nno primeiro est\u00e1gio \u00e9 utilizada para o c\u00e1lculo da solu\u00e7\u00e3o referente\nao segundo. A t\u00edtulo de exemplo, considerando os suavizadores\nbaseados em fatora\u00e7\u00e3o incompleta e fun\u00e7\u00f5es de corre\u00e7\u00e3o, obt\u00e9m-se\n\n3 Tal estrat\u00e9gia \u00e9 equivalente ao uso do pr\u00e9-condicionador Schwarz adi-\ntivo (AS) sem nenhuma sobreposi\u00e7\u00e3o entre os problemas locais, os quais\ns\u00e3o resolvidos por uma \u00fanica itera\u00e7\u00e3o do pr\u00e9-condicionador baseado em\nfatora\u00e7\u00e3o LU incompleta.\n\n\n\n5.4. Reconstru\u00e7\u00e3o do Campo de Velocidades 129\n\no seguinte pr\u00e9-condicionador:\n\np?k+1/3 = p?k + ILU(A?)\n(\nq? ? A?p?k\n\n)\n;\n\np?k+1/2 = p?k+1/3 + C\n(\nq? ? A?p?k+1/3\n\n)\n;\n\np?k+1 = p?k+1/2 + M?1ms\n(\nq? ? A?p?k+1/2\n\n)\n, (5.32a)\n\nque tamb\u00e9m pode ser representado compactamente da seguinte\nmaneira:\n\nM?1mshs =\n[\nI ?\n\n(\nI ? ILU(A?)A?\n\n)(\nI ? CA?\n\n)(\nI ? M?1msA?\n\n)]\nA??1.\n(5.33)\n\nNota-se que os diferentes par\u00e2metros discutidos at\u00e9 agora para\na defini\u00e7\u00e3o do pr\u00e9-condicionador multiescala n\u00e3o conduzem \u00e0\nestrat\u00e9gias sim\u00e9tricas, j\u00e1 que os est\u00e1gios do pr\u00e9-condicionador s\u00e3o\nexecutados num \u00fanico sentido. No entanto, durante a resolu\u00e7\u00e3o\nde problemas sim\u00e9tricos, como os considerados nesse trabalho, \u00e9\ndesej\u00e1vel o uso de pr\u00e9-condicionadores que apresentem tamb\u00e9m\ntal caracter\u00edstica. Isso viabiliza o uso de solvers iterativos voltados\npara tal classe de problemas como o m\u00e9todo do gradiente con-\njugado, o qual apresenta a vantagem de requerer menor quantia\nde espa\u00e7o para o armazenamento dos vetores e matrizes envolvi-\ndos em seu algoritmo em rela\u00e7\u00e3o a outros m\u00e9todos comumente\nutilizados para problemas n\u00e3o-sim\u00e9tricos como o GMRes.\n\nCom o intuito de tornar sim\u00e9trico o pr\u00e9-condicionador\nmultiescala, faz-se com que seus est\u00e1gios locais sejam executados\nantes e ap\u00f3s a aplica\u00e7\u00e3o de seu est\u00e1gio global. Essa ideia \u00e9 justa-\nmente a empregada pelos pr\u00e9-condicionadores multigrid com ciclo\nV. Uma segunda considera\u00e7\u00e3o necess\u00e1ria para que a caracter\u00edstica\nde simetria seja observada consiste no fato de empregarem-se su-\navizadores sim\u00e9tricos em conjunto com o operador global M?1msfe,\nj\u00e1 que o M?1msfv n\u00e3o atende a caracter\u00edstica desejada.\n\n5.4 RECONSTRU\u00c7\u00c3O DO CAMPO DE VELOCIDADES\n\nA reconstru\u00e7\u00e3o do campo de velocidades apresentada para\no m\u00e9todo dos volumes finitos multiescala na se\u00e7\u00e3o 4.3 tamb\u00e9m\n\n\n\n130 Cap\u00edtulo 5. Pr\u00e9-condicionador Multiescala Alg\u00e9brico\n\nest\u00e1 presente no pr\u00e9-condicionador multiescala alg\u00e9brico. A jus-\ntificativa para esse processo \u00e9 a mesma de antes: o campo de\nvelocidades calculado a partir do campo de press\u00e3o resolvido por\ntal pr\u00e9-condicionador \u00e9 descont\u00ednuo nas fronteiras dos volumes de\ncontrole duais, portanto deseja-se encontrar uma corre\u00e7\u00e3o para o\ncampo de press\u00e3o que conduza a um campo de velocidade cont\u00ed-\nnuo e que, por conseguinte, represente uma solu\u00e7\u00e3o conservativa\npara o balan\u00e7o de massa no n\u00edvel refinado de malha.\n\nComo as fronteiras dos volumes de controle primais est\u00e3o\ncontidas no interior dos volumes de controle da malha dual, segue\nque o campo de velocidade j\u00e1 \u00e9 cont\u00ednuo atrav\u00e9s nessas regi\u00f5es. Tal\ninforma\u00e7\u00e3o pode ser empregada para a especifica\u00e7\u00e3o de condi\u00e7\u00f5es\nde contorno de fluxo prescrito (Neumman) em problemas locais\ndefinidos nos volumes de controle da malha primal. O \u00fanico pr\u00e9-\nrequisito para tanto \u00e9 que o campo de press\u00e3o obtido em malha\ngrosseira seja conservativo, o que pode ser alcan\u00e7ado desde que\no pr\u00e9-condicionador multiescala empregue o operador RFV no\n\u00faltimo passo do processo iterativo.\n\nPara a reconstru\u00e7\u00e3o do campo de velocidades, define-se\num novo operador de permuta\u00e7\u00e3o Q? que substitui o ordenamento\nlexicogr\u00e1fico observado na malha refinada por um ordenamento\ndo mesmo tipo, por\u00e9m, definido localmente de acordo com os\nvolumes de controle da malha primal. Desse modo, o sistema\nlinear (5.1) pode ser reescrito da seguinte forma:\n\nA?p? = q?, (5.34)\n\nem que A? = Q?AQ?T denota a matriz de coeficientes reordenada,\na qual pode ser verificada na figura 23 para o problema teste.\n\nTal matriz pode ser decomposta da seguinte forma:\n\nA? = L + D + U, (5.35)\n\nem que D \u00e9 uma matriz diagonal composta por \u201cNC\u201d blocos4\ncontendo as transmissibilidades relativas aos volumes da malha\n4 Estes apresentam estrutura pentadiagonal no caso de problemas bidimen-\n\nsionais ou heptadiagonal no caso de problemas tridimensionais.\n\n\n\n5.4. Reconstru\u00e7\u00e3o do Campo de Velocidades 131\n\nFigura 23 \u2013 Problema teste: estrutura da matriz A?.\n\nrefinada que os comp\u00f5em, enquanto que L e U s\u00e3o matrizes\ntriangulares inferior e superior, respectivamente, que incluem as\nconex\u00f5es entre volumes da malha refinada pertencentes a volumes\nprimais distintos.\n\nDesse modo, os problemas locais definidos nos volumes\nde controle da malha primal podem ser expressos da seguinte\nmaneira:\n\nD\n?\np? = q? ?\n\n(\nA? ? D\n\n?\n)\n\nQ?Q?Tp\n?\n, (5.36)\n\nem que o segundo termo do lado direito representa o fluxo atrav\u00e9s\ndas fronteiras dos volumes de controle da malha primal. Nesse\ntermo, p\n\n?\n\u00e9 a press\u00e3o obtida pela aplica\u00e7\u00e3o do m\u00e9todo iterativo\n\nassociado ao pr\u00e9-condicionador multiescala. Como tal vari\u00e1vel \u00e9\nexpressa no ordenamento wirebasket, ela precisa ser multiplicada\npelas matrizes de permuta\u00e7\u00e3o Q? e Q?T a fim de que seja repre-\nsentada no novo ordenamento. Por fim, a matriz D\n\n?\nconsiste em\n\numa corre\u00e7\u00e3o da matriz D necess\u00e1ria por conta da especifica\u00e7\u00e3o\ndesses fluxos, a qual \u00e9 dada por:\n\nD\n?\n\n= D + diag\n[?\n\ni\n\n(Lij + Uij)\n]\n. (5.37)\n\n\n\n132 Cap\u00edtulo 5. Pr\u00e9-condicionador Multiescala Alg\u00e9brico\n\nAp\u00f3s o c\u00e1lculo do novo campo de press\u00e3o p?, o campo de\nvelocidades reconstru\u00eddo pode ser encontrado pela aplica\u00e7\u00e3o da\nequa\u00e7\u00e3o de Darcy (2.3).\n\n\n\n133\n\n6 RESULTADOS\n\nNesse cap\u00edtulo, apresentam-se aspectos matem\u00e1ticos e\ncomputacionais referentes a diferentes estrat\u00e9gias para a solu\u00e7\u00e3o\nde problemas el\u00edpticos presentes na simula\u00e7\u00e3o de reservat\u00f3rios.\nEnfoque maior \u00e9 dado \u00e0s estrat\u00e9gias de pr\u00e9-condicionamento\npara m\u00e9todos iterativos visando a obten\u00e7\u00e3o de solu\u00e7\u00f5es precisas\ne tamb\u00e9m aproximadas dos problemas tratados. Considera-se,\nem especial, como os par\u00e2metros de configura\u00e7\u00e3o relativos ao\npr\u00e9-condicionador multiescala influenciam na qualidade dessa\nestrat\u00e9gia. Desse modo busca-se a melhor combina\u00e7\u00e3o poss\u00edvel\nem termos de efici\u00eancia e robustez do pr\u00e9-condicionador.\n\nConsideram-se quatro problemas teste comumente em-\npregados para a avalia\u00e7\u00e3o de novas estrat\u00e9gias de solu\u00e7\u00e3o. Os\ncampos de permeabilidade da rocha-reservat\u00f3rio empregados por\ntais casos s\u00e3o altamente heterog\u00eaneos, ou seja, apresentam vari-\na\u00e7\u00f5es de cinco ou mais ordens de grandeza ao longo do espa\u00e7o.\nTal caracter\u00edstica conduz a sistemas lineares com elevados graus\nde mal condicionamento, o que consiste em um grande desafio\npara a resolu\u00e7\u00e3o eficiente desses sistemas atrav\u00e9s de m\u00e9todos\niterativos bem como para a resolu\u00e7\u00e3o exata atrav\u00e9s de m\u00e9todos\ndiretos, devido \u00e0 resolu\u00e7\u00e3o limitada apresentada pela m\u00e1quina na\nrepresenta\u00e7\u00e3o dos n\u00fameros.\n\nDo ponto de vista matem\u00e1tico, ser\u00e3o mostradas a varia\u00e7\u00e3o\ndos res\u00edduos precondicionado e real ao longo das itera\u00e7\u00f5es, bem\ncomo o espectro aproximado do operador pr\u00e9-condicionado M?1A\nquando o m\u00e9todo de solu\u00e7\u00e3o adotado for iterativo. J\u00e1 do ponto de\nvista computacional, ser\u00e3o apresentados informa\u00e7\u00f5es detalhadas a\nrespeito do tempo e da quantidade de mem\u00f3ria RAM necess\u00e1rias\npara a resolu\u00e7\u00e3o de sistemas lineares. Em conjunto, tais resultados\npermitem avaliar a qualidade da estrat\u00e9gia de solu\u00e7\u00e3o.\n\nOs m\u00e9todos de solu\u00e7\u00e3o diretos abordados nesse trabalho\ns\u00e3o apresentados na tabela 1.\n\nConsiderando-se os m\u00e9todos iterativos, estes s\u00e3o formados\n1 Pacote descrito por Davis (2004).\n2 Pacote descrito por Li e Demmel (2003).\n3 Pacote descrito por Agullo et al. (2015).\n\n\n\n134 Cap\u00edtulo 6. Resultados\n\nTabela 1 \u2013 M\u00e9todos de solu\u00e7\u00e3o diretos.\n\nSolver Pacote\n\nLU UMFPACK 1\n\nLU SUPERLU 2\n\nLU MUMPS 3\n\nCholesky UMFPACK\nCholesky MUMPS\n\nTabela 2 \u2013 Pr\u00e9-condicionadores padr\u00e3o.\n\nPr\u00e9-condicionador Pacote\n\nBoomerAMG (Multigrid) HYPRE 4\n\nGAMG (Multigrid ) PETSc\nILU PETSc\nParaSails HYPRE\nSSOR PETSc\nSOR PETSc\n\npela combina\u00e7\u00e3o de um solver iterativo com um pr\u00e9-condicionador.\nConsideram-se duas op\u00e7\u00f5es para o solver: m\u00e9todo do gradiente\nconjugado 3.2.4, empregado quando o operador pr\u00e9-condicionado \u00e9\nsim\u00e9trico, ou m\u00e9todo dos res\u00edduos m\u00ednimos generalizados 3.2.3, vol-\ntado para o caso n\u00e3o-sim\u00e9trico. Com rela\u00e7\u00e3o aos pr\u00e9-condicionado-\nres, as escolhas utilizadas a t\u00edtulo de compara\u00e7\u00e3o s\u00e3o mostradas\nna tabela 2.\n\nOs pr\u00e9-condicionadores da classe multiescala avaliados\nnesse trabalho s\u00e3o compostos por dois est\u00e1gios, global ou local,\nque podem ser combinados de modo multiplicativo n\u00e3o-sim\u00e9trico\nou sim\u00e9trico. Sejam M?1g a parcela do pr\u00e9-condicionador referente\nao est\u00e1gio global e M?1l a parcela referente ao est\u00e1gio local.\n4 Pacote descrito por Falgout e Yang (2002).\n\n\n\n6.1. Caso 1: monof\u00e1sico 2D 135\n\nQuando combinadas de modo multiplicativo n\u00e3o-sim\u00e9trico, o\nseguinte pr\u00e9-condicionador \u00e9 obtido\n\nM?1NS = M\n?1\nl + M\n\n?1\ng ? M\n\n?1\ng AM\n\n?1\nl . (6.1)\n\nPor outro lado, quando os est\u00e1gios local e global s\u00e3o combinados\nde modo multiplicativo sim\u00e9trico, o seguinte pr\u00e9-condicionador \u00e9\nobtido\n\nM?1S = M\n?1\nl +\n\n[\nM?1l\n\n(\nI ? AM?1g\n\n)\n+ M?1g\n\n](\nI ? AM?1l\n\n)\n.\n\n(6.2)\nAs escolhas avaliadas para a configura\u00e7\u00e3o do pr\u00e9-condicio-\n\nnador multiescala alg\u00e9brico s\u00e3o listadas na tabela 3.\n\n6.1 CASO 1: MONOF\u00c1SICO 2D\n\nO primeiro problema teste consiste no escoamento monof\u00e1-\nsico de \u00e1gua atrav\u00e9s de um reservat\u00f3rio com geometria quadrada\nde dimens\u00f5es 4096 m \u00d7 4096 m e discretizado por uma malha\ncartesiana de dimens\u00f5es 512 \u00d7 512, totalizando 262144 inc\u00f3gni-\ntas. O reservat\u00f3rio \u00e9 imperme\u00e1vel e cont\u00e9m dois po\u00e7os de raio\nrw = 0.1 m dispostos de acordo com o padr\u00e3o cl\u00e1ssico: um quarto\nde five-spot. O primeiro deles \u00e9 injetor, opera na condi\u00e7\u00e3o de\npress\u00e3o prescrita igual a 300 bar e est\u00e1 localizado na posi\u00e7\u00e3o\n(x,y) = (268 ,268 )[m]; enquanto que o segundo \u00e9 produtor, opera\nna condi\u00e7\u00e3o de press\u00e3o prescrita igual a 10 bar e est\u00e1 localizado\nna posi\u00e7\u00e3o (x,y) = (3828, 3828)[m].\n\nO campo de permeabilidade da rocha-reservat\u00f3rio \u00e9 bas-\ntante heterog\u00eaneo variando em seis ordens de grandeza entre\n1.0 \u00d7 10?1 mD at\u00e9 1.0 \u00d7 105 mD. Assim como os demais campos\nde permeabilidade utilizados nesse trabalho, este foi obtido a\npartir de um software de geostat\u00edstica fornecido pela universidade\nde Maryland (KOZINTSEV; KEDEM, 1999) de acordo com uma\n5 Os problemas definidos nos subdom\u00ednios s\u00e3o resolvidos aproximadamente\n\ncom uma \u00fanica itera\u00e7\u00e3o de ILU(0)-Richardson.\n6 Os problemas definidos nos subdom\u00ednios s\u00e3o resolvidos exatamente pelo\n\nsolver Cholesky-UMFPACK.\n\n\n\n136 Cap\u00edtulo 6. Resultados\n\nTabela 3 \u2013 Pr\u00e9-condicionadores do tipo multiescala.\n\nNome Est\u00e1gio global Est\u00e1gio local Comb.\n\nMsFVwc M?1msfv (5.27) C (5.14) NS\n\nMsFVsor1 M?1msfv (5.27) M\n?1\nsor (3.15) (1 it.) NS\n\nMsFVsor2 M?1msfv (5.27) M\n?1\nsor (3.15) (2 it.) NS\n\nMsFVilu0 M?1msfv (5.27) M\n?1\nilu0 NS\n\nMsFVilu1 M?1msfv (5.27) M\n?1\nilu1 NS\n\nMsFV3 M?1msfv (5.27) C + M\n?1\nsor ? CAM?1sor NS\n\nMsFV3sym M?1msfv (5.27) C + M\n?1\nsor ? CAM?1sor S\n\nMsFVHS M?1msfv (5.27) M\n?1\nAS1\n\n5 (3.26) NS\n\nMsFVHSe M?1msfv (5.27) M\n?1\nAS1\n\n6 (3.26) NS\n\nMsFEwc M?1msfe (5.28) C (5.14) NS\n\nMsFEsor1 M?1msfe (5.28) M\n?1\nsor (3.15) (1 it.) NS\n\nMsFEssor1sym M?1msfe (5.28) M\n?1\nssor (3.16) (1 it.) S\n\nMsFEsor2 M?1msfe (5.28) M\n?1\nsor (3.15) (2 it.) NS\n\nMsFEssor2sym M?1msfe (5.28) M\n?1\nssor (3.16) (2 it.) S\n\nMsFEilu0 M?1msfe (5.28) M\n?1\nilu0 NS\n\nMsFEilu1 M?1msfe (5.28) M\n?1\nilu1 NS\n\nMsFE3 M?1msfe (5.28) C + M\n?1\nsor ? CAM?1sor NS\n\nMsFE3sym M?1msfe (5.28) C + M\n?1\nsor ? CAM?1sor S\n\nMsFEHS M?1msfe (5.28) M\n?1\nAS1 (3.26) NS\n\nMsFEHSe M?1msfe (5.28) M\n?1\nAS1 (3.26) NS\n\nMsFEHSesym M?1msfe (5.28) M\n?1\nAS1 (3.26) S\n\nMsFEHS3e M?1msfe (5.28) C + M\n?1\nAS1 ? CAM\n\n?1\nAS1 NS\n\n\n\n6.1. Caso 1: monof\u00e1sico 2D 137\n\nfun\u00e7\u00e3o de covari\u00e2ncia esf\u00e9rica. O resultado obtido \u00e9 ilustrado na\nfigura 24.\n\nFigura 24 \u2013 Caso 1: campo de permeabilidade.\n\n6.1.1 Solu\u00e7\u00e3o aproximada\n\nAvalia-se primeiramente o uso do pr\u00e9-condicionador mul-\ntiescala conforme o papel de t\u00e9cnica de upscaling. Isto \u00e9, a so-\nlu\u00e7\u00e3o do problema original \u00e9 obtida aproximadamente atrav\u00e9s\nda resolu\u00e7\u00e3o do sistema linear induzido pela simples aplica\u00e7\u00e3o\ndo pr\u00e9-condicionador multiescala. Nesse \u00e2mbito, consideram-se\nas estrat\u00e9gias para a configura\u00e7\u00e3o do problema global do pr\u00e9-\ncondicionador.\n\na) MsFVM;\n\nb) MsFEM;\nEm cada uma das alternativas apresentadas \u00e9 necess\u00e1rio\n\na especifica\u00e7\u00e3o do tamanho do problema grosseiro, sendo que, no\ncaso teste em quest\u00e3o, empregam-se os tamanhos 16\u00d716, 32\u00d732\ne 64 \u00d7 64. Estes s\u00e3o referentes \u00e0s raz\u00f5es de engrossamento iguais\n\n\n\n138 Cap\u00edtulo 6. Resultados\n\na 32 \u00d7 32, 16 \u00d7 16 e 8 \u00d7 8. Chamando-se de \u201cx\u201d a solu\u00e7\u00e3o exata\npara o campo de press\u00e3o e \u201cxms\u201d, a solu\u00e7\u00e3o aproximada atrav\u00e9s\ndo m\u00e9todo multiescala, define-se o error relativo entre essas duas\nsolu\u00e7\u00f5es como o vetor \u201ce\u201d de componentes:\n\nei = 100 \u00d7\n(xi ?xmsi )\n\nxi\n. (6.3)\n\nConsiderando-se inicialmente a estrat\u00e9gia MsFVM, conhe-\ncida na literatura como o m\u00e9todo dos volumes finitos multiescala,\napresentam-se nas figuras 25 at\u00e9 27 os gr\u00e1ficos do erro, \u00e0 esquerda,\ne da solu\u00e7\u00e3o aproximada, \u00e0 direita, ao longo do reservat\u00f3rio de\nacordo com as escolhas citadas para o tamanho do problema\nglobal.\n\nFigura 25 \u2013 Caso 1: solu\u00e7\u00e3o MsFVM-16x16.\n\nEm todos os tr\u00eas casos apresentados, nota-se que a solu\u00e7\u00e3o\nproposta pelo MsFVM apresenta certa semelhan\u00e7a em rela\u00e7\u00e3o\na solu\u00e7\u00e3o de refer\u00eancia uma vez que o gr\u00e1fico do erro relativo \u00e9\npr\u00f3ximo \u00e0 zero, exceto nas regi\u00f5es do po\u00e7o produtor e em outras\npequenas ao longo do dom\u00ednio. Observa-se tamb\u00e9m que a qua-\nlidade da solu\u00e7\u00e3o aproximada aumenta conforme o tamanho do\nproblema global cresce. No entanto, a solu\u00e7\u00e3o aproximada exibe\noscila\u00e7\u00f5es que n\u00e3o representam corretamente a f\u00edsica do problema.\n\n\n\n6.1. Caso 1: monof\u00e1sico 2D 139\n\nFigura 26 \u2013 Caso 1: solu\u00e7\u00e3o MsFVM-32x32.\n\nFigura 27 \u2013 Caso 1: solu\u00e7\u00e3o MsFVM-64x64.\n\n\n\n140 Cap\u00edtulo 6. Resultados\n\nTais anomalias s\u00e3o pontos de m\u00e1ximo e m\u00ednimo locais7 no campo\nde press\u00e3o desrespeitando o crit\u00e9rio de monotonicidade, que deve-\nria ser verificado j\u00e1 que o problema em quest\u00e3o \u00e9 modelado por\numa equa\u00e7\u00e3o de car\u00e1ter el\u00edptico. Isso acontece porque, do ponto\nde vista matem\u00e1tico, a matriz que define o problema global \u00e9 in-\ndefinida. Trabalhos desenvolvidos recentemente buscaram corrigir\ntal matriz de modo a torn\u00e1-la positivo definida e fazer com que\no crit\u00e9rio de monotonicidade seja atendido, pode-se citar como\nexemplo disso o m\u00e9todo dos volumes multiescala monot\u00f4nico\n(WANG; HAJIBEYGI; TCHELEPI, 2014).\n\nUma caracter\u00edstica importante do MsFVM consiste na\nobten\u00e7\u00e3o de campos de velocidade conservativos, isto \u00e9, que satis-\nfazem a equa\u00e7\u00e3o da conserva\u00e7\u00e3o da massa. As linhas de corrente\ncalculadas atrav\u00e9s do algoritmo de Pollock (POLLOCK, 1988)\nde acordo com o campo de velocidade aproximado pela alterna-\ntiva MsFVM-64x64 s\u00e3o ilustradas em roxo na figura 28. Nota-se\nque o resultado obtido faz sentido fisicamente, pois as linhas\nligam os po\u00e7os injetor e produtor atrav\u00e9s dos caminhos de alta\npermeabilidade, representados em amarelo na figura.\n\nConsidera-se agora a estrat\u00e9gia do tipo galerkin denomi-\nnada MsFEM. Do mesmo modo que anteriormente, analisa-se\ncomo o tamanho do problema global afeta a qualidade da solu\u00e7\u00e3o\nobtida. Para tanto, as figuras 29 a 31 ilustram o erro entre as\nsolu\u00e7\u00f5es exata e aproximada bem como a pr\u00f3pria solu\u00e7\u00e3o aproxi-\nmada obtida pelo MsFEM variando-se o tamanho do problema\nglobal de acordo com as mesmas alternativas anteriores.\n\nAssim como no caso anterior, a qualidade da solu\u00e7\u00e3o\naproximada pelo MsFEM aumenta a medida que o tamanho do\nproblema em n\u00edvel grosseiro cresce. As solu\u00e7\u00f5es em quest\u00e3o tem\nqualidade superior \u00e0s obtidas pelo MsFVM uma vez que n\u00e3o\nh\u00e1 pontos de m\u00e1ximo ou m\u00ednimo locais espalhados ao longo do\ndom\u00ednio em regi\u00f5es n\u00e3o previstas. Segue que o MsFEM conduz\na respostas que obedecem ao crit\u00e9rio de monotonicidade, o que\nrepresenta uma vantagem em rela\u00e7\u00e3o ao MsFVM, no entanto,\n\n7 As \u00fanicas posi\u00e7\u00f5es do dom\u00ednio onde isso \u00e9 previsto de ocorrer s\u00e3o aquelas\nocupadas pelos po\u00e7os.\n\n\n\n6.1. Caso 1: monof\u00e1sico 2D 141\n\nFigura 28 \u2013 Caso 1: linhas de corrente para a solu\u00e7\u00e3o MsFVM-\n64x64.\n\nFigura 29 \u2013 Caso 1: solu\u00e7\u00e3o MsFEM-16x16.\n\n\n\n142 Cap\u00edtulo 6. Resultados\n\nFigura 30 \u2013 Caso 1: solu\u00e7\u00e3o MsFEM-32x32.\n\nFigura 31 \u2013 Caso 1: solu\u00e7\u00e3o MsFEM-64x64.\n\n\n\n6.1. Caso 1: monof\u00e1sico 2D 143\n\no campo de velocidade obtido n\u00e3o \u00e9 conservativo, o que difi-\nculta a resolu\u00e7\u00e3o de equa\u00e7\u00f5es hiperb\u00f3licas no caso de escoamento\nmultif\u00e1sico.\n\nComo o problema tratado n\u00e3o apresenta efeitos gravitacio-\nnais e os po\u00e7os est\u00e3o localizados em volumes de controle do tipo de\nv\u00e9rtice, segue que os resultados obtidos pelos pr\u00e9-condicionadores\nMsFVMwc e MsFEMwc s\u00e3o exatamente iguais aos obtidos pelas\nescolhas MsFVM e MsFEM. Ou seja, as fun\u00e7\u00f5es de corre\u00e7\u00e3o n\u00e3o\ndesempenham fun\u00e7\u00e3o alguma nesse caso, portanto, seus resultados\ns\u00e3o omitidos.\n\nQuando solu\u00e7\u00f5es para o campo de press\u00e3o com maior\ngrau de precis\u00e3o s\u00e3o exigidas, \u00e9 necess\u00e1rio modificar o m\u00e9todo de\nresolu\u00e7\u00e3o do sistema linear original. Para tanto pode-se recorrer\na m\u00e9todos de solu\u00e7\u00e3o diretos ou iterativos. Nesse \u00faltimo caso, es-\npecialmente, diversas escolhas de par\u00e2metros para a configura\u00e7\u00e3o\ndo pr\u00e9-condicionador multiescala podem ser formadas de modo\nque o operador resultante auxilie no processo de converg\u00eancia\ndos m\u00e9todos iterativos. Esta abordagem \u00e9 considerada nas duas\nse\u00e7\u00f5es a seguir.\n\n6.1.2 M\u00e9todos diretos\n\nConsidera-se nessa se\u00e7\u00e3o o uso dos m\u00e9todos diretos lista-\ndos na tabela 1 na resolu\u00e7\u00e3o do problema em quest\u00e3o. A op\u00e7\u00e3o\nmais eficiente ser\u00e1 escolhida como o m\u00e9todo direto de refer\u00ean-\ncia a ser comparado com as estrat\u00e9gias iterativas. \u00c9 importante\nlembrar que as solu\u00e7\u00f5es obtidas pelos m\u00e9todos diretos s\u00e3o todas\nsemelhantes sendo que a diferen\u00e7a observada entre elas \u00e9 da ordem\nda precis\u00e3o da m\u00e1quina. A figura 32 ilustra o campo de press\u00e3o\nobtido com a resolu\u00e7\u00e3o exata do problema. Nota-se que o campo\nde press\u00e3o varia de modo n\u00e3o-uniforme ao longo do dom\u00ednio, o\nque era esperado j\u00e1 que o campo de permeabilidade da rocha \u00e9\nheterog\u00eaneo\n\nA figura 33 mostra o tempo de computa\u00e7\u00e3o necess\u00e1rio para\na execu\u00e7\u00e3o de cada um dos m\u00e9todos diretos listados na tabela 1. A\npor\u00e7\u00e3o de cada barra em azul escuro refere-se ao tempo de leitura\ndo sistema linear; em azul claro tem-se o tempo de configura\u00e7\u00e3o\n\n\n\n144 Cap\u00edtulo 6. Resultados\n\nFigura 32 \u2013 Caso 1: campo de press\u00e3o.\n\ndo m\u00e9todo direto (obten\u00e7\u00e3o dos fatores L e U) e em verde tem-se\no tempo de resolu\u00e7\u00e3o dos sistemas lineares conforme descrito\npelo algoritmo 1. A figura 34 mostra essas mesmas informa\u00e7\u00f5es\nnormalizadas em rela\u00e7\u00e3o ao tempo de execu\u00e7\u00e3o total. Observa-\nse que a fatora\u00e7\u00e3o Cholesky realizada pelo pacote UMFPACK\napresenta o menor tempo de computa\u00e7\u00e3o, portanto esta \u00e9 tomada\ncomo a estrat\u00e9gia de refer\u00eancia para a solu\u00e7\u00e3o do problema em\nquest\u00e3o. Nota-se tamb\u00e9m que a maior parcela de tempo para a\nexecu\u00e7\u00e3o desses m\u00e9todos refere-se \u00e0 parcela de configura\u00e7\u00e3o, o\nque j\u00e1 era esperado uma vez que a etapa de resolu\u00e7\u00e3o envolve\napenas sistemas triangulares e portanto toma pouco tempo.\n\nA figura 35 mostra o pico de mem\u00f3ria RAM utilizado\ndurante a execu\u00e7\u00e3o de cada um dos m\u00e9todos diretos listados\nna tabela 1. Esta informa\u00e7\u00e3o foi obtida atrav\u00e9s da ferramenta\nmassif contida no programa de instrumenta\u00e7\u00e3o de c\u00f3digos compu-\ntacionais chamado Valgrind (NETHERCOTE; SEWARD, 2007).\nObserva-se novamente que a fatora\u00e7\u00e3o Cholesky realizada pelo\npacote UMFPACK apresenta o menor uso de mem\u00f3ria, prati-\ncamente empatado com a mesma fatora\u00e7\u00e3o implementada pelo\npacote MUMPS. Isso confirma o uso de Cholesky-UMFPACK\n\n\n\n6.1. Caso 1: monof\u00e1sico 2D 145\n\nFigura 33 \u2013 Caso 1: tempo dos solvers diretos.\n\nC\nho\n\nl-U\nM\n\nF\nP\nA\nC\nK\n\nLU\n-U\n\nM\nF\nP\nA\nC\nK\n\nLU\n-M\n\nU\nM\n\nP\nS\n\nC\nho\n\nl-M\nU\nM\n\nP\nS\n\nS\nup\n\ner\nLU\n\nT\ne\n\nm\np\n\no\n [\n\ns\n]\n\n0\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\n\nLeitura\n\nConfigura\u00e7\u00e3o\n\nResolu\u00e7\u00e3o\n\nFigura 34 \u2013 Caso 1: etapas dos solvers diretos.\n\nC\nho\n\nl-U\nM\n\nF\nP\nA\nC\nK\n\nLU\n-U\n\nM\nF\nP\nA\nC\nK\n\nLU\n-M\n\nU\nM\n\nP\nS\n\nC\nho\n\nl-M\nU\nM\n\nP\nS\n\nS\nup\n\ner\nLU\n\nP\no\n\nrc\ne\n\nn\nta\n\ng\ne\n\nm\n [\n\n%\n]\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\n80\n\n90\n\n100\n\nLeitura\n\nConfigura\u00e7\u00e3o\n\nResolu\u00e7\u00e3o\n\n\n\n146 Cap\u00edtulo 6. Resultados\n\ncomo o m\u00e9todo de refer\u00eancia.\n\nFigura 35 \u2013 Caso 1: uso de mem\u00f3ria pelos solvers diretos.\n\nC\nho\n\nl-U\nM\n\nF\nP\nA\nC\nK\n\nLU\n-U\n\nM\nF\nP\nA\nC\nK\n\nLU\n-M\n\nU\nM\n\nP\nS\n\nC\nho\n\nl-M\nU\nM\n\nP\nS\n\nS\nup\n\ner\nLU\n\nP\nic\n\no\n d\n\ne\n M\n\ne\nm\n\n\u00f3\nri\na\n\n [\nM\n\nB\n]\n\n0\n\n100\n\n200\n\n300\n\n400\n\n500\n\n600\n\n700\n\n800\n\n900\n\n6.1.3 M\u00e9todos iterativos\n\nConsidera-se agora o desempenho dos m\u00e9todos de solu\u00e7\u00e3o\niterativos. Estes s\u00e3o compostos pela escolha de um solver itera-\ntivo e um pr\u00e9-condicionador. O crit\u00e9rio de converg\u00eancia adotado\nconsiste em dois par\u00e2metros: o primeiro \u00e9 o n\u00famero m\u00e1ximo de\nitera\u00e7\u00f5es que n\u00e3o deve exceder 100; o segundo crit\u00e9rio consiste\nna rela\u00e7\u00e3o entre as normas do res\u00edduo pr\u00e9-condicionado avaliada\nnas itera\u00e7\u00f5es k e inicial, tal par\u00e2metro deve ser igual a 1E ? 9, fa-\nzendo com que a solu\u00e7\u00e3o convergida seja suficientemente pr\u00f3xima\n\u00e0 solu\u00e7\u00e3o obtido pelos m\u00e9todos diretos.\n\nTr\u00eas op\u00e7\u00f5es s\u00e3o consideradas para os solvers iterativos:\n\n1. M\u00e9todo de Richardson 3.2.2.\n\n2. M\u00e9todo dos gradientes conjugados 3.2.4;\n\n3. M\u00e9todo do res\u00edduo m\u00ednimo generalizado 3.2.3.\n\n\n\n6.1. Caso 1: monof\u00e1sico 2D 147\n\nJ\u00e1 as alternativas poss\u00edveis de pr\u00e9-condicionadores s\u00e3o bem mais\nvastas, conforme listadas nas tabelas 2 e 3. Considerando-se ini-\ncialmente as estrat\u00e9gias de refer\u00eancia, que s\u00e3o descritas na pri-\nmeira tabela, os gr\u00e1ficos da varia\u00e7\u00e3o do res\u00edduo pr\u00e9-condicionado\nrk = b?M?1Axk e do res\u00edduo real rk = b?Axk s\u00e3o apresentados\nnas figuras 36 e 37.\n\nFigura 36 \u2013 Caso 1: converg\u00eancia dos m\u00e9todos iterativos de refe-\nr\u00eancia.\n\nItera\u00e7\u00e3o\n\n0 10 20 30 40 50 60 70 80 90 100\n\nN\no\n\nrm\na\n\n d\no\n\n R\ne\n\ns\n\u00edd\n\nu\no\n\n P\nre\n\nc\no\n\nn\nd\n\nic\nio\n\nn\na\n\nd\no\n\n10\n0\n\n10\n2\n\n10\n4\n\n10\n6\n\n10\n8\n\n10\n10\n\nBoomerAMG-CG\n\nBoomerAMG-Richardson\n\nGAMG-CG\n\nGAMG-Richardson\n\nILU-GMRes\n\nParaSails-GMRes\n\nNota-se que o m\u00e9todo iterativo de melhor desempenho\nmatem\u00e1tico \u00e9 o BoomerAMG-CG pois converge em apenas 11\nitera\u00e7\u00f5es. \u00c9 interessante observar tamb\u00e9m que se o mesmo pr\u00e9-\ncondicionador (BoomerAMG) \u00e9 utilizado em conjunto com o\nsolver Richardson8, a taxa de converg\u00eancia do m\u00e9todo iterativo\nresultante \u00e9 praticamente a metade daquela referente \u00e0 estrat\u00e9gia\nBoomerAMG-CG. O pr\u00e9-condicionador multigrid baseado em\naglomera\u00e7\u00e3o suavizada GAMG conduz a m\u00e9todos iterativos menos\n\n8 No jarg\u00e3o de m\u00e9todos num\u00e9ricos, diz-se nesse caso que o pr\u00e9-condicionador\nmultigrid BoomerAMG est\u00e1 sendo utilizado como o solver iterativo do\nproblema.\n\n\n\n148 Cap\u00edtulo 6. Resultados\n\nFigura 37 \u2013 Caso 1: converg\u00eancia dos m\u00e9todos iterativos de refe-\nr\u00eancia.\n\nItera\u00e7\u00e3o\n\n0 10 20 30 40 50 60 70 80 90 100\n\nN\no\n\nrm\na\n\n d\no\n\n R\ne\n\ns\n\u00edd\n\nu\no\n\n R\ne\n\na\nl\n\n10\n-12\n\n10\n-10\n\n10\n-8\n\n10\n-6\n\n10\n-4\n\n10\n-2\n\n10\n0\n\n10\n2\n\nBoomerAMG-CG\n\nBoomerAMG-Richardson\n\nGAMG-CG\n\nGAMG-Richardson\n\nILU-GMRes\n\nParaSails-GMRes\n\neficientes que os anteriores. Nos m\u00e9todos constru\u00eddos por esses\npr\u00e9-condicionadores \u00e9 ainda mais evidente a diferen\u00e7a entre o\ndesempenho dos solvers Richardson e CG, sendo que, no primeiro\ncaso, o m\u00e9todo resultante \u00e9 praticamente estagnado ap\u00f3s 50\nitera\u00e7\u00f5es. Por \u00faltimo, observa-se que os pr\u00e9-condicionadores ILU\ne ParaSails conduzem \u00e0 m\u00e9todos iterativos bastante ineficientes\nque estagnam ap\u00f3s poucas itera\u00e7\u00f5es, isso j\u00e1 era previs\u00edvel pois\napesar de serem robustos, tais pr\u00e9-condicionadores n\u00e3o s\u00e3o muito\naconselh\u00e1veis para a resolu\u00e7\u00e3o de problemas el\u00edpticos.\n\nConsiderando ainda as figuras 36 e 37, \u00e9 interessante ob-\nservar os valores usuais das normas dos res\u00edduos pr\u00e9-condicionado\ne real: apesar de elevados para o primeiro caso, s\u00e3o pequenos\npara o segundo. Outro detalhe importante desses gr\u00e1ficos diz\nrespeito \u00e0 taxa de converg\u00eancia induzida por cada um deles. A\nconverg\u00eancia real \u00e9 mostrada na figura 37, por\u00e9m tal informa\u00e7\u00e3o\nn\u00e3o \u00e9 naturalmente calculada pelos m\u00e9todos iterativos. Ao inv\u00e9s\ndisso, o res\u00edduo pr\u00e9-condicionado, mostrado na figura 36, \u00e9 cal-\nculado naturalmente por tais m\u00e9todos com o intuito de avaliar\n\n\n\n6.1. Caso 1: monof\u00e1sico 2D 149\n\na converg\u00eancia. Isso pode gerar falhas de interpreta\u00e7\u00e3o sobre a\nconverg\u00eancia do m\u00e9todo em quest\u00e3o, um exemplo claro disso \u00e9\nvisualizado quando considera-se o m\u00e9todo GAMG-Richardson: o\nres\u00edduo referente a esse m\u00e9todo aparenta ser maior que aquele\nreferente ao ILU-GMRes de acordo com a figura 36, no entanto,\nseu res\u00edduo real \u00e9 duas ordens de grandeza menor que esse \u00faltimo.\n\nUma informa\u00e7\u00e3o que ajuda a entender bem a qualidade do\nponto de vista matem\u00e1tico de um pr\u00e9-condicionador \u00e9 o espectro\ndo operador pr\u00e9-condicionado M?1A. Quanto mais aglutinados e\npr\u00f3ximos da unidade os autovalores dessa matriz, maior \u00e9 a taxa de\nconverg\u00eancia do m\u00e9todo iterativo. O c\u00e1lculo dos autovalores exatos\ndessa matriz \u00e9 de alta demanda computacional, no entanto, pode-\nse calcular uma aproxima\u00e7\u00e3o de boa qualidade para os autovalores,\nincluindo-se aqueles localizados no extremo do espectro, a partir\ndo m\u00e9todo de Lanczos. As figuras 38 a 41 ilustram os autovalores\naproximados para o problema em quest\u00e3o quando se consideram\nos pr\u00e9-condicionadores BoomerAMG, GAMG, ILU e ParaSails,\nrespectivamente.\n\nFigura 38 \u2013 Caso 1: autovalores aproximados do operador pr\u00e9-\ncondicionado com BoomerAMG.\n\nReal\n\n0.4 0.5 0.6 0.7 0.8 0.9 1\n\nIm\na\n\ng\n\n-1\n\n-0.5\n\n0\n\n0.5\n\n1\n\nNota-se dessas figuras que o operador pr\u00e9-condicionado\napresenta autovalores reais e agrupados em torno da unidade,\nexceto no caso do pr\u00e9-condicionador ParaSails, que d\u00e1 origem\na autovalores imagin\u00e1rios. Verifica-se que a melhor estrat\u00e9gia\nentre as mostradas \u00e9 dada pelo pr\u00e9-condicionador BoomerAMG,\numa vez que seus autovalores s\u00e3o os mais pr\u00f3ximos da unidade,\nfazendo com que a a taxa de converg\u00eancia do m\u00e9todo iterativo\n\n\n\n150 Cap\u00edtulo 6. Resultados\n\nFigura 39 \u2013 Caso 1: autovalores aproximados do operador pr\u00e9-\ncondicionado com GAMG.\n\nReal\n\n0 0.2 0.4 0.6 0.8 1\n\nIm\na\n\ng\n\n-1\n\n-0.5\n\n0\n\n0.5\n\n1\n\nFigura 40 \u2013 Caso 1: autovalores aproximados do operador pr\u00e9-\ncondicionado com ILU(0).\n\nReal\n\n0 0.5 1 1.5 2\n\nIm\na\n\ng\n\n-1\n\n-0.5\n\n0\n\n0.5\n\n1\n\nFigura 41 \u2013 Caso 1: autovalores aproximados do operador pr\u00e9-\ncondicionado com ParaSails.\n\nReal\n\n0 0.2 0.4 0.6 0.8 1 1.2 1.4\n\nIm\na\n\ng\n\n-0.15\n\n-0.1\n\n-0.05\n\n0\n\n0.05\n\n0.1\n\n0.15\n\n\n\n6.1. Caso 1: monof\u00e1sico 2D 151\n\nseja a mais elevada. Resta verificar se esta estrat\u00e9gia \u00e9 tamb\u00e9m\neficiente do ponto de vista computacional. Para tanto, o tempo e\na mem\u00f3ria RAM associados \u00e0 execu\u00e7\u00e3o dos m\u00e9todos iterativos\nde refer\u00eancia s\u00e3o calculados e apresentados nas figuras 42 e 43,\na t\u00edtulo de compara\u00e7\u00e3o com as estrat\u00e9gias de solu\u00e7\u00e3o diretas,\napresentam-se nessas mesmas figuras as informa\u00e7\u00f5es referentes\nao solver Cholesky-UMFPACK.\n\nFigura 42 \u2013 Caso 1: tempos dos m\u00e9todos iterativos de refer\u00eancia.\n\nC\nho\n\nl-U\nM\n\nF\nP\nA\nC\nK\n\nB\noo\n\nm\ner\n\nA\nM\n\nG\n-C\n\nG\n\nB\noo\n\nm\ner\n\nA\nM\n\nG\n-R\n\nic\nha\n\nrd\nso\n\nn\n\nG\nA\nM\n\nG\n-C\n\nG\n\nG\nA\nM\n\nG\n-R\n\nic\nha\n\nrd\nso\n\nn\n\nIL\nU\n-G\n\nM\nR\nes\n\nP\nar\n\naS\nai\nls\n-G\n\nM\nR\nes\n\nT\ne\nm\n\np\no\n [\ns\n]\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\nLeitura\n\nConfigura\u00e7\u00e3o\n\nResolu\u00e7\u00e3o\n\nLimpeza\n\nEntre os m\u00e9todos iterativos, duas alternativas apresentam\ndesempenhos semelhantes em termos do tempo computacional\ne uso de mem\u00f3ria, elas s\u00e3o BoomerAMG-CG e ILU(0)-GMRES.\nApesar disso, a primeira escolha \u00e9 prefer\u00edvel em rela\u00e7\u00e3o \u00e0 se-\ngunda, uma vez que conduz a um m\u00e9todo iterativo convergente,\nenquanto que nessa \u00faltima observa-se uma estagna\u00e7\u00e3o no processo\nde solu\u00e7\u00e3o. Desse modo, o BoomerAMG-CG \u00e9 tomado como o\nm\u00e9todo iterativo de refer\u00eancia para a compara\u00e7\u00e3o com os pr\u00e9-\ncondicionadores multiescala. Comparando-se o desempenho das\nestrat\u00e9gias de refer\u00eancia Cholesky-UMFPACK e BoomearAMG-\nCG nota-se que, apesar da primeira estrat\u00e9gia utilizar maior\nquantidade de mem\u00f3ria que a segunda, seu tempo computacio-\n\n\n\n152 Cap\u00edtulo 6. Resultados\n\nFigura 43 \u2013 Caso 1: mem\u00f3ria dos m\u00e9todos iterativos de refer\u00eancia.\n\nC\nho\n\nl-U\nM\n\nF\nP\nA\nC\nK\n\nB\noo\n\nm\ner\n\nA\nM\n\nG\n-C\n\nG\n\nB\noo\n\nm\ner\n\nA\nM\n\nG\n-R\n\nic\nha\n\nrd\nso\n\nn\n\nG\nA\nM\n\nG\n-C\n\nG\n\nG\nA\nM\n\nG\n-R\n\nic\nha\n\nrd\nso\n\nn\n\nIL\nU\n-G\n\nM\nR\nes\n\nP\nar\n\naS\nai\nls\n-G\n\nM\nR\nes\n\nP\nic\n\no\n d\n\ne\n M\n\ne\nm\n\n\u00f3\nri\na\n [\nM\n\nB\n]\n\n0\n\n50\n\n100\n\n150\n\n200\n\n250\n\n300\n\n350\n\n400\n\n450\n\nnal \u00e9 praticamente igual a metade, da onde se conclui que tal\nestrat\u00e9gia \u00e9 a melhor dispon\u00edvel das apresentadas at\u00e9 o momento.\n\nConsideram-se agora os m\u00e9todos iterativos constru\u00eddos a\npartir do solver GMRes e dos pr\u00e9-condicionadores do tipo multi-\nescala, que s\u00e3o listados na tabela 3. Com o intuito de facilitar a\napresenta\u00e7\u00e3o de seus resultados, tais pr\u00e9-condicionadores s\u00e3o divi-\ndidos em quatro grupos conforme o tipo do suavizador empregado\nno est\u00e1gio local:\n\na) ILU;\n\nb) SOR;\n\nc) AS;\n\nd) Fun\u00e7\u00f5es de corre\u00e7\u00e3o.\nA raz\u00e3o de engrossamento escolhida inicialmente para\n\na apresenta\u00e7\u00e3o dos resultados \u00e9 de 8 \u00d7 8, a qual resulta num\nproblema grosseiro de tamanho 64 \u00d7 64, que por sua vez \u00e9 re-\nsolvido diretamente atrav\u00e9s do m\u00e9todo Cholesky-UMFPACK.\nPosteriormente, a influ\u00eancia da raz\u00e3o de engrossamento sobre o\ndesempenho desses pr\u00e9-condicionadores ser\u00e1 avaliada.\n\nAs figuras 44 e 45 ilustram os valores dos res\u00edduos pr\u00e9-\n\n\n\n6.1. Caso 1: monof\u00e1sico 2D 153\n\ncondicionado e real, respectivamente, quando os pr\u00e9-condicionadores\nmultiescala com suavizador local do tipo ILU s\u00e3o empregados.\nVerifica-se em cada estrat\u00e9gia multiescala cujo operador global \u00e9\ndo tipo MsFV que sua taxa de converg\u00eancia \u00e9 menor em rela\u00e7\u00e3o\n\u00e0 estrat\u00e9gia semelhante do tipo MsFE, desse modo segue que\no operador global MsFE \u00e9 de melhor qualidade que o operador\nMsFV. A estrat\u00e9gia de maior taxa de converg\u00eancia entre aquelas\ndo tipo multiescala \u00e9 a MsFEilu1sym, por\u00e9m esta ainda n\u00e3o \u00e9\nsuperior \u00e0 estrat\u00e9gia iterativa de refer\u00eancia BoomerAMG-CG.\n\nFigura 44 \u2013 Caso 1: norma do res\u00edduo pr\u00e9-condicionado - MSilu.\n\nItera\u00e7\u00e3o\n\n0 10 20 30 40 50 60 70 80 90 100\n\nN\no\nrm\n\na\n d\n\no\n R\n\ne\ns\n\u00edd\n\nu\no\n P\n\nre\nc\no\nn\nd\nic\n\nio\nn\na\nd\no\n\n10\n0\n\n10\n2\n\n10\n4\n\n10\n6\n\n10\n8\n\n10\n10\n\nBoomerAMG-CG\n\nMsFVilu0\n\nMsFEilu0\n\nMsFEilu0sym\n\nMsFVilu1\n\nMsFEilu1\n\nMsFEilu1sym\n\nA figura 46 mostra o tempo associado \u00e0 execu\u00e7\u00e3o das\nestrat\u00e9gias em quest\u00e3o. Nota-se que o tempo de configura\u00e7\u00e3o\nde todas elas \u00e9 bastante semelhante, sendo ligeiramente maior\npara os casos em que o operador global MsFV \u00e9 constru\u00eddo. Os\ntr\u00eas melhores tempos s\u00e3o encontrados para as estrat\u00e9gias Ms-\nFEilu1sym, MsFEilu0sym e MsFEilu1, que justamente s\u00e3o as que\npossuem as tr\u00eas melhores taxas de converg\u00eancia, respectivamente,\no que faz com que o tempo de resolu\u00e7\u00e3o dessas estrat\u00e9gias seja\nmenor em rela\u00e7\u00e3o aos demais. Devido ao fato de apresentar a\nmelhor taxa de converg\u00eancia e o menor tempo computacional, a\nestrat\u00e9gia MsFEilu1sym \u00e9 escolhida como a de refer\u00eancia entre os\npr\u00e9-condicionadores multiescala baseados na fatora\u00e7\u00e3o ILU.\n\n\n\n154 Cap\u00edtulo 6. Resultados\n\nFigura 45 \u2013 Caso 1: norma do res\u00edduo real - MSilu.\n\nItera\u00e7\u00e3o\n\n0 10 20 30 40 50 60 70 80 90 100\n\nN\no\nrm\n\na\n d\n\no\n R\n\ne\ns\n\u00edd\n\nu\no\n R\n\ne\na\nl\n\n10\n-10\n\n10\n-8\n\n10\n-6\n\n10\n-4\n\n10\n-2\n\n10\n0\n\n10\n2\n\nBoomerAMG-CG\n\nMsFVilu0\n\nMsFEilu0\n\nMsFEilu0sym\n\nMsFVilu1\n\nMsFEilu1\n\nMsFEilu1sym\n\nFigura 46 \u2013 Caso 1: tempos das estrat\u00e9gias MSilu.\n\nC\nho\n\nl-U\nM\n\nF\nP\nA\nC\nK\n\nB\noo\n\nm\ner\n\nA\nM\n\nG\n-C\n\nG\n\nM\nsF\n\nV\nilu\n\n0\n\nM\nsF\n\nE\nilu\n\n0\n\nM\nsF\n\nE\nilu\n\n0s\nym\n\nM\nsF\n\nV\nilu\n\n1\n\nM\nsF\n\nE\nilu\n\n1\n\nM\nsF\n\nE\nilu\n\n1s\nym\n\nT\ne\nm\n\np\no\n [\ns\n]\n\n0\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\n\n3\n\n3.5\n\n4\n\n4.5\n\n5\n\nLeitura\n\nConfigura\u00e7\u00e3o\n\nResolu\u00e7\u00e3o\n\nLimpeza\n\n\n\n6.1. Caso 1: monof\u00e1sico 2D 155\n\nConsideram-se agora os pr\u00e9-condicionadores multiescala\ncom suavizador local do tipo SOR. Os gr\u00e1ficos das normas dos\nres\u00edduos pr\u00e9-condicionado e real s\u00e3o dados pelas figuras 47 e 48.\nComo anteriormente, o operador global do tipo MsFE conduz\na m\u00e9todos de maior taxa de converg\u00eancia, a melhor estrat\u00e9gia\nnesse sentido \u00e9 a MsFEssor3sym, pois converge para a toler\u00e2ncia\nrequisitada em 31 itera\u00e7\u00f5es.\n\nFigura 47 \u2013 Caso 1: norma do res\u00edduo pr\u00e9-condicionado - MSsor.\n\nItera\u00e7\u00e3o\n\n0 10 20 30 40 50 60 70 80 90 100\n\nN\no\nrm\n\na\n d\n\no\n R\n\ne\ns\n\u00edd\n\nu\no\n P\n\nre\nc\no\nn\nd\nic\n\nio\nn\na\nd\no\n\n10\n0\n\n10\n2\n\n10\n4\n\n10\n6\n\n10\n8\n\n10\n10\n\n10\n12\n\nBoomerAMG-CG\n\nMsFVsor1\n\nMsFEsor1\n\nMsFEssor1sym\n\nMsFVsor2\n\nMsFEsor2\n\nMsFEssor2sym\n\nMsFEssor3sym\n\nA figura 49 mostra o tempo necess\u00e1rio para a execu\u00e7\u00e3o de\ncada uma das estrat\u00e9gias. Nota-se que apesar de MsFEssor3sym\napresentar maior taxa de converg\u00eancia, esta n\u00e3o \u00e9 a estrat\u00e9gia\nde menor tempo computacional. Ao inv\u00e9s dela, a alternativa\nrepresentada por MsFEssor2sym mostra-se ligeiramente mais\nr\u00e1pida, portanto, esta \u00e9 tomada como a estrat\u00e9gia de refer\u00eancia\nentre os pr\u00e9-condicionadores multiescala baseados na fatora\u00e7\u00e3o\nSOR.\n\nCom rela\u00e7\u00e3o aos pr\u00e9-condicionadores multiescala com\nsuaviza\u00e7\u00e3o do tipo schwarz aditivo, as normas dos res\u00edduos pr\u00e9-\ncondicionado e real s\u00e3o dadas pelas figuras 50 e 51, enquanto\nque o tempo computacional de cada estrat\u00e9gia \u00e9 dado pela fi-\ngura 52. Observa-se que a melhor estrat\u00e9gia multiescala \u00e9 a Ms-\nFEHSe, de modo que essa \u00e9 tomada como refer\u00eancia para os\n\n\n\n156 Cap\u00edtulo 6. Resultados\n\nFigura 48 \u2013 Caso 1: norma do res\u00edduo real - MSsor.\n\nItera\u00e7\u00e3o\n\n0 10 20 30 40 50 60 70 80 90 100\n\nN\no\nrm\n\na\n d\n\no\n R\n\ne\ns\n\u00edd\n\nu\no\n R\n\ne\na\nl\n\n10\n-10\n\n10\n-8\n\n10\n-6\n\n10\n-4\n\n10\n-2\n\n10\n0\n\n10\n2\n\nBoomerAMG-CG\n\nMsFVsor1\n\nMsFEsor1\n\nMsFEssor1sym\n\nMsFVsor2\n\nMsFEsor2\n\nMsFEssor2sym\n\nMsFEssor3sym\n\nFigura 49 \u2013 Caso 1: tempos das estrat\u00e9gias - MSsor.\n\nC\nho\n\nl-U\nM\n\nF\nP\nA\nC\nK\n\nB\noo\n\nm\ner\n\nA\nM\n\nG\n-C\n\nG\n\nM\nsF\n\nV\nso\n\nr1\n\nM\nsF\n\nE\nso\n\nr1\n\nM\nsF\n\nE\nss\n\nor\n1s\n\nym\n\nM\nsF\n\nV\nso\n\nr2\n\nM\nsF\n\nE\nso\n\nr2\n\nM\nsF\n\nE\nss\n\nor\n2s\n\nym\n\nM\nsF\n\nE\nss\n\nor\n3s\n\nym\n\nT\ne\nm\n\np\no\n [\ns\n]\n\n0\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\n\n3\n\n3.5\n\n4\n\n4.5\n\n5\n\nLeitura\n\nConfigura\u00e7\u00e3o\n\nResolu\u00e7\u00e3o\n\nLimpeza\n\n\n\n6.1. Caso 1: monof\u00e1sico 2D 157\n\npr\u00e9-condicionadores multiescala dessa classe. No entanto, assim\ncomo as anteriores, a taxa de converg\u00eancia ainda \u00e9 pior que aquela\nobservada na estrat\u00e9gia iterativa de refer\u00eancia BoomerAMG-CG,\nenquanto que o tempo computacional \u00e9 tamb\u00e9m bem mais ele-\nvado. \u00c9 interessante observar que a parcela do tempo gasto com\na configura\u00e7\u00e3o do pr\u00e9-condicionador \u00e9 praticamente o dobro em\nrela\u00e7\u00e3o aos casos anteriores.\n\nFigura 50 \u2013 Caso 1: norma do res\u00edduo pr\u00e9-condicionado - MShs.\n\nItera\u00e7\u00e3o\n\n0 10 20 30 40 50 60 70 80 90 100\n\nN\no\nrm\n\na\n d\n\no\n R\n\ne\ns\n\u00edd\n\nu\no\n P\n\nre\nc\no\nn\nd\nic\n\nio\nn\na\nd\no\n\n10\n0\n\n10\n2\n\n10\n4\n\n10\n6\n\n10\n8\n\n10\n10\n\n10\n12\n\nBoomerAMG-CG\n\nMsFVHS\n\nMsFEHS\n\nMsFVHSe\n\nMsFEHSe\n\nMsFEHS3e\n\nPor \u00faltimo, compara-se o desempenho dos pr\u00e9-condicionadores\nmultiescala de acordo com o suavizador empregado, para tanto, as\nestrat\u00e9gias de refer\u00eancia para cada tipo de suavizador s\u00e3o levadas\nem considera\u00e7\u00e3o bem como os m\u00e9todos MsFVwc e MsFEwc, que\ns\u00e3o constru\u00eddos com o suavizador baseado nas fun\u00e7\u00f5es de corre-\n\u00e7\u00e3o. As normas dos res\u00edduos pr\u00e9-condicionado e real obtidas s\u00e3o\nmostradas nas figuras 53 e 54. \u00c9 interessante observar que apesar\nde as estrat\u00e9gias baseadas em fun\u00e7\u00f5es de corre\u00e7\u00e3o parecerem ser\nconvergentes quando se olha o res\u00edduo pr\u00e9-condicionado, elas de\nfato n\u00e3o o s\u00e3o, conforme apresentado pelo gr\u00e1fico da varia\u00e7\u00e3o do\nres\u00edduo real.\n\nAs figuras 55 e 56 ilustram o tempo computacional e o\nm\u00e1ximo uso de mem\u00f3ria RAM associados \u00e0 execu\u00e7\u00e3o das estra-\nt\u00e9gias em quest\u00e3o. Das figuras 53 a 54, segue que a estrat\u00e9gia\n\n\n\n158 Cap\u00edtulo 6. Resultados\n\nFigura 51 \u2013 Caso 1: norma do res\u00edduo real - MShs.\n\nItera\u00e7\u00e3o\n\n0 10 20 30 40 50 60 70 80 90 100\n\nN\no\nrm\n\na\n d\n\no\n R\n\ne\ns\n\u00edd\n\nu\no\n R\n\ne\na\nl\n\n10\n-10\n\n10\n-8\n\n10\n-6\n\n10\n-4\n\n10\n-2\n\n10\n0\n\n10\n2\n\nBoomerAMG-CG\n\nMsFVHS\n\nMsFEHS\n\nMsFVHSe\n\nMsFEHSe\n\nMsFEHS3e\n\nFigura 52 \u2013 Caso 1: tempos das estrat\u00e9gias - MShs.\n\nC\nho\n\nl-U\nM\n\nF\nP\nA\nC\nK\n\nB\noo\n\nm\ner\n\nA\nM\n\nG\n-C\n\nG\n\nM\nsF\n\nV\nH\nS\n\nM\nsF\n\nE\nH\nS\n\nM\nsF\n\nV\nH\nS\ne\n\nM\nsF\n\nE\nH\nS\ne\n\nM\nsF\n\nE\nH\nS\n3e\n\nT\ne\nm\n\np\no\n [\ns\n]\n\n0\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\n\n14\n\n16\n\n18\n\n20\n\nLeitura\n\nConfigura\u00e7\u00e3o\n\nResolu\u00e7\u00e3o\n\nLimpeza\n\n\n\n6.1. Caso 1: monof\u00e1sico 2D 159\n\nFigura 53 \u2013 Caso 1: norma do res\u00edduo pr\u00e9-condicionado.\n\nItera\u00e7\u00e3o\n\n0 10 20 30 40 50 60 70 80 90 100\n\nN\no\nrm\n\na\n d\n\no\n R\n\ne\ns\n\u00edd\n\nu\no\n P\n\nre\nc\no\nn\nd\nic\n\nio\nn\na\nd\no\n\n10\n0\n\n10\n2\n\n10\n4\n\n10\n6\n\n10\n8\n\n10\n10\n\n10\n12\n\n10\n14\n\nBoomerAMG-CG\n\nMsFVwc\n\nMsFEwc\n\nMsFEilu1sym\n\nMsFEssor2sym\n\nFigura 54 \u2013 Caso 1: norma do res\u00edduo real.\n\nItera\u00e7\u00e3o\n\n0 10 20 30 40 50 60 70 80 90 100\n\nN\no\nrm\n\na\n d\n\no\n R\n\ne\ns\n\u00edd\n\nu\no\n R\n\ne\na\nl\n\n10\n-10\n\n10\n-8\n\n10\n-6\n\n10\n-4\n\n10\n-2\n\n10\n0\n\n10\n2\n\nBoomerAMG-CG\n\nMsFVwc\n\nMsFEwc\n\nMsFEilu1sym\n\nMsFEssor2sym\n\n\n\n160 Cap\u00edtulo 6. Resultados\n\nMsFEilu1sym \u00e9 a mais eficiente dos pontos de vista matem\u00e1tico\ne computacional entre os m\u00e9todos multiescala.\n\nFigura 55 \u2013 Caso 1: tempos das estrat\u00e9gias multiescala.\n\nC\nho\n\nl-U\nM\n\nF\nP\nA\nC\nK\n\nB\noo\n\nm\ner\n\nA\nM\n\nG\n-C\n\nG\n\nM\nsF\n\nV\nw\nc\n\nM\nsF\n\nE\nw\nc\n\nM\nsF\n\nE\nilu\n\n1s\nym\n\nM\nsF\n\nE\nss\n\nor\n2s\n\nym\n\nT\ne\nm\n\np\no\n [\ns\n]\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\nLeitura\n\nConfigura\u00e7\u00e3o\n\nResolu\u00e7\u00e3o\n\nLimpeza\n\nFigura 56 \u2013 Caso 1: uso de mem\u00f3ria de diferentes estrat\u00e9gias de\nsolu\u00e7\u00e3o.\n\nC\nho\n\nl-U\nM\n\nF\nP\nA\nC\nK\n\nB\noo\n\nm\ner\n\nA\nM\n\nG\n-C\n\nG\n\nM\nsF\n\nV\nw\nc\n\nM\nsF\n\nE\nw\nc\n\nM\nsF\n\nE\nilu\n\n1s\nym\n\nM\nsF\n\nE\nss\n\nor\n2s\n\nym\n\nP\nic\n\no\n d\n\ne\n M\n\ne\nm\n\n\u00f3\nri\na\n [\nM\n\nB\n]\n\n0\n\n200\n\n400\n\n600\n\n800\n\n1000\n\n1200\n\nOs resultados mostrados at\u00e9 agora a respeito do uso dos\n\n\n\n6.1. Caso 1: monof\u00e1sico 2D 161\n\nm\u00e9todos multiescala como pr\u00e9-condicionadores para a obten\u00e7\u00e3o de\nsolu\u00e7\u00f5es precisas de sistemas lineares el\u00edpticos considerou que o ta-\nmanho do problema em n\u00edvel grosseiro (est\u00e1gio global) \u00e9 de 64\u00d764\nvolumes de controle, que resulta num sistema linear de dimens\u00e3o\n4096 \u00d7 4096. Estuda-se agora como a varia\u00e7\u00e3o desse par\u00e2metro\ninfluencia nas propriedades do pr\u00e9-condicionador. Considerou-se\npara tanto os seguintes tamanhos: 4 \u00d7 4; 8 \u00d7 8; 16 \u00d7 16; 32 \u00d7 32;\n64 \u00d7 64 e 128 \u00d7 128. As figuras 57 e 58 mostram os res\u00edduos\npr\u00e9-condicionado e real, respectivamente. Nota-se que a taxa de\nconverg\u00eancia do solver iterativo \u00e9 diretamente proporcional ao\ntamanho do problema grosseiro, al\u00e9m disso, o ganho de perfor-\nmance que se observa entre as op\u00e7\u00f5es 64 \u00d7 64 e 32 \u00d7 32 \u00e9 bem\nmaior que o observado variando-se entre 128 \u00d7 128 e 64 \u00d7 64.\n\nFigura 57 \u2013 Caso 1: norma do res\u00edduo pr\u00e9-condicionado da estrat\u00e9-\ngia MsFEilu1sym variando-se o tamanho do problema\nglobal.\n\nItera\u00e7\u00e3o\n\n0 10 20 30 40 50 60 70 80 90 100\n\nN\no\nrm\n\na\n d\n\no\n R\n\ne\ns\n\u00edd\n\nu\no\n P\n\nre\nc\no\nn\nd\nic\n\nio\nn\na\nd\no\n\n10\n0\n\n10\n2\n\n10\n4\n\n10\n6\n\n10\n8\n\n10\n10\n\nMsFEilu1sym-4x4\n\nMsFEilu1sym-8x8\n\nMsFEilu1sym-16x16\n\nMsFEilu1sym-32x32\n\nMsFEilu1sym-64x64\n\nMsFEilu1sym-128x128\n\nO tempo computacional verificado para a estrat\u00e9gia Ms-\nFEilu1sym \u00e9 dado pela figura 59. Segue que a alternativa mais\neficiente do ponto de vista computacional consiste naquela cujo\nproblema global \u00e9 de tamanho 64 \u00d7 64, referente \u00e0 raz\u00e3o de en-\ngrossamento igual a 8\u00d78. Adiciona-se que o tamanho m\u00e1ximo dos\nsistemas lineares locais resolvidos para a constru\u00e7\u00e3o do operador\n\n\n\n162 Cap\u00edtulo 6. Resultados\n\nFigura 58 \u2013 Caso 1: norma do res\u00edduo real da estrat\u00e9gia Ms-\nFEilu1sym variando-se o tamanho do problema glo-\nbal.\n\nItera\u00e7\u00e3o\n\n0 10 20 30 40 50 60 70 80 90 100\n\nN\no\nrm\n\na\n d\n\no\n R\n\ne\ns\n\u00edd\n\nu\no\n R\n\ne\na\nl\n\n10\n-10\n\n10\n-8\n\n10\n-6\n\n10\n-4\n\n10\n-2\n\n10\n0\n\nMsFEilu1sym-4x4\n\nMsFEilu1sym-8x8\n\nMsFEilu1sym-16x16\n\nMsFEilu1sym-32x32\n\nMsFEilu1sym-64x64\n\nMsFEilu1sym-128x128\n\nde prolonga\u00e7\u00e3o \u00e9 64\u00d764, permitindo facilmente o uso de m\u00e9todos\ndiretos nesses c\u00e1lculos.\n\nO espectro aproximado do operador pr\u00e9-condicionado\natrav\u00e9s da estrat\u00e9gia MsFEilu1sym-64x64 \u00e9 dado pela figura\n60. Observa-se que os autovalores s\u00e3o todos reais e localizados\nno intervalo [0, 1], exceto um par de autovalores cuja parcela\nimagin\u00e1ria \u00e9 diferente de zero, apesar de pequena. Isso n\u00e3o era\nesperado j\u00e1 que tanto a matriz A como o pr\u00e9-condicionador\nempregado s\u00e3o sim\u00e9tricos, no entanto, pode ser causado pela\nprecis\u00e3o finita na representa\u00e7\u00e3o dos n\u00fameros pela m\u00e1quina.\n\nO uso m\u00e1ximo de mem\u00f3ria \u00e9 dado pela figura 61, em que\nnota-se que esta quantidade aumenta de modo exagerado a medida\nque a raz\u00e3o de engrossamento decresce. Isso se deve ao fato de que\na implementa\u00e7\u00e3o computacional do operador de prolonga\u00e7\u00e3o n\u00e3o\nconsidera a reutiliza\u00e7\u00e3o de espa\u00e7os na mem\u00f3ria RAM j\u00e1 alocados\ndurante a execu\u00e7\u00e3o do programa. Conclui-se que o c\u00f3digo com-\nputacional constru\u00eddo no presente trabalho pode ser refatorado\na fim de utilizar a mem\u00f3ria RAM de modo mais eficiente, isso\nacarretaria tamb\u00e9m numa diminui\u00e7\u00e3o do tempo computacional\n\n\n\n6.1. Caso 1: monof\u00e1sico 2D 163\n\nFigura 59 \u2013 Caso 1: tempos obtidos variando-se o tamanho do\nproblema global.\n\n4x\n4\n\n8x\n8\n\n16\nx1\n\n6\n\n32\nx3\n\n2\n\n64\nx6\n\n4\n\n12\n8x\n\n12\n8\n\nT\ne\nm\n\np\no\n [\ns\n]\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\nLeitura\n\nConfigura\u00e7\u00e3o\n\nResolu\u00e7\u00e3o\n\nFigura 60 \u2013 Caso 1: espectro do operador pr\u00e9-condicionado por\nMsFEilu1sym-64x64.\n\nReal\n\n0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1\n\nIm\na\ng\n\n\u00d710\n-3\n\n-5\n\n0\n\n5\n\n\n\n164 Cap\u00edtulo 6. Resultados\n\nnecess\u00e1rio a sua execu\u00e7\u00e3o tornando o pr\u00e9-condicionador em ques-\nt\u00e3o mais competitivo em rela\u00e7\u00e3o ao pr\u00e9-condicionador multigrid\nde refer\u00eancia (BoomerAMG).\n\nFigura 61 \u2013 Caso 1: picos de mem\u00f3ria obtidos variando-se o ta-\nmanho do problema global.\n\nM\nsF\n\nE\nilu\n\n1s\nym\n\n-4\nx4\n\nM\nsF\n\nE\nilu\n\n1s\nym\n\n-8\nx8\n\nM\nsF\n\nE\nilu\n\n1s\nym\n\n-1\n6x\n\n16\n\nM\nsF\n\nE\nilu\n\n1s\nym\n\n-3\n2x\n\n32\n\nM\nsF\n\nE\nilu\n\n1s\nym\n\n-6\n4x\n\n64\n\nM\nsF\n\nE\nilu\n\n1s\nym\n\n-1\n28\n\nx1\n28\n\nP\nic\n\no\n d\n\ne\n M\n\ne\nm\n\n\u00f3\nri\na\n [\nM\n\nB\n]\n\n0\n\n500\n\n1000\n\n1500\n\n2000\n\n2500\n\n6.2 CASO 2: ESCOAMENTO CANALIZADO\n\nO segundo problema teste consiste no escoamento monof\u00e1-\nsico de \u00f3leo com densidade de 800 kg/m3 e viscosidade 10 cP atra-\nv\u00e9s de um reservat\u00f3rio bidimensional de tamanho 10 240 m\u00d7128 m\nao longo do plano \u201cxy\u201d e sujeito a efeitos gravitacionais na dire\u00e7\u00e3o\n\u201cy\u201d. As condi\u00e7\u00f5es de contorno do problema s\u00e3o de press\u00e3o prescrita\nnas fronteiras laterais e inferior e de fluxo nulo na superior. As\nprimeiras representam a a\u00e7\u00e3o de po\u00e7os verticais ao longo do eixo\n\u201cy\u201d de modo que a press\u00e3o na fronteira \u00e0 esquerda \u00e9 de 25 MPa,\nenquanto \u00e0 direita \u00e9 de 2 MPa. J\u00e1 a fronteira inferior do reserva-\nt\u00f3rio est\u00e1 em contato com outra forma\u00e7\u00e3o rochosa submetida \u00e0\npress\u00e3o uniforme de 5 MPa. A malha empregada no processo de\ndiscretiza\u00e7\u00e3o do dom\u00ednio \u00e9 de 1280 \u00d7 1280 volumes de controle,\ntotalizando 1638400 inc\u00f3gnitas.\n\n\n\n6.2. Caso 2: escoamento canalizado 165\n\nO campo de permeabilidade da rocha-reservat\u00f3rio \u00e9 al-\ntamente heterog\u00eaneo e apresenta valores variando em cinco or-\ndens de grandeza entre 1.0 \u00d7 10?2 mD at\u00e9 1.0 \u00d7 103 mD. Este foi\nconstru\u00eddo da mesma forma como no problema anterior, sendo\nilustrado na figura 62.\n\nFigura 62 \u2013 Caso 2: campo de permeabilidade.\n\nO campo de press\u00e3o de refer\u00eancia obtido atrav\u00e9s da aplica-\n\u00e7\u00e3o do m\u00e9todo direto Cholesky-UMFPACK \u00e9 mostrado na figura\n63, enquanto as linhas de corrente s\u00e3o ilustradas na figura 64.\nObserva-se na primeira que o campo de press\u00e3o varia de modo n\u00e3o\nuniforme, uma vez que o campo de permeabilidade \u00e9 heterog\u00eaneo,\nao longo do dom\u00ednio entre os valores de press\u00e3o m\u00ednimo e m\u00e1ximo\npertencentes \u00e0s faces laterais. Na segunda figura, mostra-se os\ncaminhos preferenciais de escoamento atrav\u00e9s do reservat\u00f3rio. \u00c9\ninteressante observar como a for\u00e7a gravitacional atua fortemente\nno escoamento, fazendo com que atravesse tamb\u00e9m regi\u00f5es de\nbaixa permeabilidade.\n\n\n\n166 Cap\u00edtulo 6. Resultados\n\nFigura 63 \u2013 Caso 2: campo de press\u00e3o.\n\nFigura 64 \u2013 Caso 2: linhas de corrente de refer\u00eancia.\n\n\n\n6.2. Caso 2: escoamento canalizado 167\n\n6.2.1 Solu\u00e7\u00e3o aproximada\n\nAs figuras 65 e 66 mostram os campos de press\u00e3o obtidos\nempregando-se apenas uma itera\u00e7\u00e3o dos pr\u00e9-condicionadores mul-\ntiescala baseados em volumes finitos e elementos finitos (MsFVM\ne MsFEM), respectivamente, para a solu\u00e7\u00e3o aproximada do pro-\nblema. A raz\u00e3o de engrossamento utilizada \u00e9 de 12.8 \u00d7 12.8, ge-\nrando um problema global de tamanho 100\u00d7100. Considerando-se\nprimeiramente a solu\u00e7\u00e3o obtida pelo MsFVM, nota-se a presen\u00e7a\nainda maior em rela\u00e7\u00e3o ao caso 1 de pontos de m\u00e1ximo e m\u00ednimo\nlocais de press\u00e3o ao longo do reservat\u00f3rio, n\u00e3o atendendo portanto\nao crit\u00e9rio de monotonicidade. J\u00e1 a solu\u00e7\u00e3o obtida pelo MsFEM\napresenta maior semelhan\u00e7a em rela\u00e7\u00e3o \u00e0 solu\u00e7\u00e3o de refer\u00eancia e\nrespeita esse \u00faltimo crit\u00e9rio, no entanto, n\u00e3o conduz a campos de\nvelocidade conservativos assim como o MsFVM.\n\nFigura 65 \u2013 Caso 2: campo de press\u00e3o MsFVM-100x100.\n\nConsiderando-se agora uma raz\u00e3o de engrossamento igual\na 8 \u00d7 8, obt\u00e9m-se um problema global de tamanho 160 \u00d7 160.\nNesse caso, os campos de press\u00e3o aproximados pelas estrat\u00e9gias\nMsFVM e MsFEM s\u00e3o dados pelas figuras 67 e 68, respectiva-\nmente. Em ambas estrat\u00e9gias, especialmente quando se considera o\nMsFVM-160x160, nota-se uma melhora consider\u00e1vel na qualidade\nda solu\u00e7\u00e3o aproximada, uma vez que o gr\u00e1fico do erro relativo\n\n\n\n168 Cap\u00edtulo 6. Resultados\n\nFigura 66 \u2013 Caso 2: campo de press\u00e3o MsFEM-100x100.\n\nao longo do dom\u00ednio apresenta menores valores em compara\u00e7\u00e3o\ncom os observados nas figuras 65 e 66 referentes aos m\u00e9todos\nMsFVM-100x100 e MsFEM-100x100. Tal observa\u00e7\u00e3o corrobora\no fato apresentado no caso 1 de que raz\u00f5es de engrossamento\ninferiores a 10 conduzem a aproxima\u00e7\u00f5es satisfat\u00f3rias para o\ncampo de press\u00e3o. \u00c9 importante observar tamb\u00e9m que a estra-\nt\u00e9gia MsFVM-160x160 apresenta problemas de monotonicidade,\nassim como anteriormente, por\u00e9m conduz a campos de velocidade\nconservativos.\n\n6.2.2 Solu\u00e7\u00e3o precisa\n\nConsidera-se agora a resolu\u00e7\u00e3o precisa do campo de pres-\ns\u00e3o empregando-se os pr\u00e9-condicionadores BoomerAMG, Ms-\nFEilu1sym e MsFEssor2sym. Estes \u00faltimos foram escolhidos\nentre os listados na tabela 3 pelo fato de apresentarem os me-\nlhores desempenhos, conforme discutido no caso 1. Como os\npr\u00e9-condicionadores em quest\u00e3o s\u00e3o todos sim\u00e9tricos, bem como\no pr\u00f3prio problema resolvido, utiliza-se o m\u00e9todo dos gradientes\nconjugados como solver iterativo. O crit\u00e9rio de converg\u00eancia ado-\ntado \u00e9 o mesmo que anteriormente, isto \u00e9, a raz\u00e3o entre as normas\ndos res\u00edduos pr\u00e9-condicionados atual e inicial deve ser menor que\n\n\n\n6.2. Caso 2: escoamento canalizado 169\n\nFigura 67 \u2013 Caso 2: campo de press\u00e3o MsFVM-160x160.\n\nFigura 68 \u2013 Caso 2: campo de press\u00e3o MsFEM-160x160.\n\n\n\n170 Cap\u00edtulo 6. Resultados\n\n1.0 \u00d7 10?9, al\u00e9m disso, considera-se que o n\u00famero m\u00e1ximo de\nitera\u00e7\u00f5es \u00e9 igual a 150.\n\nAnalisa-se inicialmente o desempenho dos pr\u00e9-condicionadores\nmultiescala. Para tanto, apresentam-se nas figuras 69 e 70 os gr\u00e1fi-\ncos das normas dos res\u00edduos reais obtidos pelos m\u00e9todos iterativos\nMsFEilu1sym-CG e MsFEssor2sym-CG de acordo com diferentes\ntamanhos para o problema global. Da primeira figura, conclui-se\nque o n\u00famero de itera\u00e7\u00f5es necess\u00e1rias para a converg\u00eancia \u00e9 maior\nque no problema anterior sendo que esta varia pouco quando\na raz\u00e3o de engrossamento empregada \u00e9 em torno de 10 \u00d7 10.\nDa segunda figura, nota-se que o m\u00e9todo MsFEssor2sym-CG\nn\u00e3o \u00e9 convergente sendo que ele o res\u00edduo real se estagna em\ndiferentes valores de acordo com o tamanho do problema global\nconsiderado. Assim como conclu\u00eddo anteriormente, segue que o pr\u00e9-\ncondicionador MsFEilu1sym \u00e9 mais eficiente que MsFEssor2sym.\n\nFigura 69 \u2013 Caso 2: res\u00edduo real obtido pelo m\u00e9todo\nMsFEilu1sym-CG.\n\nItera\u00e7\u00e3o\n\n0 50 100 150\n\nN\no\nrm\n\na\n d\n\no\n R\n\ne\ns\n\u00edd\n\nu\no\n R\n\ne\na\nl\n\n10\n-14\n\n10\n-12\n\n10\n-10\n\n10\n-8\n\n10\n-6\n\n10\n-4\n\n10\n-2\n\nMsFEilu1sym-CG-40x40\n\nMsFEilu1sym-CG-80x80\n\nMsFEilu1sym-CG-100x100\n\nMsFEilu1sym-CG-120x120\n\nMsFEilu1sym-CG-140x140\n\nMsFEilu1sym-CG-160x160\n\nMsFEilu1sym-CG-200x200\n\nMsFEilu1sym-CG-240x240\n\nOs tempos computacionais referentes aos m\u00e9todos num\u00e9-\nricos formados pelos pr\u00e9-condicionadores do tipo MsFEilu1sym\nvariando-se o tamanho do problema global s\u00e3o dados pela figura\n71. Segue que o tempo computacional \u00e9 m\u00ednimo na alternativa\n\n\n\n6.2. Caso 2: escoamento canalizado 171\n\nFigura 70 \u2013 Caso 2: res\u00edduo real pelo m\u00e9todo MsFEssor2sym-CG.\n\nItera\u00e7\u00e3o\n\n0 50 100 150\n\nN\no\nrm\n\na\n d\n\no\n R\n\ne\ns\n\u00edd\n\nu\no\n R\n\ne\na\nl\n\n10\n-7\n\n10\n-6\n\n10\n-5\n\n10\n-4\n\n10\n-3\n\n10\n-2\n\n10\n-1\n\nMsFEssor2sym-CG-40x40\n\nMsFEssor2sym-CG-80x80\n\nMsFEssor2sym-CG-100x100\n\nMsFEssor2sym-CG-120x120\n\nMsFEssor2sym-CG-140x140\n\nMsFEssor2sym-CG-160x160\n\nMsFEssor2sym-CG-200x200\n\nMsFEssor2sym-CG-240x240\n\nMsFEilu1sym-40x40, de modo que esta \u00e9 tomada como a escolha\nde refer\u00eancia de pr\u00e9-condicionador multiescala. Nota-se que para\nproblemas globais de menor tamanho, a taxa de converg\u00eancia \u00e9\nmuito pequena, o que causa um aumento consider\u00e1vel no tempo\nrelativo \u00e0 etapa de resolu\u00e7\u00e3o do m\u00e9todo iterativo. J\u00e1 para pro-\nblemas globais de tamanhos maiores que 40 \u00d7 40, o ganho que se\ntem com o aumento da taxa de converg\u00eancia \u00e9 insuficiente para\nse contrapor com a maior quantia de tempo necess\u00e1ria para a\nconfigura\u00e7\u00e3o do pr\u00e9-condicionador.\n\nComparam-se agora os desempenhos do solver direto de\nrefer\u00eancia (Cholesky-UMFPACK) e dos solvers iterativos basea-\ndos no m\u00e9todo dos gradientes conjugados pr\u00e9-condicionado com as\nestrat\u00e9gias multiescala de refer\u00eancia (MsFEilu1sym-40x40) e mul-\ntigrid de refer\u00eancia (BoomerAMG). A figura 72 ilustra o gr\u00e1fico\ndos res\u00edduos reais obtidos pelos m\u00e9todos iterativos em conside-\nra\u00e7\u00e3o. Nota-se que o pr\u00e9-condicionador BoomerAMG apresenta\ndesempenho \u00f3timo, convergindo no mesmo n\u00famero de itera\u00e7\u00f5es\nem rela\u00e7\u00e3o ao problema anterior, apesar do presente caso ser\nmais complexo e ainda possuir cerca de seis vezes mais inc\u00f3gnitas.\nSegue que o BoomerAMG apresenta melhor escalabilidade que as\nestrat\u00e9gias multiescala estudadas, al\u00e9m de melhor desempenho\n\n\n\n172 Cap\u00edtulo 6. Resultados\n\nFigura 71 \u2013 Caso 2: tempo computacional pela estrat\u00e9gia\nMsFEilu1sym-CG.\n\n5x\n5\n\n10\nx1\n\n0\n\n20\nx2\n\n0\n\n40\nx4\n\n0\n\n80\nx8\n\n0\n\n10\n0x\n\n10\n0\n\n12\n0x\n\n12\n0\n\n14\n0x\n\n14\n0\n\n16\n0x\n\n16\n0\n\n20\n0x\n\n20\n0\n\n24\n0x\n\n24\n0\n\nT\ne\nm\n\np\no\n [\ns\n]\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\n80\n\n90\n\nLeitura\n\nConfigura\u00e7\u00e3o\n\nResolu\u00e7\u00e3o\n\nem termos de taxa de converg\u00eancia.\n\nFigura 72 \u2013 Caso 2: res\u00edduo real para as estrat\u00e9gias de refer\u00eancia.\n\nItera\u00e7\u00e3o\n\n0 50 100 150\n\nN\no\nrm\n\na\n d\n\no\n R\n\ne\ns\n\u00edd\n\nu\no\n R\n\ne\na\nl\n\n10\n-14\n\n10\n-12\n\n10\n-10\n\n10\n-8\n\n10\n-6\n\n10\n-4\n\n10\n-2\n\n10\n0\n\n10\n2\n\nBoomerAMG-CG\n\nMsFEilu1sym-CG\n\nAs figuras 73 e 74 mostram o espectro aproximado da\nmatriz original A pr\u00e9-condicionada com as estrat\u00e9gias Boome-\nrAMG e MsFEilu1sym-40x40, respectivamente. \u00c9 n\u00edtido que os\n\n\n\n6.2. Caso 2: escoamento canalizado 173\n\nautovalores da primeira alternativa est\u00e3o mais pr\u00f3ximos da uni-\ndade que aqueles referentes \u00e0 segunda, conduzindo portanto a\nm\u00e9todos iterativos de maior taxa de converg\u00eancia.\n\nFigura 73 \u2013 Caso 2: espectro aproximado do operador original\npr\u00e9-condicionado com BoomerAMG.\n\nReal\n\n0.5 0.6 0.7 0.8 0.9 1\n\nIm\na\ng\n\n-1\n\n-0.5\n\n0\n\n0.5\n\n1\n\nFigura 74 \u2013 Caso 2: espectro aproximado do operador original\npr\u00e9-condicionado com MsFEilu1sym-40x40.\n\nReal\n\n0 0.2 0.4 0.6 0.8 1\n\nIm\na\ng\n\n-1\n\n-0.5\n\n0\n\n0.5\n\n1\n\nNa figura 75 mostram-se os tempos necess\u00e1rios para a\nexecu\u00e7\u00e3o dos mesmos m\u00e9todos iterativos e direto discutidos acima.\nO tempo necess\u00e1rio para a execu\u00e7\u00e3o da etapa de resolu\u00e7\u00e3o do pr\u00e9-\ncondicionador MsFEilu1sym-40x40 \u00e9 cerca de tr\u00eas vezes maior que\naquele referente ao BoomerAMG-CG, enquanto que a etapa de\nconfigura\u00e7\u00e3o do pr\u00e9-condicionador multiescala \u00e9 aproximadamente\ncinco vezes maior. Segue que apesar do custo por itera\u00e7\u00e3o do\nm\u00e9todo BoomerAMG-CG ser maior, este converge muito mais\nrapidamente e, portanto, tal escolha \u00e9 muito mais eficiente que a\nprimeira. Apesar do pr\u00e9-condicionador BoomerAMG ser muito\n\n\n\n174 Cap\u00edtulo 6. Resultados\n\neficiente, tem-se que, assim como no caso 1, a estrat\u00e9gia Cholesky-\nUMFPACK \u00e9 a mais r\u00e1pida das avaliadas.\n\nFigura 75 \u2013 Caso 2: Tempos computacionais das estrat\u00e9gias de\nrefer\u00eancia.\n\nChol-UMFPACK BoomerAMG-CG MsFEilu1sym-CG\n\nT\ne\nm\n\np\no\n [\ns\n]\n\n0\n\n5\n\n10\n\n15\n\n20\n\n25\n\nLeitura\n\nConfigura\u00e7\u00e3o\n\nResolu\u00e7\u00e3o\n\nNa figura 76 mostra-se o uso m\u00e1ximo de mem\u00f3ria RAM\npelas estrat\u00e9gias de refer\u00eancia. Nesse caso, nota-se que o m\u00e9todo\niterativo constru\u00eddo com o pr\u00e9-condicionador multiescala n\u00e3o apre-\nsenta um uso muito elevado de mem\u00f3ria, como mostrado para\no caso 1. No entanto, tal quantidade deveria ser ainda menor\nque aquela observada para o m\u00e9todo direto Cholesky-UMFPACK,\numa vez que o grafo referente \u00e0 matriz multiescala apresenta\nmenor n\u00famero de conex\u00f5es que o da matriz original e, portanto,\nconduziria a um menor grau de preenchimento durante sua reso-\nlu\u00e7\u00e3o por algum m\u00e9todo direto. Este \u00faltimo fato n\u00e3o \u00e9 atendido\ndevido \u00e0 maneira com que a constru\u00e7\u00e3o do operador de prolon-\nga\u00e7\u00e3o foi implementada computacionalmente, isto \u00e9, alocando-se\nnovos espa\u00e7os na mem\u00f3ria RAM que poderiam ser reutilizados.\nSegue que o c\u00f3digo computacional desenvolvido pode ainda ser\nrefatorado a fim de que utilize menos mem\u00f3ria e, por conseguinte,\nexecute mais rapidamente, uma vez que o reaproveitamento de es-\npa\u00e7os pr\u00e9-alocados na mem\u00f3ria diminui o tempo de acesso dessas\ninforma\u00e7\u00f5es.\n\n\n\n6.3. Caso 3: bif\u00e1sico incompress\u00edvel 2D 175\n\nFigura 76 \u2013 Caso 2: pico de mem\u00f3ria da estrat\u00e9gia MsFEilu1sym-\nCG.\n\nChol-UMFPACK BoomerAMG-CG MsFEilu1sym-CG\n\nP\nic\n\no\n d\n\ne\n M\n\ne\nm\n\n\u00f3\nri\na\n [\nM\n\nB\n]\n\n0\n\n200\n\n400\n\n600\n\n800\n\n1000\n\n1200\n\n1400\n\n1600\n\n1800\n\n6.3 CASO 3: BIF\u00c1SICO INCOMPRESS\u00cdVEL 2D\n\nEsse caso \u00e9 baseado no escoamento bif\u00e1sico e incompres-\ns\u00edvel de \u00e1gua com densidade e viscosidade iguais a 1000 kg/m3 e\n1 cP, al\u00e9m de \u00f3leo com densidade e viscosidade iguais a 800 kg/m3\ne 10 cP, respectivamente. As curvas de permeabilidade relativa\ndesses fluidos s\u00e3o dadas pela figura 77.\n\nFigura 77 \u2013 Caso 3: curvas de permeabilidade relativa.\n\nSatura\u00e7\u00e3o [-]\n\n0 0.2 0.4 0.6 0.8 1\n\nP\ne\nrm\n\ne\na\nb\n\nil\nid\n\na\nd\n\ne\n r\n\ne\nla\n\nti\nv\na\n\n [\n-]\n\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\n0.8\n\n0.9\n\n1\n\nk\nrw\n\nk\nro\n\n\n\n176 Cap\u00edtulo 6. Resultados\n\nO reservat\u00f3rio tem dimens\u00f5es 365m \u00d7 670m e a malha\nempregada na sua discretiza\u00e7\u00e3o tem tamanho 60\u00d7220, totalizando\n13200 inc\u00f3gnitas. O campo de permeabilidade absoluta \u00e9 isotr\u00f3pico\ne representado pela figura 78.\n\nFigura 78 \u2013 Caso 3: campo de permeabilidade absoluta.\n\nH\u00e1 quatro po\u00e7os produtores e um po\u00e7o injetor dispostos\nno padr\u00e3o five-spot, sendo que suas propriedades s\u00e3o dadas pela\ntabela 4.\n\nTabela 4 \u2013 Caso 3: propriedades dos po\u00e7os.\n\nPo\u00e7o Raio [m] Volume Posi\u00e7\u00e3o [m] BHP9 [MPa]\n\nP1 0.125 1 (3.048, 1.524) 5\nP2 0.125 60 (362.712, 1.524) 5\nP3 0.125 13141 (3.048, 669.036) 5\nP4 0.125 13200 (362.712, 669.036) 5\nI1 0.125 6570 (179.832, 333.756) 80\n\n9 Press\u00e3o de fundo de po\u00e7o.\n\n\n\n6.3. Caso 3: bif\u00e1sico incompress\u00edvel 2D 177\n\nO tempo de simula\u00e7\u00e3o \u00e9 igual a 30 000 dias, enquanto o\npasso de tempo \u00e9 vari\u00e1vel, conforme apresentado na tabela 5.\nEmpregarem-se ambas estrat\u00e9gias IMPES e SFI para a solu\u00e7\u00e3o ao\nlongo do tempo, descritas na se\u00e7\u00e3o 2.2. Verificou-se que a \u00faltima\nestrat\u00e9gia \u00e9 mais est\u00e1vel que a primeira e, portanto, permite o\nuso de maiores passos de tempo. Portanto, esta foi tomada como\na alternativa de refer\u00eancia para a solu\u00e7\u00e3o do presente problema.\n\nTabela 5 \u2013 Caso 3: passos de tempo.\n\nDura\u00e7\u00e3o [d] Vezes Per\u00edodo [d]\n\n50 20 0 ? 1000\n100 20 1001 ? 3000\n150 100 3001 ? 18000\n200 60 18001 ? 30000\n\n6.3.1 Solu\u00e7\u00e3o aproximada\n\nEmpregando-se o MsFVM como t\u00e9cnica de upscaling para\na obten\u00e7\u00e3o de campos de press\u00e3o aproximados, isto \u00e9, aplicando-se\numa \u00fanica itera\u00e7\u00e3o do est\u00e1gio global do pr\u00e9-condicionador multi-\nescala para a resolu\u00e7\u00e3o do problema linear da press\u00e3o, verificou-se\nque as solu\u00e7\u00f5es referentes aos primeiros passos de tempo s\u00e3o satis-\nfat\u00f3rias, por\u00e9m logo a qualidade do campo de press\u00e3o \u00e9 degradada\ncausando problemas no c\u00e1lculo do campo de satura\u00e7\u00e3o.\n\nPassos de tempo menores que os listados na tabela 5 bem\ncomo raz\u00f5es de engrossamento menores que 10 foram empregados,\no que deveria resolver melhorar a qualidade do campo de press\u00e3o\ne tornar o c\u00e1lculo do campo de press\u00e3o convergente. No entanto,\nnotou-se que o problema citado n\u00e3o \u00e9 extinto, mas apenas atrasado\npara passos de tempo posteriores. Desse modo, conclui-se que,\nao menos para o problema testado, o uso do pr\u00e9-condicionador\nmultiescala como t\u00e9cnica de upscaling n\u00e3o \u00e9 recomendado.\n\n\n\n178 Cap\u00edtulo 6. Resultados\n\n6.3.2 Solu\u00e7\u00e3o precisa\n\nConsidera-se agora o uso do pr\u00e9-condicionador multies-\ncala de refer\u00eancia, MsFEilu1sym, em conjunto com o m\u00e9todo do\ngradiente conjugado para a obten\u00e7\u00e3o de solu\u00e7\u00f5es precisas para o\ncampo de press\u00e3o ao longo dos instantes de tempo considerados\nna simula\u00e7\u00e3o. Primeiramente, avaliam-se diversas alternativas\npara a raz\u00e3o de engrossamento empregada pelo pr\u00e9-condicionador\nmultiescala com o intuito de verificar a estrat\u00e9gia mais eficiente\ndo ponto de vista computacional.\n\nA figura 79 ilustra as parcelas de tempo associadas \u00e0\nsolu\u00e7\u00e3o das equa\u00e7\u00f5es para a press\u00e3o, em que se emprega a estra-\nt\u00e9gia MsFEilu1sym-CG, e tamb\u00e9m aquelas associadas \u00e0 solu\u00e7\u00e3o\ndas equa\u00e7\u00f5es para as satura\u00e7\u00f5es das fases \u00e1gua e \u00f3leo, que s\u00e3o\nn\u00e3o-lineares e resolvidas atrav\u00e9s do m\u00e9todo de Newton exato.\nObserva-se uma diferen\u00e7a de aproximadamente 15 s entre as es-\ntrat\u00e9gias baseadas na maior e menor raz\u00f5es de engrossamento\nconsideradas (malhas grossas com tamanhos 3 \u00d7 9 e 15 \u00d7 56,\nrespectivamente). Logo, a estrat\u00e9gia cujo problema global \u00e9 de\ntamanho 3 \u00d7 9 \u00e9 tomada como a estrat\u00e9gia multiescala de refe-\nr\u00eancia para a compara\u00e7\u00e3o com as estrat\u00e9gias BoomerAMG-CG e\nCholesky-UMFPACK.\n\nO n\u00famero de itera\u00e7\u00f5es e os tempos de execu\u00e7\u00e3o da es-\ntrat\u00e9gia MsFEilu1sym3x9-CG em fun\u00e7\u00e3o do passo de tempo s\u00e3o\ndados pelas figuras 80. Na primeira figura observa-se que todos os\nproblemas el\u00edpticos foram resolvidos dentro do n\u00famero m\u00e1ximo\nde itera\u00e7\u00f5es permitido, al\u00e9m disso nota-se que a quantia de itera-\n\u00e7\u00f5es necess\u00e1rias \u00e0 converg\u00eancia \u00e9 maior no in\u00edcio da simula\u00e7\u00e3o,\nmas logo ap\u00f3s os primeiros 40 passos de tempo, tal par\u00e2metro\nestabiliza-se em torno de 35 itera\u00e7\u00f5es. Esse \u00faltimo comporta-\nmento se deve ao fato de que a solu\u00e7\u00e3o referente ao passo de\ntempo anterior \u00e9 utilizada como estimativa inicial para o c\u00e1lculo\nda solu\u00e7\u00e3o atual. J\u00e1 na segunda figura \u00e9 poss\u00edvel observar que\na maioria dos sistemas lineares s\u00e3o resolvidos em menos de 0.1 s\nsendo que as etapas de leitura e limpeza de dados se d\u00e3o em uma\nparcela insignificante do tempo total enquanto a etapa de configu-\nra\u00e7\u00e3o do pr\u00e9-condicionador \u00e9 a que toma a maior parcela. Por fim,\n\n\n\n6.3. Caso 3: bif\u00e1sico incompress\u00edvel 2D 179\n\nFigura 79 \u2013 Caso 3: tempo de solu\u00e7\u00e3o de acordo com diferentes\ntamanhos para o problema na malha grossa.\n\n3x9 4x12 5x18 6x22 8x28 12x44 15x56\n\nT\ne\n\nm\np\n\no\n [\n\ns\n]\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\n70\n\n80\n\nPress\u00e3o\n\nSatura\u00e7\u00e3o\n\nadiciona-se que o tempo de configura\u00e7\u00e3o do pr\u00e9-condicionador\nmultiescala poderia ser reduzido caso o operador de prolonga\u00e7\u00e3o\nfosse reconstru\u00eddo somente nas regi\u00f5es em que h\u00e1 mudan\u00e7a signi-\nficativa no campo de satura\u00e7\u00e3o a medida que o passo de tempo\navan\u00e7a.\n\nCompara-se agora o desempenho computacional da estra-\nt\u00e9gia multiescala de refer\u00eancia, MsFEilu1sym3x9-CG, em rela\u00e7\u00e3o\naos m\u00e9todos direto e iterativo de refer\u00eancia, Cholesky-UMFPACK\ne BoomerAMG-CG, respectivamente. A figura 82 mostra o so-\nmat\u00f3rio, ao longo dos passos de tempo da simula\u00e7\u00e3o, do tempo\ncomputacional associado \u00e0 execu\u00e7\u00e3o das estrat\u00e9gias citadas. Nota-\nse que a estrat\u00e9gia mais eficiente para a resolu\u00e7\u00e3o da vari\u00e1vel\npress\u00e3o \u00e9 dada pelo m\u00e9todo direto, sendo que esta leva apenas 6s\npara a resolu\u00e7\u00e3o de todos os sistemas lineares el\u00edpticos obtidos\nno decorrer da simula\u00e7\u00e3o. \u00c9 interessante observar tamb\u00e9m que\na aplica\u00e7\u00e3o do pr\u00e9-condicionador multiescala alg\u00e9brico leva um\ntempo menor que o m\u00e9todo iterativo de refer\u00eancia BoomerAMG-\nCG, por\u00e9m o tempo gasto durante sua configura\u00e7\u00e3o \u00e9 bastante\nsuperior, fazendo com que seu tempo total de execu\u00e7\u00e3o tamb\u00e9m\n\n\n\n180 Cap\u00edtulo 6. Resultados\n\nFigura 80 \u2013 Caso 3: n\u00famero de itera\u00e7\u00f5es da estrat\u00e9gia\nMsFEilu1sym3x9-CG em fun\u00e7\u00e3o do passo de tempo.\n\nPasso de tempo\n\n0 50 100 150 200\n\nN\n\u00fa\n\nm\ne\n\nro\n d\n\ne\n i\nte\n\nra\n\u00e7\n\u00f5\n\ne\ns\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\n60\n\nFigura 81 \u2013 Caso 3: tempo de execu\u00e7\u00e3o da estrat\u00e9gia\nMsFEilu1sym3x9-CG em fun\u00e7\u00e3o do passo de\ntempo.\n\nPasso de tempo\n\n0 20 40 60 80 100 120 140 160 180 200\n\nT\ne\n\nm\np\n\no\n [\n\ns\n]\n\n0\n\n0.02\n\n0.04\n\n0.06\n\n0.08\n\n0.1\n\n0.12\nLeitura\n\nConfigura\u00e7\u00e3o\n\nResolu\u00e7\u00e3o\n\nLimpeza\n\n\n\n6.3. Caso 3: bif\u00e1sico incompress\u00edvel 2D 181\n\no seja.\n\nFigura 82 \u2013 Caso 3: tempo computacional total associado \u00e0 exe-\ncu\u00e7\u00e3o das estrat\u00e9gias de refer\u00eancia.\n\nCholesky-UMFPACK BoomerAMG-CG MsFEilu1sym3x9-CG\n\nT\ne\n\nm\np\n\no\n [\n\ns\n]\n\n0\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\n\n14\n\n16\n\n18\nLeitura\n\nConfigura\u00e7\u00e3o\n\nResolu\u00e7\u00e3o\n\nLimpeza\n\nA figura 83 mostra o tempo computacional total necess\u00e1-\nrio para a resolu\u00e7\u00e3o das vari\u00e1veis prim\u00e1rias press\u00e3o e satura\u00e7\u00e3o\nquando se empregam as estrat\u00e9gias de refer\u00eancia no c\u00e1lculo da\npress\u00e3o. Verifica-se que a parcela de tempo associada ao c\u00e1lculo da\nsatura\u00e7\u00e3o \u00e9 semelhante em todos os casos, o que era esperado j\u00e1\nque essa tarefa \u00e9 realizada a partir de campos de press\u00e3o obtidos\ncom n\u00edveis de precis\u00e3o elevados. Al\u00e9m disso, nota-se que tal par-\ncela de tempo representa ao redor de 80%, 70% e 60%, do tempo\ntotal de simula\u00e7\u00e3o associado \u00e0s estrat\u00e9gias Cholesky-UMFPACK,\nBoomerAMG-CG e MsFEilu1sym-CG, respectivamente.\n\nPor fim, apresentam-se na figura 84 os campos de press\u00e3o\nobtidos diretamente pelas estrat\u00e9gias Cholesky-UMFPACK, \u00e0 es-\nquerda, e iterativamente atrav\u00e9s da estrat\u00e9gia MsFEilu1sym-CG,\n\u00e0 direita, nos instantes de tempo iguais a 9900, 20000 e 30000\ndias, respectivamente. Al\u00e9m disso, os campos de satura\u00e7\u00e3o da\nfase \u00f3leo segundos os mesmos par\u00e2metros citados s\u00e3o expostos\nna figura 85. Naturalmente, verifica-se nas figuras apresentadas\nque as solu\u00e7\u00f5es propostas por ambas estrat\u00e9gias coincidem entre\n\n\n\n182 Cap\u00edtulo 6. Resultados\n\nFigura 83 \u2013 Caso 3: tempo de execu\u00e7\u00e3o da estrat\u00e9gia\nMsFEilu1sym3x9-CG em fun\u00e7\u00e3o do passo de\ntempo.\n\nCholesky-UMFPACK BoomerAMG-CG MsFEilu1sym3x9-CG\n\nT\ne\n\nm\np\n\no\n [\n\ns\n]\n\n0\n\n5\n\n10\n\n15\n\n20\n\n25\n\n30\n\n35\n\n40\n\n45\n\nPress\u00e3o\n\nSatura\u00e7\u00e3o\n\nsi. \u00c9 interessante notar na figura 85 a maneira com que as he-\nterogeneidades presentes no campo de permeabilidade da rocha\ninfluenciam no escoamento: as frentes de satura\u00e7\u00e3o apresentam\nalta irregularidade ao longo do dom\u00ednio.\n\n6.4 CASO 4: TESTE COMPARATIVO SPE 9\n\nEsse caso faz parte do conjunto de testes comparativos\nda Sociedade dos Engenheiros de Petr\u00f3leo Internacional (SPE) e\ntem o intuito de avaliar a qualidade da solu\u00e7\u00e3o obtida por simu-\nladores comerciais de reservat\u00f3rios bem como o desempenho das\nestrat\u00e9gias de solu\u00e7\u00e3o de sistemas alg\u00e9bricos que s\u00e3o empregadas\npor tais c\u00f3digos computacionais.\n\nO problema trata-se de um reservat\u00f3rio com inclina\u00e7\u00e3o\nigual a 10? em rela\u00e7\u00e3o ao plano \u201cxy\u201d e com dimens\u00f5es 2194m\u00d7\n2286m\u00d7109m. A malha utilizada na discretiza\u00e7\u00e3o desse dom\u00ednio\n\u00e9 do tipo corner-point possuindo 24\u00d725\u00d715 volumes de controle.\nO campo de permeabilidade da rocha-reservat\u00f3rio \u00e9 bastante\n\n\n\n6.4. Caso 4: teste comparativo SPE 9 183\n\nFigura 84 \u2013 Caso 3: campos de press\u00e3o.\n\n\n\n184 Cap\u00edtulo 6. Resultados\n\nFigura 85 \u2013 Caso 3: campos de satura\u00e7\u00e3o da fase \u00f3leo.\n\n\n\n6.4. Caso 4: teste comparativo SPE 9 185\n\nheterog\u00eaneo e tamb\u00e9m isotr\u00f3pico nas dire\u00e7\u00f5es \u201cx\u201d e \u201cy\u201d, por\u00e9m,\nquatro ordens de grandeza menor na dire\u00e7\u00e3o \u201cz\u201d. H\u00e1 26 po\u00e7os\nverticais sendo 25 produtores e um injetor. O po\u00e7o injetor opera\nna condi\u00e7\u00e3o de press\u00e3o prescrita igual a 27.58 MPa, enquanto os\nprodutores operam em condi\u00e7\u00f5es vari\u00e1veis ao longo da simula\u00e7\u00e3o\nentre fluxo prescrito e press\u00e3o prescrita. Os instantes de tempo\nem que h\u00e1 troca dessas condi\u00e7\u00f5es s\u00e3o descritos detalhadamente\nno trabalho Killough (1995). O tempo final de simula\u00e7\u00e3o \u00e9 igual\na 900 dias divididos ao longo de 36 passos de tempo.\n\nO campo de permeabilidade na dire\u00e7\u00e3o \u201cx\u201d bem como\na disposi\u00e7\u00e3o dos po\u00e7os ao longo do reservat\u00f3rio s\u00e3o mostrados\nna figura 86, em que nota-se que o campo de permeabilidade\napresenta varia\u00e7\u00f5es ao longo de cinco ordens de grandeza.\n\nFigura 86 \u2013 Caso 4: campo de permeabilidade absoluta na dire\u00e7\u00e3o\n\u201cx\u201d.\n\nO reservat\u00f3rio apresenta escoamento trif\u00e1sico das fases\n\u00e1gua, \u00f3leo e g\u00e1s, de modo que o fluido que comp\u00f5e a fase g\u00e1s pode\n\n\n\n186 Cap\u00edtulo 6. Resultados\n\nse dissolver na fase \u00f3leo, logo, o escoamento \u00e9 representado pelo\nmodelo black-oil padr\u00e3o. Como as equa\u00e7\u00f5es desse modelo s\u00e3o n\u00e3o-\nlineares, escolhe-se o m\u00e9todo de Newton exato para resolv\u00ea-las.\nEm cada itera\u00e7\u00e3o desse m\u00e9todo, \u00e9 necess\u00e1ria a resolu\u00e7\u00e3o de um\nproblema linear determinado pela matriz jacobiana e o vetor de re-\ns\u00edduos. Essa tarefa \u00e9 realizada empregando-se o pr\u00e9-condicionador\nCPR, apresentado na se\u00e7\u00e3o 3.3.3, em conjunto com o m\u00e9todo\niterativo GMRes. Tal pr\u00e9-condicionador divide as parcelas da\nmatriz jacobiana referentes \u00e0s vari\u00e1veis press\u00e3o e satura\u00e7\u00f5es, con-\nduzindo \u00e0 defini\u00e7\u00e3o de subproblemas independentes para tais\nvari\u00e1veis. Desse modo, \u00e9 poss\u00edvel empregar uma estrat\u00e9gia de\nsolu\u00e7\u00e3o voltada para problemas el\u00edpticos para a solu\u00e7\u00e3o do campo\nde press\u00e3o. Nesse momento, empregam-se as estrat\u00e9gias de refe-\nr\u00eancia utilizadas nos casos anteriores al\u00e9m do pr\u00e9-condicionador\nmultiescala com raz\u00e3o de engrossamento igual a 6 \u00d7 5 \u00d7 5 (malha\ngrossa 4 \u00d7 5 \u00d7 3), operador de restri\u00e7\u00e3o do tipo galerkin e sua-\nvizador baseado em fatora\u00e7\u00e3o incompleta sem nenhum grau de\npreenchimento, sendo denominado como MsFEilu0-4x5x3.\n\nO somat\u00f3rio do n\u00famero de itera\u00e7\u00f5es n\u00e3o-lineares ao longo\ndos passos de tempo necess\u00e1rias para a converg\u00eancia do problema\n\u00e9 igual a 230. Observa-se que isso \u00e9 v\u00e1lido para todas as estrat\u00e9-\ngias em considera\u00e7\u00e3o, uma vez que o problema linear el\u00edptico \u00e9\nresolvido com elevada precis\u00e3o em cada uma dessas estrat\u00e9gias. O\nmesmo pode se dizer a respeito do n\u00famero de itera\u00e7\u00f5es observadas\npara o pr\u00e9-condicionador CPR, que \u00e9 igual a 2226, uma vez que tal\npr\u00e9-condicionador \u00e9 identificado como o n\u00edvel iterativo logo acima\nda resolu\u00e7\u00e3o dos problemas el\u00edpticos. Isto significa que ao todo\ns\u00e3o resolvidos 2226 sistemas lineares el\u00edpticos para a resolu\u00e7\u00e3o do\nproblema n\u00e3o-linear em quest\u00e3o ao longo do tempo.\n\nComo a estrat\u00e9gia Chol-UMFPACK \u00e9 direta e resolve\no problema linear numa \u00fanica itera\u00e7\u00e3o, segue que o n\u00famero de\nitera\u00e7\u00f5es totais para essa estrat\u00e9gia \u00e9 igual a 2226. O n\u00famero\ntotal de itera\u00e7\u00f5es necess\u00e1rias para a converg\u00eancia da estrat\u00e9gia\nBoomerAMG-CG foi igual a 12642, conduzindo a uma m\u00e9dia de 6\nitera\u00e7\u00f5es para a resolu\u00e7\u00e3o de cada problema linear. Por \u00faltimo, a\nestrat\u00e9gia multiescala MsFEilu0-CG necessitou de 61225 itera\u00e7\u00f5es\npara a converg\u00eancia, conduzindo a uma m\u00e9dia de 27 itera\u00e7\u00f5es\n\n\n\n6.4. Caso 4: teste comparativo SPE 9 187\n\npor cada problema linear. Este \u00e9 um n\u00famero bem maior que o\napresentado pela estrat\u00e9gia multigrid de refer\u00eancia, no entanto, o\ncusto das itera\u00e7\u00f5es do pr\u00e9-condicionador BoomerAMG \u00e9 maior. De\nfato, nota-se para o presente problema que a estrat\u00e9gia MsFEilu0-\nCG acaba sendo mais eficiente que a anterior e t\u00e3o eficiente quanto\na estrat\u00e9gia direta. Esse fato \u00e9 ilustrado pela figura 87, que destaca\na parcela do tempo computacional utilizada para a solu\u00e7\u00e3o dos\nproblemas lineares el\u00edpticos durante a execu\u00e7\u00e3o da simula\u00e7\u00e3o.\n\nFigura 87 \u2013 Caso 4: tempos computacionais de acordo com a\nestrat\u00e9gia de solu\u00e7\u00e3o.\n\nChol-UMFPACK BoomearAMG-CG MsFEilu0\n\nT\ne\n\nm\np\n\no\n [\n\ns\n]\n\n0\n\n50\n\n100\n\n150\n\n200\n\n250\n\nPress\u00e3o\n\nOutros\n\nPor fim, a t\u00edtulo de ilustra\u00e7\u00e3o, as solu\u00e7\u00f5es no instante\nde tempo final para os campos de press\u00e3o e satura\u00e7\u00e3o das fases\n\u00e1gua, \u00f3leo e g\u00e1s s\u00e3o apresentadas nas figuras 88 a 91, enquanto\nque os volumes totais nas condi\u00e7\u00f5es padr\u00e3o de \u00e1gua, \u00f3leo e g\u00e1s\nrecuperados do reservat\u00f3rio s\u00e3o dados pela figura 92.\n\n\n\n188 Cap\u00edtulo 6. Resultados\n\nFigura 88 \u2013 Caso 4: campo de press\u00e3o no instante final.\n\nFigura 89 \u2013 Caso 4: campo de satura\u00e7\u00e3o de \u00e1gua no instante final.\n\n\n\n6.4. Caso 4: teste comparativo SPE 9 189\n\nFigura 90 \u2013 Caso 4: campo de satura\u00e7\u00e3o de \u00f3leo no instante final.\n\nFigura 91 \u2013 Caso 4: campo de satura\u00e7\u00e3o de g\u00e1s no instante final.\n\n\n\n190 Cap\u00edtulo 6. Resultados\n\nFigura 92 \u2013 Caso 4: produ\u00e7\u00f5es totais acumuladas de g\u00e1s, \u00f3leo e\n\u00e1gua, respectivamente.\n\ntempo [d]\n\n0 100 200 300 400 500 600 700 800 900\n\nV\no\nlu\n\nm\ne\n d\n\ne\n \u00e1\n\ng\nu\na\n p\n\nro\nd\nu\nz\nid\n\no\n [\nm\n\n3\n]\n\n\u00d710\n6\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\ntempo [d]\n\n0 100 200 300 400 500 600 700 800 900\n\nV\no\nlu\n\nm\ne\n d\n\ne\n \u00f3\n\nle\no\n p\n\nro\nd\nu\nz\nid\n\no\n [\nm\n\n3\n]\n\n\u00d710\n7\n\n0\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\n\n3\n\n3.5\n\ntempo [d]\n\n0 100 200 300 400 500 600 700 800 900\n\nV\no\nlu\n\nm\ne\n d\n\ne\n g\n\n\u00e1\ns\n p\n\nro\nd\nu\nz\nid\n\no\n [\nM\n\nm\n3\n]\n\n\u00d710\n7\n\n0\n\n0.5\n\n1\n\n1.5\n\n2\n\n2.5\n\n3\n\n\n\n191\n\n7 CONCLUS\u00d5ES\n\nAs conclus\u00f5es do presente trabalho s\u00e3o listadas a seguir:\na) a aplica\u00e7\u00e3o de uma \u00fanica itera\u00e7\u00e3o do est\u00e1gio global\n\ndo pr\u00e9-condicionador multiescala constru\u00eddo a partir\ndo operador de restri\u00e7\u00e3o baseado em volumes finitos\nassociada \u00e0 reconstru\u00e7\u00e3o do campo de velocidades \u00e9\nalgebricamente equivalente ao emprego do m\u00e9todos dos\nvolumes finitos multiescala MsFVM. Essa estrat\u00e9gia\nconduz a campos de velocidade conservativos e campos\naproximados de press\u00e3o em malha refinada, os quais\nexibem, no entanto, problemas de monotonicidade que\npodem ser amenizados mediante o emprego de raz\u00f5es\nde engrossamento menores. A qualidade da solu\u00e7\u00e3o\npara o campo de press\u00e3o \u00e9 satisfat\u00f3ria em problemas\nde escoamento monof\u00e1sico, por\u00e9m \u00e9 de baixa qualidade\nem escoamentos multif\u00e1sicos, j\u00e1 que degradam a taxa\nde converg\u00eancia do problema n\u00e3o-linear que precisa\nser resolvido nesses casos.\n\nb) a taxa de converg\u00eancia bem como o desempenho com-\nputacional observado para o pr\u00e9-condicionador multi-\nescala quando utilizado para a obten\u00e7\u00e3o de solu\u00e7\u00f5es\nprecisas variam significativamente de acordo com o\nsuavizador, a estrat\u00e9gia de constru\u00e7\u00e3o do operador de\nrestri\u00e7\u00e3o e a raz\u00e3o de engrossamento adotados. Para\nos problemas testados, observou-se que as alternativas\nmais eficientes para esses tr\u00eas par\u00e2metros s\u00e3o repre-\nsentadas respectivamente por suavizadores baseados\nem fatora\u00e7\u00e3o incompleta, pelo operador de restri\u00e7\u00e3o\nigual ao transposto do operador de prolonga\u00e7\u00e3o e por\nraz\u00f5es de engrossamento ao redor de 10;\n\nc) a etapa de configura\u00e7\u00e3o dos pr\u00e9-condicionadores mul-\ntiescala \u00e9 a que demanda a maior parte dos recursos\ncomputacionais, portanto, o trecho de c\u00f3digo respon-\ns\u00e1vel por implementar essa opera\u00e7\u00e3o \u00e9 o que deve ser\notimizado a fim de que se reduza o esfor\u00e7o computaci-\n\n\n\n192 Cap\u00edtulo 7. Conclus\u00f5es\n\nonal necess\u00e1rio para a execu\u00e7\u00e3o do pr\u00e9-condicionador;\nd) o suavizador baseado em fun\u00e7\u00f5es de corre\u00e7\u00e3o n\u00e3o\n\n\u00e9 eficaz pois degrada o espectro do operador pr\u00e9-\ncondicionado e pode conduzir a m\u00e9todos iterativos\nn\u00e3o convergentes;\n\ne) em problemas bidimensionais, o m\u00e9todo direto de refe-\nr\u00eancia Cholesky-UMFPACK mostrou-se como o mais\neficiente dentre as estrat\u00e9gias avaliadas em termos\ndo tempo computacional necess\u00e1rio para a resolu\u00e7\u00e3o\ndo problema. O ponto negativo dessa estrat\u00e9gia se\nd\u00e1 pelo uso mais acentuado de mem\u00f3ria RAM. J\u00e1\nem problemas tridimensionais de grande porte con-\ntendo ao menos 1.0 \u00d7 105 inc\u00f3gnitas, o m\u00e9todo ite-\nrativo BoomerAMG-CG mostrou-se como o mais efi-\nciente. Em todos os problemas testados, os m\u00e9todos\ndireto e iterativo de refer\u00eancia apresentaram melhor\ndesempenho que a estrat\u00e9gia multiescala de refer\u00eancia.\n\n7.1 SUGEST\u00d5ES PARA TRABALHOS FUTUROS\n\nAs seguintes sugest\u00f5es s\u00e3o indicadas para trabalhos futu-\nros:\n\na) implementar o algoritmo do precondicionador multi-\nescala alg\u00e9brico em paralelo empregando-se o padr\u00e3o\nMPI, uma vez que as estruturas de matrizes e vetores\ndispon\u00edveis na biblioteca PETSc, utilizada na presente\nimplementa\u00e7\u00e3o desse pr\u00e9-condicionador, apresentam\nsuporte a esse padr\u00e3o de comunica\u00e7\u00e3o para estruturas\nde dados armazenadas em m\u00e1quinas distintas.\n\nb) otimizar a determina\u00e7\u00e3o do operador de prolonga\u00e7\u00e3o\nem problemas que variam no tempo atrav\u00e9s de sua\nreconstru\u00e7\u00e3o apenas em determinadas \u00e1reas de in-\nteresse. Desse modo, os operadores constru\u00eddos em\npassos de tempo anteriores ao atual podem ser corri-\ngidos de modo a diminuir o tempo de configura\u00e7\u00e3o do\npr\u00e9-condicionador multiescala ao longo dos passos de\n\n\n\n7.1. Sugest\u00f5es para trabalhos futuros 193\n\ntempo e, portanto, o tempo de execu\u00e7\u00e3o do m\u00e9todo\niterativo \u00e9 reduzido;\n\nc) estender o algoritmo de particionamento do grafo\nreferente \u00e0 malha refinada do reservat\u00f3rio para ma-\nlhas n\u00e3o-estruturadas e avaliar o desempenho do pr\u00e9-\ncondicionador multiescala para a resolu\u00e7\u00e3o de proble-\nmas el\u00edpticos nessa classe de problemas.\n\n\n\n\n\n195\n\nREFER\u00caNCIAS\n\nAARNES, J. E.; KIPPE, V.; LIE, K.-A. Mixed multiscale\nfinite elements and streamline methods for reservoir\nsimulation of large geomodels. Advances in Water\nResources, v. 28, p. 257\u2013271, 2005. Dispon\u00edvel em:\n<http://dx.doi.org/10.1016/j.advwatres.2004.10.007>. Citado\nna p\u00e1gina 98.\n\nAAVATSMARK, I. An introduction to multipoint flux\napproximations for quadrilateral grids. Computational\nGeosciences, v. 6, n. 3-4, p. 405\u2013432, 2002. Dispon\u00edvel em:\n<http://doi.org/10.1023/A:1021291114475>. Citado na p\u00e1gina\n120.\n\nACS, G.; DOLESCHALL, S.; FARKAS, E. General\npurpose compositional model. SPE Journal, v. 25, p.\n543\u2013553, 1986. SPE-10515-PA. Dispon\u00edvel em:&lt;http:\n//dx.doi.org/10.2118/10515-PA>. Citado na p\u00e1gina 39.\n\nAGULLO, E. et al. MUltifrontal Massively Parallel Solver. [S.l.],\n2015. Dispon\u00edvel em:&lt;http://mumps.enseeiht.fr/doc/userguide_\n5.0.0.pdf>. Citado na p\u00e1gina 133.\n\nALPAK, F. O.; PAL, M.; LIE, K. A. A multiscale adaptive\nlocal-global method for modeling flow in stratigraphically\ncomplex reservoirs. SPE Journal, v. 17, n. 4, p. 1056\u2013\n1070, December 2012. SPE-140403-PA. Dispon\u00edvel em:\n<http://dx.doi.org/10.2118/140403-PA>. Citado na p\u00e1gina 98.\n\nAMBRUS, J. Volumes Finitos Utilizando Aproxima\u00e7\u00f5es\nde M\u00faltiplos Pontos Aplicados \u00e0 Simula\u00e7\u00e3o Num\u00e9rica\nde Reservat\u00f3rios de Petr\u00f3leo. Disserta\u00e7\u00e3o (Mestrado) \u2014\nUniversidade Federal de Santa Catarina, 2009. Dispon\u00edvel em:\n<http://www.sinmec.ufsc.br/site/arquivos/u-ulfnaezdrl_2009_\njaime_ambrus_dissertacao.pdf>. Citado na p\u00e1gina 120.\n\nAMESTOY, P. R.; DAVIS, T. A.; DUFF, I. S. An approximate\nminimum degree ordering algorithm. SIAM Journal on Matrix\n\nhttp://dx.doi.org/10.1016/j.advwatres.2004.10.007\nhttp://doi.org/10.1023/A:1021291114475\nhttp://dx.doi.org/10.2118/10515-PA\nhttp://dx.doi.org/10.2118/10515-PA\nhttp://mumps.enseeiht.fr/doc/userguide_5.0.0.pdf\nhttp://mumps.enseeiht.fr/doc/userguide_5.0.0.pdf\nhttp://dx.doi.org/10.2118/140403-PA\nhttp://www.sinmec.ufsc.br/site/arquivos/u-ulfnaezdrl_2009_jaime_ambrus_dissertacao.pdf\nhttp://www.sinmec.ufsc.br/site/arquivos/u-ulfnaezdrl_2009_jaime_ambrus_dissertacao.pdf\n\n\n196 Refer\u00eancias\n\nAnalysis &amp; Applications, v. 14, p. 886\u2013905, 1996. Dispon\u00edvel\nem:&lt;http://doi.org/10.1137/S0895479894278952>. Citado na\np\u00e1gina 74.\n\nARBOGAST, T.; WHEELER, M. F.; YOTOV, I. Mixed\nfinite elements for elliptic problems with tensor coefficients as\ncell-centered finite differences. SIAM Journal on Numerical\nAnalysis, v. 34, n. 2, p. 828\u2013852, 1997. Dispon\u00edvel em:\n<http://doi.org/10.1137/S0036142994262585>. Citado na\np\u00e1gina 98.\n\nARNOLD, D. N. Mixed finite element methods for elliptic\nproblems. Computational Methods Applied to Mechanical\nEngineering, v. 82, p. 281\u2013300, 1990. Dispon\u00edvel em:\n<http://doi.org/10.1016/0045-7825(90)90168-L>. Citado 2\nvezes nas p\u00e1ginas 45 e 98.\n\nARNOLD, D. N. et al. Unified analysis of discontinuous\ngalerkin methods for elliptic problems. SIAM Journal on\nNumerical Analysis, v. 39, p. 1749\u20131779, 2002. Dispon\u00edvel em:\n<http://doi.org/10.1137/S0036142901384162>. Citado na\np\u00e1gina 45.\n\nAZIZ, K.; SETTARI, A. Petroleum Reservoir Simulation.\nApplied Science Publishers, 1979. Dispon\u00edvel em:&lt;https:\n//books.google.com.br/books/about/Petroleum_reservoir_\nsimulation.html?id=GJ5TAAAAMAAJ&amp;hl=en>. Citado 3\nvezes nas p\u00e1ginas 40, 45 e 48.\n\nBALAY, S. et al. PETSc Users Manual. [S.l.], 2015. Dispon\u00edvel\nem:&lt;http://www.mcs.anl.gov/petsc>. Citado 2 vezes nas\np\u00e1ginas 72 e 77.\n\nBANGERTH, W. MATH 676: Finite Element Methods\nin Scientific Computing. 2013. Dispon\u00edvel em:&lt;http:\n//www.math.tamu.edu/~bangerth/videos.html>. Citado na\np\u00e1gina 73.\n\nBARKER, A. T. et al. Accurate coarse-scale AMG-based\nfinite volume reservoir simulations in highly heterogeneous\n\nhttp://doi.org/10.1137/S0895479894278952\nhttp://doi.org/10.1137/S0036142994262585\nhttp://doi.org/10.1016/0045-7825(90)90168-L\nhttp://doi.org/10.1137/S0036142901384162\nhttps://books.google.com.br/books/about/Petroleum_reservoir_simulation.html?id=GJ5TAAAAMAAJ&amp;hl=en\nhttps://books.google.com.br/books/about/Petroleum_reservoir_simulation.html?id=GJ5TAAAAMAAJ&amp;hl=en\nhttps://books.google.com.br/books/about/Petroleum_reservoir_simulation.html?id=GJ5TAAAAMAAJ&amp;hl=en\nhttp://www.mcs.anl.gov/petsc\nhttp://www.math.tamu.edu/~bangerth/videos.html\nhttp://www.math.tamu.edu/~bangerth/videos.html\n\n\nRefer\u00eancias 197\n\nmedia. In: SPE 173277-MS. Society of Petroleum Engineers,\n2015. p. \u2013. ISSN 978-1-61399-352-1. Dispon\u00edvel em:\n<http://dx.doi.org/10.2118/173277-MS>. Citado na p\u00e1gina 92.\n\nBEHIE, A.; COLLINS, D.; JR., P. F. Incomplete\nfactorization methods for three-dimensional non-symmetric\nproblems. Computer Methods in Applied Mechanics and\nEngineering, v. 42, p. 287\u2013299, 1984. Dispon\u00edvel em:\n<http://doi.org/10.1016/0045-7825(84)90010-0>. Citado na\np\u00e1gina 84.\n\nBEHIE, A.; VINSOME, P. K. W. Block iterative methods\nfor fully implicit reservoir simulation. SPE Journal,\nv. 22, p. 658\u2013668, 1982. SPE-9303-PA. Dispon\u00edvel em:\n<http://dx.doi.org/10.2118/9303-PA>. Citado na p\u00e1gina 84.\n\nBEHIE, G. A.; FORSYTH, P. A. Multigrid solution of\nthe pressure equation in reservoir simulation. SPE Journal,\nv. 23, n. 04, p. 623\u2013632, August 1983. Dispon\u00edvel em:\n<http://dx.doi.org/10.2118/10492-PA>. Citado na p\u00e1gina 92.\n\nBENZI, M. Preconditioning techniques for large linear systems:\nA survey. Journal of Computational Physics, v. 182, p. 418\u2013477,\n2002. Dispon\u00edvel em:&lt;http://doi.org/10.1006/jcph.2002.7176>.\nCitado 2 vezes nas p\u00e1ginas 80 e 81.\n\nBO, L.; WHEELER, M. F. Iterative coupling reservoir\nsimulation on high performance computers. Petroleum\nScience and Technology, v. 6, p. 43\u201350, 2009. Dispon\u00edvel em:\n<http://doi/org/10.1007/s12182-009-0008-x>. Citado na\np\u00e1gina 49.\n\nBONFIGLI, G.; JENNY, P. Recent developments in the\nmultiscale finite volume procedure. In: . Springer\nInternational Publishing, 2010. cap. III, p. 124\u2013131. Dispon\u00edvel\nem:&lt;http://doi.org/10.1007/978-3-642-12535-5_13>. Citado\nna p\u00e1gina 111.\n\nBROWN, G. L.; COLLINS, D. A.; CHEN, Z. Efficient\npreconditioning for algebraic multigrid and red-black ordering\n\nhttp://dx.doi.org/10.2118/173277-MS\nhttp://doi.org/10.1016/0045-7825(84)90010-0\nhttp://dx.doi.org/10.2118/9303-PA\nhttp://dx.doi.org/10.2118/10492-PA\nhttp://doi.org/10.1006/jcph.2002.7176\nhttp://doi/org/10.1007/s12182-009-0008-x\nhttp://doi.org/10.1007/978-3-642-12535-5_13\n\n\n198 Refer\u00eancias\n\nin adaptive-implicit black-oil simulations. In: SPE-173231-MS.\nSociety of Petroleum Engineers, 2015. p. \u2013. ISSN 978-1-61399-\n352-1. Dispon\u00edvel em:&lt;http://dx.doi.org/10.2118/173231-MS>.\nCitado 2 vezes nas p\u00e1ginas 87 e 92.\n\nBUSH, L.; GINTING, V.; PRESHO, M. Application of a\nconservative, generalized multiscale finite element method\nto flow models. ArXiv e-prints. 2013. Dispon\u00edvel em:\n<http://doi.org/10.1016/j.cam.2013.10.006>. Citado na p\u00e1gina\n98.\n\nCAO, H. et al. Parallel scalable unstructured CPR-type linear\nsolver for reservoir simulation. In: SPE-96809-MS. Society\nof Petroleum Engineers, 2005. p. \u2013. ISSN 978-1-55563-150-5.\nDispon\u00edvel em:&lt;http://dx.doi.org/10.2118/96809-MS>. Citado\nna p\u00e1gina 86.\n\nCHEN, Z. Recent advances of upscaling methods for the\nsimulation of flow transport through heterogeneous porous media.\nJournal of Computational Mathematics, v. 24, p. 393\u2013400, 2006.\nDispon\u00edvel em:&lt;http://lsec.cc.ac.cn/~zmchen/papers/jcm.pdf>.\nCitado na p\u00e1gina 72.\n\nCHEN, Z. Reservoir Simulation: Mathematical Techniques\nin Oil Recovery. SIAM, 2007. Dispon\u00edvel em:&lt;http:\n//bookstore.siam.org/cb77/>. Citado 3 vezes nas p\u00e1ginas 40, 43\ne 49.\n\nCHEN, Z.; DENG, W.; YE, H. Upscaling of a class\nof nonlinear parabolic equations for the flow transport\nin heterogeneous porous media. Communications in\nMathematical Sciences, v. 3, p. 493\u2013515, 2005. Dispon\u00edvel em:\n<http://projecteuclid.org/euclid.cms/1144429328>. Citado na\np\u00e1gina 72.\n\nCHEN, Z.; HOU, T. Y. A mixed multiscale finite element\nmethod for elliptic problems with oscillating coefficients.\nMathematics of Computation, American Mathematical Society,\nv. 72, n. 242, p. 541\u2013576, April 2003. ISSN 00255718. Dispon\u00edvel\n\nhttp://dx.doi.org/10.2118/173231-MS\nhttp://doi.org/10.1016/j.cam.2013.10.006\nhttp://dx.doi.org/10.2118/96809-MS\nhttp://lsec.cc.ac.cn/~zmchen/papers/jcm.pdf\nhttp://bookstore.siam.org/cb77/\nhttp://bookstore.siam.org/cb77/\nhttp://projecteuclid.org/euclid.cms/1144429328\n\n\nRefer\u00eancias 199\n\nem:&lt;http://www.jstor.org/stable/4099920>. Citado na p\u00e1gina\n98.\n\nCHEN, Z.; HUAN, G.; MA, Y. Computational Methods for\nMultiphase Flows in Porous Media. SIAM, 2006. Dispon\u00edvel\nem:&lt;http://dx.doi.org/10.1137/1.9780898718942>. Citado na\np\u00e1gina 45.\n\nCHEVALIER, C.; PELLEGRINI, F. PT-Scotch: A tool\nfor efficient parallel graph ordering. Parallel Computing,\nv. 34, n. 6-8, p. 318\u2013331, July 2008. Dispon\u00edvel em:\n<http://doi.org/10.1016/j.parco.2007.12.001>. Citado na\np\u00e1gina 93.\n\nCHRISTIE, M. A. Upscaling for reservoir simulation. Journal\nof Petroleum Technology, v. 48, n. 11, p. 1004\u20131010, 1996.\nDispon\u00edvel em:&lt;http://dx.doi.org/10.2118/37324-JPT>.\nCitado 2 vezes nas p\u00e1ginas 33 e 69.\n\nCHUNG, E. T.; EFENDIEV, Y.; LI, G. An adaptive\ngmsfem for hhigh-constrast flow problems. Journal of\nComputational Physics, v. 273, p. 54\u201376, May 2014. Dispon\u00edvel\nem:&lt;http://doi.org/10.1016/j.jcp.2014.05.007>. Citado na\np\u00e1gina 98.\n\nCLEES, T.; GANZER, L. An efficient algebraic multigrid solver\nstrategy for adaptive implicit methods in oil-reservoir simulation.\nSPE Journal, Society of Petroleum Engineers, v. 15, p. 670\u2013681,\n2010. Dispon\u00edvel em:&lt;http://dx.doi.org/10.2118/105789-PA>.\nCitado na p\u00e1gina 92.\n\nCOATS, K. H.; THOMAS, L. K.; PIERSON, R. G. Compositional\nand black oil reservoir simulation. SPE Reservoir Evaluation &amp;\nEngineering, v. 1, p. 372\u2013379, 1998. SPE-50990-PA. Dispon\u00edvel\nem:&lt;http://dx.doi.org/10.2118/50990-PA>. Citado na p\u00e1gina\n39.\n\nCUSINI, M. et al. A constrained pressure residual multiscale\n(CPR-MS) compositional solver. In: ECMOR XIV-14th European\n\nhttp://www.jstor.org/stable/4099920\nhttp://dx.doi.org/10.1137/1.9780898718942\nhttp://doi.org/10.1016/j.parco.2007.12.001\nhttp://dx.doi.org/10.2118/37324-JPT\nhttp://doi.org/10.1016/j.jcp.2014.05.007\nhttp://dx.doi.org/10.2118/105789-PA\nhttp://dx.doi.org/10.2118/50990-PA\n\n\n200 Refer\u00eancias\n\nconference on the mathematics of oil recovery. [s.n.], 2014.\nDispon\u00edvel em:&lt;http://doi.org/10.3997/2214-4609.20141778>.\nCitado na p\u00e1gina 111.\n\nDAKE, L. P. Fundamentals of Reservoir Engineering. Elsevier\nScientific Publishing Company, 1978. 443 p. Dispon\u00edvel em:&lt;http:\n//store.elsevier.com/Fundamentals-of-Reservoir-Engineering/\nL_P_-Dake/isbn-9780080568980/>. Citado na p\u00e1gina 42.\n\nDAVIS, T. A. Algorithm 832: Umfpack v4.3\u2014an unsymmetric-\npattern multifrontal method. ACM Transactions on Mathematical\nSoftware (TOMS), v. 30, n. 2, p. 196\u2013199, June 2004. Dispon\u00edvel\nem:&lt;http://dx.doi.org/10.1145/992200.992206>. Citado na\np\u00e1gina 133.\n\nDOGRU, A. H. et al. New frontiers in large scale reservoir\nsimulation. In: SPE Reservoir Simulation Symposium, 21-23\nFebruary, The Woodlands, Texas, USA. [s.n.], 2011. SPE-142297-\nMS. Dispon\u00edvel em:&lt;http://dx.doi.org/10.2118/142297-MS>.\nCitado na p\u00e1gina 69.\n\nDOLEAN, V.; JOLIVET, P.; NATAF, F. An introduction\nto domain decomposition methods: Algorithms, theory and\nparallel implementation. ArXiv e-prints. 2015. Dispon\u00edvel em:\n<https://hal.archives-ouvertes.fr/cel-01100932>. Citado na\np\u00e1gina 96.\n\nDOLEAN, V. et al. Two-level domain decomposition methods\nfor highly heterogeneous darcy equations. connections with\nmultiscale methods. Oil Gas Sci. Technol. \u2013 Rev. IFP Energies\nnouvelles, v. 69, n. 4, p. 731\u2013752, July 2014. Dispon\u00edvel em:\n<http://dx.doi.org/10.2516/ogst/2013206>. Citado na p\u00e1gina\n96.\n\nDOLEAN, V. et al. Analysis of a two-level schwarz method with\ncoarse spaces based on local dirichlet-to-neumann maps. Computer\nMethods in Applied Mathematics, v. 12, n. 4, p. 391\u2013414, 2012.\nDispon\u00edvel em:&lt;https://hal.archives-ouvertes.fr/hal-00586246>.\nCitado na p\u00e1gina 96.\n\nhttp://doi.org/10.3997/2214-4609.20141778\nhttp://store.elsevier.com/Fundamentals-of-Reservoir-Engineering/L_P_-Dake/isbn-9780080568980/\nhttp://store.elsevier.com/Fundamentals-of-Reservoir-Engineering/L_P_-Dake/isbn-9780080568980/\nhttp://store.elsevier.com/Fundamentals-of-Reservoir-Engineering/L_P_-Dake/isbn-9780080568980/\nhttp://dx.doi.org/10.1145/992200.992206\nhttp://dx.doi.org/10.2118/142297-MS\nhttps://hal.archives-ouvertes.fr/cel-01100932\nhttp://dx.doi.org/10.2516/ogst/2013206\nhttps://hal.archives-ouvertes.fr/hal-00586246\n\n\nRefer\u00eancias 201\n\nDOUGLAS, J.; PEACEMAN, D. W.; JR., H. H. R. A\nmethod for calculating multi-dimensional immiscible\ndisplacement. In: American Institute of Mining, Metallurgical,\nand Petroleum Engineers, Inc. Society of Petroleum\nEngineers, 1959. SPE-1327-G. Dispon\u00edvel em:&lt;https:\n//www.onepetro.org/general/SPE-1327-G>. Citado na p\u00e1gina\n48.\n\nDURLOFSKY, L. J. Upscaling of geocellular models for reservoir\nflow simulation: A review of recent progress. In: 7 th International\nForum on Reservoir Simulation. [s.n.], 2003. Dispon\u00edvel em:\n<http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.\n122.5524&amp;rep=rep1&amp;type=pdf>. Citado na p\u00e1gina 72.\n\nEFENDIEV, Y.; HOU, T. Y. Multiscale Finite Element Methods\n- Theory and Applications. Springer, 2009. Dispon\u00edvel em:\n<http://www.springer.com/br/book/9780387094953>. Citado\nna p\u00e1gina 98.\n\nFALGOUT, R. D.; YANG, U. M. HYPRE: a library of high\nperformance preconditioners. In: Preconditioners - Lecture Notes\nin Computer Science. [s.n.], 2002. p. 632\u2013641. Dispon\u00edvel em:\n<http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.8.\n1202>. Citado na p\u00e1gina 134.\n\nFARMER, C. L. Upscaling: a review. International Journal for\nNumerical Methods in Fluids, v. 40, p. 63\u201378, 2002. Dispon\u00edvel\nem:&lt;http://doi.org/10.1002/fld.267>. Citado na p\u00e1gina 72.\n\nFORSYTH, P. A. A control-volume, finite-element\nmethod for local mesh refinement in thermal reservoir\nsimulation. SPE Reservoir Evaluation &amp; Engineering,\nv. 5, p. 561\u2013566, 1990. SPE-18415-PA. Dispon\u00edvel em:\n<http://dx.doi.org/10.2118/18415-PA>. Citado na p\u00e1gina 46.\n\nFUNG, L. S.-K.; COLLINS, D. A.; NGHIEM, L. X. An\nadaptive-implicit switching criterion based on numerical\nstability analysis. SPE Reservoir Evaluation &amp; Engineering,\n\nhttps://www.onepetro.org/general/SPE-1327-G\nhttps://www.onepetro.org/general/SPE-1327-G\nhttp://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.122.5524&amp;rep=rep1&amp;type=pdf\nhttp://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.122.5524&amp;rep=rep1&amp;type=pdf\nhttp://www.springer.com/br/book/9780387094953\nhttp://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.8.1202\nhttp://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.8.1202\nhttp://doi.org/10.1002/fld.267\nhttp://dx.doi.org/10.2118/18415-PA\n\n\n202 Refer\u00eancias\n\nv. 4, p. 45\u201351, 1989. SPE-16003-PA. Dispon\u00edvel em:\n<http://dx.doi.org/10.2118/16003-PA>. Citado na p\u00e1gina 49.\n\nGAMBOLATI, G.; FERRONATO, M.; JANNA, C.\nPreconditioning for sparse linear systems at the dawn of the 21st\ncentury: History, current developments, and future perspectives.\nInternational Journal for Numerical and Analytical Methods\nin Geomechanics, v. 35, p. 980\u2013996, 2011. Article ID 127647.\nDispon\u00edvel em:&lt;http://dx.doi.org/10.5402/2012/127647>.\nCitado na p\u00e1gina 80.\n\nGEORGE, A. Nested dissection of a regular finite element mesh.\nSIAM Journal on Numerical Analysis, v. 10, p. 345\u2013363, 1976.\nDispon\u00edvel em:&lt;http://www.math.ucsb.edu/~hdc/teaching/\nMath206D/Nested_Dissection.pdf>. Citado na p\u00e1gina 74.\n\nGRIES, S.; PLUM, H.-J. Status of system-AMG for reservoir\nsimulation applications. In: SPE Reservoir Simulation\nSymposium, 23-25 February, Houston, Texas, USA. Society of\nPetroleum Engineers, 2015. ISSN 978-1-61399-352-1. SPE-173241-\nMS. Dispon\u00edvel em:&lt;http://dx.doi.org/10.2118/173241-MS>.\nCitado na p\u00e1gina 92.\n\nGRIES, S. et al. Preconditioning for efficiently applying\nalgebraic multigrid in fully implicit reservoir simulations. SPE\nJournal, Society of Petroleum Engineers, v. 19, p. 726\u2013736,\n2014. Dispon\u00edvel em:&lt;http://dx.doi.org/10.2118/163608-MS>.\nCitado 2 vezes nas p\u00e1ginas 87 e 92.\n\nHACKBUSCH, W. Multi-Grid Methods and Applications.\nSpringer, 1985. Springer Series in Computational Mathematics.\nDispon\u00edvel em:&lt;http://link.springer.com/book/10.1007/\n978-3-662-02427-0>. Citado 2 vezes nas p\u00e1ginas 32 e 92.\n\nHAJIBEYGI, H. et al. Iterative multiscale finite-volume method.\nJ. Comput. Phys., Academic Press Professional, Inc., San Diego,\nCA, USA, v. 227, n. 19, p. 8604\u20138621, out. 2008. ISSN 0021-9991.\nDispon\u00edvel em:&lt;http://dx.doi.org/10.1016/j.jcp.2008.06.013>.\nCitado na p\u00e1gina 111.\n\nhttp://dx.doi.org/10.2118/16003-PA\nhttp://dx.doi.org/10.5402/2012/127647\nhttp://www.math.ucsb.edu/~hdc/teaching/Math206D/Nested_Dissection.pdf\nhttp://www.math.ucsb.edu/~hdc/teaching/Math206D/Nested_Dissection.pdf\nhttp://dx.doi.org/10.2118/173241-MS\nhttp://dx.doi.org/10.2118/163608-MS\nhttp://link.springer.com/book/10.1007/978-3-662-02427-0\nhttp://link.springer.com/book/10.1007/978-3-662-02427-0\nhttp://dx.doi.org/10.1016/j.jcp.2008.06.013\n\n\nRefer\u00eancias 203\n\nHAJIBEYGI, H.; DEB, R.; JENNY, P. Multiscale finite volume\nmethod for non-conformal coarse grids arising from faulted\nporous media. In: SPE Reservoir Simulation Symposium, 21-23\nFebruary, The Woodlands, Texas, USA. [s.n.], 2011. Dispon\u00edvel\nem:&lt;http://dx.doi.org/10.2118/142205-MS>. Citado na p\u00e1gina\n111.\n\nHAJIBEYGI, H.; JENNY, P. Multiscale finite-volume method for\nparabolic problems arising from compressible multiphase flow in\nporous media. Journal of Computational Physics, v. 228, n. 14, p.\n5129 \u2013 5147, 2009. ISSN 0021-9991. Dispon\u00edvel em:&lt;http://www.\nsciencedirect.com/science/article/pii/S0021999109001946>.\nCitado na p\u00e1gina 110.\n\nHAJIBEYGI, H.; JENNY, P. Adaptive iterative multiscale\nfinite volume method. Journal of Computational Physics, v. 230,\nn. 3, p. 628 \u2013 643, 2011. ISSN 0021-9991. Dispon\u00edvel em:\n<http://doi.org/10.1016/j.jcp.2010.10.009>. Citado na p\u00e1gina\n111.\n\nHAJIBEYGI, H.; KARVOUNIS, D.; JENNY, P. A hierarchical\nfracture model for the iterative multiscale finite volume method.\nJournal of Computational Physics, v. 230, n. 24, p. 8729\u20138743,\n2011. Dispon\u00edvel em:&lt;http://doi.org/10.1016/j.jcp.2011.08.021>.\nCitado 2 vezes nas p\u00e1ginas 111 e 127.\n\nHAJIBEYGI, H.; TCHELEPI, H. Compositional multiscale\nfinite-volume formulation. SPE Journal, v. 19, n. 02, p. 316\u2013326,\n2014. Dispon\u00edvel em:&lt;http://dx.doi.org/10.2118/163664-PA>.\nCitado na p\u00e1gina 111.\n\nHAJIBEYGI, H.; WANG, Y.; TCHELEPI, H. A. Monotone\nmultiscale finite volume method for flow in heterogeneous\nporous media. In: ECMOR XIV - 14th European Conference\non the Mathematics of Oil Recovery. [s.n.], 2014. Dispon\u00edvel\nem:&lt;http://doi.org/10.3997/2214-4609.20141777>. Citado na\np\u00e1gina 110.\n\nhttp://dx.doi.org/10.2118/142205-MS\nhttp://www.sciencedirect.com/science/article/pii/S0021999109001946\nhttp://www.sciencedirect.com/science/article/pii/S0021999109001946\nhttp://doi.org/10.1016/j.jcp.2010.10.009\nhttp://doi.org/10.1016/j.jcp.2011.08.021\nhttp://dx.doi.org/10.2118/163664-PA\nhttp://doi.org/10.3997/2214-4609.20141777\n\n\n204 Refer\u00eancias\n\nHENSON, V. E. Multigrid methods for nonlinear problems: An\noverview. In: Proceedings of the SPI. [s.n.], 2003. Dispon\u00edvel em:\n<https://computation.llnl.gov/casc/people/henson/postscript/\nUCRL_JC_150259.pdf>. Citado na p\u00e1gina 52.\n\nHENSON, V. E.; YANG, U. M. BoomerAMG: A parallel\nalgebraic multigrid solver and preconditioner. Applied\nNumerical Mathematics, v. 41, p. 155\u2013177, 2002. Dispon\u00edvel em:\n<http://doi.org/10.1016/S0168-9274(01)00115-5>. Citado 2\nvezes nas p\u00e1ginas 90 e 92.\n\nHESSE, M. A.; MALLISON, B. T.; TCHELEPI, H. A. Compact\nmultiscale finite volume method for heterogeneous anisotropic\nelliptic equations. Multiscale Modeling &amp; Simulation, v. 7, n. 2, p.\n934\u2013962, 2008. Dispon\u00edvel em:&lt;http://epubs.siam.org/doi/abs/\n10.1137/070705015?journalCode=mmsubt>. Citado na p\u00e1gina\n110.\n\nHESTENES, M. R.; STIEFEL, E. Methods of conjugate\ngradients for solving linear systems. Journal of Research of the\nNational Bureau of Standards, v. 49, p. 409\u2013436, 1952. Dispon\u00edvel\nem:&lt;http://nvlpubs.nist.gov/nistpubs/jres/049/jresv49n6p409_\nA1b.pdf>. Citado na p\u00e1gina 79.\n\nHOU, T. Y.; WU, X.-H. A multiscale finite element method\nfor elliptic problems in composite materials and porous media.\nJournal of Computational Physics, v. 134, n. 134, p. 169\u2013189,\n1997. Dispon\u00edvel em:&lt;http://doi.org/10.1006/jcph.1997.5682>.\nCitado 2 vezes nas p\u00e1ginas 98 e 102.\n\nHOU, T. Y.; WU, X.-H.; CAI, Z. Convergence of a\nmultiscale finite element method for elliptic problems\nwith rapidly oscillating coefficients. Mathematics of\nComputation, v. 68, n. 227, p. 913\u2013943, 1999. Dispon\u00edvel\nem:&lt;http://www.ams.org/journals/mcom/1999-68-227/\nS0025-5718-99-01077-7/S0025-5718-99-01077-7.pdf>. Citado na\np\u00e1gina 98.\n\nhttps://computation.llnl.gov/casc/people/henson/postscript/UCRL_JC_150259.pdf\nhttps://computation.llnl.gov/casc/people/henson/postscript/UCRL_JC_150259.pdf\nhttp://doi.org/10.1016/S0168-9274(01)00115-5\nhttp://epubs.siam.org/doi/abs/10.1137/070705015?journalCode=mmsubt\nhttp://epubs.siam.org/doi/abs/10.1137/070705015?journalCode=mmsubt\nhttp://nvlpubs.nist.gov/nistpubs/jres/049/jresv49n6p409_A1b.pdf\nhttp://nvlpubs.nist.gov/nistpubs/jres/049/jresv49n6p409_A1b.pdf\nhttp://doi.org/10.1006/jcph.1997.5682\nhttp://www.ams.org/journals/mcom/1999-68-227/S0025-5718-99-01077-7/S0025-5718-99-01077-7.pdf\nhttp://www.ams.org/journals/mcom/1999-68-227/S0025-5718-99-01077-7/S0025-5718-99-01077-7.pdf\n\n\nRefer\u00eancias 205\n\nJENNY, P.; LEE, S.; TCHELEPI, H. Adaptive multiscale\nfinite-volume method for multiphase flow and transport\nin porous media. Multiscale Modeling &amp; Simulation,\nv. 3, n. 1, p. 50\u201364, 2005. Dispon\u00edvel em:&lt;http:\n//epubs.siam.org/doi/abs/10.1137/030600795>. Citado na\np\u00e1gina 110.\n\nJENNY, P.; LEE, S.; TCHELEPI, H. Adaptive fully implicit\nmulti-scale finite-volume method for multi-phase flow\nand transport in heterogeneous porous media. Journal of\nComputational Physics, v. 217, n. 2, p. 627 \u2013 641, 2006. ISSN 0021-\n9991. Dispon\u00edvel em:&lt;http://doi.org/10.1016/j.jcp.2006.01.028>.\nCitado 3 vezes nas p\u00e1ginas 62, 106 e 110.\n\nJENNY, P.; LEE, S. H.; TCHELEPI, H. A. Multiscale\nfinite-volume method for elliptic problems in subsurface\nflow simulation. J. Comput. Phys., Academic Press\nProfessional, Inc., San Diego, CA, USA, v. 187, n. 1,\np. 47\u201367, Maio 2003. ISSN 0021-9991. Dispon\u00edvel em:\n<http://dx.doi.org/10.1016/S0021-9991(03)00075-5>. Citado 4\nvezes nas p\u00e1ginas 34, 98, 101 e 109.\n\nJENNY, P.; LUNATI, I. Modeling complex wells with the\nmulti-scale finite-volume method. Journal of Computational\nPhysics, v. 228, n. 3, p. 687\u2013702, 2009. Dispon\u00edvel em:\n<http://doi.org/10.1016/j.jcp.2008.09.026>. Citado na p\u00e1gina\n111.\n\nKARYPIS, G.; KUMAR, V. A fast and highly quality multilevel\nscheme for partitioning irregular graphs. SIAM Journal on\nScientific Computing, v. 20, n. 1, p. 359\u2013392, August 1998.\nDispon\u00edvel em:&lt;http://doi.org/10.1137/S1064827595287997>.\nCitado na p\u00e1gina 93.\n\nKAVIANY, M. Principles of Heat Transfer in Porous\nMedia. Springer-Verlag, 1995. ISBN 9780387945507.\nDispon\u00edvel em:&lt;http://link.springer.com/book/10.1007%\n2F978-1-4612-4254-3>. Citado na p\u00e1gina 31.\n\nhttp://epubs.siam.org/doi/abs/10.1137/030600795\nhttp://epubs.siam.org/doi/abs/10.1137/030600795\nhttp://doi.org/10.1016/j.jcp.2006.01.028\nhttp://dx.doi.org/10.1016/S0021-9991(03)00075-5\nhttp://doi.org/10.1016/j.jcp.2008.09.026\nhttp://doi.org/10.1137/S1064827595287997\nhttp://link.springer.com/book/10.1007%2F978-1-4612-4254-3\nhttp://link.springer.com/book/10.1007%2F978-1-4612-4254-3\n\n\n206 Refer\u00eancias\n\nKEILEGAVLEN, E.; NORDBOTTEN, J. Inexact linear\nsolvers for control volume discretizations in porous media.\nComputational Geosciences, Springer International Publishing,\nv. 19, p. 1\u201318, 2014. ISSN 1420-0597. Dispon\u00edvel em:\n<http://dx.doi.org/10.1007/s10596-014-9453-8>. Citado na\np\u00e1gina 111.\n\nKELLEY, C. T. Iterative Methods for Linear and\nNonlinear Equations. SIAM, 1995. Dispon\u00edvel em:\n<https://www.siam.org/books/textbooks/fr16_book.pdf>.\nCitado na p\u00e1gina 73.\n\nKERSHAW, D. S. The incomplete cholesky - conjugate gradient\nmethod for the iterative solution of systems of linear equations.\nJournal of Computational Physics, v. 26, p. 43\u201365, 1978.\nDispon\u00edvel em:&lt;http://doi.org/10.1016/0021-9991(78)90098-0>.\nCitado na p\u00e1gina 86.\n\nKILLOUGH, J. Ninth spe comparative solution project: A\nreexamination of black-oil simulation. In: SPE Reservoir\nSimulation Symposium, 12-15 February, San Antonio,\nTexas. [s.n.], 1995. SPE-29110-MS. Dispon\u00edvel em:\n<http://dx.doi.org/10.2118/29110-MS>. Citado na p\u00e1gina 185.\n\nKILLOUGH, J.; WANG, Y. Solver preconditioning using the\ncombinatorial multilevel method. In: SPE Reservoir Simulation\nSymposium, 18-20 February, The Woodlands, Texas, USA. [s.n.],\n2013. Dispon\u00edvel em:&lt;http://dx.doi.org/10.2118/163589-MS>.\nCitado 3 vezes nas p\u00e1ginas 61, 69 e 92.\n\nKIPPE, V.; AARNES, J.; LIE, K.-A. A comparison of\nmultiscale methods for elliptic problems in porous media\nflow. Computational Geosciences, Springer Netherlands,\nv. 12, n. 3, p. 377\u2013398, 2008. ISSN 1420-0597. Dispon\u00edvel em:\n<http://dx.doi.org/10.1007/s10596-007-9074-6>. Citado na\np\u00e1gina 34.\n\nKLIE, H. et al. Deflation AMG solvers for highly ill-conditioned\nreservoir simulation problems. In: SPE Reservoir Simulation\n\nhttp://dx.doi.org/10.1007/s10596-014-9453-8\nhttps://www.siam.org/books/textbooks/fr16_book.pdf\nhttp://doi.org/10.1016/0021-9991(78)90098-0\nhttp://dx.doi.org/10.2118/29110-MS\nhttp://dx.doi.org/10.2118/163589-MS\nhttp://dx.doi.org/10.1007/s10596-007-9074-6\n\n\nRefer\u00eancias 207\n\nSymposium, 26-28 February, Houston, Texas, U.S.A. [s.n.],\n2007. Dispon\u00edvel em:&lt;http://dx.doi.org/10.2118/105820-MS>.\nCitado na p\u00e1gina 92.\n\nKOZINTSEV, B.; KEDEM, B. Clipped Gaussian Random Fields.\n1999. Dispon\u00edvel em:&lt;http://math4411.math.umd.edu/cgi-bin/\nbak/generate.cgi/generate.cgi?4>. Citado na p\u00e1gina 135.\n\nKROGSTAD, S. et al. MRST-AD - an open-source framework\nfor rapid prototyping and evaluation of reservoir simulation\nproblems. In: SPE Reservoir Simulation Symposium, 23-25\nFebruary, Houston, Texas, USA. [s.n.], 2015. SPE-173317-MS.\nDispon\u00edvel em:&lt;http://dx.doi.org/10.2118/173317-MS>.\nCitado na p\u00e1gina 46.\n\nKUNZE, R. Multiscale Descriptions of Density-Driven\nFlow Instabilities in Porous Media. Tese (Doutorado) \u2014\nUniversit\u00e9 de Lausanne, 2014. Dispon\u00edvel em:&lt;http:\n//www.maflot.com/Site/INFO_files/thesis.pdf>. Citado na\np\u00e1gina 110.\n\nLACROIX, S. et al. Iterative solution for modeling multiphase\nflow in porous media fully implicitly. SIAM Journal on\nScientific Computing, v. 25, p. 905\u2013926, 2003. Dispon\u00edvel em:\n<http://doi.org/10.1137/S106482750240443X>. Citado na\np\u00e1gina 87.\n\nLAKE, L. W. Enhanced Oil Recovery. Society of Petroleum\nEngineers, 2010. Dispon\u00edvel em:&lt;http://store.spe.org/\nEnhanced-Oil-Recovery--P436.aspx>. Citado na p\u00e1gina 39.\n\nLEE, S.; WOLFSTEINER, C.; TCHELEPI, H. Multiscale\nfinite-volume formulation for multiphase flow in porous media:\nBlack oil formulation of compressible, three-phase flow with\ngravity. Computational Geosciences, Springer Netherlands,\nv. 12, n. 3, p. 351\u2013366, 2008. ISSN 1420-0597. Dispon\u00edvel em:\n<http://dx.doi.org/10.1007/s10596-007-9069-3>. Citado na\np\u00e1gina 111.\n\nhttp://dx.doi.org/10.2118/105820-MS\nhttp://math4411.math.umd.edu/cgi-bin/bak/generate.cgi/generate.cgi?4\nhttp://math4411.math.umd.edu/cgi-bin/bak/generate.cgi/generate.cgi?4\nhttp://dx.doi.org/10.2118/173317-MS\nhttp://www.maflot.com/Site/INFO_files/thesis.pdf\nhttp://www.maflot.com/Site/INFO_files/thesis.pdf\nhttp://doi.org/10.1137/S106482750240443X\nhttp://store.spe.org/Enhanced-Oil-Recovery--P436.aspx\nhttp://store.spe.org/Enhanced-Oil-Recovery--P436.aspx\nhttp://dx.doi.org/10.1007/s10596-007-9069-3\n\n\n208 Refer\u00eancias\n\nLEE, S. H.; ZHOU, H.; TCHELEPI, H. A. Adaptive multiscale\nfinite volume method for nonlinear multiphase transport in\nheterogeneous formations. Journal of Computational Physics,\nv. 228, n. 4, p. 9036\u20139058, December 2009. Dispon\u00edvel em:\n<http://doi.org/10.1016/j.jcp.2009.09.009>. Citado na p\u00e1gina\n110.\n\nLI, X. S.; DEMMEL, J. W. SuperLU_DIST - a scalable\ndistributed memory sparse direct solver for unsymmetric\nlinear systems. ACM Transactions on Mathematical\nSoftware, v. 29, n. 2, p. 110\u2013140, June 2003. Dispon\u00edvel em:\n<http://doi.org/10.1145/779359.779361>. Citado na p\u00e1gina\n133.\n\nLIE, K. A. et al. Open source MATLAB implementation of\nconsistent discretisations on complex grids. Computational\nGeosciences, v. 16, p. 297\u2013322, 2012. Dispon\u00edvel em:\n<http://doi.org/10.1007/s10596-011-9244-4>. Citado na p\u00e1gina\n46.\n\nLIU, W.-H.; SHERMAN, A. H. Comparative analysis\nof the cuthill-mckee and the reverse cuthill-mckee\nordering algorithms for sparse matrices. SIAM Journal on\nNumerical Analysis, v. 13, p. 198\u2013213, 1976. Dispon\u00edvel em:\n<http://www.jstor.org/stable/2156087>. Citado na p\u00e1gina 74.\n\nLUNATI, I.; JENNY, P. The multiscale finite-volume\nmethod - a flexible tool to model physically complex\nflow in porous media. In: 10th European Conference on\nthe Mathematics of Oil Recovery \u2014 Amsterdam, The\nNetherlands, 4 \u2013 7 September 2006. [s.n.], 2006. Dispon\u00edvel em:\n<http://www.researchgate.net/publication/37451134>. Citado\nna p\u00e1gina 110.\n\nLUNATI, I.; JENNY, P. Multiscale finite-volume method\nfor compressible multiphase flow in porous media.\nJournal of Computational Physics, v. 216, n. 2, p. 616\n\u2013 636, 2006. ISSN 0021-9991. Dispon\u00edvel em:&lt;http:\n//dx.doi.org/10.1016/j.jcp.2006.01.001>. Citado na p\u00e1gina 110.\n\nhttp://doi.org/10.1016/j.jcp.2009.09.009\nhttp://doi.org/10.1145/779359.779361\nhttp://doi.org/10.1007/s10596-011-9244-4\nhttp://www.jstor.org/stable/2156087\nhttp://www.researchgate.net/publication/37451134\nhttp://dx.doi.org/10.1016/j.jcp.2006.01.001\nhttp://dx.doi.org/10.1016/j.jcp.2006.01.001\n\n\nRefer\u00eancias 209\n\nLUNATI, I.; JENNY, P. Treating highly anisotropic subsurface\nflow with the multiscale finite volume method. Multiscale\nModeling &amp; Simulation, v. 6, p. 308\u2013318, 2007. Dispon\u00edvel em:\n<http://doi.org/10.1137/050638928>. Citado na p\u00e1gina 110.\n\nLUNATI, I.; JENNY, P. Multiscale finite-volume method\nfor density-driven flow in porous media. Computational\nGeosciences, Springer, v. 12, n. 3, p. 337\u2013350, 2008. Dispon\u00edvel\nem:&lt;http://dx.doi.org/10.1007/s10596-007-9071-9>. Citado\nna p\u00e1gina 108.\n\nLUNATI, I.; LEE, S. H. An operator formulation of the\nmultiscale finite-volume method with correction function.\nMultiscale Modeling &amp; Simulation, v. 8, n. 1, p. 96\u2013109, 2009.\nDispon\u00edvel em:&lt;http://dblp.uni-trier.de/db/journals/mmas/\nmmas8.html#LunatiL09>. Citado na p\u00e1gina 108.\n\nLUNATI, I.; TYAGI, M.; LEE, S. H. An iterative multiscale\nfinite volume algorithm converging to the exact solution. Journal\nof Computational Physics, v. 230, n. 5, p. 1849 \u2013 1864, 2011.\nISSN 0021-9991. Dispon\u00edvel em:&lt;http://www.sciencedirect.com/\nscience/article/pii/S0021999110006510>. Citado na p\u00e1gina 111.\n\nMALISKA, C. R. Transfer\u00eancia de Calor e Mec\u00e2nica dos\nFluidos Computacional. LTC, 2004. Dispon\u00edvel em:&lt;http:\n//www.researchgate.net/publication/233843056_Transferncia_\nde_Calor_e_Mecnica_dos_Fluidos_Computacional>. Citado\nna p\u00e1gina 46.\n\nMANEA, A. M.; SEWALL, J.; TCHELEPI, H. A. Parallel\nmultiscale linear solver for highly detailed reservoir\nmodels. In: SPE Reservoir Simulation Symposium, 23-25\nFebruary, Houston, Texas, USA. [s.n.], 2015. Dispon\u00edvel em:\n<http://dx.doi.org/10.2118/173259-MS>. Citado na p\u00e1gina 35.\n\nMASSON, R. et al. Parallel preconditioning for sedimentary\nbasin simulations. Lecture Notes in Computer Science, v. 2907,\np. 93\u2013102, 2004. Dispon\u00edvel em:&lt;http://doi.org/10.1007/\n978-3-540-24588-9_9>. Citado na p\u00e1gina 87.\n\nhttp://doi.org/10.1137/050638928\nhttp://dx.doi.org/10.1007/s10596-007-9071-9\nhttp://dblp.uni-trier.de/db/journals/mmas/mmas8.html#LunatiL09\nhttp://dblp.uni-trier.de/db/journals/mmas/mmas8.html#LunatiL09\nhttp://www.sciencedirect.com/science/article/pii/S0021999110006510\nhttp://www.sciencedirect.com/science/article/pii/S0021999110006510\nhttp://www.researchgate.net/publication/233843056_Transferncia_de_Calor_e_Mecnica_dos_Fluidos_Computacional\nhttp://www.researchgate.net/publication/233843056_Transferncia_de_Calor_e_Mecnica_dos_Fluidos_Computacional\nhttp://www.researchgate.net/publication/233843056_Transferncia_de_Calor_e_Mecnica_dos_Fluidos_Computacional\nhttp://dx.doi.org/10.2118/173259-MS\nhttp://doi.org/10.1007/978-3-540-24588-9_9\nhttp://doi.org/10.1007/978-3-540-24588-9_9\n\n\n210 Refer\u00eancias\n\nMATHEW, T. P. Domain Decomposition Methods for\nthe Numerical Solution of Partial Differential Equations.\nSpringer-Verlag Berlin Heidelberg, 2008. Dispon\u00edvel em:\n<http://doi.org/10.1007/978-3-540-77209-5>. Citado na p\u00e1gina\n96.\n\nMOYNER, O. Multiscale Finite Volume Methods - Extension to\nUnstructured Grids with Applications in Reservoir Simulation.\nDisserta\u00e7\u00e3o (Master of Science in Physics and Mathematics) \u2014\nNTNU - Norwegian University of Science and Technology, 2012.\nDispon\u00edvel em:&lt;http://hdl.handle.net/11250/259015>. Citado\nna p\u00e1gina 106.\n\nMOYNER, O. Construction of multiscale preconditioners on\nstratigraphic grids. In: ECMOR XIV - 14th European Conference\non the Mathematics of Oil Recovery. [s.n.], 2014. Dispon\u00edvel\nem:&lt;http://doi.org/10.3997/2214-4609.20141775>. Citado na\np\u00e1gina 111.\n\nMOYNER, O.; LIE, K. A. The multiscale finite-volume method\non stratigraphic grids. SPE Journal, v. 19, p. 816\u2013831, 2014.\nDispon\u00edvel em:&lt;http://dx.doi.org/10.2118/163649-PA>.\nCitado 2 vezes nas p\u00e1ginas 106 e 111.\n\nMOYNER, O.; LIE, K. A. A multiscale two-point\nflux-approximation method. Journal of Computational\nPhysics, v. 275, p. 273\u2013293, 2014. Dispon\u00edvel em:\n<http://doi.org/10.1016/j.jcp.2014.07.003>. Citado na\np\u00e1gina 110.\n\nMOYNER, O.; LIE, K. A. A multiscale method based on\nrestriction-smoothed basis functions suitable for general grids in\nhigh contrast media. In: SPE Reservoir Simulation Symposium,\n23-25 February, Houston, Texas, USA. [s.n.], 2015. Dispon\u00edvel\nem:&lt;http://dx.doi.org/10.2118/173265-MS>. Citado na p\u00e1gina\n111.\n\nDESIGN 28th ACM SIGPLAN Conference on P. L.;\nIMPLEMENTATION (Ed.). Valgrind: a framework for\n\nhttp://doi.org/10.1007/978-3-540-77209-5\nhttp://hdl.handle.net/11250/259015\nhttp://doi.org/10.3997/2214-4609.20141775\nhttp://dx.doi.org/10.2118/163649-PA\nhttp://doi.org/10.1016/j.jcp.2014.07.003\nhttp://dx.doi.org/10.2118/173265-MS\n\n\nRefer\u00eancias 211\n\nheavyweight dynamic binary instrumentation, v. 42, n. 6. [s.n.],\n2007. Dispon\u00edvel em:&lt;http://dx.doi.org/10.1145/1273442.\n1250746>. Citado na p\u00e1gina 144.\n\nNORDBOTTEN, J.; BJORSTAD, P. On the relationship between\nthe multiscale finite-volume method and domain decomposition\npreconditioners. Computational Geosciences, Springer\nNetherlands, v. 12, n. 3, p. 367\u2013376, 2008. ISSN 1420-0597.\nDispon\u00edvel em:&lt;http://dx.doi.org/10.1007/s10596-007-9066-6>.\nCitado na p\u00e1gina 111.\n\nOSEI-KUFFUOUR, D.; SAAD, Y. Matrix reordering using\nmultilevel graph coarsening for ilu preconditioning. SIAM\nJournal on Scientific Computing, v. 37, p. A319\u2013A419, 2015.\nDispon\u00edvel em:&lt;http://doi.org/10.1137/130936610>. Citado\nna p\u00e1gina 86.\n\nPAL, M. et al. Validation of the multiscale mixed finite element\nmethod. International Journal for Numerical Methods in\nFluids, v. 77, n. 4, p. 206\u2013223, November 2014. ISSN 1097-0363.\nDispon\u00edvel em:&lt;http://dx.doi.org/10.1002/fld.3978>. Citado\nna p\u00e1gina 98.\n\nPEACEMAN, D. W. Fundamentals of Numerical Reservoir\nSimulation. Elsevier Scientific Publishing Company, 1977.\nDispon\u00edvel em:&lt;http://dl.acm.org/citation.cfm?id=531922>.\nCitado na p\u00e1gina 45.\n\nPEACEMAN, D. W. Interpretation of well-block pressures\nin numerical reservoir simulation with nonsquare grid blocks\nand anisotropic permeability. SPE Journal, v. 23, n. 03,\np. 531\u2013543, June 1983. SPE-10528-PA. Dispon\u00edvel em:\n<http://dx.doi.org/10.2118/10528-PA>. Citado 2 vezes nas\np\u00e1ginas 40 e 44.\n\nPOINTING, D. K. Corner point grid in reservoir\nsimulation. In: ECMOR I - 1st European Conference on the\nMathematics of Oil Recovery. [s.n.], 1989. Dispon\u00edvel em:\n\nhttp://dx.doi.org/10.1145/1273442.1250746\nhttp://dx.doi.org/10.1145/1273442.1250746\nhttp://dx.doi.org/10.1007/s10596-007-9066-6\nhttp://doi.org/10.1137/130936610\nhttp://dx.doi.org/10.1002/fld.3978\nhttp://dl.acm.org/citation.cfm?id=531922\nhttp://dx.doi.org/10.2118/10528-PA\n\n\n212 Refer\u00eancias\n\n<http://doi.org/10.3997/2214-4609.201411305>. Citado na\np\u00e1gina 46.\n\nPOLLOCK, D. W. Semianalytical computation of\npath lines for finite-difference models. Groundwater,\nv. 26, n. 6, p. 743\u2013750, November 1988. Dispon\u00edvel em:\n<http://dx.doi;org/10.1111/j.1745-6584.1988.tb00425.x>.\nCitado na p\u00e1gina 140.\n\nPRESHO, M.; GALVIS, J. A mass conservative generalized\nmultiscale finite element method applied to two-phase flow in\nheterogeneous porous media. Preprint submitted to Journal of\nComputational and Applied Mathematics. 2015. Dispon\u00edvel em:\n<http://arxiv.org/abs/1504.02033>. Citado na p\u00e1gina 98.\n\nQIN, G.; EWING, R. E.; CHEN, Z. Analysis of a compositional\nmodel for fluid flow in porous media. SIAM Journal on\nApplied Mathematics, v. 60, p. 747\u2013777, 2000. Dispon\u00edvel em:\n<http://doi.org/10.1137/S0036139998333427>. Citado na\np\u00e1gina 39.\n\nRICHARDSON, L. F. The approximate arithmetical solution\nby finite differences of physical problems involving differential\nequations, with an application to the stresses in a masonry\ndam. Philosophical Transactions of the Royal Society of\nLondon. Series A, Containing Papers of a Mathematical or\nPhysical Character, v. 210, p. 307\u2013357, 1911. Dispon\u00edvel em:\n<http://www.jstor.org/stable/90994>. Citado na p\u00e1gina 75.\n\nSAAD, Y. ILUT: A dual threshold incomplete LU factorization.\nNumerical Linear Algebra with Applications, v. 1, p. 387\u2013402,\n1994. Dispon\u00edvel em:&lt;http://doi.org/10.1002/nla.1680010405>.\nCitado na p\u00e1gina 85.\n\nSAAD, Y. Preconditioned Krylov Subspace Methods for\nCFD Application. [S.l.], 1994. Dispon\u00edvel em:&lt;http:\n//www-users.cs.umn.edu/~saad/PDF/umsi-94-171.pdf>.\nCitado na p\u00e1gina 85.\n\nhttp://doi.org/10.3997/2214-4609.201411305\nhttp://dx.doi;org/10.1111/j.1745-6584.1988.tb00425.x\nhttp://arxiv.org/abs/1504.02033\nhttp://doi.org/10.1137/S0036139998333427\nhttp://www.jstor.org/stable/90994\nhttp://doi.org/10.1002/nla.1680010405\nhttp://www-users.cs.umn.edu/~saad/PDF/umsi-94-171.pdf\nhttp://www-users.cs.umn.edu/~saad/PDF/umsi-94-171.pdf\n\n\nRefer\u00eancias 213\n\nSAAD, Y. ILUM: A multi-elimination ILU preconditioner\nfor general sparse matrices. SIAM Journal on Scientific\nComputing, v. 14, p. 830\u2013847, 1996. Dispon\u00edvel em:\n<http://doi.org/10.1137/0917054>. Citado na p\u00e1gina 86.\n\nSAAD, Y. Iterative Methods for Sparse Linear Systems. Society for\nIndustrial and Applied Mathematics, 2003. ISBN 9780898715347.\nDispon\u00edvel em:&lt;http://dx.doi.org/10.1137/1.9780898718003>.\nCitado 6 vezes nas p\u00e1ginas 73, 74, 76, 77, 82 e 85.\n\nSAAD, Y.; SCHULTZ, M. H. GMRes: Generalized minimal\nresidual algorithm for solving non-symmetric linear systems.\nScientific and Statistical Computing, v. 7, n. 3, p. 856\u2013869, Julho\n1986. Dispon\u00edvel em:&lt;http://www.stat.uchicago.edu/~lekheng/\ncourses/324/saad-schultz.pdf>. Citado na p\u00e1gina 76.\n\nSANDVE, T. H.; KEILEGAVLEN, E.; NORDBOTTEN,\nJ. M. Physics-based preconditioners for flow in fractured\nporous media. Water Resources Research, v. 50, n. 2,\np. 1357\u20131373, 2014. ISSN 1944-7973. Dispon\u00edvel em:\n<http://dx.doi.org/10.1002/2012WR013034>. Citado na p\u00e1gina\n111.\n\nSANDVIN, A. Robust Multiscale Control-volume Methods for\nReservoir Simulation. Tese (Doutorado) \u2014 University of Bergen,\n2012. Dispon\u00edvel em:&lt;https://bora.uib.no/handle/1956/7416>.\nCitado 2 vezes nas p\u00e1ginas 32 e 71.\n\nSCHEICHL, R.; MASSON, R.; WENDEBOURG, J. Decoupling\nand block preconditioning for sedimentary basin simulations.\nComputational Geosciences, v. 7, p. 295\u2013318, 2003. Dispon\u00edvel\nem:&lt;http://doi.org/10.1023/B:COMG.0000005244.61636.4e>.\nCitado na p\u00e1gina 87.\n\nSMITH, B. F.; BJ\u00f8RSTAD, P. E.; GROPP, W. D. Domain\ndecomposition: parallel multilevel methods for elliptic partial\ndifferential equations. Cambridge University Press, 1996.\nDispon\u00edvel em:&lt;http://dl.acm.org/citation.cfm?id=238150>.\nCitado na p\u00e1gina 96.\n\nhttp://doi.org/10.1137/0917054\nhttp://dx.doi.org/10.1137/1.9780898718003\nhttp://www.stat.uchicago.edu/~lekheng/courses/324/saad-schultz.pdf\nhttp://www.stat.uchicago.edu/~lekheng/courses/324/saad-schultz.pdf\nhttp://dx.doi.org/10.1002/2012WR013034\nhttps://bora.uib.no/handle/1956/7416\nhttp://doi.org/10.1023/B:COMG.0000005244.61636.4e\nhttp://dl.acm.org/citation.cfm?id=238150\n\n\n214 Refer\u00eancias\n\nSPILLETE, A. G.; HILLESTAD, J. G.; STONE, H. L. A\nhigh-stability sequential solution approach to reservoir simulation.\nIn: Fall Meeting of the Society of Petroleum Engineers of AIME,\n30 September-3 October, Las Vegas, Nevada. [s.n.], 1973. SPE-\n4542-MS. Dispon\u00edvel em:&lt;http://dx.doi.org/10.2118/4542-MS>.\nCitado na p\u00e1gina 62.\n\nSTUBEN, K. A review of algebraic multigrid. Journal of\nComputational and Applied Mathematics, v. 128, p. 281\u2013309,\n2001. Dispon\u00edvel em:&lt;http://doi.org/10.1016/S0377-0427(00)\n00516-1>. Citado 2 vezes nas p\u00e1ginas 88 e 92.\n\nSTUBEN, K. Solving reservoir simulation equations. In: Ninth\nInternational Forum on Reservoir Simulation, Abu Dhabi, United\nArab Emirates. 9th International Forum on Reservoir Simulation,\n2007. Dispon\u00edvel em:&lt;https://www.scai.fraunhofer.de/fileadmin/\ndownload/publikationen/Paper_AD_040907.pdf>. Citado na\np\u00e1gina 92.\n\nSUN, S.; KEYES, D. E.; LIU, L. Fully implicit two-\nphase reservoir simulation with the additive schwarz\npreconditioned inexact newton method. In: SPE Reservoir\nCharacterization and Simulation Conference and Exhibition,\n16-18 September, Abu Dhabi, UAE. [s.n.], 2013. Dispon\u00edvel em:\n<http://dx.doi.org/10.2118/166062-MS>. Citado na p\u00e1gina 52.\n\nTHOMAS, G. W.; THURNAU, D. H. Reservoir simulation\nusing an adaptive implicit method. SPE Journal, v. 23,\np. 759\u2013763, 1983. SPE-10120-PA. Dispon\u00edvel em:&lt;http:\n//dx.doi.org/10.2118/10120-PA>. Citado na p\u00e1gina 48.\n\nTOSELLI, A.; WIDLUND, O. Domain Decomposition Methods -\nAlgorithms and Theory. Springer Berlin Heidelberg, 2005. v. 34.\nDispon\u00edvel em:&lt;http://doi.org/10.1007/b137868>. Citado na\np\u00e1gina 96.\n\nTRANGENSTEIN, J. A.; BELL, J. B. Mathematical structure of\ncompositional reservoir simulation. SIAM Journal on Scientific\n\nhttp://dx.doi.org/10.2118/4542-MS\nhttp://doi.org/10.1016/S0377-0427(00)00516-1\nhttp://doi.org/10.1016/S0377-0427(00)00516-1\nhttps://www.scai.fraunhofer.de/fileadmin/download/publikationen/Paper_AD_040907.pdf\nhttps://www.scai.fraunhofer.de/fileadmin/download/publikationen/Paper_AD_040907.pdf\nhttp://dx.doi.org/10.2118/166062-MS\nhttp://dx.doi.org/10.2118/10120-PA\nhttp://dx.doi.org/10.2118/10120-PA\nhttp://doi.org/10.1007/b137868\n\n\nRefer\u00eancias 215\n\nand Statistical Computing, v. 10, p. 815\u2013845, 1989. Dispon\u00edvel\nem:&lt;http://doi.org/10.1137/0910049>. Citado na p\u00e1gina 39.\n\nTROTTENBERG, U.; OOSTERLEE, C.; SCH\u00dcLLER,\nA. Multigrid. Academic Press, 2001. ISBN 9780127010700.\nDispon\u00edvel em:&lt;https://books.google.com.br/books?id=\n-og1wD-Nx\\_wC>. Citado na p\u00e1gina 92.\n\nWALLIS, J. R. Incomplete gaussian elimination as a\npreconditioning for generalized conjugate gradient acceleration.\nIn: SPE Reservoir Simulation Symposium, 15-18 November,\nSan Francisco, California. [s.n.], 1983. Dispon\u00edvel em:\n<http://dx.doi.org/10.2118/12265-MS>. Citado na p\u00e1gina 86.\n\nWALLIS, J. R.; KENDALL, R. P.; LITTLE, T. E.\nConstrained residual acceleration of conjugate residual\nmethods. In: SPE Reservoir Simulation Symposium, 10-\n13 February, Dallas, Texas. [s.n.], 1985. Dispon\u00edvel em:\n<http://dx.doi.org/10.2118/13536-MS>. Citado na p\u00e1gina 86.\n\nWANG, Y. Algebraic Multiscale Linear Solver for Heterogeneous\nElliptic Problems. Disserta\u00e7\u00e3o (Mestrado) \u2014 Resources\nEngineering Stanford University, 2012. Dispon\u00edvel em:\n<https://pangea.stanford.edu/ERE/pdf/pereports/MS/Wang_\nYixuan2012.pdf>. Citado 2 vezes nas p\u00e1ginas 113 e 127.\n\nWANG, Y.; HAJIBEYGI, H.; TCHELEPI, H. A. Algebraic\nmultiscale solver for flow in heterogeneous porous\nmedia. Journal of Computational Physics, v. 259, n. 0,\np. 284 \u2013 303, 2014. ISSN 0021-9991. Dispon\u00edvel em:\n<http://dx.doi.org/10.1016/j.jcp.2013.11.024>. Citado 4 vezes\nnas p\u00e1ginas 113, 127, 128 e 140.\n\nWATTS, J. W.; SHAW, J. S. A new method for solving\nthe implicit reservoir simulation matrix equation. In:\nSPE Reservoir Simulation Symposium, 31 January-2\nFeburary, The Woodlands, Texas. [s.n.], 2005. Dispon\u00edvel em:\n<http://dx.doi.org/10.2118/93068-MS>. Citado na p\u00e1gina 49.\n\nhttp://doi.org/10.1137/0910049\nhttps://books.google.com.br/books?id=-og1wD-Nx\\_wC\nhttps://books.google.com.br/books?id=-og1wD-Nx\\_wC\nhttp://dx.doi.org/10.2118/12265-MS\nhttp://dx.doi.org/10.2118/13536-MS\nhttps://pangea.stanford.edu/ERE/pdf/pereports/MS/Wang_Yixuan2012.pdf\nhttps://pangea.stanford.edu/ERE/pdf/pereports/MS/Wang_Yixuan2012.pdf\nhttp://dx.doi.org/10.1016/j.jcp.2013.11.024\nhttp://dx.doi.org/10.2118/93068-MS\n\n\n216 Refer\u00eancias\n\nWHITAKER, S. Flow in porous media i: A theoretical derivation\nof darcy\u2019s law. Transport in Porous Media, Kluwer Academic\nPublishers, v. 1, n. 1, p. 3\u201325, 1986. ISSN 0169-3913. Dispon\u00edvel\nem:&lt;http://dx.doi.org/10.1007/BF01036523>. Citado na\np\u00e1gina 42.\n\nWILLIAMS, S.; WATERMAN, A.; PATTERSON, D. Roofline:\nAn insighful visual performance model for multicore architectures.\nCommunications of the ACM, v. 52, p. 65\u201376, 2009. Dispon\u00edvel\nem:&lt;http://doi.org/10.1145/1498765.1498785>. Citado na\np\u00e1gina 72.\n\nWOLFSTEINER, C.; LEE, S.; TCHELEPI, H. Well\nmodeling in the multiscale finite volume method for\nsubsurface flow simulation. Multiscale Modeling &amp;\nSimulation, v. 5, n. 3, p. 900\u2013917, 2006. Dispon\u00edvel em:\n<http://epubs.siam.org/doi/abs/10.1137/050640771>. Citado\nna p\u00e1gina 111.\n\nXU, J. The method of subspace corrections. Journal of\nComputational and Applied Mathematics, v. 128, p. 335\u2013362,\n2001. Dispon\u00edvel em:&lt;http://doi.org/10.1016/S0377-0427(00)\n00518-5>. Citado na p\u00e1gina 96.\n\nYANG, U. M. Parallel algebraic multigrid methods high\nperformance preconditioners. In: . Springer Berlin\nHeidelberg, 2006. cap. 2, p. 209\u2013236. Dispon\u00edvel em:\n<http://doi.org/10.1007/3-540-31619-1_6>. Citado na p\u00e1gina\n92.\n\nZHOU, H. Operator Based Multiscale Method for Compressible\nFlow. Disserta\u00e7\u00e3o (Mestrado) \u2014 Stanford University, 2006.\nDispon\u00edvel em:&lt;https://pangea.stanford.edu/ERE/pdf/\npereports/MS/Zhou06.pd>. Citado 2 vezes nas p\u00e1ginas 110\ne 113.\n\nZHOU, H. Algebraic Multiscale Finite-Volume Methods for\nReservoir Simulation. Tese (Doutorado) \u2014 Stanford University,\n2010. Dispon\u00edvel em:&lt;https://pangea.stanford.edu/ERE/pdf/\n\nhttp://dx.doi.org/10.1007/BF01036523\nhttp://doi.org/10.1145/1498765.1498785\nhttp://epubs.siam.org/doi/abs/10.1137/050640771\nhttp://doi.org/10.1016/S0377-0427(00)00518-5\nhttp://doi.org/10.1016/S0377-0427(00)00518-5\nhttp://doi.org/10.1007/3-540-31619-1_6\nhttps://pangea.stanford.edu/ERE/pdf/pereports/MS/Zhou06.pd\nhttps://pangea.stanford.edu/ERE/pdf/pereports/MS/Zhou06.pd\nhttps://pangea.stanford.edu/ERE/pdf/pereports/PhD/Zhou-Hui10.pdf\nhttps://pangea.stanford.edu/ERE/pdf/pereports/PhD/Zhou-Hui10.pdf\n\n\nRefer\u00eancias 217\n\npereports/PhD/Zhou-Hui10.pdf>. Citado 2 vezes nas p\u00e1ginas\n111 e 113.\n\nZHOU, H.; TCHELEPI, H. Operator based multiscale method\nfor compressible flow. SPE Journal, v. 13, n. 2, p. 267\u2013273,\n2008. Dispon\u00edvel em:&lt;http://dx.doi.org/10.2118/106254-PA>.\nCitado 2 vezes nas p\u00e1ginas 110 e 113.\n\nZHOU, H.; TCHELEPI, H. A. Two-stage algebraic multiscale\nlinear solver for highly heterogeneous reservoir models. SPE\nJournal, Society of Petroleum Engineers, v. 17, n. 02, p. 523\u2013539,\n2012. Dispon\u00edvel em:&lt;http://dx.doi.org/10.2118/141473-PA>.\nCitado na p\u00e1gina 113.\n\nhttps://pangea.stanford.edu/ERE/pdf/pereports/PhD/Zhou-Hui10.pdf\nhttps://pangea.stanford.edu/ERE/pdf/pereports/PhD/Zhou-Hui10.pdf\nhttp://dx.doi.org/10.2118/106254-PA\nhttp://dx.doi.org/10.2118/141473-PA\n\n\n\n\nAp\u00eandices\n\n\n\n\n\n221\n\nAP\u00caNDICE A \u2013 PAR\u00c2METROS DO MODELO\nBLACK-OIL\n\nNesse cap\u00edtulo, apresentam-se as rela\u00e7\u00f5es para as proprie-\ndades dos fluidos do modelo black-oil.\n\nA.1 FASE \u00c1GUA\n\nO fator volume de forma\u00e7\u00e3o da fase \u00e1gua Bw \u00e9 dado por\n\nBw = Biw\n(\n1 + cw\n\n(\np?pi\n\n))\n, (A.1)\n\nem que Biw \u00e9 o fator volume de forma\u00e7\u00e3o da \u00e1gua avaliado na\npress\u00e3o de refer\u00eancia pi e cw \u00e9 a raz\u00e3o de compressibilidade da\nfase \u00e1gua.\n\nA viscosidade da fase \u00e1gua \u00b5w \u00e9 dada por\n\n\u00b5w = \u00b5iw\n(\n1 + dw\n\n(\np?pi\n\n))\n, (A.2)\n\nem que \u00b5iw \u00e9 a viscosidade da \u00e1gua avaliada na press\u00e3o de refe-\nr\u00eancia e dw \u00e9 a viscosibilidade, par\u00e2metro que mede a influ\u00eancia\nda press\u00e3o sobre a viscosidade.\n\nA.2 FASE \u00d3LEO\n\nAs propriedades da fase \u00f3leo s\u00e3o definidas por duas ma-\nneiras, de acordo com o estado em considera\u00e7\u00e3o\n\nA.2.1 Estado subsaturado\n\nO fator volume de forma\u00e7\u00e3o do \u00f3leo no estado subsaturado\n\u00e9 dado por\n\nBo = Bo (pb) (1 ? co (p?pb)) , (A.3)\n\nem que Bo (pb) \u00e9 o fator volume de forma\u00e7\u00e3o do \u00f3leo avaliado na\npress\u00e3o de bolha pb e co, a raz\u00e3o de compressibilidade da fase\n\u00f3leo.\n\n\n\n222 AP\u00caNDICE A. Par\u00e2metros do Modelo black-oil\n\nA viscosidade \u00e9 dada por\n\n\u00b5o = \u00b5ob (pb) (1 + c\u00b5 (p?pb)) , (A.4)\n\nem que \u00b5ob \u00e9 a viscosidade da fase \u00f3leo avaliada na press\u00e3o de\nbolha pb e c\u00b5, a viscosibilidade do \u00f3leo.\n\nA.2.2 Estado saturado\n\nNo estado saturado, o fator volume de forma\u00e7\u00e3o da fase\n\u00f3leo Bo \u00e9 calculado atrav\u00e9s de uma tabela que lista seus valores\ncomo fun\u00e7\u00e3o da press\u00e3o. O mesmo \u00e9 v\u00e1lido para a viscosidade \u00b5o.\n\nA.3 FASE G\u00c1S\n\nA densidade da fase g\u00e1s \u00e9 dada por\n\n?g =\n?gs\nBg\n\n, (A.5)\n\nem que\n?gs = Yg?ar, Bg =\n\nZT\n\np\n\nps\nTs\n, (A.6)\n\ncom Yg a densidade adimensional do g\u00e1s; ?ar, a densidade do ar;\nT e Ts, as temperaturas do g\u00e1s nas condi\u00e7\u00f5es atual e de refer\u00eancia;\np e ps, sua press\u00e3o nas condi\u00e7\u00f5es atual e de refer\u00eancia e Z, o fator\nde compressibilidade.\n\nA viscosidade da fase g\u00e1s \u00b5g \u00e9 fun\u00e7\u00e3o da press\u00e3o, tal\nfun\u00e7\u00e3o \u00e9 definida por valores discretos informados atrav\u00e9s de uma\ntabela.\n\n\n\n223\n\nAP\u00caNDICE B \u2013 PR\u00c9-CONDICIONADOR MULTIESCALA\nALG\u00c9BRICO 3D\n\nNo caso de problemas tridimensionais, o particionamento\nwirebasket da malha refinada apresenta uma nova classe de en-\ntidades: os volumes de superf\u00edcie. Atualizando o operador de\npermuta\u00e7\u00e3o Q de acordo com essa nova classifica\u00e7\u00e3o, segue que\na matriz do sistema linear (5.1) pode ser reescrita no formato\nreordenado da seguinte maneira:\n\nA? = QAQ?T =\n\n?\n?????\n\nA?ii A?is 0ie 0iv\nA?si A?ss A?se 0sv\n0ei A?es Aee A?ev\n0vi 0vs A?ve A?vv\n\n?\n????? . (B.1)\n\nPara a obten\u00e7\u00e3o do pr\u00e9-condicionador multiescala alg\u00e9-\nbrico com fun\u00e7\u00f5es de corre\u00e7\u00e3o M?1mswc, as seguintes conex\u00f5es\npresentes na matriz A? s\u00e3o desconsideradas:\n\n1. conex\u00f5es que partem dos volumes de interior em sentido\naos volumes de superf\u00edcie,\n\n(\nA?si\n\n)\n;\n\n2. conex\u00f5es que partem dos volumes de superf\u00edcie em sentido\naos volumes de aresta,\n\n(\nA?es\n\n)\n;\n\n3. conex\u00f5es que partem dos volumes de aresta em sentido aos\nvolumes de v\u00e9rtice,\n\n(\nA?ve\n\n)\n,\n\no que conduz ao seguinte operador:\n\nMmswc =\n\n?\n?????\n\nA?ii A?is 0ie 0iv\n0si Mss A?se 0sv\n0ei 0es Mee A?ev\n0vi 0vs 0ve Mvv\n\n?\n????? , (B.2)\n\n\n\n224 AP\u00caNDICE B. Pr\u00e9-Condicionador Multiescala Alg\u00e9brico 3D\n\nem que as matrizes Mss e Mee s\u00e3o dadas por:\n\nMss = A?ss + diag\n(?\n\ni\n\nA?Tis\n\n)\n(B.3)\n\nMee = A?ee + diag\n(?\n\ns\n\nA?Tse\n\n)\n(B.4)\n\ne a matriz referente ao problema grosseiro Mvv \u00e9 calculada da\nmesma forma como (5.23).\n\nA adi\u00e7\u00e3o dos volumes de superf\u00edcie tamb\u00e9m provoca a re-\ndefini\u00e7\u00e3o dos operadores de prolonga\u00e7\u00e3o e de corre\u00e7\u00e3o. O primeiro\npassa a ser dado por:\n\nP =\n\n?\n?????\n\nA??1ii A?ieM\n?1\nee A?esM?1ss A?sn\n\n?M?1ee A?esM?1ss A?sn\nM?1ss A?sn\n\nIvv\n\n?\n????? , (B.5)\n\nenquanto o segundo \u00e9 dado por:\n\nC =\n\n?\n?????\n\nA??1ii ?A?\n?1\nii A?isM\n\n?1\nss A?\n\n?1\nii A?isM\n\n?1\nss A?seM?1ee 0iv\n\n0si M?1ss ?M?1ss A?seM?1ee 0sv\n0ei 0es M?1ee 0ev\n0vi 0vs 0ve 0vv\n\n?\n????? .\n(B.6)\n\nO operador de restri\u00e7\u00e3o \u00e9 definido como antes, o qual pode\nser escrito segundo as estrat\u00e9gias baseadas em volumes finitos\n(RFV ) ou elementos finitos (RFE).\n\n\n\tFolha de rosto\n\tFolha de aprova\u00e7\u00e3o\n\tAgradecimentos\n\tEp\u00edgrafe\n\tResumo\n\tAbstract\n\tLista de ilustra\u00e7\u00f5es\n\tLista de tabelas\n\tLista de algoritmos\n\tLista de abreviaturas e siglas\n\tLista de s\u00edmbolos\n\tSum\u00e1rio\n\tIntrodu\u00e7\u00e3o\n\tMotiva\u00e7\u00e3o\n\tObjetivo Geral\n\tObjetivos Espec\u00edficos\n\tOrganiza\u00e7\u00e3o do Trabalho\n\n\tModelagem Matem\u00e1tica e Num\u00e9rica\n\tEscoamento Trif\u00e1sico\n\tDiscretiza\u00e7\u00e3o das Equa\u00e7\u00f5es\n\tDetermina\u00e7\u00e3o do Ponto de Bolha\n\n\tEscoamento Bif\u00e1sico\n\tDiscretiza\u00e7\u00e3o das Equa\u00e7\u00f5es\n\n\tEscoamento Monof\u00e1sico\n\n\tSolu\u00e7\u00e3o do Modelo Matem\u00e1tico\n\tUpscaling\n\tSolvers Lineares\n\tFatora\u00e7\u00e3o LU completa\n\tM\u00e9todo de Richardson\n\tM\u00e9todo do Res\u00edduo Generalizado M\u00ednimo\n\tM\u00e9todo do Gradiente Conjugado\n\n\tPr\u00e9-Condicionadores\n\tM\u00e9todo da Sobre-Relaxa\u00e7\u00e3o Sucessiva\n\tFatora\u00e7\u00e3o LU Incompleta\n\tConstrained Pressure Residual\n\tMultigrid Alg\u00e9brico\n\tDecomposi\u00e7\u00e3o de Dom\u00ednio\n\n\n\tM\u00e9todo dos Volumes Finitos Multiescala - MsFVM\n\tFun\u00e7\u00f5es Base Duais\n\tProblema na Malha Grossa\n\tReconstru\u00e7\u00e3o do Campo de Velocidade\n\tFun\u00e7\u00f5es de Corre\u00e7\u00e3o\n\tDesenvolvimentos Recentes\n\n\tPr\u00e9-condicionador Multiescala Alg\u00e9brico\n\tOperadores de Transfer\u00eancia\n\tProblema na Malha Grossa\n\tDefini\u00e7\u00e3o do Pr\u00e9-Condicionador\n\tReconstru\u00e7\u00e3o do Campo de Velocidades\n\n\tResultados\n\tCaso 1: monof\u00e1sico 2D\n\tSolu\u00e7\u00e3o aproximada\n\tM\u00e9todos diretos\n\tM\u00e9todos iterativos\n\n\tCaso 2: escoamento canalizado\n\tSolu\u00e7\u00e3o aproximada\n\tSolu\u00e7\u00e3o precisa\n\n\tCaso 3: bif\u00e1sico incompress\u00edvel 2D\n\tSolu\u00e7\u00e3o aproximada\n\tSolu\u00e7\u00e3o precisa\n\n\tCaso 4: teste comparativo SPE 9\n\n\tConclus\u00f5es\n\tSugest\u00f5es para trabalhos futuros\n\n\tRefer\u00eancias\n\tAp\u00eandices\n\tPar\u00e2metros do Modelo black-oil\n\tFase \u00c1gua\n\tFase \u00d3leo\n\tEstado subsaturado\n\tEstado saturado\n\n\tFase G\u00e1s\n\n\tPr\u00e9-Condicionador Multiescala Alg\u00e9brico 3D"}]}}}