{"add": {"doc": {"field": [{"@name": "docid", "#text": "BR-TU.22630"}, {"@name": "filename", "#text": "6643_Ribeiro_RubensFaustoJoseMesquitadaCunha_M.pdf"}, {"@name": "filetype", "#text": "PDF"}, {"@name": "text", "#text": "ESTE EXEMPLAR CORRESPONDE A REDA\u00c7\u00c3O FiNAL DA _\nTESE DEFENDIDA\t-r^U^ CO Vtgfc\nWWA R)K\u00a3\u00edRx?E APROVADA PELA\nCOMISS\u00c3O JULGADORA EM \u00ed../\n____ _ \u00edmJ ' c ^i^tador\nUNIVERSIDADE ESTADUAL DE CAMPINAS FACULDADE DE ENGENHARIA MEC\u00c2NICA\nDEPARTAMENTO DE ENGENHARIA DE PETR\u00d3LEO\nDisserta\u00e7\u00e3o Apresentada \u00e0\nFaculdade de Engenharia Mec\u00e2nica como Requisito Parcial para \u00e0 Obten\u00e7\u00e3o do T\u00edtulo de Mestre em Engenharia de Petr\u00f3leo\nC\u00e1lculo da Permeabilidade Equivalente em Meios Heterog\u00eaneos pelo M\u00e9todo dos Elementos Finitos H\u00edbridos\nAutor : Rubens Fausto Jos\u00e9 Mesquita da Cunha Ribeiro Orientador: R\u00e9gis Kruel Romeu\nCo-Orientador: Osvair Vidal Trevisan\nDezembro de 1996\nR3S4c\n29597/BC\n\nWTWA aHTML\n\nFICHA CATALOGR\u00c1FICA ELABORADA PELA BIBLIOTECA DA \u00c1REA DE ENGENHARIA - BAE - UNICAMP\nRibeiro, Rubens Fausto Jos\u00e9 Mesquita da Cunha R354c C\u00e1lculo da permeabilidade equivalente em meios heterog\u00eaneos pelo m\u00e9todo dos elementos finitos h\u00edbridos / Rubens Fausto Jos\u00e9 Mesquita da Cunha Ribeiro.\u2014 Campinas, SP: [s.n.], 1996.\nOrientador: R\u00e9gis Kruel Romeu.\nDisserta\u00e7\u00e3o (mestrado) - Universidade Estadual de\nCampinas, Faculdade de Engenharia Mec\u00e2nica.\n1. Petr\u00f3leo. 2. Reservat\u00f3rios. 3. An\u00e1lise num\u00e9rica. 4. Permeabilidade. 5. M\u00e9todo dos elementos finitos. I. Romeu, R\u00e9gis Kruel. II. Universidade Estadual de Campinas. Faculdade de Engenharia Mec\u00e2nica. III. T\u00edtulo.\nUNIVERSIDADE ESTADUAL DE CAMPINAS\nFACULDADE DE ENGENHARIA MEC\u00c2NICA DEPARTAMENTO DE ENGENHARIA DE PETR\u00d3LEO\nA disserta\u00e7\u00e3o \u201cC\u00e1lculo da Permeabilidade Equivalente em Meios Heterog\u00eaneos pelo M\u00e9todo dos Elementos Finitos H\u00edbridos\u201d, elaborada por Rubens Fausto Jos\u00e9 Mesquita da Cunha Ribeiro e aprovada por todos os membros da Banca Examinadora, foi aceita pela Subcomiss\u00e3o de P\u00f3s-Gradua\u00e7\u00e3o em Engenharia de Petr\u00f3leo como requisito parcial \u00e0 obten\u00e7\u00e3o do T\u00edtulo de Mestre em Engenharia de Petr\u00f3leo.\nCampinas, 09 de dezembro de 1996\nBanca Examindora:\nMart\u00edn Tygel, Ph.D.\nDaniel Nunes de Miranda Filho, Ph.D.\nPara Raisa, minha menina\nPara Cl\u00e1udia e Rodrigo\nAgradecimentos\nAo meu orientador, R\u00e9gis Kruel Romeu, pela proposi\u00e7\u00e3o do tema, pelo interesse, pelo incentivo, pelos ensinamentos e pela paci\u00eancia.\nAgrade\u00e7o ao co-orientador, professor Osvair Vidal Trevisan, pelo acompanhamento na realiza\u00e7\u00e3o do trabalho e pelo incentivo.\nAgrade\u00e7o ao professor Frederico Furtado pelas sugest\u00f5es e pela bibliografia fornecida na fase inicial do trabalho.\nAgrade\u00e7o \u00e0 quatro grandes mestres, que muito me orientaram na fase dos cr\u00e9ditos e na escolha do assunto dessa disserta\u00e7\u00e3o: C\u00e9sar Santana, Euclides Bonet, Martin Tygel e Philippe Devloo.\nAgrade\u00e7o \u00e0 um amigo muito especial, que tanto me ajudou durante esses dois anos: Ant\u00f4nio Alberto de Souza dos Santos.\nAgrade\u00e7o \u00e0 Petrobr\u00e1s, na figura de todos aqueles que trabalharam pela minha indica\u00e7\u00e3o, pela oportunidade.\nAgrade\u00e7o aos demais professores, colegas e funcion\u00e1rios da Unicamp (principalmente do CEPETRO, do DEP e do IMECC), pelos ensinamentos, pela conviv\u00eancia e pelo apoio.\nAgrade\u00e7o ao Centro Nacional de Processamento de Alto Desempenho em S\u00e3o Paulo, pela conta para utilizar seu ambiente computacional e pelos cursos fornecidos.\nPesquisa desenvolvida com o aux\u00edlio do CENAPAD-SP\nNomenclatura\nArgila\nCG\nCVFE\nDF\nDS-CG\n{e}\nEDP\nEF\nEFH, EFMH\nEFM\nekf(i,j)\ngdl\nIC-CG ou\nICCG\nICCG(O)\n[J]\nJ\nJCG\nFolhelho. Rocha sedimentar de granula\u00e7\u00e3o fina, argilosa, com baix\u00edssima permeabilidade.\nFam\u00edlia de m\u00e9todos para resolu\u00e7\u00e3o de sistemas de equa\u00e7\u00f5es lineares por gradientes conjugados.\nFormula\u00e7\u00e3o de elementos finitos tipo volume de controle M\u00e9todo (Esquema) de Diferen\u00e7as Finitas\nM\u00e9todo de gradiente conjugado pr\u00e9-condicionado por diagonal scaling, processo mais eficiente do que JCG.\nVetor com Todas as Componentes Unit\u00e1rias\nEqua\u00e7\u00e3o Diferencial Parcial\nElementos Finitos\nFormula\u00e7\u00e3o H\u00edbrida de Elementos Finitos, o mesmo que Elementos Finitos H\u00edbridos.\nFormula\u00e7\u00e3o Mista de Elementos Finitos, o mesmo que Elementos Finitos Mistos.\nElemento na linha i e na coluna j da matriz [EKF]\nGraus de liberdade (geralmente o n\u00famero de vari\u00e1veis) M\u00e9todo CG com pr\u00e9-condicionamento pela decomposi\u00e7\u00e3o de Cholesky incompleta da matriz quadrada do sistema linear.\nDecomposi\u00e7\u00e3o incompleta de Cholesky que n\u00e3o opera em nenhum dos elementos originalmente nulos da matriz quadrada do sistema linear (n\u00e3o h\u00e1 o chamado fill-in). E a decomposi\u00e7\u00e3o IC mais usualmente encontrada.\nMatriz Jacobiana\nJacobiano, valor absoluto do determinante da matriz Jacobiana M\u00e9todo CG de Jacobi: pr\u00e9-condicionamento mais simples que existe, multiplica\u00e7\u00e3o apenas pelo inverso do elemento da diagonal na mesma linha.\nK K,\tPermeabilidade, propriedade f\u00edsica Permeabilidade local de um dos N blocos da discretiza\u00e7\u00e3o\nk\tElemento mestre quadrado\nMEF\tQualquer um dos diversos m\u00e9todos baseados em elementos finitos.\nMP\tM\u00e9dia de Pot\u00eancia de expoente y : Itr n J\nn\tVetor normal a um lado (face) do elemento\nP\tPress\u00e3o\nPERMEQ\tSimulador DF de fluxo monof\u00e1sico e incompress\u00edvel em meios porosos, desenvolvido na PETROBRAS/CENPES.\nPVC\tProblema de Valor de Contorno\n\u00c3T0\tEspa\u00e7o de aproxima\u00e7\u00e3o (h\u00edbrido) de Raviart-Thomas de mais baixa ordem.\nS\tContorno do elemento\nSSOR-CG\tM\u00e9todo CG com pr\u00e9-condicionamento SSOR. Geralmente \u00e9 feita inicialmente a opera\u00e7\u00e3o de diagonal scaling (DS) para melhorar a converg\u00eancia.\nt\tElemento mestre triangular\nV\tDom\u00ednio do elemento\nV\tCampo de velocidades utilizado na Lei de Darcy\nX\tPosi\u00e7\u00e3o do um ponto no espa\u00e7o\nx,y,z\tCoordenadas de um ponto no espa\u00e7o\n\tFun\u00e7\u00e3o (polin\u00f3mio) vetorial\nw _w\tComponente x da fun\u00e7\u00e3o vetorial n\u00famero i\nWyJ\tComponente y da fun\u00e7\u00e3o vetorial n\u00famero j\n{}\tIdentificador de vetor\n[]\tIdentificador de matriz, ou tensor\n\tDesvio-padr\u00e3o do logaritmo neperiano do conjunto de valores locais de pemeabilidades.\n\tDelta de Kronecker\nAZ, A K, AZ\tDimens\u00f5es geom\u00e9tricas de um bloco (elemento) do dom\u00ednio\nn\tElemento Real (Deformado)\nQ\tElemento Mestre (de Refer\u00eancia)\nan\tContorno do Elemento Real (Deformado)\na\u00e2\tContorno do Elemento Mestre\nA /-Tiro/? A KSCAL-\u00ed/t V\tN\u00famero Real (Fator Escalar) Gradiente (Vetor), Operador Nabla\nV.\tDivergente, operador matem\u00e1tico\nResumo\nAs modernas t\u00e9cnicas de modelagem geol\u00f3gica e geoestat\u00edstica permitem a descri\u00e7\u00e3o das heterogeneidades dos reservat\u00f3rios de petr\u00f3leo em um n\u00edvel de detalhamento incompat\u00edvel com a capacidade de c\u00e1lculo dos programas de simula\u00e7\u00e3o num\u00e9rica de fluxo. Com isso, o processo de transfer\u00eancia de escala - ou seja, a determina\u00e7\u00e3o de propriedades efetivas ou equivalentes para uma malha mais grosseira, preservando o m\u00e1ximo de informa\u00e7\u00f5es da malha fina - tomou-se uma etapa cr\u00edtica dos estudos de reservat\u00f3rios.\nNesse trabalho, implementa-se uma formula\u00e7\u00e3o de elementos finitos h\u00edbridos (EFH) para o c\u00e1lculo da permeabilidade equivalente de meios porosos heterog\u00eaneos, a partir da simula\u00e7\u00e3o do campo de press\u00f5es e de velocidades do fluxo monof\u00e1sico e incompress\u00edvel em regime permanente. Utiliza-se o espa\u00e7o de aproxima\u00e7\u00e3o de Raviart-Thomas de mais baixa ordem. S\u00e3o explicados os detalhes da formula\u00e7\u00e3o para o tratamento de elementos deformados. Constru\u00edram-se dois programas: uma vers\u00e3o 2D, capaz de combinar elementos triangulares e retangulares; e uma vers\u00e3o 3D, para paralelep\u00edpedos regulares.\nEsses programas s\u00e3o aplicados a diversos casos de meios heterog\u00eaneos, comparando-se a precis\u00e3o dos resultados e o desempenho computacional com outros m\u00e9todos anal\u00edticos e num\u00e9ricos. Observa-se o efeito do refinamento da malha num\u00e9rica sobre a precis\u00e3o do resultado. Nessa compara\u00e7\u00e3o, verifica-se que o m\u00e9todo EFH \u00e9 superior tanto ao esquema de diferen\u00e7as finitas (5 pontos em 2D e 7 pontos em 3 D) como ao esquema de elementos finitos de Galerkin com fun\u00e7\u00f5es de forma lagrangeanas lineares, considerando que produz resultados mais precisos para o mesmo n\u00famero de inc\u00f3gnitas do sistema linear.\nPor fim, com base no padr\u00e3o de converg\u00eancia desses diferentes m\u00e9todos num\u00e9ricos, prop\u00f5e-se um novo estimador para o c\u00e1lculo da permeabilidade equivalente.\nPALAVRAS-CHAVE:\nReservat\u00f3rios de Petr\u00f3leo Meios Porosos Heterog\u00eaneos Permeabilidade Equivalente Propriedades Efetivas\nTransfer\u00eancia de Escala Elementos Finitos H\u00edbridos Espa\u00e7o de Raviart-Thomas Computa\u00e7\u00e3o Cient\u00edfica\nAbstract\nRecent and sophisticated geological and geostatistical modeling tools allow a very small scale petroleum reservoir heterogeneities description that cannot be directly used by numerical flow simulation codes due to restrictions imposed by the available computing power. Then, the upscaling process - i.e., the determination of effective or equivalent properties on a coarser grid, maintaining the integrity of the fine scale description - turned out a critical step for the reservoir studies.\nIn this study, we implement a hybrid finite element formulation (HFEM) to calculate the equivalent permeability of heterogeneous porous media subject to steady-state singlephase incompressible flow. The lowest order Raviart-Thomas approximation space is used. The details on how to apply deformed elements are explained. Two codes have been developed: a 2D version, capable of using triangular and rectangular elements; and a 3D option, for rectangular parallelepipeds.\nThese codes are applied to several heterogeneous media cases, and we compare the results precision and computational requirements against other numerical and analytical methods. We verify that the hybrid formulation is more accurate than both the 5/7-point finite difference schemes and the lowest order Galerkin finite element method, for the same number of unknowns.\nEventually, based on the convergence behavior of the different numerical schemes, we propose a new estimator for the determination of the equivalent permeability.\nKEY WORDS:\nPetroleum Reservoirs Heterogeneous Porous Media\nEquivalent Permeability\nEffective Properties\nUpscaling\n(Mixed-)Hybrid Finite Element Raviart-Thomas Space Scientific Computing\nIndice\nAgradecimentos..................................................        iv\nNomenclatura..................................................           v\nResumo ..........................\u2022............................        viii\nAbstract...................................................             ix\n\u00edndice.....................................................              x\nLista de Figuras ............................................         xiii\nLista de Gr\u00e1ficos........................................              xiv\nLista de Tabelas .........................................              xv\n1.\tIntrodu\u00e7\u00e3o .................................................          I\n2.\tC\u00e1lculo da Permeabilidade Equivalente: O Estado da Arte...........    3\n2.1 - Preliminares  ..................................................   3\n2.2\t- Conceitos de Equival\u00eancia ....................................     4\n2.3\t- Estimadores Anal\u00edticos........................................     6\n2.4\t- M\u00e9todos Num\u00e9ricos .............................................. 11\n2.5\t- Erros Num\u00e9ricos e Refinamento de Malha.........................   18\n3.\tM\u00e9todo dos Elementos Finitos H\u00edbridos ......................         20\n3.1\t- Vis\u00e3o Geral dos M\u00e9todos Mistos e H\u00edbridos....................     20\n3.2\t- Aplica\u00e7\u00e3o dos M\u00e9todos de Elementos Finitos ao Fluxo em Meios Porosos ..\t22\n3.3\t- Espa\u00e7os de Aproxima\u00e7\u00e3o............................................. 25\n3.3.1\t~ Espa\u00e7o de Raviart-Thomas....................................      25\n3.3.2\t- Elemento Mestre Triangular:\tFun\u00e7\u00f5es de Forma e Suas\tPropriedades.\t26\n3.3.3\t- Elemento Mestre Quadrado:\tFun\u00e7\u00f5es de Forma e Suas\tPropriedades.\t27\n3.3.4\t- A Transforma\u00e7\u00e3o de Piola......................................    28\n3.3.5\t- Outros Espa\u00e7os de Aproxima\u00e7\u00e3o..................................   30\n3.4\t- S\u00edntese da Formula\u00e7\u00e3o...........................................   30\n3.4.1\t- Comportamento do Material....................................     31\n3.4.2\t- Equa\u00e7\u00e3o de Equil\u00edbrio ou Lei de Conserva\u00e7\u00e3o...................... 32\n3.4.3\t- A Continuidade do Fluxo....................................       34\n3.5\t- Tratamento Tensorial.......................................        36\n4.\tOs Programas de Computador: Hybrid2D e Hybrid3D ....................   39\n4.1-0 Programa HYBRID2D............................................       39\n4.1.1\t- Estrutura Geral................................      ..........   39\n4.1.2\t- Dois Tipos de Elementos e Suas Deforma\u00e7\u00f5es ....................   40\n4.1.3\t- Regra de Integra\u00e7\u00e3o ....................................          42\n4.1.4\t- Valida\u00e7\u00e3o: Caso Anal\u00edtico com Diverg\u00eancia (f = -4).............   44\n4.2\t- O Programa HYBRID3D............................................     46\n4.2.1\t- Descri\u00e7\u00e3o Gerai e Fun\u00e7\u00f5es de Forma 3D...........................  46\n4.2.2\t- Valida\u00e7\u00e3o do Programa HYBRID3D...........................         48\n4.3\t- Os M\u00f3dulos Solver .....................................             49\n5.\tDiscuss\u00e3o dos Resultados.....................................          52\n5.1\t- Casos B\u00e1sicos: os Sete Exemplos de Cruz [1991]..................... 52\n5.2\t- O Tabuleiro de Xadrez ................................              57\n5.3\t- Reprodu\u00e7\u00e3o do Sistema Arenito-Argila de Durlofsky................   61\n5.4\t- Campos Lognormais.................................................  69\n5.4.1\t- Campos Lognormais 3D Isotr\u00f3picos sem Correla\u00e7\u00e3o Espacial......... 70\n5.4.2\t- Campos Lognormais e Anisotropia..............................     71\n5.4.3\t- Campos Lognormais e Correla\u00e7\u00e3o Espacial......................     76\n5.5\t- O Uso de Malhas Deformadas.................................       78\n5.6\t- Esfor\u00e7o Computacional......................................       81\n5.7\t- A M\u00e9dia Aritm\u00e9tica das Solu\u00e7\u00f5es EF e DF........................   83\n5.8\t- Rela\u00e7\u00f5es Entre os Esquemas EFH e DF...........................    84\n6.\tConclus\u00f5es e Recomenda\u00e7\u00f5es ...........  ........................     86\nRefer\u00eancias Bibliogr\u00e1ficas....................................          88\nLista de Figuras\nFigura 2.1 - Malha Regular e as Condi\u00e7\u00f5es de Contorno Usuais no Dom\u00ednio\nRetangular....................................................        6\nFigura 2.2 - Exemplo Num\u00e9rico do C\u00e1lculo dos Limitantes de Le Loc\u2019h............... 9\nFigura 3.1 - Espa\u00e7o de Aproxima\u00e7\u00e3o do Fluxo no Elemento Mestre Triangular ...\t26\nFigura 3.2- Elemento Mestre Quadrado.........................................  27\nReprodu\u00e7\u00e3o 1 - Trecho do Afloramento A\u00e7u Destacando as Varia\u00e7\u00f5es de\nPermeabilidade Interpoladas a Partir de Medidas de Miniperme\u00e2metro  41 Figura 4.1- Caracter\u00edsticas Gerais do Exemplo Anal\u00edtico e com Diverg\u00eancia  45 Configura\u00e7\u00e3o 1 - Sistema em S\u00e9rie..............................................   53\nConfigura\u00e7\u00e3o 2 - Sistema em Paralelo...........................................   54\nConfigura\u00e7\u00e3o 3 - Sistema em S\u00e9rie com Barreira Imperme\u00e1vel.....................   54\nConfigura\u00e7\u00e3o 4 - Sistema em Paralelo com Barreira Imperme\u00e1vel.................... 55\nConfigura\u00e7\u00e3o 5 - Distribui\u00e7\u00e3o Alternada......................................     55\nConfigura\u00e7\u00e3o 6 - Distribui\u00e7\u00e3o Alternada com um Zero..........................     56\nConfigura\u00e7\u00e3o 7 - Estrangulamento na-Dire\u00e7\u00e3o do Fluxo............................  56\nFigura 5.1 - Idealiza\u00e7\u00e3o de Reservat\u00f3rios no Formato Tabuleiro..................  60\nReprodu\u00e7\u00e3o 2 - Sistema Arenito-Argila de Durlofsky ............................................\t62\nReprodu\u00e7\u00e3o 3 - Linhas de Fluxo da Solu\u00e7\u00e3o CVFE para 3721 Vari\u00e1veis .............. 68\nFigura 5.2 - Discretiza\u00e7\u00e3o Sim\u00e9trica em Rela\u00e7\u00e3o \u00e0 Diagonal....................... 79\nFigura 5.3 - Discretiza\u00e7\u00e3o Mais Irregular do Dom\u00ednio    ....................... 79\nLista de Gr\u00e1ficos\nGr\u00e1fico 5.1 - An\u00e1lise da Configura\u00e7\u00e3o 5...........................    58\nGr\u00e1fico 5.2 - A M\u00e9dia Aritm\u00e9tica Entre EF e DF Pode Ser um Bom Estimador,\nEm Casos Mais Homog\u00e9neos.............................     59\nGr\u00e1fico 5.3 - Simula\u00e7\u00f5es do Sistema de Durlofsky com Quadrados....... 64\nGr\u00e1fico 5.4-0 Esfor\u00e7o Computacional Est\u00e1 Mais Relacionado com o\nN\u00famero de Vari\u00e1veis...................................    65\nGr\u00e1fico 5.5 - A Diminui\u00e7\u00e3o do Erro com o Refinamento................  66\nGr\u00e1fico 5.6\t- Campo Lognormal 23x23x23, com Desvio-Padr\u00e3o\t0.81322.... 72\nGr\u00e1fico 5.7\t- Campo Lognormal 17x17x17, com Desvio-Padr\u00e3o\t0.9685 .... 72\nGr\u00e1fico 5.8\t- Campo Lognormal 10x10x10, com Desvio-Padr\u00e3o\t1.5091 ...  73\nGr\u00e1fico 5.9\t- Campo Lognormal 14x14x14, com Desvio-Padr\u00e3o\t3.1785 .... 73\nGr\u00e1fico 5.10 - Campo Lognormal 100x100, com Correla\u00e7\u00e3o Esf\u00e9rica de 10\nBlocos e Desvio-Padr\u00e3o 1.0227........................     77\nGr\u00e1fico 5.11 - Campo Lognormal 100x100, com Correla\u00e7\u00e3o Esf\u00e9rica de 20\nBlocos e Desvio-Padr\u00e3o 1.0229 ........................   77\nLista de Tabelas\nTabela 5.1 - A M\u00e9dia Aritm\u00e9tica Entre Simula\u00e7\u00f5es EF e DF Pode Ser Um Bom\nEstimador...............................................    57\nTabela 5,2 - Refinamento do Arenito-Argila de Durlofsky Convergindo para\n0.5205 ..........................................           67\nTabela 5.3 - Compara\u00e7\u00e3o de Simula\u00e7\u00f5es em Campos Lognormais Sint\u00e9ticos....\t71\nTabela 5.4 - Caracter\u00edsticas do Caso Base (Campo Lognormal).........   75\nTabela 5.5 - Efeito da Anisotropia, Obtida Pela Varia\u00e7\u00e3o das Dimens\u00f5es\nGeom\u00e9tricas, na Permeabilidade Equivalente do Caso Base ..  75\nTabela 5.6 - An\u00e1lise dos Resultados das Simula\u00e7\u00f5es nas Malhas Deformadas.\t80\nCap\u00edtulo 1 - Introdu\u00e7\u00e3o\nAs modernas t\u00e9cnicas de modelagem geol\u00f3gica e geoestat\u00edstica permitem a descri\u00e7\u00e3o das heterogeneidades dos reservat\u00f3rios de petr\u00f3leo em um n\u00edvel de detalhamento incompat\u00edvel com a capacidade de c\u00e1lculo dos programas de simula\u00e7\u00e3o num\u00e9rica de fluxo. Com isso, o processo de transfer\u00eancia de escala - ou seja, a determina\u00e7\u00e3o de propriedades efetivas ou equivalentes para uma malha mais grosseira, preservando o m\u00e1ximo de informa\u00e7\u00f5es da malha fina - tornou-se uma etapa cr\u00edtica dos eestudos de reservat\u00f3rios.\nDentre as propriedades petrof\u00edsicas mais importantes para o escoamento nos meios porosos, a permeabilidade \u00e9 aquela que r\u00e8quer mais aten\u00e7\u00e3o no processo de transfer\u00eancia de escala. Enquanto porosidade e satura\u00e7\u00f5es efetivas s\u00e3o simples m\u00e9dias ponderadas por volumes, o c\u00e1lculo da permeabilidade equivalente necessita, normalmente, de procedimentos mais sofisticados.\nApesar de toda a pesquisa que j\u00e1 foi efetuada, uma metodologia sistem\u00e1tica ainda n\u00e3o foi desenvolvida, nem conclus\u00f5es amplamente aceitas foram apresentadas. Assim, continua havendo espa\u00e7o para novos estudos, principalmente para a representa\u00e7\u00e3o e solu\u00e7\u00e3o de sistemas com elevados contrastes intemos de permeabilidade, como sistemas arenito-argila e outros casos razoavelmente comuns na pr\u00e1tica, onde os m\u00e9todos mais simplificados fracassam. Observa-se, por exemplo, que os programas de diferen\u00e7as finitas produzem resultados sistematicamente enviesados (imprecisos), quando n\u00e3o \u00e9 utilizada uma adequada discretiza\u00e7\u00e3o espacial do dom\u00ednio de interesse.\nO ponto de partida desse trabalho foi a utiliza\u00e7\u00e3o de m\u00e9todos num\u00e9ricos para c\u00e1lculo da permeabilidade equivalente. O objetivo principal da tese foi implementar e avaliar uma formula\u00e7\u00e3o h\u00edbrida de elementos finitos para o escoamento monof\u00e1sico incompress\u00edvel em regime permanente. Trata-se de uma t\u00e9cnica relativamente nova nas aplica\u00e7\u00f5es de simula\u00e7\u00e3o de fluxo, que apresenta a vantagem de uma melhor representa\u00e7\u00e3o do campo de velocidades, essencial para o c\u00e1lculo preciso da permeabilidade equivalente de meios heterog\u00eaneos. Foram tamb\u00e9m testadas algumas subrotinas da biblioteca HOMLIB, do projeto multicliente PROFIT, para, ent\u00e3o, comparar os resultados de diferentes m\u00e9todos entre si e com algumas das f\u00f3rmulas anal\u00edticas mais freq\u00fcentemente usadas nos problemas de mudan\u00e7a de escala.\nEm muitos aspectos, a transfer\u00eancia de escala e a simula\u00e7\u00e3o de reservat\u00f3rios s\u00e3o mais arte do que ci\u00eancia. Muitas das conclus\u00f5es obtidas possuem um car\u00e1ter experimental, surgindo da observa\u00e7\u00e3o cr\u00edtica dos resultados. Uma prova formal ficou para mais tarde.\nEsse trabalho n\u00e3o pretende ser um texto exaustivo sobre m\u00e9todos de transfer\u00eancia de escala. S\u00e3o revistos os conceitos b\u00e1sicos necess\u00e1rios para a compreens\u00e3o do que foi simulado, sem necessariamente detalhar ou aprofundar todas as quest\u00f5es.\nUma grande parte do tempo na elabora\u00e7\u00e3o da disserta\u00e7\u00e3o foi dedicado \u00e0 correta implementa\u00e7\u00e3o dos c\u00f3digos de computador, estudando os comandos de alguns diferentes sistemas operacionais baseados em UNIX, navegando em esta\u00e7\u00f5es de trabalho. Outra parte extensa foi usada na an\u00e1lise e desenvolvimento de formula\u00e7\u00f5es variacionais para as equa\u00e7\u00f5es diferenciais parciais em quest\u00e3o.\nNo Cap\u00edtulo 2, situa-se o problema de mudan\u00e7a de escala na \u00e1rea de simula\u00e7\u00e3o de reservat\u00f3rios. Apresentam-se as ferramentas mais aplicadas, incluindo um curto hist\u00f3rico do crescimento do uso dos m\u00e9todos num\u00e9ricos, especialmente DF.\nNo Cap\u00edtulo 3, s\u00e3o introduzidos os m\u00e9todos vetoriais de elementos finitos (EFM e EFH), \u00e9 feita uma revis\u00e3o espec\u00edfica da literatura e, em seguida, \u00e9 feito o desenvolvimento matem\u00e1tico da formula\u00e7\u00e3o h\u00edbrida para o c\u00e1lculo da permeabilidade equivalente, em uma nota\u00e7\u00e3o matricial (mais geral e mais pr\u00f3xima do que \u00e9 implementado em um programa).\nNo Cap\u00edtulo 4, s\u00e3o mostradas as caracter\u00edsticas gerais dos dois programas desenvolvidos. O primeiro \u00e9 HYBRID2D, vers\u00e3o 2D que pode trabalhar com tri\u00e2ngulos e ret\u00e2ngulos, malha deformada e qualquer conjunto de condi\u00e7\u00f5es de contorno, a partir da entrada manual de dados. O segundo \u00e9 HYBRID3D, para malha estruturada, condi\u00e7\u00f5es de contomo usuais e de execu\u00e7\u00e3o mais r\u00e1pida, principalmente, por n\u00e3o efetuar integra\u00e7\u00e3o num\u00e9rica.\nNo Cap\u00edtulo 5, s\u00e3o discutidos os resultados das simula\u00e7\u00f5es em diversos tipos de meios heterog\u00eaneos. Compara-se o desempenho, em termos de precis\u00e3o e de esfor\u00e7o computacional, dos novos programas, constru\u00eddos segundo o esquema EFH, com programas constru\u00eddos segundo os esquemas mais tradicionais de diferen\u00e7as finitas e de elementos finitos. S\u00e3o obtidas conclus\u00f5es importantes, por exemplo, indicando um novo estimador combinando o resultado de simula\u00e7\u00f5es EF e DF.\nNo Cap\u00edtulo 6, resumem-se os pontos mais importantes desse estudo e sugerem-se algumas possibilidades para estender esse trabalho.\nCap\u00edtulo 2 - C\u00e1lculo da Permeabilidade\nEquivalente: O Estado da Arte\n2.1\t- Preliminares\nA explota\u00e7\u00e3o economicamente racional dos reservat\u00f3rios de petr\u00f3leo, desde as fases que antecedem a produ\u00e7\u00e3o at\u00e9 a decis\u00e3o de seu abandono definitivo, necessita da previs\u00e3o do comportamento do escoamento no meio poroso. Para isso, existe a simula\u00e7\u00e3o de reservat\u00f3rios, atividade tecnol\u00f3gica cada vez mais valorizada na ind\u00fastria do petr\u00f3leo.\nO aperfei\u00e7oamento da simula\u00e7\u00e3o de reservat\u00f3rios requer o cont\u00ednuo desenvolvimento dda modelagem geol\u00f3gica; de an\u00e1lises de rochas e fluidos; de ferramentas matem\u00e1ticas e de recursos computacionais. Ferramentas matem\u00e1ticas abrangem os modelos de representa\u00e7\u00e3o do fen\u00f4meno f\u00edsico e os m\u00e9todos num\u00e9ricos para resolver eficientemente esses modelos.\nA mudan\u00e7a de escala \u00e9 uma etapa preliminar \u00e0 simula\u00e7\u00e3o de reservat\u00f3rios. Os dados de reservat\u00f3rios, como porosidades, permeabilidades e outros, s\u00e3o adquiridos em diversas escalas, e \u00e9 preciso transferi-los para a escala em que ser\u00e1 feita a simula\u00e7\u00e3o de fluxo. Os modernos m\u00e9todos de caracteriza\u00e7\u00e3o geol\u00f3gica e geoestat\u00edstica de reservat\u00f3rios produzem representa\u00e7\u00f5es tridimensionais das propriedades da rocha em uma escala relativamente fina, com malhas que podem conter milh\u00f5es de blocos. A simula\u00e7\u00e3o do fluxo n\u00e3o pode ser feita em uma escala t\u00e3o fina por limita\u00e7\u00f5es computacionais e tamb\u00e9m por raz\u00f5es pr\u00e1ticas. As malhas de simula\u00e7\u00e3o de fluxo dificilmente ultrapassam centenas de milhares de blocos nos dias de hoje.\nO processo de mudan\u00e7a de escala implica no c\u00e1lculo de propriedades equivalentes, de uma malha fina para outra mais grosseira. Para propriedades n\u00e3o aditivas, como \u00e9 o caso da permeabilidade, esse processo n\u00e3o \u00e9 trivial. Na verdade, da mesma forma que a simula\u00e7\u00e3o de fluxo, a mudan\u00e7a de escala da permeabilidade est\u00e1 associada \u00e0 resolu\u00e7\u00e3o de equa\u00e7\u00f5es diferenciais parciais.\nPara o c\u00e1lculo da permeabilidade equivalente, t\u00eam sido aplicadas as mais diferentes t\u00e9cnicas, com variados graus de sofistica\u00e7\u00e3o:\n\u2022\tm\u00e9dias simples;\n\u2022\tlimitantes e estimadores;\n\u2022\tsolu\u00e7\u00f5es anal\u00edticas para casos especiais;\n\u2022\tm\u00e9todos num\u00e9ricos ( DF, EF, EFM, EFH, expans\u00e3o espectral, transformada\nwavelet...);\n\u2022\tt\u00e9cnicas de perturba\u00e7\u00e3o;\n\u2022\tm\u00e9todos para trabalhar com a mudan\u00e7a de escala em tensores;\n\u2022\tdiferentes formas de renormaliza\u00e7\u00e3o;\n\u2022\tsimula\u00e7\u00e3o estoc\u00e1stica, condicional e n\u00e3o condicional;\n\u2022\tgeoestat\u00edstica;\n\u2022\tcaminho aleatorio (random walk);\n\u2022\tteoria da percola\u00e7\u00e3o;\n\u2022\tan\u00e1lise de Fourier;\n\u2022\tfractais.\nAlgumas t\u00e9cnicas podem ser utilizadas em conjunto com outras. Antes de passar em revista alguns desses m\u00e9todos, ser\u00e1 discutida a pr\u00f3pria no\u00e7\u00e3o de equival\u00eancia entre um meio homog\u00e9neo e um meio heterog\u00e9neo.\n2.2\t- Conceitos de Equivalencia\nO conceito de permeabilidade equivalente compreende a substitui\u00e7\u00e3o de um meio heterog\u00e9neo, onde a permeabilidade varia no espa\u00e7o, por um meio homog\u00e9neo, onde a permeabilidade \u00e9 uniforme, de tal modo que a substitui\u00e7\u00e3o seja equivalente para certas finalidades e/ou para certas situa\u00e7\u00f5es. Em geral, quando se substituem diversos valores por um \u00fanico, h\u00e1 uma perda de informa\u00e7\u00e3o, e a equival\u00eancia n\u00e3o pode ser absoluta. \u00c9 preciso definir crit\u00e9rios e situa\u00e7\u00f5es de equival\u00eancia.\nO crit\u00e9rio mais tradicional para a equival\u00eancia \u00e9 o de igualdade de fluxo. Segundo esse crit\u00e9rio, dois sistemas s\u00e3o equivalentes se produzem a mesma vaz\u00e3o total quando submetidos \u00e0s mesmas condi\u00e7\u00f5es de contorno. Determinar a permeabilidade do meio homog\u00eaneo\nequivalente \u00e9, ent\u00e3o, determinar o fluxo total que atravessa o sistema heterog\u00eaneo, sob certas condi\u00e7\u00f5es de contorno, e adimensionalizar esse valor pela geometria e diferencial de press\u00e3o aplicado.\nUm crit\u00e9rio mais moderno e mais geral \u00e9 o da dissipa\u00e7\u00e3o da energia pelo escoamento ao longo do meio poroso: de acordo com esse crit\u00e9rio, dois sistemas s\u00e3o equivalentes se o trabalho realizado pelas for\u00e7as viscosas for o mesmo, para as mesmas condi\u00e7\u00f5es de contorno. A express\u00e3o para essa perda de energia pode ser encontrada em Romeu [1994, p, 45]:\nFF=-\u00a3v.VP</r ,\t(2.1)\nonde v \u00e9 o vetor velocidade da lei de Darcy e VP \u00e9 o gradiente de press\u00e3o. Pode-se verificar que, para as condi\u00e7\u00f5es de contorno usuais, do tipo imperme\u00e1vel, os dois crit\u00e9rios s\u00e3o equivalentes. Sejam, de fato, as seguintes condi\u00e7\u00f5es de contorno aplicadas a um dom\u00ednio retangular, conforme a Figura 2.1:\n\u2022\tv ,n = 0 , ao longo de duas faces paralelas (fronteiras imperme\u00e1veis);\n\u2022\tP = 1 , na face de entrada do fluxo;\n\u2022\tP = 0 , na face de sa\u00edda do fluxo.\nAplicando, em (2.1), o teorema da diverg\u00eancia de Gauss e a conserva\u00e7\u00e3o do fluxo (V. v = 0 ), chega-se a uma forma alternativa\nW=\\s=ay PV-\u201ddS\t(2-2)\na partir da qual se pode verificar facilmente que, nesse caso, os dois crit\u00e9rios s\u00e3o equivalentes. De fato, aplicando as condi\u00e7\u00f5es de contorno definidas, chega-se a:\nPv.ndS=\u00ed v.ndS-[ v.ndS\n\u00bfENTRADA\t\u00bfSAIDA\n(2.3)\nonde a \u00faltima igualdade \u00e9 novamente devida \u00e0 conserva\u00e7\u00e3o do fluxo e ao teorema de Gauss.\nI\nV .M = 0\nFigura 2.1 - Malha Regular e as Condi\u00e7\u00f5es de Contorno Usuais no Dom\u00ednio Retangular\nAl\u00e9m das condi\u00e7\u00f5es de contomo tipo imperme\u00e1veis, que reproduzem as experi\u00eancias t\u00edpicas de laborat\u00f3rio, outros tipos de condi\u00e7\u00f5es de contorno t\u00eam sido propostos, com o objetivo de serem mais representativas da geometria do fluxo no sistema global (Durlofsky [1991], Romeu [1994]). Em geral, a permeabilidade equivalente ser\u00e1 diferente, conforme o crit\u00e9rio de c\u00e1lculo e as condi\u00e7\u00f5es de contorno adotadas.\n2.3\t\u00bb Estimadores Anal\u00edticos\nA id\u00e9ia de aplicar m\u00e9dias simples para determinar a permeabilidade equivalente \u00e9 bastante antiga, remonta \u00e0 \u00e9poca em que os recursos para fazer contas eram a r\u00e9gua de c\u00e1lculo e os \u00e1bacos. Ainda hoje, essas f\u00f3rmulas s\u00e3o utilizadas, seja porque produzem a resposta exata em alguns poucos casos especiais, seja porque produzem aproxima\u00e7\u00f5es aceit\u00e1veis em uma variedade maior de casos, seja porque, simplesmente, s\u00e3o f\u00e1ceis de calcular.\nNesse contexto, as formulas mais conhecidas s\u00e3o as m\u00e9dias Aritm\u00e9tica, Harm\u00f4nica e Geom\u00e9trica. Elas s\u00e3o casos particulares da m\u00e9dia de Pot\u00eancia, vide Nomenclatura, com expoentes +1, -1 e 0 (no limite), respectivamente. Seus resultados s\u00e3o exatos para sistemas em paralelo, em s\u00e9rie e para distribui\u00e7\u00f5es lognormais isotr\u00f3picas em 2D, respectivamente. Outra m\u00e9dia de Pot\u00eancia \u00fatil \u00e9 a que usa expoente 1/3, para a caracteriza\u00e7\u00e3o de meios com distribui\u00e7\u00e3o lognormal isotr\u00f3pica em 3D. Enquanto que os resultados para os sistemas em s\u00e9rie e em paralelo s\u00e3o triviais, os resultados para meios lognormais em 2D e 3D merecem uma discuss\u00e3o adicional.\nLognormal \u00e9 uma distribui\u00e7\u00e3o tal que seu logaritmo (neperiano) \u00e9 uma distribui\u00e7\u00e3o normal. Descreve-se a seguir como distribui\u00e7\u00f5es lognormais s\u00e3o geradas para as experi\u00eancias num\u00e9ricas dessa tese.\nPara obter-se uma distribui\u00e7\u00e3o lognormal, gera-se uma distribui\u00e7\u00e3o normal e procede-se a exponencia\u00e7ao dos eventos. A produ\u00e7\u00e3o de uma distribui\u00e7\u00e3o normal, por sua vez, \u00e9 feita a partir da cria\u00e7\u00e3o de uma distribui\u00e7\u00e3o uniformemente distribu\u00edda. O costume \u00e9 dar origem a uma distribui\u00e7\u00e3o normal de m\u00e9dia zero e vari\u00e2ncia unit\u00e1ria, chamada a seguir simplesmente de X que pode ser facilmente transformada em uma distribui\u00e7\u00e3o com m\u00e9dia e vari\u00e2ncia desejadas, a distribui\u00e7\u00e3o Fda Equa\u00e7\u00e3o (2.5).\nA' = n(0;1)\nSejam\n(2.4)\nY = aX + b\nH\u00e1 um teorema da estat\u00edstica (Box e outros [1978]) que mostra que\nY = N(b;a2)\t(2.5)\nNessa tese, a distribui\u00e7\u00e3o uniformemente distribu\u00edda ser\u00e1 criada pela FUNCTION RANl(IDUM), e a transforma\u00e7\u00e3o para n(0;1) feita pela FUNCTION GASDEV(IDUM), ambas do conhecido manual Numerical Recipes (PRESS e outros [1992]).\nPara uma orienta\u00e7\u00e3o qualitativa, uma poss\u00edvel classifica\u00e7\u00e3o do grau de heterogeneidade do reservat\u00f3rio pode ser dada a partir da vari\u00e2ncia (o quadrado do desvio-padr\u00e3o) do logaritmo\ndas permeabilidades (1\u00fc(K)):\n\u2022\ta in(K)= 0 meio homog\u00eaneo;\n\u2022\ta 0.5 -\u2022> meio levemente heterog\u00eaneo;\n\u2022\t0.5 &lt;cr ^n(K) &lt;1.0 \u2014> meio medianamente heterog\u00eaneo;\n\u2022\t1.0 &lt;o\t&lt;3.0 meio muito heterog\u00eaneo;\n\u2022\ta m^)>\t\u2014> meio muit\u00edssimo heterog\u00eaneo.\nComo j\u00e1 foi antecipado, a permeabilidade equivalente de um meio lognormal 2D isotr\u00f3pico e infinito \u00e9 igual \u00e0 M\u00e9dia Geom\u00e9trica. Este \u00e9 um resultado anal\u00edtico exato, provado por Matheron [1967].\nPara um meio lognormal isotr\u00f3pico 3D, a M\u00e9dia de Pot\u00eancia 1/3 \u00e9 uma aproxima\u00e7\u00e3o de primeira ordem para meios suficientemente grandes e de vari\u00e2ncia pequena. Uma forma equivalente dessa aproxima\u00e7\u00e3o 3D de primeira ordem \u00e9 a M\u00e9dia Geom\u00e9trica multiplicada pela exponencial de um sexto da vari\u00e2ncia logar\u00edtmica,\nCTSi(K)\n^Equivalente \u201c ^GEOM\n(2-6)\nA M\u00e9dia de Pot\u00eancia 1/3 \u00e9 um valor sempre maior do que o valor da M\u00e9dia Geom\u00e9trica e \u00e9 normal que, dada uma mesma distribui\u00e7\u00e3o estat\u00edstica dos valores, a permeabilidade equivalente em 3D seja maior do que em 2D (Matheron [1967]).\nUm outro tipo de f\u00f3rmula para c\u00e1lculo da permeabilidade equivalente \u00e9 constru\u00eddo a partir da combina\u00e7\u00e3o de m\u00e9dias Aritm\u00e9tica-Harm\u00f3nica e Harm\u00f4nica-Aritm\u00e9tica, em diferentes dire\u00e7\u00f5es. Essas m\u00e9dias combinadas constituem, como ser\u00e1 visto a seguir, limitantes te\u00f3ricos para o valor da permeabilidade equivalente.\nCardwell e Parsons [1945] foram possivelmente os primeiros a mostrar que, para o fluxo numa dada dire\u00e7\u00e3o:\n(2.7)\nonde:\nKEq : permeabilidade equivalente na dire\u00e7\u00e3o dada;\nKHARM : m\u00e9dia harm\u00f4nica das permeabilidades locais;\nKAR}T : m\u00e9dia aritm\u00e9tica das permeabilidades locais;\nK2 : valor calculado tomando-se, em uma primeira etapa, para cada se\u00e7\u00e3o transversal ao fluxo a m\u00e9dia aritm\u00e9tica das permeabilidades dos blocos, e, em uma segunda etapa, fazendo a m\u00e9dia harm\u00f4nica das m\u00e9dias aritm\u00e9ticas;\n\u00c1?| : valor calculado fazendo-se agora, na primeira etapa, a m\u00e9dia harm\u00f4nica dos valores de permeabilidade em cada canal paralelo \u00e0 dire\u00e7\u00e3o de fluxo, e, na segunda etapa, calculando a m\u00e9dia aritm\u00e9tica das m\u00e9dias harm\u00f4nicas dos canais.\nOs limitantes e K2 s\u00e3o chamados limitantes de Cardwell e Parsons, limitantes de Le Loc\u2019h, ou, simplesmente, m\u00e9dias Aritm\u00e9tica-Harm\u00f3nica e Harm\u00f3nica-Aritm\u00e9tica. O c\u00e1lculo desses limitantes \u00e9 ilustrado na Figura 2.2 e mais detalhes podem ser encontrados em Cruz [1991] ou em Galli e outros [1996].\nM. Harm\u00f4nica\n100\t60\t130\t200\t150\nM\u00e9dias Aritm\u00e9ticas c\t\tlas Se\u00e7\u00f5es 1\t\"fansversais ao Fluxo\t\n==>\t108.64\n> Fluxo na dire\u00e7\u00e3o X\n200\t50\t100\t200\t200\n0\t0\t200\t200\t200\n100\t200\t50\t200\t100\n100\t0\t200\t200\t200\n100\t50\t100\t200\t50\nM. Harm\u00f4nica\nM. Aritm\u00e9tica-Harm\u00f3nica - M. Aritm\u00e9tica} 111.11; 0; 100.00; 0; 76.92} =\t57.61\nFigura 2.2 - Exemplo Num\u00e9rico do C\u00e1lculo dos Limitantes de Le Loc\u2019h\nLimitante Superior - M\u00e9dia Harm\u00f4nica-Aritm\u00e9tica = K2 = 108.64\nLimitante Inferior = M\u00e9dia Aritm\u00e9tica-Harm\u00f3nica =\t= 57.61\nEstimador de Le Loc\u2019h/Gu\u00e9rillot = M\u00e9dia Geom\u00e9trica { 57.61; 108.64} = 79.11\nValor de Refer\u00eancia para a Permeabilidade Equivalente (Mais Preciso) =87.53\nO artigo de Cardwell e Parsons [1945] \u00e9 muito interessante, principalmente pelo seu valor hist\u00f3rico. Sua contribui\u00e7\u00e3o para a \u00e9poca foi provar que n\u00e3o existe disposi\u00e7\u00e3o geom\u00e9trica das heterogeneidades capaz de criar um fluxo obl\u00edquo que leve a um valor de permeabilidade equivalente maior do que a m\u00e9dia aritm\u00e9tica (ponderada pelos volumes). A cren\u00e7a na possibilidade de cria\u00e7\u00e3o desse fluxo obl\u00edquo n\u00e3o era incomum naquele tempo. \u00c9 interessante reparar que os autores adotam as m\u00e9dias harm\u00f4nica e aritm\u00e9tica como limitantes preferenciais, trabalhando com elas ao longo do texto e referindo-se a elas nas conclus\u00f5es do artigo. Por\u00e9m, em seu \u201cAp\u00eandice Matem\u00e1tico\u201d, com base na analogia com circuitos el\u00e9tricos, os autores chegaram realmente aos limitantes te\u00f3ricos mais estritos, e K2 , que seriam demonstrados muitos anos mais tarde na tese de doutorado de Le Loc\u2019h [1987], Se eles n\u00e3o fizeram maior uso da desigualdade mais forte, foi, seguramente, pela falta de recursos computacionais. E surpreendente que s\u00f3 muito tempo depois \u00e9 que esses limitantes tenham ressurgido, dessa vez com base em princ\u00edpios variacionais.\nA partir desses limitantes, t\u00eam sido propostos diferentes estimadores. Le Loc\u2019h [1989] e, mais tarde, Gu\u00e9rillot (ver Romeu [1994]) prop\u00f5em que a permeabilidade equivalente seja estimada pela m\u00e9dia geom\u00e9trica entre Kx e K2 . Lemouzy prop\u00f5e uma generaliza\u00e7\u00e3o desse estimador, que leva em conta mais termos para o caso 3D (ver Romeu [1994]).\nO estimador de Le Loc\u2019h/Gu\u00e9rillot apresenta, no caso da Figura 2.2, um desvio de 10% em rela\u00e7\u00e3o ao valor mais exato para a permeabilidade equivalente, n\u00e3o sendo poss\u00edvel diminuir esse erro. Um exemplo onde esse estimador fracassa \u00e9 constitu\u00eddo pelos sistemas arenito-argila possuindo pelo menos uma argila em cada canal paralelo \u00e0 dire\u00e7\u00e3o de fluxo, mas de tal forma que permita fluxo. Todas as m\u00e9dias harm\u00f4nicas s\u00e3o nulas, e consequentemente o limitante inferior \u00e9 zero, e igualmente zero o estimador. Mas a permeabilidade equivalente correta pode ser bem pr\u00f3xima da M\u00e9dia Aritm\u00e9tica, a depender da fra\u00e7\u00e3o total de argila. Isso ser\u00e1 visto no exemplo do Sistema Arenito-Argila de Durlofsky, no Cap\u00edtulo 5. Esse \u00e9 um contra-exemplo para a afirma\u00e7\u00e3o sobre a habilidade desse estimador em lidar com zeros, feita em Cruz [1991, p.59].\n2.4\t- M\u00e9todos Num\u00e9ricos\nOs m\u00e9todos num\u00e9ricos ocupam um lugar importante entre os m\u00e9todos de c\u00e1lculo da permeabilidade equivalente. Sua aplicabilidade \u00e9 muito mais geral do que as f\u00f3rmulas alg\u00e9bricas, que s\u00f3 d\u00e3o bons resultados em casos particulares. Um bom m\u00e9todo num\u00e9rico para a mudan\u00e7a de escala tamb\u00e9m dever\u00e1 ser um bom m\u00e9todo para a pr\u00f3pria simula\u00e7\u00e3o de fluxo, e vice-versa, pois as equa\u00e7\u00f5es modelando os dois fen\u00f4menos s\u00e3o, em ess\u00eancia, as mesmas.\nO princ\u00edpio geral desses m\u00e9todos, aplicados ao c\u00e1lculo da permeabilidade equivalente, consiste na solu\u00e7\u00e3o num\u00e9rica do campo de press\u00f5es (P) e velocidades (v) no meio heterog\u00eaneo. Para fluxo incompress\u00edvel, em regime permanente, isso corresponde a resolver a equa\u00e7\u00e3o da continuidade e a lei de Darcy, no volume em considera\u00e7\u00e3o:\nV.v = 0\t(2.8)\nv--KVP\t(2.9)\n(onde a viscosidade foi tomada como unit\u00e1ria) sob as condi\u00e7\u00f5es de contomo estipuladas. A partir da\u00ed, calcula-se o fluxo (as duas integrais mais a direita da Equa\u00e7\u00e3o (2.3)) ou a energia total no meio heterog\u00eaneo (Equa\u00e7\u00f5es (2.1) e (2.2)), e, por simples identifica\u00e7\u00e3o, a permeabilidade do meio homog\u00eaneo equivalente.\nS\u00e3o diversos os m\u00e9todos num\u00e9ricos aplic\u00e1veis ao problema geral de mudan\u00e7a de escala. Neste estudo ser\u00e3o considerados tr\u00eas m\u00e9todos principais:\n\u2022\to m\u00e9todo de diferen\u00e7as finitas de cinco pontos em 2D, sete pontos em 3D;\n\u2022\to m\u00e9todo de elementos finitos de Galerkin, com fun\u00e7\u00f5es de forma Lagrangeanas bilineares (2D) e trilineares (3D);\n\u2022\ta formula\u00e7\u00e3o (mista-)h\u00edbrida de elementos finitos, no espa\u00e7o de Raviart-Thomas de mais baixa ordem.\nDescrevem-se a seguir alguns dos trabalhos mais significativos sobre o c\u00e1lculo da permeabilidade equivalente por meio de m\u00e9todos num\u00e9ricos, particularmente no que diz respeito \u00e0 utiliza\u00e7\u00e3o dos m\u00e9todos de diferen\u00e7as finitas e de elementos finitos tradicionais. A aplica\u00e7\u00e3o da formula\u00e7\u00e3o h\u00edbrida ao fluxo em meios porosos, uma abordagem mais recente e de interesse mais espec\u00edfico para esta tese, ser\u00e1 tratada no pr\u00f3ximo cap\u00edtulo.\nO artigo de Warren e Price [1961], pioneiro em sua abordagem do escoamento em meios heterog\u00eaneos, tomou-se uma refer\u00eancia fundamental para os estudos posteriores. Eles estudaram a permeabilidade absoluta equivalente de meios heterog\u00eaneos, em fluxo\nmonof\u00e1sico, tanto para o regime permanente quanto para o regime transiente. O problema foi resolvido em tr\u00eas etapas, segundo uma metodologia que fez escola:\n\u2022\tgera\u00e7\u00e3o estoc\u00e1stica do arranjo espacial das propriedades f\u00edsicas;\n\u2022\tmontagem e resolu\u00e7\u00e3o num\u00e9rica das equa\u00e7\u00f5es diferenciais parciais, sujeitas a certas condi\u00e7\u00f5es de contorno. Foram usados o m\u00e9todo de diferen\u00e7as finitas e condi\u00e7\u00f5es de contorno imperme\u00e1veis;\n\u2022\tc\u00e1lculo da permeabilidade equivalente a partir da vaz\u00e3o total computada.\nSegundo os pr\u00f3prios autores, a conclus\u00e3o mais importante do estudo \u00e9 que o comportamento mais prov\u00e1vel de um sistema heterog\u00eaneo com fluxo monof\u00e1sico aproxima-se do comportamento de um sistema homog\u00eaneo cuja permeabilidade \u00e9 igual \u00e0 m\u00e9dia geom\u00e9trica das permeabilidades individuais do sistema original. Na verdade, esses resultados correspondem a uma subestimativa para'meios lognormais tridimensionais, fato que ser\u00e1 discutido mais adiante. Quanto \u00e0 permeabilidade obtida de um teste de press\u00e3o (regime transiente), os autores concluem que ela representa bem a permeabilidade equivalente simulada para o regime permanente.\nWarren e Price tamb\u00e9m estudaram, com dificuldade, o fluxo em meios heterog\u00eaneos em laborat\u00f3rio, por meio da constru\u00e7\u00e3o de prot\u00f3tipos, pela uni\u00e3o de diversos cubos. No artigo, fala-se de um modelo com permeabilidade equivalente medida de 60.5 Darcies que, segundo seus c\u00e1lculos, deveria se comportar como tendo em tomo de 47 Darcies. Foi levantada a suspeita de fluxo entre as faces dos cubos.\nDesbarats [1987] usa uma abordagem num\u00e9rica muito semelhante \u00e0 de Warren e Price para estimar a permeabilidade equivalente em forma\u00e7\u00f5es argilo-arenosas em regime de fluxo permanente. A escolha desse tipo de forma\u00e7\u00e3o \u00e9 justificada citando-se Haldorsen e Chang [1986]: \u201ca experi\u00eancia tem mostrado que lentes descont\u00ednuas de argila (baixas permeabilidades) dispersas em um reservat\u00f3rio aren\u00edtico s\u00e3o o principal tipo de heterogeneidade afetando o comportamento do fluxo\u201d. O artigo explica em detalhes o desenvolvimento do seu modelo geoestat\u00edstico e das simula\u00e7\u00f5es de Monte Cario.\nDesbarats diz que as solu\u00e7\u00f5es anal\u00edticas propostas por diversos autores consideram hip\u00f3teses muito restritivas para os reservat\u00f3rios reais, e, assim, as solu\u00e7\u00f5es num\u00e9ricas s\u00e3o prefer\u00edveis. \u00c9 citado, por exemplo, que a f\u00f3rmula anal\u00edtica de Gelhar e Axness [1983] produz resultados aberrantes, quando aplicada ao modelo bin\u00e1rio de distribui\u00e7\u00e3o da permeabilidade,\ncriado para este estudo. Desbarats defende que a resolu\u00e7\u00e3o num\u00e9rica \u00e9 a \u00fanica forma para validar estimadores anal\u00edticos espec\u00edficos.\nUrna das verifica\u00e7\u00f5es mais importantes, observada dos resultados das diversas simula\u00e7\u00f5es, \u00e9 que - dada urna certa fra\u00e7\u00e3o de argila ~ a permeabilidade efetiva em uma simula\u00e7\u00e3o 3D \u00e9 sistematicamente superior do que a permeabilidade para uma simula\u00e7\u00e3o 2D. Esse fato est\u00e1 de acordo com os desenvolvimentos te\u00f3ricos de Matheron [1967] e de Gutjahr e outros [1978]. Tal fen\u00f4meno ocorre para as simula\u00e7\u00f5es em reservat\u00f3rios gerados pela distribui\u00e7\u00e3o lognormal, como j\u00e1 foi comentado na se\u00e7\u00e3o anterior, quando da discuss\u00e3o dos resultados anal\u00edticos para distribui\u00e7\u00f5es lognormais.\nPara fra\u00e7\u00f5es de argila muito elevadas (acima de 45 % em 2D e 65 % em 3D), h\u00e1 uma queda acentuada da permeabilidade efetiva, pois a continuidade do arenito n\u00e3o \u00e9 mais mantida e o padr\u00e3o de fluxo fica sendo controlado pela permeabilidade da argila. Esses resultados s\u00e3o relacionados com a teoria da percola\u00e7\u00e3o.\nBonet e outros [1989] constr\u00f3em um programa de diferen\u00e7as finitas para c\u00e1lculo da permeabilidade equivalente, para estudo e verifica\u00e7\u00e3o dos resultados de Desbarats.\nDurlofsky [1991, p.699], ap\u00f3s fazer uma curta revis\u00e3o da literatura, conclui que:\n\"Nenhum dos estudos anal\u00edticos anteriores fornece uma estrutura geral para o c\u00e1lculo num\u00e9rico da permeabilidade efetiva ou equivalente; todos s\u00e3o, de uma forma ou de outra, aplic\u00e1veis apenas a situa\u00e7\u00f5es espec\u00edficas. Em particular, todos cont\u00eam hip\u00f3teses impl\u00edcitas sobre a distribui\u00e7\u00e3o espacial ou sobre a correla\u00e7\u00e3o das heterogeneidades, ou ent\u00e3o s\u00e3o formulados espec\u00edficamente para um dado tipo de seq\u00fc\u00eancia (como areia-argila) ou geometria (p.e. sistemas em camadas)?\u2019\nOu seja, Durlofsky segue a linha de Desbarats de resolver numericamente as equa\u00e7\u00f5es representativas no dom\u00ednio mais gen\u00e9rico (real) do problema.\nEm particular, Durlofsky desenvolve uma metodologia que considera o car\u00e1ter tensorial da permeabilidade equivalente, aplicando:\n\u2022\tcondi\u00e7\u00f5es de contorno peri\u00f3dicas na escala refinada;\n\u2022\thip\u00f3tese de gradiente de press\u00e3o linear no bloco grosseiro (pois ele possui permeabilidade constante e igual \u00e0 permeabilidade equivalente);\n\u2022\tm\u00e9todo dos elementos finitos n\u00e3o-conformes no lugar da formula\u00e7\u00e3o mista, por gerar menos inc\u00f3gnitas e levar a uma matriz de rigidez mais bem condicionada.\nDurlofsky sustenta, atrav\u00e9s de um exemplo, que as condi\u00e7\u00f5es de contorno peri\u00f3dicas s\u00e3o as indicadas para obter o tensor equivalente (termos diagonais e cruzados) correto para um dado problema.\nCruz [1991], em sua disserta\u00e7\u00e3o de mestrado, trabalha com a mudan\u00e7a de escala da permeabilidade absoluta em escoamento monof\u00e1sico e da permeabilidade relativa e da press\u00e3o capilar, atrav\u00e9s de pseudo-fun\u00e7\u00f5es, em escoamento bif\u00e1sico. No caso de escoamento monof\u00e1sico, al\u00e9m dos sete exemplos did\u00e1ticos que ser\u00e3o reproduzidos no Cap\u00edtulo 5 (as Configura\u00e7\u00f5es), ele efetuou a simula\u00e7\u00e3o em tr\u00eas modelos geoestat\u00edsticos, sempre em duas dimens\u00f5es espaciais. Ap\u00f3s realizar compara\u00e7\u00f5es entre os resultados pelos m\u00e9todos de Le Loc\u2019h, Desbarats e pelas m\u00e9dias Aritm\u00e9tica, Geom\u00e9trica e Harm\u00f4nica, tendo como referencial os resultados da simula\u00e7\u00e3o na malha fina 40x40, Cruz conclui sugerindo a utiliza\u00e7\u00e3o do m\u00e9todo de Le Loc\u2019h, por se tratar de um m\u00e9todo anal\u00edtico, de implementa\u00e7\u00e3o mais simples e sem erros num\u00e9ricos.\nDe acordo com Fayers e Hewett [1992], a principal hip\u00f3tese nos modelos matem\u00e1ticos atualmente usados para a simula\u00e7\u00e3o do escoamento em meios porosos \u00e9 que a lei de Darcy para o comportamento monof\u00e1sico pode ser estendida para o caso bif\u00e1sico pelo uso das curvas (fun\u00e7\u00f5es) de permeabilidade relativa e de press\u00e3o capilar. A ind\u00fastria do petr\u00f3leo investiu muito nas \u00faltimas d\u00e9cadas em t\u00e9cnicas e equipamentos para melhorar a determina\u00e7\u00e3o dessas propriedades em laborat\u00f3rio, e isso atualmente \u00e9 um limitante para o avan\u00e7o para modelagens mais complexas ~ que poderiam ser derivadas a partir das equa\u00e7\u00f5es de Navier-Stokes, mas implicariam em novos par\u00e2metros e novos tipos de curvas a serem medidas experimentalmente.\nMansoori [1994] faz uma revis\u00e3o dos m\u00e9todos mais usados para se efetuar a mudan\u00e7a de escala em fluxo monof\u00e1sico. A maioria dos trabalhos apresentados at\u00e9 hoje foi sobre a mudan\u00e7a de escala em regime permanente. \u201cA sensibilidade dos resultados pela escolha das condi\u00e7\u00f5es de contorno pode ser investigada considerando-se diferentes conjuntos de condi\u00e7\u00f5es de contorno e fazendo-se uma m\u00e9dia das propriedades equivalentes resultantes das simula\u00e7\u00f5es de fluxo.\u201d De fato, este procedimento \u00e9 feito em subrotinas da biblioteca HOMLIB do projeto PROFIT que fazem a mudan\u00e7a de escala por elementos finitos e por diferen\u00e7as finitas. \u201cA sele\u00e7\u00e3o de algoritmos para gerar uma malha flex\u00edvel o bastante para representar melhor as varia\u00e7\u00f5es das heterogeneidades do reservat\u00f3rio e o tratamento da permeabilidade como um tensor completo (e n\u00e3o apenas diagonal) est\u00e3o entre os m\u00e9todos\ndesenvolvidos para reduzir os erros inerentes associados \u00e0s hip\u00f3teses simplificadoras que s\u00e3o feitas.\u201d\nMansoori mostra esperan\u00e7a de que os avan\u00e7os na tecnologia dos computadores far\u00e3o com que n\u00e3o seja mais necess\u00e1rio fazer mudan\u00e7a de escala no futuro. Acreditamos, por\u00e9m, que tal esperan\u00e7a n\u00e3o \u00e9 razo\u00e1vel, pois, com o aumento da capacidade computacional, sempre existir\u00e3o hip\u00f3teses simplificadoras que poderemos deixar de fazer, elevando novamente a demanda pelo desempenho computacional.\nA refer\u00eancia Galli e outros [1996] \u00e9 o relat\u00f3rio final de um projeto de pesquisa financiado pela \u201cCommission of the European Communities\u201dOs estudos foram desenvolvidos ao longo de tr\u00eas anos por sete pesquisadores da Escola de Minas de Paris e da Universidade de Newcastle, da Inglaterra. Foram abordadas os processos de mudan\u00e7a de escala da permeabilidade absoluta, em 3D, e da dispersividade, ou coeficiente de dispers\u00e3o, em 2D. Para avaliar e classificar as diferentes f\u00f3rmulas simplificadas para a permeabilidade equivalente, foram usados dois c\u00f3digos para o c\u00e1lculo de um valor de refer\u00eancia, que \u00e9 obtido pela solu\u00e7\u00e3o num\u00e9rica das equa\u00e7\u00f5es de fluxo:\n\u2022\tHIGHDEN, um simulador de diferen\u00e7as finitas centradas, com um solver ICCG(O), desenvolvido pela Universidade de Newcastle;\n\u2022\tTRIMULEC, um programa de elementos finitos com fun\u00e7\u00f5es de forma lineares em paralelep\u00edpedos regulares, possuindo um solver multigrid com acelera\u00e7\u00e3o SOR por linha, desenvolvido pela Escola de Minas de Paris.\nUm dos gr\u00e1ficos desse relat\u00f3rio, apresentando os resultados de milhares de simula\u00e7\u00f5es, mostra que, em alguns casos, a permeabilidade equivalente calculada pelo programa HIGHDEN \u00e9 maior do que aquela calculada pelo programa TRIMULEC (K FD > KFE). Esse resultado \u00e9 surpreendente e seria necess\u00e1rio verificar melhor as condi\u00e7\u00f5es dessas simula\u00e7\u00f5es, j\u00e1 que o resultado de uma simula\u00e7\u00e3o EF como limitante superior e o resultado da correspondente simula\u00e7\u00e3o DF como limitante inferior da permeabilidade equivalente s\u00e3o valores bastante observados em diversos estudos, como ser\u00e1 discutido mais adiante.\nO trabalho de Galli e outros [1996] faz refer\u00eancia tamb\u00e9m a experimentos de laborat\u00f3rio realizados nessa \u00e1rea. No caso onde os resultados das simula\u00e7\u00f5es refinadas n\u00e3o convergem para o valor experimental, verificou-se que, na caracteriza\u00e7\u00e3o das heterogeneidades do arenito, treze pingues da amostra total foram perdidos, comprometendo a precis\u00e3o dos resultados por um problema no procedimento experimental.\nDo recente artigo de Durlofsky e outros [1995], selecionam-se aqui alguns pontos importantes para mostrar como est\u00e3o sendo aplicadas as t\u00e9cnicas de mudan\u00e7a de escala \u00e0 simula\u00e7\u00e3o de reservat\u00f3rios reais. Camadas com permeabilidade muito alta ou muito baixa devem ser mantidas no modelo mais grosseiro, pois essas regi\u00f5es s\u00e3o as que mais influenciam o fluxo e os processos de deslocamento misc\u00edvel e imisc\u00edvel no reservat\u00f3rio. Isso gera a necessidade de fazer uma mudan\u00e7a de escala n\u00e3o-uniforme, como tamb\u00e9m j\u00e1 havia sido defendido por Mansoori [1994]. Uma boa pr\u00e1tica \u00e9 identificar as regi\u00f5es mais prov\u00e1veis de ocorr\u00eancia de altos gradientes de velocidade por uma simula\u00e7\u00e3o monof\u00e1sica preliminar. Essa simula\u00e7\u00e3o \u00e9 mais precisa caso feita no modelo 3D do reservat\u00f3rio, levando em conta os po\u00e7os produtores e injetores. Durlofsky emprega uma alternativa simplificada, fazendo a simula\u00e7\u00e3o em diversas se\u00e7\u00f5es transversais bidimensionais e, depois, fazendo uma composi\u00e7\u00e3o dos resultados (composite solve approach).\nPara efetuar a mudan\u00e7a de escala nas diversas regi\u00f5es, \u00e9 empregada a solu\u00e7\u00e3o num\u00e9rica das equa\u00e7\u00f5es de fluxo por DF. Os m\u00e9todos mais simplificados, como as m\u00e9dias e estimadores, n\u00e3o s\u00e3o empregados. Prefere-se um resultado mais robusto, pois o tempo gasto para a solu\u00e7\u00e3o dos diversos sistemas lineares resultantes representa apenas uma pequena fra\u00e7\u00e3o do tempo total necess\u00e1rio para a simula\u00e7\u00e3o global do reservat\u00f3rio.\nO projeto multicliente PROFIT do Centro de Computa\u00e7\u00e3o da Noruega, em Oslo, desenvolveu, em 1994, o estudo \u201cScaling and Representation of Absolute Permcabiliiy' que produziu uma s\u00e9rie de programas e subrotinas, agrupadas sob o nome de biblioteca HOMLIB (\u201cHOMogenization LIBrory^Y\nEsse estudo \u00e9 descrito por Holden e outros [1994], que come\u00e7a apresentando os dois crit\u00e9rios b\u00e1sicos para a defini\u00e7\u00e3o da equival\u00eancia da propriedade f\u00edsica na escala mais grosseira: o de fluxo total e o de dissipa\u00e7\u00e3o de energia.\nDentre os onze m\u00e9todos dispon\u00edveis na biblioteca HOMLIB, tr\u00eas s\u00e3o simula\u00e7\u00f5es com base no primeiro princ\u00edpio, dois s\u00e3o baseados no segundo princ\u00edpio (elementos finitos em cubos e elementos finitos em tetraedros) e seis s\u00e3o as m\u00e9dias usuais que s\u00e3o feitas em problemas de mudan\u00e7a de escala. H\u00e1 tamb\u00e9m um m\u00e9todo para a diagonaliza\u00e7\u00e3o de um tensor de permeabilidade completo sob certas condi\u00e7\u00f5es.\nNo artigo s\u00e3o apresentados os resultados da aplica\u00e7\u00e3o das onze t\u00e9cnicas de homogeneiza\u00e7\u00e3o em doze diferentes sistemas f\u00edsicos. Os autores comentam que a aplica\u00e7\u00e3o das m\u00e9dias \u00e9 muito limitada, mas que, para reservat\u00f3rios com alto grau de homogeneidade, as\nm\u00e9dias Geom\u00e9trica, Harm\u00f3nica-Aritm\u00e9tica e Aritm\u00e9tica-Harm\u00f3nica podem fornecer boas estimativas. A vantagem das m\u00e9dias \u00e9 que elas s\u00e3o muito r\u00e1pidas de se calcular, mesmo para problemas com centenas de milhares de blocos. A conclus\u00e3o final \u00e9 que os m\u00e9todos baseados em simula\u00e7\u00f5es das equa\u00e7\u00f5es de fluxo s\u00e3o os melhores, pois fornecem os menores erros quando comparados com a simula\u00e7\u00e3o na malha refinada, independente das caracter\u00edsticas do sistema f\u00edsico (distribui\u00e7\u00e3o geoestat\u00edstica e condi\u00e7\u00f5es de contorno).\nNa biblioteca HOMLIB, al\u00e9m das j\u00e1 citadas subrotinas em linguagem C, h\u00e1 um outro grupo de rotinas, escritas em FORTRAN 77, para c\u00e1lculo num\u00e9rico da permeabilidade equivalente. Essas rotinas foram agrupadas num chamado m\u00f3dulo EFFPERM, no arquivo de nome \u2018effp.f.\nAs rotinas da HOMLIB ainda n\u00e3o haviam sido testadas na PETROBR\u00c1S. Uma das tarefas propostas nesta tese foi justamente entender e avaliar o funcionamento desses subprogramas, desde a sua entrada de dados, e execut\u00e1-los juntamente com as simula\u00e7\u00f5es dos programas constru\u00eddos nesta tese, segundo o m\u00e9todo EFH, para f\u00edns de valida\u00e7\u00e3o e compara\u00e7\u00e3o, enriquecendo a an\u00e1lise das respostas calculadas. Segue-se, portanto, uma descri\u00e7\u00e3o dessas rotinas, que ser\u00e3o usadas no cap\u00edtulo de an\u00e1lise de resultados.\nH\u00e1 duas rotinas que s\u00e3o interfaces para a entrada de dados dos vetores e matrizes (EFFPERMJiBLOCK para EF e EFFPERM_DBLOCK para DF) e um m\u00f3dulo solver comum, que resolve o sistema linear iterativamente por gradientes conjugados, usando como pr\u00e9-condicionamento uma decomposi\u00e7\u00e3o LU incompleta. Ele trabalha s\u00f3 com malha estruturada. N\u00e3o h\u00e1 nenhum esquema de indexa\u00e7\u00e3o. Dado um elemento da diagonal, a posi\u00e7\u00e3o dos demais elementos n\u00e3o-nulos na mesma linha \u00e9 determinado pelo conhecimento a priori da posi\u00e7\u00e3o das demais sub-diagonais.\nA rotina EFFPERMJEBL faz a mudan\u00e7a de escala pelo m\u00e9todo de elementos finitos (Galerkin) com fun\u00e7\u00f5es de formas bilineares e trilineares. O n\u00famero total de vari\u00e1veis \u00e9 o n\u00famero de n\u00f3s (v\u00e9rtices), para Z* J blocos - problemas 2D - s\u00e3o (Z +1) * (J +1) v\u00e9rtices e para I*J*K blocos - problemas 3D - eles atingem (Z +1) * (J +1)* (K+1). Somente s\u00e3o considerados os termos diagonais do tensor de permeabilidade e pode-se calcular a permeabilidade equivalente em qualquer uma das tr\u00eas dire\u00e7\u00f5es (X, Y ou Z), uma em cada rodada. O dom\u00ednio total \u00e9 um paralelep\u00edpedo, as tr\u00eas dimens\u00f5es podem ser diferentes. A permeabilidade dentro de cada bloco \u00e9 assumida constante.\nPor sua vez, EFFPERMJDBL resolve as equa\u00e7\u00f5es por esquema DF de cinco ou sete pontos, respectivamente para 2D e 3D. \u00c9 usada a m\u00e9dia Harm\u00f4nica para calcular a transmissibilidade entre os blocos, O n\u00famero total de vari\u00e1veis \u00e9 igual ao n\u00famero de blocos, / * J ou I* J* K. Al\u00e9m das demais caracter\u00edsticas gerais de EFFPERM__EBL, essa rotina DF permite definir barreiras imperme\u00e1veis ao fluxo, como pel\u00edculas, entre quaisquer dois blocos, mas n\u00e3o chegamos a usar essa op\u00e7\u00e3o. Em algumas simula\u00e7\u00f5es de teste, EFFPERMJDBL produziu resultados id\u00eanticos aos do programa DF PERMEQ (Romeu [1994]), que - junto com o programa KEQVA - \u00e9 um dos sucessores do programa de Bonet e outros [1989] no CENPES.\n2.5\t- Erros Num\u00e9ricos e Refinamento de Malha\nUm ponto nem sempre bem reconhecido \u00e9 que os m\u00e9todos num\u00e9ricos para c\u00e1lculo da permeabilidade equivalente n\u00e3o s\u00e3o exatos. Em casos onde existe uma solu\u00e7\u00e3o anal\u00edtica exata para a permeabilidade equivalente, podem-se observar resultados num\u00e9ricos sistematicamente enviesados. Lachassagne c outros [1990], por exemplo, mostram como os resultados num\u00e9ricos calculados por programas de diferen\u00e7as finitas e de elementos finitos desviam-se significativamente dos resultados anal\u00edticos previstos para meios lognormais 2D, quando a vari\u00e2ncia dos logaritmos das permeabilidades locais aumenta. Warren e Price [1961], j\u00e1 foi dito, s\u00e3o enganados por esse mesmo vi\u00e9s num\u00e9rico quando conclu\u00edram, equivocadamente, que a permeabilidade equivalente de um meio lognormal 3D seria igual \u00e0 m\u00e9dia geom\u00e9trica (como apresentado na se\u00e7\u00e3o anterior, o resultado \u00e9 pr\u00f3ximo da m\u00e9dia de pot\u00eancia com expoente 1/3).\nIsso vem do fato dos m\u00e9todos num\u00e9ricos serem, em geral, t\u00e9cnicas de aproxima\u00e7\u00e3o, e n\u00e3o de resolu\u00e7\u00e3o. A aproxima\u00e7\u00e3o est\u00e1 associada a uma discretiza\u00e7\u00e3o espacial insuficiente. Efetuando-se o refinamento da malha num\u00e9rica, pode-se notar a tend\u00eancia das novas respostas irem se aproximando da resposta exata. Esse fato j\u00e1 havia sido verificado por Cruz [1991] e por alguns outros autores, e estudado em detalhes por Romeu [1995].\nApenas em poucos casos especiais - como sistemas em s\u00e9rie, paralelo e barreira imperme\u00e1vel - os diversos m\u00e9todos de simula\u00e7\u00e3o calculam a resposta exata mesmo sem\nrefinamento, devido \u00e0 simplicidade do problema. No caso mais geral, a resposta num\u00e9rica \u00e9 uma aproxima\u00e7\u00e3o que pode ser melhorada com o refinamento da malha num\u00e9rica.\nRefinar a malha num\u00e9rica consiste em dividir um bloco originai em blocos menores, estabelecendo para esses blocos menores uma propriedade caracter\u00edstica de acordo com a propriedade no bloco original. No caso do problema de mudan\u00e7a de escala da permeabilidade absoluta, a permeabilidade de todos os blocos menores \u00e9 feita constante e igual \u00e0 permeabilidade do bloco que lhes deu origem. Um fato paradoxal: para ir para uma escala mais grosseira, o valor representativo deve ser encontrado numa escala bem mais refinada.\nO modo mais ou menos r\u00e1pido como os diferentes m\u00e9todos num\u00e9ricos convergem para a resposta exata da permeabilidade equivalente ser\u00e1 exatamente um dos crit\u00e9rios fundamentais nos estudos comparativos do Cap\u00edtulo 5. Ser\u00e1 por meio desse crit\u00e9rio (a taxa de converg\u00eancia) que o novo programa constru\u00eddo, segundo a formula\u00e7\u00e3o EFH, ser\u00e1 comparado com os programas de DF e EF mais tradicionais.\nQuanto mais refinada a malha, quanto maior o n\u00famero de elementos discretizando o dom\u00ednio, maior a precis\u00e3o da simula\u00e7\u00e3o. Romeu [1994] e Durlofsky [1994] efetuaram estudos nesse sentido e apresentam gr\u00e1ficos mostrando o resultado de simula\u00e7\u00f5es, em fun\u00e7\u00e3o do n\u00fameros de blocos, convergindo para um determinado valor, admitido como a resposta exata do problema analisado. Romeu [1994], aplicando o m\u00e9todo das perturba\u00e7\u00f5es e a transformada de Fourier, chega a resultados anal\u00edticos para a idealiza\u00e7\u00e3o de um reservat\u00f3rio quadriculado, mostrando que a resposta da simula\u00e7\u00e3o DF \u00e9 dada por um termo independente (a solu\u00e7\u00e3o ideal) mais um outro cujo limite \u00e9 zero quando o refinamento da malha tende a infinito, um exemplo bastante ilustrativo da maior precis\u00e3o com o refinamento.\nNas duas refer\u00eancias acima, nos pr\u00f3prios gr\u00e1ficos citados, \u00e9 verificado o comportamento dos diferentes m\u00e9todos num\u00e9ricos. As formula\u00e7\u00f5es EF tradicional e CVFE calculam valores acima do considerado correto, convergindo por cima da solu\u00e7\u00e3o. As formula\u00e7\u00f5es DF, EFM e EFH subestimam a solu\u00e7\u00e3o, convergindo por baixo, apresentando valores cada vez maiores quanto mais refinada a malha.\nPara estudar este fen\u00f4meno, construiu-se uma subrotina para refinamento autom\u00e1tico da malha, de acordo com um comando na entrada de dados\nCap\u00edtulo 3 - M\u00e9todo dos Elementos Finitos\nH\u00edbridos\n3.1\t- Vis\u00e3o Geral dos M\u00e9todos Mistos e H\u00edbridos\nSegundo Chavent e Jaffr\u00e9 [1986, p.311]:\n\u201cH\u00e1 duas raz\u00f5es b\u00e1sicas para que os m\u00e9todos de elementos finitos tradicionais n\u00e3o sejam adequados para a simula\u00e7\u00e3o de reservat\u00f3rios. A primeira \u00e9 que eles foram projetados para problemas com solu\u00e7\u00f5es suaves (processos difusivos, mec\u00e2nica estrutural), enquanto que, na simula\u00e7\u00e3o de reservat\u00f3rios, a solu\u00e7\u00e3o pode apresentar frentes \u00edngremes quando as equa\u00e7\u00f5es s\u00e3o dominadas por efeitos convectivos. A segunda raz\u00e3o \u00e9 que a velocidade dos fluidos, que \u00e9 um importante fator de acoplamento nas equa\u00e7\u00f5es no reservat\u00f3rio, \u00e9 pobremente aproximada pelas fun\u00e7\u00f5es de forma lineares (fun\u00e7\u00f5es \u201cchap\u00e9u\u201d) normalmente usadas nas formula\u00e7\u00f5es de elementos finitos cont\u00ednuos aplicadas em problemas el\u00edpticos e parab\u00f3licos suaves.\u201d\nAs formula\u00e7\u00f5es mistas de elementos finitos s\u00e3o uma forma de se obter velocidades realmente conservativas por meio da aproxima\u00e7\u00e3o em separado da press\u00e3o (vari\u00e1vel principal) e do seu gradiente, ou da pr\u00f3pria velocidade, o que \u00e9 equivalente. No problema de c\u00e1lculo da permeabilidade equivalente, isso corresponde a resolver as equa\u00e7\u00f5es (2.8) e (2.9) de forma separada, mas acoplada - o que contrasta com outros m\u00e9todos onde a equa\u00e7\u00e3o (2.9) \u00e9 imediatamente introduzida em (2.8). A dimens\u00e3o do sistema misto \u00e9, ent\u00e3o, igual \u00e0 soma do n\u00famero de faces (n\u00famero de valores de velocidades a serem calculadas) com o n\u00famero de elementos (n\u00famero de valores de press\u00f5es a serem calculadas) discretizando o dom\u00ednio. O resultado \u00e9 uma aproxima\u00e7\u00e3o mais precisa, especialmente no c\u00e1lculo das velocidades.\nDe fato, um grande avan\u00e7o e uma raz\u00e3o para as formula\u00e7\u00f5es mista (e h\u00edbrida) serem mais adequadas para problemas de fluxo \u00e9 que elas trabalham com fun\u00e7\u00f5es vetoriais, e com isso conseguem representar com mais liberdade o real comportamento do fen\u00f4meno f\u00edsico.\nA principal desvantagem da formula\u00e7\u00e3o mista \u00e9 que ela monta um sistema linear que n\u00e3o \u00e9 positivo-definido. Esses sistemas s\u00e3o mais dif\u00edceis de resolver. Muito do que \u00e9 publicado sobre elementos mistos \u00e9 exatamente sobre algoritmos eficientes para a solu\u00e7\u00e3o do\nsistema linear resultante, usando m\u00e9todos num\u00e9ricos muito elaborados e computacionalmente caros, e essa \u00e9 uma das raz\u00f5es que tem limitado a utiliza\u00e7\u00e3o dos m\u00e9todos mistos por engenheiros. O artigo de Alien [1994] \u00e9 um t\u00edpico exemplo dessa literatura.\nPara contornar o problema, Durlofsky [1994] cita os tr\u00eas m\u00e9todos mais comuns para se obter uma matriz (sim\u00e9trica) positiva-definida de ordem igual ao n\u00famero de faces, cuja solu\u00e7\u00e3o \u00e9 equivalente \u00e0 solu\u00e7\u00e3o da formula\u00e7\u00e3o mista:\n\u00ab formula\u00e7\u00e3o de elementos finitos n\u00e3o-conformes;\n\u2022\tintrodu\u00e7\u00e3o de um termo de penalidade;\n\u2022\tformula\u00e7\u00e3o h\u00edbrida, ou t\u00e9cnica de hibridiza\u00e7\u00e3o.\nNa variante h\u00edbrida (ou elementos finitos mistos-h\u00edbridos, ou ainda, simplesmente, elementos finitos h\u00edbridos, ou ainda, nesta tese, EFH) a continuidade do fluxo normal entre elementos adjacentes \u00e9 garantida expl\u00edcitamente por meio da \u00fanica equa\u00e7\u00e3o que monta o sistema linear a ser resolvido, e n\u00e3o por meio da constru\u00e7\u00e3o do espa\u00e7o de aproxima\u00e7\u00e3o. As formula\u00e7\u00f5es h\u00edbridas est\u00e3o associadas matematicamente a uma aplica\u00e7\u00e3o dos multiplicadores de Lagrange - fun\u00e7\u00e3o Lagrangeana ou simplesmente Lagrangeano - , muito usados em problemas de otimiza\u00e7\u00e3o em Pesquisa Operacional.\nHoje em dia, existe a tend\u00eancia de substituir o m\u00e9todo misto pelo h\u00edbrido. Durlofsky [1994], por exemplo, usou, na realidade, o m\u00e9todo h\u00edbrido (como indica o n\u00famero total de vari\u00e1veis na malha triangular 20x20(x2) igual \u00e0 1240, pois na formula\u00e7\u00e3o mista seriam 1240 + 800 \u201c 2040 inc\u00f3gnitas). Chavent e Roberts [1991, p.343] j\u00e1 recomendavam o uso da formula\u00e7\u00e3o h\u00edbrida ao inv\u00e9s da formula\u00e7\u00e3o mista.\nDois inconvenientes na formula\u00e7\u00e3o h\u00edbrida s\u00e3o:\n\u2022\ta necessidade, no p\u00f3s-processamento, da matriz elementar para o c\u00e1lculo da press\u00e3o m\u00e9dia e dos fluxos nas faces. Para malhas compostas por muitos elementos deformados de formas diferentes, \u00e9 preciso armazenar muitas matrizes elementares ou, ent\u00e3o, essas matrizes elementares ter\u00e3o que ser calculadas novamente (para problemas grandes, a segunda op\u00e7\u00e3o parece mais apropriada);\n\u2666\ta necessidade de calcular a inversa da matriz de rigidez elementar pode aumentar muito o tempo de processamento para espa\u00e7os de aproxima\u00e7\u00e3o de ordem superiores (no caso mais geral, com malhas muito irregulares).\nSegue-se uma revis\u00e3o dos trabalhos relacionados com a aplica\u00e7\u00e3o do m\u00e9todo dos elementos finitos h\u00edbridos ao problema da simula\u00e7\u00e3o de fluxo em meios porosos. Depois\ndisso, elabora-se uma s\u00edntese da formula\u00e7\u00e3o, com aprofundamento em alguns detalhes particulares.\n3.2\t- Aplica\u00e7\u00e3o dos M\u00e9todos de Elementos Finitos ao Fluxo em Meios Porosos\nO objetivo de Frind e Matanga [1985] \u00e9 calcular um campo de velocidades no meio poroso (aq\u00fc\u00edfero) com precis\u00e3o satisfat\u00f3ria para a simula\u00e7\u00e3o do transporte de contaminantes. Na revis\u00e3o da teoria, eles fazem o desenvolvimento detalhado das equa\u00e7\u00f5es para a descri\u00e7\u00e3o do fluxo em regime permanente, em termos de potencial e de linhas de fluxo, e mostram como tratar as condi\u00e7\u00f5es de contomo essenciais e naturais. E comentado que os modelos de linhas de fluxo s\u00e3o sub-utilizados em hidrologia.\nA partir das formula\u00e7\u00f5es em termos de potencial e em termos de linhas de fluxo, que s\u00e3o muito semelhantes, eles mostram como aproximar a solu\u00e7\u00e3o por elementos finitos (tri\u00e2ngulos e quadril\u00e1teros) com fun\u00e7\u00f5es de forma lineares. Tendo lados compat\u00edveis, tri\u00e2ngulos e ret\u00e2ngulos podem ser usados em conjunto. Embora os tri\u00e2ngulos sejam mais vers\u00e1teis para a representa\u00e7\u00e3o de geometrias irregulares, os ret\u00e2ngulos, usados onde a geometria permitir, conduzem a uma solu\u00e7\u00e3o mais precisa. Os elementos podem ser sempre orientados de tal forma que os eixos locais coincidam com os eixos principais da permeabilidade e, assim, a solu\u00e7\u00e3o pode ser baseada na formula\u00e7\u00e3o que n\u00e3o cont\u00e9m termos cruzados.\nComo conclus\u00e3o, s\u00e3o citadas as principais vantagens da chamada formula\u00e7\u00e3o dual, que \u00e9 a formula\u00e7\u00e3o em termos das linhas de fluxo:\n\u2022\ta solu\u00e7\u00e3o j\u00e1 \u00e9 expressa em termos da velocidade;\n\u2022\to mesmo m\u00e9todo num\u00e9rico da formula\u00e7\u00e3o em termos do potencial pode ser utilizado, pois as equa\u00e7\u00f5es b\u00e1sicas s\u00e3o da mesma forma;\n\u2022\tas condi\u00e7\u00f5es de contorno em termos de fluxo s\u00e3o melhor satisfeitas.\nEm um artigo complementar a esse \u00e9 apresentada a aplica\u00e7\u00e3o metodologia \u00e0 um aq\u00fc\u00edfero real, onde as linhas de fluxo, obtidas pela migra\u00e7\u00e3o de um contaminante, foram sendo determinadas com boa precis\u00e3o ao longo de muitos anos.\nCordes e Kinzeibach [1992] desenvolvem um m\u00e9todo de p\u00f3s-processamento da press\u00e3o obtida pela aproxima\u00e7\u00e3o por elementos finitos - fun\u00e7\u00f5es de forma linear e bilinear -\npara gerar um mapa de fluxo cont\u00ednuo em todo o dom\u00ednio. Eles comentam que modelos que geram linhas de fluxo (stream function models) s\u00e3o uma alternativa para a determina\u00e7\u00e3o do campo de velocidades, mas n\u00e3o podem ser aplicados ao fluxo em regime transiente, problemas tridimensionais e reservat\u00f3rios com fontes e sumidouros (po\u00e7os) distribu\u00eddos. Al\u00e9m disso, esses modelos acabam por dobrar o esfor\u00e7o computacional necess\u00e1rio, pois precisam dos valores das press\u00f5es para calibrar os par\u00e2metros de fluxo.\nA metodologia de p\u00f3s-processamento \u00e9 apresentada para o caso 2D e s\u00e3o dadas as indica\u00e7\u00f5es para estender para 3D. O artigo detalha bem a metodologia, por\u00e9m sabe-se que a capacidade de aumentar a precis\u00e3o do fluxo com p\u00f3s-processamento est\u00e1 limitada pela precis\u00e3o na determina\u00e7\u00e3o da press\u00e3o. Com o uso das fun\u00e7\u00f5es de forma linear e bilinear, a taxa de converg\u00eancia da press\u00e3o \u00e9 O(h); mais lenta do que a taxa O(h2 ) dos casos de DF centradas e da formula\u00e7\u00e3o h\u00edbrida de EF no espa\u00e7o R TQ (espa\u00e7o de Raviart-Thomas de mais baixa ordem, que ser\u00e1 descrito na pr\u00f3xima se\u00e7\u00e3o).\nEymard, Gallouet e Joly [1989] mostram um simulador desenvolvido para o deslocamento imisc\u00edvel bif\u00e1sico incompress\u00edvel, em 2D e 3D. Segundo o texto, eles desenvolveram uma formula\u00e7\u00e3o h\u00edbrida de elementos finitos com tr\u00eas graus de liberdade em elementos retangulares e dois graus de liberdade em tri\u00e2ngulos, fazendo com que o n\u00famero total de vari\u00e1veis do sistema linear seja, assintoticamente, o mesmo que o n\u00famero de blocos discretizando o dom\u00ednio, no caso de ret\u00e2ngulos. Ou seja, o sistema \u00e9 da ordem de grandeza do obtido pela formula\u00e7\u00e3o de diferen\u00e7as finitas. A t\u00e9cnica para resolver o fluxo bif\u00e1sico \u00e9 do tipo IMPES (IMplicit in Pressure, Explicit in Saturatiori).\nEssa redu\u00e7\u00e3o no n\u00famero de graus de liberdade por elemento \u00e9 muito importante para aumentar a efici\u00eancia computacional da formula\u00e7\u00e3o h\u00edbrida sobre a formula\u00e7\u00e3o DF, por\u00e9m os artigos mais recentes continuam citando como dois a rela\u00e7\u00e3o entre o n\u00famero de vari\u00e1veis da formula\u00e7\u00e3o h\u00edbrida e o total de vari\u00e1veis na formula\u00e7\u00e3o DF, para a mesma discretiza\u00e7\u00e3o do dom\u00ednio.\nChavent e outros [1990] apresentam as principais caracter\u00edsticas do simulador de reservat\u00f3rios para fluxo bif\u00e1sico incompress\u00edvel BIDIMIX, desenvolvido em conjunto pelo INRIA, IFP e Elf Aquitaine. A equa\u00e7\u00e3o de satura\u00e7\u00e3o \u00e9 resolvida por EF descont\u00ednuos e com o uso de um limitador de inclina\u00e7\u00e3o (slope limiter), t\u00e9cnica esta que j\u00e1 est\u00e1 presente nos atuais manuais para a resolu\u00e7\u00e3o num\u00e9rica de EDP. A equa\u00e7\u00e3o da press\u00e3o e a de conserva\u00e7\u00e3o s\u00e3o resolvidas utilizando EF h\u00edbridos com o espa\u00e7o R To . S\u00e3o considerados os efeitos\ngravitacionais e de press\u00e3o capilar. A representa\u00e7\u00e3o dos po\u00e7os \u00e9 feita por macroelementos, um refinamento radial da malha na regi\u00e3o dos po\u00e7os.\nPara a formula\u00e7\u00e3o h\u00edbrida, s\u00e3o apresentados os espa\u00e7os de aproxima\u00e7\u00e3o envolvidos na aproxima\u00e7\u00e3o R To e a forma geral das matrizes presentes no sistema linear final a ser resolvido.\nS\u00e3o apresentados, em linhas gerais, quatro exemplos de valida\u00e7\u00e3o. No caso de deslocamento imisc\u00edvel linear, o programa calcula valores muito mais precisos da raz\u00e3o \u00e1gua-\u00f3leo contra o volume de \u00e1gua injetado, necessitando de apenas 1/6 do esfor\u00e7o computacional do esquema DF de primeira ordem.\nEste artigo \u00e9, de certa forma, uma atualiza\u00e7\u00e3o do cap\u00edtulo cinco do livro de Chavent e Jaf\u00edf\u00e9 [1986], ampliada pela constru\u00e7\u00e3o do simulador BIDIMIX.\nBeckie, Wood e Aldama [1993] apresentam as estrat\u00e9gias empregadas na simula\u00e7\u00e3o de alto desempenho do fluxo monof\u00e1sico em aq\u00fc\u00edferos heterog\u00eaneos. S\u00e3o empregadas t\u00e9cnicas avan\u00e7adas como decomposi\u00e7\u00e3o de dom\u00ednio com multigrid e formula\u00e7\u00e3o h\u00edbrida de elementos finitos utilizando o espa\u00e7o de BDM de primeira ordem.\nNesse artigo em quest\u00e3o, eles sustentam que as simula\u00e7\u00f5es num\u00e9ricas para estudar o efeito das heterogeneidades s\u00e3o feitas, geralmente, em malhas finamente refinadas e com valores de permeabilidade gerados sinteticamente por distribui\u00e7\u00f5es geoestat\u00edsticas, como, tipicamente, a lognormal sem correla\u00e7\u00e3o. \u00c9 comentado que o espa\u00e7o de aproxima\u00e7\u00e3o de Raviart-Thomas de mais baixa ordem n\u00e3o reproduz corretamente fluxos n\u00e3o paralelos aos eixos de coordenadas.\nA conclus\u00e3o b\u00e1sica do artigo \u00e9 que o algoritmo de decomposi\u00e7\u00e3o de dom\u00ednio com acelera\u00e7\u00e3o multigrid consome entre cinco e dez vezes mais tempo de CPU do que a vers\u00e3o h\u00edbrida com solver ICCG(O), mas permite simular problemas da ordem de quatro milh\u00f5es de graus de liberdade, o que n\u00e3o seria poss\u00edvel de outra forma.\nDurlofsky [1994] apresenta os resultados de simula\u00e7\u00f5es de fluxo monof\u00e1sico bidimensional em reservat\u00f3rios de petr\u00f3leo idealizados, comparando o m\u00e9todo dos elementos finitos tipo volume de controle com a formula\u00e7\u00e3o mista de elementos finitos. O objetivo principal \u00e9 gastar o menor esfor\u00e7o computacional para obter um campo de velocidades que realmente conserve a massa do sistema e com fluxos cont\u00ednuos entre elementos, utilizando apenas fun\u00e7\u00f5es de forma lineares. O esfor\u00e7o computacional foi relacionado como diretamente proporcional ao n\u00famero de inc\u00f3gnitas do sistema linear a ser resolvido, para uma certa\nprecis\u00e3o no mapa de fluxo. Para um mesmo n\u00famero de inc\u00f3gnitas, a formula\u00e7\u00e3o mista \u00e9 resolvida numa malha mais grosseira por ter mais inc\u00f3gnitas por cada elemento.\nA conclus\u00e3o principal \u00e9 que para sistemas com maior grau de heterogeneidade, como o caso de arenito com argilas dispersas aleatoriamente e como o caso de intrus\u00e3o de canal de baix\u00edssima permeabilidade, a formula\u00e7\u00e3o mista \u00e9 computacionalmente mais eficiente do que elementos tipo volume de controle: os resultados com 1240 vari\u00e1veis s\u00e3o bem mais precisos do que o CVFE com 3721 vari\u00e1veis. O autor conclui tamb\u00e9m que a formula\u00e7\u00e3o mista \u00e9 mais robusta e confi\u00e1vel e que a vantagem dessa formula\u00e7\u00e3o pode ser estendida para fluxo multif\u00e1sico, j\u00e1 que as equa\u00e7\u00f5es hiperb\u00f3licas de satura\u00e7\u00e3o a serem acopladas no modelo multif\u00e1sico s\u00e3o tamb\u00e9m pass\u00edveis de tratamento pela formula\u00e7\u00e3o mista.\nArbogast e outros [1995] citam na revis\u00e3o de literatura que T.F. Russell e M.F. Wheeler demostraram, em publica\u00e7\u00e3o de 1983, que o uso de regras especiais de quadratura transformam a formula\u00e7\u00e3o mista de EF no espa\u00e7o \u00c3 TQ no esquema de diferen\u00e7as finitas centradas padr\u00e3o apenas para o caso de dom\u00ednio retangular, e tamb\u00e9m com a hip\u00f3tese do tensor de permeabilidades ser diagonal. No caso mais real, com a geometria do reservat\u00f3rio n\u00e3o sendo t\u00e3o uniforme, aplica-se a t\u00e9cnica de mapear o dom\u00ednio f\u00edsico do reservat\u00f3rio em um dom\u00ednio computacional retangular. Existindo uma fun\u00e7\u00e3o suave que fa\u00e7a esse mapeamento, ficam mantidas as vantagens de facilidade de implementa\u00e7\u00e3o, a maior precis\u00e3o dos resultados e a conserva\u00e7\u00e3o local de massa da simula\u00e7\u00e3o EF mista em ret\u00e2ngulos. Esse tipo de mapeamento \u00e9 origin\u00e1rio da ind\u00fastria aeron\u00e1utica, onde \u00e9 muito empregado, havendo muitos c\u00f3digos comerciais dispon\u00edveis para criar o mapeamento e sua respectiva matriz Jacobiana. Aqui tamb\u00e9m aparece a explica\u00e7\u00e3o de que a formula\u00e7\u00e3o h\u00edbrida de EF \u00e9 um caso limite da t\u00e9cnica de decomposi\u00e7\u00e3o de dom\u00ednio, onde todos os elementos s\u00e3o tamb\u00e9m sub-dom\u00ednios.\n3.3\t- Espa\u00e7os de Aproxima\u00e7\u00e3o\n3.3.1\t- Espa\u00e7o de Raviart-Thomas\nO espa\u00e7o de aproxima\u00e7\u00e3o de Raviart-Thomas de mais baixa ordem, denominado RTQ, \u00e9 composto por tr\u00eas espa\u00e7os de aproxima\u00e7\u00e3o distintos:\n\u2022 define-se uma press\u00e3o m\u00e9dia em todo o elemento;\n\u00ae em cada face do elemento h\u00e1 uma press\u00e3o m\u00e9dia, um tra\u00e7o de press\u00e3o, que pode ser representada como aplicada no centro da face, ou ent\u00e3o ao longo de toda a face;\n\u2022 o fluxo (vari\u00e1vel vetorial) no elemento \u00e9 representado peia expans\u00e3o em um n\u00famero de fun\u00e7\u00f5es de forma (vetoriais) lineares igual ao n\u00famero de faces:\nv(\u00ed)=\u2019TvJw/x) .\t(3.1)\nAs fun\u00e7\u00f5es de forma lineares de expans\u00e3o do fluxo devem possuir propriedades caracter\u00edsticas, que ser\u00e3o vistas a seguir. Ser\u00e3o mostrados os casos mais comuns: elemento mestre triangular e elemento mestre quadrado.\n3.3.2\t- Elemento Mestre Triangular: Fun\u00e7\u00f5es de Forma e Suas Propriedades\nFigura 3.1 - Espa\u00e7o de aproxima\u00e7\u00e3o do fluxo no elemento mestre triangular\nV.w, = l + l = 2 = cte\nV. w2 = 1 +1 = 2 = cie\nV .\t= 1 4\" 1 \u2014 2 = c\u00ede\nConclus\u00e3o:\n\u00a3 V . w, = 2 . \u00a3 = 1, i- 1,2,3\n2\n(3.2)\n\nw2 .\u00abj =-y=0\nResumindo em uma equa\u00e7\u00e3o:\n- - 72/\t\\ wi-n2=^~~ {x + y-lj=0\tWj .n3 =-x = 0\n\u00cd2\t\u00bf2 w2-\u00ab2\u201c 2 V+y> 2\tw2 .H3 -~x=0\nvv3./72=4~- (x_i+j)=o\tw3.\u00e3z3 =1-x = 1\nL\t= so\t(3-3)\n3.3.3 - Elemento Mestre Quadrado: Fun\u00e7\u00f5es de Forma e Suas Propriedades\nFigura 3.2 - Elemento mestre quadrado\n1\nV.w, =~=cte\n1 4\nV.fo -~=cte \u00bf 4\nV.w, - \u2014^cte\n\u2022 4\nNovamente:\nV.iv( = t,4 =!, /=1,2,3,4\n(e +1) 1\n1\t4\t2 (r, +1)\t1\n2_\t4\t~2\n(e-1) 1\n\n3\t4\t2\n(p -1)\t1\n(c 4-1)\n\t~0\twt.n3 \u2014-\t4\t\u201c = (\n\t=0\t\t(n +\t1)\n\t\t\t4\t\nw3.ri4\t=0\t- - (E W3-Wl\u201c\t-0 4\t-0\n-\u00ab3\t=0\t(r w4.n2~\tI +1) A\t=0\nw2 -\u00ab3=0\niv3.n2 =0\nW4.H,=0\nE tamb\u00e9m:\n(3.5)\n3.3.4\t- A Transforma\u00e7\u00e3o de Piola\nAs fun\u00e7\u00f5es de forma descritas anteriormente foram definidas para elementos de geometria padr\u00e3o. Para elementos triangulares ou retangulares deformados, faz-se necess\u00e1ria uma certa transforma\u00e7\u00e3o.\nA fun\u00e7\u00e3o que faz a correspond\u00eancia das bases vetoriais no elemento mestre com as respectivas fun\u00e7\u00f5es de forma vetoriais no elemento real deformado \u00e9 conhecida como transforma\u00e7\u00e3o de Piola. Essa transforma\u00e7\u00e3o preserva a componente normal do campo vetorial na superf\u00edcie (em 2D, no lado) do elemento deformado.\nI M atriz Jacobiana I\ni =\t-------------J--------------- \u2122 i\t(3.6)\nonde:\nJ = Jacobiano = Determinante da Matriz Jacobiana\n[ Matriz Jacobiana] = Matriz de Transforma\u00e7\u00e3o das Coordenadas de um Ponto em Rela\u00e7\u00e3o aos Eixos Cartesianos no Elemento Mestre e seu Correspondente Mapeamento no Elemento Real Deformado, Descrito nos Eixos Globais do Dom\u00ednio.\nAl\u00e9m disso, a transforma\u00e7\u00e3o de Piola tamb\u00e9m mant\u00e9m:\n[v.\u00d5,- = [v.\u00ae,. = 1,V\u00cd\t(3.7)\n(3.8)\nque ser\u00e3o caracter\u00edsticas muito \u00fateis para simplificar a formula\u00e7\u00e3o de elementos finitos.\nO primeiro lugar onde encontramos um m\u00e9todo para transforma\u00e7\u00e3o das fun\u00e7\u00f5es de forma vetoriais, mantendo-se a componente normal, foi em Thomasset [1981, p. 34]. Entretanto, neste livro, o espa\u00e7o de aproxima\u00e7\u00e3o \u00e9 definido de forma a ter a componente normal unit\u00e1ria, quando \u00e9 mais desej\u00e1vel manter a integral dessa componente normal sobre o lado, ou seja, um fluxo normal unit\u00e1rio atrav\u00e9s do lado. O fluxo normal total ser\u00e1 dado pelo coeficiente v., calculado no p\u00f3s-processamento, como ser\u00e1 visto a seguir. Arbogast e outros [1995] apresentam a denomina\u00e7\u00e3o de transforma\u00e7\u00e3o de Piola. A transforma\u00e7\u00e3o de Piola \u00e9 realmente fundamental para os m\u00e9todos que trabalham com vetores, como pode ser visto tamb\u00e9m em Brezzi e Fortin [1991, p. 97].\n3.3.5\t- Outros Espa\u00e7os de Aproxima\u00e7\u00e3o\nAtualmente existem tr\u00eas grupos principais de espa\u00e7os de aproxima\u00e7\u00e3o para as formula\u00e7\u00f5es EF mista e h\u00edbrida:\n\u2022\tos espa\u00e7os de Raviart-Thomas (RTK );\n\u2022\tos espa\u00e7os de Brezzi-Douglas-Marini\n\u2022\tos espa\u00e7os de Brezzi-Douglas-Fortin-Marini (BDFM[K+l] ).\nO espa\u00e7o RT0 \u00e9 o espa\u00e7o mais simples poss\u00edvel, e, por isso, ele ocupa um lugar especial entre todos os demais.\nBrezzi e Fort\u00edn [1991] \u00e9 uma das refer\u00eancias mais modernas nesse assunto, com enfoque bastante matem\u00e1tico e exemplos voltados para a elasticidade, mec\u00e2nica estrutural, operador biharm\u00f4nico. Para problemas de fluxo (EDP de segunda ordem) s\u00e3o encontradas cita\u00e7\u00f5es de utiliza\u00e7\u00e3o dos espa\u00e7os RTq. BDM\u00a1 e R7\u00a1. Beckie e outros [1993] utilizam o espa\u00e7o BDM\u00a1. Nesse artigo encontra-se uma r\u00e1pida apresenta\u00e7\u00e3o desse espa\u00e7o.\nQuanto maior a dimens\u00e3o do espa\u00e7o, maior a precis\u00e3o que pode ser obtida. Por outro lado, mais complexa s\u00e3o a formula\u00e7\u00e3o e as opera\u00e7\u00f5es matem\u00e1ticas a serem realizadas.\n3.4\t- S\u00edntese da Formula\u00e7\u00e3o\nA utiliza\u00e7\u00e3o dos m\u00e9todos h\u00edbridos em problemas de fluxos em meios porosos \u00e9 t\u00e3o recente que muito do que existe na literatura est\u00e1 numa linguagem matem\u00e1tica de dif\u00edcil compreens\u00e3o, mesmo para engenheiros p\u00f3s-graduados. Uma importante exce\u00e7\u00e3o \u00e9 o artigo de Chavent [1991]. Por outro lado, ele simplifica tanto a formula\u00e7\u00e3o, visando sua aplica\u00e7\u00e3o em malhas simplesmente retangulares, que fica dif\u00edcil estender para o importante caso de elementos deformados linearmente. Portanto, julgou-se proveitoso elaborar a seguinte s\u00edntese da formula\u00e7\u00e3o, n\u00e3o apenas por consist\u00eancia do texto como tamb\u00e9m por n\u00e3o haver dispon\u00edvel na literatura uma apresenta\u00e7\u00e3o assim. Busca-se aqui um compromisso entre o simples e o completo. Para ampliar a formula\u00e7\u00e3o para espa\u00e7os de ordem mais alta, al\u00e9m de obter as express\u00f5es para os tr\u00eas espa\u00e7os em quest\u00e3o (press\u00f5es no bloco, press\u00f5es no contorno e vaz\u00f5es no contorno), ser\u00e1 muito \u00fatil ver a se\u00e7\u00e3o 3.4 do volume II da cole\u00e7\u00e3o de Oden [1984], principalmente as p\u00e1ginas 143 e 144, onde s\u00e3o mostradas as integrais que ter\u00e3o que ser calculadas.\nA aproxima\u00e7\u00e3o utilizada aqui \u00e9 chamada de formula\u00e7\u00e3o mista-h\u00edbrida dual ou elemento finito misto-h\u00edbrido dual (dual mixed-hybrid elemenf). Nessa formula\u00e7\u00e3o, as aproxima\u00e7\u00f5es da press\u00e3o no elemento, da press\u00e3o no contorno do elemento e da derivada da press\u00e3o no contorno do elemento s\u00e3o feitas em separado. Em contraste, na formula\u00e7\u00e3o h\u00edbrida primai (primai hybrid elemenf), n\u00e3o h\u00e1 interpola\u00e7\u00e3o em separado da press\u00e3o no contorno. Nesse caso, a press\u00e3o no contorno \u00e9 conseq\u00fc\u00eancia da aproxima\u00e7\u00e3o da press\u00e3o em todo o bloco, como na t\u00e9cnica de elementos finitos tradicionais. A formula\u00e7\u00e3o dual \u00e9 mais empregada do que a aproxima\u00e7\u00e3o primai.\n3.4.1-\tComportamento do Material\nParte-se da equa\u00e7\u00e3o de comportamento linear do meio poroso, ou lei de Darcy:\nv(x) = -KV(P(x))\t(3.9)\nEfetuando a pondera\u00e7\u00e3o por w, , vem:\nv.w,=-\u00e2:(vP.w()\t(3.10)\nIntegrando sobre um elemento Q., tem-se:\nfn^w,=-fn\u00a3(vP.w,.)\t(3.11)\nTem-se tamb\u00e9m:\nV.(PWj)= (VP).wi +P(V.Wi)\t(3.12)\nOu seja,\n-(VP).Wj = P(V.Wi)- V.(Pw\u00ed)\t(3.13)\nSubstituindo (3.13) em (3.11), chega-se a:\nK''(3.14)\nAplicando o teorema da diverg\u00eancia de Gauss para a \u00faltima integral, vem:\n(3.15)\no que reduz as exig\u00eancias de derivabilidade em rela\u00e7\u00e3o a fun\u00e7\u00e3o P(x) ,\nTrabalhando com a integral de superf\u00edcie:\n(3.16)\nIv.w, = p[i\t.H;)\nJ\nK-' (/\u2022*, =?((3.17)\nj\nK-'^v.w^P^.^-T^\t(3.18)\ne lembrando que:\nv(x) = \u00bfLv . W .(x) ;\n>1\neque Jn(V.w\u00a1)=l;\n-se a:\n# FACES\n(3.19)\nVariando agora o \u00edndice i de 1 at\u00e9 (# FACES), chega-se a um sistema que ser\u00e1 chamado de equa\u00e7\u00e3o de consist\u00eancia. Em nota\u00e7\u00e3o matricial:\n[\u00caKFjfr} = K[P- TP}\t(3.20)\nonde os elementos ekf(ij) s\u00e3o iguais a:\netf(i,j)= \u00bf Wj . w,\t(3.21)\nNo p\u00f3s-processamento, a partir dos valores de TP, calcula-se a press\u00e3o m\u00e9dia no bloco P e, em um segundo passo, calculam-se os fluxos por meio da equa\u00e7\u00e3o de consist\u00eancia na forma:\n{v}= \u00a3[\u00a3\u00a3\u00a3\u25a0]\u25a0' {?-TP}\t(3.22)\n3.4.2\t- Equa\u00e7\u00e3o de Equil\u00edbrio ou Lei de Conserva\u00e7\u00e3o\nEqua\u00e7\u00f5es diferenciais parciais el\u00edpticas t\u00edpicas s\u00e3o:\nv ,(Vu) = V 2u = 0\n-V .(V u) - -V 2u = f\n-kV2u+K2u = f\nV 2u + k (E - V )u = 0\n............ Equa\u00e7\u00e3o\tde\tLaplace\n........... Equa\u00e7\u00e3o de Poisson\n\t Equa\u00e7\u00e3o\tde\tHelmholtz ......................... Equa\u00e7\u00e3o.de\tSchrodinger\nAs leis constitutivas s\u00e3o, geralmente, equa\u00e7\u00f5es de comportamento linear muito semelhantes, tais como a lei de Darcy no fluxo em meios porosos, a lei de Hooke em elasticidade, a lei de Fourier nos processos de transfer\u00eancia de calor, a lei de Stokes no fluxo em regime laminar e a lei de Coulomb na eletricidade.\nAssim, pelo menos para a formula\u00e7\u00e3o do programa em 2D, ser\u00e1 considerada a seguinte equa\u00e7\u00e3o de equil\u00edbrio:\nV ,V + bP = f\t(3.23)\nEssa rela\u00e7\u00e3o \u00e9 mais geral do que a equa\u00e7\u00e3o V. v ~ 0 usada para simular o fluxo monof\u00e1sico incompress\u00edvel em meios heterog\u00eaneos, necess\u00e1ria para o c\u00e1lculo da permeabilidade equivalente. Resolveu-se, por\u00e9m, trabalhar com esta equa\u00e7\u00e3o por tr\u00eas raz\u00f5es:\n\u2022\tos termos b e f n\u00e3o dificultaram a formula\u00e7\u00e3o, eles foram praticamente carregados ao longo das manipula\u00e7\u00f5es alg\u00e9bricas;\n\u2022\ta equa\u00e7\u00e3o de equil\u00edbrio ficou bastante geral, e o programa poder\u00e1 ser estendido para outras aplica\u00e7\u00f5es;\n\u2022\t\u00e9 poss\u00edvel trabalhar com casos de valida\u00e7\u00e3o mais interessantes, como o que ser\u00e1 mostrado na Se\u00e7\u00e3o 4.1.4.\nA forma de trabalhar a equa\u00e7\u00e3o de equil\u00edbrio \u00e9 diferente do que \u00e9 feito nos m\u00e9todos de elementos finitos tradicionais. Adota-se uma formula\u00e7\u00e3o variacional sem, contudo, haver a multiplica\u00e7\u00e3o por uma fun\u00e7\u00e3o de pondera\u00e7\u00e3o:\n\u00ednV.v+(\u00f4P=V\t(3-24)\n(#FACES r\t_ f\tf\n\u00a3v, JnV.w,J + PJn&amp; = Jn/\t(3.25)\nRelembrando que\t(V. w \u00a1) = 1\ne chamando\nfica-se com:\nUFACES \\\n\u00bfV\u00ed ]+PB=F\t(3.26)\nM 7\nEm nota\u00e7\u00e3o matricial, trabalha-se com um vetor {e}, cuja caracter\u00edstica \u00e9 possuir todas\nas componentes unit\u00e1rias, para substituir o sinal de somat\u00f3rio.\nPor enquanto:\n{e}T {v}= F-P B\nPor\u00e9m, de (3.22):\n{e}r {v}= F-P B = K{e}r [EKF]~l {P-TP}\nOu:\nF-PB^ K{e}r [EKFT P{e}-K{e}r [\u00a3&amp;fF {TP}\nLevando a:\n{e}+s)= F + K{e}T\\EKF}~' {TP}\n(3.27)\n(3.28)\n(3.29)\n(3.30)\nDesta forma, elimina-se a vari\u00e1vel fluxo, ficando com uma equa\u00e7\u00e3o de equil\u00edbrio apenas nas vari\u00e1veis de press\u00e3o. Em rela\u00e7\u00e3o \u00e0 nota\u00e7\u00e3o empregada no artigo de Chavent e Roberts [1991, p.340], valem as seguintes equival\u00eancias:\n[F\u00c177] 1 {e}= Vetor de componentes a K A\n{e}r [EXF]1 {e} = a K = Soma de todos os elementos de [E\u00c177]\u201d1\n(3.31)\n(3.32)\n3.4.3\t- A Continuidade do Fluxo\nNas formula\u00e7\u00f5es tradicionais de EF, a continuidade da vari\u00e1vel de estado e dos fluxos entre elementos vizinhos \u00e9 garantida automaticamente pela constru\u00e7\u00e3o do espa\u00e7o de aproxima\u00e7\u00e3o (exceto no caso das fun\u00e7\u00f5es de forma lineares, as mais simples, quando n\u00e3o h\u00e1 continuidade do fluxo na face). Exemplificando, para o caso dos polin\u00f3mios de Lagrange, por um lado (interface) com dois n\u00f3s, deve passar uma fun\u00e7\u00e3o linear, e, por um lado com tr\u00eas n\u00f3s, deve passar uma fun\u00e7\u00e3o quadr\u00e1tica. H\u00e1 unicidade do valor da vari\u00e1vel nos n\u00f3s, pois \u00e9 o valor obtido pela solu\u00e7\u00e3o do sistema linear, e existe uma \u00fanica reta passando por dois pontos distintos, e uma \u00fanica curva de segundo grau que passa por tr\u00eas pontos. Onde n\u00e3o houver continuidade do fluxo, \u00e9 por que se trata de uma face com a aplica\u00e7\u00e3o da chamada condi\u00e7\u00e3o de salto n\u00e3o-homog\u00eanea (jump condition), como um po\u00e7o em um reservat\u00f3rio. Tamb\u00e9m na formula\u00e7\u00e3o mista, os espa\u00e7os de aproxima\u00e7\u00e3o do fluxo s\u00e3o constru\u00eddos de forma a garantir automaticamente a continuidade do fluxo entre elementos vizinhos.\nEm contraste, na formula\u00e7\u00e3o h\u00edbrida, o espa\u00e7o de aproxima\u00e7\u00e3o R To n\u00e3o conserva implicitamente o fluxo: em qualquer face interna, o fluxo associado aos dois elementos vizinhos \u00e9 definido sempre na dire\u00e7\u00e3o da sa\u00edda, n\u00e3o h\u00e1 entrada de fluxo na base do espa\u00e7o de\naproxima\u00e7\u00e3o. Esta constru\u00e7\u00e3o facilita a montagem da matriz elementar, e diminui a possibilidade de erros na descri\u00e7\u00e3o da malha. A continuidade do fluxo \u00e9 garantida explicitamente na formula\u00e7\u00e3o h\u00edbrida. Para cada face, \u00e9 criada a equa\u00e7\u00e3o:\nNORMAL FACE #i\t.\tNORMAL LACE #i\t_ rj\nV ELEMENTO DE UM LADO\tV ELEMENTO DO OUTRO LADO ~ V\tUJJ/\nEsta equa\u00e7\u00e3o \u00e9 a \u00fanica que vai montar todo o sistema linear, ao contr\u00e1rio da formula\u00e7\u00e3o mista, onde h\u00e1 dois tipos diferentes de equa\u00e7\u00e3o: a equa\u00e7\u00e3o da press\u00e3o e a equa\u00e7\u00e3o do fluxo.\nEm EFH, a montagem da matriz global \u00e9 feita pela contribui\u00e7\u00e3o individual e independente de cada elemento. Cada elemento vai montar sua pr\u00f3pria parte na equa\u00e7\u00e3o de continuidade, que \u00e9 simplesmente:\n}= 0\t(3.34)\nSe, em uma dada linha da matriz global, nenhum outro elemento acrescentar uma contribui\u00e7\u00e3o, \u00e9 por que aquela face est\u00e1 no contorno do dom\u00ednio. Se, depois de montada toda a matriz global, n\u00e3o for especificada uma condi\u00e7\u00e3o de contorno para esta face, o PVC estar\u00e1 sendo resolvido com vaz\u00e3o nula por esta face. Ou seja, h\u00e1 um default', considerar barreira\nimperme\u00e1vel se n\u00e3o for alimentada nenhuma condi\u00e7\u00e3o de contorno.\n{v}= \u00a3[\u00a3\u00c1Fr' {?-TP}= 0\t(3.35)\nK [P\u00c1PT' {e} P = K [EKF]~1 {TP}\t(3.36)\nFazendo:\naXI\u00ae =(k^t lEKF^' W+B)\tO-37)\nem (3.30), fica-se com:\n?(a \u00abSL\u00ab)= F + K{e}T [EKF]-' {TP}\t(3.38)\nA elimina\u00e7\u00e3o de P \u00e9 feita substituindo a equa\u00e7\u00e3o (3.38) na (3.36):\nK[\u00a3KFT' te}(F + K {e}T [S\u00c2F]'1 {TP})= kQC^^EKF}-' {TP}\t(3.39)\nRearrumando os termos, chega-se finalmente em:\nK[EKF]~'\nK2\na FATOR\n71 ESCALAR\n[EKFY' {e}{e}T[EKF]\"' {TP} = J\n.fator AEKF]-'{e}\nESCALAR\n....................................................................             (3.40)\nRelativamente \u00e0s defini\u00e7\u00f5es do artigo de Chavent e Roberts[1991, p. 341, eq. 126-\n128], t\u00eam-se as seguintes correspond\u00eancias:\n(k[EKF] \u2019)= Matriz de massa da formula\u00e7\u00e3o MH\nK2\n..[EKFV {e}{e}T[EKF]~l\nESCALAR\t7\n(3.41)\n(342)\nMatriz de rigidez MH\nVetar FAUH\nESCALAR\n(3.43)\nNa Equa\u00e7\u00e3o 3.40, a matriz [E\u00c277]\u20191 est\u00e1 multiplicando todos os tr\u00eas termos pela esquerda, o que poderia sugerir uma simplifica\u00e7\u00e3o da equa\u00e7\u00e3o. Todavia, da forma em que est\u00e1, a equa\u00e7\u00e3o possui a vantagem de apresentar o dimensional de fluxo (vaz\u00e3o). Assim, fica simples aplicar condi\u00e7\u00f5es de contorno de Neumann, dispensando realizar uma integral de superf\u00edcie, diferentemente do que ocorre em EF tradicionais. A a\u00e7\u00e3o de aplicar as condi\u00e7\u00f5es de contorno de Neumann \u00e9 simbolizada pela subtra\u00e7\u00e3o do vetor G, como aparece em Chavent e Roberts [1991, p. 341, eq. 129].\n3.5\t- Tratamento Tensorial\nO caso mais geral de simula\u00e7\u00e3o de fluxo para o c\u00e1lculo da permeabilidade equivalente inclui a representa\u00e7\u00e3o tensorial completa para a permeabilidade. Nesse estudo \u00e9 feita a aplica\u00e7\u00e3o inicial de uma formula\u00e7\u00e3o EFH, ainda pouco difundida e conhecida, e os programas s\u00e3o constru\u00eddos praticamente para meios heterog\u00eaneos isotr\u00f3picos. Apresenta-se a seguir como seria a extens\u00e3o para o tratamento tensorial.\nEm Arbogast e outros [1995] pode-se encontrar o desenvolvimento da formula\u00e7\u00e3o variacional, que depois ser\u00e1 transformada em esquema DF. A base do tratamento tensorial \u00e9 a\nlei de Darcy\nv = ~-KVP\n(3.44)\ns\u00f3 que agora\nv \u201d - [X] VP com\n(3.45)\nComo a permeabilidade \u00e9 an\u00e1loga \u00e0 transmissibilidade, sua inversa \u00e9 uma forma de resist\u00eancia e, desse modo, pode-se definir\nUl = \u00a1XF1 -\npara\nd~\txx yy\nr\t= k i d\nXX\tyy\n\t= k / d\nyy\tXX\nr\t= \u2014 kri, / d\nxy\txy\n\t= -kfJd\nMudando de lado:\n(3.46)\n(3.47)\n(3.48)\nW'v = [/f]v =-VP\nPonderando:\n= -VP.\nO lado direito continua o mesmo da formula\u00e7\u00e3o isotr\u00f3pica, e vai resultar no vetor\n<jp - TP |. O lado esquerdo, substituindo a velocidade pela sua expans\u00e3o nas fun\u00e7\u00f5es de\nforma, toma-se\nE v, (p]wy) w,\n(3.49)\nque vai dar origem a integrandos de forma geral\nrw.w.+rw.w.+rww.-l-rw.w.\t(3 50)\nr xx v xj yxi .vy yj xi yx xj yi yy yj yi\nJ\u00e1 \u00e9 poss\u00edvel perceber que a matriz elementar de fluxo vai perder todo o seu padr\u00e3o de esparsidade, o que vai aumentar o esfor\u00e7o computacional para a sua invers\u00e3o. Essa perda de esparsidade deve ser uma motiva\u00e7\u00e3o para que, quando da utiliza\u00e7\u00e3o da representa\u00e7\u00e3o tensorial, empregue-se conjuntamente malhas deformadas. No caso do espa\u00e7o RTQ, a regra de quadratura exata em uso possui folga para trabalhar com quadrados deformados linearmente.\nUma outra transforma\u00e7\u00e3o importante, al\u00e9m da transforma\u00e7\u00e3o de Piola, \u00e9 a equa\u00e7\u00e3o\n(2.5)\tde Arbogast [1995], que mostra como modificar o tensor de permeabilidades em fun\u00e7\u00e3o da mudan\u00e7a nos eixos coordenados de refer\u00eancia:\n[k]=j[jr'w[jyr (3.51)\nA literatura em geral n\u00e3o cita como problema a formula\u00e7\u00e3o te\u00f3rica para a representa\u00e7\u00e3o tensorial. Os problemas aparecem na fase preliminar (caracterizar os valores tensoriais de uma regi\u00e3o do reservat\u00f3rio) e no processamento (com o aumento do esfor\u00e7o\ncomputacional requerido). Mas, percebe-se uma tend\u00eancia em utilizar cada vez mais a descri\u00e7\u00e3o tensorial.\nArbogast e seu grupo desenvolveram um programa para a simula\u00e7\u00e3o no dom\u00ednio computacional, que \u00e9 retangular. \u00c9 uma forma que reduz o esfor\u00e7o computacional, mas cujo entendimento operacional exigiria estudos al\u00e9m do escopo definido para esta tese. A id\u00e9ia seria elaborar um programa tensorial no dom\u00ednio real deformado (como \u00e9 HYBRID2D), inicialmente considerando quadril\u00e1teros e tri\u00e2ngulos em 2D, e depois passar para a vers\u00e3o 3D.\nA formula\u00e7\u00e3o EFH tensorial continua com sete e onze entradas n\u00e3o-nulas por linha, 2D e 3D respectivamente, da matriz do sistema linear - enquanto que a formula\u00e7\u00e3o DF tensorial passa para nove e dezenove pontos. O sistema linear EFH, principalmente o 3D, vai se tomar mais f\u00e1cil de resolver do que o correspondente sistema DF. Quanto mais a modelagem matem\u00e1tica vai sendo complicada (malhas deformadas, representa\u00e7\u00e3o tensorial, fluxo bif\u00e1sico), mais favor\u00e1vel vai ficando a posi\u00e7\u00e3o da formula\u00e7\u00e3o EFH, relativamente a outras formula\u00e7\u00f5es menos flex\u00edveis.\nQuanto \u00e0 simetria do tensor de permeabilidade, apesar de existirem defensores de que ele pode ser assim\u00e9trico, acreditamos que - a exemplo do tensor das constantes el\u00e1sticas, onde condi\u00e7\u00f5es de equil\u00edbrio implicam na sua simetria - \u00e9 mais razo\u00e1vel trabalhar com um tensor sim\u00e9trico.\nCap\u00edtulo 4 - Os Programas de Computador:\nHybrid2D e Hybrid3D\nForam constru\u00eddos dois programas para c\u00e1lculo da permeabilidade equivalente em meios heterog\u00eaneos usando o m\u00e9todo dos elementos finitos h\u00edbridos: Hybrid2D e Hybrid3D. Ambos os programas calculam o campo de press\u00f5es e velocidades em um meio heterog\u00eaneo submetido a condi\u00e7\u00f5es de contorno do tipo imperme\u00e1vel para, depois, mediante um c\u00e1lculo simples, chegarem a permeabilidade equivalente do sistema, seguindo os m\u00e9todos que foram discutidos nos cap\u00edtulos anteriores. Hybrid2D trata problemas em 2D, usando elementos triangulares ou retangulares sujeitos a certas deforma\u00e7\u00f5es. Hybrid3D trata problemas em 3D, mas \u00e9 limitado a malhas mais regulares.\nEste cap\u00edtulo descreve as principais caracter\u00edsticas desses dois programas, discutindo tamb\u00e9m alguns exemplos simples de valida\u00e7\u00e3o. Fica para o cap\u00edtulo seguinte uma discuss\u00e3o mais completa do desempenho desses programas, considerando uma variedade maior de casos e compara\u00e7\u00f5es com programas concorrentes baseados em diferen\u00e7as finitas e elementos finitos tradicionais.\n4.1\t- O Programa HYBRID2D\n4.1.1\t- Estrutura Geral\nA inten\u00e7\u00e3o na elabora\u00e7\u00e3o do programa em 2D foi obter-se um c\u00f3digo bastante geral para o problema em quest\u00e3o, incluindo a possibilidade de tratar malhas irregulares, formadas por tri\u00e2ngulos de qualquer tipo e por ret\u00e2ngulos orientados em quaisquer dire\u00e7\u00f5es.\nUm programa gen\u00e9rico de elementos finitos \u00e9 formado por tr\u00eas m\u00f3dulos principais:\n\u00ab PR\u00c9-PROCESSAMENTO: gera\u00e7\u00e3o (manual ou autom\u00e1tica) da malha; defini\u00e7\u00e3o das propriedades f\u00edsicas dos elementos; identifica\u00e7\u00e3o da ordem - n\u00famero de pontos ~ de integra\u00e7\u00e3o, entre outras a\u00e7\u00f5es.\n\u00ae PROCESSAMENTO: c\u00e1lculo das matrizes locais, elemento a elemento; montagem da matriz de rigidez global de acordo com a metodologia de indexa\u00e7\u00e3o de matriz esparsa a ser utilizada; montagem da matriz de carga global; resolu\u00e7\u00e3o do sistema de equa\u00e7\u00f5es lineares resultante por algum m\u00f3dulo de solver, direto ou iterativo.\n\u2022 P\u00d3S-PROCESSAMENTO: prepara\u00e7\u00e3o final e impress\u00e3o dos resultados. Na formula\u00e7\u00e3o h\u00edbrida - onde a solu\u00e7\u00e3o do sistema linear corresponde \u00e0s press\u00f5es sobre as fronteiras de cada bloco - \u00e9 no p\u00f3s-processamento que ser\u00e3o calculadas as vari\u00e1veis de maior interesse: a press\u00e3o m\u00e9dia nos blocos (elementos), os fluxos entre os blocos, a permeabilidade equivalente atrav\u00e9s do fluxo normal a uma certa superf\u00edcie e, eventualmente, o p\u00f3s-processamento n\u00e3o-conforme O ( h2 ) da press\u00e3o no bloco (que n\u00e3o est\u00e1 implementado no programas HYBRID2D e HYBRID3D).\nA estrutura geral de HYBRID2D \u00e9 semelhante a do programa descrito em Oden [1981], livro-texto do curso de An\u00e1lise Num\u00e9rica na Unicamp. O nome das vari\u00e1veis s\u00e3o mnem\u00f3nicos sugestivos (em ingl\u00eas) com seis caracteres, facilitando a compreens\u00e3o e as futuras modifica\u00e7\u00f5es. N\u00e3o foram utilizados nomes com mais de seis caracteres para manter o c\u00f3digo o mais port\u00e1til poss\u00edvel entre os diferentes compiladores FORTRAN em microcomputadores e em esta\u00e7\u00f5es UNIX.\n4.1.2\t- Dois Tipos de Elementos e Suas Deforma\u00e7\u00f5es\nUma fase inicial que requer bastante esfor\u00e7o em um projeto global de simula\u00e7\u00e3o \u00e9 a adequada descri\u00e7\u00e3o do dom\u00ednio e de suas propriedades f\u00edsicas - isso \u00e9, a fase da gera\u00e7\u00e3o da malha. Em geral, a utiliza\u00e7\u00e3o de elementos deformados \u00e9 um recurso vantajoso para uma representa\u00e7\u00e3o geom\u00e9trica melhor e mais flex\u00edvel, evitando o excessivo refinamento de uma malha ortogonal pr\u00f3ximo das singularidades e das interfaces entre diferentes sub-dom\u00ednios.\nA Reprodu\u00e7\u00e3o 1 ilustra uma situa\u00e7\u00e3o, constru\u00edda a partir de dados reais de permeabilidade medidas em um afloramento, onde a possibilidade de utiliza\u00e7\u00e3o de elementos deformados constitui-se em uma vantagem evidente.\nReprodu\u00e7\u00e3o 1 - Trecho (comprimento e altura aproximadamente iguais a 50 m e 7 m) do afloramento A\u00e7u, destacando as varia\u00e7\u00f5es de permeabilidade (0.1 a 500 mD) interpoladas a partir de medidas de miniperme\u00e2metro. As cores mais escuras indicam permeabilidades muito baixas.\n(Figura originalmente em Siqueira e outros [1996])\nA compreens\u00e3o da sistem\u00e1tica de trabalho com a transforma\u00e7\u00e3o de coordenadas, com a matriz Jacobiana e com fun\u00e7\u00f5es impl\u00edcitas, \u00e9 um requisito b\u00e1sico para a evolu\u00e7\u00e3o rumo a simula\u00e7\u00f5es mais elaboradas.\nNo caso, est\u00e1-se aplicando o espa\u00e7o de Raviart-Thomas de mais baixa ordem, e s\u00f3 s\u00e3o feitos c\u00e1lculos de produtos cruzados das fun\u00e7\u00f5es de forma que interpolam a velocidade. Nosso objetivo era trabalhar com elementos deformados linearmente, o que j\u00e1 confere uma enorme flexibilidade \u00e0 gera\u00e7\u00e3o da malha. Para efetuar o mapeamento do elemento mestre no elemento deformado, foram usadas as fun\u00e7\u00f5es de forma (polin\u00f3mios) de Lagrange lineares no\ntri\u00e2ngulo e bilineares no quadrado. A combina\u00e7\u00e3o do espa\u00e7o R To com o de Lagrange foi formulada segundo uma certa intui\u00e7\u00e3o. Posteriormente, verificamos, com o uso da transforma\u00e7\u00e3o de Piola, que a sistem\u00e1tica empregada estava correta.\nO programa HYBRID2D permite trabalhar com qualquer tri\u00e2ngulo deformado linearmente e com ret\u00e2ngulos rotacionados de qualquer \u00e2ngulo em rela\u00e7\u00e3o aos eixos cartesianos globais.\nA formula\u00e7\u00e3o para ret\u00e2ngulos \u00e9 mais simples nesse caso, a matriz elementar 4x4 fica reduzida a dois blocos 2x2 ap\u00f3s duas permuta\u00e7\u00f5es: a da linha 2 com a linha 3 e a da coluna 2 com tamb\u00e9m a coluna 3. A invers\u00e3o da matriz [EKF] resume-se \u00e0 invers\u00e3o de duas matrizes 2x2, o que \u00e9 bem mais f\u00e1cil. Os c\u00e1lculos de mapeamento e das integrais dos produtos escalares que est\u00e3o implementados servem para um elemento quadrilateral qualquer. O m\u00e9todo pode ser estendido para incluir a invers\u00e3o de uma matriz 4x4 cheia. Nesse caso, o c\u00e1lculo dos elementos da matriz inversa seria implementado por f\u00f3rmulas exatas, derivadas a partir da regra de Cramer para a solu\u00e7\u00e3o anal\u00edtica de sistemas de equa\u00e7\u00f5es lineares.\n4.1.3\t- Regra de Integra\u00e7\u00e3o\nOs m\u00e9todos de elementos finitos seguem duas sistem\u00e1ticas gerais:\n\u00ae admitir a expans\u00e3o da solu\u00e7\u00e3o da equa\u00e7\u00e3o diferencial em fun\u00e7\u00f5es definidas, n\u00e3o nulas, apenas ao redor de elementos vizinhos (piece-wise tria! functions). As fun\u00e7\u00f5es de expans\u00e3o s\u00e3o geralmente polin\u00f3mios, como os de Lagrange, para reduzir o esfor\u00e7o computacional, e este processo \u00e9 chamado de determina\u00e7\u00e3o do espa\u00e7o de aproxima\u00e7\u00e3o;\n\u2022 multiplicar (ponderar) a equa\u00e7\u00e3o diferencial por uma fun\u00e7\u00e3o de teste (weight functiori) bem comportada e determinar uma formula\u00e7\u00e3o integral (variacional), por meio da integra\u00e7\u00e3o por partes ou da aplica\u00e7\u00e3o do teorema da diverg\u00eancia de Gauss, de modo a balancear os requisitos de suavidade entre as fun\u00e7\u00f5es de expans\u00e3o e as de pondera\u00e7\u00e3o. Essa formula\u00e7\u00e3o variacional \u00e9 chamada de forma fraca do problema de valor de contorno (PVC).\nNo m\u00e9todo de Galerkin, as fun\u00e7\u00f5es de expans\u00e3o s\u00e3o as mesmas fun\u00e7\u00f5es de pondera\u00e7\u00e3o e, desse modo, podemos nos referir a elas simplesmente como fun\u00e7\u00f5es de base (basis\nfunctions) do espa\u00e7o de aproxima\u00e7\u00e3o. Outra denomina\u00e7\u00e3o comum \u00e9 a de fun\u00e7\u00f5es de forma (shape functions).\nA substitui\u00e7\u00e3o da expans\u00e3o em s\u00e9rie de fun\u00e7\u00f5es na formula\u00e7\u00e3o fraca leva a um sistema linear para a determina\u00e7\u00e3o dos coeficientes da expans\u00e3o. Com os coeficientes calculados, temos a solu\u00e7\u00e3o do PVC. Entretanto, os termos que multiplicam os coeficientes (as inc\u00f3gnitas do sistema linear) s\u00e3o integrais definidas da soma e do produto das diversas fun\u00e7\u00f5es de base e suas derivadas. O m\u00e9todo EF calcula essas integrais, dando um valor num\u00e9rico a elas, para permitir que se resolva o sistema linear.\nAssim, o c\u00e1lculo de integrais tem um papel muito importante nos m\u00e9todos de elementos finitos. Dentre as v\u00e1rias formas de calcular integrais, um processo muito aplicado em EF \u00e9 a quadratura: o valor da integral \u00e9 aproximado pela soma ponderada de um certo n\u00famero de valores do integrando, em pontos determinados do dom\u00ednio de integra\u00e7\u00e3o, onde os pesos est\u00e3o relacionados com o grau de import\u00e2ncia (influ\u00eancia) desses pontos de avalia\u00e7\u00e3o do integrando. H\u00e1 v\u00e1rias regras de quadratura, sendo mais comuns as de Gauss-Legendre e de Gauss-Lobatto. O valor da integral \u00e9 o valor calculado pela quadratura mais um erro de quadratura, que, no caso da integra\u00e7\u00e3o de polin\u00f3mios, pode ser zero escolhendo-se um n\u00famero suficiente de pontos de avalia\u00e7\u00e3o - a ordem da quadratura.\nI\nX / (*() * \u00ae\nl\ndQ.\n+ Erro s Quadratura\nH\u00e1 tamb\u00e9m t\u00e9cnicas de integra\u00e7\u00e3o reduzida, que podem levar \u00e0 determina\u00e7\u00e3o aproximada dos coeficientes pela da utiliza\u00e7\u00e3o proposital de um n\u00famero insuficiente de pontos de integra\u00e7\u00e3o. Chavent e Roberts [1991] e Arbogast e outros [1995] mostram como aplicar regras de quadratura reduzidas para, a partir da formula\u00e7\u00e3o de EFH, chegar a formula\u00e7\u00f5es DF de cinco (meios isotr\u00f3picos) e nove pontos (tratamento tensorial), em 2D, e de dezenove pontos (tratamento tensorial), em 3D.\nA literatura cita que, nos m\u00e9todos espectrais (expans\u00e3o em um n\u00famero finito de auto-fun\u00e7\u00f5es), a quadratura de Gauss-Lobatto \u00e9 a mais empregada. No problema em quest\u00e3o, as propriedades f\u00edsicas s\u00e3o admitidas constantes em todo o elemento, e o espa\u00e7o de aproxima\u00e7\u00e3o de Raviart-Thomas \u00e9 polinomial. Logo n\u00e3o h\u00e1 dificuldade em avaliar os integrandos em pontos interiores do elemento.\nDesse modo, em HYBRID2D utiliza-se uma integra\u00e7\u00e3o exata pela quadratura de Gauss-Legendre. Essa \u00e9 a regra de quadratura que necessita do menor n\u00famero de pontos para a integra\u00e7\u00e3o sem erro de um polin\u00f3mio de um certo grau.\n4.1.4\t- Valida\u00e7\u00e3o: Caso Anal\u00edtico e com Diverg\u00eancia (f = -4)\nEsse exemplo anal\u00edtico e com diverg\u00eancia \u00e9 origin\u00e1rio de testes com um c\u00f3digo EF 2D, com fun\u00e7\u00f5es de forma quadr\u00e1ticas em tri\u00e2ngulos e biquadr\u00e1ticas em quadrados. A aproxima\u00e7\u00e3o EF para esse caso \u00e9 exata. A id\u00e9ia era ent\u00e3o verificar o comportamento do c\u00f3digo HYBRID2D, o que acabou gerando, pela observa\u00e7\u00e3o dos resultados, mais uma importante verifica\u00e7\u00e3o quanto \u00e0 qualidade - e potencialidades - da aproxima\u00e7\u00e3o EFH.\nVamos definir um campo de press\u00f5es P=x2 +x+j>2 + >+C ,\nK=A\natendendo a seguinte EDP:\t- V. (VP) = - 4 , ou seja i b = 0\nl/=-4\nO dom\u00ednio do problema \u00e9 retangular, discretizado por quadrados unit\u00e1rios.\nO campo vetorial de fluxo \u00e9 dado por: v = ~KVP = (~2x\u2122 l;-2y-1)\nOs fluxos normais s\u00e3o mostrados na Figura 4.1.\nPara resolver o PVC, consideram-se condi\u00e7\u00f5es essenciais -.de Dirichlet - nas faces verticais e condi\u00e7\u00f5es naturais - de Neumann - nas faces horizontais, j\u00e1 em analogia ao que \u00e9 feito em simula\u00e7\u00f5es para mudan\u00e7a de escala.\nAs express\u00f5es exatas para as press\u00f5es m\u00e9dias de interesse s\u00e3o facilmente determinadas:\n\u2014FACE\t, ,.2\t,\t,\t, (AP)\nPvERTlCAL~~\t~~XCTE+XCTE+y M\u00c9DIO^y M\u00c8DIO + ^+\nfas\n\u2014\t_\t>3\t\u201e\t,\t(Ay)2 ; (Ar)2\nP BLOCO ~\t~ X M\u00c9DIO + X M\u00c9DIO + -FM\u00c9DIO + PM\u00c9DIO +\t1\n(4-2)\n(4.3)\n-2*B-1\nFigura 4.1 - Caracter\u00edsticas gerais do exemplo anal\u00edtico e com divergencia\nPara facilitar, consideram-se as condi\u00e7\u00f5es de Dirichlet nas duas faces verticais como sendo comente\n~~~~FACE\t2\t2\nPVERTICAL ~~\t%CTE M\u00c9DIO M\u00c9DIO\n(Ay)\t1\no que \u00e9 equivalente a fazer C=~\u2014\n12\t12\n=\u2122O.O8333...\n(4.4)\n(4.5)\nO dom\u00ednio para os testes foi A=15 e B=6.\nA simula\u00e7\u00e3o mostrou que todos os tra\u00e7os de press\u00e3o na face foram calculados\nexatamente, assim como todos os fluxos. Quando for de interesse, o programa pode imprimir\numa tabela mostrando as press\u00f5es e fluxos elemento a elemento. Em todos os elementos, o\nsomat\u00f3rio dos fluxos \u00e9 igual a -4, que \u00e9 a diverg\u00eancia constante do campo de press\u00f5es idealizado. O uso desse fator f pode ser muito \u00fatil na simula\u00e7\u00e3o de reservat\u00f3rios para fazer\numa macro-representa\u00e7\u00e3o dos po\u00e7os. Um po\u00e7o produtor dentro de um bloco \u00e9 representado como um fator f negativo - correspondente a vaz\u00e3o de produ\u00e7\u00e3o - naquele bloco, um po\u00e7o\ninjetor dentro de um outro bloco \u00e9 representado como um fator f positivo e blocos sem po\u00e7os em seu interior apresentam um fator f nulo.\nDiscute-se, a seguir, a possibilidade de fazer um p\u00f3s-processamento O ( h2 ) na\npress\u00e3o.\nObservou-se, na tabela citada acima, que todas as press\u00f5es m\u00e9dias nos blocos terminavam com o algarismo 8 na segunda casa decimal. Foi ent\u00e3o que foram deduzidas as express\u00f5es exatas para as press\u00f5es m\u00e9dias de interesse. Verificou-se que a press\u00e3o m\u00e9dia no bloco exata deveria realmente apresentar o fator (Ax)2 712 (= 0.08333....), que n\u00e3o foi cancelado pela constante de integra\u00e7\u00e3o C, como foi o fator (\u00e2yJ /12. Ou seja, com fun\u00e7\u00f5es de forma lineares (aproximando a derivada), a formula\u00e7\u00e3o EFH resolve exatamente um problema quadr\u00e1tico.\nChavent e Roberts [1991] comentam a possibilidade de um p\u00f3s-processamento n\u00e3o-conforme para obter um mapa de press\u00f5es com O ( h 2 ). Agora vemos que isso \u00e9 de fato poss\u00edvel, pois foram calculados tra\u00e7os de press\u00e3o (press\u00f5es m\u00e9dias nas faces) exatos e as press\u00f5es m\u00e9dias nos blocos tamb\u00e9m s\u00e3o exatas. O interesse nesse mapa O ( h 2 ) \u00e9 para fazer uma verifica\u00e7\u00e3o no caso de haver um acompanhamento de press\u00e3o em pontos de reservat\u00f3rio.\nA rela\u00e7\u00e3o entre o n\u00famero total de vari\u00e1veis pelo n\u00famero total de elementos quadrados na formula\u00e7\u00e3o EF com fun\u00e7\u00f5es de forma biquadr\u00e1ticas tende assintoticamente para tr\u00eas, e nessa formula\u00e7\u00e3o EFH RT\u00dc essa rela\u00e7\u00e3o tende para apenas dois. Ent\u00e3o, a formula\u00e7\u00e3o h\u00edbrida s\u00f3 apresenta vantagens sobre a formula\u00e7\u00e3o EF com fun\u00e7\u00f5es de forma biquadr\u00e1ticas.\n4.2\t\u00bbO Programa HYBRID3D\n4.2.1\t- Descri\u00e7\u00e3o Geral e Fun\u00e7\u00f5es de Forma 3D\nO programa HYBRID3D \u00e9 semelhante, sob muitos aspectos, ao programa HYBRID2D. Ser\u00e3o destacadas aqui principalmente as caracter\u00edsticas que os distinguem.\nNa elabora\u00e7\u00e3o do programa em 3D, HYBRID3D, projetou-se uma vers\u00e3o para malha regular, mais integrada com o m\u00f3dulo EFFPERM da HOMLIB e de execu\u00e7\u00e3o mais r\u00e1pida. A exemplo do que faz EFFPERM, HYBRID3D pode trabalhar com blocos em forma de paralelep\u00edpedo, com dimens\u00f5es AX, AYe \u00d2Z. Logo, n\u00e3o h\u00e1 op\u00e7\u00e3o para cria\u00e7\u00e3o manual da malha. N\u00e3o \u00e9 feita integra\u00e7\u00e3o num\u00e9rica. \u00c9 calculada uma matriz elementar dos fluxos e a\ncorrespondente matriz elementar da formula\u00e7\u00e3o EFH, a menos do valor da permeabilidade do bloco. Na montagem da matriz global \u00e9 que a permeabilidade \u00e9 levada em conta, simplesmente pela multiplica\u00e7\u00e3o de todos os elementos da matriz elementar padr\u00e3o pelo valor da permeabilidade. HYBRID3D n\u00e3o trabalha nem com o fator b, nem com o fatorf.\nPara serem definidas as fun\u00e7\u00f5es de forma no elemento mestre c\u00fabico, partiu-se de tr\u00eas premissas b\u00e1sicas:\n\u2022\tas fun\u00e7\u00f5es de forma 3D deveriam ter uma forte semelhan\u00e7a com as fun\u00e7\u00f5es 2D;\n\u2022\ta integral do divergente de cada fun\u00e7\u00e3o sobre o todo o volume do elemento deveria ser unit\u00e1ria;\n\u2022\ta integral do fluxo normal de cada fun\u00e7\u00e3o sobre todas as faces deveria resultar na fun\u00e7\u00e3o delta de Kronecker.\nCom isso, t\u00eam-se:\nW, =\t= \u00ed\u201c^-;0;0J\tw2 = w.,_\t1;0;0^\n= wr+=^0;\u00ed\u00edyt;0^\tw, =\t= ^0;Ay-t;0^\nA numera\u00e7\u00e3o das fun\u00e7\u00f5es de forma \u00e9 diferente da numera\u00e7\u00e3o trigonom\u00e9trica que foi dada em HYBRID2D. Como os elementos podem estar expandidos ou contra\u00eddos nas tr\u00eas dire\u00e7\u00f5es principais, deve-se aplicar a transforma\u00e7\u00e3o de Piola:\n\no\nAt\n2\n0\n0\nAZ\n2 J\nJ== det([J])=\nAXAYAZ\n8\n(4.6)\n0\ne\n0 0\nRealizando analiticamente as integrais dos produtos internos, chega-se \u00e0 seguinte matriz elementar de fluxo e \u00e0 sua respectiva inversa:\n[EKF\\\n6AYAKAZ\n2(A\u00a5)2 -(AY)2 0\n-(AY)2\t0\t0\t0\t0\n2(A\u00a5)2\t0\t0\t0\t0\n0\t2(Ap2 -(AT)2\t\t0\t0\n0\t-(AZ)2\t\t0\t0\n0\t0\t0\t2(AZ)2\t-(AZ)2\n0\t0\t0\t-(AZ)2\t2(AZ)\\\n%w)2\n/(ay)2\n[EKFV ^IbXkYkZ)\nAax)2\nXay)2\n0\n0\n0\n0\n0\t0\t0\n0\t0\t0\nur)2\tAr)2\t0\n(Ar)2\t2/ /Ur)2\t0\n0\t0\tv /(AZ)2\n0\t0\tAz)2\n0\n0\n0\n0\nAAZ)2\nAaz)2_\n0\n0\n0\n0\n0\n0\n0\nComo era de se esperar, para o caso 2D, \u00e9 s\u00f3 fazer AZ -1 .\nA formula\u00e7\u00e3o fica simplificada para\nK[EKF}~'\nW^[ekfY_]\n{eYlEKFY' {e})\n{TP}=0\n(4.T)\nonde a matriz elementar padr\u00e3o da formula\u00e7\u00e3o (todos os elementos est\u00e3o deformados do\nmesmo modo) \u00e9:\n[EKFY1\nI {e}r[EKF]~\u2018{e})\n(4.8)\nObserve-se que a equa\u00e7\u00e3o matricial acima corresponde \u00e0 contribui\u00e7\u00e3o de um dos elementos que cont\u00e9m cada uma das interfaces, n\u00e3o \u00e9 o sistema linear final que vai ser de fato resolvido.\n4.2.2\t- Valida\u00e7\u00e3o do Programa HYBRID3D\nA valida\u00e7\u00e3o do programa HYBRID3D foi feita a partir de casos simples de solu\u00e7\u00e3o anal\u00edtica conhecida, em 2D e 3 D (homog\u00eaneo, s\u00e9rie, paralelo e barreira imperme\u00e1vel irregular).\nAp\u00f3s o processo de valida\u00e7\u00e3o, o intuito era repetir o que muitos pesquisadores (Warren e Price [1961]; Beckie e outros [1993]; Romeu [1994]; Galli e outros [1996]) fazem: gerar campos sint\u00e9ticos estocasticamente, efetuar a simula\u00e7\u00e3o e comparar as respostas com solu\u00e7\u00f5es anal\u00edticas ou com aproxima\u00e7\u00f5es de primeira ordem. Mais do que isso: nesta tese s\u00e3o mostrados compara\u00e7\u00f5es entre diferentes esquemas num\u00e9ricos. Esses resultados ser\u00e3o discutidos no Cap\u00edtulo 5, e sua consist\u00eancia permitiu adquirir confian\u00e7a no funcionamento dos programas HYBRID2D e HYBRID3D.\n43 - Os M\u00f3dulos Solver\nA principal motiva\u00e7\u00e3o para o estudo de m\u00e9todos de solu\u00e7\u00e3o de sistemas de equa\u00e7\u00f5es lineares \u00e9 que esta etapa do programa chega a consumir mais de 80% do esfor\u00e7o computacional para a simula\u00e7\u00e3o de problemas grandes, com mais de 100.000 vari\u00e1veis. A pesquisa nessa \u00e1rea \u00e9 muito ativa em diversas frentes: armazenamento e m\u00e9todos de solu\u00e7\u00e3o direta de matrizes esparsas; diferentes tipos de pr\u00e9-cond\u00edcionamento em m\u00e9todos baseados em gradientes conjugados; decomposi\u00e7\u00e3o e transforma\u00e7\u00f5es de similaridade. Existem pacotes de dom\u00ednio p\u00fablico, sub-rotinas prontas e programas fontes, como aqueles publicados por Press e outros [1992], que resolvem o sistema linear por in\u00fameros m\u00e9todos. Axelsson [1984] aborda o assunto de modo particularmente interessante, ao analisar diferentes m\u00e9todos de CG pr\u00e9-condicionados (JCG, SSOR-CG, IC-CG), apresentando os pseudoc\u00f3digos correspondentes. Os pseudoc\u00f3digos s\u00e3o algoritmos ou fluxogramas que facilitam a implementa\u00e7\u00e3o otimizada do m\u00e9todo selecionado, de acordo com as particularidades do problema, do m\u00e9todo de aproxima\u00e7\u00e3o ou da sistem\u00e1tica de indexa\u00e7\u00e3o de matriz esparsa.\nNa fase inicial da programa\u00e7\u00e3o, estava-se aplicando o m\u00e9todo de elimina\u00e7\u00e3o de Gauss com retro-substitui\u00e7\u00e3o, heran\u00e7a do programa de elementos finitos convencional. Esse m\u00e9todo permitia resolver problemas de tamanho 1240x1240 em um tempo de 54 segundos, em um microcomputador PC DX2 66 MHz com 8 Mb de RAM . O principal inconveniente era o armazenamento de uma matriz cheia, o que reduzia a capacidade de avan\u00e7ar para problemas maiores. Apesar de existirem m\u00e9todos de Gauss modificados para matrizes esparsas, preferiu-se partir para o estudo do gradiente conjugado, devido ao grande n\u00famero de refer\u00eancias e de cita\u00e7\u00f5es do seu uso.\nO m\u00e9todo de gradiente conjugado inicialmente implementado foi o de gradiente bi-conjugado (para matrizes n\u00e3o necessariamente sim\u00e9tricas), pr\u00e9-condicionado simplesmente pela diagonal (Jacobi) e usando como estimativa inicial o vetor nulo. Essa escolha fez com que os resultados convergissem em um n\u00famero de itera\u00e7\u00f5es menor do que o n\u00famero de inc\u00f3gnitas.\nA quest\u00e3o do pr\u00e9-condicionamento \u00e9 delicada. Comumente, diz-se que a matriz de pr\u00e9-condicionamento M deve ser escolhida de modo que a matriz A do sistema A . x = b fique mais pr\u00f3xima da matriz identidade (M.A\u00ae I), j\u00e1 que um sistema como M . A . x = I. x = M . b \u00e9 resolvido em urna \u00fanica itera\u00e7\u00e3o (x = M . b). Mas deve haver outros crit\u00e9rios al\u00e9m dessa semelhan\u00e7a de [M.A] com I. De fato, tentou-se incrementar o pr\u00e9-condicionamento formando, a partir da matriz A, alguns blocos 2x2 para al\u00e9m da diagonal, j\u00e1 que \u00e9 f\u00e1cil inverter uma matriz 2x2, formando uma matriz composta por blocos 2x2, onde isso fosse poss\u00edvel, e, nos outros casos, com blocos 1x1 - o pr\u00f3prio elemento da diagonal. Esta matriz seria uma extens\u00e3o natural do pr\u00e9-condicionamento pela diagonal, tomando a matriz [M.A] mais parecida com a diagonal do que antes, com muito mais termos nulos fora da diagonal principal. Por\u00e9m esse m\u00e9todo n\u00e3o deu certo, revelando a complexidade da quest\u00e3o.\nDepois, implementou-se um m\u00e9todo DSCG, para matrizes sim\u00e9tricas, seguindo a avalia\u00e7\u00e3o de Meyer [1989] de que o processo de diagonal scaling \u00e9 mais vantajoso do que o pr\u00e9-condicionamento de Jacobi. E realmente \u00e9: em problemas menores, o n\u00famero de itera\u00e7\u00f5es \u00e9 reduzido em 30%. Em problemas maiores, a redu\u00e7\u00e3o foi de 7%. Al\u00e9m disso, \u00e9 eliminada uma multiplica\u00e7\u00e3o vetor-vetor por itera\u00e7\u00e3o.\nCom o objetivo de reduzir ainda mais o tempo de execu\u00e7\u00e3o em problemas 3D, partiu-se para um pr\u00e9-condicionamento SSOR (symmetric successive overrelaxation methody com estimativa do maior autovalor da matriz de Jacobi associada para determinar o fator de relaxa\u00e7\u00e3o \u00f3timo (w\u2018).\nBeckie e outros [1993] afirmam que, em meios altamente heterog\u00eaneos, s\u00f3 pr\u00e9-condicionamentos mais robustos, como a fatora\u00e7\u00e3o incompleta de Cholesky, s\u00e3o capazes de convergir. De fato, verificou-se por experi\u00eancia pr\u00f3pria, reproduzindo condi\u00e7\u00f5es extremas citadas no artigo, que o SSOR-DS-CG n\u00e3o \u00e9 eficiente em problemas desse tipo. Resolveu-se, ent\u00e3o, implementar tamb\u00e9m um solver ICCG(O). No nome do m\u00e9todo, o n\u00famero zero refere-se \u00e0 caracter\u00edstica de n\u00e3o se operar sobre os zeros da matriz do sistema linear, ou seja, n\u00e3o h\u00e1 nenhum fill-in.\nA incorpora\u00e7\u00e3o dos m\u00f3dulos de solver nos programas ficou assim: HYBRID2D est\u00e1 com o m\u00f3dulo DSCG; e h\u00e1 duas vers\u00f5es de HYBRID3D, uma com o m\u00f3dulo SSOR-DS-CG e outra com o m\u00f3dulo ICCG(O).\nO tempo aplicado no estudo do m\u00f3dulo de solver foi dosado em rela\u00e7\u00e3o aos objetivos globais do trabalho. Ainda h\u00e1 pontos a serem melhorados nesses dois m\u00f3dulos 3D. para eles serem t\u00e3o efetivos quanto os m\u00f3dulos do PROFIT e do PERMEQ, como ser\u00e1 comentado no Cap\u00edtulo 5.\nCap\u00edtulo 5 - Discuss\u00e3o dos Resultados\nEste cap\u00edtulo discute o desempenho dos programas HYBRID2D e HYBRID3D, constru\u00eddos segundo o m\u00e9todo EFH, para o c\u00e1lculo da permeabilidade equivalente em um conjunto representativo de padr\u00f5es de heterogeneidade. Esse desempenho \u00e9 avaliado por compara\u00e7\u00e3o com outros m\u00e9todos anal\u00edticos e num\u00e9ricos, incluindo os m\u00e9todos de diferen\u00e7as finitas e de elementos finitos tradicionais. O crit\u00e9rio principal de compara\u00e7\u00e3o entre os diferentes m\u00e9todos de simula\u00e7\u00e3o num\u00e9rica baseia-se em gr\u00e1ficos que relacionam precis\u00e3o dos resultados e \u00edndices de esfor\u00e7o computacional. As situa\u00e7\u00f5es investigadas compreendem: os sete exemplos de Cruz [1991]; o tabuleiro de xadrez; o sistema arenito-argila de Durlofsky [1994]; distribui\u00e7\u00f5es lognormais em 2D e 3D, com correla\u00e7\u00e3o espacial ou n\u00e3o; e algumas variantes desses casos. A partir dos resultados, al\u00e9m de avaliar-se os programas constru\u00eddos, identifica-se a equival\u00eancia entre certos esquemas num\u00e9ricos, prop\u00f5e-se o uso de novos estimadores e elaboram-se outras discuss\u00f5es.\n5.1\t- Casos B\u00e1sicos: os Sete Exemplos de Cruz [1991]\nOs sete exemplos iniciais da tese de Cruz [1991] constituem um conjunto simples mas significativo de situa\u00e7\u00f5es para determina\u00e7\u00e3o da permeabilidade equivalente. S\u00e3o sete casos em malha 4x4, incluindo arranjos em paralelo, em s\u00e9rie e outras combina\u00e7\u00f5es interessantes. O valor de permeabilidade zero nas figuras, quando aparece, foi substitu\u00eddo por 10~15 para fins de c\u00e1lculo.\nAs figuras mostram tamb\u00e9m, para cada uma das Configura\u00e7\u00f5es, os resultados de dez m\u00e9todos de c\u00e1lculo da permeabilidade equivalente na dire\u00e7\u00e3o horizontal: seis tipos de m\u00e9dias, tr\u00eas m\u00e9todos num\u00e9ricos (DF, EF e EFH) e um valor de refer\u00eancia.\nPara os m\u00e9todos num\u00e9ricos usaram-se os subprogramas da biblioteca HOMLIB e o programa HYBRID2D (ou HYBRID3D), descritos nos Cap\u00edtulos 2 e 4. Os resultados dos m\u00e9todos num\u00e9ricos s\u00e3o calculados sem refinamento da malha original. Isso corresponde a 16, 25 e 40 vari\u00e1veis para DF, EF e EFH, respectivamente. Esses n\u00fameros correspondem ao\nn\u00fameros total de blocos (16), ao n\u00famero total de n\u00f3s (25) e ao n\u00famero total de faces (40) da representa\u00e7\u00e3o 4x4 do reservat\u00f3rio idealizado. Todos os programas trabalham com condi\u00e7\u00f5es de contorno tipo imperme\u00e1vel.\nO valor \u201cMalha Refinada\u201d \u00e9 tomado como a solu\u00e7\u00e3o de refer\u00eancia e corresponde \u00e0 extrapola\u00e7\u00e3o ponderada da tend\u00eancia de converg\u00eancia observada nos tr\u00eas m\u00e9todos, com a malha 4x4 sendo refinada at\u00e9 700x700. Assim, cada bloco original foi dividido em at\u00e9 30.625 (175x175) blocos com a mesma permeabilidade (resultando em 490.000 vari\u00e1veis para DF, 491.401 vari\u00e1veis para EF e 981.400 vari\u00e1veis para EFH).\nAs Configura\u00e7\u00f5es 1 a 4 n\u00e3o apresentam dificuldades para os m\u00e9todos num\u00e9ricos, que produzem a resposta anal\u00edtica exata sem problemas. Essa Configura\u00e7\u00f5es servem mais para compara\u00e7\u00e3o dos diferentes tipos de m\u00e9dia - o estimador de Le Loc\u2019h/ Gu\u00e9rillot fornece a resposta exata nas quatro situa\u00e7\u00f5es - e para valida\u00e7\u00e3o preliminar dos tr\u00eas m\u00e9todos num\u00e9ricos.\nAs Configura\u00e7\u00f5es 5, 6 e 7 s\u00e3o mais interessantes para avalia\u00e7\u00e3o dos m\u00e9todos num\u00e9ricos, possibilitando a investiga\u00e7\u00e3o dos efeitos do refinamento da malha num\u00e9rica.\n150\t50\t350\t250\n150\t50\t350\t250\n150\t50\t350\t250\n150\t50\t350\t250\nM\u00e9dia Aritm\u00e9tica =\t200.00\nLim Sup LeLoc 'h -\t119.32\nElementos Finitos\t119.32\nMalha Refinada =\t119.32\nM\u00e9dia Geom\u00e9trica ~\t160.05\nEl. Finitos H\u00edbridos =\t119.32\nLeLoc \u2019h Gu\u00e9rillot =\t119.32\nDiferen\u00e7as Finitas =\t119.32\n\u00bf\u00edm Inf LeLoc \u2019h\t=\t119.32\nM\u00e9dia Harm\u00f4nica =\t119.32\n150\t150\t150\t150\n50\t50\t50\t50\n350\t350\t350\t350\n250\t250\t250\t250\nM\u00e9dia Aritm\u00e9tica =\t200.00\nLim Sup LeLoc 'h =\t200.00\nElementos Finitos -\t200.00\nMalha Refinada =\t200.00\nM\u00e9dia Geom\u00e9trica =\t160.05\nEl. Finitos H\u00edbridos =\t200.00\nLeLoc\u2019h Gu\u00e9rillot =\t200.00\nDiferencas-Finitas =\t200.00\nLim Inf LeLoc 'h ~\t200.00\nM\u00e9dia Harm\u00f4nica =\t119.32\nConfigura\u00e7\u00e3o 2 - Sistema em paralelo (Exemplo 3 de Cruz [91])\n150\t0\t350\t250\n150\t0\t350\t250\n150\t0\t350\t250\n150\t0\t350\t250\nM\u00e9dia Aritm\u00e9tica =\t187.5\nLim Sup LeLoc 'h ~\t0.00\nElementos Finitos =\t0.00\nMalha Refinada =\t0.00\nM\u00e9dia Geom\u00e9trica =\t0.01\nEL Finitos H\u00edbridos =\t0.00\nLeLoc 'h Gu\u00e9rillot =\t0.00\nDiferen\u00e7as Finitas =\t0.00\nLim Inf LeLoc 7?\t=\t0.00\nM\u00e9dia Harm\u00f4nica =\t0.00\n150\n150\t150\n150\n0\n0 0\n0\n350\n350\t350\t350\n250\n250\t250\t250\nM\u00e9dia Aritm\u00e9tica ~ 187.5\nLim Sup LeLoc 'h -\t187.5\nElementos Finitos =\t187.5\nMalha Refinada =\t187.5\nM\u00e9dia Geom\u00e9trica -\t0.01\nEL Finitos H\u00edbridos =\t187.5\nLeLoc\u2019h Gu\u00e9rillot =\t187.5\nDiferen\u00e7as Finitas =\t187.5\nLim Inf LeLoc 'h\t=\t187.5\nM\u00e9dia Harm\u00f4nica =\t0.0\nConfigura\u00e7\u00e3o 4 - Sistema em paralelo com n\u00edvel imperme\u00e1vel (Exemplo 6 de Cruz [91])\n250\t50\t350\t150\n350\t250\t150\t50\n150\t350\t50\t250\n50\t150\t250\t350\nM\u00e9dia Aritm\u00e9tica =\t200.00\nLim Sup LeLoc 'h -\t200.00\nElementos Finitos =\t176.32\nMalha Refinada =\t162.3\nM\u00e9dia Geom\u00e9trica =\t160.05\nEL Finitos H\u00edbridos =\t154.87\nLeLoc fh Gu\u00e9rillot ~\t154.48\nDiferen\u00e7as Finitas ~\t148.80\nLim Inf LeLoc 'h\t=\t119.32\nM\u00e9dia Harm\u00f4nica =\t119.32\n250\n50\n350\n150\n350\n250\n150\n50\n150\t350\n0\n250\n50\n150\t250\t350\nM\u00e9dia Aritm\u00e9tica ~ 196.88\nUm Sup LeLoc 'h ~\t196.72\nElementos Finitos\t170.45\nMalha Refinada =\t149.45\nM\u00e9dia Geom\u00e9trica =\t14.47\nEl. Finitos H\u00edbridos =\t138.55\nLeLoc \u2019h Gu\u00e9rillot =\t132.68\nDiferen\u00e7as Finitas -\t129.43\nLim Inf LeLoc 'h\t~\t89.49\nM\u00e9dia Harm\u00f4nica =\t0.00\nConfigura\u00e7\u00e3o 6 - Distribui\u00e7\u00e3o alternada com um zero (Exemplo 4 de Cruz [91])\n150\t0\t350\t250\n150\t50\t350\t250\n150\t0\t350\t250\n150\t0\t350\t250\nM\u00e9dia Aritm\u00e9tica =\t190.62\nLim Sup LeLoc 'h =\t42.77\nElementos Finitos =\t40.38\nMalha Refinada =\t37.71\nM\u00e9dia Geom\u00e9trica =\t0.12\nEL Finta H\u00edbridos =\t36.46\nLeLoc \u2019h Gu\u00e9rillot =\t35.72\nDiferen\u00e7as Finitas =\t34.68\nLim Inf LeLoc 'h\t\u2014\t29.83\nM\u00e9dia Harm\u00f4nica =\t0.00\nA Configura\u00e7\u00e3o 5 caracteriza-se por um grau de heterogeneidade relativamente leve. Isso pode ser avaliado por tr\u00eas indicadores: desvio-padr\u00e3o logar\u00edtmico populacional igual \u00e0 0.736 (menor do que 1.0); contraste entre permeabilidades n\u00e3o superior a sete: quatro algarismos significativos na precis\u00e3o da permeabilidade equivalente com refinamento 175.\nNo Gr\u00e1fico 5.1 mostram-se os resultados num\u00e9ricos para a Configura\u00e7\u00e3o 5, com refinamento da malha at\u00e9 10.000 vari\u00e1veis em cada m\u00e9todo, suficiente para indicar que todos os m\u00e9todos est\u00e3o convergindo. Resultados semelhantes foram obtidos para as Configura\u00e7\u00f5es 6 e 7. Registre-se apenas que a Configura\u00e7\u00e3o 6, que difere da Configura\u00e7\u00e3o 5 pela substitui\u00e7\u00e3o de um valor de permeabilidade 50 por zero, \u00e9 um caso com converg\u00eancia mais lenta do que a Configura\u00e7\u00e3o 5, como seria de se esperar.\nEm sistemas assim, relativamente homog\u00e9neos, verificamos empiricamente que a permeabilidade equivalente \u00e9 bem estimada pela m\u00e9dia aritm\u00e9tica entre a resposta EF e a resposta DF para o refinamento original. Isso pode ser observado na Tabela 5.1, para as Configura\u00e7\u00f5es 5, 6 e 7. Com o refinamento da malha, os resultados desse estimador s\u00e3o ainda melhores, devido \u00e0 diminui\u00e7\u00e3o no intervalo de incerteza. Entretanto, para sistemas mais heterog\u00eaneos, parece melhor ignorar o resultado EF, como ser\u00e1 visto mais adiante.\nTabela 5.1 - A m\u00e9dia aritm\u00e9tica entre simula\u00e7\u00f5es EF e DF pode ser um bom estimador\nCasos\tM\u00e9dia Aritm\u00e9tica Entre as\tValor de Refer\u00eancia\nLevemente\tRespostas dos M\u00e9todos EF e\tObtido Pela\nHeterog\u00eaneos\tDF, no Refinamento Original\tMalha Refinada\nConfigura\u00e7\u00e3o 5\t162.56\t162.30\nConfigura\u00e7\u00e3o 6\t149.94\t149.45\nConfigura\u00e7\u00e3o 7\t37.53\t37.71\n5.2\t- O Tabuleiro de Xadrez\n\u00c0 parte os arranjos em s\u00e9rie e em paralelo, o sistema tipo tabuleiro de xadrez (Figura\n5.1) \u00e9, possivelmente, o tipo mais simples de meio heterog\u00eaneo.\n168\n166\n164\n\\ Gr\u00e1fico 5.1 - An\u00e1lise da Configura\u00e7\u00e3o 5\nPermeabilidade Equivalente\n162\n160\n158\n156\n10\n. \u2022 r * \u25a0\n-----Exata\n--\u2666-\u25a0EFH\n- - -\u00e2r - \u2022 DF\n100\n1000 10000\nN\u00famero de Vari\u00e1veis\n162.6\nPermeabilidade Equivalente\nGr\u00e1fico 5.2 -\nA Media Aritm\u00e9tica Entre EF e DF Pode Ser um Bom Estimador, nos Casos Mais Homog\u00e9neos\n- - w \u25a0 \u25a0 EF\n--o---M\u00e9dia EF/ DF\n-----Exata\nDF\n0x\n162.3\na,\n\u00b0~ \u2019 O- -o -o OOO ... -o - - O - O -0-0-0 - - - -0-0-0 O-Q\n162.0\n1\n10\n100\nRefinamento\nZX2\n4X4\nFigura 5.\u00cd - Idealiza\u00e7\u00e3o de reservat\u00f3rios no formato Tabuleiro, ou Quadriculado\nRomeu [1994] mostra que h\u00e1 solu\u00e7\u00e3o anal\u00edtica para a permeabilidade equivalente de sistemas quadriculados com condi\u00e7\u00f5es de contorno peri\u00f3dicas: a pr\u00f3pria m\u00e9dia geom\u00e9trica entre os dois valores de permeabilidade. Desse modo, por exemplo, para um Tabuleiro 2x2 com permeabilidades 500x50, a solu\u00e7\u00e3o exata \u00e9 158,11.\nGalli e outros [1996, p.64] tamb\u00e9m analisaram esse sistema 500x50, apresentando um gr\u00e1fico com o comportamento das simula\u00e7\u00f5es EF e DF contra o refinamento, onde os resultados das duas formula\u00e7\u00f5es convergem para a M\u00e9dia Geom\u00e9trica. Embora isto n\u00e3o seja dito expl\u00edcitamente no texto, o gr\u00e1fico foi feito para as condi\u00e7\u00f5es de contorno peri\u00f3dicas, conforme foi verificado por compara\u00e7\u00e3o com resultados do programa PERMEQ.\nSimulando para as condi\u00e7\u00f5es de contorno de tipo imperme\u00e1vel, com o m\u00f3dulo EFFPERM e com HYBRID2D, verificamos que novamente os dois m\u00e9todos (DF e EF) v\u00e3o convergindo para 158,11. S\u00f3 que agora os resultados s\u00e3o sistematicamente superiores aos resultados das simula\u00e7\u00f5es com as condi\u00e7\u00f5es de contorno peri\u00f3dicas. Quanto aos resultados EFH, eles convergem para 158,11, como sempre, por cima dos resultados DF.\nSurge assim a id\u00e9ia de fazer a simula\u00e7\u00e3o EF para as condi\u00e7\u00f5es peri\u00f3dicas, pois essas condi\u00e7\u00f5es deslocam o resultado da simula\u00e7\u00e3o favoravelmente para baixo. Na formula\u00e7\u00e3o DF, por outro lado, \u00e9 melhor usar as condi\u00e7\u00f5es de contomo usuais, pois resultados maiores, nesse caso, s\u00e3o melhores. N\u00e3o fizemos nenhuma verifica\u00e7\u00e3o dessa id\u00e9ia em outros exemplos, s\u00f3 a deixamos registrada aqui pois pode haver um bom potencial no seu uso.\nN\u00e3o apresentamos os gr\u00e1ficos para o Tabuleiro, pois o comportamento dos m\u00e9todos \u00e9 an\u00e1logo ao comportamento visto na Configura\u00e7\u00e3o 5.\n5.3\t- Reprodu\u00e7\u00e3o do Sistema Arenito-Argila de Durlofsky\nEm sistemas altamente heterog\u00eaneos e desorganizados, m\u00e9todos como perturba\u00e7\u00e3o, expans\u00e3o espectral e correla\u00e7\u00f5es anal\u00edticas fracassam, por se basearem em pequenas varia\u00e7\u00f5es ou em expans\u00f5es em fun\u00e7\u00f5es definidas em todo o dom\u00ednio do problema, Como os m\u00e9todos num\u00e9ricos DF e EF s\u00e3o baseados em expans\u00f5es em fun\u00e7\u00f5es definidas localmente, eles s\u00e3o potencialmente mais indicados para lidar com grandes varia\u00e7\u00f5es locais das propriedades f\u00edsicas.\nDurlofsky [1994] discute um exemplo de sistema arenito-argila gerado pelo posicionamento aleat\u00f3rio de blocos de argilas com as seguintes caracter\u00edsticas:\n\u2022\tdom\u00ednio quadrado unit\u00e1rio, discretizado por uma malha triangular 20x20(x2);\n\u2022\tdistribui\u00e7\u00e3o espacial dos arenitos e argilas (20 % da \u00e1rea total) segundo a Reprodu\u00e7\u00e3o 2;\n\u2022\tpermeabilidade do arenito uniforme e isotr\u00f3pica, K AltElA = 1 ;\n\u00ab permeabilidade da argila uniforme e isotr\u00f3pica, K ARGlLA 10\u201d6 ;\n\u2022\ta simula\u00e7\u00e3o por EFH com 800 elementos e 1240 vari\u00e1veis resulta em um fluxo total atrav\u00e9s do sistema de 0.4508;\n\u2022\ta solu\u00e7\u00e3o de refer\u00eancia \u00e9 0.5205, valor obtido pela extrapola\u00e7\u00e3o dos resultados de simula\u00e7\u00f5es DF em malhas cada vez mais refinadas.\nO resultado obtido por HYBRID2D para os 800 tri\u00e2ngulos com 1240 vari\u00e1veis foi 0,45082923 em um microcomputador e 0.45082921 numa esta\u00e7\u00e3o de trabalho HP modelo apollo s\u00e9rie 735.\nUma caracter\u00edstica desse sistema arenito-argila de Durlofsky \u00e9 que o limite superior de Le Loc\u2019h \u00e9 muito pr\u00f3ximo da m\u00e9dia Aritm\u00e9tica, e o limite inferior \u00e9 muito pr\u00f3ximo de zero (como a pr\u00f3pria m\u00e9dia Harm\u00f4nica). Em tais sistemas \u00e9 inseguro tentar uma mudan\u00e7a de escala r\u00e1pida por simples m\u00e9dias ou estimadores.\nNo artigo de Durlofsky [1994], o dom\u00ednio foi discretizado em elementos triangulares, pois este elemento modela melhor fronteiras irregulares e se adapta bem como encaixe e\ny\nX\nReprodu\u00e7\u00e3o 2 - Sistema Arenito-Argila de Durlofsky.\nLinhas de fluxo da solu\u00e7\u00e3o EFH para as 1240 vari\u00e1veis da discretiza\u00e7\u00e3o 20X20(X2), totalizando 800 tri\u00e2ngulos.\n(Originalmente, figura 5 de Durlofsky [19941)\nuni\u00e3o. Entretanto, uma malha retangular fornecer\u00e1, nesse exemplo, uma resposta muito mais precisa. Para tentar reproduzir a resposta exata, dada como 0.5205, trabalhou-se com quadrados, refinando a malha cada vez mais.\nO Gr\u00e1fico 5.3 mostra os resultados das tr\u00eas formula\u00e7\u00f5es em fun\u00e7\u00e3o do grau de refinamento. Em termos de precis\u00e3o dos resultados, observa-se uma enorme superioridade de EFH sobre DF, para um mesmo grau de refinamento da malha . Isso deve-se, em parte, ao maior n\u00famero de vari\u00e1veis na formula\u00e7\u00e3o EFH, 2 a 2,5 vezes superior ao n\u00famero de vari\u00e1veis DF, para um mesmo refinamento.\nNo Gr\u00e1fico 5.4 faz-se uma esp\u00e9cie de normaliza\u00e7\u00e3o, tra\u00e7ando as curvas em fun\u00e7\u00e3o do n\u00famero total de vari\u00e1veis empregadas em cada um dos m\u00e9todos. A formula\u00e7\u00e3o EFH ainda assim apresenta uma maior precis\u00e3o para o mesmo n\u00famero de vari\u00e1veis (considerando as curvas interpoladas, j\u00e1 que dificilmente existe coincid\u00eancia do mesmo n\u00famero de vari\u00e1veis nos dois m\u00e9todos). Para uma desejada precis\u00e3o, a correspondente formula\u00e7\u00e3o DF precisa entre 100% e 50% mais vari\u00e1veis do que a formula\u00e7\u00e3o DF. Quando se leva em conta o esfor\u00e7o computacional, a formula\u00e7\u00e3o DF melhora bastante sua situa\u00e7\u00e3o, por gerar um sistema linear mais esparso e, desse modo, mais f\u00e1cil e r\u00e1pido de ser resolvido. Uma an\u00e1lise do balan\u00e7o da influ\u00eancia dessas caracter\u00edsticas - n\u00famero total de vari\u00e1veis, precis\u00e3o e esparsidade - no esfor\u00e7o computacional \u00e9 feita na Se\u00e7\u00e3o 5.6.\nOs Gr\u00e1ficos 5.3 e 5.4 revelam o desempenho sofr\u00edvel da formula\u00e7\u00e3o EF na simula\u00e7\u00e3o do Sistema de Durlofsky. O m\u00e9todo EF utilizado funciona razoavelmente bem em sistemas relativamente mais homog\u00eaneos, como observado na se\u00e7\u00e3o anterior, mas fracassa para sistemas com elevados contrastes entre as permeabilidades dos blocos, esse, ali\u00e1s, \u00e9 um fato bem reconhecido na literatura sobre a aplica\u00e7\u00e3o de EF em problemas de fluxo. Isso deve-se ao fato de que as fun\u00e7\u00f5es de forma bilineares, usadas no programa da HOMLIB, n\u00e3o s\u00e3o muito apropriadas para problemas de fluxo em meios heterog\u00eaneos. As fun\u00e7\u00f5es quadr\u00e1ticas e biquadr\u00e1ticas, mais adequadas por garantirem a continuidade do fluxo entre elementos, normalmente n\u00e3o s\u00e3o utilizadas, por n\u00e3o serem competitivas em termos do esfor\u00e7o computacional.\nUm fato curioso e casual foi obtido da observa\u00e7\u00e3o dos n\u00fameros calculados para gerar o gr\u00e1fico do refinamento. Durlofsky [1994] compara o m\u00e9todo EFM, na realidade EFH (conforme observa\u00e7\u00e3o feita na Se\u00e7\u00e3o 3.1), com um m\u00e9todo CVFE {Control Volume Finite Element). \u00c9 comentado que, para as fun\u00e7\u00f5es de forma de mais baixa ordem (lineares e\nPermeabilidade Equivalente\nPermeabilidade Equivalente\nGr\u00e1fico 5.4 - O Esfor\u00e7o Computacional Est\u00e1 mais\nN\u00famero de Vari\u00e1veis\no\nLU\nGr\u00e1fico 5.5 - A Diminui\u00e7\u00e3o do Erro com o Refinamento\n6\n5\n4\n3\n2\n1\n0\n\n4\u2122\n\u25b2\n\n\u2666\nA\n\u25a0\u00e2r - \u25a0 DF\n\u2666 -EFH\n\n1000 10000 100000\nN\u00famero de Vari\u00e1veis\nTabela 5.2 - Refinamento do arenito-argila de Durlofsky convergindo para 0.5205\nGrau de\tN\u00famero de\tTotal de\tPermeabilidade\tERRO\nRefinamento\tElementos\tVari\u00e1veis\tEqv. por EFH\t(%)\n1\t400\t840\t0.4904082\t-5.78\n2\t1.600\t3.280\t0.5071188\t-2.57\n3\t3.600\t7.320\t0.5123443\t-1.57\n4\t6.400\t12.960\t0,5147454\t-1.11\n5\t10.000\t20.200\t0.5160955\t-0.85\n6\t14.400\t29.040\t0.5169473\t-0.68\n7\t19.600\t39.480\t0.5175277\t-0.57\n8\t25.600\t51.520\t0.5179453\t-0.49\n9\t32.400\t65.160\t0.5182584\t-0.43\n10\t40.000\t80.400\t0.5185007\t-0.38\n11\t48.400\t97.240\t0.5186930\t-0.35\n12\t57.600\t115.680\t0.5188489\t-0.32\n13\t67.600\t135.720\t0.5189775\t-0.29\n14\t78.400\t157.360\t0.5190852\t-0.27\n15\t90.000\t180.600\t0.5191764\t-0.25\n16\t102.400\t205.440\t0.5192547\t-0.24\n17\t115.600\t231.880\t0.5193224\t-0.23\n18\t129.600\t259.920\t0.5193814\t-0.21\n19\t144.400\t289.560\t0.5194334\t-0.20\n20\t160.000\t320.800\t0.5194794\t-0.20\n25\t250.000\t501.000\t0.5196470\t-0.16\n35\t490.000\t981.400\t0.5198226\t-0.13\ny\nX\nReprodu\u00e7\u00e3o 3 - Linhas de fluxo da solu\u00e7\u00e3o CVFE para 3721 vari\u00e1veis, os v\u00e9rtices dos 7200 tri\u00e2ngulos resultantes do refinamento igual \u00e0 tr\u00eas do sistema arenito-argila de Durlofsky.\nObservar que em muitas regi\u00f5es, as linhas de fluxo n\u00e3o s\u00e3o suficientemente desviadas pelos blocos de argila, chegando a haver fluxo atrav\u00e9s das argilas. A solu\u00e7\u00e3o mostrada na Reprodu\u00e7\u00e3o 2 \u00e9 muito mais realista fisicamente, para um n\u00famero total de vari\u00e1veis tr\u00eas vezes menor.\n(Originalmente, figura 6 de Durlofsky [1994])\nbilineares), a formula\u00e7\u00e3o EF e a CVFE resultam no mesmo campo de press\u00f5es. Para o caso do sistema arenito-argila, o \u00fanico resultado CVFE que aparece no texto \u00e9 0.6228 para 7200 tri\u00e2ngulos com 3721 vari\u00e1veis. N\u00e3o \u00e9 mostrado gr\u00e1fico do comportamento da resposta contra o refinamento da malha.\nObservou-se que, para refinamento igual \u00e0 tr\u00eas, o resultado EF do PROFIT era 0.6227729 para 3721 vari\u00e1veis em 3600 quadrados.\nSonier e Eymard [1993] apresentam um desenvolvimento te\u00f3rico da formula\u00e7\u00e3o CVFE para aplica\u00e7\u00e3o na simula\u00e7\u00e3o de reservat\u00f3rios, regime transiente. Analisando alguns pontos desse artigo com outros t\u00f3picos de Durlofsky [1994], conclu\u00edmos que o resultado EF do PROFIT \u00e9 um resultado CVFE. Isso ocorre por estarmos trabalhando em regime permanente e com as fun\u00e7\u00f5es de forma mais simples. O p\u00f3s-processamento que o PROFIT faz para calcular o fluxo no centro do bloco acaba resultando no mesmo valor que \u00e9 obtido por CVFE.\n5,4\t- Campos Lognormais\nNesta se\u00e7\u00e3o, s\u00e3o investigados os resultados num\u00e9ricos de permeabilidade equivalente em campos lognormais. \u00c9 um exerc\u00edcio importante por diversas raz\u00f5es. A hip\u00f3tese de distribui\u00e7\u00e3o lognormal das permeabilidades \u00e9 bastante corrente nos estudos de reservat\u00f3rio, em fun\u00e7\u00e3o das estat\u00edsticas coletadas de dados de campo. Esse tipo de distribui\u00e7\u00e3o possui uma representa\u00e7\u00e3o matem\u00e1tica simples, e o grau de heterogeneidade \u00e9 facilmente controlado fazendo-se variar um \u00fanico par\u00e2metro. A descri\u00e7\u00e3o dessa distribui\u00e7\u00e3o e aspectos pr\u00e1ticos de sua gera\u00e7\u00e3o em computador foram introduzidos na Se\u00e7\u00e3o 2.3. Conforme apresentado naquela se\u00e7\u00e3o, a permeabilidade equivalente de meios lognormais isotr\u00f3picos infinitos \u00e9 igual \u00e0 m\u00e9dia geom\u00e9trica, em 2D, e pr\u00f3xima de uma m\u00e9dia de pot\u00eancia com expoente 1/3, em 3D Muitos estudos anteriores relacionados com o c\u00e1lculo da permeabilidade equivalente foram dirigidos para esse tipo de meio heterog\u00eaneo, como se viu no cap\u00edtulo 2.\nNesta tese, os casos de campos lognormais investigados incluem: um primeiro conjunto de malhas 3D, com diferentes tamanhos e diferentes n\u00edveis de refinamento; um estudo espec\u00edfico orientado para os efeitos de anisotropia do tensor; e dois casos 2D, onde considera-se a exist\u00eancia de uma correla\u00e7\u00e3o espacial nos valores da permeabilidade, gerados por m\u00e9todos geoestat\u00edsticos.\n5.4.1\t- Campos Lognormais 3D Isotr\u00f3picos sem Correla\u00e7\u00e3o Espacial\nAplica-se aqui uma abordagem totalmente pr\u00e1tica. Primeiro, s\u00e3o geradas diversas realiza\u00e7\u00f5es ou imagens de campos lognormais. Depois, cada uma dessas imagens \u00e9 simulada, com refinamento da malha num\u00e9rica at\u00e9 o limite de nossa capacidade de c\u00e1lculo (aproximadamente um milh\u00e3o de vari\u00e1veis). Por fim, s\u00e3o analisadas a converg\u00eancia e o comportamento dos tr\u00eas m\u00e9todos num\u00e9ricos com os quais estamos trabalhando (DF, EF e EFH).\nCampos lognormais gerados com o desvio padr\u00e3o dos logaritmos acima de quatro (vari\u00e2ncia dos logaritmos acima de dezesseis) apresentam um padr\u00e3o de fluxo mais parecido com o fluxo em fraturas ou como um modelo de percola\u00e7\u00e3o, com alguns canais condutores. Os m\u00f3dulos de solver usuais tem muita dificuldade em convergir. Nos testes feitos por Beckie e outros [1993], o solver SSOR-CG n\u00e3o convergia em situa\u00e7\u00f5es assim. N\u00f3s verificamos esses fatos, pela reprodu\u00e7\u00e3o das condi\u00e7\u00f5es extremas em simula\u00e7\u00f5es com HYBRID3D, e acabamos implementando um solver ICCG(O) para o nosso esquema de indexa\u00e7\u00e3o esparsa, como foi dito na Se\u00e7\u00e3o 4.3. N\u00e3o ser\u00e3o mostrados casos desse tipo.\nApresentam-se quatro casos representativos das simula\u00e7\u00f5es lognormais. Na Tabela 5.4 s\u00e3o apresentadas as principais medidas estat\u00edsticas caracterizando as distribui\u00e7\u00f5es geradas. S\u00e3o mostrados tamb\u00e9m os resultados de diversos estimadores para a permeabilidade equivalente. Nos Gr\u00e1ficos 5.6 a 5.9, pode-se verificar o comportamento dos tr\u00eas m\u00e9todos num\u00e9ricos.\nEsses mesmos gr\u00e1ficos mostram que. mais uma vez, a M\u00e9dia Aritm\u00e9tica entre EF e DF funciona como uma boa estimativa da permeabilidade equivalente, sustentando a conjectura levantada na Se\u00e7\u00e3o 5.1. Esse ponto ir\u00e1 merecer uma discuss\u00e3o em separado, na Se\u00e7\u00e3o 5.9.\nTabela 5.3 - Compara\u00e7\u00e3o de Simula\u00e7\u00f5es em Campos Lognormais Sint\u00e9ticos\nTamanho\t23x23x23\t- 17x17x17\t10x10x10\t14x14x14\nRefinamento M\u00e1ximo\t'\"'t 0\t4\t7\t5\nDesvio-padr\u00e3o pedido\t0.8130\t0.9700\t1.5000\t3.1000\nSemente\t688\t307\t2\t438\nDesvio-padr\u00e3o efetivo\t0.8132\t0.9685\t1.5091\t3.1785\nGrau de Heterogeneidade\tMediano\tMediano\tAlto\tAlt\u00edssimo\nM\u00e9dia Aritm\u00e9tica\t1.3959\t1.6377\t3.0264\t119.7078\nLimite Superior LeLoc\u2019h\t1.3936\t1.6326\t2.8269\t57.4568\nM\u00e9dia Geom\u00e9trica\t0.9987\t1.0164\t0.9773\t1.0008\nLe Loc\u2019h - Gu\u00e9rillot\t1.0212\t1.0639\t1.1013\t2.5544\nLimite Inferior Le Loc'h\t0.7484\t0.6933\t0.4290\t0.1136\nM\u00e9dia Harm\u00f4nica\t0.7186\t0.6365\t0.3211\t0.0149\nM\u00e9dia Pot\u00eancia 1/3\t1.1155\t1.1892\t1.4288\t5.4688\nEstimador pela Vari\u00e2ncia\t1.1151\t1.1884\t1.4285\t5.3903\nPrimeira M\u00e9dia Aritm\u00e9tica EF/ DF (na Malha Original)\t1.1088\t1.1787\t1.3640\t4.9861\nValor de Refer\u00eancia (M\u00e9dia EF/ DF na Malha mais Refinada).\t1.1047\t1.1649\t1.2840\t-2.6 (Tend\u00eancia DF e EFH)\n5.4.2\t~ Campos Lognormais e Anisotropia\nAnisotropia \u00e9 a caracter\u00edstica que os materiais podem apresentar de possuir propriedades f\u00edsicas vari\u00e1veis em fun\u00e7\u00e3o da dire\u00e7\u00e3o - da orienta\u00e7\u00e3o - considerada. Os meios porosos geralmente s\u00e3o anisotr\u00f3picos em rela\u00e7\u00e3o \u00e0 permeabilidade.\n1.26 -\nGr\u00e1fico 5.6- Campo lognormal 23x23x23, com desvio-padr\u00e3o 0.8132\nPermeabilidade Equivalente\t; \u00a1\tPermeabilidade Equivalente\n1.16\n\u00d3\n-O\n-Q\n1.06\n- - ni k\n, -A - '\n\u2022 - -EF\nPot\u00eancia 1/3\n- - O- - - M\u00e9dia EF/DF\n* --EFH\n- - A- - -DF\n0.96 1\n\n1\n2\n3\nRefinamento\n.38\n.24\nQ\n1.1\n0.96 -\n1\nGr\u00e1fico 5.7 - Campo lognormal 17x17x17, com desvio-padr\u00e3o 0.9685\nO\nO- -\n\u00f4\n, \u2666 - \u2019\n, A' \u2018 '\n2\nRefinamento\n, - -A - -\n\n\u2014 \u2014\u25a0 Pot\u00eancia 1/3\nO - - M\u00e9dia EF/ DF\n\u00bb--EFH\n- - DF\n3\n4\n1.8\n1.58\nGr\u00e1fico 5.8 - Campo lognormal 10x10x10, com desvio-padr\u00e3o 1.5091\nPermeabilidade Equivalente\ti \u00a1\tPermabilidade Equivalente\n1.36 \u00d3 - . ,\n\u2019 -O - -\n- . o\no-\no\no\n<>\n1.14 -\n. - -A\n-\u2022\n'A\n\u25a0A\nA\n, . -A \"\nEF\n-----Pot\u00eancia 1/3 :\nA' '\n- - O - - M\u00e9dia EF/ DF\n>-\u2022EFH\n- - A- \u25a0 \u25a0 DF\n0.92\n1\n9\n7.05\n5.1\n1.2\n2\n3\n4\n5\n6\n7\nRefinamento\nGr\u00e1fico 5.9 - Campo lognormal 14x14x14, com desvio-padr\u00e3o 3.1785\n11. .\n* - - EF\n\u2014 Pot\u00eancia 1/3\n- - O - - M\u00e9dia EF/DF\n\u2666 --EFH\n- - A - -DF\n3.15\nT ' *\t' 'O\t\t\u201c \" -o-- - - -\tw * -o-\t\u25a0 - - - - --\t.A\n\t\t\t\t\t-\t- - \u2014 -n\no- - \" \u25a0\t\t\t\t\nA\u2019 \"\"\t\t\t\t\n1\n2\n3\n4\n5\nRefinamento\nA forma de representar a anisotropia \u00e9 tratando a permeabilidade n\u00e3o mais como um escalar puro, e sim como um tensor, uma representa\u00e7\u00e3o matricial (2x2 em 2D e 3x3 em 3D). Em uma primeira aproxima\u00e7\u00e3o, \u00e9 usual considerar apenas os termos diagonais do tensor, admitindo que possa ocorrer kxx *\t\u25a0 \u00c9 o que faz, por exemplo, o m\u00f3dulo EFFPERM\nda HOMLIB do PROFIT. Em uma formula\u00e7\u00e3o mais geral, pode-se levar em conta os termos cruzados do tensor (Ramiro [1994]). Esses termos s\u00e3o respons\u00e1veis pelo surgimento de fluxo total em uma dire\u00e7\u00e3o diferente daquela em que \u00e9 aplicada o gradiente de potencial. As rotinas em C da HOMLIB, por sua vez, trabalham com todos os termos do tensor, diagonais e\ncruzados.\nA extens\u00e3o da formula\u00e7\u00e3o h\u00edbrida para o tratamento tensorial completo foi discutida na Se\u00e7\u00e3o 3.6. Por ora, ser\u00e1 feita uma aplica\u00e7\u00e3o ilustrativa de um caso mais simples, onde a permeabilidade em uma ou duas dire\u00e7\u00f5es (componentes diagonais do tensor) \u00e9 uniformemente alterada em todo o dom\u00ednio.\nUm coeficiente de anisotropia constante em uma dire\u00e7\u00e3o pode ser considerado em\nHYBRID3D pela mera varia\u00e7\u00e3o da geometria de uma forma compat\u00edvel. Em Romeu [1994,\np.l 14], temos que o coeficiente de anisotropia global na dire\u00e7\u00e3o Z \u00e9 dada por:\n\u2014\nk. ( AY?\n\u00bfJazJ \u2019\n(5.1)\ne, de forma an\u00e1loga, na dire\u00e7\u00e3o Y. Essa rela\u00e7\u00e3o entre anisotropia do tensor e anisotropia geom\u00e9trica pode ser provada a partir de transforma\u00e7\u00f5es de vari\u00e1veis na equa\u00e7\u00e3o diferencial que rege o fen\u00f4meno. Ent\u00e3o, por exemplo, para simularmos kz: = 0.25* kxx, \u00e9 s\u00f3 fazer AZ = 2AX .\nNa Tabela 5.5, partimos de um caso base (Tabela 5.4) com AY - AZ = AZ = 1 e fomos reduzindo as permeabilidades em Y e Z. E poss\u00edvel observar que a permeabilidade equivalente (obtida da extrapola\u00e7\u00e3o M\u00e9dia Aritm\u00e9tica EF/ DF na malha mais refinada) vai, de fato, diminuindo. Como o fluxo \u00e9 basicamente na dire\u00e7\u00e3o X e o meio \u00e9 muito pouco heterog\u00eaneo, a varia\u00e7\u00e3o n\u00e3o foi muito expressiva. Entretanto, em casos reais, levar em conta a anisotropia \u00e9 fundamental para uma boa simula\u00e7\u00e3o de reservat\u00f3rios.\n\u00c0\nTabela 5.4 - Caracter\u00edsticas do caso base (campo lognormal)\nTamanho Original da Malha\t10x10x10\nRefinamento M\u00e1ximo\t7\nDesvio-Padr\u00e3o Efetivo\t0.3276160\nGrau de Heterogeneidade\tBaixo\nM\u00e9dia Aritm\u00e9tica\t1.06210617\nLimite Superior de Le LoCh\t1.06099479\nM\u00e9dia Geom\u00e9trica\t1.00635347\nEstimador de Le Loc\u2019h - Gu\u00e9rillot\t1.01148790\nLimite Inferior de Le Loc\u2019h\t0.96429104\nM\u00e9dia Harm\u00f4nica\t0.95412244\nM\u00e9dia de Pot\u00eancia 1/3\t1.024552\nEstimador pela Vari\u00e2ncia\t1.024518\nPrimeira M\u00e9dia Aritm\u00e9tica EF/ DF (na Malha Original)\t1.021994\nValor de Refer\u00eancia (M\u00e9dia EF/ DF na Malha mais Refinada).\t1.023595\nTabela 5.5 - Efeito da anisotropia, obtida pela modifica\u00e7\u00e3o das dimens\u00f5es geom\u00e9tricas, na varia\u00e7\u00e3o da permeabilidade equivalente do caso base.\n^TOTAL\tY 1 TOTAL\t7 TOTAL\tExtrapola\u00e7\u00e3o das Solu\u00e7\u00f5es na Malha 70x70x70\n1\t1\t1\t1.024\n1\t4\t1\t1.012\n1\t9\t1\t1.009\nI\t9\t10\t0.976\n1\t9\t100\t0.974\n5.4.3\t- Campos Lognormais e Correla\u00e7\u00e3o Espacial\nOs processos geol\u00f3gicos de forma\u00e7\u00e3o do reservat\u00f3rio s\u00e3o a principal fonte da anisotropia da permeabilidade; e s\u00e3o respons\u00e1veis, da mesma forma, pelo fen\u00f4meno da correla\u00e7\u00e3o espacial. Os campos lognormais estudados nas se\u00e7\u00f5es anteriores eram do tipo sem correla\u00e7\u00e3o espacial: no processo de gera\u00e7\u00e3o desses campos, a permeabilidade em cada bloco era simulada como um evento independente da permeabilidade dos blocos vizinhos. Todavia, na realidade, a permeabilidade em pontos vizinhos do reservat\u00f3rio tende a apresentar uma certa correla\u00e7\u00e3o espacial, por estar condicionada ao mesmo processo deposicional.\nA geoestat\u00edstica possui modelos que, a partir de curvas chamadas variogramas, representam e simulam distribui\u00e7\u00f5es normais com correla\u00e7\u00e3o espacial. Para este estudo, a partir da biblioteca GSLIB, da Universidade de Stanford, foram geradas duas realiza\u00e7\u00f5es de um meio lognormal 100x100 com correla\u00e7\u00e3o espacial. Usou-se um variograma esf\u00e9rico e alcances iguais a 10 e 20 c\u00e9lulas.\nOs Gr\u00e1ficos 5.10 e 5.11 mostram os resultados obtidos. Note-se que, nesses casos, a M\u00e9dia Geom\u00e9trica (os casos s\u00e3o 2D) n\u00e3o foi um estimador t\u00e3o bom, porque a dimens\u00e3o total de 100x100 e os alcances de 10 e 20 c\u00e9lulas acabaram resultando em campos efetivamente pequenos (correspondendo grosseiramente a campos 10x10 e 5x5 n\u00e3o-corre lacio nados). Por isso, para testes de desempenho de modelos matem\u00e1ticos, como no nosso caso, o campo lognormal sem correla\u00e7\u00e3o apresenta uma vantagem (para que os estimadores estejam mais pr\u00f3ximos da solu\u00e7\u00e3o, como nos Gr\u00e1ficos 5.6 a 5.9).\n1.15 -\n\u201e\tr- \u2022\t, a\tPermeabilidade Equivalente\nPermeabilidade Equivalente\nGr\u00e1fico 5.10 - Campo lognormal 100x100, com correla\u00e7\u00e3o esf\u00e9rica de 10 blocos e desvio-padr\u00e3o 1.0227\n\t\u2019 EEF\n- - o -\t\u2022M\u00e9dia EF/DF\n- - A -\tEFH\n- - A- -\t\u2022DF\n- - X- -\t-M. Geom\u00e9trica\n>\u00ed-\nH\nX-\n-X............-\t-X...............X\n.01 -\n1\n2\n3\n4\t5\nRefinamento\n6\n1.2\n1.16\n\u00f3\n1.12\n\nX\n1.08\n1\nGr\u00e1fico 5.11 - Campo lognormal 100x100, com correla\u00e7\u00e3o esf\u00e9rica de 20 blocos e desvio-padr\u00e3o de 1.0229\n\u00fc\no\nO\no\nO\n. - -A\n'A -\n-A-\n. A- - \u2022\nA\nX\nX\nX\nX\n\n\u2666 - - EFH\nw* \u201c *Ur\n2\n3\n4\nRefinamento\n5\n-----------------x\u2014|\tr- J I------------------\nX- - *M. Geom\u00e9trica\nX'\nX\n6\n7\n5.5\t- O Uso de Malhas Deformadas\nNesta se\u00e7\u00e3o, demonstra-se o potencial de utiliza\u00e7\u00e3o de HYBRID2D para trabalhar com malhas deformadas.\nUma dificuldade para a valida\u00e7\u00e3o da capacidade de trabalho com malhas deformadas foi a inexist\u00eancia de casos de refer\u00eancia na literatura. Acabamos tomando o caso homog\u00eaneo e as Configura\u00e7\u00f5es, para os quais temos valores de compara\u00e7\u00e3o. O caso de barreira imperme\u00e1vel n\u00e3o \u00e9 a Configura\u00e7\u00e3o 3. Para cada uma das duas malhas, designamos como argilas um arranjo irregular (tortuoso) de blocos, unindo as duas fronteiras imperme\u00e1veis, que seguramente n\u00e3o deixasse haver fluxo.\nPara testar o uso de malhas deformadas foram escolhidas as duas discretiza\u00e7\u00f5es mostradas nas Figuras 5.2 e 5.3. Essas duas malhas ser\u00e3o aqui identificadas como \u201csim\u00e9trica\u201d e \u201cirregular\u201d.\nA Tabela 5.6 apresenta os resultados das simula\u00e7\u00f5es (fluxos atravessando a face de sa\u00edda) e os valores de refer\u00eancia para cada uma das sete Configura\u00e7\u00f5es.\nPara os casos em quest\u00e3o, a malha \u201cirregular\u201d conduziu a uma representa\u00e7\u00e3o melhor do que a malha \u201csim\u00e9trica\u201d. Isso \u00e9, na Tabela 5.6, os resultados da terceira coluna s\u00e3o sistematicamente um pouco melhores do que os da segunda coluna, com exce\u00e7\u00e3o da \u00faltima configura\u00e7\u00e3o. O que ocorre na Configura\u00e7\u00e3o 7 \u00e9 que h\u00e1 um estrangulamento e todo o fluxo tem que passar por um \u00fanico bloco da segunda coluna, aquele com permeabilidade igual \u00e0 50. Na representa\u00e7\u00e3o \u201csim\u00e9trica\u201d, a entrada neste bloco pode se dar por duas faces, pertencentes a dois tri\u00e2ngulos distintos. Logo, h\u00e1 um grau de liberdade maior para a entrada de fluxo por um caminho obrigat\u00f3rio, e \u00e9 por isso que, nessa configura\u00e7\u00e3o, a malha \u201csim\u00e9trica\u201d tem um desempenho levemente superior ao da malha \u201cirregular\u201d, invertendo o comportamento usual.\nNos casos com solu\u00e7\u00e3o anal\u00edtica, o solver iterativo foi a raz\u00e3o para as respostas n\u00e3o chegarem at\u00e9 a \u00faltima casa decimal. Isso tamb\u00e9m ocorre em muitos exemplos com solu\u00e7\u00e3o anal\u00edtica simulados com o m\u00f3dulo EFFPERM do PROFIT.\nFigura 5.2 - Discretiza\u00e7\u00e3o sim\u00e9trica em rela\u00e7\u00e3o \u00e0 diagonal. E composta por 41 n\u00f3s, 56 elementos,\n6 tipos de matriz Jacobiana e 96 vari\u00e1veis (faces).\n/x, 1 \\z\t(\t\nA / \\\t|\u00c3 / \\,\n\t\n\t\t\u25a0*\n&lt;>\t\n~x~\t\n\u2022\\' \" 1 \\\t.\\\n\t/\nFigura 5.3 - Discretiza\u00e7\u00e3o mais irregular do dom\u00ednio. \u00c9 composta por 36 n\u00f3s, 42 elementos, 8 tipos de matriz Jacobiana e 77 vari\u00e1veis (faces).\nTabela 5.6 - An\u00e1lise dos resultados das simula\u00e7\u00f5es nas malhas deformadas\nSISTEMA\tMALHA SIM\u00c9TRICA (96 FACES)\tMALHA MAIS IRREGULAR (77 FACES)\tVALORES DE REFER\u00caNCIA\tTIPO\nHomog\u00eaneo\t349.999990494\t349.999993713\t350.0\tSolu\u00e7\u00e3o Anal\u00edtica\nConf.l (S\u00e9rie)\t119.318178716\t119.318179201\t119.318181...\tSolu\u00e7\u00e3o Anal\u00edtica\nConf.2 (Paralelo)\t199.999994444\t199.999996570\t200.0\tSolu\u00e7\u00e3o Anal\u00edtica\nImperme\u00e1vel\t.000000000\t.000000000\tN\u00e3o h\u00e1 fluxo\tSolu\u00e7\u00e3o Anal\u00edtica\nConfigura\u00e7\u00e3o 4\t187.499995325\t187.499997066\t187.5\tSolu\u00e7\u00e3o Anal\u00edtica\nConfigura\u00e7\u00e3o 5\t152.020799227\t153.323101962\t148.80 154.87 156.34 159.34 162.3\tDF com 16 gdl EFH com 40 gdl DF com 64 gdl EFH com 144gdl Malha Refinada\nConfigura\u00e7\u00e3o 6\t132.339618928\t136.201152039\t129.43 138.55 139.60 144.08 149.45\tDF com 16 gdl EFM com 40 gdl DF com 64 gdl EFH com 144gdl Malha Refinada\nConfigura\u00e7\u00e3o 7\t35.744490936\t35.638966448\t34.68 36.46 36.48 37.22 37.71\tDF com 16 gdl EFH com 40 gdl DF com 64 gdl EFH com 144gdl Malha Refinada\n5.6\t- Esfor\u00e7o Computacional\nNos exerc\u00edcios deste cap\u00edtulo, fizeram-se seguidas confronta\u00e7\u00f5es entre o desempenho dos m\u00e9todos DF, EF e EFH (representados aqui pelas rotinas da HOMLIB e pelo programa HYBRID3D) para c\u00e1lculo da permeabilidade equivalente em diferentes tipos de meios heterog\u00eaneos. Essas compara\u00e7\u00f5es precisam considerar simultaneamente dois crit\u00e9rios: precis\u00e3o e esfor\u00e7o computacional, ou seja, benef\u00edcio e custo.\nA precis\u00e3o dos resultados pode ser medida no eixo vertical dos gr\u00e1ficos apresentados, a partir da dist\u00e2ncia entre as respostas calculadas e uma solu\u00e7\u00e3o de refer\u00eancia (o limite de converg\u00eancia).\nNo eixo horizontal, a maioria dos gr\u00e1ficos apresenta o grau de refinamento da malha num\u00e9rica, que \u00e9 a forma mais usual de ser encontrada na literatura. Em alguns gr\u00e1ficos adota-se o n\u00famero de vari\u00e1veis do sistema linear associado. J\u00e1 se discutiu que, para uma mesma malha, os esquemas DF, EF e EFH identificam diferentes n\u00fameros de inc\u00f3gnitas a resolver, e esse n\u00famero \u00e9 um melhor indicador do esfor\u00e7o computacional empregado.\nIdealmente, o tempo de processamento seria uma medida ainda mais representativa do custo computacional, j\u00e1 que os sistemas lineares associados a esses tr\u00eas m\u00e9todos n\u00e3o t\u00eam necessariamente a mesma complexidade. Discutem-se, a seguir, alguns aspectos dessa delicada quest\u00e3o que \u00e9 a compara\u00e7\u00e3o entre tempos de processamento dos diferentes programas utilizados.\nO compilador FORTRAN 77, padr\u00e3o ANSI, n\u00e3o possui um comando espec\u00edfico para a medi\u00e7\u00e3o do tempo de CPU gasto na execu\u00e7\u00e3o de um programa, entre marcos colocados no c\u00f3digo fonte. O Microsoft FORTRAN PowerStation possui seu pr\u00f3prio comando e, da mesma forma, os diferentes compiladores f77, para cada tipo de sistema operacional UNIX.\nPara fazermos as medi\u00e7\u00f5es de tempo de execu\u00e7\u00e3o, principalmente dos tr\u00eas m\u00f3dulos solver (dois nossos e um da HOMLIB), utilizamos:\n\u2022\to comando MCLOCK(), sem par\u00e2metros mesmo, do compilador f77;\n\u2022\ta op\u00e7\u00e3o prof do UNIX/AIX, atrav\u00e9s da op\u00e7\u00e3o de compila\u00e7\u00e3o sp, para gerar a tabela dos tempos de execu\u00e7\u00e3o das principais subrotinas no arquivo default mon.out;\nambas dispon\u00edveis nos sistemas operacionais AIX 3.2.5 (mais antigo, mas ainda em uso) e AIX 4.1.4 do ambiente do CENAPAD-SP.\nUtilizamos a op\u00e7\u00e3o de otimiza\u00e7\u00e3o m\u00e1xima -O?. que reduziu o tempo de execu\u00e7\u00e3o de uma rodada com em tomo de 100.000 vari\u00e1veis de 100 % (sem otimiza\u00e7\u00e3o) para 28 % (com otimiza\u00e7\u00e3o).\nDevido \u00e0 grande variedade de casos e de tamanho (n\u00famero total de vari\u00e1veis) dos problemas, vamos apresentar os resultados das medi\u00e7\u00f5es apenas em linhas gerais.\nA rotina (solver) EFFPERM_PRECG do m\u00f3dulo EFFPERM se mostrou no geral a mais r\u00e1pida. A grande raz\u00e3o para isso \u00e9 que ela foi constru\u00edda espec\u00edficamente para malhas regulares (paralelep\u00edpedos), com estrutura em forma de multi subdiagonais conhecida. N\u00e3o h\u00e1 nenhuma matriz ou vetor auxiliar de indexa\u00e7\u00e3o.\nUm fato que observado na pr\u00e1tica (sem que se estudasse o programa fonte) \u00e9 que, havendo dificuldade na converg\u00eancia (como nos casos lognormais com alta vari\u00e2ncia), esse solver encerra os c\u00e1lculos precocement\u00ea (tipicamente em 100 itera\u00e7\u00f5es), sem atingir a precis\u00e3o dei0\"5 intr\u00ednseca do programa. Casos assim foram expurgados da an\u00e1lise, pois nossos dois m\u00f3dulos, nesses casos dif\u00edceis, chegam a iterar at\u00e9 o te\u00f3rico limite do n\u00famero total de vari\u00e1veis, podendo ainda assim ficar longe da precis\u00e3o desejada de 10\u201c7 .\nEm casos mais simples, SSOR-DS-CG leva 60 % a mais de tempo para rodar, em rela\u00e7\u00e3o \u00e0 EFFPERM_PPvECG. Em casos muito heterog\u00eaneos, como os apresentados em Beckie e outros [1993], SSOR-DS-CG n\u00e3o converge: ao final do n\u00famero m\u00e1ximo de itera\u00e7\u00f5es, pelas diferentes se\u00e7\u00f5es transversais passam os mais incr\u00edveis fluxos. Nosso ICCG(0) leva de 5 a 16 vezes o respectivo tempo de EFFPERM__PRECG. Isso porque h\u00e1 momentos em que se tem que efetuar uma busca para saber qual a numera\u00e7\u00e3o do transposto de um elemento no sistema de indexa\u00e7\u00e3o esparso sendo utilizado. Nos problemas com desvio-padr\u00e3o acima de quatro, ICCG(0) converge para a resposta, mesmo sendo com uma precis\u00e3o mais grosseira do quel0~7. Mas nesses casos a medi\u00e7\u00e3o de tempo \u00e9 muito desfavor\u00e1vel, pois, como comentamos, EFFPERM_PRECG termina em 100 itera\u00e7\u00f5es. Com essa parada antecipada, h\u00e1 casos muito heterog\u00eaneos onde os resultados calculados de permeabilidade equivalente s\u00e3o absurdos, principalmente o valor EF.\nO Sistema de Durlofsky, descrito na Se\u00e7\u00e3o 5.3, requer relativamente menos trabalho computacional, pois as entradas (os n\u00fameros) da matriz s\u00e3o de apenas dois tipos, os referentes ao arenito e os muito pr\u00f3ximos de zero, referentes \u00e0 argila. Em refinamentos desse caso, e levando em conta a precis\u00e3o do resultado. SSOR-DS-CG chega a levar 80% do tempo de EFFPERM PRECG. \u00c9 mais r\u00e1pido!\nOutra verifica\u00e7\u00e3o importante feita a partir da cronometragem do tempo de execu\u00e7\u00e3o foi que, al\u00e9m dos dois m\u00f3dulos de solver, nenhuma outra subrotina est\u00e1 utilizando um tempo excessivo de processamento. A montagem do sistema linear da formula\u00e7\u00e3o h\u00edbrida fica em terceiro lugar no consumo de tempo, nos grandes problemas.\nMelhorar os m\u00f3dulos solver para a formula\u00e7\u00e3o EFH e, principalmente, implementar um m\u00f3dulo espec\u00edfico para malha regular s\u00e3o, inegavelmente, pontos ainda a melhorar em HYBRID2D e HYBRID3D. De qualquer modo, o conhecimento adquirido - pelo estudo e com a implementa\u00e7\u00e3o de JBCG, DSCG, SSOR-DS-CG e ICCG(O) - foi fundamental para programar e, tamb\u00e9m, utilizar m\u00f3dulos mais robustos e eficazes (como, por exemplo, os v\u00e1rios programas de dom\u00ednio p\u00fablico colocados a disposi\u00e7\u00e3o por Universidades americanas, tais como os das Universidades de Stanford, Yale e Tulsa).\n5.7\t- A M\u00e9dia Aritm\u00e9tica das Solu\u00e7\u00f5es EF e DF\nNesta tese, como tamb\u00e9m em alguns estudos anteriores, observou-se que, sistematicamente, o erro do m\u00e9todo EF \u00e9 positivo e o erro do m\u00e9todo DF \u00e9 negativo. Assim, n\u00e3o parece despropositado testar combina\u00e7\u00f5es lineares dos dois m\u00e9todos que diminu\u00edssem o erro.\nDe fato, n\u00e3o \u00e9 uma novidade que uma composi\u00e7\u00e3o elementar de dois m\u00e9todos possa produzir um m\u00e9todo bem mais robusto do que os dois que lhe deram origem. Por exemplo, a regra de integra\u00e7\u00e3o num\u00e9rica de Simpson pode ser vista como a m\u00e9dia ponderada entre a regra do ret\u00e2ngulo, com peso dois, e a regra do trap\u00e9zio, com peso unit\u00e1rio. Com isso, a ordem de converg\u00eancia passa de o(h2)~ dos dois m\u00e9todos isolados - para o(/\u00ed4).\nA utiliza\u00e7\u00e3o da m\u00e9dia aritm\u00e9tica dos resultados EF e DF tem por base a mesma id\u00e9ia de aumentar a ordem de converg\u00eancia pelo cancelamento do termo de menor ordem do erro. Nesse caso, o cancelamento apareceu \u00a1mediatamente com a soma direta.\nEsse estimador \u00e9 limitado aos sistemas mais homog\u00eaneos, casos onde a solu\u00e7\u00e3o EF seja aceit\u00e1vel. De todo modo, n\u00e3o existe at\u00e9 o momento um estimador que sempre apresente resultados precisos. Em artigos mais recentes, como Mansoori [1994] e Durlofsky [1995], pode-se verificar que a sistem\u00e1tica sendo mais empregada para fazer transfer\u00eancia de escala \u00e9 determinar as regi\u00f5es com menores gradientes de velocidade, logo mais homog\u00eaneas, e nelas\npassar para malhas mais grosseiras. Trabalhando dessa forma, a m\u00e9dia aritm\u00e9tica EF/ DF tem uma enorme potencialidade, pois nos exemplos analisados ela foi entre 3 e 13 % mais precisa do que o estimador de Le Loc'h e Gu\u00e9rillot. e vai ficando mais precisa com o refinamento da malha.\nUm poss\u00edvel estudo posterior \u00e9 a determina\u00e7\u00e3o de limites de aplicabilidade desse estimador m\u00e9dia aritm\u00e9tica EF/ DF.\n5.8\t- Rela\u00e7\u00f5es Entre os Esquemas EFH e DF\nDurante a execu\u00e7\u00e3o do refinamento do sistema de Durlofsky, na Se\u00e7\u00e3o 5.3, observou-se que o resultado DF para a malha original, igual a 0.45082915, coincidia em at\u00e9 seis ou sete algarismos significativos com o resultado EFH com a discretiza\u00e7\u00e3o por tri\u00e2ngulos, igual \u00e0 0.45082921.\nEsse resultado motivou um estudo especifico, onde se verificou, em in\u00fameras simula\u00e7\u00f5es, para qualquer grau de refinamento e para qualquer configura\u00e7\u00e3o testada, que as respostas DF e a EFH para a discretiza\u00e7\u00e3o por tri\u00e2ngulos s\u00e3o equivalentes (de 4 a 8 d\u00edgitos iguais). Nessa correspondente discretiza\u00e7\u00e3o triangular EFH, o n\u00famero de blocos EFH \u00e9 o dobro do n\u00famero N2 de blocos DF, e o n\u00famero de vari\u00e1veis EFH \u00e9 n(3N + 2), aproximadamente o triplo do n\u00famero de vari\u00e1veis na formula\u00e7\u00e3o DF.\nPara complementar o estudo dessa equival\u00eancia, inicialmente observada apenas nos resultados finais da permeabilidade equivalente, resolveu-se investigar se todos os fluxos entre elementos eram mesmo iguais. Para isso, procedeu-se por comparar as press\u00f5es m\u00e9dias nos blocos e nas faces, o que causa fluxos iguais. As subrotinas do PROFIT devolvem um vetor com o resultado das press\u00f5es calculadas, que \u00e9 a press\u00e3o nos blocos para a formula\u00e7\u00e3o DF. A determina\u00e7\u00e3o da press\u00e3o DF m\u00e9dia na face envolve um p\u00f3s-processamento das press\u00f5es m\u00e9dias em blocos vizinhos. Tomando o fluxo horizontal entre dois blocos, o da esquerda (E) e o da direita (D), temos, pela lei de Darcy, que:\n(5.2)\no que resulta na seguinte m\u00e9dia ponderada\t-\n(5-3)\nEfetuamos esse p\u00f3s-processamento para a Configura\u00e7\u00e3o 5 e para o Sistema de Durlofsky. A an\u00e1lise das press\u00f5es mostrou que a press\u00e3o m\u00e9dia DF no bloco \u00e9 igual \u00e0 press\u00e3o m\u00e9dia na hipotenusa do tri\u00e2ngulo e as press\u00f5es nas faces verticais s\u00e3o iguais nas duas formula\u00e7\u00f5es. A discretiza\u00e7\u00e3o por tri\u00e2ngulos tanto pode ser feita com as hipotenusas paralelas \u00e0 diagonal principal (\u00e9 o caso do artigo Durlofsky [1994]), como ao contr\u00e1rio, que a resposta \u00e9 a mesma.\nConcluindo, h\u00e1 um relacionamento muito forte entre as formula\u00e7\u00f5es EFM e EFH com DF. \u00c9 por isso que regras incompletas de quadratura podem transformar essas formula\u00e7\u00f5es em esquemas DF.\nCap\u00edtulo 6 - Conclus\u00f5es e Recomenda\u00e7\u00f5es\nFoi implementada e analisada a formula\u00e7\u00e3o h\u00edbrida de elementos finitos com o uso do espa\u00e7o de aproxima\u00e7\u00e3o de Raviart-Thomas de mais baixa ordem. Em rela\u00e7\u00e3o ao n\u00famero total de vari\u00e1veis do sistema linear a ser resolvido, a formula\u00e7\u00e3o EFH \u00e9 mais precisa do que o esquema DF, de cinco ou sete pontos, e do que a formula\u00e7\u00e3o EF de Galerkin com fun\u00e7\u00f5es de forma Lagrangeanas lineares.\nPara se tomar competitivo em termos do tempo de execu\u00e7\u00e3o, falta implementar um m\u00f3dulo solver para o caso mais comum de malha estruturada. Como h\u00e1 uma vantagem em termos do n\u00famero de vari\u00e1veis, principalmente nas descri\u00e7\u00f5es n\u00e3o refinadas do reservat\u00f3rio, acreditamos que seja poss\u00edvel tomar a formula\u00e7\u00e3o EFH computacionalmente mais eficiente do que os esquemas DF.\nFoi mostrado como a formula\u00e7\u00e3o EFH pode ser estendida para o tratamento tensorial. H\u00e1 uma grande potencialidade em uma implementa\u00e7\u00e3o EFH tensorial, pois a matriz do sistema linear continuaria com o mesmo n\u00famero de entradas (elementos n\u00e3o-nulos) por linha, enquanto que, para implementa\u00e7\u00f5es DF tensorial, o n\u00famero de entradas DF ultrapassaria o n\u00famero de entradas da formula\u00e7\u00e3o EFH.\nFoi validado o m\u00f3dulo EFFPERM, da biblioteca HOMLIB. do projeto multicliente PROFIT. Nesse m\u00f3dulo s\u00e3o considerados apenas os termos diagonais do tensor de permeabilidade, e pode-se obter a permeabilidade equivalente pelo esquema mais usual de diferen\u00e7as finitas de cinco (2D) e sete pontos (3D) e pelo m\u00e9todo dos elementos finitos de Galerkin com as fun\u00e7\u00f5es de base mais simples (as chamadas fun\u00e7\u00f5es \u201cchap\u00e9u\u201d - fun\u00e7\u00f5es Lagrangeanas lineares).\nApesar de n\u00e3o apresentar resultados coerentes para os casos mais heterog\u00eaneos, com desvio-padr\u00e3o logar\u00edtmico muito elevado, esse m\u00e9todo EF mais simples apresenta resultados aceit\u00e1veis em muitos casos, e serve para compor um novo estimador, que foi originado das observa\u00e7\u00f5es dos resultados de centenas de simula\u00e7\u00f5es. Esse m\u00e9todo EF mais simples \u00e9 usado pois seu desempenho computacional \u00e9 o mesmo dos esquemas DF. O uso das fun\u00e7\u00f5es\nquadr\u00e1ticas, mais indicadas para originar em um campo de velocidades cont\u00ednuo, apresentaria um tempo de processamento mais elevado, o que \u00e9 bastante indesej\u00e1vel.\nO uso conjunto dos programas HYBRID2D e HYBRID3D com o m\u00f3dulo EFFPERM do PROFIT deu origem a um \u00f3timo processo de ganha-ganha, ou seja, um programa foi validando o outro ao longo das observa\u00e7\u00f5es cr\u00edticas que foram sendo obtidas dos resultados.\nA M\u00e9dia Aritm\u00e9tica entre os resultados EF e DF apresentou-se como o melhor estimador da permeabilidade equivalente para regi\u00f5es mais homog\u00eaneas. A M\u00e9dia Aritm\u00e9tica entre EF e DF \u00e9 um resultado mais preciso j\u00e1 na descri\u00e7\u00e3o original, sem refinamento, do meio poroso. Determinar limites pr\u00e1ticos para utiliza\u00e7\u00e3o dessa m\u00e9dia \u00e9 um trabalho futuro necess\u00e1rio.\nA utiliza\u00e7\u00e3o de m\u00e9dias simples e estimadores n\u00e3o leva a resultados confi\u00e1veis, de uma maneira geral. Em casos de trechos mais homog\u00eaneos, a M\u00e9dia Aritm\u00e9tica entre EF e DF \u00e9 prefer\u00edvel.\nNos \u00faltimos anos tem havido um grande crescimento na aplica\u00e7\u00e3o dos m\u00e9todos n\u00e3o-convencionais de EF. Em Chavent e outros [1990] e em Eymard e outros [1989], \u00e9 poss\u00edvel verificar que a formula\u00e7\u00e3o EFH tem sido aplicada no acoplamento el\u00edptico-hiperb\u00f3lico em simula\u00e7\u00e3o de reservat\u00f3rios (fluxo bif\u00e1sico).\nDentre algumas alternativas para estender esse trabalho, uma considerada vi\u00e1vel dentro do tempo de uma disserta\u00e7\u00e3o de mestrado \u00e9 a implementa\u00e7\u00e3o do espa\u00e7o de BDM de primeira ordem, tentando utilizar o tratamento tensorial diagonal para a permeabilidade.\nRefer\u00eancias Bibliogr\u00e1ficas\n[01] ALLEN, Myron B. - Mixed Finite-Element Methods for the Equations of Flow in Porous Media. In: BAINOV, D. &amp; COVACHEV, V. ed. - Proceedings of the Fourth International Colloquium on Differential Equations. Plovdiv, Bulgaria, Aug. 18-22, 1993. Utrecht, The Netherlands, VSP, 1994.\n[02] ARBOGAST, Todd; KEENAN, Philip T.; WHEELER, Mary F. &amp; YOTOV, Ivan -Logically Rectangular Mixed Methods for Darcy Flows on General Geometry. Soc. Petroleum Eng. Symposium on Reservoir Simulation. San Antonio, Texas, February 12-15, 1995, p. 51-59. SPE 29099.\n[03] ASHBY, Steve F.; MANTEUFFEL, Thomas A. &amp; OTTO, James S. - Adaptive Polynomial Preconditioning for HPD Linear Systems. In: Glowinski, Roland &amp; Linchnewsky, Alain ed. - Computing Methods in Applied Scinece and Engineering. Proceedings of the Ninth International Conference on Computing Methods in Applied Sciences and Engineering. Paris, France, Jan. 29 to Feb. 2, 1990. Philadelphia, SIAM, 1990.\n[04] AXELSSON, O. &amp; BARKER, Vincent Allan - Finite Element Solution of Boundary Value Problems. Theory and Computation. Orlando, Florida, Academic Press, 1984. Chap. 1 and 7.\n[05] BECKIE, Roger; WOOD, Eric F. &amp; ALDAMA, Alvaro A. - Mixed Finite Element Simulation of Saturated Groundwater Flow Using a Multigrid Accelerated Domain Decomposition Technique. Water Resourc. Res.. 29(9):3145-3157, September, 1993.\n[06] BONET, L.; ROMEU. R. K. &amp; PEREIRA. J. R. - Metodologia para Determina\u00e7\u00e3o de Permeabilidades Equivalentes em Meios Heterog\u00eaneos. Rio de Janeiro, projeto 03-04-14 da PETROBR\u00c1S-CENPES-DIGER, abril. 1989.\n[07] BOX, George E. P.; HUNTER, William Gordon &amp; HUNTER, J. Stuart - Statistics for Experimenters. An Introduction to Design, Data Analysis, and Model Building. New York, John Wiley, 1978.\n[08] BREZZL Franco &amp; FORTIN, Michel - Mixed and Hybrid Finite Element Methods. New York, NY, Springer-Verlag, 1991.\n[09] CARDWELL, W. T. Jr &amp; PARSONS, R.L. - Average Permeabilities of Heterogeneous Oil Sands. Trans. Amer. Inst. Mining Metal. Eng., 160:34-42, 1945.\n[10]\tCHAVENT, Guy &amp; ROBERTS, J. E. - A Unified Physical Presentation of Mixed,\nMixed-Hybrid Finite Element and Standard Finite Difference Approximations for the Determination of Velocities in Waterflow Problems. Adv. Water Resouc., 14(6):329-348, 1991.\n[11]\tCHAVENT, Guy; COHEN, Gary; JAFFR\u00c9. Jerome; EYMARD. Robert; GU\u00c9RILLOT.\nDominique R. &amp; WEILL, Luce - Discontinuous and Mixed Finite Element for Two-Phase Incompressible Flow. Soc. Petroleum Eng. Reservoir Eng., 567-575, November, 1990. SPE 16018.\n[12]\tCHAVENT, Guy &amp; JAFFR\u00c9, J\u00e9r\u00f4me - Mathematical Models and Finite Elements for\nReservoir Simulation. Amsterdam, Holland, North-Ho 11 and, 1986. Chap. 5.\n[13]\tCORDES, Christian &amp; KINZELBACH, Wolfgang - Continuous Grounwater Velocity\nFields and Path Lines in Linear, Bilinear, and Trilinear Finite Elements. Water Resourc. Res., 28(11 ):2903-2911, November, 1992.\n[14]\tCRUZ, Paulo S\u00e9rgio da - An\u00e1lise Cr\u00edtica dos M\u00e9todos de Mudan\u00e7a de Escala\nAssociados \u00e0 Simula\u00e7\u00e3o de Reservat\u00f3rios. Disserta\u00e7\u00e3o de mestrado, Faculdade de Engenharia Mec\u00e2nica, UNICAMP, Campinas, 1991.\n[15]\tDESBARATS, Alexandre J. - Numerical Estimation of Effective Permeability in Sand-\nShale Formations. Water Resourc. Res., 23(2):273-286, February, 1987.\n[16]\tDEMIDOVITCH, B. - Problemas e Exerc\u00edcios de An\u00e1lise Matem\u00e1tica. Lisboa, Portugal,\nMcGraw-Hill, 1993.\n[17]\tDURLOFSKY, Louis J. - Numerical Calculation of Equivalent Grid Block Permeability\nTensors for Heterogeneous Porous Media. Water Resourc. Res., 27(5):699-708. May, 1991.\n[18]\tDURLOFSKY, Louis J. - Accuracy of Mixed and Control Volume Finite Element\nApproximations to Darcy Velocity and Related Quantities. Water Resouc. Res., 30(4):965-973, 1994.\n[19]\tDURLOFSKY, Louis J.; BEHRENS, R.A.; JONES, R. C. &amp; BERNATH, A. - Scale Up\nof Heterogeneous Three Dimensional Reservoir Descriptions. Soc. Petroleum Eng. Annu. Techn. Conf, and Exhibition. Dallas, TX, Oct. 22 to 25, 1995. p. 53-66. SPE 30709.\n[20]\tEYMARD, R.; GALLOUET,T. &amp; JOLY, P. - Hybrid Finit Element Techniques for Oil\nRecovery Simulation. Comp. Meth. Appl. Meeh. Eng., North-Holland, 74:83-98, 1989.\n[21]\tPAYERS, F.J. &amp; HEWETT. T.A. - A Review of Current Trends in Petroleum Reservoir\nDescription and Assessment of the Impacts on Oil Recovery. Adv. Water Resouc., 15(6):341-365, 1992.\n[22]\tFLETCHER, C. A. J. - Computational Galerkin Methods. Springer Series in\nComputational Physics. New York, Springer-Verlag, 1984.\n[23]\tFRIND, E. O. &amp; MATANGA G. B. - The Dual Formulation of Flow for Contaminant\nTransport Modeling: 1. Review of Theory and Accuracy Aspects. Water Resourc. Res., 21(2):159-169, February, 1985.\n[24]\tFRIND, E. O.; MATANGA, G. B. &amp; CHERRY, J. A. - The Dual Formulation of Flow\nfor Contaminant Transport Modeling: 2. The Borden Aquifer. Water Resourc. Res., 21(2): 170-182, February, 1985.\n[25]\tGALLI, A.; GOBLET, P.; GRIFFIN, D.; LEDOUX, E.; LE LOC\u2019H, G.; MACKAY, R.\n&amp; RENARD, P. - Quick Upscaling of Flow and Transport Related Parameters. Technical Report LHM/96/RD/11, Commission of the European Communities, May 15, 1996.\n[26]\tGELHAR, L. W. &amp; AXNESS, C. L. - Three-Dimensional Stochastic Analysis of\nMacrodispersion in Aquifers. Water Resouc. Res., 19( 1): 161 -180, 1983.\n[27]\tGUSTAFSON, Karl E. - Introduction to Partial Differential Equations and Hilbert Space\nMethods. New York, USA, John Wiley, 2.ed., 1987.\n[28]\tGUTJAHR, A. L.; GELHAR, L. W.; BAKR, A. A. &amp; MCMILLAN, J. R. - Stochastic\nAnalysis of Spatial Variability in Subsurface Flows. 2: Evaluation and Application. Water Resouc. Res., 14(5):953-959, 1978.\n[29]\tHAGEMAN, Louis A. &amp; YOUNG, David M. - Applied Iterative Methods. San Diego,\nCalifornia, Academic Press, 1981. Chap. 2.\n[30]\tHOLDEN, Lars; LIA, Oddvar; MADSEN, Rune A.; MOSTAD, P.; RUSTEN, Torgeir\n&amp; SKORSTAD, Arne - Scaling and Representation of Absolute Permeability. NR-note SAND/02/94, Norwegian Computing Center, P.O.Box 114 Blindem, N-0314 Oslo, Norway. PROFIT report, 1994.\n[31]\tHUGHES, Thomas J. R. - The Finite Element Method. Linear Static and Dynamic\nFinite Element Analysis. Englewood Cliffs, New Jersey, Prentice-Hall, 1987.\n[32]\tLACHASSAGNE, P.; LEDOUX, E. &amp; de MARSILY, G. - Two Dimensional Stochastic\nModelling of Flow in Non-Uniform Confined Aquifers. Correction of the Systematic Bias Introduced by Numerical Models When They Are Used Stochastically. In: 2nd European Conference on the Mathematics of the Oil Recovery. Paris, Technip, 1990. p.283-286\n[33]\tLE LOC\u2019H, G. - Etude de la composition des permeabilites par des methodes\nvariationnelles. These de Doctoral, Ecole de Mines de Paris. Paris, France, November 1987.\n[34]\tMANSOORL John - A Review of Basic Upscaling Procedures: Advantages and\nDisadvantages. In: YARLIS, J. M, &amp; CHAMBERS. R.L. eds. - Stochastic Modeling and Geostatistics; Principles. Methods and Case Studies. AAPG Computer Applications in Geology # 3. Tulsa. OK. AAPG, 1994. Chap. 7.\n[35]\tMATHERON, G. - Elements pour une Th\u00e9orie des Milieu Poreux. Paris, Masson. 1967.\n[36]\tMEYER, Philip D.; VALOCCHI, Albert J.; ASHBY, Steven F. &amp; SAYLOR. Paul E. -\nA Numerical Investigation of the Conjugate Gradient Method as Applied to Three-Dimensional Groundwater Flow Problems in Randomly Heterogeneous Porous Media. Water Resourc. Res., 25(6): 1440-1446, June, 1989.\n[37]\tODEN, John Tinsley; CAREY, Graham F. &amp; BECKER, Eric B. - Finite Elements: An\nIntroduction. Volume I. Englewood Cliffs, New Jersey, Prentice-Hall, 1981.\n[38]\tODEN, John Tinsley &amp; CAREY, Graham F. - Finite Elements: A Second Course.\nVolume IL Englewood Cliffs, New Jersey, Prentice-Hall, 1983.\n[39]\tODEN, John Tinsley &amp; CAREY, Graham F. - Finite Elements: Computational Aspects.\nVolume III. Englewood Cliffs, New Jersey, Prentice-Hall, 1984.\n[40]\tODEN, John Tinsley &amp; CAREY, Graham F. - Finite Elements: Mathematical Aspects.\nVolume IV. Englewood Cliffs, New Jersey, Prentice-Hall, 1983 .\n[41]\tPRESS, William H. et alii - Numerical Recipes in FORTRAN. The Art of Scientific\nComputing. United States, Cambridge University Press, 2nd edition, 1992.\n[42]\tRAMIRO, R. A. - O Impacto do Tratamento Tensorial da Permeabilidade no Processo\nde Mudan\u00e7a de Escala e Simula\u00e7\u00e3o de Fluxo. Disserta\u00e7\u00e3o de mestrado, Instituto de Geoci\u00eancias (Area de Geologia de Petr\u00f3leo), UNICAMP, Campinas, 1994.\n[43]\tROMEU, Reg\u00eds Kruel - \u00c9coulement en Milieux H\u00e9t\u00e9rog\u00e8nes: Prise de Moyenne de\nPerm\u00e9abilit\u00e9 en Regimes Permanent et Transitoire. Th\u00e8se de Doctoral (Sciences de la Terre), Universit\u00e9 Paris 6. Paris, France, Juin 1994.\n[44]\tROMEU, R\u00e9gis Kruel &amp; NOETINGER, B. - Calculation of Intemodal Transmissivities\nin Finite Difference Models of Flow in Heterogeneous Porous Media. Water Resouc. Res., 31(4):943-959, April, 1995.\n[45]\tSIQUEIRA, A. G.; CARRASCO, B. N. &amp; SOMBRA, C. L. - Minipermeametria:\nPrinc\u00edpios e Aplica\u00e7\u00f5es. In: I Semin\u00e1rio de Reservas e Reservat\u00f3rios. Rio de Janeiro, 9-13 Setembro, 1996. Rio de Janeiro, PETROBR\u00c1S/SEREC/CEN-NOR e PETROB R\u00c1S/E&amp;P/GERER/GECOR, 1996. p.285-95\n[46]\tSONIER, Fernand &amp; EYMARD, Robert - Mathematical and Numerical Properties of\nControl-Volume Finite-Element Scheme for Reservoir Simulation. Soc. Petroleum Eng. Symposium on Reservoir Simulation. New Orleans, LA, February 28 - March 3, 1993, p. 399-411. SPE 25267.\n[47]\tTHOMASSET, Francois - Implementation of Finite Element Methods for Navier-Stokes\nEquations. Springer Series in Computational Physics. New York, Springer-Verlag, 1981.\n[48]\tWARREN, J. E. &amp; PRICE, H. S. - Flow in Heterogeneous Porous Media. Soc.\nPetroleum Eng. J., 153-169, September, 1961.\n[49]\tZIENKIEW1CZ, O. C. &amp; MORGAN, Kenneth - Finite Elements and Approximation.\nNew York, NY, John Wiley, 1983."}]}}}